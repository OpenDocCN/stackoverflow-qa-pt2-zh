# StackOverflow 问答 13109000-13109999

# sitefinity - Sitefinity 5.1 迭代内容类型

> ID：13109001
> 
> 赞同：1
> 
> 时间：2012-10-28T13:03:22.350
> 
> 标签：sitefinity

我对 Sitefinity 5.1 有点陌生，只是为了提前说明这一点。我创建了一个自定义内容类型并为其赋予了一些属性。我正在尝试创建一个用户控件，该控件获取此内容类型的每个项目并在面板中显示一些属性。我正在寻找的是如何直接与这个集合进行交互。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:10:46.600

如果您转到模块设置，右侧有一个“代码参考”链接，这里有完整的代码示例，您可以复制和粘贴这些示例以与动态模​​块数据进行交互。

它向您展示了如何检索集合，然后您可以从那里简单地迭代该集合，并使用 GetValue() 扩展方法获取值。

您可能还会发现这篇博文很有用：[http ://www.sitefinity.com/blogs/joshmorales/posts/josh-morales-blog/2012/01/19/retrieving_data_from_dynamic_modules_using_the_module_builder_api](http://www.sitefinity.com/blogs/joshmorales/posts/josh-morales-blog/2012/01/19/retrieving_data_from_dynamic_modules_using_the_module_builder_api)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T07:22:28.183

您可以尝试**ModuleBuilderManager.GetManager().Provider.GetDynamicModuleTypes()**来迭代内容类型。

此外**ModuleBuilderManager.GetManager().Provider.GetDynamicModuleFields()**将返回内容类型的所有字段，您可以按父级过滤并获得所需的内容。

例如：

**var field = ModuleBuilderManager.GetManager().Provider.GetDynamicModuleFields().Where(field => field.ParentTypeId == contentTypeId && field.SpecialType == FieldSpecialType.None && field.Name == fieldName)**

希望这可以帮助！

# yii - Yii 中的 RBAC，访客未授权

> ID：13109005
> 
> 赞同：1
> 
> 时间：2012-10-28T13:03:43.363
> 
> 标签：yii, rights, rbac

我试图在 Yii 中实现 RBAC（使用权限模块）。

当尝试授权未经身份验证的用户（访客）时，`CWebUser`调用`CDbAuthManager`：

```
$access=Yii::app()->getAuthManager()->checkAccess($operation,$this->getId(),$params); 
```

`CDbAuthManager`然后尝试获取用户的 authassignments

```
$assignments=$this->getAuthAssignments($userId); 
```

问题是，因为用户是来宾，`$userId`是`null`，并且`$assignments`是一个空数组。因此，我不能授权来宾用户执行任何操作（除非声明 allowedActions()）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T13:51:12.633

确保将 Guest 添加到配置中的 defaultRoles。还要确保 Guest 角色有一个 bizRule ，其中包含表达式

> 返回 Yii::app()->user->isGuest

# c - 如何使用 malloc 在 C 中创建动态字符串数组

> ID：13109008
> 
> 赞同：2
> 
> 时间：2012-10-28T13:03:59.433
> 
> 标签：c, arrays, malloc, realloc

当没有固定长度的项目或字符时如何创建字符串数组。我是指针和 c 的新手，我无法理解此处发布的其他解决方案，因此我的解决方案发布在下面。希望它可以帮助别人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:20:24.813

```
char **twod_array = NULL;

void allocate_2darray(char ***source, int number_of_slots, int length_of_each_slot)
{
   int i = 0;
   source = malloc(sizeof(char *) * number_of_slots);
   if(source == NULL) { perror("Memory full!"); exit(EXIT_FAILURE);}
   for(i = 0; i < no_of_slots; i++){
      source[i] = malloc(sizeof(char) * length_of_each_slot);
      if(source[i] == NULL) { perror("Memory full!"); exit(EXIT_FAILURE);}
   }
} 
```

// 示例程序

```
int main(void) { 
   allocate_2darray(&twod_array, 10, 250); /*allocate 10 arrays of 250 characters each*/ 
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:03:59.433

只需将 argv 项目栏中的数组作为第一项。

```
char **dirs = NULL;
int count = 0;
for(int i=1; i<argc; i++)
{
    int arraySize = (count+1)*sizeof(char*);
    dirs = realloc(dirs,arraySize);
    if(dirs==NULL){
        fprintf(stderr,"Realloc unsuccessful");
        exit(EXIT_FAILURE);
    }
    int stringSize = strlen(argv[i])+1;
    dirs[count] = malloc(stringSize);
    if(dirs[count]==NULL){
        fprintf(stderr,"Malloc unsuccessful");
        exit(EXIT_FAILURE);
    }
    strcpy(dirs[count], argv[i]);
    count++;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T13:08:03.793

你的很接近，但你分配主数组的次数太多了。

```
char **dirs = NULL;
int count = 0;

dirs = malloc(sizeof(char*) * (argc - 1));

if(dirs==NULL){
    fprintf(stderr,"Char* malloc unsuccessful");
    exit(EXIT_FAILURE);
}

for(int i=1; i<argc; i++)
{
    int stringSize = strlen(argv[i])+1;
    dirs[count] = malloc(stringSize);
    if(dirs[count]==NULL){
        fprintf(stderr,"Char malloc unsuccessful");
        exit(EXIT_FAILURE);
    }
    strcpy(dirs[count], argv[i]);
    count++;
} 
```

# php - 从 PDO 到 SQLSRV

> ID：13109012
> 
> 赞同：0
> 
> 时间：2012-10-28T13:04:15.017
> 
> 标签：php, sql-server, database, sqlsrv

我以前使用 PDO for MYSql，但现在我需要使用 Microsoft SQL Server Driver for PHP。

我找到了手册。 [http://php.net/manual/en/book.sqlsrv.php](http://php.net/manual/en/book.sqlsrv.php)

我使用示例 #2 连接到新的 SQL 数据库： [http ://www.php.net/manual/en/function.sqlsrv-connect.php](http://www.php.net/manual/en/function.sqlsrv-connect.php)

如何“转换”以下（PDO mysql）以使用 sqlsrv：

```
$username = 'test';

try {
$conn = new PDO('mysql:host=$host;dbname=$database', $username, password);
$stmt = $conn->prepare('SELECT username users WHERE username = :username LIMIT 1');
$stmt->execute(array('username' => $username));

if ($stmt->rowCount() > 0) {
$result = $stmt->fetch();

    echo $result['username'];

} else {
    echo 'Nothing found.';
die();
}
} catch(PDOException $e) {
echo 'ERROR: ' . $e->getMessage();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-07T07:02:07.143

来自 php.net

> PHP 数据对象 (PDO) 扩展定义了一个轻量级、一致的接口，用于在 PHP 中访问数据库。

由于您已经为 MySQL 使用 PDO，您可以考虑使用用于 MS SQL 的 PDO 驱动程序，如*dev-null-dweller*所说。SQLSRV 驱动程序是访问 MS SQL 的另一种选择。但这需要彻底检查您当前的 PHP 代码。

[微软](https://docs.microsoft.com/en-us/sql/connect/php/download-microsoft-php-driver-for-sql-server)为 MS SQL 提供了两种 PHP 驱动：

*php_sqlsrv.dll*为 MS SQL 提供了一组独特的 SQLSRV API。

*php_pdo_sqlsrv.dll*为 MS SQL 提供了一组大部分与 PDO 兼容的 API。

下载驱动程序时请注意您的 PHP 版本：

```
Version 4.0 supports PHP 7.0+ on Windows and Linux
Version 3.2 supports PHP 5.6, 5.5, and 5.4 on Windows
Version 3.1 supports PHP 5.5 and 5.4 on Windows
Version 3.0 supports PHP 5.4 on Windows 
```

而对于 PHP5.6，微软只提供 x86 版本的驱动程序。非官方 X64 驱动可以在 [http://robsphp.blogspot.tw/2012/06/unofficial-microsoft-sql-server-driver.html找到](http://robsphp.blogspot.tw/2012/06/unofficial-microsoft-sql-server-driver.html)

下载驱动程序后。将您需要的版本复制到您的 PHP *ext*文件夹。并将驱动程序名称添加到*php.ini*配置中，例如：

```
extension=php_pdo_sqlsrv_56_ts.dll 
```

然后重新启动网络服务器。*如果phpinfo()*函数显示*pdo_sqlsrv*部分，则可以确认 PDO 驱动程序安装正确。

 *请注意，MS 在 PDO 构造函数中使用了不同的 DSN。线

```
$conn = new PDO('mysql:host=$host;dbname=$database', $username, password); 
```

应改为

```
$conn = new PDO('sqlsrv:Server=$host;Database=$database', $username, password); 
```

那么您应该不会再次遇到“错误：找不到驱动程序”。希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:32:01.347

解决连接问题后，您必须将使用 MySQL SQL 方言编写的 SQL 语句转换为 T-SQL 方言（由 SQL Server 使用）。

**[1]** SQL Server 没有该`LIMIT`子句。而且，SQL 标准中不包含该子句。相反，您可以使用[ROW_NUMBER() 函数](http://msdn.microsoft.com/en-us/library/ms186734%28v=sql.90%29.aspx)。但是，在这种情况下，您不必使用此功能，因为...

**[2]** ...表中的`username`列`users`应该只接受唯一值（当然，它应该是强制性的）。因此，您必须确保在`username`列上有唯一约束或唯一索引。此脚本将检查您是否在列上有唯一索引`username`：

```
DECLARE @TableName SYSNAME=N'dbo.users';
DECLARE @ColumnName SYSNAME=N'username';
SELECT  *
FROM    sys.indexes i
WHERE   i.object_id=OBJECT_ID(@TableName)
AND     i.is_unique=1
AND     EXISTS (
    SELECT  *
    FROM    sys.index_columns ic 
    INNER JOIN sys.columns c ON c.object_id=ic.object_id
    AND     c.column_id=ic.column_id
    WHERE   i.object_id=ic.object_id
    AND     i.index_id=ic.index_id
    AND     ic.is_included_column=0
    AND     c.name=@ColumnName
)
AND (
    SELECT  COUNT(*)
    FROM    sys.index_columns ic 
    INNER JOIN sys.columns c ON c.object_id=ic.object_id
    AND     c.column_id=ic.column_id
    WHERE   i.object_id=ic.object_id
    AND     i.index_id=ic.index_id
    AND     ic.is_included_column=0
)=1; 
```

**[3]**如果`username`列上有唯一索引，则不需要使用`LIMIT 1`子句（或`ROW_NUMBER()`函数），因为 SQL 语句将始终返回零（最小）或一（最大）记录。

**[4]** SQL 语句应为`SELECT username FROM users WHERE username = :param`.*

# jquery - jQuery转义特殊字符

> ID：13109014
> 
> 赞同：5
> 
> 时间：2012-10-28T13:04:26.843
> 
> 标签：jquery, special-characters

以下脚本在没有特殊字符的情况下运行良好。不幸的是，我有很多特殊字符要替换。如何在 jQuery 中用特殊字符替换文本？

您可以看到我的脚本有 α、β、∑ 和更多特殊字符。

谢谢你们的帮助。

**HTML 代码**

```
 <script src="http://code.jquery.com/jquery.js"></script>

 <input type="submit" name="replace" id="replace" value="Replace" />

 <div class="my_div">Default1 content1</div>
 <div class="my_div">Default2 content2</div> 
```

**脚本**

```
$('#replace').click(function() {
    $('.my_div').text(function( idx, oldHtml){
        return oldHtml
            .replace("Default1", 'α')
            .replace("Default2", 'β')
            .replace("content1", '∑');
    });
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T13:13:25.507

您应该检查服务器的默认编码设置是否与文档编码匹配和/或在文档上指定正确的编码。这里有一些例子：http: [//www.w3.org/International/O-charset.en.php](http://www.w3.org/International/O-charset.en.php)

此外，您可能/必须对这些特殊字符（至少其中一些）进行 HTML 编码，以便正确显示它们。您可以使用 jQuery 自动转义它们：

`$('<div />').text(stringtoescape).html();`

或手动遵循此转换表[http://www.w3.org/TR/html4/sgml/entities.html#h-24.3](http://www.w3.org/TR/html4/sgml/entities.html#h-24.3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-22T16:27:38.883

我知道这是旧的，已经得到回答和接受，但是我在从 javascript/jquery 更改包含上述特殊字符的输入表单中的计算值字段时遇到了很多麻烦。我尝试过的任何事情都会导致输入表单字段被完整的转义字符串填充。Mihai 用 \u 把戏让我绕过了它。尔格：

带输入字段：

```
<input type="text" name="string" id="string" /> 
```

我做不到

```
$('#string').value('&Phi;') 
```

结果将是文字字符串 'Φ'

但能做到

```
$('#string').value('\u03a0') 
```

哪个有效。

这对大多数人来说可能是显而易见的，但我在这方面浪费了很多时间，而且由于有这么多通用查询术语，这是一个很难问的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T13:15:08.230

尝试以 utf-8 编码存储您的文件

# c# - 获取所有子文件夹而不使用预构建的 .net 对象

> ID：13109015
> 
> 赞同：1
> 
> 时间：2012-10-28T13:04:35.577
> 
> 标签：c#, .net, path

我正在尝试获取 W7 机器的 c:\Users\UserName 目录中所有文件夹的列表。

我使用`Directory.GetDirectories()`or时遇到的问题`Directory.GetFiles()`是我经常遇到“访问路径被拒绝”的异常。我在管理员模式下运行了 VS，但没有运气。我的 C# 中解释了原因[- 无法访问所有文件](https://stackoverflow.com/questions/13107407/c-sharp-cannot-access-all-files/13107447#13107447)

我想知道如何获取所有子文件夹的名称（无论文件夹中是否有任何文件），其中子文件夹可能是 N 深（因此，子文件夹的数量不确定）并将它们存储为列表。这样，通过 foreach 循环，我可以根据某些逻辑逐个文件夹检查，以确保我可以访问并且我想要访问！

以下代码仅查看 1 级深度：

```
 private List<string> GetAllFolders()
 {
     DirectoryInfo directoryInfo = new DirectoryInfo(this.sourceFolder);
     List<string> allFolders = new List<string>();

     foreach (DirectoryInfo subDirectoryInfo in directoryInfo.GetDirectories())
     {
         //logic
         allFolders.Add(subDirectoryInfo.FullName);
     }
     return allFolders;
 } 
```

有没有我可以使用的模式，或者有没有人有关于如何继续的例子或建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:24:42.287

你快到了。

```
private List<string> GetAllFolders()
{
    DirectoryInfo directoryInfo = new DirectoryInfo(this.sourceFolder);
    List<string> allFolders = new List<string>();

    foreach (DirectoryInfo subDirectoryInfo in directoryInfo.GetDirectories(("*.*", SearchOption.AllDirectories))
    {
        //logic
        allFolders.Add(subDirectoryInfo.FullName);
    }
    return allFolders;
} 
```

关于访问权限，您可能无法访问每个文件夹的末尾，但我认为某些特殊文件夹会发生这种情况，您必须以某种方式自行处理。否则这工作正常。

另请参阅：[迭代文件夹和子文件夹的最佳方法](https://stackoverflow.com/questions/5181405/best-way-to-iterate-folders-and-subfolders)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:25:27.487

我没有运行此代码，但您必须递归地遍历文件夹。我没有添加任何异常处理，除了'catch and continue'

```
private List<string> GetAllFolders()
{
   var allFolders = new List<string>();
   return GetAllFolders(this.sourceFolder);  
}

// recursively list all folders, catch and continue in case of errors
private List<string> GetAllFolders(string folder)
{
     DirectoryInfo directoryInfo = new DirectoryInfo(folder);
     List<string> allFolders = new List<string>();

     foreach (DirectoryInfo subDirectoryInfo in directoryInfo.GetDirectories())
     {
          //logic
         try {
           allFolders.Add(subDirectoryInfo.FullName);
          allFolders.AddRange(GetAllFolders(subDirectoryInfo.FullName));
        }
        catch (Exception exp)
        {
          // log rrors
          Debug.WriteLine(" exception for " + 
                              subDirectoryInfo.FullName + " : " + 
                            exp.Message);
                } 
            }
            return allFolders;
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T13:32:17.620

```
public void GetFolderList()
{
    var list = new List<string>();
    var root = new DirectoryInfo("c:\\");
    GetFoldersRecursive(root, list);
}

private static void GetFoldersRecursive(DirectoryInfo root, List<string> list)
{
    DirectoryInfo[] children;
    try
    {
        list.Add(root.FullName);
        children = root.GetDirectories();
    }
    catch(UnauthorizedAccessException t)
    {
        // access denied
        return;
    }

    foreach (var d in children)
        GetFoldersRecursive(d, list);
} 
```

如果您更喜欢使用更复杂的权限检查（而不是捕获异常），我建议您看看[这里](http://www.codeproject.com/Articles/14402/Testing-File-Access-Rights-in-NET-2-0)

# iphone - 如何检查我是否可以使用 NSError 从包中读取图像？

> ID：13109017
> 
> 赞同：0
> 
> 时间：2012-10-28T13:05:02.053
> 
> 标签：iphone, objective-c, ios, xcode

我需要检查图像是否被读取..我有这个代码：

```
[self setView];
-(void)setView{

for(int i = self.firstNumberOfImages; i <= self.lastNumberOfImages; i++)
{
    UIImage* image = [UIImage imageNamed:[NSString stringWithFormat:@"%@%d.%@",self.imageName,i,self.imageType]];
    NSLog(@"%d",i);
    [imgArray addObject:image];
}
......
} 
```

我想添加`NSError`到这段代码中......我如何确定我的图像将被加载而应用程序不会崩溃？（使用`NSError`）10x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:06:47.587

检查是否`imageNamed:`返回`nil`。

```
for(int i = self.firstNumberOfImages; i <= self.lastNumberOfImages; i++)
{
    UIImage* image = [UIImage imageNamed:[NSString 
                     stringWithFormat:@"%@%d.%@",self.imageName,i,self.imageType]];
    NSLog(@"%d",i);
    if (image) {
        [imgArray addObject:image];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T17:04:11.230

检查下面的代码

```
for(int i = self.firstNumberOfImages; i <= self.lastNumberOfImages; i++)
{
    UIImage* image = [UIImage imageNamed:[NSString 
                     stringWithFormat:@"%@%d.%@",self.imageName,i,self.imageType]];
    NSLog(@"%d",i);
    @try{
        [imgArray addObject:image];
    }
    @catch(exception e)
     {
        NSLog(@"ERROR");
    }
} 
```

# javascript - 此服务器 jsonp 响应是否有效？

> ID：13109022
> 
> 赞同：2
> 
> 时间：2012-10-28T13:05:50.803
> 
> 标签：javascript, jquery, ajax, json, jsonp

我是向服务器人员发送请求的客户端人员。我的最终目标是在**jsonp**中发送请求。

这是我发送请求时得到的服务器响应`?accept=json`（并且因为它不是 jsonp 而得到一个无效的会话错误）

```
{"errorCode":-15,"errorDescription":"SessionNotFoundException - Session not found","success":false,"payload":null} 
```

我可以阅读它，它很好。

**但是**，这是服务器响应`?accept=jsonp`：

```
jQuery171024326910870149732_1351429007451({"action":"", "type":"", "callerId":""}, {"errorCode":0,"errorDescription":"OK","success":true,"payload":null}); 
```

它是这两个对象的形式，我不知道如何阅读：`{a},{b}`。

当我使用 jQuery ajax 调用时，服务器数据的输出只是`{a}`一部分：

`Object {action: "", type: "", callerId: ""}`

**我的两个问题是：**

1.  带有 2 个对象 ( `{a},{b}`) 的服务器响应是否有效？服务器人员是否通过发送那种对象犯了错误或者它是有效的？
2.  如何读取 jsonp 对象？我的 ajax 调用有什么问题，我似乎无法正确阅读它？

这是我使用的 ajax 调用：

```
$.ajax({
            url:url,
            dataType:'jsonp',
            success:function(data){
                console.log("data is,"data")
                //if the call was success
                if (data.success) {

                    //if errors
                }   else {

                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T13:58:05.073

为了实际验证成功回调不能处理 2 个参数，我尝试了一个简单的测试，其中包含 2 个 arg 函数和 2 个传递给它的对象：

```
function test(a,b) {
    console.info(a);
}

test({"name":"test"},{"hello":"world"}); 
```

这成功了，因为我在 JavaScript 对象表示法中将两个单独的对象传递给了一个需要 2 个参数的函数。

接下来，我用一个简单的 PHP 脚本重新创建了一个示例响应：

```
<?php echo $_REQUEST["callback"]?>({"test":"test"},{"hello":"world"}); 
```

因此，下一步，我继续修改了成功回调，使其接受 2 个参数：

```
$.ajax({
            url:'http://local.sandbox.com/jsonp2/test.php',
            dataType:'jsonp',
            success:function(data, data2){
                console.log("data is " + data2)
                //if the call was success
                if(data.success) {
                   alert("yes");
                    //if errors
                }   else {
                    alert(data2.hello);
                }
            }
        }); 
```

[现在，根据jQuery AJAX Success Handler docs](http://api.jquery.com/jQuery.ajax/)，这是我遇到问题的地方：

> 成功（数据，文本状态，jqXHR）
> 
> Function, Array 请求成功时调用的函数。该函数传递了三个参数：
> 
> *   服务端返回的数据，根据dataType参数格式化；
> *   **描述状态的字符串；**
> *   和 jqXHR（在 jQuery 1.4.x 中，XMLHttpRequest）对象。
> 
> 从 jQuery 1.5 开始，success 设置可以接受一个函数数组。每个函数都会被依次调用。这是一个 Ajax 事件。
> 
> *   *重点是我的*

成功处理程序的第二个参数*始终*是响应的状态，所以我在控制台中的输出是“数据成功”，而 else 块中的警报是未定义的。

jQuery 的 jsonp 实现无疑是为处理回调中的单个对象而设计的，因为它替换了回调查询参数的自定义值，服务器将其用作“填充”或响应的包装器，通常形式为“jQuery1232432423432432” . 根据文档，成功处理程序采用 3 个参数，其中第一个是对象，最后两个由 jQuery 提供。填充函数只需要 1 个参数。因此，jQuery 无法解决这个问题。

但是，有一种技术仍然可以利用现有的服务器端响应，假设您无法控制服务器生成的内容。

* * *

## **解决方案：使用 Script Tag Remoting，不使用 jQuery：**

```
// this is a custom function to make jsonp requests to the server.
function jsonp(url, callback) {
    var script = document.createElement("script");
    script.setAttribute("type","text/javascript");
    script.setAttribute("src", url + "?callback="+callback + "&cachebuster="+new Date().getTime());
    document.getElementsByTagName("head")[0].appendChild(script);
} 
```

要调用该函数，请使用它代替 $.ajax 调用，但传入一个命名的回调处理程序除外：

```
jsonp(url, "myCustomSuccessFunction"); 
```

确保您定义了一个自定义的命名成功回调函数：

```
function myCustomSuccessFunction(data1, data2) {
    console.info(data1);  // contains first object
    console.info(data2);  // contains second object

    // do stuff w/said objects here

} 
```

# graphics - 为透明物体着色

> ID：13109024
> 
> 赞同：0
> 
> 时间：2012-10-28T13:06:11.350
> 
> 标签：graphics

我对光线追踪有疑问。我无法将透明对象的颜色放入文件中。透明物体被视为白色。怎么了 ？我在算法中忘记了什么吗？

注意：由于我的声誉，我无法将图像上传到 stackoverflow。

```
trace ( ray ) 
   intersect with objects
   for each light 
       if ( object in shadow )
              colour = black
       else
              diffuse 
              specular
   ambient
   color += trace ( reflect_ray )
   if ( object is transparent )
        color += trace ( transparent_ray ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:11:18.273

您不想直接添加透明光线，您需要混合它。

```
color = opacity * color + (1 - opacity) * trace( transparent_ray ) 
```

`opacity`定义对象的*不透明*程度。完全不透明的对象 ( `opacity = 1`) 根本不透明，因此透明光线不会影响颜色。完全透明的物体（`opacity = 0`），例如空气或玻璃（几乎）不会受到物体颜色的影响，因此光线的颜色就是透明光线的颜色。

# sql-server - 在没有架构的 SQL Server 中查询 XML

> ID：13109025
> 
> 赞同：2
> 
> 时间：2012-10-28T13:06:11.067
> 
> 标签：sql-server, xml, xquery

我有一个存储大量 XML 的数据库，其中包含有关安装我们公司产品的信息。没有为 XML 定义模式，也没有人拥有所有潜在标签的列表。

每条记录都有数百个这样的结构：

```
<array type="DWORD" name="m_somesetting.SMTPPorts" size="5"> 
   <set>19</set> 
   <set>1D0</set> 
   <set>14B</set> 
</array> 
```

我被要求创建一个表格，显示每个可能的标签一个值以及我们数以万计的记录中有多少具有该特定设置的计数。

有谁知道我如何自动化这个？我对如何对 XML 进行查询有一个合理的理解，但我需要一些方法来首先获取存在的每个标记，然后获取存在的每个唯一值，最后获取包含该值的记录计数。

关于如何将每个可能的标签手动编码到查询中的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T18:46:47.927

UDF 从 xml 创建表

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[XMLTable](@x XML)  
RETURNS TABLE 
AS RETURN 
WITH cte AS (  
SELECT 
        1 AS lvl,  
        x.value('local-name(.)','NVARCHAR(MAX)') AS Name,  
        CAST(NULL AS NVARCHAR(MAX)) AS ParentName, 
        CAST(1 AS INT) AS ParentPosition, 
        CAST(N'Element' AS NVARCHAR(20)) AS NodeType,  
        x.value('local-name(.)','NVARCHAR(MAX)') AS FullPath,  
        x.value('local-name(.)','NVARCHAR(MAX)')  
        + N'[' 
        + CAST(ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS NVARCHAR)  
        + N']' AS XPath,  
        ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS Position, 
        x.value('local-name(.)','NVARCHAR(MAX)') AS Tree,  
        x.value('text()[1]','NVARCHAR(MAX)') AS Value,  
        x.query('.') AS this,         
        x.query('*') AS t,  
        CAST(CAST(1 AS VARBINARY(4)) AS VARBINARY(MAX)) AS Sort,  
        CAST(1 AS INT) AS ID  
FROM @x.nodes('/*') a(x)  
UNION ALL 
SELECT 
        p.lvl + 1 AS lvl,  
        c.value('local-name(.)','NVARCHAR(MAX)') AS Name,  
        CAST(p.Name AS NVARCHAR(MAX)) AS ParentName, 
    CAST(p.Position AS INT) AS ParentPosition, 
        CAST(N'Element' AS NVARCHAR(20)) AS NodeType,  
        CAST(p.FullPath + N'/' + c.value('local-name(.)','NVARCHAR(MAX)') AS NVARCHAR(MAX)) AS FullPath,  
        CAST(p.XPath + N'/'+ c.value('local-name(.)','NVARCHAR(MAX)')+ N'['+ CAST(ROW_NUMBER() OVER(PARTITION BY c.value('local-name(.)','NVARCHAR(MAX)') 
        ORDER BY (SELECT 1)) AS NVARCHAR)+ N']' AS NVARCHAR(MAX)) AS XPath,  
        ROW_NUMBER() OVER(PARTITION BY c.value('local-name(.)','NVARCHAR(MAX)')
        ORDER BY (SELECT 1)) AS Position, 
        CAST( SPACE(2 * p.lvl - 1) + N'|' + REPLICATE(N'-', 1) + c.value('local-name(.)','NVARCHAR(MAX)') AS NVARCHAR(MAX)) AS Tree,  
        CAST( c.value('text()[1]','NVARCHAR(MAX)') AS NVARCHAR(MAX) ) AS Value, c.query('.') AS this,  
        c.query('*') AS t,  
        CAST(p.Sort + CAST( (lvl + 1) * 1024 + (ROW_NUMBER() OVER(ORDER BY (SELECT 1)) * 2) AS VARBINARY(4)) AS VARBINARY(MAX) ) AS Sort,  
        CAST((lvl + 1) * 1024 + (ROW_NUMBER() OVER(ORDER BY (SELECT 1)) * 2) AS INT)  
FROM cte p  
CROSS APPLY p.t.nodes('*') b(c)), cte2 AS (  
                                            SELECT 
                                            lvl AS Depth,  
                                            Name AS NodeName,  
                                            ParentName, 
                                            ParentPosition, 
                                            NodeType,  
                                            FullPath,  
                                            XPath,  
                                            Position, 
                                            Tree AS TreeView,  
                                            Value,  
                                            this AS XMLData,  
                                            Sort, ID  
                                            FROM cte  
UNION ALL 
SELECT 
        p.lvl,  
        x.value('local-name(.)','NVARCHAR(MAX)'),  
        p.Name, 
        p.Position, 
        CAST(N'Attribute' AS NVARCHAR(20)),  
        p.FullPath + N'/@' + x.value('local-name(.)','NVARCHAR(MAX)'),  
        p.XPath + N'/@' + x.value('local-name(.)','NVARCHAR(MAX)'),  
        1, 
        SPACE(2 * p.lvl - 1) + N'|' + REPLICATE('-', 1)  
        + N'@' + x.value('local-name(.)','NVARCHAR(MAX)'),  
        x.value('.','NVARCHAR(MAX)'),  
        NULL,  
        p.Sort,  
        p.ID + 1  
FROM cte p  
CROSS APPLY this.nodes('/*/@*') a(x)  
)  
SELECT 
        ROW_NUMBER() OVER(ORDER BY Sort, ID) AS ID,  
        ParentName, ParentPosition,Depth, NodeName, Position,   
        NodeType, FullPath, XPath, TreeView, Value, XMLData 
FROM cte2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:12:58.323

您应该能够相当轻松地从充满 XML 内容的表中提取所有不同的标签名称：

```
DECLARE @input TABLE (ID INT, XmlCOntent XML)

INSERT INTO @input VALUES(1, '<array type="DWORD" name="m_somesetting.SMTPPorts" size="5"> 
   <set>19</set> 
   <set>1D0</set> 
   <set>14B</set> 
</array>'), 
(2, '<array2 type="DWORD" name="m_somesetting.SMTPPorts" size="5"> 
   <set2>19</set2> 
   <set3>1D0</set3> 
   <set4>14B</set4> 
</array2>')

SELECT
    DISTINCT 
    Nodes.value('local-name(.)', 'varchar(50)')
FROM
    @input
CROSS APPLY 
    XmlContent.nodes('//*') AS Tbl(Nodes) 
```

请注意：我说的*很简单*——不是很快。这将搅动很长一段时间！但它仍然比手动完成所有操作要好:-)

# elasticsearch - 一般的弹性搜索

> ID：13109029
> 
> 赞同：1
> 
> 时间：2012-10-28T13:06:41.223
> 
> 标签：elasticsearch

我对弹性搜索或一般搜索完全陌生。我试图弄清楚它是如何工作的，但我不确定我是否理解正确。

对吗，例如，我用我的数据获取 JSON，我必须使用弹性搜索对其进行索引，并且通常不必关心另一个数据库？我的意思是，我不必自己创建数据库？

我希望我能解释我正在努力解决..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T20:27:57.877

是的，ElasticSearch 不仅可以在没有外部数据库的情况下工作，甚至可以充当数据库系统本身，因为它可以存储已被索引的原始 JSON 文档。当通过搜索查询或通过其 ID 找到文档时，您可以检索您发送到服务器的所有数据，就像在普通的 key-> value 文档数据库中一样。数据在[_source](http://www.elasticsearch.org/guide/reference/mapping/source-field.html)字段中可用。这对于索引和搜索不是必需的，可以关闭以节省存储空间，但默认打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:58:56.677

是的。只需将您的文档作为 JSON 结构发送，Elasticsearch 就会对其进行索引并使其可搜索。

问题是：这个文档来自哪里？是来自推特吗？从数据库？从用户界面？为了帮助您收集这些文档，您可以使用 Elasticsearch Rivers。

# android - onClick（错误）为先前显示的视图而触发？

> ID：13109032
> 
> 赞同：0
> 
> 时间：2012-10-28T13:07:15.500
> 
> 标签：android

我有两个片段：

*   第一个片段由中间的一个大按钮组成 - 我`OnClickListener`为此视图设置了一个（以编程方式），一旦单击，它将第一个片段替换为第二个片段。
*   第二个片段是一个空片段

首先，我显示片段编号。1\. 然后我按下按钮，正如预期的那样，我看到了第二个片段。

问题：一旦显示第二个片段并且我单击它的中间 - 它会触发**第一个片段**`OnClickListener`中按钮后面的代码，即使我目前正在显示一个没有按钮的空片段。

 **想法？

这是代码：

```
public void onLargeButtonClick(View view){
        secondFragment fragment = new secondFragment();
        fragmentFactory.replaceFragment(fragment);
}

void replaceFragment(Fragment fragment){
    FragmentManager fragmentManager = activity.getSupportFragmentManager();
    String fragmentName = fragment.getClass().getSimpleName();
    Fragment existingFragment = fragmentManager.findFragmentByTag(fragmentName);
    if (existingFragment != null)
        fragmentManager.popBackStack(fragmentName, FragmentManager.POP_BACK_STACK_INCLUSIVE);

        FragmentTransaction ft = activity.getSupportFragmentManager().beginTransaction();
        ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
        ft.replace(R.id.first_fragment, fragment);
        ft.addToBackStack(null);
        ft.commit();
} 
```

主布局包含我替换的片段

```
 <fragment
            android:name="com.app.firstfragment"
            android:id="@+id/first_fragment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            >
    </fragment> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:14:02.580

您可以通过将根布局元素之一设置为`android:clickable="true"`.

这将拦截对其的点击，并防止它们到达其下方的片段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:14:27.593

关于为什么会发生这种情况并不是一个很好的答案，但我的应用程序中发生了类似的事情。您可以尝试（或确保）几件事：

*   使用 FragmentManager 删除第一个片段
*   删除`OnClickListener`第一个片段的onPause中的按钮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:30:07.670

我认为你不能替换在 xml 中添加的片段。

首先删除`android:name="com.app.firstfragment"`

然后在您的活动中通过代码添加第一个片段

```
protected void onCreate(Bundle savedInstanceState) {
            Fragment firstFragment = new firstFragment();
            FragmentTransaction ft = getFragmentManager().beginTransaction();
            ft.add(R.id.first_fragment, firstFragment).commit();
    } 
```**

# install4j - 为 OS X 设置绝对工作目录

> ID：13109033
> 
> 赞同：2
> 
> 时间：2012-10-28T13:07:27.030
> 
> 标签：install4j

我目前正在为我的 Java 程序构建一个带有 Install4j 的 OS X 安装程序。我尝试为可执行文件设置工作目录。您可以选择“启动器”下的工作目录。不幸的是，您只能指定相对于可执行文件的目录。

是否可以指定一个绝对工作目录，例如`/$USER_HOME/Library/Preferences`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:24:24.190

您可以使用语法指定环境变量`${VARIABLE}`，所以`${HOME}/Library/Preferences`应该可以。

要为不同的平台设置不同的值，请使用编译器变量并在媒体向导的“自定义项目默认值->编译器变量”下覆盖其值。

# qt - 如何在 Qt 中不使用 QActions 翻译热键？

> ID：13109034
> 
> 赞同：0
> 
> 时间：2012-10-28T13:07:54.993
> 
> 标签：qt, translate

在我当前的项目中，我们使用 Qt 及其翻译系统来使 GUI 本地化为多种语言。

我的主要问题是热键的翻译。

当用户打开主菜单时，他可以看到所有菜单项和与之关联的热键。此信息存储在 QAction 中。当我们更改语言（例如更改为阿拉伯语）时，用户可以看到已翻译的菜单项文本，并且其热键也将被翻译。但我不想翻译热键。

我对这个问题进行了一些研究，发现 QtDesigner 中快捷方式的标志“可翻译”。但是这个标志并没有帮助，因为只有当我们想要将此快捷方式添加到我们的翻译系统时才需要它，例如不同语言的相同操作的不同热键。

主要问题是 Qt 通过使用[`QKeySquence::toString()`](https://qt-project.org/doc/qt-4.8/qkeysequence.html#toString). 但是这个方法会自动翻译“Ctrl”、“Del”、“Alt”等词，使用QShortcut上下文。并且所有 QShortcut 翻译都存储在`qm`我们项目中包含的 Qt 中的默认文件中。

那么如何*不翻译*热键呢？

# objective-c - 关联引用是如何实现的？

> ID：13109042
> 
> 赞同：5
> 
> 时间：2012-10-28T13:09:40.467
> 
> 标签：objective-c, associative

我在这里看到了一个非常好的示例： [Subclass UIButton to add a property](https://stackoverflow.com/questions/5500327/subclass-uibutton-to-add-a-property)

它是什么？您不能将对象添加到类别中。但是现在有了这个技巧，你就可以了。

那是什么？它是如何工作的？

Objective-c 对象已经有一些恒定数量的 ivar 指针，对吧？

现在又加了一个？他们是怎么想出来的？

我必须承认这是一个非常丑陋的符号。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T19:41:00.297

使用关联引用技巧，您实际上并没有*向 UIButton 对象*添加任何实例数据。相反，您使用一个完全独立的 Cocoa 工具来创建一个新的字典映射（或*关联*）现有 UIButton 对象与存储在堆中其他位置的数据。

你可以在不使用 Cocoa 的关联引用的情况下做同样的事情；它只会更丑陋，而且效率可能更低。在 Objective-C++ 中它会变成这样。（我什至不会尝试用 Objective-C 编写它，因为`CFMutableDictionary`两者`NSMutableDictionary`在几个层面上都有错误的行为，而且我不会从头开始编写整个东西。但是，C++`std::map`不能以我想使用的方式与`__weak`引用一起使用，所以我回退到这种低效`std::vector`的算法。对于那些不熟悉 C++ 的人：`std::vector`大致相当于 an `NSMutableArray`，除了你可以选择它是否保留其内容。）

关键是 UIButton 对象没有被改变；改变的是这本附加字典的内容。属性 getter 和 setter 只知道如何在该字典中查找内容，以便它*看起来*好像 UIButton 具有一个新属性。

```
#import "UIButton+Property.h"
#import <algorithm>
#import <vector>

typedef std::pair<__weak id, __strong id> EntryType;
static std::vector<EntryType> myAR;

@implementation UIButton(Property)

-(void) setProperty:(id)property
{
    for (int i=0; i < myAR.size(); ++i) {
        if (myAR[i].first == self) {
            myAR[i].second = property;
            return;
        }
    }
    myAR.push_back(EntryType(self, property));
}

-(id) property
{
    /* To save space, periodically erase the dictionary entries for
     * UIButton objects that have been deallocated. You can skip this
     * part, and even use NSMutableDictionary instead of this C++
     * stuff, if you don't care about leaking memory all over the place.
     */
    size_t n = myAR.size();
    for (size_t i=0; i < n; ++i) {
        if (myAR[i].first == nil)
            myAR[i] = myAR[--n];
    }
    myAR.resize(n);

    /* Look up "self" in our dictionary. */
    for (size_t i=0; i < myAR.size(); ++i) {
        EntryType &entry = myAR[i];
        if (entry.first == self) {
            return entry.second;
        }
    }
    return nil;
}

@end 
```

另见： http: [//labs.vectorform.com/2011/07/objective-c-associated-objects/](http://labs.vectorform.com/2011/07/objective-c-associated-objects/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-08-25T05:08:41.587

git 上有一个示例代码！点击[这里](https://github.com/thatzprem/AssociatedObjects-Example.git "解释一个对象（比如 NSString 对象）如何与一个 associatedKey 相关联，并且可以再次访问该值")！

# javascript - 根据javascript中对象的一个 属性的值对对象数组进行排序

> ID：13109047
> 
> 赞同：1
> 
> 时间：2012-10-28T13:10:43.457
> 
> 标签：javascript, arrays, sorting

> **可能重复：**
> [根据对象的属性之一对对象的 JavaScript 数组进行排序](https://stackoverflow.com/questions/5421253/sort-javascript-array-of-objects-based-on-one-of-the-objects-properties)

我有一个对象，它有一个名为 z 的属性：

```
function building(z)
{
  this.z = z;
} 
```

假设我创建了这个对象的 3 个实例：

```
a = new building(5)
b = new building(2)
c = new building(8) 
```

然后将这些实例放入一个数组中

```
buildings = []
buildings.push(a)
buildings.push(b)
buildings.push(c) 
```

**问题**

我将如何根据它包含的对象的*z属性***按升序对该数组进行排序？**排序后的最终结果应该是：

 *```
before -> buildings = [a, b, c] 
sort - > buildings.sort(fu)
after -> buildings = [b, a, c] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T13:12:33.677

您可以将比较函数传递给`.sort()`

```
function compare(a, b) {
  if (a.z < b.z)
     return -1;
  if (a.z > b.z)
     return 1;
  return 0;
} 
```

然后使用：

```
myarray.sort(compare) 
```

这是一些[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)*

# eclipse - 在 STS eclipse 中导入 hibernate-orm 作为 gradle 项目

> ID：13109048
> 
> 赞同：0
> 
> 时间：2012-10-28T13:10:58.580
> 
> 标签：eclipse, hibernate, import, gradle, sts-springsourcetoolsuite

尝试在 Eclipse 中导入 gradle 项目（hibernate-orm）并在构建模型期间出现异常：

```
org.gradle.api.GradleScriptException: A problem occurred evaluating project ':hibernate-core'.
at org.gradle.groovy.scripts.internal.DefaultScriptRunnerFactory$ScriptRunnerImpl.run(DefaultScriptRunnerFactory.java:54)
at org.gradle.configuration.DefaultScriptPluginFactory$ScriptPluginImpl.apply(DefaultScriptPluginFactory.java:127)
at org.gradle.configuration.BuildScriptProcessor.evaluate(BuildScriptProcessor.java:38)
at org.gradle.configuration.LifecycleProjectEvaluator.evaluate(LifecycleProjectEvaluator.java:43)
at org.gradle.api.internal.project.AbstractProject.evaluate(AbstractProject.java:463)
at org.gradle.api.internal.project.AbstractProject.evaluate(AbstractProject.java:75)
at org.gradle.configuration.ProjectEvaluationConfigurer.execute(ProjectEvaluationConfigurer.java:23)
at org.gradle.configuration.ProjectEvaluationConfigurer.execute(ProjectEvaluationConfigurer.java:21)
at org.gradle.configuration.DefaultBuildConfigurer$1.execute(DefaultBuildConfigurer.java:38)
at org.gradle.configuration.DefaultBuildConfigurer$1.execute(DefaultBuildConfigurer.java:35)
at org.gradle.api.internal.project.AbstractProject.configure(AbstractProject.java:439)
at org.gradle.api.internal.project.AbstractProject.allprojects(AbstractProject.java:434)
at org.gradle.configuration.DefaultBuildConfigurer.configure(DefaultBuildConfigurer.java:35)
at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:139)
at org.gradle.initialization.DefaultGradleLauncher.doBuild(DefaultGradleLauncher.java:110)
at org.gradle.initialization.DefaultGradleLauncher.getBuildAnalysis(DefaultGradleLauncher.java:89)
at org.gradle.tooling.internal.provider.BuildModelAction.run(BuildModelAction.java:48)
at org.gradle.tooling.internal.provider.DelegatingBuildModelAction.run(DelegatingBuildModelAction.java:42)
at org.gradle.tooling.internal.provider.ConfiguringBuildAction.run(ConfiguringBuildAction.java:94)
at org.gradle.launcher.exec.InProcessGradleLauncherActionExecuter.execute(InProcessGradleLauncherActionExecuter.java:39)
at org.gradle.launcher.daemon.server.exec.ExecuteBuild.doBuild(ExecuteBuild.java:45)
at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.WatchForDisconnection.execute(WatchForDisconnection.java:45)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.ResetDeprecationLogger.execute(ResetDeprecationLogger.java:24)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.StartStopIfBuildAndStop.execute(StartStopIfBuildAndStop.java:28)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.ReturnResult.execute(ReturnResult.java:34)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.ForwardClientInput$4.call(ForwardClientInput.java:116)
at org.gradle.launcher.daemon.server.exec.ForwardClientInput$4.call(ForwardClientInput.java:114)
at org.gradle.util.Swapper.swap(Swapper.java:38)
at org.gradle.launcher.daemon.server.exec.ForwardClientInput.execute(ForwardClientInput.java:114)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.LogToClient.doBuild(LogToClient.java:60)
at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.EstablishBuildEnvironment.doBuild(EstablishBuildEnvironment.java:61)
at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.StartBuildOrRespondWithBusy.doBuild(StartBuildOrRespondWithBusy.java:48)
at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.HandleStop.execute(HandleStop.java:34)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.CatchAndForwardDaemonFailure.execute(CatchAndForwardDaemonFailure.java:32)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.HandleClientDisconnectBeforeSendingCommand.execute(HandleClientDisconnectBeforeSendingCommand.java:21)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.StopConnectionAfterExecution.execute(StopConnectionAfterExecution.java:27)
at org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)
at org.gradle.launcher.daemon.server.exec.DefaultDaemonCommandExecuter.executeCommand(DefaultDaemonCommandExecuter.java:54)
at org.gradle.launcher.daemon.server.Daemon$1$1.run(Daemon.java:123)
at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:66)
 Caused by: org.gradle.api.plugins.PluginInstantiationException: Could not create plugin of type 'MatrixTestingPlugin'.
at org.gradle.api.internal.plugins.DefaultPluginRegistry.loadPlugin(DefaultPluginRegistry.java:68)
at org.gradle.api.internal.plugins.DefaultPluginRegistry.loadPlugin(DefaultPluginRegistry.java:54)
at org.gradle.api.internal.plugins.DefaultProjectsPluginContainer.providePlugin(DefaultProjectsPluginContainer.java:106)
at org.gradle.api.internal.plugins.DefaultProjectsPluginContainer.addPluginInternal(DefaultProjectsPluginContainer.java:71)
at org.gradle.api.internal.plugins.DefaultProjectsPluginContainer.apply(DefaultProjectsPluginContainer.java:41)
at org.gradle.api.internal.plugins.DefaultObjectConfigurationAction.applyPlugin(DefaultObjectConfigurationAction.java:90)
at org.gradle.api.internal.plugins.DefaultObjectConfigurationAction.access$100(DefaultObjectConfigurationAction.java:32)
at org.gradle.api.internal.plugins.DefaultObjectConfigurationAction$2.run(DefaultObjectConfigurationAction.java:63)
at org.gradle.api.internal.plugins.DefaultObjectConfigurationAction.execute(DefaultObjectConfigurationAction.java:114)
at org.gradle.api.internal.project.AbstractProject.apply(AbstractProject.java:841)
at org.gradle.api.Project$apply.call(Unknown Source)
at org.gradle.api.internal.project.ProjectScript.apply(ProjectScript.groovy:34)
at org.gradle.api.Script$apply.callCurrent(Unknown Source)
at hibernate_core_7q7cqc9dhu87lh08q18h1n9i8.run(/home/user/development/linux/hibernate-workspace/hibernate-orm/hibernate-core/hibernate-core.gradle:3)
at org.gradle.groovy.scripts.internal.DefaultScriptRunnerFactory$ScriptRunnerImpl.run(DefaultScriptRunnerFactory.java:52)
... 55 more
 Caused by: java.lang.NullPointerException
at org.hibernate.build.gradle.util.Jdk.<init>(Jdk.java:64)
at org.hibernate.build.gradle.util.Jdk.<init>(Jdk.java:52)
at org.hibernate.build.gradle.testing.matrix.MatrixTestingPlugin.<init>(MatrixTestingPlugin.groovy:65)
at org.gradle.api.internal.plugins.DefaultPluginRegistry.loadPlugin(DefaultPluginRegistry.java:63)
... 69 more 
```

如何解决此异常？我正在使用 gradle eclipse 插件。然后出现同样的问题，然后我将项目导入为 eclipse 项目（成功），然后尝试添加 Gradle 支持。

*   出了什么问题：评估项目“：hibernate-core”时出现问题。

    > 无法创建“MatrixTestingPlugin”类型的插件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T18:17:38.047

JAVA_HOME 必须在环境中指定。例如在 /etc/environment 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T09:15:58.477

最后的评论是正确的。正确的程序是：

```
./gradlew eclipse 
```

如果对依赖项进行了更改，最好运行：

```
./gradlew cleanEclipse eclipse 
```

另请参阅[https://community.jboss.org/wiki/BuildingHibernateORM4x5x#Eclipse](https://community.jboss.org/wiki/BuildingHibernateORM4x5x#Eclipse)和[https://community.jboss.org/wiki/ContributingToHibernateUsingEclipse](https://community.jboss.org/wiki/ContributingToHibernateUsingEclipse)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-01T04:41:33.527

我将此行添加到 /etc/environment 并在几秒钟内工作，哇。感谢@Vyacheslav

> JAVA_HOME="/usr/lib/jvm/java-7-openjdk-i386"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-17T08:34:38.087

定义 java 环境时，请确保它是完整的 java 安装，即包含 javac 的版本。

# objective-c - 为标准输出设置 NSFileHandle 来终止 NSTask

> ID：13109049
> 
> 赞同：1
> 
> 时间：2012-10-28T13:11:08.567
> 
> 标签：objective-c, cocoa, nstask, nsfilehandle

我有一批创建和运行`NSTask`实例的代码。在运行之前，我为任务的标准输出设置了一个`NSFileHandle`女巫直接写入我创建的文件。

有时 NSTask 在完成之前被代码（通过发送`terminate`命令）终止，有时它在没有任何外部终止的情况下完成。

当 NSTask 成功完成时，我设置的将输出写入的文件应该是：full of text。但是，当我在代码中终止任务时，文件*没有任何内容*，即使我知道 NSTask 正在生成输出。

这是我的代码：

```
// Create task
task = [NSTask new];
[task setLaunchPath: @"..."];
[task setArguments: [NSArray arrayWithObjects: ..., nil]];

// Create output file
NSString* path = @"...";
[[NSFileManager defaultManager] createFileAtPath: path contents: nil attributes: nil];

// Create output file handle
NSFileHandle* outputFile = [NSFileHandle fileHandleForWritingAtPath: path];
[task setStandardOutput: outputFile];

[task launch];
// Etc... 
```

我认为这种方法会将数据写入文件，因为它是由命令生成的。如果这是真的，那么即使命令被强制终止，文件也应该有一些信息。那为什么不呢？

以防万一我弄错了并且这不会在生成的输出时保存输出，您能指出我这样做的方法吗？

# excel - 范围结束 xldown 不起作用

> ID：13109050
> 
> 赞同：0
> 
> 时间：2012-10-28T13:11:13.907
> 
> 标签：excel, vba

我正在尝试选择一行，然后 CtrlShift 结束，但没有 .SELECT 等...

```
 Set rng = wsDATA.Range("A8").EntireRow
        Set rng = Range(rng, rng.End(xlDown)) 
```

但我`Application Defined or Object Defined Error`在第二行得到一个。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:59:07.133

我经常被提醒的一件事是在遇到问题时重新阅读代码并确保一切都合格。

在这种情况下，我应该`wsDATA`在 .range 之前使用我的工作表对象

```
 Set rng = wsDATA.Range("A8:A8").EntireRow
        Set rng = wsDATA.Range(rng, rng.End(xlDown)) 
```

# c# - RX2.0：处理 EventLoopScheduler 后的 ObjectDisposedException

> ID：13109054
> 
> 赞同：5
> 
> 时间：2012-10-28T13:11:53.993
> 
> 标签：c#, system.reactive

我们最近将系统从 RX 1.11111 移植到 RX 2.0 并发现了这个问题。我们为 ObserveOn 使用 EventLoopScheduler，如下所示：

```
IDisposable subscription = someSubject
    .ObserveOn(m_eventLoopScheduler)
    .SomeMoreRXFunctions()
    .Subscribe((something)=>something) 
```

调度程序位于应用程序出口 ( `m_eventLoopScheduler.Dispose`) 上。在此之前，我们处理所有对 observable ( `subscription.Dispose`) 的订阅。

尽管如此，我们还是得到`ObjectDisposedException`了`EventLoopScheduler.Schedule`. 不可能捕获该异常，因为它源自 RX 线程。这几乎就像 Dispose 并没有摆脱某个队列中的所有项目。

我们试图删除对的调用，`EventLoopScheduler.Dispose`异常消失了。但是，`SomeMoreRXFunctions()`尽管所有订阅都已处理完毕，但其中的代码又执行了大约 10 次。

还有其他方法可以正确关闭`EventLoopScheduler`吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-31T22:15:10.423

## 关于订阅的一些观察

（对不起，无法抗拒双关语！）`IObservable<out T>`，几乎每个 Rx 运算符实现的接口，只有一个重要的方法：

```
IDisposable Subscribe(IObserver<T> observer); 
```

观察者（实现`IObserver<T>`）完全通过此方法及其返回值的处置可以确定订阅何时开始和结束。

当订阅属于链的一部分的 Observable 时，*通常*（直接或间接），这将导致订阅更进一步的链。确切地说，是否以及何时发生这种情况取决于给定的 Observable。

在许多情况下，收到的订阅与做出的订阅之间的关系不是一对一的。这方面的一个例子是 Publish()，它最多只能有一个对其源的订阅，而不管它收到多少订阅。这确实是 Publish 的全部意义所在。

在其他情况下，这种关系具有时间方面。例如， Concat() 在第一个流订阅之前不会订阅它的第二个流`OnCompleted()`——这可能永远不会！

值得花一点时间来研究一下[Rx 设计指南](http://go.microsoft.com/fwlink/?LinkID=205219)，因为它们有一些非常相关的内容要说：

### Rx 设计指南

> 4.4\. 假设尽最大努力停止取消订阅上的所有未完成工作。当对可观察订阅调用取消订阅时，可观察序列将尽最大努力尝试停止所有未完成的工作。这意味着任何尚未开始的排队工作都不会开始。
> 
> 任何已经在进行中的工作可能仍会完成，因为中止正在进行的工作并不总是安全的。这项工作的结果不会发送给任何先前订阅的观察者实例。

### 底线

注意这里的含义；底线是，*当任何上游订阅可能被制作或处置时，它完全取决于 Observable 的实现*。换句话说，**绝对不能保证**处置订阅会导致 Observable 处置它直接或间接进行的任何或所有订阅。这适用于运营商使用的任何其他资源（例如计划的操作）或其上游订阅。

最好的希望是，*每个*上游运营商的作者确实尽了最大的努力，停止了所有优秀的工作。

### 回到问题（终于！）

如果没有看到`SomeMoreRXFunctions`我无法确定的内容，但您看到的异常似乎很可能是由于 - 尽管处理了您知道的订阅 - 通过处理调度程序，您已经从下面撕下了地毯英尺仍在运行的订阅。实际上，您导致了这种情况：

```
void Main()
{
    var scheduler = new EventLoopScheduler();

    // Decide it's time to stop
    scheduler.Dispose();

    // The next line will throw an ObjectDisposedException
    scheduler.Schedule(() => {});
} 
```

编写一个可能导致此问题的完全合理的运算符很容易——即使是不直接使用调度程序的运算符！考虑一下：

```
public static class ObservableExtensions
{
    public static IObservable<TSource> ReasonableDelay<TSource, TDelay>
        (this IObservable<TSource> source, IObservable<TDelay> delay)
    {
        return Observable.Create<TSource>(observer =>
        {        
            var subscription = new SerialDisposable();
            subscription.Disposable = delay
                .IgnoreElements()
                .Subscribe(_ => {}, () => {
                    Console.WriteLine("Waiting to subscribe to source");
                    // Artifical sleep to create a problem
                    Thread.Sleep(TimeSpan.FromSeconds(2));
                    Console.WriteLine("Subscribing to source");
                    // Is this line safe?
                    subscription.Disposable = source.Subscribe(observer);
                }); 
            return subscription;
        });
    }    
} 
```

一旦传递的延迟 observable 完成，此运算符将订阅源。看看它有多合理 - 它使用 a`SerialDisposable`将两个潜在的时间上独立的订阅正确地呈现给它的观察者作为一个一次性的。

然而，颠覆这个运算符并让它引发异常是微不足道的：

```
void Main()
{
    var scheduler = new EventLoopScheduler();
    var rx = Observable.Range(0, 10, scheduler)
                       .ReasonableDelay(Observable.Timer(TimeSpan.FromSeconds(1)));
    var subs = rx.Subscribe();

    Thread.Sleep(TimeSpan.FromSeconds(2));
    subs.Dispose();
    scheduler.Dispose();    
} 
```

这里发生了什么事？我们正在`Range`EventLoopScheduler 上创建一个，但附加我们使用它的默认调度程序`ReasonableDelay`创建的延迟流。`Timer`

现在我们订阅，等到我们的延迟流完成，然后我们以“正确的顺序”处理我们的订阅和 EventLoopScheduler。

我插入的人为延迟`Thread.Sleep`确保了很容易自然发生的竞争条件 - 延迟已完成，订阅已被处理，但阻止`Range`操作员访问已处理的 EventLoopScheduler 为时已晚。

一旦延迟部分完成，我们甚至可以加强我们的合理努力来检查观察者是否取消订阅：

```
// In the ReasonableDelay method
.Subscribe(_ => {}, () => {        
    if(!subscription.IsDisposed) // Check for unsubscribe
    {
        Console.WriteLine("Waiting to subscribe to source");
        // Artifical sleep to create a problem            
        Thread.Sleep(TimeSpan.FromSeconds(2));
        Console.WriteLine("Subscribing to source");
        // Is this line safe?                    
        subscription.Disposable = source.Subscribe(observer);
    }
}); 
```

它不会有帮助。也没有办法纯粹在这个运算符的上下文中使用锁定语义。

### 你做错了什么

你没有处理那个 EventLoopScheduler 的事情！一旦您将其传递给其他 Rx 操作员，您就已将其责任转嫁给了其他人。由 Rx 操作员遵循指导方针并尽可能及时地清理他们的订阅 - 这意味着直接或间接取消 EventLoopScheduler 上的任何未决计划项目并停止任何进一步的调度，以便队列尽快清空可能的。

在上面的示例中，您可以将问题归因于对多个调度程序的有些人为的使用以及在 ReasonableDelay 中的强制休眠 - 但不难想象一个操作员无法立即清理的真实场景。

本质上，通过处理 Rx 调度程序，您正在执行与线程中止等效的 Rx。就像在那种情况下一样，您可能需要处理异常！

正确的做法是揭开神秘面纱`SomeMoreRXFunctions()`，并确保他们尽可能地遵守准则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T17:25:52.080

刚刚注意到这个问题是这个问题的链接： [Reactive Rx 2.0 EventLoopScheduler ObjectDisposedException after dispose](https://stackoverflow.com/questions/15675900/reactive-rx-2-0-eventloopscheduler-objectdisposedexception-after-dispose/15688255#15688255)

应在此处重新发布我在此处所做的事情-我不知道有任何方法可以“刷新”调度程序，但是您可以通过这种方式包装/处理不可避免的“对象已处理”异常：

```
EventLoopScheduler scheduler = new EventLoopScheduler();
var wrappedScheduler = scheduler.Catch<Exception>((ex) => 
{
    Console.WriteLine("Got an exception:" + ex.ToString());
    return true;
});

for (int i = 0; i < 100; ++i)
{
    var handle = Observable.Interval(TimeSpan.FromMilliseconds(1))
                           .ObserveOn(wrappedScheduler)
                           .Subscribe(Observer.Create<long>((x) => Thread.Sleep(1000)));

    handles.Add(handle);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-13T12:33:40.453

我们遇到了同样的问题，最终做了以下处理 EventLoopScheduler 没有例外：

`scheduler.Schedule(() => scheduler.Dispose());`

如果您在执行此操作之前正确处置所有订阅（您说您已经这样做了），则 Dipose() 调用是最后一个计划的操作，并且所有其他挂起的操作都可以在调用 Dispose 之前完成。

为了使其更加健壮/可重用，您可以创建自己的 IScheduler 实现，包装 EventLoopScheduler 将所有操作委托给它 + 实现 Dispose，如上所示。最重要的是，您可以在 Schedule 方法中实现守卫，以防止在调用 Dispose 后调度操作（例如，如果您忘记取消订阅某些观察者）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T14:27:49.433

部分解决。案件比这里显示的要复杂得多。链条是这样的：

var 已发布 = someSubject.ObserveOn(m_eventLoopScheduler).SomeMoreRXFunctions().Publish();

IDisposable 一次性 1 = 已发布.Connect();

IDisposable 一次性2 = 已发布。订阅（（某事）=>某事）；

如果我同时处理了一次性 1 和一次性 2，那么 SomeMoreRXFunctions() 中的代码将不再执行。另一方面，尝试处理调度程序本身仍然会引发相同的异常。

不幸的是，我无法用更简单的代码重现该问题。这可能表明我还缺少其他东西。

这是一个我们可以接受的解决方案，但我仍然希望找到更好的方法来一次关闭调度程序，而不会出现异常。

# collections - 从主干集合中删除项目

> ID：13109057
> 
> 赞同：6
> 
> 时间：2012-10-28T13:12:38.960
> 
> 标签：collections, backbone.js

我有以下代码。一切正常，但我试图弄清楚如何从集合中删除一个项目（注意：我是 Backbone 的新手）。我已经查看了其他几个帖子，但我似乎可以弄清楚：

```
Todos = (function(){

//////////////////////////
// 
//  MODEL
// 
//////////////////////////

var TodoModel = Backbone.Model.extend({

    defaults: {
        item: null
    }

});

//////////////////////////
// 
//  COLLECTION
// 
//////////////////////////

var TodoCollection = Backbone.Collection.extend({

    model: TodoModel

});

//////////////////////////
// 
//  VIEW
// 
//////////////////////////

var TodoView = Backbone.View.extend({

    el: $('#todos'),

    itemField: $('#new-item'),

    initialize: function(){
        this.el = $(this.el);
    },

    events: {
        'submit form': 'addItem',
        'click .remove-item': 'removeItem',
        // Debug
        'click #print-collection': 'printCollection'
    },

    template: $('#item-template').html(),

    render: function(i) {
        var templ = _.template(this.template);
        this.el.children('ul').append(templ({item: i}));
    },

    addItem: function(e) {
        e.preventDefault();
        item = this.itemField.val();
        // Call render
        this.render(item);
        // Clear field
        this.itemField
            .val('')
            .focus();
        // Add to collection
        var newItem = new TodoModel({
            item: item
        });
        this.collection.add(newItem);
    },

    removeItem: function(e) {
        $(e.target).parent('li')
            .fadeOut(300,function() {
                $(this).remove();
            });
        // NEED TO REMOVE FROM COLLECTION...

    },

    printCollection: function(){
        this.collection.each(function(item) {
            console.log(item.get('item'));
        });
    }

});

//////////////////////////
// 
//  SELF
// 
//////////////////////////

self = {};
self.start = function(){
    new TodoView({collection: new TodoCollection()});
};
return self;

}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T14:28:52.797

您可以使用主干的[`remove`](http://backbonejs.org/#Collection-remove)方法从集合中删除模型：

> 从集合中删除一个模型（或模型数组）。触发“删除”事件，您可以使用静默来抑制该事件。如果您是侦听“删除”事件的回调，则从集合中删除模型的索引可用作 options.index。

但是，如果您想这样做，则必须有一种方法来获取要从单击事件中删除的模型。基本上有两种方法可以做到这一点：

1.  将模型的 id 添加到触发事件的元素（例如作为`data-id`属性），以便事件处理程序可以在调用时获取该 id 并使用它来获取模型（在这种情况下将其从集合中删除）。
2.  为每个渲染的模型创建一个子视图，这样就不需要 id 属性。

[Derick Bailey](http://lostechies.com/derickbailey/2011/10/11/backbone-js-getting-the-model-for-a-clicked-element/)有一篇很棒的文章，关于每种方法的优缺点，我建议您看看（我基本上在这里转述了他的意思）。

希望有帮助。

# erlang - 使用 yaws_api 特定代码时，Yaws“进程死亡”

> ID：13109062
> 
> 赞同：0
> 
> 时间：2012-10-28T13:12:59.130
> 
> 标签：erlang, yaws

我有一个小的 yaws appmod 测试：

```
-module(webservice).
-include("../include/yaws_api.hrl").
-compile(export_all).

http(parse_query,Arg) ->
    yaws_api:parse_query(Arg);

out(Arg) -> 
    {html, [http(parse_query,Arg)]}. 
```

当运行 yaws_api:parse_query 函数时，我从 yaws 交互模式得到以下错误报告：

```
Yaws process died: {function_clause,
                   [{yaws_server,binary_size,
                        [0,{"i",undefined}],
                        [{file,"yaws_server.erl"},{line,3015}]},
                    {yaws_server,binary_size,2,
                        [{file,"yaws_server.erl"},{line,3018}]},
                    {yaws_server,binary_size,2,
                        [{file,"yaws_server.erl"},{line,3018}]},
                    {yaws_server,deflate_accumulated,4,
                        [{file,"yaws_server.erl"},{line,3712}]},
                    {yaws_server,deliver_accumulated,4,
                        [{file,"yaws_server.erl"},{line,3666}]},
                    {yaws_server,finish_up_dyn_file,2,
                        [{file,"yaws_server.erl"},{line,2745}]},
                    {yaws_server,aloop,4,
                        [{file,"yaws_server.erl"},{line,1175}]},
                    {yaws_server,acceptor0,2,
                        [{file,"yaws_server.erl"},{line,1016}]}]} 
```

appmod 在配置中设置：

```
<server localhost>
    port = 8080
    listen = 127.0.0.1
    #docroot = /usr/share/yaws
    docroot = /usr/lib/yaws/www
    appmods = </,webservice>
    # dir_listings = true
</server> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T19:38:08.220

尽管您没有显示它，但您尝试访问的 URL 似乎有一个查询字符串，其中至少有一个名为 的变量`i`，如下所示：

```
http://example.com/foo?i=10 
```

对于该 URL，`yaws_api:parse_query/1`将 return `[{"i","10"}]`，然后您尝试使用该`{html, iolist()}`构造将其作为 HTML 返回到 Yaws。不幸的是，`[{"i","10"}]`它不是 iolist、字符串或二进制文件，因此 Yaws 失败了。

您可以通过使用调用转换`[{"i","10"}]`为字符串来解决此问题，如下所示：`yaws_api:f/2`

```
out(Arg) ->
    {html, yaws_api:f("~p", [http(parse_query,Arg)])}. 
```

或使用标准`io_lib:format/2`调用：

```
out(Arg) ->
    {html, io_lib:format("~p", [http(parse_query,Arg)])}. 
```

该`yaws_api:f/2`函数只是`io_lib:format/2`.

# css - 字体在 Mac 上不显示

> ID：13109063
> 
> 赞同：0
> 
> 时间：2012-10-28T13:13:10.727
> 
> 标签：css, macos, font-face

我在一个网站上有一个非常奇怪的问题。

我们最近推出了一个[**网站**](http://www.makeyourday.gr)，该网站在 PC 上运行良好。但是对于 Mac，浏览器根本不显示任何字体。

我`font-face`用来包含特定字体，并且有 2 种不同的样式表，具体取决于屏幕宽度。我尝试了这里找到的几个选项，但似乎都没有。我在 css 中使用的最后一个语法是这样的

```
@font-face {
    font-family:'ChollaSansGr';
    src: url('http://:/')format('IE-No-404'),url('./fonts/ChSaGrRg.ttf') format('truetype');
    font-style: normal;
    font-weight: 700;
} 
```

所以我的问题是，是否有人可以帮助我解决问题或就问题的根源提出建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:33:58.197

如果您使用的是 Safari，我在网上找到了这个解决方案：

> 好吧，事实证明我确实解决了它，至少到目前为止在 Mac 上是这样。这里是：
> 
> 创建 webkits 的 font-squirrel 和字体注册表在 URL 周围使用 " 和 ' 生成 CSS。这似乎使事情变得更糟。他们还将所有的权重和样式设置为正常，这似乎也造成了严重破坏。
> 
> 这是字体松鼠为 Lato 的 2 个面生成的代码：

```
@font-face {
    font-family: 'LatoBlackItalic';
    src: url('Lato-BlackItalic-webfont.eot');
    src: url('Lato-BlackItalic-webfont.eot?#iefix') format('embedded-opentype'),
         url('Lato-BlackItalic-webfont.woff') format('woff'),
         url('Lato-BlackItalic-webfont.ttf') format('truetype'),
         url('Lato-BlackItalic-webfont.svg#LatoBlackItalic') format('svg');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'LatoBlack';
    src: url('Lato-Black-webfont.eot');
    src: url('Lato-Black-webfont.eot?#iefix') format('embedded-opentype'),
         url('Lato-Black-webfont.woff') format('woff'),
         url('Lato-Black-webfont.ttf') format('truetype'),
         url('Lato-Black-webfont.svg#LatoBlack') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

> 这是我将其更改为实际适用于 Safari 和 Chrome 和 Firefox 的内容：

```
@font-face {
   font-family: Lato;
    src: url(../../fonts/Lato-BlackItalic-webfont.eot);
    src: url(../../fonts/Lato-BlackItalic-webfont.eot?#iefix) format(embedded-opentype),
         url(../../fonts/Lato-BlackItalic-webfont.woff) format(woff),
         url(../../fonts/Lato-BlackItalic-webfont.ttf) format(truetype),
         url(../../fonts/Lato-BlackItalic-webfont.svg#LatoBlackItalic) format(svg);
    font-weight: 900;
    font-style: italic;
}

@font-face {
    font-family: Lato;
    src: url(../../fonts/Lato-Black-webfont.eot);
    src: url(../../fonts/Lato-Black-webfont.eot?#iefix) format(embedded-opentype),
         url(../../fonts/Lato-Black-webfont.woff) format(woff),
         url(../../fonts/Lato-Black-webfont.ttf) format(truetype),
         url(../../fonts/Lato-Black-webfont.svg#LatoBlack) format(svg);
    font-weight: 900;
    font-style: normal;
} 
```

链接在这里：~~[http ://css-tricks.com/forums/discussion/10797/font-face-not-working-in-only-safari-/p1](http://css-tricks.com/forums/discussion/10797/font-face-not-working-in-only-safari-/p1)~~

希望这可以帮助。

# ruby-on-rails - 如何在 Ruby on Rails 中将整数显示为 6 位值？

> ID：13109068
> 
> 赞同：0
> 
> 时间：2012-10-28T13:13:50.930
> 
> 标签：ruby-on-rails, ruby

如何格式化 text_field 中的整数，使其始终由 6 位数字组成？

因此，例如，当整数存储`1`在数据库中时，在 text_field 中它会说：`000001`。用户还应该能够编辑这些值，但不能减少或超过位数。

我尝试了这样的事情，但它对我不起作用：

```
def formatted_number(int)
  int.to_s.rjust(6, '0')
end 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:16:00.423

使用字符串格式：

```
def formatted_number(int)
  '%06d' % int
end

formatted_number(123)
#=> "000123" 
```

为了便于阅读，您还可以使用显式调用`Kernel#format`：

```
def formatted_number(int)
  format '%06d', int
end 
```

[有关`Kernel#format`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-sprintf)格式字符串的语法，请参阅[文档](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-sprintf)。

# c - 需要澄清 LLVM C 方法

> ID：13109071
> 
> 赞同：4
> 
> 时间：2012-10-28T13:14:25.950
> 
> 标签：c, llvm

我正在使用 C 和 LLVM 编写一些代码。我知道`LLVMGetOperand`返回 a`LLVMValueRef`但我想知道它到底是什么，因为它似乎`LLVMValueRef`可以是许多不同的东西。是否`LLVMGetOperand`返回创建操作数的指令？

我最终需要做的是获取指令操作数并获取创造价值的指令。如在

```
%3 = ADD %1 %2
...
%5 = ADD ...
...
%8 = SUB %3 %5 
```

如果我知道指令`%8 = SUB %3 %5`，我想得到操作数`%3`，`%5`然后用这些值得到指令`%3 = ADD %1 %2`和`%5 = ADD ...`。我知道我需要使用`LLVMGetOperand()`，但我不知道它返回什么以及如何使用它来获得我需要的指令。如果它只是返回指令会很好。

我也调查了`LLVMGetFirstUse()`。是否`LLVMGetFirstUse()`接受一条指令，然后返回该指令产生的值的第一次使用？

我知道[llvm.org](http://llvm.org)并一直在使用它，我只需要比该网站上提供的更多说明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:09:05.917

由于 C 绑定反映了 C++ 代码的结构，因此熟悉 C++ 中的工作方式通常是一个好主意。一个起点是[LLVM Programmer's Manual](http://llvm.org/docs/ProgrammersManual.html)。

你提到的`ValueRef`只是`Value*`在C代码中。以下[是手册中的描述](http://llvm.org/docs/ProgrammersManual.html#Value)：

> 该类`Value`是 LLVM Source 基础中最重要的类。它表示一个类型化的值，可以（除其他外）用作指令的操作数。有很多不同的类型 `Values`，例如`Constants`, `Arguments`。甚至`Instructions`和`Functions` 是`Values`。

现在，为了组装基本块，您通常使用`IRBuilder`该类。在 C 代码中，这对应于`LLVMBuild*`函数族。例如，这里是用于创建`sub`指令的函数的签名：

```
LLVMValueRef LLVMBuildSub(LLVMBuilderRef, LLVMValueRef LHS, LLVMValueRef RHS,
                          const char *Name); 
```

第一个参数是对`IRBuilder`对象的引用，第二个是第一个操作数，第三个是第二个操作数，最后一个是结果值的可选名称。所以你的例子看起来像这样（未经测试）：

```
/* I'm assuming that you have already created a basic block bb. */
LLVMBuilderRef builder = LLVMCreateBuilder(); 
LLVMPositionBuilderAtEnd(builder, bb);
LLVMValueRef lhs = LLVMBuildAdd(builder, 
    LLVMConstInt(LLVMInt32Type(), 1, 0), 
    LLVMConstInt(LLVMInt32Type(), 2, 0), NULL);
LLVMValueRef rhs = LLVMBuildAdd(builder, 
    LLVMConstInt(LLVMInt32Type(), 3, 0), 
    LLVMConstInt(LLVMInt32Type(), 4, 0), NULL);
LLVMBuildSub(build, lhs, rhs, NULL); 
```

关于`LLVMGetFirstUse`: 给定 a `Value`，您可以遍历所有使用它的地方。`LLVMGetFirstUse`给你一个迭代器 ( `LLVMUseRef`) 指向你可以递增 ( `LLVMGetNextUse`) 和取消引用 ( `LLVMGetUser`) 的使用列表的头部。有关[`llvm/Use.h`](https://github.com/earl/llvm-mirror/blob/master/include/llvm/Use.h)更多信息，请参阅。

# javascript - 从地图上绘制的正方形获取 lon lat 或可视化地图上的圆圈

> ID：13109074
> 
> 赞同：1
> 
> 时间：2012-10-28T13:14:54.537
> 
> 标签：javascript, google-maps, google-maps-api-3, maps

有谁知道是否可以在（谷歌）地图上绘制一个正方形，并让这个正方形的左上角和右下角用它们各自的经度和纬度预先填充地图外的 4 个表单域

选择 ：

如果上述方法不可行，是否可以让用户单击地图并远离该坐标，创建一个半径增加的圆？

在这两个选项中，正方形或圆形都需要在屏幕上可视化（地图叠加？）。

为用户寻找一种简单而干净的解决方案，以便在地图上选择一个区域，以便可以根据经纬度数据探测数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T06:18:44.333

我有这个旧的演示，它可能会做你想做的事，但它是用 V2 API 制作的。您必须将其转换为 V3：

[http://maps.forum.nu/gm_drag_polygon.html](http://maps.forum.nu/gm_drag_polygon.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:58:32.070

Google Maps JavaScript API V3 允许地图对象通过实现 MVC 对象来存储状态并自动更新其表示。

其中两个可能会让您对您的项目感兴趣。

这些是 [**矩形覆盖**](https://developers.google.com/maps/documentation/javascript/reference#Rectangle)和 [**圆形覆盖**](https://developers.google.com/maps/documentation/javascript/reference#Rectangle)

这 2 个**SAMPLES** [**Rectangle**](http://code.google.com/p/gmaps-samples-v3/source/browse/trunk/rectangle-overlay/rectangle-overlay.html?r=72)和[**Circle**](http://code.google.com/p/gmaps-samples-v3/source/browse/trunk/circle-overlay/circle-overlay.html?r=67)使用这些叠加层，您可以将其用作项目的基础。

然后可以使用下面的坐标来搜索数据库。（使用 AJAX）

```
var latLngBounds = new google.maps.LatLngBounds(
      marker1.getPosition(),
      marker2.getPosition()
    ); 
```

SQL 查询应如下所示

```
SELECT * FROM table WHERE lat BETWEEN lat1 AND lat2  AND lng BETWEEN  lon1 AND lon2 
```

您还应该考虑将 [**PDO**](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)与准备好的语句一起使用。

# facebook-like - 无法在 Facebook 中获取 URL 的实际点赞数

> ID：13109077
> 
> 赞同：0
> 
> 时间：2012-10-28T13:15:27.933
> 
> 标签：facebook-like, facebook-fql

link_stat 表的 like_count 现在包括用户喜欢该 URL 的任何评论或转发的数量。

有谁知道我怎样才能获得 URL 本身的实际 Like？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:34:32.203

据我所知，只给你分享+喜欢一个 URL 的计数。所以，你不可能只得到喜欢的次数。

# python - 如何从 SQLAlchemy 的联接表继承中的父类创建子类？

> ID：13109085
> 
> 赞同：4
> 
> 时间：2012-10-28T13:16:57.790
> 
> 标签：python, sqlalchemy

我正在开发一个小型数据库，其中人员远多于用户，因此目前有以下模型。

```
class Person(db.Model):
  __tablename__ = 'people'
  id       = db.Column(db.Integer, primary_key = True)
  forename = db.Column(db.String(64))
  surname  = db.Column(db.String(64))

  memberships = db.relationship('Membership', backref='person')

  @property
  def name(self):
    return self.forename + ' ' + self.surname

  def __repr__(self):
    return '<Person %r %r>' % (self.forename, self.surname)

class User(Person):
  __tablename__ = 'users'
  id       = db.Column(db.Integer, db.ForeignKey('people.id'), primary_key = True)
  email    = db.Column(db.String(120), index = True, unique = True)
  role     = db.Column(db.SmallInteger, default = ROLE_USER)

  salt     = db.Column(db.BINARY(8))
  password = db.Column(db.BINARY(20))

  def __repr__(self):
    return '<User %r>' % (self.email) 
```

它工作得很好，如果我创建一个用户，那么一个人也会得到保存。问题是当数据库中已经存在一个人时创建一个用户。

我尝试了以下方法：

```
>>> p = models.Person.query.get(3)
>>> u = models.User(id=p.id, email="example@example.com")
>>> u.set_password('password')
>>> db.session.add(u)
>>> db.session.commit()
Traceback
...
sqlalchemy.exc.IntegrityError: (IntegrityError) PRIMARY KEY must be unique u'INSERT INTO people (id, forename, surname) VALUES (?, ?, ?)' (3, None, None) 
```

我究竟做错了什么？有没有办法从一个人创建一个用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:54:17.810

在[Michael Bayer 的建议下](https://groups.google.com/d/msg/sqlalchemy/tVSKxDVNxqM/DS84lZwLJkAJ)，我改变了多态性设计并改用了组合。代码如下...

```
class Person(db.Model):
  __tablename__ = 'people'
  id       = db.Column(db.Integer, primary_key = True)
  forename = db.Column(db.String(64))
  surname  = db.Column(db.String(64))

  memberships = db.relationship('Membership', backref='person')

  @property
  def name(self):
    return self.forename + ' ' + self.surname

  def __repr__(self):
    return '<Person %r %r>' % (self.forename, self.surname)

class User(db.Model):
  __tablename__ = 'users'
  id       = db.Column(db.Integer, db.ForeignKey('people.id'), primary_key = True)
  email    = db.Column(db.String(120), index = True, unique = True)
  role     = db.Column(db.SmallInteger, default = ROLE_USER)

  salt     = db.Column(db.BINARY(8))
  password = db.Column(db.BINARY(20))

  person   = db.relationship('Person') 
```

与问题中的一个类似的会话将读取...

```
>>> p = models.Person.query.get(3)
>>> u = models.User(person=p, email="example@example.com")
>>> u.set_password('password')
>>> db.session.add(u)
>>> db.session.commit()
>>> 
```

# jquery - JQuery DataTables：有设计问题

> ID：13109090
> 
> 赞同：1
> 
> 时间：2012-10-28T13:17:30.173
> 
> 标签：jquery, jquery-plugins, datatables

我花了几个星期来构建一个数据表，显示来自服务器的最新信息（大约每 10 秒）。我已经完成了，但我认为我遇到了一个主要问题 - 这是创建/使用数据表的底层设计可能是完全错误的（呜咽！）。由于我不知道如何在 stackoverflow 上放置打印屏幕，因此简要总结如下：

1.  JSP 页面每 10 秒向服务器发送一次请求。
2.  从服务器返回的响应具有最新信息。
3.  返回的响应是 XML 格式的。XML 具有表元素（表 id=snaptable）。基本上是一个 DHTML。
4.  JSP 页面将这个 XML（表 id=snaptable）插入到这个页面的一个 DIV 元素中。
5.  根据这个表 id=snaptable 创建一个数据表。
6.  每 10 秒重复一次 - 每次根据响应中的新信息重新创建新表 id=snaptable。

这很好用。

这是问题所在：
1\. 如果我转到第 2 页，10 秒后它会自动返回第 1 页
2\. 我认为这里发生的情况是因为每 10 秒出现的每个新信息都是数据表的一个新实例（记住 - 我每 10 秒重新创建一个数据表），因此它会自动返回到第 1 页。

我想要的是，如果我在第 2 页或第 3 页，我想保留在该页面上，而数据表每 10 秒刷新一次。我认为我有一个错误的设计，并且由于我付出的所有努力而感觉很糟糕。如何以最短的方式解决这个问题？

请指教。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:31:37.043

您的信息量不是很大（某些来源可能会有所帮助:)，但请尝试添加`bStateSave`到 DataTable 创建中，例如

```
var myTable = $('#myTable').dataTable( {
    "bStateSave": true
    ...
}); 
```

bStateSave 的文档[http://www.datatables.net/ref#bStateSave](http://www.datatables.net/ref#bStateSave)

# ios - 谷歌驱动API结合图像和文本

> ID：13109093
> 
> 赞同：1
> 
> 时间：2012-10-28T13:18:03.033
> 
> 标签：ios, google-drive-api

我正在尝试使用适用于 iOS 的 google drive api 示例上传文件和图像。

单独上传文本和图像很容易，但我不知道如何上传两者。如何将图像和文本结合起来？如果我这样做：

```
 NSData *fileContent = [self.textView.text dataUsingEncoding:NSUTF8StringEncoding];
  NSData *imageData = UIImagePNGRepresentation(self.someImage.image);
  NSMutableData *uploadData = [NSMutableData dataWithData:fileContent];
  [uploadData appendData:imageData];

  uploadParameters = [GTLUploadParameters uploadParametersWithData:uploadData MIMEType:@"multipart/related"]; 
```

它会同时上传两者，但我无法在我的驱动器上查看它。

我必须创建一个谷歌文档吗？如果是这样，谷歌文档的格式是什么？我在我的驱动器上创建了一个文档，并在其中添加了一些文本和图像以使其正常工作，因此谷歌文档绝对可以处理同一文件中的文本和图像。

我搜索了谷歌文档格式，但也没有出现任何内容（如果这是正确的方法）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:32:31.407

如果您尝试上传包含文本和图像的格式化文档，则该文档被视为单个文件，并且必须以这种方式上传。无法直接以原生 Google Docs 格式上传，但您可以使用其他支持的格式之一，如 DOCX、PDF 等并进行转换。

# java - 如何在 Java 中获取 x509 证书编码类型

> ID：13109094
> 
> 赞同：0
> 
> 时间：2012-10-28T13:18:08.383
> 
> 标签：java

我正在尝试使用 Java 读取远程主机的证书。我想获得编码类型。我输入：

```
 System.out.println("The encoding is: "+ x509Cert.getEncoded().toString()); 
```

我得到的输出是：

```
The encoding is: [B@597c3925 
```

问题是什么 ？

编辑：x509Cert 是 X509Certificate 类型的对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T16:07:45.780

`Certificate.getEncoded`返回`byte[]`，因为它为您提供了证书数据的二进制表示（在 X509 证书的情况下为 DER），而不是文本。如果您希望它采用 PEM 格式，那么这是使用 MIME 样式 base 64 编码的 DER 表单（您可以为此使用[Apache commons 编解码器](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html#encodeBase64Chunked%28byte%5B%5D%29)）并添加了熟悉的开始和结束行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:21:21.733

只是为了让您了解问题所在：从中获取的对象（在本例中为数组）`x509Cert.getEncoded()`不会覆盖该`toString`方法，因此它默认为-class`getClass().getName() + '@' + Integer.toHexString(hashCode())`中定义的。`Object`

就像一个注释，当你这样做时

```
"some string" + someObj.toString() 
```

您实际上不需要调用`toString`- 它会自行调用。你可以做

```
"some string" + someObj 
```

# php - Codeigniter 回调函数不起作用

> ID：13109096
> 
> 赞同：3
> 
> 时间：2012-10-28T13:18:29.897
> 
> 标签：php, codeigniter, validation

我从昨天开始就面临这个问题，无法解决。我的回调函数不起作用。它总是返回 TRUE，但我不知道为什么？谁能帮我？

这是模型：

```
class Login_model extends CI_Model {
public function check_login($str)
    {
        $this->form_validation->set_message('check_login', 'Error');
        return FALSE;

    }
function validate_login()
{
    $this->form_validation->set_rules('email', 'Email Address', 'trim|required|valid_email|xss_clean');
    $this->form_validation->set_rules('password', 'Password', 'callback_check_login');

    if($this->form_validation->run() == FALSE)
    {
        return FALSE;
    }

    return TRUE;
}} 
```

回调函数永远不应返回 TRUE。但它正在回归！我会因为这个问题而死！:@

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T05:04:36.150

它会返回`TRUE`，因为

1.  你没有通过`email`并且`password`'validate_login（）'。
2.  所以`$this->form_validation->run()`行不通。

移动`validate_login()`到任何控制器

# c++ - APPCRASH 大约之后。40 秒

> ID：13109097
> 
> 赞同：0
> 
> 时间：2012-10-28T13:18:43.890
> 
> 标签：c++, windows-7, crash-reports

我有一个多线程服务器应用程序，它在第一个 ca 中运行良好。40 秒（此时应用程序几乎只等待传入的数据包）。在这 40 秒之后，它突然崩溃了，尽管没有任何改变，没有连接客户端，没有发送数据等。

我从 Windows 收到的崩溃报告是这样的：

```
Problem signature:
  Problem Event Name:   APPCRASH
  Application Name: myapplicationname.exe
  Application Version:  0.0.0.0
  Application Timestamp:    508d2a0b
  Fault Module Name:    StackHash_58df
  Fault Module Version: 6.1.7600.16385
  Fault Module Timestamp:   4a5bdb3b
  Exception Code:   c0000374
  Exception Offset: 000cdcbb
  OS Version:   6.1.7600.2.0.0.256.48
  Locale ID:    1031
  Additional Information 1: 58df
  Additional Information 2: 58df710f17985997dec7b600103e4fd6
  Additional Information 3: bc2b
  Additional Information 4: bc2b581ed6e84cb4442c19134e8081d3 
```

我检查了可能的缓冲区溢出、内存泄漏，但事实并非如此（至少我没有注意到）。

除此之外，更让我感到困惑的是，如果我在 Visual Studio（本地 Windows 调试器）中编译并运行它，则不会发生此错误，不会崩溃，一切都按预期工作。我不知道从哪里开始解决这个问题，因为我从来没有遇到过这样的问题。

我知道如果没有代码就很难诊断某些东西，但是代码太多了，我无法限制它，因为我不知道这个错误甚至意味着什么以及它与什么有关。我只是希望有人遇到过类似的事情或知道此错误的含义。到目前为止，我只找到了如何解决其他程序的类似问题（重新安装应用程序就是答案）。

**疯狂的猜测：** 我有一个轮询循环，这给我的一个线程带来了很大的压力，因为我没有达到实现整个​​代码的目的。是否有可能调用 DEP 并停止我的应用程序以保护我的 CPU 之一？- 添加了睡眠但没有改变任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:24:05.367

> 异常代码：c0000374

您会在 ntstatus.h SDK 头文件中找到这些异常代码：

```
//
// MessageId: STATUS_HEAP_CORRUPTION
//
// MessageText:
//
// A heap has been corrupted.
//
#define STATUS_HEAP_CORRUPTION           ((NTSTATUS)0xC0000374L) 
```

堆损坏当然是一种非常常见的 C++ 编程危险。如果找不到错误，请使用 crtdbg.h 中提供的调试分配器。

# ruby-on-rails-3 - rails ActiveRecord 包括带有 where 的方法：在后续调用中未应用 where 以获取关联

> ID：13109099
> 
> 赞同：1
> 
> 时间：2012-10-28T13:18:54.393
> 
> 标签：ruby-on-rails-3

假设我有 2 个表*as*和*bs*与连接表存在多对多关系。连接表有一个属性*cond*。

记录如下：

作为：

```
id
1 
```

绝对：

```
id  a_id  b_id  cond
1   1     1     1
2   1     1     0 
```

乙：

```
id
1 
```

现在我这样做：

> b = A.find(1).bs.where(:abs => {:cond => 1}).includes(:abs).first

这给了我我的*b*实例，问题是，为什么*b.abs*返回**所有** *abs*行？

我认为*include*方法是为了避免在后续调用关联方法时重新加载关联。由于我在第一次调用中使用了*where*我希望*b.abs*只返回带有*cond == 1*的行。

我在 rails 控制台中尝试了这个，当我执行*b.abs*调用时没有发出 SQL 请求。这里发生了什么？有没有办法做我想做的事情，或者我需要再次将条件放在*b.abs*上，例如 *b.abs.where(:abs => {:cond => 1}) ？

根据评论中的要求，以下是模型的代码：

猫应用程序/模型/a.rb

```
class A < ActiveRecord::Base
    has_many :bs, :through => :abs
    has_many :abs   
end 
```

猫应用程序/模型/b.rb

```
class B < ActiveRecord::Base
    has_many :as, :through => :abs
    has_many :abs 
end 
```

猫应用程序/模型/ab.rb

```
class Ab < ActiveRecord::Base
    attr_accessible :cond, :a_id, :b_id
    belongs_to :a
    belongs_to :b
end 
```

# iphone - 用数组给出标签名称

> ID：13109101
> 
> 赞同：0
> 
> 时间：2012-10-28T13:19:19.490
> 
> 标签：iphone, objective-c, xcode, arrays, labels

好的，所以我尝试使用数组和 for 循环给出 7 个不同的标签名称。

代码：

```
id huller[] = {hul18.text, hul17.text, hul16.text, hul15.text, hul14.text, hul13.text, hul12.text, hul11.text, hul10.text, hul9.text, hul8.text, hul7.text, hul6.text, hul5.text, hul4.text, hul3.text, hul2.text, hul1.text};

for (int i = 0;  7 > i; i++) {
    huller[i] = [NSString stringWithFormat:@"%i", x + 1];
    NSLog(@"%@", huller[i]);
} 
```

NSLog 中的名称发生了变化，但在模拟器中没有变化。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:27:09.010

如果您希望文本也更改，则必须手动设置文本。

```
NSArray *labels = //Array of labels;
for (int i = 0;  7 > i; i++) {
    huller[i] = [NSString stringWithFormat:@"%i", x + 1];
    labels[i].text = huller[i];
    NSLog(@"%@", huller[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:54:09.827

假设 hul18、hul17 等都是 UILabel 对象，那么这样做：

```
NSArray *labels = [ hul18, hul17, hul16, hul15, hul14, hul13, hul12, hul11, hul10, hul9, hul8, hul7, hul6, hul5, hul4, hul3, hul2, hul1 ];

// Change the text of every label in the array
for (int i = 0;  i < labels.count; i++) {
    UILabel *label = labels[i];
    label.text = [NSString stringWithFormat:@"%i", x + 1]; // Do you really want 'x' here or 'i'?
    NSLog(@"%@", label.text);
} 
```

# xcelsius - 如何从 flex 代码获取/访问放置在 xcelsius 2008 画布中的组件数量

> ID：13109102
> 
> 赞同：1
> 
> 时间：2012-10-28T13:19:25.437
> 
> 标签：xcelsius, flex2

如何从 flex 代码获取/访问放置在 xcelsius 2008 画布中的组件数量？Xcelsius sdk 的哪个功能可以提供帮助？

# python - 比 ArgParse 更灵活的命令行参数解析器？

> ID：13109103
> 
> 赞同：0
> 
> 时间：2012-10-28T13:19:30.283
> 
> 标签：python, argparse

我想解析一个参数，如：

```
command --ethX 
```

其中 X 是从 0 开始的数字。可以直接使用 ArgParse 吗？似乎不是，有没有办法让 ArgParse 让程序员处理这个参数，但`ethX`在打印帮助时保持参数不变？

如果没有，python中是否有任何解析器替代方案可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:21:59.587

使用[`parse_known_args()`](http://docs.python.org/2/library/argparse.html#partial-parsing)而不是`parse()`. 不要注册任何`eth`参数并为此类参数自行解析剩余的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T09:50:31.990

无法做到这一点，`ArgParse`因为它无法分离真实参数和相关描述，我已切换到`getopt`.

# mysql - MySQL 数据库 - 将数据存储在一个表中或使用查找

> ID：13109104
> 
> 赞同：1
> 
> 时间：2012-10-28T13:19:36.327
> 
> 标签：mysql, database, query-optimization

我正在重新设计一个在特定表中有 100,000 条记录的应用程序（目前为 250,000 并且还在增长）。

该表包含网站和域的信息。

为了速度和资源，我应该在原始表中包含有关任一实体所需的所有数据，还是应该使用两个查找表来存储未共享的信息 - 例如一个存储所有域特定信息的查找表和一个哪个存储所有站点特定信息？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:27:27.853

理想情况下，您应该将它们拆分为 2 个不同的表，因为单个域将对应于多个站点，如果我们采用将域和站点的元数据存储在单个表中的设计，在这种情况下需要在站点元数据的每条记录中为域存储的冗余信息。相反，如果我们有 2 个单独的表，其中域表每个域有一条记录，并且站点列表作为记录中的字段之一，并且站点表中的域名列来确定给定站点的域，它将确保有组织的存储和没有数据冗余。这是传统 RDBMS 系统的主要原则，这就是为什么我们有多个表的概念。

此外，如果您想真正扩展您的数据库，您可以考虑使用 NOSQL 数据存储，正如您所说的数据在不断增加。[Apache HBase](http://hbase.apache.org/)可能是一个很好的解决方案，它具有将相关信息分组在一起的概念。

**编辑：**

*澄清问题：*

```
Just to be clear, domain and sites are not linked. They're just different entities like a domain with no traffic or revenue would be classed as a domain and have domain related data stored for it like number of hyphens or registrar while a domain with a Wordpress install for example and exisitng traffic would be classed as a site - not a domain - and have site specific information stored. Would this change your answer? 
```

在它们不相互关联的情况下，我认为将数据拆分为多个表不会有任何帮助，除非您要使用分布式 RDBMS 系统。在单节点托管数据库的情况下，行无论如何都由站点/域 id 索引，并且单个表中的大量行不会降低性能，但是如果您正在查看庞大的数据大小并希望将其划分到集群中的多个节点上，然后为它们提供独立的表将有助于使每个表都托管在各个节点上，并且数据库能够水平扩展。这是我在这种情况下看到的唯一好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:27:08.663

应用程序的性能很大程度上取决于应用程序使用的查询类型。将所有数据存储在一个表中不一定会降低性能，但很可能会提高性能。如果您的表保存了 XY 先生拥有 example.com 数千次的信息，那么您当然会浪费磁盘空间。

规范化您的数据库（拆分您的数据）可能会有所帮助，但您必须知道您想对数据做什么才能回答这个问题。

# javascript - 自定义寻呼机按钮的 id 属性 - 按钮正在消失

> ID：13109107
> 
> 赞同：0
> 
> 时间：2012-10-28T13:19:48.600
> 
> 标签：javascript, jquery, jqgrid

根据[jqGrid wiki](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acustom_buttons#definition)，`id`自定义寻呼机按钮的属性是：

> id : string (可选) - 如果 set 定义了按钮的 id (实际上是 TD 元素的 id) 以供将来操作

问题是当使用/设置（`id:'myCustomButton'`）这个属性时，按钮消失了。

我怎样才能正确使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:34:18.230

我想你犯了一些打字错误。尝试使用此代码

```
$grid.jqGrid("navButtonAdd", "#pager", {
    caption: "My Button",
    id: "myCustomButton",
    onClickButton: function () {
        alert("Click!");
    }
}); 
```

并查看[演示](http://www.ok-soft-gmbh.com/jqGrid/CustomNavButtonWithId.htm)。

# java - 如何编写可以接受 groovy 闭包的 java 类方法

> ID：13109117
> 
> 赞同：3
> 
> 时间：2012-10-28T13:21:52.980
> 
> 标签：java, groovy

这是我想要做的：

我有一个名为的类`RowCollection`，它包含一个`Row`对象集合，带有一个名为 的方法`edit`，它应该接受另一个对对象进行操作的方法（或闭包）作为参数`Row`。

groovy 脚本将通过以下方式使用此类的对象：

```
rc.edit({ it.setTitle('hello world') }); // it is a "Row" object 
```

我的问题：

1.  的签名`RowCollection#edit`会是什么样子？
2.  它的实现是什么样的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T08:59:34.940

作为替代方案，如果您`RowCollection`实现`Iterable<Row>`并提供合适的`iterator()`方法，那么适用于所有类的标准 Groovy-JDK 魔法将启用

```
rc.each { it.title = "hello world" } 
```

并且您以相同的方式免费获得所有其他支持的`iterator`GDK 方法，包括`collect`、`findAll`、`inject`、和.`any``every``grep`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T13:41:07.993

好的 - 稍微挖掘一下，这里是：

```
class RowCollection {
    private List<Row> rows;

    // ...

    public void edit(Closure c) {
        for(Row r : rows) {
            c.call(r);
        }
    }

    // ...
} 
```

类 Closure 在`groovy.lang`包中。

# java - 使用对象数组获取数据

> ID：13109120
> 
> 赞同：0
> 
> 时间：2012-10-28T13:22:06.947
> 
> 标签：java, jsp, servlets

> **可能重复：**
> [Java 将所有表数据添加到列表中](https://stackoverflow.com/questions/13108960/java-add-all-table-data-into-list)

```
+--------+-------+-----+
|  Name  |number |qty  |
+--------+-------+-----+
|   ab   |   5   |  7  |
+--------+-------+-----+ 
|   cd   |   1   |  6  |
+--------+-------+-----+ 
|   ef   |   0   |  9  |
+--------+-------+-----+ 
|   gh   |   8   |  2  |
+--------+-------+-----+ 
```

我将 Product 中的所有数据添加到数组列表中，如下所示

```
public List<Product> search(){
    List<Product> products = new ArrayList<Product>();
    ResultSet rs = DAO.fetch("SELECT * FROM Products");
    while (rs.next()) {
        product = new Product();
        product.setNumber(rs.getString("ProductNumber"));
        product.setName(rs.getString("ProductName"));
        product.setQty(rs.getString("ProductQty"));
        products.add(product);
    }
    return products;
} 
```

我如何使用这个打印我的jsp中的所有名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:29:33.640

您可以通过在控制器中说出以下语句来传递列表

```
List <Product> products = dao.search();
request.setAttribute("Products", products); 
```

而且，在您的 JSP 中，您可以使用以下代码（我认为您知道如何在您的 JSP 页面上使用包含 JSTL 库）。

要使用 JSTL Core 库，您需要在 JSP 中添加以下行

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
```

然后可以显示遍历传递的列表来显示所有的产品。

```
<table>
   <tr>
     <th>Name</th>
     <th>Number</th>
     <th>Quantity</th>
   </tr>
 <c:forEach items="${Products}" var="product">
    <tr>
      <td><c:out value="${product.name}" /></td>
      <td><c:out value="${product.number}" /></td>
      <td><c:out value="${product.qty}" /></td>
    </tr>
  </c:forEach>
</table> 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:34:19.287

添加`products`到[适当的范围](http://docs.oracle.com/javaee/6/tutorial/doc/gjbbk.html)并转发到您的 jsp 页面：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
...
<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>Number</th>
            <th>Quantity</th>
        </tr>
    </thead>
    <tbody>
        <c:forEach items="${products}" var="product">
            <tr>
                <td>${product.name}</td>
                <td>${product.number}</td>
                <td>${product.qty}</td>
            </tr>
        </c:forEach>
    </tbody>
</table> 
```

顺便说一句，在这种情况下使用[thead 和 tbody](http://www.w3.org/TR/html401/struct/tables.html#h-11.2.3)是有益的，因为：

> 这种划分使用户代理能够支持独立于表头和表脚的表体滚动。打印长表时，表头和表尾信息可能会在包含表数据的每一页上重复。

# javascript - javascript screen.width 和 screen.height 未按预期呈现

> ID：13109127
> 
> 赞同：1
> 
> 时间：2012-10-28T13:22:54.247
> 
> 标签：javascript, html, google-chrome, html5-canvas, render

试图让一个元素呈现屏幕的全尺寸：

```
<!DOCTYPE html>
<html>
<head>
    <title>Test Page</title>
</head>
<body>
    <canvas></canvas>
    <script>
        (function(){
            var canvas = document.getElementsByTagName("canvas")[0];
            canvas.style.background = "#0f0";
            canvas.style.width = screen.width + "px";
            canvas.style.height = screen.height + "px";

            console.log(
                "screen.width: " + screen.width +
                "\nscreen.height: " + screen.height +
                "\ncanvas.width: " + canvas.style.width +
                "\ncanvas.height: " + canvas.style.height
            );
        })()
    </script>
</body>
</html> 
```

但是画布元素在 chrome v22 中以大约两倍的宽度和两倍的高度呈现，但在 FF 中似乎很好。我得到控制台输出：

screen.width：1366 screen.height：768 canvas.width：1366px canvas.height：768px

如果我在 chrome 中手动设置画布的宽度和高度，我必须使用：

```
canvas.style.width = 780 + "px";
canvas.style.height = 435 + "px"; 
```

使其达到 chrome 中的屏幕大小，然后检查 FF，这按预期呈现在两个维度上都略高于屏幕的一半。

更新：

我试过这个：

```
<!DOCTYPE html>
<html>
<head>
    <title>Test Page</title>
</head>
<body style="padding:0;margin:0;">
    <div>
        <canvas>
        </canvas>
    </div>
    <script>
        (function(){
            var div = document.getElementsByTagName("div")[0],
                canvas = document.getElementsByTagName("canvas")[0];

            div.style.background = "#f00";
            div.style.width = screen.width + "px";
            div.style.height = screen.height + "px";

            canvas.style.background = "#0f0";
            canvas.style.width = "100%";
            canvas.style.height = "100%";

            console.log(
                "screen.width: " + screen.width +
                "\nscreen.height: " + screen.height +
                "\ncanvas.width: " + canvas.style.width +
                "\ncanvas.height: " + canvas.style.height
            );
        })()
    </script>
</body>
</html> 
```

但它具有相同的效果，适用于 FF 但不适用于 chrome。

我之前在我的测试站点 www.0xor1.com 上做过这个，但我使用 jQuery`css({width:screen.width, height:screen.height})`来设置它，这就是它工作的原因，但我不明白为什么这种方式在 chrome 中不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:28:42.970

画布元素的宽度和高度应标记为：

```
<canvas id="myCanvas" width="200" height="200"> 
```

Css 样式搞砸了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:28:50.163

尝试设置

```
canvas.width = screen.width + "px";
canvas.height = screen.height + "px"; 
```

没有`.style.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:28:54.610

也许你的窗口比你的屏幕小得多。你不能覆盖比窗户更多的东西，所以也许屏幕不是你想要的。

如果把它改成这样，它就会覆盖整个身体

```
 var canvas = document.getElementsByTagName("canvas")[0];
        var body = document.getElementsByTagName("body")[0];
        canvas.style.background = "#0f0";
        canvas.style.width = body.offsetWidth + "px";
        canvas.style.height = body.offsetHeight + "px"; 
```

# python - PyQt QAbstractTableModel 在添加行时从不更新

> ID：13109128
> 
> 赞同：3
> 
> 时间：2012-10-28T13:22:58.470
> 
> 标签：python, qt, pyqt

我有一个 PyQt `QTableView`，连接到 a `QAbstractTableModel`，它本身连接到一个管理项目列表的自定义类。我可以在列表的末尾插入一个项目，它会适当地通知我的模型，然后调用`beginInsertRows`and `endInsertRows`。我可以验证它是否调用了这两个函数，并且列表已自行更新，但表从未调用`data`来检索更新的行。

这是怎么回事？我该如何解决？

```
class FigureTableModel(QAbstractTableModel):
    def __init__(self):
        QAbstractTableModel.__init__(self)

        def changed(index):
            start_index = self.createIndex(index, 0)
            end_index = self.createIndex(index, COLUMNS - 1)
            self.dataChanged.emit(start_index, end_index)

        def adding_row(index):
            self.beginInsertRows(self.createIndex(0, 0), index, index)
            print 'adding ', index

        def added_row(index):
            self.endInsertRows()
            print 'added'

        figures.dataChanged.connect(changed)
        figures.rowAdding.connect(adding_row)
        figures.rowAdded.connect(added_row)

    def rowCount(self, parent):
        return len(figures)

    def columnCount(self, parent):
        return COLUMNS

    def data(self, index, role):
        print 'in data'
        if not index.isValid():
            return EMPTY

        return figures[index.row()].get_table_item(index.column(), role) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T02:08:15.687

有一个问题，我认为这是您的问题的原因。这是关于线：

```
self.beginInsertRows(self.createIndex(0, 0), index, index) 
```

`self.createIndex(0, 0)`将创建一个有效的`QModelIndex`. 那是指`parent`in [`beginInsertRows`](http://qt-project.org/doc/qt-4.8/qabstractitemmodel.html#beginInsertRows)，因此您基本上是在告诉视图您将在表的第一行中添加一个子项。由于该表没有子项的概念（它不是分层的），因此它什么也不做。

对于一个表，`parent`应该是一个 invalid `QModelIndex`，这意味着你的项目是在根。所以，你应该使用：

```
self.beginInsertRows(QtCore.QModelIndex(), index, index)
# or depending on how you import
self.beginInsertRows(QModelIndex(), index, index) 
```

话虽如此，有几件事让我感到奇怪。

首先，在`index`方法之外，您通常应该避免直接调用`createIndex`。否则很容易把事情搞砸。`index`方法本身应该提供创建`QModelIndex`实例的一致方式。在您的情况下，由于您 inherit `QAbstractTableModel`，`index`方法已经实现。

其次，您正在使用全局变量。很多。这通常被认为是不好的做法。如果您的班级需要它们，请将它们传递给`__init__`. 例如，现在你不能实例化两个独立的模型。因为它们都将使用相同的全局`figure`变量。或者，我不知道`EMPTY`指的是什么，但`data`应该简单地返回`None`无效类型。不需要另一个名字。同样，您应该能够从中获取`COLUMNS`，`figures`或者如果您需要显式值，则应该将其传递给`__init__`.

# c++ - 从可变参数模板实例化调用函数时调用了意外的重载

> ID：13109130
> 
> 赞同：10
> 
> 时间：2012-10-28T13:23:10.787
> 
> 标签：c++, templates, forwarding, variadic-templates

假设以下代码：

```
#include <iostream>

template<typename... T>
void foo(const T &...);

template<unsigned N>
void foo(const char (&)[N])
{
   std::cout << "char(&)[N]" << std::endl;
}

void foo(const char *)
{
   std::cout << "const char *" << std::endl;
}

template<typename T>
void foo(const T &)
{
   std::cout << "Single" << std::endl;
}

template<typename First, typename... T>
void foo(const First & first, const T &... rest)
{
   std::cout << "Generic + " << sizeof...(T) << std::endl;
   foo(first);
   foo(rest...);
}

int main()
{
    const char * c = "asdf";
    char a[] = {'a', 'b', 'c', 'd'};
    foo('f', c, a, 1);
    foo(a);
} 
```

[输出是：](http://liveworkspace.org/code/5ab034f931efe38272542fec738d6be6)

```
Generic + 3
Single              // fine; 'f' is `char` -> generic
Generic + 2
const char *        // fine; c is `const char *`
Generic + 1
const char *        // (!) not fine
Single
char(&)[N]          // fine; a is char[4] 
```

最后一次调用 - `foo(a)`，在哪里`a`-`char[4]`调用我期待的版本 - `template<unsigned N> void foo(const char (&)[N])`。但是为什么不实例化`foo`call的可变参数模板`foo(const char (&)[N]`，而是调用`foo(const char *)`呢？如果没有 char 数组重载，那应该是可以预料的——但为什么会发生在这里？不应该`const First &`正确捕获数组类型吗？

此外，使通用可变参数版本与传递给它的数组一起正常工作的最简单方法是什么？

* * *

正如*Matthieu M.*在评论中注意到的那样，问题可能不是由可变参数模板引起的，而是由[间接](http://liveworkspace.org/code/72b3963b4f0c2d00592b4ce00f08fc82)引起的：

```
#include <iostream>

template <unsigned N>
void foo(const char (&)[N])
{
   std::cout << "char(&)[N]" << std::endl;
}

void foo(const char *)
{
   std::cout << "const char *" << std::endl;
}

template <typename T>
void goo(T const& t) {
    foo(t);
}

int main()
{
    char a[] = {'a', 'b', 'c', 'd'};
    foo(a);
    goo(a);
} 
```

```
    字符(&)[N]
    常量字符 *

```

他还说这可能是编译器错误——尽管代码在 Clang 3.2 dev、G++ 4.6 和 4.7 中产生完全相同的结果。

*R. Martinho Fernandes*指出，`a`在最后一个片段中更改 's 类型以`const char a[]`使代码产生`const char *`两次。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:02:23.543

我想我可以回答第二部分：如何解决？我不确定我是否得到了正确的答案，因为在我看来，传递字符串文字的情况仍然会产生错误的结果。修复的基本思想是使用完美转发，而不是希望推断出正确的类型`T const&`。为什么使用`T const&`数组会导致数组衰减，不过我还不太明白。

当然，使用完美前向意味着执行此操作的函数是完美匹配的，并且某些专业化实际上会进行一些转换，至少添加`const`. 因此，有必要使用不同的名称。总的来说，这看起来像这样：

```
#include <iostream>
#include <utility>

void foo()
{
}

template<unsigned N>
void special(const char (&)[N])
{
    std::cout << "char(&)[" << N << "]" << '\n';
}

void special(const char *)
{
   std::cout << "const char *" << '\n';
}

template<typename T>
void special(const T &)
{
   std::cout << "Single" << '\n';
}

template<typename First, typename... T>
void foo(First&& first, T&&... rest)
{
   std::cout << "Generic + " << sizeof...(T) << '\n';
   special(std::forward<First>(first));
   foo(std::forward<T>(rest)...);
}

int main()
{
    char const* c("foo");
    char a[] = {'a', 'b', 'c', 'd'};
    foo('f', "afas", a, c, 1);
    foo(a);
} 
```

# animation - 如何在 JQuery 中为 CSS3 变换设置动画

> ID：13109136
> 
> 赞同：0
> 
> 时间：2012-10-28T13:23:52.950
> 
> 标签：animation

我想在 JQuery 中使用 CSS3 Transform 旋转制作一个简单的动画，但它似乎不起作用。下面是我的代码：

```
<script>
function sun() {
    $('#sun').animate({opacity:0.5, '-webkit-transform':'rotate(360deg)'},5000).animate({opacity:1, '-webkit-transform':'rotate(-360deg)'},5000);
    setTimeout('sun()',2000);   
}
    $(document).ready (function() {
        sun();
    });
</script> 
```

帮助

# java - 需要从过滤@WebFilter 中排除 js/css/jpg 等文件

> ID：13109139
> 
> 赞同：0
> 
> 时间：2012-10-28T13:24:02.917
> 
> 标签：java, jakarta-ee, servlets, servlet-filters

我正在过滤每个网址，即使用`@WebFilter("/*")`. 用户需要登录才能查看任何页面，如果他不是，他会被重定向到`/login.do`页面。

现在，当用户进入`login.do`页面时出现问题，因为用户没有登录其他请求，即获取 .js、.css、.jpg、.png 等的请求也被重定向到`login.do`页面。

我尝试了以下代码：

```
if(requestedUri.matches(".*[css|jpg|png|gif|js].*")){
    chain.doFilter(request, response);
    return;
} 
```

但在这种情况下，所有页面都可以在没有登录的情况下访问。所以，基本上我需要一种方法来从过滤中排除 css、jpg、js 文件的 url。有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:11:15.747

对不起！那是我的愚蠢错误。正则表达式不正确！

那应该是`.*(css|jpg|png|gif|js)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-05T09:01:07.617

如果网址喜欢`a/b.jsp`或`a/b.giffs`那里将匹配`.*(css|jpg|png|gif|js)`

所以正则表达式应该是`.*(\bcss\b|\bjpg\b|\bpng\b|\bgif\b|\bjs\b)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-13T21:00:09.777

如果你想获得请求的扩展，你应该使用：

```
.*(css|jpg|png|gif|js)$ 
```

**匹配**：

```
hello.htm.jpg
hello.js
hello.ico 
```

**不匹配**：

```
hello
hello.
hello.csv
hello.htm
hello.html
hello.shtml
hello.csv
hello.jpg.csv.htm 
```

# java - 来自 URL 的文件名不包含文件名后缀

> ID：13109147
> 
> 赞同：1
> 
> 时间：2012-10-28T13:25:37.717
> 
> 标签：java, android, http, url, filenames

我需要从 URL 下载文件，但我不知道文件是什么类型，而且我使用的 URL 末尾没有 /random.file，所以我无法解析文件名。目前，我正在使用运行良好的 Android 下载管理器，这意味着我没有处理下载，但无论如何我都无法从下载的文件中获取文件名。例如，如果我在 Firefox 中加载相同的 url，它会询问“下载文件：Nameofile.extension”。

有没有办法让我在下载文件之前复制这种行为并获取文件名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:52:47.247

您最好阅读`Content-Type`响应中的 HTTP 标头并弄清楚它是什么类型的文件。文件扩展名不保证文件的类型。`Content-Disposition: attachment; filename="fname.ext"`如果您具体了解文件名，这是另一种方法。查看[HTTP 标头列表以](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields)获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:48:25.727

我最终使用 ASyncTask 手动检索文件名并将其传递给下载管理器，如果它对任何人有帮助，我就是这样做的（我的 url 在实际文件下载之前经历了许多重定向）：

```
class GetFileInfo extends AsyncTask<String, Integer, String>
{
    protected String doInBackground(String... urls)
    {
                URL url;
                String filename = null;
                try {
                    url = new URL(urls[0]);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.connect();
                conn.setInstanceFollowRedirects(false); 

                try {
                    for(int i = 0; i < 10; i++)
                    {
                        url = new URL(conn.getHeaderField("Location")); 
                        conn = (HttpURLConnection) url.openConnection();
                        conn.connect();
                        conn.setInstanceFollowRedirects(false);
                    }
                } catch (Exception e) {
                }

                String depo = conn.getHeaderField("Content-Disposition");
                String depoSplit[] = depo.split(";");
                int size = depoSplit.length;
                for(int i = 0; i < size; i++)
                {
                    if(depoSplit[i].startsWith("filename="))
                    {
                        filename = depoSplit[i].replace("filename=", "").replace("\"", "").trim();
                        Global.error(filename);
                        i = size;
                    }
                }
                } catch (MalformedURLException e1) {
                    e1.printStackTrace();
                } catch (IOException e) {
                }
            return filename;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
    }

    @Override
    protected void onProgressUpdate(Integer... progress) {
        super.onProgressUpdate(progress);
    }
} 
```

# ruby - 生成 PDF - 存储生成代码的方法

> ID：13109149
> 
> 赞同：1
> 
> 时间：2012-10-28T13:26:15.437
> 
> 标签：ruby, pdf, eval

我目前正在编写一个生成一些 PDF 的 rails 应用程序。生成的文件包括提案、发票、订单确认等。

我的意图是提供 2 个默认布局并允许用户请求自定义布局。用户甚至永远不会看到生成器代码，这一切都由受信任的人处理 -> 根本不关心安全性。

我的要求：

*   易于更改/添加新生成器（对于开发人员，用户永远不会看到这些生成器）
*   无需重新部署
*   适用于任意数量的生成器

在我看来，将这些生成器作为源代码中的 .rb 文件中的常规类实现是平淡无奇的（需要重新部署，文件杂乱无章）。

我目前正在考虑以下内容，并希望对可行性/更好的方法进行一些输入：

生成器代码存储在数据库中，每当要打印文档时，都会在已设置所有相关变量的范围内评估代码（文档（-> 行项目 | 客户 ..）、pdf、用户等。 ) 并且生成器代码只使用它们。

我的问题基本上是：这是这样做的方式吗？如果是这样，我应该注意一些事情吗？

# mysql - 如何遍历特定的列名并清除 PHP/MySQL 中的这些字段？

> ID：13109150
> 
> 赞同：0
> 
> 时间：2012-10-28T13:26:16.397
> 
> 标签：mysql, foreach, pdo, fatal-error

我正在尝试执行 PHP/MySQL 查询以选择一组列并清除特定记录的字段：

```
$sth = $dbh->query("SELECT column_name
                    FROM information_schema.columns
                    WHERE table_name = 'users'
                    AND column_name like '%_abc'");

$rows = $sth->fetchAll();

foreach ($rows as $row){

    $sth = $dbh->prepare("UPDATE users
                          SET $row = NULL
                          WHERE user_id = $user_id");

    $sth->execute();        

} 
```

但是，我收到以下错误：

```
Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[42S22]: 
Column not found: 1054 Unknown column 'Array' in 'field list' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:40:07.433

反而 `"UPDATE users SET $row = NULL WHERE user_id = $user_id"`

尝试`"UPDATE users SET {$row['column_name']} = NULL WHERE user_id = $user_id"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:31:36.700

你`$row`的是一个数组。尝试

```
foreach ($rows as $id => $value {
   ... SET $value = NULL ...
} 
```

你可以看看`$row`使用：

```
var_dump($row); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:29:18.307

`$row`是一个数组。要访问选定行中的特定字段，请使用`$row['column_name']`

# android - XYMultipleSeriesRenderer 中的 achartengine 清除渲染器

> ID：13109151
> 
> 赞同：2
> 
> 时间：2012-10-28T13:26:18.557
> 
> 标签：android, dataset, time-series, achartengine, renderer

我的目标是创建一个图表，该图表将根据用户操作隐藏和显示一系列。我想通过首先清除图形和数据集以及渲染器然后重新插入新值来做到这一点。很像`.clear()`Arraylists 的方法，我想知道是否为 XYMultipleSeriesRenderer 构建了某种类型的类似功能。我注意到 XYMultipleSeriesDataset 缺乏类似的功能，但我能够通过这样做来解决这个问题（我想，我还不能确定）

```
 for(int i = 0; i < dataset.getSeriesCount(); i++) {
            dataset.removeSeries(i);
        } 
```

幸运的是 XYMultipleSeriesRenderer 似乎有一个 getrenderercount 类型的方法，但没有一个需要`ints`. 我所看到的只是一个不需要的删除功能`ints`，只是实际的系列渲染器名称。

如果有帮助，这里有更多代码：

```
private void excecuteGraph() {
    //      add series to the complete dataset
    XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();
    XYMultipleSeriesRenderer mrenderer = new XYMultipleSeriesRenderer();

    switch (graphCase ){
    case -1:
        dataset.addSeries(series0);
        dataset.addSeries(series1);
        dataset.addSeries(series2);
        dataset.addSeries(series3);     

        //          create the individual renderers, customize settings for each
        XYSeriesRenderer renderer1 = new XYSeriesRenderer();
        renderer1.setColor(Color.BLUE);
        renderer1.setLineWidth(3);
        XYSeriesRenderer renderer2 = new XYSeriesRenderer();
        renderer2.setColor(Color.DKGRAY);
        renderer2.setLineWidth(3);
        XYSeriesRenderer renderer3 = new XYSeriesRenderer();
        renderer3.setColor(Color.RED);      
        renderer3.setLineWidth(3);
        XYSeriesRenderer renderer4 = new XYSeriesRenderer();
        renderer4.setColor(Color.WHITE);        
        renderer4.setLineWidth(3);

        //          add renderers to the complete multirenderer, customize settings for it
        mrenderer.addSeriesRenderer(renderer1);
        mrenderer.addSeriesRenderer(renderer2);
        mrenderer.addSeriesRenderer(renderer3);
        mrenderer.addSeriesRenderer(renderer4);
        break;
    case 0:
        for(int i = 0; i < dataset.getSeriesCount(); i++) {
            dataset.removeSeries(i);
        }

        dataset.addSeries(series0);
        XYSeriesRenderer renderer00 = new XYSeriesRenderer();
        renderer00.setColor(Color.BLUE);
        renderer00.setLineWidth(3);
        mrenderer.addSeriesRenderer(renderer00);
        break;
    case 1:
        for(int i = 0; i < dataset.getSeriesCount(); i++) {
            dataset.removeSeries(i);
            Log.d("testingGraph", dataset.toString());
        }

        dataset.addSeries(series1);
        XYSeriesRenderer renderer10 = new XYSeriesRenderer();
        renderer10.setColor(Color.DKGRAY);
        renderer10.setLineWidth(3);
        mrenderer.addSeriesRenderer(renderer10);
        break;
    case 2:
        for(int i = 0; i < dataset.getSeriesCount(); i++) {
            dataset.removeSeries(i);
        }
        dataset.addSeries(series2);
        XYSeriesRenderer renderer20 = new XYSeriesRenderer();
        renderer20.setColor(Color.RED);     
        renderer20.setLineWidth(3);
        mrenderer.addSeriesRenderer(renderer20);
    case 3:
        for(int i = 0; i < dataset.getSeriesCount(); i++) {
            dataset.removeSeries(i);
        }
        dataset.addSeries(series3);
        XYSeriesRenderer renderer30 = new XYSeriesRenderer();
        renderer30.setColor(Color.WHITE);       
        renderer30.setLineWidth(3);
        mrenderer.addSeriesRenderer(renderer30);
    }

    mrenderer.setYTitle("Accuracy (%)");
    mrenderer.setYAxisMin(0);
    mrenderer.setYAxisMax(100);
    mrenderer.setApplyBackgroundColor(true);
    mrenderer.setBackgroundColor(Color.TRANSPARENT);

    //      Get the chart view result, add it to the linear layout
    GraphicalView mChartView = ChartFactory.getTimeChartView(this, dataset,
            mrenderer, "MM/dd/yyyy");

    LinearLayout graphLayout = (LinearLayout) findViewById(R.id.layout_graph);
    graphLayout.addView(mChartView, new LayoutParams(LayoutParams.MATCH_PARENT,
            LayoutParams.MATCH_PARENT));        

    if (mChartView !=null) {
        mChartView.repaint();
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T13:56:22.637

不确定我是否完全理解你的问题，但我可以给你一些线索。

要删除 中的所有渲染器`XYMultipleSeriesRenderer`：

```
renderer.removeAllRenderers(); 
```

要删除 中的所有系列`XYMultipleSeriesDataset`：

```
int size = dataset.getSeriesCount();
for (int i = 0; i < size; i++) {
  // always remove the first element because once you remove one element,
  // the size of the list becomes size - 1 and so on
  dataset.removeSeries(0);
} 
```

但是，如果您想隐藏一个系列，则只需删除该系列而不是全部。

# caching - CUDA：FERMI 上的纹理缓存是否与 L1 缓存分开？

> ID：13109154
> 
> 赞同：7
> 
> 时间：2012-10-28T13:27:03.623
> 
> 标签：caching, cuda, textures

重写代码以便通过纹理缓存加载数据是否有意义（假设我不需要过滤和其他纹理单元选项）还是相同？如何通过 L1 缓存和一些槽纹理单元加载一些数据？我有一个可以使用这种策略的代码，但它是否有意义？

为了清楚起见，我的意思是，“FERMI 上的纹理缓存是与 L1 缓存硬件分开的硬件” - 换句话说，我可以巧妙地为我的代码获得 L1 + 纹理缓存的总容量吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-28T14:10:41.800

它是分开的。纹理加载不经过 L1。对于非纹理应用程序（即您不使用插值和钳位等功能），纹理的主要好处是它允许您有选择地添加大量可以潜在缓存的全局内存（假设局部性和重用）而不会中断L1 发生了什么。对于小型数据集，纹理不会提供比 L1 更好的性能。对于有一些局部性和重用性的大型数据集，但是来自纹理缓存所覆盖区域的负载可能会破坏 L1（在 Fermi 上每个 SM 可能小至 16KB，具体取决于缓存配置），纹理缓存可以为整个应用程序带来好处。用户体验使用纹理的情况并不少见 t 与可以在 L1 中缓存的一样快，但比未缓存的加载或扰乱 L1 的分散加载要快得多。很大程度上取决于所涉及的数据的访问模式和大小。每个 SM 纹理缓存的大小约为 8KB。您可以缓存更大的区域，但高水平的重用和局部性肯定会提高纹理缓存的性能。另请注意，纹理内存是只读的。您可能对此感兴趣 另请注意，纹理内存是只读的。您可能对此感兴趣 另请注意，纹理内存是只读的。您可能对此感兴趣[网络研讨会](http://developer.download.nvidia.com/CUDA/training/CUDATextureMem_GraphicsInterop.mp4)。

# c# - 当有人键入错误答案时，C# 控制台关闭

> ID：13109159
> 
> 赞同：0
> 
> 时间：2012-10-28T13:27:29.453
> 
> 标签：c#, console-application

我一直在试图弄清楚当有人最终输入错误答案（在我的测验中）时如何让我的控制台关闭？

我试过 Environment.Exit(); 但它不起作用......它给了我错误：“方法'Exit'没有重载需要0个参数。

这是我的一些代码。我已经用注释标记了我希望退出代码的位置：

```
Console.WriteLine("In what country was Adolf Hitler born?");

string userAnswer = Console.ReadLine();

if (Answers.AnswerOne.Equals(userAnswer))
{
    Console.WriteLine("Congratulations! {0} is the correct answer!", Answers.AnswerOne);
    Console.WriteLine("\n\n(Press Enter to move on to the next question...)");
}
else if (!Answers.AnswerOne.Equals(userAnswer))
{
    Console.WriteLine("Sorry! You wrote the wrong answer!\nThe correct answer was {0}.", Answers.AnswerOne);
    Console.WriteLine("\n\n(Press Enter to exit...)");
    Console.ReadKey();
    //EXIT CONSOLE
} 
```

否则，代码运行得很好。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:30:23.133

您收到的错误消息是 100% 正确的。`Environment.Exit()`需要带参数调用。

试试[`Environment.Exit(0)`](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)。该`.Exit()`方法采用一个 int 值来指示“退出代码”。

> 提供给操作系统的退出代码。使用 0（零）表示该过程已成功完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:30:38.023

我想您会在这里找到多个答案：[如何在 .NET 中指定控制台应用程序的退出代码？](https://stackoverflow.com/questions/155610/how-do-i-specify-the-exit-code-of-a-console-application-in-net)

谷歌是你的朋友。:)

至于 Environment.Exit(int exitCode)：

```
// Summary:
//     Terminates this process and gives the underlying operating system the specified
//     exit code.
//
// Parameters:
//   exitCode:
//     Exit code to be given to the operating system. 
```

0 是没有出错时的默认退出代码。

# jquery - Bootstrap 模态 + 轮播。下一张和上一张幻灯片不会出现通过 Javascript 进行的转换

> ID：13109167
> 
> 赞同：2
> 
> 时间：2012-10-28T13:28:18.523
> 
> 标签：jquery, twitter-bootstrap, modal-dialog, carousel

我在模态窗口内使用 boostrap 轮播。

代码如下所示：

```
<div id="modal-window-slideshow" data-backdrop="static" class="modal-huge hide fade">
  <div class="modal-header">
    <button type="button" data-dismiss="modal" class="close" aria-hidden="true">×</button>
    <h3>Slides</h3>
  </div>
  <div class="modal-huge-body">
    <div id="myCarousel" class="carousel slide">
      <!-- Carousel items -->
      <div id="div-carousel-items" class="carousel-inner">

      <!-- Carousel nav -->
      <a href="#myCarousel" data-slide="prev" class="carousel-control left">‹&lt;/a>
      <a href="#myCarousel" data-slide="next" class="carousel-control right">›&lt;/a>
    </div>
  </div>
</div> 
```

当用户单击下一个和上一个按钮时，一切正常。但我也希望允许用户通过键盘上的左右箭头进行导航。我写了代码，但我遇到了奇怪的问题：在这种情况下过渡动画不起作用。我可以启用它吗？

**我的剧本**

```
$(document).keypress(function(event) {
  var LEFT_ARROW = 39; var RIGHT_ARROW = 37;

  if (typeof event !== 'undefined' && $('#modal-window-slideshow').is(':visible')) {
    if (event.keyCode === RIGHT_ARROW) {
      $(this).carousel('next');
    }

    if (event.keyCode === LEFT_ARROW) {
      $(this).carousel('prev');
    }
  }
  return true;
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T14:19:53.887

我想，我找到了解决方法。我只是寻找必要的链接，然后单击它。

```
$(document).keypress(function(event) {
    var LEFT_ARROW = 39; var RIGHT_ARROW = 37;

    if (event.keyCode === RIGHT_ARROW) {
      $('a.carousel-control.right').trigger('click');
    }

    if (event.keyCode === LEFT_ARROW) {
      $('a.carousel-control.left').trigger('click');
    }
   ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:09:02.663

```
 $(document).bind('keyup', function(e) {
    if(e.keyCode==39){
     //keycode for right arrow 
    }   
    else if(e.keyCode==37){
    // keycode for left arrow 
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-05T12:47:30.687

我已将此代码用于下一页和上一页，并将其与名为 next 和 previous 的 id 结合使用

```
$(document).keyup(function(e) {

            如果（e.keyCode == 39）{  
                window.location.href = $("#next").attr('href');
            }
            如果（e.keyCode==37）{
                window.location.href = $("#previous").attr('href');
            }});
```

因此，如果您的 html 页面中有一个元素，或者具有此 id 的 php 页面，则该函数专门使用该 id。

例子：

```
<div class="buttons">
<a href="www.urlpage.tld/previous/" class="prev" id="previous" title="Previous Page"></a> <a href="www.urlpage.tld/next/" class="next" id="next" title="Next Page"></a>
</div> 
```

我希望这对你有帮助。

问候！

# java - Web 应用程序中水平可扩展的写入一致性

> ID：13109168
> 
> 赞同：3
> 
> 时间：2012-10-28T13:28:22.100
> 
> 标签：java, web-applications, concurrency, scalability

我已经使用 Web 应用程序有一段时间了。但是，我从来没有处理过托管为多个实例并进行负载平衡的 Web 应用程序。

我的问题：Web 应用程序如何管理跨同一应用程序的多个实例的写入？

例如：订票网站。想象一下，我在某排座位上为一部电影挡住了座位，然后提交了我的请求。同时另一个用户（由于应用程序被集群和负载平衡而由其他实例提供服务）也阻止了我选择的一个席位，Web 应用程序如何管理这种情况？因为，它们是在不同机器上运行的不同进程，锁定发生在哪里？他们如何保持缓存一致性？有现成的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T13:35:41.613

好吧，你仍然会在单节点应用程序中遇到同样的问题，因为它是一个 JVM，所以管理它们更容易。

> 因为，它们是在不同机器上运行的不同进程，锁定发生在哪里？

由所有实例共享的单点数据库是最简单的目标。根据您预期的负载和用例，[*乐观锁定*](http://en.wikipedia.org/wiki/Optimistic_locking)很容易实现（[例如在 JPA 中](http://weblogs.java.net/blog/caroljmcdonald/archive/2009/07/jpa_20_concurre.html)）。结合数据库事务，您可以在没有交易性能的情况下实现一定程度的原子性。

> 他们如何保持缓存一致性？有现成的解决方案吗？

缓存很难，尤其是在分布式环境中。例如， [ehcache](/questions/tagged/ehcache "显示标记为“ehcache”的问题")可以在实例之间进行通信，一旦一个实例中的缓存发生更改，它就会将此事件广播到其他节点。还有很多其他产品，如[赤土陶器](/questions/tagged/terracotta "显示标记为“兵马俑”的问题")、[榛子树](/questions/tagged/hazelcast "显示标记为“hazelcast”的问题")等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:35:51.793

我在机票预订后端工作了几年。通常，在这种情况下，整个 Web 应用程序都由数据库支持，并且席位具有不同的状态：可用、已阻止、已预订。

这是它的工作原理：

*   用户 A 和 B 进入 webapp，都看到座位 S 可用。
*   用户 A 选择座位 S。在数据库中，S 的状态从`available`变为`booked`
*   用户 B 尝试选择座位 S。后端回复座位 S 是`blocked`，用户 B 看到一条错误消息。

您可以通过更新座位状态“实时”来使您的应用程序更加用户友好，例如使用 Ajax。

# visual-studio-2010 - 在 Visual Studio 中启动调试器时通过属性表更改 PATH

> ID：13109169
> 
> 赞同：5
> 
> 时间：2012-10-28T13:28:27.733
> 
> 标签：visual-studio-2010, visual-c++, path, msbuild, propertysheet

我有一组属性表，它们为我的 c++ 项目中常用的第三部分库定义包含和链接路径。当我在调试器中启动它时，有没有办法在这些页面中定义可执行文件以查找二进制文件？

**编辑**：我注意到如果我将以下内容添加到属性表（通过记事本）

```
<PropertyGroup>
   <VCRedistPaths>c:\path\bin\$(Platform);$(VCRedistPaths)</VCRedistPaths>
</PropertyGroup> 
```

然后，当应用程序在调试器下运行时，我得到 c:\path\bin\Win32 （例如）路径附加，但这里的问题是 Visual Studio 不会立即检测到我的更改（如果我更改属性表中的路径或追加另一个路径的另一个属性表），我必须重新启动 Visual Studio 才能更改拾取。任何人都知道这是否可以避免？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-26T02:33:59.107

这是一个在 VS2010 中为我工作的示例属性表：

### mysheet.props

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup>
    <LocalDebuggerEnvironment>PATH=%MYLIB_ROOT%\bin;%PATH%$(LocalDebuggerEnvironment)</LocalDebuggerEnvironment>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <ClCompile>
      <AdditionalIncludeDirectories>$(MYLIB_ROOT)\include</AdditionalIncludeDirectories>
    </ClCompile>
    <Link>
      <AdditionalLibraryDirectories>$(MYLIB_ROOT)\lib</AdditionalLibraryDirectories>
      <AdditionalDependencies>mylib.lib</AdditionalDependencies>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup />
</Project> 
```

`LocalDebuggerEnvironment`我通过在项目属性中手动设置 PATH 环境变量来获得使用的想法：

![proj_prop_env_var](../Images/ceb924b40b57b8260f6d48f9cfabcc1d.png)

此更改反映在`*.vcxproj.user`项目选项文件中，然后我将其复制到我自己的属性表中。

高温高压

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-28T14:43:07.880

不确定您在谈论哪种属性页面。它不能由项目属性表设置，它是一个调试设置。项目+属性，调试，环境设置。将其设置为，例如，

```
 path = c:\foo;c:\bar 
```

并且它们将被合并到系统环境的 PATH 变量值中。

请注意，一般来说，依赖 PATH 并不是一个好习惯。您将需要创建一个安装程序以确保用户的机器具有正确的 PATH 值。需要重新启动以确保其生效。它很容易被在你之后运行的糟糕安装程序破坏。

更好的方法是使用构建后事件，该事件使用 xcopy /d 将所需的 DLL 复制到 $(TargetDir) 中。

# php - 通配符无法更改目录

> ID：13109174
> 
> 赞同：-1
> 
> 时间：2012-10-28T13:29:01.193
> 
> 标签：php, windows

我不能使用 * 或 ? 用于更改目录

```
chdir ("c:\win*\system*"); 
```

它是如何工作的，我猜不出 Windows 的全名是什么，例如 WIN 或 winxp 或 win7。或者如何猜测它的全名

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:49:16.970

`chdir()`到系统应该为您选择的随机通配符目录以防发生冲突？*真的？！*

**路径是明确的。** *它在这里或那里......不是某个地方，只是为我查找它。*为什么首先尝试从 PHP 访问系统目录？权限设置对了吗？或者您想对使用您的脚本但自己无法猜测正确路径的用户进行修改？

> 想象一下，这家伙`chdir()`每次都要做一个简单的操作，必须列出多个文件夹中的路径。让我们谈谈**安全性**、 **性能**……但最重要的是……**常识**。

*我在SO上看到的东西......*

**PS**：*我-1'ed你。*这个问题不应该由对...开发内容了解最少的开发人员提出。想将东西注入系统目录，不要使用 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:40:15.183

偶然发现：

> **CHDIR 允许通配符作为路径名，并更改为找到的第一个目录，其名称与指定的通配符匹配**。这对于长目录名很方便，因为只需要输入足够多的路径来唯一标识目录，然后在路径名后面添加一个“*”。 [http://www.rcramer.com/tech/windows/cmd/ad.html#CHDIR](http://www.rcramer.com/tech/windows/cmd/ad.html#CHDIR)

![目录](../Images/fdea5a4215d3891fcdf3013621a2012b.png)

虽然它不是 PHP...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:06:56.043

你可能会误认为windows操作系统中[`chdir`](http://php.net/chdir)等于windows [`chdir`( `cd`) 。](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/chdir.mspx)但事实并非如此。

但是，这不应该给您带来任何问题，因为 PHP 和 shell 可以轻松地协同工作：

```
chdir(rtrim(`cd c:\win*\system* & cd`));
echo getcwd(); 
```

示例输出：

```
C:\WINDOWS\system 
```

如果你知道什么命令是做什么的，你可以很容易地解决这个问题。

# ajax - 如何在 jquery ajax 调用中动态传递数据参数（多个数据数组）

> ID：13109180
> 
> 赞同：4
> 
> 时间：2012-10-28T13:29:46.073
> 
> 标签：ajax, jquery

我有这个 ajax 代码：

```
return $.ajax({
        type: "POST",
        url: "somefile.php",
        cache:false,
        data: { "yfilter": $("#yearFilter").serializeArray(),
            "gfilter": $("#genreFilter").serializeArray() },
        dataType:"json",
        success: function(data){
            alert("success");
        } 
```

这工作正常，但我需要动态传递数据参数。现在我需要上面的数据参数内容和一个字符串。

我如何动态传递这个？/ 如何将其存储在变量中并将其传递给“数据：”字段？

```
 { "yfilter": $("#yearFilter").serializeArray(),
    "gfilter": $("#genreFilter").serializeArray() } 
```

我试过 JSON.stringify II 可能由于数据是一个数组而无法让它工作。

年份和流派数组直接来自 jquery 下拉菜单。它的选择就像它的#id 一样“$("#yearFilter")”。这是选择表单元素。

```
<select multiple="multiple" name="yearFilter[]" class="filterChange" id="yearFilter"> 
```

**我在基础级别需要的是：**

```
var someData = "";

    if(...){
        someData = { "yfilter": $("#yearFilter").serializeArray(),
                "gfilter": $("#genreFilter").serializeArray() };
    }
    else if(...){
        someData = "sampleString";
    } 
```

在ajax调用中：

```
...
data: someData,
... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-28T14:25:49.970

我想我知道您想要什么，但是由于诸如 json stringify 之类的无关问题，帖子过于复杂。这是一个函数，可以在代码中的多个地方使用，以进行一种或另一种 AJAX 调用。

然后，您可能会有几个按钮，并在处理程序中为每种类型的按钮调用函数，并更改传递给函数的参数

```
doAjax('someval');/* use in button 1*/
doAjax('someOtherval');/* use in button 2*/

function doAjax(arg) {

    var someData = "";
    if (arg == 'someval') {
        someData = {
            "yfilter": $("#yearFilter").val(),
            "gfilter": $("#genreFilter").val()
        };
    } else {
        someData = "sampleString";
    }

    $.ajax({
        type: "POST",
        url: "somefile.php",
        cache: false,
        data: someData,
        dataType: "json",
        success: function(data) {
            if (arg == 'someval') {
                alert("success 1");
            } else {
                alert("success 2");
            }
        }
    })
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:47:01.390

希望我已经理解你的要求。你可以这样做：

```
var parameters = {};
if (...) {
    parameters = $("#yearFilter").serializeArray();
}
if () {
    parameters = $("#genreFilter").serializeArray();
} 
```

然后替换该行：

```
parameters: { "yfilter": $("#yearFilter").serializeArray(),
              "gfilter": $("#genreFilter").serializeArray() }, 
```

和：

```
data: parameters, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T15:26:35.070

JSON 类型应该是动态数据的最佳选择。将您希望的任何数据推送到 json 中，如下所示，因此动态创建您的 json 并作为 ajax 数据发送。

```
var employees = {
    accounting: [],
    dept: "HR"
}; 

employees.accounting.push({ 
   "firstName" : item.firstName,
   "lastName"  : item.lastName,
   "age"       : item.age 
});

$.ajax({
        url: POSTURL,
        type: 'POST',
        dataType: 'json',
        data : employees,
        contentType: 'application/json; charset=utf-8',
        success: function (results)
        {

        },
        error: function (results)
        {
            jQuery.error(String.format("Status Code: {0}, ", results.status, results.statusText));
        }
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T09:24:29.953

尝试一下：

```
someData = JSON.stringify({ yfilter: $("#yearFilter").val(), gfilter: $("#genreFilter").val() }); 
```

它会起作用的。

# android - PARTIAL_WAKE_LOCK 杀死了我的媒体播放器

> ID：13109181
> 
> 赞同：0
> 
> 时间：2012-10-28T13:29:48.227
> 
> 标签：android, media-player, android-wake-lock

我实现了一个唤醒锁，以避免在屏幕关闭时停止我的 MediaPlayer（仅播放本地文件）。由于我不想耗尽电池，我尝试了 PARTIAL_WAKE_LOCK。但它没有效果：屏幕关闭会杀死我的玩家。FULL_WAKE_LOCK 工作正常，但屏幕按预期保持打开状态，耗尽电池...

我究竟做错了什么？

谢谢！L.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T09:58:24.397

看起来您将唤醒锁用于错误的目的。根据我的理解，根据您的解释：您需要在屏幕关闭时继续播放：

为此-我建议您尝试以下逻辑。

*   尝试让玩家在服务中运行（而不是在活动中）
*   使用 startForeground 方法启动服务（这也需要您包含通知）
*   使用 Messenger 在您的活动和服务之间进行通信。

但是唤醒锁可能会派上用场；因为这可能有助于将来处理音频卡顿问题。我对这部分不是很确定，因为我自己还没有尝试将唤醒锁作为口吃问题的解决方案。

（我不是专业/商业程序员；而是找到需求的临时开发人员设计解决方案，开发它并为自己使用。所以我的解决方案可能不是 100% 专业的方法，但我确信它确实工作）

祝你好运，编码愉快 - S.Mani

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-28T14:07:09.947

唤醒锁定是为了确保设备不会进入待机状态。

你想听的是`Intent.ACTION_SCREEN_OFF`告诉你屏幕现在关闭了

# ruby - 子类化Ruby Hash，对象没有Hash方法？

> ID：13109183
> 
> 赞同：2
> 
> 时间：2012-10-28T13:30:19.147
> 
> 标签：ruby, arrays, hash, subclass

我正在创建一个哈希对象，以便编写一个小脚本，一次读取文件一行，并将数组分配给我的哈希类。我得到的结果完全不同，这取决于我是否对 Hash 进行子类化，以及使用 super 更改我不理解的东西。

我的主要问题是，如果没有子类化哈希（< Hash）它可以完美地工作，但是我没有得到哈希的方法（比如迭代键并从中取出东西......子类化哈希让我做这些事情，但是它似乎只存储了散列数组的*最后一个*元素....所以任何关于如何获取子类方法的见解。Dictionary 类是我在这个网站上找到的一个很好的例子，并且完全符合我的要求，所以我试图了解如何正确使用它。

```
filename = 'inputfile.txt.'

# ??? class Dictionary < Hash
class Dictionary
  def initialize()
    @data = Hash.new { |hash, key| hash[key] = [] }
  end
  def [](key)
    @data[key]
  end
  def []=(key,words)
    @data[key] += [words].flatten
    @data[key]
#    super(key,words)
  end
end

listData = Dictionary.new

File.open(filename, 'r').each_line do |line|
  line = line.strip.split(/[^[:alpha:]|@|\.]/)
  puts "LIST-> #{line[0]}  SUB->  #{line[1]}  "
  listData[line[0]] = ("#{line[1]}")  
end

puts '====================================='
puts listData.inspect
puts '====================================='
print listData.reduce('') {|s, (k, v)|
  s << "The key is #{k} and the value is #{v}.\n"
} 
```

如果有人了解这里发生的事情，继承哈希，并有一些指针，那就太好了。

在没有明确 < 哈希的情况下运行：

```
./list.rb:34:in `<main>': undefined method `reduce' for #<Dictionary:0x007fcf0a8879e0> (NoMethodError) 
```

这是我在尝试以任何方式迭代我的哈希时看到的典型错误。

这是一个示例输入文件：

```
listA   billg@microsoft.com
listA   ed@apple.com
listA   frank@lotus.com
listB   evanwhite@go.com
listB   joespink@go.com
listB   fredgrey@stop.com 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:47:57.883

我无法使用您的代码重现您的问题：

```
d = Dictionary.new               #=> #<Dictionary:0x007f903a1adef8 @data={}>
d[4] << 5                        #=> [5]
d[5] << 6                        #=> [6]
d                                #=> #<Dictionary:0x007f903a1adef8 @data={4=>[5], 5=>[6]}>
d.instance_variable_get(:@data)  #=> {4=>[5], 5=>[6]} 
```

`reduce`但是，如果您不继承或包含定义它的类/模块，或者您自己定义它，那么您当然不会得到！

你实现的方式`Dictionary`肯定有问题。您应该尽可能调用`super`而不是重新实现。例如，这很有效：

```
class Dictionary < Hash
  def initialize
    super { |hash, key| hash[key] = [] }
  end
end

d = Dictionary.new  #=> {}
d['answer'] << 42   #=> [42]
d['pi'] << 3.14     #=> [3.14
d                   #=> {"answer"=>[42], "pi"=>[3.14]} 
```

如果您想重新实现内部哈希的存储方式和位置（即使用`@data`），您至少必须重新实现`each`（因为这是几乎所有 Enumerable 方法调用的）和 getter/setter。当您只能更改一种方法时，不值得付出努力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T13:49:12.843

虽然[Andrew Marshall 的回答](https://stackoverflow.com/a/13109298/1752422) 已经正确，但您也可以在下面尝试这种替代方法。

从您的代码开始，我们可以假设您想要创建一个行为类似于 Hash 的对象，但行为略有不同。因此我们的第一个代码将是这样的。

```
class Dictionary < Hash 
```

在这里为字典中的某个键分配一个新值会有所不同。从上面的示例中，分配不会用新值替换先前的值，而是将新值推送到先前的值或如果键尚不存在则使用新值初始化的新数组。

这里我使用`<<`操作符作为 Array 的 push 方法的简写。此外，该方法返回值，因为它是 super 所做的（参见 if 部分）

```
 def []=(key, value)
    if self[key]
      self[key] << value
      return value # here we mimic what super do
    else
      super(key, [value])
    end
  end 
```

使用我们自己的类的优点是我们可以向该类添加新方法，并且所有实例都可以访问它。因此，我们不需要对被认为是危险事物的 Hash 类进行猴子补丁。

```
 def size_of(key)
    return self[key].size if self[key]
    return 0   # the case for non existing key
  end 
```

现在，如果我们结合以上所有内容，我们将得到这段代码

```
class Dictionary < Hash
  def []=(key, value)
    if self[key]
      self[key] << value
      return value
    else
      super(key, [value])
    end
  end

  def size_of(key)
    return self[key].size if self[key]
    return 0   # the case for non existing key
  end
end

player_emails = Dictionary.new

player_emails["SAO"] = "kirito@sao.com" # note no << operator needed here
player_emails["ALO"] = "lyfa@alo.com"
player_emails["SAO"] = "lizbeth@sao.com"
player_emails["SAO"] = "asuna@sao.com"

player_emails.size_of("SAO") #=> 3
player_emails.size_of("ALO") #=> 1
player_emails.size_of("GGO") #=> 0

p listData
#=> {"SAO" => ["kirito@sao.com", "lizbeth@sao.com", "asuna@sao.com"],
#=>  "ALO" => ["lyfa@alo.com"] } 
```

但是，当然，类定义可以用这一行代替

```
player_emails = Hash.new { [] }
# note that we wont use
#
#     player_emails[key] = value
#
# instead
#
#     player_emails[key] << value
#
# Oh, if you consider the comment,
# it will no longer considered a single line 
```

答案完成后，我想评论您的一些示例代码：

```
filename = 'inputfile.txt.'
# Maybe it's better to use ARGF instead,
# so you could supply the filename in the command line
# and, is the filename ended with a dot? O.o;

File.open(filename, 'r').each_line do |line|
# This line open the file anonimously,
# then access each line of the file.
# Please correct me, Is the file will properly closed? I doubt no.

# Saver version:
File.open(filename, 'r') do |file|
  file.each_line do |line|
    # ...
  end
end   # the file will closed when we reach here

# ARGF version:
ARGF.each_line do |line|
  # ...
end

# Inside the each_line block
line = line.strip.split(/[^[:alpha:]|@|\.]/)
# I don't know what do you mean by that line,
# but using that regex will result 
#
#     ["listA", "", "", "billg@microsoft.com"]
#
# Hence, your example will fail since
# line[0] == "listA" and line[1] == ""
# also note that your regex mean
#
# any character except:
#   letters, '|', '@', '|', '\.'
#
# If you want to split over one or more
# whitespace characters use \s+ instead.
# Hence we could replace it with:
line = line.strip.split(/\s+/)

puts "LIST-> #{line[0]} SUB-> #{line[1]}   "
# OK, Is this supposed to debug the line?
# Tips: the simplest way to debug is:
#
#     p line
#
# that's all,

listData[line[0]] = ("#{line[1]}")
# why? using (), then "", then #{}
# I suggest:
listData[line[0]] = line[1]

# But to make more simple, actually you could do this instead
key, value = line.strip.split(/\s+/)
listData[key] = value

# Outside the block:
puts '====================================='
# OK, that's too loooooooooong...
puts '=' * 30
# or better assign it to a variable since you use it twice
a = '=' * 30
puts a
p listData # better way to debug
puts a

# next:
print listData.reduce('') { |s, (k, v)|
  s << "The key is #{k} and the value is #{v}.\n"
}
# why using reduce?
# for debugging you could use `p listData` instead.
# but since you are printing it, why not iterate for
# each element then print each of that.
listData.each do |k, v|
  puts "The key is #{k} and the value is #{v}."
end 
```

好的，不好意思说了这么多，希望对你有帮助。

# c# - 单元测试时我应该模拟 EF 的实体吗？

> ID：13109192
> 
> 赞同：1
> 
> 时间：2012-10-28T13:31:35.300
> 
> 标签：c#, visual-studio-2010, unit-testing, entity-framework-4, rhino-mocks

我读[了这篇关于模拟 Entity Framework(EF) 的帖子](http://www.codeproject.com/Articles/447988/How-to-Mock-Test-an-Entity-Framework-Model-First-P)。

我们不应该也抽象实体的类型吗？为了保持数据访问层 (DAL) 和业务层 (BL) 之间的解耦？

在上面的帖子中，他使用了 EF 具体生成的实体类型：

```
[TestMethod]
public void GetCustomer()
{
    ContextContainerMock container = new ContextContainerMock();
    IMyEntities en = container.Current;

**Customer c = new Customer { ID = 1, FirstName = "John", LastName = "Doe" };**
    en.Customers.AddObject(c);

    CustomerService service = new CustomerService(container);
    var a = service.GetCustomer(1);

    Assert.AreEqual(c.FirstName, a.FirstName);
    Assert.AreEqual(c.LastName, a.LastName);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:42:52.020

就个人而言，我不嘲笑这些。我直接创建、测试和清理。这帮助我在处理数据库时发现了更真实世界场景的问题。模拟非常适合测试您可能无法访问数据库等资源的集成。如果这是你的情况，那么你可能别无选择。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:01:06.483

最简洁的答案是不。

如果正确完成，实体不依赖于任何其他代码，除了其他实体和值对象（例如字符串、int 或您自己的值对象）。因此，没有必要嘲笑它们。

此外，实体是系统核心的一部分。它们就是您的系统的全部内容。您通常希望测试系统在对这些类进行操作时的行为，而不是测试系统在对*测试*所描述的行为进行操作时的行为。

（作为旁注，您的实体应该看起来和行为类似于现实世界中存在的东西。也就是说，您应该能够从组织的业务方面与非技术人员推理行为。从你的例子我看到可以创建一个没有名字的客户。从业务角度来看可以吗？如果不是，我会说你应该让构造函数将名字和姓氏作为参数。）

# c++ - XML文件中标签搜索的优化

> ID：13109195
> 
> 赞同：0
> 
> 时间：2012-10-28T13:32:11.193
> 
> 标签：c++, c, search

我正在编写自定义函数来获取 XML 文件中的所有标签。我正在使用这段代码：

```
wchar_t *GetLine(wchar_t *fileName=L"indexing.xml", wchar_t endSymbol = '\n')
{
    SetFilePointer(hReadFile,sizeof(wchar_t) * position, NULL, FILE_BEGIN);
    int size;
    wchar_t wchr[1];
    DWORD dw;
    size = 0;
    do
    {
        ReadFile(hReadFile, wchr, sizeof(wchar_t), &dw, NULL);
        if(!dw)
        {
            break;
        }
        tempGetLine[size] = wchr[0];
        size++;
    }while(wchr[0] != endSymbol);
    tempGetLine[size] = '\0';
    position += (size);
    return tempGetLine;
}
wchar_t *GetTag(wchar_t *fileName = L"indexing.xml")
{
    wchar_t *temp = GetLine(fileName,'>');
    int i = 0;
    while(*temp != '\0')
    {
        tempTag[i] = *temp;
        i++;
        temp++;
    }
    tempTag[i] = '\0';
    return tempTag;
} 
```

它可以工作，但在一个大文件中它需要很多迭代。如何优化我的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:34:28.060

您可能应该考虑迁移到适当的解析器生成器。

用于此类任务的一个很好的 C++ 库是 boost spirit-qi，甚至还有一个 XML 示例。

[http://www.boost.org/doc/libs/1_51_0/libs/spirit/doc/html/index.html](http://www.boost.org/doc/libs/1_51_0/libs/spirit/doc/html/index.html)

[xml 示例](http://www.boost.org/doc/libs/1_51_0/libs/spirit/doc/html/spirit/qi/tutorials/mini_xml___asts_.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:58:35.247

看起来您正在调用`SetFilePointer()`每个*标签*。如果您在两次调用之间没有对文件进行任何其他读取或写入操作`GetTag()`，则根本不要打扰调用`SetFilePointer()`。这是不必要的，并且此调用可能会减少操作系统完成的缓冲量。

# android - 如何为远程文件创建视频缩略图？

> ID：13109197
> 
> 赞同：1
> 
> 时间：2012-10-28T13:32:32.347
> 
> 标签：android, thumbnails, android-videoview

我正在尝试为文件创建视频缩略图： 1- 该文件位于 YouTube 上。2-我会开始隐含意图让 Andriod OS 使用以下方式播放此文件：

```
Intent intent= new Intent(Intent.ACTION_VIEW, Uri.parse(youTubeVideoWebPath));
startActivity(intent); 
```

在哪里

```
String youTubeVideoWebPath = "http://www.youtube.com/watch?feature=player_detailpage&v=OZJalBmtGnQ"; 
```

在论坛上搜索了一些帖子后，我发现它可能是：1- VideoView 并使用我将从视频中提取的缩略图设置其背景或 2- ImageView 使用提取的缩略图设置其源/背景

当单击一个项目（无论是 VideoView 还是 ImageView）时，我将发送前面提到的意图。由于我不打算通过我的应用程序控制播放视频，我想使用 ImageView 会更好，对吧？

其次，我想为该远程文件创建一个视频缩略图，那么最好/最简单的方法是什么？对我来说，在论坛上做了更多搜索后，我找到了以下方法：

```
Bitmap thumbAsBitmap = ThumbnailUtils.createVideoThumbnail(filePath, MediaStore.Video.Thumbnails.MINI_KIND); 
```

但它总是返回 null，我不知道为什么虽然我传递了它： filePath：上面提到的文件的 web 路径第二个参数：不确定它应该是 MediaStore.Video.Thumbnails.MINI_KIND 还是 MediaStore.Images.Thumbnails.MINI_KIND ?

我只能找到与从保存在内部/外部存储器中的文件中提取 VideoThumbnail 相关的帖子，与我的案例等远程文件无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:49:06.070

为什么不获取 YouTube 缩略图？它看起来很简单。获得视频 URL 后，如下所示：

```
https://www.youtube.com/watch?v=dRpFF5Dm-k0 
```

您提取视频 ID（在本例中为`dRpFF5Dm-k0`），您的缩略图位于：

```
http://i1.ytimg.com/vi/<VIDEOID>/default.jpg 
```

所以在这种情况下：

```
http://i1.ytimg.com/vi/dRpFF5Dm-k0/default.jpg 
```

不确定这是否适用于任何视频（我刚刚发现这是为了回答您的问题），但至少这是一个好的开始:)

# java - 使用应用程序访问令牌在 Facebook 页面上发布

> ID：13109198
> 
> 赞同：2
> 
> 时间：2012-10-28T13:32:41.567
> 
> 标签：java, facebook, facebook-graph-api, facebook-apps, restfb

我有一个 facebook 页面、一个 facebook 应用程序和该页面的管理员 facebook 帐户。

现在我想在该页面上发布一个链接（我不在乎如何）。

从现在开始，我通过为我的应用程序获取管理员的用户访问令牌来做到这一点，然后获取页面，获取访问令牌，然后通过我的应用程序在页面上与管理员一起发布。

现在令牌过期了，我在文档中读到了我可以：

> 例如，如果用户授予您的应用程序 publish_stream 权限，您的应用程序可以使用应用程序访问令牌代表他们发布状态更新。

所以我得到了应用程序访问令牌。

但是现在我不知道该怎么做，我怎样才能用那个令牌在页面的墙上发布？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:58:04.277

我相信应用程序访问令牌是代表*用户*发布的。对于页面，您应该使用页面访问令牌。

[https://developers.facebook.com/docs/reference/api/page/](https://developers.facebook.com/docs/reference/api/page/)

如上面链接中所述

> 要以 Page 而非当前用户的身份执行以下操作，您必须使用 Page 的访问令牌，而不是通常用于读取 Graph API 对象的用户访问令牌。可以通过向具有 manage_pages 权限的 /USER_ID/accounts 发出 HTTP GET 来检索此访问令牌。这将返回用户具有管理权限的页面列表（包括应用程序配置页面），以及这些页面的 access_tokens。或者，您可以通过向具有 manage_pages 权限的 /PAGE_ID?fields=access_token 发出 HTTP GET 来获取单个特定页面的页面访问令牌，如上所述。除非另有说明，否则发布到页面还需要 publish_stream 权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T09:27:48.723

经过更多研究，我认为没有办法在只有应用令牌的页面上发布。

It is still possible to post on the wall of the users that authorized the app, but not on their pages ...

# objective-c - 更新媒体集合队列 MPMediaItemCollection 时短暂停止/开始正在播放项目

> ID：13109200
> 
> 赞同：3
> 
> 时间：2012-10-28T13:32:56.730
> 
> 标签：objective-c, xcode, mpmediaitemcollection

我在 xcode 中玩苹果 addMusic 示例应用程序，因为我希望能够添加类似的功能（在应用程序的后台播放用户选择的音乐队列）。

当用户在内置 MediaPicker 中选择他们的歌曲选择后点击“完成”按钮时，音乐播放器会在再次播放之前短暂停止，这很烦人。- 我假设这是因为苹果使用的方法，它将一个新数组应用为队列，并将当前播放状态重置为它停止的位置（就像这样:)

```
 // apply the new media item collection as a playback queue for the music player
        [self setUserMediaItemCollection: mediaItemCollection];
        [musicPlayer setQueueWithItemCollection: userMediaItemCollection];
        [self setPlayedMusicOnce: YES];
        [musicPlayer play];

        // Obtain the music player's state so it can then be
        //      restored after updating the playback queue.
    } else {

        // Take note of whether or not the music player is playing. If it is
        //      it needs to be started again at the end of this method.
        BOOL wasPlaying = NO;
        if (musicPlayer.playbackState == MPMusicPlaybackStatePlaying) {
            wasPlaying = YES;
        }

        // Save the now-playing item and its current playback time.
        MPMediaItem *nowPlayingItem         = musicPlayer.nowPlayingItem;
        NSTimeInterval currentPlaybackTime  = musicPlayer.currentPlaybackTime;

        // Combine the previously-existing media item collection with the new one
        NSMutableArray *combinedMediaItems  = [[userMediaItemCollection items] mutableCopy];
        NSArray *newMediaItems              = [mediaItemCollection items];
        [combinedMediaItems addObjectsFromArray: newMediaItems];

        [self setUserMediaItemCollection: [MPMediaItemCollection collectionWithItems: (NSArray *) combinedMediaItems]];

        // Apply the new media item collection as a playback queue for the music player.
        [musicPlayer setQueueWithItemCollection: userMediaItemCollection];

        // Restore the now-playing item and its current playback time.
        musicPlayer.nowPlayingItem          = nowPlayingItem;
        musicPlayer.currentPlaybackTime     = currentPlaybackTime;

        // If the music player was playing, get it playing again.
        if (wasPlaying) {
            [musicPlayer play];

        }
    }

}
}

// If the music player was paused, leave it paused. If it was playing, it will continue to
//      play on its own. The music player state is "stopped" only if the previous list of songs
//      had finished or if this is the first time the user has chosen songs after app
//      launch--in which case, invoke play.

- (void) restorePlaybackState {

if (musicPlayer.playbackState == MPMusicPlaybackStateStopped && userMediaItemCollection) {

    if (playedMusicOnce == NO) {

        [self setPlayedMusicOnce: YES];
        [musicPlayer play];
    }
}

} 
```

有人遇到过这个问题吗？有没有人能想到的替代/更有效的方法？

提前感谢分享:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T11:25:56.007

只需在音乐播放器更改通知点将更改应用于 MPMediaItemCollection。

# php - 加快 PHP Imagick 库 PDF -> PNG 转换（20 秒！）

> ID：13109202
> 
> 赞同：4
> 
> 时间：2012-10-28T13:33:05.140
> 
> 标签：php, imagick

我正在使用[Imagick](http://www.php.net/manual/fr/book.imagick.php)将 PDF 的第一页转换为 PNG 图像。它正在工作，但速度很慢。

大约 100kb 的 PDF 转换需要 8 到 20 秒。

有没有办法加快转换速度？

我的代码：

```
$im = new Imagick($url);
$im->setIteratorIndex(0);
$im->setCompression(Imagick::COMPRESSION_LZW);
$im->setCompressionQuality(90);
$im->setImageFormat("png");
$im->writeImage('C:/Shared/test.png'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:42:34.187

> 有没有办法加快转换速度？

当然，用更多的处理能力、更多的内存和更快的磁盘升级机器。

此外，您似乎使用的是 Windows 操作系统。我建议您切换到 Linux 系统并编译针对其运行的计算机架构优化的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T09:18:23.843

事实上，我不需要 Imagick 库来生成 PDF 第一页的简单 JPG 预览，我只需要 GhostScript。

使用 GhostScript 进行命令行转换总是比 Imagick 快（命令行或通过 PHP）

12 页和 650kb 的示例：

*   命令行 GhostScript => 0.6 秒
*   命令行 Imagick => 0.8 秒
*   PHP 扩展 Imagick => 2.22 秒

对于一些文档，Imagick 需要 20 秒，而使用直接 GS 命令行则需要 1.5 秒。

这是我的测试脚本

```
 <?php

    $pathToPdf = realpath("in.pdf");

    $pathToJpg = "./out.jpg";
    $pathToPng = "./out.png";

    try
        {

        $time_start = microtime(true);      
        $gsCall = "\"C:\Program Files (x86)\gs\gs9.06\bin\gswin32.exe\" -q -dBATCH -dMaxBitmap=300000000 -dNOPAUSE -dSAFER -sDEVICE=jpeg -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dFirstPage=1 -dLastPage=1 -sOutputFile=\"{0}\" \"{1}\" -c quit";
        $gsCall = str_replace(array('{0}', '{1}'), array($pathToJpg, $pathToPdf), $gsCall); // or use sprintf
        $str = exec($gsCall, $output=array(), $returnValue);
        echo $gsCall.'<br><br>';
        $time_end = microtime(true);
        $time = $time_end - $time_start;        
        if($returnValue == 0)              
            print "<br><br>Conversion OK ".$time;
        else 
            print "<br><br>Conversion failed.<br />".var_dump($output);     

        $time_start = microtime(true);          
        exec('convert "'.$pathToPdf.'[0]" "'.$pathToPng.'"', $output, $returnValue);                        
        $time_end = microtime(true);
        $time = $time_end - $time_start;
        if($returnValue == 0)              
            print "<br><br>Conversion OK ".$time;
        else 
            print "<br><br>Conversion failed.<br />".var_dump($output);

        $time_start = microtime(true);
        $im = new Imagick($pathToPdf);
        $im->setIteratorIndex(0);
        $im->setCompression(Imagick::COMPRESSION_LZW);
        $im->setCompressionQuality(90);
        $im->setImageFormat("png");
        $im->writeImage('\\\\DELL-PC\Shared\test.png');
        //$im->thumbnailImage(200, 0);
        //echo $im;
        $time_end = microtime(true);
        $time = $time_end - $time_start;
        print "<br><br>Conversion OK ".$time;
    }
catch(Exception $e)
{
    echo $e->getMessage();
}
?> 
```

# android - achartengine 删除图表背景

> ID：13109204
> 
> 赞同：1
> 
> 时间：2012-10-28T13:33:15.437
> 
> 标签：android, achartengine

我正在尝试删除我的图形的整个颜色背景，包括这个黑色边框，开始用我自己的自定义。我试过了：

```
 mrenderer.setApplyBackgroundColor(true);
    mrenderer.setBackgroundColor(Color.TRANSPARENT); 
```

结果如下：

![在此处输入图像描述](../Images/f234efd29a245ccb8cd851f8e6e3a7da.png)

有没有办法把它全部拿出来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:04:11.243

尝试将颜色设置为`Color.argb(0, 255, 255, 255)`而不是`Color.TRANSPARENT`.

# python - 如何在 C/C++ 中调用 Python 函数的简单示例

> ID：13109205
> 
> 赞同：3
> 
> 时间：2012-10-28T13:33:16.697
> 
> 标签：python, c++, c

我已经通过谷歌搜索了很多参考资料，但我只看到了一个复杂的编码示例，你能给我一个例子（简单代码）以便我理解。我已经编写了代码，但每次运行它都会中断 这是代码

```
#include <Python.h>
int main()
{
  PyObject *pName, *pModule, *pDict, *pFun, *pValue;
  // Initialize the Python Interpreter
  Py_Initialize();
 // Build the name object
 pName = PyString_FromString("C:\\Documents and Settings\\MASTER\\My Documents\\Visual Studio       2010\\Projects\\Python\\Test.py");
if(pName)printf("OK");

// Load the module object
pModule = PyImport_Import(pName);

// pDict is a borrowed reference 
pDict = PyModule_GetDict(pModule);

// pFunc is also a borrowed reference 
pFun = PyDict_GetItemString(pDict, "prinTname");

if (PyCallable_Check(pFun)) 
{
    PyObject_CallObject(pFun, NULL);
} else 
{
    PyErr_Print();
}

// Clean up
Py_DECREF(pModule);
Py_DECREF(pName);

Py_DECREF(pDict);
Py_DECREF(pFun);
// Finish the Python Interpreter
Py_Finalize();
getchar();
return 0;
} 
```

并且在 Python.exe 中的 0x1e00503b 处有一些消息 First-chance exception：0xC0000005：访问冲突读取位置 0x00000004。Python.exe 中 0x1e00503b 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000004。程序“[4548] Python.exe: Native”已退出，代码为 0 (0x0)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:26:34.367

这是我问的一个问题的一些代码。这应该做你想要的。

args：argv[1] 包含您的 .py 文件的路径 argv[2] 包含您要调用的函数的名称

```
int wmain(int argc, wchar_t** argv)
{
    PyObject* py_imp_str;
    PyObject* py_imp_handle;
    PyObject* py_imp_dict; //borrowed
    PyObject* py_imp_load_source; //borrowed
    PyObject* py_dir; //stolen
    PyObject* py_lib_name; //stolen
    PyObject* py_args_tuple;
    PyObject* py_lib_mod;
    PyObject* py_func;
    PyObject* py_ret;

    Py_Initialize();

    //import our python script using the imp library (the normal import doesn't allow you to grab py files in random directories)
    py_dir = PyUnicode_FromWideChar(argv[1], wcslen(argv[1]));
    py_imp_str = PyString_FromString("imp");
    py_imp_handle = PyImport_Import(py_imp_str); //normal python import for imp
    py_imp_dict = PyModule_GetDict(py_imp_handle); //borrowed
    py_imp_load_source = PyDict_GetItemString(py_imp_dict, "load_source"); //borrowed
    py_lib_name = PyUnicode_FromWideChar(argv[2], wcslen(argv[2]));

    //setup args for imp.load_source
    py_args_tuple = PyTuple_New(2);
    PyTuple_SetItem(py_args_tuple, 0, py_lib_name); //stolen
    PyTuple_SetItem(py_args_tuple, 1, py_dir); //stolen

    //call imp.load_source
    py_lib_mod = PyObject_CallObject(py_imp_load_source, py_args_tuple);
    py_lib_mod_dict = PyModule_GetDict(py_lib_mod); //borrowed

    //get function object
    py_func = PyDict_GetItem(py_lib_mod_dict, py_lib_name);
    //call function object
    py_ret = PyObject_CallFunction(py_func, NULL);

    if (py_ret)
    {
        printf("PyObject_CallFunction from wmain was successful!\n");
        Py_DECREF(py_ret);
    }
    else
        printf("PyObject_CallFunction from wmain failed!\n");

    Py_DECREF(py_imp_str);
    Py_DECREF(py_imp_handle);
    Py_DECREF(py_args_tuple);
    Py_DECREF(py_lib_mod);

    Py_Finalize();

    fflush(stderr);
    fflush(stdout);
    return 0;
} 
```

如果您还没有找到它，以下链接描述了 Python 的 C 接口。非常方便： [http ://docs.python.org/2/c-api/index.html](http://docs.python.org/2/c-api/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:43:15.387

您很可能没有安装 python 开发工具，即从未找到 python.h。找到 python.h 并查找编译错误，如果有，请重新发布。

编辑：这是旧信息。包含应该像将包含目录添加到包含目录一样简单，请参阅：[如何让 Visual Express 2010 找到我的 python.h 头文件？](https://stackoverflow.com/questions/6613039/how-do-i-get-visual-express-2010-to-find-my-python-h-header-file)

# android - 即使复制原始列表，列表中的原始数据也会在方法内发生变化

> ID：13109222
> 
> 赞同：0
> 
> 时间：2012-10-28T13:35:03.017
> 
> 标签：android, pointers, reference, arraylist

为什么我在调用方法中更改了原始数据，即使在被调用方法中使用以下内容复制原始列表：

```
originalDatesSerie = datesSerie ; 
```

而不是使用：

```
originalDatesSerie.addAll(datesSerie) ; 
```

在被调用方法中使用时，原始列表保持在调用方法`addAll`中，因此在这种情况下结果符合预期。

这是一段丑陋的代码，它是好的（但如果使用直接相等的分配则不行）：

```
 private static HashMap<String, Object> autoScaling(List<Date[]> datesSerie, List<double[]> valuesSerie,
                HashMap<String, Long> xminMax) {

        // Copy original List (required to keep them unchanged)
        List<Date[]> originalDatesSerie = new ArrayList<Date[]> ();
        originalDatesSerie.addAll(datesSerie);//do NOT use "="
        List<double[]> originalValuesSerie = new ArrayList<double[]> ();
        originalValuesSerie.addAll(valuesSerie);//do NOT use "="

...

        // Concat new datas with original datas
        originalDatesSerie.addAll(Xaxis);
        originalValuesSerie.addAll(Yaxis);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:54:06.040

在您的第一个示例 ( `originalDatesSerie = datesSerie ;`) 中，您正在分配对 to 的引用`dateSerie`，`originalDatesSerie`这意味着两者都引用了相同的`ArrayList`. 当您通过一个引用对对象进行更改或添加/删除对象时，它会反映在两者中。

在第二个示例`originalDatesSerie.addAll(datesSerie) ;`中，`originalDatesSerie`引用 中的每个对象`dateSerie`，但引用是一组单独的引用 ( `ListArray`)。将对象添加到 时，会将`originalDatesSerie`它们添加到单独的集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:58:29.317

> 为什么我在调用方法中更改了原始数据，即使在被调用方法中使用以下内容复制原始列表：

使用哪种类型的复制并不重要 - addAll() 或 '='。您的 item 元素是 Dates ，它们是可变对象。引用存在于两个不同列表中的可变对象可以从任一列表中进行变异。在函数之间传递不可变对象以隔离它们。

# php - 从数据库中选择数字进行求和

> ID：13109225
> 
> 赞同：-1
> 
> 时间：2012-10-28T13:36:20.330
> 
> 标签：php, mysql, sql

我想从数据库中获取数字并将它们用于总和。我真的不知道如何开始，但我放弃了。当我直接从数据库中回显一个数字时，我得到了一个错误，这对我的自学没有帮助。我不知道我做错了什么，但我认为这是一个简单的问题。这是代码：

```
<?php

session_start();

$connection = mysql_connect("mysql15.000webhost.com", "a4987634_quiz", "**********")
or die (mysql_error());

mysql_select_db("a4987634_quiz", $connection)
or die (mysql_error());

$username = $_SESSION['username'];
$password = $_SESSION['password'];

$q1 = mysql_query ("SELECT 'q1' FROM users WHERE username='$username'");
$q2 = mysql_query ("SELECT 'q2' FROM users WHERE username='$username'");
$q3 = mysql_query ("SELECT 'q3' FROM users WHERE username='$username'");
$q4 = mysql_query ("SELECT 'q4' FROM users WHERE username='$username'");
$q5 = mysql_query ("SELECT 'q5' FROM users WHERE username='$username'");

$result = $q1 + $q2 + $q3 + $q4 + $q5 ;

echo $result ;

?> 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:40:48.073

假设每个用户名只有一行用户，则：

```
Select q1 + q2 + q3 + q4 + q5 as total from users where username = '$username' 
```

如果有多个，那么您可能想要

```
Select Sum(q1 + q2 + q3 + q4 + q5) as total from users where username = '$username' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:37:50.927

我认为您可以在这里使用简单的运算符-

```
SELECT (q1+q2+q3+q4+q5) AS total FROM users WHERE username='$username' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:12:17.193

您不能直接添加结果集，而是从每个结果集中读取特定的字段值。
将从每个结果集中读取的字段值相加以求和，然后回显结果。

**示例**：

```
$result = 0;
$resultSetsArray = array( $q1, $q2, $q3, $q4, $q5 );  

foreach( $resultSetsArray as $rs ) {  
  while( $row = mysql_fetch_array( $rs ) ) {  
    $result = $result + $row[ 1 ];  
    break; // while  
  } // while rs  
} // for each  

echo "result : " . $result; 
```

* * *

您有更好的方法来汇总数据库表列的列值。
看来您需要更多地学习和练习 PHP 和 MySQL。

# c# - 一旦方法完成，我的变量就会不断切换回来

> ID：13109226
> 
> 赞同：1
> 
> 时间：2012-10-28T13:36:21.257
> 
> 标签：c#, variables, switch-statement

我快要爆炸了。我一直在寻找两个小时来解决这个问题的方法。我在 setTimer 方法中有一个 switch 语句。当我调试程序时，timerType 值会在方法运行时发生变化，但一旦退出，timerType 就会恢复为 null。这使我的 case 语句变得毫无用处，因为我需要在下次调用该方法时对其进行更改。我很想得到你的帮助，因为我确信它和往常一样简单:(。我尝试将其更改为 int 以查看它是否与 String 类型或其他什么有关。我有点菜鸟。请停止我不再挣扎（至少在这个特定问题上:)）

```
public string timerType;

if (checkRoundChanged()) {
     SoundPlayer.Play();
     setTimer(timerType);
} 
```

和方法

```
protected void setTimer(String timerType){
        switch (timerType) {
            case "ready":
                secLeft = readySec;
                minLeft = readyMin;
                timerType = "round";
                break;
            case "round":
                secLeft = roundSec;
                minLeft = roundMin;
                timerType = "rest";
                break;
            case "rest":
                secLeft = restSec;
                minLeft = restMin;
                timerType = "round";
                break;
            case "relax":
                secLeft = relaxSec;
                minLeft = relaxMin;
                timerType = "done";
                break;
            default:
                timerType = "ready";
                break;
        }

    } 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:38:31.693

字符串是按值传递的，而不是按引用传递的。您可以返回新值：

```
protected string setTimer(String timerType){
    switch (timerType) {
        case "ready":
            secLeft = readySec;
            minLeft = readyMin;
            timerType = "round";
            break;
        case "round":
            secLeft = roundSec;
            minLeft = roundMin;
            timerType = "rest";
            break;
        case "rest":
            secLeft = restSec;
            minLeft = restMin;
            timerType = "round";
            break;
        case "relax":
            secLeft = relaxSec;
            minLeft = relaxMin;
            timerType = "done";
            break;
        default:
            timerType = "ready";
            break;
    }

    return timerType;
}

....

timerType =  setTimer(timerType); 
```

或通过引用传递：

```
protected void setTimer(ref String timerType) {
   ...
   timerType = newValue;
   ...
}

setTimer(ref timerType); 
```

这是一些[推荐阅读](https://stackoverflow.com/questions/1096449/c-sharp-string-reference-type)。

# url - 如何在 Dart 中以正确的方式重定向和重新加载？

> ID：13109233
> 
> 赞同：24
> 
> 时间：2012-10-28T13:37:14.537
> 
> 标签：url, redirect, dart

在 Dart 中进行重定向和重新加载的首选方法是什么？

我们只使用：`window.location.href = window.location.href`？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-10-28T14:01:19.937

有几种不同的方法可以处理 URI 更改，并且每种方法都有自己的用途。

1.  当您想将用户发送到另一个 URI 时：

    *   `window.location.assign('http://google.com')`

        这会将用户发送到 Google，保留浏览历史记录（后退按钮历史记录）。这就像点击一个链接。

    *   `window.location.href = 'http://google.com'`

        与上面相同，只是另一种方法。`href`是一个 setter，并导致分配发生。我觉得以前的版本更干净。

    *   `window.location.replace('http://google.com');`

        但是，对象上的[`replace()`](http://api.dartlang.org/docs/bleeding_edge/dart_html/LocalLocation.html#reload)方法[`LocalLocation`](http://api.dartlang.org/docs/bleeding_edge/dart_html/LocalLocation.html)不仅将用户发送到 Google，而且不会将原始页面放入会话历史记录中，这意味着用户不会遭受永无止境的后退按钮噩梦。

        这本质上与 HTTP 重定向相同。历史被跳过。

2.  当您想要重新加载/刷新时。

    *   `window.location.assign(window.location.href)`

        将当前页面重新加载到完全相同的 URI。这不**包含**数据`POST`。我可能会从缓存中重新加载某些资源（如图像等），因此它可能不是完全重新加载。

        这本质上与按下`F5`和跳过`POST`数据发送相同。

    *   `window.location.href = window.location.href`

        再次，与之前相同。

    *   `window.location.reload()`

        这种重新加载页面的方式也会导致`POST`数据被发送。的“JavaScript 版本”[`window.location.reload()`](https://developer.mozilla.org/en-US/docs/DOM/window.location)还支持指定是否跳过缓存的参数。但是，当前的 Dart 实现不支持该参数，并且默认从缓存中获取资源。

        这个缓存参数可能会在某个时候添加到 Dart，但它还没有。当它到达时，您很可能只是`true`作为第一个参数传递，然后它就像`Ctrl + Shift + R`.

## 概括

*   **我想模拟点击`<a>`标签。**

使用`window.location.assign(url)`.

*   **我想重定向到像 HTTP 重定向这样的新网站并跳过后退按钮历史记录。**

使用`window.location.replace(url)`.

*   **我想`F5`用`POST`数据做一个。**

使用`window.location.reload()`.

*   **我想做一个`F5`没有`POST`数据的。**

使用`window.location.assign(window.location.href)`.

*   **我想做一个`Ctrl + Shift + F5`.**

不可用，可能在将来。它可能是`window.location.reload(true)`。

# html - 浮动或内联块元素的自动边距

> ID：13109238
> 
> 赞同：0
> 
> 时间：2012-10-28T13:38:20.977
> 
> 标签：html, css

我正在尝试很好地制作 div 空间中的所有子元素。我已经使用 inline-block 元素和浮动元素设置了 css。子元素是固定大小的。

[jsFiddle](http://jsfiddle.net/tSbaR/18/)

HTML

```
<div class="content">
    <h2>Inline-block</h2>
    <a href="#" class="i-b-item">I-B Item 1</a>
    <a href="#" class="i-b-item">I-B Item 2</a>
    <a href="#" class="i-b-item">I-B Item 3</a>
    <a href="#" class="i-b-item">I-B Item 4</a>
    <a href="#" class="i-b-item">I-B Item 5</a>
    <a href="#" class="i-b-item">I-B Item 6</a>
    <a href="#" class="i-b-item">I-B Item 7</a>
    <a href="#" class="i-b-item">I-B Item 8</a>
    <h2>Floated</h2>
    <a href="#" class="f-item">Float Item 1</a>
    <a href="#" class="f-item">Float Item 2</a>
    <a href="#" class="f-item">Float Item 3</a>
    <a href="#" class="f-item">Float Item 4</a>
    <a href="#" class="f-item">Float Item 5</a>
    <a href="#" class="f-item">Float Item 6</a>
    <a href="#" class="f-item">Float Item 7</a>
    <a href="#" class="f-item">Float Item 8</a>
    <div style="clear:both"></div>
</div> 
```

CSS

```
.content {
    background: grey;
}

.content a{
    padding: .5em;
    margin: .5em;
    height: 75px;
    width: 150px;
    background: white;
}

.i-b-item{
    display: inline-block;
}

.f-item{
    float: left;
    display: block;
} 
```

基本上当窗口大小发生变化时，我希望子元素边距使它们填充剩余空间。因此，我希望子元素的边距扩大到所有子元素的空间均匀，同时仍保持左对齐，而不是在右侧留出剩余空间。

我不想用 Javascript 做任何计算，我希望有一个纯 css 解决方案，但似乎无法让任何事情正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-20T23:15:37.483

用于`text-align:justify`子元素设置为的父元素`display:inline-block`。

在你的情况下，`.content`类可以拥有它。并且您的空间将平均分配，而元素可以保持固定大小（宽度）。

```
.content {
    text-align:justify;
} 
```

希望这可以帮助。

# bash - 无法在makefile中调用bash函数

> ID：13109242
> 
> 赞同：8
> 
> 时间：2012-10-28T13:38:33.867
> 
> 标签：bash, makefile, gnu-make

我的印象是我可以在 GNU makefile 中调用 bash 函数，但似乎是错误的。这是一个简单的测试，我定义了这个函数：

```
>type lsc
lsc is a function
lsc () 
{ 
    ls --color=auto --color=tty
} 
```

这是我的Makefile：

```
>cat Makefile
all:
    lsc 
```

这是我在运行 make 时得到的：

```
>make
lsc
make: lsc: Command not found
make: *** [all] Error 127 
```

我的印象有错吗？还是有任何环境设置问题？我可以在命令行运行“lsc”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-10-07T09:58:14.697

`$*`在 BASH 脚本中使用：

**函数.sh**

```
_my_function() {
  echo $1
}

# Allows to call a function based on arguments passed to the script
$* 
```

**生成文件**

```
test:
    ./functions.sh _my_function "hello!" 
```

运行示例：

```
$ make test
./functions.sh _my_function "hello!"
hello! 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-29T23:04:00.160

您不能在 Makefile 中调用 bash 函数或别名，只能调用二进制文件和脚本。但是，您可以做的是调用交互式 bash 并指示它调用您的函数或别名：

```
all:
    bash -i -c lsc 
```

例如，如果`lsc`在您的 中定义`.bashrc`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T00:41:35.227

您是否使用“export -f”导出了您的函数？

bash 是 Makefile 的外壳，还是 sh？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-04T01:57:10.993

如果您从问题[How do I write the 'cd' command in a makefile？](https://stackoverflow.com/questions/1789594/how-do-i-write-the-cd-command-in-a-makefile)

```
.ONESHELL: my_target

my_target: dependency
    . ./shell_script.sh
    my_imported_shell_function "String Parameter" 
```

如果你愿意，你甚至可以不使用这个东西，只在导入 shell 脚本后`.ONESHELL`使用冒号在一行中完成所有操作：`;`

```
my_target: dependency
    . ./shell_script.sh; my_imported_shell_function "String Parameter" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-07T07:46:49.833

这个问题并不是`make`. *Make 在 shell 的上下文中执行命令，如果函数可用*，shell 可以执行函数。

问题是当你启动一个新的 shell（或 shell 脚本，或 make 命令）时，[Bash 不会自动转发来自调用环境的所有函数](https://unix.stackexchange.com/questions/63665/how-to-define-a-bash-function-that-can-be-used-by-different-scripts)。

明确指定 shell 应该`/bin/bash`确保 make 不会调用不同的 shell 解释器，这可能会影响函数处理。 [有几种方法可以做到这一点。](https://stackoverflow.com/a/589300/86967) 在下面的示例中，我使用了特定于目标的方法。

例如，下面的 makefile 片段调用[它被实现为 bash 函数的集合](https://github.com/nvm-sh/nvm/issues/806)。[`nvm`](https://github.com/nvm-sh/nvm)

*警告：使用先前定义的函数意味着 makefile 取决于您的 shell 环境的（可能不受控制的）状态，因此应该明智地使用这种类型的解决方案。*

* * *

## 方法 1：运行“交互式”shell

在此示例中，假定函数被定义为用户的 .bashrc 文件的一部分。在交互模式下运行 Bash（带有`-i`）会导致 .bashrc 被处理到命令环境中。

```
mytarget1: SHELL:=/bin/bash -i
mytarget1:
    nvm install 14 && npm version 
```

* * *

## 方法二：按需导入函数

这种方法显式地获取定义感兴趣函数的脚本。

```
mytarget2:
    . ~/.nvm/nvm.sh && nvm install 14 && npm version 
```

为此，您可能更喜欢： [makefile 中的多行 bash 命令](https://stackoverflow.com/questions/10121182/multi-line-bash-commands-in-makefile/29085684#29085684)

* * *

## 方法三：运行makefile前导出函数

调用`make`：`export -f nvm ; make mytarget3`将函数导出到任何子命令。

```
mytarget3: SHELL:=/bin/bash
mytarget3:
    nvm install 14 && npm version 
```

*注意：此示例无法完全运行，因为`nvm`在内部，它依赖于大量子函数，这些子函数也需要导出。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-03T09:11:26.890

假设 compile 是你 .bash_profile 中的一个函数

.bash_profile

```
compile(){
  ...
} 
```

生成文件

```
ACTIVE_ENV=source ~/.bash_profile 
default:
    $(ACTIVE_ENV) && compile boot_sect_simple.asm c 
```

# java - 变量名未解析

> ID：13109244
> 
> 赞同：0
> 
> 时间：2012-10-28T13:38:43.253
> 
> 标签：java

我正在关注斯坦福 Java 入门课程，并开始尝试运行他们在 Eclipse 中提供的一些示例，但遇到了问题。

当我将 rgen 的值分配给 dieRoll 时，它告诉我“无法解决 regn”。当我将 RandomGenerator 命名为“rgen”时，它表示“未使用 DiceRoll.regn 字段的值”

谁能告诉我为什么会发生这种情况，以及如何纠正它以便我可以运行它？！谢谢

```
import acm.program.*;
import acm.util.*;

public class DiceRoll extends ConsoleProgram {
public void run() {
    int dieRoll = rgen.nextInt(1,6);
    println("You rolled " + dieRoll);
}

/*Private instance variables */
private RandomGenerator regn =
        RandomGenerator.getInstance();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:40:38.323

您使用的是`rgen`not `regn`which 是您的变量名。

```
int dieRoll = rgen.nextInt(1,6);<---rgen not regn 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:48:28.270

声明的对象引用和您使用的引用不匹配。regn 和 rgen 不一样改变任何人......我希望它对你有用。

# file - wav、mp3 文件的比特流详细信息

> ID：13109247
> 
> 赞同：2
> 
> 时间：2012-10-28T13:38:59.760
> 
> 标签：file, multimedia, bitstream

我想知道 wav / mp3 文件中每个字节的含义。但是从谷歌中找到第 n 个......有人知道我在哪里可以找到这些信息吗？（事实上​​我想知道比特流级别的所有类型的多媒体文件）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:49:54.717

MP3 文件分为帧，每个帧都以一系列`FRAMESYNC`位开头，因此硬件可以找到每个帧的开头。更多[在这里](http://www.mp3-tech.org/programmer/frame_header.html)。

关于 WAV 的一些信息在[这里。](http://www-mmsp.ece.mcgill.ca/Documents/AudioFormats/WAVE/WAVE.html)

# haskell-platform - Haskell，我需要创建类似 ATM 功能的东西，在 .txt 文件中存储多个列表并检索记录

> ID：13109248
> 
> 赞同：1
> 
> 时间：2012-10-28T13:39:07.250
> 
> 标签：haskell-platform, haskell

我是haskell的新手，我需要这个程序的一些帮助。首先，我将三个帐户存储到一个 input.txt 中，因此文件内部会出现类似 ["1","steven","4000","12345"]["2","Marcus","5000" 的内容,"123456"]["3","Ivan","7000","12345"]账户内有ID、姓名、余额、密码3个变量。我想做的是：

1.  当用户输入密码时，程序会将列表中的密码与用户输入的密码进行比较，最后显示特定记录

2.  当用户想要将钱转移给另一个用户时。首先输入ID，第二个输入金额，最后第一个账户减少钱，第二个账户增加钱。

3.  我面临的问题是如何读取单个帐户以进行比较、提款和转账。有更好的方法吗？

谢谢

```
import System.IO  

i :: IO()
i = do
    putStrLn "your ID : " 
    id<-getLine
    putStrLn "your name : "
    name<-getLine
    putStrLn "balance : "
    bal<- getLine
    putStrLn "password : "
    pass<- getLine
    let store2 =  [id]++[name]++[bal]++[pass]
    appendFile "input.txt" (show store2)

huhu ::IO()
huhu = do
    putStrLn "ID : "
    id<-getLine
    putStrLn "Password : "
    pass<-getLine
    rec <- readFile "input.txt"
    if ("pass" == rec) then
        do
        putStrLn "show information"
    else
        do 
        putStrLn "Wrong password" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T17:11:20.290

我认为您应该直接研究结构合理的数据。首先，定义一些数据类型来帮助你解决问题。

```
type ID = Int
data Account = Account {idno::ID, 
                        name :: String, 
                        balance :: Int, 
                        password :: String} deriving (Read,Show) 
```

如果你愿意，你可以选择不同的类型。这使您可以定义函数，例如

```
sameID :: ID -> Account -> Bool
sameID anID account = idno account == anID 
```

注意数据标签`idno`也是一个方便的功能`Account -> ID`。我们应该使用一些样本数据进行测试：

```
sampleData = [Account 385634 "Fred" 234 "Iluvw1lm4",
              Account 405382 "Barney" (-23) "pebbles",
              Account 453464 "Wilma" 1432 "c4r3fu1n355 br33d5 pr0sp3r:ty"] 
```

我们可以使用它来测试功能（并推断 Barney 对密码安全或财务管理一无所知）。

现在您需要决定是`Data.Map`使用他们的 ID 还是列表来存储您的帐户。列表更容易从文件中读取，但地图更容易查找。所以要么这样做：

```
type Accounts = [Account] 
```

或使用地图：

```
import qualified Data.Map as Map  -- Put this at the top of the file if so.
type Accounts = Map.Map ID Account 
```

无论哪种方式，您都需要

```
findUserByID :: Accounts -> ID -> Maybe Account
findUserByID = undefined    -- you can work this out 
```

如果您使用的是地图，则需要找到它。要么浏览[文档](http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Strict.html)——无论如何都是一个好计划，要么使用[hoogle 搜索引擎](http://www.haskell.org/hoogle/)来找到它。如果您不确定，您可以 hoogle for `Map ID Account -> Maybe Account`，虽然它会警告您它不知道 ID 或 Account，但您需要的功能就在那里！你最好搜索一下，`Map id account -> Maybe account`这样它就知道它可以使用一般功能。

如果您正在使用列表，则需要`filter`在列表中添加一个函数，该函数在 ID 匹配时为您提供 true，否则为 false：`sameID`这会有所帮助。

你还需要

```
updateByID :: ID -> Account -> Accounts -> Accounts
updateByID anId newaccount = undefined   -- you can work this out too 
```

但更有用的是

```
updateUsingID :: Account -> Accounts -> Accounts
updateUsingID acc = updateByID (idno acc) acc 
```

如果您使用的是地图，那将很容易，但如果您使用的是列表，则需要使用`map`类似的功能

```
onlyChange :: Account -> (Account -> Account)
onlyChange newacc acc | idno acc == idno newacc = newacc
                      | otherwise = acc 
```

你可以定义

```
showAccount :: Account -> String
showAccount acc = undefined -- use the functions, eg  name acc ++ ....
                            -- or just use show 
```

和功能

```
changePassword :: String -> Account -> Account
changePassword newpwd acc = acc {password = newpwd} 
```

使用里面的想法`changePassword`和函数`balance`，你应该可以写

```
changeBalance :: (Int -> Int) -> Account -> Account
changeBalance = undefined   -- you try 
```

然后你可以写

```
pay :: Int -> Account -> Account -> (Account,Account)
pay amount fromAcc toAcc = undefined 
```

提示：使用`changeBalance (+ amount)`and `changeBalance (subtract amount)`。

最后你需要

```
updateTwoUsingID :: (Account,Account) -> Accounts -> Accounts
updateTwoUsingID (new1,new2) = updateUsingID new1 . updateUsingID new2 
```

我忍不住要告诉你那个，因为它是函数组合的一个很好的例子。

如果您发现很难使用这些`Maybe Account`东西，请忽略它直到最后，就像我们忽略文件 IO 直到最后一样。`fmap`使用和之类的函数`>>=`非常方便`Maybe`。查找它们，或者现在完全放弃 Maybe 并使用 hard `error`s。（例如`!`，在 Map 中给出错误而不是 Nothing。）也许比运行时错误更好，但也许你现在可以摆脱错误。

有一些粘合在一起要做，然后一些文件输入/输出要做。对于文件输入/输出，`read`在`show`您的`Accounts`.

您不必这样做 - 这只是一种方法。（好吧，两个，如果你把列表和地图算作两种方法。）玩得开心！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T14:09:26.760

确实，所有问题都归结为您的第三个问题。您正在寻找的是一种允许您将用户名*映射*到用户帐户的数据结构。我建议查看[`Data.Map`](http://www.haskell.org/ghc/docs/latest/html/libraries/containers/Data-Map.html)容器类型，看看如何使用它。

# javascript - Jquery 悬停在列表项上

> ID：13109249
> 
> 赞同：0
> 
> 时间：2012-10-28T13:39:14.800
> 
> 标签：javascript, jquery

在我的 html 代码中有列表项。我想在悬停相关列表项时显示和隐藏相关的收藏夹。但我无法关联最喜欢的 div 和它的列表项。

html:

```
<ul>    
<php? for(....): ?>                            
    <li>
        <div id="sin">
            some stuff 
        </div>
        <div id="son">
            some stuff
        </div>
        <div id="fav">
            something 
        </div>
        <br />
    </li>
<php? endfor; ?>
</ul> 
```

当鼠标悬停在`<li>`属于鼠标悬停列表项的标签“fav”div 上时，必须出现。

我未使用的 jquery 代码：

```
$(document).ready(function()
{          
    $("li").hover(function(){
        $("#fav").show()},
        function () {
        $("#fav").hide()
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:41:15.700

问题是您多次使用相同的 id。您需要使用`class="fav"`而不是`id="fav"`

//对于#sin和#son也是

```
$(document).ready(function()
{          
    $("li").hover(function(){
        $("#fav").show()},
        function () {
        $("#fav").hide()
    });
}); 
```

应该

```
$(document).ready(function()
{          
    $("li").hover(function(){
        $(this).find(".fav").show()},
        function () {
        $(this).find(".fav").hide()
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:44:52.063

在这里你有

```
$(document).ready(function()
{
    $('.fav').hide();
    $("li").hover(function(){
        $(".fav",$(this)).show()},
        function () {
        $(".fav",$(this)).hide()
    });
}); 
```

您需要使用上下文 with`$(".fav",$(this)).`而不是`$(".fav").`. 你也必须从`id`变成`class`喜欢

```
 <li>
                                <div class="sin">
                                    some stuff
                                </div>

                                <div class="son">
                                    some stuff
                                </div>

                                <div class="fav">
                                    something
                                </div>
                                <br />
                            </li> 
```

# sparql - SPARQL 查询大学

> ID：13109251
> 
> 赞同：3
> 
> 时间：2012-10-28T13:39:24.803
> 
> 标签：sparql

我正在尝试使用 SPARQL 获取大学的名称：

rdf 数据如下（还有更多，但这无关紧要）。

```
<Organization rdf:about="http://data.semanticweb.org/organization/the-university-of-queensland">
    <rdfs:label>The University of Queensland</rdfs:label>
    <homepage rdf:resource="http://www.uq.edu.au/"/>
    <member rdf:resource="http://data.semanticweb.org/person/jane-hunter"/>
    <member rdf:resource="http://data.semanticweb.org/person/kwok-cheung"/>
    <member rdf:resource="http://data.semanticweb.org/person/robert-m-colomb"/>
    <name>The University of Queensland</name>
</Organization> 
```

我写了一个查询数据的java程序。我查询数据的字符串如下：

```
 queryString += "PREFIX swrc:        <http://swrc.ontoware.org/ontology#> \n";
            queryString += "PREFIX dc:          <http://purl.org/dc/elements/1.1/> \n";
            queryString += "PREFIX foaf:        <http://xmlns.com/foaf/0.1/> \n";
            queryString += "PREFIX geo:         <http://www.w3.org/2003/01/geo/wgs84_pos#> \n";
            queryString += "PREFIX ical:        <http://www.w3.org/2002/12/cal/ical#> \n";
            queryString += "PREFIX rdf:         <http://www.w3.org/1999/02/22-rdf-syntax-ns#> \n";
            queryString += "PREFIX rdfs:        <http://www.w3.org/2000/01/rdf-schema#> \n";
            queryString += "PREFIX swc:         <http://data.semanticweb.org/ns/swc/ontology#> \n";
            queryString += "PREFIX swrc_ext:    <http://www.cs.vu.nl/~mcaklein/onto/swrc_ext/2005/05#> \n";
            queryString += "SELECT ?name WHERE {\n";
            queryString += "?university rdfs:label ?aff . \n ?university foaf:name ?name FILTER(str(?aff)='uni') }"; 
```

不幸的是，这是不正确的，因为没有返回结果：

```
<?xml version='1.0' encoding='UTF-8'?> 
  <sparql xmlns='w3.org/2005/sparql-results#'> 
    <head> 
     <variable name='name'/> 
    </head> 
    <results> 
    </results> 
  </sparql> 
```

谁能指出我正确的方向？

PS 如果可能的话，我只想获取 10 个大学名称。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T14:24:40.470

我了解您假设所有大学`"uni"`的名称中都有字符串。

请注意，您正在检查 value 是否与 string 相等`"uni"`。您的数据集中确实没有这样的实例。

替换`FILTER(str(?aff)='uni')`为`FILTER regex(?aff, "uni", "i")`将允许您匹配*包含*字符串`"uni`" 的值。这是一个接受三个参数的正则表达式过滤器。

1.  一个变量
2.  符合[此处描述的语法的正则表达式](http://www.w3.org/TR/xpath-functions/#regex-syntax)
3.  一组可选标志，在本例中，我使用了一个标志`"i"`. 这意味着匹配必须不区分大小写。

为了限制结果的数量，您只需将查询附加到`LIMIT`关键字即可。

结果查询应该是：

```
PREFIX swrc:        <http://swrc.ontoware.org/ontology#>
PREFIX dc:          <http://purl.org/dc/elements/1.1/>
PREFIX foaf:        <http://xmlns.com/foaf/0.1/>
PREFIX geo:         <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX ical:        <http://www.w3.org/2002/12/cal/ical#>
PREFIX rdf:         <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:        <http://www.w3.org/2000/01/rdf-schema#>
PREFIX swc:         <http://data.semanticweb.org/ns/swc/ontology#>
PREFIX swrc_ext:    <http://www.cs.vu.nl/~mcaklein/onto/swrc_ext/2005/05#>
SELECT ?name WHERE {
    ?university rdfs:label ?aff . 
    ?university foaf:name ?name 
    FILTER regex(?aff, "uni", "i")
} LIMIT 10; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-10-27T05:56:47.823

在您的 RDF 片段中没有“foaf:”命名空间。所以，也许你应该把你的RDF。当然，除非它是 RDF 文档中的默认名称空间。

# javascript - 从haml link_to调用javascript函数

> ID：13109252
> 
> 赞同：13
> 
> 时间：2012-10-28T13:39:24.450
> 
> 标签：javascript, onclick, haml, link-to

当 onclick 甚至从 haml 中的 link_to 标记触发时，我想调用一个 javascript 函数（没有 JQuery）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-28T13:51:44.533

以下是在 haml 中使用 Rails link_to 的方法：

```
= link_to "my link", "", :onclick => "my_function(); return false" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-28T13:52:21.360

我认为这可以工作：

```
link_to "your link", href, :onclick => "jsFunction" 
```

或者，在 JS 方面做所有事情：

```
document.body.addEventListener('click',function(e)
{
    var target = e.target || e.srcElement;
    if (target.tagName.toLowerCase() !== 'a')
    {
        return e;//not clicked on link
    }
    //a link was clicked, maybe check class or id or other stuff to narrow it down
    //if a link you were interested in was clicked:
    return theClickFunction.apply(target,[e]);
},false); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-08-13T21:58:55.580

纯 HAML 等同于 @edouardbriere 的答案：

```
%a{href: '#', onclick: 'my_function(); return false;'} my link 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-28T13:44:25.717

```
<a onclick="YOURMETHOD;"/>A link</a> 
```

如果您还想防止位置更改`return false`，请在方法调用后添加。

# c# - Windows 8 PointerEntered 用于放置在另一个元素下的元素

> ID：13109253
> 
> 赞同：0
> 
> 时间：2012-10-28T13:39:59.010
> 
> 标签：c#, wpf, visual-studio, events, xaml

我有一个图形应用程序。为了制作界面，我制作了自己的 UserControl 元素，并使用绝对定位将它们放在彼此之上。

例如我有这样的结构：

```
<Canvas>
        <local:UserControl1 Canvas.Left="50" Canvas.Top="50" PointerEntered="onPointerEntered"/>
        <local:UserControl2 Canvas.Left="50" Canvas.Top="50" PointerEntered="onPointerEntered"/>
</Canvas> 
```

UserControl2 具有透明背景，并且通过它可以看到 UserControl1。我正在尝试同时捕获 PointerEntered 事件：UserControl1 和 UserControl2。但是由于 UserControl2 被放置在 UserControl1 上，PointerEntered 仅针对 UserControl2 对象触发，但我需要为两者都捕获此事件。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T11:15:47.497

问题解决了。不完全是我想要的，但也适合我。我已经将 local:UserControl2 IsHitTestVisible 更改为 false 一段时间。

# linear-algebra - 3d 线上的矢量方向

> ID：13109256
> 
> 赞同：0
> 
> 时间：2012-10-28T13:40:21.333
> 
> 标签：linear-algebra

我有始终起源于 (0,0,0) 的 3d 线（单位方向矢量）和始终指向此 3d 线上的两个方向（负或正）之一的 3d 向量。问题是如何检查我的向量在哪一侧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:45:43.670

您的向量是单位方向向量乘以一些非零 scalar `a`。如果`a > 0`，则方向相同，否则方向相反。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T13:53:40.050

您的单位向量的形式为 (x,y,z)，而您的另一个向量的形式为 (a,b,c)。

现在找到任何不为零的分量 x,y,z 并测试 a,b,c 中的相应分量是否具有相同符号就足够了。如果是这样，它们就在同一边。

“点积”的运算会自动执行此操作：如果 (a*x + b*y + c*z) >0，则向量在同一侧。

# core-data - 是否可以在一个 iOS 应用程序上拥有多个核心数据“数据库”？

> ID：13109257
> 
> 赞同：3
> 
> 时间：2012-10-28T13:40:25.090
> 
> 标签：core-data, nsmanagedobject, multiple-databases, nsentitydescription

我想写一个大量利用核心数据的“管理”游戏。游戏需要用户/系统无法更改的预设、预定义数据集；它用于为游戏播种数据，并且是只读的。

我能举出的最好的例子是足球管理游戏，但它可以是任何东西。在一些足球管理模拟游戏中，它们为您提供场景和预设数据集。

随着用户进行游戏，他们可以保存/加载保存到核心数据中的进度。

除此之外，用户可以接收预定义数据的更新或购买场景数据包；保存到他们的设备中。

因此，可能有多个“核心数据数据库”（是的，我知道核心数据并不是严格意义上的数据库）或应用程序可以潜入和使用的“存储桶”。

数据的架构不会改变。

所以我们有：

1.  仅用于播种游戏的预定义数据（默认数据）。
2.  用户当前保存的游戏。
3.  用户从 Internet 下载了一个场景。
4.  问题：当用户在“场景”中保存游戏时会发生什么。
5.  问题：如何在核心数据中跟踪所有场景和所有用户保存的游戏？

这听起来像是在给定时间有多个数据库。显然，应该限制用户可以制作多少个存档游戏。

另一种解决方案是，用户的设备以 JSON 或 XML 格式导出数据的备份副本，并将其用作“保存数据”，我也可以将此策略用于场景。显然需要某种加密来防止人们通过 XML 简单地更改游戏中的统计数据。

但我从一开始就想知道使用 iOS 设备的核心数据处理超过 1 个核心数据“数据库”的最佳方式是什么？

谢谢你的时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T19:43:11.427

如果数据模型相同，您只需设置 MOC 以便它使用两个持久存储...一个是只读的，另一个是读/写的。

或者，您可以为每个商店使用单独的 MOC。

因此，您想如何使用它是您唯一的决定因素，因为您几乎可以拥有 MOC/PSC 的任何组合。

请查看[此处](https://developer.apple.com/library/content/documentation/DataManagement/Devpedia-CoreData/persistentStoreCoordinator.html)的文档以获取更多信息。

* * *

**编辑**：

这个问题给出的链接已经失效，其他人在另一个已删除的答案中建议[了这个链接。](https://developer.apple.com/library/content/documentation/DataManagement/Devpedia-CoreData/persistentStoreCoordinator.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-13T12:25:28.083

注意：这是一个老问题，但它描述的问题是永恒的，所以我写了答案，就好像问题是今天发布的一样。

实际上，这并不意味着需要多个数据库。所以我们有：

> 1) 仅用于播种游戏的预定义数据（默认数据）。

编写一个将数据加载到持久存储（数据库）中的方法。在用户默认、defaultDataHasBeenLoaded 或类似的东西中设置一个标志，并在 appDelegata 中检查它。

> 2) 用户当前保存的游戏。

您需要具有一对多关系的 Users 表和 Games 表。在 Games 表中添加 isCurrentGame 属性。

> 3) 用户从互联网上下载了一个场景。

现在它变得有趣了。您将需要一个导入函数或类，并且您需要在后台线程上运行它。这样，您的用户可以在导入新场景的同时继续玩游戏，或者查看他们的分数或其他内容。导入场景后，用户应该会收到通知并有机会切换到新场景。

最有效的方法是使用 NSPeristentContainer，它在 iOS 10.0、macOS 10.12、tvOS 10.0 和 watchOS 3.0 中可用。为 NSPeristentContainer 提供数据模型的名称，它将创建或加载持久存储并设置 persistentStoreCoördinator 和 managedObjectContext。

```
// AppDelegate.h or class header file
@property (readonly, strong, nonatomic) NSPersistentContainer *persistentContainer;
@property (readonly, weak, nonatomic) NSManagedObjectContext *managedObjectContext;

// AppDelegate.m or other implementation file
@synthesize persistentContainer = _ persistentContainer;
@synthesize managedObjectContext = _ managedObjectContext;

- (NSPersistentContainer *)persistentContainer
{
    @synchronized (self) {
        if (_persistentContainer == nil) {
            _persistentContainer = [[NSPersistentContainer alloc] initWithName:@"nameOfDataModel"];
            [_persistentContainer loadPersistentStoresWithCompletionHandler:^(NSPersistentStoreDescription *storeDescription, NSError *error) {
                if (error != nil) {
                    // Handle the error
                } else {
                    _managedObjectContext = _persistentContainer.viewContext; // NB new name for moc is viewContext!
                }
            }];
        }
    }
    return _persistentContainer;
} 
```

要在 NSViewController 中使用 appDelegate 中的容器，请将以下内容添加到 viewDidLoad：

```
self.representedObject = [(AppDelegate *)[[NSApplication sharedApplication] delegate] persistentContainer]; 

// Use representedObject in bindings, such as:
[_gameNameTextField bind:NSValueBinding toObject:self
                  withKeyPath:@"representedObject.game.name"
                      options:options]; 
```

要导入新场景，请使用 performBackgroundTask:，该块将自动创建一个新线程和一个新 managedObjectContext（这里称为 moc_background）。*仅对*您在块中执行的任何操作使用moc_background - 如果您在块外调用方法，请将其传递给 moc_background。

```
 NSPersistentContainer *pc = (NSPersistentContainer *)self.representedObject;
    pc.viewContext.automaticallyMergesChangesFromParent = YES; // this will ensure the main context will updated automatically

    __block id newScenario;
    [pc performBackgroundTask:^(NSManagedObjectContext * _Nonnull moc_background) {
        NSEntityDescription *scenarioDesc = [NSEntityDescription entityForName:@"Scenario" inManagedObjectContext:moc_background];
        NSManagedObject *scenario = [[NSManagedObject alloc] initWithEntity:scenarioDesc insertIntoManagedObjectContext:moc_background];
        // configure scenario with the data from newScenario

        NSError *error;
        BOOL saved = [moc_background save:&error];
        // send out a notification to let the rest of the app know whether the import was successfull
    }]; 
```

> 问题：当用户在“场景”中保存游戏时会发生什么。

这取决于谁先到达那里，尝试合并的后台线程或保存操作。如果将具有多对一关系的 Scenario 表添加到 Game 表中，应该不会有任何问题。

> 问题：如何在核心数据中跟踪所有场景和所有用户保存的游戏？

数据建模可能很棘手。一开始保持简单，当您发现明确需要时添加表格和关系。然后测试，测试，测试。

# model-view-controller - MVC 是为了什么而发明的？

> ID：13109263
> 
> 赞同：0
> 
> 时间：2012-10-28T13:41:21.583
> 
> 标签：model-view-controller, web-deployment

我是 Web 开发的新手，并且阅读了一些关于 MVC 的 wiki 和讨论。然而，我读得越多，我对它的设计目的就越感到困惑。

我只想知道为什么会发明这种设计模式？它是用来解决什么问题的？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T14:03:28.000

MVC 范式的目标本质上是确保代码分离的一种形式。开发代码时经常出现的问题是代码是连续编写的，其中每个部分都跟随另一个部分，并且每个部分都直接依赖于其他部分正在做什么。

在处理大型项目时，维护和进一步开发代码很快就会成为一个问题。因此，您可以以一种简化的方式争辩说，MVC 范式试图做的是确保您将业务逻辑（例如执行的代码）与表示逻辑（显示结果的代码）分开。但这两个部分需要相互通信，这是控制器负责的。

这允许清晰的代码结构，其中不同部分更加解耦，这意味着相互依赖更少。

分离还意味着您以更加模块化的方式工作，其中每个部分通过接口（一些用于调用其他部分的已定义函数和变量）与其他部分交互，因此您可以更改底层功能而无需只要您的界面保持不变，就可以更改代码的其他部分。

因此，它试图解决的问题是避免代码库如此纠缠，以至于您无法在不破坏代码的情况下更改或添加任何内容，这意味着您必须在制作原始代码之外的各种地方修改代码变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:22:05.030

在某种程度上，它是寻找问题的解决方案。

作为一个相当古老的程序员，我很清楚“关注点分离”的好处，但是（在我不那么谦虚的观点中）MVC 并没有很好地做到这一点，尤其是在实现“食谱”时尚时。很多时候，它只会导致模块的激增，每个功能都有三个独立的模块，没有共同的代码或共同的主题来将事物联系在一起并实现*真正的*目标：最小化复杂性并最大化可靠性/可维护性。

“经典”MVC 在典型的手机 GUI 应用程序中尤其不合适，例如，数据库表的管理可能与相应表视图的管理密切相关。将逻辑分布在三个不同的模块之间只会使事情变得更加复杂和难以维护。

通常最有效的是考虑您的数据并了解需要什么样的更新和查询，然后为数据库（或您使用的任何数据存储）构建一个“包装器”，以“抽象”它并最大限度地减少交互在数据库和系统的其余部分之间。但是计划这很*困难*，并且经常需要大量的试验和错误——绝对不是食谱。

类似地，您有时可以抽象其他领域，但是抽象，例如，GUI 界面通常太难而不值得——不要仅仅编写“包装器”来表示您已经做到了。

请记住，数据库、GUI 系统、应用程序流控制机制等的作者已经在抽象这些接口上付出了相当大的努力（有时太多），因此您进一步的“抽象”通常只不过是一层额外的调用（特别是如果您采用食谱方法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:48:39.927

创建模型视图控制器是为了在代码中分离关注点，而不是在单个 blob 中创建一个大杂烩。（意大利面条代码）视图代码只是表示逻辑，模型是代表您的域的对象，控制器处理协商业务逻辑和与后端服务的集成。

# iphone - 应用内购买问题！模拟器

> ID：13109265
> 
> 赞同：0
> 
> 时间：2012-10-28T13:41:43.170
> 
> 标签：iphone, ios, in-app-purchase

我的问题是：我在我的应用程序中设置了一个 iAP，当用户点击一个按钮时，它会问他“你想买这个吗”。但是，我在按钮上放置了一个图像和一个背景图像。我有这个代码实现，如果用户购买了该项目，按钮的图像，即一个锁定图标就会消失。它在模拟器上运行良好，但在设备上我可以购买该物品，但锁图标根本不出现。即使我还没有购买该商品，也没有锁定图标。如果没有购买该物品，则在模拟器上有一个锁定物品。我`BOOL`在我的 .h 文件中使用：`-(BOOL)IAPItemPurchased;`在 .m 文件中，我使用 IAPItemPurchased 隐藏前景图像，在我的`viewDidLoad`：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    if ([self IAPItemPurchased]) {
        [buy setImage:nil forState:UIControlStateNormal];

    } else {
        [buy setImage:[UIImage imageNamed:@"Lock.png"] forState:UIControlStateNormal];

    }
} 
```

有没有人建议或解决方案该怎么做？

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:01:36.050

请检查图像名称，因为在模拟器中图像名称不区分**大小写**，但设备**区分大小写**。

**（ 或者 ）**

```
- (void)viewDidLoad
 {
 [super viewDidLoad];

 if ([self IAPItemPurchased]) {
    [buy setImage:[UIImage imageNamed:nil] forState:UIControlStateNormal];

} else {
    [buy setImage:[UIImage imageNamed:@"Lock.png"] forState:UIControlStateNormal];

}} 
```

# delphi - 如何从 32 bpp 的 TBitmap 实例创建 alpha 混合图标/光标（间接），而无需制作临时 DIB 部分？

> ID：13109267
> 
> 赞同：5
> 
> 时间：2012-10-28T13:42:12.143
> 
> 标签：delphi, winapi, alpha, vcl

根据[MS KB entry](http://support.microsoft.com/kb/318876)，有一个怪癖，`CreateIconIndirect`其中识别`HBITMAP`s 是`BITMAPV5HEADER`通过传递到`CreateDIBSection`（和 BGRA 通道布局）创建的。

但是， 当由其s 引用时，`TBitmap`具有（表现为 alpha 混合用于其他目的）的实例不会被识别为用于创建图标或光标的有效 alpha 混合位图。`(PixelFormat = pf32bit) and (AlphaFormat = afDefined)``Handle`

目前，我必须使用描述的 API 调用（[请参阅](http://support.microsoft.com/kb/318876)）创建 TBitmap 的完整副本，以`CreateIconIndirect`接受位图句柄作为 alpha 混合。我该如何克服这种笨拙？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T19:59:20.947

这是一个例子：

```
procedure TForm1.Button1Click(Sender: TObject);
const
  crAlpha = TCursor(-25);
var
  Bmp: TBitmap;
  Px: PRGBQuad;
  X, Y: Integer;

  BmpMask: TBitmap;
  II: TIconInfo;
  AlphaCursor: HCURSOR;
begin
  Bmp := TBitmap.Create;
  Bmp.PixelFormat := pf32bit;
  Bmp.Canvas.Brush.Color := clWhite;
  Bmp.SetSize(32, 32);
  Bmp.Canvas.Font.Style := [fsBold];
  Bmp.Canvas.Font.Color := clRed;
  Bmp.Canvas.TextOut(1, 10, 'alpha');

  for Y := 0 to (Bmp.Height - 1) do
  begin
    Px := Bmp.ScanLine[Y];
    for X := 0 to (Bmp.Width - 1) do begin
      if DWORD(Px^) = DWORD(clWhite) then
        Px.rgbReserved := $00
      else
        Px.rgbReserved := $FF;
      Inc(Px);
    end;
  end;

  BmpMask := TBitmap.Create;
  BmpMask.SetSize(Bmp.Width, Bmp.Height);

  II.fIcon := False;
  II.xHotspot := 32;
  II.yHotspot := 32;
  II.hbmMask := BmpMask.Handle;
  II.hbmColor := Bmp.Handle;

  AlphaCursor := CreateIconIndirect(II);
  Win32Check(AlphaCursor <> 0);
  BmpMask.Free;
  Bmp.AlphaFormat := afDefined;  // AlphaBlend below, premultiply channels
  Canvas.Draw(0, 0, Bmp);        // test draw
  Bmp.Free;

  Screen.Cursors[crAlpha] := AlphaCursor;
  Cursor := crAlpha;

end; 
```

![示例图像](../Images/9469bff81b249dbf4ad297503cc58955.png)（顶部'alpha'是测试绘制，另一个是光标）

# c# - 多客户端服务器 - 客户端断开连接和异步错误后接收事件变得疯狂

> ID：13109270
> 
> 赞同：1
> 
> 时间：2012-10-28T13:42:51.300
> 
> 标签：c#, sockets, asynchronous, connection, client

编辑

40+ 的观点，只有一个能够提供帮助，这个问题不值得点赞吗？;)

/编辑

再次，我在 c# 中的套接字编程有一些问题。

我用自制控制台（richTextBox）设置了一个小服务器，它正在监听多个连接。

一切正常，除了如果我关闭一个连接的客户端，程序会给我一个异步错误，并且在控制台上它不断地从客户端写入一条空白消息（事件：ClientReceivedHandler）

所以任何人都可以帮我找到问题吗？

我的代码：

服务器 - Form1.cs：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;

namespace GameServer {
public partial class Form1 : Form {

    // ### MAIN
    public bool serverRunning = false;
    public int serverListenPort = 6666;

    static Listener l;

    public Form1() {
        InitializeComponent();

        l = new Listener( serverListenPort );
        l.SocketAccepted += new Listener.SocketAcceptedHandler( l_SocketAccepted );
    }

    void l_SocketAccepted( Socket e ) {
        Client client = new Client( e );
        client.Received += new Client.ClientReceivedHandler( client_Received );
        client.Disconnected += new Client.ClientDisconnectedHandler( client_Disconnected );

        Invoke( ( MethodInvoker )delegate {
            dataGridViewConnections.Rows.Add( client.ID, client.EndPoint.ToString() );
            consoleWrite( DateTime.Now + " - " + client.EndPoint + " connected to server.\n\n", Color.Lime );
        } );
    }

    void client_Received( Client sender, byte[] data ) {
        Invoke( ( MethodInvoker )delegate {
            consoleWrite( DateTime.Now + "-" + sender.EndPoint + " :\n" + Encoding.Default.GetString( data ) + "\n\n", Color.White );;
        } );
    }

    void client_Disconnected( Client sender ) {
        Invoke( ( MethodInvoker )delegate {
            for( int i = 0; i < dataGridViewConnections.Rows.Count; i++ ) {
                if( dataGridViewConnections.Rows[i].Cells[0].Value.ToString() == sender.ID.ToString() ) {
                    dataGridViewConnections.Rows.RemoveAt( i );
                    consoleWrite( DateTime.Now + " - " + sender.EndPoint + " disconnected from server.\n\n", Color.OrangeRed );
                    break;
                }
            }
        } );
    }

    private void checkBox1_Click(object sender, EventArgs e) {
        checkBox1.Enabled = false;
        if( !serverRunning ) {
            consoleWrite( DateTime.Now + " " + markerSystem + "start\n", Color.White );
            ServerStart();
            checkBox1.Text = "Stop";
        } else {
            consoleWrite( DateTime.Now + " " + markerSystem + "stop\n", Color.White );
            ServerStop();
            checkBox1.Text = "Start";
        }
        checkBox1.Enabled = true;
    }

    private void ServerStart() {
        if( !serverRunning ) {
            consoleWrite( "* Starting server . . .\n", Color.Orange );
            // Start Server
            l.Start();
            serverRunning = true;
            consoleWrite( "* Server started !\n", Color.Lime );
            consoleWrite("Listening on port " + serverListenPort + ".\n\n", Color.White );
        } else {
            consoleWrite( "* ERROR: Server already started !\n\n", Color.Red );
        }
    }

    private void ServerStop() {
        if( serverRunning ) {
            consoleWrite( "* Stopping server . . .\n", Color.Orange );
            // Stop Server
            l.Stop();
            serverRunning = false;
            consoleWrite( "* Server stopped !\n\n", Color.Lime );
        } else {
            consoleWrite( "* ERROR: Server already stopped !\n\n", Color.Red );
        }
    }

    private string markerSystem = "@System -> ";
    private string marker = "-> ";

    private void consoleWrite( string text, Color color ) {
        consoleText.SelectionStart = consoleText.Text.Length;
        consoleText.SelectionLength = 0;
        consoleText.SelectionColor = color;
        consoleText.AppendText( text );
    }
}
} 
```

服务器 - Listener.cs ：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;

namespace GameServer {
    class Listener {
        Socket s;

        public bool Listening {
            get;
            private set;
        }

        public int Port {
            get;
            private set;
        }

        public  Listener( int port ) {
            Port = port;
            s = new Socket( AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp );
        }

        public void Start() {
            if( Listening ) {
                return;
            }

            s.Bind( new IPEndPoint( 0, Port ) );
            s.Listen(0);

            s.BeginAccept( callback, null );
            Listening = true;
        }

        public void Stop() {
            if( !Listening ) {
                return;
            }

            s.Close();
            s.Dispose();
            s = new Socket( AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp );
        }

        void callback( IAsyncResult ar ) {
            try {
                Socket s = this.s.EndAccept( ar );

                if( SocketAccepted != null ) {
                    SocketAccepted( s );
                }

                this.s.BeginAccept( callback, null );
            } catch( Exception ex ) {
                MessageBox.Show( ex.Message );
            }
        }

        public delegate void SocketAcceptedHandler( Socket e );
        public event SocketAcceptedHandler SocketAccepted;
    }
} 
```

服务器-Client.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;

namespace GameServer {
    class Client {
        public string ID {
            get;
            private set;
        }

        public IPEndPoint EndPoint {
            get;
            private set;
        }

        Socket sck;

        public Client( Socket accepted ) {
            sck = accepted;
            ID = Guid.NewGuid().ToString();
            EndPoint = ( IPEndPoint )sck.RemoteEndPoint;
            sck.BeginReceive( new byte[] { 0 }, 0, 0, 0, callback, null );
        }

        void callback( IAsyncResult ar ) {
            try {
                sck.EndReceive( ar );

                byte[] buf = new byte[8192];
                int rec = sck.Receive( buf, buf.Length, 0 );

                if( rec < buf.Length ) {
                    Array.Resize<byte>( ref buf, rec );
                }

                if( Received != null ) {
                    Received( this, buf );
                }

                sck.BeginReceive( new byte[] { 0 }, 0, 0, 0, callback, null );
            } catch( Exception ex ) {
                MessageBox.Show( ex.Message );
                Close();

                if( Disconnected != null ) {
                    Disconnected( this );
                }
            }
        }

        public void Close() {
            sck.Close();
            sck.Dispose();
        }

        public delegate void ClientReceivedHandler( Client sender, byte[] data );
        public delegate void ClientDisconnectedHandler( Client sender );

        public event ClientReceivedHandler Received;
        public event ClientDisconnectedHandler Disconnected;
    }
} 
```

客户 - Form1.cs

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;

namespace GameClient {
    public partial class Form1:Form {
        Socket sck;

        public Form1() {
            InitializeComponent();

            sck = new Socket( AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp );
            sck.Connect( "127.0.0.1", 6666 );
        }

        private void button1_Click( object sender, EventArgs e ) {
            int s = sck.Send( Encoding.Default.GetBytes( textBox1.Text ) );

            if( s > 0 ) {
                textBox1.Text = "";
            }
        }

        private void button2_Click( object sender, EventArgs e ) {
            sck.Close();
            sck.Dispose();
        }
    }
} 
```

我真的很高兴能让这个服务器稳定，这样我就可以开始实现多人游戏服务器逻辑了：D

感谢所有可以帮助我的人。

PS 如果有人需要查看实际问题，我可以上传 VS 项目文件或服务器和客户端的 .exe 文件。

**更新 ：**

第一个问题（异步错误）出现在 try-catch 的 Listener.cs 文件中。catch 部分中的消息框给出了以下文本：

“IAsyncResult 对象未从相应的异步方法返回。参数：asyncResult”

这在调用“ServerStop()”方法时出现。

第二个问题是 SERVER-Form1.cs 中的 client_Received() 方法中的任何地方。

好像是不断收到空白数据，所以在console/richTextBox输出空白信息

我不熟悉 c# 中的套接字逻辑，所以我无法弄清楚代码中发生位置错误的位置。

希望有人找到它。

**编辑 ：**

zip 文件中的项目文件 [http://ace-acid.no-ip.org/GameServer/](http://ace-acid.no-ip.org/GameServer/)

（C）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T19:27:37.907

> 第一个问题（异步错误）出现在 try-catch 的 Listener.cs 文件中。catch 部分中的消息框给出了以下文本：
> 
> > “IAsyncResult 对象未从相应的异步方法返回。参数：asyncResult”

在**Listener.cs - GameServer**中，可以安全地忽略此错误。我相信忽略错误不会在启动/停止套接字期间引起问题。问题是您忘记`Listening = false;`在末尾添加，`Stop()`以便应用程序可以`Start()`再次调用以启动套接字。否则，如果停止，套接字将永远不会启动。

**例子**

```
public void Stop()
{
     if (!Listening)
     {
          return;
     }

     s.Close();
     s = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
     Listening = false; //Set Listening to False to start the socket again
} 
```

虽然设置`Listening = false;`将解决重新启动套接字，但它不会阻止您获得上面提到的异常，因为该异常不依赖于`Listening`.

我已经尝试修复此问题，但它总是告诉我无法访问已处置的对象`s(socket)`，因此我认为异常是基于这一行的`s = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);`。

无论如何都可以安全地忽略异常，我已经忽略了它并且它工作得很好。要忽略它，只需创建一个`try/catch`获取异常的块，如果包含异常消息`asyncResult`，则忽略弹出一个带有异常的框。

**例子**

```
void callback(IAsyncResult ar)
{

      try
      {

           Socket s = this.s.EndAccept(ar);
           if (SocketAccepted != null)
           {
                SocketAccepted(s);
           }
           this.s.BeginAccept(callback, null);
      }
      catch (Exception ex)
      {
           if (!ex.Message.Contains("asyncResult")) //Proceed only if the exception does not contain asyncResult
           {
                MessageBox.Show(ex.Message);
           }
      }
} 
```

> 好像是不断收到空白数据，所以在console/richTextBox输出空白信息

是的，因为有连接，它总是会收到空白数据。您可以在以下屏幕截图中看到这一点

![从 Picrofo 控制台发送的空白数据](../Images/194eef336000329f01184f5ba6848bd1.png)

要解决这个问题，您首先需要检查使用`Encoding`from 的返回字符串`byte[] data`是否为空。然后，您可以在控制台/richtextbox 中写一个新行

**例子**

^(在**Form1.cs - GameServer**)

替换`client_Received(Client sender, byte[] data)`为以下代码

```
void client_Received(Client sender, byte[] data)
{
     if (Encoding.Default.GetString(data) != "") //Proceed only if data is not blank
     {
          Invoke((MethodInvoker)delegate
          {
               consoleWrite(DateTime.Now + "-" + sender.EndPoint + " :\n" + Encoding.Default.GetString(data) + "\n\n", Color.White); ;
            });
          }
     }
} 
```

应用修复后，这是输出

![没有更多的空白数据！](../Images/77a9e4ecdff875fde29d6a9df154f02e.png)

还有一个您可能忘记提及的问题，在`Connections`选项卡下，即使服务器断开连接，列表也永远不会清除。调用时只需调用`dataGridViewConnections.Rows.Clear();`即可清除连接列表`ServerStop()`。

**例子**

^(**在 Form1.cs - GameServer**)

替换`ServerStop()`为以下代码

```
private void ServerStop()
{
     if (serverRunning)
     {
          consoleWrite("* Stopping server . . .\n", Color.Orange);
          l.Stop();
          serverRunning = false;
          consoleWrite("* Server stopped !\n\n", Color.Lime);
          dataGridViewConnections.Rows.Clear(); // Clear connections

     }
     else
     {
          consoleWrite("* ERROR: Server already stopped !\n\n", Color.Red);
     }
 } 
```

目前我只能检测到这些，如果我发现任何相关信息，我会及时通知您。

[或者，您可以在此处](https://gist.github.com/3969589)找到属于该命名空间的项目文件`GameServer`

谢谢，
我希望你觉得这有帮助:)

# visual-studio-2010 - 如何将 100 多个 Visual Studio 安装程序项目 (vdproj) 转换为 Wix 安装程序？

> ID：13109272
> 
> 赞同：5
> 
> 时间：2012-10-28T13:42:51.927
> 
> 标签：visual-studio-2010, wix, visual-studio-2012, migrate, vdproj

我们有大约 100 多个 Visual Studio C# / .net 解决方案，其中包含一个用于部署的 Visual Studio 安装程序项目 (vdproj)。这些是在 Visual Studio 2010 中构建的。

为了升级到 Visual Studio 2012，我们需要将这些 .vdproj 项目迁移到 Wix，因为 vs2012 不再支持这些项目类型。

这些项目大多是简单的项目，它们将文件安装到给定的位置。我们在设置过程中使用自定义操作，使 .config 文件位置特定（用实际值替换标签）。

将这些项目转换为 Wix 的最佳方法是什么（每个项目的工作量最少）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:25:43.050

我会在这里发表我的反应。因为更好的格式和我喜欢解释的一些事情。

在您对您的评论的回复中。答案还包含有人使用 powershell 制作的脚本。您可以做的是创建另一个 powershell，它将遍历您的项目，然后执行脚本。但是你将只有 wxs 文件，你仍然需要创建 100 多个 wix 项目并将文件添加到该项目中。

您还可以使用 heat.exe 在要安装的项目中创建构建后事件。例如（可能需要对您的项目进行一些调整/更改）

`call "C:\Program Files (x86)\WiX Toolset v3.6\bin\heat.exe" project "$(ProjectDir)$(ProjectFileName)" -directoryid INSTALLDIR -pog Content -gg -scom -sreg -sfrag -out "$(SolutionDir)Installed\$(ProjectName).Content.wxs"`

然后您可以将输出文件链接到 WiX 项目，这样当您添加文件或 dll 时，它将再次自动生成，并且您的文件将保持同步。您现在需要做的就是创建某种可以在所有 wix 项目中使用的 product.wxs 模板。

我认为这里的解决方案是结合使用 PowerShell 和 heat.exe。您可以使用上述命令为您的项目生成 wxs 文件。但是您仍然需要手动添加 wix-projects。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-18T22:00:16.650

您应该首先获取 WiX 书（约 500 页），并仔细阅读。其次，你应该自己试验一下。第三，您应该手动将它们转换为 WiX。

不要使用转换器，它们毫无用处，因为它们会产生垃圾，特别是如果你已经有了相当简单的安装程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-11T06:19:20.750

您是否与 Wix 紧密相关？

也许您可以切换到免费（开源）系统的 NSIS 或 Inno Setup。

有用于使用 NSIS/Inno Setup 的 Visual Studio 扩展，它可以处理 VS Setup 项目 (.vdproj) 并将它们转换 - [http://visualstudiogallery.msdn.microsoft.com/5e57fe9a-ae5d-4740-a1c3-7a8e278e105b](http://visualstudiogallery.msdn.microsoft.com/5e57fe9a-ae5d-4740-a1c3-7a8e278e105b)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-18T21:50:32.493

我建议看一下 Wix#。 [http://www.codeproject.com/Articles/31407/Wix-WixSharp-managed-interface-for-WiX](http://www.codeproject.com/Articles/31407/Wix-WixSharp-managed-interface-for-WiX)。

对于需要创建 Windows Installer MSI 来部署他们的应用程序的 C# 开发人员，Wix# 可能是 Microsoft 从 VS2012 开始从 Visual Studio 中删除的“打包和部署”项目类型的最佳替代品。Wix 是 WiX 工具集的 C# 前端，允许使用 C# 语言构建完整的 Windows Installer MSI。

您特别提到您的所有安装程序都是简单的项目，它们将文件安装到给定位置，在安装期间使用自定义操作，以使 .config 文件位置特定（用实际值替换标签）。

假设您的项目确实如您所指出的那样高度相似，Wix# 将非常适合这种类型的要求。您将在 C# 中为一个典型程序开发一个好的 Wix# 示例，然后为您要替换的每个附加 .vdproj 安装程序克隆 100 次（或多次）。更好的是，如果您有一个擅长 T4 模板的团队成员，您可以使用它来自动化将您的第一个 C# Wix# 原型安装程序转换为模板的过程，然后使用该模板自动生成剩下的 99 个 .cs Wix# 代码文件用于其余项目。

下面是您请求的 Wix# 安装程序类型的 C# 代码示例。这假设您已经编写了一个名为“TailorMyConfig.exe”的实用程序，例如，一个使用 ConfigurationManager.AppSettings 例程的简单 C# 程序，并且您正在将这个 exe 与您的应用程序一起部署。

```
using System;
using System.Windows.Forms;
using System.Diagnostics;
using Microsoft.Deployment.WindowsInstaller;
using WixSharp;

class Script
{
    static public void Main(string[] args)
    {
        var project = new Project("MyProduct",
                          new Dir(@"%ProgramFiles%\My Company\My Product",
                              new File(@"Files\Bin\MyApp.exe"),
                              new File(@"Files\Bin\TailorMyConfig.exe")),
                          new ManagedAction("UpdateConfigFile"));

        project.Id = new Guid("6f330b47-2577-43ad-9095-1861ba25889b");

        Compiler.BuildMsi(project);
    }
}

public class MyCustomAction
{
    [CustomAction]
    public static ActionResult UpdateConfigFile(Session session)
    {
        if (DialogResult.Yes == MessageBox.Show("Config file update ready to run.\n Update config file(s) now?", 
                                                "Config Tailoring Utility",
                                                MessageBoxButtons.YesNo))
        {
            Process.Start("TailorMyConfig.exe", "Run utility to tailor config file to current system");
        }
        return ActionResult.Success;
    }
} 
```

请注意，有一些“更好”的方法可以使用 WiX 功能修改配置文件。为简单起见，上面的示例假定使用自定义编写的 C# exe 实用程序来修改配置文件。我建议改用 WiX XML 功能来执行此操作。您可以使用“XML 注入”的 Wix# 技术将几乎所有 WiX XML 功能直接合并到您的 Wix# 设置中。

请记住，Wix# 只是一个发出 WiX XML 语法的 C# 前端。在 Wix# 发出 WiX XML（wxs 文件）之后，可以轻松地对该 wxs 文件进行后处理以插入其他 WiX XML 功能。然后生成的 wxs 文件由 WiX 工具集编译成 MSI。

有关使用 XML 注入将 WiX XML 功能合并到 Wix# (C#) 安装中的示例，请查看此处[在 Wix# 中，当仅部署注册表项时，如何避免在目标系统上创建物理文件夹？](https://stackoverflow.com/questions/26558933/in-wix-how-to-avoid-creating-a-physical-folder-on-the-target-system-when-depl/26600575#26600575) 在那个问题中，请参阅我的答案，该答案使用将委托连接到“WixSourceGenerated”事件的技术。

然后，您可以使用这种 XML 注入方法将一些 WiX XML 插入到您的安装程序中，从而完成配置文件的编辑。修改配置文件的一些典型 WiX XML 示例如下： [如何在安装期间修改 .NET 配置文件？](https://stackoverflow.com/questions/289773/how-to-modify-net-config-files-during-installation)

我意识到这是一个较老的问题，但它出现在我的搜索中，所以我想让其他搜索者知道这个额外的 Wix# 选项。Wix# 方法在我的环境中非常有用，它允许使用熟悉的 C# 技能集，而无需一头扎进 WiX XML 安装程序技术的全部复杂性。

# python - Python递归排列

> ID：13109274
> 
> 赞同：14
> 
> 时间：2012-10-28T13:43:18.693
> 
> 标签：python, recursion, permutation

我在尝试使用递归制作排列代码时遇到了麻烦。这假设将一个列表返回给使用，其中包含每个字母的所有可能位置。所以对于这个词`cat`，它应该是 return `['cat','act',atc,'cta','tca','tac']`。到目前为止我有这个

```
def permutations(s):
    lst=[]
    if len(s) == 1 or len(s) == 0 :
        # Return a list containing the string, not the string
        return [s]
    # Call permutations to get the permutations that don't include the
    # first character of s
    plst = permutations(s[1:])
    print(plst)
    for item in plst:
        print (item)
        plst= permutations(s[1+1:])

         # Now move through each possible position of the first character
        # and create a new string that puts that character into the strings
        # in plst
        for i in range(len(s)):
            pass
            # Create a new string out of item
            # and put it into lst
        # Modify
    for item in lst:
        print(index) 
```

那里有步骤，但我不确定如何使用它们

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-28T13:59:00.047

你想做递归，所以你首先必须找出递归是如何工作的。在这种情况下，它是以下内容：

```
permutation [a,b,c,...] = [a + permutation[b,c,...], b + permutation[a,c,..], ...] 
```

作为最终条件：

```
permutation [a] = [a] 
```

因此，递归将列表拆分为子列表，每次提取一个元素。然后将此元素添加到子列表的每个排列的前面。

所以在伪代码中：

```
def permutation(s):
   if len(s) == 1:
     return [s]

   perm_list = [] # resulting list
   for a in s:
     remaining_elements = [x for x in s if x != a]
     z = permutation(remaining_elements) # permutations of sublist

     for t in z:
       perm_list.append([a] + t)

   return perm_list 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-06-13T21:09:47.077

递归地，考虑基本情况并根据这种直觉进行构建。

1）当只有一个字符'c'时会发生什么？该元素只有一个排列，因此我们返回一个仅包含该元素的列表。

2）给定最后一个排列，我们如何生成下一个排列？在前一个排列“c”中的所有可能位置添加一个附加字母“a”给我们“ca”，“ac”。

3）我们可以通过在每个早期排列的所有可能位置添加一个附加字符来继续构建越来越大的排列。

如果字符串包含一个或更少字符，则以下代码返回一个包含一个字符的列表。否则，对于不包括字符串 s[-1] 中最后一个字符的所有排列，我们为每个可以包含该字符的位置生成一个新字符串，并将新字符串附加到我们当前的排列列表中。

```
def permutations(s):
    if len(s) <= 1:
        return [s]
    else:
        perms = []
        for e in permutations(s[:-1]):
            for i in xrange(len(e)+1):
                perms.append(e[:i] + s[-1] + e[i:])
        return perms 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-08T14:54:19.183

When you're lost in recursive function, you should draw the call tree. The following version (inspired @Ben answer) keep the input order (if the input is in lexicographic order, the list of permutations will be, `'012' -> ['012', '021', '102', '120', '201', '210']`.

```
def permut2(mystr):
    if len(mystr) <= 1:
        return [mystr]
    res = []
    for elt in mystr:
        permutations = permut2(mystr.replace(elt, ""))
        for permutation in permutations:
            res.append(elt + permutation)
    return res 
```

The following version works for strings and lists, notice the reconstruction step is not the same:

```
def permut(array):
    if len(array) == 1:
        return [array]
    res = []
    for permutation in permut(array[1:]):
        for i in range(len(array)):
            res.append(permutation[:i] + array[0:1] + permutation[i:])
    return res 
```

As an exercice, you should draw call tree of the these functions, do you notice something ?

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-03-15T16:52:50.577

您可以使用在列表中迭代索引的函数，并生成一个列表，该列表由索引处的值和其余列表值的排列组成。下面是一个使用 Python 3.5+ 特性的示例：

```
def permutations(s):
    if not s:
        yield []
    yield from ([s[i], *p] for i in range(len(s)) for p in permutations(s[:i] + s[i + 1:])) 
```

这样`list(permutations('abc'))`返回：

```
[['a', 'b', 'c'],
 ['a', 'c', 'b'],
 ['b', 'a', 'c'],
 ['b', 'c', 'a'],
 ['c', 'a', 'b'],
 ['c', 'b', 'a']] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-09-11T01:12:09.093

我知道这也是一个我，但我认为这对某些人来说可能更容易理解......

1.  基本情况是输入只有一个字符。
2.  设置一个循环遍历字符串中的每个字母。
3.  另一个 for 循环递归地排列所有其他可能性。

    ```
    def permute(s):

        out = []

        if len(s) == 1:
            out = [s]
        else:
            for i,let in enumerate(s):
                for perm in permute(s[:i]+s[i+1:]):
                    out += [let+perm]
        return out 
    ```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-30T17:46:55.720

这是我想出的最简单的解决方案。

```
 def permutations(_string):
        # stores all generated permutations
        permutations = []

        # this function will do recursion
        def step(done, remain):
            # done is the part we consider "permutated"
            # remain is the set of characters we will use

            # if there is nothing left we can appened generated string
            if remain == '':
                permutations.append(done)
            else:

                # we iterate over the remaining part and indexing each character
                for i, char in enumerate(remain):
                    # we dont want to repeat occurance of any character so pick the remaining
                    # part minus the currect character we use in the loop
                    rest = remain[:i] + remain[i + 1:]
                    # use recursion, add the currect character to done part and mark rest as remaining
                    step(done + char, rest)
        step("", _string)
        return permutations 
```

您可以使用以下方法对其进行测试：

```
@pytest.mark.parametrize('_string,perms', (
    ("a", ["a"]),
    ("ab", ["ab", "ba"]),
    ("abc", ["abc", "acb", "cba", "cab", "bac", "bca"]),
    ("cbd", ["cbd", "cdb", "bcd", "bdc", "dcb", "dbc"])
))
def test_string_permutations(_string, perms):
    assert set(permutations(_string)) == set(perms) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-10-16T14:04:14.483

```
def permutations(string_input, array, fixed_value=""):
    for ch in string_input:
        permutations(string_input.replace(ch, ""), array, fixed_value + ch)
    if not string_input:
        array.append(fixed_value) 
```

你可以通过调用它

```
array = []
permutations("cat", array)
print array 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-15T08:45:40.077

通过递归进行排列的最简单方法是首先为问题想象一个递归树

[![在此处输入图像描述](../Images/d66cdaa5582642962c9efc61a2258f7c.png)](https://i.stack.imgur.com/sqdTL.png)

基本情况：如果给定一个空列表排列将是 [ [] ] 然后我们只想从列表中删除一个项目并将其添加到列表其余部分的所有索引中。

> ```
> eg input : [a,b,c]
> first = a
> rest = [b,c]
> all = [a,b,c] , [b,a,c] , [b,c,a] 
> ```
> 
> Time: O(N!) #这是最好的，因为我们正在创建 N！element
> Space O(N^2) #N 栈帧 * per_with_all 中的 N 项

来源： [https ://www.youtube.com/watch?v=us0cYQXQpxg](https://www.youtube.com/watch?v=us0cYQXQpxg)

```
def permetutation(arr):
    if len(arr) == 0:
        return [ [] ]
    #We remove 1st item from error as at each level we introduce 1 item 
    first_elenment = arr.pop(0)

    #getting permet for all other item 
    perm_without_first = permetutation(arr)

    per_with_all = []

    #Add permtution to every index 
    for comb in perm_without_first:
        for ind in range(len(comb)+1): #We also wan to add elenment to last so do +1 
            all = comb[0:ind] + [first_elenment] + comb[ind:] 
            per_with_all.append( all)

    return per_with_all 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-29T07:00:03.297

```
def permute(s):
    ch = list(s)
    if len(ch) == 2:
        per = ch[1] + ch[0] 
        return [''.join(ch)] + [per]
    if len(ch) < 2:
        return ch
    else:
        return [ init+per for init in ch for per in permute(''.join(ch).replace(init,""))] 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-12T03:46:47.997

[这些示例代码确实很有帮助，但是当我在CodeSignal](https://app.codesignal.com/)上进行代码练习时，我发现一个测试用例失败了。基本上这里所有给定的方法都忽略了是否有任何重复。

```
Input: s: "ABA" 
Output: ["ABA", "AAB", "BAA", "BAA", "AAB", "ABA"] 
Expected Output: ["AAB", "ABA", "BAA"] 
```

因此，如果您看到，它在输出中有以下重复项：

```
["BAA", "AAB", "ABA"] 
```

我在这里一点一点地修改了这个

```
def stringPermutations(s):
        news = s
        if len(news) == 1:
            return [news]
        res = []
        for permutation in stringPermutations(news[1:]):
            for i in range(len(news)):
                res.append(permutation[:i] + news[0:1] + permutation[i:])
        # To Remove Duplicates From a Python List: list(dict.fromkeys(res))
        # To Sort List : sorted()
        return sorted(list(dict.fromkeys(res)))

def main():
    arr = 'ABA'
    print(stringPermutations(arr))

if __name__ == '__main__':
    main() 
```

但是根据时间复杂度，这个答案是不合适的。这种方法的时间复杂度是：o(n^2)

我认为下面的方法是相当合理的。

```
def stringPermutations(string, prefix, permutation_list):
    #Edge case check
    if len(string) == 0:
        permutation_list.append(prefix)
    else:
        for i in range(len(string)):
            rem = string[0:i] + string[i + 1:]
            stringPermutations(rem, prefix + string[i], permutation_list)
    return sorted(list(dict.fromkeys(permutation_list)))
def main():
    permutation_list = []
    print(stringPermutations('aba','', permutation_list))

if __name__ == '__main__':
    main() 
```

# java - 等待 Java 按键

> ID：13109275
> 
> 赞同：0
> 
> 时间：2012-10-28T13:43:37.320
> 
> 标签：java

我希望编写的应用程序非常大，但需要作为服务运行。我计划使用 FireDaemon 对其进行转换并将其作为服务运行，但在按下特定键之前需要让它什么都不做。

我尝试使用`DataInputStream`一个 do/while 循环来等待按键，如下所示：

```
do {
   char keyPressed = input.readChar();
} while (keyPushed != null);

System.out.println("You pushed: " + keyPushed); 
```

关于这个简单主题的信息并不多，我觉得这很奇怪。在 Basic 中，我们曾经使用 inkey$ 来等待一个键，Java 必须有类似的东西，但我就是不能把我的手指放在它上面。

你能帮忙的话，我会很高兴。

谢谢。宾夕法尼亚州鲍勃格兰特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:54:54.673

怎么样：

```
if (System.in.available() > 0)
    System.in.read(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:57:20.333

如果我正确阅读了您的问题，您希望您的应用程序在 Windows 操作系统的后台运行，直到输入特定的组合键 - 例如热键。您将无法仅在 Java 中执行此操作，sdk 不提供这样的接口。您将需要用 C 编写一个帮助应用程序并使用 JNI 作为桥梁。

这篇文章应该对你有所帮助 - [Windows OS 下 Java 应用程序的全局热键](http://biletnikov-dev.blogspot.com/2009/09/global-hotkeys-for-java-applications_25.html)

# html - 如何创建一个站点，其中的菜单和类别为每个页面和类别折叠并加粗？

> ID：13109276
> 
> 赞同：-6
> 
> 时间：2012-10-28T13:43:41.287
> 
> 标签：html, css, menu, categories

这可能是一个基本问题，但我已经在网上搜索了一个小时，包括 stackoverflow。我已经创建了布局，左侧的菜单包含 3 个主要类别。我想创建一个站点，其中这些类别链接到该类别的页面，其中子类别位于左侧菜单上的父类别下方。

我在 Dreamweaver 中使用 HTML 和 CSS，最终站点将列出和展示使用 PHP 和 MySQL 的产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:00:18.550

您可以自己编写所有代码，这对于学习如何开发 Web 应用程序非常有用。在这种情况下，您可能需要查看 jQuery 网站并使用对您的情况有用的 jQuery 插件，例如[menuTree](http://archive.plugins.jquery.com/project/menuTree)。请参阅示例：

[http://menutree.pixelhandler.com/jQuery-MenuTree-Plugin/example/](http://menutree.pixelhandler.com/jQuery-MenuTree-Plugin/example/)

但是我认为如果你想部署一个专业的网站，你应该使用像 Drupal、Joomla 甚至是 Wordpress 这样的 CMS；使用这些工具，您可以非常轻松地完成任务。

# objective-c - 键盘关闭和 UITableView 触摸问题

> ID：13109282
> 
> 赞同：0
> 
> 时间：2012-10-28T13:44:57.990
> 
> 标签：objective-c, ios, uigesturerecognizer, uitouch

所以我有这个`UITableView`包含几行，当点击一行时，另一个`UIViewController`被推送特定行的详细信息。我的问题是我想通过屏幕上的任何触摸（也在`UITableView`）上关闭键盘，但是当我这样做并单击`UITableView`行时，键盘会关闭，但该`didSelectRow`方法不起作用。`ViewController`一旦单击单元格，它就不会推送新的。

同样反过来，一旦我更改它，您可以单击 TableView 单元格，键盘关闭并且另一个 ViewController 被推送，但是任何其他地方的触摸都不会关闭键盘。

我该怎么办？

```
- (IBAction)hideKeyboard:(id)sender
{
    [tfFoodsSearchQuery resignFirstResponder];
}

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {

    if ([touch.view isKindOfClass:[UITableView class]])
    {
        // we touched a button, slider, or other UIControl
        return YES; // handle the touch
    }
    NSLog(@"Touch");
    return NO; // ignore the touch
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc]
                                   initWithTarget:self
                                   action:@selector(hideKeyboard:)];

    [self.view addGestureRecognizer:tap];

    UITapGestureRecognizer *gestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard:)];
    gestureRecognizer.delegate = self;
    [self.tvFoods addGestureRecognizer:gestureRecognizer];
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:30:11.467

放

```
[gestureRecognizer setCancelsTouchesInView:NO]; 
```

而不是将其添加到 tvFoods，而是添加到整个 self.view，因此它不会影响覆盖的定义。

另外，删除 shouldReceiveTouch 委托，没有必要

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-21T02:47:39.390

使用 whiteagle 的提示，我使用以下代码捕获单击以关闭 UITableView 中的键盘。它通过水龙头，仍然允许选择一行。在我的情况下，通过的点击会触发显示内联日期选择器。

```
 -(void)viewDidLoad {
    UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard)];
    [singleTap setNumberOfTapsRequired:1];
    [singleTap setNumberOfTouchesRequired:1];
    [singleTap setCancelsTouchesInView:NO];
    [self.view addGestureRecognizer:singleTap];
    singleTap = nil;
  }

  // 
   -(IBAction)hideKeyboard {
    [activeTextField resignFirstResponder];
  } 
```

# c# - EF Code First：如何使用 fluent api 修复关系

> ID：13109284
> 
> 赞同：0
> 
> 时间：2012-10-28T13:45:23.263
> 
> 标签：c#, .net, entity-framework, ef-code-first

我有一个用 Enitity Framework 描述的简单数据模型，但仍然无法解决我的模型中的关系问题。我尝试了一些使用 Fluent API 的方法，但总是遇到非描述性异常。

这是一个代码：

```
public abstract class Entity
{
    [Key, Column(Order = 1)]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Int32 Id { get; set; }
}

public class Language : Entity
{
    [Key, Column(Order = 2)]
    public String Verbal { get; set; }

    public virtual ICollection<PostContent> Contents { get; set; }
}

public class Post : Entity
{
    public virtual ICollection<PostContent> Contents { get; set; }
}

public class PostContent
{
    [Key, Column(Order = 1)]
    public Int32 PostId { get; set; }

    [Key, Column(Order = 2)]
    public Int32 LanguageId { get; set; }

    [ForeignKey("PostId")]
    public virtual Post Post { get; set; }

    [ForeignKey("LanguageId")]
    public virtual Language Language { get; set; }

    public String Content { get; set; }
}

public class BlogContext : DbContext
{
    public DbSet<Language> Languages { get; set; }
    public DbSet<Post> Posts { get; set; }
    public DbSet<PostContent> PostContents { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
    }
}

public class BlogContextInitializer : DropCreateDatabaseIfModelChanges<BlogContext>
{
    protected override void Seed(BlogContext context)
    {
        //For test
        context.Languages.Add(new Language { Verbal = "Italian" });
        context.Languages.Add(new Language { Verbal = "English" });
        context.SaveChanges();
    }
}

class Program
{
    static void Main(string[] args)
    {
        Database.SetInitializer<BlogContext>(new BlogContextInitializer());

        using (BlogContext blogContext = new BlogContext())
        {
            //init on call.
            var langs = blogContext.Set<Language>().AsEnumerable();
            foreach (var lang in langs)
            {
                Console.WriteLine("Language Id: {0}, Verbal: {1}", lang.Id, lang.Verbal);
            }
        }
    }
} 
```

我有：

> “关系约束中的从属角色和主要角色中的属性数量必须相同。”

所以我正在寻找这个问题的解决方案。

# java - 需要帮助来纠正我的挥杆应用程序输出

> ID：13109287
> 
> 赞同：-1
> 
> 时间：2012-10-28T13:45:44.390
> 
> 标签：java, swing, event-handling, graphics2d

我正在尝试制作一个通常演示 src_in AlphaComposite 的应用程序。我需要的输出是：-

![在此处输入图像描述](../Images/b72c587c5cf06d29bb7d0595f5984f52.png)

但我得到以下输出： - ![在此处输入图像描述](../Images/6cc44143009256c623824fbb24d0da28.png)

我在哪里做错了？这是我的完整代码。

```
import java.awt.AlphaComposite;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Composite;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.JCheckBox;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class SrcInDemo extends JFrame{
private JCheckBox jcb;
SrcInDemo()
{
super("SrcIn Demonstration");
setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
setSize(600,600);

add(new comp(),BorderLayout.CENTER);

setVisible(true);
add(jcb=new JCheckBox("Shadow"),BorderLayout.SOUTH);
jcb.addChangeListener(new ChangeListener(){

    @Override
    public void stateChanged(ChangeEvent e) {
        // TODO Auto-generated method stub
        repaint();
    }});
}
class comp extends JComponent
{
private BufferedImage image,landscape;
comp()
{
    try{
    image=ImageIO.read(/*getClass().getResource("picture.png")*/new File("src/picture.png"));
    landscape=ImageIO.read(/*getClass().getResource("landscape.jpg")*/new File("src/landscape.jpg"));
    }catch(IOException e){System.out.printf("error loading image");}
}
public void paintComponent(Graphics g)
{
//The following commented lines were there in the original code of Filthy Rich Clients
//But I have removed them as it was supposed to create a back image.I have created  g2 
//directly.
            /* BufferedImage temp = new BufferedImage(getWidth(), getHeight(),
            BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2 = temp.createGraphics();*/

    Graphics2D g2=(Graphics2D)g.create();
    if(jcb.isSelected())
    {
        int x=(getWidth()-image.getWidth())/2;
        int y=(getHeight()-image.getHeight())/2;
        g2.drawImage(image,x+4,y+4,null);

        Composite oldComposite=g2.getComposite();
        g2.setComposite(AlphaComposite.SrcIn);
        g2.setColor(Color.BLACK);
        g2.fillRect(0,0,getWidth(),getHeight());
        g2.setComposite(oldComposite);
        g2.drawImage(image,x,y,null);
    }
    else
    {
        int x=(getWidth()-image.getWidth())/2;
        int y=(getHeight()-image.getHeight())/2;
        g2.drawImage(image,x,y,null);
        Composite oldComposite=g2.getComposite();
        g2.setComposite(AlphaComposite.SrcIn);
        g2.drawImage(landscape,x,y,null);
        g2.setComposite(oldComposite);
    }
            //g.drawImage(temp, 0, 0, null);
}
}

public static void main(String args[])
{
SwingUtilities.invokeLater(new Runnable(){public void run(){new SrcInDemo();}});
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:04:58.450

我已经从 Filthy Rich Clients 下载了示例并运行了示例，没有任何问题。鉴于您的代码是相同的，我建议您的图像存在问题。

Alpha 合成在图像的 Alpha 通道上工作。

例如，如果我将盾牌图像更改为...（带有 50% alpha 的红色）

![在此处输入图像描述](../Images/e807e9b454fee9e0b27621392abb02dd.png)

我最终...

![在此处输入图像描述](../Images/bd9b8d154d413cdbccdf11dff60eccc4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:19:11.390

似乎经过长时间的研究和搜索，我找到了解决问题的方法。如果错了，请更正。我们开始吧：-

TYPE_INT_ARGB 用于具有透明背景的图像。TYPE_INT_ARGB 告诉我们的程序我们的图像具有透明背景。如果我们不使用它，则图像被认为是一个矩形（白色背景+图像）。这就是为什么在我的程序横向图像也出现在盾牌图像之外。实际上它不在盾牌图像之外，但它在内部，因为现在盾牌图像被认为是矩形图像（盾牌+白色背景）。黑色背景的原因也是如此在阴影情况下。因此我必须使用 TYPE_INT_ARGB。

# open-source - 有人可以推荐任何任务+工作流管理引擎吗？

> ID：13109288
> 
> 赞同：-1
> 
> 时间：2012-10-28T13:45:45.057
> 
> 标签：open-source, workflow, bpmn

有人知道任何好的开源（理想情况下是免费的）任务+工作流管理引擎（库、框架）吗？也许像activity.org这样的东西。

最好具有：组织结构（层次结构）管理、协作工作、文档工作流。理想情况下，实现 BPMN/BPEL。

基于 Ruby（理想情况下）、Java、PHP。或者也许有人知道任何具有此功能的插件（比如 Redmine、Trac）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:47:14.160

您可以看看 bonitasoft 的 Bonita Open Solution。

它是 JAVA 中的 BPMN 2.0 实现。它带有一个工作室来设计您的流程，一个引擎来管理您设计的流程的执行和用户体验，某种门户来管理您的流程，查看分配给用户的任务，...... BOS 带有一个用户目录用户可以在不同的组中拥有一个或多个角色，所以我认为它可以满足您的需求。

关于语言，它是用 Java 编写的，但它可以集成到用您想要的语言编写的外部应用程序中。例如，我将它集成到 C# 应用程序中，就像在 PHP 应用程序中一样。

关于 PHP 应用程序，我在几年前在这里写了一篇关于这个主题的文章：http: [//community.bonitasoft.com/blog/how-integrate-bos-engine-php-application](http://community.bonitasoft.com/blog/how-integrate-bos-engine-php-application)

如果您需要更多信息，请随时询问:)

干杯

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-01T17:31:58.757

您可能会查看一些开源 BPEL 替代方案，例如：

1.  [WSO2 BPS](http://wso2.com/products/business-process-server/)。[您可以在此处](http://wso2.org/project/bps/2.1.2/docs/index.html)找到更多信息。
2.  [Apache ODE](http://ode.apache.org/)

# ruby-on-rails - 如何覆盖类范围内的方法？

> ID：13109289
> 
> 赞同：2
> 
> 时间：2012-10-28T13:45:49.710
> 
> 标签：ruby-on-rails, ruby, methods, scope, overriding

我正在使用 Ruby 1.9.2 和 Ruby on Rails 3.2.2。我有以下陈述：

```
class Category < ActiveRecord::Base
  include Commentable

  acts_as_list :scope => 'category_comment_id'

  has_many :comments, :class_name => 'CategoryComment'

  # ...
end

module Commentable
  extend ActiveSupport::Concern

  included do
    acts_as_list :scope => 'comment_id'

    has_many :comments, :class_name => 'Comment'

    # Other useful method statements...
  end

  # Other useful method statements...
end 
```

在上面的代码中，我试图覆盖包含模块添加到类中的`acts_as_something`和方法。这两种方法都被声明为“在范围内” ，因此上面的代码*不能*按预期工作：方法不会被覆盖。`has_many``Category``Commentable``Category`

 *是否可以覆盖这些方法？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:54:12.560

您应该在类定义的末尾包含您的模块。就像现在一样，模块中的方法在类定义其方法之前被注入。之所以如此，是因为 ruby​​ 以自上而下的方式处理和评估代码。因此，稍后它会遇到类自己的方法定义并覆盖那些来自模块的定义。

所以，根据你的意图使用这些知识：谁应该覆盖谁。如果模块中的方法应该优先于类中的方法，请将其包含在最后。

## 编辑

鉴于此代码

```
require 'active_support/core_ext'

class Base
  def self.has_many what, options = {}
    define_method "many_#{what}" do
      "I am having many #{what} with #{options}"
    end
  end
end

module Commentable
  extend ActiveSupport::Concern

  included do
    has_many :comments, class_name: 'Comment'
  end
end 
```

然后

```
class Foo < Base
  include Commentable
  has_many :comments
end

# class overrides module
Foo.new.many_comments # => "I am having many comments with {}" 
```

和

```
class Foo < Base
  has_many :comments
  include Commentable
end

# module overrides class 
Foo.new.many_comments # => "I am having many comments with {:class_name=>\"Comment\"}" 
```*

# android - 如何将我的意图添加到 android 图库图像上下文“设置为”？

> ID：13109292
> 
> 赞同：2
> 
> 时间：2012-10-28T13:46:06.713
> 
> 标签：android, android-intent, android-manifest, android-gallery

所以，我有申请，那里有个人资料。我想将菜单位置添加到图库图像中，以便用户可以直接从图库中设置他们的个人资料图像。

在图库中有上下文菜单“设置为”。设置为..联系人图标、收藏夹、壁纸..等。

我还没有弄清楚，如何在那里添加我的应用程序。

我已添加到我的清单操作发送。

```
<action android:name="android.intent.action.SEND" /> 
```

但是“通过共享”不是那个，我需要的..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T11:47:52.027

解决方案是在清单中使用**android.intent.action.ATTACH_DATA 。**然后像**SEND**动作一样处理它。

通过定义意图定义的活动标签，可以轻松更改菜单位置的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:53:58.137

你不能。“分享方式”是让你这样做的唯一方法（尽管你的名字可能很不幸）

# java - 当 Java ServerSocket 在对象传输期间中断时会发生什么？

> ID：13109293
> 
> 赞同：1
> 
> 时间：2012-10-28T13:46:22.613
> 
> 标签：java, sockets, servlets, stream

我在 Java 中使用`ServerSocket`and`ObjectOuputStream`将我的项目的一些对象从客户端传输到服务器。我知道`ServerSocket`Java 中的类使用 TCP，因此不应丢弃任何数据包，但是如果客户端在流式传输对象的过程中崩溃会发生什么？我需要自己处理这个问题，还是 Java 会识别出来自流的对象是不完整的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:03:32.023

根据断开连接的方式，您可能会在服务器上遇到几个异常之一。您的服务器可能会抱怨异常，例如`Connection reset by peer`. 是的，您的容器可以识别连接未正确终止。您的容器抛出的异常将表明这一点。

请注意，在某些情况下，客户端可能会完全传输您的对象，但服务器可能仍然无法获取它。位于两者之间的负载均衡器可能会出于未知原因切断连接。也考虑这些情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:13:11.420

ServerSocket 没有中断。发送到 Socket 的数据被中断。ObjectInputStream.readObject() 方法将抛出 IOException 或可能永远阻塞，具体取决于故障模式。要避免后者，请在 Socket 上设置读取超时。然后它会抛出一个 SocketTimeoutException。

# powershell - Powershell中的start-process在执行完成后自动关闭窗口

> ID：13109294
> 
> 赞同：8
> 
> 时间：2012-10-28T13:46:27.527
> 
> 标签：powershell, process, window

我发现如果我`start-process`在 powershell 中启动一个进程，新窗口将在执行完成后自动关闭，是否可以让它等待我的进一步命令关闭？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T14:55:23.597

尝试在启动时将`-noexit`其作为参数传递`powershell.exe`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T14:55:04.627

你的意思是启动命令提示符？对？如果是这样，希望以下脚本会有所帮助

```
Start-Process cmd -ArgumentList '/c','echo test' # auto close
Start-Process cmd -ArgumentList '/k','echo test' # keep waiting 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-18T12:06:22.673

我已经设法得到了我需要的东西（在特定位置以管理员身份打开 powershell），以这种方式组装：

```
Start-Process powershell -ArgumentList "-noexit -command ""& {Set-Location D:\YourPath}""" -Verb runAs
exit 
```

启动进程：将使用 Args 启动 powershell，不退出并在特定位置打开，并将调用管理权限。Exit> 这将退出将打开的第一个窗口。

# c# - 如何让 VS 不复制我的 C# 文件

> ID：13109295
> 
> 赞同：2
> 
> 时间：2012-10-28T13:46:47.007
> 
> 标签：c#, visual-studio-2012

我有一个解决方案和一些项目。然后是我刚刚制作并添加到解决方案中的 Utils 文件。但是，当我想从解决方案中的任何项目中使用此文件时，它会被复制到项目的文件夹中。

所以如果我在 10 个项目中使用它，它会被复制 10 次。如何避免这种情况并让项目在其解决方案的文件夹中搜索该文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T13:49:28.600

在*Add Existing Item*对话框中，选择*Add As Link*操作而不是*Add*。*您可以在“添加*”按钮内的下拉式菜单中找到它。

您还可以将共享代码放入单独的程序集中。在我看来，具有大量链接文件的解决方案更令人困惑，而单独的项目可以显示开发人员在开发时考虑的结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:51:17.073

添加文件时，选择它，单击打开/添加按钮上的箭头，然后选择作为链接打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:54:28.210

我认为我们需要进一步澄清。这个 Utils 文件是源文件还是二进制引用？如果它是一个源文件，为什么不将它添加到一个公共项目中并从所有其他项目中引用该项目？如果它是您不想复制的二进制引用，请在“属性网格”中将引用的“**复制本地**”属性设置为“false”，从而保留二进制引用。

# php - PHP 上传丢失大文件（无错误）

> ID：13109296
> 
> 赞同：1
> 
> 时间：2012-10-28T13:46:49.317
> 
> 标签：php, apache, upload, limit

我正在使用 Xampp（在 win server 2003 上），并且我已授予 PHP 和 Apache 用于上传的 6GB 限制，并且没有等待系统进程的时间限制。当我尝试发布一个上传文件高于 ~1.8GB 的​​表单时，它会等到 100% 上传，然后用空白字段刷新表单。没有错误消息，没有路由到表单的目标页面 - 从头开始​​相同的页面。

是否存在任何隐藏限制或文件系统限制？如果是这样，您能否建议更好的（免费）PHP 上传方式？

提前谢谢你，马克。

编辑：限制是 2GB 而不是 1.8GB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:56:26.167

要上传千兆字节，请考虑编写一个 Web 服务器模块。这似乎是常识性的方法......并且确保一切都是64位的。

我什至从未想过 PHP 可以进行如此大的上传。我永远不会依赖它来处理这些事情。**并且不知道 PHP 是否可以正确处理 GB 大小...有了它对整数的无 64 位支持（它使用 32 位）...**

**我只是在这里猜测。** *我将为此类任务编写一个服务器模块，以完全按照我的意愿处理上传。*

# objective-c - BackBarButtonItem 没有出现

> ID：13109299
> 
> 赞同：0
> 
> 时间：2012-10-28T13:48:02.707
> 
> 标签：objective-c, ios, uinavigationitem

我已经实现了一个导航控制器来在视图之间导航（在根视图控制器中）。

在 MainWindow.xib 中，我实现了一个导航栏，但将选项标记为隐藏。

在其他视图中，我在 xib 文件中使用了其他导航栏对象，并使用它们在视图之间导航。问题是返回按钮。

```
 UINavigationItem *navigItem = [[UINavigationItem alloc]autorelease];

    UIBarButtonItem *backBtn = [[UIBarButtonItem alloc] 
                                                  initWithTitle:@"Back" 
                                                             style:UIBarButtonItemStylePlain 
                                                           target:nil 
                                                           action:@selector(back:)];

   navigItem.backBarButtonItem = backBtn;

   [self.navigationBar setItems:[NSArray arrayWithObject:navigItem]]; 
```

它没有出现后退按钮（箭头形）

或者，我可以使用左栏按钮，但它不一样。此代码运行：

```
 UINavigationItem *navigItem = [[UINavigationItem alloc]autorelease];

    UIBarButtonItem *backBtn = [[UIBarButtonItem alloc] 
                                                  initWithTitle:@"Back" 
                                                             style:UIBarButtonItemStylePlain 
                                                           target:nil 
                                                           action:@selector(back:)];

   navigItem.leftBarButtonItem = backBtn;

   [self.navigationBar setItems:[NSArray arrayWithObject:navigItem]]; 
```

我的问题：

当您在界面生成器中使用导航栏时可以实现 BackBarButtonItem 但考虑到在根视图控制器中还有另一个导航栏控制器（但隐藏）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T06:28:02.380

如果您使用的是 UINavigationController，那么您不需要实现 UniavigationBar 或导航项，因为您可以免费获得它。

要设置后退按钮文本，您可以设置后退按钮将返回到的视图的标题（并且推到顶部的视图上的后退按钮将获得此名称）或在同一视图上设置 backBarButtonItem 的标题。

# c# - 如何在 C# 中返回具有最大元素的数组？

> ID：13109301
> 
> 赞同：5
> 
> 时间：2012-10-28T13:48:27.400
> 
> 标签：c#, arrays, algorithm, linq

我有多个 int 数组：

```
1) [1 , 202,4  ,55]
2) [40, 7]
3) [2 , 48 ,5]
4) [40, 8  ,90] 
```

我需要得到所有位置中数字最大的数组。在我的情况下，这将是数组#4。解释：

*   数组 #2、#4 在第 1 位有最大的数字，所以在第一次迭代后这 2 个数组将被返回（[40, 7] 和 [40, 8 ,90]）
*   现在在比较上一次迭代返回的数组的第二个位置之后，我们将得到数组#4，因为 8 > 7
*   等等...

你能为此提出一个有效的算法吗？最好使用 Linq。

**更新**

长度没有限制，但是只要任何位置的某个数字更大，那么这个数组就是最大的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:15:04.317

```
var allArrays = new[]
{
    new[] { 1, 202, 4, 55 },
    new[] { 40, 7 },
    new[] { 2, 48, 5 },
    new[] { 40, 8, 90 }
}; 
```

找到要比较的索引。

排除第 3 个索引，因为没有什么可比较的，即第 1 个数组中只有 55：

![数据](../Images/84db7e671802e3bf6777016476bd1f03.png)

```
var maxElementsCount = allArrays.GroupBy(p => p.Length)
    // Find 2 at least
    .Where(p => p.Count() > 1)
    // Get the maximum
    .OrderByDescending(p => p.Count())
    .First().Key;

// 0, 1, 2
var indexes = Enumerable.Range(0, maxElementsCount); 
```

获取切片：

![切片表](../Images/5b2fe3e05a6e24aacb3a7a1a07a59f17.png)

```
var slices = indexes.Select(i =>
    allArrays.Select((array, arrayNo) => new
    {
        ArrayNo = arrayNo,
        // null if the element doesn't exist
        Value = i < array.Length ? array[i] : (int?)null
    }))
    .ToArray(); 
```

![切片](../Images/4205de7fa1151b67cf792cff4b6bc9af.png)

```
// Get the max values in each slice
var maxValues = slices.SelectMany(slice =>
    {
        var max = slice.Max(i => i.Value);
        return slice.Where(i => i.Value == max);
    })
    .ToArray(); 
```

![最大值](../Images/b9b66fa3048735ac48ef1cc07c78ffe8.png)

```
// Get the result array no
var arrayNumber = maxValues.GroupBy(p => p.ArrayNo)
    .OrderByDescending(p => p.Count())
    .First().Key;

var res = allArrays[arrayNumber]; 
```

![结果](../Images/bb0a76e385b5352146c77bb34655dfff.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:33:37.130

### a）不是*高效*的，但易于编写单行。

```
var arr1 = new int[] { 1, 202, 4, 55 };
var arr2 = new int[] { 40, 7 };
var arr3 = new int[] { 2, 48, 5 };
var arr4 = new int[] { 40, 8, 90 };

var max = new int[][] { arr1, arr2, arr3, arr4 }
           .Select(arr => new { 
                   IArray = arr, 
                   SArray = String.Join("",arr.Select(i => i.ToString("X8"))) 
           })
           .OrderByDescending(x => x.SArray)
           .First()
           .IArray; 
```

* * *

### b) 通过实施 `IComparer` 获得更好的结果

```
public class ArrayComparer : IComparer<int[]>
{
    public int Compare(int[] x, int[] y)
    {
        for(int i=0;i < Math.Min(x.Length,y.Length);i++)
        {
            if (x[i] > y[i]) return 1;
            if (x[i] < y[i]) return -1;
        }
        return x.Length - y.Length;
    }
}

var max2 = new int[][] { arr1, arr2, arr3, arr4 }
           .OrderByDescending(x => x, new ArrayComparer())
           .First(); 
```

* * *

### c) 最好的

```
var arrays = new int[][] { arr1, arr2, arr3, arr4 };
var max3 = arrays[0];
ArrayComparer comparer = new ArrayComparer();
for (int i = 1; i < arrays.Length; i++)
{
    if(comparer.Compare(arrays[i],max3)>0) max3 = arrays[i];
} 
```

* * *

### d) 通过扩展“Max”的通用版本

```
var max4 = new int[][] { arr1, arr2, arr3, arr4 }
            .Max(new SOExtensions.Comparer<int>())
            .ToArray();

public static class SOExtensions
{
    public static IEnumerable<T> Max<T>(this IEnumerable<IEnumerable<T>> lists, IComparer<IEnumerable<T>> comparer)
    {
        var max = lists.First();
        foreach (var list in lists.Skip(1))
        {
            if (comparer.Compare(list, max) > 0) max = list;
        }
        return max;
    }

    public class Comparer<T> : IComparer<IEnumerable<T>> where T: IComparable<T>
    {
        public int Compare(IEnumerable<T> x, IEnumerable<T> y)
        {
            foreach(var ab in  x.Zip(y,(a,b)=>new{a,b}))
            {
                var res=ab.a.CompareTo(ab.b);
                if (res != 0) return res;
            }
            return x.Count() - y.Count();
        }
    }
} 
```

* * *

### 结论

他们在我的测试用例中的相对表现：**`4000T, 270T, T, 6T`**

因此，如果您正在寻找速度，请不要使用利用 Sort/OrderBy 的算法，因为它的成本是**O(N*Log(N))**（而 Max 是**O(N)**）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:12:48.753

LINQ 效率不高（例如，参见[LINQ vs FOREACH vs FOR](http://www.schnieds.com/2009/03/linq-vs-foreach-vs-for-loop-performance.html)）。但是，它具有很好的可读性。如果您确实需要比 LINQ 提供的更好的性能，您应该编写没有 LINQ 的代码。但是，您不应该在知道需要优化之前进行优化。

这不是专门针对性能进行调整的，而是针对您的问题的清晰易读的解决方案：

```
static int[] FindLargestArray(int[][] arrays)
{
    for (int i = 0; arrays.Length > 1 && i < arrays.Max(x => x.Length); i++)
    {
        var maxVal = arrays.Where(x => i < x.Length).Max(x => x[i]);
        arrays = arrays.Where(x => i < x.Length && x[i] == maxVal).ToArray();
    }
    return arrays[0]; //if more than one array, they're the same, so just return the first one regardless
} 
```

视情况而定，它的性能可能已经足够好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T14:31:09.807

看起来像一个可以通过递归解决的问题。

```
public void GetMax()
{
    var matrix = new[]
                {
                    new[] {1, 202, 4, 55},
                    new[] {40, 7},
                    new[] {2, 48, 5},
                    new[] {40, 8, 90}
                };
    var result = GetMaxRecursive(matrix).FirstOrDefault();
}

private static int[][] GetMaxRecursive(int[][] matrix, int level = 0)
{
    // get max value at this level
    var maxValue = matrix.Max(array => array.Length > level ? int.MinValue : array[level]);

    // get all int array having max value at this level
    int[][] arraysWithMaxValue = matrix
        .Where(array => array.Length > level && array[level] == maxValue)
        .ToArray();

    return arraysWithMaxValue.Length > 1
                ? GetMaxRecursive(arraysWithMaxValue, ++level)
                : arraysWithMaxValue;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-28T14:46:20.427

我会采用传统的面向对象方法并创建一个包装器：

```
public class SpecialArray<T> : IComparable<SpecialArray<T>>
    where T : IComparable
{
    public T[] InternalArray { get; private set; }

    public SpecialArray(T[] array)
    {
        InternalArray = array;
    }

    public int CompareTo(SpecialArray<T> other)
    {
        int minLength = Math.Min(InternalArray.Length, other.InternalArray.Length);

        for ( int i = 0; i < minLength; i++ )
        {
            int result = InternalArray[i].CompareTo(other.InternalArray[i]);

            if ( result != 0 )
                return result;
        }

        return 0;
    }
} 
```

然后你可以像这样搜索 max：

```
 var list = new[]
            {
                new SpecialArray<int>(new[] {1, 202, 4, 55}),
                new SpecialArray<int>(new[] {40, 7}),
                new SpecialArray<int>(new[] {2, 48, 5}),
                new SpecialArray<int>(new[] {40, 8, 90})
            };

        var max = list.Max(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-28T14:00:05.933

我会建议“二叉搜索树”。它允许快速访问最小和最大元素。

[http://en.wikipedia.org/wiki/Binary_search_tree](http://en.wikipedia.org/wiki/Binary_search_tree)

每个数组都需要一棵树，以及组合数组的一棵树。

如果您打算使树更大，您还可以搜索“Red-Black BST”算法以轻松优化树。

编辑：

正常的 BST 本身很快，但是在添加元素时树变得非常不平衡-例如：如果每个新添加的变量的值平均大于前一个，则到达最大值的路径将变得越来越长，而到达最小值的路径仍然很短。红黑 BST 是平衡的——通往最远元素（包括最小值和最大值）的路径保持同样短。有一种更快的 BST 类型，但据我所知，它们很难编码。

但是如果你要使用红黑BST，我建议你先掌握常用的BST。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-28T16:34:05.140

完全没有的东西`Linq`：

```
public static List<int[]> FindTheHighestArrays(List<int[]> lst)
{
    List<KeyValuePair<int[], int>> temp = new List<KeyValuePair<int[], int>>();
    List<int[]> retList = lst;
    lst.Sort((x, y) => x.Length.CompareTo(y.Length));
    int highestLenght = lst[lst.Count - 1].Length;
    for (int i = 0; i < highestLenght; i++)
    {
        temp.Clear();

        foreach (var item in retList)
        {
            if (item.Length <= i)
                continue;

            temp.Add(new KeyValuePair<int[], int>(item, item[i]));
        }

        temp.Sort((x, y) => x.Value.CompareTo(y.Value));
        retList.Clear();
        retList.AddRange(temp.FindAll(kvp => kvp.Value == temp[temp.Count - 1].Value).ConvertAll(f => f.Key));

        if (retList.Count == 1)
            return retList;
    }

    return retList;
} 
```

上面的函数返回一个最高的 int 数组列表。例如，如果您尝试，

1) [1, 202, 4, 55]

2) [1, 202, 4, 55]

该函数返回两个数组，因为它们都同样最高。如果在这种情况下只需要一个数组，那么只需更改返回类型并返回列表的第一个元素。

你可以这样称呼它：

```
int[] a = new int[] { -1, 31, 90 };
int[] b = new int[] { -1, 31, 89 };
int[] c = new int[] { 0, 0, 90 };
List<int[]> lst = new List<int[]>() { a, b, c };

var highestArrays = FindTheHighestArrays(lst); 
```

# jquery - JQUERY 从数组中获取第一项

> ID：13109303
> 
> 赞同：1
> 
> 时间：2012-10-28T13:48:43.450
> 
> 标签：jquery

```
$("canvas[name=myCanvas]").index(0).width( $(window).width() );
$("canvas[name=myCanvas]").index(0).height( $(window).height() ); 
```

您好，我在一个页面上有三个画布。如何仅设置第一个画布宽度和高度？我怎样才能访问第三个？

试过：

```
$("canvas[name=myCanvas]").index(0) 
```

和

```
$("canvas[name=myCanvas]")[0] 
```

没用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:50:23.623

使用方法[`eq()`](http://api.jquery.com/eq/)

`$("canvas[name='myCanvas']").eq(0).width(...).height(...)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T13:51:25.407

试试这个

```
$($("canvas[name=myCanvas]").index(0)).width( $(window).width() );
$($("canvas[name=myCanvas]").index(0)).height( $(window).height() ); 
```

或者

```
$($("canvas[name=myCanvas]")[0]).width( $(window).width() );
$($("canvas[name=myCanvas]")[0]).height( $(window).height() ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T13:53:18.723

两个选项都很好：`.index(0)`或`[0]`. 问题是这些返回一个 html 元素而不是一个 jQuery 对象。因此，您不能使用这些功能`width()`和`height()`

您可以使用`eq()`html 对象或将其转换为 jquery `$`，但最好的选择是通过选择器获取它：

```
$("canvas[name=myCanvas]:first-child").width( $(window).width() ).height( $(window).height() ); 
```

或者

```
$("canvas[name=myCanvas]:nth-child(0)").width( $(window).width() ).height( $(window).height() ); 
```

# c# - 在一个进程中运行两个可执行文件

> ID：13109306
> 
> 赞同：0
> 
> 时间：2012-10-28T13:49:01.230
> 
> 标签：c#, .net, process

我从 C# 代码开始一个进程，然后分配给它两个不同的可执行文件来运行。我不确定这是否是一个好方法。这是代码：

```
ProcessStartInfo pi = new ProcessStartInfo();

pi.UseShellExecute = true;
pi.Verb = "runas";
pi.FileName = "cmd.exe";
pi.WorkingDirectory = Environment.CurrentDirectory;

Process p = new Process();
p.StartInfo = pi;
p.Start();

ProcessStartInfo p2 = new ProcessStartInfo();

p2.FileName = "notepad.exe";
p2.Verb = "runas";

p.StartInfo = p2;

p.Start();

Console.ReadKey(); 
```

而不是这样做，我应该创建两个 Process 实例并为每个实例分配相应的可执行文件以运行类似的东西：

```
Process p1 = Process.Start("cmd.exe");
Process p2 = Process.Start("notepad.exe"); 
```

乍一看，第一种方法对我来说似乎比第二种方法更好，因为我只使用一个进程而不是两个，所以内存和代码更少，但在同一个进程中运行两个不同的可执行文件对我来说有点奇怪.

请让我知道您对哪种方法是最好的和正确的方法的看法！

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:57:40.610

您的第二种方法可能更好，因为您的第一种方法节省的资源几乎没有您想象的那么多。

C# 中的`Process`类只是 Win32 函数的包装器，用于启动/停止/查询进程，并且非常轻量级。*实际运行过程*完全在您的应用程序之外。在这两种情况下，您的 C# 程序都会启动两个额外的进程。唯一的区别是，在您的第一种方法中，您将丢弃您拥有的有关进程的所有有用信息（它的状态、PID、I/O 句柄等）

# c# - 如何定义从某个基类派生的泛型类？

> ID：13109309
> 
> 赞同：-2
> 
> 时间：2012-10-28T13:49:13.577
> 
> 标签：c#

我想定义一些通用类

```
class A : IClonable
{
    clone();
} 
```

我想定义一个从类 T 派生的新类，但 T 的基类是 A ==> 因此，如果新类是 B，我将能够调用 Clone 而无需再次在 B 类中定义 IClonable。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:16:04.260

我想您是在问如何在 T 从 ICloneable 继承时使克隆方法在 MyClass 上可用。如果没有明确说明 MyClass 也从 IClonable 继承，这是不可能的，因为 MyClass 不是从 T 继承的；它只是一个具有在某种程度上与 T 相关的方法/属性的类（即允许在 T 类型的类上形成操作。

我能想到的最接近的允许您通过泛型类访问 T 的是破解默认索引器属性；这样，通过将 [1] 添加到 MyClass 实例的末尾，您将看到 T 克隆的单个实例。

```
 class A : ICloneable
    {
        public object Clone()
        {
            throw new NotImplementedException();
        }
        public override string ToString()
        {
            return "Demo";
        }
    }
    class B<T> where T : A
    {
        T myT;

        public B(T value)
        {
            this.myT = value;
        }

        //hack the default indexer to instead allow it to be used to return N clones of myT
        public IEnumerable<T> this[int index]
        {
            get
            {
                for (int i = 0; i < index; i++)
                {
                    yield return (T)this.myT.Clone();
                }
            }
        }
    }

    class Program
    {
        public static void Main(string[] args)
        {
            B<A> myB = new B<A>(new A());
            Console.WriteLine( myB[1].ToString());
            Console.ReadKey();
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:53:01.867

你的问题不清楚，但如果我理解正确并且你想创建一个**[泛型](http://msdn.microsoft.com/en-us/library/ms379564%28v=vs.80%29.aspx)**类并强制 T 的类型，那么这就是你想要的：

`public class B<T> where T : A`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:54:07.417

我不知道这里是否有什么棘手的地方。您可以从非泛型类继承具有泛型约束的类。

```
class A
{
    protected method1(); 
}

class B<T> : A
{
    //implement the rest
} 
```

# java - 停止主要功能？

> ID：13109311
> 
> 赞同：0
> 
> 时间：2012-10-28T13:49:21.330
> 
> 标签：java

我对Java很陌生，所以请提前原谅我这个愚蠢的问题。不过，我想问一下，是否有一些指令停止了 main 方法的其余部分？我的意思是：我有一个 public static void main 并且我有一个算法的特殊情况，它不需要大部分代码来计算，因为我从一开始就知道输出。所以我想要这样的东西：

```
if(x==5) {System.out.print("sth"); return 0;} 
```

但是我当然不能返回 0，因为 main 是 void 类型。有什么指示可以这样做吗？我知道我可以很好地将 main 更改为 int 或在简单的 if-else 中抛出此异常和其余计算，但也许有更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:55:07.073

如果您只想退出该`main`方法，请使用

```
return; 
```

如果要停止整个执行，也可以使用

```
System.exit(0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T13:50:16.243

仅使用`return;`

```
if(x==5) {System.out.print("sth"); return;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T13:54:09.613

不需要，`return 0;`所以您的代码将如下所示：

```
if(x==5) {System.out.print("sth"); return;} 
```

# java - JButton 和树形图的下一个/上一个对象

> ID：13109317
> 
> 赞同：1
> 
> 时间：2012-10-28T13:49:57.453
> 
> 标签：java, swing, jbutton, actionlistener, treemap

我有这个问题：

1）有对象通过JTextField放置在TreeMap中。（类似电话簿的程序）。

2）TreeMap中有实现查看可用记录的按钮。当您单击这些按钮时，JTextField 中显示的 TreeMap 的下一个/上一个可用对象。（滚动可用的记录）。

我试过这段代码，但没有用：/

```
btn[4].addActionListener(new ActionListener(){
     Iterator iter = tree.keySet().iterator();
      public void actionPerformed(ActionEvent e) {
         if (iter.hasNext()){
         String str = iter.next().toString();
         fldFio.setText(str);
         fldNumber.setText(tree.get(str));
         }
      }
}); 
```

我在方法 actionPerformed 中添加了这一行作为第一行：

```
System.out.println(iter1.hasNext()); 
```

结果是“假的”，如果它无论如何都会有帮助的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:05:34.567

看来您`Iterator` `iter1`在应用程序中使用了另一个。要浏览您的`TreeMap`内容，您需要使用您定义的迭代器`ActionListener`：

```
 if (iter.hasNext()){
    String str = iter.next().toString();
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:08:17.803

您是否尝试在“actionPerformed()”方法中移动迭代器：

```
btn[4].addActionListener(new ActionListener(){
  public void actionPerformed(ActionEvent e) {
     Iterator iter = tree.keySet().iterator();
     if (iter.hasNext()){
     String str = iter1.next().toString();
     fldFio.setText(str);
     fldNumber.setText(tree.get(str));
     }
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T10:02:25.593

我使用 NavigableMap 中的方法发布了这个东西。谢谢大家的帮助：

```
btn[4].addActionListener(new ActionListener(){
       String str;
       public void actionPerformed(ActionEvent e) {
           if (tree.size() != 0){
               if ((str)==null){
                   str = tree.firstKey();
                   } else {
                   fldFio.setText(str);
                   fldNumber.setText(tree.get(str));
                   str = tree.higherKey(str);   
                   }
          }
       }
   }); 
```

# c - 不同的pid cgi程序

> ID：13109318
> 
> 赞同：0
> 
> 时间：2012-10-28T13:50:02.803
> 
> 标签：c, linux, apache, cgi

我已经用 C 编写了这个测试 CGI 程序。

```
int main(int argc, char *argv[])
{
    sem_t *mysem;

    mysem = sem_open("/MyClient", O_CREAT | O_EXCL, S_IRUSR | S_IWUSR, 10);
    if(mysem == SEM_FAILED)
    {
        // already running
        if(errno == EEXIST)
        {
            fprintf(stdout, "Content-type:text/plain\n\n");
            fprintf(stdout, "Already running");
            exit(1);
        }
        else
        {
            fprintf(stdout, "[error] - ", errno);
            exit(1);
        }
    }

    fprintf(stdout, "Content-type:text/plain\n\n");
    int i = 0;
    for(;i <10; i++)
    {
        sleep(1);
    }

    fprintf(stdout, "all done by PID - %d\n", getpid());

    sem_unlink("MyClient");
    sem_close(mysem);

    return 0;
} 
```

我正在将 Apache 用于 Web 服务器。当我在浏览器中转到“localhost/cgi-bin/mycgi”时（同时打开两个选项卡）。

**输出应该是这样的（预期）**

（对于 Tab1）“全部由 PID - 8186 完成”

和（对于 Tab2）“已经在运行”

**但我明白了（实际）**

（对于 Tab1）“全部由 PID - 8186 完成”

和（对于 Tab2）“全部由 PID - 8187 完成”

如果我在终端中执行程序（2 个实例），上述代码将按预期工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T09:04:27.600

[好的，我在这里](http://httpd.markmail.org/search/?q=single%20instance%20cgi#query%3asingle%20instance%20cgi%20page:1%20mid:3d3qrc4pbevn3w7q%20state%3aresults)找到了我的问题的答案。

浏览器可能会打开一个与服务器的连接，并使用同一连接发送多个请求。这就是所谓的“保持活动”连接。在服务器端，这导致这个连接被移交给一个单独的 Apache“子”，并且这个单独的子保持连接打开并处理该连接上的所有请求，一个接一个。

无论您在同一个浏览器中打开多少个窗口或选项卡，它*可能*仍然只使用一个连接，用于所有窗口或选项卡。但是两个不同的浏览器（或两个不同工作站上的同一个浏览器）不会共享一个连接。

如果我同时在两个不同的浏览器（Firefox 和 Chrome）中尝试这个，它会按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:56:18.197

来自 Ubuntu 的`man sem_overview`：

> 命名信号量由 /somename 形式的名称标识；即，最多 NAME_MAX-4（即 251）个字符的空终止字符串，由一个初始斜杠组成，后跟一个或多个字符，其中没有一个是斜杠。

IOW，您的信号量名称无效。

另一件事，来自`man sem_open`：

> 如果在 oflag 中指定了 O_CREAT，则必须提供两个附加参数。...

该函数将得到随机的废话`mode`和`value`，并具有可预测的不可预测的结果。

# sql - F3 框架替换数组中的字符串

> ID：13109321
> 
> 赞同：1
> 
> 时间：2012-10-28T13:50:23.083
> 
> 标签：sql, fat-free-framework

我正在使用 F3 框架，需要能够替换数组中的值。

```
$car=new Axon('cars');
$list=$car->afind(); 
```

所以我定义了一个名为“list”的数组，它有一个字段“producer_id”。但是如何更改此数组中字段的值？想法：这个数组给了我汽车数据库中所有汽车的列表。每辆车都有一个 producer_id。Prodrucer 是我数据库中的一个自己的表，其中包含 producer_id 和 producer_name 等字段。通过对该表的 SQL 查询，我想获取 producer_name 并将其插入到数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:09:34.573

你有几个选择：

遍历 $list 并使用来自另一个 Axon 的数据填充另一个数组：

```
$names=array();
foreach($list as $i){
    $producers=new Axon('producers');
    $p=$producers->afind('producer_id='.$i['producer_id']);
    $names[]=$p['producer_name'];
} 
```

使用 SQL 和 Join 语句：

```
$sql='select cars.*,producers.producers_name from cars left join producers on cars.producer_id=producers.producer_id';
DB:sql($sql);
foreach(F3::get('DB->result') as $row){
    print_r($row);
} 
```

希望至少能让你朝着正确的方向开始。

# c# - 在 Asp.Net 4.0 中部署 HttpModule 的问题

> ID：13109323
> 
> 赞同：2
> 
> 时间：2012-10-28T13:50:26.960
> 
> 标签：c#, asp.net, .net, httpmodule

我想做UrlRewriting。为了做到这一点，我编写了一个 HttpModule，它在`AuthorizeRequest`ASP.NET Http Modules 链中的事件上运行（在 HttpHandler 处理请求之前）。

## 语境

我写了一个抽象类作为实现`IHttpModule`接口的基本重写器：

```
public abstract class BaseModuleRewriter : IHttpModule {
  public virtual void Init(HttpApplication app) {
    // WARNING! This does not work with Windows authentication!
    app.AuthorizeRequest += new ventHandler(this.BaseModuleRewriter_AuthorizeRequest);
  }
  public virtual void Dispose() { }
  protected virtual void BaseModuleRewriter_AuthorizeRequest(object sender, EventArgs e) {
    HttpApplication app = (HttpApplication)sender;
    this.Rewrite(app.Request.Path, app);
  }
  protected abstract void Rewrite(string requestedPath, HttpApplication app);
} 
```

该模块的真正实现是以下类：

```
public class ModuleRewriter : BaseModuleRewriter {
  protected override void Rewrite(string requestedPath, System.Web.HttpApplication app) {
    // Just dummy, if the module works, I should never get to any page other than homepage
    UrlRewritingUtils.RewriteUrl(app.Context, "Default.aspx");
  }
} 
```

在我的 web.config 我有以下内容：

```
<configuration>
  ...
  <system.web>
    <httpModules>
      <add type="ModuleRewriter" name="ModuleRewriter"/>
    </httpModules>
  </system.web>
  ...
</configuration> 
```

实际上，这是来自 MSDN Megazine 中一篇文章的 Url-Rewriting 的简单实现。我只是让它更简单，但方法就是这样。

## 问题

这没用！当我像我告诉你的那样部署模块并请求一个页面时，我可以访问我网站的所有页面，相反，我应该总是被“重定向”到`Default.aspx`.

该怎么办？

## 附加信息

首先，一个重要信息：我的应用程序池是针对框架 4.0的*集成模式。*

我的网站没有编译。我的意思是我不预编译我的网站，但我将所有代码放在`App_Code`目录中，并在请求页面时让 ASP.NET 编译它。一个直接的后果是我所有的程序集都放在`%sysroot%\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\...`目录中。

我通过指定组件也阅读了一些在 web.config 中部署模块的内容，例如：

```
<configuration>
  ...
  <system.web>
    <httpModules>
      <add type="ModuleRewriter, ModuleRewriterAssembly" name="ModuleRewriter"/>
    </httpModules>
  </system.web>
  ...
</configuration> 
```

但是，由于我的东西没有预编译，而是完全由 Asp.Net 管理，我无法指定不同的程序集。是否需要解决这个问题？如果是这样，该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T18:43:04.070

根据您的 appPool 配置（集成与经典模式），尝试添加

```
 <system.webServer>
    <modules>
      <add type="ModuleRewriter" name="ModuleRewriter"/>
    </modules>
  </system.webServer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-12T10:31:56.830

更改应用程序池解决了该问题。我将其更改为集成，并且可以正常工作。

# python - 将列表转换为列表列表

> ID：13109325
> 
> 赞同：0
> 
> 时间：2012-10-28T13:51:02.787
> 
> 标签：python, python-3.x

如何将字符串列表转换为列表列表

```
a=['A','B','C'] 
```

并转换为

```
b=[['A'],['B'],['C']] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-28T13:52:24.870

使用[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
In [7]: a = ['A', 'B', 'C']

In [8]: b = [[item] for item in a]

In [9]: b
Out[9]: [['A'], ['B'], ['C']] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T13:52:43.437

使用列表理解：

```
>>> a=['A','B','C']
>>> [list(x) for x in a]
[['A'], ['B'], ['C']] 
```

或 use `map()`，在 python 3.x 中`map()`返回一个地图对象，所以`list(map(list,a))`在那里使用：

```
>>> map(list,a)
[['A'], ['B'], ['C']] 
```

或者正如@mata 指出的那样，如果你想要这样的东西：

```
>>> a=['foo','bar','spam']
>>> [[x] for x in a]
[['foo'], ['bar'], ['spam']] 
```

或与`map()`：

```
In [1]: a=['foo','bar','spam']

In [2]: map(lambda x:[x],a)
Out[2]: [['foo'], ['bar'], ['spam']] 
```

# ios - 带有 iOS6 AVAudioPlayer 的 iPhone4S 工作正常，但没有声音

> ID：13109326
> 
> 赞同：2
> 
> 时间：2012-10-28T13:51:16.353
> 
> 标签：ios, audio, avaudioplayer

我创建了一个播放 mp3 文件的简单音频应用程序。它在模拟器（iOS 5 和 6）和 iPod3GS（使用 iOS 5.1）上没有问题。但是当我在我的 iPhone4S（iOS 6）上尝试时，它似乎可以工作，但没有任何声音。

“[audioPlayer 持续时间]”给了我正确的价值，甚至委托的“audioPlayerDidFinishPlaying”消息也显示了持续时间后播放的正确完成。

我的 iPhone4S 在音乐、视频或播客等其他声音应用程序中运行没有问题。只是它不能用我自己的自定义应用程序发出声音。

```
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"banana" ofType:@"mp3"]];
NSError *error;
if (error) {
    NSLog(@"error in audioPlayer:%@", [error localizedDescription]);
}
else {
    self.audioPlayer.delegate = self;
    [self.audioPlayer prepareToPlay];
} 
```

它只是一个设备问题还是有关于这个问题的任何线索？有人有过类似的经历吗？

我重置了手机上的设置值并重新启动它，但仍然是同样的问题。我测试了 mp3、wav 和 aiff 文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T14:02:04.810

关闭消音器。

![显示静音开关的侧视图](../Images/da9c7d511af7c9b5900879da552c1ff8.png)

并仔细检查您是否打开了*两个卷。*

# java - java 和 regexp：如何匹配带有 lithreal 括号的字符串？

> ID：13109330
> 
> 赞同：2
> 
> 时间：2012-10-28T13:51:36.363
> 
> 标签：java, regex

我有这三个文本和一个正则表达式。（好吧，它是 HTML，但是......请不要专注于它！！！！）

```
<h3 class="pubAdTitleBlock "><a href="/it/pubblicazioni/libri/Che-speranza-cè-per-i-morti/1101987030/" title="Che speranza c’è per i morti?">Che speranza c’è per i morti? (volantino N. 16)</a></h3>

<h3 class="pubAdTitleBlock "><a href="/it/pubblicazioni/libri/cosa-insegna-la-bibbia/È-questo-che-Dio-voleva/" title="È questo che Dio voleva?">Cosa insegna realmente la Bibbia?</a></h3>

<h3 class="pubAdTitleBlock">Cantiamo a Geova</h3> 
```

这是正则表达式

```
regexp = "<h3[^>]*>(<a[^>]*>)?([^<]+)(</a>)?</h3>"; 
```

我有三个 3 组：

*   开始`<a>`标签（可选）
*   文本（这是书名，**是 regexp 的目标**）
*   结束`</a>`标签（可选）

**问题**：第二行匹配，第三行匹配。第一个没有。为什么 ？

匹配代码：

```
pattern = Pattern.compile(regexp);
matcher = pattern.matcher(fullString);
idx = 0;
while (matcher.find()) {
  ...
} 
```

`matcher.find()`只是跳过第一行。这不是文件的第一行，而是第 10 行。这是第一个例子。

可以是字面括号的问题吗？如何修复正则表达式？

**编辑**：我试过

```
String regexp = "<h3[^>]*>(.+)</h3>"; 
```

但是这个正则表达式也跳过了第一行......我真的无法理解！！！！

**编辑2：**

我有一个问题：如果有重音字符会是个问题吗？

**编辑 3：**

我正在尝试从这里进行数据抓取：[http ://www.jw.org/it/pubblicazioni/libri/?contentLanguageFilter=it&sortBy=3](http://www.jw.org/it/pubblicazioni/libri/?contentLanguageFilter=it&sortBy=3)

我有一个输入流，然后我使用以下代码转换为单个字符串：

```
 // copied from http://stackoverflow.com/questions/309424/read-convert-an-inputstream-to-a-string
public static String convertStreamToString(InputStream is) {
    try {
        return new java.util.Scanner(is, "UTF-8").useDelimiter("\\A").next();
    } catch (java.util.NoSuchElementException e) {
        return "";
    } 
```

然后我正在应用正则表达式...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T14:52:30.090

不确定，但也许这就是你要找的

```
String data = "<h3 class=\"pubAdTitleBlock \"><a href=\"/it/pubblicazioni/libri/Che-speranza-cè-per-i-morti/1101987030/\" title=\"Che speranza c’è per i morti?\">Che speranza c’è per i morti? (volantino N. 16)</a></h3>"
        + "<h3 class=\"pubAdTitleBlock \"><a href=\"/it/pubblicazioni/libri/cosa-insegna-la-bibbia/È-questo-che-Dio-voleva/\" title=\"È questo che Dio voleva?\">Cosa insegna realmente la Bibbia?</a></h3>"
        + "<h3 class=\"pubAdTitleBlock\">Cantiamo a Geova</h3>";

Pattern pattern = Pattern
        .compile("<h3[^>]*>(?:<a[^>]*>)?([^<]+)(?:</a>)?</h3>");
Matcher matcher = pattern.matcher(data);
while (matcher.find()) 
    System.out.println(matcher.group(1)); 
```

输出：

```
Che speranza c’è per i morti? (volantino N. 16)
Cosa insegna realmente la Bibbia?
Cantiamo a Geova 
```

小解释：

像这样的组`(?:someregex)`不会被正则表达式机制计算在内。由于在`(?:a)(b)(?:c)(d)`组`(b)`中将被索引为 1 和`(d)`2。

## 编辑1

（我知道使用正则表达式解析 HTML 是亵渎神明，但既然 OP 想要它......）
你忘了提到解析的 HTML 包含空格，如*制表*符和*新行*标记`<h3 >`。试试这种方式：

```
String data = convertStreamToString(new URL(
        "http://www.jw.org/it/pubblicazioni/libri/?contentLanguageFilter=it&sortBy=3")
        .openStream());

Pattern pattern = Pattern
        .compile("<h3[^>]*>\\s*(?:<a[^>]*>)?([^<]+)(?:</a>)\\s*?</h3>");
Matcher matcher = pattern.matcher(data);
int counter=0;
while (matcher.find())
    System.out.println(++counter +")"+matcher.group(1)); 
```

输出：

```
1)Accostiamoci a Geova
2)Accostiamoci a Geova — caratteri grandi
....
11)Cosa insegna realmente la Bibbia?
12)Cosa insegna realmente la Bibbia? — caratteri grandi 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:01:42.933

不要使用 Parser 或 RegExp。试试[杰瑞](http://jodd.org/doc/jerry/index.html)。喜欢（未测试）：

```
Jerry doc = jerry(html);
doc.$("a").each(new JerryFunction() {
    public boolean onNode(Jerry $this, int index) {
        String href = $this.attr("href");
        System.out.println(href);
    }
} 
```

或任何对 html 友好的查询语言。由于非外部要求尝试[尝试使用 Java 解析 HTML 目录列表中的链接](https://stackoverflow.com/a/5876127/926620)

（复制粘贴我的答案：[How do you parse links from html using Java?](https://stackoverflow.com/a/12875849/926620)）

**编辑：**试试

```
<h3.*?>(<a.*)?+(.*?)(</a>)?</h3> 
```

并获得组（2）

**编辑2：**只是为了书名尝试：

```
(.*>)?([^<]+?)<.* 
```

**编辑 3：**你的正则表达式

```
<h3[^>]*>(<a[^>]*>)?([^<]+)(</a>)?</h3> 
```

看起来为我工作。

# javascript - 基本 SQLlite sql 更新失败并出现严重错误

> ID：13109332
> 
> 赞同：-1
> 
> 时间：2012-10-28T13:51:47.907
> 
> 标签：javascript, sqlite, cordova

我目前正在构建一个 phonegap 应用程序。

一个页面包含一个允许登录用户更新基本设置的表单。在此页面上，我有一个“更新”按钮，该按钮调用一个 JS 函数，该函数使用更改的设置更新数据库。但是，我似乎无法让最基本的更新正常工作。

这是一个（非常简化的）示例。

```
function updateSettings(tx) {
    tx.executeSql('UPDATE USERS SET (username) VALUES ("edit") WHERE id = 1');
}

db.transaction(updateSettings, errorCB); 
```

运行这个（以及我尝试过的几乎所有其他更新）都会给我这个错误：

```
Error processing SQL: could not prepare statement (1 near "(": syntax error) 
```

我最初尝试运行的稍微复杂一点的查询是这样的：

```
tx.executeSql('UPDATE USERS SET (username, password, userId, defaultHandler, autoSync, updateCT, updateHistorical, updateFavorite, signedIn) VALUES ("'+ username +'", "'+ password +'", "plUserId", "Default Handle", "'+ sync +'", "' + updateCaseTypes + '", "' + updateHistoricalCases + '", "' + updateFavoriteCases +'", "1") WHERE id = 1'); 
```

谁能指出我正确的方向？

提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:54:04.800

那不是有效的 SQL。请参阅[关于`UPDATE`](https://www.sqlite.org/lang_update.html).

```
UPDATE USERS set username = 'edit' where id = 1; 
```

# javascript - 如何将错误消息与 json 响应中的“错误”键相关联

> ID：13109333
> 
> 赞同：2
> 
> 时间：2012-10-28T13:51:51.740
> 
> 标签：javascript, ruby-on-rails, json

我试图通过上传文件（文件名、大小）来显示可能发生的错误。我正在[为 Ruby on Rails 使用 Jquery Fiel Upload 的改编版本](https://github.com/tors/jquery-fileupload-rails-paperclip-example)

我需要将我的错误消息（验证）与我的 json 响应中的“错误”键相关联。

我想我必须更改 javascript 才能使其正常工作。

json:

```
render json: {error: @upload.errors.full_messages}, status: :unprocessable_entity 
```

验证：

```
 validates_uniqueness_of :upload_file_name, :message => "File with this name is already in the database"

 validates :upload_file_size,  :inclusion  => {:in =>10.megabytes..20.megabytes}, :message =>"Too big or too small" 
```

我用来上传文件的Javascript：

```
<script type="text/javascript" charset="utf-8">
      $(function () {
          // Initialize the jQuery File Upload widget:
          $('#fileupload').fileupload();
          // 
          // Load existing files:
          $.getJSON($('#fileupload').prop('action'), function (files) {
            var fu = $('#fileupload').data('fileupload'), 
              template;
            fu._adjustMaxNumberOfFiles(-files.length);
            console.log(files);
            template = fu._renderDownload(files)
              .appendTo($('#fileupload .files'));
            // Force reflow:
            fu._reflow = fu._transition && template.length &&
              template[0].offsetWidth;
            template.addClass('in');
            $('#loading').remove();
          });

      });
    </script> 
```

我也尝试过这些事情： `json: => [{:error=> @upload.errors.full_messages }] }` 使用它只显示验证消息，但我需要状态：以及

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:36:35.490

这是解决方案：

json:

```
format.json{ render json: {error: @upload.errors.full_messages}, :status =>422} 
```

javascript（主要代码的截断）

```
$('#fileupload').fileupload({       

        error: function(xhr){
          var errors = $.parseJSON(xhr.responseText).error
          alert(errors)         
        }
              }); 
```

# c - 存在整数时 C 中字符数组的行为

> ID：13109350
> 
> 赞同：-4
> 
> 时间：2012-10-28T13:54:00.627
> 
> 标签：c, arrays, char

我无法得到这个程序的输出意味着这个程序是如何运行的？有人可以帮我吗？

```
#include<stdio.h>

int main(){
char c[]={'1','2','3',0,'1','2','3'};
printf(c); //gives 123 as output
char d[]={'1','0','3',0,'1','2','3'};
printf(d); //gives 103 as output
return 0;
} 
```

这会将我在 0 之前插入的所有字符作为字符串输出。
我还想解释一下为什么 printf 打印 0 之前的所有字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:55:48.823

你有一个`0`在你的阵列中间。`printf`将打印到数组`0`中的第一个。`char`此外，单引号中不能包含多个字符。单引号定义字符而不是字符串。最后，您应该`char`以`0`.

尝试这个：

```
char c[]={'1','4','3','3','0','1','2','3',0}; 
```

请注意，中间有引号`0`以使其成为字符，而最终字符串周围**没有**引号`0`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:07:58.433

据我了解， 0 （通常）等于`NULL`， printf 打印到`NULL`它找到的第一个终止符。

在你的情况下

```
char c[]={'1','2','3',0,'1','2','3'};
printf(c);
char d[]={'1','0','3',0,'1','2','3'};
printf(d); 
```

当打印`c`和`d`printf 打印到`NULL`它遇到的第一个是`0`. 但是，当您将`'0'`其视为字符 0 而不是终止符时。

# c++ - 如何将类作为参数传递

> ID：13109356
> 
> 赞同：2
> 
> 时间：2012-10-28T13:54:17.757
> 
> 标签：c++, class, function, types, parameters

**在 C++ 中有没有办法将类型（例如类）作为参数传递给函数？**

解释为什么我需要这个：有一个抽象`data`类和一个`manager`类。该类`manager`包含 的派生类的对象列表（或在本例中为映射）`data`。我在[这个问题](https://stackoverflow.com/questions/7877993/c-create-array-of-objects-from-different-classes)`unique_ptr`的答案中提到过这个。

```
class Data{}; // abstract

class Manager
{
    map<string, unique_ptr<Data>> List;
}; 
```

现在想象一下我想为`data`管理器添加一个新的存储。

```
class Position : public Data
{
    int X;
    int Y;
} 
```

我怎么能告诉经理创建该类型的对象并引用`unique_ptr`它？

```
Manager manager;
manager.Add("position data", Position); 
```

在这种情况下，我需要将类传递`Position`给管理器类的`add`函数，因为我不想先创建一个实例然后将其发送给管理器。

**然后，我怎样才能将该类的对象添加到`List`？**

我不确定在 C++ 中是否有办法做到这一点。如果这不能轻松完成，我真的很想看到一个解决方法。非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:08:07.213

您可以使用模板。在您派生的每种类型中，`Data`都必须定义一个“创建者”函数，其原型如下：`Derived* create()`. 它将在内部调用（您也可以返回 a `unique_ptr`，但这需要更多内存）。

前任：

```
struct Position: public Data
{
    // ...
    static Position* create()
    {
        return new Position();
    }
}; 
```

该`Add`方法将是：

```
template<typename D>
void Add(String str)
{
    List.insert(std::make_pair(str, std::unique_ptr<Data>(D::create())));
} 
```

然后你像这样使用它：

```
Manager manager;
manager.Add<Position>("position data"); 
```

**编辑**

`create`您还可以使用以下`Add`方法摆脱这些功能：

```
template<typename D>
void Add(String str)
{
    List.insert(std::make_pair(str, std::unique_ptr<Data>(new D())));
} 
```

优点：数据结构代码少。

不方便：数据结构对其构建方式的控制较少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T14:08:45.463

像这样的东西怎么样：

```
class Manager
{
 public:
  template <typename T>
  void addData(const std::string& title)
  {
    List.insert(std::make_pair(title, std::unique_ptr<Data>(new T));
  }
 private:   
  map<string, unique_ptr<Data>> List;
}; 
```

然后

```
Manager manager;
manager.addData<Position>("position data"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:09:18.727

使用`unique_ptr`意味着致力于使用动态分配的对象。（不太正确：您可以提供一个不调用的自定义删除器`delete`，但这会成为类型的一部分；这意味着您将致力于使用*非*动态分配的对象。）

```
void Manager::Add(String title, unique_ptr<Data> d) {
    List[title] = d;
} 
```

称它为：

```
Manager manager;
unique_ptr<Data> pos(new Position);
// Set it up
manager.Add("position data", pos); 
```

注意：如果你想对你的数据对象*做*任何事情，你可能想在`class Data`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T13:59:52.670

定义函数如下：

```
void Manager::Add(String title,Position pos){ /*snip*/ } 
```

然后您可以使用以下功能：

```
Manager manager;
Position posData;
//setup the posData
manager.Add("position data",posData); 
```

# java - 如何使用java与Web通信

> ID：13109357
> 
> 赞同：0
> 
> 时间：2012-10-28T13:54:17.607
> 
> 标签：java, web-services, web-applications

我正在用 Java 编写一个程序，我需要这个程序来进入一个站点，向它发送查询并收集它的答案。

例如，我希望我的程序插入一个字符串以在 Google 中搜索并检索出现的第一个站点。

你能指导我找到我可以为此使用的 api、库或 jars 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:56:27.510

使用 Apache 的[HttpClient](https://hc.apache.org/httpcomponents-client-ga/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:10:18.490

您可以使用 URLConnection。它是 JDK 的一部分；不需要图书馆。 [这](http://www.exampledepot.com/egs/java.net/Post.html)是一个关于如何使用它的例子。

# javascript - JavaScript“this”关键字和闭包编译器警告

> ID：13109358
> 
> 赞同：1
> 
> 时间：2012-10-28T13:54:22.970
> 
> 标签：javascript, scope, google-closure-compiler

我有生产代码，现在我正在尝试使用高级选项使用 Closure Compiler 来缩小这些代码。该代码使用[Paul 的客户端 cookie 库](http://www.paulspages.co.uk/pcp/cookielib/index.htm)。编译器会生成 30 多个这样的警告：

```
JSC_USED_GLOBAL_THIS: dangerous use of the global this object 
```

以下是 Paul 库中的一些代码片段（原始代码使用命名函数，而不是匿名函数）：

```
 var cookieObject = function (name, expires, accessPath) {
        var i, j
        this.name = name
        this.fieldSeparator = "#"
        // this.found = false
        this['found'] = false;  // don't allow Closure-Compiler to rename
        this.expires = expires
        this.accessPath = accessPath
        this.rawValue = ""
        this.fields = new Array()
        this.fieldnames = new Array() 
        if (arguments.length > 3) { // field name(s) specified
              j = 0
              for (i = 3; i < arguments.length; i++) {
                    this.fieldnames[j] = arguments[i]    
                    j++
              }
              this.fields.length = this.fieldnames.length 
        }
        this.read = ucRead            // function assignments
        this.write = ucWrite
        this.remove = ucDelete
        this.get = ucFieldGet
        this.put = ucFieldPut
        this.namepos = ucNamePos
        this.read()
  }; // cookieObject 
```

*uc*函数通常以这种方式构造：

```
 var ucRead = function () {
        var search = this.name + "="
        var CookieString = document.cookie
        this.rawValue = null
        this.found = false
  } 
```

我已经阅读[了“this”关键字在 JavaScript 对象文字中是如何工作的？](https://stackoverflow.com/questions/133973/how-does-this-keyword-work-within-a-javascript-object-literal)以及[关闭编译器警告危险使用全局“this”对象？](https://stackoverflow.com/questions/5301373/closure-compiler-warning-dangerous-use-of-the-global-this-object)和[JavaScript 中的范围](http://www.digital-web.com/articles/scope_in_javascript/)。但是，我仍然不明白`this`上述代码的范围是什么，也不明白我将如何重写这段代码以消除编译器警告。

Q1：有人可以为我澄清一下范围`this`是什么吗？

Q2：有人可以提供一些代码片段来说明如何重写上述内容以消除编译器警告（我假设`this`必须消除使用）？

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:12:17.597

范围`this`本质上是不可预测的。`this`引用调用该函数的任何上下文*该特定调用*。例如：

```
var foo = function()//or function foo()
{
    console.log(this);
};
foo();//logs the window object
var anObj = {name:'someObject',method:foo};
anObj.method();//logs `anObj` 
```

基础很简单：

```
[[someObject]].function();//call func
    /\            ||
    ||  implicit  ||
    |______________| 
```

在第一个示例中，没有*明确*的所有者对象，因此 JS 默认回退到全局对象。（除非使用时`strict mode`）。第二个例子， foo 被用作方法，从对象调用，所以`this`引用该对象。

现在，这一切都非常简单，但是鉴于`this`引用是*临时*确定的，并且函数在 JS ( ) 中的绑定*很**松散*`Array.prototype.slice.apply(arguments,[0]);`，因此无法保证*this*总是指向您期望它指向的内容。ECMAScript 5 为您提供了这种方法，使您能够将给定的上下文*绑定*到函数对象，但不要忘记：有些恼人的人仍在使用过时的浏览器。此外，这是一个由来已久的*“问题”*，人们使用了各种解决方法。最简单的是使用闭包： *`bind`*

 ***```
var MyConstructor = function()
{
    "use strict";//in strict mode, this'll throw errors when called without new keyword
    if (this === window || !this)
    {
        throw 'Omitted new keyword in older browsers, that don\'t support strict mode';
    }
    var that = this;//create closure reference to the new instance
    that.someProperty = 'Use that instead of this';
    that.especially = function()
    {
        console.log(this === that);//see later
        console.log('especially in methods, because they can be borrowed, at which point `this` could reference anything, but here: ' + that + ' Will always be what you expect');
    };
}
var foo = new MyConstructor();
foo.especially();//logs true, and 'especially in methods ...'
bar = [];
foo.especially.apply(bar,[]);//logs false, but the second log will still be the same 
```***

# macos - 如何重命名文件夹中的特定文件？

> ID：13109364
> 
> 赞同：0
> 
> 时间：2012-10-28T13:55:08.473
> 
> 标签：macos, unix, terminal, rename

我现在正在研究 Mac Mountain Lion。我有一个包含大约一千个文件的文件夹，其名称如下：

```
file_1.png
file_2.png
file_3.png
file_4, word_abc.png
file_5.png
file_6, word_xyz.png
...
file_n.png 
```

现在我想选择所有文件并`,`删除其中的所有内容（包括），以便文件显示为：`,``.png``,`

```
file_1.png
file_2.png
file_3.png
file_4.png
file_5.png
file_6.png
...
file_n.png 
```

我不知道该怎么做，但要手动重命名这些文件。我想知道是否有任何“自动”方法来处理这个问题。你能提供一点帮助吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:00:23.277

这是一种使用方法`sed`：

```
for i in *,*; do mv "$i" "$(echo $i | sed 's/,.*/.png/')"; done 
```

# sql - 匹配 SQL 连接中的两列

> ID：13109370
> 
> 赞同：1
> 
> 时间：2012-10-28T13:55:41.810
> 
> 标签：sql, sql-server

我有以下表结构：

表：CashStatus（“ATM”可以有重复条目）

```
ATM  Cash   Device
A01  55     BASE
A01  1      IST
A02  1      BASE
A02  78     IST 
```

表：ATM（ATM 列的唯一条目）

```
ATM   DEVICE
A01   BASE
A02   IST 
```

我只想从`CashStatus`表中检索`ATM & Device`Column 与`ATM`Table匹配的那些行

我做了一些研究并尝试了以下查询：-

```
SELECT *
  FROM CashStatus 
 WHERE EXISTS (SELECT 'X'
                 FROM ATM
                WHERE ATM = TermId collate SQL_Latin1_General_CP1_CI_AS
               AND DeviceName = Devicetype collate SQL_Latin1_General_CP1_CI_AS); 
```

但它给出了错误：`Expression type int is invalid for COLLATE clause.`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T14:06:12.817

```
SELECT columnLists
FROM CashStatus cs JOIN ATM a ON cs.ATM = a.ATM AND cs.Device = a.Device 
```

COLLATE 是用于更改列的语言排序规则的关键字；数字数据类型从来没有必要，在这里可能也没有必要（因为您要从一种语言更改为同一种语言）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:02:31.750

您应该能够使用 2 列连接两个表：

```
SELECT a.*
FROM CashStatus a
INNER JOIN ATM b ON a.ATM = b.ATM AND a.DEVICE = b.DEVICE 
```

这会给你想要的结果吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:04:10.887

```
SELECT *
FROM CashStatus
LEFT JOIN ATM ON CASHSTATUS.ATM=ATM.ATM and CASHSTATUS.DEVIDE=ATM.DEVICE 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T14:57:34.260

有几个答案基本相同的观点，每个观点都收到一个神秘的评论，即结果不符合预期。也许您可以提供正确输出的示例。以下是一个完整的示例：

```
declare @CashStatus as Table ( ATM VarChar(3), Cash Int, Device VarChar(4) )
insert into @CashStatus ( ATM, Cash, Device ) values
  ( 'A01', 55, 'BASE' ),
  ( 'A01',  1, 'IST' ),
  ( 'A02',  1, 'BASE' ),
  ( 'A02', 78, 'IST' )

declare @ATM as Table ( ATM VarChar(3), Device VarChar(4) )
insert into @ATM ( ATM, Device ) values
  ( 'A01', 'BASE' ),
  ( 'A02', 'IST' )

select CS.ATM, CS.Cash, CS.Device
  from @CashStatus as CS inner join
    @ATM as A on A.ATM = CS.ATM and A.Device = CS.Device 
```

# c - fork() 阻塞父进程

> ID：13109373
> 
> 赞同：0
> 
> 时间：2012-10-28T13:55:52.997
> 
> 标签：c, posix, fork, nonblocking

我正在尝试使用 fork() 以非阻塞方式在程序内部运行程序。

```
pid = fork();

//check for errors
if (pid < 0) {
    exit(1);
}

//the child process runs the gulp
if (pid == 0) {
    if (execv("/home/gulpSniffer/programname", args) < 0) {
        exit(1);
    }
    //child is supposed to block here
}

//father is supposed to continue its run from here 
```

但是子进程中程序的调用阻塞了整个程序，而父代码段因为被子进程阻塞而没有被执行。

有谁知道为什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:17:12.273

你是否`wait`为子进程终止于父进程？这将阻塞，直到孩子实际终止。

或者也许你有自己的 SIGCHLD 信号处理程序，它以某种方式阻塞？

想不出任何其他方式可以让孩子阻止父级（嗯，除了任何进程间锁定机制，但你会知道你是否使用过这些）。

此外，如果您不关心子进程何时结束，则应设置

`signal(SIGCHLD, SIG_IGN);`

这样系统应该会自动收割退出的孩子，而你不会以僵尸告终。

# r - Bootstrap 双向大数据集

> ID：13109383
> 
> 赞同：0
> 
> 时间：2012-10-28T13:56:54.653
> 
> 标签：r, statistics-bootstrap

> **可能重复：**
> [引导大型数据集](https://stackoverflow.com/questions/13104339/bootstrap-a-large-data-set)

我想引导一个包含多个列和行变量的大型双向数据集。我必须保留行和列变量。结果应该是一个列表，其中包含每个行变量的所有列变量的引导程序。我正在提供所需的代码来回答我的问题，但我认为它并不优雅。我将不胜感激更好更快的代码。以下是对双向数据集的简化重新创建：

```
rm(list=ls())

data <- 1:72 
```

创建一个双向矩阵数据：

```
charDataDiff <- matrix(data, nrow=9,ncol=8)
varNames <- c("A", "B", "C","A", "B", "C","A", "B", "C") 
```

向 charDataDiff 矩阵添加一个字符列：

```
charDataDiff <- cbind(varNames ,data.frame(charDataDiff)) 
```

添加列名：

```
colnames(charDataDiff) <- c("patchId","s380","s390","s400","s410","s420","s430","s440","s450") 
```

使用行变量“patchId”作为标准分隔数据。这将创建三个列表：每个变量一个

```
idColor <-  c("A", "B", "C")

(patchSpectrum <- lapply(idColor, function(idColor) charDataDiff[charDataDiff$patchId==idColor,])) 
```

创建函数 sampleBoot 对 patchSpectrum 进行采样

```
sampleBoot <-  function(nbootstrap=2, patch=3){
    return(lapply(1:nbootstrap, function(i)
             {patchSpectrum[[patch]][sample(1:nrow(patchSpectrum[[patch]]),replace=TRUE),]}))} 
```

列表“k”回答了我的问题。但是，我认为我的代码对于大型数据集和大型引导程序来说很慢。我只为三个行变量引导 10 次迭代。感谢更快更优雅的代码。

```
numBoots <- 10
for (i in 1: numBoots)
        k <- lapply(1:3, function(n)
                    do.call(rbind, lapply(sampleBoot(i, n), function(x) apply(x[-1], 2, median))))
k 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T15:08:09.233

我可以提供的是对您的代码的干净重写：

1.  我把长片段分解成适当命名的函数，所以它读起来更好，
2.  我删除了该`varNames`列，而是`by`按照@KenWilliams 在您之前的问题中所建议的那样拆分您的数据，
3.  我使用了`replicate`代替`lapply`，
4.  我摆脱了`for`我在评论中指出的不必要的循环。

它应该以这种方式运行得更快；如果不是，我建议您尝试对其进行分析。

* * *

```
charDataDiff <- matrix(1:72, nrow = 9, ncol = 8)
colnames(charDataDiff) <- c("s380", "s390", "s400", "s410",
                            "s420", "s430", "s440", "s450")

varNames      <- c("A", "B", "C", "A", "B", "C", "A", "B", "C")
patchSpectrum <- by(charDataDiff, varNames, data.frame)

sampleOne   <- function(x) x[sample(seq_len(nrow(x)), replace = TRUE), ]
sampleBoot  <- function(x, n) replicate(n, sampleOne(x), simplify = FALSE)
applyMedian <- function(l) do.call(rbind, lapply(l, apply, 2, median))

k <- lapply(lapply(patchSpectrum, sampleBoot, n = 10), applyMedian) 
```

# gdb - gdb：中断与运行

> ID：13109389
> 
> 赞同：0
> 
> 时间：2012-10-28T13:57:37.350
> 
> 标签：gdb, breakpoints

假设我`break my_func`在 gdb 中设置了一个断点，然后键入`run`. gdb 执行代码，直到遇到断点。但是当我`run`再次击中时会发生什么？

gdb 会继续进入断点代码，还是会跳过断点，还是会从第 1 行重新启动代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:39:40.360

> 但是当我再次点击运行时会发生什么？

程序重新启动。

如果要“越过断点”并继续执行，请使用`continue`命令。

# java - 变量的定义

> ID：13109391
> 
> 赞同：1
> 
> 时间：2012-10-28T13:57:45.240
> 
> 标签：java, multithreading

我对变量的声明有疑问。我正在尝试使用多线程准备代码，但我在声明变量时遇到问题。现在我很困惑，是否可以将 Scanner 放入第二个而不是主类 - 我想是的，但我不知道如何声明变量。异常是 -***线程“主”java.lang.RuntimeException 中的异常：无法编译的源代码 - 无法从*** test1.PIN.main 的静态上下文中引用非静态变量 ...

```
public class PIN{

    static int a;

class Runner extends Thread{

public void run(){

    Scanner sc = new Scanner(System.in);
    for(int i= 1; i<4; i++){
    System.out.println("PUT your PIN: ");
    int a = sc.nextInt();

                try {
                    Thread.sleep(100);
                } catch (InterruptedException ex) {
                    Logger.getLogger(PIN.class.getName()).log(Level.SEVERE, null, ex);
                }

 if(a ==1234){
     System.out.println("PIN  OK");
 } else {System.out.println("PIN NOK");}   

}
}
}

public static void main(String[] args){

    Runner r = new Runner();
    r.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:01:27.347

声明`Runner` `static inner class`。非静态内部类是实例绑定的，因此您需要外部类实例来创建非静态内部类的对象。而且因为你的内部类不是静态的，你不能在里面访问`main`它`static-context`

```
static class Runner extends Thread 
```

# linux-kernel - 在linux内核中，asm还是asm-generic？

> ID：13109396
> 
> 赞同：11
> 
> 时间：2012-10-28T13:58:09.533
> 
> 标签：linux-kernel

在 mm/memory.c 中，它包含一个文件：

```
#include <asm/tlb.h> 
```

**tlb.h**是`include/asm-generic/tlb.h`还是`arch/arm/include/asm/tlb.h`？_

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T02:22:01.883

如有必要， 中的头文件`arch/arm/include/asm`将包含 中的相应头文件`include/asm-generic`。

所以在这种情况下，`tlb.h`是`arch/arm/include/asm/tlb.h`。如有必要，它将包括`include/asm-generic/tlb.h`.

您可以通过运行以下命令来验证这一点：

```
# The memory.s target creates the assembly file for memory.c
make mm/memory.s 
```

由此，您可以确定正在使用哪个头文件。

# javascript - 滑块在 Firefox 和 chrome 上不起作用

> ID：13109400
> 
> 赞同：0
> 
> 时间：2012-10-28T13:58:48.663
> 
> 标签：javascript, jquery

我为一个项目构建了一个简单的滑块。我在 chrome 和 firefox 中对其进行了测试，但它不起作用，但它可以正常工作 IE10 发布预览。这是滑块的小提琴[http://jsfiddle.net/VhtWh/2/](http://jsfiddle.net/VhtWh/2/)

这是滑块代码

```
$(document).ready(function() {

    // Let's make the first slide visible and hide the rest
    $('#homepage-slides li').css('top','0').hide();
    $('#homepage-slides li:first').addClass('slideActive').show().find('.slide-content').animate({left: '0', opacity: 1.0}, 800);

    // Find all of the slides
    var slides = $('#homepage-slides li');
    var current = 0;

    // Set up the slideshow
        $('#homepage-slider .arrow').click(function(){
            var li          = slides.eq(current);
            var nextIndex   = 0;

            // Depending on whether this is the next or previous
            // arrow, calculate the index of the next slide accordingly.

            if($(this).hasClass('slide-right')){
                nextIndex = current >= slides.length-1 ? 0 : current+1;
            } else {
                nextIndex = current <= 0 ? slides.length-1 : current-1;
            }

            var next = slides.eq(nextIndex);

            current = nextIndex;

            // Show next slide and slide/fade in the content
            next.addClass('slideActive').fadeIn('slow').find('.slide-content').animate({left: '0', opacity: 1.0}, 800);

            // Hide all other slides and slide/fade out the content
            li.removeClass('slideActive').fadeOut('slow').find('.slide-content').animate({left: '-2400', opacity: 0}, 800);

            // Hide next arrow after last slide
            if ( nextIndex >= slides.length-1 ) {
                $('#homepage-slider .arrow').addClass('hide');
            }
        });
}); 
```

PS：导航链接没有像chrome和firefox中设置的那样突出显示，但在IE10中完美运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:08:17.100

您的 z-index 有问题。箭头不在滑块的顶部。

避免将 999 用于您的 z 索引。他们没有帮助。使用像 1、2、3 这样的值会更有意义。

我更新了 JSFiddle：http: [//jsfiddle.net/VhtWh/3/](http://jsfiddle.net/VhtWh/3/)

现在，箭头有`z-index: 3`，滑块有`z-index: 2`。

这是代码：

```
#homepage-slider {
  background: #050402;
  min-width: 940px;
  position: relative;
  min-height: 450px;
  z-index: 1;
}
#homepage-slider .slide-right,
#homepage-slider .slide-left {
  color: white;
  font-size: 14px;
  height: 23px;
  margin-top: -26px;
  opacity: 0.7;
  padding: 63px 10px 5px;
  position: absolute;
  text-align: center;
  text-transform: uppercase;
  top: 50%;
  width: 52px;
  z-index: 3;
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  border-radius: 10px;
}
#homepage-slider .slide-right {
  right: 30px;
  background: url(../../img/left.png) no-repeat scroll 10px 10px rgba(0, 0, 0, 0.4);
}
#homepage-slider .slide-right:hover {
  cursor: pointer;
  opacity: 1.0;
}
#homepage-slider .slide-left {
  left: 20px;
  display: none;
}
#homepage-slider #homepage-slides {
  height: 450px;
  list-style: none;
  margin: 0;
  min-width: 940px;
  position: relative;
  z-index: 2;
}
#homepage-slider #homepage-slides li {
  margin: 0;
  min-width: 940px;
  width: 100%;
  height: 336px;
  z-index: 2;
  position: absolute;
  padding: 118px 0 0;
}
#homepage-slider #homepage-slides li .span7 {
  position: relative;
  height: 336px;
}
#homepage-slider #homepage-slides li .slide-content {
  position: absolute;
}
#homepage-slider #homepage-slides li .slide-content h1 {
  font-size: 48px;
  color: white;
  margin: 21px;
}
#homepage-slider #homepage-slides li .slide-content p {
  color: #999999;
  font-size: 30px;
  letter-spacing: -0.015em;
  letter-spacing: -1px;
  line-height: 36px;
  margin-bottom: 26px;
}​ 
```

# algorithm - N-Queens 谜题的最佳复杂度是多少？

> ID：13109402
> 
> 赞同：11
> 
> 时间：2012-10-28T13:58:54.447
> 
> 标签：algorithm, complexity-theory, n-queens

N皇后谜题理论上可以在多项式时间内解决吗？如果是这样，它的最佳复杂性是什么？我找到了很多算法，但我还没有找到时间复杂度到底是多少。是否有任何文件或文件给出了其复杂性的确切数字？

（PS 显式解法很有意思，但我忘了说，我希望找到所有的解法。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T14:17:07.883

该链接引用了一个“众所周知的”显式解决方案。它可以在线性时间内计算：

[http://www.chegg.com/homework-help/questions-and-answers/poor-man-sn-queens-problemn-queens-arranged-nxn-chessboard-way-queen-checks-queen-queen-q1009394](http://www.chegg.com/homework-help/questions-and-answers/poor-man-s-n-queens-problemn-queens-arranged-n-x-n-chessboard-way-queen-checks-queen-queen-q1009394)

> 1.  n 是偶数，但不是 (n mod 6 = 2) 形式。将皇后放在正方形 (m, 2m) 和 (n/2 +m, 2m-1) 上，因为 m = 1, 2, 。. . , n/2
>     
>     
> 2.  n 是偶数，但不是 (n mod 6 = 0) 形式并且将皇后放在正方形 (m, 1+(2(m-1)+ n/2 - 1)mod n) 和 (n+1-m , n-(2(m-1)+n/2 -1)mod n) 对于 m = 1,2,...,n/2
>     
>     
> 3.  n 是奇数。在 n - 1 上使用 (1) 或 (2)，无论哪个合适，并在 (n,n) 处扩展一个皇后。

请注意，枚举所有解决方案将花费更长的时间。解的数量随着棋盘的大小呈超指数增长（[http://oeis.org/A000170](http://oeis.org/A000170)），因此即使随着`2^O(x)`时间的推移也无法枚举（但只`O(n)`需要空间）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:05:39.887

您的意思是找到一种解决方案还是所有解决方案？根据维基百科，如果你只想找到一种解决方案，这可以很简单地完成。

> 存在用于将 n 个皇后放置在 n × n 板上的显式解决方案，不需要任何组合搜索。

# android - AppWidgetHostView 不能处理任何点击事件？

> ID：13109404
> 
> 赞同：1
> 
> 时间：2012-10-28T13:59:01.090
> 
> 标签：android

我正在创建一个 android 启动器并希望实现 appWidgets。为了进行测试，我正在使用`com.android.quicksearchbox`小部件并将其添加到屏幕顶部。问题是，我正在使用 AppWidgetHostView，它似乎没有注意到用户所做的任何点击或触摸事件。谁能告诉我为什么？这是我所有的 appWidgets 代码（在`onCreate(Bundle)`函数中）：

```
 android.appwidget.AppWidgetManager appWidgetManager = android.appwidget.AppWidgetManager.getInstance(this);
    android.appwidget.AppWidgetHost appWidgetHost = new android.appwidget.AppWidgetHost(this, 0);
    android.appwidget.AppWidgetProviderInfo newAppWidgetProviderInfo = new android.appwidget.AppWidgetProviderInfo();

    int appWidgetId = appWidgetHost.allocateAppWidgetId();

    List<android.appwidget.AppWidgetProviderInfo> appWidgetInfos = new ArrayList<android.appwidget.AppWidgetProviderInfo>();
    appWidgetInfos = appWidgetManager.getInstalledProviders();

    for(int j = 0; j < appWidgetInfos.size(); j++)
    {
        if (appWidgetInfos.get(j).provider.getPackageName().equals("com.android.quicksearchbox"))
        {

            newAppWidgetProviderInfo = appWidgetInfos.get(j);
            break;
        }
     }

    android.appwidget.AppWidgetHostView hostView = appWidgetHost.createView(this, appWidgetId, newAppWidgetProviderInfo);
    hostView.setAppWidget(appWidgetId, newAppWidgetProviderInfo);

    android.widget.LinearLayout ll = (android.widget.LinearLayout) findViewById(R.id.loll);
    ll.addView(hostView, 0); 
```

大声笑是我的线性布局。

所以有人知道我怎样才能启用事件吗？或者，如果有另一种将应用程序小部件添加到我的启动器的方法？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:29:29.083

我不确定代码是否完整，但您至少需要在活动中添加以下内容。

```
@Override
 protected void onStart() {

    super.onStart();

    Host.startListening();

}

@Override

protected void onStop() {

    super.onStop();

    Host.stopListening();

} 
```

这有意义吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-24T15:19:40.063

您需要绑定小部件以使其具有交互性并允许其更新：

```
boolean allowed = mAppWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId, newAppWidgetProviderInfo.provider);

if (!allowed) {
    // Request permission
    Intent intent = new Intent(AppWidgetManager.ACTION_APPWIDGET_BIND);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_PROVIDER, newAppWidgetProviderInfo.provider);
    final int REQUEST_BIND_WIDGET = 1987;
    myActivity.startActivityForResult(intent, REQUEST_BIND_WIDGET);
} 
```

此外，正如@Sergey 的回复中所述，您需要在您的活动或片段中添加以下内容：

```
@Override
 protected void onStart() {
    super.onStart();
    appWidgetHost.startListening();
}

@Override
protected void onStop() {
    super.onStop();
    appWidgetHost.stopListening();
} 
```

# javascript - TypeScript 闭包范围错误：名称在当前范围中不存在

> ID：13109413
> 
> 赞同：1
> 
> 时间：2012-10-28T13:59:56.260
> 
> 标签：javascript, typescript

有谁知道为什么**test1**无法编译？

```
class Y { public myMethod: any; };
class QQ { public test(name, fun: () => any) { } }

var qq = new QQ();
qq.test("Run test1", () => {

        var outer = 10;

        Y.prototype.myMethod = () => {

          // Error: The name 'outer' does not exist in the current scope
            outer = 11;
        }
}); 
```

但以下工作：

```
 qq.test("Run test2", () => {

            var outer = 10;
            var fun = ()=> { outer = 11; };

            Y.prototype.myMethod = fun;
    }); 
```

所需代码的**JavaScript**版本如下所示：

```
qq.test("Run test1", function () {
    var outer = 10;

    Y.prototype.myMethod = function () {
        outer = 11;
    };
}); 
```

外部函数在其闭包中声明了一个变量“outer”，内部函数自然应该可以看到该变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T09:04:52.497

简化为重点：

这是我认为你所期待的 JavaScript。

```
var Y = (function () {
    function Y() { }
    Y.prototype.myMethod = function () {
    };
    return Y;
})();
var QQ = (function () {
    function QQ() { }
    QQ.prototype.test = function (name, fun) {
        fun();
    };
    return QQ;
})();
var qq = new QQ();
qq.test("Run test1", function () {
    var _this = this;
    _this.outer = 10;
    Y.prototype.myMethod = function () {
        alert(_this.outer);
    };
});
var y = new Y();
y.myMethod(); 
```

您需要更改您的 TypeScript 以获得此输出：

```
class Y { 
    public myMethod() {

    }
}

class QQ {
    public test(name, fun: () => any) { // updated signature
        fun(); // call the function
    }
}

var qq = new QQ();

qq.test("Run test1", () => {
        this.outer = 10; // use this.
        Y.prototype.myMethod = () => {
            alert(this.outer);
        }
});

var y = new Y();
y.myMethod(); 
```

是的，TypeScript 认为`this.outer`是警报语句中的问题，但无论如何编译正确的 JavaScript。[您可以在http://typescript.codeplex.com](http://typescript.codeplex.com)将其作为错误提出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T09:31:11.850

在 0.8.2 版之前，这是 TypeScript 中的一个错误，此后[已修复](http://typescript.codeplex.com/workitem/341)。

# azure - 美国东部不显示添加 Web 应用程序区域，显示新数据库

> ID：13109424
> 
> 赞同：0
> 
> 时间：2012-10-28T14:00:44.640
> 
> 标签：azure

我正在尝试添加一个网络应用程序，当我进入网站设置时，我只看到美国西部、西欧和北欧。我选择 West US，然后对于 New MySQL Database，我看到 West US、East US、West Europe 和 North Europe。如果我选择美国东部，我会收到一条警告，指出我的数据库和网站位于不同的区域。

Azure 状态页面显示美国东部的网站已启动并运行，过去一周没有停机。这里发生了什么？我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T18:04:54.700

Windows Azure 网站目前处于预览模式，因此数据中心的可用性将取决于预览环境中的可用容量。

一旦 Windows Azure 网站完全发布，它们将在所有数据中心可用。目前还没有任何公告，但本周的 Build 大会上可能会公布更多细节。

问候，

艾伦

# android - ListView 底部的按钮仅在 Eclipse 设计器中工作

> ID：13109427
> 
> 赞同：0
> 
> 时间：2012-10-28T14:01:21.827
> 
> 标签：android, android-layout

我试图在 ListActivity 的底部放置一个按钮。以下内容在 Eclipse 设计器中完美运行，但在我启动手机或 AVD 的应用程序时却不行。

有任何想法吗？

```
<?xml version="1.0" encoding="utf-8"?>
 <RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/btn_New" >
    </ListView>

    <Button
        android:id="@+id/btn_New"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="Button"
        android:layout_alignParentBottom="true" />
</RelativeLayout> 
```

按钮在设计器中正确显示 ![按钮在设计器中正确显示](../Images/604ee330ec75645a341058db03632d53.png)

按钮未出现在我的手机或 AVD 上 ![按钮未出现在我的手机或 AVD 上](../Images/ab5b67312161916ad9a6330de9c2a18c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T17:56:35.163

you may add a footer to your ListView. you can use the example provided in this [link](https://stackoverflow.com/questions/4265228/how-to-add-footer-in-list-view/4265324#4265324)

```
View footerView = ((LayoutInflater)      
ActivityContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE)).inflate(R.layout.footer_layout, null, false);
ListView.addFooterView(footerView); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:03:51.413

您必须将按钮放在列表之前：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<Button
    android:id="@+id/btn_New"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="Button"
    android:layout_alignParentBottom="true" />

<ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@+id/btn_New" >
</ListView>
</RelativeLayout> 
```

所以布局充气器可以“看到”列表必须位于哪个视图之上

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T18:36:59.813

这完全是我的错误。我的活动是扩展 SherlockListActivity，而不是 SherlockActivity。所以当然 Button 没有显示。

谢谢你的帮助，凯瑟尔

# ios - ios6 visibleMapRect 不正确

> ID：13109430
> 
> 赞同：0
> 
> 时间：2012-10-28T14:01:36.790
> 
> 标签：ios, mkmapview, mkmapviewdelegate

我有一个以特定位置为中心的启动应用程序。

```
//Calculate and set new center point
CLLocationCoordinate2D zoomLocation = CLLocationCoordinate2DMake(<some lat>,<some long>);

MKCoordinateSpan span;
span.latitudeDelta = 0.08;
span.longitudeDelta = 0.08;

//MKCoordinateRegion region = MKCoordinateRegionMake(zoomLocation, span);
MKCoordinateRegion region = [mapView regionThatFits:MKCoordinateRegionMake(zoomLocation, span)];

[mapView setRegion:region animated:YES];
[self refreshMap]; 
```

对 refreshMap 的调用会尝试计算地图的边界框，以便我可以在数据库中查询相应的信息。

```
//Calculate map's bounding box
MKMapRect mapRect = [mapView visibleMapRect];

MKMapPoint cornerPointNE = MKMapPointMake(MKMapRectGetMaxX(mapRect), mapRect.origin.y);
CLLocationCoordinate2D upperLeft = MKCoordinateForMapPoint(cornerPointNE);

MKMapPoint cornerPointSW = MKMapPointMake(mapRect.origin.x, MKMapRectGetMaxY(mapRect));
CLLocationCoordinate2D lowerRight = MKCoordinateForMapPoint(cornerPointSW);

if( fabs(upperLeft.longitude) > 80.00 || fabs(lowerRight.longitude) > 80.0) {
    return;
} 
```

我看到的问题是，在 iOS 6 中，在应用程序启动时未正确计算 lowerRight 坐标，并且由于 lowerRight.longitude > 80.0，地图数据不会刷新。正确计算了左上角。

在应用程序完成加载后，如果我平移地图，即使是最轻微的边界框计算也是正确的。

此代码在 iOS 5 中运行良好。

除了 mapView:regionDidChangeAnimated 之外，还有其他回调可以使用吗？refreshMap 的其余部分相当密集，我不想影响平移性能。

TIA

**更新**

我似乎找到了解决办法。而不是这样做

```
[mapView setRegion:region animated:YES]; 
```

我把 YES 改成了 NO

```
[mapView setRegion:region animated:NO]; 
```

现在在应用程序启动时正确计算了下角。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:28:42.027

您是否使用 MKMapRectOffset 或 Inset 稍微移动可见矩形。

我也一直在重新阅读你的问题，我可能是错的；但是，我认为 NE 角将是右上角，SW 角将是左下角。而您想要 NW 和 SE 角。

我无法在 Map Kit 参考中确认 mapRect 的原点位于左上角。

# java - 手写签名对比

> ID：13109435
> 
> 赞同：5
> 
> 时间：2012-10-28T14:02:02.353
> 
> 标签：java, comparison, signature

有谁知道java中一种将手写文本样本（例如签名、亲笔签名等）与一个或多个样本进行比较的方法？最好是开源的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:08:25.307

您可以查看此[OCR 小程序](http://www.heatonresearch.com/articles/42/page1.html)。

# macos - 为什么这个脚本只有在我使用延迟时才有效？

> ID：13109439
> 
> 赞同：0
> 
> 时间：2012-10-28T14:02:29.950
> 
> 标签：macos, applescript, delay

我正在编写一个小脚本来自动化注册扑克锦标赛的过程，同时玩其他几张桌子。大堂窗口在后台，在前台有其他桌子在玩的时候弹出。所以为了注册，我需要在前台设置大厅（ctrl + 1）并防止应用程序弹出其他表（我使用了重复循环来执行此操作，但我不确定这是否是最好的方法）。

我不明白为什么，当我将这些延迟设置为 0.5 或 0.2 时，脚本按预期工作，否则如果我在没有它们的情况下运行脚本，它就不起作用（不点击大厅中的注册按钮）。

这很关键，因为在这 0.5 秒内可能会有其他桌子突然出现并从主大厅窃取焦点。请注意，我使用像素坐标来单击按钮，因为它是非 Cocoa 应用程序并且不允许我轻松单击按钮。

我该如何解决这个问题？

```
--REGISTRATION PROCESS
--make sure we complete the reg process without other tables popping up and stealing focus from the tourney reg window
set done to false
repeat until done is true
    delay 0.5
    --Lobby focused
    tell application "System Events"
        set frontmost of process "PokerStarsIT" to true
        keystroke "1" using command down
        delay 0.2
    end tell

    --Start the registration process: click "register" button.
    tell application "PokerStarsIT"
        do shell script quoted form of POSIX path of mouseToolsPath & " -x " & (xCoordinate as text) & " -y " & (yCoordinate as text) & " -rightClick"
        set done to true                
    end tell
end repeat 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T20:18:17.613

我会这样尝试。请注意，我将窗口 1 的名称用作“大厅”。确保输入窗口的实际名称，即那里的大厅窗口。您还会注意到“do shell script”命令不在 PokerStarsIT 应用程序 tell 代码块内。“do shell script”是一个applescript 命令，而不是PokerStarsIT 命令。另外我认为你应该做“-leftClick”而不是“-rightClick”。祝你好运。

```
tell application "PokerStarsIT" to activate
tell application "System Events"
    tell process "PokerStarsIT"
        repeat
            keystroke "1" using command down
            if name of window 1 is "Lobby" then exit repeat
        end repeat
    end tell
end tell

--Start the registration process: click "register" button.
do shell script quoted form of POSIX path of mouseToolsPath & " -x " & (xCoordinate as text) & " -y " & (yCoordinate as text) & " -leftClick" 
```

# android - android:layout_marginRight 属性在 RelativeLayout 上不起作用

> ID：13109441
> 
> 赞同：7
> 
> 时间：2012-10-28T14:02:31.917
> 
> 标签：android, android-layout

我有一个带有 2 个图像的内部相对布局，当我设置 android:layout_marginRight 属性时，它什么也不做。

这是我的代码：

```
<RelativeLayout
    android:id="@+id/location_image_layout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerVertical="true" >

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="80dp" />

    <ImageView
        android:layout_width="69.33dp"
        android:layout_height="72dp"
        android:background="@drawable/icon"
        android:layout_centerInParent="true" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-30T04:34:16.143

问题出在布局的属性`android:layout_width`中。当它设置为`"wrap_content"`时，`android:layout_marginRight`将不起作用，而是只有当它设置为时`"fill_parent"`，`android:layout_marginRight`才会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:32:45.600

您使用了以下内容，这就是它发生的原因

```
android:layout_alignParentRight="true" 
```

只需删除此行，您将在图像视图中从右侧获得边距..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T18:10:29.907

```
<LinearLayout
    android:id="@+id/location_image_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="right"
    android:orientation="vertical" >

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="80dp" />

    <ImageView
        android:layout_width="69.33dp"
        android:layout_height="72dp"
        android:background="@drawable/icone"
        android:layout_centerInParent="true" />

</LinearLayout> 
```

试试这个。它对我有用，并且完全符合您的要求

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-22T03:28:00.330

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    ...
/> 
```

我遇到了同样的问题，如果您将父级 RelativeLayout 的 layout_width 更改为“match_parent”，它就可以工作。希望它也适合你。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-10-29T05:14:25.750

尝试使用 LinearLayout 而不是 RelativeLayout 在布局中应用 Margin。

# javascript - TypeScript 到 js 错误

> ID：13109442
> 
> 赞同：2
> 
> 时间：2012-10-28T14:02:33.420
> 
> 标签：javascript, typescript

我正在尝试将关于结合 createjs 和 box 2d 的豪华动物教程转换为 Typescript。到目前为止，我正在制造的混乱似乎正在奏效。但现在我`Uncaught TypeError: Cannot call method 'push' of undefined`在这条线上得到了一个：

```
this.actors.push(this); 
```

但是`actors` 在 .ts 上定义为`private actors = [];`. 我尝试了可能的方法，但没有任何工作。有谁知道发生了什么？

app.ts => [http://paste.laravel.com/8HM](http://paste.laravel.com/8HM) default.html => [http://paste.laravel.com/8HN](http://paste.laravel.com/8HN)

使用 VS 2012。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:05:27.990

试试你的数组的类型`private actors:TYPE[] = [];`在哪里`TYPE`，例如字符串数组`private actors:string[] = [];`

这似乎对我有用。

如果不是，那么可能会发布更多代码 - 我无法从您发布的链接中将您的 .ts 文件显示在源代码视图中，而且我无法判断页面中的哪个（几个）脚本问题是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T17:42:42.760

好的，所以问题在于它不是`actorObject`作为方法调用，而是将其创建为对象：`new Box2d.actorObject`。

我刚刚制作的是它自己的一类，现在一切都很漂亮。

# c# - Directory.EnumeratedDirectorties 在执行前是否被推迟？

> ID：13109443
> 
> 赞同：0
> 
> 时间：2012-10-28T14:02:34.823
> 
> 标签：c#

我正在使用以下代码

`var allFolderPaths = Directory.EnumerateDirectories(this.sourceFolder, "*.*", SearchOption.AllDirectories);`

我遇到的问题是在 foreach 循环期间（迭代 allFolderPaths 变量，如上所示），它失败了，因为找不到目录。

现在，以下代码本身不查看目录等，它只是一个字符串循环：

```
foreach (string folder in StringList)
{
       /dostuff 
} 
```

但是，当我更新代码以使用 allFolderPaths 时（根据本文中的第一个示例）

```
foreach (string folder in allFolderPaths)
{
       /dostuff 
} 
```

由于“访问路径被拒绝”而失败！

那么，这是否意味着变量 allFolderPaths 在分配给它时实际上并未“分配”（如果这有意义的话）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:10:28.053

Directory.EnumerateFiles() 返回一个 IEnumerable<>，它仅在您实际枚举可枚举...（又名“延迟执行”）时“执行”。

如果你想强制 EnumerateFiles 立即执行，你可以添加一个 .ToList() （又名“memoization”）。

例子：

```
 var allFolders = Directory.EnumerateDirectories(this.sourceFolder, "*.*", SearchOption.AllDirectories).ToList(); 
```

AccessDenied 异常的原因是您试图枚举一个您无权枚举的目录；您是否正在查看“我的文档”或类似内容？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:16:21.557

代码中的 allFolderPaths 变量属于`IEnumerable<string>`. 这确实意味着在您开始使用 foreach 循环枚举磁盘之前，您不会访问磁盘。

在这种情况下“找不到目录”异常是不太可能的，因为它的名称是在一毫秒前检索到的。但并非完全不可能，文件系统可以在其他进程访问磁盘时即时更改。

极有可能出现“拒绝访问”异常，尤其是在您迭代驱动器的根目录时。即使管理员也无法访问“系统卷信息”文件夹。您需要捕获此异常并继续。避免它们的一个好方法是使用 DirectoryInfo.Attributes。如果目录是隐藏和系统，那么您几乎总是希望避开这样的目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:06:27.437

不，这意味着您的进程正在尝试访问它没有权限的文件/目录。

# php - 由于使用 google apps smtp 发送电子邮件而导致网站延迟

> ID：13109454
> 
> 赞同：0
> 
> 时间：2012-10-28T14:04:51.367
> 
> 标签：php, smtp, google-apps

我使用 yii 应用程序内部的谷歌应用程序 smtp 登录发送电子邮件。效果很好。问题是它在按下提交和获得响应页面之间产生了几秒钟的延迟。如何在我的 ubuntu 上创建一个代理 smtp，该代理 smtp 将邮件作为 localhost（即时）接收，并在单独的线程上使用 google smtp 发送而不被 php 线程阻塞。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:10:01.343

我会实施一种中继传递。将电子邮件详细信息存储在某处（数据库或文件）将其标记为待发送，并为用户提供即时响应以避免您所说的延迟。然后我可能会设计一些使用 cron 运行（例如每分钟）并传递所有待处理消息的 php 脚本。

# knockout.js - 我可以在自定义绑定中动态绑定元素吗？

> ID：13109455
> 
> 赞同：2
> 
> 时间：2012-10-28T14:04:54.060
> 
> 标签：knockout.js, ko-custom-binding

有没有办法从自定义绑定内部绑定元素？例如，我有自定义绑定并将其绑定到可观察的项目数组：

```
var someArrayOfItems = ko.observableArray(['item1', 'item2', 'item3']);
...
<div data-bind="myBinding: someArrayOfItems"></div> 
```

现在我希望 myBinding 列出它必须喜欢的 div 元素内的“someArrayOfItems”中的所有元素：

```
<ul data-bind="foreach: someArrayOfItems">
    <li>
        <span data-bind="text: $data"></span>
    </li>
</ul> 
```

是否可以使用自定义绑定进行此类操作？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-28T14:39:30.887

您可以使用该函数`ko.applyBindingsToNode`动态地将绑定添加到元素。

在您的情况下，您还需要使用适当的“模板”填充内容。

例如，您可以执行以下操作：

```
ko.bindingHandlers.myBinding = {
    init: function(element, valueAccessor) {
        var ul = document.createElement("ul"),
            data = valueAccessor();

        //append a new ul to our element
        element.appendChild(ul);

        //could use jQuery or DOM APIs to build the "template"
        ul.innerHTML = "<li><span data-bind='text: $data'></span></li>";

        //apply foreach binding to the newly created ul with the data that we passed to the binding
        ko.applyBindingsToNode(ul, { foreach: data });;

        //tell Knockout that we have already handled binding the children of this element
        return { controlsDescendantBindings: true };
    }        
}; 
```

示例：http: [//jsfiddle.net/rniemeyer/z458E/](http://jsfiddle.net/rniemeyer/z458E/)

# json - 使用 JAX-RS 的 JSON 响应

> ID：13109456
> 
> 赞同：0
> 
> 时间：2012-10-28T14:04:56.570
> 
> 标签：json, jaxb, jax-rs

我有一个简单的 POJO，我将其转换为 JSON 对象。

```
@XmlRootElement
public class Data {
    public Data(){}
    private int roll;
    private String name;
    public int getRoll() {
        return roll;
    }
    public void setRoll(int roll) {
        this.roll = roll;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
} 
```

这将转换为一个简单的 JSON 对象

```
{
name: "Adrian",
roll: 77
} 
```

这部分很好。现在我所有的 json 在我的系统中重新调整，将在名为 object lile 的数据中包含该对象

```
{
app_name:abc,
app_version:1
data:
{
   user :
   {
     name: "Adrian",
     roll: 77
   }

} 
```

无论我向客户发送什么类型的对象，我都希望它们属于这种类型。谁能告诉我如何做到这一点？

亲切的问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T08:15:47.820

如果要将`Data`实例包装到某种包装器中，请使用适当的 JAXB 注释编写一个类：

```
@XmlRootElement
public class DataWrapper {

    private Data data;
    private String app_name;
    private int app_version;

    // Constructors, Getter, Setter
} 
```

然后您的 JAX-RS 方法将创建这样一个`DataWrapper`并返回它：

```
@GET
public Response getDataWrapper() {
    DataWrapper dw = new DataWrapper(app_name, app_version, new Data(...));
    return Response.ok(dw).build();
} 
```

# wordpress - 如何在单个 WordPress 页面上单独编辑元素？

> ID：13109458
> 
> 赞同：1
> 
> 时间：2012-10-28T14:05:26.737
> 
> 标签：wordpress, templates, layout

我已经在 WordPress 中创建了一个主题，我可以使用插件“前端编辑器”来编辑页面。现在我想知道是否可以将一页拆分为可以单独编辑的不同元素？如果我可以为每个元素创建一个模板并用这些元素的组合构建单个页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:37:04.480

是的。使用 wordpress 函数 get_template_part() 它在同一主题文件夹中没有 .php 扩展名的文件上像标准 php include() 一样工作。例如，要为您的页面添加标准标题，请添加：

```
 <?php get_template_part('header'); ?> 
```

但是，为了能够在 wp-admin 中轻松编辑页面的某些部分（即在多个页面中重用页面的某些部分），我想说的最原生的方式是为此目的使用小部件。像“查询帖子” [http://wordpress.org/extend/plugins/query-posts/](http://wordpress.org/extend/plugins/query-posts/)这样的小部件可用于将博客文章甚至页面内容放入小部件中，因此您将获得所需的内容。

# jpa - Eclipselink 2.4 + JPA + ManyToMany 附加列

> ID：13109463
> 
> 赞同：2
> 
> 时间：2012-10-28T14:05:41.550
> 
> 标签：jpa, jpa-2.0, eclipselink

我正在使用 Eclipselink 提供的 JPA 实体用 Java 开发学生管理器应用程序。我试图在两个实体之间实现多对多关系一段时间，但我遇到了一些奇怪的异常。

我的实现基于： [ManyToMany 关系的 Java 持久性 Wiki 页面](http://en.wikibooks.org/wiki/Java_Persistence/ManyToMany#Mapping_a_Join_Table_with_Additional_Columns)和[这个 StackOverflow 帖子](https://stackoverflow.com/questions/878374/how-do-you-set-up-a-many-to-many-relationship-with-junction-table-using-jpa-ecli)。

这是我的**Homework.java**文件的相关部分：

```
@Entity
@Table(name = "db_homework")
public class Homework {
    @Id
    @GeneratedValue(strategy = IDENTITY)    
    private long id;

    ... other fields and connections ...

    @OneToMany(mappedBy = "semester")
    private Collection<SemesterHomework> semesters;

    ... getters/setters ...
} 
```

**学期.java：**

```
@Entity
@Table(name = "db_semester")
public class Semester {
    @Id
    @GeneratedValue(strategy = IDENTITY)    
    private long id;

    ... other fields and connections ...

    @OneToMany(mappedBy = "homework")
    private Collection<SemesterHomework> homeworks;

    ... getters/setters ...
} 
```

**学期作业.java：**

```
@Entity
@Table(name="db_semesterhomework")
@IdClass(SemesterHomeworkPK.class)
public class SemesterHomework {
    @Id
    @ManyToOne(optional=false)  
    @PrimaryKeyJoinColumn(name="HOMEWORK_ID", referencedColumnName="ID")
    private Homework homework;

    @Id
    @ManyToOne(optional=false)  
    @PrimaryKeyJoinColumn(name="SEMESTER_ID", referencedColumnName="ID")
    private Semester semester;

    @Column
    @Temporal(TemporalType.TIMESTAMP)
    private Date finishTime;
    ... getters/setters ...
} 
```

**学期作业PK.java：**

```
public class SemesterHomeworkPK {
    @Id
    @Column(name="SEMESTER_ID")
    private Long semester;
    @Id
    @Column(name="HOMEWORK_ID")
    private Long homework;

    @Override
    public boolean equals(Object arg0) {
        ...
    }

    @Override
    public int hashCode() {
        ...
    }

    ... getters/setters ...
} 
```

我得到的**例外情况：**

```
Exception [EclipseLink-41] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.DescriptorException
Exception Description: A non-read-only mapping must be defined for the sequence number field.
Descriptor: RelationalDescriptor(org.bme.amorg.droidhfsite.server.db.Homework --> [DatabaseTable(db_homework)])

Exception [EclipseLink-41] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.DescriptorException
Exception Description: A non-read-only mapping must be defined for the sequence number field.
Descriptor: RelationalDescriptor(org.bme.amorg.droidhfsite.server.db.Semester --> [DatabaseTable(db_semester)])

Exception [EclipseLink-93] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.DescriptorException
Exception Description: The table [db_homework] is not present in this descriptor.
Descriptor: RelationalDescriptor(org.bme.amorg.droidhfsite.server.db.Semester --> [DatabaseTable(db_semester)])

Exception [EclipseLink-93] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.DescriptorException
Exception Description: The table [db_semester] is not present in this descriptor.
Descriptor: RelationalDescriptor(org.bme.amorg.droidhfsite.server.db.Homework --> [DatabaseTable(db_homework)]) 
```

当我尝试使用 Eclipse JPA 工具生成数据库表时出现异常。

提前感谢您的帮助，彼得。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:34:43.517

不确定这是唯一的问题，但是您的`mappedBy`属性错误。

中的学期列表`Homework`由 的`homework`字段映射`SemesterHomework`。不在`semester`场上。

中的作业列表`Semester`由 的`semester`字段映射`SemesterHomework`。不在`homework`场上。

如果您在`SemesterHomework`.

# compression - 在 MonoMac 中使用压缩保存 JPG

> ID：13109465
> 
> 赞同：1
> 
> 时间：2012-10-28T14:06:11.633
> 
> 标签：compression, jpeg, monomac

这是我用于保存带压缩的 JPG 的 MonoMac 代码。这很简单，只需设置`NSImageCompressionFactor`显然。可惜没用。

```
public void SaveImage(NSImage MyNSImage,string Location, float Quality) 
{
    NSBitmapImageRep BRep=(NSBitmapImageRep)MyNSImage.Representations()[0]; 
    NSDictionary Dic= NSDictionary.FromObjectAndKey(new NSNumber(Quality),new NSString("NSImageCompressionFactor")); 
    NSData D=BRep.RepresentationUsingTypeProperties(NSBitmapImageFileType.Jpeg,Dic); 
    System.IO.Stream S=D.AsStream(); 
    SaveStream(Location,S); 
    S.Dispose(); 
    D.Dispose(); 
} 

//This save function works fine so ignore it.
void SaveStream(string FileName, Stream Source) 
{ 
    FileStream FS=File.OpenWrite(FileName); 
    int Read=0; 
    byte[] Buffer=new byte[1024]; 
    Source.Seek(0, SeekOrigin.Begin); 
    do{ 
        Read = Source.Read(Buffer, 0, 1024); 
        FS.Write(Buffer, 0, Read); 
    }while(Read>0); 
    FS.Close(); 
} 
```

但它总是保存为 100%，我做错了什么？希望有聪明人知道答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:26:55.557

所有这些属性字典都有一个通用的设计模式：它们的键是*字符串常量*（具有该名称的变量），而不是字符串，并且 Objective C 运行时通过地址而不是值来匹配它们。

例如，在您的情况下，`NSImageCompressionFactor`声明为

```
NSString *NSImageCompressionFactor; 
```

在Objective C中，它被初始化为一些常量字符串（理论上可以是任何东西），它基本上是一个指向一些不透明值的指针。

在Objective C 中填充属性字典时，您使用变量的名称（即您只需编写`NSImageCompressionFactor`）而不是创建一个新的字符串实例（`@"NSImageCompressionFactor"`）。

在 MonoMac 中，我们为这些字典键创建字符串属性，例如参见[MonoMac.Foundation.NSUrl.ContentAccessDateKey](http://api.xamarin.com/?link=P%3aMonoMac.Foundation.NSUrl.ContentAccessDateKey)。

但是，它们在一些地方丢失了（您的位图图像属性就是其中之一，我只是将它们添加到`NSBitmapImageRep`monomac [commit 115f1eb 中](https://github.com/mono/monomac/commit/115f1eb120a2dfd14c4524e63fe55645abcda04b)）。如果将来有人发现更多缺失的属性，请简单地在 中提交错误报告`bugzilla.xamarin.com`。

如果您使用的是旧版本的 MonoMac，还有一种解决方法。在生成器输入文件（[monomac/src/appkit.cs](https://github.com/mono/monomac/blob/115f1eb120a2dfd14c4524e63fe55645abcda04b/src/appkit.cs#L1120)）中，这些声明如下：

```
[Field ("NSImageCompressionMethod")]
NSString CompressionMethod { get; }

[Field ("NSImageCompressionFactor")]
NSString CompressionFactor { get; } 
```

然后生成器发出：

```
[CompilerGenerated]
static readonly IntPtr AppKit_libraryHandle = Dlfcn.dlopen (Constants.AppKitLibrary, 0);
[CompilerGenerated]
static NSString _CompressionMethod;
public static NSString CompressionMethod {
    get {
        if (_CompressionMethod == null)
            _CompressionMethod = Dlfcn.GetStringConstant (AppKit_libraryHandle, "NSImageCompressionMethod");
        return _CompressionMethod;
    }
}
[CompilerGenerated]
static NSString _CompressionFactor;
public static NSString CompressionFactor {
    get {
        if (_CompressionFactor == null)
            _CompressionFactor = Dlfcn.GetStringConstant (AppKit_libraryHandle, "NSImageCompressionFactor");
        return _CompressionFactor;
    }
} 
```

你可以简单地在你的应用程序的某个地方做同样的事情。

**更新**

让我们首先从 Objective C 中的一个示例开始（[此处](https://github.com/baulig/Provcon-Faust/commit/5dd4d76199afd503b7aad06f99c9ba0aac37c8c2)为完整示例，图片来自[Wikipedia](http://en.wikipedia.org/wiki/File%3aNeptune.jpg)）：

```
- (NSData *)saveImage:(NSImage *)image location:(NSString *)location quality:(float)quality {
    NSBitmapImageRep *imageRep = [[image representations] objectAtIndex:0];
    NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:[NSNumber numberWithFloat:quality], NSImageCompressionFactor, nil];

    NSData *data = [imageRep representationUsingType:NSJPEGFileType properties:dict];
    printf("DATA: %ld\n", [data length]);
    return data;
}

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    NSString *path = [[NSBundle mainBundle] bundlePath];
    NSString *resDir = [[path stringByAppendingPathComponent:@"Contents"] stringByAppendingPathComponent:@"Resources"];
    NSString *filePath = [resDir stringByAppendingPathComponent:@"Neptune.jpg"];

    NSImage *image = [[NSImage alloc] initWithContentsOfFile:filePath];

    [self saveImage:image location:@"output.jpg" quality:0.0];
    [self saveImage:image location:@"output.jpg" quality:0.25];
    [self saveImage:image location:@"output.jpg" quality:0.5];
    [self saveImage:image location:@"output.jpg" quality:1.0];
} 
```

现在让我们把它变成一个 MonoMac 应用程序（完整示例[在这里](https://github.com/baulig/Provcon-Faust/commit/dbcc9f1f4a6041921565bcbc8b6eee8d66fd437a)）：

```
public override void FinishedLaunching (NSObject notification)
{
    mainWindowController = new MainWindowController ();
    mainWindowController.Window.MakeKeyAndOrderFront (this);

    var path = Path.Combine (NSBundle.MainBundle.BundlePath, "Contents", "Resources");
    var filePath = Path.Combine (path, "Neptune.jpg");

    var image = new NSImage (filePath);
    Console.WriteLine (image);

    SaveImage (image, "output.jpg", 0.0f);
    SaveImage (image, "output.jpg", 0.25f);
    SaveImage (image, "output.jpg", 0.5f);
    SaveImage (image, "output.jpg", 1.0f);
}

public void SaveImage (NSImage image, string location, float quality) 
{
    var brep = (NSBitmapImageRep)image.Representations ()[0];

    var dict = NSDictionary.FromObjectAndKey (NSNumber.FromFloat (quality), NSBitmapImageRep.CompressionFactor);

    var data = brep.RepresentationUsingTypeProperties (NSBitmapImageFileType.Jpeg, dict);
    Console.WriteLine (data.Length);
} 
```

这将打印与 Objective C 示例相同的大小，因此这确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T19:53:19.237

好的，我越来越近了，但它仍然可以节省 100%，还有其他建议吗？：

```
public void SaveImage(NSImage MyNSImage,string Location, float Quality) 
{

            NSBitmapImageRep BRep=(NSBitmapImageRep)MyNSImage.Representations()[0];
            NSDictionary Dic= NSDictionary.FromObjectAndKey(new NSNumber(Quality),NSImageCompressionFactor);
            NSData D=BRep.RepresentationUsingTypeProperties(NSBitmapImageFileType.Jpeg,Dic);
            System.IO.Stream S=D.AsStream();
            SaveStream(Location,S);
            S.Dispose();
            D.Dispose();

    }
    static readonly IntPtr AppKit_libraryHandle = MonoMac.ObjCRuntime.Dlfcn.dlopen (MonoMac.Constants.AppKitLibrary, 0);

    static NSString _NSImageCompressionFactor;
    public static NSString NSImageCompressionFactor {
        get {
            if (_NSImageCompressionFactor == null) {
                _NSImageCompressionFactor= MonoMac.ObjCRuntime.Dlfcn.GetStringConstant (AppKit_libraryHandle, "NSImageCompressionFactor");
            }
            return _NSImageCompressionFactor;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T16:18:58.133

我最终放弃了尝试让它像上面那样工作。

我找到了这个 C# jpeg 编码器。

[http://www.codeproject.com/Articles/83225/A-Simple-JPEG-Encoder-in-C](http://www.codeproject.com/Articles/83225/A-Simple-JPEG-Encoder-in-C)

您需要更正注释中指定的一行。

# ios - 分辨率混乱

> ID：13109467
> 
> 赞同：0
> 
> 时间：2012-10-28T14:06:20.947
> 
> 标签：ios, compression, resolution, retina-display

分辨率混乱。我正在为 iOS 应用程序提供尽可能高分辨率的压缩视频。这些是最终的和最新的格式吗？

1920 x 1080- iPad 3+/ 1136 x 640- iPad 2,mini, iPhone 4,5/ 480 x 270- iPhone, 非视网膜

还有什么我需要知道的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:19:14.440

到目前为止，设备的分辨率是：（横向）

2048 x 1536 iPad 3+

1024 x 768 iPad 2 / 1 / 迷你

1136 x 640 iPhone 5

960 x 640 iPhone 4S / 4

480 x 320 其他 iPhone

# vb.net - 将一些嵌套文本写入 .txt 文件 VB

> ID：13109470
> 
> 赞同：0
> 
> 时间：2012-10-28T14:06:46.060
> 
> 标签：vb.net

我有这个代码：

```
 Dim FILE_NAME As String = "C:\filename.txt"

            Dim objWriter As New System.IO.StreamWriter(FILE_NAME)

            objWriter.Write(TextBox1.Text)
            objWriter.Close() 
```

但我想做这样的事情（注意下面文本中的**objWriter.Write(TextBox.Text)**）：

```
 Dim FILE_NAME As String = "C:\filename.txt"

            Dim objWriter As New System.IO.StreamWriter(FILE_NAME)

            objWriter.Write("Lorem ipsum dolor sit amet, consectetur adipiscing objWriter.Write(TextBox1.Text). 
                             Duis dignissim, lacus vel tincidunt pellentesque, lacus ipsum venenatis libero, 
                             faucibus iaculis lectus diam id libero. Mauris interdum augue id lacus
                             commodo consequat. objWriter.Write(TextBox2.Text) et ligula sed sapien")

            objWriter.Close() 
```

更新：

实际输出：

Lorem ipsum dolor sit amet，consectetur adipiscing objWriter.Write(TextBox1.Text)。Duis dignissim, lacus vel tincidunt pellentesque, lacus ipsum venenatis libero, commodo consequat。TEST et ligula sed sapien

想要的输出（我会先走）：

```
Lorem ipsum dolor sit amet, 
consectetur adipiscing objWriter.
Write(TextBox1.Text). 
Duis dignissim, lacus 
vel tincidunt pellentesque,
 lacus ipsum venenatis libero, 
commodo consequat. TEST et ligula sed sapien 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:24:25.897

在您当前的代码中，最简单（但不一定理想）的方法是：

```
' UPDATED: Use Environment.NewLine to insert new line breaks:

Dim output As String = "" & _
        "Lorem ipsum dolor sit amet, consectetur adipiscing " & _
        Environment.NewLine & _
        TextBox1.Text & " " & _
        Environment.NewLine & _
        "Duis dignissim, lacus vel tincidunt pellentesque, lacus ipsum venenatis libero, " & _
        "commodo consequat. " & _
        Environment.NewLine & _
        TextBox2.Text + " " & _
        Environment.NewLine & _
        "et ligula sed sapien"

'You are trying to write to root of C here. May require elevated privileges.
' Try writing to your user directory, or documents folder. 
Dim FILE_NAME As String = "C:\filename.txt"
Dim objWriter As New System.IO.StreamWriter(FILE_NAME)
objWriter.Write(output)
objWriter.Close() 
```

**请注意，尝试将文件直接写入 C 驱动器的根目录时可能会遇到权限问题。**在我将目录路径更改为我的主文件夹之前，我在这段代码中遇到了类似的问题，除非我以管理员身份运行 VS（您的用户不太可能这样做）。

也就是说，您实际上可能会问如何将文本框的内容插入到从流写入器读取的内容中，在这种情况下，您必须想出一些方法来确定正确的插入点。但这就是您如何具体完成您在上面的代码中描述的内容。

更新：

您可能希望使用 THIS 之类的东西来指定输出目录和文件名。或者，当然，使用 SaveFileDialog，并允许用户指定。

```
Dim path As String = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)
Dim FILE_NAME As String = Path & "\MyNextNewFile.txt" 
```

# jquery - 使用 jQuery 操作可滚动的 div

> ID：13109474
> 
> 赞同：0
> 
> 时间：2012-10-28T14:07:04.557
> 
> 标签：jquery, css

我有一个具有以下 CSS 属性的 div，以便让它滚动到位：

```
height: 746px;
width: 295px;
overflow: auto;
margin-bottom: 11px;
position: relative; 
```

我需要用 jQuery 做两件事：

1.  单击按钮，将框向上滚动 100 像素。
2.  滚动时到达框的底部时，触发一个函数。

我已经尝试使用两者`.position()`并`.offset()`获得它现在的位置，但是滚动时都没有更新位置。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:23:12.760

1.  使用 scrollTop 属性

    $(element).scrollTop($(element).scrollTop()+100);

2.  使用滚动事件

    $(element).scroll(function(){ //检查div的高度和scrollTop的值，这样你就知道你是否在底部，然后做一些代码})

# ssl - 2 个域，每个域都有自己的 SSL 证书，指向一组文件

> ID：13109479
> 
> 赞同：1
> 
> 时间：2012-10-28T14:07:48.697
> 
> 标签：ssl, cpanel, whm

我被要求将一个新域名指向我已经受到 SSL 保护的网站。棘手的部分是新域还要有一个 SSL 证书，以便可以从两个域名访问网站而无需重定向。

鉴于每个 SSL 证书必须（我认为）有自己的 IP 地址，是否可以这样做。更复杂的是，服务器使用 WHM/cPanel 来管理帐户，据我所知，似乎没有办法让一个帐户使用 2 个 IP 地址。

所以我的问题是：是否可以在 cPanel 中为新帐户安装 SSL 证书，分配自己的 IP 地址等，然后更改文档根目录，以便新帐户指向另一个帐户的相同文档根目录也通过 SSL 保护？如果是这样，这是否会在浏览器中不产生任何错误等情况下工作，并且 cPanel 是否仍可用于管理帐户而无需重置文档根更改？

服务器信息：基于 CENTOS 的专用服务器，运行 WHM 11.32.5（内部版本 13）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T22:57:10.433

我是 Symantec SSL Support 的 Bryan。从证书的角度来看，如果您想用一个 SSL 证书保护 2 个域，您可以注册一个支持 SAN（主题备用名称）的多域证书。由于实施了 CAB 论坛标准化，所有证书都颁发给 FQDN（完全限定域名）而不是 IP 地址。

颁发证书后，您必须将其安装到生成 CSR 的同一服务器上。如果您使用的是 CPanel/WHM，则该界面会在您生成 CSR 时创建一个私钥。在 SSL 安装期间需要私钥与 CA（证书颁发机构）颁发的公钥匹配。CA 只发布公钥，而不是私钥，因此在服务器上拥有私钥很重要。

因此，如果您在一台服务器上的一个域上安装了多域或 SAN 证书，并且您希望第二台服务器上的第二个域工作，您将需要与安装在第二台服务器上的第一台服务器相同的私钥和公钥服务器。否则，您将收到不匹配错误。服务器的文档需要引用任何类型的 IP、域或文档根配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T15:55:10.267

我相信您应该能够设置 2 个不同的网站，每个网站都有自己的 IP 地址，但指向同一个文档根目录。如果您使用的是 cpanel，它很有可能在 apache 之上，我知道 apache 会允许这样做。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-30T11:45:51.410

有关详细信息，请访问[赛门铁克 SSL](http://www.symantec.com/en/uk/theme.jsp?themeid=verisign-ssl-certificates)

# iphone - CGContext 错误/警告

> ID：13109487
> 
> 赞同：2
> 
> 时间：2012-10-28T14:08:54.480
> 
> 标签：iphone, objective-c, ios, cgcontext

我有以下代码来截屏。我特别不使用`UIGraphicsBeginImageContext`，因为在我发现这使用了大量的内存之前：

```
 CGSize size = activeView.frame.size;

    NSUInteger width = size.width;
    NSUInteger height = size.height;

    NSLog(@"BEFORE");

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    unsigned char *rawData = malloc(height * width * 4);
    memset(rawData,0,height * width * 4);

    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height, bitsPerComponent, bytesPerRow, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);

    CGRect bounds;
    bounds.origin = CGPointMake(0,0);
    bounds.size = size;

    CGContextDrawImage(context, CGRectMake(0, 0, size.width, size.height), [self.topimage CGImage]);
    CGContextDrawImage(context, CGRectMake(0, 0, size.width, size.height), [bottomimage CGImage]);

    CGImageRef imageRef = CGBitmapContextCreateImage(context);
    UIImage *latest = [UIImage imageWithCGImage:imageRef scale:0.0 orientation:UIImageOrientationDownMirrored];

    [activeView.layer renderInContext:UIGraphicsGetCurrentContext()];

    CGImageRef imageRef2 = CGBitmapContextCreateImage(context);
    UIImage *latest2 = [UIImage imageWithCGImage:imageRef2 scale:0.0 orientation:UIImageOrientationDownMirrored];

    CGContextRelease(context);
    CGImageRelease(imageRef);
    CGImageRelease(imageRef2);

    NSLog(@"AFTER"); 
```

在 'BEFORE' 和 'AFTER' 之间`NSLogs`，会出现以下错误/警告：

```
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextSetAlpha: invalid context 0x0
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextSetFillColorWithColor: invalid context 0x0
<Error>: CGContextAddRect: invalid context 0x0
<Error>: CGContextDrawPath: invalid context 0x0
<Error>: CGContextRestoreGState: invalid context 0x0
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextGetBaseCTM: invalid context 0x0
<Error>: CGContextConcatCTM: invalid context 0x0
<Error>: CGContextSetBaseCTM: invalid context 0x0
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextClipToRect: invalid context 0x0
<Error>: CGContextSetAlpha: invalid context 0x0
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextSetFillColorWithColor: invalid context 0x0
<Error>: CGContextAddRect: invalid context 0x0
<Error>: CGContextDrawPath: invalid context 0x0
<Error>: CGContextRestoreGState: invalid context 0x0
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextConcatCTM: invalid context 0x0
<Error>: CGContextConcatCTM: invalid context 0x0
<Error>: CGContextClipToRect: invalid context 0x0
<Error>: CGContextDrawImage: invalid context 0x0
<Error>: CGContextRestoreGState: invalid context 0x0
<Error>: CGContextRestoreGState: invalid context 0x0
<Error>: CGContextSetBaseCTM: invalid context 0x0
<Error>: CGContextRestoreGState: invalid context 0x0 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T14:44:10.993

`[activeView.layer renderInContext:UIGraphicsGetCurrentContext()];`

这条线是问题......你没有“当前”上下文。改为使用`context`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-04T11:41:07.383

这是 iOS 模拟器的问题。（Apple 正在解决这个错误）

转到iOS模拟器->重置内容和设置

清理您的项目并再次运行它。我的问题得到了解决。一切都会恢复正常。

# javascript - jQuery 标准下拉菜单仅在页面加载时进行样式化，点击刷新和它丑陋的正常

> ID：13109488
> 
> 赞同：0
> 
> 时间：2012-10-28T14:08:59.177
> 
> 标签：javascript, jquery, jquery-ui, jquery-mobile

尝试在单击“添加里程并打开它”后在此处的表单上实现“下拉​​”效果

它似乎只发生在第一次加载时，如果您随时刷新或返回页面，该死的东西会变成一个丑陋的正常非 jquery 下拉菜单。我假设它是因为我使用 javascript 来填充我的选择（下拉）。任何帮助将不胜感激......`

.js

```
// Create select element with options.
function makeRunRecord() {
    var formTag = document.getElementsByTagName('form'),
        selectList = ge('select'),
        makeSelect = document.createElement('select');
        makeSelect.setAttribute("id", "styles");
    makeSelect.setAttribute("name", "styles");
        makeSelect.setAttribute("class", "required select");
        makeSelect.setAttribute("data-native-menu", "false");
        var makePlace = document.createElement('option');
    makePlace.setAttribute("data-placeholder", "true");
    makePlace.setAttribute("value", "");
    makeSelect.appendChild(makePlace);
    for (var i=0, j=runningStyles.length; i<j; i++) {
        var makeOption = document.createElement('option');
        var optText = runningStyles[i];
        makeOption.setAttribute("value", optText);
        makeOption.innerHTML = optText;
        makeSelect.appendChild(makeOption);
    }
    selectList.appendChild(makeSelect);
};

// Call Functions 
```

makeRunRecord();

}); .html

```
 <li><div id="select"><label for="rStyle">Choose Run Style*</label></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:14:26.973

在页面加载后尝试运行该函数：

```
window.onload = function() {
    makeRunRecord();
} 
```

# java - 使用 Executers 创建消息侦听器池

> ID：13109489
> 
> 赞同：1
> 
> 时间：2012-10-28T14:09:00.577
> 
> 标签：java, multithreading, jakarta-ee, thread-safety, ejb

我不得不在一个独立的应用程序中创建一个消息监听器（对于一些 jms 主题）。由于我收到的每条消息都必须进行一些处理。

这种行为延迟了我的整体表现。

所以我决定为我的消息听众创建一种 POOL。（如在 ejb 中的 MDB 中）。

我以这种方式开始使用 Executor 类（Java）：

```
import java.util.concurrent.Executor;
import java.util.concurrent.Executors; 

    private Executor threadPool = Executors.newCachedThreadPool();
    @Override
    public void onMessage(final Message msg)
    {
        Runnable t = new Runnable()
        {
            public void run()
            {
                execute(msg);
                log.trace(received messge");
            }
        };
        threadPool.execute(t);
    }

public void execute(Message msg)
{
   // do some long running process)
} 
```

通过这种方式，我通过为每次执行创建单独的线程来确保我的应用程序在处理时不会从一条消息卡到另一条消息。

我想根据您的经验提出您的建议。如果实施可能会导致将来出现任何问题，那是那种吗？我应该注意什么（我知道并发是一个问题）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T14:14:46.413

这是 JMS，你为什么不把 MDB 池化呢？然后，您可以避免使用单独的线程池。如果您同时关闭应用程序，未处理的项目也不会丢失。

确保您了解缓存和固定线程池之间的区别（请参阅：[Java newCachedThreadPool() 与 newFixedThreadPool](https://stackoverflow.com/questions/949355)）。它可能是也可能不是你想要的。我通常会选择固定线程池，因为我想提前知道打开线程的最大数量。

一件小事：在处理消息之前放置日志记录（同样），这样您就可以轻松判断它被处理了多长时间。如果您使用固定池，了解它的排队时间也很有价值。

# javascript - 如何在 jquery .load 中传递 javascript 变量

> ID：13109491
> 
> 赞同：0
> 
> 时间：2012-10-28T14:09:01.123
> 
> 标签：javascript, jquery, variables

我正在使用 jquery 的 .load 函数在容器中加载页面，但我需要通过 url 传递一些参数，javascript 变量保存参数的值

```
 var data = "xyz";
$("#toggleText").load("inner/playlist.php",{name:data}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:44:00.827

使用引号作为参数名称总是一个好主意。

```
$("#toggleText").load("inner/playlist.php",{'name':data}); 
```

另外，尝试使用回调函数来检查它实际上做了什么：

```
$("#toggleText").load("inner/playlist.php",{'name':data}, function(response, status, xhr) {
if (status == "error") {
    alert("Error: " + xhr.status + " " + xhr.statusText);
  }
}); 
```

# asp.net - 如何使用内部联接查询使用 2 个表中的值填充数据集

> ID：13109494
> 
> 赞同：0
> 
> 时间：2012-10-28T14:09:19.797
> 
> 标签：asp.net, c#-4.0

我有 2 个表 1Tbl_purchasemaster1 和 1Tbl_purchasesub1 以及如下查询：

```
SELECT  Tbl_PurchaseMaster.dtPurchaseDate,Tbl_PurchaseMaster.vaSupplierName,
    Tbl_PurchaseSub.vaItemCode,Tbl_PurchaseSub.intQuantity 
FROM Tbl_PurchaseMaster 
INNER JOIN Tbl_PurchaseSub 
ON 
dbo.Tbl_PurchaseMaster.intPurchaseMasterID = dbo.Tbl_PurchaseSub.intPurchaseMasterID 
where dtPurchaseDate between  '" + dtfr + "'and'" + dtto 
    + "' dtfr=datefrom and dtto=dateto.. 
```

如何将这些值填充到数据集中？填好后，我想在水晶报表中显示。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:16:11.240

如果您已经完成连接，SQL 将有效地返回一个表，您可以将它作为 DataTable 放入 DataSet。

您还可以将每个表单独查询到 DataSet 中的两个 DataTables 中，然后添加关系。

DataSet 中没有规定可以获取 SQL 连接的结果并将其拆分为多个 DataTable。

# java-me - J2ME从txt文件中提取电话号码

> ID：13109496
> 
> 赞同：2
> 
> 时间：2012-10-28T14:09:29.040
> 
> 标签：java-me

任何人都可以帮助我从 txt 文件中提取电话号码。我在一个标题为 id 的文件夹中有很多 txt 文件。如果用户输入了某个 id，midlet 会将文件标题读取为 id.txt，并将字符串读取为文件中的电话号码，然后向该字符串发送消息。（例如，如果输入为 1，则将读取 1。 txt 返回字符串 123467890，然后发送消息到 1234567890）。

但是现在我的问题是我可以通过代码读取txt文件：

```
**public String Loadnumber(String fileName){
        String str="";
        try{
              FileConnection fc =(FileConnection)Connector.open("file://localhost/root1/res/number/"+fileName);
        if(!fc.exists()){
                   hrow new IOException("File does not exist");
            }
         InputStream is=fc.openInputStream();
         byte b[]=new byte[1024];
         int length = is.read(b,0,1024);
         str = new String (b,0,length);

       }catch(Exception e ){

       }
       return str;  
    }**** 
```

然后我将Loadnumber函数的返回字符串插入到电话号码地址框中：

```
 **String number= new String(Loadnumber(id+".txt"));
        destinationAddressBox.insert(number,0);** 
```

destinationAddressBox 是电话号码框，当我输入 id 并按下按钮时，它将显示此框，我将其声明为：

```
 **destinationAddressBox = new TextBox("phone number", number,1024,TextField.PHONENUMBER);
        destinationAddressBox.addCommand(okCommand);
        destinationAddressBox.setCommandListener(this);** 
```

但是当我运行它并在输入id的框中按ok按钮后，它不会提示地址框，并会给我错误消息：

```
 **java.lang.IllegalArgumentException
    at javax.microedition.lcdui.TextField.insert(+55)
    at javax.microedition.lcdui.TextField.insert(+14)
    at javax.microedition.lcdui.TextBox.insert(+9)
    at example.sms.SMSSend.commandAction(+72)
    at javax.microedition.lcdui.Display$DisplayAccessor.commandAction(+282)
    at javax.microedition.lcdui.Display$DisplayManagerImpl.commandAction(+10)
    at com.sun.midp.lcdui.DefaultEventHandler.commandEvent(+68)
    at com.sun.midp.lcdui.AutomatedEventHandler.commandEvent(+47)
    at com.sun.midp.lcdui.DefaultEventHandler$QueuedEventHandler.handleVmEvent(+186)
    at com.sun.midp.lcdui.DefaultEventHandler$QueuedEventHandler.run(+57)** 
```

但是如果我将文本字段更改为 TextField.ANY 而不是 TextField.PHONENUMBER，它将提示地址框并在我的 txt 文件中显示电话号码，但它不会发送消息并给我错误消息：

```
 **java.lang.IllegalArgumentException: Host format
    at com.sun.midp.io.j2me.sms.Protocol.openPrimInternal(+198)
    at com.sun.midp.io.j2me.sms.Protocol.openPrim(+8)
    at javax.microedition.io.Connector.openPrim(+299)
    at javax.microedition.io.Connector.open(+15)
    at javax.microedition.io.Connector.open(+6)
    at javax.microedition.io.Connector.open(+5)
    at example.sms.SMSSend.run(+100)** 
```

我想文本字段很重要。我怎么能平衡呢？非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T00:17:20.033

你有（至少）两个问题，所以你应该一个接一个地解决它们。可能的问题是：

1) 发送短信会给你 IllegalArgumentException。尝试对号码进行硬编码并检查问题是否仍然存在。也许你忘了在协议前加上“sms://”+number；

2) 为什么 TextField.PHONENUMBER 不起作用？尝试设置硬编码文本字段的数量然后你知道文件或文件读取是否是问题。也许文件末尾的换行符是问题所在。

# java - java中的枚举值列表

> ID：13109497
> 
> 赞同：55
> 
> 时间：2012-10-28T14:09:34.713
> 
> 标签：java, enums

是否可以创建枚举值的 ArrayList（并对其进行操作）？例如：

```
enum MyEnum
{
   ONE, TWO
}

MyEnum my = MyEnum.ONE;
List <?> al = new ArrayList <?>();
al.add(my);
al.remove(al.size()-1); 
```

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-10-28T14:28:27.567

你可以简单地写

```
new ArrayList<MyEnum>(Arrays.asList(MyEnum.values())); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2015-09-02T21:49:52.090

# tl;博士

您可以从枚举中创建和编辑对象集合吗？**是的。**

如果您不关心顺序，请[`EnumSet`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/EnumSet.html)使用[`Set`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Set.html).

```
enum Animal{ DOG , CAT , BIRD , BAT ; }

Set<Animal> flyingAnimals = EnumSet.of( BIRD , BAT );

Set<Animal> featheredFlyingAnimals = flyingAnimals.clone().remove( BAT ) ; 
```

如果您关心订单，请使用[`List`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)诸如[`ArrayList`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ArrayList.html). 例如，我们可以创建一个人在选择宠物时的偏好列表，按照他们最喜欢的顺序排列。

```
List< Animal > favoritePets = new ArrayList<>() ;
favoritePets.add( CAT ) ;  // This person prefers cats over dogs…
favoritePets.add( DOG ) ;  // …but would accept either.
                           // This person would not accept a bird nor a bat. 
```

对于不可修改的有序列表，请使用[`List.of`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html#of(E,E)).

```
List< Animal > favoritePets = List.of( CAT , DOG ) ;  // This person prefers cats over dogs, but would accept either. This person would not accept a bird nor a bat. 
```

# 细节

`EnumSet`Amit Deshpande[的答案](https://stackoverflow.com/a/13109656/642706)[(](https://stackoverflow.com/a/13109543/642706) )和 Marko Topolnik 的答案( `.values`) 都是正确的。这是更多信息。

# `Enum.values`

该`.values()`方法是一个*隐式声明的方法*on [`Enum`](https://docs.oracle.com/javase/9/docs/api/java/lang/Enum.html)，由编译器添加。它产生一个粗略的数组而不是一个[`Collection`](http://docs.oracle.com/javase/9/docs/api/java/util/Collection.html). 当然可以使用。

关于文档的特别说明：作为*隐式声明的方法*不寻常，该`.values()`方法*未列*在`Enum`类的方法中。该方法[在*Java 语言规范*](https://docs.oracle.com/javase/specs/jls/se9/html/jls-8.html#jls-8.9.3)中定义，并在[`Enum.valueOf`](https://docs.oracle.com/javase/9/docs/api/java/lang/Enum.html#valueOf-java.lang.Class-java.lang.String-).

# `EnumSet`– 快而小

好处[`EnumSet`](http://docs.oracle.com/javase/9/docs/api/java/util/EnumSet.html)包括：

*   极速。
*   内存使用紧凑。

引用类文档：

> 枚举集在内部表示为位向量。这种表示非常紧凑和高效。这个类的空间和时间性能应该足够好，以允许它用作传统的基于 int 的“位标志”的高质量、类型安全的替代品。如果参数也是枚举集，即使批量操作（例如 containsAll 和 retainAll）也应该运行得非常快。

鉴于此枚举：

```
enum Animal
{
    DOG , CAT , BIRD , BAT ;
} 
```

做一个`EnumSet`在一条线上。

```
Set<Animal> allAnimals = EnumSet.allOf( Animal.class ); 
```

转储到控制台。

```
System.out.println( "allAnimals : " + allAnimals ); 
```

> allAnimals : [狗、猫、鸟、蝙蝠]

从枚举对象的子集创建一个集合。

```
Set<Animal> flyingAnimals = EnumSet.of( BIRD , BAT ); 
```

查看[类文档](https://docs.oracle.com/javase/9/docs/api/java/util/EnumSet.html)以了解操作集合的许多方法，包括添加或删除元素。

```
Set<Animal> featheredFlyingAnimals = 
    EnumSet.copyOf( flyingAnimals ).remove( BAT ); 
```

# 自然秩序

该文档承诺 EnumSet 的迭代器是自然顺序的，即最初声明枚举值的顺序。

引用类文档：

> iterator 方法返回的迭代器以元素的自然顺序（声明枚举常量的顺序）遍历元素。

坦率地说，鉴于这个承诺，我很困惑为什么这不是[`SortedSet`](http://docs.oracle.com/javase/9/docs/api/java/util/SortedSet.html). 但是，哦，好吧，足够好了。如果需要[`List`](http://docs.oracle.com/javase/9/docs/api/java/util/List.html)，我们可以创建一个。`Set`将any 传递`Collection`给构造函数，`ArrayList`该集合[`Iterator`](http://docs.oracle.com/javase/9/docs/api/java/util/Iterator.html)会自动代表您调用。

```
List<Animal> list = new ArrayList<>( allAnimals ); 
```

转储到控制台。

```
System.out.println("list : " + list ); 
```

跑的时候。

```
list : [DOG, CAT, BIRD, BAT] 
```

在 Java 10 及更高版本中，您可以`List`通过传递`EnumSet`. 新列表的顺序将按照`EnumSet`. an 的迭代器顺序`EnumSet`是枚举的元素对象在该枚举上定义的顺序。

```
List< Animal > nonModList = List.copyOf( allAnimals ) ;  // Or pass Animals.values() 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-10-28T14:14:33.617

是的，这绝对是可能的，但你必须这样做

```
List<MyEnum> al = new ArrayList<MyEnum>(); 
```

然后，您可以将元素添加到`al`:`al.add(ONE)`或`al.add(TWO)`.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-10-28T14:15:48.787

这是可能的，但您应该[`EnumSet`](http://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html)改用

```
enum MyEnum {
    ONE, TWO;
    public static final EnumSet<MyEnum> all = EnumSet.of(ONE, TWO);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-28T14:10:22.920

枚举只是 Java 中的另一个类，它应该是可能的。

更准确地说，枚举是对象的一个​​实例：http: [//docs.oracle.com/javase/6/docs/api/java/lang/Enum.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Enum.html)

所以是的，它应该工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-22T15:35:08.777

这是一个更通用的解决方案，可用于任何 Enum 对象，因此无需使用。

```
static public List<Object> constFromEnumToList(Class enumType) {
    List<Object> nueva = new ArrayList<Object>();
    if (enumType.isEnum()) {
        try {
            Class<?> cls = Class.forName(enumType.getCanonicalName());
            Object[] consts = cls.getEnumConstants();
            nueva.addAll(Arrays.asList(consts));
        } catch (ClassNotFoundException e) {
            System.out.println("No se localizo la clase");
        }
    }
    return nueva;
} 
```

现在你必须这样调用：

```
constFromEnumToList(MiEnum.class); 
```

# php - 我将如何内爆记录集列？

> ID：13109500
> 
> 赞同：0
> 
> 时间：2012-10-28T14:10:06.073
> 
> 标签：php, arrays, email, recordset, implode

我正在尝试将电子邮件发送到数据库中包含的多个电子邮件地址并分类到记录集中...记录集有多个列，但我只需要一个：“电子邮件”。我知道如果我将它们放在一个数组中，我可以将它们内爆并用逗号分隔它们，但我不确定如何使用记录集列来做到这一点。有谁知道怎么做？

**这是记录集代码：**

```
$colname_rsAllLeads = "-1";
if (isset($_SESSION['MM_Username'])) {
  $colname_rsAllLeads = $_SESSION['MM_Username'];
}
mysql_select_db($database_myBackOfficeConn, $myBackOfficeConn);
$query_rsAllLeads = sprintf("SELECT Email FROM Leads WHERE `User` = %s ORDER BY FullName ASC", GetSQLValueString($colname_rsAllLeads, "text"));
$rsAllLeads = mysql_query($query_rsAllLeads, $myBackOfficeConn) or die(mysql_error());
$row_rsAllLeads = mysql_fetch_assoc($rsAllLeads);
$totalRows_rsAllLeads = mysql_num_rows($rsAllLeads); 
```

**新代码：**

```
$colname_rsAllLeads = "-1";
if (isset($_SESSION['MM_Username'])) {
  $colname_rsAllLeads = $_SESSION['MM_Username'];
}
mysql_select_db($database_myBackOfficeConn, $myBackOfficeConn);
$query_rsAllLeads = sprintf("SELECT Email FROM Leads WHERE `User` = %s ORDER BY FullName ASC", GetSQLValueString($colname_rsAllLeads, "text"));
$rsAllLeads = mysql_query($query_rsAllLeads, $myBackOfficeConn) or die(mysql_error());
$row_rsAllLeads = mysql_fetch_assoc($rsAllLeads);
$totalRows_rsAllLeads = mysql_num_rows($rsAllLeads);

$row_rsAllLeads = array();
while( $row = mysql_fetch_assoc($rsAllLeads) ) {
   $row_rsAllLeads[] = $row;
}

$glued = "";
$separator = "";
foreach( $row_rsAllLeads as $row ) {
   $glued .= $separator . $row['Email'];
   $separator = ", ";
}

$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
} 

if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form")) {

    $startcode = $_POST['messagefield'];
    $replaced = preg_replace( '/\\\\(?="|\')/', '', $startcode );
    echo $replaced;
    $collectedleads = $row_rsAllLeads['Email'];
    echo $collectedleads;

    /*
 $to = $collectedleads;
 $subject = $_POST['subjectfield'];
 $body = $replaced;
 $headers = "MIME-Version: 1.0\r\n"; 
 $headers .= "Content-type: text/html; charset=iso-8859-1\r\n"; 
 $headers .= "From: " . $row_rs_CurrentUser['FirstName'] . " " . $row_rs_CurrentUser['LastName'] . " <" . $row_rs_CurrentUser['Email'] . ">";
 if (mail($to, $subject, $body, $headers)) {
  } else {
   echo("<p>Message delivery failed...</p>");
  }
  */

  $insertSQL = sprintf("INSERT INTO PendingEmails (`to`, subject, message) VALUES (%s, %s, %s)",
                       GetSQLValueString($row_rsAllLeads['Email'], "text"),
                       GetSQLValueString($_POST['subjectfield'], "text"),
                       GetSQLValueString($_POST['messagefield'], "text"));

  mysql_select_db($database_myBackOfficeConn, $myBackOfficeConn);
  $Result1 = mysql_query($insertSQL, $myBackOfficeConn) or die(mysql_error());

  $insertGoTo = "Email Sent.php";
  if (isset($_SERVER['QUERY_STRING'])) {
    $insertGoTo .= (strpos($insertGoTo, '?')) ? "&" : "?";
    $insertGoTo .= $_SERVER['QUERY_STRING'];
  }
  header(sprintf("Location: %s", $insertGoTo));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:13:58.067

你需要自己粘上它。`implode()`在这里没有用，因为你必须遍历你的记录集，提取`Email`，放入单独的数组，然后`implode()`. 但是由于您已经在迭代，您可以将它粘合而不使用临时数组和`implode()`，如下所示：

```
$glued = "";
$separator = "";
foreach( $row_rsAllLEads as $row ) {
   $glued .= $separator . $row['Email'];
   $separator = ", ";
} 
```

**编辑#1**

您的代码也需要修复，因为您只获取**第一个**行集，而不是全部匹配您的 where 子句。它应该是这样的（你也应该将变量名从 更改`row_...`为`rows_...`）：

```
$row_rsAllLeads = array();
while( $row = mysql_fetch_assoc($rsAllLeads) ) {
   $row_rsAllLeads[] = $row;
} 
```

所以毕竟`$row_rsAllLeads`应该是数组数组。

# parsing - INI 文件的部分定义中是否允许使用连字符？

> ID：13109506
> 
> 赞同：1
> 
> 时间：2012-10-28T14:10:39.187
> 
> 标签：parsing, ini, hyphen

在 INI 文件的部分定义中使用连字符是否允许且有效：

```
[my-section]
setting="anything" 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:35:33.620

取决于你用什么来解析它。没有正式的 INI 规范。有一些信息和非正式规范@en.wikipedia.org/wiki/INI_file。

INI 文件通常不用于任何形式的进程间或其他通信。由于它位于相对受控的环境中，因此对正式规范的需求较少。

# ajax - 主干渲染视图，但仅在 Chrome 中

> ID：13109509
> 
> 赞同：1
> 
> 时间：2012-10-28T14:11:11.283
> 
> 标签：ajax, backbone.js, requirejs, fetch

我是 Backbone 的初学者，所以这是一个渲染简单模板的非常简单的示例。我在渲染这个模板时遇到了问题。它仅适用于 Chrome。当我在 MasterView 对象中的“this.collection.fetch()”为空但在 Chrome 中有我的集合之后调试此代码时。我不知道为什么它在 Chrome 中有效，但在其他浏览器中无效。

**索引.html**

```
 <div class="Presentation">

    </div>

    <script id="slideTemplate" type="text/template">
        <h1><%=slide_title %></h1>
        <h2><%=slide_subheading %></h2>
        <div> <%=content %> </div>
    </script> 
```

**模型**

```
define(['backbone','underscore'],function(Backbone,_){
var linkModel = Backbone.Model.extend({
        defaults: {
                    slide_title: "slide", 
        slide_subheading: "sub slide 1",
        content: "bla bla bla"
         }
     });

return linkModel;
    }); 
```

**收藏**

```
define(['backbone','underscore','models/link','libs/backbone-localstorage'],function(Backbone,_,link,storage){
var linkModels = Backbone.Collection.extend({
    model: link,
    localStorage: new storage('links')

});

return linkModels;
    }); 
```

**单视图**

```
define(['jquery','backbone','underscore'],function($,Backbone,_){
var linkView = Backbone.View.extend({
    tagName: "article",
    className: "slide-container",
    template: $("#slideTemplate").html(),
    render: function(){
        var tmpl = _.template(this.template);
        this.$el.html(tmpl(this.model.toJSON()));
        return this;
    }
});

return linkView;
    }); 
```

**主视图**

```
define(['jquery',
    'backbone',
    'underscore',
    'collections/links',
    'views/linkView', 'views/data'], function($, Backbone,_,links,linksView,data){
var favsView = Backbone.View.extend({
    el: $(".Presentation"),
    initialize: function(){
        var self = this;
        this.collection = new links(slides);    
        _.bindAll(this, 'renderLink', 'renderAll');         

              this.collection.fetch();
      this.renderAll();
    },
    renderAll: function(){
        this.collection.each(
            this.renderLink
        );
    },
    renderLink: function(model){
        var view = new linksView({model: model});
        this.$el.append(view.render().el);
        model.save();
    },
    render: function(){
        console.log("Ready...");
    }
});

return new favsView;
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T17:54:06.630

你在这里有一个简单的“ **A** in **AJAX**代表**异步**”问题：

```
 this.collection.fetch();
  this.renderAll(); 
```

[`fetch`](http://backbonejs.org/#Collection-fetch)是一个 AJAX 调用，因此无法保证在执行时您的集合中会有任何内容`renderAll`。

推荐的（*我*推荐的）方法是做两件事：

1.  将视图的方法绑定`render`到集合的`"reset"`事件。`render`当从服务器获取集合时，这将触发调用。
2.  修改您的`render`和模板以对空集合执行一些明智的操作。您可以显示*Loading...*消息，例如*No items*或其他任何内容。

您的代码应该看起来更像这样：

```
initialize: function() {
    // Always do this first to be sure that your function
    // references refer to the right things.
    _.bindAll(this, 'render', 'renderLink');

    this.collection = new links(slides);
    this.collection.on('reset', this.render);
    this.collection.fetch();
    this.render(); // If you must.
},
render: function() {
    // And update your template to with a "loading..." message
    // of some sort...
    this.collection.each(this.renderLink);
    return this; // A good convention.
},
renderLink: function(model) {
    var view = new linksView({model: model});
    this.$el.append(view.render().el);
} 
```

该[`render`](http://backbonejs.org/#View-render)方法用于渲染，不要通过引入一个`renderAll`可以完成`render`工作的东西来使事情变得过于复杂。此外，`model.save()`在您的内部调用`renderLink`有点奇怪，模型应该已经在服务器上，因为它们刚刚来自`fetch`并且通常您会将`save`调用放在一些更新模型以响应用户事件的操作旁边。

# jquery - 限制RequiredFieldValidator 以在单击某个按钮时进行验证

> ID：13109512
> 
> 赞同：1
> 
> 时间：2012-10-28T14:11:29.597
> 
> 标签：jquery, asp.net, validation

我正在开发一个 Web 应用程序，但我遇到了RequiredFieldValidator 的问题。

我有一个“插入电影”按钮和一个包含其他两个按钮（保存电影和取消）的 div，一个用于标题的文本框，一个用于描述的文本框和一个用于标题的 RequiredFieldValidator。默认情况下不显示此 div。这是我的问题：当我单击插入时，在客户端我使用 javascript 隐藏插入按钮并显示我的 div。单击按钮，我创建了一个 PostBack，我的 div 显示了RequiredFieldValidator 错误消息。我不想要这种行为。我想在单击保存按钮后显示验证错误。这是我的代码...

```
 <head runat="server">
    <title>Validation Test</title>
    <script src="Scripts/jquery-1.4.1-vsdoc.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            ValidatorEnable(document.getElementById('<%= TitleValidator.ClientID%>'), false);
        });
        function ShowInsertForm() {
            ValidatorEnable(document.getElementById('<%= TitleValidator.ClientID%>'), true);
            $('#InsertForm').show();
        }
        function HideInsertForm() {
            $('#InsertForm').hide();
        }

    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button ID="Insert" runat="server" Text="Insert Movie" OnClientClick="ShowInsertForm();"/>
    </div>
    <div id="InsertForm" style="display:none">
        <asp:Button ID="Save" runat="server" Text="Save Movie" onclick="Save_Click" OnClientClick="HideInsertForm();"/>
        <asp:Button ID="Cancel" runat="server" Text="Cancel Movie" CausesValidation="false" OnClientClick="HideInsertForm();"/>
        <br />
        Title<asp:TextBox ID="Title" runat="server"></asp:TextBox>
        <asp:RequiredFieldValidator ID="TitleValidator" runat="server" 
            ErrorMessage="Please insert Title" ControlToValidate="Title"></asp:RequiredFieldValidator>
        <br />
        Description<asp:TextBox ID="Description" runat="server"></asp:TextBox>
    </div>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T16:50:04.287

1-当您将插入按钮仅用于客户端幻灯片功能时，我建议将`<asp:button>`控件替换为`html button tag`. 这样就不再触发验证。

2-如果必须使用`asp:button`，可以将其设置`causeValidation`为`false`. 甚至更好的是，您可以`post-back`通过编辑`ShowInsertForm`功能防止它引起

```
 function ShowInsertForm() {
        ValidatorEnable(document.getElementById('<%= TitleValidator.ClientID%>'), true);
        $('#InsertForm').show();
        return false;
    } 
```

# windows - 进程中的 RPC 完整性特权

> ID：13109513
> 
> 赞同：0
> 
> 时间：2012-10-28T14:11:40.620
> 
> 标签：windows, security, api, debugging, winapi

我的系统（Windows 7）中有 2 个进程正在运行，其中一个具有中等完整性级别，第二个具有低完整性级别。

如果我的中等完整性向低完整性进程发送 RPC 调用，代码会以低完整性级别还是中等完整性级别执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T19:10:00.330

代码将在调用它的进程的完整性中运行。因此，在您的情况下，代码将以 RPC 服务器的完整性执行。

# mysql - 多表SQL优化（七）使用MySQL

> ID：13109514
> 
> 赞同：1
> 
> 时间：2012-10-28T14:11:40.020
> 
> 标签：mysql, query-optimization

我有七个表，当我执行以下 sql 查询时，处理查询需要很长时间，并且我的系统在执行此操作时会挂起。

```
SELECT DISTINCT 
    M.MerchantId, 
    M.MerchantName, 
    M.Image
FROM 
    CCodes as CC, 
    Merchants as M, 
    MemberStores as MS, 
    MemberCategories as MC, 
Categories as C, 
    MembersLogin as ML, 
    CategoryAndMerchant as CM
WHERE 
    (
        (
            M.MerchantId = MS.MerchantId 
        AND MS.MemberId = ML.Id
        ) 
        OR 
        (
            ML.Id = MC.MemberId 
        AND MC.CategoryId = C.Id 
        AND C.Id = CM.CategoryId 
        AND CM.MerchantId = M.MerchantId 
        AND CC.MerchantId = M.MerchantId
        )
    )
AND CC.Status = 1 
AND M.Status = 1 
AND C.Status = 1 
AND CC.Status = 1
AND EndDate BETWEEN '$todaysDate' AND '$endDate'        
AND ML.Id = $id             
ORDER BY EndDate asc 
```

您可以假设 $todaysDate、$endDate 和 $id 的任何值。
请帮我优化查询，使执行时间尽可能少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T13:39:12.707

我注意到您只打印有关餐桌商家的信息。因此，另一个表改为应用连接尝试使用不存在/存在作为条件的子查询。添加一些索引，例如，在字段日期作为 EndDate。

为什么你放两次

```
AND CC.Status = 1 
```

告诉我这些建议后是否可以

# php - 在文本中查找数组的任何键作为子字符串的有效方法

> ID：13109516
> 
> 赞同：0
> 
> 时间：2012-10-28T14:11:51.810
> 
> 标签：php, regex, .htaccess, search

我有一个输入文本

```
$text ="this is just a normal text with max length of 150 characters" 
```

我有一个大小为 400 的数组

```
$keywordArray = array("this","that","who","where","abuse","spam",".."); 
```

现在我想查找 $text 的任何子字符串是否属于 $keywordArray

一种方法是

```
1) break the $text in words 
2) take each word and check in the array 
          if it contains that word
                  return true;
3) exit 
```

请为此在php中提出任何更好的解决方案。我可以为此使用正则表达式吗？或任何其他方法。对于具有大量网页的 web 应用程序，我需要它来根据 url 的文本过滤掉垃圾邮件页面。

我们也可以使用 .htaccess 文件来处理这个问题（设置重写规则）。

```
Rewriterule (regex forspammedurls) spammedpage.php [L] 
Rewriterule (.*) normalpage.php [L] 
```

只是想了解，在 php 级别或 Apache 级别我应该处理这个问题。请提出您的建议。谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T14:22:39.970

这是一个简短的方法

```
$words = str_word_count( $text, 1 );
$foundWords = array_intersect( $words, $keywordArray);
if ( count($foundWords) ) {
    // some words found
} else {
    // no words found
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T14:22:55.977

使用 array_intersect 查找匹配的单词而不循环：

```
$text ="this is just a normal text with max length of 150 characters";
$keywordArray = array("this","that","who","where","abuse","of");

$result = array_intersect($keywordArray,str_word_count($text,2));
if (count($result) > 0) {
    echo 'Matches found: ';
    var_dump($result);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:20:33.590

虽然您可以构造一个正则表达式，但它会很*长*而且可能很*复杂*。

请记住，PHP 有大量的[字符串](http://php.net/manual/en/ref.strings.php)和[数组](http://php.net/manual/en/ref.array.php)函数。

如果您只对某个字符串中是否存在数组键感兴趣，则使用[`array_filter()`](http://php.net/array_filter)和之类的本机函数[`strpos()`](http://php.net/strpos)是一个很好的选择。

**注意：**我意识到这不是一个明确的*答案*。但是，它旨在帮助读者[成为更好的 PHP 开发人员](http://jason.pureconcepts.net/2012/08/better-php-developer/)。

# git - 您如何按照以下说明构建和包含 Facebook Android SDK

> ID：13109521
> 
> 赞同：0
> 
> 时间：2012-10-28T14:12:19.503
> 
> 标签：git, github, cordova, phonegap-plugins

我是 github 的新手，假设我在下面的说明中遗漏了一些东西。

[https://github.com/davejohnson/phonegap-plugin-facebook-connect](https://github.com/davejohnson/phonegap-plugin-facebook-connect)

> 首先运行 git submodule update --init 来初始化并拉下与该插件兼容的 Android Facebook SDK 版本；它最终会在 lib/. 将 src 和 res 文件夹从 lib/facebook-android-sdk/facebook/ 复制到 Cordova Android 应用程序的根目录中。它应该与现有的 src 和 res 文件夹合并，而不是覆盖。

我已经能够成功地运行并克隆插件的代码`git clone https://github.com/davejohnson/phonegap-plugin-facebook-connect.git`，但是下一步对我来说没有任何意义，因为我应该只是运行`git submodule update --init`，在我看来，某种类型的上下文丢失了。我需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T03:35:24.280

哇，太简单了，我只需要 cd 到 repo 并运行命令。

# codeigniter - $this->session->set_flashdata() 然后 $this->session->flashdata() 在 codeigniter 中不起作用

> ID：13109522
> 
> 赞同：31
> 
> 时间：2012-10-28T14:12:21.170
> 
> 标签：codeigniter, session

请看下面的代码：

```
$this->session->set_flashdata('message', 'This is a message.');
var_dump($this->session->flashdata('message')); 
```

它返回`bool(false)`。

我希望在那之后它不需要被召回，因为有时我需要在视图中设置 flashdata 后立即调用它***。***`redirect()`

* * *

**[在venkat](https://stackoverflow.com/users/1679342/venkat)的评论后**编辑****

 **```
$this->session->set_flashdata('message', 'This is a message.');
$this->session->keep_flashdata('message');
var_dump($this->session->flashdata('message')); 
```

不幸的是没有区别。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-28T14:35:20.287

好吧，[文档](http://codeigniter.com/user_guide/libraries/sessions.html)确实说明了

> CodeIgniter 支持“flashdata”，即仅可用于下一个服务器请求的会话数据，然后会自动清除。

作为第一件事，这显然意味着您需要进行新的服务器请求。重定向、刷新、链接或其他方式将用户发送到下一个请求。

如果您在同一个请求中使用 flashdata，为什么还要使用它呢？您最好不要使用 flashdata 或使用常规会话。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-08-19T14:18:02.883

```
// Set flash data 
$this->session->set_flashdata('message_name', 'This is my message');
// After that you need to used redirect function instead of load view such as 
redirect("admin/signup");

// Get Flash data on view 
$this->session->flashdata('message_name'); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-07-31T05:14:50.727

要设置 flashdata，您需要重定向控制器功能

```
$this->session->set_flashdata('message_name', 'This is test message');

//redirect to some function
redirect("controller/function_name");

//echo in view or controller
$this->session->flashdata('message_name'); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-07-19T11:12:01.220

在 Codeigniter 中重定向后显示 Flash 消息

在你的控制器中设置这个

```
<?php

public function change_password(){

if($this->input->post('submit')){
$change = $this->common_register->change_password();

if($change == true){
$messge = array('message' => 'Password chnage successfully','class' => 'alert alert-success fade in');
$this->session->set_flashdata('item', $messge);
}else{
$messge = array('message' => 'Wrong password enter','class' => 'alert alert-danger fade in');
$this->session->set_flashdata('item',$messge );
}
$this->session->keep_flashdata('item',$messge);

redirect('controllername/methodname','refresh');
}

?>

In Your View File Set this
<script type="application/javascript">
/** After windod Load */
$(window).bind("load", function() {
  window.setTimeout(function() {
    $(".alert").fadeTo(500, 0).slideUp(500, function(){
        $(this).remove();
    });
}, 4000);
});
</script>

<?php

if($this->session->flashdata('item')) {
$message = $this->session->flashdata('item');
?>
<div class="<?php echo $message['class'] ?>"><?php echo $message['message']; ?>

</div>
<?php
}

?> 
```

请检查以下链接以[在 Codeigniter 中重定向后显示闪烁消息](http://myphpinformation.blogspot.in/2016/06/displaying-flash-message-after-redirect.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-31T04:38:57.373

更改您的 config.php：

```
$config['sess_use_database'] = TRUE; 
```

到：

```
$config['sess_use_database'] = FALSE; 
```

这个对我有用。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-07-13T06:04:57.197

重定向后的闪烁消息将在控制器中不可见。在视图中显示获取控制器的操作并将其传递给视图**

# c - 将定义的值作为指针传递

> ID：13109523
> 
> 赞同：0
> 
> 时间：2012-10-28T14:12:40.497
> 
> 标签：c, pointers

您好，我对后面的 C 代码有一个小问题：

```
 //Hardcoded commands:

 #define someCommand 0x1223;
 #(...)

 //functions definitions:
 void socketWrite(uint8_t address, const uint8_t *data, size_t length);

 //main task
 int main(){

 //I want send someCommand to socket
 socketWrite(0xff, &someCommand, 1);

 (...)
 } 
```

这段代码当然给了我编译错误：错误：'someCommand'没有在这个范围内声明

但我的问题是如何在不创建可以处理此命令的新缓冲区数据的情况下正确编写此命令，如下所示：

```
uint8_t * buff;
*buff = someCommand;
socketWrite(0xff, buff, 1); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:18:14.930

`someCommand`是一个#define。C 预处理器通过将源文本替换为其值来生成源文本。所以你的代码看起来像：

```
socketWrite( 0xff, &0x1223, 1 ); 
```

无法获取 0x1223 的地址。

```
int value = someCommand;
socketWrite( 0xff, &value, 1 ); 
```

可能有效

除此以外：

```
const int someCommand = 0x1223; 
```

然后

```
socketWrite(0xff, &someCommand, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:16:18.410

您可以使用 C99 的大括号初始值设定项来执行此操作（可能不是正确的名称）

```
socketWrite(0xff, &(uint8_t) { someCommand }, 1); 
```

这本质上与使临时变量等于`someCommand`并获取它的地址相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T15:27:24.287

# 定义一些命令 0x1223；

你必须避免';' 宏定义中的分号。

# sql - SQL 计数（超过）

> ID：13109526
> 
> 赞同：1
> 
> 时间：2012-10-28T14:13:01.080
> 
> 标签：sql, sql-server

```
distrikt = district

SELECT POST.distrikt, COUNT(PERSON.personnr)
  FROM [dbo].POST join [dbo].PERSON on POST.postnr = PERSON.postnr
  WHERE ?
  GROUP BY POST.distrikt
GO 
```

我需要查看显示与每个相关联的人数的地区，但它应该只显示包含 2 人或更多人的地区。我尝试使用`COUNT(PERSON.personnr) > 2`，但这没有用。除此之外，它显示了地区和相关人员就好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T14:17:13.777

当您需要根据 的结果进行过滤时`GROUP BY`，请使用`HAVING`：

```
SELECT POST.distrikt, COUNT(PERSON.personnr)
FROM [dbo].POST join [dbo].PERSON on POST.postnr = PERSON.postnr
GROUP BY POST.distrikt
HAVING COUNT(PERSON.personnr) > 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:18:02.433

添加一个`having`子句：

```
SELECT POST.distrikt, COUNT(PERSON.personnr)
  FROM [dbo].POST join [dbo].PERSON on POST.postnr = PERSON.postnr
  GROUP BY POST.distrikt
  HAVING count(PERSON.personnr) > 2 
```

例如，请参见[http://dev.mysql.com/doc/refman/5.5/en/select.html](http://dev.mysql.com/doc/refman/5.5/en/select.html)。搜索`having`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:17:50.360

添加

```
HAVING COUNT(PERSON.personnr) > 2 
```

在你的小组之后

# java - 如何将 csv 文件中的数字保存到 java 数组列表中

> ID：13109531
> 
> 赞同：0
> 
> 时间：2012-10-28T14:14:07.380
> 
> 标签：java, csv, arraylist

你好，这是我第一次发帖，如果我在提问过程中做错了什么，请告诉我。

我的目的：将双变量保存在 csv 文件中，并将它们保存在 java 文件中的数组列表中。

到目前为止我有当前的代码，我是 java 的初学者，所以请不要火焰 ToT

```
import java.io.*;
import java.util.*;
import java.lang.*;

public class CsvProcessor {

    public static void main(String[] args) {
        Scanner keyboard = new Scanner(System.in);

        // ask for file path at command prompt, save the path input in path
        System.out.print("path of file: ");
        String path = keyboard.next();

        try {
            // set up file, reader, and arraylist for processing csv file
            java.io.File csv = new java.io.File(path);
            BufferedReader bufferedReader = new BufferedReader(new FileReader(csv));
            ArrayList<String> csvEntry = new ArrayList<String>();

            // set parameters for StringTokenizer
            String line = "";
            String delimiter = ",";

            //read using bufferedReader and save using csvEntry ArrayList
            while ((line = bufferedReader.readLine()) != null) {    
                StringTokenizer stringTokenizer = new StringTokenizer(line, delimiter);
                while (stringTokenizer.hasMoreTokens()) {
                    csvEntry.add(stringTokenizer.nextToken());
                }
            }

            csvEntry.toArray();
            double[] csvDouble = new double[csvEntry.getLength()];
            for (int i = 0; i < csvEntry.getLength(); i++) {
                csvDouble[i] = Double.parseDouble(csvEntry[i]);
            }

            int x = csvDouble.getLength();
            double sum = 0;

            for (int y = 0; y < x; y++) {
                sum = sum + csvDouble[y];
            }

            double mean = sum / x;
            System.out.println("mean is: " + mean);
            bufferedReader.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
} 
```

我尝试了转换csv文件中的字符串并将它们保存到arraylist中，然后将arraylist转换为一个数组，然后再将其转换为一个double数组。我得到的错误是：

```
C:\Users\user\Codes\ktrt>java CsvProcessor
path of file: C:\Users\user\Codes\ktrt\montyreal.csv
Exception in thread "main" java.lang.NumberFormatException: For input string: "5
48.53"
        at java.lang.NumberFormatException.forInputString(Unknown Source)
        at java.lang.Integer.parseInt(Unknown Source)
        at java.lang.Integer.<init>(Unknown Source)
        at CsvProcessor.main(csvprocessor.java:27) 
```

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:38:46.850

首先，你有一个错误的错误日志。您的代码没有`Integer.parseInt()`方法。假设您正确地将 CSV 解析为`csvEntry`变量，您可以这样做：

```
List<Double> csvDouble = new ArrayList<Double>();
double mean, total = 0;

for (String raw : csvEntry) {
  double entry = Double.valueOf(raw);
  total += entry;
  csvDouble.add(entry);
}

mean = total / csvDouble.size();
// at this point you have your ArrayList and mean value;
System.out.println("mean is " + mean); 
```

希望这可以帮助 ：）

# java - 如何在 Java 中使用 JButton 重绘组件？

> ID：13109532
> 
> 赞同：0
> 
> 时间：2012-10-28T14:14:13.480
> 
> 标签：java, swing, components, jbutton, repaint

我正在尝试用 Java 编写一个名为 HighLow 的简单 GUI 骰子游戏。基本上，用户以 50 英镑的初始余额开始，他们可以选择三种不同的投注金额，如果他们选择低，则骰子必须落在 2、3、4、5 或 6 上并支付 1:1，如果他们选择高，骰子必须落在 8、9、10、11 或 12 上，赔率为 1:1。如果他们选择 7，骰子必须落在 7 上，赔率为 4:1。有两个骰子，所以两者的值都应该相加。这不是我问题的重点，只是想我会澄清这一点，以便您了解游戏的重点。

我对面板、事件处理和类似的东西完全陌生，所以我目前正在学习，但我在尝试解决这个问题时遇到了一些困难。我有五个类： Dice.java 包含一个 getFaceValue() 和 throwDie() 方法来模拟骰子的随机投掷。DiceFace.java 创建带有点/点的骰子。DiceFaceViewer.java 是框架类。DiceFaceComponent 是两个骰子的组件，GamePanel 是所有 JButton 和 JComboBox 等所在的面板。

这就是我到目前为止所做的：创建一个框架，将带有按钮等的面板粘贴进去，然后将骰子图像添加到框架中。我想要的是每当我单击“投掷骰子”按钮时，骰子就会被重新绘制到带有随机面的框架上。如果我打开和关闭窗口，它现在所做的就是生成一个随机的脸。

**骰子**

```
import java.util.Random;
public class Dice {

    // Instance variables
    private int faceValue;
    private int sides;
    private Random generator;

    public Dice(int s) {
        generator = new Random();
        sides = s;
        faceValue = generator.nextInt(sides) + 1;
    }

    // Simulates the throw of a die landing on a random face.
    public int throwDie() {
        return faceValue = (int)(Math.random() * sides) + 1;
    }

    // Returns the current face value of the die
    public int getFaceValue() {
        return faceValue;
    }

    // Set face value of die
    public void setValue(int v) {
        faceValue = v;
    }
} 
```

**骰子脸**

```
import java.awt.*;
import java.awt.geom.*;

public class DiceFace {

    // Holds the seven possible dot positions on a standard die
    private Ellipse2D.Double[] dots = new Ellipse2D.Double[7];

    private Rectangle box;
    private int xLeft;
    private int yTop;
    private int side;
    private int diceValue;

    public DiceFace(int s, int x, int y, int v) {
        side = s;       // Dimension of dice face
        xLeft = x;      // xPos
        yTop = y;       // yPos
        diceValue = v;  // Pip value
    }

    public void draw(Graphics2D g2) {
        box = new Rectangle(xLeft, yTop, side, side);
        makeDots();

        // Black background
        g2.setColor(Color.BLACK);
        g2.fill(box);

        // White dots on black
        g2.setColor(Color.WHITE);

        // Draw dots
        if (diceValue == 1) 
            g2.fill(dots[0]);

        else if (diceValue == 2) {
            g2.fill(dots[1]); g2.fill(dots[2]);
        }

        else if (diceValue == 3) {
            g2.fill(dots[0]); g2.fill(dots[1]); g2.fill(dots[2]);
        }

        else if (diceValue == 4) {
            g2.fill(dots[1]); g2.fill(dots[2]);
            g2.fill(dots[3]); g2.fill(dots[4]);
        }

        else if (diceValue == 5) {
            g2.fill(dots[0]); g2.fill(dots[1]);
            g2.fill(dots[2]); g2.fill(dots[3]); g2.fill(dots[4]);
        }

        else if (diceValue == 6) {
            g2.fill(dots[1]); g2.fill(dots[2]); g2.fill(dots[3]);
            g2.fill(dots[4]); g2.fill(dots[5]); g2.fill(dots[6]);
        }
    }

    public void makeDots() {

        int w = side/6; // Dot width
        int h = side/6; // Dot height

        dots[0] =  new Ellipse2D.Double(xLeft + (2.5 * side)/6,
                yTop + (2.5 * side)/6, h, w);

        dots[1] = new Ellipse2D.Double(xLeft + (3.75 * side)/6,
                yTop + (3.75 * side)/6, h, w);

        dots[2] = new Ellipse2D.Double(xLeft + (1.25 * side)/6,
                yTop + (1.25 * side)/6, h, w);

        dots[3] = new Ellipse2D.Double(xLeft + (1.25 * side)/6,
                yTop + (3.75 * side)/6, h, w);

        dots[4] = new Ellipse2D.Double(xLeft + (3.75 * side)/6,
                yTop + (1.25 * side)/6, h, w);

        dots[5] =  new Ellipse2D.Double(xLeft + (1.25 * side)/6,
                yTop + (2.5 * side)/6, h, w);

        dots[6] =  new Ellipse2D.Double(xLeft + (3.75 * side)/6,
                yTop + (2.5 * side)/6, h, w);
    }
} 
```

**DiceFaceViewer**

```
import java.awt.*;
import javax.swing.*;

public class DiceFaceViewer {
    public static void main(String[] args) {

        // Create frame
        JFrame frame = new JFrame();

        // Set frame attributes
        frame.getContentPane().setPreferredSize(new Dimension(360, 320));
        frame.pack();
        frame.setTitle("High Low");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setResizable(false);

        // Set location of frame to centre screen
        Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();

        int w = frame.getSize().width;
        int h = frame.getSize().height;
        int x = (dim.width-w)/2;
        int y = (dim.height-h)/2;
        frame.setLocation(x, y);

        DiceFaceComponent component = new DiceFaceComponent();
        frame.add(component);

        // Add panel to frame
        GamePanel panel = new GamePanel();
        frame.add(panel, BorderLayout.NORTH);

        frame.setVisible(true);
    }
} 
```

**骰子面组件**

```
import java.awt.*;
import javax.swing.*;

public class DiceFaceComponent extends JComponent {

    // Instance variables
    private int faceValue1;
    private int faceValue2;

    public DiceFaceComponent() {
        faceValue1 = new Dice(6).getFaceValue();
        faceValue2 = new Dice(6).getFaceValue();
    }

    public void paintComponent(Graphics g) {
        super.paintComponent(g);

        // Recover Graphics2D
        Graphics2D g2 = (Graphics2D) g;

        DiceFace dice1 = new DiceFace(75, 66, 160, faceValue1); // s, x, y, v
        dice1.draw(g2);
        repaint();

        DiceFace dice2 = new DiceFace(75, 219, 160, faceValue2);
        dice2.draw(g2);
        repaint();
    }
} 
```

**游戏面板**

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class GamePanel extends JPanel {

    private int balance = 50;

    public GamePanel() {

        // Components
        JRadioButton highButton = new JRadioButton("High");
        JRadioButton lowButton = new JRadioButton("Low");
        JRadioButton sevensButton = new JRadioButton("Sevens");

        // Button group
        ButtonGroup bg = new ButtonGroup();
        bg.add(highButton);
        bg.add(lowButton);
        bg.add(sevensButton);

        add(highButton);
        add(lowButton);
        add(sevensButton);

        // Array to hold bet amounts
        String betAmounts[] = {"£10", "£5", "£1"};

        // Bets combo box
        JComboBox bets = new JComboBox(betAmounts);
        add(bets);

        // Balance
        JLabel bal = new JLabel(" Balance: £" + balance);
        add(bal);

        // Throw dice button
        final JButton throwButton = new JButton("Throw Dice");
        add(throwButton, FlowLayout.RIGHT);

        class Action implements ActionListener {

            Dice dice = new Dice(6);

            public void actionPerformed(ActionEvent e) {

                dice.throwDie();
                dice.getFaceValue();
            }
        }

        throwButton.addActionListener(new Action());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T19:07:28.983

不要从任何`paint`方法中调用 repaint。这将导致重绘管理器安排另一个重绘事件，最终消耗您的 CPU 并停止您的编程。

而是调用`repaint`更新潜水面值的动作侦听器。

骰子和骰子之间也没有任何联系`DiceFaceComponent`，它永远不会知道它应该绘制什么值。

另外，在您的`DiceFace`课堂上，我不会费心在每次抽签上重新创建“点”，这只是浪费。而是在构造函数中创建它们。

该`paintComponent`方法也是如此，不必费心重新创建 DiceFace，只需在构造类时创建两个引用并根据需要更新它们的面值。

我将使用`Dice`作为将所有各种元素联系在一起的基本模型。通过使用类似 a 的东西`ChangeListerner`，可以`Dice`通知各种组件发生了更改，从而允许它们更新屏幕

# java - 如何刷新 webview 的缓存？

> ID：13109534
> 
> 赞同：0
> 
> 时间：2012-10-28T14:14:21.997
> 
> 标签：java, android, caching, webview, android-webview

我正在构建一个原生应用程序，其中（至少）一部分是一个网络应用程序，伪装成一个原生应用程序。Facebook 向我们展示了使用良好缓存的重要性，而我正在缓存网页，因此当您第二次加载它时，它感觉就像是应用程序的原生部分。但是，按照我的设置方式，缓存的内容是永久性的。因此，如果我更改服务器上的某些内容，旧的缓存内容仍然会显示。

这是我希望按优先顺序实现的目标，1 是最可取的。

1.  EITHER 缓存的内容首先显示。在后台，页面会检查更新的版本，但只有在内容不同时才会重新加载。
2.  或 缓存的内容首先显示。在后台页面刷新并重新加载。
3.  或者 缓存的内容在 X 次（一周？）后被删除，迫使页面重新加载。

最后一个选项是最不受欢迎的，因为每次重新加载页面时，都会感觉缓慢而可怕。第二个选项是我的本机活动的行为方式（首先显示缓存，在后台刷新。但是，如果用户同时向下滚动，这会将用户跳转到列表的顶部。）。首先绝对完美！

这是我目前正在使用的代码。

```
WebView wv = (WebView) v.findViewById(ref_id);
wv.getSettings().setJavaScriptEnabled(true);
wv.getSettings().setDatabaseEnabled(true);
String appDBPath = v.getContext().getApplicationContext().getDatabasePath("AppConstructor").getAbsolutePath();

    wv.setWebChromeClient(new WebChromeClient() {
        @Override
        public void onReachedMaxAppCacheSize(long spaceNeeded,
                long totalUsedQuota, WebStorage.QuotaUpdater quotaUpdater) {
            quotaUpdater.updateQuota(spaceNeeded * 2);
        }

        @Override
        public void onExceededDatabaseQuota(String url,
                String databaseIdentifier, long currentQuota,
                long estimatedSize, long totalUsedQuota,
                WebStorage.QuotaUpdater quotaUpdater) {
            quotaUpdater.updateQuota(estimatedSize * 2);
        }
    });

wv.getSettings().setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK);
wv.getSettings().setDomStorageEnabled(true);
wv.getSettings().setAppCacheMaxSize(1024 * 1024 * 8);
String appCachePath = v.getContext().getApplicationContext().getCacheDir().getAbsolutePath();
wv.getSettings().setAppCachePath(appCachePath);
wv.getSettings().setAllowFileAccess(true);
wv.getSettings().setAppCacheEnabled(true);
wv.loadUrl(ref_arg1);
Core x = new Core();
wv.addJavascriptInterface(x.new JavaScriptInterface(v.getContext()),"Android"); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T14:16:47.860

好的，在搜索了年龄甚至在 StackOverflow 上获得了风滚草的成就之后，这就是我设法获得情况 1 的方法。

`WebView`加载它的缓存后，它会启动一个新的`ASyncTask`. 此 ASyncTask 将一些内容附加到 URL，这是我自己的自定义上次更新变量。当然，您可以将其替换为`HTTP Header Last-Update`，但这对我不起作用。如果结果变量与缓存变量（我存储在 中`SharedPreferences`）不同，ASyncTask 会使用以下代码强制刷新 WebView 的缓存。

```
_wv.getSettings().setCacheMode(WebSettings.LOAD_DEFAULT);
_wv.reload(); 
```

# java - 基于字符串的调度，在多个地方没有反射或代码

> ID：13109538
> 
> 赞同：1
> 
> 时间：2012-10-28T14:14:45.387
> 
> 标签：java, string, dynamic, dispatch

我正在研究一个我们有任务概念的框架。希望很多人会编写任务，为此他们只需要实现 Task 接口。任务需要通过它们的名称来触发，这意味着某处需要有一个任务名称->任务类的中央注册表。目前我正在使用 Enum 来执行此操作，但这需要任务实现者为他们实现的每个任务将代码添加到 Enum 中，这很糟糕。

我想出的另一个选择是通过反射搜索所有实现 Task 接口的类并从那里注册它们。这也让我感到恶心，我觉得必须有更好的方法。

如果静态初始化程序不需要在运行之前至少引用一次类，那么它会是完美的。

注释是另一种选择，但它们需要更多的反射工作，或者如果我们要进行编译时代码生成来创建调度程序，则需要更改构建过程。

有更简单的想法吗？

* * *

下面是我现在正在做的一个简单版本，以了解我想要的控制流（为简单起见，将其拆分为一个类）：

```
class Disp {
    interface Task {
        public String doTask();
    }

    static class HelloTask implements Task {
        public String doTask() {
            return "Hello";
        }
    }

    static class ByeTask implements Task {
        public String doTask() {
            return "Bye";
        }
    }

    static class TaskDispatcher {
        static enum Tasks {
            Hello {
                Task getTask() {
                    return new HelloTask();
                }
            },
            Bye {
                Task getTask() {
                    return new ByeTask();
                }
            };
            abstract Task getTask();
        };

        public static Task getTask(String taskName) {
            return Tasks.valueOf(taskName).getTask();
        }
    }

    public static void main(String[] args) {
        System.out.println("Hello task says: "+TaskDispatcher.getTask("Hello").doTask());
        System.out.println("Bye task says: "+TaskDispatcher.getTask("Bye").doTask());
    }

} 
```

如果注册（比如说）HelloTask 的代码只能存在于 HelloTask 中，而不必泄漏到 TaskDispatcher 中（在实际项目中，这些是多个不同的文件），那就更好了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:23:47.240

不要害怕使用框架！使用 Spring 只需几行代码。每个`Task`都必须进行注释（它不必`@Service`来自 Spring），并且您在调度程序中所要做的一切（在引导上下文并启用组件扫描之后）是：

```
class TaskDispatcher {
    @Autowired
    List<Task> tasks;

    //...
} 
```

Spring 会自动找到`Task`CLASSPATH 上的所有 s 并为你注入它们。您可以使用 bean/类名称作为标识符或任何您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:24:11.777

您可以查看服务提供者机制，例如在[这个 SO post](https://stackoverflow.com/questions/6376736/creating-meta-inf-services-folder-in-eclipse)中。使用它，您可以创建一个接口，通过该接口`Task`s 的实现者通知您的中央代码他们实现的所有任务。

我假设每个实现者都会贡献他们自己的 JAR，这种技术假设了这样的场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:21:36.447

我过去通过简单地拥有一个包含从名称到类名的映射的配置文件来实现这种事情：

```
Task1=com.acme.tasks.MyTask1
Task2=com.acme.tasks.more.MyTask2 
```

这用于填充注册表，然后您可以`class.forName()`对类名进行操作，并创建特定任务类的新实例。

然后添加一个新任务只是意味着将新任务类添加到类路径中，并在配置文件中添加一行 - 不需要重新编译现有代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-19T18:51:28.220

我最近遇到了同样的问题，并提出了以下解决方案。每个`Task`（在我的情况下，我称之为`SomethingHandler`）都用自定义注释进行了注释`@RequestHandlerBean`：

```
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER, ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface RequestHandlerBean {

    String taskIdentifier();

} 
```

下面是一个使用这个注解的实现类：

```
@RequestHandlerBean(taskIdentifier = "task1")
public class HecAckIndexPlanRequestHandler implements  RequestHandler {

    public void handleRequest(Request request) { 
        // ... 
    }

} 
```

在我的调度程序中，我现在使用了 Spring 的`getBeansWithAnnotation`方法`ApplicationContext`：

```
Map<String, Object> annotatedHandlers = 
    context.getBeansWithAnnotation(RequestHandlerBean.class); 
```

您现在可以`Map<String, RequestHandler>`使用以下代码创建地图：

```
Map<String, Object> annotatedHandlers = context.getBeansWithAnnotation(RequestHandlerBean.class);
Map<String, RequestHandler> handlers  = new HashMap<>();
for (Map.Entry<String, Object> entry : annotatedHandlers.entrySet()) {
    ServiceInstanceRequestHandler handler = (RequestHandler) entry.getValue();
    Annotation a = AnnotationUtils.findAnnotation(handler.getClass(), RequestHandlerBean.class);
    String taskIdentifier = AnnotationUtils.getValue(a, "taskIdentifier")
    handlers.put(taskIdentifier, handler);
 } 
```

您现在可以通过调用任务

```
handlers.get(taskIdentifier).handleRequest(...) 
```

希望这可以帮助。

# android - iPhone / iPad上的Android应用程序？

> ID：13109541
> 
> 赞同：0
> 
> 时间：2012-10-28T14:15:23.070
> 
> 标签：android, iphone, ipad

我写了一个安卓应用。当您启动 android 应用程序时，您会看到一个加载网站的 Web 浏览器。就是这样。现在可以在 iPhone 或 iPad 上启动这个应用程序了吗？在某些网站上，有人说它有效，但我没有看到任何教程或示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:20:31.033

如果您在 i 产品中使用 obj-c 编写代码，它将起作用。Android 使用 java ，这是一种不同的语言。请展示您尝试过的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:51:57.580

如果您必须显示 webview，那么您可以使用 UIWebView，因为 Morad 建议这是最简单的。在多个平台上处理此类应用程序的其他替代方法是使用[PhoneGap](http://phonegap.com/)或 [appcelerator Titanium](http://www.appcelerator.com/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T15:03:18.610

创建一个加载网站的应用程序非常简单，只需放置一个 UIWebView 并加载 url。问题是，如果您想在 AppStore 上发布应用程序，您将违反 AppStore 的限制。

> 2.12 不是很有用、独特、只是捆绑为应用程序的网站或不提供任何持久娱乐价值的应用程序可能会被拒绝

看看这个[这个](https://stackoverflow.com/questions/7421002/app-rejected-from-apple-app-store-because-uiwebview-need-some-advice)线程。

# php - 使用 mysql 和 php datetime Ymd H:s:m 的 Jquery / Javascript 倒计时

> ID：13109544
> 
> 赞同：0
> 
> 时间：2012-10-28T14:15:51.527
> 
> 标签：php, javascript, jquery, datetime, countdown

嗨，我需要使用这种格式的日期（Ymd H:m:s）制作一个倒计时脚本，所以我以这种格式检索 current_datetime 和 expire_datetime，我需要在一些 js 或 js 插件中使用它们来显示这些之间的倒计时日期。

有人知道接受上面显示的日期格式的轻量级 js 或 jquery 插件吗？

这正是我需要的[http://keith-wood.name/countdown.html](http://keith-wood.name/countdown.html)，但它不允许 Ymd H:m:s 格式

注意：我需要将倒计时事件绑定到页面上的多个元素。

谢谢！。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:44:50.413

您可以使用您发布链接的那个，只需将您的日期字符串转换为日期对象。`split`这可以通过使用 JavaScript 的方法将字符串分解为组件来轻松完成：

```
var date_split = date_string.split(" ");
var date = date_split[0];
date = date.split("-");
var time = date_split[1];
time = time.split(":");
var date_object = new Date(date[0],date[1],date[2],time[0],time[1],time[2]); 
```

# sublimetext2 - Sublime text 2：jslint插件缺少/usr/local/bin/jslint

> ID：13109546
> 
> 赞同：3
> 
> 时间：2012-10-28T14:15:55.760
> 
> 标签：sublimetext2, jslint, sublimetext, sublime-jslint

我让自己陷入了一个小问题。我把电脑留在家里，去了我的避暑别墅几天，当我回到家并尝试将文件保存在 Sublime Text 2 中时，我收到了这个错误：

```
module.js:340
throw err;
      ^
Error: Cannot find module '/usr/local/bin/jslint'
at Function.Module._resolveFilename (module.js:338:15)
at Function.Module._load (module.js:280:25)
at Module.runMain (module.js:492:10)
at process.startup.processNextTick.process._tickCallback (node.js:244:9)
[Finished in 0.1s with exit code 1] 
```

感谢您提供如何解决此问题的建议:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T00:05:23.157

您需要在您的计算机上安装 Jslint4Java 或 Node.js 及其 jslint 模块才能使插件工作。这两个项目都提供了 jslint 命令。

有关安装 Jslint4Java 的具体说明，请参阅：

[http://opensourcehacker.com/2012/04/12/jslint-integration-for-sublime-text-2/](http://opensourcehacker.com/2012/04/12/jslint-integration-for-sublime-text-2/)

有关安装 Node.js + jslint 的具体说明，请参阅：

[https://github.com/reid/node-jslint](https://github.com/reid/node-jslint)

我还推荐 jshint（在 SublimeLinter 包中）而不是 jslint：

[https://github.com/SublimeLinter/SublimeLinter](https://github.com/SublimeLinter/SublimeLinter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:43:41.130

符号链接可执行文件： `ln -s /usr/local/share/npm/bin/jslint /usr/local/bin/jslint`

如果您没有使用`npm install -g`，请使用`which jslint`来定位它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T02:34:43.517

您可能还想在[https://github.com/darrenderidder/Sublime-JSLint](https://github.com/darrenderidder/Sublime-JSLint)上查看用于 Sublime Text 2插件的**JSLint（带节点）**作为一种简单直接的替代方案。

# php - 在php中查找每个匹配项

> ID：13109549
> 
> 赞同：0
> 
> 时间：2012-10-28T14:16:13.993
> 
> 标签：php

我想从一个 HTML 文件中找到一个特定的字符串匹配项（想通过给出参数 start 和 end string 来找到中间字符串）我使用了以下代码

```
 $string = " ".$ipt;
 $ini = strpos($string,$start);
 if ($ini == 0) return "";
 $ini += strlen($start);
 $len = strpos($string,$end,$ini) - $ini;
 return substr($string,$ini,$len); 
```

它可以找到中间的刺，但它只能从 HTML 文件中返回 1 个匹配项我想要所有可能的匹配项请帮助我

起始字符串是 -`<div class="product">` 结束是 -`<br class="no">`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:25:28.830

如果您想使用上面代码中使用的相同方法，请查看：http: [//il1.php.net/manual/en/function.strpos.php#108426](http://il1.php.net/manual/en/function.strpos.php#108426)

除此之外，还有 preg_match：http: [//il1.php.net/manual/en/function.preg-match.php](http://il1.php.net/manual/en/function.preg-match.php)

# javascript - 为什么用 javascript 替换图像会在我的页面上禁用 Jquery？

> ID：13109550
> 
> 赞同：0
> 
> 时间：2012-10-28T14:16:14.230
> 
> 标签：javascript, jquery, image

我的目标是让一个浮动的绿色框跟随滚动并停在我选择的某个点。在大多数情况下，我已经完成了这一点，尽管它不像我想要的那么顺利。我现在的主要问题是当我用 javascript 替换绿色框时，新的 javascript 在您滚动时不再跟随页面向下。由于某种原因，它似乎禁用了以前工作的 jquery。

```
<div id="follow><img><div> <-- Works 
<div id="follow><javascript><div> <-- Does Not Work 
```

我还注意到，即使我将绿色框留在原处，但将 javascript 放在正文中的其他位置，它也会阻止此代码工作。知道为什么会这样以及我能做些什么来解决它吗？

在这里查看我的演示 --> [http://jsfiddle.net/Kachish/RqELN/18/](http://jsfiddle.net/Kachish/RqELN/18/)

```
 .follow { 
    position: absolute;}
​
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
    $(window).load(function(){
    $(document).scroll(function() {
    var scrollVal = $(document).scrollTop();
    $('.follow').css('top',scrollVal+'px');
    if (scrollVal < 250) { 
    $('.follow').css('top','150px');
    }
    if (scrollVal > 547) {
    $('.follow').css('top','375px');    
    }
    });
    });//]]>  
    </script> 
```

# browser - 使用/控制/“嵌入”壁虎渲染引擎的可能性？

> ID：13109554
> 
> 赞同：2
> 
> 时间：2012-10-28T14:16:29.013
> 
> 标签：browser, embed, mozilla, gecko

如果您想在单独的应用程序中使用/检测/“嵌入”壁虎渲染引擎，当前的方法是什么？是编写基于 XUL 的应用程序并使用 libxul 吗？是否有任何可用的最新资源，例如教程？

我需要显示和打印网页，加载自定义 CSS，执行 java 脚本，所有这些都在本地完成。有太多过时的资源，很难弄清楚实现这一目标的正确方法是什么。甚至 Mozilla 官方网站 ( [Embedding Mozilla](https://developer.mozilla.org/en-US/docs/Embedding_Mozilla) ) 也指向了已弃用的资源。有一个指向新 API ( [NewAPI](https://wiki.mozilla.org/Embedding/NewApi) ) 的链接，它应该可以简化嵌入，但它似乎没有维护且不完整。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:37:24.433

支持的方法是开发 XULRunner 应用程序。XULRunner 是 Gecko 引擎的独立版本，它可以运行任何基于 XUL 的应用程序。特别是，应用程序可以使用`<browser type="content" />`标签来加载和显示网页，就像 Firefox 一样。[XULRunner 入门](https://developer.mozilla.org/en-US/docs/Getting_started_with_XULRunner)是一个很好的介绍，还有[更多文档](https://developer.mozilla.org/en-US/docs/XULRunner)。

# android - 角上的 Android 图标/按钮

> ID：13109555
> 
> 赞同：0
> 
> 时间：2012-10-28T14:16:32.157
> 
> 标签：android, xml, layout

如何创建如下图所示的 android 屏幕布局：

![在此处输入图像描述](../Images/31c3423402778b0c247d8362940fd4ae.png).

我知道我使用的图像是主屏幕，但我已经看到其他应用程序中使用了这种布局，其中图标位于角落。

任何人都可以向我指出如何进行此操作的示例或教程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:19:17.860

查看Android 文档中的[RelativeLayout](https://developer.android.com/reference/android/widget/RelativeLayout.html)。它允许您为每个视图指定它相对于父布局的位置，因此您可以让一个子视图与顶部和左侧对齐，另一个与顶部和右侧对齐。

# c - 绘制带有字符的设计

> ID：13109556
> 
> 赞同：0
> 
> 时间：2012-10-28T14:17:04.450
> 
> 标签：c, character

大家好，我是一名新手程序员，我学习 C，昨天学习时遇到了这个练习，这里是：

我必须创建一个程序，它需要三个参数（c，n，m），它会画一座房子。第一个参数 (c) 确定构成房屋的特征，而第二个 (n) 和第三个 (m) 确定三角形（屋顶）和房屋矩形的高度。为了创建屋顶，程序将每行打印 1、3 到 (2 * n +1) 个字符。然后它将显示一个 ((2n-1) * m) 矩形。例如：如果你给作为参数：O,3,4 它会打印

```
 o
                   ooo
                  ooooo
                 ooooooo
                  ooooo
                  ooooo
                  ooooo
                  ooooo 
```

所以我决定解决它，但我在这个练习中已经超过 3 个小时了，我只是找不到合适的条件来放入“for”来创建屋顶我对矩形没问题，所以有人可以帮助屋顶请;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:58:36.077

可能不是最好的解决方案，但这是一种方法

```
void print_house(int c, int n, int m){
    int line_width;
    int max_width = 2*n +1;
    int padding = 0;
    int i=0,j=0,k=0;

    //print the roof
    for(i=0; i<= n; i++){
        line_width = 2*i +1;
        padding = (max_width - line_width)/2;

        for(k=0; k<padding; k++){
        printf(" ");
        }

        for(j=0; j< line_width; j++){
            printf("%c",c);
        }
        printf("\n");
    }

    //print the rectangle
    for(i=0;i<m;i++){
        printf(" ");
        for(j=0;j< max_width -2; j++){
            printf("%c",c);
        }
        printf("\n");
    }

} 
```

# rotation - 如何将不同的 XIB 用于纵向/横向？

> ID：13109561
> 
> 赞同：1
> 
> 时间：2012-10-28T14:17:14.857
> 
> 标签：rotation, ios6, xib, landscape

我想要两个独立的 XIB，一个用于纵向，一个用于横向。

我的 AppDelegate 看起来：

```
#import "AppDelegate.h"
#import "ViewController.h"
@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    UIDevice *device = [UIDevice currentDevice];                    //Get the device object
    [device beginGeneratingDeviceOrientationNotifications];         //Tell it to start monitoring the accelerometer for orientation
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];    //Get the notification centre for the app
    [nc addObserver:self                                            //Add yourself as an observer
           selector:@selector(orientationChanged:)
               name:UIDeviceOrientationDidChangeNotification
             object:device];

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
/*

    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];
    } else {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPad" bundle:nil];
    }
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
 */
    return YES;
}

- (void)orientationChanged:(NSNotification *)note
{
    UIDeviceOrientation deviceOrientation = [[note object] orientation];
    if(deviceOrientation ==UIInterfaceOrientationPortrait){
            NSLog(@"Changed Orientation To Portrait");
        if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
            self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];
        } else {
            self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPad" bundle:nil];
        }
        self.window.rootViewController = self.viewController;
        [self.window makeKeyAndVisible];
    }
    if(deviceOrientation ==UIInterfaceOrientationLandscapeLeft || deviceOrientation ==UIInterfaceOrientationLandscapeRight){
        NSLog(@"Changed Orientation To Landscape");
        if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
            self.viewController = [[ViewController alloc] initWithNibName:@"landscape_iphone" bundle:nil];
        } else {
            self.viewController = [[ViewController alloc] initWithNibName:@"landscape_ipad" bundle:nil];
        }
        self.window.rootViewController = self.viewController;
        [self.window makeKeyAndVisible];

    }
}

@end 
```

这段代码加载了另一个 XIB，但一切都没有到位，状态栏也没有旋转！

# java - 切断字符串中的特定部分

> ID：13109564
> 
> 赞同：2
> 
> 时间：2012-10-28T14:18:00.873
> 
> 标签：java

例如，我有：

```
String s = "{\"ABC\"}:Mycontent{\"123\"}"; 
```

我只想获取 Mycontent{"123"} 部分，这部分可以动态更改。谁能告诉我怎么做（快速性能）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T14:23:48.330

字符串内部的拆分方法可以围绕正则表达式的匹配拆分字符串，因此您可以使用此方法。如果您想要的字符串的位置始终相同，您也可以使用 subsequence 方法。您也可以使用 substring 方法。很多种方法。个人最喜欢的是子串

```
str2=str.substring(begin, [end]) 
```

我把 [] 放在末尾，因为它没有必要。如果您不放置结束索引，则子字符串将一直持续到字符串的末尾。两个索引都必须是整数。此方法还返回一个字符串。

如果数字的大小也动态变化（例如 123 变为 4567），您可以通过不使用结束索引然后使用查找函数并查找字符串中最后一个数字之后的字符来解决此问题（我想这不会更改），然后用 \0 替换该字符（使用替换方法），以便字符串在那里结束。

我提到的所有方法和解释都可以在[javadoc中找到](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:21:22.953

在字符串上使用 indexOf，您可以找到 ':' 的出现并从那里获取子字符串，如下所示：

```
s.substring(s.indexOf(':') + 1) 
```

如果这是来自上游系统的结构化输出，你应该寻找标准的方式来解释它（乍一看，它看起来像 JSON，这意味着你应该使用 JSON 解析器。但它似乎是别的东西，你会知道的更好关于这个输入的来源）。

# haskell - “show”的Haskell模棱两可的类型变量？

> ID：13109576
> 
> 赞同：1
> 
> 时间：2012-10-28T14:19:35.470
> 
> 标签：haskell, types, ambiguous

现在请看这个新写的代码，没有使用“读取”，但我仍然在模棱两可的“显示”上得到错误：

```
data MyType0 a = Tong1 a | Tong2 a  deriving Show
data MyType1 a = Cons1 a | Cons2 a | Cons3 | Cons4 deriving Show
data MyType2 a = MyType2 a deriving Show

fun ((Cons2 s):t:ts) (symseq, MyType2 msg) = (symseq, MyType2 (msg ++ ["You provided wrong symbol: " ++ (show t) ++ " Please provide symbol: " ++ (show Cons3) ]))
--fun ((Cons2 s):t:ts) (symseq, MyType2 msg) = (symseq, MyType2 (msg ++ ["You provided wrong symbol: " ++ (show t) ++ " Please provide symbol: " ]))
fun _ syms                                  = syms 
```

ghci 错误消息：

```
showerr.hs:6:148:
    Ambiguous type variable `a0' in the constraint:
      (Show a0) arising from a use of `show'
    Probable fix: add a type signature that fixes these type variable(s)
    In the second argument of `(++)', namely `(show Cons3)'
    In the second argument of `(++)', namely
      `" Please provide symbol: " ++ (show Cons3)'
    In the second argument of `(++)', namely
      `(show t) ++ " Please provide symbol: " ++ (show Cons3)'
Failed, modules loaded: none. 
```

# 请注意，注释部分不会给出此错误。请解释为什么这是错误的。

## 原始消息保留在下面。

我在一个网站上得到了以下代码。我知道“读取”功能可能会出现模棱两可的类型错误，但在这里我也可以为“显示”功能找到它。我觉得很奇怪，不明白。

代码：

```
main = do run <- getLine
          val <- getLine
          case run of
              "len" -> print . show . len $ (read val)
              "rev" -> print . show . rev $ (read val)
              _ -> putStr "wrong option"

rev :: [a] -> [a]
rev = foldl (flip (:)) []

len :: [a] -> Int
len = foldl (\ac _ -> ac + 1) 0 
```

当我在 ghci 中加载它时出现错误。

```
ideone_x0cMx.hs:4:46:
    Ambiguous type variable `a0' in the constraint:
      (Read a0) arising from a use of `read'
    Probable fix: add a type signature that fixes these type variable(s)
    In the second argument of `($)', namely `(read val)'
    In the expression: print . show . len $ (read val)
    In a case alternative: "len" -> print . show . len $ (read val)

ideone_x0cMx.hs:5:46:
    Ambiguous type variable `a1' in the constraints:
      (Read a1) arising from a use of `read' at ideone_x0cMx.hs:5:46-49
      (Show a1) arising from a use of `show' at ideone_x0cMx.hs:5:32-35
    Probable fix: add a type signature that fixes these type variable(s)
    In the second argument of `($)', namely `(read val)'
    In the expression: print . show . rev $ (read val)
    In a case alternative: "rev" -> print . show . rev $ (read val)
Failed, modules loaded: none. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:41:18.193

回答第一个问题：

您的歧义*确实*来自读取功能！

如果您使用特定类型的 len 和 rev 版本，它会起作用。例如，您可以替换`len`为`(len :: [Int] -> Int)`或替换`(read val)`为`(read val :: [Int])`

* * *

回答第二个问题：

```
Cons3 :: MyType1 a 
```

所以 Haskell 不知道类型`a`是什么。您可以明确指定（如果您只是选择它并不重要`show`）：

```
fun ((Cons2 s):t:ts) (symseq, MyType2 msg) = 
    (symseq, MyType2 (msg ++ ["You provided wrong symbol: " ++ (show t) 
       ++ " Please provide symbol: " ++ show (Cons3 :: MyType Int) ])) 
```

通常它可以`Cons3`从上下文中推断出类型，但是您从文字中创建一个并立即显示它，因此没有上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T15:49:45.550

在子表达式`(show Cons3)`中，没有上下文来确定 的类型参数`MyType1`。

`Cons3`是 any 的构造函数`MyType1 a`，调用`show`它仅限`a`于 的实例`Show`，但除此之外，无法推断任何内容。所以类型变量是不明确的，而且由于没有数值约束，所以不能默认（除非你启用`ExtendedDefaultRules`）。

如果你写，类型变量可以被修复

```
show (Cons3 `asTypeOf` t) 
```

或者——例如——

```
show (Cons3 :: MyType1 String) 
```

那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:34:47.753

应该是什么类型`read val`？您的代码说它应该是一个列表（因为`rev`两者`len`都接受所有类型的列表），但没有说明它应该是一个列表。

# java - 我们为什么要使用内部类或使用内部类的主要优势是什么

> ID：13109579
> 
> 赞同：0
> 
> 时间：2012-10-28T14:20:03.347
> 
> 标签：java, oop

> **可能重复：**
> [内部类的使用](https://stackoverflow.com/questions/4049718/usage-of-inner-class)

我一直在寻找将使用**内部类**的主要原因，我到处都得到了最常见的答案**`Due to re-usability of the existing code`**...... 但是，我们也可以通过在类之外定义一个类来实现这一点。不是吗？

```
class MyOuterClass {
    private class MyOnClickListener implements OnClickListener {
        @Override
        public void onClick(View view) {
            mTts.speak(words.getText().toString(), TextToSpeech.QUEUE_ADD, null);
        }
    }

    // later (inside some method)...
        speakBtn.setOnClickListener(new MyOnClickListener());
} 
```

这`MyOnClickListener`是内部类，稍后以与普通类相同的方式创建对象`new MyOnClickListener()`。那么，主要区别是什么，原因，已经介绍过了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:22:56.433

您定义这个**内部**类（非静态）的方式允许访问**外部**类的成员。这通常意味着在外部类中相当私人的使用

使用内部类的另一个原因是要明确该类旨在由外部类使用并与外部类一起使用。

任何其他人都可以访问**静态内部类。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:25:49.550

内部类应该用于将逻辑相关的类组合在一起。当然，没有人强迫您将某些类设为内部类——您可以很好地在单独的文件中定义它们（除非您想将它们设为私有，这当然是可能的）。一个例子[`LinkedList`](http://developer.classpath.org/doc/java/util/LinkedList-source.html)是`java.util`. 有一个名为的内部类`Entry`用作列表的节点 - 并且只会在`LinkedList`类内部使用，因此它被定义为内部类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:38:09.110

我同意所有其他答案，但我只想添加一个注释。如果您有问题，我更喜欢匿名类（我想您只实例化 MyOnClickListener 类一次），它看起来更简洁：

```
speakBtn.setOnClickListener(new OnClickListener() {
  @Override
  public void onClick(View view) {
      mTts.speak(words.getText().toString(), TextToSpeech.QUEUE_ADD, null);
  }
}); 
```

# linux - 如何在指定的行号后grep字符串？

> ID：13109580
> 
> 赞同：27
> 
> 时间：2012-10-28T14:20:21.830
> 
> 标签：linux, string, search, grep

我有一个大文本文件，我想查看`"time spent"`此文本文件中包含的行，我使用：

```
grep -in "time spent" myfile.txt 
```

但我只对 50000 之后的行感兴趣。在输出中，我想查看 50000 之后的行并且包含“花费的时间”。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-10-28T14:28:54.233

你可以tail它，然后grep：

```
tail -n +50000 myfile.txt | grep -in "time spent" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-26T22:56:30.307

**回答任何 2 个行号之间的 grepping：**

```
Using sed and grep:

sed -n '1,50000p' someFile | grep < your_string > 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-22T19:00:25.903

或者，您可以使用`sed`. `sed`可以用来模仿`grep`这样的：

`sed -n 's/pattern/&/p'`

`sed`即使没有发生替换，默认情况下也会打印每一行。`-n`和`/p`的组合`sed`只打印发生替换的行。最后，我们replace `pattern`by `&`which 表示`pattern`自行替换。结果：我们只是模仿了`grep`.

现在`sed`可以采取一系列行动。在你的情况下：

`sed -n '50000,$s/time spent/&/p' myfile.txt`

指定范围的格式如下：`start,end` 我们只是指示 sed 从第 50000 行开始工作，`$`这意味着最后一行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-17T16:43:23.437

您可以使用`head`+`grep`和 group 命令，`{...}`以便它们共享相同的输入：

```
{ head -n 50000 >/dev/null; grep -i PATTERN; } < infile 
```

`head`不消耗整个输入，它只获取前 50000 行并将它们转储到`/dev/null`; 其余行由 处理`grep`。
如果您需要前面的行号（如`grep -in`），您可以使用`awk`：

```
awk 'NR>50000 && tolower($0)~/PATTERN/{print NR ": " $0}' infile 
```

# javascript - 电话号码的正则表达式 (JS)

> ID：13109585
> 
> 赞同：1
> 
> 时间：2012-10-28T14:20:47.120
> 
> 标签：javascript, regex

如何写一个正则表达式来取`+Z (YYY) XXX-XX-XX`，并得到`YYYXXXXXXX`？这是电话号码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:22:24.823

你可以这样做

```
var mobile = "+Z (567) 567-567-567";
  var n=mobile.replace("(","");
 n =n.replace(/[^0-9]+/g, ''); 

alert(n)​ 
```

## [jSfiddle](http://jsfiddle.net/Y6H8E/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:47:29.313

如果您有确切的格式`+Z (YYY) XXX-XX-XX`：

```
var num = input.replace( '/^\+\S+\s\((\d{3})\)\s(\d{3})-(\d{2})-(\d{2})$/', '\1\2\3\4' ); 
```

但更宽容的变体是

```
var num = input.replace( '/^(\+\S+|\D/', '' ); 
```

# java - 在 Java 中编码为 Base64

> ID：13109588
> 
> 赞同：361
> 
> 时间：2012-10-28T14:21:17.787
> 
> 标签：java, base64, decode, encode

我需要在 Java 中以 Base64 编码对一些数据进行编码。我怎么做？提供 Base64 编码器的类的名称是什么？

* * *

我尝试使用`sun.misc.BASE64Encoder`该类，但没有成功。我有以下 Java 7 代码行：

```
wr.write(new sun.misc.BASE64Encoder().encode(buf)); 
```

我正在使用 Eclipse。Eclipse 将此行标记为错误。我导入了所需的库：

```
import sun.misc.BASE64Encoder;
import sun.misc.BASE64Decoder; 
```

但同样，它们都显示为错误。我在[这里找到了类似的帖子](https://stackoverflow.com/questions/5549464/import-sun-misc-base64encoder-got-error-in-eclipse)。

我使用 Apache Commons 作为建议的解决方案，包括：

```
import org.apache.commons.*; 
```

并导入从以下网址下载的 JAR 文件：http: [//commons.apache.org/codec/](http://commons.apache.org/codec/)

但问题仍然存在。Eclipse 仍然显示前面提到的错误。我该怎么办？

* * *

## 回答 #1

> 赞同：692
> 
> 时间：2012-10-28T14:25:15.023

您需要更改类的导入：

```
import org.apache.commons.codec.binary.Base64; 
```

然后更改您的类以使用 Base64 类。

这是一些示例代码：

```
byte[] encodedBytes = Base64.encodeBase64("Test".getBytes());
System.out.println("encodedBytes " + new String(encodedBytes));
byte[] decodedBytes = Base64.decodeBase64(encodedBytes);
System.out.println("decodedBytes " + new String(decodedBytes)); 
```

然后阅读[为什么不应该使用 sun.* packages](http://www.oracle.com/technetwork/java/faq-sun-packages-142232.html)。

* * *

## 更新（2016-12-16）

您现在可以使用`java.util.Base64`Java 8。首先，像往常一样导入它：

```
import java.util.Base64; 
```

然后使用 Base64 静态方法如下：

```
byte[] encodedBytes = Base64.getEncoder().encode("Test".getBytes());
System.out.println("encodedBytes " + new String(encodedBytes));
byte[] decodedBytes = Base64.getDecoder().decode(encodedBytes);
System.out.println("decodedBytes " + new String(decodedBytes)); 
```

如果您直接想对字符串进行编码并将结果作为编码字符串获取，则可以使用：

```
String encodeBytes = Base64.getEncoder().encodeToString((userName + ":" + password).getBytes()); 
```

有关更多信息，请参阅[Base64](https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html)的 Java 文档。

* * *

## 回答 #2

> 赞同：249
> 
> 时间：2014-03-28T05:23:29.600

使用 Java 8 的 never-too-to-late-to-join-in-the-fun 类：[`java.util.Base64`](http://docs.oracle.com/javase/8/docs/api/java/util/Base64.html)

```
new String(Base64.getEncoder().encode(bytes)); 
```

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2014-11-12T22:16:13.103

在 Java 8 中，它可以这样完成： `Base64.getEncoder().encodeToString(string.getBytes(StandardCharsets.UTF_8))`

这是一个简短的、独立的完整示例：

```
import java.nio.charset.StandardCharsets;
import java.util.Base64;

public class Temp {
    public static void main(String... args) throws Exception {
        final String s = "old crow medicine show";
        final byte[] authBytes = s.getBytes(StandardCharsets.UTF_8);
        final String encoded = Base64.getEncoder().encodeToString(authBytes);
        System.out.println(s + " => " + encoded);
    }
} 
```

输出：

```
old crow medicine show => b2xkIGNyb3cgbWVkaWNpbmUgc2hvdw== 
```

* * *

## 回答 #4

> 赞同：67
> 
> 时间：2013-05-31T10:00:11.713

您还可以使用 Base64 编码进行转换。为此，您可以使用该[**`javax.xml.bind.DatatypeConverter#printBase64Binary`**](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/DatatypeConverter.html#printBase64Binary%28byte%5B%5D%29)方法。

例如：

```
byte[] salt = new byte[] { 50, 111, 8, 53, 86, 35, -19, -47 };
System.out.println(DatatypeConverter.printBase64Binary(salt)); 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2015-02-10T10:35:48.150

[Google Guava](https://en.wikipedia.org/wiki/Google_Guava)是编码和解码 Base64 数据的另一种选择：

**POM 配置：**

```
<dependency>
   <artifactId>guava</artifactId>
   <groupId>com.google.guava</groupId>
   <type>jar</type>
   <version>14.0.1</version>
</dependency> 
```

**示例代码：**

```
String inputContent = "Hello Việt Nam";
String base64String = BaseEncoding.base64().encode(inputContent.getBytes("UTF-8"));

// Decode
System.out.println("Base64:" + base64String); // SGVsbG8gVmnhu4d0IE5hbQ==
byte[] contentInBytes = BaseEncoding.base64().decode(base64String);
System.out.println("Source content: " + new String(contentInBytes, "UTF-8")); // Hello Việt Nam 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-10-28T14:26:27.020

Eclipse 会给您一个错误/警告，因为您正在尝试使用特定于 JDK 供应商的内部类，而不是公共 API 的一部分。Jakarta Commons 提供了自己的 base64 编解码器实现，当然它们位于不同的包中。删除这些导入并让 Eclipse 为您导入正确的 Commons 类。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2017-11-01T15:47:10.503

Java 8 确实包含自己的[Base64](http://en.wikipedia.org/wiki/Base64)实现。但是，我发现了一个稍微令人不安的差异。为了说明，我将提供一个代码示例：

**我的编解码器包装器：**

```
public interface MyCodec
{
  static String apacheDecode(String encodedStr)
  {
    return new String(Base64.decodeBase64(encodedStr), Charset.forName("UTF-8"));
  }

  static String apacheEncode(String decodedStr)
  {
    byte[] decodedByteArr = decodedStr.getBytes(Charset.forName("UTF-8"));
    return Base64.encodeBase64String(decodedByteArr);
  }

  static String javaDecode(String encodedStr)
  {
    return new String(java.util.Base64.getDecoder().decode(encodedStr), Charset.forName("UTF-8"));
  }

  static String javaEncode(String decodedStr)
  {
    byte[] decodedByteArr = decodedStr.getBytes(Charset.forName("UTF-8"));
    return java.util.Base64.getEncoder().encodeToString(decodedByteArr);
  }
} 
```

**测试类：**

```
public class CodecDemo
{
  public static void main(String[] args)
  {
    String decodedText = "Hello World!";

    String encodedApacheText = MyCodec.apacheEncode(decodedText);
    String encodedJavaText = MyCodec.javaEncode(decodedText);

    System.out.println("Apache encoded text: " + MyCodec.apacheEncode(encodedApacheText));
    System.out.println("Java encoded text: " + MyCodec.javaEncode(encodedJavaText));

    System.out.println("Encoded results equal: " + encodedApacheText.equals(encodedJavaText));

    System.out.println("Apache decode Java: " + MyCodec.apacheDecode(encodedJavaText));
    System.out.println("Java decode Java: " + MyCodec.javaDecode(encodedJavaText));

    System.out.println("Apache decode Apache: " + MyCodec.apacheDecode(encodedApacheText));
    System.out.println("Java decode Apache: " + MyCodec.javaDecode(encodedApacheText));
  }
} 
```

**输出：**

```
Apache encoded text: U0dWc2JHOGdWMjl5YkdRaA0K

Java encoded text: U0dWc2JHOGdWMjl5YkdRaA==
Encoded results equal: false
Apache decode Java: Hello World!
Java decode Java: Hello World!
Apache decode Apache: Hello World!
Exception in thread "main" java.lang.IllegalArgumentException: Illegal base64 character d
    at java.util.Base64$Decoder.decode0(Base64.java:714)
    at java.util.Base64$Decoder.decode(Base64.java:526)
    at java.util.Base64$Decoder.decode(Base64.java:549) 
```

请注意，Apache 编码的文本末尾包含额外的换行符（空格）。因此，为了让我的编解码器无论 Base64 实现如何都能产生相同的结果，我必须调用`trim()`Apache 编码文本。就我而言，我只是将上述方法调用添加到我的编解码器`apacheDecode()`中，如下所示：

```
return Base64.encodeBase64String(decodedByteArr).trim(); 
```

进行此更改后，结果将是我期望的开始：

```
Apache encoded text: U0dWc2JHOGdWMjl5YkdRaA==
Java encoded text: U0dWc2JHOGdWMjl5YkdRaA==
Encoded results equal: true
Apache decode Java: Hello World!
Java decode Java: Hello World!
Apache decode Apache: Hello World!
Java decode Apache: Hello World! 
```

**结论**：如果你想从 Apache Base64 切换到 Java，你必须：

1.  使用 Apache 解码器解码编码文本。
2.  使用 Java 对结果（纯）文本进行编码。

如果您在不遵循这些步骤的情况下进行切换，您很可能会遇到问题。这就是我做出这个发现的原因。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2015-06-13T00:24:45.543

对于[Java 6](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_6) -7，最好的选择是从 Android 存储库中借用代码。它没有依赖关系。

[https://github.com/android/platform_frameworks_base/blob/master/core/java/android/util/Base64.java](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/util/Base64.java)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2013-06-03T15:00:18.937

要转换它，您需要一个编码器和解码器，您将从*[Base64Coder 获得 - 一个 Java 中的开源 Base64 编码器/解码器](http://www.source-code.biz/base64coder/java/)*。这是您需要的文件[Base64Coder.java 。](http://www.source-code.biz/base64coder/java/Base64Coder.java.txt)

现在要根据您的要求访问此类，您将需要以下类：

```
import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.InputStream;
import java.io.IOException;
import java.io.OutputStream;

public class Base64 {

    public static void main(String args[]) throws IOException {
        /*
         * if (args.length != 2) {
         *     System.out.println(
         *         "Command line parameters: inputFileName outputFileName");
         *     System.exit(9);
         * } encodeFile(args[0], args[1]);
         */
        File sourceImage = new File("back3.png");
        File sourceImage64 = new File("back3.txt");
        File destImage = new File("back4.png");
        encodeFile(sourceImage, sourceImage64);
        decodeFile(sourceImage64, destImage);
    }

    private static void encodeFile(File inputFile, File outputFile) throws IOException {
        BufferedInputStream in = null;
        BufferedWriter out = null;
        try {
            in = new BufferedInputStream(new FileInputStream(inputFile));
            out = new BufferedWriter(new FileWriter(outputFile));
            encodeStream(in, out);
            out.flush();
        }
        finally {
            if (in != null)
                in.close();
            if (out != null)
                out.close();
        }
    }

    private static void encodeStream(InputStream in, BufferedWriter out) throws IOException {
        int lineLength = 72;
        byte[] buf = new byte[lineLength / 4 * 3];
        while (true) {
            int len = in.read(buf);
            if (len <= 0)
                break;
            out.write(Base64Coder.encode(buf, 0, len));
            out.newLine();
        }
    }

    static String encodeArray(byte[] in) throws IOException {
        StringBuffer out = new StringBuffer();
        out.append(Base64Coder.encode(in, 0, in.length));
        return out.toString();
    }

    static byte[] decodeArray(String in) throws IOException {
        byte[] buf = Base64Coder.decodeLines(in);
        return buf;
    }

    private static void decodeFile(File inputFile, File outputFile) throws IOException {
        BufferedReader in = null;
        BufferedOutputStream out = null;
        try {
            in = new BufferedReader(new FileReader(inputFile));
            out = new BufferedOutputStream(new FileOutputStream(outputFile));
            decodeStream(in, out);
            out.flush();
        }
        finally {
            if (in != null)
                in.close();
            if (out != null)
                out.close();
        }
    }

    private static void decodeStream(BufferedReader in, OutputStream out) throws IOException {
        while (true) {
            String s = in.readLine();
            if (s == null)
                break;
            byte[] buf = Base64Coder.decodeLines(s);
            out.write(buf);
        }
    }
} 
```

在 Android 中，您可以将位图转换为 Base64 以上传到服务器或 Web 服务。

```
Bitmap bmImage = //Data
ByteArrayOutputStream baos = new ByteArrayOutputStream();
bmImage.compress(Bitmap.CompressFormat.JPEG, 100, baos);
byte[] imageData = baos.toByteArray();
String encodedImage = Base64.encodeArray(imageData); 
```

这个“encodedImage”是图像的文本表示。您可以将其用于上传或直接显示到 HTML 页面中，如下所示（[参考](http://dwij.co.in/java-base64-image-encoder/)）：

```
<img alt="" src="data:image/png;base64,<?php echo $encodedImage; ?>" width="100px" />
<img alt="" src="data:image/png;base64,/9j/4AAQ...........1f/9k=" width="100px" /> 
```

文档：[http ://dwij.co.in/java-base64-image-encoder](http://dwij.co.in/java-base64-image-encoder)

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2016-08-23T17:02:13.880

在 Android 上，使用[android.util.Base64](https://developer.android.com/reference/android/util/Base64.html)实用程序类的静态方法。引用的文档说 Base64 类是在 API 级别 8（[Android 2.2](https://en.wikipedia.org/wiki/Android_Froyo) (Froyo)）中添加的。

```
import android.util.Base64;

byte[] encodedBytes = Base64.encode("Test".getBytes());
Log.d("tag", "encodedBytes " + new String(encodedBytes));

byte[] decodedBytes = Base64.decode(encodedBytes);
Log.d("tag", "decodedBytes " + new String(decodedBytes)); 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-06-06T11:15:03.493

[Apache Commons](https://en.wikipedia.org/wiki/Apache_Commons)有一个很好的 Base64 实现。您可以这样做：

```
// Encrypt data on your side using BASE64
byte[] bytesEncoded = Base64.encodeBase64(str .getBytes());
System.out.println("ecncoded value is " + new String(bytesEncoded));

// Decrypt data on other side, by processing encoded data
byte[] valueDecoded= Base64.decodeBase64(bytesEncoded );
System.out.println("Decoded value is " + new String(valueDecoded)); 
```

*[您可以在使用 Java 和 JavaScript](http://faisalbhagat.blogspot.com/2014/06/base64-encoding-using-java-and.html)*的 Base64 编码中找到有关 base64 编码的更多详细信息。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2016-08-19T12:23:30.697

如果您使用的[Spring Framework](http://en.wikipedia.org/wiki/Spring_Framework)至少为 4.1 版本，则可以使用*org.springframework.util.Base64Utils*类：

```
byte[] raw = { 1, 2, 3 };
String encoded = Base64Utils.encodeToString(raw);
byte[] decoded = Base64Utils.decodeFromString(encoded); 
```

它将委托给 Java 8 的 Base64、Apache Commons Codec 或 JAXB DatatypeConverter，具体取决于可用的内容。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-11-15T20:27:40.177

Java 8 的简单示例：

```
import java.util.Base64;

String str = "your string";
String encodedStr = Base64.getEncoder().encodeToString(str.getBytes("utf-8")); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-03-14T17:48:56.627

在 Java 7 中，我编写了这个方法

```
import javax.xml.bind.DatatypeConverter;

public static String toBase64(String data) {
    return DatatypeConverter.printBase64Binary(data.getBytes());
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-08-12T11:59:00.513

如果您坚持使用早于 8 的 Java 版本，但已经在使用[AWS SDK for Java](https://aws.amazon.com/sdk-for-java/)，您可以使用[com.amazonaws.util.Base64](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/util/Base64.html)。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-03-04T12:27:09.077

我尝试使用以下代码片段。它运作良好。:-)

```
com.sun.org.apache.xml.internal.security.utils.Base64.encode("The string to encode goes here"); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-02-25T08:58:30.787

```
public String convertImageToBase64(String filePath) {
    byte[] fileContent = new byte[0];
    String base64encoded = null;
    try {
        fileContent = FileUtils.readFileToByteArray(new File(filePath));
    } catch (IOException e) {
        log.error("Error reading file: {}", filePath);
    }
    try {
        base64encoded = Base64.getEncoder().encodeToString(fileContent);
    } catch (Exception e) {
        log.error("Error encoding the image to base64", e);
    }
    return base64encoded;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-02-16T07:22:30.300

将此库添加到您的应用级别依赖项中

实施 'org.apache.commons:commons-collections4:4.4'

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2021-02-27T21:33:47.770

## GZIP + Base64

格式中字符串的长度`Base64`大于原始字符串的长度：`133%`平均而言。`GZIP`因此，首先用 压缩它，然后编码为是有意义的`Base64`。`77%`对于超过 200 个字符或更多字符的字符串，它最多可以减少。例子：

```
public static void main(String[] args) throws IOException {
    byte[] original = randomString(100).getBytes(StandardCharsets.UTF_8);

    byte[] base64 = encodeToBase64(original);
    byte[] gzipToBase64 = encodeToBase64(encodeToGZIP(original));

    byte[] fromBase64 = decodeFromBase64(base64);
    byte[] fromBase64Gzip = decodeFromGZIP(decodeFromBase64(gzipToBase64));

    // test
    System.out.println("Original: " + original.length + " bytes, 100%");
    System.out.println("Base64: " + base64.length + " bytes, "
            + (base64.length * 100 / original.length) + "%");
    System.out.println("GZIP+Base64: " + gzipToBase64.length + " bytes, "
            + (gzipToBase64.length * 100 / original.length) + "%");

    //Original: 3700 bytes, 100%
    //Base64: 4936 bytes, 133%
    //GZIP+Base64: 2868 bytes, 77%

    System.out.println(Arrays.equals(original, fromBase64)); // true
    System.out.println(Arrays.equals(original, fromBase64Gzip)); // true
} 
```

```
public static byte[] decodeFromBase64(byte[] arr) {
    return Base64.getDecoder().decode(arr);
}

public static byte[] encodeToBase64(byte[] arr) {
    return Base64.getEncoder().encode(arr);
} 
```

```
public static byte[] decodeFromGZIP(byte[] arr) throws IOException {
    ByteArrayInputStream bais = new ByteArrayInputStream(arr);
    GZIPInputStream gzip = new GZIPInputStream(bais);
    return gzip.readAllBytes();
}

public static byte[] encodeToGZIP(byte[] arr) throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    GZIPOutputStream gzip = new GZIPOutputStream(baos);
    gzip.write(arr);
    gzip.finish();
    return baos.toByteArray();
} 
```

```
public static String randomString(int count) {
    StringBuilder str = new StringBuilder();
    for (int i = 0; i < count; i++) {
        str.append(" ").append(UUID.randomUUID().toString());
    }
    return str.toString();
} 
```

* * *

^(另请参阅：[如何获取 sun.misc.BASE64Encoder 类的 JAR 文件？](https://stackoverflow.com/a/66411541/14940971))

# entity-framework - 如何返回 DbSet 可查询的 在 MVC4 api 控制器中？

> ID：13109589
> 
> 赞同：0
> 
> 时间：2012-10-28T14:21:17.403
> 
> 标签：entity-framework, c#-4.0, asp.net-mvc-4

我正在使用 MVC4 和实体框架。我想让 ApiController 称为 UserController 来根据用户的属性查询用户。我的用户实体具有姓名、电话号码、地址（复杂类型）等属性，应该可以根据这些数据查询和检索用户。但是用户也有我不想看到的密码、lastsync 等属性。目前我没有解决方案。以下为我提供了用户，但包括所有实体，以及我不想显示的实体。

```
public class UserController : BaseApiController
{
    public IQueryable<User> Get()
    {
        // _db is my entity framework DbContext
        return _db.Users; 
    }
} 
```

我以为我会将所有“公开”可见属性移至 ApiUser 类，并使 User 从 ApiUser 派生。然后我的想法是这样做：

```
public class UserController : BaseApiController
{
    public IQueryable<ApiUser> Get()
    {
        return _db.Users.AsQueryable<ApiUser>(); 
    }
} 
```

不幸的是，这不起作用我得到以下异常：

```
[InvalidOperationException: The type Repository.User was not expected. Use the XmlInclude or SoapInclude attribute to specify types that are not known statically.]
   Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriterDelegatingEnumerable1.Write2_ApiUser(String n, String ns, ApiUser o, Boolean isNullable, Boolean needType) +171
   Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriterDelegatingEnumerable1.Write3_ArrayOfApiUser(Object o) +297 
```

你知道我怎样才能达到我所需要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:53:50.310

您可以使用投影：

```
public IQueryable<ApiUser> Get()
{
    return _db.Users.Select(u => new ApiUser
    {
        Name = u.Name,
        PhoneNumber = u.PhoneNumber,
        Address = u.Address
    });
} 
```

并且不要衍生`User`自`ApiUser`或相反。

然后，您可以添加 - 例如 -`Where`对查询的扩展：

```
ApiUser apiUser = Get().Where(au => au.Name == "John Doe").SingleOrDefault(); 
```

# objective-c - 如何重复阵列启动？

> ID：13109593
> 
> 赞同：0
> 
> 时间：2012-10-28T14:21:40.330
> 
> 标签：objective-c, uitableview, download, nsmutablearray, plist

```
minecraftArray = [[NSMutableArray alloc] 
                 initWithContentsOfURL:[NSURL URLWithString:@"http://www.avicode.co.uk/iphone/minepedia/plists/minecraft.plist"]]; 
```

我想做的是每次出现视图时我都希望数组重新下载数据，当应用程序完全关闭时它们都重新下载（包括多任务处理），是否有强制再次下载。

# c# - 如果未安装访问权限，我的程序是否仍可运行

> ID：13109594
> 
> 赞同：3
> 
> 时间：2012-10-28T14:21:47.587
> 
> 标签：c#, excel, ms-access

我正在开发一个程序，该程序从 Excel 文件中检索信息并将该信息转换为将其存储在 Access 数据库中并稍后使用。该程序将在其上运行的计算机确实安装了 Excel，但我不确定它是否具有 Access。我只是想知道我的程序在这种情况下是否可以工作，或者 Access 肯定应该安装在另一台计算机上？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T03:25:53.463

答案是：视情况而定。

*   如果您的目标是`mdb`Access 文件，则[Jet 数据库引擎](http://en.wikipedia.org/wiki/Microsoft_Jet_Database_Engine)预装在 Windows 中，因此您不需要安装任何东西（`x86`但请确保它已编译，`AnyCPU`否则它可能无法在 64 位系统上运行）。

*   如果您使用的是 Access 2007/2010/2013 更新`accdb`的格式，则目标计算机必须安装[Access 数据库引擎](http://www.microsoft.com/en-us/download/details.aspx?id=13255)（正如[KekySemau 所](https://stackoverflow.com/a/13111352/3811)回答的那样）。
    但请注意：您只能安装 32 位*或*64 位版本，并且您自己的程序位数必须与驱动程序的位数相匹配。
    此外，如果用户安装了另一个版本的 MS Office（32 位或 64 位），您将无法安装该引擎（尽管如果他们有 Office 2007 或更高版本，则应该已经安装了该引擎）。

简短的回答：如果你坚持使用`mdb`，你不需要安装任何额外的东西。在任何情况下，请确保为`x86`架构明确编译 C# 应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T17:45:07.963

用户可能需要安装 Access 数据库引擎（免费下载）：
[http ://www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

> 安装了 ODBC 和 OLEDB 驱动程序，供应用程序开发人员在开发与 Office 文件格式连接的应用程序时使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T17:09:32.247

如果您使用的是 Microsoft OleDbConnection，则需要在客户端 PC 上安装[Access Runtime 。](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=4438)

# javascript - 用于启动另一个 javascript 的 Javascript 链接

> ID：13109596
> 
> 赞同：0
> 
> 时间：2012-10-28T14:22:13.013
> 
> 标签：javascript, hyperlink

我有一个问题是否可以链接一个项目来启动另一个 javascript？可能带有点击功能？

以便只有在您单击导航栏上的项目后才会启动 javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:24:45.057

是的，使用事件处理程序。

```
<a href="#" onclick="alert('you clicked me');">click me</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:28:43.557

是的，这是可能的

例如这种方式：

```
<script type="text/javascript">
    function dosomething( link ) {
        alert("Hey, this is " + link );
    }
</script>

<a href="javascript:dosomething( this );">click me</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:29:42.167

你当然可以：

```
<a id="test" href="javascript:;">Test</a>

<script type="text/javascript">
var test_object = document.getElementById('test');
test_object.onclick = function() {
    alert('hello!');
}
</script> 
```

# html - 如何在多部分消息的 Outlook 新邮件弹出窗口中显示纯文本

> ID：13109599
> 
> 赞同：1
> 
> 时间：2012-10-28T14:22:16.947
> 
> 标签：html, outlook, swiftmailer, plaintext

我正在结合使用 Swiftmailer 类和 Zend 框架从我的网站发送邮件。该消息是 html 和纯文本的混合，我已经这样实现它：

```
// Or set it after like this
$message->setBody('My <em>amazing</em> body', 'text/html');

// Add alternative parts with addPart()
$message->addPart('My amazing body in plain text', 'text/plain'); 
```

就像文档中的这个摘录一样。问题是，outlook 的蓝色新邮件通知弹出窗口在该部分之后显示了 html 消息的前两行。因此，例如，显示标签。如何使用 Swiftmailer 类格式化我的消息，以便 Outlook 使用纯文本表示进行预览？我知道这是可能的，因为从 Outlook 本身发送 html 邮件不会在预览弹出窗口中产生标签。提前感谢您的任何提示！

# json - 将 JSON 数组附加到现有的 Extjs 数据存储网格面板

> ID：13109619
> 
> 赞同：3
> 
> 时间：2012-10-28T14:24:00.830
> 
> 标签：json, extjs, extjs4

我需要一个简单的示例来重新加载 Extjs 网格的数据存储，基本要求是将 Extjs json 数据存储附加到另一个 json 数组。请帮助我完成此代码以在 Extjs Grid 面板中加载 data2（json 对象）。

```
 Ext.onReady(function () {
            var store = Ext.create('Ext.data.Store', {
                storeId: 'employeeStore',
                fields: ['name', 'seniority', 'department'],
                groupField: 'department',
                data: {
                    'employees': [{
                        "name": "Michael Scott",
                        "seniority": 7,
                        "department": "Management"
                    }, {
                        "name": "Dwight Schrute",
                        "seniority": 2,
                        "department": "Sales"
                    }, {
                        "name": "Jim Halpert",
                        "seniority": 3,
                        "department": "Sales"
                    }, {
                        "name": "Kevin Malone",
                        "seniority": 4,
                        "department": "Accounting"
                    }, {
                        "name": "Angela Martin",
                        "seniority": 5,
                        "department": "Accounting"
                    }, {
                        "name": "Angela Martin",
                        "seniority": 5,
                        "department": "Accounting"
                    }]
                },
                proxy: {
                    type: 'memory',
                    reader: {
                        type: 'json',
                        root: 'employees'
                    }
                }
            });
            Ext.create('Ext.grid.Panel', {
                title: 'Employees',
                store: Ext.data.StoreManager.lookup('employeeStore'),
                columns: [{
                    text: 'Name',
                    dataIndex: 'name'
                }, {
                    text: 'Seniority',
                    dataIndex: 'seniority'
                }, {
                    text: 'department',
                    dataIndex: 'department'
                }],

                width: 520,
                height: 275,
                renderTo: Ext.getBody()
            });

            var data2 = {
                'employees': [{
                    "name": "User1",
                    "seniority": 7,
                    "department": "Management"
                },{
                    "name": "User2",
                    "seniority": 7,
                    "department": "Management"
                }]
            };

        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T14:43:08.573

```
Ext.getStore('employeeStore').add(data2.employees); 
```

查看[Ext.data.Store#add](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.Store-method-add)文档以获取更多信息。

**注意**：`Ext.getStore()`是一个快捷方式`Ext.data.StoreManager.lookup()`。

# java - 导入数据库驱动

> ID：13109621
> 
> 赞同：0
> 
> 时间：2012-10-28T14:24:06.410
> 
> 标签：java, mysql, jdbc

为什么每次，每个人都导入（或者这不是导入）

```
Class.forName("com.mysql.jdbc.Driver").newInstance(); 
```

当我

```
import com.mysql.jdbc.Driver; 
```

显示通知

> 他从未使用过 import com.mysql.jdbc.Driver

这两者有什么区别？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T14:33:53.127

当您实际上不知道必须加载哪个类时，您可以使用工厂方法。
在您的情况下，它`Class.forName`位于数据库驱动程序类上。
加载类是 JVM 的运行时指令，因此`import ...`在这种情况下不需要该语句。

就像您使用`import ...`特定的类一样，Java 编译器会尝试在正在编译的类中使用它之前找到并加载它。在您的示例情况下，当您导入一个类并且从未在代码中使用它时，通常是您正在编写代码的 IDE，例如 MyEclipse，您将被通知导入的类从未使用过。这不是错误或警告，但您可以安全地删除以减少编译器的负载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:25:36.850

使用时不需要导入`Class.forName`，因为它使用[反射](http://docs.oracle.com/javase/tutorial/reflect/class/classNew.html)。

# javascript - 是否可以在 Javascript 中动态设置我想绑定的事件？

> ID：13109622
> 
> 赞同：1
> 
> 时间：2012-10-28T14:24:06.133
> 
> 标签：javascript, jquery, events, dynamic, event-handling

我目前正在使用这个：

```
if ( $.support.touch == true ) {
    $(window).on('orientationchange', function(event){
        if ( full == false ) {
            self.hideAllPanels("7");
        }
    });
} else {
    $(window).on('orientationchange resize', function(event){
        if ( full == false ) {
            self.hideAllPanels("7");
        }
    });
} 
```

因为当我不需要它们时，我会在触摸设备上触发很多调整大小事件。

我还尝试了以下语法：

```
$(window).on( ( 'orientationchange'+ ( $.support.touch ? '': ' resize') ), function(event){
    ...
}); 
```

但这会在 Firefox 中产生错误（`app.start()`未在第 1 行定义 - 这是我的应用程序，所以这并不能告诉我太多）。切换回第一个语法，一切正常。

**问题**：
是否可以动态设置我要绑定的事件？如果是这样，在这种情况下正确的语法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:36:43.760

这是怎么回事

```
function handler( event ) {
    if ( full == false ) {
        self.hideAllPanels("7");
    }
}

$(window).on('orientationchange', handler );

if ( !$.support.touch ) {
    $(window).on( 'resize', handler);
} 
```

对我来说看起来更干净

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:37:29.687

这未经测试，但您可以通过以下方式进行测试：

```
function handler(event) {
    if ( full == false ) {
        self.hideAllPanels("7");
    }
}
$(window).on('orientationchange', handler);
if ( ! $.support.touch ) {
    $(window).on('resize', handler);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:37:51.467

可以最小化代码重复做这样的事情：

```
 var events = $.support.touch ? 'orientationchange' : 'orientationchange resize';

$(window).on(events, function(event) {
    if (full == false) {
        self.hideAllPanels("7");
    }
}); 
```

# ios - NSDate 希伯来语日期标签

> ID：13109624
> 
> 赞同：1
> 
> 时间：2012-10-28T14:24:07.460
> 
> 标签：ios, nsdate, hebrew

我用今天的日期制作标签，但我需要今天的希伯来日期。

这是我的代码

```
NSDate *today = [NSDate date];
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateStyle:NSDateFormatterShortStyle];
NSString *dateString = [dateFormat stringFromDate:today];
[_label setText:dateString]; 
```

我没有为今天的日期建立日历这个标签。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T16:09:03.423

假设用户的当前语言环境未设置为希伯来语，那么您需要确保日期格式化程序的语言环境设置为希伯来语，

```
NSLocale *hebrew = [[NSLocale alloc] initWithLocaleIdentifier:@"he_IL"]; // Hebrew, Israel
NSDate *today = [NSDate date];
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
dateFormat.locale = hebrew;
[dateFormat setDateStyle:NSDateFormatterShortStyle];
NSString *dateString = [dateFormat stringFromDate:today];
[_label setText:dateString]; 
```

该代码仍将使用用户当前语言环境的日历（例如公历）。如果您还需要希伯来日历，那么您需要这个：

```
NSLocale *hebrew = [[NSLocale alloc] initWithLocaleIdentifier:@"he_IL"]; // Hebrew, Israel
NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSHebrewCalendar];
NSDate *today = [NSDate date];
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
dateFormat.locale = hebrew;
dataFormat.calendar = calendar;
[dateFormat setDateStyle:NSDateFormatterShortStyle];
NSString *dateString = [dateFormat stringFromDate:today];
[_label setText:dateString]; 
```

# php - 模型中的 Kohana ORM 多重关系

> ID：13109626
> 
> 赞同：1
> 
> 时间：2012-10-28T14:24:14.590
> 
> 标签：php, orm, model, kohana

我是新手，正在使用 Gallery3 中的一个模块，该模块已被废弃并希望添加一些功能。我已经搜索了所有内容，但无法找到解决方案。

我有以下表格。

```
Products {id, name, description, cost, discount_id, postage_id)
Discounts {id, name, threshold, amount, maxamount)
Postage_bands {id, name, flatrate, peritem) 
```

我添加了折扣以根据消费金额为客户提供折扣。我基于现有的 Postage 表并复制了相关页面，以便它们使用新的 Discount 功能。我希望产品的管理页面列出与每个产品相关的折扣和邮资。

折扣的管理页面工作得很好。

我遇到的问题是产品与折扣和邮资之间的关系。我只能让其中一个工作。

有模型，每个模型都在自己的文件中。

```
class Product_Model extends ORM {
  var $rules = array(
    "name" => "length[1,32]",
    "description" => "length[0,255]");
    protected $belongs_to=array('discount');
    protected $belongs_to=array('postage_band');
}

class Postage_Band_Model extends ORM {
    var $rules = array(
    "name" => "length[1,32]");
    protected $has_many=array('products');
}

class Discount_Model extends ORM {
    var $rules = array(
    "name" => "length[1,32]");
    protected $has_many=array('products');
} 
```

显示与折扣或邮资相关信息的视图页面中的代码是

```
<?= html::clean($product->discount->name) ?>
or
<?= html::clean($product->postage_band->name) ?> 
```

我只能通过注释掉 Products_model 中的 Discount 或 Postage 行以及在视图页面中显示它的代码来使其中一个工作正常。

如何获得一个表中列的关系以处理两个单独表中的列。在这种情况下

*   Products.discount_id 到 Discounts.id，所以我可以指向 Discounts 表中的名称字段。
*   Products.postage_id 到 Postage_bands.id，所以我可以指向 Postage_bands 表中的名称字段。

或这些表中的任何其他字段，如果我需要的话。

提前致谢

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:30:27.893

您要声明 $belongs_to 两次。尝试：

```
class Product_Model extends ORM {

    protected $belongs_to=array('discount', 'postage_band');
} 
```

另外，我认为是 $_belongs_to

# java - 我的自定义 JTextField 被 super.paintComponent(g) 方法覆盖

> ID：13109638
> 
> 赞同：1
> 
> 时间：2012-10-28T14:25:49.720
> 
> 标签：java, swing, jtextfield, paintcomponent

我通过扩展 JtextField 类和覆盖 paintComponent(Graphics g) 方法创建了一个自定义 JTextField。当我编译并拖入 JFrame 时，它​​可以正常工作。但是当我运行它时，结果是不同的。

我的自定义 JTextField 被白色方块覆盖，我怀疑这是 super.paintComponent(g); 的结果；方法。

这是我在 paintComponent() 方法上的代码；

```
@Override
protected void paintComponent(Graphics g) {
    Graphics2D gd = (Graphics2D) g.create();
    gd.setPaint(new GradientPaint(0, 0, Color.BLUE, getWidth(), 0, Color.BLACK));
    gd.fillRoundRect(0, 0, getWidth(), getHeight(), getWidth() / 2, getHeight() / 2);
    gd.dispose();
    super.paintComponent(g);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:59:16.020

移动`super.paintComponent(g)`到您的顶部`paintComponent`。通过这种方式，您可以确保在超类`paintComponent`执行后完成自定义绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T11:29:45.143

```
//Here is a example for Custom JTextfeild

1\. This supports highlighting Jtextfeild with Icons.

2\. This custom Jtextfeild with different fonts.

  Header Section
---------------------
import java.awt.*;  
import java.awt.event.FocusEvent;
import java.awt.event.FocusListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;  
import javax.swing.*;  
import javax.swing.border.Border;

//Main class section 

    public class CustomJTextFeild extends JTextField implements FocusListener,KeyListener{
          private Color color;
          private ImageIcon normal_icon;
          private ImageIcon hover_icon;
          private ImageIcon icon_Label;
          private boolean start_action=false;
          private String Matchtext;
          private int x0 ;

 //Constructor with input parameters
 //icon ->  normal icon
 //icon 1-> hover icon
 //text ->  initial text 

     public  CustomJTextFeild(ImageIcon icon,ImageIcon icon1, String text) { 

        this.normal_icon=icon;
            this.hover_icon=icon1;
            this.icon_Label=normal_icon;
            this.Matchtext=text;

            Font myFont = new Font("Segoe UI", Font.BOLD,12);
            setFont(myFont);
            Border border = UIManager.getBorder("TextField.border");  
            x0 = border.getBorderInsets(new JTextField()).left;  
            Border Textborder = BorderFactory.createLineBorder(new Color(0xd4d4d4 , false), 2 );
            setBorder(BorderFactory.createCompoundBorder(Textborder, 
            BorderFactory.createEmptyBorder(0,5 + icon_Label.getIconWidth(), 0, 0)));
            setText(text);
            addFocusListener(this) ; 
            addKeyListener(this) ; 

        }

    @Override
    public void paintComponent(Graphics g) {

       int y = (this.getHeight() - icon_Label.getIconHeight())/2;  
       super.paintComponent(g);  
       g.drawImage(icon_Label.getImage(), x0, y, this);   

    }

    @Override
    public void focusGained(FocusEvent e) {
        // TODO Auto-generated method stub
        if(e.getSource() == this && !this.start_action)
            this.setText("");

         this.icon_Label=hover_icon;
         this.repaint();
         this.revalidate();

    }
    @Override
    public void focusLost(FocusEvent arg0) {
        // TODO Auto-generated method stub
        if(!this.start_action || this.getText().length()==0)
           this.setText(this.Matchtext);

         this.icon_Label=normal_icon;
         this.repaint();
         this.revalidate();
    }
    @Override
    public void keyPressed(KeyEvent arg0) {
        // TODO Auto-generated method stub

    }
    @Override
    public void keyReleased(KeyEvent arg0) {
        // TODO Auto-generated method stub

    }
    @Override
    public void keyTyped(KeyEvent arg0) {
        // TODO Auto-generated method stub
        this.start_action=true;
    }

    }  

/* Output */

 JtextFeild name_Value=new CustomJTextFeild(   new ImageIcon(getClass().getResource("filename1")).getImage(), new ImageIcon(getClass().getResource("filename")).getImage(),"Name"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-08T16:55:56.520

*我知道这个问题已经很老了，但是我在寻找其他东西时偶然发现了它，并认为我会为遇到它的其他人加两分钱。*

**原因**： OPs 报告问题的原因与他假设的完全一样......即在`super.paintComponent(g)`他的自定义绘画代码上有效绘画的行为。

但是......他发布的代码并没有什么问题。它确实/将起作用，我必须分别不同意 DanD 建议的答案。不幸的是，OP 没有包含更多示例代码，因此只能推测他的确切问题。

嗯？你问。那么怎么回事呢？

**修复**：很简单，如果您想使用这种方法自定义 JTextField 的外观，那么您必须有效地告诉超类不要在您的自定义绘画上进行绘画。这是通过在组件上设置以下属性值来完成的：

```
text.setOpaque(false);
text.setBorder(null); 
```

通过这种方式，您可以让所有代码保持原样，并且您实际上是在告诉原始的 paintComponent() 方法不要绘制背景颜色或绘制边框。

我提供以下 SSCCE 作为示例和解决方案。请注意以下事项：

1.  我创建了一个静态布尔值“FIXIT”。希望不用说您不会将其包含在“生产”代码中；它在示例中被使用以允许您观察这两种行为。只需切换其值即可查看“之前”和“之后”。

2.  更重要的是（IMO），请注意我在自定义代码类的外部设置了提到的属性值。我这样做是为了更符合 OP 提出问题的方式，并且这种方法不需要更改他的自定义类。但是，正如代码中的注释所述，更强大的解决方案将在自定义类构造函数中设置这些值以确保它们的正确性。

3.  我还提供了一种更具视觉吸引力的绘画方法。虽然它几乎与原版相同，但请参阅所做调整的评论。当然，这只是我的观点，但仍作为示例提供。

```
package misc;

import java.awt.Color;
import java.awt.GradientPaint;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridBagLayout;
import java.awt.RenderingHints;

import javax.swing.JFrame;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;

/**
 * An SSCCE in response to the following StackOverflow question:
 * https://stackoverflow.com/questions/13109638/my-custom-jtextfield-covered-by-super-paintcomponentg-method
 * 
 * @author kansasSamurai
 *
 */
@SuppressWarnings("serial")
public class CustomTextField extends JTextField {

    private static boolean FIXIT = true;

    public static void main(String args[]) {

        SwingUtilities.invokeLater( new Runnable() {
            @Override public void run() { createAndShowGUI(); }
        } );

    }

    protected static void createAndShowGUI() {
        JFrame frame = new JFrame("SSCCE - CustomTextField");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(new GridBagLayout());

        CustomTextField text = new CustomTextField();
        text.setText("  Ipsum Lorem  "); 
            if (FIXIT) {
                // These two lines are NECESSARY...
                text.setOpaque(false);
                text.setBorder(null);
                // or!!! ... they could/should be added to the constructor(s) of your custom class

                // These two lines are OPTIONAL
                text.setForeground(Color.white);
                text.setCaretColor(Color.white);
            }
        frame.getContentPane().add(text);

        frame.pack();
        frame.setSize(330, 100); // these dimensions are "arbitrary"
        frame.setLocationRelativeTo(null); // centers the frame on screen
        frame.setVisible(true);
    }

    @Override
    protected void paintComponent(Graphics g) {
        if (FIXIT) {
            this.betterPaint(g);
            return;
        }

        final Graphics2D gd = (Graphics2D) g.create();
        gd.setPaint(new GradientPaint(0, 0, Color.BLUE, getWidth(), 0, Color.BLACK));
        gd.fillRoundRect(0, 0, getWidth(), getHeight(), getWidth() / 2, getHeight() / 2);
        gd.dispose();

        super.paintComponent(g);
    }

    protected void betterPaint(Graphics g) {
        final Graphics2D gd = (Graphics2D) g.create();

        // Improve appearance by enabling antialiasing
        gd.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

        gd.setPaint(new GradientPaint(0, 0, Color.BLUE, getWidth(), 0, Color.BLACK));

        // Fully rounded ends (not strictly required to fixit... just an example)
        gd.fillRoundRect(0, 0, getWidth(), getHeight(), getHeight(), getHeight());

        gd.dispose();

        super.paintComponent(g);
    }

} 
```

# android - ActivityGroup 调用 getParent()

> ID：13109639
> 
> 赞同：1
> 
> 时间：2012-10-28T14:25:58.083
> 
> 标签：android, activitygroup

我现在被这个问题困扰了一段时间。

我在程序代码中尝试的内容：

text_notice.setOnClickListener(new OnClickListener() { public void onClick(View v) {

```
 context = getParent();
            Log.i("", "Parent " + context.toString());

            edit_notice = new Dialog(context);
            edit_notice.setContentView(R.layout.edit_notice);
            edit_notice.setTitle(R.string.notice);

            final Button ok_button = (Button) edit_notice.findViewById(R.id.ok_button);
            final EditText notice_text = (EditText) edit_notice.findViewById(R.id.notice);

            ok_button.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    race.setNotice(notice_text.getText().toString());
                    raceDao = HelperSingleton.getInstance().getHelper().getRaceDaoException();
                    raceDao.update(race);
                    text_notice.setText(race.getNotice());
                    edit_notice.dismiss();
                } 
            });
            edit_notice.show();
            } 
    }); 
```

所以基本上向ActivityGroup添加一个窗口。

如果我走这条路，这段代码可以正常工作：RowCoachActivity --> ResultsActivity --> ShowDetailsActivity

一旦我尝试获取此路径： SettingsActivity --> RowCoachActivity --> ResultsActivity --> ShowDetailsActivity

应用程序崩溃。

有人可以帮我吗？

来自设置的调用：//结束之前的 RowCoachActivity RowCoachActivity.h.sendEmptyMessage(0);

```
 Intent result_intent = new Intent(SettingsActivity.this, RowCoachActivity.class);
            Window window = getLocalActivityManager().startActivity("RowCoachActivity", result_intent); 
```

这是我的日志：

> E/AndroidRuntime(611): FATAL EXCEPTION: main 10-28 15:09:04.192: E/AndroidRuntime(611): android.view.WindowManager$BadTokenException: Unable to add window -- token android.app.LocalActivityManager$LocalActivityRecord@ 44f68e40 无效；您的活动正在运行吗？10-28 15:09:04.192: E/AndroidRuntime(611): 在 android.view.ViewRoot.setView(ViewRoot.java:505) 10-28 15:09:04.192: E/AndroidRuntime(611): 在 android. view.WindowManagerImpl.addView(WindowManagerImpl.java:177) 10-28 15:09:04.192: E/AndroidRuntime(611): 在 android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91) 10-28 15:09: 04.192: E/AndroidRuntime(611): 在 android.view.Window$LocalWindowManager.addView(Window.java:424) 10-28 15:09:04.192: E/AndroidRuntime(611): 在 android.app.Dialog.show (Dialog.java:241) 10-28 15:09:04.192: E/AndroidRuntime(611): at com.

# c++ - 错误 C2143：语法错误：缺少“；” 前 '。'

> ID：13109640
> 
> 赞同：1
> 
> 时间：2012-10-28T14:25:59.893
> 
> 标签：c++, syntax-error

有问题的行似乎只是

```
Parser2.Parse("E:\\Dropbox\\Sch\\CS3201\\Assignments\\SIMPLE.txt"); 
```

在包含文件中定义

```
#include "Parser2.cpp" 
```

* * *

**[完整来源](http://pastie.org/5127649)**

这里有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:29:46.337

`Parse`是一个静态方法，所以你需要

```
Parser2::Parse("E:\\Dropbox\\Sch\\CS3201\\Assignments\\SIMPLE.txt"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:30:03.740

Parser2::Parse 因为它是静态方法。

# clgeocoder - CLGeocoder reverseGeocodeLocation 无法执行

> ID：13109641
> 
> 赞同：2
> 
> 时间：2012-10-28T14:26:14.370
> 
> 标签：clgeocoder

当我使用'MKReverseGeocoder'从协调中获取地址时一切正常，例如以下源代码：

```
 MKReverseGeocoder *geocoder = [[MKReverseGeocoder alloc]
                                   initWithCoordinate:self.currentLocation.coordinate];
    geocoder.delegate = self;

    [geocoder start];

}

- (void)reverseGeocoder:(MKReverseGeocoder *)geocoder didFindPlacemark:(MKPlacemark *)placemark {
    NSLog(@"%@", placemark);
}

- (void)reverseGeocoder:(MKReverseGeocoder *)geocoder didFailWithError:(NSError *)error {
    NSLog(@"%@", error);
} 
```

但是，当我像这样使用“CLGeocoder”时：

```
 [geocoder reverseGeocodeLocation:self.currentLocation completionHandler:^(NSArray *placemarks, NSError *error) {
    NSLog(@"reverseGeocodeLocation:completionHandler: Completion Handler called!");
    if (error){
        NSLog(@"Geocode failed with error: %@", error);
        return;
    }
    NSLog(@"Received placemarks: %@", placemarks);
}]; 
```

我什么也没得到，而且我猜代码在调试时根本没有执行，因为我在输出控制台上没有找到任何信息。

谁能告诉我怎么了？？谢谢你。

# scala - 错误：具有默认参数的多态表达式

> ID：13109643
> 
> 赞同：8
> 
> 时间：2012-10-28T14:26:25.867
> 
> 标签：scala, default-value, type-inference

以下问题使我感到困惑：

```
trait Foo[A]
class Bar[A](set: Set[Foo[A]] = Set.empty) 
```

这产生

```
<console>:8: error: polymorphic expression cannot be instantiated to expected type;
 found   : [A]scala.collection.immutable.Set[A]
 required: Set[Foo[?]]
       class Bar[A](set: Set[Foo[A]] = Set.empty)
                                           ^ 
```

不得不在`Set.empty`. 为什么使用此默认参数进行类型推断会失败？以下作品：

```
class Bar[A](set: Set[Foo[A]] = { Set.empty: Set[Foo[A]] }) 
```

* * *

请注意，这与以下内容无关`Set`：

```
case class Hallo[A]()
class Bar[A](hallo: Hallo[A] = Hallo.apply)  // nope 
```

奇怪的是，这不仅有效：

```
class Bar[A](hallo: Hallo[A] = Hallo.apply[A]) 
```

......还有这个：

```
class Bar[A](hallo: Hallo[A] = Hallo())      // ??? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T17:48:56.817

您可以直接在`empty`方法上指定类型，而不必添加额外的一组括号/大括号和类型注释：

```
class Bar[A]( set: Set[Foo[A]] = Set.empty[Foo[A]] ) 
```

~~至于为什么类型推断失败，请看这些问题：~~

*   [~~设置失败的类型推断？~~](https://stackoverflow.com/questions/5544536/type-inference-on-set-failing)
*   [~~通过调用 toSet 丢失参数类型错误~~](https://stackoverflow.com/questions/13097399/missing-parameter-type-error-by-calling-toset)

**更新：**

我很抱歉，我仓促的回答太离谱了。上面帖子中的问题与此问题无关。@TravisBrown 在上面的评论中提出了一个非常好的观点。起初这似乎有效：

```
class Bar[A]( set: Set[A] = Set.empty ) 
```

但是，如果您实际上尝试调用构造函数，它会在使用站点失败：

```
new Bar[Int]
//  <console>:9: error: type mismatch;
//   found   : scala.collection.immutable.Set[Nothing]
//   required: Set[Int]
//  Note: Nothing <: Int, but trait Set is invariant in type A.
//  You may wish to investigate a wildcard type such as `_ <: Int`. (SLS 3.2.10)
//  Error occurred in an application involving default arguments.
//                new Bar[Int] 
```

这表明编译器不会强制默认参数对所有人有效`A`，只是对某些人有效`A`。他们可能做出了这样的选择，因此您可以执行以下操作：

```
scala> case class MyClass[T](set: Set[T] = Set(0))
defined class MyClass

scala> MyClass() // defaults to MyClass[Int]
res0: MyClass[Int] = MyClass(Set(0))

scala> MyClass(Set('x)) // but I can still use other types manually
res1: MyClass[Symbol] = MyClass(Set('x)) 
```

但是，任何类型的参数化类型的嵌套都无法在构造函数的声明站点进行类型检查：

```
class Bar[A]( set: Set[Option[A]] = Set.empty )
// <console>:7: error: polymorphic expression cannot be instantiated to expected type;
//  found   : [A]scala.collection.immutable.Set[A]
//  required: Set[Option[?]]
//        class Bar[A]( set: Set[Option[A]] = Set.empty ) 
```

如果类型参数处于协变位置，则推理不会失败：

```
class Bar[ A ]( set: List[Foo[A]] = List.empty ) // OK

class Bar[ A ]( set: Map[Int,Foo[A]] = Map.empty ) // OK (unless you use it)

class Bar[ A ]( set: Map[Foo[A],Int] = Map.empty ) // BAD
// <console>:8: error: polymorphic expression cannot be instantiated to expected type;
//  found   : [A, B]scala.collection.immutable.Map[A,B]
//  required: Map[Foo[?],Int]
//            class Bar[ A ]( set: Map[Foo[A],Int] = Map.empty ) // BAD
//                                                       ^ 
```

这些是有效的，因为编译器`Nothing`默认选择协变类型。这适用于`List`，但如果您实际尝试调用它，则上面的第二个示例不起作用。

大多数这种怪异的原因可能是 Scala 处理默认参数的方式。编译器会自动向伴生对象添加一个额外的方法，然后无论您遗漏一个参数，编译器都会自动向伴生对象中的新方法添加一个方法调用，以生成缺少的参数。看起来将默认参数抽象为一个方法会破坏类型推断中的一些东西，这些东西可以用于正常的赋值。

我认为这些发现中的大多数都非常令人困惑。我从中得到的是，实际测试您的默认参数以确保它们在您尝试使用它们时不会破坏类型正确性非常重要！

# c++ - 为什么我不能删除向量中的元素？

> ID：13109645
> 
> 赞同：1
> 
> 时间：2012-10-28T14:26:28.127
> 
> 标签：c++, vector, erase

我正在处理一个相当长的程序，并且很难从向量中删除元素。我试图用一个非常简单的向量来做到这一点，并且遇到了同样的问题。据我所知，我的做法与每个人在其他人的问题中解释的方式相同。这是简单的代码。

```
vector<int> vect;
vect.push_back(3);
vect.push_back(2);
cout << vect[1];  // prints '2'
vect.erase(vect.begin()+1);
cout << vect[1] << endl; // prints '2' 
```

我究竟做错了什么？

上面的代码似乎有效，因为我检查了最后的大小，它打印了“1”。真正的代码虽然没有：

```
size = A[i]->B().size();
cout << "size is " << A[i]->B().size() << endl;  // prints 21
A[i]->B().erase(A[i]->B().begin()+size);
cout << "size now " << A[i]->B().size() << endl;  // prints 21 
```

我看不出我做了什么不同的事情？A是一个向量，它存储了其他向量。我想删除 B 向量中的最后一个元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:27:44.357

擦除元素后，向量的大小变为 1（因为在擦除之前为 2），本质上使您的表达式`vect[1]`导致未定义的行为，因为不再有具有索引的元素`1`。剩下的就是一个元素（值 = 3，索引 = 0）。如果你使用`vect.at(1)`而不是`vect[1]`，它会抛出`std::out_of_range`.

编辑后：请记住，如果大小为`N`，则`N`不是向量的有效索引！！！元素被索引`0, 1, 2, ... N-1`。所以确实，大小是`1`，因此唯一有效的索引是`0`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:29:39.257

你正在做的是*未定义的行为*。基本上，您正在访问向量的当前最后一个元素，并且您碰巧找到了留在此处的垃圾。`at`使用而不是`[]`访问元素使问题变得明显，因为`at`具有内置的范围检查。

```
// cout << vect[1] << endl;
cout << vect.at(1) << '\n'; 
```

如果您`[]`按`at`上述方式替换，您将收到一个`std::out_of_range`异常，表明您提供的索引无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-02T20:44:42.463

要删除向量中的最后一个元素，您可以使用`.pop_back()`. 您还应该注意，将整数添加到迭代器是一个坏主意。改为`vector<int>::iterator`用作要添加的变量。

# c++ - 哪个客户在说话？

> ID：13109646
> 
> 赞同：2
> 
> 时间：2012-10-28T14:26:39.097
> 
> 标签：c++, c, linux

我有这个简单的服务器，5 个客户端可以连接到。现在的问题是我如何决定此刻谁在说话？它适用于一个客户端，因为它使用相同的**i**读取和发送。当有 2 个客户端连接时，我想发送与发送该消息的客户端相关联的某种类型的唯一 ID，因此下次发送消息时，该 ID 应该与宝贵消息的 ID 相同。

完成连接、发送和接收的服务器代码的小片段。

```
while (true)
    {
    this->readingSockets = this->openSockets;
    this->socketBind = select(getdtablesize(), &this->readingSockets, NULL, NULL, (struct timeval *)NULL);
    if (FD_ISSET(sD, &this->readingSockets)) 
        {
            cD = accept(sD, (struct sockaddr *)&this->clientAdr,(socklen_t*) &this->sCadr);
            FD_SET(cD, &this->openSockets);
            continue; 
        }

for (int i=0; i<getdtablesize(); i++)
        if (i != sD && FD_ISSET(i, &this->readingSockets)) 
            {
                this->socketBind = read(i, this->buf, sizeof(buf));
                g1.cast(buf,id);//where i'd like to send that unique id
                if (this->socketBind == 0)
                {
                    FD_CLR(i, &this->openSockets);
                    close(i);
                }
                else 
                {
                    send(i,g1.getA(),g1.getSize(),0);
                    g1.setMsg(c);
                }
            }
    } 
```

此致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:42:00.467

您知道五个客户端中的每一个在自己的文件描述符上都有自己的连接（因为您已经分别接受了每个连接），因此您可以通过跟踪您正在使用的文件描述符来分析您正在与哪个客户端交谈。对于客户端的身份，您可以查找带有`getpeername()`套接字文件描述符和地址结构的对等名称。

正如我所看到的，唯一可能会变得混乱的是，如果套接字是由一个进程建立的，并且该进程然后分叉并且多个进程最终使用该套接字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T18:21:49.017

创建某种结构：

```
struct GameClient
{
    int socket;
    char ip_address[30];
    int user_id;
    //etc
}; 
```

维护这些连接的[std::map ：](http://www.cplusplus.com/reference/stl/map/)

```
std::map<int, GameClient> current_clients; 
```

当您从 socket 读取时`sock_fd`，只需获取信息：

```
 GameClient* current_client = &current_clients[sock_fd]; 
```

当客户端断开连接时：

```
current_clients.erase(sock_fd); 
```

# git - 授予对 Git 存储库的访问权限，但无法合并回来

> ID：13109648
> 
> 赞同：1
> 
> 时间：2012-10-28T14:26:51.720
> 
> 标签：git

我`test_project`在 AWS 上有一个 git 存储库 - 我没有使用 github。

我希望几个学生能够“签出”、“分支”、“克隆”等等，这样他们就可以获得项目中可用的所有文件，但永远无法“签入”、“合并”、“推送”，随便变回原来的`test_project`。

当我把项目拉下来时，我总是`clone`把它放到我的个人机器上，这样我就可以在任何地方进行更改，并且`push`在我离开那台机器之前进行更改——这样我总是拥有我正在处理的任何东西的最新版本（我有 3 台机器）经常不得不在两者之间工作）。

我应该让学生使用什么命令来“签出”这个项目，这样他们就不会意外地将他们的更改“合并”回原始存储库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:30:26.470

通过 git:// 或 https:// 协议授予访问权限。不要给他们写访问权限（例如通过 ssh://）。如果它是一个小型存储库，那么笨拙的 http:// 也可以做得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:03:24.337

[请参阅自定义 Git - 示例 Git 强制策略一](http://git-scm.com/book/ch7-4.html)文中的“强制执行基于用户的 ACL 系统”，其中解释了如何通过接收端的挂钩进行设置。

当您的环境有所增长时，[gitolite似乎是一个更好的选择。](https://github.com/sitaramc/gitolite#readme)

# javascript - 如何从组中随机选择一个 div 并为其分配一个事件

> ID：13109649
> 
> 赞同：0
> 
> 时间：2012-10-28T14:27:05.370
> 
> 标签：javascript

我正在尝试从组中随机选择一个 div 并将点击事件分配给所选的一个。以下是我迄今为止编写的代码。

```
<div id="div1"> </div>
<div id="div2"> </div>
<div id="div3"> </div>
<div id="div4"> </div>

<script>

var div1 = document.getElementById("div1");
var div2 = document.getElementById("div2");
var div3 = document.getElementById("div3");
var div4 = document.getElementById("div4");

var randomnumber = Math.floor(Math.random() * (4 - 1 + 1)) + 1;

var bomb = "div" + randomnumber;

alert(bomb);

bomb.onclick = function() { alert("You clicked me...BOOM!")}; // does not work

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:28:49.813

您正在设置`onclick`字符串炸弹的属性，而不是元素。

采用

```
document.getElementById(bomb).onclick = function() { alert("You clicked me...BOOM!")}; 
```

如果您不想替换现有的点击侦听器，也可以使用[addEventListener ：](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener)

```
document.getElementById(bomb).addEventListener(function() {
   alert("You clicked me...BOOM!")
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:33:43.697

如果那是您的实际脚本，请尝试以下操作：

```
var bomb = window['div' + randomnumber].onclick = function(){alert('You clicked me... BOOM!');}; 
```

如果这不是实际脚本，只需替换`window[`为`this[`, 即可引用当前上下文。

当然，@dystroy 的方法也很好用。我刚刚添加它是为了向您展示一种使用字符串引用变量的方法

# r - 没有[1]的R输出，如何很好地格式化？

> ID：13109652
> 
> 赞同：12
> 
> 时间：2012-10-28T14:27:30.827
> 
> 标签：r, formatting, output

我知道已经发布了一些东西，但没有我要找的那么完整。

获取任何帮助功能（即`?mean`），并意识到它是输出（或者至少应该能够以相同的方式生成输出）。

你如何进入，对齐/意图？

例子：

```
strings <- c("t", "df", "p-value", "mean of x", "mean of y")
values  <- c(t, df, pvalue, mean1, mean2) 
```

如果这将是您想要在 R 中输出的内容（当从函数调用时），您如何使`[1]`消失和值对齐？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-28T14:29:15.883

这是相当基本的，请参阅[An Introduction to R](http://cran.r-project.org/doc/manuals/R-intro.html)以及

*   `help(cat)`
*   `help(sprintf)`
*   `help(format)`

还有很多。请参阅格式化函数中的（实际上是数千个）示例。这是我的一个包中的一个简单示例：

```
print.summary.fastLm <- function(x, ...) {
    cat("\nCall:\n")
    print(x$call)
    cat("\nResiduals:\n")
    print(x$residSum)
    cat("\n")

    printCoefmat(x$coefficients, P.values=TRUE, has.Pvalue=TRUE)
    digits <- max(3, getOption("digits") - 3)
    cat("\nResidual standard error: ", formatC(x$sigma, digits=digits), " on ",
        formatC(x$df), " degrees of freedom\n", sep="")
    cat("Multiple R-squared: ", formatC(x$r.squared, digits=digits),
        ",\tAdjusted R-squared: ",formatC(x$adj.r.squared, digits=digits),
        "\n", sep="")
    invisible(x)
} 
```

# gnuplot - 如何在 gnuplot 的 2D 热图上标记一些点？

> ID：13109657
> 
> 赞同：3
> 
> 时间：2012-10-28T14:28:42.387
> 
> 标签：gnuplot, heatmap

我正在使用简单的方案从我的数据中绘制 2D 热图，如下所示：

```
set pm3d map
set pm3d interpolation 5,5
splot "file" 
```

现在我需要在这个数据上标记几个点，可能是白色的。我试着做：

```
splot "file"; plot "points" 
```

它不起作用并写道：“不能将 pm3d 用于 2d 绘图”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:56:01.247

文件长什么样？你可以做：

```
splot 'file' with pm3d, 'points' with points linecolor rgb "white" 
```

根据`'points'`外观，您可能需要添加使用规范：

```
splot 'file' with pm3d, 'points' using 1:2:(0.0) with points linecolor rgb "white" 
```

# algorithm - 按年龄对一组人进行排序的最快方法是什么？

> ID：13109664
> 
> 赞同：3
> 
> 时间：2012-10-28T14:29:02.570
> 
> 标签：algorithm, sorting

有一系列结构

```
struct
{
string name;
string 2nd_name;
int age; // 0 to 150
} 
```

数组的最大长度为 10^8。

我知道我可以使用合并排序/快速排序和所有其他众所周知的算法，但是我想知道是否可以添加其他可以加快排序的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T14:34:13.997

人们的年龄与用于排序的任意整数有些不同：它具有极少数可能的不同值（所有人的年龄都在 0 到 150 之间）。所以最快的排序方法是分配151个链表（我们称它们为桶）并根据每个人的年龄将每个人的数据结构放入桶中：

```
bucket[person->age].add(person) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T14:34:30.530

首先，请注意，即使结构非常大（即长名称），您也不需要使用文件系统排序，您可以使用内存排序，因为

```
# elements * 8 ~= 762 MB (most modern systems have enough memory for that)
             ^
        key(age) + pointer to struct requires 8 bytes in 32 bits system 
```

尽量减少磁盘访问很重要——因为磁盘不是随机访问，而且磁盘访问比 RAM 访问慢得多。

现在，使用您的选择 - 并避免使用磁盘进行排序过程。

这种情况下（在 RAM 上）的一些可能性是：

*   标准快速排序或合并排序
*   [桶排序](http://en.wikipedia.org/wiki/Bucket_sort)也可以在这里应用，因为愤怒被限制在 [0,150]
*   [基数排序](http://en.wikipedia.org/wiki/Radix_sort)（出于同样的原因，基数排序需要 ceil(log_2(150)) ~= 8 次迭代

# iphone - UINavigationController 的方法作为 UIViewController 的“viewDidLoad”

> ID：13109665
> 
> 赞同：1
> 
> 时间：2012-10-28T14:29:03.933
> 
> 标签：iphone, objective-c, methods, uikit, viewdidload

这可能是一个非常愚蠢的问题。我是在想

**是否有在 NavigationController 被 segued 之后调用的方法？**

[它就像`viewDidLoad`in一样工作`UIViewController`，除了`viewDidLoad`在视图控制器将其视图层次结构加载到内存后调用]

如果没有这样的东西，是否可以在 UIKit 框架中写入一个？

（我知道我们总是可以`viewDidLoad`在 NavigationController 被 segued 之后使用 RootViewController 来触发某些东西。我只是好奇..）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:39:36.710

首先，没有由 a 加载的视图`UINavigationController`。它只是控制`UIViewControllers`反过来控制视图。因此不需要像`viewDidLoad`.

其次，您已经有一个可以`UINavigationController`在创建后自定义的位置：在`prepareForSegue:`调用视图控制器中，或者在您的应用程序委托中（如果它是根导航控制器）。

当然，如果你想封装你的修改，你总是可以继承`UINavigationController`并覆盖它的方法。`init`

# c - 指针大小：依赖因素

> ID：13109666
> 
> 赞同：13
> 
> 时间：2012-10-28T14:29:14.497
> 
> 标签：c, pointers, size, 32bit-64bit

我发现很难理解指针变量大小`C`所依赖的因素。我检查了一些参考资料，到目前为止我得到的唯一信息是`pointer`大小取决于**处理器架构**。我想知道以下详细信息

*   请详细解释架构如何影响指针大小。
*   一般来说，如果指针是`x bits`那么地址位置的数量应该在那里。我在**将地址位置**的数量和程序可用 的**实际内存量**`0 to 2^(X)-1`联系起来时丢失了轨道。

 ***** * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T14:36:15.793

指针是保存另一个内存位置地址的变量。

现在，如果您在 32 位架构上运行，则保存内存引用的 CPU 寄存器（很可能也是所有其他寄存器）将是 32 位长度；这基本上就是 32 位的含义（寄存器是 32 位字长），因此指针（这是一个内存位置）**通常**是 32 位长（4 字节）

同样适用于 64 位 CPU，因此为 64 位 CPU 编译的 C 程序中的指针**通常**具有 8 字节长度（64 位）

**编辑：**
还请注意，在大多数现代架构中，您并没有真正用代码处理物理内存；您运行并解决所谓的虚拟内存。

基本概念是 CPU/OS 组合使您的程序误以为您拥有完整的地址空间。

同样，地址空间（您可以在内存中寻址的空间）长度将取决于 CPU 可以寻址位置的距离，并且（在一般情况下）将取决于其字长。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T20:10:57.853

指针大小取决于很多因素（硬件、操作系统、编译器等），并非同一平台上的所有指针类型都可能具有相同的大小。例如，存在使用哈佛架构的嵌入式处理器，其中代码和数据位于不同的存储区域，并且每个可能具有不同的总线大小（例如，8 位用于数据，16 位用于代码）。这意味着对象指针 ( `int *`, `char *`, `double *`) 可能是 8 位宽，但函数指针 ( `int (*)()`) 可能是 16 位宽。

再举一个例子，考虑一个*字寻址*架构，其中内存的基本单元不是 8 位字节，而是一个更大的单元（其中宽度可以是 16、18、24、32、36、64 或 128 位，或其他值；2 的幂已被证明是方便的，但不是必需的）。其中一些架构可能会选择将多个`char`值打包到一个单词中，这意味着 a`char *`需要一些额外的位来指定单词的偏移量。

在*[C: A Reference Manual](http://www.careferencemanual.com)*一书中，Harbison & Steele 用 36 位字描述了一种架构。字符数据存储为 7 位 ASCII 值，这意味着每个字可以包含 5 个字符，其中一位未使用；所有其他类型都占满了单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:42:06.943

> 我发现很难理解 C 中指针变量大小所依赖的因素。我检查了一些参考资料，到目前为止我得到的唯一信息是指针大小取决于处理器架构。在 32 位机器上是 4 个字节，在 64 位机器上是 8 个字节。我想知道以下细节

不一定是这种情况，无论如何您必须了解指针的大小包含虚拟地址的地址（在支持它的操作系统上）。因此指针的大小取决于内存总线的宽度。这就是架构影响指针大小的原因。请注意，并非总是如此：例如，所有指针的大小可能不同。****

# php - 为什么我不能在侧边栏中使用 setup_postdata($post)？

> ID：13109671
> 
> 赞同：0
> 
> 时间：2012-10-28T14:29:41.650
> 
> 标签：php, wordpress

我创建了一个函数，它接受一个参数 - 帖子类型，并将在其中输出带有一些 html 和标题、内容等的每个帖子。但是，我希望能够使用与 $post 相关的函数，尤其是 the_excerpt。但是，当我尝试在侧边栏 php 小部件中使用我的函数时，它只是输出主页的标题和内容，而不是自定义查询发布信息。

如果我在页面中运行该函数，它可以正常工作，并回显自定义查询的帖子详细信息。你可能会问我为什么不把它放在侧边栏中，它太乱了，我会在不同的自定义帖子中重用它，所以我想我会写一个函数。

我的功能：

```
function myRecentPosts($postType){
 wp_reset_postdata();
   $args = array( 'post_type' => $postType,'posts_per_page' => 3);
   $recentPosts = get_posts( $args );

   foreach($recentPosts as $post){
      setup_postdata($post);  ?>                  
    <article>
      <h1><?php the_title();?></h1>
      <?php the_excerpt();?>
    </article>

 <?php 
  }
   wp_reset_postdata();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T06:54:57.987

您是否检查过您在单个/主页/索引或主 php 文件中是否有任何自定义循环？

如果您使用 1 个或多个循环，请在循环的 and 处添加此行。

```
<?php wp_reset_query(); ?> 
```

# asp.net-mvc - ASP.NET MVC4 已登录但仍需要登录

> ID：13109674
> 
> 赞同：0
> 
> 时间：2012-10-28T14:29:53.243
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我是 ASP.NET 的新手，遇到了一个奇怪的问题。

我已成功登录（我的登录部分视图显示我的用户名使用`User.Identity.Name`when`Request.isAuthenticated`为真），但是，当我尝试访问受保护的控制器时`[Authorize(Roles="Teacher")]`（我以教师身份登录），他几乎总是在重定向我到登录页面。所以我登录了，我可以访问网页，但是如果我在登录后刷新大约 30 秒，我知道我的用户名仍然被打印并且我似乎仍然被登录。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T02:22:22.517

在成功登录后检查经过身份验证的用户具有哪些角色。将以下行添加到 HomeController 中的 Action 方法中。例如：

```
public void CheckRoles()
{
    foreach (var role in Roles.GetRolesForUser())
    {
        Response.Write(role + "<br/>");
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:59:28.537

老师是登录？老师是角色？对于这个登录的用户，是否在 pages_UsersInRoles 表中存在适当的记录？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T19:00:39.457

一个好的开始是弄清楚你的用户是什么类型的委托人。

在您的控制器中，将以下内容和一个断点放在该行上。

```
var user = User; 
```

用户将为您提供当前的主体并在调试器中查看它。当我遇到这样的情况时，这是因为我可能启用了表单身份验证并打开了 Windows 角色管理器。

查看 Principal 是什么将很快帮助您隔离问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:18:16.137

您使用的授权过滤器看起来是正确的。你检查过角色的拼写吗？也许角色是“老师”而不是“老师”或类似的角色。为了安全起见，请确保角色名称的大小写相同。

# mysql - Listview 重复以前的数据

> ID：13109675
> 
> 赞同：0
> 
> 时间：2012-10-28T14:30:02.660
> 
> 标签：mysql, vb.net

此代码尝试在数据库的列表视图字段中显示，但是当他尝试显示搜索的部分时，他重复以前的数据

```
Dim ds As DataSet = New DataSet
Dim sqlcon As MySqlConnection
Dim da As MySqlDataAdapter
 If sqlcon.State = ConnectionState.Open Then
        MsgBox("connected")
        da = New MySqlDataAdapter("SELECT cod_funcionario, matricula, nome, cpf, rg, sexo, email, telefone, endereco, data_nasc, setor FROM funcionario", sqlcon)
        da.Fill(ds, "funcionario")
        Tabelas.Items.Clear()
        If ds.Tables("funcionario").Rows.Count > 0 Then
            For i As Integer = 0 To ds.Tables("funcionario").Rows.Count - 1
                With Tabelas.Items.Add(ds.Tables("funcionario").Rows(i).Item(0).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(1).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(2).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(3).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(4).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(5).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(6).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(7).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(8).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(9).ToString)
                    .SubItems.Add(ds.Tables("funcionario").Rows(i).Item(10).ToString)
                End With
            Next
        End If
    Else 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T16:25:48.150

sql 搜索没有`where`子句，因此它返回 funcionario 中的每一行。这是你的意图吗？重复的数据是否真的在数据库中？

如果查询在同一个函数中重复，您可能需要`ds.clear`在第二个查询之前添加一个。

# ios - 在 Objective-C 中使用单例

> ID：13109680
> 
> 赞同：-1
> 
> 时间：2012-10-28T14:30:28.510
> 
> 标签：ios, singleton

有很多像我这样的人正在使用这样的网站（和其他网站）自学 iOS 和 Xcode。那里有很多信息，在这些信息和我买的书之间，我学到了很多东西，我的第一个应用程序即将完成。我需要访问四个 NSMutableArray 才能将信息从一个 UIViewController 传递到另一个以在 UITableView 中显示。

问题是单例（和 appDelegate 中的全局变量）的信息是多种多样的，对于一个苦苦挣扎的程序员来说是混乱的。我在哪里可以找到关于这两种在应用程序内和跨 UIView 控制器共享信息的方式的清晰、准确和完整的信息？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:43:52.570

（首先我觉得有义务指出，这不是你应该用来在多个视图控制器中提供数据的方式。）

Objective-C 中没有全局变量。至少不是“应用程序范围”。您可以通过以下方式声明“文件范围”变量：

```
static NSArray *_array; 
```

但是您只能在同一个文件中访问它。要使其在其他类中可访问，您必须创建类方法来执行此操作（至少据我所知）：

```
+ (NSArray *)array
{
    return array;
}

+ (void)setArray:(NSArray *)array
{
    _array = array;
} 
```

（当然你还需要在头文件中声明类方法。

单例模式可以这样实现：

```
@interface SomeClass : NSObject 

@property(nonatomic,retain)NSArray *array; 

+(SomeClass*)sharedInstance;    

@end  

@implementation SomeClass    

static SomeClass *instance =nil;    
+(SomeClass *)sharedInstance    
{    
    @synchronized(self)    
    {    
        if(instance == nil)    
        {    
            instance= [[SomeClass alloc] init];    
        }    
    }    
    return instance;    
} 
```

然后，您可以通过调用访问数组：

```
[[SomeClass] sharedInstance].array 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:54:43.447

您可以同时使用静态（如另一个答案）或“单例”声明，它会完成这项工作。这不是真正的单例，但它的作用如下：

```
AppDelegate* app = (AppDelegate*)[[UIApplication sharedApplication] delegate];
NSArray* arr1 = app.arr1;
if(!arr1) {
    // .. init the arr1 here
    NSArray* tmp = ...
    app.arr1 = tmp;
} 
```

当然，`setArr1`在 AppDelegate 本身中重写方法会更好，但这取决于。

# model - 是否可以在 Kendo Web UI 中为模型指定多个 ID？

> ID：13109681
> 
> 赞同：6
> 
> 时间：2012-10-28T14:30:32.110
> 
> 标签：model, kendo-ui, identifier

我对 Kendo UI 完全陌生，所以也许我遗漏了一些东西，但是在阅读了文档 API 之后：[http](http://docs.kendoui.com/api/framework/model) ://docs.kendoui.c​​om/api/framework/model似乎 Kendo 仅限于使用单个 ID。

例如，假设我有一个网格，其中每一行都由一对值标识（因为基础数据具有这样的约束）。那么，如果我没看错的话，剑道就没有直接的表达方式吗？

我能想到的一种解决方法是创建一些临时值，这些值是编码的 id，如“value1|value2”（字符串），当从 UI 获取数据时，将它们解码回来。

有没有更明确的方法？

**具体例子**

专注于实质性的事情：

[http://demos.kendoui.c​​om/web/grid/editing-inline.html](http://demos.kendoui.com/web/grid/editing-inline.html)

相关代码是（来自 .cshtml 文件）：

`.Model(model => model.Id(p => p.ProductID))`

就我而言，它将是（我能想到的最简单的方法）：

`.Model(model => model.Id(p => p.ProductComboId1Id2))`

其中`ProductComboId1Id2`是如上所述编码的字符串。

## 解决方案（某种）

请参阅页面底部，这是剑道安装的问题。安装程序脚本没有安装一个关键的 .js 文件，整个框架变得很奇怪。我的问题是这些不当行为之一。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T16:33:26.813

您可以在单个网格上使用多个 ID。下面我介绍了声明它们的语法以及如何通过 javascript 访问它们。

**宣言**

```
 .Model(model =>
        {
            model.Id(i => i.ProductID);
            model.Id(i => i.ProductID2);
        }) 
```

**访问**

```
function GetIDs() {
var itemGrid = $("#GRIDNAME").data("kendoGrid");
var dataItem = itemGrid.dataItem($(this));
var ID1 = dataItem.ProductID;
var ID2 = dataItem.ProductID2;} 
```

函数 GetID() 将通过行的命令列在网格上调用，如下所示：

```
 columns.Command(command =>
        {
            command.Custom("Edit").Text("Edit").Click("GetIDs");
            command.Destroy();
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T19:19:13.037

也许这是安装脚本中的一个错误，或者不是，我不知道，但问题是 Kendo 安装程序没有安装一个关键文件。即...

当您通过 NuGet 安装 Kendo 包时，`Install-Package KendoIOWeb`它**不会**安装文件`kendo.aspnetmvc.min.js`，而这个文件是至关重要的。突然之间，我得到了删除确认，ID 是通过 POST 而不是 GET 发送的（这正是我配置它们的方式），简而言之，页面在操作后显示 - 终于有意义了。

所以要修复它，不要乱用代码，只需从 Kendo 网站手动下载 zip 文件，获取此文件并将其放在 Content 目录中。

由于 Kendo 的 NuGet 安装程序创建了这样的结构`Content\kendo\2012.2.710`，下面是我以这种方式放置这个额外的 .js 文件的所有文件，`Content\kendo`它会提醒我这是手动添加的。

# c# - 实体框架代码第一个错误 - EntityType 'Variable' 没有定义键

> ID：13109684
> 
> 赞同：0
> 
> 时间：2012-10-28T14:31:10.047
> 
> 标签：c#, asp.net, .net, asp.net-mvc, entity-framework

我在 ASP.NET MVC 4 项目中使用 Entity Framework 5 Code First，我收到以下错误：

> 在模型生成期间检测到一个或多个验证错误：
> 
> \tSystem.Data.Entity.Edm.EdmEntityType: : EntityType 'Variable' 没有定义键。定义此 EntityType 的键。\tSystem.Data.Entity.Edm.EdmEntitySet: EntityType: EntitySet 'Variables' 基于没有定义键的类型'Variable'。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.Data.Entity.ModelConfiguration.ModelValidationException：在模型生成期间检测到一个或多个验证错误：
> 
> \tSystem.Data.Entity.Edm.EdmEntityType: : EntityType 'Variable' 没有定义键。定义此 EntityType 的键。\tSystem.Data.Entity.Edm.EdmEntitySet: EntityType: EntitySet 'Variables' 基于没有定义键的类型'Variable'。

在过去的一个小时里，这一直让我发疯。我已经搜索了我的解决方案，根本没有所谓的“变量”！

我的上下文如下所示：

```
public class MyContext : DbContext, IDisposedTracker
{

    public DbSet<Project> Projects { get; set; }

    public bool IsDisposed { get; set; }
} 
```

我的模型如下所示：

```
public class Project
{
    [Key]
    public int Uid { get; set; }

    public string Id { get; set; }

    public string Name { get; set; }

    public string Description { get; set; }

    public List<Task> Tasks { get; internal set; }
} 
```

任务如下所示：

```
public class Task
{
    [Key]
    public int Uid { get; set; }

    public string Id;

    public string Name;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-03T21:00:18.330

您要求建立没有要关联的表的关系。

需要有一个地方放置对象任务

```
public class MyContext : DbContext, IDisposedTracker
{

    public DbSet<Project> Projects { get; set; }
    public DbSet<Task> Tasks { get; set; }
    public bool IsDisposed { get; set; }
} 
```

# c# - 与自定义和 facebook 登录相同的用户名

> ID：13109687
> 
> 赞同：1
> 
> 时间：2012-10-28T14:31:33.170
> 
> 标签：c#, asp.net-mvc, facebook, single-sign-on

我有一个带有用户注册（ASP.Net Membership）和 Facebook 登录按钮的网站。

我`SetAuthCookie(model.UserName...`在两个登录操作中都使用过，一切似乎都有效！

现在...如果 FB 用户名与已注册用户相同怎么办？

有最佳实践吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T16:31:24.197

对于我的网站，当现有用户名和即将使用的用户的 Facebook 用户名之间存在冲突时，在这种情况下，在注册的最后阶段，我们要求只输入用户名，然后继续申请。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:44:21.840

将用户名和 facebook 用户名存储在不同的字段中。

当用户登录时，要求他们选择一种登录方法 - 这将告诉您是使用 FB 还是用户名。

通常使用电子邮件地址作为用户名是一个好主意 - 因为它（通常）会链接到一个人 - 即您不会有多个用户共享同一个电子邮件地址（除非他们是共享的夫妇一个帐户 - 但他们可以在他们之间制定解决方案）。

# javascript - Javascript数组中的字符串

> ID：13109693
> 
> 赞同：0
> 
> 时间：2012-10-28T14:32:21.380
> 
> 标签：javascript, html, arrays, string

我的数组如下所示：

```
var imagetitle = new Array()
imagetitle[0] = "One two tree";
imagetitle[1] = "Zero One seven abc";
imagetitle[2] = "qwe qwe qwe";
imagetitle[3] = "rerere erere weqwe"; 
```

Imagetitle 稍后在 HTML 中用作标题。问题是当我这样使用它时，它只显示字符串的第一个单词，而不是完整的字符串。

```
function showimage() {
var div_sa_slikom = document.createElement("div");
div_sa_slikom.innerHTML = "<a href="+imagetarget[i_image]+" title="+imagetitle[i_image]+" target='_parent'><img style='border:none;' src="+imageurl[i_image]+" border='0' title="+imagetitle[i_image]+" alt="+imagetitle[i_image]+" /></a>";
var container = document.getElementById("slike_rotator");
container.appendChild(div_sa_slikom);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:41:52.590

您的问题是您正在构建的 HTML 缺少引号。

你正在建造

```
title=One two tree 
```

代替

```
title="One two tree" 
```

将您的功能替换为

```
function showimage() {
   var div_sa_slikom = document.createElement("div");
   div_sa_slikom.innerHTML = '<a href="'+imagetarget[i_image]+'" title="'+imagetitle[i_image]+'" target="_parent">'
       + '<img style="border:none;" src="'+imageurl[i_image]+'" border=0 title="'+imagetitle[i_image]+'" alt="'+imagetitle[i_image]+'">'
       + '</a>';
   var container = document.getElementById("slike_rotator");
   container.appendChild(div_sa_slikom);
} 
```

# html - 为什么 html5 地理位置无法获得结果？

> ID：13109696
> 
> 赞同：2
> 
> 时间：2012-10-28T14:32:49.687
> 
> 标签：html, geolocation

HTML 5 地理定位的工作原理是什么？它会根据 IP 地址猜测位置吗？我猜它不需要支持 GPS 的设备？我的笔记本电脑上没有 GPS。

我一直在尝试在[w3schools geolocation tester/demo](http://www.w3schools.com/html/html5_geolocation.asp)和[html5demos](http://html5demos.com/geo)上使用 HTML5 geolocation 测试我的位置，但我得到的*位置信息不可用*或*失败*。这可能是什么原因？

*注意：*我通过 USB Tethering 连接到互联网。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:52:01.140

浏览器如何精确定位取决于它。如果它可以访问 GPS 设备，它可能会使用它。否则，它可能会进行 GSM 三角测量、反向 IP 地理定位、WiFi 网络数据库查找或其他任何它可以或不能做的事情。

这取决于您的浏览器/操作系统，不保证可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T06:31:37.270

它可以在大多数情况下直接连接。但是，如果它通过代理/VPN 连接，有时它会无法定位位置。只是发现了我最后一次遭遇的一些分享。

# java - Java：“三个傀儡”的例子真的是不可变的吗？

> ID：13109699
> 
> 赞同：2
> 
> 时间：2012-10-28T14:33:01.713
> 
> 标签：java, immutability

中`Java Concurrency In Practice`，给出下面的例子来说明如何创建不可变类：

[http://www.javaconcurrencyinpractice.com/listings/ThreeStooges.java](http://www.javaconcurrencyinpractice.com/listings/ThreeStooges.java)

此类具有：`private final Set<String> stooges = new HashSet<String>();`在其构造函数中初始化：

```
public ThreeStooges() {
    stooges.add("Moe");
    stooges.add("Larry");
    stooges.add("Curly");
} 
```

并且有方法

```
public boolean isStooge(String name) {
    return stooges.contains(name);
} 
```

看看一个名字是否是三个傀儡之一。

但是当我这样做时：`ThreeStooges ts = new ThreeStooges()`是否保证对象`stooges`在其引用设置为之前将被正确构造（即正确初始化的状态）`ts`？

换句话说，如果我发布了这个对象，是否有可能某些线程将其视为未正确初始化（即`stooges`通过 访问时它会视为空`isStooge()`）？

我的理解是，不可变对象在发布时将被正确构造并正确可见-（因为它使用最终实例变量）。我的理解正确吗？如果是，这个类仍然是不可变的吗？

编辑：从我看到的评论看来，很难相信一个对象可以在它的构造函数完成之前被其他线程看到。这是一个链接：http: [//jeremymanson.blogspot.in/2008/05/double-checked-locking.html](http://jeremymanson.blogspot.in/2008/05/double-checked-locking.html)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T15:33:20.460

这里有一大堆错误的答案:(

Java 内存模型中对 final 字段的初始化安全保证非常强大。它们不仅保证对构造函数中最终字段的写入对任何获得对象共享引用的线程都是可见的（即使该引用是通过数据竞争获得的），而且它们保证构造函数中的任何写入*通过*该阅读该参考资料时可以看到参考资料。唯一需要注意的是，对正在构建的对象的引用在构建过程中不会逃逸。当然，如果类要在构造之后改变对象，或者为客户提供一种方法来获取对 HashSet 的对象引用，那么所有的赌注都没有了。

这种保证的目的是防止需要对不可变（在这种情况下，实际上是不可变）对象的状态进行棘手的推理。如果该字段是最终的并且除了构造函数中的那些之外没有写入引用对象的状态，那么您就完成了。

如果这让你头疼，别担心。如果您 (a) 将引用字段设为私有和最终字段，并且 (b) 不修改构造函数之外的引用对象的状态，并且 (c) 不提供任何让客户端执行相同操作的访问权限（例如，没有可变方法，没有暴露字段的吸气剂等），你就完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:40:22.633

当线程在完全初始化之前访问对象时，我看不到任何可能的情况。您可以将构造函数视为返回全新引用的普通函数。因为引用是新的，所以我认为在初始化之前没有任何其他线程（除了创建线程）正在访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:36:05.087

此类是不可变的，因为您不公开任何可以更改`stooges`集合的函数。

因为`stooges`是final的，所以保证构造完成后完全初始化。在[这篇文章](https://stackoverflow.com/a/6599751/314784)中，引用并解释了以下规则：

> 只有在对象完全初始化后才能看到对该对象的引用的线程可以保证看到该对象的最终字段的正确初始化值。

由于条目是*在*构造过程中添加的，以后没有添加任何元素，因此所有线程都应该能够正确查看`stooges`集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T14:39:03.133

```
private final Set<String> stooges = new HashSet<String>();

public ThreeStooges() {
    stooges.add("Moe");
    stooges.add("Larry");
    stooges.add("Curly");
} 
```

此代码是不可变的，因为该集合`stooges`已声明`final`。但是，这里只有类是不可变的，而不是集合，因为同一类可以随时添加元素。这里集合只能构造一次，你不能改变`references`

在可见性的情况下，它们是不可见的，因为集合是`private`。如果你做到了`public`，它们只有在构造之后才能看到，因为对象必须在监视之前构造。

# c# - 创建和启动动画

> ID：13109707
> 
> 赞同：0
> 
> 时间：2012-10-28T14:34:14.947
> 
> 标签：c#, android, xamarin.android, mvvmcross

## 我做了以下事情：

**创建文件 AnimationClick.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:oneshot="true">
  <item android:drawable="@drawable/ButtonState1" android:duration="250"/>
  <item android:drawable="@drawable/ButtonState2" android:duration="250"/>
  <item android:drawable="@drawable/ButtonState3" android:duration="250"/>
  <item android:drawable="@drawable/ButtonState4" android:duration="250"/>
</animation-list> 
```

**并创建文件 ItemImage.axml：**

```
<ImageView
      xmlns:android="http://schemas.android.com/apk/res/android"
      xmlns:local="http://schemas.android.com/apk/res/LeSommet.ZooSnap.UI.Android"
      android:layout_width="80dp"
      android:layout_height="80dp"
      android:padding="5dp"
      android:layout_gravity="center"
      android:src="@drawable/AnimationClick"
  /> 
```

**要运行此动画，应执行以下操作：**

```
ImageView image = (ImageView)FindViewById(Resource.Id.imageAnimation);
 animation = (AnimationDrawable)image.Drawable;
 animation.Start(); 
```

*imageAnimation* - 我的 ImageView。

**但是我用了一个GridView，里面有20个ItemImage。按下 ImageView 之一时如何启动动画？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T16:08:48.933

为此，我认为最简单的方法是创建一个自定义控件并在该控件中触发动画。

要查看如何为列表执行此操作，请查看以下答案：[How to create view's actions listener for MvxItemTemplate](https://stackoverflow.com/questions/12934654/how-to-create-views-actions-listener-for-mvxitemtemplate)

# java - getActionBar() 未定义

> ID：13109708
> 
> 赞同：4
> 
> 时间：2012-10-28T14:34:15.277
> 
> 标签：java, android, android-actionbar

我想在我的 Fragment 类中添加一个 ActionBar，但我不断收到错误消息。这是我的课：

```
public class TaskDetailFragment extends Fragment {

    public static final String ARG_ITEM_ID = "item_id";

    MyTasks.taskItem mItem;

    public TaskDetailFragment() {

    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        if (getArguments().containsKey(ARG_ITEM_ID)) {
            mItem = MyTasks.ITEM_MAP.get(getArguments().getString(ARG_ITEM_ID));
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        View rootView = inflater.inflate(R.layout.fragment_task_detail,
                container, false);

        ActionBar actionBar = getActionBar();
        actionBar.show();

        if (mItem != null) {
            //Add TexViews
            ((TextView) rootView.findViewById(R.id.in_Name))
                    .setText(MyTasks.customers[(Integer.parseInt(mItem.id))][1]);
            ((TextView) rootView.findViewById(R.id.in_Address))
                    .setText(MyTasks.customers[(Integer.parseInt(mItem.id))][3] + "  " + MyTasks.customers[(Integer.parseInt(mItem.id))][2]);

        }
        return rootView;
    }
} 
```

这是我的错误：

> 类型 TaskDetailFragment 的方法 getActionBar() 未定义

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T18:12:43.010

据我所知，您需要向`Activity`（`Fragment`已附加的）询问`ActionBar`：

```
ActionBar actionBar = getActivity().getActionBar(); 
```

或者，如果您使用的是支持库和/或 ActionBarSherlock：

```
ActionBar actionBar = getFragmentActivity().getSupportActionBar(); 
```

片段不定义`getActionBar()`方法，因此错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:23:18.793

确保 getActionBar() 在 TaskDetailFragment 或其他超类中定义，或者有时android模拟器可以将“受保护”添加到方法的定义中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T16:31:37.250

如果一个片段想要使用 ActionBar，它必须调用`setHasOptionsMenu(true)`，通常来自`onCreate()`。

# matlab - 有效地寻找独特的排列

> ID：13109710
> 
> 赞同：10
> 
> 时间：2012-10-28T14:34:25.333
> 
> 标签：matlab, math, permutation, combinatorics

我有以下问题。我需要计算一个集合的排列；但是，该集合可能包含两个相同的元素，因此会导致重复排列。例如：

给定 set `[ 0 0 1 2 ]`，排列包括以下可能性：

```
 1     2     0     0
 1     2     0     0 
```

但是，我想避免像这样的相同排列。在 MATLAB 中，我可以简单地做到这一点：

```
unique(perms([ 0 0 1 2 ]), 'rows') 
```

但这里的问题是效率 - 我在一个巨大的`for`循环中重复这样做，并且所需的排序`unique`太慢了。*所以我的问题是：我可以直接*计算这种性质的独特排列，而不必事后遍历结果吗？我在 MATLAB 中工作，但只是一个通用的解决方案可能会有所帮助，尽管可以在 MATLAB 中矢量化的东西可能是理想的！

据我所知，现有问题并没有完全涵盖这个问题，但如果之前已经回答过这个问题，我们深表歉意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T16:45:01.043

这似乎是一个经常发生的问题。[这](http://www.mathworks.com/matlabcentral/newsreader/view_thread/164470)是 John d'Errico ( `uniqueperms`) 的一个文件，它似乎可以非常有效地解决它。作为替代方案，Ged Ridgway[在这里提交了另一个 FEX；](http://www.mathworks.com/matlabcentral/fileexchange/27321-unique-random-permutations)你必须稍微分析一下，看看哪个更快。

请注意，由于 Matlab 的 JIT 的限制，如果循环调用非内置函数，则不会加速循环，因此在循环中复制粘贴这些函数的内容（和/或稍微专门化它们）可能是有益的（s ）。

# java - java垃圾收集和空引用

> ID：13109717
> 
> 赞同：2
> 
> 时间：2012-10-28T14:35:20.407
> 
> 标签：java, garbage-collection, scjp

在我为 OCJP 学习时，我遇到了以下问题：

```
class CardBoard {
           Short story = 200;
           CardBoard go(CardBoard cb) {
                cb = null;
                return cb;
           }
           public static void main(String[] args) {
             CardBoard c1 = new CardBoard();
             CardBoard c2 = new CardBoard();
             CardBoard c3 = c1.go(c2);
             c1 = null;
            // do Stuff 
}} 
```

当达到 //doStuff 时，有多少对象符合 GC 条件？
正确答案是2，意义`c1`及其`story`对象。

当到达 //doStuff 行时，c3 也为空。为什么它也没有资格获得 GC？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:38:21.170

c3 是具有空引用的本地句柄，它不指向（并且已经指向）分配的对象。因此GC没有任何意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:38:19.113

`c3`不是一个对象。它是一个引用 null 的变量。变量不能符合 GC 条件。只有对象才有资格进行 GC。

符合 GC 条件的对象是最初由 引用的 Cardboard`c1`和最初由 最初引用的 CardBoard 引用的 Short 实例`c1`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:43:03.897

垃圾收集器扫描内存中的对象，当它找到一个对象时检查指向它的句柄（而不是相反） 当垃圾收集器被调用时，没有句柄指向它们的对象（在内存中）将从内存中删除。在这段代码中，您只在内存中创建了 2 个对象，但有 3 个句柄。垃圾收集器最多只能删除 2 个对象（因为只存在两个对象） C3 只指向一个空位置。C1、C2、C3 不会被移除。他们曾经指向的对象被删除（如果没有其他句柄指向它们）。因此，在这一点上，由于 C3 从未指向内存中的对象，因此将其设置为 null 不会对垃圾收集器产生影响。

希望我有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T14:43:55.040

你的`CardBoard#go()`方法什么都不做。它接收到某个对象的引用，立即忘记它，替换为`null`，并返回该`null`值。

所以，线

```
CardBoard c3 = c1.go(c2); 
```

也不做任何事情，即没有对象被创建。只是将 null 分配给`c3`. 所以它不是垃圾收集，因为它已经不存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-22T01:04:21.203

***c3***本身只是一个*引用变量*，不在*堆空间内*（即不在垃圾回收范围内）

该行`CardBoard c3 = c1.go(c2);`仅将 c3 引用设置为 null 因此 c3 不会影响垃圾收集，因为它不会使任何对象符合条件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-12T05:53:38.680

c3 没有对对象的引用，这只是为了制造一些混乱。

我们创建了两个对象 c1 和 c2，我们缺少的是 Short 类型的包装对象，所以基本上我们总共创建了四个对象。

当我们使 c1 = null 时，这意味着我们使用 c1 访问的短对象可用于 GC，而不是我们可以使用 c2 访问的短对象。

这可以使用以下代码进行验证：

公共类纸板{

```
Short story = 200;

CardBoard go(CardBoard cb) {
    cb = null;
    return cb;
}

public static void main(String[] args) {
    Runtime run = Runtime.getRuntime();

    CardBoard c1 = new CardBoard();
    CardBoard c2 = new CardBoard();
    CardBoard c3 = c1.go(c2);

    // System.out.println(run.freeMemory());

    run.gc();
    // System.out.println(run.freeMemory());

    c1.story = 100;

    System.out.println(c1.story);
    c1 = null;
    run.gc();

    System.out.println(c2.story);

} 
```

}

输出：100 200

这意味着我们可以从 c1 访问的 c1 和 Short story 可用于垃圾收集，而不是 c2 的 Short story。

# c++ - MinGW下使用makefile编译所有CPP文件

> ID：13109718
> 
> 赞同：7
> 
> 时间：2012-10-28T14:35:25.087
> 
> 标签：c++, makefile, mingw, gnu-make

我的 C++ 项目的目录结构是

```
/..
   makefile     <- the makefile is in root
   /include     <- subdirectory that has to be included while compiling
   /obj         <- target place for all *.o and final executable
   /src         <- sources 
```

我当前的makefile是：

```
CC=g++
CFLAGS=-c -Wall -std=c++11

INC=-Iinclude
SRC=src
TGT=obj

all: myapp

myapp: myapp.o
    $(CC) $(TGT)/myapp.o -o $(TGT)/myapp

myapp.o:
    $(CC) $(CFLAGS) $(INC) $(SRC)/myapp.cpp -o $(TGT)/myapp.o

clean:
    rm -rf $(TGT)
    mkdir $(TGT) 
```

这适用于我的第一个文件。我是一个 makefile 新手 - 请帮我编译目录下的所有文件`/src`并将它们链接到目录中的可执行文件`/obj`。

makefile 必须在 Windows 下工作，我使用的是 MinGW 和 MSYS

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:55:15.597

添加源文件列表：

```
SOURCES = $(wildcard $(SRC)/*.cpp) 
```

以及相应的目标文件列表：

```
OBJS = $(addprefix $(TGT)/, $(notdir $(SOURCES:.cpp=.o))) 
```

和目标可执行文件：

```
$(TGT)/myapp: $(OBJS)
    $(CXX) $(LDFLAGS) $(OBJS) -o $@ 
```

构建对象的规则：

```
$(TGT)/%.o: $(SRC)/%.cpp
    $(CXX) $(CXXFLAGS) -c $< -o $@ 
```

现在您必须指定 g++ 的选项：

```
INCLUDES = -Iinclude
CXXFLAGS = -Wall -std=c++11 $(INCLUDES) 
```

一切都在一起：

```
SRC=src
TGT=obj
INCLUDES = -Iinclude
CXXFLAGS = -Wall -std=c++11 $(INCLUDES)
SOURCES = $(wildcard $(SRC)/*.cpp)
OBJS = $(addprefix $(TGT)/, $(notdir $(SOURCES:.cpp=.o)))

$(TGT)/%.o: $(SRC)/%.cpp
    $(CXX) $(CXXFLAGS) -c $< -o $@

$(TGT)/myapp: $(OBJS)
    $(CXX) $(LDFLAGS) $(OBJS) -o $@ 
```

重要的是，前面`$(CXX) ...`必须有一个“制表符”字符，而不是空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:46:19.873

您可以[`VPATH`用于分离源文件和目标文件](https://www.gnu.org/software/make/manual/make.html#General-Search)：

```
src/myapp.c
obj/Makefile 
```

取你现有的`Makefile`，将其移入`obj/`，省略对 and 的引用`$(TGT)`并`$(SRC)`添加以下内容：

```
VPATH=../src 
```

请注意，如果您尝试进行[多架构构建，`VPATH`则并不理想](http://mad-scientist.net/make/vpath.html)。

* * *

顺便说一句，您没有利用[内置规则](https://www.gnu.org/software/make/manual/html_node/Catalogue-of-Rules.html#Catalogue-of-Rules)。你在哪里

```
CC=g++
CFLAGS=-c -Wall -std=c++11
myapp: myapp.o
    $(CC) $(TGT)/myapp.o -o $(TGT)/myapp

myapp.o:
    $(CC) $(CFLAGS) $(INC) $(SRC)/myapp.cpp -o $(TGT)/myapp.o 
```

你可以改为使用：

```
CXXFLAGS=-Wall -std=c++11
CXXFLAGS+=$(INC)
LDLIBS+=-lstdc++

myapp: myapp.o 
```

* * *

因此，总而言之，您的新产品`obj/Makefile`应该如下所示：

```
VPATH=../src
INC=-I../include
CXXFLAGS=-Wall -std=c++11
CXXFLAGS+=$(INC)
LDLIBS+=-lstdc++

myapp: myapp.o 
```

如有必要，您可以创建另一个`Makefile`up from`obj/`以递归到这个新的：

```
all: obj/myapp

obj/myapp:
    mklink obj/Makefile ../Makefile
    $(MAKE) --directory=obj/ 
```

# list - 如何从列表的元素创建所有可能的组合？

> ID：13109720
> 
> 赞同：42
> 
> 时间：2012-10-28T14:35:32.300
> 
> 标签：list, scala, for-loop

我有以下列表：

```
List(a, b, c, d, e) 
```

如何从上面的列表中创建所有可能的组合？

我期待类似的东西：

```
a
ab
abc 
```

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-10-28T15:00:22.437

或者你可以使用该`subsets`方法。不过，您必须先将列表转换为一组。

```
scala> List(1,2,3).toSet[Int].subsets.map(_.toList).toList
res9: List[List[Int]] = List(List(), List(1), List(2), List(3), List(1, 2), List(1, 3), List(2, 3), List(1, 2, 3)) 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-10-28T21:13:35.967

```
def combine(in: List[Char]): Seq[String] = 
    for {
        len <- 1 to in.length
        combinations <- in combinations len
    } yield combinations.mkString 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-28T14:38:09.297

```
def powerset[A](s: Set[A]) = s.foldLeft(Set(Set.empty[A])) { case (ss, el) => ss ++ ss.map(_ + el) } 
```

听起来您需要[Power set](http://rosettacode.org/wiki/Power_set#Scala)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-28T15:47:11.520

```
val xs = List( 'a', 'b' , 'c' , 'd' , 'e' )
(1 to xs.length flatMap (x => xs.combinations(x))) map ( x => x.mkString("")) 
```

这应该为您提供由空字符串连接的所有组合。

# c++ - 奇怪的分段错误 - 将指针指向的对象推回向量会导致崩溃

> ID：13109722
> 
> 赞同：1
> 
> 时间：2012-10-28T14:35:54.307
> 
> 标签：c++, pointers, vector, segmentation-fault, sdl

我正在尝试使用 SDL 编写游戏，但我遇到了很多奇怪的段错误。

我创建了类 Monster 和 Player，它们从类 Creature 中获取公共变量。类 Creature 从类 Object 中获取变量。就像这样：

```
class Object {
public:
    Area* area_pointer; // Pointer to an Area in which object is present.
    Sprite sprite; // Class that has SDL_Surface* and some other things.
    Animation animation; // nothing usefull
    int ID;
    short int position_x; // nothing usefull
    short int position_y; // nothing usefull
    short int effect_x; // nothing usefull
    short int effect_y; // nothing usefull
    .... //Some functions that are not important right now.
}; 
```

类精灵：

```
class Sprite {
public:
    SDL_Surface* image;
    short int x;
    short int y;
    short int w;
    short int h;
    Sprite ()
    {
        image = NULL;
        x = 0;
        y = 0;
        w = 0;
        h = 0;
    }   
}; 
```

类生物，玩家，怪物：

```
class Creature : public Object {
        public:
            char move_direction;
            char speed; 
            ..// Some not important functions.
};
class Player : public Creature {
        public:
            char select_type;
            int select_ID;
            std::vector <Item> equip;
            std::vector <Item> inventory;
            std::vector <Effect> effects;
            Player (Area* c_area_pointer, int data [])
            {
                area_pointer = c_area_pointer;
                sprite.image = SurfaceLoad ("Images/Players/" + IntToString (data [0]) + ".png");
                sprite.x = 0;
                sprite.y = 0;
                sprite.w = 0;
                sprite.h = 0;
                ID = data [0];
                position_x = data [1];
                position_y = data [2];
                effect_x = 0;
                effect_y = 0;
            }
            ~Player ()
            {
                SDL_FreeSurface (sprite.image);
                .....
            }
};
class Monster : public Creature {
        public:
            char type;
            std::vector <Item> loot;
            std::vector <Effect> effects;
            Monster (Area* c_area_pointer, int data [])
            {
                area_pointer = c_area_pointer;
                sprite.image = SurfaceLoad ("Images/Monsters/" + IntToString (data [3]) + ".png");
                sprite.x = 0;
                sprite.y = 0;
                sprite.w = 0;
                sprite.h = 0;
                ID = data [0];
                position_x = data [1];
                position_y = data [2];
                effect_x = 0;
                effect_y = 0;
                type = data [3];
            }
            ~Monster ()
            {
                SDL_FreeSurface (sprite.image);
                .....
            }
}; 
```

表面加载功能：

```
SDL_Surface* SurfaceLoad (std::string file_name)
{
SDL_Surface* surface_1 = NULL;
SDL_Surface* surface_2 = NULL;
surface_1 = IMG_Load (file_name.c_str ());
surface_2 = SDL_DisplayFormat (surface_1);
if (surface_1 != surface_2) SDL_FreeSurface (surface_1); // This line may be strange to some of you, but it is related to other error i had in past.
SDL_SetColorKey (surface_2, SDL_SRCCOLORKEY, 0xFFFFFF);
return surface_2;
} 
```

我尝试从 txt 文件加载数据并基于它制作对象。我使用我自己的 Load 函数。它创建一个指向类对象的指针，例如：

```
 Player* player;
        std::string players_name = save_name + "Areas/" + IntToString (ID) + "/players.txt"; //Path to the file cointaining players data.
        std::ifstream players_file;
        players_file.open (players_name.c_str ());
        Monster* monster;
        std::string monsters_name = save_name + "Areas/" + IntToString (ID) + "/monsters.txt"; //Path to the file cointaining monsters data.
        std::ifstream monsters_file;
        monsters_file.open (monsters_name.c_str ()); 
```

然后它从文本文件中加载数据并将其放入名为 file_data 的 int 数组中，并基于它创建新的类对象。

```
 while (!players_file.eof ())
        {
            getline (players_file, file_text);
            while (file_text [data_position_2 + 1] != ';')
            {
                data_position_2 = file_text.find (",", data_position);
                data.assign (file_text, data_position, data_position_2 - data_position);
                file_data [data_index] = atoi (data.c_str ());
                data_position = data_position_2 + 1;
                data_index++;
            }
            player = new Player (this, file_data);
            this->area_map.players.push_back (*player); //Vector players inside object area_map which contain also monsters vector. "this" is a pointer to object that contain Load function and area_map object.
            delete player;
            data_index = 0;
            data_position = 0;
            data_position_2 = 0;
        } 
```

这部分代码可以工作，但是对 monsters_file 和 monsters vector 做同样的事情会导致很多奇怪的错误。我得到的第一个错误是在将数据指针推入向量后删除指针时出现段错误。我检查了它，发现当它调用 SDL_FreeSurface() 时，程序在解构器中崩溃（segfault）。所以我检查了我的构造函数是否正确加载了表面。我发现构造一个对象一切正常，但是在调用 SurfaceLoad() 时它突然开始崩溃（segfault）。也检查了这个函数，一切都很好：指向表面的指针是好的，它返回的指针是好的，但由于某种原因它崩溃了：

```
sprite.image = SurfaceLoad (...); 
```

一段时间后它在这里停止崩溃，没有任何理由（我只是添加了那行

```
if (surface_1 != surface_2) SDL_FreeSurface (surface_1); 
```

，因为我注意到 SDL_DisplayFormat () 有时返回与指向未格式化表面的指针相同的指针。）并且当我 push_back 指向向量的指针指向的对象时开始崩溃（段错误）：

```
this->area_map.monsters.push_back (*monster); 
```

在创建游戏的这个阶段，Monster 和 Player 类几乎相同，所以我不知道为什么它可以毫无问题地创建玩家，并且创建怪物有这么多问题。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:27:47.987

大量的代码看起来有点杂乱无章。例如，为什么 Player 析构函数会释放 Sprite 中声明的图像？这不应该是 Sprite 析构函数的工作吗？为什么一切都是公开的？但无论如何，从你描述的症状来看，这听起来像是一个没有遵循三法则的经典案例。

当您编写在内部分配内存或其他资源的类（如 Sprite 中的图像指针）时，您必须编写正确处理分配的内存或资源的复制构造函数和赋值运算符。如果你不这样做，你会得到这样的错误。

有关三规则的一些**基本**信息，请参见[此处。](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)如果您不了解这些内容，那么您将一直在编写错误的 C++ 代码。关于管理资源的部分与您最相关，但请通读。

# java - Java中的标点符号允许字符串比较

> ID：13109728
> 
> 赞同：2
> 
> 时间：2012-10-28T14:36:13.497
> 
> 标签：java, android, string

我想比较（不区分大小写）两个字符串，忽略标点符号，如点、逗号或其他符号（如西班牙语或法语字母`ó ü ê`等）

一些例子：

```
 Hello == Helló
  Hello, Sam == Hello sam
  geo-code   == geocode == geo code 
```

（不必涵盖所有选项）

什么是最好的解决方案（外部库、方法等）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T14:40:01.810

删除所有特殊字符。

就像从`geo-code`删除`-`它变成`geocode`. 同样，从`geo code`

`Hello, sam`删除空格和逗号`Hellosam`后，您可以比较这些字符串。[这是你可以做到的。](https://stackoverflow.com/a/7552284/1581147)

现在关于像法语这样的特殊字符：[这将对您有所帮助。](https://stackoverflow.com/questions/1008802/converting-symbols-accent-letters-to-english-alphabet)

这是[在另一个线程中找到的代码](https://stackoverflow.com/a/1215117/1581147)。我还没有测试过。

```
import java.text.Normalizer;
import java.util.regex.Pattern;

public String deAccent(String str) {
    String nfdNormalizedString = Normalizer.normalize(str, Normalizer.Form.NFD); 
    Pattern pattern = Pattern.compile("\\p{InCombiningDiacriticalMarks}+");
    return pattern.matcher(nfdNormalizedString).replaceAll("");
} 
```

# ios - XMPP - 如何加入现有的 MUC 房间

> ID：13109733
> 
> 赞同：4
> 
> 时间：2012-10-28T14:36:45.680
> 
> 标签：ios, objective-c, xmpp, xmppframework

如何在我的 openfire 服务器上加入现有的 MUC？

我已设法使用我的凭据和所有凭据加入服务器。

但我似乎找不到任何关于如何加入 MUC 的代码示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-04T10:15:25.607

尝试这个

```
- (void)joinRoomWithRoomName:(NSString *)roomName nickName:(NSString *)nickName 
    {
        if(roomName && nickName)
        {
            _xmppRoomStorage = [XMPPRoomHybridStorage sharedInstance];
            XMPPJID *roomJid = [XMPPJID jidWithString:[NSString stringWithFormat:@"%@@%@.%@",roomName,@"conference",self.hostName]];
            _xmppRoom = [[XMPPRoom alloc] initWithRoomStorage:_xmppRoomStorage jid:roomJid];
            [_xmppRoom addDelegate:self delegateQueue:dispatch_get_main_queue()];
            [_xmppRoom activate:_xmppStream];
            NSXMLElement *history = [NSXMLElement elementWithName:@"history"];
            [history addAttributeWithName:@"maxstanzas" stringValue:MAX_ROOM_HISTORY];
            [_xmppRoom joinRoomUsingNickname:nickName history:history];
        }
        else
        {
            NSLog(@"room creation arguments missing");
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T07:04:34.017

0045 [http://xmpp.org/extensions/xep-0045.html](http://xmpp.org/extensions/xep-0045.html)

只需按照所有步骤操作，您就可以进行多用户聊天。希望这对你有用 ：）

# sharepoint - 使用已启动的工作流程备份/恢复子站点

> ID：13109735
> 
> 赞同：2
> 
> 时间：2012-10-28T14:36:54.147
> 
> 标签：sharepoint

我需要将 sharepoint 子网站导出/导入到另一个网站集。但是我已经在我的站点中启动了工作流程。有没有办法做到这一点？据我所知，我不能使用导出/导入命令，因为它们不允许我使用已启动的工作流程导出/导入子站点。我也不能使用备份/恢复命令，因为这是子站点。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-08T11:05:20.213

使用导入/导出方法无法通过工作流导入和导出子站点，如果您可以移动整个站点集/webapplication，则可以使用 stsadm 命令备份和恢复站点集/webapplication。

您可以使用此工具 1) [http://spdeploymentwizard.codeplex.com/](http://spdeploymentwizard.codeplex.com/)

2）或者metalogix --> 控制点工具

# debugging - 用于调用 fgets/fgetc/feof 的 c 调试断言

> ID：13109737
> 
> 赞同：0
> 
> 时间：2012-10-28T14:37:04.760
> 
> 标签：debugging, fgets, fgetc, feof

嘿，如果这是一个非常简单的问题，我很抱歉打扰，但经过这么多不同的试验，我似乎无法解决这个调试断言失败。

我只是在执行以下代码。我尝试过使用 fgets、fgetc 甚至 feof 来包裹 fget 函数。但我不断收到调试断言失败消息。

```
int main(void){
char input[101];

FILE *fp = fopen("addition.txt", "r");
if (fp = NULL){
    perror("Error: ");
} else {
    fgets(input, 101, fp);
}
} 
```

有什么我在这里完全错误地误解了吗？非常感谢阅读！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:43:17.107

你正在做`fp = NULL`而不是`==`

# django - 带有 unicode 字符串的 Django 请求错误地 UTF-8 编码

> ID：13109738
> 
> 赞同：0
> 
> 时间：2012-10-28T14:37:08.283
> 
> 标签：django, unicode

我在使我的网站与重音字符（法语网站）兼容时遇到了一些麻烦。

我有一个表单，其中一些字段值可以带有重音字符：例如“Coupé”。

我的网址如下所示：

```
http://localhost:8080/recherches/s?marque=Audi&modeles=A5+Coup%C3%A9 
```

在我的 django 视图中，我执行以下操作：

```
def search(request):
  logger = logging.getLogger('custom')
  criteria_form = CriteriaForm(request.GET or None)
  logger.debug("search")
  logger.debug(request.GET) 
```

我在日志中得到的是：

```
<QueryDict: {u'marque': [u'Audi'], u'modeles': [u'A5 Coup\xc3\xa9']}> 
```

如果我用这个变量“modeles”查询我的数据库，我会得到一个错误：

```
>>> mo = u'A5 Coup\xc3\xa9'
>>> Vehicule.objects.filter(valid=True, modele=mo)[0].marque.name
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/Library/Python/2.7/site-packages/django/db/models/query.py", line 211, in __getitem__
    return list(qs)[0]
IndexError: list index out of range 
```

如果我使用 utf-8 版本查询数据库，则一切正常：

```
>>> mo = 'A5 Coup\xc3\xa9'
>>> Vehicule.objects.filter(valid=True, modele=mo)[0].marque.name
u'Audi' 
```

所以我认为（但我可能错了）我的问题来自我的变量是 utf8 然后用 unicode 编码的事实。

这是怎么编码的？

第一次回复后更新：

在发送表单的页面的标题上有：

```
<meta http-equiv="Content-type" content="text/html;charset=UTF-8"/> 
```

但是，如果我在 views.py 中打印编码：

```
logger.debug(request.encoding) 
```

然后我没有。

但我不知道如何设置这种编码。我以为它会像我上面所做的那样来自标题......

我的 HTTP_ACCEPT_CHARSET 中也有这个：

```
HTTP_ACCEPT_CHARSET ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

可以从这里来吗？如果是，我应该如何改变它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T07:26:25.267

我终于找到了问题所在。我用一个几乎没有任何内容的全新 django 应用程序测试了这个问题。没有 DB，一个简单的视图，在页面中显示表单的内容。像这样的东西：

```
# -*- coding: utf-8 -*-
from django.shortcuts import render_to_response
from django.template import RequestContext

def test(request):
  found = request.GET.get('modeles')
  print found
  return render_to_response('test.html',
                            {"found":found},
                            context_instance=RequestContext(request)) 
```

如果我打开网址

```
localhost:8080/mysite?modeles=Coupé 
```

我得到了格式错误的 Coupé

在这里，我肯定不能责怪任何 ajax、db 调用或我可以在 python 中完成的任何事情。

所以我只是在 Django 1.4 上尝试了它......它就像一个魅力！然后我尝试使用最新的 Django 1.5a1 版本，它也可以工作......

我想我现在不应该使用测试版。我会坚持1.4！

希望这可以为其他人节省时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T21:01:03.440

由于所有验证魔法都在​​后台发生，绕过所有这些可能更容易查明问题。在您看来，以下产生了什么？

```
Vehicule.objects.filter(valid=True, modele=request.GET['mo'])[0].marque.name 
```

如果您所做的只是传递一个查询，那么在您取回值之前，您庞大的 Ajaxariffic 验证集将对您的 unicode 进行奇怪的 Python 操作，并可能最终敲掉您的特殊字符。

编辑：在我自己玩过这个之后，看起来 GET 中的 urlified 数据是问题所在。而不是这样做和 string.encode('iso8859-1').decode('utf8')，更改表单以提交 POST 数据并使用它更容易。

# database - 在 Oracle 中触发以自动增加字段并插入关联表

> ID：13109740
> 
> 赞同：0
> 
> 时间：2012-10-28T14:37:13.903
> 
> 标签：database, oracle, triggers, oracle11g

我有两个表之间的一对多关系：

```
table1:

NUMBER users_id (primary key)
field2
field3
...

table2:

NUMBER users_id (foreign key)
VARCHAR2 name
...
... 
```

当我`INSERT`进入时`table1`，我想自动递增（序列？）`users_id`并将许多记录插入到`table2`所有相同的记录中，`users_id`所以我最终得到

```
table1:

1,val1,val2

table2:

1,barry,...
1,bob,...
1,james,... 
```

我想我需要一个带有序列的触发器来自动递增并 `users_id`在.`table1``table2`

它可能不相关，但我是从 PHP 脚本中执行此操作的。

**更新**

到目前为止，我已经设置了一个序列和一个触发器，因此我可以`INSERT`进入`table1`并让`users_id`字段自动递增：

```
create sequence user_seq 
start with 1 
increment by 1 
nomaxvalue;

create trigger user_trigger
before insert on table1
for each row
begin
select user_seq.nextval into :new.users_id from dual;
end; 
```

所以现在我只需要自动插入到第二个表中。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:04:27.630

您可以使用`returning into`语句的子句在插入新记录后`insert`返回值。您也可以使用来获取序列的当前值。下面是一个例子（在这个例子中已经实现了一个简单的存储过程来演示子句的用法。您可以根据您的要求实现一个类似的存储过程）：`users_id``table1``user_seq.currval``insert into`

```
SQL> create table Tb_table_1(
  2    user_id number primary key,
  3    field_1 number
  4  );

Table created

SQL> 
SQL> create table Tb_table_2(
  2    user_id number references tb_table_1(user_id),
  3    name1 varchar2(17)
  4  );

Table created

SQL> create sequence user_seq
  2  start with 1
  3  increment by 1
  4  nomaxvalue;

Sequence created

SQL> 
SQL> create trigger user_trigger
  2  before insert on tb_table_1
  3  for each row
  4  begin
  5    select user_seq.nextval into :new.user_id from dual;
  6  end;
  7  /

Trigger created

  SQL> create or replace procedure Insert_Record
  2  is
  3    l_cur_id number;
  4  begin
  5    insert into Tb_table_1(Field_1)
  6      values(123)
  7    returning user_id into l_cur_id; -- store user_id of the new inserted record
  8    for i in 1..5                    -- in a local variable for later use  
  9    loop
 10      insert into tb_table_2(user_id, name1)  -- insert a bunch of sample data into table2 using previously stored user_id.
 11        values(l_cur_id, dbms_random.string('l', 7));
 12    end loop
 13    commit;
 14  end;
 15  /

Procedure created

SQL> select * from tb_table_1;

   USER_ID    FIELD_1
---------- ----------

SQL> select * from tb_table_2;

   USER_ID NAME1
---------- -----------------

SQL> exec insert_record;

PL/SQL procedure successfully completed

SQL> select * from tb_table_1
  2  ;

   USER_ID    FIELD_1
---------- ----------
         1        123

SQL> select * from tb_table_2;

   USER_ID NAME1
---------- -----------------
         1 jzsdbna
         1 ozbibgs
         1 btxrxcm
         1 hxwwpzc
         1 sdjbwzi

SQL> 
```

在 Oracle 11g 以后，您可以直接将序列值分配给变量：

```
:new.users_id := user_seq.nextval; 
```

# dart - 如何为 dart 代码创建序列图或类图？

> ID：13109749
> 
> 赞同：8
> 
> 时间：2012-10-28T14:38:15.167
> 
> 标签：dart

有没有办法为 dart 代码创建序列图或类图？或任何其他有用的方式来可视化 dart 应用程序的结构（或模糊的程序流）。

编辑：这是功能请求。如果您认为这是一个好主意，请加注星标。[http://code.google.com/p/dart/issues/detail?id=6558&q=sequence%20diagram&colspec=ID%20Type%20Status%20Priority%20Area%20Milestone%20Owner%20Summary](http://code.google.com/p/dart/issues/detail?id=6558&q=sequence%20diagram&colspec=ID%20Type%20Status%20Priority%20Area%20Milestone%20Owner%20Summary)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T18:33:11.720

我不认为 Dart 有任何东西可以将您的代码提供给 Graphviz，但 Dart 编辑器中有两个工具我觉得很有帮助：工具/大纲和工具/调用程序。

用 Graphviz 做一些可以生成漂亮图表的事情听起来对 Dart 有很大的贡献！如果它以前在 Eclipse 世界中完成过，那么很可能破解 Dart Editor 来完成它。或者，您可以在 dartbug.com 上提交请求该功能的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:09:51.633

文档生成工具可以提取程序结构，您可能需要检查它的代码。我不确定，但它可能使用 VM 将源代码解析为 AST 并导航它以生成文档。

# javascript - Javascript 在数组中搜索一个值并获取它的键

> ID：13109753
> 
> 赞同：17
> 
> 时间：2012-10-28T14:38:28.843
> 
> 标签：javascript, arrays, search

我想做一个像这样工作的函数：

```
function arraySearch(array, valuetosearchfor)
{
// some code
} 
```

如果它在数组中找到值，它将返回找到值的键。如果有多个结果（多个键），或根本没有结果（未找到），则该函数将返回 FALSE。

我找到了这段代码：

```
function arraySearch(arr,val) 
        {
            for (var i=0; i<arr.length; i++)
                {
                    if (arr[i] == val) 
                    {                    
                        return i;
                    }
                    else 
                    {
                        return false;
                    }
                }
        } 
```

并像这样使用它：

```
var resultofarraycheck = arraySearch(board, chosen);
                if (resultofarraycheck === false) 
                {
                       document.getElementById(buttonid).value;
                       chosen = 0;
                } 
```

但这似乎不起作用。当它应该找到某些东西时，它返回 false 而不是键 (i)。

我该如何解决这个问题，或者我做错了什么？

谢谢，如果我的英语不够清楚，我很抱歉。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-28T14:41:45.770

```
function arraySearch(arr,val) {
    for (var i=0; i<arr.length; i++)
        if (arr[i] === val)                    
            return i;
    return false;
  } 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-28T14:41:09.870

您可以使用 indexOf 获取关键 [jsfiddle](http://jsfiddle.net/6xYdk/1/)

```
if(!Array.prototype.indexOf){
    Array.prototype.indexOf = function(val){
        var i = this.length;
        while (i--) {
            if (this[i] == val) return i;
        }
        return -1;
    } 
}

    var arr = ['a','b','c','d','e'];

    var index = arr.indexOf('d'); // return 3 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T14:53:30.340

```
function arraySearch(arr, val) {
  var index;
  for (var i = 0; i < arr.length; i++) {
    // use '===' if you strictly want to find the same type
    if (arr[i] == val) {
      if (index == undefined) index = i;
      // return false if duplicate is found
      else return false;
    }
  }

  // return false if no element found, or index of the element
  return index == undefined ? false : index;
} 
```

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-30T19:36:29.197

这是现在 Array Prototype 上的一种方法： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex)

```
var array1 = [5, 12, 8, 130, 44];

function findFirstLargeNumber(element) {
  return element > 13;
}

console.log(array1.findIndex(findFirstLargeNumber));
// expected output: 3 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-28T17:39:18.387

如果您计划大量查找特定数组的不同值的索引，最好使用映射到数组的值和索引的键值对创建一个对象。

```
const letters = ["a", "b", "c"]
const letterIndices = letters.reduce((acc, letter, index) => 
    Object.assign(acc, {[letter]: index}), {}
)

letterIndices["b"] // gives 1 
```

# windows - 在 Windows 中连接到 CVS 存储库时出错

> ID：13109755
> 
> 赞同：0
> 
> 时间：2012-10-28T14:38:39.360
> 
> 标签：windows, eclipse, cvs

我在我的机器№1（192.168.1.100）中创建了存储库并共享项目：

![](../Images/a37bc078d767d912505526cf590f7054.png)

现在，当我尝试从我的机​​器 №2 (192.168.1.101) 连接到机器 №1 (192.168.1.100) 上的存储库时，我发现一个错误：

![](../Images/19153d7fa545a5d6f73a9a0a397fb6c2.png)

两台机器上的连接属性相同。

可能是什么原因？感谢您的任何建议！

**UPD：**当我在 Location properties 中写入不同的地址时，它立即告诉我*Cannot locate host*。但是当我写'192.168.1.100'（我的机器№1的实际地址）时，它认为接近20秒并说它无法连接。所以 Eclipse 找到了它，但由于某种原因无法连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:41:36.447

似乎 192.168.1.100 上的某些防火墙丢弃了您的 CVS 数据包。要将 CVS 与 pserver 协议一起使用，必须通过端口 2401/tcp 上的流量。

# android - AnimationDrawable 在 getBackground() 上为空

> ID：13109758
> 
> 赞同：2
> 
> 时间：2012-10-28T14:39:05.100
> 
> 标签：android, null, animationdrawable

我正在尝试使用以下代码为示例程序设置动画：

```
AnimationDrawable animation;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.loading);

    ImageView animatedImage = (ImageView) findViewById(R.id.animation);
    animatedImage.setBackgroundResource(R.drawable.animate_bag);
    animation = (AnimationDrawable) animatedImage.getBackground();
}

public void startAnimate(View v) 
{
    if (animation != null)
        animation.start();          
} //eof OnClick 
```

XML 文件是：

```
 <Button android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Animate"
        android:onClick="startAnimate" />
     <ImageView
        android:id="@+id/animation"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/animate_bag" />

</LinearLayout> 
```

我遇到的问题是 animatedImage.getBackground() 返回 null。

将不胜感激你的提示:-)

谢谢，西蒙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-04T07:38:59.707

如果 getBackground() 返回 null，请使用 getDrawable() 方法。

```
//animation = (AnimationDrawable) animatedImage.getBackground();
animation = (AnimationDrawable) animatedImage.getDrawable(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T08:12:59.453

希望对你有帮助 ;）

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.loading);

    final ImageView animatedImage = (ImageView) findViewById(R.id.animation);
    animatedImage.setBackgroundResource(R.drawable.animate_bag);

    animatedImage.post(new Runnable() {

        @Override
        public void run() {
            AnimationDrawable frameAnimation = (AnimationDrawable) animatedImage.getDrawable();
            if (frameAnimation != null) {
                frameAnimation.start();
            }
        }
    });
} 
```

# c - 在 C 中实现堆排序时出现问题

> ID：13109762
> 
> 赞同：1
> 
> 时间：2012-10-28T14:39:35.007
> 
> 标签：c, algorithm, unix, heap, heapsort

我正在用 C 语言实现经典的堆排序算法。我已经盯着这段代码看了好几个小时，但仍然无法弄清楚我这辈子出了什么问题。输入 3 1 2 7 4 0 2 运行良好并产生正确的堆，但是当我在末尾添加 8 时（并将大小增加一）。它不再产生堆。有任何想法吗？我认为这只是一个错误的愚蠢行为。供参考[http://en.wikipedia.org/wiki/Heapsort](http://en.wikipedia.org/wiki/Heapsort)

```
#include <ctype.h>
#include <stdio.h>
#include <limits.h>
#include <stdlib.h>
#include <errno.h>
#include <math.h>
#include <string.h>

#define MAX_ARR 1024

void build_heap(int * fn, int len);
void heapify(int *f, int n, int size);
void verify_relations(int *f, int n);
void print_nums (int n[], int len);
void swap(int * a, int * b);
void heap_sort(int * a, int len);

int main(int argc, char **argv){
    /* input works -- 3 1 2 7 4 0 2 */
    /* input broken -- 3 1 2 7 4 0 2 8 */
    int nums[100] = { 3, 1, 2, 7, 4, 0, 2, 8 };

    int len = 8;

    build_heap(nums, len);
    verify_relations(nums, len);
    print_nums(nums, len);
    return 0;
}

void heap_sort(int nums[], int len){
    int i;
    build_heap(nums, len);
    for (i = len; i > 0; --i)
    {
        swap(&nums[1], &nums[i]);
        heapify(nums, 1, len);
    }

}

void build_heap(int * nums, int len) {
    int size = len, i;
    for (i = size; i >= 0; i--){
        heapify(nums, i, size);
    }
}

void heapify(int f[], int n, int size){

    int left = 2 * n,
    right = 2 * n + 1,
    largest = 0;

    if (left < size && f[left] >= f[n])
        largest = left;
    else
        largest = n;

    if (right < size && f[right] >= f[largest])
        largest = right;

    if (largest != n) {
        swap(&f[n], &f[largest]);
        heapify(&n, largest, size);
    }
}

void swap(int * a, int * b){
    int temp = *a;
    *a = *b;
    *b = temp;
}

void verify_relations(int a[], int n){

    if (a[0] >= a[1] && a[0] >= a[2])
        printf("True - '%d >= %d && %d >= %d' \n", a[0], a[1], a[0], a[2]);
    else
        printf("False\n");

    if (a[1] >= a[3] && a[1] >= a[4])
        printf("True - '%d >= %d && %d >= %d' \n", a[1], a[3], a[1], a[4]);
    else
        printf("False\n");

    if (a[2] >= a[4] && a[2] >= a[5])
        printf("True - '%d >= %d && %d >= %d' \n", a[2], a[4], a[3], a[5]);
    else
        printf("False\n");
}

void print_nums (int n[], int len) {
    int c;
    for (c = 0; c < len; c++){
        printf("%d ", n[c]);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T14:44:31.257

线

```
heapify(&n, largest, size); 
```

应该

```
heapify(f, largest, size);
        ^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T16:59:05.413

除了[alestanis](https://stackoverflow.com/users/1225541/alestanis)确定的主要错误之外，您应该考虑使您的`verify_relations()`代码更彻底，因为它不会验证整个堆。

在数组索引从 1 开始（而不是 C 中从 0 开始）的堆中，对于每个元素`a[i]`，如果存在相应元素`a[i*2]`，则`a[i] <= a[i*2]`; 如果对应的元素`a[i*2+1]`存在，则`a[i] <= a[i*2+1]`.

由于我们在 C 中使用基于 0 的索引，因此您有元素 0 和子元素 1、2；您有元素 1 和孩子 3、4；你有元素 2 和孩子 5、6；所以元素`i`有孩子`2*i+1`和`2*i+2`。

因此，您的`verify_relations()`代码可能基于以下两个函数之一（`verify_relations1()`或`verify_relations2()`）。不同之处在于`verify_relations1()`报告堆排序中的每个错误，但`verify_relations2()`只报告第一个不匹配。当然，在这两种情况下，您都会被告知堆无效，但有时更全面的报告可能会使调试更容易。我已将代码包含在测试工具中，主要是因为我喜欢在将代码发布到此处之前合理地确定代码是正确的。这意味着我有“标签”字符串来识别正在分析的内容以及发现的错误。您可能会决定不需要所有标签。您可能还决定让函数报告`stderr`而不是`stdout`，或在传递给验证函数的文件流上（因此您可以选择在运行时输出的位置）。

```
#include <assert.h>
#include <stdio.h>

enum { HEAP_OK, HEAP_FAIL };

static int cmp_heap_elements(const int *heap, int node1, int node2, const char *tag)
{
     int rc = HEAP_OK;
     if (heap[node1] > heap[node2])
     {
         rc = HEAP_FAIL;
         printf("%s: heap relation does not hold between heap[%d] = %d and heap[%d] = %d\n",
                 tag, node1, heap[node1], node2, heap[node2]);
     }
     return rc;
}

/* Report on every violation */
static int verify_relations1(const int *heap, int size)
{
     int rc = HEAP_OK;
     for (int i = 0; i < size / 2; i++)
     {
         assert(2*i+1 < size);
         if (2*i+1 >= size)
             break;
         int rv = cmp_heap_elements(heap, i, i*2+1, "R1");
         if (rc == HEAP_OK)
             rc = rv;
         if (2*i+2 >= size)
             break;
         rv = cmp_heap_elements(heap, i, i*2+2, "R1");
         if (rc == HEAP_OK)
             rc = rv;
     }
     return(rc);
}

/* Report on first violation - leaving others undiagnosed */
static int verify_relations2(const int *heap, int size)
{
     for (int i = 0; i < size / 2; i++)
     {
         assert(2*i+1 < size);
         if (2*i+1 >= size)
             break;          // Or: return(HEAP_OK);
         if (cmp_heap_elements(heap, i, i*2+1, "R2") != HEAP_OK)
             return(HEAP_FAIL);
         if (2*i+2 >= size)
             break;          // Or: return(HEAP_OK);
         if (cmp_heap_elements(heap, i, i*2+1, "R2") != HEAP_OK)
             return(HEAP_FAIL);
     }
     return(HEAP_OK);
}

static void print_heap(const int *heap, int size, const char *tag)
{
    printf("%s:", tag);
    for (int i = 0; i < size; i++)
        printf(" %d", heap[i]);
    putchar('\n');
}

static void check_heap(int *heap, int size, const char *tag)
{
    print_heap(heap, size, tag);
    if (verify_relations1(heap, size) != HEAP_OK)
        printf("%s %d - FAIL\n", tag, size);
    if (verify_relations2(heap, size) != HEAP_OK)
        printf("%s %d - FAIL\n", tag, size);
}

int main(void)
{
    int heap1[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
    int heap2[] = { 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 };
    int heap3[] = { 1, 2, 6, 4, 10, 3, 7, 8, 9, 5 };
    const int heap1_sz = sizeof(heap1) / sizeof(heap1[0]);
    const int heap2_sz = sizeof(heap2) / sizeof(heap2[0]);
    const int heap3_sz = sizeof(heap3) / sizeof(heap3[0]);
    assert(heap1_sz == heap2_sz && heap1_sz == heap3_sz);

    for (int size = 1; size <= heap1_sz; size++)
    {
        check_heap(heap1, size, "heap1");
        check_heap(heap2, size, "heap2");
        check_heap(heap3, size, "heap3");
    }
    return(0);
} 
```

# facebook - 应用创建失败：请使用您的个人帐户创建此应用

> ID：13109766
> 
> 赞同：5
> 
> 时间：2012-10-28T14:40:00.340
> 
> 标签：facebook, creation

我正在尝试为移动设备创建 Facebook 应用程序，但出现“应用程序创建失败请使用您的个人帐户创建此应用程序。要使用其他名称进行测试，请使用您的个人帐户创建应用程序，然后创建测试帐户。” 有没有人有任何想法，因为这让我陷入停顿（我的 Facebook 帐户已经过验证）？

# php - 使用 PHP/Javascript 为移动设备重定向单个 php 页面的最佳方法

> ID：13109770
> 
> 赞同：13
> 
> 时间：2012-10-28T14:40:19.983
> 
> 标签：php, javascript

我有一个 PHP 谷歌地图应用程序，我想在用户使用桌面时使其可见，但如果访问者使用移动设备，则重定向到另一个 PHP 页面。我知道从操作系统到浏览器类型检测有很多方法可以做到这一点，但想知道是否有人可以提供一些他们认为是处理这个问题的最佳方法并且最一致的代码？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-28T15:04:19.890

如果不想使用javascript，可以通过php处理。看看这个库：[http](http://code.google.com/p/php-mobile-detect/) ://code.google.com/p/php-mobile-detect/ 。然后你可以做类似的事情：

```
<?php
include 'Mobile_Detect.php';
$detect = new Mobile_Detect();

if ($detect->isMobile()) {
    header('Location: yourpage.php');
    exit(0);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-08-26T08:20:20.977

免责声明：我知道这个正则表达式并不完美，所以不要仅仅为此投票:)

只是想分享这几点。

1.  某些服务器未设置**$_SERVER['HTTP_USER_AGENT']**，因此请务必先检查是否为空
2.  可读性对我们很重要，所以我们使用它而不是其他复杂的正则表达式。只需**添加**您认为合适的其他设备。

这是我们使用的代码：

```
<?php
if(! empty($_SERVER['HTTP_USER_AGENT'])){
    $useragent = $_SERVER['HTTP_USER_AGENT'];
    if( preg_match('@(iPad|iPod|iPhone|Android|BlackBerry|SymbianOS|SCH-M\d+|Opera Mini|Windows CE|Nokia|SonyEricsson|webOS|PalmOS)@', $useragent) ){
        header('Location: ./mobile/');
    }
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T15:01:17.990

你想要javascript还是php解决方案？使用 JS，您可以检查 UA 中是否有“Mobile”：

```
if (navigator.userAgent.indexOf('Mobile') > -1) location.href = 'your-mobile-page-url'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T15:01:34.773

您可以尝试使用简单的维度条件

```
if (screen.width < 600 || screen.height < 200) {
    window.location = 'anotherPage.html'
} 
```

`screen`如果浏览器窗口最小化，`window`尺寸会有所不同

可以结合使用窗口/屏幕测试并提醒用户注意问题并为他们提供重定向选项

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-28T15:07:46.537

使用用户代理字符串

```
$useragent=$_SERVER['HTTP_USER_AGENT'];

if(preg_match('/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i',$useragent)||preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i',substr($useragent,0,4)))
    header('Location: http://detectmobilebrowser.com/mobile'); 
```

[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-19T13:38:52.410

检查设备：

```
function UserAgentRegCheck($regText)
{
    $useragent = $_SERVER['HTTP_USER_AGENT'];
    return preg_match('@('.$regText.')@', $useragent);
}

function isIphone() {
    return UserAgentRegCheck('iPad|iPod|iPhone');
}

function isAndroid() {
    return UserAgentRegCheck('Android');
}

function isMobile(){
    return UserAgentRegCheck('iPad|iPod|iPhone|Android|BlackBerry|SymbianOS|SCH-M\d+|Opera Mini|Windows CE|Nokia|SonyEricsson|webOS|PalmOS');
} 
```

重定向代码：

```
if(isIphone()) {
    header('Location: http://www.google.com.ua');
    exit();
}

if(isAndroid()) {
    header('Location: http://youtube.com');
    exit();
} 
```

# excel - 跟踪 Excel 工作表更改

> ID：13109777
> 
> 赞同：0
> 
> 时间：2012-10-28T14:41:07.850
> 
> 标签：excel, excel-2003, vba

我想知道是否有人可以帮助我。

我正在使用下面的代码来跟踪对 Excel 工作表的更改，当 B5:Q2000 范围内的任何单元格的值发生更改时，会自动将日期插入“A”列，并将“否”一词插入“AE”列。

```
Option Explicit
    Public preValue As Variant
    Private Sub Worksheet_Change(ByVal Target As Range)

    Dim Cell As Range, res As Variant
      If Target.Cells.Count > 1 Then Exit Sub
       On Error Resume Next
       If Not Intersect(Target, Range("B5:Q2000")) Is Nothing Then
       If Target.Value <> preValue And Target.Value <> "" Then
            Application.EnableEvents = False
            Range("A5:A" & Target.Row).Value = Date
            Range("AE5:AE" & Target.Row).Value = "No"
            Application.EnableEvents = True
            Target.ClearComments
          '  Target.AddComment.Text Text:="Previous Value was " & preValue & Chr(10) & "Revised " & Format(Date, "dd-mm-yyyy") & Chr(10) & "By " & Environ("UserName")
            Target.Interior.ColorIndex = 35
        End If
    End If
    On Error GoTo 0

    End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If Target.Count = 1 Then preValue = Target.Value
End Sub 
```

不幸的是，我遇到了一个不知道如何解决的问题。

如果用户将数据插入单元格 D5 和 D10，则日期和单词“否”将添加到这两行的正确列（A 和 AE）中。

然而，不幸的是，即使用户没有在这些行上输入任何其他数据，我也不确定在这些行中添加了“否”值和日期，即 D6-D9 之间的行问题出在哪里。

我只是想知道是否有人可以看看这个并就我如何解决这个问题提供一些指导。

非常感谢和亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:45:02.037

您当前的代码正在应用从行开始`A5`和`AE5`通过`Target's`行的更改。要让代码仅更改所选单元格的行，请更改以下内容：

```
Range("A5:A" & Target.Row).Value = Date
Range("AE5:AE" & Target.Row).Value = "No" 
```

对此：

```
Range("A" & Target.Row).Value = Date
Range("AE" & Target.Row).Value = "No" 
```

此外，您似乎没有使用变量`Cell`or `res`。您可能想要删除该行代码。

# java - 为什么在有符号和无符号表示之间转换一个数字？

> ID：13109802
> 
> 赞同：3
> 
> 时间：2012-10-28T14:44:09.330
> 
> 标签：java, unsigned, signed

下面的代码显示了一个存储为十六进制的 Java 字节值的数字，并以有符号和无符号表示。这可能不是正确的措辞。我的意思是，这些数字可能是 C 风格的 1 字节无符号字符值。如果我正在解释这些值（这里恰好是 Java，但可以在任何语言中使用任何有符号类型），那么如果“数字”溢出到使用符号位，那么数字将显示为负数。但是我可以通过 ANDing 与 0xFF 以无符号解释的形式打印。

我了解 AND 的工作原理，但我不明白 ANDing 如何呈现为未签名。有人可以解释一下吗？

```
public class understand_casting {
    public static String printbinary(byte val) {
      int displayMask = 1 << 7;
          String str = new String();
          for(int bit = 1; bit <= 8; ++bit) {
              str += (val & displayMask) == 0 ? '0' : '1';
              val <<= 1; //shift one to left
          }
          return str;
    }

  public static void main(String[] args) {   
     System.out.printf("0x50=%s, as int=%d, as unsigned int=%d\n", printbinary((byte)0x50), (byte)0x50, ((byte)0x50 & 0xFF));
     System.out.printf("0x88=%s, as int=%d, as unsigned int=%d\n", printbinary((byte)0x88),(byte)0x88, ((byte)0x88 & 0xFF));
     System.out.printf("0x3E=%s, as int=%d, as unsigned int=%d\n", printbinary((byte)0x3E),(byte)0x3E, ((byte)0x3E & 0xFF));
     System.out.printf("0xB7=%s, as int=%d, as unsigned int=%d\n", printbinary((byte)0xB7), (byte)0xB7, ((byte)0xB7 & 0xFF));   
  }
} 
```

我得到这个输出：

```
0x50=01010000, as int=80, as unsigned int=80
0x88=10001000, as int=-120, as unsigned int=136
0x3E=00111110, as int=62, as unsigned int=62
0xB7=10110111, as int=-73, as unsigned int=183 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T14:51:04.647

如您所料，二进制`int`1 是

```
0000 0000 0000 0000 0000 0000 0000 0001 
```

根据二进制补码，您通过反转一个数字并加 1 来取反，所以`int`二进制补码中带符号的 -1 的二进制看起来像

```
1111 1111 1111 1111 1111 1111 1111 1111 
```

任何负数都将设置高位，而任何正数都将设置高位为零。

例如，0xff 看起来像左边有一长串 0

```
0000 0000 0000 0000 0000 0000 1111 1111 
```

而 -0xff 看起来像

```
1111 1111 1111 1111 1111 1111 0000 0001 
```

当您使用掩码时，`&`您只保留两者中都存在的 1 位，因此 -2 和 0xff 看起来像

```
1111 1111 1111 1111 1111 1111 1111 1110 |   -2
0000 0000 0000 0000 0000 0000 1111 1111 | 0xff

0000 0000 0000 0000 0000 0000 1111 1110 | -2 & 0xff = 0xfe 
```

ANDing with a positive value yields a positive value because the resulting high bit is always 0.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:49:43.073

与一个字节与一个 int 首先符号将字节扩展为 int，然后发生 AND。

这意味着，在这种情况下，字节被转换为*带有符号扩展*的整数，但是随后选择了与与的值，使得扩展的符号位被屏蔽掉。

所以结果就好像你对字节进行了零扩展。

# c++ - Win32 控制台代码在哪里运行？从多个线程使用时控制台挂起

> ID：13109805
> 
> 赞同：0
> 
> 时间：2012-10-28T14:44:15.087
> 
> 标签：c++, c, multithreading, winapi, console

我有一个使用两个线程的 C++ Win32 应用程序。线程 A 使用`AllocConsole()`. `WriteFile`线程 B 使用控制台句柄（从 获取）打印到此控制台`GetStdHandle`。

出于某种原因，当两个线程同时打印到控制台时，我的进程挂起。

我该如何解决这个挂起？是什么原因造成的？我想调试控制台的消息循环（它是一个窗口，对吧？所以它应该有消息）但我不知道如何访问它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:45:35.253

由于您没有提供任何代码，因此我将在这里进行有根据的猜测：

据我所知，~~Win32 Console 类不是线程安全的（与~~.NET 中的 System.Console 类不同，后者是线程安全的）。

这基本上意味着您应该进行一些同步以防止任何错误；我不知道那里的挂起是否是由这样的问题引起的。

请向我们提供代码。

**编辑：**
请查看 Raymond Chen 的评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T16:28:06.230

我怀疑问题在于并发调用*使用相同的*`WriteFile()`设备句柄。

每个线程都需要它自己的设备句柄。简单地`HANDLE = GetStdHandle(STD_OUTPUT_HANDLE)`在主线程中拉它然后在两个线程中使用它来做`WriteFile(HANDLE, ...)`最肯定是行不通的。

`HANLDE`解决这个问题的直接方法是通过调用`CreateFile()`using让每个线程都有自己的值`CONOUT$`。

在 OP 的情况下，只有线程 B 需要通过调用来创建自己的句柄`CreateFile()`，线程 A 可以使用返回的值`GetStdHandle()`，因为它分配了控制台。

有关如何为控制台创建设备句柄，[请参见此处](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)“备注”部分中的“控制台”。

# apache - 在端口 80 上为 Tomcat 和在 8080 上的 Apache 使用相同的 SSL 证书

> ID：13109810
> 
> 赞同：1
> 
> 时间：2012-10-28T14:44:31.077
> 
> 标签：apache, tomcat, ssl, ssl-certificate

我有一个域“www.example.com”的 SSL 证书，我已经在运行良好的端口 80 上运行的 tomcat 服务器中安装了这个证书。现在我的要求是在 https 中运行 php 代码，因为我的 Apache 在 8080 上运行我如何使 https:// 在端口 8080 上工作。甚至可能吗？我尝试在 Apache 中安装相同的证书（编辑 SSL.conf 文件以指向我的证书。）。我什至将 tomcat 密钥库转换为 apache 密钥文件。但我认为我需要未安装在我的服务器中的 mod_ssl，我什至无法安装它（使用 mod_ssl 重新配置 Apache）。

总结我的问题：

1.  是否可以在端口 8080 上运行的服务器上安装 SSL 证书。
2.  是否可以在 Apache 中使用从 tomcat 密钥库生成的相同证书
3.  最简单的方法是什么？
4.  如果安装 SSL 证书需要，如何使用 mod_ssl 重新配置 Apache。（这可能是一个愚蠢的问题->我在哪个文件夹下运行*./configure --enable-ssl* ... 命令类型）

我的基本要求是通过 https 运行 PHP 和 JSP 代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T20:18:06.003

更简单的方法是使用 Apache 作为前端，并使用其 ProxyPass 功能（与您的设置相反）。

让 Apache 在端口 80 和 443 (SSL) 上运行，并在 127.0.0.1:8080 上运行对特定网站和/或 URL 的 Tomcat 的代理请求。

它更简单，因为要在 Apache 中进行设置，您只需添加一行...

```
ProxyPass /foo http://127.0.0.1:8080/foo 
```

因此，当对[https://www.example.com/foo](https://www.example.com/foo)的请求进入时，Apache 从 Tomcat 获取 /foo ，并透明地传回给您……就用户而言，一切都是 SSL 的。

如果你不想这样做...

> 1) 是否可以在端口 8080 上运行的服务器上安装 SSL 证书。

是的。端口号没有硬编码为任何东西。只需在该 Tomcat 连接器中启用 SSL。

> 2）是否可以在 Apache 中使用从 tomcat 密钥库生成的相同证书。

它应该是。证书是基于域的。他们不关心使用什么类型的服务器......但他们确实需要采用正确的格式。您可能需要重新格式化密钥和证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T06:08:22.540

只需按照步骤操作，这很容易:) [https://www.digitalocean.com/community/articles/how-to-create-a-ssl-certificate-on-nginx-for-ubuntu-12-04](https://www.digitalocean.com/community/articles/how-to-create-a-ssl-certificate-on-nginx-for-ubuntu-12-04)

# c# - @Html.Partial 返回：传入字典的模型项是 __ 类型，但此字典需要 __ 类型的模型项

> ID：13109812
> 
> 赞同：1
> 
> 时间：2012-10-28T14:45:01.967
> 
> 标签：c#, asp.net-mvc, entity-framework, razor, partial-views

我正在尝试向我的 MVC4 Web 应用程序添加部分视图，但收到以下异常：

> 传递到字典中的模型项的类型为“...Meeting”，但此字典需要类型为“System.Collections.Generic.List`1[...UserProfile]”的模型项。

到目前为止我做了什么：

1.  我在我的控制器中添加了这个功能：

> ```
> public PartialViewResult GetUsers()
>         {
>             var usersList = (from users in db.Users select users).ToList();
>             return PartialView(usersList);
>         } 
> ```

1.  我添加了部分视图：

> ```
> @model List<UserProfile>
> @{
>  <select id="Meeting_SetToUser" name="Meeting.SetToUser">
>         @foreach (var item in Model)
>         {
>             <option value="@item.UserId">@item.FirstName @item.LastName</option>
>         }
>     </select>
> } 
> ```

1.  我从我的角度调用了局部视图：

> ```
> @Html.Partial("GetUsers") 
> ```

你能告诉我我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T16:01:49.260

当`GetUsers`您使用`Html.Partial`. 也许您想使用子动作：

```
@Html.Action("GetUsers") 
```

查看以更好地了解和[`following article`](http://haacked.com/archive/2009/11/17/aspnetmvc2-render-action.aspx) 之间的区别。`Html.Partial``Html.Action`

`foreach`同样使用循环而不是使用帮助器生成下拉列表`Html.DropDownList`似乎很不合适。也许你想使用这个助手，不是吗：

```
@model List<...UserProfile>
@Html.DropDown(
    "Meeting.SetToUser", 
    new SelectList(
        Model.Select(x => new 
        { 
            UserId = x.UserId, 
            FullName = string.Format("{0} {1}", x.FirstName, x.LastName) }
        ),
        "UserId", 
        "FullName"
   )
) 
```

我也强烈建议您使用视图模型，而不是将您的域模型传递给视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:37:11.080

仔细查看 GetUsers() 操作，您将 List 类型的模型传递给局部视图，其中局部视图接受 List<...UserProfile> 类型。

解决方案是发送部分视图接受的正确类型。

# c# - 是否可以使用 AutoMapper 或 ValueInjecter 将源属性映射到目标方法？

> ID：13109813
> 
> 赞同：0
> 
> 时间：2012-10-28T14:45:10.960
> 
> 标签：c#, .net, automapper, arcobjects, valueinjecter

我试图将一个简单的、普通的源对象映射到一个目标对象，该对象实现一个接口（[*IFeatureClass*](http://help.arcgis.com/en/sdk/10.0/arcobjects_net/componenthelp/index.html#/IFeatureClass_Interface/0025000002qs000000/)）并且只有一个名为`SetValue(index, value)`用于设置目标“属性”的公共方法。

我希望能够将我的对象（DTO/BO）动态映射到实现*IFeatureClass*的对象。可以使用调用的接口的另一种方法找到该字段的索引，该方法`FindField(string fieldname)`返回该字段的索引。

您是否认为可以使用[AutoMapper](https://github.com/AutoMapper/AutoMapper)或[ValueInjecter](http://valueinjecter.codeplex.com/)来完成此类工作。或者是否有任何模式或其他东西可以帮助我做到这一点？如果是这样，你能告诉我怎么做吗？我检查了文档和现有示例，但找不到符合我需要的示例。

问候， 克里斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:47:10.187

我现在使用 Automapper 来执行此操作。它工作得很好。它没有遇到我可以用它映射的两个对象。

# objective-c - 触发事件的全局监视器后，如何在聚焦的 NSTextfield（在我的应用程序之外）上书写？

> ID：13109815
> 
> 赞同：1
> 
> 时间：2012-10-28T14:46:18.267
> 
> 标签：objective-c, macos, cocoa, textfield, keyboard-events

我正在创建一个侦听全局事件（按下键）的 OSX 应用程序，使用

```
[NSEvent addGlobalMonitorForEventsMatchingMask:NSKeyDownMask handler:^(NSEvent *event){       
     //execute this code when keys are pressed
}]; 
```

我想执行类似的操作，例如：
我在 safari（或任何其他应用程序）上，在文本字段上输入，然后按“hhh”键。我的应用程序收到一条通知说这些键被按下，它会在我正在输入的文本字段上写下“你好”。

那么，我怎么知道用户在文本字段上键入时按下了“hhh”键，以及如何以编程方式向该文本字段写“你好”？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T06:52:53.363

从记忆中我相信你可以做到这一点，但你需要在系统偏好设置中启用“启用辅助设备访问”。那么你描述的应该是可行的。如果您不这样做，您将不会在全局处理程序上收到任何事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:22:07.983

可访问性框架（以及另一个答案中建议的辅助设备）在这里没有提供任何有用的东西。它允许您操作屏幕上的窗口，但不能操作它们的内部视图层次结构（包括 NSTextField）。

您有 2 个选项：您可以使用 SIMBL 或 AppleScript。在操作元素时，您使用 SIMBL 具有更大的灵活性，因此我建议您使用它。SIMBL 允许您编译“调整”库，然后将其加载到您选择的应用程序中，从而有效地允许您覆盖应用程序行为并添加功能。

您可以继续检测应用程序中的全局按键事件，并使用 IPC/XPC 与您的“tweak”库进行通信并通知它修改当前活动的 NSTextField，或者如果您不需要集中管理，您可以将这个逻辑在调整本身。

聚焦的 NSTextField 将`-firstResponder`在 NSResponder 链中

有关 SIMBL 的更多信息，你可以去[这里](http://www.culater.net/software/SIMBL/SIMBL.php)，或者如果你想使用 AppleScript，这里有一些与在其他应用程序中生成系统（包括按键）事件相关的信息：[http ://en.wikibooks.org/wiki/AppleScript_Programming/System_Events](http://en.wikibooks.org/wiki/AppleScript_Programming/System_Events)

# apache-flex - 如何访问 flex 4 中数据网格的项目渲染器中的 listData 属性

> ID：13109821
> 
> 赞同：1
> 
> 时间：2012-10-28T14:46:28.610
> 
> 标签：apache-flex, itemrenderer

我有一个自定义数据网格。我通过属性标准将 hslider 的值传递给它。我有一个用于扩展 GridItemRenderer 的数据网格的外部 itemrenderer。我想根据此属性标准动态更改项目渲染器。要从父组件访问“条件”属性，我想访问 listData 属性。为此，此自定义数据网格实现了 IDropinItemRender。但是 listData 的值为 null。在我的主应用程序中，我正在使用这个数据网格，如下所示。

```
<components:Mydatagrid dataProvider="{ac}" criteria="{hslider.value}">
<components:columns>
        <s:ArrayList>
            <s:GridColumn dataField="name" headerText="Name"></s:GridColumn>
            <s:GridColumn dataField="age" headerText="Age"></s:GridColumn>
            <s:GridColumn dataField="hair" headerText="Hair" itemRenderer="renderer.GridInlineDynamicRenderer"   />
        </s:ArrayList>
    </components:columns>
</components:Mydatagrid> 
```

这是我的项目渲染器代码。设置数据函数第 2 行的 listData 属性为空。

```
<?xml version="1.0" encoding="utf-8"?>
<s:GridItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                xmlns:s="library://ns.adobe.com/flex/spark" 
                xmlns:mx="library://ns.adobe.com/flex/mx" 
                clipAndEnableScrolling="true" implements="mx.controls.listClasses.IDropInListItemRenderer" >
<fx:Script>
    <![CDATA[
        import mx.controls.dataGridClasses.DataGridListData;
        import mx.controls.listClasses.BaseListData;

        import components.Mydatagrid;
        private var _listData:BaseListData;
        public function get listData() : BaseListData
        {
            return _listData;
        }
        public function set listData( value:BaseListData ) : void
        {
            _listData = value;
        }
        protected function button1_clickHandler(event:MouseEvent):void
        {
            dispatchEvent(new Event('hairEvent',true));
        }
        override public function set data(value:Object):void
        {
            super.data = value;
            var myListData:DataGridListData = DataGridListData(listData);
            var criteria:Number = (myListData.owner as Mydatagrid).criteria;
            hairClr.setStyle('color',data.hair);
            if(data.age < criteria)
                alpha = 0.4;
            else
                alpha = 1;
        }
    ]]>
</fx:Script>

<mx:HBox> 
    <s:Button click="button1_clickHandler(event)" label="Button" />
    <s:Label id="hairClr" text="Color" />
</mx:HBox>

</s:GridItemRenderer> 
```

listData 在这里为空。但是当我使用带有列表组件的项目渲染器时，它可以工作。项目渲染器的代码是相同的，除了列表项目渲染器扩展了 HBox。此代码的链接是[http://www.adobe.com/devnet/flex/articles/itemrenderers_pt3.html](http://www.adobe.com/devnet/flex/articles/itemrenderers_pt3.html)。我只是想用数据网格实现相同的功能。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:fx="http://ns.adobe.com/mxml/2009" 
                xmlns:s="library://ns.adobe.com/flex/spark" 
                xmlns:mx="library://ns.adobe.com/flex/mx" width="100%" height="100%" implements="mx.controls.listClasses.IDropInListItemRenderer">
<fx:Script>
    <![CDATA[
        import mx.controls.listClasses.BaseListData;

        import components.MyList;

        private var _listData:BaseListData;
        public function get listData() : BaseListData
        {
            return _listData;
        }
        public function set listData( value:BaseListData ) : void
        {
            _listData = value;
        }
        protected function button1_clickHandler(event:MouseEvent):void
        {
            dispatchEvent(new Event('hairEvent',true));
        }
        override public function set data(value:Object):void
        {
            super.data = value;
            var criteria:Number = (listData.owner as MyList).criteria;
            hairClr.setStyle('color',data.hair);
            if(data.age < criteria)
                alpha = 0.4;
            else
                alpha = 1;
        }
    ]]>
</fx:Script>

    <s:Button click="button1_clickHandler(event)" label="Button" />
    <s:Label id="hairClr" text="Color" />
</mx:HBox> 
```

# c# - 从 FTP 上传文件和下载文件

> ID：13109823
> 
> 赞同：7
> 
> 时间：2012-10-28T14:46:54.573
> 
> 标签：c#, upload, ftp, download, ftpwebrequest

我正在尝试制作一个将文件上传/下载`.exe`到`FTP`

我尝试使用`FtpWebRequest`，但我只成功上传和下载 .txt 文件。

然后我在这里找到了使用以下方式下载的解决方案`WebClient`：

```
WebClient request = new WebClient();
request.Credentials = new NetworkCredential("username", "password");
byte[] fileData =  request.DownloadData("ftp://myFTP.net/");

FileStream file = File.Create(destinatie);
file.Write(fileData, 0, fileData.Length);

file.Close(); 
```

此解决方案有效。但我看到`WebClient`有一种方法`DownloadFile`不起作用。我认为因为它`FTP`不仅适用于`HTTP`. 我的假设是真的吗？如果没有，我怎样才能让它工作？

还有其他解决方案可以`.exe`使用 ftp 将文件上传/下载到 ftp`FtpWebRequest`吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2017-08-02T05:38:07.347

两者都适用于 FTP[`WebClient.UploadFile`](https://docs.microsoft.com/en-us/dotnet/api/system.net.webclient.uploadfile)和[`WebClient.DownloadFile`](https://docs.microsoft.com/en-us/dotnet/api/system.net.webclient.downloadfile)二进制文件。

* * *

## 上传

```
WebClient client = new WebClient();
client.Credentials = new NetworkCredential("username", "password");
client.UploadFile(
    "ftp://ftp.example.com/remote/path/file.zip", @"C:\local\path\file.zip"); 
```

如果您需要更大的控制，`WebClient`但不提供（如[TLS/SSL 加密](https://stackoverflow.com/q/4331665/850848#56888555)、ascii/文本传输模式、传输恢复等），请使用[`FtpWebRequest`](https://docs.microsoft.com/en-us/dotnet/api/system.net.ftpwebrequest). 简单的方法是`FileStream`使用以下命令复制到 FTP 流[`Stream.CopyTo`](https://docs.microsoft.com/en-us/dotnet/api/system.io.stream.copyto)：

```
FtpWebRequest request =
    (FtpWebRequest)WebRequest.Create("ftp://ftp.example.com/remote/path/file.zip");
request.Credentials = new NetworkCredential("username", "password");
request.Method = WebRequestMethods.Ftp.UploadFile;  

using (Stream fileStream = File.OpenRead(@"C:\local\path\file.zip"))
using (Stream ftpStream = request.GetRequestStream())
{
    fileStream.CopyTo(ftpStream);
} 
```

如果您需要监控上传进度，您必须自己按块复制内容：

```
FtpWebRequest request =
    (FtpWebRequest)WebRequest.Create("ftp://ftp.example.com/remote/path/file.zip");
request.Credentials = new NetworkCredential("username", "password");
request.Method = WebRequestMethods.Ftp.UploadFile;  

using (Stream fileStream = File.OpenRead(@"C:\local\path\file.zip"))
using (Stream ftpStream = request.GetRequestStream())
{
    byte[] buffer = new byte[10240];
    int read;
    while ((read = fileStream.Read(buffer, 0, buffer.Length)) > 0)
    {
        ftpStream.Write(buffer, 0, read);
        Console.WriteLine("Uploaded {0} bytes", fileStream.Position);
    } 
} 
```

有关 GUI 进度 (WinForms `ProgressBar`)，请参阅：
[我们如何使用 FtpWebRequest 显示上传进度条](https://stackoverflow.com/q/6341024/850848#45931971)

如果要上传文件夹中的所有文件，请参阅
[C# 中的递归上传到 FTP 服务器](https://stackoverflow.com/q/60925131/850848)。

* * *

## 下载

```
WebClient client = new WebClient();
client.Credentials = new NetworkCredential("username", "password");
client.DownloadFile(
    "ftp://ftp.example.com/remote/path/file.zip", @"C:\local\path\file.zip"); 
```

如果您需要更大的控制，`WebClient`但不提供（如[TLS/SSL 加密](https://stackoverflow.com/q/4331665/850848#56888555)、ascii/文本传输模式、[恢复传输](https://stackoverflow.com/q/6331133/850848#66154869)等），请使用[`FtpWebRequest`](https://docs.microsoft.com/en-us/dotnet/api/system.net.ftpwebrequest). 简单的方法是将 FTP 响应流复制到`FileStream`使用[`Stream.CopyTo`](https://docs.microsoft.com/en-us/dotnet/api/system.io.stream.copyto)：

```
FtpWebRequest request =
    (FtpWebRequest)WebRequest.Create("ftp://ftp.example.com/remote/path/file.zip");
request.Credentials = new NetworkCredential("username", "password");
request.Method = WebRequestMethods.Ftp.DownloadFile;

using (Stream ftpStream = request.GetResponse().GetResponseStream())
using (Stream fileStream = File.Create(@"C:\local\path\file.zip"))
{
    ftpStream.CopyTo(fileStream);
} 
```

如果您需要监控下载进度，您必须自己按块复制内容：

```
FtpWebRequest request =
    (FtpWebRequest)WebRequest.Create("ftp://ftp.example.com/remote/path/file.zip");
request.Credentials = new NetworkCredential("username", "password");
request.Method = WebRequestMethods.Ftp.DownloadFile;

using (Stream ftpStream = request.GetResponse().GetResponseStream())
using (Stream fileStream = File.Create(@"C:\local\path\file.zip"))
{
    byte[] buffer = new byte[10240];
    int read;
    while ((read = ftpStream.Read(buffer, 0, buffer.Length)) > 0)
    {
        fileStream.Write(buffer, 0, read);
        Console.WriteLine("Downloaded {0} bytes", fileStream.Position);
    }
} 
```

有关 GUI 进度 (WinForms `ProgressBar`)，请参阅：
[FtpWebRequest FTP 下载与 ProgressBar](https://stackoverflow.com/q/45269263/850848)

如果要从远程文件夹下载所有文件，请参阅
[C# 通过 FTP 下载所有文件和子目录](https://stackoverflow.com/q/37038676/850848)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T14:50:54.633

您需要说明您是上传文本文件还是二进制文件。在声明和初始化请求后添加以下行：

```
request.UseBinary = true; 
```

[http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.usebinary.aspx](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.usebinary.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-12T04:12:08.993

上传很简单...

```
void Upload(){
    Web client = new WebClient();
    client.Credentials = new NetworkCredential(username, password);
    client.BaseAddress = "ftp://ftpsample.net/";

    client.UploadFile("sample.txt", "sample.txt"); //since the baseaddress
} 
```

* * *

下载也很容易......我在下面制作的代码使用[BackgroundWorker](https://msdn.microsoft.com/en-us/library/cc221403(v=vs.95).aspx)（所以它不会在下载开始时冻结界面/应用程序）。另外，我使用[lambda](https://msdn.microsoft.com/en-us/library/bb397687.aspx) `(=>)`缩短了代码。

```
void Download(){
    Web client = new WebClient();
    client.Credentials = new NetworkCredential(username, password);

    BackgroundWorker bg = new BackgroundWorker();
    bg.DoWork += (s, e) => { 
        client.DownloadFile("ftp://ftpsample.net/sample.zip", "sample.zip"); 
    };
    bg.RunWorkerCompleted += (s, e) => { //when download is completed
        MessageBox.Show("done downloading");
        download1.Enabled = true; //enable download button
        progressBar.Value = 0; // reset progressBar
    };
    bg.RunWorkerAsync();
    download1.Enabled = false; //disable download button 
    while (bg.IsBusy)
    {
        progressBar.Increment(1); //well just for extra/loading
        Application.DoEvents(); //processes all windows messages currently in the message queue
    }
} 
```

您还可以使用[DownloadFileAsync](https://msdn.microsoft.com/en-us/library/ms144196(v=vs.110).aspx "下载文件异步")方法显示文件下载的真实进度：

```
client.DownloadFileAsync(new Uri("ftp://ftpsample.net/sample.zip"), "sample.zip");
client.DownloadProgressChanged += (s, e) =>
{
    progressBar.Value = e.ProgressPercentage; //show real download progress
};
client.DownloadFileCompleted += (s, e) =>
{
    progressBar.Visible = false;
    // other codes after the download
};
//You can remove the 'while' statement and use this ^ 
```

# ruby - Ruby 块参数与局部变量同名

> ID：13109825
> 
> 赞同：2
> 
> 时间：2012-10-28T14:47:11.817
> 
> 标签：ruby

在[ruby​​ docs](http://www.ruby-doc.org/docs/ProgrammingRuby/)中，有这样的文字：

> 块参数实际上是局部变量。如果在块执行时存在同名的现有本地，则该变量将通过调用块来修改。这可能是也可能不是一件好事。

我写了下面的代码来测试这个：

```
x = 0
3.upto(6) {|x| puts x}
puts x

# output are:
# 3
# 4
# 5
# 6
# 0 
```

变量`x`没有改变。为什么？这违反了文档。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T14:53:02.277

在 Ruby 1.8 及更早版本中，情况就是如此。从 1.9 开始，块变量隐藏局部变量。

因此，简而言之：您正在阅读的文档和您正在测试的 Ruby 不是同一个版本。

# matlab - 在 MATLAB 中计算没有循环的格拉姆矩阵

> ID：13109826
> 
> 赞同：1
> 
> 时间：2012-10-28T14:47:19.467
> 
> 标签：matlab, svm

我有一个矩阵`X(10000, 800)`。我想计算 gramm 矩阵`K(10000,10000)`，其中`K(i,j)= exp(-(X(i,:)-X(j,:))^2)`.

首先我使用双循环，但后来它永远挂起。然后我尝试了这个：

```
[N d] = size(X);
aa = repmat(X',[1 N]);
bb = repmat(reshape(X',1,[]),[N 1]);
K = reshape((aa-bb).^2, [N*N d]);
K = reshape(sum(D,2),[N N]); 
```

但是后来它使用了很多额外的空间，我很快就用完了内存。是否有任何有效的矢量化方法。我确信一定有一些东西，因为这对于许多内核 svm 以及图像处理来说都是一个相当标准的中间步骤。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-25T11:13:26.887

使用[**pdist2**](http://www.mathworks.de/de/help/stats/pdist2.html)或 pdist。请注意，来自 Matlab 的 pdist2 很[慢](https://gist.github.com/31bb963e0a2d7556b432.git)...... ![Matlab余弦距离很慢](../Images/b9dd2c7510d5332a8e8c37f6d56447b4.png)

代码：

```
X = rand(100, 3);
K = squareform(pdist(X, 'euclidean'));
K = exp(-K.^2); 
```

我会为更一般的情况写这个，你有*两个*矩阵并且你想找到所有的距离。 `(x-y)^2 = x'x - 2x'y + y'y`如果要计算 Gram 矩阵，则需要所有差异组合。

```
X = rand(100, 3);
Y = rand(50, 3);
A = sum(X .* X, 2);
B = -2 *X * Y';
C = sum(Y .* Y, 2);
K = bsxfun(@plus, A, B);
K = bsxfun(@plus, K, C);
K = exp(-K); 
```

# 编辑：速度比较

## 代码

```
% http://stackoverflow.com/questions/13109826/compute-a-gramm-matrix-in-matlab-without-loops/24407122#24407122
function time_gramm()
% I have a matrix X(10000, 800). I want to compute gramm matrix K(10000,10000), where K(i,j)= exp(-(X(i,:)-X(j,:))^2).
X = rand(100, 800);

%% The straight-forward pdist solution.
tic;
K = squareform(pdist(X, 'euclidean'));
K1 = exp(-K .^2);
t1 = toc;
fprintf('pdist took \t%d seconds\n', t1);

%% The vectorized solution
tic;
A = sum(X .* X, 2);
B = -2 * X * X';
K = bsxfun(@plus, A, B);
K = bsxfun(@plus, K, A');
K2 = exp(-K);
t2 = toc;
fprintf('Vectorized solution took \t%d seconds.\n', t2);

%% The not-so-smart triple-loop solution
tic;
N = size(X, 1);
K3 = zeros(N, N);
for i=1:N
    %     fprintf('Running outer loop for i= %d\n', i);
    for j=1:N
        xij = X(i,:) - X(j,:);
        xij = norm(xij, 2);
        xij = xij ^ 2;
        K3(i,j) = -xij;
        %         d = X(i,:) - X(j,:); % Alternative way, twice as fast but still
        %         orders of magnitude slower than the other solutions.
        %         K3(i,j) = exp(-d * d');
    end
end
K3 = exp(K3);
t3 = toc;
fprintf('Triple-nested loop took \t%d seconds\n', t3);
%% Assert results are the same...
assert(all(abs(K1(:) - K2(:)) < 1e-6 ));
assert(all(abs(K1(:) - K3(:)) < 1e-6 ));
end 
```

## 结果

我用 N=100 运行了上面的代码

```
pdist took  8.600000e-03 seconds
Vectorized solution took    3.916000e-03 seconds.
Triple-nested loop took     2.699330e-01 seconds 
```

请注意，在问题的第 100 个请求大小处，另一个答案 ( `O(m^2 n)`) 中建议的代码的性能要慢两个数量级。到那时，我插入了 100k 作为`X`矩阵的大小，这比我愿意等待的时间要长得多。

在全尺寸问题 ( `X = rand(10000, 800)`) 上的表现是这样的：

```
pdist took  5.470632e+01 seconds
Vectorized solution took    1.141894e+01 seconds. 
```

## 评论

矢量化解决方案耗时 11 秒，Matlab 的 pdist 耗时 55 秒，而另一个示例中建议的手动解决方案从未完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:10:43.053

为什么不使用简单的公式呢？对于元素`K(i, j) = exp( sum_{k=0}^{n} (X(i, k) - X(j, k))^2`。所以，这是两个外循环 for`i`和`j`一个内循环 for `k`。时间复杂度为`O(m^2 n)`，其中有`m`行和`n`列`X`。空间复杂度是因为除了和矩阵`O(1)`之外，您不使用更多空间来计算答案。`X``K`

你试过这个吗，真的这么慢吗？

# java - RoundRobin Java：基于循环算法的执行过程不发生

> ID：13109829
> 
> 赞同：2
> 
> 时间：2012-10-28T14:48:01.903
> 
> 标签：java, round-robin

我在这里遇到了一个问题：当前一个进程执行时间完全完成时，下一个进程才被执行。我需要这个过程基于循环算法执行。谁能给我提示如何为双处理器编写

```
 import java.util.Scanner;
public class RoundRobin {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
    Scanner keyboard = new Scanner(System.in);
    System.out.println("Enter the number of processes");
    int noProcess= keyboard.nextInt();
    int[][] process = new int[noProcess][3]; //1st column: process name, 2nd column: arrival time, 3rd column: execution time
    System.out.println("Input the Arrival and Execution Time for each process\n"); //in seconds, arrival for each process
    for(int i = 0; i < process.length ;i++)
        {
                process[i][0] = i+1;
                System.out.print("Process " +process[i][0]+ " :\t");
                System.out.print("Arrival Time : ");
                process[i][1] = keyboard.nextInt();
                System.out.print("\t\tExec. Time : ");  
                process[i][2] = keyboard.nextInt();
        }
    //sorting the processes based on arrival time
        for(int index = 0; index< process.length; index++ )
        {
          int indexOfNextSmallest = RoundRobin.getIndexOfSmallest(index, process);
          interchange(index, indexOfNextSmallest, process);   

        }
        System.out.println("ProName\tArrTime\tExecTime"); //table after scheduled.
        for(int row = 0; row < noProcess; row++)
        {
                for(int column = 0; column < 3; column++)
                {
                        System.out.print("" +process[row][column]+ "\t");
                }
                System.out.println("\n");
        }
        System.out.print("Enter the Quantum time:"); //in seconds
        int qTime = keyboard.nextInt();
       // boolean counter = true;//false if all process is completely execute
        /**while(counter)
        {

        }**/
       int current =0;
       int counter = qTime;
       int arrTime = 0;
       int index = 0;
       while(true)
       {

           if(process[index][2] >= qTime)
           {
               process[index][2] =  process[index][2]- qTime;
               counter = counter + qTime;
               System.out.println("Process" +process[index][0]);
           }
           if(process[index][2] != 0 && process[index][2] < qTime )
           {
               process[index][2] =  process[index][2] - process[index][2];
               counter = counter + process[index][2];
               System.out.println("Process" +process[index][0]);
           }

          boolean condition = true;
          int i = 0;
          while(condition)//check any uncompleted process
          {
              if(i == process.length){
                  System.out.println("All Process Executions are completed");
                  System.exit(0);}
              else if(process[i][2] == 0)
              {        
                i++;
              }
              else
              {
                 if(index < process.length-1)
                  {
                    if(counter >= process[index+1][1] )
                    {   index = index + 1;}
                    else
                    {   index = 0;}
                  }
                  else
                    {  index = 0;}

                    condition = false;
                }
          }

       }

// TODO code application logic here
    }

    private static int getIndexOfSmallest(int startIndex, int[][] a) {
        int min = a[startIndex][1];
        int indexOfMin = startIndex;
        for(int index = startIndex+1; index <a.length; index++)
        {
            if(a[index][1] < min)
            {
                min = a[index][1];
                indexOfMin = index;
            }
        }
        return indexOfMin;
    }
    private static void interchange(int i, int j, int[][] a)
    {
        int temp0 = a[i][0];
        int temp1 = a[i][1];
        int temp2 = a[i][2];
        a[i][0] = a[j][0];
        a[i][1] = a[j][1];
        a[i][2] = a[j][2];
        a[j][0] = temp0;
        a[j][1] = temp1;
        a[j][2] = temp2;
    }
} 
```

JAva 代码文件：[https](https://skydrive.live.com/redir?resid=45E9B19710622F21!107) ://skydrive.live.com/redir?resid=45E9B19710622F21!107 执行期间的图像：[https ://skydrive.live.com/redir?resid=45E9B19710622F21!108](https://skydrive.live.com/redir?resid=45E9B19710622F21!108)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T05:25:31.350

你需要的是一个简单的清单。循环很容易实现为列表。只需从列表的前面删除，然后将其放在后面。

```
ArrayList<Task> tasksToExecute = new ArrayList<Task>();
//  some code here that populates the list the first time

while (needToWork)
{
    Task nextTask = tasksToExecute.remove(0); // get the first object
    // process the task here
    tasksToExecute.add(nextTask);  // put the task back on the list
} 
```

这将均匀处理列表中的所有任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T11:33:21.440

这是我在 Java 中的大学项目。它显示了 CPU 如何接收每个进程。我在法国，这就是为什么它是法语：

```
import java.util.Scanner;

public class Round {
    int[] t = new int[26];
    int[] ta = new int[26];
    Scanner scan = new Scanner(System.in);
    String lettres = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    String[] nom = lettres.split("");

    public void robin_sta() {
        /**
         * @author Etudiantcci Si les processus arrivent tous en même temps
         */
        System.out.println("\nRound Robin sans temps d'arrivée\n");
        int nbproc;
        int att = 0;
        do {
            System.out.print("Combien de processus (entre 1 et 26)? ");
            nbproc = scan.nextInt();
            if (nbproc <= 0 || nbproc > 26) {
                att++;
                if (att == 3) {
                    System.out.println("\nAu revoir!");
                    return;
                }
                System.out.println("\nChoisisez un entier entre 1 et 26, s'il-vous-plaît");
            }
        } while (nbproc <= 0 || nbproc > 26);

        att = 0;
        int q;
        System.out.println();
        do {
            System.out.print("Quantum s'il-vous-plaît: ");
            q = scan.nextInt();
            if (q <= 0) {
                att++;
                if (att == 3) {
                    System.out.println("\nAu revoir!");
                    return;
                }
                System.out.println("\nChoisisez un entier supérieur à 0, s'il-vous-plaît");
            }
        } while (q <= 0);
        for (int i = 0; i < nbproc; i++) {
            System.out.print("Rentrez la taille du processus " + nom[i + 1]
                    + ": ");
            t[i] = scan.nextInt();
            if (t[i] < 0) {
                System.out.println("\nValeurs positives s'il vous plaît!\n");
                System.out.print("Rentrez la taille du processus " + nom[i + 1]
                        + ": ");
                t[i] = scan.nextInt();
                if (t[i] < 0) {
                    System.out
                            .println("\nValeurs positives s'il vous plaît!\n");
                    System.out.print("Rentrez la taille du processus "
                            + nom[i + 1] + ": ");
                    t[i] = scan.nextInt();
                    if (t[i] < 0) {
                        System.out.println("\nVous comprenez rien!");
                        return;
                    }
                }
            }
            System.out
                    .print("Processus " + nom[i + 1]
                            + " (taille,temps d'arrivée): (" + t[i] + ","
                            + ta[i] + ")");
            System.out.println("\n");
        }

        /**
         * @author Etudiantcci Mise en place des outils pour la méthode
         */

        int[] t1 = new int[nbproc];
        int[] ta1 = new int[nbproc];
        int[] fil = new int[nbproc];
        int[] t2 = new int[nbproc];
        int[] t3 = new int[nbproc];
        int[] temps = new int[nbproc];
        int[] rot = new int[nbproc];

        for (int i = 0; i < nbproc; i++)
            t1[i] = t[i];
        for (int i = 0; i < nbproc; i++)
            ta1[i] = ta[i];

        int t = 0;
        for (int i : t1)
            t += i;
        String[] tab = new String[t];

        int s = ta1[0];
        for (int i : ta1)
            if (i < s)
                s = i;
        int k = 0;
        int j = 0;
        if (t1[0] == 0)
            for (int i = 0; i < nbproc; i++)
                if (t1[i] > 0) {
                    j = i;
                    break;
                }
        int port = 0;

        while (k < t) {
            for (int i = 0; i < nbproc; i++)
                if (ta1[i] == s) {
                    t2[i] = t1[i];
                    temps[i] = 1;
                    fil[i] = 1;
                }
            for (int i = 0; i < nbproc; i++)
                if (i != j && fil[i] == 1)
                    t3[i]++;
            fil[j] = 0;
            int cpt = 0;
            for (int i : t2)
                if (i > 0)
                    cpt++;
            if (cpt > 0) {
                if (port > 0) {
                    /**
                     * @author Etudiantcci Après un certain temps sans processus
                     *         exécutés, on détermine le prochain à exécuter dès
                     *         qu'il arrive
                     */
                    j = next_job(ta1, t2, j, s, t3);
                    port = 0;
                }
                int p = 0;
                while (p < q) {
                    /**
                     * @author Etudiantcci Calcul des temps d'attente
                     */
                    for (int i = 0; i < nbproc; i++)
                        if (i != j && temps[i] > 0 && t2[i] > 0)
                            temps[i]++;
                    tab[k] = nom[j + 1];
                    t2[j]--;
                    k++;
                    p++;
                    s++;
                    if (t2[j] == 0)
                        break;
                    /**
                     * @author Etudiantcci Si le processus se termine, on sort
                     *         de la boucle et on réinitialise le compteur du
                     *         quantum
                     */
                    for (int i = 0; i < nbproc; i++)
                        if (ta1[i] == s) {
                            t2[i] = t1[i];
                            temps[i] = 1;
                            fil[i] = 1;
                        }
                    /**
                     * @author Etudiantcci On donne plus de priorité aux
                     *         processus qui sont déjà dans la file d'attente
                     */
                    for (int i = 0; i < nbproc; i++)
                        if (i != j && fil[i] == 1)
                            t3[i]++;
                }
                if (t2[j] > 0)
                    fil[j] = 1;
                t3[j] = 0;
                for (int i = 0; i < nbproc; i++)
                    if (ta1[i] == s) {
                        t2[i] = t1[i];
                        temps[i] = 1;
                        fil[i] = 1;
                    }
                for (int i = 0; i < nbproc; i++)
                    if (i != j && fil[i] == 1)
                        t3[i]++;
                /**
                 * @author Etudiantcci Calcul du temps de rotation
                 */
                if (t2[j] == 0)
                    rot[j] = s - ta1[j];
                j = next_job(ta1, t2, j, s, t3);
                fil[j] = 0;
                t3[j] = 0;
            } else {
                s++;
                port++;
            }
        }

        System.out.print("\n * * Interprétation du processeur * *\n\n\t");
        affiche_tab(tab);
        System.out.println("\t");

        System.out.println("\n * * * Temps d'attente * * *");
        for (int i = 0; i < nbproc; i++) {
            System.out.print("\t" + nom[i + 1] + " --> ");
            if (temps[i] > 0)
                System.out.println(temps[i] - 1);
            else
                System.out.println(0);
        }

        System.out.print("\n * * Temps d'attente moyen * *\n\t");
        int m = 0;
        for (int i : temps)
            if (i > 0)
                m += i - 1;
        System.out.println((double) m / nbproc);

        System.out.println("\n * * * Temps de rotation * * *");
        for (int l = 0; l < nbproc; l++) {
            System.out.print("\t" + nom[l + 1] + " --> ");
            System.out.println(rot[l]);
        }

        System.out.println("\n * * Temps de rotation moyen * *");
        m = 0;
        for (int z : rot)
            m += z;
        System.out.println("\t" + (double) m / nbproc);

        System.out.println("\n * * Durée de l'exécution * *");
        System.out.println("\t" + s);
    }

    /**
     * @author Etudiantcci Pour déterminer le prochain processus à exécuter
     */

    private int next_job(int[] ta1, int[] t2, int j, int s, int[] t3) {
        int cpt = 0;
        int n = 0;
        for (int i = 0; i < t2.length; i++)
            if (t2[i] > 0) {
                cpt++;
                n = i;
            }
        if (cpt == 1)
            return n;
        else {
            cpt = 0;
            for (int k = 0; k < t2.length; k++)
                if (k != j && t2[k] > 0 && t3[k] == max(t3))
                    cpt++;
            if (cpt > 0)
                for (int k = 0; k < t2.length; k++)
                    if (k != j && t2[k] > 0 && t3[k] == max(t3))
                        return k;
            return j;
        }
    }

    /**
     * @author Etudiantcci Pour trouver la valeur maximale dans un tableau. On
     *         se sert pour déterminer le prochain proccesus à exécuter parmi
     *         ceux qui sont dans la file d'attente
     */

    private int max(int[] t3) {
        int max = t3[0];
        for (int i : t3)
            if (i > max)
                max = i;
        return max;
    }

    /**
     * @author Etudiantcci Pour afficher l'ordre d'exécution des processus
     */

    private void affiche_tab(String[] tab) {
        for (String i : tab)
            System.out.print(" " + i);
    }

    /**
     * @author Etudiantcci Pour déterminer le premier processus à exécuter
     */

    private int first_job(int[] ta1, int[] t1) {
        int ta_min = ta1[0];
        int t = 0;
        int[] n = new int[ta1.length];
        int[] m = new int[ta1.length];
        for (int i = 0; i < n.length; i++)
            if (ta1[i] < ta_min)
                ta_min = ta1[i];
        for (int i = 0; i < n.length; i++)
            if (ta1[i] == ta_min)
                n[i] = ta_min + 1;
        for (int i = 0; i < n.length; i++)
            if (n[i] == ta_min + 1)
                m[i] = t1[i];
        int k = min_positif(m);
        for (int i = 0; i < t1.length; i++)
            if (ta_min == ta1[i] && k == t1[i])
                t = i;
        return t;
    }

    /**
     * @author Etudiantcci Pour retrouver la plus petite valeur strictement
     *         positive
     */

    public int min_positif(int[] ar) {
        int min = -1;
        for (int i : ar)
            if (i > 0) {
                min = i;
                break;
            }
        if (min == -1) {
            System.out.println("\nPas de valeurs positives");
            return min;
        }
        for (int i : ar)
            if (i < min && i > 0)
                min = i;
        return min;
    }

    /**
     * @author Etudiantcci Pour retrouver l'indice de la plus petite valeur
     *         positive dans un tableau
     */

    public int ind_min_positif(int[] ar) {
        int min = min_positif(ar);
        int k = 0;
        for (int i = 0; i < ar.length; i++)
            if (ar[i] == min)
                k = i;
        return k;
    }

    public void robin_ta() {
        /**
         * @author Etudiantcci Si les processus arrivent à différents instants
         */
        System.out.println("\nRound Robin avec temps d'arrivée\n");
        int nbproc;
        int att = 0;
        do {
            System.out.print("Combien de processus (entre 1 et 26)? ");
            nbproc = scan.nextInt();
            if (nbproc <= 0 || nbproc > 26) {
                att++;
                if (att == 3) {
                    System.out.println("\nAu revoir!");
                    return;
                }
                System.out.println("\nChoisisez un entier entre 1 et 26, s'il-vous-plaît");
            }
        } while (nbproc <= 0 || nbproc > 26);

        att = 0;
        int q;
        System.out.println();
        do {
            System.out.print("Quantum s'il-vous-plaît: ");
            q = scan.nextInt();
            if (q <= 0) {
                att++;
                if (att == 3) {
                    System.out.println("\nAu revoir!");
                    return;
                }
                System.out.println("\nChoisisez un entier supérieur à 0, s'il-vous-plaît");
            }
        } while (q <= 0);

        for (int i = 0; i < nbproc; i++) {
            System.out.print("\nTaille du processus " + nom[i + 1] + "? ");
            t[i] = scan.nextInt();
            if (t[i] < 0) {
                System.out.println("\nValeurs positives s'il vous plaît!\n");
                System.out.print("\nTaille du processus " + nom[i + 1] + "? ");
                t[i] = scan.nextInt();
                if (t[i] < 0) {
                    System.out
                            .println("\nValeurs positives s'il vous plaît!\n");
                    System.out.print("\nTaille du processus " + nom[i + 1]
                            + "? ");
                    t[i] = scan.nextInt();
                    if (t[i] < 0) {
                        System.out.println("\nAu revoir");
                        return;
                    }
                }
            }
            System.out.print("Rentrez son temps d'arrivée: ");
            ta[i] = scan.nextInt();
            if (ta[i] < 0) {
                System.out.println("\nValeurs positives s'il vous plaît!\n");
                System.out.print("Rentrez son temps d'arrivée: ");
                ta[i] = scan.nextInt();
                if (ta[i] < 0) {
                    System.out
                            .println("\nValeurs positives s'il vous plaît!\n");
                    System.out.print("Rentrez son temps d'arrivée: ");
                    ta[i] = scan.nextInt();
                    if (ta[i] < 0) {
                        System.out.print("\nAu revoir!");
                        return;
                    }
                }
            }
            System.out.print("Processus " + nom[i + 1]+" (taille,temps d'arrivée): (" + t[i] + ","
                            + ta[i] + ")");
            System.out.println();
        }

        int[] t1 = new int[nbproc];
        int[] ta1 = new int[nbproc];
        int[] fil = new int[nbproc];
        int[] temps = new int[nbproc];
        int[] rot = new int[nbproc];

        for (int i = 0; i < nbproc; i++)
            t1[i] = t[i];
        for (int i = 0; i < nbproc; i++)
            ta1[i] = ta[i];

        int t = 0;
        for (int i : t1)
            t += i;
        String[] tab = new String[t];

        int s = ta1[0];
        for (int i : ta1)
            if (i < s)
                s = i;
        int k = 0;
        int[] t2 = new int[nbproc];
        int[] t3 = new int[nbproc];
        int j = first_job(ta1, t1);
        if (t1[0] == 0)
            for (int i = 0; i < nbproc; i++)
                if (t1[i] > 0) {
                    j = i;
                    break;
                }
        int port = 0;

        while (k < t) {
            for (int i = 0; i < nbproc; i++)
                if (ta1[i] == s) {
                    t2[i] = t1[i];
                    temps[i] = 1;
                    fil[i] = 1;
                }
            for (int i = 0; i < nbproc; i++)
                if (i != j && fil[i] == 1)
                    t3[i]++;
            fil[j] = 0;
            int cpt = 0;
            for (int i : t2)
                if (i > 0)
                    cpt++;
            if (cpt > 0) {
                if (port > 0) {

                    /**
                     * Après un certain temps sans processus exécutés, on
                     * détermine le prochain à exécuter dès qu'il arrive
                     */
                    j = next_job(ta1, t2, j, s, t3);
                    port = 0;
                }
                int p = 0;
                while (p < q) {
                    /**
                     * @author Etudiantcci Calcul des temps d'attente
                     */
                    for (int i = 0; i < nbproc; i++)
                        if (i != j && temps[i] > 0 && t2[i] > 0)
                            temps[i]++;
                    tab[k] = nom[j + 1];
                    t2[j]--;
                    k++;
                    p++;
                    s++;
                    if (t2[j] == 0)
                        break;
                    /**
                     * @author Etudiantcci Si le processus se termine, on sort
                     *         de la boucle et on réinitialise le compteur du
                     *         quantum
                     */
                    for (int i = 0; i < nbproc; i++)
                        if (ta1[i] == s) {
                            t2[i] = t1[i];
                            temps[i] = 1;
                            fil[i] = 1;
                        }
                    /**
                     * @author Etudiantcci On donne plus de priorité aux
                     *         processus qui sont déjà dans la file d'attente
                     */
                    for (int i = 0; i < nbproc; i++)
                        if (i != j && fil[i] == 1)
                            t3[i]++;
                }
                if (t2[j] > 0)
                    fil[j] = 1;
                t3[j] = 0;
                for (int i = 0; i < nbproc; i++)
                    if (ta1[i] == s) {
                        t2[i] = t1[i];
                        temps[i] = 1;
                        fil[i] = 1;
                    }
                for (int i = 0; i < nbproc; i++)
                    if (i != j && fil[i] == 1)
                        t3[i]++;
                /**
                 * @author Etudiantcci Calcul du temps de rotation
                 */
                if (t2[j] == 0)
                    rot[j] = s - ta1[j];
                j = next_job(ta1, t2, j, s, t3);
                fil[j] = 0;
                t3[j] = 0;
            } else {
                s++;
                port++;
            }
        }

        System.out.print("\n * * Interprétation du processeur * *\n\n\t");
        affiche_tab(tab);
        System.out.println("\t");

        System.out.println("\n * * * Temps d'attente * * *");
        for (int i = 0; i < nbproc; i++) {
            System.out.print("\t" + nom[i + 1] + " --> ");
            if (temps[i] > 0)
                System.out.println(temps[i] - 1);
            else
                System.out.println(0);
        }

        System.out.print("\n * * Temps d'attente moyen * *\n\t");
        int m = 0;
        for (int i : temps)
            if (i > 0)
                m += i - 1;
        System.out.println((double) m / nbproc);

        System.out.println("\n * * * Temps de rotation * * *");
        for (int l = 0; l < nbproc; l++) {
            System.out.print("\t" + nom[l + 1] + " --> ");
            System.out.println(rot[l]);
        }

        System.out.println("\n * * Temps de rotation moyen * *");
        m = 0;
        for (int z : rot)
            m += z;
        System.out.println("\t" + (double) m / nbproc);

        System.out.println("\n * * Durée de l'exécution * *");
        System.out.println("\t" + s);
    }

} 
```

# java - Appengine 位置标头在什么基础上告诉位置？

> ID：13109831
> 
> 赞同：4
> 
> 时间：2012-10-28T14:48:22.947
> 
> 标签：java, google-app-engine, jakarta-ee, http-headers, location

我在 Google Appengine 上托管了我的 Web 应用程序。有时我需要知道访客的位置。所以我一直在使用谷歌提供的请求头：

```
 String visitorCountry = request.getHeader("X-AppEngine-Country");
        String visitorRegion = request.getHeader("X-AppEngine-Region");       
        String visitorCity = request.getHeader("X-AppEngine-City");
        String visitorLatLong = request.getHeader("X-AppEngine-CityLatLong"); 
```

他们从来没有准确的位置，我想它告诉我 ISP 的位置。Google Appengine 的请求标头在什么基础上起作用？它主要是在客户端随请求发送的 IP 地址上吗？

这是供参考的[标头文档](https://developers.google.com/appengine/docs/python/runtime#Request_Headers)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T18:05:40.870

人们可以去这里 - [http://mylocationtest.appspot.com/](http://mylocationtest.appspot.com/) - 看看他们有什么位置信息。

对我来说，纬度/经度只是所列城市的名义中心 - 距我的实际位置约 20 公里。ISP 是加拿大罗杰斯。

显然，有时国家会以“ZZ”的形式出现。 [http://code.google.com/p/googleappengine/issues/detail?id=5296](http://code.google.com/p/googleappengine/issues/detail?id=5296)

此 IP 地址信息通常与[ASN](http://en.wikipedia.org/wiki/Autonomous_System_%28Internet%29)一起打包。这会告诉您 ISP，正如上面提到的那样，只有他们才能说出他们的 IP 分配在哪里。也许位置信息的准确性取决于 ISP。

（这不是问题的答案——只是进一步的讨论——但它在评论中并没有真正起作用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T02:52:05.007

根据我的经验，使用 HTML5 地理位置功能往往比基于 IP 的位置检测更准确。当您在启用 GPS 的设备上使用移动网站并且启用了高精度时，尤其如此。

查看这篇文章也可以很好地讨论这两种方法：[Why HTML5 Geolocation？](https://stackoverflow.com/questions/7541779/why-html5-geolocation)

# ajax - 如何在 ajax 函数中添加上传图片功能？

> ID：13109836
> 
> 赞同：-1
> 
> 时间：2012-10-28T14:48:31.810
> 
> 标签：ajax, codeigniter-2

我在这里遇到了一个难题，我在 ajax 函数中使用 if else 我有这个代码

```
function submitForm() {

    offset  = jQuery('#email').offset();
    xTop    = offset.top - $(window).height()/2 ;
    posLeft = offset.left - ($(window).width()-765)/2 ;
    posTop  = offset.top;
    params = jQuery('#registration-form').serialize();
    lytebox.show({message:'Please wait...', align: 'center', closeButton: false});
    jQuery.post('ajax/register', params + '&registered=' + isRegistered, function(data) {
            data = eval('(' + data + ')');
            if(data.error) {
                    lytebox.close();
                    $('#errorHolder').remove();
                    error = data.remarks;
                    error +='<img src="images/ttip-arrow.png" id="ttip-arrow"/></div>';
                    var wrapper     = $('.wrapper');
                    var errorHolder = $('<div id="errorHolder">')
                                                      .html(error).appendTo(wrapper);;

                    errorHolder.css({
                                                            'left':posLeft,
                                                            'top':posTop-$('#errorHolder').outerHeight()
                                              })
                                       .delay(5500)
                                       .fadeOut(1000);

                    //$("html, body").animate({scrollTop : xTop},800,function(){me.focus()});
                    FB.Canvas.scrollTo(0,posTop-100);
                    jQuery('#email').focus();
            } else {       
                    lytebox.close();

                    //how can i add upload image here and send email function with attach image
                    $('.notification').remove();
                    $('#errorHolder').remove();
                    $('#registration-form').fadeOut(300);
                    $('.get-started').fadeIn(300);
                    $('.show-thank-you-register').fadeIn(300);

            }
    }); 
```

}

我想在其他部分添加上传图片功能和电子邮件发送功能..请帮帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:13:30.610

有一个用于序列化表单数据的序列化常量。 [http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

以下元素不是序列化的正确候选者。

```
<input type="file"/> 
```

因此它不能包含在 jQuery('#registration-form').serialize(); 方法。

所以你不能使用图像字节的序列化来向服务器提交图像数据。

或者，您可以使用 ajax 发布调用来上传控件以上传图像。欲了解更多信息，请访问以下网址

[http://www.uploadify.com/demos/](http://www.uploadify.com/demos/)

**编辑**

首先上传您的图片 uplodify 有*onComplete*事件，告诉上传已完成并成功，现在您根据您的业务需求保存表单的其余部分。

# asp.net-mvc-3 - 可以呈现部分视图的 HTML-Helper 函数

> ID：13109838
> 
> 赞同：0
> 
> 时间：2012-10-28T14:48:56.620
> 
> 标签：asp.net-mvc-3, partial-views, html-helper

是否可以创建呈现部分视图的 HTML.Helper 函数？

在我的项目中，这将允许我创建一个 Helper 来显示信息消息（或错误消息）。此函数将（例如）接收消息本身，并使用 html 呈现部分视图以显示该消息。我知道我可以将 html 放在辅助函数本身中（不使用部分视图），但在这种情况下，为了改变显示的消息的外观，我必须弄乱代码，而不仅仅是部分视图文件。

谁能帮我解决这个问题？

在此先感谢 Marcelo Myara 里约热内卢-巴西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:15:29.893

您可以使用`Html.RenderAction`或`Html.Action`（[Html.RenderAction 和 Html.Action 之间的区别](https://stackoverflow.com/questions/2955261/difference-between-html-renderaction-and-html-action)）

```
@Html.Action("MyAction", "MyController", new { MyMessage = "test" }) 
```

或者

```
@{ Html.RenderAction("MyAction", "MyController", new { MyMessage = "test" }) } 
```

# c# - 为什么 Convert.ToDecimal(3.1922) 显示为 31922？

> ID：13109839
> 
> 赞同：2
> 
> 时间：2012-10-28T14:49:02.167
> 
> 标签：c#, number-formatting

我正在读取一个包含值的 XML 文件。当我读到它们时，它们是字符串。

因此，当我尝试将它们转换为`Double`或`Decimal`点消失时。

```
decimal dec = Convert.ToDecimal("3.1922");             
MessageBox.Show(dec.ToString()); // 31922 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T14:53:00.870

这和你现在的文化有关

```
decimal dec = Convert.ToDecimal("3.1922",CultureInfo.CreateSpecificCulture("de-DE"));
MessageBox.Show(dec.ToString()); //31922

dec = Convert.ToDecimal("3.1922", CultureInfo.CreateSpecificCulture("en-US"));
MessageBox.Show(dec.ToString()); //3.1922

dec = Convert.ToDecimal("3,1922", CultureInfo.CreateSpecificCulture("de-DE"));
MessageBox.Show(dec.ToString()); //3.1922 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:51:15.103

在您当前的文化`.`中用作千位分隔符。您可以通过以下方式验证它：

```
var culture = Thread.CurrentThread.CurrentCulture;
var numberFormat = culture.NumberFormat;
string groupSeparator = numberFormat.NumberGroupSeparator; // will be .
string decimalSeparator = numberFormat.NumberDecimalSeparator; // will be , 
```

您可以为解析指定所需的文化：

```
decimal dec = Decimal.Parse("3.1922", new CultureInfo("en-US")); 
```

或者您可以将您的文化设置为当前：

```
Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
decimal dec = Decimal.Parse("3.1922"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T14:54:44.817

检查您的 NumberFormat.NumberDecimalSeparator。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-28T14:59:48.263

首先将这些代码添加到`public form1()` `after InitializeComponent();`：

```
public Form1()
    {
        InitializeComponent();
        System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo("en-US");
        System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo("en-US");
    } 
```

然后在任何你想要的地方使用你的代码：

```
decimal dec = Convert.ToDecimal("3.1922");
        MessageBox.Show(dec.ToString()); 
```

更新 ：

如果您不希望全局更改，则应在显示小数之前添加代码。

```
private void ShowDecimal_Click(object sender, EventArgs e)
    {
        System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo("en-US");
        System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo("en-US");
        decimal dec = Convert.ToDecimal("3.1922");
        MessageBox.Show(dec.ToString());
    } 
```

更新 2：

```
decimal dec = Decimal.Parse("3.1922", new CultureInfo("en-US"));
MessageBox.Show(dec.ToString()); 
```

# android - ListView中的Android备用行颜色

> ID：13109840
> 
> 赞同：33
> 
> 时间：2012-10-28T14:49:04.070
> 
> 标签：android, listview

```
public class ListView extends  ListActivity {

static String item;

public void onCreate(Bundle icicle) {
            super.onCreate(icicle);

            ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, Str.S);
            setListAdapter(adapter);

      } 
```

这是我的列表视图类，它工作得很好，它从一个名为 Str 的类中获取字符串并将它们显示在列表视图中，问题是列表视图样式不好，它是黑色的，字符串是白色的。

我希望它们可以替代每一行都有一种颜色。

我尝试了很多教程，但没有一个足够清楚..我如何为每一行制作替代颜色..例如。第 1 行蓝色，第 2 行白色，第 3 行蓝色，第 4 行白色等。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-10-28T14:51:22.917

[这](http://droidgallery.blogspot.in/2011/07/android-list-view-with-alternating-row.html)是如何做到这一点的。

我的示例代码在这里简要给出：

覆盖`getView`适配器中的方法：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {  
View view = super.getView(position, convertView, parent);  
if (position % 2 == 1) {
    view.setBackgroundColor(Color.BLUE);  
} else {
    view.setBackgroundColor(Color.CYAN);  
}

return view;  
} 
```

在那里覆盖`ArrayAdapter`并覆盖 getView 方法。

因此，如果您的适配器是这样的：

```
public class MyAdapter extends ArrayAdapter 
```

你的`ListActivity`意志改变如下：

```
 ArrayAdapter<String> adapter = new MyAdapter<String>(this,
                android.R.layout.simple_list_item_1, Str.S); 
```

[这是一个](http://www.vogella.com/articles/AndroidListView/article.html#listview_adapterown)关于覆盖 ArrayAdapter 的示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-19T10:43:51.933

```
if (position % 2 == 0) {

    rowView.setBackgroundColor(Color.parseColor("#A4A4A4"));

} else {

    rowView.setBackgroundColor(Color.parseColor("#FFBF00"));

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-17T05:11:33.437

自定义列表视图行的背景颜色可以设置为

```
row.setBackgroundResource(R.color.list_bg_2) 
```

自定义列表视图适配器中的方法

```
getView(int position, View convertView, ViewGroup parent) 
```

我尝试了很多事情，`row.setBackgroundColor(0xFF00DD)`但无法完成，

这里 list_bg_2 是一个颜色集 res/values/color.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="list_bg_1">#ffffff</color>
    <color name="list_bg_2">#fef2e8</color>
</resources> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-11T18:39:24.417

如果视图是 ViewGroup，简单的背景设置不起作用

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {  
    final int rr = (position % 2 == 0) ? R.color.border_end_1 : R.color.black;
    final int cc = getResources().getColor(rr);
    View view = super.getView(position, convertView, parent);  
    walk(view, rr, cc);
    return view;  
}
private void walk(View view, int rr, int cc){
    view.setBackgroundResource(rr);
    ViewGroup group = (ViewGroup)view;
    int nc = group.getChildCount();
    for (int i = 0; i < nc; i++) {
        final View v = group.getChildAt(i);
        if (v instanceof ViewGroup)
            walk(v, rr, cc);
        else
            v.setBackgroundColor(cc);
    }
} 
```

# client-server - 服务器-客户端命名管道缓冲区大小

> ID：13109843
> 
> 赞同：0
> 
> 时间：2012-10-28T14:49:49.657
> 
> 标签：client-server, named-pipes, systems-programming

我编写了一个简单的服务器-客户端程序，其中服务器和客户端使用命名管道进行通信。一切正常，但我有一个简单的问题：在客户端部分，我分配了要发送到服务器的味精方式 char *msg=malloc(sizeof(char)); 然后我使用gets（msg）从用户那里读取它。最后我用write（）函数将消息写入管道。现在在服务器部分，我也用 malloc 分配缓冲区，但我不知道 read() 函数的第三个参数应该是什么......因为我可以从手册页读取的第三个参数中理解是你的字节数想阅读，我假设这是客户端发送的 msg 的 strlen。问题是在阅读之前我无法知道这一点。有没有办法让这项工作，或者我应该基本上使用 MAX_SIZE 作为服务器部分的缓冲区。提前感谢您的时间和帮助。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T03:13:56.480

唯一可能的解决方案是上面评论中的 onon15 中提到的。“在发送缓冲区之前发送缓冲区的长度以期望”。

我写这个作为答案来标记问题已回答。

感谢onon15！

# php - 找不到 Phabricator git 命令

> ID：13109845
> 
> 赞同：1
> 
> 时间：2012-10-28T14:50:40.590
> 
> 标签：php, git, phabricator

我遵循了 Phabricator 安装和配置指南： [http](http://www.phabricator.com/docs/phabricator/article/Installation_Guide.html) ://www.phabricator.com/docs/phabricator/article/Installation_Guide.html http://www.phabricator.com/docs/phabricator/article/Configuration_Guide.html

当我导航到`http://localhost`进行最终设置时，我收到这条消息，说它**找不到 git 命令**（还有警告说“**警告 pcntl 不可用！** ”：

```
PHABRICATOR SETUP

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                This setup mode will guide you through setting up your Phabricator configuration.

>>>  CORE CONFIGURATION  -------------------------------------------------------

 okay  PHP's deprecated 'safe_mode' is disabled.
 okay  'open_basedir' is not set.
[WARN] You have not configured 'security.alternate-file-domain'. This makes your installation vulnerable to attack. Make sure you read the documentation for this parameter and understand the consequences of leaving it unconfigured.
 okay  $PATH is nonempty.
[OKAY] Core configuration OKAY.

>>>  REQUIRED PHP EXTENSIONS  --------------------------------------------------

 okay  Extension 'mysql' installed.
 okay  Extension 'hash' installed.
 okay  Extension 'json' installed.
 okay  Extension 'openssl' installed.
 okay  Extension 'mbstring' installed.
 okay  Extension 'iconv' installed.
 okay  Extension 'curl' installed.
 okay  PHP binary found on the command line.
 okay  PHP is available from the command line.
 okay  'php' is CLI SAPI.
 warn  pcntl is not available!
[WARN] *** WARNING *** pcntl extension not available. You will not be able to run daemons.

>>>  GIT SUBMODULES  -----------------------------------------------------------

EXCEPTION!
exception 'CommandException' with message 'Command '(cd '/Users/piotr/Phabricator/phabricator' && git submodule status)' failed with error #127:
stdout:

stderr:
sh: git: command not found

' in /Users/piotr/Phabricator/libphutil/src/future/exec/ExecFuture.php:334
Stack trace:
#0 /Users/piotr/Phabricator/libphutil/src/future/exec/execx.php(34): ExecFuture->resolvex()
#1 /Users/piotr/Phabricator/phabricator/src/infrastructure/PhabricatorSetup.php(264): execx('(cd %s && git s...', '/Users/piotr/Ph...')
#2 /Users/piotr/Phabricator/phabricator/webroot/index.php(121): PhabricatorSetup::runSetup()
#3 {main} 
```

**我还想提一下，我有 git，我可以从终端毫无问题地运行它。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:00:41.387

查找您的 Web 服务器正在运行的用户，并确定是否`git`包含在该`path`用户的环境变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T10:04:37.257

我已经解决了。

问题在于 PH 中缺少 pcntl 扩展名。我必须从源代码编译它（如此处所述：http: [//blog.lancerushing.com/2011/02/getting-phps-pcntl-working-on-snow.html](http://blog.lancerushing.com/2011/02/getting-phps-pcntl-working-on-snow.html)）。

# c++ - 类 Vector2 最终：shared_ptr 正确与否（更新！）

> ID：13109850
> 
> 赞同：0
> 
> 时间：2012-10-28T14:51:05.803
> 
> 标签：c++, c++11

这样做的原因是我想在使用此类时强制所有对象成为智能指针。因此，我可以保存一些代码，例如

```
class Vector2 final : shared_ptr<Vector2>
{
...
inline shared_ptr<Vector2> getVector2(); //--> inline Vector2 getVector2();
...
inline static float dot(const shared_ptr<Vector2> a, const shared_ptr<Vector2> b); //--> inline static float dot(const Vector2 a, Vector2 b);
} 
```

这是对的吗？如果是，这是最佳做法吗？如果不是，什么是最好的？

==================================================== =================================

也许我用另一个例子

```
class Sprite
{
private:
Vector2* pPosition;
shared_ptr<Vector2> position;

Image* pBackground;
shared_ptr<Image> background;
}; 
```

让我解释一下为什么我需要引用计数。当我更新位置或背景时，我需要在分配新值之前处理删除操作。

这个怎么样

```
inline static shared_ptr<Vector2> add(const Vector2* a, const Vector2* b) 
```

这将返回一个结果，在退出函数之前可能会或可能不会使用该结果。然后如果不使用我需要手动删除。

代码节省意味着 1\. 无需手动删除对象 2\. 无需关心是 shared_ptr 还是 Vector2*。因为我想标准化成为一种类型

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:29:18.543

我觉得你的设计很糟糕。就好像您想要拥有 Java 生命周期之类的东西。

您需要在设计时考虑到关注点分离。

您的函数`dot`不应该关心 Vector2 的生命周期是如何管理的，只需通过引用获取 Vector2 对象，并将它们包装在`std::shared_ptr`s 中，然后在使用前取消引用它们。

同样，您的 Vector2 对象不应该知道如何管理它的生命周期。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T14:56:11.027

我不明白这将如何为您节省任何费用。为什么你的向量需要被引用计数？对于你根本不需要的东西来说，这真的很昂贵，这会使你的代码语义复杂化，只会让读者去 WTF。

问题不在于是否`vector2`应该*是*共享指针，或者是否应该包装在共享指针中。也没有理由这样做。

# android - 通知中的意图数据未通过

> ID：13109852
> 
> 赞同：-1
> 
> 时间：2012-10-28T14:51:15.927
> 
> 标签：android, android-intent

我正在尝试将我的通知意图中的一些数据传递给我的一项活动。但不知何故，该值没有正确填充。

我的通知代码是从哪里调用活动的-

```
Long rowId = intent.getExtras().getLong(TasksDBAdapter.KEY_ROWID);                   
         //  Status bar notification Code Goes here. 

         NotificationManager mgr = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);
         Intent notificationIntent = new Intent(this, ReminderModificationActivity.class);  
         notificationIntent.putExtra(TasksDBAdapter.KEY_ROWID, rowId);  
         Log.i(TAG,"rowId in doReminderWork" + rowId);
         PendingIntent pi = PendingIntent.getActivity(this, 0, notificationIntent,PendingIntent.FLAG_ONE_SHOT); 
```

在这段代码中，Log.i 值给出了正确的 rowId 值，但我在 ReminderModificationActivity.class 中没有得到正确的值。onCreate() 其中有以下代码 -

```
mRowId = savedInstanceState != null ? savedInstanceState.getLong(TasksDBAdapter.KEY_ROWID) : null ;
        registerButtonListenersAndSetDefaultText();
        Log.i(TAG, "mROwId in onCreate ReminderNotification-->" + getIntent().getExtras().getLong("RowId"));
        //code to check what row id have been passed
        if(getIntent() != null) {                                        
            Bundle extras = getIntent().getExtras();                     
            mRowId = extras != null ? extras.getLong("RowId") : -1;    
            // Do stuff with the row id here
            if(mRowId != -1){
                //code if RowId valid

            }
        }
        Log.i(TAG, "mROwId in onCreate ReminderNotification again-->" + mRowId); 
```

在此代码中，即使我从通知代码中发送了值 4，Log.i 也会返回值 0。请告诉我我在哪里犯了错误。让我知道是否需要任何其他详细信息。

谢谢，雷

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:55:47.267

检查您用来获取数据的密钥。当你设置它时，你使用一个常量变量，但是当你得到它时，你使用一个硬编码的字符串。这样做很容易搞砸。

# database - 数据库设计：一张表的不同对象？（无继承）

> ID：13109853
> 
> 赞同：0
> 
> 时间：2012-10-28T14:51:15.867
> 
> 标签：database, object

我有一个我连接的字段列表，例如：field1 + ';' +字段2。这是我关于如何存储这些连接（v1）的解决方案：

```
FieldID | Position  | Prefix  | ConcatenationID

15      |0          |NULL     | 30

28      |1          |;        | 30 
```

但我觉得这个解决方案不是那么优雅。我考虑用这个表（V2）替换它：

```
FieldID | Position  | Separator       | ConcatenationID     | IsSeparator

15      |0          |NULL             |30                   | False

NULL    |1          |;                |30                   | True

28      |2          |NULL             |30                   | False 
```

-V1 具有只存储一个对象（字段）的优点，但无法以清晰的方式表示分隔符。

-V2 具有以清晰的方式表示分隔符的优点，但存储多个对象（字段和字符/字符串）。另外：我讨厌 NULL 列。

两个版本的你们怎么看？

提前感谢您的最终回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:06:39.620

```
Value|Position (CPK) |ConcatenationID (CPK)
15   |0              |30
;    |1              |30
28   |2              |30
;    |3              |30
15   |0              |40
;    |1              |40
4    |2              |40
;    |3              |40 
```

我不知道您的业务情况中字段和分隔符的示意图含义是什么，但我只是得出以下结论。

```
select value
from table
where concatenationId = 30 
order by position; 
```

但是，如果您需要区分字段和分隔符。

```
Value|TypeId|Position (CPK)|ConcatenationID (CPK)
15   |0     |0             |30
;    |1     |1             |30
28   |0     |2             |30
;    |1     |3             |30
15   |0     |0             |40
;    |1     |1             |40
4    |0     |2             |40
;    |1     |3             |40 
```

类型表：

```
TypeId|Type
0     |Field
1     |Separator 
```

SQL：

```
select value, type
from table
left join type
using (typeId)
where concatenationId = 30 
order by position; 
```

# java - 反转字符串中的单词

> ID：13109855
> 
> 赞同：-2
> 
> 时间：2012-10-28T14:51:29.017
> 
> 标签：java, string, stringtokenizer

我通常可以做到这一点，这是非常简单的代码，但我脑子里放了一个屁，我很想弄清楚我的愚蠢。我写这个真的很快就尝试了一个我听说过的新IDE，它应该接受一个输入的字符串并以相反的顺序返回它，但它一直告诉我在某个时候字符串的索引之一[] 没有价值。

```
import java.util.StringTokenizer;  
import java.util.Scanner;  
public class Example {

    /**
     * @param args
     */
    public static void main(String[] args) {

        //set up input
        Scanner input=new Scanner(System.in);
        System.out.println("type something here");
        String sentence=input.nextLine();

        //set up StringTokenizer
        StringTokenizer tokens=new StringTokenizer(sentence);

        //setup for loop
        for(int y=tokens.countTokens()-1; y>=0; y--){
            String[] word={tokens.nextToken()};
            System.out.print(word[y]+" ");
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:55:09.653

错误在这里：`String[] word={tokens.nextToken()}`。您创建一个只有一个元素的数组 - 当前标记。还`countTokens()`返回剩余的令牌。每次`nextToken()`调用后都会更新。

修复它：只需遍历所有标记，将它们放入列表中，然后向后打印列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:13:45.487

不知道为什么你使用它`StringTokenizer`只是为了反转一个`string`.

顺便说一句，你的**for**循环只运行一次，并且`String[]`在 for 循环中只包含一个元素，即 userInput （而不是 userInput 字符数组），看看你是否能找出你的方法出了什么问题......

```
public static void main(String[] args) {

        //set up input
        Scanner input=new Scanner(System.in);
        System.out.println("type something here");
        String sentence=input.nextLine();

        //set up StringTokenizer
        StringTokenizer tokens=new StringTokenizer(sentence);
        String tmpStr = tokens.nextToken();
        int tmp=tmpStr.length();
        for(int y=tmp-1; y>=0; y--){
            char[] word=tmpStr.toCharArray();
            System.out.print(word[y]+ " ");
        }
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T15:00:08.483

问题是 String[] word = {tokens.nextToken()}。

我想你想要一些看起来像这样的东西：

```
 int totalTokens = tokens.countTokens()
 String[] word = new String[totalTokens]

 //setup for loop
 for(int y=totalToken-1; y>=0; y--){
     word[y] = tokens.nextToken();           
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T15:04:07.533

像 next(tokens) 这样调用的方法应该可以工作：

```
 public static void next (StringTokenizer tokens){
    String next = null;
    if (tokens.hasMoreTokens()){
        next = tokens.nextToken();
        next(tokens);
    } 
    if (next != null){
        System.out.println(next);
    }
} 
```

# java - 在 Web 应用程序中处理图像时使用哪种方法

> ID：13109863
> 
> 赞同：-1
> 
> 时间：2012-10-28T14:52:20.267
> 
> 标签：java, database, image, jsp

我正在开发一个 Web 应用程序，使用 JSP 和 Servlet，我正在检索图片作为包含该图片路径的字符串。

```
while(rset.next())
{ %>
     <img src='<%rset.getString(1)%>' />
<%  } 
```

数据库中的表将是这样的。

```
id ---- image_path

1.....images/aaa.png

2.....images/bbb.png 
```

所以我在这里所做的实际上是获取图像的路径，而不是图像本身，图像位于一个名为 images 的文件夹中。

但后来，我发现了另一种将图像实际存储在数据库中的方法。

```
PreparedStatement ps = con.prepareStatement("INSERT INTO pictures VALUES(?,?)");
  File file = new File("C:/apache-tomcat-6.0.16/webapps/CodingDiaryExample/images/5.jpg");
  FileInputStream fs = new FileInputStream(file);
  ps.setInt(1,8);
  ps.setBinaryStream(2,fs,fs.available());
  int i = ps.executeUpdate(); 
```

哪个是最好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:01:14.973

1.  与从数据库中获取相比，从 Web 应用程序获取图像更好。

2.  或者，如果您有更多图像，则存储在 FTP 中并根据 pah 获取。

# ruby-on-rails - Cucumber 不测试任何定义的步骤

> ID：13109865
> 
> 赞同：1
> 
> 时间：2012-10-28T14:52:44.770
> 
> 标签：ruby-on-rails, ruby, cucumber, saas

我只创建了一个功能文件 (AddMovie.feature)，其中包含：

```
Feature: User can manually add movie

Scenario: Add a movie
 Given I am on the RottenPotatoes home page
 When I follow "Add new movie"
 Then I should be on the Create New Movie page
 When I fill in "Title" with "Men In Black"
 And I select "PG-13" from "Rating"
 And I press "Save Changes"
 Then I should be on the RottenPotatoes home page 
 And I should see "Men In Black" 
```

当我执行 cucumber 以使用以下命令对其进行测试时：

```
bundle exec cucumber features/AddMovie.feature 
```

结果我得到了这个：

```
Using the default profile...
Feature:  User can manually add movie

      Scenario:  Add a movie                              # features/AddMovie.feature:3
        Given I am on the RottenPotatoes home page
        When I follow "Add new movie"
        Then I should be on the Create New Movie page
        When I fill in "Title" with "Men In Black"
        And I select "PG-13" from "Rating"
        And I press "Save Changes"
        Then I should be on the RottenPotatoes home page 
        And I should see "Men In Black"

    1 scenario (1 passed)
    0 steps 
```

通常这种情况会失败，因为我没有添加“RottenPotatoes 主页”的路径。如果您阅读最后一行“0 步”，那么黄瓜没有运行任何步骤。

我怎样才能解决这个问题 ？并让黄瓜测试 AddMovie.feature 中定义的步骤？

PS：当我使用命令 cucumber features/Addmovies.feature 我得到这个错误

```
Using the default profile...
You have already activated activesupport 3.2.8, but your Gemfile requires activesupport 3.1.0\. Using bundle exec may solve this. (Gem::LoadError)
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/runtime.rb:31:in `block in setup'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/runtime.rb:17:in `setup'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:107:in `setup'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/setup.rb:7:in `<top (required)>'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
/home/ubuntu/Desktop/hw2_rottenpotatoes/config/boot.rb:6:in `<top (required)>'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'
/home/ubuntu/Desktop/hw2_rottenpotatoes/config/application.rb:1:in `<top (required)>'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'
/home/ubuntu/Desktop/hw2_rottenpotatoes/config/environment.rb:2:in `<top (required)>'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-rails-1.3.0/lib/cucumber/rails.rb:7:in `<top (required)>'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
/home/ubuntu/Desktop/hw2_rottenpotatoes/features/support/env.rb:7:in `<top (required)>'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/rb_support/rb_language.rb:129:in `load'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/rb_support/rb_language.rb:129:in `load_code_file'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:171:in `load_file'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:83:in `block in load_files!'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:82:in `each'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:82:in `load_files!'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:175:in `load_step_definitions'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:40:in `run!'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:43:in `execute!'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:20:in `execute'
/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/bin/cucumber:14:in `<top (required)>'
/usr/local/bin/cucumber:19:in `load'
/usr/local/bin/cucumber:19:in `<main>' 
```

当我添加 Bundle exec 时它消失了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:46:36.623

您是否已初始化数据库并运行“捆绑安装”？没有 bundle exec 的错误是因为您的 bundle 需要与当前安装的不同版本的活动支持。

Rails 鼓励约定优于配置。特征名称的约定是小写的snake_case。

看看你的其他功能。cucumber 似乎以您调用它的方式执行所有功能。目录中的其他内容可能有问题。

有步骤文件吗？他们也可能是你的问题。

此外，Stackoverflow 并不是真正询问家庭作业问题的地方（有一个论坛）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T10:52:38.813

I solve this problem, for your solutions do this

install gem `bundler` latest

```
gem install bundler --no-ri --no-rdoc 
```

and then run `cucumber features/find_movie_with_same_director.feature`

if still that error comes then follow steps that define below links

[Ruby on Rails - error when running cucumber: You have already activated activesupport 3.2.1, but your Gemfile requires activesupport 3.1.0\.](https://stackoverflow.com/questions/9671964/ruby-on-rails-error-when-running-cucumber-you-have-already-activated-activesu)

# python - python: pdf - 设置受密码保护的打印、复制、粘贴选项？

> ID：13109867
> 
> 赞同：4
> 
> 时间：2012-10-28T14:53:01.590
> 
> 标签：python, security, pdf, reportlab

嗨，我正在寻找一个 python 库，它允许我在一些现有的 pdf 上设置受密码保护的打印、复制、粘贴选项

我查看了 reportlab pdfencrypt 模块：这正是我需要的选项，但开源版本受到严格限制 - 甚至不能设置真正的密码，并且许可证不是一个选项（超过 1000 英镑/年） - 这将是数量相对较少（每年处理< 1000 份文档），客户是非营利组织

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-03-15T15:47:53.273

Laaate 回答，但我想开始贡献...

在 pdf.py 文件中，在 encypt() 方法中，更改标志：

```
 # permit everything:
    P = -1 
```

到：

```
 # prevent everything:
    P = -3904 
```

这将阻止除简单查看之外的所有功能。请务必传递**不同**的所有者密码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-07-24T16:41:02.133

你（就像我一样）一定想过 - WTF`"-3904"`来自凯文的[回答](https://stackoverflow.com/a/36016018/7797962)。

请让自己舒服——我有答案）。

我在 PDF 1.6 参考中找到了它。你可以在这里得到它：[https ://www.adobe.com/content/dam/acom/en/devnet/pdf/pdf_reference_archive/PDFReference16.pdf](https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdf_reference_archive/PDFReference16.pdf)

3.5节，第99页：

> 包含一组标志的 32 位整数，指定在以用户访问权限打开文档时应授予哪些访问权限。表 3.20 显示了这些标志的含义。标志字中的位位置从 1（低位）到 32（高位）编号。任何位置的 1 位启用相应的访问权限。哪些位是有意义的，在某些情况下如何解释它们，取决于安全处理程序的修订号（在加密字典的 R 条目中指定）。
> 
> *注意：PDF 整数对象在内部以带符号的二进制补码形式表示。由于加密字典的 P 值中所有保留的高位标志位都必须为 1，因此该值必须指定为负整数。例如，假设安全处理程序的修订版 2，值 -44 允许打印和复制，但不允许修改内容和注释。

所以，`P`是许可！请检查该文档中的表格。`-44`是`11010100`位表示。

我做了这样的（允许打印和复制，但不允许修改内容和注释）：

```
from hashlib import md5

from PyPDF4 import PdfFileReader, PdfFileWriter
from PyPDF4.generic import NameObject, DictionaryObject, ArrayObject, \
    NumberObject, ByteStringObject
from PyPDF4.pdf import _alg33, _alg34, _alg35
from PyPDF4.utils import b_

def encrypt(writer_obj: PdfFileWriter, user_pwd, owner_pwd=None, use_128bit=True):
    """
    Encrypt this PDF file with the PDF Standard encryption handler.

    :param str user_pwd: The "user password", which allows for opening
        and reading the PDF file with the restrictions provided.
    :param str owner_pwd: The "owner password", which allows for
        opening the PDF files without any restrictions.  By default,
        the owner password is the same as the user password.
    :param bool use_128bit: flag as to whether to use 128bit
        encryption.  When false, 40bit encryption will be used.  By default,
        this flag is on.
    """
    import time, random
    if owner_pwd == None:
        owner_pwd = user_pwd
    if use_128bit:
        V = 2
        rev = 3
        keylen = int(128 / 8)
    else:
        V = 1
        rev = 2
        keylen = int(40 / 8)
    # permit copy and printing only:
    P = -44
    O = ByteStringObject(_alg33(owner_pwd, user_pwd, rev, keylen))
    ID_1 = ByteStringObject(md5(b_(repr(time.time()))).digest())
    ID_2 = ByteStringObject(md5(b_(repr(random.random()))).digest())
    writer_obj._ID = ArrayObject((ID_1, ID_2))
    if rev == 2:
        U, key = _alg34(user_pwd, O, P, ID_1)
    else:
        assert rev == 3
        U, key = _alg35(user_pwd, rev, keylen, O, P, ID_1, False)
    encrypt = DictionaryObject()
    encrypt[NameObject("/Filter")] = NameObject("/Standard")
    encrypt[NameObject("/V")] = NumberObject(V)
    if V == 2:
        encrypt[NameObject("/Length")] = NumberObject(keylen * 8)
    encrypt[NameObject("/R")] = NumberObject(rev)
    encrypt[NameObject("/O")] = ByteStringObject(O)
    encrypt[NameObject("/U")] = ByteStringObject(U)
    encrypt[NameObject("/P")] = NumberObject(P)
    writer_obj._encrypt = writer_obj._addObject(encrypt)
    writer_obj._encrypt_key = key

unmeta = PdfFileReader('my_pdf.pdf')

writer = PdfFileWriter()
writer.appendPagesFromReader(unmeta)
encrypt(writer, '1', '123')

with open('my_pdf_encrypted.pdf', 'wb') as fp:
    writer.write(fp) 
```

如果您喜欢我的回答，请投票；）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T14:57:26.797

[PyPDF](http://pybrary.net/pyPdf/)允许[加密](http://pybrary.net/pyPdf/pythondoc-pyPdf.pdf.html#pyPdf.pdf.PdfFileWriter.encrypt-method)PDF 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T14:59:29.777

您是否尝试过 PDF 工具包，命令行界面 ( `pdftk`)？

[http://www.pdflabs.com/docs/pdftk-cli-examples/](http://www.pdflabs.com/docs/pdftk-cli-examples/)

# django - Django - 加入相关表的第一行

> ID：13109869
> 
> 赞同：0
> 
> 时间：2012-10-28T14:53:02.260
> 
> 标签：django, django-models, django-queryset

假设我有表格`Products`和`Images`，其中一个产品可以有许多图像。在为搜索结果页面获取产品列表时，如何将第一个产品图像包含为缩略图？

当还考虑性能时，最好的方法是什么？（查询次数、内存、总时间等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:35:41.197

我相信您会想直接在模板中获取图像。而不是在视图中构建一个列表并将其传递到模板中，因为会有很多项目。

所以我会建议在`Products`模型中实现一个方法来找到第一个图像并返回它的 url。

模型.py

```
def Products(models.Model):
    #your fields

    def get_image_url(self):
        try:
            img = self.images_set.filter()[0] #get first image
            return img.url()
        except Exception:
            return None 
```

在模板中：

```
{% for p in product_list %}
     {# render product and add image #}
     <img href="{{p.get_image_url }}" />
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T16:45:32.627

如果您需要在不进行大量架构改造的情况下提高性能，则反规范化是第一种尝试方法：

```
class Product(models.Model): # instead of Products as convention
    first_image = models.ImageField(editable=False, null=True) 
```

然后通过信号保持更新时间`first_image`。`Product.image_set`

此外，您甚至可以将“weakref”存储在某个转储字段中（在您真正需要时使用它:)

```
class Product(models.Model):
    # from django-jsonfield, store raw values of ImageField of the Images model
    extra = JSONField()
    def first_image(self):
        image = self.extra.get('image')
        return models.ImageField.attr_class(None, models.ImageField(), image) if image else None 
```

其他简单的方法可能包括

*   批量加载第一张图像并在模板循环中使用它们`Product()`。需要标记第一张图像以便于查询。
*   直接存储`first_image`而`Product`不是`Images`. 这适用于没有太多管理要求的简单站点。

# binding - 通用服务定位器库的通用绑定

> ID：13109871
> 
> 赞同：0
> 
> 时间：2012-10-28T14:53:21.527
> 
> 标签：binding, inversion-of-control, unity-container, ioc-container, structuremap

[Common Service Locator Library](http://commonservicelocator.codeplex.com/)是一个好主意，但它让我问“我们也可以让绑定更通用吗？”

当然，具体实现（例如结构图、Unity 等）之间的差异使得不可能有一个完全通用的绑定概念。但是应该可以实现[80/20 规则](http://management.about.com/cs/generalmanagement/a/Pareto081202.htm)。是的？

换句话说，为什么不拥有一套涵盖大多数绑定场景的简单通用绑定呢？也许最简单的普通绑定只需要一个元组：

```
requested type, bound type, life-time-management-enum 
```

以前有人做过类似的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:43:52.617

> 公共服务定位器库是个好主意

CSL 仅作为框架开发人员的抽象，因为非框架应用程序在应用依赖注入模式方面要好得多，这使我们能够完全消除对服务定位器的需求。

> 为什么不拥有一套涵盖大多数绑定场景的简单通用绑定呢？

定义自己的自定义抽象可以做到这一点非常“容易”。然而，问题在于这个 80/20。由于每个容器都存在差异（魔鬼在细节中），这种抽象仅适用于最琐碎的应用程序。对于其他一切，您将不得不回退直接与容器交互，这使得抽象无用。

但这一切都假设从容器切换的问题在于重写基本的“请求类型、绑定类型、生命周期管理枚举”语句，但这是一个错误的假设。更改这些行可以在几分钟内完成（因为您的所有注册码都在一个地方）。然而，从一个容器切换到另一个容器的困难在于，对批量注册、装饰器注册、拦截、生命周期范围、注册-解析-发布等功能的支持差异，以及您的应用程序对特定框架功能的依赖关系.

# ruby-on-rails - 为什么我在提交有错误的表单时丢失了由简单表单创建的单选按钮？

> ID：13109872
> 
> 赞同：0
> 
> 时间：2012-10-28T14:53:21.917
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我有这样的表格：

[![新问题](../Images/489460af434cf0072c096b52b52f535d.png)](https://i.stack.imgur.com/MoL2c.png)

当我提交没有任何内容的表单时，它会显示错误：

[![错误新问题](../Images/eeca23a0372e5781e4d0cb2aca9c07e6.png)](https://i.stack.imgur.com/HUnA3.png)

单选按钮丢失了！

这是在我的表单视图中：

```
<%= simple_form_for @question, defaults: { error: false } do |q| %>

  <legend>Question</legend>
  <%= render "shared/error_messages", object: q.object %>

  <%= q.input :content, input_html: { rows: 3, class: 'span6' } %>
  <%= q.input :mark, input_html: { class: 'span1' } %>
  <%= q.association :topic %>
  <%= q.association :question_type %>

  <%= q.simple_fields_for :answers do |a| %>
    <%= a.input :correct, collection: [[true, 'True'], [false, 'False']],
                                                            as: :radio_buttons,
                                                            label: 'Answer',
                                                            value_method: :first,
                                                            label_method: :last,
                                                            item_wrapper_class: 'inline'
                                                            %>
  <% end %>
<% end %> 
```

我错过了什么或错了什么？`render 'new'`当@question.save 为假时，我在问题控制器的创建操作中使用了。这是我的问题控制器：

```
class QuestionsController < ApplicationController
  def new
    @question = Question.new
    @question.answers.build
  end

  def create
    @question = Question.new(content: params[:question][:content])
    @question.mark = params[:question][:mark]
    @question.topic_id = params[:question][:topic_id]
    @question.question_type_id = params[:question][:question_type_id]
    @question.user_id = current_user.id

    if @question.save
      if params[:question][:answers_attributes]['0'][:correct] == 'true'
        answer = @question.answers.build(content: 'True')
        answer.correct = true
      else
        answer = @question.answers.build(content: 'False')
      end
      if @question.save
        flash[:success] = "Successfully created new question."
        redirect_to root_url
      else
        render 'new'
      end
    else
      render 'new'
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:05:25.647

我猜你正在控制器中的对象上`answer`使用`build_answer`方法（或其他方式）构建一个新的`@question`，可能在`new`方法中。

发生的情况是，当`create`操作失败时，`@question`没有`answers`，并且`simple_fields_for`不会显示任何内容。

如果您需要更多详细信息，请发布您的控制器的代码，我们将尝试找出解决问题的方法。

编辑：您构建问题的方式是错误的，应该是

```
@question = Question.new(params[:question]) 
```

那么您`@question`将得到答案，并且在您看来一切都会正常进行；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T06:23:56.803

在上次渲染“新”上方添加了@question.answers.build，现在可以使用

# iphone - NSURLConnection IOS 3G 问题

> ID：13109874
> 
> 赞同：5
> 
> 时间：2012-10-28T14:53:31.620
> 
> 标签：iphone, nsurlconnection, 3g-network

我在我的应用程序中使用了 NSURLConnection（异步），它在 wifi（iOS5 和 iOS6）上运行良好。但它与 3G 产生了问题。当我运行我的应用程序 3G 连接时，我的 didReceiveData 方法中没有任何数据。

我已将日志放入我的委托方法中，但在使用 3G 时，请求超时。可能是什么问题。

编辑：在服务器端 - >它表明我的请求已发送到服务器&服务器也已将响应发送到客户端。

编辑2：

我写的代码如下。

```
NSURL *url = [NSURL URLWithString:@"someURL"];

NSMutableURLRequest *req = [[NSMutableURLRequest alloc] initWithURL:url     
 cachePolicy:NSURLRequestUseProtocolCachePolicy                                   
 timeoutInterval:40.0];

//[req setHTTPShouldUsePipelining:YES];

[req setValue:@"x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[req setValue:@"someValue" forHTTPHeaderField:@"Accept"];
[req setValue:@"myCrdentails" forHTTPHeaderField:@"Authorization"];
[req setHTTPMethod:@"GET"];

[[NSURLConnection alloc] initWithRequest:req delegate:self startImmediately:YES]; 
```

响应头如下

```
< HTTP/1.1 200 OK
< X-Powered-By: Express
< Access-Control-Allow-Origin: *
< Content-Type: text/event-stream; charset=utf-8
< Connection: keep-alive
< Transfer-Encoding: chunked 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T19:21:57.023

在为这个问题挣扎了几个小时后，我终于找到了一个可行的解决方案。**NSMutableURLRequest**对象有一个方法来设置是否允许蜂窝网络：

```
[req setAllowsCellularAccess:YES]; 
```

尽管**NSURLRequest**类型的对象的默认值似乎是**YES**，但它为我解决了这个问题。

 **希望这会帮助像我这样在这个问题上苦苦挣扎并最终解决这个问题的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-09T12:25:02.910

超过 3g的问题`NSURLConnection`是超时，基本上是你无法控制的，，

如果您正在将数据上传或流式传输到服务器并且该数据在那里处理并且需要超过`NSURLConnection`时间阈值或者连接太慢，则连接将被关闭并返回`NULL`数据..因为连接进入空闲状态......

要克服这样的问题，您需要让 web 服务发送一个空数据包“空格”您将看到`didReceiveData`在每个数据包到达时调用..

空格不会影响`receivedData`.. 在我的情况下，响应是 a`JSON`并且我`JSonKit`用来解析它 ,,...

希望它会帮助某人..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-11T19:17:58.143

这是https吗？我想知道是否可能会发生一些 SSL 验证失败...您是否尝试过从 curl over 3G 查询这个？如果蜂窝运营商代理并且没有为您提供有效数据，或者如果它的 IP 相关（黑名单、封闭端口等），那么您可能会得到不同的响应。我肯定会用 curl 测试。要么来自一部破牢的手机，要么来自被束缚的手机。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T15:14:40.107

尝试使用[可达性](https://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)框架并检查它是否为 3G 返回 false。如果它确实返回 true 并且您仍然得到超时，请尝试转到同步模型并查看会发生什么。可能是连接正常，但有些东西拦截了你的回调。**

# matlab - Matlab：变量一旦声明为全局变量就会自动设置为一个值？

> ID：13109881
> 
> 赞同：2
> 
> 时间：2012-10-28T14:55:04.673
> 
> 标签：matlab

我对 Matlab 中的全局变量有一个非常奇怪的问题。

通常，当您在为其分配任何值之前将变量声明为全局变量时，它将保留为空变量。我有一个变量`R`，我想声明为全局变量。但是在我输入`clear`and之后`global R`，变量列表`R`中已经设置为 1*18 数组，其中填充了一些零和其他数字。

我确实有一些共享全局变量的其他函数和脚本`R`，但我确保在我键入后没有调用任何脚本或函数，并且当我从提示符`clear`键入时变量列表已经为空。`global R`

![在此处输入图像描述](../Images/42e80fd7a0e78430096e62d09c29cd5e.png)

但是，问题仍然存在。我想我一定对全局变量的规则有一些严重的误解。谁能解释为什么会这样？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T15:12:19.457

该`clear`命令不会清除全局变量。它会从您的本地工作区中删除该变量，但它仍然存在。因此，如果您之前为其分配了一些值，再次声明它只是“显示”本地范围内的全局变量。您必须使用`clear all`或`clear global`。从以下[文档](http://www.mathworks.se/help/matlab/ref/clear.html)：`clear`

> 如果变量名称是全局的，则 clear 将其从当前工作区中删除，但仍保留在全局工作区中。

考虑以下示例：

```
>> clear all; 
>> global v;
>> v = 1:100;  % assign global variable
>> whos        % check if it is there

  Name      Size             Bytes  Class     Attributes

  v         1x100              800  double    global    

>> clear;
>> whos       % nothing declared in local workspace
>> global v;
>> whos       % ups, v is not empty!!

  Name      Size             Bytes  Class     Attributes

  v         1x100              800  double    global    

>> clear global;     % you have to clear it properly
>> whos
>> global v          % now it is empty
>> whos
  Name      Size            Bytes  Class     Attributes

  v         0x0                 0  double    global 
```

# c# - 有没有办法将数组的非连续子集公开为单个数组？

> ID：13109882
> 
> 赞同：2
> 
> 时间：2012-10-28T14:55:06.857
> 
> 标签：c#, arrays, multidimensional-array

在我的项目中，我有一个类似于以下的类：

```
public class Vertices
{
    float[] vertexData1;
    int   vertexData1Offset;

    float[] vertexData2;
    int   vertexData2Offset;

    float[] vertexData3;
    int   vertexData3Offset;

    float[] vertexBuffer;

    int vertexCount;
    int vertexStride;

    public void Update()
    {
        for(int i = 0; i < vertexCount; i++)
        {
            vertexBuffer[(i * vertexStride) + vertexData1Offset] = vertexData1[i];
            vertexBuffer[(i * vertexStride) + vertexData2Offset] = vertexData2[i];
            vertexBuffer[(i * vertexStride) + vertexData3Offset] = vertexData3[i];
        }
    }
} 
```

也就是说，我有一个数组（*vertexBuffer*），这个数组是另一组数组（*vertexData1...*）的组合。只有数组组合的方式，每个“组件数组”的元素都均匀分布在“主数组”中，所有元素都混杂在一起，而不是每个数组按顺序连接。

**我想知道是否有一种方法可以公开这些数组（例如，以某种方式继承数组）（*vertexData1...*），以便此类的使用者可以访问它们，就好像它们是具有连续元素的常规数组一样**（包括相互复制），但在幕后，对象实际上会在整个*vertexBuffer*中分布这些元素，从而不再需要 Update() 方法和重复数据。

**这在 C# 中可能吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:03:42.850

是的，您可以使用索引器。就像是：

```
public class Vertices
{
    float[] vertexData1;
    int   vertexData1Offset;

    float[] vertexData2;
    int   vertexData2Offset;

    float[] vertexData3;
    int   vertexData3Offset;

    private float[] GetArrayForIndex(int index) {
      switch (index / vertexStride) {
        case 0: return verdexData1;
        case 1: return vertedData2;
        case 2: return vertexData3;
        default: throw new IndexOutOfRangeException();
      }
    }

    public float vertexBuffer[int index] {
      get {
        return GetArrayForIndex(index)[index % vertexStride];
      }
      set {
        GetArrayForIndex(index)[index % vertexStride] = value;
      }
    }

    int vertexStride;

} 
```

我不确定您要如何排列索引器中的数据。您可能想要交换 和 的使用，`/`具体`%`取决于您是否希望阵列彼此接连或交错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:08:14.157

您可以实现 indexer this[int index] 并在其中提供您自己的功能：

```
public class Vertices
{
  public float this[int index]
  {
    get
    {
      // do your stuff here
    }
    set
    {
      // do your stuff here
    }
  }
} 
```

# algorithm - 对仅包含 az 和空格的单词数组进行排序的最快方法是什么？

> ID：13109889
> 
> 赞同：5
> 
> 时间：2012-10-28T14:57:01.740
> 
> 标签：algorithm, sorting

我想知道是否有比快速排序/合并排序更快的方法来对此类数组进行排序。

数组的最大长度为 10^6。单词的长度是 >=10 和 <= 100，并且单词可以包含 az 和空格（总共 27 个不同的字符）。字符在单词中不是唯一的（它们可以重复）。数组中的所有单词都一样长。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T14:59:31.277

您可以将所有单词放在[trie](http://en.wikipedia.org/wiki/Trie)（或[radix tree](http://en.wikipedia.org/wiki/Radix_tree)）中，然后按[DFS](http://en.wikipedia.org/wiki/Depth-first_search)顺序打印，从 DFS 中每个级别的“较小”词典字母开始。

该解决方案将是平均字符串长度在`O(n* |S|)`哪里。`|S|`

**简单的例子：**

设字符串集为`[ac,ab,aca]`：

结果尝试将是：

```
 a
       /  \
      /    \
     b      c
     |     / \
     $    $   a
              |
              $ 
```

还有一个 DFS（它更喜欢字典上较小的字符）：DFS 将从 开始`a`，转到`b`，然后到结束符号 ( `$`) 并且将首先打印`ab`，然后返回到`a`，然后返回到 ，`c`然后到下一个`$`符号，并且将print `ac`, and next to `a`and its `$`and will print `aca`，导致打印：

```
ab
ac
aca 
```

如前所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:18:43.647

任何基于比较的排序的下限是 O(nlog(n))。您不能有任何基于在低于此限制的最坏情况下运行的元素相互比较的排序算法。

归并排序和堆排序的最坏情况运行时间都是 O(nlog(n))... 快速排序的最坏情况运行时间是 O(n^2)，但平均运行时间是 O(n^日志（n））。

值得一提的是，尽管快速排序的最差运行时间为 O(N^2)，但由于常数因子较小，它有时会以 O(nlog(n)) 的运行时间击败其他算法（如堆排序），并且适合在当前机器架构上高效执行。

线性排序算法，允许在非比较基础上在线性时间 O(n) 内对整数（但不仅限于整数）进行排序（示例：计数排序、桶排序和基数排序）

MSD 基数排序可以使用数字（在本例中为字符）的字典顺序并从左到右对字符串进行排序。

它首先使用另一种线性排序算法（例如桶排序）使用最左边的字符对所有字符串进行排序，然后使用从左起第二个字符再次对它们进行排序，依此类推，直到它们按最右边的字符排序。最后，数组将被完全排序。

该算法的运行时间为 O(k*N)，其中 N 是元素的数量，k 是平均密钥长度（在这种情况下，字长将 >=10 && <=100）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T16:15:23.330

好吧，我已经阅读（并赞成）关于基数排序和基数特里的答案，非常有用。
但。
在基数排序的情况下 - 您需要对 N 元素进行 91 次传递，因此它将是**91 * N**。我不是在谈论额外的空间。
在合并排序的情况下，您有**N * log N**比较，并且由于 log N = log 1000000 ~ 20 您有**20 * N**比较。

那么哪个更快呢？:) 或者我可能在某个地方弄错了？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T15:04:35.613

可以计算 ascii 值，因此本质上这是一个整数排序。基于比较的排序例程充其量只会为您提供 O(n lg n) - 合并排序（需要额外的空间来创建另外两个大小为 n/2 的数组）或在最坏的情况下为 O(n^2)（插入排序、快速排序，但它们没有额外的空间复杂度）。这些比线性排序算法渐近地慢。我建议查看 CLRS（[http://www.amazon.com/Introduction-Algorithms-Thomas-H-Cormen/dp/0262033844](https://rads.stackoverflow.com/amzn/click/com/0262033844)）。关于线性时间排序的章节。在这种情况下，O(n) 可能是您可以做的最好的事情。此外，这篇文章可能会有所帮助。[线性时间排序？](https://stackoverflow.com/questions/749585/sorting-in-linear-time)

我会检查基数排序。[http://en.wikipedia.org/wiki/Radix_sort](http://en.wikipedia.org/wiki/Radix_sort)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-14T14:53:27.827

为什么不按三个字符进行分布排序：那将需要 19683 (27*27*27) 个元素的计数存储，这应该是可行的，然后最多需要 34 遍。

但是很快，每个键的子列表（三个字符的倍数）将足够短，可以对字符串的其余部分使用插入排序或类似的方法。1.000.000/(27^3) 约为 50

如果它们具有共同的长前缀，则相同的机制可以用于更长的键，即前 30 个字符会将列表划分为仅 20 或 30 个子列表。然后，您不会将键表示为数字，而是表示为字符串，并将它们存储在字典中，这样速度较慢，但​​所需的传递次数更少，内存也可能更少。此外，它还需要 N*log(M) 查找，其中 M 是二叉树中不同键的数量，但散列也是一种可能。

# c# - C++ 中的动作类？（相当于 C#）

> ID：13109890
> 
> 赞同：2
> 
> 时间：2012-10-28T14:57:17.463
> 
> 标签：c#, c++, delegates, lambda, action

在我的 C# 游戏引擎中，我曾经通过向管理器对象添加/删除动作来处理有序绘图，该管理器对象按优先级对动作进行排序，然后执行它们。

这是一个非常简化的示例：

```
class DrawManager
{
    public List<Tuple<Action, int>> DrawActions = new List<Tuple<Action, int>>();
    void Draw() { foreach (var tuple in DrawActions) tuple.Item1(); }
}

class Example
{
    DrawManager manager;

    Example()
    {
        manager.DrawActions.Add(new Tuple<Action, int>(DrawBackground, 0));
        manager.DrawActions.Add(new Tuple<Action, int>(DrawForeground, 100));
    }
    ~Example()
    {
        manager.DrawActions.Remove(manager.DrawActions.Find(x => x.Item1 == DrawBackground));
        manager.DrawActions.Remove(manager.DrawActions.Find(x => x.Item1 == DrawForeground));
    }

    void DrawBackground() { /* draw something */ }
    void DrawForeground() { /* draw something */ }
} 
```

通过添加一些辅助方法，代码变得非常优雅并且易于在我的引擎中使用。

我最近转向 C++，但找不到任何简单的方法来实现相同的结果。

我尝试使用 std::function，但是为了删除对象销毁的方法，我不得不将 draw 方法存储在调用者拥有的指针中，然后将其包装到 lambda 中并传入。非常不雅且耗时.

有没有办法获得类似于 C# 示例中显示的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T15:20:32.543

您可以使用`std::function`代替`Action`：

```
typedef std::function<void()> Action;
std::vector<std::pair<Action, int> > DrawActions;
void Draw() {
    for_each(DrawActions.begin(), DrawActions.end(), [](std::pair<Action, int>& a) {
       a.first(); 
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T14:11:13.863

其他一些不使用 std::function 的想法，它使用 std::set 并且您为要执行的每个操作创建一个类。想法是动作类是在使用它们的类的 cpp 文件中定义的（不是在头文件中，除非它们是共享的），它们是完全隐藏的。

首先定义*Action*类，它有一个纯虚拟*执行*、一个优先级和一个指向某个所有者的指针。这个想法是不创建其他类、元组，而是使用*Action*类来存储这些值：

```
class Action
{
public:
    Action(const int priority, void * owner) : priority(priority), owner(owner) {}
    virtual ~Action() {}

    virtual void execute() = 0;

    struct PrioritySorter
    {
        bool operator()(Action* a, Action* b)
        {
            return a->priority < b->priority;
        }
    };

    bool ownerIs(void * owner) const { return this->owner == owner; }

private:
    const int priority;
    void * owner;
}; 
```

然后创建一些动作：

```
class DrawBackgroundAction : public Action
{
public:
    DrawBackgroundAction(const int priority, void * owner) : Action(priority, owner) {}

    void execute()
    {
        cout << "drawing background" << endl;
    }
};

class DrawForegroundAction : public Action
{
public:
    DrawForegroundAction(const int priority, void * owner) : Action(priority, owner) {}

    void execute()
    {
        cout << "drawing foreground!!!" << endl;
    }
};

class DrawSomethingElseAction : public Action
{
public:
    DrawSomethingElseAction(const int priority, void * owner) : Action(priority, owner) {}

    void execute()
    {
        cout << "drawing something else" << endl;
    }
}; 
```

*DrawManager*负责将动作存储在按优先级排序的集合中，如果要删除“拥有的”动作（其他类），您可以这样做。

```
class DrawManager
{
public:
    DrawManager() {}
    ~DrawManager()
    {
        for ( ActionList::iterator i = actions.begin(), e = actions.end(); i != e; i++ )
        {
            delete *i;
        }
        actions.clear();
    }

    void draw()
    {
        for ( ActionList::iterator i = actions.begin(), e = actions.end(); i != e; i++ )
        {
            (*i)->execute();
        }
    }

    void addAction(Action* action)
    {
        actions.insert(action);
    }

    void removeOwnedActions(void * owner)
    {
        for ( ActionList::iterator i = actions.begin(), e = actions.end(); i != e; i++)
        {
            if ( (*i)->ownerIs(owner) )
            {
                delete *i;
                actions.erase(i);
            }
        }
    }

private:
    typedef std::set<Action*,Action::PrioritySorter> ActionList;
    ActionList actions;
}; 
```

现在示例类：

```
class Example
{
public:
    Example()
    {
        manager.addAction(new DrawForegroundAction(100,this));
        manager.addAction(new DrawBackgroundAction(0,this));
        manager.addAction(new DrawSomethingElseAction(50,this));
    }

    void drawAll()
    {
        manager.draw();
    }

    void removeTheActionsIfYouWant()
    {
        manager.removeOwnedActions(this);
    }

private:
    DrawManager manager;
}; 
```

和测试：

```
int main()
{
    Example ex;

    cout << "Drawing all" << endl;

    ex.drawAll();

    ex.removeTheActionsIfYouWant();

    cout << "Drawing again" << endl;

    ex.drawAll();

    return 0;
} 
```

# google-app-engine - Google Appe Engine NDB 跨域

> ID：13109896
> 
> 赞同：0
> 
> 时间：2012-10-28T14:57:54.237
> 
> 标签：google-app-engine

是否可以有 2 个不同的域共享一个/相同的 NDB？

例子：

在[http://mydomain1.appspot.com](http://mydomain1.appspot.com)

```
r = MyData("myid"="say","words"="hello world!")
r.put() 
```

在其他站点，在[http://mydomain2.appspot.com](http://mydomain2.appspot.com)

```
q = MyData.query(MyData.myid == "say")
r = q.get()
self.response.out.write(r.words)
>>> output: hello world! 
```

可能吗？有例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T15:14:11.437

两个应用程序（GAE appid）不能共享同一个数据存储。

但是像 www.example1.com 和 www.example2.com 这样的两个域可以指向同一个应用程序。您可以使用通配符子域：http: [//googleappengine.blogspot.nl/2009/08/new-features-in-124.html](http://googleappengine.blogspot.nl/2009/08/new-features-in-124.html)

# html - 如何设置 Servlet Path 使 HTML 正确调用 servlet 文件？

> ID：13109898
> 
> 赞同：0
> 
> 时间：2012-10-28T14:58:14.460
> 
> 标签：html, eclipse, tomcat, servlets

***我的目标***：访问 .htm 文件，并将用户输入传递给调用的 servlet 并显示内容。

我做了什么：我使用 eclipse Juno 创建了一个动态项目：ServeletTest。项目结构如下：

![在此处输入图像描述](../Images/9b430d96ed92353e91e195c3ee5a7a85.png)

servlet 文件为 MyServlet.java，相关代码为：

```
package ylai.Servlet.test;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.PrintWriter;
/**
 * Servlet implementation class MyServlet
 */
@WebServlet(description = "test servlet", urlPatterns = { "/MyServlet" })
public class MyServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public MyServlet() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
        String info = request.getParameter("info") ;    
        PrintWriter out = response.getWriter() ;
        out.println("<html>") ;
        out.println("<head><title>Hello Servlet</title></head>") ;
        out.println("<body>") ;
        out.println("<h1>" + info + "</h1>") ;
        out.println("</body>") ;
        out.println("</html>") ;
        out.close() ;

    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
           this.doGet(request, response);
    }

} 
```

html 文件是 input.htm 。详细代码是：

```
<html>
<head><title>This is html file</title></head>
<body>
<form action="myservlet" method="post">
    Type something：&lt;input type="text" name="info">
    <input type="submit" value="submit">
</form>
</body>
</html> 
```

web.xml 定义为：

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
   version="2.5">

  <display-name>Welcome to Tomcat</display-name>
  <description>
     Welcome to Tomcat
  </description>    
    <servlet>
        <servlet-name>myservlet</servlet-name>
        <servlet-class>ylai.Servlet.test.MyServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>myservlet</servlet-name>
        <url-pattern>/myservlet</url-pattern>
    </servlet-mapping>  
    </web-app> 
```

当我在 Eclipse 中使用内置 Tomcat 运行 input.htm 时，它工作正常，并且 input.htm 中的输入内容可以通过 MyServlet.java 显示。屏幕截图如下：

![在此处输入图像描述](../Images/a07e634c6341d37c88c9eb149a51fd13.png)

![在此处输入图像描述](../Images/80b0d6a362eb3170f2a58d2cda2cf04e.png)

它似乎工作正常。

***我的问题***：

如果我想将 web.xml 中的值修改为

```
 <servlet-mapping>
        <servlet-name>myservlet</servlet-name>
        <url-pattern>/myservletURL</url-pattern>
    </servlet-mapping> 
```

我所期望的是，一旦 input.htm 被提交，它将调用 serlvet 并且网页地址应该是：

```
http://localhost:8080/ServeletTest/myservletURL 
```

但是显示页面地址仍然是，没有改变：

`http://localhost:8080/ServeletTest/myservlet` HTTP 状态 404 错误。

看起来很奇怪！！！机制应该是：当我提交input.htm页面时，它将通过web.xml中的servlet-name调用servlet。在这种情况下，servlet-name 是 myservlet。Tomcat 将使用 servlet-name 找到 servlet 文件的实际位置：MyServlet.java 并执行它。重定向页面地址将取决于您在 . 在这种情况下，它应该 /ServeletTest/myservletURL 但现在。无法调用 Servlet 文件，并且页面地址不是我所期望的。

我对 servlet 调用机制或其他有错误的理解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T03:52:15.250

如果您将**url-pattern**更改为 myservletURL，您还需要更新表单**操作**以定位此新 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:16:35.423

```
LifeCycleServlet--@WebServlet("/LifeCycleServlet")
MyServlet--@WebServlet(description = "test servlet", urlPatterns = { "/MyServlet" }) 
```

删除这些行，因为在这里您将 url 提到为 MyServlet

或者

也改变这个 urlpattern { "/MyServlet" }

# c - connect() 失败后套接字是否变得不可用？

> ID：13109899
> 
> 赞同：8
> 
> 时间：2012-10-28T14:58:15.917
> 
> 标签：c, linux, networking, tcp

在 Steven 的“The Socket: Networking API, Third Edition”的第 4 章第 4.3 段中，作者陈述如下

```
"If connect fails, the socket is no longer usable and must be closed. 
 We cannot call connect again on the socket." 
```

有谁知道上述声明背后的原因？

在我自己的实验中，我编写了一个简单的 tcp 客户端，它将运行在主机 A 和一个简单的 tcp 服务器，它将运行在主机 B。tcp 客户端将尝试永远连接到主机 B 上的 tcp 服务器。

所以，我在主机 B 上启动了服务器。从主机上拔下网线。然后我在主机 A 上启动客户端。在同一个套接字上进行了大约 9 次不成功的连接尝试后，我只需将网络线插回服务器主机。客户端连接成功并愉快地以 80K/秒的速度发送消息。

在另一个实验中，我从服务器主机上拔了线，在最初的成功连接和几百万条消息交换之后。然后，几分钟后，我连接了电线，消息流在同一个套接字上恢复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T15:08:54.677

POSIX 2001在信息部分中[说：](http://pubs.opengroup.org/onlinepubs/009695399/functions/connect.html#tag_03_85_07)

> 如果`connect()`失败，则未指定套接字的状态。符合要求的应用程序应在尝试重新连接之前关闭文件描述符并创建新套接字。

因此，您引用的段落与此规范一致。它在您的机器上工作的事实并不意味着您的程序是可移植的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T15:06:39.537

这可能植根于[connect 的联机帮助页](http://linux.die.net/man/2/connect)，其中说：

> 一般来说，基于连接的协议套接字可能`connect()`只成功一次；无连接协议套接字可能会使用 `connect()` 多次来更改它们的关联。

这意味着您不能只重新连接基于连接的（读取，TCP）套接字。但是，我看不到它`connect()`表明我们无法回收 FD 的失败。

如果连接中断，恢复连接是 TCP 的一个特性，它通常会尝试这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T17:56:17.140

要回答您的具体问题...

很简单，那里有大量的 TCP 实现。虽然有些人可能支持`connect()`在一次失败后进行另一次呼叫，但其他人将拥有状态信息，这会使这样做不可靠。

为了安全起见，必须进行某种`reset()`操作以将套接字返回到原始状态。由于这不包括在最初的（或任何后续的）TCP 实现中，剩下的唯一选择是关闭并重新打开。

因此，POSIX 标准（以及您的书，可能使用 POSIX 标准作为参考）告诉您完全这样做，以便能够与所有支持 TCP/IP 的操作系统一起工作。否则会导致一些现有实现无效。

此外，新的实现可以自由地简化它们的实现，不必担心在尝试失败后启动新连接；这导致更少的代码和更少的错误潜入的机会。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T15:04:21.387

您确定您使用*的是相同的套接字*，而不是您尝试连接到与以前相同的地址的*新套接字吗？*

即使这是您正在做的事情，您正在试验的特定操作系统允许重用无法连接的套接字这一事实并不意味着所有其他实现套接字 API（或更早/更高版本）的操作系统相同的操作系统）将同样宽松，因此您可能会产生微妙的不可移植代码。

当你做 API 合约没有承诺你会工作的事情时，通常不知道会发生什么。一种可能的反应是它*似乎可以工作——直到付费客户试图在**他的*机器上运行你的代码。

`close(socket); socket=socket(...);`在相当罕见的错误情况下，这种风险真的值得付出代价吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-10T22:02:49.270

套接字在 macOS Sierra 上的 Python 2 中确实变得不可用

```
$ python
>>> import socket
>>> s = socket.socket()
>>> s.connect(('127.0.0.1', 8888))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 228, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 61] Connection refused

>>> s.connect(('127.0.0.1', 8888))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 228, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 22] Invalid argument 
```

```
>>> s.close()
>>> s.connect(('127.0.0.1', 8888))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 228, in meth
    return getattr(self._sock,name)(*args)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 174, in _dummy
    raise error(EBADF, 'Bad file descriptor')
socket.error: [Errno 9] Bad file descriptor 
```

例如，如果您通过循环连接到服务器来等待服务器启动，就会出现这种情况。在这种情况下，在 macOS 上，您不能重用单个套接字来执行此操作。

# objective-c - 将公历月份和日期名称更改为伊斯兰？NSD日期

> ID：13109905
> 
> 赞同：8
> 
> 时间：2012-10-28T14:59:13.473
> 
> 标签：objective-c, nsdate, nsdateformatter, nscalendar

我正在尝试显示伊斯兰当前`day`名称，`month`名称。我使用 NSLocale 将区域设置为`ar_SA`，但它只是将日期和月份名称从英语翻译成阿拉伯语。

我得到的阿拉伯语输出：

`١٢ الأحد ، اكتوبر ، ٢٠١٢` 英文是`Sunday, October 28, 2012`

我想要的输出：

`Al-Ahad, Dul-Hijja 12, 1433`

片段：

```
NSDateFormatter *islamicFormatter = [[NSDateFormatter alloc]init];
[islamicFormatter setDateStyle:NSDateFormatterFullStyle];
[islamicFormatter setLocale:[[NSLocale alloc]initWithLocaleIdentifier:@"ar_SA"]];
NSString *islamicDateString = [islamicFormatter stringFromDate:islamicDate];
NSLog(@"%@",islamicDateString); 
```

我希望你们清楚。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T15:19:40.233

我认为这会有所帮助

```
NSCalendar * hijri = [[NSCalendar alloc] initWithCalendarIdentifier:NSIslamicCalendar];

NSDateFormatter * formatter = [[NSDateFormatter alloc] init];
[formatter setDateStyle:NSDateFormatterLongStyle];
[formatter setTimeStyle:NSDateFormatterNoStyle];
[formatter setCalendar:hijri];

NSLog(@"hijri: %@", [formatter stringFromDate:[NSDate date]]);
[formatter release]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-15T03:26:34.487

我知道这篇文章已经很老了，但我认为有必要添加如下 Swift 3 代码以供其他参考。

```
let hijri = Calendar(identifier: .islamic)

let formatter = DateFormatter()
formatter.calendar = hijri
formatter.dateFormat = "d MMMM yyyy"

let today = Date()
let dateString = formatter.string(from: today)

print(dateString)

// the output: 16 Jamada II 1438 
```

# php - 为需要登录才能查看任何内容的网站制作搜索引擎爬虫的站点地图

> ID：13109910
> 
> 赞同：0
> 
> 时间：2012-10-28T14:59:43.183
> 
> 标签：php, seo, sitemap

我有一个 php mysql 网站，它要求用户在第一页（主页）注册，然后只有他们可以浏览网站的内容。如果用户未登录，每个页面都会生成一个登录表单，并且只有在登录时才会显示内容。唯一可以注册的 IP 是我大学无线网络的 IP。

所以我需要有一个站点地图或其他方式，以便爬虫（每个搜索引擎的）可以查看需要登录的网站的内容。 **请仅发布已接受或符合道德的方式。**

我目前没有在我的网站内进行搜索，因此用户将无法通过它找到内容，因此我希望他们使用“搜索文本 mydomain.com”轻松通过搜索引擎。

我读了 [这个stackoverflow问题](https://stackoverflow.com/questions/5125548/can-search-engines-bots-crawl-pages-requiring-login)，但找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T03:59:41.673

也许谷歌自定义/网站/企业搜索是一个选项：

[http://www.google.com/enterprise/search/products_gss.html](http://www.google.com/enterprise/search/products_gss.html)

它可以访问受保护的内容：

[http://support.google.com/gsa/bin/answer.py?hl=en&answer=15855](http://support.google.com/gsa/bin/answer.py?hl=en&answer=15855)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:34:16.907

内容仅对授权用户可见，不应对其他人可见，包括搜索引擎。

如果您想让您的用户搜索您的网站，您应该在您的用户区域中添加搜索功能。这与 Goodle 或任何其他搜索引擎无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T15:18:35.180

我相信您指的是内部网。为仅对某些用户可见的域创建 XML 站点地图、元标记或 robots.txt 文件是完全多余的。你根本不需要。如果他们有登录帐户，他们必须知道该站点存在。

这就像给你想象中的朋友一个名字。;)

# php - 类设计原则 PHP MongoDB

> ID：13109917
> 
> 赞同：0
> 
> 时间：2012-10-28T15:00:23.093
> 
> 标签：php, oop, mongodb

我正在开发一个 API。去年从一个概念开始，从那时起一直在发展。在这一年中，课程结构和课程发生了很大变化，我发现更新我的课程结构很头疼。诚然，我开始为 PHP 和 MongoDB 设计这个新东西，对 Web 编程和服务器获取和发送数据和数据库的概念也很新。我现在对两者如何协同工作有了相当的了解，但我相信我最初的类设计方法是错误的。好吧，我想没有错，但没有设计得像它应该的那样。

目前，我有4个主要课程。我们将它们称为 A、B、C 和 D
类。现在，A、B 和 C 类都是表示存储在 3 个单独的 MongoDB 集合中的文档的对象。D 类代表一个怪物类，它处理其他三个对象之间的交互。我觉得让对象修改其中的其他对象是错误的。

对象 A、B 和 C 在它们的 __construct() 函数中都有到 MongoDB 的连接。这是一个正确的方法吗？让对象自己处理与数据库的连接是一种好习惯吗？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:07:19.430

这通常是一个坏主意，除非您有一个池连接管理器，对象从中获取它们的连接。连接设置很昂贵，并且您的连接插槽数量有限。

一般来说，您需要每个线程一个连接，然后使用哪些对象。这可能会根据您的应用程序的需要而有所不同，但至少要使用一个连接池，而不是每个实例一个连接。

# java - 让java程序的一部分等待......而不是整个程序

> ID：13109929
> 
> 赞同：0
> 
> 时间：2012-10-28T15:02:04.953
> 
> 标签：java, multithreading

我有一个鲜花游戏，应该在预定的时间送花。我有一个级别类，而 level1() 是一种方法。在我使用的 level1 方法中......

```
Thread.wait(10000); 
```

但它使整个程序等到它达到那个标记。我希望程序加载然后等待。我也试过...

```
public static void waiting(int n) {        
    long t0, t1;

    t0 = System.currentTimeMillis();

    do{
        t1 = System.currentTimeMillis();
    }
    while (t1 - t0 < n);
} 
```

但这也没有任何区别。有一个更好的方法吗？这是方法代码...

```
 package net.blockydigital;

    public class Level {
        RedFlower rf;
        PinkFlower pf;
        WhiteFlower wf;
        YellowFlower yf;
        public Level(){
            rf = new RedFlower();
            pf = new PinkFlower();
            wf = new WhiteFlower();
            yf = new YellowFlower();
        }
        public void level1(){
            try{
            Thread.sleep(10000);
            }catch(Exception e){
                e.printStackTrace();
            }
            rf.dropFlower();
        }
     } 
```

然后这就是我调用代码的地方......

```
 public PlayGame(){
    sc = new ShoppingCart();
    pf = new PinkFlower();
    rf = new RedFlower();
    wf = new WhiteFlower();
    yf = new YellowFlower();
    s = new Shoes();
    l = new Level();
    addKeyListener(new AL());
    setFocusable(true);
    setBackground(Color.WHITE);
    clock = new Timer(5, this);
    clock.start();
    l.level1();
} 
```

我希望添加此代码有帮助！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:20:46.297

我没有 Java 经验，但您应该简单地在主线程之外的另一个线程中调用 level1 方法。这样程序运行并且 thread.sleep 只存在于 level1 方法。

# maven - 如何在多模块项目中列出 mvn 中所有激活的配置文件

> ID：13109930
> 
> 赞同：27
> 
> 时间：2012-10-28T15:02:11.323
> 
> 标签：maven, maven-profiles

mvn help:active-profiles 仅列出在您调用它的项目+系统设置中激活的配置文件。

它没有列出已从父 pom 启用/激活的配置文件。

有什么方法可以通过试错法以外的其他方式实际查看已激活配置文件的完整列表，以查看哪些属性已启用或未启用？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-09-16T16:38:36.910

另一个选项是`mvn help:all-profiles`，它还列出继承的配置文件。

> 显示当前项目下的可用配置文件列表。 **注意**：它将列出项目的所有配置文件。如果配置文件出现状态为非活动状态，则可能需要设置配置文件激活开关/属性。

[Maven 帮助插件页面](http://maven.apache.org/plugins/maven-help-plugin/all-profiles-mojo.html "maven-help-plugin/all-profiles-mojo")中的更多详细信息

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-29T10:06:56.773

`mvn help:active-profiles`我仔细检查了这一点，实际上，在调用时没有列出继承的配置文件。这是`maven-help-plugin`2.1.1 版本。

甚至还有一个关于此的错误报告：[MPH-79](http://jira.codehaus.org/browse/MPH-79)。

作为一种解决方法，您可以使用旧版本：

```
mvn org.apache.maven.plugins:maven-help-plugin:2.0.2:active-profiles ... 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-05-01T08:22:38.127

您是否总是想在构建日志中查看活动配置文件？然后您可以将以下插件配置添加到 <build> 部分。

在此示例中，我将插件添加到“编译”阶段。它可以很容易地添加到不同的阶段。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-help-plugin</artifactId>
  <version>3.0.1</version>
  <executions>
    <execution>
      <id>show-profiles</id>
      <phase>compile</phase>
      <goals>
        <goal>active-profiles</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-07T19:23:20.653

这适用于 Maven 3.x `mvn help:active-profiles`

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-07-20T11:28:59.870

```
mvn help:effective-profiles 
```

用于列出活动配置文件

# iphone - Core Plot ScatterPlot y 轴不缩放以适合屏幕和绘图

> ID：13109932
> 
> 赞同：2
> 
> 时间：2012-10-28T15:02:32.073
> 
> 标签：iphone, ios, core-plot

我一直在为我的应用程序制作一组图表，并且 ScatterPlot 有一个非常具体的问题。我无法让图形的 y 轴或高度重新缩放以适应屏幕。我花了几个小时在网上搜索答案，而我最接近的是遵循 raywenderlich.com 教程。但我似乎仍然无法压缩 y 轴以使图形适合屏幕。

理想情况下，我希望图表根据输入数据动态调整大小，因为绘制的数据差异可能从几十到几百不等。

这是我用来设置图表的代码：

```
-(void)configureAxes{
     // 1 - Create styles
    CPTMutableTextStyle *axisTitleStyle = [CPTMutableTextStyle textStyle];
    axisTitleStyle.color = [CPTColor whiteColor];
    axisTitleStyle.fontName = @"Helvetica-Bold";
    axisTitleStyle.fontSize = 12.0f;
    CPTMutableLineStyle *axisLineStyle = [CPTMutableLineStyle lineStyle];
    axisLineStyle.lineWidth = 2.0f;
    axisLineStyle.lineColor = [CPTColor whiteColor];
    CPTMutableTextStyle *axisTextStyle = [[CPTMutableTextStyle alloc] init];
    axisTextStyle.color = [CPTColor whiteColor];
    axisTextStyle.fontName = @"Helvetica-Bold";
    axisTextStyle.fontSize = 11.0f;
    CPTMutableLineStyle *tickLineStyle = [CPTMutableLineStyle lineStyle];
    tickLineStyle.lineColor = [CPTColor whiteColor];
    tickLineStyle.lineWidth = 2.0f;
    CPTMutableLineStyle *gridLineStyle = [CPTMutableLineStyle lineStyle];
    tickLineStyle.lineColor = [CPTColor blackColor];
    tickLineStyle.lineWidth = 1.0f;
    // 2 - Get axis set
    CPTXYAxisSet *axisSet = (CPTXYAxisSet *) self.hostView.hostedGraph.axisSet;
    // 3 - Configure x-axis
    CPTAxis *x = axisSet.xAxis;
    x.title = @"Date";
    x.titleTextStyle = axisTitleStyle;
    x.titleOffset = 15.0f;
    x.axisLineStyle = axisLineStyle;
    x.labelingPolicy = CPTAxisLabelingPolicyNone;
    x.labelTextStyle = axisTextStyle;
    x.majorTickLineStyle = axisLineStyle;
    x.majorTickLength = 4.0f;
    x.tickDirection = CPTSignNegative;

    //This next line gets the number of records in the array for the date axes
    CGFloat dateCount = [timesTest count];
    NSMutableSet *xLabels = [NSMutableSet setWithCapacity:dateCount];
    NSMutableSet *xLocations = [NSMutableSet setWithCapacity:dateCount];

    //Now we build an array of dates to label the axes
    NSInteger i = 0;
    //for (NSString *date in [[CPDStockPriceStore sharedInstance] datesInMonth]) {
    for (NSString *date in datesTest) {
        CPTAxisLabel *label = [[CPTAxisLabel alloc] initWithText:date  textStyle:x.labelTextStyle];
        CGFloat location = i++;
        label.tickLocation = CPTDecimalFromCGFloat(location);
        label.offset = x.majorTickLength;
        if (label) {
            [xLabels addObject:label];
            [xLocations addObject:[NSNumber numberWithFloat:location]];
        }
    }
    x.axisLabels = xLabels;
    x.majorTickLocations = xLocations;

    // 4 - Configure y-axis
    CPTAxis *y = axisSet.yAxis;
    y.title = @"Time";
    y.titleTextStyle = axisTitleStyle;
    y.titleOffset = -40.0f;
    y.axisLineStyle = axisLineStyle;
    y.majorGridLineStyle = gridLineStyle;
    y.labelingPolicy = CPTAxisLabelingPolicyNone;
    y.labelTextStyle = axisTextStyle;
    y.labelOffset = 16.0f;
    y.majorTickLineStyle = axisLineStyle;
    y.majorTickLength = 4.0f;
    y.minorTickLength = 2.0f;
    y.tickDirection = CPTSignPositive;
    NSInteger majorIncrement = 100;
    NSInteger minorIncrement = 50;
    CGFloat yMax = 700.0f;  // should determine dynamically based on max time
    NSMutableSet *yLabels = [NSMutableSet set];
    NSMutableSet *yMajorLocations = [NSMutableSet set];
    NSMutableSet *yMinorLocations = [NSMutableSet set];
    for (NSInteger j = minorIncrement; j <= yMax; j += minorIncrement) {
        NSUInteger mod = j % majorIncrement;
        if (mod == 0) {
            CPTAxisLabel *label = [[CPTAxisLabel alloc] initWithText:[NSString stringWithFormat:@"%i", j] textStyle:y.labelTextStyle];
            NSDecimal location = CPTDecimalFromInteger(j);
            label.tickLocation = location;
            label.offset = -y.majorTickLength - y.labelOffset;
            if (label) {
                [yLabels addObject:label];
            }
            [yMajorLocations addObject:[NSDecimalNumber decimalNumberWithDecimal:location]];
        } else {
            [yMinorLocations addObject:[NSDecimalNumber decimalNumberWithDecimal:CPTDecimalFromInteger(j)]];
        }
    }
    y.axisLabels = yLabels;
    y.majorTickLocations = yMajorLocations;
    y.minorTickLocations = yMinorLocations;

}

#pragma mark - CPTPlotDataSource methods
-(NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot {
    return [timesTest count];
}

-(NSNumber *)numberForPlot:(CPTPlot *)plot field:(NSUInteger)fieldEnum recordIndex:(NSUInteger)index {
    //NSInteger valueCount = [[[CPDStockPriceStore sharedInstance] datesInMonth] count];
    NSInteger valueCount = [timesTest count];
    switch (fieldEnum) {
        case CPTScatterPlotFieldX:
            if (index < valueCount) {
                return [NSNumber numberWithUnsignedInteger:index];
            }
            break;

        case CPTScatterPlotFieldY:
            if ([plot.identifier isEqual:pbTest] == YES) {
                return [pbTest objectAtIndex:index];
            } else if ([plot.identifier isEqual:rollAvgTest] == YES) {
                return [rollAvgTest objectAtIndex:index];
            } else if ([plot.identifier isEqual:timesTest] == YES) {
                return [timesTest objectAtIndex:index];
            }
            break;
    }
    return [NSDecimalNumber zero];
} 
```

这里是我创建数组来测试图表的地方：

```
datesTest = [NSArray arrayWithObjects:@"4/27",
                                            @"4/28",
                                            @"4/29",
                                            nil];

        timesTest = [NSArray arrayWithObjects:
                     [NSDecimalNumber numberWithFloat:601.1],
                     [NSDecimalNumber numberWithFloat:614.4],
                     [NSDecimalNumber numberWithFloat:607.3],
                     nil];

        pbTest = [NSArray arrayWithObjects:
                     [NSDecimalNumber numberWithFloat:601.1],
                     [NSDecimalNumber numberWithFloat:601.1],
                     [NSDecimalNumber numberWithFloat:601.1],
                     nil];

        rollAvgTest = [NSArray arrayWithObjects:
                     [NSDecimalNumber numberWithFloat:602.1],
                     [NSDecimalNumber numberWithFloat:613.4],
                     [NSDecimalNumber numberWithFloat:605.3],
                     nil]; 
```

raywenderlich 项目编译并运行完美，所需的 y 轴完美缩放以适合屏幕，但我的项目没有，但我无法弄清楚我缺少什么。任何关于我哪里出错的建议将不胜感激。编辑：添加绘图配置以响应评论...

```
-(void)configurePlots{
    // 1 - Get graph and plot space
    CPTGraph *graph = self.hostView.hostedGraph;
    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *) graph.defaultPlotSpace;
    // 2 - Create the three plots
    // FIRST PLOT is Personal Best - pbPlot
    // SECOND PLOT is Rolling Average - rollAvgPlot
    // THIRD PLOT is Individual swims - swimssPlot

    //Plot 1 - Peronal Best
    CPTScatterPlot *pbPlot = [[CPTScatterPlot alloc] init];
    pbPlot.dataSource = self;
    NSString *pbID = [[NSString alloc] initWithFormat:@"pbID"];
    pbPlot.identifier = pbID;
    CPTColor *pbColor = [CPTColor redColor];
    [graph addPlot:pbPlot toPlotSpace:plotSpace];

    //Plot 2 - Rolling Average
    CPTScatterPlot *rollAvgPlot = [[CPTScatterPlot alloc] init];
    rollAvgPlot.dataSource = self;
    NSString *rollAvgID = [[NSString alloc] initWithFormat:@"rollAvgID"];
    rollAvgPlot.identifier = rollAvgID;
    CPTColor *rollAvgColor = [CPTColor greenColor];
    [graph addPlot:rollAvgPlot toPlotSpace:plotSpace];

    //Plot 3 - Actual Swim Times
    CPTScatterPlot *swimsPlot = [[CPTScatterPlot alloc] init];
    swimsPlot.dataSource = self;
    NSString *timesID = [[NSString alloc] initWithFormat:@"timesID"];
    swimsPlot.identifier = timesID;
    CPTColor *swimsColor = [CPTColor blueColor];
    [graph addPlot:swimsPlot toPlotSpace:plotSpace];

    // 3 - Set up plot space
    //[plotSpace scaleToFitPlots:[NSArray arrayWithObjects:pbPlot, rollAvgPlot, swimsPlot, nil]];
    [plotSpace scaleToFitPlots:[NSArray arrayWithObjects:swimsPlot, nil]];
    CPTMutablePlotRange *xRange = [plotSpace.xRange mutableCopy];
    [xRange expandRangeByFactor:CPTDecimalFromCGFloat(1.1f)];
    plotSpace.xRange = xRange;
    CPTMutablePlotRange *yRange = [plotSpace.yRange mutableCopy];
    [yRange expandRangeByFactor:CPTDecimalFromCGFloat(1.2f)];
    plotSpace.yRange = yRange;

    // 4 - Create styles and symbols
    CPTMutableLineStyle *pbLineStyle = [pbPlot.dataLineStyle mutableCopy];
    pbLineStyle.lineWidth = 2.5;
    pbLineStyle.lineColor = pbColor;
    pbPlot.dataLineStyle = pbLineStyle;
    CPTMutableLineStyle *pbSymbolLineStyle = [CPTMutableLineStyle lineStyle];
    pbSymbolLineStyle.lineColor = pbColor;
    CPTPlotSymbol *pbSymbol = [CPTPlotSymbol ellipsePlotSymbol];
    pbSymbol.fill = [CPTFill fillWithColor:pbColor];
    pbSymbol.lineStyle = pbSymbolLineStyle;
    pbSymbol.size = CGSizeMake(6.0f, 6.0f);
    pbPlot.plotSymbol = pbSymbol;

    CPTMutableLineStyle *rollAvgLineStyle = [rollAvgPlot.dataLineStyle mutableCopy];
    rollAvgLineStyle.lineWidth = 1.0;
    rollAvgLineStyle.lineColor = rollAvgColor;
    rollAvgPlot.dataLineStyle = rollAvgLineStyle;
    CPTMutableLineStyle *rollAvgSymbolLineStyle = [CPTMutableLineStyle lineStyle];
    rollAvgSymbolLineStyle.lineColor = rollAvgColor;
    CPTPlotSymbol *rollAvgSymbol = [CPTPlotSymbol starPlotSymbol];
    rollAvgSymbol.fill = [CPTFill fillWithColor:rollAvgColor];
    rollAvgSymbol.lineStyle = rollAvgSymbolLineStyle;
    rollAvgSymbol.size = CGSizeMake(6.0f, 6.0f);
    rollAvgPlot.plotSymbol = rollAvgSymbol;

    CPTMutableLineStyle *swimsLineStyle = [swimsPlot.dataLineStyle mutableCopy];
    swimsLineStyle.lineWidth = 2.0;
    swimsLineStyle.lineColor = swimsColor;
    swimsPlot.dataLineStyle = swimsLineStyle;
    CPTMutableLineStyle *swimsSymbolLineStyle = [CPTMutableLineStyle lineStyle];
    swimsSymbolLineStyle.lineColor = swimsColor;
    CPTPlotSymbol *swimsSymbol = [CPTPlotSymbol diamondPlotSymbol];
    swimsSymbol.fill = [CPTFill fillWithColor:swimsColor];
    swimsSymbol.lineStyle = swimsSymbolLineStyle;
    swimsSymbol.size = CGSizeMake(6.0f, 6.0f);
    swimsPlot.plotSymbol = swimsSymbol;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:34:53.387

检查您的地块标识符。在设置绘图时将标识符设置为一个值，并将它们与数据源中的其他值进行比较。该测试可能失败，这意味着每个图的每个 y 值都为零 (0)。

# c++ - C++ 中指针的自动返回类型

> ID：13109933
> 
> 赞同：3
> 
> 时间：2012-10-28T15:02:32.273
> 
> 标签：c++, class, templates, pointers, return

我希望标题不会太混乱。我拥有的是一个类`StorageManager`，其中包含从`Storage`. 这是一个例子。

```
struct Storage {};                         // abstract

class StorageManager
{
private:
    map<string, unique_ptr<Storage>> List; // store all types of storage

public:
    template <typename T>
    void Add(string Name)                  // add new storage with name
    {
        List.insert(make_pair(Name, unique_ptr<Storage>(new T())));
    }

    Storage* Get(string Name)              // get storage by name
    {
        return List[Name].get();
    }
}; 
```

Say`Position`是一种特殊的存储类型。

```
struct Position : public Storage
{
    int X;
    int Y;
}; 
```

感谢我[上一个问题](https://stackoverflow.com/questions/13109356/how-to-pass-a-class-as-parameter/13109493)的出色答案，该`Add`功能已经有效。我要改进的是`Get`功能。它合理地返回一个`Storage*`我可以使用的指针，如下所示。

```
int main()
{
    StorageManager Manager;
    Manager.Add<Position>("pos");    // add a new storage of type position

    auto Strge = Manager.Get("pos"); // get pointer to base class storage
    auto Pstn = (Position*)Strge;    // convert pointer to derived class position

    Pstn->X = 5;
    Pstn->Y = 42;
} 
```

有没有办法通过自动返回指向派生类的指针来摆脱这种指针转换？也许使用模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:24:41.907

`Get`除了@BigBoss 已经指出的内容之外，我看不到您可以为您的成员函数做什么，但您可以改进您的`Add`成员以返回使用的存储空间。

```
template <typename T>
T* Add(string Name)                  // add new storage with name
{
   T* t = new T();
   List.insert(make_pair(Name, unique_ptr<Storage>(t)));
   return t;
}

// create the pointer directly in a unique_ptr
template <typename T>
T* Add(string Name)                  // add new storage with name
{
  std::unique_ptr<T> x{new T{}};
  T* t = x.get();
  List.insert(make_pair(Name, std::move(x)));
  return t;
} 
```

**编辑**临时阻止我们不得不`dynamic_cast`。 **EDIT2**实施 MatthieuM 的建议。

您还可以通过接受要插入的类型的值和默认参数来进一步改进函数，但这可能会产生额外的副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T15:14:24.433

利用：

```
template< class T >
T* Get(std::string const& name)
{
    auto i = List.find(name);
    return i == List.end() ? nullptr : static_cast<T*>(i->second.get());
} 
```

然后在您的代码中：

```
Position* p = Manager.Get<Position>("pos"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T16:21:33.457

当您拥有指向某个类的对象的指针或引用时，您所知道的只是它引用的实际运行时对象要么属于该类，*要么属于某个派生类*。 `auto` *在编译时无法*知道对象的运行时类型，因为包含`auto`变量的代码段可能在一个运行两次的函数中——一次处理一种运行时类型的对象，另一个处理具有不同运行时类型的对象！类型系统无法告诉您在具有多态性的语言中究竟有哪些类型在起作用——它只能提供一些约束。

如果您知道对象的运行时类型是某个特定的派生类（如您的示例中），则可以（并且必须）使用强制转换。（人们认为最好使用 形式的`static_cast<Position*>`强制转换，因为强制转换是危险的，这使得在代码中搜索强制转换变得更容易。）

但一般来说，经常这样做是设计不佳的标志。声明基类并从中派生其他类类型的目的是使*所有*这些类型的对象都能以相同的方式处理，而无需转换为特定类型。

*   如果您希望在编译时始终拥有正确的派生类型而不使用强制转换，那么您别无选择，只能使用该类型的单独集合。在这种情况下，`Position`从`Storage`.
*   如果您可以重新安排事情，以便调用者`StorageManager::Get()`需要对 a进行的所有`Position`操作都可以通过调用未指定`Position`特定信息（例如坐标）的函数来完成，那么您可以将这些函数转换为`Storage`, 和`Position`在`Position`. _ 例如，您可以创建一个函数`Storage::Dump()`，将其对象写入`stdout`. `Position::Dump()`将输出`X`and `Y`，而`Dump()`其他可能的派生类的实现将输出不同的信息。
*   有时，您需要能够使用可能是几个本质上不相关的类型之一的对象。我怀疑这里可能就是这种情况。在这种情况下，[`boost::variant<>`](http://www.boost.org/doc/libs/1_51_0/doc/html/variant.html)是一个很好的方法。`variant`这个库提供了一种称为访问者模式的强大机制，它允许您指定对对象可能是的每种类型应采取的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T15:47:27.850

除了这看起来是个糟糕的想法之外……让我们看看我们能做些什么来改善这种情况。

=> 要求默认构造是个坏主意

```
template <typename T>
T& add(std::string const& name, std::unique_ptr<T> element) {
    T& t = *element;
    auto result = map.insert(std::make_pair(name, std::move(element)));
    if (result.second == false) {
        // FIXME: somehow add the name here, for easier diagnosis
        throw std::runtime_error("Duplicate element");
    }
    return t;
} 
```

=> 盲目地垂头丧气是个坏主意

```
template <typename T>
T* get(std::string const& name) const {
    auto it = map.find(name);
    return it != map.end() ? dynamic_cast<T*>(it->second.get()) : nullptr;
} 
```

但坦率地说，这个系统漏洞百出。首先可能是不必要的。我鼓励您查看一般问题并提出更好的设计。

# windows-runtime - WinRT 中的 RX 线程问题

> ID：13109941
> 
> 赞同：1
> 
> 时间：2012-10-28T15:03:41.213
> 
> 标签：windows-runtime, system.reactive

我有一些简单的代码：

```
var timer =  Observable.Timer(TimeSpan.FromSeconds(0), TimeSpan.FromSeconds(1)).Timestamp();

 //timer.Subscribe(x => timerTb.Text = x.Value.ToString());
 timer.Subscribe(x => Debug.WriteLine(x.Value)); 
```

视图上有一个名为 timerTb 的文本框。我正在尝试让注释掉的行在没有大喊编组问题的情况下正常工作。

据我所知，我应该使用`timer.ObserveOnDispatcher().Subscribe(...` 但我无权访问此方法，也无权访问 CoreDispatcherScheduler dispite 引用“System.Reactive.Linq;”

我正在运行 RX 2.0.20304.0

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T19:22:20.890

我设法让它工作。

愚蠢的菜鸟错误CoreDispatcherScheduler在：System.Reactive.Windows.Threading

一旦我提到我得到了 ObserveOnDispatcher() 并且这有效：

```
var timer = Observable.Timer(TimeSpan.FromSeconds(0), TimeSpan.FromSeconds(1)).Timestamp();

timer.ObserveOnDispatcher().Subscribe(x => timerTb.Text = x.Value.ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T18:51:45.087

将计时器放在 UI 线程上：

```
Observable.Timer(TimeSpan.FromSeconds(0), TimeSpan.FromSeconds(1), CoreDispatcherScheduler.Instance)
    .Timestamp(); 
```

# haskell - 并行排序 IO 操作

> ID：13109946
> 
> 赞同：11
> 
> 时间：2012-10-28T15:04:01.637
> 
> 标签：haskell, io, parallel-processing

我有一个返回 IO 动作的函数，

```
f :: Int -> IO Int 
```

我想为参数的多个值并行计算这个函数。我天真的实现如下：

```
import Control.Parallel.Strategies

vals = [1..10]
main = do
      results <- mapM f vals
      let results' = results `using` parList rseq
      mapM_ print results' 
```

我对此的理由是，第一个`mapM`将类型绑定`IO [Int]`到`results`，`results'`对包含的列表应用并行策略，`mapM_`最后通过打印它们来请求实际值 - 但是要打印的内容已经并行触发，所以程序应该并行化。

`+RTS -N8`在很高兴它确实使用了我所有的 CPU 之后，我注意到该程序在运行时效率低于没有任何 RTS 标志时（如挂钟时间） 。我能想到的唯一解释是第一个`mapM`必须对所有 IO 操作进行排序 - 即执行 - 已经完成，但这不会导致无效，而是使`N8`执行与未并行操作一样有效，因为所有工作都是由主线程。`+RTS -N8 -s`使用yield运行程序`SPARKS: 36 (11 converted, 0 overflowed, 0 dud, 21 GC'd, 4 fizzled)`，这肯定不是最优的，但不幸的是我无法理解它。

我想我已经在 Haskell 并行化或 IO monad 的内部找到了初学者的垫脚石之一。我究竟做错了什么？

背景信息：`f n`是一个返回 Project Euler 问题 n 的解的函数。由于其中许多有数据要读取，我将结果放入 IO monad。它看起来如何的一个例子是

```
-- Problem 13: Work out the first ten digits of the sum of one-hundred 50-digit numbers.

euler 13 = fmap (first10 . sum) numbers
      where
            numbers = fmap (map read . explode '\n') $ readFile "problem_13"
            first10 n
                  | n < 10^10 = n -- 10^10 is the first number with 11 digits
                  | otherwise  = first10 $ n `div` 10 
```

完整的文件可以在[这里](http://codepad.org/VYXqTeQh)找到（有点长，但前几个“euler X”函数应该足够有代表性），我做并行的主文件就是[这个](http://codepad.org/ehLwYrjL)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T17:58:50.573

策略用于并行执行纯计算。如果您确实必须`f`返回一个`IO`值，那么请考虑改用该`async`包。它为同时运行`IO`动作提供了有用的组合器。

对于您的用例，`mapConcurrently`看起来很有用：

```
import Control.Concurrent.Async

vals = [1..10]
main = do
  results <- mapConcurrently f vals
  mapM_ print results 
```

（我还没有测试过，因为我不知道你`f`到底是什么。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T17:53:35.533

试试这个`parallel-io`包。它允许您将任何更改`mapM_`为`parallel_`.

# authentication - 使用 github 和 LinkedIn 进行客户端 javascript 身份验证 - 获取访问令牌

> ID：13109957
> 
> 赞同：1
> 
> 时间：2012-10-28T15:05:04.577
> 
> 标签：authentication, github, authorization, linkedin, github-api

我需要从客户端的不同提供商处获取访问令牌。

这个想法是我需要用户通过 javascript 向这些提供程序进行身份验证，然后检索一个访问令牌以用于对另一个 Web 服务进行身份验证......

到目前为止，我们设法在 twitter 上使用[twitter-anywhere](https://dev.twitter.com/docs/anywhere/welcome#login-signup)，在 facebook 中使用[javascript SDK](http://developers.facebook.com/docs/reference/javascript/FB.login/)和在 google 中使用它的[api-javascript-client](http://code.google.com/p/google-api-javascript-client/wiki/Authentication)

我想知道 yahoo、linked 和 github 是否有类似的解决方案。甚至更好的是，可以处理不同提供商的更通用的解决方案......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T13:24:50.007

当然，Linkedin 有一个。

[http://developer.linkedin.com/javascript](http://developer.linkedin.com/javascript)

[http://developer.linkedin.com/documents/javascript-api-reference-0](http://developer.linkedin.com/documents/javascript-api-reference-0)

不知道当这个问题被问到时是否存在。对于 github，[@Ivan Zuzak](https://stackoverflow.com/users/1673062/ivan-zuzak)的评论就足够了。

此链接有一个带有少量服务器支持的解决方法 - [http://blog.vjeux.com/2012/javascript/github-oauth-login-browser-side.html](http://blog.vjeux.com/2012/javascript/github-oauth-login-browser-side.html)

# clojure - 为什么我不能将 Clojure 的 :^const 与 Java 字节数组一起使用？

> ID：13109958
> 
> 赞同：13
> 
> 时间：2012-10-28T15:05:07.487
> 
> 标签：clojure

使用`lein repl`Clojure 1.4.0，我可以定义一个`^:const`Java 字节数组，但我不能用它做任何事情：

```
user=> (def x (byte-array (map byte [0 1 2 3])))
#'user/x
user=> (alength x)
4
user=> (type x)
[B
user=> (def ^:const cx (byte-array (map byte [0 1 2 3])))
#'user/cx
user=> (alength cx)
CompilerException java.lang.RuntimeException: Can't embed object in code, maybe print-dup not defined: [B@10e6cbd, compiling:(NO_SOURCE_PATH:1)
user=> (type cx)
CompilerException java.lang.RuntimeException: Can't embed object in code, maybe print-dup not defined: [B@10e6cbd, compiling:(NO_SOURCE_PATH:1) 
```

我已经确认这也发生在我的应用程序中，所以这不仅仅是一个 REPL 问题。

我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-28T17:34:48.733

^:const 形式在编译时评估，但在 clojure 中，编译时值必须是可打印和可读的（由 clojure 阅读器）*。像大多数 java 对象一样，字节数组是不可打印或不可读取的，因此您无法将它们设为常量。

此外，根据文档， ^:const 仅对原语有用。不是原始数组。

*   有关一些相关问题，另请参见[http://www.infoq.com/presentations/Clojure-Macros](http://www.infoq.com/presentations/Clojure-Macros)。

# web-services - 用于 WSDL 和 BasicHttpBinding 的 F# 类型提供程序

> ID：13109959
> 
> 赞同：4
> 
> 时间：2012-10-28T15:05:20.817
> 
> 标签：web-services, f#, wsdl, type-providers

当我在 C# 中使用 WSDL 服务时，我可以将两个参数传递给构造函数；BasicHttpBinding 和 EndpointAddress

```
BasicHttpBinding basicHttpBinding = new BasicHttpBinding { MaxReceivedMessageSize = 20000000, MaxBufferSize = 20000000 };
EndpointAddress endpointAddress = new EndpointAddress(delarsListUrl);
var ds = new DealersService.DealersServiceClient(basicHttpBinding,endpointAddress); 
```

当我在 F# 中使用 WSDL 类型提供程序时，我只允许在没有任何参数或使用 BasicHttpBinding 类型的一个参数的情况下调用构造函数。那么如何设置 MaxReceivedMessageSize 或 MaxBufferSize 等参数呢？

**编辑：**

如果我把它放到 Azure Worker 角色的 app.config

```
<system.serviceModel>
   <bindings>
     <basicHttpBinding>
       <binding name="basicHttp" allowCookies="true"
             maxReceivedMessageSize="20000000"
             maxBufferSize="20000000"
             maxBufferPoolSize="20000000">
         <readerQuotas maxDepth="32"
           maxArrayLength="200000000"
           maxStringContentLength="200000000"/>
       </binding>
     </basicHttpBinding>
   </bindings>
 </system.serviceModel> 
```

它没有帮助，我仍然得到 maxReceivedMessageSize 只有 64k 的异常，我应该更改它。我在 C# 中遇到了同样的问题，app.config 设置似乎被忽略了，所以我通过将带有这些设置的 BasicHttpBinding 传递给构造函数来解决它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T19:08:05.577

简化的数据上下文（通过 T.GetDataContext() 创建）仅公开无参数构造函数和接受 EndpointAddress 的构造函数。如果您想手动设置绑定 - 您可以直接实例化客户端类（它应该位于 ServiceTypes 内），即：

```
type WSDL = Microsoft.FSharp.Data.TypeProviders.WsdlService< @"http://www.webservicex.net/RealTimeMarketData.asmx?WSDL">
let client = new WSDL.ServiceTypes.RealTimeMarketDataSoapClient(...) 
```

# ruby - 使用 Chingu 创建可变大小的游戏对象

> ID：13109960
> 
> 赞同：1
> 
> 时间：2012-10-28T15:05:23.353
> 
> 标签：ruby, libgosu

我正在尝试制作一个不使用 Gosu::Image 而是使用 Chingu::Rect 的 GameObject。这是我的课，省略了所有不重要的方法

```
class Tile < Chingu::GameObject
  trait :bounding_box
  trait :collision_detection

  def initialize (x, y, w, h, opts={})
    super opts
    @area = Chingu::Rect.new(x,y,w,h)
  end

  def collision_at?(x, y)
    @area.collide_point?(x,y)
  end       
end 
```

但是碰撞检测不起作用。有谁知道如何告诉 bounding_box 使用特定的 Rectangle 而不是 Image？

# objective-c - NSButton如何给文字上色

> ID：13109964
> 
> 赞同：33
> 
> 时间：2012-10-28T15:05:53.163
> 
> 标签：objective-c, macos, nsbutton, textcolor

在 OSX 上，我有一个带有非常暗图像的 NSButton，不幸的是，无法使用属性检查器更改颜色。看图片黑色的大按钮，文字是**Go**。

![在此处输入图像描述](../Images/535fb7dd783bdc040894265b338f62a8.png)

是否有可能更改文本颜色的线索？我查看了 NSButton 类，但没有方法可以做到这一点。我知道我可以用白色字体制作图像，但这不是我想做的。

来自瑞士的问候，罗纳德·霍夫曼—— 

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-07-04T14:07:40.803

这是另外两个解决方案： http: ~~[//denis-druz.okis.ru/news.534557.Text-Color-in-NSButton.html](http://denis-druz.okis.ru/news.534557.Text-Color-in-NSButton.html)~~

解决方案1：

```
-(void)awakeFromNib
{
    NSColor *color = [NSColor greenColor];
    NSMutableAttributedString *colorTitle = [[NSMutableAttributedString alloc] initWithAttributedString:[button attributedTitle]];
    NSRange titleRange = NSMakeRange(0, [colorTitle length]);
    [colorTitle addAttribute:NSForegroundColorAttributeName value:color range:titleRange];
    [button setAttributedTitle:colorTitle];
} 
```

解决方案2：

在 *.m 文件中：

```
- (void)setButtonTitleFor:(NSButton*)button toString:(NSString*)title withColor:(NSColor*)color
{
    NSMutableParagraphStyle *style = [[NSMutableParagraphStyle alloc] init];
    [style setAlignment:NSCenterTextAlignment];
    NSDictionary *attrsDictionary = [NSDictionary dictionaryWithObjectsAndKeys:color, NSForegroundColorAttributeName, style, NSParagraphStyleAttributeName, nil];
    NSAttributedString *attrString = [[NSAttributedString alloc]initWithString:title attributes:attrsDictionary];
    [button setAttributedTitle:attrString];
}

-(void)awakeFromNib
{
    NSString *title = @"+Add page";
    NSColor *color = [NSColor greenColor];
    [self setButtonTitleFor:button toString:title withColor:color];
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-11-16T15:52:38.663

我的解决方案：

```
.h

IB_DESIGNABLE
@interface DVButton : NSButton

@property (nonatomic, strong) IBInspectable NSColor *BGColor;
@property (nonatomic, strong) IBInspectable NSColor *TextColor;

@end

.m

@implementation DVButton

- (void)awakeFromNib
{
    if (self.TextColor)
    {
        NSMutableParagraphStyle *style = [[NSMutableParagraphStyle alloc] init];
        [style setAlignment:NSCenterTextAlignment];
        NSDictionary *attrsDictionary  = [NSDictionary dictionaryWithObjectsAndKeys:
                                          self.TextColor, NSForegroundColorAttributeName,
                                          self.font, NSFontAttributeName,
                                          style, NSParagraphStyleAttributeName, nil];
        NSAttributedString *attrString = [[NSAttributedString alloc]initWithString:self.title attributes:attrsDictionary];
        [self setAttributedTitle:attrString];
    }
}

- (void)drawRect:(NSRect)dirtyRect
{
    if (self.BGColor)
    {
        // add a background colour
        [self.BGColor setFill];
        NSRectFill(dirtyRect);
    }

    [super drawRect:dirtyRect];
}

@end 
```

[![在此处输入图像描述](../Images/483a321dda2cbc9d0282c383053c0726.png)](https://i.stack.imgur.com/KtIWB.png)

这是一个 Swift 3 版本：

```
import Cocoa

@IBDesignable
class DVButton: NSButton
{
    @IBInspectable var bgColor: NSColor?
    @IBInspectable var textColor: NSColor?

    override func awakeFromNib()
    {
        if let textColor = textColor, let font = font
        {
            let style = NSMutableParagraphStyle()
            style.alignment = .center

            let attributes =
            [
                NSForegroundColorAttributeName: textColor,
                NSFontAttributeName: font,
                NSParagraphStyleAttributeName: style
            ] as [String : Any]

            let attributedTitle = NSAttributedString(string: title, attributes: attributes)
            self.attributedTitle = attributedTitle
        }
    }

    override func draw(_ dirtyRect: NSRect)
    {
        if let bgColor = bgColor
        {
            bgColor.setFill()
            NSRectFill(dirtyRect)
        }

        super.draw(dirtyRect)
    }

} 
```

和 Swift 4.0 版本：

```
import Cocoa

@IBDesignable
 class Button: NSButton
{
    @IBInspectable var bgColor: NSColor?
    @IBInspectable var textColor: NSColor?

    override func awakeFromNib()
    {
        if let textColor = textColor, let font = font
        {
            let style = NSMutableParagraphStyle()
            style.alignment = .center

            let attributes =
            [
                NSAttributedStringKey.foregroundColor: textColor,
                NSAttributedStringKey.font: font,
                NSAttributedStringKey.paragraphStyle: style
             ] as [NSAttributedStringKey : Any]

            let attributedTitle = NSAttributedString(string: title, attributes: attributes)
            self.attributedTitle = attributedTitle
        }
    }

    override func draw(_ dirtyRect: NSRect)
    {
        if let bgColor = bgColor
        {
            bgColor.setFill()
            __NSRectFill(dirtyRect)
        }

        super.draw(dirtyRect)
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-01-24T08:11:33.607

这就是我在 Swift 4 中完成它的方式

```
 @IBOutlet weak var myButton: NSButton!

 // create the attributed string
 let myString = "My Button Title"
 let myAttribute = [ NSAttributedStringKey.foregroundColor: NSColor.blue ]
 let myAttrString = NSAttributedString(string: myString, attributes: myAttribute)
 // assign it to the button
 myButton.attributedTitle = myAttrString 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-11-08T10:55:27.153

Apple 有用于设置 NSButton 的文本颜色的代码作为[Popover 示例](https://developer.apple.com/library/mac/samplecode/Popover/Listings/NSButton_Extended_m.html)的一部分。

下面是示例的关键（针对这篇文章稍作修改，未经测试）：

```
NSButton *button = ...;
NSMutableAttributedString *attrTitle =
    [[NSMutableAttributedString alloc] initWithString:@"Make Me Red"];
NSUInteger len = [attrTitle length];
NSRange range = NSMakeRange(0, len);
[attrTitle addAttribute:NSForegroundColorAttributeName value:[NSColor redColor] range:range];
[attrTitle fixAttributesInRange:range];
[button setAttributedTitle:attrTitle]; 
```

请注意，调用`fixAttributesInRange:`似乎很重要（AppKit 扩展），但我找不到关于*为什么*会这样的文档。我对在 NSButton 中使用属性字符串的唯一担忧是，如果还为按钮定义了图像（例如图标），属性字符串将占据一个大矩形并将图像推到按钮的边缘。有什么要记住的。

否则，最好的方法似乎是自己进行`drawRect:`覆盖，这有许多其他陷阱超出了这个问题的范围。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-04-22T10:26:57.963

我创建了一个`NSButton`名为的子类`FlatButton`，它可以像您要​​求的那样非常容易地在 Interface Builder 的属性检查器中更改文本颜色。它应该为您的问题提供简单而广泛的解决方案。

它还公开了其他相关的样式属性，例如颜色和形状。

你可以在这里找到它：[https ://github.com/OskarGroth/FlatButton](https://github.com/OskarGroth/FlatButton)

[![适用于 macOS 的平面按钮](../Images/3186ab5a4acf09e8bb93296046555b3b.png)](https://i.stack.imgur.com/hHLRP.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-12-14T17:53:52.880

当您的目标是 macOS 10.14 或更高版本时，您可以使用`contentTintColor`NSButton 控件的新属性来设置文本颜色。

```
button.contentTintColor = NSColor.systemGreenColor; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-02-08T15:56:09.263

在 NSButton 上添加一个类别，只需将颜色设置为您想要的颜色，并保留现有属性，因为标题可以居中、左对齐等

```
@implementation NSButton (NSButton_IDDAppKit)

- (NSColor*)titleTextColor {

    return [NSColor redColor];

}

- (void)setTitleTextColor:(NSColor*)aColor {

    NSMutableAttributedString*  attributedString = [[NSMutableAttributedString alloc] initWithAttributedString:self.attributedTitle];
    NSString*  title = self.title;
    NSRange  range = NSMakeRange(0.0, self.title.length);

    [attributedString addAttribute:NSForegroundColorAttributeName value:aColor range:range];
    [self setAttributedTitle:attributedString];
    [attributedString release];

}

@end 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-03-27T11:43:46.597

一个非常简单、可重用的解决方案，无需子类化 NSButton：

```
[self setButton:self.myButton fontColor:[NSColor whiteColor]] ;

-(void) setButton:(NSButton *)button fontColor:(NSColor *)color {
    NSMutableAttributedString *colorTitle = [[NSMutableAttributedString alloc] initWithAttributedString:[button attributedTitle]];
    [colorTitle addAttribute:NSForegroundColorAttributeName value:color range:NSMakeRange(0, button.attributedTitle.length)];
    [button setAttributedTitle:colorTitle];
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-01-07T15:55:54.973

如果部署目标> 10.14，您可以使用`contentTintColor`设置颜色。

```
/** Applies a tint color to template image and text content, in combination with other theme-appropriate effects. Only applicable to borderless buttons. A nil value indicates the standard set of effects without color modification. The default value is nil. Non-template images and attributed string values are not affected by the contentTintColor. */
@available(macOS 10.14, *)
@NSCopying open var contentTintColor: NSColor? 
```

示例代码：

```
var confirmBtn = NSButton()
confirmBtn.title = "color"
confirmBtn.contentTintColor = NSColor.red 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-08-03T06:42:43.487

**斯威夫特 5**

你可以使用这个扩展：

```
extension NSButton {

@IBInspectable var titleColor: NSColor? {
    get {
        return   NSColor.white
    }
    set {
        let pstyle = NSMutableParagraphStyle()
        pstyle.alignment = .center

        self.attributedTitle = NSAttributedString(
            string: self.title,
            attributes: [ NSAttributedString.Key.foregroundColor :newValue, NSAttributedString.Key.paragraphStyle: pstyle])

    }
   }
 } 
```

现在您可以轻松地在情节提要中设置标题颜色。干杯!

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-03-09T18:01:28.083

```
NSColor color = NSColor.White;  
NSMutableAttributedString colorTitle = new NSMutableAttributedString (cb.Cell.Title);                
NSRange titleRange = new NSRange (0, (nint)cb.Cell.Title.Length);
colorTitle.AddAttribute (NSStringAttributeKey.ForegroundColor, color, titleRange);      
cb.Cell.AttributedTitle = colorTitle; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-05-10T19:41:08.327

使用上面的信息，我编写了一个 NSButton 扩展来设置前景色，以及系统字体和文本对齐方式。

这适用于 Swift 4.x 上的 Cocoa，但可以很容易地针对 iOS 进行调整。

```
import Cocoa

extension NSButton {
    func setAttributes(foreground: NSColor? = nil, fontSize: CGFloat = -1.0, alignment: NSTextAlignment? = nil) {

        var attributes: [NSAttributedStringKey: Any] = [:]

        if let foreground = foreground {
            attributes[NSAttributedStringKey.foregroundColor] = foreground
        }

        if fontSize != -1 {
            attributes[NSAttributedStringKey.font] = NSFont.systemFont(ofSize: fontSize)
        }

        if let alignment = alignment {
            let paragraph = NSMutableParagraphStyle()
            paragraph.alignment = alignment
            attributes[NSAttributedStringKey.paragraphStyle] = paragraph
        }

        let attributed = NSAttributedString(string: self.title, attributes: attributes)
        self.attributedTitle = attributed
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-23T10:37:55.207

Swift 4.2 版本 David Boyd 的解决方案

```
extension NSButton {
func setAttributes(foreground: NSColor? = nil, fontSize: CGFloat = -1.0, alignment: NSTextAlignment? = nil) {

    var attributes: [NSAttributedString.Key: Any] = [:]

    if let foreground = foreground {
        attributes[NSAttributedString.Key.foregroundColor] = foreground
    }

    if fontSize != -1 {
        attributes[NSAttributedString.Key.font] = NSFont.systemFont(ofSize: fontSize)
    }

    if let alignment = alignment {
        let paragraph = NSMutableParagraphStyle()
        paragraph.alignment = alignment
        attributes[NSAttributedString.Key.paragraphStyle] = paragraph
    }

    let attributed = NSAttributedString(string: self.title, attributes: attributes)
    self.attributedTitle = attributed
} 
```

}

# asp.net - ASP.NET Mysql 数据阅读器不工作

> ID：13109965
> 
> 赞同：0
> 
> 时间：2012-10-28T15:05:57.627
> 
> 标签：asp.net, .net, login

我尝试对数据库进行身份验证，以创建登录功能。每次按下按钮时，我都会收到此错误：System.InvalidOperationException：连接未打开。在 MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex) 在 MySql.Data.MySqlClient.MySqlCommand.Throw(Exception ex) 在 MySql.Data.MySqlClient.MySqlCommand.Prepare() 在 start.CheckUserLogin(String username, String password ) 在 c:\Users\RARES\Documents\Visual Studio 2010\WebSites\tem1\start.aspx.cs:第 46 行

请告诉我如何读取数据并检查用户和密码是否与 ThextBox 文本相同。

```
protected void Button1_Click(object sender, EventArgs e)
{
    try
    {
        String sCon = "SERVER=localhost;DATABASE=sd_tema1;UID=root;";
        MySqlConnection con = new MySqlConnection(sCon);

        if (CheckUserLogin(Label2.Text, Label3.Text))
        {
            Response.Redirect("login.aspx");
        } 

    }
    catch (Exception ex)
    {
        Label1.Text = ex.ToString();
    }
}

public Boolean CheckUserLogin(string username, string password)
{
    try
    {
        String sCon = "SERVER=localhost;DATABASE=sd_tema1;UID=root;";
        MySqlConnection con = new MySqlConnection(sCon);

        String query = "Select * from users where username= ?userName and password= ?passWord";
        MySqlCommand cmd = new MySqlCommand(query,con);
        cmd.Parameters.Add("?userName", TextBox1.Text);
        cmd.Parameters.Add("?passWord", TextBox2.Text);
        cmd.Prepare();
        MySqlDataReader print = cmd.ExecuteReader();
        bool read = print.Read();
        if(username.Equals(print.GetString("1")) && password.Equals(print.GetString("2"))) return true;
    }
    catch (Exception ex)
    {
        Label1.Text = ex.ToString();
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:18:05.177

您在调用 ExecuteReader 方法之前没有打开连接。呼叫 con.Open。您的问题将得到解决。

# javascript - Javascript中的下划线？

> ID：13109967
> 
> 赞同：1
> 
> 时间：2012-10-28T15:06:08.050
> 
> 标签：javascript, css, pseudo-class

意识到你不能有一个内联伪类——[如何在内联 CSS 中编写 a:hover？](https://stackoverflow.com/questions/1033156/how-to-write-ahover-in-inline-css)-- 我考虑让 Javascript 对`onMouseOver`和`onMouseOut`事件做同样的工作来模拟`:hover`伪类。当鼠标在文本上方时，我试图从文本中删除下划线。是否有人可以提供可以做到这一点的 Javascript 片段？

我试过`onMouseOver="this.style.textDecoration="none""`了，但我认为对比鲜明的引文把一切都抛诸脑后了。

有任何想法吗？

注意：不幸的是，必须在不使用外部或内部样式表（仅限内联）的情况下实现此效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T15:09:36.550

你可以这样做

```
 onMouseOver="this.style.textDecoration='none';" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T15:09:59.187

这是你的答案：

```
<a onmouseover="this.style.textDecoration='none';"  onmouseout="this.style.textDecoration='underline';">hover me</a> 
```

如果你能够使用 jQuery 会更容易。只需编写一次以下代码。那时您无需更改标记。

```
<script type="text/javascript">
(function($) {
    $( function() {
        $('a').hover(
            function() {
                $(this).css('text-decoration','none');
            },
            function() {
                $(this).css('text-decoration','underline');
            }
        )
    } );
} (jQuery));
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-25T21:48:41.880

我认为你不应该使用 javascript，而是 CSS：

```
.underlineHover:hover {
    text-decoration: underline;
} 
```

```
<span class="underlineHover">Content</span> 
```

**注意**：我使用了类`underlineHover`，但请注意类应该具有语义而不是样式。

# python - 使用python从文件中编译和拆分字符串

> ID：13109968
> 
> 赞同：0
> 
> 时间：2012-10-28T15:06:12.693
> 
> 标签：python, regex, string, split, python-3.3

如何从文件的选定行编译字符串，对字符串运行一些操作，然后将该字符串拆分回原始行到同一个文件中？

我只需要文件的某些行。我无法对文件的其他部分进行操作。我创建了一个类，将这些行与文件分开并在这些行上运行操作，但我认为在包含可用于这些操作的文件部分的单个字符串上运行这些操作会更快...

或者，如果我可以在整个字典上运行这些操作，那也会有所帮助。这些操作是字符串替换和正则表达式替换。

我正在使用 python 3.3

* * *

编辑：我将在这里更详细地解释这一点，因为我的原始帖子是如此含糊（感谢 Paolo 指出这一点）。

例如，如果我想修复一个 SubRipper（.srt 文件），它是一个常见的字幕文件，我会将这样的内容作为输入（这是来自一个实际的 srt 文件）：

在这里你可以找到正确的例子，在这里提交文件内容会弄乱换行符： http: [//pastebin.com/ZdWUpNZ2](http://pastebin.com/ZdWUpNZ2)

...然后我只会修复那些具有实际字幕行的行，而不是那些排序号行或字幕文件的隐藏/显示行。所以我编译的字符串可能是：

“他们在那个山脊上。|他们把我们固定住了。”

然后我会对该字符串运行操作。然后我必须将这些行保存回文件。修复这些字幕行后，如何将它们恢复到原始文件中？我可以使用“|”拆分我编译和固定的字符串 作为行分隔符并将它们放回原始文件，但是我如何确定哪一行在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T16:47:32.797

您可以使用[`pysrt`](https://github.com/byroot/pysrt/tree/python3)编辑 SubRip 文件：

```
from pysrt import SubRipFile

subs = SubRipFile.open('some/file.srt')

for sub in subs:
    # do something with sub.text
    pass

# save changes to a new file
subs.save('other/path.srt', encoding='utf-8') 
```

# codeigniter - Codeigniter 获取行

> ID：13109969
> 
> 赞同：0
> 
> 时间：2012-10-28T15:06:20.810
> 
> 标签：codeigniter

我为我的网站使用 codeigniter，但我有一个问题，我已经完成了从不同表返回行的脚本。但它给我写了错误**Trying to get property of non-object**。这是我的代码。哪里有问题？

```
 $this->db->select('*');
      $this->db->from('orders');
      $this->db->where('order_id',$order_id);
      $array_keys_values = $this->db->get();
      $row = $array_keys_values->row();

      $this->db->select('*');
      $this->db->from('pacients');
      $this->db->where('pacient_account_id',$row->order_pacient_id);
      $array_keys_values2 = $this->db->get();
      $row2 = $array_keys_values2->row();

      $this->db->select('*');
      $this->db->from('doctors');
      $this->db->where('doctor_account_id',$doctor_id);
      $array_keys_values3 = $this->db->get();
      $row3 = $array_keys_values3->row(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T16:55:56.897

尝试

```
$this->db->select('*');
$this->db->from('orders');
$this->db->where('order_id',$order_id);
$array_keys_values = $this->db->get();    
if ($array_keys_values->num_rows() > 0) {
    foreach ($array_keys_values->result() as $row) {
       // now you can work with $row
    }
}

$this->db->select('*');
$this->db->from('pacients');
$this->db->where('pacient_account_id',$row->order_pacient_id);
$array_keys_values2 = $this->db->get();
if ($array_keys_values2->num_rows() > 0) {
    foreach ($array_keys_values2->result() as $row2) {
        // now you can work with $row2
    }
}

$this->db->select('*');
$this->db->from('doctors');
$this->db->where('doctor_account_id',$doctor_id);
$array_keys_values3 = $this->db->get();
if ($array_keys_values3->num_rows() > 0) {
    foreach ($array_keys_values3->result() as $row3) {
        // now you can work with $row3
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:31:37.147

没有返回任何行。使用 num_rows() > 0 的 if 语句进行检查

# eclipse-plugin - GMF 模型和表格视图

> ID：13109971
> 
> 赞同：2
> 
> 时间：2012-10-28T15:06:31.057
> 
> 标签：eclipse-plugin, eclipse-gmf

我被赋予了这项任务，如果有人真的提供帮助，我将不胜感激。我通过GMF搭建了一个Graphical Model，如下图；

![在此处输入图像描述](../Images/4001237adab7d0ccc6d1dfae89cd17c9.png)

如您所见，模型中的一个节点已被选中。这里的任务是创建一个带有表格的 Eclipse 视图，该表格将在选择所谓的“城市节点”时自动更新。正如您可能从模型中猜到的那样，该表应该包含到所有城市的路径成本。稍后我将扩展我的解决方案以包含修改后的 Dijkstra 算法，但现在我被困在创建表格视图中。

我尝试使用 TableViewer 构建它，但它似乎相当复杂，因为我们需要在 ContentProvider 上设置表格的输入，但这里的扭曲是因为我们需要一个 SelectionListener 来获取城市坐标（因为它被命令计算路径-通过两个连接城市之间的距离除以图中连接街道上显示的最大速度的成本）以及当前选择的城市，路径成本需要在收到时自动计算并显示在表格中的点击事件。这意味着我们需要以某种方式更新将在每次选择更改时传递给 ContentProvider 的输入。

有关更多信息，我通过 ISelectionListener 接口的 selectionChanged 方法获取当前选择，并在此方法中将城市信息放入数组列表中。但是，尽管我在方法之外将这个数组列表声明为公共的，但我似乎无法从方法外部访问它，因此无法将它传递给 contentProvider。最终无法更新表的输入。我试着把这篇文章写得尽可能简单，希望你们能帮助我。由于我现在无法预见应该做什么，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T11:24:10.910

你在正确的轨道上！

在您的选择侦听器的`ISelectionListener.selectionChanged`方法中，您只需为查看器设置新的输入`TableViewer.setInput`。然后，`IStructuredContentProvider.inputChanged`在内容提供者上为查看者调用该方法。在这里，您可以使用新输入来完成您的工作，并使用`TableViewer.refresh`.

您也可以使用 JFace 数据绑定框架，但我认为您应该可以接受我上面提到的内容。

# simplepie - 简单的馅饼“set_item_limit”没有

> ID：13109975
> 
> 赞同：0
> 
> 时间：2012-10-28T15:07:03.320
> 
> 标签：simplepie

我正在努力让 set_item_limit 工作。提要很好，但只是呈现每个帖子。这是我正在使用的代码：

```
// Make sure SimplePie is included. You may need to change this to match the location of autoloader.php
// For 1.0-1.2:
#require_once('../simplepie.inc');
// For 1.3+:
require_once('php/autoloader.php'); 
// process this feed with all of the default options.
$feed = new SimplePie(); 
// Set which feed to process.   http://simplepie.org/blog/feed/
$feed->set_feed_url('https://api.twitter.com/1/statuses/user_timeline.rss?screen_name=Tweet_Yourself'); 
// Run SimplePie.
$feed->set_item_limit(5);
$feed->init(); 
// This makes sure that the content is sent to the browser as text/html and the UTF-8 character set (since we didn't change it).
$feed->handle_content_type(); 
```

这是 HTMLy 位：

```
<?php
//loop through all of the items in the feed, and $item represents the current item in the loop.
foreach ($feed->get_items() as $item): ?>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td width="100" align="left"><img src="sitewise/Tweet_Yourself_avatar.gif" alt="TweetYourself Twitter Feed" /></td>
        <td>
            <div class="item">
                <h3><i><a href="<?php echo $item->get_permalink(); ?>"><?php echo $item->get_title(); ?></a></i></h3>
                <?php echo $item->get_description(); ?>
                <p><small>Posted on <?php echo $item->get_date('j F Y | g:i a'); ?></small></p>
                <hr />
            </div>
        </td>
      </tr>
    </table>

<?php endforeach; ?> 
```

桌子不是问题！

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T03:02:47.460

问题是

```
$feed->set_item_limit(5); 
```

用于合并提要而不是单个提要....您需要

改变

```
foreach ($feed->get_items() as $item): ?> 
```

至

```
foreach ($feed->get_items(0, 5) as $item): ?> 
```

这会将其限制为 5 个项目

[SimplePIE Get_ITEMS](http://simplepie.org/wiki/reference/simplepie/get_items)

# java - 如何实例化泛型参数化类

> ID：13109979
> 
> 赞同：3
> 
> 时间：2012-10-28T15:07:12.523
> 
> 标签：java, generics

我只是实现了一个`MapBuilder`简单的构建地图，但是当我尝试获取HashMap.class的实例时，我突然发现我无法使用HashMap.class来获取这样的实例。

这是违法的！

那么谁能告诉我为什么以及如何解决这个问题？

MapBuilder 如下：

```
import java.util.Map;

public abstract class MapBuilder {

    public static <K, V, T extends Map<K, V>> InnerMapBuilder<T, K, V> start(
            Class<T> clazz) {
        return new InnerMapBuilder<>(clazz);
    }

    public static class InnerMapBuilder<T extends Map<K, V>, K, V> {

        private T target;

        public InnerMapBuilder(Class<T> clazz) {
            try {
                target = clazz.newInstance();
            } catch (InstantiationException | IllegalAccessException e) {
                throw new RuntimeException(e);
            }
        }

        public InnerMapBuilder<T, K, V> put(K key, V val) {
            target.put(key, val);
            return this;
        }

        public T get() {
            return target;
        }
    }
} 
```

测试代码如下：

```
public static void main(String[] args) {
    HashMap<String, String> v = start(HashMap<String,String>.class).put("a", "b").get();
    System.out.println(v);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:39:46.320

正如 Reimeus 所说，不可能获得泛型类型的参数化类类型变量。所以你有三个选择。

首先，您可以接受未经检查的演员表：

```
Class<? extends Map<String, Integer>> clazz = 
    (Class<? extends Map<String, Integer>>) HashMap.class; 
```

其次，您可以通过扩展类来具体化*类*的参数（在本例中，使用匿名内部类）：

```
Class<? extends Map<String, Integer>> clazz =
     new HashMap<String, Integer>() {}.getClass(); 
```

或者第三个，也是最好的，只取`Map`实例而不是`start()`. 您不会通过获取 的`Class`而不是实例来为用户节省任何工作，而`Map`您要做的第一件事就是创建它的实例。

通过传入它，用户甚至可以调整地图的设置（例如，对于 a `HashMap`，设置负载因子，对于`TreeMap`，指定`Comparator`），因此无论如何它是一个更好的选择。如果需要，可以在传入时断言它为空。

如果出于某种原因您确实需要工厂，请不要使用`Class`: 它作为工厂效果不佳，因为您可以自定义`Class`创建的实例的唯一方法是子类化该类并提供新的无参数构造函数。只需创建一个`Factory<T>`具有方法的接口，`T create()`然后接受一个`Factory<? extends Map<K, V>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:14:14.807

首先，由于`start`需要一个类，您必须将它传递给一个未参数化的类，例如`HashMap.class`. 其次，当您返回泛型类型`Map`时，您还必须使本地类型匹配，因此要使用：

```
Map<String, String> v = start(HashMap.class).put("a", "b").get(); 
```

# java - 使用准备好的语句返回时间戳

> ID：13109982
> 
> 赞同：2
> 
> 时间：2012-10-28T15:07:21.590
> 
> 标签：java, mysql, spring, jdbc, timestamp

我有一个自动生成的时间戳，每次在 mysql 表中插入或更新记录时都会创建该时间戳。有没有办法以类似于我如何使用密钥持有者返回新创建的 ID 的方式返回此时间戳？

```
KeyHolder keyHolder = new GeneratedKeyHolder();
JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);

//Insert Contact
jdbcTemplate.update(new PreparedStatementCreator() {
    @Override
    public PreparedStatement createPreparedStatement(Connection connection) throws SQLException {
        PreparedStatement preparedStatement = connection.prepareStatement(SQL_ADD, Statement.RETURN_GENERATED_KEYS);
        preparedStatement.setString(1, contact.getFirstName());
        preparedStatement.setString(2, contact.getLastName());
        preparedStatement.setInt(3, contact.getOrganizationId());
        preparedStatement.setString(4, contact.getType());
        preparedStatement.setInt(5, contact.getUserId());
        return preparedStatement;
        }   
}, keyHolder);
//Use keyholder to obtain newly created id
contact.setId(keyHolder.getKey().intValue()); 
```

有什么方法可以返回新的时间戳而不必重新查询表？我一直在寻找将它与 id 一起作为密钥持有者中的密钥返回的方法，但它似乎没有作为密钥返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T11:59:32.730

不是很令人满意，但我认为“不”是您问题的答案。我不知道任何 Spring 的东西，但我认为这是由于它包装的基本 JDBC。请参阅[http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#getGeneratedKeys%28%29](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#getGeneratedKeys%28%29)

您唯一的选择是在 MySQL 上创建一个具有 out 参数的存储过程并调用它。请参阅[http://dev.mysql.com/doc/refman/5.0/en/call.html](http://dev.mysql.com/doc/refman/5.0/en/call.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T14:48:51.010

在 MySQL 数据库服务器端解决此问题的选项很少。`TRIGGER`您可以从在桌子上创建一个开始。由于`TRIGGER`有限制且无法返回数据，您可以将`TIMESTAMP`值设置为变量：

```
DEMILITER //
CREATE TRIGGER ai_tbl_name AFTER INSERT ON tbl_name
FOR EACH ROW
BEGIN

SET @TimeStamp = NEW.timestamp_column;

END;//
DELIMITER ; 
```

要检索此时间戳值，请运行以下命令：

```
SELECT @TimeStamp; 
```

由于变量存储在内存中，因此无需再次打开任何表。

你走得更远。您可以在 MySQL 中创建一个`STORED PROCEDURE`来自动执行上述所有操作（示例代码，因为我不知道您的表的详细信息）：

```
DELIMITER //
DROP PROCEDURE IF EXISTS sp_procedure_name //
CREATE PROCEDURE sp_procedure_name (IN col1_val VARCHAR(25),
                                    IN col2_val VARCHAR(25),
                                    IN col3_val INT)
BEGIN
    INSERT INTO tbl_name (col1, col2, col3)
    VALUES (col1_val, col2_val, col3_val);

    SELECT @TimeStamp;
END; //
DELIMITER ; 
```

您可以使用以下代码运行此过程：

```
CALL sp_procedure_name(col1_val, col2_val, col3_val); 
```

由于我不熟悉 Java，因此您需要使用自己的代码来完成它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:11:43.783

`GeneratedKeyHolder`也有两种方法：`getKeyList()`即返回`Map<String,Object>`生成的字段；并`getKeyList()`为所有受影响的行生成生成键的列表。

[请参阅GeneratedKeyHolder](http://static.springsource.org/spring/docs/3.1.0.RELEASE/javadoc-api/org/springframework/jdbc/support/GeneratedKeyHolder.html)的 java 文档和[自动生成密钥的 Spring 教程](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/jdbc.html#jdbc-auto-genereted-keys)

此外，Spring 的 SimpleJdbcInsert 具有生成密钥检索的方法。另见方法[SimpleJdbcInsert#usingGeneratedKeyColumns](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/core/simple/SimpleJdbcInsert.html#usingGeneratedKeyColumns%28java.lang.String...%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T16:23:17.047

该变量似乎`contact`是新插入记录的实例。由于它包含新生成的`id`（主键）字段值，因此您可以执行新查询以返回`timestamp`此新的所需字段值`id`。

查询可能如下所示：

```
select timestamp_field from my_table where id=? 
```

用于`PreparedStatement`输入新`id`值并执行它以获取所需`timestamp`的字段值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T07:01:36.690

类中有 2 种方法`java.sql.Connection`导致 PreparedStatement 执行返回选定的键列：

```
PreparedStatement prepareStatement(String sql,
                                   int[] columnIndexes)
                                throws SQLException

PreparedStatement prepareStatement(String sql,
                                   String[] columnNames)
                                   throws SQLException 
```

您不需要使用 Spring KeyHolder 和 JDBCTemplate 来执行此操作。
给希望您可以编号/命名您的时间戳列。但是 javadoc 不要求或不建议任何 JDBC 实现都可以返回非键列，因此您对这种方法不走运：

> *创建一个默认的 PreparedStatement 对象，该对象能够返回给定数组指定的自动生成的键。此数组包含目标表中包含应返回的自动生成键的列的名称。*

* * *

*   正如另一个答案中所建议的那样，可以切换到完全符合您要求的存储过程（CallableStatement 实际上是执行存储过程的 PreparedStatement - 即子类）。

*   可以通过 new 填充准备好的语句中的时间戳列`Timestamp(new Date())`- 但您应该有一种机制来在各种服务器之间同步时间（通常在 windows 和 *nix 环境中使用）。仅当尚未提供值时，您的触发器才能设置时间戳。

作为您的应用程序和数据库设计的一部分，您需要遵循特定操作发生位置的理念。如果数据库派生所需的数据，应用程序需要刷新数据 - 您必须支付单独的查询执行或插入和检索的组合存储过程的代价。

# excel - 使用 Java + Excel 计算大 O 函数

> ID：13109983
> 
> 赞同：1
> 
> 时间：2012-10-28T15:07:25.063
> 
> 标签：excel, big-o

我一直在尝试使用 java 和 excel 获得四种不同功能的大 O。我不知道这些功能是什么，因为它们被隐藏了。我不确定这是否是正确的地方/论坛问。

我有使用一些java提供各种数据并将它们与步骤（1-n）一起放入excel的功能。然后，如果输出始终相同，我只使用 n 和它们所花费的时间的任意度量立即将它们放入图表中。例如，如果 n = 1 每次运行时总是等于 200。对于每次运行函数时都会发生变化的函数，我运行了 10 次函数并为每一步取平均值。

获得数据后，我为每个数据创建了一个图表，并在其上放置了一条趋势线。例如，我的 f(1) 最适合于多项式趋势线阶 2，我假设它是大 O? 的二次 (n2)。但我需要证明它是 n2，所以我做了 =Steps/LOG(N)，这使它最适合多项式趋势线阶 3，我假设它是 Cubic (n3)？（那正确吗？）

我真的不知道接下来要做什么来“证明”这个函数是二次函数或三次函数，或者如何证明它的最佳情况/最坏情况。

所以基本上我想弄清楚缺少的步骤是什么。

计算图趋势线？？？- 证明该函数具有大 O(?)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T15:30:49.710

当您说“如果 n=1 始终等于 200”时，这是否意味着如果 n=1 需要 200*步*才能运行？如果是这种情况，这个函数将是 200n 和这个 O(n)。

我认为要解决这个问题，您应该在不同的值上调用每个函数（我会从 10、20、30 ... 等开始）直到某个较高的数字。捕获这些值并在 Excel 中绘制它们。然后使用内置的趋势线功能。这应该可以让您粗略估计运行时间。从那里你应该能够得到Big-O。

# roles - 如何在“基于角色的访问控制”模型上实现“用户可以删除自己的帖子”？

> ID：13109990
> 
> 赞同：3
> 
> 时间：2012-10-28T15:08:09.930
> 
> 标签：roles, access-control, rbac

我已经阅读了一些关于[基于角色的访问控制的](http://en.wikipedia.org/wiki/Role-based_access_control)文章，但是对于处理这种情况还不够清楚：如何实现“用户可以删除自己的帖子”？

对于普通的角色和权限，当用户做某事时，我可以检查用户是否拥有角​​色和权限，判断用户是否可以做。

但是对于“用户可以删除自己的帖子”，我必须检查帖子是否属于他。所以我必须硬编码一些东西，然后它就脱离了控制系统的控制。

我是否错过了什么以及如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T15:15:04.317

我并不完全清楚您要解决什么问题。你总是必须“硬编码”一些东西，因为你需要定义谁可以访问什么。如果您决定它应该在控制系统中，那么它也不会超出控制系统，这实际上取决于您的实施。

对于您要执行的操作，我通常会定义一个“所有者”角色，然后定义一个访问权限，例如：

```
"owner" can "delete" "resource" 
```

因此，必须有一些程序化部分，您可以在其中找出用户是否确实是所有者。通常，这可以通过将每个资源与例如“ownerId”属性相关联来完成。如果 userId == ownerId，则当前用户的角色是“所有者”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T15:48:40.567

这需要 RBAC 层对“业务规则”的支持。当这种情况可用时，它会为您提供所需的动态决策。基本上，biz 规则是每次检查权限时运行的一段代码。此代码是静态的，但希望将参数传递给它。这是一个示例（显示 PHP）：

```
// This code expect two given parameters: $params['owner_id'] and $params['user_id']
if ($params['owner_id'] == $params['user_id']) {
  return true;
}
return false;
// This code assumes that returning true means 'permission granted' and returning 
// false means permission not granted 
```

你没有说明你的底层技术。这可以帮助您获得更准确的答案。

# macos - 如何对名称以“-”开头的文件使用通配符？

> ID：13109993
> 
> 赞同：4
> 
> 时间：2012-10-28T15:08:16.033
> 
> 标签：macos, bash, shell

有些文件的名称以“-”开头，例如“-1.png”、“-2.png”。我不能用通配符操作它们，因为这些名称被视为选项：

```
bash-3.2$ ls *.png
ls: illegal option -- .
usage: ls [-ABCFGHLOPRSTUWabcdefghiklmnopqrstuwx1] [file ...]
bash-3.2$ rm *.png
rm: illegal option -- 1
usage: rm [-f | -i] [-dPRrvW] file ...
       unlink file 
```

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T15:12:59.333

要么使用

```
ls -- *.png 
```

或者

```
ls ./*.png 
```

双破折号是 GNU 工具中表示选项结束的常用选项：任何以破折号开头的后续单词都是一个普通参数。 `rm`以同样的方式工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T15:12:51.593

使用`--`：

```
ls -- *.png 
```

它表明接下来的不是选项。

> `--`
> 分隔选项列表。后面的参数（如果有）被视为操作数，即使它们以 . 开头`-`。例如，`sort -- -r` 从名为`-r`.

# cakephp - Cakephp 如何更改数据库连接

> ID：13109994
> 
> 赞同：5
> 
> 时间：2012-10-28T15:08:16.500
> 
> 标签：cakephp

我有 2 个控制器，普通用户的 ContentController 和管理员的 ManageController。我需要将连接从默认更改为管理员，并且我的 database.php 中有此代码

```
class DATABASE_CONFIG {

    public $default = array(
        'datasource' => 'Database/Mysql',
        'persistent' => false,
        'host' => 'localhost',
        'login' => 'user',
        'password' => '',
        'database' => 'ComputerScience',
        'prefix' => '',
        'encoding' => 'utf8',
    );

    public $admin = array(
        'datasource' => 'Database/Mysql',
        'persistent' => false,
        'host' => 'localhost',
        'login' => 'admin',
        'password' => '',
        'database' => 'ComputerScience',
        'prefix' => '',
        'encoding' => 'utf8',
    );
} 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T16:20:55.803

因此，在您的模型中，您将使用 useDbConfig 属性：

```
class Example extends AppModel {
    public $useDbConfig = 'admin';
} 
```

在控制器内部，只需使用：

```
$this->ModelName->useDbConfig = 'admin'; 
```

就这样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-29T14:05:42.330

我会使用[`Model::setDataSource()`](http://api20.cakephp.org/class/model#method-ModelsetDataSource)而不是仅仅设置数据库配置变量。这是因为更改数据源会带来其他可能的更改：

```
$this->Model->setDataSource('admin'); 
```

# oop - 包含域对象的域数据结构？

> ID：13109995
> 
> 赞同：1
> 
> 时间：2012-10-28T15:08:17.797
> 
> 标签：oop, domain-driven-design, encapsulation, ddd-repositories, law-of-demeter

我有一个职位，以及一些使用职位作为标识符的实体（地理、生物群落等）。如果我想访问它们，我需要按位置检索每一个，这会导致重复代码。另一方面，我可以创建一个作为容器的类，例如“位置”。但是，在这种情况下，要检索地理（例如），我需要打破得墨忒耳定律。

```
Repository.getLocation().getGeography().getHighestPeak(); 
```

有没有其他方法可以解决这个问题，或者我缺少一个常见的模式？请记住，这种类型的对象（以我描述的方式与位置相关）很可能在几个月后大量增长。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T12:41:50.620

我不确定将职位作为 ID 是否是个好主意

*   实体的位置可能会发生变化，从而导致标识符不稳定。

*   您将无法拥有具有相同位置的给定实体的多个实例。

> 另一方面，我可以创建一个作为容器的类，例如“位置”。但是，在这种情况下，要检索地理（例如），我需要打破得墨忒耳定律。
> 
> Repository.getLocation().getGeography().getHighestPeak();

您基本上是在说*Location 有一个 entity*，这有点尴尬。*说一个实体有一个职位*似乎更自然。怎么样

```
GeographyRepository.getGeographyByPosition(new Position(...)).getHighestPeak(); 
```

?

# java - 解析输入而不使用 System.in.read()

> ID：13109996
> 
> 赞同：4
> 
> 时间：2012-10-28T15:08:27.110
> 
> 标签：java, input, io

我很难找到有关确切`System.in.read();`工作原理的详细信息，也许有人可以帮助我。似乎 Scanner 会更好，但我不允许使用它。

我被分配了一个任务，我应该以 Boolean-Operator-Boolean 形式读取控制台用户输入，例如 T^F 或 T&T via `System.in.read()`，然后简单地打印语句返回的内容。

普通人可能会使用不同的方法，但作业明确指出只有`System.in.read()`和`System.out.println()`被允许。

这是我解决它的尝试：

```
import java.io.*;

public static void main(String[] args) {

  String error = "Reading error, please use T or F";

  boolean a = true;  //char: 84 or 116 for T and t
  boolean b = false; //char: 70 or 102 for F and f
  int userChar1;
  int userOperator;
  int userChar2;
  int chosenOperator = 0;

  try {

    //Get first char
    System.out.println("Enter the first value (T or F):");
    userChar1 = System.in.read();

    if((userChar1==84)||(userChar1==116)) { // T or t
      a = true;
    } else if ((userChar1==70)||(userChar1==102)) { // F or f
      a = false;
    } else {
      System.out.println(error);
    }

    //Get second char
    System.out.println("Select an operator:  &  |  ^");
    userOperator = System.in.read();

    if(userOperator==38) { // &
      chosenOperator = 0;
    } else if (userOperator==124) { // |
      chosenOperator = 1;
    } else if (userOperator==94) { // ^
      chosenOperator = 2;
    } else {
      System.out.println(error);
    }

    //Get third char 
    System.out.println("Enter the second value:");
    userChar2 = System.in.read();
    System.in.close();
    if((userChar2==84)||(userChar2==116)) {
      b = true;
    } else if ((userChar2==70)||(userChar2==102)) {
      b = false;
    } else {
      System.out.println(error);
    }

    //Figure out result
    boolean result;
    switch (chosenOperator) {
    case 0:
      result = a&b;   
    case 1:
      result = a|b;
    case 2:
      result = a^b;

      System.out.println(result);

    }

  } catch(IOException e) {

  }
} 
```

执行此代码使控制台在第一个之后等待用户输入，`System.in.read()`并让它正确检查字符输入。然而，在那之后，所有成功`System.in.read()`的都被忽略并且程序终止。

我找到了一段使用的代码`System.in.close()`，所以仍然不知道我在每次之后拼接的方法到底是什么`System.in.read()`。这导致程序`System.in.read()`在 a 之后的第一个`System.in.close()`被调用时终止。

那么，到底发生了什么？你会如何`System.in.read()`正确使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T16:05:33.737

问题不在于 System.in.read()，而在于控制台。控制台通常是缓冲的，这意味着只有在按下回车键后数据才会发送到您的程序（因此可以由 System.in.read() 读取）。因此，您必须将控制台切换到无缓冲模式，但没有可移植的方式来执行此操作，因为有很多不同类型的控制台（unix shell、cmd 窗口、Eclipse 控制台等）。
如果不允许使用 System.in.read() 和 System.out.println() 方法以外的任何方法，则必须让用户在一行中输入完整的术语，然后按 enter 即可处理字符输入，例如：

```
public static void main(String[] args) throws IOException {
    boolean a = true; // char: 84 or 116 for T and t
    boolean b = false; // char: 70 or 102 for F and f
    int userChar1;
    int userOperator;
    int userChar2;

    System.out.println("Please enter the term, e.g. T&F:");

    userChar1 = System.in.read();
    userOperator = System.in.read();
    userChar2 = System.in.read();

    a = userChar1 == 'T' || userChar1 == 't';
    b = userChar2 == 'T' || userChar1 == 't';

    switch (userOperator) {
    case '&':
        System.out.println(a & b);break;
    case '|':
        System.out.println(a | b);break;
    case '^':
        System.out.println(a ^ b);break;
    default:
        System.out.println("unknow operator");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:19:34.283

查看以下代码部分：

```
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

String input = null;

//  read the input from the command-line; need to use try/catch with the
//  readLine() method
try {
input = br.readLine();
} catch (IOException e) {
      System.out.println("IO error trying to read your input!");
      System.exit(1);
}
System.out.println("your input: "+input); 
```

如果您不允许使用 bufferReader，我建议您查看 bufferReader 的源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T15:50:31.040

就我个人而言，运行你的代码没有问题，但它有一些我必须研究的奇怪效果。

这种方法（使用`System.in.read()`）的主要问题是，当用户输入某个字符时，他必须按下`enter`，因此您有 2 个字符而不是您期望的 1 个字符 - 用户输入的第一个字符（假设 T 或 F 在您的大小写）和换行符。

我设法让您的代码进行了微小的更改。您需要调用`read()`方法的重载版本 -`read(byte[] b)`内容为`some number of bytes from the input stream and stores them into the buffer array`.

这是您的代码的第一部分，已修改：

```
byte[] input = new byte[10];
System.out.println("Enter the first value (T or F):");
System.in.read(input);
userChar1 = input[0];
if ((userChar1 == 84) || (userChar1 == 116)) { // T or t
    a = true;
} else if ((userChar1 == 70) || (userChar1 == 102)) { // F or f
    a = false;
} else {
    System.out.println(error);
} 
```

注意，我们不关心返回什么，我们只关心数组`read()`中的第一个字符。`input`其余代码以相同方式修改，您甚至可以使用相同的缓冲区数组 ( `input`) 并查询第 0 个元素。

# ruby-on-rails - 在 postgresql 迁移期间 Rake 中止

> ID：13109997
> 
> 赞同：1
> 
> 时间：2012-10-28T15:08:30.600
> 
> 标签：ruby-on-rails, postgresql, rake

Rails/PostgreSQL 新手在这里，在处理在 Rails 中创建 PostgreSQL 项目时遇到了真正的问题。

简而言之，我正在关注 Ryan 的优秀 Railscast 剧集，尤其是关于部署的剧集。我创建了一个这样的新项目：

```
rails new blog -d postgresql 
```

这会生成一个`database.yml`类似于以下内容的文件（提取的注释）：

```
development:
  adapter: postgresql
  encoding: unicode
  database: blog_development
  pool: 5
  username: blog
  password:

test:
  adapter: postgresql
  encoding: unicode
  database: blog_test
  pool: 5
  username: blog
  password:

production:
  adapter: postgresql
  encoding: unicode
  database: blog_production
  pool: 5
  username: blog
  password: 
```

到目前为止看起来不错。

但是，在我的开发机器上，每当我尝试运行时`rake db:create:all`，我都会收到类似于以下内容的消息：

```
rake aborted!
FATAL: role "blog" does not exist 
```

我的理解是，这是因为在创建应用程序时我没有（或者更确切地说，Rails 没有）创建一个名为“blog”的用户。因此，我需要：

1.  将所有环境更改`username`为我在安装 Homebrew 时选择的系统的“超级用户”（有效）；或者
2.  为我设置的每个单独项目创建一个新的超级用户（例如，在本例中为超级用户“博客”）。

现在，问题是——我应该为我创建的每个单独项目创建一个超级用户吗？如果是这样，怎么做？我问的原因是 Ryan 的 Railscasts 剧集从未真正提到这一点，所以我不确定这是否是正确的方法（似乎有点冗长），或者我的 PostgreSQL 数据库安装是否有问题（我原以为超级用户会在创建应用程序时与数据库一起自动设置）。

此外，为了使部署更容易，我希望`database.yml`在开发和生产环境中保持整个文件相同（尽管我承认对部署了解更少，所以这可能并不理想）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:18:13.427

创建数据库用户由您决定。Rails 不创建数据库用户。

根据您的平台，您可以使用某种数据库管理 GUI 来更轻松地创建用户和管理他们的权限。我使用 PGAdmin，它附带了用于 PostgreSQL 的 Mac OS X 可执行文件。它也可用于其他平台。

在开发中，许多人对所有项目使用相同的“超级用户”。在生产中，我建议您让特定于应用程序的用户具有最低权限。

我不完全理解关于`database.yml`dev 和 prod envs 的最后一段，因为这正是重点 - 所有环境的一个文件。您可能不应该将相同的凭据用于开发和生产。