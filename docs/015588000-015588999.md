# StackOverflow 问答 15588000-15588999

# spring - Spring：不接受 mvc:resources 下的 POST 请求？如何解决这个问题

> ID：15588001
> 
> 赞同：2
> 
> 时间：2013-03-23T14:40:39.560
> 
> 标签：spring, post

我在我的项目中使用spring框架，

这是我的 web.xml 的一部分：

```
<servlet>
    <servlet-name>SpringMvcServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/servlet-context.xml
        </param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>SpringMvcServlet</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>
<filter>
    <filter-name>httpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>httpMethodFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<error-page>
    <error-code>404</error-code>
    <location>/system/404.html</location>
</error-page>
<error-page>
    <error-code>500</error-code>
    <location>/system/500.html</location>
</error-page> 
```

并配置：

```
<mvc:resources mapping="/system/**" location="/WEB-INF/pages/system/" /> 
```

但是我在日志中发现了很多错误，一些请求是这样的：

*   发布 /index.php
*   发布 /notexists.html

它们在我的服务器中不存在，因此将调用“/system/404.html”，但 mvc:resources 不接受 POST 方法，因此它将返回 500 错误。

如何解决？或解决？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:05:46.540

**首先：我认为您`ResourceHttpRequestHandler`在尝试将其用于 POST 请求时滥用了 。**——如果你让这个处理程序来处理 POST 请求，我不确定每件事是否都能正常工作。

* * *

`<mvc:resources />`配置类的实例`org.springframework.web.servlet.resource.ResourceHttpRequestHandler`。这有超类`WebContentGenerator`，这个超类有一个属性`Set<String> supportedMethods`。

所以你需要做的就是：

```
<property name="supportedMethods">
    <list>
       <value>GET</value>
       <value>HEAD</value>
       <value>POST</value>
    </list>
</property> 
```

不幸的是，这需要您`ResourceHttpRequestHandler`手动配置而不是使用`<mvc:resources />`

```
<bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
     <property name="urlMap">
         <map>
              <entry key="/system/**" value="myResourceHandler" />
         </map>
     </property>
     <property name="order" value="100000" />       
</bean>

<bean id="myResourceHandler" name="myResourceHandler"
      class="org.springframework.web.servlet.resource.ResourceHttpRequestHandler">
      <property name="locations" value="/WEB-INF/pages/system/" />
      <property name="supportedMethods">
         <list>
            <value>GET</value>
            <value>HEAD</value>
            <value>POST</value>
         </list>
     </property>
     <!-- cacheSeconds: maybe you should set it to zero because of the posts-->
</bean> 
```

*我没有证明这个配置，我只是把它的作用写下来`ResourceBeanDefintionParser`。*

# java - 什么是 Matrix.getMatrix 命令？

> ID：15588002
> 
> 赞同：-1
> 
> 时间：2013-03-23T14:40:41.560
> 
> 标签：java, arrays, matrix, int

我在理解我得到的 java 程序中的一行时遇到了一点问题。该行是：

```
int[][] mat = Matrix.getMatrix(); 
```

*   是什么`Matrix.getMarix`？
*   这意味着什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T14:42:02.110

取决于`Matrix`这条线是什么：

*   调用被调用`getMatrix()`对象的方法`Matrix`，或
*   调用类的`static`方法。`getMatrix()``Matrix`

该方法返回一个 2D 数组`int`，该数组分配给`mat`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T14:43:06.713

```
Matrix.getMatrix(); 
```

`Matrix`是类名，`getMatrix()`是类的静态方法`Matrix`。它的源代码是这样的：

```
public class Matrix
{
    // ...

    public static int[][] getMatrix()
    {
        // ...
    }

    // ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T14:46:28.677

请参阅[此链接](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)：

> Java 编程语言支持静态方法和静态变量。声明中带有 static 修饰符的静态方法应该使用类名调用，而不需要创建类的实例，如
> 
> ClassName.methodName(args)

*Matrix 类*`getMatrix()`的*静态*方法也是如此。

 *我认为这`Matrix`不是一个对象，因为它以大写字母开头（当然，如果您遵循`Java`约定）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T14:45:04.263

[矩阵#getMatrix(int[] r,int[] c);](http://math.nist.gov/javanumerics/jama/doc/Jama/Matrix.html#getMatrix%28int%5B%5D,%20int%5B%5D%29)

> 得到一个子矩阵。*

# javascript - 选项卡内的 Dojo 1.8 网格

> ID：15588003
> 
> 赞同：0
> 
> 时间：2013-03-23T14:40:45.330
> 
> 标签：javascript, dojo, dojox.grid.datagrid, dojox.grid

我是 Dojo 的新手，我只是创建了一个带有选项卡容器的布局**index.php**和一个选项卡调用**list.php**：

```
<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Demo: Progammatic Layout</title>

        <link rel="stylesheet" href="style.css" media="screen">
        <link rel="stylesheet" href="js/dijit/themes/claro/claro.css" media="screen">
                 <link rel="stylesheet" href="js/dojox/grid/resources/claroGrid.css" media="screen">
    </head>
    <body class="claro">
        <div id="appLayout" class="demoLayout"></div>
        <!-- load dojo and provide config via data attribute -->
        <script src="js/dojo/dojo.js"></script>
        <script>
            require(["dijit/layout/BorderContainer", 
                 "dijit/layout/TabContainer", 
                 "dijit/layout/ContentPane", 
                 "dijit/layout/AccordionContainer",
                 "dijit/layout/AccordionPane",
                 "dojox/grid/DataGrid",
                 "dojox/grid/cells",
                 "dojo/ready", 

                 ],
            function(BorderContainer, TabContainer,ContentPane, AccordionContainer, AccordionPane, DataGrid, gridCells, ready){
                ready(function(){
                    // create the BorderContainer and attach it to our appLayout div
                    var appLayout = new BorderContainer({
                        design: "headline"
                    }, "appLayout");

                    // create the TabContainer
                    var contentTabs = new TabContainer({
                        region: "center",
                        id: "contentTabs",
                        tabPosition: "bottom",
                        "class": "centerPanel"
                    });

                    // add the TabContainer as a child of the BorderContainer
                    appLayout.addChild( contentTabs );

                    // create and add the BorderContainer edge regions
                    var header= new ContentPane({
                        region: "top",
                        "class": "edgePanel",
                        content: "Header content (top)",
                        splitter: true
                    });

                    /* Menú */
                    var contentMenu = new ContentPane({
                        region: "left",
                        id: "leftCol", 
                        "class": "edgePanel",
                        content: "",
                        padding:0,
                        splitter: true
                    });

                    var aContainer=new AccordionContainer({style:"height: 300px"}, "markup");
                        aContainer.addChild(new ContentPane({
                            title: "Contact",
                            content: "Hi!"
                        }));
                        aContainer.addChild(new ContentPane({
                            title:"Work",
                            content:"Hi how are you?"
                        }));
                    contentMenu.addChild(aContainer);

                    **var tabs=new ContentPane({
                        href: "list.php",
                        title: "Lista"
                    });**
                    contentTabs.addChild(tabs);

                    appLayout.addChild(header);
                    appLayout.addChild(contentMenu);

                    appLayout.addChild(contentTabs);

                      //aContainer.startup();
                    /*contentAcordion= new AccordionContainer({
                        min-size:20,
                        region:'leading,
                        splitter:true,
                        id:'leftAccordion'
                    });*/

                    // start up and do layout
                    appLayout.startup();

                    var cells = [
                      [
                        new gridCells.RowIndex({ width: "10%" }),
                        { name: "Column 1", field: "col1", width: "30%" },
                        { name: "Column 2", field: "col2", width: "30%" },
                        { name: "Column 3", field: "col3", width: "30%" }
                      ]
                    ];

                    gridLayout = [{
                            type: "dojox.grid._CheckBoxSelector"
                        }, 
                        cells
                    ];

                    var data = [
                        { id: 0, col1: "normal", col2: false, col3: "new", col4: "But are not followed by two hexadecimal"},
                        { id: 1, col1: "important", col2: false, col3: "new", col4: "Because a % sign always indicates"},
                        { id: 2, col1: "important", col2: false, col3: "read", col4: "Signs can be selectively"},
                        { id: 3, col1: "note", col2: false, col3: "read", col4: "However the reserved characters"},
                        { id: 4, col1: "normal", col2: false, col3: "replied", col4: "It is therefore necessary"},
                        { id: 5, col1: "important", col2: false, col3: "replied", col4: "To problems of corruption by"},
                        { id: 6, col1: "note", col2: false, col3: "replied", col4: "Which would simply be awkward in"}
                    ];

                    var grid = new DataGrid({
                    //store: test_store,
                    structure: cells,
                    rowSelector: "20px",
                    "class": "grid"
                    }, "grid");
                    grid.startup();
                });
            });
        </script>
    </body>
</html> 
```

它工作成功，并加载一个list.php。

在 list.php 我有一个创建网格的代码，如果我单独执行它可以工作并成功显示网格：

```
<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Demo: Progammatic Layout</title>

        <link rel="stylesheet" href="style.css" media="screen">
        <link rel="stylesheet" href="js/dijit/themes/claro/claro.css" media="screen">
                 <link rel="stylesheet" href="js/dojox/grid/resources/claroGrid.css" media="screen">
    </head>
    <body class="claro">
        <div id="grid" class="demoLayout"></div>

        <!-- load dojo and provide config via data attribute -->
        <script src="js/dojo/dojo.js"></script>
        <script>
            require([
                "dojox/grid/DataGrid",
                "dojox/grid/cells",
                "dojo/store/Memory",
                "dojo/data/ObjectStore",
                "dojo/_base/array",
                "dojo/_base/lang",
                "dojox/grid/_CheckBoxSelector",
                "dojo/domReady!"
            ], function(DataGrid, gridCells, Memory, ObjectStore, baseArray, lang, _CheckBoxSelector){
                var cells = [
                    [
                        new gridCells.RowIndex({ width: "10%" }),
                        { name: "Column 1", field: "col1", width: "30%" },
                        { name: "Column 2", field: "col2", width: "30%" },
                        { name: "Column 3", field: "col3", width: "30%" }
                    ],[
                        { name: "Column 4", field: "col4", colSpan: 4 }
                    ]
                ];

                gridLayout = [{
                    // First, our view using the _CheckBoxSelector custom type
                        type: "dojox.grid._CheckBoxSelector"
                    }, 
                    cells
                ];

                var data = [
                    { id: 0, col1: "normal", col2: false, col3: "new", col4: "But are not followed by two hexadecimal"},
                    { id: 1, col1: "important", col2: false, col3: "new", col4: "Because a % sign always indicates"},
                    { id: 2, col1: "important", col2: false, col3: "read", col4: "Signs can be selectively"},
                    { id: 3, col1: "note", col2: false, col3: "read", col4: "However the reserved characters"},
                    { id: 4, col1: "normal", col2: false, col3: "replied", col4: "It is therefore necessary"},
                    { id: 5, col1: "important", col2: false, col3: "replied", col4: "To problems of corruption by"},
                    { id: 6, col1: "note", col2: false, col3: "replied", col4: "Which would simply be awkward in"}
                ];

                var objectStore = new Memory({data:data});

                var test_store = new ObjectStore({objectStore: objectStore});

                // create the grids.
                var grid = new DataGrid({
                    store: test_store,
                    structure: cells,
                    rowSelector: "20px",
                    "class": "grid"
                }, "grid");
                grid.startup();

            });
        </script>
    </body>
</html> 
```

但是如果我调用 index.php 网格不显示，我该怎么做呢？为什么是原因，没有没有javascript执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:24:26.353

我将摆脱“您如何解决当前问题”并尝试回答“您如何满足您的要求”。

为此，我假设您的网格内容最终将是动态的并按需交付。如果是这种情况，请将所有网格构建代码放入初始页面加载中，并使用 xhrGet 仅获取数据以填充数据对象（但请参阅后面的段落以节省不必要的编码）。

数据应作为 json 字符串化对象从您的 php 代码传递（构建数组以从 php 传递，然后使用`json_encode(utf8_encode(data_array))`

IIRC（已经有一段时间了）您应该能够将 url 作为参数传递给为网格提供服务的数据对象，如果返回数据的格式正确，它应该会自动加载并显示它。

查看 itemFileReadStore - dojotoolkit.org/reference-guide/1.8/dojo/data/ItemFileReadStore.html

您将使用网格在页面的一半左右进行示例。如果您的意图是将数据发送回服务器或以某种方式允许在客户端中更改它，您可能希望使用 itemFileWriteSore 代替。就个人而言，我一直习惯使用它，以防万一我需要它。开销是最小的。

如果您的代码可能希望在页面加载后重新读取网格数据，那么您将需要再跳几圈，但这仍然很容易做到。

警告..我在这里考虑的是 Zend 1.11，dojo 1.4 术语......但原则将是相同的......它是 dojo 的基础，所以我怀疑他们已经改变了太多的对象数据存储:)

# javascript - jquery 文档在 Javascript 中准备好了吗？

> ID：15588005
> 
> 赞同：7
> 
> 时间：2013-03-23T14:40:58.173
> 
> 标签：javascript

我想将我的javascript代码放在head而不是body中，但是由于head在html文档中的body部分之前加载，我的代码变得无用，因为所有选择器都变得未定义。

在 jquery 中我可以`$(document).ready`用来克服这个问题，但是我不想使用 jquery，我想知道在 javascript 中是否有解决方案。

我试过了：

```
if(document.readyState === "complete") {/*my javascript code */} 
```

和

```
window.onload = function(){/*my javascript code */} 
```

但两者都不起作用，有什么建议吗？提前致谢。

HTML：

```
<div id="section" onClick="shout()">test</div> 
```

JAVASCRIPT：

```
window.onload=function(){
function shout(){
var str = document.getElementById("section").innerHTML;
alert(str);
}
} 
```

# python - 如何使用 Python 在 sqlite3 中查询 unicode 字符串

> ID：15588006
> 
> 赞同：-1
> 
> 时间：2013-03-23T14:40:58.207
> 
> 标签：python, unicode, sqlite

假设我有一个 unicode 字符串`u"Robinson Can\u00f3"`，我使用以下命令将字符串存储在 sqlite3 数据库中：

```
cursor.execute('create table tb (name text)')
cursor.execute('insert into tb values (?)', str') 
```

但是，如果我想从数据库中查询 unicode 字符串 u"Robinson Can\u00f3"，我什么也得不到。

```
cursor.execute("select * from tb where name = '%s'" % str) 
```

但是如果我查询另一个不包含 unicode 的 unicode 字符串，例如 u"Kobe Byrant"，我可以返回条目。

那么谁能告诉我如何使用 Python 处理带有 sqlite3 的 unicode？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T14:43:53.373

执行 SQL 代码时不要*使用*字符串插值。请改用 SQL 参数：

```
cursor.execute("select * from tb where name = ?", (str,)) 
```

这适用于任何涉及参数的数据库交互，而不仅仅是 SQLLite。

# wordpress - WordPress：过滤器优先级不起作用

> ID：15588007
> 
> 赞同：0
> 
> 时间：2013-03-23T14:41:03.967
> 
> 标签：wordpress, filter, hook

我正在尝试在 the_content() 之后添加附件库，但它并没有移到 the_content() 下方，而是移到 the_content() 的顶部

我已将优先级设置为 9999，但仍然无法正常工作。请问有什么想法或建议吗？

```
add_filter('the_content', 'admin_gallery_after_content', 9999);
function admin_gallery_after_content($content)
{
    $admin_gallery = new q2a_rm_front;
    $content .= $admin_gallery->rm_admin_gallery();
    return $content;    
} 
```

# c# - 线程访问 .NET 控件问题

> ID：15588008
> 
> 赞同：0
> 
> 时间：2013-03-23T14:41:06.640
> 
> 标签：c#, .net, multithreading, controls

我有两个看起来像这样的线程

```
pbDB_running = true; // start progress bar

Thread connectDb = new Thread(new ThreadStart(ConnectToDb));
Thread runProgress = new Thread(new ThreadStart(RunpbDB));

connectDb.Start();
runProgress.Start();

connectDb.Join();  //wait untill the connection is done

pbDB_running = false; //stop the progress bar 
```

您可能已经猜到了，ConnectToDb 用于连接数据库，而 runpbDB 用于在界面上运行进度条。进度条 (pbDB) 是在设计视图上通过拖放创建的 Windows.Forms 控件。runProgress 线程正在运行 RunpbDB() ，看起来像这样：

```
private void RunpbDB()
{
    while (pbDB_running)
    {
        if (pbDB.Value == 100) pbDB.Value = 0;
        else pbDB.Value += 1;
    }
    pbDB.Value = 0;
} 
```

当两个线程启动时，我在 RunpbDB() 中得到以下异常：

```
Cross-thread operation not valid: Control 'pbDB' accessed from a thread other than the thread it was created on. 
```

我能做些什么来克服这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T14:49:29.207

你有没有想过使用一个`BackgroundWorker`？这可能会让你的生活更轻松。您可以设置两个，一个用于数据库调用，另一个用于进度条。只听后台工作人员`ProgressChanged`和`RunWorkerCompleted`事件。

有关[MSDN的更多信息](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T14:46:45.333

使用[Control.Invoke](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)方法来解决这个问题。您的整个解决方案将成为

```
private void RunpbDB()
{
    while (pbDB_running)
    {
        Invoke((Action)(()=>{
        if (pbDB.Value == 100) pbDB.Value = 0;
        else pbDB.Value += 1;}));
    }
        Invoke((Action)(()=>{pbDB.Value = 0;});
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T14:46:58.667

您可以使用类似的东西`pbDB.InvokeRequired`，如果是这样，请调用`pbDB.Invoke`以在 UI 线程上执行您的操作。

如果您知道它将始终在与 UI 线程不同的线程上完成，则不需要检查。

[这是有关此操作和其他方法的一些代码的链接。](http://www.codeproject.com/Articles/11848/Another-way-to-Invoke-UI-from-a-Worker-Thread)

你也可以使用[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-23T14:51:05.163

这是微软为其 .NET 技术强加的安全措施。它基本上发生在您从单独的线程访问 winforms 元素时，即不在运行 GUI winforms 的主线程中。解决方案是为您的`RunpbDB`方法创建一个委托。请参阅此处的解决方案[调用任何跨线程代码的最佳方法？](https://stackoverflow.com/questions/711408/best-way-to-invoke-any-cross-threaded-code). 也在这里：[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-23T14:51:49.763

如果您无法访问 .NET 4.0 ，只需让您的生活更轻松并[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)为此使用 a。如果您可以使用 4.0+，请使用 TPL。如果可以使用 4.5，则可以使用新的 async/await 功能。Stack Overflow 上有很多例子。 [这](http://blog.stephencleary.com/2010/06/reporting-progress-from-tasks.html)是 Stephen Cleary 比较它们的链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-23T15:04:38.367

VS 团队在 2.0 中不鼓励涉及 UI 线程时的跨线程操作调用（在此之前，出于安全原因，这是可能的。有两种方法可以克服这个问题。简单的方法是设置静态属性

```
System.Windows.Forms.Control.CheckForIllegalCrossThreadCalls 
```

设置为 false 然后从您的应用程序全局禁用此检查。但是任何人都没有建议这种解决方案，甚至我也没有建议，因为它再次打开了安全漏洞。另一种方式是，在方法中先检查UI控件是否需要Invoke，如果需要则使用控件的invoke方法再次调用当前方法，然后返回。代码可以更好的把我想说的说清楚

```
private void RunpbDB()
    {
        if (pbDB.InvokeRequired)
        {
            pbDB.Invoke(new Action(RunpbDB));
            return;
        }
        while (pbDB_running)
        {
            if (pbDB.Value == 100) pbDB.Value = 0;
            else pbDB.Value += 1;
        }
        pbDB.Value = 0;
    } 
```

# android - 正在进行的呼叫的背景音频 - 可能吗？

> ID：15588009
> 
> 赞同：1
> 
> 时间：2013-03-23T14:41:16.917
> 
> 标签：android, android-intent, android-emulator, broadcastreceiver, telephonymanager

我正在编写一个android应用程序，它应该在 来自特定号码**的呼叫正在进行时播放音频文件..我尝试了很多方法..但一切都顺利**

1.  单独的线程
2.  电话服务的监听器
3.  并行启动服务

有人可以帮我解决这个问题吗？

**更新 ：**

我可以在通话接收时播放 mp3 文件，并且我可以在扬声器上播放它。但是我播放呼叫方的声音有多大都无法听它....无论如何我可以推扬声器流到呼叫流

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:24:08.317

从[这里的 api 文档](http://developer.android.com/guide/topics/media/mediaplayer.html)

> 注意：您只能将音频数据播放到标准输出设备。目前，即是移动设备扬声器或蓝牙耳机。您不能在通话过程中播放对话音频中的声音文件。

因此，从这个和许多其他的答案中，我们可以得出结论，我们无法在通话过程中播放音频。

但是很久以前，根据我使用手机的个人经验，我得到了一个结果，即在通话建立时正在播放音轨，并且同时听到两种声音。所以我认为这取决于手机是否允许，然后你可以玩。

您可以通过实验尝试另一件事。使用不同的路由（免提电话或蓝牙）播放音频。

另一种选择是构建您的自定义 android 构建

# code-behind - 获取ResourceDictionary后面代码的加载实例

> ID：15588010
> 
> 赞同：0
> 
> 时间：2013-03-23T14:41:31.580
> 
> 标签：code-behind, resourcedictionary

我为用户控件创建了一个资源字典，并创建了一个派生自 ResourceDictionary 的类，该类为资源字典中包含的控件管理不同的事件设置器和处理程序。到目前为止一切顺利，一切正常。我的问题是从用户控件访问包含在我的 ResourceDictionary 类中的成员。如何从用户控件访问 ResouceDictionary 对象中的属性？

非常感谢！

本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T16:01:27.790

我终于找到了处理它的方法。我创建了一个资源字典类型的变量，它也处理他的事件。之后，我使用我的变量通过代码将资源字典设置为控件。所以现在，我可以处理在我的资源字典中声明的事件。

如果有人需要查看完成工作所需的代码，请告诉我。

# javascript - Facebook 的 CSS 类名称的“-cx-PRIVATE-”前缀是否受到 Greasemonkey 类型用户脚本的保护？

> ID：15588011
> 
> 赞同：0
> 
> 时间：2013-03-23T14:41:33.937
> 
> 标签：javascript, css, facebook, greasemonkey, userscripts

Facebook 已经开始使用“-cx-PRIVATE-”作为其网站上许多 CSS 类名称的命名前缀。

它似乎是对 Greasemonkey 类型用户脚本的某种保护。

当在 Facebook 网页上查询以“-cx-PRIVATE-”开头的类名并禁止该函数返回任何结果时，Facebook 是否有可能拦截对 document.getElementsByClassName 的调用？或者另一种可能性是他们可以在查询被拦截时更改类名，然后在查询完成后再次将其更改回来

我问这个的原因是在某些情况下，即使我可以在源代码中看到类名以“-cx-PRIVATE-”开头的元素，但是当我尝试通过 javascript 从用户脚本中选择它们时， document.getElementsByClassName 函数不返回任何元素。

有没有人对他们如何做到这一点以及围绕他们的街区工作的任何方式有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-12T13:39:38.610

是的，很有可能覆盖内置函数。以下是 document.getElementsByClassName 的示例：

```
// Cache the original
document.______getElementsByClassName = document.getElementsByClassName;
// Overide the function
document.getElementsByClassName = function(classes){ 
```

[http://jsfiddle.net/nmiddleweek/fj52f7f8/5/](http://jsfiddle.net/nmiddleweek/fj52f7f8/5/)

也许您可以尝试使用其他 DOM 查询函数进行搜索？

但是，我没有解决方法。

缺口

# javascript - JQ 动画进度条

> ID：15588012
> 
> 赞同：0
> 
> 时间：2013-03-23T14:41:43.930
> 
> 标签：javascript, jquery, twitter-bootstrap, jquery-ui-progressbar

我需要在页面加载时创建一个动画进度条，这是我需要的示例： http: [//somnia-themes.com/templates/verendus/shortcodes/progressbar.html](http://somnia-themes.com/templates/verendus/shortcodes/progressbar.html)

我需要显示与上面示例中相同数量的条形图，但它们需要使用条纹图像进行动画处理，我可以使用 CSS，但我需要确保它在所有浏览器中都能正常工作，因此需要使用切片条纹图像。

将不胜感激任何帮助。

或者，我可以使用 Twitter Bootstrap 中的动画进度条（我的网站是使用 Bootstrap 框架构建的），但该进度条的加载方式与上面的 url 不同。有没有办法将此加载功能添加到 Bootstrap？

提前致谢。三吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:02:27.713

[JS Fiddle 条纹进度示例](http://jsfiddle.net/vacNJ/333/)

这是在进度条上使用 .progress-striped 类。

```
<div class="progress progress-striped"> 
<div class="bar" style="float: left; width: 0%; " data-percentage="50"></div>
</div> 
```

# javascript - Jquery无法调用未定义的方法“加载”

> ID：15588014
> 
> 赞同：0
> 
> 时间：2013-03-23T14:41:50.693
> 
> 标签：javascript, jquery

我在按钮切换后使用 jquery 加载谷歌地图：

```
function loadScript() {
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = 'http://maps.googleapis.com/maps/api/js?v=3.11&key=AIzaSyCK3XUMWOH0GIiuj3VeprakKZXoo_nDV08&sensor=true&' +
        'callback=initialize';
    document.body.appendChild(script);
}

(function ($) {
    $(document).ready(function () {
        //Show map on category pages
        $(function () {
            $("#showonmap a").toggle(function () {
                $(this).children("#show_map").hide();
                $(this).children("#hide_map").show();
                //Reveal google maps multi
                //First create empty divs, if they exist don't create them
                if ($("#googlemap_multi").length == 0) {
                    $("#subheadergradient").before('<div class="googlemap_margin"></div><div id="googlemap_multi"></div><div class="googlemap_margin"></div>');
                }
                $(".googlemap_margin").fadeIn("slow", function () {
                    $("#googlemap_multi").animate({
                        height: 400
                    }, "slow", function () {
                        //load google maps
                        loadScript().load();
                    });
                });
            }, function () {
                $(this).children("#hide_map").hide();
                $(this).children("#show_map").show();
                //Hide google maps multi
                $("#googlemap_multi").animate({
                    height: 0
                }, "slow", function () {
                    $(".googlemap_margin").fadeOut("slow");
                });
            });
        });
    });
}(jQuery)); 
```

但这会产生错误：

```
Uncaught TypeError: Cannot call method 'load' of undefined localhost:482
(anonymous function) localhost:482
d.complete jquery.min.js:4
f.fx.step jquery.min.js:4
h jquery.min.js:4
f.extend.tick 
```

所以切换回功能永远不会被执行。

这部分：

```
//Hide google maps multi
$("#googlemap_multi").animate({height: 0},"slow", function(){
    $(".googlemap_margin").fadeOut("slow");
}); 
```

问题是什么？

泰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T14:44:37.903

的结果`loadScript()`没有方法`load()`。它所做的只是加载一个脚本（异步！）。

`load()`你想执行哪个？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T14:45:16.733

你在打电话

```
loadScript().load(); 
```

但是你的方法`loadScript`没有任何`return`声明，所以基本上你是`load`在`undefined`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T14:45:18.083

为什么你试图调用`.load()`一个不返回任何内容的函数？

要么只是调用`loadScript();` ，要么让`loadScript`函数返回一个具有方法的对象`load`。

# eclipse - Eclipse Juno 不允许我安装 XML 编辑器

> ID：15588021
> 
> 赞同：0
> 
> 时间：2013-03-23T14:42:35.597
> 
> 标签：eclipse

我有 Eclipse Juno：

```
Version: 3.7.2
Build id: I20110613-1736 
```

我正在尝试使用此存储库从帮助下的安装软件选项安装 XML 编辑器：

```
http://download.eclipse.org/releases/juno/ 
```

安装时我不断遇到依赖问题：

```
Cannot complete the install because of a conflicting dependency.
  Software being installed: Eclipse XML Editors and Tools 3.4.2.v201211061806-7H7GFeJDxumUrsn5qkiQgOEhsz0p60HAmPyU6VX (org.eclipse.wst.xml_ui.feature.feature.group 3.4.2.v201211061806-7H7GFeJDxumUrsn5qkiQgOEhsz0p60HAmPyU6VX)
  Software currently installed: Eclipse Platform 3.7.0.I20110613-1736 (org.eclipse.platform.ide 3.7.0.I20110613-1736)
  Only one of the following can be installed at once: 
    Core Resource Management 3.8.0.v20120522-2034 (org.eclipse.core.resources 3.8.0.v20120522-2034)
    Core Resource Management 3.8.1.v20121114-124432 (org.eclipse.core.resources 3.8.1.v20121114-124432)
    Core Resource Management 3.8.1.v20120802-154922 (org.eclipse.core.resources 3.8.1.v20120802-154922)
    Core Resource Management 3.7.101.dist (org.eclipse.core.resources 3.7.101.dist)
  Cannot satisfy dependency:
    From: Eclipse Platform 3.7.2.dist-9nF7UHagFqn9pElwWhC90gLz-soEuSGYmtSeiRH (org.eclipse.platform.feature.group 3.7.2.dist-9nF7UHagFqn9pElwWhC90gLz-soEuSGYmtSeiRH)
    To: org.eclipse.core.resources [3.7.101.dist]
  Cannot satisfy dependency:
    From: Eclipse Platform 3.7.0.I20110613-1736 (org.eclipse.platform.ide 3.7.0.I20110613-1736)
    To: org.eclipse.platform.feature.group [3.7.2.dist-9nF7UHagFqn9pElwWhC90gLz-soEuSGYmtSeiRH]
  Cannot satisfy dependency:
    From: Eclipse XML Editors and Tools 3.4.2.v201211061806-7H7GFeJDxumUrsn5qkiQgOEhsz0p60HAmPyU6VX (org.eclipse.wst.xml_ui.feature.feature.group 3.4.2.v201211061806-7H7GFeJDxumUrsn5qkiQgOEhsz0p60HAmPyU6VX)
    To: org.eclipse.wst.xsd.ui [1.2.500.v201203081826]
  Cannot satisfy dependency:
    From: XSD Core Plugin 1.1.700.v201204102147 (org.eclipse.wst.xsd.core 1.1.700.v201204102147)
    To: bundle org.eclipse.core.resources [3.8.0,4.0.0)
  Cannot satisfy dependency:
    From: XML Schema Editor 1.2.500.v201203081826 (org.eclipse.wst.xsd.ui 1.2.500.v201203081826)
    To: bundle org.eclipse.wst.xsd.core [1.1.300,1.2.0) 
```

我应该提到这是在从 Repos 安装的 Ubuntu 12.04 上。我已经完成了全新安装并在删除后清空了我的 Workspace 目录。要删除我做了一个：

```
sudo apt-get remove eclipse-* --purge 
```

然后我运行`autoclean`并删除`clean`了`deborphan`Eclipse 的所有包依赖项。之后我重新安装了它，它重新下载了所有内容。

仍然是相同的依赖问题，我不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T14:59:01.117

你没有 Juno，那就是[3.8 或 4.2](http://wiki.eclipse.org/Older_Versions_Of_Eclipse)。因此更新站点与您的安装不匹配。

在 Ubuntu 上，请不要使用包管理器中的 Eclipse 版本。而是从网站下载它们并将它们安装在您喜欢的任何地方（通过解压缩）。在大多数 Linux 发行版中，打包的 Eclipse 版本已经过时了（您可以从构建 ID 中看到，日期为 2011 年 6 月）。

# spotify - 是否可以在不注册应用程序的情况下从 Web 界面访问播放器 API？

> ID：15588024
> 
> 赞同：0
> 
> 时间：2013-03-23T14:43:03.120
> 
> 标签：spotify

我想使用 spotify play 与艺术家的网站集成。我希望能够访问播放器 API 以播放从 spotify 嵌入的项目，作为组合播放列表的一部分。

这可能吗？

谢谢

保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:32:53.357

我认为您在谈论应用程序 API，它仅在 Spotify 客户端中可用。

但是，[Spotify 播放按钮](https://developer.spotify.com/technologies/spotify-play-button/)可能就是您所追求的。

# javascript - 如何从 JS 方法的“eventCallBack”返回值

> ID：15588025
> 
> 赞同：0
> 
> 时间：2013-03-23T14:43:05.040
> 
> 标签：javascript

如何从 JS 方法的“eventCallBack”返回值

见 JS 函数定义：

```
window.plugins.GCM.register("428641231987", "GCM_Event", this.GCM_Success, this.GCM_Fail); 
```

这里

```
@param senderId - GCM service identifier

@param eventCallback - {String} - Name of global window function that will handle incoming events from GCM
@param successCallback - {Function} - called on success on registering device

@param failureCallback - {Function} - called on failure on registering device 
```

现在我想返回在“GCM_Event”中生成的值

```
var requiredValue = window.plugins.GCM.register("428641231987", "GCM_Event", this.GCM_Success, this.GCM_Fail); 
```

我想要 requiredValue 中的值

# php - 使用带有 rand() 函数的负数？或替代方法

> ID：15588030
> 
> 赞同：-2
> 
> 时间：2013-03-23T14:43:40.803
> 
> 标签：php

我遇到了一个逻辑障碍！

我有一个包含 6 个操作的页面。当您单击一个动作时，它只返回一个真或假。

每个动作都有自己的成功机会，真/假取决于随机生成的数字是高于还是低于动作成功值。

机会值存储在数据库中，例如： **10-20-30-40-50-60**

我使用explode 调用这些值并使用implode 插入它们。

我想要实现的是将这些机会值更改为多 1、少 1 或相同（最多 65），每次单击操作并提交表单时，

这是我尝试过的，但无济于事。

```
<?PHP

//CHANCE 0 (action 1)

if ($chance[0] = 0 ){ 
    $chance[0] = rand(0,1); 

    }elseif ($chance[0] = 1 ){
             $chance[0] = rand(1,2); 

    }elseif ($chance[0] >= 2 ){
             $chance[0] = $chance[0] + rand(-1,1) ; 

    }elseif ($chance[0] >= 65 ){
             $chance[0] = 65;
    }

//CHANCE 1 (action 2)

if ($chance[1] = 0 ){ 
    $chance[1] = rand(0,1); 

    }elseif ($chance[1] = 1 ){
             $chance[1] = rand(1,2); 

    }elseif ($chance[1] >= 2 ){
             $chance[1] = $chance[0] + rand(-1,1) ; 

    }elseif ($chance[1] >= 65 ){
             $chance[1] = 65;
    } 
```

等等..所有机会[0]到机会[5]

然后，

```
$chancearray = array($chance[0], $chance[1], $chance[2], $chance[3], $chance[4], $chance[5]);

$newchancearray = implode("-",$chancearray);

?> 
```

并将其插入数据库。

任何人都可以帮助我在提交表单后将 -1、0 或 1 添加到机会值的逻辑吗？

目前它将所有值更改为 2 ??

所以如果机会是 10-20-30-40-50-60，一旦提交，它就会变成 2-2-2-2-2-2。

帮助？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T14:53:26.487

将 IF 上使用的布尔表达式中的 = 更改为 ==

代替

```
if ($chance[1] = 0 ){ 
```

应该

```
if ($chance[1] == 0 ){ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-23T14:46:21.050

你知道“==”吗？

代码错误

# data-structures - 如何打乱链表中的节点？

> ID：15588033
> 
> 赞同：1
> 
> 时间：2013-03-23T14:43:55.727
> 
> 标签：data-structures, linked-list, nodes, shuffle

我刚刚为我的 Java2 类启动了一个项目，但我已经完全停止了。我只是无法理解这种方法。尤其是当分配不允许我们使用任何其他 DATA STRUCTURE 或 java 中的 shuffle 方法时。

所以我有一个 Deck.class 我已经在其中创建了一个包含 52 个节点的链表，其中包含 52 张卡片。

```
public class Deck {

    private Node theDeck;
    private int numCards;

    public Deck () 
    {
        while(numCards < 52)
        {
            theDeck = new Node (new Card(numCards), theDeck);
            numCards++;
        }
    }

    public void shuffleDeck()
    {           
        int rNum;
        int count = 0;
        Node current = theDeck;
        Card tCard;
        int range = 0;  

        while(count != 51)
        {   
            // Store whatever is inside the current node in a temp variable
               tCard = current.getItem();

            // Generate a random number between 0 -51      
                rNum = (int)(Math.random()* 51);

            // Send current on a loop a random amount of times
               for (int i=0; i < rNum; i ++)
                current = current.getNext();   ******<-- (Btw this is the line I'm getting my error, i sort of know why but idk how to stop it.)

            // So wherever current landed get that item stored in that node and store it in the first on
            theDeck.setItem(current.getItem());

            // Now make use of the temp variable at the beginning and store it where current landed
            current.setItem(tCard);

            // Send current back to the beginning of the deck
            current = theDeck;

            // I've created a counter for another loop i want to do     
            count++;

            // Send current a "count" amount of times for a loop so that it doesn't shuffle the cards that have been already shuffled.   
            for(int i=0; i<count; i++)
             current = current.getNext();  ****<-- Not to sure about this last loop because if i don't shuffle the cards that i've already shuffled it will not count as a legitimate shuffle? i think? ****Also this is where i sometimes get a nullpointerexception****

        }

    }

} 
```

现在，当我调用此方法时，会出现不同类型的错误：

*   它有时只会洗 2 张牌，但有时会洗 3 - 5 张牌，然后给我一个 NullPointerException。我已经在上面的代码中用星号指出了它在哪里给了我这个错误

*   有一次我让它洗了 13 张牌，但每次洗牌时都没有以正确的方式洗牌。一张牌一直在重复。

*   在另一点上，我让所有 52 张卡片都通过了 while 循环，但它又多次重复了一张卡片。

所以我真的需要一些关于我做错了什么的意见。在我的代码结束时，我认为我的逻辑完全错误，但我似乎无法找到解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-14T15:56:06.030

似乎很啰嗦。

我会选择以下内容：

```
public void shuffleDeck() {
    for(int i=0; i<52; i++) {
        int card = (int) (Math.random() * (52-i));
        deck.addLast(deck.remove(card));
    }
} 
```

因此，每张卡都会以随机顺序移动到牌组的后面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T07:55:47.453

如果您被授权使用二级数据结构，一种方法是简单地计算剩余卡片数量内的随机数，选择该卡片，将其移动到二级结构的末尾直到为空，然后用二级替换您的列表列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T12:29:29.683

我的实现使用分治算法对链表进行洗牌

```
public class LinkedListShuffle
{
    public static DataStructures.Linear.LinkedListNode<T> Shuffle<T>(DataStructures.Linear.LinkedListNode<T> firstNode) where T : IComparable<T>
    {
        if (firstNode == null)
            throw new ArgumentNullException();

        if (firstNode.Next == null)
            return firstNode;

        var middle = GetMiddle(firstNode);
        var rightNode = middle.Next;
        middle.Next = null;

        var mergedResult = ShuffledMerge(Shuffle(firstNode), Shuffle(rightNode));
        return mergedResult;
    }

    private static DataStructures.Linear.LinkedListNode<T> ShuffledMerge<T>(DataStructures.Linear.LinkedListNode<T> leftNode, DataStructures.Linear.LinkedListNode<T> rightNode) where T : IComparable<T>
    {
        var dummyHead = new DataStructures.Linear.LinkedListNode<T>();
        DataStructures.Linear.LinkedListNode<T> curNode = dummyHead;

        var rnd = new Random((int)DateTime.Now.Ticks);
        while (leftNode != null || rightNode != null)
        {
            var rndRes =  rnd.Next(0, 2);
            if (rndRes == 0)
            {
                if (leftNode != null)
                {
                    curNode.Next = leftNode;
                    leftNode = leftNode.Next;
                }
                else
                {
                    curNode.Next = rightNode;
                    rightNode = rightNode.Next;
                }
            }
            else
            {
                if (rightNode != null)
                {
                    curNode.Next = rightNode;
                    rightNode = rightNode.Next;
                }
                else
                {
                    curNode.Next = leftNode;
                    leftNode = leftNode.Next;
                }
            }

            curNode = curNode.Next;                     
        }
        return dummyHead.Next;
    }

    private static DataStructures.Linear.LinkedListNode<T> GetMiddle<T>(DataStructures.Linear.LinkedListNode<T> firstNode) where T : IComparable<T>
    {
        if (firstNode.Next == null)
            return firstNode;

        DataStructures.Linear.LinkedListNode<T> fast, slow;
        fast = slow = firstNode;
        while (fast.Next != null && fast.Next.Next != null)
        {
            slow = slow.Next;
            fast = fast.Next.Next;
        }
        return slow;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-02T15:20:18.467

刚刚遇到这个并决定发布一个更简洁的解决方案，它允许您指定要进行多少洗牌。

出于答案的目的，您有一个包含 PlayingCard 对象的链接列表；

```
LinkedList<PlayingCard> deck = new LinkedList<PlayingCard>(); 
```

并使用这样的东西来洗牌；

```
public void shuffle(Integer swaps) {    
    for (int i=0; i < swaps; i++) {
        deck.add(deck.remove((int)(Math.random() * deck.size())));
    }                       
} 
```

你做的交换越多，列表就越随机。

# c++ - 如果有和没有花括号

> ID：15588041
> 
> 赞同：2
> 
> 时间：2013-03-23T14:44:38.840
> 
> 标签：c++, c

我读了一个关于`if`声明的问题

哪个代码更快/相同？

> 如果（a==1）返回0；
> 
> if(a==1) { 返回 0; }

在这种情况下，速度或编译器真的有什么区别吗？

先感谢您。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-23T14:46:16.253

关于运行速度，**它们是完全一样的**。

C++11 标准将第一种形式定义为第二种形式的隐式变体。根据第 6.4/1 段，事实上：

> [...]*选择语句中的子语句* （每个子语句，`else`以语句的形式`if`）隐式定义了一个块范围（3.3）。如果选择语句中的子语句是单个语句而不是*复合语句*，就好像它被重写为包含原始子语句的*复合语句。*[*示例*：
> 
> ```
> if (x)
>     int i; 
> ```
> 
> 可以等效地改写为
> 
> ```
> if (x) {
>     int i;
> } 
> ```
> 
> 因此，在 if 语句之后， i 不再在范围内。—<em>结束示例]

解析额外大括号所需的额外编译时间非常短，可以安全地忽略。**在您的情况下选择使代码更易于阅读或维护的形式**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-23T14:46:19.330

除了在编译时解析大括号所需的微小、微小、微小的额外时间外，性能没有任何差异。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-23T14:46:41.177

运行时速度完全相同。编译速度可能在纳秒级左右存在差异。然而，出于所有实际原因和目的，这两个陈述是相同的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-23T14:46:48.760

两种说法的速度*绝对没有*区别。

**过早的优化**是一件坏事。不要花很多时间担心这些事情。

# c++ - 使用 UTF8CPP 时如何检测空格或数字？

> ID：15588042
> 
> 赞同：0
> 
> 时间：2013-03-23T14:44:44.713
> 
> 标签：c++, unicode

这是我的代码：

```
std::vector<std::string> InverseIndex::getWords(std::string line)
{
  std::vector<std::string> words;

  char* str = (char*)line.c_str();
  char* end = str + strlen(str) + 1;
  unsigned char symbol[5] = {0,0,0,0,0};

  while( str < end ){
    utf8::uint32_t code = utf8::next(str, end);
    if(code == 0) continue;
    utf8::append(code, symbol);
    // TODO detect white spaces or numbers.
    std::string word = (const char*)symbol;
    words.push_back(word);
  }

  return words;
} 
```

* * *

```
Input : "你 好 啊 哈哈 1234"

Output : 
你
??
好
 ??
啊
 ??
哈
哈
 ??
1??
2??
3??
4??

Expected output : 
你
好
啊
哈
哈 
```

无论如何要跳过空格或数字，谢谢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:05:06.650

UTF8-CPP 只不过是一种将字符串编码和解码为/输出 UTF-8 的工具。Unicode 代码点的分类*远远*超出了该工具的范围。为此，您需要使用 Boost.Locale 或 ICU 等严肃的本地化工具。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-24T14:34:55.413

UTF-8 在以下意义上是“ASCII 兼容的”：

如果编码字符串的一个字节等于 ASCII 值 - 例如空格、换行或数字 0-9，这意味着它不是长于一个字节的编码序列的一部分。其实就是这个性格。

这意味着，您可以对 UTF8 字符串中的一个字节执行 isdigit() 操作，就好像它是一个 ASCII 字符串一样，并且保证可以正常工作。

有关更多信息，请参阅[http://utf8everywhere.org](http://utf8everywhere.org)的搜索部分。

# mysql - 如何使用intellij IDE连接grails中的mysql数据库

> ID：15588044
> 
> 赞同：0
> 
> 时间：2013-03-23T14:45:01.430
> 
> 标签：mysql, grails, intellij-idea

我是 grails 和 intellij ide 的新手。我在 intellij 中运行了一个 grails 项目，没关系。但是现在我需要使用mysql数据库而不是默认的。我不知道该怎么做。据我所知，我已经改变了我的数据源类，如下所示>>>

```
dataSource {
    pooled = true
    driverClassName = "com.mysql.jdbc.Driver"
    dialect = "org.hibernate.dialect.MySQL5InnoDBDialect"
    properties {
        initialSize = 5
        maxActive = 10
        minIdle = 5
        maxIdle = 5
        maxWait = 100000
        validationQuery = "select 1"
        minEvictableIdleTimeMillis = 60000
        timeBetweenEvictionRunsMillis = 60000
    }
}
hibernate {
    cache.use_second_level_cache = false
    cache.use_query_cache = false
    cache.provider_class = 'net.sf.ehcache.hibernate.EhCacheProvider'
}
// environment specific settings
environments {
    development {
        dataSource {
            dbCreate = "update" // one of 'create', 'create-drop','update'
            loggingSql = true
            url = "jdbc:mysql://localhost/sbicloud_jan_13"
            username = "root"
            password = "admin"
        }
    }
    test {
        dataSource {
            dbCreate = "update"
            url = "jdbc:mysql://192.168.18.12/sbicloud"
            username = "zia"
            password = "zia123321"
        }
    }
    production {
        dataSource {
        }
    }
} 
```

当我运行应用程序时，控制台中会出现一些错误，第一个错误如下 >>>

```
 Cannot load JDBC driver class 'com.mysql.jdbc.Driver'
java.lang.ClassNotFoundException: com.mysql.jdbc.Driver 
```

谁能帮我解决这个问题？！这对我很有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T15:16:08.927

或多或少有两种方法：

1.  修改您的 BuildConfig.groovy，以便您的应用程序将使用 MySQL。在 BuildConfig 中有一个名为“dependencies”的块

    ```
    dependencies {
         // specify dependencies here under either 'build', 'compile', 'runtime', 'test' or 'provided' scopes eg.

         // runtime 'mysql:mysql-connector-java:5.1.20'
     } 
    ```

    取消注释该行：

    ```
    // runtime 'mysql:mysql-connector-java:5.1.20' 
    ```

    它将下载依赖项。

2.  将 MySQL JDBC 驱动程序放在 grails-app/lib 目录中......我前段时间发布了一篇博文，其中包含相关说明。[看这里](http://www.codeverse.org/2012/09/using-mysql-instead-of-in-memory.html)

# ruby - 如何在不忙于等待的情况下等待布尔值？

> ID：15588047
> 
> 赞同：1
> 
> 时间：2013-03-23T14:45:14.777
> 
> 标签：ruby, boolean, mutex, condition-variable

我有一个使用 DRb 编写的 Ruby 应用程序，其中远程对象向本地对象发出信号，它是通过在本地对象上翻转布尔值来完成的。目前，我等待这样的布尔值：

```
sleep(0.05) until o.done? 
```

这使 CPU 保持在较低水平（~0.2%，不像真正的 100% 的忙等待），快速响应，但感觉不对。应该有更好的方法来等待一个值，或者让我的进程退出“等待”状态。在那儿？

**注意：**重要的是等待代码尽可能多地产生 CPU/告诉操作系统不要调度我们，因为将同时运行重要的 CPU 密集型任务。

# angularjs - Angular 只显示一个自定义元素

> ID：15588057
> 
> 赞同：0
> 
> 时间：2013-03-23T14:46:08.360
> 
> 标签：angularjs, angularjs-directive

我尝试使用 angular.js 创建自定义 html 表单元素。我的想法是我有一个用于表单字段布局的主模板，并粘贴到文本字段、日期字段或其他所需的模板中。

```
var app = angular.module("myApp", []);
app.controller("MainCtrl", function ($scope) {
    $scope.window = window;
});

// create general formfield-layout
function buildFormTemplate(innerTemplate) {
    var t = '<div class="control-group">'
    + '<label class="control-label" for="{{x.id}}">{{x.label}}';
    t += '<span ng-show="x.required" class="required">*</span>',
    t += '</label><div class="controlls">';
    t += innerTemplate;
    t += '</div>';
    t += '</div>';
    return t;
}

app.directive("textfield", function() {
    return {
        restrict: "E",
        scope: {},
        replace: true,
        template: buildFormTemplate('<input id="{{x.id}}" type="text" name="{{x.name}}" value="{{x.value}}" />'),
        link: function(scope, elm, attrs) {
            scope.x = attrs;
        }
     };
}); 
```

这段代码像我预期的那样工作，但如果我有多个文本字段元素，则只呈现一个。其他文本字段元素消失了。

```
<textfield id="myLabel" label="label1" name="mytext1" value="with label"/>
<textfield id="anotherOne" label="label2" name="mytext2" value=""/> 
```

渲染

```
<div class="control-group" id="myLabel" label="label1" name="mytext1" value="with label">
    <label class="control-label ng-binding" for="myLabel">
    label1<span ng-show="x.required" class="required" style="display: none;">*</span></label>
    <div class="controlls">
        <input id="myLabel" type="text" name="mytext1" value="with label">
    </div>
</div> 
```

第二个文本字段消失了。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:41:03.017

关闭标签，它工作正常

```
<textfield id="anotherOne" label="label2" name="mytext2" value=""></textfield> 
```

演示：[http ://plnkr.co/edit/ky0Tpt8qudSLSGho2QAk?p=preview](http://plnkr.co/edit/ky0Tpt8qudSLSGho2QAk?p=preview)

# c++ - 关于初始化列表 C++ 的问题

> ID：15588065
> 
> 赞同：2
> 
> 时间：2013-03-23T14:46:42.487
> 
> 标签：c++

例如，假设我有以下代码；

```
class Foo
{
    public:
    Foo(int x) : _foo(x)
    {

    }

    private:
    int _foo;

    protected:
    std::string _bar;
};

class Bar : public Foo
{
    public:
    Bar() : Foo(10), _temp("something"), _bar("something_else")
    { 

    }
    private:
    std::string _temp;
};

int main()
{
    Bar stool;
} 
```

代码没有运行，因为 _bar 属于 Foo 类并且它似乎不知道它存在，所以这不是你将要如何去做的吗？或者你会在 Foo 的构造函数中有 _bar 吗？这会起作用，但如果 _bar 并不总是必须被分配一些东西怎么办？

编辑：下面是我使用的真实代码；

```
Entity::Entity(GameState *state, bool collidable) 
    :_isLoaded(false), _state(state), alive(true), collidable(collidable),               name(entityDetault) 
```

{

}

```
Entity::Entity(GameState *state, bool collidable, entityName _name)
    :_isLoaded(false), _state(state), alive(true), collidable(collidable), name(_name)
{

} 
```

然后子类将使用此构造函数；

```
Player::Player(GameState *state) 
: Entity(state,true,entityName::entityPlayer), health(100),bulletSpeed(600),_colour(sf::Color(128,255,86,255)) 
```

现在这一切看起来都正确吗？比在构造函数主体中完成所有操作要好一些。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T14:51:12.447

类的构造函数中的成员初始化器列表`C`只能初始化：

*   的直接基类`C`
*   的直接成员`C`
*   的虚拟基类`C` *（不经常出现）*

初始化基类成员的唯一方法是通过基类的构造函数。`C`或者只是放弃初始化，然后在构造函数的主体中进行赋值。但是，后者不能用于`const`成员或引用，并且通常与初始化不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T14:52:19.890

您可以将它从初始化列表移动到正文（如果它不是 const）：

```
Bar() : Foo(10), _temp("something")
{
    _bar = "something_else";
} 
```

或提供第二个（可能受保护的）承包商`Foo`：

```
class Foo
{
public:
    Foo(int x) : _foo(x)
    {

    }

protected:
    Foo(int x,std::string s) : _foo(x), _bar(s)
    {
    }

private:
    int _foo;

protected:
    std::string _bar;
};

class Bar : public Foo
{
public:
    Bar() : Foo(10,"something_else"), _temp("something")
    { 

    }

private:
    std::string _temp;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T14:51:18.697

您需要先初始化基类，然后才能访问它。如果要在基类中初始化成员变量，则必须通过调用基类构造函数来初始化它的成员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-23T14:52:52.267

您可以放入`_bar`'`Foo`构造函数的初始化列表。如果`_bar`并不总是需要分配一些东西，你可以使用默认值。

```
class Foo
{
public:
   Foo(int x):_foo(x)
   {
   }
protected:
   Foo(int x, string s) : _foo(x),_bar(s)
   {

   }

private:
   int _foo;

protected:
   std::string _bar;
};

class Bar : public Foo
{
public:
   Bar() : Foo(10,"something else"), _temp("something")
   { 

   }
private:
  std::string _temp;
}; 
```

# algorithm - 在图上使用 DFS - 确定图是否是具有特定 SCC 的集团

> ID：15588068
> 
> 赞同：0
> 
> 时间：2013-03-23T14:46:51.990
> 
> 标签：algorithm, graph, graph-theory

我有一个关于 DFS 的简单问题，我试图了解如何使用它，而不是如何解决整个问题。我真的在寻找一个解释，而不是我的作业的解决方案。

我先把问题写下来。

> “假设你有一个无向图 G=(V,E) 并让它的三个顶点被称为 v1、v2 和 v3。找到一个算法来确定这三个顶点是否是一个团（完整图）的一部分（k> =3)"

现在我想使用 DFS 来解决它。据我了解，DFS 会让我知道 v1、v2 和 v3 是否在同一个强连接组件中。如果我是正确的，我还应该确定 G 是否也是一个集团（完整图）。

我在互联网上阅读，我发现断言一个图是否是集团是 NP 并且不容易解决。我对么？我错过了什么吗？是否有任何属性可以用来立即确定图表是否完整？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:28:54.323

澄清关于 NP 完全性的混淆：检查一个图是否是一个团不是 NP 完全的；只需计算边缘并查看是否有n（n-1）/ 2。NP完全是在n个顶点的图中找到一个最大团（即具有最大数量的顶点并且是一个团的子图）或k个顶点的团（如果k是输入的一部分而不是a固定号码）；后一种情况称为集团决策问题。

编辑：我刚刚意识到你也问了一些关于强连接组件的问题；该术语仅适用于有向图（即边有一个方向，这意味着对于两个顶点`v`和`w`，边`v->w`与边不同`w->v`）。团通常在无向图上定义，其中只有连通分量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T21:32:42.700

如果我理解正确，您只需检查这三个顶点是否连接，即边 v1-v2、v2-v3 和 v3-v1 是否存在。如果它们存在，它们会形成一个 K=3 的集团。如果其中至少有一个不存在，则这三个顶点一起不能在大小为 k>=3 的团中。

# ios - 用户说iOS应用程序崩溃没有任何进一步的解释

> ID：15588072
> 
> 赞同：3
> 
> 时间：2013-03-23T14:47:10.010
> 
> 标签：ios, crash

我在 iTuens 中有一个非常受欢迎的应用程序，用户正在写差评，说该应用程序有时会在没有任何理由或解释的情况下崩溃。

我已经在模拟器和真实设备上测试了该应用程序。它对我来说很好，并且 xCode 中也没有内存泄漏。

在这种情况下我能做些什么来修复崩溃？是否有任何我可以在应用程序中实现的崩溃报告 API，以便用户可以在应用程序中将崩溃日志发送给我？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-23T22:17:22.883

有多种选择，有些是完全开源的，有些是部分开源的，有些是免费的，有些是付费的。

iTunes Connect 大多不起作用。原因是：

*   在较旧的 iOS 版本中，人们需要将设备同步到 iTunes，然后将崩溃报告上传到 iTunes Connect。但这些用户在设置设备时必须同意“向 Apple 发送匿名使用和诊断数据”。大多数人只是不允许这样做。
*   在较新的 iOS 版本（我认为它始于 iOS 6）中，设备将崩溃报告直接发送到 iTunes Connect。但同样在这种情况下，用户在设置设备时必须批准“发送匿名使用和诊断数据”。大多数人只是不允许再次这样做。您可以在“设置”应用程序中检查自己是否允许`General`，`About`然后向下滚动至`Diagnostics & Usage`。

因此，获取崩溃报告的最佳方法（遗憾的是）是在您的应用程序中包含一个崩溃报告库。由于隐私原因，您应该允许用户允许或拒绝发送报告。大多数人确实允许这样做，因为对话框大多会说类似的`anonymous data to fix the bug that caused the app to crash`内容，并且（希望）那时也不会发送任何有隐私问题的数据。但我认为神奇的是，它并没有`usage data`在这样的全球背景下说。多年来从未遇到过问题，即使显示警报并让用户决定也没有收到崩溃报告，也可以选择`Always send`.

以下答案显示了可用崩溃报告解决方案的概述：[如何使用 Apple 提供的崩溃报告等代码生成崩溃报告](https://stackoverflow.com/questions/15521494/how-to-generate-crash-report-using-code-like-crash-report-provided-by-apple/15523392#15523392)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-23T13:42:49.960

只是 iOS 8 和 9 的更新：在您的 iOS 设备上，转到`Settings > Privacy > Diagnostics & Usage, and select Automatically Send or Don't Send.` 当您打开自动发送时，您也可以打开与应用开发者共享。这通过允许 Apple 共享数据以及有关您如何使用他们的应用程序的统计数据来帮助开发人员改进他们的应用程序。

# java - “this”关键字的范围问题

> ID：15588074
> 
> 赞同：4
> 
> 时间：2013-03-23T14:47:34.463
> 
> 标签：java, swing, jframe, actionlistener

我正在尝试创建自己的扩展窗口类`JFrame`。但是，我对`fullScreenBtn`. 在编写`ActionListener.actionPerformed`函数时，我无法使用`this`它所指的关键字`new ActionListener`。我如何引用的实例`MyWindow`？

```
public class MyWindow extends JFrame {
    private static GraphicsEnvironment gEnv = GraphicsEnvironment.getLocalGraphicsEnvironment();
    private static GraphicsDevice gDev = gEnv.getDefaultScreenDevice();
    private static JPanel toolbar = new JPanel();
    private static JButton fullScreenBtn = new JButton("Show Full Screen");
    private static boolean isFullScreen = false;

    public MyWindow() {
        toolbar.setLayout(new FlowLayout());
        this.getContentPane().add(toolbar, BorderLayout.PAGE_START);

        fullScreenBtn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                // Toggle full screen window
                this.setUndecorated(!isFullScreen);
                this.setResizable(isFullScreen);
                gDev.setFullScreenWindow(this);

                isFullScreen = !isFullScreen;

                if (isFullScreen) {
                    fullScreenBtn.setText("Show Windowed");
                } else {
                    fullScreenBtn.setText("Show Full Screen");
                }
            }
        });

        this.addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent windowEvent) {
                this.dispose();
                System.exit(0);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T14:48:11.433

在内部类中，`this`如果您需要获取对外部类的引用，则需要在使用外部类的类名之前添加：例如，使用

```
MyWindow.this.setUndecorated(...)` 
//  etc... 
```

顺便说一句，在大多数情况下，您真的不想在此处扩展 JFrame。

此外，保存 JButton 的祖先 Window 可以通过其他方式获得，例如 via `SwingUtilities.getWindowAncestor(theButton)`。IE，

```
 public void actionPerformed(ActionEvent e) {
            Object source = e.getSource();
            if (source instanceof JButton) {
              JButton button = (button) source;
              Window ancestorWin = SwingUtilities.getAncestorWindow(button);
              ancestorWin.setUndecorated(!isFullScreen);
              ancestorWin.setResizable(isFullScreen);
              // etc... 
```

或者，如果您最确定地知道祖先窗口是 JFrame：

```
 public void actionPerformed(ActionEvent e) {
            Object source = e.getSource();
            if (source instanceof JButton) {
              JButton button = (button) source;

              JFrame ancestorWin = (JFrame) SwingUtilities.getAncestorWindow(button);
              ancestorWin.setUndecorated(!isFullScreen);
              ancestorWin.setResizable(isFullScreen);
              // etc... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T14:50:24.117

这是从内部类或匿名类访问封闭类实例的语法：

```
OuterClass.this.foo(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T14:50:45.977

因为您使用的是`anonymous class`,`this`将引用该类，在本例中为`ActionListener`. 因为您`ActionListener`没有诸如 之类的方法`setUndecorated`，所以这会给您一个编译错误。

你要做的是使用`MyWindow.this`，然后是任何方法`MyWindow`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-23T14:51:35.973

您还需要`this`通过指定外部类来访问，在您的情况下，它必须如下所示：

```
MyWindow.this 
```

# javascript - 重新加载缓存，重新加载其他网页网页...使用 javascript

> ID：15588075
> 
> 赞同：2
> 
> 时间：2013-03-23T14:47:45.997
> 
> 标签：javascript, html, caching, video, reload

我想这样做：

1.  在 Chrome 中显示 video.ogv（使用缓存）的网页 A。video.ogv 是本地文件夹中的文件

2.  然后，我关闭并重新打开 Chrome，显示一个带有按钮的网页 B。在这一步中，我还更改了文件夹中 video.ogv 的内容（但不是其名称）。

3.  我按下 B 中的按钮以使用`window.open("http://pagewebA,"_parent");`

结果：Chrome 使用了 video.ogv 的第一个内容。我想用新内容显示 video.ogv。

一些解决方案：

a) 我可以禁用内存缓存，但在这种情况下，在 window.open 之后显示视频可能会出现问题。A页面上的视频是黑色的

b）我可以保留内存缓存并使用强制重新加载缓存`window.open("http://pagewebA?x=1","_parent")`；但在这种情况下，我的视频也是黑色的。

我的意思是，a) 和 b) 给我一个黑色视频。我认为页面A由于其大小而无法正确下载视频，因此显示为黑色。

如果我在使用 window.open 后保留缓存并刷新网页，我可以显示视频。

一些可能的解决方案的问题：

1.  是否可以在使用 window.open 之前在页面 B 中使用 JavaScript 重新加载所有缓存？或者，在使用 window.open 之前，最好重新加载与页面相关的缓存（在我的 casem 页面 A 中）？或者也许在后台重新加载其他网页......但是如何？

2.  是否可以在页面 B 中预加载我将在页面 A 中使用的视频或任何文件？如何？

3.  还有其他可能的解决方案吗？

我正在使用 HTML5`<video>`标签在页面 A 中显示视频。

其中一个问题是“如何在页面 A 上预缓存我想在页面 B 上使用的视频”？视频在文件夹 F 中。当我用我的页面 B 打开 Chrome 时，同时，我正在将我的新视频复制到文件夹 F（名称相同但内容不同）。

# listview - 如何在 Monodroid 中动态地将项目添加到列表视图

> ID：15588076
> 
> 赞同：1
> 
> 时间：2013-03-23T14:47:46.807
> 
> 标签：listview, exception, xamarin.android

我正在编写一个活动，用户必须能够通过单击“添加信息”按钮（在屏幕顶部）将项目（带有代码和描述的类）动态添加到列表视图。最初列表视图是空的。我已经制作了一个自定义视图 (RowItem.axml)，它将在 Adapter GetView() 调用中膨胀以显示特定行的相关信息。问题出在 [add info].Click 事件中，我必须在列表中添加新项目：代码如下：

```
 void button_Click( object sender, EventArgs e )
    {
      AddNewItemToListView( listview.count);
    }
    void AddNewItemToListView(int count)
    {
       DataItem item = new DataItem();
       item.Code = FindCode(count);
       item.Description = FindDescription(count);

       listview_adapter.Add( item ); // !!  HERE AN EXCEPTION IS THROWN: --> Java.Lang.UnsupportedOperationException: 
       listAdapter.NotifyDataSetChanged();
    } 
```

这是DataItem的定义：

```
public class DataItem
{
  public string Code {get;set;}
  public string Description {get;set;}
} 
```

这是我的自定义适配器的定义：

```
public class MyListAdapter: ArrayAdapter<DataItem>
{
  // override code here (ex: GetView(..) ... ) 
```

一整天我都在网上搜索一些例子，但我只在 Android Java 中找到了而不是 Monodroid。在这些示例中，他们使用适配器的 .Add 方法（在大多数情况下，适配器使用简单类型，例如字符串或整数）。

我不知道我做错了什么来获得这个异常。（我唯一注意到的是 Android.Widget.ArrayAdapter （我的祖先类）的方法 Add 定义如下：

```
Android.Widget.ArrayAdapter<T>.Add(T @object); 
```

“@”的用法是什么意思？我的异常与这个“@”有关吗？我试过了

```
 listview_adapter.Add( @item ); // STILL SAME EXCEPTION 
```

请对正确方向的任何帮助将不胜感激。非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T18:22:30.760

不要使用 ArrayAdapter，而是使用 BaseAdapter。它使您可以自由地使用像 a 这样的良好数据结构`List<T>`作为内部数据存储。

您要做的是`Add(T item)`在调用列表的适配器上实现您的方法，`Add(T item)`然后调用适配器的`NotifyDataSetChanged()`方法。这指示适配器的列表视图刷新自身。

看看[这个例子](http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview/)。这是前一阵子，但代码适用于设置具有自定义视图的列表。你只需要实现这样的`Add(T item)`东西：

```
public class MyAdapter : BaseAdapter<DataItem>
{
    private readonly List<DataItem> _items = new List<DataItem>();

    // Constructor if you need to set up other stuff.

    public void Add(DataItem item)
    {
        _items.Add(item);
        NotifyDataSetChanged();
    }

    // Overrides for GetItemId, GetView, Count, this[]
} 
```

# php - JQuery向用户输入添加斜杠（textarea）

> ID：15588078
> 
> 赞同：-1
> 
> 时间：2013-03-23T14:48:02.153
> 
> 标签：php, mysqli

我正在创建一个使用 JQuery Post 更新到数据库中的用户配置文件，我刚刚注意到，如果我在 textarea 中使用单词 can't，它会以 can/'t 的形式上传到数据库并在配置文件中读回. 我在 php 中的请求如下所示：

```
$name = mysqli_real_escape_string($con, $_REQUEST["name"]);
$location = mysqli_real_escape_string($con, $_REQUEST["location"]);
$about = mysqli_real_escape_string($con, $_REQUEST["about"]); 
```

那么我可以添加什么来防止添加斜线吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-23T14:57:30.570

正如其他人在评论中已经说过的那样，这完全是因为魔术引号：

[禁用魔术引号 - 手动](http://php.net/manual/en/security.magicquotes.disabling.php)

如果您无法禁用它们并且不想更改您的代码，您可以在您的文件中插入此代码段。

```
 if (get_magic_quotes_gpc())
  {
    function stripslashes_gpc(&$value)
    {
      $value = stripslashes($value);
    }
    array_walk_recursive($_GET, 'stripslashes_gpc');
    array_walk_recursive($_POST, 'stripslashes_gpc');
    array_walk_recursive($_COOKIE, 'stripslashes_gpc');
    array_walk_recursive($_REQUEST, 'stripslashes_gpc');
  } 
```

# javascript - Emberjs - 一起使用 CollectionView 和 ItemController

> ID：15588079
> 
> 赞同：5
> 
> 时间：2013-03-23T14:48:03.183
> 
> 标签：javascript, ember.js, collectionview

我有一个模型`Category`有很多`Documents`. 渲染个人时，`Category`我想`documents`在拖放可排序列表中列出所有孩子。我还想双击任何个人`document`以允许对该文档进行内联编辑。

我让两个部分都在那里工作，但似乎无法弄清楚如何将它们合并在一起。

对于可排序列表，我使用自定义子类`CollectionView`来呈现`documents`，并在插入元素后调用 html5sortable jquery 插件。

对于内联编辑，我`itemController`为每个`document`正在渲染的内容设置了一个。在`DocumentController`我保持编辑文档的应用程序状态。

我正在寻找有关如何结合这两种方法的见解。我认为我需要的是一种`itemController`在. 我已将相关代码放在下面。`itemView``CollectionView`

```
App.SortableView = Ember.CollectionView.extend({
    tagName: 'ul',
    itemViewClass: 'App.SortableItemView', 

    didInsertElement: function(){
        var view = this;
        Ember.run.next(function() {
        $(view.get('element')).sortable();
        });
    }
});

App.SortableItemView = Ember.View.extend({
    templateName: 'sortable-item',
    doubleClick: function() {
        //This should ideally send 'editDocument' to controller
    }
});

App.DocumentController = Ember.ObjectController.extend({
    isEditing:false,
    editDocument: function () {
        this.set('isEditing', true);
    },
    finishedEditing: function() {
        var model = this.get('model');
        model.get('store').commit();
        this.set('isEditing', false);
    }
});

<script type="text/x-handlebars" data-template-name="category">
    <h1>{{ name }}</h1>

    <h2>Documents</h2>
    <!-- This makes a sortable list -->
    {{view App.SortableView contentBinding="documents"}}

    <!-- This makes an editable list -->
    {{#each documents itemController="document"}}
        <!-- change markup dependent on isEditing being true or false -->
    {{/each}}

    <!-- How do I combine the two -->
</script> 
```

谢谢你的帮助。真的很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T22:20:16.237

秘诀是设置`itemController`在你的`ArrayController`而不是试图设置在视图上。然后，绑定到该 ArrayController 的任何视图都将获得一个控制器，而不是它背后的任何内容。

为此，您必须明确说明`DocumentsController`：

```
App.DocumentsController = Ember.ArrayController.extend({
    needs: ['category'],
    contentBinding: 'controllers.category.documents',
    itemController: 'document'
}); 
```

然后在您的类别中：

```
App.CategoryController = Ember.ObjectController.extend({
    needs: ['documents'] 
```

现在，在您的模板中，绑定到`controllers.documents`而不是`documents`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-27T08:46:40.617

我认为这是 Ember 中的一个错误，即将解决：

[https://github.com/emberjs/ember.js/issues/4137](https://github.com/emberjs/ember.js/issues/4137)

# php - CakePHP 数据验证 2 输入字段

> ID：15588080
> 
> 赞同：1
> 
> 时间：2013-03-23T14:48:04.210
> 
> 标签：php, html, cakephp

```
 //View

    echo $this->Form->input('adult', array('options' => array('0'=>'0', '1'=>'1', '2'=>'2', '3'=>'3', '4'=>'4'), 'default' => '0'));
    echo $this->Form->input('concession', array('options' => array('0'=>'0', '1'=>'1', '2'=>'2', '3'=>'3', '4'=>'4'), 'default' => '0'));

    //Model

    ... 
```

我遇到的问题是，我知道如何为各个字段编写验证代码，但在这里我想将“成人”和“让步”字段一起比较，如果它们的总和小于“1”，则会给出错误。

这里的任何建议都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T14:54:42.217

您可以在模型上创建自定义验证规则，如下所示；

```
function atLeastOneSelected($data)
{
    if (empty($this->data[$this->alias]['adult']) && empty($this->data[$this->alias]['concession'])) {
        // both fields are empty
        return false;
    }
    return true;
} 
```

并在您的验证数组中；

```
public $validate = array(
    'adult' => 'atLeastOneSelected',
    'concession' => 'atLeastOneSelected',
); 
```

# java - 如何访问在 Java 中的 TreeMap 中放置元素的顺序？

> ID：15588083
> 
> 赞同：1
> 
> 时间：2013-03-23T14:48:24.670
> 
> 标签：java, data-structures, tree

假设我将键 "a"、"b"、"c" 放入 a`TreeMap`中。我将如何使用“c”来确定它是字典中的第三个元素`TreeMap`？

从 TreeMap 获得的 NavigableSet 的目的是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T14:50:02.440

如果要按插入顺序检索元素，请使用 LinkedHashMap。

[LinkedHashMap](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashMap.html)

> Map 接口的哈希表和链表实现，具有可预测的迭代顺序。此实现与 HashMap 的不同之处在于它维护一个双向链表，该列表贯穿其所有条目。这个链表定义了迭代顺序，通常是键插入映射的顺序（插入顺序）。请注意，如果将键重新插入到地图中，则插入顺序不会受到影响。（如果在调用 m.containsKey(k) 将在调用之前立即返回 true 时调用 m.put(k, v)，则将键 k 重新插入到映射 m 中。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T14:51:47.400

如果您真正想知道的是映射中包含的已排序键集中的 c 键的索引，您可以简单地使用

```
int index = map.headMap("c").size(); 
```

请注意，它与 TreeMap 不维护的插入顺序没有任何关系。

# java - 远程 MessageListener 的 Camel JMS 请求回复问题

> ID：15588084
> 
> 赞同：0
> 
> 时间：2013-03-23T14:48:25.493
> 
> 标签：java, spring, jms, apache-camel

我正在测试将 JMS 请求/回复与 Camel 和 ActiveMQ 一起使用的示例。当骆驼为您创建侦听器时，我可以使示例正常工作。IE。

```
from("direct:entryPoint").inOut("jms:queue:A");

from("jms:queue:A").
    process(new Processor() {

        @Override
        public void process(Exchange exchange) throws Exception {
            exchange.getIn().setBody("Hello World.");

        }
    }); 
```

我现在遇到的问题是我无法让 JMS 请求/回复与存在于 Camel 的 jvm 之外的 MessageListener 一起工作。连接超时等待回复。我确保 MessageListener 正在将回复发送到 replyTo 队列，并且我还在设置相关 ID。我在这里做错了什么？我已经用谷歌搜索了几天试图解决这个问题，但没有运气。提前感谢您的帮助。

下面是我正在使用的路线，我还将 MessageListener 逻辑也放在下面。

```
from("direct:entryPoint").
  inOut("jms:queue:B?concurrentConsumers=4&requestTimeout=240000"); 
```

队列 B 的 MessageListener onMessage：

```
@Override
public void onMessage(Message message) {

    String msg = null;
    ObjectMapper mapper = new ObjectMapper();
    mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, true);
    String jsonOutput = null;

    try{
        msg = ((TextMessage) message).getText();

        //convert message payload to purchase order
        PurchaseOrder order = mapper.readValue(msg, PurchaseOrder.class);

        //Set the id to see if the request reply worked.
        order.setOrderId(BigInteger.valueOf(111111111));

        if(message.getJMSReplyTo() != null){
            Map<String, Object> headers = new HashMap<String, Object>();
            headers.put("JMSCorrelationID", message.getJMSCorrelationID());
            headers.put("JMSReplyTo", message.getJMSReplyTo().toString());  
            jsonOutput = mapper.writeValueAsString(order);

            //Camel runs on the external jvm so leverage the producerTemplate.
            producerTemplate.
              sendBodyAndHeaders("jms:"+ message.getJMSReplyTo().toString(), 
              jsonOutput, headers);
        }
    }
    catch(Exception e){
        logger.fatal(e.getMessage());

        try {
            if(message.getJMSReplyTo() != null){
                Map<String, Object> headers = new HashMap<String, Object>();
                headers.put("JMSCorrelationID", message.getJMSCorrelationID());

                producerTemplate.
                 sendBodyAndHeaders("jms:"+ message.getJMSReplyTo().toString(),
 e.getMessage(), headers);
            }
        } catch (JMSException e1) {
            logger.fatal(e1.getMessage());
        } catch (Exception e1) {
            logger.fatal(e1.getMessage());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T18:23:44.110

```
sendBodyAndHeaders("jms:"+ message.getJMSReplyTo().toString(), 
          jsonOutput, headers); 
```

通常会解决`jms:queue://someQueue`可能会搞砸的问题。除非您采取预防措施，否则使用转换为字符串的 javax.jms.Destination 通常不是一个好主意。

您可以使用 Camel 标头`CamelJmsDestination`： `headers.put("CamelJmsDestination",message.getJMSReplyTo());`

这是否有效，我不知道。通常，尝试将 ActiveMQ 与 Web 控制台一起使用（或使用 JMX (jconsole) 连接到 ActiveMQ）来查看队列并尝试找出谁在读取哪个队列以及消息在哪里结束。这真的很有帮助。

# ruby-on-rails - Rails 和 has_many 通过关联 - 如何正确设置表单？

> ID：15588087
> 
> 赞同：0
> 
> 时间：2013-03-23T14:49:05.043
> 
> 标签：ruby-on-rails, ruby, associations, rails-activerecord

我不确定我是否正确设置了模型，所以我想向您展示我的想法：

我有`Car`属于的模型`Company`。然后我有一个模型叫做`Color`. 在这个 DB 表中存储了所有颜色（红色、蓝色、...）。然后是第 4 个模型，称为`CarColor`. 此模型包含两列 -`job_id`和`color_id`。

在视图中，我希望允许访问者使用复选框来挑选颜色。

### 形成部分

```
= form_for @car do |f|
  .field
    = f.label :name
    = f.text_field :name
  .field
    = f.label :location
    = f.text_field :location
  .field
    = fields_for @car_colors do |cc|
      ...
  .field
    = fields_for @company do |c|
      .field
        = c.label :name
        = c.text_field :name

  .actions
    = f.submit 'Save' 
```

### 楷模

```
class Company < ActiveRecord::Base
  has_many :cars
end
class Car < ActiveRecord::Base
  belongs_to :company

  has_many :car_colors
  has_many :c_colors, :through => :car_colors
end
class Color < ActiveRecord::Base 
  has_many :car_colors
  has_many :cars, :through => :car_colors
end
class CarColor < ActiveRecord::Base
  belongs_to :car
  belongs_to :color
end 
```

保存`Cars`+`Company`效果很好，但我不知道如何在视图中添加带有颜色的复选框。

**编辑：** 关于评论中的主题，我取得了进展。但是，我发现了一个我不知道如何解决的错误。

我正在使用上面显示的模型结构，这就是视图的样子：

```
- Color.order('name').each do |clr|
  = check_box_tag :c_color_ids, clr.id, @car.car_colors.include?(clr), :name => 'car[c_color_ids][]'
  = label_tag :c_color_ids, clr.name 
```

这是我得到的错误：

```
PG::Error: ERROR:  relation "car_colors" does not exist 
```

我错过了什么？关系怎么不存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T10:42:18.073

好的，我花了一天时间解决这个问题。关于的方案是正确的，在我的情况下的问题是，我创建了一个带有表名**car_color**而不是**car_colors**的迁移......

# xml - 文档类型声明包含或指向的标记声明必须格式正确

> ID：15588090
> 
> 赞同：4
> 
> 时间：2013-03-23T14:49:07.703
> 
> 标签：xml, struts2, dtd

我写了一个 XML，但是在那个 XML 的第一行我得到了一个错误

> 文档类型声明包含或指向的标记声明必须格式正确

下面是 XML（尖括号后的空格是故意的）

```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN" 
"http://struts.apche.org/dtds/struts-2.0.dtd">  
<struts>

    <package name="default" extends="struts-default">       
        <action name="getTutorial" class="org.koushik.javabrains.action.TutorialAction">                
            <result name="success">/success.jsp</result>
            <result name="error">/error.jsp</result>
        </action>

    </package>

</struts> 
```

第一行 ( `<?xml version="1.0" encoding="UTF-8"?>`) 抛出错误。

请让我知道为什么我会遇到这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-14T11:57:43.363

创建 dtd 时，它始终包含以下行

```
<!DOCTYPE…. [
...
]> 
```

只需删除声明 DTD 数据的第一行和最后一行，因为只有在 XML 文件中包含 DTD 时才使用这些行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T14:56:37.437

我猜这是因为`<`and 和and`?xml`之间 有额外的空格。`?``>`

请注意，您似乎在 doctype 声明的开头和结尾也有额外的空格。

**编辑**

好的，我发现您的文件还有两个问题：

1.  您似乎忘记了 DTD uri 中 apache.org 中的“a”。
2.  [http://struts.apache.org/dtds/struts-2.0.dtd](http://struts.apache.org/dtds/struts-2.0.dtd)上的 DTD以 XML 声明 ( `<?xml version="1.0" encoding="UTF-8"?>`) 开头，在 DTD 的开头是禁止的（因为 DTD*不是*XML 文件）。

如果第一个错误是导致问题的原因，则很容易修复。但是，第二个错误是在 struts 开发人员方面。我猜大多数 XML 解析器都会忽略它（否则 struts 团队会在很久以前修复它），但是如果您有一个确实抱怨它的 XML 解析器，恐怕您唯一的选择是切换到另一个。

# css - 如何使 css 背景图像随窗口大小和设备缩放

> ID：15588091
> 
> 赞同：5
> 
> 时间：2013-03-23T14:49:09.110
> 
> 标签：css, html, background, responsive-design

我正在尝试设置一个流体模板，我也可以将其用于响应式设计视口。但是，现在当我尝试调整浏览器窗口的大小时，它不会缩放，在我的 iPhone 上，我只看到标题图形的左上角。我有一个主包装背景和一个标题动画 gif，它们的宽度都是 1200 像素。任何帮助将不胜感激。

视口

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

css

```
body {
    background-color: #B28D66;
    margin: 0 auto;
}
#Wrapper {
    max-width:1200px;
    width:95%;
    background-image: url(../img/background_main.jpg);
    background-repeat: no-repeat scroll;
    background-position: center top;
    height: 2200px;
    position: relative;
    margin-top: 0;
    margin-right: auto;
    margin-bottom: 0;
    margin-left: auto;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
}
#Wrapper #Banner {
    width: 100%;
    height: 350px;
    background-image: url(../img/animated-gif-header.gif);
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
}
#Wrapper #Content {
    width: 75%;
    margin: 0 auto;
}
#Wrapper #MainNav {
    background-image: url(../img/nav_bar.png);
    width: 100%;
    height: 75px;
    margin-top: -20px;
}
#Wrapper #MainNav ul {
    margin-right: 100px;

}

#Wrapper #MainNav ul li {
    float: right;
    margin-top: 15px;
    padding-right: 21px; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-23T15:03:42.737

尝试以下列方式使用**background-size属性：**

> 背景尺寸：100% 自动；

或者如果你想让它的高度覆盖整个页面高度，请使用下面的

> 背景尺寸：自动 100%；

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-21T10:30:50.997

```
background-image: url('');
background: no-repeat center center cover; 
```

这通常工作正常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-09T06:39:57.260

```
background-size: cover; 
```

对我来说很好。

# vb.net - Windows Phone DatePicker 不更新其值

> ID：15588095
> 
> 赞同：0
> 
> 时间：2013-03-23T14:49:31.380
> 
> 标签：vb.net, windows-phone-7, datepicker, windows-phone-8, windows-phone

我制作了一个 Windows Phone 7.8 应用程序，并且正在使用日期选择器。当我加载包含日期选择器的页面时，我传递了日期并正确显示。我的代码是：

```
Protected Overrides Sub OnNavigatedTo(ByVal e As System.Windows.Navigation.NavigationEventArgs)

 Dim mydate As String = Nothing
 If NavigationContext.QueryString.TryGetValue("date", mydate) Then
   eventdate = Date.Parse(mydate)
   datePicker.Value = eventdate
EndIf

End Sub 
```

但是当我尝试更改日期时，日期选择器不会保留新日期。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:06:58.580

您的问题是由于您没有正确管理页面生命周期的方式。

当您转到日期选择器时，这实际上是一个单独的页面。当点击“勾号”以确认新数据选择时，您将返回您的页面。根据您上面的代码，此时您将`NavigationContext`再次加载日期，因此所选日期丢失。

解决方案是查询并且仅在is`NavigationEventArgs`时读取查询字符串。`NavigationMode``New`

# javascript - 从 FullCalendar 事件对象获取简单的时间戳

> ID：15588102
> 
> 赞同：0
> 
> 时间：2013-03-23T14:50:19.493
> 
> 标签：javascript, fullcalendar

通过定义一个事件源，我已经让我的 FullCalendar 提要运行良好。

```
eventSources: [
{
    events: function(start, end, callback) {
        $.ajax({
            url: svcURL,
            dataType: 'json',
            type: 'POST',
            data: {
                start: Math.round(start.getTime() / 1000),
                end: Math.round(end.getTime() / 1000),
                sid: %sid%,
                csrf_test_name: csrf
            },
            success: function(json) {
                callback(json);
            }
        });
    }
} 
```

通过从示例中复制和粘贴，我得到了完美的时间戳。但是，我还有另一个 ajax 函数，我也想使用时间戳，但我得到的不是时间戳，而是数据的文本版本：

```
eventClick: function(event) {
    if (confirm('Quer mesmo marcar este serviço?')){
        markit(event);
    }
    return false;
} 
```

eventClick 函数将事件对象传递给我的“markit”函数：

```
function markit(obj){
    $.ajax({
        url: msvURL,
        dataType: 'json',
        type: 'POST',
        data: {
            start: obj.start,
            end: obj.end,
            sid: obj.sid,
            uid: obj.uid,
            aid: obj.aid,
            csrf_test_name: csrf
        },
        success: function(json) {
            alert('Got it marked!')
        }
    });
} 
```

正如我所说，markit 函数不会为“开始”和“结束”传递时间戳，因此数据更难处理。如何将时间转换为时间戳？

更新：正在发送的文本版本如下：

```
Tue Mar 19 2013 09:30:00 GMT-0300 (Hora oficial do Brasil) 
```

虽然我可以用 PHP 解析它，但如果我可以使用时间戳，生活会简单得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T20:20:34.353

我不确定为什么会这样，但我将开始值和结束值更改为以下值，并且得到了我正在寻找的时间戳：

```
function markit(obj){
    $.ajax({
        url: msvURL,
        dataType: 'json',
        type: 'POST',
        data: {
            start: Math.round(obj.start / 1000),
            end: Math.round(obj.end / 1000),
            sid: obj.sid,
            uid: obj.uid,
            aid: obj.aid,
            csrf_test_name: csrf
        },
        success: function(json) {
            obj.aid = json;
            alert('Got it marked! AID: ' + json)
        }
    });
} 
```

对我来说，如何在不是数值的东西上使用数学函数是没有意义的。如果有人可以发表评论来解释这一点，我将不胜感激。

# hadoop - zookeeper 如何确定 hadoop 作业的“java.library.path”？

> ID：15588104
> 
> 赞同：0
> 
> 时间：2013-03-23T14:50:31.183
> 
> 标签：hadoop, apache-zookeeper, oozie

我正在使用 oozie 在分布式集群上运行 hadoop 作业。我为 oozie 作业设置了“oozie.libpath”。

最近，我从 oozie 使用的库路径中删除了一些旧版本的 jar 文件，并用新版本替换了它们。但是，当我运行我的 hadoop 作业时，我的旧版本的 jar 文件和新版本的 jar 文件都会被加载，并且 mapreduce 仍在使用旧版本。

我不确定 zookeeper 从哪里加载 jar 文件。是否有任何默认设置可以从中加载 jar 文件？我的 HDFS 中只有一个库路径，并且没有那些 jar 文件。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-23T15:40:49.743

I have found what is going wrong. The wrong jar is shipped with my job file. Should have check here first

# asp.net - 如何从子目录中的母版页获取根页面

> ID：15588107
> 
> 赞同：0
> 
> 时间：2013-03-23T14:50:38.850
> 
> 标签：asp.net

我的应用程序根目录中有masterpage、contactus、默认页面和帐户目录中有我的登录页面

与登录和默认页面关联的母版页

在母版页中，我有重定向到联系方式的链接

当我在默认页面联系我们重定向是正确的，因为 master 和 default 都在 Root 中

现在我遇到的问题是，当我在登录页面上时，联系我们重定向失败，因为登录页面在 Account 目录中，而 master 在 Root 中

在我的母版页上，我有链接

```
<a href="~/contactus.aspx">Contact us</a> 
```

当母版页与根目录关联而不与子目录关联时，它可以工作

请提出解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T14:56:44.890

一种方法可能是：

```
<a href="<%=HostingEnvironment.ApplicationVirtualPath %>contactus.aspx">Contact us</a> 
```

[在 MSDN 上了解有关 HostingEnvironment.ApplicationVirtualPath 属性的更多信息。](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.applicationvirtualpath%28v=vs.110%29.aspx)

请注意，`~/`符号仅在服务器端控件上按预期工作。

# ruby-on-rails - 在 ruby on rails 中设计定制

> ID：15588108
> 
> 赞同：0
> 
> 时间：2013-03-23T14:50:45.363
> 
> 标签：ruby-on-rails, ruby, devise

我正在实施用户注册设计，但有一些自定义，如下所示。

*   当用户使用用户名、电子邮件和密码注册时，电子邮件将发送给用户
*   在电子邮件中，用户将获得完成注册过程所需的密码。
*   当用户单击“转到应用程序”按钮时，它会将用户重定向到应用程序，用户必须使用该密码才能完成注册过程。
*   用户完成注册过程后，用户与该密码之间将存在一对一的关系。

我在互联网上搜索了很多，但找不到答案。

问题：我不知道如何在 Rails 中创建密码，然后通过电子邮件将其发送给用户，然后将其与用户获得的密码匹配。

注意：密码和密码在我的应用程序中是两个不同的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:04:49.563

Devise 有一个名为的内部模块`Confirmable`正是这样做的。

为了使用它，您需要做的就是：

*   确保您的设计模型是`:confirmable`并且`:registerable`

    ```
    class User
      # ...
      devise :confirmable, :registerable ...
      # ...
    end 
    ```

*   运行创建确认令牌字段的迁移

    ```
    class AddConfirmableToUsers < ActiveRecord::Migration
      def self.up
        change_table(:users) do |t|
          t.confirmable
        end
        add_index :users, :confirmation_token, :unique => true
      end

      def self.down
         remove_column :users, :confirmable
      end
    end 
    ```

如果您已经有用户，并且不希望他们遵循此确认过程，那么您需要让他们确认。你可以这样做

```
User.update_all ["confirmed_at = ?", Time.now] 
```

在控制台上。

更多参考：[Confirable Module](http://rubydoc.info/github/plataformatec/devise/master/Devise/Models/Confirmable)，[在 Devise 中向用户添加可确认](http://tommcfarlin.com/adding-confirmable-to-users-in-devise/)

# c - 将带有文件描述符的文本文件读入管道

> ID：15588111
> 
> 赞同：0
> 
> 时间：2013-03-23T14:50:47.227
> 
> 标签：c, file, file-descriptor

我在这里试图读取*fileDesc*的内容，它是一个文件描述符，指向一个文本文件到管道的一端 *pipe_d[1]* 一次一个字符。这确实可以正确打印文件中的字符，但我相信我的*write()*会尝试将字符的内存地址写入管道，而不是如果我这样做的话。

```
char x;
FILE *file;
file = fdopen(fileDesc, "a+");

while((x = fgetc(file)) != EOF)
{
  printf("%c", x);

  write(pipe_d[1], &x, sizeof(x));
} 
```

我想让位于 &x 上的字符改为写入管道。有什么想法吗？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T14:10:39.740

1.  x有一个问题：它是一个字符，它不能包含值EOF，所以行：

    ```
    while((x = fgetc(file)) != EOF) 
    ```

    将始终评估为真，使程序永远运行。将x 声明为 an`int`将解决此问题。

2.  如果您希望逐个字符地工作，您还应该`fdopen(pipe_d[1], "w")`使用`fputc(fp, x)`来编写管道。

3.  在写这篇文章的时候没有电话`pipe(pipe_d)`；你发了一个吗？

4.  没有调用 to `fork()`，所以有管道的读者吗？如果不是，程序将在管道填满后阻塞。

# javascript - Eclipse Juno 中的 JavaScript 代码完成不起作用

> ID：15588119
> 
> 赞同：0
> 
> 时间：2013-03-23T14:51:25.367
> 
> 标签：javascript, eclipse, autocomplete

```
var P = P || {}; // create global container object if it does not exist
P.file = {
    name : null,
    type : null,
    size : null,
    data : null
}; 
```

当我输入`P.`Eclipse 时，我没有收到`P.file`自动完成建议。这种在 JavaScript 中创建对象的方式有什么问题吗？或者至少在 Eclipse 中的代码完成方面是错误的？

**更多信息：**这是一个启用了 JavaScript 支持的 Java EE 项目。对于诸如`function doSomething() { ... }`代码完成之类的全局功能，当我键入`doSo`并点击**Ctrl+Space**时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:00:22.123

好的，这很快升级了......不知何故我没有注意到这一点，但在文件的*大纲*视图中`.js`可以看到 Eclipse 将`P`其视为`boolean`，因此没有代码完成。一旦我使用`var P = {}`代码完成就像一个魅力。

# android - FragmentPagerAdapter getItem 没有被触发

> ID：15588120
> 
> 赞同：38
> 
> 时间：2013-03-23T14:51:28.837
> 
> 标签：android, android-fragments, android-viewpager, fragmentpageradapter

目前，`FragmentActivity`我使用以下代码在两种类型的片段之间切换。

```
private void toggle() {
    Fragment oldFragment = getSupportFragmentManager().findFragmentById(R.id.content);
    Fragment fragment = null;
    if (oldFragment instanceof ColorFragment) {
        fragment = new ViewPagerFragment();
    } else {
        fragment = new ColorFragment(android.R.color.black);
    }

    getSupportFragmentManager().beginTransaction().replace(R.id.content, fragment).commitAllowingStateLoss();
} 
```

2 个片段正在切换。

*   **ColorFragment** - 一个简单的片段，它用纯黑色填充其背景。
*   **ViewPagerFragment** - 一个片段包含`ViewPager`. 用户可以在紫色片段和蓝色片段之间滑动。

负责刷紫色和蓝色碎片的代码如下。

```
private static class MyFragmentPagerAdapter extends FragmentPagerAdapter {

    public MyFragmentPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public int getCount() {
        return 2;
    }

    @Override
    public Fragment getItem(int position) {
        switch (position) {
        case 0:
            return new ColorFragment(android.R.color.holo_purple);
        default:
            return new ColorFragment(android.R.color.holo_blue_bright);
        }
    }      
} 
```

但是，我在切换过程中遇到了奇怪的行为。

1.  显示黑色片段。
2.  切换。
3.  查看寻呼机，它可以在显示的紫色和蓝色片段之间滑动。
4.  切换。
5.  显示黑色片段。
6.  切换。
7.  **没有显示任何内容，因为未触发 MyFragmentPagerAdapter 的 getItem。**

我想我的情况类似于[FragmentPagerAdapter getItem is not called](https://stackoverflow.com/questions/12581896/fragmentpageradapter-getitem-is-not-called)

但是，我不喜欢使用`FragmentStatePagerAdapter`，因为*在页面之间切换时可能会产生更多开销。*

有什么办法可以克服这个问题吗？

我包含一个完整的可行源代码来演示这个问题：[https ://www.dropbox.com/s/jok9tz5ktvfcteo/viewpagerbug.zip](https://www.dropbox.com/s/jok9tz5ktvfcteo/viewpagerbug.zip)

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-03-23T16:04:58.470

> 有什么办法可以克服这个问题吗？

我已经下载了您的代码并且出现了问题，因为您没有`Fragments`正确处理这些代码。最准确地说，您使用嵌套`Fragments`在`ViewPager`基础中`Fragment`并为此`ViewPager`创建适配器，如下所示：

```
MyFragmentPagerAdapter myFragmentPagerAdapter = new MyFragmentPagerAdapter(this.getFragmentManager()); 
```

相反，您应该使用`getChildFragmentManager()`来绑定嵌套片段：

```
MyFragmentPagerAdapter myFragmentPagerAdapter = new MyFragmentPagerAdapter(this.getChildFragmentManager()); 
```

此外，您不应该通过构造函数将数据传递给 a `Fragment`，因为该数据将无法在配置更改后继续存在，并且会开始出现坏事。改用 a `Bundle`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-01-28T06:39:07.733

**全球工作测试解决方案。**

`getSupportFragmentManager()`有时会保留空引用，View pager 不会创建新的片段实例。因为它找到了对同一片段的引用。所以要克服这种使用`getChildFragmentManager()`以简单的方式解决问题。

**别**

**`new PagerAdapter(getSupportFragmentManager(), fragments);`**

**做**

**`new PagerAdapter(getChildFragmentManager() , fragments);`**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-20T13:36:47.250

简单使用`FragmentStatePagerAdapter`代替`FragmentPagerAdapter`

或者

您可以使用`new MyFragmentPagerAdapter(this.getChildFragmentManager())`

希望它会帮助你:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-11T13:34:30.803

就我而言，我正确地打电话

```
MyFragmentPagerAdapter myFragmentPagerAdapter = new MyFragmentPagerAdapter(this.getChildFragmentManager()); 
```

但随后在嵌套片段中，我尝试使用以下方法将容器片段替换为另一个片段：

```
getFragmentManager() 
```

您需要参加活动并致电

```
getActivity().getSupportFragmentManager(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-28T02:43:05.463

在我的情况下，将其添加到我的**FragmentPagerAdapter**后它起作用了：

```
 @Override
    public int getItemPosition(Object object) {
        return POSITION_NONE;
    } 
```

我也像 Luksprog 所说的那样使用了**getChildFragmentManager()**

# javascript - 如何检查会话存储中是否存在项目？

> ID：15588128
> 
> 赞同：1
> 
> 时间：2013-03-23T14:52:07.497
> 
> 标签：javascript, updates, session-storage

我正在创建一个网页，用户可以在其中将项目添加到 Dropbox 购买单击按钮。sessionStorage 存储项目的部分和数量。下拉框将显示所选项目的详细信息（数量为 1）。如果选择了相同的项目，如何将数量更新为 2？

```
 $("#btnBuy0").click(function()
        {
            $("#dropbox").append('<span><img class = "thumb" src="../images/21_metoyou.jpg" />' + teddy[0].desc + ", Price £"
             + teddy[0].price + ", Quantity: " + quantity + "</span><br/>");
            if (Modernizr.sessionstorage) 
            {  // check if the browser supports sessionStorage
                myids.push(teddy[0].partnum + quantity); // add the current username to the myids array
                sessionStorage["ids"]=JSON.stringify(myids); // convert it to a string and put into sessionStorage
            }   
            else 
            {
             // use cookies instead of sessionStorage
            }
            for (var item =0; item<sessionStroage.length; item++)
            {
                var key = sessionStorage.key(teddy[0].partum);
                if (teddy[0].partnum == teddy[item].partnum)
                {
                var q = sesstionStorage.getItem(quantity, quantity++);
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:24:28.193

我建议您使用不同的数据结构来存储用户的购物篮。[您可以使用关联数组](http://en.wikipedia.org/wiki/Associative_array)（通过使用 JavaScript 对象）来映射`partnum`数量，而不是使用数组（myids） ，例如：

```
// Basket is initially empty.
basket = {};

function saveOrder(teddy, quantity) {
    var partnum = teddy[0].partnum;

    // Create a mapping between the partnum and the quantity
    basket[partnum] = quantity;

    // Write the basket to sessionStorage.
    sessionStorage.basket = JSON.stringify(basket);
} 
```

使用地图将允许您创建辅助方法来从 SessionStorage 读取和写入购物篮对象，例如：

```
function fetchBasketFromSession() {
    return JSON.parse(sessionStorage.basket);
}

function writeBasketToSession(basket) {
    sessionStorage.basket = JSON.stringify(basket)
}

function getPartNumOf(teddy) {
    return teddy[0].partnum;
}

function getQuantityInSessionBasketOf(teddy) {
    // Fetch the basket from sessionStorage
    var sessionBasket = fetchBasketFromSession(),
        partnum = getPartNumOf(teddy);

    // Return the quantity mapped to the partnum in the basket, or 0 if nothing
    // is mapped.
    return sessionBasket[partnum] || 0;
}

// Combining these functions would allow you to update the users basket.
function addToBasket(teddy, quantityToAdd) {
    var sessionBasket = fetchBasketFromSession(),
        currentQuantity = getQuantityInSessionBasketOf(teddy),
        partnum = getPartNumOf(teddy);

    // Update the quantity for this partnum and write it back out.
    sessionBasket[partnum] = currentQuantity + quantityToAdd;
    writeBasketToSession(sessionBasket);
} 
```

希望有帮助:)

# node.js - 与 MongoDB 而不是 Redis 一起使用的 Kue 有什么好的替代品？

> ID：15588130
> 
> 赞同：6
> 
> 时间：2013-03-23T14:52:23.840
> 
> 标签：node.js, mongodb, task-queue, kue

我正在使用 node.js 和 mongodb 构建一个 Web 应用程序。我需要添加延迟的工作。例如，在注册一个月后向用户发送一封电子邮件。除了 Kue 之外，我还没有找到用于延迟作业的现有解决方案，但它使用 Redis，我更愿意在向我的 Web 应用程序添加另一个资源之前使用我现有的 Mongodb。

有没有现成的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-23T15:49:59.427

## 简短的回答

简短的回答是否**。**没有 Kue 到 MongoDB 的端口，也没有任何计划。目前没有其他流行的开源项目提供类似的功能。此外，Redis 似乎更适合这类项目。

## 长答案

虽然 Kue 非常有趣并且提供的不仅仅是延迟任务，但您的要求似乎非常简单。

如果您只需要在注册一个月后向用户发送一封电子邮件，或者类似的事情，它通常内置于操作系统级别。

我建议你做的，假设你有一个`sendEmail`方法（一般来说，你知道如何完成任务）如下：

1.  根据操作系统，安排`sendEmailHandler`任务每天运行一次。在 Windows 中这是使用. `"Scheduled Tasks"`，在 OS X、BSD 和 Linux 中，这是使用`cron`. （[cron 教程](http://www.unixgeeks.org/security/newbie/unix/cron-1.html)）。大多数 PaaS 选项也有这种选项（如 nodejitsu、Azure...）。
2.  这些任务应该是一个 node.js 脚本，它遍历一个长期运行的任务列表（即每月、每周或更长运行一次的东西）。
3.  在`MongoDB`您选择使用的地方，保存一组任务，每个任务都有一个“开始时间”。此类任务的一个示例是特定用户在 1 个月后收到一封电子邮件。
4.  在您的`sendEmailHandler`脚本中，检查哪些任务应该运行并执行，然后您应该将它们从`MongoDB collection`.

虽然这听起来像是一些工作，但它不应该花太长时间。这里描述的所有代码都非常简单。

如果我理解正确，Kue 可以让你做一些你不需要的事情，比如优先级、尝试、进度等。使用一个做很多事情来做一些简单事情的库可能最终会咬你一口，因为调试和维护通常更难。

祝你好运！如果您希望我详细说明特定部分，请随时告诉我。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-09-02T20:17:26.220

另一种选择是[议程](https://github.com/rschmukler/agenda)

> Agenda 是 Node.js 的轻量级作业调度库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-27T00:56:12.827

我只是在研究同样的事情，发现了这个 npm 包：

**monq** - Node.js 的 MongoDB 支持的作业队列 - [https://www.npmjs.org/package/monq](https://www.npmjs.org/package/monq)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-30T05:54:50.983

我也在寻找这种与 MongoDB 一起使用的队列库。我刚刚找到[mongodb-queue](https://www.npmjs.com/package/mongodb-queue)。

当需要处理大量消息和持久性时， [Bull](https://www.npmjs.com/package/bull)、[Bee](https://www.npmjs.com/package/bee-queue)或[Kue](https://www.npmjs.com/package/kue)等库是必不可少的。对于所有这些库，持久性都是通过 Redis 实现的。

# javascript - 如果 contentheight < 500，则删除 div 的简单 Javascript 规则

> ID：15588131
> 
> 赞同：-1
> 
> 时间：2013-03-23T14:52:28.733
> 
> 标签：javascript, css, html, resize, image-resizing

我正在寻找一个 JS 规则，如果 contentheight < 500 则删除一个 div

我已经为图像进行了以下工作，但需要用删除 div 的命令替换图像调整大小：

```
 $(document).ready(function() {  

 function imageresize() {  
 var contentheight = $('#maincontainer').height();  
 if ((contentheight) < '500'){  
 $('.fluidimage').attr('src','images/big-sm.jpg');  
 } else {  
 $('.fluidimage').attr('src','images/big.jpg');  
 }  
 }  

 imageresize();//Triggers when document first loads      

 $(window).bind("resize", function(){//Adjusts image when browser resized  
 imageresize();  
 });  

 }); 
```

非常感谢所有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:32:10.960

[http://jsfiddle.net/Venugopal/eSBUz/2/](http://jsfiddle.net/Venugopal/eSBUz/2/)

```
$(document).ready(function() {  
function imageresize() {  
var contentheight = $('#maincontainer').height();  
if (contentheight < 250){
    $('#maincontainer').css('background','blue');  
} else {  
    $('#maincontainer').css('background','red');
}  
}
imageresize(); //Triggers when document first loads      
$(window).bind("resize", function(){
 //Adjusts image when browser resized  
 imageresize();  
 });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T14:55:43.623

使用 jQuery 删除一个`div`或任何 DOM 元素只是`$(selector).remove();` 您正在寻找的东西吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T14:56:06.820

```
$(document).ready(function() {
 function imageresize() {  
    var contentheight = $('#maincontainer').height();  
    if (contentheight < 500){
        $('.fluidimage').attr('src','images/big-sm.jpg');  
    } else {  
        $('.fluidimage').attr('src','images/big.jpg');  
    }  
 }
 imageresize(); //Triggers when document first loads      
 $(window).bind("resize", function(){
     //Adjusts image when browser resized  
     imageresize();  
 });
}); 
```

`500`是一个数字，而不是一个字符串。它不应该用引号引起来。
小提琴：http: [//jsfiddle.net/eSBUz/](http://jsfiddle.net/eSBUz/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:05:22.037

使用 each 来遍历 div 并检查维度怎么样？这样做你在每次调用时都有 DIV 的参考。像这样的东西：

```
$(".box").each(function (index) {
    console.log( $(this).attr("width") );
    w = Number( $(this).attr("width") );
    if( w > 10 ){
        $(this).remove();
    }
}); 
```

[http://jsfiddle.net/hamiltonlima/dDJcA/](http://jsfiddle.net/hamiltonlima/dDJcA/)

# d3.js - 使用过渡扩展 D3 中的路径

> ID：15588134
> 
> 赞同：1
> 
> 时间：2013-03-23T14:52:43.833
> 
> 标签：d3.js, transitions

我一直在努力解决与 D3 中的过渡有关的问题。考虑这段代码：

```
svg.selectAll("path")
  .data(data, key)
  .enter().append("path")
  .attr("d", someFunctionThatReturnsAPath);
}); 
```

`setTimeout`几秒钟后，我会调用以下命令：

```
svg.selectAll("path")
  .transition()
  .duration(2000)
  .attr("d", someFunctionThatReturnsADifferentPath);
}); 
```

第二个调用正确地更新了路径，但没有为过渡设置动画。`d`为什么在第二次调用中更新属性时没有转换？

请注意，路径非常复杂。在这两个调用中，在实际绘制路径之前都有明显的延迟。也许这与缺乏过渡有关？

我是 D3 的新手，但我已经阅读了转换，似乎无法理解为什么它的行为不像我预期的那样。

* * *

**更新**

根据@Marjancek 的回答，我将提供有关这两个被调用函数的更多详细信息。

这是 的定义`someFunctionThatReturnsAPath`：

```
function(d) {
  var coordinates = [];

  for (var i = d.track.length - 1; i >= 0; i--) {
    // We only care about the last 10 elements
    if (coordinates.length >= 10)
      break;
    coordinates.push(d.track[i]);
  }
  return path({type: "LineString", coordinates: coordinates});
}; 
```

并且`someFunctionThatReturnsADifferentPath`：

```
function(d) {
  var coordinates = [];

  for (var i = d.track.length - 1; i >= 0; i--) {
    // We only care about the last 20 elements
    if (coordinates.length >= 20)
      break;
    coordinates.push(d.track[i]);
  }
  return path({type: "LineString", coordinates: coordinates});
}; 
```

其中路径定义如下（`projection`is `d3.geo.albersUsa()`）：

```
var path = d3.geo.path()
  .projection(projection); 
```

目标是在第二次调用时，这条线用 10 个更新的数据点进行扩展。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T23:23:53.873

如果您的路径没有相同数量的点，则转换可能无法按预期工作。尝试 .attrTween：[http](http://github.com/mbostock/d3/wiki/Transitions#wiki-attrTween) : //github.com/mbostock/d3/wiki/Transitions#wiki-attrTween 在 bl.ocks.org 上有一个示例，但该站点目前似乎已关闭，因此我无法链接到它。

在编辑时添加：我想到的要点是：[https](http://gist.github.com/mbostock/3916621) ://gist.github.com/mbostock/3916621当网站返回时，bl.ocks 链接将是[http://bl.ocks.org/mbostock/3916621](http://bl.ocks.org/mbostock/3916621)向上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:04:03.343

不看你的 someFunctionThatReturnsADifferentPath 是不可能知道的；但我猜你的不同函数没有考虑到它收到的三个参数的插值。

阅读过渡文档：[https ://github.com/mbostock/d3/wiki/Transitions](https://github.com/mbostock/d3/wiki/Transitions)

# json - ServiceStack 中带有连字符的 JSON 属性

> ID：15588138
> 
> 赞同：1
> 
> 时间：2013-03-23T14:52:57.573
> 
> 标签：json, serialization, servicestack, dto

我有一些`JSON`是这样形成的：

```
 {
  "snippet-format":"raw",
  "total":1,"start":1,
  "page-length":200, ... 
 } 
```

我有一个 C# DTO，其成员名为 Total、Start 等。这些都成功地将上面的值放入其中。我不知道如何为上面的片段格式和页面长度 JSON 项目命名属性。

我试过 SnippetFormat 和 Snippet_Format 无济于事。

有人可以指出我正确的方向。

另外，如果一个值恰好是 a `W3C xs:dateTime string`，是否有一种我可以使用的类型`ServiceStack`会自动为我填充？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:51:39.337

[签入下一个版本](https://github.com/ServiceStack/ServiceStack.Text/commit/29a764724bce0b7d8ba08b741115ec5ff67792ef)的 ServiceStack.Text v3.9.43+，Lenient 属性约定现在支持连字符属性，因此您将能够：

```
public class Hyphens
{
    public string SnippetFormat { get; set; }
    public int Total { get; set; }
    public int Start { get; set; }
    public int PageLength { get; set; }
}

JsConfig.PropertyConvention = JsonPropertyConvention.Lenient;

var json = @"{
    ""snippet-format"":""raw"",
    ""total"":1,
    ""start"":1,
    ""page-length"":200
 }";

var dto = json.FromJson<Hyphens>();

Assert.That(dto.SnippetFormat, Is.EqualTo("raw"));
Assert.That(dto.Total, Is.EqualTo(1));
Assert.That(dto.Start, Is.EqualTo(1));
Assert.That(dto.PageLength, Is.EqualTo(200)); 
```

与此同时，您将不得不动态解析它，例如：

```
var map = JsonObject.Parse(json);
Assert.That(map["snippet-format"], Is.EqualTo("raw"));
Assert.That(map["total"], Is.EqualTo("1"));
Assert.That(map["start"], Is.EqualTo("1"));
Assert.That(map["page-length"], Is.EqualTo("200")); 
```

# php - 子域允许访问文件夹

> ID：15588149
> 
> 赞同：2
> 
> 时间：2013-03-23T14:54:18.297
> 
> 标签：php, .htaccess

我创建了一个子域。它也可以通过文件夹访问。例如，

```
subdomain.website.com 
```

也可以在以下网址中访问

```
website.com/subdomain 
```

我该如何阻止这个？我认为它可以用 htaccess 来完成。我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T14:57:55.910

在`website.com`的文档根目录下的 htaccess 文件中，添加以下规则：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^subdomain.website.com$ [NC]
RewriteRule ^subdomain/?(.*)$ http://subdomain.website.com/$1 [L,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T14:58:31.910

`.htaccess`在根目录中添加以下行：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^subdomain\.domain\.com$ [NC]
RewriteRule ^/(.*)$ http://subdomain.domain.com/$1 [L,R=301] 
```

# php - 生成数字序列。序列不应该相似

> ID：15588150
> 
> 赞同：1
> 
> 时间：2013-03-23T14:54:27.143
> 
> 标签：php, mysql

我想生成一长串 9 位数字序列。

我们称他们为 ID。

所以每个 ID 都是独一无二的，主要目的是让它们都真正不同。不能接受有 2 个 ID 顺序相差 1 或 2 个数字。

您是否有任何想法如何在不将每个新生成的 ID 与每个先前生成的 ID 进行比较的情况下实现它？

可能已经有一些算法或简单的 MYSQL 函数来比较这些字符串的接近程度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:49:03.127

您可以为您的 ID 尝试以下公式 - 您只需要检查 ID 值是否已存在于表中（`salt`是一个常数，`0`一旦`100`您选择一个值就不会改变 - 我建议使用一个素数，绝对不是`0`）：

```
ID = random integer * 101 + salt; 
```

这会生成如下 ID 值（对于`salt = 73`）：

```
469956305
017775467
001195913
913620520
156482807
577463533
470183959
049290800
078643925
141526626 
```

如果您取其中任意两个 ID 值并比较它们，您会注意到没有两个数字在序列上仅相差一位或两位数。我编写了一个脚本来比较 和 之间所有可能的 ID 值`0`，`3000000`并且没有两个这种形式的 ID 值按顺序相差 1 或 2 个数字。如果您想自己测试一下，这是我使用的脚本（在 C# 中）：http: [//ideone.com/lFHnlX](http://ideone.com/lFHnlX) - 由于 IDEone 超时，我降低了上限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T14:59:02.327

您想避免不检查唯一性*并且*不希望 ID 相似吗？那么你真的在寻找[UUIDs](http://en.wikipedia.org/wiki/UUID) / [GUIDs](http://en.wikipedia.org/wiki/GUID)。

[MySQL 的内置`uuid()`函数](http://dev.mysql.com/doc/refman/5.6/en/miscellaneous-functions.html#function_uuid)将带您到那里。

正如 Robert Harvey 指出的那样，UUID 是字母数字（不是数字）并且长度超过 9 个字符，但是您将不得不牺牲*一些东西*——您不能同时满足所有约束。

# c++ - 广义参数

> ID：15588151
> 
> 赞同：0
> 
> 时间：2013-03-23T14:54:37.690
> 
> 标签：c++

我想知道是否可以有一个函数参数而不关心它的类型是什么。例如，我有一个带有重写 << 运算符的类。但是，它唯一做的就是将参数添加到私有 ostringstream：

```
CLog& CLog::operator <<(const char * txt) {
    buffer << txt;
    return *this;
} 
```

但是，这只允许我将 const char 写入缓冲区。我需要参数是任何类型都`ostringstream <<`可以接受。那可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T14:55:48.527

您可以使用模板：

```
template <typename T>
CLog& CLog::operator <<(const T& p) {
    buffer << p;
    return *this;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T14:55:51.337

这可以通过模板完成：

```
template <class T>
Clog& Clog::operator <<(const T& t) {
    buffer << t;
    return *this;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T14:55:54.527

`template`在这种情况下，您可以使用 a 。

```
template<class T>
CLog& Clog::operator <<(const T& value) {
    buffer << value;
    return *this;
} 
```

确保你没有通过任何无效的东西`ofstringstream`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T14:58:18.527

另一个答案基本上是正确的，但它们不支持移动操作。利用

```
template <typename T>
CLog& CLog::operator <<(T&& p) {
    buffer << std::forward<T>(p);
    return *this;
} 
```

# java - travis java/maven 测试集成 - 运行两个主要的类方法

> ID：15588152
> 
> 赞同：0
> 
> 时间：2013-03-23T14:54:39.257
> 
> 标签：java, maven, testing, travis-ci

我有一个[托管在 github 上](https://github.com/tkoomzaaskz/laughing-thrift-duck)的项目，我想将它与[travis](http://travis-ci.org)集成。我有两个具有`main`方法的类：一个是服务器，另一个是客户端。我使用 NetBeans IDE，我只通过运行服务器文件（一次）然后运行客户端文件（我想要的多次）来测试软件。但这都是手工作业。如何在 travis 上自动执行此操作？我应该使用 maven 吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-25T09:06:18.383

根据 travis 文档（[http://about.travis-ci.org/docs/user/languages/java/](http://about.travis-ci.org/docs/user/languages/java/)），您可以使用以下工具之一：

*   行家
*   毕业典礼
*   蚂蚁

# tinymce - 所见即所得的编辑器与正常粘贴

> ID：15588156
> 
> 赞同：1
> 
> 时间：2013-03-23T14:55:18.073
> 
> 标签：tinymce, wysiwyg

当我尝试将一些文本从 Word 或记事本粘贴到我的 WYSIWYG 编辑器（imperavi）时，它会为每个新行分配`<p></p>`标签。是否可以将其配置为用 just 标记新行`<br/>`？我尝试过使用其他编辑器，但每次都会发生同样的事情：记事本中的新行 - 编辑器中的新段落。

（浏览器：野生动物园）

在 FireFox 中一切正常。新队 -`<br/>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T13:21:36.483

当然，你需要设置配置：

```
tinyMCE.init({
        ...
        force_br_newlines : true,
        force_p_newlines : false,
        forced_root_block : '' // Needed for 3.x
}); 
```

# cross-database - TSQL 中 @@remserver 的替代方案

> ID：15588162
> 
> 赞同：1
> 
> 时间：2013-03-23T14:55:43.610
> 
> 标签：cross-database

希望在表值函数的定义中使用@@REMSERVER。但我看到它会在 SQL Server 的下一个版本中消失。关于如何使用远程 [server\instance] 的身份来影响结果行集的任何想法？

例如在服务器 [MAIN]

```
create view dbo.PartitionedUsers as
Select * from ((Users u inner join Groups g on u.groupid = g.id) 
    inner join servermap s on s.id = g.serverid and s.servername = @@REMSERVER) 
```

在服务器 [GROUP1]

```
CREATE SYNONYM dbo.Users as [MAIN].[catalog].[dbo].[PartitionedUsers] 
```

在服务器 [GROUP2]

```
CREATE SYNONYM dbo.Users as [MAIN].[catalog].[dbo].[PartitionedUsers] 
```

在服务器 GROUP1 上评估时：

```
SELECT * from dbo.Users 
```

将仅包含与映射到该服务器的组有关的行。同样对于其他服务器 GROUP2, ..., GROUPN

ta

# objective-c - 来自不同文件的 addSubview

> ID：15588165
> 
> 赞同：0
> 
> 时间：2013-03-23T14:55:53.663
> 
> 标签：objective-c, cocoa-touch, class

在我正在制作的游戏中，我制作了一个名为 bomb 的类文件。在文件中，我有一个名为 displayBomb 的方法：

```
 - (void) displayBomb
    {
        bombImage = [[UIImageView alloc] initWithFrame:CGRectMake(50, 50, 50, 50)];
    } 
```

该方法应该在屏幕上显示图像。在 ViewDidLoad 的 ViewController.m 文件中，我有：

```
 bomb *bomb1 = [[bomb alloc] init];
    [bomb1 setValue:[UIImage imageNamed:@"image.png"] forKey:@"bombImage"];
    [bomb1 displayBomb]; 
```

但是，它不显示任何内容。我认为问题是我需要类似`[self.view addSubview:bombImage]`. 当我把它放在 ViewController.m 文件中时，它说`Use of undeclared identifier 'bombImage'`. 当我把它放在bomb.m中时，它说`property "view" not found on object of type bomb *`。我想我需要类似的东西`[ViewController.view addSubview:bombImage]`，但它会返回`property "view" not found on object of type ViewController`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:13:30.733

您不能在没有引用的对象上调用方法。你的视图控制器需要知道`bombImage`或者你的炸弹需要知道你的视图控制器。您可以创建`bombImage`一个属性，`bomb`然后在您的视图控制器中执行以下操作：

```
[self.view addSubview:bomb1.bombImage]; 
```

编辑：我分配图像的典型方式`bombImage`如下：

```
bombImage = [[UIImageView alloc] initWithFrame:CGRectMake(50, 50, 50, 50)];
[bombImage setImage:[UIImage imageNamed:@"image.png"]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T17:34:37.280

将视图参数添加到您的方法：

```
 - (void) displayBombOnView:(UIview *)view
    {
        bombImage = [[UIImageView alloc] initWithFrame:CGRectMake(50, 50, 50, 50)];

        [view addSubview:bombImage];
} 
```

在 viewDidLoad 调用方法中：

```
[bomb1 displayBombOnView:self.view];//or which view is on superview 
```

# node.js - 使 Mocha 测试适用于我的 db 模块

> ID：15588167
> 
> 赞同：4
> 
> 时间：2013-03-23T14:55:54.980
> 
> 标签：node.js, express, mocha.js

我是 Mocha 的新手，对 Node/Express 只有一点经验。当我通过我的 Express 应用程序访问它时，我的 DbProvider 模块运行良好（mongodb）。现在我想测试它。我已经阅读了 Mocha 网站和一些我可以找到的教程。但是我很难找到一个我可以遵循的真实世界的例子（非常感谢任何链接！）。

这是我编写测试文件的失败尝试：

```
var DbProvider = require('../db').DbProvider;
var assert     = require('assert');
var dbProvider = new DbProvider('localhost', 27017, 'mydb');
var util       = require('util');

console.log(util.inspect(dbProvider));

describe('DbProvider', function(){
  describe('findAllNotes', function(){
    it('should return some notes', function(){
      dbProvider.findAllNotes({}, function (err, result){
        assert(result.length > 0);
      });
    })
  })
}) 
```

我得到的输出是这样的：

```
$ mocha
{}

  ✖ 1 of 1 test failed:

  1) DbProvider findAllNotes should return some notes:
     TypeError: Cannot call method 'collection' of undefined
      at DbProvider.doOperation (/Users/frode/Node/json/db.js:46:11)
      at DbProvider.findAllNotes (/Users/frode/Node/json/db.js:56:8)
      at Context.<anonymous> (/Users/frode/Node/json/test/test.js:15:18)
(cutting out the rest) 
```

看来我没有成功创建dbProvider。这在我的应用程序中完美运行......我怎样才能使它工作？（也许还有：我设置它的方式一般好吗？）

**编辑：**这是 db.js 文件：

```
// Database related
'use strict';

var MongoClient       = require('mongodb').MongoClient;
var BSON              = require('mongodb').BSONPure;
var ObjectID          = require('mongodb').ObjectID;
var checkForHexRegExp = new RegExp("^[0-9a-fA-F]{24}$");
var Validator         = require('validator').Validator
var fieldMaxLength    = 1024;
//var util              = require('util');

var DbProvider = function(host, port, database) {
  var dbUrl = "mongodb://"+host+":"+port+"/"+database;
  var self = this;
  MongoClient.connect(dbUrl, function(err, db) {
    self.db = db;
  });
};

// Do some basic validation on the data we get from the client/user
var validateParams = function(params, callback) {
  // Let´ do a quick general sanity check on the length on all fields
  for(var key in params) {
    if(params[key].length > fieldMaxLength) callback(new Error('Field ' + key + ' is too long.'));
  }
  // and the let us check some specific fields better
  if (params._id) {
    if(checkForHexRegExp.test(params._id)) {
      // In case of '_id' we also need to convert it to BSON so that mongodb can use it.
      params._id = new BSON.ObjectID(params._id);
    } else {
      var err = {error: 'Wrong ID format'};
    }
  }
  if(err) callback(err);
}

// Generalized function to operations on the database
// Todo: Generalize even more when user authenication is implemented
DbProvider.prototype.doOperation = function(collection, operation, params, callback) {
  validateParams(params, callback);
  var operationCallback = function(err, result) {
    callback(err, result);
  };
  this.db.collection(collection, function(err, collection) {
    if(operation==='find') {
      collection.find().toArray(operationCallback);
    } else {
      collection[operation](params, operationCallback);
    }
  });
}

DbProvider.prototype.findAllNotes = function(params, callback) {
  this.doOperation('notes', 'find', params, callback);
};

DbProvider.prototype.findNoteById = function(params, callback) {
  this.doOperation('notes', 'findOne', params, callback);
};

DbProvider.prototype.saveNote = function(params, callback) {
  params.created_at = new Date();
  this.doOperation('notes', 'save', params, callback);
};

DbProvider.prototype.deleteNote = function(params, callback) {
  this.doOperation('notes', 'remove', params, callback);
};

DbProvider.prototype.findUser = function(params, callback) {
  this.doOperation('users', 'findOne', params, callback);
};

exports.DbProvider = DbProvider; 
```

## **解决方案：**

在 Benjamin 告诉我处理 mongodb 连接到数据库的异步性质后，并受到他关于如何调整代码的建议的启发，我将构造函数 DbProvider 分为两部分。第一部分，构造函数 DbProvider 现在只是将 db 参数保存到一个变量中。第二部分，一个新函数，DbProvider.connect 执行实际的异步连接。见下文。

```
var DbProvider = function(host, port, database) {
  this.dbUrl = "mongodb://"+host+":"+port+"/"+database;
};

DbProvider.prototype.connect = function(callback) {
  var self = this;
  MongoClient.connect(this.dbUrl, function(err, db) {
    self.db = db;
    callback();
  });
}; 
```

所以我现在可以像这样进行 Mocha 测试（并且异步测试也需要包含“完成”，就像你在下面的代码中看到的那样）：

```
var assert     = require('assert');
var DbProvider = require('../db').DbProvider;
var dbProvider = new DbProvider('localhost', 27017, 'nki');

describe('DbProvider', function(){
  describe('findAllNotes', function(){
    it('should return some notes', function(done){
      dbProvider.connect(function(){
        dbProvider.findAllNotes({}, function (err, result){
          assert(result.length > 0);
          done();
        });
      });
    })
  })
}) 
```

请注意，实际测试（“应该返回一些注释”）并不值得骄傲。我在这里想要的是进行设置，以便我能够测试一些东西。现在我终于可以做到这一点，我需要编写好的测试（在有一个测试数据库的行中，清除它，测试插入文档，测试搜索文档，等等......）。

在我的 Express 应用程序中，我曾经这样设置数据库：

```
var DbProvider    = require('./db').DbProvider;
// Setup db instance
var dbProvider = new DbProvider(
  process.env.mongo_host       || 'localhost',
  process.env.mongo_port       || 27017,
  process.env.mongo_db         || 'nki'
); 
```

现在我做同样的事情，但另外，我调用了新的连接函数：

```
// Connect to db. I use (for now) 1 connection for the lifetime of this app.
// And I do not use a callback when connecting here (we do in the testing)
dbProvider.connect(function(){}); 
```

Benjamin 实际上指出，在 Express 应用程序中像这样设置数据库可能没问题，但不是最佳实践。但是，在我弄清楚真正的最佳实践是什么之前，我将保留这段代码。下面是一些关于我发现的主题的链接（但我还没有得出自己将如何解决它的结论）：
[Node.js 上 MongoDB 连接的最佳实践是什么？](https://stackoverflow.com/questions/11799953/whats-the-best-practice-for-mongodb-connections-on-node-js)和
[[node-mongodb-native] MongoDB 初学者最佳实践](http://grokbase.com/t/gg/node-mongodb-native/131vnymxyr/mongodb-best-practices-for-beginner)

如果你喜欢，非常欢迎你在 github 上关注/fork/whatever 这个项目。我的目标是尽我所能将其做好生产准备。链接是 [https://github.com/frodefi/node-mongodb-json-server](https://github.com/frodefi/node-mongodb-json-server)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:15:19.043

`MongoClient.connect`是[异步](http://mongodb.github.com/node-mongodb-native/api-generated/mongoclient.html)的。

从文档：

> 回调（函数）——这将在执行此方法后被调用。如果发生错误，第一个参数将包含 Error 对象，否则为 null。而第二个参数将包含初始化的 db 对象，如果发生错误，则为 null。

这意味着`DbProvider.db`尚未在测试中设置，这就是您获得`undefined`.

在这里：

```
MongoClient.connect(dbUrl, function(err, db) {
    self.db = db;
}); 
```

您告诉它“连接发生后更新 self.db”，这至少是在此事件循环之后的一个事件循环滴答声（但可能更多）。在您的代码中，您在创建实例后立即`mocha`执行您的`.describe`和方法，这意味着它尚未初始化。`.it``DbProvider`

我建议您重新考虑`DbProvider`以返回回调而不是构造函数。也许是这样的：

```
var getDbProvider = function(host, port, database,callback) {
  var dbUrl = "mongodb://"+host+":"+port+"/"+database;
  MongoClient.connect(dbUrl, function(err, db) {
    self.db = db;
    callback(db);
  });
}; 
```

这也意味着将所有`DBProvider`方法移动到一个对象（也许回调将返回一个`dbprovider`对象而不仅仅是一个数据库？）。

使用单元测试解决了另一个错误:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T05:34:46.103

This is what I used: [https://github.com/arunoda/mocha-mongo](https://github.com/arunoda/mocha-mongo)

It has set of testing helpers for mongodb

# haskell - 有人可以对这个单子变换片段脱糖吗？

> ID：15588173
> 
> 赞同：1
> 
> 时间：2013-03-23T14:56:37.163
> 
> 标签：haskell, monad-transformers

用这个方便的 do-notation 写的，这对我来说似乎很清楚。但我似乎无法让脱糖版本`>>=`用于工作，这令人担忧。有人可以用扩展符号重写这些吗？

未嵌套

```
stack1 :: StateT Int Identity ( Int, Int )
stack1 = do
    a <- get 
    put ( a + 1 )
    b <- get
    return ( a, b )

runstack1 :: ( Int, Int )
runstack1 = evalState stack1 11 
```

嵌套

```
stack3 :: StateT Int ( StateT String ( StateT String Identity ) ) ( Int, String, String )
stack3 = do
    modify (+10)
    lift $ modify ( ++ " world" )
    lift . lift $ modify ( ++ " word" )
    a <- get
    b <- lift get
    c <- lift . lift $ get
    return ( a, b, c )

runStack3 :: ( Int, String, String )
runStack3 = runIdentity $ evalStateT ( evalStateT ( evalStateT runStack3 1 ) "hello" ) "harro" 
```

此外，通过比较 runStack1 和 runStack3 的签名，我可以看到为什么`runIdentity`需要，但是有人可以解释为什么会这样的内部原因，因为 stack1 和 stack3 都包装了 Identity 构造函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:23:21.557

嵌套示例的脱糖版本：

```
stack4 :: StateT Int ( StateT String ( StateT String Identity ) ) ( Int, String, String )
stack4 = modify (+10) >>= \_ ->
         (lift $ modify ( ++ " world" )) >>= \_ ->
         (lift . lift $ modify ( ++ " word" )) >>= \_ ->
         get >>= \a ->
         lift get >>= \b -> 
         (lift . lift $ get) >>= \c ->
         return (a,b,c) 
```

在应用风格中：

```
import Control.Applicative

stack5 :: StateT Int ( StateT String ( StateT String Identity ) ) ( Int, String, String )
stack5 = modify (+10) *> 
         (lift $ modify ( ++ " world" )) *>
         (lift . lift $ modify ( ++ " word" )) *>  
         ((,,) <$> get <*> lift get <*> (lift . lift $ get)) 
```

此外，Lambdabot 可以执行自动脱糖，请参阅[此问题](https://stackoverflow.com/questions/8019670/desugaring-do-notation-for-monads)。

至于对 的需求`runIdentity`，这并没有什么神秘之处。您必须打开 monad 堆栈的每一层才能获得内部的值，并且`Identity`恰好在堆栈中。现在，`State`monad 可以用`StateT`和来实现`Identity`，但在这种情况下，用户会看到一个隐藏内部机制的“统一视图”。如果您检查包`runState`中的源代码`transformers`，您会看到它在`runIdentity`内部调用。

# antlr - 没有来自 CommonTokenStream 的令牌使用 Antlr

> ID：15588177
> 
> 赞同：1
> 
> 时间：2013-03-23T14:56:45.903
> 
> 标签：antlr, grammar

我是 Antlr 的新手。我写了一点语法来练习，但被 API CommonTokenStream 搞糊涂了

```
lexer grammar Expr;
options {
  language = Java;
}

EXPRS:EXPRT {System.out.println($EXPRT.text);};
fragment
EXPRT : 'xxx' ID {System.out.println($ID.text);} ' zzz';
fragment 
ID : ('a'..'z' |'A'..'Z' |'_' )('a'..'z' |'A'..'Z'|'_')*; 
```

测试代码是这样的：

```
ANTLRStringStream input = new ANTLRStringStream(msg);
Expr expr = new Expr(input);
CommonTokenStream cs = new CommonTokenStream(expr);
System.out.println(cs.size()); 
```

无论输入是什么，CommonTokenStream 都没有令牌。但是，当我直接使用 expr 时，它会输出。有谁知道为什么？antlr的版本是3.5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T01:25:48.123

`CommonTokenStream`被延迟初始化。要强制它立即填充所有标记（通过调用`nextToken`您的词法分析器直到到达 EOF），您可以调用该`fill()`方法：

```
CommonTokenStream cs = new CommonTokenStream(expr);
cs.fill();
System.out.println(cs.size()); 
```

# swt - “导航栏”SWT 控件

> ID：15588178
> 
> 赞同：2
> 
> 时间：2013-03-23T14:56:46.590
> 
> 标签：swt

是否已经有人在 IDEA 中编写了类似“导航栏”的 SWT 控件？对于那些不知道我的意思的人：它看起来像

```
path1 > path2 > path3 > 
```

其中每个“路径”都是模拟一个按钮的完整路径的一部分，该按钮可以单击并显示一个弹出窗口，例如轻松切换到当前打开文件的不同并行目录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T18:00:01.550

您是否检查了以下链接：

1.  [swtbreadcrumb](http://sourceforge.net/projects/swtbreadcrumb/)和
2.  [面包屑](http://code.google.com/a/eclipselabs.org/p/opal/wiki/Breadcrumb)

# mysql - 使用 IF 语句创建 SQL 存储过程

> ID：15588179
> 
> 赞同：0
> 
> 时间：2013-03-23T14:56:48.297
> 
> 标签：mysql, sql

我正在尝试在 PHPmyadmin 中创建一个存储过程，但它似乎不喜欢我的 IF 语句。谁能帮我确定我做错了什么：

SQL：

```
CREATE PROCEDURE get_products_in_category(IN inCategoryID INT, 
IN inShortDescriptionLength INT, IN inProductsPerPage INT, IN inStartItem INT)

BEGIN
"SELECT p.productID, p.name, IF(LENGTH(p.description) <= ?, p.description, 
 CONCAT(LEFT(p.description, ?), '...')) AS description, p.price, p.discounted_price, 
 p.thumbnail FROM tblProducts p

INNER JOIN tblProdCat pc
ON pc.productID = p.productID
WHERE tblProdCat.categoryID = ?
ORDER BY p.display DESC
LIMIT ?, ?";

SET @p1 = inShortDescriptionLength;
SET @p2 = inShortDescriptionLength;
SET @p3 = inCategoryID;
SET @p4 = inStartItem;
SET @p5 = inProductsPerPage;

END$$ 
```

我收到以下错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的 '"SELECT p.productID, p.name, IF(LENGTH(p.description) <= ?, p.description, CONCA' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:05:09.973

我想你想执行*Dynamic SQL*，

```
DELIMITER $$
CREATE PROCEDURE get_products_in_category
(
    IN inCategoryID INT, 
    IN inShortDescriptionLength INT, 
    IN inProductsPerPage INT, 
    IN inStartItem INT
)
BEGIN

    SET @sql = CONCAT('SELECT   p.productID, 
                                p.name, 
                                IF(CHAR_LENGTH(p.description) <= ?, p.description, CONCAT(LEFT(p.description, ?), ''...'')) AS description, 
                                p.price, 
                                p.discounted_price, 
                                p.thumbnail 
                        FROM    tblProducts p
                                INNER JOIN tblProdCat pc
                                    ON pc.productID = p.productID
                        WHERE   pc.categoryID = ?
                        ORDER   BY p.display DESC
                        LIMIT   ',inStartItem, ', ',inProductsPerPage);

    PREPARE stmt1 FROM @sql;
    SET @p1 = inShortDescriptionLength;
    SET @p2 = inShortDescriptionLength;
    SET @p3 = inCategoryID;

    EXECUTE stmt1 USING @p1, @p2, @p3;
    DEALLOCATE PREPARE stmt1;
END $$
DELIMITER ; 
```

*   [准备好的语句的 SQL 语法](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)

# ruby-on-rails - Rails：无法从浏览器运行服务器

> ID：15588181
> 
> 赞同：0
> 
> 时间：2013-03-23T14:56:52.433
> 
> 标签：ruby-on-rails

我正在 Windows 7 平台上创建一个 rails 应用程序：

`rails new test`

然后我通过命令启动这个服务器：

`rails server`

有一个通知：

```
rails 3.2.1 application starting in development on http://0.0.0.0:3000 
```

但是当我进入浏览器并输入 :`http://0.0.0.0:3000`但我收到页面不可用。

这让我很头疼。请告诉我如何解决这个问题。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:06:06.803

访问它

本地主机：3000

0.0.0.0 不是最简单的 IP 地址

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T18:21:51.597

你应该试试

```
http://127.0.0.1:3000 
```

它用于本地主机 IP 地址。

使用的 IP 地址 0.0.0.0 是未使用的保留 IP 地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:05:25.277

在启动服务器之前安装包

```
bundle install 
```

# android - 如何用虚线文本和水平滚动显示文本视图

> ID：15588182
> 
> 赞同：-1
> 
> 时间：2013-03-23T14:56:52.830
> 
> 标签：android, android-widget

这是我的布局

```
<HorizontalScrollView
    android:layout_width="175dp"
    android:layout_height="match_parent"
    android:scrollbarFadeDuration="5">

<TextView
    android:id="@+id/documentName"
    android:layout_width="175dp"
    android:layout_height="match_parent"
    android:gravity="center_vertical"
    android:paddingLeft="5dp"
    android:scrollHorizontally="true"
    android:selectAllOnFocus="true"
    android:singleLine="true"
    android:text="Untitled Document123456789"
    android:textColor="#ffffff"
    android:textSize="20dp" />
</HorizontalScrollView> 
```

案例1：当我单独使用文本视图时，它显示无标题文档...（...）表示某些文本被隐藏但我没有得到水平滚动。然后我用水平滚动包围文本视图，我得到了滚动，但没有表示某些文本的虚线文本被隐藏

如果遗漏任何内容，请更正我的布局。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:10:07.870

将此添加到您的文本视图

```
android:ellipsize="start" 
```

除了 start 你可以有其他值：end, middle ...你可以查看[http://developer.android.com/reference/android/widget/TextView.html#attr_android:ellipsize](http://developer.android.com/reference/android/widget/TextView.html#attr_android:ellipsize)

# select - 选择具有特定 id 的最后一个孩子

> ID：15588186
> 
> 赞同：0
> 
> 时间：2013-03-23T14:57:42.630
> 
> 标签：select, html

所以事情是这样的：

```
<div id="wrapper" > <div id="x"></div ><div id="x"></div ><div id="x"></div><div id="y"></div>
</div> 
```

那么我如何在包装器内选择最后一个 id=x 而不是 y 的 div 呢？抱歉，但我不知道如何粘贴代码以使其可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:02:57.190

ID 是唯一的，因此要选择它，您应该只使用

```
#x {} 
```

我会质疑你为什么要使用多个 id，也许一个类会更好？

*编辑* 刚刚注意到您粘贴了一些代码。

你真的不应该像现在这样使用 ID，你需要使用类替换你的 id：

```
class="x" 
```

如果仅适用于现代浏览器，您可以使用 last-of-type 选择器

```
.x:last-of-type 
```

如果回到 IE6，你总是可以添加一个像 last 这样的类，然后选择它

```
class="x last"

.x.last {} 
```

*编辑*问题

要使用您的包装选择，请将其添加到选择器的前面：

```
#x .x.last {
    /** css goodness here **/
} 
```

# c# - IEnumerable 方法

> ID：15588187
> 
> 赞同：0
> 
> 时间：2013-03-23T14:57:44.503
> 
> 标签：c#

我在一本 C# 书中找到了这个例子，有人可以解释为什么当 Fibs 方法只需要一个列表时，你可以将它传递给 EvenNumbersOnly 方法吗？

```
static void Main()
{
    foreach (int fib in EvenNumbersOnly (Fibs(6)))
        Console.WriteLine (fib);
}

static IEnumerable<int> Fibs (int fibCount)
{
   for (int i = 0, prevFib = 1, curFib = 1; i < fibCount; i++)
   { 
        yield return prevFib;
        int newFib = prevFib+curFib;
        prevFib = curFib;
        curFib = newFib;
   }
}

static IEnumerable<int> EvenNumbersOnly (IEnumerable<int> sequence)
{
   foreach (int x in sequence)
       if ((x % 2) == 0) {
        yield return x;
       }    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T14:59:43.997

它期望`IEnumerable<int>`，正如参数类型明确指出的那样。而且您传递的是执行方法的结果，而不是方法本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:06:19.247

代码 int`Main`方法等价于：

```
static void Main()
{
    IEnumerable<int> values = Fibs(6);

    foreach (int fibValue in EvenNumbersOnly(values))
        Console.WriteLine (fibValue);
} 
```

所以`Fibs`方法不会传递给`EvenNumbersOnly`方法。

# php - 无法从变量中获取数据

> ID：15588193
> 
> 赞同：0
> 
> 时间：2013-03-23T14:58:10.570
> 
> 标签：php, json, variables, curl

我提出了一个 curl 请求。我将 curl 指令放在一个类函数中：

```
class Curly {
  var $data;

  function GetRequest($url) {
    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    $this->data = curl_exec($ch);
    curl_close($ch);
    //this is what i was missing --> return $this->data;
  } 
```

我将数据库查询放在另一个类函数中。

```
include('class.curly.php');

class mongoSearchForInfoOnEsd {
  public function getEsdsFbInfo($esdID) {
    $mongoApiKey = "xx";
    $requestParams= "xx";
    $url = "xx";

    $fbInfo = (new Curly)->GetRequest($url);
    //this is what i was missing --> return $fbInfo;
  } 
```

在 index.php 中，来自 webhook 的 HTTP 帖子正在通过，其中处理通过一些字符串解析以获取 2 个 id。然后我将其中一个 id 发送到 mongodb curl 请求，一切顺利。正确的响应回来了，我只知道 curl 类中 var_dump 的 var_dump 的这个 b/c ......但是在索引文件中我正在努力从 var 中获取数据并分配它的值到我想要的任何变量。

我怎样才能把数据拿出来？我知道它在那里，但在哪里？我太难了。

```
# get ytID from http post
#get EsdID from http post
$httpPostData = file_get_contents('php://input');
$postDataDecoded = urldecode($httpPostData);
$ytID = substr($postDataDecoded, strpos($postDataDecoded, "docid=") + strlen("docid="), );
$esdID = substr($postDataDecoded, strpos($postDataDecoded, "m\": \"") + strlen    ("m\": "),;
*$esdData = (new mongoSearchForInfoOnEsd)->getEsdsFbInfo("$esdID");*
$obj = json_decode($esdData, true);
echo $obj; 
```

好的，我添加了返回，我可以看到数据，但是没有操作对返回的数据起作用。

编辑 ---> 将 return 放入两个类中，现在它已完全可操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:04:38.957

仅仅因为您正在为类变量赋值`data`并不意味着当您调用函数 getRequest 时会返回该值。因此，为了使用来自外部类的数据，您需要`return`最终值：

```
function GetRequest($url){
    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    $this->data = curl_exec($ch);
    curl_close($ch);

    return $this->data;
} 
```

您甚至可能不需要保留变量`$data`，除非您的代码中有更多未显示的内容，否则您可以简单地返回`curl_exec($ch)`

要从下面的评论中进一步回答您的问题，这来自[php.net](http://php.net/manual/en/function.var-dump.php)：

> 此函数显示有关一个或多个表达式的结构化信息，包括其类型和值。使用缩进显示结构的值递归地探索数组和对象。

如您所见，`var_dump`仅用于*显示目的*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:07:01.643

正如lazyhammer 所说，您需要在方法 GetRequest($url) 的末尾编写以下内容

```
return $this->data; 
```

此外，在一个类中， a`function`被称为 a `method`。

更明确地说。

`var_dump`不返回数据。它只是将它们发送到将显示它的客户端（您的浏览器）。

要将方法中计算的数据返回给调用者，您需要`return`在方法末尾使用关键字。当您的计算机将看到`return`他将数据带回给呼叫者时。这意味着您编写的所有内容`return`都不会被执行。

# python - python正则表达式从unicode输出中删除u'some text'

> ID：15588196
> 
> 赞同：0
> 
> 时间：2013-03-23T14:58:17.340
> 
> 标签：python, regex

我有一个正在运行的应用程序，它错误地将 u'text' 存储到所有数据库字段中。我现在需要创建一个脚本来读取这些字段并将 u'text' 替换为文本。

任何人都可以帮助我如何在 python 中编写这样的正则表达式，它会读取以 u' 开头的字符串的开头和以 ' 结尾的字符串结尾，然后什么都不替换它们。我尝试了几种方法，但我非常正则表达式不好。

任何帮助将不胜感激，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T09:30:25.433

`u" "`请注意，如果字符串包含单引号，则您可能有一些由 分隔的字符串。此外，可能存在转义序列。`ast.literal_eval`可以为您处理所有这些：

```
from ast import literal_eval

def convert(original):
    try:
        result = literal_eval(original)
        if isinstance(result, unicode):
            return result
    except ValueError:
        pass
    return original 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:01:15.663

这应该这样做：

```
import re
re.sub("^u'(.*)'$",r'\1',"u'text'")
-> text 
```

这将适用于没有前导/尾随字符的单个值字符串（例如“u'text'”）。

如果你想替换字符串中所有出现的 u'text'，你可以这样做：

```
re.sub("u'([^']*)'",r'\1',STRING) 
```

例如：

```
re.sub("u'([^']*)'",r'\1',"u'value1',u'value2',u'value3'")
-> value1,value2,value3 
```

# c++ - 使用 OpenMP 做多少工作才有意义？

> ID：15588197
> 
> 赞同：0
> 
> 时间：2013-03-23T14:58:17.563
> 
> 标签：c++, performance, openmp

我最近开始研究使用 OpenMP 进行并行化，并找到了大量描述如何使用它的好资源。但是，我无法找到关于并行化何时开始有意义的文档，或者换句话说：并行化开始补偿 OpenMP 线程创建开销的转折点在哪里？在什么情况下最好不使用它？工作有多复杂，所以并行化它才有意义？

是否有任何可用的文档或指南？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:09:57.950

根据我自己的经验，如果您的计算非常适合并行化，那么如果串行计算（例如您想要并行化的循环）需要几毫秒，您可以期待获得可观的收益。低于 1 毫秒，由于涉及的开销，使用多个线程将无济于事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T14:59:37.987

图像处理就是一个很好的例子……我在对两个连续的图像运行 sift 和 surf 时使用它。

# objective-c - 获取 nil 对象的类类型？

> ID：15588199
> 
> 赞同：2
> 
> 时间：2013-03-23T14:58:21.507
> 
> 标签：objective-c

如果我有一个已经分配的对象，那么 do 会`object.class`返回一个非零值。到目前为止，一切都很好。但是，如果尚未分配对象，则访问`object.class`返回`nil`。

我想根据对象的类型动态分配对象，例如：

```
@property NSArray *myArray;
...

// myArray is nil so far

self.myArray = [_myArray.class new]; 
```

但是，我不能这样做，因为`_myArray.class`返回零。那么如何确定 nil 实例的类类型呢？

**更新：** 实际上是可能的。在下面查看我的[答案](https://stackoverflow.com/a/15588765/458960)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:01:32.963

您无法确定`nil`实例的类，因为它没有类：从字面上看，它可以是从变量类型派生的任何类型。例如，`NSMutableArray`完全兼容`NSArray`：

```
NSArray *myArray = [NSArray new]; // OK
NSArray *myArray = [NSMutableArray new]; // Also OK 
```

由于不同子类的运行时功能可能会有很大差异，因此始终由您的程序决定它想要什么样的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T15:06:34.683

Objective-C 是一种鸭式语言。这意味着有几件事你可以做或不能做，其中一件你不能做的是静态地获取对变量类型的引用。

具体来说，在你的表达中：

```
[_myArray.class new] 
```

首先，`_myArray.class`被评估，然后将结果发送到`new`消息中。既然`_myArray`是`nil`开始，也会`_myArray.class`返回`nil`，并且`new`消息也会返回`nil`，因为发送任何消息`nil`都会返回`nil`（或返回类型具有的最接近零的表示形式）。这就是为什么它不起作用。

我怀疑你来自像 C# 这样的强类型语言；你现在所做的相当于`Foo foo = (Foo)Activator.CreateInstance(foo.GetType())`，这肯定会失败，因为`foo.GetType()`它不会编译或抛出异常（取决于它是类字段还是局部变量），因为它从未被赋值。在 Objective-C 中，它可以编译但不起作用。您想要的是`Activator.CreateInstance(typeof(Foo))`.，但请注意，`Foo`这里现在也已硬编码，因此您不妨创建一个`new Foo()`.

您说编译器“知道对象的类型”。这并不完全正确。首先，`NSArray`和`NSMutableArray`是`NSArray`类簇的根类。这意味着两者都是抽象的，`[NSArray alloc]`并且`[NSMutableArray alloc]`返回一个子类的实例（`NSCFArray`上次我检查过，可能还有别的东西；我记得看过`_NSArrayM`）。也许`[NSArray new]`有效，但它并没有给你一个简单的`NSArray`.

其次，没有强制执行类型安全。考虑这段代码：

```
id foo = @"foo";
NSArray* bar = foo; // no warning! 
```

因此，即使编译器认为这`bar`是 a `NSArray`，它实际上是 a `NSString`。如果我们插入您的代码：

```
id foo = @"foo";
NSArray* bar = foo; // no warning!
NSArray* baz = [bar.class new]; 
```

`baz`现在`NSString`也是。由于您要求 的运行时类`bar`，因此编译器与操作无关。

正是由于这种行为，您可能应该使用*您*知道的类来实例化您的对象，`[NSArray new]`而不是相信`_myArray`它是非`nil`的，并且是您认为的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T15:03:51.757

您必须初始化该属性，否则它将为 nil，向 nil 对象发送消息，它将返回 nil，因此，您必须首先初始化数组，如`_array = [[NSArray alloc] init];`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:51:24.450

因此，对于任何想知道这是否可能的人，它是：

```
objc_property_t property = class_getProperty(self.class, "myArray");
const char * const attrString = property_getAttributes(property);
const char *typeString = attrString + 1;
const char *next = NSGetSizeAndAlignment(typeString, NULL, NULL);
const char *className = typeString + 2;
next = strchr(className, '"');
size_t classNameLength = next - className;
char trimmedName[classNameLength + 1];

strncpy(trimmedName, className, classNameLength);
trimmedName[classNameLength] = '\0';
Class objectClass = objc_getClass(trimmedName);

NSLog(@"%@", objectClass); 
```

输出：

> NSArray

[在extobjc](https://github.com/jspahrsummers/libextobjc/blob/master/extobjc/EXTRuntimeExtensions.m)的帮助下完成。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-23T15:04:44.673

## Nil 没有类类型

在 Objective-C 中，实例变量上的实际类仅在运行时确定。因此，您无法知道 nil 对象的类别。

这在您的情况下不是问题，因为您只需要执行以下操作：

```
NSArray *myArray = [NSArray new]; 
```

或者

```
NSArray *myArray = [[NSArray alloc] init]; 
```

## 在 Objective-C 中，大多数决策都推迟到运行时

（越多越好）

> Objective-C 是一种面向运行时的语言，这意味着在可能的情况下**，它会将关于实际执行什么的决定**从编译和链接时间推迟到它实际**在运行时**执行的时间。
> 
> 这为您提供了很大的灵活性，您可以根据需要将消息重定向到适当的对象，或者您甚至可以有意交换方法实现等。
> 
> 这需要使用一个运行时，它可以内省对象以查看它们做什么&不响应和适当地分派方法。如果我们将此与 C 之类的语言进行对比。在 C 中，您从 main() 方法开始，然后从那里它几乎是一个自上而下的设计，在您编写代码时遵循您的逻辑并执行函数。AC struct 无法将请求以执行功能转发到其他目标。

*资料来源：[了解 Objective-C 运行时](http://cocoasamurai.blogspot.fr/2010/01/understanding-objective-c-runtime.html)*

# jetty - 如何在 Debian Wheezy 的 Jetty 8 中启用 JSP 支持？

> ID：15588200
> 
> 赞同：3
> 
> 时间：2013-03-23T14:58:25.513
> 
> 标签：jetty, debian

我有一个 Debian Wheezy 服务器，我想使用 Jetty 将 Java Web 应用程序部署为 .war 文件。我正在尝试配置 Jetty 以正确显示基本的 jsp 页面，以便我可以假设我有一个工作的 Jetty 服务器配置，然后再走得太远。但是，我在配置 JSP 支持时遇到了一些问题，而且在查找 Debian 特定文档时运气不佳。

我已经通过`jetty8`and`libjetty8-java`包安装了 Jetty 8，并通过 IntelliJ IDEA 创建了一个应用程序；生成的 .war 仅包含一个 index.jsp 和一个 WEB-INF/web.xml 文件。web.xml 文件包含以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
             http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         version="3.0">
</web-app> 
```

index.jsp 文件包含以下内容：

```
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
  <head><title>Test</title></head>
  <body>Test</body>
</html> 
```

那里没有什么太花哨的。然后我在 Jetty 中启用了 JSP 支持，方法是更改`JETTY_ARGS`​​为`/etc/default/jetty8`，`OPTIONS=default,jsp`将 .war 放入`$JETTY_HOME/webapps`，然后重新启动 Jetty 服务器。

尝试加载页面失败并在日志中留下此错误：

```
2013-03-22 22:39:38.914:INFO:oejs.Server:jetty-8.1.3.v20120416
2013-03-22 22:39:39.034:WARN:oejw.WebAppContext:Failed startup of context o.e.j.w.WebAppContext{,file:/var    /lib/jetty8/webapps/root/},file:/var/lib/jetty8/webapps/root/
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[...snip...]
        at org.eclipse.jetty.start.Main.invokeMain(Main.java:457)
        at org.eclipse.jetty.start.Main.start(Main.java:602)
        at org.eclipse.jetty.start.Main.main(Main.java:82)
Caused by:
java.lang.NoClassDefFoundError: org/apache/tomcat/PeriodicEventListener
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
[...snip...]
        at org.eclipse.jetty.start.Main.start(Main.java:602)
        at org.eclipse.jetty.start.Main.main(Main.java:82) 
```

这导致我包含`tomcat-api.jar`in `$JETTY_HOME/lib/ext`，然后导致我包含`tomcat-juli.jar`（更正 NoClassDefFoundError 的`org.apache.juli.logging.LogFactory`），最后`tomcat-jasper-el.jar`（更正 NoClassDefFoundError 的`org.apache.el.ExpressionFactoryImpl`）。

我的类路径中当前与 JSP 相关的 jar 如下所示：

```
/usr/share/jetty8/lib$ ls -l jsp
total 0
lrwxrwxrwx 1 root root 28 Jun 25  2012 javax.el.jar -> ../../../java/el-api-2.2.jar
lrwxrwxrwx 1 root root 29 Jun 25  2012 javax.servlet.jsp.jar -> ../../../java/jsp-api-2.2.jar
lrwxrwxrwx 1 root root 25 Jun 25  2012 javax.servlet.jsp.jstl.jar -> ../../../java/jstl1.1.jar
lrwxrwxrwx 1 root root 31 Jun 25  2012 org.apache.jasper.jar -> ../../../java/tomcat-jasper.jar
lrwxrwxrwx 1 root root 26 Jun 25  2012 org.apache.taglibs.standard.jar -> ../../../java/standard.jar
/usr/share/jetty8/lib$ ls -l ext
total 0
lrwxrwxrwx 1 root root 28 Mar 23 09:59 tomcat-api.jar -> ../../../java/tomcat-api.jar
lrwxrwxrwx 1 root root 34 Mar 23 09:45 tomcat-jasper-el.jar -> ../../../java/tomcat-jasper-el.jar
lrwxrwxrwx 1 root root 29 Mar 23 09:43 tomcat-juli.jar -> ../../../java/tomcat-juli.jar 
```

目录中的 jars`jsp`是默认 Jetty 安装提供的那些，而我已将我的添加到`ext`.

我目前的错误是这样的：

```
java.lang.IllegalStateException: No org.apache.tomcat.InstanceManager set in ServletContext
        at org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(InstanceManagerFactory.java:35)
        at org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:171)
        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369)
        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:598)
[...snip...]
        at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:46)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)
        at java.lang.Thread.run(Thread.java:679) 
```

根据研究，如果我在 .war 中包含 tomcat 库，似乎会发生这种情况，但我没有。我不完全确定从哪里开始，而且我没有任何运气找到涵盖此内容的文档。

有没有人成功地在 Debian Wheezy 中使用 Jetty 8 并启用 JSP，或者有任何想法我可能在尝试时出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T13:27:09.117

我在 AWS 上使用 jetty8/Ubuntu 12.10 配置 servlet 注释，并且遇到了类似的问题。好吧，至少直到 PeriodicEventListener NCDFE/CNF 异常——在那之后，与你不同，我没有持久性开始添加随机 Tomcat JAR。;-)

就我而言，通过缩小 start.config 中的 OPTIONS 规范来解决问题。我懒惰地使用了“All”，它当然应该是合法的，但比严格要求的要宽。将规范更改为“annotations,plus,default,*”就可以了。我还没有检查确切的原因，但我认为“All”加载的多余 JAR 之一具有未解决的依赖关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T12:09:22.000

经过几个步骤后，我已经能够让它工作：

*   确保安装了以下软件包：libtomcat6-java、libecj-java、libjstl1.1-java、libservlet3.0-java 显然还有 jetty8。
*   在 /usr/share/jetty8/lib/abc 中创建一个新目录。明智地选择“abc”目录的名称，它似乎具有至关重要的影响。Jetty/Debian 以某种方式按字母顺序对类路径或目录名称进行排序。
*   在“abc”目录中添加以下符号链接：

-

```
ecj.jar -> ../../../java/ecj.jar
jasper-el.jar -> ../../../java/jasper-el.jar
jasper.jar -> ../../../java/jasper.jar
jstl1.1.jar -> ../../../java/jstl1.1.jar
tomcat-el-api-2.2.jar -> ../../../java/tomcat-el-api-2.2.jar
tomcat-jsp-api-2.2.jar -> ../../../java/tomcat-jsp-api-2.2.jar
tomcat-juli.jar -> ../../../java/tomcat-juli.jar 
```

*   通过将以下行添加到 /etc/default/jetty8 来配置 jetty 以使用新的 lib 目录

    JETTY_ARGS="选项=默认，abc"

*   启动码头8

灵感来自 James Page 的这篇文章：[https ://lists.debian.org/debian-java/2012/05/msg00132.html](https://lists.debian.org/debian-java/2012/05/msg00132.html)

# ruby-on-rails - ruby 在与 webapp 不同的进程中运行代码

> ID：15588202
> 
> 赞同：2
> 
> 时间：2013-03-23T14:58:26.930
> 
> 标签：ruby-on-rails, ruby, multithreading, process, multiprocessing

我有一个带有工作类（worker.rb）的文件，我需要在获取命令后在与 rails 应用程序不同的进程中实例化它。我目前正在开发 Windows 操作系统。

那么该怎么做呢？

PS 该代码可以在 unix/linux 环境中工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T18:08:32.620

查看`foreman`

[https://github.com/ddollar/foreman](https://github.com/ddollar/foreman)

您可以`Procfile`在 Rails 根目录中添加启动 Rails 服务器和工作程序的说明，然后运行`foreman start`以启动它们。这是一个示例 Procfile：

```
web: bundle exec unicorn_rails -p 8088
scheduler: bundle exec rake resque:scheduler
worker: bundle exec rake resque:work 
```

Foreman 与 Windows 和 Linux 兼容，因此无论您的平台如何，它都应该可以工作。

# apache - Apache - 使用 .htaccess 将 /folder 重定向到 /folder/index.php

> ID：15588211
> 
> 赞同：2
> 
> 时间：2013-03-23T14:59:00.030
> 
> 标签：apache, redirect, directory, rewrite, invisible

当有人来访时

`http://127.0.0.1/something`

我想将他重定向到

`http://127.0.0.1/something/index.php`

使用.htaccess。

1.  我怎样才能做到这一点？
2.  是否可以在不向用户显示他们被重定向的情况下做到这一点，就像 YouTube 所做的那样 (YouTube.com/user/channel/videos/)

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:37:50.183

我终于找到了怎么做。

警告：我没有使用 mod_rewrite 的经验，所以这可能不是最好的解决方案。不过它对我有用。

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUESTFILENAME} !-f
RewriteRule ^(.*)/$ /$1/index.php [L]
</IfModule> 
```

# mocking - 使用模拟 HttpMessageHandler 时如何使用 HttpClient 管理 cookie

> ID：15588214
> 
> 赞同：4
> 
> 时间：2013-03-23T14:59:17.963
> 
> 标签：mocking, httpcookie, dotnet-httpclient

`HttpRequestMessage`我有一个单元测试，它通过传入实例并接收实例来调用类库`HttpResponseMessages`。在这方面，它与测试 WebApi 非常相似`ApiController`。

我正在测试的代码将 cookie 添加到`HttpResponseMessage`，并希望在随后的传入`HttpRequestMessage`调用中看到这些 cookie，这就是浏览器（或`HttpWebRequest`）的行为方式。

我没有使用`HttpClientHandler`，因为请求实际上并没有在网络上进行，而是使用`HttpMessageHandler`我初始化的模型传递给产品`HttpClient`。因此，我无法访问其中的 cookie 处理`HttpClientHandler`。似乎要获得我需要的 cookie 行为，我将不得不手动解析 cookie 中的 cookie，`HttpResponseMessage`然后手动将它们序列化为`HttpRequestMessage`. 这也完全忽略了 CookieContainer 将 cookie 正确应用于正确请求的逻辑。

有没有更简单的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T16:01:50.293

我自己编写了一个`DelegatingHandler`为我管理 cookie 的程序。我还写了几个扩展方法，`CookieContainer`以便可以轻松地与`HttpRequestMessage`and一起使用`HttpResponseMessage`：

```
internal class DangerouslySimpleCookieContainer : DelegatingHandler {
    internal DangerouslySimpleCookieContainer(CookieContainer cookieContainer = null) {
        this.Container = cookieContainer ?? new CookieContainer();
    }

    internal DangerouslySimpleCookieContainer(HttpMessageHandler innerHandler, CookieContainer cookieContainer = null)
        : base(innerHandler) {
        this.Container = cookieContainer ?? new CookieContainer();
    }

    public CookieContainer Container { get; set; }

    protected override async Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken) {
        this.Container.ApplyCookies(request);
        var response = await base.SendAsync(request, cancellationToken);
        this.Container.SetCookies(response);
        return response;
    }
}

internal static class CookieContainerExtensions {
    internal static void SetCookies(this CookieContainer container, HttpResponseMessage response, Uri requestUri = null) {
        Requires.NotNull(container, "container");
        Requires.NotNull(response, "response");

        IEnumerable<string> cookieHeaders;
        if (response.Headers.TryGetValues("Set-Cookie", out cookieHeaders)) {
            foreach (string cookie in cookieHeaders) {
                container.SetCookies(requestUri ?? response.RequestMessage.RequestUri, cookie);
            }
        }
    }

    internal static void ApplyCookies(this CookieContainer container, HttpRequestMessage request) {
        Requires.NotNull(container, "container");
        Requires.NotNull(request, "request");

        string cookieHeader = container.GetCookieHeader(request.RequestUri);
        if (!string.IsNullOrEmpty(cookieHeader)) {
            request.Headers.TryAddWithoutValidation("Cookie", cookieHeader);
        }
    }
} 
```

# json - 如何在 jQuery 中添加 JSP 变量？

> ID：15588216
> 
> 赞同：1
> 
> 时间：2013-03-23T14:59:28.120
> 
> 标签：json, jsp

我正在从文件中获取一些 JSON 数据`db.jsp`。jsp 文件从我的数据库中获取用户详细信息并以 JSON 格式打印，我使用 get 方法来实现这一点。

我的网址应该是这样的：`db.jsp?userid=DIBYA`这里的值“DIBYA”是用户输入的。我试图连接为：

```
function submit() {
    $.getJSON('db.jsp?userid='+<%String userName = request.getParameter("userid"); out.print(userName);%>, function(data) { 
```

但是，我的控制台将错误消息显示为`ReferenceError: DIBYA is not defined`. 请告诉我我的代码需要进行哪些更改？

谢谢

迪比亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:04:16.327

您忘记在“DIBYA”周围加上引号。您的代码扩展为：

```
function submit() {
    $.getJSON('db.jsp?userid='+DIBYA, function(data) { 
```

但你想要：

```
function submit() {
    $.getJSON('db.jsp?userid='+'DIBYA', function(data) { 
```

或更好：

```
function submit() {
    $.getJSON('db.jsp?userid=DIBYA', function(data) { 
```

所以你需要这样写：

```
function submit() {
    $.getJSON('db.jsp?userid=<% out.print(userName);%>', function(data) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:05:39.443

以下行

```
$.getJSON('db.jsp?userid='+<%String userName = "DIBYA"; out.print(userName);%>, function(data) { 
```

将由 JSP 容器翻译成以下 JavaScript 代码：

```
$.getJSON('db.jsp?userid='+DIBYA, function(data) { 
```

因此浏览器中的 JavaScript 引擎将寻找一个名为 DIBYA 的 JavaScript 变量。

如果您只想将值设为字符串 DIBYA，我什至不明白您为什么使用 scriptlet。只需使用

```
$.getJSON('db.jsp?userid=DIBYA', function(data) { 
```

# c# - 如何在 ActionLink 中包含多个 Css 类？

> ID：15588217
> 
> 赞同：2
> 
> 时间：2013-03-23T14:59:28.230
> 
> 标签：c#, css, asp.net-mvc

假设我有两个 Css 类，如下所示：

```
 .btn
     {
          border:1px solid yellow;
     }

     .btn-info
     {
          background-color: blue;
     } 
```

和一个`ActionLink`：

```
 <li>@Html.ActionLink("Home", "Index", "Home", new { @class = "btn btn-info" })</li> 
```

如您所见，我在课程中包含了那些 css 类，`ActionLink`但它只需要第一个。我应该如何将第二个添加到`ActionLink`Css 类中。

**生成的HTML：**

```
 <a class="btn btn-info" href="/"></a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T15:04:59.720

```
<li>@Html.ActionLink("Home", "Index", "Home", null, new { @class = "btn btn-info" })</li> 
```

第四个参数是 for `routeValues`，第五个参数是 for `htmlAttributes`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:29:45.100

迈克尔的回答是有效的。

我建议你

检查文档[LinkExtensions.ActionLink Method (HtmlHelper, String, String, String, Object, Object)](http://msdn.microsoft.com/en-us/library/dd504972%28v=vs.100%29.aspx)

浏览源代码：[LinkExtensions](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/1fa5fe9ce17f#src/System.Web.Mvc/Html/LinkExtensions.cs)

从中学习真的很棒。

# javascript - 为什么引导 javascript 功能不起作用？

> ID：15588218
> 
> 赞同：0
> 
> 时间：2013-03-23T14:59:29.463
> 
> 标签：javascript, twitter-bootstrap, joomla, joomla2.5

我在 Joomla 上使用 Gantry 模板！已将引导程序集成到其中。我想使用引导 javascript 组件，如灯箱、标签。我添加了 jQuery（没有冲突），因为 mootools 已经加载，然后添加了所需的代码。但是，它没有按预期工作。[我在http://v2.marlownailandbeauty.co.uk/index.php?option=com_content&view=article&id=47&Itemid=127](http://v2.marlownailandbeauty.co.uk/index.php?option=com_content&view=article&id=47&Itemid=127)设置了一个测试页面

标签和灯箱都不起作用（就在 youtube vid 下方）。我看不到任何 JS 错误，只是想知道为什么它可能不起作用？有什么好主意吗？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:06:39.500

快速查看您的代码，在我看来您加载了：

jQuery
JQuery 没有冲突
Mootools 各种其他 Mootools 脚本

据我了解，建议在 Mootools 和所有其他脚本加载后加载 jQuery（无冲突）：源[http://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)
即：
jQuery
Mootools
各种其他 Mootools 脚本
JQuery 没有冲突

有几种方法可以快速测试。您可以直接编辑模板文件并更改顺序，或使用[jQuery Easy](http://extensions.joomla.org/extensions/core-enhancements/performance/jquery-scripts/18327)之类的扩展来加载无冲突脚本。

或者第三种选择......您是否检查过您的模板中是否需要 Mootools？您可以[使用扩展来禁用 mootools](http://extensions.joomla.org/extensions/core-enhancements/performance/mootools/15748)并查看会发生什么。如果幸运的话，您的模板仍然可以正常工作，并且您的网站加载速度会更快。如果确实需要 mootools，则很容易逆转。

祝你好运！

# eclipse - 如何隐藏这个烦人的工具栏

> ID：15588223
> 
> 赞同：0
> 
> 时间：2013-03-23T14:59:40.933
> 
> 标签：eclipse

我错误地点击了eclipse中的某些东西，并且出现了烦人的工具栏。我该如何隐藏它？ ![在此处输入图像描述](../Images/84aebda9e5a1b84625940c4cbd6d82e8.png)

我知道这是个愚蠢的问题，但我在互联网上找不到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:04:41.627

按 Ctrl+3 并输入 bread，然后单击项目 Toggle Java Editor Breadcrumb。

# android - 安卓。动作酒吧夏洛克。

> ID：15588227
> 
> 赞同：2
> 
> 时间：2013-03-23T15:00:19.357
> 
> 标签：android, actionbarsherlock

尝试从 ActionBarSherlock 开始。下载库。使用最后更新设置 ADT，SDK 相同。

尝试进行简单的活动：

```
import com.actionbarsherlock.app.SherlockActivity;
import android.os.Bundle;

public class MainActivity extends SherlockActivity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
} 
```

清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="ru.alxr.usingsherlocksample"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/Sherlock.__Theme" >
    <activity
        android:name="ru.alxr.usingsherlocksample.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
  </application>

 </manifest> 
```

ADT 不允许将 android:theme="@style/Sherlock" 设置为红色 x。

所以，我在 logcat 中得到了预期的错误：

```
03-23 21:25:54.437: E/AndroidRuntime(13145): FATAL EXCEPTION: main
03-23 21:25:54.437: E/AndroidRuntime(13145): java.lang.RuntimeException: Unable to start activity ComponentInfo{ru.alxr.usingsherlocksample/ru.alxr.usingsherlocksample.MainActivity}: java.lang.IllegalStateException: You must use Theme.Sherlock, Theme.Sherlock.Light, Theme.Sherlock.Light.DarkActionBar, or a derivative.
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.os.Looper.loop(Looper.java:130)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.ActivityThread.main(ActivityThread.java:3687)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at java.lang.reflect.Method.invokeNative(Native Method)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at java.lang.reflect.Method.invoke(Method.java:507)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at dalvik.system.NativeStart.main(Native Method)
03-23 21:25:54.437: E/AndroidRuntime(13145): Caused by: java.lang.IllegalStateException: You must use Theme.Sherlock, Theme.Sherlock.Light, Theme.Sherlock.Light.DarkActionBar, or a derivative.
03-23 21:25:54.437: E/AndroidRuntime(13145):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.generateLayout(ActionBarSherlockCompat.java:1003)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.installDecor(ActionBarSherlockCompat.java:915)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.setContentView(ActionBarSherlockCompat.java:849)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at com.actionbarsherlock.app.SherlockActivity.setContentView(SherlockActivity.java:229)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at ru.alxr.usingsherlocksample.MainActivity.onCreate(MainActivity.java:13)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
03-23 21:25:54.437: E/AndroidRuntime(13145):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
03-23 21:25:54.437: E/AndroidRuntime(13145):    ... 11 more 
```

该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T15:03:34.653

在您的清单中替换：

```
android:theme="@style/Sherlock.__Theme" 
```

和：

```
android:theme="@style/Theme.Sherlock" 
```

或任何其他有效主题，例如：

```
android:theme="@style/Theme.Sherlock.Light"
android:theme="@style/Theme.Sherlock.Light.DarkActionBar" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T09:11:02.610

解决方案是安装 32 位 ADT 而不是 64 位一。

# curl - 有没有办法在选项实施之前的版本中复制 cURL 中的 --post302 选项？

> ID：15588230
> 
> 赞同：1
> 
> 时间：2013-03-23T15:00:28.177
> 
> 标签：curl

标题基本概括了所有内容。我正在使用选项`-L`强制 cURL 遵循重定向，但服务器正在将 POST 转换为 GET。`--post302`修复它，但我无法访问需要它的版本 7.19+。我可以使用另一组选项复制该行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T18:26:58.183

简短的回答：不，但请进一步阅读。

更长的答案：问题是 -L 选项使 curl 自动遵循 3xx 响应的 HTTP 重定向。当服务器返回 302 时，通常由 curl 以某种方式处理（它会更改并执行 GET 到下一个 URL），因为这是大多数浏览器所做的。

--post302 的原因是为了引入一种符合规范的方式，它不会在 302 之后更改请求方法，而是也会将 POST 发送到下一个 URL。

您*可以*在不更新到更现代的 curl 版本的情况下解决限制的方法是不使用 -L 而是使用脚本并执行 302 和 Location:- 跟随自己，然后在下一个执行第二次 curl 调用网址。

# jquery - 一旦通过.get（）检索父级，如何通过选择器获取元素

> ID：15588231
> 
> 赞同：0
> 
> 时间：2013-03-23T15:00:32.007
> 
> 标签：jquery, flexslider

我正在使用`var slide=($('#accommodation-flexslider li').get(currentSlide));`. 这让我得到以下html：

```
<li>
    <article>
        <img src="http://localhost/...">
        <div class="flex-caption">
       <h1 class="caption-heading">Patio </h1>
              <p class="caption-description">Enclosed patio...</p>
        </div>
    </article>
</li> 
```

然后获取文本`caption-heading`并`caption-description`使用 my的 jQuery 是什么`var slide`？

我有超过 12 个这样的类，所以我只需要使用我的变量检索到的那个`currentSlide`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:15:05.780

因为您使用的是`.get()`，所以幻灯片变量将是一个 DOM 元素，而不是一个 jQuery 对象。因此，您不能`.find()`像其他答案所建议的那样直接调用它。但是 jQuery selector-with-context 语法会起作用：

```
var caption-heading = $("h1.caption-heading", slide).text(); 
```

或者，您可以使用`.eq()`而不是`.get()`（[了解更多](https://stackoverflow.com/questions/4709660/jquery-eq-vs-get)），以便幻灯片是一个 jQuery 对象：

```
var slide = $('#accommodation-flexslider li').eq(currentSlide);
var caption-heading = slide.find("h1.caption-heading").text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:02:48.497

您可以使用[Jquery .text()](http://api.jquery.com/text/)来获取文本

```
$('caption-heading').text() 
```

要查找特定元素，您可以使用[Jquery find()](http://api.jquery.com/find/)

```
slide.find("h1.caption-heading").text(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T15:03:55.320

使用幻灯片变量：

（请注意，如果 slide 是 DOM 元素而不是 jQuery 对象，则必须`$(slide).find()...`改为）

```
var caption-heading = slide.find("h1.caption-heading").text();
var caption-description = slide.find("p.caption-description").text(); 
```

或者像评论中提到的@tcovo 一样，您可以使用上下文选择器来做到这一点：

```
var caption-heading = $("h1.caption-heading", slide).text();
var caption-description = $("p.caption-description", slide).text(); 
```

如果幻灯片元素有多个标题，您可以使用**.eq()**函数来检索您想要的标题。假设它有**3 个 h1.caption-heading 元素**，您可以执行以下操作来获取第二个：

```
var caption-description = slide.find("h1.caption-heading").eq(1).text(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:03:24.467

只需使用`find`：

```
slide.find('caption-heading').text() 
```

# c#-4.0 - 动态更新加载的 Dll

> ID：15588232
> 
> 赞同：2
> 
> 时间：2013-03-23T15:00:47.853
> 
> 标签：c#-4.0, dll, assemblies, appdomain

我正在为我正在处理的项目创建两个解决方案，一个用于主服务器，理想情况下它将持续运行而无需更新。第二种解决方案是 DLL，程序员将在其中不断更改和更新代码。服务器解决方案是一个 Windows 应用程序，而程序员的解决方案（不断变化的，AKA JupiterCode.dll）是一个类库。

我正在通过 telnet 访问代码，这是必需的，并且将在那里输入命令。然后将通过 DLL 文件上的反射执行输入字符串（“用户输入了 'smile'。是否有一个名为 'smile' 的命令？是的，好的，让我们执行该代码。”）。我已经完成了所有这些工作，并且运行顺利，但是当我想实际更新 DLL 以便用户可以输入更多命令时，我遇到了障碍。当我重建类库时，服务器还没有反映新的变化。服务器仅在我重建服务器时反映新的更改。

我正在尝试拥有它，因此当用户在 telnet 服务器中输入 UPDATE 时，它将使用新的 DLL 更新加载的 DLL，但是当我尝试执行类似...

```
 string originalDllPath = "C:\\Users\\*****\\Documents\\PseudoGameClient\\bin\\Debug\\JupiterCode.dll";
 string newDllPath = "C:\\Users\\*****\\Documents\\PseudoServerStub\\bin\\Debug\\.dll";
 string newDllBakPath = "C:\\Users\\*****\\Documents\\PseudoServerStub\\bin\\Debug\\JupiterCodeNewBak.dll";
 string oldDllPath = "C:\\Users\\*****\\Documents\\PseudoServerStub\\bin\\Debug\\JupiterCode.dll";
 string oldDllBakPath = "C:\\Users\\*****\\Documents\\PseudoServerStub\\bin\\Debug\\JupiterCodeBak.dll";

 try
 {
 File.Copy(originalDllPath, newDllPath, true);

 AppDomain.Unload(updatedCodeDomain);
 AppDomain sandbox = AppDomain.CreateDomain("Sandbox");
 Assembly assembly = sandbox.Load(oldDllBakPath);
 upToDateCode = assembly;
 File.Copy(oldDllPath, newDllBakPath, true);
 File.Copy(newDllPath, oldDllPath, true);

 AppDomain.Unload(sandbox);
 AppDomain newCodeDomain = AppDomain.CreateDomain("NewCode");
 assembly = newCodeDomain.Load(oldDllPath);
 upToDateCode = assembly;
 File.Copy(newDllBakPath, oldDllBakPath, true);

 File.Delete(newDllPath);
 File.Delete(newDllBakPath);
 updatedCodeDomain = newCodeDomain;
 }
 catch (Exception ex)
 {
 } 
```

在这种方法中，一旦到达

`Assembly assembly = sandbox.Load(oldDllBakPath);`

它给了我一个例外：

> “无法加载文件或程序集 'C:\\Users\\aderbedrosia\\Documents\\PseudoServerStub\\bin\\Debug\\JupiterCodeBak.dll' 或其依赖项之一。给定的程序集名称或代码库无效。（ HRESULT 异常：0x80131047)":"C:\\Users\\aderbedrosia\\Documents\\PseudoServerStub\\bin\\Debug\\JupiterCodeBak.dll"} System.Exception {System.IO.FileLoadException

（注意：Uptodatecode 被保存为一个类字段，因为我稍后会引用它来执行它上面的命令，这再次工作得很好，除了无法更新。）

我也试过：

```
 File.Copy(originalDllPath, newDllPath, true);
 Assembly assembly = Assembly.LoadFrom(oldDllBakPath);
 AppDomain.Unload(updatedCodeDomain);

 AppDomain sandbox = AppDomain.CreateDomain("sandbox");
 sandbox.Load(assembly.GetName());
 upToDateCode = null;
 upToDateCode = assembly;
 File.Copy(oldDllPath, newDllBakPath, true);
 File.Copy(newDllPath, oldDllPath, true);
 assembly = Assembly.LoadFrom(oldDllPath);
 AppDomain.Unload(sandbox);

 AppDomain sandbox2 = AppDomain.CreateDomain("secondarySandbox");
 sandbox2.Load(assembly.GetName());
 upToDateCode = assembly;
 File.Copy(newDllBakPath, oldDllBakPath, true);
 File.Delete(newDllPath);
 File.Delete(newDllBakPath);
 updatedCodeDomain = sandbox2; 
```

它出错了

```
sandbox.Load(assembly.GetName()); 
```

和

> “无法加载文件或程序集 'JupiterCode, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9a98a67e4d0b3db8' 或其依赖项之一。系统找不到指定的文件。”：“JupiterCode, Version=1.0.0.0, Culture =中性，PublicKeyToken=9a98a67e4d0b3db8"

再次重申，我能够在运行时动态加载程序集，但是用更新的 DLL 替换加载的 DLL（在运行时，无需重建）证明是困难的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T16:15:33.353

对于面临同样问题的任何人，我都可以使用动态编译器。查看 CSharpCodeProvider 和 CSharpCodeProvider.CompileAssemblyFromFile。这是我需要的一切。

# javascript - 当将 capybara-webkit 与加载外部脚本的页面一起使用时，Rspec 会定期挂起 async = true

> ID：15588234
> 
> 赞同：5
> 
> 时间：2013-03-23T15:00:58.647
> 
> 标签：javascript, rspec, capybara, freeze, capybara-webkit

我正在开发一个使用用户语音的应用程序。用户语音片段

```
 var uv = document.createElement('script');
  uv.type = 'text/javascript';
  uv.async = true;
  uv.src = ...; // external call to uservoice to fetch js
  var s = document.getElementsByTagName('script')[0];
  ... 
```

此 javascript 加载在所有页面上。运行`rake spec`时运行会定期挂起。当我删除用户语音片段时，所有测试都运行顺利。我已尝试设置`Capybara.javascript_driver = :webkit_debug`，但没有看到用户语音的响应。当我设置时，`page.driver.browser.timeout`我可以看到来自 uservoice 的 0 响应，并且规范将因超时错误而失败。

还有其他人遇到这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-27T02:20:22.283

当我的开发机器与互联网断开连接时，我在等待外部脚本引导（例如谷歌分析）时遇到超时错误。

当我尝试调试 capybara 时，有时我仍然会使用 firebug 和 selenium 驱动程序，因为它可以让我看到实际的浏览器运行它。

# jquery - Query textfields characters length count with "for -> keyup"

> ID：15588240
> 
> 赞同：2
> 
> 时间：2013-03-23T15:01:23.430
> 
> 标签：jquery, arrays, for-loop, keyup

I made a script to count characters from form textfields but is now working. I put an alert inside of `keyup function` to see if it counts correctly, but every time `i` is 6 (the total of form elements). Outside of `keyup function` it counts correctly. What could be the problem? I don't see any problems with the code. Also the console log is empty (no errors).

```
// Count characters
formElementsTitles = ['content_title', 'content_description', 'text_content', 'image_url', 'video_embed', 'aditional_info'];
formElementsLengths = ['100', '5000', '20000', '1000', '1000', '1000'];

for(i = 0; i < formElementsTitles.length; i++)
{   
    $('#'+formElementsTitles[i]).keyup(function() {

        charactersMax = formElementsLengths[i];
        charactersCurrent = $(this).val().length;
        charactersRemaining = charactersMax - charactersCurrent;

        if(charactersCurrent >= charactersMax)
        {
            $("#count_"+formElementsTitles[i]).html('<span class="content_count_chars_yellow">'+charactersRemaining+'</span> characters remaining');
        }
        else
        {
            $("#count_"+formElementsTitles[i]).html('<span class="content_count_chars_green">'+charactersRemaining+'</span> characters remaining');
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:09:21.780

You are trying to use the `i`variable in an event function, that won't work since the function will only be executed when the Event really happens !

This should be working for you :

```
var formElements = {
    content_title: {
        maxLength: 100
    }
}

for(title in formElements)
{   
    $('#'+title).keyup(function() {

        var charactersMax         = formElements[$(this).attr('id')].maxLength;
        var charactersCurrent     = $(this).val().length;
        var charactersRemaining   = charactersMax - charactersCurrent;

        if(charactersCurrent >= charactersMax)
        {
            $("#count_"+$(this).attr('id')).html('<span class="content_count_chars_yellow">'+charactersRemaining+'</span> characters remaining');
        }
        else
        {
           $("#count_"+$(this).attr('id')).html('<span class="content_count_chars_green">'+charactersRemaining+'</span> characters remaining');
        }
    });
} 
```

See fiddle here : [http://jsfiddle.net/rA2Fm/](http://jsfiddle.net/rA2Fm/)

# c++ - 强制所有 && 被执行？

> ID：15588242
> 
> 赞同：8
> 
> 时间：2013-03-23T15:01:41.107
> 
> 标签：c++, templates, c++11, logic, variadic-templates

考虑以下可变参数函数

```
template <typename Type, typename... Types>
bool f(Type& arg, Types&... args)
{
    return f(arg) && f(args...);
}

template <typename Type>
bool f(Type& arg)
{
    // Do something
} 
```

如果一级递归是`false`，那么我怀疑以下将不会执行。即使其中一个返回，是否有强制递归所有参数的技巧`false`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-23T15:02:34.870

这不应该太难：

```
template <typename Type, typename... Types>
bool f(Type& arg, Types&... args)
{
    bool b1 = f(arg);
    bool b2 = f(args...);
    return b1 && b2;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-23T18:17:38.210

随着争论在 AndyProwl 和 Alon 解决方案的比较中不断发展，我已经对这两种解决方案进行了基准测试，结果......取决于参数的数量。

编译：

```
g++-4.7 -std=c++11 -Wall -Wextra -O3 main.cpp -o main -D_FIRST 
```

对 AndyProwl 解决方案进行基准测试并编译：

```
g++-4.7 -std=c++11 -Wall -Wextra -O3 main.cpp -o main -D_SECOND 
```

对 Alon 解决方案进行基准测试。

这是 10 个参数的基准测试程序。

```
#include <iostream>
#include <chrono>

// Function 1 : with &&
template <typename Type>
inline bool f1(const Type& arg)
{
   return arg;
}
template <typename Type, typename... Types>
inline bool f1(const Type& arg, const Types&... args)
{
    bool arg1 = f1(arg);
    bool arg2 = f1(args...);
    return arg1 && arg2;
}

// Function 2 : with &
template <typename Type>
inline bool f2(const Type& arg)
{
   return arg;
}
template <typename Type, typename... Types>
inline bool f2(const Type& arg, const Types&... args)
{
    return f2(arg) & f2(args...);
}

// Benchmark
int main(int argc, char* argv[])
{
    // Variables
    static const unsigned long long int primes[10] = {11, 13, 17, 19, 23, 29, 31, 37, 41, 43};
    static const unsigned long long int nbenchs = 50;
    static const unsigned long long int ntests = 10000000;
    unsigned long long int sum = 0;
    double result = 0;
    double mean = 0;
    std::chrono::high_resolution_clock::time_point t0 = std::chrono::high_resolution_clock::now();

    // Loop of benchmarks
    for (unsigned long long int ibench = 0; ibench < nbenchs; ++ibench) {

        // Initialization
        t0 = std::chrono::high_resolution_clock::now();
        sum = 0;

        // Loop of tests
        for (unsigned long long int itest = 1; itest <= ntests; ++itest) {
#ifdef _FIRST
            sum += f1((itest+sum)%primes[0], (itest+sum)%primes[1], (itest+sum)%primes[2], (itest+sum)%primes[3], (itest+sum)%primes[4], (itest+sum)%primes[5], (itest+sum)%primes[6], (itest+sum)%primes[7], (itest+sum)%primes[8], (itest+sum)%primes[9]);
#endif
#ifdef _SECOND
            sum += f2((itest+sum)%primes[0], (itest+sum)%primes[1], (itest+sum)%primes[2], (itest+sum)%primes[3], (itest+sum)%primes[4], (itest+sum)%primes[5], (itest+sum)%primes[6], (itest+sum)%primes[7], (itest+sum)%primes[8], (itest+sum)%primes[9]);
#endif
        }

        // Finalization
        result = std::chrono::duration_cast<std::chrono::duration<double>>(std::chrono::high_resolution_clock::now()-t0).count();
        mean += result;
        std::cout<<"time = "<<result<<" (sum = "<<sum<<")"<<std::endl;
    }

    // End
    std::cout<<"mean time = "<<mean/nbenchs<<std::endl;
    return 0;
} 
```

每个具有给定数量参数的解决方案有 50 个基准，分散非常小，这些基准的平均时间是一个可靠的指标。

我的第一个基准是使用“正确”数量的参数，其中 Alon 解决方案比 AndyProwl 解决方案更快。

最终结果在这里：

![基准](../Images/a3a8d8bd7d07d1e4a5cfb658b00e955f.png)

因此，AndyProwl 解决方案通常比 Alon 解决方案更快。所以，现在我可以验证你的答案。但我认为差异是如此之小，以至于它依赖于架构/编译器。

所以：

*   AndyProwl+1 为您提供更快的解决方案
*   Alon+1 为您的 constexpr-ready 解决方案

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-23T15:03:37.987

您可以单独执行它们并返回一个布尔表达式：

```
bool b0 = f(arg);
bool b1 = f(args);
return b0 && b1; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-23T15:06:28.367

没有递归：

```
template <typename... Types>
bool f(Types&&... args)
{
  bool r=true;
  (void)std::initializer_list<bool>{(r = f(args)&&r)...};
  return r;
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-03-23T15:07:17.617

有一个更好的技巧，而不是在所有函数之间使用 &&，只需使用一个 &

`static_cast<bool>(f(arg)) & static_cast<bool>(f2(args))` ...无论结果如何，都会运行所有操作:)

# objective-c-blocks - 如何创建可以由块闭包捕获（常量复制）的基于堆栈的字符数组？

> ID：15588244
> 
> 赞同：0
> 
> 时间：2013-03-23T15:01:47.740
> 
> 标签：objective-c-blocks

我试图找出一种干净的方法来创建一个基于堆栈的 C 字符串（即 char[]），该字符串可以通过块闭包（通过 const 副本）捕获。基本思路是这样的：

```
char myString[16] = {0};
// ... put something into myString.
dispatch_block_t block = ^(){
    const size_t len = strlen(myString);
    if (len)
        NSLog(@"Not zero length");
}; 
```

但是这样做会导致编译器抱怨：

```
error: cannot refer to declaration with an array type inside block 
```

我突然想到我可以将 char 数组放入一个结构中，但这看起来有点难看。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T11:49:53.390

堆栈分配的问题在于，一旦您离开函数，堆栈帧就会消失，但块代码仍然存在，并且可能会引用该堆栈帧中的变量。块通过分配和复制它引用的所有值到堆来处理这个问题，包括用 __block 声明的变量。从理论上讲，它们应该能够复制静态大小的数组，但由于某种原因，它不受支持。请注意，很可能存在我不知道的与数组相关的技术问题。

所以我看到的最简单的解决方案是使用 malloc/free：

```
char *myString = calloc(16,1);

dispatch_block_t block = ^(){
    const size_t len = strlen(myString);
    if (len)
        NSLog(@"Not zero length");
    free(myString);
}; 
```

只要您不需要多次重复使用该块就可以了。如果您需要重新使用该块，则将 myString 包装在一个 NSData 对象中，您可以在您的块中引用该对象并摆脱空闲。

```
char *myString = calloc(16,1);
NSData *myStringData = [NSData dataWithBytesNoCopy:myString length:16 freeWhenDone:YES];

dispatch_block_t block = ^(){
    const char *myString = myStringData.bytes;
    const size_t len = strlen(myString);
    if (len)
        NSLog(@"Not zero length");
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T16:45:45.427

在这一点上已经过了一周，我开始有信心没有我只是缺少一些神奇的语法。为了未来的访问者的利益，这是迄今为止我找到的实现我在这里所问的最佳方式：

```
 typedef struct { char string[32]; } StackString;

    StackString foo = {0};
    strcpy(foo.string, "foo");

    dispatch_block_t block = ^(){
        StackString blockFoo = foo;
        NSLog(@"Block String: %s", blockFoo.string);
    };

    for (int i = 0; i < 5; ++i)
    {
        sprintf(foo.string, "i = %d", i);
        NSLog(@"Loop string: %s", foo.string);
        block();
    } 
```

其输出为：

```
2013-03-31 11:30:52.778 TestClosure[98968:303] Loop string: i = 0
2013-03-31 11:30:52.780 TestClosure[98968:303] Block String: foo
2013-03-31 11:30:52.780 TestClosure[98968:303] Loop string: i = 1
2013-03-31 11:30:52.780 TestClosure[98968:303] Block String: foo
2013-03-31 11:30:52.780 TestClosure[98968:303] Loop string: i = 2
2013-03-31 11:30:52.781 TestClosure[98968:303] Block String: foo
2013-03-31 11:30:52.781 TestClosure[98968:303] Loop string: i = 3
2013-03-31 11:30:52.782 TestClosure[98968:303] Block String: foo
2013-03-31 11:30:52.782 TestClosure[98968:303] Loop string: i = 4
2013-03-31 11:30:52.782 TestClosure[98968:303] Block String: foo 
```

这让我相信，包装在一个结构中，固定大小的数组被 const 复制到块闭包中就好了。

# vb.net - 怎么通过电脑发短信

> ID：15588245
> 
> 赞同：0
> 
> 时间：2013-03-23T15:01:48.087
> 
> 标签：vb.net, text, tcp

有没有办法在没有客户端和服务器程序的情况下通过 PC 发送文本？只需简单地将文本从一个程序发送到另一个程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:36:44.657

如果您不想使用套接字或管道，我只能想到文件，这比程序到程序更多的是 pc 到 pc。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T17:24:17.623

即使您不想使用客户端和服务器，这也是最简单的方法。服务器是在命令提示符下运行的服务器，但在您的程序后台运行。服务器和客户端不会以任何方式可见。只需几行代码的简单答案是 TCP 通信。这使用两台计算机的 IP 地址并建立服务器/客户端连接。

每个通信都需要承载它的东西，为了实现这一点，您将程序编码为包含以下内容：

```
Imports System.IO
Imports System.Net.Sockets
Public Class Form1
Dim listener As New TcpListener(8000)
Dim Client As TcpClient
Private Sub Form1_FormClosing(sender As Object, e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
listener.Stop()
End Sub
Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
Timer1.Start()
listener.Start()
End Sub
Private Sub Timer1_Tick(sender As System.Object, e As System.EventArgs) Handles Timer1.Tick
Dim Data As String = ""
Dim nStart As Integer
Dim nLast As Integer
If listener.Pending = True Then
Client = listener.AcceptTcpClient()
Dim Reader As New StreamReader(Client.GetStream)
While Reader.Peek > -1
Data &= Convert.ToChar(Reader.Read()).ToString
End While
If Not Data = "" Then
msgbox("This is the data recieved: " & Data)
End If
End If
End Sub
End Class 
```

这将在 localhost 端口 8000 上打开一个“TCPListener”。每当客户端向侦听器发送数据时，文本框 Textbox1 的文本就会向数据发送。

要将数据发送到服务器，请使用以下代码：

```
Option Explicit On
Imports System.IO
Imports System.Net.Sockets
Public Class Form1
Dim Client As TcpClient
Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
End Sub
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
Try
//Ip to the local or remote, forwarded server. 127.0.0.1 is localhost - the same machine.
Client = New TcpClient("127.0.0.1", 8000)
Dim Writer As New StreamWriter(Client.GetStream())
Writer.Write("Hello World!")
Writer.Flush()
Catch ex As Exception
MsgBox(ex.Message)
End Try
End Sub
End Class 
```

这将在按下 Button1 时尝试发送数据/字符串“Hello World！” 到服务器。

通过将应用程序设置如下，可以将其合并为一个：

```
Imports System.IO
Imports System.Net.Sockets
Public Class Form1
Dim listener As New TcpListener(8000)
Dim Client As TcpClient
Private Sub Form1_FormClosing(sender As Object, e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
listener.Stop()
End Sub

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
Timer1.Start()
listener.Start()
End Sub

Private Sub Timer1_Tick(sender As System.Object, e As System.EventArgs) Handles Timer1.Tick
Dim Data As String = ""
Dim nStart As Integer
Dim nLast As Integer
If listener.Pending = True Then
Client = listener.AcceptTcpClient()
Dim Reader As New StreamReader(Client.GetStream)
While Reader.Peek > -1
Data &= Convert.ToChar(Reader.Read()).ToString
End While
If Not Data = "" Then
'Change the string
End If
TextBox1.Text = Data
End If
End Sub

Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
Try
//This has to be the address to the remote 
Client = New TcpClient("xx.xx.xx.xx", 8000)
Dim Writer As New StreamWriter(Client.GetStream())
Writer.Write(TextBox2.Text)
Writer.Flush()
Catch ex As Exception
MsgBox(ex.Message)
End Try
End Sub
End Class 
```

要扩展它并使其在实际应用程序中可用，请使用后台工作程序来简单地使服务器和客户端在另一个线程上运行。

# c++ - 如何从包含的小部件更改 QStackedWidget 的索引

> ID：15588246
> 
> 赞同：0
> 
> 时间：2013-03-23T15:01:58.630
> 
> 标签：c++, qt, qt4, widget

我有一个`QStackedWidget`包含 2 层小部件（另一个小部件内的小部件）。最后的小部件包含多个按钮。`QStackedWidget`当我按下其中一个按钮时，如何更改它的索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T17:24:04.147

如果我有你的问题，aswer 很简单——你试过了吗：

```
ui->stackedWidget->setCurrentIndex(INDEX); 
```

# c# - 忽略错误并在 C# 中继续

> ID：15588249
> 
> 赞同：3
> 
> 时间：2013-03-23T15:02:18.353
> 
> 标签：c#, error-handling, try-catch

我正在尝试在 C# 中打开 3 个程序，但是，如果发生错误，我仍然希望代码继续。换句话说，如果程序 1 出现问题，程序 2 和 3 仍应尝试打开。我也不想检查文件存在，因为程序需要一些开关，任何事情都可能失败。
如果程序 1 失败，下面的代码将崩溃。如何忽略任何错误并继续执行代码？

```
try
{
        string path = Environment.GetFolderPath(Environment.SpecialFolder.Startup);
        //Program 1
        Process x = Process.Start("\"C:\\Program Files\\Company\\Office\\MyProgram1.EXE\"   /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer");
        //Program 2
        Process x = Process.Start("\"C:\\Program Files\\Company\\Office\\MyProgram2.EXE\"   /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer");
        //Program 3
        Process x = Process.Start("\"C:\\Program Files\\Company\\Office\\MyProgram3.EXE\"   /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer");
}
catch {} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-23T15:21:46.330

为每个过程单独`Try...Catch`设置可能是最好的方法。但是，如果您可以拥有任意数量的程序，则可以使用`foreach`循环而不是手动编写`Try...Catch`for 每个调用。

```
List<Action> processesToCall = new List<Action>();  

string path = Environment.GetFolderPath(Environment.SpecialFolder.Startup);
processesToCall.Add(() => Process.Start("\"C:\\Program Files\\Company\\Office\\MyProgram1.EXE\"   /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer"));
processesToCall.Add(() => Process.Start("\"C:\\Program Files\\Company\\Office\\MyProgram2.EXE\"   /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer") );
processesToCall.Add(() => Process.Start("\"C:\\Program Files\\Company\\Office\\MyProgram3.EXE\"   /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer") );    

foreach(Action a in processesToCall)
{
    try
    {
       a();
    }
    catch
    {
       //log  (or whatever you want to do with it)
    }
} 
```

这样您就不必`Try...Catch`为每个动作编写一个块，因此更容易添加更多动作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T15:04:10.843

使用 3 个不同的`try-catch`块

```
string path = Environment.GetFolderPath(Environment.SpecialFolder.Startup);
try {        
    //Program 1
    Process x = Process.Start(path + "/runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer");
}
catch {}
try {
    //Program 2
    Process x = Process.Start(path + " /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer");
catch {}
try  {
    //Program 3
    Process x = Process.Start(path + " /runtime  \"C:\\Program Files\\Company\\Config.xml\" /cmd RunServer");
catch {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:04:33.923

您想忽略错误似乎很奇怪。无论如何，您可以将每个进程都放在 try catch 块中：

```
try{
   Process.Start(...);     
}catch(Exception e){
   //log error, if you want
} 
```

# php - 带有 action=" " 的表单提交导致注销

> ID：15588250
> 
> 赞同：0
> 
> 时间：2013-03-23T15:02:27.073
> 
> 标签：php, html

请记住这里的初学者模式。我正在制作一个从数据库中搜索产品的电子商务网站。我使用的登录名基于数据库中的 0 和 1。当以管理员身份登录并使用 admin.php 页面上的搜索功能时，我会注销或重定向到 frontPage。相同的搜索功能在 frontPage 上也能正常工作。

这是我在 admin.php 上提交表单的部分。

```
<div id="mainArea">
    <form id="searchBox" action="<?=$_SERVER['PHP_SELF']?>" method="post"><input id="search" name="title" type="text" placeholder="Search Products" /><input name="submit" type="submit" value="Search" style="width:75px;height:36px"/></form>
</div>
    <div id="show">
        <?php
            include("searchAdmin.php");
        ?> 
    </div> 
```

admin.php 页面的顶部如下所示：

```
<?php
session_start();
$name = $_SESSION['myusername'];
?> 
```

在 adminSearch.php 中搜索是这样的：

```
<?php
if ($_POST['submit']){
include ("connection.php");

$title = (trim($_POST['title'])=="")?
die ("You did not enter any search criteria"):
mysql_real_escape_string($_POST['title']);

$query = "select * from beer where upper(beer_name) like '%".strtoupper($title) ."%' OR upper(beer_descr) like '%". strtoupper($title) ."%' OR upper(beer_categ) like '%". strtoupper($title) ."%'";

if(! ($result = mysql_query($query)))
die ("No matches found. Please search again.</body></html>");
echo "<table border=1>";
while ($rows = mysql_fetch_array($result)) {
    echo "<tr><td rowspan=3>" . '<img src="images/'. $rows['beer_image'] . '.jpg"/>'."</td><td>".$rows['beer_name']."</td><td><a href='updateBeer.php?id=". $rows['beer_id'] ."'>Update</a></td></tr>";
    echo "<tr><td>".$rows['beer_categ']."</td><td><a href='deleteBeer.php?id=". $rows['beer_id'] ."'>Delete</a></td></tr>";
    echo "<tr><td>".$rows['beer_descr']."</td>
    <td>".$rows['beer_cost']."</td></tr>";
}
echo "</table>";
}
else include("showAdmin.php");
?> 
```

编辑：忘记显示我的登录 php 的结尾看起来像这样。它正确地将我发送到管理页面，但是当我在管理页面上进行搜索时，它会将我注销或将我发送到 frontPage。

```
 if($count==1){
        if($auth==1){
            session_start();
            $_SESSION['myusername'] = $myusername;
            $_SESSION['auth']=$auth;
            header("location: /admin.php");
            }
        elseif($auth==0){
            session_start();
            $_SESSION['myusername'] = $myusername;
            $_SESSION['auth']=$auth;
            header("location: /user.php");
        }
    }
else {
echo "Wrong Username or Password";
} 
```

我的注销在同一个管理页面上看起来像这样：

```
<div id="login1">
<font color="white">Logged in with Administrator privilages as: <?php echo $name ?>.</font><br /><form id="logout" method="post" name="logout" action="logout.php"><input name="logout" type="submit" value="Logout" style="width:75px;height:22px"><br />
</div> 
```

logout.php 内容如下：

```
<?php
if (!empty($_POST['logout'])){
session_start();
session_destroy();
header("location: /frontPage.php");
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-21T15:54:20.187

代替

```
<?=$_SERVER['PHP_SELF']?> 
```

利用

```
<?php echo $_SERVER['PHP_SELF']?> 
```

我认为这个简单的错误导致了错误。希望这次好运会与你同在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:20:00.000

乍一看，您使用的变量 $result 可能是您的问题的一部分。

据我所见，您没有为 $result 声明或赋值，因此 if 语句中的比较可能没有达到您的预期。

我的建议是通过删除 if 语句来简化您的代码，以进行调试，并查看您是否遇到相同的问题。

还要添加一些警告框来调试您的代码，以便您可以识别代码的哪一部分将您重定向到注销代码。

# c# - 如何计算格式化字符串的长度

> ID：15588252
> 
> 赞同：0
> 
> 时间：2013-03-23T15:02:34.560
> 
> 标签：c#, string, console

我想在控制台窗口上显示一条消息，只要该消息不会超过窗口的默认 0-79 X 宽度。我的代码如下所示：

```
int xRemaining = 80 - mRobot.CurrentPos.X;
string message = "ID{0:d} Facing {1:s} at ({2:d},{3:d}) home is({4:d},{5:d})";
string formatMessage = string.Format(message,mRobot.ID,mRobot.getDir.ToString()/*...*/;

if(mRobot.CurrentPos.Y < 24)
{
  if (xRemaining < formatMessage.Length)
    {
     Console.SetCursorPosition((mRobot.CurrentPos.X - xRemaining), mRobot.CurrentPos.Y+1); 
    }
  else
    {
     Console.SetCursorPosition(mRobot.CurrentPos.X, mRobot.CurrentPos.Y + 1);
    }
}

else
{
  if(xRemaining < formatMessage.Length)
  {
   Console.SetCursorPosition((mRobot.CurrentPos.X-xRemaining), mRobot.CurrentPos.Y-1);
  }
  else
   {
    Console.SetCursorPosition(mRobot.CurrentPos.X, mRobot.CurrentPos.Y-1);
   }
}
Console.Write(message,,mRobot.ID, mRobot.getDir.ToString(), mRobot.CurrentPos.X, mRobot.CurrentPos.Y,mRobot.Home.X,mRobot.Home.Y); 
```

编辑：使用 string.Format，但似乎仍然运行到下一行：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:04:34.207

您可以使用以下方法格式化消息`string.Format`：

```
string message = "ID{0:d} Facing {1:s} at ({2:d,3:d}) home is({4:d,5:d})";
string formattedMessage = string.Format(message, mRobot.ID, mRobot.getDir.ToString(), /* ... */);
int msgLength = formattedMessage.Length; 
```

稍后，您可以使用以下方式显示它：

```
Console.WriteLine(formattedMessage); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:05:48.067

您需要在获取字符串长度之前格式化字符串。您当前正在获取未格式化字符串的长度。为此，您需要使用以下`string.Format`命令：

```
string output = string.Format(message, .....);

....

if (xRemaining < output.Length)
{
    ....
}

....

Console.Write(output); 
```

# java - 将一段代码添加到快捷方式

> ID：15588255
> 
> 赞同：2
> 
> 时间：2013-03-23T15:02:49.027
> 
> 标签：java, eclipse, automation

Eclipse 中有没有办法将一段代码绑定到快捷方式？

我经常使用 System.out.println() 进行测试和其他事情，如果我不得不按 ctrl + 某些东西而不是每次都输入它会容易得多..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T15:04:26.970

对于`System.out.println`，您可以输入如下内容：

```
"test" 
```

然后突出显示它，按`CTRL`+ `Space`，键入`sysout`，然后按 enter。

正如[Pescis](https://stackoverflow.com/users/1690982/pescis)[在评论](https://stackoverflow.com/questions/15588255/add-piece-of-code-to-shortcut/15588278?noredirect=1#comment22102111_15588278)中指出的那样，您也可以键入`sysout`后跟`CTRL`+ `Space`。它为您`System.out.println();`提供了括号内的焦点。（谢谢佩西斯！）

要创建新模板，请转到`Window -> Preferences -> Java -> Editor -> Templates`。

[如果您有兴趣，这里是](https://stackoverflow.com/questions/1028858/useful-eclipse-java-code-templates)一些现成模板的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:03:55.127

为 System.out.println() 键入 syso 和 ctrl + 空格

# java - java - 在java swing中的当前窗口（第一帧）中单击按钮时如何打开一个新窗口（第二帧）

> ID：15588260
> 
> 赞同：1
> 
> 时间：2013-03-23T15:03:34.527
> 
> 标签：java, swing

所以我一直在做一个项目，在我创建的框架中有一个“登录”按钮，我必须这样做，以便当用户单击“登录”按钮时，当前窗口应该终止，并出现一个新窗口标签和文本字段将打开，提示用户输入他的用户名，通过我已经用文本字段 n 标签制作了另一个框架，只是不知道如何将两者链接在一起，我为登录按钮框架和用户 ID 密码框架制作了两个不同的类并且这些类是从一个单独的主类中调用的，该类中具有主要功能，请帮助在星期一提交项目:( :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:21:46.560

在`Login`按钮中：向其添加操作，使您可以

```
 1- dispose the Login frame 
       2- open the second frame 
```

像这样 ：

```
private void LoginButtonActionPerformed(java.awt.event.ActionEvent evt) {
        dispose();////////////will dispose the Login frame
        UsernameAndPassword username = new UsernameAndPassword();//////UsernameAndPassword :is the second frame. 
        username .setVisible(true);//////the Username and password frame will be visible
    } 
```

# ios - 推动视图控制器动画时，工具栏按钮闪烁（快速淡入）

> ID：15588266
> 
> 赞同：6
> 
> 时间：2013-03-23T15:03:53.813
> 
> 标签：ios, animation, uinavigationcontroller, uibutton, uitoolbar

当推动视图控制器时，我的工具栏按钮会淡出，然后再次使用新视图。问题是我在下一个视图中的按钮与上一个视图相同，因此看起来按钮在切换屏幕时会快速闪烁。我的问题是，是否可以通过在推送到新视图时禁用导航控制器的工具栏按钮的淡出来避免这种情况，或者工具栏是否可以以对所有视图都相同的方式绑定到导航控制器。自从我看到我的导航栏按钮在按下新屏幕时不会淡出后的最后一个建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-26T04:05:50.020

我很惊讶没有人回答你。我刚刚遇到了这个问题，这是我找到的解决方案。

1.  子类化您的导航控制器

2.  覆盖您的推送/弹出方法

> ```
> -(UIViewController*)popViewControllerAnimated:(BOOL)animated
> {
>     self.navigationBarHidden = YES;
>     UIViewController *vc = [super popViewControllerAnimated:animated];
>     self.navigationBarHidden = NO;
>     return vc;
> }
> 
> -(void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated
> {
>     self.navigationBarHidden = YES;
>     [self pushViewController:viewController animated:animated];
>     self.navigationBarHidden = NO;
> } 
> ```

它对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-09T14:57:25.710

我知道这个问题很老，但有一个简单的解决方案：将两个控制器的导航项设置为同一个栏按钮项，它不会动画。例如：

```
UIBarButtonItem* item = [[UIBarButtonItem alloc] initWith...];
viewController1.rightBarButtonItem = item;
viewController2.rightBarButtonItem = item; 
```

如果您现在在显示 viewController1 后推送 viewController2，导航项将不会动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-15T05:21:37.007

对于在代码中构建工具栏，我认为它应该在 ViewWillAppear 生命周期方法中。我之前在代码中构建了一个工具栏，但在 ViewDidLoad 中，我看到了这个快速淡入/淡出

# assembly - 如何查看寄存器中的值？

> ID：15588269
> 
> 赞同：2
> 
> 时间：2013-03-23T15:04:05.147
> 
> 标签：assembly, x86-64, gnu-assembler

我读了关于汇编语言的书，关于指令的一章。我了解指令 mov 正在做什么，但我不明白如何检查并查看结果。我写了一个hello world。

```
.global _start
.data
some_var:
    .long 0x000721
.text
_start:
mov  $1, %rax         # system call 1 is write
mov  $1, %rdi         # file handle 1 is stdout
#  mov  $message, %rsi  # address of string to output
mov $0x1, %rsi
mov  $2, %rdx # number of bytes
syscall               # invoke operating system to do the write
                    # exit(0)
mov  $60, %rax        # system call 60 is exit
xor  %rdi, %rdi       # we want return code 0
syscall               # invoke operating system to exit
message:
.ascii  "Hello, Universe)\n" 
```

但为什么它不起作用。如何查看内存和寄存器中的值？

操作系统：Linux（debian）。英特尔 64 位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:07:51.990

您需要一个*地址*，`rsi`而不是一个值。这就是为什么它适用于

```
mov  $message, %rsi 
```

但不与

```
mov $0x1, %rsi 
```

如果要打印数字，首先需要一个例程将数字转换为 ASCII 字符串（基本上需要编写一个简单版本的`printf`）。

# c# - 如何发送或返回列表 带插座

> ID：15588279
> 
> 赞同：3
> 
> 时间：2013-03-23T15:04:32.740
> 
> 标签：c#, winforms, sockets, c#-4.0

还有一个服务器和客户端套接字。我想学习一种如何将`List<T>`对象发送`IEnumerable<T>`到客户端到服务器或服务器到客户端的方法。我想将服务器端 TaskManager 线程列表发送到客户端。此代码逐行发送，我想发送模板列表。我该怎么做？

```
private static IEnumerable<string> TaskManager()
{
    List<string> lst = new List<string>();

    foreach (System.Diagnostics.Process p in
    Process.GetProcesses().OrderBy(o => o.ProcessName))
    {
        lst.Add(p.ProcessName + "_" + p.Id);
    }
    return lst.AsParallel();
}

....
....
....

while (true)
{
    Socket socket = Listener.AcceptSocket();
    try
    {
        //open stream
        Stream stream = new NetworkStream(socket);
        StreamReader sr = new StreamReader(stream);
        StreamWriter sw = new StreamWriter(stream);
        sw.AutoFlush = true;
        while (true)
        {
            Parallel.ForEach(
                TaskManager(), item=>
                    sw.WriteLine(item)
                );
        }

        stream.Close();
        stream.Dispose();

    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
    }

    Console.WriteLine("Disconnected: {0}", socket.RemoteEndPoint);
    socket.Close();
    socket.Dispose();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T16:16:35.503

您可以使用`BinaryFormatter`来序列化和反序列化列表。

```
using System.Runtime.Serialization.Formatters.Binary;

// Server side
Stream stream = new NetworkStream(socket);
var bin = new BinaryFormatter();
bin.Serialize(stream, TaskManager());

// Client side
Stream stream = new NetworkStream(socket);
var bin = new BinaryFormatter();
var list = (List<string>)bin.Deserialize(stream); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:20:25.770

您可以自己实现解决方案的所有方面，即序列化、压缩、发送、接收等。大部分内容可以通过阅读[WCF](http://msdn.microsoft.com/en-us/library/dd936243.aspx)或[System.Net](http://msdn.microsoft.com/en-us/library/gg145039.aspx)命名空间来找到。但是，我可以在这里使用[网络库 NetworkComms.Net](http://www.networkcomms.net)为您提供一个非常简洁的解决方案。

对于客户：

```
using System;
using NetworkCommsDotNet;

namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            //Create a connection
            Connection connection = TCPConnection.GetConnection(new ConnectionInfo("127.0.0.1", 10000));

            //Make a request for the threadIds and get the answer in one statement. 
            string[] taskManagerThreadIds = connection.SendReceiveObject<string[]>("ThreadIdRequest", "ThreadIds", 2000);

            Console.WriteLine("Server provided an array containing {0} ids", taskManagerThreadIds.Length);

            Console.WriteLine("Send completed. Press any key to exit client.");
            Console.ReadKey(true);
            NetworkComms.Shutdown();
        }
    }
} 
```

对于服务器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Diagnostics;

using NetworkCommsDotNet;

namespace Server
{
    class Program
    {
        static void Main(string[] args)
        {
            NetworkComms.AppendGlobalIncomingPacketHandler<object>("ThreadIdRequest", (packetHeader, connection, incomingPlayer) =>
            {
                //Reply with the requested threadIds
                Console.WriteLine("Received thread ID request from {0}.", connection.ToString());
                connection.SendObject("ThreadIds", TaskManager().ToArray());
            });

            //Start listening for incoming TCP Connections
            TCPConnection.StartListening(true);

            Console.WriteLine("Server ready. Press any key to shutdown server.");
            Console.ReadKey(true);
            NetworkComms.Shutdown();
        }

        private static IEnumerable<string> TaskManager()
        {
            List<string> lst = new List<string>();

            foreach (System.Diagnostics.Process p in
            Process.GetProcesses().OrderBy(o => o.ProcessName))
            {
                lst.Add(p.ProcessName + "_" + p.Id);
            }
            return lst.AsParallel();
        }
    }
} 
```

您显然需要从[网站](http://www.networkcomms.net)下载 NetworkComms.Net DLL，以便将其添加到“使用 NetworkCommsDotNet”参考中。另请参阅客户端示例中的服务器 IP 地址当前为“127.0.0.1”，如果您在同一台机器上同时运行服务器和客户端，这应该可以工作。

免责声明：我是这个库的开发者之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:09:51.243

如果您想要一个可靠且健壮的解决方案，请使用 WCF 而不是自己实现序列化。

此外，从并行线程写入流将无法正常工作。来自不同线程的部分行会混合在一起形成一些无形垃圾：

```
Parallel.ForEach(
   TaskManager(), item=>
   sw.WriteLine(item)
); 
```

# sqlite - 我应该如何设计这个数据库？

> ID：15588286
> 
> 赞同：0
> 
> 时间：2013-03-23T15:04:44.010
> 
> 标签：sqlite

所以我必须为客户设计一个带有字段（Id、name、bla、bla、电话号码）的表格。最后一个字段让我感到害怕，因为不仅有一个数字，而且还有很多。我看到了完成这项任务的 3 种方法

1.  该字段是字符串。在插入之前的任何时候，电话号码的字符串数组都使用分隔符“;”进行编码 然后作为字符串插入。
2.  该字段是 BLOB。字符串数组是直接存储的（不知道这在 sqlite 中是否可行）。
3.  使用字段 (ClientId, PhoneNumber) 为电话号码创建另一个表。

什么似乎是最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:06:58.440

由于在一个字段中存储多个值是不好的做法，因此所述的第三个选项是常规方法。

# javascript - jQuery 在 Firefox 中中断，但没有其他浏览器

> ID：15588299
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:05:41.223
> 
> 标签：javascript, jquery, firefox

我有以下代码在包括 Firefox 在内的所有浏览器中都可以正常工作：

```
var top;
var imageHeight;
function upFunction() {
    top = parseInt($(".feature img").css("top"));
    imageHeight = $(".feature img").height();
    if (top > (imageHeight - 335) * -1) {
        $(".feature img").css("top", top - 1 + "px");
        $("#topPos").val(top - 1);
    }
};
$(document).ready(function() {
$("a#up").mousedown( function(e) {
        e.preventDefault();
        upFunction();
        timeoutId = setInterval( upFunction, 100 );
    }).bind('mouseup mouseleave', function() {
        clearInterval(timeoutId);
    });
}); 
```

但是，我的页面中显然还有其他内容导致它无法在 Firefox 中运行，我无法解决。

有什么方法可以让我找出导致它崩溃的原因，而无需从页面中删除所有内容以找出它是什么？

编辑：

好的，在 Jai 的回答的帮助下，似乎对我的代码进行了一些小调整，使其可以在 Firefox 中运行。这是我所做的：

```
function upFunction() {
    var top = parseInt($(".feature img").css("top"));
    var imageHeight = $(".feature img").height();
    if (top > (imageHeight - 335) * -1) {
        $(".feature img").css("top", top - 1 + "px");
        $("#topPos").val(top - 1);
    }
}; 
```

并从全局范围中删除 2 个变量。不知道为什么它会有所不同，但确实如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:32:36.013

你应该试试这个：

```
function upFunction(top, imageHeight) {
   if (top > (imageHeight - 335) * -1) {
       $(".feature img").css("top", top - 1 + "px");
       $("#topPos").val(top - 1);
   }
}
$(document).ready(function() {
    var top = parseInt($(".feature img").css("top"));
    var imageHeight = $(".feature img").height();
    $("a#up").mousedown( function(e) {
        e.preventDefault();
        upFunction(top, imageHeight);
        timeoutId = setInterval(function(){
                        upFunction(top, imageHeight);
                    }, 100);
    }).bind('mouseup mouseleave', function() {
        clearInterval(timeoutId);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:17:24.053

试试这些固定变量声明：

```
function upFunction() {
    var img = $(".feature img"),
        top = parseInt(img.css("top"));
    if (top > (335 - img.height())) {
        img.css("top", top - 1 + "px");
        $("#topPos").val(top - 1);
    }
};
$(document).ready(function() {
    var timeoutId;
    $("a#up").mousedown( function(e) {
        e.preventDefault();
        upFunction();
        timeoutId = setInterval( upFunction, 100 );
    }).bind('mouseup mouseleave', function() {
        clearInterval(timeoutId);
    });
}); 
```

关于您的实际问题：通过在开发人员工具（Firebug）中检查脚本来调试您的脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T21:42:48.277

不要`top`在全局范围内用作 var 名称，它已被使用。

尝试在浏览器的控制台中输入`console.log(top)`或以供参考。`alert(window.top)`

# java - 平板布局，使用纵向片段而不是横向布局

> ID：15588303
> 
> 赞同：0
> 
> 时间：2013-03-23T15:05:50.177
> 
> 标签：java, android, layout, fragment

我目前正在为我的音乐应用程序设计一个平板电脑布局。

手机版的音乐播放器片段有两种不同的布局，一种是纵向的，一种是横向的。我有另一个片段显示当前播放列表中的歌曲。

对于平板电脑横向布局，我想显示纵向播放器布局和播放列表。

这是平板电脑布局的资源：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:background="@drawable/background"
  android:orientation="horizontal" >

<fragment android:name="de.qspool.clementineremote.ui.fragments.PlayerFragment"
          android:id="@+id/playerFragment"
          android:layout_weight="1"
          android:layout_width="match_parent"
          android:layout_height="match_parent" />

<LinearLayout android:id="@+id/playlistSongsFragment"
        android:layout_weight="1"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
```

我的问题是，android 显示片段“playerFragment”的横向布局。我怎样才能强迫他显示肖像版？

提前致谢。

问候，阿斯法罗斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T18:08:53.550

您可以从 AndroidManifest.xml 强制任何活动以横向或纵向显示

```
 <activity android:name="youractivity" android:screenOrientation="portrait" ></activity> 
```

# php - Tinymce，php不将数据存储到mysql中

> ID：15588304
> 
> 赞同：0
> 
> 时间：2013-03-23T15:05:51.990
> 
> 标签：php, mysql, mysqli, tinymce

我会使用mysql来存储用tinymce保存的新闻的路径，但是从代码发布新闻保存在文件夹中而不是插入到数据库中，奇怪的是我没有从mysql中得到任何错误。这是我的代码，谢谢，对不起，我的英语不好：D

```
<?php
/*

Configuration file
for write_post.php

*/
include ('config_db.php');
$query = "INSERT into news (path,count) values ('$qry', '1')";
$qry = NULL;
   $cat= $_POST['cat'] . "/";
   $newsTitel   = isset($_POST['title']) ? $_POST['title'] : 'Untitled';
   $submitDate  = date('Y-m-d g:i:s A');
   $newsContent = isset($_POST['newstext']) ? $_POST['newstext'] : 'No content';
   $qry = $cat.$_POST['title'].".txt";

   //$filename = date('YmdHis');
   $filename = $newsTitel;
   $f = fopen($cat . $filename.".txt","w+");    
   fwrite($f,$newsTitel."\n");
   fwrite($f,$submitDate."\n");
   fwrite($f,$newsContent."\n");
   fclose($f);
   //$post = $cat . $filename . ".txt";
   if($mysqli->query($query)){
       echo "<br/>";
       echo "News inserita con successo!";
   }else{
       echo "<br/>";
       echo "Errore\n" . $mysqli->error;
   }
   echo "<br/>";
   // Try to echo $variable to check if is correct, and is ok but don't go into db 
   echo $qry;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:16:59.413

在准备 $qry 之前，您正在准备变量 $query。所以尝试以下方法：

但是，请注意，您既没有使用 sprintf() 和 mysql_real_escape_string()，也没有使用 mysqli 变量替换，强烈建议您避免数据库注入。

```
<?php
/*

Configuration file
for write_post.php

*/
include ('config_db.php');
$qry = NULL;
   $cat= $_POST['cat'] . "/";
   $newsTitel   = isset($_POST['title']) ? $_POST['title'] : 'Untitled';
   $submitDate  = date('Y-m-d g:i:s A');
   $newsContent = isset($_POST['newstext']) ? $_POST['newstext'] : 'No content';
   $qry = $cat.$_POST['title'].".txt";

   //$filename = date('YmdHis');
   $filename = $newsTitel;
   $f = fopen($cat . $filename.".txt","w+");    
   fwrite($f,$newsTitel."\n");
   fwrite($f,$submitDate."\n");
   fwrite($f,$newsContent."\n");
   fclose($f);
   //$post = $cat . $filename . ".txt";

   // preparing query here
   $query = "INSERT into news (path,count) values ('$qry', '1')";

   if($mysqli->query($query)){
       echo "<br/>";
       echo "News inserita con successo!";
   }else{
       echo "<br/>";
       echo "Errore\n" . $mysqli->error;
   }
   echo "<br/>";
   // Try to echo $variable to check if is correct, and is ok but don't go into db 
   echo $qry;
?> 
```

# ios - 使用多种颜色抚摸上下文

> ID：15588305
> 
> 赞同：0
> 
> 时间：2013-03-23T15:05:58.100
> 
> 标签：ios, objective-c, quartz-graphics

我正在绘制一个图表，我希望上升线为绿色，下降线为红色。我尝试了以下方法：

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSetLineWidth(context, 2);
CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);

CGPoint previousPoint = CGPointMake(0.0, 0.0);

//graph the points
for (int i = 0; i < self.numberOfS; i++) {
    CGPoint currentPoint = CGPointMake(150+(40*[[[self.grades objectAtIndex:i] s] doubleValue]), 59+(40*(i+1)));
    if (previousPoint.x != 0.0f) {
        if (previousPoint.x > currentPoint.x) {
            CGContextMoveToPoint(context, previousPoint.x, previousPoint.y);
            CGContextSetStrokeColorWithColor(context, [UIColor greenColor].CGColor);
            CGContextAddLineToPoint(context, 150+(40*[[[self.grades objectAtIndex:i] semesterGPA] doubleValue]), 59+(40*(i+1)));
        } else{
            CGContextMoveToPoint(context, previousPoint.x, previousPoint.y);
            CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);
            CGContextAddLineToPoint(context, 150+(40*[[[self.grades objectAtIndex:i] semesterGPA] doubleValue]), 59+(40*(i+1)));
        }

    }
    previousPoint.x = currentPoint.x;
    previousPoint.y = currentPoint.y;
} 
```

但它不起作用，一切都是红色的。我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:36:26.433

好的解决了问题，我刚刚输入了这行代码：

```
CGContextStrokePath(context); 
```

# php - whois 脚本没有获取某些域

> ID：15588307
> 
> 赞同：1
> 
> 时间：2013-03-23T15:06:12.807
> 
> 标签：php, whois

我正在尝试使用此功能获取 whois 数据：

```
function getDomain()
$domain = 'stackoverflow.com';
$whois = '';
$connection = @fsockopen('whois.internic.net', 43);
if ($connection) {
    @fputs($connection, $domain ."\r\n");
    while (!feof($connection)) {
        $whois .= @fgets($connection, 128);
    }
}
fclose($connection);
return $whois;
} 
```

它适用于某些域，但是当我尝试“apple.com”、“cnn.com”或“google.com”时，得到以下信息：

```
APPLE.COM.ZON.COM
APPLE.COM.WWW.ZON.COM
APPLE.COM.WWW.BEYONDWHOIS.COM
APPLE.COM.WAS.PWNED.BY.M1CROSOFT.COM
APPLE.COM.MORE.INFO.AT.WWW.BEYONDWHOIS.COM
APPLE.COM.IS.OWN3D.BY.NAKEDJER.COM
APPLE.COM.IS.0WN3D.BY.GULLI.COM
APPLE.COM.DENIS.DA.DOIDE.DA.PIEM.UNIX-BG.COM
APPLE.COM.BEYONDWHOIS.COM
APPLE.COM.AT.WWW.BEYONDWHOIS.COM
APPLE.COM 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-29T18:53:37.683

您的脚本仅查询

```
whois.internic.net 
```

请记住，全球有几个域/IP 提供商。

大多数 linux 发行版中提供的完整工具都知道尝试几个不同的服务器，然后检查所有服务器的数据以确定哪个服务器是权威服务器。

从记忆中，我相信有 5 个全球权威区域，您已经拥有的内部区域还有：

```
whois.afrinic.net
whois.lacnic.net
whois.arin.net
whois.apnic.net 
```

Ripe（我们在欧洲使用的中央注册中心）也有一个，但它不是您所期望的“whois.ripe.net”，我现在没有时间查找它。

现在，除了我上面所说的之外，您可能还需要考虑以下内容。如果大多数 whois 权威机构认为您在 24 小时内发出过多请求，他们会限制（甚至阻止）您的流量，相反，您可能需要考虑登录上述任何提供商的 ftp 站点并下载各种位数据库，然后编写（或查找）您自己的脚本来处理它们。

我目前使用自己的一台服务器执行此操作，该服务器使用以下 shell 脚本连接（每 24 小时一次）：

```
#!/bin/bash
rm -f delegated-afrinic-latest
rm -f delegated-lacnic-latest
rm -f delegated-arin-latest
rm -f delegated-apnic-latest
rm -f delegated-ripencc-latest
rm -f ripe.db.inetnum
rm -f apnic.db.inetnum
rm -f ripe.db.inetnum.gz
rm -f apnic.db.inetnum.gz
wget ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest
wget ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-latest
wget ftp://ftp.arin.net/pub/stats/arin/delegated-arin-latest
wget ftp://ftp.apnic.net/pub/stats/apnic/delegated-apnic-latest
wget ftp://ftp.ripe.net/ripe/stats/delegated-ripencc-latest
wget ftp://ftp.ripe.net/ripe/dbase/split/ripe.db.inetnum.gz
ftp -n -v ftp.apnic.net <<END
user anonymous anonymous@anonymous.org
binary
passive
get /apnic/whois-data/APNIC/split/apnic.db.inetnum.gz apnic.db.inetnum.gz
bye
END
gunzip ripe.db.inetnum
gunzip apnic.db.inetnum 
```

然后，我有一个自定义编写的程序，它将文件解析为自定义数据库结构，然后我的服务器从中进行查询。

由于所有服务器都相互镜像数据，那么您应该能够从一台服务器获取完整的数据集，但如果不是，则不需要太多修改上述 shell 脚本以从其他服务器下载数据，所有他们也回应'ftp.????' 并具有相同的通用文件夹结构。

但是我无法帮助您使用解析器，因为它包含专有代码，但文件格式（尤其是如果您获得拆分文件）与您在典型的 whois 输出中看到的相同，因此非常容易使用。

通过像这样下载和处理您自己的数据，您可以绕过供应商施加的任何限制，结果是查询您自己的数据存储很可能比每次都从您的服务器向查询服务器发出请求要快得多有人输入 IP 地址。

## 更新

除了我在这里列出的那些之外，还有很多很多的 whois 服务器，但是，而不是在这个页面上将它们全部列出，这个链接：

[https://jfreewhois.googlecode.com/git/JFreeWhois/src/uk/org/freedonia/jfreewhois/etc/serverlist.xml](https://jfreewhois.googlecode.com/git/JFreeWhois/src/uk/org/freedonia/jfreewhois/etc/serverlist.xml)

将带您到一个 XML 文件，该文件是 google 代码项目的一部分，返回的 XML 文件将为您提供所有可用 whois 服务器的相当大的列表，以及它们每个服务的 TLD 列表，使您能够调整您的脚本根据输入的地址与正确的服务器通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-03T21:48:06.580

`=`用一个符号为您的查询添加前缀，`=example.com`而不仅仅是域名，您将不会看到额外的结果。

很长的原因是，默认情况下，whois 服务器会进行前缀搜索，并将返回存储在注册表中的每个对象，其名称以您在查询中给出的名称开头。而且，尽管鲜为人知，名称服务器是存储在注册表中的对象，而且很久以前，注册无用的名称服务器只是为了“恶作剧”进行查询并获得与您一样的结果的无辜查看者被认为很有趣，这可能会被某些人解释不知道细节为“哦，我的上帝，XXXX 已被黑客入侵，看看这个结果......”，因为你基本上可以添加任何单词作为标签（在两个点之间），只要你完成一个 .COM/.NET您持有的域名。当然，这与攻击无关。

通过使用相等的字符串作为前缀，您可以强制完全匹配而不是前缀匹配。请注意，纯粹主义者可能会补充说，即使在这种情况下，您也可能会看到两条记录，因为您可以注册一个名称为域名名称的名称服务器（这比有用更令人困惑，但它是可能的并且发生了）。

顺便说一句，对于 .COM 域名，您应该使用相关的注册表 whois 服务器，即`whois.verisign-grs.com`. 其他顶级域名也是如此。请注意，根据您搜索的内容，每个域可能需要 2 个 whois 查询，因为 .COM/.NET （目前）仍然是一个瘦注册表。有关这一点的更多详细信息，请参阅我在[https://unix.stackexchange.com/a/407030/211833](https://unix.stackexchange.com/a/407030/211833)上的回答。

# python - 无法访问使用 tempfile 创建的临时文件

> ID：15588314
> 
> 赞同：6
> 
> 时间：2013-03-23T15:06:45.123
> 
> 标签：python, windows

我`tempfile.NamedTemporaryFile()`用来存储一些文本，直到程序结束。在 Unix 上工作没有任何问题，但在 Windows 上，返回的文件无法读取或写入：python 提供 Errno 13。唯一的方法是`delete=False`使用`os.remove()`. 为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T18:03:56.227

> 这会导致 IOError，因为文件在创建后只能打开一次。

原因是因为在 Windows 上`NamedTemporaryFile`创建带有`FILE_SHARE_DELETE`标志的文件。在 Windows 上，当使用特定共享标志创建/打开文件时，所有后续打开操作都必须传递此共享标志。`open`不传递`FILE_SHARE_DELETE`标志的 Python 函数并非如此。[请参阅我关于如何创建可由子进程读取的临时文件的](https://stackoverflow.com/q/15169101/95735)答案？有关更多详细信息和解决方法的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:11:05.490

看看：[http ://docs.python.org/2/library/tempfile.html](http://docs.python.org/2/library/tempfile.html)

```
 tempfile.NamedTemporaryFile([mode='w+b'[, bufsize=-1[, suffix=''[, prefix='tmp'[, dir=None[, delete=True]]]]]]) 
```

此函数的操作与 TemporaryFile() 完全一样，除了文件保证在文件系统中具有可见名称（在 Unix 上，目录条目未取消链接）。该名称可以从文件对象的名称属性中检索。在命名的临时文件仍处于打开状态时，该名称是否可用于第二次打开文件，因平台而异（在 Unix 上可以这样使用；**在 Windows NT 或更高版本上不能**）。如果 delete 为 true（默认值），则文件一关闭就会被删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-13T07:59:27.790

感谢@Rnhmjoj，这是一个可行的解决方案：

```
 file = NamedTemporaryFile(delete=False)
    file.close() 
```

您必须使用`delete`-flag 保留文件，然后在创建后将其关闭。这样，Windows 将解锁文件，您可以使用它来做事！

# ruby-on-rails - 如何为 MiniTest 扩展 LOAD_PATH？

> ID：15588318
> 
> 赞同：1
> 
> 时间：2013-03-23T15:06:58.463
> 
> 标签：ruby-on-rails, padrino, minitest

[[旁白：我正在“在 autotest 或 Guard 下安装、配置和运行 minitest 的简明秘诀](https://stackoverflow.com/q/15575952/558639)”中慢慢回答我自己的问题]

我的环境：Ruby 2.0。帕德里诺 0.10.7。迷你测试 2.6.2。机架测试 0.6.2。

简短形式：扩展 $LOAD_PATH 以包含我的测试目录以便我可以简单地`require 'test_helper'`在我的测试文件中的最佳方法是什么？

长表：

这是一个示例测试文件。注意`require_relative "../../../test_helper"`-- 这需要跟踪相对于 test_helper 的测试文件。

```
# file: test/models/api/v0/index_test.rb
require_relative '../../../test_helper'

describe 'nobody home' do
  it 'fetch fails' do
    get "/api/v0/a_uri_that_does_not_exist"
    last_response.status.must_equal 404
  end
end 
```

这是测试助手：

```
# file: test/test_helper.rb
PADRINO_ENV = 'test' unless defined?(PADRINO_ENV)
require File.expand_path('../../config/boot', __FILE__)

class MiniTest::Unit::TestCase
  include Rack::Test::Methods

  def app
    Demo.tap { |app|  }
  end
end 
```

最后，驱动它的 rakefile（由 padrino 生成，通过 调用`padrino rake test`）：

```
# file: test/test.rake
require 'rake/testtask'

test_tasks = Dir['test/*/'].map { |d| File.basename(d) }
$stderr.puts("=== test_tasks = #{test_tasks}")

test_tasks.each do |folder|
  Rake::TestTask.new("test:#{folder}") do |test|
    test.pattern = "test/#{folder}/**/*_test.rb"
    test.verbose = true
  end
end

desc "Run application test suite"
task 'test' => test_tasks.map { |f| "test:#{f}" } 
```

`require_relative '../../../test_helper'`那么：用可靠且易于记忆的代替易碎的东西需要什么`require 'test_helper'`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T16:40:39.420

你需要添加库：

```
Rake::TestTask.new("test:#{folder}") do |test|
  test.pattern = "test/#{folder}/**/*_test.rb"
  test.verbose = true
  test.libs << 'test' # <-- this
end 
```

或者，如果您使用 ruby​​ 直接调用它：

```
$ ruby -Itest test/test_file.rb 
```

# ios - 是否可以开发通行证创建者？

> ID：15588320
> 
> 赞同：1
> 
> 时间：2013-03-23T15:07:08.410
> 
> 标签：ios, objective-c, passbook

我调查 Apple Passbook 的开发。我发现，如果您要向订阅者传递一些东西，您应该创建特殊的 .pkpass 文件并以各种方式分发它们。但是是否可以在 iOS 应用程序中创建自己的通行证并将其添加到 Passbook？例如，我有条形码，所有附加信息，所以我希望应用程序用户配置他自己的通行证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T15:58:18.430

开发自己的通行证创建应用程序在技术上当然是可行的，但是完全在应用程序中创建 .pkpass 包需要您将通行证 ID 私钥嵌入应用程序中，这会带来巨大的安全风险。

在实践中，您的 App 应该将 pass 数据发送到您的 Web 服务器，该服务器应该编译[.pkpass 包](https://developer.apple.com/library/ios/#documentation/UserExperience/Reference/PassKit_Bundle/Chapters/Introduction.html)并将该包传输回您的 App 以添加到 Passbook。

Apple [Pass Kit 框架参考](https://developer.apple.com/library/ios/#documentation/UserExperience/Reference/PassKit_Framework/_index.html#//apple_ref/doc/uid/TP40012158)为您提供了从您的 Web 服务器接受包含您的用户提供给您的应用程序的信息的通行证所需的一切。

# if-statement - 从多个文件夹批量文件日期检查

> ID：15588323
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:07:24.357
> 
> 标签：if-statement, batch-file, copy, set, xcopy

我正在寻找（如果可能的话）一个检查和复制批处理脚本，我可以远程运行它来检查多个目录并复制最新的修改日期。

澄清一下：在远程机器上，我正在查看潜在的五个文件夹（可能存在也可能不存在）。我需要脚本来检查用户可能的 5 个配置文件的两个子文件夹（桌面和 Internet 收藏夹）的最后修改日期，然后选择最近修改日期并将文件夹复制到另一个位置

所以路径看起来像：

```
"\\%asset%\c$\documents and settings\%username%\Desktop"
"\\%asset%\c$\documents and settings\%username%\Favorites" 
```

检查日期并将其与（可能）进行比较

```
"\\%asset%\c$\documents and settings\%username%.temp\Desktop"
"\\%asset%\c$\documents and settings\%username%.temp\Favorites" 
```

或者

```
"\\%asset%\c$\documents and settings\%username%.temp001\Desktop"
"\\%asset%\c$\documents and settings\%username%.temp001\Favorites" 
```

找到具有最近修改日期的子文件夹后，将其复制（仅最新）到：

```
"\\%asset%\c$\documents and settings\Backup" 
```

我知道我可以在一个位置完成检查，但我不知道如何要求批处理运行多个检查，然后选择最近的。

这实际上是*可能的*还是我用错误的语言尝试这个？我已经得到了所有东西，但支票被写出来了，这就是我被卡住的地方......

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T17:09:45.233

正如我在评论中所说，我认为 Powershell 更适合这项任务。但我确实想到了一种可以批量工作的方法，而不必求助于文本日期比较（这很困难）。

您可以使用复制时间戳`robocopy`的选项。`/copy:t`想象一下，将所有三个目录复制到一个位置，然后执行 a`dir /b /od`列出这个按日期排序的临时目录以找到最新的目录，并将其复制到您的目标。

我没有时间测试这个理论或给你真正的代码，但希望它能给你一种尝试的方法。或者说服你看看Powershell。:-)

# php - 从数据库中随机获取前 3 条记录：php-mysql

> ID：15588324
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:07:24.933
> 
> 标签：php, mysql

我想创建一个从 MySQL 数据库中获取图像数据的随机图像横幅。而且我只想随机获取最新的三条记录。

如何以随机顺序获取最近的 3 条记录？

我是以下查询：

```
SELECT * FROM bottom_advt WHERE bottom_advt_page_name='News' ORDER BY RAND() LIMIT 1 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:09:12.187

你说3条记录。所以试试：

```
SELECT * FROM bottom_advt WHERE bottom_advt_page_name='News' ORDER BY RAND() LIMIT 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:09:16.217

您将结果限制为`LIMIT 1`. 将其更改`LIMIT 3`为获得三个结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:28:41.307

如果您想要最后三个记录之一，请尝试此操作：

```
SELECT * FROM bottom_advt WHERE bottom_advt_page_name='News' AND id+3>last_insert_id() ORDER BY RAND() LIMIT 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T16:33:11.033

你可以使用这个：

```
SELECT *
FROM bottom_advt
WHERE ID IN (SELECT * FROM (
  SELECT id
  FROM bottom_advt
  WHERE bottom_advt_page_name='News'
  ORDER BY id DESC
  LIMIT 3) last)
ORDER BY RAND()
LIMIT 1 
```

子查询将返回最后 3 个具有 id 的 id `bottom_advt_page_name='News'`，而外部查询将随机选择其中一个。

请[在此处](http://sqlfiddle.com/#!2/b843f/1)查看小提琴。

# c# - 将模型传递到服务层和从服务层传递模型

> ID：15588325
> 
> 赞同：3
> 
> 时间：2013-03-23T15:07:29.273
> 
> 标签：c#, architecture, soa

假设我有一个模型：

```
public class Thing
{
    public int? identifier { get; set; }
    public string Title { get; set; }
    public string Description { get; set; }
    ... // arbitrary number of additional properties.
} 
```

以及包含两个关键方法的服务层接口：

```
public interface IThingService
{
    Thing GetThing(int id);
    Thing AddThing(Thing thing);
} 
```

现在，假设服务层会自动`identifier`为每个事物生成一个`AddThing`. 还假设将其公开`identifier`给表示层很重要，因为它可能会传递给其他服务。

鉴于我必须通过一个`Thing`to `AddThing`，这是最好的建模方式`Thing`吗？表示层的开发者可能认为他们可以指定一个`identifer`，但这会被 的具体实现忽略`IThingService`。当然，`identifier`必须是 public 才能由`IThingService`for设置`GetThing`。

是否可以简单地*忽略*传入的`identifier`调用`AddThing`，或者是否有更好的方法对此进行建模以防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T19:06:17.047

您的服务应如下所示：

```
public interface IThingService
{
    Thing GetThing(int id);
    ThingCreationResponse AddThing(ThingCreationRequest request);
} 
```

`ThingCreationRequest`将拥有创建`Thing`实体所需的所有数据。它没有标识符。标识符将由`AddThing`.

`AddThing`可以简单地返回一个`Thing`id，但在这种情况下，您应该提供一个有据可查的协议来传达错误（在失败的情况下返回负值，或抛出异常）。

返回 的实例`ThingCreationResponse`将为您提供更好的灵活性，因为您可以返回 id 或 new 的完整实例`Thing`，也可以更好地传达失败原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:23:44.890

这仅在服务运行在原始`Thing`实际存在的同一内存上时才有效。如果此服务断开连接，例如在另一台机器上，则更新`Thing`不会影响原始实例并且`identifier`永远不会返回到调用代码。

考虑到这一点，有 2 条可能的路径：您打算让此服务始终在本地并在与调用应用程序相同的内存上运行，或者您打算让此服务实际断开连接或最终断开连接。

### 连接的

如果它已连接，此接口将正常工作，但您可能仍希望隐藏标识符的设置器。如果这样做，您可以将其设为内部并`Thing`在单独的程序集中定义服务接口和对象，这将使表示层无法访问设置器。好吧，您仍然可以通过反射或其他 hijink 调用它，但对于典型的东西，它将无法访问。

### 断开连接

这个接口被破坏了，因为您无法以任何方式检索标识符，并且为了检索现在保存的项目是必要的。如果它足够小，这里的典型解决方案会从`AddThing`方法或整个对象（新内存）返回标识符。

除此之外，不可变的数据项很难推理，无论哪种情况，我都可能更愿意`Thing`在调用后创建一个新`AddThing`的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:21:38.167

我认为在这种情况下，AddThing 的正确签名将是 AddThing(string title, string description)，并且该方法的职责是使用生成的标识符构建 Thing 对象。

考虑到您的最后一个规范，我建议创建第二个类，ThingWithId 作为成员标识符和 Thing。AddThing 的签名将更改为 ThingWithId AddThing(Thing thing)

# ruby - 预购和后购访客

> ID：15588327
> 
> 赞同：2
> 
> 时间：2013-03-23T15:07:40.303
> 
> 标签：ruby, compiler-construction, abstract-syntax-tree, visitor-pattern

我正在开发一个用 Ruby 编写的编译器，目前正处于语义分析阶段（类型检查）。我有一个 AST，我需要通过两种方式访问​​：预购和后购，我想知道在 Ruby 中最好的方法是什么。我知道将块传递给`each`本质上是访问者模式，但由于我需要以两种方式（前、后）访问，而 Ruby 不支持方法重载，我不知道如何处理这个问题。

（注意：我试图让 Node 对象控制它们的访问方式，所以我的访问者不会臃肿）

这是我正在考虑的尝试：

每个 Node 类有两个 accept 方法`accept_pre`，`accept_post`调用其他 Node 对应的`accept_pre`和`accept_post`方法

```
class Node
  def initialize(a, b, c)
    @a, @b, @c = a, b, c
  end

  def accept_pre(visitor)
    @a.accept_pre visitor
    @b.accept_pre visitor
    @c.accept_pre visitor
    vistor.visit_node(self)
  end

  def accept_post(visitor)
    visitor.visit_node(self)
    @c.accept_post visitor
    @b.accept_post visitor
    @a.accept_post visitor
  end
end 
```

有一个更好的方法吗？`.each`即使我需要两个订单，它也可以完成吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T17:01:18.687

您可以使用遍历选项 arg 将两个排序折叠成一个接受。您当然可以使用每个节点的成员来调度孩子的接受。

```
class Node
  def initialize(a, b, c)
    @a, @b, @c = a, b, c
  end

  def accept(visitor, traversal=:pre)
    visitor.visit(self) if traversal == :pre

    order = traversal == :pre ? :each : :reverse_each
    [@a,@b,@c].send(order) { |e| e.accept(visitor, traversal) }

    visitor.visit(self) if traversal == :post
  end
end 
```

# linux - 我应该将数据库和 CMS 文件放在单独的 EBS 或 S3 上吗？

> ID：15588328
> 
> 赞同：0
> 
> 时间：2013-03-23T15:07:43.053
> 
> 标签：linux, amazon-web-services, amazon-s3, amazon-ec2, backup

是否有可能，甚至建议使用保留在实例终止状态的 EBS 实例来存储数据库/网站文件，并在发生故障时重新附加到新的 Amazon 实例？或者我应该将卷包备份到 S3 吗？另外，我需要一个应用程序来智能地加速终端窗口功能。你能告诉我我是一个linux NOob吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T20:26:09.490

我们使用我们的 Nexus 安装来执行此操作 - 数据存储在一个单独的 EBS 实例上，该实例定期生成快照，但根磁盘不是（因为我们可以使用 Puppet 使用最新的基础 AMI、Java、Tomcat 和 Nexus 创建一个工作的 Nexus 实例版本）。这种方法的一个缺点（与备份到 S3 的其他方法相比）是，如果需要，您无法在 AWS 之外检索它 - 如果这是一个重要的用例，我建议上传卷包或 . tar.gz 备份到 S3。

但是，在您的情况下，如果您有一个由 EBS 支持的 EC2 实例，它是您的 CMS 服务器，您可以使用大根卷运行它并定期备份（使用 EBS 快照或将 .tar.gz 备份到 S3 ) - 如果您不是特别熟悉 Linux，这可能是确保备份所有数据的最简单方法（并且如果您只需要提取数据，您始终可以通过附加该卷（或它的快照的实例化）到另一台机器 - 您还可以访问所有可能有用的配置文件......

请记住，如果您只想在某些时候运行您的服务器，您可以随时停止实例而不是终止它 - EBS 实例将保留。拍摄快照后，您的数据是安全的 - 如果 EBS 实例的一部分发生故障但自上次快照以来尚未修改，则 AWS 将使用 EBS 快照数据透明地恢复它。

# java - Android Java：选择列表行时仅显示`id`的值

> ID：15588329
> 
> 赞同：1
> 
> 时间：2013-03-23T15:07:45.607
> 
> 标签：java, android

所以这是我的代码：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.merken);

    DatabaseStuff dbStuff = new DatabaseStuff(this);

    itDetails = new Intent(Merken.this, MerkDetails.class);
    lstMerken = (ListView) findViewById(R.id.ListViewMerken);

    ListAdapter adapter = new SimpleAdapter(
        this,
        dbStuff.getMerken(),
        R.layout.merkcell,
        new String[] { "name", "id" },
        new int[] { R.id.title, R.id.id }
    );
    lstMerken.setFastScrollEnabled(true);
    lstMerken.setAdapter(adapter);
    lstMerken.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> aV, View vW, int pos, long lng) {
            Log.v("YH", lstMerken.getItemAtPosition(pos).toString());

            //MerkDetails.MerkUid = lstMerken.getItemAtPosition(i).toString();
            //startActivity(itDetails);
        }                 
    });
} 
```

我现在得到的输出是：`{name="someName", id="187"}`

我的问题是我如何才能只输出`187`，所以只有`id`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:09:44.270

试试这个

```
 String uid = (String)((TextView) vW.findViewById(R.id.title)).getText().toString(); 
```

# php - LONG POLLING（在 php 中）在 5 次对数据库的请求后开始挂起

> ID：15588344
> 
> 赞同：3
> 
> 时间：2013-03-23T15:09:45.830
> 
> 标签：php, ajax, long-polling, response-time

我正在开发带有**实时**竞价系统的**现场拍卖网站。**当用户对项目出价时，我正在使用**LONG POLLING 。**我选择了长轮询，因为**WebSockets**还没有得到很好的支持，而且**NODEJS**对我来说现在实现起来很复杂。所以我坚持使用这个简单的 ajax 长轮询，它适用于大约五个投标。

 ********所以问题是：**在 1 秒的时间间隔内，投标对 5-6 个项目的投标非常有效（我从 server-ajax 获得即时响应），但是在投标按钮上的第 7 次（点击）这个响应长轮询会挂起大约 16-22 秒然后完成请求。最后，所有内容都在数据库中更新并完成，但每 5-6 次出价响应/ajax 调用挂起约 16-22 秒。

**怎样才能减少这个时间，无论用户出价多少次，一切都应该顺利，没有滞后......**

**我在 localhost/wamp 上使用 Apache/PHP/MySql**

我的代码： **index.php**

```
<script type="text/javascript" charset="utf-8">             
var old_timestamp = <?php echo $old_timestamp;?>; //here i'm echoing last timestamp of         auction

function waitForMsg(){
jq.ajax({
type: "POST",
url: "http://localhost/bid/comet/poll.php",
data: {"old_timestamp" : old_timestamp},
async: true,
cache: false,

success: function(data){
var json = eval('(' + data + ')');
if(json['msg'] != "") {
jq('#comet_display').html(json['msg']); //here I show ID of which auction item was bidded
}
old_timestamp = json['old_timestamp']; 
setTimeout('waitForMsg()',100);
},
error: function(XMLHttpRequest, textStatus, errorThrown){

setTimeout('waitForMsg()',1000);
}
});
}

jq(window).load(function(){ 
waitForMsg();
jq("#a_loader").show();
    var url = "http://localhost/bid/auctions-ajax"; // the script where you handle the form input.  
    jq.ajax({
           type: "POST",
           url: url,
           data: {au978 : true}, 
           async:false, //to sem dodal za časovni zamik
           success: function(data)
           {
             jq("#a_loader").hide();  
             jq("#show-category").html(data); // show response from the php script.              
           },
            error: function(result) {
                jq("#show-category").html("Sorry, something went wrong. Please try again later.");
            }
    });

});

function bid(id){

var url = "http://localhost/bid/comet/update-auction.php"; // the script where you handle the form input.
var user_id=<?php echo $user_id;?>; //user id from session
jq.ajax({
    type: "POST",
    url: url,
    data: {"auct_id" : id, "user_id" : user_id}, // serializes the form's elements.
    success: function(data)
    {
        //it updates in user table its remaining number of bids 
    },
    error: function(XMLHttpRequest, textStatus, errorThrown){
        alert("Something went wrong. Click OK to refresh.");

    }
});
}

</script> 
```

**投票.php**

```
<?php

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
require_once($_SERVER['DOCUMENT_ROOT'] . 'bid/include/DEFINES.php');
require_once(CLASS_AUCTION);
require_once(CLASS_DB);

$a=new Auction();

$old_timestamp = $_POST['old_timestamp']; 
$bidded_id=0;
$db=DB::getInstance();  
$sql="SELECT timestamp, id FROM auction ORDER BY timestamp DESC LIMIT 1";   //desno doda tabelo kategorija  
$stmt=$db->db->prepare($sql) or die("Prepare Error");   
$stmt->execute();   
$result2=$stmt->fetchAll(PDO::FETCH_ASSOC);
foreach ($result2 as $rez){
    $current_timestamp=$rez['timestamp'];   
    $bidded_id=$rez['id'];
}
$stmt->closeCursor();

    while($current_timestamp <= $old_timestamp){
    usleep(1000);
    clearstatcache();
    $db=DB::getInstance();  
    $sql="SELECT timestamp, id FROM auction ORDER BY timestamp DESC LIMIT 1";       
    $stmt=$db->db->prepare($sql) or die("Prepare Error");   
    $stmt->execute();   
    $result=$stmt->fetchAll(PDO::FETCH_ASSOC);
    foreach ($result as $rez){
        $current_timestamp=$rez['timestamp'];   
        $bidded_id=$rez['id'];
    }
    $stmt->closeCursor();

}
$response = array();
$response['msg'] = 'BID na avkciji: '.$bidded_id;
$response['old_timestamp'] = $current_timestamp;
echo json_encode($response);
 }else{
require_once($_SERVER['DOCUMENT_ROOT'] . 'bid/errors/404.html');
 }
?> 
```

**和 update-auction.php**

```
<?php
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
require_once($_SERVER['DOCUMENT_ROOT'] . 'bid/include/DEFINES.php');
require_once(CLASS_AUCTION);
require_once(CLASS_USER);
require_once(CLASS_DB);
$u=new User(); 
$a=new Auction();
$auction_id=$_POST['auct_id'];
$user_id=$_POST['user_id'];
$date = new DateTime();
$timestamp=$date->getTimestamp();
$a->updateAuction($auction_id,$user_id,$timestamp/*,$bid_price,$bids_spent,$total_paid*/);
$u->updateUserBids($user_id);

}else{
require_once($_SERVER['DOCUMENT_ROOT'] . 'bid/errors/404.html');
}
?> 
```

*感谢您查看我的问题！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T18:05:58.063

考虑切换到 WebSockets。它旨在解决长轮询问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T17:23:51.180

好的，**我找到了解决**这个 17-22 秒 LAG-HANGING 问题的解决方案。现在它几乎是即时的，无论您点击多少次。但我仍然不确定，这是否是长轮询的最佳解决方案。

如果有人遇到同样的问题，我正在发布它。

**我已将 poll.php 中的 LONG POLLING 函数更改为：**

```
<?php

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
require_once($_SERVER['DOCUMENT_ROOT'] . 'bid/include/DEFINES.php');
require_once(CLASS_AUCTION);
require_once(CLASS_DB);

$a=new Auction();
$db=DB::getInstance();  
$sql="SELECT timestamp, id, last_username FROM auction ORDER BY timestamp DESC LIMIT 1";        
$response = array();
while(1)
{
    $stmt=$db->db->prepare($sql) or die("Prepare Error");   
    $stmt->execute();   
    $result=$stmt->fetch(PDO::FETCH_ASSOC);
    if (!empty($result)){
        $current_timestamp=$result['timestamp'];        
        $response['msg'] = 'New BID';
        $response['old_timestamp'] = $current_timestamp;
        echo json_encode($response);
        break;
    }   
    sleep(3000);
    clearstatcache();
}
}else{
require_once($_SERVER['DOCUMENT_ROOT'] . 'bid/errors/404.html');
}
?> 
```

**现在我在我的 index.php 中轮询，如下所示：**

```
<?php
$db=DB::getInstance();  
$sql="SELECT timestamp FROM auction ORDER BY timestamp DESC LIMIT 1";    
$stmt=$db->db->prepare($sql) or die("Prepare Error");   
$stmt->execute();   
$result2=$stmt->fetch(PDO::FETCH_ASSOC);
$old_id=0;
$last_timestamp=$result2['timestamp'];
?>
<script type="text/javascript" charset="utf-8">             
var last_timestamp = <?php echo $last_timestamp;?>;
var old_timestamp=0;

function waitForMsg(){
jq.ajax({
type: "POST",
url: "http://localhost/bid/comet/poll.php",
async: true,
cache: false,

success: function(data){
var json = eval('(' + data + ')');
if(old_timestamp==0 || last_timestamp==old_timestamp){

}else{
    if(json['msg'] != "") {
    jq('#comet_display').html(json['msg']);
}
}
old_timestamp = json['old_timestamp']; 

setTimeout('waitForMsg()',500);
},
error: function(XMLHttpRequest, textStatus, errorThrown){

setTimeout('waitForMsg()',1000);
}
});
}

jq(window).load(function(){ 
waitForMsg();

});
function bid(id){   
var url = "http://localhost/bid/comet/update-auction.php"; //here I update auction and user's bids
var user_id=<?php echo json_encode($user_id);?>;
var user_name=<?php echo json_encode($user_name); ?>;
jq.ajax({
    type: "POST",
    async: true,
    cache: false,
    url: url,
    data: {"auct_id" : id, "user_id" : user_id, "username" : user_name}, // serializes the form's elements.
    success: function(data)
    {

        setTimeout('waitForMsg()',100);
        var cnt = parseInt(jq(".db_bids").text());
        if (!isNaN(cnt))
        {
            cnt--;
            jq(".db_bids").text(String(cnt));
        }    
    },
    error: function(XMLHttpRequest, textStatus, errorThrown){
        alert("Something went wrong. Click OK to refresh.");

    }
});
}
</script> 
```

我仍在 localhost 上开发它，并将看到它在拥有 100 多个用户的真实服务器上的行为。 **如果有人对数据库中的 LONG POLLING 有更好更快的解决方案**，请告诉我:)******

# jquery - 从 json 文件中提取数据以在 Jquery 中的 .$post 中使用

> ID：15588347
> 
> 赞同：2
> 
> 时间：2013-03-23T15:09:57.480
> 
> 标签：jquery, json, post, playframework-2.0

我想从 json 文件中提取数据以将其发布到服务器端。

这种数据解密有效：

```
$.post('/createDBJSON',{'name':'bar'},
function(data) {window.alert(data);} 
```

但是我需要这样的东西：

```
$.post('/createDBJSON',{'/assets/appconf/db.json'},
function(data) {window.alert(data);} 
```

我知道 $.post 以 PlainObject 或 String 的形式获取数据，但我想以某种方式将数据发布为 json 文件，因为我的 json 文件非常复杂（嵌入的 key-val 对太多），无法使用 $.getJSON 轻松解析为 js 变量按照记录在 $.post 中使用。

为了实现这一目标，我应该考虑另一种方法吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:34:44.257

你可以像这样使用 $.getJSON：

```
$.getJSON('/assets/appconf/db.json', function(json) {

     $.post('/createDBJSON',json,
     function(data) {window.alert(data);}

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T22:52:12.100

`$.post()`我认为当数据是对象时，您可能会遇到一个微妙的问题。它被转换为字符串，而不是 JSON 字符串 - 相反，它被用作构建`application/x-www-form-urlencoded`字符串的一组键值对。

另一个问题`$.post()`是它总是发送一个`application/x-www-form-urlencoded; charset=UTF-8`. 这可能是服务器崩溃的原因：它需要 JSON，但内容类型是`application/x-www-form-urlencoded`. 为了解决这个问题，我们可以使用更通用的`$.ajax()`，它有更多的选项。

试试这个：

```
$.getJSON('/assets/appconf/db_trial.json', function(firstData) 
{
    $.ajax({
        type: "POST",
        url: '/createDBJSON',
        data: JSON.stringify(firstData), // send JSON representation
        contentType: 'application/json; charset=utf-8', // set correct content-type header
        success: function(secondData) {window.alert(secondData);}
    });
}); 
```

我们还可以尝试另一种方法，该方法从不费心将第一个 json 响应转换为对象，然后再转换回 json 字符串，而是始终将其保留为文本：

```
$.ajax({
    dataType: "text", // parse response only as text
    url: '/assets/appconf/db_trial.json',
    success: function(jsonString) {
        $.ajax({
            type: "POST",
            url: '/createDBJSON',
            data: jsonString, // jsonString is already a json string
            contentType: 'application/json; charset=utf-8', // set correct content-type header
            success: function(secondData) {window.alert(secondData);}
        });
    }
}); 
```

请尝试两者！

但我仍然建议修复你的后端，这样数据就不会无缘无故地通过客户端！我认为 Play Framework 2 包含用于 JSON 操作的 Jackson，因此您只需要导入正确的类，并在 Internet 上搜索以了解如何使用 Jackson 库读取 JSON 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T22:55:29.570

原来我的内容类型不是 json。它需要被指定。Play 2.1 json body parse 示例按文档说明工作。我希望他们也提供正确的客户调用示例......

这是有效的ajax调用：

```
$.getJSON('/assets/appconf/db_trial.json', function(json) 
{
    $.ajax({
          url:'/createDBJSON',
          type:"POST",
          data:JSON.stringify(json),
          contentType:"application/json; charset=utf-8",
          dataType:"json",
          success: function(){

          }
        });

}); 
```

# iphone - 在 iOS 的 phonegap 中生成设备令牌 ID

> ID：15588348
> 
> 赞同：1
> 
> 时间：2013-03-23T15:10:01.193
> 
> 标签：iphone, ios, cordova

如何生成`DeviceId`in `phonegap`？我需要有关代码的帮助，这些`iOS`代码需要添加到我的`phonegap`项目中以与之通信`APNS`以获取`DeviceId`

# java - 总和投影和结果约束

> ID：15588349
> 
> 赞同：3
> 
> 时间：2013-03-23T15:10:04.347
> 
> 标签：java, hibernate

我在数据库中有 100 个实体。我想通过前 20 个实体的某些属性得到总和

```
Criteria cr = getSession().createCriteria(Entity.class);
cr.setFirstResult(0);
cr.setMaxResults(20);
cr.setProjection(Projections.sum("propertyName"));
Double sum = cr.uniqueResult(); 
```

但是条件返回所有实体的总和，因为 setMaxResults(20) 限制总和值结果，这是一个对象 - uniqueResult。表示构造不正确。如何正确使用标准获得多个实体的总和？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T00:08:33.507

如果您无法在 ID 上添加约束（例如`.add(Restrictions.le("id", 20))`；如果 ID 是有序的，这将起作用），那么我看到的唯一可能的解决方案是分成 2 个标准：

```
// First, fetch first 20 elements' ids
List<Integer> ids = session.createCriteria(Entity.class)
        .setProjection(Projections.property("id"))
        .setMaxResults(20)
        .list();

// Afterwards, do a sum on the desired field
Long sum = (Long) session.createCriteria(Entity.class)
        .setProjection(Projections.sum("propertyName"))
        .add(Restrictions.in("id", ids))
        .uniqueResult(); 
```

# matlab - SIFT 方向归一化

> ID：15588353
> 
> 赞同：2
> 
> 时间：2013-03-23T15:10:45.460
> 
> 标签：matlab, computer-vision, sift, vlfeat

我想通过旋转它们来规范化筛选描述符，以便水平方向与补丁的主要梯度方向对齐。

我正在使用 vl_feat 库。vl_feat 有什么方法可以标准化筛选描述吗？

或者

使用matlab执行此操作的有效方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:28:25.153

我相信 VLfeat 中的那些已经面向主要梯度方向。

如果你看这里，它会显示它们旋转：[http ://www.vlfeat.org/overview/sift.html](http://www.vlfeat.org/overview/sift.html)

```
 [f,d] = vl_sift(I) ; 
```

f 是关键点的 Nx4 矩阵。N 是关键点索引，另外 4 个是 x 位置、y 位置、比例和方向。d 是一个 Nx128 矩阵，其中 N 是关键点索引，128 个维度属于 SIFT 描述符。

* * *

如果您的所有图像都直立旋转，那么不使用旋转不变性实际上是有益的。请参阅本文假设重力矢量：[https ://dspace.cvut.cz/bitstream/handle/10467/9548/2009-Efficient-representation-of-local-geometry-for-large-scale-object-retrieval.pdf ?序列=1](https://dspace.cvut.cz/bitstream/handle/10467/9548/2009-Efficient-representation-of-local-geometry-for-large-scale-object-retrieval.pdf?sequence=1)

# image-processing - 有损png压缩

> ID：15588356
> 
> 赞同：5
> 
> 时间：2013-03-23T15:11:07.577
> 
> 标签：image-processing, png

在保留 alpha 层的同时，建议使用哪种库进行有损 png 压缩。

我经常使用 kraken.io，但希望将其更多地用于工作流程。

我对无损压缩了解很多，但我对他们如何做有损感到茫然。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:18:34.357

PNG在设计上是**无损**的，没有有损PNG。您所能做的就是在将其保存为 PNG 之前进行一些**有损的预处理，例如将真彩色图像转换为****调色板**，或者通过**分色**减少颜色数量- 所有这些都可能会减小图像的大小，但这不是一部分的PNG。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-19T18:50:59.890

如果你真的想要一个库，那么[libimagequant](http://pngquant.org/lib)（我认为这就是 kraken.io 使用的）。

还有通过预处理实现有损压缩的中[值后分镜。](https://github.com/pornel/mediancut-posterizer)它比 Photoshop 或 ImageMagick 中的分色更有效。

[ImageAlpha 网站上对有损 PNG 方法的描述](http://pngmini.com/lossypng.html)。

# jquery-mobile - jQuery Mobile：数字输入和内联加/减按钮

> ID：15588358
> 
> 赞同：2
> 
> 时间：2013-03-23T15:11:37.963
> 
> 标签：jquery-mobile

有没有可能用左边的减号按钮和右边的加号按钮输入数字？或者也许还有 -- ++ 以更大的步骤改变价值。

我知道我不是第一个提出这个问题的人，但是： [这个](http://dev.jtsage.com/jQM-Spinbox/)解决方案在第一回合没有正确显示，并且来自 Github 的 jQuery-Mobile-Stepper-Widget（不能发布另一个链接，因为我是新手）不起作用使用当前版本的 jQuery Mobile。

结果应该看起来像这个问题中的屏幕截图：[有没有人实现 jQuery Mobile Add (+/-) Button Number Incrementers？](https://stackoverflow.com/questions/10167232/has-anyone-implemented-jquery-mobile-add-button-number-incrementers)分别在 jQuery Mobile 中的水平分组按钮

任何想法或新片段，使用当前版本的 jQuery 移动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T23:11:03.037

这里是一个提示，剩下的就是纯粹的*CSS*工作和额外的*JS*代码来控制值，例如最大值、最小值……等等。

**HTML**

```
 <div data-role="controlgroup" data-type="horizontal" data-mini="true">
   <button id="plus" data-inline="true">+</button>
   <input type="text" id="number" value="0" disabled="disabled" />
   <button id="minus" data-inline="true">-</button>
 </div> 
```

**代码**

```
$('#plus').unbind('click').bind('click', function () {
    var value = $('#number').val();
    value++;
    $('#number').val(value);
});

$('#minus').unbind('click').bind('click', function () {
    var value = $('#number').val();
    value--;
    $('#number').val(value);
}); 
```

[JSFiddle](http://jsfiddle.net/Palestinian/zAWpZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:45:00.280

在 jQM 中，**输入类型号**可以发挥您想要的大部分魔力

```
<input type="number" name="number" value="0"/> 
```

如果您需要更多花哨的样式，则必须遵循 Omar 的代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-10T10:54:45.947

```
<i onclick="qty('plus');" class="fa fa-plus c_pointer"></i>
<input type="text" id="prdqty" name="qty" value="1" placeholder="1">
<i onclick="qty('minus');" class="fa fa-minus c_pointer"></i>
function qty(val){
pqty = $('#prdqty').val();
if (val == "plus") {
  var newVal = parseFloat(pqty) + 1;
} else {
if (pqty > 1) {
  var newVal = parseFloat(pqty) - 1;
} else {
  newVal = 1;
}
}
$('#prdqty').val(newVal);
} 
```

# javascript - json点击点

> ID：15588362
> 
> 赞同：0
> 
> 时间：2013-03-23T15:11:55.923
> 
> 标签：javascript, json

我想制作一个按钮，单击该按钮将显示用户用鼠标在图像上单击的点的 xy 坐标。到目前为止，我已经这样做了，但它不起作用：

```
<script>
var data_str = '{ "source": {' + 
           '"name":' +
           '[' + 
          '[' + pts_0[0][0]  +  ','  +  pts_0[0][1] + '],' +
          '[' + pts_0[1][0]  +  ','  +  pts_0[1][1] + '],' +
          '[' + pts_0[2][0]  +  ','  +  pts_0[2][1] + ']' +
           '],'
            '} }' ;               

</script>
<pre id='mydata'>
</pre>
<script>
document.getElementById('display-button').onclick = function (){
var data_el = document.getElementByID('mydata');
data_el.innerHTML = data_str;
}
</script> 
```

单击按钮时，它应该显示如下内容：

```
{
  "source": {
  "name": "myface.png",
  "points": [ ["10","23"], ["7","100"], ["77","11"] ]
 }, 
```

# php - 了解正则表达式/preg_replace

> ID：15588364
> 
> 赞同：1
> 
> 时间：2013-03-23T15:12:11.843
> 
> 标签：php, regex

我正在使用一些正则表达式（有效），但实际上并不了解它在做什么。作为一名科学家，我喜欢跟随我所做的一切！

代码来自这个 SO 答案：[https ://stackoverflow.com/a/118886/889604](https://stackoverflow.com/a/118886/889604)

```
$mtime = filemtime($_SERVER['DOCUMENT_ROOT'] . $file);
return preg_replace('{\\.([^./]+)$}', ".$mtime.\$1", $file); 
```

此代码采用文件名（例如`/files/style.css`），并添加文件的`mtime`（例如`/files/styles.1256788634.css`）。

所以，我明白了`^`，`$`符号是要匹配的字符串的开头和结尾，并且可以`./`多次匹配任何字符（因为`+`），但是`mtime`文件名和扩展名之间的结果如何呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:43:26.100

The `{` and `}` are used as delimiters and do not take part of the search pattern. `\\.`is describing a dot. The dot has to be escaped (thus the backslashes) because a un-escaped dot would describe the presence of any single character. The round brackets `( ... )` define a group that can be accessed via `$1` in the second `preg_replace` parameter. The content of this group consists of `[^./]+`, which means

> a positive quantity of (defined via the `+` after the set) any single character that is not (`^` in the beginning of a set means `not`) a dot `.` or a slash `/`.

The round brackets are followed by a `$` which describes the end of the line.

The expression will match the file extension of the path, like `.css`, while `css` will be the value of the group `$1`. Therefore, `.css` will be replaced with `.$mtime.css` where `$mtime` will be the value of the php variable.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:39:57.813

由于`mtime`PHP 的字符串插值规则，最终出现在输出中，这导致在双引号字符串中引用的变量输出变量的值而不是变量名称的文字文本。有关更多信息，请参见[http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)（本节最后一句）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:40:17.020

正则表达式模式所做的只是替换整个文件扩展名并使用括号将`.css`不带句点的扩展名存储到捕获中。然后它用一个句点、 的值、另一个句点以及从 regex 中捕获的扩展替换来自 的扩展。`css``([^./]+)``.css``$file``$mtime``$1`

并注意：`^`并不意味着字符串的开头。当它在一个组中时，就像`[^./]`它说“匹配除了这些字符之外的任何字符”

我希望这一切都是有道理的。

编辑：它只匹配 $file 的 .css 部分，因为`\\.`它告诉正则表达式从 $file 中找到的第一个句点开始，然后继续进行捕获。它必须用 the 转义，`\\.`否则它会像匹配任何字符的正则表达式句点一样。

# javascript - HTML5 点击同时发送到两个按钮

> ID：15588365
> 
> 赞同：2
> 
> 时间：2013-03-23T15:12:15.470
> 
> 标签：javascript, html, css, css-transitions

这与我之前关于在按钮单击时移动简笔画有关的问题有关。
新问题是同时向两个按钮发送点击。

左右按钮一切正常。上下都搞砸了。

### HTML

```
<!DOCTYPE html>
<html>

<style>
    #stage{
        width: 100px;
        height: 100px;
        position: relative;
        border-style: dashed;
        border-color: gray;
        border-width: medium;
    }

    #actor{
        width: 13px;
        height: 15px;
        position: absolute;
        left: 0;
        top: 0;
        background-image: url("E:/Website Projects/man.PNG");

        -webkit-transition: all 2s ease-out 0s;
        -moz-transition: all 2s ease-out 0s;
        transition: all 2s ease-out 0s;
    }

</style>

<body>
    <div id="stage">
        <div id="actor"></div>
    </div>

    <div>
        <button class="control" id="top">TOP</button> <br>
        <button class="control" id="left">LEFT</button> <button class="control" id="right">RIGHT</button> <br>
        <button class="control" id="down">DOWN</button>
    </div>
</body>

<script>
    var vertical = 0;
    var horizontal = 0;
    var shift = 5;

    var top = document.querySelector("#top");
    var left = document.querySelector("#left");
    var right = document.querySelector("#right");
    var down = document.querySelector("#down");

    top.addEventListener("click",moveTop,false);
    left.addEventListener("click",moveLeft,false);
    right.addEventListener("click",moveRight,false);
    down.addEventListener("click",moveDown,false);

    function moveTop(){
        var actor = document.querySelector("#actor");
        if(vertical>0){
            --vertical;
            actor.style.top = shift*vertical + "px";
            console.log("TOP " + "VERTICAL: " + vertical);
        }
    }

    function moveDown(){
        var actor = document.querySelector("#actor");
        if(vertical<17){
            ++vertical;
            actor.style.top = shift*vertical + "px";
            console.log("DOWN " + "VERTICAL: " + vertical);
        }
    }

    function moveRight(){
        var actor = document.querySelector("#actor");
        if(horizontal<17){
            ++horizontal;
            actor.style.left = shift*horizontal + "px";
            console.log("RIGHT " + "HORIZONTAL: " + horizontal);
        }
    }

    function moveLeft(){
        var actor = document.querySelector("#actor");
        if(horizontal>0){
            --horizontal;
            actor.style.left = shift*horizontal + "px";
            console.log("LEFT " + "HORIZONTAL: " + horizontal);
        }
    }

</script>

</html> 
```

### 控制台日志

```
DOWN VERTICAL: 1 floating%20man.html:71
TOP VERTICAL: 0 floating%20man.html:62 
```

那就是点击的日志`down`。`Top`行不通，因为这就是它的编码方式。`Top`仅当`vertical`具有非零值时才有效。

**为什么会这样？如何解决？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:44:39.807

The identifier `top` is already taken in web browsers, and refers to the topmost window on a frameset (or the current window, if there are no frames). On Chrome at least, you can't overwrite it. You'll have to choose a new variable name for your button reference.

Working version: [http://jsbin.com/uzanom/1/edit](http://jsbin.com/uzanom/1/edit)

# ruby-on-rails-3 - capybara 2.0.2 访问不起作用

> ID：15588366
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:12:27.833
> 
> 标签：ruby-on-rails-3, capybara

我有一个 Rspec，它具有以下内容：

```
visit '/static_pages/home' 
```

它在 Capybara 1.1.2 下运行良好，现在当我切换到 Capybara 2.0.2 时，访问时出现 NoMethod 异常。

出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:33:16.933

你用的是什么测试框架？您是否按照自述文件中的说明包含了 Capybara::DSL？

# javascript - 显示元素时表格左对齐

> ID：15588367
> 
> 赞同：0
> 
> 时间：2013-03-23T15:12:30.783
> 
> 标签：javascript, html, alignment

我有这个 HTML 代码：

```
<html>
    <head>
        <script type="text/javascript">
            function showStuff(id) {
                var e = document.getElementById(id);
                if (e.style.display == 'block') e.style.display = 'none';
                else e.style.display = 'block';
            }
        </script>
    </head>
    <body>
        <FORM name=myForm>
            <TABLE border=0 align=center>
                <TBODY>
                    <TR>
                        <TD align=right>Quiz/Test Title:</TD>
                        <TD align=left>
                            <INPUT size=25 type=text name=t>
                        </TD>
                    </TR>
                    <TR>
                        <TD align=right>
                            <input type="button" value="Show/Hide" onclick="showStuff('multiplechoice')">
                        </TD>
                    </TR>
                </TBODY>
                <TBODY id="multiplechoice" style="display: none;" align=center>
                    <TR>
                        <TD align=right>
                            <h3>Multiple Choice</h3>
                        </TD>
                        </TD>
                        <TR>
                            <TD align=right>Section Name:</TD>
                            <TD align=left>
                                <INPUT size=20 type=text name=section1>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Directions:</TD>
                            <TD align=left>
                                <INPUT size=71 type=text name=directions1>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Question Number:</TD>
                            <TD align=left>
                                <INPUT size=2 type=text name=n1 id=n1 value=1 onkeypress="return alpha(event,numbers)">
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Question:</TD>
                            <TD align=left>
                                <textarea rows=2 cols=55 name=q1 id=q1></textarea>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Answer A:</TD>
                            <TD align=left>
                                <INPUT size=35 type=text name=a1>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Answer B:</TD>
                            <TD align=left>
                                <INPUT size=35 type=text name=b1>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Answer C:</TD>
                            <TD align=left>
                                <INPUT size=35 type=text name=c1>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Answer D:</TD>
                            <TD align=left>
                                <INPUT size=35 type=text name=d1>
                            </TD>
                        </TR>
                        <TR>
                            <TD align=right>Answer (A,B,C,D):</TD>
                            <TD align=left>
                                <INPUT size=1 type=text name=correct1 onkeyup="upper(this)" onkeypress="return alpha(event,letters)" maxlength="1">
                            </TD>
                        </TR>
                </TBODY>
            </TABLE>
        </FORM>
    </body>
</html> 
```

好的，问题是当我单击显示/隐藏时，它会显示表单，但会将表单中的所有内容移到左侧。我希望它保持在中心对齐。有没有办法做到这一点？我省略了与其他所有功能相关联的所有其他功能，所以不用担心它会起作用。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:32:16.103

你为什么不把你的两个`TBody`s 放在单独的表中？

如下所示：

```
<FORM name=myForm>
<TABLE border=0 align=center>
    <TBODY>
         <TR>
             <TD align=right>Quiz/Test Title:</TD>
             <TD align=left>
                <INPUT size=25 type=text name=t>
            </TD>
        </TR>
        <TR>
             <TD align=right><input type="button" value="Show/Hide" onclick="showStuff('multiplechoice')">
             </TD>
        </TR>
     </TBODY>
</table>
<table border=0 align=center>
     <TBODY id="multiplechoice" style="display: none;" align=center>
         <TR>
            <TD align=right><h3>Multiple Choice</h3></TD>
             </TR>
         <TR>
            <TD align=right>Section Name:</TD>
            <TD align=left><INPUT size=20 type=text name=section1></TD>
             </TR>
         <TR>
            <TD align=right>Directions:</TD>
            <TD align=left><INPUT size=71 type=text name=directions1></TD>
             </TR>
         <TR>
            <TD align=right>Question Number:</TD>  
            <TD align=left><INPUT size=2 type=text name=n1 id=n1 value=1 onkeypress="return alpha(event,numbers)"></TD>
             </TR>   
         <TR>
            <TD align=right>Question:</TD>
            <TD align=left><textarea rows=2 cols=55 name=q1 id=q1></textarea></TD> 
             </TR>
         <TR>
            <TD align=right>Answer A:</TD>
            <TD align=left><INPUT size=35 type=text name=a1></TD></TR>
         <TR>
            <TD align=right>Answer B:</TD>
            <TD align=left><INPUT size=35 type=text name=b1></TD>
             </TR>
         <TR>
            <TD align=right>Answer C:</TD>
            <TD align=left><INPUT size=35 type=text name=c1></TD>
             </TR>
         <TR>
            <TD align=right>Answer D:</TD>
            <TD align=left><INPUT size=35 type=text name=d1></TD>
             </TR>
         <TR>
            <TD align=right>Answer (A,B,C,D):</TD>
            <TD align=left><INPUT size=1 type=text name=correct1 onkeyup="upper(this)" onkeypress="return alpha(event,letters)"   maxlength="1"></TD>
             </TR>
     </TBODY>
</TABLE>
</FORM> 
```

它解决了一切。看到这个[工作代码笔](http://codepen.io/manishmishra256/pen/mAGFw)

# c++ - C++ 辅助函数

> ID：15588370
> 
> 赞同：1
> 
> 时间：2013-03-23T15:12:44.927
> 
> 标签：c++

我有很多这样的代码：

```
otherString1 = myString1.replace("a", "b").replace("c", "d").replace("e", "f");
otherString2 = myString2.replace("a", "b").replace("c", "d").replace("e", "f");
otherString3 = myString3.replace("a", "b").replace("c", "d").replace("e", "f"); 
```

我不想`replace`一次又一次地重复这些方法。重构此类代码的正确方法是什么？我是 C++ 新手...

我以为我可以这样做：

```
#define REPLACE .replace("a", "b").replace("c", "d").replace("e", "f")
otherString1 = myString1#REPLACE; 
```

但这不起作用。

我显然不能猴子修补字符串类来添加`myReplace()`......

该怎么办？我应该将替换代码放入头文件还是源文件？那些`static`, `inline`,`const`东西呢？我应该创建一个完整的辅助类和一个辅助方法，还是应该只在某个地方创建一个函数？怎么样的东西：

```
[helper.hpp]
static inline const myReplace(const StringClass s);

[helper.cpp]
static inline const myReplace(const StringClass s) {
    return s.replace("a", "b").replace("c", "d").replace("e", "f");
}

[somefile.cpp]
include "helper.hpp"
otherString3 = myReplace(myString3); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T15:15:26.073

IMO，你想多了。只需创建一个接受字符串（通过`const`引用）并返回修改后的字符串的函数。在头文件中声明并在相应的`.cpp`文件中定义。

任务完成。

```
[helper.hpp]
std::string myReplace(const std::string& s);

[helper.cpp]
std::string myReplace(const std::string& s) {
   ...
}

[somefile.cpp]
#include "helper.hpp"
otherString3 = myReplace(myString3); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:24:06.207

我只想指出您的宏会起作用，只是您使用不正确。但是，这*不是解决这个问题的正确方法*，只是想指出这一点。这是正确的用法：

```
#define REPLACE .replace("a", "b").replace("c", "d").replace("e", "f")
otherString1 = myString1 REPLACE; 
```

或者可能更好（如果使用宏可以更好）：

```
#define REPLACE(str) str.replace("a", "b").replace("c", "d").replace("e", "f")
otherString1 = REPLACE(myString1); 
```

请记住，*不要这样做*，但这是可以使用宏的方式。

# sql - 协助简单的 JOIN

> ID：15588375
> 
> 赞同：-3
> 
> 时间：2013-03-23T15:13:06.330
> 
> 标签：sql, sql-server, join

我在从作为主键的员工表（empID）和基于两个外键 1-收货人和 2-移交人的委托表中选择员工姓名时遇到问题（这两个字段与 empID 有关系）是这样吗可以不通过 ID 而是根据员工姓名（emp.name）来选择收货人和移交。请写下查询，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:15:49.760

基本上，`INNER JOIN`如果表中的两列`consignation`都不可为空，则可以使用。但是如果一个是*可空*的，你需要使用`LEFT JOIN`这样的记录`consignation`仍然会显示在列表中。

```
SELECT  con.EmpName AS consigneeName,
        ho.EmpName AS handOverName
FROM    consignation a
        INNER JOIN employee con
            ON a.ConSignee = con.empID
        INNER JOIN employee ho
            ON a.handoverby = ho.empID 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

# jquery - 拆分一个字符串并附加到另一个没有逗号char jquery

> ID：15588376
> 
> 赞同：0
> 
> 时间：2013-03-23T15:13:09.203
> 
> 标签：jquery, html

我拆分了一个字符串，然后我想将另一个附加到它，但它会自动在拆分字符串和附加的字符串之间添加一个逗号字符，下面是一个示例：

```
var mystring="mypath/myfile0.png"
var myotherstring=mystring.split(".png")+"1.png" 
```

结果是：myotherstring=mypath/ **myfile0,1.png**请注意逗号。在没有这个逗号字符的情况下拆分另一个字符串后如何附加一个字符串？为什么要添加逗号字符？

埃德森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:16:12.193

`.join()`它：

```
var myotherstring=mystring.split(".png").join("1.png"); 
```

这输出`mypath/myfile01.png`

### [以上的演示](http://jsfiddle.net/Cyv5m/)

如果你想摆脱`0`然后使用这个：

```
var myotherstring=mystring.split("0.png").join("1.png"); 
```

这输出`mypath/myfile1.png`

### [以上的演示](http://jsfiddle.net/Cyv5m/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:15:52.310

替换您的以下行：

```
var myotherstring=mystring.split(".png")+"1.png" 
```

对于这个：

```
var myotherstring=mystring.split(".png")[0]+"1.png" 
```

当您连接到返回的整个数组时，`.split()`而不是仅附加到您想要的数组中的第一个元素。

看[**演示**](http://tinker.io/32cb0)

# hadoop - 如何将 Hadoop 文件系统与 OpenCL/GPU 代码相结合

> ID：15588381
> 
> 赞同：0
> 
> 时间：2013-03-23T15:13:31.020
> 
> 标签：hadoop, mapreduce, opencl, gpgpu, gpu

[参考我之前的问题](https://stackoverflow.com/questions/15495698/how-to-use-hadoop-mapreuce-framework-for-an-opencl-application)

我的疑问是如何用其他语言配置 HDFS。无法找到合适的教程将 HDFS 与 opencl/cuda 代码结合起来。我在 opencl 中为 Map 和 Reduce 编写了自己的代码。Map 和 Reduce 函数都是 GPU 的内核函数。现在我想在多个节点上使用 HDFS 来实现我的代码。

任何人都请告诉我在 HADOOP 框架下实现 GPU/OpenCL 代码的教程。先感谢您。

注意：我不想使用 APARAPI/JavaCL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-18T09:25:53.470

HDFS是一个文件系统；您可以使用任何语言的 HDFS 文件系统。

HDFS 数据分布在多台机器上，在 GPU 计算中处理数据具有很高的可用性。

有关更多信息，请参阅[Hadoop 流式处理](http://hadoop.apache.org/docs/stable/streaming.html)

# java - 生成 null（从文件中读取一个单词）

> ID：15588383
> 
> 赞同：0
> 
> 时间：2013-03-23T15:13:36.800
> 
> 标签：java, file, null

我正在尝试从文件中读取一个单词并将其显示在控制台中。尽管文件包含文本，但结果始终为`null`. 代码中的错误可能是什么？

这是代码：

```
public class ParsingStrings{

private Scanner sc;
private static String input;

public void openFile(){
try{
    sc = new Scanner(new File ("E:\\Dropbox\\File.txt"));
    input = sc.next();
}catch(FileNotFoundException e){
    e.printStackTrace();
    }
}

public static void main(String[] args) {

    System.out.println(input);

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:17:41.570

您实际上并没有调用打开文件并读取输入的方法。因此，在您的主要方法中，您缺少以下内容：

```
public static void main(String[] args) {
    ParsingStrings ps = new ParsingStrings();
    ps.openFile();

    System.out.println(input);

    } 
```

同样在您`openFile()`的文件中，您应该检查您的文件是否有下一个要读取的输入。

```
if(sc.hasNext())
{
    input = sc.next();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T15:16:01.597

在将输入打印到控制台之前，您应该调用 openFile - 方法。

# php - 用 Doctrine 2 中的所有相关实体填充部分集合

> ID：15588385
> 
> 赞同：1
> 
> 时间：2013-03-23T15:13:57.333
> 
> 标签：php, doctrine-orm, doctrine

假设我有以下查询，它返回一个带有已标记的关联 Post 实体的 User 实体（这仅用于演示）：

```
SELECT u, p
FROM User u
LEFT JOIN u.posts p
WHERE p.isFlagged = true 
```

一旦我使用了它，我就想访问该用户的所有帖子，无论 isFlagged 是什么。是否有一种简单的方法来刷新`$user->posts`集合，使其成为所有用户帖子的完整集合？

我不想只提取查询中的所有帖子（因为它们*可能*不需要），并且需要完整集合的代码不会知道该实体来自的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T16:43:35.383

你在这里做的事情被打破了：

```
SELECT
    u, p
FROM
    User u
JOIN
    u.posts p
    WITH
    p.isFlagged = true 
```

这将使用错误的值对“User#posts”集合进行水合，从而导致逻辑损坏、对象图损坏、一切都损坏。

您应该在 DQL 级别使用以下方法解决此问题：

```
SELECT
    u, p
FROM
    User u
JOIN
    u.posts p
JOIN
    u.posts j
    WITH
    j.isFlagged = true 
```

这将基本上水合用户对象中正确的帖子集合，而没有任何中间（损坏）状态。

***编辑***：我误解了这个问题，因为我的想法是基于@Athlan 的回答，这从根本上是错误的（刷新损坏的集合真的是错误的）。这是我之前的答案，我仍然认为它很有趣，因为它解决了问题，但不是以真正正确的方式。

这个问题实际上让我很好奇 ORM 是否像我预期的那样刷新了集合。

我[在这个分支中编写了测试](https://github.com/Ocramius/doctrine2/compare/test;collection-refresh)。

基本上，您需要做的只是：

```
$entityManager->refresh($entity); 
```

这是测试的相关部分：

```
$foo = new DDC2666Foo();

$this->_em->persist($foo);
$this->_em->flush();
$this->_em->clear();

$fetchedFoo = $this->_em->find(__NAMESPACE__ . '\DDC2666Foo', $foo->id);

$fetchedFoo->bars->add(new DDC2666Bar());

$this->assertCount(1, $fetchedFoo->bars);
$this->_em->refresh($fetchedFoo);

$this->assertCount(0, $fetchedFoo->bars, 'The collection was reset'); 
```

唯一的缺点是这也会重新获取您的实体，但 ORM 本身不提供刷新单个集合的外观。

无论如何，这也是一件好事，因为这样，您不会破坏封装，这可能会导致代码中出现意外（且难以调试）行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-25T20:26:31.440

我遇到了同样的问题，最终来到了这里。刷新对我来说不是一个选项，因为我有一个列表并且我不想进行这些额外的查询。

您在这里真正需要的是添加一个“假”连接来进行过滤，并让原始连接没有条件......以明确这一点：

```
SELECT u, p
FROM User u
LEFT JOIN u.posts p
LEFT JOIN u.posts p2
WHERE p2.isFlagged = true 
```

请注意，我将 p2 从 select 子句中排除，这只是为了过滤目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-04T13:05:42.380

我发现其他解决方案非常不令人满意，因为许多实体会得到我根本不感兴趣的水分。如果绝大多数帖子都有，`isFlagged = 0`那么性能影响是巨大的。

这是一个替代解决方案，涉及交换实体之间的关系。但是，它**并不完全等同**于原始问题的要求。然而，它可能对遇到此问题的其他人有用：

```
SELECT p, u
FROM Post p
JOIN p.user u
WHERE p.isFlagged = true 
```

此解决方案与其他解决方案之间的区别在于，它将不再返回没有任何帖子或任何已标记帖子的用户。这可能是也可能不是您想要的。

# php - 将图像移动到底部

> ID：15588386
> 
> 赞同：10
> 
> 时间：2013-03-23T15:14:01.247
> 
> 标签：php, image, gd, move, pixels

我正在使用 PHP GD 制作头像。化身的脚和图像底部之间有令人讨厌的空间。我想通过将头像“推”到底部来摆脱那个空间（见下文）。

这是我不喜欢的原始图像，以及我想要获得的图像：

![](../Images/b0ad3b76fc20fd972a29546626a23d6b.png) ![在此处输入图像描述](../Images/d6d84711c1b086d4b3091efd485d8bb1.png)

有办法吗？谢谢。下面是用于图像生成的代码的主要部分。

```
$assets = array(
    "../assets/shirt/Default.png",
    "../assets/body/Default.png",
    "../assets/hair/Default.png",
    "../assets/eyes/Default.png",
    "../assets/eyebrows/Default.png",
    "../assets/mouth/Default.png",
    "../assets/pants/Default.png"
);

$baseImage = imagecreatefrompng($assets[0]);
imagealphablending($baseImage, true);
imagesavealpha($baseImage, true);

foreach($assets as $item) {
    $newImage = imagecreatefrompng($item);
    imagecopy($baseImage, $newImage, 0, 0, 0, 0, 350, 550);

    imagealphablending($baseImage, true);
    imagesavealpha($baseImage, true);
}

if($_GET['x']) {

    $sizex = $_GET['x']; if($sizex > 350) $sizex = 350;
    $sizey = $_GET['y']; if($sizey > 550) $sizey = 550;

    $png = imagecreatetruecolor($sizex, $sizey);
    imagesavealpha($png, true);

    $trans_colour = imagecolorallocatealpha($png, 0, 0, 0, 127);
    imagefill($png, 0, 0, $trans_colour);

    $blankImage = $png;
    imagealphablending($blankImage, true);
    imagesavealpha($blankImage, true);

    imagecopyresampled($blankImage, $baseImage, 0, 0, 0, 0, $sizex, $sizey, 350, 550);

    header("Content-type: image/png");
    imagepng($blankImage);
}
else {
    header("Content-type: image/png");
    imagepng($baseImage);
} 
```

注意：该`if($_GET['x']) {`代码的一部分是允许我在现场生成不同大小的头像。它工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T11:48:18.223

这是裁剪底部并将裁剪后的图像移动到底部的代码。

```
<?php
example();
function example(){
    $img = imagecreatefrompng('http://i.stack.imgur.com/UUiMK.png');
    imagealphablending($img, true);
    imagesavealpha($img, true);

    // copy cropped portion
    $img2 = imageCropBottom($img);

    // output cropped image to the browser
    header('Content-Type: image/png');
    imagepng($img2);

    imagedestroy($img2);
}

function imageCropBottom($image) {
    $background1 = imagecolorat($image, 0, 0);
    $background2 = imagecolorat($image, 1, 1);

    $imageWidth = imageSX($image);
    $imageHeight = imageSY($image);
    $bottom = 0;

    for ($y = $imageHeight ; $y > 0 ; $y--) {
        for ($x = 0 ; $x < imagesx($image) ; $x++) {

            $imageColor = imagecolorat($image, $x, $y);
            if (($imageColor != $background1) && ($imageColor != $background2)) {
                $bottom = $y;
                break;
            }
        }
        if ($bottom > 0) break;
    }

    $bottom++;

    // create new image with padding
    $img = imagecreatetruecolor($imageWidth, $imageHeight);
    imagealphablending($img, true);
    imagesavealpha($img, true);

    $trans_colour = imagecolorallocatealpha($img, 0, 0, 0, 127);
    imagefill($img, 0, 0, $trans_colour);

    // copy
    imagecopy($img, $image, 1, $imageHeight-$bottom, 1, 1, $imageWidth-2, $bottom-1);

    // Draw a black rectangle
    $black = imagecolorallocate($img, 0, 0, 0);
    imagerectangle($img, 0, 0, $imageWidth-1, $imageHeight-1, $black);

    // destroy old image cursor
    imagedestroy($image);
    return $img;
} 
```

参考：

*   [在 PHP 中从图像中裁剪空白](https://stackoverflow.com/questions/1669683/crop-whitespace-from-image-in-php)
*   [http://www.php.net/manual/en/function.imagecopy.php#97836](http://www.php.net/manual/en/function.imagecopy.php#97836)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-30T03:55:51.070

我认为解决方案是以自下而上的方式构建头像。即鞋子->裤子->衬衫->脸->头发

（伪代码）

```
position = (x,y) // where y is the height of the canvas initially
if(need(shoe)){
  position = position - shoe.height
  add shoe at position
}
if(need(pant)) {
  position = position - pant.height
  add pant at position
}
... and so on 
```

如果您查看 imagecopy 方法，它具有以下方法签名

```
bool imagecopy ( resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h ) 
```

通过改变`$dst_x`，`$dst_y`你可以实现我所描述的。

# jquery - Django 1.5 CSRF Ajax

> ID：15588388
> 
> 赞同：4
> 
> 时间：2013-03-23T15:14:17.430
> 
> 标签：jquery, python, ajax, django

我正在尝试创建一个 Web 应用程序，该应用程序在单击某些按钮时进行 Ajax 调用，更新我的模型中的数据并显示更新的数据。这是我的模板：

```
<html>
    <head>
        <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="{{ STATIC_URL }}/workout1.js"></script>
    </head>
<body>

    <span id="squats">Squats:  {{ user.weekOne.squats }} done.<br/></span>
    <span id="lunges">Lunges: {{ user.weekOne.lunges }} done.<br /></span>
    <span id="stairDays">Stair Days: {{ user.weekOne.stairDaysCount }}<br/></span>
    <span id="skipStairs">Skip Stairs: {{ user.weekOne.skipStairs }}<br /></span>
        <form>
            {% csrf_token %}
            <input type="text" name="squats" id="squatsVal" value="Squats" />
            <input type="submit" id="submitSquats" value="Add Squats"/><br />
        </form>

        <form>
            <input type="text" name="lunges" value="Lunges" />
            <input type="submit" value="Add Lunges" /><br />
        </form>

        <form>
            <input type="submit" value="Stairs skipped."><br />
        </form>
</body>
</html> 
```

我使用 Django[建议的代码](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/)来处理 Ajax 和 CSRF。这是我生成的 jQuery：

$(文档).ready(函数() {

```
// Boilerplate for handling CSRF, from Django's website

function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
};

var csrftoken = getCookie('csrftoken');

$.ajaxSetup({
    crossDomain: false, // obviates need for sameOrigin test
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type)) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});
// the actual Ajax
$("#submitSquats").click(function() {
    var exercise = "squats";
    var amount = $('#squats').val();
    var data = {'exercise': exercise, 'amount': amount};
    $.ajax({
        type:"POST",
        url:"submitWorkout1",
        data: data,
        success: function() {
            $('#squats').html('<span>Success</span>');
        }
    });
    return false;
}); 
```

});

最后，这里是处理传入的 Ajax 请求并返回 Ajax 的响应的视图：

```
def submitWorkout1(request):
    exercise = request.POST['exercise']
    amount = request.POST['amount']
    user = UserProfile.objects.get(user=request.user)
    exercise, amount = user.WeekOne.updateExercise(exercise, amount)
    return HttpResponse(simplejson.dumps({'result': 'success', exercise: amount})) 
```

不幸的是，当我尝试单击 Submit Squats 按钮并运行 jQuery 时，我收到一条`CSRF Token Missing or Incorrect`错误消息。此外，如果我在视图顶部使用 @csrf_exempt 标识符进行测试，则会收到以下错误：

```
"Key 'exercise' not found in <QueryDict: {u'undefined': [u'', u'']}>" 
```

因此，即使我要修复 CSRF 问题，我的 Ajax 代码似乎还有其他问题。但我想解决这两个问题。帮助！

更新的代码（见下面凯瑟琳的帖子）：

HTML：

```
<body>

    <span id="squats">Squats:  {{ user.weekOne.squats }} done.<br/></span>
    <span id="lunges">Lunges: {{ user.weekOne.lunges }} done.<br /></span>
    <span id="stairDays">Stair Days: {{ user.weekOne.stairDaysCount }}<br/></span>
    <span id="skipStairs">Skip Stairs: {{ user.weekOne.skipStairs }}<br /></span>
        <form method="POST" action="{% url workout_game_app.views.submitWorkout1 %}"> 
            {% csrf_token %}
            <input type="text" name="squats" id="squatsVal" value="Squats" />
            <input type="submit" id="submitSquats" value="Add Squats"/><br />
        </form>
</body> 
```

jQuery：

```
$(document).ready(function() {
    $("#submitSquats").click(function() {
        var exercise = "squats";
        var amount = $('#squats').val();
        $.ajax({
            type:"POST",
            url:"/workout_game_app/workouts/submitWorkout1/",
            data: {'exercise': exercise,
                    'amount:': amount,
                    'csrfmiddlewaretoken': '{{csrf_token}}'},
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function() {
                $('#squats').html('<span>Success</span>');
            }
        });
        return false;
    });
}); 
```

看法：

```
def submitWorkout1(request):
    if request.method == 'POST':

        exercise = request.POST['exercise']
        amount = request.POST['amount']
        user = UserProfile.objects.get(user=request.user)
        exercise, amount = user.WeekOne.updateExercise(exercise, amount)
        data = simplejson.dumps({
            'result': 'success',
            'exercise': exercise,
            'amount': amount
            }, indent=4)
        return HttpResponse(data, mimetype="application/javascript") 
```

网址：

```
urlpatterns = patterns('',
        url(r'^$', 'workout_game_app.views.index'),
        url(r'^signup$/', 'workout_game_app.views.signup'),
        url(r'^login$/', 'workout_game_app.views.login_view'),
        url(r'^logout/$', 'workout_game_app.views.logout_view'),
        url(r'^workouts/workout1/$', 'workout_game_app.views.workout1'),
        url(r'^workouts/submitWorkout1/$',
            'workout_game_app.views.submitWorkout1'), 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T15:39:00.560

如果我是你，我会在“// Boilerplate for handling CSRF, from Django's website”评论下删除那个AJAX，并用这个替换“实际的ajax”：

```
// the actual Ajax
$("#submitSquats").click(function() {
    var form = $(this).parent();
    $.post(
        "submitWorkout1", //url
        form.serialize(), //data
        function() {      //success method
            $('#squats').html('<span>Success</span>');
        }
    );
    return false;
}); 
```

如果您收到 403 错误，那一定是因为您没有发送 csrf 令牌...这很容易通过`form.serialize()`以及所有表单数据...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T15:29:55.423

删除用于 csrf_token 实施的脚本。只需在您的 ajax 函数中添加 csrf_token 即可。

**脚本**

```
$(document).ready(function() {
    $("#submitSquats").click(function() {
        var exercise = "squats";
        var amount = $('#squatsVal').val();

        $.ajax({
            type:"POST",
            url:"/workout_game_app/workouts/submitWorkout1/",
            data: { 
                'exercise': exercise, 
                'amount': amount,
                'csrfmiddlewaretoken': '{{csrf_token}}'
            },
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function(data) {
                $('#squats').html('<span>Success</span>');
                alert(data); //for testing
            },
            error: function(ts) { 
                alert(ts.responseText);
            }
        });
        return false;
    });
}); 
```

在你的views.py中

```
def submitWorkout1(request):
    if request.method == 'POST':
        exercise = request.POST['exercise']
        amount = request.POST['amount']
        user = UserProfile.objects.get(user=request.user)
        exercise, amount = user.WeekOne.updateExercise(exercise, amount) 
        data = simplejson.dumps({
             'result': 'success', 
             'exercise': exercise,
             'amount': amount 
           }, indent=4)
        return HttpResponse(data, mimetype="application/javascript") 
```

**网址.py**

别忘了放在`/`前面`$`

```
urlpatterns = patterns('',
    url(r'^$', 'workout_game_app.views.index'),
    url(r'^signup/$', 'workout_game_app.views.signup'),
    url(r'^login/$', 'workout_game_app.views.login_view'),
    url(r'^logout/$', 'workout_game_app.views.logout_view'),
    url(r'^workouts/workout1/$', 'workout_game_app.views.workout1'),
    url(r'^workouts/submitWorkout1/$',
        'workout_game_app.views.submitWorkout1'), 
```

**模板**

```
<form method="POST" action="{% url workout_game_app.views.submitWorkout1 %}"> 
    {% csrf_token %}
    <input type="text" name="squats" id="squatsVal" value="Squats" />
    <input type="submit" id="submitSquats" value="Add Squats"/><br />
</form> 
```

# java - 线程主线程中的 Java 异常 - ClassNotFoundException

> ID：15588398
> 
> 赞同：1
> 
> 时间：2013-03-23T15:16:00.873
> 
> 标签：java, eclipse, main, classnotfoundexception

我正在使用 Eclipse 中的另一个系统库。有一次，图书馆不知何故被删除，日食显示一个红色的“！” 项目文件夹图标旁边。我重新导入了库，但仍然有红色的“！”。一旦我尝试编译并运行一个程序，它就会给我一个“ClassNotFoundException”。

```
Exception in thread "main" java.lang.NoClassDefFoundError: MyClass
Caused by: java.lang.ClassNotFoundException: MyClass
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

我的java文件：

```
public class MyClass {

    public static void main(String[] args) {
        System.out.println("Test");
    }

} 
```

我在我的源代码中看不到任何错误。到底是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-17T04:50:04.330

将评论转换为答案

> 在eclipse中右键project-->properties-->java build path-->remove old library and add new

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T12:36:32.737

转到包资源管理器，向上滚动并右键单击项目名称（必须带有红色叉号），然后选择刷新。

我是用那个方法整理出来的。我希望它会帮助你。

# mysql - 防止重复输入时自动递增

> ID：15588400
> 
> 赞同：1
> 
> 时间：2013-03-23T15:16:02.630
> 
> 标签：mysql, pdo, auto-increment, duplicates

我已经看到了这个问题（参见底部的链接），但我似乎无法找到答案。问题是我在具有作为主键的自动增量 ID 的表上插入数据，以及具有唯一索引的另一个字段以避免重复。这是可行的，但是当这种情况发生时，ID 会增加，尽管没有存储数据。

**删除自动增量并自己处理，选择最大（ID）会更好吗？**

* * *

目前，我尝试了几种策略使其按原样工作，包括`INSERT IGNORE`和`INSERT ... ON DUPLICATE KEY UPDATE`

我最近的尝试是使用以下查询：

```
INSERT INTO
    content(field1, field2)
SELECT(:field1, :field2) FROM DUAL
WHERE NOT EXISTS(
    SELECT field1, field2
    FROM content
    WHERE field1 = :field1
) 
```

* * *

有关的

*   [在 MySQL 中，当出现“重复条目”错误时，如何防止主键自动递增？](https://stackoverflow.com/questions/8877468/in-mysql-when-there-is-a-duplicate-entry-error-how-do-i-prevent-the-primary)
*   [SQL Server - 如何插入记录并确保它是唯一的](https://stackoverflow.com/questions/267804/sql-server-how-to-insert-a-record-and-make-sure-it-is-unique)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-16T15:58:10.570

你可以做一个 ORDER BY :)

```
UPDATE 'table' 
    SET column_id = column_id+1 
    WHERE column_id > [point where you want a un-occupied key] 
    ORDER BY column_id DESC 
```

mysql 先执行 where 和 order 再执行更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-11T20:18:19.863

感谢[这个问题](https://stackoverflow.com/questions/456644/mysql-syntax-error-message-operand-should-contain-1-columns)，我已经能够修复该错误。问题是`SELECT(:field1, :field2)`不应该有括号。所以查询应该是：

```
INSERT INTO
    content(field1, field2)
SELECT :field1, :field2 FROM DUAL
WHERE NOT EXISTS(
    SELECT field1, field2
    FROM content
    WHERE field1 = :field1
) 
```

# asp.net - 验证下拉列表

> ID：15588403
> 
> 赞同：0
> 
> 时间：2013-03-23T15:16:10.477
> 
> 标签：asp.net, requiredfieldvalidator, html-select

我在 aspx 页面中有一个下拉列表，我正在使用数据表填充下拉列表。我如何将必填字段验证器应用于此下拉列表。？请帮帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:22:25.490

您必须为首先[`InitialValue`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.requiredfieldvalidator.initialvalue.aspx) 选择的选定项目设置`Value`：

```
<asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
    ControlToValidate="DropDownList1" 
    InitialValue="-- Please select --" 
    ErrorMessage="Please select something" />

 <asp:DropDownList ID="DropDownList1" AppendDataBoundItems="true" runat="server">
     <asp:ListItem>-- Please select --</asp:ListItem>
  </asp:DropDownList> 
```

# php - 系统返回：(104) connection reset by peer

> ID：15588404
> 
> 赞同：2
> 
> 时间：2013-03-23T15:16:11.083
> 
> 标签：php, hosting, squid

面临鱿鱼错误。这是我们收到的错误消息。

读取错误'系统返回：（104）连接被对等方重置。

我们的网络产品托管在 godaddy 上。除了我们面临错误的这一页外，整个网站都运行良好。页面恰好在 15 秒后超时。在 localhost 上测试同一页面时，它完全可以正常工作，但是在服务器上测试时同一页面超时。任何人都可以建议我们一个解决方案吗？从过去的几个小时中打破我们的头脑。提前致谢。我们收到错误页面的链接：[http](http://silicongem.com/rhea/testrd.php) ://silicongem.com/rhea/testrd.php 进行身份验证您可以使用用户名：演示密码：demo1 快照： ![快照](../Images/724d6ed3ad17185faac9740929f61810.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-19T12:18:35.787

有时，糟糕的 Squid 配置也会导致这种情况。请检查您是否定义了正确的内存配置。这些是保持 Squid 健康的几个重要设置 -

```
max_stale 24 hour
cache_mem 1500 MB
memory_replacement_policy lru
cache_replacement_policy lru
cache_swap_low 93
cache_swap_high 97
positive_dns_ttl 24 hours
negative_dns_ttl 1 minute
quick_abort_min 0 KB
quick_abort_max 0 KB 
```

您可以通过在末尾替换每个指令来找到文档 - [http://www.squid-cache.org/Doc/config/cache_swap_low/](http://www.squid-cache.org/Doc/config/cache_swap_low/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-18T12:27:06.403

好吧，我的服务器没有达到标准。我不得不改变服务器。因为，旧服务器无法在几秒钟内计算太多操作。

# c# - 短路不工作

> ID：15588405
> 
> 赞同：0
> 
> 时间：2013-03-23T15:16:11.317
> 
> 标签：c#, short-circuiting

我的理解是 C# 条件运算符执行短路。但是，我的程序在运行此代码时引发异常。索引等于-1，所以第二个条件永远不应该执行，但是我得到一个索引越界异常。

```
if (index != -1 || pieces[index].Type != PieceType.Rook)
{
    allowed = false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:18:44.447

你用过|| 因此，当第一个条件失败（索引 IS -1）时，运行时需要在排除执行代码之前检查第二个条件，这将触发异常，

相反，如果您只想在两个条件都为真时输入 if，则使用 && (AND)。
这样，和以前一样，运行时检查第一个条件，现在得到错误的结果就足以决定不需要检查第二个条件。

```
if (index != -1 && pieces[index].Type != PieceType.Rook)
{
    allowed = false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:17:49.160

替换`||`为`&&`

```
if (index != -1 && pieces[index].Type != PieceType.Rook) 
```

否则，如果第一个是您不想要的错误，则评估第二个代码。您希望两个条件都存在`true`，尤其是第一个条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:28:50.633

`||`当它发现某事为真时将停止评估。由于`index != -1`为假，它将评估表达式的两侧。如果你`&&`一旦发现错误就会停止。我建议阅读[惰性评估](http://en.wikipedia.org/wiki/Lazy_evaluation)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:17:24.400

那是因为您使用 OR 运算符。第一个条件是假的，所以第二个开始评估。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-23T15:17:46.553

你应该有`index != 1 && ...`。

另外，是`index` `< -1`还是`>= pieces.Length`？

# c - 这段 C 代码有什么问题？（没有按预期工作）

> ID：15588408
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:16:18.333
> 
> 标签：c, function, pointers

我的 C 课还有另一个练习。代码不会崩溃，但不能按预期工作。显然我犯了一个我找不到的错误。分配如下：用户输入两个字符 c1 和 c2 以及一个整数 n，您必须创建一个函数，该函数动态创建并返回一个包含 n 个字符的字符串，如下所示：c1c2c1c2c1c2 等。例如：c1=a 和 c2= s and n=4 字符串为：asas

但是我创建的数组不包含 c1 和 c2，而是 ASCII 表中的一些随机字符。加上这里：

```
printf("\nThe string is: %s\n",s); 
```

屏幕上的输出是这样的： Ohe string is: I (Insted of The string is: s-whatever s is-) 下面是 .exe 文件中的照片链接：

![在此处输入图像描述](../Images/cd01de1c0908522545d9c6668c8a9e63.png)

```
#include <stdio.h>
#include <stdlib.h>

char* alternate(char c1,char c2,int n)
{
    int i;
    char *s;
    s=(char*)malloc((n+1)*sizeof(char));
    if(s==NULL)
    {
        puts("Could not allocate memory!");
        exit(1);
    }
    for(i=0;i<n;i++);
    {
        if(i%2==0)
            s[i]=c1;
        else
            s[i]=c2;
    }
    s[i]='\0';
    return s;
}

main()
{
    char c1,c2,*s;
    int n;
    puts("Give two characters: ");
    scanf("%c %c",&c1,&c2);
    fflush(stdin);
    puts("Give an integer: ");
    scanf("%d",&n);
    s=alternate(c1,c2,n);
    printf("\nThe string is: %s\n",s);
    free(s);
    system("pause");
} 
```

先感谢您！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T15:22:45.387

*删除*`;`在_

```
for(i=0;i<n;i++);
{ 
```

它不属于那里。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-23T15:23:55.667

删除 for 循环语句旁边的分号：

```
 for(i=0;i<n;i++); 
```

我删除了分号并尝试了您的代码并按预期打印文本。

for 循环旁边的分号使其成为一个空循环，之后的语句只是一些范围内的赋值。那是，

```
for(i=0;i<n;i++);
    {
        if(i%2==0)
            s[i]=c1;
        else
            s[i]=c2;
    } 
```

和

```
for(i=0;i<n;i++) 
{

}

{
   if(i%2==0)
      s[i]=c1;
   else
      s[i]=c2;
 } 
```

# php - 在 Laravel 4 中找不到控制器路由

> ID：15588409
> 
> 赞同：2
> 
> 时间：2013-03-23T15:16:27.683
> 
> 标签：php, routing, laravel, laravel-4

我正在从 L3 迁移到 L4。注册`HomeController`默认 L4 安装附带的控制器时，尝试转到该页面`www.domain.com/home`会给我一个`ResourceNotFound`例外。我做了一个`composer dumpautoload`，但没有帮助。

我错过了一个额外的步骤吗？

**路由.php**

```
Route::controller('home', 'HomeController'); 
```

**控制器/HomeController.php**

```
<?php

class HomeController extends BaseController {

    public function showWelcome()
    {
        return View::make('hello');
    }

} 
```

**错误堆栈跟踪**

```
NotFoundHttpException:
in /var/www/l4/vendor/laravel/framework/src/Illuminate/Routing/Router.php line 1338
at Router->handleRoutingException(object(ResourceNotFoundException)) in /var/www/l4/vendor/laravel/framework/src/Illuminate/Routing/Router.php line 992
at Router->findRoute(object(Request)) in /var/www/l4/vendor/laravel/framework/src/Illuminate/Routing/Router.php line 956
at Router->dispatch(object(Request)) in /var/www/l4/vendor/laravel/framework/src/Illuminate/Foundation/Application.php line 463
at Application->dispatch(object(Request)) in /var/www/l4/vendor/laravel/framework/src/Illuminate/Foundation/Application.php line 448
at Application->run() in /var/www/l4/public/index.php line 51 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:48:28.687

根据[文档](http://four.laravel.com/docs/controllers#resource-controllers)：

> 接下来，只需将方法添加到您的控制器，以它们响应的 HTTP 动词为前缀

所以：

```
class UserController extends BaseController {

    public function getIndex() 
    {
        // Would response to /user and /user/index
    }
} 
```

因此，在您的情况下，只需重命名`showWelcome()`为`getWelcome()`就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:49:49.173

尝试将您的路线更改为：

```
Route::resource('home', 'HomeController'); 
```

更新：我的错，我以为你想要一个足智多谋的控制器，如此处所述：http: [//four.laravel.com/docs/controllers#resource-controllers](http://four.laravel.com/docs/controllers#resource-controllers)

对于“正常”的 RESTful 控制器，juco 的回答似乎是正确的。

如果你想要基本的控制器，你可以使用它来对应你的控制器方法：

```
Route::get('home', 'HomeController@showWelcome'); 
```

# proxy - nginx 上的 webmin 问题（重定向太多）

> ID：15588410
> 
> 赞同：1
> 
> 时间：2013-03-23T15:16:31.803
> 
> 标签：proxy, nginx, webmin

我通过 nginx（代理）设置 webmin，并且有两个问题 1）如果我不使用 rewrite，那么 webmin 在登录后将我重定向到 10000 端口 2）如果我使用 mod rewrite，那么我看到错误 310（net::ERR_TOO_MANY_REDIRECTS ）：在我的浏览器上。

我的 nginx 配置：

```
server {
listen 80;
server_name cp.domain.com www.cp.domain.com;

if ($http_host != "cp.domain.com:10000") {
               rewrite ^ http://cp.domain.com$request_uri permanent;
   }
location / {
proxy_pass http://localhost:10000/;
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_buffering off;
tcp_nodelay on;
}
} 
```

什么问题？最好的问候，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T18:20:25.830

你的 nginx 反向代理设置不应该重定向到 10000，除非你有一个特殊的[proxy_redirect](http://wiki.nginx.org/HttpProxyModule#proxy_redirect)指令告诉 nginx 否则这样做。其他人正在这样做。

因为您的服务器块仅侦听端口 80。所以您的条件

```
 $http_host != "cp.domain.com:10000" 
```

将始终为真，因为 $http_host 的端口部分始终为 80。这就是重定向循环发生的方式。基本上 if 块在这里没用。

# ruby-on-rails - 为什么在 Ubuntu 上安装 Rails gem 会引发 Zlib::GzipFile::Error？

> ID：15588411
> 
> 赞同：0
> 
> 时间：2013-03-23T15:16:48.403
> 
> 标签：ruby-on-rails, ruby, ubuntu, gem

这就是我正在做的

```
sudo gem install rails
ERROR:  While executing gem ... (Zlib::GzipFile::Error)
    unexpected end of file
alex@ubuntu:~/Documents/$ sudo gem fetch -V rails
GET http://rubygems.org/latest_specs.4.8.gz
302 Moved Temporarily
GET http://production.s3.rubygems.org/latest_specs.4.8.gz
200 OK
ERROR:  While executing gem ... (Zlib::GzipFile::Error)
    unexpected end of file 
```

我对此进行了谷歌搜索，但没有发现任何有价值的东西。我什至安装了

```
sudo apt-get install libzlib-ruby 
```

我能够以这种方式安装 rake

```
gem install rake 
```

奇怪的是，如果我说只是`gem install rails`那么什么都不会发生。

```
gem sources
*** CURRENT SOURCES ***

https://rubygems.org/ 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:57:20.107

## 不要那样做

在基于 Debian 的系统上安装系统 gem 是个坏主意。不要那样做。要么使用系统包，要么使用像[rvm](https://rvm.io/)或[rbenv](https://github.com/sstephenson/rbenv/)这样的 Ruby 环境管理工具。

## 使用系统包

根据您的 Ubuntu 版本，使用：

```
# Rails 2.3 on Ubuntu 12.10
sudo apt-get install rails

# Rails 3.2 on Ubuntu 12.10
sudo apt-get install rails3 
```

或为您的版本找到可用的 Rails 元包`apt-cache search`。

## 在 Ubuntu 12.10 上安装 rbenv

如果您使用的是 Ubuntu 12.10，您也可以将 rbenv 和 ruby​​-build 安装为系统包。例如：

```
sudo apt-get install --install-suggests rbenv ruby-build 
```

# jdbc - 是否可以使用 hsqldb 的 JDBC 接口执行多个 sql 语句？

> ID：15588412
> 
> 赞同：0
> 
> 时间：2013-03-23T15:16:55.597
> 
> 标签：jdbc, hsqldb

具体来说，我运行这些语句：

```
 String script = String.format(
      "CREATE CACHED TABLE IF NOT EXISTS %s (id VARCHAR(36), value %s, PRIMARY KEY (id));", indexName, getIndexType());
    st.execute(script);
    script = String.format("CREATE INDEX idx_%s ON %s (value);", indexName, indexName);
    st.execute(script); 
```

我想知道是否可以用一个执行命令来做到这一点？我尝试的只是连接两个字符串并执行。但是 hsqldb 抱怨正在创建索引的表不存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T05:10:36.520

HSQLDB的[文档](http://www.hsqldb.org/doc/guide/ch09.html#create_table-section)不提供在表创建期间指定表索引的任何方式，因此您必须对数据库进行 2 次单独调用。

顺便说一句，我建议`PreparedStatement`再次使用来保护 SQL 注入攻击。使用占位符消除了使用`String.format`.

# jquery - 检测可拖动捕捉器与其捕捉到的元素的相对位置

> ID：15588413
> 
> 赞同：2
> 
> 时间：2013-03-23T15:16:58.663
> 
> 标签：jquery, jquery-ui-draggable

**目标**

1.  根据位置将元素捕捉在一起或拒绝捕捉
2.  根据捕捉位置更改元素外观

**已经咨询过的消息来源**

[Jquery UI – 可拖动的“捕捉”事件](https://stackoverflow.com/questions/11611765/jquery-ui-draggable-snap-event/11631854?noredirect=1#comment22099017_11631854)

[使用启用捕捉的可拖动 jQuery UI 检索“捕捉到”元素](https://stackoverflow.com/questions/4220557/retrieving-the-snapped-to-element-using-jquery-ui-draggable-with-snap-enabled)

[jQuery UI 可拖动选项 snaptolerance](http://www.pureexample.com/jquery-ui-draggable-options-snaptolerance.html)

**可视化** 想象一个带有连接器的 div - 如果我将它连接到左瓶，我需要连接器指向右，如果连接到右瓶，连接器需要指向左。

这种连接器不能卡扣到瓶子的顶部或底部，因此在这种情况下需要拒绝顶部或底部卡扣 - 其他情况可能只是垂直卡扣，而其他情况可能会垂直或水平卡扣。最有可能是水平或垂直

![在此处输入图像描述](../Images/60fba705e7a38874cd8242e30eb96936.png) ![在此处输入图像描述](../Images/0005dc1854518be428a8bdafa92a0c5b.png)

**示例代码** [DEMO](http://plungjan.name/snap/snaptest.html)

```
snapped: function(event, ui) {
    var snapper  = ui.snapElement.attr("id"),snapperPos = ui.snapElement.position(),
        snappee  = ui.helper.attr("id"),     snappeePos = ui.helper.position(),
        snapping = ui.snapping,
        collisionTolerance = 3;

    if (Math.abs(snapperPos.left-snappeePos.left)<=collisionTolerance) {
        if (snapperPos.top > snappeePos.top) ui.helper.html(showPos(snapper,"top",snapperPos,snappeePos));
        else ui.helper.html(showPos(snapper,"bottom",snapperPos,snappeePos));
    }
    else if (Math.abs(snapperPos.top-snappeePos.top)<=collisionTolerance) {
        if (snapperPos.left > snappeePos.left) ui.helper.html(showPos(snapper,"left",snapperPos,snappeePos));
        else ui.helper.html(showPos(snapper,"right",snapperPos,snappeePos));
    }
    else ui.helper.html(showPos(snapper,"corner",snapperPos,snappeePos));
}, 
```

**问题**

1.  我如何可靠地检测到我已经真正捕捉到确切的左侧、右侧、顶部或底部？- 看看我的意思，抓住一个偏见，盒子被折断，但脚本说角落
2.  如何拒绝按扣/将位置标记为不可按扣？

我需要将拖动的 div 中的图像更改为在它接近捕捉位置时指向正确的方向，所以如果你有一个数学建议可以显示这一点，那就太好了。如您所见，3 个像素还不够——我正在考虑拖动元素的一半宽度或高度。数学很重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T07:19:30.093

> **更新：**根据下面的评论，这需要一个比我原来的答案更通用的解决方案。

正如评论中所讨论的，`snapped`如果捕捉的元素保持不变，则不会在拖动时再次触发事件，即使当辅助元素捕捉到的边缘发生变化时（这是我最初实现中的设计）。

为了克服这个限制，必须在处理程序中执行边缘检测，并且如果边缘发生变化，则必须触发`drag`其他事件。`snapped`

我们可以从计算一个元素与另一个元素的相对位置的效用函数开始。该函数返回人类可读的字符串，如`"top left"`or `"bottom right"`。我选择在下面的代码中使用元素宽度和高度的一半作为角的公差，如果它不适合可拖动元素的形状，当然可以修改：

```
function computeRelativePosition($element, $reference)
{
    var result = [],
        vtol = $element.outerHeight() / 2,
        htol = $element.outerWidth() / 2,
        pos = $element.position(),
        bounds = $reference.position();
    $.extend(pos, {
        bottom: pos.top + $element.outerHeight() - 1,
        right: pos.left + $element.outerWidth() - 1
    });
    $.extend(bounds, {
        bottom: bounds.top + $reference.outerHeight() - 1,
        right: bounds.left + $reference.outerWidth() - 1
    });

    if (pos.top + vtol <= bounds.top) {
        result.push("top");
    } else if (pos.bottom - vtol >= bounds.bottom) {
        result.push("bottom");
    }

    if (pos.left + htol <= bounds.left) {
        result.push("left");
    } else if (pos.right - htol >= bounds.right) {
        result.push("right");
    }

    return result.join(" ");
} 
```

从那里开始，我们必须在我们的`drag`处理程序中使用该函数并触发一个`snapped`事件，如果自上次处理程序运行以来助手与捕捉元素的相对位置发生了变化：

```
drag: function(event, ui) {
    var draggable = $(this).data("draggable"); // "ui-draggable" with jQuery UI 1.10+
    $.each(draggable.snapElements, function(index, element) {
        ui = $.extend({}, ui, {
            snapElement: $(element.item),
            snapping: element.snapping
        });
        if (element.snapping) {
            var at = computeRelativePosition(ui.helper, ui.snapElement);
            if (!element.snappingKnown || at != element.at) {
                element.snappingKnown = true;
                element.at = ui.at = at;
                draggable._trigger("snapped", event, ui);
            }
        } else if (element.snappingKnown) {
            element.snappingKnown = false;
            draggable._trigger("snapped", event, ui);
        }
    });
} 
```

最后，我们可以将您的`snapped`处理程序更新为：

```
snapped: function(event, ui) {
    var snapper = ui.snapElement.attr("id"),
        snapperPos = ui.snapElement.position(),
        snappee = ui.helper.attr("id"),
        snappeePos = ui.helper.position(),
        snapping = ui.snapping;
    if (snapping) {
        ui.helper.html(showPos(snapper, ui.at, snapperPos, snappeePos));
    }
} 
```

这个解决方案在我的测试中给出了始终如一的准确结果。[你会在这里](http://jsfiddle.net/a9NmR/3/)找到一个更新的小提琴。

* * *

> *原答案如下：*

看起来您在计算中没有考虑辅助元素的宽度和高度。边缘检测代码应如下所示：

```
if (Math.abs(snapperPos.left - snappeePos.left) <= collisionTolerance) {
    if (snapperPos.top + ui.snapElement.outerHeight() > snappeePos.top) {
        ui.helper.html(showPos(snapper, "top", snapperPos, snappeePos));
    } else {
        ui.helper.html(showPos(snapper, "bottom", snapperPos, snappeePos));
    }
} else if (Math.abs(snapperPos.top - snappeePos.top) <= collisionTolerance) {
    if (snapperPos.left + ui.snapElement.outerWidth() > snappeePos.left) {
        ui.helper.html(showPos(snapper, "left", snapperPos, snappeePos));
    } else {
        ui.helper.html(showPos(snapper, "right", snapperPos, snappeePos));
    }
} else {
    ui.helper.html(showPos(snapper, "corner", snapperPos, snappeePos));
} 
```

上面的代码给了我更好的结果，前提`collisionTolerance`是设置为`50`并且代码仅在`snapping`is时运行`true`。您可以在我根据您的示例创建的[这个小提琴中对其进行测试。](http://jsfiddle.net/a9NmR/)

也就是说，我认为您的问题可以简化很多。由于您只对水平边缘检测感兴趣，因此您只需将助手的左侧位置与捕捉元素的左侧位置进行比较。如果前者小于后者，则助手将向左对齐。否则它会向右对齐。

我修改了我对原始问题的回答中的小提琴来实现这个（因为我比你的例子更熟悉它）。结果是：

```
snapped: function(event, ui) {
    ui.snapElement.toggleClass("ui-state-highlight ui-state-default");
    var status = ui.snapElement.find(".status");
    if (ui.snapping) {
        if (ui.helper.position().left < ui.snapElement.position().left) {
            status.text("left");
        } else {
            status.text("right");
        }
    } else {
        status.text("");
    }
} 
```

你可以[在这里](http://jsfiddle.net/ksNdP/1/)测试它。

关于您的第二个问题，恐怕可拖动小部件不支持部分（仅水平）捕捉（尚未）。但是，也许您可​​以忽略垂直对齐并根据其水平位置继续切换助手的图像。除了当助手接近元素的顶部和底部边缘时发生的“跳跃”之外，代码应该仍然可以正常工作。

# mysql - 根据关系 MYSQL 插入行

> ID：15588418
> 
> 赞同：0
> 
> 时间：2013-03-23T15:17:34.363
> 
> 标签：mysql, insert

我的 mysql 数据库中有以下场景。2张桌子：

**待办事项**

*   todo_id
*   todo_title

**todo_sync_controllers**

*   todo_sync_id
*   设备ID
*   应该删除
*   is_deleted
*   todo_id

如您所见，从 todoitems 到 todo_sync_controllers 是一对多的关系。

我使用 php 脚本与服务器通信。每次我从设备中提取待办事项时，我都需要确保该设备和待办事项有一个 todo_sync_controller 条目。如果缺少它，则应创建它。

解决此问题的一种方法是使用我的 php 脚本中的循环和多个查询，但我想知道这是否可以使用单个 INSERT 查询来完成？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:15:03.450

您的解决方案非常简单，只需在 todo_sync_controllers 表中为 todo_id 和 device_id 创建唯一键，因此当您从脚本插入表时，它会检查唯一约束，如果不存在，将插入数据，否则会被 mysql 错误忽略以进行查询. 如果您想检查您的数据是否由于重复键而被插入或被忽略，您需要在进行查询时应用 if 条件，如果它返回 true 则表示插入已完成，否则系统将忽略此操作。这将像下面的代码一样完成

```
if(mysql_query($sql_query)){
    echo "your data inserted";
}else{
    echo "data already exist";
} 
```

并改变你的桌子

```
create unique index on todo_sync_controllers (todo_id ,device_id) 
```

# objective-c - 保存 UITableView 的选中行

> ID：15588426
> 
> 赞同：0
> 
> 时间：2013-03-23T15:18:23.507
> 
> 标签：objective-c, uitableview, selected, nsuinteger

我有两个 UITableViews。我想知道如何在第一个表视图中“保存”选定的行，以便能够将该数字用作在我的另一个表视图中显示该特定索引的索引。它使用 plist 来存储带有字典的数组的数组。

这是我现在尝试使用的：

```
mycontroller.selectedIndexPath = indexPath.row; 
```

`selectedIndexPath`是一个 NSUInteger。但它并没有真正起作用。有什么解决方案的建议吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:18:18.847

代码如下：-

首先，你的问题做错了，应该如下

```
myController.selectedIndexpath.row = indexpath.row 
```

**第一个选项：-** 要存储 selectedIndexPath 的行，您可以将其存储为`userDefaults`

```
[[NSUserDefaults standardUserDefaults] setInteger:indexPath.row forKey:@"selectedRow"]; 
```

并在`SecondTableView`

```
index =  [[NSUserDefaults standardUserDefaults] integerForKey:@"selectedRow"]; 
```

**第二种选择：-**

```
use `@property` 
```

# c++ - 如何在 std::map 声明中声明自定义排序函数？

> ID：15588428
> 
> 赞同：4
> 
> 时间：2013-03-23T15:18:37.250
> 
> 标签：c++, sorting, dictionary

容器`std::map`总是根据它们的值对键进行排序。例如，是否可以根据声明时设置的位数对其进行排序？

我有一个计算设置位的功能：

```
for(size_t i = 0; i < CHAR_BIT * sizeof value; ++i, value >>= 1) {
  if ((value & 1) == byteState) ++num_bits;
} 
```

但是我不知道在声明地图时如何应用它：

```
std::map<int, int> myMap = {
  {1,2},
  {3,4},
  //...
} 
```

我试图将它作为声明中的第三个参数`<int,int,decltype(countSetBits)>`，但没有运气。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-23T15:26:39.910

您需要将函数包装在二元运算符中，如下所示：

```
#include <iostream>
#include <map>
#include <algorithm>

int cntBits(int value) {
    int num_bits=0;
    for(size_t i = 0; i < 32 ; ++i, value >>= 1) {
        if ((value & 1) == 1) ++num_bits;
    }
    return num_bits;
}

struct cntBitsCmp {
    bool operator()(int a, int b) {
        return cntBits(a) < cntBits(b);
    }
}; 
```

现在您可以`cntBitsCmp`在声明中使用：

```
std::map<int,int,cntBitsCmp> myMap= {
    {128,2},
    {3,4},
    ...
}; 
```

这是[关于 ideone 的演示](http://ideone.com/0FwGdK)。它正确地将 128 排在 3 之前，因为 3 设置了两位，而 128 只有一位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-12-13T10:36:32.050

从[C++11](https://en.wikipedia.org/wiki/C%2B%2B11)开始，您还可以使用[lambda 表达式](https://en.cppreference.com/w/cpp/language/lambda)而不是定义比较函数。如果将其与[std::bitset::count](https://en.cppreference.com/w/cpp/utility/bitset/count)结合使用，而不是使用您自己的计数函数，则代码会变得相当短：

```
auto comp = [](int a, int b) { return std::bitset<32>(a).count() < std::bitset<32>(b).count(); };
std::map<int, int, decltype(comp)> m(comp); 
```

注意：类似于[Sergey 的解决方案，](https://stackoverflow.com/a/15588509/2675154)为了清楚起见，我假设为 32 位整数。请根据您的需要调整代码。

[Ideone 上的代码](https://ideone.com/kecYcS)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T15:32:04.667

基本上这可以按你的意愿工作：

```
bool comp(int x , int y ){
    return  __builtin_popcount(x) <  __builtin_popcount(y);
}
int main(){
    bool(*fn_pt)(int,int) = comp;
    std::map<int, int, bool(*)(int,int) > myMap (fn_pt);
    myMap[7]=11;
    myMap[8]=12;
    cout<<myMap.begin()->first<<endl;  // you get 8 instead of 7
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-14T12:59:38.173

当我将我的函数包装在一个二元运算符中并使用它通过字符串（键）的长度对我的地图进行排序时，一切都很好并且它工作正常。但是，我没有意识到它影响了 maps find() 函数。而不是找到等于字符串的键，而是找到与键具有相同字符串长度的键！

# php - AJAX/PHP 异步计算

> ID：15588433
> 
> 赞同：2
> 
> 时间：2013-03-23T15:19:07.553
> 
> 标签：php, javascript, ajax

我目前正在为我的项目计划一个成就系统。当用户实际访问“成就”页面时，成就将被解锁，任何未完成的都会显示其进度。

计算某些成就的进度可能需要一些时间。我想出了这个想法，但我不知道如何去实现它，或者它是否可能：

*   JavaScript 通过 AJAX 请求成就数据
*   PHP开始计算成就进度
*   对于每个成就，将一行写入输出流，形式为`ID:progress`
*   JavaScript 接收每一行并显示给定成就的进度

我将如何让 AJAX 在`responseText`到达时逐行读取它，而不是在最后一次全部读取？

* * *

此外，如果可能的话，我希望 PHP 像这样被线程化：

*   对于每项成就：
    *   如果有超过 N 个“线程”，则等待一个完成
    *   分叉一个线程来计算当前的成就并回显结果行

在 PHP 中这样的事情是可能的吗？

* * *

或者我只是以完全错误的方式去做这件事？我应该为每组成就发送一个 AJAX 请求吗？还是每个成就一个？你会建议什么作为替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T15:39:39.180

您可以在现代 ES5 浏览器中通过结合使用客户端上的[XHR2 进度事件和服务器上的](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest)[HTTP 块传输编码](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)来实现这一点——[这篇 Stack Overflow 帖子](https://stackoverflow.com/questions/6789703/how-to-write-javascript-in-client-side-to-receive-and-parse-chunked-response-i)更详细地介绍了这一点。

就个人而言，我会说这种方法有点过度设计。如果第一次获取玩家成就需要不到几秒钟的时间（假设您将在给定时间段内为后续请求缓存它），那么我会让玩家在下载时等待并寻求优化一旦我有足够的用户来保证它:)

# ruby - 打开并返回带有标题的 fastcsv 对象

> ID：15588437
> 
> 赞同：0
> 
> 时间：2013-03-23T15:19:44.690
> 
> 标签：ruby, fastercsv

我有一个如下的数据样本

```
Ticker,Date/Time,Conseqhigher,Conseqlower,H,L,newHigh,newLow,Prevbarlow,Prevbarhigh,uptrend,dntrend,min15low,min15high
EUR.USD-IDEALPRO-CASH,2012-02-19 17:20,1,0,1.3208,1.3198,1,1,1.3183,1.3211,0,0,1.3139,1.3153
EUR.USD-IDEALPRO-CASH,2012-02-19 17:25,0,0,1.3209,1.3198,1,0,1.3198,1.3208,0,0,1.3139,1.3153 
```

我正在尝试使用更快的 csv 打开它并稍后处理它。

```
require 'fastercsv'
def query()

return FasterCSV.read("c:\\temp\\test.csv")

end 
```

read 方法没有任何 headers 选项。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T18:02:59.727

您应该使用标准 CSV 库。它是 FasterCSV 加上对 Ruby 1.9 的 m17n 编码引擎的支持。

回到您的问题，有一个`:headers`选项可以通过标题访问每个值。

该`#read`方法将 slurp 整个文件：

```
CSV.read(CSV_FILE_PATH, :headers => true).each do |line|
  puts line['Ticker']
end 
```

该`#foreach`方法是用于读取的预期主要接口：

```
CSV.foreach(CSV_FILE_PATH, :headers => true) do |line|
  puts line['Ticker']
end 
```

两种方法都会输出：

```
EUR.USD-IDEALPRO-CASH
EUR.USD-IDEALPRO-CASH 
```

请参阅[http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html](http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html)。

# scala - 为 Scala SeqLike 实现 containsAny 的惯用方式

> ID：15588442
> 
> 赞同：5
> 
> 时间：2013-03-23T15:20:00.943
> 
> 标签：scala

Scala`SeqLike`实现了一个方法`contains`。我怎样才能干净地实现一个`containsAny`功能？

假设我想查明一个字符串是否`string`包含以下中的任何黑名单字符`blacklist`：

```
val blacklist = List("(", ")", "[", "]", "{", "}", "<", ">")
string containsAny blacklist 
```

干净地实施第二行的最佳方法是什么？

到目前为止，我的版本如下所示：

```
(blacklist.view map string.contains) contains true 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-23T15:24:24.610

您最好的选择是设置黑名单。

```
val blacklist = "()[]{}<>".toSet 
```

现在您可以使用`exists`来查找字符串中是否存在这些字符。由于`Set[T]`extends `T => Boolean`，您可以直接使用集合，而不必编写显式条件。

```
scala> "I like fish (but not herring)" exists blacklist
res1: Boolean = true

scala> "I like fish, especially salmon!" exists blacklist
res2: Boolean = false 
```

（注意：注意字符串和字符之间的区别`"I am a string"`：`'c'`。一个字符的字符串是字符串，而不是字符。）

# java - java - 独立应用程序的数据源 - 没有应用程序服务器

> ID：15588449
> 
> 赞同：3
> 
> 时间：2013-03-23T15:20:46.817
> 
> 标签：java, mysql, jdbc, database-connection, connection-pooling

我想从独立应用程序连接到 MySQL 数据库。没有应用程序/Web 服务器。

此[页面](http://dev.mysql.com/doc/connector-j/en/connector-j-usagenotes-connect-drivermanager.html)建议我应该使用 DriverManager 创建连接。但是，[此](http://docs.oracle.com/javase/6/docs/api/javax/sql/package-summary.html)页面建议从 DriverManager 创建的连接不能被池化。

然而，连接池对我来说是必须的，因为应用程序使用各种线程同时写入数据库，因此关闭/重新创建连接并不是最佳的。

1.  为此，我应该使用哪个 DataSource 实现？我查看了[MysqlConnectionPoolDataSource](http://org.ntnu.no/musikkensverden/doc/com/mysql/jdbc/jdbc2/optional/MysqlConnectionPoolDataSource.html)但我不确定它是否真的实现了连接池。我还查看了 Tomcat[数据源](http://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/tomcat/jdbc/pool/DataSource.html)，我确信它实现了一个连接池，但我不确定它是否可以在 Tomcat 之外使用。

2.  当我关闭独立应用程序时，我应该怎么做才能正确释放连接/池？

编辑：看起来 Tomcat 数据源[可以](http://people.apache.org/~fhanik/jdbc-pool/jdbc-pool.html)从独立应用程序中使用，所以我将使用它。它还有一个 close 方法，我认为它会释放连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:32:22.740

1.  我建议使用像[DBPool](http://www.snaq.net/java/DBPool/)这样的库。由于开发人员已经处理好它们，因此您会感到很头疼。
2.  要确保正确清理连接池，请阅读有关 JVM 关闭挂钩的[文档。](http://www.snaq.net/java/DBPool/#Adv_ShutdownHook)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T17:15:27.397

看看 Apache DBCP 和 DBUtils

**[DBCP](http://commons.apache.org/proper/commons-dbcp/)**将为您提供连接池等功能。

**[DBUtils](http://commons.apache.org/proper/commons-dbutils/)**将使 jdbc 更容易为您服务。

如前所述， [DBPool](http://www.snaq.net/java/DBPool/)也是其中之一，那里有[BoneCP](http://jolbox.com/)和大量池化工具。

看一些样本：

*   [使用 Apache 常用 DBCP 和 DBUtils 的连接池](http://javahunter.wordpress.com/2011/09/05/connection-pooling-using-apache-common-dbcp-and/)
*   [使用 Apache Commons DBUtils 和 DBCP](http://www.stupidjavatricks.com/?p=45)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T17:34:46.390

看看[Apache Cayenne](http://cayenne.apache.org/)，在文档中阅读有关[DataSource](http://cayenne.apache.org/docs/3.0/dbcpdatasourcefactory.html)和[有关连接池的常见问题解答](https://cwiki.apache.org/removed/CAY/connection-pools.html)

编辑：

作为奖励，您可以获得建模器（数据库的图形工具）和与 Eclipse 的轻松集成。

# eclipse - 从语法构建符号表

> ID：15588452
> 
> 赞同：4
> 
> 时间：2013-03-23T15:20:53.107
> 
> 标签：eclipse, antlr, grammar, symbol-table

我正在尝试使用 eclipse 从我的[语法](http://sd-g1.archive-host.com/membres/up/24fe084677d7655eb57ba66e1864081450017dd9/cAST3.txt)（用 antlr 完成）构建一个符号表。但是我不知道从什么开始。我想我在某处读到你需要 antlr 生成的解析器和词法分析器来做到这一点。有人知道一个简单的例子，以便我能理解它是如何工作的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-24T18:34:51.873

符号表只是 id 到值的版本映射。这是一种解决方案，使用范围的推送和弹出作为版本控制机制——在范围定义规则的进入时推送范围并在退出时弹出。

```
package net.certiv.metal.symbol;

import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.Map;

import net.certiv.metal.types.ScopeType;
import net.certiv.metal.util.Strings;

public class Scope {

    public final int genId;

    public ScopeType type;
    public Scope enclosingScope;
    protected Map<String, Symbol> symbolMap = new LinkedHashMap<String, Symbol>();

    public Scope(ScopeType type, final int genId, Scope enclosingScope) {
        this.type = type;
        this.genId = genId;
        this.enclosingScope = enclosingScope;
    }

    /** 
     * Define a new variable in the current scope 
     * This is the entry point for adding new variables
     */
    public void define(String name, ArrayList<String> parameters) {
        String params = Strings.asString(parameters, true, ".");
        Symbol symbol = new Symbol(null, name + params, null);
        define(symbol);
    }

    /** Define a symbol in the current scope */
    private void define(Symbol symbol) {
        symbol.setScope(this);
        symbolMap.put(symbol.name, symbol);
    }

    /**
     * Look up the symbol name in this scope and, if not found, 
     * progressively search the enclosing scopes. 
     * Return null if not found in any applicable scope.
     */
    private Symbol resolve(String name) {
        Symbol symbol = symbolMap.get(name);
        if (symbol != null) return symbol;
        if (enclosingScope != null) return enclosingScope.resolve(name);
        return null; // not found
    }
    /**
     * Lookup a variable starting in the current scope.
     * This is the entry point for lookups
     */
    public Symbol resolve(String name, ArrayList<String> parameters) {
        String params = Strings.asString(parameters, true, ".");
        return resolve(name + params);
    }

    /** Where to look next for symbols */
    public Scope enclosingScope() {
        return enclosingScope;
    }

    public String toString() {
        return symbolMap.keySet().toString();
    }
}

package net.certiv.metal.types;

public enum ScopeType {
    GLOBAL,
    LOCAL;
}

package net.certiv.metal.symbol;

import net.certiv.metal.converter.BaseDescriptor;
import net.certiv.metal.types.ValueType;

public class Symbol {

    protected Scope scope; // the owning scope
    protected BaseDescriptor descriptor;
    protected String name;
    protected ValueType type;

    public Symbol(BaseDescriptor descriptor, String name, ValueType type) {
        this.descriptor = descriptor;
        this.name = name;
        this.type = type;
    }

    public BaseDescriptor getDescriptor() {
        return descriptor;
    }

    public String getName() {
        return name;
    }

    public ValueType getType() {
        return type;
    }

    public void setScope(Scope scope) {
        this.scope = scope;
    }

    public Scope getScope() {
        return scope;
    }

    public int genId() {
        return scope.genId;
    }

    public String toString() {
        if (type != null) return '<' + getName() + ":" + type + '>';
        return getName();
    }
}

package net.certiv.metal.symbol;

import java.util.ArrayList;
import java.util.Stack;

import net.certiv.metal.types.ScopeType;
import net.certiv.metal.util.Log;

public class SymbolTable {

    protected Stack<Scope> scopeStack;
    protected ArrayList<Scope> allScopes;
    protected int genId;

    public SymbolTable() {
        init();
    }

    protected void init() {
        scopeStack = new Stack<>();
        allScopes = new ArrayList<>();
        genId = 0;

        Scope globals = new Scope(ScopeType.GLOBAL, nextGenId(), null);
        scopeStack.push(globals);
        allScopes.add(globals);
    }

    public Scope pushScope() {
        Scope enclosingScope = scopeStack.peek();
        Scope scope = new Scope(ScopeType.LOCAL, nextGenId(), enclosingScope);
        scopeStack.push(scope);
        allScopes.add(scope);
        return scope;
    }

    public void popScope() {
        scopeStack.pop();
    }

    public Scope currentScope() {
        if (scopeStack.size() > 0) {
            return scopeStack.peek();
        }
        Log.error(this, "Unbalanced scope stack.");
        return allScopes.get(0);
    }

    public Scope getScope(int genId) {
        for (Scope scope : scopeStack) {
            if (scope.genId == genId) return scope;
        }
        return null;
    }

    private int nextGenId() {
        genId++;
        return genId;
    }

    public String toString() {
        StringBuilder sb = new StringBuilder();
        for (Scope scope : scopeStack.subList(0, scopeStack.size() - 1)) {
            sb.append(scope.toString());
        }
        return sb.toString();
    }
} 
```

# java - 如何从按距离排序的 JPA 实体中获取结果？

> ID：15588453
> 
> 赞同：1
> 
> 时间：2013-03-23T15:21:02.483
> 
> 标签：java, sql, postgresql, jpa, plpgsql

我目前正在编写一个移动应用程序，用户必须从列表中选择一个位置。所有位置都使用 Play 应用程序中的 JPA 存储在 Postgres 数据库中。

我想做的是在应用程序中获取用户位置，然后请求获取最接近该用户的前 20 或 50 个位置。

如果我为此使用自己的数据结构，我会使用 KD-Tree。但是，我对 JPA/Play/PostgreSQL 很陌生，所以我不确定如何手动处理数据持久性。

以我目前的知识，我唯一能想到的就是查看每个位置并确定它的距离，但在如此庞大的数据库中这将是非常慢的。

有没有我可以运行的查询说“给我 X 个按距该纬度和经度的距离排序的第一个结果？

编辑：我正在使用 Heroku，由于该应用程序处于开发的早期阶段，如果您想在您的应用程序中使用 PostGIS，我宁愿不必支付 Heroku 每月 200 美元的费用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T01:53:14.193

这是我在大约 3 年前构建的应用程序中使用的功能的一个大大简化的版本。适应手头的问题。

*   *使用框*查找点周边的位置。可以用一个圆圈来做这个以获得更准确的结果，但这只是一个近似值。

*   忽略了世界不是平坦的事实。我的申请只适用于一个地方，大约 100 公里。搜索范围仅跨越几公里。使世界变平就足以达到目的。（Todo：根据地理位置更好地估算纬度/经度比率可能会有所帮助。）

*   使用您从 Google 地图获得的地理编码进行操作。

*   与标准 PostgreSQL 一起工作，**无需扩展**（不需要 PostGis），在 PostgreSQL 9.1 和 9.2 上测试。

如果没有索引，则必须计算基表中每一行的距离并过滤最接近的行。大桌子非常昂贵。

**编辑：**
我重新检查过，当前的实现允许在点上使用 GisT 索引（Postgres 9.1 或更高版本）。相应地简化了代码。

~~**主要技巧**是使用***box***的功能性**GiST 索引***，即使该列只是一个点。这使得使用现有的[GiST 实现](http://www.postgresql.org/docs/current/interactive/gist.html)成为可能。*~~

 *通过这样一个（非常快的）搜索，我们可以得到一个框内的所有位置。剩下的问题：我们知道行数，但我们不知道它们所在的框的大小。这就像知道部分答案，但不知道问题。

[我使用与 dba.SE 上的相关答案](https://dba.stackexchange.com/questions/18300/can-spatial-index-help-a-range-order-by-limit-query/22500#22500)中更详细描述的方法类似的**反向查找**方法。（只是，我在这里没有使用部分索引——实际上也可能有效）。

遍历一系列预定义的搜索步骤，从非常小到“大到足以容纳至少足够的位置”。意味着我们必须运行几个（非常快的）查询才能达到搜索框的大小。

然后使用此框搜索基表并仅计算从索引返回的几行的实际距离。通常会有一些盈余，因为我们发现盒子*至少有*足够的位置。通过采用最接近的那些，我们有效地绕过了盒子的角落。您可以通过使框变大来强制实现这种效果（`radius`在函数中乘以 sqrt(2) 以获得完全*准确*的结果，但我不会全力以赴，因为这是近似的开始）。

使用最新版本的 PostgreSQL 中提供的[SP GiST](http://www.postgresql.org/docs/current/interactive/spgist.html)索引，这将更快、更简单。但我不知道这是否可能。我们需要数据类型的实际实现，而我没有时间深入研究它。如果你找到办法，答应回报！

给定这个带有一些示例值（`adr`..地址）的简化表：

```
CREATE TABLE adr(adr_id int, adr text, geocode point);
INSERT INTO adr (adr_id, adr, geocode) VALUES
    (1,  'adr1', '(48.20117,16.294)'),
    (2,  'adr2', '(48.19834,16.302)'),
    (3,  'adr3', '(48.19755,16.299)'),
    (4,  'adr4', '(48.19727,16.303)'),
    (5,  'adr5', '(48.19796,16.304)'),
    (6,  'adr6', '(48.19791,16.302)'),
    (7,  'adr7', '(48.19813,16.304)'),
    (8,  'adr8', '(48.19735,16.299)'),
    (9,  'adr9', '(48.19746,16.297)'); 
```

索引如下所示：

```
CREATE INDEX adr_geocode_gist_idx ON adr USING gist (geocode); 
```

[**-> SQL小提琴**](http://www.sqlfiddle.com/#!1/08d06/1)

您必须根据需要调整家庭区域、步数和比例因子。只要您在一个点周围几公里的方框中进行搜索，平坦的地球就是一个足够好的近似值。

您需要很好地理解 plpgsql 才能使用它。我觉得我在这里做的已经够多了。

```
CREATE OR REPLACE FUNCTION f_find_around(_lat double precision, _lon double precision, _limit bigint = 50)
  RETURNS TABLE(adr_id int, adr text, distance int) AS
$func$
DECLARE
   _homearea   CONSTANT box := '(49.05,17.15),(46.35,9.45)'::box;      -- box around legal area
-- 100m = 0.0008892                   250m, 340m, 450m, 700m,1000m,1500m,2000m,3000m,4500m,7000m
   _steps      CONSTANT real[] := '{0.0022,0.003,0.004,0.006,0.009,0.013,0.018,0.027,0.040,0.062}';  -- find optimum _steps by experimenting
   geo2m       CONSTANT integer := 73500;                              -- ratio geocode(lon) to meter (found by trial & error with google maps)
   lat2lon     CONSTANT real := 1.53;                                  -- ratio lon/lat (lat is worth more; found by trial & error with google maps in (Vienna)
   _radius     real;                                                   -- final search radius
   _area       box;                                                    -- box to search in
   _count      bigint := 0;                                            -- count rows
   _point      point := point($1,$2);                                  -- center of search
   _scalepoint point := point($1 * lat2lon, $2);                       -- lat scaled to adjust
BEGIN

 -- Optimize _radius
IF (_point <@ _homearea) THEN
   FOREACH _radius IN ARRAY _steps LOOP
      SELECT INTO _count  count(*) FROM adr a
      WHERE  a.geocode <@ box(point($1 - _radius, $2 - _radius * lat2lon)
                            , point($1 + _radius, $2 + _radius * lat2lon));

      EXIT WHEN _count >= _limit;
   END LOOP;
END IF;

IF _count = 0 THEN                                                     -- nothing found or not in legal area
   EXIT;
ELSE
   IF _radius IS NULL THEN
      _radius := _steps[array_upper(_steps,1)];                        --  max. _radius
   END IF;
   _area := box(point($1 - _radius, $2 - _radius * lat2lon)
              , point($1 + _radius, $2 + _radius * lat2lon));
END IF;

RETURN QUERY
SELECT a.adr_id
      ,a.adr
      ,((point (a.geocode[0] * lat2lon, a.geocode[1]) <-> _scalepoint) * geo2m)::int4 AS distance
FROM   adr a
WHERE  a.geocode <@ _area
ORDER  BY distance, a.adr, a.adr_id
LIMIT  _limit;

END
$func$  LANGUAGE plpgsql; 
```

称呼：

```
SELECT * FROM f_find_around (48.2, 16.3, 20); 
```

`$3`如果在定义的最大搜索区域中有足够的位置，则返回位置列表。
按实际距离排序。

### 进一步改进

构建一个函数，如：

```
CREATE OR REPLACE FUNCTION f_geo2m(double precision, double precision)
  RETURNS point AS
$BODY$
SELECT point($1 * 111200, $2 * 111400 * cos(radians($1)));
$BODY$
  LANGUAGE sql IMMUTABLE;

COMMENT ON FUNCTION f_geo2m(double precision, double precision)
IS 'Project geocode to approximate metric coordinates.
    SELECT f_geo2m(48.20872, 16.37263)  --'; 
```

（字面意思）全局常量`111200`和从[经度](http://en.wikipedia.org/wiki/Longitude#Length_of_a_degree_of_longitude)长度和[纬度长度](http://en.wikipedia.org/wiki/Latitude#The_length_of_a_degree_of_latitude)`111400`针对我所在地区（奥地利）进行了优化，但基本上只适用于世界各地。

Use it to add a scaled geocode to the base table, ideally a *generated column* like outlined in this answer:
[How do you do date math that ignores the year?](https://stackoverflow.com/questions/15169410/how-do-you-do-date-math-that-ignores-the-year/15179731#15179731)
Refer to **3\. Black magic version** where I walk you through the process.
Then you can simplify the function some more: Scale input values once and remove redundant calculations.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T15:25:01.713

你*真的*不想为此滚动你自己的数据结构，但幸运的是你使用的是 PostgreSQL，所以你很幸运。使用[PostGIS](http://postgis.net/)。它将比您在合理时间内构建的任何东西都要快几个数量级。*

# css - 自定义字体显示奇怪

> ID：15588455
> 
> 赞同：0
> 
> 时间：2013-03-23T13:40:11.567
> 
> 标签：css, fonts

从一开始我就需要说，我知道我想要做的不是“正确的方法”，但我正在为之工作的客户非常想要这种特定的字体。

所以，我需要在客户的网站上使用 VOGUE 使用的确切字体。所以我拿了 .eot & .ttf 并将它们上传到我的服务器上。然后我添加了 CSS 定义：

```
/*fonts fonts for IE*/
@font-face {
    font-family: VogueDidot;
    src: url('font/FBDidotL-Regular.eot') format('embedded-opentype');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: "VogueDidot Light";
    src: url('font/FBDidotL-Light.eot') format('embedded-opentype');
    font-weight: normal;
    font-style: normal;
}

/*fonts for other browsers*/
@font-face {
    font-family: VogueDidot;
    src: url('font/FBDidotL-Regular.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: "VogueDidot Light";
    src: url('font/FBDidotL-Light.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

我的元素的 CSS 是：

```
.post h1 {
    display: block;
    height: 100%;
    font-family: VogueDidot;
    font-size: 55px;
    text-transform: uppercase;
    overflow: hidden;
    line-height: 58px;
} 
```

而且，通常情况下，我希望看到一切都像魅力一样运作。

但这不是...

它应该是这样的：

[https://lh.rs/8M9Q7EvRBapv](https://lh.rs/8M9Q7EvRBapv)

这是我的版本：

[https://lh.rs/Lbini5YbQZlX](https://lh.rs/Lbini5YbQZlX)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T14:41:29.457

需要注意的是，在所有浏览器上使用自定义字体并不是像素完美的，因为所有浏览器都倾向于以不同的方式呈现字体。另一个问题可能是人们没有在 Windows 中启用 ClearType，我确信在这种情况下不是，但对于其他读者，我决定包含此信息。

看起来您的字体支持非常有限，因为您只使用 .ttf 和 .eot - 为了最大程度地兼容并限制渲染问题，最好使用“所有”5 种字体类型，它们是：

*   ttf（TrueType 字体）
*   经常（Adobe/Microsoft 开放字体类型，AKA OpenType）
*   eot（嵌入式 OpenType）
*   woff（Web 开放字体格式）
*   svg（可缩放矢量图形）

理想情况下，您希望尽可能多地使用 SVG，因为它提供了最佳质量，现代版本的 Andriod 浏览器、Firefix、Safari、Opera、Chrome 支持 SVG，但 IE 不支持。

就我个人而言，我会将字体转换为所有这些文件类型，看看结果是否有所改善，浏览器将自动使用他们喜欢的字体类型。您可以使用[Font 2 Web](http://www.font2web.com/)转换为其他格式，重要的是要注意字体受版权保护，您的客户需要许可，有些字体甚至不允许 Web 使用。

# c# - 使用实体框架缺少 SQLite 和 SQL Server CE 数据库文件

> ID：15588461
> 
> 赞同：0
> 
> 时间：2013-03-23T15:21:44.677
> 
> 标签：c#, entity-framework, sqlite, sql-server-ce

我首先使用实体​​框架代码，我的数据库文件显然没有被创建，至少不在磁盘上。我可以将数据库与我的程序一起使用，一切正常，唯一的问题是我找不到它自己的数据库文件，我想将其用于调试目的。

这是我的`DbContext`课：

```
public class HelperEntities : DbContext
{
        public HelperEntities() : base("HelperEntities") { }

        public DbSet<GuidModel> Guids { get; set; }
} 
```

连接字符串：

```
<add name="HelperEntities" connectionString="Data Source=NewDatabase.sdf;Encrypt Database=True;Password:nopassword1;" providerName="System.Data.SqlServerCe" /> 
```

SQL Server Compact Edition 和 SQLite 都会发生这种情况

# matlab - 按索引对值进行分组的快速方法是什么？

> ID：15588466
> 
> 赞同：4
> 
> 时间：2013-03-23T15:21:50.393
> 
> 标签：matlab

我有一个索引数组 I 和值 X，并且想要创建一个元胞数组 C，因此 C{i} = X(I==i)。计算 C 的最快和最好的方法是什么？

最直接的方法是评估`C{i} = X(I==i)`I 中的所有唯一 i（方法 1）：

```
for i = unique(I)
    C{i} = X(I == i);
end 
```

另一种天真的方法是遍历 I 中的所有 i 并将相应的 x 附加到 C（方法 2）：

```
C = cellfun(@(x)(zeros(1,0)),cell(1,max(indices)),'UniformOutput',false);
for j = 1:length(I)
    i = I(j);
    C{i} = cat(2,C{i},X(j));
end 
```

这两种方法都不是很快。为了进行基准测试，让我们生成一些测试数据：

```
I = floor(rand(1,N)*M)+1;
X = rand(1,N); 
```

采用`N = 1000000, M = 1000`这两种方法：

*   方法一：4.79 秒
*   方法 2：11.1 秒

在这里，方法 1 是最好的（仍然很慢）。更改问题的参数以`N = 1000000, M = 10000`显着改变事情：

*   方法一：48.5秒
*   方法 2：10.3 秒

基本上，这两种方法都太慢了几个数量级。评估 C 的最佳方法是什么？

**编辑：**正确的答案显然是乔纳斯的下面。我附上基准测试结果以供参考。与上述方法相比，C 中元素的顺序不同。除此之外，以下给出相同的输出：

```
C = accumarray(I',X,[],@(x){x'})'; 
```

*   `N = 100000, M = 1000`: 0.0397 秒
*   `N = 100000, M = 10000`: 0.145 秒

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T15:24:43.213

最快的编写方式（并且很可能是最快的运行方式）是`accumarray`

```
C = accumarray(I,X,[],@(x){x}); 
```

# c# - OpenID 提供者作为身份验证代理

> ID：15588467
> 
> 赞同：3
> 
> 时间：2013-03-23T15:21:52.120
> 
> 标签：c#, .net, authentication, openid, dotnetopenauth

我正在创建一个网站 .NET，它将为其用户提供特定服务。让我们称之为 service1.com。将来会有service2.com，他们将共享数据库。我还想通过提供使用 Google、Facebook、Twitter + 自定义注册的登录来进行用户友好的身份验证，以防用户没有使用 Google 等，以便他们可以注册。我将使用[DotNetOpenAuth](http://www.dotnetopenauth.net/)库。所以场景类似于SO。

现在谷歌有直接的问题：它[为不同的领域提供了不同的声明标识符](https://stackoverflow.com/questions/1031238/is-google-generating-new-openid-claimed-identifier-for-localhost)——这意味着我不能将它用作用户的 ID，但必须将电子邮件添加到图片中以解析用户（[就像 SO 正在做的那样](https://blog.stackoverflow.com/2010/04/openid-one-year-later/)）。

除此之外，这意味着我必须支持 Facebook Connect、Twitter 以及每个服务站点上的每个附加登录选项。

所以我想出了 OpenID 代理的想法：

*   我使用自己的独立数据库创建 OpenID 提供程序 openid.service.com
*   service1.com 和 service2.com 是其依赖方并共享自己的数据库
*   openid.service.com 可以通过各种不同的方式对用户进行身份验证：
    *   使用 openid.service.com 的新帐户[（基本注册，如 SO](https://openid.stackexchange.com/account/register)）
    *   OpenID（Gmail、Yahoo、...）
    *   脸书连接
    *   推特
    *   ...
*   登录选项和注册表单将显示在每个服务网站的 iframe 中（就像 SO 注册一样）
*   一旦 openid.service.com 通过任何选项对用户进行身份验证，它就会向依赖方回调提供声明的标识符

所以最终结果看起来像这样：![在此处输入图像描述](../Images/1257fbdf41310663ebde9d52b2253dc2.png)

**优点：**

*   服务可以使用 openid.service.com 提供的声明标识符来识别正在登录的用户
*   服务可以简单地添加到所需的域
*   添加更多登录选项是微不足道的，因为 openid.service.com 处理它
*   谷歌声称标识符不会改变，因为 openid.service.com 处理身份验证

**缺点：**

*   身份验证链更长（服务不直接通过 Google 进行身份验证等）
*   ？？？

这是实现这样一个系统的一种不错的方式吗？这是否还有其他缺点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T14:03:54.477

是的，这是解决这个问题的合理方法。事实上，我*认为*StackOverflow 做同样的事情。不使用 OpenID 的人的自定义用户数据库也位于 openid.service.com，因此实际上在这种情况下他们也会使用 OpenID，尽管他们不知道。

需要注意的一件事是，您的示例中的 openid.service.com 将*无法*断言来自 Google 和其他人的原始声明标识符，因为辅助 RP 不会接受来自您的中介的声明，因为它对那些声明的 ID 没有权限. 相反，您可以做的是openid.service.com 和每个辅助 RP 之间的*无身份验证OpenID。*是的，OpenID 实际上有一个流程，其中没有声称的标识符从 OP 传递到 RP——只有扩展。因此，您可以使用 DotNetOpenAuth`FetchRequest`和`FetchResponse`扩展在辅助 RP 和中央服务之间请求用户的实际 claim_id。辅助RP必须*非常*小心只接受来自您的中央 RP 的断言。

这是辅助 RP 和中央 RP 之间的代码草图：

第 1 步：RP 向 openid.service.com 请求用户身份验证

```
OpenIdRelyingParty rp;
var request = rp.CreateRequest("https://openid.service.com/");
request.IsExtensionOnly = true;
var fetchRequest = new FetchRequest();
fetchRequest.Attributes.AddRequired("http://openid.service.com/useridentity");
request.AddExtension(fetchRequest);
request.RedirectToProvider(); 
```

第 2 步：openid.service.com，作为 OP，接收请求（作为一个 OP 是一个巨大的责任......这是一个非常不完整的示例。您应该参考[可用的 OpenIdProvider 示例](http://sourceforge.net/projects/dnoa/)。）

```
OpenIdProvider op;
IRequest request = op.GetRequest();
/// ...
IAnonymousRequest anonRequest = request as IAnonymousRequest;
if (anonRequest != null) {
    // The key part for this sample snippet is that you make sure the RP asking
    // is one of your own, since you're not following the typical OpenID flow.
    if (!IsWhiteListedRealm(hostRequest.Realm)) {
        anonRequest.IsApproved = false; // reject all RPs that aren't in the whitelist
    } else {
        // Perhaps here is where you'll start your double role as an RP
        // to authenticate the user if there isn't already a FormsAuth cookie.
    }
}

return op.PrepareResponse(request).AsActionResult() 
```

第 3 步：辅助 RP 接收来自您的代理 OpenID 服务的响应。

```
OpenIdRelyingParty rp;
var response = rp.GetResponse();
if (response != null) {
    if (response.Provider.Uri.Authority != "openid.service.com") {
        throw new Exception(); // only assertions from our own OP are trusted.
    }

    if (response.Status == AuthenticationStatus.ExtensionsOnly) {
        var fetchResponse = response.GetExtension<FetchResponse>();
        string claimedId = fetchResponse.GetAttributeValue("http://openid.service.com/useridentity");
        FormsAuthentication.RedirectFromLoginPage(claimedId);
    }
} 
```

这些样本**并不完整**。并且上述内容不适用于担任这些角色的网站的许多正常实践安全缓解措施。这只是一个草图，概述了您的应用程序在特定情况下应采取的一些额外步骤。

# java - 在另一个项目中使用变量

> ID：15588469
> 
> 赞同：1
> 
> 时间：2013-03-23T15:22:34.700
> 
> 标签：java, android

我有一个名为“temp”的项目，我实现了一些类及其方法。

然后我创建了另一个名为“temp2”的项目，并包含了库“temp”，以便使用我在那里实现的类。

现在，如果我在“临时”项目中创建了一个类：

```
private SwipeListView swipeListView;   // SwipeListView  is a class declared in "temp2" project
private MyCustomAdapter adapter;   // class MyCustomAdapter is a class in "temp" project

swipeListView = (SwipeListView) findViewById(R.id.example_lv_list);
adapter =new MyCustomAdapter(text,listImages);  

swipeListView.setListenerAdaper(adapter);

adapter.someMethod();   //doesnt give me a nullpointerException 
```

在类中`SwipeListView`，我声明了方法`setListenerAdaper(BaseAdpter)`和`useAdapter()`：

```
private BaseAdapter listAdapter;

public void setListenerAdaper(BaseAdapter baseAdapter) {
    listAdapter = baseAdapter;
}

public void tempmethod() {
    useAdapter();
}

public void useAdapter() {
   listAdapter.someMethod();  //NullPointerException
} 
```

我想`listAdapter`在类中使用变量`SwipeListView`，但是每当我想在类中调用适配器的方法时`SwipeListView`，我都会得到一个`NullPonterException`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:45:21.020

If you need to import something from other project I think you need to consider a better architecture.

To achieve that you need to create a jar of the other project, make that variable a class and public one, and finally import it from the class you want to use it.

But as I mentioned before, you need to check your architecture in order to have a library with all the classes that will be used by several projects.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:33:25.390

如果变量在其他类上：

1.  导入其他类
2.  并将它们放在类路径上

如何设置类路径：

根据您的 JAR 文件在系统中的物理位置，单击 Project --> Properties --> Java Build Path -->（在这里您可以使用“Add JARs”或“Add External JARs”）。

# ios - 等待计时器或条件变为真然后处理代码？（等待iOS相机调焦）

> ID：15588472
> 
> 赞同：2
> 
> 时间：2013-03-23T15:22:46.217
> 
> 标签：ios, objective-c, grand-central-dispatch

我想在进行一些条件检查后处理一些代码。首先是一些变量必须是`true`（我有一个键值观察器分配给它）。其次 - 如果该变量已经有`true`一段时间没有变为（例如 5 秒），那么就不要理会该变量，只需处理代码即可。

我提出了一个明显的解决方案，我认为这很糟糕：`while()`另一个调度队列中的无限循环，每次检查`true`条件和时间过去。所有这些代码都包装在另一个调度队列中......好吧，对我来说看起来不太好。

我想做的伪代码草案：

```
WHEN (5 seconds are gone || getCurrentDynamicExpr() == true) {
    processStuff();
} 
```

这样做的正确和简单的方法是什么？

**编辑**

这里似乎有很多混乱......必须更具体：

我想在对焦时捕捉相机镜头，所以我想检查`AVCaptureDevice`' 的`isAdjustingFocus`属性（我正在使用`AVCaptureStillImageOutput`），然后捕捉镜头。5 秒是为了......好吧，如果它没有聚焦，那就是有问题，所以无论如何都要拍照。

我很抱歉造成混乱，认为这很常见..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-23T15:27:28.473

您可能会考虑一个`NSConditionLock`您可以在其上执行的操作`lockWhenCondition:beforeDate:`，或者可能安排某些事情在五秒内发生（例如，通过`NSTimer`或`dispatch_after`），以检查其他处理是否已经开始，其他处理是事件触发并设置标志。

编辑：

所以，为了记录：

```
const NSInteger kConditionLockWaiting = 0;
const NSInteger kConditionLockShouldProceed = 1;

[...]

conditionLock = [[NSConditionLock alloc] initWithCondition:kConditionLockWaiting];

[...]

dispatch_async(...
^{
    [conditionLock
         lockWhenCondition:kConditionLockShouldProceed
         beforeDate:[[NSDate date] dateByAddingTimeInterval:5.0]];

    // check the return condition to find out whether you timed out
    // or acquired the lock
});

[...]

- (void)observeValueForKeyPath:(NSString *)keyPath
        ofObject:(id)object change:(NSDictionary *)change
        context:(void *)context
{
    if(this is the appropriate property)
    {
        [conditionLock lock];
        [conditionLock unlockWithCondition:kConditionLockShouldProceed];
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-23T16:59:50.453

由于您无法控制`AVCaptureStillImageOutput`'s `isAdjustingFocus`（您不是将其设置为 true 或 false 的人），因此您不能使用我以前的答案（这就是我的意思是*我需要确切的情况：我们在等什么，以及为什么。实现细节取决于这些信息*）。

*恕我直言，最好的选择确实是按照您的建议*实施一些超时并等待它。一定要使用`usleep()`，这样你就不会连续轮询。

```
NSDate* date = [NSDate date];
while (TRUE)
{

   if (myBOOL)
   {
       // the condition is reached
       break;
   }

   if ([date timeIntervalSinceNow] < -5)
   {
    // the condition is not reached before timeout
    break;
   }

   // adapt this value in microseconds.
   usleep(10000);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-23T16:16:19.877

有几种方法可以在不同的抽象级别上做你想做的事情，使用 NSLock、调度障碍、NSOperation 依赖等等。但是由于您已经在使用 GCD，因此这些`dispatch_semaphore_*`功能将满足您的需求。

类似的东西（在我的脑海中，可能有错别字:)

```
 // this is the barrier one task will use to signal others that it's done.
  dispatch_semaphore_t mySemaphore = dispatch_semaphore_create(0);
  __block NSString *result = @"not done yet";
  // adjust these to change which task "wins":
  int hardTaskLength = 3;
  int timeoutSeconds = 5;

  // this is the first task:
  dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
    // do something slow and difficult
    sleep(hardTaskLength);
    result = @"now I am done";
    // then when we're done, let the world know:
    dispatch_semaphore_signal(mySemaphore);
  });

  // and this is the second, dependent one:
  dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
    dispatch_time_t timeout = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(timeoutSeconds * NSEC_PER_SEC));
    // wait for the first task to complete, or give up after a bit:
    BOOL timedOut = dispatch_semaphore_wait(mySemaphore, timeout);
    // now do stuff that wants the result of the first task
    if (timedOut)
      NSLog(@"Gave up waiting after %d seconds, result is: %@", timeoutSeconds, result);
    else
      NSLog(@"Processing finished; result is: %@", result);

    // these can happen wherever is appropriate, after everything is done:
    dispatch_release(mySemaphore);
    mySemaphore = 0;
  }); 
```

手册部分“Grand Central Dispatch 参考”包含有关信号量如何工作的更多信息。信号量本质上是一个线程安全的计数器；“发信号”将其加一，“等待”将其减一……除非计数器为零；然后“等待”停止并等待，直到其他东西再次增加计数器，然后递减并继续。

来自文档：“[在 dispatch semaphore_create] 中为值传递零对于两个线程需要协调特定事件的完成时很有用。” 这正是您正在做的事情。

**[编辑添加]：**

但是，根据问题中的其他信息，调度队列看起来对你正在做的事情来说太过分了。无论如何 UIKit 都必须在主线程上发生，所以请执行以下操作：

*   在 5 秒开始的时候，在你关心的属性上设置 KVO，并启动一个 5 秒的 NSTimer。
*   在KVO监听器中，拍照，取消定时器。
*   在计时器处理程序方法中，拍照，并注销 KVO 观察。
*   如果首先发生异常情况（取消按钮？）并且您需要中止，则两者都取消注册 KVO 取消计时器。

由于一切都发生在主线程上，因此不必担心争用，并且计时器会处理防止主线程阻塞的情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-23T16:34:54.000

我会`-[NSObject performSelector:withObject:afterDelay:]`用来处理超时部分。如果 KVO 更改通知在超时之前触发，只需使用`+[NSObject cancelPreviousPerformRequestsWithTarget:selector:object:]`取消超时。

不要阻止等待任何事情发生（就像你的`while`循环一样）。只需返回事件循环。当任何一种情况发生时，它都会调用你的代码。

# javascript - Internet Explorer 10 未显示 svg 路径（d3.js 图）

> ID：15588478
> 
> 赞同：20
> 
> 时间：2013-03-23T15:23:24.650
> 
> 标签：javascript, internet-explorer, svg, d3.js, internet-explorer-10

例如，如果我在 IE10 中打开此图：[http](http://bl.ocks.org/mbostock/1153292) : //bl.ocks.org/mbostock/1153292，我只是看不到节点之间的链接。

我可以在代码中做些什么来让即使使用 Internet Explorer 也能看到？

似乎 IE 只是忽略了 svg 的某些部分......我找不到任何方法让它可见。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-05-08T21:27:07.827

**概括：**

[IE](https://connect.microsoft.com/IE/feedback/details/781964/)中有一个错误会导致带有标记的路径无法正确呈现。[删除标记](http://jsfiddle.net/niaconis/3YsWY/8/)的原始代码呈现没有问题。

有三种解决方案：

1.  不要使用标记
2.  像这样在路径中嵌入标记：http: [//jsfiddle.net/niaconis/3YsWY/9/](http://jsfiddle.net/niaconis/3YsWY/9/)
3.  等待微软修复此错误

选项 2，虽然有点难看，但可能是最可行的。

* * *

**原帖：**

不幸的是，我发现詹姆斯的答案只适用于静态 svg。

我从原始示例中提取了 css 和 javascript 并将它们放在 jsfiddle 中。链接在 Chrome 26 中正确显示（这是我的控制测试），但在 IE 10 中根本没有显示（如预期的那样）。然后我根据詹姆斯给出的答案编辑了处理链接创建的javascript：

```
var path = svg.append("svg:g")
    .attr("fill", function(d) { return "none"; }) /*new*/
    .attr("stroke-width", function(d) { return "1.5px"; }) /*new*/
    .attr("stroke", function(d) { return "#666"; }) /*new*/
    .selectAll("path")
    .data(force.links())
    .enter().append("svg:path")
    .attr("class", function(d) { return "link " + d.type; })
    .attr("marker-end", function(d) { return "url(#" + d.type + ")"; }); 
```

这确实为`<g>`元素添加了指定的属性，但对“实时”图的显示没有影响。（现在回头看看，我注意到“静态”图表在 IE10 中显示链接，即使没有这些属性，如[这里](http://codepen.io/anon/pen/jgHft)所示。）

通过使用 IE 的开发人员工具栏，我能够使链接在 IE10 中可见（甚至直接在[原始示例中）。](http://bl.ocks.org/mbostock/1153292)我`<path>`在 DOM 中找到了其中一个标签，然后在右侧的样式选项卡中未选中并重新选中了“path.link”样式。

这会显示链接，但随后与图表的任何交互都会断开标记与链接末端的连接。它们只是留在原地，我没有发现任何东西可以让它们重新连接。

我能找到的唯一相关信息来源是这个 SO 帖子：[Element doesn't appear in IE7 until I edit it through Developer Toolbar](https://stackoverflow.com/questions/11714340/element-doesnt-appear-in-ie7-until-i-edit-it-through-developer-toolbar)
但是，我对 svg 还很陌生，所以我一点也不知道如何将那里描述的修复移植到 svg（该修复是针对 html 元素的）

也许这会帮助某人朝着正确的方向前进？

PS我知道这不完全是一个答案，我只是将其发布为对詹姆斯答案的回复，但似乎我没有足够的声誉来做到这一点。=\

* * *

**更新：**

事实证明，这个问题完全与标记有关。[这个小提琴](http://jsfiddle.net/niaconis/3YsWY/8/)是原始代码，但删除了标记，链接显示得很好。标记问题之前已[记录](https://stackoverflow.com/questions/15693178/svg-line-markers-not-updating-when-line-moves-in-ie10)，是 IE10 的一个严重错误。为什么它也会导致链接消失，我不知道。

[这个小提琴](http://jsfiddle.net/niaconis/3YsWY/9/)提供了一种解决方法。这不是最干净的解决方案，因为我已将每个标记直接编码到其链接路径中，但它可以工作。

如果有人可以找到标记问题本身的解决方法，那就更好了，并且应该另外将其发布为[其他标记问题](https://stackoverflow.com/questions/15693178/svg-line-markers-not-updating-when-line-moves-in-ie10)的答案。

（另请注意：我的解决方案使虚线链接看起来很糟糕，所以我将它们改为浅蓝色。）

这个错误已经报告给微软，但到目前为止他们似乎已经[否认或忽略](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/f772aab3-5ce3-4367-8eec-4fe58ad94b14/)了它。请转到Microsoft 问题跟踪器网站上的[此帖子](https://connect.microsoft.com/IE/feedback/details/781964/)，然后单击指示您可以重现此错误的链接。也许我们可以引起他们的注意？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-27T20:39:48.793

[另一个标记问题](https://stackoverflow.com/questions/15693178/svg-line-markers-not-updating-when-line-moves-in-ie10)由 Christian Lund 提供了一个很好的答案，这对我非常有效。

为了省去你去那里的麻烦，这里是事情的要点：

在我的力动画中，我有一个`tick`如下所示的函数：

```
force.on("tick", function() {
  ...
}); 
```

我还将所有图表链接保存在`link`变量中，定义如下：

```
var link = svg.selectAll(".link").data(links).enter() ... 
```

现在，为了实现 Christian 建议的魔法，我在`tick`函数的开头添加了这一行：

```
force.on("tick", function() {
  link.each(function() {this.parentNode.insertBefore(this, this); });
  ...
}); 
```

我完好无损地保留了所有标记。这个小小的奇迹所做的是，在动画的每个滴答声中遍历所有链接节点，并将它们重新添加到 DOM 中。这会导致 IE 10 重新渲染它们，一切都很好。

这似乎修复了 IE 10 问题...当然建议仅在 IE 10 上添加此补丁

如果这对您有用，请不要忘记转到另一个问题并给克里斯蒂安投赞成票

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-04T14:38:22.510

我不确定这是否已经解决，但在我比较的所有浏览器中，该图看起来几乎与我相同。我没有 IE10，但在 IE9 中看起来不错，我在[NetRenderer 的](http://netrenderer.com/index.php)IE10 上测试了图形的静态副本，看起来也不错。

我能看到的唯一区别是 IE 没有为某些链接显示实心箭头，只需为这些标记类型设置填充样式即可轻松解决。

```
marker#suit {
  fill: black;
}
marker#resolved {
  fill: black;
} 
```

**更新：**

查看您添加的图像，这绝对不是我在 IE9 或 NetRenderer 的 IE10 版本中看到的。你试过多台电脑吗？这可能是您的设置特有的吗？

在无法重现问题的情况下很难提出建议，但您可能想尝试的一件事是直接在 SVG 中设置路径属性，而不是通过 CSS。

所以在第一个`g`元素上你会有这样的东西：

```
<g fill="none" stroke-width="1.5px" stroke="#666"> 
```

这是一个使用静态版本标记的[codepen 示例。](http://codepen.io/anon/pen/iAwoG)如果您想自己在 NetRenderer 中进行测试，这里是完整的[url 。](http://codepen.io/anon/fullpage/iAwoG)

即使这不是一个理想的解决方案，至少知道这是否有任何不同是有帮助的。

# c++ - SQL Server 2012 通过 Windows 的本机 C++（无 ATL）首选访问方法

> ID：15588485
> 
> 赞同：4
> 
> 时间：2013-03-23T15:24:19.007
> 
> 标签：c++, sql-server, odbc, oledb

我有一个在 Windows 64 下运行的本机 C++ 应用程序，它不使用 ATL（也不会）。我希望能够通过网络从我的应用程序连接到 SQL Server 2012。

我有以下要求：

*   性能是关键

*   C++ 只会插入记录（比如通过调用存储过程），不会插入其他记录（没有选择、删除或更新）。

*   记录插入应该是非阻塞的（异步）。

我将选择范围缩小到 OLE DB 和 ODBC，因为它们满足上述标准。然而，互联网上似乎有很多关于使用什么的相互矛盾的建议。例子：

*   “如果您可以选择使用 ODBC 或 OLE DB 来访问您的 SQL Server 数据库，请选择 OLE DB，因为它通常更快。[7.0, 2000, 2005] 更新于 2-20-2006”来源：[http://www .sql-server-performance.com/2007/odbc-oledb/](http://www.sql-server-performance.com/2007/odbc-oledb/)

*   “OLE DB 已弃用”来源：[http ://weblogs.sqlteam.com/dang/archive/2011/09/04/rip-ole-db.aspx](http://weblogs.sqlteam.com/dang/archive/2011/09/04/rip-ole-db.aspx)

*   “避免将 OLE DB 用于新的 SQL Server 应用程序开发。更新您的技术路线图，以将使用 SQLNCLI、SQLNCLI10、**SQLNCLI11**或 SQLOLEDB OLE DB 提供程序的现有 SQL Server 应用程序迁移到 SQL Server Native Client ODBC 驱动程序。” 来源：[http](http://weblogs.sqlteam.com/dang/archive/2011/09/04/rip-ole-db.aspx) : //weblogs.sqlteam.com/dang/archive/2011/09/04/rip-ole-db.aspx 但 SQLNCLI11 是基于 MSDN 的 SQL Server Native Client ODBC 驱动程序：http: [//msdn.microsoft .com/library/ms130904.aspx](http://msdn.microsoft.com/library/ms130904.aspx)那么，这是博客中的错字吗？

**我真的很困惑，想就我的标准访问 SQL Server 的最佳技术发表更多意见。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T20:36:20.263

OleDB 和 ODBC 都使用 SQLNCLI。请参阅[按版本列出的组件名称和属性](http://msdn.microsoft.com/en-us/library/ms131291.aspx)表，观察 Sqlncli.dll/Sqlncli10.dll/Sqlncli11.dll 如何成为 ODBC 和 OleDB 的驱动程序。

如果您查看[数据访问技术路线图](http://msdn.microsoft.com/en-us/library/ms810810.aspx#bkmk_CurrentMDAC_WDACArch)，您会发现 ODBC 和 OleDB 都是最新的并受支持。不[推荐使用](http://msdn.microsoft.com/en-us/library/ms810810.aspx#bkmk_DepMDAC_WDACComps)的是 SQLOLEDB 和 SQLODBC，它们是用于 OleDB 和 ODBC 的旧 MDAC SQL Server 驱动器（即 sqlsrv32.dll 和 Sqloledb.dll）。对于它们都有升级路径和建议，请参阅[从 MDAC 将应用程序更新到 SQL Server Native Client](http://msdn.microsoft.com/en-us/library/ms131035.aspx)。

所以结论是您可以安全地继续使用 ODBC 和 OleDB，只要确保您使用基于现代 SLNCLI 的驱动程序，而不是旧的、已弃用的 MDAC 驱动程序。

使用已弃用的驱动程序的主要风险是缺乏对新数据类型（例如地理、层次结构、日期时间2 等）的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T20:46:54.403

多年前我体验过 OleDB（使用 ATL）和 ODBC（使用 MFC）。

但是接口很少是瓶颈，通常插入/更新占主导地位（实际上，我使用批量复制+存储过程执行了大型插入/更新）。

无论如何，我会建议一种中间（第三种？）方式：[OTL](http://otl.sourceforge.net/)，这使得 C++ / ODBC 可以忍受。

# javascript - ASP.NET MVC 将部分视图呈现为字符串以返回 JSON

> ID：15588488
> 
> 赞同：7
> 
> 时间：2013-03-23T15:24:24.793
> 
> 标签：javascript, c#, jquery, asp.net-mvc, asp.net-mvc-4

所以我有一个完整的方法，我在整个网站上都使用它：

```
public PartialViewResult GetBlogEntries(int itemsToTake = 5)
{
    ...
    return PartialView("_BlogPost", model);
} 
```

现在我想从我的 javascript 中以 JSON 形式获取它。

```
public JsonResult GetBlogPostJson()
{      
    var blogEntry = GetBlogEntries(1);
    var lastEntryId = GetLastBlogEntryId();
    return Json(new {Html = blogEntry, LastEntryId = lastEntryId}, JsonRequestBehavior.AllowGet);
} 
```

想法是这样得到它：

```
$.ajax({
            url: '/Blog/GetBlogPostJson',
            dataType: 'json',
            success: function (data) {
                var lastEntryId = data.LastEntryId;
                var html = data.Html;
                ...
            }
        }); 
```

问题是这当然不会产生一个字符串，而是一个 PartialViewResult。

问题是，如何将 PartialViewResult 解析为可以用 JSON 发回的 html？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-23T15:30:15.500

我大约在 6 个月前经历过这个。目标是使用部分填充 jquery 弹出对话框。

问题是视图引擎想要以自己尴尬的顺序渲染它们......

试试这个。LMK 如果需要澄清。

```
 public static string RenderPartialViewToString(Controller thisController, string viewName, object model)
    {
        // assign the model of the controller from which this method was called to the instance of the passed controller (a new instance, by the way)
        thisController.ViewData.Model = model;

        // initialize a string builder
        using (StringWriter sw = new StringWriter())
        {
            // find and load the view or partial view, pass it through the controller factory
            ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(thisController.ControllerContext, viewName);
            ViewContext viewContext = new ViewContext(thisController.ControllerContext, viewResult.View, thisController.ViewData, thisController.TempData, sw);

            // render it
            viewResult.View.Render(viewContext, sw);

            //return the razorized view/partial-view as a string
            return sw.ToString();
        }
    } 
```

# c++ - 在 C++ 中使用 for 循环对系列求和

> ID：15588492
> 
> 赞同：2
> 
> 时间：2013-03-23T15:24:29.880
> 
> 标签：c++

我想计算以下系列的总和：

```
5 + 8 + 11 + .... + 50 
```

我希望使用 for 循环来打印上述系列和系列的总和。我写了以下代码：

```
#include <iostream>
using namespace std;

int main()
{
    int i, sum = 0, n = 50;
    cout << "\n\n THE SERIES IS UNDER : \n\n\n";
    i = 2;
    while(i <= n)
    {
        sum = sum + i;
        if (i == 2)
            cout << i;
        else
            cout << " + "<< i;
        i = i + 3;
    }
    cout << "\n\n\n THE SUMMATION IS "<< sum;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:29:48.620

```
cout<<"\n\n\n THE SUMMATION IS ",sum; 
```

->

```
cout << "\n\n\n THE SUMMATION IS " << sum; 
```

和

```
cout<<" + ",i; 
```

->

```
cout << " + " << i; 
```

逗号 ( `,`) 运算符在这里不像流 ( `<<`) 运算符那样工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-23T15:32:36.120

```
#include<iostream>
using namespace std;

int main()
{
    cout << "\n\n THE SERIES IS UNDER : \n\n\n";

    int sum = 0;
    for (int i = 5; i < 50; i += 3) {
        cout << i << '+';
        sum += i;
    }
    cout << 50 << endl;
    sum += 50;

    cout << "\n\n\n THE SUMMATION IS " << sum << endl;
    return 0;
} 
```

此版本的变化：

1.  包括`iostream`而不是`iostream.h`; [这在编译器之间更具可移植性](http://members.gamedev.net/sicrane/articles/iostream.html)
2.  在这里使用 `for`循环更加简洁明了。
3.  测试`if (i == 2) cout << i;`是浪费时间，因为它只适用于一次迭代。相反，您可以将第一项或最后一项作为`for`循环外的特殊情况处理。
4.  使用`sum += i`代替`sum = sum + i`，因为前者更清晰有效。大多数程序员会默认选择前一种。
5.  通常你想`cout << endl`在 C++ 中使用。`'\n'`和之间是有区别的`endl`，除非你有理由不这样做。请参阅帖子：[C++：“std::endl”与“\n”](https://stackoverflow.com/questions/213907/c-stdendl-vs-n)

# aspectj - 将 AspectJ 开发工具插件 (AJDT) 安装到 Eclipse

> ID：15588498
> 
> 赞同：0
> 
> 时间：2013-03-23T15:25:10.983
> 
> 标签：aspectj, ajdt

我正在尝试将 AspectJ 开发工具插件 (AJDT) 安装到 Eclipse (v3.8) 中。

我的目标是实现此网页所示的结果：https: [//www.gorillalogic.com/monkeytalk-documentation/monkeytalk-getting-started/install-agent/android](https://www.gorillalogic.com/monkeytalk-documentation/monkeytalk-getting-started/install-agent/android)。
我已经尝试过此网页[http://www.venukb.com/2006/08/20/install-eclipse-plugins-the-easy-way/](http://www.venukb.com/2006/08/20/install-eclipse-plugins-the-easy-way/)上描述的方法。

无济于事。eclipse 中的安装/卸载对话框表明插件已被 eclipse 看到，但我没有得到所需的菜单项出现的结果。我也使用了 dropins 文件夹。我显然做错了什么。

我看过类似的问题，例如[Eclipse 没有在 dropins 文件夹中加载插件](https://stackoverflow.com/questions/1489648/eclipse-doesnt-load-plugins-in-the-dropins-folder)仍然无济于事。

任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T03:17:32.750

我不建议使用 dropins 文件夹，因为它不支持 AJDT 在安装时需要做的所有事情。

您可以通过转到帮助 -> 关于 Eclipse... 或 Eclipse -> 关于 Mac 上的 Eclipse 来检查插件是否已安装。

如果正确安装了 AJDT，您将在对话框中看到 AJ 图标。接下来，确保启用了 JDT 编织。去 Preferences -> JDT weaving 看看。

如果这些事情中的任何一个出现问题，请查看您的错误日志。并查看您是否在安装时遇到任何问题。

# java - 字符串排列解释？

> ID：15588499
> 
> 赞同：0
> 
> 时间：2013-03-23T15:25:11.370
> 
> 标签：java, string

我正在查找如何执行字符串排列并找到下面的解决方案。但是我很难理解所使用的逻辑。尤其是这一行。**for(final String permutation : Permuatations(subList(head,words)))**据我所知，作者是在其自身“Permutations”上调用一个函数来执行其中的 subList 函数，这很难让我理解。谁能让我更清楚一点？任何指导将不胜感激。

```
public static void main (String [] args)
    {
        for(final String s: Permuatations(Arrays.asList("This ","is ","String ")))
                {
            System.out.println("6\. THE FINAL OUTPUT " +s);
                }
    }

    public static List<String> Permuatations(final List<String> words)
    {
        final List<String> perms = new ArrayList<String>();
        if (words.size() == 1)
        {
             perms.add(words.get(0));
             System.out.println("3\. permuatations if words " + words);
             System.out.println("4\. PERMS LIST " + perms);
        }

        else
        {
            for(final String head : words)
            {
                for(final String permutation : Permuatations(subList(head,words)))
                {
                    perms.add(head + permutation);
                    System.out.println("5 .SubList HEAD " + head + " PERMUATATION " + permutation  + " Word Size " + words.size() );
                }
            }
        }
        return perms;
    }

public static List<String> subList(final String elementToRemove, final List<String> elements)
{
    final List<String> subList = new ArrayList<String>();
    for(final String s : elements)
    {
        //System.out.println(" 1\. STRING s " + s + " ELEMENTS " + elements);
        if(!s.equals(elementToRemove))
        {
            System.out.println(" 1\. STRING S " + s + " ELEMENTS " + elements);
            subList.add(s);
            System.out.println("2 STRING S " + s + " TO SUBLIST " + subList);
        }

    }

    return subList;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:35:11.790

这正是他们正在做的事情。它被称为递归，一开始很难理解。想象一下你有字符串：

A B C D

实际上，您所做的就是依次选择每个字符串，然后找到剩余字符串的所有排列，并预先添加您选择的字符串。

```
Choose A, get all permutations of {B,C,D} and append A. 
Choose B, get all permutations of {A,C,D} and append B. 
Choose C, get all permutations of {A,B,D} and append C. 
Choose D, get all permutations of {A,B,C} and append D. 
```

现在，我们的子问题看起来非常相似，但更小。这就是递归的核心。拿一个问题，想办法把它变成一个更小的问题。现在，继续把它变成一个小问题，直到它变得微不足道。现在我们必须弄清楚如何生成 3 个字符串的排列。

```
Permute(A B C) 
Choose A, get all permutations of {B,C} and append A.
Choose B, get all permutations of {A,C} and append B.
Choose C, get all permutations of {A,B} and append C. 
```

结构相同，但问题更小。所以更进一步。我们如何进行置换(AB)

```
Permute(A B) 
Choose A, get all permutations of {B} and append A.
Choose B, get all permutations of {A} and append B. 
```

所以现在我们只需要置换一个字符串。那是微不足道的。

```
Permute(A)
A 
```

所以现在我们有一种方法来置换大小为 1 的字符串列表，并且我们已经定义了如何通过置换大小为 N-1 的列表来置换大小为 N 的列表。因此，我们可以置换任何大小 >= 1 的列表，方法是用稍微小一点的问题版本来称呼我们自己。这就是递归的美妙之处。您只需定义如何解决最小的问题，以及如何使用该解决方案来构建更大的解决方案，并且它建立在自身之上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:43:49.607

This is a recursive algorithm, it essentially takes each element in the array as the first one then adds to to it the output of calling itself without that element.

Take 3 elements A, B and C and walk through the logic, lets call our function `perm`.

so, we want

```
perm({A, B, C}) 
```

this equals

```
A + perm({B, C})
B + perm({A, C})
C + perm({A, B}) 
```

expand again

```
A + B + perm({C})
A + C + perm({B})
B + A + perm({C})
B + C + perm({A})
C + A + perm({B})
C + B + perm({A}) 
```

as `perm({X}) = X` we end up with

```
A + B + C
A + C + B
B + A + C
B + C + A
C + A + B
C + B + A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:44:36.327

The scheme used is "divide and conquer". It's basic idea is to break up a big problem into a set of smaller problems to which the same mechanism is applied until an "atomic" level of the problem is reached. In other words: A problem of size n is broken up into n problems of size n-1 continuously. At the bottom there is a simple way of dealing with the problem of size 1 (or any other constant). This is usually done using recursion (as Calgar99) pointed out already.

A very nice example of that scheme that will also twist you head a bit are the "Towers of Hanoi". Check it out and the ingenuity of such an approach will hit you.

As for the presented code: The permutation of n words is the concatenation of the permutation of n-1 words with each of the n original words. This recursive definition represents a quite elegant solution for the problem.

# android - Android 蓝牙聊天应用程序意外停止

> ID：15588502
> 
> 赞同：1
> 
> 时间：2013-03-23T15:25:40.440
> 
> 标签：android, forceclose

我即将创建一个蓝牙聊天应用程序。我将它安装在我的手机上，启动它时，它会显示一条错误消息，其中包含一个强制关闭按钮。我的启动活动没有显示错误。下面给出：

```
package com.group6.abc;

import android.app.Activity;
import android.bluetooth.BluetoothAdapter;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;

public class MainActivity extends Activity{

private BluetoothAdapter mBluetoothAdapter=null;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
    if(mBluetoothAdapter==null){
        Toast.makeText(this, "Bluetooth Is Not Available", Toast.LENGTH_LONG).show();
        finish();
        return;
    }

    Button btn_start=(Button) findViewById(R.id.start);
    btn_start.setOnClickListener(new View.OnClickListener() {
        public void onClick(View arg0) {
            Intent intent=new Intent(MainActivity.this,FirstActivity.class);
            startActivity(intent);
        }
    });
}       

public void onStart(){
    super.onStart();
    if(!mBluetoothAdapter.isEnabled()){
        Intent enableIntent=new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableIntent,3);
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
    }
} 
```

我这边有什么错误吗？任何人请帮助我。

谢谢...

# iphone - iAd 横幅将我的视图旋转到横向

> ID：15588503
> 
> 赞同：1
> 
> 时间：2013-03-23T15:25:40.927
> 
> 标签：iphone, ipad, iad, uiinterfaceorientation, adbannerview

我的应用程序中的视图仅是纵向的 - 我的视图控制器和根视图控制器都确保它们仅使用两者旋转到纵向方向`shouldAutorotateToInterfaceOrientation:`，`supportedInterfaceOrientations`以便同时支持 iOS 5 和 iOS 6。我在视图中添加了 iAd 横幅，它正确显示在屏幕顶部。当我点击它以在 iPad 上查看测试广告时，测试广告以横向显示，这是我所期望的 - 我知道 iAd 可能是任何方向的。但是当我关闭广告时，我的视图是横向的，带有横幅的视图和根视图控制器的视图。当我旋转设备时，它们会旋转回纵向并停留在那里。

如何防止 iAd 旋转我的视图，或在 iAd 关闭时让我的视图恢复为纵向？

**编辑：**我也尝试过使用`application:supportedInterfaceOrientationsForWindow:`并设置`shouldAutoRotate`为 true - 都不能解决问题。

**再次编辑：**我仍然没有运气。[这是一个](http://www.filedropper.com/badbanner)具有相当少的视图控制器实现的项目，它显示了我遇到的错误 - 感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T12:49:08.040

我会尝试两件事。首先在应用程序的目标配置（摘要）中设置“支持的界面方向”。

然后对于界面构建器中的每个视图，在模拟指标（属性面板上的 4 个选项卡）下确保选择了纵向。如果您选择了“推断”，那么它将在显示自身时采用先前的屏幕方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T23:40:22.957

解决了。我的辅助视图控制器必须是主视图控制器的子视图控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-25T12:34:15.193

我以为我会推送更新，因为我终于修复了这个问题，这适用于 iOS 8 和 9，首先注册应用程序以跟踪设备方向。

AppDelegate.m:

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

    [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];

    return YES;
} 
```

现在，当广告完成显示时，您可以检查设备方向并将其强制恢复为纵向。

```
-(void)bannerViewActionDidFinish:(ADBannerView *)banner{

            UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];

            if (UIDeviceOrientationIsLandscape(orientation)) {

                NSNumber *value = [NSNumber numberWithInt:UIInterfaceOrientationPortrait];
                [[UIDevice currentDevice] setValue:value forKey:@"orientation"];
            }

            //NSLog(@"iAD actions finished");
    } 
```

# ios - 当视图被寻址或动画时，视图背景缩小

> ID：15588504
> 
> 赞同：0
> 
> 时间：2013-03-23T15:26:05.057
> 
> 标签：ios, animation, uiview

我找不到为什么我的子视图的背景在我第一次移动它或为其设置动画时会向子视图的左上角缩小。（不确定它在技术上是否是“子视图”，因为我拖到主视图上的对象被标记为“视图”）

对于此示例，我将提供一个动画示例，以便您可以更轻松地了解发生了什么。

这是我的 .h 条目（2 个对象，一个按钮和一个视图）

```
@property (weak, nonatomic) IBOutlet UIView *floatPad;
- (IBAction)toggleButton:(UIButton *)sender; 
```

对于此示例 (iPad)，视图位于 (20, 800)，大小为 (728, 186)。我还在 Interface Builder 中将背景设置为浅灰色，以更好地显示正在发生的事情。

该按钮在屏幕上打开和关闭视图，通过屏幕底部滑动（通过动画代码）关闭和打开。

这是我的 .m 条目（1 个 BOOL、1 个 UIColor，加上“viewDidLoad”和“toggleButton”代码）

```
@interface ViewController ()

@property (assign, nonatomic) BOOL floatPadVisible;
@property (retain, nonatomic) UIColor* redBackground;

@end

@implementation ViewController

@synthesize floatPad;
@synthesize floatPadVisible;
@synthesize redBackground;

- (void)viewDidLoad {
floatPadVisible:YES;
    redBackground = [UIColor colorWithRed:179/255.0 green:1/255.0 blue:54/255.0 alpha:1.0];

    [super viewDidLoad];
}

- (IBAction)toggleButton:(UIButton *)sender {

if (floatPadVisible) { //is floatPadVisible BOOL set to YES
    [UIView beginAnimations:@"floatPad" context:nil];
    [UIView setAnimationDuration:1.5];
    [UIView setAnimationDelegate:self];
    [floatPad setFrame:CGRectMake(20, 1004, 584, 145)];
    [floatPad setBackgroundColor:redBackground];
    [UIView commitAnimations];
    floatPadVisible = NO;
    }
else {
    [UIView beginAnimations:@"floatPad" context:nil];
    [UIView setAnimationDuration:1.5];
    [UIView setAnimationDelegate:self];
    [floatPad setFrame:CGRectMake(20, 800, 584, 145)];
    [UIView commitAnimations];
    floatPadVisible = YES;
    }
} 
```

问题是您第一次点击切换按钮时，视图不会移动，只有背景缩小。我说缩小，因为您仍然可以在视图左侧的 20 点空间。如果你把一个对象放在视图中，它不会移动，这告诉我视图没有缩小，只有背景。在第一次“切换”之后，按钮按预期运行。我添加了背景更改颜色代码，以表明第一个切换从不调用动画代码，这从背景在第二个切换之前不会改变颜色这一事实就可以看出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T02:08:14.543

我不知道这种情况多久发生一次，但我可以在盯着这个问题几个星期后回答我自己的问题。如果你看我描述添加视图的顶部，我给它尺寸（728、186）。但是我自己的动画代码将框缩小到 (584, 145)。

至于为什么第一次点击切换按钮不会改变背景，那是因为我相信我正在使用语法将'floatPadVisible'标志设置为YES：

```
floatPadVisible:YES; 
```

实际上它不是第一次通过该方法时，它会运行不可见的代码。

# encoding - 自定义编码和压缩

> ID：15588510
> 
> 赞同：1
> 
> 时间：2013-03-23T15:26:50.427
> 
> 标签：encoding, character-encoding, compression

这是一个新手提出的两部分问题。

首先，我需要一个简单文本的编码（没有小写/大写的区别），并且我需要它比 ASCII 更节省空间。所以我想创建自己的 5 位代码，包含 32 个字符（字母加上一些标点符号）。据我了解，所有现代计算都以字节为单位“思考”，因此如果不使用 8 位编码，我实际上无法定义自己的 5 位编码。

我想做的是：我定义自己的 5 位代码，并将文本保存在 3 个字符块中，每个块保存为 2 个字节。每个块将占用总共 15 位，将存储在两个字节内（保存 16 位）。我可能会使用额外的位进行奇偶校验，即使我实际上并不需要它。这种方法有意义吗？或者有没有更好的方法？或者，我可以定义一个 6 位编码，并将文本保存到每个 4 个字符的块中，每个块保存在 3 个字节中。

问题的第二部分是：假设随后将压缩文本（通过文本的标准无损算法，例如 zip），是否值得我自己创建编码的麻烦（如上所述）？或者压缩算法是否会处理 8 位编码的空间效率低下，使压缩文件与最初使用 5 位或 6 位编码编码的压缩文件一样高效？如果是这样，对预压缩文本使用 5/6 位编码将没有任何优势，因此我将完全跳过这一步。我需要从有经验的程序员那里知道，这是什么情况？

感谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T19:20:31.170

压缩算法将更有效地为您处理编码。它将使用霍夫曼、范围或算术编码来使用可变数量的位，甚至是小数位，每个字母，利用您的实际数据的统计数据。*如果您不*尝试对字符进行预编码，将它们填充到每个小于 8 位，这将工作得更好。压缩算法通过在每个字节中找到的符号计算统计信息，并在字节中寻找重复模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T19:21:08.673

1.  您无需担心“块”。只需将 5 位附加到 8 位缓冲区，当此缓冲区被填充时，将其刷新并将任何剩余位推入缓冲区。
    唯一的歧义出现在消息的末尾，当您可能有一个部分填充的缓冲区且尚未填充的位数 >= 5 时。因此
    ：您必须指定消息的长度（n*5 位）或
    b。您必须仅指定尾随位的长度（更有效）

2.  压缩算法实际上可能会受到您的自定义打包的不利影响 - （取决于文本等原始数据的类型）。

# wordpress - wp_enqueue_style 仅针对单数 arra(posttype) 有条件地添加

> ID：15588511
> 
> 赞同：0
> 
> 时间：2013-03-23T15:26:54.200
> 
> 标签：wordpress, styles

我正在尝试使用 is_singular(array()) 仅将某些帖子类型的样式排入队列，但是当我定义帖子类型静态时它可以工作，而当我使用 get_option 添加时它不起作用。

这是我的代码。

```
// load front end scripts
function rm_scripts() {

    $types = new review_media_system;
    $ptpys = $types->rm_allow_types();

    echo $ptpys;

    if(!is_admin()){
       wp_enqueue_style('rm-stylesheet', RM_URL.'css/rm-style.css',null, 1);

       if(is_singular(array($ptpys))){
            wp_enqueue_style('rm-admin_gallery_css', RM_URL.'css/responsiveslides.css',null, 1);                    
       }
    }    

}
add_action('wp_enqueue_scripts', 'rm_scripts'); 
```

# delphi - 如何在 Delphi 中将颜色减少到指定数量？

> ID：15588515
> 
> 赞同：1
> 
> 时间：2013-03-23T15:27:11.150
> 
> 标签：delphi, colors, bitmap, reduction, quantization

如何在 Delphi 中将颜色减少到指定数字（<=256）？我不想只使用：

```
 Bmp.PixelFormat := pf8bit; 
```

因为那样我无法控制颜色的数量。我不想抖动，因为我已经知道如何抖动 256 或更少颜色的图像。

我发现了这个[Median Cut 实现](http://www.programmersheaven.com/download/15370/Download.aspx)，但它是 1990 年的纯 Pascal 并且：

1.  不能在 Delphi 中编译
2.  说它是共享软件，售价 25 德国马克
3.  看起来（不知何故）不必要的复杂

我只想减少`TBitmap32`（Graphics32 位图类，仅支持 32 位颜色）到 <= 8 位 bmp。我不需要减少到 15/16 位，我不需要从 24 或 15/16 位图像减少。仅 32 位 => 8 位-

我使用的德尔福：7、2005、XE3。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-23T16:11:13.033

一种快速实施、具有多种选择的廉价方法是使用 TGIFImage

```
uses
  gifimg;

 Procedure ReduceTo8Bit(var bmp:TBitmap; ColorReduction: TColorReduction; DitherMode: TDitherMode);
var
 GI:TGifImage;
begin
   GI:=TGifImage.Create;
   try
     GI.DitherMode := DitherMode;
     GI.ColorReduction := ColorReduction;
     GI.Assign(bmp);
     bmp.Assign(GI.Bitmap);
   finally
     GI.Free;
   end;
end; 
```

测试

```
procedure TForm3.Button2Click(Sender: TObject);
var
 bmp:TBitmap;
begin
  bmp:=TBitmap.Create;
  try
     bmp.LoadFromFile('C:\bilder\bummi.bmp');
     ReduceTo8Bit(bmp,rmQuantizeWindows,dmSierra);
     bmp.SaveToFile('C:\bilder\bummi_8bit.bmp');
  finally
    bmp.Free;
  end;
end; 
```

如果必须设置每个像素的位数，则更简单的方法是使用来自 gifimg 的 ReduceColors 和 rmQuantize

```
// BytesPerPixel integer with range of Range 3 - 8

DestBMP := ReduceColors(SourceBMP,rmQuantize,dmNearest,BytesPerPixel,0); 
```

# jquery - Div 从特定位置到fadeIn()？

> ID：15588521
> 
> 赞同：0
> 
> 时间：2013-03-23T15:28:10.190
> 
> 标签：jquery, css

我编写了下面的代码将 div 向左移动 250px，然后淡出。现在我想要的是，在它在 250px 上淡出之后，它将再次从它的原始位置淡入，例如 0px，然后向左移动 250px，然后淡出。我以单个 div 为例，但基本上我有多个 div，例如可能是 5 个 div，我希望它们从左到右移动并消失，然后再次从原始位置淡入。

```
<!DOCTYPE html>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
</script>
<script> 
$(document).ready(function(){
 setInterval(callMe,100);
});

function callMe(){
 $("div").animate({left:'250px'});
 $("div").fadeOut();
}
</script> 
</head>

<body>
<button>Start Animation</button>
<br/><br/>
<div style="background:#98bf21;height:100px;width:100px;position:absolute;">
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:31:57.583

检查你是否想要这样的东西

```
function callMe(){
 $("div").animate({left:'250px'});
$("div").fadeOut();
$("div").animate({left:'0px'});
$("div").fadeIn();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:39:27.650

试试这个：

```
$(document).ready(function(){
  setInterval(callMe,2000);
});

function callMe(){
  $("div").animate({left:'250px'}).fadeOut().animate({left:'0'}).fadeIn();
} 
```

尝试使用 jQuery 中的链接来根据需要完成需求。

### [在这里试用小提琴](http://jsfiddle.net/v2huq/)

# java - Java GUI 从 showInputDialog 访问按钮

> ID：15588531
> 
> 赞同：0
> 
> 时间：2013-03-23T15:29:29.903
> 
> 标签：java, user-interface, button, dialog

基本上我有显示对话框并允许用户在 2 到 4 个玩家之间进行选择的代码。它工作正常，但是我希望能够控制“确定”和“取消”按钮的作用，但我不知道如何访问它们。单击“确定”按钮时，我想调用一个方法，如果单击取消，我将终止程序（System.exit（0））。另外，如何检查用户是否单击了对话框上角的“x”？

```
public void numPlayersDialog()
{
    Object[] possibilities = {"Two Players", "Three Players", "Four Players"};
    String s = (String)JOptionPane.showInputDialog(
                    null,
                    "Enter the number of Players\n",
                    "Initial Dialog",
                    JOptionPane.PLAIN_MESSAGE,
                    null,
                    possibilities,
                    "Two Players");

        if(s.equals("Two Players"))
        {
            setNumOfPlayers(2);
        }
        else if (s.equals("Three Players"))
        {
            setNumOfPlayers(3);
        }
        else
        {
            setNumOfPlayers(4);
        }
} 
```

我对 Java 中的 GUI 东西相当陌生，所以任何帮助都将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:34:48.267

这是[javadoc](http://docs.oracle.com/javase/6/docs/api/javax/swing/JOptionPane.html#showInputDialog%28java.awt.Component,%20java.lang.Object,%20java.lang.String,%20int,%20javax.swing.Icon,%20java.lang.Object%5B%5D,%20java.lang.Object%29)所说的：

> 回报：
> 
> 用户的输入，或 null 表示用户取消了输入

因此，如果返回值为 null，则表示用户单击了“取消”或关闭了对话框。如果结果不为空，则表示用户单击了确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:45:42.600

你可以这样做：

```
if (s == null) {/////////////mean you click on the Cancel button
        System.exit(0);
    } else {////////////mean you click on OK button

        if (s.equals("Two Players")) {
            setNumOfPlayers(2);
        } else if (s.equals("Three Players")) {
            setNumOfPlayers(3);
        } else {
            setNumOfPlayers(4);
        }
    } 
```

# c# - 在 C# 中将数据从一种形式传递到另一种形式

> ID：15588533
> 
> 赞同：0
> 
> 时间：2013-03-23T15:29:44.297
> 
> 标签：c#, winforms

我有两种表格查询和客户，当客户是新客户时，我必须添加客户，然后他的姓名必须出现在查询表格组合框中的客户名称字段中。我如何在 C# 中做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:32:16.867

一种方法是向客户端添加公共属性，并且在显示客户端表单之前设置该属性（假设您从查询表单创建客户端对象）......该属性也可以直接连接到组合框（获取和设置方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:34:45.347

您可以向第二种形式的构造函数添加参数，例如：

```
public Form2(string clientName)
{
    InitializeComponent();
    // ...
} 
```

然后你可以从另一种形式调用它：

```
{
    Form2 fm2 = new Form2("name");
    fm2.Show();
} 
```

# android - Android：ListFragment 不刷新

> ID：15588538
> 
> 赞同：0
> 
> 时间：2013-03-23T15:30:07.830
> 
> 标签：android, android-fragments, android-sqlite, android-listfragment

嗨，我正在使用 ListFragment 从我的 SQLite 数据库中添加联系人。然后我想刷新 ListFragment 但它不起作用。

这是我的 Fragment 中的代码，用于在单击 ActionBar 中的项目以将联系人添加到 ListFragment 后显示 AlertDialog：

```
//Handle OnClick events on ActionBar items
@Override
public boolean onOptionsItemSelected(MenuItem item) {
   // handle item selection
   switch (item.getItemId()) {
      case R.id.menu_add:
         Toast.makeText(getActivity(), "Click", Toast.LENGTH_SHORT).show();

         LayoutInflater factory = LayoutInflater.from(getActivity());

         //textEntryView is an Layout XML file containing text field to display in alert dialog
         textEntryView = factory.inflate(R.layout.dialog_add_room, null);       

         //get the control from the layout      
         enter_room = (EditText) textEntryView.findViewById(R.id.enter_room);

         //create Dialog
         final AlertDialog.Builder alert1 = new AlertDialog.Builder(getActivity());
         //configure dialog
         alert1.setTitle("Raum hinzufügen:").setView(textEntryView)
         .setPositiveButton("Hinzufügen",
                new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,
                    int whichButton) {
                String roomname = enter_room.getText().toString();

                Log.d("Insert: ", "Inserting ..");
                dbHandler.addContact(new Contact(roomname, "0"));

                adapter.notifyDataSetChanged();
            }
         }).setNegativeButton("Abbrechen",
                new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,
                    int whichButton) {
                //cancel dialog
            }
         });
         alert1.show();          
         return true;
      default:
         return super.onOptionsItemSelected(item);
   }
} 
```

在 OnCreate() 方法中定义的适配器：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //display ActionBar items
    setHasOptionsMenu(true);

    //database
    dbHandler = new DatabaseHandler(getActivity());

    //get all contacts
    contacts = dbHandler.getAllContacts();

    adapter = new ArrayAdapter<Contact>(getActivity(),
            android.R.layout.simple_list_item_activated_1,
            android.R.id.text1, contacts);

    adapter.setNotifyOnChange(true);

    //show all contacts in the ListFragment
    setListAdapter(adapter);
} 
```

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T19:47:24.950

您的`onCreate`代码使用您的`DatabaseHandler`类将数据库中的所有联系人加载到数组或`List`某种数组中。稍后，您的单击处理程序将另一个联系人添加到数据库：但它不会更改您的数组。`ArrayAdapter`唯一知道你给它的数组，而不是数据库，所以没有`adapter.notifyDataSetChanged();`效果。

您可以采取两种方法。

1.  您可以将您的`ArrayAdapter`和设置代码替换为`Loader`. 最简单的方法是通过 a 访问您的数据库`ContentProvider`，这意味着您可以使用 a`CursorLoader`并且它会在数据库更改时更新您的适配器，即使更改来自 a`Service`或另一个`Activity`。`Loader`即使您不想要 a 的开销，您仍然可以使用 a `ContentProvider`，但是为您完成的工作更少。无论哪种方式，a`Loader`都为您提供了在后台线程中执行加载的优势，因此当您有很多联系人时，您不会得到“应用程序无响应”。有关更多信息，请参阅[Android 开发人员上的加载程序指南。](http://developer.android.com/guide/components/loaders.html)

2.  一个更快、更短期的解决方法是在更新数据库的同时编辑您提供给适配器的数组。你可以通过替换线来做到这一点

    ```
    dbHandler.addContact(new Contact(roomname, "0")); 
    ```

    和

    ```
    Contact newContact = new Contact(roomname, "0");
    dbHandler.addContact(newContact);
    contacts.add(newContact); 
    ```

    这样，当您更改或删除联系人时，您必须执行类似的操作，并且如果您的数据库从您的外部更改，它将不会更新`ListFragment`。您可能会发现您可以继续添加这些额外的调用一段时间，但最终您会遇到一些操作，您必须以其他方式进行操作才能使其工作。

# java - 如何在 Android 中制作一个点击后结束的介绍屏幕？

> ID：15588547
> 
> 赞同：2
> 
> 时间：2013-03-23T15:31:08.580
> 
> 标签：java, android, click, splash-screen

我怎样才能在Android中制作一个介绍屏幕，当应用程序启动时，只要屏幕上没有点击，它就会站在那里，然后自杀？我用图片做了布局，给它做了一个java类，但是不知道用什么方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T17:20:16.503

试试这个

activity_main.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" 
    android:id="@+id/linear_splash"
    android:background="@drawable/wallpaper"
    >

    </LinearLayout> 
```

MainActivity.java

```
public class MainActivity extends Activity {
LinearLayout LL;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    LL=(LinearLayout) findViewById(R.id.linear_splash);
    LL.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            Intent intent=new Intent(MainActivity.this,Second.class);
            finish();
            startActivity(intent);
        }
    });

} 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T15:41:12.583

您可以使用初始屏幕作为背景图像进行活动。将`android:onClick`属性设置为一个方法，该方法启动一个新活动。

**更新**：

我喜欢只使用单独布局的想法，因为您不需要进行额外的活动。但是，我不会使用按钮，因为通常您希望在没有任何动画的情况下点击屏幕，例如按下和释放。您仍然使用`android:onClick`布局上的属性

闪屏布局：

```
<View xmlns:android="http://schemas.android.com/apk/res/android"
    android:background "@drawable/splash_screen"
    android:onClick "removeSplash"
    android:clickable "true"
    ...
    /> 
```

在调用的方法中，您只需将启动布局替换为主要活动布局

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splash_screen);
    ...
}

public void removeSplash(View view) {
    setContentView(R.layout.main);
    // any other initialization needed
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-23T16:41:23.233

如果你想让它变得简单，应该快速制作一个自定义对话框，你不必创建另一个活动。

# algorithm - 绘制不等式算法

> ID：15588552
> 
> 赞同：3
> 
> 时间：2013-03-23T15:31:45.633
> 
> 标签：algorithm, math, graph

我正在使用 HTML5 画布编写一个简单的图形应用程序。输入是一个这样的不等式系统（所有函数都是线性的）：

```
4x + y >= 4
x  + y <= 4
x,y >= 0 
```

我想要的输出是一组形成要填充的形状的点。例如，对于此示例，图表将是：

![在此处输入图像描述](../Images/7650b2ef5739c5491249d55c29c66325.png)
以及点集：[0,4]、[1,0]、[4,0]。找到这些点的算法是什么？我知道线的交点是线性系统的解决方案，但我不知道如何正确填充。请注意，这个问题不是关于图形系统的实现，而是如何找到填充的形状点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T18:11:26.407

在我看来，您的问题实际上是两个问题：方程式是否定义了一个封闭的多边形，以及如何填充它？

例如，
* 如果你的方程包括 x + y > 10 和 x + y < 5，那么你将无法找到解决方案，没有什么可填充的，* 如果你的方程只是 x > 0， y > 0，您会遇到问题，因为要绘制的表面将是无界/无限的。

我相信您的方程组是否有解决方案大致相当于[线性规划中的单纯形算法](http://en.wikipedia.org/wiki/Simplex_algorithm)：算法的[第一阶段](http://en.wikipedia.org/wiki/Simplex_algorithm#Finding_an_initial_canonical_tableau)确定问题是否可行。

该解决方案是否形成一个封闭的多边形并不是线性规划通常感兴趣的事情。但是，您可以通过检查 4 个问题来解决这个问题：最小化 x、最大化 x、最小化 y、最大化 y，给定您的不等式，是否有解决方案。如果这些问题中的任何一个都没有，那么您就知道问题是无限的——我认为这意味着多边形没有闭合。

一旦你知道多边形是闭合的，我会简单地计算所有线的交点，可能将其减少到它的[凸包](http://en.wikipedia.org/wiki/Convex_hull)，然后填充生成的多边形。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T18:53:36.347

您可以利用这样一个事实，即任何定义为线性半空间并集的区域都必须是单个凸区域，尽管可能是半无限的，这可能会增加混乱。

1.  首先添加一个矩形的不等式“窗口”，它是您正在绘制的域的超集。这样，您可以忽略结果是半无限空间的情况。

2.  找到所有边界对之间的交点。这是两个嵌套循环和一个交集检查器。（如果需要，您可以先找到所有非窗口不等式的交集，将窗口设置为包括所有这些，然后添加与窗口相关的交集。）

3.  扔掉所有不能满足任何不等式的点。

4.  如果还有点，使用[凸包算法](http://en.wikipedia.org/wiki/Convex_hull)找到封闭区域并绘制它。

请注意，如果预先知道图形窗口，则可以通过仅考虑位于窗口内的边界段并使用增强型 Bentley-Ottman 等排列算法来提高相交计算的效率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T17:18:40.533

我可以提出以下算法。需要注意的是，该算法不是基于寻找线交点然后以某种方式确定区域的想法，因为这种方式对于算法实现来说似乎很复杂。
由于计算空间在任何方面都是离散的，因此引入一些正交网格似乎很自然。
所以：

1.  让我们介绍具有一些特征单元大小的正交网格。这个大小取决于你的问题陈述的一些细节。假设网格有 N*M 个节点 (x_i, y_j), 0 <= i < N, 0 <=j < M
2.  让我们找到满足所有 K 不等式 a_k*x1_i+b_k*y1_j-c_k <= 0 for 0 <= k< K 的所有点 (x1_i, y1_j)。这些点应该被填充。
3.  如果网格分辨率足以进行可视化，那就是全部。如果不是，我们必须确定哪条线通过边界点附近。为此，我们检查每个边界点及其邻居。如果我们发现该点的邻居违反了 Sth 不等式，则意味着 Sth 线在该点和该邻居之间经过。

# mvp - Model-View-Presenter 和 Model-View-Adapter 有什么区别？

> ID：15588562
> 
> 赞同：17
> 
> 时间：2013-03-23T15:32:18.773
> 
> 标签：mvp, model-view-adapter

我试图了解 Model-View-Presenter 和 Model-View-Adapter 模式之间是否存在差异，以及——如果是的话——差异是什么。我还没有找到任何可以比较/对比它们的在线资源，所以我什至不确定它们是否真的不同。

我发现的对它们的描述听起来与我基本相同。根据我收集到的信息，在这两种情况下，控制流程基本上是：

```
View <-- Adapter/Presenter --> Model
(where Adapter/Presenter can also respond to events from View and Model)

View: the UI
Adapter/Presenter: main logic; mediator between the UI and the data model
Model: the data model 
```

适配器/演示者“知道”视图和模型，但视图和模型不知道除了他们自己之外的任何人。

我希望这里有一个我完全错过的微妙之处。它是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-21T20:38:04.497

我唯一能想到的是 MVA 通常与视图和模型之间的多个适配器相关联。虽然在 MVP 中没有什么能阻止你这样做，但我认为 MVP 意味着一个强大的三元组。

更新（多年后）：回想起来，我相信一个关键的区别是控制流。在 MVP 中，View 触发/创建/调用 Presenter，Presenter 委托给模型并响应 View。在 MVA 中，当消息进入时，会选择一个适配器，然后它会在模型​​和视图之间进行调解。因为 MVP 视图触发/创建/调用 Presenter，所以在多个 Presenter 之间进行选择（因为选择了一个 Adapter）并不是一个简单的选择。

# c# - 在 Prolog.NET 中查询替代解决方案

> ID：15588564
> 
> 赞同：0
> 
> 时间：2013-03-23T15:32:31.040
> 
> 标签：c#, prolog

我是一名大学生，对 Prolog 很陌生。我目前正在开发一个 C# 应用程序，它应该使用任何合适的 prolog-C# 库与 Prolog 集成。我发现[Prolog.NET](http://prolog.hodroj.net/)（由 Ali Hodroj 开发）对于我的场景来说是一个很好的解决方案，它也符合我的要求。但是，在使用它时查询特定谓词的替代解决方案时，我遇到了一些麻烦。例如，像这样的谓词，

```
add(X,Y,Ans) :- Ans is X+Y. 
```

将只有一个特定的答案，如果用户分别为 X 和 Y 输入 1 和 2，则答案为 3。但，

```
female(maria). 
female(emma). 
parent(bobby, emma).
parent(bobby, maria). 
daughter(X,Y) :- parent(X,Y), female(Y). 
```

如果daughter(X,Y)谓词被查询为daughter(bobby,D)，则D将有两个值，emma和maria，可以通过按“;”进行迭代 在 Prolog 环境中。但是在 Prolog.NET 中使用 C# 时，我只能得到一个特定的值。例如：

```
AbstractTerm a = new AbstractTerm();
PrologClass proClass = new PrologClass();
proClass.daughter("bobby", a); 
```

从 C# 环境调用上述女儿（X，Y）方法时，它只会返回一个特定的解决方案（emma），我需要的是获得另一个解决方案，即 maria。我已经尝试了很多事情，但无论如何我似乎都无法获得其他价值。如果有人能告诉我如何实现这一点，我将不胜感激！这对我的项目工作将是一个很大的帮助！

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:42:55.727

**Actually not true, as this implemetation does not have `bagof`**

Wrap the queries in `bagof/3`, like this:

```
bagof( (X,Y), daughter(X,Y), Result). 
```

You should receive a list of all results. Look at the other predicates for finding all solutions to a goal for more options.

# c - 如果您 fork() 和分叉（子）进程退出，所有 VM 页面在父进程中是否仍标记为 COW？

> ID：15588569
> 
> 赞同：7
> 
> 时间：2013-03-23T15:33:32.220
> 
> 标签：c, linux, fork, virtual-memory

在 Linux 上，如果你 fork() 和分叉的（子）进程退出，所有虚拟内存页面在父进程中是否仍标记为写时复制？

我认为这些页面将保持标记为 COW，因为其他任何东西实施起来可能会非常昂贵，可能需要每页的引用计数和其他昂贵的簿记。但是前几天我想知道，如果我分叉一个进程以在当前进程的“稳定快照”中执行一些代码。当子进程退出时会发生什么？父级中的所有内存页是否都标记为写时复制？这意味着在具有大量虚拟内存（例如 128GB+）的进程中分叉仅执行一些代码几分钟会导致父进程在数小时甚至数天后挥之不去的性能下降（更不用说 fork 调用本身）这不会便宜。）

我只是好奇 Linux 上的实际行为是什么（我不知道如何测试它。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-23T16:11:47.447

除了写时复制位之外，页表中还有一个引用计数。所以当一个child fork时，parentent中的所有非私有页面都被标记为COW，并且引用计数增加。

然后当子进程运行时，父进程写入一个页面，它会出现页面错误，并且页面被复制，就像你期望的那样，并且引用计数减少了。当子进程退出时，它会将所有页面引用减一，引用计数为零的页面将被丢弃。

现在，当父级写入一个设置了 COW 位且引用计数为 1 的页面时，COW 位将被简单地忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:51:36.347

内核将所有共享页面标记为写保护，因此如果其中任何一个尝试修改一个，都会导致异常。副本被创建，并被标记为可写（因此不再有例外），而原件保持写保护。

如果写入原始页面，则会发生另一个异常，但内核将看到该页面未被任何其他进程共享，因此也会将该页面标记为可写。当一个进程终止时，它的所有页面都被释放，因此内核将在父进程中的每个页面被修改时有效地删除 COW 状态。

# android - 只有一个应用程序实例

> ID：15588570
> 
> 赞同：0
> 
> 时间：2013-03-23T15:33:33.450
> 
> 标签：android, android-manifest

我发现了很多关于这个的线程，但没有一个能解决我的问题。

我的应用程序是一个在线收音机，点击菜单或进入设备主页，收音机仍在播放，应该是这样。

但是当点击应用程序图标时，打开应用程序的一个新实例，应该只在实例已经打开时才返回，这会使它们同时播放两个收音机。要完成应用程序的第一个实例，必须转到“管理应用程序”菜单并终止应用程序。

我试过将launchMode 用作singleTask、singleTop、SingleInstance，但没有一个有效。

我该如何解决这个问题？

我很感激任何帮助。

在我的清单下面：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.radiomiriam"
    android:versionCode="3"
    android:versionName="1.3"  >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
    <uses-feature />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/logo_novo"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.radiomiriam.Main"
            android:label="@string/app_name"
            android:configChanges="orientation|keyboardHidden"
            android:launchMode="singleInstance" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.radiomiriam.Nsi"
            android:label="@string/app_name" >
        </activity>
        <activity
            android:name="com.radiomiriam.Contato"
            android:label="@string/contato" >
        </activity>
    </application>
</manifest> 
```

亲爱的朋友，把错误的问题放在这里。对不起。

仅在单击后退按钮时出现问题，然后将以下功能放入我的活动中：

```
public void onBackPressed() {
    Intent intent = new Intent(Intent.ACTION_MAIN);
    intent.addCategory(Intent.CATEGORY_HOME);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(intent);
} 
```

并且现在正在 100% 工作。

非常感谢所有回复的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:57:22.890

在清单中，将下面的行添加到适当的活动中

```
android:finishOnTaskLaunch="true" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:41:41.290

尝试在后台运行的服务，因为收音机需要在后台播放，然后单击停止服务并重新启动所有服务。

# java - 在eclipse android开发中更正java代码

> ID：15588571
> 
> 赞同：0
> 
> 时间：2013-03-23T15:33:42.657
> 
> 标签：java, android, eclipse

各位程序员，我在 Eclipse 中编写了一个 java 代码，它可以使用 localhost phpmyadmin 数据库登录到一个帐户，checklogin 正在工作，如果该帐户已注册，它让我登录，但如果我输入了错误的帐户，android 模拟器告诉我应用程序有崩溃了，我想有人帮助我.. 如果输入的信息有误，我想做的就是显示一条消息，告诉您用户名或密码错误希望有人可以帮助我

这是我的代码：

```
public class user extends Activity  implements OnClickListener {
EditText etUser , etPass;
Button bLogin;

String username, password ;
HttpClient httpclient;
HttpPost httppost;
ArrayList<NameValuePair> nameValuePairs ;

HttpResponse response;
HttpEntity entity;

public void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.user);

    initialise();
    }

    private void initialise() {
      // TODO Auto-generated method stub
      etUser = (EditText) findViewById(R.id.editText2);
      etPass = (EditText) findViewById(R.id.editText1);
      bLogin = (Button) findViewById(R.id.button1);
      bLogin.setOnClickListener(this);
    }

    public void onregister(final View button) {
    final Intent intent = new Intent();
    intent.setClass(this, register.class);
    startActivity(intent);

    }

    public void onClick(final View v) {

    httpclient = new DefaultHttpClient();
    httppost = new HttpPost("http://10.0.2.2/android/database.php");

    username = etUser.getText().toString();
    password = etPass.getText().toString();

    try {
      nameValuePairs = new ArrayList<NameValuePair>();

      nameValuePairs.add(new BasicNameValuePair("username", username));
      nameValuePairs.add(new BasicNameValuePair("password", password));

      httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

      final Thread a = new Thread(new Runnable() {

        public void run() {
          try {
            response = httpclient.execute(httppost);
        } catch (ClientProtocolException e2) {
            // TODO Auto-generated catch block
            e2.printStackTrace();
        } catch (IOException e2) {
            // TODO Auto-generated catch block
            e2.printStackTrace();
        }

          runOnUiThread(new Runnable() {

            @Override
            public void run() {
              // TODO Auto-generated method stub
              if (response.getStatusLine().getStatusCode() == 200) {

                entity = response.getEntity();

                if (entity != null) {

                  InputStream instream = null;
                try {
                    instream = entity.getContent();
                } catch (IllegalStateException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                  JSONObject jsonResponse = null;
                try {
                    jsonResponse = new JSONObject(convertStreamToString(instream));
                } catch (JSONException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
                  String retUser = null;
                try {
                    retUser = jsonResponse.getString("username");
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                  String retPass = null;
                try {
                    retPass = jsonResponse.getString("password");
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                  if (username.equals(retUser) && password.equals(retPass)) {

                    SharedPreferences sp = getSharedPreferences("logindetails", 0);

                    SharedPreferences.Editor spedit = sp.edit();

                    spedit.putString("username", username);
                    spedit.putString("password", password);

                    spedit.commit();

                    Toast.makeText(getBaseContext(), "Succes!", Toast.LENGTH_SHORT).show();

                  } else {

                    Toast.makeText(getBaseContext(), "Invalid Login Details", Toast.LENGTH_SHORT).show();

                  }
                }
              }
            }
          });
        }
      });
      a.start();
    } catch (Exception e) {

        Toast.makeText(getBaseContext(), e.toString(), Toast.LENGTH_SHORT).show();

    }

    }

    private static String convertStreamToString(final InputStream is) {

    final BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    final StringBuilder sb = new StringBuilder();

    String line = null;
    try {
      while ((line = reader.readLine()) != null) {
        sb.append(line + "\n");
      }
    } catch (final IOException e) {
      e.printStackTrace();
    } finally {
      try {
        is.close();
      } catch (final IOException e) {
        e.printStackTrace();
      }
    }
    return sb.toString();
    }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:48:16.653

很可能如果您提供不正确`USERNAME`，您将在行`PASSWORD`获得**异常**

```
response = httpclient.execute(httppost); 
```

类似于“401 未经授权的访问”。所以你可以抓住它并展示 Toast。如果您可以在提供不正确的输入数据的情况下将下一个使用 HttpResponse 的工作包装到条件中，还可以创建一些变量。

**伪代码：**

```
response = httpclient.execute(httppost); // here you catch error
// and in catch block initialise your variable incorrect = true
if (incorrect) {
   // show Toast
}
else (
  // do your work with JSON
) 
```

# c# - CodeFirst 无法在共享主机上创建数据库

> ID：15588573
> 
> 赞同：0
> 
> 时间：2013-03-23T15:34:29.390
> 
> 标签：c#, asp.net-mvc, entity-framework, sql-server-2008

我想将 Entity Framework 5.0 部署到共享主机。

现在我遇到了数据库的问题。我无法创建数据库。

```
<add name="ResContext" 
connectionString="Data Source=XXXX5.db.10232343.hostedresource.com;
Initial Catalog=XXXX5; User ID=XXXX5;
Password=XXXXXXXXX!;Integrated Security=false"
providerName="System.Data.SqlClient"></add> 
```

第一个 providerName="System.Data.SqlClient"

我有问题

> 无法删除数据库“XXXX5”，因为它不存在或您没有权限。

但是当我将 provideName 更改为

providerName="System.Data.EntityClient"

> 不支持关键字：“数据源”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T19:17:22.497

您可能已打开异常中断。应该处理此异常，您应该可以按 F5 继续。您可能会看到一些（大约 5 个）这样的异常。这就是 EF 检测您要使用的数据库是否存在、是否为最新等的方式。您也可以更改设置 - 转到“调试 -> 异常...”并取消选中“ “公共语言运行时异常”行上的“抛出”列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T09:05:51.070

通常，GoDaddy 不会授予您以编程方式创建或删除数据库的权限。它们只允许您通过其用户界面创建这些数据库。这是因为他们不希望人们到处创建数据库，并且他们希望确保只有您有权在共享用户环境中访问数据库。

因此，您不能使用 EF 使用的默认生成方法。相反，您将使用数据库初始化程序：

```
Database.SetInitializer<YourContextType>(null); 
```

# java - 使用ASCII码检查空格

> ID：15588574
> 
> 赞同：1
> 
> 时间：2013-03-23T15:34:36.240
> 
> 标签：java, char, ascii

我正在尝试在读取文件时从文件中删除空格。我通过检查 char 的 ascii 代码来做到这一点。如果它不是 127（空格），则将其打印出来。

有什么更好的思考方式？或者如何以这种方式解决它？

```
private FileInputStream sc;
private static char input;

public void openFile(){
try{
    sc = new FileInputStream(new File ("D:\\Empty.txt"));
    input = (char) sc.read();
    if(input != 127){
        System.out.println(input);
    }
}catch(FileNotFoundException e){
    e.printStackTrace();
    } catch (IOException e) {
    e.printStackTrace();
    }
}

public static void main(String[] args) {

    ParsingStrings ps = new ParsingStrings();
    ps.openFile();

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:38:32.327

为什么不通过使用 char 文字使其更清晰（并且显然是正确的）？

```
if (input != ' ') 
```

此外，必须使用 Streams 来读取二进制数据。要阅读文本，您应该使用阅读器。阅读[Java IO 教程](http://docs.oracle.com/javase/tutorial/essential/io/charstreams.html)。

当然，你的方法不应该吃这样的异常。它应该抛出它们，或者至少将它们包装在另一个异常中并抛出这个异常。

最后，Reader 应该是`openFile()`方法的局部变量而不是字段。它应该在 finally 块中关闭，或者使用 Java 7 的 try-with-resources 构造。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T15:39:53.247

您可以使用包装在 BufferedReader 中的诸如 FileReader 之类的字符流，因为它逐个字符地读取。我怀疑您在读取字节时会遇到一些问题，并且按照您的操作方式将其转换为字符。

```
 String s;
    BufferedReader in = new BufferedReader(new FileReader("file.txt"));
    while ((s = in.readLine()) != null) {
        for (char c : s.toCharArray()) {
            if (c != ' ') {
                System.out.println(c);
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T15:40:19.760

ASCII 空间是 32，127 是 DEL。见[http://en.wikipedia.org/wiki/ASCII](http://en.wikipedia.org/wiki/ASCII)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:40:28.207

你有两个选择：

1.  如果要从输入中删除空格，请查看[`FilterInputStream`](http://docs.oracle.com/javase/7/docs/api/java/io/FilterInputStream.html)该类。重写`read()`方法：如果它读取一个空格字符，让它再读取一个字符。

2.  如果要从输出中删除空格，请查看[`FilterOutputStream`](http://docs.oracle.com/javase/7/docs/api/java/io/FilterOutputStream.html)该类。重写`write(int)`方法：如果调用它写一个空格字符，让它什么都不做。

在您的特定情况下，我会选择后一种选项，因为我认为它更容易实现，但选择权在您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-23T15:43:23.910

使用 BufferedReader 和 InputStreamReader 会对您有所帮助。这样，您可以使用 .readLine() 读取文件中的每一行，然后使用 .charAt() 从该行读取每个字符。

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-23T15:50:54.903

```
sc = new FileInputStream(new File ("D:\\Empty.txt"));

while(sc.hasNextLine()){
    input = sc.nextLine().replace(" ","");
    System.out.println(input);
} 
```

我认为不是只检查一个字符，而是要从整个文件中删除空间并打印它......是吗？

# javascript - 密码字符串验证：有 8 个字符，至少 1 个字符、1 个数字和 1 个特殊字符

> ID：15588578
> 
> 赞同：-3
> 
> 时间：2013-03-23T15:34:48.987
> 
> 标签：javascript, jquery, ajax

如何在密码字符串上创建验证：至少 8 个字符，至少 1 个 az 字母，1 个至少 0-9 数字和 1 个至少特殊字符，如 &、#、%、@ 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:56:21.577

您可以使用非常[简单的正则表达式](http://www.regular-expressions.info/charclass.html)来制定这些要求，并测试它们是否都[与字符串匹配](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)：

```
var input = …;
var valid = input.length >= 8 // at least 8 characters
              && /[a-z]/.test(input) // contains a lowercase letter
              && /\d/.test(input) // contains a digit
              && /[^\w\s]/.test(input); // contains something that is not a letter, underscore, digit, or whitespace 
```

# jquery - jQuery 交换

> ID：15588582
> 
> 赞同：0
> 
> 时间：2013-03-23T15:35:23.040
> 
> 标签：jquery

我在一个网页中有一个登录页面和一个注册页面。页面底部有两个按钮，我想用它们交换页面。请参阅我的编码 - [http://jsfiddle.net/t6sr7/](http://jsfiddle.net/t6sr7/)。这就像我的登录注册页面。它不工作。请帮助我.. 以下是我的 jQuery 代码：-

```
<script>
$(document).ready(function(){
  $("#inactive").click(function(){
    $("#inactive").removeAttr('id');
    $("#inactive").attr("id","active-swap");
    $("#active").attr("id","inactive");
    $("#active-swap").attr("id","active");

    $("#active-page").attr("id","inactive-page-swap",function(){
    $("#inactive-page").attr("id","active-page");
        $("#inactive-page-swap").attr("id","inactive-page");
        });
    });
});
</script> 
```

请在 jsFiddle 中查看我的 HTML 和 CSS 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:40:19.880

You should not change the ids. But change the class attribute.

Moreover if you want to hide a div. You may consider to do that with Jquery `.hide()` method like in the following code (or see my updates [isfiddle](http://jsfiddle.net/t6sr7/23/)):

```
<script  language="javascript">
$(function(){
  $("#inactive-page").hide();
  $("#active").click(function(){
    $("#active").attr("class","login-modal");
    $("#active-page").show();
    $("#inactive").attr("class","signup-modal");
    $("#inactive-page").hide();
  });

$("#inactive").click(function(){
    $("#inactive").attr("class","login-modal");
    $("#inactive-page").show();
    $("#active").attr("class","signup-modal");
    $("#active-page").hide();
  });
});
</script> 
```

And update your CSS with that:

```
#bottom-modal{
    width:100%;
    border-top:1px solid #666;
    box-shadow:0px 1px #aaa inset;
    padding: 15px 0 0 0;
    font-size:14px;
    color:#3a3a3a;
    min-height:33px;
}

a{
    float:left;
    text-decoration:none;
    padding:5px;
    margin-left:39%;
    border-radius:5px;
    padding:5px;
}

.signup-modal{
    background:#00a5f0;
    border:1px solid #0084c0;
    color:#fff;
    outline:none; 
}

.login-modal{
    background-color:#e6e6e6;
    color:#808080;
    border:1px solid #d6d6d6;
    outline:none;
}

#active-swap{
    background:#00a5f0;
    border:1px solid #0084c0;
    color:#fff;
    outline:none;
}

#inactive:hover{
    background:#666;
    color:#fff;
}

#inactive:active{
    background:#333;
    color:#fff;
} 
```

**PS:** you forget the last `</div>` in your jsfiddle. And you should not put the `<script></script>` element in the jsfiddle's javascript window.

# python - 在完成绘制之前关闭 python turtle 时获取 tkinter.tclerror

> ID：15588583
> 
> 赞同：2
> 
> 时间：2013-03-23T15:35:36.183
> 
> 标签：python, window, tkinter, exit, turtle-graphics

我有一个绘制科赫雪花的 python 脚本。一切正常，除非我在绘图完成之前关闭 tutle 图形窗口，我得到一个很长的错误，这是最后一行：tkinter.tclerror: invalid command name ".38006576"。我认为这就像在 java.swing:exit_on_close 中一样。这不是默认设置。但是我还没有为 python turtle 找到类似的东西。有什么建议可以避免这种情况吗？

```
 import turtle
            import sys
            import easygui as eg

            def isNum(s):
                try:
                    int(s)
                    return True
                except ValueError:
                    return False

            run = True
            while run:

                msg         = "Input"
                title       = "Koch snowflake"
                fieldNames  = ["Length","Depth"]
                fieldValues = []  # we start with blanks for the values
                fieldValues = eg.multenterbox(msg,title, fieldNames)

                a=0
                iterations=0
            # make sure that none of the fields was left blank
                while 1:  # do forever, until we find acceptable values and break out
                    if fieldValues == None: 
                        break
                    errmsg = ""

                    # look for errors in the returned values
                    for i in range(len(fieldNames)):
                        if fieldValues[i].strip() == "":
                            errmsg = errmsg + ('"%s" must be filled.\n\n' % fieldNames[i])
                        elif not (isNum(fieldValues[i].strip())):
                            errmsg = errmsg + ('"%s"  requires a number.\n\n' % fieldNames[i])

                    if (isNum(fieldValues[1])):
                        if float(fieldValues[1].strip()) > 13:
                            errmsg = errmsg + ('Depth cannot be more than 13!') 

                    if errmsg == "": 
                        break # no problems found
                    else:
                        # show the box again, with the errmsg as the message    
                        fieldValues = eg.multenterbox(errmsg, title, fieldNames, fieldValues)

                #a=float(input("Length: "))
                if not fieldValues == None:
                    if isNum(fieldValues[0]) and isNum(fieldValues[1]):
                        a=float(fieldValues[0])
                        iterations=int(fieldValues[1])
                else:
                    sys.exit(0)

            #turtle settings
                turtle.bgcolor("black")
                turtle.reset()
                turtle.up() 
                turtle.setpos(-a*1.5 ,a)
                turtle.down()
                turtle.delay(0)
                turtle.speed(0)
                turtle.pencolor("white")

                koch_flake = "EJEJE"

                for i in range(iterations):
                    koch_flake = koch_flake.replace("E","EBEJEBE\n")

                turtle.down()

                for move in koch_flake:
                    if move == "E":
                        turtle.forward(a / (3 ** (iterations - 1)))
                    elif move == "B":
                        turtle.left(60)
                    elif move == "J":
                        turtle.right(120)
                turtle.hideturtle()
                image   = "KochSnowflake.gif"
                msg = "Run it again?"
                title = "Please Confirm"
                if eg.ynbox(msg, title,('Yes', 'No'),image):     # show a Continue/Cancel dialog
                    run = True
                else:  # user chose Cancel
                    sys.exit(0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T07:49:54.863

`Canvas`在可以访问 Tkinter 根的对象上绘制海龟。捕获`WM_DELETE_WINDOW`根的事件。当事件被捕获时，`del`turtle 对象使其无法继续尝试绘制。控制海龟事件的线程将抛出 NameError，因为海龟已被删除。捕获 NameError 异常并忽略它。

这是执行此操作的代码。我测试了它；它有效并且没有抛出任何错误：

```
import turtle
import Tkinter
import sys
import easygui as eg

def isNum(s):
    try:
        int(s)
        return True
    except ValueError:
        return False

run = True
while run:

    msg         = "Input"
    title       = "Koch snowflake"
    fieldNames  = ["Length","Depth"]
    fieldValues = []  # we start with blanks for the values
    fieldValues = eg.multenterbox(msg,title, fieldNames)

    a=0
    iterations=0
# make sure that none of the fields was left blank
    while 1:  # do forever, until we find acceptable values and break out
        if fieldValues == None: 
            break
        errmsg = ""

        # look for errors in the returned values
        for i in range(len(fieldNames)):
            if fieldValues[i].strip() == "":
                errmsg = errmsg + ('"%s" must be filled.\n\n' % fieldNames[i])
            elif not (isNum(fieldValues[i].strip())):
                errmsg = errmsg + ('"%s"  requires a number.\n\n' % fieldNames[i])

        if (isNum(fieldValues[1])):
            if float(fieldValues[1].strip()) > 13:
                errmsg = errmsg + ('Depth cannot be more than 13!') 

        if errmsg == "": 
            break # no problems found
        else:
            # show the box again, with the errmsg as the message    
            fieldValues = eg.multenterbox(errmsg, title, fieldNames, fieldValues)

    #a=float(input("Length: "))
    if not fieldValues == None:
        if isNum(fieldValues[0]) and isNum(fieldValues[1]):
            a=float(fieldValues[0])
            iterations=int(fieldValues[1])
    else:
        sys.exit(0)

    root = Tkinter.Tk()
    cv = turtle.Canvas(root, width=200, height=200)
    cv.pack()
    screen = turtle.TurtleScreen(cv)
    screen.bgcolor("black")
    myturtle = turtle.RawTurtle(screen)

    def lastAction():
        global myturtle
        del myturtle
        root.destroy()
    root.protocol('WM_DELETE_WINDOW', lastAction)

    try:
#turtle settings
        screen.bgcolor("black")
        myturtle.reset()
        myturtle.up() 
        myturtle.setpos(-a*1.5 ,a)
        myturtle.down()
        turtle.delay(0)
        myturtle.speed(0)
        myturtle.pencolor("white")

        koch_flake = "EJEJE"

        for i in range(iterations):
            koch_flake = koch_flake.replace("E","EBEJEBE\n")

        myturtle.down()

        for move in koch_flake:
            if move == "E":
                myturtle.forward(a / (3 ** (iterations - 1)))
            elif move == "B":
                myturtle.left(60)
            elif move == "J":
                myturtle.right(120)
        myturtle.hideturtle()
    except NameError:
        pass

    image   = "KochSnowflake.gif"
    msg = "Run it again?"
    title = "Please Confirm"
    if eg.ynbox(msg, title,('Yes', 'No'),image):     # show a Continue/Cancel dialog
        run = True
    else:  # user chose Cancel
        sys.exit(0) 
```

# c# - C# Windows 窗体 ListView 获取选定的行值

> ID：15588587
> 
> 赞同：3
> 
> 时间：2013-03-23T15:35:50.633
> 
> 标签：c#, listview, windows-forms-designer

我有一个`ListView`由 SQL 数据库填充的数据库，并且希望能够在选择一行并单击编辑按钮后编辑这些值。

当我单击“编辑”按钮时，应在文本框中设置所选行的值，但出现此错误“**对象引用未设置为对象的实例。** ”为什么这不起作用？

```
private void btnEdit_Click(object sender, EventArgs e)
    {
        this.txtid.Text = lvBrands.SelectedItems["id"].Text.ToString();  
        this.txtName.Text = lvBrands.SelectedItems["name"].Text.ToString();

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T23:00:07.213

如果您的 ListView 处于报告模式（即它看起来像一个网格），那么您将需要 SubItems 属性。`lvBrands.SelectedItems`获取列表视图中的每个项目 - SubItems 获取列。`lvBrands.SelectedItems[0].SubItems[0]`第二列值也是如此。

# node.js - 来自 NodeJS 或 mongoose 的 mongodump/mongorestore

> ID：15588589
> 
> 赞同：13
> 
> 时间：2013-03-23T15:35:57.730
> 
> 标签：node.js, mongodb, mongoose

想知道是否可以从 nodejs 中运行 mongodump/mongorestore。可能不是真正的猫鼬，因为那不是猫鼬的真正用途。但想知道是否有办法从 mongodb nodejs 驱动程序执行这些命令。

看起来我可以将其作为最后的手段： [如何从 node.js 以编程方式执行 mongodump 命令？](https://stackoverflow.com/questions/10210767/how-do-i-execute-the-mongodump-command-programmatically-from-node-js)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-23T17:51:38.817

当你说我假设你的意思是从你的 node.js 应用程序中`'from node.js'`调用命令时。`mongodump/mongostore`

因为`mongodump`和`mongostore`是命令行应用程序。您可以“执行它们”的唯一方法`node.js`是使用您在此处找到的解决方案。

也就是说，使用`child_process.spawn`以来还没有人为它们创建 node.js 绑定。

我不会将它用作“最后的手段”，因为它完全符合您的需要。但是，我应该提一下，您可以`mongodb`使用`node.js driver`. 也就是说，遍历集合并存储它们，执行相反的操作以恢复备份。

我强烈建议反对它。您链接到的问题中建议的方法的问题相对较小。我已经看到它自己在生产中使用（嗯，类似的东西）并且没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T01:30:33.320

我为此编写了一个小模块：[https](https://github.com/meryn/mongo-utils) ://github.com/meryn/mongo-utils 。它为您解析 mongo 连接字符串。

# spring - Spring @Transactional 不创建事务

> ID：15588591
> 
> 赞同：1
> 
> 时间：2013-03-23T15:36:15.170
> 
> 标签：spring, spring-mvc, transactional

我正在用 Spring 交易认真地敲打我的头。我已经搜索了几天试图让@Transactional 工作。任何帮助将不胜感激！

我正在将 Spring 3.2 用于访问 MySQL 数据库的 Web 应用程序（我正在使用 Spring MVC、JDBC 和 Security）。mysql 表使用 InnoDB。我正在努力让声明性事务工作（我尝试使用程序化事务并且成功地工作）。我有控制器调用使用@Transactional 注释的服务方法。控制器在 servlet xml 文件中配置，服务/dao 在单独的应用程序 xml 文件中配置。我似乎找不到正确的配置来获取 @Transactional 并创建事务。没有错误 - 只是没有交易。以下是我的设置的详细信息：

1.  使用 DispatcherServlet 的 Web 应用程序，配置有 servlet XML 文件，使用带注释的控制器。控制器注入了服务接口。

2.  服务方法使用 @Transactional 注释并调用注入的 DAO 类。

3.  服务类使用 @Named 进行注释，应用程序配置为使用组件扫描在 spring-app-context.xml 中获取这些。

4.  事务配置在 spring-app-context.xml 中设置（不在 servlet 配置文件中）。

网页.xml：

```
<context-param>
  <param-name>contextConfigLocation</param-name>
  <param-value>
    /WEB-INF/config/spring-app-context.xml
    /WEB-INF/config/spring-security-context.xml
  </param-value>
</context-param>

<listener>
  <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<servlet>
  <servlet-name>appServlet</servlet-name>
  <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
  <init-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/config/spring-servlet-context.xml</param-value>
  </init-param>
  <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
  <servlet-name>appServlet</servlet-name>
  <url-pattern>/</url-pattern>
</servlet-mapping> 
```

spring-servlet-context.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

    <!-- Scans within the base package of the application for @Components to configure as beans -->
    <!-- @Controller, @Service, @Configuration, etc. -->
    <context:component-scan base-package="ewarrants.web" />

    <!-- Enables the Spring MVC @Controller programming model -->
    <mvc:annotation-driven />

    <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>

    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/views/" />
        <property name="suffix" value=".jsp" />
    </bean>

    <context:property-placeholder location="/WEB-INF/config/ewarrants.properties"/>

</beans> 
```

这是一个示例控制器设置：

```
@Inject
IUserService userService;

@RequestMapping(value = "/register", method = RequestMethod.POST)
public String processRegistration(@Valid @ModelAttribute UserRegistrationVM incomingVM, BindingResult result, Model model) throws Exception {       

    ...

    userService.registerNewUser(newUser);

    return "redirect:<location>";
} 
```

这是spring-app-context：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd">

    <!-- Scans within the base package of the application for @Components to configure as beans -->
    <!-- @Controller, @Service, @Configuration, etc. -->
    <context:component-scan base-package="ewarrants.core" />
    <tx:annotation-driven transaction-manager="txManager" />

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="<url>"/>
        <property name="username" value="<user>"/>
        <property name="password" value="<password>"/> 
    </bean>

    <bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <context:property-placeholder location="/WEB-INF/config/ewarrants.properties"/>
</beans> 
```

这是一个示例服务实现：

```
@Named
public class UserService extends Service implements IUserService {

    @Inject
    private IUserDao userDao;

    @Override
    @Transactional(propagation=Propagation.REQUIRED, rollbackFor=Exception.class)
    public void registerNewUser(User user) throws Exception {
        ...

        // add the user record
        int newUserID = userDao.insertUser(user);

        // carry out more database inserts
    }
} 
```

# jquery - 避免重新加载ajax内容

> ID：15588592
> 
> 赞同：0
> 
> 时间：2013-03-23T15:36:16.983
> 
> 标签：jquery, ajax, hash

我使用 ajax 在 div 容器中加载 html 页面。html 内容在元素单击时加载，如下所示：

```
$(".link").click(function () {
    $('.link').removeClass('current');
    $(this).addClass('current');
    ajaxify($(this).attr('href'));
    window.location.hash = $(this).attr("href");
    return false;
}); 
```

如果 Internet 浏览器中的 url 哈希与`$(".link").attr("href")`. 所以当我再次点击同一个元素时，我希望什么都不会发生。

目前，如果我再次单击同一个元素，则会通过 ajax 调用加载相同的内容。

洛伊克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:42:34.383

You could simply use the `window.location` object (or simply `location` if `window` is the current scope) and compare it to the `href` property of your link.

```
$(".link").click(function () {
    if ($(this).attr('href') != location.href) {
      $('.link').removeClass('current');
      $(this).addClass('current');
      ajaxify($(this).attr('href'));
      window.location.hash = $(this).attr("href");
      return false;
    }
}); 
```

If your link is a relative path, you could use `location.pathname` instead of `location.href`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:01:56.523

您可以使用将“当前”类添加到所选链接的事实来有条件地执行处理程序中的代码，如下所示：

```
$('.link').click(function () {
    var link = $(this);
    if (!link.hasClass('current')) {
        $('.link').removeClass('current');
        link.addClass('current');
        ajaxify(link.attr('href'));
        window.location.hash = link.attr("href");
    }
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:39:50.657

将选择器从 更改`$(".link")`为`$(".link:not(.current)")`，因此您的点击处理程序只会在没有类的链接上被调用`current`。

更新：这不起作用，因为 jQuery 将 click 函数分配给 document.ready 上的所有链接（或将执行此代码的任何位置）并且不检查点击时的选择器。因此，您需要检查`current`单击处理程序中的类，如下所示：

```
$(".link").click(function () {
  if($(this).hasClass('current')) return false;
  ...
}); 
```

# c# - 创建后推送新值

> ID：15588595
> 
> 赞同：1
> 
> 时间：2013-03-23T15:36:33.250
> 
> 标签：c#, system.reactive

阅读 IntroToRx 网站，它不鼓励使用 Subject 来支持 Observable.Create 辅助方法。

正如我所看到的，OnNext 方法只能在 subscribe 方法中调用，因为它是我唯一可以访问 Observer 对象的部分。

如果我想在创建新值后推动它怎么办？我是否“被迫”使用主题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T16:54:36.940

如果你只是在探索 Rx，那就去做吧——使用 Subjects，发疯，看看它们是如何工作的，自己发现它们的优缺点，然后回到这里阅读讨论为什么 Subject 不受欢迎的问题。

主题提供了一种**更简单**的方式来“快速引导”想法和复杂的 Rx 场景，而无需复制实际的源条件。

也就是说，它们*确实*将状态注入到某种无状态的操作链中，因此请注意不要依赖它们。

所以，总结一下：如果你想生成序列来测试/学习 rx 是如何工作的，或者你如何进行查询 X，请使用这些主题。如果您发现自己在内部查询中使用它们，那么有机会有更好的方法。

编辑：意识到我错过了一些东西：

另外，您问是否有另一种方法可以在创建后引发流事件……答案是肯定的；您可以通过 Create 或 Return 或 Generate 声明一个流，该流返回您定义的任何旧的基于 IObservable 的对象，它还可以公开注入事件的方法......或者哎呀，有一个 lambda 来旋转一个检查共享列表的线程被路由到返回流......我想我要说的是可能性是无穷无尽的。在 Observable 上声明了十几个“创建事件序列”方法 - 全部尝试！

编辑2：

一个例子？当然，让我们一起使用`Observable.Create`模仿非常低效的东西`Subject`：

```
var running = true;
var values = new ConcurrentQueue<int>();
var query = Observable.Create<int>(obs =>
{
    var body = Task.Factory.StartNew(()=>
    {
        while(running)
        {
            int nextValue;
            if(values.TryDequeue(out nextValue))
            {
                obs.OnNext(nextValue);
            }
            Thread.Yield();
        }
    });
    return Disposable.Create(() =>
    {
        try
        {
            running = false;
            body.Wait();
            obs.OnCompleted();            
        }
        catch(Exception ex)
        {
            obs.OnError(ex);
        }
    });
});
using(query.Subscribe(Console.WriteLine))
{
    values.Enqueue(1);
    values.Enqueue(2);
    values.Enqueue(3);
    values.Enqueue(4);
    Console.ReadLine();
} 
```

请注意，这只是快速且极其肮脏的示例代码。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:04:31.330

这取决于你想要做什么。Subjects 有很多案例，但并不像他们第一次使用 Rx 时想象的那么多。

新数据将如何进入您的序列？它会来自另一个事件吗？也许是来自通信框架的消息？也许轮询文件？

根据这些答案，您通常会发现您已经拥有某种事件源，而您只是从另一种模式（事件、轮询、回调等）转换为 Rx

您也不必只使用 Observable.Create。您可以使用 Observable.Timer/Interval 设置轮询序列，使用 Observable.FromEventPattern 来利用现有事件，使用 Observable.Start 进行一次性异步任务样式计算等...

由于 Rx（甚至 Linq）可能非常抽象，因此提出抽象问题通常会导致非常广泛的答案。如果您指出您正在尝试解决的问题，这可能有助于为您提供更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-08T16:50:45.207

如果您从外部设备接收数据，您无意发出错误信号`IObserver.OnError`（您假设您的流是无止境的和/或任何通信问题都在消息本身内），您以某种速度轮询，主题的唯一问题是你可能会在任何人订阅之前就开始轮询这个设备（但额外的好处是处理你的状态非常明显，你创建了一个对象，它打开了 COM 端口，它通信和发布值）

使用`Observable.Create`or`Observable.Timer/Interval`可能会更好 - 但懒惰是主要原因，无论如何你都会管理状态。您可能需要使用 Publish().RefCount() 来防止第二次订阅打开端口。

# ios - 如何在不重叠的情况下在 UIButton 中实现两个 IBAction？

> ID：15588604
> 
> 赞同：9
> 
> 时间：2013-03-23T15:37:27.697
> 
> 标签：ios, objective-c, uibutton, ibaction

我从一个中拖动**2 个 IBAction**`UIButton`，一个带有 touchDown 事件，第二个带有内部拖动。

```
- (IBAction)clickButton:(UIButton *)sender {
    NSLog(@"Click Button");
}

- (IBAction)dragInsideButton:(UIButton *)sender {
    NSLog(@"Drag Button");
} 
```

但是当我往里面拖动时，touchDown 动作也会被触发。

如何在 dragInside 时禁用 touchDown 事件。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T19:02:46.873

我已经通过使用拖动事件解决了这样的问题

在 .xib 文件中或以编程方式将事件添加到您的按钮。

以编程方式是：

```
[mybut addTarget:self action:@selector(dragBegan:withEvent: )
  forControlEvents: UIControlEventTouchDown];
    [mybut addTarget:self action:@selector(dragMoving:withEvent: )
  forControlEvents: UIControlEventTouchDragInside];
    [mybut addTarget:self action:@selector(dragEnded:withEvent: )
  forControlEvents: UIControlEventTouchUpInside |
     UIControlEventTouchUpOutside]; 
```

那么事件的定义是：

```
- (void) dragBegan: (UIButton *) c withEvent:ev
{
    NSLog(@"dragBegan......");
    count=NO;//bool Value to decide the Down Event
    c.tag=0;
  [self performSelector:@selector(DownSelected:) withObject:mybut afterDelay:0.1];
 //user must begin dragging in 0.1 second else touchDownEvent happens

}

- (void) dragMoving: (UIButton *) c withEvent:ev
{
    NSLog(@"dragMoving..............");
    c.tag++;
}

- (void) dragEnded: (UIButton *) c withEvent:ev
{
    NSLog(@"dragEnded..............");
    if (c.tag>0 && !count)
    {

        NSLog(@"make drag events");

    }

}

-(void)DownSelected:(UIButton *)c
{
    if (c.tag==0) {
        NSLog(@"DownEvent");
        count=YES;//count made Yes To interrupt drag event
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T17:28:26.517

这种方法经过测试，应该做我认为你正在尝试做的事情。您可以更改计时器中的延迟以获得您想要的效果。我必须将 3 个动作连接到按钮才能完成这项工作——第三个动作是将系统重置为启动状态的 touchUp。

```
@interface LastViewController ()
@property (nonatomic) BOOL touchedDown;
@property (strong,nonatomic) NSTimer *downTimer;
@end

@implementation LastViewController 

- (void)viewDidLoad {
    [super viewDidLoad];
    self.touchedDown = NO;
}

-(IBAction)clickDown:(id)sender {
    self.downTimer = [NSTimer scheduledTimerWithTimeInterval:.3 target:self selector:@selector(buttonAction:) userInfo:nil repeats:NO];
}

-(IBAction)dragInside:(id)sender {
    [self.downTimer invalidate];
    [self buttonAction:self];
}

-(void) buttonAction:(id) sender {
    if ([sender isKindOfClass:[NSTimer class]]) {
        self.touchedDown = YES;
        NSLog(@"click down");
    }else{
        if (! self.touchedDown) {
             NSLog(@"Drag");
        }
    }
}

-(IBAction)touchUpAction:(id)sender {
    self.touchedDown = NO;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T15:51:45.667

试试这个方法：

`isClicked`是 BOOL 类型的属性。设置为`YES`。

```
- (IBAction)clickButton:(UIButton *)sender { //touch down
    if(isClick==YES){
       NSLog(@"Click Button");
       //do all your stuffs here
    }
    isClick=YES;
}

- (IBAction)dragInsideButton:(UIButton *)sender {
    NSLog(@"Drag Button");
    isClick=NO;
} 
```

最重要的是，您还可以实施`removeTarget:Action:`

*首先调用哪个方法设置isClick = NO，我希望在按钮操作中首先调用clickButton。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:47:48.060

我不确定它会起作用，但你可以试试

```
 - (IBAction)dragInsideButton:(UIButton *)sender {
    [sender removeTarget:self forSelector:@selector(clickButton:) forControlEvent:UIControlEventTouchDown];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-23T15:48:05.777

我从[UIButton 的两种操作方法中得到；下一首并向前搜索：](https://stackoverflow.com/questions/1926702/two-action-methods-for-an-uibutton-next-track-and-seek-forward)

# 根据您的要求更改它。

就我个人而言，我只是在您的视图控制器或按钮子类中使用整数来跟踪按钮的状态。如果您跟踪按钮的操作，您可以控制每个操作的操作。在您的 .h 文件中放入如下内容：

```
enum {
    MyButtonScanning,
    MyButtonStalling,
    MyButtonIdle
};

@interface YourClass : UIViewController {
    NSInteger buttonModeAt;
}
@property (nonatomic) NSInteger buttonModeAt;
-(IBAction)buttonPushedDown:(id)sender;
-(void)tryScanForward:(id)sender;
-(IBAction)buttonReleasedOutside:(id)sender;
-(IBAction)buttonReleasedInside:(id)sender;
@end 
```

然后在你的 .m 文件中加入一些这样的东西：

```
@implementation YourClass
///in your .m file
@synthesize buttonModeAt;

///link this to your button's touch down
-(IBAction)buttonPushedDown:(id)sender {
    buttonModeAt = MyButtonStalling;
    [self performSelector:@selector(tryScanForward:) withObject:nil afterDelay:1.0];
}

-(void)tryScanForward:(id)sender {
    if (buttonModeAt == MyButtonStalling) {
        ///the button was not released so let's start scanning
        buttonModeAt = MyButtonScanning;

        ////your actual scanning code or a call to it can go here
        [self startScanForward];
    }
}

////you will link this to the button's touch up outside
-(IBAction)buttonReleasedOutside:(id)sender {
    if (buttonModeAt == MyButtonScanning) {
        ///they released the button and stopped scanning forward
        [self stopScanForward];
    } else if (buttonModeAt == MyButtonStalling) {
        ///they released the button before the delay period finished
        ///but it was outside, so we do nothing
    }

    self.buttonModeAt = MyButtonIdle;
}

////you will link this to the button's touch up inside
-(IBAction)buttonReleasedInside:(id)sender {
    if (buttonModeAt == MyButtonScanning) {
        ///they released the button and stopped scanning forward
        [self stopScanForward];
    } else if (buttonModeAt == MyButtonStalling) {
        ///they released the button before the delay period finished so we skip forward
        [self skipForward];
    }

    self.buttonModeAt = MyButtonIdle;

} 
```

之后，只需将按钮的操作链接到我在 IBactions 之前的评论中提到的内容。我没有对此进行测试，但它应该可以工作。

# debugging - ssl/tls 握手分析器

> ID：15588606
> 
> 赞同：0
> 
> 时间：2013-03-23T15:37:30.697
> 
> 标签：debugging, ssl

我正在尝试在使用 socket.io 作为传输的浏览器（使用 forge js 库）和作为 TLS 服务器的 java 应用程序之间实现 tls 通信。tls 流量是 base64 编码的，所以我不能使用常规嗅探器（如 tcdump）来分析流量；我可以将流量转换回二进制，但仍然很难解释 tls 记录。是否有一种工具可以理解消息但不期望任何特定的流量传输？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T22:51:23.123

你当然可以使用 Wireshark。如果您没有使用通常使用 SSL/TLS 的端口，则可能必须右键单击数据包并选择*Decode As... -> SSL*。

（话虽这么说，在浏览器中使用 JavaScript 实现 TLS 没有什么意义：这[不会是安全](http://www.matasano.com/articles/javascript-cryptography/)的。）

# c++ - Aho-Corasick 算法

> ID：15588607
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:37:44.660
> 
> 标签：c++, string, aho-corasick

请帮我找出这段代码中的错误。我写了一个简单的程序，通过Aho-Corasick算法添加n个字符串来尝试，但它不能正常工作。输入字符串后它会崩溃。这段代码有什么问题？

```
#include <cstdlib>
#include <iostream>
#include <vector>
#define ALPHABET 26

using namespace std;

struct item
{
       int next[ALPHABET];
       int leaf;
       item()
       {
               for (int i = 0; i < ALPHABET; i++)
                       next[i] = -1;
               leaf = 0;
       }
};

vector <item> trie;

int add_string(string &s)
{
       int z = 0;
       item temp;
       for (int i = 0; i < s.length(); i++)
       {
              char c = s[i] - 'a';
              if (trie[z].next[c] == -1)
              {
                     trie[z].next[c] = trie.size();
                     trie.push_back(temp);}
                     z = trie[z].next[c];
              }
              trie[z].leaf = true;
       }
}

int main(int argc, char *argv[])
{
       int n;
       cin >> n;
       string s[n];
       for (int i = 0; i < n; i++)
              cin >> s[i];
       for (int i = 0; i < n; i++)
              add_string(s[i]);
       system("PAUSE");
       return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:50:46.690

我对算法一无所知，所以我不知道它是否运行正确。但是，仅基于通过 gdb 运行代码，您需要从`trie`向量中的至少一个元素开始。你可以通过写来做到这一点

```
vector <item> trie(1); 
```

其中`1`表示向量应该从多少个元素开始。通过这种更改，代码运行良好（但我不知道它是否正确运行算法）。

# sms - GSM SM5100B CMEERROR：4 错误

> ID：15588609
> 
> 赞同：3
> 
> 时间：2013-03-23T15:37:49.133
> 
> 标签：sms, arduino, send, gsm, at-command

我正在使用 Arduino 来控制 SM5100B GSM 设备，一切正常，除非我想在收到另一个短信后发送短信。我明白了，

错误代码：

> OK > + CMGS：2 5 OK + CMEERROR：4

我处理上述收到的短信的代码：

```
 #include <SoftwareSerial.h>  //Include the NewSoftSerial library to send serial commands to the cellular module. 
        char inchar;                //Will hold the incoming character from the Serial Port. 
        SoftwareSerial cell(2,3); 
        char mobilenumber[] = "0597010129";
        void setup() { 
        //GSM
        Serial.begin(9600); // opens serial port, sets data rate to 9600 bps
        Serial.println("Initialize GSM module serial port for communication.");                       
        cell.begin(9600); 
        delay(35000); // give time for GSM module to register on network etc. 
        Serial.println("delay off");
        cell.println("AT+CMGF=1"); // set SMS mode to text 
        delay(200); 
        cell.println("AT+CNMI=3,3,0,0"); // set module to send SMS data to serial out upon receipt 
        delay(200); 
        } 

        void loop() {   

         if(cell.available() >0)//If a character comes in, from the cellular module
         { 
         inchar=cell.read(); 
         Serial.println(inchar); 
         if (inchar=='#'){ // OK - the start of our command 

           delay(10); 
           inchar=cell.read();
           Serial.println(inchar);  

             if (inchar=='a'){ 

               delay(10); 
               Serial.println("The folowing SMS : \n");
               inchar=cell.read();
               Serial.println(inchar); 

               if (inchar=='0'){ //sequance = #a0

                 Serial.println("#a0 was received"); 

             }
             else if (inchar=='1'){//sequance = #a1

                Serial.println("#a1 was received ");
                sendSms();

             }
         }
         cell.println("AT+CMGD=1,4");// AT command to delete all msgs
         Serial.println(" delete all SMS"); 
          } 
        }//end of  if(cell.available() >0) {...}
        }

        void sendSms(){
        //cell.println("AT+CMGF=1"); // set SMS mode to text 
        cell.print("AT+CMGS=");  // now send message... 
        cell.print((char)34); // ASCII equivalent of " 
        cell.print(mobilenumber); 
        cell.println((char)34);  // ASCII equivalent of " 
        delay(500); // give the module some thinking time 
        cell.print(":D hello m3alleg :D");   // our message to send 
        cell.println((char)26);  // ASCII equivalent of Ctrl-Z 
        delay(20000);
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-23T20:25:41.377

## 关于处理 AT 命令的一般说明。

不不不！这种方法永远不会可靠地工作。在发送“要发送的文本”之前，您**必须** 等待接收到字符。`>`或者实际上不仅仅是`>`字符，它是四个字符。引自[3GPP 规范 27.005](http://www.3gpp.org/ftp/Specs/html-info/27005.htm)：

> *   TA 应 `<CR><LF><greater_than><space>` 在命令行以 ; 终止后发送一个四字符序列（IRA 13、10、62、32）`<CR>`；之后，文本可以从 TE 输入到 ME/TA。

（这里的TA（终端适配器）是调制解调器，TE（终端设备）是AT命令的发送者）

对于任何可中止的 AT 命令（以及 27.005 明确说明 AT+CMGS `This command should be abortable.`），发送任何字符都将中止命令的操作。引用[ITU V.250](http://www.itu.int/rec/T-REC-V.250-200307-I/en)：

> 5.6.1 中止命令
> 
> ...
> 
> 命令的中止是通过从 DTE 向 DCE 传输任何字符来完成的。

（这里的DCE（数据通信设备）是指调制解调器，DTE（数据终端设备）是AT命令的发送者）

这意味着当您在调制解调器发送“\r\n>”之前发送“要发送的文本”时，该命令将被中止。没有办法等待“足够长的时间”来期待响应被发送。您**必须**阅读并解析从调制解调器返回的响应文本。

这同样适用于每个命令之后的最终结果代码（例如`OK`, `ERROR`等`CME ERROR`）。例如发送“AT+CMGF=1”然后发送下一个命令而不先等待OK是在乞求问题。所以总是在发送 AT 命令时，您**必须**等待最终结果代码，然后再发送下一个命令。

请永远，永远不要用于`delay`等待任何 AT 命令响应。它就像踢狗一样有用，以使它们移动。是的，它有时可能确实有效，但在某些时候你会为采取这种方法而感到抱歉......

## 回答你的问题。

根据您收到的回复，我可以看出您的问题不是命令中止（尽管您的解析存在如上所述的严重问题，您应该修复），CME ERROR 是您最好的线索。从 27.007 中的“9.2.1 一般错误”部分，它给出`operation not supported`了值 4 的描述。

27.005 指出：

> 如果在网络中发送失败或 ME 错误，则返回最终结果代码 +CMS ERROR:。

请注意，这是 +CMS ERROR 而不是 +CME ERROR，但它是适用的，见下文。

我猜想动作顺序如下：

SM100B GSM 调制解调器的 AT 命令处理部分接受短信数据并将其格式化为适当的格式，并将其发送到与 GSM 网络通信的调制解调器部分。它成功地将短信数据发送到网络，并将其报告回 AT 命令处理部分，然后打印`+CMGS: 25`和最终结果代码`OK`。然而，在很短的时间后，网络会发回一条拒绝短信的消息，然后作为 +CME ERROR 响应给出。

如果我上面的猜测是正确的，那么响应是否应该以 +CMS ERROR 的形式传递？不，因为 AT+CMGS 命令的最终响应已经给出（OK），并且不应该为一个命令返回多个最终结果代码（除非错误（注 1））。虽然+CME ERROR 可以替换ERROR 最终结果代码，但它不仅仅是最终结果代码。来自 AT+CMEE 命令说明：

> 设置命令禁用或启用结果代码 +CME ERROR：作为与 MT 功能相关的错误的指示。启用后，与 MT 相关的错误会导致 +CME ERROR: final result code 而不是常规的 ERROR 最终结果代码。当错误与语法、无效参数或 TA 功能有关时，通常会返回 ERROR。

因此，+CME ERROR 既可以是最终结果代码，也可以是未经请求的结果代码（也可能是中间结果代码）。

但是AT+CMGS命令不能等待收到网络拒绝并返回+CMS ERROR吗？可能不是。如果不了解短信发送的网络详细信息，今天的拒绝可能会比以前晚得多。这种变化有时会成为与 GSM 相关的 AT 命令的问题，这些 AT 命令具有最初与 GSM 行为紧密相关的旧传统，随着技术转向 GPRS、UMTS、LTE 等，这种行为有时变得越来越不真实。

注1：

我的一位前同事曾经抱怨标准指定语音呼叫处理的方式，因为在 ATD1234 之后；命令你首先得到最终结果代码 OK，然后当调用结束时你得到一个新的最终结果代码 NO CARRIER。这种糟糕的设计，呼叫结束指示应该是特定的主动响应，而不是最终响应。

## 所以总结一下

您的短信似乎被网络拒绝了。尝试找出原因。你的 AT 命令处理也有一些严重的问题，你应该修复；如果不从调制解调器读取和解析响应文本，就无法处理 AT 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-13T20:09:41.727

```
cell.println("AT+CNMI=3,3,0,0"); // set module to send SMS data to
serial out upon receipt 
```

对于正在寻找相同问题的答案的任何人：

我试图**通过发送短信将 gsm 模块从睡眠模式中唤醒**，但它没有立即工作。电话直接发送到 UART，但对于短信，您必须使用此命令设置模块在收到短信数据时将短信数据发送到串口。

> AT+CNMI=3,3,0,0

# mysql - mysql中的自动增量可以增加2吗？

> ID：15588616
> 
> 赞同：0
> 
> 时间：2013-03-23T15:38:20.760
> 
> 标签：mysql, auto-increment

有什么方法可以在 mysql 中设置自动增量（我正在使用 phpmyadmin），以便它增加 2 ？

我希望它这样做的原因是我有 2 个表，但需要每个表的 id 不同。所以表 1 将变为 1、3,5，......而表 2 将变为 2、4、6......

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T15:41:22.387

Yes, you can it with this:

```
SET @@auto_increment_increment=2; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:03:59.520

MS SQL Server 使用 IDENTITY 关键字来执行自动增量功能。

默认情况下，IDENTITY 的起始值为 1，每增加一条新记录，它就会增加 1。

要指定列应从值 10 开始并以 2 递增，请将标识更改为 IDENTITY(10,2)。

# python - 取和数的平方

> ID：15588617
> 
> 赞同：-6
> 
> 时间：2013-03-23T15:38:24.363
> 
> 标签：python

此代码将所有自然数相加到 10，然后在 Python 中取该和的平方。我哪里做错了？

```
def square_of_sum():
    sum = 0
    for x in xrange(11):
        if x <= 10:
            x + sum = sum
            x += 1
        else: 
            print sum*sum
            break 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T15:39:34.937

啊，我看你喜欢[**Project Euler**](http://projecteuler.com) :)

## 解决方案

我认为这就是您的代码的意思：

```
def square_of_sum():
  sum_ = 0
  for x in xrange(1, 11):
    sum_ += x
  return sum_ ** 2 
```

要更惯用地重写它，请使用生成器理解和内置函数：

```
def square_of_sum():
  return sum(range(11)) ** 2 
```

如果您有性能意识，您可以通过注意到您找到算术级数的总和来消除循环：

```
def square_of_sum(x):
   print (x * (x + 1) / 2) ** 2 
```

## 修复

至于为什么您的代码不起作用，原因有很多。

首先，我认为您对`for`Python 中的循环如何工作感到困惑。基本上，它只是循环一个数组。当 x 大于 10 时，您不必检查和中断，也不必增加它。阅读有关如何使用循环的[Python 文档。](http://docs.python.org/2/tutorial/controlflow.html)`for`要查看何时使用它的示例，请参阅[wiki 页面](http://wiki.python.org/moin/ForLoop)。

其次，变量赋值是用左边的变量和右边的要计算的表达式来完成的。所以`x + sum = sum`真的应该是`sum = sum + x`或者`sum += x`为了简洁起见。

第三，`sum`是一个内置函数。您可能不想也不应该掩盖它，因此将您的`sum`变量重命名为其他名称。

最后，`sum*sum`相当于将其提高到 2 的幂，您可以使用`**`运算符来做到这一点：`sum ** 2`.

希望这有助于您理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T15:40:29.487

要修复代码中的错误：

```
def square_of_sum():
    s = 0
    for x in xrange(11):
        s += x
    print s**2 
```

或者，更惯用地说，

```
def square_of_sum(n):
    print sum(range(n + 1)) ** 2 
```

或者，要消除循环：

```
def square_of_sum(n):
    print (n * (n + 1) / 2) ** 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:45:36.917

几个问题。首先，`sum`是一个内置函数，所以你可能不想命名任何东西，所以使用一个名为类似的变量`total`。

其次，变量赋值是用左边的变量和右边的表达式完成的，所以`x + total = total`应该是`total = x + total`，或`total += x`为简洁起见。

第三，既然case when`x == 11`基本上只是一个return case，它应该在循环之外。

最后，`total * total`等价于`total ** 2`; 这更容易用于诸如

```
def square_of_sum():
    total = 0
    for x in xrange(11):
        if x <= 10:
            total += x
            x += 1
    print total ** 2 
```

但是，如果我是你，我会使用

```
sum(range(11))**2 
```

# javascript - 从托管 bean jsf2 访问 javascript 全局变量

> ID：15588619
> 
> 赞同：0
> 
> 时间：2013-03-23T15:38:28.027
> 
> 标签：javascript, jsf-2, managed-bean

有没有办法从托管 bean 访问 javascript 全局变量：

```
 var id = "";

        function affecter(id){
            $("#affecterHidden").val(id);
            alert(id);
        }

<h:inputHidden value="#{typeMB.selectedType.idtype}" id="affecterHidden" /> 
```

我想使用`f:setpropertyActionListener`，但它与我的目标不符

# ios - 具有多个子视图的 UIScrollView

> ID：15588620
> 
> 赞同：0
> 
> 时间：2013-03-23T15:38:32.180
> 
> 标签：ios, uiscrollview

我`UIScrollView`里面有很多其他的子视图。大多数子视图都是`UITextView`'s，当它们全部加载时，滚动和一切都很好。但是对于其中一个视图，我正在加载 a`UIView`和其中的`MKMapView`a `UITextView`。当用户想要滚动 时`UIScrollView`，他们不能触摸`UIView`或其内容。我无法设置`setUserInteractionEnabled`为 NO，因为我需要用户能够单击`MKMapView`然后转到另一个`UIViewController`地图。对此有什么建议吗？我有以下代码：

```
 CGRect dealDescRect = CGRectMake(10, 10, delegate.scrollView.frame.size.width - 22 - 20, 120);
    mapView = [[MKMapView alloc] initWithFrame:dealDescRect];
    mapView.layer.cornerRadius = cornerRadius;
    mapView.scrollEnabled = NO;
    mapView.zoomEnabled = NO;

    BOOL result = [self loadAddressIntoMap];
    if (result == TRUE) {
        UITapGestureRecognizer* recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];
        [mapView addGestureRecognizer:recognizer];
    }

    UITextView *addressTextView = [self generateTextView:addressText :5];
    addressTextView.editable = NO;
    [addressTextView setFont:[UIFont systemFontOfSize:fontSize]];
    [addressTextView setUserInteractionEnabled:NO];
    CGRect addressTextViewFrame = addressTextView.frame;
    addressTextViewFrame.origin.x = 0;
    addressTextViewFrame.origin.y = 130;
    addressTextViewFrame.size.height = addressTextView.contentSize.height + 15;
    addressTextView.frame = addressTextViewFrame;

    CGRect viewRect = CGRectMake(10, 145, delegate.scrollView.frame.size.width - 22, addressTextView.contentSize.height + 135);
    viewRect.origin.x = 11;
    viewRect.origin.y = startTop;
    UIView *view = [[UIView alloc] initWithFrame:viewRect];
    view.layer.cornerRadius = cornerRadius;

    [view setBackgroundColor:[UIColor whiteColor]];
    [view addSubview:mapView];
    [view addSubview:addressTextView]; 
```

**编辑**

出于某种奇怪的原因，如果我将其更改`UIView`为 a `UITextView`，它会起作用！不确定这里的真正解决方案是什么。我只是禁用编辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:44:21.280

如果是我，而不是使用手势识别器来观察地图上的点击，我会创建一个自定义类型 (UIButtonTypeCustom) 的 UIButton 并给它没有背景和文本，并将它放在地图的顶部与地图相同的框架。

这样做的好处是可以防止用户与地图进行交互，根据需要移动到下一页，并且如果用户开始滚动，即使他们能够在地图上滚动。

# hibernate - 带有 Hibernate over Cloud SQL 的 Google Endpoint 示例

> ID：15588622
> 
> 赞同：0
> 
> 时间：2013-03-23T15:38:50.153
> 
> 标签：hibernate, google-cloud-sql, google-cloud-endpoints

Google Endpoints 是否可以通过 Cloud SQL 与 Hibernate 一起使用？
有人可以为它发布一个简短的代码示例吗？
我尝试这样做并在生成客户端库时遇到了一般错误

语言班：

```
@Entity
@Table(name = "LANGUAGES")
public class Language  {

private String languageIsoCode;
private String languageName;

public Language() {}

@Id
@Column(name = "LANGUAGE_ISO_CODE", unique = true, nullable = false, length = 8)
public String getLanguageIsoCode() {
    return this.languageIsoCode;
}

public void setLanguageIsoCode(String languageIsoCode) {
    this.languageIsoCode = languageIsoCode;
}

@Column(name = "LANGUAGE_NAME", nullable = false, length = 160)
public String getLanguageName() {
    return this.languageName;
}

public void setLanguageName(String languageName) {
    this.languageName = languageName;
}
} 
```

语言端点类：

```
@Api
public class LanguageEndpoint {

@ApiMethod
public String getLanguage(){
    EntityManager mgr = getEntityManager();
    Query q = mgr.createQuery("from Language");
    Language l = (Language) q.getResultList().get(0);
    return l.getLanguageName();
}

private static EntityManager getEntityManager() {
    return EMF.hibernateGet().createEntityManager();
}

} 
```

和 EMF 类：

```
public final class EMF {
private static final EntityManagerFactory emfInstance = Persistence
        .createEntityManagerFactory("transactions-optional");

private static final EntityManagerFactory emfHibernateInstance = Persistence
        .createEntityManagerFactory("com.google.cloudsql.jpa");

private EMF() {
}

public static EntityManagerFactory get() {
    return emfInstance;
}

public static EntityManagerFactory hibernateGet() {
    return emfHibernateInstance;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T21:07:08.293

我想到了。
首先，eclipse插件只是写它在你尝试生成端点库时遇到了错误，你调用always use the good old scripts in the sdk (endpoints.cmd) 并获取完整的日志。

这是我在日志中看到的：“线程“主”java.lang.NoClassDefFoundError 中的异常：javax/persistence/EntityManager”

问题在于，尽管从项目中删除了 Datanucleus，但它的 jar 和 Hibernate 的 jar 中的某些功能似乎发生了冲突。因此，我没有使用标准的 JPA EMF，而是使用了 HibernateUtil 和 SessionFactory。

另一个问题是显然 String 不能用作 API 的返回值。

# dns - 每用户resolv.conf

> ID：15588624
> 
> 赞同：5
> 
> 时间：2013-03-23T15:38:57.460
> 
> 标签：dns

我的 linux 服务器有不同的用户 [u01 - u04]，我可以让每个用户使用特定的 resolv.conf 吗？

例如：

```
u01:  nameserver=10.14.15.123
u02:  nameserver=10.14.15.124
u03:  nameserver=10.14.16.125 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:20:07.853

简短的回答是否定的，请参阅[resolv.conf(5)](http://linux.die.net/man/5/resolv.conf)。但是，如果您真的想要此功能，您可以在共享库中重新实现[resolver(3)](http://linux.die.net/man/3/resolver)中的功能，并使用 ld-magic 覆盖原始功能，至少在动态链接的应用程序中是这样。

# android - 如何强制 Android 调试的内存压力？

> ID：15588625
> 
> 赞同：14
> 
> 时间：2013-03-23T15:38:58.520
> 
> 标签：android, debugging, memory

我正在尝试处理我的 Android 应用程序遇到的一些问题，我认为这些问题与我在显式“前台”模式 (Service.startForeground) 下运行时的内存压力有关。

为了调试它，我需要对我的应用程序施加内存压力，我可以通过各种方式来做到这一点，例如启动各种其他应用程序，例如带有大量网页的 Firefox。然而，这并不理想，因为它仍然相当耗时且不精确。所以我的问题是，有没有办法使用调试器（例如在 Eclipse 下）或专门为此目的的特殊应用程序来强制内存压力？我宁愿不绕道自己写一个，显然在我自己的应用程序中分配内存是行不通的。

更新：更改标题以反映我需要设备上的实际内存压力，而不是在仿真中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-21T05:39:15.673

**编辑：（考虑到克里斯托夫的评论）**

你可以制造人为的记忆压力。为此，请在 MainActivity 中创建一个按钮。然后，在按钮的`onClick`方法中，创建 10,000 个对象（实验不同数量的对象）。然后，当您的应用程序运行时，多次单击该按钮会产生很大的内存压力。

代码可能如下所示：

```
class MainActivity {
    ArrayList<String> stringArray = new ArrayList<>();

    ...

    public void click(View view) {
        // Add 10,000 String objects to Array List

        for (int i = 0; i < 10000; i++) {
        stringArray.add("A string");
        }
    }
} 
```

假设您将按钮的`onClick`XML 属性设置为`click`.

# php - 多个数据库查询串在一起

> ID：15588634
> 
> 赞同：0
> 
> 时间：2013-03-23T15:39:41.947
> 
> 标签：php, mysql, database

我正在尝试使用以下逻辑将一些表单数据放入两个数据库表中

*   `INSERT`表中的新监视`'watchlists'`列表
*   `SELECT watchlist_id`表中的新关注`'watchlists'`列表`WHERE watchlist_name = $watchlist_name`（刚刚创建的新关注列表的名称）和`user_id = $user_id`
*   `INSERT watchlist_id`（从上一个查询中选择）AND`film_id`到`'watchlist_films'`表中

我正在使用以下代码，但该过程似乎在运行`SELECT`查询时中断。在数据库中创建了新的监视列表，但它不会选择新监视列表的 ID，也不会运行代码的最后一部分。

```
if ($db_server) {
        // Add new Watchlisth
        if (!empty($watchlist_name)) {
            $watchlist_name = clean_string($watchlist_name);
            $watchlist_description = clean_string($watchlist_description);
            mysql_select_db($db_database);

            // Create new Watchlist
            $insert_new_watchlist = "INSERT INTO watchlists (user_id, name, description, category) VALUES ('$user_id', '$watchlist_name', '$watchlist_description', '$watchlist_category')";
            mysql_query($insert_new_watchlist) or die("Insert failed. " . mysql_error() . "<br />" . $insert_new_watchlist);

            // Select new Watchlist's ID
            $select_new_watchlist_query = "SELECT watchlist_id FROM watchlists WHERE name = " . $watchlist_name;
            $new_watchlist_id = mysql_query($select_new_watchlist_query);

            // Insert film into new Watchlist
            $add_new_film = "INSERT INTO watchlist_films (watchlist_id, film_id) VALUES ('$new_watchlist_id', '$rt_id')";
            mysql_query($add_new_film) or die("Insert failed. " . mysql_error() . "<br />" . $add_new_film);
            $addWatchlist_good_message = '<div class="alert alert-success">Watchlist created successfully, and film added!</div>';?>
            <script>
                $('a.add-watchlist').trigger('click');
            </script><?php
        }
    } else {
        $addWatchlist_bad_message = '<div class="alert alert-error">Error: could not connect to the database.</div.';?>
        <script>
            $('a.add-watchlist').trigger('click');
        </script><?php
    }
    require_once("db_close.php");
} 
```

我已经使用以下字符串在 phpMyAdmin 中运行了查询：（`SELECT watchlist_id FROM watchlists where name = "LotR"`其中 LotR 是新创建的监视列表的名称）并且效果很好，因为它将我带回监视列表的 ID，这是我想要传递到第二个这两个`INSERT`查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T17:12:59.277

`mysql_query()`返回*资源*数据类型，而不是字段值，因此请替换

```
$new_watchlist_id = mysql_query($select_new_watchlist_query); 
```

和

```
$result=mysql_query($select_new_watchlist_query);
$new_watchlist_id=mysql_result($result,0) 
```

# javascript - 如何在 Rails 应用程序中阻止引导轮播

> ID：15588640
> 
> 赞同：0
> 
> 时间：2013-03-23T15:39:58.953
> 
> 标签：javascript, ruby-on-rails, twitter-bootstrap

好的......这是我的代码......现在......当页面加载时第一个图像不会移动......但是一旦访问者选择下一个图像然后停止选择图像......轮播开始以每张图像的默认 5 秒自动循环。我根本不希望旋转木马自动循环。我希望网站访问者只有在单击下一步按钮时才能移动图像。

我错过了什么？

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <title>Home</title>
  <meta name="description" content="">
  <meta name="author" content="">
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <script>
  $(function(){
    $('.carousel').carousel({
      interval: false
    });
  });
  </script>
</head>
<body>
  <div class="container">
    <header class="navbar navbar-fixed-top">
      <nav class="navbar-inner">

      </nav>
    </header>
    </div>

    <div id="main" role="main">
      <div class="container">
        <div class="content">
           <div class="row">
            <div class="span12">
              <!-- yeild goes here -->
              <h1><%= image_tag "logo.png", :title => "Home", :class => "logo" %></h1>
              <div id="myCarousel" class="carousel slide">
                <ol class="carousel-indicators">
                  <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#myCarousel" data-slide-to="1"></li>
                  <li data-target="#myCarousel" data-slide-to="2"></li>
                  <li data-target="#myCarousel" data-slide-to="3"></li>
                </ol>
                <!-- Carousel items -->
                <div class="carousel-inner">
                  <div class="active item"><%= image_tag "home_1.jpg", :title => "title", :class => "class" %></div>
                  <div class="item"><%= image_tag "home_2.jpg", :title => "title", :class => "class" %></div>
                  <div class="item"><%= image_tag "home_3.jpg", :title => "title", :class => "class" %></div>
                  <div class="item"><%= image_tag "home_4.jpg", :title => "title", :class => "class" %></div>
                </div>
                <!-- Carousel nav -->
                <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
                <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
              </div>
              <!-- yeild ends here -->
            </div>
          </div>
        </div>
      </div> <!--! end of .container -->
    </div> <!--! end of #main -->
    <div class="container">
      <footer class="navbar navbar-fixed-bottom"><!--! TODO footer goes here -->
        <nav class="navbar-inner">

        </nav>
      </footer>
    </div>
</body>
</html> 
```

# java - 用 Jongo 解组聚合结果

> ID：15588641
> 
> 赞同：2
> 
> 时间：2013-03-23T15:40:00.783
> 
> 标签：java, mongodb, jongo, mongo-jackson-mapper

我正在使用MongoDB聚合框架查询一个文档，结果如下：

```
{
        "result" : [
                {
                        "_id" : "luke",
                        "times" : 8
                },
                {
                        "_id" : "albert",
                        "times" : 4
                },
                {
                        "_id" : "matt",
                        "times" : 4
                }
        ],
        "ok" : 1
} 
```

从上面的结果可以看出，查询在 mongoDB shell 中工作，但是我在使用 Jongo 获取结果时遇到了问题：

```
 Aggregationoutput = 
                gamesCollection.aggregate(
                "{ ... }"
                ).as(Aggregation.class);
        output.results().iterator().hasNext(); 
```

主要问题似乎是 Jongo 不允许我使用`AggregationOutput`？他想要`Aggregation`...但找不到任何关于如何使用它的示例

**编辑：** 我有点沮丧，我不能让 Jongo 使用聚合。`DBObjects`我必须按照 MongoDB Java 驱动程序中指定的方式编写查询，但代码看起来真的很难看..

**EDIT2：** 只是为了完成信息，这是我与 Jongo 一起使用的原始聚合，它无法解组为 ResultObject

```
List<ResultObject> output = 
                gamesCollection.aggregate(
                "{ $match: { 'playersList.playerid': 'bob' }},"
                +"{ $unwind: '$playersList' },"
                +"{ $match: { 'playersList.playerid':  { $ne: 'bob' } } },"
                +"{ $group: { _id: '$playersList.playerid', times: { $sum : 1} } },"
                +"{ $sort: { times: -1 } }"
                ).as(ResultObject.class);

class ResultObject{
  String _id;
  int times;
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T15:15:06.460

您可以使用诸如 find/findOne 之类的聚合功能... 结果会自动解组到 Pojo 中：

```
List<Email> emails = collection.aggregate("{$project:{sender:1}}")
          .and("{$match:{tags:'read'}}")
          .and("{$limit:10}")
          .as(Email.class); 
```

您可以在这里找到更多示例：[https ://github.com/bguerout/jongo/blob/master/src/test/java/org/jongo/AggregateTest.java](https://github.com/bguerout/jongo/blob/master/src/test/java/org/jongo/AggregateTest.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-21T16:34:10.427

我现在才看到这个问题，但我希望它可以帮助其他人。你可以像这样创建一个内部类：

```
private static class AggregateResult {
        String _id;
        int time;
    } 
```

并调用聚合函数如下：

```
List<AggregateResult> res =  gamesCollection.aggregate(
                "{ ... }"
                ).as(AggregateResult.class); 
```

然后您可以遍历 res 列表中的结果。

# javascript - 在 jquery 或 javascript 中将内部链接更改为外部链接

> ID：15588642
> 
> 赞同：3
> 
> 时间：2013-03-23T15:40:04.400
> 
> 标签：javascript, jquery

我正在研究一个应用程序女巫从不同的网站获取其内容。在获得的内容中有时是内部链接。我需要将[http://www.olddomain.com](http://www.olddomain.com)添加到这些链接的 href 值中，以确保它们仍然可以在我的应用程序中工作。

数据在一个变量中：文本

可变文本包含：

```
<p style="text-align: right;">
    Lots of text in here, with all kind of html tags, <br /><br /> 
    when suddenly a link appears:
    <a href="/niceinternalpage.html">Here!</a>
</p> 
```

我需要的输出：

```
<p style="text-align: right;">
    Lots of text in here, with all kind of html tags, <br /><br /> 
    when suddenly a link appears:
    <a href="www.olddomain.com/niceinternalpage.html">Here!</a>
</p> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:48:06.387

您不需要 jQuery 在现代浏览器中执行此操作，您可以使用 jQuery 来`document.getElementsByTagName`获取`a`页面上的所有标签：

```
// document.getElementsByTagName returns a `NodeList` - it looks like an `Array`
// but lacks all of the methods; so we use `Array.prototype.slice` to turn it
// into a 'real' `Array` so we can filter and loop over it.
aTags = Array.prototype.slice.call(document.getElementsByTagName("a")),
    externalUrl = "http://www.olddomain.com";

// Make use of `filter` to return an Array of all `a` tags whose `href` attribute
// is unqualified (eg: does not start with `http`, again you may wish to make this
// filtering logic more complex).
//
// We then chain a `forEach` call to the result of the `filter` call which prepends
// the `externalUrl` to the `a` tag's `href` attribute.
aTags
    .filter(function (aTag) { 
        return aTag.href.match(/^http/) === null;
    })
    .forEach(function(unqualifiedATag) { 
        var unqualifiedUrl = unqualifiedATag.href;

        // Add a leading forward slash.
        if (unqualifiedUrl.charAt(0) !== "/") {
            unqualifiedUrl = "/" + unqualifiedUrl;
        }

        // Update the aTag's href attribute to fully qualify it.
        unqualifiedATag.href = externalUrl + unqualifiedATag.href;
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:46:02.803

您可以使用[attr()](http://api.jquery.com/attr/)分配更改的值`href`

**[现场演示](http://jsfiddle.net/mF8XP/1/)**

```
$(variable).find('a').attr('href', function(idx, attrValue){ 
   return 'http://www.olddomain.com' + attrValue;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:44:34.173

你可以这样做：

```
var $content = $(text);
$content.find('a').each(function() {
   $(this).attr('href', 'http://www.olddomain.com' + $(this).attr('href') );
});
$content.insertAfter('#elementinyourpage'); 
```

我还添加了将修改后的内容插入当前页面的调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:45:42.770

```
var uri = $('a').attr('href');
$('a').attr('href', 'www.olddomain.com' + uri); 
```

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-23T15:50:44.443

如果您有内部和外部链接，您可以尝试正则表达式替换，如下所示：

```
$('a').each(function() {
    this.href = this.href.replace(/^\/(.*)/, 'http://www.externaldomain.com/$1');
}); 
```

# ruby - Rails 3 - 反序列化只返回 ActiveRecord::AttributeMethods::Serialization::Attribute

> ID：15588643
> 
> 赞同：3
> 
> 时间：2013-03-23T15:40:08.877
> 
> 标签：ruby, activerecord, serialization, ruby-on-rails-3.2

我最近将一个旧`Rails 2.3`应用程序（Ruby 1.8.7）升级到`Rails 3.2 / Ruby 1.9.3`. 当使用 ActiveRecord 序列化并尝试访问序列化属性时，我得到：

```
 ActiveRecord::AttributeMethods::Serialization::Attribute returned.
 .unserialize then returns the actual value. 
```

真正奇怪的是，有一些模型具有正常的行为。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T08:43:40.933

我现在知道什么时候会出现这个问题，但我仍然不知道为什么：

这有效：

```
User < ActiveRecord::Base
    serialize :options, Hash
end 
```

选项返回 {}

如果我在序列化之前调用模型本身，就像这样：

```
User < ActiveRecord::Base
  USER_LIST = User.all.map {|u| [u.name, u.id]}

  serialize :options, Hash
end 
```

我得到 ActiveRecord::AttributeMethods::Serialization::Attribute

有人有想法吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T17:14:02.533

尝试使用 unserialized_value 而不是 unserialize，所以它是否已经被反序列化并不重要。作为参考，请在此处查看 unserialized_value 方法的源代码[http://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Serialization/Attribute.html](http://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Serialization/Attribute.html)

# c - C programming "weird output"

> ID：15588651
> 
> 赞同：0
> 
> 时间：2013-03-23T15:40:24.723
> 
> 标签：c, arrays, string

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:55:08.043

`printf`的`%c`说明符意味着打印相应的字符，所以`100`->`d`等。由于您的数字与 ASCII/Unicode 无关，因此您会得到看似随机的字符。

只需更改`%c`for `%d`，它会打印整数。还有许多其他标志，例如`%f`用于浮点数和双精度数。您还可以应用格式，例如前导零等。

请参阅这个方便的参考：[http ://www.cplusplus.com/reference/cstdio/fprintf/](http://www.cplusplus.com/reference/cstdio/fprintf/)

# java - Displaying Java Applet format

> ID：15588655
> 
> 赞同：0
> 
> 时间：2013-03-23T15:40:36.950
> 
> 标签：java, networking, applet

I do not usually use applet or GUI in java, am still learning the basics. But i got a project to do which exceptionally uses Applet. It is a localhost portscanner.

```
import java.net.Socket;

import javax.swing.*;
@SuppressWarnings("serial")
public class portScan extends JApplet{

    String remote = "localhost";
     int i = 0;
     String message;

     public portScan(){
         do {
           try {
           Socket s = new Socket(remote,i);
           s.close();
           message = "Server is listening on port " + i + " of " + remote;
           JOptionPane.showMessageDialog(rootPane, message);

           } catch (Exception e) {
           //System.out.println("Server is not listening on port " + i+ " of " + remote);
                }
           i++;
          } while(i <= 100);
     }

} 
```

This generates dialog messages for each port and works correctly inside of eclipse!

once i put in inside an html file, it loads, but does not show the dialog output.

I want to know how to better display the result in a list instead of each time a dialog popping up for each port and to work in the browser too (instead of just appearing in the eclipse IDE).

This how i load the class in html

```
<applet code="applets/portScan.class" width="80%" height="80%> </applet> 
```

UPDATE!!

I just signed it, but still no display. I created a new Java project with only the portscanner applet, i exported it to a file Applets.jar. Then i signed as such :

```
keytool -genkey -alias myAlias -keystore myCert -keypass myKeyPass -dname "CN=Applets" -storepass myStorePass -validity 1825

jarsigner -keystore myCert -keypass myKeyPass -storepass myStorePass Applets.jar myAlias 
```

Then i place the Applets.jar under folder applets/Applets.jar, and change the html code to :

```
<applet id="Applets"
            code = "portScan.class"
            archive="applets/Applets.jar"
            width="80%"
            height="80%">
    </applet> 
```

Still i get no display in the browser

# oracle - 来自多行的 Pearson 相关性

> ID：15588658
> 
> 赞同：0
> 
> 时间：2013-03-23T15:40:55.023
> 
> 标签：oracle, plsql

我想计算两个数组之间的 Pearson 相关性。

函数 CORR 只接受必须在表中的 2 个值。在我的过程中，我从两个不同的集合中选择多行数字，我想计算它们的相关性。

编辑：

corr 函数是一个 oracle 函数，用于计算两个值之间的 pearson 相关性。这是问题所在。我想计算两个数组之间的相关性，这对我来说 array1 类似于 array2，例如 50%。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:34:25.570

您可以简单地计算成对相关性的平均值

```
select 
  (abs(corr1) + abs(corr2) + abs(corr3))/3 as Avg_Corr
from (
  SELECT 
    CORR(a.col1, b.col1) as corr1,
    CORR(a.col2, b.col2) as corr2,
    CORR(a.col3, b.col3) as corr3
  FROM table1 a, table2 b
  WHERE a.id = b.id
) 
```

或使用更复杂但更充分[的 Pearson 相关性泛化](http://en.wikipedia.org/wiki/RV_coefficient)（Oracle 中没有用于此的内部函数）

# android - Syntax error on token(s), misplaced construct(s) Android

> ID：15588667
> 
> 赞同：0
> 
> 时间：2013-03-23T15:41:42.943
> 
> 标签：android

I am a complete novice at Android and I am trying to add a splash screen following an online tutorial here: [http://www.slideshare.net/YasmineSherif91/android-application-how-to-add-a-splash-screen-with-timer-tutorial-4](http://www.slideshare.net/YasmineSherif91/android-application-how-to-add-a-splash-screen-with-timer-tutorial-4)

I am now getting the error Syntax error on token(s), misplaced construct(s) and I cannot for the life of me work out why. Any help much appreciated. Thanks My code is below

```
 protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.splash_screen);
    Thread logoTimer - new Thread (){
        public void run(){
            try{
                    int logoTimer = 0;
                    while (logoTimer<5000){
                        sleep(100);
                        logoTimer-=logoTimer+100;
                        }
                    startActivity(new Intent("com.nrobson.mot2.Clearscreen"))
                    )
                    finally(
                            finish());
        }
    };
    }
    logoTimer.start(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T15:45:57.507

你有很多语法错误。尝试使用：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.splash_screen);
    Thread logoTimer = new Thread() {
        public void run() {
            try {
                int logoTimer = 0;
                while (logoTimer < 5000) {
                    try {
                        sleep(100);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    logoTimer -= logoTimer + 100;
                }
                startActivity(new Intent("com.nrobson.mot2.Clearscreen"));
            } finally {
                finish();
            }
        }
    };
    logoTimer.start();
} 
```

这是您遇到的错误（可能不完整）列表：

*   尝试使用`-`而不是`=`
*   `logoTimer.start();`在你的方法体之外
*   使用`(`and代替and `)`_`finally``{``}`
*   睡觉时缺少`try-catch`块`InterruptedException`
*   末尾缺少分号`startActivity(new Intent("com.nrobson.mot2.Clearscreen"))`
*   未对齐的括号

此外，该行：

```
logoTimer -= logoTimer + 100; 
```

转换为：

```
logoTimer = logoTimer - (logoTimer + 100); 
```

你确定你想要那个吗？

# sql - sql语法分组依据

> ID：15588668
> 
> 赞同：0
> 
> 时间：2013-03-23T15:41:54.727
> 
> 标签：sql, sql-server

由于我不擅长 sql 和设计器无法使用 OVER ，因此为此苦苦挣扎。基本上，如果用户关注关联的标签，这将获取主题列表。

我需要分组`T.TopicId`以停止重复。如果用户选择与某个主题相关的多个标签，它将列出该主题两次（每个标签一次）

当我在 sql 中添加 group by 时，出现多个错误，并且我尝试重新安排事物并且无法使其正常工作，正如所说的，我对 sql 语句没用

```
@id int = null
AS
SELECT
*
FROM
(SELECT
    ROW_NUMBER()
        OVER 
            (ORDER BY TopicOrder desc
             ,
             (CASE 
                WHEN M.MessageCreationDate > T.TopicCreationDate THEN M.MessageCreationDate
                ELSE T.TopicCreationDate
            END) desc)
        AS RowNumber
    ,T.TopicId, T.TopicTitle, T.TopicShortName, T.TopicDescription, T.TopicCreationDate, T.TopicViews, T.TopicReplies, T.UserId, T.TopicTags, T.TopicIsClose, 
                     T.TopicOrder, T.LastMessageId, T.UserName, M.MessageCreationDate, M.UserId     AS MessageUserId, MU.UserName AS MessageUserName, U.UserGroupId, 
                     U.UserPhoto, T.UserFullName
FROM            Tags INNER JOIN
                     TopicsComplete AS T ON T.TopicId = Tags.TopicId LEFT OUTER JOIN
                     Messages AS M ON M.TopicId = T.TopicId AND M.MessageId = T.LastMessageId AND     M.Active = 1 LEFT OUTER JOIN
                     Users AS MU ON MU.UserId = M.UserId LEFT OUTER JOIN
                     Users AS U ON U.UserId = T.UserId LEFT OUTER JOIN
                     tagfollows AS TF ON @id = TF.userid
WHERE        (Tags.Tag = TF.tag)
 )T 
```

如果有人可以提供帮助，将不胜感激，谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:13:01.597

您说您想在用户关注的集合中显示带有标签的帖子，但您不希望帖子在具有多个匹配标签时多次显示。[`EXISTS`这是子查询](http://msdn.microsoft.com/en-us/library/ms188336.aspx)的完美用途。这是该 MSDN 页面中的一个示例。

```
SELECT a.FirstName, a.LastName
FROM Person.Person AS a
WHERE EXISTS
(SELECT * 
    FROM HumanResources.Employee AS b
    WHERE a.BusinessEntityID = b.BusinessEntityID
    AND a.LastName = 'Johnson'); 
```

您对 person 表（例如您的 posts 表）非常感兴趣，但您希望显示在 employee 中至少有一条匹配记录的记录（例如您的 tags 表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:17:33.763

我认为您只需要将联接转换`tagfollows`为`EXISTS`子查询（并删除多余的嵌套）：

```
SELECT
    ROW_NUMBER()
        OVER ( ORDER BY TopicOrder desc
                      , CASE WHEN M.MessageCreationDate > T.TopicCreationDate 
                            THEN M.MessageCreationDate
                            ELSE T.TopicCreationDate
                        END desc )
        AS RowNumber,
    T.TopicId, T.TopicTitle, T.TopicShortName, T.TopicDescription, 
    T.TopicCreationDate, T.TopicViews, T.TopicReplies, T.UserId, 
    T.TopicTags, T.TopicIsClose, T.TopicOrder, T.LastMessageId, 
    T.UserName, M.MessageCreationDate, 
    M.UserId    AS MessageUserId, 
    MU.UserName AS MessageUserName, 
    U.UserGroupId, U.UserPhoto, T.UserFullName
FROM
        TopicsComplete AS T
    LEFT OUTER JOIN
        Messages AS M        ON  M.TopicId = T.TopicId 
                             AND M.MessageId = T.LastMessageId
                             AND M.Active = 1 
    LEFT OUTER JOIN
        Users AS MU          ON  MU.UserId = M.UserId 
    LEFT OUTER JOIN
        Users AS U           ON  U.UserId = T.UserId
WHERE   EXISTS
        ( SELECT  *
          FROM    Tags
              INNER JOIN tagfollows AS TF
                  ON  Tags.Tag = TF.tag 
          WHERE   T.TopicId = Tags.TopicId 
            AND   @id = TF.userid   
        ) ; 
```

# php - php mail form error

> ID：15588677
> 
> 赞同：0
> 
> 时间：2013-03-23T15:43:25.150
> 
> 标签：php

I am trying to send an email through php using this:

```
<?php
mail("my_email", "Test Message", "welcome to the test message") or die("Error!");
?> 
```

But when i run this in php the email doesnt come through and no error message is created and the die message does not appear anywhere.

I have got this information from [http://www.php.net/manual/en/function.mail.php](http://www.php.net/manual/en/function.mail.php)

What have i done wrong? I have been looking but i am unable to find out if its a problem with php or my server and everything i have followed has failed.

can someone clarify this?

----EDIT----

By the looks of it i need to do some more research in this matter, thanks for all your help and ill do some more work

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:18:59.213

基本实现，但是，如果上述方法不起作用，那么我确定您需要设置[MTA](http://en.wikipedia.org/wiki/Message_transfer_agent)

**HTML 代码**

```
<form action="mail.php" method="post">
  <input type="text" name="email" />
  <input type="submit" value="submit mail" />
</form> 
```

**PHP代码：**

```
if (isset($_POST['email']) && !empty($_POST['email'])) {
  $userEmail = $_POST['email'];
  $to = strip_tags($userEmail);
  $subject = "email subject";
  $message= 'email body message goes here';
  $headers = "From: anotheremail@test.com";

  if (mail($to,$subject,$message,$headers)) {
    echo "mail sent";
  }  else {
    echo "error sending mail";
  }
} 
```

# java - Java OutofMemory 奇怪的错误

> ID：15588680
> 
> 赞同：3
> 
> 时间：2013-03-23T15:43:33.360
> 
> 标签：java, performance, memory-management

我已经`jar`使用以下命令从命令行启动了

```
java -Xms1200m -Xmx1500m -jar xxx.jar 
```

我正在创建`BufferedImage`大小为 12600 * 12600 的内容，这意味着它需要

*以下代码中有606 MB*内存

```
TranscoderInput input = new TranscoderInput(sr);

            String pngFile = "Style-" + shoeViewer.getCurrentStyle() + "_"
                    + shoeViewer.getSelectedMetadata().getSizeLabel()
                    + "_400DPI" + ".png";

            File outputFile = new File(pngFile);

            FileOutputStream fo = new FileOutputStream(outputFile);

            TranscoderOutput output = new TranscoderOutput(fo);

            long now = System.currentTimeMillis();

            t.transcode(input, null); 
```

当我在执行上述行之前调试内存使用时，我的运行时显示

我需要 606 MB 的内存，而*1100* MB 仍然可用。

因此，当我在 34 分钟后运行上面的代码时，它会抛出`OutOfMemory`Exception 。

**问题是什么 ？是进程问题还是堆问题？为什么需要34分钟？？**

我的电脑配置如下

```
Windows 32bit XP Service Pack2 Home Edition
Amd Athlon (tm) 7750 Dual Core 2.71 GHz
2GB of DDR2 RAM
java version "1.7.0_17"
Java(TM) SE Runtime Environment (build 1.7.0_17-b02)
Java HotSpot(TM) Client VM (build 23.7-b01, mixed mode, sharing) 
```

请帮我解决这个问题。

下面是带有调试消息的异常堆栈tarce。

在运行上面的代码之前，我将 VM 参数更改为以下

```
java -Xms900m -Xmx1024m -XX:MinHeapFreeRatio=40 -XX:MaxHeapFreeRatio=70 -jar myjar.jar 
```

**从 SVG 阅读器构建 XML 文档.... 从 SVG 阅读器构建 XML 文档已完成.... 将修改后的 XML 文档转换为字符串写入器.... 将修改后的 XML 文档转换为字符串写入器.... 已声明字节 766 Avaialbel 字节900189232 内存统计------------------------ 总内存为字节：912326656 总内存为兆字节：870 已用内存为字节：9308384 已用内存为兆字节： 8 可用内存为字节：900189096 可用内存为兆字节：858**

* * *

转码开始于：Sun Mar 24 11:09:59 IST 2013

```
Exception in thread "AWT-EventQueue-0" java.lang.OutOfMemoryError: Java heap spa
ce
        at java.awt.image.DataBufferInt.<init>(Unknown Source)
        at java.awt.image.SinglePixelPackedSampleModel.createDataBuffer(Unknown
Source)
        at java.awt.image.Raster.createWritableRaster(Unknown Source)
        at org.apache.batik.gvt.renderer.StaticRenderer.updateWorkingBuffers(Sta
ticRenderer.java:536)
        at org.apache.batik.gvt.renderer.StaticRenderer.repaint(StaticRenderer.j
ava:375)
        at org.apache.batik.gvt.renderer.StaticRenderer.repaint(StaticRenderer.j
ava:344)
        at org.apache.batik.transcoder.image.ImageTranscoder.transcode(ImageTran
scoder.java:111)
        at org.apache.batik.transcoder.XMLAbstractTranscoder.transcode(XMLAbstra
ctTranscoder.java:142)
        at org.apache.batik.transcoder.SVGAbstractTranscoder.transcode(SVGAbstra
ctTranscoder.java:156)
        at com.mmg.app.eventlistener.PlaceOrderActionListener.save(PlaceOrderAct
ionListener.java:302)
        at com.mmg.app.eventlistener.PlaceOrderActionListener.saveCanvas(PlaceOr
derActionListener.java:270)
        at com.mmg.app.eventlistener.PlaceOrderActionListener.actionPerformed(Pl
aceOrderActionListener.java:143)
        at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
        at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
        at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
        at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
        at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Sour
ce)
        at java.awt.Component.processMouseEvent(Unknown Source)
        at javax.swing.JComponent.processMouseEvent(Unknown Source)
        at java.awt.Component.processEvent(Unknown Source)
        at java.awt.Container.processEvent(Unknown Source)
        at java.awt.Component.dispatchEventImpl(Unknown Source)
        at java.awt.Container.dispatchEventImpl(Unknown Source)
        at java.awt.Component.dispatchEvent(Unknown Source)
        at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
        at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
        at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
        at java.awt.Container.dispatchEventImpl(Unknown Source)
        at java.awt.Window.dispatchEventImpl(Unknown Source)
        at java.awt.Component.dispatchEvent(Unknown Source)
        at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
        at java.awt.EventQueue.access$200(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T22:51:52.570

即使原始未编码图像仅填充大约 600 MB，编码器中的内部表示也可能需要更多内存，具体取决于其实现方式。以下示例显示了将简单 svg 文件缩放到 12600 x 12600（32 位）时使用的内存量。

```
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.OutputStream;

import org.apache.batik.transcoder.TranscoderInput;
import org.apache.batik.transcoder.TranscoderOutput;
import org.apache.batik.transcoder.image.PNGTranscoder;

public class Test {
    public static void main(String[] args) throws Exception {
        PNGTranscoder t = new PNGTranscoder();
        t.addTranscodingHint(PNGTranscoder.KEY_WIDTH, new Float(12600));
        t.addTranscodingHint(PNGTranscoder.KEY_HEIGHT, new Float(12600));
        FileInputStream fis = new FileInputStream("C:\\StackOverflow\\SVG-logo.svg");
        TranscoderInput input = new TranscoderInput(fis);
        OutputStream ostream = new FileOutputStream("C:\\StackOverflow\\res.png");
        TranscoderOutput output = new TranscoderOutput(ostream);

        System.out.println("AllocatedMemory: \t" + (Runtime.getRuntime().totalMemory() / 1024) + " Kb");
        t.transcode(input, output);
        System.out.println("AllocatedMemory: \t" + (Runtime.getRuntime().totalMemory() / 1024) + " Kb");

        ostream.flush();
        ostream.close();

    }
} 
```

On my machine the output is:

```
AllocatedMemory:    4096 Kb 
AllocatedMemory:    1677721 Kb 
```

So here the program uses 1677 MB to transcode a simple SVG file to a 12600 * 12600 PNG file.

# java-me - In J2ME, How to pause and resume the thread

> ID：15588681
> 
> 赞同：1
> 
> 时间：2013-03-23T15:43:33.990
> 
> 标签：java-me, gps, jsr179

In my j2me app I have an array of double data type containing 5 coordinates value. This array is inside the thread to continuously check whether the same values is given by GPS.

Once it get correct match, I want to pause the thread then remove match found value from thread and resume the thread. I want this should be happen till array contains coordinates values. Once array got empty I want to pause the thread till it get new value, Once again when array gets values it should start again.

How should I implement this logic in code?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T06:17:30.060

如果是我，我不会费心让线程暂停。我只是让它一直运行。

```
while (true) {

 for (coordinate in arrayOfCoordinates) {
  if (checkLocation(coordinate)) removeFromArray(coordinate);
 }

try { Thread.sleep(5000); } catch (Exception e) {}

} 
```

我看不出有什么理由让线程暂停，因为它只进行了你描述的这么小的检查。

# python - 这个对象来自哪里

> ID：15588682
> 
> 赞同：0
> 
> 时间：2013-03-23T15:43:38.213
> 
> 标签：python, object

我是一个相对较新的程序员，我正在制作游戏。我正在使用我以前的项目中运行良好的一些代码。但是现在当我尝试调用某个我认为不需要任何参数的函数时，它会返回一些奇怪的错误。

我有从我以前的项目中复制的这个类：

```
import pyglet as p

class Button(object):
    def __init__(self, image, x, y, text, on_clicked):
        self._width = image.width
        self._height = image.height
        self._sprite = p.sprite.Sprite(image, x, y)
        self._label = p.text.Label(text,
                                  font_name='Times New Roman',
                                  font_size=20,
                                  x=x + 20, y=y + 15,
                                  anchor_x='center',
                                  anchor_y='center')
        self._on_clicked = on_clicked  # action executed when button is clicked

    def contains(self, x, y):
        return (x >= self._sprite.x - self._width // 2
            and x < self._sprite.x + self._width // 2
            and y >= self._sprite.y - self._height // 2
            and y < self._sprite.y + self._height // 2)

    def clicked(self, x, y):
        if self.contains(x, y):
            self._on_clicked(self)

    def draw(self):
        self._sprite.draw()
        self._label.draw() 
```

我有调用函数的窗口事件（w 是窗口）：

```
@w.event
def on_mouse_press(x, y, button, modifiers):
    for button in tiles:
        button.clicked(x, y) 
```

以及它调用的函数的三种变体，每个变体都有不同的“错误”：

```
def phfunc(a):
    print(a) 
```

返回这个东西：`<Button.Button object at 0x0707C350>`

```
def phfunc(a):
    print('a') 
```

返回：a 它实际上应该

```
def phfunc():
    print('a') 
```

返回一长串回调，结果如下：

```
 File "C:\Google Drive\game programmeren\main.py", line 15, in on_mouse_press
    button.clicked(x, y)
  File "C:\Google Drive\game programmeren\Button.py", line 25, in clicked
    self._on_clicked(self)
TypeError: phfunc() takes no arguments (1 given) 
```

我最好的猜测是它的参数是 Button 类中的 self 。这是正确的，我应该担心这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:55:08.680

`self._on_clicked`您将存储在with中的函数引用`self`作为参数调用。`self`是你的`Button`类的实例：

```
self._on_clicked(self) 
```

`Button`您的自定义类的默认表示是`<Button.Button object at 0x0707C350>`.

既然你明确地这样做了，那就不用担心了。

# xaml - Button in UserControl in main page not reacting to pointer in Windows Store apps

> ID：15588685
> 
> 赞同：0
> 
> 时间：2013-03-23T15:44:08.257
> 
> 标签：xaml, user-controls, windows-store-apps

To share a common display layout in a Split template Windows Store app, I put a Back button, title TextBlock, and another button in a UserControl, and then use that control in most of my pages. My problem is that in the main page, neither of the buttons will react to pointer activity, be it pointer over or clicking. However, it works fine in any other page. To isolate it, I created a blank app and duplicated the UserControl, but it works in that case.

How can I debug this?

Thanks.

-John

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:47:25.770

在“拆分”模板应用的“ItemView”页面中，包含后退按钮和标题的 Grid 必须位于 XAML 代码中的 GridView 和 ListView 下方。显然 GridView，没有 Grid.Row，并且 Grid.RowSpan="2" 需要覆盖第一行和第二行，如果按钮在 GridView 下方，它必须假设它不可见，不需要响应事件。我将我的新用户控件实例移动到 GridView 下方，按钮现在可以使用。

覆盖两行的整个方案对我来说毫无意义，但是如果没有 Grid.RowSpan="2"，这些项目对我来说不会很好地分成两行。我认为这种奇怪的布局应该在模板中进行解释。也许它可以将其他人从同样的问题中拯救出来。

# asp.net-mvc-4 - 基于 UserId 的 MVC 4 查找用户名

> ID：15588686
> 
> 赞同：0
> 
> 时间：2013-03-23T15:44:23.540
> 
> 标签：asp.net-mvc-4, entity-framework-5

我在 VS 2012 中使用 MVC 4 模板。我启用了一个评论部分，它将登录用户的 UserId 存储到一个表中。当我显示评论时，我想从 UserProfiles 表中显示用户的用户名和电子邮件。

我试过以下代码：

```
public static string GetUserName(int userId)
{
    using (var db = new UsersContext())
    {
        return db.UserProfiles.Single(x => x.UserId == userId).UserName;
    }
} 
```

但我得到一个例外：

```
The model backing the 'UsersContext' context has changed since the database was created. Consider using Code First Migrations to update the database (http://go.microsoft.com/fwlink/?LinkId=238269). 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:56:35.473

例外非常具有描述性。您的模型不反映您的数据库的样子。我建议您阅读有关[代码优先迁移](http://msdn.microsoft.com/en-US/data/jj591621)的内容，基本上迁移的意思是您更新数据库以匹配您的模型，它通过 VS 中的一行命令完成。

希望这可以帮助

另外，我建议您使用`.Find()`or`.First()`代替`.Single()`

# c# - c# shows thread invalid cross-thread access issues

> ID：15588694
> 
> 赞同：0
> 
> 时间：2013-03-23T15:45:02.533
> 
> 标签：c#, multithreading, error-handling

My code shows thread invalid cross-thread access in the line label_mytimer.Text = mytimeLeft + " Sec"; when running in the debugging, but in normal execution, it has no problem. How can I avoid the multi cross thread access, I know the problem is that many threads try to access my textbox control at same time, don't know how to use backgroundworker if it works.

```
private void ttOnTimedEvent(object source, ElapsedEventArgs e)
    {
        if (mytimeLeft > 0)
        {

            // Display the new time left
            // by updating the Time Left label.
            mytimeLeft = mytimeLeft - 1;
            label_mytimer.Text = mytimeLeft + " Sec";//Show time left
        }
        else
        {

            label_mytimer.Text = "OK...";
            mytimeLeft = int.Parse(tBox_rp_Time.Text);

            mycountdownTimer.Stop();
            mycountdownTimer.Enabled = false;

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:48:27.390

您可以使用 MethodInvoker 在 GUI 线程上运行

```
private void ttOnTimedEvent(object source, ElapsedEventArgs e)
{       
    MethodInovker mi = new delegate{
    if (mytimeLeft > 0)
    {
        // Display the new time left
        // by updating the Time Left label.
        mytimeLeft = mytimeLeft - 1;
        label_mytimer.Text = mytimeLeft + " Sec";//Show time left
    }
    else
    {
        label_mytimer.Text = "OK...";
        mytimeLeft = int.Parse(tBox_rp_Time.Text);
        mycountdownTimer.Stop();
        mycountdownTimer.Enabled = false;
    }
    };
    if(InvokeRequired)
       this.Invoke(mi);
 } 
```

# ios - 您可以使用 Mapkit 在 Apple 地图中引用某个地点吗？

> ID：15588702
> 
> 赞同：0
> 
> 时间：2013-03-23T15:45:52.707
> 
> 标签：ios, objective-c, mapkit, apple-maps

是否可以利用 Apple 的地点信息，甚至可以使用 MapKit 参考？

[在Location Awareness Programming Guide](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/ProvidingDirections/ProvidingDirections.html#//apple_ref/doc/uid/TP40009497-CH8-SW5)上没有找到任何东西。尝试使用 MKPlacemark 匹配地址详细信息，例如

```
 MKPlacemark* placeMark = [[MKPlacemark alloc] initWithCoordinate:coordinate addressDictionary:@{
                                           (NSString *)kABPersonAddressStreetKey:@"113 Buccleuch Street",
                                             (NSString *)kABPersonAddressCityKey:@"Edinburgh",
                                            (NSString *)kABPersonAddressStateKey:@"UK",
                                              (NSString *)kABPersonAddressZIPKey:@"EH8 9",
                                          (NSString *)kABPersonAddressCountryKey:@"United Kingdom",
                                      (NSString *)kABPersonAddressCountryCodeKey:@"GB",
                              }];

    MKMapItem* mapItem =  [[MKMapItem alloc] initWithPlacemark:placeMark];
    mapItem.name = @"Coyaba"; 
```

但似乎纬度/经度优先于地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:40:07.003

我认为新的（iOS 6.1+）[`MKLocalSearch`](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKLocalSearch/Reference/Reference.html#//apple_ref/doc/uid/TP40012893)最适合你想要的。它将使用自然语言搜索模式找到兴趣点。

我认为没有任何方法可以像在 Apple Maps 应用程序中那样请求所有兴趣点或检索“可点击对象”。许多对象来自 Yelp，因此您可以查看它们是否提供 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:07:15.707

您是否尝试过[地理编码](http://developer.apple.com/library/ios/#samplecode/GeocoderDemo/Listings/GeocoderDemo_DistanceViewController_m.html#//apple_ref/doc/uid/DTS40011097-GeocoderDemo_DistanceViewController_m-DontLinkElementID_6)示例？下载下来试试看。。

# c# - 如何将“0.0000e+000”解析为浮点数/双精度数？

> ID：15588711
> 
> 赞同：0
> 
> 时间：2013-03-23T15:46:29.307
> 
> 标签：c#, .net

我尝试了以下方法：

```
string val = "0.0000e+000";
float.Parse(val); 
```

...但有一个`FormatException`. 所以我想知道：如何将这样的值解析为浮点数/双精度数？

![解析成浮点数](../Images/abd1696c527ac77274b515e1ff28195d.png)

![解析成双](../Images/eb452d41a4ce5845ba8f60bf3030dc8e.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T15:58:20.597

您有一个`CultureInfo.CurrentCulture`小数点不同的（当前文化）。尝试用不变的文化来解析它：

```
var x = Single.Parse("0.0000e+000", CultureInfo.InvariantCulture); 
```

* * *

为了说明问题：如果您是俄罗斯人，您当前的文化将设置为`ru-RU`. 然后以下*失败*：

```
CultureInfo.DefaultThreadCurrentCulture = CultureInfo.GetCultureInfo("ru-RU");
var x = Single.Parse("0.0000e+000"); 
```

> **FormatException** : 输入字符串的格式不正确。

如果你是法国人 ( `fr-FR`)，它也会失败。对于其他一些文化，它也可能会失败。

# python - 从 URL 到“pandas.DataFrame”的 Excel 工作簿表

> ID：15588713
> 
> 赞同：15
> 
> 时间：2013-03-23T15:46:29.457
> 
> 标签：python, url, pandas, xlrd

在查看了读取 url 链接、指向 .xls 文件的不同方法之后，我决定使用 xlrd。

我很难将“xlrd.book.Book”类型转换为“pandas.DataFrame”

我有以下内容：

```
import pandas
import xlrd 
import urllib2

link ='http://www.econ.yale.edu/~shiller/data/chapt26.xls'
socket = urllib2.urlopen(link)

#this line gets me the excel workbook 
xlfile = xlrd.open_workbook(file_contents = socket.read())

#storing the sheets
sheets = xlfile.sheets() 
```

我想把最后一张表`sheets`作为一个导入`pandas.DataFrame`，关于我如何做到这一点的任何想法？我试过了，`pandas.ExcelFile.parse()`但它需要一个指向 excel 文件的路径。我当然可以将文件保存到内存然后解析（使用`tempfile`或其他东西），但我正在尝试遵循 pythonic 指南并使用*可能*已经写入 pandas 的功能。

一如既往地非常感谢任何指导。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-23T16:00:15.390

您可以将您的传递`socket`给`ExcelFile`：

```
>>> import pandas as pd
>>> import urllib2
>>> link = 'http://www.econ.yale.edu/~shiller/data/chapt26.xls'
>>> socket = urllib2.urlopen(link)
>>> xd = pd.ExcelFile(socket)
NOTE *** Ignoring non-worksheet data named u'PDVPlot' (type 0x02 = Chart)
NOTE *** Ignoring non-worksheet data named u'ConsumptionPlot' (type 0x02 = Chart)
>>> xd.sheet_names
[u'Data', u'Consumption', u'Calculations']
>>> df = xd.parse(xd.sheet_names[-1], header=None)
>>> df
                                   0   1   2   3         4
0        Average Real Interest Rate: NaN NaN NaN  1.028826
1    Geometric Average Stock Return: NaN NaN NaN  0.065533
2              exp(geo. Avg. return) NaN NaN NaN  0.067728
3  Geometric Average Dividend Growth NaN NaN NaN  0.012025 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-01-02T15:28:14.627

您可以将 URL 传递给`pandas.read_excel()`：

```
import pandas as pd

link ='http://www.econ.yale.edu/~shiller/data/chapt26.xls'
data = pd.read_excel(link,'sheetname') 
```

# java - 如何让 Ant 识别项目文件夹中的文件？

> ID：15588714
> 
> 赞同：0
> 
> 时间：2013-03-23T15:47:09.947
> 
> 标签：java, linux, ant

我使用 Eclipse 将文件“testFile.txt”作为参数传递给我的 Java 程序，当我选择正常运行它时它工作正常。如果我在 Eclipse 中运行 Ant build.xml 并将“testFile.txt”设置为参数，我会收到错误消息：

项目“MyProj1”中不存在构建失败的目标“testFile.txt”。

如果我使用 Ant 并使用以下行在 linux shell 中传递文件：

```
ant -Dargs="testFile.txt" run 
```

它通过字符串值“testFile.txt”但找不到相应的文件。该文件位于 src 和 build.xml 所在的 MyProj1 文件夹中。我是否需要移动 .txt 文件或修改构建文件？如果我必须修改构建文件，我需要什么？

```
<target name="run" depends="compile" description="run the project">
    <java dir="${build.dir}" classname="${main.class}" fork="yes">
        <arg line="${args}"/>
    </java>
</target> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:53:19.980

添加

```
<arg file="testFile.txt"/> 
```

到java任务，即：

```
<target name="run" depends="compile" description="run the project">
    <java dir="${build.dir}" classname="${main.class}" fork="yes">
        <arg line="${args}"/>
        <arg file="testFile.txt"/>
    </java>
</target> 
```

这将创建 /path/to/build.xml/ 目录的绝对路径，这是您的文件所在的位置。

如果您的文件位于子目录中，请将其添加到 arg 文件值之前，../ 也可以按照您期望的方式工作。

编辑：

目录结构

```
c:\project
|
+---PassFileViaAnt.class
+---build.xml
+---foo.txt 
```

班级：

```
public class PassFileViaAnt {
    public static void main( String[] args ) {
        for( String arg : args ) {
            System.out.println( arg );
        }
    }
} 
```

任务：

```
<target name="run" description="run the project">
    <java dir="${build.dir}" classname="PassFileViaAnt" fork="yes">
        <arg file="${args}" />
    </java>
</target> 
```

命令：

```
c:\project> ant run -Dargs="foo.txt" 
```

输出：

```
[java] C:\project\foo.txt 
```

命令：

```
c:> ant -f c:\project\build.xml run -Dargs="foo.txt" 
```

输出

```
[java] C:\project\foo.txt 
```

# linqpad - 名称 ... 在当前上下文中不存在

> ID：15588715
> 
> 赞同：2
> 
> 时间：2013-03-23T15:47:16.540
> 
> 标签：linqpad

我有这样的背景：

```
/// <summary>
        /// Constructeur qui récupère automatiquement la chaîne de connection.
        /// </summary>
        /// <remarks>Nécessaire pour les commandes de migrations de EF > 4.3.</remarks>
        public ScsContext()
            : base(ConfigurationUtility.GetConnectionString())
        {
        }

        /// <summary>
        /// Constructeur qui prend en paramètre une chaine de connection.
        /// </summary>
        /// <param name="connectionString">Chaîne de connexion.</param>
        public ScsContext(string connectionString)
            : base(connectionString)
        {
        } 
```

我选择了包含 ScsContext 的持久性程序集。我已经能够选择 ScsContext 并且我选择了无参数构造函数，然后选择了连接字符串所在的配置文件。

我做了一个测试，看看它是否可以连接..是的，它可以。

我可以看到 LindPaq 中的所有表，但它无法进行任何查询。. 比如 Accounts.Take (100) 我收到错误消息，指出当前上下文中不存在名称“Accounts”。

有任何想法吗 ？我很确定我有正确的 DLL 和一切。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-11T20:54:59.520

这是我遇到此问题时所做的

```
using (var cntx = new DataContext("Server=ARAMKALAPTOP\\EXPRESS2012;Database=TimberScan;Trusted_Connection=True;"))
{
    var users = cntx.Set<User>().ToList();
    users.Dump();
} 
```

我还必须在 LinqPad 中添加对包含我的模型\实体的程序集的引用，然后添加命名空间导入。只需在 linqpad 中按 F4，您就可以看到如何添加引用和命名空间导入。此外，将语言更改为 C# 语句。

# vb.net - 在 Internet 可用时上传数据 Compact Framework

> ID：15588716
> 
> 赞同：0
> 
> 时间：2013-03-23T15:47:34.557
> 
> 标签：vb.net, network-programming, windows-mobile, compact-framework, opennetcf

我有一个应用程序，它使用手机数据连接通过 Web 服务与远程服务器通信。但是，由于手机网络的不可靠性，只要手机网络关闭，该应用程序就无法运行。所以我想要做的是更改应用程序以直接在设备上处理订单，并在互联网可用时在后台（如 Windows 服务）上传订单。

这就是我的想法：

2 应用

应用程序#1：更改订单应用程序以在应用程序加载时连接到互联网以获取所有设置并保存到 sdf DB。一旦设置保存在本地，用户就可以处理订单并保存到数据库。

应用程序 #2：在后台运行，不断检查数据库（例如每 3-5 分钟）是否有订单并通过 WCF Web 服务上传到远程服务器。此外，上传完成后，更新的设置将下载回设备。

App #2 是我需要指导的。在桌面上，我可以运行 Windows 服务，但是 Windows Mobile 的紧凑框架似乎不支持 Windows 服务类型。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T15:24:14.310

为什么将其作为单独的应用程序运行？在这种情况下，您必须对数据访问进行跨进程同步，以确保来自两个进程的同时访问不会导致问题。为什么不在应用程序本身内部创建一个后台“服务”线程来向企业转发数据？

# javascript - 用户认证后如何加载 html 数据

> ID：15588717
> 
> 赞同：0
> 
> 时间：2013-03-23T15:47:36.697
> 
> 标签：javascript, google-app-engine, google-drive-api

应用程序，大量 html/js =>`app.html`

*   如果用户经过身份验证，则为真 OAuth/Google-Drive => 有权访问

*   否则它不是登录用户 => 没有访问权限

这可以在服务器端完成，但是需要在服务器端和客户端执行 OAuth 流程？我可以在服务器端移动所有东西，但这似乎是很多应用引擎资源（例如`getFile()`，`updateFile()`），这是可以避免的；只有客户自己开车，对吗？砍掉中间人。

我在这件事上走对了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T00:29:33.180

如果我理解正确，是的，这是正确的。您可以完全在浏览器中编写 Google Drive 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T04:31:12.480

为什么不在身份验证后使用 GDrive 调用重定向到实际的 html 页面？

它会是这样的：每个用户都登陆 login.html 页面，该页面只处理 OAuth 部分。检索到 OAuth 令牌后，login.html 会将用户重定向到实际的 app.html。

不过，更一般地说，我看不出有任何理由要对未通过云端硬盘进行身份验证的用户隐藏代码。无论如何，如果没有 OAuth 令牌，此代码将毫无用处。

# python - python中的深拷贝

> ID：15588718
> 
> 赞同：0
> 
> 时间：2013-03-23T15:47:39.777
> 
> 标签：python, python-2.7, deep-copy

我正在使用 Python 深拷贝尝试创建原始对象的完整副本，但深拷贝似乎没有创建副本。它仍然与原始对象共享相同的引用，这是不希望的

这是代码。我有一个`class Board`，我想深拷贝的实例。

```
import copy
class Board:
    xpos = None
    opos = None
    count = None
    status = []

    def __init__(self, size):
        self.xpos=[0,0]
        self.opos=[size-1,size-1]
        self.count = size*size-2
        for i in range(size):
            tmp = ['-']*size
            self.status.append(tmp)
        self.status[0][0] = 'X'
        self.status[size-1][size-1]= 'O' 
```

我想调用的另一个函数中的某个地方

```
board=Board()
localboard=copy.deepcopy(board)
# then do modification to local board....
# but it seems the old board is also affected. This is so weird since
# I am already using deep copy. 
```

那么如何创建旧板的深层副本呢？我不想分享任何参考，因为我会在本地进行修改并希望保持旧的完整..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:52:08.603

`Board`您应该从定义中删除以下内容：

```
xpos = None
opos = None
count = None
status = [] 
```

并将以下内容添加到其`__init__()`：

```
self.status = [] 
```

否则，您的所有实例都共享相同的`status`，这是*类*的属性，而不是*实例*的属性。

# actionscript-3 - 需要帮助以提高 Flash/as3 中的图像质量，总 swf 大小限制为 45 kbs

> ID：15588721
> 
> 赞同：0
> 
> 时间：2013-03-23T15:47:48.677
> 
> 标签：actionscript-3, flash

我正在做一个“Flash 横幅广告”项目，我需要一些帮助。指导方针是将 swf 的总大小限制为 45 kbs。

我使用的是 greesock 的 TweenNano，所以我的动画没有那么重。

但是fla中有很多图像。我仍然设法制作动画并包含图像，文件大小在 45 kbs 范围内。

我的问题是图像质量不好。**有什么方法可以通过 as3 提高图像质量，或者我应该使用其他任何技术吗？**如果您想要更多详细信息，我可以提供它们....或建议一些图像压缩技术而不降低质量...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T04:03:23.727

如果您的目标是将 SWF 的大小限制为 45kb，则您没有太多选择来提高图像质量。首先，您可以制作一些矢量图形而不是栅格并显示它。其次，您可以通过`URLLoader`类从其他地方加载图像，为此，请确保为非本地图像添加安全上下文，并确保您的广告展示者不会对此皱眉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T18:26:11.563

好的，这就是我对最终项目所做的。（让我提一下，我能够将文件大小减少到 40kbs）

*   我总共有 11 张图像（每张图像的分辨率为 300dpi），我必须在 45kbs 的文件大小内制作一个 Flash 横幅广告。
*   首先，我使用 GreenSock 的 TweenNano 制作动画
*   将图像的分辨率保持在 300 并根据我在 Photoshop 中的需要减小它们的大小（高度/宽度），然后使用“保存为网络”
*   我使用 png-8 格式，在某些情况下使用 png-24
*   将图像导入闪存并转到图像的属性-> 使用 png（无损）压缩（现在你可能认为它会增加文件大小......但这很好，因为我也想保持一些质量）
*   我已将所有文本转换为矢量
*   使用过的影片剪辑
*   在发布设置中也可以压缩 swf 文件。
*   有一个复选框说“包括 xmp 元数据”-> 我取消选中它，它还帮助我保存了一些 kbs

就是这样......如果这些信息可能对某人有帮助......他们可以使用它。:)

# python - 在 Web 应用程序上本地工作

> ID：15588724
> 
> 赞同：0
> 
> 时间：2013-03-23T15:48:13.983
> 
> 标签：python, google-app-engine, web-applications

我已被添加为应用程序的开发人员。

在应用程序概览中，此应用程序与我的其他应用程序一起显示，我可以通过 Google App Engine Launcher 自由访问和更改。

问题是如何获取我应该在本地计算机上工作的应用程序（换句话说，在 GAE 中），所以我可以在我计算机上的浏览器中本地测试和更改它......

Windows 7的

App Engine SDK 版本：“1.7.6”

接口：python27

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T04:41:02.037

您可以使用 appcfg 应用程序（处理上传的应用程序）[下载源代码](https://developers.google.com/appengine/docs/python/tools/uploadinganapp#Downloading_Source_Code)。

这仅在管理员没有禁用它的情况下才有效。

不过最好还是请开发者提供原始源代码！

# android - 在eclipse中调试配置R错误？

> ID：15588730
> 
> 赞同：0
> 
> 时间：2013-03-23T15:48:31.873
> 
> 标签：android, eclipse, debugging

在 Eclipse 的（调试配置）菜单中，单击（调试）后，它向我显示一个错误：（R 无法解析为变量）。我还是 Eclipse 的新手，这个错误让我有点困惑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:52:20.493

`R.java`是一个自动生成的文件，其中包含对您项目中所有内容的引用。它没有解决的事实可能是由许多原因造成的。检查`gen`文件夹和`R.java`文件是否存在。如果没有，请执行以下操作：

*   通过选择清理您的项目`Project - Clean`
*   如果`R.java`未创建，则某些 XML 文件中可能有错误，请检查控制台输出
*   在您的代码中，将鼠标光标悬停在应该以红色突出显示的 R 上并检查 Eclipse 是否提供导入它（如果是，请从您的项目中选择 R，而不是从 android 包中）

让我知道它是否解决了问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T17:59:44.650

您还可以通过创建新项目并将所有 xml 和 java 代码粘贴到新项目中来修复它。它将重新创建`R.java`，因此问题将通过这种方式解决。

# knockout.js - 预选我的下拉列表中的一个项目

> ID：15588732
> 
> 赞同：3
> 
> 时间：2013-03-23T15:48:38.960
> 
> 标签：knockout.js

我有以下下拉列表：

```
<div>  
    Dummy
    <select data-bind="options: categories, optionsText: 'description', value: 2"></select>
</div> 
```

使用下面的javascript：

```
function ViewModel()
{

    this.categories = ko.observableArray([
            new Category(1, "Non classé"),
            new Category(2, "Non nucléaire"),
            new Category(3, "Classe II irradié"),
            new Category(4, "Classe III")
    ]);

    // Constructor for an object with two properties
    function Category(id, description) {
        this.id = id;
        this.description = description;
    };
}

ko.applyBindings(new ViewModel()); 
```

我想在下拉列表中预先选择 id 为 2 的元素。

任何的想法？

谢谢。

jsFiddle：http: [//jsfiddle.net/RfWVP/276/](http://jsfiddle.net/RfWVP/276/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T16:42:31.597

我能想到两种方法来做到这一点。无论哪种方式，您都必须添加一个`selectedCategory`可观察的属性来存储跟踪当前选择的选项。

1.  使用`optionsValue`绑定并指定`'id'`您要用作`value`each的属性`option`：

    ```
    <select data-bind="options: categories, 
                       optionsText: 'description', 
                       value: selectedCategory, 
                       optionsValue: 'id'">                 
    </select> 
    ```

    然后设置`selectedCategory`等于“2”：

    ```
    this.selectedCategory = ko.observable(2); 
    ```

    **示例：http:** [//jsfiddle.net/RfWVP/281/](http://jsfiddle.net/RfWVP/281/)

2.  在创建可观察的类别数组之前创建 id 为“2”的类别并将`selectedCategory`等于该类别的值设置为：

    ```
    var selected = new Category(2, "Non nucléaire");

    this.categories = ko.observableArray([
        new Category(1, "Non classé"),
        selected,
        new Category(3, "Classe II irradié"),
        new Category(4, "Classe III")
    ]);

    this.selectedCategory = ko.observable(selected); 
    ```

    **示例：http:** [//jsfiddle.net/RfWVP/280/](http://jsfiddle.net/RfWVP/280/)

您使用哪一个取决于您需要有关所选类别的哪些信息。

# javascript - Excel 到 XML：将小数四舍五入到最接近的百分之一并保留超链接

> ID：15588733
> 
> 赞同：0
> 
> 时间：2013-03-23T15:48:42.970
> 
> 标签：javascript, jquery, html, xml, excel

我按照[本指南](http://office.microsoft.com/en-gb/excel-help/create-an-xml-data-file-and-xml-schema-file-from-worksheet-data-HA010342365.aspx)将 Excel 电子表格导出为 XML 数据文件，然后按照[本指南](http://www.w3schools.com/xml/xml_to_html.asp)在我的网站上将 XML 表格显示为 HTML 表格。效果很好。现在我“只”需要解决一些我无法解决的小问题。

(1) 输出表包含像 1.325667 这样的数字，但也有很多 0。我希望将零显示为 0.00，将带有许多小数的数字显示为 1.33。基本上，每个数字都应显示为两位小数。

(2) excel 表包含指向我网站上其他页面的超链接，我希望在呈现 XML 数据文件和 HTML 表时保留这些超链接。到目前为止，这没有奏效。这可能吗？

**更新**我想出了这部分。通过仅在其字符串中分解超链接，然后为这些字符串添加新列，然后调整源代码以包含

```
document.write("<tr><td><a href='");
document.write(x[i].getElementsByTagName("character-string")0].childNodes[0].nodeValue);
document.write(".php'>");
document.write(x[i].getElementsByTagName("name")[0].childNodes[0].nodeValue);
document.write("</a></td>"); 
```

我能够包含超链接。

Excel-Sheet 的格式已经集成了这两个方面，但转换为 XML 文件似乎是个问题。

非常感谢您的帮助（一次又一次:-)）

**更新**我现在还找到了一种在 Excel 中进行舍入的方法，但我仍然坚持使用只有一位小数的整数和数字。基本上，我现在“只”需要一种方法来显示每个带有两个小数点的数字，适用于整数（例如 0 应该是 0.00）和带有一个小数的数字（例如 1.5 应该是 1.50）。JohnnyReeves 的回答似乎在正确的轨道上，但我无法让它发挥作用。还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:27:25.150

1.  Number 对象具有**toFixed()**方法：

    1.325667.toFixed(2) = 1.33。

2.  在 XML 的循环中运行，选择 URL 并将其添加到链接中：

    document.write("<a href=" + x[i].getElementsByTagName(<你的 URL 链接>) + ">);

    document.write("一些文本");

    document.write("< /a>");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:34:46.773

Number.toFixed 方法仅适用于浮点值（例如：2.1），而不适用于整数（例如：2 或 0）。您需要将数字类型转换为字符串类型，以便对其进行格式化以进行显示并获得一致的结果，而不管输入如何。像这样的函数应该可以解决问题：

```
function formatNumber(value) {
    var parts,
        trailingDigits,
        formattedRemainder;

    // Coerce the supplied value to a String type.
    value = String(value);

    // Break the supplied number into two parts, before and after the dot
    parts = value.split(".");

    // If there was no dot, there will only be one "part" and we can just
    // add the trailing zeros.
    if (parts.length === 1) {
        formattedRemainder = "00";
    }
    else {
        trailingDigits = parts[1];

        if (trailingDigits.length === 0) {
            // A dot, but no digits. (eg: 2\. -> 2.00)
            formattedRemainder = "00";
        }
        else if (trailingDigits.length === 1) {
            // Add an extra trailing zero (eg: 2.1 -> 2.10)
            formattedRemainder = trailingDigits + "0";
        }
        else {
            // Just take the last two trailing digits.
            formattedRemainder = trailingDigits.substring(0, 2);
        }
    }

    // Build the final formatted string for display.
    return parts[0] + "." + formattedRemainder;
} 
```

# ruby-on-rails - 安装 gitlab-5.0 时遇到问题。我无法完成安装

> ID：15588741
> 
> 赞同：2
> 
> 时间：2013-03-23T15:49:39.363
> 
> 标签：ruby-on-rails, ruby, rubygems, gitlab

我在 Ubuntu 10 上安装 gitlab-5.0，当我在 gitlab 安装指南的[Ruby 部分](https://github.com/gitlabhq/gitlabhq/blob/5-0-stable/doc/install/installation.md#2-ruby)执行“sudo gem install bundler”命令时，它显示了下一个冲突：

```
root@ubuntu:/home/gitlab/gitlab# sudo gem install bundler
Successfully installed bundler-1.3.4
Installing ri documentation for bundler-1.3.4
/usr/lib/ruby/1.8/rdoc/rdoc.rb:280: warning: conflicting chdir during another chdir block
/usr/lib/ruby/1.8/rdoc/rdoc.rb:287: warning: conflicting chdir during another chdir block
Done installing documentation for bundler after 8 seconds
1 gem installed
root@ubuntu:/home/gitlab/gitlab# 
```

然后，在[宝石部分](https://github.com/gitlabhq/gitlabhq/blob/5-0-stable/doc/install/installation.md#install-gems)...

```
root@ubuntu:/home/gitlab/gitlab# sudo gem install charlock_holmes --version '0.6.9'
Building native extensions.  This could take a while...
Successfully installed charlock_holmes-0.6.9
Installing ri documentation for charlock_holmes-0.6.9
/usr/lib/ruby/1.8/rdoc/rdoc.rb:280: warning: conflicting chdir during another chdir block
/usr/lib/ruby/1.8/rdoc/rdoc.rb:287: warning: conflicting chdir during another chdir block
Done installing documentation for charlock_holmes after 0 seconds
1 gem installed

root@ubuntu:/home/gitlab/gitlab# sudo -u git -H bundle install --deployment --without development test postgres
Gemfile syntax error:
/home/gitlab/gitlab/Gemfile:14: syntax error, unexpected ':', expecting $end
gem "mysql2", group: :mysql 
```

我的红宝石版本：

```
root@ubuntu:/home/gitlab/gitlab# ruby -v
ruby 2.0.0p0 (2013-02-24 revision 39474) [x86_64-linux] 
```

你会如何避免这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:41:31.850

堆栈跟踪表明您确实没有使用 Ruby 2.0 来安装 gems，而是使用系统提供的 1.8.7。这可能是由于您使用`sudo`.

如果您使用 RVM 安装了 Ruby 2.0.0，则必须`rvmsudo`改用它来确保 rvm`$PATH`对加载特定 ruby​​ 版本所做的更改可用于以 root 身份运行的程序。默认情况下，`sudo`清理`$PATH`并取消更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:56:13.307

ruby 2.0仍然存在[一些](https://github.com/gitlabhq/gitlabhq/issues/3080) [问题](https://github.com/gitlabhq/gitlabhq/pull/3103)，我现在仍然推荐 1.9.3。

但请确保在您的 ruby​​ 2.0 旁边没有安装其他 ruby​​，当然不是 ruby​​ 1.8，就像在[issue 2285](https://github.com/gitlabhq/gitlabhq/pull/2285)中那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T05:17:15.460

我发现 rvm 和 gitlab 不能很好地结合在一起，除非你真的需要在你的服务器上轻松支持多个版本的 ruby​​，否则只需 root 安装 ruby​​。

主要问题是 gitlab 安装经常使用 sudo，但 root 没有与 gitlab 用户相同的路径。对于 rvm 来说，这不是一条好的路径，因为它最好作为单用户安装进行安装，并且即使为多用户正确安装，它也对路径更改非常敏感。

# hibernate - 我将使用哪些 Hibernate（或 NHiberate）标签和/或映射类来创建到名为 contract 的桥接表的映射？

> ID：15588749
> 
> 赞同：0
> 
> 时间：2013-03-23T15:50:18.333
> 
> 标签：hibernate, nhibernate, orm, composite-key, bridge

假设我有一个桥表，其中有两个以上的外键组成它的复合键。

例如，

政府表 gov_id int 主键 cournty_name String

NonProfitOrg 表 nonProfit_id int 主键 NonProfit_name String

CommericalFirm Table Commercial_id int 主键 commerical_name String

（桥接表称为合同）合同 gov_id nonProfit_id Commercial_id

我将使用哪些 Hibernate（或 NHiberate）标签或映射类来创建到名为 contract 的桥接表的映射？
我应该为名为 Contract 的桥接表创建一个单独的映射类吗？或者我们可以使用 Government 映射表、NonProfitOrg 表和 CommericalFirm 表中的多对多标签来执行此操作吗？请告诉我最好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:01:08.553

由于您在合同表中有功能数据，而不仅仅是链接实体的外键，因此您需要将其映射为实体。

因此，您将在 Government 和 Contract 之间有一个 OneToMany，在 NonProfitOrg 和 Contract 之间有另一个 OneToMany。

由于它是一个常规实体，我强烈建议您使用自动生成的单列 ID 来识别它，就像其他实体一样。

# php - PDO 获取多个值

> ID：15588752
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:50:28.353
> 
> 标签：php, pdo

好吧，我决定使用 PDO，因为我看到有人说它比 mysql 更好。

我有这段代码应该获取 uid、ticket_id 和事件表。

```
$query = $db->prepare("SELECT embedded_page.uid, embedded_page.ticket_id, embedded_page.event_table FROM embedded_page WHERE fbp_id = :fbp_id");
$query->bindValue(":fbp_id", $fbp_id, PDO::PARAM_INT);
$query->execute();

echo $compibot_user = $query->fetchObject()->uid;
echo $ticket_id = $query->fetchObject()->ticket_id;
echo $event_table = $query->fetchObject()->event_table; 
```

查看代码，我回显了三个变量**$compibot_user**、**$ticket_id**和**$event_table**

我只得到的结果是“ **1** ”，这是**$compibot_user的结果**

$ticket_id 和 $event_table 没有回显任何内容。所以我一直想知道为什么它不起作用。这东西有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:55:02.227

试试这个：

```
$sql="SELECT embedded_page.uid, embedded_page.ticket_id, embedded_page.event_table FROM embedded_page WHERE fbp_id = ?";        
$stmt=$db->prepare($sql) or die("Prepare Error");
$stmt->bindParam(1, $fbp_id);       
$stmt->execute();   

$result=$stmt->fetch(PDO::FETCH_ASSOC);

echo  $result['YOUR COLUMN NAME']; //example echo $result['ticket_id']; 

$stmt->closeCursor();
$stmt=NULL; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:56:36.343

尝试这样的事情，也许：

```
$query = $db->prepare("SELECT embedded_page.uid, embedded_page.ticket_id, embedded_page.event_table FROM embedded_page WHERE fbp_id = :fbp_id");
$query->execute( array( 'fbp_id' => $fbp_id ) );
list ( $compibot_user, $ticket_id, $event_table ) = $query->fetch( PDO::FETCH_NUM );

print "$compibot_user, $ticket_id, $event_table\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T16:01:07.370

最简单的解决方案：

```
$query = $db->prepare('SELECT `embedded_page`.`uid`, `embedded_page`.`ticket_id`, `embedded_page`.`event_table` FROM `embedded_page` WHERE `fbp_id` = ?');
$query->execute(array($fbp_id));

while(($row = $query->fetch(PDO::FETCH_ASSOC)) !== false) {
   echo $row['uid'], ', ', $row['ticket_id'], ', ', $row['event_table'];
} 
```

# html - 为什么这个菜单会在 Chrome 中移动？

> ID：15588753
> 
> 赞同：0
> 
> 时间：2013-03-23T15:50:40.400
> 
> 标签：html, css, google-chrome, nav

我正在创建一个页面（链接如下）并使用 HTML5 标记，`nav`. 但是，如果在 Google Chrome 中调整窗口大小，菜单会跳转到`div.banner`.

为什么会发生这种情况，我该如何解决？

这是我正在设计的页面：http: [//ubuntuone.com/1O7MLCGfZ0EqxQSFlpy4Yr](http://ubuntuone.com/1O7MLCGfZ0EqxQSFlpy4Yr)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:25:34.267

**CSS**

将以下 CSS 样式添加到 a.brand 的第 1 行。71号线和线号。343

```
a.brand {
display: block;
float: left;
} 
```

将以下 css 样式添加到第 1 行的标题中。125 和行号。397

```
header{
 clear:both;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:39:00.273

我认为这对你有用：

在第 363 行：

```
 nav {
    height: 50px;
    width: 400px; /* 5x the length of each nav item */
position:absolute;     /* use positioning rather than "float:right;" */
top:0px;
right:0px;
    padding: 0;
    margin: 0;
    color: #004824;
    background: #fff;
    vertical-align: middle;
} 
```

在第 331 行：

```
 div.banner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 50px;
    margin: 0;
    padding: 0;
    z-index: 2;        /* change z-index so img will be on top */
    border-bottom: 1px solid #004824;
} 
```

这是一个可能有助于演示的[jsFiddle 。](http://jsfiddle.net/apaul34208/Ns5sU/6/)

# c# - 读取 Xml 文档并插入数据库

> ID：15588757
> 
> 赞同：0
> 
> 时间：2013-03-23T15:50:54.083
> 
> 标签：c#, xml

我有一个包含客户信息的 xml 文档，我必须阅读此文档并将相关详细信息插入数据库表中。

解析整个xml文档并将数据存储在容器类中，然后在读取文档后将其添加到数据库中会更好吗

或者在我从 xml 读取第一批客户数据后，将该记录添加到数据库中，然后从 xml 文件中读取下一条记录，依此类推

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:38:46.817

这取决于您在 xml 文档中有多少数据。

如果 xml 文档很小，最好使用容器类，因为从数据库中读取数据时，可以使用相同的容器类。

如果 xml 文档很大，请使用批量插入。

# objective-c - Webkit WebView 不工作

> ID：15588759
> 
> 赞同：1
> 
> 时间：2013-03-23T15:51:03.403
> 
> 标签：objective-c, macos, cocoa, webview

我在我的应用程序中使用了 Webkit WebView，但它实际上不起作用。我的意思是页面加载但是当我点击页面上的链接时没有任何反应。

这是我的网页：[http ://www.beginninghtml.altervista.org](http://www.beginninghtml.altervista.org)

这是我的代码：

在我的`AppDelegate.h`：

`@property (assign) IBOutlet WebView *webView;`

在我的`AppDelegate.m`：

```
-(void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
     NSURL *url = [[NSURL alloc] initWithString:@"http://www.beginninghtml.altervista.org"];
     NSURLRequest *req = [[NSURLRequest alloc] initWithURL:url];
    [[_webView mainFrame] loadRequest:req];
} 
```

它正确加载了页面，但是当我单击页面上的链接时，什么也没有发生。谁能帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T17:24:05.107

我注意到您的一些链接请求打开新窗口，而不是像往常一样在当前窗口中打开页面。[处理新窗口请求](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/MultipleWindows.html#//apple_ref/doc/uid/20002026-117573)由您决定。我链接到的部分特别提到如果单击此类链接而不将请求作为 Web 视图的 UI 委托处理，则“什么都不会发生”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T13:35:05.173

最后，我使用以下代码在 Cocoa Webview 中打开了一个需要打开新窗口的链接：

为您的 WebView 设置 policyDelegate，然后在其中实现此代码：

```
-(void)webView:(WebView *)webView decidePolicyForNewWindowAction:(NSDictionary *)actionInformation request:(NSURLRequest *)request newFrameName:(NSString *)frameName decisionListener:(id<WebPolicyDecisionListener>)listener
{
    [listener ignore];
    NSURLRequest *req = [[NSURLRequest alloc] initWithURL:[request URL]];
    [[_webView mainFrame] loadRequest:req];
} 
```

# php - 如何从字符串中删除包含双引号''“的特定单词？

> ID：15588763
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:51:19.560
> 
> 标签：php, double-quotes

我想 `<?xml version="1.0" encoding="utf-8"?>` 从包含这个的字符串中删除，然后再删除很多其他的东西。由于几个双引号如何删除它我在定义`str_replace`函数时遇到问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:53:42.790

您可以考虑使用单引号：

```
str_replace('<?xml version="1.0" encoding="utf-8"?>', '', $myString); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:55:03.100

如果*要*使用双引号来定义字符串，则**需要**使用以下命令对其进行转义`\`：

```
str_replace("<?xml version=\"1.0\" encoding=\"utf-8\"?>", "", $myString);
//                         ^    ^           ^      ^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T15:53:24.593

只需使用单引号，然后使用 str_replace ：

```
$yourstring = str_replace('<?xml version="1.0" encoding="utf-8"?>', '', $yourstring); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T16:07:27.797

这是解决方案：

```
<?php

    $xml = '<?xml version="1.0" encoding="utf-8"?>
            <parentnode>
                <childnode>
                    Hello World!
                </childnode>
            </parentnode>';

    $xml_to_delete = '<?xml version="1.0" encoding="utf-8"?>';

    $new_xml = str_replace($xml_to_delete, "", $xml);

    echo $new_xml; //Raw XML.

    echo "<br/>";

    echo htmlentities($new_xml); //For seeing output in browsers, instead of XML rendered. 
```

# css - 绝对位置和错误的 z-index

> ID：15588766
> 
> 赞同：4
> 
> 时间：2013-03-23T15:51:35.220
> 
> 标签：css, z-index, css-position

**剧情说明：**有一只鸟在飞之前应该收拾它的腿。鸟的身体、腿和眼睛是`background-image`分开`div`的s。我使用 jQuery 的动画方法来改变腿的位置并将它们放在鸟的身体内。

**问题：**腿不是在鸟的身体下面，而是在身体上方。

**问题：**我做错了什么导致鸟的腿不能在它下面？

**图片：**

1.  ![动画前](../Images/79d441c894ad2933a8c869f0698952cd.png)
2.  ![动画后](../Images/557e5f779a16c474aab53946e09ef705.png)

**HTML：**

```
<div id="gonji">
    <div class="legs"></div>
    <div class="body">
        <div class="eye"></div>
    </div>
</div> 
```

**CSS：**

```
#gonji { width: 80px; height: 55px; position: relative; }
#gonji .body { width: 80px; height: 55px; background: url('../gonji/gonji.png') no-repeat scroll center center transparent; z-index: 998; }
#gonji .eye { width: 5px; height: 4px; background: url('../gonji/gonji_eye.png') no-repeat scroll center center transparent; position: absolute; top: 13px; left: 30px; z-index: 999; }
#gonji .legs{ width: 9px; height: 17px; background: url('../gonji/gonji_legs.png') no-repeat scroll center center transparent; position: absolute; top: 35px; left: 30px; z-index: 1 } 
```

**JS：**

```
var $gonjiLegs = $("#gonji").find(".legs");
var gonjiOrigLegsPos = $gonjiLegs.position();
$gonjiLegs.animate({ 'top': gonjiOrigLegsPos.top - 17 }, 'fast'); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-23T15:56:18.477

您缺少.. z-index`position`上的属性`#gonji .body`仅适用于定位元素

尝试添加`position: relative;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T15:53:42.177

您必须更改`z-index`.

`z-index:-1;`上`.feet`。

您也可以保持相同的位置，只需在`.hide()`和之间切换`.show()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T16:12:36.920

**CSS**

```
#gonji { width: 80px; height: 55px; position: relative; }
#gonji .body { width: 80px; height: 55px; background:red; z-index: 998; }
#gonji .eye { width: 5px; height: 4px; background:blue; position: absolute; top: 13px; left: 30px; z-  index: 999; }
#gonji .feet { width: 9px; height: 17px; background:black; position: absolute; top: 55px; left: 30px; } 
```

**JS**

```
 $(document).ready(function(){
setInterval(callMe,1000);
 });

function callMe(){
var $gonjiFeet = $("#gonji").find(".feet");
var gonjiOrigFeetPos = $gonjiFeet.position();
$gonjiFeet.css('z-index','-1').animate({ 'top': gonjiOrigFeetPos.top - 20 }, 'fast');
$gonjiFeet.animate({ 'top': '55' }, 'fast');
} 
```

# ruby-on-rails - Rails counter_cache 更新太慢？

> ID：15588767
> 
> 赞同：0
> 
> 时间：2013-03-23T15:51:42.133
> 
> 标签：ruby-on-rails

使用 Rails 3。我有以下内容：

```
# shop.rb
class Shop < ActiveRecord::Base
  belongs_to :country, :touch => true, :counter_cache => :total_shops
  ...
end

# shops_controller.rb
class ShopsController < ApplicationController  
  def create
    ...
    @shop.save
    @new_total_shops = @country.total_shops
  end
end 
```

假设 initial`@country.total_shops`是`2`，那么当它创建时，它应该递增到`3`，但是当我`abort(@country.total_shops)`在该行之后尝试时`@shop.save`，它仍然显示`2`。当我刷新页面时，它显示`3`. 我想它只是更新有点慢。

如何快速获取最新值？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T18:04:00.477

我的猜测是，由于您（我假设）`Country`在保存新商店之前已经加载了实例，因此您看到的`total_shops`值与加载国家/地区时的值相同。

即，即使底层数据库值已更改，您在内存中也有旧值。

尝试这个：

```
@shop.save

# reload the country instance from the database
# to get the updated counter cache value
@country.reload

@new_total_shops = @country.total_shops 
```

# java - 使用 PHP Web 服务问题将数据从 android 应用程序插入到 PostgreSQL 数据库

> ID：15588770
> 
> 赞同：0
> 
> 时间：2013-03-23T15:52:02.200
> 
> 标签：java, php, android, json, postgresql

我正在为我遇到的这个问题而抓狂。我试图允许用户将一些数据从他们的 android 应用程序上传到我开发的网站服务。

数据将使用 JSON 和 Android 上传到 PHP Web 服务，然后该服务会将数据“插入”到我的 PostgreSQL 数据库中。

我不确定整个应用程序中的逻辑错误在哪里，因为该应用程序在运行时不会产生错误，但是当我检查我的 PostgreSQL 服务器空间的数据库记录时，没有提交任何数据。

请参阅下面我正在使用的代码，并尝试帮助确定我哪里出错了。我已经在 Google 上寻找教程，但它们都是基于从 PHP Web 服务读取数据到 android 应用程序，但我希望从 android 应用程序发送原始数据。

**数据发布活动**

```
public void postData() throws JSONException{
       Toast.makeText(DataSummary.this, "Done! Check your profile online to see your record.", Toast.LENGTH_LONG).show();

       Thread trd = new Thread(new Runnable(){
           public void run(){
             //Create a new HttpClient and Post Header
               HttpClient httpclient = new DefaultHttpClient();
               HttpPost httppost = new HttpPost("http://users.aber.ac.uk/dwd/mfb/php/jsonscript.php");
               JSONObject json = new JSONObject();

               Bitmap bitmapOrg = BitmapFactory.decodeResource(getResources(), i);
                ByteArrayOutputStream bao = new ByteArrayOutputStream();
                bitmapOrg.compress(Bitmap.CompressFormat.JPEG, 90, bao);
                byte[] ba = bao.toByteArray();
                String ba1=Base64.encodeToString(ba, i);

               try {
                   //JSON data:
                   json.put("photo", ba1.toString());
                   json.put("name", name);
                   json.put("description", description);
                   json.put("latitude", latitude);
                   json.put("longitude", longitude);
                   json.put("project", project);
                   json.put("owner", username);

                   JSONArray postjson = new JSONArray();
                   postjson.put(json);

                   //Post the data
                   httppost.setHeader("json", json.toString());
                   httppost.getParams().setParameter("jsonpost", postjson);

                   //Execute HTTP Post Request
                   System.out.println(json);
                   HttpResponse response = httpclient.execute(httppost);

                   //for JSON
                   if(response != null)
                   {
                       InputStream is = response.getEntity().getContent();

                       BufferedReader reader = new BufferedReader(new InputStreamReader(is));
                       StringBuilder sb = new StringBuilder();

                       String line = null;
                       try{
                           while((line = reader.readLine()) != null){
                               sb.append(line + "\n");
                           }
                       } catch (IOException e){
                           e.printStackTrace();
                       } finally {
                           try {
                               is.close();
                           } catch(IOException e){
                               e.printStackTrace();
                           }
                       }
                   }

               } catch(ClientProtocolException e){
                   e.printStackTrace();
               } catch (IOException e){
                   e.printStackTrace();
               } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
           }
       });
       trd.start();
   } 
```

**PHP 网络服务**

```
<?php
session_start();
$conn = pg_connect("database_string");

//VARIABLES TO BE WRITTEN TO THE DATABASE
$photo = $_REQUEST["photo"];

echo $photo;
$binary=base64_decode($photo);
header('Content-Type: bitmap; charset=utf-8');

$name = json_decode(stripslashes($_POST["name"]));
$safe_name = pg_escape_string($name);
$desc = json_decode(stripslashes($_POST["description"]));
$safe_desc = pg_escape_string($desc);
$latitude = json_decode(stripslashes($_POST["latitude"]));
$longitude = json_decode(stripslashes($_POST["longitude"]));
$project = json_decode(stripslashes($_POST["project"]));
$owner = json_decode(stripslashes($_POST["owner"]));

$id = pg_query("SELECT * FROM users WHERE email = $owner");
$id_assoc = pg_fetch_assoc($id);
$id_res = $id_assoc['u_id'];

//SQL STATEMENT HERE FOR INSERT

$res = pg_query("INSERT INTO records (photo, name, description, latitude, longitude, project, owner) VALUES ('$photo', '$safe_name', '$safe_desc', '$latitude', '$longitude', '$project', '$id_res'");

pg_close($conn);

?> 
```

任何可以提供一些建议/教程/代码解决方案的人都会是我书中的英雄！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:39:21.867

查询是否`SELECT`返回任何内容？我不是 PHP 专家，但在我看来，您发送的变量错误，所以不应该：

```
$id = pg_query("SELECT * FROM users WHERE email = $owner"); 
```

但

```
$id = pg_query("SELECT * FROM users WHERE email ='".$owner."'"); 
```

与 INSERT 查询类似。其他想法：

*   当你只想要一列时不要这样做`SELECT *`，它会变慢。例如，在 9.2 中使用 index-only-scans 您可以直接从 index(email,id) 返回 id
*   如果您只想使用用户的 id，最好将其放在插入查询的子 查询中如果您在其他地方需要它，`INSERT INTO records ( ... ,owner) VALUES (... ,(SELECT id FROM users WHERE email='".$owner."')")` 您甚至可以在末尾添加以从插入查询中获取所有者 id。`RETURNING owner`

# symfony - S3::putObject(): 无法连接到主机

> ID：15588772
> 
> 赞同：2
> 
> 时间：2013-03-23T15:52:10.457
> 
> 标签：symfony, amazon-web-services, amazon-s3

我有一个使用 symfony2 制作的网络应用程序，该应用程序托管在亚马逊 AWS 中。在应用程序中，我们正在处理一些 pdf 文件并将它们转换为图像，然后我们将这些图像上传到 s3。

该应用程序在过去 6 个月中运行良好，但几天前，当应用程序开始上传图像时，我们在 s3.php 文件中出现错误。该应用程序停止将图像上传到存储库。

```
User Warning: S3::putObject(): [7] couldn't connect to host 
```

我做了很多测试以确定发生了什么，在本地环境中，应用程序仍然可以完美运行，并且双方的代码是相同的。我认为这可能与 aws 实例有关，我也认为服务器中的日期时间延迟了 8 分钟，但我也解决了这个问题。

请我需要一个线索..谢谢！

# c# - 即使数据库中的密码正确，第一个选择选项总是返回登录错误

> ID：15588776
> 
> 赞同：0
> 
> 时间：2013-03-23T15:52:49.403
> 
> 标签：c#, asp.net

我在使用 ASP.NET C# 时遇到了一个相当奇怪的问题。

除了第一个选项之外，我似乎可以使用选择下拉列表中的任何其他选项登录。我已经检查了数据库中的密码并且它是正确的。

有谁知道为什么会这样？

这是我的代码：

登录.aspx

```
<form id="loginForm" runat="server">
        <asp:Login runat="server" OnAuthenticate="Login1_Authenticate" Width="293px" Height="172px"
            ID="Login_Box">
            <LayoutTemplate>

                <!-- department -->
                <div id="dept" style="text-align: left">
                    Department<br />
                    <asp:DropDownList ID="UserName" runat="server" DataSourceID="SqlDataSource1" DataTextField="dept"
                        DataValueField="id" DataMember="DefaultView">
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:team13ConnectionString %>"
                        SelectCommand="SELECT [id], [dept] FROM [ts_dept] ORDER BY [dept]"></asp:SqlDataSource>
                </div>

                <!-- password -->
                <div id="pass" style="text-align: left">
                    Password:<br />
                    <asp:TextBox ID="Password" runat="server" TextMode="Password"></asp:TextBox>
                    <asp:RequiredFieldValidator ID="PasswordRequired" runat="server" ControlToValidate="Password"
                        ErrorMessage="Password is required." ToolTip="Password is required." ValidationGroup="Login1"
                        ForeColor="Red" Display="Dynamic">Password is required.</asp:RequiredFieldValidator>
                </div>

                <!-- failure text -->
                <div style="text-align: left; color: Red">
                <asp:Literal ID="FailureText" runat="server" EnableViewState="False" Mode="Encode"></asp:Literal>
                </div>
                <br />

                <!-- sign in button -->
                <div class="btn" style="float: right" runat="server">
                    <asp:Button ID="LoginButton" runat="server" CommandName="Login" Text="Log In" ValidationGroup="Login1"
                        CssClass="cupid-green"/>
                </div>

            </LayoutTemplate>
        </asp:Login>
        </form> 
```

登录.aspx.cs

```
using System;
using System.Collections;
using System.Configuration;
using System.Data.SqlClient;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Web.Configuration;

public partial class login : System.Web.UI.Page
{

    protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
    {
        string username = Login_Box.UserName;
        string pwd = Login_Box.Password;

        string strConn;
        strConn = WebConfigurationManager.ConnectionStrings["team13ConnectionString"].ConnectionString;
        SqlConnection Conn = new SqlConnection(strConn);
        Conn.Open();

        string sqlUserName;
        sqlUserName = "SELECT id,pass FROM ts_dept ";
        sqlUserName += " WHERE (id ='" + username + "')";
        sqlUserName += " AND (pass ='" + pwd + "')";
        SqlCommand com = new SqlCommand(sqlUserName, Conn);

        string CurrentName;
        CurrentName = (string)com.ExecuteScalar();

        if (CurrentName != null)
        {
            Session["UserAuthentication"] = username;
            Session.Timeout = 1;
            Response.Redirect("Default.aspx");
        }
        else
        {
            Session["UserAuthentication"] = "";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:11:39.710

一切看起来都不错，我认为我们需要查看数据库以确保用户实际上拥有正确的部门 ID。

# c# - 在按钮单击时动态添加 html 表

> ID：15588782
> 
> 赞同：0
> 
> 时间：2013-03-23T15:53:07.980
> 
> 标签：c#, asp.net

我在按钮单击事件中向数据库添加数据。我正在尝试在同一按钮单击事件中以同一页面上的 html 表的形式将添加的数据显示到数据库中。但我无法查看页面上的表格。我尝试调试，但一切看起来都很好。

这是一小段代码。

```
void btnAdd_Click(object sender, EventArgs e)
        {            
            Objects.InsertNewRequestIntoMaterialTransactions(...);
            LoadMaterialTakenTable();

        }
 void LoadMaterialTakenTable()
        {
            Table tblMaterialList = new Table();

            placeMaterialRequest.Controls.Add(tblMaterialList);
        } 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:07:13.430

看起来您正在加载一个空白表。创建新表 tblMaterialList 后，您必须先填充该表，然后再将其添加到您的 placeMaterialRequest 控件。

您可以在此处了解如何从 microsoft 构建表[http://msdn.microsoft.com/en-us/library/ms753342.aspx](http://msdn.microsoft.com/en-us/library/ms753342.aspx)

# javascript - 如何使用 Javascript 考虑多个搜索字段？

> ID：15588784
> 
> 赞同：2
> 
> 时间：2013-03-23T15:53:23.530
> 
> 标签：javascript, jquery, search

我在一个页面上有三个实时过滤器搜索字段。触发以在 keyup 上进行搜索。

*   主要作者
*   学科
*   日期

他们每个人都在一个特定的`<span>`元素中搜索`<div>`

我遇到的问题是，假设在一个字段中输入了错误的字符并且用户按下了退格键。该代码以前无法搜索字符，因为它现在被隐藏了。

如何添加在 keyup 上搜索时考虑其他搜索字段内容的功能？

[我的代码的 JSFiddle](http://jsfiddle.net/ARVft/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:39:23.560

您可以做的是，当用户确实执行退格时，首先再次显示所有作者，然后使用剩余的文本重新运行搜索。类似于下面的东西。

```
if (event.keyCode == 8){
   $("div.recordContainer span.listLeadAuthor").each(function(){
      $(this).parent().show();   
   });
} 
```

我已经在[这里](http://jsfiddle.net/ARVft/1/)更新了你的小提琴（仅用于第一个搜索过滤器）。

**编辑**

您可以将搜索功能更改为过滤器类并将相同的功能应用于它们吗？我在[这里更新了另一个小提琴，](http://jsfiddle.net/ARVft/2)这让您可以使用多个搜索字段。

# c# - 网页中的 Div 定位

> ID：15588787
> 
> 赞同：1
> 
> 时间：2013-03-23T15:53:40.793
> 
> 标签：c#, asp.net, html

编辑：

当前布局：

![在此处输入图像描述](../Images/ff000f7b626b66582c8c20e49c397c4f.png)

我试图弄清楚如何在我的 ASP 网页设计中将一个 div（服务器端）定位在另一个 div 下。

对于我的问题，我将使用以下屏幕截图：

目前这是我的布局：

![在此处输入图像描述](../Images/5cbae55ef3b7400a8161e2eb22639f3c.png)

我想在另一个下放置 2 个 div 给我一个 'title' div 和一个 'description' div tat 稍后将由我的数据库结果填充，如图所示：

![在此处输入图像描述](../Images/5698b85d70695d25798e76b2a0417ab1.png)

这是我当前的源代码。有人可以将我推向正确的方向，即我如何像这样将这些 div 置于另一个之上吗？

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true"  CodeBehind="Show.aspx.cs" Inherits="ViewCDs.Show" %>
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

     <div style=" float:left;">
     <asp:Image ID="Image1" runat="server" Height="145px" ViewStateMode="Enabled" 
     Width="185px" />

      </div>
      <div style=" float:left; width: 395px; height: 140px;">

      <asp:FormView ID="FormView1" runat="server">
       <EditItemTemplate>
           coffeeName:
           <asp:TextBox ID="coffeeNameTextBox" runat="server" 
               Text='<%# Bind("coffeeName") %>' />
           <br />
           coffeeOrigin:
           <asp:TextBox ID="coffeeOriginTextBox" runat="server" 
               Text='<%# Bind("coffeeOrigin") %>' />
           <br />
           coffeeStrength:
           <asp:TextBox ID="coffeeStrengthTextBox" runat="server" 
               Text='<%# Bind("coffeeStrength") %>' />
           <br />
           coffeeGrind:
           <asp:TextBox ID="coffeeGrindTextBox" runat="server" 
               Text='<%# Bind("coffeeGrind") %>' />
           <br />
           coffeePrice:
           <asp:TextBox ID="coffeePriceTextBox" runat="server" 
               Text='<%# Bind("coffeePrice") %>' />
           <br />
           coffeeQty:
           <asp:TextBox ID="coffeeQtyTextBox" runat="server" 
               Text='<%# Bind("coffeeQty") %>' />
           <br />
           coffeeRRP:
           <asp:TextBox ID="coffeeRRPTextBox" runat="server" 
               Text='<%# Bind("coffeeRRP") %>' />
           <br />
           <asp:LinkButton ID="UpdateButton" runat="server" CausesValidation="True" 
               CommandName="Update" Text="Update" />
           &nbsp;<asp:LinkButton ID="UpdateCancelButton" runat="server" 
               CausesValidation="False" CommandName="Cancel" Text="Cancel" />
          </EditItemTemplate>
          <InsertItemTemplate>
           coffeeName:
           <asp:TextBox ID="coffeeNameTextBox" runat="server" 
               Text='<%# Bind("coffeeName") %>' />
           <br />
           coffeeOrigin:
           <asp:TextBox ID="coffeeOriginTextBox" runat="server" 
               Text='<%# Bind("coffeeOrigin") %>' />
           <br />
           coffeeStrength:
           <asp:TextBox ID="coffeeStrengthTextBox" runat="server" 
               Text='<%# Bind("coffeeStrength") %>' />
           <br />
           coffeeGrind:
           <asp:TextBox ID="coffeeGrindTextBox" runat="server" 
               Text='<%# Bind("coffeeGrind") %>' />
           <br />
           coffeePrice:
           <asp:TextBox ID="coffeePriceTextBox" runat="server" 
               Text='<%# Bind("coffeePrice") %>' />
           <br />
           coffeeQty:
           <asp:TextBox ID="coffeeQtyTextBox" runat="server" 
               Text='<%# Bind("coffeeQty") %>' />
           <br />
           coffeeRRP:
           <asp:TextBox ID="coffeeRRPTextBox" runat="server" 
               Text='<%# Bind("coffeeRRP") %>' />
           <br />
           <asp:LinkButton ID="InsertButton" runat="server" CausesValidation="True" 
               CommandName="Insert" Text="Insert" />
           &nbsp;<asp:LinkButton ID="InsertCancelButton" runat="server" 
               CausesValidation="False" CommandName="Cancel" Text="Cancel" />
           </InsertItemTemplate>
           <ItemTemplate>

           <b>Origin:</b>
           <asp:Label ID="coffeeOriginLabel" runat="server" 
               Text='<%# Bind("coffeeOrigin") %>' />
           <br />
           <br />
           <b>Grind:</b>
           <asp:Label ID="coffeeGrindLabel" runat="server" 
               Text='<%# Bind("coffeeGrind") %>' />
           <br />
           <br />
           <b>Price: £</b>
           <asp:Label ID="coffeePriceLabel" runat="server" 
               Text='<%# Bind("coffeePrice") %>' />
           <br />
           <br />
               <b>Strength:</b>
           <asp:Label ID="coffeeStrengthLabel" runat="server" 
               Text='<%# Bind("coffeeStrength") %>' />
           <br />
           <br />
           <b>Stock Level:</b>
           <asp:Label ID="coffeeQtyLabel" runat="server" Text='<%# Bind("coffeeQty") %>' />
           <br />

 </ItemTemplate>
 </asp:FormView>
 <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
       ConnectionString="<%$ ConnectionStrings:CoffeeConnectionString %>" 
       SelectCommand="SELECT [coffeeName], [coffeeOrigin], [coffeeStrength], [coffeeGrind], [coffeePrice], [coffeeQty], [coffeeRRP] FROM [Coffees]">
</asp:SqlDataSource>

<br />
</div>

<div style=" float:left; width: 339px; height: 140px;">
<br />

<div style=" float:left; width: 165px; height: 25px;">

    <b><asp:Label ID="Label1" runat="server" Text="Select Coffee Grind:"></asp:Label>  </b>
</div>

<div style=" float:right; width: 165px; height: 25px;">
<asp:DropDownList ID="DropDownList1" runat="server" Height="21px" Width="161px">
    <asp:ListItem>Beans</asp:ListItem>
    <asp:ListItem>Smooth</asp:ListItem>
    <asp:ListItem>Course</asp:ListItem>
 </asp:DropDownList>
 </div>

  <div style=" float:left; width: 165px; height: 40px;">
  <br />
      <b><asp:Label ID="Label2" runat="server" Text="Quantity:"></asp:Label></b>
 </div>

  <div style=" float:right; width: 165px; height: 40px;">
  <br />

      <asp:TextBox ID="TextBox1" runat="server" Width="40px">1</asp:TextBox>

  </div>

  <div style=" float:left; width: 165px; height: 40px;">
  <br />

      <asp:Button ID="Button1" runat="server" Text="Buy" />

 </div>
 </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:04:05.650

您只需要在该代码下方再添加两个 div。

```
<div id="title"> </div> <br/>
<div id="description"> </div> <br/> 
```

但是，如果您想控制它们的属性，例如可见性，那么您只需要制作这些 asp.net 面板。

```
<asp:Panel runat="server" ID="title"> </asp:Panel> <br/>
<asp:Panel runat="server" ID="description"> </asp:Panel> <br/> 
```

# asp.net-mvc - 通过 AJAX 请求部分视图时，MVC 路由更改 url 哈希

> ID：15588790
> 
> 赞同：2
> 
> 时间：2013-03-23T15:53:53.510
> 
> 标签：asp.net-mvc, jquery, asp.net-mvc-routing, partial-views

我正在使用 AJAX 调用来请求部分视图并将其 html 加载到我的主索引视图的内容区域中。我正在利用 url 中的哈希来启用浏览器历史记录支持（与 GMail url 浏览器历史记录的工作方式相同）。

一切正常，除了返回并加载我的部分视图后，**MVC 似乎正在清除我的 url 哈希符号之后的所有内容，这会影响 javascript 浏览器历史堆栈**。

*我的主视图上有一个链接，它启动了请求*：

```
<div class="linkButton" data-bind="click:function(){Nav.makeRequest('#/MyController/Profile/2')}">Profile</div> 
```

*这是我用来请求和加载部分视图的 javascript*：

```
var Nav:function(){
    var self = this;
    $(window).bind("hashchange", self.onHashChange);

    makeRequest: function(hash){
        window.location.hash = hash;
    };

    onHashChange: function (e) {
        var hash = window.location.hash.substring(1); 
        var url = 'http://localhost:3333/' + hash.substring(1);
        $.get(url, function (data) {
            $('#content').html(data);
        });
    }
} 
```

因此，我的示例请求之一是：`http://localhost:3333/#/MyController/Profile/2`

请求成功完成，我的 Profile 视图加载了正确的模型，用于在路由中传递给它的 id ( *2* )，浏览器导航中的 url 如上所示。

然而，在视图完成加载后，浏览器的 url 会自动更改为：`http://localhost:3333/#`

这不会影响页面上当前加载的内容，但它会将这个新 url 添加到浏览器的历史记录中，因此当我点击“返回”按钮时，它会再次发送部分配置文件视图的请求。

*我在 Global.axax 中的唯一路线如下*：

```
routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", 
    new { controller = "MyController", action = "Index", id = UrlParameter.Optional } 
); 
```

我怀疑 MVC 路由引擎看到我对部分视图的请求进入 ( `http://localhost:3333/MyController/Profile/2`)，然后将其与返回我的索引视图的 url 的默认路由匹配，这当然是：`http://localhost:3333/`

我已经在客户端上进行了广泛的调试，并且 onHashChange 事件确实两次触发，一次是针对部分视图请求，然后是当 url 更改回 localhost:3333/# 调用堆栈没有显示任何客户端调用导致 url 变回。

**有没有一种方法可以让我使用 AJAX 请求和加载我的部分视图，并使用哈希来支持历史记录，并且让浏览器的 url 不会自动路由回默认路由路径？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-21T23:31:37.233

这必须是您搜索的内容：

要处理浏览器历史记录，您需要使用支持 Html5 的新方法

```
//use it in ur ajax function to save history 
 history.pushState({page: 1}, "title 1", "?page=1");

//and to get ur history
     window.onpopstate = function(event) {
    something like 

$.post('url',{page:event}function(event) {
    do something
}) 
```

}

# java - 我们应该扩展抽象类的 JavaDoc 类吗？

> ID：15588791
> 
> 赞同：3
> 
> 时间：2013-03-23T15:54:01.173
> 
> 标签：java, javadoc

假设我正在编写一个扩展抽象类“Work”的类“MyWork”。现在，假设我在“MyWork”中需要的所有方法都已经被声明并且已经在“Work”中编写了它们的 JavaDoc。我还应该在“MyWork”中添加 JavaDoc 吗？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T15:56:54.420

这取决于。如果您没有覆盖任何方法，则没有添加 Javadoc 的选项（仅在类级别）。在类中添加一些 Javadoc 来解释它存在的原因可能是有意义的。

如果您要覆盖方法，则可以这样编写 Javadoc：

```
/**
 * {@inheritDoc}
 * This implementation also does...
 */ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T16:00:02.093

对于非公开代码，我不会为任何`@inheritDoc`无法处理的事情而烦恼。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:55:38.973

除非 中的方法`MyWork`覆盖 中的任何功能`Work`，否则可以安全地假定这些方法的行为与其超类相似。不应该有任何理由记录非覆盖的方法或字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T15:56:20.387

我假设您正在谈论抽象方法，因此“MyWork”类需要覆盖它们。

如果它们没有任何特殊行为，则不需要添加新的 JavaDoc。否则记录他们如何实现抽象方法。通常必须有一个原因为什么这个方法是抽象的，必须在继承类中实现，而不是在抽象类本身中实现。

您可以使用`{@inheritDoc}`获取继承的 Doumentation 的文本，然后在其下方添加特殊行为。

# html - .htaccess 中的两个重写规则

> ID：15588796
> 
> 赞同：0
> 
> 时间：2013-03-23T15:54:22.857
> 
> 标签：html, regex, .htaccess, web-applications

目前我有以下代码从 url 中删除 .php

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

但我也想用 URL 中的 / 替换文件名中的字符 _ 。我试过这样做，但我只是得到一些奇怪的错误。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:56:54.107

由于您声明只有零或一个下划线可能是请求文件的一部分，所以这应该有效：

```
RewriteCond %{REQUEST_URI} \.php$ [OR]
RewriteCond %{REQUEST_FILENAME} -d [OR]
RewriteCond %{REQUEST_FILENAME}\.php !-f
RewriteRule .* - [S=2]
RewriteRule ^(.*)$ $1.php
RewriteRule ^([^_]+)_([^_]+)$ $1/$2 [L] 
```

仅当所有三个前面的条件都为真时才应用*这两个*规则（不仅仅是第一个），您否定条件并在之后应用跳过规则：`[S=2]`意味着“跳过以下 2 个规则”。

因此，如果所有新的三个条件都为假（因此它们的否定为真），则第一次重写将附加`.php`到所有请求。第二次重写将所有下划线更改为斜线并停止重写。

# python - GAE Python - 每天将 CSV 保存到同一个 Blobstore 元素的任务

> ID：15588799
> 
> 赞同：1
> 
> 时间：2013-03-23T15:54:38.207
> 
> 标签：python, google-app-engine, csv, blobstore

我一直在阅读一些类似的问题，但无法找到我可以实施的答案。我正在使用 Google App Engine 并使用 unicodecsv 进行简单的 CSV 导出，效果很好。此导出应该每天运行，并且每次都将结果保存为相同的 Blobstore 项，因此可以从相同的 URL 检索它。

我知道这不是 Blobstore 项目的初衷，但我也阅读了一些使其工作的文章。不幸的是，由于我不是一个经验丰富的程序员，我无法在我的情况下使用它。如果有人能给我一些关于如何实现这一点的意见，那就太好了。

```
class ShopExport(webapp2.RequestHandler):
  def get(self):
    shops = Shop.all()
    self.response.headers[str('Content-Type')] = str('application/csv')
    self.response.headers[str('Content-Disposition')] = str('attachment; filename="shops.csv"')
    writer = unicodecsv.writer(self.response.out, encoding='utf-8')
    writer.writerow(["id", "name", "domain", "category", "deeplink"])
    for shop in shops:
      writer.writerow(["'"+shop.keyname+"'", "'"+shop.name+"'", "'"+shop.url+"'", "'"+shop.category+"'", "'"+shop.url_aff+"'"]) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T04:48:21.550

正如 Tim 指出的那样，您不能覆盖 blobstore 实体，但您可以每次创建一个新实体并记住为新实体提供服务的密钥：

```
class BlobKey(db.Model) :
    blob_key = db.StringProperty() 
```

然后，在 cron 处理程序中，您可以：

```
blob_key = BlobKey.all().get()
blob = blobstore.get(blob_key)
if blob : blob.delete()
db.delete( blob_key )    # you don't need it anymore

file_name = files.blobstore.create( mime_type = 'text/csv')
with files.open(file_name, 'a') as f:
    f.write( your_content )

files.finalize(file_name)
blob_key = files.blobstore.get_blob_key(file_name)

BlobKey( blob_key = str(blob_key) ).put()   # save the new key 
```

最后，当您提供文件（在 a 中`BlobstoreDownloadHandler`）时，您只需：

```
blob_key = BlobKey.all().get()
if blobstore.get(blob_key):
    self.send_blob(blobstore.BlobInfo.get(blob_key),
        content_type = 'text/csv', save_as=True)    # False to mangle file name
else:
    self.error(404) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T00:33:56.393

您不能覆盖 Blob 存储实体，只能将其删除。您无法控制 blob 存储密钥，因此您必须通过重定向到当前 blob 存储 URL 来保留/管理应用程序中的 URL。至于写入 blob 存储，请查看文件 api

[https://developers.google.com/appengine/docs/python/blobstore/overview#Writing_Files_to_the_Blobstore](https://developers.google.com/appengine/docs/python/blobstore/overview#Writing_Files_to_the_Blobstore)

# c++ - 从文本文件中读取矩阵到二维整数数组 C++

> ID：15588800
> 
> 赞同：4
> 
> 时间：2013-03-23T15:54:51.370
> 
> 标签：c++, arrays, file, matrix

```
1 3 0 2 4 
0 4 1 3 2 
3 1 4 2 0 
1 4 3 0 2 
3 0 2 4 1 
3 2 4 0 1 
0 2 4 1 3 
```

我在 .txt 文件中有一个这样的矩阵。现在，我如何`int**`以最好的方式将这些数据读入一种二维数组？我搜索了整个网络，但找不到令人满意的答案。

```
array_2d = new int*[5];
        for(int i = 0; i < 5; i++)
            array_2d[i] = new int[7];

        ifstream file_h(FILE_NAME_H);

        //what do do here?

        file_h.close(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T16:06:40.717

首先，我认为您应该创建一个`int*[]`大小为 7 的数组并从 1 循环到 7，同时在循环内初始化一个 5 的 int 数组。

在这种情况下，你会这样做：

```
array_2d = new int*[7];

ifstream file(FILE_NAME_H);

for (unsigned int i = 0; i < 7; i++) {
    array_2d[i] = new int[5];

    for (unsigned int j = 0; j < 5; j++) {
        file >> array_2d[i][j];
    }
} 
```

编辑（经过相当长的时间）：
或者，我建议使用 a`vector`或 an `array`：

```
std::array<std::array<int, 5>, 7> data;
std::ifstream file(FILE_NAME_H);

for (int i = 0; i < 7; ++i) {
    for (int j = 0; j < 5; ++j) {
        file >> data[i][j];
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T16:02:24.740

```
for (int i = 0; i < n; i++) {
 for (int j = 0; j < n; j++) {
    int n;
    fscanf(pFile, "%d", &n);
    printf("(%d,%d) = %d\n", i, j, n);
    array[i][j] = n;
} 
```

我希望它有所帮助。

# javascript - 用户脚本，遍历元素和测试属性

> ID：15588803
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:55:04.757
> 
> 标签：javascript, userscripts

一般来说，我对 Userscripts 和 JavaScript 有点陌生，而且我很迷茫。

基本上我想要做的是通过使用getElementsByClassName获得的元素，获取“name”属性中的数据，查看它是否包含某些内容，如果包含，将类名更改为其他内容。

在伪ish代码中：

```
items = getElementsByClassName("item1");

for each item in items {
    if(item.attribute("name").contains("Hi"))
        item.attribute("class") = "item2";
} 
```

如果有人能给我一些关于如何做到这一点的提示，那就太棒了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:03:08.843

试试这个：

```
// get all items with class 'item1'
var items = document.querySelectorAll('.item1');
var length = items.length;
for (var i = 0; i < length; i++) {
    // save reference to current item
    var item = items[i];
    // check if name contains 'Hi'
    if (item.getAttribute('name').indexOf('Hi') !== -1) {
        // update class
        item.className += ' item2';
    }
} 
```

演示：http: [//jsfiddle.net/vpetrychuk/9zBnn](http://jsfiddle.net/vpetrychuk/9zBnn)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:09:00.553

Vitaliy 的回答是正确的，但值得一提的是 document.querySelectorAll (a `NodeList`) 返回的对象可以转换为 JavaScript `Array`，以便使用 JavaScript 提供的[高阶 Array 函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array#Iteration_methods)，例如：

```
// Convert the `NodeList` returned by `querySelectorAll` into an `Array`.
var items = Array.prototype.slice.call(document.querySelectorAll('.item1'));

items
    .filter(function (item) {
        // Filter Array to only include items that have a name attribute
        // that beings with "Hi".
        return item.getAttribute('name').indexOf('Hi') !== -1;
    })
    .forEach(function (hiItem) {
        // Add a class to these items.
        hiItem.className += ' item2';
    }); 
```

就个人而言，我发现这些高阶 Array 函数更易于使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T01:38:55.027

充分利用`querySelectorAll`. 另外，使用 DOM 方法；不要搞砸`class`属性或`className`：

```
var items = document.querySelectorAll (".item1[name*='Hi']");

for (var J = items.length-1;  J >= 0;  --J) {
    items[J].classList.add ("item2");
} 
```

* * *

* * *

更好的是，使用[jQuery](https://stackoverflow.com/questions/2246901/how-can-i-use-jquery-in-greasemonkey-scripts-in-google-chrome/12751531#12751531)：

```
$(".item1[name*='Hi']").addClass ("item2"); 
```

# mqtt - Pywebsocket“房间”或“主题”概念

> ID：15588804
> 
> 赞同：0
> 
> 时间：2013-03-23T15:55:05.570
> 
> 标签：mqtt, mod-pywebsocket

我正在尝试通过 MQTT 将数据传递到某些 HTML5 页面的不同方法。

我已经将**Node.js**与**Socket.IO**一起查看，这似乎是一个不错的解决方案，因为 Socket.IO 有一个*“房间”*概念，可以很容易地转换为 MQTT *“主题”*。

我很好奇**pywebsocket**是否有任何这样的概念，它允许我对多个页面使用相同的 websockethandler，而无需向所有页面发送相同的数据。

我已经查看了[pywebsocket](https://code.google.com/p/pywebsocket/)谷歌代码页以及[一些示例](https://code.google.com/p/websocket-sample/)，但我无法找到任何允许这种行为的信息。如果有人对此有更多信息，我会很高兴:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T13:43:42.117

虽然我无法直接提示您将 Socket.IO 的房间概念转换为 MQTT，但您可能想看看[Mosquitto.js](http://mosquitto.org/js/mosquitto-1.1.js)，它允许您通过 Websockets 从浏览器轻松建立 MQTT 连接，其行为非常类似于真实网络套接字。使用这种方法，每个打开的页面都会建立到 MQTT 代理的唯一连接。因此，您甚至可以根据客户端的某些条件订阅不同的主题。

一个小示例代码：

```
 var mqttSocket = new Mosquitto();

  mqttSocket.onconnect = function(rc){
    console.log("Connection established");
  };

  mqttSocket.ondisconnect = function(rc){ 
    console.log("Connection terminated");
  };

  mqttSocket.onmessage = function(topic, payload, qos){
    console.log("Message received " + topic + ":" + payload);
  }

  mqttSocket.connect("ws://yourserver:8080"); 
  mqttSocket.subscribe('some/topic', 0); 
```

由于尚未在任何 MQTT 代理中真正实现对 Websocket 连接的本机支持，因此服务器端需要一些软件将 Websocket 连接桥接到 MQTT 代理。

Mosquitto.js 的开发人员建议为 Lighttpd 网络服务器使用自定义 mod_websocket 模块来完成此任务。但是，作为替代方案，您可能想尝试[WSS](https://github.com/stylpen/WSS "WSS")，它将任何 Websocket 连接转换为任意其他 TCP 端口，并且开销最小

对于上面的示例，您可以将 mqttSocket 连接到 WSS 实例正在侦听传入连接的地址和端口。然后将 WSS 配置为将传入连接转发到您选择的 MQTT 代理。

免责声明：WSS 由我的一个朋友编写，专门用于将 Mosquitto.js 连接连接到 Mosquitto MQTT 代理的实例。

我希望这有帮助。

# pygtk - 如何从 FileChooserButton [PyGTK] 接收文件夹

> ID：15588808
> 
> 赞同：0
> 
> 时间：2013-03-23T15:55:28.243
> 
> 标签：pygtk, filechooser

我正在尝试使用 FileChooserButton 来获取用户选择的文件夹的路径。我已经阅读了有关 FCB 的文档，我认为我应该使用 get_current_folder() 但是当我这样做时，我得到一个全局名称错误。据我所知， get_current_folder() 应该已经在 FCB 方法中定义了，不应该再次定义。

```
 def on_fromdialog_current_folder_changed(self, widget):
    print get_current_folder() 
```

这段代码返回以下错误：

```
NameError: global name 'get_current_folder' is not defined 
```

我错过了什么吗？我什至考虑为用户在路径中键入的简单文本文件废弃 FileChooser，但这对我正在开发的应用程序毫无意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T18:02:17.220

我认为这就是你要找的：

```
def on_fromdialog_current_folder_changed(self, widget):
    print widget.get_current_folder() 
```

# php - apache日志中的Codeigniter空白页和错误500？

> ID：15588813
> 
> 赞同：9
> 
> 时间：2013-03-23T15:55:56.997
> 
> 标签：php, apache, codeigniter-2

昨天我花了 5 个多小时试图找出我的设置有什么问题。在 ci213/application/controllers 和 views 目录中，我有一个简单的 site.php 控制器和 test.php 视图。我不知道为什么该网站无法加载。有人对我接下来可以寻找什么有建议吗？也许记录它工作正常？如果我能得到更好的日志错误，我可以有更多的工作。

我认为它必须与codeigniter有关，因为我在apaches根目录（/var/www）有一个index.php和index.html，在站点根目录（/var/www/vhosts/srp-local）也有一个index2.php /htdocs)，当我转到 localhost/index.(php|html) 或 srp-local/index2.php 时，页面会正确加载和显示，因此 php 和 apache 正在工作。

尝试加载该站点时，我得到一个空白页面，因此我认为它必须与 CI 有关。我正在跟踪所有日志文件，唯一获得更新的是站点 access.log 并出现以下错误。

```
127.0.0.1 - - [23/Mar/2013:09:00:28 -0600] "GET / HTTP/1.1" 500 381 "-" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:19.0) Gecko/20100101 Firefox/19.0" 
```

配置文件

```
$config['base_url'] = 'http://srp-local/'; # My hosts file is configured for this.
$config['log_threshold'] = 4;
$config['log_path'] = '/var/www/vhosts/srp-local/logs/ci_error.log'; 
```

控制器/site.php

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');
class Site extends CI_Controller
{
    public function index()
    {
        $this->load->view('test');
    }
} 
```

意见/test.php

```
<html>
<head>
</head>
<body>
<?php echo "PHP is working and the 'test' view was loaded"; ?>
</body>
</html> 
```

阿帕奇根

```
/var/www/vhosts
$ ll
drwxrwsr-x  6 krizzo www-data 4096 Mar 22 10:45 it355
drwxrwsr-x  6 krizzo www-data 4096 Mar 22 17:45 srp-local 
```

htdocs 是 srp-local 的 webroot，它的 index.php 引用到 ci213 文件夹。

```
/var/www/vhosts
$ ll srp-local/
drwxrwsr-x 2 krizzo www-data 4096 Mar 22 17:06 cgi-bin
drwxrwsr-x 4 krizzo www-data 4096 Mar 22 17:14 ci213
drwxrwsr-x 2 krizzo www-data 4096 Mar 22 17:19 logs
drwxrwsr-x 5 krizzo www-data 4096 Mar 22 17:26 htdocs 
```

所有日志位置/权限

```
/var/log/apache2/
    -rw-rw-rw- 1 www-data adm     0 Mar 23 08:52 php_errors.log
    -rw-r----- 1 root     adm 12191 Mar 23 09:32 access.log
    -rw-r----- 1 root     adm  4858 Mar 23 09:32 error.log

/var/www/vhosts/srp-local/logs/
    -rw-r--r-- 1 root   www-data  3227 Mar 22 19:42 error.log
    -rw-rw-r-- 1 krizzo www-data     0 Mar 23 09:37 ci_error.log
    -rw-r--r-- 1 root   www-data 12983 Mar 23 09:38 access.log 
```

php.ini 文件设置

```
error_reporting = E_ALL & ~E_DEPRECATED
log_errors = On
error_log = /var/log/apache2/php_errors.log 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-24T16:51:08.347

我终于找到了一些指引我正确方向的东西。这两篇文章提到 CI 如何在数据库模块中使用 @ 可能会导致该问题。

[php 返回 500 错误但没有错误日志](https://stackoverflow.com/questions/7149030/php-return-500-error-but-no-error-log)
[CodeIgniter 项目加载空白网页](https://stackoverflow.com/questions/7486872/codeigniter-project-loads-blank-webpage)

我禁用了自动加载数据库模块并且站点正常工作。现在我只需要弄清楚我得到的可能导致 CI​​ 失败的数据库错误。一旦我弄清楚，我会更新这个答案。

**更新：**我检查了帐户/密码并访问了数据库，一切正常。问题是未安装 php mysql 驱动程序。这是我第一次真正使用 Ubuntu 系统，我认为 mysql 驱动程序将使用默认的 php 包安装，我错了。

安装 php5-mysqlnd 并在 CI 的自动加载中启用数据库库后，现在一切正常。我没有得到任何错误的事实确实让我考虑改变框架。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-07T22:44:01.030

发布此内容，以防万一它对某人有所帮助...

如果您在共享托管平台上并且无权访问您应该托管文件的目录以外的目录：诀窍是强制 php 抛出所有错误，即使阿帕奇不能。

打开位于 codeigniter 安装根文件夹中的“index.php”；

```
define('ENVIRONMENT', 'development');

if (defined('ENVIRONMENT'))
{
    switch (ENVIRONMENT)
        {
            case 'development':
            error_reporting(E_ALL);
            /*added line below*/
            ini_set('display_errors', '1');
            break;
...... 
```

进行上述更改后立即开始显示代码有什么问题，我能够修复它并启动并运行它。

完成修复后，不要忘记将您的 codeigniter 环境设置为“生产”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-19T07:27:31.993

这是错误可能不可见的另一个原因：

我遇到过同样的问题。就我而言，我从生产环境中复制了源代码。因此，在中`ENVIRONMENT`定义的变量`index.php`被设置为`'production'`。这导致`error_reporting`设置为 0（无日志记录）。只需将其设置为`'development'`，您应该开始在 apache 日志中看到错误消息。

原来 500 是由于数据库配置中缺少半冒号 :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-21T13:44:59.227

就我而言（购物车类），这是一个 URL 问题，请查看

```
/var/log/apache2/error.log 
```

如果你有类似的东西

```
[client 127.0.0.1] File does not exist: ... 
```

然后你必须像这样在你的类名前加上'/index.php/'

```
http://localhost/codeigniter/index.php/cart 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-20T04:17:51.567

我也在为这个问题而苦苦挣扎。

在我的新服务器上，我没有`php mb_string`安装模块。

`yum install php-mbstring`进而`service httpd restart`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-12T10:18:14.183

在我的情况下，错误没有显示，因为 php 设置中的显示错误未设置为活动。将其设置为活动 php 后，会显示导致 500 错误的问题。
[![显示错误](../Images/0a2efd91648d82ebd444fd500239881d.png)](https://i.stack.imgur.com/XY72J.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-23T04:51:47.320

就我而言，我检查了位于**`logs/`**CI 项目文件夹中的错误日志。
它恰好是与数据库相关的错误。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-01-19T11:51:49.037

我检查了 7.0.xx 的 php 版本，所以我降级到 php 5.6.xx 并使用以下步骤让它为我工作。

```
sudo a2dismod proxy_fcgi proxy; sudo service apache2 restart
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install php7.0 php5.6 php5.6-mysql php-gettext php5.6-mbstring php-mbstring php7.0-mbstring php-xdebug libapache2-mod-php5.6 libapache2-mod-php7.0 
```

# ruby-on-rails - 在 Rails 3 中的模型之间传递值的正确方法是什么？

> ID：15588815
> 
> 赞同：1
> 
> 时间：2013-03-23T15:56:09.650
> 
> 标签：ruby-on-rails, model, transactions, associations

我的应用程序中有以下设置。

```
class Account < ActiveRecord::Base
  attr_accessible :balance, :user_id
  belongs_to :user
end

class User < ActiveRecord::Base
  attr_accessible :name, :email
  has_one :account
end 
```

我们有用户的地方（比如银行的客户），他们有一个帐户。如果我现在想将资金从账户 A 转移到账户 B，那么在 Rails 3 中执行此操作的正确方法是什么？

我们正在考虑将整个语句包装在事务中，类似于：

```
ActiveRecord::Base.transaction do
  david.withdrawal(100)
  mary.deposit(100)
end 
```

但我们不清楚的是，我们是否需要在控制器中创建新方法，或者....控制器中的方法可以解决这个问题。最重要的是，您将如何以正确的方式将变量从表单传递到模型，因为该表单并不总是在该特定模型的视图结构中。

话又说回来 - 也许这有一个宝石？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T19:13:06.553

这是发布的相同代码`mdepolli`，只是重新组织

```
class Account < ActiveRecord::Base
  attr_accessible :balance, :user_id
  belongs_to :user

  def withdraw(amount)
    # ...
  end

  def deposit(amount)
    # ...
  end

  def self.transfer(from_account, to_account, amount)
    from_account.withdraw(amount)
    to_account.deposit(amount)
  end
end 
```

调用代码（控制器操作？）

```
Account.transaction do
  Account.transfer(david, mary, 100.02)
end 
```

根据您的偏好，您可能希望在传输方法中启动事务块？我通常把我的推到控制器动作上

这是一个使用散列的稍微修改的版本，因此调用代码可以使用键而不是有序参数

```
 def self.transfer(args = {})
    from_account = args.fetch(:from)
    to_account = args.fetch(:to)
    amount = args.fetch(:amount)

    from_account.withdraw(amount)
    to_account.deposit(amount)
  end

  Account.transfer({ from: david, to: mary, amount: 100.02 }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:17:47.033

助手/application_helper.rb

```
module ApplicationHelper
  def transfer(from_account, to_account, amount)
    from_account.withdraw(amount)
    to_account.deposit(amount)
  end
end 
```

模型/account.rb

```
class Account < ActiveRecord::Base
  def withdraw(amount)
    ...
  end

  def deposit(amount)
    ...
  end
end 
```

# c++ - cout 不产生输出

> ID：15588821
> 
> 赞同：1
> 
> 时间：2013-03-23T15:56:25.607
> 
> 标签：c++, oop, io

所以我在一个对象的方法中，但是 cout 语句根本不产生任何输出。

```
#include <iostream>
#include <stdio.h>

Object::Method()
{
    printf("why is the next line not printing? This one prints fine\n");

    std::cout << "This line should print second, but doesnt" << std::endl;

    printf("but this line prints fine like the first!\n");
} 
```

输出是：

> 为什么下一行不打印？这个打印很好
> 
> 但是这条线像第一条一样打印得很好！

我似乎无法弄清楚为什么它不会打印。`std::flush`也没有效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T17:57:27.663

您应该使用`std::cout`（C++ 流）或 C 风格的流。混合它们可能会产生未定义的行为。

例如，它们可以有单独的“缓冲”通道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:05:43.967

代码片段在我的系统上运行良好，您的问题可能来自此处未列出的代码的其他部分。尝试`fflush(stdout)`在方法的开头，看看它是否有效。

# caching - sql alchemy + 金字塔，“请求缓存”

> ID：15588825
> 
> 赞同：1
> 
> 时间：2013-03-23T15:56:39.633
> 
> 标签：caching, sqlalchemy, pyramid, chameleon, template-tal

我正在制作一个网站，使用金字塔、sqlalchemy 和 chameleon... 在 vi​​ew.py 上我发送 sqlalchemy：

```
@view_config(route_name='entity_subpage')
def entity_subpage_view(request):
    dbsession = DBSession()
    User = dbsession.query(Users).filter_by(id=0).first()
    return render_to_response('page.pt', User=User, request=request) 
```

和变色龙：

```
<a tal:condition="user.minions.filter_by(dead=0).count() > 1">Prev</a>
<a tal:condition="user.minions.filter_by(dead=0).count() > 1">Next</a>
<repeat tal:omit-tag="" tal:repeat="_page user.minions">
    <condition tal:omit-tag="" tal:condition="not minion.dead"> 
        <li>
             ${minion.name}
        </li>
    </condition>
</repeat> 
```

但是 sqlalchemy “user.minions.count()” 运行了两次，所以我在模型上添加了这个：

```
class Users(Base):
    __tablename__ = 'users'
    id = Column(Integer, primary_key=True)
    name = Column(String(convert_unicode=True))
    minions = dynamic_loader("Minions", backref="User")
    _NumFixedMinions = None

    @property
    def NumAliveMinions(self):
        if not self._NumFixedMinions:
            self._NumFixedMinions = self.minions.filter_by(dead=0).count()
        return self._NumFixedMinions 
```

并开始使用“NumFixedMinions”而不是“.count()”，但这使得 _NumFixedMintions 定义，直到我重新启动服务器，我错过了什么吗？或者有没有办法只在请求期间制作一个简单的“缓存”..

ps：这不是真正的代码，因为网站是模块化的，所以很难知道什么时候会被使用两次

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:58:28.957

只需在模板中调用`count()` *一次：*

```
<tal:links tal:condition="user.minions.filter_by(dead=0).count() > 1">
    <a>Prev</a>
    <a>Next</a>
</tal> 
```

对于您想在请求中使用的信息*，*我会使用[请求属性](http://docs.pylonsproject.org/projects/pyramid/en/latest/api/request.html#pyramid.request.Request.set_property)；如果您设置`reify`为`True`then 它只会计算*一次*并且*仅*在使用时计算：

```
def entity_subpage_view(request):
    dbsession = DBSession()
    User = dbsession.query(Users).filter_by(id=0).first()

    def dead_minion_count(request):
        return User.minions.filter_by(dead=0).count()

    request.set_property(dead_minion_count, 'dead_minion_count', reify=True)

    return render_to_response('page.pt', User=User, request=request) 
```

然后

```
<tal:links tal:condition="request.dead_minion_count > 1">
    <a>Prev</a>
    <a>Next</a>
</tal> 
```

# jakarta-ee - Java EE 6 中的 @Remote 是否可以访问私有方法？

> ID：15588827
> 
> 赞同：0
> 
> 时间：2013-03-23T15:56:45.607
> 
> 标签：jakarta-ee, annotations, remote-access, private-methods

考虑这段代码：

```
@Remote
public interface ISayHello {
    private void sayHello();
} 
```

该`sayHello`方法是否可以从外界访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:00:20.690

不允许在接口中创建私有方法……它们都是`public abstract`默认的。

接口的所有公共方法`@Remote`都是 EJB 的业务方法。

如果你想让一些 EJB 方法不暴露给外界，要么不要在接口中定义它们（以防你使用本地/远程业务接口），要么将它们封装为私有/受保护/私有（以防界面视图。）

# jquery - 来自“发布”页面的 jQuery 同位素过滤

> ID：15588828
> 
> 赞同：1
> 
> 时间：2013-03-23T15:56:49.173
> 
> 标签：jquery, wordpress, cookies, jquery-isotope

我正在 Wordpress 中建立一个投资组合网站。我已经使用了带有过滤功能的 jquery 插件[Isotope](http://isotope.metafizzy.co)。这在主页上非常有用。但是，一旦我点击一个帖子。然后我需要能够点击一个过滤器并让它进入主页但应用了过滤器。我的代码如下：

**HTML：**

```
<ul class="filters">
    <li><a href="<?php echo site_url(); ?>/about-me">About Me</a></li>
    <li><a class="filter" href="" data-filter=".creative">Creative</a></li>
    <li><a class="filter" href="" data-filter=".social-strategy">Social Strategy</a></li>
    <li><a class="filter" href="" data-filter=".design">Design</a></li>
    <li><a class="filter" href="" data-filter=".websites">Websites</a></li>
    <li><a href="" class="active" data-filter="*">All</a></li>
</ul> 
```

**Javascript：**

```
$('#filters a').click(function(){
      var selector = $(this).attr('data-filter');
      $container.isotope({ filter: selector });
      return false;
}); 
```

我确实尝试过这个解决方案，这正是我想要实现的目标：[http](http://www.mcnab.co/blog/content-management-systems/jquery-isotope-filtering-results-for-url/) ://www.mcnab.co/blog/content-management-systems/jquery-isotope-filtering-results-for-url/但它没有为我工作。

我的网站只有两个页面，主页（带有过滤器）和帖子页面。过滤器控件位于 header.php 文件中。

# windows-phone-7 - WP7 - 快速应用程序切换和互联网连接

> ID：15588831
> 
> 赞同：2
> 
> 时间：2013-03-23T15:57:09.993
> 
> 标签：windows-phone-7, internet-connection, fast-app-switching

例子：

我的应用程序正在执行 HTTP 连接。如果我使用主页按钮（快速应用程序切换）切换到主屏幕，我的应用程序正在执行的连接将被取消。

为什么？

有什么办法可以避免吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T22:06:21.263

不幸的是（或者取决于您如何看待它，幸运的是，因为它可以节省电池寿命），当应用程序由于按下主页按钮而停用时，大多数 HTTP 连接将被取消，并且大多数操作将暂停。[此博客文章](http://matthiasshapiro.com/2012/01/11/httpwebrequest-webclient-and-tombstoning-in-windows-phone-7/)中的代码将检查 HttpWebRequest 是否因应用停用（墓碑）而取消：

```
 try
    {
         HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(MyResultAsync);
    }
    catch (WebException e)
    {
        if (e.Status == WebExceptionStatus.RequestCanceled)
            MessageBox.Show("Looks like your request was interrupted by tombstoning");
        else
        {
            using (HttpWebResponse response = (HttpWebResponse)e.Response)
            {
                MessageBox.Show("I got an http error of: " + response.StatusCode.ToString());
            }
        }
    } 
```

如果你想在后台下载/上传文件，可以看看[这篇文章](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202955%28v=vs.105%29.aspx)。对于任何更复杂类型的网络操作，您都不走运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:03:02.363

不，没有办法避免这种情况。当您快速应用程序切换时，您的所有网络请求都将被取消。

如果它被取消，您将能够在返回应用程序时遇到的异常中检测到这一点：

```
catch (WebException webEx)
{
    if (webEx.Status == WebExceptionStatus.RequestCanceled)
    {
        // Retry request
    }
    else
    {
        // Handle other exception 
    }
} 
```

如果您的应用程序有其他方式（手动）取消请求，那么您也需要考虑这些。

# python - 谷歌应用引擎的模型设计模式

> ID：15588836
> 
> 赞同：1
> 
> 时间：2013-03-23T15:57:37.590
> 
> 标签：python, google-app-engine, data-modeling, google-cloud-datastore

我正在谷歌应用引擎上构建一个应用程序，它具有三种不同类型的用户（ABC、LMN、XYZ）。
这就是我的模型的样子

```
用户（db.Model）：
   电子邮件 = db.EmailProperty()
   用户名 = db.StringProperty()
   密码 = db.StringProperty()
   角色 = db.IntegerProperty()

## 角色 = 1 代表 ABC；2 代表 LMN；3 代表 XYZ

ABC（用户）：
    名称 = db.StringProperty()
    isSuperHero = db.BooleanProperty()

LMN（用户）：
    昵称 = db.StrngProperty()
    职业 = db.StringProperty()
# 其他一些随机属性

XYZ（用户）：
    部门 = db.StringProperty()
    工资 = db.FloatProperty()

```

我想提供一个**登录**页面，其中所有三个用户都可以登录到应用程序。
在数据存储中，我将有 4 个不同的实体用户、ABC、LMN、XYZ 记录。
我看到有两种方法：

*   第一种方法是扩展 User 模型：这种方法的缺点是在 User 以及其他 3 个实体中存储冗余信息（用户名..等）。
*   第二种方法是在三个实体中保留用户的引用（从而消除冗余列）。我看到的缺点是要获取用户的电子邮件，我需要获取用户的参考（我猜涉及的成本很高）

因此，问题归结为基本原理：我应该将冗余列存储在所有实体中，还是应该将相应用户的引用存储在实体中。有人可以提供一些示例，说明两种方法的数据成本（读/写）**差异**是多少？

# google-chrome - Google Chrome 高度动画的奇怪行为

> ID：15588843
> 
> 赞同：0
> 
> 时间：2013-03-23T15:58:28.753
> 
> 标签：google-chrome, css, animation

我正在尝试使用 CSS 在我的网站上设置“div”高度的动画。

它在 FF 和 Safari 上完美运行，但在 Chrome 上却有一个奇怪的行为。

我有 4 个 'div's，当单击它们时它们会拉伸以显示整个包含的文本，然后当再次单击它们时它们会收缩并隐藏。在 Chrome 上，一旦我单击其中一个，它们就会全部展开到全高，然后，当动画结束时，返回到它们应该在首位的高度。

你可以看到：[http ://www.wefind-tech.com/WhatIsIt_ChromeV.html](http://www.wefind-tech.com/WhatIsIt_ChromeV.html)

有解决方案吗？

谢谢

埃雷兹

CSS是：

```
.WeFind_Div_PunchLine::first-letter{
        font-weight: bold;
        font-size: 20px;
    }

    .WeFind_Div_PunchLine{
        width: 95%;
        line-height: 40px;
        margin-top: 20px;
        margin-bottom: 20px;
        padding-left: 10px;

        border: 1px solid #CCCCCC;
        border-radius:10px;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
        -o-border-radius: 10px;

        box-shadow: 10px 10px 5px #CCCCCC;
        -webkit-box-shadow: 10px 10px 5px #CCCCCC;
        -moz-box-shadow: 10px 10px 5px #CCCCCC;
        -o-box-shadow: 10px 10px 5px #CCCCCC;
    }

    .WeFind_Div_Contructed{
        height: 0px;
        overflow: hidden;
    }

    /*VERTICAL EXPAND element animation*/
    @keyframes WeFimd_Anim_Expand{
        from {height: 0px;}
        to {height: 150px;}
    }

    @-moz-keyframes WeFimd_Anim_Expand /* Firefox */{
        from {height: 0px;}
        to {height: 150px;}
    }

    @-webkit-keyframes WeFimd_Anim_Expand /* Safari and Chrome */{
        from {height: 0px;}
        to {height: 150px;}
    }

    @-o-keyframes WeFimd_Anim_Expand /* Opera */{
        from {height: 0px;}
        to {height: 150px;}
    } 

    /*VERTICAL CONTRUCT element animation*/
    @keyframes WeFimd_Anim_Contruct{
        from {height: 150px;}
        to {height: 0px;}
    }

    @-moz-keyframes WeFimd_Anim_Contruct /* Firefox */{
        from {height: 150px;}
        to {height: 0px;}
    }

    @-webkit-keyframes WeFimd_Anim_Contruct /* Safari and Chrome */{
        from {height: 150px;}
        to {height: 0px;}
    }

    @-o-keyframes WeFimd_Anim_Contruct /* Opera */{
        from {height: 150px;}
        to {height: 0px;}
    } 

    .WeFind_Div_Expand{
        overflow: hidden;

        animation-fill-mode: both;
        animation: WeFimd_Anim_Expand 1s;

        -moz-animation: WeFimd_Anim_Expand 1s; /* Firefox */
        -moz-animation-fill-mode: both;
        -webkit-animation: WeFimd_Anim_Expand 1s; /* Safari and Chrome */
        -webkit-animation-fill-mode: both;
        -o-animation: WeFimd_Anim_Expand 1s; /* Opera */
        -o-animation-fill-mode: both;
    }

    .WeFind_Div_Contruct{
        overflow: hidden;

        animation-fill-mode: both;
        animation: WeFimd_Anim_Contruct 1s;

        -moz-animation: WeFimd_Anim_Contruct 1s; /* Firefox */
        -moz-animation-fill-mode: both;
        -webkit-animation: WeFimd_Anim_Contruct 1s; /* Safari and Chrome */
        -webkit-animation-fill-mode: both;
        -o-animation: WeFimd_Anim_Contruct 1s; /* Opera */
        -o-animation-fill-mode: both;
    } 
```

HTML 是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>WeFind web site, What is WeFind</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="./CSS/WeFindAnimations.css">
    <link rel="stylesheet" type="text/css" href="./CSS/WeFind.css">

    <script>
        if (navigator.appName == 'Microsoft Internet Explorer') window.location = "./WhatIsIt_IEVer.html";

        function ResetAllElement(ElementName){
            var CurentElement = ElementName.substring(0,1);

            for (var Index = 1; Index < 5; Index++){
                if (Index != CurentElement && document.getElementById(Index + '_DivContent').getAttribute('class').indexOf('WeFind_Div_Expand') > 0){
                    document.getElementById(Index + '_DivContent').setAttribute('class', 'WeFind_Text_Body WeFind_Div_Contruct');
                    document.getElementById(Index + '_DivContentLineExpander').src = "./Images/ArrowDown.png";
                }
            }
        }

        function ToggleExpandContruct(ElementName){
            if (document.getElementById(ElementName).getAttribute('class').indexOf('WeFind_Div_Expand') > 0){
                document.getElementById(ElementName + 'LineExpander').src = "./Images/ArrowDown.png";
                return('WeFind_Text_Body WeFind_Div_Contruct');
            }
            else{
                document.getElementById(ElementName + 'LineExpander').src = "./Images/ArrowUp.png";
                return('WeFind_Text_Body WeFind_Div_Expand');
            }
        }
    </script>
</head>
<body>
    <table class="WeFind_Table_Stretched">
        <tr>
            <td class="WeFind_Table_CellHorizontalSpacer170px">&nbsp;</td>
            <td class="WeFind_Table_Cell_PortrateText">
                <div class="WeFind_Div_PunchLine" onclick="ResetAllElement('0_DivContent');">WeFind, A community obligated to create a safe living environment for all.</div>
                <div id="0_DivContent" class="WeFind_Text_Body WeFind_Div_Contructed" height="0px">
                    &nbsp;
                </div>

                <div class="WeFind_Div_PunchLine" onclick="ResetAllElement('1_DivContent'); document.getElementById('1_DivContent').setAttribute('class', ToggleExpandContruct('1_DivContent'));">
                    The power of "community bond" and "community commitment"
                    <img id="1_DivContentLineExpander" class="WeFind_Img_LineExpander" src="./Images/ArrowDown.png" />
                </div>
                <div id="1_DivContent" class="WeFind_Text_Body WeFind_Div_Contructed" height="0px">
                    The WeFind community utilizes the power of "community bond" and "community commitment" to create a safe living environment for loved ones, the elderly and the challenged, a safe environment for everyone.
                </div>

                <div class="WeFind_Div_PunchLine" onclick="ResetAllElement('2_DivContent'); document.getElementById('2_DivContent').setAttribute('class', ToggleExpandContruct('2_DivContent'));">
                    The power of the masses
                    <img id="2_DivContentLineExpander" class="WeFind_Img_LineExpander" src="./Images/ArrowDown.png" />
                </div>
                <div id="2_DivContent" class="WeFind_Text_Body WeFind_Div_Contructed" height="0px">
                    WeFind uses the power of the masses to create a safety net, continuously alert and ready to provide both passive and active assistance to anyone in need. That net is widely spread and instantaneously available. The ability to be where help is needed fast, and the ability to spread  a "Call For Help", enables the WeFind community to provide immediate aid, prevent harm, providing support effectively and instantaneously.
                </div>

                <div class="WeFind_Div_PunchLine" onclick="ResetAllElement('3_DivContent'); document.getElementById('3_DivContent').setAttribute('class', ToggleExpandContruct('3_DivContent'));">
                    Created by a cheap, wearable location sensitive device.
                    <img id="3_DivContentLineExpander" class="WeFind_Img_LineExpander" src="./Images/ArrowDown.png" />
                </div>
                <div id="3_DivContent" class="WeFind_Text_Body WeFind_Div_Contructed" height="0px">
                    The WeFind community safety net is created by a cheap, wearable location sensitive device and a mobile phone application. That device is attached to a kid, an elderly person, a challenged child or just anyone you. The device is sending location and status information to the WeFind community datacenter. Based on that location the community is able to receive alerts, when the one wearing the device needs assistance or is lost, and display messages which enable the community to monitor the whereabouts of that someone.
                </div>

                <div class="WeFind_Div_PunchLine" onclick="ResetAllElement('4_DivContent'); document.getElementById('4_DivContent').setAttribute('class', ToggleExpandContruct('4_DivContent'));">
                    There is no safety witout privacy !
                    <img id="4_DivContentLineExpander" class="WeFind_Img_LineExpander" src="./Images/ArrowDown.png" />
                </div>
                <div id="4_DivContent" class="WeFind_Text_Body WeFind_Div_Contructed" height="0px">
                    Data regarding each device is distributed based on the relations between the one wearing the device and the one receiving the information. Close relatives (Father, Mother, etc.' ...) receive detailed information while other people are filtered out. <span class="WeFind_Text_Body WeFind_Text_BodyUnderlined">Privacy is a key element in the WeFind community</span>; it is one of <span class="WeFind_Text_Body WeFind_Text_BodyUnderlined">the main building blocks of maintaining a safe environment</span>.
                </div>

                <p class="WeFind_Text_Body">
                    <center><img src="./Images/WeFind_CommunityHelp.png" width="600px"/><center>
                </p>
            </td>
        </tr>
    </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T23:24:01.877

看起来你有很多代码来实现最终结果。您可能想查看 jQuery 的滑动切换功能。[http://api.jquery.com/slideToggle/](http://api.jquery.com/slideToggle/)这应该消除对所有 css 动画和您拥有的 javascript 的需要。

在 jQuery 中，您可以执行以下操作：

```
$('h3').click(function(){
    $('p').slideToggle();
}); 
```

在这里，您单击标题并显示 p。

如果您继续使用 CSS，则不需要动画，只需要简单的过渡，您可以打开和关闭一个类来为高度设置动画。W3 Schools 有一个演示，我认为这会有所帮助。[http://www.w3schools.com/css3/css3_transitions.asp](http://www.w3schools.com/css3/css3_transitions.asp)

这是一个使用 jQuery 和 slideToggle 的简单小提琴。[http://jsfiddle.net/markgtoce/HTyXm/](http://jsfiddle.net/markgtoce/HTyXm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T00:10:54.403

好吧，我设法解决了这个问题。

问题的原因是包含“div”的“表”的 CSS 部分。

该表有一个类：

```
.WeFind_Table_Stretched{
    height: 100%;
    width: 100%;
} 
```

height : 100% 导致 Chrome 出现问题。恕我直言 Chrome 中的一个错误，但我没有设法得到谷歌的回应。

我删除了高度 100% 部分，整个事情就像一个魅力。

埃雷兹

# sqlalchemy - Flask + WTForms：更新一行

> ID：15588845
> 
> 赞同：0
> 
> 时间：2013-03-23T15:58:35.183
> 
> 标签：sqlalchemy, flask, wtforms

我尝试更新数据库中的现有行。当我提交表单时，我被定向到触发 404 的 /item/edit/。我在不同的项目中有类似的代码并且可以正常工作。我不知道这有什么问题。

```
@main.route('/item/edit/<string:url>', methods = ['GET', 'POST'])
@login_required
def edit_item(url):
  i = get_item_by_url(url)
  form = ItemForm(obj=i)
  if form.validate_on_submit():
    i.title = form.title.data
    i.url = form.url.data
    i.body = form.body.data
    i.email = form.email.data
    i.private = form.private.data
    file = request.files['itempic']
    if file and allowed_file(file.filename):
      filename = secure_filename(file.filename)
      file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))
      i.itempic = filename
    db.session.add(i)
    db.session.commit()
    flash('The Item: %s, has been updated succesfully.' % form.url.data)
    return redirect(url_for("index"))
  return render_template('/item/edit.html',
    form = form,
    i = i) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:11:30.320

问题是您的方法被映射到`/item/edit/something-here`并将`something-here`被映射到`url`变量。

当您请求`/item/edit/`它时，它不会映射到任何东西，所以它会引发 404。

# plot - Matlab 的 gamultiobj 绘图

> ID：15588850
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:59:07.420
> 
> 标签：plot, genetic-algorithm, matlab

在 matlab 的多目标遗传算法 GUI 中，有一个用于绘制帕累托前沿的选项，但该图仅为 2D；因为我要最小化三个目标函数，所以我需要一个 3D 图。有没有办法将 2D 绘图强制为 3D，或者我必须使用自定义函数进行绘图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T11:42:10.813

好吧，我的错；情节实际上是 3D 情节，但情节最初以看似 2D 的形式出现，因为它是旋转的。要查看 3D 绘图，只需单击“旋转”工具栏按钮，然后单击并稍微拖动绘图，以使 3 个轴可见。

# android - 带有客户端证书的android webview

> ID：15588851
> 
> 赞同：22
> 
> 时间：2013-03-23T15:59:19.100
> 
> 标签：android, ssl, webview, client, certificate

我尝试了几天使用嵌入应用程序的客户端证书的 Web 视图，但在我看来，android sdk 没有提供任何方法，是否有回调来拦截服务器发送的质询？有没有办法将 webview 与客户端证书一起使用并发出 https 请求？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-23T17:45:26.273

由于我也对您的问题感兴趣，因此我检查了 WebView 和 WebViewClient 的文档，四处浏览，确实看起来您无法使用客户端证书对 webview 会话进行身份验证，因为所需的方法 (ClientCertRequestHandler) 不是公共 API。

[使用 Android WebView 通过客户端证书连接到安全服务器](https://stackoverflow.com/questions/12807742/using-a-android-webview-to-connect-to-secure-server-with-client-certificate)

在 Android 安全讨论中的搜索确认该调用确实不可用：

[https://groups.google.com/forum/#!msg/android-security-discuss/0hzTGaA9swQ/1Oqc8UpGLH8J](https://groups.google.com/forum/#!msg/android-security-discuss/0hzTGaA9swQ/1Oqc8UpGLH8J)

即使

> Android 4.0 版本确实支持浏览器中的客户端证书身份验证。

（参考：[https](https://code.google.com/p/android/issues/detail?id=8196) ://code.google.com/p/android/issues/detail?id=8196 ）

没有提及 WebViews :(

即使有一些新的 API 可以在钥匙串中加载证书：

[http://developer.android.com/reference/android/security/KeyChain.html](http://developer.android.com/reference/android/security/KeyChain.html) [http://nelenkov.blogspot.it/2011/11/using-ics-keychain-api.html](http://nelenkov.blogspot.it/2011/11/using-ics-keychain-api.html)

目前尚不清楚 WebView 是否会使用它们......所以我想你应该尝试 KeyChain 类，看看你是否可以正确验证（我没有简单的方法来测试这个，所以你自己）。

*如果 KeyChain 不适用于 WebViews*，我想这一切都归结为几个远非完美的解决方法：

**解决方案1：**

无论如何使用 ClientCertRequestHandler （它被标记为隐藏，但显然仍然可用）：

[https://code.google.com/p/android/issues/detail?id=53491](https://code.google.com/p/android/issues/detail?id=53491)

但是，即使假设您成功了，Android Dev。团队可能会修改/删除该方法，恕不另行通知，并且您的应用程序可能会停止在 SO 的未来版本上运行。

**解决方案2：**

如果您可以将目标限制为 Android 4.0 或更高版本，一个大胆（并且不太可能......）的解决方案是尝试使用文件方案从本地存储中加载 web 视图中的证书：

[将本地 HTML 文件加载到 WebView](https://stackoverflow.com/questions/5749569/load-local-html-file-into-webview)

但我强烈怀疑 webview 会像浏览器一样运行......

**解决方案3：（**应该可以，但需要很多努力）

使用 HTTPClient 或 HttpURLConnection 在后台处理每个 https 连接，然后将数据传递给 WebView：

[http://chariotsolutions.com/blog/post/https-with-client-certificates-on/](http://chariotsolutions.com/blog/post/https-with-client-certificates-on/)

你有我的同情。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-03-11T08:26:52.960

在 API 21 (Android Lollipop) 和更高版本中，您可以覆盖**WebViewClient.onReceivedClientCertRequest(WebView view, ClientCertRequest request)**。在该方法中，使用您的密钥管理器获取私钥和​​证书链并调用**request.proceed()**。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-04T20:31:49.073

如果您只需要忽略 Web 视图中的 ssl 证书请求，这在 Lollipop 上对我有用：

在您的 Web 视图客户端中，覆盖：

```
@Override
public void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {
    handler.proceed(); // Ignore SSL certificate errors
} 
```

这对于针对 qa/dev/stage 环境调试 webview 很有用。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-07-15T06:34:05.980

为了根据更新的安全政策正确处理 SSL 证书验证以防止应用程序被 Google play 拒绝，请更改您的代码以在服务器提供的证书符合您的期望时调用 SslErrorHandler.proceed()，否则调用 SslErrorHandler.cancel()。

例如，我添加了一个警告对话框以使用户已确认并且似乎 Google 不再显示警告。

```
 @Override
    public void onReceivedSslError(WebView view, final SslErrorHandler handler, SslError error) {
    final AlertDialog.Builder builder = new AlertDialog.Builder(this);
    String message = "SSL Certificate error.";
        switch (error.getPrimaryError()) {
            case SslError.SSL_UNTRUSTED:
                message = "The certificate authority is not trusted.";
                break;
            case SslError.SSL_EXPIRED:
                message = "The certificate has expired.";
                break;
            case SslError.SSL_IDMISMATCH:
                message = "The certificate Hostname mismatch.";
                break;
            case SslError.SSL_NOTYETVALID:
                message = "The certificate is not yet valid.";
                break;
        }
        message += " Do you want to continue anyway?";

        builder.setTitle("SSL Certificate Error");
        builder.setMessage(message);
    builder.setPositiveButton("continue", new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            handler.proceed();
        }
    });
    builder.setNegativeButton("cancel", new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            handler.cancel();
        }
    });
    final AlertDialog dialog = builder.create();
    dialog.show();
} 
```

在此更改后，它将不会显示警告。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-16T17:47:59.753

Android 4.4 上基于 Chronium 的 WebView 引入了一个 bug：当服务器请求客户端证书时，WebView 停止加载过程。onPageFinished *-Method*将立即被调用，但不显示任何页面。

--> [https://code.google.com/p/android/issues/detail?id=62533](https://code.google.com/p/android/issues/detail?id=62533)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-18T12:47:50.243

我们无法在 webview 中访问客户端证书，同样存在一个 google 问题。 [https://code.google.com/p/android/issues/detail?id=53491](https://code.google.com/p/android/issues/detail?id=53491)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-26T00:56:21.227

自 API 21 起，onReceivedClientCertRequest() 已添加到 WebViewClient。 [https://developer.android.com/reference/android/webkit/WebViewClient#onReceivedClientCertRequest(android.webkit.WebView,%20android.webkit.ClientCertRequest)](https://developer.android.com/reference/android/webkit/WebViewClient#onReceivedClientCertRequest(android.webkit.WebView,%20android.webkit.ClientCertRequest))

以下 Stackoverflow 帖子中的解决方案对我有用： [Android WebView handle onReceivedClientCertRequest](https://stackoverflow.com/questions/35135225/android-webview-handle-onreceivedclientcertrequest)

去测试：

*   服务器网址：[https ://client.badssl.com/](https://client.badssl.com/)
*   客户端证书：[https ://badssl.com/download/](https://badssl.com/download/)

未设置客户端证书时，您将看到“400 bad request”。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-02-27T09:55:22.480

自签名 SSL 证书对我有用

请检查此答案[https://stackoverflow.com/a/49003522/5058630](https://stackoverflow.com/a/49003522/5058630)

# z3 - 来自未饱和核心轨道的 SMT-LIB v2 格式的命名术语列表

> ID：15588854
> 
> 赞同：-1
> 
> 时间：2013-03-23T15:59:28.817
> 
> 标签：z3

如何使用z3 api记录或打印出带有“a_uc_1”等名称列表的术语和名称列表的*数量*？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:37:51.603

不幸的是，没有 API 可以做你想做的事。此信息在内部可用，但未在 API 中公开。更改 Z3 代码以提取此信息并不难。在内部，以下函数用于解析 SMT-LIB v2 文件。

```
bool parse_smt2_commands(cmd_context & ctx, 
                         std::istream & is, 
                         bool interactive = false, 
                         params_ref const & p = params_ref()); 
```

它在文件中定义`src/parsers/smt2/smt2parser.h`。

对象在`cmd_context`object 中定义`src/cmd_context/cmd_context.h`。

它有以下方法：

```
ptr_vector<expr>::const_iterator begin_assertion_names() const;
ptr_vector<expr>::const_iterator end_assertion_names() const; 
```

这两种方法可用于遍历 SMT-LIB v2 文件中用于命名断言的所有名称。每个名称在内部都表示为布尔变量。如果`ctx`是`cmd_context`，我们可以使用以下方法遍历所有名称：

```
ptr_vector<expr>::const_iterator it = ctx.begin_assertion_names();
for (; it != ctx.end_assertion_names(); it++) {
   expr * n = *it;
   // do something
   // here, we just print the name
   std::cout << to_app(n)->get_decl()->get_name() << "\n";
} 
```

# django - 如何处理生产服务器中的django模板不存在错误？

> ID：15588856
> 
> 赞同：0
> 
> 时间：2013-03-23T15:59:34.060
> 
> 标签：django, heroku, django-templates

我刚刚第一次将我的应用程序部署到heroku，但是当我尝试浏览时，我得到了一个`TemplateDoesNotExist` 和困扰我的东西，当我做一个`python manage.py runserver`. 我环顾四周，看到了一些类似的问题，但这些人从未解释过他们是如何解决问题的。

```
Template Loader Error:
Django tried loading these templates, in this order:
Using loader django.template.loaders.filesystem.Loader:
/templates/public/homepage.html (File does not exist)

Traceback:
File "/app/.heroku/python/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/app/f4l/live/views.py" in homepage
  156\.  return render_to_response('public/homepage.html',context,context_instance=RequestContext(request))
File "/app/.heroku/python/lib/python2.7/site-packages/django/shortcuts/__init__.py" in render_to_response
  20\.     return HttpResponse(loader.render_to_string(*args, **kwargs), **httpresponse_kwargs)
File "/app/.heroku/python/lib/python2.7/site-packages/django/template/loader.py" in render_to_string
  169\.         t = get_template(template_name)
File "/app/.heroku/python/lib/python2.7/site-packages/django/template/loader.py" in get_template
  145\.     template, origin = find_template(template_name)
File "/app/.heroku/python/lib/python2.7/site-packages/django/template/loader.py" in find_template
  138\.     raise TemplateDoesNotExist(name)

Exception Type: TemplateDoesNotExist at /
Exception Value: public/homepage.html 
```

在我的 settings.py

```
PROJECT_ROOT = os.path.join(os.path.dirname(__file__),'..')
SITE_ROOT = PROJECT_ROOT

#FIXTURE_DIRS = (os.path.join(PROJECT_DIR,  '../fixtures'),)
TEMPLATE_DIRS = (os.path.join(PROJECT_ROOT, '../templates'),)
STATICFILES_DIRS = (os.path.join(PROJECT_ROOT, '../static'), os.path.join(PROJECT_ROOT, '../media'), )
STATIC_ROOT = os.path.join(PROJECT_ROOT, '../sitestatic')
MEDIA_ROOT = os.path.join(PROJECT_ROOT, '../media')
MEDIA_URL = "/media/"
STATIC_URL = "/static/" 
```

欢迎任何阅读的答案和建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:39:24.030

确保您已遵循[文档](https://docs.djangoproject.com/en/dev/howto/static-files/)中的指南。正如 TimD 所指出的，您的静态和模板目录是不寻常的。我更喜欢类似于 DeployDjango.com（[在此处找到](http://www.deploydjango.com/django_project_structure/index.html)）推荐的结构，其中每个应用程序都有自己的静态和模板文件的目录。就像是：

```
|--project_root
   |--apps
      |--my_app
         |--static
         |--templates
   |--manage.py
... 
```

`collectstatic`根据文档，这样命令将自动找到它们：

```
Put your static files somewhere that staticfiles will find them.
By default, this means within static/ subdirectories of apps in your
INSTALLED_APPS. 
```

还要按照他们关于静态文件[的简要指南](https://devcenter.heroku.com/articles/django-assets)检查您是否`collectstatic`在 Heroku 上正确运行。

# html - 文本不在溢出中换行：自动；宽度：100% div 当它在表格内时

> ID：15588859
> 
> 赞同：0
> 
> 时间：2013-03-23T15:59:45.667
> 
> 标签：html, css

我最近遇到了一个奇怪的问题，即表格单元格内的溢出自动 div（是的，我必须保留表格）。

div 内的文本在表格内时不会换行。如果我将 div 放在另一个 div 中进行包装，则效果很好。

我的临时解决方案是使用 javascript 来强制宽度，但这很差，并且不能很好地调整大小。

如果有人有任何想法，我很乐意听到。

请参阅此处的代码：

[http://jsfiddle.net/jNZNF/](http://jsfiddle.net/jNZNF/)

```
<table style="width: 400px;" border="1">
<tr><td>
<div style="width: 100%; overflow: auto; height: 200px; border: 1px solid blue;">
ip\84.23.214.125:27960\name\Ze_Pequeno\password\bs\racered\1\raceblue\0\rate\25000\ut_timenudge\30\cg_rgb\153,0,0\funred\tridente\funblue\katana\cg_predictitems\0\cg_physics\1\gear\FHAOWRA\snaps\20\model\sarge\headmodel\sarge\team_model\james\team_headmodel\*james\color1\4\color2\5\handicap\100\sex\male\cl_anonymous\0\teamtask\0\cl_guid\49B4985AFD5E18C17EAC67AF5A6F4247\weapmodes\00000111220000020000
</div>
</td></tr></table> 

<div style="width: 400px; border:1px solid pink">
<div style="width: 100%; overflow: auto; height: 200px; border: 1px solid blue">
ip\84.23.214.125:27960\name\Ze_Pequeno\password\bs\racered\1\raceblue\0\rate\25000\ut_timenudge\30\cg_rgb\153,0,0\funred\tridente\funblue\katana\cg_predictitems\0\cg_physics\1\gear\FHAOWRA\snaps\20\model\sarge\headmodel\sarge\team_model\james\team_headmodel\*james\color1\4\color2\5\handicap\100\sex\mal e\cl_anonymous\0\teamtask\0\cl_guid\49B4985AFD5E18C17EAC67AF5A6F4247\weapmodes\00000111220000020000
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:06:25.060

将`word-break:break-all`规则添加到您的表（或表中的 div）。由于您基本上有一个长字符串（没有空格），除非您强制它，否则浏览器不会破坏它。

**[jsFiddle 示例](http://jsfiddle.net/jNZNF/4/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:07:37.070

除非我误解了你，否则应该这样做：

```
<table style="width: 400px;" border="1">
<tr><td>
<div style="width: 100%; overflow: auto; height: 200px; border: 1px solid blue;">
ip\84.23.214.125:27960\name\Ze_Pequeno\password\bs\racered\1\raceblue\0\rate\25000\ut_timenudge\30\cg_rgb\153,0,0\funred\tridente\funblue\katana\cg_predictitems\0\cg_physics\1\gear\FHAOWRA\snaps\20\model\sarge\headmodel\sarge\team_model\james\team_headmodel\*james\color1\4\color2\5\handicap\100\sex\male\cl_anonymous\0\teamtask\0\cl_guid\49B4985AFD5E18C17EAC67AF5A6F4247\weapmodes\00000111220000020000
</div>
</td></tr></table> 
```

小提琴：http: [//jsfiddle.net/ayAh7/1/](http://jsfiddle.net/ayAh7/1/)

```
<div style="width: 400px; border:1px solid pink">
<div style="width: 100%; overflow: auto; height: 200px; border: 1px solid blue">
ip\84.23.214.125:27960\name\Ze_Pequeno\password\bs\racered\1\raceblue\0\rate\25000\ut_timenudge\30\cg_rgb\153,0,0\funred\tridente\funblue\katana\cg_predictitems\0\cg_physics\1\gear\FHAOWRA\snaps\20\model\sarge\headmodel\sarge\team_model\james\team_headmodel\*james\color1\4\color2\5\handicap\100\sex\mal e\cl_anonymous\0\teamtask\0\cl_guid\49B4985AFD5E18C17EAC67AF5A6F4247\weapmodes\00000111220000020000
</div>
</div> 
```

# opengl - 眼睛空间坐标到底是什么？

> ID：15588860
> 
> 赞同：32
> 
> 时间：2013-03-23T15:59:45.883
> 
> 标签：opengl, matrix, camera, coordinates, projection

在学习 OpenGL 时，我经常偶然发现所谓的眼睛空间坐标。

如果我是对的，你通常有三个矩阵。模型矩阵、视图矩阵和投影矩阵。虽然我不完全确定其背后的数学原理是如何工作的，但我确实知道将坐标转换为世界空间、视图空间和屏幕空间。

但是眼睛空间在哪里，我需要哪些矩阵来将某些东西转换为眼睛空间？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-03-23T21:36:52.910

也许下图显示了各种空间之间的关系会有所帮助：![OpenGL 转换管道](../Images/25d4efefdb5f91bd277f727d01fb3be0.png)

取决于您是使用固定功能管道（`glMatrixMode()`例如，如果您调用 ），还是使用着色器，操作是相同的 - 只是您是直接在着色器中编码，还是使用 OpenGL 管道辅助在你的工作中。

虽然讨论固定功能管道方面的事情令人厌恶，但它使对话变得更简单，所以我将从那里开始。

在旧版 OpenGL（即 OpenGL 3.1 之前的版本，或使用兼容性配置文件）中，定义了两个矩阵堆栈：*model-view*和*projection*，当应用程序启动时，每个堆栈顶部的矩阵是一个单位矩阵（1.0 on对角线，所有其他元素为 0.0）。如果在该空间中绘制坐标，则实际上是在*标准化设备坐标*(NDC) 中进行渲染，这会在 X、Y 和 Z 中裁剪掉范围 [-1,1] 之外的任何顶点。*视口变换*（如通过调用设置`glViewport()`）是将 NDC 映射到窗口坐标（实际上，视口坐标，但大多数情况下视口和窗口的大小和位置相同），以及深度值到*深度范围*（默认为 [0,1]）。

现在，在大多数应用程序中，指定的第一个变换是*投影变换*，它有两种：正交投影和透视投影。*正交*投影保留角度，通常用于科学和工程应用，因为它不会扭曲线段的相对长度。在旧版 OpenGL 中，正交投影由`glOrtho`或指定`gluOrtho2D`。更常用的是*透视变换*，它模仿眼睛的工作方式（即，远离眼睛的物体比靠近眼睛的物体小），由`glFrustum`或指定`gluPerspective`。对于透视投影，他们定义了一个*视锥体*，这是一个截断的金字塔，锚定在眼睛的位置，在*眼睛坐标*中指定。在眼睛坐标中，“眼睛”位于原点，向下看 -Z 轴。您的*近*剪裁平面和*远剪裁平面*被指定为沿 -Z 轴的**距离。**如果在眼睛坐标中渲染，则在近剪裁平面和远剪裁平面之间以及视锥体内部指定的任何几何图形都不会被剔除，而是会被转换以显示在视口中。这是透视投影的示意图，以及它与图像平面的关系![查看平截头体](../Images/d84068988a73356cf90f46f245a8b1cd.png)。

眼睛位于视锥体的顶点。

最后要讨论的转换是*模型视图*转换，它负责移动坐标系（而不是对象；稍后会详细介绍），以使它们相对于眼睛和视锥体处于良好的位置。常见的建模变换是*平移*、*缩放*、*旋转*和*剪切*（OpenGL 中没有原生支持）。

一般而言，3D 模型是围绕局部坐标系建模的（例如，指定以原点为中心的球体坐标）。建模变换用于将“当前”坐标系移动到新位置，以便在渲染本地建模对象时，它位于正确的位置。

建模变换和视图变换之间没有数学上的区别。只是通常，建模转换用于特定模型，并由操作控制`glPushMatrix()`，`glPopMatrix()`通常首先指定查看转换，并影响所有后续建模操作。

现在，如果您正在执行此现代 OpenGL（核心配置文件版本 3.1 及更高版本），您必须自己逻辑地执行所有这些操作（您可能只指定一个转换，将模型视图和投影转换折叠为单个矩阵乘法） . 矩阵通常指定为 shader `uniforms`。没有矩阵堆栈、模型视图和投影转换的分离，您需要正确计算才能模拟管道。（顺便说一句，*透视分割*和视口变换步骤由 OpenGL 在完成顶点着色器后执行 - 你不需要做数学运算 [你可以，除非你没有将**w**设置为 1.0你的`gl_Position`顶点着色器输出）。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-03-23T16:05:28.180

眼睛空间、视图空间和相机空间都是同一事物的同义词：相对于相机的世界。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-01T05:32:54.783

在一次渲染中，场景的每个网格通常由模型矩阵、视图矩阵和投影矩阵进行变换。最后将投影场景映射到视口。

投影、视图和模型矩阵相互作用，以在视口上呈现场景的对象（网格）。

*   模型矩阵定义了场景世界空间中单个对象（网格）的位置方向和比例。
*   视图矩阵定义了观察者（观察者）在场景中的位置和观察方向。
*   投影矩阵定义了投影到视口上的观察者（观察者）的面积（体积）。

坐标系：

*   模型坐标（对象坐标）

    模型空间是坐标系，用于定义或调制网格。顶点坐标在模型空间中定义。

*   世界坐标

    世界空间是场景的坐标系。不同的模型（对象）可以在世界空间中多次放置，形成一个场景，放在一起。

    模型矩阵定义了场景中模型（对象、网格）的位置、方向和相对大小。模型矩阵将单个网格的顶点位置转换为单个特定定位的世界空间。有不同的模型矩阵，每个组合一个模型（对象）和对象在世界空间中的位置。

*   视空间（眼坐标）

    视图空间是由场景中的视点定义的局部系统。视图的位置、视线和视图的向上方向，定义了一个相对于世界坐标系的坐标系。场景的对象必须相对于视图坐标系进行绘制，才能从观察位置“看到”。视图坐标系的逆矩阵称为**视图矩阵**。该矩阵从世界坐标转换为视图坐标。
    一般世界坐标和视图坐标都是[笛卡尔坐标](https://en.wikipedia.org/wiki/Cartesian_coordinate_system)

    视图坐标系统描述了观察场景的方向和位置。视图矩阵从世界空间转换到视图（眼睛）空间。

    如果视图空间的坐标系是[右手](https://en.wikipedia.org/wiki/Right-hand_rule)系，其中 X 轴指向右侧，Y 轴指向上方，则 Z 轴指向视图外（注意在右手系中Z 轴是 X 轴和 Y 轴的叉积）。

[![](../Images/04c969aed6d58f532c9cfac02e997a2c.png)](https://i.stack.imgur.com/J9w6f.png)

*   剪辑空间坐标是[齐次坐标](https://en.wikipedia.org/wiki/Homogeneous_coordinates)。在剪辑空间中执行场景的剪辑。
    如果`x`,`y`和`z`分量在由反转`w`分量和`w`点齐次坐标分量定义的范围内，则点在裁剪空间中：

    `-w <= x, y, z <= w.`

    投影矩阵描述了从场景的 3D 点到视口的 2D 点的映射。投影矩阵从视图空间转换到剪辑空间。通过除以`w`剪辑坐标的分量，剪辑空间中的坐标被转换为 (-1, -1, -1) 到 (1, 1, 1) 范围内的标准化设备坐标 (NDC)。

    在正交投影中，这个区域（体积）由到观察者位置的 6 个距离（左、右、下、上、近和远）定义。如果左、下、近距离为负，右、上、远距离为正（如在标准化设备空间中），这可以想象为观察者周围的盒子。空间（体积）中的所有对象（网格）在视口上都是“可见的”。超出（或部分超出）该空间的所有对象（网格）都在体积的边界处被剪裁。这意味着在正交投影中，观察者“后面”的对象可能是“可见的”。这可能看起来不自然，但这就是正交投影的工作原理。

    在透视投影中，观察体是一个[平截头体](https://en.wikipedia.org/wiki/Viewing_frustum)（截棱锥），其中金字塔的顶部是观察位置。观察方向（视线）以及近距和远距定义了将金字塔截断为平截头体的平面（观察方向是该平面的法线向量）。左、右、下、上距离定义了从视线和近平面的交点到平截头体侧面（在近平面上）的距离。这导致场景看起来像从针孔相机看到的那样。

    [![](../Images/41928ff1c056fdf183ec68faa2e50464.png)](https://i.stack.imgur.com/jETl9.gif)

    当对象在视口上不可见（屏幕全是“黑色”）时，最常见的错误之一是网格不在由投影和视图矩阵定义的视图体积内。

*   标准化设备坐标

    标准化的设备空间是一个立方体，右、下、前在 (-1, -1, -1) 和左、上、后在 (1, 1, 1)。标准化的设备坐标是剪辑空间坐标除以`w`剪辑坐标的分量。这称为[透视划分](https://www.khronos.org/opengl/wiki/Vertex_Post-Processing#Perspective_divide)

    [![](../Images/b706f38cbe054d219c19f4bf3519e89a.png)](https://i.stack.imgur.com/iqFzD.png)

*   窗口坐标（屏幕坐标）

    窗口坐标是视口矩形的坐标。窗口坐标对于[光栅化](https://www.khronos.org/opengl/wiki/Rendering_Pipeline_Overview#Rasterization)过程是决定性的。

    标准化的设备坐标线性映射到视口矩形（窗口坐标/屏幕坐标）和深度缓冲区的深度。视口矩形由 定义[`glViewport`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glViewport.xhtml)。深度范围[`glDepthRange`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glDepthRange.xhtml)由默认设置为 [0, 1]。

# php - 带有ajax的HTML页面，似乎无法实现RGraph

> ID：15588868
> 
> 赞同：0
> 
> 时间：2013-03-23T16:00:42.530
> 
> 标签：php, html, ajax, rgraph

我正在构建一个带有静态页眉和页脚的基本网页。在左侧，我有一个菜单。当我按下菜单按钮时，会发出一个 ajax 请求，并在右侧 DIV 上更新我的文本。

menu01 - menu01.php 包含带有一些 Mysql 结果的 php 代码，这很好用。我认为这很好用，因为它都是文本输出。

menu02 - Menu02.php 包含显示 RGraph 的 html 代码，一些文本在右侧 DIV 中显示正常，但图形不显示。当我直接调用此文件时，menu02.php 文件显示正常。

我发现，来自 php 文件的 RGraph 输出不是可用于更新页面右侧 DIV 的 xml 数据。ajax 只怀疑接收一些文本，对吧？所以我必须找到另一种方法来动态更新我的页面并在正确的 DIV 上显示不同类型的东西，而无需重新加载我的整个页面。有了这些信息，我想我知道为什么它不起作用，但我不知道如何获得我正在寻找的结果。有人知道在哪里寻找吗？

代码片段：

索引.html：

```
 <script src="./js/ajax.js"></script>

 <section id="sidebar">
     <nav>
      <ul>
        <li>  <button onclick="goto_menu1()">Menu 1</button> </li>
        <li>  <button onclick="goto_menu2()">Menu 2</button> </li>
      </ul>
     </nav>
 </section> 
```

ajax.js：

```
 function goto_menu1()
    {
      var xmlHttp = getXMLHttp();
      xmlHttp.onreadystatechange = function()
      {
        if(xmlHttp.readyState == 4)
        {
          HandleResponse(xmlHttp.responseText);
        }
      }
      xmlHttp.open("GET", "./menu01/menu01.php", true);
      xmlHttp.send(null);
    }

 function goto_menu2()
    {
      var xmlHttp = getXMLHttp();
      xmlHttp.onreadystatechange = function()
      {
        if(xmlHttp.readyState == 4)
        {
          HandleResponse(xmlHttp.responseText);
        }
      }
      xmlHttp.open("GET", "./menu02/menu02.php", true);
      xmlHttp.send(null);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T01:18:30.847

最后就是在正确的页面上加载正确的js。并为 rgraph 调用正确的 jquery 代码。

由于我对将 RGraph（或其他 js 模块）加载到动态创建的 div 中存在疑问，我现在已经让它工作了。如何？

```
index.html :
load js rgraph module
call a js function for updating div

js function:
open a php page, generate data and set up the html layout
next, check-document-ready, run jquery rgraph call 
```

我希望它给那些有相同搜索的人一些希望:)

# css - 动画迭代延迟 CSS3

> ID：15588877
> 
> 赞同：1
> 
> 时间：2013-03-23T16:01:47.117
> 
> 标签：css, animation

有没有办法在每次迭代之间添加延迟？

EX：我想添加2s的第一个延迟和10s的交互延迟

这是一些代码：

代码：

```
/* PROCESSAR AQUI! */
/*...*/

/* KEYFRAMES */

@-webkit-keyframes transitdescription {
    15%     { margin-left: 45px;}
}

@-webkit-keyframes transitimage {
    0%      { right: -100%;}
    10%     { right: -webkit-calc(93% - 350px);}
    25%    { right: -webkit-calc(90% - 350px);}
    90%    { right: -webkit-calc(90% - 350px);}
    100%    { right: -webkit-calc(200%);}
}

@-webkit-keyframes rotateimg {
    50%  {-webkit-transform: rotate(-10deg);}
}

@-webkit-keyframes pluswidth {
    50%  {  width: 450px;}
}

@-webkit-keyframes leaveimage {
    50%  {  width: 450px;}
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-06T11:37:03.390

没有这样的属性，尽管[有人建议过](http://lists.w3.org/Archives/Public/www-style/2011May/0549.html)。

有解决方法：

```
@-webkit-keyframes transitimage {
    /* animation here */
    10%, 100% { /* wait for 10 seconds without doing anything */ }
} 
```

这远非理想。
您可以查看此[相关问题](https://stackoverflow.com/questions/13887889/css-animation-delay-in-repeating)以了解其他解决方法。

# ios - TableView 问题中的图像

> ID：15588889
> 
> 赞同：0
> 
> 时间：2013-03-23T16:03:05.707
> 
> 标签：ios, objective-c, cocoa-touch, uitableview, sdwebimage

我使用 SDWebImage 从解析的 XML 文件中下载图片，并将其显示在 TableView 中。但问题是某些图像未显示。这是它的样子：

![在此处输入图像描述](../Images/c5a5c1d6a9ee76e28f3af869cdb8224b.png)

这是我解析第一张图像并将其显示在 TableView 单元格中的代码：

```
// Parse out Image URL for cell
NSError *error = NULL;
NSRegularExpression *regexImage = [NSRegularExpression regularExpressionWithPattern:@"(<img\\s[\\s\\S]*?src\\s*?=\\s*?['\"](.*?)['\"][\\s\\S]*?>)+?"
                                                                       options:NSRegularExpressionCaseInsensitive
                                                                        error:&error];

[regexImage enumerateMatchesInString:item.content
                        options:0
                          range:NSMakeRange(0, [item.content length])
                     usingBlock:^(NSTextCheckingResult *result, NSMatchingFlags flags, BOOL *stop) {

                         NSString *src = [item.content substringWithRange:[result rangeAtIndex:2]];
                         NSLog(@"img src: %@", src);

                         [cell.imageView setImageWithURL:[NSURL URLWithString:src] placeholderImage:[UIImage imageNamed:@"Placeholder.png"]];
                     }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:19:20.880

> «有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。» [[来源]](http://regex.info/blog/2006-09-15/247)

我认为您的正则表达式不准备处理德语变音符号，因为它包含在

```
http://www.floorballmagazin.de/wp-content/uploads/2013/03/Floorfighters-döbeln.jpg 
```

很难（[如果不是不可能](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)的话）编写一个正则表达式，它可以正确处理 html 或只是它的片段。

如果我是你，我不会走那条路。你要么应该使用 html 解析器来解析它，要么——在这种情况下我更喜欢——使用 NSScanner。

* * *

这是如何使用 NSScanner 的示例：

```
 NSArray *imgtags = @[@"<p>sdf </p><img alt=\"\" src=\"http://www.floorballmagazin.de/wp-content/uploads/2013/03/Floorfighters-döbeln.jpg\" /> ",
                    @"<img src=\"http://www.floorballmagazin.de/wp-content/uploads/2012/01/20121501_nilsson_etv_as.jpg\" alt=\"Hat&#039;s nicht so mit blauem Dunst - Johan Nilsson.  / Foto: Andreas Schulz\" width=\"595\" height=\"384\" class=\"size-full wp-image-11542 colorbox-16600\" />"];    

[imgtags enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSScanner *scanner = [NSScanner scannerWithString:obj];
    [scanner scanUpToString:@"<img" intoString:NULL];
    [scanner scanUpToString:@"src" intoString:NULL];
    [scanner scanUpToString:@"=" intoString:NULL];
    [scanner scanUpToString:@"\"" intoString:NULL];
    [scanner setScanLocation:[scanner scanLocation]+1];
    NSString *s;
    [scanner scanUpToString:@"\"" intoString:&s];

    s = [s stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@" "]];
    NSLog(@"%@", s);
}]; 
```

结果：

```
http://www.floorballmagazin.de/wp-content/uploads/2013/03/Floorfighters-döbeln.jpg
http://www.floorballmagazin.de/wp-content/uploads/2012/01/20121501_nilsson_etv_as.jpg 
```

# java - 在 Android 中执行 Paypal 付款时出错

> ID：15588891
> 
> 赞同：1
> 
> 时间：2013-03-23T16:03:11.230
> 
> 标签：java, android, paypal

我正在尝试在我的应用程序中执行“使用 PayPal 付款”按钮。

这是我单击此按钮时的代码：

```
class PaypalTask extends AsyncTask<Void, Void, Void> {
        protected final char[] TOTAL_GBP=null;

        public Void doInBackground(Void... arg0) {
            ppObject = PayPal.initWithAppID(getBaseContext(), "APP-80W284485P519543T", PayPal.ENV_SANDBOX);

            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            super.onPostExecute(result);
            btnPaypal = ppObject.getCheckoutButton(getApplicationContext(), PayPal.BUTTON_278x43, CheckoutButton.TEXT_PAY);
            RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
            params.addRule(RelativeLayout.CENTER_HORIZONTAL);
            params.addRule(RelativeLayout.CENTER_VERTICAL);
            btnPaypal.setLayoutParams(params);
            rlPay.addView(btnPaypal);
            if(utils.prefs.getBoolean("isLogged", false)) btnPaypal.setVisibility(View.VISIBLE); else btnPaypal.setVisibility(View.GONE);

            btnPaypal.setOnClickListener(new OnClickListener(){
                public void onClick(View view) {

                    // to check whether there are any books in the shopping cart
                    if(!cid.isEmpty()){
                        PayPalPayment payment = new PayPalPayment();
                        payment.setSubtotal(new BigDecimal(TOTAL_GBP));
                        payment.setCurrencyType("GBP");
                        payment.setRecipient(Utils.PAYPAL_ACCOUNT);
                        payment.setPaymentType(PayPal.PAYMENT_TYPE_GOODS);
                        Intent checkoutIntent = PayPal.getInstance().checkout(payment, getBaseContext());
                        startActivityForResult(checkoutIntent, 1);
                    }else{
                        utils.showToast("Your shopping cart is empty.");
                        // The PayPal button needs to be updated so that the user can click on it again.
                        btnPaypal.updateButton();
                    }
                }   
            });
        }
    } 
```

我在 Log Cat 中收到以下错误：

```
03-23 11:56:33.539: E/AndroidRuntime(739): FATAL EXCEPTION: main
03-23 11:56:33.539: E/AndroidRuntime(739): java.lang.NullPointerException
03-23 11:56:33.539: E/AndroidRuntime(739):  at java.math.BigDecimal.<init>(BigDecimal.java:406)
03-23 11:56:33.539: E/AndroidRuntime(739):  at com.fokrul.justdeals.ActivityTab$PaypalTask$1.onClick(ActivityTab.java:1587)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.view.View.performClick(View.java:3110)
03-23 11:56:33.539: E/AndroidRuntime(739):  at com.paypal.android.MEP.CheckoutButton.onClick(Unknown Source)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.view.View.performClick(View.java:3110)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.view.View$PerformClick.run(View.java:11934)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.os.Handler.handleCallback(Handler.java:587)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.os.Handler.dispatchMessage(Handler.java:92)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.os.Looper.loop(Looper.java:132)
03-23 11:56:33.539: E/AndroidRuntime(739):  at android.app.ActivityThread.main(ActivityThread.java:4123)
03-23 11:56:33.539: E/AndroidRuntime(739):  at java.lang.reflect.Method.invokeNative(Native Method)
03-23 11:56:33.539: E/AndroidRuntime(739):  at java.lang.reflect.Method.invoke(Method.java:491)
03-23 11:56:33.539: E/AndroidRuntime(739):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
03-23 11:56:33.539: E/AndroidRuntime(739):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
03-23 11:56:33.539: E/AndroidRuntime(739):  at dalvik.system.NativeStart.main(Native Method) 
```

我发现这是因为我可能为 TOTAL_GBP 分配了 NULL 值。

如果我将其更改为：

```
payment.setSubtotal(new BigDecimal("8.25")); 
```

它有效，但显示为 8.25 英镑作为结帐价值。但我希望它从 TOTAL_GBP 定义的购物车小计中获得价值。当我使用 TOTAL_GBP 而不是“8.25”或任何双浮点值时，它只会崩溃。

有什么想法吗？

# c++ - 使用 sparsehash 库时出现致命错误 C1083

> ID：15588894
> 
> 赞同：0
> 
> 时间：2013-03-23T16:03:56.650
> 
> 标签：c++, fatal-error

嗨，我正在使用 google sparsehash 库。当我编译代码（Visual Studio 2005）它给出以下错误...... **致命错误C1083**：无法打开包含文件：'sparsehash/sparse_hash_map'：没有这样的文件或目录

这个问题背后的原因是什么，它的解决方案是什么。提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:41:37.937

确保您安装了[https://code.google.com/p/sparsehash/](https://code.google.com/p/sparsehash/)并且您的 makefile 已正确更新以包含来自此 sparsehash 的头文件，例如

-I ./sparsehash/包括

如果是 Visual Studio，请确保您的项目设置引用文件所在的路径。

# android - Sqlite 验证列的值是否存在

> ID：15588900
> 
> 赞同：0
> 
> 时间：2013-03-23T16:04:06.683
> 
> 标签：android, sqlite, select, cursor

我想知道这种方法是否正确，可以验证“用户名”列中是否已经存在 _username 的值

```
public boolean verification(String _username) throws SQLException{
    Cursor c = dataBase.rawQuery("SELECT * FROM "+TABLE_NAME+" WHERE "+KEY_USERNAME+"="+_username, null);
    if (c!=null)
        return true; // return true if the value of _username already exists
    return false; // Return false if _username doesn't match with any value of the columns "Username"
} 
```

有没有更好的方法来做同样的事情，我真的不确定，这似乎适合我。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T16:13:51.040

[当心](http://xkcd.com/327/)SQL注入[攻击](https://en.wikipedia.org/wiki/SQL_injection)！您应该始终使用参数化查询：

```
Cursor c = dataBase.rawQuery("SELECT 1 FROM "+TABLE_NAME+" WHERE "+KEY_USERNAME+"=?", new String[] {_username}); 
```

（老实说，我不确定您的第一个查询如何没有抛出异常，因为您忘记将字符串括在引号中......）

也`rawQuery()`将始终返回一个 Cursor，您必须检查 Cursor 是否为*空*，而不是`null`。

* * *

至于“最佳”方法，这很好用，但我建议关闭光标以释放资源。全部一起：

```
public boolean verification(String _username) {
    Cursor c = dataBase.rawQuery("SELECT 1 FROM "+TABLE_NAME+" WHERE "+KEY_USERNAME+"=?", new String[] {_username});
    boolean exists = c.moveToFirst();
    c.close();
    return exists;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T16:14:20.503

> 有没有更好的方法来做同样的事情，我真的不确定，这似乎适合我。谢谢。

就安全性和纯度而言，是的，当然。

```
public boolean verification(String _username) throws SQLException {
    int count = -1;
    Cursor c = null; 
    try {
       String query = "SELECT COUNT(*) FROM " 
                   + TABLE_NAME + " WHERE " + KEY_USERNAME + " = ?"
       c = dataBase.rawQuery(query, new String[] {_username});
       if (c.moveToFirst()) {
          count = c.getInt(0);
       }
       return count > 0;
    }
    finally {
       if (c != null) {
          c.close();
       }
    }
} 
```

我建议您使用**`?`**一种称为**placeholder**的用法。每个占位符将按相同顺序替换为字符串数组中的值。这也称为参数化语句，作为对 SQL 注入的防御。完成 Cursor 的工作后，释放它。

# sql - SQL：ER 模型，外键

> ID：15588901
> 
> 赞同：0
> 
> 时间：2013-03-23T16:04:08.100
> 
> 标签：sql, foreign-keys, entity-relationship

我有一个简单的问题，但我仍然对此感到困惑。

每当你设计一个 ER 模型时，你应该如何绘制 PK 和 FK ？

假设我有两个表，用户和国家

```
User
ID | firstName | lastName | FKCountry
1  | John      | Stewart  | 1
2  | Paul      | Duschmol | 2
etc.

Country
ID | country     | code
1  | Germany     | GER
2  | Switzerland | CH
etc... 
```

那么，我是否应该在 ER 模型中添加“FKCountry”列？我的意思是，两个实体之间会有关系（菱形），但是我应该通过用户实体明确添加“FKCountry”吗？

希望我的问题很清楚，提前谢谢你:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:09:00.397

的主要目的`Foreign Key`是加强两个表之间的参照完整性。

如果与`Country`a的关系`User`是 ，`One-to-Many`那么`FKCountry`在 table 上添加列应该没问题`User`。

但是，如果关系`Many-to-Many`既`Country`可以有多个`User`也可以`User`属于多个`Country`，则更优选 3 表设计。其中第三个表是另外两个之间的关联表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:09:52.393

是的，您应该添加`FKCountry`到`User`ER 图中的表中。如果该列存在于您的表中，它应该在实体中表示。`Country.ID`关系标记连接到应该是零怀疑`User.FKCountry`。仅仅因为在此示例中很明显并不意味着在其他关系中，链接的列可能不会以完全不同的方式命名并且不明显。

# java - 在java正则表达式中获取组名

> ID：15588903
> 
> 赞同：41
> 
> 时间：2013-03-23T16:04:21.490
> 
> 标签：java, regex

我正在尝试同时接收模式和字符串并返回组名映射 - >匹配结果。

例子：

```
(?<user>.*) 
```

我想返回一个包含“用户”作为键的映射，以及它匹配的任何值作为它的值。

问题是我似乎无法从 Java regex api 获取组名。我只能按名称或索引获取匹配的值。我没有组名列表，而且 Pattern 和 Matcher 似乎都没有公开这些信息。我检查了它的来源，似乎信息就在那里——只是没有向用户公开。

我尝试了 Java 的 java.util.regex 和 jregex。（并且真的不在乎是否有人建议任何其他支持此功能的良好，受支持和高性能的库）。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-03-23T16:13:10.023

Java 中没有 API 来获取命名捕获组的名称。我认为这是一个缺失的功能。

简单的方法是从模式中挑选出候选命名捕获组，然后尝试**从匹配**中访问命名组。换句话说，在插入与整个模式匹配的字符串之前，您不知道命名捕获组的确切名称。

`Pattern`捕获命名捕获组的名称是（`\(\?<([a-zA-Z][a-zA-Z0-9]*)>`基于[`Pattern`类文档](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#groupname)派生的）。

（困难的方法是为正则表达式实现解析器并获取捕获组的名称）。

示例实现：

```
import java.util.Scanner;
import java.util.Set;
import java.util.TreeSet;
import java.util.Iterator;
import java.util.regex.Pattern;
import java.util.regex.Matcher;
import java.util.regex.MatchResult;

class RegexTester {

    public static void main(String args[]) {
        Scanner scanner = new Scanner(System.in);

        String regex = scanner.nextLine();
        StringBuilder input = new StringBuilder();
        while (scanner.hasNextLine()) {
            input.append(scanner.nextLine()).append('\n');
        }

        Set<String> namedGroups = getNamedGroupCandidates(regex);

        Pattern p = Pattern.compile(regex);
        Matcher m = p.matcher(input);
        int groupCount = m.groupCount();

        int matchCount = 0;

        if (m.find()) {
            // Remove invalid groups
            Iterator<String> i = namedGroups.iterator();
            while (i.hasNext()) {
                try {
                    m.group(i.next());
                } catch (IllegalArgumentException e) {
                    i.remove();
                }
            }

            matchCount += 1;
            System.out.println("Match " + matchCount + ":");
            System.out.println("=" + m.group() + "=");
            System.out.println();
            printMatches(m, namedGroups);

            while (m.find()) {
                matchCount += 1;
                System.out.println("Match " + matchCount + ":");
                System.out.println("=" + m.group() + "=");
                System.out.println();
                printMatches(m, namedGroups);
            }
        }
    }

    private static void printMatches(Matcher matcher, Set<String> namedGroups) {
        for (String name: namedGroups) {
            String matchedString = matcher.group(name);
            if (matchedString != null) {
                System.out.println(name + "=" + matchedString + "=");
            } else {
                System.out.println(name + "_");
            }
        }

        System.out.println();

        for (int i = 1; i < matcher.groupCount(); i++) {
            String matchedString = matcher.group(i);
            if (matchedString != null) {
                System.out.println(i + "=" + matchedString + "=");
            } else {
                System.out.println(i + "_");
            }
        }

        System.out.println();
    }

    private static Set<String> getNamedGroupCandidates(String regex) {
        Set<String> namedGroups = new TreeSet<String>();

        Matcher m = Pattern.compile("\\(\\?<([a-zA-Z][a-zA-Z0-9]*)>").matcher(regex);

            while (m.find()) {
                namedGroups.add(m.group(1));
            }

            return namedGroups;
        }
    }
} 
```

但是，此实现有一个警告。它目前不适用于[`Pattern.COMMENTS`](https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html#COMMENTS)模式下的正则表达式。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-24T07:28:23.007

这是解决该问题的第二种简单方法：我们将调用 Pattern 类中的非公共方法`namedGroups()`来获得一个`Map<String, Integer>`通过[**Java Reflection API**](http://docs.oracle.com/javase/tutorial/reflect/index.html)将组名映射到组号的方法。这种方法的优点是我们不需要包含与正则表达式匹配的字符串来查找确切的命名组。

^(就个人而言，我认为这并没有太大的优势，因为知道输入字符串中不存在与正则表达式匹配的正则表达式的命名组是没有用的。)

**但是，请注意[缺点](http://docs.oracle.com/javase/tutorial/reflect/index.html)**：

*   如果代码在具有安全限制以拒绝任何尝试访问非公共方法（无修饰符、受保护和私有方法）的系统中运行，则此方法可能不适用。
*   该代码仅适用于 Oracle 或 OpenJDK 的 JRE。
*   该代码也可能在未来的版本中中断，因为我们正在调用非公共方法。
*   通过反射调用函数也可能会影响性能。（在这种情况下，性能损失主要来自反射开销，因为`namedGroups()`方法中没有太多事情发生）。我不知道*性能影响如何影响整体性能*，所以请在您的系统上进行测量。

* * *

```
import java.util.Collections;
import java.util.Map;
import java.util.Scanner;
import java.util.regex.Pattern;

import java.lang.reflect.Method;
import java.lang.reflect.InvocationTargetException;

class RegexTester {
  public static void main(String args[]) {
    Scanner scanner = new Scanner(System.in);

    String regex = scanner.nextLine();
    // String regex = "(?<group>[a-z]*)[trick(?<nothing>ha)]\\Q(?<quoted>Q+E+)\\E(.*)(?<Another6group>\\w+)";
    Pattern p = Pattern.compile(regex);

    Map<String, Integer> namedGroups = null;
    try {
      namedGroups = getNamedGroups(p);
    } catch (Exception e) {
      // Just an example here. You need to handle the Exception properly
      e.printStackTrace();
    }

    System.out.println(namedGroups);
  }

  @SuppressWarnings("unchecked")
  private static Map<String, Integer> getNamedGroups(Pattern regex)
      throws NoSuchMethodException, SecurityException,
             IllegalAccessException, IllegalArgumentException,
             InvocationTargetException {

    Method namedGroupsMethod = Pattern.class.getDeclaredMethod("namedGroups");
    namedGroupsMethod.setAccessible(true);

    Map<String, Integer> namedGroups = null;
    namedGroups = (Map<String, Integer>) namedGroupsMethod.invoke(regex);

    if (namedGroups == null) {
      throw new InternalError();
    }

    return Collections.unmodifiableMap(namedGroups);
  }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-04-14T13:41:32.037

您想使用小[名称正则表达式](http://tony19.github.io/named-regexp/)库。它是一个瘦包装器，`java.util.regex`带有对 Java 5 或 6 用户的命名捕获组支持。

### 示例用法：

```
Pattern p = Pattern.compile("(?<user>.*)");
Matcher m = p.matcher("JohnDoe");
System.out.println(m.namedGroups()); // {user=JohnDoe} 
```

### 马文：

```
<dependency>
  <groupId>com.github.tony19</groupId>
  <artifactId>named-regexp</artifactId>
  <version>0.2.3</version>
</dependency> 
```

***参考：***

*   [名称正则表达式 0.2.5](http://tony19.github.io/named-regexp/)
*   [匹配器#namedGroups](http://tony19.github.io/named-regexp/doc/0.2.5/com/google/code/regexp/Matcher.html#namedGroups%28%29)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-11-25T20:52:00.920

我在“真实”模式中使用了一组正则表达式来获取组的名称，如下所示：

```
 List<String> namedGroups = new ArrayList<String>();
    {
        String normalized = matcher.pattern().toString();
        Matcher mG = Pattern.compile("\\(\\?<(.+?)>.*?\\)").matcher(normalized);

        while (mG.find()) {
            for (int i = 1; i <= mG.groupCount(); i++) {
                namedGroups.add(mG.group(i));
            }
        }
    } 
```

然后，我将带有值的名称添加到 HashMap<String, String> 中：

```
 Map<String, String> map = new HashMap<String, String>(matcher.groupCount());

        namedGroups.stream().forEach(name -> {      
            if (matcher.start(name) > 0) {
                map.put(name, matcher.group(name));
            } else {
                map.put(name, "");
            }
        }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-08T09:30:04.730

使用标准 API 无法做到这一点。您可以使用反射来访问这些：

```
final Field namedGroups = pattern.getClass().getDeclaredField("namedGroups");
namedGroups.setAccessible(true);
final Map<String, Integer> nameToGroupIndex = (Map<String, Integer>) namedGroups.get(pattern); 
```

如果您不关心索引，请使用地图的键集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-11T20:00:30.267

目前没有办法通过标准 API 实现这一点。

JDK 错误系统中有一个未解决的问题（[JDK-7032377“MatchResult and Pattern 应该提供一种查询命名捕获组名称的方法”](https://bugs.openjdk.java.net/browse/JDK-7032377)），要求通过`MatchResult`和`Pattern`API 公开命名捕获组。

这个错误是在十年前的 2011 年创建的，并在 2020 年更新，但我看不到任何迹象表明这是否会很快实施。

# c - 从串口linux读取

> ID：15588905
> 
> 赞同：3
> 
> 时间：2013-03-23T16:04:34.003
> 
> 标签：c, serial-port

我正在尝试从串行端口读取，但总是返回 0（零）个字符。已阅读“POSIX 操作系统的串行编程指南”，但无法找出程序不等待（阻塞）的原因。编码：

```
#include <stdio.h>   /* Standard input/output definitions */
#include <string.h>  /* String function definitions */
#include <unistd.h>  /* UNIX standard function definitions */
#include <fcntl.h>   /* File control definitions */
#include <errno.h>   /* Error number definitions */
#include <termios.h> /* POSIX terminal control definitions */

void main()
{
    printf("Hello world\n");

    int fd; /* File descriptor for the port */
    int n;
    int bytes;

    char c;

    char buffer[10];
    char *bufptr;

    struct termios options;

    fd = open("/dev/ttyUSB0", O_RDWR | O_NOCTTY | O_NDELAY);

    if (fd == -1) {
        perror("open_port: Unable to open /dev/ttyUSB0 - ");
    }
    else {
        fcntl(fd, F_SETFL, FNDELAY);
    }

  tcgetattr( fd, &options );

  /* SEt Baud Rate */

  cfsetispeed( &options, B9600 );
  cfsetospeed( &options, B9600 );

  //I don't know what this is exactly

  options.c_cflag |= ( CLOCAL | CREAD );

  // Set the Charactor size

  options.c_cflag &= ~CSIZE; /* Mask the character size bits */
  options.c_cflag |= CS8;    /* Select 8 data bits */

  // Set parity - No Parity (8N1)

  options.c_cflag &= ~PARENB;
  options.c_cflag &= ~CSTOPB;
  options.c_cflag &= ~CSIZE;
  options.c_cflag |= CS8;

  // Disable Hardware flowcontrol

  //  options.c_cflag &= ~CNEW_RTSCTS;  -- not supported

  // Enable Raw Input

  options.c_lflag &= ~(ICANON | ECHO | ECHOE | ISIG);

  // Disable Software Flow control

  options.c_iflag &= ~(IXON | IXOFF | IXANY);

  // Chose raw (not processed) output

  options.c_oflag &= ~OPOST;

  if ( tcsetattr( fd, TCSANOW, &options ) == -1 )
    printf ("Error with tcsetattr = %s\n", strerror ( errno ) );
  else
    printf ( "%s\n", "tcsetattr succeed" );

    fcntl(fd, F_SETFL, 0);

    // Write to the port
    n = write(fd, "1", 1);

    if (n < 0) {
        fputs("write() of 1 bytes failed!\n", stderr);
    }

    // Read from the port

    //fcntl(fd, F_SETFL, FNDELAY);

    bytes = read(fd, &buffer, sizeof(buffer));
    printf("number of bytes read is %d\n", bytes);
    printf("%s\n", buffer);
    //perror ("read error:");

    close(fd);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:19:32.737

此信息最初来自串行编程指南¹。

您获得`0`返回值的原因是因为这一行：

```
fcntl(fd, F_SETFL, FNDELAY); 
```

如果您想要正常的阻塞读取，请取消设置该标志。

[1\. [http://www.easysw.com/~mike/serial/serial.html#2_5_4](http://www.easysw.com/~mike/serial/serial.html#2_5_4)（现已失效）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:18:16.313

您正在使用 O_NDELAY

> **O_NONBLOCK 或 O_NDELAY**
> 
> 如果可能，文件以非阻塞模式打开。open() 和返回的文件描述符上的任何后续操作都不会导致调用进程等待。有关 FIFO（命名管道）的处理，另请参见 fifo(7)。有关 O_NONBLOCK 与强制文件锁定和文件租约结合的影响的讨论，请参阅 fcntl(2)。

编辑：您也在 fcntl() 调用中做同样的事情。

# opencv - 在 Pandaboard 上使用静态链接进行 OpenCV 编译的问题

> ID：15588906
> 
> 赞同：7
> 
> 时间：2013-03-23T16:04:36.490
> 
> 标签：opencv, static, pandaboard

我使用 BUILD_SHARED_LIBS=0 选项在熊猫板上安装了带有静态链接的 opencv。我正在使用 ubuntu 11.10。我还构建了 3rd 方库 png、jpeg、jasper 和 zlib。（cmake 选项 BUILD_PNG=ON BUILD_JASPER=ON BUILD_JPEG=ON BUILD_ZLIB=ON WITH_JPEG=ON WITH_PNG=ON WITH_JASPER=ON）。我的opencv安装成功。然而，当我编译一个测试程序时，我得到了许多未定义的错误引用。所有这些错误似乎都与 jpeg、png 和 jasper 库有关，但我不明白为什么当我明确链接它们时 libhighgui 无法引用第 3 方库。这是我编译程序的方式：

`g++ -static face_recognition.cpp -o fcarm -I/home/nandhini/opencv/2.4.2static/include/opencv -I/home/nandhini/opencv/2.4.2static/include -L/home/nandhini/opencv/2.4.2static/lib/ -L/home/nandhini/opencv/2.4.2static/share/OpenCV/3rdparty/lib -llibjpeg -llibjasper -llibpng -lzlib -lopencv_core -lopencv_contrib -lopencv_imgproc -lopencv_highgui -lopencv_ml -lopencv_video -lopencv_features2d -lopencv_calib3d -lopencv_objdetect -lopencv_flann -lopencv_photo -lopencv_legacy -pthread -lm -lrt -lstdc++ -ldl`

我已经被这个问题困扰了很长时间，如果有人能帮助我解决这个问题，我将不胜感激。请帮忙，谢谢！

这是我的错误列表：

`/home/nandhini/opencv/2.4.2static/lib//libopencv_core.a(persistence.cpp.o): In function`icvGets(CvFileStorage*, char*, int)': persistence.cpp:(.text._ZL7icvGetsP13CvFileStoragePci+0x7e): 未定义引用`gzgets' /home/nandhini/opencv/2.4.2static/lib//libopencv_core.a(persistence.cpp.o): In function`_ZL16icvYMLSkipSpacesP13CvFileStoragePcii.constprop.61': persistence.cpp:(.text._ZL16icvYMLSkipSpacesP13CvFileStoragePci.61CvFileStoragePci+0x7e ): 对`gzeof' /home/nandhini/opencv/2.4.2static/lib//libopencv_core.a(persistence.cpp.o): In function`icvPuts(CvFileStorage*, char const*)'的未定义引用：persistence.cpp:(.text._ZL7icvPutsP13CvFileStoragePKc+0x138): 对`gzputs' /home/nandhini/opencv/2.4.2static/lib//libopencv_core.a(persistence.cpp.o): In function`icvXMLSkipSpaces(CvFileStorage*, char*, int)'的未定义引用：persistence.cpp:(。 text._ZL16icvXMLSkipSpacesP13CvFileStoragePci+0x1a2): 对`gzeof' /home/nandhini/opencv/2.4.2static/lib//libopencv_core.a(persistence.cpp.o): In function`icvClose 的未定义引用(CvFileStorage*, std::basic_string, std::allocator >*)': persistence.cpp:(.text._ZL8icvCloseP13CvFileStoragePSs+0x132): 未定义引用`gzclose' /home/nandhini/opencv/2.4.2static/lib//libopencv_core.a(persistence.cpp.o): In function`cvOpenFileStorage'：persistence.cpp:(.text.cvOpenFileStorage+0x1b0)：未定义的gzclose引用`gzrewind' persistence.cpp:(.text.cvOpenFileStorage+0x6b6): undefined reference to`persistence.cpp:(.text.cvOpenFileStorage+0x734)：未定义的`gzopen' persistence.cpp:(.text.cvOpenFileStorage+0xcd4): undefined reference to`gzclose引用/home/nandhini/opencv/2.4.2static/ lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o): 在函数`cv::JasperInitializer::~JasperInitializer()': grfmt_jpeg2000.cpp:(.text._ZN2cv17JasperInitializerD2Ev[_ZN2cv17JasperInitializerD5Ev]+0x4): undefined reference to`jas_cleanup'/home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o): 在函数`cv::Jpeg2KDecoder::close()': grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder5closeEv+0x8): undefined reference to`jas_stream_close' grfmt_jpeg2000.cpp :(.text._ZN2cv13Jpeg2KDecoder5closeEv+0x14): 未定义引用`jas_image_destroy' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o): In function`cv::Jpeg2KDecoder::readHeader()': grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder10readHeaderEv+0xe): 未定义引用`jas_stream_fopen' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder10readHeaderEv+0x1e): undefined reference to`jas_image_decode' /home/nandhini/opencv/2.4 .2static/lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o)：在函数中`cv::Jpeg2KDecoder::readData(cv::Mat&)': grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x5c): undefined reference to`jas_image_getcmptbytype' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x68): undefined reference to `jas_image_getcmptbytype' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x74): undefined reference to`jas_image_getcmptbytype' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0xb8): undefined reference to `jas_image_getcmptbytype' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x126): undefined reference to`jas_matrix_create' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x13e) : undefined reference to `jas_image_readcmpt' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x16e): undefined reference to`jas_matrix_destroy' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x184): undefined reference to `jas_cmprof_createfromclrspc' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x194): undefined reference to`jas_image_chclrspc' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x1a2): undefined reference to `jas_image_destroy' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x1ac): undefined reference to`jas_cmprof_destroy' grfmt_jpeg2000.cpp:(.text. _ZN2cv13Jpeg2KDecoder8readDataERNS_3MatE+0x220)：未定义的引用`jas_cmprof_destroy' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o): In function`cv::Jpeg2KEncoder::writeComponent8u(void*, cv::Mat const&)': grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder16writeComponent8uEPvRKNS_3MatE+0x1c): undefined reference to `jas_matrix_create' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder16writeComponent8uEPvRKNS_3MatE+0x86): undefined reference to`jas_image_writecmpt' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder16writeComponent8uEPvRKNS_3MatE+0xa0): undefined reference to `jas_matrix_destroy' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o): In function`cv::Jpeg2KEncoder::writeComponent16u(void*, cv::Mat const&)': grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder17writeComponent16uEPvRKNS_3MatE+0x1c): undefined reference to `jas_matrix_create' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder17writeComponent16uEPvRKNS_3MatE+0x86): undefined reference to`jas_image_writecmpt' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder17writeComponent16uEPvRKNS_3MatE+ 0xa0): 对`jas_matrix_destroy' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg2000.cpp.o): In function`cv::Jpeg2KEncoder::write(cv::Mat const&, std::vector > const&)' 的未定义引用：grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x5a)：未定义的引用`jas_image_create' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x8c): undefined reference to`jas_image_destroy' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0xbe): undefined reference to `jas_stream_fopen' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0xcc): undefined reference to`jas_image_strtofmt' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0xda): undefined reference to `jas_image_encode' grfmt_jpeg2000.cpp:(.text._ZN2cv13Jpeg2KEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0xe8): undefined reference to`jas_stream_close' /home/nandhini/opencv/2.4.2static/lib //libopencv_highgui.a(grfmt_jpeg2000.cpp.o): 在函数`_GLOBAL__sub_I_grfmt_jpeg2000.cpp': grfmt_jpeg2000.cpp:(.text.startup._GLOBAL__sub_I_grfmt_jpeg2000.cpp+0x2): undefined reference to`jas_init'/home/nandhini/opencv/2.4.2static/lib//libopencv_imgproc.a(templmatch.cpp.o): 在函数`cv::crossCorr(cv::Mat const&, cv::Mat const&, cv::Mat&, cv::Size_<int>, int, cv::Point_<int>, double, int)': templmatch.cpp:(.text._ZN2cv9crossCorrERKNS_3MatES2_RS0_NS_5Size_IiEEiNS_6Point_IiEEdi+0x318): undefined reference to`cv::getOptimalDFTSize(int )' templmatch.cpp:(.text._ZN2cv9crossCorrERKNS_3MateES2_RS0_NS_5Size_IiEEiNS_6Point_IiEEdi+0x33c): 未定义引用`cv::getOptimalDFTSize(int)' templmatch.cpp:(.text._ZN2cv9crossCorrERKNS_3MatES2_RS0_NS_5Size_IiEEiNS_6Point_IiEEdi+0x7c4): undefined reference to`cv::dft(cv::_InputArray const&, cv::_OutputArray const&, int, int)' templmatch.cpp:(.text._ZN2cv9crossCorrERKNS_3MatES2_RS0_NS_5Size_IiEEiNS_6Point_IiEEdi+0xefc): 未定义对`cv::dft(cv::_InputArray const&, cv::_OutputArray const&, int, int)' templmatch.cpp:(.text._ZN2cv9crossCorrERKNS_3MatES2_RS0_NS_5Size_IiEEiNS_6Point_IiEEdi+0xf66): undefined reference to`cv::mulSpectrums(cv::_InputArray const&, cv ::_InputArray const&, cv::_OutputArray const&, int, bool)' templmatch.cpp:(.text._ZN2cv9crossCorrERKNS_3MateES2_RS0_NS_5Size_IiEEiNS_6Point_IiEEdi+0xf8e): 对`cv::dft(cv::_InputArray const&, cv::_OutputArray const&, int, int)' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_png.cpp.o): In function`cv::PngDecoder::readDataFromBuf(void*, unsigned char*, unsigned int)的未定义引用': grfmt_png.cpp:(.text._ZN2cv10PngDecoder15readDataFromBufEPvPhj+0xc): 未定义的对`png_get_io_ptr' grfmt_png.cpp:(.text._ZN2cv10PngDecoder15readDataFromBufEPvPhj+0x10a): undefined reference to`png_error 的引用' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_png.cpp.o): 在函数`cv::PngDecoder::close()': grfmt_png.cpp:(.text._ZN2cv10PngDecoder5closeEv+0x26): undefined reference to`png_destroy_read_struct' /主页/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_png.cpp.o): 在函数中`cv::PngDecoder::readHeader()': grfmt_png.cpp:(.text._ZN2cv10PngDecoder10readHeaderEv+0x18): undefined reference to`png_create_read_struct' grfmt_png.cpp:(.text._ZN2cv10PngDecoder10readHeaderEv+0x22): 未定义对`png_create_info_struct' grfmt_png.cpp:(.text._ZN2cv10PngDecoder10readHeaderEv+0x2a): undefined reference to`png_create_info_struct' grfmt_png.cpp 的引用:(.text._ZN2cv10PngDecoder10readHeaderEv+0x6a): 未定义对`png_set_longjmp_fn' grfmt_png.cpp:(.text._ZN2cv10PngDecoder10readHeaderEv+0xae): undefined reference to`png_init_io' grfmt_png.cpp+00xdngDecoder:(.text._ZN2 : 对`png_read_info' grfmt_png.cpp:(.text._ZN2cv10PngDecoder10readHeaderEv+0xf0): undefined reference to`png_get_IHDR 的未定义引用 grfmt_png.cpp:(.text._ZN2cv10PngDecoder10readHeaderEv+0x166): 对`png_set_read_fn' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_png.cpp.o): In function`cv::PngEncoder::write(cv::Mat const&, std::vector > const&)' 的未定义引用: grfmt_png.cpp:( .text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x18): 未定义对`png_create_write_struct' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x7a): undefined reference to`png_create_info_struct 的引用 grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x9e): 未定义引用`png_set_longjmp_fn' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0xce): undefined reference to`png_set_write_fn' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x14a): undefined reference to `png_set_compression_mem_level' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x158): undefined reference to`png_set_compression_strategy' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x19a): undefined reference to `png_set_IHDR' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x1ae): undefined reference to`png_write_info' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x1ba) : undefined reference to `png_set_bgr' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x1ce): undefined reference to`png_set_swap' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x208): undefined reference to `png_write_image' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x21c): undefined reference to`png_write_end' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x22e): undefined reference to `png_destroy_write_struct' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x284): undefined reference to`png_init_io' grfmt_png.cpp:(.text. _ZN2cv10PngEncoder5writeERKNS_3MateERKSt6vectorIiSaIiEE+0x2c6): 未定义的引用`png_set_filter' grfmt_png.cpp:(.text._ZN2cv10PngEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x2d4): undefined reference to`png_set_compression_level' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_png.cpp.o): 在函数`cv::PngDecoder::readData(cv::Mat&)': grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x8c): undefined reference to`png_set_longjmp_fn' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0xfa): 未定义对`png_set_gray_to_rgb' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x102): undefined reference to`png_read_update_info' grfmt_png 的引用.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x126): undefined reference to `png_read_image' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x12e): undefined reference to`png_read_end' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x14e): undefined reference to `png_set_palette_to_rgb' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x16a): undefined reference to`png_set_rgb_to_gray' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x170): undefined reference to `png_set_bgr' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x178): undefined reference to`png_set_strip_alpha' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x180): 未定义的参考`png_set_swap' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x18c): undefined reference to`png_set_expand_gray_1_2_4_to_8' grfmt_png.cpp:(.text._ZN2cv10PngDecoder8readDataERNS_3MatE+0x194): 未定义引用`png_set_strip_16' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_png.cpp.o): In function`cv::PngEncoder::writeDataToBuf(void*, unsigned char*, unsigned int)': grfmt_png.cpp:(.text._ZN2cv10EPngEncodertext._ZN2cv10EPPhj+0x016) : undefined reference to `png_get_io_ptr' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg.cpp.o): In function`_ZN2cvL16my_jpeg_load_dhtEP22jpeg_decompress_structPhPP9JHUFF_TBLS5_.constprop.30': grfmt_jpeg.cpp:(.text.unlikely._ZN2cvL16my_jpeg_load_dhtEP22jpeg_decompress_structPhPP9JHUFF_TBLS5_.constprop.30+0xa4): undefined reference to `jpeg_alloc_huff_table' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg.cpp.o): In function`cv::JpegEncoder::write(cv::Mat const&, std:: vector > const&)': grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x6e): 未定义的引用`jpeg_CreateCompress' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x78): undefined reference to`jpeg_std_error' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0xdc): undefined reference to `jpeg_destroy_compress' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x194): undefined reference to`jpeg_set_defaults' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x1a2): undefined reference to `jpeg_set_quality' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x1ae): undefined reference to`jpeg_start_compress' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x1f6) : undefined reference to `jpeg_write_scanlines' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x208): undefined reference to`jpeg_finish_compress' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x25e): undefined reference to `jpeg_stdio_dest' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x2a6): undefined reference to`jpeg_write_scanlines' grfmt_jpeg.cpp:(.text._ZN2cv11JpegEncoder5writeERKNS_3MatERKSt6vectorIiSaIiEE+0x2fa): undefined reference to `jpeg_write_scanlines' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg.cpp.o): In function`cv::JpegDecoder::close()' : grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder5closeEv+0xa): 未定义的引用`jpeg_destroy_decompress' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg.cpp.o): In function`cv::JpegDecoder::readData(cv::Mat&)': grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder8readDataERNS_3MatE+0x90): 未定义参考jpeg_read_scanlines `jpeg_start_decompress' grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder8readDataERNS_3MatE+0x10a): undefined reference to`' grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder8readDataERNS_3MatE+0x15): 未定义参考`jpeg_finish_decompress' /home/nandhini/opencv/2.4.2static/lib//libopencv_highgui.a(grfmt_jpeg.cpp.o): In function`::JpegDecoder::readHeader()': grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder10readHeaderEv+0x20): 未定义引用`jpeg_std_error' grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder10readHeaderEv+0x56): undefined reference to`jpeg_CreateDecompress' grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder10readHeaderEv+0x92): 未定义引用`jpeg_stdio_src' grfmt_jpeg.cpp:(.text._ZN2cv11JpegDecoder10readHeaderEv+0x9a): undefined reference to`jpeg_read_header_cpp': grfm (.text._ZN2cv11JpegDecoder10readHeaderEv+0x13c)：未定义的引用`jpeg_resync_to_restart' collect2: ld returned 1 exit status`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T23:07:23.557

链接库的**顺序很****重要**！这[可能是](http://www.network-theory.co.uk/docs/gccintro/gccintro_18.html)问题[所在](https://stackoverflow.com/a/45141/176769)。

# java - Java格式修饰符在字符串中加倍

> ID：15588908
> 
> 赞同：1
> 
> 时间：2013-03-23T16:05:09.807
> 
> 标签：java, printf, formatting

我在大学接受了 Java 的作业，我必须使用它`printf`来格式化输出到控制台。这一切都很好而且花花公子，但由于某种原因我得到了输出`10500.000000000002`，正确的输出应该是`10500.00`。我尝试使用`%0.2f`，但因为我格式化为 a`String`我不能这样做。

这是有问题的行：

```
System.out.printf("\nAge Depreciation Amount:%66s","$"+ ageDepreciationAmount); 
```

你能建议一种正确格式化的方法吗？请记住，这是一门 Java 入门课程，这意味着我在编程方面完全是个灾难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:07:35.613

```
DecimalFormat df = new DecimalFormat("0.##");
String result = df.format(10500.000000000002); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:12:31.160

`%0.2f`是不正确的。你应该使用`%.2f`：

例子：

```
System.out.printf("Age Depreciation Amount: %.2f\n", ageDepreciationAmount); 
```

或者如果`ageDepreciationAmount`是`String`做

```
System.out.printf("Age Depreciation Amount: %.2f\n", Double.parseDouble(ageDepreciationAmount)); 
```

顺便说一句，我们通常`\n`在 printf 之后添加，而不是之前。

输出：

```
Age Depreciation Amount: 10500.00 
```

如果您想用空格填充输出，您可以使用`%66.2`，其中`66`是总宽度，并且`2`是小数位数。但是，这只适用于数字。由于您还需要打印美元符号，您可以分两步完成，如下所示：

```
 double ageDepreciationAmount = 10500.000000000002;
    double ageDepreciationAmount2 = 100500.000000000002;

    String tmp = String.format("$%.2f", ageDepreciationAmount);
    String tmp2 = String.format("$%.2f", ageDepreciationAmount2);

    System.out.printf("Age Depreciation Amount: %20s\n", tmp);
    System.out.printf("Age Depreciation Amount: %20s\n", tmp2); 
```

输出：

```
Age Depreciation Amount:            $10500.00
Age Depreciation Amount:           $100500.00 
```

# javascript - 纯 Javascript：onClick 执行切换行——需要图像交换

> ID：15588909
> 
> 赞同：2
> 
> 时间：2013-03-23T16:05:15.300
> 
> 标签：javascript, image, onclick

第一次发帖，看久了。堆栈溢出摇滚！

需要一些帮助。我主要是一名商业智能/数据仓库专业人士。我需要使用一些 Javascript 在报告编写工具中创建折叠行报告，在该工具中我无法预期调用 JQuery（内部 LAN 部署）的能力。因此我需要纯 Javascript。

前提是我需要仅在经理/地区级别打开带有行的报告，但能够打开地区集群以查看分配的销售代表及其贡献。

我找到了执行此操作的代码（实际上通过隐藏重复的区域经理的名字非常好），但它使用文本对象（“+”和“--”）来呈现 OnClick 事件后面的链接。我真的，真的，真的，真的需要让它显示交替的图像。

我尝试简单地修改这两个部分，但在第一个块中渲染图像的代码与第二个块的代码不匹配，这导致三元操作失败并且图像不会按预期交替。

1.  `lnk.innerHTML =(lnk.innerHTML == "+")?"--":"+";`

2.  `var link ='<a href="#" onclick="toggleSection(this);return false;" style="text-decoration: none">+</a>';`

下面的代码包含带有用于 onClick 操作的文本的工作代码，以及用于切换图像的简单 onClick 下方。本质上，我需要文件夹图标位于管理器/区域网格的第一个单元格中。为了节省空间，我强制将工作折叠代码放入主 Javascript 块中。

任何帮助、洞察力、指导、电牛电击（哎哟）将不胜感激。

提前致谢。

更新：为此创建了一个 CodePen，以便更轻松地查看当前有效的方法：

[http://codepen.io/anon/pen/yjLvh](http://codepen.io/anon/pen/yjLvh)

谢谢！

```
<html>
<head>
<style type="text/css">
table { empty-cells: show; }
cell {font-family:'Calibri';font-size:11.0pt;color: #000000;}
TD{font-family: Calibri; font-size: 10.5pt;}
TH{font-family: Calibri; font-size: 10.5pt; }
</style>

</head>
<body>
<SCRIPT type=text/javascript> 
var tbl;
var toggleimage=new Array("http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_open_folder.png","http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_closed_folder.png")

function trim(str){
 return str.replace(/^\s*|\s*$/g,"");
}

function getParent(el, pTagName) {
 if (el == null) return null;
 else if (el.nodeType == 1 && el.tagName.toLowerCase() == pTagName.toLowerCase()) // Gecko bug, supposed to be uppercase
  return el;
 else
  return getParent(el.parentNode, pTagName);
}

function toggleSection(lnk){

 var td = lnk.parentNode;
 var table = getParent(td,'TABLE');
 var len = table.rows.length;
 var tr = getParent(td, 'tr');
 var rowIndex = tr.rowIndex;
 var rowHead=table.rows[rowIndex].cells[1].innerHTML;

lnk.innerHTML =(lnk.innerHTML == "+")?"--":"+";

 vStyle =(tbl.rows[rowIndex+1].style.display=='none')?'':'none';

 for(var i = rowIndex+1; i < len;i++){
  if (table.rows[i].cells[1].innerHTML==rowHead){
    table.rows[i].style.display= vStyle;
    table.rows[i].cells[1].style.visibility="hidden";
  }
 }
}

function toggleRows(){
    tables =document.getElementsByTagName("table");
    for(i =0; i<tables.length;i++){
      if(tables[i].className.indexOf("expandable") != -1)
        tbl =tables[i];
    }
    if(typeof tbl=='undefined'){
     alert("Could not find a table of expandable class");
     return;
    }

//assume the first row is headings and the first column is empty
 var len = tbl.rows.length;
var link ='<a href="#" onclick="toggleSection(this);return false;" style="text-decoration: none">+</a>';

 var rowHead = tbl.rows[1].cells[1].innerHTML;

 for (j=1; j<len;j++){
  //check the value in each row of column 2
  var m = tbl.rows[j].cells[1].innerHTML;

if(m!=rowHead || j==1){
   rowHead=m;
   tbl.rows[j].cells[0].innerHTML = link;
//   tbl.rows[j].cells[0].style.textAlign="center";
   tbl.rows[j].style.background = "#FFFFFF";
  }
else
   tbl.rows[j].style.display = "none";
}

}
var oldEvt = window.onload;

var preload_image_1=new Image()
var preload_image_2=new Image()
preload_image_1.src=toggleimage[0]
preload_image_2.src=toggleimage[1]
var i_image=0

function testloading() {
    isloaded=true
}

function toggle() {
    if (isloaded) {
        document.togglepicture.src=toggleimage[i_image]
    }
    i_image++
    if (i_image>1) {i_image=0}
}

window.onload = function() { if (oldEvt) oldEvt(); toggleRows(); testloading();}

</SCRIPT>

<TABLE class=expandable width="400px" border="1"  cellspacing="0" frame="box" rules="all" >
  <THEAD>
  <TR>
    <TH  bgColor="#E6E4D4">&nbsp;</TH>
    <TH bgColor="#E6E4D4" align="left">Manager</TH>
    <TH bgColor="#E6E4D4" align="left">Sales Rep</TH>
    <TH bgColor="#E6E4D4" align="left">Amount </TH></TR>
</THEAD>
  <TBODY>
  <TR>
    <TD>&nbsp;</TD>
    <TD>Sarah Jones</TD>
    <TD><i>Georgia District Reps</i></TD>
    <TD>500000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>Sarah Jones</TD>
    <TD>Rex Smtih</TD>
    <TD>350000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>Sarah Jones</TD>
    <TD>Alex Anderson</TD>
    <TD>150000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>William Hobby</TD>
    <TD><i>Texas District Reps</i></TD>
    <TD>630000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>William Hobby</TD>
    <TD>Bill Smith</TD>
    <TD>410000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>William Hobby</TD>
    <TD>Simon Wilkes</TD>
    <TD>220000</TD></TR>
</TBODY></font></TABLE>
<br>
<br>
<a href="javascript:toggle()"><img name="togglepicture" src="http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_closed_folder.png" border="0"></a>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T03:06:47.563

[工作演示](http://codepen.io/anon/pen/mgbFx)

```
<html>
<head>
<style type="text/css">
table { empty-cells: show; }
cell {font-family:'Calibri';font-size:11.0pt;color: #000000;}
TD{font-family: Calibri; font-size: 10.5pt;}
TH{font-family: Calibri; font-size: 10.5pt; }
</style>

</head>
<body>
<SCRIPT type=text/javascript> 
var tbl;
var toggleimage=new Array("http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_open_folder.png","http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_closed_folder.png")

  var closedImgHTML = "<img name=\"togglepicture\" src=\"http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_closed_folder.png\" border=\"0\" height=\"20\">";

  var openImgHTML = "<img name=\"togglepicture\" src=\"http://www.iconlooker.com/user-content/uploads/wall/thumb/misc._icons_open_folder.png\" border=\"0\" height=\"20\">";

function trim(str){
 return str.replace(/^\s*|\s*$/g,"");
}

function getParent(el, pTagName) {
 if (el == null) return null;
 else if (el.nodeType == 1 && el.tagName.toLowerCase() == pTagName.toLowerCase()) // Gecko bug, supposed to be uppercase
  return el;
 else
  return getParent(el.parentNode, pTagName);
}

function toggleSection(lnk){

 var td = lnk.parentNode;
 var table = getParent(td,'TABLE');
 var len = table.rows.length;
 var tr = getParent(td, 'tr');
 var rowIndex = tr.rowIndex;
 var rowHead=table.rows[rowIndex].cells[1].innerHTML;

lnk.innerHTML =(lnk.innerHTML == openImgHTML)?closedImgHTML:openImgHTML;

 vStyle =(tbl.rows[rowIndex+1].style.display=='none')?'':'none';

 for(var i = rowIndex+1; i < len;i++){
  if (table.rows[i].cells[1].innerHTML==rowHead){
    table.rows[i].style.display= vStyle;
    table.rows[i].cells[1].style.visibility="hidden";
  }
 }
}

function toggleRows(){
    tables =document.getElementsByTagName("table");
    for(i =0; i<tables.length;i++){
      if(tables[i].className.indexOf("expandable") != -1)
        tbl =tables[i];
    }
    if(typeof tbl=='undefined'){
     alert("Could not find a table of expandable class");
     return;
    }

//assume the first row is headings and the first column is empty
 var len = tbl.rows.length;
var link ='<a href="#" onclick="toggleSection(this);return false;" style="text-decoration: none">'+closedImgHTML+'</a>';

 var rowHead = tbl.rows[1].cells[1].innerHTML;

 for (j=1; j<len;j++){
  //check the value in each row of column 2
  var m = tbl.rows[j].cells[1].innerHTML;

if(m!=rowHead || j==1){
   rowHead=m;
   tbl.rows[j].cells[0].innerHTML = link;
//   tbl.rows[j].cells[0].style.textAlign="center";
   tbl.rows[j].style.background = "#FFFFFF";
  }
else
   tbl.rows[j].style.display = "none";
}

}
var oldEvt = window.onload;

var preload_image_1=new Image()
var preload_image_2=new Image()
preload_image_1.src=toggleimage[0]
preload_image_2.src=toggleimage[1]
var i_image=0

function testloading() {
    isloaded=true
}

function toggle() {
    if (isloaded) {
        document.togglepicture.src=toggleimage[i_image]
    }
    i_image++
    if (i_image>1) {i_image=0}
}

window.onload = function() { if (oldEvt) oldEvt(); toggleRows(); testloading();}

</SCRIPT>

<TABLE class=expandable width="400px" border="1"  cellspacing="0" frame="box" rules="all" >
  <THEAD>
  <TR>
    <TH  bgColor="#E6E4D4">&nbsp;</TH>
    <TH bgColor="#E6E4D4" align="left">Manager</TH>
    <TH bgColor="#E6E4D4" align="left">Sales Rep</TH>
    <TH bgColor="#E6E4D4" align="left">Amount </TH></TR>
</THEAD>
  <TBODY>
  <TR>
    <TD>&nbsp;</TD>
    <TD>Sarah Jones</TD>
    <TD><i>Georgia District Reps</i></TD>
    <TD>500000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>Sarah Jones</TD>
    <TD>Rex Smtih</TD>
    <TD>350000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>Sarah Jones</TD>
    <TD>Alex Anderson</TD>
    <TD>150000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>William Hobby</TD>
    <TD><i>Texas District Reps</i></TD>
    <TD>630000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>William Hobby</TD>
    <TD>Bill Smith</TD>
    <TD>410000</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>William Hobby</TD>
    <TD>Simon Wilkes</TD>
    <TD>220000</TD></TR>
</TBODY></font></TABLE>
<br>
<br>
<a href="javascript:toggle()"></a>

</body>
</html> 
```

# php - 使用 PHP 中的表单，我试图返回一个依赖于输入的 SQL 值的 SQL 值？

> ID：15588923
> 
> 赞同：0
> 
> 时间：2013-03-23T16:06:42.403
> 
> 标签：php, mysql

我的数据库看起来像这样

> **paynumber 全名 linemanager**
> 12345 John Smith Jack Jones
> 12346 Joe Bloggs Andy Smith

我想要它，所以如果您输入`12345`文本字段，它将在同一文本字段中返回 John Smith

我已经尝试了很多mysql_queries，我不知道该发布哪一个！

我不是在寻找完整的代码，因为我并不擅长，但请指出我正确的方向！

干杯!

```
 <?php

    $mysql_host = "host"; 
    $mysql_username = "user"; 
    $mysql_password = "pass"; 
    $link = mysql_connect("$mysql_host", "$mysql_username", "$mysql_password");
    mysql_select_db("dbname",$link); 

    $pay_number=intval($_POST["pay_number"]);
    $result = mysql_query($link,"SELECT fullname from officers where paynumber=$pay_number");

    echo $result;

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:09:51.033

```
SELECT fullname from myTable where paynumber=12345 
```

这有什么难的？然后你可以在任何你喜欢的地方显示它。可以加一点 AJAX 来抓取结果并显示在同一个字段中。

**编辑：**

假设您的 HTML 表单上的字段被命名`pay_number`并且表单方法是`POST`

然后在你的 PHP 处理代码中你可以做

```
$pay_number=intval($_POST["pay_number"]);
$query="SELECT fullname from myTable where paynumber=$pay_number"; 
```

# jquery - 新页面上的 Jquery Checkbox 过滤器

> ID：15588924
> 
> 赞同：0
> 
> 时间：2013-03-23T16:06:44.123
> 
> 标签：jquery, html, checkbox, filter

我目前正在构建一个包含大量列表的网站，每个列表都将使用多个标签进行标识。我试图在主页上创建一个复选框列表，根据用户选择的框将在新页面上显示结果。每个复选框都有一个特定的标签，每个结果可以附加多个标签。如果尝试了此站点上的所有其他复选框过滤器，但由于我的列表中有数百个项目，它们都不起作用，或者它们显示在主页上并溢出网站设计的边界。

有没有人看到可以帮助我的代码。

我试图做的最好的例子就是这个网站[。](http://www.animenewsnetwork.com/encyclopedia/search/genre)

提前感谢您的任何意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T16:59:31.923

将“标签”放在查询字符串上并在下一页中检索它们。

```
<input id="cb1" type="checkbox" name="category" value="Drama" /><label  for="cb1">Drama</label><br />
<input id="cb2" type="checkbox" name="category" value="Horror"/><label  for="cb2">Horror</label><br />
<input id="cb3" type="checkbox" name="category" value="Comedy"/><label  for="cb3">Comedy</label><br />
<input id="cb4" type="checkbox" name="category" value="Action"/><label  for="cb4">Action</label><br />     

<script type="text/javascript">
    search = function () {
        var categories = new Array();
        $.each($("input[name='category']:checked"), function () {
            categories.push($(this).val());
        });     
        window.location.href = "./search?category=" + categories;
    }       
</script> 
```

# asp.net-mvc - MVC 4 / Razor 通俗地说

> ID：15588925
> 
> 赞同：0
> 
> 时间：2013-03-23T16:06:52.833
> 
> 标签：asp.net-mvc, razor

如果这是一个愚蠢或明显的问题，我很抱歉，但我花了一周的大部分时间进行研究，我真的找不到任何资源来解释 MVC 4 和 Razor 是什么，以及它们的目的是什么做网页开发。我不一定要求提供非常详细的描述，甚至是指向网站的链接或通过引用我也从未使用过的其他技术来解释 MVC 4 的书名。我浏览了从 MSDN 到研究生论文的所有文章、文章和教程，但我就是不明白。

我知道设计模式是什么 MVC，但我无法直接回答的主要问题之一是 MVC 模式和 MVC 4 框架之间的区别。作为一名网络开发人员，我是否必须更改或使用框架，或者它是否应该“远离你的方式”（引用另一篇 SO 帖子。）它是由 VS 生成的吗？我永远不用碰？

再说一次，如果这很明显，我很抱歉，也许我想让这比实际情况更复杂。我一直在寻找的是一个直截了当的答案，其中包含不会进一步矛盾或复杂化的具体示例。

拜托......我在我的智慧在这里结束。我的最后一个问题显然太含糊，被否决并关闭，所以我试图更具体，但我的部分问题是什么是正确的问题要问。如果有什么可以说的澄清，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T21:04:03.567

我当然不想让你气馁，就像你现在看起来一样，但在我看来，如果你不能对 MVC 上已经存在的大量材料做出头或尾，那么也许你就是只是还没准备好。没关系——事实上微软认识到 MVC 很复杂，这就是他们引入[ASP.NET 网页框架](http://www.asp.net/web-pages)的原因（这就是产生 Razor 语法的原因）。

我的建议是点击链接并下载 WebMatrix。然后遵循一些网页教程。这样一来，您就可以了解 Razor，而暂时不必过多担心 MVC。

顺便说一句，ASP.NET MVC 是一个 Web 开发框架，使您能够基于 MVC 模式构建 Web 应用程序。您需要了解 MVC 的工作原理才能使用该框架。你需要了解什么是模型，什么是视图，以及控制器在整个事情中扮演的角色。

该框架本身不是 MVC 的示例。

Razor 是一种模板语法，允许您将 C#（或 VB）与 HTML 混合，以在 MVC 中的视图或网页框架中的页面中输出动态内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T08:53:12.163

我知道这可能看起来令人困惑，但在我看来，你把事情复杂化了。

简单的事情是 MVC 是一种设计模式。也就是说，它是一个抽象的东西.. 一种哲学。这不是具体的事情。设计模式只是为您提供了该模式应该如何工作的描述，虽然它可能会为您提供示例实现，但通常它将实现由您决定。

ASP.NET MVC（无论哪个版本）是一个以 MVC 模式为基础的特定应用程序框架。换句话说，它是 MVC 设计模式的具体实现。

事实上，ASP.NET MVC 实现甚至不是 MVC 设计模式的“真正”实现，因为必须做出某些妥协才能使其在基于 Web 的模型中工作。所以它真的更像是“受 MVC 设计模式启发”。

你多虑了。只需接受 ASP.NET MVC 是一个实现 MVC 设计模式的框架库。

至于 Razor，它只是一个模板库。也就是说，它允许您将页面布局定义为文本，并在特定位置（占位符）插入值。它还允许在渲染模板的过程中执行代码，尽管在 MVC 中不鼓励这样做，除非是非常简单的情况。

Razor 也用于 ASP.NET WebPages 技术，在这些情况下，它往往更像 PHP 或经典 asp，因为所有代码都存在于模板本身的代码块中。ASP.NET 和 WebPages 都使用 Razor 模板引擎（也称为视图引擎），但它们以不同的方式使用它们。

# python - 通过单击按钮在 python 3 和 tkinter 中的新窗口

> ID：15588926
> 
> 赞同：0
> 
> 时间：2013-03-23T16:06:54.077
> 
> 标签：python, button, tkinter

这是我现在制作的程序，但我有问题......当我点击按钮1然后打开新窗口时我该怎么做

```
import sys
from tkinter import *
import tkinter as tk

def mhello1():
    mlabel = Label(mGui, text='A1').pack()
def mhello2():
    mlabel = Label(mGui, text='A2').pack()
def mhello3():
    mlabel = Label(mGui, text='A3').pack()
def mhello4():
    mlabel
    return
def mAbout():
    messagebox.showinfo(title="About",message="program")
    return
def mQuit():
    mExit = messagebox.askyesno(title="Quit",message="y/n")
    if mExit > 0:
      mGui.destroy()
      return

mGui = Tk()

mGui.geometry('450x450+200+200')
mGui.title('program')
mGui.configure(bg='gray')

mlabel = Label(text='option:',fg='red',bg = 'blue').pack()

mbutton1 = Button(mGui,text ='Button1',command = mhello1, height=5, width=20).pack()
mbutton2 = Button(mGui,text ='Button2',command = mhello2, height=5, width=20).pack()
mbutton3 = Button(mGui,text ='Button3',command = mhello3, height=5, width=20).pack()
mbutton4 = Button(mGui,text ='Button4',command = mhello4, height=5, width=20).pack()
mlabel2 = Label(text='activity:',fg='red',bg = 'blue').pack()

menubar=Menu(mGui)
filemenu = Menu(menubar, tearoff = 0)
filemenu.add_command(label="qwer")
filemenu.add_command(label="quit",command = mQuit)
menubar.add_cascade(label="more options",menu=filemenu)

helpmenu = Menu(menubar, tearoff = 0)
helpmenu.add_command(label="Help Docs")
helpmenu.add_command(label="About", command = mAbout)
menubar.add_cascade(label="help",menu=helpmenu)
mGui.config(menu=menubar)

mGui.mainloop() 
```

我尝试了这个程序，但它不起作用： [Python 3 and tkinter opens new window by click the button](https://stackoverflow.com/questions/15008359/python-3-and-tkinter-opening-new-window-by-clicking-the-button)

有没有办法不使用 tkinter 顶层？

Tnx 很多 :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T17:14:47.257

由于您应该只创建一个根窗口，因此您必须使用[Toplevel](http://infohost.nmt.edu/tcc/help/pubs/tkinter/web/toplevel.html)来打开一个新窗口。

```
def mhello1():
    toplevel = Toplevel()
    toplevel.title('Another window')
    toplevel.focus_set() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-05T17:17:08.073

如果您想使用消息框，请使用下面的那些行

```
from tkinter import *
from tkinter import messagebox 
```

# css - CSS: :hover 和同级选择器

> ID：15588929
> 
> 赞同：1
> 
> 时间：2013-03-23T16:07:13.787
> 
> 标签：css, css-selectors

我有一个案例，我的设计要求我声明这个类：

```
.panel {
  position: fixed;
  top: 100vh; 
  height: 90vh;
  margin: 0px;
  padding: 0px;
  width: 100%;
  transition-property: top;
  transition-duration: 1s;
}

.panel:before {
  background-color: inherit;
  top: -1.5em;
  width: 10em;
  text-align: center;
  font-weight: bold;
  content: attr(id);
  position: absolute;
  border-bottom: none;
  border: .5em solid black;
  border-top-color: inherit;
  border-left-color: inherit;
  border-right-color: inherit;
  border-bottom: none;
  border-radius: 25%;
  border-bottom-right-radius: 0%;
  border-bottom-left-radius: 0%;
} 
```

简而言之，面板是通过`<a href="panel id">foo</a>`样式链接定位时飞入的选项卡。

在其默认状态下，面板位于屏幕底部，这会创建一行隐藏的面板对象，其之前的面板对象显示为屏幕底部的选项卡。

这些面板的 HTML 是`<section id="about" class="panel color">...</section>`（其中颜色类目前有效地呈现，但将升级以反映特定的选项卡用途。

因此，我要解决的挑战是状态栏会阻止感觉错误的面板选项卡，我相信解决方案是在悬停任何链接时将它们稍微提高一点（3 或 4 VH）。这保留了状态栏的完整性、链接的完整性和网站的外观；将状态栏视为调整窗口大小。

我曾相信这`a:hover ~ * .panel { top: 97vh; }`是执行此操作的正确解决方案，但它似乎并没有被解雇。

# for-loop - 如何遍历Windows批处理文件中的指定子文件夹？

> ID：15588931
> 
> 赞同：1
> 
> 时间：2013-03-23T16:07:21.393
> 
> 标签：for-loop, batch-file, cmd

这是我的文件夹层次结构：

[Numbers]
[Numbers/12545]
[Numbers/12545/dev]
[Numbers/12545/prod]

[编号/32445]
[编号/32445/dev]
[编号/32445/prod]

...

[数字/.....]
[数字/...../dev]
[数字/...../prod]

我想在仅有的“[Numbers/...../dev]”文件夹下复制一些文本文件。我应该怎么做？我尝试了下面的代码，但它不起作用，因为它复制到所有子文件夹下。

```
for /r %NUMBER_DIRS% %%d in (.) do (
    copy %PROJECT_INPUTS%\*.txt "%%d"
) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:22:48.803

试试这个：

```
for /d /r "%NUMBER_DIRS%" %%d in (*DEV) do copy "%PROJECT_INPUTS%\*.txt" "%%~d\*.txt" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:31:42.243

```
@ECHO OFF
SETLOCAL
FOR /f "delims=" %%i IN (
  'dir /s /b /a:d "\numbers" ^| findstr /i /e "\dev"'
  ) do ECHO COPY %PROJECT_INPUTS%\*.txt "%%i\" 
```

这将报告批处理**建议**做什么。删除`ECHO`之前的关键字`COPY`以执行复制。

`/y`注意：如果要**覆盖**目标目录中的现有文件，可能需要添加到复制选项。

我假设您正在**从** `%PROJECT_INPUTS%` **多个**目录复制`...\dev`。

# python - 无法获取 Python 图像库以找到 JPEG 支持

> ID：15588936
> 
> 赞同：1
> 
> 时间：2013-03-23T16:07:52.493
> 
> 标签：python, python-2.7, python-imaging-library, libjpeg

这是在山狮（OSX 10.8.3）上。所以我下载、构建和安装了各种所需的库。我修改了 setup.py 以引用正确的位置...

```
TCL_ROOT = libinclude("/usr")
JPEG_ROOT = libinclude("/usr/local")
ZLIB_ROOT = libinclude("/usr")
FREETYPE_ROOT = libinclude("/usr/local")
LCMS_ROOT = libinclude("/usr/local") 
```

并且运行 setup.py 似乎工作......

```
airguitar:Imaging-1.1.7 chuck 597$ python setup.py build_ext -i
running build_ext
--- using frameworks at /System/Library/Frameworks
--------------------------------------------------------------------
PIL 1.1.7 SETUP SUMMARY
--------------------------------------------------------------------
version       1.1.7
platform      darwin 2.7.2 (default, Oct 11 2012, 20:14:37)
              [GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)]
--------------------------------------------------------------------
--- TKINTER support available
--- JPEG support available
--- ZLIB (PNG/ZIP) support available
--- FREETYPE2 support available
--- LITTLECMS support available
--------------------------------------------------------------------
To check the build, run the selftest.py script. 
```

在这之后我成功地跑了`sudo python setup.py install`。但是当我运行自检时，我得到...

```
airguitar:Imaging-1.1.7 chuck 600$ python selftest.py 
--------------------------------------------------------------------
PIL 1.1.7 TEST SUMMARY 
--------------------------------------------------------------------
Python modules loaded from ./PIL
Binary modules loaded from ./PIL
--------------------------------------------------------------------
--- PIL CORE support ok
--- TKINTER support ok
*** JPEG support not installed
--- ZLIB (PNG/ZIP) support ok
--- FREETYPE2 support ok
--- LITTLECMS support ok
--------------------------------------------------------------------
Running selftest:
*****************************************************************
Failure in example:
try:
 _info(Image.open(os.path.join(ROOT, "Images/lena.jpg")))
except IOError, v:
 print v
from line #24 of selftest.testimage
Expected: ('JPEG', 'RGB', (128, 128))
Got: decoder jpeg not available
1 items had failures:
   1 of  57 in selftest.testimage
***Test Failed*** 1 failures.
*** 1 tests of 57 failed. 
```

请注意，自检声称我没有安装 JPEG 支持。

建议？

**更新：它变得更糟......**

我怀疑问题可能是在我知道我必须构建自己的 JPEG 和其他库之前，我已经运行了设置。所以我试图从一个干净的 PIL 发行版重新开始。现在，当我跑步时，`python setup.py build`我最终得到...

```
clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe -DHAVE_LIBJPEG -DHAVE_LIBZ -I/System/Library/Frameworks/Tcl.framework/Headers -I/System/Library/Frameworks/Tk.framework/Headers -I/usr/local/include/freetype2 -IlibImaging -I/System/Library/Frameworks/Python.framework/Versions/2.7/include -I/usr/include -I/usr/local/include -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c libImaging/JpegDecode.c -o build/temp.macosx-10.8-intel-2.7/libImaging/JpegDecode.o
clang: warning: argument unused during compilation: '-mno-fused-madd'
libImaging/JpegDecode.c:118:1: error: conflicting types for 'ImagingJpegDecode'
ImagingJpegDecode(Imaging im, ImagingCodecState state, UINT8* buf, int bytes)
^
libImaging/Imaging.h:415:12: note: previous declaration is here
extern int ImagingJpegDecode(Imaging im, ImagingCodecState state,
           ^
libImaging/JpegDecode.c:145:41: warning: incompatible pointer types assigning to
      'const JOCTET *' (aka 'const char *') from 'UINT8 *' (aka 'short *')
      [-Wincompatible-pointer-types]
    context->source.pub.next_input_byte = buf;
                                        ^ ~~~
libImaging/JpegDecode.c:151:49: error: 'const JOCTET *' (aka 'const char *') and
      'UINT8 *' (aka 'short *') are not pointers to compatible types
            return context->source.pub.next_input_byte - buf; 
                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~
libImaging/JpegDecode.c:235:21: warning: incompatible pointer types passing
      'UINT8 *' (aka 'short *') to parameter of type 'unsigned char *'
      [-Wincompatible-pointer-types]
            state->shuffle((UINT8*) im->image[state->y + state->yoff] +
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
libImaging/JpegDecode.c:262:48: error: 'const JOCTET *' (aka 'const char *') and
      'UINT8 *' (aka 'short *') are not pointers to compatible types
    return context->source.pub.next_input_byte - buf; 
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~
2 warnings and 3 errors generated.
error: command 'clang' failed with exit status 1 
```

我不知道如何配置它来做“正确的事情”。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:25:17.107

从这里安装 - [http://ethan.tira-thompson.com/Mac_OS_X_Ports.html](http://ethan.tira-thompson.com/Mac_OS_X_Ports.html)

重新安装 PIL

# django - Django+gunicorn+nginx上传大文件502错误

> ID：15588938
> 
> 赞同：7
> 
> 时间：2013-03-23T16:08:18.380
> 
> 标签：django, nginx, gunicorn

# 问题

上传 1-2mb 文件可以正常工作。当我尝试上传 16mb 文件时，几秒钟后出现 502 错误

更详细：

1.  我点击“上传”
2.  谷歌浏览器上传文件（左下角上传状态从 0% 变为 100%）
3.  状态更改为“等待主机”，其中主机是我的站点主机名
4.  半分钟后服务器返回“502 Bad Gateway”

### 我的观点：

```
def upload(request):
    if request.method == 'POST':
        f = File(data=request.FILES['file'])
        f.save()
        return redirect(reverse(display),  f.id)
    else:
        return render('filehosting_upload.html', request) 
```

render(template, request [,data]) 是我自己处理一些 ajax 东西的速记；

`filehosting_upload.html`：_

```
{% extends "base.html" %}
{% block content %}
    <h2>File upload</h2>
    <form action="{% url nexus.filehosting.views.upload %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="file" name="file">
        <button type="submit" class="btn">Upload</button>
    </form>
{% endblock %} 
```

# 日志和规格

我在日志中找不到任何信息。

版本：

*   Django==1.4.2
*   Nginx==1.2.1
*   独角兽==0.17.2

命令行参数

```
command=/var/www/ernado/data/envs/PROJECT_NAME/bin/gunicorn -b localhost:8801 -w 4 PROJECT_NAME:application 
```

相关位置的 Nginx 配置：

```
 location /files/upload {
    client_max_body_size 100m;
    proxy_pass http://HOST;
    proxy_connect_timeout 300s;
    proxy_read_timeout 300s;
   } 
```

### Nginx 日志条目（更改了 MY_IP 和 HOST）

```
2013/03/23 19:31:06 [error] 12701#0: *88 upstream prematurely closed connection while reading response header from upstream, client: MY_IP, server: HOST, request: "POST /files/upload HTTP/1.1", upstream: "http://127.0.0.1:8801/files/upload", host: "HOST", referrer: "http://HOST/files/upload" 
```

### Django 日志

```
2013-03-23 19:31:06 [12634] [CRITICAL] WORKER TIMEOUT (pid:12829)
2013-03-23 19:31:06 [12634] [CRITICAL] WORKER TIMEOUT (pid:12829)
2013-03-23 19:31:06 [13854] [INFO] Booting worker with pid: 13854 
```

# 问题）

1.  如何解决？
2.  没有nginx上传模块可以解决这个问题吗？

**更新 1** 尝试了建议的配置

```
 gunicorn --workers=3 --worker-class=tornado  --timeout=90 --graceful-timeout=10 --log-level=DEBUG --bind localhost:8801 --debug 
```

现在对我来说很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T19:05:58.700

我使用该参数运行我的 gunicorn，尝试：

```
python manage.py run_gunicorn --workers=3 --worker-class=tornado  --timeout=90 --graceful-timeout=10 --log-level=DEBUG --bind 127.0.0.1:8151 --debug 
```

或者如果您以不同的方式运行，您可以使用该选项运行

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-10T16:32:49.437

对于大文件处理，您应该使用**worker-class**。我在 python 3.7 中使用 gevent 时也遇到了一些麻烦，最好使用 3.6。

**Django，Python 3.6 示例：**

*安装*：

```
pip install gevent 
```

*跑*

```
gunicorn --chdir myApp myApp.wsgi --workers 4 --worker-class=gevent --bind 0.0.0.0:80 --timeout=90 --graceful-timeout=10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-07T10:31:53.073

您需要使用其他工作类型类，如**gevent**或**tornado**之类的异步类，请参阅此以获得更多解释：第一个解释：

> 如果您希望您的应用程序代码在请求处理期间可能需要长时间暂停，您可能还需要安装 Eventlet 或 Gevent

第二个 ：

> 默认同步工作程序假定您的应用程序在 CPU 和网络带宽方面是资源受限的。一般来说，这意味着您的应用程序不应该做任何花费未定义时间的事情。例如，对 Internet 的请求符合此标准。在某些时候，外部网络会出现故障，导致客户端堆积在您的服务器上。

# fancybox - Fancybox 问题，不应该显示某些东西，但是

> ID：15588941
> 
> 赞同：-1
> 
> 时间：2013-03-23T16:08:37.493
> 
> 标签：fancybox

我试图重新做一些事情，试图获得工作代码，然后在我得到一些工作后用我需要的东西来修改它。问题是，我试图复制 Fancybox 的 #5 示例，并且 titleshow 设置为 false，但标题显示，以及 #login_error 应该是隐藏的，但它从一开始就显示。

```
<html>
<head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="/fancybox/jquery.mousewheel-3.0.2.pack.js"></script>
    <script type="text/javascript" src="/fancybox/jquery.fancybox-1.3.1.js"></script>
    <link rel="stylesheet" type="text/css" href="/fancybox/jquery.fancybox-1.3.1.css" media="screen" />
</head>

<script type="text/javascript">
$(document).ready(function() {
        $("#tip5").fancybox();
});

$("#tip5").fancybox({
    'scrolling'     : 'no',
    'titleShow'     : false,
    'onClosed'      : function() {
        $("#login_error").hide();
    }
});

$("#login_form").bind("submit", function() {

    if ($("#login_name").val().length < 1 || $("#login_pass").val().length < 1) {
        $("#login_error").show();
        $.fancybox.resize();
        return false;
    }

    $.fancybox.showActivity();

    $.ajax({
        type        : "POST",
        cache   : false,
        url     : "/data/login.php",
        data        : $(this).serializeArray(),
        success: function(data) {
            $.fancybox(data);
        }
    });

    return false;
});
</script>
</head>
<body>

<div>
    <a id="tip5" title="Login" href="#login_form">Login</a>
</div>

<div style="display:none">
    <form id="login_form" method="post" action="">
        <p id="login_error">Please, enter data</p>
        <p>
            <label for="login_name">Login: </label>
            <input type="text" id="login_name" name="login_name" size="30" />
        </p>
        <p>
            <label for="login_pass">Password: </label>

            <input type="password" id="login_pass" name="login_pass" size="30" />
        </p>
        <p>
            <input type="submit" value="Login" />
        </p>
    </form>
</div>

</body>
</html> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T20:26:04.410

[这里](http://www.picssel.com/playground/jquery/loginFormV2_02jul12.html)的演示解决了这个问题。它产生了另一个问题，但那是另一个问题。我相信那是你的演示，JFK，所以谢谢你。

# reflection - 反射看不到类型提供程序

> ID：15588942
> 
> 赞同：1
> 
> 时间：2013-03-23T16:08:45.307
> 
> 标签：reflection, f#, type-providers, f#-3.0

我正在尝试编写我的第一个类型提供程序，并且想知道是否有人可以指出我哪里出错了。

我已经使用了 freebase 示例来工作。我试图筛选必要的部分来获得一些非常基本的实例化，但显然错过了一些东西或者没有把它完全正确（可能与命名空间有关）。我只是想让这条线正常工作

```
type tp = MyFirstTypeProvider.DataProvider<username="username",password="password",product=prodId> 
```

Intellisense 正在查看 DataProvider，但我有点曲折地说，可以找到对该类型的引用，但在程序集中找不到该类型。

```
namespace MyFirstProvider

type internal MyFirstRuntimeInfo(config: TypeProviderConfig) =
    let runtimeAssembly = Assembly.LoadFrom(config.RuntimeAssembly)

    member val DataContextType = runtimeAssembly.GetType("MyFirstProvider.Runtime.DataContext")
    member this.RuntimeAssembly = runtimeAssembly

// This type defines the type provider. When compiled to a DLL, it can be added
// as a reference to an F# command-line compilation, script, or project.
[<TypeProvider>]
type public Types(config: TypeProviderConfig) as this = 
    inherit TypeProviderForNamespaces()

    let bfRuntimeInfo = MyFirstRuntimeInfo(config)

    let rootNamespace = "MyFirstProvider"

    let defaultUsername = "xxxxxxxxxxx"
    let defaultPassword = "yyyyyyyyyy"
    let defaultProductId = -1    
    let defaultToken = "none"

    let createDataContext = bfRuntimeInfo.DataContextType.GetMethod("_Create")

    let createTypes(username, password, productId, rootTypeName) =                       let bf  = new MyFirstProvider.Requests.Queries(defaultToken)
    let schema = new MyFirstProvider.Schema.SchemaConnection(bf)
    let rootType = ProvidedTypeDefinition(bfRuntimeInfo.RuntimeAssembly,rootNamespace,rootTypeName,baseType=Some typeof<obj>, HideObjectMethods=true)
    let theServiceType = ProvidedTypeDefinition("Service",baseType=Some bfRuntimeInfo.DataContextType, HideObjectMethods=true)
    let theServiceTypesClass = ProvidedTypeDefinition("ServiceTypes",baseType=Some typeof<obj>,HideObjectMethods=true)   
    theServiceTypesClass.AddMembers [ theServiceType ]     
    rootType.AddMembers [ theServiceTypesClass  ]
    rootType.AddMembersDelayed (fun () -> 
        [ yield ProvidedMethod ("GetDataContext", [], theServiceType, IsStaticMethod=true,
                                InvokeCode = (fun _args -> Expr.Call(createDataContext, [  Expr.Value defaultUsername; Expr.Value defaultPassword; Expr.Value defaultProductId ])))
        ])        
    rootType

    let MyFirstType = createTypes(defaultUsername, defaultPassword, defaultProductId, "Data")
    let paramMyFirstType = ProvidedTypeDefinition(bfRuntimeInfo.RuntimeAssembly, rootNamespace, "DataProvider", Some(typeof<obj>), HideObjectMethods = true)
    let usernameParam = ProvidedStaticParameter("username", typeof<string>, defaultUsername)
    let passwordParam = ProvidedStaticParameter("password", typeof<string>, defaultPassword)
    let productIdParam = ProvidedStaticParameter("productId", typeof<int>, defaultProductId)

    do    paramMyFirstType.DefineStaticParameters([usernameParam;passwordParam;productIdParam], fun typeName providerArgs ->
        let username = (providerArgs.[0] :?> string)
        let password = (providerArgs.[1] :?> string)
        let productId = (providerArgs.[2] :?> int)
        createTypes(username, password, productId, typeName))

    do
        this.AddNamespace(rootNamespace, [MyFirstType ] )
        this.AddNamespace(rootNamespace, [paramMyFirstType ] )

[<assembly:TypeProviderAssembly>] 
do() 
```

提前很多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T18:46:00.110

当我尝试编译您的类型提供程序并在脚本文件中引用它时，该引用`#r "provider.dll"`带有红色波浪线下划线，上面写着：

> 类型提供程序“MyFirstProvider.Types”报告了一个错误：类型提供程序构造函数引发了异常：对象引用未设置为对象的实例。

您可以通过启动 Visual Studio 的第二个实例并将调试器附加到另一个实例（调试 -> 附加到进程）并在正在调试的实例中打开脚本文件来调试此类错误。

在您在此处发布的示例中，空引用异常发生在此行：

```
let createDataContext = bfRuntimeInfo.DataContextType.GetMethod("_Create") 
```

这是试图访问不存在的方法。我认为 Freebase 示例是一个相对复杂的起点（这里，它使用一个对象来表示“数据上下文” - 您可能想要遵循该模式，但我认为从头开始构建它比调整现有的更容易代码）。我认为一个很好的起点可能是[Hello World 类型提供程序](http://fsharp3sample.codeplex.com/SourceControl/changeset/view/20511#195254)，它要简单得多，只显示如何生成新的类型、属性和方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T16:49:09.630

我建议，如果您正在寻找类型提供程序的简单示例，请查看[文件系统类型提供程序](https://github.com/fsharp/fsharpx/tree/master/src/FSharpx.TypeProviders.Machine)。这是一个很好的起点，因为它没有状态和依赖管理需要处理。

至于为什么这个有一个找不到的dll，我认为这是因为必须从您的类型提供者的dll所在的位置看到这个dll。也就是说，例如，在同一目录中。（您可以尝试在构建过程中设置“复制本地”吗？）

# iphone - iPhone 故事板导航

> ID：15588949
> 
> 赞同：1
> 
> 时间：2013-03-23T16:09:21.280
> 
> 标签：iphone, ios, storyboard

我是 iPhone 开发的新手。我现在已经做了几个 android 应用程序，所以我想我会在 iPhone 上试一试。

但是，我真的发现故事板导航是违反直觉的。我创建了一个基本的选项卡式应用程序，它有 2 个屏幕，两个屏幕都包含一个显示各种数据位的表格视图。当用户单击表格的单元格时，我希望它打开一个新屏幕。简单的？显然不是。

我尝试添加一个新的 viewController 并在我现有的 tableViews 之一中按住 ctrl 单击一个表格单元格，该 tableViews 从根选项卡式视图控制器链接，以将 seague 添加到新控制器。单击单元格在模拟器中无效。

我尝试将新控制器与自定义类链接，以查看这是否是我失败的地方，但即使我创建了一个继承自 UIViewController 的新 Objective-C 类，它也不会出现在下拉框中。

除非我误解了视图调用的层次结构应该如何工作？

任何帮助表示赞赏！

* * *

编辑：

好的，所以有了以下建议，我已经设法走得更远，但我还没有完全做到。我为每个选项卡视图选项添加了导航控制器。然后我 ctrl 单击单元格行以链接到我的新 webview 控制器，选择要推送的选择 seague 集。我 ctrl-clicked webview 到它的控制器，使其成为一个出口委托，并将以下代码添加到该行：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    if (_webViewController == nil)
    {
        self.webViewController = [[[RSSWebViewController alloc]     initWithNibName:@"WebViewController" bundle:[NSBundle mainBundle]] autorelease];
    }
    RSSEntry *entry = [_allEntries objectAtIndex:indexPath.row];
    _webViewController.entry = entry;
    [self.navigationController pushViewController:_webViewController animated:YES];
} 
```

我还补充说：

```
@property (retain, nonatomic) IBOutlet UIWebView *webView; 
```

到新的视图控制器头文件。当我在模拟器中单击一行时，它会引发以下异常：

2013-03-23 17:21:17.241 RSS[1330:c07] ***由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“无法在包中加载 NIB：'NSBundle 名称为'WebViewController'”。

感谢到目前为止的评论。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:35:56.833

您需要将 a`UINavigationController`作为链接到选项卡栏的视图控制器，然后您必须将表链接`UINavigationController`到当前控制器，并将表作为根视图控制器，然后将单元格链接到另一个视图控制器，并使用 push segue。因此，每个选项卡都有一个导航控制器。导航控制器使它能够“推送”，否则什么也不会发生，因为它管理视图控制器的堆栈，因为它们被推送和弹出以及执行它们所需的动画。我开始的时候也遇到了这个问题。

除非您的单元格都是静态的，否则您可能需要将信息从当前视图控制器传输到新视图控制器，例如选择了哪个项目，以便您可以告诉下一个视图控制器要显示什么。这样做的一种方法是让下一个视图控制器成为具有属性的自定义类：`@property (strong, nonatomic) NSString* message;`然后在具有推送 segue 的视图控制器中，现在可以在下一个视图控制器被推送之前告诉它。

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.identifier isEqualToString:@"your-segue-name"]) // The identifier in the Storyboard for segue (click on the segue)
    {
        // Sender will be cell
        NSString* message = [NSString stringWithFormat:@"cell %d!", [[self.tableView indexPathForCell:sender] row]];
        YourViewControllerClass* destination = [segue destinationViewController];                                                 
        destination.message = message;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:41:37.513

要按照您的建议进行操作，您将**不会**从单元格中按 ctrl+单击。

你需要设置 UITableViewDelegate。

请参阅[https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40006942](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40006942)

然后，正如上面 Mike D 所说，您需要使用 didSelectRowAtIndexPath。

这应该为您指明正确的方向。当我在我的电脑上（现在在电话上）时，我会回来检查，如果你的问题没有解决，我可以更深入地解释。

# ruby-on-rails - Sunspot 和 Solr：搜索中类似于 Google 的“站点：”

> ID：15588952
> 
> 赞同：0
> 
> 时间：2013-03-23T16:09:44.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3, solr, sunspot

我对 Sunspot 和 Solr 还很陌生。

我想在搜索中实现类似于谷歌`site:`短语的东西，这样当我搜索

> 某物

我得到与“某事”相关的所有记录。但是，如果他们搜索

> 某事网站：example.com

它只显示`site`属性为的结果`example.com`。

目前我有：

```
searchable do
    text :full_text
    text :title, :boost => 5
    text :excerpt
end 
```

我需要索引`site`属性吗？我将如何实现上述想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:14:49.560

不，只要确保你 gsub 你的 params[:query] 在你的控制器中。提取 site: 旁边的值并添加一个 where close 以匹配该站点。你会留下来`something`。

# php - PHPMyAdmin 单点登录身份验证无限重定向循环

> ID：15588959
> 
> 赞同：1
> 
> 时间：2013-03-23T16:10:23.220
> 
> 标签：php, mysql, nginx, phpmyadmin, debian

我正在尝试使用 phpmyadmin 为控制面板创建单点登录平台。我已经准备好教程和相关文档。我安装了 phpmyadmin 并更改了配置文件和登录脚本，如下所示：

配置.inc.php：

```
<?php
$i = 0;
$i++;
$cfg['Servers'][$i]['extension']     = 'mysql';
$cfg['Servers'][$i]['auth_type']     = 'signon';
$cfg['Servers'][$i]['SignonSession'] = 'TEST';
$cfg['Servers'][$i]['SignonURL']     = 'pma.php';
?> 
```

pma.php：

```
<?php
session_set_cookie_params(0, '/', '', 0);
session_name('TEST');
session_start();
$_SESSION['PMA_single_signon_user'] = 'root';
$_SESSION['PMA_single_signon_password'] = 'ROOTPASSWORDHERE';
$_SESSION['PMA_single_signon_host'] = 'localhost';
session_write_close();
header('Location: ./index.php?server=1');
?> 
```

不幸的是，当在我的浏览器中访问 phpmyadmin URL 时，它会在 pma.php 和 index.php 之间自动循环，但实际上从未真正登录到 phpmyadmin。Firefox 最终捕获并停止它“Firefox 检测到服务器正在以永远不会完成的方式重定向该地址的请求。”

关于我的设置的一些细节：

为此，我在 debian 6 上使用 nginx 和 php5-fpm。我使用 apt-get 安装 phpmyadmin，安装后我为它创建了一个有效的 nginx 配置。然后我通过手动输入root用户名和密码来测试phpmyadmin，它工作正常。

这只是一个测试，因此我不会只对连接到服务器的任何人进行“自动身份验证”，我只是想让它工作，所以我已经尽可能多地从 pma.php 脚本中剥离出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T18:25:10.617

要停止重定向，建议将 pma.php 的代码更改为

```
 <?php
         session_set_cookie_params(0, '/', '', 0);
         session_name('TEST');
         session_start();
         $_SESSION['PMA_single_signon_user'] = 'root';
         $_SESSION['PMA_single_signon_password'] = 'ROOTPASSWORDHERE';
         $_SESSION['PMA_single_signon_host'] = 'localhost';
         session_write_close();

         if( !isset($_GET[server])){
            header('Location: ./index.php?server=1');
         }

    ?> 
```

# java - Java中Tries的迭代器

> ID：15588960
> 
> 赞同：0
> 
> 时间：2013-03-23T16:10:41.470
> 
> 标签：java, iterator, trie

我目前正在尝试为整数元组实现 trie 数据结构。并实施如下：

```
import java.util.ArrayList;

public class TrieNode {

int num;
ArrayList<TrieNode> links;
boolean endOfTuple;

public TrieNode(int num)
{
    this.num = num;
    links = new ArrayList<TrieNode>();
    this.endOfTuple = false;
}

} 
```

然后我有一个 trie 类，如下所示：

```
public class Trie {

TrieNode root;

public Trie() {
    root = new TrieNode(-1);
}
public void insertTuple(int[] tuple)
{
    int l = tuple.length;

    TrieNode curNode = root;

    for (int i = 0; i < l; i++)
    {
        TrieNode node = new TrieNode(tuple[i]);

        if(!curNode.links.contains(node)){
            curNode.links.add(node);
        }
        curNode = curNode.links.get(curNode.links.indexOf(node));
    }
    curNode.endOfTuple = true;  
}
} 
```

我可以向这个 trie 添加值，但我需要能够迭代这个并且想知道我怎么能做到这一点？例如，如果我想使用迭代器打印树......任何帮助都会很棒......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:35:51.133

交互器只需要实现`Iterator`接口，只需要提供`boolean hasNext()`和`Integer next()`. 所以要问的问题是：如何在你的 trie 中表示一个位置，以便（a）获取与该位置关联的值，以及（b）在给定当前位置的情况下找出“下一个”位置？

我将避免发布实际的解决方案，因为我不确定这是否是家庭作业。但是请考虑：您可以通过选择特定的 trie 节点以及您用来到达它的 trie 节点的路径来表示您的 trie 中的“当前位置”。然后你可以递归地计算“下一个”元素：如果当前元素是一个有子节点的节点，那么找到第一个子`endOfTuple`节点`true`。如果当前元素没有子元素，则转到其父元素并前进到该父元素的下一个子元素。如果那个父母没有下一个孩子，那就去它*父母*的下一个孩子，等等。

# windows - Windows TCP 套接字接收延迟

> ID：15588961
> 
> 赞同：4
> 
> 时间：2013-03-23T16:10:54.860
> 
> 标签：windows, sockets, tcp

外部控制器每 30 毫秒通过 TCP/IP 套接字发送 120 字节的消息。应用程序通过标准 tcp/ip socket recv 函数接收此消息。它在 Linux 和 OSX 下完美运行（recv 每 30 毫秒返回 120 字节的消息）。在 Windows 下，recv 大约每 1 秒返回约 3500 字节的缓冲区。其余时间返回 0。Windows 下的 Wireshark 显示消息确实每 30 毫秒发送一次。

如何使 windows tcp 套接字正常工作（无延迟）？

PS：我已经玩过 TCP_NODELAY 和 TcpAckFrequency 了。Wireshark 显示一切正常。所以我认为这是一些 Windows 优化，应该关闭。

阅读 -

```
int WMaster::DataRead(void)
{
if (!open_ok)  return 0;
if (!CheckSocket())
{
    PrintErrNo();
    return 0;
}
iResult = recv(ConnectSocket, (char *)input_buff,sizeof(input_buff),0);

nError=WSAGetLastError();
if(nError==0) return iResult;
if(nError==WSAEWOULDBLOCK) return iResult;

PrintErrNo();
return 0;
} 
```

初始化-

```
ConnectSocket = INVALID_SOCKET;

iResult = WSAStartup(MAKEWORD(2,2), &wsaData);
ConnectSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
ZeroMemory(&clientService, sizeof(clientService));
clientService.sin_family = AF_INET;
clientService.sin_addr.s_addr = inet_addr( deviceName.toLatin1().constData() );
clientService.sin_port = htons( port);

iResult = setsockopt(ConnectSocket, IPPROTO_TCP, TCP_NODELAY, (char *) &flag, 
sizeof (int));

u_long iMode=1;
iResult=ioctlsocket(ConnectSocket,FIONBIO,&iMode);

iResult = ::connect( ConnectSocket, (SOCKADDR*) &clientService, 
sizeof(clientService) ); 
```

CheckSocket -

```
bool WMaster::CheckSocket(void)
{
socklen_t len = sizeof (int);
int retval = getsockopt (ConnectSocket, SOL_SOCKET, SO_ERROR, (char*)(&valopt), &len );
if (retval!=0)
{
   open_ok=false;
   return false;
};
return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:12:02.130

考虑禁用 Nagle 算法。120 字节非常小，数据在发送之前可能会被缓冲。我认为是 Nagle 算法的另一个原因是大约 33 次发送应该在 1 秒内发生。这与`33*120 = 3960 bytes / sec`您看到的 3500 非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:09:44.700

如下更改您的 dataread 函数，以便仅在出现错误时调用 WSAGetLastError。

```
int WMaster::DataRead(void)
{
  if (!open_ok)  return 0;
  if (!CheckSocket())
  {
      PrintErrNo();
      return 0;
  }
  iResult = recv(ConnectSocket, (char *)input_buff,sizeof(input_buff),0);
  if(iResult >= 0)
  {
      return iResult;
  }

  nError=WSAGetLastError();
  if(nError==WSAEWOULDBLOCK) return iResult;

   PrintErrNo();
   return 0;
} 
```

您每毫秒轮询一次套接字的事实可能与您的性能问题有关。但我想在得出问题之前先看看 CheckSocket 的来源。

# vim - 代码和行号之间的 Vim 行

> ID：15588962
> 
> 赞同：3
> 
> 时间：2013-03-23T16:11:04.013
> 
> 标签：vim

这似乎是一个简单的问题，但我可能已经花了几个小时寻找这个无济于事。如何在 Vim 中的行号右侧创建彩色线条？像这样：

![在此处输入图像描述](../Images/ca19c1a4ce782165680ad23fbd2ac96a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T16:18:05.023

不确定这条线，但您可以更改前景色以添加一些对比度。

从[http://vim.wikia.com/wiki/Display_line_numbers](http://vim.wikia.com/wiki/Display_line_numbers)：

您可以更改用于行号的颜色。例如：

```
:highlight LineNr term=bold cterm=NONE ctermfg=DarkGrey ctermbg=NONE gui=NONE guifg=DarkGrey guibg=NONE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T19:25:25.353

不幸的是，你不能在那里添加一行：没有选择，我相信，没有破解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T19:59:50.577

您需要为此更改 Vim 源代码。不过，这样的补丁不太可能包含在 Vim 中，因为 Vim 的设计原则之一是它的功能应该在所有平台上都可用，任何不适合字符光栅的东西都不能在控制台中实现。（甚至解决方法也需要特殊的 Unicode 字符来模拟这样的一行。）

不幸的是，您无法使用内置功能破解类似的内容：*符号列*和*折叠列*都显示在数字列的左侧。这种视觉上的区别对你来说真的那么重要吗？！

# git - 在 GitHub 上与朋友一起工作

> ID：15588963
> 
> 赞同：-1
> 
> 时间：2013-03-23T16:11:07.423
> 
> 标签：git, github

我想和朋友在 GitHub 上开始一个项目。我们都有 GitHub 应用程序、GitHub 帐户和带有项目起始文件的存储库设置。

问题是，当我们在处理项目并且每个人都在做不同的事情时，我们在尝试同步和提交文件到 repo 时开始出错。这应该怎么做？

**附言**

此外，在将文件提交到只有我正在使用的存储库时，我从我的 GitHub 客户端收到此错误：

```
 # On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#   modified:   bin/classes/fourtytwo/studios/rednet/Course.class
#   modified:   src/fourtytwo/studios/rednet/Course.java
#
no changes added to commit (use "git add" and/or "git commit -a")
 (256) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:32:32.607

就像 JB Nizet 评论的那样，你应该学习使用 git，[http](http://learn.github.com) ://learn.github.com是一个很好的资源。

即使您对 git 有了更多了解，知道如何使用 git 在很大程度上取决于您的用例，有几种模型，[git-flow](https://github.com/nvie/gitflow)是最受欢迎的模型之一。正确的模型取决于与您一起工作的人数、工作的密切程度、部署策略以及更多变量和偏好。

对于您提到的特定问题，使用两个单独的主题分支来处理可能是正确的选择，并在每个分支准备就绪后合并回集成分支，例如`master`or 。`develop`

现在，如果您和您的朋友正在做的工作密切相关并且不能/不应该分成更小的工作单元（即*不可简化的复杂性*），您可能希望在同一个分支上工作并作为一个单元紧密工作.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:37:15.280

首先，学习 git。

有多种资源可供您了解 git：

*   [http://learn.github.com/p/intro.html](http://learn.github.com/p/intro.html)
*   [http://try.github.com/levels/1/challenges/1](http://try.github.com/levels/1/challenges/1)
*   [http://gitready.com](http://gitready.com)
*   [http://www.codeschool.com/courses/try-git](http://www.codeschool.com/courses/try-git)

之后，如果您是 git 新手，您应该考虑使用适合您的工作流程的模型。GitFlow 是成功分支模型的一个示例。您可以在此处阅读有关 gitflow 的更多信息：

*   [http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

阅读这些文章将对您入门有很大帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T16:28:19.073

您应该开始使用分支。你们每个人一个分支。

# c++ - 从 Qt 中的 QGridLayout 中删除小部件？

> ID：15588965
> 
> 赞同：5
> 
> 时间：2013-03-23T16:11:14.453
> 
> 标签：c++, qt

我有一个非常基本的疑问`QGridLayout`。为了在其中添加一个小部件，`QGridLayout`我们给出`QWidget *`的应该与`row`& `column`no 一起添加（也包括其他一些参数）。现在要删除一个小部件，没有功能可以*根据行和列删除一个小部件，*例如：

```
int row, column;
gridObj->remove(row, column); 
```

我认为`QGridLayout`必须维护一种`QList`存储*Widgets & there 位置的引用*。那么为什么没有仅按位置删除小部件的功能呢？它只有 1 个删除函数，我们需要为其指定`QWidget`对象的引用。

如果这是某种限制，那么是否有解决此问题的方法？自己维护一个 QList 是一种解决方案，但它非常乏味。谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T16:31:27.303

我可能在这里弄错了，但是从浏览文档中，试试这个：

1.  获取该位置的 QLayoutItem ( **[QGridLayout::itemAtPosition](http://qt-project.org/doc/qt-4.8/qgridlayout.html#itemAtPosition) (row, column)** )。
2.  使用 QLayoutItem 获取小部件指针（**[QLayoutItem::widget](http://qt-project.org/doc/qt-4.8/qlayoutitem.html#widget) ()**）。
3.  使用小部件指针在 QGridLayout ( **[QLayout::indexOf](http://qt-project.org/doc/qt-4.8/qlayout.html#indexOf) (widgetPointer)** ) 中查找小部件的索引。
4.  使用索引从布局中获取小部件的所有权（**[QGridLayout::takeAt](http://qt-project.org/doc/qt-4.8/qgridlayout.html#takeAt) (index)**）。
5.  把它全部包装在一个方便的函数中？

我一直在重新排列布局中的小部件、从布局中删除小部件等方面遇到麻烦……通常，我只是求助于删除布局并重新添加小部件。=(

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-08T20:32:48.310

要按布局位置删除 QGridLayout 中的小部件，您可以简单地使用

```
layout->removeWidget(layout->itemAtPosition(row, column)->widget()); 
```

但是，您必须注意以下几点：

*   此代码假定布局中的指定位置实际上有一个项目。如果不是， itemAtPosition() 将返回 null。所以你需要确定这个位置，或者明确地检查它。
*   此代码将从布局中删除小部件，但不会将其删除。您必须将小部件放回不同的布局或自己给小部件一个合理的几何形状。如果您不这样做，小部件将在其当前位置保持可见。如果您希望小部件被破坏，则必须在将其从布局中删除后显式删除它。
*   此代码仅适用于布局中已添加`addWidget()`. 它不适用于使用`addLayout()`. 如果您还需要关心嵌套布局，请参阅 [我关于从网格布局中删除行和列的答案](https://stackoverflow.com/a/19256990/1070129)。

# c# - 有关系的两个列表，如何显示给用户？

> ID：15588968
> 
> 赞同：1
> 
> 时间：2013-03-23T16:11:25.847
> 
> 标签：c#

我的问题是我想制作一个使用两个列表的程序，这对我来说几乎是不可能理解的。好的，所以我想制作一个程序，您首先输入城市名称，然后输入城市的温度。这就是关系的来源。

我首先创建了一个“列表类”，如下所示：

```
class citytemp
{
    private string city;
    private double temp;

    public citytemp(string city, double temp)
    {
        this.city = city;
        this.temp = temp;
    }

    public string City
    {
        get { return city; }
        set { city = value; }
    }

    public double Temp
    {
        get { return temp; }
        set { temp = value; }
    }
} 
```

然后我像这样在程序中列出列表

```
List<citytemp> temps = new List<citytemp>(); 
```

在我看来，这一切都很好。但是当我试图向用户显示列表时，什么都没有显示。我用这些行来展示它：

```
for (int i = 0; i > temps.Count; i++)
{
    Console.WriteLine(temps[i].City, temps[i].Temp);
} 
```

顺便说一句：我通过这些行将“事物”添加到列表中：

```
temps.Add(new citytemp(tempcity, temptemp)); 
```

... where`tempcity`和`temptemp`是临时变量。它们只是为了让我更容易将它们添加到列表中，因为我正在使用`switch`语句将它们添加到列表中。

为了让事情更清楚，我的问题是我不知道我应该如何在程序中向用户显示列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:17:13.733

您的问题出在 for 循环中。改成这个

```
for (int i = 0; i < temps.Count; i++) 
```

即将大于`>`运算符更改为小于`<`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:17:34.410

您的 for 循环中有错误。

```
for (int i = 0; i > temps.Count; i++) 
```

它应该是：

```
for (int i = 0; i < temps.Count; i++) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T16:17:54.703

首先，我不确定您所说的“2 个列表”是什么意思，因为您的代码中只有一个列表。

但是，您遇到的“无显示”问题很容易解决。

这行代码：

```
for (int i = 0; i > temps.Count; i++) 
```

应如下解读：

```
i = 0;
while (i > temps.Count)
{
    ... rest of your loop body here

    i++;
} 
```

如果您阅读本文，您会注意到该`for`语句的第二部分不是*何时终止*，而是*要继续执行多长时间*。

把它改成这个，你应该很好：

```
for (int i = 0; i < temps.Count; i++)
                  ^
                  +-- changed from > 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T16:18:48.847

我认为哈希表，特别是字典会在这里为您提供帮助：

```
var cityTemps = new Dictionary<string, double>();
cityTemps.Add("TestCity", 56.4);

foreach (var kvp in cityTemps)
    Console.WriteLine("{0}, {1}", kvp.Key, kvp.Value); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-23T16:19:57.683

除了已经提到的循环之外，还要小心，`Console.WriteLine`因为它接受 a`String`作为第一个参数，它假定它是一种格式和`object[] params`作为第二个参数。当您传递`temps[i].City`给它时`String`，它会认为它的格式`temps[i].Temp`是参数并且不会正确显示。

你想要什么：

```
Console.WriteLine("City: {0} Temp: {1}", temps[i].City, temps[i].Temp); 
```

在这里，我将`"City: {0} Temp: {1}"`其用作字符串的格式和正确的参数。

这个答案是为了让您在以后想知道为什么只显示城市名称时不会头疼。

# javascript - jquery 字段的表单空白检查

> ID：15588970
> 
> 赞同：0
> 
> 时间：2013-03-23T16:11:32.767
> 
> 标签：javascript, jquery, forms

我正在构建一个函数，它将检查表单的某些字段是否为空。然后，只有在没有空字段的情况下，我才使用此功能提交表单。

我测试字段是否为空的功能：

```
 function formCompleted(form){
      form.filter(':input').each( function(){
        if( $(this).val() === "" ){
          return false;
        };
      });
    }; 
```

提交表单的功能：

```
 $('#form-id').change(function(){
      if(formCompleted($('#form-id > *'))){
        alert("Form haven't empty fields");
      }else{
        alert('Form have empty fields');
      }
    }); 
```

**问题**

formCompleted 函数似乎总是错误的，即使所有字段都已填满。该表单包含输入 (type="number") 和一个选择（带有 3 个选项）。

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:13:57.140

使用[属性选择器](http://api.jquery.com/category/selectors/attribute-selectors/)，如果空字段计数为0，则返回true，表示没有空字段。

```
function formCompleted(form){
    return form.filter(':input[value=""]').length == 0;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:18:43.020

试试这个：

```
function formCompleted(form){
  form.filter(':input').each( function(){
    if( $(this).val() === "" ){
      return false;
    };
  });
  form.filter('select').each( function(){
    if( $(this).val() === "" ){
      return false;
    };
  });
};

$('#form-id').change(function(){
  if(formCompleted($('#form-id'))){ // <----pass the form only
    alert('Form haven't empty fields');
  }else{
    alert('Form have empty fields');
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T13:41:39.237

您忘记从 中返回 true `formCompleted()`，因此它将返回 false 或什么都不返回（未定义）。

所以在你的循环之后添加一个`return true;`语句，所以如果没有元素为空，它会返回 true。

```
function formCompleted(form){
    form.filter(':input').each( function(){
        if( $(this).val() === "" ){
          return false;
        };
    });
    return true;
}; 
```

# clojure - 奇怪的意外 defrecord 行为：错误还是功能？

> ID：15588972
> 
> 赞同：4
> 
> 时间：2013-03-23T16:11:36.003
> 
> 标签：clojure

```
;; Once upon a time I opened a REPL and wrote a protocol
;; definition:
(defprotocol SomeProtocol
  (f [this]))

;; And a record:
(defrecord SomeRecord []
  SomeProtocol
  (f [this]
    "I don't do a whole lot."))

;; And a very useful side-effect free function!
(defn some-function []
  (f (SomeRecord.)))

;; I call my function...
(some-function)
;; ...to see exactly what I expect:
;; user=> "I don't do a whole lot."

;; Unsatisfied with the result, I tweak my record a little bit:
(defrecord SomeRecord []
  SomeProtocol
  (f [this]
    "I do a hell of a lot!"))

(some-function)
;; user=> "I don't do a whole lot." 
```

对我来说似乎是一个错误。在 c++ 用户组中看到这么多错误的编译器错误报告后，我无法确定。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T17:09:09.620

重新定义记录后需要重新定义`some-function`。这样做的原因是`defrecord`创建一个新类型（使用 deftype）并使用`(SomeRecord.)`函数内部的符号将代码绑定到该类型，即使在定义了具有相同名称的新类型之后也是如此。这就是为什么通常更喜欢使用`(->SomeRecord)`符号来实例化记录的原因，使用这种符号将使您的代码按预期工作。

# mobile - 使用 Web Intents 登录 Twitter Mobile 后，URL 将空格转换为加号 (%2520)

> ID：15588975
> 
> 赞同：2
> 
> 时间：2013-03-23T16:11:40.537
> 
> 标签：mobile, twitter, urlencode, url-encoding

我一直在使用 Web Intents 通过用户的默认移动设备提供简单的 Tweet 功能。但是，如果用户当前未登录移动 Twitter 并且第一次访问推文 URL，则在登录时，他们将被带到撰写页面，但预先撰写的推文 (%20) 中的所有空格都将转换为 + 符号 ( %2520)。

示例网址：

```
https://mobile.twitter.com/compose/tweet?status=Word1%20Word%20Word3 
```

如果您已经登录并随后访问该 URL，那么一切都很好。这只是用户第一次登录，%20 转换为 %2520 并在页面上显示为“Word1+Word2+Word3”。有什么想法吗？这发生在我测试过的所有浏览器和平台上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-09T13:04:50.093

我认为 Twitter 为这种链接提供了一个新的 API。试试这个：[https ://dev.twitter.com/docs/tweet-button](https://dev.twitter.com/docs/tweet-button)

例子：

```
https://twitter.com/share?url=&text=Word1%20Word%20Word3 
```

# javascript - 用于 CSS 的 SVG onmouseover

> ID：15588979
> 
> 赞同：0
> 
> 时间：2013-03-23T16:12:08.687
> 
> 标签：javascript, css, svg, onmouseover

是否可以使用 SVG 中的 onmouseover(evt) 来触发操纵 CSS 而不仅仅是 SVG 的 Javascript（ecmascript）？

因此，例如，当我将鼠标悬停在屏幕的一部分上时，我希望 SVG 能够检测到，但随后有一些 javascript 不会更改 SVG 属性，而是会更改诸如“字体大小”之类的 CSS 内容。

我知道这不是一个很好的解释，但我真的很累很虚弱。谢谢阅读。

# android - Google Drive Account Picker onActivityResult resultCode 始终为 -1

> ID：15588981
> 
> 赞同：2
> 
> 时间：2013-03-23T16:12:19.273
> 
> 标签：android, google-drive-api

我目前正在开发一个 android 应用程序，并且正在尝试集成 Google Drive。I'm having a problem with the account picker, that when the account is chosen and it returns into the onActivityResult function the resultCode is -1 which I believe it should be 0 to mean that it was successful.

以下是我打开帐户选择器的方式

```
credential = GoogleAccountCredential.usingOAuth2(context, DriveScopes.DRIVE);
startActivityForResult(credential.newChooseAccountIntent(), REQUEST_ACCOUNT_PICKER 
```

`credential`是一个全局变量，所以整个类都可以访问这个变量。

下面是 onActivityResult 的代码

```
else if (resultCode == REQUEST_ACCOUNT_PICKER)
{
    if (resultCode == RESULT_OK && intent != null && intent.getExtras() != null)
    {
    String accountName = intent.getStringExtra(AccountManager.KEY_ACCOUNT_NAME);
    SharedPreferences settings = context.getSharedPreferences("prefs", 0);
    SharedPreferences.Editor editor = settings.edit();
    editor.putString("google_drive_account_name", accountName);
    editor.putBoolean("drive_sync_upload_download_required", true);
    editor.commit();
    }
} 
```

它进入 else if 语句很好，但是当它检查 resultCode 是否等于 RESULT_OK 时，它返回 false，因为 resultCode 由于某种原因被设置为 -1。我假设 -1 表示某些事情发生了故障，但我在 logCat 中看不到任何错误消息。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:28:04.150

通过[这个](http://developer.android.com/reference/android/app/Activity.html#RESULT_OK)： 的值`RESULT_OK`是`-1`。

`0`是为了`RESULT_CANCELLED`

# colors - d3.rgb().darker/brighter

> ID：15588984
> 
> 赞同：1
> 
> 时间：2013-03-23T16:12:33.523
> 
> 标签：colors, internet-explorer-9, d3.js

我正在使用 d3 绘制条形图，其中条形用于比较不同的组（例如男性/女性）。对于填充，我采用保存在数据文件（json）中的颜色并使用`d3.rgb().darker()/.brighter()`.

```
.attr("fill", function(d){return d3.rgb(d.color).darker(1);}) 
```

它在 Firefox 中有效，但在 Internet Explorer 9 中，所有的条都显示为黑色（这是第一个使用的颜色）。我想知道这是否只是这个浏览器的一个问题，或者我是否遗漏了一些东西来避免这种行为。

一种解决方案当然是单独分配颜色，但如果可能的话，我想使用提供的可能性。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-28T09:57:02.860

发生这种情况是因为您使用`attr("fill")`而不是`style("fill")`设置样式属性。

该`style`函数包括一些额外的检查，以便在需要时将属性值转换为适当的字符串，因此您无需`toString()`手动执行此操作。

将您的原始行更改为：

```
.style("fill", function(d){return d3.rgb(d.color).darker(1);}) 
```

应该适用于包括 IE 在内的所有浏览器。

# php - PHP插入MySQL语法错误

> ID：15588986
> 
> 赞同：-1
> 
> 时间：2013-03-23T16:12:40.400
> 
> 标签：php, mysql, sql, phpmyadmin

我在通过 php 向 MySQL 提交一些数据时遇到问题，我收到以下错误：

**“错误：您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，了解在“学生”附近使用的正确语法（UID、名字、姓氏、出生日期、紧急联系人、地址、城市、州）在第 1 行"**

我不确定我哪里出错了，任何帮助都会很棒。

```
<?php
$firstname = $_POST['firstname'];
$lastname = $_POST['lastname'];
$dob = $_POST['dob'];
$emergencycontact = $_POST['emergencycontactperson'];
$address = $_POST['addressline1'];
$city = $_POST['city'];
$state = $_POST['state'];
$zip = $_POST['zip'];
$homephone = $_POST['homephone'];
$cellphone = $_POST['cellphone'];
$guardian = $_POST['guardian'];
$inneighborhood = 0;
if ($zip == "49503")
    $inneighborhood = 1;

$con = mysqli_connect("localhost", "cookarts_root", "password", "cookarts_database");

// Check connection
if (mysqli_connect_errno()) {
    echo "Failed to connect to MySQL: " . mysqli_connect_error();
}

$sql = "INSERT INTO 'student' (FirstName, LastName, DOB, EmergencyContact, Address,       City, State, ZIP, CellPhone, HomePhone, Guardian, InNeighborhood)
VALUES
($firstname', '$lastname', '$dob', '$emergencycontact', '$address', '$city', '$state', '$zip', '$cellphone', '$homephone', '$guardian', '$inneighborhood')";

if ($con->query($sql) === TRUE) {
      echo 'users entry saved successfully';
}   
else {
  echo 'Error: '. $con->error;
}

mysqli_close($con);
?> 
```

![在此处输入图像描述](../Images/fdae713a7bc36bc5569e0272b8f58204.png)

如果您需要更多信息，我很乐意提供，再次感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:14:08.570

`TableNames`是标识符，所以它们不应该用单引号引起来。由于您使用的 tableName 不是保留关键字，您可以简单地删除那些环绕的引号，

```
INSERT INTO student (FirstName, LastName.... 
```

当您用单引号包裹某些内容时，它会强制该对象成为字符串文字。因此，当标识符用单引号括起来时，这意味着它们不再是标识符。

服务器抛出异常，因为`INSERT INTO`需要一个标识符而不是字符串文字。

当您不小心使用了[MySQL 保留关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)的表名时，不要使用单引号来分隔标识符，而是使用`backticks`.

作为旁注，[`SQL Injection`](http://bobby-tables.com/)如果变量的值（*s*）来自外部，则查询很容易受到攻击。请看下面的文章，了解如何预防。通过使用`PreparedStatements`，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T16:16:42.173

将您的查询更改为

```
$sql = "INSERT INTO student (FirstName, LastName, DOB, EmergencyContact, Address,                City, State, ZIP, CellPhone, HomePhone, Guardian, InNeighborhood)
    VALUES
   ('$firstname', '$lastname', '$dob', '$emergencycontact', '$address', '$city', '$state', '$zip', '$cellphone', '$homephone', '$guardian', '$inneighborhood')"; 
```

不要在表名周围使用引号

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T16:18:40.873

看起来你也错过了一些东西：

你有:
($firstname',

应该是：（缺少'开头）
（'$firstname'，

但即便如此，您可能想要使用 " （引号）并像这样转义它们：

(\"$名\",

您的 INSERT INTO 行上的地址和城市之间也有很多空间...地址，城市

是的，您应该使用 ` 转义 mysql 字段名称

# java - 在 datepickerdialog 中隐藏日期选择器

> ID：15588987
> 
> 赞同：0
> 
> 时间：2013-03-23T16:12:50.050
> 
> 标签：java, android, hide, picker, datepickerdialog

嗨，有什么正确的方法可以在 datepickerdialog 中隐藏日期选择器吗？我使用的是原生 android datepickerdialog，而不是自定义 datepickerdialog。希望有人可以提供帮助。

下面是我的 datepickerdialog 代码：

```
Button.OnClickListener monthOnClickListener
= new Button.OnClickListener(){
    @Override
    public void onClick(View arg0) {
        DialogFragment newFragment = new SelectDateFragment();
        newFragment.show(getFragmentManager(), "DatePicker");
    }
};

public class SelectDateFragment extends DialogFragment implements DatePickerDialog.OnDateSetListener {
    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        final Calendar calendar = Calendar.getInstance();
        int yy = calendar.get(Calendar.YEAR);
        int mm = calendar.get(Calendar.MONTH);
        int dd = calendar.get(Calendar.DAY_OF_MONTH);

        return new DatePickerDialog(getActivity(), this, yy, mm, dd);
    }

    public void onDateSet(DatePicker view, int yy, int mm, int dd) {
        String year=yy+"", month, day;
        mm = mm+1;

        if (dd==1 || dd==2 || dd==3 || dd==4 || dd==5 || dd==6 || dd==7 || dd==8 || dd==9)
            day = "0"+ dd;
        else
            day = dd + "";

        if (mm==1 || mm==2 || mm==3 || mm==4 || mm==5 || mm==6 || mm==7 || mm==8 || mm==9)
            month = "0"+ mm;
        else
            month = mm  + "";
    }

} 
```

我有谷歌隐藏日期选择器的方式，但它似乎没有任何效果。下面是我尝试过的代码。

```
public class SelectDateFragment extends DialogFragment implements DatePickerDialog.OnDateSetListener {
    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        final Calendar calendar = Calendar.getInstance();
        int yy = calendar.get(Calendar.YEAR);
        int mm = calendar.get(Calendar.MONTH);
        int dd = calendar.get(Calendar.DAY_OF_MONTH);

         DatePickerDialog dpd = new DatePickerDialog(getActivity(), this,yy,mm, dd);
            try{
            java.lang.reflect.Field[] datePickerDialogFields = dpd.getClass().getDeclaredFields();
            for (java.lang.reflect.Field datePickerDialogField : datePickerDialogFields) { 
                if (datePickerDialogField.getName().equals("mDatePicker")) {
                    datePickerDialogField.setAccessible(true);
                    DatePicker datePicker = (DatePicker) datePickerDialogField.get(dpd);
                    java.lang.reflect.Field[] datePickerFields = datePickerDialogField.getType().getDeclaredFields();
                    for (java.lang.reflect.Field datePickerField : datePickerFields) {
                       if ("mDayPicker".equals(datePickerField.getName())) {
                          datePickerField.setAccessible(true);
                          Object dayPicker = new Object();
                          dayPicker = datePickerField.get(datePicker);
                          ((View) dayPicker).setVisibility(View.GONE);
                       }
                    }
                 }

              }
            }catch(Exception ex){
            }
          return dpd;
        //return new DatePickerDialog(getActivity(), this, yy, mm, dd);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T17:02:45.580

带有“mDatePicker”的alnog也使用“mDaySpinner”这个

# image - Excel VBA从列中的图像名称插入图像

> ID：15588995
> 
> 赞同：-5
> 
> 时间：2013-03-23T16:14:10.493
> 
> 标签：image, excel, vba

如果关于插入图像和重新调整大小的不同线程已经阅读了很多，但找不到完全符合我想要它做的事情。

所以说我有一个有 2 行的电子表格。A列是图像列，B列是图像名称。

我想要一个脚本来遍历 B 列中的每个值，将与该名称匹配的图像插入到 A 列的同一行中，调整其大小以适应 150 高 x 18 宽的单元格大小，然后移动到下一行并重复电子表格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T16:53:17.453

这是一个示例，它将遍历您可以修改的一系列单元格 (B1:B100)，并使用左侧一列单元格中的文件名（因此，从 A 列开始），并调整图像大小以适合单元格在 B 栏中。

```
Sub InsertPic()
Dim pic As String 'file path of pic
Dim myPicture As Picture 'embedded pic
Dim rng As Range 'range over which we will iterate
Dim cl As Range 'iterator

Set rng = Range("B7:B7")
For Each cl In rng
    pic = cl.Offset(0, -1)

        Set myPicture = ActiveSheet.Pictures.Insert(pic)
        '
        With myPicture
            .ShapeRange.LockAspectRatio = msoFalse
            .Width = cl.Width
            .Height = cl.Height
            .Top = Rows(cl.Row).Top
            .Left = Columns(cl.Column).Left
        End With
        '

Next

End Sub 
```

此代码中没有错误处理来解释无效文件名，您可能需要添加它。

# sharpdevelop - 使用 SharpDevelop 库，如何添加对项目的引用？

> ID：15588996
> 
> 赞同：0
> 
> 时间：2013-03-23T16:14:10.747
> 
> 标签：sharpdevelop

我正在为我的项目使用 ICSharpCode.SharpDevelop 库。我试图弄清楚如何构造一个 DefaultProject 的实例，以便它具有所有必要的引用。所以，我需要类似的东西

```
 projectContent.AddReferencedContent(_projectContentRegistry.GetProjectContentForReference("System.Core", "System.Core")); 
```

除了它不起作用——无论我试图为参数提供什么，GetProjectContentForReference(..) 总是返回 null。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T10:47:58.783

它看起来像 SharpDevelop 4.x 中的 ProjectContentRegistry 类中的一个错误。如果您调试 GetProjectContentForReference() 方法，那么您可以看到它在错误的 GAC 文件夹中查找。它正在文件夹中查找

```
System.Core\4.0.0.0__b77a5c561934e089\System.Core.dll 
```

什么时候应该在文件夹中查找

```
System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll 
```

我怀疑这个错误没有被注意到，因为 SharpDevelop 现在使用 MSBuild 来计算程序集引用的位置。以 System.Core 为例，它将根据项目的目标框架在参考程序集文件夹中找到程序集：

```
C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\Profile\Client\System.Core.dll 
```

您可以做的是使用作为 ICSharpCode.SharpDevelop.Dom 程序集一部分的 GacInterop 类查找文件名。下面的代码应该返回一个非空的项目内容对象。

```
var reference = new DomAssemblyName("System.Core");
reference = GacInterop.FindBestMatchingAssemblyName(reference);
string fileName = GacInterop.FindAssemblyInNetGac(reference);
var registry = new ProjectContentRegistry();
IProjectContent pc = registry.GetProjectContentForReference("System.Core", fileName); 
```

# c# - BMP RFC不能从流大小而是从标题信息中获取文件大小

> ID：15588997
> 
> 赞同：0
> 
> 时间：2013-03-23T16:14:12.017
> 
> 标签：c#, header, format, bmp, rfc

试图获取`BMP`文件的有效大小。

当然最好的方法就是获取`Length`加载流的属性。

但是`BMP`标头格式确实包含有关其大小的信息，我想尝试从 BMP 标头中完全获取它。

来自 Wiki 或其他来源：

[http://en.wikipedia.org/wiki/BMP_file_format](http://en.wikipedia.org/wiki/BMP_file_format)

```
offset: 0002h | 4 bytes | the size of the BMP file in bytes 
```

因此大小值包含在`BMP`4 字节区域的标头中（ from `[2] -> [5]: 2, 3, 4, 5`）

所以首先我想得到所有的字节值并对所有的求和：

1）。

```
int BMPGetFileSize(ref byte[] headerPart)
{
    int fileSize = 0;

    for (int i = 0; i < headerPart.Length; i++)
    {
        fileSize += headerPart[i];
    }

    return (fileSize > 0) ? fileSize : -1;
} 
```

我有一个非常小的尺寸......对于我的文件，实际大小是 901：

![在此处输入图像描述](../Images/53cbbfe720e75d28b21a4ae6db578fd2.png)

但是，我从代码中得到：84。

我检查了正确的区域，我认为我不能得到正确的值，但我得到了正确的（从 BMP 的 byte[] 数据的第 2 到第 5 ）。

2）。然后我想，我不能对它们求和，而只是在一个字符串行中写入所有值，然后将其转换为 System.Int32 并除以 1024 以获得以 Kbytes 为单位的大小，但再次......它没有等于`901 Kb`价值。

![在此处输入图像描述](../Images/c677165668a2c030fe3bf9c9e4d403d1.png)

`watch`您可能会认为，当您查看对话框并将其与函数代码进行比较时，我混淆了该区域并选择了错误的值，但是正如您所见，函数中的 byte[] 数组是： `headerPart`，不是`data`，所以我没有混淆任何东西， data[] 是整个 BMP 文件的文件流。

那么，如何从 BMP 标头而不是 C# 中的流属性获取文件大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T16:22:02.457

BMP 文件格式是一种*二进制格式*，这意味着您无法使用`StreamReader`or `TextReader`（两者都*仅*用于文本）读取它，也无法使用 UTF-8 或 ANSI 解码器对其进行解码。（编码也*仅*用于文本。）您必须使用`BinaryReader`.

该文档指出：

> 偏移量：0002h | 4 个字节 | BMP 文件的大小（以字节为单位）

所以你需要读取*四个*字节并将它们组合成一个整数值。

使用`BinaryReader`该类，您可以调用该[`ReadUInt32()`方法](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readuint32.aspx)来读取形成无符号 32 位整数的 4 个字节。

如果你这样做，你会看到它显示：

```
921654 
```

...这是 900 KiB，然后是一些。