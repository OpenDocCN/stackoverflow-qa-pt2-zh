# StackOverflow 问答 15043000-15043999

# php - 使用 PHPMailer 作为单例（就像使用 PDO 一样）

> ID：15043000
> 
> 赞同：0
> 
> 时间：2013-02-23T16:52:31.443
> 
> 标签：php, singleton, phpmailer

为了访问我的数据库，我创建了一个单例对象，并像访问它一样`db::db->query($sql);` 好！

```
class db {
    private static $instance = NULL;
    private function __construct() {}   //Make private
    private function __clone(){}   //Make private
    public static function db() //Get instance of DB
    {
        if (!self::$instance)
        {
            self::$instance = new PDO("mysql:host=xxx;dbname=xxx", 'xxx', 'xxx');
            self::$instance-> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        }
        return self::$instance;
    }
} 
```

我可以并且应该对 PHPMailer 采取同样的方法吗？除了设置导致“尝试访问私有属性”错误的密件抄送属性外，它似乎可以工作。

```
class email{
    public $bcc;
    private static $instance = NULL;
    private function __construct() {}   //Make private
    private function __clone(){}   //Make private
    public static function email() //Get instance of email
    {
        if (!self::$instance)
        {
            require_once ('PHPMailer_v5.1/class.phpmailer.php');
            self::$instance = new PHPMailer();
            self::$instance->IsSMTP();
            self::$instance->SMTPAuth   = true;
            self::$instance->SMTPSecure = "tls";  //Or SSL?
            self::$instance->Host       = "smtp.gmail.com";
            self::$instance->Port       = 587;    //Maybe 465 instead? SSL only?
            self::$instance->Username   = "xxx";
            self::$instance->Password   = "xxx";
        }
        return self::$instance;
    }
}

$mail           = email::email();
$mail->AddReplyTo('email@email.com','name');
$mail->SetFrom('email@email.com','name');
$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!";
$mail->bcc      = 'doesntwork@gmail.com';
$mail->FromName = $users_name;
$mail->Subject  = $subject;
$mail->WordWrap = 50; // set word wrap 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:55:18.460

不知道重点是什么？

与数据库连接不同，邮件类没有持久连接，所以不会有性能提升。我只看到为此使用 Singleton 的缺点 - 尤其是您必须重置类的*每个*属性以避免上次发送消息时可能发生的意外更改。

我只会按照设计使用的方式使用 PHPMailer。

# entity-framework - 使用“数据库优先”方法实施 TPH

> ID：15043005
> 
> 赞同：0
> 
> 时间：2013-02-23T16:52:51.933
> 
> 标签：entity-framework, entity-framework-4, entity-framework-5

我正在尝试在 Microsoft 的以下文档的帮助下使用“数据库优先”来实现 EF TPH，

[http://msdn.microsoft.com/en-us/data/jj618292.aspx](http://msdn.microsoft.com/en-us/data/jj618292.aspx)

我确实理解这是如何工作的，但它的完成方式听起来有点天真，或者我错过了一些我希望有人能启发我的东西。

据我了解，实施数据库优先方法的全部意义在于，当您有一个预先存在的数据库时，或者如果您更喜欢直接在数据库上进行工作并逐步向上工作，但是，本文档建议继承表（学生，讲师）旨在使用基类上的一个字段在 EF 设计区域创建，他们称之为“鉴别器”字段，您的继承实体最终指向该字段。

但是，我的问题是，为什么您必须在 ER 设计器中创建这些继承的表，您最初打算在其中直接创建表结构，然后再逐步构建实体框架，以及您在 ER 设计器上应用的这种更改将如何（添加继承的表）被映射到后端数据库，当我想稍后对我的数据库进行更改时，我必须在哪里进行这些更改（在 MS SQL 或 ER 上设计师）。如果我最终从 ER 端添加表，那么这将大大违背“数据库优先”方法的目的，因为我基本上最终使用了“模型优先”方法中的过程，这根本没有意义.

非常感谢您帮助解决这个问题。

请注意：我宁愿一切都在我的数据库中完成，而不是使用“模型优先”的方法。我有兴趣实现 TPH 并能够直接对我的数据库进行任何更改并将这些更改映射到我的 EF 子层（而不是相反）。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:02:19.747

我看不出 EF 如何为您推断继承。也许可以通过表中明确命名为“鉴别器”的字段来触发它，但是如果您想要鉴别器的不同名称怎么办？然后，派生类的名称应该是什么？EF没有任何线索。名称在数据模型中不存在。

不过，它首先是数据库。但 EF 只是创建了映射的初稿。您几乎总是需要对概念模型（您在 edmx 中看到的模型）进行修改，例如重命名属性或类、重命名/添加/删除关联。或应用继承。当您从数据库更新模型时，可能需要应用更多手动更改。例如，对于 TPH 继承，您可能必须决定在哪个类中放置一个新字段。

也许您对“必须在 ER 设计器中创建这些继承的*表”的想法有点偏心。*您定义映射到同*一张表的**类*。

# android - 如何移动 Android Google Maps API 指南针位置

> ID：15043006
> 
> 赞同：25
> 
> 时间：2013-02-23T16:53:01.147
> 
> 标签：android, android-maps

有谁知道您是否可以更改地图中的指南针位置？

我能找到的只是[如何启用或禁用](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/UiSettings#setCompassEnabled%28boolean%29)它。但我需要将它向下移动一点，这样我的叠加层就不会阻碍它。

![在此处输入图像描述](../Images/5b2db020ed50cebeb812ad473f819873.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-10-03T08:35:20.297

使用 GoogleMap.setPadding() 方法：

[https://developers.google.com/maps/documentation/android/map#map_padding](https://developers.google.com/maps/documentation/android/map#map_padding)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-07-08T12:35:55.733

```
@Override
public void onMapReady(GoogleMap map) {

    try {
        final ViewGroup parent = (ViewGroup) mMapView.findViewWithTag("GoogleMapMyLocationButton").getParent();
        parent.post(new Runnable() {
            @Override
            public void run() {
                try {
                    Resources r = getResources();
                    //convert our dp margin into pixels
                    int marginPixels = (int)TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 20, r.getDisplayMetrics());
                    // Get the map compass view
                    View mapCompass = parent.getChildAt(4);

                    // create layoutParams, giving it our wanted width and height(important, by default the width is "match parent")
                    RelativeLayout.LayoutParams rlp = new RelativeLayout.LayoutParams(mapCompass.getHeight(),mapCompass.getHeight());
                    // position on top right
                    rlp.addRule(RelativeLayout.ALIGN_PARENT_LEFT, 0);
                    rlp.addRule(RelativeLayout.ALIGN_PARENT_TOP);
                    rlp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
                    rlp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, 0);
                    //give compass margin
                    rlp.setMargins(marginPixels, marginPixels, marginPixels, marginPixels);
                    mapCompass.setLayoutParams(rlp);
                } catch (Exception ex) {
                    ex.printStackTrace();
                }
            }
        });
    } catch (Exception ex) {
        ex.printStackTrace();
    }

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-06T13:08:29.780

我知道这个问题被问了很长时间，但是几天前我在这个问题上解决了这个问题：

```
try {
                assert mapFragment.getView() != null;
                final ViewGroup parent = (ViewGroup) mapFragment.getView().findViewWithTag("GoogleMapMyLocationButton").getParent();
                parent.post(new Runnable() {
                    @Override
                    public void run() {
                        try {
                            for (int i = 0, n = parent.getChildCount(); i < n; i++) {
                                View view = parent.getChildAt(i);
                                RelativeLayout.LayoutParams rlp = (RelativeLayout.LayoutParams) view.getLayoutParams();
                                // position on right bottom
                                rlp.addRule(RelativeLayout.ALIGN_PARENT_LEFT, 0);
                                rlp.addRule(RelativeLayout.ALIGN_PARENT_TOP,0);
                                rlp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
                                rlp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);
                                rlp.rightMargin = rlp.leftMargin;
                                rlp.bottomMargin = 25;
                                view.requestLayout();
                            }
                        } catch (Exception ex) {
                            ex.printStackTrace();
                        }
                    }
                });
            } catch (Exception ex) {
                ex.printStackTrace();
            } 
```

在这个例子中，我把指南针放在右边的角落里。您需要确保在执行此操作时创建了您的 mapFragment，我建议您在 MapFragment 的“onMapReady”方法中运行您的代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-23T16:59:14.323

据我所知，您无法更改指南针位置，但您可以禁用它并构建您的私人指南针位置。

[在此处查看示例](http://android-coding.blogspot.co.il/2011/06/easy-drawing-current-location-and.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-11T15:00:21.467

在 2.0 地图 API 上。

```
 // change compass position 
    if (mapView != null &&
            mapView.findViewById(Integer.parseInt("1")) != null) {
        // Get the view
        View locationCompass = ((View) mapView.findViewById(Integer.parseInt("1")).getParent()).findViewById(Integer.parseInt("5"));
        // and next place it, on bottom right (as Google Maps app)
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams)
                locationCompass.getLayoutParams();
        // position on right bottom
        layoutParams.addRule(RelativeLayout.ALIGN_PARENT_TOP, RelativeLayout.TRUE);
        layoutParams.setMargins(0, 160,30, 0); // 160 la truc y , 30 la  truc x
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-17T19:58:25.587

基于填充的解决方案适用于小偏移量，但据我所知，没有公开的 API 允许我们像谷歌地图应用程序那样从左到右稳健地改变指南针的水平“重力”：

[![在此处输入图像描述](../Images/a41083430842892e9fee5d8e12366a0a.png)](https://i.stack.imgur.com/rUbGCl.jpg)

请注意，如果您在自己的应用程序中应用了大量的左侧填充将指南针向右移动，则左下方的 Google 徽标也会向右移动。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-04-02T09:47:15.757

根据@Vignon ( [https://stackoverflow.com/a/38266867/2350644](https://stackoverflow.com/a/38266867/2350644) ) 的回答，这里有一个 Kotlin 代码片段，用于将指南针图标定位到屏幕的右上角。您还可以添加自定义边距（在此示例中，指南针图像的 marginTop 为 50dp）。

```
mapFragment?.view?.let { mapView ->
  mapView.findViewWithTag<View>("GoogleMapMyLocationButton").parent?.let { parent ->
    val vg: ViewGroup = parent as ViewGroup
    vg.post {
      val mapCompass: View = parent.getChildAt(4)
      val rlp = RelativeLayout.LayoutParams(mapCompass.height, mapCompass.height)
      rlp.addRule(RelativeLayout.ALIGN_PARENT_LEFT, 0)
      rlp.addRule(RelativeLayout.ALIGN_PARENT_TOP)
      rlp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT)
      rlp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, 0)

      val topMargin = (50 * Resources.getSystem().displayMetrics.density).toInt()
      rlp.setMargins(0, topMargin, 0, 0)    
      mapCompass.layoutParams = rlp
    }
  }
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-13T15:15:10.187

有我的解决方案。

首先，我需要这个 Kotlin 扩展来获取任何视图的所有子视图

```
fun View.getAllChildren(): List<View> {
    val result = ArrayList<View>()
    if (this !is ViewGroup) {
        result.add(this)
    } else {
        for (index in 0 until this.childCount) {
            val child = this.getChildAt(index)
            result.addAll(child.getAllChildren())
        }
    }
    return result
} 
```

之后，我只是通过使用他的内容描述查找指南针来检索它（如果将来内容描述发生变化，请使用 Layout Inspector 检索它，以防万一）。

当你有你的观点时，像这样改变他的位置：

```
 binding.mapView
            .getAllChildren()
            .firstOrNull { it.contentDescription == "Compass" }
            ?.let { it.y = it.y + 400 } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-13T15:29:18.513

更好地使用以下代码段：

```
mapView.findViewWithTag<View>("GoogleMapCompass")?.let { compass ->
    compass.post {
        val topMargin = compass.marginTop
        val rlp = RelativeLayout.LayoutParams(compass.height, compass.height)
        rlp.addRule(RelativeLayout.ALIGN_PARENT_LEFT, 0)
        rlp.addRule(RelativeLayout.ALIGN_PARENT_TOP)
        rlp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT)
        rlp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, 0)

        val endMargin = (4 * Resources.getSystem().displayMetrics.density).toInt()
        rlp.setMargins(0, topMargin, endMargin, 0)
        compass.layoutParams = rlp
    }
} 
```

这样您就不必使用“GoogleMapMyLocationButton”并越过父级。当 google 提供 mapView 的更新时，迭代到父级不会带来任何好处，并且将来可能会更容易崩溃。在该代码中，您可以直接访问指南针，这就是您需要的元素。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-13T18:27:42.630

在@Vignon 之后，建议将指南针放在左下角（在 kotlin 中）：

```
 mapFragment.view?.let { mapView->
                mapView.findViewWithTag<View>("GoogleMapMyLocationButton").parent?.let { parent->
                    val vg: ViewGroup = parent as ViewGroup
                    vg.post {
                        val mapCompass :View = parent.getChildAt(4)
                        val rlp = RelativeLayout.LayoutParams(mapCompass.height, mapCompass.height)
                        rlp.addRule(RelativeLayout.ALIGN_PARENT_LEFT)
                        rlp.addRule(RelativeLayout.ALIGN_PARENT_TOP,0)
                        rlp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT,0)
                        rlp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM)

                        val bottomMargin = (40 * Resources.getSystem().displayMetrics.density).toInt()
                        val leftMargin = (5 * Resources.getSystem().displayMetrics.density).toInt()
                        rlp.setMargins(leftMargin,0,0,bottomMargin)
                        mapCompass.layoutParams = rlp
                    }
                }
            } 
```

# objective-c - CFReadStreamRef 始终为零

> ID：15043008
> 
> 赞同：1
> 
> 时间：2013-02-23T16:53:09.773
> 
> 标签：objective-c, cocoa, core-foundation

我正在尝试读取`public.pem`存储公钥的文件，但`CFReadStreamRef`总是返回 nil。`publicKeyPath`并且`url`不是零（正如我在调试器中看到的那样），并且我没有其他线程读取或写入文件。我怎样才能解决这个问题？

```
NSString *publicKeyPath = [[NSBundle mainBundle] pathForResource:@"public" ofType:@"pem"];
CFURLRef url  = (CFURLRef)CFBridgingRetain([NSURL URLWithString:publicKeyPath]);
CFReadStreamRef cfrs = CFReadStreamCreateWithFile(kCFAllocatorDefault, url); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:00:33.883

我应该用`[NSURL fileURLWithPath:publicKeyPath]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:01:59.707

```
NSString *publicKeyPath = [[NSBundle mainBundle] pathForResource:@"public" ofType:@"pem"]; 
```

这将返回类似的东西`/private/var/mobile/.../public.pem`，或`/foo/bar`简称。

```
CFURLRef url  = (CFURLRef)CFBridgingRetain([NSURL URLWithString:publicKeyPath]); 
```

这将从*字符串* `/foo/bar`创建一个 URL 。这是一个完全有效的相对 URL（它链接到由基本 URL 确定的`scheme://authority/foo/bar`位置。`scheme://authority`

你想要的是一个*绝对的文件 URL*，这意味着你想要`+fileURLWithPath:`。或者，使用`-URLForResource:withExtension:`，它将从一开始就为您提供文件 URL：

```
NSURL *url= [[NSBundle mainBundle] URLForResource:@"public.pem" withExtension:nil];
CFReadStreamRef cfrs = CFReadStreamCreateWithFile(kCFAllocatorDefault, (__bridge CFURLRef)url); 
```

# php - OpenID/LightOpenID：验证（）失败

> ID：15043016
> 
> 赞同：1
> 
> 时间：2013-02-23T16:54:00.963
> 
> 标签：php, openid, lightopenid

我正在使用 LightOpenID 库尝试通过 OpenID 注册用户。除了 validate() 总是失败之外，一切似乎都适用于 Google 身份验证。我正在转储 $openid 并且所有数据似乎都井井有条，尽管 validate() 仍然失败。

我[在 Google Apps 上看到过 LightOpenID validate() fail](https://stackoverflow.com/questions/5463029/lightopenid-validate-fail-on-google-apps)这个问题，但我的问题略有不同，因为我确定响应不是未找到服务器，而是服务器出于某种原因响应 is_valid: false。为什么会这样？

这是我的做法（在 Laravel 中）：

```
// testing with Google
try {
    $openid = new LightOpenID();
    if (!$openid->mode) {
        $openid->required = array('contact/email');
        $openid->identity = 'https://www.google.com/accounts/o8/id';
        return Redirect::to($openid->authURL());
    } else if ($openid->mode == "cancel") {
        echo "User has canceled authentication.";
    } else {
        $attributes = $openid->getAttributes();

        // debugging 
        echo ($openid->validate()) ? "Logged in " : "Not logged in ";
        ?><pre><?php echo var_dump($openid);?></pre><pre><?php
        echo var_dump($attributes);?></pre><?php
    }
} catch (ErrorException $e) {
    echo $e->getMessage();
}
return View::make('home.index'); 
```

任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T19:45:07.270

我曾经也有过一样的问题。在绞尽脑汁试图解决之后，我发现问题似乎是由于添加了 `$openid->required = array('contact/email');`

删除或注释掉它将重新开始工作的那一行。为什么我不确定。

# c++ - 从成员函数引用数据成员时遇到问题

> ID：15043017
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:54:01.670
> 
> 标签：c++

第 23 行是：

```
List[i] = x; 
```

当我尝试编译时：

```
g++ w3.cpp list.cpp line.cpp
list.cpp: In member function void List::set(int):
list.cpp:23:8: error: expected unqualified-id before [ token 
```

这是main.cpp：

```
#include <iostream>
using namespace std;
#include "list.h"

int main() {
    int no;
    List list;

    cout << "List Processor\n==============" << endl;
    cout << "Enter number of items : ";
    cin  >> no;

    list.set(no);
    list.display();
} 
```

这是list.h：

```
#include "line.h"
#define MAX_LINES 10
using namespace std;

struct List{
    private:
        struct Line line[MAX_LINES];
    public:
        void set(int no);
        void display() const;
}; 
```

这是line.h：

```
#define MAX_CHARS 10
struct Line {
    private:
        int num;
        char numOfItem[MAX_CHARS + 1]; // the one is null byte
    public:
        bool set(int n, const char* str);
        void display() const;
}; 
```

这是 list.cpp

```
#include <iostream>
#include <cstring>
using namespace std;
#include "list.h"
//#include "line.h" - commented this line because it was giving me a struct redefinition error

void List::set(int no) {

    int line;
    char input[20];

    if (no > MAX_LINES)
        no = MAX_LINES;

    for (int i = 0; i < no; i++) {
    Line x;
        cout << "Enter line number : ";
        cin >> line;
        cout << "Enter line string : ";
        cin >> input;

        if (x.set(line, input)){
            List[i] = x;
            cout << "Accepted" << endl;
        }
        else
            cout << "Rejected" << endl;

    }
}

void List::display() const {

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:59:58.653

`List`是类型名称而不是成员。你可能是说

```
this->line[i] = x; 
```

你必须加上前缀，`this->`因为`line`单独是模棱两可的，因为你也有

```
int line; 
```

上面几行（没有双关语）。

为避免命名冲突和使用`this->`，您可以重命名变量，例如

```
struct List{
    private:
        struct Line lines[MAX_LINES];
    ...
};

void List::set(int no) {
    int lineno;
    ...
} 
```

`this->`然后，您可以在不使用或任何其他前缀的情况下进行分配

```
if (x.set(lineno, input)){
    lines[i] = x;
    cout << "Accepted" << endl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:00:06.803

让我们理解错误消息：

```
list.cpp: In member function 'void List::set(int)':
list.cpp:23:8: error: expected unqualified-id before '[' token 
```

list.cpp 第 23 行在这里：

```
List[i] = x; 
```

投诉是：

```
expected [something] before '[' token 
```

您被告知`List`您设计的对象不支持该`[ ]`语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T17:00:57.037

要使此代码正常工作：

```
List[i] = x; 
```

您的班级列表必须提供 operator[] aka 下标运算符：

```
class List {
public:
...
   Line &operator[]( int line );
...
}; 
```

这是一个示例，它可以返回 const 引用或返回值，成为 const 方法等取决于您的程序。

# sql - 查找与非基于日期时间的标准的日期时间重叠

> ID：15043018
> 
> 赞同：0
> 
> 时间：2013-02-23T16:54:01.670
> 
> 标签：sql, ms-access, overlap

我正在尝试根据日期时间值确定行的重叠，并且完全不知道如何实现这一点。在阅读了此处和其他站点的回复后，我在高层有一个模糊的理解需要做什么，但不知道从哪里开始。

原始数据集是分隔的，我愿意在 Excel、Access、Python 或 Perl 中执行此操作。

在更大的数据集中（大约 115,000 行）有三个不同的数据块；Apple、Orange 和 Pear - 样本数据如下。

数据集的图像可以在 - [http://i.imgur.com/DQtmuvI.jpg找到](https://i.imgur.com/DQtmuvI.jpg)

```
filename                    network     spot_id         dt_sched                dt_insert

APPLE_2012_10151135.VCA     APPLE       00NC8109450     01/01/2012 0:20:30      01/01/2012 0:23:10
APPLE_2012_10151135.VCA     APPLE       0NF81700041     01/01/2012 0:20:30      01/01/2012 0:22:40
APPLE_2012_10151135.VCA     APPLE       0NF82100170     01/01/2012 0:50:30      01/01/2012 0:48:57
APPLE_2012_10151135.VCA     APPLE       MK882000004     01/01/2012 0:50:30      01/01/2012 0:49:27
ORANGE_2012_10102135.VCA    ORANGE      0NF82100186     01/01/2012 0:15:30      01/01/2012 0:14:27
ORANGE_2012_10102135.VCA    ORANGE      00NC8139709     01/01/2012 0:15:30      01/01/2012 0:14:57
ORANGE_2012_10102135.VCA    ORANGE      0NF82400065     01/01/2012 0:31:30      01/01/2012 0:27:08
ORANGE_2012_10102135.VCA    ORANGE      000NC899740     01/01/2012 0:31:30      01/01/2012 0:27:38
ORANGE_2012_10102135.VCA    ORANGE      0NF81700041     01/01/2012 0:50:30      01/01/2012 0:46:58
ORANGE_2012_10102135.VCA    ORANGE      000NC899740     01/01/2012 0:50:30      01/01/2012 0:47:28
PEAR_2012_10125135.VCA      PEAR        0NF82100169     01/01/2012 0:15:30      01/01/2012 0:21:52
PEAR_2012_10125135.VCA      PEAR        ML817000190     01/01/2012 0:15:30      01/01/2012 0:22:22
PEAR_2012_10125135.VCA      PEAR        0NF82200043     01/01/2012 0:45:30      01/01/2012 0:47:43
PEAR_2012_10125135.VCA      PEAR        ML803000400     01/01/2012 0:45:30      01/01/2012 0:48:13 
```

如果出现以下情况，我需要在同一天确定：

dt_sched 和 dt_insert 之间的重叠

*   苹果重叠橙色
*   苹果重叠梨
*   橙色与苹果重叠
*   橙色重叠梨
*   梨与苹果重叠
*   梨重叠橙

表中的每个网络；Apple、Orange、Pear 包含 365 天的交易和一天 24 小时的交易。原始数据集在 Excel 中，我正在导入 Access。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:19:32.600

没有一种特别有效的方法可以做到这一点。下面给出SQL解决方案：

```
select cdate(int(t1.dt_sched)) as thedate, t1.network, t2.network, count(*) as numoverlaps
from t t1 join
     t t2
     on int(t1.dt_sched) = int(t2.dt_sched) and
        t1.dt_sched <= t2.dt_insert and
        t2.dt_sched <= t1.dt_insert
group by cdate(int(t1.dt_sched)), t1.network, t2.network 
```

注意：我没有测试过这个查询，所以它可能有语法错误。

这将确定任何两个网络之间的重叠。如果您不关心同一网络上的重叠，请包含`where t1.network <> t2.network`. 如果除了列出的网络之外还有其他网络，则包括 `where t1.network in (NETWORK LIST HERE) 和 t2.network in (NETWORK LIST HERE)。

# github - 我可以下载 BuildHive 构建的工件吗？

> ID：15043020
> 
> 赞同：0
> 
> 时间：2013-02-23T16:54:20.983
> 
> 标签：github, download, artifact, buildhive

我已经开始在[BuildHive](https://buildhive.cloudbees.com/)上为我的一个 GitHub 项目使用免费的 Jenkins 构建服务。这也是我第一次尝试用 Maven 做任何事情。我已经成功地在 BuildHive 上使用这个脚本构建了我的项目：

```
cd base_dir
mvn package 
```

构建日志显示生成的 JAR 已构建。现在我想将 JAR 作为下载工件提供给我项目的用户，因为 GitHub 已经停止在单独的下载部分手动上传二进制文件的功能。

*   有什么方法可以下载工件，通过 URL 引用它？如果是这样，我如何构建 URL，只知道构建日志中工件的本地路径？
*   或者，有没有一种方法可以通过在我的构建 shell 脚本中添加命令来将工件推送到另一个地方`mvn package`？`curl`我在想像一个或命令之类的东西`ftpput`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:55:55.620

正如我最初的问题所建议的那样，我能想出的最好的解决方法是通过*curl将有问题的工件上传到我的 FTP 服务器。*它可以工作，但缺点是构建公共日志中的 FTP 凭据。我通过我的 DSL 路由器上的 shell 脚本来平衡这一点，该脚本每隔几分钟检查一次 FTP 存储滥用。

作为替代方案，我发现在为我的小型开源项目创建了一个免费的 CloudBees 帐户后，我获得了自己的 Jenkins 构建配置以及我自己的工件存储库，用于部署我的构建工件。这更加优雅，并且不涉及将任何 FTP 凭据发布到公共服务器。

如果有人有聪明的想法，我仍然愿意接受仅 BuildHive 的解决方案。`:-)`

# java - 在 spring 中加载单例 bean 中的错误消息

> ID：15043028
> 
> 赞同：1
> 
> 时间：2013-02-23T16:55:02.843
> 
> 标签：java, spring, jakarta-ee, spring-mvc

我有 error_messages 表，其中包含站点范围的错误消息。我在应用程序中使用错误消息。所以，我创建了错误消息的单例 bean ( **ErrorMessagesLoad.java** )

**ErrorMessagesLoad**使用**ErrorMessageDao**从数据库中检索错误消息。

我应该在 ErrorMessagesLoad 中创建**静态变量来保存所有错误消息并在所有类中使用它吗？**或者有更好的方法吗？

谢谢，
萨蒂亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:59:11.413

通常应避免使用全局静态变量。错误处理可能会变得棘手。许多应用程序尝试在顶部附近的某个地方放置一个全局捕获处理程序（例如，顶部将是过滤器的 Web 应用程序），其中注入了 ErrorMessagesLoad。该处理程序捕获底层异常，将它们转换为用户可读的内容，然后将其抛出更高。

一些例子包括 Spring 的[异常翻译过滤器](http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/access/ExceptionTranslationFilter.html)和 Jersey 的[异常映射](http://jersey.java.net/nonav/documentation/1.12/jax-rs.html#d4e435)机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:02:05.763

您应该在 Spring 中使用自己的[MessageSource](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/context/MessageSource.html)实现来解析任何消息。[这是](https://jira.springsource.org/secure/attachment/10261/JdbcMessageSource.java)一个很好的起点。

实现后，您只需将 bean 连接到任何服务或控制器，它就会为您处理消息，并具有将它们国际化的能力。

# jquery - 动态更改 Bootstrap 按钮的 innerHtml

> ID：15043029
> 
> 赞同：0
> 
> 时间：2013-02-23T16:55:07.840
> 
> 标签：jquery, twitter-bootstrap, coffeescript, innerhtml

我有以下引导导航栏：

```
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="brand">J+ Iso&epsilon;ditor</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    <div class="btn-group">
                        <button class="btn" id='bts-display-button'></button>
                        <button class="btn dropdown-toggle" data-toggle="dropdown"> <span class="caret"></span></button>
                        <ul class="dropdown-menu" id="bts-dropdown">

                        </ul>
                    </div>
                <button class="btn">New BTS</button>

                </ul>
            </div><!--/.nav-collapse -->
        </div>
    </div>
</div> 
```

我将元素动态加载`<li>`到`dropdown_menu`. 这工作正常。我也试图将 innerHtml 更改为`bts-display-button`单击`<li>`元素的值。

我实现此目的的 CoffeeScript 代码如下：

```
class Toolbar
  constructor: () ->

    @selected_BTS = undefined # The current selected BTS in the BTS dropdown

    @create_toolbar()
    @bts_dropdown_selecion_clickhandler()

  create_toolbar: () =>

  # Add new bts to drop down 
  addBTS: (name) =>
    $('#bts-dropdown').append "<li>#{name}</li>"

  # Set the caption of the bts-dropdown button to what is selected
  bts_dropdown_selecion_clickhandler: () =>
    $('body').on 'click', '#bts-dropdown li', ->
      console.log $(this).html()
      Toolbar.selected_BTS = $(this).html()
      $('#bts-display-button').html(Toolbar.selected_BTS) 
```

例如，如果用户单击一个元素`<li>Hello</li>`，`dropdown_menu`那么控制台会正确记录值“Hello”，但 innerHtml`bts-display-button`保持不变。

注意：我所有的脚本都在 html 的底部，所以当上面的代码执行时 DOM 就准备好了。

请有人可以帮助我，因为我已经被困了两天。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:11:09.440

更换：

$('#bts-display-button').html(Toolbar.selected_BTS)

和

$('body').find('#bts-display-button').html(Toolbar.selected_BTS)

使它工作。

我打开了一个新问题，讨论为什么会出现这种情况：[为什么 JQuery .find 只选择元素？](https://stackoverflow.com/questions/15043817/why-does-jquery-find-work-over-just-selecting-the-element)

# matlab - 如何从字符串中读取数据

> ID：15043030
> 
> 赞同：0
> 
> 时间：2013-02-23T16:55:14.153
> 
> 标签：matlab

我有以下格式的字符串：

`fileName.jpg,10,20,10,10,...,12,14,True`

基本上，我有一个带有逗号分隔值的字符串。第一个值是一个字符串，然后是一个包含 100 个值的数组，最后是另一个字符串是真或假。

有没有办法或直接将这些值读入 3 个变量？两个字符串和一个数组？值数组可能包含`n\a`我想要视为`-1`或类似的值，或者使用单元格数组并为这些值设置一个空单元格？你能为这类问题推荐一些东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T21:16:23.867

您可以使用[`textscan`](http://www.mathworks.de/de/help/matlab/ref/textscan.html)：

```
n = 100; % number of integers between filename and logical values

M = textscan(str, ['%s' repmat('%d',1, n) '%s'], 'delimiter', ',',...
    'TreatAsEmpty', 'n\a', 'EmptyValue', -1, 'CollectOutput', true); 
```

结果`M`是一个单元格数组，第一个单元格中包含文件名，第二个单元格中包含 100 个整数值，最后一个单元格中包含一个包含逻辑值的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:47:20.733

您可以使用`strsplit`和提取字符串中的值并将它们存储在单独的变量中

代码示例：

```
a = strsplit("fileName.jpg,10,20,10,10,...,12,14,True",",")
fileName = a(1)
flag = a(end)
data = a(2:end-1) 
```

# c# - 扩展方法的问题

> ID：15043032
> 
> 赞同：0
> 
> 时间：2013-02-23T16:55:17.227
> 
> 标签：c#, .net, c#-4.0

代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace LambdaExtensionEx
{
    class Program
    {
        static void Main(string[] args)
        {
            string[] myStrngs = new string[] { "Super","Simple","Okay"};
            IEnumerable<string> criteraStrngs = myStrngs.WhereSearch<string>(delegate(string s)
            {
                return s.StartsWith("s");
            });

            string s1 = "dotnet";
            int count = s1.GetCount();

            Console.ReadLine();
        }
    }

    public static class MyExtension
    {
        public delegate bool Criteria<T>(T Value);

        public static IEnumerable<T> WhereSearch<T>(this IEnumerable<T> values, Criteria<T> critera)
        {
            foreach (T value in values)
                if (critera(value))
                    yield return value;
        }

        public static int GetCount(this string value)
        {
            return value.Count();
        }
    }
} 
```

我可以调用 GetCount 扩展方法，并在“计数”中得到结果。但是在任何时候都没有调用 WhereSearch 并且没有得到结果。我在做什么错？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T16:57:31.020

`WhereSearch`如果要执行该函数，则需要开始枚举该函数返回的结果。这样做的原因是因为这个函数`yield returns`是一个`IEnumerable<T>`. C# 编译器所做的是构建一个状态机，并且在调用代码开始枚举结果之前不会立即执行该函数。

例如：

```
// The function is not executed at this stage because this function uses 
// yield return to build an IEnumerable<T>
IEnumerable<string> criteraStrngs = myStrngs.WhereSearch<string>(delegate(string s)
{
    return s.StartsWith("s");
});
// Here we start enumerating over the result => the code will start executing
// the function.
foreach (var item in criteraStrngs)
{
    Console.WriteLine(item);
} 
```

另一个例子是调用一些 LINQ 扩展方法，例如`.ToList()`在实际枚举和调用函数的结果上：

```
IEnumerable<string> criteraStrngs = myStrngs.WhereSearch<string>(delegate(string s)
{
    return s.StartsWith("s");
})
.ToList(); 
```

有关在这种情况下延迟加载如何工作的更多详细信息，您可以查看[`following post`](https://stackoverflow.com/questions/2756958/how-yield-implements-the-pattern-of-lazy-loading).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:08:03.400

你的扩展方法类没有多大意义——你为什么不这样做呢？

```
 class Program
{
    static void Main(string[] args)
    {
        string[] myStrngs = new string[] { "Super", "Simple", "Okay" };
        IEnumerable<string> criteraStrngs = myStrngs.Where(x => x.StartsWith("s"));

        string s1 = "dotnet";
        int count = s1.Count();

        Console.ReadLine();

    }
} 
```

正如 Darin Dimitrov 之前所说 - 您仍然需要枚举 criteriaStrngs 才能从中获得结果 - 这是您原始代码的问题所在。

高温高压

# python - 用 mechanize 刮 way2sms

> ID：15043035
> 
> 赞同：0
> 
> 时间：2013-02-23T16:55:21.950
> 
> 标签：python, login, screen-scraping, mechanize-python, way2sms

我正在尝试通过抓取 way2sms.com 发送短信，但我无法使用 mechanize 登录 way2sms.com。

我正在使用以下代码提交登录表单。

```
import mechanize
br = mechanize.Browser()
br.set_handle_robots(False)
br.set_handle_refresh(False)
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0')]
res=br.open('http://wwwa.way2sms.com/content/prehome.jsp')
link=list(br.links())[5]
res=br.follow_link(link)
br.form = list(br.forms())[0]
br.form.find_control('username').value=USERNAME    #user name
br.form.find_control('password').value=PASSWORD    #password
res=br.submit() 
```

提交表单后，再次收到登录页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-09T18:26:16.660

只需将用户名和密码替换为您的用户名和密码即可。

```
import mechanize
import cookielib
br = mechanize.Browser()

# Cookie Jar 
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

# Browser options
br.set_handle_equiv(True) 
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)

# Follows refresh 0 but not hangs on refresh > 0
br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)

# User-Agent
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]

url = 'http://site25.way2sms.com/content/index.html?'

#Opening WEbsite
op = br.open(url)

#Selection form
br.select_form(nr=0)

username = 'mobilenumberhere'
password = 'passwordhere'

#Give username and password
br.form['username'] = username
br.form['password'] = password

br.submit()

#To check whether log in Successful or not
if username in br.geturl():
     print "Login Failed" # Go to way2sms and enter wrong details. You will understand this.
else:
     print "Login Successful. You are at ", br.geturl() 
```

# java - 视图中的可绘制对象被压扁

> ID：15043037
> 
> 赞同：6
> 
> 时间：2013-02-23T16:55:29.860
> 
> 标签：java, android, android-viewpager, drawable, android-view

**问题和问题：**

我目前有一个视图寻呼机，里面只有 2 个页面/视图，它们水平相邻。

我的视图是自定义视图，它们以低不透明度/alpha 值在其顶部绘制双色渐变和图像。

我发现当我在屏幕上滑动以从第一个视图/页面移动到第二个视图/页面或反之亦然时，图像被压扁了。*我怎样才能阻止这种情况发生，并正常绘制它们？*

**例子：**

**左图**显示了第一个可见的视图，***预滑动***；**右图**显示了两个视图，***在 swipe 中途***。

![普通视图](../Images/1c5bfc702929c0754f49f2f459293c10.png) ![挤压视图，因为我正在刷卡中途](../Images/1a0ff71a8ffa7c42f82f4dd66cfa0c5c.png)

**代码：**

我有一个`Drawable`我之前设置的变量，`overlayImage`除了设置不透明度之外我没有做任何事情。

```
@Override
protected void onDraw(Canvas canvas) {
    p.setShader(new LinearGradient(0, 0, 0, getHeight(), startColor, endColor, Shader.TileMode.MIRROR));
    canvas.drawPaint(p);

    //Pretty sure the mistake is around these two next lines
    overlayImage.setBounds(canvas.getClipBounds());
    overlayImage.draw(canvas);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T21:24:48.783

我实际上认为它在你的

```
overlayImage.setBounds(canvas.getClipBounds()); 
```

行代码。当您获得最左侧（在最右侧滑动）视图的剪辑边界时，它正在获得可视区域的大小（即较小的收缩区域），因此图像被绘制到该收缩空间中。

您可能希望通过正在覆盖的视图的整体大小来设置边界，而不是剪裁的边界。改用画布的 getHeight() 和 getWidth() 并建立自己的界限。

我实际上认为你真的应该在你的设置代码中只设置一次 overlayImage 边界。绘制代码根本不需要设置它，然后当视图开始离开屏幕时，overlayImage 的绘制将自然地与绘图画布的其余部分一起移动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T21:09:24.740

我认为您需要`xml`在`drawable-hdpi`文件夹中创建一个。其中将包含您的`shader/linear gradiant`.. （选项请看[这里](http://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html)）

```
<?xml version="1.0" encoding="utf-8"?>

<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle">
    <gradient
        android:startColor="#474946"
        android:endColor="#181818"
        android:angle="270"/>
</shape> 
```

然后你可以设置`xml`为背景..这应该可以解决我认为的问题。

（如果它不起作用，请尝试不使用`android:shape="rectangle"`，这可能会有所帮助）

# iphone - 如何向 UINavigationController 添加阴影

> ID：15043038
> 
> 赞同：2
> 
> 时间：2013-02-23T16:55:31.233
> 
> 标签：iphone, objective-c, ios6, uinavigationcontroller, shadow

我想在 Path 或 Facebook 中创建一个幻灯片菜单，在我的菜单和 UINavigationController 之间有一个阴影，里面有所有内容。我可以为图层添加圆角，但我应用到图层的阴影未显示。该代码有什么问题？如果我使用 UIViewController 而不是 UINavigationController，它就可以工作...（代码位于作为 rootViewController 添加到 UINavigationController 的视图中）

问题是我不想松开 UINavigationController 的圆角边框

```
self.navigationController.view.layer.shadowPath = [UIBezierPath bezierPathWithRoundedRect:self.navigationController.view.bounds cornerRadius:self.navigationController.view.layer.cornerRadius].CGPath;
[self.navigationController.view.layer setMasksToBounds:YES];
[self.navigationController.view.layer setShadowColor:[UIColor blackColor].CGColor];
[self.navigationController.view.layer setShadowOffset:CGSizeMake(0, 0)];
[self.navigationController.view.layer setShadowOpacity:0.5];
[self.navigationController.view.layer setShadowRadius:3];
[self.navigationController.view.layer setCornerRadius:3]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:00:19.963

问题是

```
[self.navigationController.view.layer setMasksToBounds:YES]; 
```

顾名思义，图层之外的所有内容（包括阴影）都被遮盖了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-20T04:35:35.947

在 Swift3 中

```
self.navigationController?.view.layer.shadowOffset = CGSize(width: 0, height: 5)
self.navigationController?.view.layer.masksToBounds = true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:00:13.740

设置`setMasksToBounds`为`NO`.like 这个

```
[self.navigationController.view.layer setMasksToBounds:NO]; 
```

您可以在不丢失角落的情况下添加阴影，用您的代码试试这个

```
[self.navigationController.view setShouldRasterize:YES]; 
```

设置一些 shadowOffset 并尝试

```
setShadowOffset:CGSizeMake(0, 5) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-14T10:13:11.077

```
navigationController?.navigationBar.shadowImage = UIImage(named: "shadow") 
```

# java - twig-persist 的新 AnnonationObjectDatastore() 导致错误

> ID：15043039
> 
> 赞同：2
> 
> 时间：2013-02-23T16:55:33.017
> 
> 标签：java, google-app-engine, gwt

我正在将 twig-persist 用于谷歌应用引擎网络应用的数据存储功能。不幸的是，每次我通过远程过程调用（更具体地说，当`new AnnonationObjectDatastore()`被调用时）调用数据服务时，它都无法显示以下异常，我不知道我在做什么错，请帮助我。我在日食 java 7

```
public class DataServiceServlet extends RemoteServiceServlet implements UserDataService{
    ObjectDatastore datastore;
    public DataServiceServlet(){
        datastore  =  new AnnotationObjectDatastore();  
    }

    @Override
    public void SaveUser(ChewataUser user) {        
        //datastore.store(user);
    }
}

java.lang.NoClassDefFoundError: com/google/common/base/Function
    at com.google.chewata.server.DataServiceServlet.<init>(DataServiceServlet.java:15)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at org.mortbay.jetty.servlet.Holder.newInstance(Holder.java:153)
    at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:428)
    at org.mortbay.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:339)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:123)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:383)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.lang.ClassNotFoundException: com.google.common.base.Function
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:213)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    ... 43 more 
```

# erlang - 使用带钢筋的 NIF 编译项目：找不到 cl.exe

> ID：15043040
> 
> 赞同：2
> 
> 时间：2013-02-23T16:55:33.743
> 
> 标签：erlang, rebar

我是 erlang 和 rebar 的新手。在我的钢筋项目中，我使用了一个包含本机 c 代码的依赖项，并且在`rebar compile`我收到错误期间：

`Name cl.exe is not recognized as an internal or external command, operable program or batch file`

我猜 rebar 正在尝试使用 VisualStudio 中的 Microsoft cl.exe 编译器从我的依赖项中编译 c 文件，对吧？问题是我没有安装VS并且不想安装它。

为什么 rebar 尝试使用 cl.exe？我可以配置 rebar 以使用不同的编译器来编译 c 文件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T17:48:07.920

根据[rebar 端口编译器](https://github.com/basho/rebar/blob/master/src/rebar_port_compiler.erl#L46)代码中的注释，您可以通过在以下代码中添加类似的内容来提供替代 C 编译器`rebar.config`：

```
{port_env, [{"CC", "/path/to/gcc.exe"}]}. 
```

您很可能必须更改`CFLAGS`以匹配编译器。要编译 NIF 和端口，必须编译 OTP 头文件和开发库并使其可用。

# function - 数组被错误地称为子或函数

> ID：15043041
> 
> 赞同：1
> 
> 时间：2013-02-23T16:55:39.100
> 
> 标签：function, excel, multidimensional-array, compiler-errors, vba

我正在尝试将数据存储在数组中，但是`"Compile error: Sub or Function not defined"`当我尝试存储数据时会抛出异常。

我`CallsForecasted`在 sub 之前声明，以便将其公开如下。

```
 Dim CallsForecasted(1 To 22, 1 To 6) As Double 
```

这是我得到错误的循环。

```
 For icount = 1 To 22
        For jcount = 1 To 6
            Select Case jcount
            Case 1
                CallsForecasted(icount, jcount) = MondayForecast * Worksheets("Erlang").Range("B" & (2 + icount))
            Case 2
               CallsForecasted(icount, jcount) = TuesdayForecast * Worksheets("Erlang").Range("C" & (2 + icount))
            Case 3
                CallsForecasted(icount, jcount) = WednesdayForecast * Worksheets("Erlang").Range("C" & (2 + icount))
            Case 4
                CallsForecasted(icount, jcount) = ThursdayForecast * Worksheets("Erlang").Range("C" & (2 + icount))
            Case 5
                CallsForecasted(icount, jcount) = FridayForecast * Worksheets("Erlang").Range("C" & (2 + icount))
            Case 6
                CallsForecasted(icount, jcount) = SaturdayForecast * Worksheets("Erlang").Range("D" & (2 + icount))
            End Select
        Next jcount
    Next icount 
```

当抛出编译器错误时，`"CallsForecasted(icount, jcount) ="`突出显示的第一个实例（不是整行，只是那部分）。存储在数组中的所有内容都是一个数字。我认为编译器试图将数组作为子函数或函数调用。

我确实在代码的开头定义了函数，以便我可以使用 Erlang 计算，但在我编写其他任何内容之前它们都已结束。

有任何想法吗？这把我完全难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:10:25.140

移动 `Dim CallsForecasted(1 To 22, 1 To 6) As Double`到任何子例程或函数之上。

如果我将声明放在过程中的较低位置，我会收到“仅在 End Sub、End Function 或 End Property 之后出现注释”编译错误。奇怪的是，它仍然让我运行调用的过程，`CallsForecasted`然后我不再收到编译错误。但是我确实收到了您看到的“编译错误：未定义子或函数”。

所以，很混乱！

# node.js - 如何将“BatchGetItem”用于 NodeJS AWS-SDK for DynamoDB

> ID：15043043
> 
> 赞同：12
> 
> 时间：2013-02-23T16:56:04.840
> 
> 标签：node.js

我正在尝试使用 Node JS AWS-SDK 从 DynamoDB 表中获取项目。该功能`getItem`运行良好，但`BatchGetItem`更难使用。

我使用官方文档： [http ://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB/Client.html#batchGetItem-property](http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB/Client.html#batchGetItem-property)

我正在寻找有关如何正确使用此功能的示例，但找不到任何示例。我写的代码是：

```
var params = {

"RequestItems" : {
    "Keys" : [
      {"HashKeyElement" : { "N" : "1000" } },
      {"HashKeyElement" : { "N" : "1001" } }
    ]
  }
}

db.client.batchGetItem(params, function(err, data) {
  console.log('error: '+ err);
  console.log(jsDump.parse(data));
}); 
```

我收到一个`SerializationException: Start of list found where not expected`错误，但就我的 NodeJS 和 JSON 专业知识而言，我的语法是正确的。但这令人困惑： [http ://docs.aws.amazon.com/amazondynamodb/latest/developerguide/API_BatchGetItems.html](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/API_BatchGetItems.html)

在该语法示例中，您必须提供表名。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-05-28T23:06:34.217

我使用了 dynamo db 客户端版本......经过一个小时的研究，我设法让它工作......

```
var params = {

RequestItems: { // map of TableName to list of Key to get from each table
    Music: {
        Keys: [ // a list of primary key value maps
            {
                Artist: 'No One You Know',
                SongTitle:'Call Me Today'
                // ... more key attributes, if the primary key is hash/range
            },
            // ... more keys to get from this table ...
        ],
        AttributesToGet: [ // option (attributes to retrieve from this table)
            'AlbumTitle',
            // ... more attribute names ...
        ],
        ConsistentRead: false, // optional (true | false)
    },
    // ... more tables and keys ...
},
ReturnConsumedCapacity: 'NONE', // optional (NONE | TOTAL | INDEXES)
};
docClient.batchGet(params, function(err, data) {
    if (err) ppJson(err); // an error occurred
    else ppJson(data); // successful response

}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-15T00:14:03.577

我感觉到你的痛苦...... AWS 文档充其量是令人困惑的。我认为这是由老化的基础设施和糟糕的技术写作造成的。SDK 使用的 nodejs 和 JSON 语法让我想起了 XML 结构。

无论如何，我设法让 BatchGetItem 在整整一个小时后工作。参数应如下所示：

```
{
    "RequestItems": {
        "<TableName>": {
            "Keys": [
                {"<HashKeyName>": {"<type>":"<hash key value>"}},
                {"<HashKeyName>": {"<type>":"<hash key value>"}},
                {"<HashKeyName>": {"<type>":"<hash key value>"}}
            ]
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-10T00:27:01.837

我相信您缺少表名。你要这个：

```
var params = {

"RequestItems" : {
    "TableName": {
      "Keys" : [
        {"HashKeyElement" : { "N" : "1000" } },
        {"HashKeyElement" : { "N" : "1001" } }
      ]
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-06T20:45:20.260

我在这里尝试了所有解决方案，但没有一个对我有用，这可能意味着 NodeJS 库已经更新。参考他们更好的书面[文档](http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB/DocumentClient.html)，您应该能够提出如下请求：

```
var params = {
  RequestItems: {
    'Table-1': {
      Keys: [
        {
           HashKey: 'haskey',
           NumberRangeKey: 1
        }
      ]
    },
    'Table-2': {
      Keys: [
        { foo: 'bar' },
      ]
    }
  }
};

var docClient = new AWS.DynamoDB.DocumentClient();

docClient.batchGet(params, function(err, data) {
  if (err) console.log(err);
  else console.log(data);
}); 
```

具体来说，不再需要提供类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-13T01:24:16.420

在您的情况下，正确答案应该是：

```
var params = {
    "RequestItems": {
        "<table_name>": {
           "Keys": [
                {"HashKeyElement" : { "N" : "1000" } },
                {"HashKeyElement" : { "N" : "1001" } }
           ]
       }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-28T10:58:30.423

尝试这个：

```
db.client.batchGetItem(
{"RequestItems":{
     "TableName":{
           "Keys":[
               {"HashKeyElement"  : {"N":"1000"}},
               {"HashKeyElement"  : {"N":"1001"}}
           ]
       }
    }
}, function(err, result){ //handle error and result here  }); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-06-06T06:20:13.227

试试这个，虽然它未经测试：

```
var params = {
    TableName: "tableName",
    RequestItems : {
        Keys : [
            {
                HashKeyElement : { N : "1000" } 
            },
            {
                HashKeyElement : { N : "1001" } 
            }
        ]
    }
} 
```

# ruby-on-rails - rails model.save 返回 true 但不保存到 db

> ID：15043045
> 
> 赞同：1
> 
> 时间：2013-02-23T16:56:19.210
> 
> 标签：ruby-on-rails, rails-activerecord

我在模型中有一个函数，它执行一些操作 after_save

在该函数中，我有以下代码

```
progression = Progression.find_by_id(newprogression)
if progression.participation_id.nil?
  progression.participation_id = participation.id
  progression.save
else 
```

我看到的是进度没有更新。尽管以下

*   如果我在保存之前检查progress.participation_id 它已被更新
*   如果在调试器中我手动运行progress.save，我会返回true。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T13:34:00.503

我对 Rails 还是很陌生，但是每次我保存一些东西时，我都必须使用 bang 方法。你有没有尝试过`progression.save!`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-13T20:21:16.003

好的，我遇到了同样的问题，我设法解决了。问题出在关联名称上。我有一个名为 User 的模型和一个名为 Update 的子模型，其中包含每个用户的新更新数量。所以，在 user.rb 我有这一行：

```
has_one :update 
```

在我删除这一行之后，一切又开始工作了。看起来这是一个 rails 保留名称，在创建模型时不应使用它。也许你在这里遇到了同样的问题。可惜Rails 没有指出这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T15:45:07.400

`save`并`after_save`在同一个事务中运行。也许这是个问题。尝试使用`after_commit`回调

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:16:28.457

尝试

```
progression = Progression.find_by_id(newprogression)
if progression.participation_id.nil?
  progression.update_attributes(
     :participation_id => participation.id
  )
else 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T18:11:05.337

可能是缓存问题。从[AR Relations - Sec 3.1 的 rails 指南中](http://guides.rubyonrails.org/association_basics.html)，您可能希望通过传递 true 来重新加载缓存。如果您通过参与进行检查，在通过进度建立链接之后，您可能会遇到这种情况。

假设 Progression belongs_to 参与，

你能试试：progression.participation = 参与然后progression.save

另外，请尝试：partition.progressions << progress 和participation.save ？

# php - 无法让 PHP RegEx 匹配 / 和 - 文字

> ID：15043058
> 
> 赞同：0
> 
> 时间：2013-02-23T16:57:18.250
> 
> 标签：php, regex, preg-replace, preg-match, pcre

我正在使用正则表达式来匹配模板文件中的链接对象。基本上，一个链接被识别，并且根据用户是否启用了 JS 将其转换为 javascript 或 HTML。

以下是示例链接的样子：

```
<div id="someDiv">{_LINK_9_link text here_noclass_noid_}</div> 
```

这是我用来在代码中查找这些对象的正则表达式：

```
$linkExp = '/\{_LINK_([0-9]+)_([a-z0-9 ]+)_([a-z0-9]+)_([a-z0-9]+)_\}/i'; 
```

就目前而言，此代码可以很好地执行上述示例，其中链接文本可以包含字母、数字或空格。但是，当我尝试将`/`或添加`-`到链接文本时，我无法让正则表达式继续工作。

这是我尝试过的：

```
<!-- html link code -->
<div id="someDiv">{_LINK_9_tips/suggestions_noclass_noid_}</div>
// php link expression
$linkExp = '/\{_LINK_([0-9]+)_([a-z0-9 \/\-]+)_([a-z0-9]+)_([a-z0-9]+)_\}/i'; 
```

但由于`/`. 如果我去掉斜线，它工作正常。关于如何匹配文字`/`或`-`正则表达式的任何想法？允许比字母、数字、空格、连字符或斜杠更多的字符会很好，但我是正则表达式的新手，所以我真的不知道我在做什么。如果有人可以帮助我修复它，以便它匹配链接文本的任何内容（甚至是符号，例如 &、%、$ 等），那也将非常感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T19:54:13.937

你几乎是对的，使用

```
$linkExp = '/\{_LINK_([0-9]+)_([a-z0-9 \/-]+)_([a-z0-9]+)_([a-z0-9]+)_\}/i'; 
```

1.  '-' 用于 [ ] 内的范围，例如 [az]，但如果放在末尾，则视为多一个字符，例如 [az-] 将匹配字母 + '-'

# clojure - 在 Clojure 中过滤一个集合 clojure.set/select vs. clojure.core/filter

> ID：15043059
> 
> 赞同：7
> 
> 时间：2013-02-23T16:57:24.523
> 
> 标签：clojure

我想过滤一组，例如：

```
(filter-set even? #{1 2 3 4 5})
; => #{2 4} 
```

如果我使用`clojure.core/filter`，我会得到一个不是集合的 seq：

```
(filter even? #{1 2 3 4 5})
; => (2 4) 
```

所以我带来的最好的是：

```
(set (filter even? #{1 2 3 4 5})) 
```

但我不喜欢它，从集合到列表再到集合看起来不是最佳选择。Clojurian 的方法是什么？

**更新**

我做了以下比较@A.Webb 和@Beyamor 的方法。有趣的是，两者的性能几乎相同，但`clojure.set/select`稍好一些。

```
(defn set-bench []
  (let [big-set (set (take 1000000 (iterate (fn [x] (int (rand 1000000000))) 1)))]
    (time (set (filter even? big-set))) ; "Elapsed time: 422.989 msecs"
    (time (clojure.set/select even? big-set))) ; "Elapsed time: 345.287 msecs"
    nil) ; don't break my REPL ! 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-23T17:45:22.057

[clojure.set](http://richhickey.github.com/clojure/clojure.set-api.html)是一个方便的 API，用于常见的集合操作。

在这种情况下，[clojure.set/select](http://richhickey.github.com/clojure/clojure.set-api.html#clojure.set/select)是一个特定于集合的过滤器。它通过从给定集合中分离不符合谓词的元素来工作。

```
(require 'clojure.set)

(clojure.set/select even? #{1 2 3 4 5})
; => #{2 4} 
```

# node.js - Mongoose 查找最新条目

> ID：15043061
> 
> 赞同：0
> 
> 时间：2013-02-23T16:57:39.047
> 
> 标签：node.js, socket.io, mongoose

我有一个如下所示的条目：

```
{
  "__v": 10,
  "_id": "50f8050ed714645500000002",
  "sid": "DI7gZ0sprJ",
  "lines": [
    {
      "text": "Well that's what some people say anyway",
      "_id": "50f80526d714645500000003",
      "user": "Player456"
    },
    {
      "text": "They're people just like the rest of us",
      "_id": "50f805925543712caf000005",
      "user": "Player123"
    },
  ],
  "title": "Test",
  "maxlines": 0
} 
```

并有一个如下所示的 socket.io 脚本：

```
socket.on('sendchat', function (data) {
    Story.findOne({ sid: socket.room }, function(err, story){
        if (err) {
            console.log(err);
        }
        else if(story == null) {
            console.log(err);
        }
        else {
            io.sockets.in(socket.room).emit('updatechat', socket.username, data);
            story.maxlines = story.maxlines - 1;

            if (story.maxlines == 0) {
                // End Game Script - Redirect to view page
                io.sockets.in(socket.room).emit('gameover', slugs(story.title), socket.room);
            }
            //Save Story to DB
            story.lines.push({
                user: socket.username,
                text: data
            });
            story.save(function(err, story){
                if (err) {
                    console.log(err);
                }
                else {
                    console.log("Story Updated");
                }
            });
        };
    });
}); 
```

有没有办法可以检查 socket.username 是否等于已输入的最新行上的用户？

例如上面的 Player123 是最后一个进入一行，所以如果 Player123 再次尝试它只会发出一个错误，但是如果 Player456 进入一行，那么 Player123 可以再次

我正在尝试创建一个简单的回合制游戏，该游戏会检查以确保一个人在轮不到他们时不能进入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:43:55.143

您可以直接检查对象中`lines`数组中的最后一个条目`story`。如：

```
if (story.lines.length &&
    story.lines[story.lines.length-1].user === socket.username) {
    // error, same user is trying to enter another line
} 
```

# ruby-on-rails - rails 3.2 中缺少 HTemplate

> ID：15043062
> 
> 赞同：0
> 
> 时间：2013-02-23T16:57:44.513
> 
> 标签：ruby-on-rails

我正在尝试使用 rails 创建一个简单的 micropost 应用程序...

这是我的模型：

```
Class Micropost < ActiveRecord::Base
     attr_accessible :content, :name
end 
```

控制器：

```
class MicropostsController < ApplicationController
    def create
        @blog=Micropost.new( :content => params[:content])
        @blog.save
        redirect_to microposts_show_path
    end

    def show
        @mblg=Micropost
    end

    def index
    end    
end 
```

意见：

```
create.html.erb

<h1>Microblogs#create</h1>
<p></p>
<%= label_tag(:content) %><br/>
<%= text_field_tag (:content) %><br/>
<%= submit_tag("submit") %><br/>

index.html.erb
<h1>Microblogs#index</h1>
<p>Find me in app/views/microblogs/index.html.erb</p>

show.html.erb
<h1>Microblogs#show</h1>
<p></p>
<%= @mblg.each.do |variable|%>
    <p><%= variable.content %></p>
<%end%> 
```

路由.rb

```
Blog::Application.routes.draw do

  get "microposts/create"

  get "microposts/show"

  get "microposts/index"
end 
```

我收到模板丢失错误...这是一个相当简单的应用程序...您能指出我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:14:16.230

Rails 中的 RESTful 控制器具有隐藏操作（创建、更新、销毁）

控制器（如果作为脚手架的一部分创建）将有四个对用户可见的操作

```
index
new
show
edit 
```

在我们的路由文件中，您可以调用

```
resources :microposts 
```

Rails 将理解并为 RESTful 控制器创建路由。

而不是`/microposts/create`你会使用`/microposts/new`

一个很好的例子是脚手架。

在 Rails 根目录中，执行以下操作

```
rails g scaffold foo bar
rake db:migrate 
```

您将看到这创建了一个 Foo 控制器并允许您在此控制器上新建/索引/编辑/显示。您将要输入和填充的字段是 bar。

一旦你玩完这个，你可以做

```
rails d scaffold foo
rake db:rollback 
```

# php - 从 bbPress 运行 Minecraft 命令

> ID：15043063
> 
> 赞同：1
> 
> 时间：2013-02-23T16:57:48.720
> 
> 标签：php, wordpress, minecraft, bukkit, bbpress

好的，大家好。问你这个问题可能真的很奇怪，但是当我的 Minecraft 服务器论坛上的某个人在论坛中创建一个主题时，有没有办法：“介绍你自己”它会给他们钱。我已经有执行此操作的命令，希望可以执行此操作。

还有可能他们只能在他们的论坛帐户下进行一次。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:10:30.870

我会尝试通过[rcon](http://www.wiki.vg/Rcon)来做。rcon 是一个非常简单的服务器管理协议，基本上可以让您远程访问服务器管理控制台。编写一个连接到 rcon 并运行一个命令来给特定玩家一些东西的 PHP 脚本应该不难，如果已经有一个执行它的命令。

# django - 用于自定义权限的 Django 自定义装饰器

> ID：15043065
> 
> 赞同：4
> 
> 时间：2013-02-23T16:58:00.497
> 
> 标签：django, permissions, python-decorators

有一个`Project`模型与模型具有多对多关系`User`，使用连接表。如果用户不是项目的成员（不在连接表中），我想阻止用户访问显示特定项目的视图。

我知道它可以通过视图方法中的简单 if 语句或模板中的自定义过滤器来解决，但我希望能够使用自定义装饰器来做到这一点。这可能吗？如果是这样怎么做？

就像是：

```
def may_user_view_this(function):
    def wrapper(request, *args, **kwargs):
        user = request.user
        project = Project.objects.get(id=???????) #id
        if not project.has_user(user):
            return HttpResponse('You cannot view this.')
        else:
            return function(request, *args, **kwargs)
    return wrapper

@may_user_view_this() # if not go the specific url
def my_view(request, page_id=None):
    # do stuff and render 
```

如何访问从装饰器函数`page_id`发送到的参数？`my_view`

# visual-studio-2010 - 更改分析器信息的背景颜色

> ID：15043068
> 
> 赞同：1
> 
> 时间：2013-02-23T16:58:12.303
> 
> 标签：visual-studio-2010, themes, color-scheme

我确实在 Visual Studio 中安装了“黑曜石之子”主题。今天，我使用了集成分析器，几乎无法读取每行百分比，并且突出显示有点偏离。毫无疑问，这是因为主题。

我试图在选项中找到相关的配置条目，但到目前为止我还没有运气。我在哪里可以配置百分比的背景颜色和突出显示颜色？

这是一个截图来说明我的问题：

![我想定义其他颜色的地方](../Images/00719caf86ff90f339cefc3714fb8684.png)

同时，我尝试直接使用 xml 文件 (.vssettings) 对其进行更改，到目前为止还没有运气。我将 xml 中的所有颜色都更改为红色，但栏的背景颜色不会改变。textcolor 与编辑器中的普通 textcolor 相同。如果那是白色或浅灰色，则分析信息很难辨认。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-03T19:56:56.307

我知道这是一个老问题，但对于碰巧遇到此问题的其他人来说，这是解决方法：

在 VS2013 中：工具 -> 选项 -> 环境 -> 字体和颜色。

在显示项目框中的文本编辑器设置下，您可以通过编辑指示器边距来更改边距。

# actionscript-3 - 这个类是如何连接到声音的？

> ID：15043070
> 
> 赞同：1
> 
> 时间：2013-02-23T16:58:31.153
> 
> 标签：actionscript-3, class, audio, embed

我试图使用（很成功）来使用这个声音类

[http://www.mcfunkypants.com/2011/as3-pitch-shift-mp3/](http://www.mcfunkypants.com/2011/as3-pitch-shift-mp3/)

示例代码如下所示。. .

```
public class Pitch_Shift_Example extends Sprite
    {

        [Embed(source='Pitch_Shift_Example.mp3')]
        private var engine_mp3 : Class;
        public var engine_loop:Pitch_Shift_MP3;

        public function Pitch_Shift_Example()
        {
            engine_loop = new Pitch_Shift_MP3(engine_mp3);
            stage.addEventListener(MouseEvent.MOUSE_MOVE, onMouseMove);
            var someText:TextField = new TextField();
            someText.x = 200;
            someText.y = 0;
            someText.textColor = 0xFFFFFF;
            someText.selectable = false;
            someText.autoSize = TextFieldAutoSize.LEFT;
            someText.text = "Pitch Shift MP3 Demo by Breakdance McFunkypants\nMove your mouse to change the sample rate. Enjoy!";
            addChild(someText);
        }

        private function onMouseMove(event:MouseEvent):void
        {
            engine_loop.rate = (mouseX / stage.width) * 2;
        }

    } 
```

现在让我感到困惑的是 engine_mp3 类是如何使用声音的。

第一行嵌入声音。
第二行创建了一个名为engine_mp3 的空类。
第 3 行创建了一个新的音调转换类，在第 7 行我们传递了（空的）engine_mp3 类。

基本上 engine_mp3 是如何获取 mp3 数据的？

任何帮助表示赞赏。

安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:24:42.980

它的工作原理是这样的：

您使用以下两行嵌入 mp3 文件：

```
Embed(source='Pitch_Shift_Example.mp3')]
private var engine_mp3 : Class; 
```

这两条线一起工作。第一行是嵌入*元数据*，描述了它下面的行。它所做的是嵌入 mp3 文件并使其可以作为一个类访问。因此，您可以使用变量 name 引用这个嵌入的声音类`engine_mp3`。

稍后在您的代码中，您实例化该类的一个新实例`Pitch_Shift_MP3`，并将引用传递给您的嵌入式声音类`engine_mp3`：

```
engine_loop = new Pitch_Shift_MP3(engine_mp3); 
```

音高转换类的构造函数期望一个类（表示声音）作为其单个参数。它必须在自己的代码中做的是`engine_mp3`通过这样做来实例化表示的类：

```
var instantiatedSound:Sound = new engine_mp3() as Sound; 
```

希望这是有道理的！

# java - 我想在java中生成一个pdf文件并将文本放在特定位置

> ID：15043072
> 
> 赞同：2
> 
> 时间：2013-02-23T16:58:51.723
> 
> 标签：java

我想在java中生成一个pdf文件，我可以将文本放在特定位置，然后打印该文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:16:10.597

所以首先你想生成一个pdf然后在上面放文本，或者你想让一个文本文件在上面放文本然后把它转换成pdf文件？我对此并不熟悉，但我将遵循的方法是：1）创建文件并向其中添加文本 2）将此文本文件转换为 pdf 文件 3）打印文件

现在，创建一个文件并向其中添加文本很容易，检查 bufferedwriter、inputstreamwriter 等。对于生成 pdf，我还要检查 iText 库。以下是一些有用的链接： [http ://www.dreamincode.net/forums/topic/78413-java-textfile-to-pdf-file-conversion/](http://www.dreamincode.net/forums/topic/78413-java-textfile-to-pdf-file-conversion/)

[http://www.roseindia.net/java/java-conversion/TextToPDF.shtml](http://www.roseindia.net/java/java-conversion/TextToPDF.shtml)

# perl - 使用 Perl 将 2 天添加到今天

> ID：15043082
> 
> 赞同：6
> 
> 时间：2013-02-23T16:59:18.817
> 
> 标签：perl, time

我想使用 perl 并从今天开始添加两天并将其输出为 unix 时间。我找到了很多关于如何将 Unix 时间转换为可读时间的信息，但我需要输出是 unix 时间。我找到了这个

```
my $time = time;    # or any other epoch timestamp 
my @months = ("Jan","Feb","Mar","Apr","May","Jun","Jul",
              "Aug","Sep","Oct","Nov","Dec");
my ($sec, $min, $hour, $day,$month,$year) = (localtime($time))[0,1,2,3,4,5]; 
# You can use 'gmtime' for GMT/UTC dates instead of 'localtime'
print "Unix time ".$time." converts to ".$months[$month].
      " ".$day.", ".($year+1900); 
```

如何获取当前时间并添加 2 天并输出为 Unix 时间。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-23T17:24:43.957

您是否考虑过使用该[`DateTime`](http://search.cpan.org/perldoc?DateTime)软件包？它包含许多日期操作和计算例程，包括添加日期的能力。

[这里](http://datetime.perl.org/wiki/datetime/dashboard)有一个带有示例的常见问题解答（特别是，请参阅示例计算和日期时间格式部分）。

这是一个片段：

```
use strict;
use warnings;

use DateTime;

my $dt = DateTime->now();
print "Now: " . $dt->datetime() . "\n";
print "Now (epoch): " . $dt->epoch() . "\n";

my $two_days_from_now = $dt->add(days => 2);
print "Two days from now: " . $two_days_from_now->datetime() . "\n";
print "Two days from now (epoch): " . $two_days_from_now->epoch() . "\n"; 
```

产生以下输出：

```
Now: 2013-02-23T18:30:58
Now (epoch): 1361644258
Two days from now: 2013-02-25T18:30:58
Two days from now (epoch): 1361817058 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T21:44:53.453

yuu 可以更改时间戳，即从 epoc 开始的秒数

改变

```
my $time = time; 
```

至

```
my $time = time + 2 * 24 * 60 * 60 ; # 60 seconds 60 minutes 24 hours times 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T06:54:56.263

现在是`time()`。两天后是`time() + 2 * 86400`。今天（当天开始的午夜）是`int(time() / 86400) * 86400`。从今天开始的两天是今天加上 2 * 86400。在标量上下文中，除非您真的想要或（来自 POSIX 模块）`localtime`，否则会将它们中的任何一个作为可读日期打印出来。`gmtime``strftime`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-24T09:59:28.850

该`time`函数返回当前纪元秒数，核心模块`Time::Seconds`为时间段提供有用的常量。

```
use strict;
use warnings;

use Time::Seconds 'ONE_DAY';

print time + ONE_DAY * 2; 
```

**输出**

```
1361872751 
```

# asp.net - 如果用户控制中的脚本，我如何从 asp.net 服务器端调用 JavaScript 函数

> ID：15043087
> 
> 赞同：2
> 
> 时间：2013-02-23T17:00:08.123
> 
> 标签：asp.net

我有一个注册了 1 个用户控件的 ASP.NET 页面。

我有一个服务器控制

```
<asp:LinkButton ID="vidoUpdatebtn" OnClick="vidoUpdatebtn_Click" runat="server">LinkButton</asp:LinkButton> 
```

在 .cs 我处理

```
 protected void vidoUpdatebtn_Click(object sender, EventArgs e)
    {
        //do something
        ScriptManager.RegisterStartupScript(this, this.GetType(), "myscript", "doSomeThing()", true);

    } 
```

在用户控制中我有函数 doSomeThing()

```
 function doSomeThing() {
         alert("TestReady");
     } 
```

当我单击 LinckButon 注册功能不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:14:50.673

在 PageLoad 中写这个（你写的唯一修改是注册的时间——PageLoad 不是点击，点击太晚了，你必须在此处编写 javascript 函数的实际实现）：

```
 protected void Page_Load(object sender, EventArgs e) {
        ScriptManager.RegisterStartupScript(this, this.GetType(), "myscript", 
@"function doSomeThing() {
    alert(""TestReady"");
}"
        , true);
    } 
```

这在 asp:LinkBut​​ton 标记中（您必须指定 OnClientClick 属性）：

```
<asp:LinkButton ID="vidoUpdatebtn" runat="server" OnClick="vidoUpdatebtn_Click" OnClientClick="doSomeThing()" >LinkButton</asp:LinkButton> 
```

它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:05:26.867

您是否尝试过这种方式：

在您的 aspx 页面上添加脚本管理器

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" /> 
```

代码隐藏：

```
Page.ClientScript.RegisterStartupScript(this.GetType(),"myscript", "doSomeThing()",true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:05:57.117

如果您希望客户端代码在按钮单击时运行，您可以使用 OnClickClick 属性而不是 OnClick 事件。这也将避免回发的需要，并将立即向用户提供反馈。

例如

```
<asp:LinkButton ID="vidoUpdatebtn" OnClientClick="alert('TestReady'); return false;" runat="server">LinkButton</asp:LinkButton> 
```

# wordpress - WordPress 重定向

> ID：15043096
> 
> 赞同：0
> 
> 时间：2013-02-23T17:00:58.680
> 
> 标签：wordpress

我正在制作一个小插件，它只是将一个 URL 重定向到另一个。我的代码如下

```
add_action("init","redirect");

function redirect()
{
    add_rewrite_rule('^/this_is_url/$','another_url','top');
    flush_rewrite_rules();
} 
```

我不知道为什么这段代码不起作用。有什么遗漏吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T05:44:09.060

正如尼古拉斯所提到的，我要么使用

```
wp_redirect( home_url() ); 
```

参考：[http ://codex.wordpress.org/Function_Reference/wp_redirect](http://codex.wordpress.org/Function_Reference/wp_redirect)

或者

```
header("Location: url.com/link/"); 
```

参考： http: [//php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

另请注意，这也是考虑到您如何激活重定向。除了初始化重定向之外，您还会添加一个 admin_menu 项，将用户从设置页面重定向到另一个位置吗？

有关任何插件指南，请参阅[https://codex.wordpress.org/Writing_a_Plugin](https://codex.wordpress.org/Writing_a_Plugin)。

# memory - 块和分配管理中的 cuda 最大数量

> ID：15043099
> 
> 赞同：0
> 
> 时间：2013-02-23T17:01:09.463
> 
> 标签：memory, memory-management, cuda, limit, register-allocation

我正在编写一个 CUDA 内核，我必须在这个设备上执行：

```
name: GeForce GTX 480
CUDA capability: 2.0
Total global mem:  1610285056
Total constant Mem:  65536
Shared mem per mp:  49152
Registers per mp:  32768
Threads in warp:  32
Max threads per block:  1024
Max thread dimensions:  (1024, 1024, 64)
Max grid dimensions:  (65535, 65535, 65535) 
```

内核的最小形式是：

```
_global__ void CUDAvegas( ... )
{
devParameters p;
extern __shared__ double shared[];
int width = Ndim * Nbins;
int ltid = p.lId;
while(ltid < 2* Ndim){
shared[ltid+2*width] = ltid;
ltid += p.lOffset; //offset inside a block
}
__syncthreads();
din2Vec<double> lxp(Ndim, Nbins);

__syncthreads();
for(int i=0; i< Ndim; i++){
  for(int j=0; j< Nbins; j++){
    lxp.v[i][j] = shared[i*Nbins+j];
    }
}
}// end kernel 
```

其中 Ndim=2, Nbins=128, devParameters 是一个类，其方法 p.lId 用于计算本地线程的 id（在块内），而 din2Cec 是一个类，用于使用新命令（在它的析构函数中，我实现了对应的 delete[])。nvcc 输出为：

```
nvcc -arch=sm_20   --ptxas-options=-v   file.cu -o file.x
ptxas info    : Compiling entry function '_Z9CUDAvegas4LockidiiPdS0_S0_P7sumAccuP17curandStateXORWOWS0_i' for 'sm_20'
ptxas info    : Function properties for  _Z9CUDAvegas4LockidiiPdS0_S0_P7sumAccuP17curandStateXORWOWS0_i
               0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 22 registers, 116 bytes cmem[0], 51200 bytes cmem[2] 
```

线程数与多处理器限制兼容：最大共享内存、每个线程的最大寄存器和 MP 和每个 MP 的扭曲。如果我启动 64 个线程 X 30 个块（每块共享内存为 4128），没关系，但如果使用超过 30 个块，我会收到错误：

```
cudaCheckError() failed at file.cu:508 : unspecified launch failure
========= Invalid __global__ read of size 8
=========     at 0x000015d0 in CUDAvegas
=========     by thread (0,0,0) in block (1,0,0)
=========     Address 0x200ffb428 is out of bounds 
```

我认为这是分配单线程内存的问题，但我不明白每个 MP 和总块的限制是什么......有人可以帮助我或提醒正确的话题吗？

PS：我知道提供的内核什么都不做，但这只是为了了解我的极限问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T21:03:27.513

我认为您收到的错误是解释性的。指出存在大小为 8 的数据类型的全局越界读取。负责越界读取的是块 (1,0,0) 中的线程 (0,0,0) . 我怀疑负责任的指令`lxp.v[i][j] = shared[i*Nbins+j];`在最后一个嵌套`for`循环中。可能您分配的全局内存量与您启动的块数无关，因此当您启动太多块时，您会收到这样的错误。

# java - Cassandra 选择按添加日期排序的行

> ID：15043100
> 
> 赞同：1
> 
> 时间：2013-02-23T17:01:12.103
> 
> 标签：java, nosql, cassandra

我尝试在 Cassandra 中存储时事通讯邮件应用程序的电子邮件。

当前架构是：

```
CREATE TABLE emails (
    email varchar,
    comment varchar,
    PRIMARY KEY (email)); 
```

我不知道如何获取按添加时间排序的电子邮件（因此可以在不同节点上并行处理电子邮件）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T13:53:49.460

cassandra 上的 PlayOrm 可以在幕后为您做这类事情，只要您能够对数据进行分区以便仍然可以扩展。您可以查询您的分区。order by 尚不存在，但一个技巧是使用 where time > 0 来获取 1970 纪元之后的所有内容，这迫使它使用时间索引，然后只是向后遍历光标以进行反向排序（或向前遍历排序顺序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:54:11.233

Cassandra 根据您的列比较器在写入时订购。您不能使用谓词中的任意列对结果进行排序。如果要按时间顺序检索，则必须插入时间戳作为列名（或复合名称中的第一个元素）。您还可以创建第二个 CF 来存储按时间排序的记录，如果需要，您可以查询这些记录。不幸的是，CQL 给人一种类似于 RDBMS 的查询能力的错觉，而实际上它仍然是具有相关查询能力的列存储。我的建议是避免使用 CQL（并改用基于 Thrift 的查询）或确保您了解它在幕后所做的事情。

# java - Android TabListener：onTabSelected - 将片段添加到后台堆栈

> ID：15043101
> 
> 赞同：2
> 
> 时间：2013-02-23T17:01:16.663
> 
> 标签：java, android, android-fragments, android-tabs

我在我的 Android 应用程序中使用了`TabListener`与此类似的应用程序：http: [//developer.android.com/guide/topics/ui/actionbar.html#Tabs](http://developer.android.com/guide/topics/ui/actionbar.html#Tabs)

我的`onTabSelected`实现：

```
public void onTabSelected(Tab tab, FragmentTransaction ft) {
    Fragment preInitFrag = mActivity.getFragmentManager().findFragmentByTag(mTag);
    if (preInitFrag == null) {
        mFragment = Fragment.instantiate(mActivity, mClass.getName(), mArgs);
        ft.add(android.R.id.content, mFragment, mTag);
    } else {
        ft.attach(preInitFrag);
    }
} 
```

每次选择选项卡时，我都想将其添加到后台堆栈。我怎样才能做到这一点？使用参数`ft`with `ft.addToBackStack("test")`，它不起作用。它抛出一个致命的异常：

```
java.lang.RuntimeException:
    Unable to start activity ComponentInfo{.../...BaseActivity}:
java.lang.IllegalStateException:
    This FragmentTransaction is not allowed to be added to the back stack. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T20:58:42.633

您在问题中链接到的[ActionBar 指南有关于后台堆栈的说明（在选项卡侦听器示例代码下方的“警告”部分中）：](http://developer.android.com/guide/topics/ui/actionbar.html#Tabs)

> 您也不能将这些片段事务添加到后台堆栈。

该指南没有解释原因，但不支持您想要的。您必须以其他方式保留标签历史记录，或者根本不保留标签历史记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-11T17:22:56.017

在 onTabChanged 回调中创建您自己的 FragmentTrasaction，然后尝试 commit(); 检查以下链接。

[不允许将 FragmentTransaction 添加到后台堆栈？](https://stackoverflow.com/questions/8231161/fragmenttransaction-is-not-allowed-to-be-added-to-back-stack/14389790#14389790)

# java - 从表单中获取日期并保存到数据库中并列出产品

> ID：15043103
> 
> 赞同：0
> 
> 时间：2013-02-23T17:01:31.930
> 
> 标签：java, sql, jdbc

我正在尝试创建一个页面，该页面可以列出保存在数据库中的产品，然后客户可以查看可用产品列表。我遇到的问题是 Java 中的日期。

```
package servlets;

import bean.ProductBean;
import db.JavaConnect;
import helper.ProductHelper;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class AddNewProduct extends HttpServlet {

    public static final String Addproduct = "Addproduct";
    public static final String productfailed = "productfailed";

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        try {
            ProductBean addproduct = new ProductBean();
            ProductHelper.populateaddproduct(addproduct, request);
            addproduct(addproduct);
            request.setAttribute(Addproduct, addproduct);
        }

        catch (Throwable ex) {
            Logger.getLogger(AddNewProduct.class.getName()).log(Level.SEVERE, null, ex);
            request.setAttribute(productfailed, ex);
        }
        request.getRequestDispatcher("Addproductstatus.jsp").forward(request, response);
    }

    public void addproduct(ProductBean addproduct) throws ApplicationException {
         Connection conn = null;
         PreparedStatement pst = null;
         Statement rowIDStmt = null;
         ResultSet rs = null;
         try {
             conn = JavaConnect.ConnectDb();
            String sql = "INSERT INTO products(EAN,PIP,name,description,supplier,price,expiryDate,latest,discount)VALUES(?,?,?,?,?,?,?,?,?)";
             pst = conn.prepareStatement(sql);
             pst.setString(1, addproduct.getEan());
             pst.setString(2, addproduct.getPip());
             pst.setString(3, addproduct.getName());
             pst.setString(4, addproduct.getDescription());
             pst.setString(5, addproduct.getSupplier());
             pst.setDouble(6, addproduct.getPrice());

             // problem here
             java.sql.Date sqlDate = new java.sql.Date(addproduct.getExpiryDate().getTime());
             pst.setDate(7,addproduct.getExpiryDate());

             pst.setString(8, addproduct.getLatest());
             pst.setString(9, addproduct.getDiscounted());

             pst.executeUpdate();
             rowIDStmt = conn.createStatement();
rs = rowIDStmt.executeQuery("SELECT last_insert_rowid()");
rs.next();
             Integer autoIncreamentId = rs.getInt(1);
             Logger.getLogger(AddNewProduct.class.getName()).log(Level.INFO,
 "Successfully inserted row with id {0}", autoIncreamentId);
         } 
catch (Throwable t)
 {
             throw new ApplicationException(t.getMessage(), t);
         } 
finally {
             JavaConnect.close(null, rowIDStmt, rs);
             JavaConnect.close(conn, pst, null);
         }
     } // end catch } 
```

我收到的错误消息是

```
no suitable method found for setDate(int.java.util.date)
method prepared statement.setDate(int.java.sql.date,Calender) is not applicable.
method prepared statement.setDate(int.java.sql.Date) is not applicable and cannot be converted to java.sql.date by method invocation. 
```

有人可以告诉我有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:14:08.193

代替

```
 java.sql.Date sqlDate = new java.sql.Date(addproduct.getExpiryDate().getTime());   
  pst.setDate(7,addproduct.getExpiryDate()); 
```

经过

```
java.sql.Date sqlDate = new java.sql.Date(addproduct.getExpiryDate().getTime()); 
pst.setDate(7,sqlDate); 
```

# java - 如何使用 For 循环的每种类型迭代通用列表

> ID：15043105
> 
> 赞同：2
> 
> 时间：2013-02-23T17:01:39.217
> 
> 标签：java, collections, foreach, generic-list

我被分配创建一个列表列表，我应该能够使用“for each”类型的“for”循环遍历列表，而不是为迭代器构建一个构造函数。问题是，当我编写下面的代码时，我收到错误消息“只能遍历数组或 java.lang.Iterable 的实例”。这是代码：

```
public static void main(String[] args) {
    GList<InnerList> list = new GList<InnerList>(); 
    GList<InnerList> numList = new GList<InnerList>();
    InnerList lst = new InnerList ();
    Scanner sc = new Scanner(System.in);
    String answer;      
    while (true){
        System.out.println ("Do you want to create a list (y/n)? ");
        answer = sc.next();
        if (answer.equals("y")){
            System.out.println("Enter the name of the list: ");
            answer = sc.next();
            lst.setName(answer);
            if (list.isEmpty()== true){
                list.insertFirstItem(lst);
            }
            else {
                list.insertNext(lst);
            }           
        }               
        while (true){
            System.out.println("Do you want to enter a number (y/n)?");
            answer = sc.next();
            if (answer.equals("y")){
                System.out.println("Enter Number: ");
                answer = sc.next();
                try {
                    int num1 = Integer.parseInt(answer);
                    lst.setInner(num1);
                    if (list.isEmpty() == true){
                        list.insertFirstItem(lst);  
                    }
                    else {
                        list.insertNext(lst);
                    }                       
                }
                catch (NumberFormatException e){
                    System.out.println("You must enter an number! " + e);
                    sc.close();
                }                       
            }
            return;
        }       
    }
    for (GList<InnerList> ilName : list){ //here are my error msgs. I also tried replacing GList<InnerList> with 'InnerList' and String. 
        for(GList<InnerList> ilInts : list){
            System.out.println(ilName);
            System.out.println(ilInts);
        }
    }       
} 
```

有人可以帮我理解为什么当集合应该是可迭代的时 GList 不被视为 java.lang.iterable 的实例吗？

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T17:03:48.523

它不被视为一个实例，`java.lang.Iterable`因为它没有实现 interface `java.lang.Iterable`。就如此容易。将其声明更改为

```
public class GList<T> implements Iterable<T> 
```

你会很高兴使用它的 foreach 循环。但是因为`list`是 的一个实例`GList<InnerList>`，并且因为 a`GList<InnerList>`包含的实例`InnerList`（至少，我猜是这样），所以循环应该是：

```
for (InnerList innerList : list) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-23T17:19:00.343

这是一个语法错误，coorect 语法是 ,

```
for(InnerList ilName : GList) {
   for(InnerList ilInts : GList) {
     System.out.println(ilName);
     System.out.println(ilInts);
    }
} 
```

希望这可以帮助

# python - 将 strftime() 传递给 Google 应用引擎和 jinja2

> ID：15043106
> 
> 赞同：0
> 
> 时间：2013-02-23T17:01:39.430
> 
> 标签：python, html, google-app-engine, jinja2

我有一个 Google App Engine Python 脚本试图将变量“时间”作为`strftime()`调用传递。我已将 jinja2 设置为读取其中包含`{{time}}`变量目标的 html 文件

```
class MainPage(BlogHandler):

    time = ''

    def get_time(you):
        return strftime('%U %A',gmtime())

    def get(self):
        time = self.get_time
        self.render('front.html',time = time) 
```

当我将整个内容呈现/写出到一个简单的 div 标签中时，我得到一个以 html 呈现的对象内存定位器

```
<bound method MainPage.get_time of <main.MainPage object at 0x1030f0610>> 
```

显然它没有将其作为字符串处理。我是否使用了错误的时间功能，这是 GAE 问题吗？这是 Jinja2 的问题吗？这是一个python问题吗？我显然不确定如何跟进和解决这个问题。谢谢或任何好的批评建议。

我想要的只是将一个可格式化的时间函数呈现为一个字符串，这样我就可以在 GAE 脚本中使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:03:17.817

您所要做的就是*调用*该`get_time()`方法：

```
time = self.get_time() 
```

通过*不*调用该方法，您所做的只是存储对该方法的引用，然后 Jinja2 将该方法的`str()`结果包含在您的模板输出中：

```
>>> from time import strftime, gmtime
>>> class MainPage():
...     def get_time(self):
...         return strftime('%U %A',gmtime())
... 
>>> mp = MainPage()
>>> mp.get_time
<bound method MainPage.get_time of <__main__.MainPage instance at 0x1031c7320>>
>>> mp.get_time()
'07 Saturday' 
```

# javascript - 根据单选按钮值重定向浏览器

> ID：15043117
> 
> 赞同：6
> 
> 时间：2013-02-23T17:03:14.637
> 
> 标签：javascript, jquery

有没有更简单的方法可以根据单选按钮的选择来重定向浏览器？这可行，但从我在万维网上阅读的内容来看，可能有一种更简单的方法。

这是我的表格：

```
<form>
<input type="radio" name="value" value="google"><span>Google</span><br>
<input type="radio" name="value" value="yahoo"><span>Yahoo</span><br>
<input type="radio" name="value" value="bing"><span>Bing</span> 
```

这是我的jQuery：

```
$(function() {
$("input[name$='value']").click(function() {
    var value = $(this).val();
    if (value == 'google') {
        window.location.assign("http://www.google.com");
    }
    else if (value == 'yahoo') {
        window.location.assign("http://www.yahoo.com");
    }
    else if (value == 'bing') {
        window.location.assign("http://www.bing.com");
    }
});}); 
```

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T17:10:41.780

我会将 html 更改为以下内容：

```
<form>
<input type="radio" name="redirect" value="http://google.com"><span>Google</span><br>
<input type="radio" name="redirect" value="http://yahoo.com"><span>Yahoo</span><br>
<input type="radio" name="redirect" value="http://bing.com"><span>Bing</span>
</form>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
$('input[type="radio"]').on('click', function() {
     window.location = $(this).val();
});
</script> 
```

我也会更改为 .on() 方法，因为它只是调用 .on() 。原因是 .click() 只是调用了 .on() 方法，创建了一个额外的函数调用，而这并不是真正必要的。加上 .on() 更加灵活！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:10:16.143

`**[LIVE DEMO](http://jsbin.com/ahalan/1/edit)**`

```
$(function() {

    $("input[name$='value']").change(function() {
        window.location.assign("http://www."+ this.value +".com");
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T19:53:54.913

`window.location.replace`如果您需要http重定向，那将是可行的方法。但是，如果您希望保留历史记录（正常运行的浏览器后退按钮），那么其中一个`window.location`或`window.location.href`将是您最好的选择。如果它是单页应用程序，那么您还可以考虑`window.location.hash`更改散列 url。

要获取单选按钮的值，您可以尝试

```
$('input[type=radio]').on('change', function(e) {
   // preferred window location change appropriate as mentioned above
}); 
```

对于基于 jquery 的解决方案：

```
$('input[type=\'radio\']').on('change', function(e) {
   $(location).attr('href', this.value);
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-23T17:15:08.990

我会将 url 设置为单选按钮的值。

```
<form>
<input type="radio" name="websiteRadio" value="http://www.google.com"><span>Google</span><br>
<input type="radio" name="websiteRadio" value="http://www.yahoo.com"><span>Yahoo</span><br>
<input type="radio" name="websiteRadio" value="http://www.bing.com"><span>Bing</span>
</form>

$(document).ready(function()
 $("input[name='websiteRadio']").click(function() {        
    window.location = $(this).attr('value');
 });
}); 
```

# c++ - Vertex Shader 和 Fragment 编译失败，与 main 冲突

> ID：15043121
> 
> 赞同：1
> 
> 时间：2013-02-23T17:03:24.593
> 
> 标签：c++, opengl, fragment-shader, vertex-shader

背景故事：昨天，我和那个向我展示 OPENGL ES 以在 Android 上开发游戏的人闲逛[不管那个 google plus 视频聊天叫什么]。我受到启发向他学习 OPENGL，并从昨天开始。

谷歌一些关于 Opengl 的教程，得到这个链接[https://gamedev.stackexchange.com/questions/32876/good-resources-for-learning-modern-opengl-3-0-or-later](https://gamedev.stackexchange.com/questions/32876/good-resources-for-learning-modern-opengl-3-0-or-later)并按照 wiki 直到这个课程：[http](http://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Tutorial_02) ://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Tutorial_02他们从文件中加载着色器和顶点。这就是我遇到问题的地方。

编译器在顶点和片段着色器文件中不断告诉我“main 必须返回 int”（可能是新的 std 状态） - 一个主要冲突，你如何解决这个问题？

注意：我正在使用 Qt

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T20:36:54.023

这听起来像是您将着色器源文件添加到要由 C++ 编译器编译的列表中。*你不应该这样做！*

OpenGL 着色器在运行时由 OpenGL 实现中包含的 GLSL 编译器编译。你有你的着色器的文件，它们只是普通的文本文件。您阅读它们，将它们传递给 OpenGL。您在构建程序时不处理它们。

# eigen - 特征中的旋转矩阵

> ID：15043130
> 
> 赞同：8
> 
> 时间：2013-02-23T17:04:02.417
> 
> 标签：eigen

我可以使用 Eigen 库来获取将向量 A 旋转到向量 B 的旋转矩阵吗？我一直在寻找一段时间，但找不到相关的api。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T18:16:35.970

您首先必须构造一个[四元数](http://eigen.tuxfamily.org/dox-devel/classEigen_1_1QuaternionBase.html#ac35460294d855096e9b687cadf821452)，然后将其转换为矩阵，例如：

```
#include <Eigen/Geometry>
using namespace Eigen;

int main() {
  Vector3f A, B;
  Matrix3f R;
  R = Quaternionf().setFromTwoVectors(A,B);
} 
```

# macos - 如何在 Safari 中轻松启用和禁用 Java

> ID：15043133
> 
> 赞同：0
> 
> 时间：2013-02-23T17:04:08.207
> 
> 标签：macos, safari, applescript, automator

我的妻子需要启用 Java 才能将她的考勤卡输入 ADP (grrrr)，但永远不记得如何使用“首选项”窗格进行操作。有没有我可以用来执行此操作的脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:04:08.207

我发现了两个脚本，合并后让我为她创建两个 Automator 服务：[核心 applescript](https://superuser.com/questions/540863/how-do-i-toggle-java-on-off-in-safari-browser)，然后如何检测[复选框是否已打开或关闭](https://stackoverflow.com/q/9690129/1633251)

```
on run {input, parameters} -- use for both Automator services except for false/true below
    tell application "System Events"
        tell process "Safari"
            click menu item "Preferences…" of menu "Safari" of menu bar item "Safari" of menu bar 1
            click button "Security" of tool bar 1 of window 1

            set theCheckbox to checkbox "Enable Java" of group 1 of group 1 of window "Security"
            tell theCheckbox
                set checkboxStatus to value of theCheckbox as boolean
                if checkboxStatus is false then click theCheckbox
                -- false for the 'Enable' script, true for the 'Disable' one
            end tell
            click button 1 of window "Security"
        end tell
    end tell
    return input
end run 
```

# database - 从触发器 Oracle 禁用触发器

> ID：15043135
> 
> 赞同：3
> 
> 时间：2013-02-23T17:04:13.997
> 
> 标签：database, oracle, plsql, triggers

我偶然发现了一种情况，即我需要在进行更新之前从触发器中禁用触发器，然后再重新启用它。

基本上，我有两张桌子：

*   `TIME_SLOTS`具有开始时间、结束时间等字段来设置节目的时隙以及节目ID（外键）来指定哪个节目。

*   `PROGRAMMES`包含所有不同可用程序及其详细信息的列表。还包含一个持续时间。

我有一个现有的触发器，当更新或插入时`TIME_SLOTS`，触发器会查找持续时间`PROGRAMMES`并确保结束时间 = 开始时间 + 持续时间。

我还想添加一个新触发器，在`TIME_SLOTS`更改持续时间时更新结束时间`PROGRAMMES`。

我已经设置了这两个触发器，但是在更改我得到的持续时间时：

```
One error saving changes to table "SE217"."PROGRAMMES":
Row 1: ORA-04091: table SE217.PROGRAMMES is mutating, trigger/function may not see it
ORA-06512: at "SE217.SCHEDULES_VALID_TIMES", line 19
ORA-04088: error during execution of trigger 'SE217.SCHEDULES_VALID_TIMES'
ORA-06512: at "SE217.UPDATE_END_TIME", line 5
ORA-04088: error during execution of trigger 'SE217.UPDATE_END_TIME' 
```

这显然是因为当我更改持续时间时，第二个触发器会更新`TIME_SLOTS`. 触发器`TIME_SLOTS`触发并查找持续时间 - 持续时间正在发生变化，我收到上述错误。

在我看来，当我`TIME_SLOTS`用新计算的结束时间更新行时，我应该在更新之前禁用触发器并在更新之后重新启用 - 但由于这是触发器，我无法更改触发器......

有任何想法吗？

编辑：我有一个想法，我可以设置一个全局变量并在我不想运行的触发器中检查这个 var 等 - 但不确定如何最好地实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T22:34:18.823

您几乎可以肯定地使用以下`EXECUTE IMMEDIATE`语句从另一个触发器中禁用一个触发器：

```
EXECUTE IMMEDIATE 'ALTER TRIGGER trigger_name_here DISABLE'; 
```

但是，您绝对不应该将触发器用于应用程序逻辑。这是一项混乱的业务，不仅因为触发器不能保证按顺序触发，还因为您遇到的那种“问题”。

*将您描述的所有*功能移动到存储过程或包中，并且仅在必要时出于验证目的使用触发器会更容易，也更安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-10T10:45:55.980

当您必须自定义现有功能并且您只能完全控制数据库时，就会出现这类问题。因此，您无法通过过程替换插入/更新，您可以做出反应。在这种情况下，您在两个表上都有触发器，并在两个方向上的表之间传播值。

# forms - AngularJS 表单输入：如何基于 $scope 设置默认值但绑定到新的表单模型

> ID：15043144
> 
> 赞同：1
> 
> 时间：2013-02-23T17:05:01.930
> 
> 标签：forms, input, angularjs

使用 node、mongoDB 和 angularjs 构建一个 CMS。我有一个编辑表单，其中包含要绑定到 $scope 的输入，以便它们的值填充现有数据。前任：

```
<form ng-submit="editArticle(article._id, article)" class="edit-form">
    <label for="hed">Hed: <input type="text" name="hed" ng-model="article.hed" value="{{article.hed}}" /></label>
    <label for="dek">Dek: <input type="text" name="dek" ng-model="article.dek" placeholder="{{article.dek}}" /></label>
    <input type="submit" value="Save Changes"></input>
</form> 
```

这会用我的 mongo 数据库中的当前数据适当地填充输入值。但是，我想绑定到一个新的表单范围，因此它不会尝试传入文章范围中的每个值，而只是传递表单中的新范围。（文章范围目前包含 Mongo 中文章文档中的每个字段。如果我传入所有这些数据，我会收到关于无效模式的错误，因为它也在尝试传入 __v 字段。）

所以理想情况下我想这样做：

```
<form ng-submit="editArticle(article._id, form)" class="edit-form">
    <label for="hed">Hed: <input type="text" name="hed" ng-model="form.hed" value="{{article.hed}}" /></label>
    <label for="dek">Dek: <input type="text" name="dek" ng-model="form.dek" placeholder="{{article.dek}}" /></label>
    <input type="submit" value="Save Changes"></input>
</form> 
```

所以在提交时，它只将 form.hed 和 form.dek 传递给我的数据库。但是，现在这些输入字段为空白，因为它们未绑定到原始文章数据。用户必须用原始值重新填写每个字段。有没有办法绑定到多个模型或绑定到当前模型，但在提交时只发送更新的表单数据？

**编辑：**

看起来我必须向每个字段添加 ng-change 属性，以使用原始范围填充输入字段，然后在更改时将表单范围设置为等于更改的值。例如。

```
<form ng-submit="editArticle(article._id, form)" class="edit-form">
    <label for="hed">Hed: <input type="text" name="hed" ng-change(form.article = article.hed) ng-model="article.hed" /></label>
    <label for="dek">Dek: <input type="text" name="dek" ng-change(form.dek = article.dek) ng-model="article.dek" placeholder="{{article.dek}}" /></label>
    <input type="submit" value="Save Changes"></input>
</form> 
```

不确定我对这个解决方案有多兴奋，但它确实有效。如果有人知道更有效的方法来实现这一点，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:27:33.647

在从 DB 接收原始对象（或其中的一部分）时复制原始对象（或其中的一部分）并将您的 from 绑定到它。

在编辑之前处理对象是一种非常好的模式，因为它允许您轻松提供额外的功能，例如恢复编辑并在未进行编辑时禁用保存按钮。

# python - Mac System Python 的调试信息 - 如何获取行号

> ID：15043146
> 
> 赞同：0
> 
> 时间：2013-02-23T17:05:24.213
> 
> 标签：python, macos, dwarf

当我有一个包含一些 MacOSX 库的崩溃报告（在这种情况下，我对 Python 最感兴趣）时，我怎样才能获得有关它的更多信息？该库不包含调试信息，因此崩溃报告缺少行号和其他有用的东西。我可以在其他地方获取调试信息并重建行号吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T02:59:56.930

您可能想查看 lldb 调试器。它可以在 python 中编写脚本，并且很容易执行诸如符号化崩溃报告之类的操作。甚至还有一个包含的示例 python 脚本可以表示标准的 Mac OS X 崩溃报告（假设您有某些框架的 dSYM）并提供文件名和行号信息。

有关使用它的更多信息，请参阅[http://lldb.llvm.org/symbolication.html](http://lldb.llvm.org/symbolication.html)，或者使用 lldb 编写自己的 python 脚本很容易。您可以创建一个从 lldb 会话调用的 python 方法（就像这样`lldb.macosx.crashlog`做），或者您可以编写一个独立的 python 脚本来加载 lldb 并执行您想要的任何操作。lldb 的结构类似于库（Mac OS X 上的框架），`lldb`命令行命令是 LLDB.framework 的一个可能客户端。

# asp.net - 将数据传递给局部视图

> ID：15043150
> 
> 赞同：0
> 
> 时间：2013-02-23T17:06:11.720
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, partial-views

我已经创建了一个具有两个部分视图登录和注册的视图页面。对于这两者，我为两者创建了视图模型和组合模型，如下所示。

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Web;

namespace ProjectHub.ViewModels
{
    public class LoginModel
    {
         public string Username { get; set; }
         public string Password { get; set; }
    }
    public class RegisterModel
    {
         public string FullName { get; set; }
         public string Email { get; set; }
         //Some properties as well
    }
    public class LoginOrRegisterModel
    {
         public LoginModel Loginmodel { get; set; }
         public RegisterModel Registermodel { get; set; }
    }
} 
```

Index.cshtml @model ProjectHub.ViewModels.LoginOrRegisterModel

```
 @Html.Partial("_Register", Model.Registermodel) 
 @Html.Partial("_Login",Model.Loginmodel) 
```

_Login.cshtml

```
 @model ProjectHub.ViewModels.LoginModel

  @using (Html.BeginForm("Login", "account", FormMethod.Post))
  {
    @Html.ValidationSummary(true)
    <div class="label">@Html.Label("Username")</div>
    <div class="field">@Html.TextBoxFor(m => m.Username)</div>

    <div class="label">@Html.Label("Password")</div>
    <div class="field">@Html.PasswordFor(m => m.Password)</div>

    <input class="field" id="submit" type="submit" value="Login" />
} 
```

_Register.cshtml

```
 @model ProjectHub.ViewModels.RegisterModel

 @using (Html.BeginForm("Register", "account", FormMethod.Post))
 {
    <div class="label">@Html.Label("Name")</div>
    <div class="field">@Html.TextBoxFor(m => m.FullName)</div>

    //Some other labels and fields

    <input class="field" id="submit" type="submit" value="Sign Up" />
    @Html.ValidationSummary()   
}

 public ActionResult Index()
    {
        return View();
    } 
```

现在，当我尝试运行应用程序时，出现错误“对象引用未设置为对象的实例”。在 @Html.Partial("_Register", Model.Registermodel) 和 @Html.Partial("_Login",Model.Loginmodel) 处的 Index.cshtml 中。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:08:09.767

看起来该`Model`属性在呈现这些部分的主视图中为空。确保在呈现此主视图的控制器操作中，您已正确初始化并将其传递`LoginOrRegisterModel`给视图：

```
public ActionResult SomeAction()
{
    LoginOrRegisterModel model = new LoginOrRegisterModel();
    model.Loginmodel = new LoginModel();
    model.Registermodel = new RegisterModel();
    return View(model);
} 
```

# c++ - 将 Opencv 矩阵旋转 90、180、270 度

> ID：15043152
> 
> 赞同：40
> 
> 时间：2013-02-23T17:06:19.700
> 
> 标签：c++, opencv, matrix, image-rotation

我正在从网络摄像头捕捉图像，我需要将其旋转直角。我发现自己有这些功能：

1.  `getRotationMatrix2D`- 创建旋转矩阵（不管它是什么）
2.  `transform`- 通过旋转矩阵将一个矩阵转换为另一个矩阵

但是，除了黑色区域，我什么都没有。这是我的代码：

```
 if(rotate_button.click%4>0) {
       double angle = (rotate_button.click%4)*90;  //button increments its click by 1 per click
       Mat transform_m = getRotationMatrix2D(Point(cam_frame_width/2, cam_frame_height/2), angle, 1);  //Creating rotation matrix
       Mat current_frame;
       transform(cam_frame, current_frame, transform_m);  //Transforming captured image into a new one
       cam_frame = Mat((int)current_frame.cols,(int)current_frame.rows, cam_frame_type) = Scalar(0,128,0);  //resizing captured matrix, so I can copy the resized one on it
       current_frame.copyTo(cam_frame);  //Copy resized to original
   } 
```

输出只是黑屏。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2014-06-02T08:37:06.680

上面的答案太复杂了，占用了你的 CPU。您的问题不是任意旋转，而是“将 Opencv 矩阵旋转 90、180、270 度”。

**2017 年 6 月 30 日更新：**

OpenCV 支持此功能，但未记录：[https ://github.com/opencv/opencv/blob/master/modules/core/include/opencv2/core.hpp#L1041](https://github.com/opencv/opencv/blob/master/modules/core/include/opencv2/core.hpp#L1041)

```
void rotate(InputArray src, OutputArray dst, int rotateCode); 
```

和

```
enum RotateFlags {
    ROTATE_90_CLOCKWISE = 0, //Rotate 90 degrees clockwise
    ROTATE_180 = 1, //Rotate 180 degrees clockwise
    ROTATE_90_COUNTERCLOCKWISE = 2, //Rotate 270 degrees clockwise
}; 
```

**原始答案和任意度数旋转：**

您也可以通过使用翻转和转置操作来做到这一点，即对于 90CW：

```
transpose(matSRC, matROT);  
flip(matROT, matROT,1); //transpose+flip(1)=CW 
```

等等。通过使用文档中的转置和翻转操作介绍自己，自己找出其他命令（思考=学习）。

```
void rot90(cv::Mat &matImage, int rotflag){
  //1=CW, 2=CCW, 3=180
  if (rotflag == 1){
    transpose(matImage, matImage);  
    flip(matImage, matImage,1); //transpose+flip(1)=CW
  } else if (rotflag == 2) {
    transpose(matImage, matImage);  
    flip(matImage, matImage,0); //transpose+flip(0)=CCW     
  } else if (rotflag ==3){
    flip(matImage, matImage,-1);    //flip(-1)=180          
  } else if (rotflag != 0){ //if not 0,1,2,3:
    cout  << "Unknown rotation flag(" << rotflag << ")" << endl;
  }
} 
```

所以你这样称呼它，并注意矩阵是通过引用传递的。

```
cv::Mat matImage;
//Load in sensible data
rot90(matImage,3); //Rotate it

//Note if you want to keep an original unrotated version of 
// your matrix as well, just do this
cv::Mat matImage;
//Load in sensible data
cv::Mat matRotated = matImage.clone();
rot90(matImage,3); //Rotate it 
```

**旋转任意度数** 当我在这里时，这里是如何旋转任意度数，我预计它会贵 50 倍。请注意，以这种方式旋转将包括黑色填充，并且边缘将被旋转到超出图像的原始大小。

```
void rotate(cv::Mat& src, double angle, cv::Mat& dst){
    cv::Point2f ptCp(src.cols*0.5, src.rows*0.5);
    cv::Mat M = cv::getRotationMatrix2D(ptCp, angle, 1.0);
    cv::warpAffine(src, dst, M, src.size(), cv::INTER_CUBIC); //Nearest is too rough, 
} 
```

将其称为旋转 10.5 度显然是：

```
cv::Mat matImage, matRotated;
//Load in data
rotate(matImage, 10.5, matRotated); 
```

我发现这些极其基本的功能不是 OpenCV 的一部分，而 OpenCV 确实具有像人脸检测这样的原生功能（这并没有真正保持有问题的性能）。卓越。

干杯

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-23T17:18:25.253

使用 warpAffine。：

尝试：

```
Point2f src_center(source.cols/2.0F, source.rows/2.0F);
Mat rot_mat = getRotationMatrix2D(src_center, angle, 1.0);
Mat dst;
warpAffine(source, dst, rot_mat, source.size()); 
```

`dst`是最终图像

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-05-15T14:25:27.050

@Abhishek Thakur 的回答仅适用于将图像旋转 180 度。它不能处理 90 度的旋转，因为

*   提供给的旋转中心`getRotationMatrix2D`不正确，并且
*   传递给的输出矩阵大小`warpAffline`不正确。

这是将图像旋转 90 度的代码：

```
Mat src = imread("image.jpg");
Mat dst;

double angle = 90;  // or 270
Size src_sz = src.size();
Size dst_sz(src_sz.height, src_sz.width); 

int len = std::max(src.cols, src.rows); 
Point2f center(len/2., len/2.);
Mat rot_mat = cv::getRotationMatrix2D(center, angle, 1.0);
warpAffine(src, dst, rot_mat, dst_sz); 
```

**编辑：** [另一种](https://stackoverflow.com/a/16278334/1121420)将图像旋转 90,180 或 270 度的方法是先做矩阵`transpose`，然后`flip`. 这种方法可能更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-10T12:28:39.960

上面的代码工作得很好，但是由于矩阵计算是在浮点和 warpAffine 插值中完成的，所以在图像中引入了数值误差。

对于 90 度增量旋转，我更喜欢使用以下（在 python/opencv python 中）

由于 Python 中的 OpenCV 图像是 2d Numpy 数组。

90度
theImage = numpy.rot90( theImage, 1 )
270 度。
theImage = numpy.rot90( theImage, 3 )

注意：我只在形状 ( X, Y ) 的灰度图像上对此进行了测试。如果您有彩色（或其他多分离）图像，您可能需要先对其进行整形，以确保旋转沿正确的轴进行。

# c# - C#修改字符串列表而不迭代

> ID：15043153
> 
> 赞同：1
> 
> 时间：2013-02-23T17:06:20.393
> 
> 标签：c#, string, foreach, ienumerable

我有一个从第 3 方返回给我的列表。列表中的每个字符串都以“mph”结尾，我想删除“mph”。显而易见的答案是遍历列表，但我不知道是否有更有效的方法来做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T17:07:47.053

总之，没有。*必须*通过列表才能修改它。循环可能是最有效的`for`方式，但不一定是最简洁的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T17:09:25.297

您必须遍历列表才能触摸每个项目并进行更改。

最简单的方法是通过 linq：

```
 var originallist = new List<string> { "50mph", "35mph", "100mph" };
  var newlist = list.Select(s => s.Substring(0, s.Length - 3)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-23T17:10:53.480

您可以使用 LINQ 代替`foreach`循环：

```
list.Select( s => s.Substring(0, s.Length - 3) ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T19:31:19.400

这会起作用

```
List<string> newList = new List<string>();

mylist.ForEach((item)=>
  {
    item=item.Replace("mph",""); 
    newlist.Add(item);
  }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-23T17:09:07.333

您可以为此目的使用 LINQ。像这样的东西可能有效：

```
var noMph = theList.Select(p => p.Replace("mph", "").ToList(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-23T17:09:27.670

## 简单的答案：你不能

* * *

您必须以一种或另一种方式执行迭代。

它可能是：

```
foreach
for
List.ForEach 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-23T17:10:19.013

好吧，你可以写

```
mylist.Select(s=>s.Substring(0, s.Length-3));//Can add .ToList() here 
```

但这是使用循环。您至少不必编写 foreach :)

# wcf - 聊天应用建议.Net

> ID：15043154
> 
> 赞同：-2
> 
> 时间：2013-02-23T17:06:24.147
> 
> 标签：wcf, sockets, xmpp, duplex

我要开发一个聊天应用程序，我很困惑我选择哪种方式。以下是选项，请建议我哪种/为什么是创建聊天应用程序的最佳方式。

1.  WCF 双工聊天
2.  插座
3.  XMPP

谢谢阿努杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:18:03.060

如果您要使用客户端服务器样式的聊天，那么我总是发现使用套接字是一种简单的方法。如果您创建服务器并添加您希望它监听的套接字。

创建一个客户端，然后连接到服务器，为此您将输入服务器的 ip 和套接字。然后客户端连接到服务器，服务器会将客户端添加到客户端列表中。当客户端向服务器发送消息时，服务器将使用循环将消息发送给列表中的所有客户端。

您将需要使此多线程，因为客户端将始终需要侦听从服务器发送的新消息，同时仍允许用户向服务器发送新消息。它一点也不复杂，快速谷歌一下，你会找到你可能需要的所有代码

# xaml - 将视图模型从页面传递到 Windows 商店应用程序中的用户控件

> ID：15043157
> 
> 赞同：1
> 
> 时间：2013-02-23T17:06:41.423
> 
> 标签：xaml, windows-store-apps

在 Windows 应用商店拆分应用程序中，我想将视图模型从页面传递到用户控件。场景是我想在多个页面中重用一些常见的 xaml，使用像视图这样的 UserControl。

在主页中：

```
<common:LayoutAwarePage
    ...
    DataContext="{Binding ViewModel, RelativeSource={RelativeSource Self}}"
    ... >
  <views:MyUserControlView Model="{Binding ViewModel}" />
... 
```

在用户控制代码中：

```
public sealed partial class MyUserControlView : UserControl
{
    public static readonly DependencyProperty ModelProperty =
        DependencyProperty.Register("Model", typeof(MenuSource),
        typeof(MyUserControlView), null);
    ...
    public ModelType Model
    {
        get
        {
            return this.GetValue(ModelProperty) as ModelType ;
        }

        set
        {
            this.SetValue(ModelProperty, value);
        }
    } 
```

模型设置器永远不会被调用。如何将用户控件连接到父页面的视图模型？

或者，是否有更好的方法来实现在页面中使用的共享视图？

谢谢。

-约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T15:42:26.300

正确的绑定是：

```
<views:MyUserControlView Model="{Binding}" /> 
```

您已经`DataContext`为上面的页面进行了设置。所有绑定都相对于当前的`DataContext`.

不过，setter 仍然不会被调用。它只是访问`DependencyProperty`from 代码的包装器。绑定会`SetValue`直接调用。

根据您的要求，您甚至可能不需要定义自己的`Model` `DependencyProperty`. `DataContext`每个控件都自动从其父控件继承。在上面的示例中，用户控件已经将其`DataContext`设置为与页面相同的视图模型。

# c - long 数据类型将在内存中存储多长时间？

> ID：15043158
> 
> 赞同：0
> 
> 时间：2013-02-23T17:06:49.317
> 
> 标签：c, performance, bit-manipulation, bit-shift

**我的需求：**

对于任何非负 unsigned long a，

> 输入 a = 5; 答案应该是 3
> 
> 输入 a = 12; 答案应该是 4
> 
> 输入 a = 1; 答案应该是 1
> 
> 输入 a=0 Ans 应该是 0
> 
> 即从左边找到最重要的1个位置。

**我试过的：**

```
int count = 0;

if( a!=0 )
 do{
   count++;
 }while( a >>= 1 ); 
```

**问题** 由于 while 循环和移位而需要更多时间。

**建议的方法** 如果我知道这 4 个字节是如何存储在内存中的，（使用 char*）我将取出包含最重要的 1 的字节，因此在最坏的情况下，最多 8 次移位就足以找到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:13:14.163

不要那样做。如果最高有效字节不包含您要查找的位（即，如果您的数字小于`2 ^ (3 * CHAR_BIT)`），您的方法将不起作用。你为什么不从另一端开始？

```
unsigned find_msb(unsigned long long n)
{
    int bits_max = sizeof(n) * CHAR_BIT - 1;
    int i;
    for (i = bits_max; i >= 0; i--) {
        if ((n >> i) & 1) return i + 1;
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T19:50:43.087

我认为您担心效率的方式。最坏的情况是 O(n)，坦率地说，它永远不会变得更好。即使在慢速处理器上的嵌入式系统中，也没有真正需要尝试加速 H2CO3 的算法。

让它工作，然后担心效率。

# c# - 错误的连接字符串NHibernate 3.3

> ID：15043161
> 
> 赞同：8
> 
> 时间：2013-02-23T17:07:09.560
> 
> 标签：c#, asp.net, asp.net-mvc, nhibernate, sql-server-2012

如何使用 SQL Server 2012 为 Nhibernate 编写正确的连接字符串？

我还应该写数据库名称吗？

错误：我收到错误的“初始目录”错误</p>

NHibernate 的连接字符串错误（我从我的服务器复制此连接字符串）：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory>
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MsSqlCeDialect</property>
    <property name="connection.driver_class">NHibernate.Driver.SqlServerCeDriver</property>
    <property name="connection.connection_string">Data Source=RAFAL-KOMPUTER\MSSQLSERVER4;Initial Catalog=rafal;Integrated Security=True</property>
    <property name="show_sql">true</property>
  </session-factory>
</hibernate-configuration> 
```

我从这部分复制连接字符串： ![在此处输入图像描述](../Images/0a17efb91932fa6552963e5edc81ba63.png)

我也在尝试这个，但没有帮助。

```
<property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MsSql2008Dialect</property>
    <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
    <property name="connection.connection_string">Data Source=RAFAL-KOMPUTER\MSSQLSERVER4;Initial Catalog=rafal;Integrated Security=True</property> 
```

我不知道**SQL Server 2012的正确配置**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-24T05:48:49.693

第一个片段不应该工作，而驱动程序适用于 CE（精简版）。

第二个看起来更好，甚至更适合我。（在此处查看更多信息[http://www.connectionstrings.com/sql-server-2012](http://www.connectionstrings.com/sql-server-2012)）。最重要的是，正确设置 Provider 名称（在此处查看：[https](https://stackoverflow.com/a/8150792/315850) ://stackoverflow.com/a/8150792/315850 ）。试试这个调整后的片段（只是为了确保所有部分都设置正确）

```
<property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
<!-- to profit from features in 2012, use its dialect -->
<property name="dialect">NHibernate.Dialect.MsSql2012Dialect</property>
<property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
<!-- the simplest connection string -->
<property name="connection.connection_string">Data Source=RAFAL-KOMPUTER\MSSQLSERVER4;Database=rafal;Trusted_Connection=True;</property> 
```

我们必须确保使用了正确的驱动程序（不是 CE 或任何其他`NHibernate.Driver.SqlClientDriver`的，这意味着`System.Data.SqlClient`）

仔细检查您的 1) SQL 服务器和命名实例是：`RAFAL-KOMPUTER\MSSQLSERVER4`和 2) 数据库名称是：`rafal`和 3) 您的登录名对其具有访问权限，这必须有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-24T14:10:11.973

只需替换：`SqlServerCeDriver`如下`SqlClientDriver`：

代替 ：`<property name="connection.driver_class">NHibernate.Driver.SqlServerCeDriver</property>`

经过：`<property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>`

# c++ - C++ 中的文件打开模式

> ID：15043166
> 
> 赞同：0
> 
> 时间：2013-02-23T17:07:58.163
> 
> 标签：c++, file, encoding

我可以使用 C++ 中的 open() 函数以二进制模式打开 .xls 或 .PDF 文件并读取其内容吗？如果没有，我如何构建一个可以读取具有此类文件格式（甚至更多）的文件内容的应用程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:16:55.500

是的，您可以将文件系统中的任何文件作为二进制文件打开，并且您也可以读取它（只要您的操作系统允许根据文件访问权限打开文件，并且没有其他应用程序对其进行锁定） ， ETC）。

接下来您可能会问“我如何解释 PDF 或 XLS 文件？” 正如他们在英国所说的那样，这完全是另外一锅鱼。PDF 和 XLS 文件都不能直接“理解”。我最近查看的一个 PDF 库包含几十个文件，并且是几兆字节的源代码。我在 Python 中处理过 XLS 文件，其中的代码有几千行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:13:24.903

简单的阅读将是：

```
#include <iostream>
#include <fstream>
#include <algorithm>
#include <iterator>

std::vector<char> readfile(std::string const& fname)
{
    std::ifstream ifs(fname.c_str(), std::ios::binary);
    std::istreambuf_iterator<char> f(ifs.rdbuf()), l;

    std::vector<char> bytes;
    std::copy(f, l, std::back_inserter(bytes));
    return bytes;
}

int main() 
{
    auto bytes = readfile("my.pdf");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-20T07:22:10.123

参数模式指向以下列序列之一开头的字符串（附加字符可能跟随在这些序列之后。）：

``r'' 打开文本文件进行阅读。流位于文件的开头。

``r+'' 为读写打开。流位于文件的开头。

``w'' 将文件截断为零长度或创建用于写入的文本文件。流位于文件的开头。

``w+'' 为读写而打开。如果文件不存在，则创建该文件，否则将其截断。流位于文件的开头。

``a'' 开放写。如果文件不存在，则创建该文件。流位于文件的末尾。对文件的后续写入将始终在文件的当前末尾结束，而与任何干预 fseek(3) 或类似内容无关。

``a+'' 为读写打开。如果文件不存在，则创建该文件。流位于文件的末尾。对文件的后续写入将始终在文件的当前末尾结束，而与任何干预 fseek(3) 或类似内容无关。

# c++ - C/C++，指针和函数的麻烦

> ID：15043170
> 
> 赞同：1
> 
> 时间：2013-02-23T17:08:12.910
> 
> 标签：c++, function, pointers, function-pointers

我有一个关于了解指针和函数如何工作的小问题。我想看看一个函数的样子`qsort()`，但我需要使用我自己的函数来交换元素和比较元素。我很惊讶地知道我的函数不交换数据......

我的代码：

```
//prototypes file: other.h

void Sort(char* pcFirst, int nNumber, int size, void (*Swap)(void*, void*), int (*Compare)(void*, void*) ); //sorts any arrays
void SwapInt(void* p1, void* p2); // swap pointers
int CmpInt(void* p1, void* p2); // compare poineters 

//realisation file: other.cpp

#include "other.h"
void Sort(char* pcFirst, int nNumber, int size,
     void (*Swap)(void*, void*), int (*Compare)(void*, void*) )
{
    int i;
    for( i = 1; i < nNumber; i++)
        for(int j = nNumber - 1; j >= i; j--)
        {
            char* pCurrent = pcFirst + j * size;
            char* pPrevious = pcFirst + (j - 1) * size;
            if( (*Compare)( pPrevious, pCurrent ) > 0 )// if > 0 then Swap
            {
                (*Swap)( pPrevious, pCurrent );
            }
        }
}

void SwapInt(void* p1, void* p2) 
{
    int * ptmp1 = static_cast<int*>(p1);
    int * ptmp2 = static_cast<int*>(p2);
    int * ptmp = ptmp1;
    ptmp1 = ptmp2;
    ptmp2 = ptmp;
}

int CmpInt(void* p1, void* p2)
{
    int nResult;
    int * ptmp1 = static_cast<int*>(p1);
    int * ptmp2 = static_cast<int*>(p2);
    nResult = (*ptmp1 - *ptmp2);
    return nResult;
}

//main file: lab.cpp
#include <tchar.h>
#include <iostream>
#include <cstdio>
#include <cmath>
#include "other.h"

int _tmain()
{
int nAr[] = {33,44,55,22,11};   //array for sort
    int nTotal = sizeof(nAr) / sizeof(int); //number of elements
for ( int i = 0; i < nTotal; i++)
    {
        printf("%d ",nAr[i]); // result of cycle is 33 44 55 22 11
    }
    Sort(reinterpret_cast<char*>(&nAr[0]), nTotal, sizeof(int), SwapInt, CmpInt);
for ( int i = 0; i < nTotal; i++)
    {
        printf("%d ",nAr[i]); // result of cycle is 33 44 55 22 11 too =(
    }
} 
```

为什么数组没有变化？

在调试器中，我可以看到所有指针都发生了变化，并获得了正确的值，但在`main`我的数组中没有改变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:12:12.930

指向对象的指针

编码

```
int * ptmp = ptmp1;
ptmp1 = ptmp2;
ptmp2 = ptmp; 
```

在函数中本地更改一些指针值，仅此而已。

为了交换两个对象的值，通过引用传递它们：

```
void swap_values_of( int& a, int& b )
{
    int const original_a = a;
    a = b;
    b = original_a;
} 
```

你也可以用指针参数来做，不太安全，然后注意交换指向的值而不是指针本身。

但除学习目的外，请`std::swap`改用

* * *

没有要求，但是...如果您更改当前的 Microsoft 特定

```
int _tmain() 
```

只是标准

```
int main() 
```

那么代码将（更有可能）在例如Linux中也可以工作。

只是一个小费

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:11:58.873

您的`SwapInt`函数交换了一些指针，而不是`int`s。由于所有这些指针都是本地的`SwapInt`，因此没有实际效果。可能您打算对`int`s`*ptmp1`和`*ptmp2`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:18:31.403

你实际上在做的是交换指针。您要做的是交换指针指向的值。至少这来自您的程序逻辑。所以你的代码可能是这样的：

```
void SwapInt(void* p1, void* p2) 
{
    int * ptmp1 = static_cast<int*>(p1);
    int * ptmp2 = static_cast<int*>(p2);
    int ptmp = *ptmp1;
    *ptmp1 = *ptmp2;
    *ptmp2 = ptmp;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:19:30.370

你可以看看这些各种组合......

```
#include<iostream>
#include<stdio.h>
#include<malloc.h>
//Call by Address
    void SwapIntAddr(int* ptmp1, int* ptmp2) 
    {
        int ptmp;
        ptmp  = *ptmp1;
        *ptmp1 = *ptmp2;
        *ptmp2 = ptmp;
    }

//Call by Reference

    void SwapIntRef(int& ptmp1, int& ptmp2) 
    {
         int ptmp;
         ptmp  = ptmp1;
         ptmp1 = ptmp2;
         ptmp2 = ptmp;
    }
//Call by Reference but in pointer level
    void SwapPtrRef(int*& ptmp1, int*& ptmp2) 
    {
         int* ptmp;
         ptmp  = ptmp1;
         ptmp1 = ptmp2;
         ptmp2 = ptmp;
    }

//Call by Address but in Pointer level.

    void SwapPtrAddr(int** ptmp1,int** ptmp2) 
    {
        int** ptmp = (int**) malloc(sizeof(int*));
        *ptmp  = *ptmp1;
        *ptmp1 = *ptmp2;
        *ptmp2 = *ptmp;
    }

int main(){
  int a = 3, b= 5;
  int* p1 = &a;
  int* p2 = &b;

  SwapIntAddr(p1,p2);
  printf("%d %d\n",*p1,*p2);

  SwapIntRef(*p1,*p2);
  printf("%d %d\n",*p1,*p2);

  SwapPtrRef(p1,p2);
  printf("%d %d\n",*p1,*p2);

  SwapPtrAddr(&p1,&p2);
  printf("%d %d\n",*p1,*p2);

  return 0;
} 
```

# r - 大量地块的排列并与r中的线连接

> ID：15043172
> 
> 赞同：18
> 
> 时间：2013-02-23T17:08:21.997
> 
> 标签：r, plot, r-grid

我有大量的小地块需要放置在一个更大的地块画布中，并将小地块排列成线条并将它们连接起来。一个小例子如下所示：

A 到 L 是独立的图。给出了它们的位置坐标。

![在此处输入图像描述](../Images/c83258caf497da9813e8e8c5b6cf7822.png)

绘图网格坐标：PlotgridX 和 plotgridY 可以决定小图何时需要居中

```
 plotcord <- data.frame (
plotname = c("A", "B", "C", "D",    "E",    "F",   "G", "H", "I", "J", "K", "L"),
plotgridX = c( 1.5, 2,   5,   5.5,   1.75,  5.25,  8   , 1 ,  2,   3.5,  6,  7.5),
 plotgridY = c( 3,  3,    3,    3,     2 ,    2,    2,   2  , 1,   1,   1,   1))

   plotname plotgridX plotgridY
1         A      1.50         3
2         B      2.00         3
3         C      5.00         3
4         D      5.50         3
5         E      1.75         2
6         F      5.25         2
7         G      8.00         2
8         H      1.00         2
9         I      2.00         1
10        J      3.50         1
11        K      6.00         1
12        L      7.50         1 
```

连接线由以下数据框决定：

```
connectd <- data.frame (id = c(  "E",    "F", "I", "J", "K", "L"),
                        parent1 = c("A",  "C", "H", "E" ,"E", "F"),
                      parent2 = c("B",  "D",  "E", "F", "F", "G"))
connectd
  id parent1 parent2
1  E       A       B
2  F       C       D
3  I       H       E
4  J       E       F
5  K       E       F
6  L       F       G 
```

例如，这里应将图形E连接到其父1“A”和父2“B”图形，同时将“A”、“B”连接成“T形”连接。其他 id 也是如此。

虽然我在每个子图中都有其他细节要绘制，但作为概念证明，我想绘制一个矩形，每个地块名称为 n1 和 n2，以制作如下图： ![在此处输入图像描述](../Images/0ee1c8c0d7d25dc10580a39a52135a33.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-23T20:50:11.220

**赏金开始后**编辑：****

 ***   更改如何计算线的坐标：无需使用合并
*   更改如何绘制连接线：漂亮的连接线。

![在此处输入图像描述](../Images/9df12ba9ffff35b01f4fbef4dbed1de2.png)

首先，我需要将您的连接数据从点标签转换为协调点 (x,y)

```
## here the edit 
dat.lines <- do.call(cbind,apply(connectd,2,
                                 function(x){
                                   id <- match(x,plotcord$plotname)
                                   plotcord[id,c(2,3)]}))

colnames(dat.lines) <- paste(rep(c('x','y'),3),rep(1:3,each=2),sep='') 
```

这就是我的 dat.lines 的样子：

```
 x1 y1   x2 y2   x3 y3
1 1.750  2 1.50  3 2.00  3
2 5.250  2 5.00  3 5.50  3
3 1.375  1 1.00  2 1.75  2
4 3.500  1 1.75  2 5.25  2
5 6.000  1 1.75  2 5.25  2
6 7.500  1 5.25  2 8.00  2 
```

然后，我使用 lattice 绘制点`xyplot`。lattice 的使用真的很适合这样的情节。无需保存数据（例如网格包）。然后我自定义面板添加矩形，段，...

```
library(latticeExtra))
xyplot(plotgridY~plotgridX,data= plotcord,
       panel=function(x,y,...){
     apply(dat.lines,1,function(x){
       panel.segments(x0=x['x2'],y0=x['y2'],x1=x['x3'],y1=x['y3'])
       boxh <- 0.5
       x1=x['x1']
       y1=x['y1']
       y2 <- x['y2']
       x2 <- (x['x2']+x['x3'])/2
       ydelta <- (y2 - y1)/2
       browser()
       panel.segments(c(x1, x1, x2), c(y1, y1 + ydelta, y2 - 
                                   ydelta), c(x1, x2, x2), c(y1 + ydelta, y2 - 
                                                               ydelta, y2))
     })

         panel.rect(x=x,y=y,width=unit(2,'cm'),
                    height=unit(2,'cm'),col='lightyellow')
         panel.xyplot(x,y,...)
         panel.text(x,y,adj=c(0,-3),
                    label=plotcord$plotname,cex=1.5)

         ## add some prove of concept detail 
         panel.rect(x=x,y=y,width=unit(0.5,'cm'),
                    height=unit(0.5,'cm'),col='lightblue',lty=2)
         panel.text(x,y,adj=c(1,2),
                    label=paste(plotcord$plotname,1,sep=''),cex=1,col='blue')
         panel.text(x,y,adj=c(-0.5,2),
                    label=paste(plotcord$plotname,2,sep=''),
                    cex=1,col='blue')

         },ylim=extendrange(plotcord$plotgridY,f=0.5),xlab='',ylab='', axis = axis.grid,
   main='Arrangement of large number of plots \n and connect with lines ') 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-02T02:29:15.510

我正在写这个答案，部分是为了后代，部分是因为我一直想为其他一些试图在 R 中进行自定义可视化的人写一些这样的函数。

**背景**

在 R 中，许多人正确地抛弃了基础绘图函数，开始转向更灵活的包装程序包，“lattice”和“ggplot2”。这些是通过在单个图上应用逻辑层来快速探索数据的强大工具。然后，这些包会处理所有层并生成一个图窗口，并适当地安排。这些包很棒，我建议每个 R 用户至少学习其中一个。

不过需要注意的是，'lattice' 和 'ggplot2' 包实际上更多地用于数据探索，而不是智能数据可视化。在创建自定义数据可视化时，这些包为您做出了太多决定，因为这就是包装器的用途：让您无法做出一些决定。

**自定义可视化？输入“网格”**

基本的“网格”包是绘图灵活性的终极选择，部分原因是它扩展了基本绘图功能的功能，而不是包装它们。使用“网格”功能，我们获得了使用各种不同的放置和大小单位创建视觉对象的能力，并且（这非常重要）我们获得了为对象的锚点使用理由的能力。如果您想学习，Paul Murrell 的书“R 图形”是一个极好的资源。它的副本放在我的桌子上。

如果您曾经使用过矢量图形绘图程序（如 Illustrator 或 Inkscape），那么当我提到理由时，您可能已经知道我在说什么。这是通过引用其他项目的位置来排列项目的能力。我会更多地谈论这个，但我可以整天谈论它。让我们继续这个过程。

**过程**

现在，我应该先说我花了大约两个小时来编写函数库，大约 5 分钟来编写演示代码。以后我会使用函数库作为训练工具，任何人都可以随意使用/修改它。

“网格”过程分为三个基本步骤：

1.  制作视口
2.  绘制一些对象
3.  弹出你的视口

在制作视口时，我们使用“pushViewport”来推送“视口”对象，如下所示：

```
pushViewport(viewport(x=0, y=1, xscale=c(1, 10), yscale=c(0, 100), width=0.25, height=0.25, default.units="npc", just=c("left","bottom"), clip="off")) 
```

基本视口有一组“npc”单位，其中 x 从 0 到 1，从左到右，y 从 0 到 1，从下到上。这意味着原点位于左下角。上面的视口被创建为左下角绘图的四分之一。但是，当我们指定“xscale”和“yscale”时，我们可以在绘制对象时引用“native”单位。这意味着我们可以使用“本机”单位来绘制数据，并在绘制轴和标签等内容时使用“npc”单位。

绘制对象时，我们使用'grid.lines'、'grid.polygon'、'grid.points'、'grid.circle'等函数。我所做的每一个可视化都使用了这些对象。当您通过手动指定这些对象来绘制数据时，您可以获得大量的控制权。填充折线图是添加功能的最明显示例之一。填充区域只是一个多边形，其中包含由数据指定的多边形的点并添加了两个锚点。我用它来突出显示折线图的区域，或者更容易阅读同一图表上的多条线。

您还可以发挥创意，例如，创建不是矩形的条形，或者以更复杂的方式组合多个绘图。我和其他一些人最近运行了一个科幻主题的步行游戏，我们使用自定义图表（用“网格”制作）来展示我们的最终表现。该图表将“幸存者”团队的天数组合为时间轴，将玩家与敌人每天的步数显示为条形图，并将累积的玩家和敌人每天的步数显示为实心折线图。我很难使用“lattice”或“ggplot2”包来创建类似的视觉效果。

这是其中一个图表的示例（没有现实生活中的玩家姓名），以了解“网格”视觉效果的灵活性：

![示例复杂图表](../Images/3b3ce5b5f3a46600e4dea76eb2c391f2.png)

**问题的概念证明**

现在具体解决OP提出的问题。在问题中，OP 暗示他/她将在每个区域内绘制图表。使用预构建的绘图包时，这可能会变得很棘手，因为大多数绘图功能会覆盖您已经设置的任何绘图规范。相反，使用诸如基本“网格”函数之类的东西来指定绘图区域，然后在视口中绘制必要的数据对象更为可靠。

为了避免工作太辛苦，我首先编写了一个自定义函数库，用于设置我的各种图表参数并为我绘制每种类型的图表。我不喜欢调试代码，所以函数是我处理事情的方式。每次我得到一段正确的代码时，我都会把它扔到一个函数中供以后使用。

代码可能看起来有点复杂，但请记住三个“网格”步骤：push viewport、draw、pop viewport。这就是每个函数正在做的事情。为了演示这项工作，我制作了四种不同的绘图功能：填充折线图、散点图、直方图和 OP 建议的方框图。每个函数都足够灵活，可以在每个图表中容纳多组数据值，设置 alpha 值以进行补偿，并允许我们查看绘制在彼此之上的值。

在这种情况下，您只需要使您的函数尽可能灵活，因此我确实采用了一条捷径，并从演示中的一些代码中提取了它们，这些代码做了很多假设。不过，我仍然使用逻辑驱动的代码来绘制它，以演示如何使用简单的逻辑绘制更复杂的对象。

这是演示代码的结果，使用一些内置的 R 数据集来获取简单数据（EuStockMarkets、nottem、sunspots.month）：

![网格功能的图表演示](../Images/e287bca275a71107c0e1be02496935bf.png)

* * *

**自定义函数库**：

* * *

```
library(grid)

# Specify general chart options.
chart_Fill = "lemonchiffon"
chart_Col = "snow3"
space_Background = "white"
title_CEX = 0.8
axis_CEX = 0.6
chart_Width <- 3/3
chart_Height <- 2/5

# Function to initialize a plotting area.
init_Plot <- function(
    .df,
    .x_Loc, 
    .y_Loc, 
    .justify, 
    .width, 
    .height
    ){

    # Initialize plotting area to fit data.
    # We have to turn off clipping to make it
    # easy to plot the labels around the plot.
    pushViewport(viewport(xscale=c(min(.df[,1]), max(.df[,1])), yscale=c(min(0,min(.df[,-1])), max(.df[,-1])), x=.x_Loc, y=.y_Loc, width=.width, height=.height, just=.justify, clip="off", default.units="native"))

    # Color behind text.
    grid.rect(x=0, y=0, width=unit(axis_CEX, "lines"), height=1, default.units="npc", just=c("right", "bottom"), gp=gpar(fill=space_Background, col=space_Background))
    grid.rect(x=0, y=1, width=1, height=unit(title_CEX, "lines"), default.units="npc", just=c("left", "bottom"), gp=gpar(fill=space_Background, col=space_Background))

    # Color in the space.
    grid.rect(gp=gpar(fill=chart_Fill, col=chart_Col))
}

# Function to finalize and label a plotting area.
finalize_Plot <- function(
    .df, 
    .plot_Title
    ){

    # Label plot using the internal reference
    # system, instead of the parent window, so
    # we always have perfect placement.
    grid.text(.plot_Title, x=0.5, y=1.05, just=c("center","bottom"), rot=0, default.units="npc", gp=gpar(cex=title_CEX))
    grid.text(paste(names(.df)[-1], collapse=" & "), x=-0.05, y=0.5, just=c("center","bottom"), rot=90, default.units="npc", gp=gpar(cex=axis_CEX))
    grid.text(names(.df)[1], x=0.5, y=-0.05, just=c("center","top"), rot=0, default.units="npc", gp=gpar(cex=axis_CEX))

    # Finalize plotting area.
    popViewport()
}

# Function to plot a filled line chart of
# the data in a data frame.  The first column
# of the data frame is assumed to be the
# plotting index, with each column being a
# set of y-data to plot.  All data is assumed
# to be numeric.
plot_Line_Chart <- function(
    .df,
    .x_Loc,
    .y_Loc,
    .justify,
    .width,
    .height,
    .colors,
    .plot_Title
    ){

    # Initialize plot.
    init_Plot(.df, .x_Loc, .y_Loc, .justify, .width, .height)

    # Calculate what value to use as the
    # return for the polygons.
    y_Axis_Min <- min(0, min(.df[,-1]))

    # Plot each set of data as a polygon,
    # so we can fill it in with color to
    # make it easier to read.
    for (i in 2:ncol(.df)){
        grid.polygon(x=c(min(.df[,1]),.df[,1], max(.df[,1])), y=c(y_Axis_Min,.df[,i], y_Axis_Min), default.units="native", gp=gpar(fill=.colors[i-1], col=.colors[i-1], alpha=1/ncol(.df)))
    }

    # Draw plot axes.
    grid.lines(x=0, y=c(0,1), default.units="npc")
    grid.lines(x=c(0,1), y=0, default.units="npc")

    # Finalize plot.
    finalize_Plot(.df, .plot_Title)

}

# Function to plot a scatterplot of
# the data in a data frame.  The
# assumptions are the same as 'plot_Line_Chart'.
plot_Scatterplot <- function(
    .df,
    .x_Loc,
    .y_Loc,
    .justify,
    .width,
    .height,
    .colors,
    .plot_Title
    ){

    # Initialize plot.
    init_Plot(.df, .x_Loc, .y_Loc, .justify, .width, .height)

    # Plot each set of data as colored points.
    for (i in 2:ncol(.df)){
        grid.points(x=.df[,1], y=.df[,i], pch=19, size=unit(1, "native"), default.units="native", gp=gpar(col=.colors[i-1], alpha=1/ncol(.df)))
    }

    # Draw plot axes.
    grid.lines(x=0, y=c(0,1), default.units="npc")
    grid.lines(x=c(0,1), y=0, default.units="npc")

    # Finalize plot.
    finalize_Plot(.df, .plot_Title)

}

# Function to plot a histogram of
# all the columns in a data frame,
# except the first, which is assumed to
# be an index.
plot_Histogram <- function(
    .df,
    .x_Loc,
    .y_Loc,
    .justify,
    .width,
    .height,
    .colors,
    .plot_Title,
    ...
    ){

    # Create a list containing the histogram
    # data for each data column and calculate
    # data ranges.  Any extra parameters
    # specified will pass to the 'hist' function.
    hist_Data <- list()
    hist_Count_Range <- c(0,NA)
    hist_Breaks_Range <- c(NA,NA)
    for (i in 2:ncol(.df)){
        hist_Data[[i]] <- hist(.df[,i], plot=FALSE, ...)
        hist_Count_Range[2] <- max(max(hist_Data[[i]]$counts), hist_Count_Range[2], na.rm=TRUE)
        hist_Breaks_Range <- c(min(min(hist_Data[[i]]$breaks), hist_Breaks_Range[1], na.rm=TRUE), max(max(hist_Data[[i]]$breaks), hist_Breaks_Range[2], na.rm=TRUE))
    }

    # Initialize plotting area to fit data.
    # We are doing this in a custom way to
    # allow more flexibility than built into
    # the 'init_Plot' function.
    # We have to turn off clipping to make it
    # easy to plot the labels around the plot.
    pushViewport(viewport(xscale=hist_Breaks_Range, yscale=hist_Count_Range, x=.x_Loc, y=.y_Loc, width=.width, height=.height, just=.justify, clip="off", default.units="native"))

    # Color behind text.
    grid.rect(x=0, y=0, width=unit(axis_CEX, "lines"), height=1, default.units="npc", just=c("right", "bottom"), gp=gpar(fill=space_Background, col=space_Background))
    grid.rect(x=0, y=1, width=1, height=unit(title_CEX, "lines"), default.units="npc", just=c("left", "bottom"), gp=gpar(fill=space_Background, col=space_Background))

    # Color in the space.
    grid.rect(gp=gpar(fill=chart_Fill, col=chart_Col))

    # Draw x axis.
    grid.lines(x=c(0,1), y=0, default.units="npc")

    # Plot each set of data as a histogram.
    for (i in 2:ncol(.df)){
        grid.rect(x=hist_Data[[i]]$mids, y=0, width=diff(hist_Data[[i]]$mids[1:2]), height=hist_Data[[i]]$counts, default.units="native", just=c("center","bottom"), gp=gpar(fill=.colors[i-1], col=.colors[i-1], alpha=1/ncol(.df)))
    }

    # Label plot using the internal reference
    # system, instead of the parent window, so
    # we always have perfect placement.
    grid.text(.plot_Title, x=0.5, y=1.05, just=c("center","bottom"), rot=0, default.units="npc", gp=gpar(cex=title_CEX))
    grid.text(paste(names(.df)[-1], collapse=" & "), x=-0.05, y=0.5, just=c("center","bottom"), rot=90, default.units="npc", gp=gpar(cex=axis_CEX))

    # Finalize plotting area.
    popViewport()
}

draw_Sample_Box <- function(
    .x_Loc,
    .y_Loc,
    .x_Scale,
    .y_Scale,
    .justify,
    .width,
    .height,
    .colors,
    .box_X,
    .box_Y,
    .plot_Title
    ){

    pushViewport(viewport(xscale=.x_Scale, yscale=.y_Scale, x=.x_Loc, y=.y_Loc, width=chart_Width, height=chart_Height, just=.justify, clip="off", default.units="native"))

    # Color behind text.
    grid.rect(x=0, y=1, width=1, height=unit(title_CEX, "lines"), default.units="npc", just=c("left", "bottom"), gp=gpar(fill=space_Background, col=space_Background))

    # Color in the space.
    grid.rect(gp=gpar(fill=chart_Fill, col=chart_Col))

    # Label plot.
    grid.text(.plot_Title, x=0.5, y=1.05, just=c("center","bottom"), rot=0, default.units="npc", gp=gpar(cex=title_CEX))

    # Draw box and label points.
    grid.polygon(x=.box_X, y=.box_Y, default.units="native", gp=gpar(fill=.colors[1], col=.colors[2]))
    grid.text(paste(.plot_Title, 1, sep=""), x=min(.box_X), y=min(.box_Y), default.units="native", just=c("right","top"), gp=gpar(cex=0.5))
    grid.text(paste(.plot_Title, 2, sep=""), x=max(.box_X), y=min(.box_Y), default.units="native", just=c("left","top"), gp=gpar(cex=0.5))

    # Finalize plot.
    popViewport()
} 
```

* * *

**演示代码**：

* * *

```
# Draw twelve independent charts as
# a demo and connect with lines similar
# to a heiritage chart.
grid.newpage()

# Initialize a viewport to make our locations
# easier to map.
pushViewport(viewport(x=0, y=0, width=1, height=1, just=c("left","bottom"), xscale=c(0,10), yscale=c(0,4)))

# Color background of overall plot.
grid.rect(gp=gpar(fill=space_Background, col=space_Background))

# Store plot locations for convenience.
plot_Loc <- data.frame(x=c(2,4,6,8,1,3,7,9,2,4,6,8), y=c(3,3,3,3,2,2,2,2,1,1,1,1))

# Draw connecting lines.
connections <- data.frame(a=c(1, 3, 5, 6, 7, 1, 3, 5, 7, 6), b=c(2, 4, 6, 7, 8, 2, 4, 6, 8, 7), c=c(NA, NA, NA, NA, NA, 6, 7, 9, 12, 10), d=c(NA, NA, NA, NA, NA, NA, NA, NA, NA, 11))
for (i in 1:nrow(connections)){
    if (is.na(connections$c[i])){
        grid.lines(x=plot_Loc$x[unlist(connections[i,1:2])], y=plot_Loc$y[unlist(connections[i,1:2])], default.units="native")
    } else if (is.na(connections$d[i])) {
        grid.lines(x=median(plot_Loc$x[unlist(connections[i,1:2])]), y=plot_Loc$y[unlist(connections[i,2:3])], default.units="native")
    } else {
        grid.lines(x=median(plot_Loc$x[unlist(connections[i,1:2])]), y=c(plot_Loc$y[connections[i,2]], median(plot_Loc$y[unlist(connections[i,2:3])])), default.units="native")
        grid.lines(x=plot_Loc$x[unlist(connections[i,3:4])], y=median(plot_Loc$y[unlist(connections[i,2:3])]), default.units="native")
        grid.lines(x=plot_Loc$x[connections[i,3]], y=c(median(plot_Loc$y[unlist(connections[i,2:3])]), plot_Loc$y[connections[i,3]]), default.units="native")
        grid.lines(x=plot_Loc$x[connections[i,4]], y=c(median(plot_Loc$y[unlist(connections[i,2:3])]), plot_Loc$y[connections[i,4]]), default.units="native")
    }
}

# Draw four independent line charts.
p <- 1
plot_Line_Chart(data.frame(time=1:1860, EuStockMarkets)[1:3], .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("dodgerblue", "deeppink"), "EU Stocks")
p <- 2
plot_Line_Chart(data.frame(time=1:1860, EuStockMarkets)[c(1,4,5)], .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("green", "purple"), "EU Stocks")
p <- 3
plot_Line_Chart(data.frame(time=1:(12*20), sunspots=sunspot.month[(171*12+1):(171*12+12*20)]), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("darkgoldenrod"), "Sunspots")
p <- 4
plot_Line_Chart(data.frame(time=1:(12*20), temp=nottem), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("red"), "Nottem")

# Draw four independent scatterplots.
p <- 5
plot_Scatterplot(data.frame(time=1:(1860 + 1 - 1000), DAX=rowMeans(embed(EuStockMarkets[,1], 1000)), FTSE=rowMeans(embed(EuStockMarkets[,4], 1000))), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("deeppink", "purple"), "Smooth")
p <- 6
plot_Scatterplot(data.frame(time=1:1860, EuStockMarkets)[c(1,2,5)], .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("deeppink", "purple"), "EU Stocks")
p <- 9
plot_Scatterplot(data.frame(time=1:(1860 + 1 - 20), DAX=rowMeans(embed(EuStockMarkets[,1], 20)), FTSE=rowMeans(embed(EuStockMarkets[,4], 20))), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("deeppink", "purple"), "Smooth*20")
p <- 10
plot_Scatterplot(data.frame(time=1:(1860 + 1 - 100), DAX=rowMeans(embed(EuStockMarkets[,1], 100)), FTSE=rowMeans(embed(EuStockMarkets[,4], 100))), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("deeppink", "purple"), "Smooth*100")

# Draw two independent histograms.
p <- 7
plot_Histogram(data.frame(time=1:(12*20), sunspots=sunspot.month[(171*12+1):(171*12+12*20)]), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("darkgoldenrod"), "Sunspots", breaks=6)
p <- 8
plot_Histogram(data.frame(time=1:(12*20), temp=nottem), .x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .just=c("center","center"), .width=chart_Width, .height=chart_Height, c("red"), "Nottem", breaks=6)

# Draw sample objects in two charts spaces.
p <- 11
draw_Sample_Box(.x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .x_Scale=c(0,10), .y_Scale=c(-10,0), .justify=c("center","center"), .width=chart_Width, .height=chart_Height, .colors=c("dodgerblue","blue"), .box_X=c(4,6,6,4), .box_Y=c(-4,-4,-5,-5), .plot_Title="K")
p <- 12
draw_Sample_Box(.x_Loc=plot_Loc$x[p], .y_Loc=plot_Loc$y[p], .x_Scale=c(-1,1), .y_Scale=c(0,1), .justify=c("center","center"), .width=chart_Width, .height=chart_Height, .colors=c("dodgerblue","blue"), .box_X=c(-0.5,0,0,-0.5), .box_Y=c(0.8,0.8,0.7,0.7), .plot_Title="L") 
```**

# html - HTML5音频元素在播放时闪烁速率变化

> ID：15043175
> 
> 赞同：0
> 
> 时间：2013-02-23T17:08:44.953
> 
> 标签：html, google-chrome, audio, web-audio-api

`audio.playbackRate != 1`有没有人在 Chrome / Windows 上解决了音频信号闪烁的问题？

我在某处读到过这种闪烁应该出现在`rate < 0.5`或时`rate > 2.0`。但即使`0.9 < rate < 1.1`.

这是滑块在 0.9 和 1.1 之间的示例代码：http: [//jsfiddle.net/r6bPF/3/](http://jsfiddle.net/r6bPF/3/)

# macos - 在基于视图的 NSTableView 中使用时，NSViewController 视图未发布

> ID：15043176
> 
> 赞同：2
> 
> 时间：2013-02-23T17:08:47.923
> 
> 标签：macos, cocoa, memory-leaks, nstableview, nsviewcontroller

我有一个基于视图的 NSTableView，它使用 NSViewController 子类 (InspectorViewController) 的视图：

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    // Get inspector view controller
    InspectorViewController *inspectorViewController = [_inspectorViewControllers objectAtIndex:row];

    // Return its view
    return inspectorViewController.view;
} 
```

一切都很好，只是当我删除视图控制器（已很好地释放）时，NSViewController 的视图永远不会释放。

如果我改用此代码：

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    // Get inspector view controller
    InspectorViewController *inspectorViewController = [_inspectorViewControllers objectAtIndex:row];

    // Return its view
    NSTableCellView *view = [[NSTableCellView alloc] init] autorelease];
    [view addSubview:inspectorViewController.view];
    return view;
} 
```

当我删除视图控制器时，视图被正确释放。这是删除视图控制器的代码：

```
- (void)inspectorViewControllerClosed:(InspectorViewController *)inspectorViewController {
    // Get index of inspector view controller
    NSUInteger index = [_inspectorViewControllers indexOfObject:inspectorViewController];

    // Remove inspector view controller in array
    [_inspectorViewControllers removeObject:inspectorViewController];

    // Create index set
    NSIndexSet *indexSet = [NSIndexSet indexSetWithIndex:index];

    // Begin updates
    [_tableView beginUpdates];

    // Move row in table view
    [_tableView removeRowsAtIndexes:indexSet withAnimation:NSTableViewAnimationEffectFade];

    // End updates
    [_tableView endUpdates];
} 
```

我试图用一个小的示例代码重现这个问题，我有同样的问题，只有当我不直接返回视图控制器的视图时，视图控制器的视图才会被释放。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:29:57.430

发现， NSTableView 保留视图以供重用，使用以下代码正确发布：

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    // Get inspector view controller
    InspectorViewController *inspectorViewController = [_inspectorViewControllers objectAtIndex:row];

    // Disable reusing ?
    [_inspectorViewController.view setIdentifier:nil];

    // Return its view
    return inspectorViewController.view;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:32:15.720

你可以使用：

```
[inspectorViewController.view removeFromSuperview] 
```

在删除视图控制器之前。

# php - 有没有办法让网站的盗链立即失效

> ID：15043179
> 
> 赞同：0
> 
> 时间：2013-02-23T17:09:22.173
> 
> 标签：php, hotlinking

我希望此人历史记录中的所有链接立即失效，以便当您单击它们时，它只会将您带到主页。

我还希望它适用于后退按钮，这样当您单击后退按钮时，它会将您带回主页。

我知道它是可行的，因为 glype，（代理脚本）可以做到。问题是链接过期需要一个小时，我希望它立即发生。

我确实有一个想法，但我觉得似乎有一种比为每个动态变化的网站存储一个 ID 更简单的方法。

谢谢！

-迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T06:47:13.513

在您链接到过期页面的原始页面中，您可以创建一个“签名”URL，其中将包括您创建链接时的时间戳和用户 IP。一旦用户使用过时的签名 URL 或未签名 URL 访问您的网页，您将检查当前标记和用户链接标记，然后进行重定向。

我们在 WMSAuth 技术中为[Windows Media](http://wmsauth.org/examples)和[Wowza Media](http://blog.wmspanel.com/2012/05/protecting-wowza-from-re-publishing-re.html)使用了类似的方法。

# .htaccess - joomla htaccess RewriteRule 问题

> ID：15043184
> 
> 赞同：1
> 
> 时间：2013-02-23T17:09:47.600
> 
> 标签：.htaccess, mod-rewrite, redirect, joomla

我在我的 htaccess 中有一个重定向，它在我切换 SEF URL 之前在 joomla 中完美运行

RewriteRule ^m/(.*) /index.php?option=com_seemail&view=mail&guid=$1&itemid=102

但是，当我打开 SEF URLS 时，它不再起作用 - 我被定向到 /home/uncategorised/welcome

这是我的 htaccess ：

```
RewriteEngine On

RewriteRule ^m/(.*) /index.php?option=com_seemail&view=mail&guid=$1&itemid=102

RewriteCond %{REQUEST_FILENAME} !-f 
RewriteRule ^apply$ /index.php?option=com_loans&view=apply&Itemid=102 [R=301,L,QSA]

RewriteBase /
DirectoryIndex index.php

RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
RewriteRule ^(.*)$ index.php [F,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/index.php
RewriteCond %{REQUEST_URI} (/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$  [NC]
RewriteRule (.*) index.php
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L] 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:59:55.777

```
RewriteRule ^apply$ /index.php?option=com_loans&view=apply&Itemid=102 [R=301,L,QSA] 
```

根据上面的代码行，如果 url 中“apply”之后没有任何内容，它应该重定向到`/index.php?option=com_loans&view=apply&Itemid=102`并停止查看该案例的其他规则。

正如您所说，它正在重定向，这意味着它正在工作。

可以手动打开吗`<yourdomain.com>/index.php?option=com_loans&view=apply&Itemid=102`

如果它打开并且 url 是 sef，则复制域后的 sef url 并替换`/index.php?option=com_loans&view=apply&Itemid=102`为 RewriteRule 中的。

可能这应该有效。

# java - 如何在 Java 中通过开始和结束位置突出显示 JTextArea 中的字符串

> ID：15043189
> 
> 赞同：0
> 
> 时间：2013-02-23T17:10:13.443
> 
> 标签：java, file, jtextarea

我有一个正在 JTextArea 中读取的文本文件。

我有另一个程序，它给我一个字符串在文本文件中的开始和结束位置。

但是当我在 JTextArea 中应用荧光笔时，它并没有突出我想要的东西。

我的文本文件包含：

```
public class John {

public static void main(String[] args)
{
    System.out.println("Hello World");

    in x;

    } 
```

}

我有一个编译器，它给我以这种格式发生错误的位置：

```
Code: compiler.err.cant.resolve.location
Kind: ERROR
Line Number: 7
End position: 118
Start Position: 116 
```

**strong text**但是当我在我的荧光笔代码中使用这些位置时，它并没有突出我想要的内容。EG“in”应该只是荧光笔。这是我得到的输出。我相信当它们被加载到 JTextArea 时，位置正在改变。**强文本**

荧光笔代码：

```
 import java.awt.*;
  import java.io.FileReader;

  import javax.swing.*;
  import javax.swing.text.*;

  public class KerlovHighlighter {

private static final long serialVersionUID = 1L;
private Highlighter.HighlightPainter cyanPainter;
private Highlighter.HighlightPainter redPainter;

public KerlovHighlighter() {
    JFrame frame = new JFrame();
    JTextPane textPane = new JTextPane();
    try {
        textPane.read(new FileReader("C:\\Users\\Antish\\workspace\\Testing\\src\\MyC.java"), null);
      } catch (Exception e) {
        System.out.println("Failed to load file " );
        System.out.println(e);
      }
    JScrollPane scrollPane = new JScrollPane(textPane);
    frame.add(scrollPane, BorderLayout.CENTER);//  Highlight some text
    cyanPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.cyan);
    redPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.red);
    try {
        textPane.getHighlighter().addHighlight(116, 118, DefaultHighlighter.DefaultPainter);

    } catch (BadLocationException ble) {
    }
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setPreferredSize(new Dimension(300, 200));
    frame.setLocationRelativeTo(null);
    frame.pack();
    frame.setVisible(true);
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            KerlovHighlighter tph = new KerlovHighlighter();
        }
    });
} 
```

}

代码的输出：

```
[1]: http://prntscr.com/tuyqw "Output of Program" 
```

原始文本文件： [http](http://www.mediafire.com/?aiufxocfj0xm21e) ://www.mediafire.com/?aiufxocfj0xm21e ？

有人可以帮忙吗。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:30:52.407

> 我相信当它们被加载到 JTextArea 时，位置正在改变。

在 Windows 中，新行字符串是“\r\n”，它是两个字符。当您将文本文件加载到文档中时，文档使用“\n”作为行尾字符串，它只是一个字符。因此，对于文件中的每一新行，突出显示的偏移量都会减少一个。

此外，我们无权访问您的文本文件，因此我们无法看到您所描述的内容。当您发布 SSCCE 时，请确保它是完整的。因此，您可以这样做：

```
//textPane.read(new FileReader("C:\\Users\\Antish\\workspace\\Testing\\src\\MyC.java"), null);
textPane.read(new FileReader("KerlovHighlighter.java"), null); 
```

现在，如果我们执行您的代码，我们还可以读取一个有效的文本文件。

# xcode - 翻译查看不工作

> ID：15043193
> 
> 赞同：0
> 
> 时间：2013-02-23T17:10:26.987
> 
> 标签：xcode, uigesturerecognizer

我多次使用此代码，但在我当前的项目中它不起作用。这是错误（第三行）：“'UIGestureRecognizer'没有可见的@interface声明选择器'translationInView：'

和我的简单代码：

```
- (IBAction)panLayer:(UIGestureRecognizer *)pan{
if (pan.state == UIGestureRecognizerStateChanged) {
    CGPoint point = [pan translationInView:self.view];
    CGRect frame = self.settingsView.frame;
    frame.origin.y = self.layerPosition + point.y;
    if (frame.origin.y < 0) {
        frame.origin.y = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T03:58:25.953

您正在寻找具有 UIGestureRecognizer 作为父类的 UIPanGestureRecognizer。

```
- (IBAction)panLayer:(UIPanGestureRecognizer *)pan{
} 
```

# php - 如果配置文件 id = 1 不包含 profile.php？

> ID：15043199
> 
> 赞同：0
> 
> 时间：2013-02-23T17:10:59.453
> 
> 标签：php, mysql

有人可以帮助我在我的网站上有用户，当用户点击他们的个人资料时，它会将用户带到 profile.php?id=(无论 id 号码)

我正在尝试这样做，以便如果用户尝试转到配置文件 id='1' 那么这将包括 noprofile.php 基本上告诉用户配置文件不存在。

我一直在这样做，这似乎有效，但现在无论几天后它停止工作，我都不知道为什么？

有人可以告诉我我哪里出错了谢谢。

profile.php 中的代码：

```
<?php
$admin_account = admin_account();
while ($admin = mysql_fetch_array($admin_account)) {
    include ('includes/mod_profile/mod_noprofile.php');

}
?> 
```

功能：

```
function admin_account() {
            global $connection;
            global $profile_id;
            $query = "SELECT user_id
                        FROM ptb_profiles
                        WHERE user_id =\"$profile_id\"
                        AND ptb_profiles.user_id='1'";
            $admin_account = mysql_query($query, $connection);
            confirm_query($query, $connection);
            return $admin_account;
        } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-23T17:22:13.377

在执行查询之前进行测试以查看 id==1

```
if isset($_GET["id"]==1){
    include ('includes/mod_profile/mod_noprofile.php');
}
else {
    //do query and get user profile information
} 
```

# ios - 从 MonoTouch 中的特定 ABAddressBook 组中获取人员

> ID：15043200
> 
> 赞同：0
> 
> 时间：2013-02-23T17:11:03.157
> 
> 标签：ios, xamarin.ios, abaddressbook

在 IOS6 上使用 MonoTouch，我如何获取仅在 iPhone 中创建的通讯录联系人（不包括来自其他组的联系人，例如 Facebook）？

我正在使用以下代码，但是，它似乎返回了每个组的人。结果将包括我创建的联系人以及在 IOS6 中从 Facebook 同步的联系人。

```
ABAddressBook iPhoneAddressBook = ABAddressBook.Create(out err);
if(err != null)
    return null;

return iPhoneAddressBook.GetPeople(); 
```

我已尝试执行以下操作，但 GetGroup 函数返回 null。

```
return iPhoneAddressBook.GetPeople(iPhoneAddressBook.GetGroup(0).Source, ABPersonSortBy.FirstName); 
```

# mysql - 为多个值保持相同的自动增量 ID

> ID：15043201
> 
> 赞同：0
> 
> 时间：2013-02-23T17:11:07.063
> 
> 标签：mysql, auto-increment

我的数据库中有一个名为 university 的表，包含 3 列：“uni id”、“uni name”和“student id”。我添加了一个自动增量值“uni id”。当学生选择大学名称（比如“大学 A”）时，ID 应为 1，并且“学生 id”将更新为学生的 id。没关系。但是如果另一个用户选择了同一所大学（'University A'），'uni id' 将自动更改为 2（显然，它是一个自动增量值是的）。'uni name' 将保持不变的 'University A' 并且新的学生 ID 将被插入到表中。

有什么方法可以为特定的 uni 名称保留相同的 uni id？例如：

*   身份证 | 单名 | 学生卡
*   ---1---|---Uni A---|-----S10----
*   ---1---|---Uni A---|-----S37----

另外，我有第二张桌子，我可以在那个桌子上传递 uni id 吗？例如：

*   身份证 | 课程编号
*   ---1---| --CS90---

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:14:34.803

MyISAM 引擎允许您使用 auto_increment 作为复合 PRIMARY KEY 的组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:14:53.530

最好的方法是创建一个额外的表。您需要一张存储大学的表和另一张包含学生的表

大学表

```
uni_id uni_name
1      uni A 
```

学生表

```
uni_id student_id ID (Primary key)
1      S10        1
1      S37        2 
```

# ruby - 如何从类中访问“全局”（常量？）capistrano 变量？（红宝石）

> ID：15043202
> 
> 赞同：1
> 
> 时间：2013-02-23T17:11:15.477
> 
> 标签：ruby, global-variables, capistrano

所以我在 capistrano 中的 deploy.rb 脚本是这样开始的，我想这很正常：

```
require 'capistrano/ext/multistage'
require 'nokogiri'
require 'curb'
require 'json'

# override capistrano defaults
set :use_sudo, false
set :normalize_asset_timestamps, false

# some constant of mine
set :my_constant, "foo_bar" 
```

稍后，我可以在命名空间内的函数或任务中访问我的常量，例如：

```
namespace :mycompany do
    def some_function()
        run "some_command #{my_constant}"
    end

    desc <<-DESC
        some task description
    DESC
    task :some_task do
        run "some_command #{my_constant}"
    end
end 
```

但是，如果我在类中使用常量，如下所示：

```
namespace :mycompany do
    class SomeClass
        def self.some_static_method()
            run "some_command #{my_constant}"
        end
    end
end 
```

它失败了：

```
/config/deploy.rb:120:in `some_static_method': undefined local variable or method `my_constant' for #<Class:0x000000026234f8>::SomeClass (NameError) 
```

我究竟做错了什么？？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T09:57:10.190

deploy.rb 文件是 instance_evaled，这意味着它在对象的上下文中执行，因此您声明的任何内容都将可用，直到您离开该上下文。一旦您创建了一个提供新上下文的类。

为了访问原始上下文，您必须将对象（self）传递给类方法。

```
namespace :mycompany do
  class SomeClass
    def self.some_static_method(cap)
      run "some_command #{cap.fetch(:my_constant)}"
    end
  end

  SomeClass.some_static_method(self)
end 
```

虽然我真的不明白你为什么要这样声明一个类，但它是一个奇怪的地方。

# android - 澄清 PendingIntent.FLAG_CANCEL_CURRENT 的文档

> ID：15043206
> 
> 赞同：8
> 
> 时间：2013-02-23T17:11:57.510
> 
> 标签：android

来自Android[中待定意图的文档：`FLAG_CANCEL_CURRENT`](http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_CANCEL_CURRENT)

> 通过取消之前的待处理意图，这可以确保只有获得新数据的实体才能启动它。如果此保证不是问题，请考虑 FLAG_UPDATE_CURRENT

谁能解释这条线是什么意思？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-23T17:36:55.657

一旦你创建了一个新`PendingIntent`的 with `FLAG_CANCEL_CURRENT`，任何持有以前`PendingIntent`相同的东西`Intent`将不再能够执行那个原始`PendingIntent`的。

例如，假设我们有这个：

```
Intent i=new Intent(this, Foo.class);

i.putExtra("key", 1);

PendingIntent pi=PendingIntent.getActivity(this, 0, i, 0); 
```

我们将它`PendingIntent`与 a 一起使用`Notification`。

稍后，我们执行：

```
Intent i=new Intent(this, Foo.class);

i.putExtra("key", 2);

PendingIntent pi2=PendingIntent.getActivity(this, 0, i, PendingIntent.FLAG_CANCEL_CURRENT); 
```

此时，`PendingIntent`最初创建的 ( `pi`) 不再有效，无论我们使用什么`pi2`，都会看到更新后的额外值 ( `2`)。

相反，如果我们这样做了：

```
Intent i=new Intent(this, Foo.class);

i.putExtra("key", 2);

PendingIntent pi2=PendingIntent.getActivity(this, 0, i, PendingIntent.FLAG_UPDATE_CURRENT); 
```

此时，`pi`and`pi2`都表示*相同* `PendingIntent`的，并且都将看到更新后的额外值 ( `2`)。

或者，如果我们这样做了：

```
Intent i=new Intent(this, Foo.class);

i.putExtra("key", 2);

PendingIntent pi2=PendingIntent.getActivity(this, 0, i, 0); 
```

此时，`pi`and`pi2`仍然表示相同的`PendingIntent`，但附加项不变，因为`getActivity()`返回*原始* `PendingIntent`而不应用新的附加项。

大多数`FLAG_UPDATE_CURRENT`情况下，当您尝试替换`PendingIntent`.

# jsf-2 - 如何在 JSF2.0 Mojarra 中处理进度条

> ID：15043213
> 
> 赞同：0
> 
> 时间：2013-02-23T17:12:09.780
> 
> 标签：jsf-2

我在页面提交期间进行了 3 个 Web 服务调用。这些都是同步调用。我想在我的屏幕上向用户显示一种进度，例如“第一个服务启动”、“第一个服务调用完成”、“第二个服务启动”、“第二个服务调用完成”等。

我正在使用 JSF 2.0 Mojarra。任何人都可以为此提出建议吗？

# java - JButton 背景图片

> ID：15043218
> 
> 赞同：2
> 
> 时间：2013-02-23T17:12:20.467
> 
> 标签：java, swing, background, jbutton, look-and-feel

我正在编写一个 POS 系统（销售点）来取乐。POS 系统的一个典型特征是针对不同产品具有不同背景颜色的按钮。但我不是指按钮图像背后的背景，我的意思是在这张随机图片中，我从谷歌图片中得到了： ![在此处输入图像描述](../Images/38eb4c51e89683c507e02e4c15479e3f.png)

编辑：注意我改变了系统的外观和感觉

我需要用我的按钮做类似的事情。我知道这可能有几种方法：

1.  为我的按钮创建外观和感觉？
2.  完全覆盖我的 JButtons 中的 paintComponenet 方法（但这是一种非常可悲的方法......当我覆盖它时没有绘制边框 + 文本......显然是个坏主意）
3.  使用 button.setContentAreaFilled(false);，并在按钮后面放置一个与按钮大小相同的 JPanel。

我真的不知道如何创建自己的外观和感觉，这听起来很痛苦，尤其是对于 1 个按钮，我听到一些关于打破外观和感觉的事情，这让我害怕这个想法。第三种方式听起来很合理，而且不是非常困难，但我做我想做的事情的***最好方法是什么？***

现在我创建按钮的代码是这样的：

```
JButton b = new JButton(text);
    b.addActionListener(this);
    b.setFont(Main.f);
    b.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
    buttons.add(b);
    return b; 
```

我弄乱了这段代码（主要是为了好玩，而不是实用）：

```
JButton b = new JButton(text){
        public void paintComponent(Graphics g){
            super.paintComponent(g);
            Color bg = getBackground();
            int borderchange = -50;
            g.setColor(new Color(
                    Math.max(0,bg.getRed()+borderchange),
                    Math.max(bg.getGreen()+borderchange,0),
                    Math.max(bg.getBlue()+borderchange,0)));
            g.fillRect(0,0,getWidth(),getHeight());
            g.setColor(getBackground());
            int border = 4;
            g.fillRect(border,border,getWidth()-border,getHeight()-border);
            g.setColor(Color.BLACK);
            g.setFont(getFont());
            g.drawString(getText(),getWidth()/2,getHeight()/2);
        }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:17:26.733

*   > 为我的按钮创建外观和感觉？

    1.  外观和感觉就像主题一样，

    2.  默认情况下，此 ColorScheme 具有一、二、三种颜色，此主题适用于所有 Swing JComponent，

    3.  那么所有 Swing JComponents 都有相同的颜色，ColorScheme

    4.  不是你要找的东西

*   > 完全覆盖我的 JButtons 中的 paintComponenet 方法（但这是一种非常可悲的方法......当我覆盖它时没有绘制边框 + 文本......显然是个坏主意）

    7.  JButton 有颜色数组

    8.  您可以覆盖paintComponent，填充整个区域，使用一种颜色（不是您要寻找的东西）的矩形或使用GradientPaint

    9.  您可以覆盖[BasicButtonUI](https://stackoverflow.com/questions/5751311/creating-a-custom-button-in-java-with-jbutton/5755124#5755124)

    10.  覆盖[UIManager 中的正确键并将颜色数组放在那里](https://stackoverflow.com/questions/4458982/repaint-swing-button-with-different-gradient/5845007#5845007)

*   > 使用 button.setContentAreaFilled(false);，并在按钮后面放置一个与按钮大小相同的 JPanel。

    1.  这可能是最简单的方法，准备图标（或下载图标集）

    2.  使用正确的方法，实现（鼠标和键和键绑定）事件

        *   [在 JButton API 中](https://stackoverflow.com/questions/7877576/set-and-disable-icons-of-jtogglebutton/7877817#7877817)

        *   [覆盖 ButtonModel（通过使用 ChangeListener）](https://stackoverflow.com/questions/5751311/creating-a-custom-button-in-java-with-jbutton/5755124#5755124)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:15:30.667

你有没有尝试过：

```
yourButton.setBackground(COLOR) 
```

?

# c# - 在 C# 中错误地下载文件会返回零字节长的文件

> ID：15043219
> 
> 赞同：1
> 
> 时间：2013-02-23T17:12:29.927
> 
> 标签：c#, webclient

所以我正在尝试使用 WebClient 类下载文件，但问题是当下载完成时，应该下载的文件是 0 字节，我尝试上传相同的文件而没有扩展名，而不是在下载后更改它，但那没有没有帮助。我能做些什么？这是我使用的代码

```
WebClient updateDownloader = new WebClient();
updateDownloader.DownloadFile(new Uri("http://zazaia.ucoz.com/SomeExeFile.exe"),      
Application.StartupPath + "\\SomeFile.EXE"); 
```

并且还具有仅显示 MessageBox 并处理 WebClient 的 DownloadCompleted 事件处理程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:14:40.903

您显示的代码没有任何问题，这应该可以工作。问题出在没有正确返回文件的服务器上。还要确保您正在查询的站点在能够下载文件之前不需要进行一些身份验证。除此之外不要忘记 WebClient 不会执行任何 javascript，因此如果服务器依赖它来下载文件，则不会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:21:45.700

您是否检查过您的防病毒软件没有干扰？有时自动扫描会锁定正在下载的可执行文件，直到它通过。然而，客户端代码本身看起来不错。

服务器端呢？如果是您自己提供下载的应用程序之一，那么它可能没有设置 MIME 标头，甚至根本没有正确处理下载

# python - 将 Selenium Webdriver 与 python/ruby/perl 一起使用

> ID：15043221
> 
> 赞同：2
> 
> 时间：2013-02-23T17:12:49.257
> 
> 标签：python, perl, selenium, selenium-webdriver

我正在尝试以编程方式检索使用 javascript 进行检索的链接。为此，我决定使用许多人为此目的建议的 Selenium。这台机器是基于命令行的 linux 机器，我将在其上执行 Python2.4 ruby​​1.8.5 和 perl 5.8.8，我可以严格使用上述版本，仅在提到的任何编程语言中执行此任务。作为一个绝对的初学者，我对硒的许多术语及其与上述编程语言“版本”的兼容性感到困惑。我尝试阅读[http://docs.seleniumhq.org/docs/03_webdriver.jsp](http://docs.seleniumhq.org/docs/03_webdriver.jsp)但只是迷失在与硒相关的所有这些术语中。还有我的目的是不实际测试我的 Web 应用程序。因此，出于我仅执行检索链接的 javascripts 的简单目的，有没有像我这样的初学者应该知道并遵循的分步方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T07:50:54.887

你看过[WWW::Selenium](https://metacpan.org/module/WWW%3a%3aSelenium)模块吗？

# android - Android 应用程序在方向更改期间丢失数据

> ID：15043222
> 
> 赞同：7
> 
> 时间：2013-02-23T17:12:54.903
> 
> 标签：android, orientation

我有一个从教程中复制的应用程序，该教程使用`MediaStore.ACTION_IMAGE_CAPTURE`. 当我在手机上运行该应用程序时，我遇到了一些奇怪的事情。

即使我没有移动手机，相机应用程序本身也会在操作过程中翻转其方向几次。在返回教程应用程序之前，它会短暂进入横向模式。因此，教程应用程序在将控制权返回给它后会翻转回纵向模式，并且图像会丢失。我尝试将相机活动的方向设置为横向，并且图像没有丢失。

但是应用程序的布局是为纵向模式设计的。或者，如果我在拍摄照片时将相机保持在横向，我可以在我的应用程序重新聚焦后转动手机，而不会丢失图像。

我在网上做了一些闲逛。Stackoverflow 上有人提到方向的变化导致额外调用`onCreate`. “之所以`onCreate()`被调用，是因为当你在纵向时调用相机活动时，它会改变方向并破坏你之前的活动。” 我在调试模式下运行应用程序，并在 onCreate 和`onActivityResult`方法中设置了断点。`onCreate`当我以纵向模式拍照时，确实会被调用。调用顺序是onCreate、onActivityResult、onCreate。如果我以横向模式拍摄照片（这是我的相机应用程序以任何一种方式结束的地方），onCreate 不会被调用。既然我已经知道发生了什么，我该如何防止它成为问题？这是应用程序现在的样子：

```
package com.example.testapp;

import java.io.IOException;
import java.io.InputStream;

import android.app.Activity;
import android.app.WallpaperManager;
import android.content.Intent;
import android.content.res.Configuration;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.ImageView;

public class CameraActivity extends Activity implements View.OnClickListener {

    ImageButton ib;
    Button b;
    ImageView iv;
    Intent i;
    final static int cameraData = 0;
    Bitmap bmp;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.photo_activity);
        initialize();
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        // TODO Auto-generated method stub
        super.onConfigurationChanged(newConfig);
        setContentView(R.layout.photo_activity);
        initialize();
    }

    private void initialize() {
        iv = (ImageView)findViewById(R.id.imageViewReturnedPicture);
        ib = (ImageButton)findViewById(R.id.imageButtonTakePicture);
        b = (Button)findViewById(R.id.buttonSetWallpaper);
        b.setOnClickListener(this);
        ib.setOnClickListener(this);
    }

    @Override
    public void onClick(View arg0) {
        switch (arg0.getId()) {

        case R.id.buttonSetWallpaper:
            try {
                WallpaperManager wm = WallpaperManager.getInstance(getApplicationContext());
                wm.setBitmap(bmp);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            break;

        case R.id.imageButtonTakePicture:
            i = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            startActivityForResult(i, cameraData);
            break;
        }
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);
        if (resultCode == RESULT_OK) {
            Bundle extras = data.getExtras();
            bmp = (Bitmap)extras.get("data");
            iv.setImageBitmap(bmp);
        }
    }
} 
```

这是我在此活动清单中的内容：

```
                android:name="com.example.testapp.CameraActivity"
                android:label="相机活动"
                android:configChanges="方向"
                安卓：screenOrientation="人像"
```

我做了相当多的搜索，但我发现的大部分内容都缺乏具体的例子。我需要知道代码是什么样的，而不仅仅是要使用什么功能。

我的手机是 LG Motion。有没有其他人遇到过这个问题？如何修复？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-07-20T12:04:20.257

在清单中，在每个活动中我使用 configChanges：

```
 <activity
        android:name=".MainActivity"
        android:configChanges="screenLayout|orientation|screenSize"> 
```

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-23T17:35:47.957

您必须覆盖[onRetainNonConfigurationInstance](http://developer.android.com/reference/android/app/Activity.html#onRetainNonConfigurationInstance%28%29)并使用[getLastNonConfigurationInstance](http://developer.android.com/reference/android/app/Activity.html#getLastNonConfigurationInstance%28%29)来保存/恢复位图。

像这样：

```
// during onCreate(Bundle), after initialise()
bmp = getLastNonConfigurationInstance();
if(bmp!=null){ iv.setImageBitmap(bmp); }
else { /* the image was not taken yet */ } 
```

然后在您的活动中覆盖：

```
@Override
public Object onRetainNonConfigurationInstance (){
     return bmp;
} 
```

这将在旋转期间“保存”位图。

**编辑：**

使用建议的 onSaveInstanceState 的示例将起作用[，但不建议使用，因为它会使用大量内存并且速度非常慢](https://stackoverflow.com/a/4352194/906362)，但您很快就会需要其他情况：

```
public class SomethingSomething extends Activity{

    String name="";
    int page=0;

    // This is called when the activity is been created
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

            // if you saved something on outState you can recover them here
            if(savedInstanceState!=null){
                name = savedInstanceState.getString("name");
                page = savedInstanceState.getInt("page");
            }
    }

    // This is called before the activity is destroyed
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);

            outState.putString("name", name);
            outState.putInt("page", page);
    }
} 
```

如您所见，此解决方案不适合您的情况的原因是，用于此的[Android Bundle](http://developer.android.com/reference/android/os/Bundle.html)是 Android 特殊类型的序列化，可以处理实现 Parcelable 的原语、字符串和类（这些类实际上只打包它们的原语） . 即使您的位图确实实现了 Parcelable，将位图上的每个字节复制到捆绑包中也将花费大量时间，并且将使位图已经很大的内存消耗增加一倍。

现在让我们看看使用`setRetainInstance`（从您可以在`\sdk\extras\android\support\samples\Support4Demos\src\com\example\android\supportv4\app\FragmentRetainInstanceSupport.Java`.

确保还检查示例，因为它显示了其他一些花哨的技巧。

```
// This fragment will be managed by the framework but we won't built a UI for it.
public class FragRetained extends Fragment{
   public static final String TAG = "TAG.FragRetained";
   private Bitmap bitmap;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Tell the framework to try to keep this fragment around
        // during a configuration change.
        setRetainInstance(true);
    }
    public Bitmap getBitmap() { return bitmap; }
    public void setBitmap(Bitmap bmp) { bitmap = bmp; }
}

public class MyActivity extends Activity{

    private FragRetained myFragRetained;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
            // set the content view
            img = (ImageView)findViewById(R.id.byImgV);

            myFragRetained = getFragmentManger.findFragmentByTag(FragRetained.TAG);
            if(myFragRetained == null){
                myFragRetained = new FragRetained ();
            }else{
               Bitmap b = myFragRetained.getBitmap();
               if(b==null){
                  // the user still did not choose the photo
               }else{
                  img.setImageBitmap(b);
               }
            }
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if (resultCode == RESULT_OK) {
            Bundle extras = data.getExtras();
            bmp = (Bitmap)extras.get("data");
            iv.setImageBitmap(bmp);
            myFragRetained.setBitmap(bmp);
        }
    }

} 
```

并确保`android:configChanges="orientation"`从您的[清单中删除该行，因为它可能造成的伤害大于好处](http://developer.android.com/guide/topics/manifest/activity-element.html#config)，关于它的一个小引用：

> 注意：应避免使用此属性，并且仅将其用作最后的手段。有关如何正确处理由于配置更改而重新启动的更多信息，请阅读处理运行时更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-01T23:13:13.523

我周一参加了一个移动开发小组会议并得到了提示。一位为一家大公司为各种平台编写应用程序的程序员建议将位图附加到应用程序对象上。当我研究如何做到这一点时，我终于根据以下博客文章中的建议提出了一个可行的解决方案（帖子末尾的新问题）： [http ://android-er.blogspot.com/2011/ 10/share-bitmap-between-activities-as.html](http://android-er.blogspot.com/2011/10/share-bitmap-between-activities-as.html)

基本上，这需要在应用程序中的任何活动都可以访问它的位置将位图设置为公共资源。我创建了一个新类，如下所示：

```
package com.example.testapp;

import android.graphics.Bitmap;

public class CommonResources {
        public static Bitmap cameraBmp = null;
} 
```

然后我将CameraActivity.java 中对bmp 的所有引用更改为CommonResources.cameraBmp。

在初始化过程中，如果 CommonResources.cameraBmp 不为空，那么我用它来设置 ImageView 中的位图。

onCreate 和 initialize 现在看起来像这样：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
              super.onCreate(savedInstanceState);
        setContentView(R.layout.photo_activity);
        initialize();
}

private void initialize() {
        iv = (ImageView)findViewById(R.id.imageViewReturnedPicture);
        ib = (ImageButton)findViewById(R.id.imageButtonTakePicture);
        b = (Button)findViewById(R.id.buttonSetWallpaper);
        if (CommonResources.cameraBmp != null) {
                   iv.setImageBitmap(CommonResources.cameraBmp);
           }
        b.setOnClickListener(this);
        ib.setOnClickListener(this);
} 
```

然后，为了做一点清理工作，我添加了 onPause 如下：

```
@Override
protected void onPause() {
        // TODO Auto-generated method stub
              super.onPause();
        if (isFinishing()) {
                   // Save the bitmap.
                        CommonResources.cameraBmp = null;
           }
} 
```

我现在最大的问题是：我是否正确处理了内存或是否创建了垃圾收集问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-05T08:59:37.400

在网上搜索了很长一段时间的简单解决方案后，我查看了一些代码并想出了这个，我希望它对将来查看此线程的任何人有所帮助！

我的 Activity 类中有一个全局变量`public Uri imageURI = null;`，用于设置我正在使用的 ImaveView 的图像 URI；`onCreate()`和下面的代码`onSaveInstanceState()`

```
@Override
protected void onCreate(Bundle savedInstanceState) 
{   
    super.onCreate(savedInstanceState); 
    setContentView(R.layout.activity_thisactivity);

    //restore the bitmap for the image
    if (savedInstanceState!=null)
    {
        imageURI=savedInstanceState.getParcelable("imageURI");
        ImageView photo=(ImageView)findViewById(R.id.image);
        photo.setImageURI(imageURI);
    }
}

@Override
public void onSaveInstanceState(Bundle savedInstanceState)
{
    super.onSaveInstanceState(savedInstanceState);
    savedInstanceState.putParcelable("imageURI", imageURI);
} 
```

我希望有人觉得这很有用 - 只要询问您是否需要更多详细信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-23T17:19:38.290

您应该处理方向更改的方式是保存您的实例状态。如果您填写[onSaveInstanceState](https://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)方法，您可以在 onCreate 期间将保存到该捆绑包中的数据取回。这是为您完成的视图，但您必须自己保存其他数据。任何原始的、可分割的或可序列化的对象都可以通过这种方式保存，包括位图。

您应该这样做不仅是为了在配置更改中幸存下来，而且还要使您的状态保持在低内存条件下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-23T17:23:10.617

您是否尝试过将 android:launchMode="singleTop" 添加到 android 清单中的活动中，对我有用。问题是当方向改变并且您的数据丢失时，android会重新启动活动，如果您的活动已经在运行，它不会创建新实例。

```
 <activity 
            android:name=".FacebookActivity" 
            android:label="@string/facebook_app_name"
            android:launchMode="singleTop"
            android:configChanges="keyboardHidden|orientation"
            >
        </activity> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-23T17:25:10.553

要么使用[onSaveInstanceState](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)，然后使用您通过 onCreate 获得的参数，或者在清单上设置您将通过使用[configChanges](http://developer.android.com/guide/topics/manifest/activity-element.html#config)来处理方向更改并设置您希望自己处理的情况（例如orientation|screenSize|screenLayout ）。

# c++ - 读取 BMP BGR 值，传递给 glTexImage2D

> ID：15043223
> 
> 赞同：0
> 
> 时间：2013-02-23T17:13:05.830
> 
> 标签：c++, opengl, bmp

我编写了一个例程，将 BMP 文件中的所有像素值读取到一个数组中，我想将其提供给 openGL 的 glTexImage2D 以将其转换为纹理。这样做我意识到 BMP 文件中像素的实际格式是 BGR 而不是 RGB，所以我的数组包含蓝色、绿色、红色。结果，与原始位图相比，我的最终纹理的蓝色和红色通道交换了。

这就是我所说的：

```
glTexImage2D(GL_TEXTURE_2D, 0, 3, imgdata->width, imgdata->height, 0, GL_RGB, GL_UNSIGNED_BYTE, imgdata->pixdata); 
```

我传递的这种情况/错误论点的任何解决方法？我现在能找到的唯一解决方案是使用循环手动交换数组中的 RB 值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:28:05.683

为什么不将[glTexImage2D](http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml)的格式更改为 GL_BGR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T23:45:05.253

> 我设置了 GR_BGR 并将其标记为未声明的标识符

那么你没有使用[适当的库来获取 OpenGL](http://www.opengl.org/wiki/OpenGL_Loading_Library)。OpenGL 的系统提供的头文件可能包含也可能不包含最新的函数和枚举器。因此，您需要使用其中一个库来获取 OpenGL。您应该使用这些*而*不是`GL/gl.h`.

一旦你正确地访问了 OpenGL，剩下的就很简单了。用作`GL_RGB`您的[像素传输格式](http://www.opengl.org/wiki/Pixel_Transfer#Pixel_format)。

# javascript - 以编程方式遍历色轮并访问十六进制值或 rgb

> ID：15043226
> 
> 赞同：0
> 
> 时间：2013-02-23T17:13:24.973
> 
> 标签：javascript, css, algorithm, colors

使用 css 和 javascript 我想随着时间的推移巧妙地改变文本的颜色。使用javascript这应该相对简单。

然而，为了确保平稳过渡，我只想进行小的增量颜色变化......希望下面解释：

![在此处输入图像描述](../Images/51f1a78c38e779f3684fae538a3361e8.png)

粗略的箭头显示了我想要实现的颜色模式，它们是实现这些值的现有算法吗？还是有什么其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:17:29.040

在 HSL 中指定颜色并仅循环色调

```
var i = 0
setInterval(function(){
    i++
    if(i > 360){ i = 0 }
    document.body.style.color = "hsl("+(i)+",50%,50%)"
},100) 
```

或者更简洁一点

```
var i = 0
setInterval(function(){
    document.body.style.color = "hsl("+((i++)%360)+",50%,50%)"
},100) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:17:57.817

使用 HSL 颜色并将色调从 0 旋转到 360：

```
text.style.color = 'hsl(' + hue + '80%, 40%)'; 
```

# sql - 批量导入 SQL 的 BCP 格式文件编辑

> ID：15043228
> 
> 赞同：2
> 
> 时间：2013-02-23T17:13:30.027
> 
> 标签：sql, sql-server, csv, bulkinsert

我正在尝试将 CSV 文件中包含的大量数据导入 SQL 数据库。CSV 大小为 4g。CSV 有 329 列和 300,000 多行数据。到目前为止，我已经成功创建了数据库和表，一旦导入就会保存数据。数据包含字符串 (VARCHAR(x)、数字 (INT) 和日期 (DATE)。

CSV 文件中包含的数据由分隔符“，”分隔，但所有数据字段都用双引号括起来，有些字段不包含数据值。下面是数据的模拟示例。

"123244234","09/12/2012","名字","姓氏","地址 1","","","555-555-5555","","国家代码"

在研究中，我确定导入数据的最简单方法是使用 BCP 创建格式文件，然后将其与 BULK INSERT 一起使用。唯一可能是格式化格式文件以删除双引号。当尝试在没有格式文件的情况下导入时，它在第一行失败，因为第一列第一行是数字并且周围有“”。

我查看了以下链接，该链接讨论了删除双引号“ [http://support.microsoft.com/default.aspx?scid=kb;EN-US;132463](http://support.microsoft.com/default.aspx?scid=kb;EN-US;132463) ”并使用虚拟条目删除引号. 在这种情况下，这是很多手动编辑。有谁知道编辑格式文件的更好方法？这是格式文件的示例：

```
10.0
329
1       SQLCHAR             0       12      ","     1     NPI                            ""
2       SQLCHAR             0       12      ","     2     Entity Type Code               ""
3       SQLCHAR             0       12      ","     3     Replacement NPI                ""
4       SQLCHAR             0       9       ","     4     Employer Identification Number (EIN)                    SQL_Latin1_General_CP1_CI_AS
5       SQLCHAR             0       70      ","     5     Provider Organization Name (Legal Business Name)           SQL_Latin1_General_CP1_CI_AS
6       SQLCHAR             0       35      ","     6     Provider Last Name (Legal Name)                           SQL_Latin1_General_CP1_CI_AS
7       SQLCHAR             0       20      ","     7     Provider First Name                         SQL_Latin1_General_CP1_CI_AS
8       SQLCHAR             0       20      ","     8     Provider Middle Name                         SQL_Latin1_General_CP1_CI_AS
9       SQLCHAR             0       5       ","     9     Provider Name Prefix Text               SQL_Latin1_General_CP1_CI_AS
10      SQLCHAR             0       5       ","     10    Provider Name Suffix Text 
```

# android - 安卓行车记录仪

> ID：15043232
> 
> 赞同：0
> 
> 时间：2013-02-23T17:14:05.973
> 
> 标签：android, serial-port

我想将 Android 设备连接到行驶记录仪的 RS232 串行端口。是否可以在没有 Android 设备植根的情况下做到这一点？有没有这种连接的示例代码？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:25:23.490

在此处查看您的选项：[http](http://code.google.com/p/android-serialport-api/wiki/android_to_rs232_guideline) ://code.google.com/p/android-serialport-api/wiki/android_to_rs232_guideline 。

非根选项是：

*   蓝牙 -> RS232
*   USB 主机 -> UART 适配器。例如 IOIO [https://www.sparkfun.com/products/10748](https://www.sparkfun.com/products/10748)

# java - 在 EditText 中多行显示

> ID：15043234
> 
> 赞同：0
> 
> 时间：2013-02-23T17:14:12.467
> 
> 标签：java, android, sqlite, android-edittext

我正在尝试在`EditBox`. 但我有问题。到目前为止我的代码是

```
public void ViewEmployeeButton (View view)
{
    DatabaseHandler db = new DatabaseHandler(this);
    Employee e1 = new Employee();       
    EditText et=(EditText) findViewById(R.id.employeeId);
    EditText detailEmp=(EditText) findViewById(R.id.detailEmployee);
    int id=Integer.getInteger(et.getText().toString());
    e1=db.getEmployee(id);
    detailEmp.setText(???)
} 
```

员工具有`Getid, GetName, GetUsername, GetPassowrd, GetAge`将返回`Strings`. 现在在参数中写什么`setText`？以便输出在多行中。

在数据库中，行是这样的：

1 kiran 密码 KiranTauqir 21

我想要像这样的输出

id 1 用户名 kiran 密码 密码 姓名 KiranTauqir 年龄 21

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T12:12:22.907

您可以检索所有列值并将它们与换行符一起附加到字符串：“\n”。

示例代码可能如下所示：

```
 int i=0;
    String output;
    while(i<e1.getColumnCount())
    {
           output.append(e1.getString(i) +"\n");   //getString(i) will return the value of particular column
           i++;
    }
    detailEmp.setText(output); 
```

# python - Pygame精灵碰撞错误

> ID：15043245
> 
> 赞同：0
> 
> 时间：2013-02-23T17:14:54.700
> 
> 标签：python, pygame

我有几个关于 pygame 的问题。我对 python/pygame 完全陌生，并且很好奇我是否正确地执行了此操作，或者我是否正在写这个草率。

对于我的另一个问题，当我使用 spritecollide 时，即使图像消失，对象似乎仍然存在。让我分享代码

```
import pygame, time, random, sys, player, creep, weapon
from pygame.locals import *

pygame.init()

#Variables for the game
width  = 700
height = 500
clock = pygame.time.Clock()

screen = pygame.display.set_mode((width, height), 0, 32)
pygame.display.set_caption('Creep')

#Create Characters of the game
player1 = player.Player()
player1.rect.x = 0
player1.rect.y = 0

comp = creep.Creep()
comp.rect.x = random.randrange(width)
comp.rect.y = random.randrange(height)

bullet = weapon.Weapon()
bullet.rect.x = -1
bullet.rect.y = -1

#Make Character Groups
good = pygame.sprite.Group(player1)
bad = pygame.sprite.Group(comp)
weap = pygame.sprite.Group(bullet)

while True:
clock.tick(60)
screen.fill((0,0,0))

#set up for game to get input
for event in pygame.event.get():
    if event.type == pygame.QUIT:
        sys.exit()
    if event.type == KEYDOWN and event.key == K_ESCAPE:
        sys.exit()
    if event.type == KEYDOWN and event.key == K_c:
        bullet.rect.x = player1.rect.x + 25
        bullet.rect.y = player1.rect.y

#main controls
key = pygame.key.get_pressed()
if key[K_RIGHT]:
    player1.rect.x = player1.moveRight(player1.rect.x)
if key[K_LEFT]:
    player1.rect.x = player1.moveLeft(player1.rect.x)
if key[K_DOWN]:
    player1.rect.y = player1.moveDown(player1.rect.y)
if key[K_UP]: 
    player1.rect.y = player1.moveUp(player1.rect.y)

if bullet.rect.x > -1:
    weap.draw(screen)
    bullet.rect.x = bullet.rect.x +5

pygame.sprite.spritecollide(bullet, bad, True)
pygame.sprite.spritecollide(comp, good, True)

#game functions
good.draw(screen)
bad.draw(screen)

pygame.display.flip() 
```

所以我有一个枪的图像（player1，'good' group），一个计算机的图像（comp，'bad' group），以及一个当 LCTRL 被击中时的“bullet”图像（bullet，'weap' group )..当子弹击中坏组的图像时，它就消失了，这就是我想要的。但是当我朝那个方向移动 player1 图像时，它会消失，就好像“坏组”仍然存在一样。我希望这是有道理的。

我正在调用的类的示例代码如下所示：

```
import pygame

class Creep(pygame.sprite.Sprite):

def __init__(self):
    pygame.sprite.Sprite.__init__(self)
    self.image = pygame.image.load('creep.jpg')
    self.rect = self.image.get_rect() 
```

任何想法？如果有更好的方法请告诉我，我一周前才开始学习，不知道我是否朝着正确的方向前进。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:41:49.600

我不确定你的一些变量是什么。注意：如果你把一个精灵放在多个组中，然后**杀死**它，它**会自动在所有组中杀死它**。

我开始清理代码。

```
#import time, sys, # not longer required 

import player, creep, weapon
import random
import pygame
from pygame.locals import *

pygame.init()

#Variables for the game
width  = 700
height = 500
clock = pygame.time.Clock()

screen = pygame.display.set_mode((width, height), 0, 32)
pygame.display.set_caption('Creep')

#Create Characters of the game
player1 = player.Player()
player1.rect.x = 0
player1.rect.y = 0

comp = creep.Creep()
comp.rect.topleft = random.randrange(width), random.randrange(height)

bullet = pygame.sprite.Sprite()# weapon.Weapon()
bullet.rect.topleft = (-1, -1)

#Make Character Groups
good = pygame.sprite.Group(player1)
bad = pygame.sprite.Group(comp)
weap = pygame.sprite.Group(bullet)

done = False

while not done:
    clock.tick(60)

    #set up for game to get input
    for event in pygame.event.get():
        if event.type == pygame.QUIT: done = True
        if event.type == KEYDOWN:
            if event.key == K_ESCAPE: done = True

            elif event.key == K_c:
                bullet.rect.x = player1.rect.x + 25
                bullet.rect.y = player1.rect.y

    #main controls
    key = pygame.key.get_pressed()
    if key[K_RIGHT]:
        player.rect.x += 10
    if key[K_LEFT]:
        player1.rect.x -= 10
    if key[K_DOWN]:
        player.rect.y += 10
    if key[K_UP]: 
        player.rect.y -= 10    

    # movement, collisions
    pygame.sprite.spritecollide(bullet, bad, True)
    pygame.sprite.spritecollide(comp, good, True)

    # not sure what this was for? If you meant 'onscreen' or?
    # You can kill it if it goes offscreen. Otherwise draw works if offscreen.
    if bullet.rect.x > -1:
        bullet.rect.x += 5

    screen.fill(Color("black"))
    weap.draw(screen)

    #game functions
    good.draw(screen)
    bad.draw(screen)

    pygame.display.flip() 
```

# c# - 去编组结果？

> ID：15043247
> 
> 赞同：1
> 
> 时间：2013-02-23T17:15:01.980
> 
> 标签：c#, matlab, interop, pinvoke, matlab-coder

[这是对这个问题](https://stackoverflow.com/questions/15042298/adapt-wrapper-class-for-two-dimensional-case)的扩展，能够返回一个数组而不是一个标量。

通过 matlab 编码器从 matlab 代码生成的 C 代码现在看起来没问题（见下文）。我只是想弄清楚如何将结果返回到 C# 世界。这是我的第一次尝试：

C# 代码

```
[DllImport(@"C:\bla\CPlusPlus.dll", CallingConvention = CallingConvention.Cdecl)]
private static extern void test(ref emxArray_real_T a, ref emxArray_real_T result);

static void Main(string[] args)
{
    double[,] array2D = new double[,] { { 1, 2, 4 }, { 1, 3, 4 } };
    var wrapper = new EmxArrayRealTWrapper(array2D);

    var t = wrapper.Value;
    var t1 = wrapper.Value;
    test(ref t, ref t1);
}

public class EmxArrayRealTWrapper : IDisposable
{
private readonly emxArray_real_T _value;
private GCHandle _dataHandle;
private GCHandle _sizeHandle;

public emxArray_real_T Value
{
    get { return _value; }
}

public EmxArrayRealTWrapper(double[,] data)
{
    _dataHandle = GCHandle.Alloc(data, GCHandleType.Pinned);
    _value.data = _dataHandle.AddrOfPinnedObject();
    _sizeHandle = GCHandle.Alloc(new int[] { data.GetLength(0), data.GetLength(1) }, GCHandleType.Pinned);
    _value.size = _sizeHandle.AddrOfPinnedObject();
    _value.allocatedSize = data.GetLength(0) * data.GetLength(1);
    _value.numDimensions = 2;
    _value.canFreeData = false;
}

public void Dispose()
{
    _dataHandle.Free();
    _sizeHandle.Free();
    GC.SuppressFinalize(this);
}

~EmxArrayRealTWrapper()
{
    Dispose();
}
}

[StructLayout(LayoutKind.Sequential)]
public struct emxArray_real_T
{
public IntPtr data;
public IntPtr size;
public int allocatedSize;
public int numDimensions;
[MarshalAs(UnmanagedType.U1)]
public bool canFreeData;
} 
```

Matlab代码：

```
function [result] = test(a, result)
%#codegen

if(~isempty(coder.target))
    assert(isa(a,'double'));
    assert(all(size(a) == [1 Inf]));
    assert(isa(result,'double'));
    assert(all(size(result) == [1 Inf]));
end

result = sum(a); 
```

生成的C代码

```
void test(const emxArray_real_T *a, emxArray_real_T *result)
{
  real_T y;
  int32_T k;
  if (a->size[1] == 0) {
    y = 0.0;
  } else {
    y = a->data[0];
    for (k = 2; k <= a->size[1]; k++) {
      y += a->data[k - 1];
    }
  }

  k = result->size[0] * result->size[1];
  result->size[0] = 1;
  result->size[1] = 1;
  emxEnsureCapacity((emxArray__common *)result, k, (int32_T)sizeof(real_T));
  result->data[0] = y;
} 
```

PS：

鉴于大卫的回答，我目前正在尝试这样的事情：

```
[DllImport(@"C:\bla\CPlusPlus.dll", CallingConvention = CallingConvention.Cdecl)]
private static extern void test(ref emxArray_real_T a, ref emxArray_real_T result);

static void Main(string[] args)
{
    double[,] array2D = new double[,] { { 1, 2, 4 }, { 1, 3, 4 } };
    double[,] temp = new double[,] { { 0 }, { 0 } };
    var wrapper = new EmxArrayRealTWrapper(array2D);
    var wrapper1 = new EmxArrayRealTWrapper(temp);

    var t = wrapper.Value;
    var t1 = wrapper1.Value;
    test(ref t, ref t1);

    // initialise this by your call to the native code
    int[] size = new int[2];
    Marshal.Copy(t1.size, size, 0, 2);
    int nCol = size[0];
    int nRow = size[1];
    double[] data = new double[nCol * nRow];
    Marshal.Copy(t1.data, data, 0, nCol * nRow);
} 
```

这只给了我一个条目：7 nCol 和 nRow 等于 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:29:54.567

您实质上是在询问如何将 a 的内容读`emxArray_real_T`入 C# 对象。

让我们首先考虑一个一维数组。像这样阅读它：

```
emxArray_real_T result;
// initialise this by your call to the native code
int size = Marshal.ReadInt32(result.size);
double[] data = new double[size];
Marshal.Copy(result.data, data, 0, size); 
```

就是这样。你想要断言`result.numDimensions == 1`.

而且您可能不需要执行此`Marshal.Copy`步骤。您可能仍然可以访问您传递的数组`result.data`，因此您可以使用它。

二维情况更是如此。您需要再次检查一下`result.numDimensions == 2`。

```
int[] size = new int[2];
Marshal.Copy(result.size, size, 0, 2);
int nCol = size[0];
int nRow = size[1];
double[] data = new double[nCol * nRow];
Marshal.Copy(result.data, data, 0, nCol * nRow); 
```

这会将数据放入一维数组中，并且您可能希望将其放入二维托管数组中。假设 MATLAB 是 col-major，您需要处理 col-major 到 row-major 的转换。

```
double[,] arr = new double[nRow, nCol];
int index = 0;
for (int col = 0; col<nCol; col++)
{
    for (int row = 0; row<nRow; row++)
    {
        array[row, col] = data[index];
        index++;
    }
} 
```

# python - 在 Django 中使用一个按钮创建多个模型对象

> ID：15043248
> 
> 赞同：2
> 
> 时间：2013-02-23T17:15:08.140
> 
> 标签：python, django

我想解决我的问题，我一直在寻找答案，但我找不到任何解决方案。

假设我有一个模型：

```
class AccessCode(models.Model):
    access_code = models.CharField(max_length=100, verbose_name='Access code',
    unique=True, default=key_generator)
    def __str__(self):
        return self.access_code
    def __unicode__(self):
       return self.access_code 
```

只有一个字段。我喜欢做的是在管理面板中创建额外的按钮，并使用此按钮在我的数据库中自动创建 100 个访问代码。所以有2个问题：

1.  如何在管理面板中创建自定义按钮以执行某些操作？
2.  如何一步自动创建某个模型的100个对象？

key_generator 是我的自定义函数，用于生成随机字符串作为默认值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T23:01:38.763

您可以使用`bulk_create`Django 1.4 中引入的方法，

```
AccessCode.objects.bulk_create([AccessCode() for i in range(100)]) 
```

但是，这种方法存在一些问题，来自 django doc

> 不过，这有一些警告：
> 
> ```
> - The model’s save() method will not be called, and the pre_save and post_save signals will not be sent.
> - It does not work with child models in a multi-table inheritance scenario.
> - If the model’s primary key is an AutoField it does not retrieve and set the primary key attribute, as save() does. 
> ```

要将操作添加到管理页面，请查看[此答案](https://stackoverflow.com/a/14920485/2074398)并详细说明如何操作。

# sql - 重写函数以不返回记录类型

> ID：15043249
> 
> 赞同：1
> 
> 时间：2013-02-23T17:15:09.083
> 
> 标签：sql, function, postgresql, record, plpgsql

我需要以不返回记录类型的方式重写此函数。原因是我需要使用它来创建视图。

```
CREATE OR REPLACE FUNCTION conta_relatos(IN _fator_normativo integer, IN _fator_determinativo integer, OUT rel_pri integer, OUT rel_sec integer, OUT rel_ref integer)
RETURNS record AS
$BODY$
DECLARE
  tipo_relato text;
BEGIN

rel_pri := 0;
rel_sec := 0;
rel_ref := 0;

FOR tipo_relato IN
   SELECT f."Tipo_Relato"
   FROM "Vinculos" v 
   INNER JOIN ("Fontes" f INNER JOIN "Itens" i ON f."ID" = i."Fonte") ON v."Item" = i."ID"
   WHERE  v."Fator_Normativo" = _fator_normativo
   AND    v."Fator_Determinativo" = _fator_determinativo
LOOP
   CASE tipo_relato
   WHEN '1 - Relato Primário' THEN 
       rel_pri := rel_pri + 1;
   WHEN '2 - Relato Secundário' THEN 
       rel_sec := rel_sec + 1;
   WHEN '3 - Relato Referencial' THEN 
       rel_ref := rel_ref + 1;
   END CASE;
END LOOP;
END;
$BODY$
LANGUAGE plpgsql VOLATILE
COST 100; 
```

该函数必须返回 3`int`列：`rel_pri`, `rel_sec`,`rel_ref`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:19:19.937

您可以使查询与返回复合类型（记录/行）的函数一起工作，而无需更改它。[我误解了您前面问题](https://stackoverflow.com/questions/15035977/postgres-create-view-with-record-type-function)
中的错误消息，并在那里更新了我的答案。

当我们讨论**重写你的函数**时，这可以重写为 SQL 语句（正如我[之前提到](https://stackoverflow.com/questions/15030722/postgres-function-end-lop-and-return-error/15031072#15031072)的）：

```
SELECT COUNT (f."Tipo_Relato" = '1 - Relato Primário'    OR NULL) AS rel_pri
      ,COUNT (f."Tipo_Relato" = '2 - Relato Secundário'  OR NULL) AS rel_sec
      ,COUNT (f."Tipo_Relato" = '3 - Relato Referencial' OR NULL) AS rel_ref
FROM   "Vinculos" v 
JOIN   "Itens"    i ON i."ID" = v."Item"
JOIN   "Fontes"   f ON f."ID" = i."Fonte"
WHERE  v."Fator_Normativo" = _fator_normativo
AND    v."Fator_Determinativo" = _fator_determinativo; 
```

要使其成为现有函数*的直接替代品*，您可以将其包装到**SQL 函数**中，这可能比您现在拥有的要快一点：

```
CREATE OR REPLACE FUNCTION conta_relatos(
    _fator_normativo integer
   ,_fator_determinativo integer
   ,OUT rel_pri integer
   ,OUT rel_sec integer
   ,OUT rel_ref integer) AS
$func$
   SELECT COUNT (f."Tipo_Relato" = '1 - Relato Primário'    OR NULL) -- rel_pri
         ,COUNT (f."Tipo_Relato" = '2 - Relato Secundário'  OR NULL) -- rel_sec
         ,COUNT (f."Tipo_Relato" = '3 - Relato Referencial' OR NULL) -- rel_ref
   FROM   "Vinculos" v 
   JOIN   "Itens"    i ON i."ID" = v."Item"
   JOIN   "Fontes"   f ON f."ID" = i."Fonte"
   WHERE  v."Fator_Normativo" = _fator_normativo
   AND    v."Fator_Determinativo" = _fator_determinativo
$func$ LANGUAGE sql; 
```

# javascript - HTML 不适用于 javascript

> ID：15043251
> 
> 赞同：0
> 
> 时间：2013-02-23T17:15:13.990
> 
> 标签：javascript, html, function

我是编程新手。我试图在 html 中调用一个函数，但它不起作用。有什么问题？提前致谢。（不要问整个集成的事情）。

我的 HTML 代码：

```
<!DOCTYPE html>
<html>
    <head>
    <script src="IntegrationCalculator.js"></script>
    <script>
        integrationCalculator(7);
    </script>

</head>
<body>
    <p id="tester">
        Didn't work :(
    </p>
</body> 
```

我的 JavaScript 代码：

```
var integrationCalculator = function (variable1) {
if (variable1 = 7) {
    document.getElementById("tester").innerHTML="WORKED";
}
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:17:46.080

两件事情。首先`if (variable1 = 7)`应该是`if (variable1 == 7)`。其次，在 DOM 中加载元素后调用您的函数。

```
<!DOCTYPE html>
<html>
    <head>
    <script src="IntegrationCalculator.js"></script>
</head>
<body>
    <p id="tester">
        Didn't work :(
    </p>
    <script>
        integrationCalculator(7);
    </script>
</body> 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/v7sh9/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:20:52.380

`integrationCalculator``tester`在创建段落之前调用。因此，会引发错误并停止脚本的执行。

# android - Android：如何将字体与图像文档匹配？

> ID：15043252
> 
> 赞同：0
> 
> 时间：2013-02-23T17:15:29.223
> 
> 标签：android, pattern-matching

我正在构建一个 OCR。我已经对图像进行了二进制化。但我需要知道如何将字体与图像匹配。我开始了解 tesseract。但它是一个内置工具。实际上，我需要知道将图像文本与 .ttf 格式的字体匹配的算法背后的原理。如果 tesseract 是 android 的唯一选择，那么您能否描述一些与 windows7 集成的步骤，因为我从 Gautam 的博客中不清楚。如果有任何其他用于 android 的内置方法将图像模式与 .ttf 文件匹配，请建议我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:45:25.897

您必须将 tesseract-enginge 训练为您的字体。项目网站上有关于此主题的详尽教程。您不必在 android 设备上训练 tesseract，但您必须将训练结果部署到它。

# c++ - 双向链表维护排序列表

> ID：15043257
> 
> 赞同：-3
> 
> 时间：2013-02-23T17:15:38.300
> 
> 标签：c++, list

如何在没有排序功能的情况下维护排序的列表。当我添加节点时，我想保持列表排序。删除节点时也是如此。

```
 #include <iostream>
    #include <cstdlib>
    #include <string>
    using namespace std;

struct Node
{
 //node declare
  double value;
  Node *next;
  Node *prev;
  Node(double y)
  {
      value = y;
      next = prev = NULL;
  }
};

class DLinkedList
{
  Node *front;
  Node *back;
  public:
  DLinkedList()
  {  
               front = NULL; back = NULL; 
  }
  //declare function
  void NodeFront(double x);
  void NodeBack(double x);
  void dispForward();
  void dispReverse();
}; 
void DLinkedList::NodeFront(double x)
  {
        Node *n = new Node(x);

        if( front == NULL)
        {
            front = n;
            back = n;
        }
        else
        {
            front->prev = n;
            n->next = front;
            front = n;}

  }
  void DLinkedList::NodeBack(double x)
  {
        Node *n = new Node(x);
        if( back == NULL)
        {
            front = n;
            back = n;
        }
        else
        {
            back->next = n;
            n->prev = back;
            back = n;

        }

}
 //forward nodes
  void DLinkedList::dispForward()
  {
      Node *temp = front;
      cout << "forward order:" << endl;
      while(temp != NULL)
      {
         cout << temp->value << " " ;
         cout<<endl;
         temp = temp->next;
      }
  }
  //reverse list
  void DLinkedList::dispReverse()
  {
      Node *temp = back;
      cout << "reverse order :" << endl;
      while(temp != NULL)
      {
         cout << temp->value << " " ;
         cout<<endl;
         temp = temp->prev;
      }
  }

int main()
{
    DLinkedList *list = new DLinkedList();
    //front of the list
    list->NodeFront(45.0);
    list->NodeFront(49.0);
    list->NodeFront(42.0);
    list->NodeFront(48.0);
    list->NodeFront(48.0);
    list->NodeFront(52.0);
    list->NodeFront(12.0);
    list->NodeFront(100.0);

    list->dispForward();
    list->dispReverse();
    cin.get();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:54:36.070

听起来你想要一个新功能：

```
 void DLinkedList::NodeSorted(double x)
  {
        Node *n = new Node(x);

        // Step 1:  Find the first node "x" that should be AFTER n.

        // Step 2:  Make the node before "x" link to n

        // Step 2:  Make "x" link to n

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:55:49.063

维护它很容易排序。添加另一个方法 NodeSorted（名字不好，我只是按照你的约定，它们应该是 insertFront、insertBack、insertSorted）。这个方法应该做什么 - 将节点插入到适当的位置，所以你遍历你的列表，一旦找到大于你需要插入的元素，在它之前插入你的节点。请注意，要使此类 NodeSorted 正常工作，您需要维护列表排序，即避免使用 NodeFront 和 NodeFront。当然，如果实施得当，NodeSorted 本身将保持列表处于排序状态。

# java - 如何在java中的递归函数中创建一个数组

> ID：15043264
> 
> 赞同：1
> 
> 时间：2013-02-23T17:16:40.773
> 
> 标签：java, arrays, swing, recursion

我有一个递归方法，可以在命令行中打印出值。我需要创建一个带有结果的临时数组，并使用 Swing 显示它。每次循环时如何创建数组并存储值？

```
static void listSnapshots(VirtualMachine vm)
    {
        if(vm == null)
     {
        JOptionPane.showMessageDialog(null, "Please make sure you selected existing vm");
        return;
     }

    VirtualMachineSnapshotInfo snapInfo = vm.getSnapshot();
    VirtualMachineSnapshotTree[] snapTree = snapInfo.getRootSnapshotList();
    printSnapshots(snapTree);
}

static void printSnapshots(VirtualMachineSnapshotTree[] snapTree)
{
    VirtualMachineSnapshotTree node;
    VirtualMachineSnapshotTree[] childTree;

    for(int i=0; snapTree!=null && i < snapTree.length; i++)
    {
        node = snapTree[i];
        System.out.println("Snapshot name: " + node.getName());
        JOptionPane.showMessageDialog(null, "Snapshot name: " + node.getName());
        childTree = node.getChildSnapshotList();

        if(childTree != null)
        {

            printSnapshots(childTree);
        }
    }//end of for 
```

所以我只有一个带有名称列表的窗口，而不是 JOptionPane，以后可以重用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:45:16.700

递归构建东西的一般策略是使用[收集参数](http://c2.com/cgi/wiki?CollectingParameter)。

这可以通过以下方式应用于您的情况：

```
static List<String> listSnapshotNames(VirtualMachineSnapshotTree[] snapTree) {
    ArrayList<String> result = new ArrayList<String>();
    collectSnapshots(snapTree, result);
    return result;
}

static void collectSnapshots(VirtualMachineSnapshotTree[] snapTree, List<String> names)
{
    VirtualMachineSnapshotTree node;
    VirtualMachineSnapshotTree[] childTree;

    for(int i=0; snapTree!=null && i < snapTree.length; i++)
    {
        node = snapTree[i];
        names.add(node.getName());
        childTree = node.getChildSnapshotList();

        if(childTree != null)
        {

            collectSnapshots(childTree, names);
        }
    }//end of for
} 
```

当然，如果你真的想要它在一个数组中，你可以在之后转换它：

```
static String[] getSnapshotNames(VirtualMachineSnapshotTree[] snapTree) {
    List<String> result = listSnapshotNames(snapTree);
    return result.toArray(new String[0]);
} 
```

对于未知的大小，数组很痛苦，所以 a`List`更适合这个。

# php - PHP限制调用公共方法

> ID：15043268
> 
> 赞同：1
> 
> 时间：2013-02-23T17:17:27.553
> 
> 标签：php, methods, class-visibility

我正在开发一个库，该库有很多类，这些类都由一个中心类组合在一起。这个中心类必须调用其他类的某些方法来进行设置/配置。这些方法必须是公共的，以便中心类可以调用它们，但我不希望用户调用这些方法（因为它可能会导致不良行为）。

我的一个朋友提出的一个建议是使用带参数的构造函数可以在构造时完成设置。对于这个库来说，这并不容易。有问题的类旨在扩展，如果用户想要拥有自己的构造函数，我不想对构造函数参数施加任何奇怪的要求。更复杂的是，一些用于配置的信息对用户不可用。我必须将其提供给用户，并相信他们会在构建过程中将其路由回正确的类。

目前，我的解决方案是在这些方法前面加上一些东西，并提醒用户不要调用带有上述前缀的方法。这足够“灵活”，可以让我添加更多受限制的方法，但它仍然假设用户将遵循我的指示。它也不是最优雅的解决方案。

我想知道是否有某种方法可以轻松地限制这些方法。我考虑在它们中添加一条线来检查是否是中心类在调用它们，但这似乎也不是最好的解决方案。

**编辑：**我应该解释这个架构的目的。每个类在一组操作中执行一个特定的任务。中心班级的工作是指挥一个班级执行任务，收集结果，并将结果分发给需要它们的其他班级。然后班级移动到下一个班级并做同样的事情。如何执行任务取决于扩展类。我想要限制的方法是有助于分散结果的方法。我希望这能让我的意图更清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:09:08.700

这一切都取决于您的中心班级的角色。根据您的描述，它似乎是一个假脱机程序或调度程序。如果假脱机对象实际上是由该中心类创建的，则可以通过将这些对象设为私有来对客户端隐藏这些对象，然后在中心对象中创建存根，以允许客户端调用您允许的函数。

例如（概念代码，可能无法实际编译）

```
class HiddenSubClass {
  public function MyFunc() {
    echo "hello";
  }
}

class CentralClass {
  private $obj;

  function __construct() {
     $obj=new HiddenSubClass();
  }

  function SubClassMyFunc () {
    $obj->MyFunc();
  }
} 
```

客户端只有 CentralClass 对象，因此只能调用 SubClassMyFunc，而不能调用 MyFunc。这样做的缺点是，这也会对客户端隐藏库的面向对象结构，这可能是可取的，也可能不是。

但是，如果对象是由客户端创建的，然后移交给您的中心类，那么您几乎无法阻止对象的所有者（客户端）对其进行任何操作。客户端可以调用您的中心类可以调用的任何内容。然后，您可能必须将要保护的代码移出所述类 - 进入“帮助类”或中心类本身。

**编辑：**如果您确实想“破解”它，这将是一种方法（尽管我不推荐它，因为它很臭）：

在你的中心班级有一个“秘密”。

```
class CentralClass {
  private $MySecret=42;

  function IsValidSecret($anumber) {
    return ($anumber==$this->MySecret);   
  } 
} 
```

现在，当中心类在假脱机对象上调用某些“受保护”函数时，可以将 $MySecret 作为参数传递。如果 CentralClass 是单例，则假脱机对象可以调用该单例来检查传递的密钥是否正确。如果 CentralClass 不是单例，您也必须传递该对象。

```
class MySpooledObject {
  function SuperSecretFunction ($asecret) {
    if (!$CentralSingleton->isValidSecret($asecret)) { die(); }
  }

  function SuperSecretFunction2 ($acentralobject,$asecret) {
    if (!$acentralobject->isValidSecret($asecret)) { die(); }
  }
} 
```

这有很多变化。中心类可以在调用对象的方法之前设置一个内部标志，并在它返回时重置它。在这种情况下，对象可以询问中心类是否设置了该标志，并且不需要传递任何秘密。但是，您仍然需要 $acentralobject，除非它是单例。

# vba - Microsoft Vb 脚本中基于对象的编程

> ID：15043271
> 
> 赞同：1
> 
> 时间：2013-02-23T17:17:40.463
> 
> 标签：vba, vbscript

我在 vb 脚本或 VBA 中基于对象的编程中有一个基本问题。通常，当我们在 Java 中使用面向对象编程时，我们使用对变量或函数的对象引用，例如：

```
Obj.Add() or Obj.i=5 
```

但在 VBA 和 VB 脚本中，我们使用 Obj.Property.Property 或 Obj.Method.Property 之类的东西，例如：

```
Set sib = Tchilds.item(j).childNodes 'where item is a method defined in DOM. 
```

我怀疑这在逻辑上怎么可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:54:28.707

如果您将 Properties 视为 Subs/Functions/Methods（如 getter/setter）的表亲，那么这个谜团应该消失了。“访问对象成员”运算符（点）“有效”，只要左边有（引用）一个对象，右边有一个有效的成员 - 方法、变量/字段或属性 - 名称。只要`x.y`表达式计算为一个对象，链接点就“有效”，因此 in`y.z` `z`是该对象的成员。最后一个可能是非对象（右侧没有其他点）。

```
>> Set oFS = CreateObject("Scripting.FileSystemObject")
>> Set oFld = oFS.GetFolder(".") -- method .GetFolder returns Folder object
>> Set oFiles = oFld.Files -- Property .Files returns collection object
>> WScript.Echo oFiles.Count -- oFiles has a simple/non-object member .Count
>>
2
>> WScript.Echo oFiles.Count.ToString() -- .Count is not an object, but a number
>>
Error Number:       424
Error Description:  Object required
>> WScript.Echo oFS.GetFolder(".").Files.Count -- chaining
                obj obj            obj   var
>>
2 
```

# ruby-on-rails - rails 3中的errors.full_messages格式

> ID：15043272
> 
> 赞同：21
> 
> 时间：2013-02-23T17:17:41.830
> 
> 标签：ruby-on-rails

这里有个小问题。

我的闪光通知/警报在里面`[" "]`

![在此处输入图像描述](../Images/2f409f525c1a9a04f9986a8021552569.png)

在我的控制器中，如果未保存表单，我必须显示错误。

```
format.html { redirect_to  new_project_procurement_management_plan_path, alert:"#{@project_procurement_management_plan.errors.full_messages}"} 
```

以下是我如何将 Flash 放入视图中：

**_alert.html.erb**：

```
<% [:notice, :error, :alert].each do |level| %>
  <% unless flash[level].blank? %>
    <div class="alert alert-<%= flash_class(level) %>" id="flash">
      <a class="close" data-dismiss="alert" href="#">×</a>
      <%= content_tag :p, flash[level] %>
    </div>
  <% end %>
<% end %> 
```

在我的帮助文件中：

```
#Flash Message

    def flash_class(level)
        case level
        when :notice then "success"
        when :error then "error"
        when :alert then "error"
    end
  end 
```

现在我怎样才能删除里面的错误显示`[" "]`

谁知道在哪里配置？谢谢。

**编辑**

这是我的模型中的验证消息：

```
def equality
    self.items.each do |item|
      errors.add(:base, "#{item.description.capitalize}: Quantity must be equal to the breakdown of quantity!") if item.months != item.qty
    end
  end 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-23T19:34:01.413

`errors.full_messages`返回所有错误消息的数组，这就是您看到括号和引号的原因。您可以使用`.to_sentence`将该数组转换为可读的句子。

`@project_procurement_management_plan.errors.full_messages.to_sentence`

# javascript - 加载许多小的 JavaScript 文件还是加载一个大的 JavaScript 文件更好？

> ID：15043275
> 
> 赞同：15
> 
> 时间：2013-02-23T17:17:48.250
> 
> 标签：javascript

我在 chrome 中注意到，如果我将图像加载为 base64 字符串，然后滚动浏览页面的该部分，它会变慢。

我还注意到，当我从一个包含我的 Javascript 的选项卡中导航出来然后回到该选项卡时，它会慢几秒钟，就好像 V8 正在重新编译 js 一样。

我能想到三个选项，但我不知道哪个最好：

1.  首先加载一个微小的加载页面并雄辩地处理后续加载
2.  加载一个包含所有内容的巨大 js 或 css 文件（jquery + 我的代码 + 等）
3.  将某些代码聚集在一起（使用 jquery cdn，但将我的代码组合在一起）

让你的 js 尽可能快速和雄辩地加载的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-23T17:27:15.837

通常，在 HTTP 中加载更多文件会比将它们合并到更少文件中产生更多开销。有多种方法可以为各种内容组合文件：

*   对于图像，使用[CSS sprites](http://css-tricks.com/css-sprites/)。
*   对于 javascript，[将您的客户端代码和库编译到一个文件](https://stackoverflow.com/questions/12893046/how-to-manage-client-side-javascript-dependencies)中，并缩小以减小大小。
*   对于 css，您可以执行与上述类似的操作。[例如， hem 将 stylus 编译](https://npmjs.org/package/hem)成一个 css 文件，这在组织上也有帮助。
*   此外，当您连接 Javascript 和 CSS 时，您的网络服务器或反向代理可以[以压缩形式发送它们以](http://en.wikipedia.org/wiki/HTTP_compression)加快页面加载速度。这对于较大的文件将更有效，因为从压缩中可以获得更多收益。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-23T17:45:12.430

有太多的可能性可以得到任何有保证的解决方案，但是你去：

1）在顶部加载CSS——如果你正在做一个有多个页面的网站，把它全部加载到那里。如果您正在构建一个单页应用程序（您在同一页面上运行画廊和 twitter 提要和文章等，并且您可以打开和关闭不同的部分），那么您可以考虑加载特定于小部件的 CSS，在您加载小部件的时间（如果在启动时不需要它）。

不要在你的 CSS 中使用*@import*，如果你想让它快速加载（你这样做）。

2）在页面底部加载绝大多数JS。
在 DOM 准备好之后，几乎没有什么不能延迟加载，或者至少不能在页面底部初始化，如果真的有，则将它们作为单独的文件提供在顶部页面，并考虑如何重写以减少对它们的依赖。

3) 小心使用计时器——尤其是 setInterval... ...如果计时器管理不善，您的页面性能可能会遇到很多麻烦。

4) 对窗口滚动、调整大小、鼠标移动或按键等事件处理程序要更加小心。这些东西每秒触发很多很多次，因此如果您编写了依赖它们的精美程序，您需要重新考虑如何触发程序（即：不要在每次处理程序发生故障时都运行它）。

5) 提供 JS 文件是一种权衡：编译 JS 需要一段时间。因此，如果您在一个文件中加载 40,000 行，您的浏览器将暂停一段时间，因为它会编译所有这些。
如果您提供 18 个单独的文件，那么您必须进行 18 个不同的服务器调用。
那也不酷。

因此，一个很好的平衡是将您知道该页面需要的文件连接在一起，然后延迟加载页面上可选的任何内容（例如用于添加评论的小部件或灯箱小部件等） .
并且要么在所有主要产品启动并运行后延迟加载它们，要么在可能的最后一秒加载它们（比如当用户点击“添加评论”按钮时）。

如果您需要在您的应用程序中加载 40,000 行，那么在它启动时，请接受打击，或者决定您可以按什么顺序加载每一行，并提供“加载”指示器（您应该在延迟加载时这样做）总是）每个小部件，直到它准备好（一次加载一个 JS）。

这些是解决一般性能问题的指南。
即使您将网站直接放在您面前，也很难回答具体问题。使用 Chrome 开发控制台来分析信息和网络性能，以及渲染性能等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T17:25:34.240

嗯，有一个**非常流行的**概念叫做*串联*。这个想法是尽可能少地向您的服务器发出 HTTP 请求。因为每个请求都意味着一个新的连接，为此会发生 DNS 查找，然后协商握手，然后在更多基于协议的步骤之后，服务器将请求的文件作为响应发送。

您可以查看[http-archive](http://stevesouders.com)以获取性能最佳实践列表。

所以是的，你应该将所有 JS 文件合并为一个（有某些例外，比如 js 在头部和 js 在页脚）

这是您的问题标题和第 2 点和第 3 点的答案。

至于另一部分，我不清楚你所说的场景。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-26T10:51:25.913

我最近遇到了同样的问题，然后我开发并发布了一个 JS 库（MIT 许可证）来做到这一点。基本上，您可以将所有内容（js、图像、css ...）放入标准 tar 存档（您可以在服务器端创建），然后库读取它并允许您轻松使用文件。

你会在这里找到它：[https ://github.com/sebcap26/FileLoader.js](https://github.com/sebcap26/FileLoader.js)

它适用于所有最近浏览器和 IE >= 10。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T17:31:18.210

要加载的文件数量会影响整个站点的加载速度。我建议将网站正确显示所需的所有功能打包到一个 javascript 文件中。

# php - 无法在 PHP 中登录我的脚本

> ID：15043278
> 
> 赞同：0
> 
> 时间：2013-02-23T17:18:01.170
> 
> 标签：php, html

我正在尝试使自己成为一个带有会员登录系统的简单 PHP 网站。我已经创建了网站的注册部分，并且条目成功更新/添加到我的 Mysql 数据库中。但是我只是无法让我的 login.php 使用详细信息登录。我的 login.php 的 php 代码如下；

```
<?php
if ($_POST['mem_email']) {
//Connect to the database through our include 
include_once "storescripts/connect_to_mysql.php";
$email = stripslashes($_POST['mem_email']);
$email = strip_tags($email);
$email = mysql_real_escape_string($email);
$password = ereg_replace("[^A-Za-z0-9]", "", $_POST['mem_password']); // filter everything     but numbers and letters
$password = md5($password);
// Make query and then register all database data that -
// cannot be changed by member into SESSION variables.
// Data that you want member to be able to change -
// should never be set into a SESSION variable.
$sql = mysql_query("SELECT * FROM members WHERE mem_email='$email' AND         mem_password='$password' AND mem_emailactivated='1'"); 
$login_check = mysql_num_rows($sql);
if($login_check > 0){ 
while($row = mysql_fetch_array($sql)){ 
    // Get member ID into a session variable
    $id = $row["mem_id"];   
    session_register('mem_id'); 
    $_SESSION['mem_id'] = $id;
    // Get member username into a session variable
    $username = $row["mem_username"];   
    session_register('mem_username'); 
    $_SESSION['mem_username'] = $username;
    // Update last_log_date field for this member now
    mysql_query("UPDATE members SET mem_lastlogin=now() WHERE mem_id='$id'"); 
    // Print success message here if all went well then exit the script
    header("location: member_profile.php?id=".$id); 
    exit();
} // close while
} else {
// Print login failure message to the user and link them back to your login page
print '<br /><br /><font color="#FF0000">No match in our records, try again </font><br />
<br /><a href="login.php">Click here</a> to go back to the login page.';
exit();
}
}// close if post
?> 
```

位于同一页面上的表格如下；

```
<table align="center" cellpadding="5">
<form action="login.php" method="post" enctype="multipart/form-data" name="logform"  id="logform" onsubmit="return validate_form ( );">
<tr>
<td class="style7"><div align="right">Email Address:</div></td>
      <td><input name="mem_email" type="text" id="mem_email" size="30" maxlength="64" /></td>
    </tr>  
    <tr>
      <td class="style7"><div align="right">Password:</div></td>
      <td><input name="mem_password" type="password" id="mem_password" size="30" maxlength="24" /></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td><input name="Submit" type="submit" value="Login" /></td>
    </tr>
  </form>
</table> 
```

我的数据库看起来像这样

```
mem_id  int(11)
mem_username    varchar(255)
mem_country varchar(255)
mem_county  varchar(255)
mem_address varchar(255)
mem_email   varchar(255)
mem_password    varchar(255)
mem_signupdate  datetime
mem_lastlogin   datetime
mem_accounttype enum('a', 'b', 'c')
mem_emailactivated  enum('0', '1')
mem_postcode    varchar(255)
mem_city    varchar(255) 
```

每次在我的登录表单中输入正确的数据时，我都会处理到带有失败消息的 else 语句

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:27:21.167

`ereg_*`和`mysql_*`功能贬值！使用[preg_*](http://www.php.net/manual/en/ref.pcre.php)函数和 PDO 或 Mysqli 进行数据库交互。

此外，使用参数化查询来防止 sql 注入，PDO 和 mysqli 都支持。

当您想返回记录的计数时，您可以让 sql 为您做计数。例如：

```
SELECT COUNT(*) FROM `members` WHERE `mem_emailactivated` = '1' 
```

现在使用`fetchColumn()`PDO 的方法或使用 mysqli 中的替代方法来获取与我们查询中给定条件匹配的记录数！

另一件事是，要使会话正常工作，`session_start()`请在每一页的开头使用。

希望能帮助到你。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:45:00.217

请使用 mysqli_ 调用。mysql_ 已弃用[http://www.php.net/mysql_fetch_row](http://www.php.net/mysql_fetch_row)

这个问题更多的是关于正确的调试。这可以通过 php echos 或更好的调试器来完成，例如在 Eclipse PDT 中。无论如何，1\. 检查是否输入了 if ($_POST['mem_email']) {。2\. 在您的数据库中运行查询。它成功了： 3\. 使用 mysqli_fetch_row 获取一行。我猜你只需要一排。4.如果一切正常，在你的数据库中运行更新查询，看看它是否成功。

# mysql - Mysql 限制和排序依据

> ID：15043281
> 
> 赞同：1
> 
> 时间：2013-02-23T17:18:04.903
> 
> 标签：mysql, sql-order-by, limit

我想在表格中显示最后修改的元素，但将结果限制为 5，所以我这样做了：

```
SELECT
  Id as Id,Title,LastModified
From
  articles
WHERE
  (Author=70 OR Editor=32 OR Publisher=33) && Disab ="0"

Order By   LastModified

LIMIT 0, 5 
```

此查询的问题在于它返回表的前 5 行，而不是最后 5 已编辑的行...

我错过了什么？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:19:20.280

默认`ORDER BY`为升序。你想下降

```
SELECT
  Id as Id,Title,LastModified
From
  articles
WHERE
  (Author=70 OR Editor=32 OR Publisher=33) && Disab ="0"

Order By   LastModified DESC

LIMIT 0, 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:19:20.733

试试这个

```
SELECT
  Id as Id,Title,LastModified
From
  articles
WHERE
  (Author=70 OR Editor=32 OR Publisher=33) && Disab ="0"

Order By   LastModified DESC

LIMIT 0, 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:19:24.727

您只需要添加子句即可按降序`DESC`对`ORDER BY`记录进行排序。

```
ORDER BY LastModified DESC 
```

默认情况下，`ORDER BY`子句按`ASCENDING`顺序排序。

# node.js - 永远在 Ubuntu 上运行 node.js 服务器

> ID：15043286
> 
> 赞同：5
> 
> 时间：2013-02-23T17:18:20.543
> 
> 标签：node.js, npm, forever

我正在尝试使用“永远”的 node.js 包在 Ubuntu 上运行 node.js 服务。似乎它应该是直截了当的。但是，当我运行它时，我会收到以下输出：

```
/usr/bin/env: node: No such file or directory 
```

我认为这可能是因为 Ubuntu 包管理器将 node.js 二进制文件命名为`nodejs`，而不是`node`更标准的 。有没有办法告诉永远包在哪里可以找到节点？

（我确实尝试过符号链接`/usr/bin/node`到`/usr/bin/nodejs`，但这产生了更多错误，而且感觉就像是黑客攻击）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:55:51.950

您是否尝试[过从源代码安装最新的节点](https://github.com/joyent/node/wiki/Installation)？

```
git clone https://github.com/joyent/node.git
cd node
git checkout v0.8.22 #Try checking nodejs.org for what the stable version is
./configure
make
sudo make install 
```

[该视频](https://www.youtube.com/watch?feature=player_detailpage&v=J6g53Hm0rq4#t=457s)并不完全清楚，但作者暗示 Debian 存储库中的旧版本 node 是 node/nodejs 命名问题的原因。

[或者，您可以尝试使用此处](https://stackoverflow.com/questions/130329/how-do-you-get-what-a-symbolic-link-points-to-without-grep)描述的任何方法查找 /usr/bin/nodejs 符号链接的目标，然后创建一个 /usr/bin/node 符号链接。

祝你好运！

# javascript - 新窗口中的链接是可选的

> ID：15043292
> 
> 赞同：1
> 
> 时间：2013-02-23T17:18:49.243
> 
> 标签：javascript, html, button

假设我希望我的用户可以选择他们单击的链接是在同一个浏览器窗口中打开，还是在使用复选框的新浏览器窗口中打开。该复选框将覆盖元素中目标的使用。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:20:47.543

使用 jQuery 很容易。我觉得这些天“javascript”标签真的只是意味着“我还没有选择我的框架”：

```
$('#myCheckbox').on('click', function() {
    $('.myAnchors').attr('target', this.checked ? '_blank' : ''); 
}); 
```

演示：http: [//jsfiddle.net/BNrYs/](http://jsfiddle.net/BNrYs/)

没有 jQuery：

```
document.getElementById('myCheckbox').addEventListener('click', function() {
    var anchors = document.getElementsByClassName('myAnchors');
    for (var i = 0, max = anchors.length; i < max; i += 1) {
        anchors[i].setAttribute('target', this.checked ? '_blank' : '');
    }
}); 
```

演示：http: [//jsfiddle.net/n6EP8/](http://jsfiddle.net/n6EP8/)

如果您需要旧版 IE 支持，您还需要`attachEvent`添加`addEventListener`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:40:34.117

好吧，从用户体验的角度来看，我想说这不是一个好习惯。因此，不推荐使用 HTML 属性 target="_blank"。用户已经在浏览器中控制了这个功能。为此添加一个复选框可能会让用户感到困惑。但是，如果你真的想要，你可以用 jQuery 来做：

HTML

```
<ul class="links">
    <li>
        <input type="checkbox" id="checkbox"/>
        <a href="yoursite.com">Your Site</a>
    </li>
    <li>
        <input type="checkbox" id="checkbox"/>
        <a href="someothersite.com">Your Site</a>
    </li>
</ul> 
```

jQuery

```
$('.links input').change(function(){

    var checkbox = $(this),
        link = $(this).siblings('a');

    if( checkbox.is(':checked') ){
        link.attr('target', '_blank');
    }else{
        link.attr('target', '_self');
    }

}); 
```

这是一个jsfiddle：http: [//jsfiddle.net/RX2cP/](http://jsfiddle.net/RX2cP/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:31:25.920

```
<a id="link" href="http://www.google.be">test</a>
<input id="target" type="checkbox" onclick="changeTarget();"/>

<script type="text/javascript">
function changeTarget() {
    var checked = document.getElementById('target').checked;
    var target = checked ? '_blank' : '';

    document.getElementById('link').setAttribute('target', target);
}
</script> 
```

# c# - 如果我正在验证用户权限，我需要修改代码 - 自定义主体

> ID：15043294
> 
> 赞同：0
> 
> 时间：2013-02-23T17:18:52.760
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, forms-authentication, iprincipal

在我的登录方法中，我使用此代码登录用户：

```
FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe); 
```

因为我想在需要时避免数据库调用`UserId`以及一些其他数据，所以我做了一些事情，但我不太确定我做对了。
所以这就是为什么我需要有人检查我的代码，它是否安全而不是愚蠢:)
我这样做是否违反了一些规则。
这是我网站安全阶段的最后阶段，因为我不再使用会员/角色。

所以我改变了上面的 SetAuth... 代码：

```
CustomPrincipalSerializeModel serializeModel = new CustomPrincipalSerializeModel();
                    var usr = userRepository.GetUser(model.UserName);

                    serializeModel.UserId = usr.UserId;
                    serializeModel.Username = usr.UserName;

                    JavaScriptSerializer serializer = new JavaScriptSerializer();

                    string userData = serializer.Serialize(serializeModel);

                    FormsAuthenticationTicket authTicket = new FormsAuthenticationTicket(
                             1,
                             usr.UserName,
                             DateTime.Now,
                             DateTime.Now.AddMinutes(30),
                             model.RememberMe,
                             userData);

                    string encTicket = FormsAuthentication.Encrypt(authTicket);
                    HttpCookie faCookie = new HttpCookie(FormsAuthentication.FormsCookieName, encTicket);
                    Response.Cookies.Add(faCookie); 
```

在我的**Global.asax**中，我添加了：

```
protected void Application_PostAuthenticateRequest(Object sender, EventArgs e)
        {
            HttpCookie authCookie = Request.Cookies[FormsAuthentication.FormsCookieName];

            if (authCookie != null)
            {
                FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCookie.Value);

                JavaScriptSerializer serializer = new JavaScriptSerializer();

                CustomPrincipalSerializeModel serializeModel = serializer.Deserialize<CustomPrincipalSerializeModel>(authTicket.UserData);

                CustomPrincipal newUser = new CustomPrincipal(authTicket.Name);
                newUser.UserId = serializeModel.UserId;
                newUser.Username = serializeModel.Username;
                newUser.FirstName = serializeModel.FirstName;
                newUser.LastName = serializeModel.LastName;

                HttpContext.Current.User = newUser;
            }
        } 
```

自定义主体代码 - 对于问题的主要目标可能并不重要：

```
public interface ICustomPrincipal : IPrincipal
    {
        int UserId { get; set; }
        string Username { get; set; }
        string FirstName { get; set; }
        string LastName { get; set; }        
    }
public class CustomPrincipal : ICustomPrincipal
    {
        public IIdentity Identity { get; private set; }
        public bool IsInRole(string role) { return false; }

        public CustomPrincipal(string email)
        {
            this.Identity = new GenericIdentity(email);
        }

        public int UserId { get; set; }
        public string Username { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
    }
public class CustomPrincipalSerializeModel
    {
        public int UserId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string Username { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:21:02.243

我可以看到您的代码的第一个问题是您应该使用 web.config 中的表单身份验证设置（例如超时、域、路径、requireSSL ......）来为表单身份验证票证和 cookie 设置这些值。现在你已经硬编码了这些值。例如，您为票证硬编码了 30 分钟超时，这可能与您的 web.config 中为 cookie 寿命设置的超时不同。默认值为 20 分钟。但是，如果您在 web.config 中更改此值以增加它，您的 cookie 将比表单身份验证票存在更长的时间。因此，用户将始终在 30 分钟后注销，而不是在您指定的超时后注销。

此外，我会使用自定义 Authorize 属性来解析表单身份验证票并设置主体，而不是使用全局`Application_PostAuthenticateRequest`事件。第一个是更 MVCish 的方式来实现这一点。但这只是一个建议，从安全或行为的角度来看没有问题。

# flash - 如何知道所有数据何时到达节点套接字

> ID：15043295
> 
> 赞同：0
> 
> 时间：2013-02-23T17:18:54.893
> 
> 标签：flash, node.js, sockets, actionscript

我在后端使用 node.js 和 net 模块，并在前端使用 flash。我想传递 json 格式的对象。我怎么知道所有数据何时到达我的后端，以便我可以执行 JSON.parse？

我的动作脚本：

```
var obj = new Object();
obj.msg = "I want pizza";
xmlSocket.send(JSON.encode(obj)); 
```

我的JavaScript：

```
 socket.on("data", function(data){
        var msg = JSON.parse(data.toString());

        var i = 0;
        while(i < clientData.length){

            var client = clientData[i];
            if(client.writable){
                client.write(msg.msg, 'utf8');
            }
            i++;    
        }

}); 
```

目前我收到一个错误，我不确定与此有关，因为它显示了整个对象：

```
undefined:1
{"msg":"I want pizza"}
                      ^
SyntaxError: Unexpected token 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:23:01.017

要知道数据何时结束，您必须在前面添加一些指定长度的内容或在末尾添加一些内容以表明数据结束。因此，要么将长度放在 JSON 的前面，要么在每个 JSON 对象之后放置一个换行符。

还有：什么`JSON.encode`？我只知道`JSON.stringify`。

# android - 将 OnTouchListener 用于拖放操作时设置延迟

> ID：15043296
> 
> 赞同：0
> 
> 时间：2013-02-23T17:18:57.280
> 
> 标签：android, drag-and-drop, onclicklistener, ontouchlistener, tablerow

我有一个包含表格行的项目，可以通过拖放将其移动到其他表格。我希望这些行也可以突出显示，我将 focusable 和 focusableontouchmode 设置为 true 并将背景设置为 list_selector_background 并使行可点击。没有 OnTouchListener 选择工作正常，但如果我将 onTouchListener 设置为行，它会在我单击它时立即启动拖放过程。有没有办法设置 onTouchListener 的延迟，以便它可以区分单击和拖放过程的开始？（因此您必须按住行上的单击才能开始拖动）

OnTouchListener：

```
private final class MyTouchListener implements OnTouchListener {
    public boolean onTouch(View view, MotionEvent motionEvent) {
        if (motionEvent.getAction() == MotionEvent.ACTION_DOWN) {
            ClipData data = ClipData.newPlainText("", "");
            DragShadowBuilder shadowBuilder = new View.DragShadowBuilder(
                    view);
            view.startDrag(data, shadowBuilder, view, 0);
            view.setVisibility(View.INVISIBLE);
            return true;
        } else {
            return false;
        }

    }
} 
```

行：

```
teacherRow.setId(tid);
teacherRow.setBackgroundResource(drawable.list_selector_background);
teacherRow.setFocusable(true);
teacherRow.setFocusableInTouchMode(true);
teacherRow.setClickable(true);
teacherRow.setOnTouchListener(new MyTouchListener()); 
```

我还尝试使用行上的 OnClickListener 来解决它，但这也不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T21:01:16.780

> 有没有办法设置 onTouchListener 的延迟，以便它可以区分单击和拖放过程的开始？

我不确定我是否完全理解您想要做什么，但请查看以下代码：

```
 public boolean onTouch(final View view, MotionEvent motionEvent) {
            if (motionEvent.getAction() == MotionEvent.ACTION_DOWN) {
                mHandler.postDelayed(new Runnable() {

                    @Override
                    public void run() {
                        if (view.isPressed()) {
                            ClipData data = ClipData.newPlainText("", "");
                            DragShadowBuilder shadowBuilder = new View.DragShadowBuilder(
                                    view);
                            view.startDrag(data, shadowBuilder, view, 0);
                            v.setVisibility(View.INVISIBLE);
                        }
                    }

                }, (long) (1.5 * ViewConfiguration.getLongPressTimeout()));
            }
            return false;
        } 
```

哪里`mHandler`是一个简单的`Handler`例子。

# delphi - 在哪里释放动态分配的 TFrame 组件的对象？

> ID：15043297
> 
> 赞同：7
> 
> 时间：2013-02-23T17:18:57.890
> 
> 标签：delphi, destructor, tframe

我有一个包含`TFrame`. `TFrame`包含一个`ComboBox`动态填充的。每个`ComboBox`条目都有一个关联的对象。到调用重写的析构函数时，已经清除`TFrame`了 中的项目，而没有释放它们的关联对象。`ComboBox`无论我`ComboBox`在设计器视图中将表单放在表单上，​​还是使用 nil 或`TFrame`作为其所有者在代码中动态创建它，都会发生这种情况。我目前使用包含的`OnDestroy`事件`TForm`来调用包含的清理过程`TFrame`。

有没有更好的方法不需要`TFrame`容器的显式过程调用？理想情况下，动态添加到的对象应该在哪里`ComboBox`被释放？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-24T15:36:55.367

你说*当 TFrame 的析构函数被调用时， ComboBox 的 Items 已经被清除了*。情况并非如此，ComboBox 项目永远不会被清除。当 Items 被 ComboBox 销毁时，它们的计数仅为 0。

当您退出应用程序并且 VCL 销毁包含框架和 ComboBox 的表单时，本机 ComboBox 控件也被操作系统销毁，因为它被放置在被销毁的窗口中。当您稍后访问项目以释放​​框架析构函数中的对象时，VCL 必须重新创建本机 ComboBox 控件，项目计数为 0。

我提出的解决方案很简单。不要将您的框架释放给框架，而是在`OnDestroy`您的表单发生时销毁您的框架。那将是在表单的基础窗口被破坏之前，因此您将能够访问您的对象。

表格单元

```
procedure TMyForm.FormDestroy(Sender: TObject);
begin
  MyFrame.Free;
end; 
```

框架单元

```
destructor TMyFrame.Destroy;
var
  i: Integer;
begin
  for i := 0 to ComboBox1.Items.Count - 1 do
    ComboBox1.Items.Objects[i].Free;
  inherited;
end; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-24T15:50:26.923

您可以像这样使用`TFrame`'`WM_DESTROY`处理程序：

```
unit Unit2;

interface

uses
  Windows, Messages, SysUtils, Classes, Controls, Forms, StdCtrls;

type
  TFrame1 = class(TFrame)
    ComboBox1: TComboBox;
  private
    procedure WMDestroy(var Msg: TWMDestroy); message WM_DESTROY;
    procedure FreeComboBoxItems;
  public
    constructor Create(AOwner: TComponent); override;
  end;

implementation

{$R *.dfm}

constructor TFrame1.Create(AOwner: TComponent);
begin
  inherited;
  // Add some object items to the ComboBox
  ComboBox1.AddItem('a', TButton.Create(nil));
  ComboBox1.AddItem('b', TMemoryStream.Create);
  ComboBox1.AddItem('c', TList.Create);
end;

procedure TFrame1.WMDestroy(var Msg: TWMDestroy);
begin
  // Make sure the TFrame is actually destroying - not recreated
  if (csDestroying in ComponentState) then
    FreeComboBoxItems;
  inherited;
end;

procedure TFrame1.FreeComboBoxItems;
var
  I: Integer;
begin
  OutputDebugString('TFrame1.FreeComboBoxItems');
  with Self.ComboBox1 do
    for I := 0 to Items.Count - 1 do
    begin
      OutputDebugString(PChar(Items.Objects[I].ClassName + '.Free'));
      Items.Objects[I].Free;
    end;
end;

end. 
```

* * *

另一种选择是为整个应用程序创建一个 Base 祖先`TAppBaseForm`类和 a ，并将所有 Forms 派生为，并将所有 Frames 派生为。这样就可以通知所有它的孩子所有者表单在事件处理程序上被销毁。此时 ComboBox 项目仍然有效（如 Sertac Akyuz 的[回答](https://stackoverflow.com/a/15053330/937125)所述）。`TAppBaseFrame``TAppBaseForm``TAppBaseFrame``TAppBaseForm``TAppBaseFrame``TAppBaseForm.FormDestroy`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-24T13:29:40.960

您的问题并不是很有用，因为 - 一般而言 - 不鼓励*将*数据（或您的情况下的对象）存储在 GUI 控件中。另请参阅 David 关于如何更改设计的评论。

使这个问题变得有趣的是，组合框直接作为表单的子项与作为表单的另一个子项（在这种情况下为您的框架）的子项之间的区别。显然，组合框项目在调用该框架的析构函数之前被*销毁*。探索的明显替代方案是：覆盖`Frame.BeforeDestruction`、覆盖`Frame.DestroyWindowHandle`、覆盖`Frame.DestroyWnd`或捕获`WM_DESTROY`覆盖`Frame.WndProc`，但在项目已经消失之前，它们都不会被调用。

接下来要尝试的是对组合框重复此操作。事实证明，当`WM_DESTROY`到达组合框时，项目仍然存在。但是，请注意仅在控件真正被销毁时才捕获该消息，因为 VCL 可能会频繁地重新创建组合框。使用插入类 for 来实现它`TComboBox`，如下所示：

```
unit Unit2;

interface

uses
  Windows, Messages, Classes, Controls, Forms, StdCtrls;

type
  TComboBox = class(StdCtrls.TComboBox)
  protected
    procedure WndProc(var Message: TMessage); override;
  end;

  TFrame1 = class(TFrame)
    ComboBox1: TComboBox;
  end;

implementation

{$R *.dfm}

{ TComboBox }

procedure TComboBox.WndProc(var Message: TMessage);
var
  I: Integer;
begin
  if (Message.Msg = WM_DESTROY) and (csDestroying in ComponentState) then
    for I := 0 to Items.Count - 1 do
      Items.Objects[I].Free;
  inherited WndProc(Message);
end;

end. 
```

现在，回答您的问题：“这是更好的方法吗？”

是的，因为它提供了在框架级别上破坏对象的保证。换句话说：您不必*记住*为每个实例分别处理这个问题。

不，不是，因为此解决方案要求在任何情况下都允许释放组合框中的对象，这将使用限制在不必要的额外边界。

那么，这个答案有用吗？好吧，如果它阻止您使用当前的方法，那么它就是。

* * *

`Parent`此外，我还通过在包含表单处理程序中将框架的属性设置为 nil找到了另一种选择`OnDestroy`：

```
procedure TForm2.FormDestroy(Sender: TObject);
begin
  Frame1.Parent := nil;
end; 
```

在这种情况下，您可以安全地销毁存储在框架析构函数内的组合框中的对象。但是这个解决方案比你现在的解决方案更糟糕，因为它不是描述性的。然后就好`Frame1.FreeComboObjects`很多了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-09T06:47:43.373

在析构函数中释放 Combobox.Items.Objects 为时已晚。所以，根据以前的答案，这样做更好也更安全：

```
 procedure TMyFrame.ClearCBObjects;
   var
     i: Integer;
   begin
     for i := 0 to ComboBox1.Items.Count - 1 do
       ComboBox1.Items.Objects[i].Free;  
   end;

   destructor TMyFrame.Destroy;
   begin
     //Free none Component objects

     inherited;
   end;

   destructor TMyForm.Destroy;
   begin
     MyFrame.ClearCBObjects;

     inherited;
   end; 
```

# css - CSS：如何继承整个类

> ID：15043308
> 
> 赞同：1
> 
> 时间：2013-02-23T17:19:48.687
> 
> 标签：css, inheritance

我定义了“t_data”类来自定义我的大多数表的外观。

虽然，在某些情况下，我需要做一个额外的表格专业化：假设我想要“客户”和“订单”的表格看起来不同。

继承样式的默认方法是将两个类的 css 定义描述到同一个块中，如下所示：

```
table.t_data, table.t_data_order, table.t_data_customer
{
    background-color: #080;
} 
```

这种方式在一定程度上运作良好......直到我得到太多不同的定义。

现在我已经有了这样的东西：

```
table.t_data thead tr th, table.t_data thead tr td, table.t_data tbody tr th,     table.t_data tbody tr td, table.t_data tfoot tr th, table.t_data tfoot tr td,
table.t_group thead tr th, table.t_group thead tr td, table.t_group tbody tr th,     table.t_group tbody tr td, table.t_group tfoot tr th, table.t_group tfoot tr td
{
    border: #333 1px solid;
} 
```

为了对 t_data 进行自定义以使 t_data_customer 和/或 t_data_order 看起来不同，我需要将该块 TRIPPLE ......并且遗漏一些元素的风险很高......我也有超过 10 个这样的块用于不同的元素（比如背景、字体等）

**对于这样的事情，是否有任何 css*甚至非 css解决方案？***

非常感谢你！

PS如果您没有任何解决方案而只有想法，请不要害羞地分享它们！欢迎任何想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:27:23.733

为您的表格和目标添加新的通用 CSS 类怎么样？

```
.common td
.common th {
} 
```

在向表格添加类之前，您应该确保表格的默认样式不够，例如

```
td {
    /* Sensible default for all table cells */
} 
```

下一步是为具有替代样式的表找到一个“通用”的类名。流行的框架 twitter bootstrap 使用“table-bordered”作为带边框的表格，其他人认为最好找到一个语义公分母。但这取决于你。

这与语义无关，但自从看到 Nicole Sullivan 的演示文稿后，我找不到演示文稿，但我可以从中找到引用： [http ://css-tricks.com/semantic-class-names /](http://css-tricks.com/semantic-class-names/)

> 在我最近在 CSS 峰会上看到的 Nicole Sullivan 的演讲中，她点名一些大公司在 CSS 文件中声明完全相同的颜色数千次。

我一直在尝试为我们在 css 文件中编写的内容寻找意义，并以大的共同点为目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:28:00.070

可悲的是，你不能用 CSS 做到这一点。幸运的是，您可以使用 CSS 预编译器为您执行此操作（例如：[LESS](http://lesscss.org/)和[Sass](http://sass-lang.com/)）。更准确地说，您可以使用**Mixins**（两种语言都支持）。

> Mixins 允许您通过简单地将类名作为其属性之一将类的所有属性嵌入到另一个类中。它就像变量一样，但适用于整个类。Mixin 也可以像函数一样工作，并接受参数，如下面的示例所示。

```
.rounded-corners (@radius: 5px) {
  -webkit-border-radius: @radius;
  -moz-border-radius: @radius;
  -ms-border-radius: @radius;
  -o-border-radius: @radius;
  border-radius: @radius;
}

#header {
  .rounded-corners;
}
#footer {
  .rounded-corners(10px);
} 
```

（来自 LESS 的示例）。这是你可以在`t_data`课堂上做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:30:35.730

您可以使用 ID 和类，而不是定义许多类。

使用 ID 定义主要的 CSS，使用类定义差异。

```
<table id="mainstyle" class="variation1"> ... 
```

# mysql - 如何在 SQL 中更新以获得不同的元组/不违反唯一约束

> ID：15043316
> 
> 赞同：0
> 
> 时间：2013-02-23T17:20:52.277
> 
> 标签：mysql, merge, sql-update, duplicates, unique-constraint

我有一个对 tuple 具有唯一约束的映射表`(c_id, t_id)`。

以下是一些示例数据来说明情况：

```
id  c_id    t_id  
----------------
1   10      2
2   10      3
3   10      7
4   12      2
5   13      3 
```

`t_ids`我为(x,y -> z OR x,y -> x)编写了一个合并函数。如果我的内容 ( `c_id`) 两者都有`t_ids`，那么我当然违反了使用以下语句的约束：

```
UPDATE mapping_table
SET t_id = '$target_tid'
WHERE t_id = '$t1_id' OR t_id = '$t2_id'; 
```

结果将是：

```
id  c_id    t_id
----------------
1   10      4
2   10      4       /* violates unique constraint */
3   10      7 
```

现在我想出了这个：

```
/* delete one of the duplicate entries */
DELETE FROM mapping_table
WHERE   ( SELECT count(c_id)
          FROM mapping_table
          WHERE t_id = '$t1_id' OR t_id = '$t2_id'
        ) > 1;

/* update the remaining row */
UPDATE mapping_table
SET t_id = '$target_tid'
WHERE t_id = '$t1_id' OR t_id = '$t2_id'; 
```

现在我收到以下错误：
`You can't specify target table 'mapping_table' for update in FROM clause`

我的问题是：

1.  这里到底出了什么问题？该`DELETE`语句是否被视为更新并且不能在`WHERE`子句中使用？
2.  这有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:37:19.473

您遇到的错误是 MySQL 的一个特性。您可以使用一组双重子查询来解决此问题：

```
DELETE FROM mapping_table
WHERE  (select *
        from ( SELECT count(c_id)
               FROM mapping_table
               WHERE t_id = '$t1_id' OR t_id = '$t2_id'
             ) > 1
        ) t 
```

但是，要解决您的问题，只需删除除最小值之外的所有 id。我认为这也可能有效：

```
delete from mapping_table
where id > (select minid from (select min(id) from mapping_table mt2
                               where mt2.c_id = mapping_table.c_id and
                                     mt2.t_id = mapping_table.t_id
                              )
           ) 
```

您还可以将 id 列表存储在临时表中，并在查询中使用它：

```
create temporary table minids as
     select c_id, t_id, min(id) as minid
     from mapping_table
     group by c_id, t_id;

delete from mapping_table
where exists (select 1 from minids
              where mt2.c_id = mapping_table.c_id and
                    mt2.t_id = mapping_table.t_id and
                    mt2.minid > mapping_table.id
             ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:26:29.113

试试这个

```
DELETE FROM mapping_table
    WHERE   ( SELECT count(c_id)
      FROM mapping_table
      WHERE t_id = '$t1_id' OR t_id = '$t2_id'
      Having count(c_id) > 1
    ); 
```

编辑：

在你的更新声明中试试这个

```
 UPDATE mapping_table
 SET t_id = '$target_tid'
WHERE t_id in (select t_id from mapping_table where t_id= '$t1_id' OR t_id = '$t2_id') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T21:40:26.070

我一直在寻找这个解决方案。性能可能低得惊人，但至少我找到了一个可行的解决方案（并学到了一些东西）。

```
/* actually delete rows that will become duplicate after the update */
DELETE FROM mt1 USING mapping_table AS mt1 WHERE id IN (

    /* sub-query to allow `mapping_table` in the DELETE statement */
    SELECT * FROM (

        /* select ids/rows with one t_id available */
        SELECT id
        FROM mapping_table AS mt2
        WHERE mt2.tag_id = $t1_id AND c_id IN (

            /* select ids/rows with both t_id available */
            SELECT c_id
            FROM mapping_table AS mt3
            WHERE mt3.c_id = mt2.c_id AND mt3.tag_id = $t2_id)

    /* alias needed for every derived table */
    ) as mres
)

/* Update to merge t_ids */
UPDATE mapping_table
SET t_id = '$target_id'
WHERE t_id = '$t1_id' OR t_id = '$t2_id'; 
```

# c - 桌面使用 glfw 和 vsync 感觉迟缓

> ID：15043324
> 
> 赞同：1
> 
> 时间：2013-02-23T17:21:31.473
> 
> 标签：c, linux, opengl, ubuntu, glfw

我在使用 OpenGl / glfw 时遇到了一个奇怪的 vsync 问题：当我启用 vsync 时，我的整个桌面感觉很慢：我可以移动我的窗口，但速度很慢，我可以使用我的浏览器，但一切都感觉很慢。

当我关闭 vsync 时，我的桌面感觉很好：我可以拖动窗口，移动其他窗口，在我的应用程序运行时使用其他程序，一切正常。

这是在 Ubuntu 12.10 桌面上，使用默认的 Unity。我有一个 NVidia GPU，并且正在使用他们的专有驱动程序。

这是我正在使用的示例代码，它非常基本（它甚至没有绘制任何东西）：

```
#include <stdio.h>
#include <GL/glew.h>
#include <GL/glfw.h>

int main() {
    glewExperimental = GL_TRUE;
    glewInit();

    glfwInit();
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
    glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);
    glfwOpenWindowHint(GLFW_WINDOW_NO_RESIZE, GL_TRUE);
    glfwOpenWindow(800, 600, 0, 0, 0, 0 ,0, 0, GLFW_WINDOW);

    unsigned int framecounter = 0;
    double start = glfwGetTime();

    glfwSwapInterval(1); //0 to disable vsync, 1 to enable it

    while (glfwGetWindowParam(GLFW_OPENED)) {
        glfwSwapBuffers();
        framecounter++;

        double now = glfwGetTime();
        if (now - start > 1) {
            float fps = framecounter / (now - start);
            printf("FPS: %f\n", fps);

            framecounter = 0;
            start = glfwGetTime();
        }
    }

    glfwTerminate();
} 
```

编译：

```
cc `pkg-config --cflags glew gl libglfw` -g -Wall -O3 -std=gnu99    helloworld.c  `pkg-config --libs glew gl libglfw`  -o helloworld 
```

设置为 1 我的桌面感觉迟钝，`glfwSwapInterval`设置为 0 则一切正常。

有谁知道是什么导致了这个问题，因为我想打开 vsync？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T22:21:58.400

这不是我的代码的问题，而是我计算机上的 vsync 的问题。我尝试了其他游戏，看看打开垂直同步是否会导致同样的问题，它也会导致速度变慢。

# python - 在python中获取2个字符之间的字符串

> ID：15043326
> 
> 赞同：14
> 
> 时间：2013-02-23T17:21:49.733
> 
> 标签：python, string, function, character, extraction

我需要将某些单词从字符串中提取为新格式。例如，我使用输入调用函数：

```
text2function('$sin (x)$ is an function of x') 
```

我需要将它们放入 StringFunction：

```
StringFunction(function, independent_variables=[vari]) 
```

我只需要为函数获取“sin (x)”，为 vari 获取“x”。所以它最终看起来像这样：

```
StringFunction('sin (x)', independent_variables=['x'] 
```

问题是，我似乎无法获得函数和变量。我努力了：

```
start = string.index(start_marker) + len(start_marker)
end = string.index(end_marker, start)
return string[start:end] 
```

和

```
r = re.compile('$()$')
m = r.search(string)
if m:
     lyrics = m.group(1) 
```

和

```
send = re.findall('$([^"]*)$',string) 
```

一切似乎都没有给我任何东西。难道我做错了什么？感谢所有帮助。谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-05-30T11:40:17.337

Tweeky方式！

```
>>> char1 = '('
>>> char2 = ')'
>>> mystr = "mystring(123234sample)"
>>> print mystr[mystr.find(char1)+1 : mystr.find(char2)]
123234sample 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-23T17:28:06.840

`$`是正则表达式中的一个特殊字符（它表示字符串的结尾）。你需要逃避它：

```
>>> re.findall(r'\$(.*?)\$', '$sin (x)$ is an function of x')
['sin (x)'] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-12-21T23:17:50.097

如果您想在两个相同字符之间剪切一个字符串（即！234567890！），您可以使用

```
 line_word = line.split('!')
   print (line_word[1]) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-23T17:29:40.663

您需要开始搜索*超出* `start`的第二个字符：

```
end = string.index(end_marker, start + 1) 
```

因为否则它将再次在同一位置找到相同的字符：

```
>>> start_marker = end_marker = '$'
>>> string = '$sin (x)$ is an function of x'
>>> start = string.index(start_marker) + len(start_marker)
>>> end = string.index(end_marker, start + 1)
>>> string[start:end]
'sin (x)' 
```

对于您的正则表达式，该`$`字符被解释为锚点，而不是文字字符。将其转义以匹配文字`$`（并查找*not* `$`而不是 not的东西`"`：

```
send = re.findall('\$([^$]*)\$', string) 
```

这使：

```
>>> import re
>>> re.findall('\$([^$]*)\$', string)
['sin (x)'] 
```

`$()$`否则，即使您确实对`$`字符进行了转义，正则表达式也不会真正匹配括号之间的任何内容。

# c# - 在 asp.net 中写入数据库

> ID：15043332
> 
> 赞同：0
> 
> 时间：2013-02-23T17:21:57.397
> 
> 标签：c#, asp.net

我目前正在完成一个课程的 asp.net 项目，并开始注意到其中一个必要条件的主要缺陷。应用程序应提出五个问题并将答案写入数据库，然后将调查结果显示给用户。

这是我到目前为止所尝试的：

```
 public static string GetConnectionString()
    {
        string connStr = String.Format("server={0}; user id={1}; password={2};" + "database= -table to be accessed-; pooling=false", 
            "-database server-", "-user-", "-password-");
        return connStr;
    } 

 protected void Button1_Click(object sender, EventArgs e)
    {

        if (Page.IsValid)
        {
            string sex = gender.Text;
            string likes = interests.Text;
            string edu = education.Text;
            string nation = nationality.Text;
            string userage = age.Text;

            MySql.Data.MySqlClient.MySqlConnection mycon;

            mycon = new MySqlConnection(GetConnectionString());

            try
            {
                MySqlCommand cmd = new MySqlCommand("INSERT INTO survey (gender, age, birthplace, occupation, winner) VALUES ('" + sex  + ", " + likes + ", " + edu + ", " + userage + "')", mycon);
                cmd.ExecuteNonQuery();
                mycon.Open();
            }

            catch (Exception ex)
            {
                Response.Write(ex.Message);
            }

            finally
            {
                mycon.Close();
            }

        }
    } 
```

我继续用占位符替换了数据库信息。

数据库是 MySql 并托管在外部服务器上。

我遇到的问题是代码可以编译，但是信息没有写入数据库。我不确定这是否是因为我仍在测试代码并且尚未将 Web 应用程序上传到服务器，或者它只是错误的事实。

就显示结果而言，如果上面的代码是正确的，那只是更改 sql 查询的问题，对吗？

提前感谢您的洞察力。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T18:48:36.100

您在打开数据库连接之前执行命令。

`ExecuteNonQuery()`方法和所有其他 Execute 方法都需要打开的数据库连接。

另一个错误是：
列数（即 5）和提供的值（即 4）不相等。

正如[Steve Wellens](https://stackoverflow.com/users/479869/steve-wellens)所说，您的代码中还有[一个问题](https://stackoverflow.com/questions/15043332/writing-to-a-database-in-asp-net/15043437#15043437)。

更改您的代码，如下所示：

```
try
{
    MySqlCommand cmd = new MySqlCommand("INSERT INTO survey (gender, age, birthplace, occupation, winner) VALUES ('" + sex  + ", " + likes + ", " + edu + ", " + userage + "')", mycon);
    mycon.Open();
    cmd.ExecuteNonQuery();
}    
catch (Exception ex)
{
    Response.Write(ex.Message);
}    
finally
{
    mycon.Close();
} 
```

* * *

# 安全说明：

切勿`data`使用运算符添加到查询中`+`。它可能会导致[SQL 注入](http://en.wikipedia.org/wiki/SQL_Injection)。

如果用户输入`1); DROP TABLE <table-name> --`..怎么办`Age` `TextBox`？？
任何人都可以从数据库中完全删除任何表。

使用[MySQL Parameter](http://dev.mysql.com/doc/refman/5.0/es/connector-net-examples-mysqlparameter.html)来避免此类问题。它可以防止对整个数据库造成严重损害。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:30:56.980

在您的连接字符串中：

```
"database= -table to be accessed-; 
```

...你不放桌子。该表在 SQL 语句中指定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T18:02:17.357

您应该先打开连接，然后执行查询。

```
 try
                {
                    MySqlCommand cmd = new MySqlCommand("INSERT INTO survey (gender, age, birthplace, occupation, winner) VALUES ('" + sex  + ", " + likes + ", " + edu + ", " + userage + "')", mycon);
                    mycon.Open();
                    cmd.ExecuteNonQuery(); 
                } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T18:49:08.277

这可能不是唯一的问题，但它是*一个*问题：

```
"INSERT INTO survey (gender, age, birthplace, occupation, winner) " + 
"VALUES ('" + sex  + ", " + likes + ", " + edu + ", " + userage + "')", 
```

（我把它分成两个字符串，以便于阅读。）

您正在插入五列。您只指定了四个数据值，除了性别之外，它们的顺序似乎不正确，甚至不是正确的数据。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-23T17:35:46.953

尝试检查这些事情：

1.  在执行 SQL 之前尝试打开连接

2.  检查您的 SQL，并尝试直接对数据库执行它们。我在您的 SQL 中看到的是您将值连接成一个字符串（引号仅存在于开头和结尾，但不存在于传递的参数之间）

# mobile - 自动重定向到移动网站

> ID：15043335
> 
> 赞同：0
> 
> 时间：2013-02-23T17:22:01.510
> 
> 标签：mobile, web

我希望当移动设备（例如 Android 手机；平板电脑、iPad、iPhone、iPod 或任何其他移动设备）重定向到移动站点而不是实际站点时，但我不知道该怎么做。

在我的情况下，我的主站点的 URL 是 super-short.freeoda.com，移动 url 是[http://mobile.dudamobile.com/site/super-short_freeoda_2/](http://mobile.dudamobile.com/site/super-short_freeoda_2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:47:42.053

如果您想让它保持快速和肮脏，您可能需要查看[PHP Mobile Detect](https://code.google.com/p/php-mobile-detect/)以获得简单的移动重定向。它基于用户代理字符串上精心设计的正则表达式对移动设备、平板电脑和主要平台（iOS、Android、BB 等）进行了一些基本分类。

更进一步，您可以尝试[WURFL](http://wurfl.sourceforge.net/)或[Device Atlas](https://deviceatlas.com/)等设备数据库，但它们的重量更大。

为了认真起见，请确保包含返回“完整”或“桌面”站点的清晰链接，以解决可能的错误检测。

# vb.net - 如何确定在矩形中绘制的文本的大小

> ID：15043338
> 
> 赞同：3
> 
> 时间：2013-02-23T17:22:14.413
> 
> 标签：vb.net

我在打印页面上输出文本并使用 drawstring 在矩形中绘制文本，以便使用如下调用自动换行：

```
 ev.Graphics.DrawString(textToOutput, printFont, myBrush, New RectangleF(leftMargin, yPosition, pagewidth - leftMargin - rightmargin, 400)) 
```

这工作正常。我试图确定的是在drawscreen调用之后的Y位置（换句话说，文本被包裹在矩形中后的高度是多少）。我正在尝试从数据库中打印可变长度的字符串，它们经常会超过页面宽度。我需要知道下一段的垂直起点在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:30:23.323

您可以使用[Graphics.MeasureString](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.measurestring.aspx)和[它的这种重载](http://msdn.microsoft.com/en-us/library/9bt8ty58.aspx)。来自 MSDN 的部分示例：

```
Dim stringSize As New SizeF
stringSize = e.Graphics.MeasureString(measureString, stringFont, stringWidth) 
```

您计算的高度将存储在[SizeF.Height](http://msdn.microsoft.com/en-us/library/system.drawing.sizef.height%28v=vs.90%29.aspx)中。

# c++ - 无法访问类的成员；段错误

> ID：15043340
> 
> 赞同：0
> 
> 时间：2013-02-23T17:22:30.057
> 
> 标签：c++, class, segmentation-fault

我有一个程序，我正在设置一个封闭的哈希表。在哈希表的每个元素中，都有一个 Student 类，其中包含不同的成员（姓名、ID、年份等）。我只是想打印出添加到我的阵列中的内容，但我不断收到 SegFault，我不知道为什么。不过，它仅在我的打印功能中。我已将代码行复制到我的其他函数或将它们放在不同的类中，它们在那里工作，但当我尝试从我的打印函数打印时却不行。我已经走到了尽头，试图弄清楚为什么我可以访问每个成员的内存位置，但不是它的实际值。

这是我的程序：

主.cpp：

```
using namespace std;
#include <cstdlib>
#include "hash.h"

int main()
{
string temp1;
string temp2;
string temp3;
string temp4;
string temp5;
string temp6;

Hash h;

do{
cout << "set> ";
cin >> temp1;

//Checking for quit command.

if(temp1.compare("quit") == 0)
{
    return 0;
}
 //checking for add command.
else if(temp1.compare("add") == 0)
{
    cin >> temp2;
    cin >> temp3;
    cin >> temp4;
    cin >> temp5;
    cin >> temp6;
    Student *s1 = new Student(temp2, temp3, temp4, temp5, temp6);
    Element e1(s1);
    h.add(e1);
}
//checking for remove command.
else if(temp1.compare("remove") == 0)
{
    int r;
    cin >> r;
    h.remove(r);
}
//checking for print command.
else if(temp1.compare("print") == 0)
{
    h.print();
}
//Anything else must be an error.
else
{
    cout << endl;
    cout << "Error! "<< endl;
}
}while(temp1.compare("quit") != 0);
} 
```

哈希.h：

```
#include <string>
#include <iostream>
#include <cstdlib>

using namespace std;

// Student Class
class Student{
private:
    string firstName;
    string lastName;
    string id;
    string year;
    string major;

public:

//Constructor
    Student(string a, string b, string c, string d, string e);
friend class Element;
friend class Hash;
};

//Element class
class Element{
    private:
            Student *data;
    public:
            int getKey();
    Student* getData();
    void printStudent();

//Constructor
           Element(Student *e)
    {
        data = e;
    };
friend class Hash;
};

class Hash{
private:
    Element **array;
public:
    void add(Element);
    void print();
    void remove(int);

//Constructor
    Hash()
    {
        array = new Element *[10];
    };
friend class Student;
}; 
```

哈希.cpp：

```
#include "hash.h"

//The Constructor for Student
 Student::Student(string a, string b, string c, string d, string e)
{
firstName = a;
lastName = b;
id = c;
year = d;
major = e;

}

//getKey function for Element Class

int Element::getKey()
{
int key = atoi(getData()->id.c_str());
return key;
}

Student* Element::getData()
{
return data;
}

void Element::printStudent()
{
string c = data->firstName;
cout<< "(" << c << ")";
}

//The add command
void Hash::add(Element e1)
{
int x = e1.getKey()%10;
int i = 0;

if(array[x] == NULL || array[x]->getData() == NULL)
{
    array[x] = &e1;

}

else
{while(array[x] != NULL || array[x]->getData() != NULL)
{
    x=(x+(i*i))%10;
    if(array[x] == NULL || array[x]->getData() == NULL)
    {
        array[x] = &e1;
        break;
    }
    else
    {
        i++;
    }
}}

}

//The remove command
void Hash::remove(int n)
{
Element e2(NULL);
for(int j = 0; j<10; j++)
{
    if(n == array[j]->getKey())
    {
        array[j] = &e2;
        cout << "true" << endl;
        break;
    }
}
cout << "false" << endl;
}
//The Print command
void Hash::print()
{   int k = 0;
while(k<10)
{
    if(array[k] == NULL)
    {
        cout << "(NULL)";
    }
    else if(array[k]->getData() == NULL)
    {
        cout << "(DEL)";
    }
    else
    {
        cout << "(" << array[k]->getData()->firstName << ")";
    }
k++;
}
cout << endl;
} 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:34:54.410

你有[悬空指针](http://en.wikipedia.org/wiki/Dangling_pointer)。

此函数获取 的临时副本`Element`，并调用它`e1`。

```
//The add command
void Hash::add(Element e1)
{ 
```

然后它存储这个[局部变量](http://en.wikipedia.org/wiki/Local_variable)的地址。

```
 array[x] = &e1; 
```

而当`Hash::add`离开范围时，`e1`就不再存在了。

```
} 
```

`array[x]`现在指向记忆的那个不再`Element e1`。

您面临的一般问题是您设计了一个`Hash`维护指向对象的指针的类，但对这些对象何时被销毁几乎没有控制或知识。

您需要亲自确保添加到您的对象`Hash`至少与添加的对象一样长`Hash`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:42:33.413

解决您的问题的最简单方法可能是按值而不是指针将 Element 实例存储在 Hash 中。所以：

```
class Hash{
private:
    Element *array;
public:
    void add(Element);
    void print();
    void remove(int);

//Constructor
    Hash()
    {
        array = new Element[10];
    };
friend class Student;
}; 
```

现在，当您存储新元素或删除现有元素时，您可以复制它们：

```
array[x] = e1; // not &e1 anymore 
```

这不是很好的做法，但至少可以通过最小的更改将您的程序更改为某种可行的状态。

# jsf - 动态分配属性id 在jsf中

> ID：15043341
> 
> 赞同：1
> 
> 时间：2013-02-23T17:22:33.637
> 
> 标签：jsf, primefaces, liferay, primefaces-extensions

我已经动态创建了选项卡，我正在尝试为其分配不起作用的属性 id .....或任何其他方式来获取单击的选项卡的标题？

```
<p:accordionPanel value="#{displayassestDto.getgroups()}" var="d">
    <p:ajax event="tabChange" listener="#{displayassestDto.onTabChange}" update=":form:growl"/>
       <p:tab title="#{d.group}" id="tab_#{d.group}">
           <h:outputLabel value="Helllooo" />
            </p:tab>
</p:accordionPanel> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-23T17:51:07.323

> 任何其他方式来获得点击标签的标题？

是的，`onTabChange`可以修改为接受类型的对象`TabChangeEvent`。在此对象上，您可以检索触发事件的选项卡。你的代码看起来像

```
 public void onTabChange(TabChangeEvent evt){
            evt.getTab(); // on this tab object returned, you can get the id, title etc
        } 
```

至于为什么您的代码现在不起作用，可能是因为在`getGroups()`整个请求处理过程中输出的状态不一致。确保您没有在`getGroups()`. 但你真的不需要这样做。

# javascript - 在 Web 客户端和服务器之间交换压缩数据

> ID：15043348
> 
> 赞同：0
> 
> 时间：2013-02-23T17:23:18.010
> 
> 标签：javascript, jquery, jsp, spring-mvc, spring-security

在客户端我使用 jQuery 和 JSP，服务器端我使用 Spring MVC。我的问题是我们能否以压缩格式发送和接收数据，即客户端和服务器将以压缩格式交换其数据。我怎样才能做到这一点？请任何人简要解释一下。一个例子太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:42:21.983

您可以尝试对从服务器发送的响应进行 GZIP 压缩。此[链接](https://stackoverflow.com/questions/4827004/jsp-gzip-output-stream)可能会有所帮助。

旁注：AFAIK，JSP 是服务器端，而不是客户端

# c# - Windows 8 Metro 应用程序进行设置弹出

> ID：15043352
> 
> 赞同：3
> 
> 时间：2013-02-23T17:23:28.247
> 
> 标签：c#, xaml

我正在制作一个游戏，我希望用户能够从右侧滑动并从 Windows 8 的魅力栏中打开设置。
我尝试了很多东西，但我没有设法让它工作。如果有人做过，请告诉我你是怎么做到的。我正在使用 Visual Studio 2012 Express。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T17:30:38.413

更新：

从 Windows 8.1 及更高版本开始，已将 SettingsFlyout 控件添加到 Windows Store App 的控件集合中。

添加 => 新建 => SettingsFlyout

![在此处输入图像描述](../Images/181d8ab4fdb56bcafef4dbe21ebd9757.png)

然后像这样添加它：

```
sealed partial class App
{

    public App()
    {
        this.InitializeComponent();
        this.Suspending += OnSuspending;
    }

    protected override void OnWindowCreated(WindowCreatedEventArgs args)
    {
        SettingsPane.GetForCurrentView().CommandsRequested += OnCommandsRequested;
    }

    private void OnCommandsRequested(SettingsPane sender, SettingsPaneCommandsRequestedEventArgs args)
    {
        var setting = new SettingsCommand("MySetting", "MySetting", handler =>
            new MySettingsFlyout().Show());
        args.Request.ApplicationCommands.Add(setting);
    } 
```

结果：

![在此处输入图像描述](../Images/ee10c12ee7a3c2e847d37870d8e342be.png) ![在此处输入图像描述](../Images/d4288bd853cfcf64cc1934b3dd41bb7d.png) **旧的做法：**

这是在 Windows 8 中使用 xaml 和 c# 的方法

1.创建一个xaml用户控件

```
 <UserControl
    x:Class="CSharp_Settings.Settings.Help_Settings"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="646">
    <Border BorderBrush="#FF590151" BorderThickness="1">
        <Grid Background="White" VerticalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="80"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid Background="#FFFF00F2" Grid.Row="0">
                <Grid Margin="40,20,17,13">
                    <Grid.Transitions>
                        <TransitionCollection>
                            <EntranceThemeTransition FromHorizontalOffset="50" />
                        </TransitionCollection>
                    </Grid.Transitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="50" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Button Click="Button_Click_1" Margin="0,3,0,0" Grid.Column="0"

HorizontalAlignment="Left" Style="{StaticResource BackButtonStyle}"/>
                    <TextBlock Margin="10,5,0,0" Grid.Column="1" FontFamily="Segoe UI"

FontWeight="SemiLight" FontSize="24.6667" Text="Help" HorizontalAlignment="Left" />
                    <Image Source="/Assets/icon.png" HorizontalAlignment="Right" Grid.Column="2"

Margin="0,0,6,0" />
                </Grid>
            </Grid>
            <Grid Grid.Row="1" Margin="40,24,23,0" VerticalAlignment="Top">
                <Grid.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromHorizontalOffset="120" />
                    </TransitionCollection>
                </Grid.Transitions>
                <TextBlock Text="Something" Foreground="Black"/>
            </Grid>
        </Grid>
    </Border>
</UserControl> 
```

用户控制的代码隐藏

```
using Windows.UI.ApplicationSettings;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls.Primitives;
namespace CSharp_Settings.Settings
{
    public sealed partial class Help_Settings 
    {
        public Help_Settings()
        {
            InitializeComponent();
        }

        private void Button_Click_1(object sender, RoutedEventArgs e)
        {
            if (Parent is Popup)
                ((Popup)Parent).IsOpen = false;
            SettingsPane.Show();
        }
    }
} 
```

在应用程序中注册设置窗格

```
using CSharp_Settings.Settings;
using Windows.Foundation;
using Windows.UI.ApplicationSettings;
using Windows.UI.Core;
using Windows.UI.Popups;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Controls.Primitives;

namespace CSharp_Settings
{
    public sealed partial class MainPage
    {
        public MainPage()
        {
            InitializeComponent();
            _window = Window.Current.Bounds;
            Window.Current.SizeChanged += OnWindowSizeChanged;
            SettingsPane.GetForCurrentView().CommandsRequested += CommandsRequested;
        }

        private Rect _window;
        private Popup _popUp;
        private const double WIDTH = 646;

        private void OnWindowSizeChanged(object sender, WindowSizeChangedEventArgs e)
        {
            _window = Window.Current.Bounds;
        }

        private void CommandsRequested(SettingsPane sender, SettingsPaneCommandsRequestedEventArgs args)
        {
            args.Request.ApplicationCommands.Add(new SettingsCommand("help", "Help", Handler));
        }

        private void Handler(IUICommand command)
        {
            _popUp = new Popup
                         {
                             Width = WIDTH,
                             Height = _window.Height,
                             IsLightDismissEnabled = true,
                             IsOpen = true
                         };
            _popUp.Closed += OnPopupClosed;
            Window.Current.Activated += OnWindowActivated;
            _popUp.Child = new Help_Settings {Width = WIDTH, Height = _window.Height};
            _popUp.SetValue(Canvas.LeftProperty, SettingsPane.Edge == SettingsEdgeLocation.Right ? (_window.Width - WIDTH) : 0);
            _popUp.SetValue(Canvas.TopProperty, 0);
        }

        private void OnWindowActivated(object sender, WindowActivatedEventArgs e)
        {
            if (e.WindowActivationState == CoreWindowActivationState.Deactivated)
                _popUp.IsOpen = false;
        }

        private void OnPopupClosed(object sender, object e)
        {
            Window.Current.Activated -= OnWindowActivated;
        }
    }
} 
```

在 Javascript 和 html 中，您确实在 html 中创建：

```
<!doctype HTML>
<html>
<body>
    <div style="border: 1px solid #AB00A5" data-win-control="WinJS.UI.SettingsFlyout" data-win-options="{settingsCommandId:'help', width:'narrow'}">
        <div class="win-ui-dark win-header" style="background-color:#FF00F7">
            <button type="button" onclick="WinJS.UI.SettingsFlyout.show()" class="win-backbutton"></button> 
            <div class="win-label"> Help</div>
            <img src="../images/icon.png" style="position: absolute; right: 40px; width:35px; height:35px"/>
        </div>
        <div class="win-content win-settings-section">
            <h3>Help!</h3>
            <p> No help for you muahahaha</p>
        </div>
    </div>
</body>
</html>

Function to register the settings pane:

    (function () {
    "use strict";
    WinJS.Application.onsettings = function (e) {
        e.detail.applicationcommands = {
            "about": {
                title: "About",
                href: "/html/settings_about.html"
            },
            "help": {
                title: "Help",
                href: "/html/settings_help.html"
            }
        };
        WinJS.UI.SettingsFlyout.populateSettings(e);
    };

    WinJS.Application.start();
})(); 
```

请记住以下几点：

*   使用单字标签作为入口点
    *   建议最多 4 个入口点
    *   窄 = 346 像素
    *   宽 = 646 像素。
    *   高度与屏幕相同。
    *   标题：后退按钮+入口点名称+应用程序图标，背景颜色与应用程序磁贴相同
    *   设置面板边框颜色应比标题颜色深 20%，背景应为白色。
    *   滚动OK但最大两倍高度
    *   没有用于导航、命令或提交更改的按钮
    *   如果单击入口点，则无直接操作权限命令受系统控制
    *   应该是带有入口动画的弹出窗口
    *   轻微可关闭 应与设置在同一侧（使用 SettingsEdgeLocation 属性）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T02:04:14.763

最好的方法可能是使用 Callisto 的帮助程序类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:36:45.200

这是您需要的 SettingsPane 类

[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.applicationsettings.settingspane.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.applicationsettings.settingspane.aspx)

# backbone.js - 带有嵌套选项卡的 Backbone.js 视图

> ID：15043354
> 
> 赞同：1
> 
> 时间：2013-02-23T17:23:44.270
> 
> 标签：backbone.js, backbone-views, backbone-routing

我编写了一个由嵌套选项卡组成的应用程序。我以[https://github.com/tbranyen/backbone-boilerplate](https://github.com/tbranyen/backbone-boilerplate)为例。我也使用 RequireJS。

我至少有两个级别的嵌套选项卡。其中一些具有相似的结构，我可以重用他们的观点。

例如，我有一个名为“文章”的选项卡，其中包含以下选项卡：“新建”、“已更改”、“已删除”（实际上选项卡的数量要多得多）。我有以下路线：

```
/articles
/articles/new
/articles/changed/
/articles/deleted 
```

这些路由映射到名为“showPanel”的方法，该方法接受两个参数：panel 和 subPanel。使用这些参数，我想显示所需的面板。

是否有任何模式可用于解决此问题或任何其他示例？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T09:11:43.890

看看[这个](http://jsbin.com/iribul/14/edit)，希望能帮到你：）

showPanel 方法是通用方法，show panel 和 subPanel：

```
function showPanel(panel, subPanel){
  $('#panels').children().hide().filter(panel).show().children().hide().filter(subPanel).show();
} 
```

路线配置：

```
var Router = Backbone.Router.extend({
  routes: {
    'articles': 'articlesPanel',
    'articles/:subPanel': 'articlesSubPanel'
  },
  articlesPanel: function(){
    showPanel('#articles', '');
  },
  articlesSubPanel: function(subPanel){
    showPanel('#articles', '#'+subPanel);
  }

}); 
```

# c# - 为我的班级实现 IEnumerable 接口

> ID：15043358
> 
> 赞同：1
> 
> 时间：2013-02-23T17:24:11.083
> 
> 标签：c#, ienumerable

我有这个类，其中我想实现 IEnumerable 以便能够使用 foreach()。这是我的代码，我认为我做的不正确

```
public class SearchResult : IEnumerable<SearchResult>
{

    string Name { get; set; }
    int Rating { get; set; }

    public IEnumerator<SearchResult> GetEnumerator()
    {
        return( this );
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T17:28:38.667

你可以这样做：

```
public IEnumerator<SearchResult> GetEnumerator()
{
    yield return this;
} 
```

然而，像这样的对象`IEnumerable<T>`以单元素序列实现并返回自身是不寻常的。

您可能想要创建一个实用程序方法：

```
public static IEnumerable<T> ToSequence<T>(T instance)
{
    reutrn new[] { instance };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:29:39.210

如果你真的发誓你需要这样做：

```
SearchResult justOne = ... blah ...;
foreach (SearchResult eachOne in justOne) {
   ... blah ...
} 
```

然后你可以对你的方法做这个小的修改（使用yield return而不是return）：

```
public IEnumerator<SearchResult> GetEnumerator()
{
    yield return( this );
} 
```

# sql-server - 如何从一系列数字中获取随机值？

> ID：15043362
> 
> 赞同：0
> 
> 时间：2013-02-23T17:24:23.687
> 
> 标签：sql-server, sql-server-2008, tsql

首先，我在发布之前看到了[这个问题](https://stackoverflow.com/questions/5960549/how-do-i-get-a-random-value-from-a-range-in-ms-sql)，我的不是重复的，我们的问题在标题旁边是不同的。

我对 SQLSERVER/T-SQL 没有太多了解，所以当我从 ORACLE/PLSQL “翻译”一些脚本时，我没有找到任何函数来生成 2 个值之间的随机数。

在我正在查看的 PLSQL 脚本中，我可以简单地使用`DBMS_RANDOM.VALUE(5, 10)`.

如何在 T-SQL 中做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:30:48.727

您将使用该`rand`函数，它为您提供值 0 <= n < 1。例如 5 到 10（含）之间的数字：

```
floor(rand() * (10 - 5 + 1)) + 5 
```

# android - Android AVD Mail 应用程序未发送附件

> ID：15043365
> 
> 赞同：0
> 
> 时间：2013-02-23T17:24:43.503
> 
> 标签：android, avd, email-attachments

我正在通过以下代码发送带有日志结果的邮件：

```
 Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND_MULTIPLE);
    emailIntent.setType("text/plain");
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, emailAddressList);
    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Android Log");
    emailIntent.putParcelableArrayListExtra(android.content.Intent.EXTRA_STREAM, uris);
    try {
        startActivity(Intent.createChooser(emailIntent,"Send..."));
        finish();
    }
    catch (android.content.ActivityNotFoundException e) {
        new AlertDialog.Builder(SendActivity.this)
        .setIconAttribute(android.R.attr.alertDialogIcon)
        .setTitle(R.string.cannotSend)
        .setMessage(R.string.appNotFound)
        .setPositiveButton(R.string.ok, null)
        .show();
    } 
```

模拟器中的电子邮件应用程序（trget Jelly Bean）是这个：

![在此处输入图像描述](../Images/c365805356c40aebd3788266ff0433ac.png)

发送时会显示此内容，其中包含目的地、主题和附件：

![在此处输入图像描述](../Images/3225c1667cc44fedf659b93b5d17f5e4.png)

oubox 显示邮件有附件：

![在此处输入图像描述](../Images/87da8e55e4cedd6e35234ed662796bc2.png)

但是收到的消息没有附件：

![在此处输入图像描述](../Images/7ab0ed536a5e9d3bdd23502f717547bb.png)

我唯一的猜测是电子邮件应用程序失败了，但我不知道这是否是我的错，我是否可以纠正它，或者我是否可以在 AVD 中安装另一个邮件客户端来完成这项工作。

PS：顺便说一句，在 AVD 上发送这些邮件真的很慢，当我测试撰写和发送纯文本邮件时，它的发送速度要快得多。

**编辑**
我有一个想法，可能是因为附件来自临时文件而导致问题吗？它们链接到邮件而不是复制，当电子邮件应用程序发送它们时，它们不再存在？

```
attachment = File.createTempFile("logs", "txt");
out = new FileOutputStream(attachment);
out.write(logs.getBytes());
out.close();
uris.add(Uri.fromFile(attachment));

attachment = File.createTempFile("sysinfo", "txt");
out = new FileOutputStream(attachment);
out.write(getSystemInfo());
out.close();
uris.add(Uri.fromFile(attachment)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T09:15:59.397

好吧，这绝对是模拟器问题。

我安装了英特尔的 HAXM 虚拟机并使用英特尔映像创建了一个新的 AVD，它不仅运行速度更快，而且它可以立即发送邮件和附件，没有问题。

**编辑**
我发现，在真实设备上测试时，这是一个真正的问题，[这篇文章非常有帮助](https://stackoverflow.com/questions/3570914/android-how-do-i-attach-a-temporary-generated-image-to-an-email)

# java - 在java中计算出一个数字除以另一个数字的次数并打印出来

> ID：15043370
> 
> 赞同：1
> 
> 时间：2013-02-23T17:25:17.297
> 
> 标签：java

我需要能够输入两个数字，将第一个除以第二个并输出它输入的次数以及余数是多少。

我可以打印出余数，但我如何计算出这个数字除以多少次？我的代码如下

```
import java.util.Scanner;

public class TotalAndRemainder
{

    public static void main(String[] args)
    {
        Scanner keyboard = new Scanner(System.in);

        System.out.println("Enter your first number");
        int firstvalue = keyboard.nextInt();

        System.out.println("Enter your second number");
        int secondvalue = keyboard.nextInt();

        int total = firstvalue / secondvalue;
        int remainder = firstvalue % secondvalue;

        System.out.println("The remainder is " + remainder);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:30:32.170

如果我正确理解你想要做什么，你已经有多少次`secondvalue`进入`firstvalue`，当你找到`total`。您只需要使用如下语句将其打印出来：

```
System.out.println(secondvalue + " goes into " + firstvalue + ", " + total + "times."); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:30:28.183

```
System.out.println(firstNumber + " goes into " + secondNumber + " " + total + " times. The remainder is " + remainder + "."); 
```

在 java`int\int=int`中，即您的`total`字段已经为您提供了整数次。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T17:38:20.890

```
import java.util.Scanner;

public class TotalAndRemainder
{

    public static void main(String[] args)
    {
        Scanner keyboard = new Scanner(System.in);

        System.out.println("Enter your first number");
        int firstvalue = keyboard.nextInt();

        System.out.println("Enter your second number");
        int secondvalue = keyboard.nextInt();
        if(firstvalue >= secondvalue)
        { 
           int total = firstvalue / secondvalue;
           int remainder = firstvalue % secondvalue;
        }
        else
        {
           int total = secondvalue / firstvalue;
           int remainder = secondvalue % firstvalue;
        }

        System.out.println("The total is " + total + "remainder is " + remainder);

    }
} 
```

我希望这对你有用...

# java - Java 中的客户端服务器 LAN Messenger

> ID：15043377
> 
> 赞同：0
> 
> 时间：2013-02-23T17:26:27.763
> 
> 标签：java, client-server, chat, file-transfer, lan

我正在使用客户端-服务器架构在 Java 中创建内部办公室消息系统。我想要实现的功能是：与特定用户或用户组的实时聊天和消息传递、文件传输和语音聊天。

我已经实现了服务器和客户端模块，客户端可以使用它们登录服务器。我已经使用`DataInputStream`和`DataOutputStream`为此。当用户提交用户名和密码时，我将它们存储在由分号“;”分隔的单个字符串中 然后我将这个字符串发送到服务器，使用`DataInputStream`我将它们分开并运行数据库查询并向客户端应用程序发送适当的确认。

现在我想实现聊天和消息传递。我的问题是，我应该为此使用相同的方法吗？还是有更好的解决方案？另外，我如何将消息发送给特定的客户端（客户端 A 只想向客户端 B 发送消息）。在提出解决方案时，请记住，我还必须实现语音聊天（gstreamer）作为文件传输！！！

另外，我维护了一个数组，其中包含登录到服务器的所有客户端的名称，该数组用于向每个客户端显示登录客户端的列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:38:05.807

首先，通过将用户名和密码作为纯文本字符串发送，您实际上是在自由地泄露它们 - 任何拥有一些基本工具的人都可以嗅探用户名和密码。您将需要阅读密码学以及如何保护连接。Java 有一个内置的密码库，这使得这很容易做到。

如果可能的话，我会推荐使用已经开发好的聊天协议，比如 XMPP (Jabber)，已经有很多免费的 Java 库实现，比如 Smack，可以为你做任何事情。真的没有必要在这里重新发明轮子，除非你是为一个不允许使用任何外部库的学校项目这样做的，这本身就是非常雄心勃勃的。XMPP 支持文本聊天、语音聊天和文件传输。

还有几个功能齐全的开源聊天客户端，您可以对其进行修改以满足您的特定需求。不过要记住的一件事是开源项目的许可。一些开源许可证，如流行的 GPL，要求在项目中使用开源项目的任何部分都需要您发布**整个**项目的源代码。这对公司来说可能是极其灾难性的，所以要小心。

如果您仍然想从头开始，那么您需要实现自己的通信*协议*。您必须自己设计，同时考虑如何合并 gstreamer 和文件传输。

同样，我建议至少查看一些已经设计好的协议，例如 XMPP，以获得一些想法。

通常，协议有，

*   一些数据解释了这是什么类型的请求/响应。这可以是存储为单个字节的数值，也可以是一些文本字符串，如在 HTTP 中所做的那样
*   更多关于消息的对象的数据。可以是 IP 地址、用户名、两者的组合等。如果您直接进行通信（即不通过中间人服务器）则不需要
*   发送请求的时间
*   数据本身
*   某种加密。最好在用户获得授权后启动

例如，一个非常基本的协议可能是，

```
请求类型：1 个字节。1 = 文本，2 = 语音数据，3 = 文件传输，4 = 请求当前登录的客户列表

目的地：int（IP地址）

时间：长。最好将此作为 UTC 时间发送，例如 System.currentTimeMillis 返回的内容

数据长度：int

数据：可变长度数据，取决于类型

```

然后，对于发送的每种类型的数据，您会以不同的方式实现数据，

```

文本：DataStream 发送的字符串

语音：来自 gstreamer 的语音数据（不确定 gstreamer 是如何工作的）

文件传输：

    文件名：DataStream 发送的字符串

    长度：长

    数据：从 FileInputStream 读取

当前登录的客户端列表：
    数据：由 DataStream.writeObject 发送

```

祝你好运

# list - Maps的Scala访问序列

> ID：15043382
> 
> 赞同：0
> 
> 时间：2013-02-23T17:26:56.103
> 
> 标签：list, scala, map, sequence

我有一个`IndexedSeq[Map[String, String]]`，我想提取键是“文本”的值，我想把它放在一个`val text:IndexedSeq[String]`. 我写了以下文章，但它不起作用：

```
val text:IndexedSeq[String] = _
for(j <- 0 to indSeq.length-1){
  text(j) = indSeq(j).get("text")
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:42:52.047

您可能会看到编译器错误，因为`indSeq(j).get("text")`返回的是`Option[String]`，而不是`String`.

如果您只想获取`"text"`序列中键的所有值，请使用：

```
val text = indSeq flatMap (_ get "text") 
```

如果两个序列的索引对齐很重要，那么您将需要替换默认值以防键`"text"`不存在：

```
val text = indSeq map (_.getOrElse("text", "default")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:57:38.587

由于您最初尝试使用 for-comprehension，因此您可能也有兴趣这样做：

```
val text = (for { m <- indSeq } yield m get "text") flatten 
```

编辑

或者如果你想要一个默认值，你可以这样做：

```
val text = for { m <- indSeq } yield m getOrElse("text", "default") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:03:29.963

我认为最好的方法是与警卫一起理解以摆脱没有`"text"`元素的地图：

```
val result = for {
  i <- 0 until indexSeq.length
  map = indexSeq(i)
  if map isDefinedAt ("text")
} yield { (i, map("text")) }

val seq = result.toIndexedSeq 
```

这样您就可以将原始索引与地图保持一致。它还避免持有任何`var`价值，这始终是一种特权

# iphone - 将省略号添加到 NSString

> ID：15043384
> 
> 赞同：6
> 
> 时间：2013-02-23T17:27:02.087
> 
> 标签：iphone, objective-c, ipad, nsstring

我有以下代码，我试图使用核心文本来绘制，这就是为什么我不能像 UILabel 那样剪辑文本。换句话说，我必须弄清楚我自己的省略号（'...'）。

```
 CGSize commentSize = [[self.sizeDictionary_ valueForKey:commentSizeKey] CGSizeValue];
        CGSize actualSize = [[self.sizeDictionary_ valueForKey:actualCommentSizeKey] CGSizeValue];

 NSString *actualComment = self.highlightItem_.comment;
        if (actualSize.height > commentSize.height){
            actualComment = [self.highlightItem_.comment stringByReplacingCharactersInRange:NSMakeRange(68, 3) withString:@"..."];
        } 
```

我很难根据 CGSize 找到“...”的范围。解决这个问题的最佳方法是什么？

我是这样画的：

```
CFStringRef string = CFBridgingRetain(actualComment);
        CFMutableAttributedStringRef comment = CFAttributedStringCreateMutable(kCFAllocatorDefault, 0);
        CFAttributedStringReplaceString (comment ,CFRangeMake(0, 0), string);

        CGColorRef blue = CGColorRetain([UIColor colorWithRed:131/255.f green:204/255.f blue:253/255.f alpha:1.0].CGColor);
        CGColorRef gray = CGColorRetain([UIColor colorWithWhite:165/255.f alpha:1.0].CGColor);

        CFAttributedStringSetAttribute(comment, CFRangeMake(0, [name length]),kCTForegroundColorAttributeName, blue);
        CFAttributedStringSetAttribute(comment, CFRangeMake([name length],  [self.highlightItem_.comment length] - [name length]),kCTForegroundColorAttributeName, gray);

        CGColorRelease (blue);
        CGColorRelease (gray);

        CTFontRef nameFont = CTFontCreateWithName(CFBridgingRetain(kProximaNovaBold), 13.0f, nil);
        CFAttributedStringSetAttribute(comment,CFRangeMake(0, [name length]),kCTFontAttributeName,nameFont);

        CTFontRef commentFont = CTFontCreateWithName(CFBridgingRetain(kProximaNovaRegular), 13.0f, nil);
        CFAttributedStringSetAttribute(comment, CFRangeMake([name length],  [self.highlightItem_.comment length] - [name length]),kCTFontAttributeName,commentFont);

        CGFloat commentYOffset = floorf((self.commentHeight_ - commentSize.height)/2);

        CGContextSaveGState(context);
        CGRect captionFrame = CGRectMake(0, 0, rect.size.width - 80, commentSize.height);
        CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString(comment);
        CGMutablePathRef captionFramePath = CGPathCreateMutable();
        CGPathAddRect(captionFramePath, NULL, captionFrame);

        CTFrameRef mainCaptionFrame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, 0), captionFramePath, NULL);

        CGContextRef context = UIGraphicsGetCurrentContext();
        CGContextSetTextMatrix(context, CGAffineTransformIdentity);
        CGContextTranslateCTM(context, self.buttonSize_ + 25, self.imageHeight_ + self.commentHeight_ + 6 - commentYOffset);
        CGContextScaleCTM(context, 1.0, -1.0);

        CTFrameDraw(mainCaptionFrame, context);
        CGContextRestoreGState(context); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T00:54:26.457

编辑

*（我在这里的原始答案没有用；它没有处理多行。如果有人想出于历史兴趣查看它，请查看编辑历史记录。我已将其删除，因为它引起的混乱比它解决的要多。当前答案是正确的代码。）*

你需要做的是让`CTFramesetter`除最后一行之外的所有行都算出来。然后，如果需要，您可以手动截断最后一个。

```
- (void)drawRect:(CGRect)rect
{
  CGContextRef context = UIGraphicsGetCurrentContext();
  CGContextSetTextMatrix(context, CGAffineTransformIdentity);

  CGRect pathRect = CGRectMake(50, 200, 200, 40);
  CGPathRef path = CGPathCreateWithRect(pathRect, NULL);

  CFAttributedStringRef attrString = (__bridge CFTypeRef)[self attributedString];

  // Create the framesetter using the attributed string
  CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString(attrString);

  // Create a single frame using the entire string (CFRange(0,0))
  // that fits inside of path.
  CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, 0), path, NULL);

  // Draw the lines except the last one
  CFArrayRef lines = CTFrameGetLines(frame);
  CFIndex lineCount = CFArrayGetCount(lines);
  CGPoint origins[lineCount]; // I'm assuming that a stack variable is safe here.
                              // This would be bad if there were thousdands of lines, but that's unlikely.
  CTFrameGetLineOrigins(frame, CFRangeMake(0, 0), origins);
  for (CFIndex i = 0; i < lineCount - 1; ++i) {
    CGContextSetTextPosition(context, pathRect.origin.x + origins[i].x, pathRect.origin.y + origins[i].y);
    CTLineDraw(CFArrayGetValueAtIndex(lines, i), context);
  }

  ///
  /// HERE'S THE INTERESTING PART
  ///
  // Make a new last line that includes the rest of the string.
  // The last line is already truncated (just with no truncation mark), so we can't truncate it again
  CTLineRef lastLine = CFArrayGetValueAtIndex(lines, lineCount - 1);
  CFIndex lastLocation = CTLineGetStringRange(lastLine).location;
  CFRange restRange = CFRangeMake(lastLocation, CFAttributedStringGetLength(attrString) - lastLocation);
  CFAttributedStringRef restOfString = CFAttributedStringCreateWithSubstring(NULL, attrString, restRange);
  CTLineRef restLine = CTLineCreateWithAttributedString(restOfString);

  // We need to provide the truncation mark. This is an ellipsis (Cmd-semicolon).
  // You could also use "\u2026". Don't use dot-dot-dot. It'll work, it's just not correct.
  // Obviously you could cache this…
  CTLineRef ellipsis = CTLineCreateWithAttributedString((__bridge CFTypeRef)
                                                        [[NSAttributedString alloc] initWithString:@"…"]);

  // OK, now let's truncate it and draw it. I'm being a little sloppy here. If ellipsis could possibly
  // be wider than the path width, then this will fail and truncateLine will be NULL and we'll crash.
  // Don't do that.
  CTLineRef truncatedLine = CTLineCreateTruncatedLine(restLine,
                                                      CGRectGetWidth(pathRect),
                                                      kCTLineTruncationEnd,
                                                      ellipsis);
  CGContextSetTextPosition(context, pathRect.origin.x + origins[lineCount - 1].x, pathRect.origin.y + origins[lineCount - 1].y);
  CTLineDraw(truncatedLine, context);

  CFRelease(truncatedLine);
  CFRelease(ellipsis);
  CFRelease(restLine);
  CFRelease(restOfString);
  CFRelease(frame);
  CFRelease(framesetter);
  CGPathRelease(path);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T01:30:06.387

像这样的东西怎么样...

```
- (NSString *)truncate:(NSString *)string toWidth:(CGFloat)width withFont:(UIFont *)font {

    CGSize size = [string sizeWithFont:font];
    if (size.width <= width) return string;

    NSString *truncatedString = [string copy];
    NSString *ellipticalString = [truncatedString stringByAppendingString:@"..."];
    size = [ellipticalString sizeWithFont:font];

    while (size.width > width && truncatedString.length) {
        truncatedString = [truncatedString substringToIndex:(truncatedString.length-1)];
        ellipticalString = [truncatedString stringByAppendingString:@"..."];
        size = [ellipticalString sizeWithFont:font];
    }
    return ellipticalString;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-05T05:36:59.160

最简单最简单的方法，

```
NSString *theText = @"bla blah bla bhla bla bla";
NSMutableParagraphStyle *style = [[NSParagraphStyle defaultParagraphStyle] mutableCopy];
[style setLineBreakMode:NSLineBreakByTruncatingTail];
[theText drawInRect:dirtyRect withAttributes:[NSDictionary dictionaryWithObjectsAndKeys:style, NSParagraphStyleAttributeName,nil]]; 
```

[更多](https://stackoverflow.com/a/18628492/876062)_

# c - 在 C 中更改结构的变量

> ID：15043385
> 
> 赞同：0
> 
> 时间：2013-02-23T17:27:07.330
> 
> 标签：c, pointers, struct

我是否正确地说，如果我想更改结构中变量的内容，我必须给出一个指向结构的指针，使用不同的函数来更改结构，如下所示：

结构：

```
typedef struct data{
    int row;
    int column; 
}data; 
```

struct changer 函数中的 var：

```
struct data* init_maze(void) {

    data information;      //init information struct
    data *infoPoint;       //int information struct pointer

    int row = 6;
    int column = 10;

    infoPoint->row = row;   //not working but should be updating information
    infoPoint->column = column; //same as above

    return infoPoint;
} 
```

但这并没有按预期工作。代码中断，没有任何反应。谁能解释我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:51:45.653

另一个答案包括正确使用指针，但对于不同的方法，您可以像简单变量一样传递结构，所以考虑这个版本：

```
struct data init_maze(void) {

    data information;   
    information.row = 6;   
    information.column = 10;

    return information;
} 
```

这不如传递指针那么有效，但对于*大多数*实际目的而言，在*大多数*情况下差异是无关紧要的。这里这个结构的大小是两个整数，这使它完全属于这个类别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:43:22.710

首先问问自己，你想在这里完成什么。

例如，您声明“数据信息”并且您从不使用它。在你操作它之前，你甚至没有将“infoPoint”指向任何东西。既然你没有写任何“SEGFAULT”，我猜你省略了一些代码？

反正。你想创建一个新的“数据”结构并返回一些初始值吗？然后你必须：A）分配一些内存并返回一个指向堆上这块内存的指针（必须用 malloc（或类似的）分配并在某个时候用 free 释放“

B）您可以将指向结构数据的指针作为参数并将您的值放在那里。

```
data *init_maza(void) {
   data *infoPoint = malloc(sizeof(struct data));

   data->row = 6;
   data->column = 10;

   return data;
}

void init_maze(data *outp) {
   outp->row = 6;
   data->column = 10;
} 
```

您可以使用指向堆栈或堆上的结构数据的指针调用 B)：

数据 foo; 数据 *bar = malloc(sizeof(struct data));

// 初始化 init_maze(&foo); 初始化迷宫（酒吧）；

请注意与号“&”，即“地址”运算符。

您还可以使用指向指针参数的指针，这样您仍然可以返回其他内容，例如错误代码。经常使用：

```
int init_maze(data **d) {
    *data = malloc(sizeof(struct data));
    (*data)->row = 6;
    (*data)->column = 10;

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:32:46.237

infoPoint 应声明为：

```
data* infoPoint = malloc (sizeof(data)); 
```

那么这段代码应该可以工作：

```
infoPoint->row = row;   //not working but should be updating information
infoPoint->column = column; //same as above 
```

并且函数 init_maze 不需要结构前缀：

```
data* init_maze(void) 
```

```
data information; 
```

也未使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:44:33.340

您的示例代码正在尝试修改指向结构的未初始化指针，因此`infoPoint->row = row;`是无效操作，因为`infoPoint`未初始化。

你可以像这样改变你的初始化函数：

```
void init_maze(data *infoPoint) {
    infoPoint->row = 6;
    infoPoint->column = 10;
} 
```

然后像这样使用它：

```
int main()
{
    data information;
    init_maze(&information);
} 
```

`data information;`将在堆栈上分配你的结构，你可以传递一个指向它的指针来`init_maze`完成它的工作。

# ruby-on-rails - 无法解释的 heroku 超时

> ID：15043393
> 
> 赞同：3
> 
> 时间：2013-02-23T17:27:37.193
> 
> 标签：ruby-on-rails, heroku

我在 Heroku 上部署了一个 rails 3.2.11 应用程序，随着时间的推移它已经相当稳定。在过去的 24 小时内，pingdom 一直在报告超时，我无法同时在日志中找到任何与“H1X”相关的错误。

我偶尔能够在谷歌浏览器中重现超时。在请求任何页面大约 30 秒后，我会在哪里收到此消息：

Chrome 浏览器错误 未收到数据 无法加载网页，因为服务器未发送数据。以下是一些建议： 稍后重新加载此网页。错误 324 (net::ERR_EMPTY_RESPONSE)：服务器关闭连接而不发送任何数据。

然后应用程序将开始正常处理请求，直到再次发生。

我知道这还不够信息，但我在 newrelic 或扫描与错误发生时间相关的日志中找不到任何有用的信息。

在一种情况下，我在查看 heroku 日志时在浏览器中重现了错误，当发生超时时，没有证据表明请求出现在日志中。就像失败的请求永远不会进入应用程序一样。

# android - 图片未显示在图库中

> ID：15043401
> 
> 赞同：0
> 
> 时间：2013-02-23T17:28:09.287
> 
> 标签：android, performance, android-intent, android-emulator, android-widget

我的应用程序能够拍摄照片并将其存储到指定的文件夹中。使用 ES 文件资源管理器，我能够确认图像已存储在 sd 卡和指定的文件夹中。

然而，我的画廊并没有立即展示这张专辑。这将需要相当长的时间。有什么方法可以让我立即使用代码进行检测？

以下广播代码似乎不起作用。我的画廊不会立即刷新以检索新创建的相册和图像。

请协助。谢谢！

```
if (type == MEDIA_TYPE_IMAGE){
            mediaFile = new File(mediaStorageDir.getPath() + File.separator +
            "IMG_"+ timeStamp + ".png");

             Intent mediaScanIntent = new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE);
             Uri contentUri = Uri.fromFile(mediaFile);
             mediaScanIntent.setData(contentUri);
             v.getContext().sendBroadcast(mediaScanIntent);

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:22:51.840

完成扫描可能需要一些时间。

如果您愿意，至少可以在完成时收到通知：

```
MediaScannerConnection.scanFile(
      getApplicationContext(), 
      new String[]{file.getAbsolutePath()}, 
      null, 
      new OnScanCompletedListener() {
         @Override
         public void onScanCompleted(String path, Uri uri) {
            // file was scanned
         }
      }); 
```

欲了解更多信息，请阅读[此处](http://www.grokkingandroid.com/adding-files-to-androids-media-library-using-the-mediascanner/)。

# arrays - 在 Perl 中循环遍历数组的哈希

> ID：15043402
> 
> 赞同：3
> 
> 时间：2013-02-23T17:28:15.673
> 
> 标签：arrays, perl, hash, reference, dereference

我有一个数组哈希，如下所示：

```
my %hash = (
234 => ["Larry", "Curly", "Moe"],
235 => ["bb", "ab", "aa", "ab", "bb"],
236 => ["aa", "ab", "bb", "aa", "bb"],
) 
```

对于哈希中的每个键，我想遍历数组的每个元素，将其分配给一个标量变量，以便我可以处理它，然后移动到数组的下一个元素。一旦我为一个键处理了数组的所有元素，我想进入下一个键并单独处理其数组的所有元素，依此类推。

我找到并修改了一个迭代哈希值的代码片段（在这种情况下是每个键的数组）。然后我有一个嵌套的 for 循环，它遍历该数组的每个元素。但是，它并没有像我期望的那样做。

```
for my $value (values %hash) {
    for (@$value) {
        my $index = shift($_);
       #process index
    }
} 
```

**错误消息** Not an ARRAY reference at [line number]

例如，对于第一次迭代，我想`$index`等于`Larry`以便我可以处理它。下一次迭代，我想`$index`相等`Curly`以便我可以处理它。下一次迭代，`$index`应该等于`Moe`，处理它。下一次迭代，`$index`应该等于`bb`，依此类推。

可能有比 更好的功能`shift`。该`shift`函数从数组中取出第一个元素。我希望数组的散列保留它的值，这样我就不必重新填充数组的散列。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T17:38:32.247

问题是您的列表`@$value`已经是您的数组元素列表，而不是数组。这就是为什么你不能使用`shift`它。所有你需要的是：

```
for my $value (values %hash) {
    for my $index (@$value) {  # "Larry", "Curly", "Moe" etc
       ....
       #process index
    }
} 
```

无论如何，您可能不想`shift`在您的数组上使用，因为这会从您的原始结构中删除条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-13T04:06:28.323

如果你想遍历数组的散列，你可以做这样的事情

```
#!/usrbin/perl -w
use strict;
use warnings;
use Data::Dumper;

my %hash = (
234 => ["Larry", "Curly", "Moe"],
235 => ["bb", "ab", "aa", "ab", "bb"],
236 => ["aa", "ab", "bb", "aa", "bb"],
);

foreach (keys %hash){
    foreach my $array(@{$hash{$_}}){
        ##do something with $array;
    }
} 
```

这里 $array 将为特定键一次保存一个数组值。

谢谢

# javascript - Javascript函数以这样的字符串格式写出秒数

> ID：15043405
> 
> 赞同：0
> 
> 时间：2013-02-23T17:28:24.370
> 
> 标签：javascript, time

我想要一个可以返回这样的字符串的函数：

它接受一个输入，即*数字*或*字符串，以***秒**为单位表示时间值。

如果输入是`0`，则返回`"0s"`。

如果输入是`10`（或小于 60），则只返回末尾带有“s”的数字：`"10s"`。

如果输入的是`60`,`120`等`180`，则只返回以“m”结尾的分钟数，不包括秒数：`"1m"`// `"2m"`（`"3m"`非必要时不显示秒数）。

如果输入是`65`，则返回`"1m05s"`（如果在第二个之前有数字或小时，则始终显示前导零）。

如果输入是`3600`等`7200`，则仅返回圆形小时，末尾带有“h”：`"1h"`/ `"2h"`（与分钟的逻辑相同）。

如果输入是`3661`，则返回`"1h01m01s"`（在分钟和秒上使用相同的逻辑：如果值之前有某些内容，则显示前导零）。

我只需要显示几个小时的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:28:24.370

这里是：

```
function toTimeString(num){
    if (typeof num != 'undefined'){
        if (!isNaN(num*1)){
            var mins=parseInt(num/60), secs=num % 60, hours=false,ret={};
            if (num>=3600){
                hours = parseInt(mins / 60);
                mins = mins-(hours*60);
                if (mins < 10 && mins != 0) mins = '0'+mins;
                else mins = false;
            }

            ret.h = (hours?hours+'h':'');
            ret.m = (mins?mins+'m':'');
            if (mins == 0 && !hours && secs == 0) ret.s = '0s';
            else if (secs){
                if (secs < 10 && mins) ret.s = '0'+secs+'s';
                else ret.s = secs+'s';
            }
            else ret.s = '';

            return ret.h+ret.m+ret.s;
        }
        else throw new TypeError("Passed argument is not a number");
    }
    else throw new ReferenceError("No arguments were passed.");
} 
```

一点合乎逻辑的解释：

1.  计算值
    1.  分钟等于`num`除以 60 并向下取整
    2.  计算秒数的最简单方法，而不必担心分钟除法等等，只需返回除法的余数 60 和`num`
    3.  默认情况下，我们不关心时间，所以让我们做吧`false`
2.  数小时
    1.  如果`num`大于或等于 3600，那么是时候考虑使用小时数了。因此，让我们将分钟数除以 60，然后将其四舍五入。
        *   但如果我们使用小时，我们必须以不同的方式处理分钟。让我们从分钟中减去小时乘以 60。如果需要，添加前导零。另外，如果结果数字是`0`，我们不想显示它，所以我们制作它`false`。
    2.  如果这个数字小于 3600，那为什么还要麻烦时间呢？继续。
3.  解析输出
    1.  如果小时和分钟是`undefined`or `0`，则将它们的值设置为空字符串，否则分别使用它们的值 with`"h"`和`"m"`appended
    2.  解析秒
        *   如果分钟是`0`，小时是`false`or`0`并且秒也是零（这种情况下输入是`0`），返回`"0s"`
        *   如果秒数不是`undefined`或`0`小于十，则添加前导零并返回它们并`"s"`附加
        *   否则，如果秒数大于 10，则返回它们并`"s"`附加一个。
        *   否则，将其设为空字符串，因为需要显示。

# php - JS 日期时间到 PHP 的转换

> ID：15043408
> 
> 赞同：1
> 
> 时间：2013-02-23T17:28:57.350
> 
> 标签：php, javascript, datetime

如何通过此函数从 JS 返回的日期时间转换

```
var now = new Date();
output:  Sun Feb 24 2013 01:26:47 GMT+0800 (MYT) 
```

转换成 php 可读格式，例如`date(YmdHis)`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:39:33.193

从您的 Javascript 函数返回一个 UNIX 时间戳：

```
Math.round(new Date().getTime() / 1000) //returns number of seconds since epoch 
```

然后只需在 PHP 的日期函数中使用它：

```
$yourJsTime = $_GET['jsTime']; //depends on how you pass your js timestamp
date_default_timezone_set('UTC');
echo date('YmdHis', $yourJsTime); 
```

# python - python中是否有OpenCV颜色图？

> ID：15043411
> 
> 赞同：6
> 
> 时间：2013-02-23T17:29:11.940
> 
> 标签：python, opencv

我知道[OpenCV 中的 Matlab，matplotlib 风格的颜色](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/colormaps.html)图。该文档解释了它在 C++ 中的用法。我想知道使用 cv2 的 python 是否也存在这样的选项。我用谷歌搜索了很多，一无所获。我知道我可以使用 matplotlib 的颜色图选项，但如果 cv2 提供了这样的选项，我可以消除将 matplotlib 颜色图转换为 opencv 图像的开销。它的笨拙。我的项目需要它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-09-06T19:22:36.383

对于 OpenCV 2.4.11，`applyColorMap`在 Python 中工作（即使[2.4.11 文档](http://docs.opencv.org/2.4.11/modules/contrib/doc/facerec/colormaps.html)仍然只列出 C++）：

```
import cv2
im = cv2.imread('test.jpg', cv2.IMREAD_GRAYSCALE)
imC = cv2.applyColorMap(im, cv2.COLORMAP_JET) 
```

另请参阅[此 Stack Overflow 答案](https://stackoverflow.com/a/28559208/1628638)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T17:57:10.093

很遗憾，它看起来还没有进入 python api。但是你可以看看 modules/contrib/src/colormap.cpp 中的实现，例如 jetmap 只是一个查找表，你可以偷它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T20:46:25.773

遗憾的是，OpenCV 没有任何颜色映射，但您可以编写一个。没那么难。

```
class ColorMap:
    startcolor = ()
    endcolor = ()
    startmap = 0
    endmap = 0
    colordistance = 0
    valuerange = 0
    ratios = []    

    def __init__(self, startcolor, endcolor, startmap, endmap):
        self.startcolor = np.array(startcolor)
        self.endcolor = np.array(endcolor)
        self.startmap = float(startmap)
        self.endmap = float(endmap)
        self.valuerange = float(endmap - startmap)
        self.ratios = (self.endcolor - self.startcolor) / self.valuerange

    def __getitem__(self, value):
        color = tuple(self.startcolor + (self.ratios * (value - self.startmap)))
        return (int(color[0]), int(color[1]), int(color[2])) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-13T01:41:47.153

无法在 Python 中使之前的 applyColorMap 示例正常工作。以为我分享。我为“胖”道歉。如果您的摄像机未被识别，或者有多个摄像机，请用“1”替换“0”

```
import cv2
import numpy as np

frameWidth = 940
frameHeight = 680
cap = cv2.VideoCapture(0)
cap.set(3, frameWidth)  # 3=width, 4=height
cap.set(4, frameHeight)

while True:
    success, imgColor, = cap.read()
    img = cv2.resize(imgColor, (frameWidth, frameHeight))  # if want to resize frame

    # ORIG IMG
    cv2.moveWindow("img", 0, 0)  # relocate shift reposition move so frame is at top left corner of monitor
    cv2.imshow("img", img)

    # COLOR ENHANCED
    cv2.moveWindow("imgColor", frameWidth, 0)  # relocate shift reposition move to side by side
    # COLORMAP_AUTUMN = 0
    # COLORMAP_BONE = 1
    # COLORMAP_COOL = 8
    # COLORMAP_HOT = 11
    # COLORMAP_HSV = 9
    # COLORMAP_JET = 2
    # COLORMAP_OCEAN = 5
    # COLORMAP_PINK = 10
    # COLORMAP_RAINBOW = 4
    # COLORMAP_SPRING = 7
    # COLORMAP_SUMMER = 6
    # COLORMAP_WINTER = 3
    cv2.imshow("imgColor", cv2.applyColorMap(imgColor, 3))  # change the last variable in here

    if cv2.waitKey(1) & 0xFF == ord('q'):
        break 
```

# excel - 对于每一行，按预定义列复制特定单元格并将值粘贴到单独工作表中的备用预定义列中

> ID：15043412
> 
> 赞同：4
> 
> 时间：2013-02-23T17:29:35.710
> 
> 标签：excel, vba

我必须从一个 Excel 工作表中选择数据并复制到另一个工作表中，但是在复制数据的过程中我需要实现以下目标：

*   对于原始工作表的每一行，按列选择单元格（我可以预定义，可能使用数组或其他东西）。

*   操作数据以更改其在新工作表中的方向。请参阅下面的屏幕截图。

很难准确解释我的意思，所以我希望我的截图能传达我的需要。

![在此处输入图像描述](../Images/be2c9bba16d78406745dc701a9e8ce2b.png)

对于每一行都有一个通道值，我需要按通道排序和压缩所有结果。还需要根据限制检查结果，但在解决此问题后我可以越过它。

我在下面有我的代码，我很欣赏可能存在错误，因为这是我的第一个脚本。没关系按通道排序数据，到目前为止，我什至都在努力选择我想要的列并将它们完全复制到新工作表中。

代码的第一部分是检查并创建一个新的工作表。之后，它继续定义我可以预定义我想要的列的变量和数组。它以一个循环结束，该循环检查 x 行数（尽管我确实希望它迭代尽可能多的行），并且在其中每一行都有另一个循环，根据我预定义的列抓取单元格。

调试时，它在循环内底部的工作表复制功能上显示为对象或应用程序错误。我不确定我哪里出错了。我哪里错了，有没有更好的方法来解决这个问题？

```
Sub Process_Results()

'User defines the worksheets for this script
sourcedatasheet_name = InputBox("Enter the customer data sheet name: ", "Enter Worksheet Name")

For rep = 1 To (Worksheets.Count)
    If LCase(Sheets(rep).Name) = LCase(sourcedatasheet_name) Then
        Exit For
    ElseIf (rep = Worksheets.Count) And (LCase(Sheets(rep).Name) <> LCase(sourcedatasheet_name)) Then
        MsgBox "This sheet does not exist!"
        Exit Sub
    End If
Next

destinationdatasheet_name = InputBox("Enter the destination worksheet name to write the data to: ", "Enter Destination Worksheet Name")
For rep = 1 To (Worksheets.Count)
    If LCase(Sheets(rep).Name) = LCase(destinationdatasheet_name) Then
        MsgBox "This sheet already exists!"
        Exit Sub
    End If
Next

Sheets.Add After:=Sheets(Sheets.Count)
Sheets(ActiveSheet.Name).Name = destinationdatasheet_name

'These are the variables for referencing data sets in the source sheet
Dim source_testmodel
Dim source_testcasename
Dim source_measurementname
Dim source_carrierfrequency
Dim source_limitlow
Dim source_limithigh
Dim source_measuredresult
Dim source_measurementunit

'These are the variables for referencing data set columns in the processed data sheet
Dim destination_testmodel
Dim destination_testcasename
Dim destination_measurementname
Dim destination_carrierfrequency_bottomchannel
Dim destination_carrierfrequency_middlechannel
Dim destination_carrierfrequency_topchannel
Dim destination_measuredresult

'Define the column number and cell column reference for each data set that will be used to retrieve information from the source sheet
source_testmodel = 9
source_testname = 11
source_measurementname = 12
source_measuredcarrierfrequency = 13
source_measurementlimitlow = 15
source_measurementlimithigh = 16
source_measuredresult = 17
source_measurementunit = 18

Dim array_source_fields(8) As Variant
array_source_fields(1) = source_testmodel
array_source_fields(2) = source_testname
array_source_fields(3) = source_measurementname
array_source_fields(4) = source_measuredcarrierfrequency
array_source_fields(5) = source_measurementlimitlow
array_source_fields(6) = source_measurementlimithigh
array_source_fields(7) = source_measuredresult
array_source_fields(8) = source_measurementunit

'Define the column number and cell column reference for each data set that will be used to write information to the processing sheet
destination_testmodel = 1
destination_testname = 2
destination_measurementname = 3
destination_channelbottom = 4
destination_channelmiddle = 5
destination_channeltop = 6

Dim array_processed_fields(6) As Variant
array_processed_fields(1) = destination_testmodel
array_processed_fields(2) = destination_testname
array_processed_fields(3) = destination_measurementname
array_processed_fields(4) = destination_channelbottom
array_processed_fields(5) = destination_channelmiddle
array_processed_fields(6) = destination_channeltop

'Start processing data

Dim y As Variant
Dim lastrow As Long

For x = 1 To 100 'row 'lastrow=activesheet.usedrange.specialcells(xlCellTypeLastCell)
    For Each y In array_source_fields 'y = LBound(Application.Transpose(array_source_fields)) To UBound(Application.Transpose(array_source_fields))
        Sheets(sourcedatasheet_name).Cells(x, y).Copy Destination:=Sheets(destinationdatasheet_name).Cells(x, y)
    Next y

Next x

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T18:02:30.820

顺便说一句，这里有一些代码可以做你想做的事情：

```
Const FIRST_CELL_IN_SOURCE_DATA = "$A$4"
Const FIRST_CELL_IN_DEST_DATA = "$A$2"

Const COL_SOURCE_MODE = 0
Const COL_SOURCE_DESC = 1
Const COL_SOURCE_CHANNEL = 2
Const COL_SOURCE_RESULT = 3
Const COL_SOURCE_LIMIT = 4

Const COL_DEST_MODE = 1
Const COL_DEST_DESC = 1
Const COL_DEST_RESULT = 4
Const COL_DEST_FIRST_CHANNEL = 3

Const ROW_DEST_HEADER = 1

Private wksSource As Worksheet
Private wksDest As Worksheet

Sub Process_Results()

If GetSourceSheet = False Then Exit Sub
If CreateDestinationSheet = False Then Exit Sub
CopyDataSet

End Sub

Private Function GetSourceSheet() As String

'User defines the worksheets for this script
sourcedatasheet_name = InputBox("Enter the customer data sheet name: ", "Enter Worksheet Name")

For rep = 1 To (Worksheets.Count)
    If LCase(Sheets(rep).Name) = LCase(sourcedatasheet_name) Then
        Exit For
    ElseIf (rep = Worksheets.Count) And (LCase(Sheets(rep).Name) <> LCase(sourcedatasheet_name)) Then
        MsgBox "This sheet does not exist!"
        Exit Function
    End If
Next

Set wksSource = Sheets(sourcedatasheet_name)
GetSourceSheet = True

End Function

Private Function CreateDestinationSheet() As String

destinationdatasheet_name = InputBox("Enter the destination worksheet name to write the data to: ", "Enter Destination Worksheet Name")
For rep = 1 To (Worksheets.Count)
    If LCase(Sheets(rep).Name) = LCase(destinationdatasheet_name) Then
        MsgBox "This sheet already exists!"
        Exit Function
    End If
Next

Sheets.Add After:=Sheets(Sheets.Count)
Sheets(ActiveSheet.Name).Name = destinationdatasheet_name

Set wksDest = Sheets(destinationdatasheet_name)
AddHeaders
CreateDestinationSheet = True

End Function

Private Sub CopyDataSet()

Dim rngSourceRange As Range
Dim rngDestRange As Range

Set rngSourceRange = wksSource.Range(FIRST_CELL_IN_SOURCE_DATA)
Set rngDestRange = wksDest.Range(FIRST_CELL_IN_DEST_DATA)
rngDestRange.Activate

Do Until rngSourceRange.Value = ""
    CopyRowToDest rngSourceRange, rngDestRange
    Set rngSourceRange = rngSourceRange.Offset(1)
Loop

End Sub

Private Sub AddHeaders()

Dim rng As Range
Set rng = wksDest.Cells(ROW_DEST_HEADER, 1)

rng.Value = "Mode"
rng.Offset(, 1).Value = "Test"

End Sub

Private Function GetColumnForChannel(ByVal Channel As String) As Long

Dim rng As Range
Set rng = wksDest.Cells(ROW_DEST_HEADER, COL_DEST_FIRST_CHANNEL)

Do Until rng.Value = ""
    If rng.Value = Channel Then
        GetColumnForChannel = rng.Column - 1
        Exit Function
    End If
    Set rng = rng.Offset(, 1)
Loop

rng.Value = Channel
GetColumnForChannel = rng.Column - 1

End Function

Private Sub MoveToModeRow(ByVal Mode As String)

If ActiveCell.Value = Mode Then Exit Sub

If ActiveCell.Address = FIRST_CELL_IN_DEST_DATA And ActiveCell.Value = "" Then
    ActiveCell.Value = Mode
    Exit Sub
End If

If Val(ActiveCell.Value) < Val(Mode) And ActiveCell.Offset(1).Value = "" Then
    ActiveCell.Offset(1).Activate
    ActiveCell.Value = Mode
    Exit Sub
End If

Dim rng As Range
Set rng = wksDest.Range(FIRST_CELL_IN_DEST_DATA)

Do Until rng.Value = ""
    If rng.Value = Mode Then
        rng.Activate
        Exit Sub
    End If
    Set rng = rng.Offset(1)
Loop

rng.Value = Mode
rng.Activate

End Sub

Private Sub CopyRowToDest(ByRef rngSourceRange As Range, ByRef rngDestRange As Range)

MoveToModeRow rngSourceRange.Offset(, COL_SOURCE_MODE).Value

Dim lngCol As Long
lngCol = GetColumnForChannel(rngSourceRange.Offset(, COL_SOURCE_CHANNEL).Value)

ActiveCell.Offset(, lngCol).Value = rngSourceRange.Offset(, COL_SOURCE_RESULT).Value
ActiveCell.Offset(, COL_DEST_DESC).Value = rngSourceRange.Offset(, COL_SOURCE_DESC).Value

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T20:21:36.883

有多种方法可以解决这个问题！[在这个文件](https://mega.co.nz/#!rYIHXaKJ!QtaO7y0oYIVIrGJIQRZbhFo4xyZng31aRjWQ1j1EhAM)中可以找到以下三个。 ![在此处输入图像描述](../Images/6aeea5c936be3ed526d6a4c96ae0d2fa.png)

**1\. 数据透视表**

1.  *插入*选项卡->*表格*-> 数据透视表
2.  选择您的数据作为要分析的范围，然后单击确定
3.  将字段`Mode`拖到“行标签”框，将“通道”拖到“列标签”列，将“结果”拖到“值”
4.  *数据透视表工具*->*设计*选项卡 ->*布局*->*总计*->*关闭行和列*

完毕！

**2\. 配方**

此解决方案仅适用于已知模式和通道名称的情况：

1.  将所有模式名称放在第一列，将所有通道名称放在第一行，即创建标题行。在下面的公式中，我假设标题行是第 1 行，标题列是 sheet2 中的 A，并且您的数据在 Sheet1 中，从单元格 A1 开始
2.  在单元格 B2 中，输入以下公式：

```
=INDEX(Sheet1!$D$2:$D$10,MATCH($A2&"_"&B$1,Sheet1!$A$2:$A$10&"_"&Sheet1!$C$2:$C$10,0))

```

这是一个数组公式，即用`Ctrl`- `Shift`-输入它`Enter` 3\. 将公式复制到表格中的所有剩余单元格

**3\. 宏**

这个宏将完成这项工作 - 尽管它假设模式和通道是排序的。您需要命名结果表的左上角单元格，`rngHeader`然后运行以下代码：

```
Sub FillTable()
    Dim rngSource As Range, rngTarget As Range
    Dim lngModeCount As Long, lngChannelCount As Long

    Set rngSource = Range("A2")
    Set rngTarget = Range("rngHeader")

    'Clear old result
    With rngTarget
        If .Offset(1) <> "" And .Offset(, 1) <> "" Then
            .Resize(.End(xlDown).Row - .Row + 1, .End(xlToRight).Column - .Column + 1).Clear
            rngTarget = "(cell is named ""rngHeader"")"
        End If
    End With

    While rngSource.Value <> ""
        If rngSource.Offset(-1) <> rngSource Then
            lngModeCount = lngModeCount + 1
            lngChannelCount = 0
            rngTarget.Offset(lngModeCount) = rngSource
            rngTarget.Offset(lngModeCount).Font.Bold = True
        End If
        lngChannelCount = lngChannelCount + 1
        If lngModeCount = 1 Then
            rngTarget.Offset(, lngChannelCount) = rngSource.Offset(, 2)
            rngTarget.Offset(, lngChannelCount).Font.Bold = True
        End If
        rngTarget.Offset(lngModeCount, lngChannelCount) = rngSource.Offset(, 3)
        Set rngSource = rngSource.Offset(1)
    Wend

End Sub 
```

# perl - Perl：函数的参数不足

> ID：15043414
> 
> 赞同：2
> 
> 时间：2013-02-23T17:29:37.713
> 
> 标签：perl

我是 Perl 的新手，目前正试图理解提到的错误消息。

我有这段代码（仍然主要用于测试pourposes）

```
#!/usr/bin/perl

use strict;
use warnings;

my %info = (autor => "Karryanna", jazyk => "cs");

vec([%info]);

sub vec
{
  my ($hashref) = @_;
  print $hashref->autor . "\n";
} 
```

当我尝试运行它时，它会给出此错误消息

```
Not enough arguments for vec at test.pl line 8, near "])" 
```

当我尝试用谷歌搜索它时，我发现[这个网站](http://ubuntuforums.org/showthread.php?t=293902)让我觉得在子例程调用之前加上一个＆符号就足够了。我试过了，它确实有帮助。

但是，当我后来遇到另一个问题时，谷歌搜索把我带到了[这个 SO question](https://stackoverflow.com/questions/6985643/reference-found-where-even-sized-list-expected)。关键是答案指出

> 您应该调用不带 & 的子程序，例如 populate(...)，除非您特别想覆盖子程序的原型。如果你不知道原型是什么，就不要使用 &。

我完全不知道 Perl 上下文中的原型是什么。那么 - 现实是什么样的？我应该只使用 & 还是有其他可能更“干净”的解决方案？

谢谢！

（顺便问一下，如果我可能会问一点 OT 问题——我真的应该在调用它之后定义子程序吗？这对我来说似乎真的很不自然，但是，我已经发现恢复顺序会使编译器抱怨）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T17:35:55.097

`vec`是一个 perl 内置函数，你会得到一个名称冲突 ( `perldoc -f vec`)。调用你的子程序别的东西。

你可能想这样称呼它：

```
mysub(\%info) 
```

在 Perl 中，您可以在声明子程序之前或之后调用它。唯一的限制是使用原型时，您可能不想这样做。颠倒顺序时会出现什么错误（“使编译器抱怨”没有多大帮助）？这可能是因为名称冲突。

# android - 如何使用 MediaPlayer 类将特定歌曲重复 x 次

> ID：15043418
> 
> 赞同：0
> 
> 时间：2013-02-23T17:29:45.280
> 
> 标签：android, media-player, repeat

我的代码是这个

```
 bv.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            if(mp.isPlaying()){
                mp.pause();
                bv.setImageResource(R.drawable.playzz);
            } else {
                bv.setImageResource(R.drawable.pausezz);
                for (int i=1; i<=10 ; i++){
                mp.start();
                }
            }
        } 
```

我只想重复一首歌10次。我用于循环，但声音只播放一次并停止。知道怎么做吗？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-24T06:30:34.703

您应该在单独的线程中执行此操作（假设 mp 是一个字段）：

```
 mp.setOnCompletionListener(new OnCompletionListener() {

            int n = 0;

            @Override
            public void onCompletion(MediaPlayer mp) {
                if (n < 10) {
                    mp.start();
                    n++;
                }
            }
        });
        mp.start(); 
```

正在做

```
while(mp.isPlaying()); 
```

会吃掉你的CPU。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T05:09:29.123

我相信这首歌会开始 10 次，而不是等待第一个实例结束，所以你需要做的是检查歌曲是否还在播放，并在它停止播放后重新开始。也许是这样的——

```
 for (int i=1; i<=10 ; i++){
            mp.start();
            while(mp.isPlaying());
    } 
```

这将确保歌曲的下一个实例仅在当前实例完成后才开始。此外，您需要在后台而不是在 onClick 中运行它，这样它就不会中断任何其他前台进程。

# cookies - Angularjs cookie - 如何跨控制器使用它们

> ID：15043420
> 
> 赞同：6
> 
> 时间：2013-02-23T17:29:56.293
> 
> 标签：cookies, angularjs, cookiestore

似乎没有关于 AngularJS 使用 cookie 的任何真正明确的文档，所以我对此有点迷茫。

我有两个控制器，一个创建一个 cookie 并存储一个用户 ID，然后我想稍后在另一个控制器运行时检索该 ID。我想我已经成功地创建了 cookie 并为 id 存储了一个值，但是我似乎无法从第二个控制器的 cookie 中取回 id。当我尝试读取 id 时，我的控制台中出现错误：

```
TypeError: 'undefined' is not an object 
```

PS：我在 Xcode 中工作，因为这是在 iPhone 的 ios 应用程序中。

```
function firstCtrl($scope, $cookieStore) {
    $scope.connectToFacebook = function() {
        FB.api('/me', function(response, data, status, headers, config) {
        var fbid=response.id;
        $cookieStore.put('id', fbid);
        console.log($cookieStore.get('id')); //This correctly displays the users FB id
        });
    }
}

function secondCtrl($scope, $cookieStore) {
    $scope.submit = function() {
    console.log($cookieStore.get('id')); // This is currently displaying: TypeError: 'undefined' is not an object
    };
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T16:27:54.930

采纳了 Greg 的建议，转而使用本地存储。

对于其他有问题并寻找合适方法的人，我使用了： [https ://github.com/grevory/angular-local-storage](https://github.com/grevory/angular-local-storage)

当本地存储不可用时，它会优雅地降级为 cookie

此处提供演示：http: [//gregpike.net/demos/angular-local-storage/demo.html](http://gregpike.net/demos/angular-local-storage/demo.html)

# ios - 如何停止 UIButton（用作自定义清除按钮）将 UITextField 作为第一响应者？

> ID：15043422
> 
> 赞同：1
> 
> 时间：2013-02-23T17:30:05.717
> 
> 标签：ios, uibutton, uitextfield, first-responder

我需要为 UITextField 创建一个自定义清除按钮（因为我的配色方案）。我正在使用以下代码（其中类是 UITextField 后代）：

```
UIButton *clearButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 20, 20)];
[clearButton setImage:[UIImage imageNamed:@"ClearButton.png"] forState:UIControlStateNormal];
[self setRightView:clearButton];
[self setRightViewMode:UITextFieldViewModeNever];
[clearButton addTarget:self action:@selector(clear:) forControlEvents:UIControlEventTouchUpInside]; 
```

大多数情况下，这可以正常工作。问题是单击清除按钮会导致 UITextField 退出第一响应者状态（即键盘消失）。我希望 UITextField 保持焦点。

我尝试在清除按钮的操作中恢复第一响应者状态，但是，如果 UITextField 在 UITableView 中 - 并且被滚动 - 这会在键盘关闭和打开时导致表格中出现一些不需要的滚动。

我可以使用 UIImageView 而不是 UIButton，但是当点击按钮时我没有看到视觉“脉冲”。

那么，有没有办法让 UITextField 在按下按钮时保持第一响应者状态？

我正在使用 iOS 6 开发 iPhone 应用程序。

[注意：“清除：”操作目标只是清空文本字段，但是，无论如何，即使我没有设置目标，我的问题也会出现。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:40:05.967

也许我不明白你的问题，但我认为问题可能出在这个问题上，你想在 textField 上创建第一响应者，这在你的 tableView 上不可见。而这不可能发生。您必须首先显示包含您的 textField 的行，然后才能将其作为第一响应者：

```
NSIndexPath *scrollIndexPath = [NSIndexPath indexPathForRow:yourIndex inSection:0];
[self.tableView scrollToRowAtIndexPath:scrollIndexPath atScrollPosition:UITableViewScrollPositionBottom animated:YES]; 
```

然后：

```
[self.textField becomeFirstResponder]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T00:10:49.600

找到了原因。我有一个手势识别器，用于在用户点击“背景”时处理关闭键盘。当用户单击文本字段上的关闭按钮时，它被激活。

我最终实施：

```
gestureRecognizer:shouldReceiveTouch: 
```

过滤掉清除按钮。

# c# - 在 Android 的新进程中运行命令行工具

> ID：15043438
> 
> 赞同：0
> 
> 时间：2013-02-23T17:31:09.503
> 
> 标签：c#, java, android, xamarin.android

我们有一个需要从 Android 应用程序运行的 unix 命令行工具。不存在实现我们正在寻找的相同功能的库。

在 Android 应用程序中捆绑和执行此工具的正确方法是什么？它是我们需要作为新进程执行的单个文件。我们希望避免使用任何私有 API 等。

注意：如果这是最佳选择，我们可以使用服务或提取到某个目录。我们正在使用 Mono for Android (Xamarin.Android)，但我们可以使用 Java 示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:38:26.700

希望这可以帮助 ...

```
try{
    Process process;            
    process = Runtime.getRuntime().exec("top -n 1 -d 1");
    BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));

} catch (InterruptedException e) 
{
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T19:11:25.643

为了在新进程上运行任何东西，您只需在清单中定义它。在您的情况下，您可能希望将其设置为服务：

```
http://developer.android.com/guide/topics/manifest/service-element.html 
```

（见进程属性）。

但是，我认为您不需要这样的东西，您可以改用新线程，它可能会在您的服务上运行，并且可能需要该服务是前台服务，具体取决于您的需要。

为了运行你想要的文件（我从来没有在 android 上做过），你可能需要将文件复制到某个地方（最好是用于你的应用程序的内部存储），然后像在unix/linux 的终端，使用 Runtime.getRuntime().exec(...

# javascript - 提交按钮的问题

> ID：15043442
> 
> 赞同：3
> 
> 时间：2013-02-23T17:31:31.217
> 
> 标签：javascript, html

这两种方式有什么区别吗：

1) `<form name=form> <input type=submit > </form>`

2) `document.form.submit();`

它是否通过单击提交按钮或通过 javascript 发送任何中断。
请让我知道这两种提交方式之间的主要区别

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:36:08.223

当您使用提交按钮提交时，它会将提交按钮的名称发送到服务器，如果您使用 javascript 提交，则不会发生这种情况。

除此之外，我认为没有区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:37:40.717

第一行允许使用提交按钮声明 html 表单：

```
//Submit form when the submit button has been clicked
<form id="myForm" action='myPage.php'><input type="submit" value"submit my form"></form> 
```

第二种是提交上述表单的JS方式：

```
//JS way to submit the form
document.forms["myform"].submit(); 
```

[http://www.javascript-coder.com/javascript-form/javascript-form-submit.phtml](http://www.javascript-coder.com/javascript-form/javascript-form-submit.phtml)

# linux - 删除图案之间的空白行

> ID：15043443
> 
> 赞同：2
> 
> 时间：2013-02-23T17:31:39.027
> 
> 标签：linux, sed, awk

我希望使用 sed 或 awk 删除文件中的空行（新行、制表符和空格），但前提是这些空行位于两个模式之间。

```
lorem lorem PATTERN1

\t

PATTERN2 lorem2 lorem2` 
```

我期望下面的结果是 2 行与两种模式的串联。

```
lorem lorem PATTERN1PATTERN2 lorem2 lorem2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T19:59:54.817

这可能对您有用（GNU sed）：

```
sed -r '/PATTERN1/!b;:a;/PATTERN2/bb;$!{N;ba};:b;s/(PATTERN1.*)[ \t\n]+(.*PATTERN2)/\1\2/;tb' file 
```

*   `/PATTERN1/!b`只打印该行，除非它包含第一个模式
*   `:a;/PATTERN2/bb;$!{N;ba}`将后续行读入模式空间 (PS)，直到遇到第二个模式
*   `:b;s/(PATTERN1.*)[ \t\n]+(.*PATTERN2)/;tb`替换第一个和第二个模式之间的所有空格、制表符和换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T13:55:57.620

@WilliamPursell 的 perl 脚本的 GNU awk 等效项：

```
awk -v RS='\0' '{print gensub(/(PATTERN1).*(PATTERN2)/,"\\1\\2","g")}' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T22:13:16.923

如果您只想删除包含 PATTERN1 和 PATTERN2 的行之间仅包含空格的行，只需执行以下操作：

```
sed '/PATTERN1/,/PATTERN2/{ /^[ \t]*$/d}' 
```

在您提供的示例输出中，您似乎还想消除 PATTERN1 后面的换行符，但不清楚您希望如何处理输入，例如：

```
PATTERN1
non-empty-line

PATTERN2 
```

也不是你想怎么处理

```
PATTERN1 non-whitesapce
PATTERN2 
```

也许需要澄清这个问题。如果您真的只想消除 and 之间的所有空格`pattern1`，`pattern2`那么最简单的方法可能是：

```
perl -0777 -pe 's/(pattern1)\s*(pattern2)/$1$2/g' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T22:19:54.713

@user537723：你可以试试 awk：

---改进了以前的帖子，所以它打印在图案之间的一行上---

```
awk '/PATTERN1/{ORS=x} /PATTERN2/{ORS=RS} ORS || NF' file 
```

# ruby-on-rails-3 - Ruby：如何捆绑安装一些新的gem而不更新现有的

> ID：15043445
> 
> 赞同：5
> 
> 时间：2013-02-23T17:31:49.130
> 
> 标签：ruby-on-rails-3, bundler

我正在开发旧版 Rails 应用程序。并且需要安装一些新的 gem。我们设置为使用捆绑工具。但是我被警告说我们不能进行简单的捆绑安装，因为对现有 gem 的任何更新都会使系统进入无效状态。

那么如何使用 bundle 添加一些新的宝石而不触及任何现有的宝石呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T17:35:07.903

如果你这样做`bundle install`了，Bundler 只关心你在`Gemfile`. 它还将删除`Gemfile.lock`您从`Gemfile`.

如果你这样做`bundle update`，那么你最终会遇到你在问题中描述的问题。它将更新现有的 gem，尤其是在没有为每个 gem 指定特定版本的情况下。

这是更深入的解释：http: [//viget.com/extend/bundler-best-practices](http://viget.com/extend/bundler-best-practices)。您可能想阅读“安装与更新”部分。

**更新**

为确保您完全控制 gem 的版本，我建议您在`Gemfile`. 您可以通过指示特定修订来对 Git 引用执行相同的操作。

`sunspot_cell`根据[这篇文章](http://cbpowell.wordpress.com/2012/09/18/indexing-rich-documents-with-rails-sunspot-solr-sunspot-cell-and-carrierwave-cookbook-style/)，我最近必须做些什么才能在我的环境中工作的例子：

```
# The ability to do full document indexing has some "special needs" right now
gem "sunspot", git: "git://github.com/sunspot/sunspot.git", ref: "f5a6b54e8c12a500acf37cfa3b4091bc57b75db0"
gem "sunspot_solr", git: "git://github.com/sunspot/sunspot.git", ref: "f5a6b54e8c12a500acf37cfa3b4091bc57b75db0"
gem "sunspot_rails", git: "git://github.com/sunspot/sunspot.git", ref: "f5a6b54e8c12a500acf37cfa3b4091bc57b75db0", require: "sunspot_rails"
gem "sunspot_cell", git: 'git://github.com/zheileman/sunspot_cell.git', ref: "0c0b7f980b8c46bd272fe0a5a31d2c259bebe36e"
gem "sunspot_cell_jars", "0.4"
gem "progress_bar", "0.4.0" 
```

如您所见，我希望`sunspot`gem 使用`github.com/sunspot/sunspot`特定的`f5a6b54e8c12a500acf37cfa3b4091bc57b75db0`修订版。

对于`sunspot_cell_jars`，我想`0.4`使用`sunspot_cell_jars`.

这样`bundle install`可以避免弄乱任何东西，并且您可以完全控制版本。

# .net - 文件传输期间出现 UnauthorizedAccessException

> ID：15043446
> 
> 赞同：1
> 
> 时间：2013-02-23T17:31:56.733
> 
> 标签：.net, vb.net, filestream

我的文件传输应用程序现在正在运行，以应有的方式传输文件。但是我遇到了另一个问题，我相信 stackoverflow 中的某个人可以对此有所了解。

当我第一次传输文件，目标位置没有任何重复时，或者当我再次传输相同的文件以在程序运行时覆盖现有的重复文件时，问题不会发生。但是当我关闭程序然后重新打开它以再次传输相同的文件时，在目标位置上存在之前传输的文件的现有副本，就会出现问题。

我得到错误`UnauthorizedAccessException: Access to the path denied`

我不认为这是用户权限问题，因为我在管理员帐户中运行该软件。但是，当然，我不是 100% 确定这一点。如果我的假设有误，请纠正我。

对此有什么建议吗？我相信，我可以通过`File.Exist`结合使用一些代码来解决这个问题，但我敢打赌有更好的方法来解决这个问题。

这是我的代码。

```
'This is where the error occurs; in the initialization of fileStream
'Maybe this has something to do with FileAccess and FileMode? I'm not sure.
Using fileStream As New FileStream(FilePath, FileMode.Create, FileAccess.Write)
  FileSharingStatusBar.Panels.Item(1).Text = "Receiving file . . ."
  Do Until TotalData = FileLength
    If ReadBytes = 0 Then
      fileStream.Close()
      FileTransferInterrupted = True
      Exit Do
    Else
      ReadBytes = ClientSocket.GetStream.Read(FileData, 0, FileData.Length())
      fileStream.Write(FileData, 0, ReadBytes)
      TotalData += ReadBytes
    End If
  Loop
End Using 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T12:51:14.847

几天后，我终于真正解决了这个问题。我在我的实现中删除了`NetworkStream.Read`and `NetworkStream.Write`，并将其替换为`BinaryReader.ReadString`and `BinaryWriter.Write`。这样，处理文件传输和日志的过滤就变成了一个，避免了网络传输过程中的混乱。

# git - 来自远程标签的 Git 分支

> ID：15043450
> 
> 赞同：6
> 
> 时间：2013-02-23T17:32:24.053
> 
> 标签：git, git-branch, git-tag

我创建了一个从另一个远程存储库镜像的新本地 git 存储库：

```
git init
git remote add original {url}
git pull original master
git remote add origin {url}
git push -u origin master 
```

这将创建一个`original`主分支的镜像。现在我想从`original`.

命令应该是什么样子？我试过`git checkout -b newbranch original/tagname`了，但我得到了：

```
fatal: Cannot update paths and switch to branch 'newbranch' at the same time.
Did you intend to checkout 'original/tagname' which can not be resolved as commit? 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-23T17:45:37.123

您需要将其包装在两个指令中

```
git checkout tagname && git checkout -b newbranch 
```

或者

```
git checkout tagname -b newbranch 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-26T15:18:25.620

这对我有用

```
$git fetch --tags
$git tag
$git checkout -b <new_branch_name> <tagname> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-23T17:51:03.233

没有“远程跟踪标签”的概念，就像“远程跟踪分支”一样。您要么从存储库中获取标签，要么不获取。至少在标准设置中。你可以改变它，但我不建议这样做。这不起作用吗？

```
git checkout -b newbranch tagname 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-12-09T07:38:27.703

以下 bash 脚本可用于自动执行此过程：

```
#!/bin/bash

old_name="old-branch-name"
new_name="new-branch-name"

git checkout ${old_name}
git branch -m ${old_name} ${new_name}
git push origin :${old_name} ${new_name}
git push origin -u ${new_name}
echo "Branch ${old_name} renamed to ${new_name}" 
```

# google-app-engine - cygwin中的谷歌应用引擎

> ID：15043453
> 
> 赞同：2
> 
> 时间：2013-02-23T17:32:55.340
> 
> 标签：google-app-engine, cygwin

我正在尝试在 cygwin 中安装谷歌应用引擎。我知道我需要安装 python 2.7 才能运行。这是因为在 3.0 中我遇到了一些问题。但是cygwin安装包中不存在2.7.3。我可以在 Windows 中安装它，但不能从 cygwin 访问它。有人知道使用 Cygwin 在 Windows 中运行 Google App Engine 的正确方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T20:00:05.863

我试过在 cygwin 中运行 GAE。主要是因为我在 cygwin 中运行了 git 等其他工具。

正确的方法是在 cygwin 之外运行 GAE 并按照 GAE 下载页面上的 Windows 说明进行操作。

如果需要 linux 环境，请在 VM 中运行 linux。它会比cygwin痛苦得多。您会遇到 cygwin 的许多其他问题，其中某些工具（如 git）在 95% 的时间都可以工作，但在另外 5% 的时间里会出现令人沮丧的错误。

# php - Highcharts，从数据库调用不正确的数组

> ID：15043458
> 
> 赞同：0
> 
> 时间：2013-02-23T17:34:25.893
> 
> 标签：php, mysql, json, highcharts

将 MySQL 数据调用到 PHP 页面。我对 PHP 和 SQL 还很陌生。我已经确定（在 JsFiddle 中）该数组不正确。

```
series: [{     data: [[{"date":"2013-02-16","distance":[4.16]},{"date":"2013-02-17","distance":[1.6]},{"date":"2013-02-19","distance":[1.2]},{"date":"2013-02-25","distance":[1.2]}]],
    pointStart: 0,
    pointInterval
                }] 
```

我正在尝试调用过去 7 天的运行数据。对数据库的调用是...

```
<?          
$series=array();
$last30= mysql_query("SELECT `date`, `distance` FROM `training` WHERE date>= DATE_ADD(CURDATE(), INTERVAL -7 DAY)AND user_id = 1");
        while($item = mysql_fetch_assoc($last30)) {
          $serie=array(
             "date" => $item['date'],
             "distance" => array(floatval($item['distance']))
          );
          array_push($series,$serie);
        }

        ?> 
```

我觉得日期“=> $item ['date']的PHP格式是导致问题的原因 [。http://jsfiddle.net/wphZe/](http://jsfiddle.net/wphZe/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:47:07.620

您应该使用 json_encode() 在 php 中对数组进行编码，然后将其加载到图表中。此外，您需要将自己的数据解析为时间戳（以毫秒为单位的时间）。

我建议熟悉有关预处理数据的文档：http: [//docs.highcharts.com/#preprocessing](http://docs.highcharts.com/#preprocessing)

# objective-c - 拦截外部应用程序启动 (Mac OS X)

> ID：15043466
> 
> 赞同：2
> 
> 时间：2013-02-23T17:35:28.140
> 
> 标签：objective-c, macos

我想在 Mac OS X 上启动应用程序之前添加一些功能，这些应用程序不受我控制且无法访问源代码。有什么办法可以在我自己的objective-c程序中拦截应用程序启动？

到目前为止，我已经看过：

*   **DYLD_INSERT_LIBRARIES** - 看起来很有希望，但不适用于所有应用程序？（[DYLD_INSERT_LIBRARIES 不适用于在 Mountain Lion 上使用权利签名的应用程序](https://stackoverflow.com/questions/12522837/dyld-insert-libraries-doesnt-work-for-app-signed-with-entitlement-on-mountain-l)）
*   **mach_override** - 不确定这个，似乎比 DYLD_INSERT_LIBRARIES 更复杂，我很难找到任何好的示例和文档。
*   **SIMBL** ( [http://www.culer.net/software/SIMBL/SIMBL.php](http://www.culater.net/software/SIMBL/SIMBL.php) ) - 仅适用于 Cocoa？

关于如何实现这一点的任何建议？

# database - 橙色文本挖掘

> ID：15043468
> 
> 赞同：0
> 
> 时间：2013-02-23T17:35:42.607
> 
> 标签：database, data-mining, text-mining, orange

我正在使用 Orange 数据挖掘软件来尝试查看文本文件中的数据，看看我是否能发现任何东西。当我添加文本文件时，它要求一个 .app 文件。我不知道如何转换文本文档，甚至不知道如何将数据库导出为 .app 文件。非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:19:10.593

Orange 将 .tab（制表符分隔文件）作为输入。第一行包括类和特征的名称，第二行是类和特征的类型，d（离散）或 c（连续或数字）。第三行具有数据库中每个类的标签“类”。

有关更多详细信息和示例，请参阅其文档[http://orange.biolab.si/docs/latest/tutorial/rst/data/](http://orange.biolab.si/docs/latest/tutorial/rst/data/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-17T16:29:35.867

我通常使用[OpenRefine](http://openrefine.org/)通过单击右上角的**导出**按钮并选择“制表符分隔值”来转换“.tab”文件中的任何**文本/Excel**文件，然后在“*.tab”中重命名导入的文件和然后我将它导入Orange。

 **![从 OpenRefine 导出为 TSV](../Images/87011d80f3a8f1715a8174c3b30410fc.png)**

# php - OO PHP和MySQL将“成员”插入数据库

> ID：15043475
> 
> 赞同：2
> 
> 时间：2013-02-23T17:35:59.410
> 
> 标签：php, mysql, ajax, oop

我正在创建一个用户可以登录的网站，他们有自己的个人资料页面，可以在其中更改一些设置。要查看他们的个人资料，他们必须登录。

我有一个注册页面，要求用户输入他们的名字、姓氏、用户名和密码。我想要完成的是一个单页解决方案，用户可以在其中注册/登录/查看他们的个人资料等。

到目前为止，我有这个：

**member.php** - 这是成员类

```
<?php

require_once("database.php");

class Member extends DatabaseObject {
    protected static $table_name = "tblMembers";
    var $firstName = null; // initiating the $firstName variable
    var $lastName = null; // initiating the $lastName variable
    var $username = null; // initiating the $username variable
    var $password = null; // initiating the $password variable
    var $reviews = null; // initiating the $reviews variable
    var $type = null; // initiating the $type variable

    function __construct($firstName, $lastName, $username, $password) {
        $this->firstName = $firstName;
        $this->lastName = $lastName;
        $this->username = $username;
        $this->password = $password;
        //$this->insert($firstName, $lastName, $username, $password, $type);
    }

    function set_firstName($firstName) {
        $this->firstName = $firstName;
    }

    function get_firstName() {
        return $this->firstName;
    }

    function set_lastName($lastName) {
        $this->lastName = $lastName;
    }

    function get_lastName() {
        return $this->lastName;
    }

    function get_fullName() {
        if (isset($this->firstName) && isset($this->lastName)) {
            return $this->firstName . " " . $this->lastName;    
        } else {
            return "";
        }
    }

    function set_username($username) {
        $this->username = $username;
    }

    function get_username() {
        return $this->username;
    }

    function set_password($password) {
        $this->password = md5(DB_SALT.$password);
    }

    function get_password() {
        return $this->password;
    }

    public static function authenticate($username="", $password="") { 
        global $database;
        $username = $database->escape_value($username);
        $password = $database->escape_value($password);
        $passwordHash = md5(DB_SALT.$password);

        $sql = "SELECT * FROM tblMembers ";
        $sql .= "WHERE username = '{$username}' ";
        $sql .= "AND passwordHash = '{$passwordHash}' ";
        $sql .= "LIMIT 1";

        $result_array = self::find_by_sql($sql);
        if (!empty($result_array)) {
            //echo "true";
            return array_shift($result_array); // Pulling first element from array
        } else {
            //echo "false";
            return false; // Ability to ask whether we return something
        }

    }

    public function insert($firstName, $lastName, $username, $password) {
        $database = new Database();
        $database->query("INSERT INTO tblMembers VALUES ('','{$firstName}','{$lastName}','{$username}','{$password}','4')");
    }

    // Common Database Methods

    private static function instantiate($record) {
        $object = new self;

        foreach ($record as $attribute=>$value) {
            if ($object->has_attribute($attribute)) {
                $object->$attribute = $value;
            }
        }
        return $object;
    }

    public static function find_all() {
        return self::find_by_sql("SELECT * FROM ".self::$table_name);
    }

    public static function find_by_id($id=0) {
        global $database;
        $result_array = self::find_by_sql("SELECT * FROM ".self::$table_name." WHERE userID={$id} LIMIT 1");
        if (!empty($result_array)) {
            return array_shift($result_array); // Pulling first element from array
        } else {
            return false; // Ability to ask whether we return something
        }
    }   

    public static function find_by_sql($sql="") {
        global $database;
        $result_set = $database->query($sql);
        $object_array = array();
        while ($row = $database->fetch_array($result_set)) {
            $object_array[] = self::instantiate($row);
        }
        return $object_array;
    }

    private function has_attribute($attribute) {
        $object_vars = get_object_vars($this);
        return array_key_exists($attribute, $object_vars);
    }
}

?>

database.php 
```

这是数据库类

```
<?php
require_once("config.php");
class Database {

    private $connection;
    public $last_query;
    private $magic_quotes_active;
    private $mysql_real_escape_string_exists;

    function __construct() {
        $this->open_connection();
        $this->magic_quotes_active = get_magic_quotes_gpc();
        $this->mysql_real_escape_string_exists = function_exists("mysql_real_escape_string");
    }

    public function open_connection() {
        // Create Database connection
        $this->connection = mysql_connect(DB_SERVER, DB_USER, DB_PASS);
        if (!$this->connection) {
            die("Database connection failed: " . mysql_error());
        } else {
            $db_select = mysql_select_db(DB_NAME, $this->connection);
            if (!db_select) {
                die("Database selection failed: " . mysql_error());
            }
        }
    }

    public function close_connection() {
        // Closes the connection to the database
        if(isset($this->connection)) {
            mysql_close($this->connection);
            unset($this->connection);
        }
    }

    public function query($sql) {
        $this->last_query = $sql;
        $result = mysql_query($sql, $this->connection);
        $this->confirm_query($result);
        return $result;
    }

    public function escape_value($value) {

        if ($this->mysql_real_escape_string_exists) {           
            if ($this->magic_quotes_active) {
                $value = stripslashes($value);
            }
            $value = mysql_real_escape_string($value);
        } else {
            if (!$this->magic_quotes_active) {
                $value = addslashes($value);
            }
        }
        return $value;
    }

    public function num_rows($result_set) {
        return mysql_num_rows($result_set);
    }

    public function insert_id($result_set) {
        return mysql_insert_id($this->connection);
    }

    public function affected_rows() {
        return mysql_affected_rows($this->connection);
    }

    public function fetch_array($result_set) {
        return mysql_fetch_array($result_set);
    }

    private function confirm_query($result) {
        if (!$result) {
            $output = "Database query failed: " . mysql_error() . "<br />";
            $output .= "Last SQL query: " . $this->last_query;
            die($output);
        }
    }
}

$database = new Database();

?> 
```

与数据库的连接工作正常，参数存储在`config.php`与`DB_SALT`.

**register.php** - 这包含注册表单，但是我想使用 AJAX 提交表单，而不是强制页面刷新的当前 post 方法。任何帮助实现这一点将不胜感激。我不想为此使用 JQuery，因为我不熟悉它，而且我还在学习 JavaScript，所以我不想继续前进。

```
<?php
require_once("includes/config.php");
if(isset($_POST['submit'])) {
    $firstName = $_POST['firstName'];
    $lastName = $_POST['lastName'];
    $username = $_POST['username'];
    $password = $_POST['password'];
    $member = new Member();
    $member->insert($firstName, $lastName, $username, $password);
} else {
?>
<!DOCTYPE html>
<html lang="en-EN">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="css/style.css" media="screen" />
        <link rel="stylesheet" href="css/email_client.css" media="screen" />
        <!--[if !IE 7]>
            <style type="text/css">
                #wrap {display:table;height:100%}
            </style>
        <![endif]-->

        <title>Register</title>
    </head>
    <body>
        <?php include("includes/header.php"); ?>
        <div id="wrap">
            <div id="main">

                <nav>
                    <?php include("includes/nav.php"); ?>
                </nav>

                <div id="stylized" class="myform">
                    <form action="<?php echo $PHP_SELF; ?>" method="post">
                        <span class="label">First Name:</span>&nbsp;<input id="firstName" type="text" name="firstName" class="splash" value="John"><br />
                        <span class="label">Last Name:</span>&nbsp;<input id="lastName" type="text" name="lastName" class="splash" value="Smith"><br />
                        <span class="label">Username:</span>&nbsp;<input id="username" type="text" name="username" class="splash" value="jsmith"><br />
                        <span class="label">Password:</span>&nbsp;<input id="password" type="password" name="password" class="splash" value="pass"><br />
                        <span class="label">Confirm Password:</span>&nbsp;<input id="passwordConfirmation" type="password" name="passwordC" class="splash" value="pass"><br />
                        <input type="submit" value="Register" class="button" name="submit">
                    </form>
                </div>
            </div>
        </div>
        <div id="footer">
            <?php echo COPYRIGHT_STRING; ?>
        </div>  
    </body>
</html>
<?php } ?> 
```

我想结合 AJAX 和 SESSIONS 等技术来存储用户的状态，以便他们的登录是持久的。

**我现在正在努力解决的问题是如何处理 register.php 表单提交、创建`new Member`对象并将所有数据直接插入数据库。**

我检查了我们的各种教程，对于这里需要的东西来说都太复杂了，而且，如上所述，我不想使用 jQuery，至少暂时不想。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T18:54:24.107

## 关于ajax的一般思考

你确定你想要一页吗？根据我的经验，登录页面看起来与个人资料页面截然不同，但这是您的选择。

Ajax 主要是通过 JavaScript 加载网站。您可以从这里开始[XMLHttpRequest](http://www.w3schools.com/xml/xml_http.asp)。

您可以使用 XMLHttpRequest 加载完整的网站并替换 html-body 的内容，但 ajax 背后的想法是只传输需要传输的内容，即浏览器中网站上需要更改的内容。因此，通常只传输 JSON 数据，或网站上某些 div 容器的 html 数据。您的服务器需要为这些请求做好准备，例如以非常基本的方式：

```
<?php
// read request data uses http://www.php.net/manual/en/book.filter.php
$firstName = filter_input(INPUT_POST, 'firstName', FILTER_SANITIZE_STRING);
$lastName  = filter_input(INPUT_POST, 'lastName', FILTER_SANITIZE_STRING);
$username  = filter_input(INPUT_POST, 'username', FILTER_SANITIZE_STRING);
$password  = filter_input(INPUT_POST, 'password', FILTER_SANITIZE_STRING);

//create Memeber object and save it
require_once('member.php');
$member = new Member ($firstName, $lastName, $username, $password);
$success = $member->insert();

// answer the request
$data = new stdClass();
if( $success === true ) { 
    // return Success
    $data->success = true;
    print json_encode($data);
    exit();
} else {
    // return error
    $data->success = false;
    $data->message = 'Could not register';
    print json_encode($data);
    exit();
}
exit(-1);
?> 
```

确保您没有以正常方式提交表单，请参见[此处](https://stackoverflow.com/q/932653/2606058)

jQuery 让这一切变得更容易，所以也许你想重新考虑不使用它。

## PHP 编程

停止`var`在已弃用的 php 类中使用它，像在 Database 类中一样使用可见性修饰符 ( `private`, `public`, `protected`)

由于您争相使用 OOP，请注意[PHP PDO](http://php.net/manual/en/book.pdo.php)并尝试将其用于您的数据库层

将您的数据库实现为单例，可能更容易，基本上添加：

```
<?php
// in Database class

/** The Sigleton instance
  * @var Database
  */
private static $instance = false;

/** Singleton Getter for this class.
  * @return Database The singleton instance.
  */
public static getInstance() {
    if(self::$instance === false) {
        self::$instance = new self();
    }
    return self::$instance;
}
?> 
```

并确保您的构造函数受到保护，因此不会创建其他实例。要使用它，请执行以下操作：

```
<?php
// in Member class

public function insert($firstName, $lastName, $username, $password) {
    // get singleton instance;
    $db = Database::getInstance();

    return $db->query(sprintf(
        "INSERT INTO tblMembers VALUES ('','%s','%s','%s','%s','4')",
        $db->escape_value($this->firstName),
        $db->escape_value($this->lastName),
        $db->escape_value($this->username),
        $db->escape_value($this->password)
    ));
}
?> 
```

希望这有助于您入门。

# java - 如何从class1到class2的setText？

> ID：15043481
> 
> 赞同：1
> 
> 时间：2013-02-23T17:36:49.443
> 
> 标签：java, swing, oop

我在将 class1 中的一个字段的文本设置为 class2 中的另一个字段时遇到问题。基本上，我有两节课。在class1中，我有一个方法允许用户搜索文件中的单词（从文件中读取），然后当找到该单词时，我想将其设置为class2“field1”。

例如，如果我搜索“San”，则 class2 中的搜索词应显示“San”，第二个词应显示“Aya”。

我不知道我哪里出错了，程序没有显示任何错误。任何帮助将不胜感激。提前致谢。

文件.txt

`San Aya`

```
public class MyFileReader {

    JTextField searchfield = new JTextField(10);
    JPanel panel = new JPanel();

    public MyFileReader() {
        panel.add(new JLabel("Search:"));
        panel.add(searchfield);
        panel.setLayout(new GridLayout(5, 2));
        int result = JOptionPane.showConfirmDialog(null, panel,
                "Search", JOptionPane.YES_NO_OPTION);
        if (result == JOptionPane.YES_OPTION) {
            MyContentManager contentManager = new MyContentManager();
            try {
                String stringSearch = searchfield.getText();
                BufferedReader bf = new BufferedReader(new FileReader("file.txt"));
                int linecount = 0;
                String line;
                ArrayList<String> list = new ArrayList<String>();
                while ((line = bf.readLine()) != null) {
                    list.add(line);
                    linecount++;
                    int indexfound = line.indexOf(stringSearch);
                    if (indexfound > -1) {
                        String[] word = line.split("\t");
                        String firstword = word[0];
                        String secondword = word[1];
                        contentManager.field1.setText(stringSearch);//This is the problem
                        contentManager.field2.setText(secondword);//This is the problem
                    }
                }
                bf.close();
            } catch (IOException e) {
                System.out.println("IO Error Occurred: " + e.toString());
            }
        }
    }

    public static void main(String[] args) {
        new MyFileReader();
    }
} 
```

类2

```
public class MyContentManager {

    JTextField field1 = new JTextField(10);
    JTextField field2 = new JTextField(10);
    JPanel panel = new JPanel();

    public MyContentManager() {
        panel.add(new JLabel("Searched For:"));
        panel.add(field1);
        panel.add(new JLabel("Second word:"));
        panel.add(field2);
        panel.setLayout(new GridLayout(5, 2));
        int result = JOptionPane.showConfirmDialog(null, panel,
                "Search found", JOptionPane.YES_NO_OPTION);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:39:17.790

我会给你的第二类setter方法，让它产生一个可以通过getter方法获得的JPanel，然后简单地将它显示在一个JOptionPane中（如果需要）。例如：

DamClass1.java

```
class DamClass1 {
   JTextField searchfield = new JTextField(10);
   JPanel panel = new JPanel();

   public DamClass1() {
      panel.add(new JLabel("Search:"));
      panel.add(searchfield);
      panel.setLayout(new GridLayout(5, 2));
      int result = JOptionPane.showConfirmDialog(null, panel, "Search",
            JOptionPane.YES_NO_OPTION);
      if (result == JOptionPane.YES_OPTION) {
         DamClass2 c2 = new DamClass2();
         String stringSearch = searchfield.getText();

         if (stringSearch.equals("Foo")) {
            c2.setField1(stringSearch);
            c2.setField2("Bar");

            int result2 = JOptionPane.showConfirmDialog(panel, c2.getPanel(),
                  "Search found", JOptionPane.YES_NO_OPTION);
         }

         // commented to make the code runnable for me.
         // try {
         // BufferedReader bf = new BufferedReader(new FileReader("file.txt"));
         // int linecount = 0;
         // String line;
         // ArrayList<String> list = new ArrayList<String>();
         // while ((line = bf.readLine()) != null) {
         // list.add(line);
         // linecount++;
         // int indexfound = line.indexOf(stringSearch);
         // if (indexfound > -1) {
         // String[] word = line.split("\t");
         // String firstword = word[0];
         // String secondword = word[1];
         // c2.field1.setText(stringSearch);//This is the problem
         // c2.field2.setText(secondword);//This is the problem
         // }
         // }
         // bf.close();
         // } catch (IOException e) {
         // System.out.println("IO Error Occurred: " + e.toString());
         // }
      }
   }

   public static void main(String[] args) {
      DamClass1 s1 = new DamClass1();
   }
} 
```

DamClass2.java

```
class DamClass2 {
   private JTextField field1 = new JTextField(10);
   private JTextField field2 = new JTextField(10);
   private JPanel panel = new JPanel();

   public DamClass2() {
      panel.add(new JLabel("Searched For:"));
      panel.add(field1);
      panel.add(new JLabel("Second word:"));
      panel.add(field2);
      panel.setLayout(new GridLayout(5, 2));
   }

   public JPanel getPanel() {
      return panel;
   }

   public void setField1(String text) {
      field1.setText(text);
   }

   public void setField2(String text) {
      field2.setText(text);
   }
} 
```

在这里提出问题时，请努力发布格式更好的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:57:34.430

class2 是在搜索之前构建的，您必须延迟它的实例化并在其构造函数中添加两个参数以使用正确的值设置字段。

JOptionPane 显示在构造函数中，如果要按照注释使用 settter，则必须将对话框移至此 setter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:05:26.630

您需要将第二类更改为：

```
public class MyContentManager {

    public int showFieldsFound(String first, String second) {
        JTextField field1 = new JTextField(10);
        field1.setText(first);
        JTextField field2 = new JTextField(10);
        field2.setText(second)
        JPanel panel = new JPanel();
        panel.add(new JLabel("Searched For:"));
        panel.add(field1);
        panel.add(new JLabel("Second word:"));
        panel.add(field2);
        panel.setLayout(new GridLayout(5, 2));
        return JOptionPane.showConfirmDialog(null, panel,
                "Search found", JOptionPane.YES_NO_OPTION);
    }
} 
```

这将处理在您找到它们时显示这些字段。现在您的第一堂课需要执行以下操作：

```
public class MyFileReader {

    JTextField searchfield = new JTextField(10);
    JPanel panel = new JPanel();

    public MyFileReader() {
        panel.add(new JLabel("Search:"));
        panel.add(searchfield);
        panel.setLayout(new GridLayout(5, 2));
        int result = JOptionPane.showConfirmDialog(null, panel,
                "Search", JOptionPane.YES_NO_OPTION);
        if (result == JOptionPane.YES_OPTION) {
            MyContentManager contentManager = new MyContentManager();
            try {
                String stringSearch = searchfield.getText();
                BufferedReader bf = new BufferedReader(new FileReader("file.txt"));
                int linecount = 0;
                String line;
                ArrayList<String> list = new ArrayList<String>();
                while ((line = bf.readLine()) != null) {
                    list.add(line);
                    linecount++;
                    int indexfound = line.indexOf(stringSearch);
                    if (indexfound > -1) {
                        String[] word = line.split("\t");
                        String firstword = word[0];
                        String secondword = word[1];
                        int resultFromShowing = contentManager.showFieldsFound(stringSearch, secondWord);
                    }
                }
                bf.close();
            } catch (IOException e) {
                System.out.println("IO Error Occurred: " + e.toString());
            }
        }
    }

    public static void main(String[] args) {
        new MyFileReader();
    }
} 
```

不确定您想对显示单词的结果做什么，但我已经更改了第二个类以返回值。

# c# - 更快的 Log2Ceil

> ID：15043483
> 
> 赞同：1
> 
> 时间：2013-02-23T17:37:02.817
> 
> 标签：c#, math, bit-manipulation

我想知道是否有人知道一种更快的方法来实现下面的函数，在 C# 中计算整数的 2 上限的对数。

```
private int Log2Ceil(int x)
{
   return (int)Math.Ceiling(Math.Log((double)x, 2));
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T17:42:09.013

[请参阅此问题](https://stackoverflow.com/questions/671815/what-is-the-fastest-most-efficient-way-to-find-the-highest-set-bit-msb-in-an-i "这个问题")的答案。它引用的代码是用 C 编写的，但其中大部分也可以在 C# 中运行。

或者，您可以使用

```
private int Log2Ceil(int n) {
    long bits = BitConverter.DoubleToInt64Bits((double)n);
    return ((int)(bits >> 52) & 0x7ff) - 1022;
} 
```

它使用了浮点数包含二进制指数编码的事实。一个快速的基准测试表明，这比您在 x64 上的原始速度快 13 倍，在 x86 上快约 21 倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T22:55:04.510

我还找到了另一种方法来做到这一点，如此[处](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious)所述。

```
private int Log2Ceil(int x)
{
    uint v = (uint)(x - 1); // 32-bit word to find the log base 2 of
    uint r = 0; // r will be lg(v)
    while (v > 0) // unroll for more speed...
    {
        v >>= 1;
        r++;
    }
    return (int)r;
} 
```

# haskell - IO 作为副作用

> ID：15043484
> 
> 赞同：3
> 
> 时间：2013-02-23T17:37:06.643
> 
> 标签：haskell, io

我可以编写一个函数`IO`作为它的副作用执行吗？例如：

```
f :: Int -> Int
f n = putStr "text" >> return n*2 
```

显然，我没有任何方法可以编写完全不正确的代码，但这至少应该大致显示我想要做什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-23T17:44:15.587

你的功能几乎是正确的。如果它有副作用，那么它需要 type `IO`。此外，函数应用程序的绑定比中缀更紧密。修复这些结果：

```
f :: Int -> IO Int
f n = putStr "text" >> return (n*2) 
```

# mysql - 是否存在会导致 MySql 在查询之间等待 1 秒的设置或某些问题？

> ID：15043491
> 
> 赞同：0
> 
> 时间：2013-02-23T17:37:54.227
> 
> 标签：mysql, vb.net, odbc

我有一个客户需要将旧的 vb.net Web 应用程序从旧服务器移到新服务器。当我让应用程序在新服务器上运行时，我们注意到它运行非常缓慢，尽管服务器更新且硬件更好。

我对应用程序进行了性能分析，主要热点是 OdbcDataAdapter.Fill() 命令。

然后我在 MySQL 中启用了通用日志并对其进行了跟踪。我发现该应用程序正在执行大量查询（例如，该程序员将对搜索中的每个结果执行多个查询），但它们似乎在某处受到限制。

这里只是一个单页请求的日志的一瞥：

```
130223 11:21:48   624 Connect   root@localhost on mydb
          624 Query SET NAMES utf8
          624 Query SET character_set_results = NULL
          624 Query SET SQL_AUTO_IS_NULL = 0
          624 Query set @@sql_select_limit=DEFAULT
          624 Query select count(*) from bg_doc_status where uploaded = 1 and candidateid='51233'
          624 Quit  
130223 11:21:49   625 Connect   root@localhost on mydb
          625 Query SET NAMES utf8
          625 Query SET character_set_results = NULL
          625 Query SET SQL_AUTO_IS_NULL = 0
          625 Query set @@sql_select_limit=DEFAULT
          625 Query select * from bg_doc_status where willfax=1 and candidateid='51233'
          625 Quit  
130223 11:21:50   626 Connect   root@localhost on mydb
          626 Query SET NAMES utf8
          626 Query SET character_set_results = NULL
          626 Query SET SQL_AUTO_IS_NULL = 0
          626 Query set @@sql_select_limit=DEFAULT
          626 Query Select distinct serviceid from bg_service_results where CandidateID='51233'
          626 Quit  
130223 11:21:51   627 Connect   root@localhost on mydb
          627 Query SET NAMES utf8
          627 Query SET character_set_results = NULL
          627 Query SET SQL_AUTO_IS_NULL = 0
          627 Query set @@sql_select_limit=DEFAULT
          627 Query Select count(*) from bg_candidates_selected_services where CandidateID='51233'
          627 Quit 
```

我们不需要谈论这个编程有多糟糕:)。这个人可以在一个查询中做很多事情。但是，MySql 似乎每秒最多执行一个查询！

如果我在工作台 SQL 编辑器中运行这些查询中的任何一个，它们每个都需要“0.000 秒”。如果我尽快按 CTRL+ENTER，日志将显示它们每秒执行几次。

有谁知道是什么导致了每秒 1 个查询的限制？它发生在开发和生产中。

我已经尝试了 32 位和 64 位的 MySQL ODBC 5.2w 驱动程序和 MySQL ODBC 5.2a 驱动程序。

**我找到了解决方案： odbc.open() 占用了整整一秒。显然是 dns 查找（对于 localhost！）需要时间。将我的 web.config 中的数据库服务器地址更改为 127.0.0.1 修复了它。看起来[这个人](http://forums.mysql.com/read.php?37,278517,278517)发现了同样的问题。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:57:51.113

我找到了解决方案： odbc.open() 占用了整整一秒。显然是 dns 查找（对于 localhost！）需要时间。将我的 web.config 中的数据库服务器地址更改为 127.0.0.1 修复了它。看起来[这个人](http://forums.mysql.com/read.php?37,278517,278517)发现了同样的问题。

# tridion - 发布到特定组件的特定目标失败

> ID：15043493
> 
> 赞同：2
> 
> 时间：2013-02-23T17:38:03.417
> 
> 标签：tridion, tridion-2011, tridion-content-delivery

`Transport failed: Could not transport tcm_0-309224-66560.Content.zip using HTTPS`我们正在使用 Tridion 2011 SP1，在我们的暂存目标上，当我们检查 cd_transport 日志时，一些组件因错误而失败，我们可以看到错误

```
ERROR HTTPSTransportConnector - Unable to execute HTTP POST
java.net.SocketException: Connection reset by peer: socket write error 
```

相同的组件在不同的目标上成功发布。问题的原因可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:13:31.777

可能是传输包的大小太大而被部署者 Web 应用程序拒绝。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T19:51:54.633

我认为当它与大小相关时，您会收到更好的错误消息（可能是错误的 - 您可以检查 cd_deployer_conf.xml 中的大小限制）。

看起来您的连接正在重置。您在 CM 和部署者之间是否有防火墙？您可以从与 CM 在同一台机器上运行的浏览器加载 httpupload 端点吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T11:49:41.713

**验证以下内容：**

1）发布成功的另一个目标在同一台机器上或另一台机器上 - 如果它们在不同的机器上，请验证设置/配置，最重要的是那里的JDK / JRE版本

2) 与系统管理员团队核实是否有一些规则用于扩展您的输出组件演示

3) 验证输出传输包的大小与部署器配置中定义的最大大小限制

4) 使用 fiddler 等工具监控整个发布过程并检查是否有任何提示

5) 我希望您在 TRACE 或 INFO 级别检查您的日志...并且上述错误是唯一的相关信息，日志中没有其他警告或调试级别信息？

# javascript - YUI 中的动画链接

> ID：15043495
> 
> 赞同：1
> 
> 时间：2013-02-23T17:38:17.460
> 
> 标签：javascript, html, yui

```
<div id="demo" class="yui3-module">
<a href="" title="fade out element" class="yui3-remove">Click to animate</a>
</div>
<script src="js/yui-min.js"></script>
<script type="text/javascript">
YUI().use('anim', function(Y) {
var anim = new Y.Anim({
    node: '#demo',
    to: { width: 500, height: 300 }
});
var anim2 = new Y.Anim({
    node: '#demo',
    to: { width: 100, height: 100 }
});

var onClick = function(e) {
    e.preventDefault(); 
    anim.run();
anim2.run(); //how to run anim2 ???
};
Y.one('#demo .yui3-remove').on('click', onClick);
}); 
```

如何在 anim.run 发生后运行下一个 anim2，即作为一个链。有什么简单的方法可以做到这一点。??

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:03:04.327

`end`您可以通过听第一个事件来运行另一个动画。

```
anim.on('end', function () {
  anim2.run();
}); 
```

使用`Transition`. `Anim`您可以调用`node.transition()`并使用回调，而不是创建实例。

```
YUI().use('node', 'transition', function (Y) {
  Y.one('#demo .yui3-remove').on('click', function (e) {
    e.preventDefault();
    Y.one('#demo').transition({ width: 500, height: 300 }, function () {
      this.transition({ width: 100, height: 100 });
    });
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T19:59:30.860

有一个图库模块可以为您执行此操作：http: [//yuilibrary.com/gallery/show/anim-sequence](http://yuilibrary.com/gallery/show/anim-sequence)

# javascript - 从已经定义的函数创建一个闭包？

> ID：15043496
> 
> 赞同：3
> 
> 时间：2013-02-23T17:38:19.527
> 
> 标签：javascript, arrays, sorting, closures

我想扩展 Array.sort() 以接受另一个参数。[这个问题](https://stackoverflow.com/questions/8537602/any-way-to-extend-javascripts-array-sort-method-to-accept-another-parameter)有一个使用闭包的解决方案，所以这段代码有效：

```
var create_comparator = function(c) {
  return function(a,b) { console.log(c); return a-b };
};

arr.sort( create_comparator('test') ); 
```

但是，就我而言，我已经定义了这样的函数：

```
var myComp1 = function(a,b) { console.log(c); return a-b }; 
```

返回预定义函数不起作用：

```
var create_comparator = function(sortfn, c) {
  // Uncaught ReferenceError: c is not defined 
  return sortfn;      
};

var arr = [7, 4, 9, 2, 1];
arr.sort( create_comparator(myComp1, 'test') ); 
```

我认为这是因为`c`在创建原始函数时没有定义。我试图`return function(a,b) { sortfn(a,b); }`创建一个新的闭包，但这也不起作用。

使用这种设置是否有可能为预定义函数提供额外的参数？是否有其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:49:04.663

您的示例并没有真正清楚地说明您在使用其他参数做什么。我仍然会尝试并建议使用部分......比如：

```
var myComp1 = function (c, a, b) { console.log(c); return a-b };
arr.sort(myComp1.bind(null, "test")); 
```

或者，如果您仍想将其抽象为生成器函数：

```
var myComp1 = function (c, a, b) { console.log(c); return a-b };

var create_comparator = function(sortfn, c) {
  return sortfn.bind(null, c);      
}; 
```

编辑：另一种方式！可能是您想要实现的最佳目标。最酷的是，您可以将任意数量的参数*附加*到排序函数，这使得附加参数成为可选参数，因此您也可以将它们用作普通的排序比较器。

```
var myComp1 = function (a, b, c) { if (c) { console.log(c); } return a-b };

var create_comparator = function() {
    var sortfn = arguments[0], 
    partial = Array.prototype.slice.call(arguments, 1);

    return function() {
      var args = Array.prototype.slice.call(arguments).concat(partial);
      return sortfn.apply(null, args);
    }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T17:50:08.147

您当然不能追溯修改以关闭来自不同范围`myComp1`的局部变量；`c`这根本不是闭包的工作方式，也不是局部变量的工作方式。您应该`myComp1`首先正确定义。

但如果你不能这样做，那么有一种解决方案。

因为`myComp1`引用 a`c`不是范围*内*的局部变量，所以它真正引用的是*全局*变量`c`；也就是说，它引用`'c'`全局对象上命名的属性（`window`如果主机是 Web 浏览器）。所以你可以做的是，你可以创建一个包装函数，将一个局部变量复制到全局对象上，然后调用`myComp1`; 像这样的东西：

```
var wrapped_myComp1 = function (a,b,c) {
    window.c = c;
    var ret = myComp1(a,b);
    delete window.c;
    return ret;
}; 
```

这很丑陋，这意味着这个函数是不可重入的（因为每个调用都会覆盖彼此的调用`c`），但它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:59:55.203

您的函数 myComp1 的问题是您的函数尝试使用未定义的全局变量 c。在 JavaScript 中，函数具有词法范围，这意味着函数使用定义它们的范围。而且只有关闭不足以解决您的问题。尝试在闭包中分配 c 变量，如 id 这段代码：

```
 var arr = [1,4,3,5,7,1,2],
        c;//it's a global variable, this is not a good approach. Good approach is change myComp1 definition, if you can.
    var myComp1 = function(a,b) { console.log(c); return a-b };

    var comp = function(prop) {
        c = prop; //this assignment push prop variable to global variable c, that uses in your function
        return myComp1;
    }

console.log(arr.sort(comp('additional_param'))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T18:00:04.877

这将起作用

```
var c = 'test'
var myComp1 = function(a,b) { console.log(c); return a-b };

arr.sort( myComp1 ); 
```

这里闭包定义了 c （但你需要像上面那样定义它，如果你没有定义 c 那么你会得到你得到的错误）。

# html - 直接从屏幕中央的网络服务器显示图像

> ID：15043500
> 
> 赞同：0
> 
> 时间：2013-02-23T17:38:24.303
> 
> 标签：html, image, webserver, alignment, center

我正在从网络服务器加载图像，它加载到左侧对齐。它会自动适应屏幕，它还有一个放大镜图标，可以让我放大图像而无需任何缩放。这很棒，但是我可以将它加载到中心吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:40:31.480

最新的浏览器已经将图像居中，例如最新的 FireFox。

但是，如果程序本身还没有这样做，您就不能强制执行该行为。

# spring - 他们是使用spring mvc生成站点地图和robots txt的现有工具吗

> ID：15043504
> 
> 赞同：3
> 
> 时间：2013-02-23T17:38:40.130
> 
> 标签：spring, spring-mvc, seo, spring-security, robots.txt

我有一个带有安全页面的网站，以及一些公共目录。

它们是基于控制器请求映射及其安全访问级别/请求类型生成站点地图和/或 robots.txt 的内置机制还是现有库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:49:33.047

不，没有生成站点地图和/或 robots.txt 的内置机制或现有库

但是您可以自己构建它：因为可以读取映射。

@see：[如何在视图中显示所有控制器和映射](https://stackoverflow.com/questions/9766800/how-to-show-all-controllers-and-mappings-in-a-view)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T08:59:15.897

如果您正在生成站点地图，您可以使用[Sitemapgen4j](https://code.google.com/p/sitemapgen4j/)库来生成 Java 中的 XML 站点地图。它可以让您快速开始生成有效的 XML 站点地图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T05:37:16.870

我不必为站点地图和robot.txt 使用生成器。我只使用谷歌网站管理员工具。您可以尝试检查一下： [robotstxt generator](http://searchengineland.com/google-offers-robotstxt-generator-13653) and [this](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=183668)

# ios - 我可以在一个应用程序中创建一个 Core Data 对象图，然后从预设状态在另一个应用程序中使用它吗？

> ID：15043505
> 
> 赞同：2
> 
> 时间：2013-02-23T17:38:54.647
> 
> 标签：ios, objective-c, core-data, object-graph

我的应用程序现在有一个包含大约 5,000 个字典的 .plist，在运行时，我用它来创建自定义类的 5,000 个对象。每个都包含一些字符串，一些布尔值等。这是一个相当快的过程，需要几秒钟，但使用 .plist 包含数千个对象有点笨拙。

我将迁移到 Core Data（我以前从未使用过），因此第一步是将 .plist 中的数据获取到这些自定义对象中，然后将它们保存在上下文中。我看过视频之类的，我想我会没事的。

我的第一个问题是：**我可以在一个小的独立应用程序（例如，称为 ObjectMaker）中创建对象图和数据模型，然后将其保存在那里，然后导入 .sqlite 或任何我将数据导出到实际应用程序中的格式正在制作？**从那里，我将执行所有获取请求，进一步编辑和保存数据等。

我的第二个问题是：**是否可以提供用户第一次打开我的应用程序时会得到的对象图的“首次启动状态”（这 5,000 个对象是现成的并且可以访问/查询等？**我'希望应用程序附带 .sqlite 或我在 ObjectMaker 应用程序中导出数据的任何格式，并专门使用它，而不知道 .plist 存在。

非常感谢任何和所有的答案^_^

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:29:08.397

我们经常使用我们的许多应用程序这样做。在开发过程中，我们构建了数据模型，但经常需要导入一堆主数据并执行一些默认的应用程序配置，以达到我们将与产品一起发布的 sqlite 数据库的“初始状态”。

在应用程序委托中，我们有一个#define（或变量），您可以使用它来切换“数据库创建和导入”模式。在运行创建模式时，我们删除任何现有的 .sqlite 文件，重新初始化 Core Data 堆栈，然后运行导入例程将我们的 .plist 和 .csv 数据转换为所需的 Core Data 对象。

我们使用模拟器并构建和运行。导入数据并配置应用程序的默认选项后，我们导航到包含您正在执行的应用程序的模拟器文件夹，然后复制数据库并将其放回项目文件中。

当“数据库创建和导入”模式未启用时，它首先检查是否在正确的位置有数据库。如果没有，它会将默认数据库从主包复制到设备上的正确位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T18:24:14.617

> 我的第一个问题是：我可以在一个小的独立应用程序（例如，称为 ObjectMaker）中创建对象图和数据模型，然后将其保存在那里，然后导入 .sqlite 或任何我将数据导出到实际应用程序中的格式正在制作？从那里，我将执行所有获取请求，进一步编辑和保存数据等。

当然。您可以在您的 ObjectMaker 应用程序中创建您的 sql 存储。完成后，您可以在应用程序的主包中获取该商店并复制（您必须自己做）。

启动时，应用程序会将商店复制到主文件夹中，如下所示。持久存储必须指向该文件夹存储。

```
NSString *storePath = [[self applicationDocumentsDirectory] 
    stringByAppendingPathComponent: @"yourStore.sqlite"];
NSURL *storeUrl = [NSURL fileURLWithPath:storePath];

NSFileManager *fileManager = [NSFileManager defaultManager];
if (![fileManager fileExistsAtPath:storePath]) {
    NSString *defaultStorePath = [[NSBundle mainBundle] 
        pathForResource:@"yourStore" ofType:@"sqlite"];
    if (defaultStorePath) {
        [fileManager copyItemAtPath:defaultStorePath toPath:storePath error:NULL];
    }
} 
```

> 我的第二个问题是：是否可以提供用户第一次打开我的应用程序时会得到的对象图的“首次启动状态”（这 5,000 个对象是现成的并且可以访问/查询等？我'希望应用程序附带 .sqlite 或我在 ObjectMaker 应用程序中导出数据的任何格式，并专门使用它，而不知道 .plist 存在。

关于这个问题，我不明白你的目标，但我会尝试提供一些提示。首先，我不太确定用户是否会一次性使用 5,000 个对象。因此，您可以显示一组执行临时查询 ( `NSFetchRequest`) 以仅在请求时显示它们。此外，如果您需要通过表格显示对象，我真的建议使用`NSFetchedResultsController`. 这门课就是为了这个。它允许对数据进行更多控制，并让 Core Data 为您进行内存管理。例如，它允许指定要检索的对象数量（比如 10 个）。滚动表格，将获取其他 10 个对象，依此类推...

希望有帮助。如果你需要别的东西，请告诉我。

# php - 许多文件的PHP文件时间

> ID：15043506
> 
> 赞同：0
> 
> 时间：2013-02-23T17:38:57.733
> 
> 标签：php, version, filemtime

我正在尝试确定许多不同文件的文件时间，因为我想获取这些文件的版本。添加（+）文件的文件时间是一个好机会吗？这样做会给我一个非常高的数字（6807745113）。我会用这个达到任何溢出/上限还是安全？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:46:31.130

filemtime 不是相对于 1970 年的秒数吗？如果您只是要相对于今天（或某个固定时间点）的总年龄，您必须从每个时间戳中减去当前时间戳。只要不是数千个非常旧的文件，就可以了。否则，不，您可能不应该将原始纪元时间戳加在一起。

# node.js - nodejs中的自定义模块返回“找不到模块”错误

> ID：15043507
> 
> 赞同：0
> 
> 时间：2013-02-23T17:38:59.410
> 
> 标签：node.js, module, express

我一直在使用 express 和 nodejs 在 cloud9 ide 中编写一个小原型应用程序。

我打算将一些代码重新组织到几个自定义模块中，但是当我尝试要求它们时，我得到一个错误“找不到模块'./lib'

lib 文件夹位于我的站点目录的根目录中。我在那里有 1 个文件“test.js”，它有一个简单的演示来尝试让它工作。

```
exports.test = function(){
  return 'hello world';  
}; 
```

如果我在 app.js 中放入 require('./lib') 或 require('./lib/test') 并不重要，它总是会抛出相同的错误。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T19:21:06.380

两个潜在的错误：

1- require() 查找名为 index.js 的文件。所以尝试将 test.js 重命名为 index.js 可能会奏效。

2-你的路径是错误的。lib 文件夹是否与调用 require() 的文件位于同一文件夹中？

# sql - 为估算计划绑定参数与内联值

> ID：15043513
> 
> 赞同：2
> 
> 时间：2013-02-23T17:39:33.563
> 
> 标签：sql, sql-server, performance, sql-server-2008, database-performance

我想知道在 SQL 查询上使用绑定参数来构建执行计划。

在许多情况下，开发人员编写动态 SQL 查询并将适当的值放入查询中。

在阅读本文时，[http://use-the-index-luke.com/sql/where-clause/bind-parameters](http://use-the-index-luke.com/sql/where-clause/bind-parameters)我觉得使用绑定参数会因为使用相同的执行计划而提高性能。

这是在 SP 中构造的动态查询中的绑定参数示例。

```
CREATE Procedure GetEmployee 
AS
(
@eName NVARCHAR(100),
@eDept NVARCHAR(50)
)

BEGIN
Declare @sql NVarchar(MAX)
DECLARE @params NVARCHAR(MAX)

 SELECT @params = N'@name nvarchar(100), ' +  
                    N'@dept nvarchar(50) ' 

SET @sql='Select EmpId, Name from Employee where Name=@name AND Department=@dept'

sp_executesql @sql, @params, @eName, @eDept

END 
```

**与 WHERE Name='''+@eName+''' 相比，这如何真正提高性能？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:57:05.703

正如文章所建议的，SQL Server 查询优化器*可以*为 sp_execute_sql 使用缓存的执行计划。该[文档](http://msdn.microsoft.com/en-us/library/ms175170%28v=sql.105%29.aspx)非常明确。与 just 相比的优点`execute`是查询更有可能匹配计划中的某些内容。

关于计划本身的说明。查询计划是在第一次使用参数运行查询时生成的。这是放置在缓存中的内容。对于像您这样的简单查询，查询计划应该适合后续调用。但是，即使在这种情况下，您也可能会遇到从表中的 10 行和一个索引开始的情况，并且查询计划决定扫描表。当您添加另外 100,000 行时，它仍然想要进行扫描（直到您重新启动服务器或以其他方式清空缓存），因为那是缓存计划。

但是，在其他情况下，参数的值可能会影响查询计划。因此，每次重新编译查询可能不是一个坏主意。如果查询要运行任意时间（秒），那么编译开销可能很小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:53:50.993

绑定变量的优点是，RDBMS

1.  不需要解析/编译语句和

2.  不需要一次又一次地评估执行计划。

通常会缓存一定数量的语句和执行计划，因此可以节省一些时间。然而：如果你用成千上万个类似的语句填满这个缓存，它就不会再有太大帮助了。

所以最后语句本身的核心执行不会更快 - 只有周围的事情（解析，编译，创建执行计划）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T20:46:35.353

与 WHERE Name='''+@eName+''' 相比，这如何真正提高性能？

简单地建立在其他人所说的基础上。sp_executesql 的计划缓存中的内容将是适用于调用该方法的任何人的计划。它将有一个变量的占位符并在运行时应用它们。它不需要编制新计划，因此您可以节省成本。

此外，这可能是一个很大的区别，对于前者，将为传入的*所有*变量组合生成**1 个**计划。对于后者，您将为*每个*变量组合获得 1 个查询计划。它*可能*在逻辑上应用相同的 Index Seek、Sort 等运算符，但不是计划中的占位符，而是 eName = 'Bob' 的一个计划，eName = 'William' 的一个计划，等等。

 ***拥有这些独特计划的缺点是会占用其他计划缓存的可用内存。计划不在缓存中？必须编译，哎呀，计划缓存已满，是时候选择最近最少使用的计划并将其踢出。下一个查询进来了，它需要我们刚刚装箱的计划，并且计划缓存交换循环继续进行。

关于至少 .NET 方面的最后一件事要注意。在链接的示例中，这行代码`cmd.Parameters.AddWithValue("@subsidiary_id", subsidiary_id);`很好，因为它处理的是整数。整数是整数是整数。但是，如果您要内联上面的查询，则参数`@eName`和`@eDepartment`可能会导致不同的查询计划，因为该`AddWithValue`方法会进行一些猜测，并且可能无法为您的变量提供一致的定义。它可能决定一个是 nvarchar(30)，下一个是 nvarchar(29)，现在你有两个计划。通过使用存储过程，您可以减轻这种担忧，因为参数定义了大小并且不涉及猜测。***

# sql - SQL插入表给我外键错误

> ID：15043514
> 
> 赞同：0
> 
> 时间：2013-02-23T17:39:48.490
> 
> 标签：sql, constraints

尝试在这样的表中创建一个条目：

```
insert into movie(mvnumb, mvtitle, yearmade, mvtype, noms, awrds, dirnumb)
values ('10111', 'Something' , '2012', 'Action', '5', '2', '10079') 
```

我得到这个错误

> *消息 547，级别 16，状态 0，第 1 行
> INSERT 语句与 FOREIGN KEY 约束“FK_movie_director”冲突。冲突发生在数据库“Assign1W13”、表“dbo.director”、列“dirnumb”中。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:43:10.603

这意味着director id 10079（列dirnumb）不存在于director 表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:44:16.610

如果导演表中存在该导演编号，则只能使用该编号，因此请先检查该编号。如果确实存在，请尝试去掉导演编号周围的引号。我假设您正在使用基于错误消息的 SQL Server，所以引号应该不是问题，但是对于某些 DB，它们可能会导致数字问题。

# perl - 如何分别制作我的输出数组以仅获取我的输出的一部分

> ID：15043515
> 
> 赞同：-1
> 
> 时间：2013-02-23T17:40:00.427
> 
> 标签：perl

我正在使用数组中的 foreach 循环获取文件的输出。

获取所有内容后，如何仅将文件的一部分提取到新数组中。

这是我的代码

```
foreach (@genetic_codes) {
  chomp;
  my @genetic_codes = split(':', $_);
  if (@genetic_codes != 5) { # error on this line next;
  }
  my $amino_acid = join('","', split(/,/, $genetic_codes[4]));
  print "$genetic_codes[2]=> [$genetic_codes[0],$genetic_codes[1],[$amino_acid]],\n";
} 
```

这是我的正确输出。

```
"M"=> ["Methionine","Met",["ATG"]],
"F"=> ["Phenylalanine","Phe",["TTT"," TTC"]],
"P"=> ["Proline","Pro",["CCT"," CCC"," CCA"," CCG"]],
"S"=> ["Serine","Ser",["TCT"," TCC"," TCA"," TCG"," AGT"," AGC"]],
"T"=> ["Threonine","Thr",["ACT"," ACC"," ACA"," ACG"]],
"W"=> ["Tryptophan","Trp",["TGG"]], 
```

现在我需要获取所有密码子并将它们放入一个变量`Z`中以消除重复项。

我需要单独制作一个foreach循环吗？

我完全迷路了，请帮助。我需要我的最后一个输出----

```
"Z"=>["ACT","AGT",---------------SO ON]], 
```

上面一行的所有三个字母都在一个变量中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:53:44.390

您需要更改代码，以便将密码子存储在每个输出行的单独数组中。然后，您可以逐行建立哈希。

我还修复了输入的处理，以便您的数据正确。

由于您没有提供任何示例输入数据，因此我制作了一些我认为 k 是正确的东西，并产生了您在问题中显示的输出。

```
use strict;
use warnings;

my %codons;

while (<DATA>) {
  chomp;
  my @genetic_codes = split /:/;
  @genetic_codes == 5 or die "Invalid data found";
  my @amino_acids = $genetic_codes[4] =~ /[ACTG]+/g;
  printf "%s => [%s, %s, [%s]],\n",
      @genetic_codes[2, 0, 1],
      join ', ', map qq{"$_"}, @amino_acids;#
  $codons{$_}++ for @amino_acids;
}
printf qq{"%s" => [%s]\n}, 'Z', join ', ', map qq{"$_"}, sort keys %codons;

__DATA__
"Methionine":"Met":"M":"":"ATG"
"Phenylalanine":"Phe":"F":"":"TTT, TTC"
"Proline":"Pro":"P":"":"CCT, CCC, CCA, CCG"
"Serine":"Ser":"S":"":"TCT, TCC, TCA, TCG, AGT, AGC"
"Threonine":"Thr":"T":"":"ACT, ACC, ACA, ACG"
"Tryptophan":"Trp":"W":"":"TGG" 
```

**输出**

```
"M" => ["Methionine", "Met", ["ATG"]],
"F" => ["Phenylalanine", "Phe", ["TTT", "TTC"]],
"P" => ["Proline", "Pro", ["CCT", "CCC", "CCA", "CCG"]],
"S" => ["Serine", "Ser", ["TCT", "TCC", "TCA", "TCG", "AGT", "AGC"]],
"T" => ["Threonine", "Thr", ["ACT", "ACC", "ACA", "ACG"]],
"W" => ["Tryptophan", "Trp", ["TGG"]],
"Z" => ["ACA", "ACC", "ACG", "ACT", "AGC", "AGT", "ATG", "CCA", "CCC", "CCG", "CCT", "TCA", "TCC", "TCG", "TCT", "TGG", "TTC", "TTT"] 
```

# c# - 在客户端和服务器上重用 DTO

> ID：15043517
> 
> 赞同：1
> 
> 时间：2013-02-23T17:40:15.537
> 
> 标签：c#, asp.net, web-services, soap

我在一个项目中有一个 DTO 库，我在提供使用它们的 SOAP API 的网站和使用它们的客户端中都引用了它。重用这些对象的用例是它们中的一些包含帮助方法和属性，使它们的使用更容易。

问题是，当我在服务器端公开我的 API 时，会自动生成一个 wsdl 文件。在客户端应用程序中，我照常添加 Web 引用，然后 Visual Studio 在新命名空间中生成*一组全新的 DTO*。当您无权访问底层服务器代码时，这通常很好，但在这种情况下我可以。目前我正在使用一种相当复杂的方法，使用反射和类型检查将自动生成的类转换为我自己的自定义对象，反之亦然。

我的问题是：有没有办法让 Visual Studio 使用我的库中的对象，而不是从 wsdl 自动生成它自己的对象？

# ruby-on-rails - RSpec - 如何测试数据库视图？

> ID：15043518
> 
> 赞同：0
> 
> 时间：2013-02-23T17:40:21.153
> 
> 标签：ruby-on-rails, ruby, activerecord, rspec, factory-bot

我有一个支持数据库视图的类。我正在使用 FactoryGirl 来尝试测试它，所以我完成了创建`user`实例的正常步骤，如下所示：

```
before(:each) do
  @user = FactoryGirl.create(:user)
end 
```

然后我检查观看次数：

```
Balance.all.count   # It is returning 0, it should be returning 1 
```

我对数据库视图的理​​解是，直到事务提交到数据库之后它们才会更新。我有使用 NHibernate 的背景，为了从数据库中获取更新的值，我会执行以下操作：

```
Session.Flush(); 
```

这将允许我查询数据库视图并获取更新的值，但稍后仍会回滚或提交我的事务。

有没有办法在 ActiveRecord 中做到这一点？或者有没有办法将我的更改提交到数据库并清理它？我不想关闭所有测试的事务，只是能够测试这个特定的类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:02:06.600

`let!(:user) { FactoryGirl.create(:user) }`

您可能还想查看`database_cleaner`宝石。

# sql-server - 执行原始 sql 命令始终需要 sql management studio 中的模式 + 表名

> ID：15043521
> 
> 赞同：0
> 
> 时间：2013-02-23T17:40:35.790
> 
> 标签：sql-server, entity-framework, entity, sql-server-2012, ssms

当我执行如下 SQL 语句时：

```
Delete From [dbo].[User] 
```

这很好用。

当我也在我的 SQL Server 2012 Management Studio 中执行此语句时：

```
Delete From User 
```

这没用。这在以前的管理工作室版本中从来都不是问题，但为什么现在呢？

该数据库是由实体框架代码优先方法创建的。

# ruby-on-rails - 如何在rails的命名空间内生成控制器

> ID：15043524
> 
> 赞同：183
> 
> 时间：2013-02-23T17:41:09.193
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我`admin`在控制器中有命名空间，我想在`admin`文件夹中生成一个控制器。我怎样才能用 Rails 命令做到这一点？

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2013-02-23T17:45:17.767

`rails g controller admin/users`如果您想要命名空间`users`内的控制器，请尝试`admin`。当然，`users`可以使用您想要的任何控制器名称进行交换。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2013-02-23T17:55:38.627

使用这个命令..

`rails generate controller namespace_name/controller_name`

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-03-02T11:47:39.573

如果你想生成它：

```
rails generate controller namespace_name/controller_name 
```

如果您想使用以下方法回滚此步骤：

```
rails destroy controller namespace_name/controller_name 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-03-09T09:16:09.740

在你的情况下，它将是

```
$ rails g controller admin/controller_name 
```

如果我们有一个像这样的应用结构

*   ---控制器
*   --api
*   -v1

并想生成控制器，请执行以下操作：

```
$ rails g controller api/v1/controller_name 
```

一般来说

```
$ rails g controller namespace_1/namespace_2/...../controller_name 
```

# c++ - 单个函数的两个可变参数模板？

> ID：15043527
> 
> 赞同：11
> 
> 时间：2013-02-23T17:41:23.343
> 
> 标签：c++, templates, c++11, variadic-templates, variadic-functions

在 C++11 中，一个函数可以有两个可变参数模板吗？

如果没有，是否有一个技巧来写这样的东西：

```
template <class... Types, class... Args> 
void f(const std::tuple<Types...>& t, Args&&... args) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-23T17:43:28.330

这是完全合法的：

```
#include <tuple>

using namespace std;

template <class... Types, class... Args>
void f(const std::tuple<Types...>& t, Args&&... args)
{
    // Whatever...
}

int main()
{
    std::tuple<int, double, bool> t(42, 3.14, false);
    f(t, "hello", true, 42, 1.0);

    return 0;
} 
```

# google-app-engine - “消息”：尝试通过 api-explorer 插入实体时出现“java.lang.NullPointerException”

> ID：15043532
> 
> 赞同：2
> 
> 时间：2013-02-23T17:42:06.923
> 
> 标签：google-app-engine, google-cloud-datastore, google-api-client, google-cloud-endpoints

我是 appEngine 的新手，我尝试了我的项目所必需的简单事情：我创建了简单的 JDO 图像类：

```
@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class Image {

@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
private Key key;

@Persistent
private Blob image;

@Persistent
private String type;

@Persistent
private String description;

public Key getKey() {
    return key;
}

public void setKey(Key key) {
    this.key = key;
}

public Blob getImage() {
    return image;
}

public void setImage(URL url) throws IOException {

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                url.openStream()));

        String line;
        StringBuffer stbf = new StringBuffer();

        while ((line = reader.readLine()) != null) {
            stbf.append(line);
        }
        image = new Blob(stbf.toString().getBytes());
        reader.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

成功创建并部署到 AppEngine 的端点。当我尝试通过 google-api-explorer [https://developers.google.com/apis-explorer/?base=https://my-application.appspot.com/_ah/api#s/](https://developers.google.com/apis-explorer/?base=https://my-application.appspot.com/_ah/api#s/)将简单对象插入数据存储区时，仅使用 id 和 appID 参数链接到图像和密钥，我收到以下错误：

```
503 Service Unavailable

- Show headers -

{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "backendError",
    "message": "java.lang.NullPointerException"
   }
  ],
  "code": 503,
  "message": "java.lang.NullPointerException"
 }
} 
```

当我将键从 Long 类型更改为 by 时，查询正确执行，并且我在数据存储区中看到了新实体。

除此之外，在文档中说“如果编码的键字段为空，则在保存对象时该字段将填充系统生成的键”。但似乎没有钥匙就不能接受？

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T22:42:05.697

看看生成的方法 containsImage：

标准生成的代码不检查 getKey() 是否返回 null。您需要包括以下内容：

```
if (image.getKey() == null) {
            return false;
} 
```

在它执行 getObjectById 之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T06:29:47.757

我一直在尝试解决这个问题。建议的答案是正确的。我想补充一点：这在 GAE SDK 或 Eclipse 插件中没有固定。即仍然没有检查空键。谢谢你的提示！抱歉，我无法添加评论，不知道为什么。

# java - ExternalContext.getRequestLocale() 的实现

> ID：15043536
> 
> 赞同：0
> 
> 时间：2013-02-23T17:42:30.813
> 
> 标签：java, jsf, jsf-2, implementation

出于好奇，在我的 JSF 2.0 应用程序中使用 Locale 时，我尝试`getRequestLocale()`阅读`ExternalContext`.

`javax.faces.context.ExternalContext`是一个抽象类。我发现

*   `com.sun.faces.context.ExternalContextImpl`
*   `javax.faces.context.ExternalContextWrapper`
*   `com.sun.faces.config.InitFacesContext$ServletContextAdapter`

扩展这个类。

其中该类的该方法的实现`ServletContextAdapter`返回null。所以我想它对我没有用。

该方法在中的实现`ExternalContextImpl`是：

```
public Locale getRequestLocale(){
    return this.request.getLocale();
} 
```

在`ExternalContextWrapper`是：

```
public Locale getRequestLocale() {
    return getWrapped().getRequestLocale();
} 
```

在实现中由`ExternalContextWrapper`返回`getWrapped()`一个实例`ExternalContext`。我想它可能实际上是`ExternalContextImpl`对象。

而在这个方法的实现中`ExternalContextImpl` `this.request`其实是`javax.servlet.ServletRequest`.

现在`ServletRequest`是一个接口，由

*   `javax.servlet.ServletRequestWrapper`并由
*   `javax.servlet.http.HttpServletRequest`.

我没有发现这个方法在`HttpServletRequest`和`ServletRequestWrapper`实现中和`ExternalContextImpl`.

现在我在这里迷失了方向。我无法找到在哪个类中可以找到实际的实现。如果有人知道，请帮助我理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:14:17.670

`HttpServletRequest`extends`ServletRequest`提供了`getLocale()`方法。

请参阅此处的 javadocs：

[http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getLocale()](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getLocale())

javadocs说：

> 根据 Accept-Language 标头返回客户端将接受内容的首选语言环境。如果客户端请求未提供 Accept-Language 标头，则此方法返回服务器的默认语言环境。

我希望这有帮助 ：）

# mysql - Mysql如何按最高计数列排序到最低

> ID：15043542
> 
> 赞同：1
> 
> 时间：2013-02-23T17:42:56.983
> 
> 标签：mysql, sql

我有表格作为与以下值的链接

```
++++++++++++++++++++++++++
+ company_id +  industry +
++++++++++++++++++++++++++
+     1      +    a      +
+     2      +    b      +
+     3      +    a      +
+     4      +    c      +
+     5      +    a      +
+     6      +    c      +
+     7      +    a      +
++++++++++++++++++++++++++ 
```

a 计数为 4，c 计数为 2，b 计数为 1

我希望返回查询

```
++++++++++++++++++++++++++
+ company_id +  industry +
++++++++++++++++++++++++++
+     1      +    a      +
+     3      +    a      +
+     5      +    a      +
+     7      +    a      +
+     4      +    c      +
+     6      +    c      +
+     2      +    b      +
++++++++++++++++++++++++++ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T17:44:41.210

下面的查询使用一个子查询，它分别计算每个`industry`. 然后它的结果是在原始表上再次加入并按子查询的总数对记录进行排序。

```
SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT industry, COUNT(*) totalCount
            FROM    tableName
            GROUP BY industry
        ) b ON a.industry = b.industry
ORDER BY b.totalCount DESC, a.company_ID ASC 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/b1038/1)

要获得更快的性能，请添加`INDEX`on 列`industry`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:29:06.463

你也可以试试这个。它将每个行业作为一个群体来计算。然后按该数字分组。（SQLFIDDLE 是非常方便的工具）

[演示](http://www.sqlfiddle.com/#!2/e0b56/3)：

```
select a.company_id, a.industry,
      (select count(*) as cnt from tbl b
       where a.industry = b.industry) as order_by
 from tbl a
 order by order_by desc; 
```

# ios - ios6 自定义 segue 和 ViewDidAppear

> ID：15043547
> 
> 赞同：0
> 
> 时间：2013-02-23T17:43:20.137
> 
> 标签：ios, segue, viewdidload

这可能是一个显而易见的问题，但我无法找出解决这个问题的正确方法。我有一个自定义的 segue 类，它的工作原理是它成功地转换到目标控制器。在目标控制器中，我需要获取一些子视图的位置并将它们保存以备后用。我正在 ViewDidAppear 中执行此操作。此代码在使用标准 segue 时有效，但在使用我的自定义 segue 时位置解析为 {0, 0}。但是，我可以对子视图做其他事情，比如画一个边框。

目标视图的代码：

```
-(void)viewDidAppear:(BOOL)animated
{
   [super viewDidAppear:animated];

   for (UIView * view in self.videos) {
       [self.origCenter setObject:[NSValue valueWithCGPoint:[view.superview convertPoint:view.center toView:view.superview]]
                        forKey:[NSValue valueWithNonretainedObject:view]];
    view.layer.borderColor = [UIColor redColor].CGColor;
    view.layer.borderWidth = 3.0f;
   }
} 
```

自定义segue的代码：

```
-(void)perform {

    UIViewController *sourceViewController = (UIViewController*)[self sourceViewController];
    UIViewController *destinationController = (UIViewController*)[self destinationViewController];
    [sourceViewController.view addSubview:destinationController.view];

    CATransition* transition = [CATransition animation];
    transition.duration = .25;
    transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    transition.type = kCATransitionPush; 
    transition.subtype = kCATransitionFromRight; 

    [sourceViewController.navigationController.view.layer addAnimation:transition forKey:kCATransition];

    [[self sourceViewController] presentModalViewController:[self destinationViewController] animated:NO];

} 
```

# groovy - 如何使用 Groovy DOMBuilder 在带有 CDATA 的 KML 中查找元素？

> ID：15043557
> 
> 赞同：0
> 
> 时间：2013-02-23T17:44:31.290
> 
> 标签：groovy, kml, cdata

我正在使用 Groovy 1.8.6 解析在描述元素中具有 CDATA 的 KML 文件并返回父（即地标）元素。KML 如下所示：

```
 <Placemark>
    <description><![CDATA[
      ID=SVM10<br>
    ]]></description>
    </Placemark> 
```

并将作为第一个参数输入到 Groovy 代码中，如下所示：

```
 def reader = new FileReader(args[0])
    def doc = DOMBuilder.parse(reader)
    def content = doc.documentElement

    use (DOMCategory) {
      def point = content.Document.Placemark.findAll{ it.text().contains('SVM') }
      println point.size()
    } 
```

但它显示 0 - 即没有找到记录。如何修改代码以便它可以在 CDATA 括号中找到内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T10:34:28.343

不知道为什么您的代码不起作用，但您可以使用 XPath 来做同样的事情：

```
package groovyxml

import groovy.xml.DOMBuilder
import javax.xml.xpath.*

String source = """
<Placemark>
    <description>oo<![CDATA[
      ID=SVM10<br>
    ]]>aa</description>
    </Placemark>
    """

    def reader = new StringReader(source)
    def doc = DOMBuilder.parse(reader)
    def xpath = XPathFactory.newInstance().newXPath()
    def point = xpath.evaluate( 
      "/Placemark/description[contains(text(), 'SVM')]", 
      doc, 
      XPathConstants.NODESET )
    println point.length 
```

...打印 1。

# networking - 虚拟机之间的通信：创建命名管道？

> ID：15043559
> 
> 赞同：1
> 
> 时间：2013-02-23T17:44:40.563
> 
> 标签：networking, named-pipes, identifier, vmware-workstation

使用最新版本的 VMware：

尝试在两台虚拟机之间创建连接（一台使用 Windows 操作系统，另一台使用 Linux 操作系统）

![vmware 连接](../Images/57443cdf45385e8b442e01cfe786f141.png)

我的问题很简单：如何创建对其他虚拟机的引用？com_1 是默认管道名称，但显然不会专门指我希望连接的 Linux 操作系统机器。是否有一些可以在 Linux 中使用的终端代码将其识别为命名管道的另一端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T15:49:04.060

如果您选择了输出到命名管道，请配置命名管道。

a) （Windows 主机）使用默认管道名称，或键入另一个管道名称。管道名称必须以 \.\pipe\ 开头，并且在服务器和客户端上必须相同。例如：\.\pipe\namedpipe

b) （Linux 主机）在第一个文本框中键入 /tmp/socket 或另一个 UNIX 套接字名称。服务器和客户端的管道名称必须相同。

c) 要将调试信息发送到主机系统上的应用程序，请从第一个下拉菜单中选择此端是服务器，然后从第二个下拉菜单中选择另一端是应用程序。

d) 要将调试信息发送到另一个虚拟机，请从第一个下拉菜单中选择此端是服务器，从第二个下拉菜单中选择另一端是虚拟机。

e) 要在虚拟机开机时将端口连接到虚拟机，请选择开机时连接。

f) 单击完成将虚拟串行端口添加到虚拟机。

g) （可选）在 Hardware 选项卡上，选择新的串行端口，选择 Yield CPU on poll，然后单击 OK。

如果您使用通过串行连接进行通信的调试工具，此选项很有用。如果来宾操作系统中的串行端口正在轮询模式而不是中断模式下使用，您可能会注意到性能问题。如果虚拟机尝试执行的唯一任务是轮询虚拟串行端口，此选项会强制虚拟机让出处理器时间。下一步做什么 如果您在两个虚拟机之间建立连接，则第一个虚拟机被设置为服务器。对第二个虚拟机重复此过程，但通过在配置命名管道时选择“此端是客户端”将其设置为客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:15:13.020

看看[http://communities.vmware.com/thread/214146](http://communities.vmware.com/thread/214146)

可能您只需要添加以下内容：

```
serial0.present = "TRUE"
serial0.fileType = "pipe"
serial0.fileName = "/tmp/com_1" 
```

到 Linux 操作系统 .vmx 文件。

# c# - 使用后台运行的 WebService 登录

> ID：15043570
> 
> 赞同：0
> 
> 时间：2013-02-23T17:45:22.183
> 
> 标签：c#, multithreading, web-services, asynchronous, login

我有一个验证用户的 WebService。但在您收到验证之前，Windows 会指责该程序没有响应。我已经尝试过线程，异步并且没有成功。当他连接到网络服务时，屏幕上会显示一条连接消息。

```
label1.Text = "Connecting";
Service.Service1 ws = new Service.Service1(); //start WebService
bool login = ws.login(username, password); //Validate login
if (login) {... //If login is true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:46:52.247

> 我试过用线程，

您还没有真正展示您尝试过的内容，因此很难判断您的代码可能有什么问题。如果这是一个桌面应用程序，您可以考虑使用[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx).

例如：

```
private void LoginButtonClick(object sender, EventArgs e)
{
    label1.Text = "Connecting";
    var bw = new BackgroundWorker();
    bw.DoWork += Login;
    bw.RunWorkerCompleted += LoginCompleted;
    bw.RunWorkerAsync();
}

private void Login(object sender, DoWorkEventArgs e)
{
    Service.Service1 ws = new Service.Service1();
    bool success = = ws.login(username, password);
    e.Result = success;
}

private LoginCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    bool success = (bool)e.Result;
    if (success)
    {
        label1.Text = "You have successfully logged in";
    }
    else
    {
        label1.Text = "Wrong username and password";
    }
} 
```

在桌面应用程序中使用后台线程时也要小心。你应该确保你永远不会在这个后台线程中访问你的 UI 控件。这应该始终在主 UI 线程上完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:57:11.543

Service1.Service 是否有“Beginlogin”/“Endlogin”方法？通常，当您添加对 WSDL 的引用时，此异步版本也会自动为您创建......

如果是，则使用此方法；它比旋转一个单独的线程要干净得多。请参阅[http://www.codeproject.com/Articles/2476/Asynchronous-Communication-with-NET-WebServices](http://www.codeproject.com/Articles/2476/Asynchronous-Communication-with-NET-WebServices)了解如何使用它们的好例子。

# c# - Winforms中的WPF控件不起作用？

> ID：15043575
> 
> 赞同：1
> 
> 时间：2013-02-23T17:45:53.353
> 
> 标签：c#, .net, visual-studio-2012

我有一个 winforms 应用程序，我想在这个应用程序中添加一个 WPF 复选框，所以我按照以下步骤操作：

1-右键单击项目名称，然后选择**添加->用户控件**
2-我从列表中选择**用户控件 (WPF)**
3-我向 WPF 设计器添加一个复选框
4-我构建应用程序

问题：将**ElementHost**添加到我的 Winforms 应用程序并展开 Child 属性后，我没有看到任何控件，只有一条消息说**（添加新的或现有的 WPF 控件以开始）**

我做错了什么？

**编辑：**我也尝试添加对**WindowsFormsIntegration**的引用，但结果相同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-06T20:27:39.967

当您构建 WPF 用户控件时，该控件将列在工具箱中。将控件拖动到元素宿主。

# c# - 如何只允许 DLL 在 DLL 所在的目录中创建/读取/更新/删除文件

> ID：15043581
> 
> 赞同：1
> 
> 时间：2013-02-23T17:46:35.707
> 
> 标签：c#, dll, sandbox

我有几个文件夹，每个文件夹都包含一些 .DLL 文件。DLL 可以执行，我必须禁止该 DLL 在其自己的文件夹之外执行 CRUD 操作。

但是 DLL 可以执行它需要的任何保存操作，只要它位于 DLL 所在的同一文件夹中。

例如：

//这段代码可以成功执行

```
public static void Create()
{
 string path = Directory.GetCurrentDirectory() + "\\file.txt";
 File.Create(path);
} 
```

//但是我必须禁止执行这段代码

```
public static void Create()
{
File.Create("../file.txt");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:59:06.037

.NET 具有内置的[安全功能](http://msdn.microsoft.com/en-us/library/bb763046.aspx)，可以完全按照您的意愿进行操作。您需要做的是[将安全上下文应用到 DLL 的 AppDomain 并限制它可以访问的内容](http://msdn.microsoft.com/en-us/library/bb763046.aspx#exampleToggle)。

做你想做的事情，我最感兴趣的可能是 [`FileIOPermission`](http://msdn.microsoft.com/en-us/library/6485ct6t.aspx). 它将允许您限制 DLL 仅访问加载 DLL 的文件夹。如果您有多个 DLL，您可能需要创建多个 AppDomain 或允许所有 DLL 访问彼此的文件夹（但不能访问系统上的任何其他位置）。

如果可以修改 DLL，使其不再需要写入自己的文件夹，则可以通过要求他们读取和写入[独立存储](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.aspx)来使您自己更轻松，那么无论从哪里加载 DLL 都无关紧要，以防万一发生是与 DLL 位于同一文件夹中的其他敏感文件。

* * *

要考虑的一件事是，最好完全不授予 DLL 权限，只授予它您想要做的事情，因为它可能会使用其他事情来绕过您的限制。例如：如果他们在 Windows 中 P\Invoke 对 API 的调用而不是通过 .NET 的对象，`FileIOPermission`则不会停止调用。`FileOpen``Stream`

# matlab - 结果与预期不符

> ID：15043584
> 
> 赞同：0
> 
> 时间：2013-02-23T17:47:10.290
> 
> 标签：matlab, return-value, pixel

我在这篇文章的底部列出了一个函数，它应该返回一个矩阵，该矩阵的大小与一个矩阵的大小相同，`x`其中像素的隶属度`y`=1 到`1`，其他像素到`0`。

但是，当我运行该函数时，我没有得到如下预期的结果（为什么会这样？）：

```
 >> x = [1 4 3; 6 4 3; 6 9 3; 2 4 3; 5 4 0; 5 3 1; 6 4 7];
    >> y = [0 0 1; 1 1 0; 1 1 0; 0 1 1; 0.2 0.8 0.54; 1 1 1; 0 0 0];

>> pixel_val(x,y)

ans =

     0     0     0
     0     0     0
     0     0     0
     0     0     0
     0     0     0
     1     1     1
     0     0     0

        function c = pixel_val(x, y)
        [ii,jj]=find(y==1); 
        x(ii,jj)=1; 
        [ii2,jj2] = find (y~=1); 
        x(ii2,jj2)=0;   
        c = x;
        end 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:30:02.320

`[ii, jj]`返回的索引`find`不是您认为的那样。

您实际上不需要两个输出参数。试试这个

```
ii      = find(y==1); 
x(ii)   = 1; 
ii      = find(y~=1); 
x(ii)   = 0; 
```

或者，更好的是，使用逻辑索引而不是`find`在一行中完成：

```
x(y==1) = 1;
x(y~=1) = 0; 
```

# c++ - 尝试将用户定义类的实例排入队列时出现无限循环（？）

> ID：15043586
> 
> 赞同：0
> 
> 时间：2013-02-23T17:47:33.573
> 
> 标签：c++, linked-list, queue, doubly-linked-list

所以我有一个 Queue 类的双向链表实现（见下文）当我尝试将整数和字符串排入队列时，这个队列类工作得非常好，但由于某种原因，当我尝试将自定义类排入队列时，我的程序永远不会移过`enqueue()`main 中调用的行。我认为这可能是一个无限循环，但我不确定。简而言之，为什么我的`enqueue()`方法适用于 int、char 和字符串等基本数据类型，但不适用于自定义类？

这是我的队列课...

```
//
//  queue.h
//  
//
//  Created by Aaron Mamparo on 2/22/13.
//
//

#ifndef _queue_h
#define _queue_h

#include <iostream>
#include <stdio.h>

using namespace std;

template<class Type>
class Node {
public:
    Type elem;
    Node* next;
    Node* prev;
    Node() {}
    Type Elem() { return elem; }
    Node* Next() { return next; }
    Node* Prev() { return prev; }
};

template<class Type>
class Queue {
    Node<Type> *head;
    Node<Type> *tail;
public:
    Queue();
    ~Queue();
    bool isEmpty();
    int size();
    void enqueue(Type);
    Type dequeue();
    Node<Type>* at(int);
    Type get(int);
};

//default constructor
template<class Type>
Queue<Type>::Queue(){
    head = NULL;
    tail = NULL;
}

//destructor
template<class Type>
Queue<Type>::~Queue(){
    if(!isEmpty()){
        while(head){
            Node<Type> *del = head;
            head = head->next;
            delete[] del;
        }
    }
}

//return true if queue is empty
template<class Type>
bool Queue<Type>::isEmpty(){
    return head == NULL;
}

//return number of elems in queue
template<class Type>
int Queue<Type>::size(){
    int count = 0;
    Node<Type> *temp = head;
    while(temp){
        temp = temp->next;
        count++;
    }
    delete temp;
    return count;
}

//insert elem to back of queue
template<class Type>
void Queue<Type>::enqueue(Type T){
    Node<Type> *newNode = new Node<Type>();
    newNode->elem = T;
    newNode->next = NULL;
    if(head==NULL){
        head = tail = newNode;
        newNode->prev = NULL;
    } else {
        newNode->prev = tail;
        tail->next = newNode;
        tail = newNode;
    }
}

//remove elem from front of queue
template<class Type>
Type Queue<Type>::dequeue(){
    if(isEmpty()){
        cerr << "Error: trying to dequeue from empty queue" << endl;
    } else {
        Type ret = head->Elem();
        Node<Type> *del = head;
        head = head->next;
        delete del;
        return ret;
    }
}

//return a pointer to element at position i
template<class Type>
Node<Type>* Queue<Type>::at(int i){
    if(isEmpty()){
        return '\0';
    } else if (i>size()-1){
        return NULL;
    } else {
        Node<Type> *temp = new Node<Type>();
        temp = head;
        for(int j=0; j<i; j++){
            temp = temp->next;
        }
        return temp;
    }
}

//remove & return element at position i
template<class Type>
Type Queue<Type>::get(int i){
    if(isEmpty()){
        return NULL;
    } else if (i>size()-1){
        return NULL;
    } else {
        Node<Type> *temp = new Node<Type>();
        temp = head;
        for(int j=0; j<i; j++){
            temp = temp->next;
        }
        temp->prev->next = temp->next;
        temp->next->prev = temp->prev;
        Type ret = temp->Elem();
        delete temp;
        return ret;
    }
}
#endif 
```

和我的主要司机不会过去`stateQueue.enqueue(state);`

```
int main() {
    Queue<State> stateQueue;
    State newState = readInput();    //'readInput()' returns an instance of 'State'
    stateQueue.enqueue(newState);

    cout << "DONE" << endl;
    return 0;
} 
```

在上面的代码中，永远不会显示“DONE”......我确定这`readInput()`不是问题，因为当我在`.enqueue()`调用之前插入它时会打印“DONE”......有什么想法吗？

提前致谢

编辑：这是我的类的默认构造函数、复制构造函数、析构函数和重载赋值运算符`State`...

```
State::State(){
    pieces = Queue<Piece>();
    stateHistory = Queue<string>();
    moveHistory = Queue<string>();
    rows = 0;
    cols = 0;
}

//copy constructor
State::State(const State& rhs){
    pieces = rhs.pieces;
    stateHistory = rhs.stateHistory;
    moveHistory = rhs.moveHistory;
    rows = rhs.rows;
    cols = rhs.cols;
}

//destructor
State::~State(){
}

//overloaded assignment operator
State& State::operator=(const State &rhs){
    pieces = rhs.pieces;
    stateHistory = rhs.stateHistory;
    moveHistory = rhs.moveHistory;
    rows = rhs.rows;
    cols = rhs.cols;
    return *this;
} 
```

编辑：这是我刚刚实现的复制构造函数和重载赋值运算符......

```
template<class Type>
Queue<Type>::Queue(const Queue<Type>&Q)
{
    *this = Q;
}

template<class Type>
Queue<Type>& Queue<Type>::operator=(const Queue<Type> &Q)
{
    head = Q.head;
    tail = Q.tail;
    return *this;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:21:32.380

> 简而言之，为什么我的 enqueue() 方法适用于 int、char 和字符串等基本数据类型，但不适用于自定义类？

很难确定，因为您没有提供 State 类的详细信息，但问题似乎存在，您有一个原始指针或其他东西，并且没有实现您在 Queue::enqueue() 中使用的正确赋值运算符方法：

```
newNode->elem = T; 
```

PS您添加了 State 实现（虽然不是定义），但它表明它在内部使用 Queue 类本身。状态赋值使用编译器生成的队列赋值运算符，但队列类有原始指针，所以你得到头指针的双重删除。

一种可能的解决方案是将指向对象的指针存储在队列中，而不是对象本身：

```
typedef boost::shared_ptr<State> StatePtr;
int main() {
    Queue<StatePtr> stateQueue;
    StatePtr newState = readInput();    //'readInput()' now returns a smart pointer to 'State'
    stateQueue.enqueue(newState);

    cout << "DONE" << endl;
    return 0;
} 
```

您将需要相应地更改 readInput() 。另外我建议禁止复制和分配 Queue 对象，因此编译器将帮助您防止此类问题。

# c# - 读取带索引的 ArrayList

> ID：15043587
> 
> 赞同：0
> 
> 时间：2013-02-23T17:47:35.507
> 
> 标签：c#, asp.net

我有一个返回数组列表的类，但是当我阅读它时，我想在页面中写入值。

**我有这堂课：**

```
 public ArrayList users(string table)
        {
            ArrayList list = new ArrayList();
            foreach (DataRow item in com.Execute("select * from " + table + ";").Rows)
            {
                list.Add(item["id"].ToString());
                list.Add(item["mail"].ToString());
                list.Add(item["data"].ToString());
            }

            return list;
        } 
```

**Page_Load**

```
loadUsersNewsletter lun = new loadUsersNewsletter();
String[] myArr = (String[])lun.users("newsletter").ToArray(typeof(string));
foreach (Object o in myArr)
{
    load.Controls.Add(new LiteralControl("<tr><td>" + o + "</td><td>" + o + "</td></tr>"));
    ...
} 
```

如何按索引或其他方式读取值，以免重复值？如果有其他解决方案，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:15:27.007

你应该改变`users`方法，如：

```
public List<string[]> users(string table)
    {
        List<string[]> list = new List<string[]>();
        foreach (DataRow item in com.Execute("select * from " + table + ";").Rows)
        {
            list.Add(new string[]{item["id"].ToString(), item["mail"].ToString(), 
                                                    item["data"].ToString()});
        }

        return list;
    } 
```

和 ：

```
loadUsersNewsletter lun = new loadUsersNewsletter();
List<string[]> myArr = lun.users("newsletter");
foreach (string[] o in myArr)
 {
   load.Controls.Add(new LiteralControl("<tr><td>" + o[0] + "</td><td>" + o[1] 
                                        + "</td><td>" + o[2] + "</td></tr>"));
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:53:59.160

尝试使用`Distinct`，像这样：

```
foreach (var o in myArr.Distinct())
{
    load.Controls.Add(new LiteralControl("<tr><td>" + o + "</td><td>" + o + "</td></tr>"));
    ...
} 
```

或者，如果您正在从数据库加载数据，您可能会考虑在数据库服务器上执行此操作，即，而不是这样：

```
"select * from table" 
```

试试这个 ：

```
"select distinct * from table" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T17:55:27.613

如果要消除重复项，可以使用此代码。

```
String[] myArr = (String[])lun.users("newsletter").ToArray(typeof(string));
    List<string> Content=new List<string>();
    foreach (Object o in myArr)
    {
        if(Content.Contains(o.ToString()))
    continue;
    Content.Add(o.ToString());
        load.Controls.Add(new LiteralControl("<tr><td>" + o + "</td><td>" + o + "</td></tr>"));
        ...
    } 
```

# percentage - 保持行高在 div 中垂直居中，没有固定高度

> ID：15043588
> 
> 赞同：0
> 
> 时间：2013-02-23T17:47:36.640
> 
> 标签：percentage, css

我正在使用标准网格系统开发响应式网站，因此我的 div 不能具有固定高度。话虽如此，我已经设置了一个小提琴文件来*模拟*我的问题。出于美观原因，我在桌面上的最小高度为 50px，并将行高也设置为 50。因此文本在 div 中垂直居中。如果你让窗口更窄，这条线当然最终会断裂。有没有办法在内容中断后保持内容垂直居中，所以看起来很糟糕？

这是一些代码：

```
.box {
    width: 100%;
    min-height: 50px;
    line-height: 50px;
    font-size: 16px;
    color: #fff;
    background-color: #000;
    text-align: center;
} 
```

这是小提琴文件：http: [//jsfiddle.net/HFAew/](http://jsfiddle.net/HFAew/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:58:50.067

你不能在 CSS 中垂直居中，但是你有一些针对不同情况的解决方法。在您的情况下，我建议使用 display: table; 在包装器中：http: [//jsfiddle.net/HFAew/1/](http://jsfiddle.net/HFAew/1/)

```
<div class="verticalCentered">
    <div class="box"> test content test content test content test content</div>
</div> 
```

CSS：

```
.verticalCentered {
    display: table;
    height: 100px; /*variable*/
    width: 100%;
}

.box {
    display: table-cell; /**/
    vertical-align: middle; /**/
    line-height: 50px;
    font-size: 16px;
    color: #fff;
    background-color: #000;
    text-align: center;
} 
```

但请记住，它有时会出现问题。它仅在某些情况下有用。其他方式：[http ://www.vanseodesign.com/css/vertical-centering/](http://www.vanseodesign.com/css/vertical-centering/)

# jquery - 直接调用打印函数的backbone.js视图

> ID：15043590
> 
> 赞同：0
> 
> 时间：2013-02-23T17:47:50.407
> 
> 标签：jquery, backbone.js, underscore.js, backbone-views

我有一个主干视图，在打印按钮上有一个点击事件，如下所示：

```
var updateInvoice=Backbone.View.extend({

 template:_.template(mytemplate),

 events:{'click #print':'print'},

 print:function()
 {
    window.frames['contentIframe'].print();
 }

 }); 
```

现在的问题是，每当实例化上述视图时，都会自动调用打印函数，而无需等待点击事件发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:04:33.597

尝试将函数重命名为非标准名称，例如：

```
var updateInvoice=Backbone.View.extend({

 template:._template(mytemplate),

 events:{'click #print':'printInvoice'},

 printInvoice:function()
 {
    window.frames['contentIframe'].print();
 }

}); 
```

# visual-studio-2010 - Windows Phone 7.1在添加引用服务后没有公开phpsoap服务所需的方法

> ID：15043591
> 
> 赞同：0
> 
> 时间：2013-02-23T17:47:56.473
> 
> 标签：visual-studio-2010, web-services, windows-phone-7.1, webservice-client

我一直在浪费时间，但可能有人可以为此提供一些帮助。我正在尝试使用 nusoap 在 php 上创建一个简单的“Hello world”网络服务。**如果我只使用Windows 窗体的****.NET**标准版，我可以**成功**地实现这一点。首先，我添加了服务引用，然后我就可以毫无问题地使用它们了。都干净。另一方面，我尝试**在 Visual Studio 2010 for windows phone 上做同样的事情，但我一无所获**。向导识别了服务，但是当我尝试使用“Hello”方法时我失败了，因为它不存在。这是某种错误吗？我该如何解决这个问题？真的很烦:S

 ******提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:50:58.277

解决了！

当您定义一个肥皂服务（在服务器端）时，请确保一件事：**使用**字段必须是**文字**。我真的不明白方式，但看起来 WP7 不喜欢编码使用。这是代码示例：

```
$server->register(
                // method name:
                'ProcessSimpleType',         
                // parameter list:
                array('name'=>'xsd:string'), 
                // return value(s):
                array('return'=>'xsd:string'),
                // namespace:
                $namespace,
                // soapaction: (use default)
                false,
                // style: rpc or document
                'rpc',
                // use: encoded or literal
                'literal', //<--------------- BE CAREFULL WITH THIS ONE
                // description: documentation for the method
                'A simple Hello World web method'); 
```******

# php - 如何在进行 mysql 查询之前识别停用词

> ID：15043592
> 
> 赞同：1
> 
> 时间：2013-02-23T17:47:57.417
> 
> 标签：php, javascript, mysql, full-text-search

我正在尝试为 webapp 设置文本搜索。我的mysql查询如下：

`SELECT * FROM t1 WHERE MATCH (c1,c2,c3) AGAINST (:keyStr IN BOOLEAN MODE)`

我希望 :keyStr 中的所有单词都匹配，所以 keyStr 看起来像：

`:keyStr='+word[0]* +word[1]* +word[2]* + ... +word[n]*'`

如果任何 word[x] 是停用词或小于最小字长，则查询返回空值。我认为最好的解决方案是从停用词中删除“+”或从 :keyStr 中完全删除停用词。

有什么好的方法可以做到这一点吗？在进行查询之前，我是否需要检查 stopwords_list 中是否有任何 word[x]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T22:01:44.937

使用 javascript 完成此操作的一种简单方法是：

```
var apart = "Some +example search that I made up".toLowerCase().replace(/[\+\-\?]*/g, '').split(' '),
    stop_words = ['the', 'that', 'a', 'example'],
    min_word_length = 1;

// filter the array to remove stop words
apart.filter( function( item ) {
    if ( item.length < min_word_length ) return false;
    return stop_words.indexOf( item ) === -1;
}); 
```

编辑：虽然在伪代码意义上，上面的代码可以工作，这是一个 PHP 解决方案

```
$query = "This is my example search query";

$search = explode(' ', $query);

$stop_words = array('is', 'a', 'the');

$terms = array_filter($search, function($item){
    return !in_array($item, $stop_words);
});

$formatted = array_map(function($term){
    return '+'.mysql_escape_string($term).'*';
}, $terms);

// :keyStr = implode(' ', $formatted); 
```

# ruby-on-rails - 导轨：型号有限

> ID：15043593
> 
> 赞同：1
> 
> 时间：2013-02-23T17:48:01.180
> 
> 标签：ruby-on-rails, model

您好，我有一个人与城市之间的关系芯片。一个城市可以有很多人。

我想要一个最多有十个人的城市？我怎么能约束它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:57:26.233

这是模型代码：

```
class Person
  belongs_to :city
end

class City
  has_many :persons
  validate_on_create :check_populations

  def check_populations
    return if persons.length > 10
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:55:40.873

您可以在模型中使用自定义验证器。看看这里：[https ://stackoverflow.com/a/2263294/1321564](https://stackoverflow.com/a/2263294/1321564)

# javascript - 对象编辑的javascript对象

> ID：15043601
> 
> 赞同：1
> 
> 时间：2013-02-23T17:49:55.897
> 
> 标签：javascript, object

我有以下代码，它不起作用。

```
var conversations = { };
conversations['5634576'].name = 'frank'; 
```

显然我不能在对象内创建对象。我想使用会话对象来存储对象数组，以使用 localStorage 在客户端保存消息历史记录，以节省服务器端的空间。

但显然，我什至不能在对象内部创建变量，除非它们已经存在，如下所示：

```
var conversations = { 123: { name: 'test' } };
conversations[123].name = "frank"; 
```

但是，由于我不知道将使用的 ID，我不知道如何解决这个问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:52:29.207

你需要这样做：

```
// Create an object
var conversations = {};

// Add a blank object to the object if doesn't already exist
if (!conversations.hasOwnProperty('5634576')) {
    conversations['5634576'] = {};
}

// Add data to the child object
conversations['5634576'].name = 'frank'; 
```

该对象将如下所示：

```
conversations{
    '5634576': {
        name : 'frank'
    }
} 
```

**更新**

您可以使用检查元素是否存在`in`

```
if('5634576' in conversations) {
    // Exist
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:54:26.927

在您的代码中，您不能将变量添加到索引“5634576”，因为它仍然不存在。

```
var conversations = { };
conversations['5634576'].name = 'frank'; 
```

您需要创建它，然后分配变量

```
var conversations = { };
conversations['5634576'] = {};
conversations.name = 'frank'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:54:38.200

也许是最短的方法：

```
var conversations = {};
(conversations['5634576'] = {}).name = 'frank'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:58:14.873

```
// build this how you were
conversations = {};

// if conversations[12345] is defined, use it:
// else set it to an object with the desired properties/methods
conversations["12345"] = conversations["12345"] || { name : "Frank", messages : [] };
conversations["12345"].messages.push(new_msg); 
```

我假设您将在 XHR 或其他函数中执行此操作

```
conversations.add_message = function (msg) {
    var id = msg.conversation_id;
    conversations[id] = conversations[id] ||
                        conversations.new_conversation(msg.user_name); // returning a conversation object
    conversations[id].messages.push(msg);
};

conversations.new_conversation = function (name) {
    return { name : name, messages : [], etc : {} };
}; 
```

# c# - 我从哪里开始使用 VS2012 和 C# 开发 Facebook 应用程序？

> ID：15043603
> 
> 赞同：-1
> 
> 时间：2013-02-23T17:50:10.220
> 
> 标签：c#, asp.net-mvc, facebook-apps

我是一名 asp.net mvc/C# 软件开发人员，但我没有 Facebook 开发经验。在开发 Facebook 应用程序时，我不知道从哪里开始。

我有 litlle bit google，但无法获得更多帮助，但只找到了一个链接

[http://www.asp.net/vnext/overview/fall-2012-update/facebook-application-template-tutorial](http://www.asp.net/vnext/overview/fall-2012-update/facebook-application-template-tutorial)

我从哪里开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:54:06.443

与任何其他新技术、[他们的文档相同的地方](http://csharpsdk.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:01:58.383

从 Visual Studio 2012 中的 Facebook 应用模板开始（最新更新 2012.2）。

从您提供的链接开始： [http](http://www.asp.net/vnext/overview/fall-2012-update/facebook-application-template-tutorial) ://www.asp.net/vnext/overview/fall-2012-update/facebook-application-template-tutorial ，它将帮助您快速上手。

# c - 在 C 中构建 N 叉树（递归？）

> ID：15043605
> 
> 赞同：0
> 
> 时间：2013-02-23T17:50:25.333
> 
> 标签：c, recursion

我必须构建一棵树，从一个字符串开始，它会根据一些转换规则不断创建新节点。

例如：

给定一个字符串`aab` 和以下两个转换规则：

```
ab --> bba
b --> ba 
```

需要构建以下树：

![树](../Images/8911db685b9b5eb7d0fc2d889aba584d.png)

请注意，构建是在广度模式下完成的。在每一步，我都会为当前节点的每个子字符串应用所有转换规则，这将是子节点。

这是我到目前为止所拥有的：

```
//Representing the n_ary tree
typedef struct {
    char *value;
    struct t_children_list *children;
} tree;

typedef struct t_children_list {
    tree *child;
    struct t_children_list *next;
} children_list;

void initializeNode(tree **node, char *input)
{
  if((*node = malloc(sizeof(tree))) == NULL) { abort(); }
  (*node)->value = input;
  (*node)->children = NULL;
}

void createChildrenList(children_list **children, tree *transformation)
{
    if((*children = malloc(sizeof(children_list))) == NULL) { abort(); }
    (*children)->child = transformation;
    (*children)->next = NULL;
}

//Given a node, and a needle with a replacement. It will add the childrens to that node. 
void addTransformationsToNode(tree **origin, char *needle, char *replacement)
{
    char *str = (*origin)->value;
    for (char *p = str; *p != '\0'; p++) {
       //Logic to find the value of str_... Not relevant
             tree *transformation = NULL;
            initializeNode(&transformation, str_);
            //Add node to origin children list
            // If node doesn't have children yet, create a new list
            // Otherwise, add to end of children list
            children_list *children = NULL;
            createChildrenList(&children, transformation);
            if ((*origin)->children == NULL) {
                (*origin)->children = children;
            } else {
                children_list *current = (*origin)->children;
                while (current->next != NULL) {
                    current = current->next;
                }
                current->next = children;
            }
        }
    }

  }

void main()
{
  // Create the tree
  char *input = "aab";
  char *target = "bababab";
  tree *my_tree = NULL;
  initializeNode(&my_tree, input);

  addTransformationsToNode(&my_tree, "ab", "bba");
  addTransformationsToNode(&my_tree, "b", "ba");

} 
```

这适用于第一级。但我正在寻找一种方法，可以对每个节点和该节点的子节点执行相同的操作。所以，我从原点开始，找到所有的转换，然后为到达转换做同样的事情。我看不到如何递归地做到这一点......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:40:31.567

对于“广度优先”，您可能想查看通用二叉树（可以为任何树构造），其中每个节点都链接到*first-child*和*next-sibling*。您可以构建二叉树（呼吸优先），然后转换为 n 元。

从单个字符串构建一代，将结果放入节点列表中，由*next-sibling*链接。下一代是从列表中的每个节点构建一个代。

迭代地或递归地，您使用重复来协调适用于一个节点的一系列调用。

```
addTransformationsToNode(&my_tree, "ab", "bba");

addTransformationsToNode(&my_tree->children->child, "ab", "bba");
addTransformationsToNode(&my_tree->children->next->child, "ab", "bba");
addTransformationsToNode(&my_tree->children->next->next->child, "ab", "bba");

addTransformationsToNode(&my_tree->children->child->children->child, "ab", "bba");
addTransformationsToNode(&my_tree->children->child->children->next->child, "ab", "bba"); 
```

因此，对于*body*，您将遵循*下一个*指针并调用`addTransformationsToNode`每个孩子（我会在循环中执行此操作）。然后，您可以递归并为每个孩子的孩子做同样的事情。

您需要一个额外的参数来控制递归的深度：以某种方式结束树构造。

* * *

我尝试编写函数并感到困惑。我认为您的`children_list`结构不必要地复杂。我会从更简单的事情开始。

```
typedef struct tree {
    char *val;
    struct tree *first_child;
    struct tree *next_sibling;
} tree;

tree *newnode(char *val){
    tree *node;
    node = malloc(sizeof(*node));
    if (node) {
        node->val = val;
        node->first_child = NULL;
        node->next_sibling = NULL;
    }
    return node;
}

void printtree(tree *node) {
    if (node) {
        if (node->val)
            printf("%s, ", node->val);
        printtree(node->next_sibling);
        puts("");
        printtree(node->first_child);
    }
} 
```

# mongodb - 更改用户 mongod 在 ubuntu 下运行

> ID：15043606
> 
> 赞同：6
> 
> 时间：2013-02-23T17:50:46.830
> 
> 标签：mongodb, ubuntu

我已按照以下页面的说明通过 apt-get 安装 MongoDB：http: [//docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/](http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/)

这将创建一个名为：/etc/mongodb.conf 的配置文件

还有一个名为：/etc/init.d/mongodb 的控制脚本

这些允许我通过调用来启动 mongodb：

```
sudo service mongodb start 
```

我的问题是，如何更改运行 mongod 进程的用户？我搜索了配置文件和控制脚本，但都没有提到用户。我不得不使用`ps aux | less`查看所有进程并找到 mongod 进程来查看该进程在哪个用户下运行。start 调用不接受用户，配置文件没有指定用户，控制脚本也没有。有谁知道如何更改用户，甚至是如何确定用户在其下运行进程的方式？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-25T09:15:16.217

MongoDB 添加一个用户和组，`mongodb`运行进程并拥有相关文件，例如*/var/log/mongodb中的日志和**/var/lib/mongodb*中的数据库文件

 *如果您查看*/etc/init.d/mongodb*，您会看到`DAEMONUSER=${DAEMONUSER:-mongodb}`- 在这里您可以更改运行 mongod 的用户。

您需要为新的守护程序用户添加用户和组，并将文件添加到新用户和组中。但是，我不建议更改用户。

您是否有特殊原因要将此用户更改为您自己定义的用户？*

# java - JPA EntityManager 默认合并行为

> ID：15043610
> 
> 赞同：0
> 
> 时间：2013-02-23T17:51:14.353
> 
> 标签：java, jpa

我有两个应用程序使用同一个库来处理数据库。第一个应用程序是桌面应用程序，第二个应用程序是 Web。所以他们都可以在我的数据库（PostgreSql）中同时更改相同的记录。该库使用以下代码：

```
 //it doesnt use em.getTransaction()
em.merge(userAcc);//change useraccount 
```

这段代码会导致死锁吗？合并的默认行为是什么？合并是否使用内部事务？实际上，两个合并操作的顺序无关紧要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:05:03.173

[Java Persistence wikibook](http://en.wikibooks.org/wiki/Java_Persistence/Transactions)中的相关引用。

> 从技术上讲，在 JPA 中，EntityManager 从创建之日起就处于事务中。所以 begin 有点多余。在调用 begin 之前，不能调用某些操作，例如persist、merge、remove。仍然可以执行查询，并且可以更改被查询的对象，尽管在 JPA 规范中这些更改会发生什么情况有些不确定，通常它们会被提交，但是最好在对您的任何更改之前调用 begin对象。

因此，在这种情况下，似乎 的行为`merge()`将取决于您的持久性提供者。

我想实体无论如何都会在隐式事务中更新，但我认为这不会导致死锁。最坏的情况是两个应用程序对同一实体的并发更新将在不知情的情况下相互覆盖。您可以通过使用乐观锁定来防止这种情况。

# android - 更改圆形 RelativeLayout 背景图像

> ID：15043611
> 
> 赞同：0
> 
> 时间：2013-02-23T17:51:14.917
> 
> 标签：android

我有ListViewAdapter，每个项目都是RelativeLayout。我希望每个项目都有不同的圆形图像，但我不知道如何更改图像。

我的可绘制 xml 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:id="@+id/item2">
        <shape android:shape="rectangle" >
            <solid android:color="#FFFFFF"/>
            <corners  android:radius="5dip" />
            <stroke android:width="2dp" android:color="#000000" />
        </shape>
    </item>

 <item android:id="@+id/item">
    <bitmap android:src="@drawable/ic_launcher"/>
 </item>

</layer-list> 
```

我的代码如下所示：

```
LayerDrawable ld = (LayerDrawable)m_context.getResources().getDrawable(R.drawable.rounded_border);
    ld.setDrawableByLayerId(R.id.item2,GetDrawableFromUrl(prod.getImageUrl()));
    RelativeLayout raw = (RelativeLayout)rowView.findViewById(R.id.raw);
    raw.setBackgroundDrawable(ld); 
```

但结果是图像没有圆边和笔触。

如何在不损坏圆边和笔划的情况下更改图像？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:27:24.377

如果要将圆形矩形图像设置为列表中每个项目的背景。看看[这个](http://www.curious-creature.org/2012/12/11/android-recipe-1-image-with-rounded-corners/)。

# macos - 打包没有 Mac 隐藏文件的 Firefox XPI

> ID：15043615
> 
> 赞同：1
> 
> 时间：2013-02-23T17:51:26.190
> 
> 标签：macos, firefox-addon

Mac OS 会创建`.DS_Store`隐藏文件等。我创建了一个运行良好的 Firefox 插件，但是当我将它发送到验证器时，我收到警告，要求我删除隐藏文件。我打开了隐藏文件并试图删除它们并重新打包插件，但文件只是在几秒钟后重新出现。如何删除这些文件并打包我的扩展程序以避免这些警告？

注意：这个问题不应该被认为是这个问题的重复：[How do you create a .XPI package on a mac](https://stackoverflow.com/questions/2130324/how-do-you-create-a-xpi-package-on-a-mac)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T18:59:58.177

好的，我找到了解决方案。[我最终使用基于 7-zip 的应用程序Keka](http://www.kekaosx.com/en/)打包了我的扩展程序。它可以选择排除隐藏文件。

# wpf - 如果分配对象，实体框架会创建重复项

> ID：15043617
> 
> 赞同：0
> 
> 时间：2013-02-23T17:51:40.033
> 
> 标签：wpf, entity-framework, unity-container

您好，我使用 PRISM 和 Unity、Entity Framework 创建了一个小型 WPF 应用程序。

如果数据库包含与用户输入的详细信息匹配的用户，我有一个 sharedInfo 类用于访问我在引导程序中填充的当前登录用户。

我的用户可以在某些实体上创建笔记，我想知道谁创建了笔记，所以我的笔记类具有 SystemUser 的导航属性。如果我创建一个新笔记并像这样设置属性：

```
note.SytemUser = _unityContainer.Resolve<ISharedInfo>("AppSharedInfo").LoggedInUser; 
```

然后当我保存详细信息时，我会创建一个新的 systemUser。如果我像这样简单地设置 Id 属性，则不会发生这种情况：

```
note.SystemuserId =_unityContainer.Resolve<ISharedInfo>("AppSharedInfo").LoggedInUser.SystemUserId; 
```

这对我来说似乎是错误的，如果我设置注释的 SystemUser 属性，你能告诉我我哪里出错了吗？是什么导致我的用户详细信息重复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:50:24.470

很可能您将其添加`note`到您的上下文中，如下所示：

```
context.Notes.Add(note); 
```

这条线不仅将`note`自身置于`Added`状态，而且`note`将上下文实例尚不知道的所有相关对象置于状态，即处于状态的相关对象`Detached`。为了避免同时添加相关实体，您必须明确告诉 EF 您知道相关实体已经存在，方法是在`Unchanged`调用之前`Add`将其附加到上下文（在 state 中） `note`：

```
context.SystemUsers.Attach(note.SystemUser);
context.Notes.Add(note); 
```

# qt - 无法播放 ogg 和 flac

> ID：15043620
> 
> 赞同：4
> 
> 时间：2013-02-23T17:51:45.887
> 
> 标签：qt, ogg, flac

32 位 Windows XP 上的 Qt 5.0.1 QMediaPlayer 只能播放 MP3 和 WAV 文件。我怎样才能扩展它来播放 OGG 和 FLAC 文件呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T19:24:21.133

Qt 的多媒体模块使用平台编解码器。如果您没有为 Vorbis（它不称为 Ogg；这只是容器格式）和 FLAC 安装编解码器，那么您将无法播放这些格式。

您可以在此处找到所需的编解码器：

[http://www.xiph.org/dshow](http://www.xiph.org/dshow)

# python - 树型结构的 Python 问题

> ID：15043623
> 
> 赞同：0
> 
> 时间：2013-02-23T17:52:17.757
> 
> 标签：python, tree, state-machine

我正在创建一个有限状态自动机 ( `FSA`)，它基本上是一棵树。单词中的每个字母构成一个节点 ( `State`)。一串字母构成通过 的路径`FSA`，并且路径可以重叠。不过，我似乎遇到了节点`next_states`或子节点的问题。

输入文件`vocab.small`看起来像这样，`\n`每行末尾都有一个：

```
A 
A A A 
A A B E R G 
A A C H E N 
```

现在，我构建了`FSA`非常类似于树的结构，但是我在其中创建`State start_state`并`State end_state`链接它们：

```
class State (object):
    __slots__ = "chars","next_states"
    def __init__(self,chars,next_states=[]):
        self.chars = chars
        self.next_states = next_states

class FSA (object):
    __slots__ = "vocab","start_state","end_state"
    def __init__(self,vocab):
        self.vocab = vocab
        self.start_state = State("0")
        self.end_state = State("1")
        self.end_state.next_states.append(self.start_state)
        self.start_state.next_states.append(self.end_state) 
```

中的其他方法`FSA`是：

```
 def create_fsa(self):
        vocab_file = open(self.vocab, 'r')
        for word in vocab_file:
            self.add_word(word)
        vocab_file.close()

    def add_word(self,word,current_state=None):
        next_char = word[0:2]
        if current_state == None:
            current_state = self.start_state
        ## next_char found in current_state.next_states
        if next((x for x in current_state.next_states if x.chars == next_char), None):
            if len(word) > 3:
                print "next_char found"
                current_state = next((x for x in current_state.next_states if x.chars == next_char), None)
                self.add_word(word[2:],current_state)
            else:
                print "next_char found + add end"
                current_state = next((x for x in current_state.next_states if x.chars == next_char), None)
                current_state.next_states.append(self.end_state)
##                current_state.children[current_state.children.index(next_char)].append(self.end_state)
        ## next_char NOT found in current_state.next_states
        else:
            current_state.next_states.append(State(next_char))
            current_state = next((x for x in current_state.next_states if x.chars == next_char), None)
            if len(word) > 3:
                print "next_char added"
                self.add_word(word[2:],current_state)
            else:
                print "next_char added + end"
                current_state.next_states.append(self.end_state)
        print 
```

问题似乎在于`current_state.next_states[]`，因为它继续累积对象，而不是在每个新的`State`. 问题是否`current_state.next_states.append(State(next_char))`与我如何创建新`State`对象有关？

谢谢您的帮助。

# windows - “中性”、“中性（默认）”和“中性（系统默认）”之间的区别？

> ID：15043624
> 
> 赞同：3
> 
> 时间：2013-02-23T17:52:22.013
> 
> 标签：windows, visual-studio, visual-c++, user-interface, internationalization

我想将一个应用程序分发到许多不同的国家，所以我必须将多语言字符串嵌入到它的资源中。

Visual Studio 提供了日文、英文、中文等世界主流语言列表。不过，除此之外，还有其他三种选择：

> 1.  “中性的”;
>     
>     
> 2.  “中性（默认）”；
>     
>     
> 3.  “中性（系统默认）”。

它们之间有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T21:54:08.180

假设您在这里谈论本机资源（托管资源是另一种野兽）

*   中性=LANG_NEUTRAL|SUBLANG_NEUTRAL。FindResourceEx 回退到线程本地。请参阅[GetThreadLocale](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318127%28v=vs.85%29.aspx)
*   中性（默认）=LANG_NEUTRAL|SUBLANG_DEFAULT 回退到用户的默认语言。请参阅[GetUserDefaultLCID](http://msdn.microsoft.com/en-us/library/dd318135%28VS.85%29.aspx)
*   中性（系统默认值）=LANG_NEUTRAL|SUBLANG_SYS_DEFAULT。请参阅[GetSystemDefaultUILanguage](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318123%28v=vs.85%29.aspx)

如果用户正在运行带有 MUI 包的英文版 Windows，默认语言为简体中文，然后通过[istream](http://www.cplusplus.com/reference/istream/istream/)打开一个需要本地日语线程的文件，那么这些语言 ID 在不同时间可能很有用。

在很多情况下，资源加载器没有首选语言（例如 CString::LoadString/LoadStringW）。调用者指定一个中性标志，并希望 FindResourceEx 能找到足够接近的东西。如果资源文件中有完全匹配（即使是中性语言），则返回资源（呃，我猜 LoadStringW 是中性语言的一个坏例子，LoadIcon 可能更好），如果没有找到完全匹配并且未指定语言，然后启动复杂的回退过程。[这里](http://www.siao2.com/2005/08/31/458266.aspx)是 XP 版，[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/dd374098%28v=vs.85%29.aspx)是 Vista 版。

有时保持中立是值得的，如果你的资源在全球范围内被审查为不具冒犯性，并且与属于世界各地当地实体之一的东西不太相似（尤其是当地党旗，请参阅纳粹使用的万字符号），你可以跨所有语言共享资源并节省一些空间。但是，一旦团队切换到本地化卫星 dll 作为默认资源源（请参阅 AfxSetResourceHandle），坚持使用中性资源就会变得更加困难。哦，全球审查很昂贵。

参考： [.RES 文件中 LANGUAGE 语句的格式](http://support.microsoft.com/kb/89822)

# cocos2d-iphone - 编辑 CCSprite 的色调和/或饱和度

> ID：15043629
> 
> 赞同：1
> 
> 时间：2013-02-23T17:52:31.233
> 
> 标签：cocos2d-iphone, ccsprite, hue

是否可以更改已加载纹理的 CCSprite 的色调和/或饱和度 a.png ？看起来像这样，例如：

```
[CCSprite1 spriteWithImage@"img1.png"];
[CCSprite1 setHue:150];//<<< 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:06:41.800

不，您只能更改不透明度和颜色（色调）。

除非您编写自定义片段着色器。

# r - 多核::应用？

> ID：15043633
> 
> 赞同：3
> 
> 时间：2013-02-23T17:53:24.177
> 
> 标签：r, multicore

图书馆里有类似`sapply`的东西吗？`multicore`还是我必须这样做`unlist(mclapply(..))`才能实现这一目标？

如果它不存在：推理是什么？

提前致谢，如果这是一个愚蠢的问题，我们深表歉意！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:33:28.717

在 library`parallel`中，你有`mcmapply`which ，就像`mapply`in一样`base`，需要一个`SIMPLIFY`参数。`TRUE`默认情况下。这是一个使用示例：

```
library(parallel)
mcmapply(sqrt,split(1:8,1:8))
#        1        2        3        4        5        6        7        8
# 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427 
```

将此与`mclapply`.

```
mclapply(split(1:8,1:8),sqrt)
# $`1`
# [1] 1
# 
# $`2`
# [1] 1.414214
# ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T18:33:18.947

如果您查看`sapply`（及其辅助函数`simplify2array`）的代码，您会发现这`unlist(obj)`正是 obj 是所有`length==1`. `sapply`但是，它比仅取消列出列表要复杂得多。仍然非常不清楚的是您要解决的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-14T11:32:32.593

就像 IRTFM 提到的那样，查看 sapply 的源代码就是答案。但是由于我在阅读他的答案后仍然有点困惑，也许是我，所以如果你也是，那么希望遵循精确度会使它更清晰：sapply 的代码：

```
sapply<-function (X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE) 
{
  FUN <- match.fun(FUN)
  answer <- lapply(X = X, FUN = FUN, ...)
  if (USE.NAMES && is.character(X) && is.null(names(answer))) 
    names(answer) <- X
  if (!isFALSE(simplify) && length(answer)) 
    simplify2array(answer, higher = (simplify == "array"))
  else answer
} 
```

所以 mcsapply 的自制实现将是：

```
mcsapply<-function (X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE, mc.preschedule = TRUE,
 mc.set.seed = TRUE, mc.silent = FALSE, mc.cores = getOption("mc.cores", 2L), 
  mc.cleanup = TRUE, mc.allow.recursive = TRUE, affinity.list = NULL )
{
  answer <- mclapply(X = X, FUN = FUN, ...,mc.preschedule = mc.preschedule, 
mc.set.seed = mc.set.seed, mc.silent = mc.silent, mc.cores = mc.cores, 
  mc.cleanup = mc.cleanup, mc.allow.recursive = mc.allow.recursive, affinity.list = affinity.list)
  if (USE.NAMES && is.character(X) && is.null(names(answer))) 
    names(answer) <- X
  if (!isFALSE(simplify) && length(answer)) 
    simplify2array(answer, higher = (simplify == "array"))
  else answer
} 
```

我正在使用类似的实现，它工作得很好。

# ruby-on-rails-3 - 从 Ransack Gem Rails 3 中获取搜索参数

> ID：15043639
> 
> 赞同：0
> 
> 时间：2013-02-23T17:54:01.837
> 
> 标签：ruby-on-rails-3, gem, ransack

我正在为 Rails3 使用 Ransack Search Gem。有没有办法获取用户在搜索框中输入的搜索参数？

如有必要，我想在我的视图中提供它。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T04:50:02.087

我最终弄清楚了：

类别控制器

```
def index
@q = Category.search(params[:q])
@categories = @q.result(:distinct => true)
end 
```

查看/_form.html.erb

```
%= search_form_for @q do |f| %>
<%= f.text_field :name_cont %>
<% end %>

<%= @q.name_cont %> 
```

我缺少的部分是**@q.name_cont**。这将输出输入到搜索表单中的字符串。

# asp.net-mvc - MVC 4 OAuth 集成。接下来是什么以及如何从数据提供者那里获取任何信息？

> ID：15043644
> 
> 赞同：5
> 
> 时间：2013-02-23T17:54:21.217
> 
> 标签：asp.net-mvc, facebook, oauth

我发现了很多帖子和文章，其中包含有关如何配置 MVC 4 应用程序以与任何社交网络提供商集成以及如何验证用户身份的非常详细的信息，但下一步是什么？例如，如何获取有关经过身份验证的用户的任何信息？我想到的最简单的任务是如何获取有关经过身份验证的用户的一些信息 - 名字、姓氏、头像的 url、朋友列表等？

**更新：**

1.  这是一些分享一些亮点[的帖子](https://stackoverflow.com/questions/12610402/oauthwebsecurity-with-facebook-not-using-email-permission-as-expected)和[文章](http://savvydev.com/authenticating-facebook-users-with-mvc-4-oauth-and-obtaining-scope-permissions/)
2.  有用的[文章](http://www.asp.net/mvc/overview/getting-started/using-oauth-providers-with-mvc)如何与 Facebook 互动

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T17:59:45.250

OAuth 仅用于身份验证，即获取访问令牌。获得此访问令牌后，您可以使用它从服务提供商处检索此信息。请查阅提供商的文档以了解如何做到这一点。

您可能会检索到一些声明，例如 FirstName 和 LastName，因为它们是标准的并且大多数提供商都支持它们。例如，在`ExternalLoginCallback`回调中，您可以尝试从`result.ExtraData`字典中检索此信息：

```
[AllowAnonymous]
public ActionResult ExternalLoginCallback(string returnUrl)
{
    AuthenticationResult result = OAuthWebSecurity.VerifyAuthentication(Url.Action("ExternalLoginCallback", new { ReturnUrl = returnUrl }));
    if (!result.IsSuccessful)
    {
        return RedirectToAction("ExternalLoginFailure");
    }

    if (OAuthWebSecurity.Login(result.Provider, result.ProviderUserId, createPersistentCookie: false))
    {
        return RedirectToLocal(returnUrl);
    }

    if (User.Identity.IsAuthenticated)
    {
        // Here you could use result.ExtraData dictionary
        string name = result.ExtraData["name"];

        // If the current user is logged in add the new account
        OAuthWebSecurity.CreateOrUpdateAccount(result.Provider, result.ProviderUserId, User.Identity.Name);
        return RedirectToLocal(returnUrl);
    }
    else
    {
        // User is new, ask for their desired membership name
        string loginData = OAuthWebSecurity.SerializeProviderUserId(result.Provider, result.ProviderUserId);
        ViewBag.ProviderDisplayName = OAuthWebSecurity.GetOAuthClientData(result.Provider).DisplayName;
        ViewBag.ReturnUrl = returnUrl;
        return View("ExternalLoginConfirmation", new RegisterExternalLoginModel { UserName = result.UserName, ExternalLoginData = loginData });
    }
} 
```

但是不同的提供者可能使用不同的密钥。因此，根据所使用的提供商，您必须使用正确的密钥来读取所需的信息。

# python - 我可以从python中的数字中得到一个分数吗？

> ID：15043652
> 
> 赞同：1
> 
> 时间：2013-02-23T17:55:08.097
> 
> 标签：python, fractions

我正在做一些计算，在输出之前我想将数字更改为分数。例如 0.25 会变成 1/4，在两个数字 [1, 4] 的列表中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T17:56:56.070

使用[`fractions`模块](http://docs.python.org/3/library/fractions.html)来做到这一点：

```
>>> import fractions
>>> fractions.Fraction(0.25)
Fraction(1, 4)
>>> f = fractions.Fraction(0.25)
>>> f.numerator
1
>>> f.denominator
4 
```

对于作为输入的任意浮点数，您真的想使用该[`.limit_denominator()`方法](http://docs.python.org/2/library/fractions.html#fractions.Fraction.limit_denominator)将分数限制为浮点数的合理近似值：

```
>>> from math import pi, cos
>>> fractions.Fraction(cos(pi/3))
Fraction(4503599627370497, 9007199254740992)
>>> fractions.Fraction(cos(pi/3)).limit_denominator()
Fraction(1, 2) 
```

# xpages - 在视图中显示图像

> ID：15043653
> 
> 赞同：0
> 
> 时间：2013-02-23T17:55:25.850
> 
> 标签：xpages

我正在尝试学习创建包含来自注释视图的数据的 xpage 以提供类似 ebay 项目网格列表的最佳方法。您有名称、描述和缩略图等数据项的位置。

在视图中包含的文档上，有一个包含缩略图的富文本字段。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T06:27:30.223

在 Notes 视图中创建一个列，该列使用公式在列中显示附件的名称`@AttachmentNames`。然后在 XPage 的视图控件中将`var`属性设置为`rowData`. 然后，您可以使用此`rowData`变量来获取当前显示在视图中的文档。您可以使用以下视图列的代码片段将文档中附加的图标图像显示为视图图标。

```
<xp:viewColumn>
    <xp:this.facets>
        <xp:viewColumnHeader xp:key="header"></xp:viewColumnHeader>
    </xp:this.facets>
    <xp:this.iconSrc><![CDATA[#{javascript:rowData.getDocument().getUniversalID() + "/$FILE/" + rowData.getColumnValue("$1")}]]></xp:this.iconSrc>
    <xp:this.value><![CDATA[#{javascript:""}]]></xp:this.value>
</xp:viewColumn> 
```

修改上面的代码以使用显示附件名称的列的编程名称`rowData.getColumnValue("$1")`。

这里的一个假设是每个文档只有一个附件。另外我不知道这是否是最好的方法，但它适用于我的场景。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T08:50:45.350

1.  将您的文档集合放在重复中
2.  在重复中放置一个带有标签名“span”的面板，添加一个文档数据源并将样式设置为float：left
3.  在面板中放置一个图像控件并将源设置为文档数据，例如 /0/unid/$File/filename

# php - PHP：为相同的帖子ID仅输出一次并添加该帖子的媒体

> ID：15043660
> 
> 赞同：0
> 
> 时间：2013-02-23T17:56:12.393
> 
> 标签：php, mysql, wordpress

我对问题标题感到抱歉，但我没有任何合适的词来定义。

我有多个媒体用于表中的同一个帖子现在我想以以下格式输出数据

```
Post ID 1
------------------------
media1, media2, media3
------------------------

Post ID 2
------------------------
media1, media2, media3
------------------------

so on... 
```

这是表格图像 ![在此处输入图像描述](../Images/fbfc56946120d2940db9ffc10cc2a3f3.png)

我已使用以下查询加入上表

```
SELECT wp_posts.ID, wp_posts.post_author, wp_posts.post_title, wp_posts.post_status, wp_posts.post_type, 
wp_review_media.post_id, wp_review_media.user_id, wp_review_media.id, wp_review_media.image_name, wp_review_media.`status`, 
wp_users.ID, wp_users.user_login

FROM wp_posts
RIGHT OUTER JOIN wp_users ON wp_users.ID = wp_posts.post_author
RIGHT OUTER JOIN wp_review_media ON wp_posts.ID = wp_review_media.post_id

WHERE wp_posts.post_status = 'publish' AND wp_review_media.`status` = 0 
```

目前，它使用此循环以以下格式提供输出

```
<?php
if ($medias) {
    foreach ($medias as $media) {
?> 
        <tr>
            <td><?php echo $media->ID; ?></td>
            <td><?php echo $media->post_title; ?></td>

        </tr>
<?php } 
} else { ?>
        <tr>
        <td>No Record Found!</td>
        <tr>  
<?php } ?> 
```

输出：

```
Post ID 1
---------
media1

Post ID 1
---------
media2

Post ID 1
---------
media3

Post ID 2
---------
media1

Post ID 2
---------
media2

Post ID 2
---------
media3

so on.... 
```

所以任何人都可以帮助我理解我怎样才能得到我上面描述的结果。

非常感谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:02:39.177

假设您只想要 id 和媒体列表，请使用`GROUP_CONCAT`：

```
SELECT wp_posts.ID, GROUP_CONCAT(wp_posts.post_title) titles
FROM wp_posts
   RIGHT OUTER JOIN wp_users ON wp_users.ID = wp_posts.post_author
   RIGHT OUTER JOIN wp_review_media ON wp_posts.ID = wp_review_media.post_id
WHERE wp_posts.post_status = 'publish' AND wp_review_media.`status` = 0
GROUP BY wp_posts.ID 
```

# plist - plist 启动代理脚本未启动

> ID：15043662
> 
> 赞同：1
> 
> 时间：2013-02-23T17:56:35.610
> 
> 标签：plist

我知道关于 PLIST 文件有大约一千个这样的问题（它们本身应该告诉苹果他们在这个问题上完全错了），但我还没有找到适合我的答案。

我现在可以用 crontab 中的一行做什么需要一个无法正常运行的 xml 文件。

plist 文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"
   "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
   <key>Label</key>
   <string>com.ll.dbcopy</string>
   <key>Program</key>
   <string>/Users/MyName/backup/dbcopy.sh</string>
   <key>StartCalendarInterval</key>
   <dict>
      <key>Minute</key>
      <integer>30</integer>
      <key>Hour</key>
      <integer>7</integer>
   </dict>
</dict>
</plist> 
```

它被放置在`/Library/LaunchAgents`

如果我尝试用它运行`sudo launchctl start com.ll.dbcopy`它说

`error no such process`

我可以运行它指向的程序就好了。

任何想法为什么它会失败？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T22:17:50.203

万一其他人遇到此问题，您需要在尝试运行它之前启动 ctl 加载 plist。您会得到“没有这样的过程”，因为 launchctl 在加载的 plist 脚本数组中找不到 plist。您实际上并没有启动文件（这将更合乎逻辑，因为根据 Apple 的 launchctl MAN-pages，“start”被明确用于测试），您指向 plist 列表中的引用并启动它。

所以如果你对 plist 进行了更改并想再次“启动”，你需要卸载然后再次加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-07T16:54:45.390

Anyone else coming across this question might be typing:

```
launchctl start ... 
```

when what they want is:

```
launchctl load ... 
```

# ajax - 使用 Chrome 扩展程序的内容安全策略 - 通过远程 URL 获取数据

> ID：15043663
> 
> 赞同：0
> 
> 时间：2013-02-23T17:56:37.877
> 
> 标签：ajax, google-chrome-extension, content-security-policy

我在 manifest.json 中使用以下行制作了 chrome 扩展，以便我可以通过 ajax 请求获取数据。

`"content_security_policy": "script-src 'self' http://localhost; object-src 'self'",`

我想用我的实时站点测试扩展，所以我将其更改为：

`"content_security_policy": "script-src 'self' http://www.example.com; object-src 'self'",`

但是现在当我启动 chrome 时扩展程序没有初始化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T06:38:24.250

要制作跨域 XHR，您不需要关心 CSP。您需要在清单中添加的是您需要访问的那些主机的主机权限。阅读[https://developer.chrome.com/trunk/extensions/xhr.html](https://developer.chrome.com/trunk/extensions/xhr.html)了解更多信息。

另一方面，如果您的扩展从外部 Web 服务器加载脚本 (<script src="..."></script>)，则您必须了解 CSP。首先，托管脚本的服务器必须是 HTTPS。[然后，按照https://developer.chrome.com/trunk/extensions/contentSecurityPolicy.html#relaxing-remote-script](https://developer.chrome.com/trunk/extensions/contentSecurityPolicy.html#relaxing-remote-script)中的描述在 CSP 中列出它。

禁止在“script-src”中将 HTTP 源列入白名单，以防止中间人攻击和其他安全问题，以免您的扩展程序加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:33:41.370

您是否添加了权限，如果没有，请尝试此操作，希望它会起作用

```
,
 "permissions": [
   "http://www.example.com/*", 
   "tabs"
 ],
"content_scripts": [
  {
    "matches": [
        "http://www.example.com/*"
    ],
    "js": [
        "js/myScript.js"
    ]
  }
] 
```

# r - 访问对象的一部分

> ID：15043665
> 
> 赞同：0
> 
> 时间：2013-02-23T17:56:48.953
> 
> 标签：r

我有这个：

```
> str(pa1)
 num [1:83, 1:9] -1.46 -2.28 -3.69 -4.98 -5 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:83] "1" "2" "3" "4" ...
  ..$ : chr [1:9] "PC1" "PC2" "PC3" "PC4" ... 
```

如何访问`pa1`上面显示的最后一部分，即

```
"PC1" "PC2" "PC3" "PC4" ... 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:04:09.330

有一个特定的函数`dimnames`，通常你会得到`attr`函数的属性（如输出`str`所示）。

```
dimnames(pa1)[[2]]
#or
attr(pa1,"dimnames")[[2]] 
```

# c - 我们可以这样传递结构成员吗？

> ID：15043668
> 
> 赞同：0
> 
> 时间：2013-02-23T17:57:02.630
> 
> 标签：c, arrays, pointers, structure

我有一个下面给定的结构，它有一个指针数组，它的成员

```
char input[128];

struct Stu

{

char *argv[];

int a;

};

struct stu *ptr=&stu;

ptr->argv[0]="name";

ptr->argv[1]=input;

fun(2,(**)ptr);     //is 2nd argument are we passing member of array input[128] ??

fun(int argc,char *argv[]){} 
```

从 fun 传递的第二个参数如何存储在 char*argv[] 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:03:54.017

您的代码无效：

```
struct stu *ptr;

ptr->argv[0]=2; 
```

您有一个指向结构的指针....但是您没有在任何地方分配结构。你在指出谁知道什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:25:33.080

AFAIK 这就是你想要的：

```
struct stu
{
    char **argv;    // *argv[] will give you "error: flexible array member not at end of struct"
    int a;
};

struct stu Stu;    // Allocate Stu as a global stu struct

fun(int argc, char * argv[]) {}

int main()
{
    char input[128];
    char *argies[2];        // Static allocation of space for argv to point to
    struct stu *ptr = &Stu;

    ptr->argv = argies;     // You need to assign argv to point to allocated space

    ptr->argv[0] = "name";
    ptr->argv[1] = input;

    fun(2, ptr->argv);    // is 2nd argument we passing member of array argv??
} 
```

如果你没有声明一个实际的 stu 结构，那么 ptr 将被初始化[为零](https://stackoverflow.com/questions/1597405/what-happens-to-a-declared-uninitialized-variable-in-c-does-it-have-a-value)。此外，如果您确实声明了一个静态结构 stu（上面的 Stu）但不初始化 argv 指针，则 argv 指针将被初始化为零。不是指向“谁知道在哪里”，而是指向一个非常具体的地方。

请注意，输入不是以 NULL 结尾的，实际上它没有被初始化，因此变量名称“argv”可能会产生误导，因为大多数程序员可能会假设任何 char **argv 都包含以 NULL 结尾的 C 字符串。此外，您可能希望将 argies 的维度设为 3，并将 NULL 放在第三个位置。

您可以将 ptr->argv[0]（字符串“名称”）作为 *(ptr->argv) 传递，但有趣的原型必须是 fun(int argc, char * argv)。

**ptr->argv 是一个字符。

*ptr 是一个结构体。

**ptr 是一个错误。

# c++ - 使用标准迭代 std 容器

> ID：15043669
> 
> 赞同：0
> 
> 时间：2013-02-23T17:57:03.493
> 
> 标签：c++, iterator, stdvector

根据我所学到的迭代容器的方法，如 std::vector，是使用迭代器，如下所示：

```
for(vector<int>::iterator it = numbers.begin(); it != numbers.end(); it++) 
```

我的问题是为什么不使用 standatd 迭代容器`for`，它更快，因为不需要调用函数 as`numbers.begin()`和`numbers.end()`。
根据我的尝试，我发现`for`使用迭代器更快 X 30。
我写了这段代码：

```
vector<int> numbers;
for (int i = 0; i < 5000000; i++)
{
    numbers.push_back(i);
}

time_t t = time(0);
struct tm * now = localtime(&t);
cout << now->tm_hour << ":" << now->tm_min << ":" <<  now->tm_sec << "\n";

for(vector<int>::iterator it = numbers.begin(); it != numbers.end(); it++)
{
    *it = 7;
}

t = time(0);
now = localtime(&t);
cout << now->tm_hour << ":" << now->tm_min << ":" <<  now->tm_sec << "\n";

int size = numbers.size();
for (int i = 0; i < size; i++)
{
    numbers[i] = i;
}

t = time(0);
now = localtime(&t);
cout << now->tm_hour << ":" << now->tm_min << ":" <<  now->tm_sec; 
```

输出是：

```
 19:28:25
    19:28:56
    19:28:57 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:46:37.747

看看你的数字——迭代一个简单的向量需要 30 秒？这是 CPU 时间的永恒。那里有问题。

一些建议：

*   该向量大约需要 19MB。这并不多，但它可能会导致堆碎片，或者如果您的计算机上加载了许多其他应用程序，则可能会导致虚拟机交换。要获得可靠的号码，请关闭尽可能多的应用程序并确保您的系统处于空闲状态。

*   couts 在计时器内，因此您正在测量部分 iostream 库的性能。在你采取停止时间*之后*，在计时部分之外进行 couts 。

*   一秒钟的时钟对于性能指标来说不够精确。使用 timeval 和 gettimeofday() 获得微秒精度。

*   仅对向量进行一次迭代，我就看到了运行之间的巨大差异。要获得更多可重复的结果，请多次迭代向量（如 500 次）。（这比使用更大的向量要好，这可能会导致交换/碎片问题。）

*   打开优化（例如，g++ -O3）。循环将运行得更快，时间差会更小。内联优化可能对 std::vector<> 代码有更多帮助。

通过这些更改（如下），在我的计算机上，迭代器比没有优化的索引慢 4 倍，但使用 -O1 稍*快*，使用 -O3 几乎相同。

```
#include <iostream>
#include <sys/time.h>
#include <vector>
using namespace std;

const unsigned N_REPS = 500;
const unsigned N_ITEMS = 5000000;

int print_elapsed(timeval start)
{
    timeval stop;
    gettimeofday(&stop, NULL);
    int elapsed = (stop.tv_sec * 1000000 + stop.tv_usec) - (start.tv_sec * 1000000 + start.tv_usec);
    cout << elapsed << "us" << endl;
    return elapsed;
}

int main()
{
    vector<int> numbers;
    numbers.reserve(N_ITEMS); // avoid heap fragmentation
    for (int i = 0; i < N_ITEMS; ++i)
        numbers.push_back(i);

    timeval start;
    gettimeofday(&start, NULL);

    for (unsigned r = 0; r < N_REPS; ++r)
        for (vector<int>::iterator it = numbers.begin(); it != numbers.end(); ++it)
            *it = r;

    int elapsed0 = print_elapsed(start);
    gettimeofday(&start, NULL);

    unsigned size = numbers.size();
    for (unsigned r = 0; r < N_REPS; ++r)
        for (unsigned i = 0; i < size; ++i)
            numbers[i] = r;

    int elapsed1 = print_elapsed(start);
    cout << 100 * float(elapsed1) / elapsed0 << '%' << endl;

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T19:26:15.070

Using iterators provide you the flexibility that even if you change the container type to another the iterating code will remain the same. This is because all the standard library containers provide iterators. In a way it gives you the chance to write more ***generic*** code.

# c++ - 带转发的向量 push_back？

> ID：15043674
> 
> 赞同：1
> 
> 时间：2013-02-23T17:57:17.843
> 
> 标签：c++, c++11, std

我在我的代码中做了这样的事情

```
S s;
s.a=1
s.b=2
v.push_back(s) 
```

既然 C++ 有转发功能，我可以写类似的东西吗

```
v.push_back(1,2) 
```

fyi visual studio 支持转发，因为以下按预期工作

```
//http://herbsutter.com/gotw/_102/
template<typename T, typename ...Args>
std::unique_ptr<T> make_unique( Args&& ...args )
{
    return std::unique_ptr<T>( new T( std::forward<Args>(args)... ) );
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T18:02:10.167

您可以使用`std::vector::emplace_back`which 将使用合适的构造函数就地创建对象。这当然需要您定义这样的构造函数。

```
v.emplace_back(1,2); 
```

从 C++11 开始，每个标准容器都提供了一个类似 emplace 的函数，它给出了上述行为。

兼容性说明：MSVC 可能还不支持这一点，因为它只支持不影响标准库的 CTP 的可变参数模板，并且 gcc 的 libstd++ 仍然缺少关联容器中的 emplace 成员函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T18:03:11.413

`push_back`不支持转发，但新的支持`emplace_back`。

但是，`push_back`确实支持初始化列表：

```
v.push_back({1,2}); 
```

# iphone - 完全在代码中复制 PhotoScroller

> ID：15043676
> 
> 赞同：0
> 
> 时间：2013-02-23T17:57:29.117
> 
> 标签：iphone, ios, ios6, uiscrollview, xib

我一直在尝试完全用代码复制 Apple 的 PhotoScroller 示例应用程序，但到目前为止还没有成功。即使我将 PhotoViewController、ImageScrollView 和 TileView 类复制到一个新项目并以编程方式创建一个 PhotoViewController 实例，它也不像在 PhotoScroller 应用程序中那样工作：

1.  在我复制的应用程序中，我可以上下移动图像，而在 PhotoScroller 应用程序中，我只能左右滚动图像。

2.  分页滚动视图未正确对齐居中的图像，因此黑色填充可见并且图像的某些部分不在屏幕上。

相反，如果我还复制 PhotoViewController 和 MainWindow xib 文件并将 MainWindow 设置为 iPhone 部署信息中的主界面，则一切正常。所以 xib 文件中一定有一些魔力，尽管它们在我看来基本上是空的。

这是在应用程序中以编程方式创建 PhotoViewController 的代码：didFinishLaunchingWithOptions: 方法。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

    // Override point for customization after application launch.
    self.viewController = [[[PhotoViewController alloc] initWithNibName:@"PhotoViewController" bundle:nil] autorelease];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
) 
```

那么在 PhotoViewController.xib 和 MainWindow.xib 文件中进行了哪些配置以使一切正常运行？

* * *

要理解我的意思，请按照以下简单步骤操作：

1.  下载 WWDC 2010 示例代码。

    [http://connect.apple.com/cgi-bin/WebObjects/MemberSite.woa/wa/getSoftware?code=y&source=x&bundleID=20645](http://connect.apple.com/cgi-bin/WebObjects/MemberSite.woa/wa/getSoftware?code=y&source=x&bundleID=20645)

2.  打开磁盘映像，转到 iOS 文件夹，然后解压缩 PhotoScroller.zip。

3.  解压 PhotoScroller.zip，在 Xcode 中打开，编译，在模拟器中运行。

4.  请注意，一切都按预期正常工作。

5.  现在将 AppDelegate.m 中的 application:didFinishLaunchingWithOptions: 更改为以下内容。

    ```
    - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
    {
        PhotoViewController* vc = [[[PhotoViewController alloc] init] autorelease];
        window.rootViewController = vc;
        [window addSubview:vc.view];
        [window makeKeyAndVisible];
        return YES;
    } 
    ```

6.  现在在模拟器中重建并重新运行。

7.  请注意差异，图像未居中，您可以看到黑色填充。

那么 PhotoViewController.xib 中的什么设置使分页 UIScrollView 以 ImageScrollViews 为中心？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:36:08.267

正是由于发布的代码不完整，我不知道您的问题是什么，但下面是我的代码，它 100% 像 PhotoScroller 示例应用程序一样工作。我给出了 3 张图片的例子，请看这个

```
UIImage *iPhone = [UIImage imageNamed:@"iPhone.png"]; 
UIImage *iPad = [UIImage imageNamed:@"iPad.png"]; 
UIImage *macBookAir = [UIImage imageNamed:@"MacBookAir.png"];

CGRect scrollViewRect = self.view.bounds;
self.myScrollView = [[UIScrollView alloc] initWithFrame:scrollViewRect];
self.myScrollView.pagingEnabled = YES; 
self.myScrollView.contentSize = CGSizeMake(scrollViewRect.size.width *scrollViewRect.size.height);
[self.view addSubview:self.myScrollView];

CGRect imageViewRect = self.view.bounds; 
UIImageView *iPhoneImageView = [self newImageViewWithImage:iPhone frame:imageViewRect]; 
[self.myScrollView addSubview:iPhoneImageView];

/* Go to next page by moving the x position of the next image view */  
imageViewRect.origin.x += imageViewRect.size.width;
UIImageView *iPadImageView = [self newImageViewWithImage:iPad frame:imageViewRect];
[self.myScrollView addSubview:iPadImageView];

/* Go to next page by moving the x position of the next image view */  
imageViewRect.origin.x += imageViewRect.size.width; 
UIImageView *macBookAirImageView = [self newImageViewWithImage:macBookAir frame:imageViewRect]; 
 [self.myScrollView addSubview:macBookAirImageView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T18:28:52.647

也许你应该做的是：

1.  创建一个 xib / 或故事板。

2.  将其类更改为 PhotoViewController。

3.  更改其视图所有者。

4.  加载它使用：

    ```
    initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil 
    ```

    或者

    ```
    [self.storyboard instantiateViewControllerWithIdentifier:@"photoViewName"] 
    ```

5.  最后将其添加为子视图：

    ```
    [self.view addSubview:self.photoViewController.view] 
    ```

6.  不要使用：rootViewController/或push/或modal/或segue。

7.  不要将其嵌入导航控制器中。

希望这可以帮助。

# android - 列表视图文本消失

> ID：15043684
> 
> 赞同：1
> 
> 时间：2013-02-23T17:57:50.740
> 
> 标签：android, listview, android-listview

我制作了自定义列表视图，它从手机存储中加载了很多东西，当我向下滚动时，列表视图文本会像这样消失：

![在此处输入图像描述](../Images/4be727e81508a34fe85e8c7a3cacb332.png)

那么如果我向上滚动可见的文本也会消失，经典的列表视图会显示所有文本。这是我的适配器代码：

```
public MusicAdapter(Context context, int layoutResourceId, ListView data[]){
               super();
               mContext = context;

                this.layoutResourceId = layoutResourceId;
                this.context = context;
                this.data = data;
}

public int getCount() {
    return count;
}

public Object getItem(int position) {
     return position;
}

public long getItemId(int position) {
     return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    ListViewHolder holder = null ;
    String id = null;

    if(row == null){
        LayoutInflater inflater = getLayoutInflater();
        row = inflater.inflate(R.layout.listview_item_row, parent, false);
        holder = new ListViewHolder();
        music_column_index = musiccursor.getColumnIndexOrThrow(MediaStore.Audio.Media.DISPLAY_NAME);
        musiccursor.moveToPosition(position);
        id = musiccursor.getString(music_column_index);
        holder.imgIcon = (ImageView)row.findViewById(R.id.imgIcon);
        holder.txtTitle = (TextView)row.findViewById(R.id.txtTitle);
        holder.txtTitle.setText(id);
        holder.imgIcon.setImageResource(R.drawable.musicc);
        row.setTag(holder);
    } else {
         holder = (ListViewHolder)row.getTag(); 
    }
    holder.txtTitle.setVisibility(View.VISIBLE);
    holder.txtTitle.setText(id);
    holder.imgIcon.setImageResource(R.drawable.musicc);
    return row;
} 
```

和行：

```
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:padding="10dp">

     <ImageView android:id="@+id/imgIcon"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:gravity="center_vertical"
        android:layout_alignParentTop="true"
        android:layout_alignParentBottom="true"
        android:layout_marginRight="15dp"
        android:layout_marginTop="5dp"
        android:layout_marginBottom="5dp" />

     <TextView android:id="@+id/txtTitle"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:gravity="center_vertical"
        android:layout_alignParentTop="true"
        android:layout_alignParentBottom="true"
        android:textStyle="bold"
        android:textSize="22dp"
        android:textColor="#000000"
        android:layout_marginTop="5dp"
        android:layout_marginBottom="5dp" />

</LinearLayout> 
```

主.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
      android:orientation="vertical" android:layout_width="fill_parent"
      android:layout_height="fill_parent">
    <ListView
        android:id="@+id/PhoneMusicList"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:cacheColorHint="#00000000"
        android:scrollingCache="false"
        >
    </ListView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T19:04:38.183

您需要将此代码移到 if 语句之外（上方或下方）：

```
music_column_index = musiccursor.getColumnIndexOrThrow(MediaStore.Audio.Media.DISPLAY_NAME);
musiccursor.moveToPosition(position);
id = musiccursor.getString(music_column_index); 
```

否则`id`就是`null`当你的代码通过 else 分支时。

# css - 类扩展 CSS

> ID：15043685
> 
> 赞同：0
> 
> 时间：2013-02-23T17:57:50.950
> 
> 标签：css

例如，我有一些元素在[不同](http://jsfiddle.net/5BhaS/2/)的上下文中具有不同的规则，但有些规则是相同的。

可以为他们定义一个类并在不同的上下文中扩展它吗？

```
.read-more {
    display: inline-block;
    text-align: center;
    padding: 0 15px;
    text-decoration: none;
    color: blue;
    margin-left: 5px;
}
#one .read-more {
    background: yellow;
}
#two .read-more {
    background: #ff9e13;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:14:52.980

您可以扩展一个类以满足不同的需求。

请注意，未覆盖的属性将从原始类中获取。

例子：

```
.read-more {
    display: inline-block;
    text-align: center;
    padding: 0 15px;
    text-decoration: none;
    color: blue;
    margin-left: 5px;
    border: 1px solid red;
    background-image: url('img.png');
}
#one .read-more {
    background: yellow;
    border: 2px solid green;
} 
```

所有带有 just 的元素`read-more`都会有一个红色边框，但那些有 id`one`和 class的元素`read-more`会有绿色边框。

另请注意，该属性`background`将删除`background-image`基类中的属性。`one`因此，具有 id和 class的元素`read-more`将没有图像。

# qt - QWidget：必须在 Python 脚本中的 QPaintDevice 之前构造一个 QApplication

> ID：15043686
> 
> 赞同：1
> 
> 时间：2013-02-23T17:57:55.670
> 
> 标签：qt, pyside, qdialog, qlabel

我想从另一个脚本（“第二个脚本”）调用下面的表单（“第一个脚本”），并且我希望第二个脚本用新信息填充标签字段（可能使用 Qlabel 的 setText 属性）。

第二个脚本中的以下 7 行首先生成没有更新标签的原始窗口；但是在我关闭未更新的窗口后，会出现一个带有更新标签的新窗口。不知道为什么会先出现未更新的窗口。

```
import Form2use4ques4stackoverflow_2013_02_23_am_09_33_45_
app = QApplication(sys.argv)
nuform = Form2use4ques4stackoverflow_2013_02_23_am_09_33_45_.Form()
nuform.prefix_label.setText('newtext')
nuform.show()
#return app.exec_()
app.exec_()
                                            Marc

# -*- coding: latin-1 -*-
"""
Form2use4ques4stackoverflow_2013_02_23_am_09_33_45_.py

"""

import sys
from PyQt4 import QtCore
from PyQt4 import QtGui
from PyQt4.QtCore import (Qt, SIGNAL)
from PyQt4.QtGui import (QApplication, QDialog, QHBoxLayout, QLabel,
        QPushButton)

class Form(QDialog):

    def __init__(self, parent=None):
        super(Form, self).__init__(parent)

        self.initUI()

    def initUI(self):
        okButton01 = QtGui.QPushButton("OK")
        cancelButton01 = QtGui.QPushButton("Cancel")

        prefix_label = QtGui.QLabel('Prefix') 
        self. prefix_label = prefix_label 

        hbox_prefix_digit_iterations = QtGui.QHBoxLayout()
        hbox_prefix_digit_iterations.addWidget(prefix_label)

        hbox_btnsOK_cancel = QtGui.QHBoxLayout()
        hbox_btnsOK_cancel.addStretch(1)
        hbox_btnsOK_cancel.addWidget(okButton01)
        hbox_btnsOK_cancel.addWidget(cancelButton01)

        vbox0 = QtGui.QVBoxLayout()
        vbox0.addLayout(hbox_prefix_digit_iterations)
        vbox0.addStretch(1)
        vbox0.addLayout(hbox_btnsOK_cancel)

        self.setLayout(vbox0)

        self.setGeometry(300, 300, 600, 300) #class PySide.QtCore.QRectF(left, top, width, height)   http://srinikom.github.com/pyside-docs/PySide/QtCore/QRectF.html#PySide.QtCore.QRectF
        self.setWindowTitle('Duplicate Code Strings W/Increasing Numbers')  
        self.show()

def formm():
    app = QApplication(sys.argv)
    form = Form()
    form.show()
    app.exec_()

if 1 == 1:
    formm() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T19:20:40.573

错误消息告诉它：您必须先创建一个 QApplication，然后才能创建表单。基本上，您的第一个脚本中的 formm() 包含您必须执行的所有操作：

1.  创建一个 QApplication 对象
2.  创建要显示的小部件
3.  通过 QApplication::exec() 进入事件循环

在您的第二个脚本的上下文中，这将如下所示：

```
import Form2use4ques4stackoverflow_2013_02_23_am_09_33_45_
app = QApplication(sys.argv)
nuform = Form2use4ques4stackoverflow_2013_02_23_am_09_33_45_.Form()
nuform.prefix_label.setText('newtext')
nuform.show()
return app.exec() 
```

# php - 使用 Facebook php sdk 未捕获的 OAuthException

> ID：15043687
> 
> 赞同：0
> 
> 时间：2013-02-23T17:58:00.530
> 
> 标签：php, facebook, facebook-php-sdk

我在这里看到了很多类似的问题，但要么他们问的不是同一个问题，要么解决方案对我不起作用。我的问题是，这给了我错误日志中的 Uncaught OAuthException ：

```
require_once 'fb-php-sdk/facebook.php';

// Facebook App Info
$app_id = MYAPPID;
$app_secret = MYAPPSECRET;

// Load info into config array for Facebook object
$config = array(
    'appId' => $app_id,
    'secret' => $app_secret,
    'fileupload' => false,
    'cookie' => true
);

// Initialize Facebook
$fb = new Facebook($config);

// Retrieve user ID
$my_access_token = $fb->getAccessToken();
$uid = $fb->getUser();

// Login if the UID was 0
if (!$uid) {

    // Login parameters including redirect URL
    $params = array(
        'scope' => 'read_stream, friends_likes',
        'redirect_uri' => 'MYURL'
    );

    // Log the user in
    $loginUrl = $fb->getLoginUrl($params);
}

echo '<p>w00t!</p>';
echo '<p>token1: ' . $my_access_token;

$user_profile = $fb->api('/me', 'GET', array('access_token' => $my_access_token));
echo '<p>Name: ' . $user_profile['name'] . '</p>'; 
```

这将输出“w00t！” 其次是我的令牌，但它从不打印我的用户名，并在我的日志中给出错误。有任何想法吗？我直接从文档中的示例中获取了用户配置文件代码。

# php - 通过 php post 函数发送 mysql 查询的结果

> ID：15043689
> 
> 赞同：0
> 
> 时间：2013-02-23T17:58:13.947
> 
> 标签：php, mysql

我对PHP非常缺乏经验，只是一些基本的了解，我试图通过post方法将MySQL查询的结果发送到特定的URL。如果我在网页上的表格中显示，那么在连接信息之后我会......

```
$result = mysql_query("select Selection, Date, Name from selectiontable order by Date");

echo "<table border='1'>
<tr>
<th>Selection</th>
<th>Race</th>
<th>Name</th>
</tr>";

while($row = mysql_fetch_array($result))
{
echo "<tr>";
echo "<td>" . $row['Selection'] . "</td>";
echo "<td>" . $row['Date'] . "</td>";
echo "<td>" . $row['Name'] . "</td>";
echo "</tr>";
}
echo "</table>"; 
```

我不想打印到表格，而是想通过 Post 将此信息发送到 URL。我搜索了高低，似乎只能找到有关如何发送通过表单输入的信息的信息。此查询产生大约 200 行。有人向我发送了以下脚本以进行调整，但我不知道如何将查询结果放入其中。

```
<?php 

$entries=(isset($_GET['entries']) ? $_GET['entries'] : '1');

echo '<h2>Send</h2>';
echo '<style> .over{clear:both; margin:5px; border:1px solid #ccc; padding:10px;}               label{display:block;} input {display:block; margin:5px 0 0 0;}</style>';
echo'<form method="post" action="http://www.domain.com" id="" name="">';

for ($i=0; $i < $entries; $i++) { 

echo '
<div class="over">
<div class="proof_type">
<label for="selection_'.$i.'">Selection</label>
<input name="selection_'.$i.'" value="" type="text" >
</div>

<div class="proof_type">
<label for="date_'.$i.'">Date</label>
<input name="date_'.$i.'" value="" type="text" >
</div>

<div class="proof_type">
<label for="name_'.$i.'">Name</label>
<input name="name_'.$i.'" value="" type="text" >
</div>
</div>
';

}

echo '<input type="hidden" name="action" value="insert" />';
echo'<input type="submit" name="submit" value="submit" class="button" />';
echo'</form>';

?> 
```

我将非常感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:01:27.870

如果你想通过 URL 发送信息，它将通过`GET`方法接收。否则，您将需要一个类似的库`cURL`来完成此操作。

# ios - IOS NSURLConnection 和 AFImageRequestOperation 奇怪的行为

> ID：15043692
> 
> 赞同：0
> 
> 时间：2013-02-23T17:58:17.423
> 
> 标签：ios, nsurlconnection, afnetworking

我绝对是个菜鸟，我真的需要你的帮助。我已经在寻找一个一周的解决方案，但我真的不知道该怎么做。我正在尝试从 Web 服务下载一些图标（png 图像），并且我已经在其他地方使用过代码，但仅适用于 1 个图像，而不适用于多个图像。在这种情况下，我应该下载 15 张图片。在这两种情况下，使用 AFImageRequestOperation 或 NSURLConnection sendAsynchronousRequest，我到达了所有 15 个图像的末尾，但之后它以一个我真的不知道如何修复的错误开始，因为它不应该出现在那里！( ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFArray CGPointValue]：无法识别的选择器已发送到实例）。如果我使用 synchronousRequest 下载 15 个图像，则完全没有问题。我做错了什么？是我的错在这里还是其他地方？非常感谢。

```
NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:imagePath]];
AFImageRequestOperation *operation = [AFImageRequestOperation imageRequestOperationWithRequest:request imageProcessing``Block:nil                                                                                            success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
         // Save Image
        [images_icon addObject:image ];
        if ([images_icon count]==[allIcons count]) {
            [self saveAllImagesToDisk];
        }
        }
        failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
          NSLog(@"%@", [error localizedDescription]);
          UIAlertView* allerta=[[UIAlertView alloc] initWithTitle:@"Attention"
                    message:@"Some problems here.."
                    delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
          [allerta show];
        }];
    [operation start]; 
```

* * *

```
NSURL *url = [NSURL URLWithString:percorsoImmagine];
    NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url];
    NSOperationQueue *queue = [[NSOperationQueue alloc] init]; 
    [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
     {NSLog(@"lungh %d, error=%@ mime=%@",[data length], error, response.MIMEType);
         if ([data length] > 0 && error == nil && ([response.MIMEType isEqualToString:@"image/png"] || [response.MIMEType isEqualToString:@"image/jpeg"])){
             [images_icon addObject:data ];
             if ([images_icon count]==[allIcons count]) {
                [self saveAllImagesToDisk];
             }
         }
     }]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:05:21.037

当您使用时，`AFImageRequestOperation`您将`UIImage`s 添加到，`images_icon`但是当您使用时，`NSURLConnection`您将`NSData`s 添加到`images_icon`. 我们需要`[self saveAllImagesToDisk]`进一步调查。

# php - 如何在一张表中获取多语言数据（codeingiter、Mysql、Php）

> ID：15043693
> 
> 赞同：1
> 
> 时间：2013-02-23T17:58:22.053
> 
> 标签：php, mysql, codeigniter

你好吗 ？

我的网站有多种语言（英语、法语、阿拉伯语、.. 等），我的后端表格中有显示内容（帖子）..

我想在此表中显示（标题、内容、支持语言）

看数据库结构

[http://saudi-hotels.info/tables.jpg](http://saudi-hotels.info/tables.jpg)

![在此处输入图像描述](../Images/246d0afa6d75dec44aca5000f309bd86.png)

我想显示像这张表这样的数据

[http://saudi-hotels.info/table_information.jpg](http://saudi-hotels.info/table_information.jpg)

![在此处输入图像描述](../Images/3a8497c3b97029ef752c6d15c3e26021.png)

我试图得到一个好的查询，但我无法查看我的查询：

```
$this->db->from('localization_posts PL');
        $this->db->join('posts PO' , 'PO.id_post = PL.id_post');
        $this->db->join('langauges LN', 'LN.id_language = PL.id_langauge');
        $result = $this->db->get()->result_array(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:48:07.880

如果我没记错的话，你想要给出一种查询。

试试这个。

```
SELECT lp.title_post, lp.content_post, p.views_post, 
       GROUP_CONCAT(l.id_language) AS l.support_language 
FROM localization_posts lp
INNER JOIN posts p ON lp.id_post = p.id_post
LEFT JOIN languages l ON lp.id_language = l.id_language; 
```

希望会有所帮助。

# python - 用 Python-Pexpect 读取 'ipconfig'

> ID：15043694
> 
> 赞同：0
> 
> 时间：2013-02-23T17:58:32.210
> 
> 标签：python

我在win XP上运行freeSSHd作为SSH服务器，它为经过身份验证的用户返回CMD shell，我想在运行python脚本时自动获得发送'ipconfig'命令的结果，我得到了连接但我有读取每个字段的结果并将其放入单独的变量中的问题，我的代码的结果是“4”而不是“10”> IP 地址中的第一个数字，我不知道数字 4 来自哪里。任何想法？

Win XP ipconfig 的输出

C:\Documents and Settings\hussam\Desktop>ipconfig

```
Windows IP Configuration

Ethernet adapter Local Area Connection:

        Connection-specific DNS Suffix  . :
        IP Address. . . . . . . . . . . . : 10.0.2.10
        Subnet Mask . . . . . . . . . . . : 255.255.255.0
        Default Gateway . . . . . . . . . : 10.0.2.15

C:\Documents and Settings\hussam\Desktop> 
```

我的代码

```
import pexpect
import re

def sendcommand(conn,command):
    conn.sendline(command)
    conn.expect('\d')
    print conn.after

def c(ip,username,password):
    global conn
    ft = 'ssh '+username+'@'+ip
    print 'we are trying to connect to ' + ft
    new = 'Are you sure you want to continue connecting'
    conn = pexpect.spawn(ft)
    result = conn.expect([ pexpect.TIMEOUT , new ,'[P|p]assword:' ])
    if result == 0:
        print 'connection error'
        return
    if result == 1:
        conn.sendline('yes')
        result = conn.expect([ pexpect.TIMEOUT , '[P|p]assword:'])
    if result == 0:
        print 'connection error'
        return
    conn.sendline(password)
    conn.expect('>')
    sendcommand(conn,command)

def main ():
    global command
    username = 'hkhrais'
    ip = '10.0.2.10'
    password = 'hkhrais'
    command = ' ipconfig'
    c(ip,username,password)

 main () 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:40:06.603

使用起来更简单[`WMI`](http://timgolden.me.uk/python/wmi/cookbook.html#show-the-ip-and-mac-addresses-for-ip-enabled-network-interfaces)：

```
import wmi

def return_ip_addresses(user,passwd,machine):

    i = wmi.WMI(machine, user=user, password=passwd)

    addresses = []

    for interface in i.Win32_NetworkAdapterConfiguration(IPEnabled=1):
      for ip_address in interface.IPAddress:
         addresses.append(ip_address)

    return addresses

if __name__ == '__main__':      
   print return_ip_addresses('user','secret','10.1.1.1') 
```

# java - 如果 Java 出现 else 的问题

> ID：15043696
> 
> 赞同：-4
> 
> 时间：2013-02-23T17:58:47.603
> 
> 标签：java

我在尝试在 java 中创建 else if 循环时遇到了一个小问题，我想做的是创建一个循环，如果文件夹中的文件数为 1 或更少，那么如果它比这更好，它会执行一个操作进入另一个循环

到目前为止，这是我的循环，但没有编译：

```
if (new File(destination).listFiles().length) <=1 {
        return "/GUI/printServerSide.xhtml";
    }else if
         ("txt".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else if ("jpeg".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else if ("jpg".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else if ("png".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else if ("gif".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else if ("pdf".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else if ("html".equalsIgnoreCase(extension)) {
            return "/GUI/submittedFilePreview.xhtml";
        } else {
            return "/GUI/printServerSide.xhtml";
        }

    }
} 
```

我究竟做错了什么 ？

提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:05:59.413

我在给定的代码片段中看到两个错误，一个在第一个条件中，另一个在 if...

```
if (new File(destination).listFiles().length <= 1) {
    return "/GUI/printServerSide.xhtml";
}
else if("txt".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else if ("jpeg".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else if ("jpg".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else if ("png".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else if ("gif".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else if ("pdf".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else if ("html".equalsIgnoreCase(extension)) {
    return "/GUI/submittedFilePreview.xhtml";
}
else {
    return "/GUI/printServerSide.xhtml";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:01:51.387

```
}else if
      ^^
    if ("txt".equalsIgnoreCase(extension)) {
    ^^ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:18:50.773

这个怎么样？

```
private static final String SUBMITTED_FILE_PREVIEW = "/GUI/submittedFilePreview.xhtml";
private static final String PRINT_SERVER_SIDE = "/GUI/printServerSide.xhtml";

String yourMethod(String destination, String extension) {
    if (new File(destination).listFiles().length <= 1) {
        return PRINT_SERVER_SIDE;
    } else if ("txt".equalsIgnoreCase(extension)
            || "jpeg".equalsIgnoreCase(extension)
            || "jpg".equalsIgnoreCase(extension)
            || "png".equalsIgnoreCase(extension)
            || "gif".equalsIgnoreCase(extension)
            || "pdf".equalsIgnoreCase(extension)
            || "html".equalsIgnoreCase(extension))
        return SUBMITTED_FILE_PREVIEW;

    return PRINT_SERVER_SIDE;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T18:11:25.133

首先，根据您不需要的逻辑`else-if-else`，仅`if`在所有情况下都可以，因为您在每个块之后都返回控制权
其次，更正您的陈述或
`if (new File(destination).listFiles().length) <=1 {`
用此 更新您的问题`if (new File(destination).listFiles().length <=1) {`

# unit-testing - 使用 Moq，我是否总是需要模拟所有依赖项？

> ID：15043698
> 
> 赞同：2
> 
> 时间：2013-02-23T17:58:48.233
> 
> 标签：unit-testing, dependency-injection, refactoring, mocking, moq

在我的 100 多次测试中，我有以下一行：

```
var registry = new Mock<ObjectRegistry>(new List<Assembly>()).Object; 
```

稍作重构将我的 ObjectRegistry 构造函数更改为：

```
public ObjectRegistry(AssemblyRegistry assemblies, UserPromt userPromt) 
```

所以我必须更新我所有的 100 个测试用例来使用以下模拟：

```
var objectRegistry = new Mock<ObjectRegistry>(Mock.Of<AssemblyRegistry>(), Mock.Of<UserPromt>()); 
```

我想要的是所有依赖项都是模拟的，无论我需要什么依赖项都是不变的。

我可以告诉 Moq 以某种方式自动模拟它需要的所有依赖项吗？

在带有 Mockito 的 java 中，这根本不是问题......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:07:18.180

你在这里嘲笑一个具体的对象。Moq 与接口一起使用时效果最佳。尝试[模拟角色，而不是对象](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDQQFjAA&url=http://jmock.org/oopsla2004.pdf&ei=mQUpUb_1IbKN0wXqloHIBA&usg=AFQjCNG1hoMD7NunoONsaOmVDgaQYkNmFA&sig2=7bAySxnUn5GMNBCs12mjBg&bvm=bv.42768644,d.d2k)(pdf)。例如，引入一个接口，如`IObjectRegistry`. 目前您的代码知道它正在处理一个 ObjectRegistry，理想情况下，您应该能够随时切换您的实现。只要你有一个抽象的地方。对于可测试性和编程最佳实践来说，“*编程到接口*”将是理想的选择。注意这里的接口不一定是指 C#/Java 等方面的接口。

```
var registry = new Mock<IObjectRegistry>();

public class ObjectRegistry : IObjectRegistry { // Snip } 
```

然后用这个。由于这是一个接口，您可以随意更改具体（真实/生产）类及其构造函数。您的测试和系统的其余部分应该不知道。如果注册表在接口上有一个方法，例如`GetObject`您的系统应该简单地依赖这个抽象，而不是它正在使用`ObjectRegistry`实例的事实。

目前，您的代码实际上是在创建一个真实的实例`ObjectRegistry`，然后对有问题的方法进行存根/模拟。在大多数情况下，这并不理想。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T09:52:01.363

您的问题的最佳实践是使用接口而不是具体类，并通过这些接口传递您的依赖关系。

`public ObjectRegistry(IAssemblyRegistry assemblies, IUserPromt userPromt)`

# objective-c - Objective-c FMDB SQLite 插入带有参数字典和自动增量键

> ID：15043700
> 
> 赞同：0
> 
> 时间：2013-02-23T17:58:50.083
> 
> 标签：objective-c, sqlite, fmdb

我有一个使用 FMDB 库的 iOS 应用程序。

有 7 个字段 SQLite DB（1 个自动增量，6 个常规文本字段）。

我正在尝试执行

```
 [db executeUpdate:@"INSERT INTO messages  VALUES (:field1,:field2,:field3,:field4,:field5,:field6)" withParameterDictionary:message]; 
```

但是，因为只有 6 个字段，我收到错误消息。我无法插入自动增量值，因为我不知道它是什么（我想我可以为此单独查询......）。而且我试图避免注入敏感的语法

```
NSString* sql = [NSString stringWithFormat:@"insert into messages (%@) values (%@)", [newCols componentsJoinedByString:@", "], [newVals componentsJoinedByString:@", "]]; 
```

谢谢你的建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-16T04:18:47.003

您没有指定哪一列是自动增量列，所以我假设它只是“field1”。当你建立你的字典时，添加这个：

```
[message setObject:[NSNull null] forKey:@"field1"]; 
```

然后

```
[db executeUpdate:@"INSERT INTO messages  VALUES (:field1,:field2,:field3,:field4,:field5,:field6)" withParameterDictionary:message]; 
```

请务必将“field1”更改为您用于自动增量的任何字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T19:44:34.377

我刚刚查看了我也使用 FMDB 的代码。首先，您还必须提供插入语句的列。这就是我所做的：

```
NSString *sqlSL = @"INSERT INTO SmartLibrary (TITEL, SUBTITEL, PICTURE, BLURB, MARK) VALUES (?, ? ,? ,? ,?)";
[db beginTransaction];
[db executeUpdate:sqlSL, book.title, book.subtitle, book.picture, book.summary, [NSNumber numberWithInteger:book.mark]];
[db commit]; 
```

在这种情况下，我有一本结构书。因此，您需要做的是在括号中提供受此插入影响的列。您还可以看到如何制作准备好的语句，并且应该使用事务。希望这会有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-02T07:20:53.330

我收到这个错误是因为我监督了一百次查看代码的错字：其中一个字典键是错误的。在这种情况下，FMDB 将以下错误打印到调试控制台：

```
Could not find index for <wrong_dict_key_name> 
```

FMDB 打印到控制台的下一个错误有点误导：

```
Error: the bind count (6) is not correct for the # of variables in the query (7) (INSERT INTO ... 
```

根本原因当然是错误的字典键。

# java - 序列化动态生成的类

> ID：15043702
> 
> 赞同：1
> 
> 时间：2013-02-23T17:58:53.737
> 
> 标签：java, serialization, dynamic-class-loaders

假设我有一个抽象类

```
public abstract class Base implements Serializable {
    static final long serialVersionUID = 1;
    public Base(int x) { ... }
    public abstract void baseMethod();
} 
```

然后我动态创建类

```
public class Temp {
    public Base getBase() {
        return new Base(2) {

            static final long serialVersionUID = 1;

            @Override
            public void baseMethod() { .... } 
        };
    }
} 
```

我能够从 String 动态生成类 Temp，调用一个新实例，然后提取基础对象并像任何其他扩展 Base 的实例一样使用它。当我序列化时，问题就来了。我可以序列化从动态 Temp 类中提取的 Base 基础对象，但随后我无法在不同的会话中反序列化，因为 Temp 不再位于类路径上。

你们能想出什么办法来解决这个问题吗？必须有一种方法可以将有问题的 Base 对象与 Temp 类隔离开来（在我从中提取 Base 类之后我从不关心）。Base 对象不依赖于 Temp 类中的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:24:38.243

尝试`writeReplace`在您的`Temp`对象上实现，以便它编写 a `Base`，并`readResolve`在您的`Base`对象上实现，以便它创建`Temp`包装它的 a 。请参阅[Serializable 合约](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/Serializable.html)。

代码看起来像这样。请注意，我实际上并没有对此进行测试，但应该非常接近。

```
public class Base implements Serializable {
    // Existing members here

    private Object readResolve() throws ObjectStreamException {
        return new Temp(this);
    }
}

public class Temp implements Serializable {
    Base base;

    public Temp(Base base) {
        this.base = base;
    }

    // Other existing methods here

    private Object writeReplace() throws ObjectStreamException {
        return base;
    }
} 
```

我意识到这在这两个类之间引入了令人讨厌的循环依赖，但我没有看到另一种很好的方法，除了其他人建议的外部读取器/写入器方法。这种方法的优点是它支持将 a`Temp`作为更大对象图的一部分写出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T19:02:30.837

那么首先，理查德这真的是我第一次看到这个特殊的案例，感谢您提出来；）在这里，我已经开发了一些解决您问题的方法。我希望这可能对您有所帮助。：

```
import java.io.*;
abstract class Base implements Serializable
{
    protected int x ;
    private static final long serialVersionUID = 1L;
    public Base(int x) { this.x = x; }
    public abstract void baseMethod();
}
class Temp implements Serializable
{
    private static final long serialVersionUID = 2L;//Make Temp serializable also.
    public Base getBase(int i) 
    {
        Base base = new Base(i)
        {
            static final long serialVersionUID = 1L;
            @Override
            public void baseMethod() { System.out.println(x); } 
        };
        return base;
    }
}
public class ReadWriteBaseObject 
{
    public static Base createBaseObject(int i)
    {
        Temp temp = new Temp();//You might be creating your Temp object here Dynamically..
        Base base = temp.getBase(i);
        return base;
    }
    public static Base read()
    {
        ObjectInputStream oin = null;
        try
        {
            FileInputStream fin = new FileInputStream("BASE.ser");
            oin = new ObjectInputStream(fin);
            Base base = (Base)oin.readObject();
            return base;
        }
        catch (Exception ex)
        {
            ex.printStackTrace();
            return null;
        }
        finally
        {
            if (oin!=null)
            {
                try
                {
                    oin.close();
                }
                catch (Exception ex){}
            }
        }
    }
    public static void write(Base base)
    {
        if (base == null)
        {
            System.out.println("Can't write null");
            return;
        }
        ObjectOutputStream os = null;
        try
        {
            FileOutputStream fos = new FileOutputStream("BASE.ser");
            os = new ObjectOutputStream(fos);
            os.writeObject(base);
            System.out.println("Wrote to file");
        }
        catch (Exception ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if (os!=null)
            {
                try
                {
                    os.close();
                }
                catch (Exception ex){}
            }
        }
    }
    public static void main(String st[])
    {
        Base base = createBaseObject(45);
        write(base);
        Base obj = read();
        obj.baseMethod();
    }
} 
```

**编辑**
虽然匿名类实例可以成功序列化，但由于一些复杂性，Java 仍然强烈反对它。[**以下**](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4862448)是java官方网站的说明：

> 注意 -**强烈建议不要对内部类（即不是静态成员类的嵌套类）（包括本地和匿名类）进行序列化，原因有几个**。因为在非静态上下文中声明的内部类包含对封闭类实例的隐式非瞬态引用，所以序列化这样的内部类实例也会导致其关联的外部类实例的序列化。由 javac（或其他 JavaTM 编译器）生成的用于实现内部类的合成字段是依赖于实现的，并且可能因编译器而异；这些领域的差异可能会破坏兼容性并导致
> 冲突的默认 serialVersionUID 值。分配给本地和匿名内部类的名称也取决于实现，并且可能因编译器而异。由于内部类不能声明编译时常量字段以外的静态成员，因此它们不能使用 serialPersistentFields 机制来指定可序列化字段。最后，因为与外部实例关联的内部类没有零参数构造函数（此类内部类的构造函数隐式接受封闭实例作为前置参数），它们无法实现 Externalizable。然而，上面列出的所有问题都不适用于静态成员类。

要了解有关 java 中的序列化的更多信息，您可以[**在此处观看**](http://docs.oracle.com/javase/7/docs/platform/serialization/spec/serial-arch.html)

# android-sqlite - ActiveAndroid - 不创建任何字段

> ID：15043704
> 
> 赞同：2
> 
> 时间：2013-02-23T17:59:14.390
> 
> 标签：android-sqlite, activeandroid

我只是尝试使用 ActiveAndroid。[按照他们从这里开始](https://github.com/pardom/ActiveAndroid/wiki/Getting-started)的教程，我设置了所有内容。我添加了清单条目：

> 应用程序 android:name="com.activeandroid.app.Application" ...
> 
> ```
> meta-data android:name="AA_DB_NAME" android:value="MyDb.db"
> meta-data android:name="AA_DB_VERSION" android:value="1" 
> ```

并创建了我的模型类：

```
package com.mycomp.Model;

import org.joda.time.LocalDate;
import org.odata4j.core.Guid;

import com.activeandroid.Model;
import com.activeandroid.annotation.Column;
import com.activeandroid.annotation.Table;

@Table(name = "Table1")
public class Table1 extends Model
{
  @Column(name = "Custom_ID")
  public Guid Custom_ID;
  @Column(name = "Name")
  public String Name;
  @Column(name = "Usr_type")
  public int Usr_type;
  @Column(name = "BDate")
  public LocalDate BDate;

  public MyEnum UserGroup;

  public Table1()
  {
    super();
  }

  public Table1(String name, LocalDate date, Guid custom_id,
      MyEnum userGroup)
  {
    super();
    Name = name;
    BDate = date;
    Custom_ID = custom_id;
    UserGroup = userGroup;
  }

} 
```

之后，我使用了 save 方法（据称它创建了底层数据库结构）：

```
Table1 t1=new Table1();
t1.Name="Test";
t1.UserGroup = MyEnum.G1;
t1.save(); 
```

它抛出了一个异常： **表 Table1 没有名为 Name 的列**

我用 SQLite 浏览器检查了它。该表存在但仅包含一个字段：*Id*。我还应该做什么来创建其他字段？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-24T05:55:55.397

好吧，我相信，在他们的教程中分享 ActiveAndroid 在第*一次*运行时创建数据库结构*应该很重要。*如果您更改模型，它不会同步它。解决方案：从手机/模拟器中**删除**db 文件，下次运行时，它可以工作。

 **** * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-06-27T13:24:32.420

还有另一种解决方案：更改**AA_DB_VERSION**元数据值并将修改脚本放置到*assets/migrations*文件夹，以便 ActiveAndroid 将使用升级功能。当数据库中已有数据时，它会派上用场。

来源：[https ://github.com/pardom/ActiveAndroid/wiki/Schema-migrations](https://github.com/pardom/ActiveAndroid/wiki/Schema-migrations)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-17T17:36:39.933

可能是您在创建数据库后对类进行了更改，因此 activeandroid 无法识别表列。您可以卸载 apk，也可以清除应用程序的缓存数据。***

# c# - 如何让 WebAPI HelpPage 包与 HotTowel 模板一起使用？

> ID：15043705
> 
> 赞同：4
> 
> 时间：2013-02-23T17:59:21.680
> 
> 标签：c#, asp.net-mvc, asp.net-web-api, breeze, hottowel

我正在试用 John Papa 的新[热毛巾](http://www.johnpapa.net/hottowel/)模板。它*真的很*漂亮，但我在让它与我习惯的 Web API 配合使用时遇到了一些困难。

我能够解决路由问题，但我仍然无法让[Microsoft.AspNet.WebApi.HelpPage](http://blogs.msdn.com/b/webdev/archive/2012/11/08/enabling-asp-net-web-api-help-pages-for-asp-net-web-forms-applications.aspx)包工作。

这是我所做的：

*   安装[热毛巾 VSIX](http://www.asp.net/single-page-application/overview/templates/hottowel-template)。
*   新的 ASP.NET MVC4 项目 - 热毛巾 SPA 模板
*   构建，运行 - 工作。
*   右键单击`Controllers`文件夹，添加名为`TestController`.
*   选择“空 API 控制器”模板。
*   在 TestController 中编写以下操作：

    ```
    public IEnumerable<string> GetTestData()
    {
         return new[] { "A", "B", "C" };
    } 
    ```

*   构建，运行。

*   尝试 URL`/api/test`获取错误 404`The resource cannot be found.`
*   试试网址`/api/test/gettestdata`。作品。

然后我注意到`BreezeWebApiConfig.cs`已经改变了默认的api路由，并且需要{action}，所以我添加了默认的api路由：

```
GlobalConfiguration.Configuration.Routes.MapHttpRoute(
    name: "DefaultApi",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional }
    ); 
```

现在，当我尝试 URL 时`/api/test`，它可以工作。

现在我想使用帮助包。

*   添加`Microsoft.AspNet.WebApi.HelpPage`nuget包。
*   添加`AreaRegistration.RegisterAllAreas();`到`Global.asax.cs`
*   构建，运行。

当我尝试访问 URL`/Help`时，出现以下错误：

```
System.InvalidOperationException: The view 'Index' or its master was not found
or no view engine supports the searched locations.
The following locations were searched:
    ~/Views/Help/Index.aspx
    ~/Views/Help/Index.ascx
    ~/Views/Shared/Index.aspx
    ~/Views/Shared/Index.ascx
    ~/Views/Help/Index.cshtml
    ~/Views/Help/Index.vbhtml
    ~/Views/Shared/Index.cshtml
    ~/Views/Shared/Index.vbhtml 
```

在不破坏 HotTowel 模板的情况下解决此错误的正确方法是什么？

这些中的任何一个都应该被视为错误吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T00:24:28.167

安装 HotTowel 模板并创建应用程序，然后安装 HelpPage 后，我注册了帮助页面区域，如下所示：

```
protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
    } 
```

但是上面这样做会导致可路由路由按以下顺序排列，并且注意到您提到的类似问题。

```
a.Breeze Api route
b.HotTowel route
c.Help page route
d.ignored routes
e.RouteConfig routes 
```

因此，我通过执行以下操作修复了上述路线顺序：

1.  注释掉 App_Start 文件夹下配置文件中的“[assembly: WebActivator.PreApplicationStartMethod”调用。

2.  在 Global.asax.cs 中按以下顺序注册路由。这似乎已经解决了我看到帮助页面、调用 api 路由并相应地查看主页的问题。

    ```
    protected void Application_Start()
    {
        //help page
        AreaRegistration.RegisterAllAreas();

        //api
        BreezeWebApiConfig.RegisterBreezePreStart();

        //hot towel
        HotTowelRouteConfig.RegisterHotTowelPreStart();

        //register bundles
        HotTowelConfig.PreStart();

        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
    } 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T22:07:32.950

有趣的。如果您删除\注释掉整个“HotTowelMvc”路由定义（在 HotTowelRouteConfig.cs 中），然后将 RouteConfig.cs 中的“Home”默认控制器字符串替换为“HotTowel”，则一切正常，包括帮助包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T19:03:03.537

您添加了自己的路线吗？微风路线不适用于您添加的任何自定义路线。

# javascript - 需要调用 I18n Javascript，不知何故不能

> ID：15043706
> 
> 赞同：0
> 
> 时间：2013-02-23T17:59:24.420
> 
> 标签：javascript, ruby-on-rails-3

在 Ruby on Rails 中，我在 AJAX 方法中，如下所示，我从数组中加载数据：

```
$(function () {
  $.ajax({
    url: '/areas',
    dataType: 'json',
    success: function(dat) {
      for (var i = 0; i < dat.length; i++) {
        var d = (data[i] = {});
        d["length_unit"] = dat[i].length_unit; 
```

问题是，我在右侧真正需要的是 I18n.t(dat[i].length_unit) 我有一个 config/locales/sp.yml 文件，如果我这样做，则找不到翻译. 我也尝试过这样的事情：

```
d["length_unit"] = <%= I18n.t(dat[i].length_unit) %>; 
```

但这不起作用，因为没有以这种方式找到变量“dat [i]”。如何在右侧进行 I18n 翻译？

**附加信息。** 在服务器上，在区域的索引方法中，我这样做：

```
respond_to do |format|
  format.html
  format.json { render :json => @areas }
end 
```

我真正需要做的是用 I18n.t(@area.length_unit) 渲染每个 @area，而不是 @area.length_unit。换句话说，我在渲染之前需要做一点预处理，我不知道该怎么做。

# java - 用于评估表示算术表达式的二叉树的非递归方法

> ID：15043710
> 
> 赞同：3
> 
> 时间：2013-02-23T17:59:36.227
> 
> 标签：java, algorithm, binary-tree

正如主题所述，我需要描述一种在不使用递归的情况下评估二叉算术表达式树的方法。没有其他细节或指示给我。

就我对这些事情的理解而言，我需要模拟树的中序遍历。假设我的教科书中概述的 ADT 方法的可用性，我有`hasLeft()`、`hasRight()`、`left()`、`right()`、`isInternal()`和`isExternal()`方法。我需要问我的教授我是否可以自己制作这样的方法，但是没有可用的`parent()`方法，所以我可以遍历树。不过，我确实有`root()`方法。

有人可以指出我正确的方向来弄清楚如何做到这一点吗？我想不出没有递归的方法，因为我没有办法立即跳回树上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T18:04:29.907

您可以保留一堆已经访问过的节点。然后通过将一个新节点推入堆栈来替换递归调用，并从堆栈中弹出一个递归函数将返回的节点。

请记住，在执行递归函数时，总会有一个隐式堆栈来记住每个函数调用中传递了哪些参数。

# mongodb - 在新的 Meteor 应用程序开发中使用本地 MongoDB 而不是 minimongo

> ID：15043714
> 
> 赞同：4
> 
> 时间：2013-02-23T17:59:50.817
> 
> 标签：mongodb, meteor

是否可以使用常规 MongoDB 的本地实例代替默认的 minimongo 来启动一个新的 Meteor 项目？

如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T18:02:57.040

使用流星运行的 mongodb 仍然是标准的 mongodb，minimongo 只是它的客户端实现，它允许浏览器端对集合进行查询。

[如非官方流星常见问题解答](https://github.com/oortcloud/unofficial-meteor-faq)中所述，使用您的终端像这样启动流星

```
MONGO_URL=mongodb://localhost:27017/database meteor 
```

**编辑：**

您可以阅读以下内容`projectdir/.meteor/local/build/README`：

> 这是一个 Meteor 应用程序包。它只有一个依赖项，node.js（带有“fibers”包）。要运行应用程序：
> 
> ```
> $ npm install fibers@1.0.0
> $ export MONGO_URL='mongodb://user:password@host:port/databasename'
> $ export ROOT_URL='http://example.com'
> $ export MAIL_URL='smtp://user:password@mailhost:port/'
> $ node main.js 
> ```
> 
> 使用 PORT 环境变量来设置应用程序将监听的端口。默认值为 80，但在大多数系统上都需要 root。
> 
> 在meteor.com 上了解有关Meteor 的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-17T20:39:49.947

如果您已经安装了 mongodb，只需使用命令运行 Meteor 项目

```
MONGO_URL=mongodb://localhost:27017/meteorprojectname meteor run 
```

[我在这里](http://meteor.hromnik.com/blog/meteor-run-without-creating-local-mongo-database)找到了答案

# linq - linq 查询用另一个数据表过滤数据表

> ID：15043720
> 
> 赞同：0
> 
> 时间：2013-02-23T18:00:25.420
> 
> 标签：linq

我有大约 10,000 条记录的数据表，其中一个列 st_ID，我想过滤的是基于另一个数据表的数据表，其中一个列是 bt_ID。

我只想要 linq 中的这个解决方案

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:04:53.280

太模糊了，这两者之间有没有外键关系？

在任何情况下，您都可以使用`Join`语法示例：

```
from t1 in context.Table1
join t2 in context.Table2 on t1.st_ID equals t2.bt_ID
select............ 
```

如果您有正确的 FK 关系，您应该能够直接使用属性进行查询。

# javascript - 在递归函数调用之前使用 return 子句与不使用有什么不同？

> ID：15043723
> 
> 赞同：1
> 
> 时间：2013-02-23T18:01:00.053
> 
> 标签：javascript, recursion, return-value

我只是在尝试一些递归，并注意到一些让我感到困惑的东西。让我用一些代码示例来说明：

```
function loop(x) {
  if (x >= 10) 
    return x;
  loop(x + 1); // the recursive call
}
loop(0); 
```

上面的调用返回`undefined`。如果我将其更改为

```
function loop(x) {
  if (x >= 10) 
    return x;
  return loop(x + 1); // the recursive call
}
loop(0); 
```

然后它`10`正确返回。

为什么会这样？`return`该子句如何影响堆栈？

PS：[类似的问题](https://stackoverflow.com/questions/14833843/i-try-to-generate-random-3-numbers-numbers-with-the-php-code-but-when-i-try-t/)

**编辑：** [这是一张快速图片，概述了我所理解的内容。（我绝对没有油漆。）](https://imgur.com/FfXQb9r)对吗？如果没有，我哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:03:26.687

当在没有第二`return`条语句的情况下使用该函数时，该函数不会为 JavaScript 返回中的每个定义的被调用者产生任何值`undefined`。

所以使用第一个定义，例如`loop(9)`：

1.  `0 < 10`，所以我们不执行`if`-clause 主体，而只是调用`loop(10)`.
2.  `loop(10)`返回`10`，但我们从不使用这个值。
3.  函数循环结束，因为没有返回其他值，所以它返回`undefined`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T18:08:51.843

如果您不从 Javascript 函数返回，那么最后会有一个隐含的“返回未定义”。

```
function loop(x) {
  if (x >= 10)
    return x;
  loop(x + 1); // the recursive call
  return undefined;
} 
```

如您所见，正在调用递归调用并忽略其返回值。这就像当你调用一个函数时发生的事情`console.log`- 函数被调用并运行任何副作用，但你最终丢弃了返回值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T18:04:19.570

函数只将值返回给它的直接调用者。由于在 的情况下`loop(0)`，`if`条件未满足，`return x;`未执行且函数没有其他`return`语句，因此它不返回任何内容。

如果你用它来调用它，`loop(10)`它将满足条件并返回`10`。

在第二种情况下，`return loop(x + 1);`导致`loop`返回其他调用返回的任何内容`loop`。

使用非递归示例可能更容易理解：

```
function bar() {
    return 42;
}

function foo1() {
    bar();
}

function foo2() {
    return bar();
}

//
foo1(); // undefined
foo2(); // 42 
```

`foo1`调用`bar`，但它不会对返回值做任何事情。由于内部没有`return`语句`foo`，因此该函数不返回任何内容。

`foo2`另一方面返回 的返回值`bar`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T18:16:04.407

```
function count_to_3 (x) {
    x = x || 0;
    if (x === 3) { return x; }
    return count_to_3(x + 1);
}

count_to_3(); 
```

这和这样说是一样的：

```
function add_1 (x) { return x + 1; }

function count_to_3 () {
    var x = 0;
    x = add_1( add_1( add_1(x) ) );

    return x;
}

count_to_3(); 
```

每个`add_1`函数都在做它们的工作并返回它们的值。内部函数首先被调用 - 它添加`1`到`x`（从 开始`0`），并将其值返回到 next `add_1`，它添加一个并将其返回到 next `add_1`。

...但如果你不返回值，什么都不会发生。

使用递归，这是相同的想法。

您正在返回您正在调用的函数的返回值。

你***不需***要这样做。
有时，递归是关于遍历一棵树并修改子节点——比如将每个第二个 DOM 节点更改为红色，并将每个父节点的第一个子节点更改为蓝色......

那里没有您需要的返回值。
您只需要设置检查，这样您就不会尝试递归到无穷大或最终尝试修改不存在的事物的属性。

但是对于收银机或你确实想知道一个值是否存在的循环，那么你所做的与说 相同`return add_1( add_1( add_1(0) ) );`，假设它`add_1`返回它的值。

任何没有 return 语句的函数都会返回`undefined`（除非它是用 调用的`new`，但是你会得到一个新对象，这也对你没有帮助）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T18:05:18.133

如果 x<10 循环函数不返回任何值，那为什么`return loop(x + 1);`会给你“未定义”。一旦达到 10，`return x;`语句就会开始，您将获得返回值。

您将它用作递归函数的事实在这里没有任何区别。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-23T18:28:26.500

此递归调用的评估顺序将从最后一次调用开始。首先评估的函数是 loop(10)，它返回值 10。下一个是 loop(9)，依此类推。想一想 loop(9) 被调用时的样子：

```
loop(9) {
    if (x >= 10) 
        return x;
    10
} 
```

loop(9) 将返回未定义。loop(8) 也会......等等。

相反，如果您返回递归调用的值，它将如下所示：

```
loop(9) {
    if (x >= 10) 
        return x;
    return 10
} 
```

当您的初始函数调用被执行时，它将如下所示：

```
loop(0) {
    if (x >= 10) 
        return x;
    return 10
} 
```

我创建了一个 jsfiddle 来证明这一点：http: [//jsfiddle.net/TSnxp/](http://jsfiddle.net/TSnxp/)

# c# - 使用 WebClient 只获取一张表

> ID：15043724
> 
> 赞同：1
> 
> 时间：2013-02-23T18:01:05.360
> 
> 标签：c#, webclient

所以我一直在尝试自学 C#，这里的很多内容真的很有帮助。我已经完成了一些基础知识，现在我正在尝试使用 WebClient 和 HtmlAgilityPack。因此，当我在寻找一个使用数据的网站时，我来到了 NWS 每小时预报（波士顿被选为随机城市）：[在波士顿预测](http://forecast.weather.gov/MapClick.php?w0=t&w1=td&w2=wc&w3=sfcwind&w3u=1&w4=sky&w5=pop&w6=rh&w7=thunder&w8=rain&w9=snow&w10=fzg&w11=sleet&AheadHour=48&&FcstType=digital&textField1=42.54688&textField2=-72.78013&site=all&unit=0&dd=0&bw=0&BackDay.x=61&BackDay.y=10&BackDay=0)

有没有办法只抢桌子？现在我得到了整个网站，如果我只有桌子，似乎会更容易玩。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:18:36.420

不`WebClient`，不会这样做。

你可以试试[Html Agility Pack](http://htmlagilitypack.codeplex.com)

> 这是一个敏捷的 HTML 解析器，它构建一个读/写 DOM 并支持普通的 XPATH 或 XSLT（实际上你不必了解 XPATH 或 XSLT 就可以使用它，不用担心......）。它是一个 .NET 代码库，允许您解析“网络之外”的 HTML 文件。解析器对“真实世界”格式错误的 HTML 非常宽容。对象模型与 System.Xml 的提议非常相似，但用于 HTML 文档（或流）。

# python - 如何防止 Python 在数据库连接失败时退出？

> ID：15043726
> 
> 赞同：0
> 
> 时间：2013-02-23T18:01:14.193
> 
> 标签：python, mysql, error-handling

我一直在尝试编写一个脚本来测试是否可以连接到某个 mysql DB。

如果可能，它应该给出“OK”输出，如果不是，它应该说“FAIL”并继续操作。

当连接可用时它工作正常。但是当连接失败时，脚本会退出并给出错误

```
_mysql_exceptions.OperationalError: (1045, "Access denied for user 'yoda'@'localhost' (using password: YES)") 
```

但这会干扰脚本执行其余过程

我这样称呼它

```
if not db.connect(UnivConf['DBHT'],UnivConf['DBUN'],UnivConf['DBPW'],UnivConf['DBDB']) 
```

我怎样才能解决这个问题并让脚本在不退出的情况下继续运行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:04:49.977

试试[试试](http://docs.python.org/2/tutorial/errors.html#handling-exceptions)

```
try:
    if not db.connect(UnivConf['DBHT'],UnivConf['DBUN'],UnivConf['DBPW'],UnivConf['DBDB'])
        # Do something

except _mysql_exceptions.OperationalError as e:
    print "Caught an exception : " + str(e.message)
    print "Something blah blah..."

finally:
    print "Done" 
```

# r - R quantmod:getFinancials

> ID：15043728
> 
> 赞同：3
> 
> 时间：2013-02-23T18:01:18.163
> 
> 标签：r, xts, quantmod

我正在尝试导入在纽约证券交易所上市的所有市值超过样本前四分之一的公司的财务报表。这是我的代码：

```
require(TTR)
require(quantmod)
data.init="2013/01/01"
start.date <- as.numeric(gsub("/", "",data.init))
nyse.symbols <- stockSymbols("NYSE")[,-c(3,5)]
nyse.symbols <- na.omit(nyse.symbols[which(nyse.symbols[,"MarketCap"]>0),])

######## Selection Criteria
# Filter 1 : stock mkt cap > 1st quartile --> remove the less liquid stocks
mktcap.filter <- quantile(nyse.symbols[,"MarketCap"],0.25)
nyse.symbols <- nyse.symbols[which(nyse.symbols[,"MarketCap"]>mktcap.filter),]

# Filter 2 : 
nyse.fs <-  new.env()
tickers.fs <- nyse.symbols[,1]
tickers.fs <- tickers.fs[- match(c("IHG","AF","BAP","BBD","BBDO"),tickers.fs)]
lapply(tickers.fs, getFinancials,env=nyse.fs) 
```

我删除了以下股票`c("IHG","AF","BAP","BBD","BBDO")`，因为`quantmod`无法导入财务报表：我收到了这样的错误消息：

```
Error in thead[x]:thead[x + 1] : NA/NaN argument
In addition: There were 39 warnings (use warnings() to see them) 
```

这是我在使用该`warnings()`功能时得到的：

警告消息（我有 39 条这种类型的错误消息）：

```
1: In readLines(tmp) :
  incomplete final line found on '/var/folders/9q/pwdpb5nj7bb8jjc_kb3np__h0000gn/T//RtmpeUS9Uh/file7de4698fa5b'
2: In readLines(tmp) :
  incomplete final line found on '/var/folders/9q/pwdpb5nj7bb8jjc_kb3np__h0000gn/T//RtmpeUS9Uh/file7de655c9092'
3: In readLines(tmp) :
  incomplete final line found on '/var/folders/9q/pwdpb5nj7bb8jjc_kb3np__h0000gn/T//RtmpeUS9Uh/file7de2017953b' 
```

我一步一步发现了有问题的股票。我想做的是自动摆脱所有财务报表不可用的股票。任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T21:38:57.033

您可以将呼叫置于`getFinancials`between `tryCatch`。这里有一个例子：

```
options(warn=-1)  ## optional to not get horrible quantlib messages!
 ## here I choose 2 goods symbols and 2 bad symbols    
 ll <- lapply(c("AF","IHG","BAP",ny.se[1,1]), function(x)
   tryCatch(getFinancials(x,env=nyse.fs),
                     error=function(e){print(paste(x,'not found'));NA}))
### "AF not found"
### "BAP not found"
options(warn=0)
## I apply to remove NA 
rapply(ll,na.omit)
"IHG.f" "A.f" 
```

# c# - WinRT 中的反射问题

> ID：15043732
> 
> 赞同：0
> 
> 时间：2013-02-23T18:01:35.187
> 
> 标签：c#, windows-runtime, windows-store-apps, .net-4.5

我在将 WP7 应用程序移植到 win8 商店应用程序时遇到问题...

我运行此代码从 XML 文件中的元素填充字段：

```
Venue lv = new Venue();

            foreach (var t in Fields)
            {
                foreach (var f in t.Elements())
                {
                    lv.SaveData(f.Attribute("name").Value, f.Value, lv);
                }
            } 
```

数据类：

```
 public class Venue //: INotifyPropertyChanged
    {
        public string updated_at { get; set; }
        public string name { get; set; }
        public string authority { get; set; }
        public string organisation { get; set; }
        public string control_type { get; set; }
    } 
```

运行 SaveData 方法：

```
public void SaveData(string field, string value, Venue v)
        {

            foreach (MemberInfo mi in v.GetType().GetTypeInfo().GetMembers())
            {
                if (mi.MemberType == MemberTypes.Property)
                {
                    PropertyInfo pi = mi as PropertyInfo;

                    if (pi.Name == "Coordinate")
                        continue;

                    if (pi.Name == field)
                    {
                        pi.SetValue(v, value, null);
                    }
                }
            }
        } 
```

问题是，GetMembers 定义在 WinRT 中不存在，因此要么需要找到替代方案来公开相同的属性，要么必须找到重写系统的方法。

这段代码不是我自己写的，但我可以理解它在做什么。我对反思不太熟悉，除了我刚刚阅读的基本介绍任何快速修复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:16:59.913

`GetType`是一种扩展方法。您需要包含反射命名空间：

```
using System.Reflection; 
```

对于您的`SaveData`方法，您可以执行以下操作：

```
public void SaveData(string field, string value, Venue v)
{
    var typeinfo = v.GetType().GetTypeInfo();
    var pi = typeinfo.GetDeclaredProperty(field);

    if (pi != null && pi.Name != "Coordinate")
       pi.SetValue(v, value);
} 
```

您可能想要做一些比上面的代码更好的错误检查。例如确保`v`并且`pi.Name`不为空。

# unit-testing - 使用 Liferay 进行测试驱动开发

> ID：15043733
> 
> 赞同：2
> 
> 时间：2013-02-23T18:01:37.330
> 
> 标签：unit-testing, testing, tdd, liferay, liferay-6

我是 Liferay 的新手。任何人都可以帮助指导我如何使用 liferay 进行测试驱动开发。

谁能提供指导如何使用 eclispe IDE 编写测试并执行它们以开发 portlet？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T08:33:03.133

Portlet 本质上是以 UI 为中心的，并且您将遇到与几乎所有 UI 层代码相同的问题来开发它们以进行测试驱动。我个人更喜欢在开发 UI 时考虑到用户的接受度，让它尽可能的肤浅，并测试底层业务逻辑，将 UI 布线留给代码审查而不是自动化测试。

我知道这在测试覆盖率方面留下了一个漏洞，但我觉得大多数 UI 层测试都是 80% 的设置、5% 的实际断言（最大）和 15% 的拆解代码。恕我直言，这并不构成有价值的测试用例。

正如您特别询问*测试驱动开发*：请记住，TDD 主要是一种设计技术。由此产生的测试是非常受欢迎的附属品，但主要目的是设计被测软件。（与纸张设计或其他非 TDD 样式相比，TDD 软件本质上看起来不同）。当架构和设计的很大一部分由 UI 框架强加时，这不足以使用 TDD 进行“设计” - 所以我宁愿设计用户交互并使其引人注目（同时保持尽可能薄）

有了这个，你可以随意在你的 UI 上添加集成测试——通常你不会为此使用 JUnit，而且执行时间可能比你的单元测试长，但是在你的 UI 上进行这种类型的测试是非常值得的用户界面的顶部。只是不要期望从测试端设计它来深入了解您的 UI 层。将此保留用于您的业务层（以及您在 UI 层上使用的各种实用程序样式代码位），而不是用于将业务层纯粹连接到用户交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T10:07:46.830

完全同意奥拉夫·科克的观点。

如果您喜欢 TDD，则可以使用这种方法设计业务层，而对于某些以 UI 为中心的组件（例如 portlet），最好在编写被测代码后使用传统的编写测试方法。例如，您可以使用 Selenium WebDriver 自动执行浏览器操作来测试 UI。

# c# - sqldatareader 中的括号

> ID：15043740
> 
> 赞同：3
> 
> 时间：2013-02-23T18:02:16.297
> 
> 标签：c#, sql, sqlite

我有一个使用 SQLLite 的数据库，我正在使用 C#。我进行查询并且它可以工作，但是当查询`( )`失败并给出关于 SQL 语法的 excpetion。

我创建了一个函数来帮助我使用查询`SQLiteDataReader`

```
 public SQLiteDataReader SQLExecuteReader(string sqlStatement, SQLiteConnection sqliteConnection)
    {
        SQLiteCommand command = new SQLiteCommand(sqlStatement, sqliteConnection);
        return command.ExecuteReader();
    } 
```

我这样使用它：

```
SQLiteDataReader reader = SQLExecuteReader("--SQL QUERY--", sqliteConnection); 
```

就我而言，我使用查询来比较具有相同结构的两个表。当查询是：

```
SELECT * FROM Table1 EXCEPT SELECT * FROM Table2 
```

有用。

但是当查询是

```
(   SELECT * FROM table1
    EXCEPT
    SELECT * FROM table2)  
UNION ALL
(   SELECT * FROM table2
    EXCEPT
    SELECT * FROM table1) 
```

或者

```
(SELECT * FROM Table1 EXCEPT SELECT * FROM Table2 
```

它失败。

我`( )`在查询中使用时缺少什么以及为什么它会失败？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:04:51.613

尝试执行此查询，

```
SELECT *
FROM 
(
    SELECT * FROM Table1 
    EXCEPT 
    SELECT * FROM Table2
) a
UNION ALL 
SELECT *
FROM
(
    SELECT * FROM Table2 
    EXCEPT 
    SELECT * FROM Table1
) b 
```

# design-patterns - 获取具体可观察的状态

> ID：15043743
> 
> 赞同：1
> 
> 时间：2013-02-23T18:02:49.153
> 
> 标签：design-patterns, observer-pattern

根据[这个](http://www.oodesign.com/observer-pattern.html)getState 在具体的可观察类上只有一个方法，而不是接口。如果这是真的，那么观察者怎么知道它可以得到什么状态呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T20:08:07.943

第一张幻灯片是错误的。第二张幻灯片没问题，因为它通过界面公开了它的状态。

# ruby-on-rails - Monkey 补丁 ActiveRecord 的 PostgreSQLAdapter 方法

> ID：15043749
> 
> 赞同：1
> 
> 时间：2013-02-23T18:03:18.497
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, monkeypatching

关于[这个问题](https://stackoverflow.com/questions/14975918/rails-how-to-connect-to-an-old-postgresql-your-version-of-postgresql-70417-i)，我试图覆盖返回 PostgreSQL 版本的`postgresql_version`方法`ActiveRecord::ConnectionAdapters::PostgreSQLAdapter`：

```
module ActiveRecord
  module ConnectionAdapters
    class PostgreSQLAdapter < AbstractAdapter

      protected
        # Returns the version of the connected PostgreSQL server.
        def postgresql_version
          80200
        end
    end
  end
end 
```

但是没有应用补丁。我在 config/initializer 中尝试过，并在 /lib 文件中要求它。帮助？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T22:21:33.050

试试这个：

```
# ensure ActiveRecord's version has been required already
require 'active_record/connection_adapters/postgresql_adapter'

class ActiveRecord::ConnectionAdapters::PostgreSQLAdapter 
protected
  def postgresql_version
    80200
  end
end 
```

您的解决方案失败了，因为您无法在猴子修补时添加继承部分（即`PostgreSQLAdapter < AbstractAdapter`）

# c - 使用动态数组进行 realloc() 后的意外行为

> ID：15043754
> 
> 赞同：0
> 
> 时间：2013-02-23T18:03:41.943
> 
> 标签：c, malloc, realloc

我有一个任务，我想实现一个动态增长的数组，但我似乎遇到了 realloc() 的一些问题。只要我没有真正到达 realloc() 部分，我的代码就可以工作，由于某种原因，只有一些特定的值被更改为不同的值。现在，如果我写/读越界，我希望行完全不同，但我似乎无法确定它。问题似乎在第 30-40 行之间。这是代码：

```
1 #include <stdio.h>
2 #include <stdlib.h>
3 #include <string.h>
4
5 typedef struct __student {
6         unsigned long ID;
7         char fname[33];
8         char lname[33];
9         float grade;
10 } student;
11
12 void partA(FILE *fp) {
13
14         int i, r;
15         i = r = 0;
16         int N = 1000;
17         student **S;
18
19         S = malloc(sizeof(student *) * N);
20
21         // While EOF has not been reached
22         while(!feof(fp)){
23                 // Allocate enough memory to hold each student struct
24                 S[i] = malloc(sizeof(student));
25                 // Get each line and, using a scanset, get corresponding
26                 // data into respective struct fields
27                 fscanf(fp, "%d %[^,], %s %f", &S[i]->ID, S[i]->lname, S[i]->fname,  &S[i]->grade );
28                 i++; // Get next line into a new struct
29
30                 // If array size has been reached...
31                 if(i == N){
32                         N *= 2;
33                         // Double it
34                         S = realloc(S, sizeof(student) * N);
35                         if(S == NULL) {
36                                 // realloc has failed
37                                 printf("Memory reallocation failed; Fatal error.");
38                                 break;
39                         }
40                 }
41         }
42         r = i-1;
43         // Output data
44         printf("Name\t\t\t\t\t\t\t\t  [ID]\t\t:\tGrade\n");
45            printf("___________________________________________________________________________________________________\n");
46         for(i=0; i<r; i++){
47                 printf("%-32s %-32s [%lu]\t:\t%.3f\n", S[i]->fname, S[i]->lname, S[i]->ID, S[i]->grade);
48                 free(S[i]);
49         }
50 } 
```

这是我正在使用的输入文件：

```
58205720 Broke, Jim 95
29571057 Crowe, John 88
12957206 Moore, Kim 22
59376027 Sarasvaki, Joe 79
49027650 Morrigan, Tracy 68
30773967 Trund, Geoffrey 99
34850470 Perry, Tracey 77
70209658 Oatnel, Skye 89 
```

预期的输出如下（只要 N 很高，即大于实际行数并且不会导致调用 realloc() ，我就会得到）**：**

```
Name                                                              [ID]          :       Grade
___________________________________________________________________________________________________
Jim                              Broke                            [58205720]    :       95.000
John                             Crowe                            [29571057]    :       88.000
Kim                              Moore                            [12957206]    :       22.000
Joe                              Sarasvaki                        [59376027]    :       79.000
Tracy                            Morrigan                         [49027650]    :       68.000
Geoffrey                         Trund                            [30773967]    :       99.000
Tracey                           Perry                            [34850470]    :       77.000
Skye                             Oatnel                           [70209658]    :       89.000 
```

**但是**，如果我设置 N = 3，我会得到以下结果：

```
Name                                                              [ID]          :       Grade
___________________________________________________________________________________________________
Jim                              Broke                            [58205720]    :       95.000
John                             Crowe                            [29571057]    :       88.000
Kim                              Moore                            [12957206]    :       22.000
Joe                              Sarasvaki                        [59376027]    :       79.000
Tracy                            Morrigan                         [49027650]    :       68.000
Geoffrey                         Trund                            [30773967]    :       99.000
Tracey                           Perry                            [231963084454]        :       77.000
Skye                             Oatnel                           [231998443642]        :       89.000 
```

我对正在发生的事情感到很茫然。我尝试使用 gdb 检查堆栈和本地值，但还没有多少运气。对于为什么 ID 是唯一被破坏的东西，我也很矛盾。是否有必要创建一个单独的函数来返回指向我通过 realloc() 获得的新空间的指针？我想让我的代码尽可能紧凑，所以我选择首先尝试这种方式，因为手册页似乎支持了我对 realloc() 工作方式的假设。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:12:09.300

```
 unsigned long ID; 
```

好的，`ID`是一个`unsigned long`.

```
 fscanf(fp, "%d %[^,], %s %f", &S[i]->ID, S[i ... 
```

嗯，是`%d`格式说明符`unsigned long`吗？我不这么认为。

此外，`feof`不会预测未来的读取会成功，它只会告诉您已经发生的事情。您需要检查 的返回值`fscanf`以查看读取是否成功。

最后，您的`realloc`调用分配了太多内存。你只是想自己持有指针`S`。

# php - PHP中的定时任务

> ID：15043756
> 
> 赞同：1
> 
> 时间：2013-02-23T18:03:57.960
> 
> 标签：php, timer, phpmyadmin, cron

我有一个存储不同任务信息的应用程序，每个任务都有一个必须完成的持续时间（1-3 个月），如果没有，则会向预定义的收件人发送电子邮件警报。

我已经阅读了这篇文章，发现它主要是通过 cron 作业完成的，但我找不到任何可以向我展示如何在 php 中编写 cron 作业的示例或教程（大多数我来 acroos 都在 cPanel 上）我正在运行 xampp Windows 7的。

我想如何解决这个问题的想法是；

1）每天有一个cron作业（cron_trigger.php）触发一个脚本（date_checker.php）

2) 在我的 date_checker.php 中，我扫描数据库以查找未完成的任务并发送警报

我对 PHP 很陌生，所以我想知道我可以进行设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:10:08.057

您正在寻找从任务调度程序运行 PHP。

我没有尝试过太多的任务调度程序，但是从命令行你需要指向

`C:\xampp\php\php.exe LinktoPHPFile`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-23T18:07:49.353

[http://en.wikipedia.org/wiki/Cron](http://en.wikipedia.org/wiki/Cron)

Cronjobs 仅适用于 linux，但我确信 Windows 也有类似的东西。

cronjob 有一个配置文件，您可以使用 crontab -e 打开它（为您的用户打开配置）

然后你有这样的东西：

```
*    *    *    *    *  command to be executed
*/5    *    *    *    *  php /absolute/path/to/your/cron_trigger.php 
```

该脚本每五分钟运行一次。

# android - 在android中使用sqlite时是否有任何事先设置？

> ID：15043757
> 
> 赞同：0
> 
> 时间：2013-02-23T18:03:59.447
> 
> 标签：android, sqlite

`Cursor` 错误是应用程序意外停止，并且当我正在执行程序时queueall 方法显示错误，然后出现错误应用程序意外停止。是否有任何用于创建我 android 的数据库的设置？

```
 public class SQLiteAdapter {

    public static final String MYDATABASE_NAME = "MY_DATABASE";
    public static final String MYDATABASE_TABLE = "MY_TABLE";
    public static final int MYDATABASE_VERSION = 1;
    public static final String KEY_CONTENT = "Content";
    // Create table MY_DATABASE (ID integer primary key, Content text not null);

    private static final String SCRIPT_CREATE_DATABASE = "create table "
            + MYDATABASE_TABLE + "(" + KEY_CONTENT + "text ot null);";

    private SQLiteHelper  sqLiteHelper;
    private SQLiteDatabase sqLiteDatabase;

    private Context context;

    public SQLiteAdapter(Context c) {
        // TODO Auto-generated constructor stub

        context = c;
    }

    // Write to the database
    public SQLiteAdapter openToWrite() throws android.database.SQLException
    {

        sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null, MYDATABASE_VERSION);
        sqLiteDatabase = sqLiteHelper.getWritableDatabase();
        return this;
        // TODO Auto-generated method stub

    }
    // Read from database

    public SQLiteAdapter openToRead() throws android.database.SQLException
    {

        sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null, MYDATABASE_VERSION);
        sqLiteDatabase = sqLiteHelper.getReadableDatabase();
        return this;
    }

    public void close()
    {

        sqLiteHelper.close();
    }

    public long insert(String content)
    {
        ContentValues contentValues = new ContentValues();
        contentValues.put(KEY_CONTENT, content);
        return sqLiteDatabase.insert(MYDATABASE_TABLE, null, contentValues);
    }
    //Delete data from database
    public int deleteAll() {

        return sqLiteDatabase.delete(MYDATABASE_TABLE, null, null);
    }

    public String queueAll()

    {
        String[] columns = new String[]{KEY_CONTENT};
        Cursor cursor = sqLiteDatabase.query(MYDATABASE_TABLE, columns, null, null, null, null, null);
        String result = "";
        int index_CONTENT = cursor.getColumnIndex(KEY_CONTENT);

        // moving cursor from 1st to next

        for(cursor.moveToFirst(); !(cursor.isAfterLast()); cursor.moveToNext())
        {
        result = result + cursor.getString(index_CONTENT)+ "\n";    

        }

        return result;
    }

    public class SQLiteHelper extends SQLiteOpenHelper 

    {

        public SQLiteHelper(Context context, String name,
                CursorFactory factory, int version) {
            super(context, name, factory, version);
            // TODO Auto-generated constructor stub
        }

        @Override
        public void onCreate(SQLiteDatabase arg0) {
            // TODO Auto-generated method stub

            arg0.execSQL(SCRIPT_CREATE_DATABASE);

        }

        @Override
        public void onUpgrade(SQLiteDatabase arg0, int arg1, int arg2) {
            // TODO Auto-generated method stub

        }

    }

} 
```

原木猫是：

```
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:46)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:42)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1345)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1229)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1184)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1264)
02-23 23:30:29.819: E/AndroidRuntime(362):  at com.example.androidsqlite.SQLiteAdapter.queueAll(SQLiteAdapter.java:80)
02-23 23:30:29.819: E/AndroidRuntime(362):  at com.example.androidsqlite.AndroidSQLite.onCreate(AndroidSQLite.java:35)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-23 23:30:29.819: E/AndroidRuntime(362):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
02-23 23:30:29.819: E/AndroidRuntime(362):  ... 11 more 
```

# c++ - 在 Mac 上找不到 lsocket 库

> ID：15043759
> 
> 赞同：2
> 
> 时间：2013-02-23T18:04:17.477
> 
> 标签：c++, c, sockets

我需要在 Mac OS X 上进行一些套接字编程，但我缺少它的库？这是我编译时发生的情况：

```
gcc ser.c -o ser -lsocket -lnsl
ser.c: In function ‘main’:
ser.c:41: warning: format ‘%.24s’ expects type ‘char *’, but argument 6 has type ‘int’
ld: library not found for -lsocket
collect2: ld returned 1 exit status 
```

我如何获得这个库？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T18:05:10.210

你不需要`-lsocket`在 OS X 上。

# rss - 从 disqus RSS 源获取所有评论

> ID：15043761
> 
> 赞同：3
> 
> 时间：2013-02-23T18:04:25.720
> 
> 标签：rss, disqus, web-crawler

如何通过此 rss 提要进行分页以查看所有评论？ [http://npr2way.disqus.com/dead_mice_are_going_to_be_dropped_on_guam_from_helicopters_really/latest.rss](http://npr2way.disqus.com/dead_mice_are_going_to_be_dropped_on_guam_from_helicopters_really/latest.rss)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T18:27:38.857

您将希望使用我们的 API 获得比 RSS 提要显示的更多的结果。此端点将在一个线程中获得评论，最多 100 条：[http://disqus.com/api/docs/threads/listPosts/](http://disqus.com/api/docs/threads/listPosts/)（rss、json 或 jsonp 格式）

如果这是用于开发项目，您还可以使用我们的游标方法对所有结果进行分页，此处记录：http: [//disqus.com/api/docs/cursors/](http://disqus.com/api/docs/cursors/)

# sql - 在一行中向多个数据库用户授予权限

> ID：15043766
> 
> 赞同：0
> 
> 时间：2013-02-23T18:04:40.000
> 
> 标签：sql, sql-server

我的存储过程中有以下行来向用户授予此存储过程的权限

```
GRANT EXECUTE ON [dbo].[GetItem] TO [<<DBUSER>>] 
```

存储过程与其他使用 Powershell 的大脚本合并到一个大脚本中，我将 <> 值替换为用户名。

我想修改它，以便我可以向该数据库中存在的列表中的用户授予权限。例如：

```
GRANT EXECUTE ON [dbo].[GetItem] TO [User1, User2, User3] 
```

用 SQL 可以做到这一点吗？我正在尝试尽可能减少更改。如果用户在数据库中不存在，它只是忽略它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:52:01.363

根据[文档](http://msdn.microsoft.com/en-us/library/ms187965.aspx)，`GRANT`您确实可以这样做。但由于[括号](http://msdn.microsoft.com/en-us/library/ms175874.aspx)，您的查询试图授予*一个*名为`[User1, User2, User3]`. 你可能想要这个：

`GRANT EXECUTE ON [dbo].[GetItem] TO [User1], [User2], [User3]`

尽管正如 Gordon 指出的那样，如果可能的话，在这种情况下，一个小组会容易得多。

# c# - Powerpoint 编辑如何将一个形状从一张幻灯片复制到另一张幻灯片

> ID：15043767
> 
> 赞同：2
> 
> 时间：2013-02-23T18:04:44.217
> 
> 标签：c#, powerpoint, shape

我是 c# 编程的新手，我只是对整个 ms office 库感到困惑。我想从一张幻灯片 3 中复制一个文本框并将其粘贴到幻灯片 2 中。我按照找到的页面中的说明进行操作：[如何在 c# 中将形状从一张幻灯片复制到另一张幻灯片？](https://stackoverflow.com/questions/5740749/how-can-i-copy-shapes-from-one-slide-to-another-slide-in-c)

```
presentation.Slides[3 + 1].Shapes[2 + 1].Copy();
presentaiton.Slides.Paste(2 + 1); 
```

但出现错误消息并显示：无法粘贴，因为剪贴板为空或包含与幻灯片不兼容的内容。我没有看到剪贴板是空的。事实上，我可以将它粘贴到单词上，看看它是什么——一次是一张空白图片，另一张是幻灯片中的灰色阴影。所以总的来说我有两个问题：如何知道我应该复制出哪个阴影以及为什么 c# 不允许复制一个形状并将其粘贴到另一个？

另外我想知道是否有一个完整的或官方的库或教程用于在 c# 中操作 powerpoint，而不是在 ms 网站上完全没用的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T02:30:12.693

在 vba 中，你会这样做：

```
ActivePresentation.Slides(2).Shapes(3).Copy
ActivePresentation.Slides(3).Shapes.Paste 
```

这会将幻灯片 2 上的第三个形状复制到幻灯片 3

# ruby-on-rails-3 - 如何在守护进程模式下运行 rake resque:scheduler

> ID：15043775
> 
> 赞同：7
> 
> 时间：2013-02-23T18:05:04.673
> 
> 标签：ruby-on-rails-3, resque, god

我在我的**rails 3 应用程序中使用****resque:scheduler gem**。

 **如何`rake resque:scheduler`在`daemon`模式下启动。

如果你知道，请告诉我，

**如何在 GOD 脚本中配置此任务？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T12:07:22.973

我想你只需要这样做

```
BACKGROUND=yes rake resque:scheduler 
```

也许这会在[这里检查](https://github.com/bvandenbos/resque-scheduler/blob/master/lib/resque_scheduler/tasks.rb#L12)

希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T05:53:54.153

```
PIDFILE=./resque-scheduler.pid BACKGROUND=yes rake resque:scheduler 
```

resque调度程序的完整文档可[在此处获得](http://rdoc.info/github/bvandenbos/resque-scheduler/master/frames)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-29T12:34:17.657

试试这个

```
rake resque:scheduler BACKGROUND=true 
```

或者

```
rake resque:scheduler & 
```

现在，如果您想抑制 rake 任务的输出，请尝试使用`nohup`

```
nohup rake my:task BACKGROUND=true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-05T06:57:01.710

尝试以下方法在 God 脚本中配置 resque-schedular。

安装神宝石

```
gem install god 
```

在您的项目文件夹中创建一个名为**watch.god的文件。**

将以下内容添加到**watch.god**

```
God.watch do |w|
  w.name = "resque_schedular"
  w.dir = '/home/machine_name/project_path'
  w.start = "BACKGROUND=yes bundle exec rake environment resque:scheduler"
  w.keepalive
end 
```

在终端运行**上帝进行测试**

```
$ god -c path/to/watch.god -D 
```

从终端运行守护进程（后台）中的**上帝**

```
$ god -c path/to/watch.god 
```**

# unit-testing - Windows Phone 8 单元测试

> ID：15043777
> 
> 赞同：1
> 
> 时间：2013-02-23T18:05:06.510
> 
> 标签：unit-testing, windows-phone-8

我想在我的 Windows Phone 8 C# 应用程序中使用单元测试。我读了这篇关于单元测试 WP8 应用程序的[微软文章](http://blogs.msdn.com/b/visualstudioalm/archive/2013/01/31/windows-phone-unit-tests-in-visual-studio-2012-update-2.aspx)

我得到了 Visual Studio 2012 Professional，更新到 CTP Update 2 ( [http://www.microsoft.com/en-us/download/details.aspx?id=36539](http://www.microsoft.com/en-us/download/details.aspx?id=36539) )

但是我没有**Windows Phone Unit Test App**项目类型，为什么？我已经安装了上次 CTP Update 2 中的所有文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:09:50.857

根据文章，FAQ部分指的是以下已知问题：

*   安装所有先决条件后，我仍然看不到 Windows Phone 单元测试模板。

解决方法：在系统驱动器上按顺序安装必备软件。

对比 2012

视窗电话 SDK 8.0

VS 2012 更新 2 CTP2

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-22T04:59:08.817

随着[最新更新](http://www.microsoft.com/visualstudio/eng/visual-studio-update)，您的问题应该会消失

# c# - 角色提供者和 System.Web.Security.Roles

> ID：15043788
> 
> 赞同：1
> 
> 时间：2013-02-23T18:05:50.030
> 
> 标签：c#, asp.net-mvc-4, authorization

我对如何在我的 asp.net MVC4 razor 项目中使用角色感到困惑。两者有什么区别，主要是，我如何使用授权属性并使其在我检查经过身份验证的用户的角色时转到我的自定义角色提供程序。还是我在这里混淆了？

更具体：

我有一个管理员控制器，其中具有“管理员”角色的用户可以执行 CRUD 操作。在我的控制器中，我应用以下属性：

```
[Authorize(Roles = "administrator")]
public class OverviewController : Controller 
```

假设授权属性将在后端使用我的客户角色提供程序是否正确？如果是这样，为什么它对我不起作用？

我的自定义角色提供者类的一部分：

```
public sealed class CustomRoleProvider : RoleProvider
{
    public override void Initialize(string name, NameValueCollection config)
    {
        if (config == null) throw new ArgumentNullException("config");

        if (name.Length == 0) name = "CustomRoleProvider";

        if (String.IsNullOrEmpty(config["description"]))
        {
            config.Remove("description");
            config.Add("description", "Custom Role Provider");
        }

        //Initialize the abstract base class.
        base.Initialize(name, config);

        _applicationName = Helpers.GetConfigValue(config["applicationName"], System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath);
    }

    public override bool IsUserInRole(string email, string roleName)
    {
        bool isValid = false;

        var usersInRole = _unitOfWork.UsersRepository.Get(uir => uir.email == email && uir.Roles.Name == roleName);

        if (usersInRole != null) isValid = true; 

        return isValid;
    } 
```

我在做什么不正确？当一个用户被正确地认证时，他或她怎么能像这样：

```
 [HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult LoginValidate(Authentication authentication, string returnUrl)
    {
        string email    = authentication.email;
        string password = authentication.password;
        bool rememberMe = authentication.rememberMe;
        if(string.IsNullOrEmpty(returnUrl)) returnUrl = "/";

        //If the filled in fields are validated against the attributes
        if (ModelState.IsValid)
        {
            if (MembershipService.ValidateUser(email, password))
            {
                FormsService.SignIn(email, rememberMe);

                return RedirectToAction("Index", "Home", new { area="" });
            }

            ModelState.AddModelError("", Resources.Resources.Error_incorrect_emailPassword);

        }   

        // Add the ModelState dictionary to TempData here.
        TempData["ModelState"] = ModelState;

        return RedirectToAction("index", "Home", new { area="" });
    } 
```

从我的自定义角色提供者那里检查他或她的授权？

# 编辑

我的 web.config：

```
<roleManager enabled="true" defaultProvider="CustomRoleProvider" cacheRolesInCookie="true" >
  <providers>
    <clear />
    <add name="CustomRoleProvider" type="ArtWebShop.Common.CustomRoleProvider" connectionStringName="ArtWebshopEntities" applicationName="/" />
  </providers>
</roleManager>

  <membership defaultProvider="CustomMembershipProvider">
  <providers>
    <clear />
    <add name="CustomMembershipProvider" type="ArtWebShop.Common.CustomMembershipProvider" connectionStringName="ArtWebshopEntities" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="0" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
  </providers>
</membership> 
```

# 编辑二

```
 public override bool ValidateUser(string email, string password)
    {
        string salt = _unitOfWork.UsersRepository.GetSalt(email);
        string hashedPassword = Helpers.CreatePasswordHash((password), salt);

        return _unitOfWork.UsersRepository.UserIsValid(email, hashedPassword);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:07:59.800

> 假设授权属性将在后端使用我的客户角色提供程序是否正确？

是的。

> 如果是这样，为什么它对我不起作用？

您可能忘记在 web.config 中注册此自定义角色提供程序并将其设为此应用程序的默认提供程序：

```
<roleManager defaultProvider="CustomRoleProvider" enabled="true">
    <providers>
        <clear />
        <add 
            name="CustomRoleProvider"
            type="Somenamespace.CustomRoleProvider"
        />
    </providers>
</roleManager> 
```

# bash - 最多替换第 n 个匹配项

> ID：15043789
> 
> 赞同：2
> 
> 时间：2013-02-23T18:05:52.363
> 
> 标签：bash, sed

我[**读到**](http://www.grymoire.com/Unix/Sed.html#uh-8)您可以替换从第二个开始的所有匹配`sed`项[](http://www.grymoire.com/Unix/Sed.html#uh-8)

 **> 您可以将数字与 g（全局）标志结合使用。例如，如果您想保留第一个单词，但将第二个、第三个等改为 DELETED，请使用 /2g：

例子

```
sed 's/foo/bar/2g' a.txt 
```

但是，如何将匹配替换**到**第二个，以便第三个、第四个等不受影响？就像是

```
sed 's/foo/bar/1-2' a.txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:07:35.047

这可能对您有用（GNU sed）：

```
sed 's/foo/&\n/2;T;h;s//bar/g;G;s/\n.*\n//' file 
```

将第 n 次出现的预期字符串替换为自身和换行符。如果替换失败，则将模式空间 (PS) 复制到保持空间 (HS)。使用替换字符串进行替换，然后用更改的行重构原始行。

还：

```
sed 's/foo/\n/g;s/\n/foo/3g;s/\n/bar/g' file 
```

其中第 n 个 +1 用于代替第 1 到第 n 个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:12:09.987

最简单的方法是：

```
sed 's/foo/bar; s/foo/bar' a.txt 
```

这将有效地替换 2 的第一次出现`foo`。它每行进行两次传递，总是替换第一次出现。由于在第二遍时第一个`foo`已经被替换，第二遍“看到”原始的第二次出现作为第一次出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:29:13.130

扩展奇洛的答案......

```
replace_string=s/foo/bar
n=2
replace_string_n=`python -c 'print "'$replace_string';"*'$n`

sed $replace_string_n a.txt 
```**

# python - Python.org 上的课程教程

> ID：15043790
> 
> 赞同：1
> 
> 时间：2013-02-23T18:05:55.717
> 
> 标签：python, class, python-3.3

我对此有点生气，尝试使用 Python 3.3.0 。

在[http://docs.python.org/3/tutorial/classes.html](http://docs.python.org/3/tutorial/classes.html)上有一个类示例，代码如下：

```
class Bag:
    def __init__(self):
        self.data = []
    def add(self, x):
        self.data.append(x) 
```

首先，我想知道它缺少 Python3 通常需要的对象**类 somename(object)**。

```
class Bag(object): 
```

其次，当我尝试运行它时，我收到以下错误消息：

```
>>> a=Bag
>>> a.add('23')
Traceback (most recent call last):
  File "<pyshell#14>", line 1, in <module>
    a.add('23')
TypeError: add() missing 1 required positional argument: 'x' 
```

怎么回事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T18:11:00.307

> 首先，我想知道它缺少 Python3 通常需要的对象类 somename(object) 。

在 Python 3 中，您的类将自动派生自`object`，因此无需显式执行此操作。在 2 中没有这样做的唯一原因是为了向后兼容，因为所谓的新式（从对象派生）类的行为与旧式类略有不同。

```
a=Bag 
```

这并没有创建 的实例`Bag`，它只是说`a`现在是该类的新名称`Bag`。结果，当您使用

```
a.add('23') 
```

您没有调用`add`实例的方法，因此该实例没有作为第一个参数传递（不可能，因为还没有实例！）因此，它将“23”解释为你的价值`self`，因此你没有通过`x`，因此

```
TypeError: add() missing 1 required positional argument: 'x' 
```

尝试

```
>>> a = Bag()
>>> a.add('23')
>>> a.data
['23'] 
```

反而。

# ios6 - 将 Rect 连接到手势识别器以进行平移？

> ID：15043796
> 
> 赞同：0
> 
> 时间：2013-02-23T18:06:33.453
> 
> 标签：ios6, gestures

我有一个底部视图（UIView）和一个顶部视图（UIView）。bottomView 具有红色背景，在 IB 中，我将 topView 设置为 clearColor 并将 Opaque 设置为 OFF。使用以下代码，我实现了在 topView 上创建一个矩形/窗口并在 bottomView 上打一个洞的目标：

```
- (void)drawRect:(CGRect)rect
{
    // Drawing code
    CGRect holeRect = CGRectMake(100, 100, 100, 100);

    self.opaque = NO;
    self.backgroundColor = [UIColor clearColor];

    // Start by filling the area with the blue color
    [[UIColor blueColor] setFill];
    UIRectFill( rect );

    // Assume that there's an ivar somewhere called holeRect of type CGRect
    // We could just fill holeRect, but it's more efficient to only fill the
    // area we're being asked to draw.
    CGRect holeRectIntersection = CGRectIntersection( holeRect, rect );

    [[UIColor clearColor] setFill];
    UIRectFill( holeRectIntersection );
} 
```

现在 - 我想让矩形/窗口可移动。我已将 ViewController 设置为 UIGestureRecognizerDelegate 并在实现文件中，在 viewDidLoad 中有以下代码在另一个项目中对我有用：

// 为每个 ImageView 创建平移手势识别器 UIPanGestureRecognizer *pan1Recognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan1From:)];

```
// set self as delegate for gesture recognition
[pan1Recognizer setDelegate:self];

// setup the selector for the pan gesture
pan1Recognizer.minimumNumberOfTouches = 1;
pan1Recognizer.maximumNumberOfTouches = 1;

[XXX addGestureRecognizer:pan1Recognizer];

// ensure user interaction is ENABLED !!!!
[XXX setUserInteractionEnabled:YES]; 
```

挑战是，上面的XXX。在我的另一个项目中，我在 IB 中有一个子视图，其中定义了一个出口，因此我可以明确引用它。但是在这个项目中，我在上面的 drawRect 中创建了矩形，但不知道如何建立这种连接。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T03:45:47.587

我能够将我创建的 Rect 与处于手势控制下的 UIView 对齐，并通过将它们一起移动来解决它。可能不是最优雅的方法，但它有效，我已经为此困扰了一个多星期，所以对它和 allons-y 不屑一顾！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-22T17:08:41.357

创建一个

```
@property (nonatomic, strong) UIView *holerectView; 
```

然后将视图设置为矩形框：

```
 _rect = CGRectMake(100, 100, 100, 100);

self.opaque = NO;
self.backgroundColor = [UIColor clearColor]; 
```

不要费心用颜色填充矩形；只需为您的视图创建背景颜色。

```
_holerectView = [[UIView  alloc] initWithFrame:_rect];
_holerectView.backgroundColor = [UIColor redColor];

[self addSubview:_holeRectView]; 
```

和这里：

```
[_holeRectView addGestureRecognizer:pan1Recognizer]; 
```

# java - Snake 示例可以轻松转换为 Touchpad 吗？

> ID：15043797
> 
> 赞同：0
> 
> 时间：2013-02-23T18:06:38.297
> 
> 标签：java, android

我正在使用 Android SDK 中的 Snake 示例进行练习，我觉得我完全理解了这个示例。我想转换这个例子，让它在触摸屏 Android 上运行。

在一个完美的世界中，我希望看到一个`onKeyDown`可以简单地替换为 [whatever touch handler] 的示例。

然后我会将例如转换为`KeEvent.KEYCODE_DPAD_UP`向上滑动对应的任何内容，等等。

有那么容易吗，还是必须从头开始重写才能支持触摸板？如果这很容易，你能用一个简单的通用示例为我指明正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:20:29.087

应该不难。您必须将 OnGestureListener 接口添加到您的活动或处理 keyPadEvents 的视图中。

[http://developer.android.com/reference/android/view/GestureDetector.OnGestureListener.html](http://developer.android.com/reference/android/view/GestureDetector.OnGestureListener.html)

该接口需要实现公共抽象方法，例如`onDown(MotionEvent e)`，等。

您可以将代码复制到以前的位置`onKeyDown`

# android - android通过重启应用程序重置堆？

> ID：15043800
> 
> 赞同：1
> 
> 时间：2013-02-23T18:06:51.687
> 
> 标签：android, heap-memory

由于“内存不足”问题，是否可以通过重启应用程序重置 HEAP？

下面是我从“stackoverflow”中找到的重新启动应用程序的代码。但是从 Eclipse DDMS 来看，堆没有重置。

```
Intent i = getBaseContext().getPackageManager().getLaunchIntentForPackage( getBaseContext().getPackageName() );
i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(i); 
```

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:10:44.817

> 由于“内存不足”问题，是否可以通过重启应用程序重置 HEAP？

最终，Android 将在您的进程移至后台一段时间后终止您的进程。新进程将从一个新堆开始。

> 下面是我从“stackoverflow”中找到的重新启动应用程序的代码。但是从 Eclipse DDMS 来看，堆没有重置。

那是因为您仍在使用相同的流程。

# facebook-page - 如何生成喜欢 Facebook 页面的人的 UID？

> ID：15043803
> 
> 赞同：-1
> 
> 时间：2013-02-23T18:07:19.600
> 
> 标签：facebook-page

有一种方法可以生成喜欢特定页面的人的 UID 列表，并且您不必是该页面的管理员。必须进入 Facebook 页面[https://www.facebook.com/pages/(PageID)](https://www.facebook.com/pages/(PageID))并生成喜欢该页面的人的 UID 列表。你能帮我用最简单的方法来得到这个吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:13:34.893

我不相信这对管理员来说是可能的，更不用说非管理员了[我怎样才能获得喜欢我的页面的用户 ID？](https://stackoverflow.com/questions/7238841/how-can-i-get-user-id-for-likes-of-my-page)

# linux - 查找出现 2 个给定单词的文件，并显示出现单词的行

> ID：15043804
> 
> 赞同：0
> 
> 时间：2013-02-23T18:07:25.630
> 
> 标签：linux, shell, grep, ack

假设我想查找当前目录中至少出现一次 name`Peter`和至少出现一次name 的所有文件`James`。

[我可以按照此线程](https://stackoverflow.com/questions/15042580/find-files-where-2-given-words-occur-innot)`ack-grep -l Peter * | xargs ack-grep -l James`中的建议找到这些文件的列表。

**但是我怎样才能显示这些单词出现的行呢？**简单地做`ack-grep Peter * | xargs ack-grep James`不会返回预期的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:09:33.997

```
ack-grep -l Peter | xargs ack-grep -l James | xargs ack-grep 'Peter|James' 
```

# android - 物理对象不随精灵移动

> ID：15043805
> 
> 赞同：1
> 
> 时间：2013-02-23T18:07:29.323
> 
> 标签：android, sprite, andengine

使用 AndEngine，我想移动一个对象，所以我创建了一个 Sprite：

```
tower1 = new Sprite(50, 150, this.tower1TextureRegion,
            this.getVertexBufferObjectManager());
tower1Body = PhysicsFactory.createBoxBody(physicsWorld, tower1,
            BodyType.KinematicBody, towerFixtureDef);
this.physicsWorld.registerPhysicsConnector(new PhysicsConnector(tower1,
            tower1Body, true, true)); 
```

然后定义移动：

```
moveTower1 = new MoveXModifier(actualDuration, tower1.getX(), -150f)
     {
     @Override protected void onModifierFinished(IEntity 
     removeTower(tower1); }
     }; 
     tower1.registerEntityModifier(moveTower1); 
```

当我运行这个应用程序时，精灵在移动，但物理对象没有。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:29:55.363

使用 box2d，您需要移动身体，而不是精灵。你应该把精灵想象成一个木偶，由身体控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:30:28.830

如果将精灵附加到身体上，则不能再使用修改器移动它。物理世界现在在位置方面基本上拥有它（即，如果身体由于施加的力而移动，则连接的精灵将随之移动）。您只能通过对身体本身施加力来移动它。即，

```
tower1Body.applyLinearImpulse(impulseX, impulseY, pointX, pointY); 
```

或者，

```
tower1Body.applyForce(forceX, forceY, pointX, pointY); 
```

或线速度，

```
tower1Body.setLinearVelocity(vX, vY); 
```

Also be warned that the co ordinates in the physics world differ from those in your scene. For example tower1.getX() are the coordinates in your scene of sprite tower1 but in the physics world the position of the body will differ by /PIXEL_TO_METER_RATIO_DEFAULT.

Hope this helps.

# php - 努力构建具有唯一 ID 的多维数组

> ID：15043809
> 
> 赞同：0
> 
> 时间：2013-02-23T18:07:50.327
> 
> 标签：php, arrays, zend-framework, backbone.js, unique

假设我有一些看起来像这样的数据库行：

```
group    version  tool         info
group_a  m        screwdriver  for screwing things
group_a  m        hammer       for hitting things
group_a  l        screwdriver  for screwing things
group_a  xl       screwdriver  for screwing things
group_b  m        screwdriver  for screwing things
group_b  m        hammer       for hitting things
group_b  m        wrench       for wrenching things
group_b  l        screwdriver  for screwing things
group_b  xl       wrench       for wrenching things 
```

从那我想创建一个看起来像这样的数组：

```
array(
    array( 'id' => 'group_a',
        array( 'id' => 'm',
            array( 'id' => 'screwdriver',
                'info' => 'for screwing things'
            ),
            array( 'id' => 'hammer',
                'info' => 'for hitting things'
            ),
        ),
        array( 'id' => 'l',
            array( 'id' => 'screwdriver',
                'info' => 'for screwing things'
            ),
        ),
        array( 'id' => 'xl',
            array( 'id' => 'screwdriver',
                'info' => 'for screwing things'
            ),
        )
    array( 'id' => 'group_b',
        array()
    )
    ~~~~~~~ etc ~~~~~~~
); 
```

对于一些上下文，我将其作为 JSON 从 Zend 传递到 BackboneJS，然后将这些数组消耗到一个组集合中，其中包含 n 个版本集合，其中包含 n 个工具模型。

收到任何帮助，很高兴澄清任何问题。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T23:34:42.560

将您的数据转换为一个三维临时数组。

```
$temparray=array();
foreach ($rows as $row) {
  $temparray[$row['group']][$row['version']][$row['tool']]=$row['info'];
} 
```

这个临时数组看起来与您想要实现的相似，但不完全是：

```
Array
(
    [group_a] => Array(
            [m] => Array(
                    [screwdriver] => for screwing things
                    [hammer] => for hitting things
                )
            [l] => Array(
                    [screwdriver] => for screwing things
                )
            [xl] => Array(
                    [screwdriver] => for screwing things
                )
    )
    [group_b] => Array(
            [m] => Array(
                    [screwdriver] => for screwing things
                    [hammer] => for hitting things
                    [wrench] => for wrenching things
                )
            [l] => Array(
                    [screwdriver] => for screwing things
                )
            [xl] => Array(
                    [wrench] => for wrenching things
                )
    )
) 
```

现在要么这足以满足您的需求，要么您必须重现您显示的确切结构。在后一种情况下，只需遍历该临时数组即可实现您的目标：

```
foreach ($temparray as $groupid=>$groupdata) {
  $grouparray=array('id'=>$groupid);
  foreach ($groupdata as $versionid=>$versiondata) {
    $versionarray=array('id'=>$versionid);
    foreach ($versiondata as $toolid=>$tooldata) {
      $toolarray=array('id'=>$infoid,'info'=>$tooldata);
      $versionarray[]=$toolarray;
    }
    $grouparray[]=$versionarray;
  }
  $targetarray[]=$grouparray;
} 
```

你完成了:)

顺便说一句，以 'id',0,1,2,... 作为索引的数组有点尴尬。我不知道 BackboneJS，但是任何使用这种格式的脚本（而不是 temptable 的样子）在我看来都很可疑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:23:20.960

我真的不喜欢这个，因为它会像疯了一样抛出通知。但最终结果将是这样的：

```
$array = array();
while($row = fetch($query) {
  $array['id'][$row['group']]['id'][$row['version']]['id'] = $row['tool'];
  $array['id'][$row['group']]['id'][$row['version']]['info'] = $row['info'];
} 
```

我会用 issets 让它更优雅，并检查以防止东西被覆盖和附加。

我可能会使用实际 ID 作为键而不是单词来帮助实现唯一性。

无论如何，这应该可以帮助您朝着正确的方向思考。

# ios - 有没有办法衡量用户在我的应用中花费的总时间？

> ID：15043811
> 
> 赞同：1
> 
> 时间：2013-02-23T18:08:01.143
> 
> 标签：ios, time, metrics

我正在制作一款游戏，并希望从我的用户那里获得一个统计页面。有没有办法让我跟踪他们在我的应用程序中花费的总时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:25:40.270

使用 Flurry 分析：[http ://www.flurry.com/](http://www.flurry.com/)

入门： http: [//support.flurry.com/index.php ?title=Analytics/GettingStarted/TechnicalQuickStart](http://support.flurry.com/index.php?title=Analytics/GettingStarted/TechnicalQuickStart)

集成很简单，只需这样做：

```
#import "Flurry.h"
- (void)applicationDidFinishLaunching:(UIApplication *)application {
[Flurry startSession:@"YOUR_API_KEY"];
//your code
} 
```

记录事件：

```
[Flurry logEvent:@"EVENT_NAME"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:28:32.513

正如 radesix 所写，您需要一个度量框架。在我工作的公司中，我们使用 Google Analytics。它提供了一个很好的概述并且非常易于使用：

启动它

> ```
> // Optional: automatically send uncaught exceptions to Google Analytics.
> [GAI sharedInstance].trackUncaughtExceptions = YES;
> // Optional: set Google Analytics dispatch interval to e.g. 20 seconds.
> [GAI sharedInstance].dispatchInterval = 20;
> // Optional: set debug to YES for extra debugging information.
> [GAI sharedInstance].debug = YES;
> // Create tracker instance.
> [[GAI sharedInstance] trackerWithTrackingId:@"YOUR TRACKING ID"]; 
> ```

要跟踪事件：

```
id<GAITracker> tracker = [[GAI sharedInstance] defaultTracker];
 [tracker sendEventWithCategory:@"TITLE" withAction:@"paused" withLabel:@"success" withValue:[NSNumber numberWithInt:5]]; 
```

[在http://www.google.com/analytics/](http://www.google.com/analytics/)上阅读更多信息

# jquery - 为什么 JQuery .find 只选择元素？

> ID：15043817
> 
> 赞同：0
> 
> 时间：2013-02-23T18:08:38.037
> 
> 标签：jquery, coffeescript, innerhtml

我一直在尝试通过执行以下操作（CoffeeScript）来更改 Bootstrap 中按钮的 innerHtml：

```
$('#bts-display-button').html(Toolbar.selected_BTS) 
```

这一直不起作用，即使在加载 Dom 后调用它也是如此。我成功地通过使用 JQuery .find 方法更改了 innerHtml，如下所示：

```
$('body').find('#bts-display-button').html(Toolbar.selected_BTS) 
```

对于某些上下文，上述方法位于单击处理程序中：

```
bts_dropdown_selecion_clickhandler: () =>
    $('body').on 'click', '#bts-dropdown li', ->
      console.log $(this).html()
      Toolbar.selected_BTS = $(this).html()
      $('body').find('#bts-display-button').html(Toolbar.selected_BTS)  # Works
      #$('#bts-display-button').html(Toolbar.selected_BTS)              # Doesn't Work 
```

**问题**

为什么 .find 方法有效，而另一个无效？

# java - Spring + Hibernate 应用程序中的问题：org.hibernate.HibernateException: No Session found for current thread

> ID：15043827
> 
> 赞同：3
> 
> 时间：2013-02-23T18:09:40.350
> 
> 标签：java, spring, hibernate, spring-mvc

我正在研究如何将 Spring Framework 与 Hibernate 集成以创建我的 DAO 对象

我在从 CRUD 操作集中执行读取操作时遇到一些问题。

我有这个实现我的 DAO 对象的类：

```
package org.andrea.myexample.HibernateOnSpring.dao;

import org.andrea.myexample.HibernateOnSpring.entity.Person;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.springframework.transaction.annotation.Transactional;

public class PersonDAOImpl implements PersonDAO{

private SessionFactory sessionFactory;

public void setSessionFactory(SessionFactory sessionFactory) {
    this.sessionFactory = sessionFactory;
}

// Metodo che inserisce un nuovo record nella tabella person
@Transactional(readOnly=false)
public void addPerson(Person p) {
    Session session = sessionFactory.openSession();
    session.save(p);
    session.close();        
}

/* Metodo che recupera un record, rappresentante uno studente, avente uno 
 * specifico id dalla tabella.
 * 
 * @param L'id dello studente
 * @see org.andrea.myexample.myJdbcSpringExample.StudentDAO#getStudent(java.lang.Integer)
 */
public Person getById(int id){
    Session session = sessionFactory.openSession();
    return (Person) sessionFactory.getCurrentSession().get(Person.class, id);   
}   

} 
```

我有以下用于广告测试类的主类：

```
package org.andrea.myexample.HibernateOnSpring;

import org.andrea.myexample.HibernateOnSpring.dao.PersonDAO;
import org.andrea.myexample.HibernateOnSpring.dao.PersonDAOImpl;
import org.andrea.myexample.HibernateOnSpring.entity.Person;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class App {

public static void main( String[] args ){

    ApplicationContext context = new ClassPathXmlApplicationContext("Beans.xml");
    System.out.println("Contesto recuperato: " + context);

    Person persona1 = new Person();

    persona1.setFirstname("Pippo");
    persona1.setLastname("Blabla");
    //persona1.setPid(1);

    System.out.println("Creato persona1: " + persona1);

    PersonDAO dao = (PersonDAO) context.getBean("personDAOImpl");

    System.out.println("Creato dao object: " + dao);

    dao.addPerson(persona1);

    System.out.println("persona1 salvata nel database");

    Person personaEstratta = dao.getById(persona1.getPid());

    System.out.println("Persona con id: " + personaEstratta.getPid() + " estratta dal DB");
    System.out.println("Dati persona estratta:");
    System.out.println("Nome: " + personaEstratta.getFirstname());
    System.out.println("Cognome: " + personaEstratta.getLastname());

}
} 
```

这个测试类首先在我的数据库表中插入一条新记录，然后好的……这很好用（新行正确插入到表中）

尝试提取具有特定 ID 的行。在这里我遇到了一些问题，因为当尝试获取对象时会引发以下异常：

```
Contesto recuperato: org.springframework.context.support.ClassPathXmlApplicationContext@11ba3c1f: startup date [Sat Feb 23 19:07:42 CET 2013]; root of context hierarchy
Creato persona1: org.andrea.myexample.HibernateOnSpring.entity.Person@777dcf23
Creato dao object: org.andrea.myexample.HibernateOnSpring.dao.PersonDAOImpl@3f12ccc4
persona1 salvata nel database
**
Exception in thread "main" org.hibernate.HibernateException: No Session found for current thread
    at org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)
    at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:978)
    at org.andrea.myexample.HibernateOnSpring.dao.PersonDAOImpl.getById(PersonDAOImpl.java:31)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:198)
    at sun.proxy.$Proxy11.getById(Unknown Source)
    at org.andrea.myexample.HibernateOnSpring.App.main(App.java:33)** 
```

问题是什么？让对象正确是我的策略吗？

肿瘤坏死因子

安德烈亚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T18:15:45.690

你的问题在这里：

```
public Person getById(int id){
    Session session = sessionFactory.openSession();
    return (Person) sessionFactory.getCurrentSession().get(Person.class, id);   
} 
```

该方法`getCurrentSession()`返回绑定到当前上下文的会话。你不能在你的设置中使用这个方法，你需要`openSession()`在你的`addPerson`方法中使用。所以你需要这样做：

```
public Person getById(int id){
    Session session = sessionFactory.openSession(); 
    try {
      return (Person) session.get(Person.class, id);
    } finally {
      session.close();
    }    
} 
```

# javascript - 除了 setTimeout 之外的任何方式来强制浏览器重绘？

> ID：15043828
> 
> 赞同：2
> 
> 时间：2013-02-23T18:09:48.227
> 
> 标签：javascript, jquery, datatable, repaint

我正在使用（并贡献于）一个 jQuery 表格排序插件，该插件包含一个在表格排序之前进行额外处理的事件。最初浏览器在排序之前没有进行重绘，所以我在插件代码中添加了一个 setTimeout 调用来强制重绘。所以现在的代码是这样的：

```
$table.trigger("beforetablesort", {column: th_index, direction: sort_dir});

setTimeout(function() {
  // do the hard work
}, 10); 
```

我的`beforetablesort`回调是这样的：

```
table.bind('beforetablesort', function (event, data) {
  $("table").css({opacity: 0.5});
}); 
```

以上所有工作正常。但是，如果我使用`addClass`而不是内联样式，则该类的更改在表完全排序之前不会显示：

```
table.bind('beforetablesort', function (event, data) {
  $("table").addClass('disabled');
}); 
```

如果我将超时时间增加到 500 毫秒以上，则不透明度确实会发生变化。与内联样式更改相比，类更改似乎需要更长的时间才能可见。但是当浏览器准备好重新绘制时，它已经在进行表格排序了。

有没有办法提前强制重绘？还是等到重新绘制表格排序代码才能运行？任意增加超时时间似乎不是一个好的解决方案，因为它会强制所有表至少花费半秒时间进行排序。（如果有帮助，插件的完整代码[在 Github 上。）](https://github.com/joequery/Stupid-Table-Plugin)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T23:18:37.153

Jan Dvorak 的上述评论有效。

> 读取一些计算属性将等待重排。希望它也能确保重新粉刷。

我刚刚添加了该行`$table.css("display");`，浏览器在排序开始之前重新绘制了表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T19:10:49.777

也许你已经考虑过使用 $.deferred() [http://api.jquery.com/jQuery.Deferred/](http://api.jquery.com/jQuery.Deferred/)。当延迟对象被解析时，超时中的代码应该进入回调处理程序

# c# - 将文本附加到现有 Gzip 文件

> ID：15043829
> 
> 赞同：1
> 
> 时间：2013-02-23T18:09:49.520
> 
> 标签：c#, gzip, gzipstream

我正在开发一个日志程序，它将数据转储到 gzip 存档中。

第一个条目如下所示：

```
using (var fs = File.OpenWrite(logFile))
{
    using (var gs = new GZipStream(fs, CompressionMode.Compress))
    {
        using (var sw = new StreamWriter(gs))
        {
            sw.WriteLine(logEntry);
        }
    }
} 
```

现在我想在该文件中添加其他行，而不必重新读取所有文件内容，而不是以可以使用单个 GZipStream 读取结果的方式重写它。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T01:26:44.850

您可以从[示例](https://github.com/madler/zlib/tree/master/examples)目录中的[zlib](http://zlib.net/)分发中使用[`gzlog.h`](https://github.com/madler/zlib/blob/master/examples/gzlog.h)和。他们完全符合您的要求。[`gzlog.c`](https://github.com/madler/zlib/blob/master/examples/gzlog.c)

# c# - 为什么不能将委托分配给方法组？

> ID：15043830
> 
> 赞同：2
> 
> 时间：2013-02-23T18:09:54.043
> 
> 标签：c#, delegates

具有以下课程：

```
class C {
    public void OneMethod(string s) { 
    }

    public void ChangeMethods() {
        OneMethod = delegate(string s) { };
    }
} 
```

编译器说：

> 错误 1 ​​无法分配给“OneMethod”，因为它是“方法组”

这是为什么？我应该创建一个方法组吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T18:13:54.377

您根本无法更改类的行为方式。

方法组仅用于方法调用表达式和创建委托实例时。

如果你想要一个可以像这样动态表现的类，你也许应该看看[`ExpandoObject`](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx). 或者，如果您希望能够让您的`OneMethod`班级根据不同的委托做一些事情，您可以使用相关委托类型的字段轻松地将其连接起来：

```
class C {
    private Action<string> action = delegate {};

    public void OneMethod(string s) { 
        action(s);
    }

    public void ChangeMethods() {
        action = delegate(string s) { };
    }
} 
```

诚然，想要这样做*有点不寻常。*

# regex - 使用正则表达式提取短语结构树中的叶节点

> ID：15043836
> 
> 赞同：1
> 
> 时间：2013-02-23T18:10:46.227
> 
> 标签：regex, nlp, stanford-nlp

我想在 Java 中使用正则表达式来提取句子或短语结构树中的叶节点。例如，给一个句子“这是一个简单的句子。”，

我有语法信息

输入： `(ROOT (S (NP (DT This)) (VP (VBZ is) (NP (DT an) (JJ easy) (NN sentence))) (. .)))`

我想使用正则表达式来提取叶节点

输出：

```
DT This
VBZ is
DT an
JJ easy
NN sentence
.  . 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:47:39.500

如果你没有嵌套括号，那么你可以使用这个：

```
(?<=\()[^()]+(?=\)) 
```

[在 Regexr 上](http://regexr.com?33so8)查看。

`(?<=\()`是一个[lookbehind assertion](http://www.regular-expressions.info/lookaround.html)，它确保匹配前的“（”

`(?=\))`是一个[前瞻断言](http://www.regular-expressions.info/lookaround.html)，它确保匹配后的“）”

`[^()]+`是一个[否定字符类](http://www.regular-expressions.info/charclass.html)，匹配（一个或多个）任何字符，但圆括号除外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-04T23:57:13.330

假设您正在使用基于与此问题相关的标签的斯坦福 NLP：

一个更简单的方法是使用 Tree 类中的内置方法[getLeaves()](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/trees/Tree.html#getLeaves%28%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:50:49.463

您需要的正则表达式是`\(([^ ]+) +([^()]+)\)`

它将：
`\(`匹配一个左括号，
`([^ ]+)`然后是一个或多个除空格之外的字符（称为组#1），
` +`然后是一个或多个空格，
`([^()]+)`然后是除括号之外的一个或多个字符（称为组#2），
`\)`以及最后是一个右括号。

要在 Java 中使用它，请在您的类中预编译该模式：

```
static final Pattern leaf = Pattern.compile("\\(([^ ]+) +([^()]+)\\)"); 
```

然后在每个输入字符串上创建一个匹配器并循环其 find 方法：

```
Matcher m = leaf.matcher(input);
while (m.find()) {
    // here do something with each leaf,
    // where m.group(1) is the node type (DT, VBZ...)
    // and m.group(2) is the word
} 
```

# php - php while循环正在返回每秒的值

> ID：15043838
> 
> 赞同：0
> 
> 时间：2013-02-23T18:10:49.717
> 
> 标签：php, while-loop

我有这样的代码可以通过 odbc 获取一些数据...

```
 $data = odbc_exec($this->odbc_id, $odbc_query);
     odbc_longreadlen($data, 10485760); //10MB = 10485760
     while(odbc_fetch_row($data)) 
     { 
     $row = odbc_fetch_array($data);
     if($row['graphID'] != "") {
     $file_name_jp2 = "TI/" . $table_name . "/" . $row['graphID'] . ".jp2";
     $file = fopen ($file_name_jp2, "w");
     fputs($file, $row['graph']);
     fclose($file);
     set_time_limit(3600);
 }

 unset($row);
 } 
```

但由于某些原因，它每秒都在获取数据库条目......但是为什么呢？我写错了什么？

要更改什么来获取所有数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:15:08.057

您同时使用`odbc_fetch_array`and `odbc_fetch_row`，您应该使用其中之一。类似于：

```
while($row = odbc_fetch_array($data)) {
  // As you were..
} 
```

并删除您的行：

```
$row = odbc_fetch_array($data); 
```

# php - 将 Facebook 粉丝专页 ID 转换为粉丝专页名称 PHP SDK

> ID：15043851
> 
> 赞同：0
> 
> 时间：2013-02-23T18:12:22.123
> 
> 标签：php, facebook-php-sdk

好吧，我真的不知道该怎么做，我在这里的一些帖子中看到的就像

使用它，您将获得粉丝页面 id 的东西。

```
$signedrequest = $facebook->getSignedRequest(); 
```

等等..

但我的问题出在这里，我正在尝试做一个 mysql 选择查询，例如

```
//Note that $uid is MY user id 
$query = "SELECT fanpage_id FROM fb_table WHERE uid='".$uid."';
$result = mysql_query($query);
$fanpage_id = $result[0]; 
```

因此，如果我回显粉丝页面 ID，它将像这样输出

```
420276361382765 
```

如何使用 PHP SDK 将其转换为 facebook 粉丝页面名称？

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:22:41.093

使用图形 API：

```
https://graph.facebook.com/**user_id**/likes?fields=name,created_time,id,likes,talking_about_count&access_token=**Your_Access_Token** 
```

这是通过 FQL：

```
select page_id from page_fan where uid = me() 
```

您需要具有以下权限：

```
user_likes permissions if querying the current user.
friends_likes permissions if querying a user's friend. 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T21:28:32.030

您需要**user_likes 权限**

'范围' => 'email,user_likes,friends_birthday',

```
$pages=$facebook->api("/me/likes");
             $row=array();
             foreach($pages['data'] as $row)
              {
                echo $row['category'] ;
                echo '<br>';
                echo $row['name'] ;
                echo '<br>';
                echo $row['id'] ;
                echo '<br>';
                echo $row['created_time'] ;
                echo '<br>--------------------------------------------------------------';
                echo'<br>';

              } 
```

希望能帮助到你

# c - 从c中的.txt文件中读取二维字符串数组

> ID：15043852
> 
> 赞同：0
> 
> 时间：2013-02-23T18:12:25.587
> 
> 标签：c, arrays, string

我在读取 C 中的二维字符串数组时遇到了麻烦。我有一个文本文件，其布局为：姓名、爱好数量（H）、爱好名称。所以阵列是由爱好的数量决定的。

```
 #include <stdio.h>
     #include <string.h>

typedef struct{
char name[10];
int H;
char hobbi[20];
} data;

int main(void) {
data person[50];
FILE *input;
char source[]=("data.txt");
inout=fopen(source,"r");
int i=0;
int j;
while(!feof(input)) {

        fscanf(input, "%s", person[i].name);
        fscanf(input, "%d", person[i].H);
        for(j=0; j<=person[i].H; j++){
            fscanf(input, "%s", person[i].hobbi[j]);
            }
        i++;

}

fclose(input);
getchar();
getchar();
return 0; 
```

}

我有一个 .txt 文件，如下所示：

```
Jason 3 basketball bowling cycling
Arnold 2 boxing rollerskating
Mary 2 basketball rollerskating
Anne 3 bowling boxing basketball 
```

该程序的目标是，当您输入一个爱好的名称时，它会为您提供一个名称列表，这些名称具有该爱好的共同点。但首先，我试图让输入部分正确。我将这部分代码翻译成英文，所以我希望没有任何错误会破坏代码。任何帮助深表感谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:31:59.503

您的示例显示了“篮球保龄球自行车”，它是一个超过 20 个字符的字符串。我假设每个单词都应该单独存储，所以对于 Jason，hobbi[0] = "basketball", hobbi[1] = "bowling"。但`hobbi`只能容纳 20 个字符。我认为你需要它来保存 20 串字符。现在，hobbi[0] = 'b', hobbi[1] = 'a', hobbi[2] = 's', hobbi[3] = 'k', hobbi[4] = 'e', hobbi[ 5] ='t'。

您需要使 hobbi 成为一个指针数组。并为每一个分配新的空间。

```
char *hobbi[20];
...
fscanf(input, "%s", buffer);
person[i].hobbi[j] = strdup(buffer); 
```

或者使它成为一个数组数组。

```
char hobbi[20][20]; 
```

对于这两个，`person[i].hobbi[j]`是一个字符串（例如，“篮球”）和`person[i].hobbi[j][k]`一个字符（例如，'b'）。

# php - PHP SQL 注册表单的问题

> ID：15043853
> 
> 赞同：0
> 
> 时间：2013-02-23T18:12:36.297
> 
> 标签：php, sql, database, registration

正如标题所示，我正在使用 PHP 和 SQL 创建一个注册表单。每当我单击注册按钮时，表格中的所有变量都会出现未定义的变量错误，数据库中也没有输入任何内容。请如果你能提出任何建议，我正在拔头发。

这是表单提交到的页面：

```
<?php
include('dbconfig.php');
?>

<?php

 echo $_GET["FirstName"]; 
?>

<?php

$db = new PDO('mysql:host=localhost;dbname=mydatabase;', 'root', '');

$firstname = $_POST['FirstName'];
$lastname  = $_POST['LastName'];
$username  = $_POST['username' ];
$password  = $_POST['Password'];
$email     = $_POST['Email'];
$startdate = $_POST['StartDate'];
$year      = $_POST['Year'];

$password = md5($password);

$sql = "INSERT into supervisor (FirstName, LastName, UserName, Password, Email,                      
Company) VALUES (:FirstName, :LastName, :UserName, :Password, :Email)";

$statement = $db->prepare($sql);

$params = array(
':FirstName' => $firstname,
':LastName'  => $lastname, 
':Password'  => $password,
':Email'     => $email,
':StartDate' => $startdate,
':Year'      => $year,
':Company'   => $company
); 
```

dbconfig 文件：

```
<?php

$config['db'] = array(
'host'      => 'localhost',
'username'  => 'root',
'password'  =>  '',
'dbname'    =>  'mydatabase',

);

$db = new PDO('mysql:host='. $config['db']['host'] .';dbname='. $config['db']
['dbname'], $config['db']['username'], $config['db']['password']);

?> 
```

最后是注册php文件（只是表格）：

```
<div class="container">   
  <form id="regform" class="form-signin" action='staffRegister.php' method='Post'    
 onsubmit="return validateForm()"/>
     <img src="logo.png" width="160" height="50"> <h2 class="form-signin-heading">Staff       

Registration</h2>

        <div>
            <label for="name">First Name: </label>
            <input id="fname" name="name" type="text" class="input-                             

block-level" maxlength="35" onFocus="if(this.value=='name')this.value='';" onblur =   
"checkField(this)"/>
            <span id="Alpha"  style="display:none;">Please use letters  

only.</span>
        </div>
        <div>
            <label for="name">Last Name: </label>
            <input id="lname" name="name" type="text" class="input- 

block-level" maxlength="35" onFocus="if(this.value=='name')this.value='';" onblur = 

"checkField1(this)"/>
            <span id="Alpha2"  style="display:none;">Please use letters 

only.</span>
        </div>
        <div>
            <label for="name">UserName: </label>
            <input id="username" name="name" type="text" class="input-

block-level" maxlength="12"  />

        </div>
        <div>
            <label for="email">E-mail Ad:</label>
            <input id="email" placeholder="@kent.ac.uk"name="Email" 
type="text" class="input-block-level" onchange="return validateEmail();"/></br>
            <span id="spanEmail"  style="display:none;">Please use your    
Kent Email.</span>

        </div>
        <div>
            <label for="pass1">Password:</label>
            <input id="pass1" name="pass1" type="password"   
class="input-block-level" maxlength="12" />
            <span id="pass1Info">At least 6 characters: letters,  
numbers and '_'</span>
        </div>
        <div>

    <center><input type='Submit' name='Submit' value="Register" class="btn btn-   
 primary"/ >    </input></center>
  </form> 
```

任何帮助都非常感谢，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T01:13:15.697

你有3个问题。

1.混合`$_GET[]`和`$_POST[]`。作为`form method = post`使用`$_POST[]`

2.form和php之间变量的命名。即`fname`在形式和`$firstname`PHP。文本输入的名称和 ID 也应该相同。

3.当您的变量设置不正确时，会出现您收到的警告。要解决此问题，请使用[**isset()**](http://php.net/manual/en/function.isset.php)。下面的代码说明了问题。（另存为post.php）

```
<?php 
echo "Test for $_POST & isset()<br>";
$test1 = isset($_POST['test1']) ? $_POST['test1'] : ''; 
$test2 = $_POST['test2'];
echo $test1;
echo "<br>";
echo $test2;
?> 
<form action="post.php" method="post"> 
<input name="test1" type="checkbox" value="1"> 
<input name="test2" type="checkbox" value="2"> 
<input type="submit"> 
</form> 
```

上面的演示使用 isset() 和[**三元运算符**](http://phpmaster.com/using-the-ternary-operator/)，我已经说明了如何在您的代码中使用它。

```
$fname = isset($_POST['$fname']) ? $_POST['$f'] : ''; 
$lname = isset($_POST['$lname']) ? $_POST['$lname'] : ''; 
etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:21:32.170

您的 HTMl 中的名称与您在`$_POST`. 您同时发布 Firstname 和 Surname 的名称`name`并尝试`$_POST['FirstName']` `$_POST['LastName']`分别获取它们。

# css - CSS未在本地python httpserver重启时更新

> ID：15043854
> 
> 赞同：9
> 
> 时间：2013-02-23T18:12:43.730
> 
> 标签：css, http, simplehttpserver

我对 web 开发和 http 服务器等领域还很陌生，但我有一个基本的 shell 脚本，如下所示：

```
PORT=2600 
if [[ $1 =~ ^[0-9]+$ ]]
  then PORT=$1
fi

echo "Starting local http server (ctrl-c to exit)"
echo ""
echo "  Demo:   http://127.0.0.1:$PORT/demo"
echo ""
python -m SimpleHTTPServer $PORT 
```

只是把东西放在上面似乎没问题，但是当我在我的演示中更新 css 文件时，它很少且不一致地更新页面上显示的 css。对它呈现的任何 html 的更改都很好，并且偶尔会显示 css 更改，但我觉得我在这里做的事情根本上是错误的。想法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-23T19:06:27.250

问题是浏览器缓存。您可以a）清除浏览器缓存或打开隐身浏览或b）将某种缓存破坏附加到您的css / js资源，即`foo.css?(timestamp)`等`foo.css?(version#)`。对于较大的系统，后者更好，这样您就不会强迫用户清除浏览器代码推送到生产后缓存。

# c++ - 具有 unique_ptr 问题的类

> ID：15043858
> 
> 赞同：1
> 
> 时间：2013-02-23T18:13:11.640
> 
> 标签：c++, c++11

使用 emplace_back 时，传递的参数 (k,v) 必须存在构造函数，因此我需要下面的构造函数。但是，由于我使用 unique_ptr，它抱怨无法访问“删除”，我相信这意味着我正在做一些让我拥有多个指针的事情。

我无法弄清楚语法。如何以正确的方式编写此构造函数？

```
struct KV{ 
    unique_ptr<string> k, v;
    KV(){} 
    KV (unique_ptr<string> k_,unique_ptr<string> v_):k(move(k_)),v(move(v_)){} 
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:17:45.327

你的构造函数没问题。`unique_ptr`一个可能的问题是，在将两个s 提供给构造函数时，您没有移动它们：

```
#include <memory>
#include <string>

using namespace std;

struct KV{
   unique_ptr<string> k, v;
   KV(){}
   KV (unique_ptr<string> k_,unique_ptr<string> v_):k(move(k_)),v(move(v_)){}
};

int main()
{
   unique_ptr<string> p1(new string());
   unique_ptr<string> p2(new string());

   // KV v(p1, p2); // ERROR!
   KV kv(move(p1), move(p2)); // OK

   vector<KV> v;    
   v.emplace_back(move(p1), move(p2)); // OK       
} 
```

**更新：**

VS2012 发布时，VC11 不支持可变参数模板。的正确实现`emplace_back()` *应该*是可变的，但 MS 提供了一个虚拟的。当 CTP 发布时，只有*编译器*更新为支持可变参数模板，但 STL 尚未更新。因此，您仍然会收到错误消息。

如果你不能改变你的编译器，除了等待产品的下一个版本发布之外，没有什么可做的。同时，避免使用`emplace_back()`和使用`push_back()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:25:51.283

您还没有提到您要`emplace_back`进入的容器，但假设它是 a `vector`，如果您的`KV`结构真的那么简单，则无需声明任何构造函数。只需使用聚合初始化。

```
#include <memory>
#include <string>
#include <utility>
#include <vector>

using namespace std;

struct KV
{
   unique_ptr<string> k, v;
   // KV(){}
   // KV (unique_ptr<string> k_,unique_ptr<string> v_):k(move(k_)),v(move(v_)){}
};

int main()
{
   unique_ptr<string> p1(new string());
   unique_ptr<string> p2(new string());

   KV v{move(p1), move(p2)}; // initialize an instance
                             // this step is not necessary, you can skip it

   vector<KV> vec;

   vec.emplace_back(KV{move(v.k), move(v.v)});
} 
```

# c++ - 如何自动为指针取消引用添加保护措施？

> ID：15043860
> 
> 赞同：1
> 
> 时间：2013-02-23T18:13:28.853
> 
> 标签：c++, pointers

取消引用无效指针或智能指针时代码崩溃。添加了一个断言来帮助查找问题。例如，

```
Type* p = NULL; // Always initilize to be null.
assert(p); // Add before dereferencing to help to find the problem.
p->f(); // Crashes if p is invalid. 
```

我的问题是如何在取消引用指针时自动添加断言。例如，

```
#define PTR_RUN(p, f) assert(p); p->f; 
```

这可行，但可读性不好，并且可能由于粗心使用宏而存在一些隐藏问题。还有更好的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:29:53.863

或者在某些情况下是否值得使用某种抛出异常的智能指针？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:17:17.137

通常人们会写，

```
if ( p ) p->f 
```

或者

```
 p && p->f 
```

使用短路 AND 运算符

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T18:45:45.960

您可以为给定类型重载运算符`->`，并可能在其中添加断言函数。我从来没有这样做过，但它可能会奏效。

# python - 覆盖应用程序的静态文件？

> ID：15043864
> 
> 赞同：1
> 
> 时间：2013-02-23T18:13:50.257
> 
> 标签：python, django, static, django-geoposition

我正在尝试[`django-geoposition`](https://github.com/philippbosch/django-geoposition)（实际上是 django 本身）。我想使用我自己的静态文件版本`geoposition.js`。所以在我的项目下，我创建了一个`static/geoposition/geoposition.js`（`STATIC_ROOT`定义为`static`在项目根目录下），其中包含我想要的替代内容。在本地开发服务器中一切正常。

但是，当我运行时`python manage.py collectstatic`，原始的会被复制过来。我有点理解为什么会这样。现在，问题是，我如何覆盖应用程序附带的这个 js 文件并使用我自己的？不幸的是，这使用了一个小部件并在那里定义它的`Media`文件，而不是从一个模板，我可以很容易地覆盖并使用不同名称的我的 js 内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T22:13:20.473

您可以轻松扩展此小部件并使用静态文件覆盖其媒体：

```
class MyGeoWidget(GeoPositionWidget):
     class Media:
         extend = False
         css = {
               'all': ('whatever.css',)
            }
         js = ('mygeoposition.js',) 
```

# hibernate - criteria.list() 显示空指针异常

> ID：15043866
> 
> 赞同：1
> 
> 时间：2013-02-23T18:14:01.217
> 
> 标签：hibernate, jakarta-ee

我正在研究 Hibernate 3.3。最近我开始使用标准。我的注释类如下..

```
@Entity
@Table(name = "EMAG_ADMINLOGIN", schema = "EMAG_USER")
public class Adminlogin implements java.io.Serializable {

private String username;
private String password;
private String fullname;
private long isenabled;

@Id
@Column(name = "USERNAME", unique = true, nullable = false, length = 40)
public String getUsername() {
    return this.username;
}

public void setUsername(String username) {
    this.username = username;
}
@Column(name = "PASSWORD", length = 40)
public String getPassword() {
    return this.password;
}

public void setPassword(String password) {
    this.password = password;
}

@Column(name = "FULLNAME", nullable = false, length = 100)
public String getFullname() {
    return this.fullname;
}

public void setFullname(String fullname) {
    this.fullname = fullname;
}
@Column(name = "ISENABLED", precision = 0)
public long getIsenabled() {
    return this.isenabled;
}

public void setIsenabled(long isenabled) {
    this.isenabled = isenabled;
}
} 
```

我的标准代码如下

```
Criteria criteria=session.createCriteria(Adminlogin.class);
criteria=criteria.add(Restrictions.eq("username", "admin"));
List list=criteria.list(); 
```

当 isEnabled 值在一行上为空时，此代码显示错误。我知道它不能将 null 值转换为 long 原始数据类型。所以我想知道有没有其他方法可以跳过任何属性的空值。（我发布了一个表类，并且我有更多具有相同类映射的表）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:21:27.497

尝试使用 NotFound 注释：可能您的问题将得到解决

```
 @NotFound(action = NotFoundAction.IGNORE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T20:54:32.233

根据您的要求，将“已启用”的类型更改为“长”或为 db 模式中的列定义默认值。

# asp.net - SQL Server 视图返回奇怪的 EF 结果

> ID：15043867
> 
> 赞同：0
> 
> 时间：2013-02-23T18:14:04.227
> 
> 标签：asp.net, entity-framework-4

我编写了一个简单的查询并将其保存为视图（见下文...）当我在 SSMS 中运行查询时，它返回 30 行，它们是正确的。当我在实体框架中设置它时（全程使用向导......我做了三遍......）在生成的网格视图中至少有一行重复了几次。我总共有 30 行，但很多是重复的，还有一些是缺失的。一行重复 9 次。

我使用下面的脚本使用新名称重新创建了视图（三个实际上是两个行为不端），以确保 EF 没有任何剩余的工件。我使用了一个处女 asp.net 页面，带有一个新的数据源和一个处女，几乎完全是香草数据网格，“autogenerate=true”打开，所以我没有控制任何东西。如果有帮助，我可以显示标记。生成的标记中包含所有副本，因此这不是客户端渲染问题。

也许我应该通过使用 Linq to SQL 或其他方式将 EF 排除在循环之外，但我不知道如何。我会在发布后尝试这样做。谢谢....

[编辑——我将数据源更改为 SQLDataSource，它运行良好。完全正确的结果！]

```
 USE [CPAS];
GO

SET ANSI_NULLS ON;
GO

SET QUOTED_IDENTIFIER ON;
GO

CREATE VIEW dbo.tstTimesheetSummarybyWorkerDiscipline
AS SELECT dbo.tblTimesheetDetail.TimesheetID , 
          dbo.tblWorkers.WorkerName AS [Worker Name] , 
          dbo.tblStaffAugLaborRates.TradeType AS [Trade Type] , 
          SUM( dbo.tblTimesheetDetail.TSDStdHrs
             )AS [Regular Hours] , 
          SUM( dbo.tblTimesheetDetail.TSDOTHrs
             )AS [Overtime Hours] , 
          SUM( dbo.tblTimesheetDetail.TSDDTHrs
             )AS [Doubletime Hours] , 
          SUM( dbo.tblTimesheetDetail.TSDStdHrs + dbo.tblTimesheetDetail.TSDOTHrs + dbo.tblTimesheetDetail.TSDDTHrs
             )AS [Tot Hrs] , 
          SUM( dbo.tblTimesheetDetail.TSDMiscAmt
             )AS [Expense Amt] , 
          COUNT( *
               )AS [Timesheet Count]
     FROM
          dbo.tblTimesheetDetail INNER JOIN dbo.tblWorkers
          ON dbo.tblTimesheetDetail.TSDWorkerID
             = 
             dbo.tblWorkers.ID
                                 INNER JOIN dbo.tblStaffAugLaborRates
          ON dbo.tblTimesheetDetail.TSDLaborRateID
             = 
             dbo.tblStaffAugLaborRates.ID
     GROUP BY dbo.tblTimesheetDetail.TimesheetID , 
              dbo.tblWorkers.WorkerName , 
              dbo.tblStaffAugLaborRates.TradeType;

GO 
```

# asp.net - 传入日期并获取该月的第一个和最后一个日期？

> ID：15043870
> 
> 赞同：2
> 
> 时间：2013-02-23T18:14:25.647
> 
> 标签：asp.net, datetime

我将日期存储在会话变量中，然后将其转换为日期。现在我想获取该月的第一个和最后一个日期作为过去的日期。

```
DateTime tempDate = System.Convert.ToDateTime(Session["Diary_Date"]);
DateTime startOfMonth = //what goes here?
DateTime endOfMonth = //?? 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T18:17:17.900

一种方法：

```
DateTime startOfMonth = new DateTime(tempDate.Year, tempDate.Month, 1);
DateTime endOfMonth = startOfMonth.AddMonths(1).AddDays(-1); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T18:24:38.043

另一种方法是

```
DateTime startOfMonth = new DateTime(tempDate.Year, tempDate.Month, 1);
DateTime endOfMonth = new DateTime(tempDate.Year, tempDate.Month, DateTime.DaysInMonth(tempDate.Year, tempDate.Month)); 
```

# html - 用 css 设置 a 的背景

> ID：15043871
> 
> 赞同：2
> 
> 时间：2013-02-23T18:14:28.487
> 
> 标签：html, css

是否可以使用单个 CSS 设置框架的背景颜色（我知道，作业要求它），而不是为每个框架做一个。该作业特别要求使用 CSS 而不是标签。我尝试了以下方法：

```
<frameset.........>
  <frame src="frames/leftframe.htm" class="LeftFrame" name="leftframe" noresize>
  <frame.......>
  <frame.......>
</frameset> 
```

我有一个名为 leftframe.htm 的页面，其中包含：

```
<html>
  <link rel="stylesheet" type="text/css" href="../styles/allframes.css">
  <body>
    <p>..........</p>
  </body>
</html> 
```

样式表 allframes.css 具有：

```
.LeftFrame
{
   background-color:#b0c4de;
} 
```

我无法让它发挥作用。只要我有一个单独的样式表，我就可以设置每帧的背景颜色。如果这不可能，我将为每个框架制作单独的样式表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:32:02.170

框架集页面的样式表无法设置其框架页面的背景。它可以在`frame`元素上设置背景，但这是一个不同的问题：只有当框架文档具有透明背景时才能看到这样的背景。在实践中，即便如此：框架文档将显示为好像其最终背景是白色的。

所以你可以做的是在框架文件上设置背景。您可以使用相同的样式表，但是您不能引用与框架文档相关的任何内容，例如`.leftFrame`选择器。你会简单地写例如

```
body { background:#b0c4de; } 
```

在您从每个框架文档链接到的样式表中。

# c++ - 它是正确的 C++ 应用程序结构吗？

> ID：15043872
> 
> 赞同：-1
> 
> 时间：2013-02-23T18:14:42.783
> 
> 标签：c++, cmake, application-structure

我有一个问题是这个正确的应用程序结构？我从 C++ 和 CMake 开始，我想以正确的方式开始。

```
Root
 |--build
 |--src
 |   |-Application
 |   |    |-------App.cpp
 |   |    |-------App.h
 |   |    |-------CMakeLists.txt
 |   |-Logger
 |   |    |--Some files
 |   |    |--CMakeLists
 |   |-CMakeLists.txt
 |   |-main.cpp
 |--CMakeLists.txt 
```

根\CMakeLists.txt

```
cmake_minimum_required (VERSION 2.6 FATAL_ERROR)
# set (CMAKE_VERBOSE_MAKEFILE ON)

set (APP_NAME "sdl-example")

project (${APP_NAME})

# ///////////////////////
# /// Check build dir ///
# ///////////////////////

set (Build_Dir_OK "TRUE")
string (REGEX MATCH "^${CMAKE_SOURCE_DIR}" In_Sub_Dir ${CMAKE_BINARY_DIR})
if (In_Sub_Dir)
    string (REGEX MATCH "^${CMAKE_SOURCE_DIR}/build" In_Build_Dir ${CMAKE_BINARY_DIR})
    if (NOT In_Build_Dir)
        set (Build_Dir_OK "FALSE")
    endif ()
endif ()

if (NOT Build_Dir_OK)
    message (FATAL_ERROR "You must run cmake from a directory that is not in your source tree, or that is in a special subdirectory of the tree whose name begins with ‘build’.")
endif ()

# ///////////////////////////
# /// Initializing OpenGL ///
# ///////////////////////////

find_package(OpenGL)
if (NOT OPENGL_FOUND)
    message (FATAL_ERROR "OpenGL not found")
else (NOT OPENGL_FOUND)
    message ("OpenGL correctly found")
endif (NOT OPENGL_FOUND)

include_directories(
    ${OPENGL_INCLUDE_DIRS}
    ${INCLUDE_DIRECTORIES}
)

# ////////////////////////
# /// Initializing SDL ///
# ////////////////////////

find_package(SDL)
if (NOT SDL_FOUND)
    message (FATAL_ERROR "SDL not found!")
else (NOT SDL_FOUND)
    message ("SDL correctly found")
endif (NOT SDL_FOUND)

include_directories(
    ${SDL_INCLUDE_DIR}
    ${INCLUDE_DIRECTORIES}
)

set (LIBRARIES ${OPENGL_LIBRARIES} ${SDL_LIBRARY})

add_subdirectory(src) 
```

根\src\CMakeLists.txt

```
if (APP_NAME STREQUAL "") 
    message (FATAL_ERROR "You must set the COMPONENT_NAME variable!")
endif ()

message ("Preparing application: " ${APP_NAME})

file (GLOB SRCS ./*.c ./*.cpp)
file (GLOB HDRS ./*.h ./*.hpp)

include_directories (${CMAKE_CURRENT_SOURCE_DIR})

# /////////////////////////
# /// Adding executable ///
# /////////////////////////

add_executable (
    ${APP_NAME}
    ${SRCS}
    ${HDRS}
)

set (COMPONENT_NAME "application")
set (COMPONENTS ${COMPONENTS} ${COMPONENT_NAME})
add_subdirectory("Application")

target_link_libraries(
    ${APP_NAME}
    ${LIBRARIES}
    ${COMPONENTS}
    ${TARGET_LINK_LIBRARIES}
) 
```

根\src\应用程序

```
if (COMPONENT_NAME STREQUAL "") 
    message (FATAL_ERROR "You must set the COMPONENT_NAME variable!")
endif ()

message ("Preparing component:" ${COMPONENT_NAME})

file (GLOB SRCS ./*.c ./*.cpp)
file (GLOB HDRS ./*.h ./*.hpp)

add_library(
    ${COMPONENT_NAME}
    ${SRCS}
    ${HDRS}
)

target_link_libraries (
    ${COMPONENT_NAME}
    ${LIBRARIES}
    ${SDL_LIBRARY}
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:15:11.710

没有“正确”的方法可以做到这一点。唯一的规则是做任何让你最容易维护的事情。您的目录结构看起来可以从您提供的少量信息中找到。

如果您发现您正在使用的目录结构让您感到痛苦或使事情难以保持井井有条，您可以随时调整文件。

# java - 让 JButton 打开一个新的 JPanel

> ID：15043878
> 
> 赞同：0
> 
> 时间：2013-02-23T18:15:18.547
> 
> 标签：java, eclipse, swing, user-interface, awt

我正在创建一个当前有 3 个类的程序。除了 2 个其他 JPanel 类之外，这些还包括 JFrame 类。有谁知道我如何在一个 JPanel 类中制作一个 JButton 删除该特定的 JPanel 并让 JFrame 添加一个新的 JPanel（来自另一个类）？

例如，假设JFrame 类称为frame，两个JPanel 类称为panel1 和panel2。如果在 panel1 中单击按钮，如何告诉框架删除 panel1 并添加 panel2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:25:52.717

好吧，这取决于您对“删除”一词的含义。

一个好的方法是使用 MigLayout 使用 hidemode 属性。表单的初始状态将包含 JFrame 中的两个面板，但第二个面板将不可见。

当您按下第一个 JPanel 的按钮时，它会将这个面板的可见性设置为 false，并将第二个面板的可见性设置为 true。

另一方面，如果要从框架中完全删除第一个面板，请使用方法 panel.setName(panelsName) 为其命名，然后检索 JFrame 的每个子组件并将它们放入集合中。

然后遍历这个集合，并检查每个组件的名称。

如果 component.getName().equals(panelsName) 然后使用 frame.remove(component) 方法摆脱它。之后，您可能必须在框架中调用 validate 和 repaint，尽管我不确定是否有必要。试试看；）

# highslide - 是否可以处理 Highslide 中的断开链接？

> ID：15043879
> 
> 赞同：0
> 
> 时间：2013-02-23T18:15:19.273
> 
> 标签：highslide

我们目前在我们的网站 (www.teesaw.com) 上使用一个 highslide 画廊。画廊由托管在多个外部来源的许多图像组成。有时，我们的 PHP 脚本会引入对不存在（或被用户的 Web 过滤器阻止）的图像的引用，从而导致链接断开。

当使用滑块在图像之间移动时，当下一个图像是断开的链接时，它会卡在“加载”部分。有没有办法让 highslide 检测到这个并自动跳过它？

请帮忙！谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:40:05.943

这可以通过修改 highslide-full.js 本身的代码来解决，并在加载程序超时时放入一个调用您网站上的一些默认图像（如“哎呀！”图像）的例程。请参阅旧的 Highslide 论坛：

[http://highslide.com/forum/viewtopic.php?f=1&t=16664&p=69519](http://highslide.com/forum/viewtopic.php?f=1&t=16664&p=69519)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-28T09:47:02.603

还有这个解决方案，看起来很简单：

[http://roadrash.no/hs-support/handle-missing-images.html](http://roadrash.no/hs-support/handle-missing-images.html)

> 您只需将此代码放在 highslide-with-gallery.js 中的第 1266 行之后（或在 highslide-full.js 中的第 1473 行之后）：

```
img.onerror = function () {
    setTimeout(function () {
        img.src = hs.graphicsDir + 'no-image.png';
        if (hs.ie) { // FIX FOR IE9
            img.width = img.naturalWidth;
            img.height = img.naturalHeight;
        }
    }, 1000);
}; 
```

# haskell - 在函数执行递归后操作列表

> ID：15043890
> 
> 赞同：1
> 
> 时间：2013-02-23T18:16:45.833
> 
> 标签：haskell, function-composition

我是 Haskell 的新手，我正在尝试在列表上执行一些递归函数，并且在递归完成后，我想从递归访问输出列表以执行附加操作。

例如，下面的函数接受一个要保留的值和一个列表，它返回一个列表，其中只包含要保留的值，丢弃所有其他值。

我想做的是了解如何在递归发生后访问输出列表，以便继续对其进行操作。

就像是：

```
//recursive function here

//get length of output list from recursive function
length list 
```

我的功能

```
keepAll _ [] = []
keepAll y (x:xs) | x==y = y:keepAll y xs
                 | otherwise = keepAll y xs 
```

提前谢谢了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T18:21:31.387

首先，你`keepAll`更容易写成

```
keepAll y = filter (y==) 
```

其次，您可以`length`对结果应用或其他方式，例如

```
length (keepAll 'a' "abrakadabra") 
```

应该是5。

* * *

因此，您的问题“我如何将 f 应用于 g 的结果”的一般答案是

```
(f . g) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T18:26:03.833

您正在寻找[功能组合。](http://www.haskell.org/haskellwiki/Function_composition)

一个函数的输出可以作为输入传递给另一个函数，如下所示：

```
f (g x) 
```

或者

```
(f . g) x 
```

其中函数 g 的输出类型与 f 的输入类型相同。

(.) 运算符将两个这样的函数组合成一个管道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T19:55:10.580

除了一般情况下的函数组合外，您还可以将 keepAll 的特定结果分配给变量并稍后使用该值：

```
outputList = keepAll 3 [1,2,3,3,3,4,5,3]
print (init outputList)   >> [3,3,3]
print (length outputList) >> 4 
```

如果您想访问函数内部递归的输出列表，您可能希望将递归委托给内部的“帮助器”函数，例如：

```
keepSome y (x:xs) = keepAll y (x:xs)
  where keepAll _ [] = []
        keepAll y (x:xs) | x==y = y:keepAll y xs
                         | otherwise = keepAll y xs 
```

现在您可以更改第一行，以便按照您的建议将“init”应用于递归结果：

```
keepSome y (x:xs) = init $ keepAll y (x:xs)
  where keepAll _ [] = []
        keepAll y (x:xs) | x==y = y:keepAll y xs
                         | otherwise = keepAll y xs 
```

例如，您还可以将递归的输出列表命名为“outputList”，如果它使您更容易使用，并将 init 应用于该列表：

```
keepSome y (x:xs) = init outputList
  where outputList = keepAll y (x:xs)
        keepAll _ [] = []
        keepAll y (x:xs) | x==y = y:keepAll y xs
                         | otherwise = keepAll y xs 
```

样本输出：
*Main> keepSome 3 [1,2,3,3,3,4,5,3]
[3,3,3] --init of the inside result, [3,3,3,3]

# xml - 选择特定的 xml 节点

> ID：15043892
> 
> 赞同：0
> 
> 时间：2013-02-23T18:17:05.700
> 
> 标签：xml, xpath

我有一个具体问题：

看着

```
<observation realtime_start="2013-02-23" realtime_end="2013-02-23" date="1975-01-01" value="4917.2"/>
<observation realtime_start="2013-02-23" realtime_end="2013-02-23" date="1976-01-01" value="5186.8"/> 
```

所以我试图获取特定日期的值属性，但是

```
string xmlNode = root.SelectSingleNode("/observations/observation/@value").Value; 
```

使用它可以获得第一个值（4917.2）。我将如何指定我想要来自“1976-01-01”和 5186 的值？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:22:19.537

这将做到：

```
string xmlNode = root.SelectSingleNode("/observations/observation[@date='1976-01-01']/@value").Value; 
```

这表示选择日期为 1976-01-01 的观察节点的 @value。并且要获得@value 的整数，您可能需要使用正在执行此操作的任何语言（我敢打赌它具有向下舍入功能）。正如@JLRishe 观察和解释的那样，您`root`似乎是一个.NET XmlNode 或XPathNavigator，它只能选择节点，因此下面的内容将不起作用并且会引发异常。我把它留在里面是为了表明有用于舍入的 xpath 函数。

```
string xmlNode = root.SelectSingleNode("floor(/observations/observation[@date='1976-01-01']/@value)").Value; 
```

如果使用 xpath 函数 route （您似乎无法使用），并且如果您想始终舍入到最接近的整数，请将 floor 更改为舍入。如果你想总是四舍五入，把地板换到天花板。

# php - 如何用问号重写网址？

> ID：15043898
> 
> 赞同：1
> 
> 时间：2013-02-23T18:17:31.953
> 
> 标签：php, regex, apache, mod-rewrite, query-string

是否可以重写带有问号的网址？

例如，

```
http://localhost/mysite/search?tag=mars 
```

变成这样，

```
index.php?url=search&tag[key_name]=mars 
```

我试过这个，但一点都不好，

```
RewriteRule ^search?tag=([a-zA-Z0-9\-]+)/?$  index.php?url=search&tag[key_name]=$1&type=tag [L,QSA] 
```

有什么建议么？

**编辑：**

对于`%1`,

```
RewriteCond %{QUERY_STRING} (?:^|&)tag=([^&]+)
RewriteRule ^search$ index.php?url=search&tag\%5Bkey_name\%5D=%1&type=tag [L] 
```

结果，

```
print_r($_GET);

Array
(
    [url] => search
    [tag] => Array
        (
            [key_name] => 
        )

    [type] => tag
) 
```

对于`%0`,

```
RewriteCond %{QUERY_STRING} (?:^|&)tag=([^&]+)
RewriteRule ^search$ index.php?url=search&tag\%5Bkey_name\%5D=%0&type=tag [L] 
```

结果，

```
print_r($_GET);

Array
(
    [url] => search
    [tag] => Array
        (
            [key_name] => tag=mars
        )

    [type] => tag
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:21:52.507

查询字符串不能在`RewriteRule`. 您必须`RwwriteCond`改用：

```
RewriteCond %{QUERY_STRING} (?:^|&)tag=([^&]+)
RewriteRule ^search$ index.php?url=search&tag\%5Bkey_name\%5D=%1&type=tag [L] 
```

这里：

*   `[`和`]`urlencoded 为`%5b`and`%5D`
*   `\%`用于转义文字`%`字符
*   `%0`...`%9`是在`RewriteCond`子句中匹配/捕获的字符串。这就是您使用`$0`...`$9`的方式`RewriteRule`
*   `QSA`不需要标志
*   `(^|&)`匹配输入的开头（例如 in `tag=mars&foo=bar`）或`&`（例如 in `foo=bar&tag=mars`）
*   `?:`使 mod_rewrite*不捕获*这个组（其他这个匹配会进入`%1`，下一个进入`%2`，等等）

您的 PHP 脚本将获得：

```
$_GET["url"]  : search
$_GET["tag"]  : Array([key_name] => mars)
$_GET["type"] : tag 
```

# wordpress - 在不破坏 Wordpress 404 消息的情况下从 Wordpress 隐藏一些目录

> ID：15043899
> 
> 赞同：1
> 
> 时间：2013-02-23T18:17:43.287
> 
> 标签：wordpress, .htaccess, mod-rewrite

我试图阻止 Wordpress 弄乱`/example`and `/example2`，因为我有一些高级的东西（例如密码保护），Wordpress 正在破坏并错误地向其发送 404 消息。

这是我的.htaccess：

```
DirectoryIndex index.html index.php parking-page.html

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_URI} !^/(example|example/.*|example2|example2/.*).*$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ./ /index.php [L]
</IfModule>

# END WordPress 
```

这可以从这些文件夹中阻止 Wordpress，但现在 Wordpress 将不再捕获错误的 URL，除非它们中有一个`/`。例如，Wordpress 将捕获：

```
mydomain.com/something/
mydomain.com/something/anything
mydomain.com/something/anything.html 
```

但它不会抓住

```
mydomain.com/something
mydomain.com/something.html 
```

（即使`mydomain.com/something`是一个有效的 WP 页面，如果我没有 %{REQUEST_URI} 行）

后一种类型的 URL 被给予服务器 404 消息。除了这两个目录之外，我怎样才能让 Wordpress 保持在所有内容的循环中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T23:38:17.663

我已经找到了解决方案（[hat-tip](http://wordpress.org/support/topic/htaccess-getting-wordpress-and-password-protected-files-to-play-well-together#post-750550)）。这与[这个问题](https://stackoverflow.com/a/18157129/925897)完全相同，除了他的问题是有问题的目录使用 WebDAV，我的问题是目录使用密码保护。

本质上，默认的 WordPress 规则应该按原样工作——但是当文件夹受密码保护时它们会中断。这些应该将其作为文件 ( `-f`) 或目录 ( `-d`) 捕获的规则失败：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

它没有将我的受密码保护的目录作为文件或目录捕获，因为它卡在密码提示符处——而且我没有任何错误页面可以将其发送到。因此，解决方案是设置错误处理：

```
ErrorDocument 401 /err.txt
ErrorDocument 403 /err.txt 
```

只需将这两行放在所有 WordPress 内容之上并创建`/err.txt`. 这样它就可以登陆文件，并且默认的 WP 代码可以很好地工作。

# android - 阻止 WhatsApp 播放通知声音

> ID：15043901
> 
> 赞同：1
> 
> 时间：2013-02-23T18:17:45.433
> 
> 标签：android, event-handling, notifications, hook, whatsapp

也许您知道问题所在，您在一个whatsapp 组中，其中包含许多关于您不关心的消息的通知。

为了防止关闭所有通知/声音，我如何从whatsapp捕获/挂钩通知事件，甚至可能丢弃顶部栏中的通知？

感谢您的任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:32:41.600

您无法在自己的应用中监控、控制、覆盖和关闭来自另一个应用的通知。

但是，在 WhatsApp 特定情况下，您可以从 WhatsApp 应用程序中将群组静音，甚至完全关闭群组通知。

# c# - 将运算符应用于没有“动态”的两个对象

> ID：15043903
> 
> 赞同：0
> 
> 时间：2013-02-23T18:18:09.137
> 
> 标签：c#, operators, interpreter

背景：我正在为一种简单的语言编写解释器，供用户玩耍和玩乐。它将作为游戏的模组运行。我不能使用动态的原因是因为游戏在 Unity3d 中运行，它运行相当于 .net 3.5 的 Mono 版本（没有动态）。

现在的问题是：我将值存储为对象。在评估表达式（比如添加）时，我遇到了尝试做“对象+对象”的问题。我怎样才能做到这一点？

一种解决方案是在每个对象上做一个巨大的 switchblock，检查它的类型以查看它是否是基本值类型（int、long、double 等），如果是，则转换为该类型并添加。如果不是基本值类型，则在每种类型中查找 op_Addition 方法，如果存在，则调用它。

这可能会很快为每个操作员执行大量代码。我想知道是否有更好的，更少复制粘贴的方式。（最佳解决方案是一些 .net 库函数`object Add(object, object)`，但这是有希望的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:21:01.443

您可以为定义所需操作的对象定义一个接口，然后确保所有存储的对象都实现该接口（可能包装简单类型）。

# ruby-on-rails - 如何避免在 Rails 中生成有用的东西

> ID：15043909
> 
> 赞同：2
> 
> 时间：2013-02-23T18:18:42.063
> 
> 标签：ruby-on-rails, ruby-on-rails-3

当我运行命令时

```
rails g controller admin/inbox 
```

它生成 test_unit 和 helper/test_unit。但我不想生成它。在生成控制器期间如何避免它

```
 create  app/controllers/admin/inbox_controller.rb
  invoke  erb
  create    app/views/admin/inbox
  invoke  test_unit
  create    test/functional/admin/inbox_controller_test.rb
  invoke  helper
  create    app/helpers/admin/inbox_helper.rb
  invoke    test_unit
  create      test/unit/helpers/admin/inbox_helper_test.rb
  invoke  assets
  invoke    coffee
  create      app/assets/javascripts/admin/inbox.js.coffee
  invoke    scss
  create      app/assets/stylesheets/admin/inbox.css.scss 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:29:21.313

您可以通过像这样配置来自定义您的工作流程`config/application.rb`..

```
config.generators do |g|
  g.orm             :active_record
  g.template_engine :erb
  g.test_framework  :test_unit, :fixture => false
  g.stylesheets     false
end 
```

有关详细信息，请访问[http://guides.rubyonrails.org/generators.html](http://guides.rubyonrails.org/generators.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T20:47:08.177

如果由于某种原因，您只想跳过测试生成一次，您可以这样做：

```
rails g controller admin/index --skip-test-framework 
```

或者

```
rails g controller admin/index --no-test-framework 
```

这在[Generators::Base 的文档中](http://api.rubyonrails.org/classes/Rails/Generators/Base.html)有所介绍。

# javascript - Greasemonkey 脚本无法将日期/时间传递给 GM_setValue

> ID：15043910
> 
> 赞同：0
> 
> 时间：2013-02-23T18:18:43.787
> 
> 标签：javascript, greasemonkey

我正在编写一个 Greasemonkey 脚本，我想知道它上次运行的时间。为此，我想存储当前时间`GM_setValue`并将该时间与再次运行脚本的时间进行比较。

但是，`Date().getTime()`结果似乎不会传递给`GM_setValue`. 例如，如果您运行：

```
var newtime = new Date().getTime();
GM_setValue('lastrun', newtime);
alert(GM_getValue('lastrun')); 
```

由于不会弹出警告框，因此显然存在错误。但是，如果您将第一行替换为：

```
var newtime = 1; 
```

然后，您会像预期的那样在警报框中返回 1。

这几乎只是隔离了导致问题的日期格式。关于如何处理这个问题的任何想法，或者在脚本运行时间之间保存日期的更好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T06:51:05.503

我有一个类似的问题。该数字太大，无法存储为 firefox cookie 值。我的解决方案是将精度限制为秒（除以 1000，减去余数）并减去 43 年（1356998400 秒）以将测量的日期从 2013 年 1 月 1 日午夜开始，所以我的代码如下所示：

```
var time = Math.floor((new Date().getTime() / 1000) - 1356998400);
GM_setValue("runTime", time); 
```

检索看起来像：

```
 var time = GM_getValue("runTime", 0);
        if (time != 0) {
        var cur = Math.floor((new Date().getTime() / 1000) - 1356998400);
        var cur = cur - time;
        var sec = cur % 60;
        var min = Math.floor(cur / 60);
        console.log("Script took " + min + ":" + sec);
        } 
```

# css - html.erb 不使用引导样式

> ID：15043911
> 
> 赞同：-4
> 
> 时间：2013-02-23T18:18:48.513
> 
> 标签：css, ruby-on-rails, twitter-bootstrap

我的 index.html.erb 不使用 Twitter 的引导样式。没有 bootstrap 的表看起来很丑，因为 bootstraps`zebra-striped`类显然无法识别。

但在我看来，其他文件非常自举，所以问题出在这一小段代码中（受[这个问题](https://stackoverflow.com/q/16306122/2013672)的启发）

为什么会这样？

```
<table class="zebra-striped">
  <tr>
    <th>Name </th>
  </tr>

<% @students.each do |student| %>
  <tr>
    <td><%= student.name %></td>
  </tr>
<% end %>
</table> 
```

宝石文件：

```
gem 'bootstrap-sass', '2.1'
gem 'sass-rails',   '~> 3.2.3' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T03:33:38.950

阅读文档将有助于解决标记问题 [http://twitter.github.com/bootstrap/base-css.html#tables](http://twitter.github.com/bootstrap/base-css.html#tables)

您还应该更标准地标记您的表格。

```
<table class="table table-striped">
  <thead>
  <tr>
    <th>Name </th>
  </tr>
  </thead>

  <tbody>
  <% @students.each do |student| %>
    <tr>
      <td><%= student.name %></td>
    </tr>
  <% end %>
  </tbody>
</table> 
```

# vim - ctags 不解析某些 clib 标头

> ID：15043912
> 
> 赞同：4
> 
> 时间：2013-02-23T18:18:50.003
> 
> 标签：vim, ctags

好的，我刚刚安装了 ctags，我尝试用这样的 ctags 解析整个 C 库：

```
ctags -I__wur --c++-kinds=+p --fields=+iaS -f ~/.tags/tags /usr/include/*.h 
```

看来，这一行没有正确解析某些库。例如，如果我在 fclose 函数上点击 C-]，ctags 会将我定向到 /usr/include/stdio.h fclose 的行，我可以看到我需要的有关该函数的所有信息。但是奇怪的事情发生在 string.h 中的函数原型上。例如，如果我在 strcpy 上按 C-]，我会收到以下消息：

```
E426: tag not found: strcpy 
```

所以我决定像这样解析标签文件：

```
ctags -R -I__wur --c++-kinds=+p --fields=+iaS -f ~/.tags/tags /usr/include/ 
```

现在，如果我在 strcpy 上按 g]，我可以选择以下文件之一来打开：

```
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h 
```

但不知何故，我看不到/usr/include/string.h。这里有什么问题？我是否以某种方式错误地使用了 ctags？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:28:14.523

我怀疑这`/usr/include/string.h`实际上是一个符号链接`/usr/include/bits/stringx.h`。ctags 工作正常。

# javascript - JavaScript 是按引用传递还是按值传递？

> ID：15043917
> 
> 赞同：5
> 
> 时间：2013-02-23T18:19:38.570
> 
> 标签：javascript, html, oop

JavaScript 语言是按引用传递还是按值传递语言？

原始类型与对象的区别也不同吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T18:21:31.017

它实际上使用了一种名为[call by sharing](http://dmitrysoshnikov.com/ecmascript/chapter-8-evaluation-strategy/#call-by-sharing)的评估策略。

所有类型都按值传递。没有传递引用，否则您将能够修改在函数调用站点声明的变量的内容。通常人们说在 JS 中对象是通过引用传递的。它们实际上是通过共享传递的，这意味着您可以修改对象的属性，并且这些更改对于持有对该对象的引用的人是可见的，但引用本身是不可修改的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T18:20:42.083

对象通过引用传递，而基元通过值传递。

请注意，原始值包括以下内容：

*   数字
*   细绳
*   布尔值
*   `undefined`
*   `null`

[您可以在MDN 上的 Functions 上](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Functions)找到更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T18:25:07.867

除了原语之外的所有东西都是通过引用传递的。
JavaScript 中几乎所有的东西都是一个对象。正如 Sirko 所说，对象是通过引用传递的。

所以函数/数组/对象都是通过引用传递的，无论您是在谈论附加到 var 的根对象，还是在谈论对象的属性/方法，链接 3 个点深，或者您在谈论数组中的对象，作为对象的属性，在对象数组中...

# c++ - 解决由于共享一个公共模板类的类的多重继承而导致的歧义

> ID：15043919
> 
> 赞同：1
> 
> 时间：2013-02-23T18:19:58.500
> 
> 标签：c++, templates, multiple-inheritance, ambiguous, diamond-problem

我正在尝试创建一个基类，它是一个模板类，并接受某个类作为模板。这个基类在另外两个类的父类中，它们本身就是最终类的父类。因此，除了根基类是模板类之外，我在 C++ 中遇到了传统的菱形问题。在这里使用虚拟继承并不能完全解决问题。

编辑：包括一些代码（和更正的错别字）

```
#include<iostream>
#include<string>

using namespace std;

template<class TemplateT>
class MainMaster {
    protected: 
        std::string name;
        int number;
        TemplateT variableProp;

    public:
        explicit MainMaster(std::string, int);

        void setName(std::string);
        std::string getName();
        void printName();

        void setNumber(int);
        int getNumber();
        void printNumber();

        void printMasterProperties(std::string);

        void setVarProp(TemplateT);
        TemplateT getVarProp();
};    

template<class TemplateT>
MainMaster<TemplateT>::MainMaster(std::string nameIn, int numIn){
    setName(nameIn);
    setNumber(numIn);
}    

template<class TemplateT>
void MainMaster<TemplateT>::setName(std::string nameIn){ name = nameIn; }

template<class TemplateT>
std::string MainMaster<TemplateT>::getName(){ return name; }

template<class TemplateT>
void MainMaster<TemplateT>::printName(){ cout << "Master's name is " << name << endl; }

template<class TemplateT>
void MainMaster<TemplateT>::setNumber(int numIn){ number = numIn; }

template<class TemplateT>
int MainMaster<TemplateT>::getNumber(){ return number; }

template<class TemplateT>
void MainMaster<TemplateT>::printNumber(){ cout << name << "'s number is " << number << endl; }

template<class TemplateT>
void MainMaster<TemplateT>::printMasterProperties(std::string pre = ""){
    cout << pre << "Master Properties" << endl
        << pre << "-Number: " << number << endl;
}

class ChildOne: public virtual MainMaster<std::string>{
    protected:
        std::string propOne;

    public:
//      using MainMaster::MainMaster;
        ChildOne(std::string nameIn, int numIn, std::string p1);
        void printName();
        void setPropOne(std::string);
        std::string getPropOne();

        void printOnesProps(std::string);
};    

ChildOne::ChildOne(std::string nameIn, int numIn, std::string p1): MainMaster<std::string>(nameIn,numIn){
    setPropOne(p1);
}

void ChildOne::printName(){ cout << "ChildOne's name is " << name << endl; }

void ChildOne::setPropOne(std::string propIn){ propOne = propIn; }

std::string ChildOne::getPropOne(){ return propOne; }

void ChildOne::printOnesProps(std::string pre = ""){
    printMasterProperties("-");
    cout << pre << "One Properties" << endl
        << pre << "-PropOne: " << propOne << endl;
}    

class ChildTwo: public virtual MainMaster<int>{
    protected:
        std::string propTwo;

    public:
        ChildTwo(std::string nameIn, int numIn, std::string p2);
        void printName();

        void setPropTwo(std::string);
        std::string getPropTwo();

        void printTwosProps(std::string);
};

ChildTwo::ChildTwo(std::string nameIn, int numIn, std::string p2): MainMaster<int>(nameIn,numIn){
    setPropTwo(p2);
}

void ChildTwo::printName(){
    cout << "ChidTwo's name is " << name << endl;
}

void ChildTwo::setPropTwo(std::string propIn){ propTwo = propIn; }

std::string ChildTwo::getPropTwo(){ return propTwo; }

void ChildTwo::printTwosProps(std::string pre = ""){
    printMasterProperties("-");
    cout << pre << "Two Properties" << endl
        << pre << "-PropTwo: " << propTwo << endl;
}

class FinalChild: public ChildOne, public ChildTwo{
    protected:
        double finalProp;

    public:
        FinalChild(std::string nameIn, int num, std::string prop1 ,std::string prop2, double pFinal);
        void printFinalProps(std::string);
};

FinalChild::FinalChild(std::string nameIn, int num, std::string prop1 ,std::string prop2, double pFinal):
ChildOne(nameIn, num, prop1),
ChildTwo(nameIn, num, prop2),
MainMaster(nameIn, num){
    finalProp = pFinal; 
}

void FinalChild::printFinalProps(std::string pre = ""){
    printMasterProperties("-");
    cout << pre << name << "'s Final Properties" << endl;
    cout << pre << "-Number: " << number << endl;
    cout << pre << "-PropOne: " << propOne << endl;
    cout << pre << "-PropTwo: " << propTwo << endl;
    cout << pre << "-finalProp " << finalProp << endl;
}

int main () {
    MainMaster<char> master("Master", 0);
    ChildOne child1("Child1",1,"P1One");
    ChildTwo child2("Child2",2,"P2Two");
    FinalChild finalC("FinalChild", 3, "P1Final", "P2Final", 3.0);

    master.printMasterProperties();
    child1.printOnesProps();
    child2.printTwosProps();
    finalC.printFinalProps();

} 
```

# javascript - Javascript 数组中的连接和聚合

> ID：15043921
> 
> 赞同：0
> 
> 时间：2013-02-23T18:20:06.833
> 
> 标签：javascript, arrays, linq.js

我已经尝试了几个小时来使用 json.js 来做到这一点，但对于看似简单的事情来说太过分了。我有这个示例数据：

```
 var hotels = [
        { id: 101, Name: "Hotel 101", WebFacilities: [8, 9, 10] },
        { id: 102, Name: "Hotel 101", WebFacilities: [8] },
        { id: 103, Name: "Hotel 101", WebFacilities: [8, 10] }
    ];

    var facilities = [
        { id: 8, Name: "Facility 8" },
        { id: 9, Name: "Facility 9" },
        { id: 10, Name: "Facility 10" }
    ]; 
```

我想得到这个：

```
 var selectedFacilities = [
        { id: 8, Name: "Facility 8", Count: 3 },
        { id: 9, Name: "Facility 9", Count: 1 },
        { id: 10, Name: "Facility 10", Count: 2 }
    ]; 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T09:11:56.010

因此，您似乎正在尝试计算每个设施的数量。

这是使用 C# 编写查询的一种方法：

```
var hotelFacilities =
    from hotel in hotels
    from id in hotel.WebFacilities
    group id by id;

var query =
    from facility in facilities
    join g in hotelFacilities on facility.id equals g.Key
    select new
    {
        id = facility.id,
        Name = facility.Name,
        Count = g.Count(),
    }; 
```

现在，如果您可以使用方法语法来描绘这一点，那么它几乎是对 linq.js 版本的 1:1 转换。

请注意，编译器翻译上述内容的方式通常会将`GroupBy()`调用包含在前一个`SelectMany()`调用中。然而，以这种方式编写将使编写 linq.js 等效查询更容易且不那么尴尬。

```
var hotelFacilities = hotels
    .SelectMany(hotel => hotel.WebFacilities)
    .GroupBy(id => id);

var query = facilities
    .Join(
        hotelFacilities,
        facility => facility.id,
        g => g.Key,
        (facility, g) => new
        {
            id = facility.id,
            Name = facility.Name,
            Count = g.Count(),
        }
    ); 
```

和等效的 linq.js 查询。

```
var hotelFacilities = Enumerable.From(hotels)
    .SelectMany("hotel => hotel.WebFacilities")
    .GroupBy("id => id")
    .ToArray();

var query = Enumerable.From(facilities)
    .Join(
        hotelFacilities,
        "facility => facility.id",
        "g => g.Key()",
        "(facility, g) => { id: facility.id, Name: facility.Name, Count: g.Count() }"
    ).ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:25:00.083

用这个：

```
var selectedFacilities = facilities;

for(var i = 0; i < facilities.length; i++) {
    for(var j = 0; j < hotels.length; j++) {
        if(hotels[j]["id"] == facilities[i]["id"]) {
            // Add data
            selectedFacilities[i]["Count"] = hotels[i]["WebFacilities"].length;
        } else {
            selectedFacilities[i]["Count"] = 0;
        }
    }

} 
```

# c# - 更改 asp.net mvc 默认用户帐户

> ID：15043922
> 
> 赞同：0
> 
> 时间：2013-02-23T18:20:13.013
> 
> 标签：c#, asp.net-mvc, user-accounts

我一直在尝试使用 MVC 的默认记帐功能，但一直失败。

我想更改其中的一些内容，但似乎不起作用。

1.  我想让用户名成为电子邮件。
2.  我不想有密码字段的问题和答案。（当我试图删除它们时，它给了我一个错误，我没有提供这些项目）。
3.  我想向成员添加其他字段，例如名字、姓氏、地址等。

我怎样才能做到这一点？有没有更动态的方法来代替 MVC 的默认记帐功能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T20:26:54.697

您正在寻找自定义会员提供者。您可以尝试以下 Dan Harman 的文章。它应该为您指明正确的方向。

[带有存储库注入的 ASP.Net MVC 3 自定义成员资格提供程序](http://www.danharman.net/2011/06/23/asp-net-mvc-3-custom-membership-provider-with-repository-injection/)

# java - Android 应用程序运行时错误

> ID：15043924
> 
> 赞同：0
> 
> 时间：2013-02-23T18:20:15.757
> 
> 标签：java, android

我有 2 个用于 Android 项目的课程。第一个类是 Activity，第二个类只是实现接口的 OnClickListener。

如果我在手机上运行该项目，我总是会遇到运行时错误。我也收到了消息：

指定的活动不存在！获取启动器活动。

这是我的两节课

发送活动

```
package kops.sms;

//import android.R;
import android.app.Activity;

import android.os.Bundle;
import android.view.Menu;
import android.widget.Button;

public class SendActivity extends Activity {

Button buttonSend= (Button) findViewById(R.id.buttonSend);

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_send);

    buttonSend.setOnClickListener(new ButtonListener());
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.send, menu);
    return true;
}

} 
```

和 ButtonListener

```
package kops.sms;

import android.view.View;
import android.view.View.OnClickListener;

public class ButtonListener implements OnClickListener {

     @Override
        public void onClick(View v)
        {

        }

} 
```

我不知道怎么了...

我期待着您的回复！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:23:44.037

打电话*后*`findViewById()`才能打电话。请搬家：*`setContentView()`*

 *```
Button buttonSend= (Button) findViewById(R.id.buttonSend); 
```

之后：

```
setContentView(R.layout.activity_send); 
```

之前：

```
buttonSend.setOnClickListener(new ButtonListener()); 
```

此外，将来，请使用 LogCat（例如，在 Eclipse 的 DDMS 透视图中）检查与您的崩溃相关的 Java 堆栈跟踪。您会被告知您的`NullPointerException`，这可能会帮助您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:25:09.683

确保您`Activity`在清单中声明。另外，改变你的`onCreate()`

```
public class SendActivity extends Activity {

Button buttonSend;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_send);
    buttonSend = (Button) findViewById(R.id.buttonSend);
    buttonSend.setOnClickListener(new ButtonListener());
} 
```

您不能在调用之前调用`View`诸如 a ，因为它存在于您的中，并且在调用之前您没有膨胀您的。如果这些不能解决您的问题，请发布`Button``setContentView()``Layout``Layout``setContentViewe()``Logcat`

**编辑**

除非我错过了，否则您需要`Activity`在清单中包含所有 s。就像是：

```
<activity
        android:name="your.package.name.SendActivity"
       // activity attributes such as config changes, lable, etc...
</activity> 
```

**日志猫**

Logcat 输出可能是确定崩溃的最重要部分之一。它列出了错误是什么，以及发生问题的活动的行号。如果使用 Eclipse，

> 窗口-->显示视图-->其他-->Android-->Logcat

如果您使用编码括号复制/粘贴 Logcat，则可以更轻松地获得帮助。您还可以为日志设置过滤器，这样您就不会收到每条消息，而且更易于管理。例如，我有一个过滤器：过滤器名称：运行时，按日志标记：AndroidRuntime，按日志级别：错误。这只会给我运行时错误/崩溃的错误消息。这些过滤器位于 logcat 视图的左侧。希望这可以帮助*

# c++ - 从不再存在的函数创建的 lambda 的内部框架中修改 via 闭包中的变量是否安全

> ID：15043925
> 
> 赞同：3
> 
> 时间：2013-02-23T18:20:20.850
> 
> 标签：c++, c++11

这适用于 g++ 4.7

```
#include <iostream>
#include <functional>                                                                           

std::function<int()> make_counter() {
    return []()->std::function<int()> {
        int c=0;
        return [=]() mutable ->int {
            return  c++ ;
        };  
    }();
}   

int main(int argc, char * argv[]) {
    auto count1= make_counter();
    auto count2= make_counter();

    std::cout << "count1=" << count1() << std::endl;
    std::cout << "count1=" << count1() << std::endl;
    std::cout << "count2=" << count2() << std::endl;
    std::cout << "count1=" << count1() << std::endl;
    std::cout << "count2=" << count2() << std::endl;
    return 0;
} 
```

似乎我应该能够做到这一点，因为 c 在 make_function 返回后不再存在，但确实如此

```
count1=0
count1=1
count1=2
count2=0
count1=3
count2=1 
```

我猜 [=] 是这样的，所以 c 的存储值和可变值允许修改存储的值，尽管我只是想确定一下。

Valgrind 完全没有抱怨这一点。每次我调用 make_counter 时，valgrind 都会报告一个额外的分配和空闲，所以我假设 lambda 元编程代码正在为变量插入内存的分配代码。我想知道这是否符合 Cxx11 或者它是否只是 g++ 特定的。

假设答案是正确的，我可以将 make_counter 简化为

```
std::function<int()> make_counter() {                                                             
      int c=0 ;
      return [=]() mutable ->int {
          return  c++ ;
      };  
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T18:22:42.150

是的。

通过指定`[=]`您制作了局部变量的*副本*，并且该副本被隐藏在 lambda 中的某处。该表达式`c++`使用该本地副本，它将与 lambda 一样存在。

请注意，如果引用外部变量，`mutable`则没有必要；`c`它的存在是必要的，因为它`c`被复制捕获并因此存在于 lambda“主体”中。

# java - Java 7 - String.intern() 行为

> ID：15043926
> 
> 赞同：4
> 
> 时间：2013-02-23T18:20:21.820
> 
> 标签：java, string, java-7, pool

我已经阅读[了有关如何检查字符串是否在 Java 中被实习的答案](https://stackoverflow.com/questions/4883821/java-tell-if-a-string-is-interned/4883828#4883828)，但我不明白以下结果：

```
String x = args[0]; // args[0] = "abc";
String a = "a";
String y = a + "bc";
System.out.println(y.intern() == y); // true 
```

但是如果我声明一个字符串文字：

```
String x = "abc";
String a = "a";
String y = a + "bc";
System.out.println(y.intern() == y); // false 
```

此外，没有任何字符串文字，`args[0]`似乎直接被实习：

```
// String x = "abc";
String y = args[0];
System.out.println(y.intern() == y); // true (???)
// false if the first line is uncommented 
```

为什么会`y.intern() == y`根据是否`x`为文字而改变，即使对于使用命令行参数的示例也是如此？

我知道[文字字符串在编译时被保留](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#intern%28%29)，但我不明白为什么它会影响前面的示例。我还阅读了几个关于字符串实习的问题，例如*[字符串池行为](https://stackoverflow.com/questions/14490043/string-pool-behavior)*、*[关于 Java 的字符串池](https://stackoverflow.com/questions/1881922/questions-about-javas-string-pool)*和*[Java 字符串池的问题 - 池何时更改？](https://stackoverflow.com/questions/14447637/java-string-pool-when-does-the-pool-change)*. 但是，他们都没有对这种行为给出可能的解释。

**编辑：**

我错误地写道，在第三个示例中，如果声明了结果并不会改变`String x = "abc";`，但它确实会改变。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T18:28:27.837

这是因为如果字符串之前没有被实习过，就会`y.intern()`返还。`y`如果字符串已经存在，则调用将返回已经存在的实例，该实例很可能不同于`y`.

但是，所有这些都高度依赖于实现，因此在不同版本的 JVM 和编译器上可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:52:07.193

实施细节可能不同。但这正是我所期望的行为。您的第一种情况意味着默认情况下命令行参数不被实习。因此在实习后`y.intern()`返回对它的引用。`y`

第二种情况是 VM 自动实习文字，因此`y.intern()`返回对 的引用`x`，这与`y`.

最后一种情况再次发生，因为默认情况下没有任何东西被实习，所以调用`intern()`返回对`y` . 我认为更积极地实习 String 是合法的，但据我所知，这是规范要求的最小行为。

# c - 用几个相似的块在 C 中解析一个文件

> ID：15043927
> 
> 赞同：0
> 
> 时间：2013-02-23T18:20:25.917
> 
> 标签：c, file, parsing

我有一个具有以下格式的文件：

```
abc dca
2
aa bb
casca casss

abc dca
3
aa bb
casca casss
casca casss

abcd abcd
0 
```

基本上它是按块进行的（在前面的示例中将有 3 个块）。一个特定的块将是：

```
abc dca
2
aa bb
casca casss 
```

在所有情况下，我们都会有：
第一行：总是两个单词，用空格隔开。
第二行：一个数字

从这里开始，我们将有与前一个数字一样多的行，并且每行总是有两个单词。

如何解析文件，以便对于每个块我可以调用一个函数，传递一些我用我在块中找到的东西计算的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:45:20.953

使用最小状态机：

```
#include <stdio.h>
#include <string.h>

int main(int qrgc, char **argv)
{
char buff[111];
char one[10], two[10];
char left[10], right[10];
int num;
size_t len;
int state,rc;

state =0;

while(fgets (buff, sizeof buff, stdin)) {
        len = strlen (buff);
        while (len && buff[len-1] == '\n') buff[--len] = 0;
        switch (state) {
        case 0:
                rc = sscanf(buff, "%s %s", left, right);
                if (rc < 2) goto quit;
                state=1;
                break;
        case 1:
                rc = sscanf(buff, "%d", &num);
                if (rc < 1) goto quit;
                state=2;
                break;
        default:
                if (!len) {state = 0; continue; }
                rc = sscanf(buff, "%s %s", one, two);
                if (rc < 2) goto quit;
                break;
                }
        }
quit: ;
return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:28:00.653

有很多方法可以做到这一点。我想到的两个是：

如果文件不是很大，那么您可以将其全部读入字符串列表（每行一个字符串）。

另一种方法是通过创建一个接受文件句柄和前一个块的函数。

（我不想用 C 写动态数组）

# c++ - 理解默认构造函数 C++

> ID：15043933
> 
> 赞同：0
> 
> 时间：2013-02-23T18:20:45.680
> 
> 标签：c++, default-constructor

```
class WithCC { // With copy-constructor
public:
  // Explicit default constructor required:
  WithCC() {}
  WithCC(const WithCC&) {
    cout << "WithCC(WithCC&)" << endl;
  }
};

class WoCC { // Without copy-constructor
  string id;
public:
  WoCC(const string& ident = "") : id(ident) {}
  void print(const string& msg = "") const {
    if(msg.size() != 0) cout << msg << ": ";
    cout << id << endl;
  }
};

class Composite {
  WithCC withcc; // Embedded objects
  WoCC wocc;
public:
  Composite() : wocc("Composite()") {}
  void print(const string& msg = "") const {
    wocc.print(msg);
  }
}; 
```

我正在阅读 C++ 第 11 章默认复制构造函数中的思考。对于上面的代码，作者说：“该类`WoCC`没有复制构造函数，但它的构造函数将在内部字符串中存储一条消息，可以使用打印出来 。这个构造函数在构造函数初始化列表`print( )`中显式调用”。`Composite’s`

为什么`WoCC`必须在构造函数中显式调用`Composite`构造函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:31:14.173

您可以愉快地省略显式构造，因为`wocc`它将是隐式默认构造的。默认构造函数是不带参数的构造函数。`WoCC`具有默认构造函数，因为采用 a 的构造函数`string`具有该字符串的默认值。

如果你想传递一个特定的字符串，则只需要显式调用构造函数，就像在这种情况下发生的那样。

但是，如果参数没有默认值（删除`= ""`），那么您确实必须在`Composose`. 这是因为定义您自己的任何构造函数都会阻止编译器隐式生成默认的默认构造函数。如果它没有默认构造函数，那么您需要确保为该`wocc`成员调用正确的构造函数。

此外，`WoCC`确实有一个复制构造函数。`delete`如果您没有定义一个，编译器会生成一个隐式复制构造函数（如果您提供移动构造函数，它只会将其定义为d）。

# wpf - WPF TabControl：如何将 TabItem 标题文本传递给 ViewModel

> ID：15043934
> 
> 赞同：0
> 
> 时间：2013-02-23T18:20:50.733
> 
> 标签：wpf, mvvm

我需要将 TabItem 标头字符串从 xaml 传递给 ViewModel，我将在其中使用此文本来触发事件，因此当我在 tabcontrol 中选择任何选项卡时，tabitem 标头将被发送到 viewmodel 以触发事件。我还需要在选择 tabitem 标题而不是选项卡上的任何其他部分时发生这种情况。这是一个选项卡式界面应用程序。

提前致谢

# c# - 应用内购买时出现COMException

> ID：15043942
> 
> 赞同：0
> 
> 时间：2013-02-23T18:21:38.027
> 
> 标签：c#, silverlight

我设置了一个按钮来调用以下方法：

```
private async void buyTimeUP()
{
    await CurrentApp.RequestProductPurchaseAsync("MyItem", false);
    DoFullFillment();
} 
```

当我购买/下载这个项目时，一切都很好，下面的代码运行得很好：

```
public void DoFullFillment()
{
    var productLicenses = CurrentApp.LicenseInformation.ProductLicenses;
    checkTransaction(productLicenses["MyItem"]);
}

private void checkTransaction(ProductLicense lic)
{
     if (lic.IsConsumable && lic.IsActive)
     {
         Debug.WriteLine("License bought");
         CurrentApp.ReportProductFulfillment(lic.ProductId);
      }
} 
```

但是，如果用户使用后退按钮从应用内对话框返回，或者如果他取消交易，代码会在

```
 at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at MyApp.Shop.<buyTimeUP>d__0.MoveNext() 
```

我怎样才能摆脱这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T02:18:47.110

要解决此问题，请在 RequestProductPurchaseAsync 方法调用周围添加 try/catch ...

```
try
{
   receipt = await CurrentApp.RequestProductPurchaseAsync("MyItem", false);
}
catch (Exception){} 
```

# php - 模型现在进行数据/表单验证。如何将用户友好的错误消息返回到视图？

> ID：15043946
> 
> 赞同：1
> 
> 时间：2013-02-23T18:22:03.830
> 
> 标签：php, oop, model-view-controller, exception

从今天开始，我开始在模型层而不是控制器中验证表单数据。我将尽可能缩短代码片段。

这是来自我的`User`域对象的方法（`setLastName()`方法基本相同）

```
public function setFirstName($firstName) {

    if(!$firstName) throw new \InvalidArgumentException('Some message');
    if( strlen($firstName) < 2  || strlen($firstName) > 20 ) throw new \LengthException('Some message');
    if(preg_match('/[^a-zA-Z\'.-\s]/', $firstName)) throw new FormatException('Some message');

    $this->firstName = $firstName;
} 
```

在我的控制器中，我有这样的东西

```
$userService = $this->serviceFactory->build('User');

try {
    $userService->register('John', 'M');
} 
catch(\InvalidArgumentException $ex) {

}
catch(\LengthException $ex) {

}
catch(etc etc) 
```

在我的`UserService`方法`register()`中，我有类似的东西

```
$user->setFirstName($firstName);
$user->setLastName($lastName); 
```

运行该`setFirstName()`方法时，它将成功设置提供的名字。该`setLastName()`方法将抛出 a`LengthException`因为它太短了。

这就是我想要的，但是当它返回到服务层然后返回到控制器并且我抓住它时，我知道 a`LengthException`被抛出但我不能给用户一个正确的消息，比如“提供的姓氏太短”因为我不知道哪个字段抛出了异常，只知道异常的类型。

我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:37:09.230

视图实例应该从模型层请求信息。控制器**不负责**传递信息。

这也意味着你强迫性地使用异常，这会导致你的抽象层泄漏，这将是完全没有意义的。“错误”只是模型层的一种状态。这是**预期**的情况，而不是例外。

MVC 中的控制器负责改变模型层的状态和（很少）当前视图实例的状态。他们不应该收到来自服务的任何反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T02:43:19.713

我也有同样的问题。我认为大多数说所有验证都应该在模型中完成的人从来没有自己开发过完整的 PHP MVC 应用程序，只知道书籍和理论。从来没有看到关于该主题的一段代码。

无论如何，我已经想到了一个可能的解决方案。您如何看待下面的代码：

```
// Controller

$user = User::make(
    $_POST['lastname'], $_POST['firstname'], 
    $_POST['gender'], [...]
);
if(is_array($user)) {
    // store the errors in a view variable and forward, or store in session and redirect
    $_SESSION['errors'] = $user;
    $this->_redirect('add');
    exit;
}

// Model

public static make($lastname, $firstname, $gender, [...]) {
    $errors = array();
    if(/* test firstname */) $errors[] = 'model_error_firstname';
    if(/* test lastname */) $errors[] = 'model_error_lastname';
    if(!empty($errors)) return $errors;

    return new User($lastname, $firstname, $gender, [...]);
} 
```

该模型将有一个静态函数，如果出现问题，它将返回一个带有错误的数组，或者如果验证正常，则返回一个新的模型对象。

在您的控制器中，您测试是否返回了一个数组。

也许我会将 User 的构造函数设为私有，因为如果您直接使用构造函数构建用户，您将跳过所有验证。但这并不意味着它变成了 Singleton。

也许我还会在将表单字段传递给模型之前对其进行清理并使其安全。

像 model_error_xyz 这样的键可以在带有适当文本的翻译文件中找到。

更新：

实际上，我认为您可以从构造函数中抛出一个自定义异常，其中包含一组消息。但我没有提出这个的原因是，它导致了半构造对象，至少在 Java 中是这样，但是，嘿，PHP 不是 Java ......

您还必须验证每个 setter 函数 :( 在模型实例中进行验证似乎很乏味。

欢迎任何想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:25:17.373

与其返回*一些消息*，不如返回一个有用的错误消息，例如*“提供的名字太短”*。然后可以将其返回给用户。

或者，您可以看到，在[扩展异常](http://www.php.net/manual/en/language.exceptions.extending.php)时，您可以指定其他信息，例如数字代码 - 您当然可以使用它。

或者，当然你可以为不同的情况创建一个 Exception 的子类，但你最终可能会得到数百`Exception`个子类，这些子类当然会很混乱。

# javascript - 统一风格分享按钮

> ID：15043949
> 
> 赞同：0
> 
> 时间：2013-02-23T18:22:27.923
> 
> 标签：javascript, css, styles

我正在寻找一个以统一样式提供三个主要社交媒体共享按钮的库，有点像下图：

![在此处输入图像描述](../Images/a27102bc47b72d02f06394348e131daa.png)

是否有（GitHub？）项目提供开箱即用的统一社交媒体按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T21:05:58.680

[http://sapegin.github.com/social-likes/](http://sapegin.github.com/social-likes/) - 这个插件提供统一风格的社交按钮。它与图像上的样式不完全相同，但可以轻松自定义。

# java - 如何在骆驼路线中使用 OSGI 包？

> ID：15043954
> 
> 赞同：3
> 
> 时间：2013-02-23T18:22:48.263
> 
> 标签：java, osgi, apache-camel

我在骆驼路线中使用 OSGI 服务时遇到问题。阅读[tutorial-osgi-camel-part1](http://camel.apache.org/tutorial-osgi-camel-part1.html) 但没有让它工作。

设置：

*   bundle 1 定义了一个 Service 接口（接口的单独包，因为它可以有多个实现）
*   bundle 2 实现了这个接口
*   bundle 3 应该使用 bundle 2，它提供 bundle 1 的接口

在 bundle 2（实现）中有两个 xml 文件，一个带有

```
<osgi:service ref="invokeService">
    <osgi:interfaces>
        <value>invoker.Invoker</value>
    </osgi:interfaces>
</osgi:service> 
```

另一个与

```
<bean id="invokeService" class="invokerImpl.InvokerImpl">
</bean> 
```

Bundle 3 有一个 xml 文件

```
 <osgi:reference id="invokeService" interface="invoker.Invoker"/> 
```

在里面。Bundle 3 和 CamelContext 开始于

```
@Override
public void start(BundleContext bundleContext) throws Exception {
    OsgiDefaultCamelContext camelContext = new OsgiDefaultCamelContext(bundleContext);
    camelContext.addRoutes(new ExampleRoute());
    camelContext.start();
} 
```

在我的路线中，我想使用服务（来自捆绑包2）

```
.to("bean:invokeService") 
```

我得到的例外：

```
19:14:39.953  TRACE  o.a.camel.core.osgi.OsgiClassResolver:42       Resolve class invokeService
19:14:39.969  TRACE  o.a.camel.core.osgi.OsgiClassResolver:84       Cannot load class: invokeService using classloader: CamleOSGIExample_1.0.0.qualifier [254]. This exception be ignored.
java.lang.ClassNotFoundException: invokeService
at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513) ~[na:na]
at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:429) ~[na:na]
(...) 
```

和

```
org.apache.camel.NoSuchBeanException: No bean could be found in the registry for: invokeService
    at org.apache.camel.component.bean.RegistryBean.getBean(RegistryBean.java:68) ~[camel-core-2.10.3.jar:2.10.3]
    at org.apache.camel.component.bean.BeanProcessor.process(BeanProcessor.java:83) ~[camel-core-2.10.3.jar:2.10.3] 
```

我正在使用春分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T17:44:35.323

还讨论了这里和解决方案： [http ://camel.465427.n5.nabble.com/Problems-using-a-osgi-bundle-in-a-camel-route-tp5728064.html](http://camel.465427.n5.nabble.com/Problems-using-a-osgi-bundle-in-a-camel-route-tp5728064.html)

# r - 连接点

> ID：15043956
> 
> 赞同：8
> 
> 时间：2013-02-23T18:23:04.330
> 
> 标签：r, ggplot2

我有以下情节

```
require(ggplot2)

dtf <- structure(list(Variance = c(5.213, 1.377, 0.858, 0.613, 0.412, 0.229, 0.139, 0.094, 0.064), Component = structure(1:9, .Label = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9"), class = "factor")), .Names = c("Variance", "Component"), row.names = c(NA, -9L), class = "data.frame")

ggplot(dtf, aes(x = Component, y = Variance)) +
geom_point() 
```

![在此处输入图像描述](../Images/9a12f650a42adaf8c58c86ba421515bd.png)

我只想用直线连接点。我试过`+geom_line()`了，但产生了一个错误

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-23T18:25:33.500

您的`x`值是离散的（因子），`geom_line()`每个唯一`x`值都被视为单独的组，并尝试仅连接该组内的点。设置确保所有值都被视为一组`group=1`。`aes()`

```
ggplot(dtf, aes(x = Component, y = Variance,group=1)) +
  geom_point()+geom_line() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:39:12.047

这将绘制带有 x 的点作为因子类别的整数值：

```
 ggplot(dtf, aes(x = as.numeric(Component), y = Variance)) +
      geom_point() + geom_line() 
```

您可以使用以下命令放回类别标签：

```
ggplot(dtf, aes(x = as.numeric(Component), y = Variance)) +
  geom_point() +geom_line() + scale_x_discrete(labels=dtf$Component) 
```

# api - Googlemaps Api v3 getJson 在 IE 中不起作用

> ID：15043957
> 
> 赞同：0
> 
> 时间：2013-02-23T18:23:09.580
> 
> 标签：api, internet-explorer, jquery

我有以下问题：我正在尝试使用下面的代码通过 ajax 从 googlemaps api v3 获取数据。它在 Chrome 和 Firefox 中运行良好，但在 IE 中不行。我究竟做错了什么？

```
var lat;
$.ajax({
url: "url",
cache: false,
dataType: "json",
success: function(data) {      
lat = data.results[0].geometry.location.lat;
}                                                                                                   
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:34:46.010

将以下错误事件添加到您的 Ajax 调用中

```
 success: function(data) {
     lat = data.results[0].geometry.location.lat;
    },
   error: function(xhr, status, error) {
     alert(status);
   } 
```

让我们知道您在 IE 中收到的错误消息（如果有的话）。

*编辑*- 听起来你正在尝试做一个跨域请求？如果是这种情况，请尝试`$.support.cors = true;`在您的 ajax 请求之前进行设置。

取自[http://api.jquery.com/jQuery.support/](http://api.jquery.com/jQuery.support/)

> 要在尚不支持 cors 但允许跨域 XHR 请求（Windows 小工具等）的环境中启用跨域请求，请设置 `$.support.cors = true;`

*EDIT2* - 我假设你正在运行 IE9，在这种情况下你需要一个 jQuery 插件在这里找到： [https ://github.com/jaubourg/ajaxHooks/blob/master/src/xdr.js](https://github.com/jaubourg/ajaxHooks/blob/master/src/xdr.js)

另请参阅 SO 上的此答案，以获取有关 IE9（带有 cors）为什么需要插件的更多详细信息：[带有 CORS 的 IE9 jQuery AJAX 返回“访问被拒绝”](https://stackoverflow.com/questions/10232017/ie9-jquery-ajax-with-cors-returns-access-is-denied)

*EDIT3* - 下载[jQuery.XDomainRequest.js](https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest/blob/8754607e5f9ab73ccc37246f0c12fed14f85bd28/jQuery.XDomainRequest.js)并将其包含在您的 AJAX 调用之前。

# internet-explorer - 如何在 Internet Explorer 9 中显示扩展名为 .cfm 的 Bootstrap 样式表？

> ID：15043959
> 
> 赞同：0
> 
> 时间：2013-02-23T18:23:26.217
> 
> 标签：internet-explorer, twitter-bootstrap, coldfusion, internet-explorer-9

为什么 IE9 在使用 .cfm 文件名时会丢失所有样式表？

我正在测试来自 Bootstrap ( [http://surgenia.com/instal/temp.cfm](http://surgenia.com/instal/temp.cfm) )的基本示例模板

它适用于 FF 和 Chrome，甚至只是将临时文件更改为 temp.htm

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T14:05:41.817

这与扩展无关 - 您的 temp.cfm 和 temp.htm 文件具有不同的内容。

具体来说，temp.cfm 文件在 doctype 之前有一个“存储会话变量”注释，使 IE 进入 Quirks 模式。（您的 temp.htm 文件没有此注释，并且未处于 Quirks 模式。）

您可以通过打开开发者工具（按 F12）看到正在发生的事情 - 您将在 HTML 视图中看到 doctype 声明已被注释掉，并且窗口右上角的文档模式是“Quirks”。

将模式更改为“Internet Explorer 9 标准”，页面显示与 temp.htm 相同。删除正在输出的评论也将具有不将 IE 置于怪癖模式的相同效果，（或将其更改为 CFML 评论，因为它的意图是，但它看起来没有必要，所以删除它可能是最好的）。

您可能还想考虑`<cfcontent reset type="text/html" />`在任何 doctype 声明之前立即放置，以帮助避免类似的问题（通过在输出开始之前重置输出缓冲区）。

# playframework-2.0 - 带有播放框架的网络应用程序

> ID：15043961
> 
> 赞同：0
> 
> 时间：2013-02-23T18:24:01.740
> 
> 标签：playframework-2.0

我下载了 play 2.0，将文件解压缩到位置 C:\play-2.0 并添加了类路径。它给出了以下错误：线程“main”java.lang.UnsupportedClassVersionError中的异常：.class文件中的版本号错误我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T09:56:04.480

看起来您的 Java 版本太旧，无法使用 Play 框架。您可以通过运行检查您的 java 版本

`java -version`

您至少需要 Java 1.6，可以从这里下载：

[http://www.oracle.com/technetwork/java/javase/downloads/jdk6downloads-1902814.html](http://www.oracle.com/technetwork/java/javase/downloads/jdk6downloads-1902814.html)

# android - 带有 LatLng 的 Google Maps 哈希图

> ID：15043962
> 
> 赞同：1
> 
> 时间：2013-02-23T18:24:03.220
> 
> 标签：android, google-maps, nullpointerexception, hashmap

我创建了一个名为 MapMarker 的简单类，如下所示：

```
public class MapMarker {
    private long id;
    private String resName;

    public MapMarker(){}

    public MapMarker(long id, String resName){
        this.id = id;
        this.resName = resName;
    }

    public long getId(){
        return id;
    }

    public String getResName(){
        return resName;
    }
} 
```

当我在谷歌地图中添加标记时，我还创建了一个 HashMap，以便在单击信息窗口时按顺序创建一个带有一些参数的活动。我正在使用的代码如下，用于添加标记和初始化哈希图

```
private HashMap<LatLng, MapMarker> mapMarkersData = new HashMap<LatLng, MapMarker>();

markerCoords = new LatLng(lat, lng);

mapMarkersData.put(markerCoords, new MapMarker(markerId, markerRes));

map.addMarker(new MarkerOptions().position(markerCoords).title(title).snippet("Click to see more info!")); 
```

当我尝试从哈希图中获取值时，我得到一个空指针异常。我正在使用的代码如下。

```
line 360:    markerId = mapMarkersData.get(marker.getPosition()).getId();
             markerResName = mapMarkersData.get(marker.getPosition()).getResName(); 
```

出了什么问题？

编辑：
logcat 如下：

```
02-23 20:37:55.780: E/AndroidRuntime(4853): FATAL EXCEPTION: main
02-23 20:37:55.780: E/AndroidRuntime(4853): java.lang.NullPointerException
02-23 20:37:55.780: E/AndroidRuntime(4853):     at   .MapActivity.onInfoWindowClick   (MapActivity.java:360)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at .GoogleMap$8.h(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at com.google.android.gms.internal.u$a.onTransact(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at android.os.Binder.transact(Binder.java:279)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at com.google.android.gms.maps.internal.IOnInfoWindowClickListener$Stub$Proxy.onInfoWindowClick(IOnInfoWindowClickListener.java:82)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.y.bw.a(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.a.y.f(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.a.y.a(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.a.bd.c(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.a.dq.onSingleTapConfirmed(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.e.v.onSingleTapConfirmed(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at maps.e.j.handleMessage(Unknown Source)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at android.os.Looper.loop(Looper.java:130)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at android.app.ActivityThread.main(ActivityThread.java:3691)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at java.lang.reflect.Method.invokeNative(Native Method)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at java.lang.reflect.Method.invoke(Method.java:507)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:912)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:670)
02-23 20:37:55.780: E/AndroidRuntime(4853):     at dalvik.system.NativeStart.main(Native Method) 
```

抱歉，最后一次编辑已完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T08:09:47.353

确保密钥存在于您的 HashMap 中。

我刚刚在我的代码中遇到了类似的问题，我发现我用于存储和查找的 lat/lng 值因小数位数而异，这导致查找失败。

LatLng 实现了 equals(Object o) 方法，因此您不必担心引用相等问题。

# nuget - 为什么 TortoiseHg 不添加 packages.config

> ID：15043965
> 
> 赞同：2
> 
> 时间：2013-02-23T18:24:14.080
> 
> 标签：nuget, tortoisehg, hgignore

我在我的 .NET 项目中使用 NuGet 进行包管理，并且一贯发生的一件事是 package.config 文件在提交时会被忽略，除非我明确添加它们。对于我的 .hgignore TortoiseHg 未特别过滤的任何其他文件，建议将其包含在提交对话框中。

我的 .hgignore 的内容是这样的：

```
# Ignore file for Visual Studio 2008

# use glob syntax
syntax: glob

# Ignore Visual Studio 2008 files
*.obj
*.exe
*.pdb
*.user
*.aps
*.pch
*.vspscc
*_i.c
*_p.c
*.ncb
*.suo
*.tlb
*.tlh
*.bak
*.cache
*.ilk
*.log
*.lib
*.sbr
*.scc
*.orig
[Bb]in
[Dd]ebug*/
obj/
[Rr]elease*/
build*/
_ReSharper*/
[Pp]ackages*/
[Tt]est[Rr]esult*
[Bb]uild[Ll]og.*
*.[Pp]ublish.xml
Thumbs.db
desktop.ini 
```

我看到这一切都不是悲剧，只是有点摩擦。关于为什么 package.config 被忽略的任何想法？

编辑：好的，我看到了可能负责的行：[Pp]ackages*/ 我想那么问题是我需要什么模式来过滤掉我的包目录，但让 packages.config 通过？我的正则表达式不太好，因此不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T14:02:47.033

从 glob 部分中删除`[Pp]ackages*/`并添加带有负前瞻的正则表达式部分，用于 package.config（TBT！）：

```
syntax: regex
^packages.*/(?!package\.config$) 
```

# opencv - 将链接器添加到命令行

> ID：15043967
> 
> 赞同：0
> 
> 时间：2013-02-23T18:24:16.153
> 
> 标签：opencv, linker

我正在尝试编译一个项目，您可以在此链接中找到生成文件[https://dl.dropbox.com/u/95042389/Makefile](https://dl.dropbox.com/u/95042389/Makefile)

我已经安装了 ANN 和 OpenCV 2.3.1。

当我输入 make 时，它​​返回下面给出的错误。

sai@sai-HP-EliteBook-8460w:~/workspace/4pcs$ make g++ -L/home/sai/workspace/OpenCV-2.4.1/lib -L/home/sai/workspace/ann_1.1.2/lib -L /usr/lib 4pcs.o 4pcs_test.o -o 4pcs -lopencv_highgui -lanN -o 4pcs /usr/bin/ld: 4pcs.o: 未定义对符号'cv::operator*(cv::Mat const&, cv: :Mat const&)' /usr/bin/ld: 注意：'cv::operator*(cv::Mat const&, cv::Mat const&)' 在 DSO /usr/lib/libopencv_core.so.2.3 中定义所以试试将其添加到链接器命令行 /usr/lib/libopencv_core.so.2.3：无法读取符号：无效操作 collect2：ld 返回 1 退出状态 make：*** [4pcs] 错误 1

然后我尝试了这个

sai@sai-HP-EliteBook-8460w:~/workspace/4pcs$ echo $LD_LIBRARY_PATH /usr/lib:/opt/ros/fuerte/lib:/opt/ros/fuerte/lib:/usr/lib/libopencv_core.2.3

还是一样的错误..

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:56:04.557

通过添加解决了

-lopencv_core 然后它没有错误地工作。

# ios - 哪些属性应该在视图控制器 m 中声明，哪些在模型 m 目标 c 中声明？

> ID：15043968
> 
> 赞同：3
> 
> 时间：2013-02-23T18:24:22.600
> 
> 标签：ios

对不起菜鸟问题。我的 iPhone 应用程序有一堆属性，前三个属性就像这样直截了当

**模型.m 文件**

```
@property (nonatomic,strong)NSMutableArray *celsiusStack;
@property (nonatomic,strong)NSMutableArray *fahrenheitStack; 
```

**视图控制器.m**

```
@property (nonatomic) BOOL userFinishedTyping; 
```

现在，如果属性不明确并且在模型和视图控制器中广泛使用，我该怎么办。我在哪里声明它以及什么是好的做法是否重要。

```
@property (nonatomic) BOOL celsius; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:35:00.780

这很大程度上取决于摄氏度的目的？

MVC 模式的基本概念之一是使完全替换 GUI 变得更容易，而无需修改底层模型。

我的猜测是，在你的模型中拥有 celcius 属性是很有意义的，但又一次。这取决于它的目的。

# django - 无法使用 django 管理视图将 django-toolbox ListField 保存到数据库

> ID：15043969
> 
> 赞同：0
> 
> 时间：2013-02-23T18:24:25.490
> 
> 标签：django, django-models, django-forms, django-admin, django-nonrel

我正在编写一个基于 django-nonrel 的应用程序并使用 Django 提供的管理视图功能。

我想要一个`Many-to-many relationship`介于两个模型之间的模型，为此，我使用的是`ListField`在里面`djangotoolbox.fields`

为了提供自定义表单字段，我已经用另一个类 ModelListField 覆盖了 ListField，如[本问题](https://stackoverflow.com/q/7782535/333137)中所述，它覆盖了 formfield 函数以返回 MultipleChoiceField 表单小部件。

*视图部分工作正常，但我无法使用 sqlite3 后端保存模型。*

假设，两个模型（注释和标签之间的标准多对多关系）

```
from django.db import models

class Tag(models.Model):
    name = models.CharField(max_length=255)

class Note(models.Model):
    tags = ModelListField(db.ForeignKey(Tag)) 
```

通过这些更改，添加注释页面在管理界面中正确显示，但是当我尝试保存注释时，出现以下异常：

```
InterfaceError, Error binding parameter 0 - probably unsupported type.  
inside django\db\backends\sqlite3\base.py in execute, line 234 
```

第 234 行内容如下：

```
class SQLiteCursorWrapper(Database.Cursor):
    """
    Django uses "format" style placeholders, but pysqlite2 uses "qmark" style.
    This fixes it -- but note that if you want to use a literal "%s" in a query,
    you'll need to use "%%s".
    """
    def execute(self, query, params=()):
        query = self.convert_query(query)
        try:
234 ---->           return Database.Cursor.execute(self, query, params)
        except Database.IntegrityError, e:
            raise utils.IntegrityError, utils.IntegrityError(*tuple(e)), sys.exc_info()[2]
        except Database.DatabaseError, e:
            raise utils.DatabaseError, utils.DatabaseError(*tuple(e)), sys.exc_info()[2] 
```

传递给调用的查询和参数是：

```
query: 'INSERT INTO "note" ("tags") VALUES (?)'  
params: [1, 2, 3]
where 1, 2, 3 are pk of three tag fields in database. 
```

创建模型时，我将标签的 COLUMN TYPE 指定为“ListField”，即创建表 SQL 查询为：

```
CREATE TABLE "notes" (
    "id" integer NOT NULL PRIMARY KEY,
    "tags" ListField NOT NULL
) 
```

数据库查询在看到列表 [1,2,3] 时在 barfs 上方执行调用。我尝试将列表作为`smart_unicode(list)`字符串传递，而不是列表，`"1 2 3"`但随后`ListField`在验证时抛出错误（在 get_db_prep_value 中），因为它需要列表。

*我无法理解将列表对象传递`Database.Cursor.execute`给上面调用是否正确，或者缺少某些内容，因为 ListField 正确地期望列表，但是在写入数据库时​​，应该有人将此列表转换为字符串等。？*

没有很好的例子来说明如何使用 ListField :-( 感谢您阅读冗长而无聊的描述..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T21:05:12.217

我发现 get_db_prep_save 有责任以正确的格式准备数据以保存到数据库。因此，在 ModelListField 中，我重写了 get_db_prep_save 并将其转换为字符串以修复“不支持的类型”错误。

```
def get_db_prep_save(self, value, connection):
    retval = super(ModelListField, self).get_db_prep_save(value)
    return unicode(retval) 
```

我还遇到了 Select Widget 未显示 pk > 10 的标签的问题。在 django-non 1.3 中，我不得不在下面的函数中添加 eval：

```
class Select(Widget):
    def render_options(self, choices, selected_choices):
        **if(type(selected_choices) != list):
            selected_choices = eval(selected_choices)** 
```

这样做是因为 render_option 是用 list 作为字符串调用的，即 "[1,2,3]" 而不是 [1,2,3]，所以使用 eval 将字符串转换回 list。不确定这两个是否相关或后一个问题是 django-nonrel 的错误。

正如dragonx所说，使用sqlite3和django-nonrel进行测试可能不是一个好主意。我很快就会改变我的后端。

# c++ - C++ 分配段错误

> ID：15043971
> 
> 赞同：3
> 
> 时间：2013-02-23T18:24:37.593
> 
> 标签：c++, arrays, allocation

我有这个代码：

```
size_t count = new_data.size();
std::cout << "got the count: " << count << std::endl;
double g_x[count];
std::cout << "First array done\n";
double g_y[count];
std::cout << "Allocated array of size" << count << std::endl; 
```

这给了我输出：

```
got the count: 1506538
Segmentation fault: 11 
```

老实说，我不明白为什么。它适用于另一个数据集，但不适用于这个数据集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:28:05.890

您可能只是在这里遇到堆栈溢出。尝试动态分配内存，即使用堆。

```
double* g_x = new double[count];
...
delete[] g_x; 
```

更好的解决方案是使用`std::vector<>`：

```
#include <vector>

...

std::vector<double> g_x(count); // Creates vector with the specified size. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:28:33.460

如果您想要一个动态大小的数组，您需要使用创建它`new`，或者使用其中一个 STL 容器。

看看[静态数组与 C++ 中的动态数组的一些答案](https://stackoverflow.com/questions/2672085/c-static-array-vs-dynamic-array)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T18:41:24.183

您的问题是，在 C 和 C++ 中，数组是在编译时定义的，所以您所做的事情是错误的，而且这段代码甚至可以编译很奇怪（编译器应该对您大喊大叫）

但是，如果您需要运行时定义的数组，您应该使用[std::vector](http://www.cplusplus.com/reference/vector/vector/)或手动分配内存（如果您没有非常特殊的需求，则不推荐）

PS你应该检查你的编译器警告级别和详细程度，因为这段代码有**严重的缺陷**，所以它甚至不应该编译（如果你的警告级别非常低，这对你也不利，因为你可能会养成一些不好的编码习惯，因为你正在使用不知情的编译器特定的语言扩展，这会让你在改变环境时发疯）

# php - 简单的 PHP 路由项目

> ID：15043974
> 
> 赞同：0
> 
> 时间：2013-02-23T18:24:54.483
> 
> 标签：php, url-routing

我需要创建一个简单的路由机制，它接受如下请求： /foo/bar 并将其转换为 FooController->barAction(); 我必须使用单个脚本作为访问点来加载这些控制器类和操作方法。我也不能使用任何外部框架或库来完成这项任务。这需要能够在带有 Apache 的 PHP 5.3 服务器上运行。

以下是我已经写过的内容，但我无法让它工作：

```
class Router {

    private static $routes = array();

    private function __construct() {}
    private function __clone() {}

    public static function route($pattern, $callback) {
        $pattern = '/' . str_replace('/', '\/', $pattern) . '/';
        self::$routes[$pattern] = $callback;
    }

    public static function execute() {
        $url = $_SERVER['REQUEST_URI'];
        $base = str_replace('\\', '/', dirname($_SERVER['SCRIPT_NAME']));
        if (strpos($url, $base) === 0) {
            $url = substr($url, strlen($base));
        }
        foreach (self::$routes as $pattern => $callback) {
            if (preg_match($pattern, $url, $params)) {
                array_shift($params);
                return call_user_func_array($callback, array_values($params));
            }
        }
    }
} 
```

我正在尝试至少执行基于另一个简单路由器的当前脚本，但我实际上无法使用

```
Router::route('blog/(\w+)/(\d+)', function($category, $id){
  print $category . ':' . $id;
});
Router::execute(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:33:16.230

而不是试图打破路径。为什么不使用 .htaccess 代替。

因此，您可以拥有如下所示的内部 URL：

```
index.php?module=MODULE&action=INDEX 
```

然后使用 .htaccess 提供 URL 中的路径并相应地路由它们。

```
www.mydomain.com/MODULE/INDEX 
```

这篇文章可以帮助重写[正则表达式以在 htaccess 中创建 pritty url](https://stackoverflow.com/questions/10007422/regex-for-creating-pritty-urls-in-htaccess)

可能有一个更好的，只是一个快速的谷歌搜索。

这样您就可以像这样访问：

```
$module = $_GET['module'];
$action = $_GET['action]; 
```

然后您可以检查路由器中的相应操作以检查它是否存在，然后相应地重新路由。

# css - OOCSS 容器和内容分离？

> ID：15043976
> 
> 赞同：4
> 
> 时间：2013-02-23T18:24:59.250
> 
> 标签：css, oocss

**问题**：第二个OOCSS原则真的有效吗？

根据 OOCSS 第二个原则，你不应该有依赖于位置的样式：

引用自[https://github.com/stubbornella/oocss/wiki](https://github.com/stubbornella/oocss/wiki)

> 本质上，这意味着“很少使用与位置相关的样式”。一个物体无论放在哪里都应该是一样的。因此，不要使用 .myObject h2 {...} 设置特定 h2 的样式，而是创建并应用一个描述相关 h2 的类，例如 h2 class="category"。

让我们举一个实际的例子。假设我有一个标准的 2.0 设置，具有正常的主体（白色背景）和巨大的页脚（黑色背景）。在正文中，我们有黑色链接，在页脚中当然需要白色。实现这一目标的最简单和最直观的方法不是：

```
a{ color: #000; }
.footer a{ color: #FFF; } 
```

如果我在哪里遵循 OOCSS 原则，我必须首先创建一个类：

```
.inverted{ color: #FFF; } 
```

然后继续将该类添加到我想要反转的每个链接。这似乎很麻烦。

整个语言的目的不是为*Cascade*制作样式吗？我在这里误解了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T19:01:58.680

我认为你是对的，是的，在你的具体例子中......也许按照你的方式做会更容易。但是话又说回来，如果您查看[OOCSS 页面中的第一句话：](https://github.com/stubbornella/oocss/wiki)

*你如何为数千个页面扩展 CSS？*

在这种情况下..第二个原则非常有意义..所以使用相同的示例（即假设我们实施了您的解决方案）..假设一年后您的公司决定在黑色页脚中创建浅灰色按钮黑色文字：

```
<!-- inside footer -->
<a class="button lightGrey">link</a> 
```

在这种情况下..所有`a`标签都将是白色的，因为它们被您的*级联*覆盖。因此，我们将不得不创建另一个样式来撤消您的解决方案所做的事情：

```
.footer a.button.lightGrey {
   color: #000;  /* huh? but i thought we did this before with a {color: #000;} ?*/
} 
```

好像我们只是决定`a`默认情况下所有标签都是黑色的（见*最后一个注释*）：

```
a{ color: #000; } 
```

然后在页脚中，我们将创建一个应该是白色的特殊类型的链接：

```
.footerLinks { color: #FFF } 
```

然后一年后，一些链接仍然是白色的.. grayLight 按钮内的其他链接将是黑色的：

```
<a class="button lightGrey">link</a> 
```

那么在这里我们不必担心撤消任何事情..`a`标签有一个默认颜色..就是这样。如果 2 年后有人决定 lightGrey 按钮内的链接（网站上的任何地方，不仅是页脚......这是 OOCSS 的重点）应该是红色的......那么这将是 OOCSS 方法：

```
.redLink {
 color: red;
} 
```

并且 html 将是

```
<a class="button lightGrey redLink">link</a> 
```

在这种情况下，我们是否取出 .lightGrey 类都没有关系，或者我们可以在页脚内或不在页脚内有此代码.. 都是一样的.. 它导致更可预测和可重用的代码..是 OOCSS（我很高兴他们终于将其正式化了。非常感谢您的帖子）。

**最后一点：**要成为纯 OOCSS，不应该更改`a`ie的默认颜色`a {color: #000;}`是**错误的！**，它应该保留它的默认颜色（蓝色）..每当有人想要更改该颜色..然后他们必须指定它，即

```
<a class="redLink">..</a> 
```

所以在这种情况下，它更像是默认值`a`是父类.. 其他一切都是它的子类并覆盖它的默认行为..

**更新 - 对评论的回应：**

*信誉良好的网站论点：*

此类举措几乎总是由社区推动，然后由知名公司采用。即使它们被大公司采用，它通常也是自下而上通过倡导这种变革的热心开发人员进行的。我就是这样的倡导者，当我在亚马逊工作。即使它被采用......它通常是小规模的，而不是组织中的所有单位。对于谷歌、亚马逊和 Facebook 等来说，执行这样的规则甚至不是一个好主意，b/c 总会有不同的意见。更不用说这种微观管理会限制工程师的创造力。 wiki 中可能有一个团队指南（即我们有一个用于 Amazon Kindle Touch 应用程序商店），但要在整个公司工作的 10,000 名工程师中强制执行该规则'

所以简而言之，如果你看到了 OOCSS 的价值，并开始在你的网站上实施，并向你的网络开发人员宣传它，然后它就成为一种趋势，那就是它最终成为全行业最佳实践的时候，你可以期待在 facebook 等上看到它。

*例子：*

看看这个：
简单： http: [//jsfiddle.net/64sBg/](http://jsfiddle.net/64sBg/)
更详细一点：http: [//jsfiddle.net/64sBg/2/](http://jsfiddle.net/64sBg/2/)

无需过多详细说明（我相信您会看到该模式），您可以看到 css 描述中的粒度允许进行细微的更改，而不会在样式定义中产生任何冗余。所以请注意左箭头与右箭头.. .red 和 .blue 样式随后可以应用于表格等。

还请注意，我的 css 中没有一个级联。所以我的样式可以完全独立应用（即实现规则*一个对象无论放在哪里都应该看起来相同*）

最后..还有**级联**的用途..你绝对可以在你的jQuery选择器中使用它..默认情况下也会发生级联（即，你不必在你的css样式中显式设置它）..所以如果你看看在下面的 css 中.. 你会注意到 body 的字体属性已经级联到所有按钮。

```
<a class="button blue dark">
    <div class=" arrowDownWhite rightArrow">Analytics</div>
</a>

<a class="button red dark">
    <div class=" arrowDownWhite leftArrow">Actions</div>
</a>

<a class="button grey light">
    <div class=" arrowDownRed leftArrow">options</div>
</a> 
```

和CSS：

```
body 
{
    font-family: Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;
    font-size: 15pt;
}

.button 
{
    padding: .5em 1em;
    display: inline-block;
    text-decoration: none;
}
.dark {
    color: white;
}

.light{
    color: #E40E62;
}
.blue
{
    background-color: #51C8E8;
}
.red 
{
    background-color: #E40E62;
}
.grey 
{
    background-color: #E0E0E0 ;
}
.arrowDownWhite
{
    background-image:url(http://s2.postimage.org/ywam7ec4l/small_Arrow_Down_White.png); 
    background-repeat:no-repeat;

}

.arrowDownRed 
{
    background-image:url(http://s2.postimage.org/je5743t2d/small_Arrow_Down_Red.png);
    background-repeat:no-repeat;
}

.leftArrow 
{
    padding-left: 1em;
    background-position: left center;   
}

.rightArrow
{
    padding-right: 1em;
    background-position: right center;  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T15:29:19.387

将皮肤与容器分开是值得的。

让我们超越颜色。我希望妮可沙利文提供比她更好的例子。我有 23 个网站，其中包含

*   菜单
*   标签
*   工具栏
*   链接的水平和垂直列表

# 它们都是 Nav 抽象的皮肤

我开始创建一个抽象类来处理它们之间的公共代码。我添加了一些修改器来将方向从水平更改为垂直，以及它的浮动位置。我将所有颜色排除在抽象之外，也保留了可以根据我应用到它的皮肤而改变的 css 规则。

```
/* Object */

.nav
{
    margin-bottom: 1.5em; margin-left: 0; padding-left: 0; list-style: none;
}
    /* Modifier */

    .nav--stack .nav__item
    {
        display: block;
    }

    .nav--right
    {
        float: right;
    }

    /* Elements */

    .nav__item
    {
        float:left
    }

        .nav__item__link
        {
            display:none;
         } 
```

# 菜单皮肤

我需要一个让 .nav 抽象看起来像侧边栏菜单的皮肤。如果您想知道，我没有将 .nav_ *item* _link 的填充放在上面是因为它可以根据皮肤进行更改。标签皮肤设置为 2px。

```
/* Object */

.menu
{

}

/* Elements */

    .menu .nav__item--current.nav__item__link
    {
        color: #fff; background: blue;
    }

    .menu .nav__item__link
    {
        padding: 4px; border-radius: 4px;
    }

    .menu .nav__item__link:hover
    {
        background: #eee
    } 
```

注意保持位置独立 - 我有 0 个标签名称。我不像 bootstrap 那样在 .nav 上设置 li 和一个孩子的样式。此代码可用于 dls 甚至 div，并且基于选择器引擎读取规则的方式具有更好的性能。

对我来说，只需对我拥有的所有 23 个站点的对象进行剥皮的好处是值得任何麻烦的。

# javascript - 将 Json 存储在 localStorage 中

> ID：15043978
> 
> 赞同：4
> 
> 时间：2013-02-23T18:25:07.423
> 
> 标签：javascript, jquery, json, local-storage, getjson

我想将搜索结果作为缓存存储在 localStorage 中。

我想将所有缓存存储为一个 localStorage 值：

```
localStorage.getItem('search-cache') 
```

在它里面我想有 JSON 对象，我可以添加属性并检索它们。不幸的是，它不起作用，并且 localStorage 没有用 json 结果更新（它的值一直是`'{}'`）。

我不是 javascript proffesional 所以请指导我如何做好。

这是缓存结果的当前代码：

```
 var query = $(this).val();

    var cache = JSON.parse(localStorage.getItem('search-cache'));

    if (cache == null) {
        cache = '[{}]';
    }

    if (cache[query] == null) {

        $.getJSON('/api/guides/search?query=' + query, function (data) {
            $.each(data, function (index, guide) {
                $('#results').append('<li class="result-item">' + guide.Name + '</li>');
            });

            cache[query] = data;
            localStorage.setItem('search-cache', JSON.stringify(cache));
        });
    }
    else {
        $.each(JSON.parse(localStorage.getItem('search-cache')[query]), function (index, guide) {
            $('#results').append('<li class="result-item">' + guide.Name + '</li>');
        });

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:57:12.170

你的逻辑有些漏洞。

```
var cache = JSON.parse(localStorage.getItem("..."));
if (cache == null) { cache = "[{}]"; } 
```

好吧，如果项目 DID 存在，则您已将缓存设置为等于该对象。
否则，您已将 cache 设置为等于 string `"[{}]"`。

与其考虑如何构建本地存储，不如考虑如何构建结果列表。

```
var cache_json = localStorage.getItem("search-cache"),
    search_cache = JSON.parse(cache_json) || {};

var query = $("...").value(); // or whatever

search_cache[query] = search_cache[query] || { results : [] };

var list = $(......)
list.each(function () {
    search_cache[query].results.push( /* whatever you want in your array */ );
});

cache_json = JSON.stringify(search_cache);
localStorage.setItem("search-cache", query_json); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:48:28.433

因为，如果您的项目`search-cache`未定义，则缓存变量的初始化不正确。

你应该像这样初始化你的数组：

```
if (cache == null) {
    cache = []; 
    cache[query] = null;
} 
```

测试时满足条件

```
if (cache[query] == null) 
```

但是，您需要像这样测试它：

```
if(typeof cache[query] == 'undefined') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T19:04:50.697

cache 是一个对象而不是数组，像 cache = {} 一样初始化其余代码似乎是正确的。

# php - 如何在 PHP 中访问 JSON 解码数组

> ID：15043981
> 
> 赞同：24
> 
> 时间：2013-02-23T18:25:16.437
> 
> 标签：php, json

我从to返回了一个`JSON`数据类型的数组，我曾经将它转换为关联数组，但是当我尝试使用 associative 使用它时，我收到错误返回的数据看起来像这样`javascript``PHP``json_decode($data, true)``index``"Undefined index"`

```
array(14) { [0]=> array(4) { ["id"]=> string(3) "597" ["c_name"]=> string(4) "John" ["next_of_kin"]=> string(10) "5874594793" ["seat_no"]=> string(1) "4" } 
[1]=> array(4) { ["id"]=> string(3) "599" ["c_name"]=> string(6) "George" ["next_of_kin"]=> string(7) "6544539" ["seat_no"]=> string(1) "2" } 
[2]=> array(4) { ["id"]=> string(3) "601" ["c_name"]=> string(5) "Emeka" ["next_of_kin"]=> string(10) "5457394839" ["seat_no"]=> string(1) "9" } 
[3]=> array(4) { ["id"]=> string(3) "603" ["c_name"]=> string(8) "Chijioke" ["next_of_kin"]=> string(9) "653487309" ["seat_no"]=> string(1) "1" } 
```

请问，我如何访问这样的数组`PHP`？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-02-23T18:28:52.100

当您`true`作为第二个参数传递给`json_decode`时，在上面的示例中，您可以通过以下方式检索数据：

```
$myArray = json_decode($data, true);
echo $myArray[0]['id']; // Fetches the first ID
echo $myArray[0]['c_name']; // Fetches the first c_name
// ...
echo $myArray[2]['id']; // Fetches the third ID
// etc.. 
```

如果您不`true`作为第二个参数传递给`json_decode`它，则会将其作为对象返回：

```
echo $myArray[0]->id; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-23T18:28:51.313

```
$data = json_decode($json, true);
echo $data[0]["c_name"]; // "John"

$data = json_decode($json);
echo $data[0]->c_name;      // "John" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-23T18:28:34.813

```
$data = json_decode(...);
$firstId = $data[0]["id"];
$secondSeatNo = $data[1]["seat_no"]; 
```

像这样 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-01T05:25:42.790

这可能会帮助你！

```
$latlng='{"lat":29.5345741,"lng":75.0342196}';
$latlng=json_decode($latlng,TRUE); // array
echo "Lat=".$latlng['lat'];
echo '<br/>';
echo "Lng=".$latlng['lng'];
echo '<br/>';

$latlng2='{"lat":29.5345741,"lng":75.0342196}';
$latlng2=json_decode($latlng2); // object
echo "Lat=".$latlng2->lat;
echo '<br/>';
echo "Lng=".$latlng2->lng;
echo '<br/>'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-09T13:10:11.843

当您将 true 作为第二个参数传递给`json_decode`时，在上面的示例中，您可以通过以下方式检索数据：

```
<?php
$json = '{"a":1,"b":2,"c":3,"d":4,"e":5}';

var_dump(json_decode($json));
var_dump(json_decode($json, true));

?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-26T11:49:45.537

当你想循环进入一个多维数组时，你可以像这样使用 foreach：

```
foreach($data as $users){
   foreach($users as $user){
      echo $user['id'].' '.$user['c_name'].' '.$user['seat_no'].'<br/>';
   }
} 
```

# asp.net - foreach 语句不能对“Diary_Entry”类型的变量进行操作

> ID：15043983
> 
> 赞同：0
> 
> 时间：2013-02-23T18:25:19.630
> 
> 标签：asp.net, datetime

通过 foreach 循环传入日​​期列表“DiaryEntry”。它记录的每个日期都将在日历上突出显示....

```
foreach (DateTime d in DiaryEntry)
            {
                Calendar1.SelectedDates.Add(d);//CALENDAR1 being the ID of the calendar on the aspx page
            } 
```

错误：foreach 语句无法对“Diary_Entry”类型的变量进行操作，因为“Diary_Entry”不包含“GetEnumerator”的公共定义

任何人都知道我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:37:15.953

是`Diary_Entry`某种列表吗？它是基于集合类，实现的东西`System.Collections.IEnumerable`还是`System.Collections.Generic.IEnumerable`？如果没有，如果它只有几个表示日期的属性，则不能`foreach`与它一起使用。您必须分别处理每个属性。

```
Calendar1.SelectedDates.Add(Diary_Entry.Date1);
Calendar1.SelectedDates.Add(Diary_Entry.Date2);
// etc. 
```

如果它有两个日期，分别代表开始日期和结束日期，并且您想遍历该范围，您将无法使用`foreach`它，但您仍然可以使用`for`：

```
for(DateTime d = Diary_Entry.StartDate;d<=Diary_Entry.EndDate;d=d.AddDays(1))
{
   Calendar1.SelectedDates.Add(d);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:31:07.413

您的 DiaryEntry 对象需要实现[IEnumerable](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)或[IEnumerable<T>](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)。

来自[msdn](http://msdn.microsoft.com/en-us/library/ttw7t8t6%28v=vs.110%29.aspx)：

> foreach 语句为实现 System.Collections.IEnumerable 或 System.Collections.Generic.IEnumerable<T> 接口的数组或对象集合中的每个元素重复一组嵌入语句。

我怀疑您的意思是拥有这些对象的数组或其他一些集合。在这种情况下，您可以使用 foreach 遍历集合。另一种可能性是 DiaryEntry 有一个集合属性，你的意思是迭代它......可能像下面这样？

```
foreach(DateTime date in DiaryEntry.Dates) 
{
    ...
} 
```

# jquery - 如何限制在 JS-Plumb 的同一 div 中建立连接？

> ID：15043993
> 
> 赞同：2
> 
> 时间：2013-02-23T18:25:54.550
> 
> 标签：jquery, jsplumb

这是我**[在 JS Fiddle 中的演示](http://jsfiddle.net/wzxEz/2/)**

**HTML**

```
<div id="a" class="a window" style="width: 100px; height: 100px; border: solid 1px">
</div> 
```

**jQuery**

```
 var a = $("#a");
    var b = $("#b");

    //Setting up drop options
    var targetDropOptions = {
        activeClass: 'dragActive'
    };

    //Setting up a Target endPoint
    var targetColor = "#316b31";
    var targetEndpoint = {
        anchor: "TopCenter",
        endpoint: ["Dot", { radius: 8}], 
        paintStyle: { fillStyle: targetColor },
        isSource: true,
        scope: "green dot",
        connectorStyle: { strokeStyle: targetColor, lineWidth: 8 },
        connector: ["Flowchart", { curviness: 63}],
        maxConnections: -1,
        isTarget: true,
        dropOptions: targetDropOptions 
    };

    //Setting up a Source endPoint
    var sourceColor = "#ff9696";
    var sourceEndpoint = {
        anchor: "BottomCenter",
        endpoint: ["Dot", { radius: 8}],
        paintStyle: { fillStyle: sourceColor },
        isSource: true,
        scope: "green dot",
        connectorStyle: { strokeStyle: sourceColor, lineWidth: 8 },
        connector: ["Bezier", { curviness: 63}],
        maxConnections: -1,
        isTarget: true,
        dropOptions: targetDropOptions
    };

    jsPlumb.bind("ready", function () {

        //Set up endpoints on the divs
        jsPlumb.addEndpoint($(".window"), targetEndpoint);
        jsPlumb.addEndpoint($(".window"), sourceEndpoint);

        jsPlumb.draggable($(".window"));
        jsPlumb.animate($("#a"), { "left": 50, "top": 100 }, { duration: "slow" });
    }); 
```

**查询 - 如何限制在 JS-Plumb 的同一 div 中建立连接？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-07T05:03:14.487

我想在性能方面这是一个更好的方法。您可以在实际创建连接之前决定。

```
jsPlumb.bind("beforeDrop", function(connection) {
    return connection.sourceId !== connection.targetId;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T10:36:27.323

```
jsPlumb.bind("jsPlumbConnection", function (CurrentConnection) {
        if (CurrentConnection.connection.targetId ==
                                           CurrentConnection.connection.sourceId)
            jsPlumb.detach(CurrentConnection.connection);
        else
            init(CurrentConnection.connection);
    }); 
```

# php - 使用 PHP 或 JavaScript 获取包含片段的 URL

> ID：15043995
> 
> 赞同：-3
> 
> 时间：2013-02-23T18:25:58.170
> 
> 标签：php, javascript, jquery, url

我的网站 URL 如下所示：

```
http://localhost/naveendalmeida/news.php#news_6 
```

如何使用 PHP 或 JavaScript 获取包含 #news_6 的 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:30:07.853

`window.location.href`应该返回你需要的（javascript）。

在 php 中获取它似乎更冗长：-

[http://www.phpf1.com/tutorial/get-current-page-url.html](http://www.phpf1.com/tutorial/get-current-page-url.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:32:15.040

使用 JavaScript

```
if(window.location.hash) {
  alert(window.location.hash);
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-02-23T18:38:29.453

对于 php，parse_url 函数用于解析 url

用于通过 parse_url 函数检索 url 的片段部分

例如

$url_info=parse_url($url);

回声 $url_info['fragment'];

# asp.net - 我们应该使用什么序列化格式将序列化的对象存储在 SQL Server 数据库中

> ID：15043999
> 
> 赞同：5
> 
> 时间：2013-02-23T18:26:16.140
> 
> 标签：asp.net, sql-server, caching, serialization

我们正在开发一种定制的缓存解决方案，该解决方案将使用 SQL Server 数据库来存储缓存对象。应用程序的托管环境不提供“内存中”缓存，例如 memcached 或应用程序结构，因此我们必须使用 SQL Server 数据库。

虽然大多数缓存对象都是简单类型（int、string、dates 等），但我们还需要存储更复杂的类型，例如`DataSet`s、`DataTable`s、泛型集合和自定义类。

我对 .NET 的本机序列化和反序列化经验很少，但我认为我们必须将对象序列化为某种形式（二进制、xml、JSON 等）以将其存储在数据库中，然后在我们将其拉出时对其进行反序列化的数据库。我想对“某种形式”应该是什么有一些专家意见。

我们正在使用 JSON.NET 将数据序列化为 JSON 以用于各种 AJAX 请求。我最初的想法是将缓存的数据序列化为 JSON 以将其存储在数据库中。但是，我想就性能和数据完整性最好的方法获得一些意见。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T18:53:44.410

您提到的所有三个序列化选项（二进制、json 或 XML）都是序列化格式的有效选择。还有[许多其他序列化格式](http://en.wikipedia.org/wiki/Comparison_of_data_serialization_formats)，但您提到的三种是最常见的。至于在三者之间进行选择，以下是一些考虑因素：

1.  如果您将数据以二进制格式存储在数据库中，那么如果您想通过使用 Sql Server Management Studio 或通过文本编辑器查看它，则人类无法阅读。如果您想手动细读数据，则必须编写某种反序列化工具。

2.  二进制格式可能会导致序列化对象的大小最小，其次是 json，而 XML 最大。就实际大小差异而言，这将因您的数据结构而异。

3.  就性能而言，二进制序列化可能比 json 或 XML 更快。但是，您必须使用您的数据对此进行基准测试，以查看差异是什么。

4.  我认为所有三种格式类型都有出色的 .net 库和 BCL 支持，因此任何选择都应该是可行的。

因此，您的选择将取决于哪些因素对您最重要：CPU 利用率、磁盘存储空间、人类可读性和/或个人偏好。

我们已经广泛使用 json 来序列化我们的对象以存储在数据库中，使用[JSON.Net](http://james.newtonking.com/pages/json-net.aspx)，我们非常喜欢它。有时通过 SSMS 手动查看数据很方便，对于我们的数据，json 比 XML 更紧凑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T18:57:59.890

我不会重复乔的回答，因为他已经死了。我想补充一点，如果升级类，二进制序列化确实会增加复杂性。它是可管理的，但需要一些工作，并且需要您深入研究二进制序列化程序。与基于文本的方法一样，您可以使用其他选项迁移数据（例如，您可以在 XML 上运行 XSLT）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T19:54:20.493

缓存必须小而快，而且我喜欢更具体地说明使用什么。

我建议[protobuf-net](https://code.google.com/p/protobuf-net/)和SO使用的一样，我用它，速度和大小真的很好。至少在我的测试中是更小更快。

我们出于同样的原因使用它（用于缓存），在我们尝试了其他序列化库之后，结果更快更小。现在在缓存模式中，您实际上不需要用眼睛看到里面有什么，因为这不是您可能需要更改某些内容的设置，因为您尚未修复该功能。

如果您想查看缓存对象上的内容，您可以创建一个简单的函数来打印它。