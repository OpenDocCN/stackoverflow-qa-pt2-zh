# StackOverflow 问答 15119000-15119999

# php - 向 php 脚本报告 AJAX 错误

> ID：15119001
> 
> 赞同：1
> 
> 时间：2013-02-27T17:58:11.167
> 
> 标签：php, jquery, ajax, error-reporting

我在我的应用程序中使用了几个 jQuery AJAX 调用，有时在这些 AJAX 调用期间会遇到错误，例如 500 内部服务器错误。为了找出错误的根源，我登录服务器并检查错误日志，它为我提供了 PHP 错误。

我正在寻找一种在发生这些错误时获取通知的方法以及导致错误的 PHP 错误。至少是一种获得通知的方法，而不必接收用户的电子邮件，然后进入并检查日志。

我查看了本教程，但不确定如何将其集成到 AJAX 错误中：http: [//net.tutsplus.com/tutorials/php/quick-tip-email-error-logs-to-yourself-with-php/](http://net.tutsplus.com/tutorials/php/quick-tip-email-error-logs-to-yourself-with-php/)而且我不确定这是否会返回 PHP 错误或仅返回 500 内部服务器错误。

非常感谢任何想法、现有服务或解决方案！这是我的 AJAX 调用之一，例如：

```
$.ajax ({
        url: report,
        cache: false,
        success: function(html) {
            // continue with event
        },
        error: function(x, status, error) {
            // report error here
        },
        async:true
}); 
```

**编辑：**

这是更新的 AJAX 调用，它向 php 错误通知发出 AJAX 请求...

```
$.ajax ({
        url: report,
        success: function(html) {
            // success
        },
        error: function(x, status, error) {
            $.ajax ({
                url: 'admin/error_notification.php',
                type: "POST",
                data:{
                    error: error
                }
            });
        },
        async:true
}); 
```

这很好用，但是，只报告发生了内部服务器错误，而不是导致 AJAX 错误的实际 PHP 错误。这是 PHP 错误处理文件：

```
$error = $_POST['error'];
$sysadmin_message = $error;
$sysadmin_to = 'email@example.com';
$sysadmin_subject = 'Error Notification';
$sysadmin_headers = "From: Site <accounts@example.com>\r\n";
$sysadmin_headers .= "MIME-Version: 1.0\r\n";
$sysadmin_headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
mail($sysadmin_to, $sysadmin_subject, $sysadmin_message, $sysadmin_headers); 
```

显然这只会发送报告的 AJAX 错误，但是如何将实际的 PHP 错误添加到通知中呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:59:38.280

您需要在错误函数中进行第二次 ajax 调用以报告给 php

从前端：

```
$.ajax ({
        url: report,
        cache: false,
        success: function(html) {
            // continue with event
        },
        error: function(x, status, error) {
            // report error here
            $.ajax ({
                url: errorlogUrl,
                data:{
                    message:'ajax error from [report]'
                }
            });
        },
        async:true
}); 
```

或者在后端使用 try/catch 语句：

```
try{
    // code that might throw an error
}
catch(Exception $e){
    // send notification based on the content of $e
} 
```

# cakephp - Acl 管理面板的最佳实践？

> ID：15119004
> 
> 赞同：0
> 
> 时间：2013-02-27T17:58:12.740
> 
> 标签：cakephp, cakephp-2.3

我只是在 Cakephp 工作了几天，我印象非常深刻。但现在我正试图与 Acl 更接近，但这有点令人困惑。

我的情况是，我想创建一个有前端和后端的网站。但我不确定我是否真的需要 Acl，因为所有用户都应该可以使用所有页面，当然后端除外。Cookbook 中的教程并不是很有帮助，因为它都是关于创建用户、组和角色以及创建正确的登录视图、添加和编辑用户等。

但我只需要有关 Acl 处理什么的信息？它是否限制控制器或模型的使用？

还是我需要 Acl 以外的其他东西？如果检查为假，检查会话变量并直接重定向到控制器可能更容易？

希望你能带我走正确的路，

提前感谢来自德国的问候，

萨沙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:02:45.083

我建议你阅读本章并使用 Auth 组件，而不是像你被取笑那样简单地访问会话。

[http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html)

对于您的管理后端，请使用前缀路由。

[http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing](http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing)

与 auth 一起，这很容易在 isAuthorized() 回调中检查和实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T22:23:29.970

如果您不需要各种“级别”的权限；即允许任何登录用户访问后端，最好跳过ACL（暂时）。如果在稍后阶段需要 ACL，您可以随时添加它。

您可以从“简单”身份验证开始。食谱中的这一章描述了如何做到这一点； [http://book.cakephp.org/2.0/en/tutorials-and-examples/blog-auth-example/auth.html](http://book.cakephp.org/2.0/en/tutorials-and-examples/blog-auth-example/auth.html)

*一般来说，不要开发你现在*不需要的功能。*例如，因为您将来可能*需要它而实施 ACL只会使您的开发过于复杂，而且很有可能，当那个时刻到来时，它们不符合要求。

与@burzum 不同，我不是前缀路由的忠实拥护者（仅适用于非常简单的项目），因为您最终会在同一个控制器中混合前端和后端操作和逻辑。

我建议为后端创建单独的控制器，可能将它们开发为插件。无论哪种方式，您都可以考虑为后端创建“基本”控制器和模型，并让您的后端控制器/模型扩展它们。这样，您将能够在 1 个位置定义用于后端的组件/行为。此外，通过仅在后端控制器中加载“Auth”组件，您不必在前端的每个控制器中“允许”操作

例如;

```
class BackendCoreController extends AppController {
    // only load the Auth component in backend controllers
    // regular/frontend controllers don't require authentication
    $components = array('Auth');

}

class PageAdminController extends BackendCoreController {

} 
```

有关将后端开发为插件的注意事项，请在此处查看我的答案：

[在 CakePHP 中实现管理面板的最佳方式](https://stackoverflow.com/questions/14962058/best-way-to-implement-admin-panel-in-cakephp/14965806#14965806)

# api - 找不到 com.google.android.gsf.gservices 的提供商信息

> ID：15119008
> 
> 赞同：2
> 
> 时间：2013-02-27T17:58:44.007
> 
> 标签：api, maps

我不知道为什么 Wen 运行我正在开发的 android 应用程序，当我想显示地图时，我得到一个只有缩放按钮的活动空白，并且日志是：

```
 Failed to find provider info for com.google.android.gsf.gservices 
```

这是显示地图的活动

```
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
 android:id="@+id/map"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 class="com.google.android.gms.maps.SupportMapFragment"/> 
```

这是文件清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="md.clt.android"
android:versionCode="1"
android:versionName="1.0" >

<permission
    android:name="md.client.android.permission.MAPS_RECEIVE"
    android:protectionLevel="signature" />

<uses-permission android:name="md.client.android.permission.MAPS_RECEIVE" />

<uses-sdk
    android:minSdkVersion="9"
    android:targetSdkVersion="16" />

<uses-permission android:name="android.permission.INTERNET" />
<!--  Allows the API to access Google web-based services -->
<uses-permission      android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<!-- Allows the API to cache map tile data in the device's external storage area -->
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" />

<!-- Google Maps Android API requires OpenGL ES version 2 -->
<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="My_apy_key" />

    <activity
        android:name="md.clt.android.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="md.clt.android.PoiMap"
        android:label="@string/title_activity_poi_map" >
    </activity>

    <activity
        android:name="md.clt.android.PoiListActivity"
        android:label="@string/title_activity_poi_list" >
    </activity>
</application>

</manifest> 
```

这是什么意思？

# excel - Excel 数据连接更新表格范围外的单元格引用

> ID：15119010
> 
> 赞同：0
> 
> 时间：2013-02-27T17:58:50.307
> 
> 标签：excel, data-binding

假设我已经在 Excel 中建立了一个数据连接来更新`A-G`工作表上的列并对列 A 进行排序。如果我在列`H`单元格中放置一个公式，例如`=SUM(B2:D2)`，然后刷新数据连接，列`H`单元格引用可能会变得混乱。例如，`H2`公式现在`=SUM(B7:D7)`代替`=SUM(B2:D2)`. 我猜原因可能是`A-G`由于我在 A 列上的排序，数据在列中移动。但是，将列`H`公式更改为使用绝对行引用`=SUM(B$2:D$2)`- 仍然会导致引用变得混乱。就好像 Excel 正在移动电子表格的整行，而不仅仅是更新范围内的行。所以我的问题是：

1）有没有其他人看到过这种行为？

2）如果你看到了这种行为，你知道如何关闭它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:20:15.030

您只需要扩展表格以覆盖 H 列！当您刷新数据时，Excel 会区分查询中的列和其他列 - 并保留后者。同时，所有列都扩展到查询返回的任何行数......

# ms-access - MS Access 2010 ListBox 项目不可选择

> ID：15119012
> 
> 赞同：3
> 
> 时间：2013-02-27T17:59:12.430
> 
> 标签：ms-access, vba, ms-access-2010

我正在使用存储过程的结果填充 MS Access 2010 表单上的列表框。我用来填充列表框的代码如下：

```
Dim qdf As QueryDef
Set qdf = CurrentDb.QueryDefs("PassThroughQuery")
qdf.SQL = "EXEC Search '" & searchValue & "'"
Set rs = qdf.OpenRecordset

While Not rs.EOF
    Me.searchResultsBox.AddItem rs("name")
    rs.MoveNext
Wend 
```

查询运行良好，ListBox 填充了指定的值，但列表框中的项目不可选择。我无法单击并突出显示任何项目。

我检查了 Enabled 和 Locked 属性，它们分别设置为 True 和 False。“行源类型”设置为“值列表”。我不知道为什么列表框值的行为如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T15:30:22.177

我遇到了同样的问题：显然列表框项目只有在允许编辑时才可选。也许表单`Allow Edits`属性设置为 false。也可能是传递查询或存储过程的结果不可编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-19T14:06:21.763

即使您希望所有内容都只读，也不要忘记允许在表单级别进行编辑。对我来说，只有当我将两者都设置为允许编辑时，才能选择列表框。

# facebook - 如何申请在我的 iPhone 应用程序中使用 API？

> ID：15119013
> 
> 赞同：0
> 
> 时间：2013-02-27T17:59:12.510
> 
> 标签：facebook, api

我已完成所有编码，但需要 Facebook 的令牌（或证书）才能启动我的应用程序。我从哪里得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:01:11.503

Facebook 的开发者[网站](https://developers.facebook.com/)绝对是开始的地方

他们那里也有很多很棒的教程。

这是创建新 Facebook 应用程序的[链接，您将获得一个应用程序密钥和 ID。](https://developers.facebook.com/apps)有了这些，您可以使用 Facebook API，当然您需要来自用户的访问令牌。该网站有很好的文档和例子来说明如何做到这一点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:01:44.070

开发者.facebook.com

转到您的应用程序，您应该在那里拥有一切。没有这个你是怎么测试的？

你确定你不是在引用 IOS 证书来在 appstore 上启动应用程序吗？

你能指定你在找什么吗？

# windows-phone - 设置ApplicationPage Windows Phone的背景颜色

> ID：15119016
> 
> 赞同：0
> 
> 时间：2013-02-27T17:59:29.903
> 
> 标签：windows-phone

我的 Windows 手机应用程序在深色方案下工作正常，但是当设备的主题设置为浅色时，我的背景变成白色，因为我的按钮消失了。即使设备主题很亮，我如何将我的应用背景设置为黑色？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:52:45.843

试试这个：找到 LayoutRoot 并将背景设置为您选择的颜色。

```
<Grid x:Name="LayoutRoot" Background="Black"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:53:26.753

请参阅[如何阻止（InputScope = Number）文本框在获得焦点时消失？](https://stackoverflow.com/questions/15031764/how-to-stop-an-inputscope-number-textbox-from-disappearing-when-it-gains-foc/15042452#15042452)有关模板控件以覆盖默认系统主题的更多信息。

另请注意，我建议不要为了强制使用浅色或深色主题而*这样做。*除非您有自己的自定义品牌/配色方案，否则这是一项繁重的工作，并且可能会让用户感到烦恼/困惑。

# machine-learning - 编辑值的 Weka 过滤器

> ID：15119025
> 
> 赞同：2
> 
> 时间：2013-02-27T17:59:53.737
> 
> 标签：machine-learning, weka

是否有我可以应用的过滤器来更改名义属性的值？

例如，我有一个水果属性，它的值可以是苹果、梨、香蕉、橙子。我想将可能的值更改为美味和可怕。我还想更改数据集中的值，以正确映射到这些新的可能类别。

基本上我想要一个过滤器，它可以自动执行您可以通过编辑窗口手动执行的操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-27T09:04:55.553

我不确定 GUI 中是否存在可能的解决方案，除了逐个更改每个类值或使用 CSV 编辑器程序的搜索和替换功能。但是，您可以使用简单的 Java 代码和 WEKA 库来处理它。

```
 for (int n = 0; n < att.numValues(); n++) {
    arff.renameAttributeValue(att, att.value(n), "" + n); 
```

[这](http://weka.wikispaces.com/Rename+Attribute+Values)是一种已经做到的方法。

# objective-c - UIScrollview 重置内容大小

> ID：15119027
> 
> 赞同：1
> 
> 时间：2013-02-27T17:59:56.670
> 
> 标签：objective-c, uiscrollview

我有一个`UIScrollview`包含默认高度为 1717px 的数据，在运行时我必须添加一个或多个子视图，每个子视图的高度均为 540px。事先不知道需要添加多少。

我将这些添加到`viewdidload`方法中的滚动视图中，然后将其设置`contentsize`为正确的值。我还将 contentsize 设置为我需要的任何值。如果我在方法结束时记录它一切都很好并且`contentsize`仍然正确。

一旦显示它`contentsize`已恢复到 1717 像素，但内容仍然存在。如果滚动超出 的正常范围，我可以查看添加的内容一秒钟`uiscrollview`，但它会反弹回来。

我的相关部分`viewdidload`如下

```
NSArray *sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"counter" ascending:YES]];
for (Facade * f in [self.inspection.facades sortedArrayUsingDescriptors:sortDescriptors]) {
    NSArray *subviewArray = [[NSBundle mainBundle] loadNibNamed:@"facadeView" owner:self options:nil];
    facadeView *facadeInfo = [subviewArray objectAtIndex:0];
    facadeInfo.facade = f;
    facadeInfo.frame = CGRectMake(0, self.scrollView.frame.size.height, facadeInfo.frame.size.width, facadeInfo.frame.size.height);
    self.scrollView.contentSize = CGSizeMake(self.scrollView.frame.size.width, self.scrollView.frame.size.height+facadeInfo.frame.size.height);
    self.scrollView.frame =  CGRectMake(0, 0, self.scrollView.frame.size.width, self.scrollView.frame.size.height+facadeInfo.frame.size.height);
    [self.scrollView addSubview:facadeInfo];
}
self.scrollView.frame = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height);;
// now add our scroll view to the main view
[self.view addSubview:self.scrollView]; 
```

我能做些什么来阻止我`contentsize`重置为原始值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-17T10:15:54.127

试试这个代码`viewDidAppear`而不是`viewDidLoad`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:35:51.703

I think

`self.scrollView.frame = CGRectMake(0, 0, self.scrollView.frame.size.width, self.scrollView.frame.size.height+facadeInfo.frame.size.height);`

inside the for loop is the problem. you don't need to increase the frame size. if you do so you cant scroll. contentsize must be smaller then frame size. if not so scroll view can't be scroll.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-26T06:13:54.363

这是自动布局的问题。禁用自动布局，它将正常工作！！！:-)

# python - 基于变量值的Python日志记录级别？

> ID：15119037
> 
> 赞同：5
> 
> 时间：2013-02-27T18:00:36.600
> 
> 标签：python, logging

我需要根据变量的值更改日志记录级别。例如：

```
if accel >= 10.0:
    log_func = logging.critical # Critical for splat event
elif accel >= 2.0:
    log_func = logging.warning  # Warning for high-G
elif accel >= 1.0:
    log_func = logging.info     # Info for normal
else:
    log_func = logging.debug    # Debug otherwise
log_func("Collision with %0.1fG impact.", accel) 
```

我的代码中都有这样的实例。有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:07:04.633

是的，请改用该`Logger.log()`方法，并传入一个级别常量：

```
import sys

# Map accel values to log levels
levels = (
    (10.0, logging.CRITICAL),
    (2.0, logging.WARNING), 
    (1.0, logging.INFO),
    (-sys.maxsize, logging.DEBUG)
)

logging.log(next(lev[1] for lev in levels if lev[0] <= accel),
    "Collision with %0.1fG impact.", accel) 
```

您可以将级别选择封装到一个实用函数中：

```
def level_for_accel(accel):
    # return next matching log level for the given accel value
    return next(lev[1] for lev in levels if lev[0] <= accel)

logging.log(level_for_accel(accel), "Collision with %0.1fG impact.", accel) 
```

日志级别实际上是整数，而`CRITICAL`,`WARNING`等值只是常量。有许多方法可以`accel`通过一些简单的规则将一个值（例如 ）转换为匹配的日志级别，以比大量`if`/`else`分支更易读的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:04:19.300

您可以创建一个函数，该函数接受变量 accel 并返回适当的日志记录函数。然后调用它。它可能会是更清洁、更易于维护的代码。更不用说干了。

```
def logger(accel):
    if accel >= 10.0:
        return logging.critical # Critical for splat event
    if accel >= 2.0:
        return logging.warning  # Warning for high-G
    if accel >= 1.0:
       return logging.info     # Info for normal
   else:
       return logging.debug    # Debug otherwise 
```

然后你可以用它作为

```
logger(12)("hello world") 
```

# powershell - 是否可以使用 PowerTab 为别名功能配置选项卡完成？

> ID：15119039
> 
> 赞同：3
> 
> 时间：2013-02-27T18:00:37.770
> 
> 标签：powershell, command-line, powershell-2.0, powertab

我为 Micrsosoft TFS 和 Micrsosoft TFPT 命令行工具编写了一组 PowerShell 辅助函数（其中一些又使用 TFPT 中包含的 Posh cmdlet）。为了缩短命令的标准命名约定，比如`Get-TfsStatus`and `Invoke-TfsCommit`，我还创建了别名（例如`tf-status`and `tf-commit`）。我也使用 PowerTab 来完成制表符，但默认情况下 v0.99.6 不支持使用别名的制表符完成。

您如何配置选项卡补全，以便我的别名（均以开头）`tf-`可以向我显示可用命令的列表？

我看到 PowerTab 包含一个用于修改选项卡扩展行为的编辑器，但我不清楚我需要配置什么。我也知道关闭 PowerTab 后，默认的豪华选项卡补全适用于别名。

示例函数和别名：

```
function Get-TfsStatus([switch]$all) {
    # Do something
}

Set-Alias tf-status Get-TfsStatus
Set-Alias tf-st Get-TfsStatus 
```

注意：最初，我的实际函数名称为`tf-status`、`tf-commit`等，但当你使用 时`Import-Module`，PowerShell 抱怨我没有遵循 PowerShell 函数的命名标准。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T07:14:20.090

这不是我预期的用例，因此没有得到很好的支持。但是，只要您的别名在其名称中继续带有“-”，就有一种简单的方法可以破解此问题。

编辑**TabExpansionCore.ps1的****第 957 行**，将“别名”添加到命令类型列表中。

 **```
Get-Command -CommandType Alias,Function,ExternalScript,Filter,Cmdlet -Name "$($Matches[1])*" | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T09:28:16.410

首先，您*可以*为您的函数使用非标准名称而不会收到警告。

```
Import-Module <<path_to_your_module>> -DisableNameChecking 
```

尽管从经验来看，遵循（在大多数情况下）命名约定是一个好习惯。

默认情况下，自动完成功能*不适*用于别名。有效的，即使对于别名，是参数完成。因此，无论您键入`tf-status -a`还是`Get-TfsStatus -a`，如果您按 Tab，它都会自动完成到`-All`.

Powershell 控制台和 ISE 编辑器都没有启用别名完成的选项。

对于您的情况，我建议使用“错误”名称（无别名），导入，`-DisableNameChecking`然后自动完成将适用于`tf-status`.

关于 PowerTab——并非所有主机都完全支持。检查[此页面](http://powertab.codeplex.com/wikipage?title=Host%20Support&referringTitle=Documentation "这一页")以查看在何处支持哪些功能。我不太了解 - 我确信可以添加别名，但这可能是一项乏味的任务，需要为每个用户完成。如果有人没有 powertab，他们将无法对您在模块中定义的别名使用自动完成功能。**

# sql - 触发赋值

> ID：15119055
> 
> 赞同：0
> 
> 时间：2013-02-27T18:01:33.453
> 
> 标签：sql, sql-server

我要完成我的任务，但我遇到了一些问题，所以我需要你的帮助我已经创建了一个表名客户端包含 6 列名称（c_id，c_name，c_transfer，c_balance，day，time）现在任务是我必须创建一个触发器，其中日期列包含 Satauarday 和星期日，它会打印对不起银行关闭，如果时间列包含 05:00 到 09:00，它将插入，但如果时间没有重新保护条件行不能插入。代码如下：

```
create table client
(
c_id int identity primary key,
c_name varchar(50),
c_transfer money,
c_balance money,
[date] datetime,
[day] varchar(50),
)

alter trigger transactions
ON client
for Insert 
as
begin
    if(select top 1 [day] from client order by c_id desc)='Satuarday'
    begin
    print'Sorry Bank is closed today'
    rollback;
    commit;
    end
    if(select top 1 [day] from client order by c_id desc)= 'Sunday'
    begin
    print'Sorry Bank is closed today'
    rollback;
    commit;
    end
    if(select top 1 date from client order by c_id desc)not in (DATEDIFF(hh,'09:00','05:00'))
    begin
    print'Sorry Bank time is not this...'
    rollback;
    commit;
    end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:13:30.920

你要找的是`Inserted`桌子。此表可在`FOR INSERT`触发器内部使用，并包含要插入的行。

```
GO
CREATE TRIGGER transactions
ON client
FOR INSERT AS
BEGIN
  IF EXISTS(SELECT [day] FROM inserted 
            WHERE ([day] IN ('saturday', 'sunday')) 
            OR (DATEPART(hh,[date]) <= 5) OR DATEPART(hh,[date]) >= 9)
  BEGIN
    PRINT'Sorry Bank is closed at this time.'
    ROLLBACK;
  END;
END; 
```

# javascript - 使用选择器作为变量循环 .append()

> ID：15119056
> 
> 赞同：0
> 
> 时间：2013-02-27T18:01:37.673
> 
> 标签：javascript, jquery, variables, append, selector

我正在尝试循环 .append() 函数，以便每次使用不同的值更改选择器。但是，为了满足我的目标，我不知道选择器的语法。那么，如何改变呢？非常感谢！家豪

```
<script type="text/javascript">
var a=3;
for (var i=0;i<a;i++)                       {                           
$i.append(i);
}
</script>

<div class="0"></div> // expected: display 0
<div class="1"></div> // expected: display 1
<div class="2"></div> // expected: display 2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:13:53.827

您还可以使用函数作为 的参数`append`，在您的情况下可能更干净，可能更快：

```
$('div').append(function() {
    return this.className;
}); 
```

[http://jsfiddle.net/sSVL8/](http://jsfiddle.net/sSVL8/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:02:40.497

```
<script type="text/javascript">
var a=3;
for (var i=0;i<a;i++)                       {                           
$("."+i).append(i); //this is what you need
}
</script>

<div class="0"></div> // expected: display 0
<div class="1"></div> // expected: display 1
<div class="2"></div> // expected: display 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:08:30.000

首先，数字类和 id 并没有你想象的那么支持。

将您的 HTML 更新为这样的内容

```
<div class="box-0"></div>
<div class="box-1"></div>
<div class="box-2"></div> 
```

然后你可以在他的回答中使用死锁提供的脚本。

```
var a=3;
for (var i=0;i<a;i++) {                           
    $(".box-"+i).append(i); //this is what you need
} 
```

# java - getHardwareAddress 不适用于 OrientDB 的 IBMi (iSeries) reqd

> ID：15119061
> 
> 赞同：4
> 
> 时间：2013-02-27T18:01:49.833
> 
> 标签：java, orientdb, ibm-midrange

我实际上是在尝试在 IBMi 上运行 OrientDB（iSeries、AS/400、V540、JDK6-32 位最后应用的 CUM PTF）。OrientDB 早期所做的一件事（可以这么说）是尝试找到至少一个 mac 地址（不完全确定为什么我现在纯粹在本地嵌入模式下使用它）。我制作了自己的测试方法，结果相同：

```
LogIt.log(Level.INFO,"About to list mac addresses.");
final Enumeration<NetworkInterface> networkInterfaces = NetworkInterface.getNetworkInterfaces();
while (networkInterfaces.hasMoreElements()) {
    NetworkInterface networkInterface = networkInterfaces.nextElement();
    final byte[] mac = networkInterface.getHardwareAddress();
    if (mac == null) {
        LogIt.log(Level.INFO,"Mac address is null.");
        continue;
    }  // if
    String hex = Utils.convertBytesToHexString(mac);
    LogIt.log(Level.INFO,"Mac address found {0}.",hex);
}  // while 
```

系统输出显示一条消息：

```
getkerninfo 1: A system call received a parameter that is not valid. 
```

并且它无法使用调用 getHardwareAddress() 检索任何 mac 地址（实际上它返回 null 3 次）。我以“程序员”类型用户和安全官（如“root”）的身份运行它，结果相同。它在我的 Ubuntu 12.04 PC 和笔记本电脑上运行良好。

我想知道是否有其他人遇到过这个问题并找到了解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-17T01:41:33.813

由于 getkerninfo() 是 Unix/Linux 上通常未记录的 C 系统调用，您是否在 iSeries 上的 PASE 中运行它？我首先怀疑这是唯一可能取得成功的环境。否则，似乎需要一个 Linux 分区。

# xcode - 如何在第二个视图控制器中设置文本

> ID：15119062
> 
> 赞同：1
> 
> 时间：2013-02-27T18:01:51.160
> 
> 标签：xcode

我认为这很容易，但事实证明我现在已经花了大约 5 个小时。

我有两个 ViewController，我想使用名为 putInfo 的 IBAction 将预先格式化的 NSString 传递给另一个 VC。所有这些操作的责任就是在另一个 VC 的标签中添加一个词，.

所以，在第一个 ViewController 中，我实现了这样的代码：

```
- (IBAction)putInfo:(id)sender {

((secondViewController *)self.presentingViewController).ouputLabel.text = @"chicken"; 
```

}

我已经尝试过其他事情，比如获取对第二个 VC 的引用，实例化第二个视图控制器，在初始化第二个 VC WithNibName 的地方做那些事情——所有这些。以上只是我最近的失败。

这似乎应该是不费吹灰之力的。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:23:06.213

如果您使用 Storyboard，则需要使用方法 prepareForSegue。但首先你需要为你的 segue 命名：点击它，进入 Attribute Inspector 并为 segue 写一个标识符名称。

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
if([[segue identifier]isEqualToString:@"mySegue"])
{
    secondViewController* second = segue.destinationViewController;
    second.outputLabel = txtFieldSecondViewController;
} 
```

}

您将 textField（或某个字符串）的值传递给第二个视图的另一个 NSString 对象。

# jslint - javascript中的JSLint首选访问方法-点表示法还是数组括号？

> ID：15119063
> 
> 赞同：3
> 
> 时间：2013-02-27T18:01:51.997
> 
> 标签：jslint

一位同事正在我们的代码上运行 JSLint 并修复出现的问题。他所做的一项改变是从这一点出发：

```
document.getElementById(control["value1"]); 
```

对此：

```
document.getElementById(control.value1); 
```

JSLint 更喜欢在数组括号上使用点表示法吗？我从[这里](https://stackoverflow.com/questions/4968406/javascript-property-access-dot-notation-vs-brackets)的理解是括号更灵活一些，我想知道该领域的最佳实践是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:19:55.577

最佳实践是使用`.`符号，除非您确实需要传递变量。

这样看起来更正常，也可以让 JITter 做更智能的事情。

# image-processing - 在执行快速傅立叶变换之前，我是否需要将图像大小调整为 2^ax 2^b？

> ID：15119064
> 
> 赞同：1
> 
> 时间：2013-02-27T18:01:54.397
> 
> 标签：image-processing

在执行快速傅立叶变换之前，我是否需要将图像大小调整为 2^ax 2^b？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-08T11:49:23.370

对于确实需要使用 2 的幂而不是调整大小的情况，您应该用零填充。

在某些情况下，即使您使用的算法不限于 2 的幂，无论如何填充到该大小可能更有效（特别是如果您的图像仅略小于 2 的下一个幂）。此外，如果您的图像不是正方形的，您可以在拍摄 fft 之前填充到 2^a 的正方形图像。无论如何，一些算法会在幕后执行此操作 - 将您的图像填充为正方形，获取 fft，然后裁剪回原始大小。

零填充有时也用于增加输出中的点数 - 更高频率的“分辨率”，尽管由于您不再添加任何数据，它更像是插值。

您是否**需**要这样做取决于您使用的 fft 库。

# json - JSON响应的解码字符集

> ID：15119069
> 
> 赞同：0
> 
> 时间：2013-02-27T18:02:10.993
> 
> 标签：json, rest, encoding

我正在使用 Dev HTTP Client Chrome 扩展来验证 RESTful URL，这样我就可以构建可以使用它的 C# 应用程序。当响应显示在插件/浏览器编码不正确时，我对编码含义有疑问，但是当我使用相同的插件下载它并使用 Notepad++ 编码打开文件时很好。从该 Web 服务读取 JSON 响应时，我的 C# 应用程序遇到了同样的问题。我还使用了 restclient-ui-3.1 来检查数据，但它的行为与 Chrome 插件相同，这意味着它在其响应正文选项卡中显示了错误的字符。

显然，Web 服务正在发送正确编码的数据，但我无法在客户端相应地读取它。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T12:32:14.887

开发 HTTP 客户端使用 Content-Encoding 和 Content-Type HTTP 标头来确定响应正文是如何编码的（例如 Content-Encoding: gzip）以及包含什么表示形式（例如 Content-Type: application/json; charset=utf-8）。

您的网络服务似乎没有发送正确的 HTTP 标头。检查它们。

# ios - NSHTTPCookie 保存错误

> ID：15119071
> 
> 赞同：0
> 
> 时间：2013-02-27T18:02:18.503
> 
> 标签：ios, objective-c, cocoa-touch, cocoa

我正在使用`ASIFormDataRequest`并获取 cookie 作为响应。我试图将它们保存成`NSUserDefaults`这样：

```
NSArray * requestCookies = request.responseCookies;
NSArray * requestCookies = request.responseCookies;
if (requestCookies.count) {
    NSData *cookiesData = [NSKeyedArchiver archivedDataWithRootObject:requestCookies];
    [[NSUserDefaults standardUserDefaults] setObject:cookiesData forKey:kCookies_Key];
    [[NSUserDefaults standardUserDefaults] synchronize];
    NSLog(@"Request cookies: %@", requestCookies);
}
/* output:
Request cookies: (
"<NSHTTPCookie version:0 name:\"name1\" value:\"value1\" expiresDate:(null)
created:2013-02-27 17:49:27 +0000 (3.8368e+08) sessionOnly:TRUE 
domain:\"www.example.com\" path:\"/path\" isSecure:FALSE>",
"<NSHTTPCookie version:0 name:\"name2\" value:\"value2\" expiresDate:(null)
created:2013-02-27 17:49:27 +0000 (3.8368e+08) sessionOnly:TRUE 
domain:\"www.example.com\" path:\"/path\" isSecure:FALSE>"*/ 
```

然后我试图恢复这个cookie：

```
NSData *cookiesData = [[NSUserDefaults standardUserDefaults] objectForKey:kCookies_Key];
if ([cookiesData length]) {
    NSArray *cookies = [NSKeyedUnarchiver unarchiveObjectWithData:cookiesData];
    NSLog(@"Restored cookies: %@", cookies);
}
/* output:
Restored cookies: (
"<NSHTTPCookie version:0 name:\"name1\" value:\"value1\" expiresDate:(null)
created:2001-01-01 00:00:01 +0000 (1) sessionOnly:TRUE 
domain:\"www.example.com\" path:\"/path\" isSecure:FALSE>",
"<NSHTTPCookie version:0 name:\"name2\" value:\"value2\" expiresDate:(null)
created:2001-01-01 00:00:01 +0000 (1) sessionOnly:TRUE 
domain:\"www.example.com\" path:\"/path\" isSecure:FALSE>"*/ 
```

此 cookie 之间的唯一区别是：创建日期。可能我只会将这两个 cookie 的属性保存在 中`NSUserDefaults`，但为什么我有不同的 cookie 创建日期？

**UPD**

我尝试仅保存`NSHTTPCookie`并再次创建此 cookie 的属性，但我的创建日期相同：

```
created:2001-01-01 00:00:01 +0000 (1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T14:04:57.290

您应该将它们保存在 SharedCookie 存储空间中：

```
[[NSHTTPCookieStorage sharedHTTPCookieStorage] cookies] 
```

# iphone - 使用 NSSerlization 解析出 URL 编码字符串中的内容

> ID：15119084
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:03:05.770
> 
> 标签：iphone, ios, json

我在 test.html 文件中有以下内容

```
<a href="http://playSound/?arguments=%7B%20soundID%3A%20%E2%80%9CDOG%E2%80%9D%2C%20foreground%3A%20false%2C%20loop%3A%20true%20%7D">SHOULD PLAY DOG IF YOU CLICK ME!</a> 
```

我已经在 iOS 模拟器上加载了 html，我想解析它并让 DOG 将其传递给我的函数，这样它就可以播放 DOG，而无需对其进行硬编码。

我怎样才能做到这一点？我是 Objective-C 的新手，需要有关代码和编码结构的帮助。

到目前为止，我只将 html 内容加载到模拟器中，我使用 URL 编码从 JSON 获取此 url。我接下来的步骤是使用 NSSerlization 来获取“DOG”并对其进行解析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:53:32.747

如果您有 URL 解码的参数，那么您将有一个如下所示的字符串：

```
{ soundID: “DOG”, foreground: false, loop: true } 
```

假设你把它加载到一个 NSString 中，你可以从中得到一个 NSDictionary。

```
NSString *string = @"{ soundID: “DOG”, foreground: false, loop: true }";
NSDictionary *dictionary = [NSJSONSerialization JSONObjectWithData:[string dataUsingEncoding:NSUTF8StringEncoding] options:0 error:nil]; 
```

现在，您可以非常轻松地获得 SoundID。

```
NSString *soundID = dictionary[@"soundID"]; 
```

编辑：

要检索参数 GET 变量，假设您的 URL 如下所示：

```
NSString *url = @"<a href="http://playSound/?arguments=%7B%20soundID%3A%20%E2%80%9CDOG%E2%80%9D%2C%20foreground%3A%20false%2C%20loop%3A%20true%20%7D">SHOULD PLAY DOG IF YOU CLICK ME!</a>"; 
```

您可以像这样拆分它并获取 URL 解码参数以与上面的代码一起使用：

```
NSArray *urlComps = [url componentsSeparatedByString:@"arguments="];
NSString *arguments = [urlComps[1] componentsSeparatedByString:@"\""][0];
arguments = [arguments stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

# angularjs - angular.js，无法编辑动态创建的输入字段

> ID：15119086
> 
> 赞同：12
> 
> 时间：2013-02-27T18:03:10.637
> 
> 标签：angularjs

使用 angular.js，我有一个表单字段的动态列表，我想向用户显示以供编辑（以及以后提交）：

```
var app = angular.module('app', []);
app.controller('Ctrl', function($scope) {
    $scope.fields = {
        foo: "foo",
        bar: "bar",
        baz: "baz"
    };
}); 
```

和 HTML：

```
<div ng-app="app" ng-controller="Ctrl">
    <table>
        <th>key</th>
        <th>value</th>
        <th>fields[key]</th>
        <tr ng-repeat="(key,value) in fields">
            <td>{{key}}:</td>
            <td><input type="text" ng-model="value"/></td>
            <td><input type="text" ng-model="fields[key]"/></td>
        </tr>
    </table>
</div> 
```

看到[这个小提琴](http://jsfiddle.net/skehlet/aERwc/3/)。由于我不明白的原因，文本输入框不可编辑。如上所示，我尝试了两种不同的方法：`value`和`fields[key]`. `value`根本不可编辑，并且`fields[key]`将允许**一次**击键然后模糊。我究竟做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:52:39.893

SET 回答了为什么会发生这种情况，但是实现所需行为的解决方法是维护一个单独的键数组，然后对这些键运行 ng-repeat。我添加了一些文本字段进行测试以添加更多属性`$scope.fields`

如果您的要求是字段计数可能会更改，您可以使用 $watch 在属性计数更改时动态设置键。

[http://jsfiddle.net/aERwc/10/](http://jsfiddle.net/aERwc/10/)

标记

```
<div ng-app="app" ng-controller="Ctrl">
    <table>
        <th>key</th>
        <th>value</th>
        <tr ng-repeat="key in fieldKeys">
            <td>{{key}}:</td>
            <td><input type="text" ng-model="fields[key]"/></td>
        </tr>
    </table>
    <div><h6>Add a field</h6>
        key: <input type="text" ng-model="keyToAdd" /><br />
        value: <input type="text" ng-model="valueToAdd" />
        <button ng-click="addField()">Add Field</button>
    </div>
</div> 
```

控制器

```
var app = angular.module('app', []);

app.controller('Ctrl', function($scope) {
    $scope.fields = {
        foo: "foo",
        bar: "bar",
        baz: "baz"
    };
    $scope.fieldKeys = [];

    $scope.setFieldKeys = function() {
        var keys = [];
        for (key in $scope.fields) {
            keys.push(key);
        }
        $scope.fieldKeys = keys;
    }

    $scope.addField = function() {
        $scope.fields[$scope.keyToAdd] = $scope.valueToAdd;
        $scope.setFieldKeys();
        $scope.keyToAdd = '';
        $scope.valueToAdd = '';
    }

    $scope.setFieldKeys();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:42:24.097

您需要使用对象数组。希望你可以修改你的模型：

```
$scope.fields = [
   {label: "foo", value: "foov"},
   {label: "bar", value: "barv"},
   {label: "baz", value: "bazv"}
];

<tr ng-repeat="field in fields">
  <td>{{field.label}}:</td>
  <td><input type="text" ng-model="field.value"> 
```

[小提琴](http://jsfiddle.net/mrajcok/ydPaK/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-27T18:42:47.627

它是可编辑的，但每次按键后，您的文本字段都会失去焦点，因此您必须再次单击它才能放置另一个字符。

发生这种情况是因为在任何模型的每次更改后都会重新渲染整个模板。并且在模板重新渲染后，目前无法知道应该关注哪个输入。因此，您应该以这种方式创建，并且您可能希望编写指令以将注意力集中在选定的输入上。

# objective-c - 如何在不崩溃的情况下获取 NSMutablearray 的第一个元素？

> ID：15119088
> 
> 赞同：1
> 
> 时间：2013-02-27T18:03:17.477
> 
> 标签：objective-c, nsmutablearray

我可以使用“lastObject”从 NSMutableArray 中获取最后一个元素。如果数组未初始化，它将返回 nil。是否有类似的方法或方法可以为第一个对象获得这种效果？这对我很有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:05:18.210

像这样的东西？

```
id myFirstObject = myArray.count>0 ? myArray[0] : nil; 
```

如果您特别希望它成为数组的一部分，请将其设为类别：

```
@interface NSArray (firstObject)
- (id)firstObject;
@end

@implementation NSArray (firstObject)
- (id)firstObject {
    return myArray.count>0 ? myArray[0] : nil;
}
@end 
```

然后你会得到一个与 lastObject 行为相同的 firstObject。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-10-09T05:59:19.703

ios 7 中的新更新

```
 NSArray *array = @[@1, @2, @3];

 NSLog(@"First Object: %@", [array firstObject]); // 1
 NSLog(@"Last Object: %@", [array lastObject]); // 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:06:22.920

你为什么不做

```
if ([array count] > 0) {
    id x = [array objectAtIndex:0];
} 
```

# c# - 在 C# Lambda 表达式中，如何确定匹配的值？

> ID：15119090
> 
> 赞同：0
> 
> 时间：2013-02-27T18:03:18.990
> 
> 标签：c#, regex, lambda

在以下函数（完美运行）中，我现在面临的挑战是让它不仅返回找到匹配项的位置，而且返回匹配项是什么......代码：

txtFilePattern 是一个管道分隔的文件扩展名列表。txtKeywords 是我正在寻找的关键字的多行文本框 txtPatterns 与 txtKeywords 相同，但适用于正则表达式模式。

这是我自己对 C# Grep 的小实验。

```
private List<Tuple<String, Int32, String>> ScanDocuments2()
    {
        Regex searchPattern = new Regex(@"$(?<=\.(" + txtFilePattern.Text + "))", RegexOptions.IgnoreCase);
        string[] keywordtext = txtKeywords.Lines;
        List<string> keywords = new List<string>();
        List<Regex> patterns = new List<Regex>();
        for (int i = 0; i < keywordtext.Length; i++)
        {
            if (keywordtext[i].Length > 0)
            {
                keywords.Add(keywordtext[i]);
            }
        }
        string[] patterntext = txtPatterns.Lines;
        for (int j = 0; j < patterntext.Length; j++)
        {
            if (patterntext[j].Length > 0)
            {
                patterns.Add(new Regex(patterntext[j]));
            }
        }
        try
        {
            var files = Directory.EnumerateFiles(txtSelectedDirectory.Text, "*.*", SearchOption.AllDirectories).Where(f => searchPattern.IsMatch(f));
            //fileCount = files.Count();
            var lines = files.Aggregate(
                   new List<Tuple<String, Int32, String>>(),
                   (accumulator, file) =>
                   {
                       fileCount++;
                       using (var reader = new StreamReader(file))
                       {
                           var counter = 0;
                           String line;
                           while ((line = reader.ReadLine()) != null)
                           {
                               if (keywords.Any(keyword => line.ToLower().Contains(keyword.ToLower())) || patterns.Any(pattern => pattern.IsMatch(line)))
                               {
                                   //cleans up the file path for grid
                                   string tmpfile = file.Replace(txtSelectedDirectory.Text, "..");
                                   accumulator.Add(Tuple.Create(tmpfile, counter, line));
                               }
                               counter++;
                           }
                       }
                       return accumulator;
                   },
                   accumulator => accumulator
            );
            return lines;
        }
        catch (UnauthorizedAccessException UAEx)
        {
            Console.WriteLine(UAEx.Message);
            throw UAEx;
        }
        catch (PathTooLongException PathEx)
        {
            Console.WriteLine(PathEx.Message);
            throw PathEx;
        }
    } 
```

问题是 - 我如何确定通过哪个关键字或模式与我返回的元组匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:22:34.090

您如何引入一个新变量来保存匹配模式，并使用`FirstOrDefault`而不是`Any`. 然后，只要新变量不是`null`你有匹配的模式，你就可以在你的元组中返回它。

例如

```
...
        new List<Tuple<String, Int32, String, Regex>>()
...
                       while ((line = reader.ReadLine()) != null)
                       {
                           Regex matchingReg = patterns.FirstOrDefault(pattern => pattern.IsMatch(line));

                           if (keywords.Any(keyword => line.ToLower().Contains(keyword.ToLower())) || matchingReg != null)
                           {
                               //cleans up the file path for grid
                               string tmpfile = file.Replace(txtSelectedDirectory.Text, "..");
                               accumulator.Add(Tuple.Create(tmpfile, counter, line, matchingReg));
                           }
                           counter++;
                       }
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:33:14.290

这是一些重构的代码。肯尼斯的想法是对的。

```
private IEnumerable<LineMatch> ScanDocuments2()
{
    string[] keywordtext = txtKeywords.Lines;
    string[] patterntext = txtPatterns.Lines;

    Regex searchPattern = GetSearchPattern();
    var keywords = GetKeywords(keywordtext).ToList();
    var patterns = GetPatterns(patterntext).ToList();

    try
    {
        var files = GetFiles(searchPattern);

        var lines = files.Aggregate(
               new List<LineMatch>(),
               (accumulator, file) =>
               {

                foreach(var item in EnumerateFile(file, keywords, patterns))
                {
                  accumulator.Add(item);
                }

                   return accumulator;
               },
               accumulator => accumulator
        );
        return lines;
    }
    catch (UnauthorizedAccessException UAEx)
    {
        Console.WriteLine(UAEx.Message);
        throw;
    }
    catch (PathTooLongException PathEx)
    {
        Console.WriteLine(PathEx.Message);
        throw;
    }
}

private LineMatch EnumerateFile(string file, IEnumerable<string> keywords, IEnumerable<Regex> patterns)
{
  var counter = 0;

  foreach(var line in File.ReadLines(file))
  {
    var matchingRegex = patterns.FirstOrDefault(p => p.IsMatch(line));
    var keyword = keywords.FirstOrDefault(k => line.ToLower().Contains(k.ToLower()));

    if(keyword == null && matchingRegex == null) continue;

    string tmpfile = file.Replace(txtSelectedDirectory.Text, "..");

    yield return new LineMatch
    {
        Counter = counter,
        File = tmpfile,
        Line = line,
        Pattern = matchingRegex == null ? null : matchingRegex.Pattern,
        Keyword = keyword
    };

    counter++;
  }
}

private IEnumerable<string> GetFiles(Regex searchPattern)
{
  return Directory.EnumerateFiles(txtSelectedDirectory.Text, "*.*", SearchOption.AllDirectories).Where(f => searchPattern.IsMatch(f));
}

private IEnumerable<string> GetKeywords(IEnumerable<string> keywordtext)
{
  foreach(var keyword in keywordtext)
  {
    if(keyword.Length <= 0) continue;

    yield return keyword;
  }
}

private IEnumerable<string> GetPatterns(IEnumerable<string> patterntext)
{
  foreach(var pattern in patterntext)
  {
    if(pattern.Length <= 0) continue;

    yield return new Regex(pattern);
  }
}

private Regex GetSearchPattern()
{
  return new Regex(string.Format(@"$(?<=\.({0}))",  txtFilePattern.Text), RegexOptions.IgnoreCase);
}

public class LineMatch
{
  public int Counter { get; set; }
  public string File { get; set; }
  public string Line { get; set; }
  public string Pattern { get; set; }
  public string Keyword { get; set; }
} 
```

# sql - 如何在使用内部联接时使用其他字段的计数更新字段？

> ID：15119092
> 
> 赞同：0
> 
> 时间：2013-02-27T18:03:22.277
> 
> 标签：sql, sql-update

我有一个临时表，其中有一个名为 schedulesTotal 的字段。我想用基于选择的计数来更新它。但我不确定我的逻辑是否正确。

这是我的代码

```
UPDATE    [#tempMike]
SET              schedulesTotal = total
        (
        SELECT    ta.accountid,
            COUNT(New_NextCallDueDate) as total FROM [#tempMike] AS ta
            INNER JOIN PhoneCall AS p WITH (nolock) ON ta.accountid = p.regardingobjectid 
        group by ta.accountid
        ) 
```

如果我自己运行选择部分，我会得到 1 个帐户编号以及正确的总值我现在只想用选择语句返回的总值更新临时表

这是我目前得到的错误

```
Msg 156, Level 15, State 1, Line 4
Incorrect syntax near the keyword 'SELECT'.
Msg 102, Level 15, State 1, Line 8
Incorrect syntax near ')'. 
```

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:07:31.867

试试这个

```
UPDATE   A
SET   schedulesTotal = total
FROM  [#tempMike] A
INNER JOIN (
        SELECT    ta.accountid,
            COUNT(New_NextCallDueDate) as total FROM [#tempMike] AS ta
            INNER JOIN PhoneCall AS p WITH (nolock) 
            ON ta.accountid = p.regardingobjectid 
            group by ta.accountid
        ) B ON A.accountid = B.accountid 
```

编辑：

`UPDATE A`正在使用别名`'A'`，我们在 from 子句 - 中给 temptable`[#tempMike] A`以更新临时表。你也可以使用`UPDATE [#tempMike]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:12:49.010

您的 UPDATE 格式错误，请尝试使用以下结构进行修复：

```
update TABLE
SET COLUMN = ( select count(*) from ANOTHER_TABLE where COLUMN1 = TABLE.COLUMN1)
; 
```

注意 COLUMN 只分配了一个值（在这种情况下 COUNT(*) 本身是一个 GROUP 函数，您不需要 group by ）。

高温高压

# xpath - xpath 选择最近的表来锚定带有名称的标签

> ID：15119094
> 
> 赞同：0
> 
> 时间：2013-02-27T18:03:24.810
> 
> 标签：xpath, htmlunit

我正在尝试使用 xpath 并且很难从下面的 html 代码中调用表格元素。

html中会有很多表格。我感兴趣的是最接近给定名称的锚标签。

下面的 html 部分只是我正在处理的 html 语法的粗略概念。

```
 <body>
 .
 .
 .
 .
 .
 <p>
 <font><b><a name="myTable" /></b></font></p>
 <p><b></p>
 <div><p></p></div>
 <table>
  :
  :
  :
</table>
  .
  .
  .. 
```

我最初是通过从锚标记调用 get parent 然后调用下一个兄弟几次我到达表来回到“P”元素。我知道这不是聪明的方法。另一个问题是可以有可变的兄弟姐妹。所以我只知道我必须查看的表是最接近带有名称的锚标记的表。

有人可以提供一些想法吗？

我试过这个：

```
 getByXPath("//a[@name=myTable]/table"); ( it wont work because it goes to anchor tag and looks for table in children of anchor tag. But it is not the case here) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:16:07.577

尝试

```
//a[@name='myTable']/following::table[1] 
```

# jpa - eclipselink 连接池

> ID：15119095
> 
> 赞同：18
> 
> 时间：2013-02-27T18:03:29.420
> 
> 标签：jpa, jdbc, eclipselink, connection-pooling

如果在 Eclipse 链接的 persistence.xml 中没有定义连接池，那么默认行为是什么？

它会为每个事务打开和关闭 JDBC 连接吗？它会创建一个具有一些默认值的连接池吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T15:28:53.023

不使用数据源时 EclipseLink 的默认连接池是最小/最大 32 个连接的池，初始连接数为 1 个。因此，每个事务都将使用池连接，而不是连接/断开连接。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-27T20:00:07.110

如果您使用应用服务器（Java EE）和容器管理的持久性，那么您需要在应用服务器的管理控制台中设置连接池，并且不需要在 persistence.xml 中设置池属性，例如：

```
<persistence-unit name="myPU" transaction-type="JTA">
  <jta-data-source>jdbc_my_DataSource</jta-data-source>
  <exclude-unlisted-classes>false</exclude-unlisted-classes>
  <shared-cache-mode>NONE</shared-cache-mode>
  <properties/>
</persistence-unit> 
```

如果您使用没有应用程序服务器（Java SE）的 EclipseLink，使用应用程序管理的持久性，那么如果您不配置池，将使用[内部连接池，例如：](http://wiki.eclipse.org/Introduction_to_Data_Access_%28ELUG%29#Internal_Connection_Pools)

```
<persistence-unit name="DemoPU" transaction-type="RESOURCE_LOCAL">
  <properties>
    <property name="javax.persistence.jdbc.url" value="jdbc:oracle:thin:@localhost:1521:xe"/>
    <property name="javax.persistence.jdbc.user" value="myuser"/>
    <property name="javax.persistence.jdbc.password" value="mypassword"/>
    <property name="javax.persistence.jdbc.driver" value="oracle.jdbc.OracleDriver"/>
  </properties>
</persistence-unit> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-29T13:21:18.080

```
<property name="eclipselink.connection-pool.default.initial" value="1"/>
<property name="eclipselink.connection-pool.default.min" value="64"/>
<property name="eclipselink.connection-pool.default.max" value="64"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-01T18:13:20.567

只是想为上面 James 的回答提供代码源：您可以看到在[ServerSession的构造函数中创建了一个默认连接池，使用](https://github.com/eclipse/eclipselink.runtime/blob/master/foundation/org.eclipse.persistence.core/src/org/eclipse/persistence/sessions/server/ServerSession.java)[ConnectionPool](https://github.com/eclipse/eclipselink.runtime/blob/master/foundation/org.eclipse.persistence.core/src/org/eclipse/persistence/sessions/server/ConnectionPool.java)中定义的 init/min/max 默认值，并且可以选择由开发人员通过覆盖/调整[EntityManagerSetupImpl](https://github.com/eclipse/eclipselink.runtime/blob/master/jpa/org.eclipse.persistence.jpa/src/org/eclipse/persistence/internal/jpa/EntityManagerSetupImpl.java#L1531)中的属性。

# maven - jardesc 在 jar 文件中创建一个“src”文件夹

> ID：15119098
> 
> 赞同：2
> 
> 时间：2013-02-27T18:03:46.677
> 
> 标签：maven, jar, src

我的 jardesc 一直运行良好，直到昨天我将项目转换为 maven。

现在由于某种原因，当我创建一个包含代码和包的 jar 文件：org.javacode 和 org.resource 时，我在 jar 文件中得到以下文件夹：

org/javacode src/org/resource

它似乎适用于 java 包，但对于那些包含图像资源的包，它会在根目录下创建一个额外的 src 文件夹。

我怎样才能解决这个问题？

编辑 1：这里是 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>Energy3D</groupId>
  <artifactId>Energy3D</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <build>
    <sourceDirectory>src</sourceDirectory>
    <resources>
      <resource>
        <directory>src</directory>
        <excludes>
          <exclude>**/*.java</exclude>
        </excludes>
      </resource>
    </resources>
    <plugins>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <dependencies>
    <dependency>
        <groupId>com.ardor3d</groupId>
        <artifactId>ardor3d-jogl</artifactId>
        <version>0.9-SNAPSHOT</version>
        <type>bundle</type>
    </dependency>
    <dependency>
        <groupId>com.ardor3d</groupId>
        <artifactId>ardor3d-lwjgl</artifactId>
        <version>0.9-SNAPSHOT</version>
        <type>bundle</type>
    </dependency>
  </dependencies>
</project> 
```

编辑2：

这里也是 jardesc 的相关部分（gui 包正确放置在 org/concord/energy3d/gui 但是在创建 jar 文件时图像包错误地放置在 src/org/concord/energy3d/resources/images 中）：

```
<javaElement handleIdentifier="=Energy3D/src&lt;org.concord.energy3d.gui"/>
<javaElement handleIdentifier="=Energy3D/src&lt;org.concord.energy3d.resources.images"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T11:27:45.457

您没有遵循 Maven 约定。

*   您的来源需要在下面： src/main/java

*   您的资源需要位于以下位置： src/main/resources

*   您的测试源需要位于以下位置： src/test/java

*   你的测试资源需要在下面：src/test/resources

Maven 的第一条规则是约定优于配置。您专注于配置位，而不是遵循约定。如果您不遵守约定，插件将无法在他们期望的地方找到东西。这将导致他们不做你想做的事，所以我建议你妥善解决这个问题。

另外，从你的 pom.xml 中删除这部分：

```
<sourceDirectory>src</sourceDirectory>
<resources>
  <resource>
    <directory>src</directory>
    <excludes>
      <exclude>**/*.java</exclude>
    </excludes>
  </resource>
</resources> 
```

# excel - 如何改进正在缓慢读取文件的 VBA 宏

> ID：15119100
> 
> 赞同：0
> 
> 时间：2013-02-27T18:03:59.630
> 
> 标签：excel, vba, file, split

在最近的一个项目中，我需要从一个包含大约 5K 行的文件中读取。

每行都有不同的字段，我需要将其中一些字段收集到 excel 中的特定单元格中。一行示例：

> 数据1;数据2;数据3; ..... ;数据N\r

`N`可以大到600。

目前我正在打开文件并遍历每一行，用“;”分隔 和储蓄。

我需要的是一个例子：

```
avarSplit = Split(sBuf, ";")

Range("C" & i).Value = CDbl(avarSplit(meter)) 
```

这往往非常慢，我已经有了，

`Application.Calculation = xlCalculationManual`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:07:17.603

我建议让 VBA 将文件作为分隔文本文件打开（相当于 File->Open, select ，然后在打开文本文件向导中选择 'delimited' 和 ';'）。如果您需要查看如何在 VBA 中执行此操作，请录制一个宏，然后手动打开它。然后，您将拆分值放在临时工作簿中，并可以像以前一样将它们复制到工作表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:41:35.910

5k 行，即使有 600 列也不应该花那么长时间。阻止可能是将值写入单元格。最好填充一个二维输出数组并将值一次性写入电子表格。这是一个例子。

```
Sub ReadTextFile()

    Dim sFile As String
    Dim lFile As Long
    Dim vaLines As Variant, vaSplit As Variant
    Dim aOutput() As String
    Dim i As Long
    Dim sInput As String

    sFile = MyDocs & "Book4.csv"
    lFile = FreeFile

    'Read in data
    Open sFile For Input As lFile
    sInput = Input$(LOF(lFile), lFile)
    'Split on new line
    vaLines = Split(sInput, vbNewLine)

    'Set up output array - split is zero based
    'but you want 1-based to write to cells
    ReDim aOutput(1 To UBound(vaLines, 1) + 1, 1 To 1)

    'loop through lines
    For i = LBound(vaLines) To UBound(vaLines)
        If Len(vaLines(i)) > 0 Then
            'split on delimiter
            vaSplit = Split(vaLines(i), ";")
            'store want you want in the output array
            aOutput(i + 1, 1) = vaSplit(15)
        End If
    Next i

    'write the output array to a range
    Sheet1.Range("A2").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput

End Sub 
```

# linux - bash shell 脚本中的意外输出

> ID：15119104
> 
> 赞同：2
> 
> 时间：2013-02-27T18:04:13.750
> 
> 标签：linux, bash, shell

对于以下脚本，我期望输出为 `msg_y and msg_z`. 但它是打印的`msg_x and msg_z`。有人可以向我解释发生了什么吗？

```
#!/bin/bash
 set -x

vr=2
echo $vr
if [ $vr > 5 ]
then
        echo "entered 1st if"
        echo "msg_x"

        echo "out of 1st if"

        if [ $vr < 8 ]; then
        echo "in of 2nd if"
        echo "msg_y"

        else
        echo "msg_z"
        fi

else
        if [ $vr > 1 ]; then echo "msg_y"

        else echo "msg_z"
        fi
fi 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T18:14:50.503

这个表达

```
[ $vr > 5 ] 
```

被解析为输出重定向；检查您现在是否有一个名为“5”的文件。输出重定向是空虚的。请注意，在测试表达式中引用参数的通常警告在这里没有帮助（但这仍然是一个好主意）。

您可以转义，`>`以便在测试命令中将其视为运算符：

```
if [ "$vr" \> 5 ]; then 
```

或者您可以使用整数比较运算符`-gt`

```
if [ "$vr" -gt 5 ]; then. 
```

由于您正在使用`bash`，因此您可以使用更健壮的条件表达式

```
if [[ $vr > 5 ]]; then 
```

或者

```
if [[ $vr -gt 5 ]]; then 
```

或使用算术表达式

```
if (( vr > 5 )); then 
```

做你的比较（对于其他人也是如此）。

* * *

注意：虽然我展示了如何`>`在被整数包围的情况下作为比较运算符工作，但不要这样做。大多数时候，你不会得到你想要的结果，因为参数是按字典顺序比较的，而不是按数字比较的。尝试`[ 2 \> 10 ] && echo What?`使用正确的整数比较运算符（`-gt`等）或使用算术表达式。

# java - 没有为操作定义结果 和结果输入

> ID：15119106
> 
> 赞同：2
> 
> 时间：2013-02-27T18:04:22.843
> 
> 标签：java, json, struts2, actionresult, struts2-interceptors

**这是我的`struts.xml`：**

```
<package name="ajax" extends="json-default" >
    <action name="loadcity"  method="loadcity" class="roseindia.action.user.RegisterUser" >
        <result  type="json" />
    </action>
</package> 
```

当我打电话`loadcity.action`时，我收到以下错误

```
No result defined for action roseindia.action.user.RegisterUser and result input 
```

**这是我的操作方法：**

```
public String loadcity()
{ 
    country=request.getParameter("country");

    cityList=  dao.loadcity(country);
    return ActionSupport.SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T12:49:13.257

First of all your `srtuts.xml` file is not completely defining the result type which should be render on the response of you action execution .`result` tag plays the role of a view in the Struts2 MVC framework. The action is responsible for executing the business logic. The next step after executing the business logic is to display the view using the tag. Here you can do one thing

```
<package name="ajax" extends="json-default" >
    <action name="loadcity"  method="loadcity" class="roseindia.action.user.RegisterUser" >
        <result name="input" type="json" />
    </action>
</package> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:23:39.577

`INPUT`如果您的操作有错误，则[`workflow`拦截器](https://struts.apache.org/core-developers/default-workflow-interceptor.html)会返回结果。在执行您的操作之前，堆栈中的拦截器可能会遇到这些错误。例如，执行验证时可能是验证错误，因为堆栈上有[`validation`拦截器。](https://struts.apache.org/core-developers/validation-interceptor.html)

您应该将`INPUT`结果添加到操作配置中。如果您发出 Ajax 请求并期望 JSON 响应，那么您可以返回`INPUT`type 的结果`"json"`，您可以在其中添加错误和消息。您还可以调整状态代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:16:45.670

您的`XML`节点`result`应该有一个`name`值为的属性，`"input"`因为这就是您要返回的内容。

所以你的 struts.xml 应该看起来：

```
<package name="ajax" extends="json-default" >
    <action name="loadcity"  method="loadcity" class="roseindia.action.user.RegisterUser" >
        <result name="input" type="json" />
    </action>
</package> 
```

**编辑：**

另一个错误可能是：

> 您正在获得验证或类型转换异常，因此它会查找“输入”结果。
> 
> 修复验证/类型转换异常。

来源：[struts 2 json plugin throws error no result type is defined](https://stackoverflow.com/questions/15103962/struts-2-json-plugin-throws-error-no-result-type-is-defined/15104137#15104137)

# javascript - Google Map API v3 未进行风格化

> ID：15119107
> 
> 赞同：0
> 
> 时间：2013-02-27T18:04:24.290
> 
> 标签：javascript, google-maps, google-maps-api-3, twitter-bootstrap, styling

我已经尝试搜索了一段时间，但我似乎无法找到答案。我在我的网站中实现了 Google Maps API v3，它可以工作。但是，当我尝试对其进行风格化（只是去饱和）时，它似乎不起作用。我尝试了很多不同的教程，但无济于事。我也在使用 Twitter Bootstrap，为我节省一点 CSS 工作，如果这会影响什么？该网站可以[在这里](http://www.casprstudio.com/bootstrap)看到。

这是地图的脚本：

```
<script type="text/javascript">
  function initialize() {
    var styles = [
      {
        featureType: "all", elementType: "all", stylers: [ { saturation: -100 }
        ]
      }
    ];

    var mapOptions = {
      center: new google.maps.LatLng(42.29900, -71.26232),
      zoom: 17,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);

  };
</script> 
```

这就是我将它放入页面下方的 HTML 中的方式：

```
<div class="bg-blue">
  <div id="map_canvas" style="width: 100%; height: 250px;"></div>
</div> 
```

就像我上面说的，地图显示了，但样式没有生效。如果您能提供任何帮助，请告诉我。我真的很感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:10:25.233

您创建了样式，但尚未将它们应用到地图...

[https://developers.google.com/maps/documentation/javascript/styling#styling_the_default_map](https://developers.google.com/maps/documentation/javascript/styling#styling_the_default_map)

```
function initialize() {

    var styles = [
      {
        featureType: "all", elementType: "all", stylers: [ { saturation: -100 }
        ]
      }
    ];

    var mapOptions = {
      center: new google.maps.LatLng(42.29900, -71.26232),
      zoom: 17,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      styles: styles  // <-- add this
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);

}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:09:47.427

您需要`styles`在对象中设置属性`mapOptions`：

```
var mapOptions = {
  center: new google.maps.LatLng(42.29900, -71.26232),
  zoom: 17,
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  styles: styles
}; 
```

[http://jsfiddle.net/bTZcS/](http://jsfiddle.net/bTZcS/)

# android - 自动完成文本框突出显示建议列表中键入的字符

> ID：15119113
> 
> 赞同：6
> 
> 时间：2013-02-27T18:04:31.983
> 
> 标签：android, android-listview, android-ui, autocompletetextview

我一直在努力`AutoCompleteTextView`。当我们键入时，我能够在下拉列表中获得建议和所有内容。

![至今](../Images/69c00df78dcbada00c79132e57635e75.png)

我的问题是：我们可以在建议下拉列表中突出显示输入的字符吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-10-31T09:45:55.680

我已经实现了功能。解决方法如下：

自动完成适配器.java

```
public class AutoCompleteAdapter extends ArrayAdapter<String> implements
        Filterable {

    private ArrayList<String> fullList;
    private ArrayList<String> mOriginalValues;
    private ArrayFilter mFilter;
    LayoutInflater inflater;
    String text = "";

    public AutoCompleteAdapter(Context context, int resource,
            int textViewResourceId, List<String> objects) {

        super(context, resource, textViewResourceId, objects);
        fullList = (ArrayList<String>) objects;
        mOriginalValues = new ArrayList<String>(fullList);
        inflater = LayoutInflater.from(context);

    }

    @Override
    public int getCount() {
        return fullList.size();
    }

    @Override
    public String getItem(int position) {
        return fullList.get(position);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View view = convertView;
        // tvViewResourceId = (TextView) view.findViewById(android.R.id.text1);
        String item = getItem(position);
        Log.d("item", "" + item);
        if (convertView == null) {
            convertView = view = inflater.inflate(
                    android.R.layout.simple_dropdown_item_1line, null);
        }
        // Lookup view for data population
        TextView myTv = (TextView) convertView.findViewById(android.R.id.text1);
        myTv.setText(highlight(text, item));
        return view;
    }

    @Override
    public Filter getFilter() {
        if (mFilter == null) {
            mFilter = new ArrayFilter();
        }
        return mFilter;
    }

    private class ArrayFilter extends Filter {
        private Object lock;

        @Override
        protected FilterResults performFiltering(CharSequence prefix) {
            FilterResults results = new FilterResults();
            if (prefix != null) {
                text = prefix.toString();
            }
            if (mOriginalValues == null) {
                synchronized (lock) {
                    mOriginalValues = new ArrayList<String>(fullList);
                }
            }

            if (prefix == null || prefix.length() == 0) {
                synchronized (lock) {
                    ArrayList<String> list = new ArrayList<String>(
                            mOriginalValues);
                    results.values = list;
                    results.count = list.size();
                }
            } else {
                final String prefixString = prefix.toString().toLowerCase();
                ArrayList<String> values = mOriginalValues;
                int count = values.size();

                ArrayList<String> newValues = new ArrayList<String>(count);

                for (int i = 0; i < count; i++) {
                    String item = values.get(i);
                    if (item.toLowerCase().contains(prefixString)) {
                        newValues.add(item);
                    }

                }

                results.values = newValues;
                results.count = newValues.size();
            }

            return results;
        }

        @SuppressWarnings("unchecked")
        @Override
        protected void publishResults(CharSequence constraint,
                FilterResults results) {

            if (results.values != null) {
                fullList = (ArrayList<String>) results.values;
            } else {
                fullList = new ArrayList<String>();
            }
            if (results.count > 0) {
                notifyDataSetChanged();
            } else {
                notifyDataSetInvalidated();
            }
        }

    }

    public static CharSequence highlight(String search, String originalText) {
        // ignore case and accents
        // the same thing should have been done for the search text
        String normalizedText = Normalizer
                .normalize(originalText, Normalizer.Form.NFD)
                .replaceAll("\\p{InCombiningDiacriticalMarks}+", "")
                .toLowerCase(Locale.ENGLISH);

        int start = normalizedText.indexOf(search.toLowerCase(Locale.ENGLISH));
        if (start < 0) {
            // not found, nothing to to
            return originalText;
        } else {
            // highlight each appearance in the original text
            // while searching in normalized text
            Spannable highlighted = new SpannableString(originalText);
            while (start >= 0) {
                int spanStart = Math.min(start, originalText.length());
                int spanEnd = Math.min(start + search.length(),
                        originalText.length());

                highlighted.setSpan(new ForegroundColorSpan(Color.BLUE),
                        spanStart, spanEnd, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

                start = normalizedText.indexOf(search, spanEnd);
            }

            return highlighted;
        }
    }
} 
```

MainActivity.java

```
public class MainActivity extends Activity {

    String[] languages = { "C", "C++", "Java", "C#", "PHP", "JavaScript",
            "jQuery", "AJAX", "JSON" };

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        List<String> wordList = new ArrayList<String>(); 
        Collections.addAll(wordList, languages); 
        AutoCompleteAdapter adapter = new AutoCompleteAdapter(this,
                android.R.layout.simple_dropdown_item_1line,
                android.R.id.text1,wordList);
        AutoCompleteTextView acTextView = (AutoCompleteTextView) findViewById(R.id.languages);
        acTextView.setThreshold(1);
        acTextView.setAdapter(adapter);
    }
} 
```

像魅力一样工作！

享受！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:21:27.420

我认为这应该是可能的，只要您知道用户最后输入的字符的索引/索引。然后，您可以使用 a`SpannableStringBuilder`并设置 a `ForegroundColorSpan`and`BackgroundColorSpan`以使字符具有突出显示的外观。

这个想法有点像这样：

```
// start & end of the highlight
int start = ...;
int end = ...;
SpannableStringBuilder builder = new SpannableStringBuilder(suggestionText);
// set foreground color (text color) - optional, you may not want to change the text color too
builder.setSpan(new ForegroundColorSpan(Color.RED), start, end, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE); 
// set background color
builder.setSpan(new BackgroundColorSpan(Color.YELLOW), start, end, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
// set result to AutoCompleteTextView
autocompleteTextview.setText(builder); 
```

请注意，只要您不键入另一个字符，“突出显示”就会一直存在。例如，当用户更改 中的光标位置时，您可能希望删除突出显示`AutoCompleteTextView`，但我将由您决定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-11T01:09:33.060

我知道现在回答这个问题为时已晚，但是当我个人努力寻找答案时，最后我自己写了它（在@MH.ofcourse的答案的帮助下），所以这里是：

首先，您必须创建一个自定义 ArrayAdapter：

```
public class AdapterAustocomplete extends ArrayAdapter<String> {

private static final String TAG = "AdapterAustocomplete";
String q = "";

public AdapterAustocomplete(Context context, int resource, List objects) {
    super(context, resource, objects);
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    String item = getItem(position);
    // Check if an existing view is being reused, otherwise inflate the view
    if (convertView == null) {
        convertView = 
   // I'll use a custom view for each Item , this way I can customize it also!
  G.inflater.from(getContext()).inflate(R.layout.textview_autocomplete, parent, false);

    }
    // Lookup view for data population
    TextView myTv = (TextView) convertView.findViewById(R.id.txt_autocomplete);

    int start = item.indexOf(q);
    int end = q.length()+start;
    SpannableStringBuilder builder = new SpannableStringBuilder(item);

    builder.setSpan(new ForegroundColorSpan(Color.RED), start, end, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

    myTv.setText(builder);
    return convertView;
}

public void setQ(String q) {
    this.q = q;
}
} 
```

在您要为 AutoCompleteTextView 设置适配器的代码中；

```
 AutoCompleteTextView myAutoComplete = findViewById(its_id);
   AdapterAustocomplete adapter_autoComplete = new AdapterAustocomplete(getActivity(), 0, items); // items is an arrayList of Strings
  adapter_autoComplete.setQ(q);
  myAutoComplete.setAdapter(adapter_autoComplete); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-29T17:05:02.717

感谢[vadher jitendra](https://stackoverflow.com/a/33450172/2914140)，我写了同样的内容并修复了一些错误。

1.  将下拉布局更改为拥有。

2.  添加了在单击内部时显示完整列表`AutoCompleteTextView`。

3.  修复了显示时冻结列表的错误（在 中添加了对空字符串的检查`highlight`）。

row_dropdown.xml（项目布局）：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/text1"
    style="?android:attr/dropDownItemStyle"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="10dp"
    android:ellipsize="marquee"
    android:paddingTop="8dp"
    android:paddingBottom="8dp"
    android:singleLine="true"
    android:textColor="#333333"
    android:textSize="15sp"
    tools:text="text"
    tools:textAppearance="?android:attr/textAppearanceLargePopupMenu" /> 
```

要在键入时过滤列表，我们应该实现 ArrayAdapter。这取决于项目（`T`类）。您可以稍后使用`AutoCompleteAdapter<String>`或任何您喜欢的数据类。

自动完成适配器：

```
import android.content.Context;
import android.graphics.Typeface;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.style.StyleSpan;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Filter;
import android.widget.Filterable;
import android.widget.TextView;

import androidx.annotation.IdRes;
import androidx.annotation.LayoutRes;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;

import java.text.Normalizer;
import java.util.ArrayList;
import java.util.List;
import java.util.Locale;

public class AutoCompleteAdapter<T> extends ArrayAdapter<T> implements Filterable {

    private Context context;
    @LayoutRes
    private int layoutRes;
    @IdRes
    private int textViewResId;
    private ArrayList<T> fullList;
    private ArrayList<T> originalValues;
    private ArrayFilter filter;
    private LayoutInflater inflater;
    private String query = "";

    public AutoCompleteAdapter(@NonNull Context context, @LayoutRes int resource, @IdRes int textViewResourceId, @NonNull List<T> objects) {
        super(context, resource, textViewResourceId, objects);
        this.context = context;
        layoutRes = resource;
        textViewResId = textViewResourceId;
        fullList = (ArrayList<T>) objects;
        originalValues = new ArrayList<>(fullList);
        inflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        return fullList.size();
    }

    @Override
    public T getItem(int position) {
        return fullList.get(position);
    }

    /**
     * You can use either
     * vadher jitendra method (getView)
     * or get the method from ArrayAdapter.java.
     */
//    @NotNull
//    @Override
//    public View getView(int position, View convertView, ViewGroup parent) {
//        View view = convertView;
//        T item = getItem(position);
//        Log.d("item", "" + item);
//        if (convertView == null) {
//            convertView = view = inflater.inflate(layoutRes, null);
//        }
//        // Lookup view for data population
//        TextView myTv = convertView.findViewById(textViewResId);
//        myTv.setText(highlight(query, item));
//        return view;
//    }
    @Override
    public @NonNull
    View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {
        return createViewFromResource(inflater, position, convertView, parent, layoutRes);
    }

    private @NonNull
    View createViewFromResource(@NonNull LayoutInflater inflater, int position,
                                @Nullable View convertView, @NonNull ViewGroup parent, int resource) {
        final View view;
        final TextView text;

        if (convertView == null) {
            view = inflater.inflate(resource, parent, false);
        } else {
            view = convertView;
        }

        try {
            if (textViewResId == 0) {
                //  If no custom field is assigned, assume the whole resource is a TextView
                text = (TextView) view;
            } else {
                //  Otherwise, find the TextView field within the layout
                text = view.findViewById(textViewResId);

                if (text == null) {
                    throw new RuntimeException("Failed to find view with ID "
                            + context.getResources().getResourceName(textViewResId)
                            + " in item layout");
                }
            }
        } catch (ClassCastException e) {
            Log.e("ArrayAdapter", "You must supply a resource ID for a TextView");
            throw new IllegalStateException(
                    "ArrayAdapter requires the resource ID to be a TextView", e);
        }

        final T item = getItem(position);
        text.setText(highlight(query, item.toString()));
//        if (item instanceof CharSequence) {
//            text.setText(highlight(query, (CharSequence) item));
//        } else {
//            text.setText(item.toString());
//        }

        return view;
    }

    @Override
    public @NonNull
    Filter getFilter() {
        if (filter == null) {
            filter = new ArrayFilter();
        }
        return filter;
    }

    private class ArrayFilter extends Filter {
        private final Object lock = new Object();

        @Override
        protected FilterResults performFiltering(CharSequence prefix) {
            FilterResults results = new FilterResults();
            if (prefix == null) {
                query = "";
            } else {
                query = prefix.toString();
            }
            if (originalValues == null) {
                synchronized (lock) {
                    originalValues = new ArrayList<>(fullList);
                }
            }

            if (prefix == null || prefix.length() == 0) {
                synchronized (lock) {
                    ArrayList<T> list = new ArrayList<>(originalValues);
                    results.values = list;
                    results.count = list.size();
                }
            } else {
                final String prefixString = prefix.toString().toLowerCase();
                ArrayList<T> values = originalValues;
                int count = values.size();

                ArrayList<T> newValues = new ArrayList<>(count);

                for (int i = 0; i < count; i++) {
                    T item = values.get(i);
                    if (item.toString().toLowerCase().contains(prefixString)) {
                        newValues.add(item);
                    }

                }

                results.values = newValues;
                results.count = newValues.size();
            }

            return results;
        }

        @SuppressWarnings("unchecked")
        @Override
        protected void publishResults(CharSequence constraint, FilterResults results) {
            if (results.values != null) {
                fullList = (ArrayList<T>) results.values;
            } else {
                fullList = new ArrayList<>();
            }
            if (results.count > 0) {
                notifyDataSetChanged();
            } else {
                notifyDataSetInvalidated();
            }
        }

    }

    private static CharSequence highlight(@NonNull String search, @NonNull CharSequence originalText) {
        if (search.isEmpty())
            return originalText;

        // ignore case and accents
        // the same thing should have been done for the search text
        String normalizedText = Normalizer
                .normalize(originalText, Normalizer.Form.NFD)
                .replaceAll("\\p{InCombiningDiacriticalMarks}+", "")
                .toLowerCase(Locale.ENGLISH);

        int start = normalizedText.indexOf(search.toLowerCase(Locale.ENGLISH));
        if (start < 0) {
            // not found, nothing to do
            return originalText;
        } else {
            // highlight each appearance in the original text
            // while searching in normalized text
            Spannable highlighted = new SpannableString(originalText);
            while (start >= 0) {
                int spanStart = Math.min(start, originalText.length());
                int spanEnd = Math.min(start + search.length(),
                        originalText.length());

                highlighted.setSpan(new StyleSpan(Typeface.BOLD), spanStart, spanEnd, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

                start = normalizedText.indexOf(search, spanEnd);
            }

            return highlighted;
        }
    }
} 
```

为了在单击内部时显示下拉列表，`AutoCompleteTextView`我们需要按照[https://stackoverflow.com/a/26036902/2914140](https://stackoverflow.com/a/26036902/2914140)`setOnTouchListener`中的描述进行覆盖。Lint 也会打印警告，所以我们必须编写一个自定义视图：

```
import android.content.Context;
import android.util.AttributeSet;
import android.view.MotionEvent;

import androidx.appcompat.widget.AppCompatAutoCompleteTextView;

/*
Avoids a warning "Custom view `AutoCompleteTextView` has setOnTouchListener called on it but does not override performClick".
 */
public class AutoCompleteTV extends AppCompatAutoCompleteTextView {

    public AutoCompleteTV(Context context) {
        super(context);
    }

    public AutoCompleteTV(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public AutoCompleteTV(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            performClick();
        }
        return super.onTouchEvent(event);
    }

    @Override
    public boolean performClick() {
        super.performClick();
        return true;
    }
} 
```

然后在activity_main.xml中使用它：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <com.google.android.material.textfield.TextInputLayout
        style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

        <com.example.autocompletetextview1.AutoCompleteTV
            android:id="@+id/languages"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="15dp"
            android:layout_marginRight="15dp"
            android:completionThreshold="1"
            android:hint="language"
            android:imeOptions="actionNext"
            android:maxLines="1"
            android:paddingLeft="10dp"
            android:paddingTop="15dp"
            android:paddingRight="10dp"
            android:paddingBottom="15dp"
            android:singleLine="true"
            android:textColor="#333333"
            android:textColorHint="#808080"
            android:textSize="12sp" />

    </com.google.android.material.textfield.TextInputLayout>

</LinearLayout> 
```

我`TextInputLayout`在这里使用更好的装饰，在这种情况下我们必须添加 Material Design 组件：

在 build.gradle 中：

```
implementation 'com.google.android.material:material:1.3.0-alpha01' 
```

在styles.xml 中：

```
<style name="AppTheme" parent="Theme.MaterialComponents.Light.DarkActionBar">
... 
```

主要活动：

```
import android.os.Bundle;
import android.view.MotionEvent;
import android.widget.AutoCompleteTextView;

import androidx.appcompat.app.AppCompatActivity;

import java.util.ArrayList;
import java.util.List;

public class MainActivity extends AppCompatActivity {

    String[] items = {"C", "C++", "Java", "C#", "PHP", "JavaScript", "jQuery", "AJAX", "JSON"};

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        List<DataClass> wordList = new ArrayList<>();
        for (int i = 0; i < items.length; i++) {
            DataClass data = new DataClass(i, items[i]);
            wordList.add(data);
        }
        AutoCompleteAdapter<DataClass> adapter = new AutoCompleteAdapter<>(this,
                R.layout.row_dropdown, R.id.text1, wordList);
        //adapter.setDropDownViewResource(R.layout.row_dropdown);
        AutoCompleteTV acTextView = findViewById(R.id.languages);
        acTextView.setThreshold(1);
        acTextView.setAdapter(adapter);
        acTextView.setText("Java");
        acTextView.setOnTouchListener((v, event) -> {
                    if (event.getAction() == MotionEvent.ACTION_DOWN) {
                        ((AutoCompleteTextView) v).showDropDown();
                        v.requestFocus();
                        v.performClick(); // Added to avoid warning "onTouch lambda should call View#performClick when a click is detected".
                    }
                    return false;
                }
        );
    }
} 
```

[![在此处输入图像描述](../Images/a986ca7bf9359b1daf040db016f4cd8a.png)](https://i.stack.imgur.com/vpXif.png) [![在此处输入图像描述](../Images/59c9268bbb12e2ae81bb8f75f1b29f25.png)](https://i.stack.imgur.com/OzP27.png) [![在此处输入图像描述](../Images/26bfed96c37f5cd951b3af3f20f52712.png)](https://i.stack.imgur.com/NbLZs.png)

# ssl - Tibco BW 中的 SSLHandshakeException

> ID：15119118
> 
> 赞同：1
> 
> 时间：2013-02-27T18:05:08.863
> 
> 标签：ssl, tibco, businessworks, tibco-business-works

在尝试从 Tibco BW 连接到外部供应商时，我遇到了 SSLHandshakeException。我了解此错误通常是由于安装在任一系统上的证书不匹配而发生的。但是我想知道这个 SSL 异常到底发生在哪一边？

作为解决方案的一部分，应该更改或更新哪一方的证书？我还附上了完整的日志消息。提前致谢

[![](../Images/179ab5ed8fc38024c86c050899bd6c51.png)](https://i.stack.imgur.com/Mbvmb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:46:39.500

我怀疑这个问题与证书无关。如果您的 BusinessWorks 应用程序不信任外部供应商证书，您将收到完全不同的错误消息。

更可能的怀疑是您的 BusinessWorks 应用程序和外部供应商服务器找不到双方都接受的匹配协议（例如 SSLv3 或 TLSv1）。尝试使用您最喜欢的 Web 浏览器进行连接，或使用诸如 openssl 之类的工具来找出服务器支持的协议。

**更新**：尝试执行以下命令，看看是否有任何一个握手失败

```
openssl s_client -connect server:port -ssl2
openssl s_client -connect server:port -ssl3
openssl s_client -connect server:port -tls1 
```

例如，BW 不支持 SSL 2.0，因此如果这是服务器支持的唯一协议，您需要通过将以下属性设置为已部署的 .tra 文件来修改默认安全提供程序

```
java.property.TIBCO_SECURITY_VENDOR=j2se 
```

# sql - Linq 存储过程超时但 SSMS 快速

> ID：15119121
> 
> 赞同：7
> 
> 时间：2013-02-27T18:05:19.160
> 
> 标签：sql, linq, linq-to-sql, timeout

我有一个使用 LinqToSQL 调用的存储过程。我根本没有做任何特别的事情，例如

```
MyDataContext db = new MyDataContext()

var results = db.storedProcedure(param1, param2, param3)

// Do stuff 
```

当我使用完全相同的参数运行存储过程时，我会在 2 到 6 秒之间得到结果。该数据库是一个远程数据库。

但是，当我运行存储过程时（调试后......）需要 275 秒！在正常情况下，这会产生以下异常：

> [Win32Exception (0x80004005): 等待操作超时]
> 
> [SqlException (0x80131904): 超时。操作完成前超时时间已过或服务器未响应。] System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) +1753346 System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) +5295154 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) +242 System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet stateObjHandler, TdsParser , Boolean& dataReady) +1682 System.Data.SqlClient.SqlDataReader.TryConsumeMetaData() +59 System.Data.SqlClient.SqlDataReader.get_MetaData() +90 System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString ) +365 System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task,Boolean asyncWrite) +1325 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String 方法, TaskCompletionSource`1 完成, Int32 超时, Task& 任务, Boolean asyncWrite) +175 System.Data.SqlClient.SqlCommand .RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String 方法) +53 System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior 行为, String 方法) +134 System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior 行为) +41 System.Data.Common.DbCommand.ExecuteReader() +12 System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries,对象 lastResult）+1306 System.Data.Linq.SqlClient.SqlProvider.ExecuteAll（表达式查询，QueryInfo[] queryInfos，IObjectReaderFactory 工厂，Object[] userArguments，ICompiledSubQuery[] subQueries）+118 System.Data.Linq.SqlClient.SqlProvider。 System.Data.Linq.Provider.IProvider.Execute（表达式查询）+342 System.Data.Linq.DataContext.ExecuteMethodCall（对象实例，MethodInfo methodInfo，Object[]参数）+83对象[] 参数）+83对象[] 参数）+83

所有其他存储过程都以相同的方式调用，但没有一个有这个问题。远程数据库管理员说他可以在超时发生之前看到调用开始和结束，所以这似乎与 Linq 接收数据后的步骤有关。

以前有没有人经历过这种情况以及如何解决它的任何想法？

我尝试从 dmbl 文件中删除 SP 并重新添加它。它注意到其中一个值从十进制变为双精度，但除此之外都是一样的。

和往常一样，昨天工作正常！

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-18T15:04:53.407

好的，我终于找到了这个问题的真正答案。SSMS 通常使用 ARITHABORT ON，而代码通常使用 ARITHABORT OFF - 这基本上是一个选项，用于在代码中的数学行有错误时如何处理发生的情况 - 例如除以零。

不过，这里的主要问题是两种方法都有不同的执行计划——这就是为什么同样的事情在网站上可能（随机）花费比在 SSMS 中更长的时间。

执行计划是根据第一次使用的估计来编译的，因此您随机发现执行计划以一种适合您的第一次查询的糟糕方式缓存，但对于后续查询来说却很糟糕。这就是这里发生的事情，这也是它突然重新开始工作的原因——在存储过程更改后创建了一个新的查询计划。

最后，我们在存储过程中使用了 WITH RECOMPILE - 因此没有有效地重用执行计划，但无论如何我们没有注意到任何差异，此后问题也没有发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T18:10:04.647

对我来说导致这个问题的原因是一个依赖于 Linq.Table< >.Count() 的循环。在开发环境中，底层查询几乎是即时的，但在生产环境中需要几秒钟。连接 SQL Profiler 显示查询是在循环的每次迭代中执行的，因此那些“几秒钟”开始累加，最终超时。

我的解决方案是将 Count() 结果分配给局部变量，并在循环中使用它，这样 Count() 就不会在每次迭代时重新执行查询。我想如果其他人依赖内置的 Linq 聚合函数来重新执行慢速查询，他们会遇到这个问题。

# java - 架构不匹配

> ID：15119122
> 
> 赞同：0
> 
> 时间：2013-02-27T18:05:26.067
> 
> 标签：java, ms-access, netbeans

我正在尝试运行一个链接到 netbeans 中的 Access 数据库的 java 程序。我知道 Access 是 32 位的，而 JDK 是 64 位的。我使用创建了链接`%WINDIR%\SYSWOW64\ODBCAD32.exe`。

现在，我收到此错误：`Architecture mismatch`. 我必须安装什么才能运行这个程序？我试图在这里找到解决方案，但我只是不明白我需要遵循的确切步骤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:17:25.233

由于您的 Java 应用程序运行 64 位，因此您将需要 64 位驱动程序。我相信以下链接有 64 位下载：

[http://www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

# php - 数组中的 PHP 只是数组元素的开始

> ID：15119124
> 
> 赞同：0
> 
> 时间：2013-02-27T18:05:31.187
> 
> 标签：php, arrays, contains

我有这个代码：

```
$array = array("Keys,placeholder", "Cheese,placeholder", "Knees,placeholder");

if(in_array("Cheese", $array)) {
    print("We do indeed have cheese!");
}

else {
    print("No cheese, Gromit!");
} 
```

但是当它检查数组时，它会检查整个东西是否是“奶酪”，而不仅仅是它是否包含文本“奶酪”。

有没有办法实现我想要的？

编辑：另外，如果只有第一位包含奶酪，我只希望触发代码；所以对于这个例子：

```
$array = array("Keys,placeholder", "Placeholder,cheese", "Knees,placeholder");

if(in_array("Cheese", $array)) {
    print("We do indeed have cheese!");
}

else {
    print("No cheese, Gromit!");
} 
```

我不想触发代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:11:44.507

`implode`它：

```
if (strpos(implode('', $array),'Cheese')!==false) print("We do indeed have cheese!");
else print("No cheese, Gromit!"); 
```

好的，奶酪是第一位的，去：

```
... implode('|', $array), '|Cheese') ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:09:22.460

```
if (preg_match("/Cheese/i", $array)) {
  return true;
} 
```

尝试这样的事情

# sql - WPF应用Linq to sql获取数据

> ID：15119129
> 
> 赞同：0
> 
> 时间：2013-02-27T18:05:52.647
> 
> 标签：sql, wpf, linq

我正在制作一个带有显示一些 sql 数据的数据网格的 WPF 应用程序。现在我正在创建一个搜索字段，但这似乎不起作用：

*   联系人是一个 nvarchar
*   bedrijf 是一个 nvarchar 但
*   LeverancierPK 是一个 INT 我如何在搜索中结合它？如果我将 LeverancierPK 转换为字符串，那么我可以使用 Contains 但这会给我一个错误

    ```
     //Inisiatie
        PRCEntities vPRCEntities = new PRCEntities();

        var vFound = from a in vPRCEntities.tblLeveranciers
                     where ((((a.LeverancierPK).ToString()).Contains(vWoord)) ||
                           (a.Contactpersoon.Contains(vWoord)) ||
                           (a.Bedrijf.Contains(vWoord)))
                     orderby a.LeverancierPK
                     select a;
        myDataGrid_Leveranciers.ItemsSource = vFound; 
    ```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:37:21.873

这段代码可以做我正在寻找的东西，但我认为它可能会更短。

```
 PRCEntities vPRCEntities = new PRCEntities();

        var vFound = from a in vPRCEntities.tblLeveranciers
                     orderby a.LeverancierPK
                     select a;

        myDataGrid_Leveranciers.ItemsSource = null;
        myDataGrid_Leveranciers.Items.Clear();

        foreach (var item in vFound)
        {
            if (item.Bedrijf.Contains(vWoord))
            {
                myDataGrid_Leveranciers.Items.Add(item);                    
            }
            else
            {           
                if (item.LeverancierPK.ToString().Contains(vWoord))
                {
                    myDataGrid_Leveranciers.Items.Add(item);
                }
                else
                {
                    if (item.Contactpersoon != null)
                    {
                        if (item.Contactpersoon.Contains(vWoord))
                        {
                            myDataGrid_Leveranciers.Items.Add(item);
                        }
                    }
                }
            }                
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:21:19.220

如果您不关心从数据库中拉回所有记录（在您的回答中您将所有记录都拉回），那么您可以`.ToList()`在 where 子句之前执行一个。

```
var vFound = vPRCEntities.tblLeveranciers.ToList()
             .Where(a => a.LeverancierPK.ToString().Contains(vWoord)) ||
                   a.Contactpersoon.Contains(vWoord) ||
                   a.Bedrijf.Contains(vWoord))
             .OrderBy(a.LeverancierPK); 
```

# javascript - Javascript 闭包（我认为）

> ID：15119131
> 
> 赞同：0
> 
> 时间：2013-02-27T18:05:57.647
> 
> 标签：javascript, closures

我有一段我正在使用的代码，它是由以前的开发人员传给我的。我只是想更好地理解它，而不是天真地使用它。这是代码：

```
slides.paginator.click(function (e) {
    e.preventDefault();
    interval.stop();
    switchSlide($(this).index());
    interval.start();
}); 
```

我不明白的部分是`e`通过这个匿名函数传递的参数。我以前见过这个，我认为它与闭包有关，但我又不确定。谁能给我一点了解这个参数的确切`e`工作原理？我在其他情况下也见过它，例如 jQuery 的 AJAX 方法。

即使将我指向一篇文章的正确方向也会有很大帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:12:10.763

“e”来自“事件”，请查看 jquery .click() 文档[http://api.jquery.com/click/](http://api.jquery.com/click/)

函数（e）{} 替换“处理程序（事件对象）”

# c# - 如何使用特定的应用程序配置文件

> ID：15119132
> 
> 赞同：1
> 
> 时间：2013-02-27T18:05:58.610
> 
> 标签：c#, app-config

下面的代码不起作用。它不会从`TestApp.Config`文件中获取应用程序设置。你知道为什么吗？我该如何解决？

```
 public void GetConfig()
  {
     AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", @"C:\dev\VS\ProofOfConcept\ProofOfConcept\TestApp.config");
     var a = ConfigurationManager.AppSettings;
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:15:18.810

这篇[文章](https://stackoverflow.com/questions/6150644/change-default-app-config-at-runtime)可能会有所帮助：

在此处发布的解决方案中`ResetConfigurationMechanism()`，您应该在调用`CurrentDomain.SetData(...);`.

```
private static void ResetConfigMechanism()
{
   typeof(ConfigurationManager)
   .GetField("s_initState", BindingFlags.NonPublic | BindingFlags.Static)                                                                                   
   .SetValue(null, 0);

   typeof(ConfigurationManager)
   .GetField("s_configSystem", BindingFlags.NonPublic | BindingFlags.Static)
   .SetValue(null, null);

   typeof(ConfigurationManager)
   .Assembly.GetTypes()
   .Where(x => x.FullName == 
      "System.Configuration.ClientConfigPaths")
   .First()
   .GetField("s_current", BindingFlags.NonPublic | BindingFlags.Static)
   .SetValue(null, null);
} 
```

# html - Fontawesome Bootsrap Icon Link 移除风格装饰

> ID：15119135
> 
> 赞同：0
> 
> 时间：2013-02-27T18:06:17.817
> 
> 标签：html, css, twitter-bootstrap, font-awesome

嗨伙计们，我有以下基本问题，但无法解决。

`<a href="#download" class="noStyle"><i class="icon-cloud-download" style="font-size: 112px;"></i></a>`

我试图通过在 CSS 中隐藏所有格式，但仍然无法删除样式

```
 a i {
    text-decoration: none; 
}

a.noClass.i:link {text-decoration:none;}    /* unvisited link */
a.noClass.i:visited {text-decoration:none;} /* visited link */
a.noClass.i:hover {text-decoration:none;}   /* mouse over link */
a.noClass.i:active {text-decoration:none;}  /* selected link */ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:16:00.350

你`noStyle`在你的 HTML 中调用，但你`noClass`在你的样式表中命名它..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:33:57.510

你应该这样做`a.noClass:link i`而不是`a.noClass.i:link`等。你的 CSS 选择器现在正在选择一个`a`带有类`noClass`AND的元素`i`。

# python - 在我的家用电脑上加载一个 django 项目

> ID：15119136
> 
> 赞同：1
> 
> 时间：2013-02-27T18:06:20.250
> 
> 标签：python, django

请耐心等待，因为我对 Python 和 Django 还是很陌生

我将我正在处理的项目从我的大学 PC 复制到 USB，当我将它加载到我的笔记本电脑并尝试在 cmd 中使用以下代码运行它时：`python manage.py runserver`

我收到了这个错误：

```
Unhandled exception in thread started by <bound method Command.inner_run of <django.contrib.staticfiles.management.commands.runserver.Command object at 0x01D4EB70>>
Traceback (most recent call last):
  File "C:\Python27\lib\site-packages\django\core\management\commands\runserver.py", line 91, in inner_run
    self.validate(display_num_errors=True)
  File "C:\Python27\lib\site-packages\django\core\management\base.py", line 270, in validate
    raise CommandError("One or more models did not validate:\n%s" % error_text)
django.core.management.base.CommandError: One or more models did not validate:
groupcraft.userprofile: "picture": To use ImageFields, you need to install the Python Imaging Library. Get it at http://www.pythonware.com/products/pil/ 
```

有人可以告诉我什么是错的或我没有做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:11:52.107

> 一个或多个模型未验证：groupcraft.userprofile: "picture"：要使用 ImageFields，您需要安装 Python Imaging Library。获取它在[http://www.pythonware.com/products/pil/](http://www.pythonware.com/products/pil/)

您`ImageField`在其中一个模型中使用 Django，并依赖于 PIL。您可以[下载并安装 PIL 的 Windows 安装程序](http://www.pythonware.com/products/pil/)（确保根据您的 Python 版本选择正确的文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T12:11:23.380

对于最新的 PIL 版本，只需输入：

```
easy_install http://effbot.org/downloads/PIL-1.1.7.win32-py2.7.exe 
```

您应该始终检查现有项目中的“requirements.txt”文件，以确保包含所有 python 库。

在 Windows 上工作时，您需要确保安装其中一些库的二进制版本。

# tdd - 找不到 autofixture 报告的循环引用

> ID：15119139
> 
> 赞同：1
> 
> 时间：2013-02-27T18:06:27.427
> 
> 标签：tdd, circular-reference, autofixture

我正在尝试验证我的基础架构。AutoFixture 说我的代码中有一个循环引用，当我省略该行为时，它无法将样本转换为我的对象类型。

绘制解决方案依赖关系图不会产生循环引用。autofixture 的输出似乎给了我一个域对象指向域对象的路径。我不明白……它们很简单。

我会继续前进，因为我有一个通过的测试，但我真的很想确保我没有不需要的循环引用。我还担心，如果在此示例中没有构建我的简单域对象，我以后将无法将 AutoFixture 用于隔离组件。

这是成功的测试：

```
[Fact]
[UseDataService(typeof(DatabaseVersionService))]
public void DataServiceGetsDatabaseVersionNonAutoFixture()
{
    var sut = new VersionClientProxy(new Uri(ConfigurationManager.AppSettings["DataServiceHostAddress"]));

    var expected = new DatabaseVersion()
    {
        MajorVersionId = 0,
        MinorVersionId = 0,
        BuildVersionId = 0,
        VersionId = 1
    };
     var actual = (from a in sut.DatabaseVersions
                  orderby a.VersionId descending
                  select a).FirstOrDefault();

    Assert.Equal(expected.MajorVersionId, actual.MajorVersionId);
    Assert.Equal(expected.MinorVersionId, actual.MinorVersionId);
    Assert.Equal(expected.BuildVersionId, actual.BuildVersionId);
    Assert.Equal(expected.VersionId, actual.VersionId);
} 
```

这是失败的测试：

```
[Fact]
[UseDataService(typeof(DatabaseVersionService))]
public void DataServiceGetsDatabaseVersion()
{
    var fixture = new Fixture();

    var sut = fixture.Build<VersionClientProxy>().FromFactory<VersionClientProxy>((x) =>
    {
        return new VersionClientProxy(new Uri(ConfigurationManager.AppSettings["DataServiceHostAddress"]));
    }).CreateAnonymous();

    var version = fixture.Build<DatabaseVersion>().FromFactory<DatabaseVersion>((x) =>
    {
        return new DatabaseVersion { MajorVersionId = 0, MinorVersionId = 0, BuildVersionId = 0, VersionId = 1 };
    }).CreateAnonymous();
    var expected = version.AsSource().OfLikeness<DatabaseVersion>();

    var actual = (from a in sut.DatabaseVersions
                  orderby a.VersionId descending
                  select a).FirstOrDefault();
    Assert.True(expected.Equals(actual));
} 
```

这是客户端代理（单独的项目仅引用数据模型项目）：

```
public class VersionClientProxy : DataServiceContext
{
    public VersionClientProxy(Uri serviceRoot)
        : base(serviceRoot, DataServiceProtocolVersion.V3)
    {
    }

    public IQueryable<DatabaseVersion> DatabaseVersions
    {
        get { return CreateQuery<DatabaseVersion>("DatabaseVersions"); }
    }
} 
```

这是我启动的数据服务（服务在单独的项目中仅引用数据模型项目）

```
public class UseDataServiceAttribute : BeforeAfterTestAttribute
{
    private readonly DataServiceHost serviceHost;

    public UseDataServiceAttribute(Type serviceToHost)
    {
        serviceHost = new DataServiceHost(serviceToHost, new Uri[] { new Uri(ConfigurationManager.AppSettings["DataServiceHostAddress"]) });
    }

    public override void Before(System.Reflection.MethodInfo methodUnderTest)
    {
        try { serviceHost.Open(); }
        catch
        {
            try { serviceHost.Close(); }
            catch
            {
                try { serviceHost.Abort(); }
                catch { }
            }
        }
        base.Before(methodUnderTest);
    }

    public override void After(System.Reflection.MethodInfo methodUnderTest)
    {
        base.After(methodUnderTest);
        try { serviceHost.Close(); }
        catch
        {
            try { serviceHost.Abort(); }
            catch { }
        }
    }
} 
```

这是数据模型类（单独的项目，由所有其他项目引用）：

```
public class DatabaseVersionDataModel
{
    private readonly List<DatabaseVersion> templist;
    public DatabaseVersionDataModel()
    {
        templist = new List<DatabaseVersion> { 
            new DatabaseVersion() { 
                MajorVersionId = 0, 
                MinorVersionId = 0, 
                BuildVersionId = 0, 
                VersionId = 1 } 
        };
        DatabaseVersions = templist.AsQueryable();
    }
    public IQueryable<DatabaseVersion> DatabaseVersions { get; private set; }
} 
```

这是模型项目中的数据库版本类：

```
[DataServiceKey("VersionId")]
public class DatabaseVersion
{
    public int VersionId { get; set; }
    public int MajorVersionId { get; set; }
    public int MinorVersionId { get; set; }
    public int BuildVersionId { get; set; }
} 
```

这是我的数据服务项目中的 DatabaseVersionService.svc 文件（空 asp.net，从 iisexpress 编译、调试，并且 atom 或 json 是可浏览的）：

```
public class DatabaseVersionService : DataService<DatabaseVersionDataModel>
{
    // This method is called only once to initialize service-wide policies.
    public static void InitializeService(DataServiceConfiguration config)
    {
        // TODO: set rules to indicate which entity sets and service operations are visible, updatable, etc.
        // Examples:
        // config.SetEntitySetAccessRule("MyEntityset", EntitySetRights.AllRead);
        // config.SetServiceOperationAccessRule("MyServiceOperation", ServiceOperationRights.All);
        config.SetEntitySetAccessRule("*", EntitySetRights.AllRead);
        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
    }
} 
```

这是删除 throwingrecursionbehavior 并添加 omitonrecursionbehavior 后的输出：

> 结果消息：System.InvalidCastException：无法将“Ploeh.AutoFixture.Kernel.OmitSpecimen”类型的对象转换为“skeletor.Domain.DatabaseVersion”类型。结果 StackTrace：
> 在 Ploeh.AutoFixture.Kernel.SpecimenFactory 1.Create `2.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.NoSpecimenOutputGuard.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.Postprocessor`(Object request, ISpecimenContext context) 在 Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.<>c_ *DisplayClass6.b* _1(ISpecimenBuilder b) 在 System.Linq.Enumerable.WhereSelectListIterator `2.MoveNext() at System.Linq.Enumerable.WhereSelectEnumerableIterator`2 .MoveNext() 在 System.Linq.Enumerable.d_a5 1 源) 在*Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.Create `1.MoveNext() at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`(Object request, ISpecimenContext context) 在 Ploeh.AutoFixture.Kernel.FilteringSpecimenBuilder.Create(Object request, ISpecimenContext context)在 Ploeh.AutoFixture.Dsl.NodeComposer`1.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.<>c__DisplayClass6.<Create>b__1(ISpecimenBuilder b) at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext() 在 System.Linq.Enumerable.WhereSelectEnumerableIterator `2.MoveNext() at System.Linq.Enumerable.<DefaultIfEmptyIterator>d__a5`1.MoveNext() 在 System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable `1 source) at Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.RecursionGuard.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.RecursionGuard.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Dsl.CompositeNodeComposer`1.Create(Object request, ISpecimenContext context) 在 Ploeh.AutoFixture.Kernel.SpecimenContext。在 Ploeh.AutoFixture.Kernel.SpecimenFactory 处解析（对象请求） 1\. 在 Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder 处`2.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.NoSpecimenOutputGuard.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.Postprocessor`创建（对象请求，ISpecimenContext 上下文）。<>c* _DisplayClass6.b_ *1（ISpecimenBuilder b）在 System.Linq.Enumerable 处。 WhereSelectListIterator `2.MoveNext() at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext() 在 System.Linq.Enumerable.d* _a5`1.MoveNext() at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 来源）在 Ploeh.AutoFixture.Kernel.FilteringSpecimenBuilder.Create(Object request, ISpecimenContext context) 在 Ploeh.AutoFixture.Dsl.NodeComposer 的 Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.Create(Object request, ISpecimenContext context) `1.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.<>c__DisplayClass6.<Create>b__1(ISpecimenBuilder b) at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()在 System.Linq.Enumerable.WhereSelectEnumerableIterator `2.MoveNext() at System.Linq.Enumerable.<DefaultIfEmptyIterator>d__a5`1.MoveNext() 在 System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source) at Ploeh.AutoFixture.Kernel.CompositeSpecimenBuilder.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.RecursionGuard.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Kernel.RecursionGuard.Create(Object request, ISpecimenContext context) at Ploeh.AutoFixture.Dsl.CompositeNodeComposer`1.在 Ploeh.AutoFixture.SpecimenFactory.CreateAnonymous[T](ISpecimenContext context, T 种子) 在 Ploeh.AutoFixture.Kernel.SpecimenContext.Resolve(Object request) 在 Ploeh.AutoFixture.SpecimenFactory.CreateAnonymous 处创建（对象请求，ISpecimenContext 上下文） [T](ISpecimenContext context) at Ploeh.AutoFixture.SpecimenFactory.CreateAnonymous[T](ISpecimenBuilderComposer composer) at Ploeh.AutoFixture.SpecimenFactory.CreateAnonymous[T](IPostprocessComposer`1 composer) at skeletor.AcceptanceTests.InfrstructureTests.DataServiceGetsDatabaseVersion() in d:\projects\skeletor\skeletor.AcceptanceTests\InfrstructureTests.cs:第 31 行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T21:24:38.937

假设您使用 WCF Data Services 5.* for OData V3，您可以尝试以下操作：

### 提供自定义 Uri：

与任何其他生成的标本一样，可以完全接管它的创作。`Uri`我们可以按如下方式自定义创建any ：

```
public class CustomUriBuilder : ISpecimenBuilder
{
    public object Create(object request, ISpecimenContext context)
    {
        if (request == typeof(Uri))
        {
            return new Uri(
                ConfigurationManager.AppSettings["DataServiceHostAddress"]);
        }

        return new NoSpecimen(request);
    }
} 
```

使用上述自定义`ISpecimenBuilder`类型，每次`Uri`请求 a 时，`Uri`都会返回一个预定义的。

### 自定义 Fixture 实例：

`DataServiceGetsDatabaseVersion`现在可以重写测试：

```
[Fact]
[UseDataService(typeof(DatabaseVersionService))]
public void DataServiceGetsDatabaseVersion()
{
    var fixture = new Fixture();
    fixture.Customize<VersionClientProxy>(c => c.OmitAutoProperties());
    fixture.Customizations.Add(new CustomUriBuilder());
    fixture.Inject(
        new DatabaseVersion
        {
            MajorVersionId = 0,
            MinorVersionId = 0,
            BuildVersionId = 0,
            VersionId = 1
        });

    var sut = fixture.CreateAnonymous<VersionClientProxy>();
    var version = fixture.CreateAnonymous<DatabaseVersion>();
    var expected = version.AsSource().OfLikeness<DatabaseVersion>();

    var actual = (from a in sut.DatabaseVersions
                    orderby a.VersionId descending
                    select a).FirstOrDefault();

    Assert.True(expected.Equals(actual));
} 
```

希望有帮助。

# linux - Linux 对话框输入框问题

> ID：15119145
> 
> 赞同：0
> 
> 时间：2013-02-27T18:06:41.530
> 
> 标签：linux, bash, dialog, ncurses

我在对话框上的输入框有问题。它覆盖了按下回车键时输入的文本。当按下回车键时，无论光标焦点在哪里，都会发生这种情况。

这是我使用它的代码是 bash

```
OUTPUT="INPUT.txt"
>$OUTPUT

dialog --stdout --title "Client Name" \
--backtitle "Setup" \
--inputbox "Enter The Client Name" 0 0 2>$OUTPUT
CLIENTNAME=$(<$OUTPUT)
rm $OUTPUT 
```

![在此处输入图像描述](../Images/5f6788c97a2988a71e9d45784aad7fe9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:32:52.270

您正在使用该`--stdout`选项，但重定向*STDERR*而不是*STDOUT*。

改变

```
--inputbox "Enter The Client Name" 0 0 2>$OUTPUT 
```

到

```
--inputbox "Enter The Client Name" 0 0 >$OUTPUT 
```

这将在使用时修复它`--stdout`。

# php - 基于 PHP 的应用程序/Web 登录框架？

> ID：15119148
> 
> 赞同：0
> 
> 时间：2013-02-27T18:06:59.177
> 
> 标签：php, mysql, oauth, hmac

我目前有一个非常简单的基于 PHP 的登录系统，它适用于 android、iOS 和 web，但我想使用一些更安全的东西。我当前的设置只是传递用户名和 md5 格式的密码来对我的数据库进行身份验证。

是否有人们推荐使用的框架。我听说过使用 PHP 的 oAuth 和 HMAC，但我不确定这些对于我需要的东西是否过大。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:25:36.653

对于初学者来说，MD5 不再被认为是安全的。使用现代硬件暴力破解太容易了。

其次，如果您通过网络发送 MD5 并且这就是您在数据库中拥有的内容，那么您实际上是在使用密码的 MD5 作为密码。这意味着您正在通过网络发送未加密的密码。想想看——攻击者只需要捕获 MD5 并将其发回，如果他们想闯入——你并没有从中获得任何实际的安全性。

只需通过 SSL 发送纯文本用户名和密码。将其与合并了密钥的服务器端安全哈希（如今，bcrypt 被认为是要走的路）进行比较。如果您的数据库受到损害，这将限制风险。

# android - “应用程序意外停止”错误

> ID：15119150
> 
> 赞同：-3
> 
> 时间：2013-02-27T18:07:00.293
> 
> 标签：android, nullpointerexception, runtime-error, avd

我是android开发的新手，所以请多多包涵，提前帮我解决这个问题。

当我在模拟器启动屏幕上运行我的应用程序时，它可以正常工作，但之后应该显示下一个布局时会弹出一条消息“应用程序意外停止”每次我运行应用程序时，相同的结果启动画面都能完美运行，但紧接着错误消息。

我删除并重新创建了 AVD，清理了项目，重新启动了 eclipse，机器但什么都没有......

* * *

**如果有帮助，请提供附加信息**

一开始，我创建了针对 Google API 14 和 min SDK 8 的项目，但我在运行模拟器时遇到了问题，它只卡在黑屏上，所以后来重新创建了 AVD 并将目标 SDK 更改为 Google API 8 (projrct->properties->Android- >Google API 8->apply->ok) 和最低 SDK 4。

* * *

这是 MainActivity（启动画面）

```
 package com.example.GPS;

 import android.app.Activity;
 import android.content.Intent;
 import android.media.MediaPlayer;
 import android.os.Bundle;

public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.kclogo);

    MediaPlayer mpsplash = MediaPlayer.create(this, R.raw.startup_tone);
    mpsplash.start();

    Thread logoTimer=new Thread()
    {
        public void run()
        {           
            try
            {
                int logoTimer=0;

                while(logoTimer<3499)
                {
                    sleep(100);
                    logoTimer= logoTimer +100;
                }

                startActivity(new Intent("com.example.GPS.KCLOGO"));

            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            finally
            {
                finish();
            }
        }
    };
    logoTimer.start();  
}
} 
```

* * *

这是菜单活动

```
 package com.example.GPS;

     import android.app.Activity;
     import android.content.Intent;
     import android.media.MediaPlayer;
     import android.os.Bundle;
     import android.view.View;
     import android.widget.Button;

     public class MenuActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.menu);

    final MediaPlayer mpButtonClick = MediaPlayer.create(this,R.raw.buttonclick);

        Button btn1 = (Button) findViewById(R.id.btnlogin);
        btn1.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                startActivity(new Intent("com.example.GPS.LOGIN"));
                mpButtonClick.start();

            }
        });

       }

       } 
```

* * *

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.GPS"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="4"
    android:targetSdkVersion="8" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <activity
        android:name="com.example.GPS.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

     <activity
        android:name="com.example.GPS.MenuActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.GPS.KCLOGO" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

    //sorry didn't include it to the question at first

   <activity
        android:name="com.example.GPS.LoginActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.GPS.LOGIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

 </application>

</manifest> 
```

* * *

## 日志猫

```
02-27 22:29:14.031:E/AndroidRuntime(307): FATAL EXCEPTION: main
02-27 22:29:14.031:E/AndroidRuntime(307): java.lang.**RuntimeException**:Unable to start    activity ComponentInfo{com.example.GPS/com.example.GPS.MenuActivity}: java.lang.**NullPointerException**
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.ActivityThread.access$2300(ActivityThread.java:125)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.os.Looper.loop(Looper.java:123)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.ActivityThread.main(ActivityThread.java:4627)
02-27 22:29:14.031:E/AndroidRuntime(307):at java.lang.reflect.Method.invokeNative(Native Method)
02-27 22:29:14.031:E/AndroidRuntime(307):at java.lang.reflect.Method.invoke(Method.java:521)
02-27 22:29:14.031:E/AndroidRuntime(307):at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
02-27 22:29:14.031:E/AndroidRuntime(307):at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
02-27 22:29:14.031:E/AndroidRuntime(307):at dalvik.system.NativeStart.main(Native Method)
02-27 22:29:14.031:E/AndroidRuntime(307): Caused by: java.lang.**NullPointerException**
02-27 22:29:14.031:E/AndroidRuntime(307):at com.example.GPS.MenuActivity.onCreate(MenuActivity.java:21)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.Instrumentation.**callActivityOnCreate**(Instrumentation.java:1047)
02-27 22:29:14.031:E/AndroidRuntime(307):at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

* * *

## 安慰

```
[2013-02-27 22:28:25 - GPSTracker] Android Launch!
[2013-02-27 22:28:25 - GPSTracker] adb is running normally.
[2013-02-27 22:28:25 - GPSTracker] Performing com.example.GPS.MainActivity activity launch
[2013-02-27 22:28:25 - GPSTracker] Automatic Target Mode: launching new emulator with compatible AVD 'GMD'
[2013-02-27 22:28:25 - GPSTracker] Launching a new emulator with Virtual Device 'GMD'
[2013-02-27 22:28:27 - GPSTracker] New emulator found: emulator-5554
[2013-02-27 22:28:27 - GPSTracker] Waiting for HOME ('android.process.acore') to be launched...
[2013-02-27 22:28:50 - GPSTracker] HOME is up on device 'emulator-5554'
[2013-02-27 22:28:50 - GPSTracker] Uploading GPSTracker.apk onto device 'emulator-5554'
[2013-02-27 22:28:52 - GPSTracker] Installing GPSTracker.apk...
[2013-02-27 22:29:07 - GPSTracker] Success!
[2013-02-27 22:29:07 - GPSTracker] Starting activity com.example.GPS.MainActivity on device emulator-5554
[2013-02-27 22:29:08 - GPSTracker] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.GPS/.MainActivity } 
```

* * *

登录.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:background="@color/layoutbg" >

<TableLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_weight="0.45" >

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

    </TableRow>

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp" >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="match_parent"
            android:layout_height="150dp"
            android:layout_gravity="center"
            android:layout_weight="1"
            android:src="@drawable/login_pic" />

    </TableRow>

    <TableRow
        android:id="@+id/tableRow3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="15dp"
        android:layout_marginTop="15dp" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/tvuserid"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dp"
                android:text="User ID"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <EditText
                android:id="@+id/etuserid"
                android:layout_width="220dp"
                android:layout_height="wrap_content"
                android:layout_marginLeft="16dp"
                android:ems="10"
                android:background="@drawable/gradiant" >

                <requestFocus />
            </EditText>
        </LinearLayout>

    </TableRow>

    <TableRow
        android:id="@+id/tableRow4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="15dp"
        android:layout_marginTop="15dp" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/tvpass"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dp"
                android:text="Password"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <EditText
                android:id="@+id/etpass"
                android:layout_width="220dp"
                android:layout_height="wrap_content"
                android:layout_marginRight="20dp"
                android:layout_weight="0.42"
                android:ems="10"
                android:inputType="textPassword"
                android:background="@drawable/gradiant" />

        </LinearLayout>
    </TableRow>

    <TableRow
        android:id="@+id/tableRow5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="15dp" >

        <Button
            android:id="@+id/btnlogin"
            android:layout_width="200dp"
            android:layout_height="wrap_content"
            android:layout_marginLeft="25dp"
            android:layout_marginRight="25dp"
            android:layout_weight="1"
            android:drawableLeft="@drawable/padlock"
            android:text="Login" />

    </TableRow>

    <TableRow
        android:id="@+id/tableRow6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="15dp" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <ImageView
                android:id="@+id/imageView2"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:layout_marginLeft="150dp"
                android:layout_weight="0.04"
                android:src="@drawable/exclamation" />

            <Button
                android:id="@+id/btnsignup"
                style="?android:attr/buttonStyleSmall"
                android:layout_width="wrap_content"
                android:layout_height="35dp"
                android:layout_marginRight="25dp"
                android:layout_weight="0.33"
                android:background="@color/layoutbg"
                android:text="Sign Up"
                android:textSize="16dp" />

        </LinearLayout>

     </TableRow>

  </TableLayout>

 </LinearLayout> 
```

* * *

kclogo.xml

```
 <?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:orientation="vertical" 
  android:background="@color/layoutbg">

  <ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginRight="12dp"
    android:src="@drawable/kclogo" />

</LinearLayout> 
```

* * *

菜单.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".MainActivity"
    android:background="@color/layoutbg" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="200dp"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:src="@drawable/gpscollage" />

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/imageView1"
        android:layout_below="@+id/imageView1"
        android:layout_marginTop="5dp"
        android:orientation="vertical" >

        <Button
            android:id="@+id/loginsignup"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:drawableLeft="@drawable/thumb_up_icon"
            android:text="Login/Sign Up" />

        <Button
            android:id="@+id/addnewtomap"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:drawableLeft="@drawable/add_to_map"
            android:text="Add Member/s To Map" />

        <Button
            android:id="@+id/addnewtocontacts"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:drawableLeft="@drawable/add_contact_list"
            android:text="Add To Contact List" />
    </LinearLayout>

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:31:55.720

确保 Button`btnlogin`存在于您的布局 xml 中。

您在 MenuActivity 中使用的布局是 main.xml，而您正在 main.xml 中查找不存在的 btnlogin。btn1 为空，因为它在布局中不存在。

# mysql - Oracle vs MySQL - 聚合函数

> ID：15119152
> 
> 赞同：1
> 
> 时间：2013-02-27T18:07:06.113
> 
> 标签：mysql, database, oracle

谁能解释 Oracle 的局限性，为什么以下语句在 MySQL 中有效，但在 Oracle 中收到“不是 GROUP BY 表达式”？

```
 SELECT order1.user_id, 
         order1.order_datetime, 
         SUM(order2.order_total)
    FROM order_table order1 
    JOIN order_table order2 ON order1.user_id = order2.user_id
GROUP BY order1.user_id 
```

是不是因为 Oracle 不知道如何处理该`order_datetime`列？`GROUP BY order1.user_id`它不能像在 MySQL 中那样只从它从行接收的任何行返回列结果吗？

**编辑：**

我知道所有列都应该在 group by 中，但是我试图理解为什么 Oracle 不会返回与 MySQL 类似的结果（而 MySQL 不需要每个 GROUP BY，而 Oracle 需要）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T18:10:15.660

Oracle 实际上正在执行正确的行为。当您使用`GROUP BY`时，选择列表中的项目必须出现在`GROUP BY`或聚合函数中。

```
SELECT order1.user_id, 
         order1.order_datetime, 
         SUM(order2.order_total)
    FROM order_table order1 
    JOIN order_table order2 ON order1.user_id = order2.user_id
GROUP BY order1.user_id, order1.order_datetime 
```

MySQL 使用[`EXTENSION TO GROUP BY`](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)允许不强制执行[FULL GROUP BY](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html#sqlmode_only_full_group_by)的行为。在 MySQL 中使用 this 并不能保证 的值是什么`order1.order_datetime`，MySQL 只是选择一个值，结果可能出乎意料。

您要么需要对列表`GROUP BY`中的所有项目使用 a 或聚合`SELECT`（类似于上面），要么必须重写查询。您可以使用以下任何一种：

```
SELECT order1.user_id, 
         min(order1.order_datetime) order_datetime, 
         SUM(order2.order_total)
    FROM order_table order1 
    JOIN order_table order2 ON order1.user_id = order2.user_id
GROUP BY order1.user_id 
```

它将聚合应用于`order_datetime`，那么您不必按日期分组。

您可以使用`sum() over()`：

```
SELECT order1.user_id, 
         order1.order_datetime, 
         SUM(order2.order_total) over(partition by order1.user_id) order_total
FROM order_table order1 
JOIN order_table order2 ON order1.user_id = order2.user_id 
```

或者这可以使用子查询重写。

```
SELECT order1.user_id, 
     order1.order_datetime, 
     order2.order_total
FROM order_table order1 
JOIN
(
    select SUM(order_total) order_total, user_id
    from order_table 
    group by user_id 
) order2
    ON order1.user_id = order2.user_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:19:44.790

[在此处](https://stackoverflow.com/q/6060241/443685)查看我的相关问题
Mysql 假定非分组函数/字段的“任何”值，而 Oracle 强制需要分组函数或按字段分组

来自[Mysql 手册](http://dev.mysql.com/doc/refman/5.6/en/group-by-extensions.html)：
`MySQL extends the use of GROUP BY so that the select list can refer to nonaggregated columns not named in the GROUP BY clause. This means that the preceding query is legal in MySQL. You can use this feature to get better performance by avoiding unnecessary column sorting and grouping. However, this is useful primarily when all values in each nonaggregated column not named in the GROUP BY are the same for each group. The server is free to choose any value from each group, so unless they are the same, the values chosen are indeterminate. Furthermore, the selection of values from each group cannot be influenced by adding an ORDER BY clause. Sorting of the result set occurs after values have been chosen, and ORDER BY does not affect which values the server chooses.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:11:44.490

在 oracle 中，需要指定 in`Select`中的所有列`group by`，如果您只想按一列分组而不是全部尝试这个

```
SELECT order1.user_id, 
         order1.order_datetime, 
SUM(order2.order_total) OVER (PARTITION BY order1.user_id) order_total
    FROM order_table order1 
    JOIN order_table order2 ON order1.user_id = order2.user_id 
```

# c#-4.0 - 我应该放弃 RavenDB 的整数 ID 吗？

> ID：15119153
> 
> 赞同：2
> 
> 时间：2013-02-27T18:07:08.910
> 
> 标签：c#-4.0, indexing, ravendb

更新：这是一个更充分地展示了这个问题的要点[https://gist.github.com/pauldambra/5051550](https://gist.github.com/pauldambra/5051550)

* * *

啊，更多更新...如果我将 Mailing 类的 Id 属性设为字符串，那么一切正常。我应该放弃整数ID吗？

* * *

我有 2 个模型

```
public class Mailing
{
    public int Id { get; set; }
    public string Sender { get; set; }
    public string Subject { get; set; }
    public DateTime Created { get; set; }
}

public class Recipient
{
    public Recipient()
    {
        Status = RecipientStatus.Pending;
    }
    public RecipientStatus Status { get; set; }
    public int MailingId { get; set; }
} 
```

在我的主页上，我想获取最后 10 封邮件。计算他们的接收者（最终计算不同状态的接收者，但是......）

我做了以下索引

```
public class MailingWithRecipientCount : AbstractMultiMapIndexCreationTask<MailingWithRecipientCount.Result>
        {
            public class Result
            {
                public int MailingId { get; set; }
                public string MailingSubject { get; set; }
                public string MailingSender { get; set; }
                public int RecipientCount { get; set; }
            }

            public MailingWithRecipientCount()
            {
                AddMap<Mailing>(mailings => from mailing in mailings
                                                 select new
                                                            {
                                                                MailingId = mailing.Id,
                                                                MailingSender = mailing.Sender,
                                                                MailingSubject = mailing.Subject,
                                                                RecipientCount = 0
                                                            });
                AddMap<Recipient>(recipients => from recipient in recipients
                                                    select new
                                                               {
                                                                   recipient.MailingId,
                                                                   MailingSender = (string) null,
                                                                   MailingSubject = (string)null,
                                                                   RecipientCount = 1
                                                               });
                Reduce = results => from result in results
                                    group result by result.MailingId
                                    into g
                                    select new
                                               {
                                                   MailingId = g.Key,
                                                   MailingSender = g.Select(m => m.MailingSender)
                                                                    .FirstOrDefault(m => m != null),
                                                   MailingSubject = g.Select(m => m.MailingSubject)
                                                                     .FirstOrDefault(m => m != null),
                                                   RecipientCount = g.Sum(r => r.RecipientCount)
                                               };
            }
        } 
```

我查询使用

```
public ActionResult Index()
        {
            return View(RavenSession
                        .Query<RavenIndexes.MailingWithRecipientCount.Result, RavenIndexes.MailingWithRecipientCount>()
                        .OrderByDescending(m => m.MailingId)
                        .Take(10)
                        .ToList());
        } 
```

我得到：

> System.FormatException：System.FormatException：输入字符串的格式不正确。在 System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T22:48:30.750

是的，整数 id 很痛苦。这主要是因为 Raven 总是存储一个完整的字符串文档密钥，并且您必须考虑何时使用该密钥或您自己的 id 并进行适当的翻译。归约时，还需要对齐 int 和 string 数据类型。

让您的测试通过的最低要求是：

```
// in the "mailings" map
MailingId = mailing.Id.ToString().Split('/')[1],

// in the reduce
MailingId = g.Key.ToString(), 
```

但是-您可以通过将发件人和主题字符串从中取出来使您的索引更小并且性能更好。您可以通过转换将它们放入。

这是一个简化的完整索引，它做同样的事情。

```
public class MailingWithRecipientCount : AbstractIndexCreationTask<Recipient, MailingWithRecipientCount.Result>
{
    public class Result
    {
        public int MailingId { get; set; }
        public string MailingSubject { get; set; }
        public string MailingSender { get; set; }
        public int RecipientCount { get; set; }
    }

    public MailingWithRecipientCount()
    {
        Map = recipients => from recipient in recipients
                            select new
                            {
                                recipient.MailingId,
                                RecipientCount = 1
                            };

        Reduce = results => from result in results
                            group result by result.MailingId
                            into g
                            select new
                            {
                                MailingId = g.Key,
                                RecipientCount = g.Sum(r => r.RecipientCount)
                            };

        TransformResults = (database, results) =>
                           from result in results
                           let mailing = database.Load<Mailing>("mailings/" + result.MailingId)
                           select new
                           {
                               result.MailingId,
                               MailingSubject = mailing.Subject,
                               MailingSender = mailing.Sender,
                               result.RecipientCount
                           };
    }
} 
```

顺便说一句，您知道[RavenDB.Tests.Helpers](https://nuget.org/packages/RavenDB.Tests.Helpers/2.0.2261)包吗？它提供了一个简单的基类`RavenTestBase`，您可以从中继承它，它为您完成了大部分工作。

```
using (var store = NewDocumentStore())
{
    // now you have an initialized, in-memory, embedded document store.
} 
```

另外 - 您可能不应该在单元测试中扫描程序集的索引。您可能会引入不属于您正在测试的部分的索引。更好的方法是单独创建索引，如下所示：

```
documentStore.ExecuteIndex(new MailingWithRecipientCount()); 
```

# django - Monkeypatching 使用 Django 的 LiveServerTestCase 的视图

> ID：15119155
> 
> 赞同：3
> 
> 时间：2013-02-27T18:07:17.173
> 
> 标签：django, monkeypatching, django-testing, pytest

我正在尝试使用 Selenium 为我的应用程序的前端行为编写测试。但是，我尝试测试的页面从 Solr 获取数据，并且我不想启动 Solr 实例来运行测试。

我正在使用 py.test 和[py.test-django](http://pytest-django.readthedocs.org/en/latest/)我的测试，并且我正在尝试对视图进行修补，以便对 Selenium 浏览器发送的数据做出断言。

例如，这是一个我预计会失败的测试：

```
def test_search(self, live_server, browser, monkeypatch):
    def mockview(request):
        from django.http import HttpResponse
        assert True == False
        return HttpResponse('Test')

    monkeypatch.setattr(project.app.views, 'search', mockview)

    browser.get(live_server.url + reverse('app:search')) 
```

当浏览器尝试加载“应用程序：搜索”页面时，我希望这会失败。相反，它会加载页面的正常版本并且测试成功。

有没有办法获得这种行为？或者有没有更好的方法来处理这些测试？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T13:14:55.333

您正在修改视图模块中的视图功能。任何已导入该视图（对函数的引用）的位置仍将保留对旧（真实）视图函数的引用。

Django 的 urlconf 机制在第一个请求（可能在另一个测试用例中发生）时使用真实视图导入和配置自身。

当您更改视图模块中的函数时，urlconf 不会注意到它，因为它已经包含对旧视图函数的引用。Python 中的猴子补丁会更改名称/引用，而不是函数本身。

您正在使用 pytest 的 monkeypatch 帮助程序，但模拟库文档中的本指南提供了一些关于在何处应用猴子补丁的好信息：

[http://www.voidspace.org.uk/python/mock/patch.html#where-to-patch](http://www.voidspace.org.uk/python/mock/patch.html#where-to-patch)

在这种特殊情况下，我认为最好的办法是使用静态测试数据而不是视图来修补 Sorl 调用。由于您正在进行 Selenium 测试，我认为保持真实视图会非常好。如果您替换整个视图，您实际上在测试什么？

如果视图本身包含大量特定于 Sorl 的代码，您可能希望将这些代码分解为一个单独的函数，然后您可以轻松地对其进行修补。

如果您真的想更改视图，我建议您覆盖 urlconf 以指向您的新视图： [https ://pytest-django.readthedocs.org/en/latest/helpers.html#pytest-mark-urls-override- -urlconf](https://pytest-django.readthedocs.org/en/latest/helpers.html#pytest-mark-urls-override-the-urlconf)

# entity-framework - EF Code first 自动迁移完全搞砸了

> ID：15119160
> 
> 赞同：1
> 
> 时间：2013-02-27T18:07:23.083
> 
> 标签：entity-framework, entity-framework-5, entity-framework-migrations

我不确定我做了什么，但是在发布到 azure 时出现此错误：

```
Automatic migration was not applied because it would result in data loss. 
```

现在这是非常令人讨厌的。我的模型与我的数据库 100% 匹配 - 如果我强制它，是否有可能会丢失数据？我真的很困惑现在该怎么办。

自动迁移就这么多：S 自动化不多 :) 我认为我的错误是我创建了新模型，发布了它，EF 为它们创建了新表。然后我记得我忘记将模型添加到我的`DbContext`. 所以我将新内容添加`DbSets`到上下文中并发布。那可能是它出错的地方。但是话又说回来，我不知道 EF 是否将模型添加到数据库中，如果它们不是 POCO 类或者它们被称为什么。可能是一些外键触发了……不知道。无论如何，我对我的代码进行了撤消狂热，并删除了所有新创建的表和东西，以使我进入我的起点。我认为这可能会解决它。但是noooee愚蠢的我。

任何想法从哪里开始解决这个问题？我要跳下悬崖我丢失了我的数据:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:13:14.780

您可以让 EF 为您创建 SQL，以便您可以手动实施迁移。在包管理器控制台中输入：

```
update-database -v -f -script 
```

它将打开一个新窗口，其中包含您可以查看的 SQL，然后将自己直接应用于数据库。在迁移历史中输入条目的最后一行将允许 DbContext 知道它正在查看正确的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-22T01:58:50.460

先做好备份！如果您使用 SQL Compact，则特别容易 - 只需复制文件即可。或者使用 LocalDB 或 SQL Server，分离，复制文件，附加..

但是为了提供更多帮助，生成该脚本可能仍然需要您寻找可能导致数据丢失的原因。我发现即使保留原始列，添加一个新列成为表中的主键也可能会丢失数据，因为对新列强制执行 NOT NULL 约束会导致（所有）行被删除。

# c# - 为什么 RichTextBox 中的文本消失了？

> ID：15119161
> 
> 赞同：4
> 
> 时间：2013-02-27T18:07:24.313
> 
> 标签：c#, winforms

我正在 c# 中使用`RichTextBoxes`. 一个 RTB 显示十六进制值，另一个显示 ASCII 值。

我的计划是每行显示一个“记录”。因此，如果我要查看 10 条长度为 1000 的记录，则 ASCII 中每行将有 10 行 1000 个字符，而十六进制侧的长度为 3000。

我将属性动态设置`rtb.RightMargin`为一条记录的长度。

我遇到的问题是当记录非常长时，ascii 端超过 3500 个字符使十六进制端非常大，我发现当右边距变为时，文本开始在记录的中间和末尾消失太大了。例如：

```
 hexRtb.RightMargin = 7500 //This is because it's triple the size of the ascii text. 
```

在 中`hex rtb`，它将显示文本的第一部分，直到我开始向中间滚动，所有文本完全停止显示。如果我设法点击记录的这些空白部分，文本会出现，但在滚动离开后会再次消失。

我无法弄清楚发生了什么。这似乎仅在 RightMargin 设置为非常大的数字时才会发生。较小的数字，所有文本都将毫无问题地显示。

有人遇到过这样的事情吗？

如果有帮助，这是一个代码示例。

```
int asciiRecordLength = mHexReader.RecordSize;
int hexRecordLength = mHexReader.RecordSize * HexByte; //This is to convert the ascii record length to a hex record length

asciiTextBox.RightMargin = TextRenderer.MeasureText(mHexReader.GetAsciiValues().Substring(0, asciiRecordLength), asciiTextBox.Font).Width;
hexTextBox.RightMargin = TextRenderer.MeasureText(mHexReader.GetHexValues().Substring(0, hexRecordLength), hexTextBox.Font).Width;

//Populate text boxes
hexTextBox.Text += mHexReader.GetHexValues(); //This gets all of the records to be read
asciiTextBox.Text += mHexReader.GetAsciiValues(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T14:45:15.190

对于那些遇到与我相同的问题的人，我找到了解决此问题的方法。

我没有使用 RichTextBox，而是找到了另一个可以下载的名为 ScintillaNET 的控件。到目前为止，我已经能够将我的大部分代码切换为使用此控件而没有任何问题。一些函数略有不同，例如，hexTextBox.ResetText() 不是 hextTextBox.Clear()，或者 hexTextBox.SelectionStart 现在是 hexTextBox.Selection.Start。

细微差别，但此控件解决了当记录长度变得非常大时像素消失的问题。

代码可以从以下网址下载：[http ://scinillanet.codeplex.com/](http://scintillanet.codeplex.com/)

希望这可以帮助遇到我遇到同样问题的其他人。

# php - 如何从网页中隐藏 [处理此指令时发生错误]

> ID：15119166
> 
> 赞同：0
> 
> 时间：2013-02-27T18:07:47.713
> 
> 标签：php, html, error-handling

所以我有一个 HTML 网页，它正在处理一些 php，但在上面显示它显示的 php 结果：[处理此指令时发生错误]

由于一切正常，我想做的就是完全隐藏那条线。有没有我可以添加的任何类型的javascript，如果它出现，可以隐藏该文本？

这是我的网页：[http ://dirbmudcats.com/dev/teams-8u.html](http://dirbmudcats.com/dev/teams-8u.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:24:22.117

```
Fatal error: Call to undefined function getSet() in /homepages/17/d434399820/htdocs/dirbmudcats/dev/sitefiles/set.php on line 21 
```

函数 getSet() 未定义。尝试定义它然后检查

# .net - Windows 7 上的 WCF netHttpBinding

> ID：15119173
> 
> 赞同：3
> 
> 时间：2013-02-27T18:08:27.970
> 
> 标签：.net, wcf, wcf-binding, .net-4.5, nettcpbinding

我目前有一个用 .NET 4.0 编写的客户端/服务器应用程序，它使用带有 netTcpBinding 的 WCF 在我的服务器和我的客户端应用程序之间提供全双工消息传递。该服务器是 AWS EC2 上的自托管应用程序。客户端是安装在我客户 PC 上的 Window 7 应用程序。

我现在遇到的问题是，我的一位新客户坚持让我的应用程序通过他们内部的 MS ISA 2004 代理服务器连接，而不是直接通过 Internet 连接到我的服务器。

问题1：

netTcpBinding 不支持代理。我建议客户为 ISA 服务器安装 MS 防火墙客户端，以通过代理路由所有 winsock 流量，并简单地将新的允许协议添加到代理服务器。显然这是不可能的，因为大楼里的机器被锁得太紧而无法安装这个软件，所以这不是一个选择。（嗯嗯）

问题2：

我有升级到 .NET 4.5 并更改为 netHttpBinding 的好主意，以允许使用 WebSockets 通过 HTTP 进行双工通信，因此代理应该允许它通过。我的服务器是 Windows Server 2012，所以没问题。在 Windows 8 上一切正常。我遇到的问题是，我的客户都没有使用 Windows 8，而且在很多年内都不太可能使用。目前 netHttpBinding 仅在 Windows 8 和 Server 2012 上受支持。（烦人！）

我的问题是，有谁知道我可以用来在 .NET 4 中生成自定义 WCF 绑定的第三方库，这将允许我连接到 .NET 4.5 netHttpBinding，或者任何人都可以向我指出任何其他方式的方向在保持双工通信的同时克服这个代理问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T23:24:06.077

.NET 4.5 仅在 Windows 8 上可用是不准确的。它实际上支持到 Vista SP2。

[http://msdn.microsoft.com/en-us/library/8z6watww(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/8z6watww(v=vs.110).aspx)

# java - Java 在网站上执行操作

> ID：15119177
> 
> 赞同：3
> 
> 时间：2013-02-27T18:08:39.747
> 
> 标签：java

昨天我发布了这个[用 Java 检索数据](https://stackoverflow.com/questions/15103944/retrieving-data-in-java)。我很好奇是否可以在 Web 浏览器打开时运行 Java 程序，然后让它在网站上执行操作。如果我在浏览器上打开了 facebook，它可以在状态框中输入当前时间然后点击发布吗？或者假设我让程序能够从用户那里获取输入（可能使用扫描仪？），然后根据输入，它可以加载谷歌，在搜索栏中输入，然后单击搜索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:13:32.353

您可以通过使用[Selenium](http://docs.seleniumhq.org/)来做到这一点：

> Selenium 使浏览器自动化。而已。你用这种力量做什么完全取决于你。主要是为了测试目的而自动化 Web 应用程序，但当然不仅限于此。无聊的基于 Web 的管理任务也可以（而且应该！）自动化。

这是[文档页面](http://docs.seleniumhq.org/docs/03_webdriver.jsp)中的示例，该页面在 Google 上搜索“奶酪”一词：

```
package org.openqa.selenium.example;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.WebDriverWait;

public class Selenium2Example  {
    public static void main(String[] args) {
        // Create a new instance of the Firefox driver
        // Notice that the remainder of the code relies on the interface, 
        // not the implementation.
        WebDriver driver = new FirefoxDriver();

        // And now use this to visit Google
        driver.get("http://www.google.com");
        // Alternatively the same thing can be done like this
        // driver.navigate().to("http://www.google.com");

        // Find the text input element by its name
        WebElement element = driver.findElement(By.name("q"));

        // Enter something to search for
        element.sendKeys("Cheese!");

        // Now submit the form. WebDriver will find the form for us from the element
        element.submit();

        // Check the title of the page
        System.out.println("Page title is: " + driver.getTitle());

        // Google's search is rendered dynamically with JavaScript.
        // Wait for the page to load, timeout after 10 seconds
        (new WebDriverWait(driver, 10)).until(new ExpectedCondition<Boolean>() {
            public Boolean apply(WebDriver d) {
                return d.getTitle().toLowerCase().startsWith("cheese!");
            }
        });

        // Should see: "cheese! - Google Search"
        System.out.println("Page title is: " + driver.getTitle());

        //Close the browser
        driver.quit();
    }
} 
```

# javascript - 无法读取未定义的属性“顶部” - jQuery

> ID：15119180
> 
> 赞同：0
> 
> 时间：2013-02-27T18:08:48.183
> 
> 标签：javascript, jquery, css, html

我在 Chrome 开发控制台中收到以下错误。

```
Uncaught TypeError: Cannot read property 'top' of undefined jquery.tools.min.js:19
c                                                           jquery.tools.min.js:19
a.extend.show                                               jquery.tools.min.js:19
(anonymous function)                                        jquery.tools.min.js:19
b.event.special.(anonymous function).handle                 jquery.min.js:4
b.event.dispatch                                            jquery.min.js:3
v.handle 
```

如果站点在页面上处于空闲状态，即使没有用户输入，错误的数量也会不断增加。这是什么原因造成的？

选项卡 jQuery：

```
$(document).ready(function () {
  $(this).scrollTop(0);                                                     //send user to top of page

/***********************************************************************************************************

LOAD TAB CONTENT

***********************************************************************************************************/
  $("#tabContent1").load("external/content.html", function () {                                 
    $("#offLogo").css({                                                     //apply CSS to offLogo
      width: "600px",
      margin: "auto",
      padding: "0px 0px 10px 0px"
    });
  });
  $("#tabContent2, #tabContent3, #tabContent4, #tabContent5, #tabContent6, #tabContent7").hide();       //hide tab content

  $("a").hover(function () {
    $(this).toggleClass('hover');                                           //toggle the hover class when user hovers over tab
  });

  $('a[name="#tabContent1"]').click(function () {                           //when user clicks the tab with the name tabContent1 do the following
    $("#tab2, #tab3, #tab4, #tab5, #tab6, #tab7").removeClass('activeTab');               //removes the activeTab class from all other tabs
    $(this).addClass('activeTab');                                          //adds activeTab class to the tab that was clicked
    $("#tabContent1").load("external/content.html", function () {           //loads external html file into content pane of the tab
      $("#offLogo").css({
        width: "600px",
        margin: "auto",
        padding: "0px 0px 10px 0px"
      });
    });
    $("#tabContent1").show();                                               //shows the content of the tab
    $("#tabContent2, #tabContent3, #tabContent4, #tabContent5, #tabContent6, #tabContent7").hide();
  });

  $('a[name="#tabContent2"]').click(function () {
    $("#tab1, #tab3, #tab4, #tab5, #tab6, #tab7").removeClass('activeTab');
    $(this).addClass('activeTab');
    $("#tabContent2").show();
    $("#tabContent1, #tabContent3, #tabContent4, #tabContent5, #tabContent6, #tabContent7").hide();
  });

  $('a[name="#tabContent3"]').click(function () {
    $("#tab1, #tab2, #tab4, #tab5, #tab6, #tab7").removeClass('activeTab');
    $(this).addClass('activeTab');
    $("#tabContent3").show();
    $("#tabContent1, #tabContent2, #tabContent4, #tabContent5, #tabContent6, #tabContent7").hide();
  });

  $('a[name="#tabContent4"]').click(function () {
    $("#tab1, #tab2, #tab3, #tab5, #tab6, #tab7").removeClass('activeTab');
    $(this).addClass('activeTab');
    $("#tabContent4").show();
    $("#tabContent1, #tabContent2, #tabContent3, #tabContent5, #tabContent6, #tabContent7").hide();
  });

  $('a[name="#tabContent5"]').click(function () {
    $("#tab1, #tab2, #tab3, #tab4, #tab6, #tab7").removeClass('activeTab');
    $(this).addClass('activeTab');
    $("#tabContent5").show();
    $("#tabContent1, #tabContent2, #tabContent3, #tabContent4, #tabContent6, #tabContent7").hide();
  });

  $('a[name="#tabContent6"]').click(function () {
    $("#tab1, #tab2, #tab3, #tab4, #tab5, #tab7").removeClass('activeTab');
    $(this).addClass('activeTab');
    $("#tabContent6").show();
    $("#tabContent1, #tabContent2, #tabContent3, #tabContent4, #tabContent5, #tabContent7").hide();
  });

  $('a[name="#tabContent7"]').click(function () {
    $("#tab1, #tab2, #tab3, #tab4, #tab5, #tab6, #tab7").removeClass('activeTab');
    $(this).addClass('activeTab');
    $("#tabContent7").show();
    $("#tabContent1, #tabContent2, #tabContent3, #tabContent4, #tabContent5, #tabContent6").hide();
  }); 
```

提示：

```
 $(function () {
    $(document).tooltip();  //shows title attribute as a tooltip
  }); 
```

当您将鼠标移出窗口（例如在 Chrome 地址栏上）然后将鼠标移到选项卡上时，您会收到错误消息，但如果鼠标停留在页面内并且将鼠标悬停在选项卡上，则不会发生错误。在一些帮助下，这已缩小为 tooptip 功能的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:33:05.267

我在这里做了一个测试用例：

[http://jsfiddle.net/3MxL2/1/](http://jsfiddle.net/3MxL2/1/)

```
$("a").tooltip(); 
```

看起来 jquery tools 工具提示插件只是一个问题，它不允许您绑定到文档对象。尝试使用通用的“a”标签进行绑定，它应该可以工作。仍然存在一些样式错误，但它应该可以解决当前的问题。

# python - Python子进程将新行写入stdin，直到进程结束

> ID：15119188
> 
> 赞同：3
> 
> 时间：2013-02-27T18:09:16.687
> 
> 标签：python, shell, subprocess

我使用创建了一个子流程

```
subprocess.Popen(shlex.split(command), stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE) 
```

`\n`它调用的命令会打印各种信息，然后在打印更多信息之前等待。最终，当`\n`按下足够的次数时，该过程将结束。我需要能够以编程方式模拟按下`\n`直到进程结束，以及捕获所有输出。我不希望将输出打印到终端。我希望它被返回并设置为一个变量。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:23:57.667

如果你只需要写`stdin`一次，你可以使用

```
proc = subprocess.Popen(..., stdin = subprocess.PIPE)
proc.stdin.write('\n') 
```

但是，如果您需要等待提示或以更复杂的方式与子进程交互，请使用[pexpect](http://www.noah.org/wiki/pexpect)。（pexpect 适用于任何 POSIX 系统，或带有 Cygwin 的 Windows。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:45:18.707

试试这个方法

```
from subprocess import Popen, PIPE
import shlex
with open (filename, 'w') as fileHandle
proc = Popen(shlex.split(command), stdin = PIPE, stdout = PIPE, stderr  = PIPE)
out, err = proc.communicate(input = '\n')
print out, err 
```

# php - 如何将 $_POST[''] 设置为来自 mysql_fetch 的数据？

> ID：15119191
> 
> 赞同：0
> 
> 时间：2013-02-27T18:09:24.330
> 
> 标签：php, post

我有下面的代码，列出了列中的所有数据：名字和姓氏，我也想要它，这样当他们被点击时，它会带你到一个“个人资料”页面，在那里你可以看到他们的其余数据。我已经直接创建了一个指向 profile.php 页面的链接，在此之前我将其设置为 $_POST = id，我希望拥有它，以便在用户使用时将 $_POST['id'] 更改为点击链接。

```
<?PHP
$result = mysql_query("SELECT id, firstname, surname FROM members WHERE createdby = '" . $_SESSION['myusername'] ."'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
while($row = mysql_fetch_row($result))
{
$id=$row[0];
$_POST['id'] = $id;
echo ("<a href=profile.php>".$row[1]." ".$row[2]."</a></br>");
}
?> 
```

它可以很好地加载页面并且一切正常，只是它没有将 $_POST 设置为 $id。

编辑：我现在使用 $_GET["id"] 有效，但它只会回显我不能在查询中使用它的值：

```
$id=$_GET["id"]; 

$sql="SELECT * FROM $tbl_name WHERE id='$id'";
$result=mysql_query($sql); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:12:15.137

设置值 for`$_POST["id"]`将在该页面上起作用，但这并不意味着当您重定向到另一个页面时，您的 $_POST 值将自动发送到该页面。相反，您可以为此尝试 $_GET 。您可以将链接修改为

```
profile.php?id=$id 
```

在您的`profile.php`页面上，您可以使用`$_GET["id"]`而不是`$_POST`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:12:09.210

使用 session 代替 post --`$_SESSION['id']`

# windows-7 - Win 7：基于文件名创建目录的 CMD 批处理文件

> ID：15119194
> 
> 赞同：1
> 
> 时间：2013-02-27T18:09:27.717
> 
> 标签：windows-7, batch-file, directory, cmd, filenames

我正在处理 Win7 环境中的 CMD 行批处理文件，它将根据目录中列出的文件名创建目录。

我正在使用此代码，但创建的输出是部分且不完整的

```
 setlocal enabledelayedexpansion
 for /r %%i in (*.wav) do (
     set filename1=%%i
     set folder1=!filename1:~4,10!
     mkdir !folder1!
      )

 pause 
```

我将此脚本保存为源目录中的文本格式的 CMD 文件，在本地硬盘驱动器上，尽管它位于子目录中。目录输出偏断，输出乱码，创建的目录数与文件数不匹配，创建的目录似乎有嵌套。我对此进行了研究，似乎无法找到明确的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:54:32.757

目前尚不完全清楚您要完成的工作是什么。您是否尝试在包含 wav 文件的同一目录中创建一个目录，只是没有 .wav 扩展名？如果是这样，则您缺少一些引号，并且您正在剥离文件名的错误结尾。如果这就是你想要完成的，它实际上可以用一个命令来完成，不需要批处理脚本。在命令提示符下键入：

```
for /r %I in (*.wav) do mkdir "%~pnI" 
```

当然，如果您仍希望在批处理脚本中使用它，请使用`%%I`双`%%~pnI`百分比而不是单百分比。有关如何工作`help for`的说明，请参阅最后几页。`%%~pnI`

# html - 将 2 个 div 放在同一行

> ID：15119202
> 
> 赞同：0
> 
> 时间：2013-02-27T18:10:01.570
> 
> 标签：html, css

更新：我得到了答案......非常感谢布拉德（在评论中）

更新 2：我不知道如何在评论中给出最佳答案

更新 3：我正在给迈克尔最好的答案，因为布拉德爵士没有给出答案是答案部分

我正在努力在同一行上有 2 个 div，但徒劳无功

[提琴手](http://jsfiddle.net/LgADB/)

```
 <br /><div id='topdiv1'><div id='topdiv3'><div id='div23 '>
<img src="http://i.udm4.com/mac/48/163/163483.png" /></div><span class="tab"></span>
 <img src='http://i.udm4.com/mac/48/163/163483.png'/></div></div>

span.tab{
padding: 0 50px; /* Or desired space*/
}
.div23 
{
display: inline
    float:left;
  }
   .span.tab 
{  
   display: inline
    float:left;
}
   .topdiv1 
  {
   display: inline
float:left;
  }
.topdiv3
  {
        display: inline
          float:left;
   } 
```

我不知道我哪里出错了。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:19:37.767

您有多个语法错误。

在 HTML 中你有，在 CSS 中你用 .

这 。字符是指一个类，而不是一个 ID。要引用 ID，您需要使用 #。或者您可以将 id="x" 切换为 class="x" 并单独保留 css。

您的 div 结构也嵌套不正确。以下代码解决了您的问题。

[http://jsfiddle.net/LgADB/4/](http://jsfiddle.net/LgADB/4/)

```
<div id='topdiv1'>

<div id='topdiv3'>
    <img src='http://i.udm4.com/mac/48/163/163483.png'/>
</div><!-- end topdiv3 -->

<div id='div23 '>
    <img src="http://i.udm4.com/mac/48/163/163483.png" />
</div><!-- end div23 -->

<span class="tab"></span>
</div><!-- end topdiv1 -->

span.tab{
    padding: 0 50px; /* Or desired space*/
}

#topdiv3 {
    float: left;
}

#div23 {
    float: left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:12:40.560

```
<div style="display:inline-block; margin-right:50px"><img src="http://i.udm4.com/mac/48/163/163483.png" /></div>
<div style="display:inline-block;"><img src='http://i.udm4.com/mac/48/163/163483.png'/></div> 
```

或者

```
<div style="float:left; margin-right:50px"><img src="http://i.udm4.com/mac/48/163/163483.png" /></div>
<div style="float:left;"><img src='http://i.udm4.com/mac/48/163/163483.png'/></div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:30:08.683

你有没有尝试设置宽度

```
<div>

<div style="float:left;width:10%"><img src='http://i.udm4.com/mac/48/163/163483.png'/></div>
<div style="float:left;width:10%"><img src='http://i.udm4.com/mac/48/163/163483.png'/></div>

</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:18:55.933

你可以用更少的 CSS 实现相同的结果。[这](http://jsfiddle.net/LgADB/3/)可以解决问题，尽管它可能不是您正在寻找的解决方案。

```
img {
    margin-right:50px;
    float:left;
} 
```

编辑：当然，您需要使`img`选择器更具体；否则，您将设置`<img/>`页面上的所有元素。

# php - 如何在运行 simplexml_load_file() 之前检查 XML 文件是否正确

> ID：15119203
> 
> 赞同：3
> 
> 时间：2013-02-27T18:10:05.757
> 
> 标签：php, api, simplexml

我使用 PHP 的`simplexml_load_file()`函数来调用一个 API，该 API 根据我发送的时间戳返回更改的结果。

因此，API 将仅返回自我的时间戳以来已更改的结果。我遇到的问题是，如果时间戳太快并且 API 没有返回结果，那么它不会返回正确的 XML 文件，而是只会返回一个空白页。

这导致了各种各样的问题`simplexml_load_file`

这是我可以运行的简单测试...

```
$xml = 'http://api.rescuegroups.org/rest/?key=CZivWWGD&type=orgs&limit=300&updatedAfter=1361941202&startPage=1';

$xmlObj = new SimpleXMLElement($xml, NULL, TRUE); 
```

这导致...

```
Warning: SimpleXMLElement::__construct(): http://api.rescuegroups.org/rest/?key=CZivWWGD&type=orgs&limit=300&updatedAfter=1361941202&startPage=1:1: parser error : Document is empty in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9

Warning: SimpleXMLElement::__construct(): in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9

Warning: SimpleXMLElement::__construct(): ^ in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9

Warning: SimpleXMLElement::__construct(): http://api.rescuegroups.org/rest/?key=CZivWWGD&type=orgs&limit=300&updatedAfter=1361941202&startPage=1:1: parser error : Start tag expected, '<' not found in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9

Warning: SimpleXMLElement::__construct(): in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9

Warning: SimpleXMLElement::__construct(): ^ in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9

Fatal error: Uncaught exception 'Exception' with message 'String could not be parsed as XML' in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php:9 Stack trace: #0 E:\Server\htdocs\labs\freelance\dogAPI\testorg.php(9): SimpleXMLElement->__construct('http://api.resc...', 0, true) #1 {main} thrown in E:\Server\htdocs\labs\freelance\dogAPI\testorg.php on line 9 
```

现在，如果我向 API 传递一个时间戳，该时间戳在有结果的地方更远，那么它将返回一个完美的 XML 文档。

我正在寻找一种方法来防止这种令人讨厌的错误以某种方式发生？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:14:01.593

[simplexml_load_file](http://php.net/manual/en/function.simplexml-load-file.php)：

> 使用 libxml_use_internal_errors() 抑制所有 XML 错误，然后使用 libxml_get_errors() 对其进行迭代。
> 
> 返回 SimpleXMLElement 类的对象，其属性包含 XML 文档中保存的数据，如果失败则返回 FALSE。

因此，抑制错误并检查 FALSE 以检测查询何时未按预期进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:14:11.790

```
$xml = @simplexml_load_file('http://api.rescuegroups.org/rest/?key=CZivWWGD&type=orgs&limit=300&updatedAfter=1361941202&startPage=1');
if(false !== $xml)
{
    // Do anything with xml
} 
```

如果有错误`@`隐藏它并返回 false

# d3.js - 可以为连接到 x 轴刻度的 D3.js 图形使用背景渐变吗？

> ID：15119205
> 
> 赞同：1
> 
> 时间：2013-02-27T18:10:16.970
> 
> 标签：d3.js

我希望在多天的过程中绘制一些基于时间的数据（使用简单的折线图）。我想将一天中的时间呈现为折线图背景中的颜色渐变。每天的中午是白色的，午夜几乎是黑色的，而其间的所有其他时间都是介于两者之间的平滑灰度。

我可以通过在我的线条之前绘制矩形来非常非常笨拙地做到这一点，但它有以下问题： 1\. 没有数据点的小时不会得到矩形，在我的背景中留下间隙 2\. 过渡不平滑，但踩

似乎填补空白的最佳方法是锁定沿 x 轴的刻度，因为无论数据点如何，这些刻度都是有规律地间隔开的。有没有办法让我应用渐变（CSS 或 SVG）以及刻度线，从一个渐变平滑地流向另一个（也就是说，一个渐变结束的位置和另一个渐变开始的位置之间没有间隙，也没有任何重叠)? 如果我添加或删除数据，渐变应该相应地改变。

非常感谢任何和所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T20:31:20.407

just define the gradient in a `<def>` section, and place rectangles aligned with the days you are charting. set the fill attribute to `url("#the_gradient")`. have a look here [http://www.w3.org/TR/SVG/pservers.html](http://www.w3.org/TR/SVG/pservers.html)

# ios - Xcode4.2：上传到 iTunes 商店时出错

> ID：15119211
> 
> 赞同：1
> 
> 时间：2013-02-27T18:10:28.750
> 
> 标签：ios, xcode, ios5, xcode4, xcode4.2

嘿，试图将我的应用程序提交到 iTunes。它通过了验证，但是当我提交它时显示错误：

```
an error occurred uploading to the iTunes store 
```

![在此处输入图像描述](../Images/442f86f714f9f8e1ad1ca9bb0c998783.png)

我已经尝试了将近一天在搜索此问题时发现的所有可能的解决方案。

```
I tried these lines without any success 
cd /System/Library/Frameworks/JavaVM.framework/Versions
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5.0 
```

我使用 xcode 4.2 和雪豹 Mac OS 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:37:43.250

此错误表示上传过程有问题。我不相信您可以在不与 Apple 联系的情况下修复它。

我曾经遇到过这个错误（几个月前）。它是由 Apple 当天的服务器端问题引起的，但今天 Apple 服务器运行正常，没有任何问题*（使用 Xcode 4.6 进行了尝试）*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T12:03:23.143

只需使用最新的应用程序加载器来提交应用程序。对于 Snow Leopard Mac OS，您可以从[此处](https://itunesconnect.apple.com/apploader/ApplicationLoader_2.5.dmg)下载 Application Loader 2.5以查看问题所在。如果没有其他问题，您可能会收到此错误：

> 此捆绑包无效。Apple 目前不接受使用此版本的 SDK xcode 构建的应用程序。

我也在努力使用 Xcode 4.2 提交应用程序，因为我的 macbook 太旧了，无法升级到 Lion 并安装 Xcode 4.6。似乎 Xcode 4.2 太旧而无法支持，最好的解决方案是安装 Xcode 4.6。

# email - 在端口 2525 上设置 hMailServer SMTP

> ID：15119213
> 
> 赞同：1
> 
> 时间：2013-02-27T18:10:33.867
> 
> 标签：email, smtp, windows-server-2008, mail-server, hmail-server

我目前在 windows server 2008 vps 上有一个工作的 hmailserver。我的服务器目前像往常一样在端口 25 上侦听。几天以来，我一直在从阻止端口 25 的酒店和奇怪的 isp 发送电子邮件时遇到问题。我已经通过让我的 smtp 在端口 2525 上侦听来解决了非 vps 服务器上的这个问题。

问题是我真的不知道如何让 hmailserver 监听端口 2525。我浏览了 hmailserveradministrator 选项并在谷歌上搜索，但我找不到与该主题相关的任何内容。

有任何想法吗？

非常感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-25T19:00:19.333

您好，您可以让 hMailServer 同时监听两个端口。

设置 > 高级 > TCP/IP 端口 >

SMTP, 0.0.0.0, 25

SMTP, 0.0.0.0, 2525

# javascript - jQuery $.post 不返回数据

> ID：15119222
> 
> 赞同：0
> 
> 时间：2013-02-27T18:11:04.073
> 
> 标签：javascript, jquery, ajax, json, post

我正在使用 $.post 通过 ajax 将表单发送到 PHP 页面，该页面返回 JSON 数据。曾几何时，它运行良好，并且函数（数据）正常执行。不知何故，我把它弄坏了，现在它甚至没有触及函数（数据）。我已经尝试撤消我所做的大部分工作，但我仍然找不到问题所在。

这是脚本：

```
$("#modifyhome").submit(function(event) {
    if($("#modifyhome").valid()) {  
        event.preventDefault();

        var $form = $( this ),
            title = $form.find('input[name="title"]').val(),
            content = $form.find('textarea[name="content"]').val();

        $.post("?action=page-accueil", {"title": title, "content": content},
            function(data) {            
                if(data['error'] == 1)
                {           
                    $().message(data['message']);
                    $("div.jquery-message").effect("shake", {times: 3}, 900);
                }
                else if(data['error'] == 0)
                {           
                    $().message(data['message']);
                    $("div.jquery-message").effect("bounce", {times: 3}, 900);
                }
                else
                {           
                    $().message("Erreur de connexion au serveur : veuillez r&eacute;essayer.");
                    $("div.jquery-message").effect("shake", {times: 3}, 900);
                }
            }, "json"
        );
    }
    else
    {
        $("[id^=qtip-]").effect("pulsate", {times: 3}, 600);
        return false;
    }
}); 
```

这是 PHP 页面 (?action=page-accueil) 返回的内容：

```
{"error":0,"message":"Page modifi&eacute;e."} 
```

这一切都检查为有效的 JSON，但就好像 jQuery 出于某种原因无法识别它一样。任何帮助是极大的赞赏 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:29:16.773

你不清楚问题是什么。一开始你说

> 不知何故，我把它弄坏了，现在它甚至没有触及函数（数据）

但是你说 jQuery 没有识别你的 JSON，这意味着回调函数被调用了。您需要测试流程的每个阶段以发现错误。在这种情况下，必须使用浏览器控制台进行调试。

测试用例：

1.  服务器是否返回任何内容？如果不

    *   php代码有错误吗？可能返回 500 错误或返回 OK，但错误消息为字符串。
    *   是否存在同源问题？也许是从 HTTP -> HTTPS？
2.  如果服务器正在返回一些东西，但它没有被正确解析。

    *   返回的数据是有效的 JSON 吗？对于 PHP，您应该使用[json_encode](http://www.php.net/manual/en/function.json-encode.php)函数（如果可用）或类似的函数。jQuery 方面有 jQuery.parseJSON()
    *   响应类型的标头有问题吗？在这种情况下，您需要使用普通的 $.ajax 并将 beforeSend 参数设置为类似于 beforeSend: function(xhr){ xhr.setRequestHeader("Accept", "text/javascript") }。您将需要进一步研究此选项。

要测试其中任何一个，您必须熟悉浏览器控制台。[Chrome 网络面板](https://developers.google.com/chrome-developer-tools/docs/network) 或[Firebug 网络选项卡](http://getfirebug.com/network)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-27T18:21:09.387

我以前也遇到过这个问题，具体原因我也不清楚。但我有一个可行的解决方案。

```
$.post("?action=page-accueil", 
    {"title": title, "content": content},
    function(data) {
        data = eval("("+data+")");
        //.... Then continue it
}); 
```

或者，`.parseJSON()`如果您不想使用，请使用函数将字符串读取为 JSON`eval()`

```
$.post("?action=page-accueil", 
    {"title": title, "content": content},
    function(data) {
        data = $.parseJSON(data);
        //.... Then continue it
}); 
```

# wordpress - 无法在函数内获取 var 值

> ID：15119225
> 
> 赞同：0
> 
> 时间：2013-02-27T18:11:16.473
> 
> 标签：wordpress, function, http-post-vars

我试图`field_1`在输入文本中获取价值，我尝试了这段代码，但它不起作用。

```
function bbg_add_reg_field() {
  $field_1= $_POST["signup_username"];  
  echo '<input name="field_1" id="field_1" value="$field_1" type="text">';  
}
add_action( 'bp_before_registration_submit_buttons', 'bbg_add_reg_field' ); 
```

输入文本内显示的回声值是`$field_1`

该值应该是一个名称，例如`peter`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:14:50.723

在 PHP 中，只有当它是双引号字符串时，您才能插入字符串（使用 $var 将变量添加到字符串中）。

来自 PHP 文档

```
// Outputs: Variables do not $expand $either
echo 'Variables do not $expand $either'; 
```

相反，你可以这样做

```
echo '<input name="field_1" id="field_1" value="' . $field_1 . '" type="text">'; 
```

哦，别忘了 htmlspecialchars

```
echo '<input name="field_1" id="field_1" value="' . htmlspecialchars($field_1) . '" type="text">'; 
```

您也可以使用 PHP Heredoc 实现相同的目的。像这样

```
echo <<<EOF
<input name="field_1" id="field_1" value="$field_1" type="text">
EOF; 
```

# sql - 使用 in 子句错误更新表

> ID：15119227
> 
> 赞同：0
> 
> 时间：2013-02-27T18:11:28.933
> 
> 标签：sql, oracle

```
UPDATE
  TABLE1 a,
  TABLE2 b
SET
  a.COL1 = 'VALUE'
WHERE
  a.FK = b.PK
  AND b.COL2 IN ('A subquery') 
```

如果我正在使用此更新语句并且 IN 子句中的子查询不返回任何行，则会出现错误。我该如何避免呢？（甲骨文 10g）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:25:29.347

你的子查询是引号吗？

```
UPDATE
  TABLE1 a,
  TABLE2 b
SET
  a.COL1 = value
WHERE
  a.FK = b.PK
  AND b.COL2 IN (
                 SELECT col2
                 FROM ...
                 WHERE ...
                ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:14:24.107

```
UPDATE
  TABLE1 a
SET
  a.COL1 = 'VALUE'
WHERE
  a.FK IN (SELECT b.PK FROM b WHERE b.COL2 in ....) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:14:25.183

您可能可以将其重写为 EXISTS 查询，具体取决于子查询的确切详细信息：

```
UPDATE TABLE1 a, TABLE2 b SET a.COL1 = 'VALUE' 
WHERE a.FK = b.PK AND EXISTS (select 1 from OTHERTABLE O where B.COL2=O.COL2) 
```

# ssl - TortoiseSvn 在 Windows 7 上突然引发“OPTIONS SSL 握手失败：SSL 错误：sslv3 警报非法参数”

> ID：15119237
> 
> 赞同：2
> 
> 时间：2013-02-27T18:12:01.647
> 
> 标签：ssl, svn, windows-7, tortoisesvn

我的一个客户在使用 TortoiseSVN 时遇到了麻烦。到目前为止它工作正常。她在 2013 年 2 月 23 日星期四进行了最后一次提交，但现在她收到以下错误：

```
OPTIONS SSL handshake failed: SSL error: sslv3 alert illegal parameter 
```

她无法再访问存储库。没有更新，没有结帐，没有日志等。

很难定位问题。它显示为 tsvn 1.7.4 和 1.7.11

*   她**不能**将 tsvn 与 ProjectRepository 一起使用
*   她**不能**在 ProjectRepository中使用 svn 命令行客户端 ( [http://www.sliksvn.com/en/download )](http://www.sliksvn.com/en/download)

*   她**可以**将 tsvn 与另一台服务器上的 PlaygroundRepository 一起使用

*   她**可以**使用 IE 和 Firefox 访问 ProjectRepository
*   她**可以**使用 SmartSvn 访问 ProjectRepository

*   我**可以**在他们的网络中将 tsvn 与我的 macbook 中的 ProjectServer 一起使用。

我完全卸载/重新安装了 tsvn -没有成功我删除了 %appdata%\Roaming\Subversion -没有成功

作为一种绝望的行为，我安装了 smartsvn 让她再次工作，但这不是解决方案。

它必须是 tsvn、她的机器和 ProjectRepository/Server 的组合。她的机器与另一台服务器上的 PlaygroundRepository 一起工作。

任何想法都非常受欢迎。特别是因为它上周与 tsvn 1.7.4 一起工作。

所以唯一可能有变化的是windows box上的一些更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:53:31.890

检查客户端上是否安装了[MS012-006](http://technet.microsoft.com/en-au/security/bulletin/ms12-006)。那个热修复破坏了很多东西。回滚并查看连接是否成功。

# regex - Scala 正则表达式（用双引号分隔的字符串）

> ID：15119238
> 
> 赞同：7
> 
> 时间：2013-02-27T18:12:04.377
> 
> 标签：regex, scala, double-quotes

我是斯卡拉的新手。我正在尝试匹配由双引号分隔的字符串，但我对以下行为感到有些困惑：

如果我执行以下操作：

```
val stringRegex = """"([^"]*)"(.*$)"""
val regex = stringRegex.r
val tidyTokens = Array[String]("1", "\"test\"", "'c'", "-23.3")
tidyTokens.foreach {
    token => if (token.matches (stringRegex)) println (token + " matches!")
} 
```

我明白了

```
"test" matches! 
```

否则，如果我执行以下操作：

```
tidyTokens.foreach {
    token => token match {
        case regex(token) => println (token + " matches!")
        case _ => println ("No match for token " + token)
    }
} 
```

我明白了

```
No match for token 1
No match for token "test"
No match for token 'c'
No match for token -23.3 
```

为什么在第二种情况下“测试”不匹配？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T18:26:04.113

取你的正则表达式：

```
 "([^"]*)"(.*$) 
```

当用 编译时`.r`，这个字符串会产生一个`regex`对象——如果它匹配它的输入字符串，则必须产生**2 个**捕获的字符串——一个用于`([^"]*)`，另一个用于`(.*$)`. 你的代码

```
 case regex(token) => ... 
```

应该反映这一点，所以也许你想要

```
 case regex(token, otherStuff) => ... 
```

要不就

```
 case regex(token, _) => ... 
```

为什么？因为`case regex(matchedCaputures...)`语法有效，因为`regex`它是一个带有`unapplySeq`方法的对象。 `case regex(token) => ...`（大致）翻译为：

```
 case List(token) => ... 
```

`List(token)`返回的内容在哪里`regex.unapplySeq( inputString )`：

```
 regex.unapplySeq("\"test\"") // Returns Some(List("test", "")) 
```

您的正则表达式确实与字符串匹配，`"test"`但在`case`语句中，正则表达式提取器的`unapplySeq`方法返回一个包含**2 个**字符串的列表，因为这就是正则表达式所说的捕获的内容。这很不幸，但是编译器在这里帮不了你，因为正则表达式是在运行时从字符串编译的。

一种替代方法是使用非捕获组：

```
 val stringRegex = """"([^"]*)"(?:.*$)"""
 //                             ^^ 
```

然后你的代码就可以工作了，因为`regex`现在将是一个提取器对象，它的 `unapplySeq`方法只返回一个捕获的组：

```
 tidyTokens foreach { 
    case regex(token) => println (token + " matches!")
    case t => println ("No match for token " + t)
 } 
```

[查看有关Extractor Objects](http://www.scala-lang.org/node/112)的教程，以更好地了解`apply`/ `unapply` /的`unapplySeq`工作原理。

# c++ - 下载和使用 gmp Xcode 4.4

> ID：15119242
> 
> 赞同：0
> 
> 时间：2013-02-27T18:12:15.673
> 
> 标签：c++, gmp

我已经看到与此相关的其他问题，但我在基础知识方面遇到了麻烦。我的计算机和编程知识非常有限，请多多包涵。

我在 MacBook Pro 上使用 Xcode4.4 for c++，我正在尝试使用 gmp 库。我已经访问了 gmp 站点： [http](http://gmplib.org) : //gmplib.org 并单击了下载 gmp-5.1.tar.lz，但下载的内容似乎非常神秘，我不确定如何继续。我知道，一旦您在计算机上获得了该库，您就可以将其链接到您的项目中并使用头文件来使用该库。我也不知道该怎么做。

谁能带我完成下载 gmp 库然后在 Xcode 上的 c++ 项目中使用它的过程？

对此的任何其他评论/建议也会很棒。

谢谢。

# c++ - 没有命名空间 std 的友元重载运算符

> ID：15119243
> 
> 赞同：1
> 
> 时间：2013-02-27T18:12:27.330
> 
> 标签：c++, namespaces, std, friend, extraction

只是想知道是否有人能指出我正确的方向。如果我包含命名空间std，我有一个朋友提取运算符可以工作；但如果我不这样做会失败。谁能给我一个提示？

```
ostream& operator << (ostream &out, coins &value) 
```

这也是一个朋友函数，所以我在我的functions.h文件（作为原型）和我的functions.cpp文件（逻辑）中的class.h文件（作为朋友）中有这个。

我试过了

std::ostream& 运算符.... std::ostream& 运算符 std::<< （等）

但我只是看不出我哪里出错了。我的编译器一直告诉我'ostream 没有命名类型'

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:18:21.957

它`ostream`存在于`std`命名空间中，不要这样做`std::<<`（这甚至没有意义！）。尽量少用霰弹枪的方法来编程；也就是说，在它起作用之前，不要只是尝试随机的东西。该错误告诉您`ostream`（不合格）是问题所在，因此您必须先解决该问题。

```
#include <iostream>

struct coins
{
    friend std::ostream& operator<<(std::ostream& sink, const coins& value);
};

std::ostream& operator<<(std::ostream& sink, const coins& value)
{
    sink << "doing coins output";
    return sink;
}

int main()
{
    coins c;
    std::cout << c << std::endl;
} 
```

顺便说一下，这是一个插入运算符，因为您将数据插入到流中。提取将是`>>`.

# android - Monodroid - Excel 文件

> ID：15119244
> 
> 赞同：0
> 
> 时间：2013-02-27T18:12:28.657
> 
> 标签：android, excel, mono

我想从一个使用 Mono for Android 的 android 应用程序创建小型 Excel 工作表。我尝试同时使用 EPPlus 和 ExcelLibrary .NET 库，但是在构建项目时遇到了问题：

```
C:\Program Files (x86)\MSBuild\Xamarin\Android\Xamarin.Android.Common.targets(2,2): Error: Exception while loading assemblies: System.IO.FileNotFoundException: Could not load assembly 'System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. Perhaps it doesn't exist in the Mono for Android profile? 
```

对于通过 Mono for Android 操作 Excel 文件的这种或其他方式是否有任何修复？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:13:07.897

您似乎正在尝试将预构建的 .NET 4.0 程序集引用到您的 Mono for Android 项目中。你不能可靠地做到这一点（如果幸运的话，有时它会起作用）。MonoTouch 和 Mono for Android 没有 System.Drawing 程序集，因此您不能使用链接到它的库。

您需要做的是为 EPPlus 或 ExcelLibrary 库创建一个新项目，并使用 Mono for Android Library Project 类型。您可能还需要对项目进行一些修改，使其不使用 Mono for Android 所没有的 System.Drawing 部分（它有一些像 System.Drawing.RectangleF 和 SizeF ，但缺少大部分内容）。

我打算使用[npoi](https://github.com/tonyqus/npoi)项目（它的许可证比 EPPlus 更受欢迎）为 MonoTouch 做这件事，但是一直忙于其他事情。

我有一个 npoi 的分支，我正在这里清理 API：[https ://github.com/jstedfast/npoi/tree/enumification](https://github.com/jstedfast/npoi/tree/enumification)

一旦我完成并在上游合并，我的计划是创建一个新分支，我将在其中将库移植到 MonoTouch 和 Mono4Android 使用的 .NET 子集。我可能会称它为“移动”或其他东西。

同时，快速而肮脏的解决方法是创建一个新的 Mono for Android Library 项目，以与 npoi 相同的方式将所有源文件添加到其中，然后尝试构建。它会失败，但错误将为您提供一个很好的起点，以便确定要无情地删除库的哪些部分。继续这样做，直到它编译。

如果您使用我上面链接到的任何一个 npoi 存储库，我已经完成了一些工作来制作 font.metrics 和其他一些我无法为 MonoTouch/Android 正确构建的资源文件，所以会有与使用 1.2.5 之类的版本相比，要做的工作少一些。

# php - php mysql更新表格

> ID：15119245
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:12:31.210
> 
> 标签：php

有代码：

```
$id = $_POST['id'];
$name = $_POST['name'];
$surname = $_POST['surname'];
$mail = $_POST['mail'];

$sql = "UPDATE emps SET";
$moresql = '';

if(isset($name) && !empty($name)) {
    $moresql .= " name = '$name'";  
}

if(isset($surname) && !empty($surname)) {
    if ($moresql) $moresql .= ',';
    $moresql .= " surname = '$surname'";    
}

if(isset($mail) && !empty($mail)) {
    if ($moresql) $moresql .= ',';
    $moresql .= " mail = '$mail'";  
}

$sql .= $moresql;
$sql .= " WHERE Id = '$id'"; 
```

在此代码中，我可以更新例如：姓名并保留姓氏和电子邮件中的现有值或更新姓氏并留下姓名并通过电子邮件发送现有值

但我也想一次，例如：更新姓名和姓氏并留下电子邮件现有值或更新姓氏和电子邮件并留下姓名现有值或更新所有字段。如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:24:08.513

```
<form action="settings.php" method="POST">
       <input type="text" name="full name" />
       <input type="text" name="email" />
       ........ (and more)
</form>

<?php
  if($_POST)
  {
   if(isset($_POST['full name'])) { //Update full name of user and redirect to the settings page on success. }
   else { //Redirect and show errors! }
   if(isset($_POST['email'])) { //Update email of user and redirect to the settings page on success. } 
   else { //Redirect and show errors! }      
  }
?> 
```

或者您可以使用 PHP 的数组函数在其中设置 MySql 查询，如 ---

```
<?php
  mysql_query("
    UPDATE table name SET 
    //Loading different values from the array using foreach() php function.
  ");
?> 
```

相似且有用：

```
if(isset($_POST['foo']) && !empty($_POST['foo'])){/*do stuff*/} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:17:19.180

```
SET ... name=name, email=email 
```

这样表将保留以前的值（col_name=col_colname）

在 PHP 中

```
if(isset($mail) && !empty($mail)) 
{
    if ($moresql) $moresql .= ',';
    $moresql .= " mail = '$mail'";  
}
else
{
 if ($moresql) $moresql .= ',';
    $moresql .= " mail = mail"; 
} 
```

# static - 如何在asp.net web forms c#的web方法中获取客户端证书？

> ID：15119246
> 
> 赞同：0
> 
> 时间：2013-02-27T18:12:31.653
> 
> 标签：static, request, client, certificate, webmethod

我将 IIS 配置为从客户端获取证书。而且我可以轻松地在事件处理程序中获取客户端证书，例如 Page_Load

```
HttpClientCertificate cert = Request.ClientCertificate; 
```

现在我需要创建 Web 方法，该方法将从证书中获取客户端名称并为该客户端返回数据。但是如何在我无权访问请求的静态 Web 方法中获取客户端证书？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:33:12.473

在任何方法中，包括在静态方法中，您都可以使用`HttpContext.Current`. 如果这是非空的，那么您可以访问该`Request`属性。如果*它*不为空，那么您可以访问该`ClientCertificate`属性。

当然，它可能是空的...

# objective-c - 我没有正确执行我的推送/弹出方法，有人可以帮助我吗？

> ID：15119248
> 
> 赞同：0
> 
> 时间：2013-02-27T18:12:39.580
> 
> 标签：objective-c, nsmutablearray

所以我正在开发一个计算器应用程序，我的代码目前没有正确执行。我知道出了什么问题，但我不确定如何解决它。目前，当我按下添加按钮时，我的 ViewController.m 带有当前代码：

```
#import "ViewController.h"
#import "CalcLogic.h"

@interface ViewController ()
@property (weak, nonatomic) IBOutlet UILabel *display;
@property (weak, nonatomic) IBOutlet UILabel *lastOperation;
@property (strong, nonatomic) CalcLogic* logic;

@end

@implementation ViewController
double result = 0;
//Last operation entered into the calculator
NSString* lastEntered;
@synthesize logic;

-(IBAction)numPressed:(UIButton *)sender{
    BOOL hasBeenCleared = [self.lastOperation.text isEqualToString:@"Clear"];

    if ([self.display.text isEqualToString:@"0."]) {
        self.display.text = sender.currentTitle;;
        self.lastOperation.text = sender.currentTitle;;
        [self.logic pushNumber:[sender.currentTitle doubleValue]];
    }
    else{
        self.display.text = [self.display.text stringByAppendingString:sender.currentTitle];
        if (self.lastOperation.text.length > 1 && hasBeenCleared != TRUE) {
            self.lastOperation.text = [self.lastOperation.text stringByAppendingString:sender.currentTitle];
        }
        else {
            self.lastOperation.text = sender.currentTitle;
        }
        [self.logic pushNumber:[sender.currentTitle doubleValue]];
    }
}

-(IBAction)clearPressed:(UIButton *)sender{
    self.display.text = @"0.";
    self.lastOperation.text = @"Clear";
    [self.logic clearStack];
    result = 0;
}

-(IBAction)operation:(UIButton *)sender{
    [logic pushOperation:sender.currentTitle];
    NSString* resultString = [NSString stringWithFormat:@"%g", result];
    self.display.text = resultString;
    if ([self.lastOperation.text isEqualToString:@"Clear"]) {
        self.lastOperation.text = @"";
        self.lastOperation.text = [self.lastOperation.text stringByAppendingString:sender.currentTitle];
    }
    else{
        self.lastOperation.text = [self.lastOperation.text stringByAppendingString:sender.currentTitle];
    }
}

-(IBAction)equalHit:(UIButton *)sender{
    result = [self.logic performOperation];
    self.display.text = [NSString stringWithFormat:@"%g", result];

} 
```

我的问题是向数组推送和弹出对象。数组位于 中`logic`，我试图将数字推送到 中的两个数组之一`logic`，并将运算符推送到对象中的另一个数组。但是，我一定是做错了什么，因为当我签入控制台时没有推送任何内容（据我所知）。我对这种语言还是新手，并且来自 Java 包装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:22:30.283

看起来您没有`logic`在代码中的任何地方分配/初始化。您需要这一行，可能在`viewDidLoad`或其他一些初始化函数中：

```
logic = [[CalcLogic alloc] init]; 
```

# .net - IIS7 .NET x64 aspnet_regiis -i 导致类未注册错误

> ID：15119251
> 
> 赞同：0
> 
> 时间：2013-02-27T18:12:45.807
> 
> 标签：.net, iis-7, windows-server-2008, aspnet-regiis.exe

我们在 Windows Server 2008 R2 SP1 上运行 IIS7，网站在 .NET 2.0 上运行。这些网站运行良好，但全局主题不起作用。我继续尝试在 Framework64 目录中执行 aspnet_regiis -c 并得到

```
An error has occured: 0x80040154 Class not registered. 
The error indicates that IIS is not installed on the machine. 
Please install IIS before using this tool. 
```

如果您想知道， enabled32bitApps 标志已关闭，因此使用 .NET x64。我继续在Framework64文件夹中成功卸载`(aspnet_regiis -u)`并重新安装（ ）.net。`aspnet_regiis -i`之后我尝试运行时得到了相同的结果`aspnet_regiis -c`。

有谁知道这里可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:30:07.073

我找到了一个简单的解决方法，其中不包括运行`aspnet_regiis -c`命令。在 IIS 中的默认站点下，您应该已经具有以下目录结构：

```
aspnet_clinet --> system_web --> 2_0_50727 
```

您所要做的就是将您的主题复制到 `...\wwwroot\aspnet_client\system_web\2_0_50727\Themes`您的文件系统上，然后创建一个 IIS 虚拟目录“主题”，`aspnet_client\system_web\2_0_50727`其中映射到您的文件系统主题目录。

# erlang - Erlang 中的高阶函数

> ID：15119252
> 
> 赞同：1
> 
> 时间：2013-02-27T18:12:47.003
> 
> 标签：erlang, higher-order-functions

如何在 Erlang 中编写以下高阶 Haskell 函数？

```
applyTwice :: (a -> a) -> a -> a  
applyTwice f x = f (f x) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:17:02.677

```
1> Apply2 = fun(F, X) -> F(F(X)) end.
#Fun<erl_eval.12.82930912>
2> F = fun(Arg) -> Arg * 2 end.
#Fun<erl_eval.6.82930912>
3> Apply2(F, 10).
40 
```

问题是，我不确定它是否是你真正需要的。因为在 Haskell 中，您可以使用`applyTwice f`as 函数，但不能在 Erlang 中使用（没有内置`partial`或`curry`功能）。你也不能在 Erlang 中做类似的事情

```
applyTwice :: (a -> a) -> a -> a  
applyTwice f = f . f 
```

# python - Python 中的 XPath 使用 xmllint2

> ID：15119261
> 
> 赞同：0
> 
> 时间：2013-02-27T18:13:30.760
> 
> 标签：python, xpath

我尝试在 python 中使用 xpath 进行查询，以便打印 kml 文件的不同部分。

问题是：当我进行查询时，我得到了非常奇怪的结果。

这是我的代码：

```
import libxml2

rss=libxml2.parseDoc(open('/home/julien/xpath/SUPPORT2.kml').read())
#print doc

node=rss.xpathEval('//Placemark')
print node 
```

这是结果：

```
[<xmlNode (Placemark) object at 0xa3e2acc>, <xmlNode (Placemark) object at0xa3e2b6c>,     <xmlNode (Placemark) object at 0xa3e2d4c>, <xmlNode (Placemark)
object at 0xa3e2dac>, <xmlNode (Placemark) object at 0xa3e2dec>, <xmlNode 
Placemark) object at 0xa3e2dcc>, <xmlNode (Placemark) object at 0xa3e2d8c>, 
<xmlNode (Placemark) object at 0xa3e2e0c>, <xmlNode (Placemark) object at 
0xa3e2eac>, <xmlNode (Placemark) object at 0xa3e2fec>, <xmlNode (Placemark) 
object at 0xa3e2f0c>, <xmlNode (Placemark) object at 0xa3e2f2c>, <xmlNode 
(Placemark) object at 0xa3e2f4c>, <xmlNode (Placemark) object at 0xa3e2f6c>, 
<xmlNode (Placemark) object at 0xa3e2f8c>] 
```

什么可以解释这个结果？我可以在我的代码中添加什么来使我的查询工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:09:42.517

您得到的结果是 xmlNode 对象的列表。它们显然是正确的结果。您要求 Python 打印（表示）节点列表。xmlNode 对象的字符串表示形式如下：

```
"<xmlNode (NodeName) object at MemoryAddress>" 
```

但是，您希望将它们视为序列化文本 (" `<Placemark> ...`")。为了得到它，在列表中的每个 xmlNode 上调用[serialize() ：](http://pyxmlsec.labs.libre-entreprise.org/docs/html/libxml2.xmlCore-class.html#serialize)

```
nodeList = rss.xpathEval('//Placemark')
for node in nodeList:
    print node.serialize('utf-8') 
```

这对于向您保证 XPath 结果的内容很有用。但是，如果您正在对这些节点进行进一步处理，则序列化的字符串可能不是您想要的。

另请参阅：[使用 Python 的 libxml2 从 XML 节点读取文本](https://stackoverflow.com/questions/10694767/reading-text-from-xml-nodes-using-pythons-libxml2)

# ios - 当用户滑动滚动时，有没有办法检测或获取通知？

> ID：15119269
> 
> 赞同：-3
> 
> 时间：2013-02-27T18:13:58.863
> 
> 标签：ios

当用户滑动滚动时，有没有办法检测或获取通知？我正在使用 (void)scrollViewDidScroll:(UIScrollView *) scrollView; 但我收到错误：使用未声明的标识符“scrollViewDidScroll”谁能告诉我为什么？

@daf & H2SO3

```
 - (void)viewDidLoad
{
    [super viewDidLoad];

    // setting the color of this view
    self.view.backgroundColor = [UIColor whiteColor];

    //creating scrollview controller
    CGRect scrollViewFrame = [[UIScreen mainScreen]applicationFrame];
    scrollView = [[UIScrollView          alloc]initWithFrame:CGRectMake(self.view.frame.origin.x,self.view.frame.origin.y,self.view.frame.size.width,(self.view.frame.size.height)/3)];
    scrollView.contentSize = CGSizeMake(3200, 4000);
    scrollView.showsHorizontalScrollIndicator = YES;
    scrollView.showsVerticalScrollIndicator = YES;
    scrollView.backgroundColor = [UIColor grayColor];
    scrollView.delegate = self;
    scrollView.directionalLockEnabled = YES;
    [self.view addSubview:scrollView];

    //creating uiimage

    UIImage* image1 = [UIImage imageNamed:@"wallpapers1.jpg"];

    //creating image view

    UIImageView* imageView1 = [[UIImageView alloc]initWithImage:image1];

    imageView1.frame = CGRectMake(1241,0,image1.size.width,image1.size.height);

    [scrollView addSubview:imageView1];
    // [scrollView scrollRectToVisible:CGRectMake(1200, 0, 100, 100) animated:YES];
}

- (void)scrollViewDidScroll:(UIScrollView *)sender
{
    ScrollDirection scrollDirection;
    if (self.lastContentOffset > scrollView.contentOffset.x)
        scrollDirection = ScrollDirectionRight;
    else if (self.lastContentOffset < scrollView.contentOffset.x)
        scrollDirection = ScrollDirectionLeft;

    self.lastContentOffset = scrollView.contentOffset.x;

    // do whatever you need to with scrollDirection here.
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-27T18:55:46.367

您使用了错误的委托方法。尝试使用这个

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView; 
```

# c++ - Visual Studio 上是否需要“冗余#include Guards”？

> ID：15119273
> 
> 赞同：3
> 
> 时间：2013-02-27T18:14:04.750
> 
> 标签：c++

我曾经使用以下代码来确保包含文件不会被多次加载。

```
#ifndef _STRING_
#include <string>
#endif

// use std::string here
std::string str;
... 
```

这个技巧在“API Design for C++”一书中有说明。

现在我的同事告诉我，这在 Visual Studio 中是没有必要的，因为如果 string 的实现头文件包含`#pragma once`，则不需要包含保护来提高编译速度。

那是对的吗？

引用原书：

```
7.2.3 Redundant #include Guards
Another way to reduce the overhead of parsing too many include files is to add redundant preprocessor
guards at the point of inclusion. For example, if you have an include file, bigfile.h, that looks
like this
#ifndef BIGFILE_H
#define BIGFILE_H
// lots and lots of code
#endif
then you might include this file from another header by doing the following:
#ifndef BIGFILE_H
#include "bigfile.h"
#endif
This saves the cost of pointlessly opening and parsing the entire include file if you’ve already
included it. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:20:32.253

通常术语“包含守卫”意味着这个`#ifdef`, `#define`,序列被放置在这个文件**内**`#endif`的特定头文件的内容周围。

 **许多 C++ 编译器提供了`#pragma once`保证外部相同行为的语句。但是为了可移植的 C/C++ 代码，我不鼓励使用它。

**更新**（根据 OP 的编辑）
另外将`#ifdef`,放在另一个文件中`#endif`的语句周围`#include`可能会阻止预处理器打开包含文件本身（从而稍微减少编译时间和内存使用）。我希望`#pragma once`会自动执行此操作，但不能确定（这可能是特定于实现的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:15:41.103

您*永远*不需要这样做，因为有能力的开发人员编写的任何头文件都会有自己的保护。您可以假设标准库头文件是由有能力的工程师编写的，如果您发现自己使用了没有包含保护的第三方头文件......好吧，现在该第三方被高度怀疑......

至于编写自己的标题，您可以使用标准：

```
#ifndef MY_HEADER_H
#define MY_HEADER_H

// ...code

#endif 
```

或者只是使用：

```
#pragma once 
```

请注意，这不是标准的 C 或 C++，它是编译器扩展。它不适用于所有编译器，但使用它是您的决定，取决于您的预期用途。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-16T17:19:24.000

根据定义，冗余包括警卫是“冗余的”。它们不会影响通过编译创建的二进制文件。但是，它们确实有好处。冗余的包含守卫可以减少编译时间。

谁在乎编译时间？我在乎。我只是一名开发人员是一个由数百名开发人员组成的项目，在数千个源文件中拥有数百万行源代码。项目的完整重建需要我 45 分钟。从修订控制拉取增量构建需要 20 多分钟。由于我的工作依赖于这个大项目，所以在等待这个长时间的构建时我无法执行任何测试。如果将构建时间缩短到 5 分钟以下，我们公司将受益匪浅。假设构建时间节省了 20 分钟。1 年 * 100 名开发人员 * 1 次构建/天，* 1/3 小时/构建 * 250 天/年 * 50 美元/小时 = 每年节省 416,667 美元。应该有人关心这个。

对于 Ed S，我使用 Redundant Include 防护装置已有 10 年了。偶尔你会发现有人使用该技术，但最怕它，因为它可以生成难看的代码。“#pragma once”肯定看起来更干净。就百分比而言，很少有开发人员不断尝试通过继续他们的教育和技术来提高他们的才能。多余的#include 守卫技术有点晦涩难懂，只有当有人费心对大型项目进行分析时，它的好处才会显现出来。您知道有多少开发人员会特意购买有关高级技术的 C++ 书籍？

回到 Visual Studio 中关于 Redundant Include guards 与 #pragma once 的原始问题...根据 Wiki [#pragma once](https://en.wikipedia.org/wiki/Pragma_once)，支持“#pragma once”的编译器可能比 #include 保护器更有效，因为它们可以分析文件名和路径以防止加载已加载的文件。三个编译器的名字被提到具有这种优化。此列表中明显没有的是 Visual Studio。所以，我们仍然想知道，在 Visual Studio 中，是否应该使用冗余的#include 保护，或者使用一次#pragma。

对于中小型项目，#pragma once 肯定很方便。对于在开发过程中编译时间成为一个因素的大型项目，冗余的#include 保护使开发人员可以更好地控制编译过程。任何管理或构建大型项目的人都应该在他们的库中包含[大型 C++ 设计](https://rads.stackoverflow.com/amzn/click/com/0201633620)——它讨论并推荐冗余的#include 保护。

#includes 的巧妙使用可能比多余的包含守卫更大的好处。随着 C++ 模板和 STL 变得越来越流行，方法实现正在从 .cpp 文件迁移到 .h 文件。.cpp 实现所具有的任何头文件依赖项现在都必须迁移到 .h 文件。这会增加编译时间。我经常看到开发人员在他们的头文件中堆放了许多不必要的#include，这样他们就不必费心识别他们实际需要的头文件。这也增加了编译时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:15:30.820

这`#pragma once`是一种更好的包含守卫形式。如果使用它，则不需要基于`#define`.

一般来说，这是一种更好的方法，因为它可以防止名称冲突破坏包含保护。

话虽如此，包含保护应该在头文件中，而不是包装包含。包装包含应该是完全没有必要的（并且可能会混淆其他人）。

* * *

编辑：

> 我认为我们在谈论两件不同的事情。我的问题是，当我们使用具有 #pragma once 或 #ifndef xxx 的预先存在的头文件时，是否应该使用包含保护

在那种情况下，没有。如果标头有适当的保护，则没有理由尝试避免包含它。这只会增加混乱和复杂性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:15:57.687

这不是使用包含警卫的方式。您不会将`#include`s 包装在包含防护中。头文件应将其自己的内容包装在包含保护中。每当您编写可能包含在其他文件中的文件时，您应该这样做：

```
#ifndef _SOME_GUARD_
#define _SOME_GUARD_

// Content here

#endif 
```

使用 Visual Studio 的 C++ 库实现，这可以通过`string`具有`#pragma once`或检查`#ifndef _STRING_`.**

# c# - 如何将项目添加到属于 UserControl 的 Canvas？

> ID：15119281
> 
> 赞同：1
> 
> 时间：2013-02-27T18:14:34.340
> 
> 标签：c#, wpf, canvas

我有一个包含 2 行的用户控件。第一行有一个标签，第二行有一个带有画布的滚动查看器：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition />
    </Grid.RowDefinitions>
    <Label Grid.Row="0" Content="TITLE" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Name="label1" VerticalAlignment="Top" FontSize="26" />
    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Canvas Background="White" />
    </ScrollViewer>
</Grid> 
```

在我的主 window.xaml 中，我尝试添加此用户控件，然后将项目添加到它的画布中。

```
<local:UserCanvas>
    <label Content="Test" />
</local:UserCancas> 
```

这里的问题是，当我在那里有那个标签时，它只是覆盖了用户控件第 1 行中的“TITLE”标签。如何添加东西以便将它们放置在 UserControl 的卡瓦上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:49:07.877

而不是`Content`在你的定义中`UserControl`，定义`UserControl.ContentTemplate`

例如，而不是写

```
<UserControl ...>
    <Grid>
        ...
        <Canvas />
        ...
    </Grid>
</UserControl> 
```

采用

```
<UserControl ...>
    <UserControl.ContentTemplate>
        <DataTemplate>
            <Grid>
                ...
                <Canvas>
                    <ContentPresenter Content="{TemplateBinding Content}"/>
                </Canvas>
                ...
            </Grid>
        </DataTemplate>
    </UserControl.ContentTemplate>
</UserControl> 
```

如果您使用第一种语法，那么在使用 UserControl 时指定 Content 将导致现有 Content 被覆盖，因此您呈现的 Visual Tree 最终看起来像这样：

```
<local:UserCanvas>
    <label Content="Test" />
</local:UserCancas> 
```

通过使用第二种语法，您将内容包装在 ContentTemplate 中，因此呈现的可视化树最终看起来像这样：

```
<local:UserCanvas>
    <Grid>
        ...
        <Canvas>
             <label Content="Test" />
        </Canvas>
        ...
    </Grid>
</local:UserCanvas> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:55:32.717

我会尝试将公共属性（您在用户控件中检查和响应`Page_Load()`）和/或公共方法（您只需从控件外部调用）添加到用户控件，然后您可以从主程序访问。走哪条路在一定程度上取决于您需要采取的行动有多复杂。在我看来，这很简单，可以通过公共属性 +`Page_Load()`方法处理。

# java - 如何从弹性负载均衡器中分离实例？

> ID：15119290
> 
> 赞同：2
> 
> 时间：2013-02-27T18:15:27.790
> 
> 标签：java, amazon-web-services, amazon-ec2, amazon-elb

我想从 ELB 中删除/分离一个实例（但不删除实例本身）。

API 似乎需要[DeleteLoadBalancerListeners](http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/us-delete-listener.html)的特定端口号。

如何从 LB（所有端口）中完全删除它？（就像 AWS 中的 GUI 操作“从负载均衡器中删除”一样）

我正在使用[Java SDK](http://docs.aws.amazon.com/sdkfornet/latest/apidocs/html/T_Amazon_ElasticLoadBalancing_Model_DeleteLoadBalancerListenersRequest.htm)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:31:25.190

从负载均衡器注销后端实例

使用以下参数调用 DeregisterInstancesFromLoadBalancer：

```
Instances = i-4e05f721
LoadBalancerName = MyLoadBalancer 
```

来自[http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/US_DeReg_Reg_Instances.html](http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/US_DeReg_Reg_Instances.html)

您指向 Java SDK 的链接转到 C# SDK，但您可以在同一个 API 文档中找到

[http://docs.aws.amazon.com/sdkfornet/latest/apidocs/html/T_Amazon_ElasticLoadBalancing_Model_DeregisterInstancesFromLoadBalancerRequest.htm](http://docs.aws.amazon.com/sdkfornet/latest/apidocs/html/T_Amazon_ElasticLoadBalancing_Model_DeregisterInstancesFromLoadBalancerRequest.htm)

这就是你要找的，对吧？

# sql - SQL 报告生成器 3.0 - 通过 Tablix 显示结果

> ID：15119293
> 
> 赞同：1
> 
> 时间：2013-02-27T18:15:37.060
> 
> 标签：sql, reporting-services, ssrs-tablix

我是 SQL 新手，目前正在尝试使用 Report Builder 3.0。我有一个需要帮助的基本报告，我希望答案也很简单，这种情况如下；

我的报告包含一个标题 tablix 和一个位于其下方的详细信息 Tablix，它们都是通过来自同一数据源的 2 个单独查询填充的

当我运行报告时，发生的事情是首先填充与标题相关的所有数据，然后填充详细信息，我试图在下面显示这一点；

团队 1 的标题详细信息 团队 2 的标题详细信息 团队 3 的标题详细信息等...

团队 1 的详细信息 团队 2 的详细信息 团队 3 的详细信息等...

**我真正想要的是**

团队 1 的标题详细信息 团队 1 的详细信息

团队 2 的标题详细信息 团队 2 的详细信息

等等，我在下班开车回家时有个想法，我应该将数据集合并到一个 Tablix 中，但是当我刚刚尝试过时，这是不可能的。

有什么想法可以解决这个问题吗？

这是我在报告生成器中的第一份报告，学习曲线陡峭！

干杯

# python - 带有 Django 模型的促销代码

> ID：15119296
> 
> 赞同：2
> 
> 时间：2013-02-27T18:15:49.130
> 
> 标签：python, django, django-models, django-forms

我有一个 Django 1.3.3 应用程序。我被要求为其添加“促销代码”类型的功能。基本上当用户注册这个产品时（注意：不是在用户注册系统时），他们可以输入一个促销代码（*如果*他们有一个），它会给他们免费的天数。

在得到这个要求之前，我有这个产品的注册页面作为一个简单的 ModelForm。我已对模型进行了所需的更改，并将“成员”模型中的外键字段添加到新的促销模型中。

*   id（整数）
*   promo_code models.CharField(max_length=20)
*   number_of_days = models.IntegerField()

    ```
    def __unicode__(self):
        return u'{}'.format(self.promo_code) 
    ```

当它添加到表单中时，它会给我一个包含所有促销代码的下拉框。但是，这不是我想要的。我希望他们必须拥有代码并将其输入文本框中。然后作为表单验证的一部分，查看它是否是有效代码。请记住，他们可能根本没有代码（所以，我不希望他们只从列表中选择）。

用 Django ModelForm 实现这样的需求的最佳方法是什么？

注意：我知道我可以备份并拥有一个完全自定义的表单，但我的页面已经使用 ModelForm，并且只需要添加此功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:36:25.963

我会从表单中排除成员模型上的外键字段。

```
class MemberForm(ModelForm):
    class Meta:
        model = Member
        exclude = ('promo',) 
```

将额外的输入元素添加到促销代码的模板中。然后在你的视图中做一些自定义处理——

```
def sign_up(request):
    #...
    if request.method == 'POST':
        form = MemberForm(request.POST)
        if form.valid():
            obj = form.save()
            if 'promo_field' in request.POST:
                try:
                    obj.promo = Promotion.objects.get(pk=request.POST['promo_field'])
                    obj.save()
                except DoesNotExist:
                    pass # the code wasn't valid
    else:
        #... 
```

如果您使用通用视图类进行表单编辑，则覆盖`form_valid()`添加促销代码的方法（使用上面的模式）。您将能够使用 访问帖子数据`self.request.POST`。

# c++ - 模板专业化语法错误 ？没有把握

> ID：15119300
> 
> 赞同：1
> 
> 时间：2013-02-27T18:16:03.750
> 
> 标签：c++, templates

我在让这个模板专业化工作时遇到了一些麻烦。我是这个话题的新手，所以我完全扼杀了这个可能性是完全有可能的。

我的通用模板工作得很好，但是在尝试为 int 制定规范时，我不断收到错误消息“'Matrix' 的离线定义与 Matrix int> 中的任何声明都不匹配。

现在，我认为它们匹配，但显然肯定有问题。大师们怎么说？另外，不要粗鲁，但“你实际上应该只使用 STL 中的 X”评论不会有太大帮助，我必须弄清楚这一点才能完成任务。干杯!

```
template<typename T>
class Matrix
{    
public:
    Matrix(int vert, int edge);
    ~Matrix();
    T* & operator[](int index);
    std::ostream& operator<<(std::ostream&);
    Matrix<T> operator*(Matrix<T>);
    int numVerticies();
    int numEdges();
private:
    T** matrix;
    int verticies;
    int edges;
    const int summation(T** mat1, int, Matrix<int> mat2, int, int verts);
};

template<>
class Matrix<int>
{
public:
    Matrix(int vert, int edge);
    ~Matrix();
    int*& operator[](int index);
    std::ostream& operator<<(std::ostream&);
    Matrix<int> operator*(Matrix<int>);
    int numVerticies();
    int numEdges();
private:
    int** matrix;
    int verticies;
    int edges;
    const int summation(int** mat1, int, Matrix<int> mat2, int, int verts);
}; 
```

使用包含方法与其他成员一起引入：

```
template<int>
Matrix<int>::Matrix(int vert, int edge)
{
    matrix = new int* [vert];

    for (int i=0; i<vert; i++) {
        matrix[i] = new int[vert];
    }

    verticies = vert;
    edges = edge;

    for (int i=0; i<vert; i++) {
        for (int j=0; j<vert; j++) {
            matrix[i][j]=0;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:21:45.033

只需避免使用`template<>`前缀：

```
Matrix<int>::Matrix(int vert, int edge)
{
    matrix = new int* [vert];

    for (int i=0; i<vert; i++) {
        matrix[i] = new int[vert];
    }

    verticies = vert;
    edges = edge;

    for (int i=0; i<vert; i++) {
        for (int j=0; j<vert; j++) {
            matrix[i][j]=0;
        }
    }
} 
```

您正在定义显式特化类的构造函数，而不是构造函数的显式特化。同样，避免使用`template<>`for 其他成员的定义：

```
int Matrix<int>::numEdges()
{
    return 0;
} 
```

另请注意，`const`按值返回 a 的编程实践是可疑的：而不是`int`使用`const int`.

# android - 是否可以像在旧版本的 Android 操作系统上运行我的应用程序一样运行它？

> ID：15119303
> 
> 赞同：1
> 
> 时间：2013-02-27T18:16:09.300
> 
> 标签：android, testing

我希望我的应用程序支持旧版本的 Android，但我唯一的 Android 设备是更新版本的。此外，SDK 中的模拟器启动和运行速度非常慢。我找不到任何可靠的测试环境来测试我的应用在旧设备上的功能。有什么提示吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:23:29.497

试试[远程测试](http://www.techrepublic.com/blog/app-builder/remote-test-your-android-apps-with-these-services/1928)

或模拟器是唯一的方法。

您可以通过限制 SDK 使用版本来构建应用程序，从而确保它可以在旧设备上运行，然后在新设备上对其进行彻底测试。

修复一些错误，然后在旧的 SDK 模拟器或远程设置上运行它们。

# ios - sqlite3 IOS查询窃听表

> ID：15119305
> 
> 赞同：1
> 
> 时间：2013-02-27T18:16:12.297
> 
> 标签：ios, sql, xcode, sqlite

我有一个奇怪的错误，我用相当复杂的查询查询我的表“儿童”。它工作正常，但由于某种原因，它会在更新数据库时破坏另一个视图。您会看到此数据库包含贴纸，并且提供它们的一种简单方法是访问此管理页面，这是它的错误所在。我可以很好地查询信息，但是！当我更新它讨厌并且不起作用的表时。但是它在核心视图控制器内部很奇怪，当我在那里更新表格时它不会出错。我将代码缩小到导致此问题的原因：

```
-(void)leaderboardsystem
{  
    NSString *nexttargetsql = [NSString stringWithFormat:@"SELECT * FROM Children WHERE Completed > %d OR (Completed = %d AND Current_Stickers > %d) ORDER BY Completed ASC, Current_Stickers ASC LIMIT 1",completecount,completecount,stickercount]; //Queries table for the childs name and returns more data.
    NSString *behindyousql = [NSString stringWithFormat:@"SELECT * FROM Children WHERE Completed < %d OR (Completed = %d AND Current_Stickers < %d) ORDER BY Completed DESC, Current_Stickers DESC LIMIT 1",completecount,completecount,stickercount];

    nexttarget.text = [self leaderboardQuery:nexttargetsql];
    behindyou.text = [self leaderboardQuery:behindyousql];

    }

-(NSString*)leaderboardQuery:(NSString*)sql//does the querying
{
    sqlite3_stmt *statement;
    if (sqlite3_prepare_v2(Childdb, [sql UTF8String], -1, &statement, nil)==SQLITE_OK) {
        while (sqlite3_step(statement)==SQLITE_ROW) {
            char *ffield1 = (char *) sqlite3_column_text(statement, 0);
            NSString *ffield1Str = [[NSString alloc]initWithUTF8String:ffield1];
            char *ffield2 = (char *) sqlite3_column_text(statement, 8);
            NSString *ffield2Str = [[NSString alloc]initWithUTF8String:ffield2];
            char *ffield3 = (char *) sqlite3_column_text(statement, 10);
            NSString *ffield3Str = [[NSString alloc]initWithUTF8String:ffield3];
            NSLog(@"Name:%@",ffield1Str);
            NSLog(@"this is completecount: %@", ffield2Str);
            NSLog(@"this is stickcount: %@",ffield3Str);
            return ffield1Str;
        }

    }
        return NULL;
} 
```

每当我调用方法 leaderboardsystem 时，它都会导致此错误，但如果我不这样做，它就可以正常工作！够有趣的，说实话，我有点惊讶。这让我感到惊讶，因为它影响了一个与主视图没有连接的完全不同的视图控制器。表格布局如下：

```
[self createTable:@"Children" withField1:@"Name" withField2:@"Password" withField3:@"House" withField4:@"Sticker Collection" withField5:@"Tickets Gathered" withField6:@"Tickets Removed" withField7:@"Last Ticket Scanned" withField8:@"Current Tickets" withField9:@"Completed" withField10:@"Complete" withField11:@"Current_Stickers"]; 
```

这是当我在主视图中包含排行榜系统时似乎失败的更新代码（这是在完全不同的视图控制器上）

```
-(void)UpdateDatabase//update table, if value has been incremented
{
    NSString *sql = [NSString stringWithFormat:@"UPDATE Children SET 'Current Tickets' = %d, 'Tickets Removed' = %d, 'Tickets Gathered' = %d WHERE Name = '%@'",[self.currenttickets.text integerValue], [self.removedtickets.text integerValue], [self.totaltickets.text integerValue], name];
    [self updatetable:sql];
}

-(void)updatetable:(NSString*)sql
{
    char *err;
    if (sqlite3_exec(Childdb, [sql UTF8String], NULL, NULL, &err)!=SQLITE_OK) {
        sqlite3_close(Childdb);
        NSAssert(0, @"Could not update Table");
    } else {
        NSLog(@"Table updated");
    }
} 
```

我尽量不在这里过度描述并保持简短我的程序非常大，如果您需要更多信息，请告诉我。但我保证是排行榜系统导致了问题。感谢一百万，如果你能解决这个问题，整天都在努力！:(

它还扰乱了我向表中添加记录的地方，因此更新代码不会导致它。它的排行榜查询，不知道为什么:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:25:08.723

你需要打电话`sqlite3_finalize(Childdb)`。它看起来像下面这样：

```
-(NSString*)leaderboardQuery:(NSString*)sql//does the querying
{
    sqlite3_stmt *statement;
    if (sqlite3_prepare_v2(Childdb, [sql UTF8String], -1, &statement, nil)==SQLITE_OK) {
        while (sqlite3_step(statement)==SQLITE_ROW) {
           ...
        }
    }
    sqlite3_finalize(Childdb);
    return NULL;
} 
```

这是一个非常简单的示例，因为没有错误处理。描述这一点的文档如下（位于[此处](http://www.sqlite.org/c3ref/prepare.html)）：

> *ppStmt 指向可以使用 sqlite3_step() 执行的已编译准备语句。如果有错误，*ppStmt 设置为 NULL。如果输入文本不包含 SQL（如果输入是空字符串或注释），则 *ppStmt 设置为 NULL。调用过程负责在完成后使用 sqlite3_finalize() 删除已编译的 SQL 语句。ppStmt 不能为 NULL。

此示例代码可能对您有所帮助：[https ://github.com/ccgus/fmdb/blob/master/src/FMDatabase.m#L519](https://github.com/ccgus/fmdb/blob/master/src/FMDatabase.m#L519)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:13:21.063

好吧，我不想这样做。但是，我没有管理查询的方法，而是在方法内部重复了两次，但它起作用了！不知道有什么问题。似乎没有其他人可以帮助我，所以我就这样吧。

# asp.net-mvc - 学习与 MVC 一起使用的实体框架，首先采用哪种方法？

> ID：15119306
> 
> 赞同：4
> 
> 时间：2013-02-27T18:16:20.803
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, ef-model-first, ef-database-first

我是 MVC 和 EF 的初学者。为了更好地使用这些技术，我决定更清楚地理解事物。

现在，我已经开始阅读有关 EF 的内容，并且知道有`Model-first`,`Database-first`和`Code-first`技术。

我真的想从对我最有利的一个开始，因为我将使用 MVC 进行开发，然后再回到其他两个并比较它们。

我唯一的问题是，我应该从哪种技术开始并使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:21:55.583

对我们来说，我们基于数据库是否已经存在。在许多情况下，我们有预先存在的数据库，所以我们使用数据库优先。展望未来，我们更喜欢创建数据库，然后从中构建模型，因为我们在这样做方面更有经验。我做过一次代码优先，我发现这很痛苦，但是您确实可以更好地控制并更好地了解 EF 在幕后所做的事情。

抱歉，我无法提供更好的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:11:27.723

如果我正在建立一个新网站，我肯定会使用*Code First*，因为*Code First*是：

1.  技术的未来（实体框架），微软的所有努力都在开发这项新技术。（这不是我自己想出来的，我是在微软的一个人的一篇文章中读到的，抱歉我不记得是谁了）。
2.  它是为*DDD*（领域驱动开发）开发人员构建的，与 TDD/BDD 并列正在成为构建软件系统的标准（强词）或正确方式。
3.  正如它的名字所暗示的那样，您可以立即开始编码（我喜欢这样做）并担心稍后您应该做的精细持久性细节。

如果我**被迫**使用现有数据库，我只会选择*Database First 。*

 ***Model First 是向Code First*迈出的一步，所以如果我是你，我不会倒退。

注意：在此处查看此问题以获得更好的比较[实体框架代码优先与模型/数据库优先](https://stackoverflow.com/questions/5446316/ef-4-1-code-first-vs-model-database-first/5446587#5446587)**

# sql - 英国最后一个工作日的日期变量？

> ID：15119308
> 
> 赞同：1
> 
> 时间：2013-02-27T18:16:24.090
> 
> 标签：sql, sql-server

从事英国项目。

我放了一个可爱的变量来给我一个星期一到星期五最后一个工作日的开始日期和结束日期。不幸的是，我希望开始日期时间是一天的开始，结束日期是一天的结束。我可以做些什么改变来实现这一点？

```
SET @Startdate =
  ( CASE
    WHEN DATEPART(WEEKDAY, @Startdate) = 7
      THEN DATEADD(DAY, -2, @Startdate)
    WHEN DATEPART(WEEKDAY, @Startdate) = 1
      THEN DATEADD(DAY, (-2 - DATEPART(WEEKDAY, @Startdate)), @Startdate)
    ELSE
      DATEADD(DAY, -1, @Startdate)
  END )

SET @Enddate = 
  CASE
    WHEN DATEPART(WEEKDAY, @Enddate) = 7
      THEN DATEADD(DAY, -2, @Enddate)
    WHEN DATEPART(WEEKDAY, @Enddate) = 1
      THEN DATEADD(DAY, (-2 - DATEPART(WEEKDAY, @Enddate)), @Enddate)
    ELSE
      DATEADD(DAY, -1, @Enddate) 
  END

print @Startdate 
print @Enddate 
```

结果 ：

> 2013 年 2 月 26 日上午 12:00 2013 年
> 2 月 26 日上午 12:00

我需要`Feb 26 2013 00:00`until `Feb 27 2013 00:00`，所以它涵盖周二全天（如果今天运行，则为最后一个工作日）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:21:54.750

实际上 12:00 AM 是 00:00，如果需要，您只需将其转换为另一种格式 ( [http://msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx) )。

只需在 2 月 26 日凌晨 12:00 添加一天，您将获得 2 月 27 日凌晨 12:00，即 2 月 27 日 00:00。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:25:37.497

如果您执行粗略的 Google 搜索（为此有很多好的 UDF），这是一个已解决的问题，但要按原样使用您的代码，如果您确实想要 26 日 0:00 到 27 日 0，只需在 @Enddate 计算中添加一个： 00 （或者如果你想要 23:59，可以像 Kenneth Fisher 建议的那样添加略低于 1，这似乎更好）。

# java - 通过 RESTeasy 上的 NameBinding 将过滤器与特定方法匹配

> ID：15119309
> 
> 赞同：10
> 
> 时间：2013-02-27T18:16:31.040
> 
> 标签：java, rest, tomcat, jax-rs, resteasy

我正在尝试按照[RESTeasy 文档](http://docs.jboss.org/resteasy/docs/3.0-beta-3/userguide/html_single/index.html#d4e1316)的建议指定一个仅与我的一些 API 调用相关联的预匹配过滤器。这是我的代码的样子：

名称绑定：

```
@NameBinding
public @interface ValidateFoo {} 
```

资源：

```
@Path("/foo/bar")
@Produces(MediaType.APPLICATION_JSON)
public class FooBar {
    @GET
    @ValidateFoo
    public Object doStuff() {
        //do stuff
    }

    @POST
    public Object doAnotherStuff() {
        //do another stuff
    }
} 
```

筛选：

```
@ValidateFoo
@Provider
@PreMatching
public class FooValidation implements ContainerRequestFilter {
    @Override
    public void filter(ContainerRequestContext reqContext) throws IOException {
        //validate stuff
    }
} 
```

问题是：FooValidation 过滤器在*每个*方法调用之前运行（例如：在 GET 和 POST 到 /foo/bar 之前），而不仅仅是那些带有注释的过滤器`@ValidateFoo`（对我来说似乎是一个错误）。如果我`@Provider`从过滤器中删除注释，它将不会在任何调用之前运行（如预期的那样）。

我一直看到这种行为，无论是使用 WebLogic 还是使用 Tomcat。我的依赖管理是通过Maven完成的，RESTeasy版本是3.0-beta-3。

任何人都经历过/经历过相同的行为？[我在JBoss 论坛](https://community.jboss.org/message/777014)上看到另一个有类似问题的用户，到目前为止还没有运气。

更新： RESTeasy 3.0.1-Final 仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-26T12:21:19.847

我有类似的问题。对我来说，解决方案是添加以下注释配置（到@ValidateFoo）：

```
@Target({ ElementType.TYPE, ElementType.METHOD })
@Retention(value = RetentionPolicy.RUNTIME)
@NameBinding 
```

# android - Android loopj：发布数据

> ID：15119310
> 
> 赞同：1
> 
> 时间：2013-02-27T18:16:34.797
> 
> 标签：android, http, http-post, loopj

我正在使用 loopj 发布一些数据。一切正常，但我有一些问题：

*   处理没有可用互联网连接的情况的好方法是什么？目前我只是在一段时间后重试，但是像这样，我必须将数据存储在本地，因为如果用户关闭应用程序甚至关闭他的设备，数据将不会被发送。也许这是唯一的方法，或者您知道另一种方法吗？

*   当我发布一些数据并且连接不好时，它有时会停止。loopj 是否有某种超时？你怎么能改变呢？你怎么知道它没有提交？

我只需要一种极其稳定的方式来发布数据。您是否建议使用 loopj 以外的其他库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-10T20:57:25.777

一种可靠传输数据的方法：

1.  在 SQLite 数据库中插入请求
2.  发出 POST 请求
3.  删除适当的行 onSuccess()
4.  当互联网恢复时重试 SQLite 上的待处理行 (android.net.conn.CONNECTIVITY_CHANGE)

从 AsyncHttpClient 类：

```
private static final int DEFAULT_MAX_CONNECTIONS = 10;
private static final int DEFAULT_SOCKET_TIMEOUT = 10 * 1000;
private static final int DEFAULT_MAX_RETRIES = 5;
private static final int DEFAULT_SOCKET_BUFFER_SIZE = 8192; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T10:11:55.840

您可以在 onFailure() 失败时覆盖它，并处理那里的情况。

```
@Override
public void onFailure(Throwable e) {
    Log.d(TAG, e.toString());
} 
```

是的，AsyncHttpClient 中存在超时，默认为 10 秒。您可以通过[setTimeout(int)](http://loopj.com/android-async-http/doc/com/loopj/android/http/AsyncHttpClient.html#setTimeout%28int%29)更改它。

# playframework-2.1 - 在 Play Framework 2.1 中将日志记录设置为跟踪时出现奇怪的异常

> ID：15119316
> 
> 赞同：4
> 
> 时间：2013-02-27T18:17:11.440
> 
> 标签：playframework-2.1

当我在 Play 2.1 with Scala 项目上打开跟踪日志记录时，我看到了一个奇怪的异常。每当我调用包含以下控制器的控制器时都会看到此异常，该控制器本质上是一个 ping：

```
object Ping extends Controller {
  def get() = Action {
    Ok("LALA")
  }
} 
```

更令人沮丧的是，异常堆栈中没有任何东西可以将我的代码与异常联系起来。

任何见解将不胜感激。

谢谢

下面的异常跟踪：

```
2013-02-27 09:57:24,163 [T] [] - Netty 中捕获的异常      
  java.lang.ClassCastException：scala.runtime.BoxedUnit 不能转换为 scala.Function0
    在 play.core.server.netty.PlayDefaultUpstreamHandler.channelDisconnected(PlayDefaultUpstreamHandler.scala:50) ~[play_2.10.jar:2.1.0]
    在 org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:573) ~[netty.jar:na]
    在 org.jboss.netty.handler.codec.frame.FrameDecoder.channelDisconnected(FrameDecoder.java:366) ~[netty.jar:na]
    在 org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:399) ~[netty.jar:na]
    在 org.jboss.netty.channel.socket.nio.AbstractNioWorker.close(AbstractNioWorker.java:716) ~[netty.jar:na]
    在 org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:89) ~[netty.jar:na]
    在 org.jboss.netty.channel.socket.nio.AbstractNioWorker.processSelectedKeys(AbstractNioWorker.java:472) ~[netty.jar:na]
    在 org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:333) ~[netty.jar:na]
    在 org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:35) ~[netty.jar:na]
    在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895) [na:1.6.0_41]
    在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918) [na:1.6.0_41]
    在 java.lang.Thread.run(Thread.java:680) [na:1.6.0_41]

```

# c# - 将一个数据库复制到另一个删除重复行

> ID：15119317
> 
> 赞同：1
> 
> 时间：2013-02-27T18:17:15.470
> 
> 标签：c#, sql-server, database

我有一个名为“ovhidhan_e_word”的数据库，它有一个名为的表`Table1`，其中包含重复的行。但我想将其复制`Table1`到另一个名为“ovidhan”的数据库下的另一个表中`dic`。但这次我不想重复行.我用这个代码：

```
 string english_w = "";

        SqlConnection mssql_con = new System.Data.SqlClient.SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Imon-Bayazid\Documents\ovhidhan_e_word.mdf;MultipleActiveResultSets=true;Integrated Security=True;Connect Timeout=30;User Instance=True");
        SqlConnection con2 = new System.Data.SqlClient.SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Imon-Bayazid\Documents\ovidhan.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True");

        mssql_con.Open();

        SqlCommand mssql_cmnd = new System.Data.SqlClient.SqlCommand("SELECT * from Table1", mssql_con);

        SqlDataReader rd = mssql_cmnd.ExecuteReader();
        while (rd.Read())
        {
            english_w = rd.GetString(0);

            con2.Open();

            SqlCommand cmnd2 = new System.Data.SqlClient.SqlCommand("select * from dic where english=@h",con2);
            cmnd2.Parameters.AddWithValue("@h",english_w);

            SqlDataReader r = cmnd2.ExecuteReader();
            if (r.Read())
            { }
               else {
                    SqlCommand c = new System.Data.SqlClient.SqlCommand("insert into dic values(@k)", con2); ;
                    c.Parameters.AddWithValue("@k", english_w);
                    c.ExecuteNonQuery();
                 }

            con2.Close();      
        }

        mssql_con.Close(); 
```

但它显示异常**“已经有一个打开的 DataReader 与此命令关联，必须先关闭。”** 在“ *c.ExecuteNonQuery();* ”行上

我该如何解决这个问题？？？另一个问题如何从 mssql 中的表中删除重复的行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:23:34.340

这是因为 mssql_cmnd 与您用于第一个 SQLReader 的 SQLCommand 相同。您可能想调用 SQLCommand c：

```
c.Parameters.AddWithValue("@k", english_w);
c.ExecuteNonQuery(); 
```

至于重复，您总是可以在读取数据时执行 SELECT DISTINCT。请参阅以下链接中的标题 C：

[http://msdn.microsoft.com/en-us/library/ms187731.aspx](http://msdn.microsoft.com/en-us/library/ms187731.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:24:04.247

我认为它应该是“c”而不是“mssql_cmnd”，并且还建议在您的连接、命令和数据读取器对象周围使用“使用”语句。

**编辑**

我没有测试代码，但尝试重构它并用执行标量替换数据读取器。

```
 string english_w = string.Empty;
        using (SqlConnection mssql_con = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Imon-Bayazid\Documents\ovhidhan_e_word.mdf;MultipleActiveResultSets=true;Integrated Security=True;Connect Timeout=30;User Instance=True"))
        {
            using (SqlCommand mssql_cmnd = new SqlCommand("SELECT * from Table1", mssql_con))
            {
                mssql_con.Open();
                using (SqlDataReader rd = mssql_cmnd.ExecuteReader())
                {
                    while (rd.Read())
                    {
                        english_w = rd.GetString(0);
                        using (SqlConnection con2 = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Imon-Bayazid\Documents\ovidhan.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True"))
                        {
                            con2.Open();
                            using (SqlCommand cmnd2 = new SqlCommand("select top 1 * from dic where english=@h", con2))
                            {
                                cmnd2.Parameters.AddWithValue("@h", english_w);
                                object obj = cmnd2.ExecuteScalar();
                                if (obj == null)
                                {
                                    using (SqlCommand c = new SqlCommand("insert into dic values(@k)", con2))
                                    {
                                        c.Parameters.AddWithValue("@k", english_w);
                                        c.ExecuteNonQuery();
                                    }
                                }
                            }
                            con2.Close();
                        }
                    }
                    rd.Close();
                }
            }
            mssql_con.Close();
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:50:56.850

你从哪里得到错误？`mssql_cmnd`没有`ExecuteNonQuery()`如果是，`c`请尝试。试试这个删除重复的行`c.Dispose()``c.ExecuteNonQuery()`

```
select * from table1 h1 where H1.ID in (select max(id) from table1 group by duplicate_row_id); 
```

# mysql - MYSQL 帮助需要加入 2 个具有多个结果的表

> ID：15119319
> 
> 赞同：0
> 
> 时间：2013-02-27T18:17:18.057
> 
> 标签：mysql

使用下面的 2 个表格，我想显示一个名称列表，下一个可用时间显示在他们的名字旁边。每个名称只有 1 个结果。你能帮我吗？谢谢鲍比

```
user table
|  user_ID  |  name   
|  1        |   Smith  
|  2        |   Jones 

times_available
|    ID    |   user_ID  | time_avail |
|        1 |   2        |   01:30    |
|        2 |   2        |   02:30    |
|        3 |   3        |   02:30    |
|        4 |   3        |   03:30    |
|        5 |   3        |   04:30    | 
```

**显示每个名称的下一个可用时间**

```
|  user_ID  |  time   |
|    Smith  |   02:30 |
|    Jones  |   02:30 | 
```

@Clodoaldo 有一个很好的答案，但我还需要显示没有即将到来的 time_avail 的名称

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:25:14.667

```
select u.name, min(t.time_avail)
from
    user_table u
    inner join
    times_available t on u.user_id = t.user_id
where t.time_avail > current_time
group by u.user_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:28:34.833

你可以这样做

```
SELECT 
    u.user_ID,
    u.name,
    ta.NewTime
FROM user AS u
LEFT JOIN (
       SELECT r.* , lta.time_avail AS `NewTime` FROM times_available as r
       LEFT JOIN (SELECT * FROM times_available LIMIT 1,69596585953484) AS lta
          ON lta.ID = (SELECT MIN(ID) FROM times_available WHERE ID > r.ID GROUP BY r.ID limit 1)
) AS ta ON ta.user_ID = u.user_ID 
WHERE ta.NewTime IS NOT NULL
GROUP BY u.user_ID 
```

[小提琴演示](http://sqlfiddle.com/#!2/d0fe7/1)

# c# - 私有EventHandler和私有事件EventHandler的区别？

> ID：15119323
> 
> 赞同：6
> 
> 时间：2013-02-27T18:17:22.483
> 
> 标签：c#, .net, events, delegates, event-handling

基本上就是标题所说的。这两者有什么区别（我目前使用的是第一个）

```
private EventHandler _progressEvent; 
```

和

```
private event EventHandler _progressEvent; 
```

我有一个方法

```
void Download(string url, EventHandler progressEvent) {
    doDownload(url)
    this._progressEvent = progressEvent;
} 
```

doDownload 方法将调用

```
_progressEvent(this, new EventArgs()); 
```

到目前为止，它工作正常。但我觉得我做错了可怕的事情。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:21:46.943

第一个定义一个委托，第二个定义一个事件。这两者是相关的，但它们的用法通常非常不同。

通常，如果您使用`EventHandler`or `EventHandler<T>`，这表明您正在使用事件。调用者（用于处理进度）通常会*订阅*事件（而不是传递委托），如果您有订阅者，您会引发事件。

如果你想使用更实用的方法，并传入一个委托，我会选择一个更合适的委托来使用。在这种情况下，您实际上并没有在 中提供任何信息`EventArgs`，因此也许只使用`System.Action`更合适。

话虽如此，从显示的小代码来看，事件方法在这里似乎更合适。有关使用事件的详细信息，请参阅[C](http://msdn.microsoft.com/en-us/library/awbftdfh.aspx) # 编程指南中的事件。

您的代码，使用事件，可能看起来像：

```
// This might make more sense as a delegate with progress information - ie: percent done?
public event EventHandler ProgressChanged;

public void Download(string url)
{ 
  // ... No delegate here... 
```

当你调用你的进度时，你会写：

```
var handler = this.ProgressChanged;
if (handler != null)
    handler(this, EventArgs.Empty); 
```

这个的用户会这样写：

```
yourClass.ProgressChanged += myHandler;
yourClass.Download(url); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-06-11T10:17:12.683

对于`private`，两者之间没有区别，但对于`public`您想要使用`event`.

event 关键字是一个访问修饰符，例如 private internal 和 protected。它用于限制对多播委托的访问。[https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/event](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/event)

从最明显到最不明显，我们有

```
public EventHandler _progressEvent;
//can be assigned to from outside the class (using = and multicast using +=)
//can be invoked from outside the class 

public event EventHandler _progressEvent;
//can be bound to from outside the class (using +=), but can't be assigned (using =)
//can only be invoked from inside the class

private EventHandler _progressEvent;
//can be bound from inside the class (using = or +=)
//can be invoked inside the class  

private event EventHandler _progressEvent;
//Same as private. given event restricts the use of the delegate from outside
// the class - i don't see how private is different to private event 
```

# android - Horizo ntalScrollViews 一起滚动

> ID：15119329
> 
> 赞同：1
> 
> 时间：2013-02-27T18:17:33.177
> 
> 标签：android, scroll, scrollview, horizontalscrollview

我需要独立滚动 2 个平行的 Horizo​​ntalScrollView，这意味着如果我滚动一个，另一个也应该滚动。

我怎么能做这样的事情？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-02T07:42:31.757

```
hscrollViewOne=(HorizontalScrollView)findViewById(R.id.hsvOne);
hscrollViewTwo=(HorizontalScrollView)findViewById(R.id.hsvTwo);

hscrollViewOne.setOnScrollChangeListener(new View.OnScrollChangeListener() {
        @Override
        public void onScrollChange(View v, int scrollX, int scrollY, int oldScrollX, int oldScrollY) {
            hscrollViewTwo.scrollTo(scrollX, scrollY);
        }
    });

hscrollViewTwo.setOnScrollChangeListener(new View.OnScrollChangeListener() {
        @Override
        public void onScrollChange(View v, int scrollX, int scrollY, int oldScrollX, int oldScrollY) {
            hscrollViewOne.scrollTo(scrollX,scrollY);
        }
    }); 
```

# android - onActivityResult 的问题

> ID：15119330
> 
> 赞同：2
> 
> 时间：2013-02-27T18:17:35.653
> 
> 标签：android, android-activity, android-imageview

我正在创建一个应用程序，在应用程序启动相机打开拍照。我还在应用程序[FB Login](http://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/)中实现了 Facebook 登录，一切正常。我的问题是我想显示在我添加到 MainActivity 布局中的 imageView 中拍摄的图片。没有错误，但图像未在 imageView 中显示。但是当我将 onActivityResult 方法的名称更改为 onActivityResult2 时，图像不会显示。当我不更改方法名称时显示图像。我无法将名称保留为 onActivityResult，因为在另一个类中，此方法正在处理 Facebook 登录。我不知道我做错了什么。谁能帮我吗。这是我的完整代码

```
public class MainActivity extends FragmentActivity {

private MainFragment mainFragment;
private static final int CAMERA_REQUEST = 1888;
private ImageView imageView;
private Button btn_up, btn_new;
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

if (savedInstanceState == null) {
    // Add the fragment on initial activity setup
    mainFragment = new MainFragment();
    getSupportFragmentManager().beginTransaction().add(android.R.id.content, mainFragment).commit();

} else {
    // Or set the fragment from restored state info
    mainFragment = (MainFragment) getSupportFragmentManager()
    .findFragmentById(android.R.id.content);

}
setContentView(R.layout.activity_main);

imageView = (ImageView) findViewById(R.id.imview);

Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
startActivityForResult(cameraIntent, CAMERA_REQUEST);

}
protected void onActivityResult1(int requestCode, int resultCode, Intent data) {  
  if (requestCode == CAMERA_REQUEST && resultCode == RESULT_OK) {  
      Bitmap photo = (Bitmap) data.getExtras().get("data"); 
      imageView.setImageBitmap(photo);
  }  
} 
} 
```

以下是我的片段类

```
public class MainFragment extends Fragment {

private static final String TAG = "MainFragment";
private UiLifecycleHelper uiHelper;
public Bitmap photo;
private int RESULT_OK = 1;
private ImageView imageView;
private static final int CAMERA_REQUEST = 1888;
private Button btn_up, btn_new;
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.activity_main, container, false);
    LoginButton authButton = (LoginButton) view.findViewById(R.id.authButton);
    authButton.setFragment(this);
    imageView = (ImageView) view.findViewById(R.id.imview);
    btn_new = (Button) view.findViewById(R.id.btn_new);

    btn_up = (Button) view.findViewById(R.id.btn_up);
    btn_new.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
            startActivityForResult(cameraIntent, CAMERA_REQUEST);
        }
    });
    return view;
}
public void onActivityResult1(int requestCode, int resultCode, Intent data) {  
      if (requestCode == CAMERA_REQUEST && resultCode == RESULT_OK) {  
          Bitmap photo = (Bitmap) data.getExtras().get("data"); 
          imageView.setImageBitmap(photo);
        }
      }
private void onSessionStateChange(Session session, SessionState state, Exception exception) {
    if (state.isOpened()) {
        Log.i(TAG, "Logged in...");
        //LoginButton aButton

    } else if (state.isClosed()) {
        Log.i(TAG, "Logged out...");

    }
}
private Session.StatusCallback callback = new Session.StatusCallback() {
    @Override
    public void call(Session session, SessionState state, Exception exception) {
        onSessionStateChange(session, state, exception);
    }
};
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    uiHelper = new UiLifecycleHelper(getActivity(), callback);
    uiHelper.onCreate(savedInstanceState);
}
@Override
public void onResume() {
    super.onResume();
    Session session = Session.getActiveSession();
    if (session != null &&
           (session.isOpened() || session.isClosed()) ) {
        onSessionStateChange(session, session.getState(), null);
    }

    uiHelper.onResume();

}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);
    //authButton.setFragment(this);
}

@Override
public void onPause() {
    super.onPause();
    uiHelper.onPause();
}

@Override
public void onDestroy() {
    super.onDestroy();
    uiHelper.onDestroy();
}

@Override
public void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    uiHelper.onSaveInstanceState(outState);
} 
```

} 提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:34:15.783

好吧，实际上根本不调用 your 是很正常的`onActivityResult1()`，因为 start-for-result 模式需要特定的函数签名才能正常工作。您只需要：

*   将`MainActivity.onActivityResult1(...)`方法重命名为`MainActivity.onActivityResult(...)`

*   删除`MainFragment.onActivityResult1(...)`方法并使其`MainFragment.onActivityResult(...)`看起来像这样：

.

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  super.onActivityResult(requestCode, resultCode, data);
  if (requestCode == CAMERA_REQUEST && resultCode == RESULT_OK) {
    Bitmap photo = (Bitmap) data.getExtras().get("data"); 
    imageView.setImageBitmap(photo);
  }
  else
    uiHelper.onActivityResult(requestCode, resultCode, data);
} 
```

# vb.net - Visual Basic 2010 中的 TIMER 或 STOPWATCH

> ID：15119332
> 
> 赞同：0
> 
> 时间：2013-02-27T18:17:38.667
> 
> 标签：vb.net, timer, timing, stopwatch

我有一些虚拟软件可以在 Visual Basic 中测试秒表的精度。有人告诉我，visual basic 的时机非常好，但我遇到了一些奇怪的行为。

这是我的所有代码：

```
Imports System.IO
Public Class Form1
    Public tmrTime As New Stopwatch
    Dim currentDate As Date

    Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        tmrTime.Start()

    End Sub

    Private Sub Form1_KeyUp(sender As Object, e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyUp
        TextBox1.Text = (tmrTime.ElapsedTicks / Stopwatch.Frequency) * 1000

    End Sub

    Private Sub Form1_KeyDown(sender As Object, e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown

        TextBox2.Text = (tmrTime.ElapsedTicks / Stopwatch.Frequency) * 1000
    End Sub
End Class 
```

问题在于，如果我采用两个文本框的非小数部分（即按下的绝对时间和释放的绝对时间），它们几乎总是耦合的，即奇数或偶数。

你知道发生了什么吗？

我使用 tmrTime.ElapsedMilliseconds 或 tmrTime.Elapsed.Ticks 得到相同的结果：-\

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:21:23.657

[在 MSDN 博客上有](http://blogs.msdn.com/b/ericlippert/archive/2010/04/08/precision-and-accuracy-of-datetime.aspx)一篇关于 .Net 中秒表/计时器精度的好文章。如果我正确理解您想要做什么，这应该可以解决您的问题：

```
Public Class Form1
    Private _sw As New Stopwatch

    Private Sub Form1_KeyDown(sender As Object, e As KeyEventArgs) Handles MyBase.KeyDown
        _sw.Start()
    End Sub

    Private Sub Form1_KeyUp(sender As Object, e As KeyEventArgs) Handles MyBase.KeyUp
        Dim elapsed As Long
        elapsed = _sw.ElapsedTicks
        _sw.Stop()
        tbTicks.Text = (elapsed / Stopwatch.Frequency) * 1000
        _sw.Reset()
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-26T15:41:51.150

Georg 发布的代码需要升级：

```
 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.KeyPreview = True
End Sub 
```

# watir - 与 javascript:window.location 链接

> ID：15119334
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:17:48.537
> 
> 标签：watir

知道如何单击具有以下条件的链接：

```
<a href="javascript:window.location='/app/exe/add.do?Id=8&val=1&callerURL=details'; 
```

我尝试了以下示例的几种变体，但似乎无法使其正常工作。

```
#$ie.a(:href => "http://app.com/app/exe/add.do?Id=8&val=1&callerURL=details").click
#$ie.link(:xpath,"//a[contains(@href='/app/exe/add.do?Id=8&val=1&callerURL=details')]/").click
#$ie.link(:href => "javascript:window.location='/app/exe/add.do?Id=8&val=1&callerURL=details'").click
#$ie.execute_script(:href => "javascript:window.location='/app/exe/add.do?Id=8&val=1&callerURL=details'").click
$ie.link(:xpath,"//a[contains(@href='/app/exe/add.do?Id=8&val=1&callerURL=details')]/").fire_event('onclick') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:03:22.230

如果您尝试通过字符串匹配 href，它必须是完全匹配的。您尝试的变体最后缺少一些字符。

尝试：

```
$ie.link(:href => "javascript:window.location='/app/exe/add.do?Id=8&val=1&callerURL=details';").click 
```

请注意`';`之前丢失的。

虽然必须有更好的东西来识别链接。也许它的文本或其父元素。基于这个href，这可能是动态的`Id=8`部分，很可能是脆弱的。

# excel - 如何在Excel中将一列转换为一行

> ID：15119335
> 
> 赞同：4
> 
> 时间：2013-02-27T18:17:50.567
> 
> 标签：excel, vba

我有以下 Excel 工作表：

```
 A
1 foo
2 bar
3 baz
4 bam 
```

（实际上，该专栏使手动转调不再是一种选择）。我怎样才能把这张表转换成

```
 A   B   C   D
1 foo bar baz bam 
```

我已经尝试过数据透视表功能，但无法获得我想要的输出。我还可以编写一个（php）脚本来读取和转换 Excel，但我无法想象这是在 Excel 中不容易完成的事情。但是，我一直无法找到这个问题的答案。你能帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T19:04:19.277

有两种简单的非编程方式：

1.  复制数据并在目标处，使用*选择性粘贴*->*转置*
2.  应用`TRANSPOSE`工作表功能：选择转置大小的范围（在您的示例中为 1 行 x 4 列并输入`=TRANSPOSE(A1:A4)`。您需要将其输入为数组公式，即按`Ctrl`- `Shift`-`Enter`

如果由于某种原因您需要通过代码执行此操作，则此 VBA 代码将执行以下操作：

```
Sub CopyTransposed(rngSource As Range, rngTargetCell As Range)
    rngTargetCell.Resize(rngSource.Columns.Count, rngSource.Rows.Count).Value = _
        Application.WorksheetFunction.Transpose(rngSource)
End Sub 
```

你可以简单地这样称呼它：

```
CopyTransposed [A1:A4], [C1] 
```

或更明确地说

```
CopyTransposed Sheets("SourceSheet").Range("A1:A4"),Sheets("TargetSheet").Range("C1") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:32:18.173

如果您只需要转置数据，（即没有格式）试试这个

```
Sub zx()
    Dim rng As Range
    Dim dat As Variant

    With ActiveSheet ' can be any sheet
        Set rng = .[A1:A5] ' get refernce to your data, by any means
        dat = rng ' copy data to array
        rng.Clear ' clear old data

        ' paste transposed data
        .Range(rng.Cells(1, 1), Cells(rng.Row, rng.Rows.Count)) = Application.Transpose(dat)
    End With
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:20:13.870

Ctrl+C 使用选择性粘贴进行复制和粘贴。单击对话框上的转置。

不过，这会将其粘贴为值....

# java - 如何检查/通过设置状态

> ID：15119346
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:18:44.537
> 
> 标签：java, android

我有一个首选项类，允许用户从应用程序的设置中打开“提示”：

```
public class Prefs extends PreferenceActivity {
//Option names and defualt values
private static final String OPT_HINTS = "hints";
private static final boolean OPT_HINTS_DEF = true;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.settings);
}
/**Get the current value of the hints option */
public static boolean getHints(Context context) {
    return PreferenceManager.getDefaultSharedPreferences(context).getBoolean(OPT_HINTS, OPT_HINTS_DEF);

}
} 
```

xml 文件包含：

```
<CheckBoxPreference
    android:key="hints"
    android:title="@string/hints_title"
    android:summary="@string/hints_summary"
    android:defaultValue="true" /> 
```

如何检查“提示”是否设置为开。然后如果它设置为 On，我想允许应用程序做某件事。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:22:26.810

> 如何检查“提示”是否设置为开。然后如果它设置为 On，我想允许应用程序做某件事。

使用您的代码只需调用：

```
if(getHints(this)) {
    // The preference is checked, do something
}
else {
    // The preference isn't checked
} 
```

尽管`PreferenceManager.getDefaultSharedPreferences(context)`随着您添加更多首选项，保存在类变量中可能会更容易。

# mysql - MySQL 不区分“e”和“é”（使用 JDBC）

> ID：15119348
> 
> 赞同：2
> 
> 时间：2013-02-27T18:18:47.960
> 
> 标签：mysql, jdbc, primary-key

我正在使用 UTF-8 排序数据库，这是一个应该能够区分“e”和“é”的字符集......不幸的是，直接从 MySQL Workbench 和/或 JDBC 发出以下 2 个插入

```
INSERT INTO `ucap_i10_13_02_27$12_48_41`.`attributes` (`attribute`, `intvalue`) VALUES ('brown-séquard', 1);

INSERT INTO `mytable`.`attributes` (`attribute`, `intvalue`) VALUES ('brown-sequard', 1); 
```

将“属性”列作为表上唯一的主键会导致...

```
Error Code: 1062 : Duplicate entry 'brown-sequard' for key 'PRIMARY' 
```

此外，在发出第一个重音插入后，对非重音版本进行查询，例如：

```
select * from `mytable`.`attributes` where attribute='brown-sequard'; 
```

将返回重音版本 'brown-séquard。

如何确保 MySQL 识别重音字符和非重音字符在主键约束方面的区别？

**更新 1**

我尝试了在 StackOverflow 帖子中找到的解决方案：

[MySQL 数据库中的 É 与 E](https://stackoverflow.com/questions/4110295/vs-e-in-mysql-database?rq=1)

那就是我添加了参数

```
&useUnicode=true&characterEncoding=UTF-8 
```

到我的 JDBC 连接字符串。这没有帮助:-(

**更新 2**

当我从命令行 mysql 客户端而不是 MySQL Workbench 运行带有重音 "e" '(brown-séquard') 的插入命令时，我收到以下有趣的错误代码：

```
ERROR 1366 (HY000): Incorrect string value: '\x82quard' for column 'attribute' at row 1 
```

但我怀疑它更多地与 windows 命令 shell/CLI 客户端阻塞重音编码而不是数据库连接本身有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:32:51.643

您所遇到的与字符排序有关，即[MySQL 比较字符的方式](https://dev.mysql.com/doc/refman/5.5/en/charset-collation-effect.html)。

您可以在查询中[使用`COLLATE`子句](https://dev.mysql.com/doc/refman/5.5/en/charset-collate.html)来强制使用此查询的特定排序规则，或更改表定义中的列排序规则，以使其始终以一种或另一种方式使用。

# macros - 从另一个命名空间调用的宏生成宏 :: 不能引用不存在的限定变量

> ID：15119351
> 
> 赞同：3
> 
> 时间：2013-02-27T18:19:00.013
> 
> 标签：macros, clojure

我有一个宏生成宏，我试图从另一个命名空间调用它，但它失败并显示“无法引用不存在的合格变量”。

我设法在下面的代码中重现它，这是最简单的例子，可以说明问题。我还找到了一种解决方法，但是我想了解问题的原因以及是否存在更好的解决方案。

# 问题

### 文件 foo.clj

```
(ns foo)
(defmacro create-my-macro []
  `(defmacro my-macro []
      nil)) 
```

### 文件 boo.clj

```
(ns boo (:use [foo]))
(create-my-macro) 
```

上面的代码执行时：

```
java -cp clojure-1.4.0.jar clojure.main boo.clj 
```

...失败：

```
Exception in thread "main" java.lang.RuntimeException: Can't refer to qualified var that doesn't exist, compiling:(...boo.clj:2) 
```

# 解决方法

出于某种原因，当宏生成宏被增强以接受要创建的宏的名称作为参数时，没有失败。

### 文件 foo.clj

```
(ns foo)
(defmacro create-my-macro [macroName]
  (let [the-macroName (symbol macroName)]
    `(defmacro ~the-macroName []
         1))) 
```

### 文件 boo.clj

```
(ns boo (:use [foo]))
(create-my-macro "foo")
(println (foo)) 
```

如上所述运行文件 boo.clj 在控制台上输出一个干净的“1”，没有任何抱怨。

那么，在第一种情况下出了什么问题，是否有另一种方法可以修复它，更改宏生成宏以接受要生成的宏的名称作为参数？另外，当从同一个命名空间调用宏生成宏时，为什么它不会失败？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T19:19:06.803

如果您希望宏将符号引入运行它的命名空间，而不是写入它的命名空间，您可以使用 和 的组合`unquote`来`quote`获取 defmacro 以在宏扩展时生成一个普通的不合格符号

```
(ns foo)
(defmacro create-my-macro []
  `(defmacro ~'my-macro []
      nil))

boo> (my-macro) 
nil 
```

调用`(symbol macroName)`通过从字符串创建非命名空间限定符号来完成非常相同的事情。您可以在第一个示例中使用相同的表单：

```
(defmacro create-my-macro []
  `(defmacro ~(symbol "my-macro") [] 
      "new-result")) 

boo> (my-macro) 
"new-result" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:23:44.913

***“那么，第一种情况出了什么问题，是否有另一种方法来解决它，改变宏生成宏以接受要生成的宏的名称作为参数？”***

错误是宏正试图做一些称为“符号捕获”的事情：它试图定义一个可能最终覆盖目标命名空间中已经存在的符号的符号，而 clojure 试图保护您免受相关的错误的影响带符号捕获。

如果您确信您需要的是符号捕获，那么执行 Arthur Ulfeldt 上面的建议就是您所需要的（使用 unquote 引用组合 ~'my-macro）

但我对您的建议是使用初始解决方案的变体，并明确说明您的宏将在当前命名空间中定义一个变量：

```
(ns foo)
(defmacro create-my-macro [macroName]
  `(defmacro ~macroName [] `1)) 
```

对您的宏的调用如下所示：

```
(create-my-macro mymacro) 
```

这将创建一个名为“mymacro”的宏，然后可以按如下方式调用它：

```
(mymacro)   ;; would return 1 
```

***“另外，为什么从同一个命名空间调用宏生成宏时它不会失败？”***

不确定这一点，但我的猜测是，当您在存在宏的同一名称空间中定义符号时，假设您知道哪些符号已在使用，并且负责不覆盖（捕获）已无意中使用的符号. 而在从不同名称空间调用的情况下，符号捕获（如果允许）对您来说将是一个令人惊讶的副作用。同样，这只是我的猜测。

# c# - CompositionTarget.Rendering 并不总是在刷新时触发

> ID：15119353
> 
> 赞同：1
> 
> 时间：2013-02-27T18:19:06.043
> 
> 标签：c#, .net, wpf

我观察到 CompositionTarget.Rendering 的以下行为：如果我在事件处理程序中不做任何事情，它每秒会提升 30 次。如果我使事件处理程序中的某些内容无效，则每秒会引发 60 次（每帧引发数次时丢弃时间）。

我的显示器的刷新率为 60hz，因此如果上次引发事件时未执行任何操作，该事件似乎会跳过刷新。

这种行为的原因是什么，有什么方法可以在显示器的刷新率下始终如一地调用，而不会每次都使某些东西失效？

顺便说一下，这是在 .NET 3.5 上的。

# python - 如何将文档字符串添加到我无法写入的模块中

> ID：15119355
> 
> 赞同：0
> 
> 时间：2013-02-27T18:19:36.813
> 
> 标签：python, docstring

我有一个以编程方式写入附加功能的模块。
IE：

```
def fun1():   # function written on 27.02.13
    ...

def fun2():   # function written on 28.02.13
    ... 
```

我想在运行时向模块本身和这些函数添加[文档字符串](https://en.wikipedia.org/wiki/Docstring#Python)，而不修改文件。

这可以通过另一个脚本来完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:22:02.473

您可以，只需`__doc__`向模块添加一个属性：

```
import foo

foo.__doc__ = '''My docstring for this module''' 
```

# c# - 设计一个更好的记录器类

> ID：15119364
> 
> 赞同：0
> 
> 时间：2013-02-27T18:19:50.433
> 
> 标签：c#, multithreading, design-patterns, locking

你能批评一下下面的记录器类吗？可以在多线程网络环境中使用吗？如果没有，我该如何改进它？WriteToLog 方法中的锁定或 FlushLog 方法中的多线程有什么问题吗？

```
public class Logger
{
    private static Logger instance;
    private static Queue<LogData> logQueue;
    private static string logDir = HttpContext.Current.Server.MapPath(ConfigurationManager.AppSettings["LogDirectory"]);
    private static string logFile = "log.txt";
    private static int maxLogAge = Int32.Parse(ConfigurationManager.AppSettings["LogMaxAge"]);
    private static int queueSize = Int32.Parse(ConfigurationManager.AppSettings["LogQueueSize"]);
    private static DateTime LastFlushed = DateTime.Now;

    private Logger() { }

    public static Logger Instance
    {
        get
        {
            if (instance == null)
            {
                instance = new Logger();
                logQueue = new Queue<LogData>();
            }
            return instance;
        }
    }

    public void WriteToLog(string message)
    {
        lock (logQueue)
        {
            LogData logEntry = new LogData(message);
            logQueue.Enqueue(logEntry);

            if (logQueue.Count >= queueSize || DoPeriodicFlush())
            {
                FlushLog();
            }
        }            
    }

    private bool DoPeriodicFlush()
    {
        TimeSpan logAge = DateTime.Now - LastFlushed;
        if (logAge.TotalSeconds >= maxLogAge)
        {
            LastFlushed = DateTime.Now;
            return true;
        }
        else
        {
            return false;
        }
    }

    private void FlushLog()
    {
        System.Threading.ThreadPool.QueueUserWorkItem(q => {
            while (logQueue.Count > 0)
            {
                LogData entry = logQueue.Dequeue();
                string logPath = logDir + entry.LogDate + "_" + logFile;

                using (System.IO.StreamWriter file = new System.IO.StreamWriter(logPath, true, System.Text.Encoding.UTF8))
                {
                    file.WriteLine(string.Format("{0}\t{1}", entry.LogTime, entry.Message));
                }
            }
        });
    }

    ~Logger()
    {
        FlushLog();
    }
}

public class LogData
{
    public string Message { get; set; }
    public string LogTime { get; set; }
    public string LogDate { get; set; }

    public LogData(string message)
    {
        Message = message;
        LogDate = DateTime.Now.ToString("yyyy-MM-dd");
        LogTime = DateTime.Now.ToString("HH:mm:ss.fff tt");
    }
} 
```

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:29:54.793

此代码不是线程安全的。您在添加到队列时同步（锁定），但从代码中删除的代码不会锁定队列，并且将始终在后台线程上运行，这将导致潜在的竞争条件。

如果您真的必须编写自己的日志记录，我至少会考虑使用[`ConcurrentQueue<T>`](http://msdn.microsoft.com/en-us/library/dd267265.aspx)以避免锁定添加的需要。 `BlockingCollection<T>`会使这更简单，因为您可以`GetConsumingEnumerable()`在添加项目时进行线程调用来处理它们。

话虽如此，日志记录已经被处理了很多次，并且处理得很好。最好使用新的[语义日志记录应用程序块](http://entlib.codeplex.com/releases/view/101823)（来自 P&P）甚至[log4net](http://logging.apache.org/log4net/)之类的东西。

# codeigniter - 结果基于日期并另存为已完成

> ID：15119365
> 
> 赞同：1
> 
> 时间：2013-02-27T18:19:52.300
> 
> 标签：codeigniter, codeigniter-2

我目前正在使用 CodeIgniter 为我的公司构建一个 CMS/CRM 系统，我需要一种基于事件是否完成来显示结果列表/表格的方法。

因此，如果事件 start_date 是过去的（基于当前时间戳），我需要一种方法将数据库中的“活动”列动态设置为 0，从而不显示记录。

你们将如何解决这个问题？真的很感激你的想法。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:01:42.467

就像您提出问题以拉出列表一样简单：

```
$data = $this->db->get_where('table',array('start_date <'=>date('Y-m-d H:i:s',strtotime('now'))))->result_array(); 
```

如果您需要进行更新以显示事件已完成：

```
$this->db->where('active >',0)->where('start_date <',date('Y-m-d H:i:s',strtotime('now')))->update('table',array('active'=>0)); 
```

也就是说，如果 start_date 列是 mysql 时间戳。但无论如何，这听起来很简单。

# accurev - ACCUREV_IGNORE_ELEMS 模式不拾取名称中带有数字的外部文件

> ID：15119370
> 
> 赞同：0
> 
> 时间：2013-02-27T18:20:04.983
> 
> 标签：accurev

ACCUREV_IGNORE_ELEMS 没有过滤掉看起来像这样的文件：

lib/junit/junit/4.10 或 lib/.cache/m2e/0.12.1/xxxx

我已经尝试过这些，但似乎没有一个文件可以拾取这些文件：

*/lib/* lib/* lib/** */lib/* * **/lib/**

它在文档中说通配符获取所有字符，包括路径分隔符。问题似乎特别在于名称中带有数字或下划线的文件和目录。其他文件被过滤掉。

对可行的模式有什么建议吗？

问题发生在外部搜索视图中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T19:52:28.840

在**lib**文件夹中，创建一个名为**.acignore**的文件。这将允许您创建特定于该文件夹的忽略规则。例如，如果我想忽略该目录中的 .o 和 .class 文件，则**.acignore**的内容将是：

```
*.o
*.class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:28:53.457

lib目录是外部文件吗？这意味着它在您的 accurev 工作区中是否具有外部状态？

如果此目录不是外部目录，则 ACCUREV_IGNORE_ELEMS 环境变量不会隐藏 AccuRev GUI 中的内容。

例子：

c:\wspaces\test>ls

lib src test-src

c:\wspaces\test>accurev 文件

.\test-src src\1 (1454\1) (支持)

.\src src\1 (2\1) (支持)

c:\wspaces\test>设置| grep 忽略

ACCUREV_IGNORE_ELEMS=lib

# telerik - 如何从不同的 GridTemplateColumn Radcombobox OnSelectedIndexChanged 事件中找到 GridTemplateColumn 中的 RadComboBox

> ID：15119371
> 
> 赞同：0
> 
> 时间：2013-02-27T18:20:09.727
> 
> 标签：telerik, radcombobox

我有两个 GridTemplateColumn(s)，每个都包含一个 RadCombobox。当左侧组合框 OnSelectedIndexChanged 事件触发时，我需要根据左侧的新值重新填充右侧组合框。我似乎无法以任何方式从事件中找到 FindControl。

```
 <telerik:GridTemplateColumn HeaderText="CAKE Verticals" ItemStyle-Width="100px">
                <ItemTemplate>
                </ItemTemplate>
                <EditItemTemplate>
                    <telerik:RadComboBox runat="server" ID="RadComboBox_CakeVerticals"  EnableLoadOnDemand="True"
                        OnItemsRequested="RadComboBox_CakeVerticals_ItemsRequested" AutoPostBack="true"
                        HighlightTemplatedItems="true" Height="140px" Width="220px" DropDownWidth="420px"
                        OnSelectedIndexChanged="RadComboBox_CakeVerticals_OnSelectedIndexChangedHandler">
                    </telerik:RadComboBox>
                </EditItemTemplate>
            </telerik:GridTemplateColumn>
            <telerik:GridTemplateColumn UniqueName="CakeColumns" HeaderText="CakeColumns" ItemStyle-Width="100px">
                <ItemTemplate>
                </ItemTemplate>
                <EditItemTemplate>
                    <telerik:RadComboBox runat="server" ID="RadComboBox_CakeColumns" EnableLoadOnDemand="True"
                        OnItemsRequested="RadComboBox_CakeColumns_ItemsRequested" AutoPostBack="true"
                        HighlightTemplatedItems="true" Height="140px" Width="220px" DropDownWidth="420px"
                        OnSelectedIndexChanged="RadComboBox_CakeColumns_OnSelectedIndexChangedHandler">
                    </telerik:RadComboBox>
                </EditItemTemplate>
            </telerik:GridTemplateColumn> 
```

并且在 CS

```
protected void RadComboBox_CakeVerticals_OnSelectedIndexChangedHandler(object sender, RadComboBoxSelectedIndexChangedEventArgs e)
{
    RadComboBox combobox = (RadComboBox)RadGrid_Columns.FindControl("RadComboBox_CakeColumns");
    Session["verticalID"] = e.Value;

    RCB_CAKE_Columns_Populate(e.Value, combobox);

} 
```

问题是组合框始终为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:38:14.880

我解决了这样的问题

```
 RadComboBox RCB_Verticals = sender as RadComboBox;

    GridDataItem item = (GridDataItem)RCB_Verticals.NamingContainer;

    RadComboBox combobox = (RadComboBox)item.FindControl("RadComboBox_CakeColumns"); 
```

这只是遵循 NamingContainer 的层次结构到行级别的问题。

# c# - 嵌套复选框

> ID：15119374
> 
> 赞同：0
> 
> 时间：2013-02-27T18:20:32.270
> 
> 标签：c#, asp.net

假设未指定深度（深度大于 2！），我如何在 ASP.NET 中创建嵌套的 CheckBoxList？我不能使用中继器。

好的，添加一些细节：

我有一个名为 Employee 的表，其中包含以下字段：

ID 名称 BossID

其中 BossID 是员工的 ID。所以我们有一对一的关系。所以每个员工都必须有一个老板（除了大老板），这就是一个孩子和父母的模型。现在我希望当用户单击老板复选框时，将检查他的所有员工。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:55:09.310

您最好的选择是编写一些代码将您的复选框列表嵌套在 div 或其他包含标签中。

我建议您制作一个控件来帮助隔离代码，以免它与现有代码混淆。您的控件应该只有一个`asp:Panel`。还有一个属性可以传递嵌套结构中的项目（我的猜测是，`Dictionary<string, int>`但你必须决定）

在您的`Load`活动中，动态创建 CBL 和子容器 (div) 并将它们附加到面板。顺序应该是：

```
asp:Panel
    CheckBoxList 1
    div
        CheckBoxList 2
        div 
```

你可以看到这可能会很快变得复杂。

最后要做的是确保将`SelectedIndexChanged`事件侦听器添加到所有复选框列表中。

[这篇文章](http://forums.asp.net/p/1458411/3346353.aspx/1?Re%20Nesting%20RadioButtonList)可能有更多信息可以帮助您。

# objective-c - 解析Json响应iphone目标c

> ID：15119377
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:20:37.473
> 
> 标签：objective-c

我在 json 中有以下响应，我不确定如何解析它

```
[{"WordArray":[{"Id":11,"Word1":"ODDER","Category":"Dyr","Differculty":1,"Language":"Danish"},{"Id":225,"Word1":"PRAG","Category":"International by","Differculty":1,"Language":"Danish"}]},{"WordArray":[{"Id":3,"Word1":"TIGER","Category":"Dyr","Differculty":1,"Language":"Danish"},{"Id":154,"Word1":"BOLLE","Category":"Mad og drikke","Differculty":1,"Language":"Danish"}]},
{"WordArray":[{"Id":3,"Word1":"TIGER","Category":"Dyr","Differculty":1,"Language":"Danish"},{"Id":147,"Word1":"PIZZA","Category":"Mad og drikke","Differculty":1,"Language":"Danish"}]}] 
```

我试过以下没有运气

```
NSMutableArray* json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];

NSMutableArray * roundWords = [[NSMutableArray alloc]retain ];

roundWords = [json objectAtIndex:i]; 
```

json 包含我的 3 'WordArray' 但我不确定如何继续.. 例如，如何遍历每个项目`WordArray`并 NSLog`Word1`值？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:24:52.600

> 我如何遍历 WordArray 和 NSLog 中的每个项目 Word1 值

使用快速枚举。

```
for (NSDictionary *dict in array) {
    NSLog(@"%@", [dict objectForKey:@"Word1"]);
} 
```

顺便说一句，您的代码在几个地方是错误的：

```
NSMutableArray *roundWords = [[NSMutableArray alloc] retain];
roundWords = [json objectAtIndex:i]; 
```

一，不使用这样`retain`的chained with `alloc`。用于`init`初始化对象。

二：除非您使用 ARC（您不使用），否则您将使用该行泄漏内存 - 指向原始数组的指针被丢弃，因为您重新分配了其他内容。

三：`[json objectAtIndex:i]`不是`NSMutableArray`- 它是一个`NSDictionary`（顺便说一句，它是**不可变**的。声明不是魔法 - 但是你声明你的变量，它不会影响`NSJSONSerialization`返回不可变字典的事实，除非另有说明）。

# jstree - jstree：防止父节点成为叶子节点

> ID：15119378
> 
> 赞同：0
> 
> 时间：2013-02-27T18:20:39.597
> 
> 标签：jstree, drag-and-drop

我有一个简单的两级 jstree，它允许在父节点之间拖放叶节点。当父节点仅包含一个叶子时，当我将叶子拖出时，父节点“变成”叶子节点。我想阻止这种情况，但我找不到任何文档告诉我如何做到这一点。

我已经包含了正在发生的事情的图片表示。请注意，在图 2 中，父节点“Proctor”在外观上认为它是一个叶节点。我仍然可以将项目拖入其中，它再次成为非叶节点。如果父节点无论是否为空都保持组图标外观，则此界面更有意义。另请注意，当树最初打开时，空父节点会出现组图标（这是一件好事）。

这是最初出现的树：

![在此处输入图像描述](../Images/6b09db7968d3fd0ed1731a2b3af811f9.png)

这是我将 Paul Postler 从 Proctor 拖到 Contributor 后的树：

![在此处输入图像描述](../Images/3d8f7f6f1aef90aa672a04cc6a12a52e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:00:23.990

我想出了一种方法来做到这一点，但它不是特别干净。任何其他答案将不胜感激。这是我添加到绑定 move_node.jstree 代码中的内容：

```
var oldParent = document.getElementById(
    (oldIsUnassigned) ? "Unassigned" : "P" + oldRoleId);
var className = oldParent.className.replace("jstree-leaf", "");
if (className.indexOf("jstree-drop") < 0) className += " jstree-drop";
if (className.indexOf("jstree-open") < 0) className += " jstree-open";
oldParent.className = className; 
```

# mysql - 如何订购我的 MySQL 记录？| MySQL - WordPress

> ID：15119379
> 
> 赞同：0
> 
> 时间：2013-02-27T18:20:42.923
> 
> 标签：mysql, wordpress

我正在为基于 WordPress 的客户创建一个网站。我的客户希望在主页中显示按类别分组的文章。

例如，假设我们有类别“Cat A”、“Cat B”和“Cat C”。我的客户希望在主页中以“Cat B”、“Cat A”和“Car C”的方式显示类别顺序，然后在主页中列出每个类别的 6 个帖子。

假设这是我要显示的结果：

```
Cat B
---------------------------
Cat B - Article #1
Cat B - Article #2
Cat B - Article #3
Cat B - Article #4
Cat B - Article #5
Cat B - Article #6

Cat A
---------------------------
Cat A - Article #1
Cat A - Article #2
Cat A - Article #3
Cat A - Article #4
Cat A - Article #5
Cat A - Article #6

Cat C
---------------------------
Cat C - Article #1
Cat C - Article #2
Cat C - Article #3
Cat C - Article #4
Cat C - Article #5
Cat C - Article #6 
```

我正在寻找的是一种排序要在主页中显示的类别的方法。

现在我已经在我的 WordPress 仪表板中创建了一个页面，从那里我可以根据需要对我的类别进行排序，然后我可以将订单选项保存在 wp 选项页面中。问题是，如何根据后端的顺序对前端的类别进行排序。

假设类别如下：

```
Categories
-----------------
Name   |  ID
-----------------
Cat A  |  100
Cat B  |  101
Cat C  |  102 
```

在我的 wp_options 表中，我可以存储以下数组：

```
array(
    1 => 101,
    2 => 100,
    3 => 102
) 
```

数组键可以是订单序列，值可以是类别 ID。

现在，通过知道序列是什么，我如何使用单个 MySQL Query 获得结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:57:04.567

分类（例如类别或标签）中的每个项目（例如类别或标签）都有一个名称、一个 slug（可以进入 URL 的短名称）和一个描述。

如果您愿意将描述专门用于订购您的类别项目，您可以在该字段中为 Cat B 输入 1，为 Cat A 输入 2，为 Cat C 输入 3。您可以从仪表板执行此操作。

然后，当您检索术语时，您可以使用此查询以适当的顺序获取类别 ID。

```
SELECT t.term_id, t.name, t.slug
  FROM wp_terms t
  JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id
 WHERE tt.taxonomy = 'category'
 ORDER BY tt.description, t.term_id 
```

但这会占用您的描述字段，或者至少将一些内部垃圾放入由少数（但不是很多）主题用于显示目的的字段中。

您也可以将 slug 用于此订购目的。例如，您可以指定 '1catb' 来代替 'catb' （对于其他 slug 使用 '2cata' 和 '3catc'）。同样，它会对您的显示产生一些影响，这一次是以您网站中某些 URL 的形式出现的。这是您在这种情况下可能使用的查询/

```
SELECT t.term_id, t.name, t.slug
  FROM wp_terms t
  JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id
 WHERE tt.taxonomy = 'category'
 ORDER BY t.slug, t.term_id 
```

在我看来，将单个 wp_options 行转换为可连接表太麻烦了，不值得麻烦，尤其是对于经常显示的网站前门页面。但是您可以为此使用多个 wp_options 行。像这样给你的 wp_options 名称和值：

```
 option_name       option_value
   mycat_order_001       2
   mycat_order_002       1 
   mycat_order_003       3 
```

然后使用这样的查询来按顺序获取您的类别名称。

```
SELECT t.term_id, t.name, t.slug
  FROM wp_terms t
  JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id
  JOIN wp_options o ON (    o.option_name LIKE 'mycat_order_%'
                        AND o.option_value = t.term_id)
 WHERE tt.taxonomy = 'category'
 ORDER BY o.option_name, t.term_id 
```

这将以正确的顺序提取您的条款。这里的成本是当您的用户指定所需顺序时更新 wp_options 表的更复杂的代码位。

所以有一些替代方案。请记住，简单就是好的。

# javascript - 使用 Javascript .numeric 函数只允许 2 位小数

> ID：15119382
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:20:51.580
> 
> 标签：javascript, jquery, asp.net-mvc-3

您如何使用该`.numeric`功能只允许指定的小数位数？下面是我正在使用的代码行：

```
 $('#Distance').numeric({ allow: "." }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:21:08.017

我不清楚您使用的是哪个插件，但我猜它是这两个之一：

texotela.co.uk/code/jquery/numeric/auroratrading.co.th/js/
_

对于它们两者，它们都没有配置选项来限制小数点后的数字字符数。

还有另一个名为 meio mask 的 jQuery 插件可以让你完成你想要的，见（十进制演示）： [http ://www.meiocodigo.com/projects/meiomask/#mm_demos](http://www.meiocodigo.com/projects/meiomask/#mm_demos)

粗略地浏览一下页面，您选择了一个“掩码”（在您的情况下为“decimal-us”）并将其分配给输入元素的“alt”属性。之后，您在准备好的侦听器中调用 setMask 方法。让我知道这是否适合您！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:31:01.440

如果你有类似的标记

```
<input type="text" value="2.235323232"/> 
```

尝试

```
$(":input").val(parseFloat($(":input").val()).toFixed(2)); 
```

[http://jsfiddle.net/WYyt3/](http://jsfiddle.net/WYyt3/)

# c# - 如何在 asp.net mvc 中重定向到正确的控制器操作

> ID：15119385
> 
> 赞同：2
> 
> 时间：2013-02-27T18:21:10.600
> 
> 标签：c#, asp.net, asp.net-mvc, post, get

好的，所以我有一个片段应该重定向到控制器的操作。

```
return RedirectToAction("add"); 
```

现在的问题是`add`动作超载。一个在 HTTPrequest 是`GET`类型时调用，另一个在请求是`POST`类型时调用。无论如何我可以选择语句重定向到哪个动作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:23:34.690

[RedirectToAction](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.redirecttoaction%28v=vs.108%29.aspx)向客户端浏览器返回 302（已移动）响应。`GET`是您摆脱它的唯一方法。

如果您之所以问是因为您想调用您的 POST/add 操作，那么这个[相关问题](https://stackoverflow.com/questions/1936/how-to-redirecttoaction-in-asp-net-mvc-without-losing-request-data)可能会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:28:03.617

尝试这个

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult add()
{
    ...
}

[ActionName("add")]
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult add_post()
{
    ...
} 
```

这样，您可以 POST 和 GET 来添加，并在控制器中调用 add 或 add_post

# jquery - 使用 Blueimp jquery 文件上传插件的可选文件上传

> ID：15119386
> 
> 赞同：8
> 
> 时间：2013-02-27T18:21:12.787
> 
> 标签：jquery, jquery-file-upload, blueimp

该问题与[来自blueimp的jquery文件上传插件有关](https://github.com/blueimp/jQuery-File-Upload)

我正在构建一个文件上传是可选的表单。事实证明，当没有选择要上传的文件时，我无法发布表单。正因为如此，如果用户决定不添加实际数据，我必须在我的页面上创建两个表单并执行所有脏检查以删除上传的文件。

问题是 ：

即使没有选择文件，我是否可以提交表单，以便我仍然能够在服务器端接收额外的表单数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-27T22:40:58.043

我自己也有同样的问题。我有一个表单（内置 Angular），使用蓝色 imp 角度实现。表单本身有字段；该文件是可选的。需要是一个帖子（有或没有文件）。

在 submit() 上没有任何反应。

上面列出的“有用事件”仅在添加文件时触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-20T16:42:26.713

我知道我迟到了，但迄今为止没有列出真正的解决方案。您可以通过手动调用 add 事件来伪造正在添加文件的事实，例如：

```
$('#fileupload').fileupload('add', { files: [{}] }); 
```

您将设置一个变量来存储表单信息，在添加时更新变量并在没有文件的情况下触发上述添加。下面是代码的样子：

```
var fileData;
$('#fileupload').fileupload({
    add: function (e, data) {
        fileData = data;
    }
});

$('form').submit(function () {
    if (!fileData) {
        $('#fileupload').fileupload('add', { files: [{}] });
    }
    fileData.formData = params;
    fileData.submit();
    return false;
}); 
```

这使您可以与数据传递到服务器的方式保持一致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-04T09:03:46.127

我知道这是一个老问题，但对于那些在同一问题上苦苦挣扎的人来说：

您需要在此处深入了解文档：

[https://github.com/blueimp/jQuery-File-Upload/wiki/Options](https://github.com/blueimp/jQuery-File-Upload/wiki/Options)

还有一个有用的事件列表：

```
$('#fileupload')
.bind('fileuploadadd', function (e, data) {/* ... */})
.bind('fileuploadsubmit', function (e, data) {/* ... */})
.bind('fileuploadsend', function (e, data) {/* ... */})
.bind('fileuploaddone', function (e, data) {/* ... */})
.bind('fileuploadfail', function (e, data) {/* ... */})
.bind('fileuploadalways', function (e, data) {/* ... */})
.bind('fileuploadprogress', function (e, data) {/* ... */})
.bind('fileuploadprogressall', function (e, data) {/* ... */})
.bind('fileuploadstart', function (e) {/* ... */})
.bind('fileuploadstop', function (e) {/* ... */})
.bind('fileuploadchange', function (e, data) {/* ... */})
.bind('fileuploadpaste', function (e, data) {/* ... */})
.bind('fileuploaddrop', function (e, data) {/* ... */})
.bind('fileuploaddragover', function (e) {/* ... */})
.bind('fileuploadchunksend', function (e, data) {/* ... */})
.bind('fileuploadchunkdone', function (e, data) {/* ... */})
.bind('fileuploadchunkfail', function (e, data) {/* ... */})
.bind('fileuploadchunkalways', function (e, data) {/* ... */}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-16T09:23:58.067

设置`SingleFileUploads`为`false`对 JQuery 文件上传器没有太大帮助，因为这里讨论的似乎有一个[错误](https://stackoverflow.com/questions/31955786/how-to-make-jquery-file-upload-plugin-call-backend-only-once-for-all-the-files-i/32033328#32033328)。所以我把那件事恢复为真。

我将输入分成两种单独的形式——一种用于文本字段输入，另一种用于文件（通过 JQuery 文件上传器）。对于文本字段表单，我保留了一个用户可以单击的可见按钮。对于另一个，我隐藏了按钮。因此，一旦用户单击可见按钮，我只提交文本输入并在后端创建一个数据库记录（这是使用 AJAX 调用完成的），并且在 AJAX 调用的成功字段中，我 .click() 隐藏按钮如果文件数大于 0。

# coffeescript - 如何更新咖啡脚本类中的属性

> ID：15119387
> 
> 赞同：0
> 
> 时间：2013-02-27T18:21:17.513
> 
> 标签：coffeescript

当我调用“scanner.connect()”方法时，我正在尝试使用以下代码更新属性：

```
class Scanner
    ready: false

    connect: () =>
        cordova.exec (status) =>
            console.log status
            if status is 'connected'
                @ready = true
                console.log @ready
        ,
        (error) ->
            console.log error
        ,
        "LineaProScanner", "ready", []

    scan: () ->
        console.log 'start scan...'
    stop: () ->
        console.log 'stopping scan...' 
```

然后，当我访问scanner.ready 属性时，它总是显示为false。

```
scanner = new Scanner()
scanner.connect()
console.log scanner.ready // always shows false 
```

我刚开始使用 CoffeeScript，所以我知道我做错了什么哈哈，但我不确定是什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:30:58.233

你的咖啡脚本看起来不错，这里应该归咎于执行顺序，这个问题也让普通的 JS 程序员绊倒了很多。

我打赌`cordova.exec()`是异步的，所以你在它回调并设置就绪之前询问它是否准备好。

试试这个，看看我是否正确：

```
scanner = new Scanner()
scanner.connect()
setTimeout (-> console.log scanner.ready), 1000 
```

`true`只要扫描仪在不到一秒的时间内准备好，就应该记录下来。但这不是您应该如何构建此代码的方式。

* * *

正确的方法是，而不是`setTimeout`你想要你自己的回调。

```
class Scanner
    ready: false

    # Accept a callback argument on the connect method.
    connect: (onReady) =>
        cordova.exec (status) =>
            console.log status
            if status is 'connected'
                @ready = true
                console.log @ready

                # call the onReady callback if it was passed in
                onReady?()
        ,
        (error) ->
            console.log error
        ,
        "LineaProScanner", "ready", [] 
```

现在您可以简单地执行以下操作：

```
scanner = new Scanner()
scanner.connect ->
  console.log scanner.ready # should log `true` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T13:54:17.000

您可以简化`=>`这一行：

`connect: (onReady) ->`

类方法可以直接访问类变量。但是方法内部的函数没有。

# android - 当没有 SD 卡时，ProgressDialog 在 Galaxy S3 上不显示

> ID：15119388
> 
> 赞同：3
> 
> 时间：2013-02-27T18:21:20.707
> 
> 标签：android, progressdialog, sd-card, android-sdcard

好的，如果有人可以回答，我在这里有一个奇怪的问题。

我有一个应用程序可以启动默认相机拍照并将其上传到服务器。上传过程发生在扩展 AsyncTask 的内部类中。在调用异步任务之前，我有一个显示进度对话框的方法，然后在 AsyncTask 的 onPost Execute 方法中将其关闭。这一切都在我自己的设备上运行良好。当我在三星 Galaxy S3 上进行测试时，问题就出现了。

我在 progressDialog.Show(); 上得到一个空指针异常；它不会使应用程序崩溃，它只是不显示对话框。但是当我尝试关闭关于 PostExecute 的对话框时，我确实遇到了崩溃。我认为这是因为 S3 的相机似乎只在横向打开（尽管我的整个应用程序以 Google 可以告诉我的各种方式锁定为纵向）并且方向更改导致活动刷新导致引用progressDialog 将丢失。

对话框实例化的位置没有任何改变（onPreExecute() 确实有效，但我仍然遇到同样的问题），检查它是否为空或保存实例状态已经解决了这个问题。我在另一篇文章中读到，有些人在保存到 SD 卡时遇到了问题。S3 没有 SD 卡，但应用程序正在尝试写入外部存储。我尝试检查是否有 SD 卡在使用。

```
Boolean isSDPresent = android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED); 
```

即使没有 SD 卡，这实际上也返回了 true。将图像写入外部存储并不重要，因此我尝试使用它获取缓存副本。

```
File image = File.createTempFile(
            imageFileName, 
            JPEG_FILE_SUFFIX, 
            this.getCacheDir()
            ); 
```

这也没什么区别。为什么你问我是否关心这个 SD 卡问题，它不可能影响进度对话框。好吧，如果我将 SD 卡放入 S3，问题就会消失，并且进度对话框会完美显示。我不知道为什么会这样，但我不能保证使用该应用程序的人在他们的设备中会有 SD 卡，所以我需要找到一个合适的修复程序。

很抱歉这篇文章，但我认为它需要一些解释才能清楚地理解。任何想法或解决方案将不胜感激。

下面的代码是我正在使用的精简版本，我试图仅包含相关材料。

```
 @Override  public void onCreate(Bundle savedInstanceState) { 
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.compare_layout_activity);

          findViewById(R.id.bCompare).setOnClickListener(new OnClickListener() {            
          public void onClick(View v) {
        try{
           capturedImage = createImageFile();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        if(isNetworkAvailable()){
            Intent i = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
            i.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(capturedImage));
            startActivityForResult(i, REQ_CODE_PHOTO_TAKE);
        }
        else{
            displayAlert("Network Error", "You do not have access to the internet. Please turn on your WiFi.");
            }           
         }      
     });

}

protected File createImageFile() throws IOException {
        // Create an image file name
        String timeStamp = 
                new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        String imageFileName = JPEG_FILE_PREFIX + timeStamp + "_";
        File image = File.createTempFile(
                imageFileName, 
                JPEG_FILE_SUFFIX, 
                this.getCacheDir()
                );

        capturedImagePath = image.getAbsolutePath();

        return image;
    }

 @Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (resultCode == Activity.RESULT_OK) {
        showProgressDialog();
        new LongOperation(getApplicationContext()).execute("");

    } else if (resultCode == Activity.RESULT_CANCELED) {

    }               
}

private void showProgressDialog(){
    progressDialog = new ProgressDialog(this);
    progressDialog.setMessage("Checking progress");
    progressDialog.setCanceledOnTouchOutside(false);
    progressDialog.show();

  }

//I wont include the full async task because the code executes fine except for the crash on the show progress Dialog so i'll include the onPostExecute
    @Override
    protected void onPostExecute(String result) { 
    if (progressDialog != null) {
        progressDialog.dismiss(); 
    } 
```

几乎忘记包含堆栈跟踪，尽管它不是最有用的信息。这发生在 progressDialog.show();

```
02-27 18:11:33.945: E/WindowManager(21994): Activity com.activity.CompareActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@41ed6318 that was originally added here
02-27 18:11:33.945: E/WindowManager(21994): android.view.WindowLeaked: Activity com.activity.CompareActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@41ed6318 that was originally added here
02-27 18:11:33.945: E/WindowManager(21994):     at android.view.ViewRootImpl.<init>(ViewRootImpl.java:402)
02-27 18:11:33.945: E/WindowManager(21994):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:311)
02-27 18:11:33.945: E/WindowManager(21994):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:224)
02-27 18:11:33.945: E/WindowManager(21994):     at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:149)
02-27 18:11:33.945: E/WindowManager(21994):     at android.view.Window$LocalWindowManager.addView(Window.java:558)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.Dialog.show(Dialog.java:277)
02-27 18:11:33.945: E/WindowManager(21994):     at com.activity.CompareActivity.showProgressDialog(CompareActivity.java:324)
02-27 18:11:33.945: E/WindowManager(21994):     at com.activity.CompareActivity.onActivityResult(CompareActivity.java:249)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.Activity.dispatchActivityResult(Activity.java:5368)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3178)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2603)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2644)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2130)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3553)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.access$700(ActivityThread.java:140)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1233)
02-27 18:11:33.945: E/WindowManager(21994):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 18:11:33.945: E/WindowManager(21994):     at android.os.Looper.loop(Looper.java:137)
02-27 18:11:33.945: E/WindowManager(21994):     at android.app.ActivityThread.main(ActivityThread.java:4898)
02-27 18:11:33.945: E/WindowManager(21994):     at java.lang.reflect.Method.invokeNative(Native Method)
02-27 18:11:33.945: E/WindowManager(21994):     at java.lang.reflect.Method.invoke(Method.java:511)
02-27 18:11:33.945: E/WindowManager(21994):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
02-27 18:11:33.945: E/WindowManager(21994):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
02-27 18:11:33.945: E/WindowManager(21994):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T15:58:35.367

那么不同的模式呢，例如：

1.  活动 A 启动相机活动

2.  CameraActivity 将控制权返回给 Activity A

3.  活动 A 立即启动活动 B

4.  活动 B 没有布局/相同的布局

5.  活动 B 处理 AsyncTask 和 ProgressDialog。

如果问题与相机活动之前和之后活动的活动有关，这可能会通过创建一个全新的活动（干净的石板）来处理上传来解决问题。你怎么看？

# ruby-on-rails - 将array.each添加到变量中没有为Rails中的nil（！？）方法提供“+”的方法

> ID：15119393
> 
> 赞同：0
> 
> 时间：2013-02-27T18:21:33.590
> 
> 标签：ruby-on-rails, arrays, methods, each, null

我正在研究我的研究项目，我在将一些数据从数组中提取到变量时遇到了问题。

```
 m_id = params[:m_id]    #from the search form

    headers  = {:accept => "application/json"}
    response = RestClient.get "http://api.themoviedb.org/3/movie/#{m_id}?api_key=8f8bdc43aaf51d09127c3eb023007a53", headers     
    parsed_json = JSON.parse(response)

    movie_act = Movie.new
    parsed_json["production_countries"].each { |e| movie_act.country += e["name"] } 
```

而对于代码

```
 movie_act.country = parsed_json["production_countries"][0]["name"].to_s 
```

没关系（尽管它只提供一个国家，第一个 - 我需要所有国家）。

我得到的错误是：

```
 NoMethodError in MoviesController#create

 undefined method `+' for nil:NilClass
 Rails.root: C:/Users/Asus/Moje dokumenty/GitHub/interfejs

 Application Trace | Framework Trace | Full Trace
 app/controllers/movies_controller.rb:94:in `block in create'
 app/controllers/movies_controller.rb:93:in `each'
 app/controllers/movies_controller.rb:93:in `create' 
```

有什么问题？请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:28:22.853

问题是您正在调用`+=`，`movie_act.country`但`movie_act.country`正在返回`nil`。

应该是什么类型的对象`movie_act.country`？一个`Array`？一个`String`？在任何一种情况下，您都可以通过在`.each`循环之前使用空值对其进行初始化来避免此错误，例如（假设您期望它是一个`Array`），

```
movie_act = Movie.new(:country => [])
parsed_json["production_countries"].each { |e| movie_act.country += e["name"] } 
```

# java - 选择器语法

> ID：15119404
> 
> 赞同：0
> 
> 时间：2013-02-27T18:22:04.370
> 
> 标签：java, html, jsoup

我正在尝试选择包含单词 Contact 的表的行。

```
<table>
<tr><td>bla bla</td></tr>
<tr><td>Contact: Mike.....</td></tr>
</table> 
```

当我使用`e.children().select(":contains(Contact:)").text()` 我得到

`Contact: Mike..... Contact: Mike..... Contact: Mike....` 我想要的 3 个实例

如果我尝试`e.children().select(":containsOwn(Contact:)").text()` 我得到

```
Contact: 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:53:17.557

尝试这个：

```
Document doc = ...
Elements rows = doc.select("td:containsOwn(contact:)");

for( Element element : rows )
{
    System.out.println(element.text());
} 
```

**输出：**

```
Contact: Mike..... 
```

如果你想要`tr`-tag 代替：`doc.select("tr:contains(contact:)");`

# sql - MS Access 表单 (VBA) 查询和常规查询给出不同的结果

> ID：15119410
> 
> 赞同：0
> 
> 时间：2013-02-27T18:22:17.970
> 
> 标签：sql, ms-access

我通过 VBA 代码在 MS Access 中有基本相同的查询，只是一个保存的查询。它基本上是相同的查询，但是 VBA 代码缺少两条符合条件的记录 & 应该包括在内。保存的查询返回相同的数据集和 VBA 未返回的两个“缺失”记录。

保存的查询 SQL：

```
SELECT ID.Company, CU.GroupCode, CU.CustID, CU.Name, ST.ShipToNum, ST.Name, IH.InvoiceDate, IH.InvoiceNum, ID.ProdCode, ID.PartNum
FROM ((((PUB_InvcDtl AS ID INNER JOIN PUB_InvcHead AS IH ON (ID.CustNum = IH.CustNum) AND (ID.InvoiceNum = IH.InvoiceNum) AND (ID.Company = IH.Company)) LEFT JOIN PUB_Part AS PT ON (ID.Company = PT.Company) AND (ID.PartNum = PT.PartNum)) LEFT JOIN PUB_ShipTo AS ST ON (ID.CustNum = ST.CustNum) AND (ID.ShipToNum = ST.ShipToNum) AND (ID.Company = ST.Company)) LEFT JOIN V_Customer AS CU ON (ID.Company = CU.Company) AND (ID.CustNum = CU.CustNum)) LEFT JOIN ProdCodeCommRate AS PCC ON ID.ProdCode = PCC.ProdCode
WHERE (((ID.Company)="BTN") AND ((IH.InvoiceDate) Between #1/1/2013# And #1/31/2013#) AND ((ID.ProdCode) In ('2100','2110','2200','2210','2300','2400','2405','2500','2600','2701','2702','2709','2710','2800','2901','2902','2903')) AND ((ID.PartNum)<>'')); 
```

VBA 查询：

```
"SELECT ID.Company, CU.GroupCode, CU.CustID, CU.Name AS CustName, ST.ShipToNum, ST.Name AS ShipToName, IH.InvoiceDate, IH.InvoiceNum, ID.InvoiceLine, ID.PartNum, " & _
        "ID.ProdCode, PCC.CommRate, ID.PricePerCode, PT.PartDescription, ID.IUM, PT.CostMethod, ID.UnitPrice, ID.OurShipQty, ID.ExtPrice, ID.Discount, [ExtPrice]-[Discount] AS NetPrice, " & _
        "ID.LbrUnitCost, ID.BurUnitCost, ID.MtlUnitCost, ID.SubUnitCost, [LbrUnitCost]+[BurUnitCost]+[MtlUnitCost]+[SubUnitCost] AS TotUnitCost, " & _
        "([LbrUnitCost]+[BurUnitCost]+[MtlUnitCost]+[SubUnitCost])*[OurShipQty] AS ExtTotCost, IH.OpenInvoice, getSalesRep([IH].[SalesRepList],1,ID.Company) AS SalesRep1, ID.RepRate1, " & _
        "ID.RepSplit1, getSalesRep([IH].[SalesRepList],2,ID.Company) AS SalesRep2, ID.RepRate2, ID.RepSplit2, getSalesRep([IH].[SalesRepList],3,ID.Company) AS SalesRep3, " & _
        "ID.RepRate3, ID.RepSplit3 " & _
        "FROM (((((PUB_InvcDtl AS ID " & _
        "INNER JOIN PUB_InvcHead AS IH ON (ID.CustNum = IH.CustNum) AND (ID.InvoiceNum = IH.InvoiceNum) AND (ID.Company = IH.Company)) " & _
        "LEFT JOIN PUB_Part AS PT ON (ID.Company = PT.Company) AND (ID.PartNum = PT.PartNum))" & _
        "LEFT JOIN PUB_ShipTo AS ST ON (ID.CustNum = ST.CustNum) AND (ID.ShipToNum = ST.ShipToNum) AND (ID.Company = ST.Company))" & _
        "LEFT JOIN V_Customer AS CU ON (ID.Company = CU.Company) AND (ID.CustNum = CU.CustNum))" & _
        "LEFT JOIN ProdCodeCommRate AS PCC ON ID.ProdCode = PCC.ProdCode)" & _
        "WHERE ((ID.Company)=[Forms]![frmSalesMgnAnalysis]![cboComp]) AND ((ID.PartNum)<>'') AND " & _
        "((IH.InvoiceDate) Between [Forms]![frmSalesMgnAnalysis]![dtStart] And [Forms]![frmSalesMgnAnalysis]![dtEnd]) AND " & _
        "((ID.ProdCode) IN ('2100','2110','2200','2210','2300','2400','2405','2500','2600','2701','2702','2709','2710','2800','2901','2902','2903'))" & _
        "ORDER BY ID.ProdCode, IH.InvoiceDate, CU.Name;" 
```

该表单使用公司、开始和结束日期以及产品代码的输入字段。ProdCode 位于包含 ProdCode、Desc 和 Company 的表单的列表框中（位于 VBA 端的表中）。此 VBA 代码返回我需要的所有记录，除了 2 个丢失的记录。无论我加入上面的 ProdCode VBA 表，使用 WHERE ID.ProdCode IN (Select distinct...) 等在 WHERE 中明确选择它，都不起作用。

想法？提前致谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:14:41.423

您的`WHERE`子句不相同（因为括号在两个查询之间的位置不同）。我怀疑您可能`ID.PartNum<>''`对条款的部分有问题。

您可以尝试在 VBA 代码中设置断点并获取 VBA 查询的实际解释输出（包括参数值）。将该 SQL 语句复制到新的查询窗口（SQL 视图）中，然后查看设计器以了解 Access 如何解释该语句。

您还可以尝试匹配 VBA 查询中的 where 子句以匹配相同的参数顺序和括号数量，但在使用 VBA 查询之前，首先使用设计器来证明\反驳我的假设可能更容易。

通常遇到此类问题，需要反复试验才能将语句拿走并逐渐将它们添加回来以找出问题发生的确切位置，但括号的用法是我开始调查的地方。

# c - 在linux中设置串口中断

> ID：15119412
> 
> 赞同：8
> 
> 时间：2013-02-27T18:22:29.057
> 
> 标签：c, ubuntu, serial-port, interrupt, interruption

我正在尝试在 ubuntu 中设置串行端口的中断（在用 C 编写的程序中），但它不起作用。我已经检查了串行通信是否正常工作而没有中断，所以我可能设置错误。代码如下：

```
 #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>
    #include <unistd.h>
    #include <sys/types.h>
    #include <sys/socket.h>
    #include <netinet/in.h>
    #include <fcntl.h>
    #include <sys/signal.h>
    #include <errno.h>
    #include <termios.h>

    void signal_handler_IO (int status);   /* definition of signal handler */

    int n;
    int fd;
    int connected;
    struct termios termAttr;
    struct sigaction saio;

    int main(int argc, char *argv[])
    {
         fd = open("/dev/ttyUSB0", O_RDWR | O_NOCTTY | O_NDELAY);
         if (fd == -1)
         {
            perror("open_port: Unable to open /dev/ttyO1\n");
            exit(1);
         }

         saio.sa_handler = signal_handler_IO;
         saio.sa_flags = 0;
         saio.sa_restorer = NULL; 
         sigaction(SIGIO,&saio,NULL);

         fcntl(fd, F_SETFL, FNDELAY);
         fcntl(fd, F_SETOWN, getpid());

         tcgetattr(fd,&termAttr);
         baudRate = B115200; 
         cfsetispeed(&termAttr,B115200);
         cfsetospeed(&termAttr,B115200);
         termAttr.c_cflag &= ~PARENB;
         termAttr.c_cflag &= ~CSTOPB;
         termAttr.c_cflag &= ~CSIZE;
         termAttr.c_cflag |= CS8;
         termAttr.c_cflag |= (CLOCAL | CREAD);
         termAttr.c_lflag &= ~(ICANON | ECHO | ECHOE | ISIG);
         termAttr.c_iflag &= ~(IXON | IXOFF | IXANY);
         termAttr.c_oflag &= ~OPOST;
         tcsetattr(fd,TCSANOW,&termAttr);
         printf("UART1 configured....\n");

         connected = 1;
         while(connected == 1){
               // some code
         }

         close(fd);
         exit(0);             
    }

    void signal_handler_IO (int status)
    {
         printf("received data from UART.\n");
    } 
```

因此，任何时候另一个设备通过配置的端口发送消息，消息“从 UART 接收数据”。从不显示。

有什么建议可以解决这个问题吗？另外，系统如何将中断与串行端口联系起来？我已经阅读了有关 signal.h 的信息，但我还没有找到答案。我从这个页面得到了中断的想法：http: [//www.faqs.org/docs/Linux-HOWTO/Serial-Programming-HOWTO.html](http://www.faqs.org/docs/Linux-HOWTO/Serial-Programming-HOWTO.html)

提前感谢您的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-16T22:54:01.703

我发现原始代码缺少一段代码才能按预期工作。下面的代码在使用 gcc 编译的 Linux 上运行。添加的代码行是标有的那一行代码`/**<<<<<<------This line made it work.**/`
也被注释掉了：`//baudRate = B115200;`。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <fcntl.h>
#include <sys/signal.h>
#include <errno.h>
#include <termios.h>

void signal_handler_IO (int status);   /* definition of signal handler */

int n;
int fd;
int connected;
struct termios termAttr;
struct sigaction saio;

int main(int argc, char *argv[])
{
     fd = open("/dev/ttyUSB0", O_RDWR | O_NOCTTY | O_NDELAY);
     if (fd == -1)
     {
        perror("open_port: Unable to open /dev/ttyO1\n");
        exit(1);
     }

     saio.sa_handler = signal_handler_IO;
     saio.sa_flags = 0;
     saio.sa_restorer = NULL; 
     sigaction(SIGIO,&saio,NULL);

     fcntl(fd, F_SETFL, FNDELAY);
     fcntl(fd, F_SETOWN, getpid());
     fcntl(fd, F_SETFL,  O_ASYNC ); /**<<<<<<------This line made it work.**/

     tcgetattr(fd,&termAttr);
     //baudRate = B115200;          /* Not needed */
     cfsetispeed(&termAttr,B115200);
     cfsetospeed(&termAttr,B115200);
     termAttr.c_cflag &= ~PARENB;
     termAttr.c_cflag &= ~CSTOPB;
     termAttr.c_cflag &= ~CSIZE;
     termAttr.c_cflag |= CS8;
     termAttr.c_cflag |= (CLOCAL | CREAD);
     termAttr.c_lflag &= ~(ICANON | ECHO | ECHOE | ISIG);
     termAttr.c_iflag &= ~(IXON | IXOFF | IXANY);
     termAttr.c_oflag &= ~OPOST;
     tcsetattr(fd,TCSANOW,&termAttr);
     printf("UART1 configured....\n");

     connected = 1;
     while(connected == 1){
           // some code
     }

     close(fd);
     exit(0);             
}

void signal_handler_IO (int status)
{
     printf("received data from UART.\n");
} 
```

该程序的输出是：

```
./a.out 
UART1 configured....
received data from UART.
received data from UART.
received data from UART.
^C 
```

我希望这也对你有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-16T23:26:16.560

`FASYNC`问题是您通过清除标志来禁用来自文件描述符的信号`F_SETFL`。如果要获取信号，则需要设置：

```
fcntl(fd, F_SETFL, FNDELAY|FASYNC); 
```

此外，您可能希望对这些标志 (`O_NDELAY`和`O_ASYNC`) 使用 POSIX 名称，而不是 BSD 名称以提高可移植性，尽管两者都适用于 Linux。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T19:00:10.460

> 有什么建议可以解决这个问题吗？另外，系统如何将中断与串口联系起来？

串口中断写在linux内核中串口驱动的设备部分。中断由驱动程序自己处理，因此您无法控制它。

上述程序所做的是，当触发串行部分设备的接收中断时，通过信号通知您。

上述信号处理与中断无关，更多的是偶数处理。首先，你注册你的程序，以便在发生 io 中断时获取信号，然后程序中的信号处理程序将显示 printf 消息。

我认为您程序中的信号处理未正确实现只需更正程序的信号部分即可

```
sigset_t mskvar_1                   //Variable of signal bitfieldtype
struct sigaction sigio_action       //Structure which describes signal handler
void sio_handler(void);             //Signal handler function

int main()
{
  sigfillset(&mskvar_1);                    //set all mask bits of maskbit variable
  sigprocmask(SIG_SETMASK,&mskvar_1,NULL);  //write the mask info present in mskvar_1 to the pd
  sigdelset(&mskvar_1,SIGIO);               //Unmask SIGIO , to register for IO Interrupt Events

  sigio_action.sa_handler = sio_handler;    //Configure Signal Handler
  sigio_action.sa_flags  = 0;
  sigfillset(&sigio_action.sa_mask);
  sigaction(SIGIO,&sigio_action,NULL);      //Install Signal handler

  // Serial port initializtion here
  // Set Serial port parameters , Baud Rate and flags

while(1);
return 0;
}

void sio_handler()
{
  printf("\nSIGIO RECEIVED , I/O interrupt signalled?\n");
  return;
} 
```

# c++ - 永久更改指针类型

> ID：15119417
> 
> 赞同：1
> 
> 时间：2013-02-27T18:22:44.020
> 
> 标签：c++, pointers

我需要知道是否真的有一种方法可以轻松做到这一点。这只是我想做的一个例子......

```
void* ptr;
ptr = new Foo;
((Foo*)ptr)->member1 = some_val;
((Foo*)ptr)->member2 = some_val;
((Foo*)ptr)->member3 = some_val;
((Foo*)ptr)->member4 = some_val;
((Foo*)ptr)->member5 = some_val;
((Foo*)ptr)->member6 = some_val; 
```

因为ptr是一个void*，反正有没有可以临时改一下ptr的类型，这样就不用每次都强制转换来使用了？

我不能只创建另一个 Foo 类型的指针，因为 ptr 在其他地方使用并且需要是 void 类型。所以我想，暂时将其设为 Foo 类型以避免我必须做的所有混乱的铸造。

** 似乎有些人感到困惑...... ptr 必须保持 void 类型，因为在程序中它是这样使用的：-

```
void* ptr;
switch (bar)
{
    case 1:
       ptr = new Foo;
       ((Foo*)ptr)->member1 = some_val;
       ((Foo*)ptr)->member2 = some_val;
       ((Foo*)ptr)->member3 = some_val;
       ((Foo*)ptr)->member4 = some_val;
       ((Foo*)ptr)->member5 = some_val;
       ((Foo*)ptr)->member6 = some_val;
    case 2:
       ptr = new Doo;
       ...
    case 3:
       ptr = new Scooby;
       ... 
```

因此，ptr 必须保持为 void 类型。我只是想知道是否有一种临时方法可以将 ptr 转换为另一种类型，因此请避免转换...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:46:48.673

我不明白为什么你不能创建一个时间指针：

```
void* ptr;
ptr = new Foo;
{
Foo *pt=(Foo*)ptr;
 pt->member1 = some_val;
 pt->member2 = some_val;
 pt->member3 = some_val;
 pt->member4 = some_val;
 pt->member5 = some_val;
 pt->member6 = some_val;
} 
void *t=ptr; // the original ptr 
```

有时我使用：

```
Foo &f= *((Foo*)ptr);
 f.member1 = some_val;
 f.member2 = some_val;
 f.member3 = some_val;
 f.member4 = some_val;
 f.member5 = some_val;
 f.member6 = some_val; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:25:12.087

**编辑：**此答案已过时，因为原始问题已被修改。

您可以使用：

```
Foo* ptr;

ptr = new Foo;
ptr->member1 = some_val;
ptr->member2 = some_val;
ptr->member3 = some_val; 
```

或者

```
void* ptrFromElseWhere;
Foo* ptr = static_cast<Foo*>(ptrFromElseWhere);

ptr->member1 = some_val;
ptr->member2 = some_val;
ptr->member3 = some_val; 
```

# java - 我想使用 while 循环打印 X 或 * 的一部分。它应该看起来像

> ID：15119423
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:22:52.943
> 
> 标签：java, output

```
 *
  *****
*********
*********
*********
********* 
```

这是我的代码，但它不起作用

```
final int WIDTH = 6;
final int HEIGHT = 9;
int i = 0;
int j = 0;

while (i < HEIGHT * 2 && j < WIDTH) {

  if ((i + (i % 2) + (WIDTH) / 2) < j // right slope
        || (i + (i % 2) + j) < (WIDTH) / 2)// left slope
  {
    System.out.print(" ");
  } 
  else {// solid then
    System.out.print("*");

  }
}

System.out.println();
i+=2;
j++; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:32:45.033

您的增量器 i 和 j 当前位于您的 while 循环右括号 (}) 之外。由于它们永远不会增加，因此 while 条件永远不会命中。导致无限循环的常见错误。

此外，如果条件的 + (i % 2) 部分毫无意义，因为您每次都将 i 增加 2，因为任何偶数 % 2 都是 0。

我的建议是手动跟踪代码，也许从较小的值开始，但这将帮助您了解出了什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:36:28.760

As I mentioned in my comment, you must increment the values in your `while()` loop if you don't wish it to be infinite. So, perhaps add them in at the bottom!

```
while (i < HEIGHT) {

  if (i == 0) {
    System.out.print("    *");
  } else if (i == 1) {
    System.out.print("  *****");
  } else {// solid then
    System.out.print("**********");
  } System.out.println("");
  i++;
} 
```

Edit: I also changed your check conditions to make them simpler. If you only have to print this one shape it should be fine, but if you will be making a variety of sizes you will need to improve your algorithm!

# ruby-on-rails-3 - CanCan，定义具有深度嵌套资源的能力

> ID：15119424
> 
> 赞同：1
> 
> 时间：2013-02-27T18:22:56.377
> 
> 标签：ruby-on-rails-3, cancan

当资源深度嵌套时，我无法定义能力。我有这些课程：教师、师、学生、缺席和用户（教师和学生属于设计用户模型）：

```
#Teacher
has_many :divisions

#Division
belongs_to :teacher

#Student
belongs_to :division
has_many :absences

#Absence
belongs_to :student 
```

当我想确保老师只能管理属于他的部门的学生时没有问题：

```
#This works
if user.teacher?
  can :manage, Student, division: { teacher_id: user.teacher.id }
end 
```

当我想确保教师可以管理其部门中属于学生的缺勤时会出现问题：

```
#This doesn't work and returns PG::Error: ERROR: column students.divisions does not exist
can :manage, Absence, student: { division: { teacher_id: user.teacher.id } } 
```

对定义这种嵌套资源的能力有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T16:33:52.087

这应该有效：

```
if user.teacher?
  can :manage, Absence do |absence|
    absence.student.division.teacher_id == user.teacher.id
  end
end 
```

cancan wiki：[用块定义能力](https://github.com/ryanb/cancan/wiki/Defining-Abilities-with-Blocks "用积木定义能力")

# java - java - 调试时，如果我有一些作家，我怎样才能得到它正在写入的文件名+路径？

> ID：15119425
> 
> 赞同：3
> 
> 时间：2013-02-27T18:23:02.717
> 
> 标签：java, io, writer

在调试时，我想，遇到一个作家，能够知道它在哪里写。

对对象的粗略检查在文件名/文件路径前面几乎没有什么用处。

有什么方法——我可以在所述 Writer 上调用的方法，或者我可以检查的某个字段——可以让我知道 Writer 写入哪个文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:57:32.460

在 Linux 上，如果您可以深入了解文件描述符编号，则可以检查 /proc/ *pid* /fd/ *fdnum*以查看它引用的文件或套接字。

在 Windows 上，如果您可以深入挖掘文件句柄，则可以使用[Sys Internals Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)之类的工具将句柄跟踪到物理文件。

在 Darwin/BSD 系统上，您将使用 opensnoop。

# java - 读取大文件时执行操作java

> ID：15119428
> 
> 赞同：1
> 
> 时间：2013-02-27T18:23:06.203
> 
> 标签：java, file, sockets, video-streaming, bufferedinputstream

我正在用 Java 制作一个聊天程序，我正在通过 TCP 和可序列化对象进行通信。聊天也可以交换文件，但是当文件太大（视频文件）时，界面会冻结，直到它完成文件加载和对象传输过程。我需要在加载文件时显示一条消息。这是我的代码：

```
File file = jFileChooser1.getSelectedFile();
String name= fichero.getName();
int size = (int)fichero.length();
byte[] byteArray = new byte[size];
try {
    BufferedInputStream bis = new BufferedInputStream(new FileInputStream(file));
    bis.read(byteArray);               
} catch (IOException ex) {
    Logger.getLogger(Explorador.class.getName()).log(Level.SEVERE, null, ex);
} 
```

我需要在此行“bis.read(byteArray);”时显示一条消息 正在阅读，因为我相信该行是界面冻结的原因。加载 byteArray 后，我将它放在一个对象上并通过套接字连接发送它。

我还需要一个视频流，而不是直播，只是为了在服务器上打开一个视频文件并将其分段发送到连接的客户端并播放。谁能给我教程或提示？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:28:44.037

UI 冻结表明您正在阻止 Swing 的事件调度线程。您希望改为在其他线程中显式执行所有耗时的任务。一种更简单的方法是使用 SwingWorker。

[http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:29:21.610

您可以将代码放在线程中并编写一个等待它完成的方法。

```
new Thread(new Runnable() {

        @Override
        public void run() {
             //Code here
        }
    }).start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:38:28.873

您可以在线程中执行任务：

```
new Thread(new Runnable() {

        @Override
        public void run() {
             //Code here
        }
    }).start(); 
```

并使用 runlater() 更新您的视图。

# python - Python Bluehost 写入文件

> ID：15119429
> 
> 赞同：0
> 
> 时间：2013-02-27T18:23:08.730
> 
> 标签：python, file, bluehost

我正在构建一个在 Bluehost 服务器上运行的软件，并且在服务器上它可以很好地写入和读取文件，但是在服务器上它只是构建空文件并且也不会读取，这是我的代码如何工作的示例：

```
File = open(os.getcwd() + '/file.dat', 'wb')
File.write('data')
File.close() 
```

它在服务器上工作正常，但在服务器上却不行。它创建文件但不会向其中写入数据。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T09:56:36.267

你在检查正确的文件吗？

试试这个，看看打印结果是否符合您的预期。

```
file_path = os.path.join(os.path.dirname(os.getcwd()), '/file.dat')
print file_path 
```

# arrays - 在MATLAB中查找一行数组的最大索引

> ID：15119431
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:23:14.377
> 
> 标签：arrays, matlab, indexing

我想获取二维数组中特定行的索引。我有一个 15*15 数组（Q），我想获取第二行的最大数量的索引。我写了这段代码，但是发生了错误：

```
y=Q(2,:);
x=max(y)
??? Subscript indices must either be real positive integers or logicals. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:32:37.743

您正在获得第二行的最大值，但您想要*最大值*的*索引。*以下是获取索引的方法：

```
[~, index] = max(y) 
```

# wpf - 如何在 XAML 中填充组合框

> ID：15119435
> 
> 赞同：10
> 
> 时间：2013-02-27T18:23:32.243
> 
> 标签：wpf, xaml, combobox

我正在尝试`ComboBox`用一对**String, Value**填充 a 。我在后面的代码中这样做了：

```
listCombos = new List<ComboBoxItem>();
item = new ComboBoxItem { Text = Cultures.Resources.Off, Value = "Off" };
listCombos.Add(item);
item = new ComboBoxItem { Text = Cultures.Resources.Low, Value = "Low" };
listCombos.Add(item);
item = new ComboBoxItem { Text = Cultures.Resources.Medium, Value = "Medium" };
listCombos.Add(item);
item = new ComboBoxItem { Text = Cultures.Resources.High, Value = "High" };
listCombos.Add(item);
combo.ItemsSource = listCombos; 
```

组合框项目：

```
public class ComboBoxItem
{
    public string Text { get; set; }
    public object Value { get; set; }

    public override string ToString()
    {
        return Text;
    }
} 
```

如您所见，我正在`Text`使用 my 插入值`ResourceDictionary`。但是如果我这样做，当我在运行时更改语言时，`ComboBox`内容不会。

所以我想尝试`ComboBox`在设计中填补我的空白（在 XAML 中）。

`ComboBox`所以我的问题是：我怎样才能用上面的一对**Text, Value**填充我的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-27T18:45:51.217

您将使用`Tag`, 而不是`Value`在 xaml 中。这将是这样的：

```
<ComboBox>
     <ComboBoxItem Tag="L" IsSelected="True">Low</ComboBoxItem>
     <ComboBoxItem Tag="H">High</ComboBoxItem>
     <ComboBoxItem Tag="M">Medium</ComboBoxItem>
</ComboBox> 
```

# emacs - 在emacs的缩写中添加“

> ID：15119441
> 
> 赞同：0
> 
> 时间：2013-02-27T18:23:50.600
> 
> 标签：emacs

如何`"`在缩写模式下添加一个。

`("stdce" "std::cout << " "<< std::endl;")`

没有添加“，但之后该行完成，我尝试过`/"` `\"`，但那行不通

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:50:09.797

没关系，它奏效了。

我用过`\"`，效果很好。可能是我之前尝试时没有上传它。

# c# - 在我可以读取数据之前重置套接字连接

> ID：15119445
> 
> 赞同：5
> 
> 时间：2013-02-27T18:23:58.623
> 
> 标签：c#, .net, sockets

我在使用 .net 套接字从客户端接收数据时遇到问题。客户端正在与 TCP 通信并在立即关闭连接之前发送一两个数据包。招待会是这样的：

```
Socket newConnection = listener.EndAccept(ar);
newConnection.BeginReceive(myBuffer,0, length, SocketFlags.None, Callback,null); 
```

并且执行不会更进一步。beginReceive 将立即抛出一个 SocketException，说明连接已重置。我无法获取收到的数据。

这是我在 wireshark 上看到的这个连接：

```
SYN // SYN, AKC // AKC
PSH, ACK for 156 bytes
PSH, ACK for 176 bytes
RST, ACK 
```

就是这样。即使客户端关闭了连接，是否有任何方法可以获取此接收到的数据？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-22T20:31:09.093

首先，对于这种类型的通信，切换到 UDP 而不是 TCP 可能是个好主意——这样无论发送者的状态如何，您都可以获取数据包。
假设 TCP 是唯一的选择 - 我建议使用同步调用：

```
Socket newConnection = listener.AcceptSocket();
newConnection.Receive(myBuffer, 0, length, SocketFlags.None); 
```

# delphi - 如何制作一个主从数据库网站与使用 Delphi 制作一样快。

> ID：15119450
> 
> 赞同：2
> 
> 时间：2013-02-27T18:24:09.330
> 
> 标签：delphi, user-interface, web-applications

我希望每个人都能清楚这个问题。

我发现 Delphi 的优点在于，通过 RAD（快速应用程序开发），我们可以选择组件并将它们直接放入表单并将它们连接到其他组件和方法。

太好了，当我需要制作一个共享信息的应用程序时，我使用远程在线数据库服务器，但我不制作网站。我使用 zeos 库并制作了一个 Delphi 应用程序。

但随着我的客户开始要求使用平板电脑和智能手机，这变得很危险。

我讨厌 Web 的是界面和与控制器的连接的硬手动开发。

但我可能错了，因为可能存在很棒的工具和 Delphi 之类的 ide，可以像真正的 Delphi 一样快速工作。

*有人经历过吗？*

我尝试了 rad php xe，但我发现编码非常复杂，因为您必须在同一个文件中混合 php 和 javascript，并且没有良好的 mvc 结构。

Dreamweaver 漏洞百出，没有调试

PhpEd 有很好的代码控制但没有界面编辑器。

那么，如何制作一个主从数据库网站的速度和用Delphi制作一样快。我应该使用哪个可视化 IDE？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:23:46.570

开发网站时需要考虑许多大大小小的因素，这与制作桌面应用程序不同。很容易想象一个 RAD IDE 环境，它允许您将组件拖放到页面上，并为您完成将其转换为响应请求的网站的工作，但通常这会隐藏很多重要的属性对其运营和性能有重大影响的网站。

一个网站托管在一个网络服务器（或多个网络服务器）上，通常为多个用户提供并发请求，并将内容流式传输到在屏幕上呈现页面的网络浏览器。任何自尊的现代网站也将使用较小的 AJAX 请求将数据添加到现有页面，并使用客户端脚本进行验证和导航。不要忘记视觉障碍者、移动设备或其他想要连接到 API 的应用程序的替代视图。

事实是一个为您完成所有这些工作的平台可能存在，但在我看来，它会表现不佳，产生过大的页面并且会为您做出重要的决定，一旦应用程序变得更复杂，您就会遇到，或者需要在一定的负载下执行。

尖端的 Web 开发人员与代码（HTML、JavaScript、CSS ......）密切合作是有原因的，他们甚至更喜欢在相同的源文件中拥有代码片段和服务器端逻辑，例如 PHP、ASP、Cold Fusion,Ruby,Python... 我想将它与 Delphi 编译器的速度和强大功能结合起来，并启动了[http://xxm.sf.net/](http://xxm.sf.net/)，它使您能够创建小型和大型项目，保持密切联系构造请求响应的代码，并允许您选择托管网站的方式和位置。

我希望这部分回答了您的问题，尽管您没有询问使用 Delphi 制作主从网站的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T20:10:46.940

DevExpress 提供漂亮的网格和其他控件，以防您正在寻找。它**不是**针对 Delphi，而是针对 ASP.NET。

*   [DevExpress 上的 ASP.NET 控件、MVC 扩展](http://www.devexpress.com/Products/NET/Controls/ASP/book.xml#!page=1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:59:01.110

我建议 Delphi 使用 IntraWeb。我过去用过它，而且效果很好。

我建议查看[Delphi 中 IntraWeb 的替代线程？](https://stackoverflow.com/questions/5669559/alternatives-for-intraweb-in-delphi)作为讨论 IntraWeb 类产品的起点。

该线程中对 IntraWeb 的描述：

*Intraweb 是一个使用 Delphi/VCL 开发 Web 应用程序的框架。在 IDE 中，您使用 Delphi 语言和组件进行设计和编码。Intraweb 的引擎使用 JavaScript/Ajax 生成 HTML 页面，这些页面的外观和行为或多或少类似于 Delphi 表单和组件，但在浏览器上下文中。Intraweb 应用程序是使用某种 webServer 部署的，该 webServer 将这些页面提供给基于浏览器的客户端。– Mikey 2011 年 5 月 21 日 6:09*

当然，您必须将应用程序托管在 Windows 服务器上，因为 Intraweb 创建的代码只能在 Windows 上运行。

# python - 在python中调用一个函数，得到'（函数）没有定义'？

> ID：15119451
> 
> 赞同：4
> 
> 时间：2013-02-27T18:24:15.463
> 
> 标签：python, function

我最近开始学习 Python 并在这里有一些代码。

```
...
workout = input("Work out if you won?")

if workout == "y":
    ballone()
elif workout == "n":
    print("Okay.")
    sys.exit("Not working out if you won")
else:
    sys.exit("Could not understand")

##Ball one
def ballone():
... 
```

问题是调用'ballone'。您可以看到它已定义并在从命令行调用时完美运行 (ballone())

有任何想法吗？我已经搜遍了网络，但似乎找不到任何可以帮助我的东西。如果需要发布更多代码，请告诉我:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T18:25:31.537

将函数定义移到使用它的行*之前。*

```
def ballone():
    # ...

if workout == "y":
    ballone()
elif workout == "n":
    print("Okay.")
    sys.exit("Not working out if you won")
else:
    sys.exit("Could not understand") 
```

函数存储在标识符（变量）中，就像您的`workout`值一样。如果不先定义，Python怎么知道后面会定义呢？

# php - 基于动态下拉框在表单中填充文本字段。

> ID：15119455
> 
> 赞同：0
> 
> 时间：2013-02-27T18:24:32.793
> 
> 标签：php, javascript, html, mysql, phpmyadmin

我要提前感谢您抽出时间来帮助我，因为我真的被困住了。

我有两张桌子。员工（Employee_ID、First_name、Last_name、Address 等）和培训（Training_ID、Employee_ID、First_name、Last_name、Training_type）。

对于培训表，我有一个表格，用于为员工分配培训类型。

我想要在我的表单中有一个名为 selectemployee_ID 的下拉框，其中包含员工表中的employee_ID 的值，它是该表中的外键。

并且一旦选择了一个选项，我希望在表单中更新两个文本字段，名字和姓氏。

我在尝试实现可以​​执行此操作的代码时遇到很多问题，我不知道是否应该添加 java。我将在下面展示我的基本代码，向您展示它现在的样子。

html表单

```
<html>
<head>
<link type="text/css" rel="stylesheet" href="style.css"/>
<title>Training</title>
</head>

<body>
<div id="content">  
<h1 align="center">Add Training</h1>

<form action="inserttraining.php" method="post">
<div>
<p>Training ID: <input type="text" name="Training_ID"></p>
<p>Employee ID: <input type="text" name="Employee_ID"></p>
<p>First name: <input type="text" name="First_name"></p>
<p>Last name: <input type="text" name="Last_name"></p>
<p>
Training required?
<select name="Training">
<option value="">Select...</option>
<option value="Customer Service">Customer Service</option>
<option value="Bailer">Bailer</option>
<option value="Reception">Reception</option>
<option value="Fish & meat counters">Fish & meat counters</option>
<option value="Cheese counters">Cheese counters</option>
</select>
</p>
<input type="submit">
</form>
</div>

</body>
</html> 
```

以及将数据存储到数据库中的我的 php 代码。

```
<?php
$con = mysql_connect("localhost","root","");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("hrmwaitrose", $con);

$sql="INSERT INTO training (Training_ID, Employee_ID, First_name, Last_name, Training)
VALUES
('$_POST[Training_ID]','$_POST[Employee_ID]','$_POST[First_name]','$_POST[Last_name]','$_PO    ST[Training]')";

if (!mysql_query($sql,$con))
{
die('Error: ' . mysql_error());
}
echo "1 record added";

mysql_close($con);
?> 
```

正如我在前面所说的那样，这让我很生气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:31:37.053

首先，我认为您的数据库中有一些数据重复。当您在 Training 表中使用外键时，您不需要同时存储员工的名字和姓氏，因为该信息位于 Employee 表中。数据重复通常是一个坏主意，因为它可能会导致数据不一致。

要解决您的问题，您首先需要在 HTML 表单中使用 Employee_ID 编号填充下拉列表。为简单起见，我建议您将该页面更改为 PHP 页面，并添加以下代码来替换您的 Employee_ID 文本框。

```
<select id="Employee_ID">
<?php
    $result = mysql_query("SELECT Employee_ID FROM Employee");
    while ($row = mysql_fetch_row($result)) {
        echo "<option value=$row[0]>$row[0]</option>";
    }
?>
</select> 
```

然后您将需要实现一些 AJAX 以便用员工姓名填充文本框。您可以通过编写一些处理`onChange`下拉列表事件的 Javascript 来做到这一点。然后，此 Javascript 将需要向 PHP 页面发送请求以获取特定`First_Name`的.`Last_Name``Employee_ID`

# javascript - 无法使用 SVGweb 在 Internet Explorer 中将侦听器添加到 SVG

> ID：15119456
> 
> 赞同：4
> 
> 时间：2013-02-27T18:24:33.413
> 
> 标签：javascript, svg, dom-events

这段代码在 Firefox 中运行良好，但在 IE 中不行。我已经阅读了 SVGWeb 的文档（[http://svgweb.googlecode.com/svn/trunk/docs/UserManual.html](http://svgweb.googlecode.com/svn/trunk/docs/UserManual.html)），但我没有找到/理解解决方案，知道吗？

```
window.onsvgload = function() {
  carga();
var mySVG = document.getElementById("mySVGObject").contentDocument;
        mySVG.addEventListener('click', function(evt) {
                alert(evt.target.id);
    }, false);
} 
```

我在 IE 中使用这样的东西没有问题：

```
mySVG.getElementById('Color2').style.fill='#00cc00' 
```

使用该代码，我可以更改形状中的颜色和文本，但我无法让侦听器在 IE 中工作。

编辑：这适用于 Chrome、Firefox 和 IE9，我需要它在 IE7 上运行。这就是我加载 SVG 对象的方式：

```
 <div style="text-align:center" id="mapaSvg" >
<!--[if !IE]>-->
 <object data="ca.svg" type="image/svg+xml"
      width="700" height="800" id="mySVGObject" > <!--<![endif]-->
<!--[if lt IE 9]>
<object src="ca.svg" classid="image/svg+xml"
      width="700" height="800" id="mySVGObject" > <![endif]-->
<!--[if gte IE 9]>
<object data="ca.svg" type="image/svg+xml"
      width="700" height="800" id="mySVGObject" > <![endif]-->
</object>
</div>
<div style="text-align:center"> 
```

IE开发工具显示错误：

> “触发 onload 时出错：不支持”

在线上：

```
mySVG.addEventListener('click', function(evt) {
                alert(evt.target.id);
    }, false); 
```

在这里，您可以看到 SVGWEB 在 IE、Firefox、Chrome 中工作的示例，鼠标悬停在动态行上： [https ://www.destatis.de/bevoelkerungspyramide/](https://www.destatis.de/bevoelkerungspyramide/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T08:37:43.843

尝试`addEventListener`在此块内调用`onsvgload`：

```
window.addEventListener('SVGLoad', function() {
   // all SVG loaded and rendered
}, false) 
```

这些结构是相等的，但我做出这个假设是因为一个错误：“触发 onload 时出错：不支持”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:52:47.403

不知道它是否有帮助，但我在除 IE8 和 IE7 之外的所有浏览器中都遇到了同样的问题。该问题是由使用自闭合图像元素`<image/>`而不是`<image></image>`在 svg 中引起的。

# tomcat - Jenkins webapp 部署

> ID：15119460
> 
> 赞同：0
> 
> 时间：2013-02-27T18:25:00.573
> 
> 标签：tomcat, web-applications, deployment, jenkins

我有在 Jenkins 上编译的网络项目。它由几个战争和罐子组成。它正在 tomcat 上部署，罐子在 lib 目录中，而在 webapps 目录中的战争。问题是，如果我需要将 jars 放在 tomcat 上的 /libs 目录中，如何让 Jenkins 自动部署？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:34:32.843

你能在目标机器上创建一个 Jenkins 从站吗？如果是这样，您可以：

1.  使用 Deploy 插件，然后触发一个作业，该作业在从属设备上执行 shell 脚本以重新排列 JAR
2.  完全从从属服务器运行部署（从 Jenkins 主服务器提取 JAR 和 WAR，并使用 shell 脚本部署到本地 Tomcat）。

谢谢

# android - Android：Horizo ntalScrollBar 需要捕捉到下一个项目，即使是短滚动

> ID：15119461
> 
> 赞同：0
> 
> 时间：2013-02-27T18:25:02.337
> 
> 标签：android, android-layout

我有以下布局...

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:orientation="vertical">

<HorizontalScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:fillViewport="true">
    <LinearLayout
        android:id="@+id/mygallery"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:orientation="horizontal"
     >
        <ImageView 
            android:id="@+id/level1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:scaleType="center"
            android:src="@drawable/level1"
            android:layout_weight = "1"
            />
         </LinearLayout>
</HorizontalScrollView>

</LinearLayout> 
```

我遇到的问题是当我滚动时，如果它不够长，它就会卡在中间（在图像视图之间）。有没有办法让它一直滚动到下一个项目？我什至为此使用了正确的工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:15:05.563

我通过使用 ViewPager & Fragments 而不是 HSB 解决了这个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-27T18:35:21.897

try using wrap_content in the width of HorizontalScrollView. I hope this helps you. BestRegards

# aem - currentDesign.writeCssincludes 究竟包括什么？

> ID：15119469
> 
> 赞同：6
> 
> 时间：2013-02-27T18:25:30.647
> 
> 标签：aem

我试图弄清楚`currentDesign.writeCssIncludes(pagecontext);`在 headlibs.jsp 中找到的标准调用究竟包含了什么 css。该文档简单地说它是

```
Convenience method that writes the CSS include strings to the response. 
```

看看它*似乎*做了什么，它将包括`/etc/designs/currentdesign.css`哪些是基于设计组件 css 构建的，以及`/etc/designs/currentdesign/static.css`，这只是一个静态文件。但这就是全部吗？

特别是，我想做的是在我的设计中包含一个经过 clientLib 处理的 css 文件。一种方法是手动构建 css 包括：

```
<link rel="stylesheet" href="<%= currentDesign.getPath() %>/myclientlib.css" /> 
```

但我更愿意让它自动生成，这样我的设计师就可以灵活地为不同的设计构建不同的 css 文件（即，对于“基础”设计，它们只需要一个`static.css`文件就可以了，但对于“花式”设计他们希望使用 LESS css 并更细化地分解文件）。将特定于设计的 css 信息与它们影响的组件放在一起会很有帮助，而不是需要将它们分开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:29:44.837

您可以使用[`<cq:includeClientLib>`标签](http://dev.day.com/docs/en/cq/5-5/howto/taglib.html#%3Ccq%3aincludeClientLib%3E)，结合主题和/或类别来混合和匹配 CSS 位。

但是您可能会发现它有些限制；例如，您不能指定媒体属性。如果你需要这样做，或者你的设计师没有以适合主题/类别模型的方式构建他们的 CSS，那么你的后备是你在问题中确定的技术，`<link>`直接使用。

**更新**

关于主题的一个很好的问题！我只看到它们被顺便使用过。

您可以通过在 下添加新文件夹/节点来定义主题`/etc/designs/yourproject/clientlibs/themes`，作为`default`.

您可以使用标签为主题拉入客户端库`<cq:includeClientLibs>`，也许在某些条件逻辑的控制下。例如，在我的一个项目中，我有一个主题`authoring`，我只想将其应用于作者实例；我用这段代码把它拉进来`headlibs.jsp`：

```
<c:if test="${ (global['wcmmode']  eq 'EDIT') || (global['wcmmode'] eq 'PREVIEW') }">
    <cq:includeClientLib theme="apps.myproject.authoring" />
</c:if> 
```

我还没有看到任何文档可以将主题自动应用于内容树的特定子树，或者基于标签的存在。

有一个神秘的声明“主题名称是从请求中提取的”。[在 Adob​​e docs 中，由Sling docs](http://sling.apache.org/site/request-processing.html)中的此语句支持，“ThemeResolverFilter 为请求提供主题。主题作为请求属性提供。” 因此，也许添加`&theme=apps.yourproject.foo`查询字符串会应用该主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-28T11:11:38.670

The list of CSS files is based on the property 'cq:designPath' of the page.

# jquery - 无法在 Cygwin 上运行咖啡脚本

> ID：15119474
> 
> 赞同：2
> 
> 时间：2013-02-27T18:25:39.900
> 
> 标签：jquery, ruby-on-rails, coffeescript, cygwin

我正在尝试在 Rails 应用程序（在 Cygwin、Win7 下）上运行 coffescript 代码，并且我有以下错误日志：

```
ActionView::Template::Error (
module.js:340
    throw err;
          ^
Error: Cannot find module 'C:\tmp\execjs20130227-4044-6cws3p.js'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.runMain (module.js:492:10)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9)

  (in /cygdrive/c/Users/IBM_ADMIN/Programming/Rails/AdmApp/app/assets/javascripts/aplicacao.js.coffee)):
    3: <head>
    4:   <title>AdmApp</title>
    5:   <%= stylesheet_link_tag    "application", :media => "all" %>
    6:   <%= javascript_include_tag "application" %>
    7:   <%= csrf_meta_tag %>
    8: </head>
    9: <body>
  app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb__1024687483__1068178198'

  Rendered /usr/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1)
  Rendered /usr/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_onse.erb (1.0ms)
  Rendered /usr/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/template_errob within rescues/layout (81.0ms) 
```

我的咖啡脚本在 aplicacao.js.coffee 上：

```
jQuery ->
  $('#states').sortable(
    axis: 'y'
    update: ->
      alert('updated!')
  ); 
```

任何想法？Tks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:29:53.670

在这里看起来像是一组混合路径。我看到了 dos 风格`C:\tmp\execjs20130227-4044-6cws3p.js`和 cygwin (unix) 风格：`/cygdrive/c/Users/IBM_ADMIN/Programming/Rails/...`

看起来该应用程序正在 Cygwin 中运行，所以我将所有路径更改为 unix 样式并重试。

# html - 超级菜单 div 不会悬停在 Internet Explorer 上嵌入的 YouTube 上

> ID：15119476
> 
> 赞同：2
> 
> 时间：2013-02-27T18:25:41.253
> 
> 标签：html, css, internet-explorer, hover, embed

[如果您在此页面](http://the-artifice.com/the-garden-of-words-preview/)上使用 IE将鼠标悬停在***更多***菜单项上，您会注意到下拉 div 显示在 YouTube 嵌入后面。到目前为止，我已经在 IE8 和 IE9 上对此进行了测试。

为了解决这个问题，我尝试过：

*   玩弄`z-index`没有成功。
*   发现[了这个](https://stackoverflow.com/questions/3147216/insert-div-over-flash-in-ie)问题。我需要将以下属性设置为 flash embed code 的答案详细信息`<param name="wmode" value="transparent" />`。该站点由 Wordpress 提供支持，我可能需要更改核心文件来测试我正在避免的这一点。

如何让 div 在 IE 上正确悬停？它在 FF、Chrome 等上运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:28:10.790

```
?wmode=transparent&rel=0 
```

将此添加到应该可以工作的 iframe src

# tcl - WordNet 3.0 不会安装在 OS X Mountain Lion (10.8) 上

> ID：15119477
> 
> 赞同：2
> 
> 时间：2013-02-27T18:25:41.693
> 
> 标签：tcl, osx-mountain-lion, x11, tk, wordnet

尝试`make` [WordNet 3.0](http://wordnet.princeton.edu/wordnet/download/current-version/)时，它退出并出现错误 2。向上滚动，出现以下错误：

```
In file included from tkAppInit.c:16:
/usr/include/tk.h:78:23: error: X11/Xlib.h: No such file or directory 
```

我们如何在 OS X 10.8 上安装 WordNet？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:25:41.693

问题是由于 X11 不再与 OS X 10.8 捆绑在一起（可能更早？）。第一步是下载并安装[xQuartz](http://xquartz.macosforge.org)。完成此操作后，它将在以下位置放置 X11 标头：

```
/opt/X11/include/X11 
```

但我们需要它们：

```
/usr/include 
```

简单的解决方案是创建一个符号链接：

```
 sudo ln -s /opt/X11/include/X11 /usr/include 
```

（这取自[TCL X11 OS-X 上的 SO 帖子](https://stackoverflow.com/questions/11924217/error-cannot-build-tcl-tk-apps-on-mountain-lion-omnet)）

现在，如果您在 WordNet 3.0 发行版中运行 make/make 安装，它应该可以顺利安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-29T02:13:47.287

我遇到过同样的问题。[最好的解决方案是通过此处](http://macappstore.org/wordnet/)找到的 Brew 安装

1.  按 Command+F 并键入 Terminal，然后按 enter/return 键。
2.  在终端应用程序中运行：`ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" < /dev/null 2> /dev/null`然后按回车键。等待命令完成。
3.  `brew install wordnet`

# php - 如何使用 dom 获取正文标签内的纯文本..并将单词放入数组中？

> ID：15119478
> 
> 赞同：1
> 
> 时间：2013-02-27T18:25:42.653
> 
> 标签：php, html, dom

我想获取正文标记中的内容..将它们分隔为单词并将单词放入数组中..am 使用 php 这就是我所做的

```
$content=file_get_contents($_REQUEST['url']);
$content=html_entity_decode($content);
$content = preg_replace("/&#?Ã[a-z0-9]+;/i"," ",$content); 
$dom = new DOMDocument;
@$dom->loadHTML($content);
$tags=$dom->getElementsByTagName('body');
foreach($tags as $h)
{
echo "<li>".$h->tagName;
 getChilds2($h);    

function getChilds2($node)
{

  if($node->hasChildNodes())
   { 
   foreach($node->childNodes as $c)
    { 
        if($c->nodeType==3)
         {

           $nodeValue=$c->nodeValue;   
            $words=feature_node($c,$nodeValue,true);
           if($words!=false)
             {
              $_ENV["words"][]=$words;

             } 

             else if($c->tagName!="")
             {

             getChilds2($c);  
              }
        }
      }

   }
  else
  {
   return;
  }
}
function feature_node($node,$content,$display)
{

 if(strlen($content)<=0)
  {
   return;
   }

 $content=strtolower($content);
 $content=mb_convert_encoding($content, 'UTF-8',
      mb_detect_encoding($content, 'UTF-8, ISO-8859-1', true));
    $content= drop_script_tags($content);       
$temp=$content;
$content=strip_punctuation($content);
$content=strip_symbols($content);
$content=strip_numbers($content);
$words_after_noise_removal=mb_split( ' +',$content);
$words_after_stop_words_removal=remove_stop_words($words_after_noise_removal);
if(count($words_after_stop_words_removal)==0)
 return(false);
$i=0;
foreach($words_after_stop_words_removal as $w)
   {

      $words['word'][$i]=$w;
      $i++;
   }

for($i=0;$i<sizeof($words['word']);$i++)
 { 
   $words['stemmed'][$i]= PorterStemmer::Stem($words['word'][$i],true)."<br/>";
 }

 return($words);
} 
```

在这里，我使用了一些函数，如 strip_punctuation、strip_symbols、strip_numbers、remove stop_words 和 porterstemmer 来预处理页面..它们工作得很好..但我没有将内容放入数组中，而 print_r() 或 echo 什么也没提供..help plz ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:33:51.107

您不必遍历节点。

```
$tags = $dom->getElementsByTagName('body'); 
```

在 DOMNodeList 中只会给你一个结果。所以你需要做的就是获取文本

```
$plainText = $tags->item(0)->nodeValue; 
```

或者

```
$plainText = $tags->item(0)->textContent; 
```

要将单独的单词放入数组中，您可以使用

*   [`str_word_count`— 返回有关字符串中使用的单词的信息](http://www.php.net/manual/en/function.str-word-count.php)

就结果`$plainText`而言

# c - 将 Nibbles 推入 C 中的整数堆栈

> ID：15119481
> 
> 赞同：2
> 
> 时间：2013-02-27T18:25:49.380
> 
> 标签：c, bit-manipulation

我有一个无符号整数，我想将半字节推入其中。例如，如果我有带有 values 的半字节`1, 2, 3, 4, 5, 6, 7 & 8`，我希望能够将第一个半字节推入我的整数中以生成：

```
0x10000000 (268435456) 
```

第二次推送后，我将拥有：

```
0x12000000 (301989888) 
```

第三次推送后，我将拥有：

```
0x12300000 (305135616) 
```

等等。有没有人对我如何实现这一目标有一个巧妙而巧妙的想法？解决方案需要能够以任意数字作为起点，并推到第一个可用的零。因此，提供 int`301989888`作为起点并推动 3 将导致`305135616`. `MSB`从or推送`LSB`也很有用。

我很抱歉。听起来像是考试题。不是——我只是想尝试一个实验，但在我开始之前就被卡住了！

* * *

打勾的答案是完美的！我对它进行了如下轻微修改（只是为了让它自成一体），我很高兴！

```
#define left 0
#define right 1

void push(unsigned* number, int nibble,int direction){
  int i, shift;
  if (direction){
    for (i = 28; i >= 0; i -= 4){
  if (!(*number & (0xfU << i)))
    shift = i;
}
  }
  else{
for (i = 0; i <= 28; i += 4){
  if (!(*number & (0xfU << i)))
    shift = i;
}
  }
  *number|=nibble<<shift;
} 
```

调用如下：push(&x,nibble,left);

我为格式化道歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:32:24.297

您需要做两件事 - 检测下一个半字节的位置，然后将其放在那里。对于检测，您可以屏蔽和移位：

```
int nextLocation(uint32_t x)
{
   int i;
   for (i = 28; i >= 0; i -= 4)
   {
       if (!(x & (0xfU << i)))
           return i;
   }
   return -1;
} 
```

此函数将返回“推动”下一个半字节（或者`-1`如果您的整数已经满）所需的升档量。

然后，您需要输入新值（假设这`x`是您要推送`nibble`的值并且是您要推送的值）：

```
int shiftAmount = nextLocation(x);
x |= nibble << shiftAmount; 
```

要推动另一个方向，您可以`for`在函数中更改循环的方向`nextLocation`：

```
for (i = 0; i <= 28; i += 4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:34:56.717

这是一个非常简单的示例，可以满足您的要求。它“推动”，但不是以自动化的方式（如果这是您正在寻找的）。但这证明了这个概念（注意：我将每个半字节组合成一个字节）。

```
#include <iostream>

using namespace std;

int main()
{
    int x = (0x12 << 24) | (0x34 << 16) | (0x56 << 8) | (0x78);
    cout<< hex << x << endl;
    return 0;
} 
```

# github - 具有 2 个身份的 ssh 转发代理

> ID：15119490
> 
> 赞同：0
> 
> 时间：2013-02-27T18:26:26.180
> 
> 标签：github, ssh, ssh-keys

我正在尝试使用 ForwardingAgent 从他们的服务器将更改推送到客户端 github 帐户，但我的 id_rsa_corevm 身份没有被转发。

在我的 ~/.ssh/config 文件中，我有这个

```
Host corevm
        Hostname 192.168.56.101
        User user1
        IdentityFile ~/.ssh/id_rsa_corevm
        ForwardAgent yes

macbook-pro:.ssh macuser$ ssh-add -l
######## /Users/macuser/.ssh/id_rsa (RSA)
######## /Users/macuser/.ssh/id_rsa_corevm (RSA) 
```

当我 ssh 进入他们的服务器并测试与 github 的 ssh 连接时，我看到了我的 id_rsa_corevm 身份，但仍然无法连接到客户端的 github 帐户。

```
[user1@corevm ~]$ ssh -t -vv git@github.com

debug2: key: /Users/macuser/.ssh/id_rsa (#####)
debug2: key: /Users/macuser/.ssh/id_rsa_corevm (######) 
```

我只看到一个“提供公钥”，而不是我的 id_rsa_corevm。

```
debug1: Offering public key: /Users/macuser/.ssh/id_rsa

Hi githubuser! You've successfully authenticated, but GitHub does not provide shell access. 
```

成功消息意味着我的默认 id_rsa 文件正在被转发，我可以连接到我自己的 github 帐户。

然后我尝试将更改推送到客户端 github，但我的权限被拒绝。

```
[user1@corevm test]$ git push origin master
ERROR: Permission to clientgithubuser/test.git denied to githubuser.
fatal: The remote end hung up unexpectedly 
```

我宁愿将我的 id_rsa.pub 添加到我的客户 github 帐户中，但显然 github 不允许共享密钥。

有任何想法吗？

# jquery - jquery colorbox IE9 错误 - SCRIPT5007：无法获取属性“rel”的值

> ID：15119491
> 
> 赞同：0
> 
> 时间：2013-02-27T18:26:28.697
> 
> 标签：jquery, colorbox

Chrome 和 Firefox 运行良好。升级到最新的 colorbox 和 jquery 版本，在 IE9 中同样的问题。

IE9错误信息是：

SCRIPT5007：无法获取属性“rel”的值：对象为 null 或未定义 jquery.colorbox-min.js，第 4 行字符 1259

（此处来自 Colorbox 常见问题解答，希望这能传达给 Jack）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T20:56:32.870

凯文，谢谢你的建议。

结果我以为我已经将 Javascript 升级到 1.7.2 版并放入了最新的颜色框，但我没有。当我确实更新了内容时，消息“SCRIPT5007：无法获取属性'rel'的值：对象为空或未定义”消失了，剩下的就是IE9甚至拒绝打开颜色框。

我在 colorbox_settings.js 中有一些无关的 javascript，旨在删除 IE 链接样式。一旦我把它拿出来，IE9 中 Colorbox 的功能就恢复了。

# symfony - Symfony2 和 Twig 转储问题

> ID：15119494
> 
> 赞同：2
> 
> 时间：2013-02-27T18:26:44.943
> 
> 标签：symfony, error-handling, twig, dump

我在 Twig 中遇到了 dump() 的问题。

我无法完全转储要返回到树枝模板的对象的值。我的对象（如下定义）由产品对象、qty key/val、OnOrder key/val 和 avgUnitCost key/val 组成。

我能够使用 dump(qty)、dump(OnOrder)、dump(avgUnitCost) 并查看这些值。

我无法在产品上使用 dump() 来查看产品对象的键/值。我得到的只是死亡的白页。

我在堆栈的其他地方读到这是 php.ini 文件中的内存问题。这似乎无法解决问题，我设置了 1024M，但它仍然超时并给我白屏。

我还阅读了关于同一问题的这篇文章：http: [//hectorpinol.com/twig-debug-in-symfony-2/](http://hectorpinol.com/twig-debug-in-symfony-2/) ...他认为这是一个“双向关联问题”。

无论如何，这是我用来传递对象并呈现我的树枝模板的代码......

```
return $this->render('TestBundle:Event:view.html.twig', array(
            'heading' => 'View Product',
            'product' => $product,
            'qty' => $qty,
            'OnOrder' => $OnOrder,
            'avgUnitCost' => $avgUnitCost,
    )); 
```

**这是我的问题的核心：** 如何有效地使用 twig 访问对象的元素，无论是转储还是其他方法。我需要能够查看对象中的所有元素，以便可以根据需要将它们放置在页面上。

非常感谢你的帮助！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:19:06.157

检查[瓢虫捆绑](https://github.com/raulfraile/LadybugBundle)。你可以倾倒一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-13T04:36:40.777

尝试在 twig_var_dump 中添加断点：

`/vendor/twig/twig/lib/Twig/Extension/Debug.php`（在底部）

然后你可以使用你的调试器的功能......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-13T13:57:50.227

看看这个答案：[https ://stackoverflow.com/a/29302069/4102223](https://stackoverflow.com/a/29302069/4102223)

这是我解决这个问题的方法，只需在一个地方更改几行（这更容易，因为不需要包含新的捆绑包并阅读其文档）。

# linux - 创建 Cron 作业以在 QNAP NAS 上重新应用权限

> ID：15119498
> 
> 赞同：0
> 
> 时间：2013-02-27T18:27:04.700
> 
> 标签：linux, cron, qnap

我有一台运行 Google Drive 同步的 QNAP NAS，因此我的 QNAP、计算机和 Google Drive 都处于同步状态。

当我在工作计算机上创建文件并回到 QNAP 时，我在工作中创建的文件上收到拒绝访问错误。

如果我查看权限，我可以看到它们设置不正确。在 QNAP 网络管理器中，我只需右键单击包含我的文件的文件夹并将权限设置为“重新应用并应用于子文件夹/文件”。

如何通过每 5 分钟运行一次的 cron 作业来完成上述工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T21:21:47.717

我自己也有类似的问题，也为此做了一个 cron 工作。

首先在一个容易找到的地方制作一个脚本。我使用了“/share/MD0_DATA/”，因为所有的共享都在这里。

创建一个类似 perms.sh 的文件并添加以下内容：

```
#!/bin/bash
cd /share/MD0_DATA/(folder you want to apply this)
chmod -R 775 *
chown -R nobody:nogroup * 
```

例如，我使用了nobody:nogroup，你可以使用任何你想要的用户和组。

现在您需要将此脚本添加到 crontab。要查看 crontab 中的内容，请使用：

```
crontab -l 
```

编辑 crontab 使用：

```
crontab -e 
```

如果你不喜欢 vi 并且想直接访问文件，这个编辑器就像 vi 一样工作编辑：

```
/etc/config/crontab 
```

将此行添加到您的 crontab：

```
*/5 * * * * /share/MD0_DATA/perms.sh 
```

5 代表 5 分钟的间隔。然后你需要让 crontab 知道新的命令：

```
crontab /etc/config/crontab 
```

我希望这对你有所帮助。

# ios - UISegmentedControl 按钮停止工作

> ID：15119499
> 
> 赞同：0
> 
> 时间：2013-02-27T18:27:06.093
> 
> 标签：ios, uitoolbar, uisegmentedcontrol, uicontrol

我的 iOS 应用程序有一个包含十几个字段的表单，我想在键盘上方添加“上一个”/“下一个”按钮，以帮助用户在字段之间移动。我有这样的事情：

```
for (UITextField *t in _textfields) {
    t.delegate = self;

    UIToolbar *toolbar = [[UIToolbar alloc] init];
    [toolbar setBarStyle:UIBarStyleBlackTranslucent];

    UISegmentedControl *segControl = [[UISegmentedControl alloc] initWithItems:@[@"Previous", @"Next"]];
    [segControl addTarget:self action:@selector(switchTextField:) forControlEvents:UIControlEventValueChanged];
    segControl.segmentedControlStyle = UISegmentedControlStyleBar;
    segControl.tag = [_textfields indexOfObject:t];
    if (segControl.tag == 0) [segControl setEnabled:NO forSegmentAtIndex:0];
    else if (segControl.tag == [_textfields count] - 1) [segControl setEnabled:NO forSegmentAtIndex:1];

    [segControl sizeToFit];

    UIBarButtonItem *segItem = [[UIBarButtonItem alloc] initWithCustomView:segControl];

    UIBarButtonItem *flexButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];
    UIBarButtonItem *doneButton =[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self.view action:@selector(endEditing:)];
    [toolbar setItems:@[segItem, flexButton, doneButton]];
    [toolbar sizeToFit];
    [t setInputAccessoryView:toolbar];
} 
```

我遇到的问题是，每隔一段时间就有一个部分停止工作。该方法`switchTextField`只是没有被调用，按钮看起来很正常，没有被禁用，但是触摸没有注册。有时是“上一个”按钮，有时是“下一个”按钮，绝不会同时出现，有时它们都可以正常工作。一旦其中一个按钮卡住，（暂时）修复它的唯一方法是在不使用工具栏的情况下点击另一个文本字段或关闭键盘并重新开始编辑。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:00:54.940

`UIButton`当您真的想要上一个/下一个控件的行为时，分段控件不是一个好的选择。

我认为正在发生的事情是您正在使用分段控件初始化工具栏，并且没有选择分段。因此，当您第一次点击 prev/next 时，值会发生变化，并且会为该特定分段控件选择该分段。当您继续点击 prev/next 时，最终您会看到一个分段控件，该控件已经选择了一个分段，并且该分段在点击时不会触发值更改事件，因为它已经是选定的分段。

您可以在您的`switchTextField:`方法中显式取消选择选定的段（确保您不会`switchTextField:`递归触发），或者您可以更改您的实现以使用`UIButton`prev/next 对象而不是分段控件。

我建议与`UIButton`.

# wix - 有条件的启动条件

> ID：15119502
> 
> 赞同：2
> 
> 时间：2013-02-27T18:27:30.733
> 
> 标签：wix

在 Wix 中是否有可能具有仅基于其他条件执行的启动条件？理想情况下，我想将我的所有启动条件组合在一起，并对整个组而不是每个条件应用一个条件检查。

我已经尝试了很多事情，例如将我的启动条件放在片段中，并使用条件引用产品中的片段，但我尝试的任何事情似乎都没有让 Wix 高兴。

如果在命令行上设置了正确的属性，我的目标是绕过所有安装程序的启动条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:36:15.670

Windows 安装程序不支持“分组”条件。您需要将“绕过”属性添加到每个条件。就像是：

```
<Condition>Installed OR BYPASS_PROPERTY OR (Other_Conditions AND More_Conditions)</Condition> 
```

注意：在此处添加“已安装或”以确保始终可以卸载产品。

# ruby-on-rails - Mercury：SyntaxError：无法从构造函数返回值

> ID：15119504
> 
> 赞同：2
> 
> 时间：2013-02-27T18:27:32.360
> 
> 标签：ruby-on-rails

全新安装 rails 3.2.8 并在添加[Mercury](https://github.com/jejacks0n/mercury)后编译时出错：

```
SyntaxError: cannot return a value from a constructor: "this.element" in class Button
 (in /home/*********/**************/vendor/bundle/ruby/1.8/bundler/gems/mercury-0c048033cd79/app/assets/javascripts/mercury/toolbar.button.js.coffee) 
```

我已经使用 Rails 3.2.3 成功安装了 Mercury，但无法弄清楚为什么这不起作用。

有任何想法吗？

```
source 'https://rubygems.org'

gem 'rails', '3.2.8'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'mysql2'
gem 'bootstrap-sass'
gem 'simple_form'
gem 'json'
gem 'ckeditor'
gem 'mercury-rails', :git => 'https://github.com/jejacks0n/mercury.git'

gem 'jquery-rails'
# gem 'jquery-ui-rails'

gem "paperclip", "~> 2.7"

# To use ActiveModel has_secure_password
gem 'bcrypt-ruby', '~> 3.0.0'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
    gem 'therubyracer', '0.10.2', :platforms => :ruby
    gem 'libv8', '~> 3.3.10'
    gem 'execjs'
  gem 'uglifier', '>= 1.0.3'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:12:46.777

[https://github.com/jejacks0n/mercury/issues/349](https://github.com/jejacks0n/mercury/issues/349)

我想你需要锁定到 coffeescript 1.4.0

这解决了我的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T20:36:29.063

显然，有一个修复，它在[github repo](https://github.com/jejacks0n/mercury)中，但还没有在 ruby​​gems 上。如果您不想降级咖啡脚本，只需在 Gemfile 中指定存储库：

```
# Gemfile
# ...
gem 'mercury-rails', git: 'git://github.com/jejacks0n/mercury' 
```

然后运行`bundle update mercury-rails`。这为我解决了这个问题，而无需降级咖啡脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T20:54:31.567

Here's what you actually need to type into your gemfile:

```
gem 'coffee-script-source', '1.4.0' 
```

# java - 解析 mp4 元数据

> ID：15119507
> 
> 赞同：1
> 
> 时间：2013-02-27T18:27:38.697
> 
> 标签：java, streaming, video-streaming, mp4, codec

我面临一个问题。我有一个通过 mp4box 运行的 mp4 文件。我使用 interleaved 选项运行它来为文件生成元数据。我可以转储元数据的 XML 文件，其中包含如下数据

```
<CompositionOffsetEntry CompositionOffset="1127" SampleCount="1"/>
<SampleSizeEntry Size="2581"/>
<ChunkEntry offset="17065364"/>
<TimeToSampleEntry SampleDelta="1024" SampleCount="6"/>
<SampleToChunkEntry FirstChunk="2525" SamplesPerChunk="19" SampleDescriptionIndex="1"/>
<SampleSizeEntry Size="301"/> 
```

ETC...

我需要知道的是如何读取和理解这些数据以映射秒、关键帧和字节。例如，我希望能够告诉第二个 100 映射关键帧 500 映射到字节 30520（从 .mp4 文件的开头）。

# database - 我可以使用或条件何时进入触发器吗？

> ID：15119508
> 
> 赞同：0
> 
> 时间：2013-02-27T18:27:38.710
> 
> 标签：database, oracle, triggers

我正在尝试在 oracle 数据库上创建触发器，但我遇到了 when 条件的问题。当我尝试使用它时，我得到“无效的关系运算符”

```
 create or replace TRIGGER SQLTEST.TRIGGER_TESTE
AFTER INSERT OR UPDATE ON SQLDBA.VT_TABLE
FOR EACH ROW
WHEN (INSERTING OR NEW.FIELD_1 is null and OLD.FIELD_1 is not null or NEW.FIELD_1 <> OLD.FIELD_1) 

DECLARE
VAR_FIELD_1 VT_LOG_TABLE.FIELD_1%TYPE;

BEGIN

SELECT SQLDBA.SEQ_LOG_TABLE.NEXtval into VAR_FIELD_1
FROM dual;

INSERT INTO VT_LOG_TABLE
(FIELD_0,VAR_FIELD_1,FIELD_2,FIELD_3,FIELD_1, FIELD_4 )
VALUES( :NEW.FIELD_0,VAR_FIELD_1, :NEW.FIELD_2, :NEW.FIELD_3, :NEW.FIELD_1,SYSDATE);

END TRIGGER_TESTE; 
```

产生这种情况的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T21:17:40.823

正如 Graceemile 所说，该`WHEN`子句不理解`INSERTING`。我不确定您是否可以依靠`old.field_1 is null`来指示插入，因为它看起来像一个可为空的字段（因为`new.field_1`显然可以为空）。如果你不能，那么你可以将逻辑移到块中：

```
create or replace trigger vt_trigger
after insert or update on vt_table
for each row
declare
    do_logging boolean := false;
begin
    if inserting then
        do_logging := true;
    elsif (:new.field_1 is null and :old.field_1 is not null)
        or (:new.field_1 is not null and :old.field_1 is null)
        or (:new.field_1 <> :old.field_1)
    then
        do_logging := true;
    end if;

    if do_logging then
        insert into vt_log_table (field_0, var_field_1, field_2, field_3,
            field_1, field_4)
        values (:new.field_0, seq_log_table.nextval, :new.field_2, :new.field_3,
            :new.field_1, sysdate);
    end if;
end vt_trigger;
/ 
```

我已经将检查更改为：

```
 elsif (:new.field_1 is null and :old.field_1 is not null)
        or (:new.field_1 is not null and :old.field_1 is null)
        or (:new.field_1 <> :old.field_1) 
```

... 检测是否`field_1`已从 null 更改为 null 或从一个非 null 值更改为另一个；也许你不想要那个，部分检查对我来说有点奇怪。我假设您只想记录是否`field_1`发生了任何变化，或者您当然要插入新行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T19:31:13.980

我刚刚尝试了类似的方法，Oracle 不喜欢 WHEN 条件中的 INSERTING 值。使用 NEW 和 OLD 似乎没问题，即使插入也是如此。

从实验来看，如果您将其添加到您的 WHEN 条件中，您的触发器将在 INSERTS 上触发：

```
OR OLD.FIELD_1 IS NULL 
```

所以尝试这样的事情：

```
create or replace TRIGGER SQLTEST.TRIGGER_TESTE
AFTER INSERT OR UPDATE ON SQLDBA.VT_TABLE
FOR EACH ROW
WHEN (NEW.FIELD_1 is null and OLD.FIELD_1 is not null
   or NEW.FIELD_1 <> OLD.FIELD_1
   or OLD.FIELD_1 IS NULL)

DECLARE

... and so on 
```

如果这变得太复杂，您可以创建两个触发器：一个用于带有 WHEN 条件的 UPDATE，另一个用于不带条件的 INSERT。

您也可以尝试将触发器定义为 AFTER INSERT OR UPDATE OF Field_1 ON VT_TABLE：

```
create or replace trigger vt_trigger
after insert or update of field_1 on vt_table
for each row
begin
    insert into vt_log_table (field_0, var_field_1, field_2, field_3,
        field_1, field_4)
    values (:new.field_0, seq_log_table.nextval, :new.field_2, :new.field_3,
        :new.field_1, sysdate);
end vt_trigger;
/ 
```

# javascript - Backbone Collection 填充了模型，但无法从中提取 JSON ......简单的答案我确定

> ID：15119510
> 
> 赞同：0
> 
> 时间：2013-02-27T18:27:46.253
> 
> 标签：javascript, json, backbone.js

感谢这个社区给我的所有帮助，我非常感激。如果有人知道我做错了什么，我很想弄清楚:)

**问题：**
我刚开始使用主干。大声笑但实际上，我正在尝试构建和使用完整日历和主干来填充日历的应用程序。到目前为止一切都很顺利，我可以在日历中添加具有正确开始和结束日期的新会话。

但是在初始加载时，这些会话模型都不会填充到日历上。这是我进入的屏幕截图`console.log`： ![](../Images/2252e2cd416b5ca174c990f88ebc84a6.png)

正如你所看到的，当我称之为集合时，你可以看到它充满了模型。但是当我尝试转换为 JSON 时，它是空的。我在 Stack Overflow 上找到了很多关于这个的答案，但似乎没有一个能成功。我被正式路障了。哈哈

这是我用来显示收藏的一些代码

```
 var Event = Backbone.Model.extend({
    methodToURL: {
        'create': addDayURL,
        'update': addDayURL,
        //'delete': '/user/remove'
    },
    sync: function(method, model, options) {
        options = options || {};
        options.url = model.methodToURL[method.toLowerCase()];

        Backbone.sync(method, model, options);
    }
});

var Events = Backbone.Collection.extend({
    model: Event,
    url: allDaysURL
}); 
```

视野很大，所以我只包括相关部分：

```
 var EventsView = Backbone.View.extend({
    events: {
        'click #add_track' : "addTrack"
    },
    initialize: function(){
        _.bindAll(this); 

        this.collection.bind('reset', this.addAll);
        this.collection.bind('add', this.addOne);
        this.collection.bind('change', this.change);            
        this.collection.bind('destroy', this.destroy);

        this.eventView = new EventView(); 

        console.log('this.collection: ', this.collection);
        console.log('this.collection.toJSON(): ', this.collection.toJSON());
        console.log('JSON.stringify(this.collection.toJSON()): ', JSON.stringify(this.collection.toJSON()));
        //console.log(this.collection.toJSON())

        // your model2 option: this.options.collection2.toJSON();
        //console.log(this.options.collection2.toJSON());           
    },
    render: function() {
        this.$el.fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,basicWeek,basicDay',

            },
            //defaultView: 'resourceDay',
            resources: //this.options.collection2.toJSON()
            [
                {
                    /*
                     * trackID
                     * name
                     * backgroundColor
                     * foregroundColor*/

                    id: 1,
                    name: 'Track 1',
                    color: 'red',
                    textColor: 'black'
                },
                {
                    id: 2,
                    name: 'Track 2',
                    color: 'blue'
                },
                {
                    id: 3,
                    name: 'Track 3',
                    color: 'pink'
                },
                {
                    id: 4,
                    name: 'Track 4',
                    color: 'green'
                },
                {
                    id: 5,
                    name: 'Track 5',
                    color: 'yellow',
                    textColor: 'black'
                }
            ],
            droppable: true,
            selectable: true,
            selectHelper: true,
            editable: true,
            ignoreTimezone: false,                
            select: this.select,
            eventClick: this.eventClick,
            eventDrop: this.eventDropOrResize,        
            eventResize: this.eventDropOrResize,
            drop: function(date, allDay, ev, ui, res) { // this function is called when something is dropped

                // retrieve the dropped element's stored Event Object
                var originalEventObject = $(this).data('eventObject');

                // we need to copy it, so that multiple events don't have a reference to the same object
                var copiedEventObject = $.extend({}, originalEventObject);

                // assign it the date that was reported
                copiedEventObject.start = date;
                copiedEventObject.allDay = allDay;

                // dropped event of resource a to a cell belonging to resource b?
                copiedEventObject.resourceId = res.id;

                // render the event on the calendar
                // the last `true` argument determines if the event "sticks" (http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)
                $('#calendar').fullCalendar('renderEvent', copiedEventObject, true);

                // is the "remove after drop" checkbox checked?
                if ($('#drop-remove')) {
                    // if so, remove the element from the "Draggable Events" list
                    $(this).remove();
                }

                this.addOne;
            }
        });
        this.$el.prepend('<button id="add_track" class="btn large-btn green-btn pull-right">Add Track</button>');
    },
    addAll: function() {
        this.$el.fullCalendar('addEventSource', this.collection.toJSON());
    },
    addOne: function(event) {
        this.$el.fullCalendar('renderEvent', event.toJSON());
    } 
```

**编辑：** 要初始化集合并填充此代码位于文件的底部：

```
var events = new Events();
var tracks = new Tracks();
new EventsView({el: $("#calendar"), collection: events, collection2: tracks}).render();
new AddSessionView({ collection: events}).render();
events.fetch(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:42:16.577

我也是 Backbone 的新手，但也许这会有所帮助。您是否尝试过将`models`Collection 对象的属性转换为 JSON，例如：

```
JSON.stringify(collection.models) 
```

这种方法对我有用。

JSFiddle：http: [//jsfiddle.net/YcFmB/](http://jsfiddle.net/YcFmB/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:07:34.080

可能是在调用您的意见后返回的`async`问题。`events.fetch();`我使用延迟来处理这个问题。

```
var events = new Events();
var tracks = new Tracks();

$.when( events.fetch() )
.done( function(data) {
  console.dir(data)
  new EventsView({el: $("#calendar"), collection: events, collection2: tracks}).render();
  new AddSessionView({ collection: events}).render();
}); 
```

虽然，你`bind`的`reset`，应该照顾好那个......

编辑：我很想知道你`console`上面的读数是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:09:31.730

试试这个 ：

```
var events = new Events();
var tracks = new Tracks();

events.fetch();

new EventsView({el: $("#calendar"), collection: events, collection2: tracks}).render();
new AddSessionView({ collection: events}).render(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T18:23:22.973

我读到这`fetch()`是一个异步操作，因此当您获取集合时，将发送 ajax 调用，然后您的代码将继续运行，就像什么都没发生一样。

`fetch()`我最终在成功处理程序中创建了我的第一个视图：

```
events.fetch({success: function (models) {
    tracks.fetch({success: function (models) {
        new EventsView({el: $("#calendar"), collection: events, collection2: tracks}).render();
    }});
}}); 
```

# ios - NSAttributedString 和 iPhone 部署目标

> ID：15119513
> 
> 赞同：0
> 
> 时间：2013-02-27T18:27:51.170
> 
> 标签：ios, objective-c, xcode, ios6

我在我的应用程序中使用**NSAttributedString**。这是否意味着我必须将我的 iPhone**部署目标**设置为 6.0，因为仅从iOS 6.0 开始支持**NSAttributedString ？**
编辑：我在这里使用**NSAttributedString** [http://soulwithmobiletechnology.blogspot.com/2012/07/how-to-use-nsattributedstring-in-ios-6.html](http://soulwithmobiletechnology.blogspot.com/2012/07/how-to-use-nsattributedstring-in-ios-6.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:29:55.173

您也可以将部署目标设置为低于 ios6，但您`NSAttributedString`只能在具有`iOS6`及更高版本的设备上工作和有效。我建议你去iOS6，因为大多数用户已经升级到iOS6，在某处我读到的数字是**84%**已经升级到iOS6，你可以找到[适应iOS6的用户的参考](http://news.cnet.com/8301-13579_3-57537774-37/ios-6-adoption-hits-61-percent-just-one-month-after-its-release/)

# java - 如何使 android 应用程序（动画）更快/更流畅？

> ID：15119514
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:27:53.277
> 
> 标签：java, android, animation, frame-rate, smooth

我已经开始开发吉他应用程序，并且停留在图形方面。我的屏幕包含一个背景图像，您可以用两根手指向上或向下滑动来移动它。我的背景图像（位图）在 Android 设备上以低 fps 移动。我正在寻找如何使其运行更顺畅。

代码详细信息：我有 3 个类：一个主要活动，第二个用于图形，第三个作为启动屏幕（我没有包括最后一个，因为它与我的问题无关）。

MainActivity.java

```
package com.example.androidapplication;

import android.app.Activity;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;

public class MainActivity extends Activity implements OnTouchListener{

    FretBoard ourView;
    float y1, y2, dy;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        ourView = new FretBoard(this);
        ourView.setOnTouchListener(this);
        setContentView(ourView);

    }

    //Method to be used in future
    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        ourView.pause();
    }

    //Method to be used in future
    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        ourView.resume();
    }

    @Override
    public boolean onTouch(View v, MotionEvent event){

        //For debugging
        if(event!= null) ourView.fingerCount = event.getPointerCount();

        switch(event.getAction()){

            case MotionEvent.ACTION_DOWN:

                //Save first y position when finger touches screen
                y1 = event.getY();

                break;

            case MotionEvent.ACTION_MOVE:

                if(event != null && event.getPointerCount() == 2){

                    //Save second y position when finger moves
                    y2 = event.getY();

                    //Total distance moved
                    dy = y2 - y1;
                    if((ourView.bgY + dy)<0) ourView.bgY += dy/2;

                    //For Debugging
                    System.out.println("Y1 : " + y1 + "     Y2 : " + y2                +   "   DY : " + dy);

                    //Redraw the Screen 
                    ourView.invalidate();

                    //Reset y1 
                    y1 = y2;
                }

                break;
        }
        return true;
    }

} 
```

FretBoard.java

```
package com.example.androidapplication;

import java.io.InputStream;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class FretBoard extends SurfaceView implements Runnable{

    //Background image variables
    Bitmap background;
    InputStream is = getResources().openRawResource(R.drawable.fret_board);

    //Debugger text variables
    Paint mPaint = new Paint();
    String string = "Fingers: ";
    int fingerCount = 0;

    //Position Variables
    int width, height;
    float bgY = 0, bgX = 0;

    //Holder variable
    SurfaceHolder ourHolder;

    //To be used in future
    Thread ourThread = null;
    Boolean isRunning = false;

    public FretBoard(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        ourHolder = getHolder();
        ourThread = new Thread(this);
        ourThread.start();

    }

    //To be used in the future
    public void pause(){
        isRunning = false;
        while(true){
            try {
                ourThread.join();
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            break;
        }
        ourThread = null;
    }

    //To be used in the future
    public void resume(){
        isRunning = true;
        ourThread = new Thread(this);
        ourThread.start();
    }

    //Creates a InputStream to set width, then converts to bitmap to be
    //drawn as background on the canvas.
    public Bitmap bmScale(InputStream is){
       BitmapFactory.Options o = new BitmapFactory.Options();
       o.inSampleSize = 2;
       Bitmap bit = BitmapFactory.decodeStream(is, null, o);
       background = Bitmap.createScaledBitmap(bit, width, 2300, true);
       bit.recycle();
       return background;
    }

    //This is the draw method where I need help
    @Override
    public void run() {
        // TODO Auto-generated method stub
        while(isRunning){
            if(!ourHolder.getSurface().isValid()) continue;

            //Lock canvas to draw 
            Canvas canvas = ourHolder.lockCanvas();

            //Do Things Here:
            width = getWidth();
            height = getHeight();

            //Collision detection for the background
            if(bgY > 0 ) bgY = 0;

            //Draws the background
            bmScale(is);
            canvas.drawBitmap(background, bgX, bgY, null);

            //For debugging, displays the number of fingers on the screen
            canvas.drawText(string + fingerCount, 50, 50, mPaint);

            //Unlock canvas to show 
            ourHolder.unlockCanvasAndPost(canvas);
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:22:29.147

您似乎正在加载/读取和缩放每个渲染通道上的位图。这是非常低效的。（参见`bmScale(is);`FretBoard.java 中的调用）。

相反，只加载（并缩放）位图一次（当视图布局时），然后绘制已经加载和缩放的位图。

此外，您似乎将 a`SurfaceView`用于您的`FretBoard`. 为什么？在您的代码示例中，您根本没有使用 OpenGL 或视频/相机纹理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:29:24.617

循环缩放（如此处的其他答案所述）绝对是您的主要问题。一旦你解决了这个问题，事情应该会顺利得多。您可能仍然会发现一些轻微的口吃，因为您正在循环中创建其他对象，即字符串。鉴于您一次在指板上的手指永远不会超过 5 个（好吧，如果您正在敲击，理论上可能是 10 个）只有 5 或 10 个可能的值`string`（顺便说一下，这是一个令人困惑的名称，尤其是在这种情况下）。最好在循环之外预先创建这些，然后选择正确的参考。

# ruby-on-rails - 如何在 Rails 视图布局中检查路线范围

> ID：15119519
> 
> 赞同：0
> 
> 时间：2013-02-27T18:28:10.360
> 
> 标签：ruby-on-rails

我的 routes.rb 中有以下内容：

```
get "/account" => "main_site/account#index"
scope "/account" do
  resources :driver_sites, :controller=> "main_site/driver_site", :except => :index
end 
```

在 application.html.erb 我有一个带有一组菜单项的导航栏。仅当控制器为“帐户”或范围为“/帐户”（即“帐户/driver_sites/48/edit”）时，我才需要更改菜单项之一。其余的布局是相同的。

我也可以手动检查控制器是否为 driver_sites，但我还将在“/account”范围下添加其他资源，因此对范围为 account 的一般检查将是理想的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:15:32.553

这是一个古怪的解决方案：您可以使用它`Resquest#fullpath`来访问查询路径部分，所以这应该可以工作：

```
 request.fullpath =~ %r[^/account] 
```

# c# - 在 WPF UserControl 中，将子控件上的 FontSize 设置为 UserControl 的 FontSize

> ID：15119523
> 
> 赞同：3
> 
> 时间：2013-02-27T18:28:29.647
> 
> 标签：c#, wpf, wpf-controls

我正在尝试将 UserControl 中某些控件上的 FontSize（除其他外）设置为 UserControl 级别的 FontSize。这不起作用：

```
<UserControl x:Class="TestWpfApplication1.Scratch.UserControlFontSizeProp"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
   <Grid>
       <TextBlock 
        FontSize="{Binding RelativeSource={RelativeSource self},Path=FontSize}">
           Text
       </TextBlock>
   </Grid>
</UserControl> 
```

我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T18:55:17.297

认为这应该工作..

```
<TextBlock FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}" /> 
```

# rules - 替换 Drools 规则的最佳方法

> ID：15119526
> 
> 赞同：2
> 
> 时间：2013-02-27T18:28:36.050
> 
> 标签：rules, drools-flow

我有一个使用规则引擎将“动态逻辑”实现为 Drools 规则的系统。

对于每个客户端实施，使用特定实施的 drl 文件实施自定义定价和税收计算逻辑。

```
rule 'abc'
when
    name = 'X'
then
    price= '12'
end 
```

并且一个规则的条件依赖于之前规则的设置，所以基本上是规则转换。

这真的很痛苦，因为 drools 规则不是顺序编程并且对开发人员不友好。由于对 drools 评估方式的错误解释，引入了许多错误。

是否有更好的“java/groovy”替代方案可以轻松取代它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T13:12:53.777

我认为答案将取决于您最终想要的最终解决方案是什么。如果您想将业务规则从规则引擎中提取出来并放入 java/groovy，这与将它们从一个规则引擎中提取到另一个规则引擎中是非常不同的。

你的问题似乎倾向于先验，所以我会解决这个问题。使用这种方法要非常小心。以前实现此功能的人似乎在使用 Rete 算法方面以正确的方式做到了这一点，因为听起来一个规则的触发可以执行其他规则，这是很好的业务规则 - 它们不是顺序的，它们是声明性的. 请记住，命令式软件主要是为工程师编写的，它不会 100% 地映射回现实世界 :)

如果你想把它移到 java/groovy 中，你正在进入一种命令式语言，这可能会让你陷入 if/then/else 地狱。我建议如下：

1.  将此代码与您的代码库的其余部分隔离开来——将来当业务更改其规则时，您将对此代码进行大量维护。良好的界面设计和封装将在未来获得巨大回报。
2.  与您的业务客户一起开发某种类型的 DSL，这样当他们说“信用政策”之类的内容时，您就可以确切地知道他们指的是什么，并且可以适当地更改相关规则。
3.  单元测试，单元测试，单元测试。这也适用于您当前的配置。如果您现在发现错误，为什么不进行测试？设置 junit 来创建对象并调用 Drools 引擎并测试响应并不需要很长时间。如果您添加一些循环来测试期望相同响应的变量范围，您可以立即参与数十万次测试。

顺便说一句：如果您不想走这条路，那么我强烈建议您接受一些有关 Drools 的培训，以便您了解引擎和 Rete（如果您还没有的话）。如果您能够将客户的规则快速转化为可实施的软件，那么您可以与客户取得一些巨大的成功。

# php - 编辑主题以应用 Co-Authors Plus

> ID：15119535
> 
> 赞同：3
> 
> 时间：2013-02-27T18:29:01.120
> 
> 标签：php, wordpress, wordpress-theming

我正在尝试实现[Co-Authors Plus](http://wordpress.org/extend/plugins/co-authors-plus/)插件。它说您需要在主题中更改一些 PHP。它概述了此[链接](http://vip.wordpress.com/documentation/incorporate-co-authors-plus-template-tags-into-your-theme/)上的更改。

我相信我已经找到了我需要在主题中更改它的地方。在一个名为“post-author-info.php”的文件中。

这是它的样子：

```
<?php
/**
 * Post Author Info
 *
 * @package WP Journal
 * @subpackage Include
 */
 ?>

<div id="authorinfo" class="columns alpha omega marT30 marB20">
    <a href="<?php the_author_meta('url'); ?>"><?php echo get_avatar( get_the_author_meta('email'), '80' ); ?></a>
    <h5 class="marB10"><?php _e('By', 'contempo'); ?>: <a href="<?php the_author_meta('url'); ?>"><?php the_author(); ?></a></h5>
    <p><?php the_author_meta('description'); ?></p>
        <div class="clear"></div>
</div> 
```

只是添加这一行`<?php if ( function_exists( 'coauthors' ) ) { coauthors(); } else { the_author(); } ?>`似乎给了我想要的东西。“Admin”和“Andrew Gable”都会显示。

这是应用更改时的屏幕截图。![照片](../Images/3876d29877f4e3e825020522b9a0bd00.png)

我不确定如何让它正确链接，以及如何处理照片和多个生物。

**谢谢**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-24T13:12:20.780

您可能想在[https://wordpress.stackexchange.com/上发布这个问题](https://wordpress.stackexchange.com/)

我有一个类似的问题并以这种方式解决：

```
global $post;
$author_id=$post->post_author;
foreach( get_coauthors() as $coauthor ): ?>
  <div class="entry-author co-author">
    <?php echo get_avatar( $coauthor->user_email, '96' ); ?>
    <h3 class="author vcard"><span class="fn"><a href="<?php echo get_author_posts_url( $coauthor->ID, $coauthor->user_nicename ); ?>"><?php echo $coauthor->display_name; ?></a></span></h3>
    <p class="author-bio"><?php echo $coauthor->description; ?></p>
    <div class="clear"></div>
   </div><!-- .entry-author co-author -->
<?php endforeach; 
```

一定要使用它`global $post;`和`foreach`-loop。

此功能将显示一个作者框，其中包含作者图像/头像、作者姓名及其档案链接以及作者的简历。不过，您可能想使用自己主题的 CSS 类。

# jquery - 如何在 J-Query UI DatePicker 中设置默认日期

> ID：15119538
> 
> 赞同：0
> 
> 时间：2013-02-27T18:29:13.913
> 
> 标签：jquery, asp.net, jquery-ui, jquery-ui-datepicker

我试图在页面加载时在我的 2 个文本框控件中设置默认日期。我希望始终将第一个文本框（StartDate）设置为上个月的第一个文本框（例如 2013 年 1 月 1 日）。我还想将第二个文本框（EndDate）设置为上个月的月底，如 2013 年 1 月 31 日。一旦页面第一次加载，我希望在文本框中加载这些默认值。在此先感谢您的帮助。
这是我当前的代码：

```
 <link href="Styles/ui-lightness/jquery-ui-1.8.23.custom.css" rel="stylesheet" type="text/css" />
        <script src="Scripts/jquery-1.8.1.min.js" type="text/javascript"></script>
        <script src="Scripts/jquery-1.8.3.js" type="text/javascript"></script>
       <script src="FusionCharts/jquery.min.js" type="text/javascript"></script>
        <script src="Scripts/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>

        <script type="text/javascript">
            $(document).ready(function () {
                $('.datepicker').datepicker();

            });
    </script>

<div>
<asp:TextBox ID="StartDate" runat="server" CssClass="datepicker" Width="110px"></asp:TextBox> 
</div>

<div>
<asp:TextBox ID="EndDate" runat="server" CssClass="datepicker" Width="110px"></asp:TextBox> 
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:04:19.657

我能够这样做：

```
$( ".datepicker" ).datepicker();
var firstDay, lastDay;
firstDay = firstDayNextMonth(new Date(2013, 0, 5)); // january = 0
lastDay = lastDayNextMonth(firstDay);
$("#StartDate").datepicker("setDate",  firstDay);
$( "#EndDate" ).datepicker("setDate", lastDay );

function firstDayNextMonth(date) {
    var d = date;
    if(d === undefined)
        d = new Date();

    d.setDate(1);
    if(d.getMonth() < 11)
        d.setMonth(d.getMonth() + 1);
    else
        d.setMonth(0);
    return d;
}

function lastDayNextMonth(myDate) {
    var endDate = new Date(myDate.getFullYear(), myDate.getMonth(), 1);
    if(endDate.getMonth() < 11)
        endDate.setMonth(endDate.getMonth() + 1);
    else
        endDate.setMonth(0);
    return new Date(endDate.getFullYear(), endDate.getMonth(), 0);
} 
```

[链接到 jsFiddle 中的代码](http://jsfiddle.net/xDQag/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:04:11.467

```
Start <input type="text" id="StartDate"/><br>
End <input type="text" id="EndDate"/> 
```

jQuery：

```
$(function(){
  $("#StartDate").datepicker();
  $("#EndDate").datepicker();
  var startdate=new Date();
  startdate.setMonth(startdate.getMonth() - 1, 1);
  $("#StartDate").datepicker("setDate",startdate);
  var endDate=new Date(); // current date
  endDate.setDate(1); // going to 1st of the month
  endDate.setHours(-1);
  $("#EndDate").datepicker("setDate",endDate);    
}); 
```

[jsfiddle](http://jsfiddle.net/ZedBee/Rf8rx/)

您的代码（已编辑）

```
<link href="Styles/ui-lightness/jquery-ui-1.8.23.custom.css" rel="stylesheet" type="text/css" />
<script src="Scripts/jquery-1.8.1.min.js" type="text/javascript"></script>
<script src="Scripts/jquery-1.8.3.js" type="text/javascript"></script>
<script src="FusionCharts/jquery.min.js" type="text/javascript"></script>
<script src="Scripts/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function () {
       $("#StartDate").datepicker();
       $("#EndDate").datepicker();
       var startdate=new Date();
       startdate.setMonth(startdate.getMonth() - 1, 1);
       $("#StartDate").datepicker("setDate",startdate);
       var endDate=new Date(); // current date
       endDate.setDate(1); // going to 1st of the month
       endDate.setHours(-1);
       $("#EndDate").datepicker("setDate",endDate);
    });
</script>

<div>
<asp:TextBox ID="StartDate" runat="server" CssClass="datepicker" Width="110px">   </asp:TextBox> 
</div>

<div>
<asp:TextBox ID="EndDate" runat="server" CssClass="datepicker" Width="110px">  </asp:TextBox> 
</div> 
```

注意：为了运行上述脚本，请确保将`ClientIDMode`其设置为`static`

```
<%@ Page Title="" Language="C#" ClientIDMode="Static" ... 
```

[用于 jquery 1.8.3 和 jquery ui 1.8.23 的 jsfiddle](http://jsfiddle.net/ZedBee/Rf8rx/1/)

# ruby-on-rails - 在 Rails 应用程序中使用 GeoIP 和 Nginx/Passenger

> ID：15119544
> 
> 赞同：1
> 
> 时间：2013-02-27T18:29:38.810
> 
> 标签：ruby-on-rails, nginx, geolocation, passenger

我一直在尝试设置我的 Rails 应用程序（部署在乘客 3 + Nginx 上）与 MaxMind 的 GeoLite 城市一起使用，但无济于事。

```
# nginx.conf
# IP Geolocation - City Level
geoip_city /usr/share/GeoIP/GeoLiteCity.dat;
passenger_set_cgi_param HTTP_GEOIP_CITY_COUNTRY_CODE $geoip_city_country_code;
passenger_set_cgi_param HTTP_GEOIP_CITY_COUNTRY_CODE3 $geoip_city_country_code3;
passenger_set_cgi_param HTTP_GEOIP_CITY_COUNTRY_NAME $geoip_city_country_name;
passenger_set_cgi_param HTTP_GEOIP_REGION $geoip_region;
passenger_set_cgi_param HTTP_GEOIP_CITY $geoip_city;
passenger_set_cgi_param HTTP_GEOIP_POSTAL_CODE $geoip_postal_code;
passenger_set_cgi_param HTTP_GEOIP_CITY_CONTINENT_CODE $geoip_city_continent_code;
passenger_set_cgi_param HTTP_GEOIP_LATITUDE $geoip_latitude;
passenger_set_cgi_param HTTP_GEOIP_LONGITUDE $geoip_longitude; 
```

然后在我的 Rails 应用程序中，我执行以下操作：

```
geodata = {
  country_code: request.env["HTTP_GEOIP_CITY_COUNTRY_CODE"],
  country_name: request.env["HTTP_GEOIP_CITY_COUNTRY_NAME"],
  region: request.env["HTTP_GEOIP_REGION"],
  city_name: request.env["HTTP_GEOIP_CITY"],
  zipcode: request.env["HTTP_GEOIP_POSTAL_CODE"],
  lat: request.env["HTTP_GEOIP_LATITUDE"],
  lng: request.env["HTTP_GEOIP_LONGITUDE"]
} 
```

但它总是为所有值返回 nil。我是否正确设置了变量？地理数据库是否配置不正确？Nginx 不会抛出任何错误并且`--with-http_geoip_module`设置了编译标志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:51:12.950

想通了。事实证明，除了在块中指定之外`geoip_city`，`http {}`您还必须`passenger_set_cgi_param`在块中指定指令`server {}`，并为变量添加前缀，`HTTP_`以便它们通过。

# matlab - 如何在 Matlab 中正确矢量化

> ID：15119549
> 
> 赞同：0
> 
> 时间：2013-02-27T18:29:54.103
> 
> 标签：matlab, vectorization

我有一组代码需要很长时间才能运行。我阅读了 mathworks 网站上的矢量化页面。我仍然有点困惑，是否可以对我运行 plane_intersect 的部分进行矢量化？

未矢量化

```
for N = 1:sizeDimages
    imPos = anaInfoSat(N).ImagePositionPatient;
    A2Z = imPos(3);
    A2Y = imPos(2);
    A2X = imPos(1);

    [upP1(N,:)]=plane_intersect([cosSx(1),cosSy(1),cosSz(1)],[uppersatX1,uppersatY1,uppersatZ1],crossS,[A2X,A2Y,A2Z]);
    [loP1(N,:)]=plane_intersect([cosSx(1),cosSy(1),cosSz(1)],[lowersatX1,lowersatY1,lowersatZ1],crossS,[A2X,A2Y,A2Z]);
end 
```

我在矢量化方面的尝试是 upP1 是一个 Nx3 矩阵。我预先分配了 upP1 矩阵。下面的代码返回关于尺寸不匹配的错误。ImagePosition 是一个 1x3 矩阵。

```
N = 1:sizeDimages;
imPos = anaInfoSat(N).ImagePositionPatient;
A2Z = imPos(3);
A2Y = imPos(2);
A2X = imPos(1);

[upP1(N,:)]=plane_intersect([cosSx(1),cosSy(1),cosSz(1)],[uppersatX1,uppersatY1,uppersatZ1],crossS,[A2X,A2Y,A2Z]);
[loP1(N,:)]=plane_intersect([cosSx(1),cosSy(1),cosSz(1)],[lowersatX1,lowersatY1,lowersatZ1],crossS,[A2X,A2Y,A2Z]); 
```

这是 plane_intersect 代码的一部分，应该足以让您知道它的作用。

```
function [P,N,check]=plane_intersect(N1,A1,N2,A2)
%plane_intersect computes the intersection of two planes(if any) 
% Inputs: 
%       N1: normal vector to Plane 1
%       A1: any point that belongs to Plane 1
%       N2: normal vector to Plane 2
%       A2: any point that belongs to Plane 2
%
%Outputs:
%   P    is a point that lies on the interection straight line.
%   N    is the direction vector of the straight line
% check is an integer (0:Plane 1 and Plane 2 are parallel' 
%                              1:Plane 1 and Plane 2 coincide
%                              2:Plane 1 and Plane 2 intersect)
%
% Example:
% Determine the intersection of these two planes:
% 2x - 5y + 3z = 12 and 3x + 4y - 3z = 6
% The first plane is represented by the normal vector N1=[2 -5 3]
% and any arbitrary point that lies on the plane, ex: A1=[0 0 4]
% The second plane is represented by the normal vector N2=[3 4 -3]
% and any arbitrary point that lies on the plane, ex: A2=[0 0 -2]
%[P,N,check]=plane_intersect([2 -5 3],[0 0 4],[3 4 -3],[0 0 -2]); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:52:56.940

在您的矢量化代码`anaInfoSat(N).ImagePositionPatient;`中不会返回一个，而是几个答案。如果将结果分配给单个变量，它将只收到第一个答案。这就是您收到尺寸不匹配错误的原因。

根据数据类，您可以组合成一个矩阵

```
imPos = [anaInfoSat(N).ImagePositionPatient]; 
```

或进入单元阵列

```
imPos = {anaInfoSat(N).ImagePositionPatient}; 
```

* * *

您还可以同时分配给多个变量：

```
[A2X, A2Y, A2Z] = anaInfoSat(1:3).ImagePositionPatient; 
```

# android - 请帮助我运行我的第一个 android 应用程序

> ID：15119553
> 
> 赞同：0
> 
> 时间：2013-02-27T18:30:08.073
> 
> 标签：android, emulation

从过去 2 天开始，我已经多次尝试卸载和安装 eclipse、sdk 和 adt 插件，在 stackoverflow 和其他论坛上的每个帖子上都尝试了所有内容，但对我来说没有任何效果。我正在尝试在模拟器上运行 MyfirstApp hello world 程序，但模拟器总是挂起 -

在设备 emulator-5554 上启动活动 com.example.myfirstapp.MainActivity

并且永远不会在模拟器屏幕上显示任何内容。我等了几个小时看看是否发生了什么事，虽然一直在 log cat 显示一些处理。我还看到类似 - 在 logcat 中找不到类 java.lang.utilities 等。

我的电脑配置如下-

1.3 GHz Intel atom 处理器 1 GB Ram 160 GB 硬盘

一开始我很有动力，但这件事让我很沮丧，任何建议和帮助都将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T22:35:54.573

好的找到了我的问题的解决方案。希望它也能帮助你。我的应用程序在后台运行。我解锁了手机，我的应用程序一直在那里。

[http://androidforums.com/application-development/118051-hello-android-stops-running-eclipse-can-not-display-app-emulator.html](http://androidforums.com/application-development/118051-hello-android-stops-running-eclipse-can-not-display-app-emulator.html)

# javascript - 使用 document.getElementById

> ID：15119555
> 
> 赞同：1
> 
> 时间：2013-02-27T18:30:12.507
> 
> 标签：javascript, html, dom

我有一段时间从我想要的 dom 中获取一些数据。

我这里有一些 html：

```
 <ul id="userMenu">
      <li class="userGreet devi">I WANT THIS TEXT HERE </li><li> <a href="javascript:void(0)" class="more" title="Menu">Menu</a>
      <ul> ....
            <li class="home">   
            </li>
      </ul>
      ...</li>
 </ul> 
```

我知道如果我说

```
var x = document.getElementById('userMenu'); 
```

我可以取回“某些东西”（尽管这一切都在门户中，因此将 java 脚本断点放入其中非常困难）。所以我不确定如何进一步获取字符串`"I WANT THIS TEXT HERE "` ？

我想我必须遍历 childNodes 但不确定我究竟是如何返回或返回什么以便我可以得到那个字符串，getElementById 也不适用于 class= 那会是 getElementByClass 吗？

这个 DOM 东西的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:32:26.087

你可以使用这个：

```
var text = document.querySelectorAll('#userMenu li.userGreet.devi')[0].innerHTML; 
```

请参阅[MDN 的 querySelectorAll 文档](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)。

请注意，这不适用于 IE7。要以跨浏览器的方式更轻松地执行此类操作，您可以使用流行的 DOM 操作库之一，例如[jQuery](http://jquery.com/)。

* * *

如果您的 HTML 与您想要的文本不同（例如，您有标记），您可以使用它来获取解释的文本：

```
var element = document.querySelectorAll('#userMenu li.userGreet.devi')[0];
var text = element.innerText || element.textContent; 
```

请注意，这里的库再次帮助您处理浏览器之间的不兼容问题。Jquery会让你做

```
var text = $('#userMenu li.userGreet.devi').text(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:34:04.000

试试这个...

```
document.getElementById('userMenu').children[0].innerHTML 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:35:25.757

你可以这样扫描

```
var x = document.getElementById('userMenu');  
var xChilds = x.childNodes;
var requiredElement = null;
for(var i = 0; i < xChilds.length; i++) {
   if(xChilds[i].className.indexOf('usergreet devi') !== -1) {
      requiredElement = xChilds[i];
      break;
   }
}

console.log(requireElement); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T19:11:37.643

如果元素的顺序发生了一点变化，则使用纯 javascript 并使您的代码更加健壮，您可以同时使用 id 和 class 来获得它，如下所示：

```
var text = document.getElementById('userMenu').getElementsByClassName("userGreet")[0].innerHTML; 
```

或使用标签名称，可以这样做：

```
var text = document.getElementById('userMenu').getElementsByTagName("li")[0].innerHTML; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:34:05.847

jQuery 将使这更容易。你可以做类似的事情

```
var text = $('#userMenu .userGreet.devi').text(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T04:52:05.390

很抱歉，如果这很明显，但是...一般来说，如果您要尝试访问元素，请在一开始就给它们 ID，这将为您节省大量时间。

```
<li id="ug0" class="userGreet devi">...</li> 
```

那么当然

```
document.getElementById('ug0').innerHTML; 
```

# rest - Twitter API 1.1 用户图像和名称

> ID：15119558
> 
> 赞同：4
> 
> 时间：2013-02-27T18:30:21.720
> 
> 标签：rest, twitter

Twitter 提供了一个很棒的 1.0 API。我可以像这样抓取用户图像：

```
http://api.twitter.com/1/users/profile_image/twitter 
```

1.1 更新会免费提供这样的东西吗？还是 1.1 更新需要对用户图像和用户名进行身份验证？[我注意到文档](https://dev.twitter.com/docs/api/1.1)中没有等效的调用。

这不起作用：

```
 http://api.twitter.com/1.1/users/profile_image/twitter 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-04T00:30:02.770

您只能通过身份验证获取用户图像和用户名。如果您尝试使用 Abraham 的 twitteroauth 获取用户个人资料图像，那么我想这个[链接](http://codedsack.com/get-user-tweets-php-twitter-api-v1-1/)会对您有所帮助。您可以通过调用名称对象类似地获取用户名并显示它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-27T18:37:25.250

您应该在此处的 Twitter API 文档中找到答案：

[https://dev.twitter.com/docs/user-profile-images-and-banners](https://dev.twitter.com/docs/user-profile-images-and-banners)

例如：`https://api.twitter.com/1.1/users/show.json?screen_name=twitterapi`

它确实需要身份验证来检索它：

# javascript - 需要帮助在 javascript 中使用 href 中的引号

> ID：15119562
> 
> 赞同：1
> 
> 时间：2013-02-27T18:30:44.567
> 
> 标签：javascript

我需要帮助使用 js 编写链接。

这就是我所拥有的，但我无法让它运转起来。你能帮我吗？

```
document.write('<a href=\"\http://www.domain.com/drowning-accidents/\"\ target=\"\_blank\"\ onClick=\"\trackOutboundLinktarget=(this, 'Outbound Links', 'domain.com'); return false;\"\><img src=\"images/infographic.png\" border=\"0\" class=\"borders\" alt=\"Check out the Infographic\" /></a><br /><br /></center>'); 
```

我认为这与 Outbound 周围的单引号有关......但不确定。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:32:23.770

您需要转义单引号，因为整个字符串都用单引号括起来：

```
'...(this, \'Outbound Links\', \'domain.com\');...'
           ^               ^   ^           ^ 
```

从技术上讲，不需要转义双引号。您只需要转义与整个字符串周围使用的引号类型相同的引号。

此外，您似乎正在转义一些奇怪的字符：

```
\"\http://www.domain.com/drowning-accidents/\"\ target=\"\_blank\"\ 
  ^^ ??                                       ^^ ??      ^^ ?? 
```

转义字符的正确模式是`\x`，而不是`\x\`。否则，第二个`\`将被误解为第二个转义序列的开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:33:13.907

我希望我找到了所有`\`太多而缺少的……</p>

```
document.write('<a href="http://www.domain.com/drowning-accidents/" target="_blank" onclick="trackOutboundLinktarget=(this, \'Outbound Links\', \'domain.com\'); return false;"><img src="images/infographic.png" border="0" class="borders" alt="Check out the Infographic" /></a><br /><br /></center>'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:34:07.763

你有双引号转义，但整个字符串在单引号内。只需将其更改为双引号即可。

试试这个：

```
document.write("<a href=\"http://www.domain.com/drowning-accidents/\" target=\"_blank\" onClick=\"trackOutboundLinktarget=(this, 'Outbound Links', 'domain.com'); return false;\"><img src=\"images/infographic.png\" border=\"0\" class=\"borders\" alt=\"Check out the Infographic\" /></a><br /><br /></center>"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:35:07.190

不必转义字符串中的所有 ' 或 "。当您与字符串的配额相同时，它应该转义。

示例：
“I'm a boy”这个字符串不需要转义
但是看这个例子：
'I\'ma boy'这次你必须转义，因为字符串的引号相同

```
document.write('<a href="http://www.domain.com/drowning-accidents/" target="_blank" onClick="trackOutboundLinktarget=(this, \'Outbound Links\', \'domain.com\'); return false;"><img src="images/infographic.png" border="0" class="borders" alt="Check out the Infographic" /></a><br /><br />'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:42:15.190

尝试使用此代码..

```
document.write("<a href=\"\http://www.domain.com/drowning-accidents/\"\ target=\"\_blank\"\ onClick=\"\trackOutboundLinktarget=(this, 'Outbound Links', 'domain.com'); return false;\"\><img src=\"images/infographic.png\" border=\"0\" class=\"borders\" alt=\"Check out the Infographic\" /></a><br /><br /></center>"); 
```

我猜你使用了单引号而不是双引号。检查它是否有效..:)

# ios - 将图像从应用程序复制到文档目录并在之后重写它们

> ID：15119564
> 
> 赞同：1
> 
> 时间：2013-02-27T18:30:53.003
> 
> 标签：ios, uiimage, nsbundle, nsdocumentdirectory

我有一个应用程序，其中有一定数量的 .jpg 图片（大约 300 张）。它们作为开始的东西，因为它们实际上位于互联网中，但显然用户在第一次启动应用程序时不要将它们全部下载，而是将它们预先打包更方便。

每次从服务器获取新信息时，我都需要重写这些图像。显然，我无法触摸应用程序包，所以我看到我的步骤是这样的：

1.  在应用程序第一次启动时将图像从捆绑包中解压缩到文档目录。
2.  只能从 Documents Directory 访问它们，而不是从 bundle 访问它们。
3.  如果有必要，我应该重写它们。

因此我的代码将是统一的，因为我将始终使用相同的路径来获取图像。

问题是我对 iOS 中的整个文件系统知之甚少，所以我不知道如何将特定的捆绑内容解压到 Documents Directory，也不知道如何写入 Documents Directory。

你能帮我一些代码并确认我的解决方案是正确的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:56:04.647

```
NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *destPath = [documentsDirectory stringByAppendingPathComponent:@"images"];  //optionally create a subdirectory

//"source" is a physical folder in your app bundle.  Once that has a blue color folder (not the yellow group folder)
// To create a physical folder in your app bundle: drag a folder from Mac's Finder to the Xcode project, when prompts
// for "Choose options for adding these files" make certain that "Create folder references for …" is selected.
// Store all your 300 or so images into this physical folder.

NSString *sourcePath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"source"];  
NSError *error;
[[NSFileManager defaultManager] copyItemAtPath:sourcePath toPath:destPath error:&error];
if (error)
    NSLog(@"copying error: %@", error); 
```

根据 OP 的附加评论进行编辑：

用相同的文件名重写到同一个目录，可以使用fileExistsAtPath和removeItemAtPath的组合在写入前检测并删除现有文件。

```
if ([[NSFileManager defaultManager] fileExistsAtPath:filePath])
{
    [[NSFileManager defaultManager] removeItemAtPath:filePath error:&error];
}
// now proceed to write-rewrite 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T13:18:38.997

试试这个代码

```
-(void)demoImages
{

//-- Main bundle directory
NSString *mainBundle = [[NSBundle mainBundle] resourcePath];
NSFileManager *fm = [NSFileManager defaultManager];
NSError *error = [[NSError alloc] init];
NSArray *mainBundleDirectory = [fm  contentsOfDirectoryAtPath:mainBundle error:&error];

NSMutableArray *images = [[NSMutableArray alloc]init];
for (NSString *pngFiles in mainBundleDirectory)
{
    if ([pngFiles hasSuffix:@".png"])
    {
        [images addObject:pngFiles];
    }
}

NSLog(@"\n\n Doc images %@",images);
//-- Document directory
NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
 NSString *documentDirectory = [paths objectAtIndex:0];
NSFileManager *fileManager = [NSFileManager defaultManager];

//-- Copy files form main bundle to document directory
for (int i=0; i<[images count]; i++)
{
    NSString *toPath = [NSString stringWithFormat:@"%@/%@",documentDirectory,[images objectAtIndex:i]];
    [fileManager copyItemAtPath:[NSString stringWithFormat:@"%@/%@",mainBundle,[images objectAtIndex:i]] toPath:toPath error:NULL];
    NSLog(@"\n Saved %@",fileManager);
}

} 
```

# ios - 在 iPhone 上的 UIDatePickerModeDate 中的 UIDatePicker 中显示特定日期

> ID：15119565
> 
> 赞同：1
> 
> 时间：2013-02-27T18:30:56.247
> 
> 标签：ios, nsdate, nsdateformatter, uidatepicker

我有一个`NSString`包含字符串的对象`2013-02-28`。默认情况下，`UIDatepicker`显示当前日期，但我想显示`NSString`对象中的任何日期。

我正在将`NSString`对象转换为`NSDate`，但我不知道如何`UIDatePicker`在`UIDatePickerModeDate`. 我怎么能这样做？我已经尝试过该`setDate:`方法，但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:55:18.720

这应该适合你。在将其发送到 NSDatePicker 之前，您可能需要将 NSString 转换为 NSDate。请记住，您可能需要设置 NSDateFormater 的时区以避免极端情况。

```
 //Given self.datepicker is your UIDatePicker 

  NSString *dateString = @"2013-03-28";
  NSTimeZone *timezone = [NSTimeZone systemTimeZone];

  NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
  [dateFormatter setTimeZone:timeZone];
  [dateFormatter setDateFormat:@"yyyy-MM-dd"];

  NSDate *date = [dateFormatterGMTAware dateFromString:dateString];
  self.datePicker.date = date; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T07:48:17.213

```
-(IBAction)btnDateClicked:(id)sender{

    theDatePicker = [[UIDatePicker alloc] initWithFrame:CGRectMake(0.0, 44.0, self.view.frame.size.width, 0.0)];
    theDatePicker.datePickerMode = UIDatePickerModeDate;
    theDatePicker.minimumDate=[NSDate date];

    // ************To keep the selected date**********

    NSString *dateString = [NSString stringWithFormat:@"%@",btnDate.titleLabel.text ];
    NSTimeZone *timezone = [NSTimeZone systemTimeZone];

    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setTimeZone:timezone];
    [dateFormatter setDateFormat:@"yyyy-MM-dd"];

    NSDate *date = [dateFormatter dateFromString:dateString];
    theDatePicker.date = date;
} 
```

# python - 使用推文中的 Facebook 图片

> ID：15119567
> 
> 赞同：0
> 
> 时间：2013-02-27T18:31:18.930
> 
> 标签：python, facebook, twitter

对于我目前正在开发的应用程序，我正在使用 Twitter Python 包装器提取推文对象。如果推文有图像，我将提取该图像 URL 并将其传递到模板中以显示图像。如果推文对象的图像具有 twitpic 或 instagram URL，则 URL 会很好地传递到源中，并且图像会正确显示。

但是，如果推文对象具有来自 facebook URL 的图像，则该图像将作为损坏返回。这似乎是因为图片的 facebook URL 实际上是帖子的 URL。因此，当您尝试将 URL 传递到图像标签时，它会返回损坏的图像，因为 URL 实际上不是用于图像，而是用于 facebook 帖子。所以我的问题是：如何从 facebook 帖子中提取图像 URL，以便将其传递到我的模板中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:35:12.960

Use the Facebook Graph API to query for that page or try to pull an automatic picture

*   [https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)
*   [https://developers.facebook.com/docs/reference/api/using-pictures/](https://developers.facebook.com/docs/reference/api/using-pictures/)
*   [https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer)

# java - 单元测试不适用于 XSLT 转换器

> ID：15119571
> 
> 赞同：0
> 
> 时间：2013-02-27T18:31:26.573
> 
> 标签：java, xslt, junit, mule, transformer

我已经编写了单元测试用例来单独测试我的 mule 流中的消息处理器。

但是单元测试失败并出现错误

```
org.mule.api.transformer.TransformerMessagingException: Property "xsl-file or xsl-text" not set.  
One or more of them must be set (org.mule.api.lifecycle.InitialisationException).
 Message payload is of type: String    
 (org.mule.api.transformer.TransformerMessagingException). Message payload is of type: String 
```

其中一个转换器是 XSLT，如下所示。

```
<mule-xml:xslt-transformer  maxIdleTransformers="2" maxActiveTransformers="5"   xsl-file="C:\EWS\myproj\src\main\resources\xslt\DataAdder.xsl"
         name="AdderXSLT"   >
    </mule-xml:xslt-transformer> 
```

单元测试方法如下所示。

```
 MessageProcessor subFlow = muleContext.getRegistry().lookupObject("AdderXSLT");
    MuleEvent result = subFlow.process(getTestEvent(getFileAsString("SamplePayloads/input.xml")));  

    System.out.println("The output from Event is " + result.getMessageAsString());
    System.out.println("The converted XML is " + result.getMessage().getPayloadAsString()); 

    assertNotNull(result);
    assertNull(result.getMessage().getExceptionPayload());
    assertFalse(result.getMessage().getPayload() instanceof NullPayload); 
```

请帮助我了解这里出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:37:26.607

我之前遇到过类似的情况，当您不在流的上下文中执行它时，您需要显式地初始化转换器。过去，为了测试我使用的类似于以下的 xslt 转换器：

```
XsltTransformer xslt = FunctionalTestCase.muleContext.getRegistry()
                .lookupObject("SuccessResponseTransformer");
        xslt.setReturnDataType(DataType.STRING_DATA_TYPE);
        xslt.initialise();

        String result = (String) xslt.transform(srcXML); 
```

您可以尝试这样的事情或尝试强制转换为 XsltTransformer 进行初始化。

我相信这是因为当您将 MP 作为流的一部分执行时，它是 MessageProcessorChain 的一部分，它将在适当的情况下初始化每个 MP。如果您查看 AbstractMessageProcessorChain 中的以下代码 - [http://grepcode.com/file/repo1.maven.org/maven2/org.mule/mule-core/3.3.1/org/mule/processor/chain/ AbstractMessageProcessorChain.java#AbstractMessageProcessorChain.initialise%28%29](http://grepcode.com/file/repo1.maven.org/maven2/org.mule/mule-core/3.3.1/org/mule/processor/chain/AbstractMessageProcessorChain.java#AbstractMessageProcessorChain.initialise%28%29)：

```
public void initialise() throws InitialisationException
    {
         for (MessageProcessor processor : processors)
       {
         // MULE-5002 TODO review MP Lifecycle
            if (processor instanceof Initialisable /* && !(processor instanceof Transformer) */)
           {
                ((Initialisable) processor).initialise();
            }
        }
    } 
```

请注意， (!instanceof Transformer) 已被注释掉。所以它会为你初始化 XsltTransformer。

直接引用 MessageProcessor 不会。

# c++ - 为什么覆盖出现在成员声明之后而不是与虚拟相同的位置？

> ID：15119572
> 
> 赞同：6
> 
> 时间：2013-02-27T18:31:35.947
> 
> 标签：c++, c++11

我很好奇为什么新的 C++11 关键字被迫以与而不是`override`一致的方式出现在方法声明之后？`const``virtual`

```
class SomeBaseClass {
    virtual void DoPolymorphicBehavior() = 0;
    ...
class SomeDerrivedClass : public SomeBaseClass {
    void DoPolymorphicBehavior() override;
    ... 
```

为什么在世界上不允许它在相同的确切位置（甚至代替）`virtual`

```
class SomeBaseClass {
    virtual void DoPolymorphicBehavior() = 0;
    ...
class SomeDerrivedClass : public SomeBaseClass {
    override void DoPolymorphicBehavior();
    ... 
```

这将允许我在我的源文件中对派生类进行搜索和替换，以轻松地使用 new 关键字，从而在查找错误时从编译器获得帮助。但是，由于 C++11 在语法上将其置于不同的位置，因此我必须手动更新数千行源代码才能从新的编译器功能中获得任何好处。

这个选择背后肯定有充分的理由吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T18:43:56.183

出现在函数名之前的声明说明符序列可以包含一个标识符（例如，函数的返回类型）。想象一些现有代码的返回类型为`override`：

```
override foo(); 
```

甚至是一个名为的变量`override`：

```
int override; 
```

引入一个新的关键字`override`会破坏任何现有的代码，这些代码包含一个名为的标识符，`override`因为关键字是保留的。

因此，他们没有引入新的关键字，而是引入了*上下文关键字*：（`override`以及`final`）。上下文关键字通过其句法位置标识为关键字。`override`在程序中调用标识符仍然可以`final`。如果这些标识符出现在函数声明中的参数列表之后，则它们具有特殊含义。

所以将它放在函数参数之后的原因是因为引入新关键字会破坏旧代码，如果编译器看到`override`这里，他们就会确切地知道它的含义，因为这里不会出现其他标识符。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-27T18:34:57.117

It's not a keyword and that is the answer to your question as well.

It is an identifier with a special meaning in some contexts. If it were allowed to appear at the start of the declaration it could be ambiguous with, say, a user defined return type name.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T18:47:13.580

因为`override`and`final`不是关键字，而是符号，可以出现在用户代码中。（即您可以有一个变量 `int override;`。）它们仅在有限的上下文中具有其特定含义，并且必须选择这些上下文以对应于用户定义的符号不能出现的上下文。也希望立即说明这一点；在这种情况下：

```
override void DoSomething(); 
```

,`override`不能是用户符号，因为没有语法产生式可以有一个以用户定义符号开头的语句，后跟`void`. 但是在编译器遇到 之前，这个问题并不清楚`void`，如果 `void`你有一个用户定义的类型而不是 ，它就更加模棱两可了。另一方面，在函数的参数声明子句之后，上下文是明确的，编译器的扫描器立即知道要做什么。

# c# - 如何迭代 Razor 中的一组对象？

> ID：15119575
> 
> 赞同：1
> 
> 时间：2013-02-27T18:31:38.743
> 
> 标签：c#, asp.net-mvc, razor

我对使用 Razor 语法迭代一组对象感到困惑。

假设在控制器中，我设置：

```
 ViewBag.accounts = accounts;
            Session["accounts"] = accounts; 
```

在 cshtml 页面中，我想遍历帐户：

```
@foreach (var account in ViewBag.accounts) 
```

这很好用，但相同的语法不适用于会话：

```
@foreach (var account in Session.accounts) 
```

也不

```
@foreach (var account in Session["accounts"]) 
```

如何迭代会话中的集合？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:33:40.400

`Session`不是动态的。
相反，它的索引器返回`object`.

要在 foreach 循环中使用它，您必须将值显式转换为`IEnumerable<T>`：

```
@foreach (var account in (IEnumerable<SomeType>)Session["accounts"]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T20:34:11.853

这不是您问题的直接答案，但我想为您节省一些痛苦。

正如 dwerner 所说，**这是 ViewModel 的工作**，而不是 View。

View 应该尽可能不知道它运行的环境。理想情况下，它应该只知道：（1）它强烈绑定到*（通过`@model`声明）*的 ViewModel ，以及（2）你的任何 HTML Helper 函数已经进入应用程序*（基本上这些是关闭的扩展方法`HtmlHelper<Tmodel>`）*

您的 ViewModel 应该包含一个`List<Account>`您填写的内容`ViewBag.accounts`，然后您可以完全忽略 Viewbag。在您的视图中，该集合不属于适当的类型（“Account”），因此您可以直接在循环中与 Account 对象进行交互，而`foreach`无需从.`Object``Dynamics`

拥有“哑”视图和“瘦”控制器可将大部分逻辑保留在 ViewModel 中，这样更清洁且更易于维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T18:42:57.023

使用视图数据

ViewData 是可以使用字符串作为键访问的对象字典。这意味着我们将编写如下代码：

**在控制器中**

```
public ActionResult Index()
{

var softwareDevelopers = new List<string>
{
    "Brendan Enrick", 
    "Kevin Kuebler", 
    "Todd Ropog"
};

ViewData["softwareDevelopers"] = softwareDevelopers;

return View(); 
```

}

**在视图中**

```
<ul>
@foreach (var developer in (List<string>)ViewData["softwareDevelopers"])
{
<li>
    @developer
</li>
 }
</ul> 
```

# html-select - 检查动态创建的下拉框的选定值

> ID：15119582
> 
> 赞同：0
> 
> 时间：2013-02-27T18:32:05.933
> 
> 标签：html-select

我正在动态地将行添加到表中。每行都有输入字段以及下拉字段。当我在下拉列表中选择“其他”时，我想禁用“评论”字段。如何检查动态添加行的下拉框？

以下是我的代码。行插入工作正常，但我不知道如何检查下拉框的选定值。

```
<script language="javascript" type="text/javascript">
function addRow() {
   var tbl = document.getElementById('tblSample');
   var lastRow = tbl.rows.length;   
   var iteration = lastRow;
   var row = tbl.insertRow(lastRow);

   var cellLeft = row.insertCell(0);
   var textNode = document.createTextNode(iteration-3);
   cellLeft.appendChild(textNode);

   var cellRightSel = row.insertCell(1);
   var sel = document.createElement('select');
   sel.name = 'LOCsel' + iteration;
   sel.options[0] = new Option('---Any---', '0');
   sel.options[1] = new Option('Level 0.5: Early Intervention', '1');
   sel.options[2] = new Option('Level I: Outpatient', '2');
   sel.options[3] = new Option('Level I.D: Outpatient-Detox', '3');
   sel.options[4] = new Option('Level II.1: Intensive Outpatient', '4');
   sel.options[5] = new Option('Level II.5: Partial Hospitalization', '5');
   sel.options[6] = new Option('Level II.D: IOP-Detox', '6');
   sel.options[7] = new Option('Level III.1: Halfway House', '7');
   sel.options[8] = new Option('Level III.3: Long-Term Residential Care', '8');
   sel.options[9] = new Option('Level III.5: Therapeutic Community', '9');
   sel.options[10] = new Option('Level III.7: Medically Monitoried Inpatient(ICF)', '10');
   sel.options[11] = new Option('Level III.7.D: Med.Mon.Inpatient(ICF)-Detox', '11');
   sel.options[12] = new Option('Other', '12');
   cellRightSel.appendChild(sel);

   var cellRights = row.insertCell(2);
   var els = document.createElement('input');
   els.type = 'text';
   els.name = 'Comments' + iteration;
   els.id = 'Comments' + iteration;
   els.size = 30;
   cellRights.appendChild(els);

   var cell8 = row.insertCell(9);            
   var element8 = document.createElement('input');            
   element8.type = 'text';            
   element8.name = 'txtRow'+ iteration;
   element8.id = 'txtRow'+ iteration;
   cell8.appendChild(element8);
   element8.size = 20;
   }

function validateLOC(){
   var table = document.getElementById('tblSample');
   var rowCount = table.rows.length;

   for (var i=0; i < rowCount; i++) {
var loc = table.rows[i].cells[1].getElementById('LOCsel')[i];
var strUser = loc.options[loc.selectedIndex].text;      
if (strUser = 'Other'){
   document.getElementById('Comments').disabled = true;
   document.getElementById('Comments').style.backgroundColor = '#cccccc';
   rowCount--;
    i;
}
else {
   document.getElementById('Comments').disabled = false;
   rowCount--;
   i;
}
    return true;
}
 }
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:47:58.033

首先通过添加来给出选择框和id：
sel.id = 'LOCsel' + iteration;

然后为每个选择框添加一个 onclick 事件处理程序：
sel.onclick = function () {
onLOCSelected(iteration);
};

然后添加这个函数：
function onLOCSelected(uniqueID)
{
//使用 uniqueID（你称之为迭代）
//评估所选项目的值并相应地切换评论输入
}

希望有帮助！

# java - RMI 类加载导致将近 2 分钟的等待

> ID：15119583
> 
> 赞同：0
> 
> 时间：2013-02-27T18:32:12.067
> 
> 标签：java, tomcat, jboss, rmi, distributed-computing

我遇到了 RMI 的问题。情况是这样的：我有一个暴露 EJB 对象的 JBOSS 4.2.2 服务器，在不同的服务器中有一个客户端，运行 tomcat，它使用 RMI 调用 JBoss 上的 EJB。当JBoss抛出异常并传播到客户端时，会出现问题，因为部分异常不在tomcat的classpath中，所以会发生RMI异常。我们注意到 RMI 尝试从服务器加载类，但我们没有设置 codebase 参数，所以它失败了。

问题是响应可能需要大约 2 分钟。如果我们使用属性“useCodeBaseOnly=true”启动 tomcat，响应会立即发生，如果我们将缺少的类放在 tomcat 上也会发生同样的情况。如果我在本地测试情况（同一台机器上的 jboss+tomcat），响应不会花费太多时间。如果类不可用，UrlClassLoader 是否有类似 Timeout 的返回？，什么可能导致响应缓慢？

谢谢。

# java - 使用默认值的 Quartz 调度程序调度作业

> ID：15119590
> 
> 赞同：1
> 
> 时间：2013-02-27T18:32:24.223
> 
> 标签：java, spring, quartz-scheduler

我们有一个使用 Spring Framework 在 Tomcat 中运行的 Web 应用程序。我们需要为经常性操作添加一些计划作业。为此，我们遇到了 Quartz Scheduler，并按照[教程使用 Quartz 和 Spring 配置作业](http://dimitrisli.wordpress.com/2010/09/20/spring-quartz-maven-example/)，并按预期安排和运行作业。

所以我们在应用程序启动时安排了一些任务。现在我们希望用户手动运行作业并更改作业的触发器，但我们需要将这些更改持久化到数据库中。因此，当应用程序启动时，它会读取持久化的任务，如果它们不存在，则从 spring 描述符文件中加载默认任务。

为简单起见，假设我们使用的是示例中的 beans.xml 文件：

```
<bean id="processToExecute" class="com.mycompany.ProcessToExecute" />

<bean name="processToExecuteJob" class="org.springframework.scheduling.quartz.JobDetailBean">
    <property name="jobClass" value="com.mycompany.ProcessToExecuteJob" />
    <property name="jobDataAsMap">
        <map>
            <entry key="processToExecute" value-ref="processToExecute" />
        </map>
    </property>
</bean>

<bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
    <property name="jobDetail" ref="processToExecuteJob" />
    <property name="cronExpression" value="0/5 * * * * ?" />
</bean>

<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="jobDetails">
        <list>
            <ref bean="processToExecuteJob" />
        </list>
    </property>
    <property name="triggers">
        <list>
            <ref bean="simpleTrigger" />
        </list>
    </property>
</bean> 
```

因此，我们希望继续对默认任务使用类似 bean 的配置，但如果已经安排好了从数据库加载它们的选项。

这里的 Quartz 不是必需的，如果有人知道使用 Spring 实现它的更简单方法，`@Scheduled`它也可能很有用。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T18:15:55.530

我终于努力获得所需的行为。在第一次运行时，应用程序安排任务并将它们持久化到数据库中。这只需在*SchedulerFactoryBean*对象上指定**dataSource**属性即可。

 *此时，持久化作业是没有用的，因为对计划任务执行的任何更改都会在系统重新启动时丢失，因为新创建的作业会覆盖旧作业。所以行为是完全一样的。

为避免新作业覆盖旧作业，只需在*SchedulerFactoryBean*对象上将**overwriteExistingJobs**属性设置为**false 。**就如此容易。新作业将被忽略，因为它们已存在于数据库中。

 *这是上述配置的完整示例：

```
<!-- Jobs -->
<bean name="processToExecuteJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean"> <!-- JobDetailBean on Quartz 1.X -->
    <property name="jobClass" value="com.mycompany.quartz.ProcessToExecuteJob" />
    <property name="name" value="processToExecuteJob"/>
    <property name="group" value="default"/>
</bean>

<!-- Triggers -->
<bean id="demoTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean"> <!-- CronTriggerBean on Quartz 1.X -->
    <property name="jobDetail" ref="processToExecuteJob" />
    <property name="cronExpression" value="0/15 * * * * ?" />
</bean>

<!-- Database -->
<jee:jndi-lookup id="quartzDataSource" jndi-name="jdbc/imsQuartzDS" resource-ref="true" />

<!-- Scheduler -->
<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="dataSource" ref="quartzDataSource"/>
    <property name="overwriteExistingJobs" value="false"/>
    <property name="triggers">
        <list>
            <ref bean="demoTrigger" />
        </list>
    </property>
</bean> 
```**

# c# - 为什么第一个 linq 的行为比第二个快 20 倍 [获取最大值]

> ID：15119593
> 
> 赞同：2
> 
> 时间：2013-02-27T18:32:29.040
> 
> 标签：c#, .net, vb.net, linq

有人可以解释为什么这些方法之间存在大约 20 倍的巨大差异！？
我的逻辑可以接受 2 次和 4 次之间的差异，但我不明白为什么会发生 20 次。

代码 ：

```
//Method 1 which took 00:00:00.82
DateTime at = DateTime.Now;
for (int i = 0; i < 1000; i++ ) {
    var x = (from m in brd.MohreHa select new { m, am = m.GetPossibleMoves().Count() }).OrderByDescending(o => o.am).First().m;

}
var att = DateTime.Now - at;

//Method 2 which took 00:00:15.31
DateTime bt = DateTime.Now;
for (int i = 0; i < 1000; i++) {
    var y = brd.MohreHa.First(m => m.GetPossibleMoves().Count() == brd.MohreHa.Max(a => a.GetPossibleMoves().Count()));
}
        var btt = DateTime.Now - bt; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T18:34:31.383

第二个必须为您的集合中`Max()`的*每一项*计算。这有效地使`brd.MohreHa.First`调用二次，因为它将为每个项目检查每个项目一次。

第一个选项`Count()`每次只进行调用，然后在最后进行一次排序。这避免了枚举`Max()`N 次的需要。

# sql - 返回每天最大值的代码

> ID：15119598
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:32:38.293
> 
> 标签：sql, sql-server-2012, max

对于每个日期，我需要返回具有最大值的代码，例如这是数据表：

```
dt_date 股票价格  
20121201一5   
20121201乙7  
20121201 C 6  
20121202一10  
20121202乙8  
20121202 C 7
```

所以我的预期输出是

```
20121201 C 7  
20121202一10
```

我已经尝试了一些最大的东西，但没有真正到达任何地方，有人可以帮忙吗？我正在使用 SQL Server 2012 顺便说一句。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:09:45.237

您应该能够使用子查询：

```
select t1.dt_date,
  t1.ticker,
  t1.price
from yourtable t1
inner join
(
  select max(price) maxPrice, dt_date
  from yourtable
  group by dt_date
) t2
  on t1.dt_date = t2.dt_date
  and t1.price = t2.maxprice 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!6/f5f47/1)

或者您可以使用`row_number()`：

```
select dt_date, ticker, price
from
(
  select dt_date, ticker, price,
    row_number() over(partition by dt_date order by price desc) rn
  from yourtable
) src
where rn = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!6/f5f47/3)

注意：这将返回按日期的最高价格以及`ticker`与该价格相关联的价格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:10:11.727

这对你来说应该没问题！

```
Select dt_date,ticker,price from table t
 where t.price = 
     (select ticker,price from table t2 where t.dt_date=t2.dt_date group by ticker having max(price))
 group by dt_date 
```

戴维德

# math - 递归关系：求解 T(n-1) 的 BigO

> ID：15119602
> 
> 赞同：1
> 
> 时间：2013-02-27T18:32:47.833
> 
> 标签：math, big-o, recurrence

我正在为 Big O 解决一些递归关系问题。

```
T(n) = T(n-1) 
```

我开始：

```
T(n)   = T(n-1)
T(n-1) = T(n-2)
..
T(n) = T(n-k) 
```

现在将 k 设置为 n-1

```
T(n) = T(1) 
```

所以结果是

```
T(n) = O(1) 
```

我不完全确定这是否正确，但我不确定这是否如此简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:45:41.393

只要你有一个基本案例，是的，这是正确的。

我假设复发被定义为

> T(0) = k（对于某个常数 k），并且
> 
> T(n+1) = T(n)

然后你可以通过归纳证明所有自然数 n 的 T(n) = k。

*   **基本情况**：如果 n = 0，则 T(n) = T(0) = k，根据需要。
*   **归纳步骤：**假设 T(n) = k。然后根据需要，T(n + 1) = T(n) = k。

因此，T(n) = k = O(1)。

希望这可以帮助！

# android - 从 Android Activity 创建一个按钮并正确定位它

> ID：15119603
> 
> 赞同：0
> 
> 时间：2013-02-27T18:32:48.493
> 
> 标签：android, layout, button, android-activity

我正在开发的应用程序要求我根据用户指定的配置文件显示按钮。因此，我无法使用 layout.xml 来指定按钮的放置位置，并且必须从我的 Activity 中创建和定位按钮。我希望我的应用也支持 Android 2.3，这排除了.setLeft() 和 .setTop() 方法。

尽我所能告诉我必须使用 LayoutParams 定位所有按钮，但我没有看到任何定位按钮的方法，只能调整它们的大小。

任何关于实现这一点的最佳方法的指针都会很棒。

编辑：建议使用网格布局，但直到 API 14 才引入，所以也不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T11:42:39.710

对于RelativeLayout，setMargin(x,x,x,x) 代替setLeft setTop 怎么样

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:39:39.717

这取决于您使用的布局类型。例如，如果您使用`RelativeLayout`，则需要使用[RelativeLayout.LayoutParams](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html)指定对齐规则。对于 a`LinearLayout`或`GridLayout`任何其他布局类型也是如此。

# c# - 从数据库中检索属性的简单类型的创建模式？

> ID：15119604
> 
> 赞同：1
> 
> 时间：2013-02-27T18:32:49.183
> 
> 标签：c#, design-patterns, n-tier-architecture

# 背景

根据我自己的理解，我正在尝试为一个简单的场景创建一个分层架构。我有一个简单的域类 Car。  

```
public class Car {

  public string Make;
  public string Model;
  public int Year;

  public Accelerate() { }
  public Decelerate() { }
} 
```

我想创建一个 Car 的新实例，从数据库中填充其值。  **这就是我卡住的地方。**

我*认为*在 Persistence 层（称为 CarRepository）中应该有另一个类，它将完成从基于 CarID 的数据库中检索这些值的繁琐工作。

我希望在运行时将这个 CarRepository 依赖注入到 Car 域类中，以允许不同的实现（例如用于单元测试的假货）。 

因此，我考虑将其添加到 Car 类中：

```
public class Car() {

  private ICarRespository _carRepository;

  public Car(ICarRepository carRepository) {
    _carRespository = carRepository;
  }

  public void Find(int carId) {
    var car = _carRepository.FindById(carId);
    this.Make = car.Make;
    this.Model = car.Model;
    // etc.
  }

  // other properties and methods here
} 
```

我会将 ICarRepository 定义为：

```
public interface ICarRepository {
  DtoCar FindById(int carId);
}

public class DtoCar {
  public string Make;
  public string Model;
  public int Year;
} 
```

假设我正在使用“穷人的依赖注入”并允许聚合根根据项目类型（生产代码与单元测试）传递正确的具体 CarRespository。显然我在这里选择使用构造函数注入。

# 问题

(1) 这个解决方案感觉不对。当我创建一辆新车时，我觉得它应该在此时初始化并填充其所有属性。但是，只有在我调用 Find() 方法之后，它才能真正成为一辆有效的汽车。如果我没有将有效的 CarID 传递给 Find，会发生什么？那么 Car 对象永远不会是一个有效的对象！这不应该打扰我吗？有没有更好的办法？

(2) 我正在使用构造函数注入来传递存储库依赖项……我也可以传递 CarID 以在构造函数中找到此处……然后我可以消除 Find() 方法吗？所以：

```
public Car(ICarRepository carRepository, int carId) {
  _carRespository = carRepository;
  var car = _carRepository.FindById(carId);

  this.Make = car.Make;
  this.Model = car.Model;
  // etc.
} 
```

...我从来没有见过这样的做法，所以我很犹豫要不要使用它。这样做可以吗？

（3）我在这里缺少一些创造模式吗？这是一个简单的场景……我不相信像 Factory、Singleton 或 Prototype 这样的东西在这里适用（我可能弄错了）。那些感觉沉重和专业。这个场景——来自数据库的一个简单的域对象——看起来很基本，必须有*一些*指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:47:38.397

您的问题是您没有遵循[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。您应该将汽车的创建工作交给专门从事此工作的服务。

```
class CarService
{
    CarService(ICarRepository carRepo)
    { 
        _carRepo = carRepo;
    }

    Car GetById(int id)
    {
        var carDTO = _carRepo.GetById(id);       
        var car = Mapper.Map<CarDTO, Car>(carDTO);
        return car;
    }
} 
```

*这里是[AutoMapper的链接](https://github.com/AutoMapper/AutoMapper)

**您甚至不需要`CarDTO`，但是如果需要，它会添加一个抽象层。

这将像一个工厂，但实施更有意义，并不像你担心的那样沉重。代码将更像这样：

```
var car = carService.GetById(id); 
```

我相信这应该可以解决你所有的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:57:24.403

类的设计`Car`违反了[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)：它是一个领域实体，它包含数据持久性逻辑。

所以，让我们`Car`只是一个域实体（`ID`已引入属性）：

```
public class Car
{
    public Car(int id, string make, string model, int year)
    {
        ID = id;
        Make = make;
        Model = model;
        Year = year;
    }

    public int ID { get; private set; }
    public string Make { get; private set; }
    public string Model { get; private set; }
    public int Year { get; private set; }

    public void Accelerate() { }
    public void Decelerate() { }
} 
```

存储库接口不得返回数据传输对象：

```
public interface ICarRepository
{
    Car FindById(int carId); // No DTO here - DTO is the detail of implementation
} 
```

然后，只需设计 Car*服务*的接口即可。服务层暴露**业务逻辑**。在这个简单的例子中，服务层没有增加任何价值：

```
public interface ICarService
{
    Car FindById(int carId);
}

public class CarService : ICarService
{
    private readonly ICarRepository _repository;

    public CarService(ICarRepository repository)
    {
        _repository = repository;
    }

    #region Implementation of ICarService

    public Car FindById(int carId)
    {
        var car = _repository.FindById(carId);
        // The additional business logic (if required) could be added here.
        return car;
    }

    #endregion
} 
```

存储库的实际实现将`Car`使用其构造函数创建。

# asp.net-mvc - 使用 Telerik ASP.NET MVC 上传组件时，文件输入不适用于 AJAX 表单

> ID：15119606
> 
> 赞同：0
> 
> 时间：2013-02-27T18:32:54.457
> 
> 标签：asp.net-mvc, file-upload, telerik, asp.net-ajax

我有一个带有文件输入的表单，可以很好地处理 HTML 表单。当我提交表单时，我可以在文件输入中获取我的值；但是当使用 AJAX 时，文件输入字段始终为空。

**这行得通**

```
@using (Html.BeginForm("ProcessSubmit", "Upload",
                     FormMethod.Post, new { id = "uploadForm", enctype =   "multipart/form-data" })) { 
    @(Html.Telerik().Upload().Name("attachments"))
    <p class="note">
    Maximum combined file size: 10 MB
   </p>
   <div style="margin: 20px 0 0 0;">
       <input type="submit" value="Send" class="t-button" />
       <input type="reset" value="Reset" class="t-button" />
   </div>
}    

and the controller: 
[HttpPost]
    public ActionResult ProcessSubmit(IEnumerable<HttpPostedFileBase> attachments)
    {
        if (attachments != null)
        {
            return Content("is not null");
        }
        return Content("null");
    } 
```

**但这不起作用**

```
@using (Ajax.BeginForm("ProcessSubmit", "Upload",
                     new AjaxOptions { UpdateTargetId = "mydiv" })) { 
     <div id="mydiv"></div>
    @(Html.Telerik().Upload().Name("attachments"))
    <p class="note">
    Maximum combined file size: 10 MB
   </p>
   <div style="margin: 20px 0 0 0;">
       <input type="submit" value="Send" class="t-button" />
       <input type="reset" value="Reset" class="t-button" />
   </div>
} 
```

在前者中，控制器总是返回“不为空”，而在后者中，它总是返回空值。:(

请问这是怎么回事？

# c# - 知道在单独的页面上检查了哪些复选框

> ID：15119607
> 
> 赞同：3
> 
> 时间：2013-02-27T18:33:01.300
> 
> 标签：c#, asp.net, .net, vb.net

我是一个完整的 ASP 新手，致力于通过 WinForms 应用程序进行转换。

在我的 Winforms 版本中，我有一个主窗体，它从用户那里获取输入并有一个按钮`Select OutPut Columns`。

当用户单击该按钮时，会弹出第二个表单，其中包含一个复选框列表，该列表根据用户在其输出报告中可用的所有列的 DB 查询动态填充。

一旦用户在他们的报告中检查了他们想要的所有列，他们单击一个`Done`按钮，该按钮在主窗体上设置一个`List(of String)`属性并选择列，因此程序可以继续生成报告。

我正在尝试在我的 ASP 项目中模拟同样的功能 - 根据我所读到的内容，似乎`Session`or`Cache`对象是解决这个问题的方法 - 我的问题是：

1.  这些是获取/存储这些数据的正确方法吗？
2.  鉴于以下情况，我应该使用哪一个（会话/缓存）：

    (a) 用户可以再次单击该按钮，我希望程序记住他们已经选择了哪些列。

    (b) 不同的用户可能会选择不同的列（由于这个原因，似乎 Cache 在这里可能无法正常工作 - 我说得对吗？）

3.  只要应用程序在用户的机器上运行，我希望变量持续存在，但是如果用户关闭/重新打开应用程序，我希望它不要记住他们以前的选择。

真的，正如我所说，我是一个完整的 ASP 新手，并且愿意学习任何新的/有帮助的东西 - 任何好的想法/评论/链接都将是 !!GREATLY!! 赞赏！

谢谢！！

## 编辑：

作为一个额外的问题，如果使用 Session / Cache，在应用程序启动时删除这些变量以确保新数据是司空见惯的，还是通常不这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:37:36.100

您想使用该`Session`对象。每个用户都不同，它会在一段时间没有看到用户后过期（实际过期时间和行为是可配置的）。会话作为 cookie 标识符存储在用户的网络浏览器中。如果用户关闭浏览器，cookie 将被删除，他们将在下次连接到 Web 服务器时获得一个新会话。旧会话最终将超时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:45:40.850

> 在我的 Winforms 版本中，我有一个主窗体，它从用户那里获取输入，并有一个按钮 Select OutPut Columns。
> 
> 当用户单击该按钮时，会弹出第二个表单，其中包含一个复选框列表，该列表根据用户在其输出报告中可用的所有列的 DB 查询动态填充。

这是windorms上的方式，现在如果你制作一个Web界面最好像网页一样工作，最简单的方式¹ - 那是什么？避免弹出窗口，并使用发布到下一页（或同一页）。

所以你有一个页面，用户选择一些东西，在服务器上发布，在同一页面上创建复选框并等待第二个用户输入。在最终输入之后，再次发布到同一页面，**现在您在页面中拥有所有用户输入以进行输出**。

没有对话框，没有其他记忆，帖子在同一页面上完成，帖子保留用户输入。

¹ [（开始时不是 jQuery 对话框和 ajax 调用）]

# php - 如何在joomla的左浮动中添加它

> ID：15119609
> 
> 赞同：0
> 
> 时间：2013-02-27T18:33:09.787
> 
> 标签：php, html, css, joomla, addthis

我的网站是[http://www.philipgunwhy.com](http://www.philipgunwhy.com)。

我想添加这个按钮，如[http://www.socialmediaexaminer.com/top-10-social-media-blogs-the-2012-winners/](http://www.socialmediaexaminer.com/top-10-social-media-blogs-the-2012-winners/)在 joomla 的左侧浮动。但目前我无法通过将 addthis 模块添加到我的 joomla 网站来做到这一点。

任何想法？谢谢

# git - Git - 如何返回最后一次提交并删除所有未提交的文件？

> ID：15119610
> 
> 赞同：3
> 
> 时间：2013-02-27T18:33:10.670
> 
> 标签：git

我需要返回到上次提交状态。我已经完成了 Git Reset Hard，但是当我对代码进行新的更改并尝试提交时，我看到我不想在 repo 中拥有的所有文件都在那里。

如何进行重置以删除未提交的文件？

此致，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:35:06.117

`git reset --hard` will put you back to the last commit, losing any changes you have made to files that have already been committed.

`git clean -xdf` will then remove any files and directories that you have created but have not yet committed to git.

Running both of these should put you back into a clean state.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:39:23.180

`git checkout -- .`（命令末尾有一个点）将恢复工作目录中的所有更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T02:22:15.097

好的，你有：

*   `git clean -x`：删除不受版本控制的文件，包括被忽略的文件
*   `git reset --hard`：转到提到的提交，检查文件，就像它们记录在其中一样

两者都使用应该会给你想要的东西，如果没有，那就是一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T06:58:03.963

如果要删除未被跟踪的文件，请尝试以下操作：

```
git add .
git reset --hard 
```

我认为有一个更合适的方法，但现在想不出。如果我会发布它。

# c# - 计算素数的最快方法

> ID：15119611
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:33:11.083
> 
> 标签：c#, performance, primes

我正在尝试在我的程序中实现素数类型。在 Mersenne 的指数类型之一中，计算公式为`(2 power P) -1`Here`P is Prime.`并检查输出是否为素数。

在计算中，我能够获得力量，但在检查素数时，过程是 Hanging 。如果我离开它很长时间，那么它正在被计算。

例如， (2 power 10090) -1 并计算这是否是素数

我正在使用大整数

我正在使用这段代码

```
int prime1 = CalculatePrime(n);
BigInteger powerPrime = BigInteger.Pow(2, prime1);
bool isPrime = CheckPrime(powerPrime - 1);

private bool CheckPrime(BigInteger num)
{
    if (num == 0 || num == 1) 
        return false;

    bool isPrime = true;
    for (int j = 2; j < num; j++)
    {
        if ((num % j) == 0)
        {
            isPrime = false;
            break;
        }
    }
    return isPrime;
} 
```

这是怎么回事 - [http://www.dotnetperls.com/prime](http://www.dotnetperls.com/prime)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:37:51.487

[埃拉托色尼筛法](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)是一种特别好的算法，用于生成少于几百万的素数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:46:08.727

[Lucas-Lehmer 检验](http://en.wikipedia.org/wiki/Lucas%E2%80%93Lehmer_primality_test)专门用于检查梅森数是否为素数。你应该优先使用它而不是你已经实现的测试，你注意到它可能非常慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:40:24.403

由于以下原因，您可以少做一些工作：

1.  你只需要检查`j < sqrt(num)`，而不是`j < num`
2.  您不必检查每个偶数：只需在开头尝试 2 然后只检查奇数（这是因为每个偶数都可以被 2 整除，所以如果 x 不能被 2 整除，它就不能被任何其他偶数）

# string - Bash变量连接在循环内失败

> ID：15119616
> 
> 赞同：1
> 
> 时间：2013-02-27T18:33:24.883
> 
> 标签：string, bash, variables, concatenation

鉴于以下陈述：

```
ac_reg_ids="-1" #Starting value
(mysql) | while read ac_reg_id; do
    echo "$ac_reg_id" #variable is a result of a mysql query. Echoes a number.
    ac_reg_ids="$ac_reg_ids, $ac_reg_id" #concatenate a comma and $ac_reg_id, fails.
done
echo "ac_reg_ids: $ac_reg_ids" #echoes -1 
```

现在根据这个答案：[https ://stackoverflow.com/a/4181721/1313143](https://stackoverflow.com/a/4181721/1313143)

串联应该起作用。但是，为什么不呢？循环内有什么不同？

以防万一它可能很重要：

> > bash
> -版本 > GNU bash，版本 4.2.8(1)-release (i686-pc-linux-gnu)

## 更新

使用 set -eux 输出：

```
+ echo 142
142
+ ac_reg_ids='-1, 142'
+ read ac_reg_id 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:56:52.157

就像[shellcheck](http://www.shellcheck.net)有用地指出的那样，您正在修改子外壳中的 ac_reg_ids 。

重写它以避免子shell：

```
ac_reg_ids="-1" #Starting value
while read ac_reg_id; do
    echo "$ac_reg_id" 
    ac_reg_ids="$ac_reg_ids, $ac_reg_id"
done < <( mysql whatever )  # Redirect from process substution, avoiding pipeline
echo "ac_reg_ids: $ac_reg_ids" 
```

# perl - Perl 语句末尾的 @array 是什么意思？

> ID：15119617
> 
> 赞同：1
> 
> 时间：2013-02-27T18:33:25.407
> 
> 标签：perl

我在 Stack Overflow 中看到了这段代码，它对我有用。请解释一下。

```
my @amino_acids = $genetic_codes[8] =~ /[ACGT]/g;
join ',', map qq{"$_"}, @amino_acids;
$codons{$_}++ for @amino_acids; 
```

这段代码的目的是什么`for`，我尝试查看 perldocs 但无法清楚地了解它。还有什么可以代替的`for`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:35:35.627

它增加`%codons`特定氨基酸在 中出现的次数的值`$genetic_codes[8]`。

手写出来，最后一行相当于

```
for my $acid (@amino_acids) {
    $codons{$acid}++;
} 
```

就语法类别而言，`for`在这种情况下是语句修饰符，[记录在 perlsyn 中](http://perldoc.perl.org/perlsyn.html#Statement-Modifiers)。

> 任何简单的语句都可以选择后跟一个*修饰符*，就在终止分号（或块结尾）之前。可能的修饰符是：
> 
> ```
> if EXPR
> unless EXPR
> while EXPR
> until EXPR
> for LIST
> foreach LIST
> when EXPR 
> ```
> 
> ...
> 
> 修饰符是一个迭代器：它为 LIST 中的每个项目执行一次语句（依次为每个项目`for(each)`加上别名）。`$_`
> 
> ```
> print "Hello $_!\n" for qw(world Dolly nurse); 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:37:15.173

在 Perl 中

```
foo for bar; 
```

是一种简短的写法：

```
for bar { foo; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:39:45.083

`for`并且`foreach`是相同的。在传统的 C 风格的 for 循环中，可以这样写：

```
for (my $i = 0; $i <= $#amino_acids; $i++) {
    $codons{ $amino_acids[$i] }++;
} 
```

这是一种有效地写同一件事的惯用方式。

而不是使用循环迭代器 ($i)，您只是使用其中的值`@amino_acids`作为循环值。

# node.js - 节点 gyp 和绑定，gyp 不是 default_configuration

> ID：15119622
> 
> 赞同：0
> 
> 时间：2013-02-27T18:33:49.793
> 
> 标签：node.js, node-gyp

我正在尝试将模块编译为默认发布，我在 buinding.gyp 设置

```
 'target_defaults': {
    'default_configuration': 'Release'
   }, 
```

但我总是得到 BuildType="Debug"

```
gyp info it worked if it ends with ok
gyp info using node-gyp@0.8.4
gyp info using node@0.8.12 | linux | x64
gyp info spawn make
gyp info spawn args [ 'BUILDTYPE=Debug', '-C', 'build' ]
make: Entering directory `/home/ammarch/colaboration/node-webworker-threads/build'
make: Nothing to be done for `all'.
make: Leaving directory `/home/ammarch/colaboration/node-webworker-threads/build'
gyp info ok 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:21:46.600

检查 package.json `scripts`：

如果你`--debug`在那里，无论如何这将强制进行调试构建。

```
"scripts": {
  "install": "node-gyp --debug rebuild",
  "test": "mocha tests"
}, 
```

删除`--debug`应该修复它。

# php - 如何通过我的网站将 kml 放入谷歌地图或发送 js 命令？

> ID：15119625
> 
> 赞同：0
> 
> 时间：2013-02-27T18:33:51.473
> 
> 标签：php, javascript, google-maps

我的网站上有关于加油站的数据，包括汽油质量的测量和这些加油站的 gps 位置。

我的想法是在我的网站中使用谷歌地图，就像 flightradar24.com 一样，带有指向这些加油站地址的图钉。当点击每一个时，会出现一个气球，其中包含有关汽油和柴油质量的信息。

其他选项是单击图钉时，转到没有地图的另一个页面，显示更详细的信息。

我们可以用 kml 或 javascript 命令来做，但是怎么做呢？Kml 是由我的服务器的 php 调用插入的，还是由 js 插入的？

如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T16:46:22.050

另一个对编码非常简单的选择是使用 Google Fusion Tables。有关基础知识，请参见[此处](http://support.google.com/fusiontables/answer/184641?hl=en&ref_topic=1652595)。本质上，您在 Google Drive 中使用加油站的纬度/经度制作一个 Fusion Table（如电子表格），然后发送一个简单的 Javascript 调用来获取它并将其显示在您的页面上。信息窗口和点的所有样式都可以在 Fusion Table 页面上完成，无需任何代码。

很难用 Fusion Tables 模拟 flightradar24 网站，但从你的帖子来看，我认为你需要的不仅仅是 Fusion Tables 所能提供的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:49:59.477

假设您使用的是最新版本的 Google Maps API，有几种方法可以做到这一点。您可以
a) 构建一个包含您需要的点和/或形状的 kml 文件并将其显示在地图上
b) 遍历您的位置列表（加油站）并使用标记管理器向地图添加单个图钉。

任何一种解决方案都可以很好地工作，这实际上取决于您喜欢做什么。我会说使用选项 B 可能更容易，只需从服务器获取 JSON 格式的位置数组，然后使用标记管理器在地图上显示它们。然后，您可以在单击标记时显示其他标记或重定向。

您的 JSON 数组可能很简单：

```
[
{title:'Station A', latitude: 38.91912, longitude: 7.123121},
{title:'Station B', latitude: 34.81291, longitude: 30.87173},
{title:'Station C', latitude: 31.00123, longitude: 13.184918}
] 
```

这是 MarkerManager 脚本根的链接 ( [http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markermanager/](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markermanager/) )。查看示例文件夹以获取一些快速示例。docs 文件夹有一些详细信息，但目前这些页面似乎无法正确呈现给我。

要使用地图 API 显示 KML 图层，您需要您的目标 KML 图层可以被 google 的服务器访问（即托管在公共服务器上）。在那之后，这段代码应该让你进入球场：

```
var map; // Reference to your map object you created with 'new google.maps.Map()'  
var url = http://url.to/your.kml;
var kml = new google.maps.KmlLayer(url);
kml.setMap(map); 
```

要删除图层，只需使用以下代码（假设 kml 变量是对您在上面创建的 KmlLayer 的引用）：

```
kml.setMap(null); 
```

以下是 Google Maps API 文档中 KmlLayer 类的链接：[https ://developers.google.com/maps/documentation/javascript/reference?hl=fr#KmlLayer](https://developers.google.com/maps/documentation/javascript/reference?hl=fr#KmlLayer)

# php - 使用 .htacces 重定向到使用 CodeIgniter 的控制器

> ID：15119626
> 
> 赞同：0
> 
> 时间：2013-02-27T18:33:57.567
> 
> 标签：php, .htaccess, codeigniter

我想将我的`example.com`网页重定向到`example.com/controller`

我该怎么做`.htaccess`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:01:49.777

干得好

重写规则：

```
RewriteEngine On
RewriteRule ^controller$ / [L] 
```

# iphone - 导出 CoreData 的快速且轻松的方法是什么？

> ID：15119627
> 
> 赞同：1
> 
> 时间：2013-02-27T18:33:59.043
> 
> 标签：iphone, objective-c, database, core-data, export

我有一个应用程序，其中包含在 Core Data 中构建的各种实体，这很棒，但我想提取这些数据以便我可以构建一个数据库（用于研究目的）。

从 iPhone 导出 CoreData 实体的快速而轻松的方法是什么？

我一直在四处寻找，似乎有很多建议，一切看起来都很混乱。我开始手动编写代码以将其导出为 CSV，但这需要做很多工作，如果我更改我的数据库，我需要更改 CSV 导出器以匹配。

必须有一个非常简单的方法来做到这一点，不是吗？

你能把 SQLite 文件导入别的东西吗？Apple 不提供任何 API 来导出 CoreData 吗？

编辑：不需要像导出到 Web 服务这样的花哨的东西。我只想导出数据，这样我就可以在桌面上管理它，也许在 Access、Excel 等类似的东西中。这不会是一个疯狂的数据量，这主要是一个临时解决方案。

EDIT2：找到这个程序： http: [//sourceforge.net/projects/sqlitebrowser/](http://sourceforge.net/projects/sqlitebrowser/) 这几乎是你需要的一切。包括 CSV 导出。

谢谢大家的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:48:18.983

不，Apple 不提供任何专门用于导出数据的 API。您可以使用现有的 API，但您必须自己完成所有工作来导出关系和格式化数据。

如果您想要一个快速而肮脏的解决方案，只需复制数据库文件并使用`sqlite3`Mac 上的命令来提取数据。假设数据库文件名为`store.db`. 您可以使用以下命令查看其架构：

```
sqlite3 store.db .schema 
```

您应该会发现很容易找出哪些表对应于哪些实体和关系。例如，我有一个名为`LibraryEntry`. 它由下表表示：

```
CREATE TABLE ZLIBRARYENTRY ( Z_PK INTEGER PRIMARY KEY, Z_ENT INTEGER, Z_OPT INTEGER, ZGRIDHEIGHT INTEGER, ZGRIDWIDTH INTEGER, ZDYNAMICDATARELATION INTEGER, ZORIGINALDATARELATION INTEGER, ZTHUMBNAILDATARELATION INTEGER, ZDATE TIMESTAMP, ZAUTHOR VARCHAR, ZSIGNATURE VARCHAR, ZTITLE VARCHAR ); 
```

开头的列`Z_`是 Core Data 的内部元数据。其中，您可能只关心`Z_PK`. 其他列（以下划线开头`Z`但没有下划线）是`LibraryEntry`.

要以 CSV 格式转储表，请使用如下命令：

```
sqlite3 -csv store.db 'select * from zentity' > entity.csv 
```

如果您想要标题行，请使用`-header`标志，如下所示：

```
sqlite3 -header -csv store.db 'select * from zentity' > entity.csv 
```

# apache - 来自已加载网站的反向代理请求未被代理

> ID：15119636
> 
> 赞同：0
> 
> 时间：2013-02-27T18:34:31.547
> 
> 标签：apache, reverse-proxy

我有一个像这样设置的反向代理。

[http://example.com/3rdpartywebsite/](http://example.com/3rdpartywebsite/) -> [http://internal.addr/3rdpartywebsite/](http://internal.addr/3rdpartywebsite/)

因此，对 example.com 的请求被反向代理到内部网络上的网站。

问题是 3rdparty 网站是 jquery，一旦加载到浏览器中，它就会向主机运行请求。这些请求（来自加载的应用程序）没有被重定向到[http://example.com/3rdpartyProxy/](http://example.com/3rdpartyProxy/)他们而是去[http://example.com/](http://example.com/)

这似乎与标准 getHttpObject() 返回的内容有关。它不知道 url 的“3rdpartyProxy”部分，只返回[http://example.com/](http://example.com/)

以下是我的 apache 反向代理配置的内容：

```
ProxyRequests Off
ProxyPreserveHost On
<Proxy *>
        Order allow,deny
        Allow from all
</Proxy>
ProxyPass /3rdpartywebsite/ http://internal.addr/
ProxyPassReverse /3rdpartywebsite/ http://internal.addr/ 
```

任何帮助将不胜感激，我什至不确定从哪里开始寻找这里。是反向代理的问题，还是我应该查看网站本身的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T12:41:32.200

我会回答我自己的问题！耶。

我最终得到这个工作的方式是使用以下站点配置。我使用反向代理，然后重写。在我的例子中，重写很简单，只需重写一次对 3rd 方服务的 cgi-bin 调用即可处理。

3rd 方服务工作的正确方式是使用相对路径，但由于使用了绝对路径，我被迫采用此解决方案。

需要注意的是，如果重写引擎在反向代理之前生效，这将不起作用。你最终会得到一个死链接。

虚拟主机配置：

```
<VirtualHost *:80>
    ServerAdmin     webmaster@host.net<br>
    ServerName      host.net
    ServerAlias     www.host.net
    DocumentRoot    /var/www/
    DirectoryIndex  index.php index.html

    ProxyRequests Off
    ProxyPreserveHost On
    <Proxy *>
            Order allow,deny
            Allow from all
    </Proxy>
    ProxyPass /3rdPartyWebsite/ http://192.168.0.1/
    ProxyPassReverse /3rdPartyWebsite/ http://192.168.0.1/

    #RewriteLog /home/rfmondial/rewrite.log
    #RewriteLogLevel 9

    <FilesMatch \.php$>
            SetHandler application/x-httpd-php
    </FilesMatch>

    <Directory />
            AllowOverride none
            order deny,allow
            allow from all
    </Directory>

    <Directory /var/www>
            Options FollowSymLinks
            allow from all

            RewriteEngine On
            #http://host/ --> http://domain/3rdPartyWebsite/ (default ROOT in Tomcat) a
            RewriteCond !%{REQUEST_URI} !nt-gui/
            RewriteRule ^(cgi-bin.*)$ 3rdPartyWebsite/$1 [L]
    </Directory>
</VirtualHost> 
```

# c++ - how to link winsock in cmake?

> ID：15119639
> 
> 赞同：20
> 
> 时间：2013-02-27T18:34:39.260
> 
> 标签：c++, cmake, winsock

I found only this strings

```
 find_library(WSOCK32_LIBRARY wsock32)
    find_library(WS2_32_LIBRARY ws2_32) 
```

(i'm begginer in cmake) how to link winsock2 (winsock?) in cmake?

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-27T23:17:03.297

由于它们都是 Windows SDK 的一部分，因此您不需要搜索它们。假设您安装了 SDK，您可以执行以下操作：

```
add_executable(MyExe main.cpp)
if(WIN32)
  target_link_libraries(MyExe wsock32 ws2_32)
endif() 
```

# gwt - GWT result.getSessionId() explanation

> ID：15119642
> 
> 赞同：1
> 
> 时间：2013-02-27T18:34:53.383
> 
> 标签：gwt, sessionid

I have no experience with session handling, and probably I'm just having a trouble getting the idea, but there is absolutely nowhere where the sessionId problem is explained.

First, I read [this Google article](https://code.google.com/p/google-web-toolkit-incubator/wiki/LoginSecurityFAQ) and there is this statement:

```
String sessionID = /*(**Get sessionID from server's response to your
        login request.**)*/;" 
```

So I started reading more, and I found [this tutorial](http://varuntayur.wordpress.com/2012/01/25/session-management-in-gwt/) - very helpful one, but it contains this line:

```
String sessionID = result.getSessionId(); 
```

and I do not simply know what to do with it! I have no such method defined in my User object (which is a result from a server response here). I can create it, but I don't know what to write in it. How can I do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:05:35.237

在本教程中，UserDTO 只是将 sessionID 存储在来自 GXT 的 BaseModelData 的地图中。

您可以在以下位置查看此对象的代码：[https ://code.google.com/p/yfs-health/source/browse/trunk/yfs/src/com/varun/yfs/dto/UserDTO.java](https://code.google.com/p/yfs-health/source/browse/trunk/yfs/src/com/varun/yfs/dto/UserDTO.java)

基本上，在本教程中 LoginServiceImpl 的第 8 行登录期间，UserDTO 对象会填充来自 HttpThreadLocalRequest 的这些数据。

[您实际上可以在这里](https://code.google.com/p/yfs-health/source/browse/trunk/yfs/src/com/varun/yfs/server/login/LoginServiceImpl.java)看到它，会话 id 是通过分析 servlet 实现中的请求来设置的： `user.setSessionId(this.getThreadLocalRequest().getSession().getId());`

# python - How to correctly shut down Python RQ worker processes dynamically?

> ID：15119646
> 
> 赞同：10
> 
> 时间：2013-02-27T18:35:00.353
> 
> 标签：python, asynchronous, process, signals

Using [Python RQ](http://python-rq.org/), we are trying to dynamically manage worker processes. We use a custom-built worker script, which (in simplified form) is as follows:

```
from rq import Connection, Worker

queues_to_listen_on = get_queues_to_listen_on()

with Connection(connection = get_worker_connection()):
    w = Worker(queues_to_listen_on)
    w.work() 
```

We are particularly interested in the shutdown of workers. The main concern we have is how to do a graceful shutdown of a worker, in a way that will enable current work to be finished before shutting down. The `request_stop(...)` signal handler on the appropriate `Worker` object seems to do what we need, but there seems to be no way (at least to my knowledge) of emitting it unless it is through pressing `CTRL+C` on the worker process running in the terminal.

As I see it, there are two probable solutions (there could definitely be more) - in order of preference:

1.  Programmatically, using the `rq` library, send the signal to `request_stop` and thus trigger graceful shutdown.
2.  Somehow acquire the pid of the correct process (not sure if the workhorse process or the worker listener process) and using some other method, send the appropriate signal to that process. We have some ways this could be done, but it would very probably require more work and introduce other variables to the problem that I would prefer be left out (for example, using `Fabric` to run a remote command or something along those lines).

If there is a better way to solve this problem or a different alternative that would achieve the same goal, I would appreciate your suggestions.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T15:09:06.540

Option 1 is definitely better in terms of design.

However to solve your particular issue of having to use `CTRL + C` to exit the process (I hate that too), you can use the following strategy for your workers:

```
# WORKER_NAME.py
import os

PID = os.getpid()

@atexit.register
def clean_shut():
    print "Clean shut performed"

    try:
        os.unlink("WORKER_NAME.%d" % PID)
    except:
        pass

# Worker main
def main():
    f = open("WORKER_NAME.%d" % PID, "w")
    f.write("Delete this to end WORKER_NAME gracefully")
    f.close()

    while os.path.exists("WORKER_NAME.%d" % PID):
        # Worker working 
```

And in your master script, get the worker PID as @Borys suggested, send warm stop request, and `os.unlink("path/to/WORKER_NAME.%d" % worker_PID)` to secure the graceful shutdown :)

This would only apply to workers running indefinite loop though. If the worker process calls things that block even the plain sequential one-time job, you have to trace further to the possibly blocking routine to resolve from there, such as apply some sort of time-out strategy.

# codeigniter - Trash Queue, Delete and Re-add

> ID：15119651
> 
> 赞同：0
> 
> 时间：2013-02-27T18:35:15.987
> 
> 标签：codeigniter, codeigniter-2, recycle-bin

I'm in the middle of building CMS/CRM for my company using CodeIgniter and I need a way to add deleted items to a trash queue.

So how would you approach the problem of removing a record on delete and placing it in another table? I would also require a way to re-instate the record from the trash queue.

Any thoughts on this would be very much welcomed. Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:37:00.353

I would just use a column on your table called `deleted` `TINYINT(1)` That way you could just flag it as being deleted and you don't need to move it to any other table. So you would just update the record instead of deleting it. `UPDATE table_name SET deleted = 1 WHERE id = 1`

# timeout - Apache Camel MyBatis :- 90-second timeout on delete

> ID：15119653
> 
> 赞同：0
> 
> 时间：2013-02-27T18:35:20.947
> 
> 标签：timeout, apache-camel, mybatis

It's adding a lot of time to the route and is quite an annoyance

It looks in source like the

```
from( ... ) 
.stuff()
.to( "mybatis:deleteTable?statementType=Delete" ) 
```

corresponding with

```
<delete id="deleteTable" parameterType="java.lang.Object" >
    delete from table;
</delete> 
```

presumably it's waiting for a response with a 90-second timeout on the delete call and then carries on.

It's 90 seconds regardless of size of data in the table. whethre empty or actual records inside.

it sounds like its expecting a response that it doesn't get, and waiting for a timeout before carrying on.

It's very annoying and I cant find a work-around

looking in code this might be because it looks like the mybatis sql session implementation org.apache.ibatis.session.defaults.DefaultSqlSession delete(...) methods just delegate to the update(...) , which might be waiting for a response...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:10:51.070

问题是进入的消息是列表中的数千条消息，它为列表中的每个项目调用一次删除

您可以通过设置 statementType=InsertList 来解决它 - 它期望类似的返回删除并将 List 作为单个对象传递，而不是迭代其内容

# c# - Detecting a rectangle drawing on corners of a PDF Page

> ID：15119656
> 
> 赞同：0
> 
> 时间：2013-02-27T18:35:27.067
> 
> 标签：c#, asp.net, pdf, drawing

Currently i have this method that draws a rectangle on the top left corner of the page. I wanted to create another method that will search for a rectangle drawing in any of the four corners of my scanned document. How can i go about writing a method that will check each corner for a rectangle drawing based what i created for drawing the rectangle.

```
static void AddQRTag(PdfSharp.Drawing.XGraphics gfx, int xPosition, int yPosition, string QRdata, string HRdata)
    {
        gfx.DrawRectangle(XBrushes.White, xPosition, yPosition, xPosition + 55, yPosition + 85);

        PdfSharp.Drawing.XImage xImage =
            PdfSharp.Drawing.XImage.FromGdiPlusImage(BuildQR(QRdata.ToUpper(), 3,
                                            QRCodeEncoder.ENCODE_MODE.ALPHA_NUMERIC, 2, QRCodeEncoder.ERROR_CORRECTION.M));
        gfx.DrawImage(xImage, xPosition + 5, yPosition + 5, xImage.PixelWidth * .8, xImage.PixelWidth * .8);

        //XFont font = new XFont("OCR B", 10, XFontStyle.Bold);
        XFont font = new XFont("OCR B", 6);
        XTextFormatter tf = new XTextFormatter(gfx);
        tf.Alignment = XParagraphAlignment.Left;

        //XStringFormat format = new XStringFormat();
        //format.Alignment = XStringAlignment.Near;
        XRect layout = new XRect(xPosition + 5, yPosition + 55, 55, 30);
        tf.DrawString(HRdata.ToUpper(), font, XBrushes.Black, layout, XStringFormats.TopLeft);
        //gfx.DrawString(HRdata, font, XBrushes.Black,layout,format);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T14:51:02.553

可能有许多技术可以使用 3rd 方 pdf 阅读器 API 在 PDF 文件中查找图像。但是假设您找不到任何方法，并且假设您可以阅读 pdf 文件并将它们转换为简单的图像，您可以使用图像处理技术很容易地找到您的矩形。

最简单（且稳健）的事情是使用简单的相关器来查找您的矩形，如果您不知道正方形的尺寸，您可以使用不同的矩形运行相关器几次。

如果您需要高性能，还有其他解决方案（如果是这种情况，只需写评论，我会为您指出另一个方向）

# java - 继承 - 将调用哪个方法

> ID：15119663
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:36:14.880
> 
> 标签：java, inheritance

这是场景。如果我有以下类和接口

```
public interface Jobinfo {}

public interface SpecificJobinfo {}

public abstract class AbstractJob implements JobInfo{}

public class SpecificJob extends AbstractJob implements SpecificJobInfo{}

interface Service {
    execute(JobInfo);
    execute(SpecificJobInfo);
}

// implementing class

public class ServiceImpl implements Service{
    SpecificJob specificJob = new SpecificJob ();
    execute(specificJob);
} 
```

将调用哪个方法 - 带有 JobInfo 或 SpecificJobInfo 的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:55:03.440

两种方法都*适用*（因为 SpecificJob 实现了`JobInfo`和`SpecificJobInfo`）并且*可访问*（即它们不是超类中的私有方法），规则是总是调用*最具体的方法。*

在这种情况下，没有最具体的方法，因为`JobInfo`和`SpecificJobInfo`是不相关的类型（该`execute`方法的两种变体都是*最大具体*的）。因此方法调用是不明确的，并且会发生编译时错误。

引用[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2.5)：

> 如果多个成员方法既可访问又适用于方法调用，则有必要选择一个为运行时方法分派提供描述符。Java 编程语言使用选择最具体方法的规则。
> 
> 非正式的直觉是，如果第一个方法处理的任何调用可以传递给另一个方法而不会出现编译时类型错误，那么一个方法比另一个方法更具体。

如果`SpecificJobInfo`延长`JobInfo`，歧义就会被避免而有利于`execute(SpecificJobInfo)`。

# php - PHP cURL scraping HTML TR tag outputting NULL

> ID：15119670
> 
> 赞同：0
> 
> 时间：2013-02-27T18:36:43.137
> 
> 标签：php, html, curl, scrape

Here's my code:

```
<?php
    set_time_limit(0);
    $agent = 'User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.3) Gecko/2008100922 Ubuntu/8.04 (hardy) Firefox/3.0.3';
    $url = "XXXXXXXX";

    $ch = curl_init ($url);
    curl_setopt($ch, CURLOPT_USERAGENT, $agent);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    $data = curl_exec ($ch);
    curl_close($ch);

    $regex = '/<tr>(.*?)<\/tr>/s';
    preg_match_all($regex,$data,$match);
    $tr = $match[0][0];
    var_dump($tr);

if(curl_errno($ch)){ // check for execution errors
    echo 'Scraper error: ' . curl_error($ch);
    exit;
}
?> 
```

Here's what's outputted:

```
array (size=0)
  empty 
```

Here's what's being scraped:

```
<table>
    <tr><td>Title</td><td>Message</td></tr>
    <tr><td>Title</td><td>Message</td></tr>
</table> 
```

Any ideas for troubleshooting to make sure the page is being loaded correctly or anything obvious that I'm missing?

Here's the error I am receiving:

```
 Warning: curl_errno(): 2 is not a valid cURL handle resource in 
```

I suppose it looks like it's due to a lack of SSL. Thanks for the assistance everybody.

# html - Spacing before a HTML Horizontal Line

> ID：15119677
> 
> 赞同：3
> 
> 时间：2013-02-27T18:37:11.383
> 
> 标签：html, css, horizontal-line

I was setting up some signatures in HTML which will end up in Outlook. One issue I have is that when inserting a horizontal line, it inserts a large space above and a smaller space below the line. My issue is the very large space above the horizontal line. It's almost the size of a full break

```
<br> 
```

If I manually edit the signature in Outlook by setting the spacing after the text that is just before the horizontal line it's okay, but I can't do this manually for the # of them I need to edit. Here is an example of my issue:

```
<html>
<head>
    <title>HTML Online Editor Sample</title>
</head>
<body>
    <p>
        <span style="font-size:12pt;"><span style="font-family: arial, helvetica, sans-serif;"><b>This is a test</b></span></span></p>
    <hr style="height: 2px; width: 99%; background-color: #848484" />
    <p>
        <span style="font-size:10pt;"><span style="font-family: arial, helvetica, sans-serif;"><b>Text under the line</b></span></span></p>
</body>
</html> 
```

Is there a way I can tighten the text before or after the line?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:39:20.133

段落元素`<p>`有一些自然的填充和边距，所以尝试添加 padding: 0 和 margin: 0 到它们

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:41:55.640

`hr`和`p`元素有一些由浏览器插入的填充/边距。添加`margin: 0;`以删除它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T21:02:31.223

```
<hr style="height: 2px; width: 99%; margin:0 auto;line-height:2px;background-color: #848484"; border:0 none; /> 
```

或者

```
<hr style="height: 0; width: 99%; line-height:0;border-bottom:2px solid #848484; background:none;" /> 
```

[在这里摆弄](http://jsfiddle.net/UGQKQ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:17:07.207

从重置 CSS 开始并从那里获取它总是好的。

有用的链接： http: [//meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

# cakephp - Cakephp：组合输入值以创建隐藏名称输入

> ID：15119680
> 
> 赞同：1
> 
> 时间：2013-02-27T18:37:22.313
> 
> 标签：cakephp, concatenation

我一直在寻找解决方案，但似乎无法弄清楚这一点。我想要做的是在添加产品时，我希望从表单中的输入中填充名称字段。因此名称将包括用户为 type_id、category_id 和 subcategory_id 选择的值。有谁知道实现这一目标的方法？

添加产品查看页面

```
 <fieldset>
    <legend><?php echo __('Add Product'); ?></legend>
<?php
    echo $this->Form->input('type_id');
    echo $this->Form->input('category_id', array('label' => 'Vendor'));
    echo $this->Form->input('subcategory_id', array('label' => 'Model'));
    echo $this->Form->input('location', array('label' => 'Location'));
    echo $this->Form->input('sku', array('label' => 'Asset Tag'));
    echo $this->Form->input('mac');
    echo $this->Form->input('description', array('label' => 'Notes'));
    echo $this->Form->input('name', array( 'value' => ['type_id']['category_id']  , 'type' => 'hidden'));
    //echo $this->Form->input('cost');
    // echo $this->Form->input('Tag');
    ?>
    </fieldset> 
```

产品控制器添加功能

```
 public function add() {
    if ($this->request->is('post')) {
        $this->Product->create();
        if ($this->Product->save($this->request->data)) {
            $this->Session->setFlash(__('The product has been saved'));
            $this->redirect(array('action' => 'index'));
        } else {
            $this->Session->setFlash(__('The product could not be saved. Please, try again.'));
        }
    }
    $subcategories = $this->Product->Subcategory->find('list',array('order'=>'Subcategory.name asc'));
    $categories = $this->Product->Category->find('list',array('order'=>'Category.name asc'));
    $types = $this->Product->Type->find('list',array('order'=>'Type.name asc'));
    $this->set(compact('subcategories', 'categories', 'types'));

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:19:04.410

为了按照您尝试的方式进行操作，您必须使用客户端 javascript 来“即时”更新输入值，但这不是很安全并且很容易被弄乱。[完全删除名称输入并在 Product 模型的beforeSave](http://book.cakephp.org/2.0/en/models/callback-methods.html#beforesave)方法中处理它会更有意义（或者通过在保存之前在控制器中定义名称值）。

```
public function beforeSave($options = array()) {
    // Generate the name based on type and category
    $this->data['Product']['name'] = $this->data['Product']['type_id'] .
                                     $this->data['Product']['category_id'];

    return true;
} 
```

**根据您的评论更新。**

为了获取名称，只需找到这些名称（假设您的模型已关联）并定义它们：

```
public function beforeSave($options = array()) {
    // Get the type name
    $type = $this->Type->field('name', array(
        // Set the condition for the field
        'Type.id' => $this->data['Product']['type_id']
    ));

    // Get the category name
    $category = $this->Category->field('name', array(
        // Set the condition for the field
        'Category.id' => $this->data['Product']['category_id']
    ));

    // Generate the name based on type and category
    $this->data['Product']['name'] = $type . $category;

    return true;
} 
```

# mysql - 我在 mysql 查询中没有得到正确的数据。任何人都可以帮助我吗？

> ID：15119683
> 
> 赞同：3
> 
> 时间：2013-02-27T18:37:29.923
> 
> 标签：mysql, sql, select, join

我创建了[sql fiddle](http://sqlfiddle.com/#!2/66a6b/3)

![在此处输入图像描述](../Images/b9905a002248a71c44f1c5c0374212bb.png)并显示结果，但我没有得到第二行事件 pqr。任何人都可以帮助我。

我想要那些开始日期和结束日期不为空的行，那么 end_date 今天必须等于或大于，如果当前使用和 maxuse 不为空，那么当前使用小于 max use 或所有数据为空，接受事件名称和 id。

**提前致谢**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:48:06.687

您的 Select 语句如下所示：

```
SELECT * FROM event 
WHERE (
     (start_date IS NOT NULL)
  && (end_date IS NOT NULL)
  && (end_date >= curdate())
)
|| (
     (max_use IS NOT NULL)
  && (current_use IS NOT NULL)
  && (current_use < max_use)
); 
```

这并不是你真正想要的。特别是你完全错过了这个`or all data is null except event name and id`部分。还有其他错误（在您的问题文本或陈述中）。

该`pqr`行是这样的一行，除了事件名称和 ID 之外，所有数据都为空。

我已经纠正的另一个错误是`greater or equal`您检查的部分只是`greater`.

很可能你想要这个[声明](http://sqlfiddle.com/#!2/66a6b/10)：

```
SELECT * FROM event 
WHERE (
     start_date IS NOT NULL
  && end_date IS NOT NULL
  && end_date >= curdate()
)
||(
     max_use IS NOT NULL
  && current_use IS NOT NULL
  && current_use < max_use
)
|| (
     event is not null
  && start_date is null
  && end_date is null
  && max_use is null
  && current_use is null
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:13:13.547

我想这就是你要找的

```
 select * from event 
  where ((start_date is not null)&&(end_date is not null)&&(end_date>= curdate()))

 OR ((max_use is not null)&&(current_use is not null)&&(current_use < max_use ))
 or ( (start_date is  null ) and (end_date is  null) and (max_use is  null)
   and (current_use is  null)) 
```

[**演示 SQLFIDDLE**](http://sqlfiddle.com/#!2/a0592/4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:42:02.800

这两个`WHERE`子句都有一个`start_date is not null`约束（加上其他一些），并且该记录的存在`start_date`（或每个其他字段）`null`使其不会出现在结果中。

# vba - 将简单的excel宏实现为复杂的宏

> ID：15119685
> 
> 赞同：0
> 
> 时间：2013-02-27T18:37:31.093
> 
> 标签：vba, excel

此宏按其应有的方式工作，无需对文件进行条件过滤。

但是我只需要修改这个宏，以便它打开每个文件，从最小到最大对它们进行排序，**只过滤那些高于平均水平的**文件，现在从这些文件中获取前 100 个并将它们复制到新的工作表中，首先这 100 行中的一行粗体。

**语境**

我`.txt`在位于 filepath 的文件夹中有 600 个 excel 文件（实际上扩展名为 ）`C:\Excel`。此宏打开它们中的每一个，从最小值到最大值对它们进行排序，从每个中取出前 100 个，并在打开文件时按顺序将它们复制到新工作表中，使新文件的第一行变为粗体。

这是代码：

```
Sub MergeAllWorkbooks()
    Dim MyPath As String, FilesInPath As String
    Dim MyFiles() As String
    Dim SourceRcount As Long, FNum As Long
    Dim mybook As Workbook, BaseWks As Worksheet
    Dim sourceRange As Range, destrange As Range
    Dim rnum As Long, CalcMode As Long

    Dim isEmpty As String
    isEmpty = "null"

    ' Change this to the path\folder location of your files.
    MyPath = "C:\Excel"

    ' Add a slash at the end of the path if needed.
    If Right(MyPath, 1) <> "\" Then
        MyPath = MyPath & "\"
    End If

    ' If there are no Excel files in the folder, exit.
    FilesInPath = Dir(MyPath & "*.txt")
    If FilesInPath = "" Then
        MsgBox "No files found"
        Exit Sub
    End If

    ' Fill the myFiles array with the list of Excel files
    ' in the search folder.
    FNum = 0
    Do While FilesInPath <> ""
        FNum = FNum + 1
        ReDim Preserve MyFiles(1 To FNum)
        MyFiles(FNum) = FilesInPath
        FilesInPath = Dir()
    Loop

    ' Set various application properties.
'    With Application
'        CalcMode = .Calculation
'        .Calculation = xlCalculationManual
'        .ScreenUpdating = False
'        .EnableEvents = False
'    End With

    ' Add a new workbook with one sheet.
    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)
    rnum = 1

    ' Loop through all files in the myFiles array.
    If FNum > 0 Then
        For FNum = LBound(MyFiles) To UBound(MyFiles)
            Set mybook = Nothing
            On Error Resume Next
            Set mybook = Workbooks.Open(MyPath & MyFiles(FNum))

            On Error GoTo 0

            If Not mybook Is Nothing Then
                On Error Resume Next

                    mybook.Worksheets(1).Sort.SortFields.Clear
                    mybook.Worksheets(1).Sort.SortFields. _
                    Add Key:=Range("C2:C18000"), SortOn:=xlSortOnValues, Order:=xlAscending, _
                    DataOption:=xlSortNormal

                 ' Change this range to fit your own needs.
                With mybook.Worksheets(1)
                    Set sourceRange = .Range("A2:C101")
                End With

                If Err.Number > 0 Then
                    Err.Clear
                    Set sourceRange = Nothing
                Else
                    ' If source range uses all columns then
                    ' skip this file.
                    If sourceRange.Columns.Count >= BaseWks.Columns.Count Then
                        Set sourceRange = Nothing
                    End If
                End If

                On Error GoTo 0
                If Not sourceRange Is Nothing Then

                    SourceRcount = sourceRange.Rows.Count

                    If rnum + SourceRcount >= BaseWks.Rows.Count Then
                        MsgBox "There are not enough rows in the target worksheet."
                        BaseWks.Columns.AutoFit
                        mybook.Close savechanges:=False
                        GoTo ExitTheSub
                    Else

                        ' Copy the file name in column A.

                       ' With sourceRange
                           ' BaseWks.Cells(rnum, "D").Font.Bold = True
                           ' BaseWks.Cells(rnum, "D"). _
                                    Resize(.Rows.Count).Value = MyFiles(FNum)
                       ' End With

                        ' Set the destination range.

                        Set destrange = BaseWks.Range("A" & rnum)

                        With mybook.Worksheets(1).Sort
                                .SetRange Range("A1:C18000")
                                .Header = xlYes
                                .MatchCase = False
                                .Orientation = xlTopToBottom
                                .SortMethod = xlPinYin
                                .Apply
                            End With

                        ' Copy the values from the source range
                        ' to the destination range.
                        With sourceRange
                            BaseWks.Cells(rnum, "A").Font.Bold = True
                            BaseWks.Cells(rnum, "B").Font.Bold = True
                            BaseWks.Cells(rnum, "C").Font.Bold = True
                            'MsgBox (BaseWks.Cells.Address)
                            If ActiveCell.Text = isEmpty Then
                            ActiveCell.Offset(0, 1) = 1
                            ActiveCell.Offset(1).EntireRow.Insert
                            ActiveCell.Offset(1, 1) = 0
                            End If
                            Set destrange = destrange. _
                                            Resize(.Rows.Count, .Columns.Count)
                        End With
                        destrange.Value = sourceRange.Value

                        rnum = rnum + SourceRcount
                    End If
                End If
                mybook.Close savechanges:=False
            End If

        Next FNum
        BaseWks.Columns.AutoFit
    End If

ExitTheSub:
    ' Restore the application properties.
    With Application
        .ScreenUpdating = True
        .EnableEvents = True
        .Calculation = CalcMode
    End With
End Sub 
```

宏是凌乱的，但它的工作。

**研究**

我设法找到了一些宏并采用了它们，所以这是活动工作表中的宏，它只过滤那些高于平均水平的数据，并取前 100 个并将它们复制到同一工作簿的 sheet2 中。

```
Range("A1").Select
    Selection.AutoFilter
    ActiveSheet.Range("A1:C18000").AutoFilter Field:=3, Criteria1:= _
        xlFilterAboveAverage, Operator:=xlFilterDynamic
   ActiveSheet.AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Rows("1:100").Copy Destination:=Sheets("Sheet2").Range("A1") 
```

当我尝试根据需要采用此宏时，我的意思是将其放在“复杂”宏中的此类部分之后并删除以前复制文件的方式，但我无法使其正常工作。

我也问了[这个](https://stackoverflow.com/questions/15101035/macro-to-get-first-100-rows-after-filtering-in-excel)问题并得到了一个可能的解决方案来获取前 100 行过滤数据（我在“简单宏”中找到这个方法之前问过这个），但是我仍然不知道如何完成过滤。所以我问这个问题，因为我需要这个尽快。

PS 我的文件结构是 3 列，每列大约有 18000 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T01:14:07.657

我尝试遵循您现有的代码，但老实说有点混乱（您已经承认）。我重写了我相信你正在尝试做的事情。这确实依赖于 Scripting Runtime 组件，因此在 VBA 窗口中，转到 Tools...References... 并单击 Microsoft Scripting Runtime。

由于您已经对数据进行了排序，因此不需要过滤器。此外，您没有指定要排序的列，您的代码将按 A 排序，所以我假设。

我没有考虑任何特殊情况......即有超过 18000 行，有不到 100 个高于平均值的值，等等。您可能可以调整您以前的一些代码来处理这种情况。

```
Sub StackExample()

Dim fso As New Scripting.FileSystemObject
Dim fo As Scripting.Folder
Dim f As Scripting.File

Dim wb As Excel.Workbook
Dim ws As Excel.Worksheet
Dim wsPaste As Excel.Worksheet

Dim avg As Double
Dim r As Long

    Set fo = fso.GetFolder("C:\Excel\")

    For Each f In fo.Files
        If Right(f.Name, 4) = ".txt" Then

            ' assign the variable objects
            Set wb = Excel.Workbooks.Open(fo.Name & f.Name)
            Set ws = wb.Worksheets(1)
            wb.Worksheets.Add
            Set wsPaste = wb.Worksheets(1)
            wsPaste.Move , ws

            ' text to columns (from TXT file)
            ws.Activate
            ws.Range("A1:A18000").TextToColumns DataType:=xlDelimited, Comma:=True

            ' sort
            With ws.Sort
                .SetRange Range("A1:C18000")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlSortColumns
                .SortMethod = xlPinYin
                .Apply
            End With

            ' calculate the average
            avg = Excel.WorksheetFunction.Average(ws.Range("A2:A18000"))

            ' find the first row with a value equal to or greater than the average
            For r = 2 To 18000
                If ws.Cells(r, 1).Value >= avg Then Exit For
            Next r

            ' copy the range, then paste
            ws.Range(ws.Cells(r, 1), ws.Cells(r + 99, 3)).Copy
            wsPaste.Activate
            wsPaste.Paste wsPaste.Range("A1")

            ' save and close
            Application.DisplayAlerts = False
            wb.SaveAs Left(f.Name, Len(f.Name) - 4), xlOpenXMLWorkbook
            wb.Close
            Application.DisplayAlerts = True

        End If
    Next f

End Sub 
```

# awk - awk 可以接受两个参数吗？

> ID：15119690
> 
> 赞同：0
> 
> 时间：2013-02-27T18:37:39.107
> 
> 标签：awk

我对此很陌生，而且有点不知所措，所以如果我的标题不正确，请纠正我。我试图从一个文件在 awk 中设置一个变量，然后在另一个文件上调用脚本。

前任：

*   sqlinsert 写入 fields.txt

我执行：

猫文本文件 | ./awkscript

awkscript 在文本文件上运行时从 fields.txt 中提取 'fields' var

这就是我所拥有的。我正在使用 getline，这不是我想要的。我希望它从单独文件的第一行中获取值。

```
\#!/opt/local/bin/gawk -f

BEGIN { 
    printf "Enter field lengths: "
    getline fields < "-"
        print fields
}       

BEGIN {FIELDWIDTHS = fields; OFS="|"}
{
        {       for (i=1;i<=NF;i++) sub(/[ \t]*$/,"",$i)        }

\#       {       for (i=1;i<=NF;i++) sub(/^[ \t]*/,"",$i)        }

        print
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:47:30.647

我一直在寻找的是：

猫文本文件 | generic.awk -v 字段='10 1 21 21 4'

该`-v`选项也可以多次使用：cat textfile | generic.awk -v field1="10" -v field2="1" -v field3="21" -v field4="21" -v field5="4"

# asp.net-mvc - 为什么在 ASP MVC 4.0 中上传的 excel 文件的内容类型在 mac 上更改为 application/octet-stream？

> ID：15119696
> 
> 赞同：0
> 
> 时间：2013-02-27T18:37:51.880
> 
> 标签：asp.net-mvc, macos, excel, content-type, npoi

我有一个小问题！我正在为应该导入和处理 excel 文件的客户端设计一个 asp mvc 4 应用程序。为了处理 excel 文件，我使用了 NPOI 框架的 C# 版本。

我的客户使用mac，我使用windows。

在 Windows 上一切正常，但是当我的客户在他的 Mac 上尝试它时，它不再工作了。经过一番搜索，我发现从mac上传时上传文件的内容类型是“application/octet-stream”（从windows上传时与“application/vnd.ms-excel”相反）。

我们使用完全相同的文件，唯一的区别是我的客户文件保存在 mac 上，而我的文件保存在 windows pc 上（我们都从 google docs 获得相同的文件）。

当他在 Windows pc 上尝试使用保存在 mac 上的文件时遇到同样的错误时，这变得更奇怪了。

有人知道发生了什么吗？或者当内容类型为“application/octet-stream”时，如何让我的 NPOI 处理工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:41:45.623

浏览器可以自由选择要发送的内容类型。如果需要，它甚至可以向您发送“蓬松/字节”，而您对此无能为力。Mac 上的 Safari 似乎不知道 Excel 文件是什么，因此它不会发送 Excel 内容类型。

什么是非营利组织？为什么您的应用程序*需要*设置该内容类型？您可以通过查看发布的文件扩展名来识别这是一个 Excel 文件。如果既没有发布内容类型也没有发布扩展名（完全可能），您只能通过文件内容猜测。

# java - Hibernate - 如何坚持“落后”的一对多

> ID：15119702
> 
> 赞同：0
> 
> 时间：2013-02-27T18:38:11.370
> 
> 标签：java, hibernate

我有一个有趣的情况。我正在开发一款游戏。我有一个带有二维对象“空间”数组的板。每个“空间”都有四个对对象“边界”的引用（北、东、南、西）。

空间共享对“边界”的引用。例如，位置 (0,0) 的“空间”与位置 (1,0) 的“空间”的西边界共享其东边界。这使我只能在发生某些事情时更新边界（例如，如果被破坏，则从墙变为无）。

知道如何使用 Hibernate 来坚持这样的事情吗？我真的有一个一对多的边界，有很多空间，但我不确定如何将它们具体关联回特定的边界（北、南、西、东）。我也不知道如何设置它，以便两个“空间”对象共享对单个边界对象的引用。

```
public class Space {
  private Boundary northBoundry;
  private Boundary eastBoundry;
  private Boundary southBoundry;
  private Boundary westBoundry;

  //hero on the Space
  private HeroBase hero;

  private long     spaceId;

  //getters and setters
}

public class Boundary {

  public static final String NONE        = "none";
  public static final String CLOSED_DOOR = "closed_door";
  public static final String OPEN_DOOR   = "open_door";
  public static final String WALL        = "wall";

  private String             type;
  long                       boundaryId;

  //getters and setters
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T09:50:36.300

您描述的是 Space 和每个 Boundary 之间的多对一关系：

```
public class Space {
  @ManyToOne
  @JoinColumn(name="NORTH_BOUNDARY")
  private Boundary northBoundary;

  @ManyToOne
  @JoinColumn(name="EAST_BOUNDARY")
  private Boundary eastBoundary;

  @ManyToOne
  @JoinColumn(name="SOUTH_BOUNDARY")
  private Boundary southBoundary;

  @ManyToOne
  @JoinColumn(name="WEST_BOUNDARY")
  private Boundary westBoundary;
} 
```

# java - Java、C++、Python 中的异常模型

> ID：15119703
> 
> 赞同：0
> 
> 时间：2013-02-27T18:38:15.503
> 
> 标签：java, c++, python, exception, checked-exceptions

嘿，我想知道 Java 异常模型在 C++ 和 Python 中有何不同？

我以为只有 Java 有检查异常，但从我读到的 Python 也有检查异常？

任何想法都会很棒，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:41:55.197

Python 没有*检查*异常。但它确实有异常处理机制.. 例如

```
def test():
    raise Exception()

try:
    test()
except Exception:
    print "bugger."

# but its totally legal to just call it, and let any uncaught exceptions propagate
test() 
```

由于python虚拟机的设计，是完全合法的，

```
public static void TestMethod(){
    throw new Exception();
} 
```

另一方面，运行*可能*引发异常（编译器将检测到）但未在 Java 中明确检查的代码是完全非法的。由于 JVM 和字节编译器的设计，它只是无法完成。

# mysql - 加快缓慢的 MySQL 子查询更新

> ID：15119706
> 
> 赞同：0
> 
> 时间：2013-02-27T18:38:32.270
> 
> 标签：mysql, performance, subquery

我有以下 UPDATE 脚本，它记录了我网站上的活动产品的数量，因此我可以快速参考该类别是否有产品，而无需在前端进行此计数。

```
UPDATE category_to_store
SET products = (
                SELECT COUNT(*)
                FROM product p 
                LEFT JOIN product_to_category p2c 
                     ON (p.product_id = p2c.product_id) 
                LEFT JOIN product_to_store p2s 
                     ON (p.product_id = p2s.product_id) 
                WHERE p.status = '1' 
                AND p.date_available <= NOW()
                AND p2c.category_id = category_to_store.category_id
                AND p2s.store_id = category_to_store.store_id
               ); 
```

我使用的表格解释如下：

```
DESCRIBE category_to_store;

Field       Type        Null    Key     Default Extra 
---------------+---------------+-------+-------+-------+---------------
category_id int(11)     NO  PRI     
store_id    int(11)     NO  PRI     
products    int(11)     NO      0   

DESCRIBE product;

Field       Type        Null    Key     Default Extra 
---------------+---------------+-------+-------+-------+---------------
product_id  int(11)     NO  PRI     auto_increment
~
date_available  date        NO          
~
status      tinyint(1)  NO      0               
~

DESCRIBE product_to_category;

Field       Type        Null    Key     Default Extra 
---------------+---------------+-------+-------+-------+---------------
product_id  int(11) NO  PRI     
category_id int(11) NO  PRI     

DESCRIBE product_to_store;

Field       Type        Null    Key     Default Extra 
---------------+---------------+-------+-------+-------+---------------
product_id  int(11) NO  PRI     
store_id    int(11) NO  PRI 0 
```

（`product`表中包含我未包含但未使用的字段）

这目前运行正确，但目前需要 110 秒。

我已将站点设置为使用 a`WHERE category_to_store.category_id = '(int)'`来限制查询，但这意味着要确定哪些类别可能会受到更新的影响，我猜这是可行的，但我想知道你们可爱的天才中是否有任何我错过的更好的解决方案？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:06:11.917

如果您要更新很多行，则执行连接可能比使用“嵌套循环”操作更有效。

```
 UPDATE category_to_store cts
     LEFT 
     JOIN (
            SELECT COUNT(*) AS cnt_
                 , p2c.category_id
                 , p2s.store_id
              FROM product p
              LEFT
              JOIN product_to_category p2c
                ON (p.product_id = p2c.product_id)
              LEFT
              JOIN product_to_store p2s
                ON (p.product_id = p2s.product_id) 
             WHERE p.status = '1'
               AND p.date_available <= NOW()
             GROUP
                BY p2c.category_id
                 , p2s.store_id
          ) c
         ON c.category_id = cts.category_id
        AND c.store_id = cts.store_id
        SET cts.products = IFNULL(c.cnt_,0) 
```

* * *

为了获得最佳性能，您需要合适的索引可用，您可能需要考虑添加索引，例如

```
 ... ON product (product_id, status, date_available) 
```

# c++ - 将 bash 命令添加到 CMake 测试

> ID：15119708
> 
> 赞同：2
> 
> 时间：2013-02-27T18:38:39.950
> 
> 标签：c++, bash, makefile, cmake, ctest

我最近发现了 CMake 测试的可能性。我使用它编写了几个测试客户端，它们工作正常，但要执行测试，我需要：

cmake .. -> make -> 然后在后台或其他终端运行我的程序 -> make test（运行所有测试客户端/测试场景）

假设我想要命令：**make test**不仅要运行测试，还要在后台运行可执行文件（正在测试）并在测试完成后将其杀死。如何通过 CMakeLists 传递 bash 命令？我还没有找到一种直接的方法来实现我想要的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:51:01.980

没有办法从 ctest 在后台运行进程。为了处理像 paraview 这样使用 MPI 的项目，我们编写了 ac 驱动程序来启动进程并执行测试/测试。基本上每个 ctest 测试都需要运行并返回一个值。但是，当然没有什么可以阻止该测试启动和停止尽可能多的进程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:47:44.017

您可以使用`ADD_CUSTOM_COMMAND`. （[CMake`ADD_CUSTOM_COMMAND`文档](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3aadd_custom_command)）

# javascript - 如何在引导模式覆盖单击时将模型传回回调函数

> ID：15119709
> 
> 赞同：0
> 
> 时间：2013-02-27T18:38:40.810
> 
> 标签：javascript, twitter-bootstrap, angularjs

将引导模式与我的角度形式一起使用。我可以在取消/添加函数中传回模型，因为它们在范围内，但覆盖背景 div 在外部。单击叠加层时如何传回对象？

**HTML**

```
<div id="add-contact" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" data-ng-model="itemInEditMode" data-ng-click="cancelAdd(itemInEditMode)">×</button>
    <h3>Add new contact</h3>
  </div>

  <div class="modal-body">

    <form class="form-horizontal add-inventory-item" ui-if="itemInEditMode != null">

            <div class="left-align-form">

                <div class="left-field span3">
                    <label for="">Full Name</label>
                    <input type="text" name="" id="" data-ng-model="itemInEditMode.fullName">
                </div>

                <div class="left-field span3">
                    <label for="">Position</label>
                    <input type="text" name="" id="" data-ng-model="itemInEditMode.position">
                </div>
                <div class="clear"></div>
            </div>

            <div class="left-align-form">

                <div class="left-field span2">
                    <label for="">Phone Number</label>
                    <input type="text" name="" id="" data-ng-model="itemInEditMode.mainPhoneNumber">
                </div>

                <div class="left-field span2">
                    <label for="">Mobile Number</label>
                    <input type="text" name="" id="" data-ng-model="itemInEditMode.mobilePhoneNumber">
                </div>

                <div class="left-field span2">
                    <label for="">Fax Number</label>
                    <input type="text" name="" id="" data-ng-model="itemInEditMode.faxNumber">
                </div>
                <div class="clear"></div>
            </div>

            <div class="span3">
                <label for="">Email Address</label>
                <input type="text" name="" id="" data-ng-model="itemInEditMode.email">
            </div>
            <div class="clear"></div>            

            <div class="left-align-form checkbox-group">

                <div class="left-field span1">
                    <label for="">Primary Contact</label>
                    <input type="checkbox" id="" data-ng-model="itemInEditMode.primaryContact" data-ng-checked="itemInEditMode.primaryContact">
                </div>

                <div class="left-field span1">
                    <label for="">Event Notifications</label>
                    <input type="checkbox" name="" id="" data-ng-model="itemInEditMode.eventNotifications">
                </div>

                <div class="left-field span1">
                    <label for="">Billing Notifications</label>
                    <input type="checkbox" name="" id="" data-ng-model="itemInEditMode.billingNotifications">
                </div>

                <div class="left-field span1">
                    <label for="">SMS Notifications</label>
                    <input type="checkbox" name="" id="" data-ng-model="itemInEditMode.smsNotifications">
                </div>

                <div class="clear"></div>
            </div>            

    </form> 

  </div><!-- end modal-body -->

  <div class="modal-footer">
    <button class="btn fooda-action-green" data-ng-click="saveContact()" data-dismiss="modal"><i class="icon-plus-sign"></i>Add</button>
    <button class="btn fooda-action-orange" data-ng-model="itemInEditMode" data-ng-click="cancelAdd(itemInEditMode)" data-dismiss="modal" aria-hidden="true"><i class="icon-minus-sign"></i>Cancel</button>
  </div>

</div><!-- end add-contact modal --> 
```

**jQuery 函数（用于测试）**

```
$('#add-contact').on('hide', function(itemInEditMode) {
    $scope.cancelAdd(itemInEditMode);   
}); 
```

谢谢！

# ember.js - 值绑定到现有的 HTML 元素

> ID：15119710
> 
> 赞同：0
> 
> 时间：2013-02-27T18:38:58.353
> 
> 标签：ember.js

正如 Emberjs 建议的那样，为了将元素值/属性等绑定到控制器，我必须使用 Emberjs 创建该元素。例如：

```
App.SearchTextField = Em.TextField.extend({ }); 
```

和观点：

```
{{view App.SearchTextField placeholder="Twitter username"
                           valueBinding="App.tweetsController.username"}} 
```

这意味着页面的几乎所有内容都应该在 Emberjs 的控制之下。这不是很方便。

是否可以对现有元素进行任何类型的值或事件绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T12:02:37.860

为了使绑定起作用，Ember 需要知道绑定值何时更改，以便同步它。为了让 Ember 知道某个值已更改，您需要使用`Ember.set`. 例子：

```
object.set('value', 'I changed'); 
// This says: Ember, my value has changed, please sync! 
```

因此，当某个属性在没有使用的情况下发生更改时`Ember.set`，Ember 不知道它应该同步它。因此，我们需要监听这个事件变化，并告诉 Ember 它使用`Ember.set`.

这就是输入值发生的情况。当您键入时，值会更改，但`Ember.set`不会被调用。那么，当这些事件之一被触发时`Ember.TextField`，监听`keyup`和`change`其他事件和调用是做什么的。`Ember.set`

当然，您不必*使用*它们，但是您必须手动监听这些更改并告诉 Ember 值已更改`this.set('value', this.$().val())`：)

我不明白为什么您在使用时遇到问题，`Ember.TextField`因为它几乎可以做任何事情，而且它所做的一切都为您省去了自己收听事件的麻烦。

可能对您有所帮助的一件事是您可以直接在模板中使用它，而不是创建视图来扩展它：

```
{{view Em.TextField placeholder="Twitter username" valueBinding="username" type="search"}} 
```

这几乎与输入相同的数量：

```
<input type="search" placeholder="Twitter username" value="some value" /> 
```

注意：从您上面提供的示例中，看起来您正在遵循旧教程，请注意，从那时起很多都发生了变化。

# jboss - ClassCastException：MyFilter 无法转换为 javax.servlet.Filter

> ID：15119712
> 
> 赞同：4
> 
> 时间：2013-02-27T18:39:05.207
> 
> 标签：jboss, module, classloader, jboss7.x, libraries

我正在将一个应用程序迁移到 JBoss 7，所有依赖项都在`"JBOSS_HOME/server/default/lib"`(JBoss 4) 中。我包含了库`"servlet.jar"`（javax.servlet。*），但是，在[为 JBoss 7 设置全局模块](https://docs.jboss.org/author/display/AS71/Developer+Guide#DeveloperGuide-GlobalModules)（war 文件中的 modules.xml、standalone.xml、jboss-deployment-structure.xml）之后，库通常由 JBoss 加载。

当 JBoss 7 尝试启动过滤器时，出现以下异常：

```
15:09:15,222 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/RegistrarValorDolar]] (MSC service thread 1-2) Exception starting filter cripto: java.lang.ClassCastException: cenpra.com.sigtec.business.utilities.SessionFilter cannot be cast to javax.servlet.Filter
at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:441) [jbossweb-7.0.13.Final.jar:]
at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3269) [jbossweb-7.0.13.Final.jar:]
at org.apache.catalina.core.StandardContext.start(StandardContext.java:3865) [jbossweb-7.0.13.Final.jar:]
at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) [rt.jar:1.7.0_15]
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) [rt.jar:1.7.0_15]
at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_15] 
```

尝试从全局模块中删除库“servlet.jar”，尝试服务器使用内部 jar 加载它自己的类，我得到了一个`ClassNotFoundException`类`javax.servlet.Filter`。

*   我想使用全局模块，因为我需要重用很多库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:55:06.213

您的类路径被多个不同版本的类污染`javax.servlet.Filter`。由类加载器 X 加载的类（例如负责容器内部类的类）与类加载器 Y 加载的类（例如负责 webapp 类的类）不同。

> *我包括了库“servlet.jar”（javax.servlet。）*

这至少听起来不对。这应该已经由目标 servletcontainer（在您的情况下是 JBoss）提供。`/WEB-INF/lib`您绝对不应该在其文件夹中提供特定于 servletcontainer 的库以及 webapp 。这只会导致运行时类路径灾难，因为它们的类加载优先于 servletcontainer 本身提供的类，因此与 servletcontainer 的内部类冲突，而后者又使用 servletcontainer 自己的类。

摆脱`/WEB-INF/lib`文件夹中特定于 servletcontainer 的库。

`javax.servlet`这是初学者在粗心地尝试修复/规避他们在 IDE 中遇到的 API 上的编译错误时的常见错误。它应该以不同的方式解决。至此，您需要告诉 IDE 将 Web 项目与给定的目标容器相关联。然后，IDE 将自动执行必要的构建路径魔术。

### 也可以看看：

*   [如何在我的 Eclipse 项目中导入 javax.servlet API？](https://stackoverflow.com/questions/4076601/how-do-i-import-the-javax-servlet-api-in-my-eclipse-project/4076706#4076706)

# javascript - 添加到 3rd 方页面的 DOM 时如何避免 HTML ID 冲突？

> ID：15119713
> 
> 赞同：4
> 
> 时间：2013-02-27T18:39:05.333
> 
> 标签：javascript, jquery, html, css, dom

当使用 Javascript/jQuery 向网页添加额外的 HTML 元素并添加额外的外部 CSS 声明以配合它们时，您需要防止这些元素的 ID 和 CSS 类名与页面上已有的冲突。例如，您可能已经在页面某处拥有像“outerWrapper”或“nav”这样的 ID，并且新内容也可能具有相同名称的 ID。

在创建要添加到您自己的网页的代码时，这相对容易。

但是如果你想提供可以在任何 3rd 方网站上使用的代码，你就无法控制页面上已经使用了哪些 ID 和类名，更不用说将来可能对页面进行哪些更改.

那么在处理供第三方使用的代码时，避免这些冲突的最佳做法是什么？

到目前为止，我们一直在简单地使用 iframe，但这并不理想。

CSS 子选择器可以防止我们添加的 CSS 影响现有元素/类，但它们不会阻止我们的新元素被页面上已有的 CSS 设置样式。

为我们添加的内容的所有 ID 加上前缀，比如公司、产品名称或容器名称，是唯一的出路吗？例如，视频播放器 JWPlayer 将容器名称作为其 HTML5 播放器的所有元素 ID 的前缀。

我会很感激任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-20T14:34:12.380

这对我来说也是一个挑战，特别是因为我正在开发的应用程序包含许多 jquery 弹出窗口/对话框，其中包含输入 ID 与页面父部分上的表单字段相同的表单字段。

我发现以令人满意的方式解决这个问题的事情：

1.  依靠服务器端生成的 HTML 输入（我为此创建了自己的类）。这将使您可以轻松地为您的 HTML 输入 ID 添加“前缀”。
2.  在您所做的一切中只使用 camelCase。当您处于需要前缀以避免命名冲突的情况下，您可以使用下划线来区分名称的哪些部分是前缀，哪些部分不是。下划线现在将在您的应用程序中具有直接用途，以便您可以轻松编写功能以在需要时去除前缀。
3.  使用一致的命名约定创建前缀。我个人获取输入来自的后端服务类的类名（不要与#1 中提到的用于生成它们的类混淆）并将其用作前缀。例如，`blogUsers_firstName`and`blogUsers_lastName`和`blogUsers_email`都是来自服务器端类的 HTML 文本输入，名为`class blogUsers { }`.
4.  当您执行诸如进行 ajax 调用之类的操作时去掉前缀，这样您就可以在没有前缀的情况下接收服务器端控制器类的输入（因为您现在是服务器端并且没有名称冲突）。这使服务器端的生活变得更加轻松和清晰。
5.  对于更多公共前端网站情况，您更有可能将输入包含在`<form>`标签中，并且可能会实现*渐进增强/优雅降级*（即带有 event.preventDefault 的提交按钮上的 jquery 单击绑定），然后不要担心...只需确保您的服务器端生成仅将前缀添加到 ID 而不是输入的名称。发送数据时使用常规的旧表单提交`name`，因此不要使用前缀，对于那些关闭 javascript 的想象中的偏执狂来说，你会没事的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T13:30:54.203

一种选择可能是在动态创建 DOM 对象时使用 GUID 生成 ID。缺点是 ID 不会使用用户友好（因为它只是随机生成的字符列表）。查看此线程：[在 JavaScript 中创建 GUID / UUID？](https://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript)

另一种选择是创建自己的命名约定，类似于 ASP.Net 所做的。控件可以有一个静态名称（如“myControl”），但会获得一个预先挂在它上面的所有父对象的列表。用户有责任确保他们遵循良好的 HTML 实践并为其元素提供 id。因此，如果您生成的控件嵌套在一个表格中，在一个 div 中，您的新 ID 可能类似于：myTable_myDiv_myControl。

# php - 提交表单时无法获取php中的所有值

> ID：15119717
> 
> 赞同：0
> 
> 时间：2013-02-27T18:39:17.767
> 
> 标签：php, jquery, css, html

我正在尝试将 HTML 字段的值放到 php 中，但我只能看到一些使用`print_r ($_REQUEST)`.

因此，对于当前的 html（[http://pastebin.com/SDjZQCxD](http://pastebin.com/SDjZQCxD)），我无法通过 div userData 中的任何内容获得任何信息。

如果我将那个 div 的内容移到上面， `input id="submit-addItem" type="button" value="Add my item" style="display: block; display: none;" />`那么奇怪的是，我可以使用 get ..（所以它可以工作）看到 php 中的值

但是我很困惑为什么..我的意思是我想保留元素并且它们都在表单中所以我不确定为什么如果我将它们移到提交添加项之上它可以工作但否则它不会..

html代码可以在这里找到[http://pastebin.com/SDjZQCxD](http://pastebin.com/SDjZQCxD)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:46:35.220

当您有多个嵌套的表单标签时，会发生奇怪的事情。

我会建议删除`<form name="aaa2">`标签并尝试一下，这就是为什么。我没有看到第二种形式的任何用法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:48:32.073

那么我认为的一个主要问题是你有一个嵌套在另一个表单中的表单。[你不应该那样做](https://stackoverflow.com/questions/379610/can-you-nest-html-forms)。

另一个原因是我相信您输入中的 = 字符受到限制。这可能会给您带来一些奇怪的问题。

```
<input class="styleA" id="item-location=ad1" name="item-location=ad1" type="text" value="Address Line 1" /> 
```

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:50:51.680

如果表单字段由于 CSS 样式（在本例中为`display: none;`）而未呈现，则通常不会通过提交。邮政。（我说“通常”是因为[W3 规范中的语言](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2)说这些隐藏控件“可能”成功，但我的经验是大多数浏览器会忽略它们，就好像它们被禁用一样）。

而不是`display: none;`，尝试使用`visibility: hidden;`and `position: absolute;`。您将获得相同的视觉效果，但将提交隐藏的表单控件。

# matlab - 使用 Matlab 画笔/选择数据工具保留矩阵列

> ID：15119719
> 
> 赞同：0
> 
> 时间：2013-02-27T18:39:22.203
> 
> 标签：matlab

我正在使用 Matlab 中的矩阵，它有五列和几百万行。我有兴趣挑选这些数据的特定组。目前我正在使用 plot3() 和画笔/选择数据工具来执行此操作。

我将矩阵的前三列绘制为 X、Y、Z 并突出显示我感兴趣的矩阵区域。然后我使用画笔/选择工具的“创建变量”工具将该区域导出为新矩阵。

问题是，当我这样做时，原始较大矩阵的剩余两列将被删除。我明白为什么 - 它们没有被绘制，因此图形工具不知道它们。不过，为了继续处理管道，我需要该子区域的所有五列。

我正在使用可怕的嵌套 if 循环方法将适当的第 4 列和第 5 列值添加到导出的矩阵中 - 如果原始矩阵和导出矩阵中的第 1、2 和 3 列都匹配，则将原始矩阵的 4/5 列附加到出口了一个。这是糟糕的设计和令人痛苦的缓慢。我知道必须有一个 Matlab 函数/技巧 - 任何人都可以帮忙吗？

谢谢！

这可能会有所帮助：

```
1\.  I start with matrix 1 with columns X,Y,Z,A,B
2\.  Using the brush/select tool, I create a new (subregion) matrix 2 with columns X,Y,Z
3\.  I then loop through all members of matrix 2 against all members of matrix 1\.  If X,Y,Z match for a pair of rows, I append A and B
from that row in matrix 1 to the appropriate row in matrix 2.
4\.  I become very sad as this takes forever and shows my ignorance of Matlab. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:32:53.373

如果我正确理解您的情况，这是一种简单的方法：

假设你有一个这样的矩阵：`M = [A B C D E]`每个字母都是一个 Nx1 向量。

您选择一个范围，这部分对我来说不是很清楚，但假设您可以创建以下内容：

`idxA`,`idxB`和`idxC`, 如果它们在区域内则为 1，否则为 0。

然后你可以简单地使用：

`M(idxA&idxB&idxC,:)`

您还将获得额外的两列。

# internet-explorer-9 - 什么触发 IE 9 兼容性按钮可见性

> ID：15119721
> 
> 赞同：0
> 
> 时间：2013-02-27T18:39:27.783
> 
> 标签：internet-explorer-9

有谁知道是什么触发了兼容性按钮在 IE 9 中可见？我有两个我认为是相同的网页。IE 在一页上显示兼容性，但在另一页上不显示，所以我看不到的东西一定是不同的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:59:35.533

在 IE9 中发现这是默认设置。我取消选中它。

Alt >> 工具 >> 兼容性视图设置 >> 取消选中“在兼容性视图中显示 Intranet 站点”

# delphi - 当框架包含与客户端对齐的控件时，如何将框架恢复为继承？

> ID：15119723
> 
> 赞同：2
> 
> 时间：2013-02-27T18:39:35.943
> 
> 标签：delphi, dfm

我有时会设计一个到处都有控件的框架。它可能是一个带有 align=alClient 的网格，也可能是一些面板和拆分器。或者它可能完全是别的东西。无论如何，当我想“恢复为继承”时，我必须通过设置 align=alNone 并移动控件来为右键单击腾出空间，或者直接编辑 DFM。这有点麻烦。诚然，这种情况很少发生，不会有什么大不了的，但它仍然困扰着我。如果我可以在结构视图中右键单击会有所帮助，但是，这不起作用。

有没有其他人注意到这一点，如果有的话；你如何解决？像我一样，带着沉默（嗯，至少到目前为止）烦恼，还是你找到了一个绝妙的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:47:43.950

在窗体设计器中选择控件。如果控件被子控件遮挡，则选择子控件，然后按`Esc`选择父控件。按`Shift`+`F10`激活上下文菜单。

# ruby - Ruby - 词法作用域与继承

> ID：15119724
> 
> 赞同：34
> 
> 时间：2013-02-27T18:39:36.787
> 
> 标签：ruby, inheritance, lexical-scope

这是这个原始 SO 问题的延续：[Using "::" instead of "module ..." for Ruby namespacing](https://stackoverflow.com/questions/6927566/using-instead-of-module-for-ruby-namespacing/6928843#comment21276092_6928843)

在最初的 SO 问题中，这是我仍然无法理解的场景：

```
FOO = 123

module Foo
  FOO = 555
end

module Foo
  class Bar
    def baz
      puts FOO
    end
  end
end

class Foo::Bar
  def glorf
    puts FOO
  end
end

puts Foo::Bar.new.baz    # -> 555
puts Foo::Bar.new.glorf  # -> 123 
```

有人可以解释为什么第一个电话返回 555 以及为什么第二个电话返回 123 吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-03T17:02:01.057

您可以将 的每次出现`module Something`，`class Something`或`def something`视为进入新范围的“门户”。当 Ruby 搜索已被引用的名称的定义时，它首先在当前范围（方法、类或模块）中查找，如果没有找到，它将返回每个包含“网关”并搜索那里的范围。

在您的示例中，该方法`baz`定义为

```
module Foo
  class Bar
    def baz
      puts FOO
    end
  end
end 
```

因此，当尝试确定 的值时`FOO`，首先`Bar`检查类，并且由于`Bar`不包含 a `FOO`，因此搜索通过“<code>class Bar gateway”向上移动到`Foo`作为包含范围的模块中。`Foo`确实包含一个常数`FOO`(555) 所以这是你看到的结果。

该方法`glorf`定义为：

```
class Foo::Bar
  def glorf
    puts FOO
  end
end 
```

这里的“网关”是`class Foo::Bar`，所以当在“网关”`FOO`内部找不到时，它`Bar`会通过`Foo`模块并直接进入顶层，在那里还有另一个`FOO`（123）是显示的内容。

请注意 using`class Foo::Bar`创建单个“网关”，跳过 的范围`Foo`，但会`module Foo; class Bar ...`打开两个单独的“网关”</p>

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T19:14:45.443

哇，好问题。我能想到的最佳答案是在这种情况下，您使用模块来定义命名空间。

看一下这个：

```
FOO = 123

module Foo
  FOO = 555
end

module Foo
  class Bar
    def baz
      puts FOO
    end

    def glorf3
      puts ::FOO
    end
  end
end

class Foo::Bar
  def glorf2
    puts Foo::FOO
  end

  def glorf
    puts FOO
  end
end

puts Foo::Bar.new.baz    # -> 555
puts Foo::Bar.new.glorf  # -> 123
puts Foo::Bar.new.glorf2  # -> 555
puts Foo::Bar.new.glorf3  # -> 123 
```

所以我的想法是，当你定义：

```
module Foo
  FOO = 555
end 
```

您正在`FOO`. `Foo`所以当你在这里使用它时：

```
module Foo
  class Bar
    def baz
      puts FOO
    end
  end
end 
```

你在`Foo`命名空间中。但是，当您在以下位置引用它时：

```
class Foo::Bar
  def glorf
    puts FOO
  end
end 
```

`FOO`来自默认命名空间（如 所示`::FOO`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:16:52.143

第一个电话：

```
puts Foo::Bar.new.baz    # -> 555 
```

打印调用类**Foo::Bar实例的方法****baz的结果**

 **注意**Foo::Bar#baz**定义**实际上是 FOO 的一个闭包**。遵循 ruby​​ 的作用域规则：

1.  **FOO**在**Foo::Bar**（类，而不是实例）范围内搜索，没有找到，
2.  ****在封闭范围Foo**中搜索**FOO**（因为我们在模块定义中）并在那里找到它（555）**

 **第二个电话：

```
puts Foo::Bar.new.glorf  # -> 123 
```

打印调用类**Foo::Bar**实例的方法**glorf的结果**

 **请注意，这次**Fo​​o::Bar#glorf**定义**也是 FOO 的一个闭包**，但是如果我们遵循 ruby​​ 的范围规则，您会注意到这次关闭的值是**::FOO**（顶级范围 FOO），方式如下：

1.  ****在Foo::Bar**（类，而不是实例）命名空间中搜索**FOO ，但未找到****
***   **在封闭范围（'顶级'）中搜索**FOO并在那里找到它（123）******

 ***** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T08:06:44.827

glorf 是类 Foo 的一个方法，在`=> [Foo, Module, Object, Kernel, BasicObject]`

在该范围内（即在默认/主模块中），FOO 被分配 123

模块 Foo 定义为

```
module Foo
  FOO = 555
  class Bar
    def baz
      puts FOO
    end
  end
end 
```

其中方法 baz 属于模块 Foo 中的类 Bar`=> [Bar, Foo, Object, Kernel, BasicObject]`

在那个范围内，FOO 被分配了 555**********

# java - 使用反射的动态对象创建和分配

> ID：15119725
> 
> 赞同：1
> 
> 时间：2013-02-27T18:39:38.327
> 
> 标签：java, object, reflection, instance, variable-assignment

我正在加载一个带有以下语句的类：

```
Class classToLoad = Class.forName("com.somePackage.SomeotherPackage.classname" ); 
```

后来我使用反射来获取这个类的方法。现在要使用 methodname.invoke() 函数调用方法，我需要加载类的对象。因此我想创建加载类的对象。我尝试这样做：

```
Object obj = classToLoad.newInstance(); 
```

但问题是这样我没有加载类的对象，但我得到了 Object 类的对象。

现在，如果我想调用加载类的函数，我会这样做：

```
methodName.invoke(obj); 
```

它抛出一个异常：

> java.lang.IllegalArgumentException：对象不是声明类的实例

有人可以帮忙吗？

问题更新：

问题是我需要分配的左侧是不同的类类型，并且该类类型将在运行时决定

对于以下声明：

对象实例 = clazz.newInstance();

“instance”应该是“clazz”类型而不是“Object”类。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:53:40.930

```
java.lang.IllegalArgumentException: object is not an instance of declaring class 
```

如果该方法没有参数并且在您的对象的类中找不到，则可以抛出此错误。可能您在错误的对象上调用调用方法，或者您获取的方法对于您的对象是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T04:11:27.437

> 问题是我需要分配的左侧是不同的类类型，并且该类类型将在运行时决定。...我怎样才能做到这一点？

使用 Java 以外的其他语言。Java 是静态类型的，这基本上意味着您不能完全按照您刚刚询问的方式去做。此处的其他答案正确显示了如何在编译时不知道对象类型的情况下调用方法，但是您永远无法在运行时设置变量的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:48:01.923

当一切设置正确时，它工作正常：

```
import java.lang.reflect.Method;

class Foo {

    public Foo() {
    }

    public void sayHello() {
        System.out.println("Hello");
    }
}

public class Test {    

    public static void main (String[] args) throws Exception {
        Class<?> clazz = Class.forName("Foo");
        Method method = clazz.getMethod("sayHello");
        Object instance = clazz.newInstance();

        method.invoke(instance); // Prints Hello
    }
} 
```

我的猜测是您获取的方法 ( `methodName`) 实际上并没有从`classToLoad`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:49:30.683

您也可以只转换返回类型并直接调用该方法。

```
public class Foo{
    void HelloReflection(){
        System.out.println("Hello reflection");
    }
    public static void main(String[] args){
        try{
            Foo o = (Foo) Class.forName("Foo").newInstance();
            o.HelloReflection();
        }catch(Exception e){
            e.printStackTrace();
        }
    }
} 
```

# asp.net - 防止在 asp:CommandField 中重复提交

> ID：15119729
> 
> 赞同：0
> 
> 时间：2013-02-27T18:39:42.547
> 
> 标签：asp.net, double-submit-prevention

有这个代码：

```
<asp:UpdatePanel ID="id">
 <asp:CommandField ButtonType="Image" InsertImageUrl="url/here" ShowInsertImage="true" ValidationGroup="valGr" />
</asp:UpdatePanel> 
```

如何防止在 C# 代码中双击此按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:59:51.043

您可以首先创建一个保存提交的标志并将其添加到表单中。然后在 UpdatePanel 进行更新并等待返回时打开和关闭该标志。

例如，此代码仅在以下 `fAlloToSubmit`情况下才允许提交表单（和 UpdatePanel） `true`：

```
<script>
    var fAlloToSubmit = true;

    function AllowFormToRun()
    {
      if(!fAlloToSubmit)
          alert("Please wait for the page to fully re-loaded.");

      return fAlloToSubmit;
    }
</script> 
```

并在您后面的代码上将其设置在表单上。

```
protected void Page_Load(object sender, EventArgs e)
{
   Page.Form.Attributes["onsubmit"] = "return AllowFormToRun();";
} 
```

现在对于 UpdatePanel，您在进行更新时打开该标志，例如，当您单击该命令时：

```
<script>
var prm = Sys.WebForms.PageRequestManager.getInstance();    
prm.add_initializeRequest(InitializeRequest);
prm.add_endRequest(EndRequest);

function InitializeRequest(sender, args) {
   // here is run when you click the command on the UpdatePanel      
   fAlloToSubmit = false;
}

function EndRequest(sender, args) {
   // here is come after the upadate of the command
   fAlloToSubmit = true;
}
</script> 
```

这里的诀窍是我持有要提交的表单，而不是查看页面上的每个控件来禁用它。

# fpga - 如何在 Ubuntu 下启动 Xilinx ISE Web Pack？

> ID：15119734
> 
> 赞同：9
> 
> 时间：2013-02-27T18:40:19.543
> 
> 标签：fpga, xilinx

我已经在 Ubuntu 12.10 上下载并成功安装了 Xilinx ISE Web Pack 14.4，尽管我无法启动它。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-28T09:50:59.543

嗯：它是 UNIX，所以有多种方法可以做到这一点。

其中之一是这个

1.  一些准备工作（只需要一次）

    ```
    $ cd .../14.4/ISE_DS
    $ chmod u+x *.csh *.sh 
    ```

2.  执行您可以在安装根目录中找到的正确设置脚本

    ```
    $ /path_to_the_installation_dir/14.4/ISE_DS/settings64.sh 
    ```

    对于 64 位的非 cshell 系统。

3.  运行 Xilinx 工具

    ```
    $ /path_to_the_installation_dir/14.4/ISE_DS/ISE/bin/lin64/ise
    $ /path_to_the_installation_dir/14.4/ISE_DS/ISE/bin/lin64/coregen
    $ /path_to_the_installation_dir/14.4/ISE_DS/EDK/bin/lin64/xps
    $ /path_to_the_installation_dir/14.4/ISE_DS/EDK/bin/lin64/xsdk 
    ```

如果您想要一个更好的系统，我建议您查看[模块](http://modules.sourceforge.net/)工具的 TCL 版本。

如何设置您的 Unix 环境以指向正确的许可证可以在Xilinx的[安装文档中找到。](http://www.xilinx.com/support/documentation/dt_ise14-4.htm)

# jwplayer - 我无法让 mediaelement.js 播放 AACP (AAC Plus) 音频

> ID：15119737
> 
> 赞同：4
> 
> 时间：2013-02-27T18:40:28.470
> 
> 标签：jwplayer, mediaelement.js, aac

我正在尝试让 mediaelement.js 与 AAC+ (HE-AACv1) 音频流一起使用。我通过在 WinAmp 中播放文件来验证流是否正常工作，但它不适用于 mediaelement.js。

我也尝试过 JW Player，但没有成功。我愿意切换到任何支持 AAC+ 的网络播放器。

MediaElement.js 代码：

```
<audio controls="controls" width="320" height="80">
  <source type="audio/aacp" src="http://xxx.xxx.xxx.xxx:8000/stream" />
</audio> 
```

Firefox 报错并显示无播放器：“不支持“audio/aacp”的指定“type”属性。加载媒体资源 xxx.xxx.xxx.xxx:8000/stream failed.site.com/ Line 0”

Chrome 会加载播放器并继续加载流，但从不播放音频。

JW播放器代码：

```
<script>
jwplayer("container").setup({
flashplayer: "player.swf",
height: "24",
width: "730",
file: "http://xxx.xxx.xxx.xxx:8000/stream",
controlbar: "bottom",
type: "sound",
bufferlength: "10",
autostart: "true"
});
</script> 
```

尽管播放器确实显示，但在带有 JW Player 的 Chrome 或 Firefox 中都没有播放任何内容。

我可以让 MediaElement.js 和 JW Player 与我们的 MP3 流一起使用，但我们希望摆脱 MP3。

演示链接： http: [//www.whro.org/allstreams/compare/](http://www.whro.org/allstreams/compare/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-15T17:05:07.340

这是一个迟到的回应，但也许它会帮助某人：

我实际上尝试在音频元素的源类型（而不是音频/aacp）中将类型伪装成音频/aac，并且它在能够播放 aac 流的设备上以纯 html5 解决方案工作（阅读：iPhone（ Safari)、iPad (safari+Chrome)、Blackberry(默认浏览器))。

这适用于 HE-AACv1 和 HE-AACv2 文件，但 v2 文件有时会出现声音故障。

# amazon-web-services - 确定 Amazon ELB 后面的客户端 IP 地址

> ID：15119739
> 
> 赞同：20
> 
> 时间：2013-02-27T18:40:30.070
> 
> 标签：amazon-web-services, locale, load-balancing

我们在 ELB 后面的 EC2 上有一些 PHP 服务器。我们想通过连接到我们服务器的客户端的 IP 地址来确定区域设置/区域。问题是 PHP 服务器只能看到 ELB 的 IP 地址。我们希望看到通过 ELB 的客户端的 IP 地址。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-27T19:20:31.367

根据[AWS 文档](http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/TerminologyandKeyConcepts.html#x-forwarded-for)，ELB 应该设置保留原始客户端 IP 地址的“X-Forwarded-For”HTTP 标头：

> X-Forwarded-For 请求标头可帮助您识别客户端的 IP 地址。由于负载均衡器拦截客户端和服务器之间的流量，因此您的服务器访问日志仅包含负载均衡器的 IP 地址。要查看客户端的 IP 地址，请使用 X-Forwarded-For 请求标头。

您可以使用以下 PHP 代码（假设为 apache）访问它：

```
$http_headers = apache_request_headers(); 
$original_ip = $http_headers["X-Forwarded-For"]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-03-12T14:21:18.177

如果您使用 Apache，请查看[mod_remoteip](http://httpd.apache.org/docs/trunk/mod/mod_remoteip.html)模块。它包含在 Apache 2.4 和更新版本中，但也可以找到 2.2 的反向移植。

> 该模块使用 RemoteIPHeader 指令配置的请求标头中报告的用户代理 IP 地址覆盖连接的客户端 IP 地址。
> 
> 一旦按照指示替换，此覆盖的用户代理 IP 地址将用于 mod_authz_host Require ip 功能，由 mod_status 报告，并由 mod_log_config %a 和 core %a 格式字符串记录。连接的底层客户端 IP 在 %{c}a 格式字符串中可用。

换句话说，您可以设置使用哪个标头（例如 X-Forwarded-For）以及哪些 IP 是可信的（例如您的负载平衡器）。受信任的 IP 从标头中删除，第一个不受信任的 IP 用作发起客户端。这个 IP 然后被 Apache 在内部用于其他模块，例如日志记录、主机身份验证等。

这使得它比只处理 PHP 中的 XFF 标头更有用，因为 mod_remoteip 负责整个堆栈，确保您的访问日志是正确的，等等。

注意：还有一个 mod_rpaf 模块，它是这个模块的前身。它的限制要多得多。例如，它无法处理受信任的 IP 范围。你需要这个，因为你事先不知道 ELB 的 IP。它也不能处理多个跃点，例如在 Varnish 之前的 ELB，在 Apache 之前。我建议跳过 rpaf 模块并改用 remoteip。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-17T11:44:24.210

这是一个大问题，所以试试这个：D

```
 <?php 
       if (!empty($_SERVER["HTTP_X_FORWARDED_FOR"])) {
            $real_client_ip = $_SERVER["HTTP_X_FORWARDED_FOR"];
        } else {
            $real_client_ip = $_SERVER["REMOTE_ADDR"];
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-31T04:16:29.547

对于某些人来说，mod_cloudflare 似乎是一个更好的选择——尤其是 v2.2 用户在这个小伙子的博客上阅读更多内容：http: [//knowledgevoid.com/blog/2012/01/13/logging-the-correct-ip-address-using- apache-2-2-x-and-amazons-elastic-load-balancer/](http://knowledgevoid.com/blog/2012/01/13/logging-the-correct-ip-address-using-apache-2-2-x-and-amazons-elastic-load-balancer/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-10T23:58:41.983

AWS ELB 背后的 PHP 应用程序的最佳解决方案：

```
if (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {
    $commaPos = strrchr($_SERVER['HTTP_X_FORWARDED_FOR'], ',');
    if ($commaPos === FALSE) $remote_addr = $_SERVER['HTTP_X_FORWARDED_FOR'];
    else $remote_addr = trim(substr($_SERVER['HTTP_X_FORWARDED_FOR'], $commaPos + 1));
} else {
    $remote_addr = $_SERVER['REMOTE_ADDR'];
} 
```

注意：[X-Forwarded-For](https://en.wikipedia.org/wiki/X-Forwarded-For#Format)可以是逗号分隔的代理列表，列表中的**最后**一个是连接到 AWS 的 ELB 的代理，因此我们可以相信它不会被欺骗。

# java - 批量插入是否仅因为 MySQL 驱动程序而不起作用？其他人呢？

> ID：15119742
> 
> 赞同：2
> 
> 时间：2013-02-27T18:40:36.220
> 
> 标签：java, hibernate

早些时候，我试图让批量插入在 Hibernate 中工作。我尝试了一切：对于配置，我设置了 batch_size(50)、order_inserts(true)、order_updates(true)、use_second_level_cache(false)、use_query_cache(false)。对于我使用的会话`setCacheMode(CacheMode.IGNORE)`和`setFlushMode(FlushMode.MANUAL)`. MySQL 查询日志仍然显示每个插入都是单独进入的。

唯一有效的是`rewriteBatchedStatements=true`在 JBDC 连接字符串中设置。这让我很担心，因为我的应用程序应该支持任何 JBDC 数据库，而我正试图避免特定于数据库的优化。

hibernate实际上不能使用批处理语句的唯一原因是因为MySQL驱动程序默认不支持它们吗？那么其他驱动程序呢，我是否必须向连接字符串添加选项，以便它们可以支持批量插入？如果您需要特定的数据库，请考虑 SQL server、sqlite、Postgres 等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T07:27:23.907

它无法工作的一个原因是，如果您使用`Identity`id 生成策略，hibernate 会禁用批处理。

此外，在不打开重写选项的情况下，MySQL 不像其他数据库那样支持 JDBC 批处理准备语句。

我不认为打开这个标志是个问题，如果你正在为不同的数据库设置你的应用程序，你将不得不更改诸如方言、驱动程序名称等设置，因为这是一部分的 JDBC 连接字符串，那么您将与配置隔离。

基本上我认为你在做正确的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T10:06:58.700

由于批量插入（或批量插入）是 SQL 标准的一部分，因此像 Hibernate 这样的 ORM 框架支持并实现它。请参阅[第 13 章。批处理](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/batch.html)和[Hibernate/MySQL 批量插入问题](https://stackoverflow.com/questions/2303152/hibernate-mysql-bulk-insert-problem)。

基本上，您需要通过命名的变量将 JDBC 批处理大小设置为`hibernate.jdbc.batch_size`合理的大小。也不要忘记用`flush()`and结束批处理事务`clear()`。

# assembly - 在 DOS (TASM) 上组装，在 int 21h 上使用新处理程序创建 TSR

> ID：15119745
> 
> 赞同：1
> 
> 时间：2013-02-27T18:40:40.293
> 
> 标签：assembly, x86, dos, tasm, tsr

我在为 DOS 制作 TSR com 文件时遇到了麻烦。它应该在第 21 个中断时设置一个新的处理程序，终止并保持驻留。新处理程序应将控制权转移到旧的中断 21h 处理程序。我保存了它的中断向量，但不知道如何正确调用它。这是一个程序：

```
.model tiny
.data
    old_int21h dw ?, ?
.code
org 100h
start:

    ;saving old interrupt vector
    mov ax, 3521h
    int 21h
    mov [old_int21h], bx
    mov [old_int21h + 2], es

    ;setting new interrupt vector
    cli
    push ds
    push cs
    pop ds
    lea dx, myint21h
    mov ax, 2521h
    int 21h
    pop ds
    sti

    ; TSR
    lea dx, start
    int 27h

myint21h proc
    ; doing something
    ; want to transfer control to an old interrupt 21h handler here. How?
    iret
myint21h endp

end start 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T05:18:12.707

我明白了这个问题。正确的解决方案就在这里。“正确”不确定“最佳”，但无论如何都很好用，现在优化这段代码还不够难。

```
.model tiny
.code
org 100h
start:

    ; saving old interrupt vector
    mov ax, 3521h
    int 21h
    mov [old_int21h], bx
    mov [old_int21h + 2], es

    ; setting new interrupt vector
    cli
    push ds
    push cs
    pop ds
    lea dx, myint21h
    mov ax, 2521h
    int 21h
    pop ds
    sti

    ; TSR
    mov dx, 00ffh
    mov ax, 3100h
    int 21h

    ; here comes data & hew handler part
    old_int21h dw ?, ?

    myint21h proc
                    ; some stuff
                    ; transfer control to an old interrupt 21h handler
        push word ptr [cs:old_int21h + 2] ; segment
        push word ptr [cs:old_int21h]     ; offset
        retf
    myint21h endp

end start 
```

下面的答案几乎是正确的:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:01:23.730

我的 16 位 DOS ASM 有点生疏，但如果我没记错的话，你需要这样做：

```
push word ptr [old_int21h + 2] ; segment
push word ptr [old_int21h]     ; offset
retf 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-02-12T14:16:18.480

```
 .model tiny
     .code
     org 100h
     start:

; Inicializando la fecha para LotusWorks
    mov ax, 2A21h
    int 21h
    mov [Reg_DX], dx
        sub cx,064h
    mov [Reg_CX], cx

; saving old interrupt vector
    mov ax, 3521h
    int 21h
    mov [old_int21h], bx
    mov [old_int21h + 2], es

; setting new interrupt vector

    cli
    push ds
    push cs
    pop ds
    lea dx, myint21h
    mov ax, 2521h
    int 21h
    pop ds
    sti

     ; TSR
    mov dx, 00ffh
    mov ax, 3100h
    int 21h

     ; here comes data & hew handler part

    old_int21h dw ?, ?
    Reg_DX     dw ?, ?
    Reg_CX     dw ?, ?

     myint21h proc

       cmp ah,2ah
       jne S1
           cmp al,56h
           je  S2
           mov ah,02h
           int 01AH
           cmp cx,0
           jne Mismodia
           mov ax,02A56h
           int 21h
      mov [CS:Reg_DX], dx

MismoDia:
       mov cx, [cs:Reg_CX]
       mov al,00
       mov dx, [cs:Reg_DX]
       iret

       S2:
           mov al,0

       S1:
        ; transfer control to an old
        ; interrupt 21h handler

        push word ptr [cs:old_int21h + 2]   ; segment
        push word ptr [cs:old_int21h]       ; offset
        retf
    myint21h endp

     end start 
```

# c++ - 对共享变量执行多个原子操作

> ID：15119748
> 
> 赞同：3
> 
> 时间：2013-02-27T18:40:49.700
> 
> 标签：c++, visual-c++, boost, concurrency, boost-thread

我想对一个共享变量做两个操作。我需要保证它可以原子地完成。有人可以帮助我澄清以下方法是否正确：

```
#include <atomic>
std::atomic<int> index;

void function()
{
     // I need the variable index to be incremented but bound in the 
     // range of [0,9].
     int loc_indx = index.load(std::memory_order_acquire);
     index.store( (loc_indx+1)%10  , std::memory_order_release);
} 
```

根据我的理解，索引存储操作和索引加载操作必须一起发生。这里的一些专家能否澄清上述代码是否等同于以下伪代码：

```
ATOMIC
{
   index = (index+1)%10;
} 
```

我一直在 Visual Studio 2012 的 c++ 部分或/和 1.53 的 boost::atomic 部分中使用 atomic 包。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:57:12.110

与锁相比，原子的全部目的是提高性能。

您的代码中没有锁。枚举只是为了`memory_order`确保编译器不会重新排序代码（也不让 CPU 重新排序）。这意味着其他线程修改 和 之间的值的可能性`load`很小`store`。如果存储的值必须依赖于先前的值，那么在两者之间进行的计算就被浪费了，需要重做。这样做可能比锁定更有效，因为并发修改实际发生的机会很低，并且计算便宜且简单。

当您知道先前的值时存储，否则重新计算并重试。就像是：

```
 int loc_index = index.load(std::memory_order_acquire);
 int desired = (loc_index+1)%10;

 while ( !index.compare_exchange_strong( loc_index, desired ) )
 {
     desired = (loc_index+1)%10;
 } 
```

`compare_exchange_strong``index`是将存储的值与进行比较的原子操作`loc_index`；如果它们相等，则存储`desired`到`index`; 如果它们不相等，它将复制`index`into的值`loc_index`。这可以帮助您确保存储的下一个值`index`是正确的。

# css - z-index 在 IE8 中不起作用。为什么？

> ID：15119749
> 
> 赞同：1
> 
> 时间：2013-02-27T18:40:50.200
> 
> 标签：css, internet-explorer-8, z-index, pseudo-element

我正在尝试使用纯 css 设置组合框的样式，并找到一些教程并创建了组合框。它在 chrome 和 firefox 上运行良好。

请看一下我创建的样式。

[http://jsfiddle.net/SnU3d/1](http://jsfiddle.net/SnU3d/1/)

```
label
{
    position:relative;
    z-index:9999;
}

label:after 
{
    content:'?';
    font:11px "Consolas", monospace;
    color:#009FDF;
    font-size:120%;
    pointer-events:none;
    background: #fff;
    border:1px solid #999;
    width:30px;
    height:24px;
    margin-bottom:2px;
    position:absolute;
    border-left:0px;
    right:-1px;
    z-index:99;
} 
```

我发现了一些关于这个的其他教程。[IE7 / IE8 z-index 问题](https://stackoverflow.com/questions/1466695/ie7-ie8-z-index-problem)，[请在此处输入链接描述](https://stackoverflow.com/questions/1290191/z-index-broken-in-ie8)。

所以我为父标签设置了更高的zindex值。但是之后的伪元素仍然没有出现在IE8中。为什么 ？如何使之后的内容可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-12T11:42:54.273

`:after`伪元素创建您应用它的元素的子元素 ( ) `Label`，并且您分配给父元素 () 的 z-index 值`label`，无论该值是什么，都会在该元素内创建一个新的堆叠上下文，因此您最终得到`label`其堆叠上下文的第 9999 层中`label:after`的父元素`label`（

# c# - 如何在 C# 交互窗口的 app.config 中设置通常定义的开关？

> ID：15119750
> 
> 赞同：3
> 
> 时间：2013-02-27T18:40:52.307
> 
> 标签：c#, .net, exception, roslyn

我正在尝试使用 C# Interactive REPL（来自 Roslyn）加载 DLL。它抛出以下异常：

> “尝试从网络位置加载程序集，这会导致程序集在以前版本的 .NET Framework 中被沙盒化。此版本的 .NET Framework 默认情况下不启用 CAS 策略，因此此加载可能很危险。如果此加载不打算对程序集进行沙箱处理，请启用 loadFromRemoteSources 开关。有关 详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=155569 。](http://go.microsoft.com/fwlink/?LinkId=155569)

DLL 不在网络位置，所以我不知道为什么会抛出这个异常。无论如何，没有 app.config 文件供我修改（据我所知），所以有人知道我该如何解决这个错误吗？

更新：

我已经[解除](http://msdn.microsoft.com/en-us/library/ee890038%28v=vs.100%29.aspx)了对程序集的阻止，这使得这个异常消失了。但我仍然想回答更一般的问题，即如何在 C# 交互窗口的 app.config 中设置通常定义的开关？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:08:29.453

有问题的程序集在您尝试加载它时不需要位于网络位置。您看到的消息是警告您尝试加载的程序集（在某些时候）是从 Internet 下载的，并且当前标记为不受信任。

对于您的元问题，大多数配置设置映射到一个或多个代码结构（API、属性等），允许您以编程方式根据需要调整设置。如何修改特定设置取决于设置及其影响的 API。在某些情况下，您可能需要编写代码来配置运行时，在其他情况下，您可能需要配置 IIS、日志记录和跟踪、WCF 端点等。

如果您阅读上面链接的文章，您会发现以下内容：

> 如果应用程序是从 Web 复制的，Windows 会将其标记为 Web 应用程序，即使它驻留在本地计算机上也是如此。您可以通过更改文件属性来更改该名称，也可以使用该元素授予程序集完全信任。作为替代方案，您可以使用[UnsafeLoadFrom](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.unsafeloadfrom%28v=vs.100%29.aspx)方法加载操作系统已标记为已从 Web 加载的本地程序集。

通常，使用 UnsafeLoadFrom 可能比让您的应用程序从不受信任的来源下载任意程序集并让它在您的应用程序内以完全信任的方式运行更安全。

文档继续说：

> 此元素通常在应用程序配置文件中使用，但可以根据上下文在其他配置文件中使用。有关详细信息，请参阅 .NET 安全博客中的文章更多隐式[使用 CAS 策略：loadFromRemoteSources](http://blogs.msdn.com/b/shawnfa/archive/2009/06/08/more-implicit-uses-of-cas-policy-loadfromremotesources.aspx)。

仔细阅读后一个文档 - 它说明了您需要编写的代码以实现与设置 loadFromRemoteSources 配置标志相同的结果：但是，不要低估将任意代码加载到您的应用程序中的危险！

# python - 如何将新的 QProgressbar 添加到现有窗口？

> ID：15119751
> 
> 赞同：0
> 
> 时间：2013-02-27T18:40:52.743
> 
> 标签：python, multithreading, pyqt

我想创建一个进度条指示进度的文件复制程序。现在，如果我开始 n 次复制/粘贴操作，应该会像 Windows 8 那样显示许多进度条。

该程序应该像一个窗口，比如“SHOW”，正在显示 QProgressbar 以进行第一次操作的复制/粘贴。当 2 次复制/粘贴将在第一次完成之前开始时，第二个 QProgressbar 将添加到 SHOW 中，因此 SHOW 中将有 2 个进度条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:51:47.243

好吧，创建一个布局（我想是垂直布局），然后创建您需要的尽可能多的 QProgressbar 并使用 addWidget 将它们添加到您的布局中，就是这样。

如果您需要滚动，请尝试使用 QScrollArea。

# c - K&R 练习 1.16 - 行长限制

> ID：15119756
> 
> 赞同：19
> 
> 时间：2013-02-27T18:41:17.437
> 
> 标签：c, kernighan-and-ritchie, c89

我正在从 K&R 的“ [The C Programming Language](http://en.wikipedia.org/wiki/The_C_Programming_Language) ”一书中学习 C。我正在做书中指定的练习。我在练习 1.16，但我不明白。

练习 1.16：

> 修改最长行程序的主程序，使其正确打印任意长输入行的长度，并尽可能多地打印文本。

我的问题：

1.  “......尽可能多的文本......” - 字符串长度是否有一些限制？也许在标准标题中有一个具有最大允许字符串长度值的变量？

2.  “......任意长输入行的长度......” - 但在代码中 MAXLINE 定义为 1000。它的大小也有限。[我在这里](http://clc-wiki.net/wiki/K&R2_solutions%3aChapter_1%3aExercise_16)看到了一些解决方案，但在我看来，这不是解决方案决定，因为前者对行的长度有限制（1000 个字符）。

也许我不明白这个任务。我的理解是我必须取消 1000 个字符的限制。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-27T18:57:29.710

这是 K&R 中的一个相当早的练习，您只应该对代码进行一些小的更改，而不是对代码进行全面的重新设计。

1.  > “……尽可能多的文字……”

    由你来解释。我会通过打印`longest`缓冲区中存储的内容来做到这一点。即打印出最多 1000 个字符的行。同样，这是一个早期练习，还很少介绍动态分配的内存。在编写 K&R 时，存储任意长的文本行并不像今天那样可行。

2.  > “......任意长的输入行的长度......”

    是硬性要求。无论长度有多长，您都应该找到正确的长度（至少在 . 的范围内`int`）

解决此问题的一种方法是：

*   调用 getline() 后，检查读入`line`缓冲区的最后一个字符是否为换行符（'\n'）
*   如果是，您阅读了完整的一行。该`len`变量是行的正确长度（getline() 的返回值，与原始代码相比无需特殊考虑。
*   如果*不是*，则说明您没有阅读整行，需要寻找这一行的结尾。您添加一个 while 循环，调用 getchar() 直到它返回一个换行符（或 EOF），然后计算您在该循环中读取的字符数。只是做`len++`数。
*   当 while 循环完成时，new`len`现在是行的实际长度，但我们的缓冲区只有它的前 999 个字符。
*   `line`和以前一样，如果该行是迄今为止最长的，则存储（copy() 函数调用）当前缓冲区（最多 1000 个字符）。
*   完成后，像以前一样打印出存储的行（`longest`缓冲区）和`max`长度变量。
    *   由于上面提到的 while 循环，`max`长度现在是正确的。
    *   如果该`longest`行确实超过 1000 个字符。您至少打印出前 999 个字符 - 这是“尽可能多”。

我不会剧透并发布完成此任务所需的代码，但您只需将 6 行代码添加到练习 1-16 的最长行程序中即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:46:40.300

1.  在现代机器上，“尽可能多的文本”可能是所有的文本，这要归功于自动换行的终端程序。那本书是在电传终端还在使用时写的。除了您正在使用的机器的内存限制之外，字符串长度没有限制。

2.  他们希望您添加某种循环来读取字符并查找换行符，而不是假设读取到已`MAXLINE`调整大小的缓冲区肯定会包含换行符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-13T11:28:58.180

这是我的版本：

```
int getline(char s[],int lim)
{
    int c,i;
    for(i=0;i<lim-1&&(c=getchar())!=EOF&&c!='\n';++i)
        s[i]=c;
    if(c=='\n')
    {
        s[i]=c;
        ++i;
    }
    if(c!=EOF)
    {
        while((c=getchar())!=EOF&&c!='\n')
            i++;
    }
    s[i]='\0';
    return i;
}
    #define MAXLINE 1000
    int len;
    int max;
    char line[MAXLINE];
    char longest[MAXLINE];

    max=0;
    while((len=getline(line,MAXLINE))>1)
    {
        if(len>max)
        {
            max=len;
            copy(longest,line);
        }
    }
    if(max>0)
    {
        printf("%d:%s",max,longest);
    }
    return 0; 
```

由于一些未知的原因，示例代码在我的电脑上特别不起作用，当条件为'len>0'时，循环不会结束我认为主要原因是当你什么都不输入时，但你仍然必须按回车，所以接收为'\n'，len为1；我认为它满足了打印任意长输入行的长度以及尽可能多的文本的要求。 [它像这样工作](https://i.stack.imgur.com/gfIEx.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-15T08:56:11.687

```
 #include

    main()
    {
       long tlength = 0;
       short input, llength = 1;
       while (llength > 0)  {
          llength = 0;
          while ((input = getchar()) != EOF) {
              ++llength;
              if (input == '\n')
              break;
          }
          tlength = tlength + llength;
          printf("\nLength of just above line : %5d\n\n", llength);
       }
       printf("\n\tLength of entire text : %8ld\n", tlength);
       return 0;
    } 
```

据我说，这个问题只需要任意行的长度+最后是整个文本的长度。

尝试运行此代码并根据问题告诉我它是否正确，因为我对这个问题也感到困惑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-07T01:31:40.183

我想提出这个练习实际上更有意义，如果想象你可以复制的字符数的限制非常小——比如 100 个字符——并且你的程序应该在比这更长的行之间进行判断限制。

（如果您实际上将限制更改为非常小，则代码变得更容易测试：如果它挑选出达到该小限制的第一行，您就会知道您的代码没有工作，而如果它返回第一行但是-最长行的许多字符，它正在工作。）

保留复制和计算字符的代码部分，直到它遇到换行符或 EOF 或行大小限制。添加代码，在此计数和复制停止的地方拾取，并且即使在复制停止后仍会继续计数，只要 getchar() 仍然没有返回 EOF 或换行符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-15T12:18:01.287

我的解决方案：就在对 getLine 的调用下方

```
if ( line[len-1] != '\n' && line[len-1] != EOF) //if end of line or file wasnt found after max length
{
    int c;
    while ( ( c = getchar() ) != '\n' && c != EOF ) 
        len++; //keep counting length until end of line or file is found
} 
```

为了测试它，将 MAXLINE 更改为 25

# node.js - 在 Express 中处理 robots.txt 的最聪明方法是什么？

> ID：15119760
> 
> 赞同：79
> 
> 时间：2013-02-27T18:41:40.600
> 
> 标签：node.js, express, robots.txt

我目前正在开发一个使用 Express (Node.js) 构建的应用程序，我想知道为不同环境（开发、生产）处理不同 robots.txt 的最聪明方法是什么。

这就是我现在所拥有的，但我不相信解决方案，我认为它很脏：

```
app.get '/robots.txt', (req, res) ->
  res.set 'Content-Type', 'text/plain'
  if app.settings.env == 'production'
    res.send 'User-agent: *\nDisallow: /signin\nDisallow: /signup\nDisallow: /signout\nSitemap: /sitemap.xml'
  else
    res.send 'User-agent: *\nDisallow: /' 
```

（注意：它是 CoffeeScript）

应该有更好的方法。你会怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-11-28T11:36:18.507

使用中间件功能。这样，robots.txt 将在任何会话、cookieParser 等之前处理：

```
app.use('/robots.txt', function (req, res, next) {
    res.type('text/plain')
    res.send("User-agent: *\nDisallow: /");
}); 
```

现在使用 express 4`app.get`以它出现的顺序进行处理，因此您可以使用它：

```
app.get('/robots.txt', function (req, res) {
    res.type('text/plain');
    res.send("User-agent: *\nDisallow: /");
}); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-11-05T13:39:32.090

## 1.`robots.txt`使用以下内容创建：

```
User-agent: *
Disallow: # your rules here 
```

## 2\. 将其添加到`public/`目录。

## 3\. 如果您的代码中尚未出现，请添加：

```
app.use(express.static('public')) 
```

您`robots.txt`将可用于任何爬虫，网址为`http://yoursite.com/robots.txt`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T19:55:22.420

看起来不错的方式。

另一种方法是，如果您希望能够以`robots.txt`常规文件的形式进行编辑，并且可能拥有仅在生产或开发模式下需要的其他文件，则可以使用 2 个单独的目录，并在启动时激活其中一个。

```
if (app.settings.env === 'production') {
  app.use(express['static'](__dirname + '/production'));
} else {
  app.use(express['static'](__dirname + '/development'));
} 
```

然后为每个版本的 robots.txt 添加 2 个目录。

```
PROJECT DIR
    development
        robots.txt  <-- dev version
    production
        robots.txt  <-- more permissive prod version 
```

您可以继续在任一目录中添加更多文件并保持代码更简单。

（对不起，这是javascript，不是coffeescript）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-20T09:30:34.427

这是我使用的

```
router.use('/robots.txt', function (req, res, next) {
  res.type('text/plain')
  res.send(
    `User-agent: *
     Disallow: /admin`);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-31T05:28:35.240

使用中间件方式根据环境选择 robots.txt：

```
var env = process.env.NODE_ENV || 'development';

if (env === 'development' || env === 'qa') {
  app.use(function (req, res, next) {
    if ('/robots.txt' === req.url) {
      res.type('text/plain');
      res.send('User-agent: *\nDisallow: /');
    } else {
      next();
    }
  });
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-13T14:29:22.487

这就是我在索引路线上所做的。你可以简单地在你的代码中写下我在下面给出的内容。

```
router.get('/', (req, res) =>
    res.sendFile(__dirname + '/public/sitemap.xml')
)

router.get('/', (req, res) => {
    res.sendFile(__dirname + '/public/robots.txt')
}) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-06T14:20:56.333

我使用 robots.txt 作为 Prod 的普通文件，以及其他环境的中间件。

```
if(isDev || isStaging){
    app.use('/robots.txt', function (req, res) {
        res.type('text/plain');
        res.send("User-agent: *\nDisallow: /");
    });
}
app.use(express.static(path.join(__dirname, 'public'))); 
```

# java - 将数字添加到数组的中点

> ID：15119761
> 
> 赞同：-5
> 
> 时间：2013-02-27T18:41:40.373
> 
> 标签：java, arrays, loops

如何将一个数字添加到数组的中点（没有数组列表），这样不会覆盖任何数字，但最后一个数字不会出现在数组中。我的代码：

```
 int midpoint = length/2;
 array[midpoint] = 4;
 for (int i = midpoint; i < array.length -1; i++)
 {
     array[i] = array[i+1];
 }          
 displayArray(array); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:45:34.007

将所有项目从中点向右移动，然后添加中点。

如果我是你，我会反向迭代。

```
for (int i = array.length - 1; i > midpoint; i--)
{
    array[i] = array[i-1];
}

array[midpoint] = somenumber 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:46:20.497

您可以使用[`System.arraycopy()`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)有效地移动元素：

```
System.arraycopy(array, midpoint, array, midpoint + 1, array.length - midpoint - 1);
array[midpoint] = 4; 
```

您当前方法的问题是您在将元素移动到最终位置之前无法挽回地修改它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:47:01.997

采用

```
int midpoint = array.length/2;

for (int i = array.length-1 ; i> midpoint; i--) { 
  array[i] = array[i-1]; 
}

array[midpoint] = 4; 
displayArray(array); 
```

# objective-c - 共享 AdBannerView 和动画过渡的 iAD 最佳实践

> ID：15119766
> 
> 赞同：1
> 
> 时间：2013-02-27T18:42:00.557
> 
> 标签：objective-c, views, iad, shared, adbannerview

我有一个全局 ADBannerView，我在我的大多数顶级视图中都显示了它。当每个视图加载时，它会在广告横幅上执行 -removeFromSuper，然后将其添加为子视图。

但是，当从一个顶级视图动画到另一个视图时，这会导致广告在过渡开始之前突然从离开的视图中消失。

我也尝试过使用 viewWillAppear/Disappear，但在每种情况下，它们似乎都没有在适当的时间被调用来删除/添加横幅。

我认为让 ADBannerView 的视图同时属于两个不同顶级视图的子视图是一件非常糟糕的事情。

唯一想到的另一件事是在过渡发生之前为广告制作动画。不过，队列中的另一个动画会有点痛苦，而且似乎是一个被误导的解决方案。

是否有任何其他相当简单和优雅的方式来在涉及转换的顶级视图之间共享广告横幅？

# jquery - 无法计算隐藏 div 的宽度

> ID：15119774
> 
> 赞同：8
> 
> 时间：2013-02-27T18:42:17.483
> 
> 标签：jquery, css

**由下面的 VEGA 解决。[这是工作的小提琴。](http://jsfiddle.net/JonMoore/dELNa/14/)**我将整个帖子保留下来，以供将来的访问者查看此问题是如何解决的。

* * *

我正在尝试创建一个按钮，当悬停时，它会在下面的抽屉上显示一些信息。

我想让它易于实现到一个页面中，所以我把它变成了一个 jQuery 小部件。我想让它根据按钮和/或抽屉上的内容进行调整，**但现在没有这样做。**用户应该能够将单个 HTML div 标记与隐藏数据一起放置，这样就可以工作了。

理想情况下，按钮/抽屉宽度将调整到两者之间的最大值，以便抽屉在关闭状态时完全隐藏。我只是不希望我的用户不得不设置固定宽度。

我需要帮助！

这是它的样子：

![在此处输入图像描述](../Images/d18f59a0f91a571f47c0e09cda1485d8.png)

![在此处输入图像描述](../Images/61812933f12d804df3dad88c621b19bc.png)

**相关 HTML（[Fiddle](http://jsfiddle.net/JonMoore/dELNa/9/)中的完整 HTML ）：**

```
<div class="download" data-value="It's awesome!">Visit Website</div> 
```

**相关 CSS（[Fiddle](http://jsfiddle.net/JonMoore/dELNa/9/)中的完整 CSS ）：**

```
.button {
    position:absolute;
    padding:10px;
}

.drawer {
    box-sizing:border-box;
    z-index:-1;
    position:absolute;
    top:3px;
    left:3px;
    padding:6px 10px;
    text-align:center;
    -webkit-transition:0.3s left ease-in;

} 
```

**相关 jQuery（[Fiddle](http://jsfiddle.net/JonMoore/dELNa/9/)中的完整 jQuery ）：**

```
$(function() {
    $(".button").each(function() {
        $(this).append("<div class='drawer'>" +  $(this).data('value') + "<div class='handle'>||</div></div>");
        $(".drawer", this).css("width", $(".button").width());
    });

    $(".button").mouseenter(function() {
        $(".drawer", this).css("left", $(".button").outerWidth());
    }).mouseleave(function() {
        $(".drawer", this).css("left", "3px");
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:51:51.420

您必须根据`this`按钮计算宽度。见下文，

```
$(function() {
    $(".button").each(function() {
        $(this).append("<div class='drawer'>" +  $(this).data('value') + "<div class='handle'>||</div></div>");
        $(".drawer", this).width($(this).width()); //updated with this object
    });

    $(".button").mouseenter(function() {
        $(".drawer", this).css("left", $(this).outerWidth()); //updated with this object
    }).mouseleave(function() {
        $(".drawer", this).css("left", "3px");
    });
}); 
```

**演示：http:** [//jsfiddle.net/dELNa/11/](http://jsfiddle.net/dELNa/11/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:52:23.007

```
$(".download").mouseenter(function() {
    totalWidth = 0;
    totalWidth  += $(this).outerWidth(true);
    $(".drawer", this).css("left", totalWidth);
}).mouseleave(function() {
    $(".drawer", this).css("left", "3px");
}); 
```

这将得到对象的最终大小加上里面美味内容的值。

# json - 我需要一个用于 JSON 数据库的网络服务器吗？

> ID：15119775
> 
> 赞同：-3
> 
> 时间：2013-02-27T18:42:17.513
> 
> 标签：json, webserver, virtual-machine, dart

我正在使用 Dart 和 JSON 编写数据库。所以我的问题是：
当我想运行我的应用程序时，我是否必须在我的 PC 上运行一个真正的网络服务器？如果是，你会推荐什么样的程序，应该将它打包在虚拟机中？
提前致谢！
卡尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:29:44.520

Dart VM 可以在命令行上运行，并且它具有内置的 Web 服务器。你可以在 Linux、Mac 和 Windows 上运行 Dart VM。除非您提供更多细节，否则我无法进一步回答。

# meteor - 无法从 MeteorJS 中的客户端调用 Meteor.call？

> ID：15119778
> 
> 赞同：2
> 
> 时间：2013-02-27T18:42:29.827
> 
> 标签：meteor

使用流星 0.5.7 - 遵循缔约方示例 - 创建客户端、服务器文件夹，并将各自的 client.js 和 server.js 文件放置在其中。我已自动发布、删除不安全并添加了电子邮件包。我无法让 Meteor.call 启动，调试表明它被绕过了，我松散地遵循这个 - [http://goo.gl/MV26m](http://goo.gl/MV26m) - 我仍然不明白。

```
// server.js
Meteor.startup(function () {
  process.env.MAIL_URL = '...'; // using mailgun URL
});

Meteor.methods({
   call_me: function (options) {
     var options = options || {};
     Email.send({
      from: options.from,
      to: options.to,
      replyTo: options.from || undefined,
      subject: options.subj,
      text: options.msg,
     });
   },
});

// client.js
Template.form.events({
 'click .submit' : function (event, template) {
   var from = template.find("#from").value;
   var to = template.find("#to").value;
   var subj = template.find("#subj").value;
   var msg = template.find("#msg").value;
   var options = { from: from, to: to, subj: subj, msg:msg };

   Meteor.call('call_me', options, function(err, data) {
    if (err)
     console.log(err);
   });
 }
});

// client.html - the gist of it
<body>
  {{> page }}
</body>
<template name="page">
  {{> form }}
</template>
<template name="form">
  <form ....
</template> 
```

最后，我实际上有 Meteor.methods({...}); 坐在客户端/服务器文件夹之外的 model.js 文件中 - 它仍然没有触发电子邮件，或调用 Meteor.call 方法。我有点想把头放在前面提到的附加链接中的存根概念上，将调用包装在一个函数中并调用它，但我仍然没有得到任何活动。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T05:02:12.730

试过你的要点。删除`<form>`标签并注释掉`Process.env.MAIL_URL`就可以了。该`<form>`标签阻止事件触发按钮单击。

# file-io - 从 VBScript FileSystemObject 访问网络共享

> ID：15119783
> 
> 赞同：0
> 
> 时间：2013-02-27T18:42:41.960
> 
> 标签：file-io, vbscript, shared-directory

我想通过基本工作组上的网络共享将特定文件从我的桌面复制到我的笔记本。当我运行此脚本时，来自 DestinationFolder2 的文件成功复制；但是，DestinationFolder 中的文件只是间歇性地复制，有时会返回错误“找不到路径，第 40 行，第 7 列（指 * fso.CopyFolder SourceFolder，“\Resource\Desktop”，True）”。有什么建议么？

```
 ServerShare = "\\Resource\Desktop"
    ServerShare2 = "\\Resource\Documents and Settings\User\SendTo"

    Set NetworkObject = CreateObject("WScript.Network")
    Set FSO = CreateObject("Scripting.FileSystemObject")

    NetworkObject.MapNetworkDrive "", ServerShare, False, UserName, Password
    NetworkObject.MapNetworkDrive "", ServerShare2, False, UserName, Password

    Set Directory = FSO.GetFolder(ServerShare)
    For Each FileName In Directory.Files
        WScript.Echo "Files Copied: ", FileName.Name
    Next

    Set Directory = FSO.GetFolder(ServerShare2)
    For Each FileName In Directory.Files
        WScript.Echo "Files Copied2: ", FileName.Name
    Next

    Set FileName = Nothing
    Set Directory = Nothing
    Set FSO = Nothing

    NetworkObject.RemoveNetworkDrive ServerShare, True, False
    NetworkObject.RemoveNetworkDrive ServerShare2, True, False

    Set ShellObject = Nothing
    Set NetworkObject = Nothing

    Const DestinationFolder = "\\Resource\Desktop"
    Const DestinationFolder2 = "\\Resource\Documents and Settings\User\SendTo"
    Const SourceFolder = "C:\Documents and Settings\User.MACHINE\Desktop"
    Const SourceFolder2 = "C:\Documents and Settings\User.MACHINE\SendTo"

    Set fso = CreateObject("Scripting.FileSystemObject")
        'Check to see if the file already exists in the destination folder
        If fso.FolderExists(DestinationFolder) Then
            'Check to see if the file is read-only
            If Not fso.GetFolder(DestinationFolder).Attributes And 1 Then 
                'The file exists and is not read-only.  Safe to replace the file.
                fso.CopyFolder SourceFolder, "Resource\Desktop", True
            Else 
                        'The file exists and is read-only.
        'Remove the read-only attribute
                fso.GetFolder(DestinationFolder).Attributes = fso.GetFolder        (DestinationFolder).Attributes - 1
                'Replace the file
                fso.CopyFolder SourceFolder, "\\Resource\Desktop", True
                'Reapply the read-only attribute
                fso.GetFolder(DestinationFolder).Attributes = fso.GetFolder        (DestinationFolder).Attributes + 1
            End If
        Else
            'The file does not exist in the destination folder.  Safe to copy file to         this folder.
            fso.CopyFolder SourceFolder, "\\Resource\Desktop", True
        End If

        If fso.FolderExists(DestinationFolder2) Then
            'Check to see if the file is read-only
            If Not fso.GetFolder(DestinationFolder2).Attributes And 1 Then 
                'The file exists and is not read-only.  Safe to replace the file.
                fso.CopyFolder SourceFolder2, "Resource\Documents and Settings\User\SendTo", True
            Else 
                'The file exists and is read-only.
                'Remove the read-only attribute
                fso.GetFolder(DestinationFolder2).Attributes = fso.GetFolder        (DestinationFolder2).Attributes - 1
                'Replace the file
                fso.CopyFolder SourceFolder2, "Resource\Documents and Settings\User\SendTo", True
                'Reapply the read-only attribute
                fso.GetFolder(DestinationFolder2).Attributes = fso.GetFolder        (DestinationFolder2).Attributes + 1
            End If
        Else
            'The file does not exist in the destination folder.  Safe to copy file to         this folder.
            fso.CopyFolder SourceFolder2, "\\Resource\Documents and Settings\User\SendTo", True
        End If
    Set fso = Nothing 
```

# java - 语音转文本时如何只返回一个结果？

> ID：15119785
> 
> 赞同：1
> 
> 时间：2013-02-27T18:42:49.900
> 
> 标签：java, android, speech-recognition, voice-recognition

当通过 Chrome 的 HTML 5 语音输入支持使用 Google 的服务器进行语音识别时，您每次得到大约 6 个结果，即用户语音音频的 6 种可能解释。我只想要一个结果，我该怎么做？

这是我的代码：

```
 package com.emanrox.tutorialbasics12;

    import java.util.ArrayList;

    import android.app.Activity;
    import android.content.Intent;
    import android.os.Bundle;
    import android.speech.RecognizerIntent;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.ArrayAdapter;
    import android.widget.Button;
    import android.widget.ListView;

    public class Voice extends Activity implements OnClickListener {

ListView lv;
static final int check = 1111;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.voice);
    lv = (ListView)findViewById(R.id.lvVoiceReturn);
    Button b = (Button)findViewById(R.id.bVoice);
    b.setOnClickListener(this);

}

@Override
public void onClick(View arg0) {
    // TODO Auto-generated method stub
Intent i = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
i.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,                   RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
i.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speak up son!");
startActivityForResult(i, check);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            // TODO Auto-generated method stub
if (requestCode == check && resultCode == RESULT_OK){
    ArrayList<String> results = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
    lv.setAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1,results));

}

    super.onActivityResult(requestCode, resultCode, data);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:53:28.387

也许将[MAX_RESULTS 额外](http://developer.android.com/reference/android/speech/RecognizerIntent.html#EXTRA_MAX_RESULTS)设置为`1`.

我不确定您的代码与 Chrome HTML 5 语音输入之间的关系是什么。为什么你不能直接丢弃额外的结果？有时，服务更容易提供多个结果，然后客户必须对它们进行后处理......

# c# - 在 cshtml 中激活 IsPost 时的不同调用

> ID：15119786
> 
> 赞同：3
> 
> 时间：2013-02-27T18:42:50.050
> 
> 标签：c#, html, forms, razor

如何在 cshtml 中调用不同的回发？

```
@{
    Page.Title = "";
    Layout = "~/_Layout.cshtml";

    if(IsPost)
    {
        // if btn1 is pressed do this

        // if btn2 is pressed do this
    }
}

<div>
    <form action="" method="post">
        <input type="submit" value="btn1" />
    </form>

    <form action="" method="post">
        <input type="submit" value="btn2" />
    </form>
</div> 
```

有没有办法判断哪个被按下？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T19:28:53.407

您需要为按钮提供一个“名称”属性，以便它们注册为提交表单的一部分，并且您可以使用该值确定提交的按钮。

```
@{
    if ( IsPost ) {
       switch ( Request.Form[ "btn" ] ) {
          case "btn1":
              <h2>It was btn1</h2>
              break;
        case "btn2":
              <h2>It was btn2</h2>
              break;
      }
   }
}
<div>
    <form method="post">
        <input type="submit" name="btn" value="btn1" />

        <input type="submit" name="btn" value="btn2" />
    </form>
</div> 
```

# php - 在 MySQL 和 PHP 中管理图像

> ID：15119787
> 
> 赞同：0
> 
> 时间：2013-02-27T18:42:51.493
> 
> 标签：php, html, mysql

我正在设计一个网站，用户可以在其中发送他们拍摄的其他用途照片。我已经设置了 MySQL 和 PHP 页面来让用户注册、登录等，但我的问题是，我需要做什么才能让用户上传分配给其他用户的图像？我正在考虑为所有图像设置 ID，然后某些用户可以访问图像的特定 ID。任何信息表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:47:20.187

根据此处的信息，您可能需要以下设置：

表：

```
userrelationship(userid, friendid)

images(id, imagepath, userid)

sharedimages(id, originaluserid, friendid, imageid) 
```

这是真正的基础，但它应该让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:45:51.100

我会去做这样的事情

```
table - images
image_id | image_source | image_from | image_to
    1      source of img   user id     user id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:50:04.747

您有多种选择，您可以自行决定如何实现它。

第一个选项：让他们上传照片，为其分配/重命名唯一的哈希或 ID，将其放入与用户关联的表中：

```
id | hash | user_id 
```

第二种选择：您始终可以将图像作为 blob 存储在 MySQL 数据库中，但这可能会很麻烦，因为您可能需要更多信息。

```
id | blob (base64 encoded data) | name | extension | user_id 
```

其余选项介于两者之间。基本上，只为图像设置表，如果要添加权限，请将其放在单独的表中，当用户尝试访问它时，只需检查图像所有者权限：

```
user_id | permissions 
```

如果图像所有者只想让他们自己查看图片，请添加该权限类型，或者如果他们想要朋友、朋友或朋友或任何人，您可以创建这些单独的权限标志。

现在，如果您正在寻找每个图像的权限，那么您需要将权限字段附加到图像表。同样，您可以将两者结合起来，如果图像表中的权限字段为空，您可以使用用户的默认权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:58:35.387

我的回答将与上述任何一个用户的不同。

```
table - image
id (primary) | source | date_added | etc...
int            varchar  int(10)

table - user
id (primary) | date_added | name
int            int(10)      varchar

table - user_image
user_id (primary) | image_id (primary) | date_added | permissions
int                 int                  int(10)      int 
```

基本上，有一个用户表和一个图像表。然后，有一个表来定义用户图像对。这样，您可以将图像和用户分开并在它们之间创建链接。在表中创建新行以`user_image`向其他用户授予图像访问权限，并使用该`permissions`列准确控制这些用户在控制这些图像方面的权限。

这是一个非常灵活的系统。希望有帮助吗？

# c# - DefaultTraceListener 的性能影响

> ID：15119791
> 
> 赞同：8
> 
> 时间：2013-02-27T18:43:02.227
> 
> 标签：c#, performance, trace, system.diagnostics

使用跟踪时，在**发布**模式下不删除**生产**ASP.NET 应用程序`System.Diagnostics`上的“默认”跟踪侦听器是否有显着（可测量的）性能影响，常量在编译时定义但在运行时没有附加调试器？****`TRACE`****

 ****澄清一下，问题是关于“默认”跟踪侦听器对使用其他跟踪侦听器的应用程序的额外影响，而不是 System.Diagnostics 跟踪的替代方案。

当没有附加调试器时，是否有任何衡量默认跟踪侦听器影响的措施？是否已经对从代码中省略“删除”元素的生产影响进行了任何基准测试，例如：

```
<configuration>
<system.diagnostics>
  <trace autoflush="false" indentsize="4">
    <listeners>
      <remove name="Default" />
      <add name="myListener"  type="System.Diagnostics.TextWriterTraceListener"    initializeData="c:\myListener.log" />
    </listeners>
  </trace>
</system.diagnostics>
</configuration> 
```

这个问题与[.NET Tracing 不同：什么是“默认”侦听器？](https://stackoverflow.com/questions/8010255/net-tracing-what-is-the-default-listener)从某种意义上说，其他问题的重点是在 Visual Studio 下运行和更新调试 UI 时默认侦听器的影响，而这个问题的重点是生产环境中的发布代码。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-27T18:46:05.640

如果继续使用默认跟踪侦听器进行跟踪，则会对性能产生重大影响。

如果您想要生产就绪的性能跟踪，我强烈建议使用.NET 4.5 中的[EventSource类而不是跟踪方法。](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracing.eventsource.aspx)这通过创建 ETW 事件源与[PerfView](http://www.microsoft.com/en-us/download/details.aspx?id=28567)一起使用，并且对运行时几乎没有影响，即使您在生产中输出跟踪信息也是如此。

* * *

保留默认侦听器会导致框架通过[OutputDebugString](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363362%28v=vs.85%29.aspx)记录调用。即使在没有调试器的发布版本中，这也会对性能[产生重大影响。](https://stackoverflow.com/a/729561/65358)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-13T07:16:09.433

DefaultTraceListener 本身“非常快”——例如，除了最随意的使用外，它通常不会引起注意。但是，与[Trace.UseGlobalLock](https://msdn.microsoft.com/en-us/library/system.diagnostics.trace.usegloballock(v=vs.110).aspx)结合使用时，它会对负载较重的系统产生重大影响。

今天，我们的系统遇到了过多的 CPU 负载和上下文切换（这是另一个问题）......并且发生了一些意想不到的事情，使问题更加复杂，以至于工作有效地停止了：

*重线程代码开始在 Trace.WriteLine 上阻塞超过 12 秒 (!!)，因为它必须获得对 DefaultTraceListener 中“琐碎”工作的锁定。*

虽然即使没有跟踪侦听器也会应用 UseGlobalLock，但它实际上是一个内部没有任何东西的锁 - 与一个内部有一点点东西的锁相比，它可以在已经加载的具有许多线程的系统上滚雪球。

立即修复是禁用 UseGlobalLock（这有[其他副作用](https://stackoverflow.com/a/38759984/2864740)[免责声明：我的另一个帖子]）并删除 DefaultTraceListener。

当然，如果连接了另一个跟踪侦听器，它可能会很好地掩盖在 DefaultTraceListener 中花费的所有时间。****

# scala - jvm-1.6 不是 Eclipse 中 -target 的有效选择

> ID：15119792
> 
> 赞同：0
> 
> 时间：2013-02-27T18:43:08.567
> 
> 标签：scala, scala-ide

我将一个用 Scala 编写的 android 应用程序导入到 eclipse 中，但是当我尝试运行它时出现此错误：

```
'jvm-1.6' is not a valid choice for '-target' 
```

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-18T01:55:22.543

我也遇到过这种情况。

我设法想出的最佳答案是 android 应用程序是为 scala 2.10 设置的，但您的 eclipse 使用的是 scala 2.9 或更低版本，因为“jvm-1.6”仅对 scala 2.10 及更高版本有效。

如果您确实安装了 scala 2.10 并且 eclipse 正在使用它，那么您应该能够在 scala 设置中更改它：

1.  转到：首选项 -> Scala -> 编译器
2.  将“标准”选项卡中的“目标”更改为“jvm-1.6”

我还没有验证这一点，因为我还没有安装 scala 2.10——我还没有找到它的 .deb 文件——但[谷歌组的这个答案](https://groups.google.com/forum/#!msg/scala-ide-user/7MkQCADfM_c/X94bR-kL0E4J)似乎表明这是原因。

# xpath - WebDriver 通过 XPath 捕获文本

> ID：15119793
> 
> 赞同：1
> 
> 时间：2013-02-27T18:43:09.743
> 
> 标签：xpath, webdriver, selenium-webdriver

我正在尝试为自动 WebDriver 测试捕获一行文本，以便稍后在比较中使用它。但是，我找不到适用于 WebDriver 的 XPath。我之前使用过 text() 函数来捕获不在标签中的文本，但在这种情况下它不起作用。这是 HTML，请注意，此文本永远不会相同，因此我不能使用 contains 或类似功能。

```
<div id="content" class="center ui-content" data-role="content" role="main">
<div data-iscroll="scroller">
<div class="ui-corner-all ui-controlgroup ui-controlgroup-vertical" data-role="controlgroup">
<a class="ui-btn ui-corner-top ui-btn-hover-c" style="text-align: left" data-role="button" onclick="onDocumentClicked(21228772, "document.php?loan=********&folderseq=0&itemnum=21228772&pageCount=3&imageTypeName=1003 Application - Final&firstInitial=&lastName=")" href="#" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c">
<span class="ui-btn-inner ui-corner-top">
<span class="ui-btn-text">
<img class="checkMark checkMark21228772 notViewedCompletely" width="15" height="15" title="You have not yet viewed this document." src="../images/white_dot.gif"/>
1003 Application - Final. (Jan 11 2012  5:04PM)
</span>
</span>
</a> 
```

在此示例中，我尝试捕获的文本是：1003 Application - Final。（2012 年 1 月 11 日下午 5:04）我已经使用 Firebug 检查了该元素，并且尝试了以下 XPath，但没有成功。

```
html/body/div[1]/div[2]/div/div/a[1]/span/span
html/body/div[1]/div[2]/div/div/a[1]/span/span/text() 
```

WebDriver 测试是用 C# 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T06:47:43.383

你可以使用这个

```
driver.FindElement(By.XPath(".//div[@id='content']/following-sibling::span[@class='ui-btn-text']") 
```

或者

```
var elem = driver.FindElement(By.Id("Content"));
string text = string.Empty;
if(elem!=null) {
   var textElem = elem.FindElement(By.Xpath(".//following-sibling::span[@class='ui-btn-text']"));
   if(textElem!=null) text = textElem.Text();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T15:51:18.953

我能够通过从 XPath 中删除 span 标签来解决这个问题。

```
GetText("html/body/div[3]/div[2]/div/div/a[1]", SelectorType.XPath); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:48:18.613

python webdriver代码看起来像

```
driver.find_element_by_xpath("//span[@class='ui-btn-text']").text 
```

但是定位器可能不是唯一的，因为我看不到所有的代码

PS尽量不要使用定位器`html/body/div[1]/div[2]/div/div/a[1]/span/span`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-04T07:03:55.227

方法：从给定的 DOM 中找到 CSS 选择器

派生 CSS：css=#content div.ui-controlgroup > a[onclick*='onDocumentClicked'] > span > span

使用 C# 库方法获取文本。

# javascript - 隐藏叠加层上的黄点

> ID：15119796
> 
> 赞同：0
> 
> 时间：2013-02-27T18:43:26.190
> 
> 标签：javascript, jquery, html, css

当我单击时，模态的链接打开，但是当模态打开时，有黑色背景色。与此同时，还会出现黄点。我不希望在叠加层上显示黄点。

[http://jsfiddle.net/y88WX/18/embedded/result/](http://jsfiddle.net/y88WX/18/embedded/result/)

```
<nav class="da-dots"><span></span><span></span><span></span></nav>

.da-dots {
width: 100%;
position: absolute;
text-align: center;
left: 0px;
bottom: 20px;
z-index: 2000;
-moz-user-select: none;
-webkit-user-select: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:47:20.283

将 .da-dots 的 z-index 从 2000 更改为 100（或您喜欢的某个值，但它应该低于图层的值）

该规则在 style2.css 中定义。
建议：您应该修改 style2.css 文件中的 z-index。

```
.da-dots {
    -moz-user-select: none;
    bottom: 20px;
    left: 0;
    position: absolute;
    text-align: center;
    width: 100%;
    z-index: 2000; /* change to 100 */
} 
```

如果您无法编辑 style2.css，您可以在正文中定义它

```
<style>
.da-dots { 
    z-index: 100 !important; 
    /* You can remove !important if you able to edit style2.css*/
}
</style> 
```

[http://jsfiddle.net/y88WX/21/embedded/result/](http://jsfiddle.net/y88WX/21/embedded/result/)

# node.js - Node.js AWS SDK 请求未接收响应数据.. 在一个文件中，而不是另一个文件中

> ID：15119797
> 
> 赞同：1
> 
> 时间：2013-02-27T18:43:30.930
> 
> 标签：node.js, amazon-web-services

我确定我在这里做了一些愚蠢的事情，或者至少遗漏了一些明显的东西。只是在官方 AWS SDK 模块上运行一些非常非常基本的示例。我创建了两个空文件，一个在现有较大的 Node.js 项目的目录中，一个在远离该另一个项目的另一个单独目录中。这两个目录都包含一个由 NPM 创建的 node_modules 目录，其中包括 aws-sdk 模块，在这两种情况下都是相同的版本，0.9.5-pre.6。

在两个空文件中，我都输入了以下代码：

```
// Include the AWS module
var AWS = require('aws-sdk');

AWS.config.update({
  accessKeyId: 'OUR_SECURITY_KEY',
  secretAccessKey: 'OUR_ACCESS_KEY'
});
AWS.config.update({region: 'OUR_REGION'});

// Create a Simple Queue Service instance
var sqs = new AWS.SQS();

// Retrieve a list of available queues on our account
sqs.client.listQueues(function (err, data) {
  if (err) {
    console.log(err);
  }
  else {
    console.log(data);
  }
}); 
```

只需一段非常简单的代码即可检索我们帐户中 SQS 中的队列列表。作为记录，如果我创建 S3 客户端并尝试检索 S3 存储桶列表，结果是相同的。

当我在另一个项目的目录中运行文件时......

```
node testfile.js 
```

...我在终端窗口中看到响应数据...

```
{
  ResponseMetadata: {
    RequestId: 'SOME_REQUEST_ID'
  },
  QueueUrls: [ 'THE_CORRECT_URL_OF_MY_QUEUE' ]
} 
```

...这就是我想要的。如果我对另一个目录中的文件做同样的事情，我会得到一个空对象......

```
{} 
```

这似乎是这种情况，或者至少在我尝试过的所有不同请求中都是相似的。如果我尝试 sendMessage 将消息插入队列，它在两个文件中都有效，但问题文件再次接收到空响应对象，而“工作”文件接收通常的响应数据。

任何关于我忽略了什么愚蠢的事情的想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:20:20.127

只是遇到了同样的问题（所有请求都返回 {}）。问题在于 XML 解析——即 xml2js。我在 aws-sdk 依赖项中手动将 xml2js 0.2.5 替换为 0.2.4。这为我解决了这个问题。

编辑：

再次将 xml2js 更新为最新版本，问题似乎已解决：

[https://github.com/aws/aws-sdk-js/issues/69](https://github.com/aws/aws-sdk-js/issues/69)

[https://github.com/Leonidas-from-XIV/node-xml2js/issues/76](https://github.com/Leonidas-from-XIV/node-xml2js/issues/76)

多米尼克

# r - 使用 R 包 BerkeleyEarth

> ID：15119798
> 
> 赞同：0
> 
> 时间：2013-02-27T18:43:31.723
> 
> 标签：r

我第一次使用 R 包[BerkeleyEarth](http://cran.r-project.org/web/packages/BerkeleyEarth/index.html)，并尝试使用它的便利功能来访问[BEST](http://berkeleyearth.org/)数据。我认为这可能只是他们的服务器的问题（我已经单独向软件包的维护者提出了这个问题），但我想知道这是否是我正在做的愚蠢的事情。

重现我的错

```
library(BerkeleyEarth)
downloadBerkeley() 
```

它提供以下错误消息

```
trying URL 'http://download.berkeleyearth.org/downloads/TAVG/LATEST%20-%20Non-seasonal%20_%20Quality%20Controlled.zip'
Error in download.file(urls$Url[thisUrl], destfile = file.path(destDir,  : 
  cannot open URL 'http://download.berkeleyearth.org/downloads/TAVG/LATEST%20-%20Non-seasonal%20_%20Quality%20Controlled.zip'
In addition: Warning message:
In download.file(urls$Url[thisUrl], destfile = file.path(destDir,  :
  InternetOpenUrl failed: 'A connection with the server could not be established' 
```

有没有人使用这个包有更好的体验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:05:12.790

错误消息指向不同的 URL，而不是判断[http://berkeleyearth.org/data/](http://berkeleyearth.org/data/)中列出的指向 zip 格式文件的 URL。还有一组`.nc`似乎更新的文件。我会将数据框中的条目替换为`BerkeleyUrls`与您的分析策略匹配的条目：

这是应该在位置 1,1 的当前 URL：

```
http://berkeleyearth.lbl.gov/downloads/TAVG/LATEST%20-%20Non-seasonal%20_%20Quality%20Controlled.zip 
```

这是包数据框中的一个：

```
> BerkeleyUrls[1,1]
[1] "http://download.berkeleyearth.org/downloads/TAVG/LATEST%20-%20Non-seasonal%20_%20Quality%20Controlled.zip" 
```

我想你可以试试：

```
 BerkeleyUrls[, 1] <- sub( "download\\.berkeleyearth\\.org", "berkeleyearth.lbl.gov", BerkeleyUrls[, 1]) 
```

# wordpress - WordPress 博客的 Heroku Procfile

> ID：15119802
> 
> 赞同：2
> 
> 时间：2013-02-27T18:43:48.747
> 
> 标签：wordpress, heroku, foreman, procfile

我正在 Heroku 上建立一个 WordPress 博客。当我`foreman start`在本地运行站点时，我收到有关缺少 Procfile 的错误。我已经为 Python Web 应用程序编写了 Procfiles，但我对 PHP 不熟悉。WordPress 应用程序的 Procfile 应该包含哪些内容？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T02:17:58.087

假设您使用的是[默认的 PHP buildpack](https://github.com/heroku/heroku-buildpack-php)，默认的 Procfile 将如下所示：

```
web: sh boot.sh 
```

`default_process_types`您可以通过查看[`bin/release`](https://github.com/heroku/heroku-buildpack-php/blob/59f512ee542d4954bda188af0d2f7e7c1109abc4/bin/release#L7).

我应该注意，这假设`bin/compile`在运行 Procfile 之前已经执行（就像 buildpack 在推送到 Heroku 时所做的那样）。`boot.sh`PHP buildpack有点特殊，因为它[生成于`bin/compile`](https://github.com/heroku/heroku-buildpack-php/blob/59f512ee542d4954bda188af0d2f7e7c1109abc4/bin/compile#L49-L63)`boot.sh`.

# r - R - 如何将图形绘制到由另一个应用程序创建的现有窗口

> ID：15119804
> 
> 赞同：4
> 
> 时间：2013-02-27T18:43:50.213
> 
> 标签：r, window, output

我用 C++ 编写了一个 Windows 应用程序，我想在 R 中进行数据分析，但将图形输出到我的应用程序的窗口，所以我在我的应用程序中调用一个 R 例程，我可以将窗口的句柄发送到 R 例程，但是我不知道如何将窗口设置为 R 图形的设备。

**dev {grDevices}**函数提供对多个图形设备的控制，但我认为dev.set **()**或**windows()**在这种情况下不起作用，我该怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T19:38:06.003

您应该实现一个挂钩，将 R 图形重定向到您的应用程序窗口。我没有在 c++ 中作为应用程序完成它，但是执行它的 c# 代码本质上是标准的 windows API。

它借鉴了 Dino Esposito 在 2004 年左右编写的钩子代码。

[http://rdotnet.codeplex.com/workitem/7](http://rdotnet.codeplex.com/workitem/7)

# android - 列表视图中的 onItemClickListener 不起作用

> ID：15119806
> 
> 赞同：1
> 
> 时间：2013-02-27T18:44:01.117
> 
> 标签：android, listview, android-arrayadapter, onitemclicklistener

我正在尝试使用自定义的 arrayAdapter 来实现 listView。我可以看到我的列表，但是当我尝试选择列表中的一个选项时，我实现的方法 onItemClick 不起作用。我在 StackOverflow 中看到过类似的问题，但是提供的解决方案都不适合我……我已经尝试过使用`android:descendantFocusability="blocksDescendants"`, with`android:clickable="false"`和`android:focusable="false"`用于列表中每一行的元素，并且我也尝试过制作 MainActivity。 java实现onItemClick，但它不起作用。我知道我的代码一定有错误，但我找不到它......

这是我的代码：

guia_general_list.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#E6CEC1"
android:orientation="horizontal" >

<ListView
    android:id="@+id/lstOpciones"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="top|center"
    android:background="#E6CEC1" />

</LinearLayout> 
```

item_elements.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/layoutGeneral"
android:layout_width="match_parent"
android:layout_height="55dp"
android:background="@drawable/menu_selector_bar"
android:clickable="true"
android:focusable="true"
android:orientation="horizontal" >

<ImageView
    android:id="@+id/ivQueVerElement"
    android:layout_width="65dp"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical"
    android:paddingBottom="1dp"
    android:paddingLeft="1dp"
    android:paddingTop="1dp"
    android:scaleType="fitXY" />

<TextView
    android:id="@+id/txtOptionName"
    android:layout_width="0dp"
    android:layout_height="fill_parent"
    android:layout_gravity="center_vertical"
    android:layout_weight="1"
    android:gravity="center_vertical"
    android:paddingLeft="5dp"
    android:textColor="#FFFFFF"
    android:textStyle="bold" />

<ImageView
    android:id="@+id/ivVerOpcion"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_gravity="right|center_vertical"
    android:src="@drawable/navigation_next_item" />

</LinearLayout> 
```

ElementsAdapter.java

```
public class ElementsAdapter extends ArrayAdapter<OptionList>{

int layoutResourceId;
Context context;
OptionList data[] = null;

public ElementsAdapter(Context context, int layoutResourceId, OptionList[] data) {
    super(context, layoutResourceId, data);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data = data;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    OptionListHolder holder = null;

    if(row == null){
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);

        holder = new OptionListHolder();
        holder.imgIcon = (ImageView)row.findViewById(R.id.ivQueVerElement);
        holder.txtTitle = (TextView)row.findViewById(R.id.txtOptionName);

        row.setTag(holder);
    }else{
        holder = (OptionListHolder)row.getTag();
    }

    OptionList option = data[position];
    holder.txtTitle.setText(option.getOptionName());
    holder.imgIcon.setImageResource(option.getImageName());

    LinearLayout layoutItem = (LinearLayout) row.findViewById(R.id.layoutGeneral);

    return row;
}

static class OptionListHolder{
    ImageView imgIcon;
    TextView txtTitle;
}

public int getCount() {
    return data.length;
}

public OptionList getItem(int position) {
    return ((OptionList)data[position]);
}

public long getItemId(int position) {
    return position;
}

} 
```

MainActivity.java：

```
public class MainActivity extends Activity{

ArrayAdapter<String> adaptador;

public MainActivity() {
    // TODO Auto-generated constructor stub
}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.guia_general_list);

}

@Override
protected void onResume() {
        super.onResume();

    OptionList optionListData[] = new OptionList[]{
            new OptionList("Option1",  R.drawable.image1),
            new OptionList("Option2", R.drawable.image2),
            new OptionList("Option3", R.drawable.image3)
    };

    ElementsAdapter adapter = new ElementsAdapter(this, R.layout.item_elements, optionListData);        

    ListView lstOptions = (ListView)findViewById(R.id.lstOpciones);

    lstOptions.setAdapter(adapter);

lstOptions.setOnItemClickListener(new OnItemClickListener(){
        public void onItemClick(AdapterView<?> arg0, View arg1, int position, long id){

            Toast.makeText(getApplicationContext(),   "ENTRA!", Toast.LENGTH_LONG).show();
            Log.d("xxx","AAA: Position: "+position);

            }

        }
    });

} 
```

}

谁能帮我？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:05:18.990

您的代码看起来不错，除了 item_elements.xml。那里的视图是可点击的和/或可聚焦的。

这两行，必须删除部分 to 才能让您的 onItemClickekdListener 被调用：

```
android:clickable="true"
android:focusable="true"
android:descendantFocusability="blocksDescendants" 
```

整个 item_elements.xml 中的 other`android:clickable`和`android:focusable`属性是不必要的，但它们不应导致您的问题。

# mips - Mips 翻译问题

> ID：15119808
> 
> 赞同：0
> 
> 时间：2013-02-27T18:44:15.250
> 
> 标签：mips, pseudocode

我无法将此伪代码转换为 mips 程序集我添加了我正在使用的寄存器来帮助了解正在发生的事情

```
# if (n == 1)
#   return 1
# else if (n == 2)
#   return 6
# else
#   return 2*hex(n-1) - hex(n-2) + 4

# (hex) Registers:
# $a0 - n, the argument
# $v0 - the result the n-th Hexamorphic number
# $t0 - holds hex(n-2)
# $t1 - holds constants 1
# $t2 - holds constant 2 
```

这是我在代码中所处的位置，我对 hex: 和 elseif: 充满信心，但 else: 是问题开始的地方

```
hex:    bne $a0,$t1,elseif #if n==1
        li $t1,1
        li $t2,2
        li $v0,1 
        jr $ra         #retu

elseif: bne $a0, $t2,else
        li $v0,6
        jr $ra

else:   addi $sp,$sp,-12
    sw $ra,$ra 0($sp)
    addi $t3,$a0,-1
    sll $t3, $t2,1
    sw $a0,$a0,4($sp)
    sw $t3,8($sp)
    lw $ra
    lw $a0
    addi $t3,4
    sub $t4,$t3,$t0
    lw $t4
    sw $v0,$t4
    lw $ra
    lw $a0
    j $ra 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:47:48.950

您有一些错误的说明（、`sw`和`lw`）。这些指令的定义可以在[MIPS32 指令集快速参考](https://www.mips.com/media/files/MD00565-2B-MIPS32-QRC-01.01.pdf)中找到。`addi``j`

您在 else 块中处于正确的轨道上。您要做的是保存您希望在整个递归调用中保留的所有值（在堆栈上）。`jal`十六进制（n - 1），将其保存在堆栈中并`jal`再次十六进制（n - 2）。然后加载所有值，对它们进行计算，然后`jr ra`。在返回之前不要忘记恢复 $sp。使用时`jal`，请记住分支延迟：

```
jal hex
The instruction here will be run "together" with jal, before taking the branch.
ra will point here 
```

`jr $ra`in elseif 将`addi $sp,$sp,-12`由于分支延迟而运行。情况不妙。

# git - 如何/应该将 Zend Framework 2 包含到 Git 版本化项目中？

> ID：15119810
> 
> 赞同：5
> 
> 时间：2013-02-27T18:44:23.130
> 
> 标签：git, version-control, zend-framework2

Zend Framework 2 项目的版本控制应该如何管理？对此是否有最佳实践/“标准方法”？“子模块”是正确的关键字吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T19:34:21.057

Zend Framework 2 项目通常是一个轻量级的骨架应用程序，带有各种已安装的模块，这些模块通常位于单独的专用存储库中。

主存储库通常不会受到许多更改的影响，因此您可以为其创建一个 git 存储库（[ZendSkeletonApplication](https://github.com/zendframework/ZendSkeletonApplication)的分支）。虽然这些模块更相关并且需要一些小心，但框架应用程序通常在几个月内仅在几个细节上发生变化。

我可以建议以下方法：

1.  在骨架应用程序分支的目录中创建应用程序特定模块的第一个版本作为[git 子模块。](http://book.git-scm.com/5_submodules.html)`modules/`
2.  以建议的方式处理模块，只需提交回原始存储库并更新根存储库中的 git 子模块引用。
3.  [一旦你有了一个运行良好的版本（并且对composer](http://getcomposer.org/)和 zf2有一定的信心），你可以通过添加一个[`composer.json`](http://getcomposer.org/doc/04-schema.md)文件将它们转换为 composer 包。
4.  移除转换后的 zf2 模块的 git 子模块，[改用 composer 导入](http://getcomposer.org/doc/04-schema.md#repositories)。为此，您只需要告诉作曲家存储库的位置。这将使该模块可以在几秒钟内安装在您的任何应用程序上，帮助您重用现有组件。从现在开始，重用您为不同项目编写的代码变得非常容易。
5.  标记并逐步稳定包的依赖项和版本（因为您将开始拥有自己的[私有作曲家包生态系统](http://getcomposer.org/doc/articles/handling-private-packages-with-satis.md)）

这就是我个人的做法，它已经变成了一个非常好的开发过程。每次共享某个功能时，我只需将其移至新包并更新`composer.json`模块中的内容。[Satis](https://github.com/composer/satis)负责其余的工作，我们所有的实时系统都可以快速升级。

一旦你熟悉了composer，你可能想阅读一些更[高级的技巧和技巧。](http://www.naderman.de/slippy/src/?file=2012-11-22-You-Thought-Composer-Couldnt-Do-That.html)

# php - 脚本 rTorrent

> ID：15119812
> 
> 赞同：1
> 
> 时间：2013-02-27T18:44:36.733
> 
> 标签：php, xml-rpc, bittorrent, libtorrent

rTorrent 的文档非常短，所以我正在寻找一些关于使用其自己的脚本系统编写 rTorrent 脚本的参考资料。

**并发问题：** 我需要通过 rTorrent 传递一个字符串。

我想将一些字符串传递给 rTorrent（标题）和点 torrent 链接，下载完成后 rTorrent 运行一个带有 torrent 目录名称（d.get_name）和我传递的字符串的 php 脚本。

这将解决问题，但字符串（标题）每次下载都是唯一的： `system.method.set_key = event.download.finished, handler, "execute= php /php/location $d.get_name 'the title string'"`

PS：有人会在这个问题中添加 rTorrent 标签吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T01:49:35.820

文档确实非常有限。你需要的一些东西是`,`在执行语句中，当它被传递到 shell 并获得你需要做的 torrent 的路径时，它将被替换为一个空格`<$d.get_base_path=>`。因此，您的执行语句将`execute=php,/php/location/,$d.get_base_path`不确定如何执行将“标题字符串”提供给 shell 的最后一部分。建议您在脚本中做所有可以做的事情。

# javascript - 进一步了解javascript init函数设置

> ID：15119820
> 
> 赞同：0
> 
> 时间：2013-02-27T18:45:04.977
> 
> 标签：javascript

因此，我有一个从以前的开发人员那里继承的大型 JS 文件，我正试图了解一些主要部分。这是整个代码：

```
$(function () {

    var homepage = (function () {

        var startNewsTicker = function () {

            var news = $('#newsSlider div'),
                idx = 0,
                isHovered = false,
                TIMEOUT = 6000;

            news.mouseenter(function () {
                isHovered = true;
            });

            news.mouseleave(function () {
                isHovered = false;
            });

            setInterval(function () {
                if (!isHovered) {
                    news.eq(idx).fadeOut(500);
                    idx = (idx + 1 <= news.length - 1) ? idx + 1 : 0;
                    news.eq(idx).fadeIn(500);
                }
            }, TIMEOUT);
            news.eq(idx).fadeIn(500);
        };

        var slides = {
                wrapper: $('#slideWrapper'),
                slide: $('#slideWrapper li'),
                imageWrapper: {},
                image: {},
                paginatorWrapper: {},
                paginator: {},
                prev: -1,
                next: -1,
                arrows: {
                    left: $('#arwLeft'),
                    right: $('#arwRight')
                }
            },
            centerSlideWrapper = function () {
                slides.wrapper.css({
                    marginTop: ((window.innerHeight - slides.wrapper.height()) / 2) + 'px',
                    opacity: 1
                });
            },
            buildSlider = function () {
                slides.prev = slides.length - 1;
                slides.next = 1;
                slides.wrapper.before('<div id="homepageBackgroundImages" />').after('<div id="homepagePagination" />');
                slides.imageWrapper = $('#homepageBackgroundImages');
                slides.paginatorWrapper = $('#homepagePagination');
                slides.paginatorWrapper.css('width', 36 * slides.slide.length + 'px')
                slides.slide.each(function () {
                    var $t = $(this);
                    slides.imageWrapper.append('<div><img src="' + $t.attr('data-img') + '" /></div>');
                    slides.paginatorWrapper.append('<a href="#"><span>' + $t.attr('data-tagline') + '</span></a>');
                });
                slides.image = slides.imageWrapper.find('div');
                slides.image.find('img').fullscreenBackground();
                slides.paginator = slides.paginatorWrapper.find('a');
                slides.imageWrapper.prepend('<div class="mask"></div>');

                //create offset margin left to auto center spans
                slides.paginator.find('span').each(function () {
                    var $t = $(this);
                    $t.css({
                        top: "-9999px",
                        display: "block"
                    });
                    $t.css({
                        marginLeft: -(($t.width() + parseFloat($t.css('paddingLeft')) + parseFloat($t.css('paddingRight'))) / 2) + 2 + 'px',
                        display: "none",
                        top: "-56px"
                    })
                });

            },
            startSlider = function () {
                var slideIdx = -1,
                    currentSlide,
                    isHovered = false,
                    interval = {
                        delay: 8000,
                        timer: {},
                        start: function () {
                            interval.timer = setInterval(function () {
                                if(!isHovered)
                                    switchSlide(slideIdx + 1);
                            }, interval.delay);
                        },
                        stop: function () {
                            clearInterval(interval.timer);
                        }
                    },
                    switchSlide = function (idx) {
                        if (slideIdx > -1) {
                            slides.image.eq(slideIdx).stop(true, true).fadeOut(500);
                            slides.slide.eq(slideIdx).stop(true, true).fadeOut(500);

                        }
                        idx = (idx <= slides.slide.length - 1) ? idx : 0;
                        slides.image.eq(idx).stop(true, true).fadeIn(500);
                        slides.slide.eq(idx).stop(true, true).fadeIn(500);
                        slideIdx = idx;
                        slides.paginator.removeClass('current').eq(idx).addClass('current');
                        slides.prev = (slideIdx - 1 >= 0) ? slideIdx - 1 : slides.slide.length-1;
                        slides.next = (slideIdx + 1 <= slides.slide.length - 1) ? slideIdx + 1 : 0;
                        slides.arrows.left.find('span').text(slides.slide.eq(slides.prev).attr('data-tagline'));
                        slides.arrows.right.find('span').text(slides.slide.eq(slides.next).attr('data-tagline'));
                    }

                slides.paginator.click(function (e) {
                    e.preventDefault();
                    interval.stop();
                    switchSlide($(this).index());
                    interval.start();
                });

                slides.arrows.left.click(function (e) {
                    e.preventDefault();
                    interval.stop();
                    switchSlide(slides.prev);
                    interval.start();
                });

                slides.arrows.right.click(function (e) {
                    e.preventDefault();
                    interval.stop();
                    switchSlide(slides.next);
                    interval.start();
                });

                slides.arrows.left.mouseenter(function (e) {
                    e.preventDefault();
                    isHovered = true;
                });
                slides.arrows.right.mouseenter(function (e) {
                    e.preventDefault();
                    isHovered = true;
                });

                slides.arrows.left.mouseleave(function (e) {
                    e.preventDefault();
                    isHovered = false;
                });

                slides.arrows.right.mouseleave(function (e) {
                    e.preventDefault();
                    isHovered = false;
                });

                slides.slide.find('strong').mouseenter(function () {
                    isHovered = true;
                });

                slides.slide.find('strong').mouseleave(function () {
                    isHovered = false;
                });

                switchSlide(0);
                interval.start();
            }

        return {
            init: function () {
                centerSlideWrapper();
                $(window).resize(function () {
                    centerSlideWrapper();
                });
                buildSlider();
                startSlider();
                startNewsTicker();
            }
        }

    })();
    homepage.init();
}); 
```

在这种情况下，我想弄清楚的是这个块发生了什么：

```
var homepage = (function () {

...

    return {
        init: function () {
            centerSlideWrapper();
            $(window).resize(function () {
                centerSlideWrapper();
            });
            buildSlider();
            startSlider();
            startNewsTicker();
        }
    }
})();
homepage.init(); 
```

我感到困惑的是：

1）为什么`homepage`以这种方式创建此功能将是有益的。

2）另外，我不明白该函数如何返回一个包含另一个 JS 函数的对象，`init`然后使用`homepage.init();`. 此`homepage.init();`调用是否同时调用`homepage`和`init`函数来运行？

感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:50:00.353

> 1）为什么以这种方式创建这个主页功能会是有益的。

它通常被称为“显示模块模式”，通常用于创建只能使用“公共”属性/方法（*封装*）访问的私有静态成员。

有关此模式的更多信息，请参阅：[为什么将 JavaScript 类嵌入到匿名 function() 调用中？](https://stackoverflow.com/questions/12692250/why-embed-the-javascript-class-in-an-anonymous-function-call/12692296#12692296)

或者：谷歌/必应/雅虎“揭示模块模式”

> 2）另外，我不明白该函数如何返回一个包含另一个 JS 函数 init 的对象，然后使用 homepage.init(); 运行。这个 homepage.init(); 调用调用主页和初始化函数来运行？

是的，它调用了*对象引用*`init`的方法。`homepage`

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:50:18.887

在 javascript 中，类是通过函数创建的。所以这段代码创建了一个匿名函数并调用它，立即将它的值返回给主页。返回主页的是具有一个属性的函数/对象——在本例中为`init`函数。

然后使用该对象`homepage`访问该`init`函数。

为什么要这样做？它在全局范围内隐藏了您`...`在示例中的所有内容。`init`但是当被调用时，函数仍然可以访问它们`homepage.init()`。为什么？因为它们与`init`函数在同一范围内（或在本例中为更高的范围）。所以你*可以*打电话`homepage.int();`，但你不能打电话`homepage.startSlider()`。*

# scala - 处理对象字段验证的最佳方法 => 要么 / Try (scala 2.10) / ValidationNEL (scalaz)

> ID：15119821
> 
> 赞同：6
> 
> 时间：2013-02-27T18:45:11.277
> 
> 标签：scala, exception-handling, builder-pattern, scalaz7

让我们假设一个使用构建器模式构造的对象。

此构建器模式将包含一个`build`专注于字段验证然后转换为目标类型的方法。

可以使用以下方式实现此验证：

*   `Either[FailureObject, TargetObject]`类型
*   `Try[TargetObject]`（Scala 2.10 的新功能）
*   `Validation[FailureObject, TargetObject]`或`ValidationNEL[FailureObject, TargetObject]`来自 scalaz 库

`Validation`我读到过`Either`类型的主要优点之一是`Validation`可以“开箱即用”累积故障。

但是“新”`Try`方式呢？我注意到它`Try`也有开箱即用的“单子”方法，比如`map`，`flatMap`等等......在没有`Projection`.

因此，我想每个字段验证方法都返回 a `Try[FieldType]`，更准确地说，如果出现任何故障， a `Try[SpecificFieldExceptionType]`; 这个嵌套的包含一个`String`message 字段和一个 rootCause 字段，可以在整个`build`方法中累积。

使用 Scala 2.10，是否可以或应该`Try`练习替换 scalaz 验证库以进行简单的验证，如构建器模式所涉及的？

******编辑*** *******

 **通过阅读`Try`源代码，听起来`Try`无法累积多个异常，因此面向快速失败。Even`Try.flatMap`返回潜在的先前失败，因此没有累积的概念：

```
def flatMap[U](f: T => Try[U]): Try[U] = this.asInstanceOf[Try[U]] 
```

相反`ValidationNEL`，处理累积功能。

有什么确认吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-30T05:15:52.327

有权衡：

*   `scalaz.Validation`能够累积`E`给定`Semigroup[E]`实例的类型错误。它旨在用作`Applicative`，例如：

    ```
    (fragileFoo |@| fragileBar) { case (foo, bar) => doSomething(foo, bar) } 
    ```

    它确实有`map`和`flatMap`方法，偏向于`Success`侧面，所以你可以方便地在`for`理解中使用它。但是，没有`Monad`为它定义实例，所以它不能用于任何高阶的东西（例如，你不能将它与 monad 转换器一起使用）。不过，这个缺点对你来说似乎不是问题。

*   `scalaz.\/`，你没有提到，确实形成了`Monad`（同样，偏向`Right`一边）。但是当用作 时`Applicative`，它不会像以前那样累积失败`Validation`。

*   `util.Try`类似`scalaz.\/`，专门用于`Throwable`。尽管它再次缺乏错误的累积，但它确实具有错误恢复的概念。但是，对于您的“构建器模式”用例，这似乎不是非常有用。

*   最后，`util.Either`与其他三个选项相比，不值得考虑：因为它不偏向一侧或另一侧，所以每次你想做一元的事情时，你都必须明确且一致地要求`left`or投影。`right`

我最好的猜测是，对于你的情况，`scalaz.Validation`是最合适的选择。**

# php - 在 PHP 中将代码从 MySQL 转换为 PDO 的问题

> ID：15119822
> 
> 赞同：0
> 
> 时间：2013-02-27T18:45:11.427
> 
> 标签：php, mysql, database, pdo

我有一段代码（用于）通过表格条目进行计数，以找出对特定问题的投票数。

这是表格：

```
 USER   |   answer_id  |  poll_id  |
------------------------------------
usename        5             1
user2          4             1
user3          5             1 

```

等等。基本上每次用户投票时，都会创建一个单独的行，并且该`answer_id`列包含他们投票的问题编号。

在我将代码从 sql 更新为 PDO 语句后，查找票数的代码停止工作，只找到最近的投票，因此只返回一票。这是我更新的代码：

```
 // Get Votes
$q = 'SELECT * FROM votes WHERE poll_id = :poll_id';
$params = array(':poll_id' => 1);
$stmt = $pdo->prepare($q);
$stmt->execute($params);
while ($row = $stmt->fetch()) {

$votes = array(); //the array that will be containing all votes ( we add them as we retrieve them in a while loop )

$total_votes = 0;

$answer_id = $row['answer_id'];
$votes[$answer_id] = (int)$votes[$answer_id]+1; //add 1 vote for this particulair answer
$total_votes++;
}

// End Get votes 
```

这是它开始处理这些结果的地方

```
 // Start Get answers

$q = 'SELECT * FROM answers WHERE poll_id = :poll_id';
$params = array(':poll_id' => 1);
$stmt = $pdo->prepare($q);
$stmt->execute($params);
while ($row = $stmt->fetch()) { //loop through all answers this poll has

$id = $row['id']; //the id of the answer -> the amount of votes for each answer we stored in $votes[id_of_answer] so for this id it would be $votes[$id]
$width = round((int)$votes[$id]/$total_votes*99+1); //100% of votes

echo ''.$row['answer'].' 
('.(int)$votes[$id].' vote'.((int)$votes[$id] != 1 ? "s":"").')
   ';

} 
```

这是 MySQL 中的原始代码：

```
 $get_votes = mysql_query("SELECT * FROM votes WHERE poll_id = '$id' "); //select all votes to this poll

$votes = array(); //the array that will be containing all votes ( we add them as we retrieve them in a while loop )

$total_votes = 0;

while($vote = mysql_fetch_assoc($get_votes)) { //retrieve them
$answer_id = $vote['answer_id'];
$votes[$answer_id] = (int)$votes[$answer_id]+1; //add 1 vote for this particular answer
$total_votes++;
}

//now loop through the answers and get their corresponding amount of votes from $votes[id_of_answer]

$get_answers = mysql_query("SELECT * FROM answers WHERE poll_id = '$id' ");

while($answer = mysql_fetch_assoc($get_answers)) { //loop through all answers this poll has

$id = $answer['id']; //the id of the answer -> the amount of votes for each answer we stored in $votes[id_of_answer] so for this id it would be $votes[$id]
$width = round((int)$votes[$id]/$total_votes*99+1); // 100% of votes

echo ''.$answer['answer'].' 
('.(int)$votes[$id].' vote'.((int)$votes[$id] != 1 ? "s":"").')
   ';

} 
```

谁能告诉我哪里出错了？它是`//Get Votes`我努力弄清楚我所做的事情的一部分。据我所知，没有什么不公平的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:52:24.993

检查[bindparam](http://php.net/manual/en/pdostatement.bindparam.php "绑定参数")和[fetchall](http://php.net/manual/en/pdostatement.fetchall.php)而不是 fetch。

```
/* Execute a prepared statement by binding PHP variables */
$poll_id = 1;
$sth = $dbh->prepare('SELECT * FROM votes WHERE poll_id = :poll_id');
$sth->bindParam(':poll_id', $poll_id, PDO::PARAM_INT);
$sth->execute();

/* Fetch all of the remaining rows in the result set */
print("Fetch all of the remaining rows in the result set:\n");
$result = $sth->fetchAll();
print_r($result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:01:22.427

您正在覆盖您的数组并在循环中计数：

```
while ($row = $stmt->fetch()) {

  $votes = array(); //the array that will be containing all votes ( we add them as we retrieve them in a while loop )

  $total_votes = 0;

  $answer_id = $row['answer_id'];
  $votes[$answer_id] = (int)$votes[$answer_id]+1; //add 1 vote for this particulair answer
  $total_votes++;
} 
```

应该：

```
$votes = array(); //the array that will be containing all votes ( we add them as we retrieve them in a while loop )
$total_votes = 0;

while ($row = $stmt->fetch()) {
  $answer_id = $row['answer_id'];
  $votes[$answer_id] = (int)$votes[$answer_id]+1; //add 1 vote for this particulair answer
  $total_votes++;
} 
```

# mysql - mysql 在视图中抱怨子查询

> ID：15119823
> 
> 赞同：0
> 
> 时间：2013-02-27T18:45:18.893
> 
> 标签：mysql, select, view, subquery

当我在创建所需视图时遇到问题时，我正在使用魔兽拍卖 API 来测试一些 mysql 概念，从而在一些沙盒代码中玩耍。我已经设置了两个表，一个用于存储来自暴雪的实际数据，第二个用于在我拉更新时跟踪“lastModified”日期戳。每个拍卖条目都标有一个“updateId”，它指向另一个具有给定“lastModified”tstamp 的表。我想做的是编写一个视图来查找 MAX(lastModified) 的所有 updateId，然后返回与该 updateId 匹配的所有拍卖记录

我可以通过将它分成两个视图来使这个查询工作，但我想知道是否有某种方法可以将它压缩成一个视图。我知道的唯一语法是在'from'子句下包含select，但mysql在创建视图时似乎不喜欢这样：

*mostRecentUpdates*视图：

```
SELECT
  au.auctionUpdateId as auId,
  au.lastModified,
  au.realmId,
  au.house
 FROM
  `AuctionUpdates` AS au
 WHERE
  (
    au.`lastModified` = (
      SELECT
       MAX(lastModified)
       FROM
        `AuctionUpdates`
    )
  ) 
```

*mostRecentAuctions*视图：

```
SELECT
  a.*,
  mr.lastModified AS lastModified,
  mr.realmId AS realmId,
 FROM (
    Auctions AS a
   JOIN mostRecentUpdates AS mr
    ON (a.updateId = mr.auId)
  )
  ORDER BY
   a.updateId 
```

如果我将第一个选择放到第二个的 JOIN 中，它不会保存为视图。我只是想知道是否还有其他方法可以执行此查询，以便可以将其压缩为一个视图而不是其中的两个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:15:57.107

您可以将其编写为单个查询，只需使用`join`s：

```
SELECT a.*,
       au.lastModified AS lastModified,
       au.realmId AS realmId,
FROM Auctions a join
     AuctionUpdates au
     ON a.updateId = mr.auId join
     (select auId, MAX(lastModified) as maxLastModified
      from AuctionUpdates au
      group by auId
     ) alm
     on au.LastModified = alm.maxLastModified and
        au.auId = alm.auId
ORDER BY a.updateId 
```

关键是在子查询中使用 group by 来获取每次拍卖的最后修改日期。其余的只是加入这个信息。

这行得通吗？

```
SELECT a.*,
       au.lastModified AS lastModified,
       au.realmId AS realmId,
FROM Auctions a join
     AuctionUpdates au
     ON a.updateId = mr.auId
where lastModified = (select max(LastModified)
                      from AuctionUpdates au2
                      where au.auID = au2.auID
                     )
ORDER BY a.updateId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:45:33.227

只要您将子查询创建为视图然后引用它，就可以在视图中使用子查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:53:52.900

好的，我终于想通了。呵呵，把这两个查询又看了几遍，终于知道怎么安排了，也不算太难：

```
SELECT
  a.*,
  au.lastModified,
  au.realmId
 FROM
   Auctions AS a
  INNER JOIN
    AuctionUpdates AS au
   ON
    au.auctionUpdateId = a.updateId
 WHERE
  (au.lastModified = (SELECT MAX(lastModified) FROM AuctionUpdates))
 ORDER BY
  a.updateId ASC 
```

我只是在脑海中以错误的顺序连接。首先加入两个表，然后搜索与最大值匹配的表，而不是找到最大值然后加入结果。

# android - android - 我的应用未显示在最近的应用列表中

> ID：15119825
> 
> 赞同：0
> 
> 时间：2013-02-27T18:45:26.693
> 
> 标签：android, android-manifest, android-lifecycle

我正在开发一个应用程序，并且刚刚意识到它没有显示在最近的应用程序列表中。

我在应用程序中有 2 个活动，当我按下 Home 键时，无论我在哪个活动上，该应用程序都不会显示在最近的应用程序列表中。

我见过这个问题：[SO Question](https://stackoverflow.com/questions/10580988/application-is-not-displayed-in-recent-apps-lists) but put the category stuff in manifest 对我不起作用。

以下是我的清单的一部分：

```
<application android:label="@string/app_name" >

    <service android:name=".UploadService" android:exported="false" />
    <service android:name=".DownloadService" android:exported="false" />

    <activity android:label="@string/app_name"
        android:excludeFromRecents="true"
        android:screenOrientation="portrait" 
        android:name="com.test.DOHSMain" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity android:name="com.test.DOHSChange"
        android:label="@string/app_name" >
        <intent-filter>
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
</application> 
```

有谁知道我做错了什么？

**注意：**我在第二个活动 DOHSChange 上添加了标签，以防万一这会有所帮助，但是否有该行似乎无济于事。

谢谢你的时间

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:51:30.447

`android:excludeFromRecents="true"`从清单中删除

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:51:48.387

你有`android:excludeFromRecents=true`你的启动器活动。

# python - Django 将选择 url 参数传递给视图

> ID：15119828
> 
> 赞同：0
> 
> 时间：2013-02-27T18:45:36.060
> 
> 标签：python, django, url-routing

假设我有一个捕获多个参数的 url。例如：

```
url(r'^(?P<l_slug>[-\w]+)/(?P<t_slug>[-\w]+)/(?P<event_id>\d+)/$', 'views.SomeView'), 
```

在某些情况下， SomeView 只需要一个参数：例如：

```
def SomeView(request, event_id):
    return HttpResponse('hi {}'.format(event_id)) 
```

我一直在处理这个问题的方式是：

```
def SomeView(request, l_slug=None, t_slug=None, event_id=None):
    return HttpResponse('hi {}'.format(event_id)) 
```

有什么可以限制从 url 行传递给视图的参数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:55:03.293

您唯一的限制是查询字符串的长度（据我所知），这因浏览器而异。有关更多详细信息，请参阅[此 Stack Overflow 问题](https://stackoverflow.com/questions/812925/what-is-the-maximum-possible-length-of-a-query-string)。

至于使 URL 更具可读性，或者只提取您需要的参数，这有点主观。

如果您希望您的 URL 显式，您可以通过传入命名参数继续做您正在做的事情，但您可以将您的方法签名更改为简单地：

```
def some_view(request, *args, **kwargs):
    # more code here 
```

然后检索您需要的 arg 或 kwarg，`None`如果它不存在则返回。

您还可以传递与查询字符串参数相同的值。如果你这样做了，你根本不需要在你的视图中定义任何 args 或 kwargs，你只需从`request.GET`字典中提取值或者`None`如果没有找到键则返回。

因此，什么更具可读性完全取决于您。

# dns - 如何创建一个 apache vhost 来捕获未托管在服务器上的域？

> ID：15119831
> 
> 赞同：0
> 
> 时间：2013-02-27T18:45:41.257
> 
> 标签：dns, apache2, vhosts

一个 apache2 虚拟主机会是什么样子，它可以捕获未明确托管在我的 Web 服务器上的任何其他虚拟主机中的域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:23:08.720

```
<VirtualHost _default_:80>
    virtual host config goes here
</VirtualHost> 
```

此虚拟主机将捕获来自端口 80 且主机名与任何其他虚拟主机都不匹配的请求。

# django - Django/AJAX/JQuery - 无法接收 POST 响应

> ID：15119832
> 
> 赞同：3
> 
> 时间：2013-02-27T18:45:47.277
> 
> 标签：django, jquery

好的，首先，我是一个 JQuery/AJAX 菜鸟，但我可以设法在大多数情况下解决问题。

这就是问题所在。

出于某种原因，每次我使用 POST 作为 AJAX 类型时，我都没有得到响应，但是当我使用 GET 时，我确实得到了响应。

为什么会发生这种情况，我该如何解决。

HTML

```
<form action="/trivia/ajax_test/" method="post" onsubmit="return ajaxTest()">
{% csrf_token %}
<button type="submit">AJAX</button>
</form> 
```

jQuery/AJAX

```
function ajaxTest() { 
    $.ajax({
        type: 'POST', // Works with 'GET', but failing with 'POST'
        url: '/trivia/ajax_test/',
        data: {some_text: 'The test is working'},
        success: function(result){alert(result);} 
    });

    return false;
} 
```

网址

```
(r'^trivia/ajax_test/$', 'findadownload.trivia.views.ajax_test'), 
```

意见

```
def ajax_test(request):
    if request.is_ajax():
        return HttpResponse("Success")

    else:
        result = "You went to the url directly"

    return HttpResponse(result) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:56:20.023

这是因为Django 内置了[CSRF 保护。](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/)

将此添加到您的 Javascript，在您的 Ajax 调用之前或为您的 POST 视图[禁用 CSRF 保护](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#csrf-protection-should-be-disabled-for-just-a-few-views)。

```
function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

var csrftoken = getCookie('csrftoken');

function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    crossDomain: false, // obviates need for sameOrigin test
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type)) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
}); 
```

# java - 多个片段中具有相同 id 的视图

> ID：15119837
> 
> 赞同：1
> 
> 时间：2013-02-27T18:45:54.407
> 
> 标签：java, android, android-viewpager

我有一个自定义视图“ClearableTextView”，在相对布局中有一个 EditText 和一个按钮。视图是通过扩展布局文件创建的，因此两个视图具有 ID。

我也有两个片段，每个片段都扩展了它自己的布局。这两种布局都包括我的自定义 ClearableTextView，在其他视图中。

我知道重复使用相同的 ID 是不好的，结果是不可预测的，但是来自谷歌的一个名字听起来很法国的人曾经说过，只要子视图在父视图中具有唯一的 ID，找到正确的 ID 应该没有问题. 我搜索的视图甚至没有共同的根视图，它们所在的视图由不同的 Fragment 拥有。

我在片段 A 中查找 EditText 的引用，如下所示：

```
v= inflater.inflate(layoutA);
TextView tvA=v.findViewById("someLayoutUniqueID").findById(ClearableTextView_uniqueID_A).findViewById(editTextID); 
```

对于片段 B 中的 EditText：

```
v= inflater.inflate(layoutB);
TextView tvA=v.findViewById("anotherLayoutUniqueId").findById(ClearableTextView_uniqueID_B).findViewById(editTextID); 
```

当我说一个 ID 是唯一的时，这意味着它在我项目的所有布局中都是唯一的。

现在奇怪的东西：我创建了 Fragment A。我不知道它是否重要，但 Fragment 使用 FragmentStatePagerAdapter 附加到 viewPager。我在 EditText 中输入了一些内容。然后我按下一个按钮来创建 Fragment B，从 viewPager 中删除 A，并将 Fragment B 附加到 viewPager。现在在片段 B 中，EditText 包含来自片段 A 的文本！！！为什么？

我知道 viewpager 结合了每个片段的视图，但在我的情况下它不应该，因为始终只附加一个片段。我正在他们的父母中搜索具有唯一 ID 的 EditText 视图。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:36:09.173

如果我没记错的话，`ViewPager`通常会将任何相邻的片段保留在内存中，以便提高滑动性能。它还保留片段的状态，以便可以快速重新加载，其中包括视图的值。当您将片段添加到视图寻呼机时，它将导致您的片段被加载并附加到活动的视图树。

我过去遇到过类似的问题，我一直把我的文本放到错误的`TextView`. 我从来没有像你那样尝试过嵌套`findById`调用，但是当我简单地搜索一个`TextView`by id 时，我通常会得到第一个声明的那个。您可以通过两种方式解决此问题，第一种是使用不同的 id，这将需要一些剪切和粘贴操作（在一定程度上可以管理）。第二个也是最佳选择是创建一个自定义视图来封装这个布局和它的逻辑。预定义单击按钮以清除文本并创建一个界面以公开 que 所需/必要的位，以便它与您的其余代码一起正常运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-29T16:04:35.677

我知道这已经晚了，但我一直遇到同样的问题，我想我找到了一个简单的解决方案。除了通过 ID 查找 EditText 之外，您还可以获取该 EditText 的父级，然后查找作为 EditText 的子级，如下所示：

```
LinearLayout layout = (LinearLayout) LayoutInflater.from(this).inflate(R.layout.layout_with_editText);
EditText et = (EditText) layout.getChildAt(index); //whatever index your EditText is at 
```

这实际上将允许您在相关的 EditText 上分配文本或执行任何工作，而不是在内存中使用相同的 id。我对 Spinners 也有同样的问题，这个修复也适用。希望这会帮助任何人解决这个问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-22T04:26:36.313

我有 ViewPager 和一些带有父 RelativeLayout 的 MyFragment.newInstance(uniqueId)。创建后，我尝试将任何视图动态添加到第一页的任何其他视图，所有新视图都添加到第一页。最后，我帮助为 onViewCreated 中的每个 RelativeLayout 设置 uniqueId。

```
@Override
public void onViewCreated(View view, Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);
    vBackground.setId(mPresenter.getVehicle().getId());
} 
```

# ios - UIView 动画块暂停动画和完成代码

> ID：15119839
> 
> 赞同：8
> 
> 时间：2013-02-27T18:46:05.257
> 
> 标签：ios, objective-c, uiview, calayer

我有一个动画块来执行一个简单的基于变换的动画，完成后会从其超级视图中删除有问题的视图。

```
UIView *msgView = [[UIView alloc] initWithFrame:CGRectMake(160, 120, 160, 100)];

// Do stuff to set up the subviews of msgView.

// Add the msgView to the superview (ViewController) that is going to display it.

CATransform3D transform = CATransform3DMakeScale(2.5, 2.5, 1.0);

[UIView animateWithDuration:5.0 
                 animations:^(void){msgView.layer.transform = transform;}
                 completion:^(BOOL finished){[msgView removeFromSuperview];}]; 
```

然后，我使用 Tech Q&A 1673 [http://developer.apple.com/library/ios/#qa/qa1673/_index.html](http://developer.apple.com/library/ios/#qa/qa1673/_index.html)中详述的代码 来暂停动画。

```
-(void)pauseLayer:(CALayer*)layer
{
    CFTimeInterval pausedTime = [layer convertTime:CACurrentMediaTime() fromLayer:nil];
    layer.speed = 0.0;
    layer.timeOffset = pausedTime;
}

-(void)resumeLayer:(CALayer*)layer
{
    CFTimeInterval pausedTime = [layer timeOffset];
    layer.speed = 1.0;
    layer.timeOffset = 0.0;
    layer.beginTime = 0.0;
    CFTimeInterval timeSincePause = [layer convertTime:CACurrentMediaTime() fromLayer:nil] - pausedTime;
    layer.beginTime = timeSincePause;
} 
```

但是，此代码不会阻止完成代码的执行。因此，为了防止代码执行，我将完成代码更改为：

```
completion:^(BOOL finished){if(finished == TRUE)[msgView removeFromSuperview];}; 
```

在检查完成 == TRUE 时，可防止在动画块暂停时执行完成代码。如果在“取消暂停”动画之前超过了持续时间，则不会执行完成代码。即在这种情况下，msgView 保留在超级视图中。

无论如何要暂停/取消暂停与完成代码相关的动画和计时器（如果这是发生的事情）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T06:58:12.003

正如我在上面的评论中所说，似乎没有问题。以下是在 iOS 5.1 和 6.1 中测试的。

`UIImageView *transView`使用和创建故事板`UIButton *trigger`。这是课程：

TSTViewController.h：

```
@property (weak, nonatomic) IBOutlet UIImageView *transView;
@property (weak, nonatomic) IBOutlet UIButton *trigger;
@property (nonatomic) NSUInteger bState;

- (IBAction)didPressTrigger:(id)sender; 
```

TSTViewController.m:

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.bState = 0;    // 0 is initial state
                        // 1 is transform being animated
                        // 2 is transform paused
                        // 3 is transform ended
}

- (IBAction)didPressTrigger:(id)sender {
    switch (self.bState) {
        case 0:
        {
            CATransform3D transform = CATransform3DMakeScale(2.5, 2.5, 1.0);
            self.bState++;
            [UIView animateWithDuration:5.0
                             animations:^(void){self.transView.layer.transform = transform;}
                             completion:^(BOOL finished){
                                 self.bState = 3;
                                 NSLog(@"Done");
                             }];
            break;
        }
        case 1:
        {
            self.bState++;
            [self pauseLayer:self.transView.layer];
            break;
        }
        case 2:
        {
            self.bState = 1;
            [self resumeLayer:self.transView.layer];
            break;
        }
        case 3:
        {
            [UIView animateWithDuration:0 animations:^(void){self.transView.layer.transform = CATransform3DIdentity;}
                             completion:^(BOOL finished) {
                                 self.bState = 0;
                                 NSLog(@"Reset");
                             }];
            break;
        }
        default:
            break;
    }
}

-(void)pauseLayer:(CALayer*)layer
{
    CFTimeInterval pausedTime = [layer convertTime:CACurrentMediaTime() fromLayer:nil];
    layer.speed = 0.0;
    layer.timeOffset = pausedTime;
}

-(void)resumeLayer:(CALayer*)layer
{
    CFTimeInterval pausedTime = [layer timeOffset];
    layer.speed = 1.0;
    layer.timeOffset = 0.0;
    layer.beginTime = 0.0;
    CFTimeInterval timeSincePause = [layer convertTime:CACurrentMediaTime() fromLayer:nil] - pausedTime;
    layer.beginTime = timeSincePause;
} 
```

当您按下触发按钮时，动画开始。再按一次，动画停止。等待 10 秒钟，然后再次按下按钮。动画继续并结束，并记录“完成”。

# c - valgrind 给出大小为 1 的无效读取

> ID：15119841
> 
> 赞同：-1
> 
> 时间：2013-02-27T18:46:08.387
> 
> 标签：c, memory-leaks, malloc, valgrind

我经历了几个关于相同错误代码的类似问题，最关心的是传递无效的指针地址作为回报。但是，这里的情况似乎并非如此，因为我的程序可以正确使用任何返回的地址。

**格式字符串：**

```
static char *format_string(char *string)
{
    int i;

    if (string == NULL) {
        return string;
    }
    string[0] = (char)toupper((int)string[0]);

    111->for (i = 1; string[i] != '\0'; i++) {
        if (!isalpha(string[i-1])) {
            string[i] = (char)toupper((int)string[i]);
        } else {
            string[i] = (char)tolower((int)string[i]);
        }
        if (string[i] == '/' || string[i] == '\\') {
        string[i] = ' ';
        }
    }
    /* Remove End of string White Spaces */
    while (string[--i]==' '); string[++i]='\0';

    return string;
} 
```

**元数据提取：**

```
static int metadata_extract(const char *filename, struct kw_metadata *s)
{
    char *memchar = NULL;
    s->obj = NULL;
    s->do_cleanup = &do_on_cleanup;
    if (!is_of_type(filename)) {        
        return KW_ERROR;
    }

    TagLib_File* file = taglib_file_new(filename); 
    TagLib_Tag* tag = taglib_file_tag(file);

    s->type = strdup("Audio");
    s->tagc = 4;
    s->tagtype = (char **)malloc(4 * sizeof(char *));
    s->tagv = (char **)malloc(4 * sizeof(char *));

    memchar = strdup("title");
    s->tagtype[0] = memchar;
    memchar = strdup("artist");
    s->tagtype[1] = memchar;
    memchar = strdup("album");
    s->tagtype[2] = memchar;
    memchar = strdup("genre");
    s->tagtype[3] = memchar;

    153->memchar = strdup(taglib_tag_title(tag));
    memchar = format_string(memchar);
    s->tagv[0] = memchar;
    memchar = strdup(taglib_tag_artist(tag));
    memchar  = format_string(memchar);
    s->tagv[1] = memchar;
    memchar = strdup(taglib_tag_album(tag));
    160->memchar = format_string(memchar);
    s->tagv[2] = memchar;
    memchar = strdup(taglib_tag_genre(tag));
    memchar = format_string(memchar);
    s->tagv[3] = memchar;

    s->obj = file;
    s->do_init = &do_on_init;
    s->do_cleanup = &do_on_cleanup;

    taglib_tag_free_strings();
    taglib_file_free(file);

    return KW_SUCCESS;
} 
```

**验证：**

```
==16769== Invalid read of size 1
==16769==    at 0x5317605: format_string (plugin_taglib.c:111)
==16769==    by 0x531781F: metadata_extract (plugin_taglib.c:160)
==16769==    by 0x405EB3: metadata_extract (metadata_extract.c:36)
==16769==    by 0x403351: add_metadata_file (dbbasic.c:221)
==16769==    by 0x4032D5: add_file (dbbasic.c:174)
==16769==    by 0x406485: import_semantics (import.c:97)
==16769==    by 0x406440: import_semantics (import.c:92)
==16769==    by 0x4065AC: import (import.c:127)
==16769==    by 0x401916: main (kwest_main.c:87)
==16769==  Address 0x6f4ce11 is 0 bytes after a block of size 1 alloc'd
==16769==    at 0x4C2B3F8: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==16769==    by 0x57A6D71: strdup (strdup.c:43)
==16769==    by 0x531780F: metadata_extract (plugin_taglib.c:159)
==16769==    by 0x405EB3: metadata_extract (metadata_extract.c:36)
==16769==    by 0x403351: add_metadata_file (dbbasic.c:221)
==16769==    by 0x4032D5: add_file (dbbasic.c:174)
==16769==    by 0x406485: import_semantics (import.c:97)
==16769==    by 0x406440: import_semantics (import.c:92)
==16769==    by 0x4065AC: import (import.c:127)
==16769==    by 0x401916: main (kwest_main.c:87) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T18:47:47.963

在

```
for (i = 0; string[i] != '\0'; i++) {
    if (string[i-1]) { 
```

您正在阅读`string[-1]`，这通常是大小为 1 的无效阅读。

大概你的意思是

```
for(i = 1; ... 
```

* * *

编辑后：

在循环之前，您应该检查字符串在结束之前是否至少包含一个字符，

```
if (string[0] == 0) return string; 
```

（最好在`string[0] = (char)toupper((int)string[0]);`甚至之前完成）。讯息

> 地址 0x6f4ce11 是分配了大小为 1 的块之后的 0 个字节

告诉您您的`strdup`ed 字符串之一是空的（大小为 1 的块意味着仅分配了 0 终止符的空间）。

当你标记尾随空格时，

```
while (string[--i]==' '); string[++i]='\0'; 
```

你不检查索引是否有效，如果整个字符串由空格组成，你至少阅读`string[-1]`，你应该检查：

```
while(i-- > 0 && string[i] == ' ');
string[++i] = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-16T22:33:04.363

在实际使用变量之前尝试使用**if (NULL != memchar)进行验证；**否则`strdup`和类似的函数会产生不可预测的结果。

# c++ - 用于固定大小矩阵和向量的 C++ 库

> ID：15119844
> 
> 赞同：4
> 
> 时间：2013-02-27T18:46:08.937
> 
> 标签：c++, matrix, cuda, cross-platform, linear-algebra

我正在寻找一个 C++ 固定大小的矩阵库，它将以与**boost::numeric::ublas**相同的方式实现向量和矩阵的最常见操作，但要**在** *CUDA 内核*中使用（因此是*固定大小*的只使用本地内存而不是全局内存访问）。

我发现了几个基于主机的矩阵库：*boost::numeric::ublas*、*Eigen*、*blitz*，但它们没有固定大小的矩阵，我可以在我的内核上与 CUDA 一起使用。 *Eigen*具有*我正在寻找的**Matrix3f*和相应的东西，但它无法在使用 nvcc 编译后存活下来（尽管在这个方向上似乎有一些进展，请参见[此处](http://comments.gmane.org/gmane.comp.lib.eigen/3762)）。

 ***编辑**：我在 Linux 上做所有这些事情，因此希望可能有一些跨平台的东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:52:27.793

如果你正在寻找一个流行的 C++ 数学库，它已经被证明可以很好地工作，你可以尝试[glm](http://glm.g-truc.net/)来满足你的需要。它以 GLSL 为模型，这意味着它的数据以列优先顺序存储，这对所有面向着色器/gpu 的设计都很友好。GLM 是一个仅包含头文件的库，据称对标准非常友好，因此它可能会为您正确编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:58:52.093

与 DirectX SDK 一起分发的 XNA Math 怎么样？它包含向量和矩阵的特殊类以及对它们进行操作的大量特殊函数。

*   XMVECTOR
*   XMMATRIX
*   XMVectorMethodName
*   XMMatrixMethodName*

# scala - 如何在scala中获取Java列表的单个项目？

> ID：15119850
> 
> 赞同：1
> 
> 时间：2013-02-27T18:46:37.153
> 
> 标签：scala, collections

我有一个`java.util.list`应该包含一个项目。

我想提取这一项，以及`assert/assume`这个条件。

我可以写这样的东西：

```
def single[T](list : java.util.List[T]) : T = {
    assume(list.size() == 1)
    list.get(0)
} 
```

还有更惯用的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:51:26.907

您可以使用`JavaConversions`和`head`方法：

```
import scala.collection.JavaConverters._

def single[T](list : java.util.List[T]) : T = {
  assume(list.size == 1)
  list.asScala.head
} 
```

# java - 生成模式时休眠错位自动增量

> ID：15119855
> 
> 赞同：0
> 
> 时间：2013-02-27T18:46:49.923
> 
> 标签：java, hibernate

我有这个映射：

```
@Entity
public class Agenda implements Serializable {

    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY) 
    private Long id;

    @Id
    @ManyToOne
    private PessoaFisica pessoaFisica;

    @Id
    @ManyToOne
    private Preferencia preferencia;

} 
```

女巫生成这张表：

```
create table agenda (   
        id bigint not null, 
        preferencia_id bigint not null auto_increment, 
        pessoa_fisica_id bigint not null, 
        primary key (preferencia_id, pessoa_fisica_id, id)
); 
```

我以前使用过多个@id，但这是我第一次需要自动增量字段。为什么自动增量被放错了位置？

# javascript - 使用 JavaScript 写入 元素？

> ID：15119856
> 
> 赞同：3
> 
> 时间：2013-02-27T18:46:50.440
> 
> 标签：javascript, html

`<div>`我想在页面加载时在页面元素中打印一条消息。我有以下 HTML 和 JavaScript 代码：

```
<body onload="printMsg()">
    <div id="write"></div>
</body>

function printMsg() {
    var node = document.getElementById("write");
    node.innerHTML = "<p>" + "Hello World!" + "</p>";
} 
```

在这里，我使用元素中的`onload`事件`<body>`来调用`printMsg()`页面加载。

但是如果我不使用事件，是否有任何替代方法可以直接在 JavaScript 函数`onload`中写入？`<div id="write"></div>``printMsg()`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T18:56:03.683

正如惠普尔建议的那样，您可以按以下方式进行：

```
 <body>
    <div id="write"></div>
    <script>
    (function printMsg() {
        var node = document.getElementById("write");
        node.innerHTML = "<p>" + "Hello World!" + "</p>";
    })();
    </script>
    </body> 
```

[演示](http://jsfiddle.net/yKEJB/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:53:56.860

您可以将这些函数放在声明中： $(document).ready(function() { });

您可以在“脚本”内的标题中调用这些，或将其放入另一个文件并回调。此声明中的所有函数都将随着页面的加载而运行。效果和你onload是一样的，但是不要弄乱你的body标签。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T18:59:03.193

您可以编写一个简单的 javascript 函数来创建一个元素，而不是手动编写每个标签，如果您经常这样做会让人感到困惑。

此外，正如 Matt Whipple 指出的那样：

> 确保脚本标签在 DOM 元素之后

HTML：

```
<body>
    <div id="write"></div>
    <script>printMsg()</script>
</body> 
```

Javascript：

```
function printMsg() {
    newElement = document.createElement('p');
    newElement.innerHTML = "Hello world!";
    document.getElementById("write").appendChild(newElement);
} 
```

[http://jsfiddle.net/Qrsmq/7/](http://jsfiddle.net/Qrsmq/7/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-27T19:16:00.817

您可以使用：

```
window.onload  =   function() {
    var node = document.getElementById("write");
    node.innerHTML = "<p>" + "Hello World!" + "</p>";
} 
```

或者

```
function printMsg() {
    newElement = document.createElement('p');
    newElement.innerHTML = "Hello world!";
    document.getElementById("write").appendChild(newElement);
}
document.body.onload = printMsg; 
```

或者

```
function printMsg() {
    newElement = document.createElement('p');
    newElement.innerHTML = "Hello world!";
    document.getElementById("write").appendChild(newElement);
}
window.onload  = printMsg; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T19:05:57.590

也有`.ready`功能，但需要使用jQuery。如果您已经在考虑将 jquery 用于其他事情，那么这就是要走的路。一旦 DOM 准备好，它就会运行。

但最直接的选择是在以下末尾调用内联函数`body`：

```
<body>
    <div id="write"></div>
    <script>
        (function(){ 
             //do something with #write
        });
    </script>
</body> 
```

与该`ready`函数一样，它也只等待加载 DOM，它比`onload`侦听器更快，并且它应该与浏览器广告 javascript 向后兼容 =)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-20T18:27:12.303

```
var myWeb = new Object(), _m = "model", _v = "view", _c = "controller";

myWeb.model = {

    myEle   : "log",
    myText  : "Hello World!"

}
myWeb.view = {

    doText : function() {
        document.getElementById(myWeb[_m].myEle).innerHTML = myWeb[_m].myText;
    }

}
myWeb.controller = {

    init: function() {
        if (document.readyState == "complete") {
            this.run();
        } else {
            setTimeout(myWeb[_c].init, 11);
        }
    },
    run: function() {
        myWeb[_v].doText();
    }

}
myWeb[_c].init(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-21T15:24:45.580

您可以使用 javascript 插件 mustache JS，使用 JSON 表示法和 javascript 呈现模板。JavaScript 中使用 {{mustaches}} 的最小模板。允许您以最少的代码使用简单或复杂的模板。

[https://github.com/janl/mustache.js](https://github.com/janl/mustache.js)

代码示例：

```
// Json Data and Javascript function to calculate the value of return
var view = {
  title: "Joe",
  calc: function () {
    return 2 + 4;
  }
};

// The HTML Rendered with a simple example of template
var output = Mustache.render("{{title}} spends {{calc}}", view);

// Use your New HTML with native Javascript
document.getElementById("divWrite").innerHTML(output);

// Or you use your New HTML with JQuery
$("#divWrite").html(output); 
```

# git - 如何在不计算提交的情况下以交互方式隔离 git 主题分支？

> ID：15119860
> 
> 赞同：4
> 
> 时间：2013-02-27T18:47:02.520
> 
> 标签：git, rebase, git-rebase

如果我有这样的分支大师和主题：

```
A -- B -- C -- D (master)
     \
      W -- X -- Y -- Z (topic) 
```

而且我需要通过各种修复、挤压、修改等来操纵“主题”上的提交，我通常会签出“主题”并运行`git rebase -i`. 假设我这样做并且我将 Z 压缩到 Y 中，所以它作为一个独特的提交消失了。将`git rebase -i`默认重新定位到主人的头上，所以我会得到：

```
A -- B -- C -- D (master)
               \
                W -- X -- YZ 
```

现在，实际上我通常不希望 master 上的新提交在我的主题分支上可见（例如，可能会导致昂贵的重新编译）。

推荐的[方法](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Changing-Multiple-Commit-Messages "重新定位文档")是`git rebase -i HEAD~4`在“主题”上发布。太好了，这让我得到了我真正想要的东西，Y 和 Z 被压扁了，主题仍然起源于“B”。

```
A -- B -- C -- D (master)
     \
      W -- X -- YZ (topic) 
```

但是，我不喜欢的是我需要手动计算主题中的提交次数。这可能很大，而且肯定会改变，所以我不能从我的 shell 历史中重新运行它。每次我想这样做时，我都需要运行“git log”、计算提交、编辑命令等，并且我一直在“rebase -i”。

如何在不需要手动统计主题分支上的提交来合成'HEAD~N'的情况下达到相同的效果？换句话说，我想要一个不依赖于上下文的命令，这意味着以交互方式对当前主题分支上的所有提交进行 rebase，而不会将它们迁移到 master 的头部。

如果它是这样的形式很好，`git rebase -i $(git ...)`因为我只是计划为这个命令起别名或根据需要从我的历史记录中恢复它，但是，如果可能的话，我希望它不提及主题分支的名称，因为这再次使命令上下文相关，当我更改主题分支时需要对其进行编辑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:51:08.783

您可以获得`topic`创建分支的提交

```
git merge-base topic master 
```

所以在一个命令中，这是

```
git rebase -i `git merge-base topic master` 
```

这将做你想做的事：从`topic`.

如果您希望它不包含任何分支名称并正确设置上游分支，您也可以使用它：

```
git rebase -i `git merge-base HEAD @{u}` 
```

# javascript - `jQuery.parseJSON` 仅在 javascript 中的函数（没有 jQuery）

> ID：15119864
> 
> 赞同：1
> 
> 时间：2013-02-27T18:47:25.183
> 
> 标签：javascript, jquery

我一直在寻找`jQuery.parseJSON`在 JavaScript 中解析 json 以返回 JavaScript 对象的方法。我不能使用 jQuery，因为我构建的整个插件都是独立的 JS，并且到目前为止还没有使用 jQuery。JavaScript 中是否已经提供了这种类型的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:49:31.590

使用本机 JSON 对象（这是唯一一次说“JSON 对象”是正确的，它实际上是一个名为 的对象`JSON`）来操作 JSON 字符串。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON)

用于`JSON.parse(yourJSONString);`序列化和`JSON.stringify(yourJSONObject);`反序列化。

如果您查看第 492 行的[jQuery 核心源代码](https://github.com/jquery/jquery/blob/master/src/core.js)`jQuery.parseJSON`，它只是`JSON.parse`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:57:08.410

您可以使用大多数浏览器都支持的[本机 JSON 对象](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON)，但是当您尝试在 IE7 及更低版本的恐龙浏览器中使用它时会遇到问题。可以选择在[此处包含一个模仿本机功能的独立插件（JSON.js）。](https://github.com/douglascrockford/JSON-js)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:14:15.997

**简短的回答：**

使用浏览器原生方法[JSON.parse()](https://developer.mozilla.org/en-US/docs/Using_native_JSON)

```
window.JSON.parse(jsonString); 
```

**长答案：**

要让它在旧浏览器中工作，您可以获取 jQuery 的 [源代码](http://code.jquery.com/jquery-1.9.1.js)并删除对 j​​Query 本身的`jQuery.parseJSON`任何依赖项。这是一个工作的独立版本：

```
function standaloneParseJson ( data ) {
    // Attempt to parse using the native JSON parser first
    if ( window.JSON && window.JSON.parse ) {
        return window.JSON.parse( data );
    }

    if ( data === null ) {
        return data;
    }

    var rvalidchars = /^[\],:{}\s]*$/;
    var rvalidbraces = /(?:^|:|,)(?:\s*\[)+/g;
    var rvalidescape = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g;
    var rvalidtokens = /"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;

    if ( typeof data === "string" ) {

        // Make sure leading/trailing whitespace is removed (IE can't handle it)
        data = data.replace(/^\s+|\s+$/g, '');

        if ( data ) {
            // Make sure the incoming data is actual JSON
            // Logic borrowed from http://json.org/json2.js
            if ( rvalidchars.test( data.replace( rvalidescape, "@" )
                .replace( rvalidtokens, "]" )
                .replace( rvalidbraces, "")) ) {

                return ( new Function( "return " + data ) )();
            }
        }
    }

    // Error code here
    //jQuery.error( "Invalid JSON: " + data );
} 
```

# cross-browser - 单文件网页

> ID：15119865
> 
> 赞同：4
> 
> 时间：2013-02-27T18:47:30.767
> 
> 标签：cross-browser, webpage, mhtml

我正在尝试找到一种跨浏览器功能，可以将整个网页作为单个文件保存和加载。MHTML (.mht) 就是这种文件类型的一个例子，但它不能跨浏览器工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-17T20:17:16.930

[grunt-inline](https://github.com/chyingp/grunt-inline) "将外部引用的资源，例如 js、css 和图像，放入一个文件中。" 并且像魅力一样工作。

# variables - 如何跨项目使用变量（可能是静态变量）？

> ID：15119870
> 
> 赞同：1
> 
> 时间：2013-02-27T18:47:43.877
> 
> 标签：variables, dll, static, project, solution

我在同一个解决方案中有 3 个项目。其中一个项目有**一个静态变量**，我试图**在其他两个项目中访问它**（通过添加第三个项目的 dll）。我看到在其他 2 个项目中创建了 2 个不同的静态变量副本。

如何解决此问题并访问此静态变量并使其仅跨 2 个项目的**一个实例？**我的意思是一旦它在一个项目中被修改，它应该反映在另一个项目中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:36:22.520

当然可以，而且非常简单。

由于**您已经指定了标签[解决方案](/questions/tagged/solution "显示标记为“解决方案”的问题")**，假设您正在使用*Visual Studio*进行开发是合理的。

我进一步假设你是用 c# 编写的，但如果你不是，会有类似的方法来做同样的事情。

使用 c#，在项目中声明静态变量，例如

```
namespace CrossProject {
    public partial class PartialClass {
        public static String StaticVariable="123";
    }
} 
```

您可以`StaticVariable`通过指定在其他两个项目中访问

```
using CrossProject; 
```

这样您就可以像使用它一样

```
Console.Write("{0}", PartialClass.StaticVariable); 
```

它不一定是[部分类](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)，但请注意变量声明必须在类范围内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:52:01.463

通过 API 函数访问变量。不要创建静态全局对象，而是有一个指针并在第一次调用该 API 函数时创建变量。阅读单例模式。

# ios - 访问 GLKQuaternion 中的元素

> ID：15119877
> 
> 赞同：0
> 
> 时间：2013-02-27T18:48:03.827
> 
> 标签：ios, objective-c

我正在尝试将以下代码从 Java 转换为 Objective-c。

如何在不创建自己的 Quaternion 类的情况下像在 Java 中一样创建新的 Quaternion 对象。是否可以使用 GLKQuaternion ，因为这已经实现了？

```
this.q = new Quaternion(qrot); 
```

其次，如何访问 GLKQuaternion 结构中的元素。例如，我尝试过：

```
self._m[9] 
```

运气不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:04:01.433

不确定我是否正确阅读，但对于第 1 部分，您正在谈论 Java 中的构造函数，带有参数。据我所知，Objective-C 不使用构造函数。要模仿一个，你必须扩展`init`方法。所以，

```
this.q = new Quaternion(qrot); 
```

变成

```
self.q = [[Quaternion alloc] initWithRotation:qrot]; 
```

对于第 2 部分，在 Objective-C 中访问`struct`元素确实像在 Java 中一样使用点表示法，但除非变量 _m 是一个数组，否则您的代码会导致编译错误。

哪里`structElement`是`int = y`,

```
exmapleStruct.strutElement = 9; 
```

是一个有效的论点。在您的代码中，您正在访问`_m`sub 9 或数组中的第 8 个元素`_m`

希望这可以帮助

# asp.net - 在登录控件中设置 ASP.Net 用户名文本框的名称

> ID：15119879
> 
> 赞同：0
> 
> 时间：2013-02-27T18:48:06.823
> 
> 标签：asp.net, vb.net, asp.net-membership, login-control, loginview

使用这个 ASP.Net 登录控件，我们可以设置用户名文本框的 ID 吗？我想称它为txtUserName。

```
<asp:LoginView 
    ID="loginViewMain" 
    runat="server">

    <LoggedInTemplate>
        <asp:LoginName 
            ID="loginName" 
            runat="server"
            FormatString="Hello, {0}!<br/><br/> You have successfully<br/> logged onto the staff site." />

        <br/>
        <br/>

        (<asp:LoginStatus ID="loginStatus" runat="server" />)

        <br/>
        <br/>

    </LoggedInTemplate>

    <AnonymousTemplate>
        <asp:LoginStatus 
            ID="loginStatus" 
            runat="server" />
    </AnonymousTemplate>
</asp:LoginView> 
```

一旦我从代码隐藏文件中获得了用户名文本框的名称，我想将重点放在用户名文本框上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:23:54.247

在您的 aspx 中，如果您向匿名模板添加登录控件（其中显示用户名、密码和“记住我”按钮）

```
<asp:LoginView 
ID="loginViewMain" 
runat="server">

<LoggedInTemplate>
        <asp:LoginName 
            ID="loginName" 
            runat="server"
            FormatString="Hello, {0}!<br/><br/> You have successfully<br/> logged onto the staff site." />

        <br/>
        <br/>

        (<asp:LoginStatus ID="loginStatus" runat="server" />)

        <br/>
        <br/>

    </LoggedInTemplate>

    <AnonymousTemplate>
        <asp:LoginStatus 
            ID="loginStatus" 
            runat="server" />
        <asp:Login runat="server" ID="login"></asp:Login>
    </AnonymousTemplate>
</asp:LoginView> 
```

在页面加载事件中，您可以设置焦点

```
public partial class Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        loginViewMain.FindControl("login").FindControl("UserName").Focus();

    }
} 
```

# asp.net - 编译错误 CS0016：无法写入输出文件

> ID：15119880
> 
> 赞同：17
> 
> 时间：2013-02-27T18:48:10.117
> 
> 标签：asp.net, asp.net-mvc, visual-studio, iis, asp.net-mvc-4

**简单来说**

当我尝试浏览我的网站时，我收到以下错误消息：

> CS0016: 无法写入输出文件 'c:\Windows\Microsoft.NET\Framework64\v2.0.50727\Temporary ASP.NET Files\www\xxx\yyy\zzz\abdll' - '目录名称无效'

**详细地**

我的开发 PC 上有两个网站（虚构名称）：

*   **Web2** - 这是使用 .NET 3.5 在 ASP.NET 中编写的，并在应用程序池中运行，该应用程序池解决了 v2.0 .NET 框架并以集成模式运行。这是使用 Visual Studio 2010 开发的
*   **Web4** - 这是使用 .NET 4.5 在 ASP.NET 中编写的，并在 AppPool 中运行，该 AppPool 解决了 v4.0 .NET 框架并以集成模式运行。这是使用 Visual Studio 2012 开发的。

最近，我几乎一直在 Web4 上的 VS2012 中工作，它工作正常，但是前几天我尝试运行 Web2 并得到了上面显示的异常。

奇怪的是，路径的一部分（我在上面用字母“zzz”替换）似乎指向德语路径，因为它是“\de-DE\”——我不是用德语操作的，所以我不知道这个想法是从哪里来的。

几乎可以肯定不相关的一件事，但出于某种未知的原因，我觉得值得一提：在此问题首次出现的前一天，我正在使用 Visual Studio 2012 中的性能分析工具，我不知道这是否可能对我的电脑进行了一些更改...？？

*尝试修复*

互联网上有很多关于此的主题；一些线程以成功结束，其中文件访问权限已被更改，而另一些线​​程则以有点绝望的声音结束......我已经完成了将我的 PC 上所有相关探测目录的 NTFS 权限与同事的比较机器这仍在工作。不幸的是，在那里没有快乐。

我还卸载了 asp.net 2.0 并使用以下方法重新安装：

```
C:\Windows\Microsoft.NET\Framework64\v2.0.50727\aspnet_regiis.exe -u
C:\Windows\Microsoft.NET\Framework64\v2.0.50727\aspnet_regiis.exe -ir 
```

再一次，在那里也没有快乐。

我的 Web4 继续运行不受影响。

另外仅供参考：在 Win7 x64 上使用 IIS 7.5。

我现在转向更广泛的受众，希望将我目前的绝望状态转变为成功的状态。

感谢大家

格里夫

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-08-29T21:26:53.683

在 IIS 管理器中，在应用程序池的高级设置中，确保“进程模型 > 加载用户配置文件”设置为“真”。

我有这个完全相同的问题。我尝试更改权限、禁用防病毒、创建新的应用程序池并重新安装 .NET。我什至创建了一个只有“Default.aspx”页面的新站点并尝试查看该站点。甚至那个站点也有编译错误。最后，我注意到我的应用程序池（干净的测试站点和主站点）的加载用户配置文件设置具有非默认值“False”。我将其设置为true，问题就消失了。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-11T07:10:45.667

使用 ProcMon 找到了答案：

> [http://technet.microsoft.com/en-us/sysinternals/bb896645](http://technet.microsoft.com/en-us/sysinternals/bb896645)

临时 asp.net 文件首先在用户的 temp 文件夹中创建，然后移动到此文件夹中。由于一些未知的原因，我的 Web2 站点 (.NET 2 AppPool) 的编译现在使用与我的 Web4 (.NET 4 AppPool) 站点相同的文件夹。

我使用 ProcMon 来识别“拒绝访问”的所有结果，并授予 IIS_IUSRS 组写入权限（在一种情况下 - C:\Users\ASP.NET V4.0 Integrated - 修改权限）。

我不知道为什么编译使用“错误”文件夹，我怀疑在某些情况下我可能过度提升了权限，但现在它正在工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-06-19T08:23:59.080

如果上述答案没有为您解决问题，请检查您的环境变量（右键单击计算机 -> 属性 -> 高级系统设置 -> 高级选项卡 -> 环境变量

确保临时变量指向具有所有必要权限的文件夹。（网络服务的完全访问权限，IIS_IUSRS）

注意：不要只检查顶部的两个变量，查看系统变量下的滚动菜单。您可能会发现那里也配置了变量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-12-23T05:46:29.973

这可能不是原因，但在尝试使用 Instrumentation 方法运行 VS 2010 性能向导后，我开始出现此错误。

我的 DEV 环境中的快速修复：将应用程序的应用程序池的标识更改为 LocalSystem。

# ios - 其他接口/设备的操作表

> ID：15119881
> 
> 赞同：0
> 
> 时间：2013-02-27T18:48:10.847
> 
> 标签：ios, ipad, cocos2d-iphone

我正在做一个动作表，以便弹出 3 个选项，拍照，选择照片或取消。该应用程序最初仅适用于 ipad，但现在我正在 iphone 上实现它。问题似乎出在界面上，因为它是在 ipad 上设置的。这是代码：

```
#pragma mark - UIActionSheetDelegate methods

- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{   
    CustomImagePickerController *imagePicker = [[CustomImagePickerController alloc] init];
    [imagePicker setDelegate:self];
    [imagePicker setAllowsEditing:YES];

    if(buttonIndex == 0) {
        [imagePicker setSourceType:UIImagePickerControllerSourceTypeCamera];
    } else if(buttonIndex == 1) {
        [imagePicker setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
    }

    CGSize winsize = [[CCDirector sharedDirector] winSize];
    CGRect rect = CGRectMake(20,20,10,10);
    rect.origin = [[CCDirector sharedDirector] convertToGL:rect.origin];

    _popoverController = [[UIPopoverController alloc] initWithContentViewController:imagePicker];
    [_popoverController setDelegate:self];
    [_popoverController setPopoverContentSize:CGSizeMake(winsize.width, winsize.height) animated:NO];
    [_popoverController presentPopoverFromRect:rect inView:[[CCDirector sharedDirector] view] permittedArrowDirections:UIPopoverArrowDirectionDown animated:YES];
} 
```

这是错误：

```
2013-02-27 15:35:31.437 xxxxxxxx [8492:707] cocos2d: surface size: 480x320
2013-02-27 15:35:32.848 xxxxxxxx [8492:707] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIPopoverController initWithContentViewController:] called when not running under UIUserInterfaceIdiomPad.' 
```

如何将此操作表设置为两个设备？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:49:41.477

你不能`UIPopoverViewController`在 iPhone 或 iPod Touch 上使用，它是一个只能在 iPad 上实例化的类。

# python - python函数的编码风格

> ID：15119883
> 
> 赞同：1
> 
> 时间：2013-02-27T18:48:15.643
> 
> 标签：python, coding-style

需要意见。

我有一个定义一些数据的函数。我的想法是用户可以告诉它从文件中读取数据：

```
acquire_data('read_from_file',filename) 
```

或者用户可以直接提供数据：

```
acquire_data('use_this_list',datalist) 
```

所以这个函数会有一个类似的形式

```
def acquire_data(mode,arg2):
    if mode == 'read_from_file':
        inputs=open(arg2)
        data = #etc.
    else:
        data = arg2  #or deepcopy(arg2) or whatever 
```

嗯，这行得通，但它似乎有点陈旧。特别是，“arg2”根据“mode”的值具有非常不同的功能。所以：这是好代码吗？这是“pythonic”吗？有人看到更好的编码方法吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:52:01.857

```
def acquire_data(list_or_filename):
    # assuming py3 here, for py2 use 'isinstance(list_or_filename, basestring)
    if isinstance(list_or_filename, str):
        with open(list_or_filename,"r") as f:
            return acquire_data_from_file(f)
    else:
        return acquire_data_from_list(list_or_filename) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T18:56:04.853

与其让`acquire_data`打开并读取文件的全部内容，不如将 a 传递`fileObj`给`acquire_data`.

这是一个更好的设计的原因

1.  序列、生成器和文件的统一接口
2.  您不需要读取函数中的全部数据
3.  即使发生异常，您也可以控制文件的生命周期

骨架代码将是

```
def acquire_data(iterable):
    for line in iterable:
        # Do what ever you want

with open("whatever") as fin:
    acquire_data(fin)

acquire_data(some_seq)

acquire_data(some_gen) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T18:56:20.620

只为不同的任务使用不同的函数怎么样：`acquire_data_from_file`, `acquire_data_from_list`, 等等？更加清晰和简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T19:10:43.290

如果你真的想要一个可以接受文件名或数据列表的函数（你可能不这样做，但你似乎对 oseiskar 和 Abhijit 建议的更多 Pythonic 替代方案有抵抗力），你绝对不想这样做方法。

一般来说，如果你发现自己在进行类型切换，那么你做错了什么。但是基于字符串做假类型切换，依赖用户匹配字符串和类型，就更不对了。

一种替代方法是尝试打开文件名，如果失败，则假定它是一个序列而不是文件名。（请求宽恕比请求许可更容易。）例如：

```
def acquire_data(filename_or_list):
    try:
        with open(filename_or_list) as f:
            data = list(f)
    except TypeError:
        data = list(filename_or_list)
    # ... now the rest of your code uses data 
```

即使用户传递一个`unicode`文件名而不是一个`str`，或者一个`tuple`而不是一个`list`，或者甚至是你从未听说过的某些类，它也适用于`open`or`list`函数。这就是鸭式打字的精髓。

当然，这有点*滥用*鸭子类型，但这是您的问题所固有的：您正在尝试采用两种不同类型之一的参数，并且任何使其起作用的解决方案都将滥用某些功能。

唯一的担心是有人可能会传递一些同时适用于`open`和的东西`list`。事实上，对于普通的旧`str`. 所以你需要一个通用的决定来处理这种情况——似乎首先尝试将其作为路径名，然后作为序列，比反之更好。这当然是你想要的`str`，但你必须考虑这是否适用于双向工作的每一种可能的类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T18:55:06.977

这种工作我会进一步划分并使用 dict 作为 switch case ：

```
def read_file(arg):
 # code

def read_data(arg):
 # code

def default_f(arg):
 # code

def acquire_data(mode, arg2):

    fun = {
    'read_from_file': read_file, 
    'use_this_list': read_data
    }.get(mode, default_f)

    fun(arg2) 
```

**编辑**：
第二种方法：结合我和@möter。

```
def acquire_data(arg):
   fun = {
     True: read_file,
     False: read_data
     }.get(
         isinstance(arg, str),
         default_f
         )
   return fun(arg); 
```

称之为：

```
acquire_data('read_from_file',filename)
acquire_data('use_this_list',datalist) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-27T19:00:33.363

由于 Python 的[鸭子类型](http://en.wikipedia.org/wiki/Duck_typing)，让函数根据变量或参数的数据类型执行不同的行为，这种做法相对常见。

你可以让你的功能保持原样，虽然我会考虑这样做

```
if mode == 'read_from_file':
        inputs=open(arg2)
        data = #etc.
elif mode == 'use_this_list':
        data = arg2  #or deepcopy(arg2) or whatever
else:
        raise InputError # or something like this 
```

只是为了确保您的函数是可扩展的，并且您没有将任何不正确的参数传递给函数的第二部分。

除了数据本身之外，另一种方法可能是简单地接受打开的文件和/或文件名：

```
def acquire_data(arg):
    if isinstance(arg, file):
        data = arg.read() # make sure to parse the data
    elif isinstance(arg, basestring):
        data = open(arg, 'r').read() # make sure to parse
    else:
        data = arg 
```

# linux - 从文件中提取包含大量字符串之一的行

> ID：15119885
> 
> 赞同：0
> 
> 时间：2013-02-27T18:48:18.387
> 
> 标签：linux, command-line

假设我有一个包含 10,000,000 行的文件 DATA。我有另一个包含 100,000 个字符串的文件 IDS。我想从 DATA 中提取所有包含 IDS 字符串之一的行。另一个条件是文件之间存在 1:1 的关系，因此每个 ID 有一行 DATA，每个 DATA 有一个 ID。

使用标准 linux 命令行实用程序执行此操作的最有效、最简单的方法是什么？

到目前为止我的想法：

1.  构建一个巨大的正则表达式并使用 grep（简单，可能会超过 grep 中的某些限制）
2.  逐行遍历IDS，分别为每个字符串grep DATA，合并结果。（简单，可能效率很低）
3.  在 python 中构建 IDS 的哈希图，遍历 DATA，提取 ID 并检查哈希图（有点困难）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:59:11.563

```
grep -F -f IDS DATA 
```

不要错过`-F`：它可以防止将 IDS 解释为正则表达式，并启用更高效的 Aho-Korasick 算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:55:08.883

如果 IDS 包含您需要在 DATA 中找到的确切字符串，每行一个字符串，请尝试使用

```
grep --file=IDS DATA > results 
```

# perl - 如何访问“无密钥”匿名哈希

> ID：15119893
> 
> 赞同：0
> 
> 时间：2013-02-27T18:49:07.147
> 
> 标签：perl

我的 perl 脚本生成一个具有以下 Data::Dumper 输出的变量。

```
$VAR1 = [
  {
    'displayName' => 'unconfirmed',
    'tagName' => 'unconfirmed'
  },
  {
    'displayName' => 'new',
    'tagName' => 'new'
  },
  {
    'displayName' => 'started',
    'tagName' => 'started'
  },
  {
    'displayName' => 'reopened',
    'tagName' => 'reopened'
  },
  {
    'displayName' => 'resolved',
    'tagName' => 'resolved'
  }
]; 
```

重新创建此输出的 perl 代码如下所示：

```
my $foo = ([
  {
    'displayName' => 'unconfirmed',
    'tagName' => 'unconfirmed'
  },
  {
    'displayName' => 'new',
    'tagName' => 'new'
  },
  {
    'displayName' => 'started',
    'tagName' => 'started'
  },
  {
    'displayName' => 'reopened',
    'tagName' => 'reopened'
  },
  {
    'displayName' => 'resolved',
    'tagName' => 'resolved'
  }
]);
print Dumper($foo); 
```

**问题 A：**如何访问内容？

谢谢你的帮助！这是有关如何访问结构的示例。

```
for my $item (@{$foo}) {
    print $item->{tagName};
} 
```

**问题 B：**语言上下文有什么好的参考：哈希、数组、不同括号的含义等？

**注意：**结构本身位于几个肥皂调用、xpath ( `SOM->valueof`) 和直接引用 ( `$som->{tag1}->{tag2}`) 的末尾，但我希望这个问题会更容易提出和回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:56:49.993

Perl 不创建无键散列。你在 $foo 那里看到的是一个数组引用，所以你必须做`print $foo->[$_]{displayName} for 0 .. $#{$foo}`.

好吧，作为参考，你不需要那个，你需要一个完整的介绍文本。请参考[http://perl-tutorial.org](http://perl-tutorial.org)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:55:46.220

**答案A：**

由于您使用了对哈希和数组的引用（标量），因此您应该取消引用标量以访问元素。

例如，如果您愿意访问第三个哈希，您将访问它：

```
$foo->[2]->{"displayName"}; # accesses 'started'
$foo->[2]->{"tagName"}; # accesses 'started' 
```

**答案 B：**

有关参考，请参阅[此](http://perldoc.perl.org/perlreftut.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T09:20:44.627

学习像这样的复杂 Perl 数据结构的一个好的开始是[Data Structures Cookbook](http://perldoc.perl.org/perldsc.html)，它包含在每个 Perl 安装中（`perldoc perldsc`在命令行中输入）。

# javascript - Javascript - If 语句 - 条件中的字符串 && 布尔值

> ID：15119894
> 
> 赞同：0
> 
> 时间：2013-02-27T18:49:11.530
> 
> 标签：javascript

如果我自己测试一个布尔值，我知道我不必输入 == true。

```
 if (bool) {
   foo();
 } 
```

我有一个 if 条件来测试 sting 值和布尔值的真实性，我可以替换：

```
 if ( string === "hello" && bool == true ) {
   foo();
 } 
```

和：

```
 if ( string === "hello" && bool ) { 
 foo();
 } 
```

?

另外，布尔值会使用三等号吗？到目前为止，我在布尔测试中看到的只是双等于。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:27:31.777

使用三等号，[这是首选](https://stackoverflow.com/questions/359494/javascript-vs-does-it-matter-which-equal-operator-i-use)。

`if(bool == true)`,`if(bool === true) and if(bool)`都是不同的表达方式。第一个是说值 bool 必须是原始的 JavaScript 类型 true，或者是布尔值的对象表示（即 new Boolean()），值为 true。第二个是说值“bool”*必须*是[原始类型 bool](http://www.ecma-international.org/ecma-262/5.1/#sec-4.3.2)（新的 Boolean() 对象，即使值为 true，也会失败）。仅当 bool 为时，第三个表达式才为假

*   错误的
*   无效的
*   不明确的
*   空字符串''
*   数字 0
*   数字 NaN

意思是，例如，如果您传入一个空对象 ({})，则第二个表达式将评估为 true。

一些例子：

```
var bool = true;
var boolObj = new Boolean(true);
var boolEmptyObj = {};

if (bool === true) { alert("This will alert"); }
if (boolObj === true) { alert("Nope, this wont alert"); }
if (boolEmptyObj) { alert("This will alert"); } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:51:51.640

是的。如果 bool 真的是一个布尔值，它将评估为真或假，就像任何表达式一样。您还可以使用以下方法确保 bool 是布尔值：

```
!!bool 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:51:52.387

是的，但是当您只使用这些`bool`值时`false`：`null`、`undefined`和。你需要小心。`0``"" (empty string)`

# html - 如何使表格行跳入？

> ID：15119895
> 
> 赞同：0
> 
> 时间：2013-02-27T18:49:20.580
> 
> 标签：html, css

我正在开发一个包含每周交易列表的网页。

我希望它工作的方式是有一个交易列表，当您单击它时，该周的更多详细信息将显示在其下方。

我希望它像表格一样呈现，但我希望详细信息如下所示： ![在此处输入图像描述](../Images/633a53a3c28a01f0e18b54b27598a455.png)

因此，当我单击第三行时，详细信息显示如下。我遇到的具体问题是让详细的行跳进去。

非常感谢任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:08:54.707

我认为您可以使用 TD 内部的其他表格和 Colspan，TR 向下。您可以使用 CSS 来创建边框。

例如：

```
<table style="border:1px solid #000; border-collapse:collapse;">
    ..
    <tr>
            <Td>Info 2 1 </Td>
            <Td>Info 2 2 </Td>
            <Td>Info 2 3 </Td>
            <Td>Info 2 4 </Td>
    </tr>
    <tr>
            <td  style="border:0px solid #FFF;">
                 <table style="border:0 0 0 50px; border:1px solid #000; border-collapse: collapse;">
                     <tr>
                          <td>Detail title 1</td>
                          <td>Detail title 2</td>
                          <td>Detail title 3</td>
                     </tr>
                 </table>
            </td>
    </tr>
    <tr>
            <td>Info 2 1 </td>
            <td>Info 2 2 </td>
            <td>Info 2 3 </td>
            <td>Info 2 4 </td>
    </tr>
    ..
<table> 
```

要动态创建这个内部表，可以使用 Jquery 的“After”命令。例如：

```
$('#TR_Selected').after('<tr><td colspan="4"><table> ...</table></td></tr>'); 
```

# c++ - 异常处理、WinRT C++ 并发异步任务

> ID：15119897
> 
> 赞同：2
> 
> 时间：2013-02-27T18:49:28.870
> 
> 标签：c++, asynchronous, lambda, windows-runtime, concurrency-runtime

我必须在 C++ 中实现异步 HTTP GET，并且我们必须能够将应用程序提交到 Windows 8 应用商店。

我的问题如下：

我找到了一个合适的示例代码，它实现了一个 HttpRequest 类[http://code.msdn.microsoft.com/windowsapps/HttpClient-sample-55700664](http://code.msdn.microsoft.com/windowsapps/HttpClient-sample-55700664)

如果 URI 正确，则此示例有效，但如果 URI 指向无效/不存在的位置（例如：www.google22.com），则会引发异常。如果我能捕捉到异常，这会很好，但我无法弄清楚我应该如何或在哪里捕捉它。

现在一些代码。这是对抛出异常的基于异步、并发::任务的方法的调用：

```
try {
...
Web::HttpRequest httpRequest;
    httpRequest.GetAsync(uri, cancellationTokenSource.get_token())
        .then( []  (concurrency::task<std::wstring> response)
    {
        try {
            response.get();
        }
        catch( ... ) {
            int i = 1;
        }
        return response;
    })
...
} catch ( ... ) {
...
} 
```

这是 GetAsync 方法的相关部分（方法的结尾）：

```
// Return a task that completes when the HTTP operation completes. 
// We pass the callback to the continuation because the lifetime of the 
// callback must exceed the operation to ensure that cancellation 
// works correctly.
return completionTask.then([this, stringCallback](tuple<HRESULT, wstring> resultTuple)
{
    // If the GET operation failed, throw an Exception.
    CheckHResult(std::get<0>(resultTuple));

    statusCode = stringCallback->GetStatusCode();
    reasonPhrase = stringCallback->GetReasonPhrase();

    return std::get<1>(resultTuple);
}); 
```

CheckHResult 行抛出异常，代码如下：

```
inline void CheckHResult(HRESULT hResult)
{
if (hResult == E_ABORT)
{
    concurrency::cancel_current_task();
}
else if (FAILED(hResult))
{
    throw Platform::Exception::CreateException(hResult);
}
} 
```

我在 GetAsync 调用周围有一个 try-catch，在 .then 延续 lambda 中也有一个 try-catch。

在相关的 Microsoft 文档（[http://msdn.microsoft.com/en-us/library/windows/apps/hh780559.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh780559.aspx)）中，它指出任务引发的异常应该可以在链中的下一个任务中捕获，但不知何故在我的情况下它不起作用。此外，甚至整个调用周围的 try-catch 都没有捕获异常，它只是跳过了所有内容......

有人遇到过这个问题吗？我想我已经尝试了官方文档中所述的所有内容，但它仍然让异常变得疯狂并使应用程序崩溃。我想念什么？

**编辑：**

我已经修改了代码，除了异常处理之外什么都不做，它仍然没有捕获 .GetAsync 中的任务抛出的异常

清理后的代码：

```
try
{
  Windows::Foundation::Uri^ uri;
  uri = ref new Windows::Foundation::Uri( uri_string_to_fetch );

  concurrency::cancellation_token_source cancellationTokenSource = concurrency::cancellation_token_source();

  Web::HttpRequest httpRequest;
  OutputDebugString( L"Start to fetch the uri...\n" );
  httpRequest.GetAsync(uri, cancellationTokenSource.get_token())
    .then([](concurrency::task<std::wstring> response)
  {
    try {
      response.get();
    }
    catch( ... ) {
      OutputDebugString(L"unknown Exception");
    }
  })
  .then([](concurrency::task<void> t)
  {
    try {
      t.get();
      // .get() didn't throw, so we succeeded.
    }
    catch (Platform::Exception^ e) {
      // handle error
      OutputDebugString(L"Platform::Exception");
    }
    catch (...) {
      OutputDebugString(L"unknown Exception");
    }
  });
} 
catch (Platform::Exception^ ex) {
  OutputDebugString(L"Platform::Exception");
  errorCallback(-1);
} 
catch ( ... ) {
  OutputDebugString(L"unknown Exception");
  errorCallback(-2);
} 
```

这仍然让我崩溃并出现异常消息：*App1.exe 中 0x75644B32 的第一次机会异常：Microsoft C++ 异常：Platform::COMException ^ at memory location 0x077EEC28。HRESULT:0x800C0005*

此外，当我在代码中放置一些断点时，它表明异常会在第一个 .then 被调用之前滑过所有内容。我在这些位置放置了断点（在简化/清理的代码中）：

*   在 GetAsync 调用之前
*   进入 GetAsync，到**CheckHResult(std::get<0>(resultTuple));** 抛出异常的行
*   进入每个尝试和捕获案例/块

执行顺序，用断点测试：

1.  在 GetAsync 调用之前 [OK]
2.  在 GetAsync 中，将抛出异常的行 [OK]
3.  **现在应用程序崩溃了，每次尝试捕获都会滑倒**，继续
4.  现在第一个*.then*中的行被调用，在它的 try 块中
5.  任何 catch 块未捕获的另一个应用程序级异常
6.  现在是第一个*.then*的 catch 块
7.  第二个 .then 方法的*try*块
8.  仅此而已，第二个*.then*的捕获甚至没有捕获任何异常

以及打印的调试日志，依次为： - 开始获取 uri... - App1.exe 中 0x75644B32 处的第一次机会异常：Microsoft C++ 异常：Platform::COMException ^ 在内存位置 0x082FEEF0。HRESULT：0x800C0005 - App1.exe 中 0x75644B32 处的第一次机会异常：Microsoft C++ 异常：在内存位置 0x00000000 处 [rethrow]。- App1.exe 中 0x75644B32 处的第一次机会异常：Microsoft C++ 异常：Platform::COMException ^ 位于内存位置 0x082FE670。HRESULT:0x800C0005 - App1.exe 中 0x75644B32 处的第一次机会异常：Microsoft C++ 异常：Platform::COMException ^ 位于内存位置 0x082FDD88。HRESULT:0x800C0005 - 未知异常

怎么了？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T22:08:05.920

在并发运行时中，任何在任务执行期间发生的未处理异常都会被延迟以供以后观察。通过这种方式，您可以在链的末尾添加一个基于任务的延续并在那里处理错误。

像这样的东西：

```
httpRequest.GetAsync(uri, cancellationTokenSource.get_token())
.then([](concurrency::task<std::wstring> response)
{
    try {
        response.get();
    }
    catch( ... ) {
        int i = 1;
    }
    return response;
})
.then([](concurrency::task<void> t)
{
    try {
        t.get();
        // .get() didn't throw, so we succeeded.
    }
    catch (Platform::Exception::CreateException^ e) {
        // handle error
    }
}); 
```

调用`.get`触发任务链中引发的任何异常（如果有）。有关更多详细信息，您可以阅读[并发运行时中的异常处理](http://msdn.microsoft.com/en-us/library/dd997692.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-18T12:51:26.177

这个相关的线程可能有一个线索： [Visual C++ Unmanaged Code: Use /EHa or /EHsc for C++ exceptions?](https://stackoverflow.com/questions/4414027/visual-c-unmanaged-code-use-eha-or-ehsc-for-c-exceptions)

如果您想捕获所有异步异常，您可以尝试将配置属性-> C/C++ -> 代码生成属性设置为“是的，带有 SEH 异常 (/EHa)”

# c - 使用预定的特征值计算 lapack 中的特征向量？

> ID：15119898
> 
> 赞同：4
> 
> 时间：2013-02-27T18:49:29.193
> 
> 标签：c, performance, math, lapack, intel-mkl

我对 lapack 有一个相当不寻常的挑战，我花了几个小时寻找解决方案。

我有一个传统形式的广义特征值问题（A - x B = 0）。通常我会使用例如 ?hegvx 或 ?hegvd 来计算特征值和特征向量。

但是我现在面临的挑战是，现在我已经从问题的构造中知道了特征值，因此我需要一个**有效**的lapack 例程来仅计算特征向量？

有人对此有破解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-05T12:49:48.533

给定广义特征值问题

(A - y B) x = 0

和一个特征值 yn：

(A - y [n] B) x [n] = 0

我们知道 A、B 和 yn，所以我们可以形成一个新的矩阵 Cn

C [n] = A - y [n] B

C [n] x [n] = 0

您可以使用任何线性代数求解器为每个特征值单独求解。根据[LAPACK docs on linear equations](http://www.netlib.org/lapack/lug/node38.html)，对于一般矩阵，双精度，您可以使用 DGETRS

编辑退化特征值：

矩阵 Cn 的零空间是我们在这里解决的问题（正如 MvG 评论的那样）。如果

C [n] j = 0 和
C [n] k = 0

（即退化的 e-vals）然后给定 j ^T k = 0 （两者仍然是 AB 系统的特征向量）我们可以说

调用一行 C [n] r：

rk = rk - j ^T .k = (rj ^T ).k

从而形成一个矩阵 J ，其行是每个 j ^T（必须有一个名称，但我不知道）：

(C [n] - J) k = 0

定义

D [nj] = C [n] - J

现在求解新矩阵 D [nj]。通过构造，这将是具有相同退化特征值的原始矩阵的新正交特征向量。

# sql - 时间范围内的唯一计数（打印出 0）

> ID：15119901
> 
> 赞同：0
> 
> 时间：2013-02-27T18:49:33.437
> 
> 标签：sql, count, sum

我有一个表，`TB`其中包含`Time, User_id, State`数据如下所示的列。

```
INSERT INTO TB
  (Time, User_id, State)
VALUES
  (1, 1, 'VA'),
  (1, 2, 'VA'),
  (1, 2, 'DC'),
  (2, 1, 'VA'),
  (2, 2, 'MD'),
  (3, 1, 'MD'),
  (3, 112, 'MD'),
  (3, 134, 'VA'),
  (3, 111, 'MD'),
  (4, 12, 'VA'),
  (4, 22, 'MD')
; 
```

我想要每 2 秒`User_id`给定的唯一计数。`State = 'DC'`结果应如下所示：

```
NewTime | Count  
   1    |  1
   2    |  0 
```

当计数为 0 时，我得到了打印出 0 的答案

```
SELECT  TIME,
        SUM(CASE WHEN State = 'DC' THEN 1 ELSE 0 END) Count
FROM    TB
GROUP   BY Time 
```

并使用获取时间范围内的唯一计数

```
SELECT
    ((Time - 1) / 2) + 1 as NewTime,
    COUNT(DISTINCT User_id) as Count
FROM ... 
GROUP BY ((Time - 1) / 2) + 1 
```

但我不确定如何将这两者结合起来以获得我想要的结果。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:02:34.800

您是否正在寻找这个：

```
SELECT
    ((Time - 1) / 2) + 1 as NewTime,
    COUNT(DISTINCT case when state = 'DC' then User_id end) as Count
FROM ... 
GROUP BY ((Time - 1) / 2) + 1 
```

这假设您每两秒就有一些记录（尽管不一定是 DC）。

# sql-server - 如何从 SQL Server 中的表中删除重复的行

> ID：15119902
> 
> 赞同：7
> 
> 时间：2013-02-27T18:49:36.953
> 
> 标签：sql-server, database

我有一个名为的表`table1`，其中包含重复的值。它看起来像这样：

```
new
pen
book
pen
like
book
book
pen 
```

但我想从该表中删除重复的行并将它们插入另一个名为`table2`.

`table2`应该是这样的：

```
new 
pen
book
like 
```

如何在 SQL Server 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:04:31.173

您可以使用您使用`INSERT`的`SELECT`s轻松完成此操作，例如：`CTE``ROW_NUMBER()`

```
DECLARE @YourTable table (YourColumn varchar(10))
DECLARE @YourTable2 table (YourColumn varchar(10))
INSERT INTO @YourTable VALUES ('new')
INSERT INTO @YourTable VALUES ('pen')
INSERT INTO @YourTable VALUES ('book')
INSERT INTO @YourTable VALUES ('pen')
INSERT INTO @YourTable VALUES ('like')
INSERT INTO @YourTable VALUES ('book')
INSERT INTO @YourTable VALUES ('book')
INSERT INTO @YourTable VALUES ('pen')

;WITH OrderedResults AS
(
SELECT
    YourColumn, ROW_NUMBER() OVER (PARTITION BY YourColumn ORDER BY YourColumn) AS RowNumber
    FROM @YourTable
)
INSERT INTO @YourTable2 
        (YourColumn)
    SELECT YourColumn FROM OrderedResults
        WHERE RowNumber=1 
```

从@YourTable2 中选择 *

输出：

```
YourColumn
----------
book
like
new
pen

(4 row(s) affected) 
```

您可以在您使用`DELETE`的地方轻松地做到这一点，例如：`CTE``ROW_NUMBER()`

```
--this will just remove them from your original table
DECLARE @YourTable table (YourColumn varchar(10))
INSERT INTO @YourTable VALUES ('new')
INSERT INTO @YourTable VALUES ('pen')
INSERT INTO @YourTable VALUES ('book')
INSERT INTO @YourTable VALUES ('pen')
INSERT INTO @YourTable VALUES ('like')
INSERT INTO @YourTable VALUES ('book')
INSERT INTO @YourTable VALUES ('book')
INSERT INTO @YourTable VALUES ('pen')

;WITH OrderedResults AS
(
SELECT
    YourColumn, ROW_NUMBER() OVER (PARTITION BY YourColumn ORDER BY YourColumn) AS RowNumber
    FROM @YourTable
)
DELETE OrderedResults
    WHERE RowNumber!=1

SELECT * FROM @YourTable 
```

输出：

```
YourColumn
----------
new
pen
book
like

(4 row(s) affected) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:51:16.030

假设该字段名为`name`：

```
INSERT INTO table2 (name)
SELECT name FROM table1 GROUP BY name 
```

该查询将为您提供所有唯一名称。

如果需要，您甚至可以将它们放入表变量中：

```
DECLARE @Table2 TABLE (name VARCHAR(50))

INSERT INTO @Table2 (name)
SELECT name FROM table1 GROUP BY name 
```

或者您可以使用临时表：

```
CREATE TABLE #Table2 (name VARCHAR(50))

INSERT INTO @Table2 (name)
SELECT name FROM table1 GROUP BY name 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T19:07:10.433

几周前，我使用 DELETE TOP X 发布了一些关于删除重复项的内容。显然，仅针对一组重复项。然而，在评论中，Joshua Patchak 给了我这颗小宝石。

```
;WITH cte(rowNumber) AS
(SELECT ROW_NUMBER() OVER (PARTITION BY [List of Natural Key Fields] 
ORDER BY [List of Order By Fields]) 
FROM dbo.TableName)

DELETE FROM cte WHERE rowNumber>1 
```

这将消除表中的所有重复项。
如果您想阅读讨论，这是原始帖子。[表中的重复行。](http://sqlstudies.com/2013/02/04/duplicate-rows-in-a-table/)

# java - 如果我有一个变量名为 myThread 的线程实例，我如何确定它是否处于 RUNNABLE 状态？

> ID：15119908
> 
> 赞同：1
> 
> 时间：2013-02-27T18:49:52.730
> 
> 标签：java

我查看了这个 api，但没有找到我正在寻找的信息：

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html#RUNNABLE](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html#RUNNABLE)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:51:21.530

好吧，如果您已经有了线程参考，则可以使用[`Thread.getState()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#getState%28%29)：

```
Thread.State state = myThread.getState();
if (state == Thread.State.RUNNABLE) {
    ...
} 
```

但是，请注意，由于线程的性质，状态很容易在调用`getState()`和使用结果之间发生变化。`getState()`除了用于诊断目的之外，使用它很少是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:51:28.350

你可以写：

```
if (myThread.getState() == Thread.State.RUNNABLE) 
```

（请参阅[Javadoc 了解`Thread.getState()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#getState%28%29).）

# asp.net-mvc - MVC4 Web API - 是否可以从单个控制器中为非标准和自定义操作添加路由？

> ID：15119914
> 
> 赞同：0
> 
> 时间：2013-02-27T18:50:05.627
> 
> 标签：asp.net-mvc, asp.net-web-api, asp.net-mvc-routing

我有一个 MVC web api，它大部分使用以下标准路由：

```
 config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{action}/{id}",
            defaults: new { id = RouteParameter.Optional }
        ); 
```

这驻留在`WebApiConfig.cs`路由文件中。

但是，某些控制器上的某些操作可能需要在其路由上添加其他参数。

例如，a`ContentController`可能希望将附加参数传递给调用，例如：

```
 routeTemplate: "api/{controller}/{Foo}/{action}/{Bar}/{id}" 
```

或任何数量的其他配置。

理想情况下，如果我正在做这类事情，我希望能够在控制器本身中拼出那些特定于控制器的路由，而不是弄乱`WebApiConfig.cs`文件。

这可能吗？它是如何完成的？这是个坏主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:11:59.220

如果马克琼斯把这个作为答案而不是评论，我就可以给他积分。但我不能，但这个问题应该在解决后关闭。答案是

> 您可能想使用基于属性的路由。请参阅此处的 attributerouting.net。

[http://attributerouting.net](http://attributerouting.net)

# google-groups-api - 尝试通过 Javascript 使用 PATCH 更新 Google 网上论坛

> ID：15119924
> 
> 赞同：1
> 
> 时间：2013-02-27T18:50:35.030
> 
> 标签：google-groups-api

我正在尝试使用 PATCH 更新 Google 组，但无法使其正常工作。我不确定这是语法问题还是无法通过 Javascript 完成。我可以使用 OAUTH 成功执行“获取”操作，但不能使用 PATCH。

1.  我应该在 setRequestHeader “Authorization”中使用 OAuth 还是 Bearer（两者似乎都适用于 GET 并且在“PATCH”期间以相同的方式失败。
2.  get 工作正常。PATCH 上的错误是 { "error": { "errors": [ { "domain": "global", "reason": "invalid", "message": "Permission denied: Cannot hide from Groups directory." } ], "code": 400, "message": "Permission denied: 无法从 Groups 目录中隐藏。" } }

    ```
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>

    <script type="text/javascript">
    function loadXMLDoc() {
    var xmlhttppatcher;
    var xmlhttp;
    var data;   
    if (window.XMLHttpRequest) {
    xmlhttppatcher = new XMLHttpRequest(); xmlhttppatcher.open("PATCH","https://www.googleapis.com/groups/v1/groups/nogads2%40mydomain.org", false);
    xmlhttppatcher.setRequestHeader("Content-Type", "application/json");
    xmlhttppatcher.setRequestHeader("Authorization", "OAuth " + "ya29.AHES6ZR_yljyMvWCv0gWbwIASYYp29S8rFUA-dd-YkyyjTHz");
    //xmlhttppatcher.setRequestHeader("Authorization", "Bearer " + "ya29.AHES6ZR_yljyMvWCv0gWbwIASYYp29S8rFUA-dd-YkyyjTHz");
    data = '{"replyTo": "REPLY_TO_MANAGERS"}';
    alert(data);
    xmlhttppatcher.send(data);
    alert('Your data was sent');
    document.getElementById("myDiv1").innerHTML = xmlhttppatcher.responseText;
    alert('readystate: ' + xmlhttppatcher.readyState + ' status: ' + xmlhttppatcher.status); //this should return 4 & 200
    if (xmlhttppatcher.status == 200)
    alert("The request succeeded!\n\nThe response representation was:\n\n" + xmlhttppatcher.responseText);
    else
    alert("The request did not succeed!\n\nThe response status was: " + xmlhttppatcher.status + " " + xmlhttppatcher.statusText + ".");
    }
    if (window.XMLHttpRequest) {
    xmlhttp = new XMLHttpRequest();
    xmlhttp.open("GET", "https://www.googleapis.com/groups/v1/groups/nogads2%40mydomain.org?alt=json", false);
    xmlhttp.setRequestHeader("Authorization", "OAuth " + "ya29.AHES6ZR_yljyMvWCv0gWbwIASYYp29S8rFUA-dd-YkyyjTHz");
    xmlhttp.send();
    alert('readystate: ' + xmlhttp.readyState + ' status: ' + xmlhttp.status); //this should return 4 & 200
    document.getElementById("myDiv2").innerHTML = xmlhttp.responseText;
    if (xmlhttp.status == 200)
    alert("The request succeeded!\n\nThe response representation was:\n\n" + xmlhttp.responseText);
    else
    alert("The request did not succeed!\n\nThe response status was: " + xmlhttp.status + " " + xmlhttp.statusText + ".");
    }
    }
    </script>
    </head>

    <body>
    <div id="myDiv1"><h2>Let AJAX change this text (DIV1)</h2></div><br />
    <div id="myDiv2"><h2>Let AJAX change this text (DIV2)</h2></div>
    <button type="button" onclick="loadXMLDoc()">Change Content</button>
    </body> 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:06:35.493

嘿，我遇到了同样的问题，我通过创建一个新的 Groups 对象 [Java] 并设置了我想要更新的特定属性来修复它

# networking - 如何获取有关无线网络设备的信息

> ID：15119928
> 
> 赞同：2
> 
> 时间：2013-02-27T18:50:58.597
> 
> 标签：networking, linux-kernel, netfilter

我正在使用`NF_INET_PRE_ROUTING`钩子的 Linux 内核模块中工作。在那个钩子中，我需要知道我所有的 net_devices 的状态，特别是无线设备。我可以从`net_device->flags`即`IFF_UP`设备启动或关闭中获取有关设备的一些信息。但我需要更多关于无线的细节`net_device`。

1.  net_device 是无线/有线的吗？
2.  无线设备是否连接到无线接入点？
3.  如果是，哪个无线接入点（接入点名称）？
4.  与该设备关联的网关地址（我认为，我需要从路由表中获取此地址？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:54:08.343

请参阅 iwconfig、iwlist 和其他实用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T01:29:57.230

`if(net_device->ieee80211_ptr != NULL)`? 是`ieee80211_ptr`一个[`struct wireless_dev*`](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=include/net/cfg80211.h;hb=HEAD)。这个结构应该让您可以访问您请求的大部分值。在`struct wireless_dev`is 中`struct wiphy *wiphy;`，您可以使用它来获得一个[`cfg80211_registered_device`](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=net/wireless/core.h;hb=HEAD)with `wiphy_to_dev()`。

*网关*地址与无线无关。我怀疑`devices`有任何*网关*信息，但您需要接口`name`才能`net_device`找到路由。该路由与*IP*相关，与`device`. 祝你好运。

# javascript - 相同的代码在两台服务器上的行为不同

> ID：15119929
> 
> 赞同：0
> 
> 时间：2013-02-27T18:51:03.537
> 
> 标签：javascript, jquery

在我的本地主机中，一台服务器没问题，数组在 $.each 函数中的控制台内具有相同的值，就像在外面一样，但在另一台服务器上，代码的行为不同。第二个控制台返回空数组，里面是正确的。服务器如何改变客户端语言行为？

```
var isChecked = [];
$('.x').each(function() {
  if ($(this).prop('checked')) {
    id = $(this).prop('id').split('_')[1];
    isChecked.push(id);
    console.log(isChecked);
  } else {
    isChecked.splice($.inArray(id, isChecked), 1);
  }
});
console.log(isChecked); 
```

标记是：

```
<table>
  <tr class=header>
    <td class=first>
      <input type="checkbox" id="c">
      <label for="c"><span class="tablecheck"></span></label>
    </td>
    <td class="header" colspan=""><a href="/">User group</a></td>
    <td class="header" colspan=""><a href="/">Firstname</a></td>
    <td class="header" colspan="2"><a href="/">Lastname</a></td>
  </tr>
  <tr class="">
    <td class=first>
      <input type="checkbox" id="x_41" class="x">
      <label for="x_41"><span class="tablecheck"></span></label>
    </td>
    <td>Admin</td>
    <td>Firstname</td>
    <td>Lastname</td>
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:06:26.960

> 服务器如何改变客户端语言行为？

我猜你的浏览器已经从第二台服务器缓存了旧版本的 JavaScript 文件，这可以解释为什么你会看到不同的行为。

# c++ - 为什么链接器不会在这里产生多重定义错误？

> ID：15119932
> 
> 赞同：0
> 
> 时间：2013-02-27T18:51:13.457
> 
> 标签：c++, global-variables

我有一个像这样的简单 .h 文件：

```
//test.h
int x = 12; 
```

例如，如果我在其中包含此文件，`main.cpp`链接`functions.cpp`器将产生此错误，这是合理的：

```
error LNK2005: "int x" (?x@@3HA) already defined in functions.obj 
```

但是当我改变变量定义时：

```
//test.h
const int x = 12; 
```

链接器错误消失。方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:52:37.893

`const`在具有内部链接的命名空间范围内声明的名称。也就是说，您包含的每个文件`test.h`都有自己的对象，名为`x`. 见§7.1.1/7：

> *在没有存储类说明符*的命名空间范围内声明的名称具有外部链接，除非它由于先前的声明而具有内部链接并且如果它没有被声明`const`。已声明`const`和未显式声明的对象`extern`具有内部链接。

# java - 需要帮助找出正确的正则表达式模式

> ID：15119936
> 
> 赞同：0
> 
> 时间：2013-02-27T18:51:19.663
> 
> 标签：java, regex

我需要从字符串中提取子字符串：

给定字符串： `"< If( ( h == v ) ): { [ < j = (i - f) ;>, < k = (g + t) ;> ] }>"` 我需要两个子字符串：`"j = (i - f)"`和`"k = (g + t)"`.

为此，我尝试了用户模式正则表达式。这是我的代码：

```
Pattern pattern = Pattern.compile("[<*;>]");
Matcher matcher = pattern.matcher(out.get(i).toString());
while (matcher.find())
     {
        B2.add(matcher.group());
      } 
```

out.get(i).toString() 是我的输入字符串。B2 是一个 ArrayList，它将包含两个提取的子字符串。

但是，运行上面的代码后，我得到的输出是 : `[<, <, ;, >, <, ;, >, >]`。

我的模式不起作用！非常感激您的帮忙。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:58:40.433

您可以使用表达式`<([^<]+);>`。

这将匹配 < 和 ;> 之间的内容

```
Pattern pattern = Pattern.compile("<([^<]+);>");
Matcher matcher = pattern.matcher(out.get(i).toString());
while (matcher.find())
     {
        B2.add(matcher.group(1));
      } 
```

您可以在 regexplanet 上查看结果：http: [//fiddle.re/5rty6](http://fiddle.re/5rty6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:56:58.380

你`[`和`]`正在给你带来问题。这些符号的意思是：`"match one among the symbols inside of these"` 如果你去掉它们，你会得到更好的结果。这样做时，您还必须避开尖括号。

下一步将是捕获这些组。你通常使用`(`and `)`。

您还必须担心令人讨厌的工件，例如`<`字符串开头的那些会弄乱您的正则表达式的工件。为了解决这个问题，您需要从您的正则表达式中排除这些内容。

你可能最终得到

```
"\<([^<>]*?)\>" 
```

作为你的正则表达式。请务必检查特定的 java 文档并转义您`\`的最终结果

```
"\\<([^<>]*?)\\>" 
```

如果你想在你的尖括号内下一个`<`，`>`正则表达式在这种事情上有很多麻烦，也许你应该尝试不同的方法

[这是一个示例正则表达式](http://rubular.com/r/RqpfFMddhV)

# php - 关于将 Highstocks 图形图像发送到服务器的建议

> ID：15119938
> 
> 赞同：0
> 
> 时间：2013-02-27T18:51:20.920
> 
> 标签：php, javascript, highcharts, highstock

我知道 highstocks 提供了在客户端通过 javascript 下载图表图像的选项，但我想知道他们是否发布了在托管服务器上生成这些图像的首选方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:07:04.530

您可以使用本地计算机上的图表导出服务器来进行无浏览器的图表导出。请参阅[此](http://www.highcharts.com/component/content/article/2-news/52-serverside-generated-charts)链接。您可以使用 phantomJS 界面将图表定义发送到导出服务器，它会输出您想要的任何文件格式（PDF、JPEG、SVG、PNG）。然后，您可以以任何其他方式使用这些图表图像文件 - 可下载文件、页面上的静态图像等。

# ubuntu - 如何在 Ubuntu 启动时禁用 lighttpd 守护进程

> ID：15119945
> 
> 赞同：17
> 
> 时间：2013-02-27T18:51:32.713
> 
> 标签：ubuntu, lighttpd

[我正在根据本指南](http://www.howtoforge.com/installing-lighttpd-with-php5-php-fpm-and-mysql-support-on-ubuntu-12.10)设置 lighty，但我并没有真正使用已安装的 lighttpd 守护程序（这是驻留在 /etc/init.d/lighttpd 中的守护程序）。我不希望网络服务器一直运行，除非我在工作。我想在需要时调用 lighttpd -Df lighttpd.conf 。

我怎样才能禁用它？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-07T12:09:39.087

您可以使用以下命令在启动时禁用 lighttpd。

```
sudo update-rc.d -f lighttpd remove 
```

这是一个脚本，它将从以下位置删除 lighttpd 启动脚本：

```
/etc/rc0.d
/etc/rc1.d
/etc/rc2.d
/etc/rc3.d
/etc/rc4.d
/etc/rc5.d
/etc/rc6.d
/etc/rcS.d 
```

希望有帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-08-31T01:14:27.837

我们使用systemd：

```
prompt$ sudo systemctl disable lighttpd 
```

您可能还想

```
prompt$ sudo systemctl stop lighttpd 
```

因为 disable 不会停止任何正在运行的服务器。

systemd 几乎回退到 SysV 处理并运行一个脚本，该脚本执行 Oliver 在他的回答中提到的内容（据我所知）

```
Synchronizing state of lighttpd.service with SysV init with
   /lib/systemd/systemd-sysv-install...
Executing /lib/systemd/systemd-sysv-install disable lighttpd 
```

最终评估

```
$CHROOT /usr/sbin/update-rc.d "$NAME" defaults
$CHROOT /usr/sbin/update-rc.d "$NAME" disable 
```

(On a Fedora box when looking)

# javascript - 如何在javascript中删除字符串中的空格

> ID：15119960
> 
> 赞同：-2
> 
> 时间：2013-02-27T18:52:17.670
> 
> 标签：javascript, spaces, removeall

我想避免javascript中字符串中的空格。我不仅想删除字符串的前后空格，还想从字符串中删除空格（前面，在字符和结尾之间）。

提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:53:50.533

**代码：**

```
var str = "String String String";
str = str.replace(/ /g,'');  // ' '  -> REMOVE ONLY ' ', NOT \n, \r, \t, and \f
console.log(str);            // '/g' -> GLOBAL or MATCH_ALL or FIND ALL ' ' 
```

***注意**：如果要包含，请更改`/ /g`为`/\s/g``\n, \r, \t, \f, and " "`*

* * *

**输出：**

`StringStringString`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:55:14.867

像这样：

```
var s = "my cool example string";
var s_no_space = s.replace(/ /g, ''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:55:16.027

您可以使用正则表达式：

```
var str = "a string with spaces";
var nospacesStr = str.replace(/\s/g, ""); // "astringwithspaces" 
```

# android - 导入的android项目出错

> ID：15119965
> 
> 赞同：0
> 
> 时间：2013-02-27T18:52:26.253
> 
> 标签：android

我已经导入了一个 Android 项目，它在控制台中出现以下错误

```
[2013-02-28 00:13:04 - ddmlib]An established connection was aborted by the software in your host machine
java.io.IOException: An established connection was aborted by the software in your host machine
    at sun.nio.ch.SocketDispatcher.write0(Native Method)
    at sun.nio.ch.SocketDispatcher.write(Unknown Source)
    at sun.nio.ch.IOUtil.writeFromNativeBuffer(Unknown Source)
    at sun.nio.ch.IOUtil.write(Unknown Source)
    at sun.nio.ch.SocketChannelImpl.write(Unknown Source)
    at com.android.ddmlib.JdwpPacket.writeAndConsume(JdwpPacket.java:213)
    at com.android.ddmlib.Client.sendAndConsume(Client.java:574)
    at com.android.ddmlib.HandleHeap.sendREAQ(HandleHeap.java:348)
    at com.android.ddmlib.Client.requestAllocationStatus(Client.java:420)
    at com.android.ddmlib.DeviceMonitor.createClient(DeviceMonitor.java:854)
    at com.android.ddmlib.DeviceMonitor.openClient(DeviceMonitor.java:822)
    at com.android.ddmlib.DeviceMonitor.processIncomingJdwpData(DeviceMonitor.java:781)
    at com.android.ddmlib.DeviceMonitor.deviceClientMonitorLoop(DeviceMonitor.java:649)
    at com.android.ddmlib.DeviceMonitor.access$100(DeviceMonitor.java:42)
    at com.android.ddmlib.DeviceMonitor$3.run(DeviceMonitor.java:577) 
```

同样，我该如何更改目标 SDK？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:58:43.107

您可以从项目属性 -> Android 更改目标 SDK，并且您将有一个表格，您可以从中获得已安装的 SDK 版本之一。

# matlab - Matlab：从没有零的每一列中获取随机值

> ID：15119966
> 
> 赞同：3
> 
> 时间：2013-02-27T18:52:35.203
> 
> 标签：matlab, random, vector, matrix, zero

我有一个二维矩阵如下：

```
possibleDirections =

 1     1     1     1     0
 0     0     2     2     0
 3     3     0     0     0
 0     4     0     4     4
 5     5     5     5     5 
```

我需要从每一列中从向量中的非零值中获取一个随机数。值 5 将始终存在，因此不会有任何列全为零。任何想法如何通过使用向量上的操作来实现这一点（不单独处理每一列）？一个示例结果是 [1 1 1 1 5]

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:12:46.217

您可以在不直接循环或通过 arrayfun 循环的情况下执行此操作。

```
[rowCount,colCount] = size(possibleDirections);
nonZeroCount = sum(possibleDirections ~= 0);
index = round(rand(1,colCount) .* nonZeroCount +0.5);
[nonZeroIndices,~] = find(possibleDirections);
index(2:end) = index(2:end) + cumsum(nonZeroCount(1:end-1));
result = possibleDirections(nonZeroIndices(index)+(0:rowCount:(rowCount*colCount-1))'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:56:31.323

替代解决方案：

```
[r,c] = size(possibleDirections);

[notUsed, idx] = max(rand(r, c).*(possibleDirections>0), [], 1);

val = possibleDirections(idx+(0:c-1)*r); 
```

如果矩阵`possibleDirections`中的元素始终为零或等于问题中给出的示例中的相应行号，则不需要最后一行，因为解决方案已经是`idx`.

还有一个（相当有趣的）单行：

```
result = imag(max(1e05+rand(size(possibleDirections)).*(possibleDirections>0) + 1i*possibleDirections, [], 1)); 
```

但是请注意，这种单线仅在`possibleDirections`中的值远小于时才有效`1e5`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T19:35:22.090

`arrayfun`通过两个调用尝试此代码：

```
nc = size(possibleDirections,2); %# number of columns
idx = possibleDirections ~=0;    %# non-zero values
%# indices of non-zero values for each column (cell array)
tmp = arrayfun(@(x)find(idx(:,x)),1:nc,'UniformOutput',0); 
s = sum(idx); %# number of non-zeros in each column
%# for each column get random index and extract the value
result = arrayfun(@(x) tmp{x}(randi(s(x),1)), 1:nc); 
```

# c# - 在 EditorFor 模板中将控件绑定到父模型

> ID：15119970
> 
> 赞同：1
> 
> 时间：2013-02-27T18:52:41.323
> 
> 标签：c#, asp.net-mvc, razor, asp.net-mvc-4

情况如下：我有一个绑定到父模型的视图。在这个视图中，我调用 EditorFor 并传递子对象。但是在那个EditorFor中，我想绑定一个父模型的控件。我该怎么做？我还需要绑定验证控件。我在父模型中创建了该属性。

```
@model ParentModel
   //Parent view 
  @using (Html.BeginForm())
  { 
       @Html.ValidationSummary(true)
       @Html.EditorFor(m => m.Entity, new { CountiesServed = Model.CountiesServed, Types = Model.EntityTypes, CommunicationMethods = Model.CommunicationMethods, OrganizationTypes = Model.OrganizationTypes })

            <p class="form-actions" style="text-align:right;">
                <button type="submit" >Next &#187;</button>
            </p>
   } 
```

在子视图中 - 我不想将控件绑定到其视图模型，而是绑定到父视图 //model。@model 子模型

```
@Html.EditorFor(m=>m.somechildentityproperty) 

//But how to do something like this? 
@Html.EditorFor(//ParentModel property) ??? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:50:37.090

如果`EditorFor`没有使用用作模型的属性，那么这是一个警告标志，它实际上应该是部分视图而**不是**and `EditorFor`。这样您就可以轻松地传入父模型。

否则，`EditorFor`您必须将 Parent 模型放在子属性上，这至少可以说是**混乱**的。

# c# - 使用队列创建 BackgroundWorker

> ID：15119974
> 
> 赞同：9
> 
> 时间：2013-02-27T18:53:01.783
> 
> 标签：c#, wpf, generics, queue, backgroundworker

我需要创建队列并将其与 BackgroundWorker 一起使用。所以我可以添加操作，下一个完成时在后台启动。我通过谷歌找到了这段代码：

```
public class QueuedBackgroundWorker<T>
{
    public void QueueWorkItem(
        Queue queue,
        T inputArgument,
        Func<T> doWork,
        Action workerCompleted)
    {
        if (queue == null) throw new ArgumentNullException("queue");

        BackgroundWorker bw = new BackgroundWorker();
        bw.WorkerReportsProgress = false;
        bw.WorkerSupportsCancellation = false;
        bw.DoWork += (sender, args) =>
        {
            if (doWork != null)
            {
                args.Result = doWork(new DoWorkArgument<T>((T)args.Argument));
            }
        };
        bw.RunWorkerCompleted += (sender, args) =>
        {
            if (workerCompleted != null)
            {
                workerCompleted(new WorkerResult<T>((T)args.Result, args.Error));
            }
            queue.Dequeue();
            if (queue.Count > 0)
            {
                QueueItem<T> nextItem = queue.Peek() as QueueItem<T>;
                nextItem.BackgroundWorker.RunWorkerAsync(nextItem.Argument);
            }
        };

        queue.Enqueue(new QueueItem<T>(bw, inputArgument));
        if (queue.Count == 1)
        {
            QueueItem<T> nextItem = queue.Peek() as QueueItem<T>;
            nextItem.BackgroundWorker.RunWorkerAsync(nextItem.Argument);
        }
    }
}

public class DoWorkArgument<T>
{
    public DoWorkArgument(T argument)
    {
        this.Argument = argument;
    }
    public T Argument { get; private set; }
}

public class WorkerResult<T>
{
    public WorkerResult(T result, Exception error)
    {
        this.Result = result;
        this.Error = error;
    }

    public T Result { get; private set; }
    public Exception Error { get; private set; }
}

public class QueueItem<T>
{
    public QueueItem(BackgroundWorker backgroundWorker, T argument)
    {
        this.BackgroundWorker = backgroundWorker;
        this.Argument = argument;
    }

    public T Argument { get; private set; }
    public BackgroundWorker BackgroundWorker { get; private set; }
} 
```

但我对 doWork 和 workerCompleted 有疑问。我得到错误：

> 委托 'Func' 不接受 1 个参数

我怎样才能解决这个问题？我应该如何更改参数？谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-27T18:58:38.583

这是一个更短的方法，可以满足您的要求：

```
public class BackgroundQueue
{
    private Task previousTask = Task.FromResult(true);
    private object key = new object();
    public Task QueueTask(Action action)
    {
        lock (key)
        {
            previousTask = previousTask.ContinueWith(t => action()
                , CancellationToken.None
                , TaskContinuationOptions.None
                , TaskScheduler.Default);
            return previousTask;
        }
    }

    public Task<T> QueueTask<T>(Func<T> work)
    {
        lock (key)
        {
            var task = previousTask.ContinueWith(t => work()
                , CancellationToken.None
                , TaskContinuationOptions.None
                , TaskScheduler.Default);
            previousTask = task;
            return task;
        }
    }
} 
```

通过添加每个新动作作为前一个动作的延续，您可以确保一次只处理一个动作，因为下一个动作在前一个动作完成之前不会开始，您可以确保在那里没有线程闲置没有什么可做的，并且您确保它们都按顺序完成。

另请注意，如果您只认为您需要一个队列而不是任何数量，您可以让所有成员成为`static`，但这取决于您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-25T22:03:00.517

看来您缺少第二个通用参数 - Tout；

以下代码应该处理它：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;

public static class QueuedBackgroundWorker
{
    public static void QueueWorkItem<Tin, Tout>(
        Queue<QueueItem<Tin>> queue,
        Tin inputArgument,
        Func<DoWorkArgument<Tin>, Tout> doWork,
        Action<WorkerResult<Tout>> workerCompleted)
    {
        if (queue == null) throw new ArgumentNullException("queue");

        BackgroundWorker bw = new BackgroundWorker();
        bw.WorkerReportsProgress = false;
        bw.WorkerSupportsCancellation = false;
        bw.DoWork += (sender, args) =>
            {
                if (doWork != null)
                {
                    args.Result = doWork(new DoWorkArgument<Tin>((Tin)args.Argument));
                }
            };
        bw.RunWorkerCompleted += (sender, args) =>
            {
                if (workerCompleted != null)
                {
                    workerCompleted(new WorkerResult<Tout>((Tout)args.Result, args.Error));
                }
                queue.Dequeue();
                if (queue.Count > 0)
                {
                    QueueItem<Tin> nextItem = queue.Peek(); // as QueueItem<T>;
                    nextItem.BackgroundWorker.RunWorkerAsync(nextItem.Argument);
                }
            };

        queue.Enqueue(new QueueItem<Tin>(bw, inputArgument));
        if (queue.Count == 1)
        {
            QueueItem<Tin> nextItem = queue.Peek() as QueueItem<Tin>;
            nextItem.BackgroundWorker.RunWorkerAsync(nextItem.Argument);
        }
    }
}

public class DoWorkArgument<T>
{
    public DoWorkArgument(T argument)
    {
        this.Argument = argument;
    }

    public T Argument { get; private set; }
}

public class WorkerResult<T>
{
    public WorkerResult(T result, Exception error)
    {
        this.Result = result;
        this.Error = error;
    }

    public T Result { get; private set; }

    public Exception Error { get; private set; }
}

public class QueueItem<T>
{
    public QueueItem(BackgroundWorker backgroundWorker, T argument)
    {
        this.BackgroundWorker = backgroundWorker;
        this.Argument = argument;
    }

    public T Argument { get; private set; }

    public BackgroundWorker BackgroundWorker { get; private set; }
} 
```

用法应该是：

```
 private readonly Queue<QueueItem<int>> _workerQueue = new Queue<QueueItem<int>>();
    private int _workerId = 1;

    [Test]
    public void BackgroundTest()
    {
        QueuedBackgroundWorker.QueueWorkItem(
            this._workerQueue, 
            this._workerId++,
            args =>  // DoWork
                {
                    var currentTaskId = args.Argument;
                    var now = DateTime.Now.ToLongTimeString();
                    var message = string.Format("DoWork thread started at '{0}': Task Number={1}", now, currentTaskId);
                    return new { WorkerId = currentTaskId, Message = message };
                },
            args =>  // RunWorkerCompleted
                {
                    var currentWorkerId = args.Result.WorkerId;
                    var msg = args.Result.Message;

                    var now  = DateTime.Now.ToShortTimeString();
                    var completeMessage = string.Format(
                        "RunWorkerCompleted completed at '{0}'; for Task Number={1}, DoWork Message={2}",
                        now,
                        currentWorkerId,
                        msg);
                }
            );
    } 
```

# javascript - 从 Node.js 中的嵌套函数中获取变量

> ID：15119976
> 
> 赞同：0
> 
> 时间：2013-02-27T18:53:05.293
> 
> 标签：javascript, node.js

我正在使用一个函数来检查用户是否已经在网站上注册。但是我不知道如何从`rows`函数中获取值`selectEmail()`

我试图将它存储在 中`temp`，但它似乎将它存储在它自己的本地版本中，一旦查询部分结束，我就会留下一个空变量。

```
function checkEmail(email, req, res){
  var temp;
  dbConnect(req,res);
  var query = 'SELECT EMAIL FROM USERS WHERE EMAIL="'+email+'"';
  connection.query(query, function selectEmail(err,rows,fields){
    if (err) {
        throw err;
      }
    temp=rows;
  })
  dbClose(req,res);
  console.log(temp);
  if (temp==""){
      console.log('No matching email in database');
      return 0;
  }
  else{
      console.log('Duplicate Email detected in database');
      return 1;
  }
} 
```

我听说我应该使用回调，但我也不知道如何让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:03:46.917

我猜这`connection.query`是异步的，这意味着它不会在其余代码执行之前完成。这意味着`temp`当你到达时它没有价值`if(temp==""){`。

为了处理这个问题，使用了回调。回调是在代码完成后调用的函数，在本例中为`connection.query()`. 这正是您在这种情况下所拥有的，除了格式不完全正确：

```
connection.query(query, function selectEmail(err,rows,fields){
    if (err) {
        throw err;
    }
    temp=rows;
}) 
```

这`selectEmail()`是回调，除了回调应该作为函数指针或匿名函数（没有名称）提供：

```
connection.query(query, function(err,rows,fields){
    if (err) {
        throw err;
    }
    temp=rows;
}); 
```

此代码很可能会在`checkEmail()`返回后出现。完成后您想要发生`conection.query()`的任何事情都应该**在**回调中或**由**回调调用。像这样：

```
connection.query(query, function(err,rows,fields){
    if (err) {
        throw err;
    }

    dbClose(req,res);

    if (rows==""){
        console.log('No matching email in database');
        handleEmailCheckFailure();
    }
    else{
        console.log('Duplicate Email detected in database');
        handleEmailCheckSuccess();
    }
}); 
```

当然，您希望`checkEmail()`根据检查是否成功返回一个值。这不适用于异步调用。您将需要具有处理通过和失败案例的功能（`handleEmailCheckFailure`上面的等）。您还需要注意，在调用这些情况中的任何一种之前，都会经过一段时间，具体取决于连接。

# javascript - 单击单选选项时显示文本框

> ID：15119985
> 
> 赞同：0
> 
> 时间：2013-02-27T18:53:33.847
> 
> 标签：javascript, html

我试图让这个函数显示/隐藏文本框元素。到目前为止，我运气不佳。谁能告诉我如何通过在您选择的单选选项上设置其样式可见或不挂起来显示和隐藏元素？这是我到目前为止所拥有的。

脚本

```
 function hide(id)
            {
                document.getElementById(id).style.visibility='hidden';
            }

            function show(id)
            {
                document.getElementById(id).style.visibility='visible'; 
            } 
```

html

```
 <div data-role="fieldcontain" data-theme="c" id="quests'+id+'">
            <fieldset data-role="controlgroup" data-type="horizontal">
            <label>Question?</label>

            <input type="radio" name="radio1" id="'+QuestionID+'_1" value="1" onClick="show("comment_'+QuestionID+'")"/>
            <label for="'+QuestionID+'_1">Yes</label>

            <input type="radio" name="radio1" id="'+QuestionID+'_0" value="0" onclick="hide("comment_'+QuestionID+'")"/>
            <label for="'+QuestionID+'_0">No</label>
            </fieldset>

            //I am trying to make these visable if yes is selected
            <textarea cols="30" rows="8" name="textarea" style="width:80%; visibility:hidden;" id="comment_'+QuestionID+'"></textarea>
            <br />
            </div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:00:22.063

`onSelect`在单选按钮上没有任何意义......它用于在输入字段中“选择”文本。改为使用`onClick`。但是，如果您使用`onClick`，则需要检查单选按钮是否实际被选中，因此这会使您的 JS 部分复杂化。

由于您将问题标记为“jQuery”，这就是我要做的：

HTML：

```
<div class="radioToggle" data-role="fieldcontain" data-theme="c" id="quests'+id+'">
    <fieldset data-role="controlgroup" data-type="horizontal">
        <label>Question?</label>

        <input type="radio" name="radio1" id="'+QuestionID+'_1" value="1" />
        <label for="'+QuestionID+'_1">Yes</label>

        <input type="radio" name="radio1" id="'+QuestionID+'_0" value="0" />
        <label for="'+QuestionID+'_0">No</label>
    </fieldset>

    //I am trying to make these visable if yes is selected
    <textarea cols="30" rows="8" name="textarea" style="width:80%; visibility:hidden;" id="comment_'+QuestionID+'"></textarea>
    <br />
</div> 
```

JS：

```
$('.radioToggle').on('click', 'input:radio', function(){
    var parent = $(this).closest('.radioToggle'),
        textbox = parent.find('textbox');
    if ($(this).attr('id') == '1') {
        textbox.show();
    } else {
        textbox.hide();
    }
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:05:21.020

我认为您正在尝试使用生成的代码（可能是 php）来完成某些事情。以下是您需要做的事情的要点：

```
<div data-role="fieldcontain" data-theme="c" id="quests'+id+'">
    <fieldset data-role="controlgroup" data-type="horizontal">
        <label>Question?</label>
        <input type="radio" name="radio1" value="1" data-id="123" />
        <label>Yes</label>
        <input type="radio" name="radio1" value="0" data-id="123" />
        <label>No</label>
    </fieldset>
    <textarea cols="30" rows="8" name="textarea" style="width:80%; visibility:hidden;"></textarea>
    <br />
</div>
<div id="comment_123" style="display:none">here I am</div> 
```

和脚本：

```
$("input[type='radio']").change(function () {
    if ($(this).val() == "1") {
        $('#comment_' + $(this).data("id")).show();
    } else {
        $('#comment_' + $(this).data("id")).hide();
    }
}); 
```

这里有一个小提琴来说明这个想法：http: [//jsfiddle.net/DgAHf/](http://jsfiddle.net/DgAHf/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T19:14:27.327

```
$('input[type="radio"][name="radio1"]').on('change', function() {
    $('textarea[name="textarea"]').toggle($.trim(this.value)=='1');
}); 
```

[**小提琴**](http://jsfiddle.net/5WF25/)

# ruby-on-rails-3 - Bootstrap'始终按下主页按钮'

> ID：15119991
> 
> 赞同：1
> 
> 时间：2013-02-27T18:53:54.917
> 
> 标签：ruby-on-rails-3, nav, twitter-bootstrap-rails

我在引导程序中遇到了这个奇怪的问题，我搜索了堆栈溢出以及其他来源，但无济于事。基本上，我的导航上的“主页”按钮总是被按下，即使我在“关于”页面或任何其他页面上。

这是我导航的图像，因此您可以看到我在说什么。

[http://i.imgur.com/wDcuEpm.png](http://i.imgur.com/wDcuEpm.png)

我希望我们能解决这个问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:59:11.387

您很可能`active`在模板中的 home 元素上设置了类。应该为当前活动页面设置它，而不是硬编码到主页。[http://twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

# c# - 将 SSH 密钥安全存储到 Windows 中，以便与 C# 一起使用以与 Linux 机器进行通信

> ID：15119992
> 
> 赞同：1
> 
> 时间：2013-02-27T18:53:56.393
> 
> 标签：c#, encryption, ssh, rsa

我正在开发一个需要与一些使用 SSH 的远程系统安全通信的 C#/WPF 业务线应用程序。我想通过 SSH v2 使用公钥身份验证来执行此操作。我已经想到了一个特定的库，但我需要知道在 Windows 中安全地存储我的 SSH 密钥并在 C# 中访问它们的最佳方法。解决此问题的最佳做法是什么？我已经看到[存在 RSA 密钥容器](http://msdn.microsoft.com/en-us/library/2w117ede%28v=vs.100%29.aspx)，但它们似乎与 ASP.NET 相关联。我假设这些可以通用用于任何 .NET 应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:46:35.433

我建议将您的敏感信息保存在[隔离存储](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.aspx)中，它是可配置的，您可以进行编程访问，并且易于在 .net 中使用。

# hibernate - 如何在 Hibernate 条件中编写 NOT IN 查询？

> ID：15119996
> 
> 赞同：7
> 
> 时间：2013-02-27T18:53:59.720
> 
> 标签：hibernate, criteria

这是我试图在 Criteria 中编写的查询：

```
 SELECT * FROM abc 
    WHERE NOT PartType IN ('0','4','5','6','7','a','b','c') 
```

以上是在 iBatis 中。

所以这是表的 hbm.xml

```
 <class name="Parts" table="SomeDb..Parts">
        <id name="recordNumber" column="Recnum" />
        <property name="partNumber" column="Partnum" />
        <property name="sectionNumber" column="Secnum" />
        <property name="articleNumber" column="Articlenum"/>
        <property name="headerNumber" column="Headernum"/>
        <property name="partType" column="PartType"/>
        <property name="code" column="Code"/>
  </class> 
```

partType 是 nvarchar，在 SQL Server 数据库中长度为 1。我正在尝试选择不包含“0”、“4”、“5”、“6”、“7”、“a”、“b”、“c”的任何部分类型的记录。希望我已经回答了你的问题。谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-27T20:25:01.700

```
Criteria criteria = ...;
criteria.add(
  Restrictions.not(
    Restrictions.in("partType", new String[] {"0","4","5","6","7","a","b","c"})
  )
); 
```

希望能帮助到你。

# oop - 用于在继承层次结构中创建对象的单个或多个抽象工厂？

> ID：15119997
> 
> 赞同：0
> 
> 时间：2013-02-27T18:54:01.387
> 
> 标签：oop, design-patterns, software-design, abstract-factory

我有以下健身俱乐部场景（用 C++ BTW 编码）：

![UML 图](../Images/7dd9957f5dd632d19a3e0d110709d9d2.png)

我想创建随机的 Guest 和 Trainer 对象（因此两者都会随机生成名称，但来宾也会有随机的健康数据）。

我希望能够制作许多不同复杂度的随机生成器。

很明显，两者都需要随机名字/姓氏生成器功能 - 但我不确定如何将这段代码保存在一个地方。

我可以有一个包含所有生成方法（例如 generateForename()）的抽象工厂，所有需要随机生成的对象都可以使用它。但是，培训师是否应该有权访问可以生成健康数据的工厂，即使它与这些数据无关？

我还考虑过为每个类建立一个抽象工厂——一个用于人，一个用于客户，一个用于客人，并让对象通过将它们传递给适当的工厂来生成它们的超类，但这对于这种情况来说听起来过于复杂。

我对此很陌生，所以如果我的设计有点偏离，请原谅我。

你们有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T12:20:07.097

我不确定抽象工厂是您正在寻找的东西。当您具有相同的基类但需要创建不同的具体实例时，抽象工厂效果最佳。尽管您有 Person 的根基类，但实际上您需要创建两个不同基类的派生类。

我会努力将生成数据的方法与包含该数据的类保持在一起。这样就可以重复使用了。

您能否在 Guest 和 Trainer 上创建一个工厂方法，然后能够使用它们各自基类中的方法来生成数据？也许创建特定于测试的子类以使测试的东西远离真实的东西？

# c++ - 如何在 Windows XP 下从 Dev-c++ 中获取预处理代码？

> ID：15119998
> 
> 赞同：1
> 
> 时间：2013-02-27T18:54:08.127
> 
> 标签：c++, c-preprocessor, dev-c++

如何在 Windows XP 下从 DevC++ 中获取预处理的 C++ 代码？我已阅读有关创建 `gcc -E file.cpp`文件的信息，但仍然无法连接点，如何运行此文件？在我编译它之后，一切都照常进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:57:44.327

您根本无法*“运行”*预处理文件。您可以**编译**并运行它，或检查预处理器生成的内容。

例如，当使用 GCC 时，您可以运行

```
gcc file.cpp -E <all preprocessor options as set from the IDE> -o file_preprocessed.cpp 
```

获取`file_preprocessed.cpp`文件进行检查。

我不知道特别是[dev-c++](/questions/tagged/dev-c%2b%2b "显示标记为“dev-c++”的问题") IDE，但通常你会在项目设置中的某个地方获得项目实际使用的编译器标志的表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:40:41.237

跑

> gcc file.cpp -E -o file_preprocessed.cpp

然后你可以打开 file_preprocessed.cpp 来查看输出