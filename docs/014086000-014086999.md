# StackOverflow 问答 14086000-14086999

# django - Google Appengine / Django / NDB 设置在服务器启动时抛出 mysqldb 错误

> ID：14086003
> 
> 赞同：0
> 
> 时间：2012-12-29T21:17:45.310
> 
> 标签：django, google-app-engine, app-engine-ndb

我在 OSX Mountain Lion 上使用 python 2.7 在 vi​​rtualenv 中运行 Django 1.3。当我运行 dev_appserver.py 时，我遇到了这个问题。（忽略关于`images API`.

**问题：为什么我在使用时会收到`mysqldb`警告`ndb`？**

**问题：我需要对警告做些什么吗？**

这是我第一次使用 Python、Django 和 AppEngine，所以我不知道我在设置过程中是否做错了什么。我没有对数据库做任何事情（例如`syncdb`）

```
WARNING  2012-12-29 21:05:26,272 rdbms_mysqldb.py:74] The rdbms API is not available because the MySQLdb library could not be loaded.
INFO     2012-12-29 21:05:26,356 appcfg.py:586] Checking for updates to the SDK.
INFO     2012-12-29 21:05:26,795 appcfg.py:604] The SDK is up to date.
WARNING  2012-12-29 21:05:26,795 dev_appserver.py:3571] The datastore file stub is deprecated, and
will stop being the default in a future release.
Append the --use_sqlite flag to use the new SQLite stub.

You can port your existing data using the --port_sqlite_data flag or
purge your previous test data with --clear_datastore.

WARNING  2012-12-29 21:05:26,795 datastore_file_stub.py:518] Could not read datastore data from /var/folders/92/tl1hq8ps1v18n1m68s6fxkp00000gn/T/dev_appserver.datastore
WARNING  2012-12-29 21:05:26,797 dev_appserver.py:3670] Could not initialize images API; you are likely missing the Python "PIL" module. ImportError: No module named _imaging
INFO     2012-12-29 21:05:26,802 dev_appserver_multiprocess.py:655] Running application dev~google-solveforx on port 8080: http://localhost:8080
INFO     2012-12-29 21:05:26,802 dev_appserver_multiprocess.py:657] Admin console is available at: http://localhost:8080/_ah/admin 
```

应用程序.yaml

```
application: appname
version: staging
runtime: python27
api_version: 1
threadsafe: false 
```

主文件

```
import os
from django.core.handlers import wsgi
from google.appengine.ext import ndb

os.environ['DJANGO_SETTINGS_MODULE'] = 'appname.settings'

# Wrapping the WSGI application in ndb.toplevel ensures that all async
# operations complete before returning.
application = ndb.toplevel(wsgi.WSGIHandler()) 
```

设置.py

```
import os

DEBUG = os.environ.get('SERVER_SOFTWARE', '').startswith('Dev')

ROOT_URLCONF = 'solveforx.urls'

MIDDLEWARE_BASE = 'solveforx.lib.middleware'

MIDDLEWARE_CLASSES = (
    'django.middleware.csrf.CsrfViewMiddleware',
    '%s.SecurityMiddleware' % MIDDLEWARE_BASE,
    '%s.TemplateContext' % MIDDLEWARE_BASE,
)

TEMPLATE_CONTEXT_PROCESSORS = (
    'django.core.context_processors.csrf',
    'django.core.context_processors.request',
)

# By default django will load the templates under templates/ directory under
# every installed apps.
INSTALLED_APPS = (
    'appname.frontend',
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:26:19.353

如果您打算使用 Cloud SQL，则只需要 Mysqldb。[https://developers.google.com/cloud-sql/](https://developers.google.com/cloud-sql/)

# c - 可变参数函数中的参数如何在堆栈上传递？

> ID：14086005
> 
> 赞同：2
> 
> 时间：2012-12-29T21:17:59.383
> 
> 标签：c, assembly, stack

我认为该函数在完成后会从堆栈中删除参数，但是像 printf 这样的函数在调用时会从堆栈中删除可变数量的参数。

它如何知道要从堆栈中删除多少参数？是否有一个秘密参数来指定传递了多少个参数？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:20:09.657

*C 调用约定*指定是*调用者*而不是*被调用者*负责从堆栈中弹出参数。这就是为什么具有可变参数列表的函数必须是`cdecl`. 所以，

> 我认为该函数在完成后会从堆栈中删除参数。

这仅适用于某些调用约定，而不适用于*C 调用约定*。

> 它如何知道要从堆栈中删除多少参数？是否有一个秘密参数来指定传递了多少个参数？

它没有，不，没有秘密的论点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:26:08.263

调用者函数将清理堆栈（以正确的调用约定）。编译器将为此生成代码。编译器确切地知道您在参数列表中传递了多少参数，因为它编译了它..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T21:36:47.077

调用代码清理堆栈，并由被调用函数正确确定是否为它想要做的任何事情传递了“足够”的参数。这不一定是这样的论点，它可能是这样的：

```
int sum(int first, ...)
{
    int s = first;
    int v;
    va_list va;
    va_start(va, first);

    while (v = va_arg(va, int) != -1)
    {
         sum += v;
    }

    va_end(va);
    return sum;
 }

 x = sum(1, 2, 3, -1);
 y = sum(1, 2, 3, 4, 5, 6, 7, 8, 9, -1); 
```

链接到[可变参数函数中有多少个参数](http://www.gnu.org/software/libc/manual/html_node/How-Many-Arguments.html#How-Many-Arguments)

# c++ - WS_EX_LAYERED 父级的 Win32 编辑控件在其背景透明时不接收鼠标/单击事件

> ID：14086006
> 
> 赞同：0
> 
> 时间：2012-12-29T21:18:04.537
> 
> 标签：c++, winapi

我想将一些编辑字段放在启动屏幕的顶部，该屏幕在另一个顶级窗口中呈现（类似于此[http://code.logos.com/blog/2008/09/displaying_a_splash_screen_with_c_part_ii.html](http://code.logos.com/blog/2008/09/displaying_a_splash_screen_with_c_part_ii.html)的透明 PNG ）。

我制作了一个始终位于初始屏幕顶部的辅助窗口，并使用 WS_EX_LAYERED 使其也透明。

现在我通过捕获 WM_CTLCOLOREDIT 设置 wndproc 中编辑字段的背景颜色。

这很好用，我的输入控件是透明的（例如不可见），并且只有输入的文本在初始屏幕上可见。

现在问题来了，指示此处为文本框的鼠标光标不起作用，我也无法单击该框使其成为焦点。如果我不使编辑控件的背景透明，问题就会全部消失。透明时也没有 WM_NCHITTEST。我获得鼠标光标的唯一时间是框中是否已经输入了（可见）文本

```
g_HWNControlsParent = CreateWindowEx( WS_EX_LAYERED,.....);
hwLoginField = CreateWindowEx(NULL,"EDIT", "-User-",    WS_CHILD|WS_VISIBLE|WS_TABSTOP, ....g_HWNControlsParent);
SetLayeredWindowAttributes(g_HWNControlsParent,RGB(0, 0, 0), 0, LWA_COLORKEY) ; 
```

在 HWNControlsParent wndproc

```
case WM_CTLCOLOREDIT: { // BG Color of Input Fields
        HDC hdc = (HDC)wParam;
        SetTextColor(hdc, RGB(230,230,230));
        SetBkColor(hdc, RGB(0,0,0)); // Color of Background where Text is entered
         SetDCBrushColor(hdc, RGB(0,0,0)); // Color of Background where no Text is
        return (LRESULT) GetStockObject(DC_BRUSH); // return a DC brush.
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:21:21.793

If you use an alpha of 1 instead of 0 for the transparent regions, they will still be transparent but will respond to mouse clicks.

# node.js - 在 node.js 和 pg 中 Postgresql 连接超时

> ID：14086011
> 
> 赞同：1
> 
> 时间：2012-12-29T21:18:35.523
> 
> 标签：node.js, postgresql, openshift, pg

我是 node、postgresql 和整个 Web 开发业务的新手。我目前正在编写一个简单的应用程序，它连接到 postgres 数据库并在 Web 视图中显示表的内容。该应用程序将托管在 OpenShift 中。

我的主要条目是`server.js`：

```
var pg = require('pg');
pg.connect(connection_string, function(err, client) {
    // handle error
    // save client: app.client = client;
}); 
```

现在，处理`GET /`请求：

```
function handle_request(req, res){
    app.client.query('...', function(err, result){
        if (err) throw err; // Will handle error later, crash for now
        res.render( ... );  // Render the web view with the result
    });
} 
```

我的应用程序似乎可以工作：表格在 Web 视图中正确呈现，并且适用于多个连接（来自不同设备的不同 Web 客户端）。但是，如果几分钟内没有请求，则后续请求将导致应用程序崩溃并显示超时信息。这是堆栈信息：

```
/home/hai/myapp/server.js:98
            if (err) throw err;
                           ^
Error: This socket is closed.
    at Socket._write (net.js:474:19)
    at Socket.write (net.js:466:15)
    at [object Object].query (/home/hai/myapp/node_modules/pg/lib/connection.js:109:15)
    at [object Object].submit (/home/hai/myapp/node_modules/pg/lib/query.js:99:16)
    at [object Object]._pulseQueryQueue (/home/hai/myapp/node_modules/pg/lib/client.js:166:24)
    at [object Object].query (/home/hai/myapp/node_modules/pg/lib/client.js:193:8)
    at /home/hai/myapp/server.js:97:17
    at callbacks (/home/hai/myapp/node_modules/express/lib/router/index.js:160:37)
    at param (/home/hai/myapp/node_modules/express/lib/router/index.js:134:11)
    at pass (/home/hai/myapp/node_modules/express/lib/router/index.js:141:5) 
```

有没有办法防止连接超时（更好）？还是按需重新连接（最好）？我试图重新设计我的应用程序，一开始不连接到数据库，而是根据`GET /`请求。此解决方案仅适用于第一个请求，然后在第二个请求中崩溃。任何见解都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:00:37.050

您是否查看过 postgres keepalive 设置值？它发送数据包以防止空闲连接超时。 [http://www.postgresql.org/docs/9.1/static/runtime-config-connection.html](http://www.postgresql.org/docs/9.1/static/runtime-config-connection.html)

我还发现了这个类似的问题： [如何在 Postgresql 中使用 tcp_keepalives 设置？](https://stackoverflow.com/questions/2166872/how-to-use-tcp-keepalives-settings-in-postgresql)

您还可以按设定的时间间隔从数据库执行非常小的查询。但是，这种方法肯定更受黑客攻击。

编辑：您也可以尝试像这样启动客户端：

```
var client = new pg.Client(conString); 
```

在进行查询之前，您可以检查客户端是否仍处于连接状态。我相信你可以使用：

```
if(client.connection._events != null)
    client.connect(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T13:07:16.443

面临同样的问题..告诉客户端在结束事件时关闭连接

```
query.on('end', function() { 
  client.end();
}); 
```

为我做了伎俩...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-29T09:11:40.937

您还可以将 30 秒的默认空闲超时更改为您需要的任何值。例如

```
pg.defaults.poolIdleTimeout = 600000; // 10 mins 
```

# delphi - TServerSocket Delphi 上的多字节字符支持

> ID：14086012
> 
> 赞同：6
> 
> 时间：2012-12-29T21:18:48.847
> 
> 标签：delphi, delphi-2010

在开发多用户聊天应用程序时，我一直在努力让多字节字符在 TServerSocket / TClientSocket 上工作。

这是客户端向服务器发送消息的部分：

```
 procedure TChatForm.SendBtnClick(Sender: TObject);
  var str : string;
  begin
    str := MsgLabel.Text;
    ClientSocket.Socket.SendText('message' + separator + nickname + separator + str);
    MsgLabel.Text := '';
    add_text(MsgBox,MsgLabel,nickname+': '+str,'none');
  end; 
```

这是服务器解析接收到的数据的方式：

```
procedure TServerForm.ServerSocketClientRead(Sender: TObject;Socket: TCustomWinSocket);
var
  i,hnd : Integer;
  recv : string;
  arr : TStringArray; // type TStringArray = array of string;
begin
  recv := Socket.ReceiveText;
  hnd := Socket.Handle; //using this to avoid sending received data back to the client
  arr := SplitStr(recv,separator); 
  //SplitStr is a function i use because TStringList.DelimitedText uses only a char as delimiter 

  // sending the data to the others users / but the expeditor - async error workaround
  for i:=0 to ServerSocket.Socket.ActiveConnections-1 do begin
    if ServerSocket.Socket.Connections[i].Handle <> hnd then
      ServerSocket.Socket.Connections[i].SendText(recv);
  end;

  if arr[0] = 'connect' then begin

    // adding the connected user to the tlistbox
    Contacts.Items.Add(arr[1]);
    // adding the connected message in the trichedit
    add_text(MsgBox,SendMsg,arr[1]+' has connected !','green');

  end else if arr[0] = 'disconnect' then begin

    // removing the user from the online user list
    Contacts.Items.Delete(Contacts.Items.IndexOf(arr[1]));
    // adding the disconnected message in trichedit
    add_text(MsgBox,SendMsg,arr[1]+' has disconnected !','red');

  end else if arr[0] = 'message' then begin

    // finally adding the message that user send in the TRichEdit
    add_text(MsgBox,SendMsg,arr[1]+': '+arr[2],'none');

  end;
end; 
```

Socket.ReceiveText 的示例如下：

```
- when user connects he sends the next message - connect^SEPARATOR^username
- when a user sends a message - message^SEPARATOR^username^SEPARATOR^message_body 
```

结构是 ACTION + SEPARATOR + USERNAME + EXTRA_DATA，这是我“保持”在线用户列表更新的方式。我是delphi的新手，如果有更简单的方法，请告诉我。

现在的问题是，如果我将多字节字符发送给用户并返回，这些多字节字符将作为问号“？”接收。- "ț or ș" 变成 "? or ?"

此处打印屏幕：![在此处输入图像描述](../Images/5ec52a8b631da0fb008124537b5fbac7.png)

EDIT2：好的，在进行了所有更改之后，由于您的回答，我在尝试将服务器从客户端接收到的数据发送回其他客户端时遇到了一个问题。这个问题有两个小问题：

1.  这就是服务器向用户发送“全局”消息的方式。

    ```
    procedure TServerForm.SendBtnClick(Sender: TObject);
    var
      i : Integer;
      str : String;
    begin
      str := SendMsg.Text;

      with ServerSocket.Socket do
      begin
        for i := 0 to ActiveConnections-1 do
          SendString(Connections[i], TSocketBuffers(Connections[i].Data).OutBuffer, 'global' + separator + str);
      end;

      add_text(MsgBox,SendMsg,str,'none');
      SendMsg.Text := '';
    end; 
    ```

2.  这是服务器如何将从一个客户端接收到的数据发送回其他活动连接：

    ```
    procedure TServerForm.ServerSocketClientRead(Sender: TObject;Socket: TCustomWinSocket);
    var
      Buffers: TSocketBuffers;
      i: Integer;
      RecvStr : String;
      arr : TStringArray;
    begin
      Buffers := TSocketBuffers(Socket.Data);
      if not Buffers.ReadInData(Socket) then Exit;
      Buffers.InBuffer.Position := 0;
      try
        while ReadString(Buffers.InBuffer, RecvStr) do
        begin
          arr := SplitStr(RecvStr, separator);

          with ServerSocket.Socket do
          begin
            for i := 0 to ActiveConnections-1 do
            begin
              if Connections[i] <> Socket then
                SendString(Connections[i], TSocketBuffers(Connections[i].Data).OutBuffer, arr[0]);
            end;
          end;

          // [ .. some string processing stuff .. ]
        end;
      finally
        CompactBuffer(Buffers.InBuffer);
      end;
    end; 
    ```

现在，如果这两种方法都正确，那么问题是在客户端读取数据，这就是客户端如何按照与 ServerSocketClientRead(Sender: TObject;Socket: TCustomWinSocket); 相同的原理解析数据的方式。

```
 procedure TChatForm.ClientSocketRead(Sender: TObject; Socket: TCustomWinSocket);
    var
      Buffers: TSocketBuffers;
      i: Integer;
      RecvStr : String;
      arr : TStringArray;
    begin
      Buffers := TSocketBuffers(Socket.Data);
      if not Buffers.ReadInData(Socket) then Exit;
      Buffers.InBuffer.Position := 0;
      try
        while ReadString(Buffers.InBuffer, RecvStr) do begin
          ShowMessage(RecvStr); // testing if anything is received
          // [[.. some string processing code ..]]
        end;
      finally
        CompactBuffer(Buffers.InBuffer);
      end;
    end; 
```

![在此处输入图像描述](../Images/83a92d8e13dfbd3ea9757ebfe1c97b52.png)

正如您在图像（上图）中看到的那样，尝试将数据从客户端发送到服务器完美无缺，字符串被解释为应有的样子。问题是尝试在 ServerSocketClientRead 方法中或在 ClientSocketRead 方法中将数据发送回客户端。

更新 3：所以我在另一台电脑上启动了客户端，问题似乎出在 ClientSocketRead 方法上（如果 ServerSocketClientRead -> SendString 和全局 SendBtn -> SendString 是正确的）；如果发现任何新的细节，我会继续更新。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-30T04:03:22.737

您需要远离`SendText()`and`ReceiveText()`方法，尤其是在使用非阻塞套接字时。它们不处理数据可能必须以多个数据包发送，数据包可以以较小的部分到达甚至多个数据包合并在一起的情况。这些是您在 TCP 编程中必须处理的非常常见的情况。

`SendText()`只需将字符串按原样传递给`SendBuf()`. 如果它不能在一次发送中发送整个字符串，它不会尝试重新发送剩余的字符。因此，您可以（并且可能会）发送不完整的字符串。它确实返回实际发送了多少字节，因此您可以`SendText()`循环调用，直到没有更多字符要发送。

`ReceiveText()`无法知道接收到的字符串的长度。它只是读取当前套接字缓冲区中的任何内容并将其作为字符串返回。所以这也存在读取不完整字符串，甚至一起读取多个（甚至部分）字符串的风险。

发送字符串的最好方法是直接使用`SendBuf()`and `ReceiveBuf()`。发送字符串时，要么在发送字符串数据之前发送字符串长度（以字节为单位），要么在字符串数据之后发送一个不出现在字符串本身中的唯一分隔符。然后接收方可以读取长度值，然后读取指定的字节数，或者读取直到遇到分隔符。另外，在处理非ASCII字符串数据时，尤其是D2009+的`UnicodeString`字符串类型时，应在传输过程中将字符串数据编码为通用格式，如UTF-8。

如果您使用的是非阻塞套接字，这会变得更加复杂。如果套接字在发送/读取操作期间进入阻塞状态，则操作将失败并显示`WSAEWOULDBLOCK`错误代码，并且您必须在套接字脱离阻塞状态时重复该操作。

如果发送操作失败，`WSAEWOULDBLOCK`则在某处缓冲剩余的数据（如果不为空，则将任何未来的出站数据附加到该缓冲区的末尾）直到`OnWrite`事件触发，然后发送缓冲区中的任何内容，删除成功发送的字节，直到它被清空或套接字再次阻塞（在这种情况下，您必须等待另一个`OnWrite`事件才能发送剩余的缓冲区数据）。

同样，当读取操作失败`WSAEWOULDBLOCK`但您仍在等待数据时，您必须等待另一个`OnRead`事件触发，然后才能尝试再次读取，缓冲已收到的任何中间数据，直到您收到所有数据在您可以处理它之前，您正在期待它。

例如：

常用代码：

```
type
  TSocketData = class
  private
    Socket: TCustomSocketSocket;
    InBuffer: TMemoryStream;
    OutBuffer: TMemoryStream;
    function SendRawToSocket(Data: Pointer; DataLen: Integer): Integer;
    procedure Compact(Buffer: TMemoryStream);
  public
    constructor Create(ASocket: TCustomSocketSocket);
    destructor Destroy; override;
    function BufferInboundData: Boolean;
    procedure FlushOutboundData;
    procedure BeginReading;
    procedure EndReading;
    function SendRaw(Data: Pointer; DataLen: Integer): Boolean;
    function ReadRaw(Data: Pointer; DataLen: Integer): Boolean;
    function SendInteger(Value: Integer): Boolean;
    function ReadInteger(var Value: Integer): Boolean;
    function SendInt64(Value: Int64): Boolean;
    function ReadInt64(var Value: Int64): Boolean;
    function SendString(const Str: String): Boolean;
    function ReadString(var Str: String): Boolean;
    function SendStream(Stream: TStream): Boolean;
    function ReadStream(Stream: TStream): Boolean;
   end;

constructor TSocketData.Create(ASocket: TCustomWinSocket);
begin
  inherited;
  Socket := ASocket;
  InBuffer := TMemoryStream.Create;
  OutBuffer := TMemoryStream.Create;
end;

destructor TSocketData.Destroy;
begin
  InBuffer.Free;
  OutBuffer.Free;
  inherited;
end;

function TSocketData.SendRawToSocket(Data: Pointer; DataLen: Integer): Integer;
var
  Bytes: PByte;
  Ret: Integer;
begin
  Result := 0;
  Bytes := PByte(Data);
  while DataLen > 0 do
  begin
    Ret := Socket.SendBuf(Bytes^, DataLen);
    if Ret < 1 then
    begin
      if WSAGetLastError = WSAEWOULDBLOCK then Break;
      Result := -1;
      Exit;
    end;
    Inc(Bytes, Ret);
    Dec(DataLen, Ret);
    Inc(Result, Ret);
  end;
end;

function TSocketData.BufferInboundData: Boolean;
var
  RecvLen, OldSize: Integer;
begin
  Result := False;

  RecvLen := Socket.ReceiveLength;
  if RecvLen < 1 then Exit;

  OldSize := InBuffer.Size;
  InBuffer.Size := OldSize + RecvLen;
  try
    RecvLen := Socket.ReceiveBuf((PByte(InBuffer.Memory)+OldSize)^, RecvLen);
    if RecvLen < 1 then RecvLen := 0;
  except
    RecvLen := 0;
  end;
  InBuffer.Size := OldSize + RecvLen;
  if RecvLen = 0 then Exit;

  Result := True;
end;

procedure TSocketData.FlushOutboundData;
var
  Ret: Integer;
begin
  if OutBuffer.Size = 0 then Exit;
  Ret := SendRawToSocket(OutBuffer.Memory, OutBuffer.Size);
  if Ret < 1 then Exit;
  OutBuffer.Position := Ret;
  Compact(OutBuffer);
end;

procedure TSocketData.Compact(Buffer: TMemoryStream);
var
  Remaining: Integer;
begin
  if Buffer.Position = 0 then Exit;
  Remaining := Buffer.Size - Buffer.Position;
  if Remaining > 0 then
    Move((PByte(Buffer.Memory) + Buffer.Position)^, Buffer.Memory^, Remaining);
  Buffer.Size := Remaining;
end;

procedure TSocketData.BeginReading;
begin
  InBuffer.Position := 0;
end;

procedure TSocketData.EndReading;
begin
  Compact(InBuffer);
end;

function TSocketData.SendRaw(Data: Pointer; DataLen: Integer): Boolean;
var
  Bytes: PByte;
  Ret: Integer;
begin
  Bytes := PByte(Data);
  if OutBuffer.Size = 0 then
  begin
    Ret := SendRawToSocket(Bytes, DataLen);
    if Ret = -1 then
    begin
      Result := False;
      Exit;
    end;
    Inc(Bytes, Ret);
    Dec(DataLen, Ret);
  end;
  if DataLen > 0 then
  begin
    OutBuffer.Seek(0, soEnd);
    OutBuffer.WriteBuffer(Bytes^, DataLen);
  end;
  Result := True;
end;

function TSocketData.ReadRaw(Data: Pointer; DataLen: Integer): Boolean;
begin
  Result := False;
  if (InBuffer.Size - InBuffer.Position) < DataLen then Exit;
  InBuffer.ReadBuffer(Data^, DataLen);
  Result := True;
end;

function TSocketData.SendInteger(Value: Integer): Boolean;
begin
  Value := htonl(Value);
  Result := SendRaw(@Value, SizeOf(Value));
end;

function TSocketData.ReadInteger(var Value: Integer): Boolean;
begin
  Result := ReadRaw(@Value, SizeOf(Value));
  if Result then Value := ntohl(Value);
end;

type
  TInt64Parts = packed record
    case Integer of
    0: (
      LowPart: LongWord;
      HighPart: LongWord);
    1: (
      QuadPart: Int64);
  end;

function hton64(AValue: Int64): Int64;
var
  LParts: TInt64Parts;
  L: LongWord;
begin
  LParts.QuadPart := AValue;
  L := htonl(LParts.HighPart);
  LParts.HighPart := htonl(LParts.LowPart);
  LParts.LowPart := L;
  Result := LParts.QuadPart;
end;

function ntoh64(AValue: Int64): Int64;
var
  LParts: TInt64Parts;
  L: LongWord;
begin
  LParts.QuadPart := AValue;
  L := ntohl(LParts.HighPart);
  LParts.HighPart := ntohl(LParts.LowPart);
  LParts.LowPart := L;
  Result := LParts.QuadPart;
end;

function TSocketData.SendInt64(Value: Int64): Boolean;
begin
  Value := hton64(Value);
  Result := SendRaw(@Value, SizeOf(Value));
end;

function TSocketData.ReadInt64(var Value: Int64): Boolean;
begin
  Result := ReadRaw(@Value, SizeOf(Value));
  if Result then Value := ntoh64(Value);
end;

function TSocketData.SendString(const Str: String): Boolean;
var
  S: UTF8String;
  Len: Integer;
begin
  S := UTF8String(Str);
  Len := Length(S);
  Result := SendInteger(Len);
  if Result and (Len > 0) then
    Result := SendRaw(PAnsiChar(S), Len);
end;

function TSocketData.ReadString(var Str: String): Boolean;
var
  S: UTF8String;
  Len: Integer;
begin
  Result := False;
  Str := '';
  if not ReadInteger(Len) then Exit;
  if (InBuffer.Size - InBuffer.Position) < Len then
  begin
    InBuffer.Seek(-SizeOf(Len), soCurrent);
    Exit;
  end;
  if Len > 0 then
  begin
    SetLength(S, Len);
    ReadRaw(PAnsiChar(S), Len);
    Str := String(S);
  end;
  Result := True;
end;

function TSocketData.SendStream(Stream: TStream): Boolean;
var
  Buf: array[0..1023] of Byte;
  Len: Int64;
  NumToSend: Integer;
begin
  Len := Stream.Size - Stream.Position;
  Result := SendInt64(Len);
  if Result and (Len > 0) then
  begin
    repeat
      if Len > SizeOf(Buf) then
        NumToSend := SizeOf(Buf)
      else
        NumToSend := Integer(Len);
      Stream.ReadBuffer(Buf[0], NumToSend);
      Dec(Len, NumToSend);
      Result := SendRaw(@Buf[0], NumToSend);
    until (Len = 0) or (not Result);
  end;
end;

function TSocketData.ReadStream(Stream: TStream): Boolean;
var
  Len: Int64;
begin
  Result := False;
  if not ReadInt64(Len) then Exit;
  if (InBuffer.Size - InBuffer.Position) < Len then
  begin
    InBuffer.Seek(-SizeOf(Len), soCurrent);
    Exit;
  end;
  if Len > 0 then
    Stream.CopyFrom(InBuffer, Len);
  Result := True;
end; 
```

客户端代码：

```
procedure TChatForm.ClientSocketConnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  Socket.Data := TSocketData.Create(Socket);
end;

procedure TChatForm.ClientSocketDisconnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  TSocketData(Socket.Data).Free;
  Socket.Data := nil;
end;

procedure TChatForm.ClientSocketWrite(Sender: TObject; Socket: TCustomWinSocket);
begin
  TSocketData(Socket.Data).FlushOutboundData;
end;

procedure TChatForm.ClientSocketRead(Sender: TObject; Socket: TCustomWinSocket);
var
  SocketData: TSocketData;
  i: Integer;
  RecvStr : String;
  arr : TStringArray;
begin
  SocketData := TSocketData(Socket.Data);
  if not SocketData.BufferInboundData then Exit;
  SocketData.BeginReading;
  try
    while SocketData.ReadString(RecvStr) do begin
      ShowMessage(RecvStr); // testing if anything is received
      // [[.. some string processing code ..]]
    end;
  finally
    SocketData.EndReading;
  end;
end;

procedure TChatForm.SendBtnClick(Sender: TObject);
var
  SocketData: TSocketData;
begin
  if ClientSocket1.Socket = nil then Exit;
  SocketData := TSocketData(ClientSocket1.Socket.Data);
  if SocketData = nil then Exit;
  str := MsgLabel.Text;
  if SocketData.SendString('message' + separator + nickname + separator + str) then
  begin
    MsgLabel.Text := '';
    add_text(MsgBox, MsgLabel, nickname + ': ' + str, 'none');
  end;
end; 
```

服务器代码：

```
procedure TServerForm.ServerSocketClientConnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  Socket.Data := TSocketData.Create(Socket);
end;

procedure TServerForm.ServerSocketClientDisconnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  TSocketData(Socket.Data).Free;
  Socket.Data := nil;
end;

procedure TServerForm.ServerSocketClientRead(Sender: TObject;Socket: TCustomWinSocket);
var
  SocketData: TSocketData;
  i: Integer;
  RecvStr : String;
  arr : TStringArray;
begin
  SocketData := TSocketData(Socket.Data);
  if not SocketData.BufferInboundData then Exit;
  SocketData.BeginReading;
  try
    while SocketData.ReadString(RecvStr) do
    begin
      arr := SplitStr(RecvStr, separator); 

      with ServerSocket.Socket do
      begin
        for i := 0 to ActiveConnections-1 do
        begin
          if Connections[i] <> Socket then
            TSocketData(Connections[i].Data).SendString(RecvStr);
        end;
      end;

      if arr[0] = 'connect' then
      begin
        Contacts.Items.Add(arr[1]);
        add_text(MsgBox, SendMsg, arr[1] + ' has connected !', 'green');
      end
      else if arr[0] = 'disconnect' then
      begin
        Contacts.Items.Delete(Contacts.Items.IndexOf(arr[1]));
        add_text(MsgBox, SendMsg, arr[1] + ' has disconnected !', 'red');
      end
      else if arr[0] = 'message' then
      begin
        add_text(MsgBox, SendMsg, arr[1] + ': ' + arr[2], 'none');
      end;
    end;
  finally
    SocketData.EndReading;
  end;
end;

procedure TServerForm.ServerSocketClientWrite(Sender: TObject; Socket: TCustomWinSocket);
begin
  TSocketData(Socket.Data).FlushOutboundData;
end;

procedure TServerForm.SendBtnClick(Sender: TObject);
var
  i : Integer;
  str : String;
begin
  str := SendMsg.Text;

  with ServerSocket.Socket do
  begin
    for i := 0 to ActiveConnections-1 do
      TSocketData(Connections[i].Data).SendString('global' + separator + str);
  end;

  add_text(MsgBox, SendMsg, str, 'none');
  SendMsg.Text := '';
end; 
```

# android - android何时真正呈现并显示活动？

> ID：14086014
> 
> 赞同：1
> 
> 时间：2012-12-29T21:19:23.510
> 
> 标签：android, android-layout

我试图了解 android OS 在哪个阶段呈现布局，以便能够访问我的 ListView 中的视图。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:31:08.333

布局创建于`onCreate()`：

> Activity 的整个生命周期发生在第一次调用 onCreate(Bundle) 到最后一次调用 onDestroy() 之间。

![在此处输入图像描述](../Images/37298b9d66489b5a025f61d116a94cc8.png)

活动从以下位置可见`onStart()`：

> 活动的可见生命周期发生在对 onStart() 的调用与对 onStop() 的相应调用之间。在此期间，用户可以在屏幕上看到活动

来源：[文档](http://developer.android.com/reference/android/app/Activity.html)。

# javascript - JavaScript中关联数组的键顺序和索引访问

> ID：14086017
> 
> 赞同：2
> 
> 时间：2012-12-29T21:19:32.293
> 
> 标签：javascript, html, arrays

我有一个关联数组，例如：

```
var arr = {};
arr['alz'] = '15a';
arr['aly'] = '16b';
arr['alx'] = '17a';
arr['alw'] = '09c'; 
```

我需要找到任何选定元素的上一个和下一个键。比如说，对于键“aly”，它将是“alz”和“alx”。如果可能的话，我想通过索引而不是键来访问数组。

目前，我正在使用包含键的单独数组来执行此操作，例如

```
var arrkeys = ['alz','aly','alx','alw']; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T21:22:35.153

对象属性的排序是*undefined*。你可以使用这个结构...

```
[{ key: 'alz', value: '15a'},
 { key: 'aly', value: '16b'},
 { key: 'alx', value: '17a'}] 
```

...尽管使用给定键搜索元素（例如“给我是的元素” `key`）`'alz'`并不像使用简单对象那样直接。这就是为什么像你一样使用它——为索引的排序提供一个单独的数组——是另一种常见的方法。您可以将此数组附加到该对象，顺便说一句：

```
var arr={};
arr['alz']='15a';
arr['aly']='16b';
arr['alx']='17a';
arr['alw']='09c';
arr._keysOrder = ['alz', 'aly', 'alx', 'alw']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T21:23:03.553

这是一个对象，而不是数组，听起来您并不真的希望这些字符串成为键。

一个漂亮的数组怎么样？

```
var ar = [
  { key: 'alz', value: '15a' },
  { key: 'aly', value: '16b' },
  { key: 'alx', value: '17a' },
  { key: 'alw', value: '09c' }
]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:48:28.257

以对象的形式添加一些语法糖怎么样`OrderedObject`？然后你可以做这样的事情：

```
myObj = new OrderedObject();

myObj.add('alz', '15a');
myObj.add('aly', '16b');
myObj.add('alx', '17a');
myObj.add('alw', '09c');

console.log(myObj.keyAt(2)); // 'alx'
console.log(myObj.valueAt(3)); // '09c'
console.log(myObj.indexOf('aly')); // 1
console.log(myObj.length()) // 4
console.log(myObj.nextKey('aly')); // 'alx' 
```

下面的代码使这项工作。[在 jsFiddle 中](http://jsfiddle.net/nXgG8/3/)查看它的实际效果。

```
function OrderedObject() {
   var index = [];
   this.add = function(key, value) {
      if (!this.hasOwnProperty(key)) {
         index.push(key);
      }
      this[key] = value;
   };
   this.remove = function(key) {
      if (!this.hasOwnProperty(key)) { return; }
      index.splice(index.indexOf(key), 1);
      delete this[key];
   }
   this.indexOf = function(key) {
      return index.indexOf(key);
   }
   this.keyAt = function(i) {
      return index[i];
   };
   this.length = function() {
      return index.length;
   }
   this.valueAt = function(i) {
      return this[this.keyAt(i)];
   }
   this.previousKey = function(key) {
      return this.keyAt(this.indexOf(key) - 1);
   }
   this.nextKey = function(key) {
      return this.keyAt(this.indexOf(key) + 1);
   }
} 
```

我做了一些可能不适合你的决定。例如，我选择使用 an`Object`作为原型而不是 an `Array`，这样您就可以保留使用 枚举您的对象`for (key in myObj)`。但它不一定是那样的。它可能是一个`Array`，让您使用属性`.length`而不是函数`.length()`，然后提供一个`each`枚举键的函数，或者可能是一个`.object()`返回内部对象的函数。

这可能有点尴尬，因为您必须记住不要自己向对象添加项目。也就是说，如果您这样做`myObj[key] = 'value';`，则`index`不会更新。我也没有提供任何重新排列事物顺序或将它们插入特定位置或按位置删除的方法。但是，如果您发现我的对象想法有用，我相信您可以弄清楚如何添加这些东西。

使用较新版本的 EcmaScript，您可以添加真正的属性并使它们不可枚举。这将允许新对象更无缝、更流畅地运行，就像我想象的理想 OrderedObject 一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T22:18:20.770

You may try this

```
function sortObject(obj, order)
{
    var list=[], mapArr = [], sortedObj={};
    for(var x in obj) if(obj.hasOwnProperty(x)) list.push(x);
    for (var i=0, length = list.length; i < length; i++) {
        mapArr.push({ index: i, value: list[i].toLowerCase() });
    }
    mapArr.sort(function(a, b) {
        if(order && order.toLowerCase()==='desc')
            return a.value < b.value ? 1 : -1;
        else return a.value > b.value ? 1 : -1;
    });
    for(var i=0; i<mapArr.length;i++)
        sortedObj[mapArr[i].value]=obj[mapArr[i].value];
    return sortedObj;
}
// Call the function to sort the arr object
var sortedArr = sortObject(arr); // Ascending order A-Z
var sortedArr = sortObject(arr, 'desc'); // Descending order Z-A 
```

[**DEMO**](http://jsfiddle.net/mujsj/1/).

Remember, this will return a new `object` and original `object` will remain unchanged.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T21:23:58.157

如果您必须知道所有内容的顺序，并且仍然使用键*和*值，请尝试以下操作：

```
var arr = [
    { key: 'alz', value: '15a' },
    { key: 'aly', value: '16b' },
    { key: 'alx', value: '17a' },
    { key: 'alw', value: '09c' }
]; 
```

然后，您可以按如下顺序访问它们：`arr[0].key`和`arr[0].value`. 同样，您可以使用以下内容在循环内找到兄弟姐妹：

```
for(var i = 0; i < arr.length; i++)
{
    var previous_key = (i > 0) ? arr[(i - 1)].key : false;
    var next_key = (i < (arr.length - 1)) ? arr[(i + 1)].key : false;
} 
```

# database - 数据库 Web 应用程序的数据驱动测试

> ID：14086022
> 
> 赞同：3
> 
> 时间：2012-12-29T21:19:53.167
> 
> 标签：database, selenium, jmeter, selenium-webdriver, data-driven-tests

我有一个数据库 Web 应用程序，我需要查看该应用程序的所有可能输入和所有可能输出（使用 Selenium 或 Jmeter）。

实际上，我试图了解“输入覆盖方法”在软件测试工具中的工作原理，但似乎太难了。如果我没记错的话，我正在尝试做的这种测试是一种数据驱动测试（意味着找出数据库 Web 应用程序的所有可能的输入和输出）。

如果有任何工具（我更喜欢开源）可以做到这一点，或者有任何方法可以创建这样的测试，您能否提出建议？
我必须自己创建吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T06:51:17.733

首先，您需要创建覆盖大部分输入数据集的等价类。之后，您可以使用创建的测试数据简单地运行您的 selenium/JMeter 测试。

您只需要创建单个测试脚本并将测试数据填充到 excel 或 CSV 工作表中即可执行数据驱动测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:41:16.997

看看[jBehave](https://github.com/jbehave/jbehave-tutorial)。

它是一个可以驱动 selenium 并支持输入测试数据集的 BBD 工具。

我已经使用它并且效果很好。你需要耐心才能通过胶水代码，但一旦你走出另一边，你会很高兴你坚持下来了。

# machine-learning - 在 RapidMiner 中优化决策树参数

> ID：14086025
> 
> 赞同：0
> 
> 时间：2012-12-29T21:20:26.253
> 
> 标签：machine-learning, data-mining, rapidminer

我正在处理一个相当大的数据集（770K 记录，2K 个属性，几乎所有这些属性都是二项式但都是整数形式），

我想通过 10 倍交叉验证对数据应用决策树，但我有一些问题：

1.为什么决策树（例如深度为10）需要这么多时间来训练？实际上我在训练树之前将数据（因为它不平衡）平衡到原始大小的 40%（~320K 记录），但这仍然需要很多时间，是否有任何其他版本的决策树可以产生相同的性能和需要更少的时间？（以二项式形式制作属性是否会使其更快？）

2.如何优化决策树的参数？我应该在整个 X-validation 上优化它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T15:28:05.343

您是否有理由将二进制属性标记为整数？对于二项式属性，归纳确实更快，否则树归纳算法需要为每个节点的每个属性找到最佳拆分。

诱导这样一棵树需要多长时间？您使用的是哪种算法？

关于参数优化：需要在每个 X 验证循环内的单独集合上完成。请参阅此工作流程作为如何执行此操作的示例：[http ://www.myexperiment.org/workflows/3263.html](http://www.myexperiment.org/workflows/3263.html)

# windows-phone-8 - WP8 语音命令仅适用于模拟器

> ID：14086026
> 
> 赞同：1
> 
> 时间：2012-12-29T21:20:43.387
> 
> 标签：windows-phone-8, voice

我编写了一个接受语音命令的 WP8 应用程序。我已经在模拟器上进行了部署和测试，一切正常。但是，在我的 HTC 8X 上部署和测试时，语音命令没有被检测到，它们甚至没有出现在“我能说什么”选项中。

有人遇到过这个吗？感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:22:25.010

我的猜测是 VCD CommandSet`xml:lang`属性与您手机上使用的语言和地区组合不匹配。`xml:lang`VCD 文件中的命令集是什么？而你的手机使用的语言和地区是什么？默认的 VoiceCommandDefinition1.xml 文件默认是`xml:lang="en-US"`，那么你的手机是不是设置为美国地区的英语语言呢？

从开发的角度来看，您必须为`xml:lang`您的应用程序支持的每个指定一个 CommandSet。

另外，请记住，语音识别仅适用于 15-20 种文化（语言+地区组合）。可能是您的手机是不受支持的语言环境之一，您根本无法支持该文化的语音识别。

# php - .htaccess · 使用 rewritecond 来处理包含？

> ID：14086030
> 
> 赞同：0
> 
> 时间：2012-12-29T21:21:05.883
> 
> 标签：php, .htaccess, templates, mod-rewrite

我想要做的是有多个目录（不是物理创建的），授予他们访问 file_template.php

例如，如果您访问*/soccer/*或*/tennis/*或*/basket/* ..... 内部重定向或包含 template_sport.php

我已经实现了这一点。Htaccess 不工作

```
RewriteCond% {REQUEST_URI} /soccer/(. *)
RewriteCond% {REQUEST_URI} /basket/(. *)
RewriteCond% {REQUEST_URI} /tennis/(. *)
RewriteRule (.*) /template_sport.php?sport=$1 
```

任何的想法？提前致谢并致以最诚挚的问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:23:45.917

你不需要`RewriteCond`s ：

```
RewriteRule ^(soccer|basket|tennis)(/.*)?$ /template_sport.php?sport=$1 
```

请注意，正如所写，这`RewriteRule`会丢弃 URL 中初始. 但是，正则表达式确实将其捕获在 中，因此您可以根据需要将其包含在重写的 URL 中。`/*sport*/``$2`

# iphone - NSArrays 和 NSDictionaries

> ID：14086032
> 
> 赞同：0
> 
> 时间：2012-12-29T21:21:25.847
> 
> 标签：iphone, objective-c, arrays, nsmutablearray, nsdictionary

我遇到了`NSdictionary`和的问题`NSArray`。我想要完成的是`UILabel`在一个循环中使用不同的数据重复自己。数据来自一个 xml 文件。我正在正确解析数据，我让它显示使用：

```
lblAffected = [[[outageDict objectForKey:@"Outage" ]objectForKey:@"outagenum" ]objectForKey:@"text" ]; 
```

当我有多个与一次中断相关联的中断号时，我的问题就出现了。以下是我目前拥有的。

```
if (mapCoordinateIsInPolygon) {
    int outageIndex = [poly.title intValue];
    NSDictionary *outageDict = [sections objectAtIndex:outageIndex];
    //NSLog(@"hit, outageDict = %@", outageDict);

    for (NSDictionary *data in outageDict){
        NSArray *outageData = [outageDict objectForKey:@"Outage" ];
        NSMutableArray *outageInfo = [[NSMutableArray alloc]init];
        for(NSDictionary *outa in outageData){
            [outageInfo addObject:[[outa objectForKey:@"outagenum"] objectForKey:@"text"]];
            NSLog(@"ouatage %@", outageInfo);
        }
        int add = 0;
        NSLog(@"ouatage %i", [outageInfo count]);
        for (int i=0; i < [outageInfo count]; i++){
        add = add+20;
        lblAffected.frame = CGRectMake(130,add,320, 60);
        NSLog(@"added : %i",add);
        lblAffected.backgroundColor = [UIColor clearColor];
        lblAffected.textColor = [UIColor redColor];
        lblAffected.font = [UIFont fontWithName:@"Helvetica" size: 13.0];
        lblAffected.lineBreakMode = UILineBreakModeWordWrap;
        lblAffected.numberOfLines = 1;

        lblAffected.text = outageInfo[i];
        NSLog(@"outage Ifo %@",outageInfo[i]);
        [headerView addSubview:lblAffected];
    }
} 
```

需要发生的是，一旦我从 outageDict 获取数据，它就需要存储在标签内并显示在 subView 上。如果有多个中断编号，则标签需要复制自身，以显示彼此下方 20 像素的所有中断编号。我最终会将它放在一个滚动视图中，但要知道我只是想解决这个问题。

现在我的问题是我在字典和数组上做错了什么？当我触摸地图上的多边形视图时出现多次中断，它会显示在日志文件中，但是当我点击一个只有一次中断时，它会崩溃。我会以错误的方式解决这个问题吗？错误消息发生在

```
[outageInfo addObject:[[outa objectForKey:@"outagenum"] objectForKey:@"text"]]; 
```

并指出

```
-[__NSCFString objectForKey:]: unrecognized selector sent to instance 0x6d2b160 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:25:18.660

您收到的错误消息是不言自明的。

```
-[__NSCFString objectForKey:]: unrecognized selector sent to instance 0x6d2b160 
```

您有一个字符串对象 ( `__NSCFString`)，并且通过调用它来将其视为字典`objectForKey:`。由于字符串不理解此方法（或选择器），因此您会遇到异常`"unrecognized selector sent to instance"`。

您收到此异常的行包含对 的两个不同的调用`objectForKey:`，异常可能来自其中任何一个。

```
[outageInfo addObject:[[outa objectForKey:@"outagenum"] objectForKey:@"text"]]; 
```

您在`objectForKey:`这里调用的两个对象是：

1.  `outa`
2.  `[outa objectForKey:@"outagenum"]`

要确定它是第一个还是第二个，请在您看到异常或崩溃的行上设置一个断点。然后，一旦调试器在该行停止执行，检查这两个对象的数据类型。在 lldb 或 gdb 光标处，键入这些命令以检查有问题的对象。`po`代表打印对象，它打印有问题的对象的描述。

```
(lldb) po outa
(lldb) po [outa objectForKey:@"outagenum"] 
```

这应该告诉您这两个中的哪一个是字符串对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:44:18.547

您在 outa 为 key outagenum 设置什么样的对象（假设它是字典） [outageInfo addObject:[[outa objectForKey:@"outagenum"] objectForKey:@"text"]];

那是字符串还是字典？

# php - 回显表单数据？

> ID：14086033
> 
> 赞同：0
> 
> 时间：2012-12-29T21:21:30.190
> 
> 标签：php, mysql

我正在尝试制作一个注册表单，基本上我有 4 页，第一页要求输入名字、姓氏和电子邮件，第二页要求输入出生日期和密码，第 3 页将询问一些统计信息/复选框项目和第 4 页将提交表格。

目前，我正在尝试将数据从一页上的一个表单回显到第 2、3 页，然后最后在第 4 页一起提交到 mysql 数据库中。

我收到更新数据库消息的错误。

有人可以告诉我我做得对还是有更简单的方法？

谢谢;

```
<form class="" method="post" action="register_p2.php">
<div class="row first_name">
<input type="text" id="first_name" name="first_name" placeholder="First Name" />
</div>

<div class="row last_name">
<input type="text" id="last_name" name="last_name" placeholder="Last Name" />
</div>

<div class="row email">
<input type="email" id="email" name="email" placeholder="Email"  />
</div>

<input type="submit" value="Next >"  />

</form> 
```

第 2 部分 / 第 2 页

```
<? ob_start(); ?>
<?php
// GET ACCOUNT INFORMATION FROM FORM AND ASSIGN VARIABLES
$first_name = $_POST['first_name'];
$last_name = $_POST['last_name'];
$email = $_POST['email'];
?>
<?php
/*
// ECHO ACCOUNT INFORMATION
echo "<strong> Account Information: </strong>";
echo "<br />";
echo First Name: ";
echo "<br />";
echo $first_name;
echo "<br />";
echo "<br />";
echo "Last Name: ";
echo "<br />";
echo $last_name;
echo "<br />";
echo "<br />";
echo "Email: ";
echo "<br />";
echo $email;
echo "<br />";
echo "<br />";
*/
?>

<?php
////// SEND TO DATABASE

/////////////////////////////////////////////////////////

// Database Constants
define("DB_SERVER", "#######");
define("DB_USER", "######");
define("DB_PASS", "");
define("DB_NAME", "######");

// 1\. Create a database connection
$connection = mysql_connect(DB_SERVER,DB_USER,DB_PASS);
if (!$connection) {
    die("Database connection failed: " . mysql_error());
}

// 2\. Select a database to use
$db_select = mysql_select_db(DB_NAME,$connection);
if (!$db_select) {
    die("Database selection failed: " . mysql_error());
}
//////////////////////////////////////////////////////////////
$query="INSERT INTO registrations (Id,
first_name,
last_name,
email

 )
VALUES('NULL',
'".$first_name."',
'".$last_name."',
'".$email."'
)";
mysql_query($query) or die ('Error updating database');
?>
<?php
function confirm_query($result_set) {
                if (!$result_set) {
                    die("Database query failed: " . mysql_error());
                }
        }
function get_user_id() {
    global $connection;
    global $email;
    $query = "SELECT *
                FROM registrations
                WHERE email = \"$email\"
                ";
        $user_id_set = mysql_query($query, $connection);
        confirm_query($user_id_set);
        return $user_id_set;
        }
?>
<?php
$user_id_set = get_user_id();
while ($user_id = mysql_fetch_array($user_id_set)) {
    $cookie1 = "{$user_id["id"]}";
    setcookie("registrations", $cookie1, time()+3600);  /* expire in 1 hour */

}
?>

    <? ob_flush(); ?>

    <!DOCTYPE html>
    <html>
        <head>
            <meta charset="utf-8" />
            <title>Register</title>

            <!-- The stylesheet -->
            <link rel="stylesheet" href="assets/css/styles.css" />

            <!--[if lt IE 9]>
              <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
        </head>

        <body>
            <div id="main">

            <h2>Step 2: Security Details</h2>
            <br/>

                <form class="" method="post" action="register_p3.php">

                    <div class="row date_of_birth">
                        <input type="text" id="date_of_birth" name="date_of_birth" placeholder="D.O.B 10/02/1990" />
                    </div>

                    <div class="row password">
                        <input type="password" id="password" name="password" placeholder="Password" />
                    </div>

                    <div class="row password2">
                        <input type="password" id="password2" name="password2" placeholder="Password (Confirm)"  />
                    </div>

                    <input type="submit" value="Next >"  />

                </form>
            </div>
            <!-- JavaScript includes - jQuery, the complexify plugin and our own script.js -->
            <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
            <script src="assets/js/jquery.complexify.js"></script>
            <script src="assets/js/script.js"></script>     
        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:35:26.180

尝试使用会话，

```
 <? ob_start(); 
         session_start();?>
<?php
// GET ACCOUNT INFORMATION FROM FORM AND ASSIGN VARIABLES
$first_name = $_SESSION['first_name'];
$last_name = $_SESSION['last_name'];
$email = $_SESSION['email'];
?>
<?php
/*
// ECHO ACCOUNT INFORMATION
echo "<strong> Account Information: </strong>";
echo "<br />";
echo First Name: ";
echo "<br />";
echo $first_name;
echo "<br />";
echo "<br />";
echo "Last Name: ";
echo "<br />";
echo $last_name;
echo "<br />";
echo "<br />";
echo "Email: ";
echo "<br />";
echo $email;
echo "<br />";
echo "<br />";
*/
?>

<?php
////// SEND TO DATABASE

/////////////////////////////////////////////////////////

// Database Constants
define("DB_SERVER", "#######");
define("DB_USER", "######");
define("DB_PASS", "");
define("DB_NAME", "######");

// 1\. Create a database connection
$connection = mysql_connect(DB_SERVER,DB_USER,DB_PASS);
if (!$connection) {
    die("Database connection failed: " . mysql_error());
}

// 2\. Select a database to use
$db_select = mysql_select_db(DB_NAME,$connection);
if (!$db_select) {
    die("Database selection failed: " . mysql_error());
}
//////////////////////////////////////////////////////////////
$query="INSERT INTO registrations (Id,
first_name,
last_name,
email

 )
VALUES('NULL',
'".$first_name."',
'".$last_name."',
'".$email."'
)";
mysql_query($query) or die ('Error updating database');
?>
<?php
function confirm_query($result_set) {
                if (!$result_set) {
                    die("Database query failed: " . mysql_error());
                }
        }
function get_user_id() {
    global $connection;
    global $email;
    $query = "SELECT *
                FROM registrations
                WHERE email = \"$email\"
                ";
        $user_id_set = mysql_query($query, $connection);
        confirm_query($user_id_set);
        return $user_id_set;
        }
?>
<?php
$user_id_set = get_user_id();
while ($user_id = mysql_fetch_array($user_id_set)) {
    $cookie1 = "{$user_id["id"]}";
    setcookie("registrations", $cookie1, time()+3600);  /* expire in 1 hour */

}
?>

    <? ob_flush(); ?>

    <!DOCTYPE html>
    <html>
        <head>
            <meta charset="utf-8" />
            <title>Register</title>

            <!-- The stylesheet -->
            <link rel="stylesheet" href="assets/css/styles.css" />

            <!--[if lt IE 9]>
              <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
        </head>

        <body>
            <div id="main">

            <h2>Step 2: Security Details</h2>
            <br/>

                <form class="" method="post" action="register_p3.php">

                    <div class="row date_of_birth">
                        <input type="text" id="date_of_birth" name="date_of_birth" placeholder="D.O.B 10/02/1990" />
                    </div>

                    <div class="row password">
                        <input type="password" id="password" name="password" placeholder="Password" />
                    </div>

                    <div class="row password2">
                        <input type="password" id="password2" name="password2" placeholder="Password (Confirm)"  />
                    </div>

                    <input type="submit" value="Next >"  />

                </form>
            </div>
            <!-- JavaScript includes - jQuery, the complexify plugin and our own script.js -->
            <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
            <script src="assets/js/jquery.complexify.js"></script>
            <script src="assets/js/script.js"></script>     
        </body>
    </html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:25:16.703

如果您希望信息在多个页面上可用，则应将其存储在会话中。当您将 $_POST 值存储到变量中时，只需执行类似的操作，并确保放入 session_start(); 在页面顶部调用。

```
<?php
session_start();
// other php code here

$_SESSION['first_name'] = $first_name;
$_SESSION['last_name'] = $last_name;
$_SESSION['email'] = $email;
?> 
```

然后，您可以通过调用 $_SESSION['first_name'] 或您要访问的任何变量在任何页面上访问它们。只要确保包括 session_start(); 在需要使用这些变量的每个页面的顶部。

# android - Android：将按钮单击响应从适配器类的 getView() 方法传递给 mainActivity

> ID：14086039
> 
> 赞同：0
> 
> 时间：2012-12-29T21:22:29.423
> 
> 标签：android, android-arrayadapter, android-button, onclicklistener

问题很简单。我编写了一个扩展 ArrayAdapter 的单独类。这个适配器处理几个 TEXTVIEW 和一个 BUTTON。问题是我不确定我是否将用 getView() 方法编写的 Button 的 onClickListener 响应响应到 main_activity。main_activity 有很多基于按钮响应的逻辑要遵循。您能否让我知道如何获得对 main_activity 的按钮响应？

以下是getView方法

```
public View getView(final int position, View convertView, ViewGroup parent) {      
    ViewHolder holder;   
    int type = getItemViewType(position); 

    if (convertView == null) { 
        holder = new ViewHolder();  
        switch (type) {
        case 0:
            convertView = vi.inflate(R.layout.group,  null); 
            holder.menuItem = (TextView) convertView.findViewById(R.id.tvGroup);
            convertView.setBackgroundColor(Color.RED); 
            break;              
        case 1:
            convertView = vi.inflate(R.layout.confirmitem,  null); 
            holder.menuItem = (TextView) convertView.findViewById(R.id.tvConfirmItem); 
            holder.quantity = (TextView) convertView.findViewById(R.id.tvQuantity); 
            holder.cancel   = (Button)   convertView.findViewById(R.id.bCancel); 

            //   cancel button
               holder.cancel.setOnClickListener(new View.OnClickListener() {        
                    public void onClick(View v) {                   
                        Log.i("ConfirmAdapter ","Button postion  "+ position + "canceled item : " + menuItemList.get(position).getTicketItemObject().getName() ); 
                        }       
                });   
            break; 
         }  
        convertView.setTag(holder); 
    } else {
        holder = (ViewHolder) convertView.getTag();  
    }    

    switch (type) {
    case 0:         
        holder.menuItem.setText(menuItemList.get(position).getTicketItemObject().getCategoryName()) ; 
        convertView.setBackgroundColor(Color.RED);  
        break;              
    case 1:
        holder.menuItem.setText(menuItemList.get(position).getTicketItemObject().getName());
        holder.quantity.setText(Integer.toString(menuItemList.get(position).getTicketItemObject().getItemCount())); 
        break; 
     }

    return convertView; 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:31:47.783

在你的数组适配器的构造函数中引用活动怎么样？就像是

```
public YourArrayAdapter(YourActivity a){
     mActivity = a;
} 
```

并从 onClickMethod 中引用 mActivity？

在您的 YourActivity 中，您可以`onItemButtonClicked()`从那里调用一个方法。

# mysql - MySQL连接两个表以查找除具有最大值的行之外的所有行

> ID：14086041
> 
> 赞同：1
> 
> 时间：2012-12-29T21:22:42.797
> 
> 标签：mysql, sql, join, max

我正在尝试编写一个查询，该查询将查找组中的所有行，但具有最大值的行除外。到目前为止，我有一个查询可以找到具有最大值的行，但现在我需要找到所有其余的行。这是一个包含两个数据库和示例数据的 SQLFiddle。我也有查找最大行数的查询。 [http://sqlfiddle.com/#!2/514d2/33](http://sqlfiddle.com/#!2/514d2/33)

对于那些不想使用 SQLFiddle 的人... 表名：列表 表名：出价

```
SELECT listings.end_date, listings.user_id, listings.title, 
  listings.auc_fp, listings.id, listings.auc_image1
FROM listings 
JOIN bids b1 
ON b1.listing_id=listings.id 
LEFT JOIN bids b2 
ON b2.listing_id=listings.id AND b1.bid < b2.bid
WHERE b1.user_id = 1
AND b2.bid IS NULL
AND listings.end_date > NOW()
ORDER BY listings.list_ts DESC 
```

以上是查找最大行数的查询。我正在尝试将listings 表与listings.id=bids.listing_id 上的bids 表连接起来。然后我需要找到用户（$user 或用户“1”）对该列表出价的所有行。然后我需要排除用户具有最高出价的列表（这就是上面的查询所做的）。

我最初认为我可以使用上面的查询作为子查询来排除用户是最高出价者的列表。但我不确定这是否是最好的方法，而且我对子查询不太擅长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:46:02.223

请注意，答案已根据以下评论进行了多次修改。

```
SELECT
    lst.end_date,
    lst.title,
    lst.auc_fp,
    lst.id as listing_id,
    lst.auc_image1,
    b.user_id as bid_user_id,
    b.bid as bid_amount,
    maxbids.maxbid as maxbid_for_listing
FROM listings lst
INNER JOIN
(
    SELECT listing_id, MAX(bid) maxbid
    FROM bids b
    GROUP BY listing_id
) maxbids ON lst.id = maxbids.listing_id
INNER JOIN bids maxusers ON maxusers.bid = maxbids.maxbid AND maxusers.listing_id = maxbids.listing_id
INNER JOIN bids b ON
    maxbids.listing_id = b.listing_Id AND
    b.bid < maxbids.maxbid AND
    b.user_id <> maxusers.user_id
WHERE lst.end_date > NOW()
ORDER BY lst.list_ts DESC 
```

# c++ - 为什么 shared_ptr 而不是 shared_ptr

> ID：14086045
> 
> 赞同：4
> 
> 时间：2012-12-29T21:23:24.233
> 
> 标签：c++, boost

基于[http://en.highscore.de/cpp/boost/smartpointers.html#smartpointers_shared_pointer](http://en.highscore.de/cpp/boost/smartpointers.html#smartpointers_shared_pointer)

```
#include <boost/shared_ptr.hpp> 
#include <windows.h> 

int main() 
{ 
  boost::shared_ptr<void> h(OpenProcess(PROCESS_SET_INFORMATION, FALSE, 
                  GetCurrentProcessId()), CloseHandle); 
  SetPriorityClass(h.get(), HIGH_PRIORITY_CLASS); 
} 
```

**问题**：

为什么`h`定义为`boost::shared_ptr<void>`而不是`boost::shared_ptr<HANDLE>`？

供参考：

```
WINBASEAPI
HANDLE
WINAPI
OpenProcess(
    __in DWORD dwDesiredAccess,
    __in BOOL bInheritHandle,
    __in DWORD dwProcessId
    );

typedef void * HANDLE; 
```

[http://www.boost.org/doc/libs/1_47_0/libs/smart_ptr/sp_techniques.html#pvoid](http://www.boost.org/doc/libs/1_47_0/libs/smart_ptr/sp_techniques.html#pvoid)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T21:25:49.450

因为 a`boost::shared_ptr<HANDLE>`将是 a `boost::shared_ptr<PVOID>`，这是 a `boost::shared_ptr<void*>`- 显然不同于`boost::shared_ptr<void>`。注意额外的指针。

如果你有一个`boost::shared_ptr<HANDLE>`，它本质上是一个指向 的指针的智能指针`void`，而不是指向 void 的智能指针。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T21:25:59.507

因为`HANDLE`已经是一个指针。A`shared_ptr<HANDLE>`将是指向 a 的*共享指针`HANDLE`*，而不是*shared`HANDLE`*。

# ruby-on-rails - 充当存档不会创建存档选项卡

> ID：14086050
> 
> 赞同：0
> 
> 时间：2012-12-29T21:23:48.260
> 
> 标签：ruby-on-rails, ruby, activerecord

我目前正在尝试在我的 rails 应用程序中使用[acts_as_archive](https://github.com/winton/acts_as_archive) gem。

关于软删除的所有咆哮，我认为将已删除的数据存储在一个额外的表中可能是一个更优雅的解决方案......

我的问题是，我已经按照简约文档配置了所有内容，但存档表没有按预期创建。

我的模型：

```
class Article < ActiveRecord::Base
  attr_accessible :content, :lead, :title
  acts_as_archive
  has_and_belongs_to_many :categories
end

class Category < ActiveRecord::Base
  attr_accessible :title
  acts_as_archive
  has_and_belongs_to_many :articles
end 
```

config/acts_as_archive.yml：

```
Article:
    - class: Article::Archive
    table: archived_articles

 Category:
    - class: Category::Archive
    table: archived_categories 
```

之后我运行 rake db:migrate 并删除了 rails 控制台中的一篇文章。然后我尝试访问

```
Article::Archive.first 
```

但出现以下错误：

```
ActiveRecord::StatementInvalid: Could not find table 'archived_articles' 
```

似乎包含了 gem，但不知何故没有创建表。我错过了什么吗？毕竟，我开始怀疑使用这个 gem 是否是一个好主意，因为文档非常少，而且它似乎不再活跃了....

使用像acts_as_paranoid这样的可软删除的dem有什么好的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:29:03.003

由于该表似乎不存在，看来该 gem 没有被 Rails 安装或加载。

尝试重新运行`bundle install`以确保 Rails 拾取新的 gem，然后重新迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:16:27.757

由于acts_as_archive 有点过时，我切换到paper_trail，它不是100% 相同，但也支持通过版本控制系统关闭软删除行为。

# python - Python：如何按每个元素的最大值对列表进行排序？

> ID：14086051
> 
> 赞同：3
> 
> 时间：2012-12-29T21:23:55.683
> 
> 标签：python, list

```
L=[[a,b],[c,d],[e,f],...] 
```

我想按 max(a,b)、max(c,d)、max(e,f) 等对其进行排序。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-29T21:25:27.087

您可以提供自定义`key`函子`sort`：

```
L.sort(key=max) 
```

# java - Card Layout 获取当前卡片字符串

> ID：14086055
> 
> 赞同：4
> 
> 时间：2012-12-29T21:24:09.973
> 
> 标签：java, swing, indexing, layout-manager, cardlayout

我在应用程序中使用卡片布局并想要获取当前活动卡片的名称我尝试了很多方法但没有意思，例如这种方法似乎不再存在

```
panel.getLayout().getActiveItem() 
```

我也试过这个，但它也不起作用

```
 Panel card = null;
      for (Component comp : cardPanel.getComponents()) {
           if (comp.isVisible()) {
                System.out.println(card.getName());

                    }
                 } 
```

例如：以下 stamts 为卡片布局添加了几个面板，我想返回当前活动卡片的 1、2、3、4 或 5：

```
 cardPanel.add(firstP, "1");
    cardPanel.add(secondP, "2");
    cardPanel.add(thirdP, "3");
    cardPanel.add(fourthP, "4");
    cardPanel.add(fifthP, "5"); 
```

有什么可能的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:50:10.667

`CardLayout`不会暴露自己的组件与其键之间的映射（此处`1`为 , `2`, `3`, `4`...），因此使用布局本身不会显示“卡片”是如何散列的。

如果您希望使用[getName](http://docs.oracle.com/javase/7/docs/api/java/awt/Component.html#getName%28%29)方法，请记住您必须先自行设置，因为默认情况下未设置该字段：

```
firstPanel.setName("1");
cardPanel.add(firstPanel, firstPanel.getName()); 
```

然后，使用您的`for`循环，您将能够获得当前卡`String`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:00:35.357

有两种方法

*   [从当前卡片中确定可见的 JComponent](https://stackoverflow.com/questions/4413251/how-to-get-the-top-card-in-javas-cardlayout)

*   `putClientProperty`( `setName`, etc) 添加监听`AncestorListener`或`HierarchyListener`

代码

（免责声明，请注意，这只是带有 的代码示例`Thread.sleep(int)`，并且只能在这种形式下工作，特意锁定`Event Dispatch Thread`）

```
import java.awt.BorderLayout;
import java.awt.CardLayout;
import java.awt.event.HierarchyEvent;
import java.awt.event.HierarchyListener;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.event.AncestorEvent;
import javax.swing.event.AncestorListener;

public class CardlayoutTest extends JFrame {

    private static final long serialVersionUID = 1L;
    private JPanel pnlA, pnlB, pnlC;
    public CardLayout card = new CardLayout();

    public CardlayoutTest() {
        EventHandler eventHandle = new EventHandler();
        pnlA = new JPanel(new BorderLayout());
        pnlA.add(new JButton("A"), BorderLayout.CENTER);
        pnlA.putClientProperty("JPanel", "JPanel_a");
        pnlB = new JPanel(new BorderLayout());
        pnlB.add(new JButton("B"), BorderLayout.CENTER);
        pnlB.putClientProperty("JPanel", "JPanel_b");
        pnlC = new JPanel(new BorderLayout());
        pnlC.add(new JButton("C"), BorderLayout.CENTER);
        pnlC.putClientProperty("JPanel", "JPanel_c");
        pnlA.addAncestorListener(eventHandle);
        pnlA.addHierarchyListener(eventHandle);
        pnlB.addAncestorListener(eventHandle);
        pnlB.addHierarchyListener(eventHandle);
        pnlC.addAncestorListener(eventHandle);
        pnlC.addHierarchyListener(eventHandle);
        setLayout(card);
        add(pnlA, "A");
        add(pnlB, "B");//
        add(pnlC, "C");
        setDefaultCloseOperation(EXIT_ON_CLOSE);
    }

    class EventHandler implements AncestorListener, HierarchyListener {

        @Override
        public void ancestorAdded(AncestorEvent event) {
            JComponent comp2 = event.getComponent();
            String str = (String) comp2.getClientProperty("JPanel");
            System.out.println("ancestorAdded " + str);
        }

        @Override
        public void ancestorMoved(AncestorEvent event) {
            JComponent comp2 = event.getComponent();
            String str = (String) comp2.getClientProperty("JPanel");
            System.out.println("ancestorMoved " + str);
        }

        @Override
        public void ancestorRemoved(AncestorEvent event) {
            JComponent comp2 = event.getComponent();
            String str = (String) comp2.getClientProperty("JPanel");
            System.out.println("ancestorRemoved " + str);
        }

        @Override
        public void hierarchyChanged(HierarchyEvent e) {
            JComponent comp2 = (JComponent) e.getComponent();
            String str = (String) comp2.getClientProperty("JPanel");
            System.out.println("hierarchyChanged " + str);
        }
    }

    public static void main(String[] args) {
        CardlayoutTest t = new CardlayoutTest();
        t.setSize(300, 200);
        System.out.println("CardlayoutTest.main()------------------------ FIRST");
        t.card.show(t.getContentPane(), "A");
        t.setVisible(true);
        System.out.print("\n");
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
        }
        System.out.println("CardlayoutTest.main()------------------------ SECOND");
        t.card.show(t.getContentPane(), "B");
        System.out.print("\n");
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
        }
        System.out.println("CardlayoutTest.main()------------------------ THIRD");
        t.card.show(t.getContentPane(), "C");
        System.out.print("\n");
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
        }
        System.out.println("CardlayoutTest.main()------------------------ SECOND");
        t.card.show(t.getContentPane(), "B");
        System.out.print("\n");
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
        }
        System.out.println("CardlayoutTest.main()------------------------ FIRST");
        t.card.show(t.getContentPane(), "A");
        System.out.print("\n");
    }
} 
```

# python - Twitter 计数参数

> ID：14086058
> 
> 赞同：0
> 
> 时间：2012-12-29T21:24:15.847
> 
> 标签：python, twitter

我正在尝试编写一些代码来向 twitter 发送搜索请求。

但是，返回似乎被忽略了我放入 URL 的参数（实际搜索查询除外）。

我使用的网址是：

```
http://search.twitter.com/search.json?q=obama&src=typd&count=4&tresult_type=popular 
```

不过，无论我输入什么，计数都只会返回 20，而且我相当确定流行但也不会返回。

谁能看到我哪里出错了？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:37:10.790

Twitter Search API 中没有 count 参数。查看他们的文档：[Twitter API：搜索](https://dev.twitter.com/docs/api/1/get/search)

您可以使用 rpp（每页结果）在 1.0 API 中实现您想要的：

> [http://search.twitter.com/search.json?q=obama&rpp=4&tresult_type=popular](http://search.twitter.com/search.json?q=obama&rpp=4&tresult_type=popular)

或者使用新的 1.1 API：

> [https://api.twitter.com/1.1/search/tweets.json?q=obama&count=4&tresult_type=popular](https://api.twitter.com/1.1/search/tweets.json?q=obama&count=4&tresult_type=popular)

# webserver - 从根目录提供主页和静态内容

> ID：14086063
> 
> 赞同：40
> 
> 时间：2012-12-29T21:24:32.537
> 
> 标签：webserver, go

在 Golang 中，我如何在根目录之外提供静态内容，同时仍然有一个根目录处理程序来服务主页。

使用以下简单的 Web 服务器作为示例：

```
package main

import (
    "fmt"
    "net/http"
)

func main() {
    http.HandleFunc("/", HomeHandler) // homepage
    http.ListenAndServe(":8080", nil)
}

func HomeHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "HomeHandler")
} 
```

如果我做

```
http.Handle("/", http.FileServer(http.Dir("./"))) 
```

我收到一个恐慌，说我有两个“/”注册。我在 Internet 上找到的每个 Golang 示例都建议从不同的目录中提供静态内容，但这对于 sitemap.xml、favicon.ico、robots.txt 和其他实践文件或强制要求始终从根中提供服务。

我寻求的行为是在大多数 Web 服务器（如 Apache、Nginx 或 IIS）中发现的行为，它首先遍历您的规则，如果没有找到规则，它会查找实际文件，如果没有找到文件404s。我的猜测是`http.HandlerFunc`，我不需要编写 a ，而是需要编写 a `http.Handler`which 检查我是否引用了带有扩展名的文件，如果是，则检查文件是否存在并提供文件，否则 404s 或提供主页是请求的“/”。不幸的是，我什至不确定如何开始这样的任务。

我的一部分说我把情况过度复杂化了，这让我觉得我错过了什么？任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-06T23:29:27.023

另一种（不使用[ServeMux](http://golang.org/pkg/net/http/#ServeMux)）解决方案是显式地提供位于根目录中的每个文件。背后的想法是保持基于根文件的数量非常小。 [sitemap.xml](http://en.wikipedia.org/wiki/Sitemap.xml)，[favicon.ico](http://en.wikipedia.org/wiki/Favicon.ico)，[robots.txt](http://en.wikipedia.org/wiki/Robots.txt)确实被要求从根目录中提供服务：

```
package main

import (
    "fmt"
    "net/http"
)

func HomeHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "HomeHandler")
}

func serveSingle(pattern string, filename string) {
    http.HandleFunc(pattern, func(w http.ResponseWriter, r *http.Request) {
        http.ServeFile(w, r, filename)
    })
}

func main() {
    http.HandleFunc("/", HomeHandler) // homepage

    // Mandatory root-based resources
    serveSingle("/sitemap.xml", "./sitemap.xml")
    serveSingle("/favicon.ico", "./favicon.ico")
    serveSingle("/robots.txt", "./robots.txt")

    // Normal resources
    http.Handle("/static", http.FileServer(http.Dir("./static/")))

    http.ListenAndServe(":8080", nil)
} 
```

请将所有其他资源（CSS、JS 等）移动到适当的子目录，例如`/static/`.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-29T22:41:57.473

我认为可能对您有所帮助的一件事是您可以创建自己的 ServeMux。我添加到您的示例中，以便 chttp 是您可以提供静态文件的 ServeMux。HomeHandler 然后检查它是否应该提供文件。我只是检查一个“。” 但你可以做很多事情。只是一个想法，可能不是您想要的。

```
package main

import (
    "fmt"
    "net/http"
    "strings"
)   

var chttp = http.NewServeMux()

func main() {

    chttp.Handle("/", http.FileServer(http.Dir("./")))

    http.HandleFunc("/", HomeHandler) // homepage
    http.ListenAndServe(":8080", nil)
}   

func HomeHandler(w http.ResponseWriter, r *http.Request) {

    if (strings.Contains(r.URL.Path, ".")) {
        chttp.ServeHTTP(w, r)
    } else {
        fmt.Fprintf(w, "HomeHandler")
    }   
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-10-16T23:06:59.263

使用[Gorilla mux 包](http://www.gorillatoolkit.org/pkg/mux)：

```
r := mux.NewRouter()

//put your regular handlers here

//then comes root handler
r.HandleFunc("/", homePageHandler)
//if a path not found until now, e.g. "/image/tiny.png" 
//this will look at "./public/image/tiny.png" at filesystem
r.PathPrefix("/").Handler(http.FileServer(http.Dir("./public/")))

http.Handle("/", r)
http.ListenAndServe(":8080", nil) 
```

# python - 在 pycharm/pydev 中调试 pytest 事后异常

> ID：14086067
> 
> 赞同：10
> 
> 时间：2012-12-29T21:24:50.113
> 
> 标签：python, unit-testing, debugging, pycharm, pytest

我想将 PyCharm 的内置 Pytest 运行器与调试器一起使用，而无需预先配置断点。

问题是我的测试中的异常被 Pytest 捕获，因此 PyCharm 的事后调试器无法处理异常。

我知道使用断点是可行的，但我不想运行我的测试两次。

在 Unittest 中找到了一种方法，我想知道 Pytest 中是否存在类似的东西。

[有没有办法用 PyCharm 捕获单元测试异常？](https://stackoverflow.com/questions/14081343/is-there-a-way-to-catch-unittest-exceptions-with-pycharm)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-09-03T10:31:47.597

你在使用[pytest-pycharm](https://pypi.python.org/pypi/pytest-pycharm)插件吗？看起来它对我有用。创建 virtualenv，`pip install pytest pytest-pycharm`在 PyCharm 中使用这个 virtualenv，`Edit configuration -> Python Interpreter`然后使用`Debug ...`示例运行：

```
import pytest

def test_me():
    assert None

if __name__ == '__main__':
    pytest.main(args=[__file__]) 
```

PyCharm 调试器停在`assert None`点，与`(<class '_pytest.assertion.reinterpret.AssertionError'>, AssertionError(u'assert None',), None)`

## 编辑

设置 `Preferences > Tools > Python Integration Tools > Default test runner`为**py.test**。然后`Run > Debug 'py.test in test_me.py'`

# c# - 时间：2019-05-10 标签：c#installerapplicationeveryone

> ID：14086072
> 
> 赞同：2
> 
> 时间：2012-12-29T21:25:33.843
> 
> 标签：c#, windows-installer

对于 ac# 安装程序项目，可以在安装时删除单选按钮“everyone”和“just me”。我一直希望这是每个人。这篇文章是解决方案[Remove Everyone and Just Me](http://support.microsoft.com/kb/835460)并且完美运行。但是重建后你必须再做一次。这是很多工作。有没有更简单的方法？

谢谢达摩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T12:57:30.023

感谢鲍勃霍恩。具体解决方案如下：

查看->编辑器->用户界面。单击安装文件夹。在属性窗口中有一个键 InstallAllUsersVisible。将其设置为 false -

# jquery - 以 jQuery UI SelectMenu 插件为主题的选择列表上的 jQuery 验证

> ID：14086074
> 
> 赞同：0
> 
> 时间：2012-12-29T21:25:48.477
> 
> 标签：jquery, asp.net-mvc, jquery-plugins, jquery-validate, jquery-ui-selectmenu

这是对另一个问题的跟进；首先，我需要在正常的选择列表上进行验证。（第一部分可[在此处](https://stackoverflow.com/questions/14078482/problems-with-jquery-validate-on-select-list)获得）

我有一个选择菜单，上面有一些 jQuery 验证逻辑。我正在使用 ASP.NET MVC，所以有一些自定义属性 - 但现在我只想让验证工作，所以属性并不重要。

我设法让它发挥作用（实际上，Gajotres 解决了它，而不是我。）

现在我想将它扩展到 jQuery UI selectmenu 插件（插件仍然是非官方的 - 预计在下一版本的 jQuery UI 中正式发布，但你可以在这里找到它：[jQuery UI Select Menu (Unofficial)](https://github.com/fnagel/jquery-ui)

我已经设法使样式正常工作，但现在验证再次失败。我正在发布我的代码，并在这里提琴。请注意，为了简洁起见，这里发布的代码不止于此。

# [jsFiddle（带插件）](http://jsfiddle.net/ciel/ZpzNm/)

# [jsFiddle（没有插件[正常工作]）](http://jsfiddle.net/ciel/h4TNN/)

* * *

# 预期行为

当“默认”选项是选择菜单中当前选择的值时，用户不能提交表单。

* * *

### 这是所有相关文件的链接，以防您出于某种原因不想尝试小提琴。

### jQuery

*   [http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css](http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css)
*   [http://code.jquery.com/ui/1.9.2/jquery-ui.js](http://code.jquery.com/ui/1.9.2/jquery-ui.js)

### jQuery 验证插件

*   [http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.js](http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.js)

### 选择菜单（分叉）

*   [http://ciel.github.com/jquery-ui/javascripts/jquery.ui.selectmenu.js](http://ciel.github.com/jquery-ui/javascripts/jquery.ui.selectmenu.js)
*   [http://ciel.github.com/jquery-ui/stylesheets/selectmenu.css](http://ciel.github.com/jquery-ui/stylesheets/selectmenu.css)

# Javascript

```
$(document).ready(function() { 

    $.validator.addMethod("valueNotEquals", function(value, element, arg){
        return arg != value;
    }, "");

    $("#form1").validate({
        rules: {
            select_list : {valueNotEquals: $('#select_list').attr('data-val-mustbe-propertyvalue')},  
        },
        messages: {  
            select_list : { valueNotEquals: $('#select_list').attr('data-val-required') }
        },        
        submitHandler: function(form) {
            alert($('#form1').valid());
            form.submit();
        }
    });

    $("#select_list").selectmenu();
});​ 
```

# HTML

```
<form id="form1" action="">
    <select id="select_list" name="select_list">
            <option value="default">Choose...</option>
            <option value="1">1</option>
            <option value="2">2</option>
    </select>
    <input type="submit" id="submit" value="Submit" />
</form>​ 
```

# CSS

```
 body {
            font-size: 62.5%;
            font-family: "Verdana",sans-serif;
        }

        fieldset {
            border: 0;
        }

        label, select, .ui-select-menu {
            float: left;
            margin-right: 10px;
        }

        select {
            width: 200px;
        }

        .wrap ul.ui-selectmenu-menu-popup li a {
            font-weight: bold;
} 
```

​在 selectmenu.css 文件中可以找到选择菜单主题的其他 CSS，可在此处获得

*   [http://ciel.github.com/jquery-ui/stylesheets/selectmenu.css](http://ciel.github.com/jquery-ui/stylesheets/selectmenu.css)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:35:35.133

您可以将这段代码添加到您的 jQuery 中：

```
//set the submit button disabled
$('input[type="submit"]').attr('disabled','disabled');

//trigger a check of the value when the selectbox is changed
$('#select_list').change(function(){
    if($(this).val() != 'default'){
       $('input[type="submit"]').removeAttr('disabled');
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:55:39.913

我知道您的新实施有什么问题。我自己也遇到了同样的问题。

验证插件无法使用 css display: none 验证元素。为了使这个插件正常工作，原始选择必须隐藏在自定义选项下方。

这是我为证明这一点而制作的一个示例：

[http://jsfiddle.net/Gajotres/64aKZ/](http://jsfiddle.net/Gajotres/64aKZ/)

您应该评论/取消评论这个 css bloc 来确定差异：

```
 #select_list {
         display: block !important;
    } 
```

现在从我所见，这个插件不是为了覆盖旧的选择框而创建的（无论原始显示是块还是没有）。如果你不介意看看我正在起诉的插件。即使它的显示设置为阻止，它也会覆盖旧的选择框：

[http://jamielottering.github.com/DropKick/](http://jamielottering.github.com/DropKick/)

***编辑 ：***

还有另一种解决方案。你需要玩css。将此设置为选择框：

```
 #select_list {
         display: block !important;
         visibility: hidden;
    } 
```

现在您需要用新的选择框覆盖旧的选择框，或者至少将新的选择框浮动到左侧。

# wordpress - 仅当 WordPress 的某个类别中有帖子时才显示标题

> ID：14086083
> 
> 赞同：1
> 
> 时间：2012-12-29T21:27:11.133
> 
> 标签：wordpress, loops, categories

我需要在一个类别上显示一个标题，并且只有在 WordPress 中的类别中有帖子时才必须显示它。标题不应放在每个帖子上。如何解决？

我现在得到的代码：

```
<?php query_posts('category_name=onestar&showposts=5'); ?>
    <?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>
         <div class="wrapper orangecolor">
             <article class="intro">
                 <h2><?php the_title(); ?></h2>
                 <div><?php the_content(); ?></div>
             </article>
         </div>
<?php endwhile; ?>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T13:10:13.117

```
<?php query_posts('category_name=onestar&showposts=5'); ?>
<?php if ( have_posts() ) : ?>
    Put the header here
    <?php while ( have_posts() ) : the_post(); ?>
         <div class="wrapper orangecolor">
             <article class="intro">
                 <h2><?php the_title(); ?></h2>
                 <div><?php the_content(); ?></div>
             </article>
         </div>
    <?php endwhile; ?>
<?php endif; ?> 
```

# objective-c - 如何删除应用程序可访问的所有钥匙串项目？

> ID：14086085
> 
> 赞同：52
> 
> 时间：2012-12-29T21:27:24.067
> 
> 标签：objective-c, ios

我需要删除 iOS 上的杂散钥匙串项目（可能由旧版本的应用程序编写）。有没有简单的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-12-29T22:02:21.350

为所有课程做这件事

**目标-C：**

```
NSArray *secItemClasses = @[(__bridge id)kSecClassGenericPassword,
                       (__bridge id)kSecClassInternetPassword,
                       (__bridge id)kSecClassCertificate,
                       (__bridge id)kSecClassKey,
                       (__bridge id)kSecClassIdentity];
for (id secItemClass in secItemClasses) {
    NSDictionary *spec = @{(__bridge id)kSecClass: secItemClass};
    SecItemDelete((__bridge CFDictionaryRef)spec);
} 
```

**迅速：**

```
let secItemClasses = [kSecClassGenericPassword, kSecClassInternetPassword, kSecClassCertificate, kSecClassKey, kSecClassIdentity]
for itemClass in secItemClasses {
    let spec: NSDictionary = [kSecClass: itemClass]
    SecItemDelete(spec)
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-08-14T05:40:01.437

关于*如何删除应用程序可访问的所有钥匙串项目的*[已接受答案](https://stackoverflow.com/a/14086320/883738)的 Xamarin iOS 版本（MonoTouch）如下：

 *```
foreach (var recordKind in new []{
                SecKind.GenericPassword,
                SecKind.Certificate,
                SecKind.Identity,
                SecKind.InternetPassword,
                SecKind.Key,
            })
    {
          SecRecord query = new SecRecord(recordKind);
          SecKeyChain.Remove(query);
    } 
```

如果您想确保确实删除了记录，您可以**在开发期间**使用以下代码检查特定类型的 KeyChain 中的项目数：

```
SecStatusCode scc;
var records = SecKeyChain.QueryAsRecord(new SecRecord(SecKind.GenericPassword), 1000, out scc); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-11-07T04:43:32.573

我用 Swift 重写了 Daij-Djan 的回答：

```
let secItemClasses = [kSecClassGenericPassword,
    kSecClassInternetPassword,
    kSecClassCertificate,
    kSecClassKey,
    kSecClassIdentity]
for secItemClass in secItemClasses {
    let dictionary = [kSecClass as String:secItemClass]
    SecItemDelete(dictionary as CFDictionary)
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-12-31T01:14:37.403

**斯威夫特版本**

```
import Foundation
import Security

public class Keychain: NSObject {
  public class func logout()  {
    let secItemClasses =  [
      kSecClassGenericPassword,
      kSecClassInternetPassword,
      kSecClassCertificate,
      kSecClassKey,
      kSecClassIdentity,
    ]
    for itemClass in secItemClasses {
      let spec: NSDictionary = [kSecClass: itemClass]
      SecItemDelete(spec)
    }
  }
} 
```

用法：

```
Keychain.logout() 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-12-29T22:02:14.437

感谢 Daij-Djan，我得到了这个解决方案：

```
for (id secclass in @[
     (__bridge id)kSecClassGenericPassword,
     (__bridge id)kSecClassInternetPassword,
     (__bridge id)kSecClassCertificate,
     (__bridge id)kSecClassKey,
     (__bridge id)kSecClassIdentity]) {
    NSMutableDictionary *query = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                  secclass, (__bridge id)kSecClass,
                                  nil];

    SecItemDelete((__bridge CFDictionaryRef)query);        
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-29T21:35:59.003

您可以查看 Utilities 文件夹中的 KeyChain Access 应用程序。如果您启动应用程序并单击“所有项目”，它应该会显示您使用此特定计算机创建的所有项目。开发人员通常以 com 开头。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-30T13:03:00.913

不幸的是，这个问题的所有答案似乎都已过时（自 iOS 7.0+ 起），因为它们不会删除`kSecAttrSynchronizable`设置了标志的钥匙串条目（允许通过 iCloud 同步到其他设备）。

要删除此类条目，可以在删除查询中添加一个条目，指定`kSecAttrSynchronizable: kSecAttrSynchronizableAny`：

```
let secItemClasses = [kSecClassGenericPassword,
    kSecClassInternetPassword,
    kSecClassCertificate,
    kSecClassKey,
    kSecClassIdentity]
for secItemClass in secItemClasses {
    let query: NSDictionary = [
        kSecClass as String: secItemClass,
        kSecAttrSynchronizable as String: kSecAttrSynchronizableAny
    ]
    SecItemDelete(query)
} 
```*

# javascript - 在 Android 上更改文本操作的字体

> ID：14086089
> 
> 赞同：0
> 
> 时间：2012-12-29T21:27:49.413
> 
> 标签：javascript, android, html, css

我有一个带有文本输入和等宽字体的网页：

```
<input type="text" style="font-family: monospaced"> 
```

这就像在 Android 上的魅力。但是当我在设备上进入“编辑”模式时，当键盘弹出时，字体会变回特定于平台的字体（不是等宽字体）。当编辑完成并且文本字段失去焦点时，它再次变回等宽。

这里的想法是在编辑文本时也将文本操作字体更改为等宽字体。有没有办法从 HTML / CSS / Javascript 中做到这一点？我的第一印象是“不”，因为这似乎是在底层 TextView 中定义的平台。但也许我的印象是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:33:25.720

您是在谈论嵌入式 WebView。那么这是可能的。

您可以在 Android 中添加一个[javascript 界面。](http://developer.android.com/guide/webapps/webview.html)然后在您的 javascript 中，您可以在输入字段上添加一个事件侦听器，该侦听器将使用 javascript 界面触发本机应用程序上的操作。此操作也可能会更改本机组件的字体系列。

# php - 仅在 mysql 中从表中获取特定日期的值

> ID：14086096
> 
> 赞同：1
> 
> 时间：2012-12-29T21:29:33.510
> 
> 标签：php, mysql, date, time, between

我无法在我的数据库中获取特定日期的值

样本值：

```
$from= 12/15/2012 $to= 12/15/2012
$from= 12/16/2012 $to= 12/16/2012
$from= 12/17/2012 $to= 12/17/2012 
```

php脚本：

```
$query=" select * from call where (date_time BETWEEN '$from' AND '$to') ORDER BY date_time DESC"; 
```

我从中获取日期的桌子上的值有时间

我数据库中的 ex 值：

```
12/15/2012 2:51
12/15/2012 2:21
12/15/2012 2:55
12/15/2012 3:12
12/16/2012 2:51
12/16/2012 2:21
12/17/2012 2:55
12/17/2012 3:12 
```

当我搜索`from 12/15/2012 to 12/15/2012` 它时不显示值

```
12/15/2012 
```

但如果我搜索

从`12/15/2012 to 12/16/2012`

它不仅显示 2012 年 12 月 15 日的值，还显示 2012 年 12 月 16 日的值

我应该怎么做才能仅包含该特定日期的所有值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:50:41.993

首先，您应该将时间值存储在[`DATETIME`](http://dev.mysql.com/doc/refman/5.6/en/datetime.html)（或可能`TIMESTAMP`）列中。然后按照给出的[这个问题](https://stackoverflow.com/questions/14063042/timestamp-interval)的答案。

但是，如果您*真的*坚持对字符串执行此操作，则始终可以使用[`LIKE`](http://dev.mysql.com/doc/refman/5.6/en/string-comparison-functions.html)比较：

```
SELECT * FROM `call` WHERE date_time LIKE '12/15/2012 %' 
```

（[sqlize.com 上的演示](http://www.sqlize.com/0pGU3My8Lo)）

当然，这仅适用于查找一天的所有记录（或经过适当修改，查找单个小时/分钟/月/年/等）。如果您需要更复杂的选择标准，我强烈建议您切换到真正的`DATETIME`专栏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T21:54:45.920

假设您将日期存储为日期时间字段，您应该将数据转换为`Date`类型。

当你写：

```
$from= 12/15/2012 
```

PHP 做一个除法：12 / 15 然后 ( 12 / 15 ) / 2012

一种方法将被声明`$from`为字符串并在查询中转换为日期：

```
$from= '12/15/2012'
...
"select * from call where (date_time BETWEEN STR_TO_DATE('$from', '%m/%d/%Y') ..." 
```

**索引友好**计划的正确查询是：

```
select * 
from   `call` 
where  date_time >= STR_TO_DATE('$from', '%m/%d/%Y') and 
       date_time < date_add( STR_TO_DATE('$to', '%m/%d/%Y'), interval 1 day) 
```

[在 sqlfiddle 中查看](http://sqlfiddle.com/#!2/15de1/1/0)

# php - 函数总是返回 false

> ID：14086097
> 
> 赞同：-1
> 
> 时间：2012-12-29T21:29:36.530
> 
> 标签：php

我正在做一个用户申请活动的项目。我现在拥有的相关代码如下：

```
 <? if(in_array($u_id, $app)){ ?>
          <td>Unapply:</td>
          <td><a href="event_unapply.php?event_id=<?=$e_id; ?>">Unapply</a></td>
      <? } else{ ?>
           <td>Apply:</td>
           <td><a href="event_apply.php?event_id=<?=$e_id; ?>">Apply!</a></td>
      <? }?> 
```

现在，如果应用了用户，则数组的 print_r 如下所示：

`Array ( [0] => Array ( [id] => 3 [Userid] => 1 ) )`

$u_id 与事件中的 [Userid] 匹配，但它总是转到 else 语句。

我试过这样做`$app['0']`，但每次用户没有申请事件时，它都会返回一个 PHP 错误。

有没有人有想法让它起作用？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-29T21:31:56.020

Nvmd，有一点脑子放屁，但我通过以下方式让它正常工作：

```
 <? if($u_id == $app['0']['Userid']){ ?>
          <td>Unapply:</td>
          <td><a href="event_unapply.php?event_id=<?=$e_id; ?>">Unapply</a></td>
      <? } else{ ?>
           <td>Apply:</td>
           <td><a href="event_apply.php?event_id=<?=$e_id; ?>">Apply!</a></td>
      <? }?> 
```

# javascript - 替换/忽略字符串中的 JavaScript

> ID：14086106
> 
> 赞同：2
> 
> 时间：2012-12-29T21:30:16.517
> 
> 标签：javascript, jquery, rss

我用 JQuery 写了一个小型 RSS 阅读器。起初有一个带有文章标题的屏幕，当单击标题时，我会加载该文章的内容。问题是，它包含一些谷歌广告脚本，它将替换文章的内容并用广告填满整个屏幕。

以下脚本是我要替换或忽略的内容：

```
<script type="text/javascript"><!--
google_ad_client = "ca-pub-8356817984200457";
/* ijsselmondenieuws.nl */
google_ad_slot = "9061178822";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script><br />
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script> 
```

所以我写了一个方法，它应该通过一个简单的替换来删除脚本：

```
 var replaceScript='<script type="text/javascript"><!--\n' +
'google_ad_client = "ca-pub-8356817984200457";\n' +
'/* ijsselmondenieuws.nl */\n' +
'google_ad_slot = "9061178822";\n' +
'google_ad_width = 468;\n' +
'google_ad_height = 60;\n' +
'//-->\n' +
'</script>\n' +
'<script type="text/javascript"\n' +
'src="http://pagead2.googlesyndication.com/pagead/show_ads.js">\n' +
'</script>';

function removeADS(ads) {
    removeAD = ads.replace(replaceScript, " ");
} 
```

但这不起作用，我认为它也不灵活（如果可以的话）。当脚本中的某些内容发生变化时，应用程序将再次卡在广告上。在从 RSS 提要或更灵活的替换脚本中获取内容时，是否有某种方法可以完全忽略此脚本？

任何帮助表示赞赏，

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:41:43.703

用正则表达式解析 xml/html 不是很明智。
使用 dom 解析器（jquery 是一个漂亮的...提示提示）：

```
var rssContentString = '<rss version='2.0'>...',
    xmlDoc = $.parseXml(rssContentString),
    $xml = $(xmlDoc),
    helper = $('<div />'),
    result;

result = helper
    .append(
        $xml
            .find('script')
                .remove()
                .end()
    )
    .text(); 
```

**更新**
基于新的评论，因为你得到你的 rss 内容是这样的：

```
content:$.trim($(v).find("content").text()) 
```

您可以将此表达式修改为以下内容：

```
content:$.trim($(v).find("content").find('script').remove().end().text()) 
```

# symfony - Symfony2 - Doctrine2 - 多对一关系 / 类型为“Doctrine\Common\Collections\Collection”、“Proxies\...Entity...Proxy”的预期参数

> ID：14086118
> 
> 赞同：1
> 
> 时间：2012-12-29T21:32:43.653
> 
> 标签：symfony, doctrine-orm, many-to-one

我正在尝试构建“编辑”控制器/视图，但遇到此错误。从我读到它可能是一个关联问题，我已经尝试修复它，但我不知道它有什么问题。它应该返回一个集合，但我什至不知道“代理”是什么意思以及它是如何得到它的。

我正在为其构建编辑视图的实体：

```
 <?php

namespace Monse\WebBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Monse\WebBundle\Entity\BasedeDatos
 *
 * @ORM\Table()
 * @ORM\Entity
 */
class BasedeDatos
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

   /**
* @ORM\ManyToOne(targetEntity="Monse\WebBundle\Entity\ServidoresBD")
* @ORM\JoinColumn(name="servidores_id", referencedColumnName="id",nullable=false)
*
*/
    private $servidorBD;

    /**
     * @var string $nombreBD
     *
     * @ORM\Column(name="nombreBD", type="string", length=255,unique=true)
     */
    private $nombreBD;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set servidorBD
     *
     * @param integer $servidorBD
     */
    public function setServidorBD(\Monse\WebBundle\Entity\ServidoresBD $servidorBD)
    {
        $this->servidorBD = $servidorBD;
    }

    /**
     * Get servidorBD
     *
     * @return integer 
     */
    public function getServidorBD()
    {
        return $this->servidorBD;
    }

    /**
     * Set nombreBD
     *
     * @param string $nombreBD
     */
    public function setNombreBD($nombreBD)
    {
        $this->nombreBD = $nombreBD;
    }

    /**
     * Get nombreBD
     *
     * @return string 
     */
    public function getNombreBD()
    {
        return $this->nombreBD;
    }
    public function __construct()
    {
        $this->servidorBD = new Doctrine\Common\Collections\ArrayCollection();
    }
} 
```

表格类型：

```
<?php

namespace Monse\WebBundle\Form;
use Doctrine\ORM\EntityRepository;
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class BasedeDatosType extends AbstractType
{ 
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
           ->add('ServidorBD','entity',
                  array ('class' => 'MonseWebBundle:ServidoresBD',
                        'multiple' => true, 
                        'required' => true, 
                        'label' => 'Servidor de Base de Datos: ',
                         'query_builder' => function(EntityRepository $er) {
                         return $er->createQueryBuilder('u')
                         ->orderBy('u.url', 'ASC');
                                                                           },
                         ))
            ->add('nombreBD','text', array( 'required' => true, 'label' => 'Nombre Base de Datos: '))
            ->add('UsuarioBD','entity',array('class' => 'MonseWebBundle:UsuariosBD','multiple' => true,
                                             'required' => true, 'label' => 'Usuario Asociado: ',
                                             'property_path' => false,
                                             'query_builder' => function (EntityRepository $er){
                                              return $er->createQueryBuilder('s')
                                              ->orderBy ('s.usuario','ASC'); },))
            ;

    }

    public function getName()
    {
        return 'basededatos';
    }
} 
```

负责该问题的实体（我认为）：

```
<?php

namespace Monse\WebBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Monse\WebBundle\Entity\ServidoresBD
 *
 * @ORM\Table()
 * @ORM\Entity
 */
class ServidoresBD
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;
    /**
     * @var string $url
     *
     * @ORM\Column(name="url", type="string", length=255)
     */
    private $url;
  /**
   *
   * @ORM\OneToOne (targetEntity="Monse\WebBundle\Entity\Dominios")
   * @ORM\JoinColumn(name="dominio_id", referencedColumnName="id",nullable=false,unique=true)
   */
    private $dominio;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set dominio
     *
     * @param integer $dominio
     */
    public function setDominio(\Monse\WebBundle\Entity\Dominios $dominio)
    {
        $this->dominio = $dominio;
    }

    /**
     * Get dominio
     *
     * @return integer 
     */
    public function getDominio()
    {
        return $this->dominio;
    }

     /**
     * Set url
     *
     * @param string $url
     */
    public function setUrl($url)
    {
        $this->url = $url;
    }

    /**
     * Get url
     *
     * @return string 
     */
    public function getUrl()
    {
        return $this->url;
    }
    public function __toString()
{
    return $this->getUrl();
}

} 
```

表格类型：

```
<?php

namespace Monse\WebBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class ServidoresBDType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('url')
            ->add('dominio', 'collection', array('type' => new DominiosType()));
        ;
    }
 public function getDefaultOptions(array $options)
    {   
        return array(
            'data_class' => 'Monse\WebBundle\Entity\ServidoresBD'
        );
    }
   public function getName()
{
    return 'issue_selector';
}
} 
```

我应该在哪里添加要返回的arraycollection？我如何防止这种情况再次发生？如果这是一个愚蠢的问题，我很抱歉，我正在努力学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T18:31:15.563

我在第一个表单类型中将两个“多个”属性更改为 false。

# c# - C# MVC 4 ViewModel 导致 DropDownList 名称错误

> ID：14086124
> 
> 赞同：3
> 
> 时间：2012-12-29T21:33:21.023
> 
> 标签：c#, razor, asp.net-mvc-4, viewmodel

免责声明：我是 C#、.Net 和 MVC 的新手。这也是我的第一个 ViewModel。

我有一个看起来像这样的视图模型。

```
 public class ProjectEditIndexData
 {
    public Project Project{ get; set; }
    public List<Characteristic> Chars { get; set; }
    public List<Tag> Tags { get; set; }
    public List<Category> Cats { get; set; }

    public IEnumerable<SelectListItem> Types { get; set; }
} 
```

我的控制器

```
 public ActionResult Edit(int id = 0)
    {
        ProjectEditIndexData project = new ProjectEditIndexData();
        project.Project = db.Projects.Find(id);
        project.Tags = db.Tags.ToList();
        project.Chars = db.Characteristics.ToList();
        project.Cats = db.Categories.ToList();
        project.Types = new SelectList(db.ProjectTypes, "ProjectTypeID", "Type", project.Project.ProjectTypeID);

        if (project == null)
        {
            return HttpNotFound();
        }
        return View(project);
    } 
```

我有这样的观点。

```
 @Html.DropDownList("ProjectTypeID", (SelectList)ViewBag.Types) 
```

呈现的 HTML

```
 <select id="ProjectTypeID" name="ProjectTypeID" class="valid">
     <option selected="selected" value="1">Novel</option>
     <option value="2">Type 1</option>
     <option value="3">Type 2</option>
     <option value="4">Type 3</option>
     <option value="5">Type 4</option>
 </select> 
```

大多数情况下，这一切都很好。问题是，一旦我发布表单，Project.ProjectID 的值为 0，因为下拉列表中的 NAME 属性是“ProjectTypeID”而不是“Project.ProjectTypeID”。如何让下拉列表具有正确的名称，以便正确发布并且可以更新 Project 表中的记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T21:44:55.843

尝试使用辅助扩展方法的另一个重载：

```
@Html.DropDownList("Project.ProjectTypeID", (SelectList)ViewBag.Types) 
```

# windows - 如何检测人工鼠标移动？

> ID：14086127
> 
> 赞同：4
> 
> 时间：2012-12-29T21:33:53.807
> 
> 标签：windows, mouse

我们编写了一个游戏，您可以在其中尽可能快地射击目标，并且有人编写了一个程序来自动射击目标（通过模拟鼠标移动/点击）。

我怎样才能检测到这个？本来想监控鼠标速度之类的，不过好像太容易绕过去了。如果有帮助，游戏可以在 Windows 上运行 / 是用 C++ 编写的。有没有办法只说运动不是来自硬件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:52:48.700

请参阅[如何检测鼠标单击是合法的还是自动的？](https://stackoverflow.com/questions/5091780/how-to-detect-if-mouse-click-is-legit-or-automated)本质上它说它不能可靠地完成，原因有几个，其中一个是程序员会找到一种方法来绕过你尝试做的任何事情。

正如所建议的，启发式似乎是一个可行的选择。监控可变鼠标速度、未命中率和准确性、暂停、突然跳跃等。启发式方法越好，程序员就越需要让他的机器人更接近真正的玩家，他就越不成功。

PS：即使对于像反恐精英这样的知名射击游戏，也有一些[黑客](http://www.hackpconline.com/2010/02/top-5-counter-strike-hacks-cheats.html)可以完美地为你拍摄一切，所以他们还没有想出如何/不想阻止它。

# ruby-on-rails - url 应该如何存储在记录中？

> ID：14086133
> 
> 赞同：0
> 
> 时间：2012-12-29T21:35:11.927
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem

我有个问题。

我有评论模型，其中有正文列，用户可以在其中输入任何内容。
显然，用户可能会键入指向其他网站的 url 链接。
在我的猜测中，我认为它应该在保存时替换为**<a href >**标签。
有什么好的宝石或东西可以处理这种事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:53:29.287

如果您不想使用成熟的降价解析器 ( [Redcarpet](https://github.com/vmg/redcarpet) )，请使用[Rinku](https://github.com/vmg/rinku)。它超级快速和*安全*。不要使用任何基于正则表达式的解决方案，因为您很可能会面临安全风险。

```
text = "Hello! Check this out: https://github.com/vmg/rinku"
Rinku.auto_link(text, mode=:all, link_attr=nil, skip_tags=nil) 
```

产生：

```
=> "Hello! Check this out: <a href=\"https://github.com/vmg/rinku\">https://github.com/vmg/rinku</a>" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:48:59.650

为了子孙后代而保留，但我觉得重要的是要注意这不是解决问题的安全方法。除非您想为自己找出所有安全隐患，否则不要遵循此建议。Jiří Pospíšil 的回答更好。=D

你真的不需要宝石来做到这一点（我个人尽量避免使用宝石来做这么简单的事情）。编写一个对您的目的相当可靠的正则表达式，然后使用类似的东西

`input.gsub(regex, '<a href="\1">some text</a>')`

将链接转换为等效的 html。请注意，您需要使用它`raw`来显示结果，否则 rails 会为您转义输出。这也意味着用户将能够放入其他任意标记，除非您在它进入数据库时​​对其进行转义。确保你这样做。

或者，您可以在显示它时执行相同的操作，但需要稍微不同的注意事项/步骤。

# css - CSS 3 - 前后状态的圆角

> ID：14086136
> 
> 赞同：8
> 
> 时间：2012-12-29T21:35:29.957
> 
> 标签：css

我对 CSS 3 有一点问题，即我会用单个项目创建这样的对象。这是我想要实现的图像：

![在此处输入图像描述](../Images/e937331ef133e9d4d2eefdeafc618b94.png)

这是我的：

**CSS**：

```
body{
background:grey;
    padding:10px;
}
#talkbubble {
margin:0 auto;
box-shadow: 3px 10px 7px #deefe5;
   width: 590px;
   height: 160px;
   background: white;
   position: relative;
   border-radius:10px;
   border-bottom-left-radius:0px;
}
#talkbubble:before {
box-shadow: 10px 10px 5px #deefe5;
   content:"";
   position: absolute;
   background:white;
   top: 100%;
   width: 228px;
   height: 62px;
   border-bottom-left-radius:         10px;
   border-bottom-right-radius:         10px;

}
#talkbubble:after{
   content:"";
   position: absolute;
   top:100%;
   left:228px;
   border-top: 10px solid white;
   border-right: 10px solid transparent;
   background:white;

}​ 
```

**HTML**：

```
<div id="talkbubble"></div>​ 
```

还有一个[jsFiddle 演示](http://bit.ly/YYrJ5D)

如何使两个部分之间的角度四舍五入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:54:10.980

从[这里](http://lea.verou.me/2011/03/beveled-corners-negative-border-radius-with-css3-gradients/)获取信息，您可以得到：

```
body
{
    background:grey;
    padding:10px;
}
#talkbubble 
{
    margin:0 auto;
    box-shadow: 3px 10px 7px #deefe5;
    width: 590px;
    height: 160px;
    background: white;
    position: relative;
    border-radius:10px;
    border-bottom-left-radius:0px;
}
#talkbubble:before 
{
    box-shadow: 10px 10px 5px #deefe5;
    content:"";
    position: absolute;
    background:white;
    top: 95%;
    width: 228px;
    height: 62px;
    border-bottom-left-radius: 10px;
    border-bottom-right-radius: 10px; 
}
#talkbubble:after
{
   content:"";
   position: absolute;
   top:100%;
   left:228px;
   background:-webkit-radial-gradient(100% 100%, circle, rgba(204, 0, 0, 0) 10px, white 10px);
   width: 10px;
   height: 10px;
}​ 
```

[http://jsfiddle.net/uCRMQ/2](http://jsfiddle.net/uCRMQ/2)

//只是背景阴影不起作用。现在背景阴影适用于此（在此尺寸下）。

华拉巴

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T21:49:23.267

简短的回答：你不能。

你在那里所做的已经成功地创建了一个框**：在**DIV 元素之后，但是如果你开始在 DIV 中输入文本，它不会“流入”到底部。

要实现您在 CSS3 中的目标，您至少需要 3 个 DIV 和透明效果，而且您​​仍然会遇到文本溢出的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T22:45:07.043

像魅力一样工作：http: [//jsfiddle.net/42DJh/7/](http://jsfiddle.net/42DJh/7/)

只需替换为：

```
#talkbubble:after{
   content:"";
   position: absolute;
   top:100%;
   left:228px;
   border-top: 10px solid white;
   border-right: 10px solid transparent;
   border-top: 10px solid transparent;
   border-left: 10px solid transparent;
   border-top-left-radius:10px;
   background:transparent;
   box-shadow:  -3px -3px 1px white;
} 
```

# mysql - 通过最低 ID 获取记录

> ID：14086140
> 
> 赞同：1
> 
> 时间：2012-12-29T21:36:32.077
> 
> 标签：mysql, group-by, record, min

我有一张桌子：

```
表名：page_description
deciption_id (pk)、page_id (fk)、language_id (fk)、名称
1, 1, 1, 第一页
2、1、2、首页_second_lang
3, 2, 1, 第二页
4, 3, 2, 第三页

通常，此表包含来自不同语言页面的数据。

第一行表示：第一页名称是语言 1 的“第一页” - 现在是英语。

我想要页表中的每一页，以及 LOWEST language_id 的名称！

所以是这样的：
1, 1, 1, 第一页
3、2、1、第二页
4, 3, 2, 第三页

```

我有一个查询：

```
选择 *
FROM 标题描述
按标题 ID 分组
ORDER BY heading_id ASC,
         language_id ASC

```

它给了我想要的东西。但如果表格如下所示：

```
表名：page_description
deciption_id、page_id、language_id、名称
1、1、2、首页_second_lang
2, 1, 1, 第一页
3, 2, 1, 第二页
4, 3, 2, 第三页

```

ORDER BY 不会归还我想要的。我试过。

这里： [http ://sqlfiddle.com/#!2/de7bd/6/0](http://sqlfiddle.com/#!2/de7bd/6/0)

在第一行，我想查看 language_id 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:51:00.573

我假设 page_id 和 language_id 是主键

像这样的东西（[sql fiddle](http://sqlfiddle.com/#!2/73f7d/12)）

```
select pd.* 
  from page_description pd 
  join (select page_id, 
               min(language_id) as language_id
          from page_description 
         group by page_id) as a
    using (page_id, language_id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:48:08.950

我猜你的表的主键是heading_id。如果是这种情况，您不应该对其进行分组（它始终是唯一的）或按其排序：

```
SELECT * 
FROM heading_description 
ORDER BY language_id ASC 
```

# android - 是否可以在 Android API 8 中自定义对话框主题

> ID：14086141
> 
> 赞同：0
> 
> 时间：2012-12-29T21:36:34.830
> 
> 标签：android, dialog, android-theme

我花了一整天的时间试图找到这个无济于事！在使用我的应用程序后，我想为我的用户提供一个摘要，一个简单的对话框是显而易见的解决方案。但是，我无法自定义主题以更改背景和按钮。我在这个问题上找到的每个教程和解释都使用 API 11 技术，我的目标是 API 8。

有没有办法为 API 8 设置对话框主题，以便我可以更改背景可绘制对象、字体、图标等？我发现了各种更改字体、图标、添加可绘制对象等的技术（例如[http://www.helloandroid.com/tutorials/how-display-custom-dialog-your-android-application](http://www.helloandroid.com/tutorials/how-display-custom-dialog-your-android-application)），但没有改变背景图形或颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:18:44.353

```
//set up dialog
Dialog dialog = new Dialog(this);
dialog.setContentView(R.layout.dialog_layout); 
```

Just specify a custom layout file for you dialog and specify there all the attributes you need including background drawable etc.

# facebook - 我可以在 Facebook 应用上设置页面标签高度吗？

> ID：14086142
> 
> 赞同：9
> 
> 时间：2012-12-29T21:36:39.770
> 
> 标签：facebook

我使用[Heroku 托管选项](https://devcenter.heroku.com/articles/facebook)创建了一个 Facebook Page Tab 应用程序。我看到了将页面选项卡的宽度设置为正常 (810 像素) 或窄 (520 像素) 的选项，但没有看到设置高度的选项，就像在创建“Facebook 上的应用程序”应用程序时那样。

我知道我可以将此应用程序设置为“Facebook 上的应用程序”，但我想知道我是否可能在“页面选项卡”应用程序设置中遗漏了某些内容。

这是“Facebook 上的应用”和“页面标签”应用设置页面的[屏幕截图。](https://dzwonsemrish7.cloudfront.net/items/433W3l0A2k2d0U2F301E/Screenshot_12_29_12_4_27_PM-2.png?v=d3dcc75d)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-07T06:07:40.823

这是有效的，基于[https://stackoverflow.com/a/13181388/820113](https://stackoverflow.com/a/13181388/820113)

```
<script src="//connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript" charset="utf-8">
window.fbAsyncInit = function() 
{
    FB.init({ appId: 'appid', 
    status: true, 
    cookie: true,
    xfbml: true,
    oauth: true});

    FB.Canvas.setAutoGrow();
}
</script> 
```

并`<div id="fb-root"></div>`在体内。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-08T11:47:04.413

找到最新的解决方案@ Step 2014

你需要做什么

添加后：

```
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '{Your-mail-App_id}',
      xfbml      : true,
      version    : 'v2.0'
    });
      FB.Canvas.setSize({ width: 770, height: 735 }); // set your own figure
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk')); 
```

就这些。它肯定会起作用。FB.Canvas.setSize() 不带参数意味着让FB自动检测页面大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-30T18:48:33.887

在关闭 body 标签之前插入：

```
<div id="fb-root"></div>
<script type="text/javascript" src="//connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript" charset="utf-8">
    window.fbAsyncInit = function() {
        FB.init();
        FB.Canvas.setAutoGrow();
    }
</script> 
```

# windows-7 - 旧 Crystal Reports 不喜欢 Windows 7 x64

> ID：14086148
> 
> 赞同：0
> 
> 时间：2012-12-29T21:37:49.197
> 
> 标签：windows-7, vb6, crystal-reports

大约 15 年前，我使用 Crystal Reports 在 VB6 中为客户端编写了一个系统。他们一直在愉快地使用这个系统，直到他们在一两个星期前联系了我。显然，他们决定适应 21 世纪并将他们的计算机升级到 Windows 7 x64。现在 VB6 系统仍然可以正常工作，但是 Crystal Reports 已经变成了梨形。Ferinstance，他们不能再“预览”报告了 - 他们收到一条错误消息：

> 文件 C:\Program Files (x86)\Blahblahblah System\MyReport.rpt 中的错误：排序规则值无效。

谷歌搜索该消息；据我所知，它以前从未被报道过。但是打印工作正常......除了在他们网络上的一两台计算机上，任何打印报告的尝试都会遇到错误：

> 文件 C:\Program Files (x86)\Blahblahblah System\MyReport.rpt 中的错误：没有默认打印机。

不用说，计算机*确实*有默认打印机，因此该消息显然是伪造的。

他们确实有原始的 VB6 源代码，但这对我来说没什么好处，因为我不再有 VB6 开发环境。我可以用它来阅读它，也许可以诊断......

任何人都对旧的 Crystal Reports 文件有任何想法，以及可能导致上述错误消息的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T10:11:45.623

啊，这只是旧的 DLL 地狱。`CRPE32.DLL`在一台计算机上找到 3 个不同版本。通过尝试将不同的 DLL 放入`c:\windows\syswow64`其中，我找到了一个可行的。大多。

# postgresql - 在预定时间从 oracle 到 PostgreSQL

> ID：14086149
> 
> 赞同：-3
> 
> 时间：2012-12-29T21:38:17.477
> 
> 标签：postgresql, oracle10g, openerp

我想要一个在特定时间将一组数据从 oracle 传输到 PostgreSQL 的程序（每 24 次将新行从 oracle 复制到 PostgreSQL）是否有任何程序或脚本可以执行此操作...我想在移动数据时使用它使用oracle数据库打开ERP考勤模块的指纹读取器（RFID），让HR的生活更轻松......

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T01:45:38.853

如果您想要一个完全集成的解决方案，您可以使用[Talend](http://www.talend.com/products/data-integration)之类的东西（或者如果您在环境中的任何地方都有 Microsoft SQL Server，SSIS 也可以这样做）。

不过，从它的声音来看，我很想使用一个简单的 cron 作业，它使用 SQL*Plus 将新行保存到数据文件中，然后使用 PSQL 将该数据库加载到 Postgres 中。

# android - (Android) 如何判断声音是否在 soundpool 中播放

> ID：14086150
> 
> 赞同：3
> 
> 时间：2012-12-29T21:38:17.283
> 
> 标签：android, audio, soundpool

有没有办法可以判断 SoundPool 中是否正在播放某种声音？？？IE

```
 if(MySound./*Command Goes Here*/()==true{
//Do stuff
        } 
```

如果您能指出正确的方向或给我代码，我将不胜感激。我在文档上找不到任何这样做的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T21:51:28.527

这是不可能的`SoundPool`。

请参阅[Android SoundPool：播放结束时收到通知，](https://stackoverflow.com/questions/4436055/android-soundpool-get-notified-when-end-of-played)了解其他两个想法：

*   使用`MediaPlayer`，它提供一个`OnCompletionListener`, 而不是`SoundPool`
*   `MediaPlayer`与 结合使用`SoundPool`。预先加载声音`MediaPlayer`以获取持续时间并根据播放时的持续时间跟踪声音是否完成播放`SoundPool`。

# vim - 更改 NERDTree 的打开命令

> ID：14086151
> 
> 赞同：-1
> 
> 时间：2012-12-29T21:38:19.820
> 
> 标签：vim, command, nerdtree

> **可能重复：**
> [有什么方法可以减少 VIM 中的命令？](https://stackoverflow.com/questions/9371723/is-there-any-way-to-reduce-the-command-in-vim)

在 vim 中打开你的 NERDTree 菜单，你输入 :NERDTree，但这真的让我很恼火，因为它很长而且大小写混合。既然你用 q 关闭它，我想用一个短键打开它（也许**:n**，如果你愿意，你也可以为此提供建议）。我该如何改变呢？

如果这很简单，我很抱歉，但我是新手，我不知道从哪里开始解决这样的问题 - 从插件文件，或者在你的 .vimrc 中有特殊的重新映射技术。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T21:39:44.437

您可以使用

```
map <F2> :NERDTreeToggle<CR> 
```

将 NERDTree 映射到您喜欢的任何键（本例中为 F2）

也可以将其映射到：n

```
map :n :NERDTreeToggle<CR> 
```

但这不是很常见，我喜欢使用其中一个 F 键，因为它更快。

# c# - Access 数据库的事务范围

> ID：14086154
> 
> 赞同：0
> 
> 时间：2012-12-29T21:38:51.537
> 
> 标签：c#, .net, transactions, transactionscope

我正在使用带有 c# windows 应用程序的 Access 数据库。我的应用程序使用不同的方法来更新不同的数据库表。我想让我的代码块具有事务性，但访问不支持 TransactionScope。有没有其他方法可以做到这一点？

我现有的代码示例：

```
using (TransactionScope scope = new TransactionScope())
            {
                //If customer exists update it else Register new customer
                if (Customer.IsCustomerExists(cname) == true)
                    Customer.UpdateCustomerInfo(cname, cell, mobile, phone);
                else
                    Customer.RegisterNewCustomer(cname, cell, mobile, phone);

                //If source station not exists, Register new station
                if (Station.IsStationExists(source) == false)
                    Station.RegisterNewStation(source);

                //If destination station not exists, Register new station
                if (Station.IsStationExists(destination) == false)
                    Station.RegisterNewStation(destination);

                scope.Complete();
            } 
```

# asp.net - 缓存通过 VirtualPathProvider 返回的静态资源

> ID：14086155
> 
> 赞同：5
> 
> 时间：2012-12-29T21:38:55.180
> 
> 标签：asp.net, caching, virtualpathprovider

我正在使用`VirtualPathProvider`当前将虚拟路径映射到解决方案外部目录的 。我建立这个主要是为了自我锻炼。这完全等同于在解决方案的目录中有一个软链接或 NTFS 硬链接。

无论如何，我设法使用我的自定义提供程序从该虚拟目录成功加载静态图像。

现在的问题是浏览器不会缓存图像。而且服务器甚至不会考虑返回缓存信息（如 ETag）。

这是我所做的：

*   `GetFile(path).Open()``FileStream`通过返回`File.Open()`
*   我**没有**覆盖`GetCacheKey`和`GetCacheDependencies`
*   我确实覆盖`GetFileHash`了返回 Murmur 哈希（似乎是最快的，甚至比 CRC-32）并测试了它
*   调试时，`GetFileHash`从未在我的提供程序中调用

`CTRL-F5`ing 仅返回以下标头（不引用缓存）

```
Cache-Control   private
Content-Length  476
Content-Type    image/png
Date    Sat, 29 Dec 2012 21:25:54 GMT
Server  Microsoft-IIS/8.0
X-AspNet-Version    4.0.30319
X-Powered-By    ASP.NET
X-SourceFiles   [...] 
```

我目前正在 Visual Studio 的调试服务器和配备 Firebug 的 Firefox 中进行调试。

例如，这是我所期望的（http://i.stack.imgur.com/3mn3d.png）

```
Accept-Ranges   bytes
Cache-Control   max-age=315360000
Content-Length  1059
Content-Type    image/png
Date    Sat, 29 Dec 2012 21:35:29 GMT
Etag    "7d636a8ef932ed081c16ace6f87b16e6"
Expires Fri, 12 Feb 2038 09:58:39 GMT
Last-Modified   Tue, 14 Feb 2012 22:07:18 GMT
Server  ECAcc (fcn/4089)
X-Cache HIT 
```

问题很明显：如何让浏览器**不**重新加载这些静态资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-08T09:41:12.897

为了缓存数据，我通常以这种方式使用 webconfig，这在我个人的建议下非常简单：

```
<system.webServer>
    <staticContent>
       <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="180.00:00:00" />
    </staticContent>
   <caching>
    <profiles>
    <add extension=".ico" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".html" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".htm" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".pdf" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".bmp" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".jpeg" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".png" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".gif" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".js" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".css" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    <add extension=".jpg" policy="CacheUntilChange" kernelCachePolicy="DontCache" />
    </profiles>
   </caching>
  </system.webServer> 
```

我已经解决了我所有的问题。

您可以在这里查看使用相同技术的[http://italiancallcenter.com或](http://italiancallcenter.com)[http://annunciando.biz](http://annunciando.biz)，您可以在最后使用 firebug 或 chrome 进行检查....

我唯一没有优化的是 etags。

我希望这是有帮助的

# gnuplot - 在画布 Gnuplot 中查找坐标

> ID：14086160
> 
> 赞同：0
> 
> 时间：2012-12-29T21:39:56.990
> 
> 标签：gnuplot

我使用 gnuplot 制作了一个图表并将其转换为 png 文件（Canvas）。我想知道生成的 png 文件中每个点的确切坐标，但问题是图形位于画布中间，这给了我错误的坐标。希望它不会太难理解..可以上传图片，如果它更容易理解..

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T13:37:54.270

使用[Imagemagic](http://www.imagemagick.org/script/index.php)，您可以获得包含每个像素的坐标和颜色的文本文件

```
convert example.png example.txt 
```

**示例.txt：**

```
# ImageMagick pixel enumeration: 275,297,255,rgb
0,0: (159,159,159)  #9F9F9F  rgb(159,159,159)
1,0: (172,172,172)  #ACACAC  rgb(172,172,172)
2,0: (172,172,172)  #ACACAC  rgb(172,172,172)
3,0: (172,172,172)  #ACACAC  rgb(172,172,172)
4,0: (172,172,172)  #ACACAC  rgb(172,172,172)
5,0: (172,172,172)  #ACACAC  rgb(172,172,172)
6,0: (172,172,172)  #ACACAC  rgb(172,172,172)
7,0: (172,172,172)  #ACACAC  rgb(172,172,172)
8,0: (172,172,172)  #ACACAC  rgb(172,172,172) 
```

# iphone - 使用 mencoder、handbrake cli 或 ffmpeg 自动检测旋转并相应地旋转视频

> ID：14086164
> 
> 赞同：4
> 
> 时间：2012-12-29T21:40:38.940
> 
> 标签：iphone, ios, rotation, ffmpeg, mencoder

我发现了有关使用 mencoder 和 ffmpeg 旋转视频的问题，但是我追求的是完全自动化的解决方案。

任何人都可以帮助解决这个问题。

我想要

*   检测视频方向
*   需要时旋转
*   重置视频上的元数据（否则在 iOS 设备上观看会导致不必要的旋转）
*   以所需格式保存视频

这样做的原因是希望在 HTML5 视频播放器中使用处理后的视频。如果我在不重置元数据的情况下旋转，iOS 设备将读取元数据并进一步旋转，导致视频再向外旋转 90 度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-09T09:54:56.377

为此，我使用了一个小脚本和 HandBrakeCLI。

注意，“--rotate”参数在 HandBrake 1.0 中发生了变化，这将适用于 1.0.7：

```
for i in *.mp4
do
  r=$(exiftool -Rotation $i | cut -d ":" -f2 | sed 's/^[ ]*//')
  HandBrakeCLI -i $i -o ./out/$i --rotate=angle=$r -e x264 -q 21 -X 1000
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-07T21:56:11.187

与安迪的回答类似，这里是 PowerShell 和 Handbrake 版本

```
$SourceVideoPath = "C:\Videos\"
$ListOfVideos = Get-ChildItem -path $SourceVideoPath  -Filter *.mpg
ForEach ($InputFile in $ListOfVideos){
    $rotationFromEXIF = 0
    Write-Host "Now processing: $InputFile"
    $InputFullName = $InputFile.Fullname
    $OutputFullName = $InputFile.DirectoryName + "\output\" + $InputFile;
    $rotationFromEXIF = ((& 'C:\Utilities\exiftool.exe' -rotation $InputFullName) -split ": ")[1]
    if ($rotationFromEXIF -gt 0){Write-Host "Rotating $rotationFromEXIF degrees"}
    (& 'C:\Program Files\HandBrake\HandBrakeCLI.exe' -i $InputFullName -o $OutputFullName --rotate=angle=$rotationFromEXIF)
    } 
```

# java - JTextPane 突出显示多个单词

> ID：14086165
> 
> 赞同：0
> 
> 时间：2012-12-29T21:40:57.180
> 
> 标签：java, swing, jtextpane

我试图在 jTextPane 中突出显示多个单词，但没有运气。到目前为止，我做了这个：

```
Highlighter h = jTextPane1.getHighlighter();
        h.removeAllHighlights();
        String text = jTextPane1.getText();
        String words[] = text.split(" ");
    for(int i = 0;i<words.length;i++){
        String temp = words[i];
        if(temp.equals("word")){
            try{
            h.addHighlight(i, temp.length(), DefaultHighlighter.DefaultPainter);
            }
            catch(Exception e){
            }
        }
    } 
```

但这只是突出了第一个词。如何选择所有找到的单词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T07:16:11.283

而不是在那里`i`使用`text.indexOf(temp)`

```
h.addHighlight(i, temp.length(), DefaultHighlighter.DefaultPainter); 
```

# asp.net - 在 Dreamweaver CS6 中使用动态数据填充超链接

> ID：14086170
> 
> 赞同：0
> 
> 时间：2012-12-29T21:41:24.107
> 
> 标签：asp.net, sql, variables, hyperlink, dreamweaver

基本上我有一个新闻页面，它在 SQL 数据库中存储标题、故事和唯一的故事标识符。我希望能够在网页上创建指向图片的超链接。

因此，当有人从下拉菜单（使用标题）中选择新闻报道并按下提交时，我想将作为唯一标识符的 storyID 传递到超链接中的某个位置。因此，如果是故事 134，那么链接将如下所示：

我知道 SQL 语句看起来像：

SELECT StoryID from db.News Where Headline = {下拉菜单中选择的标题}

下拉菜单称为 NewsDrop

这将是一个用 VB 代码库编写的 ASPX 页面

所以我想我需要帮助将变量传递给搜索字符串和超链接。

甚至不确定这是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:01:35.947

有许多选项可以实现这一点，最常见的是在下拉菜单的超链接中使用[**查询字符串将参数发送到 SQL 存储过程，该存储过程将在 select 语句中的变量中使用它。**](http://en.wikipedia.org/wiki/Query_string)因此，基本上您在下拉菜单中拥有的超链接将被附加，`?storyID=<uniquestoryid>`并且在远端`SELECT StoryID from db.News Where StoryID = @StoryID`使用链接中的标题作为查询字符串和 where 子句中的变量会效率较低，如您所示，但如果那是你唯一的选择它可以完成。

但是，在使用查询字符串时您应该谨慎行事，这里有一个关于查询字符串的优秀基础文章的**[链接](http://www.dotnetperls.com/querystring)**和另一个关于最佳实践的**[链接。](https://stackoverflow.com/questions/4867954/best-practices-in-using-querystring-in-asp-net)**

# json - Cocoa：JSON返回的整数值是id不是int，如何将类型转换为整数？

> ID：14086171
> 
> 赞同：0
> 
> 时间：2012-12-29T21:41:25.223
> 
> 标签：json, cocoa

我有一个简单的 json 文件：

```
{
             "id": 1,
             "url": "someUrl",
            "question": "What is the name?",
        "answer": [
            {
                "a": {
                    "text": "Back to the A",
                    "status": 0
                }
            }
} 
```

我能够使用以下代码将所有这些数据解析到我的 xcode 项目中：

```
NSData* myData = [NSData dataWithContentsOfURL:
                        [NSURL URLWithString:@"http://myWebsite.net/json/myValidjson.json"]
                        ];
    NSDictionary* json = nil;
    if (myData) {
        json = [NSJSONSerialization
                JSONObjectWithData:myData
                options:kNilOptions
                error:nil];
    } 
```

在此之后，以下代码的值：

```
json[@"movies"][0][@"answer"][0][@"a"][@"status"]; 
```

是0，到目前为止我很好。

现在，当我尝试比较时：

```
if (json[@"movies"][0][@"answer"][0][@"a"][@"status"] == 0) {
    NSLog("Value is Equal.");
} 
```

这个 caparison 应该是真的，因为 json[@"movies"][0][@"answer"][0][@"a"][@"status"] 的值为 0 但实际上它是一个 id，不是整数。因此，比较输出错误。

为什么我会得到这个结果？解决方案是什么，以便我可以使“如果”条件为真？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T21:44:26.477

由于您只能将对象存储在`NSDictionary`and中`NSArray`，因此您不能直接放入或获取这样的整数。这就是`NSNumber`类被发明的目的。解析 JSON 时，解析器只要遇到一个数字，就会`NSNumber`用适当的值实例化一个。如果你期望一个整数，你可以像这样做你想做的事：

```
if ([json[@"movies"][0][@"answer"][0][@"a"][@"status"] intValue] == 0) 
```

或者直接比较对象：

```
if ([json[@"movies"][0][@"answer"][0][@"a"][@"status"] isEqual:@0]) 
```

# php - 如何让注册用户的加密密码在登录时被接受为普通密码？

> ID：14086178
> 
> 赞同：-4
> 
> 时间：2012-12-29T21:42:13.157
> 
> 标签：php, codeigniter, phpmyadmin

我最近创建了一个注册页面，用户可以在其中注册并创建自己的帐户。但是如果我退出然后重新进入帐户并尝试登录，则只接受加密版本的密码。如何让我的 loguserin 函数与我的数据库对话并让它明白它实际上是用户最初输入的普通密码？

控制器：

```
 function loguserin()
 {

$this->load->helper(array('form', 'url'));

$this->load->library('form_validation');

$this->form_validation->set_rules('username', 'Username', 'required|min_length[4]|max_length[12]|callback_validateUser|trim');
$this->form_validation->set_rules('password', 'Password', 'required|md5|trim');

if ($this->form_validation->run())
{
    $username = $this->input->post('username');
    $password = $this->input->post('password');
    $this->session->set_userdata('status', 'OK');
    $this->session->set_userdata('username', $username);

    redirect('home');
}
else
{
    $this->session->set_userdata('status', 'NOT_OK');
    $this->load->view('shared/header');
    $this->load->view('account/logintitle');
    $this->load->view('account/loginview');
    $this->load->view('shared/footer');
}
 }

  function validateUser($username, $password)
  {
    $this->db->select('*')->from('membership');
    $this->db->where('username', $username);
    $this->db->where('password',MD5($password));
    $query = $this->db->get();
    if ($query ->num_rows ==1)
    {
    $this->form_validation->set_message('validateUser', 'Invalid username/password');

    return false;
}

else{

    return true;

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:05:26.003

在我看来，您的问题是出于安全考虑，在注册时密码被散列。

在这种情况下，您必须知道使用了什么散列函数。例如[地穴](http://php.net/manual/en/function.crypt.php)。比您应该在执行查询之前简单地加密用户输入。

```
 $hashedPassword = crypt($password);
    $this->db->select('*')->from('membership');
    $this->db->where('username', $username);
    $this->db->where('password', $hashedPassword);
    $query = $this->db->get(); 
```

[以下](http://php.net/manual/en/faq.passwords.php)是 PHP 对密码散列的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:41:46.363

CodeIgniter 似乎没有使用 MD5 加密密码。如指定`set_rules()`：

```
$this->form_validation->set_rules('password', 'Password', 'required|md5|trim'); 
```

验证这一点的一种方法是将其内容转储到显示器上。例如..

```
var_dump( $this->input->post('password') ); 
```

如果密码看起来仍然是纯文本；然后 set_rules 没有在变量上运行 md5() ，这将需要一些故障排除。

为了将来参考，一般认证系统会将用户详细信息保存在数据库中；包括密码和用户名的散列版本。PHP 应用程序将启动一个 SQL 命令，例如`SELECT password FROM users WHERE USERNAME=username`；**如果没有返回行，则用户名不正确**。

然后通过散列方法运行用户输入 - 这与从数据库中检索到的值进行比较。*如果这些不匹配，则密码错误*。

但是，您似乎在数据库查询中同时发送了密码和用户名；虽然这会起作用 - 您将无法确定是错误的用户名还是错误的密码导致了身份验证问题。

出于这样的原因，通常最好...

### 尝试并使用身份验证框架

有被击落的危险；不要尝试为生产项目编写自己的身份验证代码。只需稍稍疏忽一下，您就可能危及整个应用程序、用户数据等。

那里有一些非常好的*久经考验*的身份验证框架——我最喜欢的是[ion auth](http://benedmunds.com/ion_auth/)，因为它很简单。但是，您可能会找到更喜欢的其他人。

### 不要只*加密*密码；散列它们。

这听起来像是细微的差别；但它实际上非常重要。在您的数据库被破坏的情况下（虽然它很粗鲁！） - 对您的密码进行哈希处理可以提供更好的安全性。特别是当涉及到彩虹表之类的攻击时。

同样，不要使用`md5()`- PHP 具有[`crypt()`](http://php.net/manual/en/function.crypt.php)尝试使用更安全算法的功能 -*如果它在系统上可用*。此外，它接受第二个参数（这是可选的，但应该使用） - *salt*。

值得记住的是[`set_rules()`](http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html)可以使用`crypt()`；至少以最简单的形式（有一个论点）。从文档中：

> 任何接受一个参数的原生 PHP 函数都可以作为规则使用，如 htmlspecialchars、trim、MD5 等。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-29T21:56:01.060

根据您用于存储密码的散列，您的模型配置将是这样的：

```
$this->db->select('*')->from('membership');
$this->db->where('username', $username);
$this->db->where('password', MD5($password)); 
```

此外，您的模型中存在用于检查用户是否有效的错误。如果从 DB 返回的行数为 1，则用户有效，否则无效。

```
if ($query->num_rows == 1)
    {
        return true;
    }

else
{
    $this->form_validation->set_message('validateUser', 'Invalid username/password');
    return false;
} 
```

# java - 如何在 Java 中定义嵌套类对象的数组列表？

> ID：14086181
> 
> 赞同：2
> 
> 时间：2012-12-29T21:42:43.103
> 
> 标签：java, nested-class

我有以下类定义：

```
public class kdtrees{
 ...
  public static class DataPoints{
  ... 
  }

} 
```

我可以使用以下方法创建内部类的对象：

```
kdtrees.DataPoint point = new kdtrees.DataPoint(); 
```

我想做`point`一个`ArrayList`，这样我就可以实例化内部类的多个对象。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T21:46:51.960

```
List<kdtrees.DataPoint> list = new ArrayList<kdtrees.DataPoint>();
list.add(new kdtrees.DataPoint()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:46:36.967

```
List<kdtrees.DataPoint> list = new ArrayList<kdtrees.DataPoint>();
points.add(new kdtrees.DataPoint()); 
```

不明白你的问题，抱歉。

# asp.net - 更改标签文本的 Asp.net 验证错误消息

> ID：14086183
> 
> 赞同：3
> 
> 时间：2012-12-29T21:43:00.193
> 
> 标签：asp.net, validation, webforms

我正在使用 asp.net 验证控件来验证用户输入。我想要的是使用验证控件生成的错误消息来更改标签文本。

```
<asp:Label ID="Label1" runat="server" Text="Whats your name"></asp:Label>
<asp:TextBox ID="nameB" Width="322px" Height="30px" runat="server"></asp:TextBox>

<asp:RequiredFieldValidator ID="RequiredFieldValidator1" ValidationGroup="business" runat="server" ErrorMessage="Please tell us your name." ControlToValidate="nameBuisness" CssClass="errMsg" Display="Dynamic"></asp:RequiredFieldValidator> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:08:34.477

一种方法是处理提交按钮的`OnClientClick`-event 并调用 javascript 函数，例如：

```
<script type="text/javascript">
    function displayValidationResult() {
        // Do nothing if client validation is not available
        if (typeof (Page_Validators) == "undefined") return;
        var LblName = document.getElementById('LblName');
        var RequiredName = document.getElementById('RequiredName');
        ValidatorValidate(RequiredName);
        if (!RequiredName.isvalid) {
            LblName.innerText = RequiredName.errormessage;
        }
    }
</script>

<asp:Label ID="LblName" runat="server" Text="Whats your name"></asp:Label>
<asp:TextBox ID="TxtNameBusiness" Width="322px" Height="30px" runat="server"></asp:TextBox>
<asp:RequiredFieldValidator ID="RequiredName" ValidationGroup="business"
    runat="server" ErrorMessage="Please tell us your name." ControlToValidate="TxtNameBusiness"
    CssClass="errMsg" Display="None"></asp:RequiredFieldValidator>
<asp:Button ID="BtnSumbit" runat="server"  Text="Submit"
    OnClientClick="displayValidationResult()" ValidationGroup="business" /> 
```

我使用了一些可用的 ASP.NET 客户端验证方法。我还将您的控件重命名为更有意义，并添加了一个提交按钮。

[**ASP.NET 深度验证**](http://msdn.microsoft.com/en-us/library/aa479045.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:23:33.560

如果您的要求是要使用内置的 ASP.Net 验证控件进行此验证，那么您将需要使用 ASP.Net CustomValidator 控件。这不能使用 ASP.Net RequiredFieldValidator 控件来完成。要执行您指定的验证，请在您的页面上放置一个 CustomValidator 控件，以便标记如下所示：

```
<asp:Label ID="Label1" runat="server" Text="Whats your name"></asp:Label>

<asp:TextBox ID="nameB" Width="322px" Height="30px" runat="server"></asp:TextBox>

<asp:CustomValidator ID="CustValidator" runat="server" ControlToValidate="nameB" 
    ValidateEmptyText="true"  ErrorMessage="Please tell us your name."  
    onservervalidate="CustValidator_ServerValidate" Display="none"  >**</asp:CustomValidator>

<asp:Button ID="btnSubmit" runat="server" Text="Submit" onclick="btnSubmit_Click"  CausesValidation="true"  /> 
```

然后，您需要编写自定义验证器。服务器端验证代码如下所示：

```
 protected void CustValidator_ServerValidate(object source, ServerValidateEventArgs args)
    {
        if (string.IsNullOrWhiteSpace(args.Value))
        {
            Label1.Text = CustValidator.ErrorMessage;
            args.IsValid = false;
        }
        else
        {
            Label1.Text = "Whats your name";
            args.IsValid = true;
        }
    } 
```

此自定义验证器将为您提供所需的行为。

通常，当您使用 CustomValidator 控件时，您应该同时进行服务器端验证（为了安全）和客户端验证（为了更好的 UI 体验）。要获得客户端验证，您需要在 javascript 和/或 jQuery 中编写一个客户端函数来进行类似的验证，然后将其分配给自定义验证器的 ClientValidationFunction。

可以在[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)中找到有关 CustomValidator 控件的更多信息。

# c# - IronPython“预期 X，得到 X”

ID：14086186

赞同：2

时间：2012-12-29T21:43:19.633

标签：c#, python, ironpython

# c# - 如何向 UserControl 添加一些属性？

> ID：14086192
> 
> 赞同：1
> 
> 时间：2012-12-29T21:44:00.420
> 
> 标签：c#

我有一个列表框的这个用户控件：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Lightnings_Extractor
{
    public partial class ListBoxControl : UserControl
    {

        private List<int> m_itemIndexes = new List<int>();

        public ListBoxControl()
        {
            InitializeComponent();

            this.listBox1.SelectedIndex = 0;
        }

        private void listBox1_MouseDown(object sender, MouseEventArgs e)
        {
            int index = listBox1.IndexFromPoint(e.X, e.Y);
            listBox1.SelectedIndex = index;

            if (e.Button == System.Windows.Forms.MouseButtons.Right)
            {
                if (m_itemIndexes.Contains(index))
                    return;

                m_itemIndexes.Add(index);
                DrawItem(index);
            }
            else if (e.Button == MouseButtons.Left)
            {
                if (!m_itemIndexes.Contains(index))
                    return;

                m_itemIndexes.Remove(index);
                DrawItem(index);
            }
        }

        private void listBox1_DrawItem(object sender, DrawItemEventArgs e)
        {
            bool coloring = m_itemIndexes.Contains(e.Index);
            bool selected = (e.State & DrawItemState.Selected) == DrawItemState.Selected;

            if (coloring)
            {
                using (var brush = new SolidBrush(Color.Red))
                {
                    e.Graphics.FillRectangle(brush, e.Bounds);
                }
            }
            else
            {
                e.DrawBackground();
            }

            string item = listBox1.Items[e.Index].ToString();
            e.Graphics.DrawString(item, e.Font, selected || coloring ? Brushes.White : Brushes.Black, e.Bounds, StringFormat.GenericDefault);

            if (selected)
                e.DrawFocusRectangle();
        }

        private void DrawItem(int index)
        {
            Rectangle rectItem = listBox1.GetItemRectangle(index);
            listBox1.Invalidate(rectItem);
        }
    }
} 
```

例如这一行：

```
using (var brush = new SolidBrush(Color.Red)) 
```

现在它设置为红色。但我希望用户能够在他的代码或其他形式或类中的任何位置将其更改为任何颜色。而且不仅在这个 UserControl 代码中。

我怎样才能添加这样的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:57:12.597

只需像往常一样声明一个属性：

```
[Browsable(true)] //so it appears in object explorer
public Color MyListColor
{
  get { return m_MyListColor;}
  set 
  {
    m_MyListColor = value;
    Refresh();//or Update
  }
} 
```

将属性设置为新值后，它会调用 Refresh() 来重新绘制控件，包括您的画笔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:53:05.467

只需添加一个新属性。

```
public Brush Fill {get;set;} 
```

# php - jQuery + Gravity Forms：在错误验证时执行 jQuery

> ID：14086195
> 
> 赞同：4
> 
> 时间：2012-12-29T21:44:16.537
> 
> 标签：php, jquery, ajax, wordpress, plugins

我在当前的重力形式上使用了一些 jQuery。但是，当我提交表单并返回错误的验证时，我丢失了一些 jQuery 目标。

我很好奇`$(document).ready(function() {`，一旦字段被错误的验证重新加载，我怎么能换掉一些会调用我的 jQuery 的东西。

不过我试过`$("#gform_submit_button_1").click(function() {`了，太早了。它需要在新字段从 ajax 返回时发生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-01T16:11:28.543

这里实际上提供了一个钩子供使用：`gform_post_render`

每次呈现表单时都会触发此 jQuery 钩子，以允许执行自定义 jQuery。这包括初始表单加载、转到多页表单的下一页/上一页、呈现验证错误的表单、显示的确认消息等。

```
jQuery(document).bind('gform_post_render', function(){

    // code to trigger on AJAX form render

}); 
```

[http://www.gravityhelp.com/documentation/gravity-forms/extending-gravity-forms/hooks/javascript/gform_post_render/](http://www.gravityhelp.com/documentation/gravity-forms/extending-gravity-forms/hooks/javascript/gform_post_render/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-08T11:27:07.553

出于某种原因，Gravity Forms 仍然没有为失败的表单验证添加 jQuery 挂钩。他们建议做的是检查`div.validation_error`.

```
jQuery(document).on('gform_post_render', function(e, form_id) {
    if ( jQuery('div.validation_error').length > 0 ) {
        console.log('Form validation error.');
    }
}); 
```

当我检查验证错误元素时，您会注意到我没有指定父级：`jQuery('div.validation_error')`. 如果页面上有多个表单，这将导致问题。返回的`form_id`参数包含数据库中表单的 ID（例如 1、2、35 等），但我不确定此值是否与 HTML 中的表单 ID 匹配，例如`<form id="gform_1">`. 如果确实匹配，那么最好指定父级，因此您可以这样做：

```
if ( jQuery('div.validation_error', '#gform_' + form_id).length > 0 ) { 
```

也许其他人可以参与并让我们知道表单的 HTML ID 是否始终与表单的数据库 ID 匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-01T16:03:27.970

重力形式确实提供了一个`gform_confirmation_loaded`钩子，但我认为这不适用于您的情况，因为它不是加载确认，而是加载错误状态表单。他们对此没有钩子，但我已经成功使用 jquery 委托事件。我将`.gform_wrapper`用作我的第一个选择器，然后定位我想要实际定位的字段。

有关更多信息，请参阅此文档：

*   [http://api.jquery.com/on/#direct-and-delegated-events](http://api.jquery.com/on/#direct-and-delegated-events)
*   [http://www.gravityhelp.com/documentation/gravity-forms/extending-gravity-forms/hooks/filters/gform_confirmation_loaded/](http://www.gravityhelp.com/documentation/gravity-forms/extending-gravity-forms/hooks/filters/gform_confirmation_loaded/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-17T17:44:58.723

一种解决方案是：捕获提交事件并启动一个间隔来检查您的表单是否有更改，然后调用您的函数：

```
$('#your-form').submit(function(){
    html = $('#your-form').html();
    iv = setInterval(function(){
        If($('#your-form').html != html){
            yourfunc();
            clearInterval(iv);
        }
    }, 200);
});

function yourfunc(){
    //your stuff   
} 
```

然而，这不是很整洁，只有在 Ajax 调用之后实际更改了 html 时才会起作用。

# image - NGLN 的图像网格

> ID：14086197
> 
> 赞同：1
> 
> 时间：2012-12-29T21:44:30.270
> 
> 标签：image, gridview, dynamic, delphi-7, imagelist

我找到了这个很棒的组件并安装了它，它运行得很好，但我有一个小问题。不幸的是，我自己不知道该怎么做。

有人可以帮我为这个组件添加一个新功能吗？那将允许它从 ImageList 获取图像吗？我会在执行期间动态填充 ImageList。

现在我正在执行以下操作以显示 TILE 的预览：

```
procedure TTools.Preview_ImageExecute(Sender: TObject);
var image_temp : TBitmap;
begin
  image_temp := TBitmap.Create;
  LoadBitMap(ComboBox1.Text,image_temp,Main.ASDb1);
  Image1.Picture.Bitmap:=image_temp;
  image_temp.Free;
end; 
```

想以某种方式将其与图像网格一起使用...它应该以某种方式允许我加载所有图块..我会使用 For 循环来填充它...

与此同时，我正在玩 ListBox，并设法做到了这一点：

```
procedure TTools.Lst1DrawItem(Control: TWinControl; Index: Integer;
Rect: TRect; State: TOwnerDrawState);
var CenterText : integer;
begin
Lst1.Canvas.FillRect(Rect);
Il1.Draw(lst1.Canvas,rect.Left +4, rect.Top +4, Index);
Centertext := (rect.Bottom - rect.Top -lst1.Canvas.TextHeight(text)) div 2;
Lst1.Canvas.TextOut(rect.left + il1.width + 8, rect.Top + CenterText, lst1.Items.Strings[index]);
end;

procedure TTools.Lst1MeasureItem(Control: TWinControl; Index: Integer;
var Height: Integer);
begin
Height := IL1.Height+4;
end;

procedure TTools.Button4Click(Sender: TObject);
var i : integer;
image_temp : TBitmap;
begin
image_temp := TBitmap.Create;

for i:=0 to Main.Images.Count-1 do
  begin
  Lst1.Items.Add(Main.Images.Item[i].Name);
  LoadBitMap(Main.Images.Item[i].Name,image_temp,Main.ASDb1);
  IL1.AddMasked(image_temp, clNone);
end;

Image_temp.Free;
end; 
```

这可行，如果我有 0 列，但我不能让它与 4 列一起工作，有人可以帮忙吗？

问候罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T11:20:15.090

没关系......我这样解决了：

```
procedure TTools.Button4Click(Sender: TObject);
var i : integer;
image_temp : TBitmap;
begin
image_temp := TBitmap.Create;

for i:=0 to Main.Images.Count-1 do
begin
  LoadBitMap(Main.Images.Item[i].Name,image_temp,Main.ASDb1);
  ListView1.Items.Add.Caption:=Main.Images.Item[i].Name;
  ListView1.Items.Item[i].ImageIndex:=i;
  IL1.AddMasked(image_temp, clNone);
end;

Image_temp.Free;
end; 
```

此负载是图像名称以及我的 Asphyre 图像列表中的图像......

# bundle - 在虚拟路径提供程序下捆绑的解决方法

> ID：14086212
> 
> 赞同：2
> 
> 时间：2012-12-29T21:47:29.477
> 
> 标签：bundle, asp.net-optimization, virtualpathprovider

我发现在 ASP.NET MVC 4 下，如果它们的虚拟路径由`VirtualPathProvider`. 我的意思是，如果目录“~/Static/”被映射到一个 VPP，你就不能`Include("~/Static/Stylesheets/themes/dark-blue.css")`，因为它会简单地默默地失败。

从[这里](http://codebetter.com/howarddierking/2012/08/03/whats-next-for-asp-net-web-optimization/?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20CodeBetter%20%28CodeBetter.Com%29)到[这里](http://forums.asp.net/t/1829466.aspx/1?Bundling%20and%20VirtualPathProvider)，看起来这是运行时的默认行为，因为它基本上解析文件系统上的虚拟路径，而不是使用 ASP.NET 管道。而且，幸运的是，它将在下一个 MVC 中实现。

无论如何，由于这看起来是一个常见问题，并且由于我要将静态资源存储在项目之外（最终在 Azure 的 CDN 上，但我仍然需要开发和调试），有没有人找到让 ASP.NET Web 的解决方法在他们的虚拟路径中优化搜索资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T18:44:03.337

VirtualPathProvider 支持在 1.1-alpha1 版本的优化中，你试过那个版本吗？它应该支持通过您的 VPP 解析文件。

# ios - 选项卡、视图控制器和 iOS

> ID：14086213
> 
> 赞同：0
> 
> 时间：2012-12-29T21:47:35.563
> 
> 标签：ios, uitableview, uiviewcontroller, tabs

我正在尝试创建一个 iOS 应用程序，并且我想制作一个“基于标签的应用程序”。在其中一个选项卡中，我需要插入一个照片库（我已经使用 ViewController 创建了一个）。是否可以将 ViewController 合并到选项卡项之一中？我希望你能理解我，我不是专业程序员，英语不是我的母语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:14:55.510

If you've already created your view controller with the photo gallery, all you need to do is select the controller, go to the Editor menu, and choose "Embed In", then "Tab Bar Controller".

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:02:32.067

[在这里](http://www.appcoda.com/storyboard-tutorial-create-tab-bar-controller-and-web-view/)，您可以看到选项卡式应用程序的分步教程。另外我强烈推荐观看“为 iOS 开发”[斯坦福课程](https://itunes.apple.com/us/itunes-u/developing-apps-for-ios-sd/id395631522)，他们也有标签式应用程序的详细示例。

# c# - 获取不同类型输入的函数？

> ID：14086214
> 
> 赞同：0
> 
> 时间：2012-12-29T21:47:38.887
> 
> 标签：c#, types, parameters

我`BigInt`在 C# 中有一个类，它具有如下功能

```
public BigInt Multiply(BigInt Other)
public BigInt Exponentiate(BigInt Other) 
```

等等，BigInt 可以用字符串或整数构造，可以有多个构造函数。但是当我想用int（而不是BigInt）调用这些算术函数时

```
this.Multiply(int a); 
```

我必须使用输入 int 重新定义相同的乘法函数，例如

```
public BigInt Multiply(int other)
{
BigInt Other = new BigInt(other);
//rest of the code same
} 
```

那么我怎样才能在一段代码中处理这个呢？我认为默认参数将只允许其中之一（例如，仅 BigInt 但不允许 int，反之亦然）。

提前致谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T21:51:46.547

创建从`int`to的隐式转换`BigInt`

```
public static implicit operator BigInt(int value)
{
    return new BigInt(value);
} 
```

那么你只需要一个带`BigInt`参数的重载：

```
BigInt bigInt = ...
BigInt mult = bigInt.Multiply(5); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:53:50.547

仅根据 BigInt 实现每个 int 重载怎么样？：

```
public BigInt Multiply(int a)
{
    return Multiply(new BigInt(a));
} 
```

# ios - ios 任何 UIView 属性都允许我在视图下方设置按钮处于活动状态吗？

> ID：14086219
> 
> 赞同：0
> 
> 时间：2012-12-29T21:48:21.647
> 
> 标签：ios, uiview, properties

出于评价、iAd 和设计的原因，我不想使用模式视图来呈现消息（也不是通过警报视图）。我计划调出一个屏幕大小的标签并在那里显示消息。这是可以做到的。但是，大标签下方有一堆按钮（ABCD 等），这些按钮以不同的状态记录，并且它们是可点击的。理想情况下，用户会阅读标签并通过指定的按钮 (X) 禁用它。然而，用户可以点击他们想要的任何地方，而且他们经常会点击大标签下方的那些按钮并搞砸事情。当大标签出现时，只有 X 是可见的，而 ABCD 等是不可见的。现在我的问题是我可以设置任何 UIView 属性或任何属性，以便不可见的按钮不起作用，尽管它们可能已启用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:58:53.830

您可以将`alpha`按钮上的属性设置为 0。这将产生 2 个效果：

1）使按钮不可见

2）让他们忽略用户输入

当您需要重新启用按钮时，只需再次将其 alpha 设置为 1。

# linux - 没有过剩的OpenGL着色器？

> ID：14086234
> 
> 赞同：0
> 
> 时间：2012-12-29T21:50:56.257
> 
> 标签：linux, opengl, shader, glut

我无法在不是由 glut 创建的 OpenGL 上下文中使用 GLTools 库存着色器。

我正在从 Superbible 第 5 版学习 OpenGL。提供的`GLShaderManager`和`gltMakeCube`（来自 GLTools）允许我`GLBatch::Draw()`使用 Superbible 中的以下代码在 glut 创建的窗口中渲染一些立方体（）：

```
gltSetWorkingDirectory(values[0]);

glutInit(&count, values);
glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
glutInitWindowSize(1200, 400);

glutCreateWindow("Test"); 
```

我正在尝试从该程序中删除过剩代码，按照此处的示例[http://www.opengl.org/wiki/Programming_OpenGL_in_Linux:_Programming_Animations_with_GLX_and_Xlib](http://www.opengl.org/wiki/Programming_OpenGL_in_Linux:_Programming_Animations_with_GLX_and_Xlib)创建一个窗口并为其附加上下文。（我正在运行 Ubuntu）

我设法创建了一个窗口和一个上下文，并成功调用 glClearColor 来更改窗口的背景颜色。但是，我的立方体不再被绘制。上面链接的示例程序可以正常工作，但它似乎没有使用着色器，而是依赖于调用`glColor3f`和`glVertex3f`构建立方体。

为什么我使用 GLTools 的股票着色器进行渲染的技术不能在不是由 glut 创建的窗口/上下文中工作？

# python - 无限while循环

> ID：14086238
> 
> 赞同：1
> 
> 时间：2012-12-29T21:51:08.417
> 
> 标签：python

为什么当输入正确的输入（0到100之间的数字）时这个while循环没有结束

```
grade = 110
invalid_input = 1
while grade< 0 or grade> 100:
    if invalid_input >=2:
        print "This is an invalid entry"
        print "Please enter a number between 0 and 100"
    grade= raw_input("Please enter your marks for Maths : ")
    invalid_input +=1 
```

我输入的是数字还是文本（这是一个无效条目，请输入一个介于 0 和 100 之间的数字，有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T21:57:48.900

你`grade`应该被强制转换为 int。否则，由于它是一个字符串，因此`while`条件将始终保持满足。

此外，您可以同样轻松（也许更干净）使用布尔值`invalid_input`：

```
invalid_input = True
while invalid_input:
    grade = int(raw_input("enter data"))
    if grade >= 0 and grade <= 100:
        invalid_input = False
    else:
        print "Please try again" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:53:13.747

in `grade=raw_input("Please enter your marks for Maths : ")`,`grade`是一个字符串，而不是数字。尝试

```
grade = int(raw_input("Please enter your marks for Maths : ")) 
```

如果用户输入错误，为了防止程序被终止，你需要使用[异常](http://docs.python.org/2/tutorial/errors.html#exceptions)，像这样

```
grade = 110
invalid_input = 1
while grade< 0 or grade> 100:
    if invalid_input >=2:
        print "This is an invalid entry"
        print "Please enter a number between 0 and 100"
    try:
      grade= int(raw_input("Please enter your marks for Maths : "))
    except ValueError:
      grade = -1  # just to enter another iteration
    invalid_input +=1 
```

# ruby-on-rails - 错误：重定向太多

> ID：14086244
> 
> 赞同：2
> 
> 时间：2012-12-29T21:51:55.597
> 
> 标签：ruby-on-rails

我正在使用`devise`并尝试以下以下内容：

```
class ApplicationController < ActionController::Base
   protect_from_forgery
   before_filter :is_worker

   def is_worker
     if user_signed_in?
        @email = current_user.email
        if @email && Worker.find_by_email(@email).nil?
          redirect_to '/tasksadmins'
        else
           redirect_to '/workers'
        end
     else
         redirect_to '/users/sign_in'
     end
   end
end 
```

当我尝试进入站点时：`localhost:3000/tasksadmins`，我得到：

```
Oops! It was not possible to show this website

The website at http://localhost:3000/tasksadmins seems to be unavailable. The precise error was:

Too many redirects

It could be temporarily switched off or moved to a new address. Don't forget to check that your internet connection is working correctly. 
```

请问我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T22:03:02.670

`before_filter`应用于每个请求。这就是为什么它一次又一次地重定向。

您可能只想过滤特定操作：

```
before_filter :is_worker, only: :index 
```

另一种解决方案是检查是否需要重定向`#is_worker`：

```
redirect_to '/workers' unless request.fullpath == '/workers' 
```

**编辑：**

另一种方法是为重定向的目标操作跳过 before 过滤器。例子：

```
class WorkersController < ApplicationController

  skip_before_filter :is_worker, only: :index

  # …

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-29T11:53:51.737

就我而言：

**users_controller.rb**

```
 before_action :logged_in?, only: :new

  def new
    @user = User.new
    render layout: "session"
  end 
```

和

**application_controller.rb**

```
def logged_in?
    redirect_to users_new_url unless current_user.present?
end 
```

当我尝试重定向到“用户/新”页面时，发生了同样的错误。这只是因为我试图重定向到*“用户/新”*页面和**“def logged_in？”** 也重定向到同一页面。

然后我像这样更改了**application_controller.rb**代码：

```
def logged_in?
    redirect_to root_url unless current_user.blank?
end 
```

**错误_已解决。**

# r - 限制 R 中的时间样本

> ID：14086247
> 
> 赞同：0
> 
> 时间：2012-12-29T21:52:41.580
> 
> 标签：r, zoo

我正在尝试绘制我已加载到 R 中的一些数据的图表。但我只想要一个从一个特定时间段到另一个特定时间段的图表。如何限制特定时间段的数据样本，例如从*09/20/2010*到*09/23/2010*。

如果我在 R 中使用*“xts”*包，我认为可以简单说明：

```
plot(dat$weight['2010-09-20/2010-09-23']) 
```

但是这种格式不适用于 zoo 包。任何人都可以帮忙吗？

```
library(zoo)    
dat=read.zoo("filelocation",header=T,colClasses=c("Date","numeric"))

  date   weight
2010-10-04 52495    
2010-10-01 53000    
2010-09-30 52916    
2010-09-29 52785    
2010-09-28 53348    
2010-09-27 52885    
2010-09-24 52174    
2010-09-23 51461    
2010-09-22 51286    
2010-09-21 50968    
2010-09-20 49250 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:02:24.437

```
dat[index(dat) >= "2010-09-20" & index(dat) <= "2010-09-23"]

2010-09-20 2010-09-21 2010-09-22 2010-09-23 
     49250      50968      51286      51461 
```

# javascript - Jquery“slideToggle()”函数在 Adob e Dreamweaver 中工作正常，但在浏览器上不起作用

> ID：14086256
> 
> 赞同：0
> 
> 时间：2012-12-29T21:53:23.187
> 
> 标签：javascript, jquery, html, css

我在我的 html 页面中使用了一个 jquery“slideToggle”函数，只要我在我的网页上单击一个名为“Planning”的标题，它就会下拉一个子列表。虽然这在 Adob​​e Dreamweaver 设计模式下完全符合我的要求，但在浏览器中打开时不起作用。这是我的完整代码：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
    <html>
    <head>
    <script src="jquery-1.8.3.min.js">
    </script>
    <script> 
    $(document).ready(function(){
      $("#planning").click(function(){
        $("#planning_panel").slideToggle("fast");
      });
    });
    </script>
    <title>Ecommerce Information</title>
    <style type="text/css">
    <!--
    a:link {color:#03F; text-decoration:none; text-emphasis:none;         font-size:12px}            /* unvisited link */
    a:visited {color:#03F; text-decoration:none} /* visited link */
    a:hover {color:#F30; text-decoration:none; font-size:14px}   /* mouse over link */

    .style2 {font-size: 13px;
        font-family:"Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;

    }
    .style4 {
        font-size: 18px;
        font-weight: bold;
        color: #FF6600;
    }
    .style6 {color: #000000}
    .style7 {font-size: 8px;
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
    }
    .style23 {font-size: 14px;
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
    }
    .style45 {
         background-color:#E8E8E8;
    }
    .style44 {
        background-image:url('gray_jean.jpg');
    }
    #planning_panel
    {

    display:none;
    }
    -->
    </style>
    </head>

    <body>
    <div align="center">
      <a href="../index.html">
      <img border="0" src="banner1.jpg" width="800" height="120" alt="Ecommerce Knowledge Base"></a>
      <div style="background-image:url(Heading%20Background.jpg); width:800px">
      <a href="../index.html" style="position:relative; left:-130px">HOME</a>
      <a href="" style="position:relative; left:-65px" id="planning">PLANNING</a>
      <a href="" style="position:relative; left:0px" id="design">DESIGN & HOSTING</a>
      <a href="" style="position:relative; left:65px" id="marketing">MARKETING</a>
      <a href="" style="position:relative; left:130px" id="technology">TECHNOLOGY</a>
      </div>
      <table width="800" border="0" cellspacing="0" cellpadding="5" class="style44">
      <tr><td><div id="planning_panel" style="position:absolute; left:295px;top:150px; background-color:#999; padding:5px;">
       <a href="../Planning/what-is-electronic-data-interchange.html">Electronic-Data-        Interchange</a><br>
       <a href="../Planning/web-site-analysis----a-study-in-damag.html">Web Site Analysis</a><br>
       <a href="../Planning/web-ecommerce--where-to-begin.html">Web Ecommerce</a><br>
       <a href="../Planning/streamline-your-website-pages.html">Streamline Web Pages</a><br>
       <a href="../Planning/set-up-your-own-blog-free.html">Setting Up Blog</a><br>
       <a href="../Planning/online-backup--the-simple-value.html">Online Backup</a><br>
       <a href="../Planning/introduction-to-ecommerce.html">Introduction To Ecommerce</a><br>
       <a href="../Planning/building-ecommerce-web-sites--where-d.html">Build eCommerce Sites</a><br>
       <a href="../Planning/banned-by-google-and-back-again..html">Banned by Google</a><br>
       <a href="../Planning/are-drop-ship-directories-really-wort.html">Know Drop Ship Directories</a><br>
       </div></td></tr>
        <tr>
          <td>

            <div align="center">   
          &nbsp;</div></td>
        </tr>
        <tr>
          <td width="514" valign="top"><div align="left">
              <table width="99%" height="114">
                <tr>
                  <td align="left" height="22"><div align="justify"><span class="style7">
                    <font color="navy" size="1" face="Tahoma"><h1 align="center">5 Minute Guide to Video Editing for Beginners</h1><br>
                      </font></span></div></td>
                </tr>
                <tr >
                  <td align="left" height="12"><span class="style2"><span>My text</span><hr size=-1>
      <br>
      </span></td>
                </tr>
                </table>
            </div>        <p align="left">&nbsp;        </p>
          </td>
        </tr>
      </table>

      </div>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:15:51.517

I do not know if I understand your question correctly. you dont have an href attribute set to the menu "Planing" (not sure if it is on purpose). If you wish to do is just open and close the panel (without going to a link) then this change to your code should help.

```
 $(document).ready(function(){
      $("#planning").click(function(e){
        $("#planning_panel").slideToggle("fast");
          e.preventDefault(); // prevent default behaviour
      });
    });​ 
```

# php - PHP 语句解释

> ID：14086259
> 
> 赞同：5
> 
> 时间：2012-12-29T21:53:36.207
> 
> 标签：php

[我在这里](https://stackoverflow.com/questions/11953931/simple-pdo-wrapper-not-working?rq=1)读到了一篇文章，该人写了如下声明：

```
 $this->_connection = require_once 'config.php';

   // $this->connection is an array variable. 
```

我觉得有点难以理解。我问自己如何将包含的文件分配给变量。

这是否意味着必须从“config.php”文件中返回一个数组？我的意思是“config.php”应该返回一个数组吗？

这种说法在商业 php 应用程序中好吗？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T21:55:08.737

包含的文件可能有`return`任何函数之外的语句。如果发生这种情况，脚本将停止运行包含的文件，`require_once`调用的“返回值”就是`return`语句的值。

[文档](http://php.net/return)

# mongoose - Mongoosejs：排除包含数组的字段仍返回空白字段

> ID：14086261
> 
> 赞同：0
> 
> 时间：2012-12-29T21:53:53.590
> 
> 标签：mongoose

这可能是猫鼬中的一个错误，或者我遗漏了一些东西。正如标题所说，我有一个包含数组的几个字段的模式：（下面的模式）

```
ThisSchema = var AssassinJobSchema = new Schema ({
    codename:   { type: String, index: { unique: true } },
    _cat:       [
                    { type: ObjectId, ref: 'KillingBidsCategory' }
                ],
    reqroute:   {
                    start: {
                        _id:    { type: ObjectId, ref: 'Location' },
                        name:   { type: String },
                        loc:    { type: [Number], index: '2d' }
                    },
                    end: {
                        _id:    { type: ObjectId, ref: 'Location' },
                        name:   { type: String },
                        loc:    { type: [Number], index: '2d' }
                    }
    targets:    [ PersonToAssasinate ],
    deadline:   {
                    hours:  { type: [Number], min: 0, max: 10800 }
                }

}); 
```

我知道如何从查询中排除字段，或包含某些字段。但是，我注意到的是，如果我排除了具有数组的字段之一，即`ThisSchema.statics.find({'_id': x},'-reqroute -deadline',cb)`，我仍然会在结果中得到这些字段，只是它们现在是空白的。

是不是我做错了什么？

**解决方法 1**

选择要返回的字段是一种解决方案，但对于具有大量字段的文档，仅包含 9 个字段以排除一个字段会变得很麻烦。

**解决方法 2**

如果我想排除 reqroute 和截止日期，我可以`delete`从返回的对象中排除它们，但这也需要更多的工作，特别是对于 Javascript 初学者来说有时要掌握。

**概括**

我在排除方面做错了什么，还是 Mongoose 如何处理带有数组的字段的错误？如果是后者，我将提交一个错误并研究其解决方案。谢谢

# php - 如何使用添加的 GET 变量从 URL 正确设置 $_GET 变量

> ID：14086263
> 
> 赞同：0
> 
> 时间：2012-12-29T21:54:30.693
> 
> 标签：php, url, variables, get

如果我要设置一个

```
if(isset($_GET['var']))
{
 //stuff with only 1 variable
} 
```

如果我的网址类似于

```
http://www.url.com/test.php?var=something&var2=somethingelse 
```

所以当这个 url 有 2 个 get 变量时，它不应该显示 isset($_GET['var']) 中的代码块。相反，它应该显示此块中的代码

```
if(isset($_GET['var']) && isset($_GET['var2']))
{
 // block of codes with 2 variables
} 
```

但是，第一块代码也将被显示，因为没有什么可以告诉它不应该显示是否有其他变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:57:50.960

```
if(isset($_GET['var']) && count($_GET) == 1) {
    //stuff with only 1 variable
} 
```

但是，这样做是一个非常糟糕的主意。如果存在其他一些未知的 GET 变量，它会破坏您的站点。虽然这不太*可能，*但我不希望有任何网站能够摆脱它。

例如，广告服务器可能会自动添加一个以允许目标站点根据需要创建统计信息。

如果您知道预期哪些其他变量（应该是这种情况）更好地明确检查它们是否不存在：

```
if(isset($_GET['var']) && !isset($_GET['var2'])) {
    // do stuff
} 
```

# twitter-bootstrap - Visual Studio 2012 MCV4 问题中的 Twitter Bootstrap 和 Less

> ID：14086264
> 
> 赞同：1
> 
> 时间：2012-12-29T21:54:33.820
> 
> 标签：twitter-bootstrap

好吧，我想我疯了。我有一些 MVC4 VS 2010 项目都使用 Twitter Bootstrap/Less，我现在在 VS 2012 中使用没有问题。但是，每当我尝试创建一个新的 MVC4 互联网项目，并模仿我在其他 2010 项目中使用的 Bootstrap 设置时，它都不起作用！在 Chrome 控制台中，它显示：

![在此处输入图像描述](../Images/5303abf8e1348424415f7ab0b945e732.png)

两个文件都在那里，我星期六花了一半时间试图弄清楚 @#($@#*$ 发生了什么。这是我在 VS 2012 中的文件设置：

![在此处输入图像描述](../Images/86b62390063de0296d646ae6c8a4130a.png)

这是我的标题：

```
<link rel="stylesheet" href="/Content/themes/base/jquery-ui.css" type="text/css" media="all" />
<link rel="stylesheet/less" href="/Content/themes/Admin/less/bootstrap.less" type="text/css" />
<!-- SCRIPTS -->
<script type="text/javascript" src="/Content/themes/Admin/less-1.3.1.min.js"></script> 
<script src="@Url.Content("~/Content/themes/Admin/js/bootstrap.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>  
<script type="text/javascript" src="/Content/js/jquery.timepicker.min.js"></script> 
```

任何人都可以看到任何明显的错误吗？我已经尝试了一大堆不同的组合，但我现在尽量保持简单。谢谢你的时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T19:55:31.313

您是否缺少 .less 的 MIME 类型？

尝试将以下内容添加到`system.webServer`web.config 的部分。

```
<staticContent>
    <mimeMap fileExtension=".less" mimeType="text/css" />
</staticContent> 
```

或者[在 IIS 中添加 MIME 类型](http://technet.microsoft.com/en-us/library/cc725608%28v=ws.10%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:13:58.867

好吧，为了节省时间，我决定继续通过 WinLess 预编译我的 .less 文件。让 LESS javascript 文件在 dev 中工作有助于加快速度，但是哦

# hash - 我们对哈希的目的

> ID：14086266
> 
> 赞同：1
> 
> 时间：2012-12-29T21:54:44.883
> 
> 标签：hash

使用散列函数时，我们的目的不是随机性吗？那么为什么我们不使用`rand()`函数而不是对元素（如`hashVal = 37*hashVal + key[i]`）进行操作呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:07:43.933

> 使用散列函数时，我们的目的不是随机性吗？

不。从技术上讲，我们使用散列函数的目的是将一个称为键的大型数据集映射到一组称为散列的值。散列函数可能不是*唯一的*，即多个键可能映射到同一个散列。但是，它必须*始终*将特定键映射到相同的散列。

例如，如果 hash("Hello, world") = 5，那么无论您对字符串散列多少次，它都必须始终为 5。因此，以您建议的方式使用 rand() 是行不通的，因为它每次都会将相同的键映射到不同的哈希值。

然而，一个好的散列函数确实会尝试将其键映射到随机散列，*概率性*地。这与随机数不同。这意味着，平均而言，每个散列具有大致相等数量的预散列。然而，每个键*仍然*每次都映射到自己的散列。

thb 的回答也说明了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:56:51.020

哈希函数用于映射而不是随机数。所以我们不能在哈希使用的地方使用随机函数。哈希值在给定输入上始终是唯一的。
哈希函数的主要目标是加速查表或数据比较任务。

**区别：**

`key = hash(A valid input)`, 关键是确定性输出

`num = random(A valid input)`, num 是未确定的输出

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:04:36.950

好问题。这取决于*随机是什么意思。*

哈希将键映射到任意值——理想情况下映射到其中没有明显模式的值。例如：

```
'A' => 15
'B' => 97
'C' => 43
'D' => 60
'E' => 41 
```

但是，哈希总是将相同的键映射到相同的值。因此：

```
"BED"  => [97 41 60]
"BEDE" => [97 41 60 41] 
```

每次你给散列一个`'E'`，它总是把它散列为`41`，而不是另一个值。

**附加说明**

重要但次要于当前讨论的是散列不需要提供唯一值。例如，这是可能的：

```
'F' => 41 
```

因此，给定散列值`41`，不能说键是`'E'`还是`'F'`。

（所有这一切都自然地暗示了一个问题：“很好。但是哈希有什么*用？* ”然而，这将是另一个问题，而不是 OP 提出的问题。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T21:58:46.450

随机函数和散列函数之间有相似之处，它们都有一个确定的种子并返回一个值。

散列是根据对象的数据返回一个数字。所以是的，它通常会提供一个非常大的数字，但这个数字是基于对象本身的。

根据散列函数的不同，具有相同数据的相同对象将返回相同的值。正因为如此，就“随机性”而言，散列并不是返回唯一数字的理想选择。

# php - 如何遍历 $_POST 数组并将数据发送到不同的 MySQL 表

> ID：14086268
> 
> 赞同：1
> 
> 时间：2012-12-29T21:54:46.177
> 
> 标签：php, mysql

我有一个将通过 POST 发送数据的表单。我希望这些数据根据 POST“名称”转到不同的 MySQL 表。

到目前为止，我有一个表单字段的 while 循环，它将以以下格式命名每个输入：“name”{}$id。我认为使用 {} 作为分隔符然后我可以使用 explode() 并使用条件语句来选择数据应该转到哪个表。

这是最好的方法吗？我遇到的问题也是调用名称，因为例如在 POST 上使用 foreach 只会返回值而不是名称。我附上了下面的代码：

```
<?php while ($cred = mysql_fetch_array($credentials_process)) { ?>
    <div class="edit-profile-background-inputs">
        <span><input type="text" name="cred{}<?php echo $cred['id']; ?>" value="<?php echo $cred['credentials']; ?>" /></span>
        <span style="margin-left:10px;"><a href="<?php echo "background.php?cred=".$cred['id']; ?>">Remove</a></span>
    </div>
    <?php } ?> 
```

我需要那些名为 cred{} 的字段进入凭证表，那些名为 edu{} 的字段进入教育表，等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:01:34.793

```
<input type="text" name="cred[<?php echo $cred['id']; ?>]"...
<input type="text" name="edu[<?php echo $edu['id']; ?>]"... 
```

在 PHP 中

```
$insert=array();
foreach ($_POST['cred'] as $k=>$v)
{
    $insert[$k]=mysql_real_escape_string($v); // yes I know mysql is being depreciated
}

 $sql='INSERT INTO cred ('. implode(',', array_keys($insert)).') VALUES ('. implode(',', $insert).'); 
```

重复`$_POST['edu']`

如果您的结果集是这样的，您使用相同的键输出多于一行

```
$i=0;
while ($cred = mysql_fetch_array($credentials_process)) { ?>
    <input type="text" name="cred[$i][<?php echo $cred['id']; ?>]"...
    ...
    $i++;
} 
```

如果你`print_r($_POST)`从中你将能够弄清楚如何处理它们。

注意。为了安全起见，我还会确保只使用预期的发布变量

```
$allowed=array('cred_id', 'cred_something', 'etc');

foreach ($_POST['cred'] as $k=>$v){
    if (!in_array($k, $allowed)) continue; 
```

# prolog - Prolog 运算符优先级

> ID：14086271
> 
> 赞同：4
> 
> 时间：2012-12-29T21:55:28.347
> 
> 标签：prolog, operators, iso-prolog

用户输入的格式为 a:b>c>d>e... 等等。我想将输入解析为 :(a,>(b,>(c,>(d,e))) 这可能吗？有什么建议吗？我用这个进行了测试

```
prepare:-
    op(750,xfx,user:(:)), % change the default priority of : and >
    op(700,xfx,user:(>)),
    display(a: b > c),%this one worked fine and 
                      %the display value is :(a,>(b,c))
    display(a: b > c > d ). % I cannot have this works, 
                            %the error ERROR: 
                            %Syntax error: 
                            %Operator priority clash is thrown. 
```

无法修改输入。任何建议都值得赞赏。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:48:32.087

也许首先也是最重要的：两者`(:)/2`和`(>)/2`已经是标准中定义的中缀运算符，如下所示：

```
:- op(600, xfy, :). % ISO/IEC 13211-2 5.2.1, table 1
:- op(700, xfx, >). % ISO/IEC 13211-1 6.3.4.4, table 7 
```

改变它们的优先级意味着你改变了它们的共同含义。这通常不是一个好主意。想一想：这就像您将（能够）更改 Java、C#、C++、Perl 或 PHP 中运算符的优先级。他们都不敢改变从C那里继承的优先级。

但是，严格来说，你可以做到这一点。

为了尽量减少此类更改的不利影响，请尝试将声明保留在您自己的模块中。并且，在没有模块本地运算符的系统中，确保您将安全地恢复到原始声明。

你写`user:(>)`的会影响特殊的用户模块。相反，编写您自己的模块。

...或者可能重新考虑要更改的操作员。

一举将条款阅读到下一个时期。因此，如果您有如您所展示的规则，则运算符声明仅在`prepare`执行时才会生效。因此，它对目标的论证没有影响`display/1`。您可能已经`prepare`加载、执行和 ; 并重新加载它。

为了使操作符声明生效，要么直接在顶层执行它（这是一个快速的hack）；或将其作为指令写入文件或模块。

然后`>`-like 运算符，我将使用`:>`它的位置，需要像 the`:`和下面的优先级那样是右结合的`:`。您声明`xfx`这意味着没有关联性。

```
?- op(500,xfy,:>).
true.

?- write_canonical(a:b:>c:>d).
:(a,:>(b,:>(c,d)))
true. 
```

# ios - 以编程方式设置自定义图像大小和位置

> ID：14086274
> 
> 赞同：0
> 
> 时间：2012-12-29T21:55:43.143
> 
> 标签：ios, objective-c, cocoa-touch, dimension, activity-indicator

我正在尝试制作自定义活动指示器并将大小和位置设置为：（x 坐标 280；y 坐标 5；高度 34；宽度 34）我有代码：

```
UIImage *statusImage = [UIImage imageNamed:@"activity1.png"];
    UIImageView *activityImageView = [[UIImageView alloc]
                                      initWithImage:statusImage];

            activityImageView.animationImages = [NSArray arrayWithObjects:
                                         [UIImage imageNamed:@"activity1.png"],
                                         [UIImage imageNamed:@"activity2.png"],
                                         [UIImage imageNamed:@"activity3.png"],
                                         [UIImage imageNamed:@"activity4.png"],
                                         [UIImage imageNamed:@"activity5.png"],
                                         [UIImage imageNamed:@"activity6.png"],
                                         [UIImage imageNamed:@"activity7.png"],
                                         [UIImage imageNamed:@"activity8.png"],
                                         [UIImage imageNamed:@"activity9.png"],
                                         [UIImage imageNamed:@"activity10.png"],
                                         [UIImage imageNamed:@"activity11.png"],
                                         [UIImage imageNamed:@"activity12.png"],
                                         [UIImage imageNamed:@"activity13.png"],
                                         [UIImage imageNamed:@"activity14.png"],
                                         [UIImage imageNamed:@"activity15.png"],
                                         [UIImage imageNamed:@"activity16.png"],
                                         [UIImage imageNamed:@"activity17.png"],
                                         [UIImage imageNamed:@"activity18.png"],
                                         nil];

    activityImageView.animationDuration = 0.8;

    [activityImageView startAnimating];

    [self.view addSubview:activityImageView]; 
```

这使圆圈和理解我需要代码：

```
activityImageView.frame = CGRectMake(
                                             self.view.frame.size.width/2
                                             -statusImage.size.width/2,
                                             self.view.frame.size.height/1.2
                                             -statusImage.size.width/1.2,
                                             statusImage.size.width,
                                             statusImage.size.height); 
```

虽然我的问题是我不明白如何使用这段代码将坐标和大小设置为我想要的。非常感谢帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T22:09:59.073

看起来你只需要这样做：

```
activityImageView.frame = CGRectMake(280, 5, 34, 34); 
```

上面 CGRectMake 调用中的前 2 个参数是视图左上角相对于其父视图的 X 和 Y 坐标。其余参数是所需的视图宽度和高度。

另外，不要忘记将您的图像视图添加到超级视图，例如

```
[self.view:addSubview:activityImageView]; 
```

# c - 如何在vim中实现跨目录的符号引用？

> ID：14086276
> 
> 赞同：0
> 
> 时间：2012-12-29T21:56:18.213
> 
> 标签：c, vim, project

*ctags*也可以从层次结构中的目录中标记符号，还是仅限于为当前和子目录创建标记？

基本上我正在寻找类似符号交叉引用的 Visual Studio，它对于理解外星源代码流非常有帮助。

如果不是 Vim，那么我应该使用哪个其他编辑器？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T21:58:21.383

Ctags 只递归到子目录。但是您所要做的就是`ctags -R .`在您的项目主目录中运行，它会`tags`为您的整个项目创建一个文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T01:01:28.457

您不仅限于在 Vim 中指定一个标签文件。这是其他答案的替代方法；你可以这样做：

```
set tags=tags,~/wintags,c:/path/to/moretags/etc 
```

因此，当您只想更新本地标签时，无需花时间重新生成单一标签文件。

关于OP在另一个答案中的评论，

> 是的，这是正确的，但是当我打开一个文件说 proj/dir1/def.c 并在 proj/dir2/abc.c 中定义的函数名称上按 ctrl+] 时，我得到标签未找到:(

您还可以在“proj”根目录下为所有项目创建一个标签文件：

```
set tags=tags;c:/path/to/proj 
```

这将使用`tags`它在您所在的目录层次结构中找到的第一个文件。

您可以结合这两种技术来创建一个项目本地标签文件，然后是一个不经常更新的“全局”标签文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:05:23.110

虽然它有类似的用户界面来要求它做这件事，所以你需要实际指定“向下目录”，我发现这`cscope`是一个非常好的工具，它可以完成 ctags 所做的一切以及更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T21:59:42.970

ctags（至少是 exctags）可以为您想要的任意数量的目录树创建标签。只需运行

```
exctags -R dir1 dir2 ... 
```

然后 vim 知道你需要的所有符号。例如，其中一个目录可能是`/usr/include`您自己的源目录的补充。

确保从您在其中创建文件`vim path/to/file.c`的同一目录运行。`tags`

# php - Smarty 作为子模块

> ID：14086283
> 
> 赞同：2
> 
> 时间：2012-12-29T21:57:20.227
> 
> 标签：php, git, github, smarty

有没有办法可以将 Smarty PHP 的`libs`文件夹添加到我的开源 GitHub 项目中，并在 Smarty 更新时自动更新？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T22:25:35.047

[考虑通过Composer](http://getcomposer.org/doc/00-intro.md)管理依赖项，然后通过[Packagist](https://packagist.org/packages/smarty/smarty)参考包含 Smarty 。

这样，您既可以参考最新的开发版本，也可以参考特定的版本 - 建议使用后一种方法，以免陷入重大问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:18:09.530

不，因为您可以在 GitHub 存储库中注册的唯一参考是子模块。
（如“[在 GitHub 上使用别人的 repo 作为 Git 子模块](https://stackoverflow.com/q/5252450/6309)”）

一个子模块就是引用一个*固定*的提交，而不是“最新的”。

您可以使用[subtree merging](https://help.github.com/articles/working-with-subtree-merge)，但是：

*   更新将在本地完成
*   这将复制数据（在 Smarty 初始 repo 和您自己的 repo 之间），推送到 GitHub。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-29T22:20:03.173

你可以使用[这个 repo](https://github.com/cebe/smarty)，它是 Smarty 的 Git 镜像。您真的不希望外部库自动更新。

如果更新有错误或其他更改会破坏您的代码怎么办？你怎么回滚？如果更新自动发生，你怎么知道回滚到哪里？

如果您知道您需要 Smarty 中的新功能或错误修复，我强烈建议您避免自动更新，而是手动更新。

# java - 在 XML 中声明 Swing 视图

> ID：14086285
> 
> 赞同：2
> 
> 时间：2012-12-29T21:57:38.943
> 
> 标签：java, swing, model-view-controller, mvvm

我正在开发一个 Swing 应用程序，并且真的很想以类似于[GWT 的 UiBinder](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder)、JSP、JSF、ZK、IceFaces 等的方式以 XML 格式声明我的视图。

我找到[了 JFCML](http://jfcml.sourceforge.net/)，但它似乎不是一个活跃的项目；在开发和使用/参考方面。

我的谷歌技能让我失望了还是不存在这样的事情？如果它不存在，是不是因为这种分离视图和控制器的方法在 Swing 中以另一种方式更好地完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:03:35.343

“内置”解决方案是[XMLEncoder](http://docs.oracle.com/javase/6/docs/api/java/beans/XMLEncoder.html) - [XMLDecoder](http://docs.oracle.com/javase/6/docs/api/java/beans/XMLDecoder.html)对，但它们并没有被广泛使用，我不确定它们是否能够应对现实世界的场景。

SO上已经建议了很多开源库，我推荐这些问题：

[Java 中声明式 GUI 编程的建议](https://stackoverflow.com/questions/761237/suggestions-for-declarative-gui-programming-in-java)

[Java：使用 XML 创建 GUI？](https://stackoverflow.com/questions/5213838/java-create-a-gui-with-xml)

[XML 或 XUL 是 Java GUI 构建的未来吗？](https://stackoverflow.com/questions/915810/is-xml-or-xul-the-future-of-java-gui-building)

[来自 xml 的 Java 表单](https://stackoverflow.com/questions/2608296/java-form-from-xml)

# javascript - Jquery.min.js 加载异常 0x800a139e

> ID：14086288
> 
> 赞同：3
> 
> 时间：2012-12-29T21:57:58.837
> 
> 标签：javascript, jquery, asp.net, exception, visual-studio-2012

（我修改了这篇文章以反映下面的评论，现在在非缓和版本中发布错误。）

jQuery: /*! jQuery v1.8.3 jquery.org/license */ 浏览器：在 Windows 8 Pro 上运行的 Internet Explorer (IE) v10

我正在从 SiteMaster 加载 jquery.min.js (v1.8.3)。

```
<body>
    <form id="form1" runat="server">
    <script type="text/javascript" src="/jquery/jquery-1.8.3.js"></script>
        <script type="text/javascript" src="/jquery/jquery.bpopup-0.7.0.min.js"></script> 
```

使用 VS2012 中的本地 IE 窗口启动我的 Default.aspx 文件时，出现异常。

```
Exception was thrown at line 5301, column 6 in localhost:49928/jquery/jquery-1.8.3.js

0x800a139e - JavaScript runtime error: SyntaxError

If there is a handler for this exception, the program may be safely continued. 
```

引发异常的实际部分是：

```
if ( matches ) {
    assert(function( div ) {
        // Check to see if it's possible to do matchesSelector
        // on a disconnected node (IE 9)
        disconnectedMatch = matches.call( div, "div" );

        // This should fail with an exception
            // Gecko does not error, returns false instead
        try {
            matches.call( div, "[test!='']:sizzle" );
            rbuggyMatches.push( "!=", pseudos );
        } catch ( e ) {}
    });

    // rbuggyMatches always contains :active and :focus, so no need for a length check
    rbuggyMatches = /* rbuggyMatches.length && */ new RegExp( rbuggyMatches.join("|") ); 
```

如果我按继续，页面加载。

堆栈跟踪：匿名函数 [jquery-1.8.3.js] 第 5301 行断言 [jquery-1.8.3.js] 第 3801 行匿名函数 [jquery-1.8.3.js] 第 5293 行匿名函数 [jquery-1.8.3\. js] Line 5178 匿名函数 [jquery-1.8.3.js] Line 3669 全局代码 [jquery-1.8.3.js] Line 14

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-17T05:48:23.317

我认为你可以尝试加载依赖的方式

RequireJS 是一个 JavaScript 文件和模块加载器。它针对浏览器内的使用进行了优化，但也可以在其他 JavaScript 环境中使用...

或 /jquery/jquery.bpopup-0.7.0.min.js 是 jquery-1.8.3.js 的错误版本

# c++ - 在 QML 中使用 C++-slot，它返回命名空间中的类型

> ID：14086289
> 
> 赞同：16
> 
> 时间：2012-12-29T21:58:06.173
> 
> 标签：c++, qt, qml, qt5, moc

我首先要提一下，在 Qt 5.0.0 beta 1 之前，以下内容可以正常工作（可能还有 beta 2 和 RC，不知道），但在 Qt 5.0.0 最终版本中失败了。我只想参考在 Qt 5.0.0 最终发布版本中看到的结果。所以这很可能与 Qt5 最近的变化有关。

在 C++ 方面，我在命名空间中有一组类（QObject 派生）（可以选择使用编译器标志触发；这些类位于单独的库中，并且该库将命名空间的使用作为选项留给图书馆）。这里的一个类`Game`可能如下所示（摘录）：

```
OAE_BEGIN_NAMESPACE

// forward-declarations:
class Player;    // Player is just another class in the same library

class Game : public QObject
{
    Q_OBJECT

public:
    explicit Game(...);

public slots:
    Player *player() const;  // <-- the quesion is about such slots
};

OAE_END_NAMESPACE 
```

宏`OAE_BEGIN/END_NAMESPACE`扩展为`namespace OAE_NAMESPACE {`...`}`或什么都没有，就像 Qt 在 中所做的那样`<qglobal.h>`，只是将宏名称中的“QT”替换为“OAE”：

```
#ifndef OAE_NAMESPACE

# define OAE_PREPEND_NAMESPACE(name) ::name
# define OAE_USE_NAMESPACE
# define OAE_BEGIN_NAMESPACE
# define OAE_END_NAMESPACE
# define OAE_BEGIN_INCLUDE_NAMESPACE
# define OAE_END_INCLUDE_NAMESPACE
# define OAE_BEGIN_MOC_NAMESPACE
# define OAE_END_MOC_NAMESPACE
# define OAE_FORWARD_DECLARE_CLASS(name) class name;
# define OAE_FORWARD_DECLARE_STRUCT(name) struct name;
# define OAE_MANGLE_NAMESPACE(name) name

#else /* user namespace */

# define OAE_PREPEND_NAMESPACE(name) ::OAE_NAMESPACE::name
# define OAE_USE_NAMESPACE using namespace ::OAE_NAMESPACE;
# define OAE_BEGIN_NAMESPACE namespace OAE_NAMESPACE {
# define OAE_END_NAMESPACE }
# define OAE_BEGIN_INCLUDE_NAMESPACE }
# define OAE_END_INCLUDE_NAMESPACE namespace OAE_NAMESPACE {
# define OAE_BEGIN_MOC_NAMESPACE OAE_USE_NAMESPACE
# define OAE_END_MOC_NAMESPACE
# define OAE_FORWARD_DECLARE_CLASS(name) \
    OAE_BEGIN_NAMESPACE class name; OAE_END_NAMESPACE \
    using OAE_PREPEND_NAMESPACE(name);

# define OAE_FORWARD_DECLARE_STRUCT(name) \
    OAE_BEGIN_NAMESPACE struct name; OAE_END_NAMESPACE \
    using OAE_PREPEND_NAMESPACE(name);

# define OAE_MANGLE_NAMESPACE0(x) x
# define OAE_MANGLE_NAMESPACE1(a, b) a##_##b
# define OAE_MANGLE_NAMESPACE2(a, b) OAE_MANGLE_NAMESPACE1(a,b)
# define OAE_MANGLE_NAMESPACE(name) OAE_MANGLE_NAMESPACE2( \
        OAE_MANGLE_NAMESPACE0(name), OAE_MANGLE_NAMESPACE0(OAE_NAMESPACE))

namespace OAE_NAMESPACE {}

# ifndef OAE_BOOTSTRAPPED
# ifndef OAE_NO_USING_NAMESPACE
   /*
    This expands to a "using OAE_NAMESPACE" also in _header files_.
    It is the only way the feature can be used without too much
    pain, but if people _really_ do not want it they can add
    DEFINES += OAE_NO_USING_NAMESPACE to their .pro files.
    */
   OAE_USE_NAMESPACE
# endif
# endif

#endif /* user namespace */ 
```

在下文中，当说“启用命名空间”时，我的意思是我声明了宏`OAE_NAMESPACE`，在本例中为值`oae`。

其中，我访问了这个类的实例以及从 QML 中`Player`返回的类的实例，用于我的应用程序的用户界面。`player()`为此，我按如下方式注册类：

```
qmlRegisterType<Game>();
qmlRegisterType<Player>(); 
```

我为 QML 前端提供了一个指向 a 实例的指针，在 QML`Game`中调用`theGame`：

```
view.engine()->rootContext()->setContextProperty("theGame",
        QVariant::fromValue<Game*>(game)); 
```

在 QML 中，我照常使用它。一个小例子应该打印一个指针地址`player()`：

```
Rectangle {
    width: 100; height: 100
    Component.onCompleted: console.log(theGame.player())
} 
```

我得到以下结果，具体取决于我是否设置了 a `OAE_NAMESPACE`（顺便说一句：我对库和使用它的应用程序使用相同的设置）：

*   **禁用 namespace**时，一切都按预期工作，QML 向我打印指针：

    ```
    Player(0x10b4ae0) 
    ```

*   **启用命名空间**时（以及`using`它在使用库的 C++ 代码中，所以我根本不更改代码），QML 无法理解的返回类型`Game::player()`：

    ```
    Error: Unknown method return type: Player* 
    ```

*   将**返回类型更改**为`Game::player()`to 时 `oae::Player*`，一切正常：

    ```
    oae::Player(0x10b4ae0) 
    ```

到目前为止，我的结论是`moc`不考虑我放在类周围的名称空间。我的第一个猜测是：嘿，`moc`不知道我在调用时定义了命名空间`g++`，这是我在 .pro 文件中所做的：

```
DEFINES += OAE_NAMESPACE=oae 
```

但是，当将返回类型更改为 时`OAE_NAMESPACE::Player*`，它仍然有效，因此 moc*确实*知道`OAE_NAMESPACE`宏，但它既不扩展`OAE_BEGIN/END_NAMESPACE`宏，也不再解析命名空间。

`moc`生成以下“stringdata”，`Player * Game::player() const`其中包含方法的返回类型：

*   **禁用命名空间**并使用返回类型时`Player*`：

    ```
    "player\0Player*\0" 
    ```

*   **启用命名空间**并使用返回类型时`Player*`：

    ```
    "player\0Player*\0" 
    ```

*   **启用命名空间**并使用返回类型时`OAE_NAMESPACE::Player*`：

    ```
    "player\0oae::Player*\0" 
    ```

另一方面，如果启用，则在命名空间`moc`返回的类名前面加上命名空间。`QMetaObject::className()`

我现在的结论是，我*可以*通过编写`OAE_NAMESPACE::ClassName`而不是`ClassName`在 QObject 元方法的签名中使用这些类型来解决这个问题。（嗯，有更好的宏`OAE_PREPEND_NAMESPACE`）。由于这在代码中看起来很糟糕，而且对我来说它甚至似乎是错误的，因为该方法*已经在 namespace*中，**有没有更好的解决方案？**

现在也有`OAE_BEGIN/END_MOC_NAMESPACE`（类似于`QT_BEGIN/END_MOC_NAMESPACE`），***所以也许我在任何地方都需要那些***？我不知道它们在 Qt 中的何处/如何使用，因此我应该在我的库中相应地使用它们，因为我想使用与 Qt 相同的可选命名空间功能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T12:58:04.723

它真的在 5.0.0a 中有效吗？

我浏览了 Qt 5.0.0 源代码并查看了解析方法的位置，尤其是返回类型 (fyi, 5.0.0\qtbase\src\tools\moc\moc.cpp:L160)，并且没有命名空间检查（也没有论点，所以`player(Player* p)`也不起作用）。然而，它是为类 def (5.0.0\qtbase\src\tools\moc\moc.cpp:L620 & L635) 完成的

我认为“我们”可以称之为错误（或疏忽）

# php - 如何使用php检查两个数组中是否存在相同的值

> ID：14086292
> 
> 赞同：-1
> 
> 时间：2012-12-29T21:58:22.533
> 
> 标签：php

> **可能重复：**
> [如何检查另一个数组php中是否存在数组的任何值？](https://stackoverflow.com/questions/11789897/how-check-any-value-of-array-exist-in-another-array-php)

我正在创建一个购物网站。为简化起见，我有 2 个数组，一个包含我的所有商品，另一个包含添加到购物车的所有商品：

**$项目**

```
Array
(
    [0] => stdClass Object
        (
            [id] => 1
            [title] => Verity soap caddy
            [price] => 6.00
        )

    [1] => stdClass Object
        (
            [id] => 2
            [title] => Kier 30cm towel rail
            [price] => 14.00
        )
      //a lot more
) 
```

**$cartItems**

```
Array
(
    [0] => Array
        (
            [rowid] => c4ca4238a0b923820dcc509a6f75849b
            [id] => 1
            [qty] => 1
            [price] => 6.00
            [name] => Verity soap caddy
            [subtotal] => 6
        )
) 
```

如果商品也在购物车中，我想遍历**$cartItems并添加一个类（识别）。**这就是我尝试做的方式

```
foreach($items as $items){
  if($cartItems[$items->id]['id']){
    echo '<h1 class="inCart">'. $item->title . '</h1>' //...
   }else{
    echo '<h1>'. $item->title . '</h1>' //...
   }
} 
```

上面的代码不起作用 - 即使`$cartItems[0]['id']`会返回我需要的东西。我的想法是，在遍历 $items 时，检查`$cartItems`数组中是否存在类似的 id。我还尝试在循环中添加`$cartItems[$i]['id']`和递增`$i`，但没有奏效。当然，我想要得到的 html 输出是（简化的）

```
<h1 class="IsOnCart"> Item Title</h1>
<h1> Item Title</h1>
<h1 class="IsOnCart"> Item Title</h1>
<h1> Item Title</h1> 
```

有没有办法实现这个？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:01:35.513

```
$intersection = array_intersect($arr1, $arr2);
if (in_array($value, $intersection)) {
    // both arrays contain $value
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:31:03.063

You can try

```
$items = array(
  0 => 
  (object) (array(
     'id' => 1,
     'title' => 'Verity soap caddy',
     'price' => '6.00',
  )),
  1 => 
  (object) (array(
     'id' => 2,
     'title' => 'Kier 30cm towel rail',
     'price' => '14.00',
  )),
);

$cartItems = array(
        0 => array(
                'rowid' => 'c4ca4238a0b923820dcc509a6f75849b',
                'id' => 1,
                'qty' => 1,
                'price' => '6.00',
                'name' => 'Verity soap caddy',
                'subtotal' => 6,
        ),
);

$itemsIncart = array_reduce(array_uintersect($items, $cartItems, function ($a, $b) {
    $a = (array) $a;
    $b = (array) $b;
    return $a['id'] === $b['id'] ? 0 : 1;
}), function ($a, $b) {
    $a[$b->id] = true;
    return $a;
});

foreach ( $items as $item ) {
    if (array_key_exists($item->id, $itemsIncart))
        printf('<h1 class="inCart">%s *</h1>', $item->title);
    else
        printf('<h1>%s</h1>', $item->title);
} 
```

Output

```
<h1 class="inCart">Verity soap caddy</h1>
<h1>Kier 30cm towel rail</h1> 
```

# excel - ADODB中的Oracle Group By语句等效于Excel？

> ID：14086293
> 
> 赞同：0
> 
> 时间：2012-12-29T21:58:44.900
> 
> 标签：excel, vbscript, ado, adodb

我在Excel中有一些数据如下：

```
EmpId     Ename      joining Date      mangerid

12         aa            12/10             15
22         abc           11/10             15
42         ara           12/10             11
15         pp            08/10             10
12         bb            02/10             11 
```

现在我可以在 Oracle 中编写代码 - 看看有多少员工在同一个经理和他们的名字下。但是现在我想要使用相同的`ADO-DB`进程。所以我怎么能写一个相同的代码？

甲骨文：

select mangerid,(select ename fromemployee where mangerid=e.manager id),Count(4) from emp e group by mangerid

我的excel表中有这样的数据。

**输出**

```
Mangerid      empid      count
================================
15            12           2
              22
11            12           2
              42
10            15           1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:59:18.653

[这是一篇关于将 ADO 与 Excel 结合使用](http://support.microsoft.com/kb/257819)的 MSDN 文章。下面的代码是根据[这个问题](https://stackoverflow.com/questions/8985580/using-adodb-to-access-opened-xls-file)稍微修改的。这`Sheet1`从`C:\example.xls`. 然后根据需要将数据加载到 Modify 中。这是一个 VBA 示例，我现在没有时间将其更改为 VBS。它假定您实际上拥有 Excel 并引用了 ADODB。

```
Sub test()
Dim conn As ADODB.Connection
Dim sql As String
Dim rst As ADODB.Recordset
Set conn = New ADODB.Connection
conn.Open "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\example.xls;Extended Properties=Excel 8.0;"
sql = "SELECT [manger id], Ename from [Sheet1$] Order by [manger id]"

Set rst = New ADODB.Recordset
rst.Open sql, conn, 1

'Load data from recordset
Worksheets("Results").Range("A2").CopyFromRecordset rst

rst.Close
Set rst = Nothing

conn.Close
Set conn = Nothing
End Sub 
```

我在 SQL 查询中使用了 Order By，因为我无法理解您使用 Oracle 查询返回的内容。

# sencha-touch - Sencha Touch，如何将数据从列表传递到表单？

> ID：14086295
> 
> 赞同：0
> 
> 时间：2012-12-29T21:58:45.857
> 
> 标签：sencha-touch

我正在尝试使用 sencha touch 编写可编辑列表，

我看到了很多例子，但没有一个不能正常工作，所以我决定从头开始构建，

我有一个包含项目的列表，在项目上点击我的控制器运行下一个代码

```
 showDetail: function (list, record) {

    this.getMain().push({
        xtype: 'vedit',
        title: record.fullDetails(),
        data: record.getData()
    }); 
```

我的“vEdit”屏幕是一个应该显示当前点击的项目数据的表单

这是编辑表单的代码：

```
var form = Ext.define('TM.view.vEdit', {

extend: 'Ext.form.Panel',
xtype: 'vedit',

config: {
    title: 'Edit task',
    styleHtmlContent: true,
    scrollable: 'vertical',

    items: [
       {
           xtype: 'textfield',
           name: 'title',
           label: ''
       },
       {
           xtype: 'textfield',
           name: 'desc',
           label: ''
       }
    ]
} 
```

});

我尝试使用以下代码加载数据：

```
var ed = Ext.create('TM.model.mTasks', {
title: 'Ed',
desc: 'ed@sencha.com' 
```

});

form.setRecord(ed);

并得到下一个错误：

```
Uncaught TypeError: Object function () {
                return this.constructor.apply(this, arguments);
            } has no method 'setRecord' 
```

需要你的帮助，

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T06:35:23.087

```
var form = Ext.define('TM.view.vEdit', { 
```

伙计，您需要创建新的 form()，因为它只是一个类型定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T16:06:07.230

由于您没有在表单的配置中定义一个名为记录的字段，因此您不会获得 setRecord() 方法。

要传递数据，您可以尝试这样做：

```
form.config.record = ed; 
```

在视图的初始化函数中，你可以得到它：

```
var taskData = this.config.record; 
```

# objective-c - 将 CCParticleSystemQuad 作为子项添加到 LHSprite 时断言失败

> ID：14086299
> 
> 赞同：0
> 
> 时间：2012-12-29T21:59:12.050
> 
> 标签：objective-c, ios, cocos2d-iphone, levelhelper

我尝试将一个`CCParticleSystemQuad`作为孩子添加到`LHSprite`：

```
player = [loader spriteWithUniqueName:@"player"];
NSAssert(player != nil, @"Couldn't find the player!");

// Particles
smokeParticles = [CCParticleSystemQuad particleWithFile:@"smoke.plist"];
smokeParticles.position = ccp(-30.0, 0.0);
[player addChild:smokeParticles]; 
```

* * *

但我不断收到此错误消息：

```
2012-12-29 22:51:44.373 MyProject[15396:15203]
*** Assertion failure in -[LHSprite addChild:z:tag:],
/MyPath/MyProject/libs/cocos2d/CCSprite.m:567 
```

* * *

## 添加`CCParticleSystemQuad`到`CCLayer`

```
[self addChild:smokeParticles]; 
```

工作得很好。

* * *

## `CCSprite.m`: 567 行

```
NSAssert([child isKindOfClass:[CCSprite class]],
         @"CCSprite only supports CCSprites as children when using CCSpriteBatchNode"); 
```

谁能告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:12:54.670

在 Level Navigator 中的 LH 内部 - 将您的精灵拖到 MAIN_LAYER 顶部 - 这将从批处理节点中移除精灵并使其自行渲染 - 现在您将能够通过代码向其添加子节点。如果使用批处理精灵，则只能将子精灵添加到与批处理节点具有相同纹理的精灵中（即使用相同的图像文件）

对于 LHParallaxNode - 这不会将粒子/精灵添加到节点 - 它只是移动它。因此，您还应该将粒子添加到图层

[自我addChild：粒子z：100]；

然后将其添加到视差节点。

`Bogdan Vladu`LevelHelper 的创建者这样说..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:42:23.777

原因在断言消息中给出。发生这种情况是因为 CCSprite 在使用 CCSpriteBatchNode 时仅支持将 CCSprites 作为子项。如果使用 CCSpriteBatchNode 绘制精灵，则只能将 CCSprites 作为子元素添加到该精灵。

# android - Android JAR 附加源错误

> ID：14086300
> 
> 赞同：0
> 
> 时间：2012-12-29T21:59:22.597
> 
> 标签：android, eclipse

![在此处输入图像描述](../Images/61afcbd26072e18a700017951f699ba5.png)我似乎可以在 Eclipse 中摆脱这条消息。我正在尝试创建一个简单的 hello world android 应用程序，我一直在为类文件编辑器运行以下内容。旁注：我已经下载并安装了 ADT 调试器插件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:09:50.957

这不应影响您编译和运行应用程序的能力。

源代码所做的只是显示 jar 中的实际代码以及它附带的任何文档。唯一出现“找不到源”的情况是，如果您单击来自 android jar 的方法以查看更多详细信息（例如按`CTRL`+ 然后单击“打开声明/实现”）。

您应该能够关闭显示此错误的类文件编辑器并继续开发。如果您确实想在 eclipse 中获得可用的资源，那么[这个](https://stackoverflow.com/questions/5233640/best-way-to-attach-android-source-to-eclipse)SO question 有一些方法。

# objective-c - Restkit 对象映射不起作用

> ID：14086301
> 
> 赞同：1
> 
> 时间：2012-12-29T21:59:25.280
> 
> 标签：objective-c, ios, ios6, restkit, xcode4.5

我正在尝试学习restkit，现在正在研究对象映射。这是我尝试接收和处理的 JSON（由 ASP.NET MVC Web API 生成）：

```
[
    {
        "Id": 0,
        "Title": "Test",
        "Location": "Test",
        "Score": {
            "Hill": 10,
            "LVille": 12
        },
        "TimeStart": "2012-11-10T12:30:00",
        "TimeEnd": "2012-11-10T13:20:00",
        "Gender": 0,
        "State": 0
    },
    {
        "Id": 0,
        "Title": "ee",
        "Location": "12:00",
        "Score": {
            "Hill": 13,
            "LVille": 0
        },
        "TimeStart": "12:00 PM",
        "TimeEnd": "12:00 PM",
        "Gender": 1,
        "State": 1
    }
] 
```

被映射到的对象是（SBGame）：

```
@interface SBGame : NSObject

@property (nonatomic, copy) NSNumber* Id;
@property (nonatomic, copy) NSString* Title;
@property (nonatomic, copy) NSString* Location;
@property (nonatomic, strong) SBScore* Score;
@property (nonatomic, copy) NSString* TimeStart;
@property (nonatomic, copy) NSString* TimeEnd;
@property (nonatomic, copy) NSNumber* Gender;
@property (nonatomic, copy) NSNumber* State;

@end 
```

和 SBScore ：

```
@interface SBScore : NSObject
@property (nonatomic, copy) NSNumber* Hill;
@property (nonatomic, copy) NSNumber* LVille;
@end 
```

最后但并非最不重要的对象映射

```
RKObjectMapping *ScoreMapping = [RKObjectMapping mappingForClass:[SBScore class]];
[ScoreMapping addAttributeMappingsFromArray:@[@"Hill", @"LVille"]];

RKObjectMapping *GameMapping = [RKObjectMapping mappingForClass:[SBGame class]];
[GameMapping addAttributeMappingsFromDictionary:@{
    @"Id" : @"Id",
    @"Title" : @"Title",
    @"Location" : @"Location",
    @"TimeStart" : @"TimeStart",
    @"TimeEnd" : @"TimeEnd",
    @"Gender" : @"Gender",
    @"State" : @"State",
 }];

[GameMapping addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"score" toKeyPath:@"score" withMapping:ScoreMapping]];

RKResponseDescriptor *decp = [RKResponseDescriptor responseDescriptorWithMapping:GameMapping pathPattern:@"/Games" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];
[objectManager addResponseDescriptor:decp]; 
```

毕竟我收到的错误是

```
2012-12-29 16:49:19.553 Scoreboard[3004:c07] Failure with error Error Domain=org.restkit.RestKit.ErrorDomain Code=1001 
"Unable to find any mappings for the given content" UserInfo=0x75c1460 {DetailedErrors=(
), NSLocalizedDescription=Unable to find any mappings for the given content, keyPath=null} 
```

我对 RestKit 很陌生，我已经阅读[了对象映射教程](https://github.com/RestKit/RestKit/wiki/Object-mapping)，但它仍然不起作用。任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:54:51.570

我想到了。当我创建默认实例时，我创建了基本 URL `www.example.com/api`，然后只创建了绑定和 getObjects 方法`/Games`

我应该做的是让基本 URL`www.example.com`将路径模式设置为`/api/Games`并调用 getObjects 方法`/api/games`

所以从显示的代码

```
RKResponseDescriptor *decp 
= [RKResponseDescriptor responseDescriptorWithMapping:GameMapping
                                          pathPattern:@"/Games" 
                                              keyPath:nil
                                          statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)]; 
```

更改为

```
RKResponseDescriptor *decp 
= [RKResponseDescriptor responseDescriptorWithMapping:GameMapping
                                          pathPattern:@"/api/Games"
                                              keyPath:nil
                                          statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)]; 
```

# php - （不确定是否可能）计算指定用户进入的次数，并按升序排列

> ID：14086305
> 
> 赞同：-1
> 
> 时间：2012-12-29T22:00:14.033
> 
> 标签：php, mysql

这是我想要的：假设我们有一个看起来像这样的表：

```
Player    |ID
----------|------
Max       |  1
Jacob     |  2
Jacob     |  3
Jacob     |  4
Jacob     |  5
Jacob     |  6
Peter     |  7
Peter     |  8
Peter     |  9
Peter     |  10
Jørgen    |  11
Jørgen    |  12
Jørgen    |  13
osborne   |  14
Jimmy     |  15 
```

我想要的是收集所有具有相同名称的条目的脚本，对它们进行计数并列出前 3 个升序，结果如下（在 html 表中）：

```
Player | votes
Jacob  |   5
Peter  |   4
Jørgen |   3 
```

我不是要一个完整的脚本，只是要如何计算它。

我尝试搜索它，但我不能足够具体，因为我不知道要搜索什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T22:03:38.603

这很简单，只需使用`GROUP BY`and `COUNT()`：

```
SELECT Player, COUNT(*) AS votes
FROM PlayerTable
GROUP BY Player
ORDER BY votes DESC
LIMIT 3 
```

（[关于 SQLize 的演示](http://www.sqlize.com/M32MvDMfv3)）

# css - 当前菜单项上的悬停状态

> ID：14086312
> 
> 赞同：1
> 
> 时间：2012-12-29T22:01:13.877
> 
> 标签：css, wordpress

我遇到了一个小问题，似乎很难解决。我已经设计了这个 wordpress 菜单[http://bandmark.com](http://bandmark.com)并且每个菜单项都有自己的背景图像。我遇到的问题是我无法删除或覆盖控制“.current”背景的样式。在主页上它们看起来不错，但是如果您单击链接转到页面/类别，那么 .current 样式就会启动并与演示文稿混淆。当您将鼠标悬停在当前菜单项上时，图形会以一个奇怪的角度滑入，看起来不太好。

```
 nav#omc-main-navigation ul li.current-menu-item a 
```

似乎是我需要覆盖的元素。如果我将背景更改为无，我会得到一个空白屏幕。无论如何要让 .current 状态与 :hover 相同？就像我上面说的，他们都有自己的菜单项-{number}。如果这听起来有点令人困惑，我深表歉意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:25:02.890

您可以将 .current 添加到 :hover 样式吗？例子：

```
a:hover, a .current { background-color: #333; } 
```

[http://jsfiddle.net/e2vTN/](http://jsfiddle.net/e2vTN/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:26:09.750

您在哪里定义了悬停状态，例如：

```
nav#omc-main-navigation ul li#menu-item-4200 a:hover { background: ... } 
```

添加当前菜单项如下：

```
nav#omc-main-navigation ul li#menu-item-4200 a:hover,
nav#omc-main-navigation ul li#menu-item-4200.current-menu-item a { background: ... } 
```

# javascript - 用户刷新或离开网页时调用ajax函数

> ID：14086313
> 
> 赞同：0
> 
> 时间：2012-12-29T22:01:30.457
> 
> 标签：javascript, jquery

当用户离开网页或刷新网页时，我需要调用 ajax 函数。到目前为止，我可以在用户使用 javascript 关闭页面时调用 ajax 函数，`window.onunload = my_ajax_function;`但我还需要在`my_ajax_function`刷新页面或用户离开页面以转到不同的 url 时调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:03:46.717

刷新也会触发`onunload`（和`onbeforeunload`）。但是，您需要使调用同步（`async: false`在`$.ajax()`选项中），这样它就不会由于页面被卸载而中止。

```
$(window).on('unload', function() {
    $.ajax({
        async: false,
        url: 'whatever',
        ...
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T22:04:29.823

为了在页面刷新时调用ajax函数是将它放在`ready`处理程序中

```
$(function(){
 //your ajax func
}); 
```

并检测用户离开页面使用

```
window.onbeforeunload = function() {
    //your code here
} 
```

# java - Java中的范围简化

> ID：14086316
> 
> 赞同：2
> 
> 时间：2012-12-29T22:01:42.330
> 
> 标签：java

我有一个 Range 对象，它由一个最小值和一个最大值组成。因此，可以有范围，例如

```
[1, 5]
[6, 12]
[13, 14] 
```

这是我的问题。假设您有一个范围列表，由

```
ArrayList<Range> ranges; 
```

并且您想要修复它们，以便没有重叠的范围。也就是说，有两个功能：

```
public void addRange(Range r);

public void removeRange(Range r); 
```

您可以假设在每个方法之后，`ranges`ArrayList 将始终按最小值排序。请注意，`ranges`ArrayList 始终包含初始范围`[1, 100]`. 以下是`ranges`之前和之后的一些示例：

```
ranges = {[1,5], [6,12], [13,14]}
addRange([7, 15])
ranges = {[1,5], [6,15]}

ranges = {[1,12], [18,29], [34,89]}
addRange([16,17])
ranges = {{[1,12], [16,17], [18,29], [34,89]}

ranges = {[16,35]}
removeRange([19,54])
ranges = {[16,19]} 
```

这两个函数怎么写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:07:56.063

这应该有效。它是 O(n)，因此您可能想要替换更快的搜索/排序算法。

**DistinctRangeList.java**

```
package range;

import java.util.LinkedList;

public class DistinctRangeList {

    private LinkedList<Range> linkedList;

    public DistinctRangeList() {
        linkedList = new LinkedList<Range>();
    }

    public void add(Range newRange) {
        for (int i = 0; i < linkedList.size(); i++) {
            Range range = linkedList.get(i);
            if (range.overlaps(newRange)) {
                return;
            } else if (newRange.min < range.min) {
                linkedList.add(i, newRange);
                return;
            } else {
                continue;
            }
        }
        linkedList.addLast(newRange);
    }

    public void remove(Range remove) {
        for (int i = 0; i < linkedList.size(); i++) {
            Range range = linkedList.get(i);
            if (range.equals(remove)) {
                linkedList.remove(range);   
            }
        }
    }

    public String toString() {
        String s = "";
        for (Range r : linkedList) {
            s += String.format("[%d, %d] ", r.min, r.max);
        }
        return s;
    }

    public static void main(String[] args) {
        DistinctRangeList lst = new DistinctRangeList();
        lst.add(new Range(3, 6)); // should add
        lst.add(new Range(3, 5)); // should not add
        lst.add(new Range(7, 8)); // should add
        lst.add(new Range(10, 15)); // should add
        lst.remove(new Range(10, 15)); 
        lst.add(new Range(10, 12)); // should add
        lst.add(new Range(1, 2)); // should add to the beginning
        System.out.println(lst);
    }
} 
```

**范围.java**

```
package range;

public class Range {
    public int min, max;

    public Range(int min, int max) {
        this.min = min; this.max = max;
    }

    public boolean equals(Range other) {
        return this.min == other.min && this.max == other.max;
    }

    public boolean overlaps(Range other) {
        return (min <= other.min && other.min <= max) ||
               (min <= other.max && other.max <= max);
    }
} 
```

* * *

好吧，我想这就是你想要的。（这是一个有趣的问题，所以我继续进行。）

**RangeSet.java**

```
package range;

import java.util.LinkedList;

public class RangeSet {

    private LinkedList<Range> linkedList;

    public RangeSet() {
        linkedList = new LinkedList<Range>();
    }

    public void add(Range range) {

        System.out.println("Adding " + range + " ...");

        if (linkedList.contains(range)) {
            return;
        }

        // First place the new range
        boolean done = false;
        for (int i = 0; i < linkedList.size() && !done; i++) {
            Range current = linkedList.get(i);
            if (range.min < current.min) {
                linkedList.add(i, range);
                done = true;
            }
        }
        if (!done) {
            linkedList.addLast(range);
        }

        // Now, do the necessary merges
        for (int i = 0; i < linkedList.size() - 1; i++) {
            Range current = linkedList.get(i);
            Range next = linkedList.get(i + 1);
            if (current.overlaps(next)) {
                current.extendBy(next);
                linkedList.remove(i + 1);
            }
        }

        System.out.println(this);
    }

    public void remove(Range remove) {

        System.out.println("Removing " + remove + " ...");

        for (int i = 0; i < linkedList.size(); i++) {

            Range current = linkedList.get(i);

            if (!current.overlaps(remove)) { // no overlap

                continue;

            } else if (remove.min <= current.min && remove.max >= current.max) { // the range to remove contains the current node

                linkedList.remove(i);

            } else if (remove.min < current.min) { // the range to remove intersects the current node from the left end

                current.min = remove.max;

            } else if (remove.max > current.max) { // [...] from the right end

                current.max = remove.min;

            } else { // the range to remove is contained within the current node, splitting it in two

                Range start = new Range(current.min, remove.min);

                Range end = new Range(remove.max, current.max);

                linkedList.remove(i);

                linkedList.add(i, start);

                linkedList.add(i + 1, end);
            }
        }

        System.out.println(this);
    }

    public String toString() {
        String s = "";
        for (Range r : linkedList) {
            s += r.toString() + " ";
        }
        return s;
    }

    public static void main(String[] args) {
        RangeSet set = new RangeSet();
        set.add(new Range(3, 6));
        set.add(new Range(1, 2));
        set.add(new Range(4, 10));
        set.add(new Range(50, 100));
        set.remove(new Range(9, 90));
        System.out.println("Final result:\n" + set);
    }
} 
```

**范围.java**

```
package range;

public class Range {
    public int min, max;

    public Range(int min, int max) {
        this.min = min; this.max = max;
    }

    public boolean equals(Range other) {
        return this.min == other.min && this.max == other.max;
    }

    public boolean overlaps(Range other) {
        return (min <= other.min && other.min <= max) ||
               (min <= other.max && other.max <= max);
    }

    public void extendBy(Range other) {
        if (other.min < this.min) {
            this.min = other.min;
        }
        if (other.max > this.max) {
            this.max = other.max;
        }
    }

    public String toString() {
        return String.format("[%d, %d]", min, max);
    }
} 
```

# mysql - MySQL InnoDB：自动增量非主键

> ID：14086324
> 
> 赞同：36
> 
> 时间：2012-12-29T22:02:46.277
> 
> 标签：mysql, primary-key, innodb

是否可以自动增加*非主*键？

表“book_comments”

```
book_id     medium_int
timestamp   medium_int
user_id     medium_int
vote_up     small_int
vote_down   small_int
comment     text
comment_id  medium_int

Primary key -> (book_id, timestamp, user_id) 
```

此表上不会有其他索引。但是，我想使`comment_id`列自动递增，以便我可以轻松地创建另一个表：

表“book_comments_votes”

```
comment_id  (medium_int)
user_id     (medium_int)

Primary key -> (comment_id, user_id) 
```

用户每本书评论只能投票一次。此表通过主键强制执行此规则。

### 问题：

是否可以自动增加*非主*键 - 如自动增加`comment_id`表“book_comments”中的列？

* * *

## 替代方案，讨论。

如上所述，为了简单起见，我想这样做。替代方案并不乐观。

*   制作 commnet_id PK 并通过`book_id, timestamp, user_id`. 在这种情况下，我会创建一个额外的索引。
*   保留 PK 并将其中的 comment_id 替换为`book_comments_votes`整个 PK。这将使桌子的大小增加三倍以上。

建议？想法？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-12-30T02:12:09.110

是的你可以。您只需将该列设为索引即可。

```
CREATE TABLE `test` (
  `testID` int(11) NOT NULL,
  `string` varchar(45) DEFAULT NULL,
  `testInc` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`testID`),
  KEY `testInc` (`testInc`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;

insert into test(
  testID,
 string
)
values (
1,
    'Hello'
);

insert into test( 
testID,
 string
)
values (
2,
    'world'
); 
```

将为“testInc”插入具有自动递增值的行。然而，这是一件非常愚蠢的事情。

您已经说过正确的方法：

“通过 book_id、timestamp、user_id 上的唯一索引进行 comment_id PK 并强制执行完整性。”

这正是你应该这样做的方式。它不仅为您提供了将来查询所需的表的正确主键键，而且还满足[了最小惊讶原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-28T08:47:43.667

你有现有的表。如果你已经给了一个主键`comment_id`并且唯一的目的是设置 auto_increment。您可以将主键拖放到该列。MySQL 允许具有任何 key 属性的列可以访问 auto_increment。所以最好尝试索引或`unique key`喜欢`comment_id`下面。

1.删​​除主键

```
ALTER TABLE `book_comments` MODIFY `comment_id` INT(5) NOT NULL;

ALTER TABLE `book_comments` DROP PRIMARY KEY ; 
```

2.  添加属性`AUTO_INCREMENT`。`UNIQUE_KEY`

`ALTER TABLE 'brand_keywords' CHANGE COLUMN 'comment_id' 'comment_id' INT(5) NOT NULL AUTO_INCREMENT UNIQUE;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-13T06:55:48.923

从 MySQL 5.5 开始，似乎可以在没有~~索引或~~主键的情况下为 INT 字段提供自动增量。

# php - 动态字段是额外的吗？

> ID：14086330
> 
> 赞同：0
> 
> 时间：2012-12-29T22:03:22.847
> 
> 标签：php, forms, symfony

我定义了一个具有两种可能性的 EventSubscriber，其中一种添加了一个带有可变数量按钮的单选按钮。除非选中其中一个单选按钮，否则一切似乎都按预期运行。检查后，我得到

> 此表单不应包含额外字段。

错误。

如何避免这种情况？

一些代码：

### 订户

```
class AddV2FieldsSubscriber implements EventSubscriberInterface {

    private $factory;

    public function __construct(FormFactoryInterface $factory) {
        $this->factory = $factory;
    }

    public static function getSubscribedEvents() {
        return array(FormEvents::PRE_SET_DATA => 'preSetData');
    }

    public function preSetData(DataEvent $event) {
        $data = $event->getData();
        $form = $event->getForm();
        if (null === $data) {
            return;
        }
        // check if the client object is v1: id exists, dateAdded is null
        $n = $data->getMembers()->count();
        if (!$data->getId() || $data->getDateAdded()) {
            $date = new \DateTime();
            $form->add($this->factory->createNamed('dateAdded', 'date', $date, array(
                    'widget' => 'choice',
                    'format' => 'MM/dd/yyyy',
                    'pattern' => '{{ year }}-{{ month }}-{{ day }}',
                    'years' => range(Date('Y'), Date('Y') - 5),
                    'required' => false,
                    'input' => 'datetime',
                ))
                    );
            $form->add($this->factory->createNamed('active', 'hidden', 'Yes')
                    );
            $form->add($this->factory->createNamed('updated', 'hidden', 'No')
                    );
            $form->add($this->factory->createNamed('sex', 'choice', null, array(
                    'choices' => array('Male' => 'Male', 'Female' => 'Female'),
                    'empty_value' => "Select a gender",
                    'required' => false))
                    );
            $form->add($this->factory->createNamed('dob', 'dob_age', null)
                    );
        } 
        elseif ($n && !$data->getDateAdded())
        {
            $members = $data->getMembers();
            // build choices array with member ids
            $choices = array();
            foreach ($members as $member) {
                $choices[$member->getId()] = 'Yes';
            }
            $form->add($this->factory->createNamed('isClient', 'choice', null, array(
                        'choices' => $choices,
                        'empty_value' => false,
                        'required' => false,
                        'mapped' => false,
                        'expanded' => true,
                        'label' => 'isClient',
                    )));
        }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:48:57.510

在这种情况下，答案是使用调试器找出 Symfony 确定的额外字段。原来，模板中有一些硬连线的隐藏字段需要删除。嗬！

# javascript - 是否可以使用触控板进行手势操作？

> ID：14086337
> 
> 赞同：4
> 
> 时间：2012-12-29T22:04:00.307
> 
> 标签：javascript, jquery, google-chrome, touch, gesture

在 Chrome 中的 Macbook Pro 上，在屏幕上滑动两根手指可以前后移动。我该如何禁用它，并在 jQuery 或 Javascript 中创建自定义手势？

我真正需要知道的是如何检测两个手指何时在触控板上，我认为这是最好的方法。您可以使用 e.touches 在移动设备上进行操作！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-05-03T17:39:21.603

**2017 年 5 月更新**

*   Chrome 已经实现了新的[wheel-event](https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent)。Pinch-Zoom 可以被检测为带有 的滚轮事件`ctrlKey === true`。
*   Firefox[将](https://bugzilla.mozilla.org/show_bug.cgi?id=1052253)在 Fx55 中提供相同的行为。
*   [除非您使用“精确触摸板”，否则](https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7134034/)Edge 支持滚轮事件。不知道捏缩放怎么样。
*   Opera 可能与 chrome-behaviour 匹配（未测试）
*   safari 有基本的轮子事件并支持专有的（但还挺棒的）[手势事件](https://developer.mozilla.org/en-US/docs/Web/API/GestureEvent)

**原始答案**

截至 2016 年 4 月，在不同的浏览器中以（非常）不同的方式支持捏缩放手势：

*   Chrome 发送`mousewheel`-events 与`ev.ctrlKey===true`
*   Mozilla 正在讨论匹配 chrome 行为：[https ://bugzilla.mozilla.org/show_bug.cgi?id=1052253](https://bugzilla.mozilla.org/show_bug.cgi?id=1052253)
*   在现代 Safari (>9.1) 中，可以使用手势事件：[https](https://developer.apple.com/library/archive/releasenotes/General/WhatsNewInSafari/Articles/Safari_9_1.html) ://developer.apple.com/library/archive/releasenotes/General/WhatsNewInSafari/Articles/Safari_9_1.html和[https://developer.apple.com/文档/webkitjs/gestureevent](https://developer.apple.com/documentation/webkitjs/gestureevent)
*   Edge 根本不可能处理它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-29T22:06:55.717

触摸板不会触发与触摸相关的事件（但通常会控制鼠标指针。由于显而易见的原因，这不会受到网站的影响），因此这是不可能的。

如果在触摸板上完成的手势具有非标准行为，这通常由触摸板的驱动程序/软件完成。

# .htaccess - .htaccess 删除 URL 的百分比编码部分

> ID：14086338
> 
> 赞同：0
> 
> 时间：2012-12-29T22:04:02.787
> 
> 标签：.htaccess, url-rewriting

我的问题与[这个](https://stackoverflow.com/questions/4534227/how-can-i-remove-percent-encoded-slashes-using-htaccess-rule)问题类似，只是我希望能够切断 URL 的百分比编码部分。例如改变

```
http://www.example.com/filename.html%20 
```

到

```
http://www.example.com/filename.html 
```

我曾经做过简单的 301 重定向，但它们似乎不适用于百分比：

> ~~重定向 301 /filename.html%20 [http://www.example.com/filename.html](http://www.example.com/filename.html)~~

因此它必须是一个 .htaccess 规则。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:08:16.820

试试这个：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^%]+)\%
RewriteRule .* http://www.example.com/%1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T17:36:59.787

毕竟，这对我有用：

```
RewriteRule ^(.+)%.* http://www.example.com/$1 [R=301,NC,L] 
```

感谢@KingKongFrog 的帮助！

# android - 更改 Android 手机中的通话记录

> ID：14086347
> 
> 赞同：0
> 
> 时间：2012-12-29T22:06:45.077
> 
> 标签：android, logging, call, smartphone

三星 Galaxy Note 手机中的通话记录会根据日期显示通话记录。它变得非常冗长并占用大量空间，并且日志只能容纳有限数量的通话记录。如果我们根据数字更改日志并显示每个数字的日期详细信息，这将非常有用。

这是否可能，如果可以，如何以及需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:10:34.057

欢迎您编写自己的通话记录应用程序，使用`CallLog` `ContentProvider`作为您的数据源。

您无法更改三星 Galaxy Note 中现有的通话记录应用程序，除非成为三星员工并使用该应用程序，或者将 ROM 完全替换为包含您喜欢的通话记录应用程序的某些 ROM 模块。

# javascript - 在nodejs异步中将参数传递给forEach Iterator

> ID：14086351
> 
> 赞同：0
> 
> 时间：2012-12-29T22:07:02.860
> 
> 标签：javascript, node.js, coffeescript, async.js

我正在尝试将参数传递给异步节点模块所需的迭代器函数。

```
async.forEach dbReply, mediaHandler(entry, event.folder, callback), (error) ->
   console.log error 

mediaHandler = (entry, folder, callback) ->
   console.log arguments 
```

我经常得到 ReferenceError: entry is not defined

关于如何将 event.folder 参数传递给函数的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:27:08.843

Sounds like you want your `mediaHandler` function to return an iterator function:

```
mediaHandler = (folder, callback) ->
    (entry) ->
        # Do things with folder, callback, and entry.
        # folder and callback are available through the closure,
        # entry is supplied by forEach. 
```

and then:

```
async.forEach dbReply, mediaHandler(event.folder, callback), (error) -> ... 
```

Your `entry` argument is supplied by `forEach` when it calls the iterator but the other two arguments are (presumably) available when you're calling `async.forEach` so you're trying to curry a three argument `mediaHandler` to get a one argument function that `forEach` can deal with; there are other ways to do that in (Coffee|Java)Script but doing it by hand with a closure is probably the simplest.

# objective-c - 为架构 armv7s 添加 HTMLParser 库未定义符号：

> ID：14086354
> 
> 赞同：1
> 
> 时间：2012-12-29T22:07:28.427
> 
> 标签：objective-c, xcode

我按照[此处](https://github.com/zootreeves/Objective-C-HMTL-Parser)的说明为 HTMLParser 添加了一个库。

但是，我收到以下错误：

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_HTMLParser", referenced from: 
```

我在 stackoverflow 中阅读了很多答案，但找不到解决方案。

我为 iphone 和 ipad 开发并使用 xcode 4.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:05:21.733

你说你使用 ARC，但 HTMLParser 没有，所以如果你没有得到错误来编译它，它不会被包含和编译，因此在链接时丢失。

请参阅：[如何为项目中的单个文件禁用 ARC？](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)

# javascript - 防止构造函数的多个实例共享相同的原型属性

> ID：14086358
> 
> 赞同：4
> 
> 时间：2012-12-29T22:07:59.933
> 
> 标签：javascript, inheritance, prototype

就在我认为我已经掌握了 JavaScript 中原型继承的工作原理时，我遇到了一个我之前没有考虑过的问题。

看一下以下简单的 JavaScript 代码：

```
var Observable = function () {
  this.events = [];
};

Observable.prototype.addEvent = function (e) {
  this.events.push(e);
};

var Model = function () {};
Model.prototype = new Observable();

var appModel = new Model();
var taskModel = new Model();

appModel.addEvent('Hello');
taskModel.addEvent('World'); 
```

查看其中一个`appModel.events`或`taskModel.events`产生相同的数组：`['Hello', 'World']`. 我想做的是让每个新`Model`的都有自己的`events`阵列，尽可能干净。以下实施`Model`作品：

```
var Model = function () {
  this.events = [];
};
Model.prototype = new Observable(); 
```

然而，随着更多的属性被添加到`Observable`这变得更加笨拙。我想我可以按如下方式解决这个问题：

```
var Model = function () {
  this.prototype.constructor.apply(this, arguments);
};
Model.prototype = new Observable(); 
```

尽管我确信那些在 JavaScript 方面更有经验的人意识到这会引发错误：`TypeError: Cannot read property 'constructor' of undefined`.

总之，我正在寻找一种方法让每个新`Model`的继承属性，`Observable`并让每个新`Model`的`events`. 我意识到这非常类似于类，但我想知道如何仅使用基于 JavaScript 原型的继承来做到这一点。

值得注意的是，我查看了 Dean Edward 的 Base.js。以下作品：

```
var Observable = Base.extend({
  constructor: function () {
    this.events = [];
  },
  addEvent: function (e) {
    this.events.push(e);
  }
});

var Model = Observable.extend({
  constructor: function () {
    this.base();
  }
});

var appModel = new Model();
var taskModel = new Model();

appModel.addEvent('Hello');
taskModel.addEvent('World'); 
```

但以下*没有*：

```
var Observable = Base.extend({
  events: [],
  addEvent: function (e) {
    this.events.push(e);
  }
});

var Model = Observable.extend({
  constructor: function () {
    this.base();
  }
});

var appModel = new Model();
var taskModel = new Model();

appModel.addEvent('Hello');
taskModel.addEvent('World'); 
```

除此之外，我想学习如何在不使用类库的情况下使用 JavaScript 原型来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:28:56.260

What I have understood here is that you want each instance to have their separate events array, If so follow the answer:

```
function Model(){
  this.events = [];
  this.addEvent = function(eventName){
    this.events.push(eventName);
  };
  this.getEvents = function(){
    return this.events;
  }
}

var m1 = new Model;
var m2 = new Model;
m1.addEvent("eve-1");
m2.addEvent("eve-2");
m1.getEvents(); //["eve-1"]
m2.getEvents(); //["eve-2"] 
```

In your case you are adding events directly to the `prototype` not the instances hence they are added across all the instances...I hope this should help

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:18:03.543

我试过这个来解决我的问题：

```
var Model = function () {
  this.prototype.constructor.apply(this, arguments);
};
Model.prototype = new Observable(); 
```

实际的解决方案是这样做：

```
var Model = function () {
  Model.prototype.constructor.apply(this, arguments);
};
Model.prototype = new Observable(); 
```

这将为每个人`Model`提供自己的`events`数组，并为每个人提供构造函数创建`Model`的任何其他属性。`Observable`这里的小开销`Model.prototype.events`是一个永远不会访问的空数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-21T23:10:54.013

你的第一段代码导致每个实例`Model`都有一个公共`events`数组的原因是因为它们有一个对单个公共实例的原型引用`Observable`。换句话说，通过做

```
Model.prototype = new Observable(); 
```

您基本上是在告诉 JavaScript “使所有实例的`Model`行为都像**这个特定的实例**” `Observable`。

有几种不同的方法可以在 JavaScript 中正确执行原型继承。如果您可以使用最近标准化的 ECMAScript 6，您可以使用为此目的而设计的方便的 new`class`和关键字。`extends`

```
class Observable {
    constructor() {
        this.events = [];
    }

    addEvent() {
        this.events.push(e);
    }
}

class Model extends Observable {
    // Model definition
}; 
```

不幸的是，对 ECMAScript 6 的支持仍然[不是很好](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#Browser_compatibility)。ECMAScript 5 添加了[Object.create](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create)，这一直是继承的首选方法（至少据我所知）。

```
var Observable = function () {
    this.events = [];
};

Observable.prototype.addEvent = function (e) {
    this.events.push(e);
};

var Model = function () {
    Observable.call(this);
};
Model.prototype = Object.create(Observable.prototype); 
```

MDN 有一篇关于使用这种技术在 JavaScript 中的 OOP的非常好的[文章。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript)

# c++ - 如何设置 Visual Studio 2010 项目来为 Slickedit 17 构建 64 位扩展 dll？

> ID：14086359
> 
> 赞同：1
> 
> 时间：2012-12-29T22:08:14.473
> 
> 标签：c++, visual-studio-2010, makefile, nmake, slickedit

我正在迁移到 Windows 7，进入*Slickedit 17* **64 位**，并有一个旧的 32 位 Slickedit 扩展 DLL，我需要将其重新创建为 64 位。这个 DLL 基本上是一堆 WinAPI 调用的包装器。

Slickedit 附带一个示例 32 位“simple.dll”项目 (ahem)，它只是一个 makefile。我需要知道如何设置 Visual Studio 项目以使用 Slickedits 库构建 64 位 DLL。

提供的makefile如下：

```
# This makefile supports the following Visual C++ versions: 
# 7.10 (Visual Studio 2003), 8.00 (Visual Studio 2005),
# and 9.00 (Visual Studio 2008)
#
# Nmake macros for building Windows 32-Bit apps
!include <Win32.mak>

# Set linkdebug to nothing to link DLL without debug
#linkdebug=

DLLNAME=simple
cflags=$(cflags) -D_WINDOWS -I..\..\h

all: $(DLLNAME).lib $(DLLNAME).dll

# Update the object files if necessary

$(DLLNAME).obj: $(DLLNAME).cpp
    $(cc) $(cflags) $(cvarsmt) $(cdebug) -Tp $*.cpp

# Update the import library

$(DLLNAME).lib: $(DLLNAME).obj $(DLLNAME).def
    $(implib) -machine:$(CPU) \
    -def:$(DLLNAME).def $*.obj -out:$*.lib

# Update the dynamic link library

LIBDIR=lib
$(DLLNAME).dll: $(DLLNAME).obj $(DLLNAME).def makefile
    $(link) $(linkdebug) \
    -NODEFAULTLIB:libc -base:0x1C000000  \
    -dll -entry:_DllMainCRTStartup$(DLLENTRY) \
    -out:$*.dll  \
    $*.exp $*.obj ..\..\$(LIBDIR)\dllmain.obj ..\..\$(LIBDIR)\vsapi.lib ..\..\$(LIBDIR)\secommon.lib $(conlibsmt)

clean :
    del $(DLLNAME).dll $(DLLNAME).obj $(DLLNAME).pdb $(DLLNAME).ilk 
```

Makefiles 不是我的东西，而且无论如何这个设置为 32 位。那么如何设置一个 Studio 项目来处理这种类型的 C++ 构建。我有：

*   C:\se17\lib\dllmain.obj
*   C:\se17\lib\secommon.lib
*   C:\se17\lib\tagsdb.lib
*   C:\se17\lib\vsapi.lib

以及 C:\se17\h 中提供的头目录

我之所以这么问，是因为我对在 community.slickedit.com 上获得体面的回应持怀疑态度，无论如何上帝都爱他们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:19:28.850

You need to tell the linker that your DLL target is 64-bit. That's done by `/MACHINE:X64` on the linker line. I'd just add it afer "$(linkdebug)".

You will also need to set the compiler to point to the amd64 version, which is explained in this question: [How do you compile 32-bit and 64-bit applications at the same time in Visual Studio for C/C++ in a makefile?](https://stackoverflow.com/questions/5807647/how-do-you-compile-32-bit-and-64-bit-applications-at-the-same-time-in-visual-stu)

# machine-learning - 在 RapidMiner 中更改特征值类型

> ID：14086364
> 
> 赞同：1
> 
> 时间：2012-12-29T22:08:54.413
> 
> 标签：machine-learning, data-mining, rapidminer

我有一个包含许多属性（2k）的数据集，其中一些（大约 10 个）不是二进制的，其余的是二进制的（0,1），我想将这些二进制属性的值类型从 integer 更改为 binomial ，如功能的名称不固定我想根据它们的值来做！（即将值为0,1的所有属性的值类型从整数更改为二项式）

在 Rapid Miner 中是否有任何直接的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T15:16:35.423

使用`Integer to binomial`运算符怎么样？`numeric_value_filter`例如，您可以通过（运算符中的选项之一）选择所需的属性。

# arrays - 非法字符串偏移 'option 1'

> ID：14086365
> 
> 赞同：2
> 
> 时间：2012-12-29T22:09:00.020
> 
> 标签：arrays, string, php

这是我的初始代码：

```
 $camp_price=array(
   'option 1' => array(
                    'id' => 'June 30 to July 20',
                    'weeks' => 3,
                    'week_price' => 995),
   'option 2' => array(
                    'id' => 'June 30 to July 13',
                    'weeks'=> 2,
                    'week_price' => 995)
  ); 

 foreach ($camp_price as $name=>$values) {
$total_cost[$name]=$values['weeks'] * $values['week_price'];
} 
```

这是HTML代码。它完美地呼应了 $total_cost 直到表单被提交。然后它显示错误：

> 警告：非法字符串偏移“选项 1”

我不明白：

```
 <select name="preferred_session">
  <option value="option 1" <?php if($preferred_session =='option 1') echo'selected="selected"'; ?>>
 <?php echo $camp_price['option 1']['id'],': ', $total_cost['option 1']; ?>euros
 </option>
 <option value="2" <?php if($preferred_session =='option 2') echo 'selected="selected"'; ?>>
 <?php echo $camp_price['option 2']['id'],': ', $total_cost['option 2']; ?>euros
 </option>
</select> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:11:47.740

看起来，当触发错误的代码运行时，要么`$camp_price`不是`$total_cost`数组而是字符串。

您可能希望在错误发生点之前打印这些变量的值，并查找您可能无意中更改了它们的任何地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:11:57.043

> 警告：非法字符串偏移“选项 1”

此错误意味着您使用的`'option 1'`是非法的字符串偏移量（此处为：）。字符串偏移量必须是正数，而不是字符串。

这最常发生在您访问字符串变量但您认为它是一个数组时：（[Demo](http://eval.in/5552)）

```
<?php

$total_cost = 'string value';

echo $total_cost['option 1']; 
```

给出错误（和输出）：

```
Warning: Illegal string offset 'option 1' in /demo.php on line 5
s 
```

最后`s`是因为使用`$total_cost[0]`了非法偏移量。按照[PHP 的字符串子串访问](http://php.net/language.types.string#language.types.string.substr)[^(*Docs*)](http://php.net/language.types.string#language.types.string.substr)的规则，这是第一个字符：`'option 1'``0`[](http://php.net/language.types.string#language.types.string.substr)

 *```
string value
s
^---- character 0: substr($total_cost, 0, 1);
                                       ^ 
```*

# javascript - 如何将 jquery 模板文件作为外部模板文件保存，每个文件中有多个模板？

> ID：14086370
> 
> 赞同：1
> 
> 时间：2012-12-29T22:10:21.633
> 
> 标签：javascript, jquery, html, jquery-templates

我正在尝试保存一个充满模板的文件，这些模板可以在页面加载时加载到页面中。这真的可能吗？让我告诉你我的意思：

**通常**，我们这样做：

```
<script id = "template1" type= "text/x-jquery-tmpl">BLAH</script>
<script id = "template2" type= "text/x-jquery-tmpl">BLAH</script>
<script id = "template3" type= "text/x-jquery-tmpl">BLAH</script> 
```

**相反**，我们怎么能做这样的事情

```
<script id = "all_templates" type= "text/x-jquery-tmpl">TEMPLATE1, TEMPLATE2, TEMPLATE3</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T22:11:33.360

不，但是您可以简单地使用 AJAX 请求来加载包含单独`<script>`模板的页面，然后使用普通的 jQuery DOM 函数来访问它们：

```
var templates = {};
$.ajax({
    url: 'templates.html',
    dataType: 'html',
    success: function(data) {
        $('script', data).each(function() {
            templates[this.id] = $(this).text();
        });
    }
}); 
```

但是，更简洁的解决方案是将您的模板转换为服务器端的单个 JSON 对象并加载该对象。

# jquery - JQuery可折叠表不起作用

> ID：14086373
> 
> 赞同：0
> 
> 时间：2012-12-29T22:10:39.830
> 
> 标签：jquery

我在我的 JQuery 代码中需要一些帮助，我似乎无法理解我哪里出错了。这是一个简单的“**父母**”和“**孩子**”风格的折叠桌。因此，首先隐藏所有“**孩子**”，如果您单击“**父母**” ，它会显示所有**孩子**。我的代码的问题是，当我单击**父**级时，它的所有子级也会显示在所有其他父级中。谢谢

```
 $(document).ready(function() {
 $("#report tr:odd").addClass("odd");
 $("#report tr:not(.odd)").hide();
 $("#report tr:first-child").show();

 $('location.href').click(function() {
    $.ajax({
    type : 'GET',
    url : 'Test',
    data : '${cat.categoryId}',
 success : function(response) {
    $('ul').html(response);
    $("#report tr.odd").next("tr").toggle();
    }
     });
   });
 }); 
```

JSP

```
<c:if test="${!empty categoryList}">
 <table id="report">
    <tr>
        <th>Category Name</th>
    </tr>
        <c:forEach items="${categoryList}" var="cat">
        <tr onclick="location.href='${cat.categoryId}'" >
            <td>${cat.categoryName}</td>
            <td><div class="arrow"></div></td>
        <tr>
            <td colspan="5">
            <c:forEach items="${prodList}" var="prod">
            <ul>
                <li>${prod.productName}</li>
            </ul>
            </c:forEach>
        </tr>
    </c:forEach>
 </table>
</c:if> 
```

控制器

```
 @RequestMapping(value="{Id}", method = RequestMethod.GET)
public String showProductByCatId(@PathVariable("Id") Integer Id, Model model){
    List<Product> prod = purchaseOrderService.listProductsByCatId(Id);
    model.addAttribute("prodList", prod);
    model.addAttribute("categoryList",purchaseOrderService.listCategory());
    return "Test";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:31:16.030

The `#report tr.odd` in

```
$("#report tr.odd").next("tr").toggle(); 
```

will match all odd rows, you need to select only the clicked row with something like this

```
 $('#report tr.odd').click(function() {
      var child = $(this).next('tr');

      $.ajax({
           type : 'GET',
           url : 'Test',
           data : '${cat.categoryId}',
           success : function(response) {
                child.find('ul').html(response);
                child.toggle();
           }
      });
 }); 
```

**EDIT:** You need to select the right `<ul>` as well, I've updated the code above.

# android - getFromLocationName 返回的地址很少或搜索不准确

> ID：14086374
> 
> 赞同：2
> 
> 时间：2012-12-29T22:10:40.640
> 
> 标签：android

我正在尝试使用 getFromLocationName 但即使 MAX 地址设置为 30，它也会返回 1 个或很少的地址。我也通过广泛搜索（输入花旗）对其进行了测试，但我只得到了一个无关紧要的地址。我想知道是否有人遇到过这个问题，或者这个功能是否有任何错误。

# android - 如何优化画布上的绘图文本

> ID：14086375
> 
> 赞同：1
> 
> 时间：2012-12-29T22:10:52.963
> 
> 标签：android, android-canvas

我有 3 个圆圈的窗口，它们同时旋转。一切都很好，直到向圆圈添加文本，然后旋转开始滞后。

![主窗口](../Images/e75301cf096e19d887b29380a70d6004.png)

如何优化画布上的绘图？这是我的代码：

```
@Override
protected void onDraw(final Canvas canvas) {
    if (mPaint == null) {
        mPaint = new Paint();
        mPaint.setTextSize(20f);
    }       
    drawUpperCircle(canvas);
    drawBottomCircle(canvas);
    drawMainCircle(canvas);

    try {
        Thread.sleep(1, 1);
        invalidate();
        mRotation += 0.9;
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    super.onDraw(canvas);
}
   private void drawUpperCircle(Canvas canvas) {
    canvas.save();
    canvas.rotate(mRotation, 0, mUpperCircleCentr);
    mPaint.setColor(Color.CYAN);
    canvas.drawCircle(0, mUpperCircleCentr, mUpperCirclRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, 0, mUpperCircleCentr);
        canvas.drawLine(0, mUpperCircleCentr, mUpperCirclRadius, mUpperCircleCentr, mPaint);
        //          canvas.drawText("my text" + String.valueOf(i), mUpperCirclRadius * 2 / 3, mUpperCircleCentr - 4, mPaint);
    }
    canvas.restore();
}

private void drawBottomCircle(Canvas canvas) {
    canvas.save();
    canvas.rotate(mRotation, 0, mBottomCircleCentr);
    mPaint.setColor(Color.RED);
    canvas.drawCircle(0, mBottomCircleCentr, mBottomCirclRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, 0, mBottomCircleCentr);
        canvas.drawLine(0, mBottomCircleCentr, mBottomCirclRadius, mBottomCircleCentr, mPaint);
        //          canvas.drawText("my text" + String.valueOf(i), mBottomCirclRadius * 2 / 3, mBottomCircleCentr - 4, mPaint);
    }
    canvas.restore();
}

private void drawMainCircle(Canvas canvas) {
    canvas.save();
    canvas.rotate(mRotation, 0, mMainCircleCentr);
    mPaint.setColor(Color.argb(100, 100, 100, 100));
    canvas.drawCircle(0, mMainCircleCentr, mMainCirclRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, 0, mMainCircleCentr);
        canvas.drawLine(0, mMainCircleCentr, mMainCirclRadius, mMainCircleCentr, mPaint);
        canvas.drawText("my text" + String.valueOf(i), mMainCirclRadius * 2 / 3, mMainCircleCentr - 4, mPaint);
    }
    canvas.restore();
} 
```

**编辑** 为了提高性能并从 UI 线程中删除绘图，我使用了双缓冲`SurfaceView`并实现了 @Morgans 优化。它就是这样实现的。

*绘图视图.java*

```
public class DrawView extends SurfaceView implements SurfaceHolder.Callback {

...............................................................

public DrawView(Context context, AttributeSet attrs) {
    super(context, attrs);
    getHolder().addCallback(this);
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    float currentX = event.getX();
    float currentY = event.getY();
    float deltaX, deltaY;
    switch (event.getAction()) {
    case MotionEvent.ACTION_MOVE:
        // Modify rotational angles according to movement
        deltaX = currentX - previousX;
        deltaY = currentY - previousY;
        mDrawThread.mRotation += deltaY * 180 / getHeight();
    }
    // Save current x, y
    previousX = currentX;
    previousY = currentY;
    return true; // Event handled
}

@Override
public void surfaceChanged(SurfaceHolder surfaceHolder, int format, int width, int height) {

}

@Override
public void surfaceCreated(SurfaceHolder surfaceHolder) {
    mDrawThread = new DrawThread(getHolder(), this);
    mDrawThread.setRunning(true);
    mDrawThread.start();
}

@Override
public void surfaceDestroyed(SurfaceHolder surfaceHolder) {
    boolean retry = true;
    mDrawThread.setRunning(false);
    while (retry) {
        try {
            mDrawThread.join();
            retry = false;
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
 } 
```

并且主要工作是在*DrawThread.java中完成的*

```
public class DrawThread extends Thread {

private ArrayList<Path> mMainCirclePaths = new ArrayList<Path>(SEG_COUNT);
private ArrayList<Path> mUpperCirclePaths = new ArrayList<Path>(SEG_COUNT);
private ArrayList<Path> mCenterCirclePaths = new ArrayList<Path>(SEG_COUNT);
private ArrayList<Path> mBottomCirclePaths = new ArrayList<Path>(SEG_COUNT);

private boolean mRun = false;
private SurfaceHolder mSurfaceHolder;
private DrawView mDrawView;
private Paint mPaint;

private CirclesModel mCirclesModel;
public float mRotation = 0;

public DrawThread(SurfaceHolder surfaceHolder, DrawView drawView) {
    mSurfaceHolder = surfaceHolder;
    mDrawView = drawView;
    mCirclesModel = new CirclesModel(mDrawView.getHeight());
    mPaint = new Paint(Paint.ANTI_ALIAS_FLAG);
    mPaint.setTextSize(18f);
    initPaths();
}

public void setRunning(boolean b) {
    mRun = b;
}

@Override
public void run() {
    while (mRun) {
        Canvas canvas = null;
        try {
            canvas = mSurfaceHolder.lockCanvas(null);
            synchronized (mSurfaceHolder) {
                drawMainCircle(canvas);
                mPaint.setColor(Color.WHITE);
                canvas.drawCircle(mCirclesModel.mMainCircleCentr[CirclesModel.X], mCirclesModel.mMainCircleCentr[CirclesModel.Y],
                        mCirclesModel.mSmallCirclesRadius, mPaint);
                drawCenterCircle(canvas);
                drawUpperCircle(canvas);
                drawBottomCircle(canvas);
                //mRotation += 0.5f;

            }
        } finally {
            if (canvas != null) {
                mSurfaceHolder.unlockCanvasAndPost(canvas);
            }
        }
    }
}

private void drawMainCircle(Canvas canvas) {
    canvas.save();
    canvas.rotate(mRotation, mCirclesModel.mMainCircleCentr[CirclesModel.X], mCirclesModel.mMainCircleCentr[CirclesModel.Y]);
    float rot = mRotation;
    mPaint.setColor(Color.LTGRAY/* argb(100, 255, 255, 255) */);
    canvas.drawCircle(mCirclesModel.mMainCircleCentr[CirclesModel.X], mCirclesModel.mMainCircleCentr[CirclesModel.Y],
            mCirclesModel.mBigCirclesRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, mCirclesModel.mMainCircleCentr[CirclesModel.X], mCirclesModel.mMainCircleCentr[CirclesModel.Y]);
        rot += SEG_IN_GRAD;
        float absRot = Math.abs(rot % 360);
        if (absRot > mCirclesModel.mMainCircleSegment[0] && absRot < mCirclesModel.mMainCircleSegment[1]) {
            continue;
        }
        canvas.drawLine(mCirclesModel.mMainCircleCentr[CirclesModel.X], mCirclesModel.mMainCircleCentr[CirclesModel.Y],
                mCirclesModel.mBigCirclesRadius, mCirclesModel.mMainCircleCentr[CirclesModel.Y], mPaint);
        canvas.drawPath(mMainCirclePaths.get(i), mPaint);
        // canvas.drawText("my text" + String.valueOf(i),
        // mMainCirclRadius * 2 / 3, mMainCircleCentr - 4, mPaint);
    }
    canvas.restore();
}
   .................................................................
} 
```

双缓冲在两行代码中实现

`canvas = mSurfaceHolder.lockCanvas(null);`在这里，我取自将在其中绘制下一帧的表面视图画布。

`mSurfaceHolder.unlockCanvasAndPost(canvas);`在这里，我将 SurfaceView 上的当前图像与新的 canwas 重叠，这是图像发生变化的时刻。请注意，如果您有透明元素，那么之前的图像仍然可见，图像不会被替换，而是重叠。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T00:44:01.220

下面是包含一些优化的代码版本。

首先，我尽量不绘制当前屏幕外的线条和文本。我通过跟踪旋转角度并跳过 90 到 270 度之间的净旋转的绘图来做到这一点。在我的 2.3 模拟器上，整体性能提高了 25%。

其次，我“缓存”要绘制的字符串，方法是初始化一个数组`ArrayList<Path>`（`Path`我在您一次性初始化`mPaint`. 然后我使用 canvas.drawPath(...) 绘制字符串。在我的 2.3 模拟器上，这又将性能提高了 33%。净效果是使旋转速度增加一倍左右。此外，它阻止了文本“摆动”。

其他一些注意事项：

我删除了`Thread.sleep(1,1)`. 不知道你到底想用它来完成什么。

我将旋转增量从 0.9 更改为 1.0。不知道你为什么使用 0.9。请注意，如果您更改为 back，我的“旋转 10 度所需的日志时间”将无法正常工作，因为`mRotation % 10`可能很少为 0。

在 4.1 模拟器上，旋转通常比我的 2.3 模拟器快得多（大约 4 倍）。4.1 的设备速度更快。

```
public class AnimView extends View {
Paint mPaint;
ArrayList<Path> mTextPaths;

float mRotation = 0f;

float mUpperCircleCentr = 150f;
float mUpperCirclRadius = 150f;

private static final int SEG_COUNT = 60;
private static final float SEG_IN_GRAD = 360.0f / SEG_COUNT;

float mBottomCircleCentr = 450f;
float mBottomCirclRadius = 150f;

float mMainCircleCentr = 300f;
float mMainCirclRadius = 300f;

long mLastMillis = 0L;

// ctors removed

@Override
protected void onDraw(final Canvas canvas) {
    super.onDraw(canvas);

    if (mPaint == null) {
        mPaint = new Paint();
        mPaint.setTextSize(20f);

        // init text paths
        mTextPaths = new ArrayList<Path>(SEG_COUNT);
        for (int i = 0; i < SEG_COUNT; i++) {
            Path path = new Path();
            String s = "my text" + String.valueOf(i);
            mPaint.getTextPath(s, 0, s.length(), mMainCirclRadius * 2 / 3, mMainCircleCentr - 4, path);
            path.close(); // not required on 2.2/2.3 devices
            mTextPaths.add(path);
        }
    }
    if (mLastMillis == 0L) {
        mLastMillis = System.currentTimeMillis();
    }

    drawUpperCircle(canvas);
    drawBottomCircle(canvas);
    drawMainCircle(canvas);

    invalidate();

    if (((int) mRotation) % 10 == 0) {
        long millis = System.currentTimeMillis();
        Log.w("AnimateCanvas", "OnDraw called with mRotation == " + mRotation);
        Log.w("AnimateCanvas", "Last 10 degrees took millis: " + (millis - mLastMillis));
        mLastMillis = millis;
    }
}

private void drawUpperCircle(Canvas canvas) {
    canvas.save();
    canvas.rotate(mRotation, 0, mUpperCircleCentr);
    float rot = mRotation;
    mPaint.setColor(Color.CYAN);
    canvas.drawCircle(0, mUpperCircleCentr, mUpperCirclRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, 0, mUpperCircleCentr);
        rot += SEG_IN_GRAD;
        if (rot % 360 > 90 && rot % 360 < 270)
            continue;
        canvas.drawLine(0, mUpperCircleCentr, mUpperCirclRadius, mUpperCircleCentr, mPaint);
    }
    canvas.restore();
}

private void drawBottomCircle(Canvas canvas) {
    canvas.save();
    canvas.rotate(mRotation, 0, mBottomCircleCentr);
    float rot = mRotation;
    mPaint.setColor(Color.RED);
    canvas.drawCircle(0, mBottomCircleCentr, mBottomCirclRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, 0, mBottomCircleCentr);
        rot += SEG_IN_GRAD;
        if (rot % 360 > 90 && rot % 360 < 270)
            continue;
        canvas.drawLine(0, mBottomCircleCentr, mBottomCirclRadius, mBottomCircleCentr, mPaint);
    }
    canvas.restore();
}

private void drawMainCircle(Canvas canvas) {
    canvas.save();

    canvas.rotate(mRotation, 0, mMainCircleCentr);
    float rot = mRotation;
    mPaint.setColor(Color.argb(100, 100, 100, 100));
    canvas.drawCircle(0, mMainCircleCentr, mMainCirclRadius, mPaint);
    mPaint.setColor(Color.BLACK);
    for (int i = 0; i < SEG_COUNT; i++) {
        canvas.rotate(SEG_IN_GRAD, 0, mMainCircleCentr);
        rot += SEG_IN_GRAD;
        if (rot % 360 > 90 && rot % 360 < 270)
            continue;
        canvas.drawLine(0, mMainCircleCentr, mMainCirclRadius, mMainCircleCentr, mPaint);
        canvas.drawPath(mTextPaths.get(i), mPaint);
        // canvas.drawText("my text" + String.valueOf(i), mMainCirclRadius * 2 / 3, mMainCircleCentr - 4, mPaint);
    }
    canvas.restore();
}
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T22:27:34.560

您的代码非常漂亮和简单。您可以通过使用更少的循环来优化它，例如将所有东西绘制在一起或组合变量，但这很快就会变得混乱。

我建议您保持绘图代码或多或少相等。您实际上并没有做最糟糕的事情：实例化对象，而且它清晰且易于维护。

但是您也许可以尝试使用双缓冲区：在 ram 中绘制缓冲区并在屏幕上一次翻转缓冲区。这通常可以很好地获得恒定的动画速度。使用画布的锁定和解锁：[在 Android 上使用画布和表面视图在 Java 中进行双缓冲](https://stackoverflow.com/q/6538423/693752)

# javascript - 奇怪的浏览器描述 PyQt

> ID：14086376
> 
> 赞同：2
> 
> 时间：2012-12-29T22:10:54.853
> 
> 标签：javascript, python, qt, pyqt, qtwebkit

我试图使用 JavaScript 获取浏览器描述，结果很奇怪：

```
productSub: 20100101 # When I open it with my Mozila FF browser
productSub: 20030107 # when I open it with PyQt4

vendorSub: # nothing in here with my Mozila FF
vendorSub: Apple Computer, Inc. # with PyQt4 ( even though I don't have anything to do with Apple) 
```

这是 HTML/JS：

```
<!DOCTYPE HTML>
<html>
<head>
</head>
<body>
<p id="myp">Hi</p>

<script>
    body = document.getElementsByTagName('body')[0];
    var nav_div = document.createElement('div');
    nav_div.id = 'nav_div';
    for (para in navigator) {
        var para_p = document.createElement('p');
        var context = document.createTextNode(para + ': ' + navigator[para]);
        para_p.appendChild(context);
        para_p.id = para;
        nav_div.appendChild(para_p);
    }
    body.appendChild(nav_div);
</script>
</body>
</html> 
```

这是 Python/PyQt4 代码：

```
#! /usr/bin/env python2.7

from PyQt4.QtCore import *
from PyQt4.QtGui import *
from PyQt4.QtWebKit import *
import sys, signal

class MySettings(QWebPage):
    def userAgentForUrl(self, url):
        return 'Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:17.0) Gecko/20100101 Firefox/17.0'

class Opener(QWebView):
    def __init__(self):
        QWebView.__init__(self)
        url = QUrl('/home/john-the-ripper/JavaScript/w.html')
        self.setPage(MySettings())
        self.load(url)
        self.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    opener = Opener()
    # press Ctrl + C for exit
    if signal.signal(signal.SIGINT, signal.SIG_DFL):
        sys.exit(app.exec_())
    app.exec_() 
```

如您所见，我已经定义了与我的机器中相同的用户代理：

```
userAgent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:17.0) Gecko/20100101 Firefox/17.0 
```

# **这是 PyQt4 的结果：**

![PyQt4](../Images/58c014dee25e32dedfdd7d7e3024919f.png)

# **这是我的原生浏览器 Mozila Fire Fox 的结果：**

![法郎](../Images/d024eba111fdc037400f3d055fddbdd3.png)

所以问题是：

1.  为什么`productSub`看起来不同，即使我已经在`userAgentForUrl()`
2.  为什么当我用 PyQt4 打开这个页面时，`vendorSub`是`Apple Computer, Inc.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T17:05:47.433

一种可能的解决方法是重新定义`navigator`对象。首先，将页面主框架中的[javaScriptWindowObjectCleared信号连接到插槽：](http://doc.qt.digia.com/qt/qwebframe.html#javaScriptWindowObjectCleared)

```
connect(myPage->mainFrame(), SIGNAL(javaScriptWindowObjectCleared()),
  this, SLOT(tweakNavigatorObject())); 
```

在您的插槽中，执行一些可以完全重新定义对象的脚本（[QWebFrame::evaluateJavaScript](http://doc.qt.digia.com/qt/qwebframe.html#evaluateJavaScript)），例如

```
window.navigator = {
  appCodeName: 'Mozilla',
  appName: 'Netscape',
  vendor: 'My Company'
} 
```

仅供参考，这是我在 PhantomJS 中使用的技巧，它提供了在页面脚本执行之前操纵全局对象的能力，例如对[操纵 Math.random](http://ariya.ofilabs.com/2011/09/water-lily.html)行为和检测[用户代理嗅探](http://ariya.ofilabs.com/2011/10/detecting-browser-sniffing-2.html)很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:27:29.927

谁说`navigator`对象中的信息完全基于`UserAgent`标头？该标头仅用于在检索 URL 时发送到服务器。是的，对象上的*某些*值`navigator`取自当前标头，但是，正如您所发现的，并非所有值都是如此，也不是它们的本意。

事实上，只有`appVersion`和`userAgent`字符串取自该标头，其他所有内容都反映了本机浏览器。

Qt 浏览器基于[WebKit](http://www.webkit.org/)，这是一个 Apple 项目，因此是供应商字符串。`navigator`当您在 Safari 中运行反射代码时，您可以看到：

```
geolocation: [object Geolocation]
cookieEnabled: true
language: en-us
productSub: 20030107
product: Gecko
appCodeName: Mozilla
mimeTypes: [object MimeTypeArray]
vendorSub:
vendor: Apple Computer, Inc.
platform: MacIntel
appName: Netscape
appVersion: 5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/536.26.17 (KHTML, like Gecko) Version/6.0.2 Safari/536.26.17
userAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/536.26.17 (KHTML, like Gecko) Version/6.0.2 Safari/536.26.17
plugins: [object PluginArray]
onLine: true
javaEnabled: function javaEnabled() { [native code] }
getStorageUpdates: function getStorageUpdates() { [native code] } 
```

Safari 让我`UserAgent`也可以从`Developer`菜单中切换标题。切换它也*只会*改变`appVersion`and`userAgent`字符串。`Firefox 11.0 — Mac`例如，切换到*将这*两个变量更改为：

```
appVersion: 5.0 (Macintosh; Intel Mac OS X 10.7; rv:11.0) Gecko/20100101 Firefox/11.0
userAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:11.0) Gecko/20100101 Firefox/11.0 
```

另一个基于 WebKit 的浏览器是 Chrome，它的`navigator`信息非常相似：

```
geolocation: [object Geolocation]
onLine: true
cookieEnabled: true
vendorSub:
vendor: Google Inc.
productSub: 20030107
product: Gecko
mimeTypes: [object MimeTypeArray]
plugins: [object PluginArray]
platform: MacIntel
userAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.101 Safari/537.11
language: en-US
appVersion: 5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.101 Safari/537.11
appName: Netscape
appCodeName: Mozilla
doNotTrack: null
javaEnabled: function javaEnabled() { [native code] }
getStorageUpdates: function getStorageUpdates() { [native code] }
webkitStartActivity: function webkitStartActivity() { [native code] } 
```

# java - 使用地图的 BFS >

> ID：14086377
> 
> 赞同：0
> 
> 时间：2012-12-29T22:11:06.367
> 
> 标签：java, breadth-first-search, adjacency-list

我正在尝试创建一个无向图，所以我使用下面的代码在执行后创建了一个图，我得到的输出是：

```
{1=[2, 5, 10, 18], 
 2=[1, 3], 3=[2, 4], 
 4=[3, 5], 5=[1, 4, 6], 
 6=[5, 7], 7=[6, 8], 
 8=[7, 9], 9=[8], 10=[1, 11], 
 11=[10, 12, 13, 11, 11], 
 12=[11, 19], 13=[11], 
 19=[12], 18=[1], 
 21=[22], 22=[21]} 
```

现在我尝试实现 BFS 以找到最短路径。我的问题是：如果可能的话，是否可以使用 hashmap 来实现 bfs？我该怎么做？或者我应该使用哪种方法代替 hashmap 是不可能的。

```
Map<Integer, ArrayList<Integer>> adj;

public Graph(ArrayList<String> nodes) {
    adj = new HashMap<Integer, ArrayList<Integer>>();
    for (int i = 0; i < nodes.size(); ++i) {
        adj.put(Integer.parseInt(nodes.get(i)), new ArrayList<Integer>());
        }
    }

public void addNeighbor(int v1, int v2) {
    adj.get(v1).add(v2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:19:39.633

> 如果可以的话，是否可以使用 hashmap 来实现 bfs 我该怎么做？或者我应该使用哪种方法代替 hashmap 是不可能的。

是的，这是可能的。您正在使用邻接列表。要实现 BFS，您将需要一个队列（Java 中有一个用于此的接口）。要遍历图表，您从队列中的单个节点开始，当此队列不为空时，您将获得下一个节点并将所有相邻节点添加到队列中，这里是您需要访问您的`Map`.

# applescript - 导致 stackoverflow 的简单 AppleScript——为什么？

> ID：14086385
> 
> 赞同：3
> 
> 时间：2012-12-29T22:12:00.797
> 
> 标签：applescript, stack-overflow

-- 我确定这是重复的 --

我在 O'reilly 的书中读到了这一点（：

虽然没有推理）：

在一个简单的 AppleScript 文件中：

```
script implicitRunHandlerScript
end script      

run implicitRunHandlerScript
      --    why does this lead to a stack overflow? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:41:01.997

您发布的脚本包含一个名为 的子脚本`implicitRunHandlerScript`和一个处理程序，即“隐式`run`处理程序”。隐式`run`处理程序包含一条语句：

```
run implicitRunHandlerScript 
```

子脚本继承其父脚本的处理程序。因此，您`implicitRunHandlerScript`继承了其父级的实现`run`处理程序。并且那个继承的隐式`run`处理程序调用 的`run`处理程序`implicitRunHandlerScript`，所以它递归地调用自己。

阅读*AppleScript 语言指南*中的在脚本对象中[定义脚本对象](https://developer.apple.com/library/mac/documentation/applescript/Conceptual/ApplescriptLangGuide/conceptual/ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW2)和[继承](https://developer.apple.com/library/mac/#documentation/applescript/Conceptual/ApplescriptLangGuide/conceptual/ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW5)。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:39:14.963

来自[AppleScript：权威指南：](https://rads.stackoverflow.com/amzn/click/com/0596102119)

> 如果脚本对象没有显式运行处理程序，并且在其隐式运行处理程序中没有可执行语句，那么告诉它运行可能会产生不可预知的后果（这个事实几乎可以肯定是一个错误）。*

# django - Django 关联 2 个模型

> ID：14086389
> 
> 赞同：0
> 
> 时间：2012-12-29T22:13:11.017
> 
> 标签：django

我不太确定如何通过谷歌找到这个，搜索并没有把我带到任何地方。

您如何以这样的方式关联 2 个模型，如果您在管理面板中删除一个条目，另一个将自动删除？

感谢您的任何帮助。

编辑：更新示例。我希望一个 Event 能够描述其他参赛者，并且与 Event 具有 OneToOne 关系的 Picture 应该是主要参赛者。所以一旦主要参赛者被删除，我也想删除事件。不幸的是，我不能只在 Event 中添加 ForeignKey 关系，否则会导致错误。那么，有没有办法为 OneToOne 关系做到这一点？

```
class Event(models.Model):
    competitors = models.ManyToManyField('Picture',null=True,blank=True)

class Picture(models.Model):
    competition = models.OneToOneField(Event) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T22:16:08.757

引用[django 文档](https://docs.djangoproject.com/en/dev/topics/db/queries/)：

> 当 Django 删除一个对象时，默认情况下它会模拟 SQL 约束 ON DELETE CASCADE 的行为——换句话说，任何具有指向要删除的对象的外键的对象都将与它一起被删除。

然后，这是默认行为。

有关详细信息，请参阅[on_delete](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.on_delete)选项：

```
user = models.ForeignKey(User, blank=True, null=True, on_delete=models.SET_NULL)
The possible values for on_delete are found in django.db.models:

CASCADE: Cascade deletes; the default.
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:29:29.997

假设您有两个模型：

```
class ModelA(models.Model):
    name = models.CharField(max_length=30)

class ModelB(models.Model):
    abc = models.CharField(max_length=30)
    model_a = models.ForeignKey(ModelA) 
```

现在让我们做一些工作示例：

```
modelAObj = ModelA.objects.create(name='aamir')
modelBObj = ModelB.objects.create(abc='cde', model_a=modelAObj)
modelAObj.delete() # this will also delete the modelBObj 
```

# logging - Azure - can not deploy -Windows Azure could not find the resource MyCustomLogs in the service package

> ID：14086390
> 
> 赞同：3
> 
> 时间：2012-12-29T22:13:11.953
> 
> 标签：logging, azure

The following lines which I included so the custom logging to the default storage account appear in the default WebLogs Table,

```
LocalResource localResource = RoleEnvironment.GetLocalResource("MyCustomLogs");
DirectoryConfiguration dirConfig = new DirectoryConfiguration();
dirConfig.Container = "wad-mycustomlogs-container";
dirConfig.DirectoryQuotaInMB = localResource.MaximumSizeInMegabytes;
dirConfig.Path = localResource.RootPath; 
```

produce the error:

> Management URL 'https://management.core.windows.net/'...
> 12:01:03 AM - Connecting...
> 12:01:03 AM - Verifying storage account 'storagetaxiarmy'...
> 12:01:07 AM - Uploading Package...
> 12:01:34 AM - Updating...
> 12:02:23 AM - Windows Azure could not find the resource MyCustomLogs in the service package. You will need to add the resource back or do a full new deployment instead of upgrading an existing deployment.
> 12:02:23 AM - Deployment failed with a fatal error

Why is this happening and how can I prevent it, as redeploying will require a change of VIP address which would be unacceptable. Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-16T13:45:28.920

添加

```
< LocalStorage name="MyCustomLogs" cleanOnRoleRecycle="false" / > 
```

在你的 ServiceDefinition.csdef

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T10:12:51.933

在您的 ServiceDefinition.csdef 中，您是否将*MyCustomLogs*定义为本地资源？

# javascript - 计算文本区域字符

> ID：14086398
> 
> 赞同：49
> 
> 时间：2012-12-29T22:16:38.623
> 
> 标签：javascript, jquery, html, textarea, charactercount

[我正在这个网站](http://ilanshomekitchen.x10.mx/new/contact.html)上为我的 textarea 开发字符数。现在，它说NaN，因为它似乎找不到字段中有多少个字符的长度，开头是0，所以数字应该是500。在chrome开发人员工具的控制台中，没有错误发生。我所有的代码都在网站上，我什至尝试使用 jQuery 和常规 JavaScript 来计算 textarea 字段的字符数，但似乎没有任何效果。

请告诉我在我的contact.js 文件中的jQuery 和JavaScript 代码中我做错了什么。

```
$(document).ready(function() {
    var tel1 = document.forms["form"].elements.tel1;
    var tel2 = document.forms["form"].elements.tel2;
    var textarea = document.forms["form"].elements.textarea;
    var clock = document.getElementById("clock");
    var count = document.getElementById("count");

    tel1.addEventListener("keyup", function (e){
        checkTel(tel1.value, tel2);
    });

    tel2.addEventListener("keyup", function (e){
        checkTel(tel2.value, tel3);
    });

    /*$("#textarea").keyup(function(){
        var length = textarea.length;
        console.log(length);
        var charactersLeft = 500 - length;
        console.log(charactersLeft);
        count.innerHTML = "Characters left: " + charactersLeft;
        console.log("Characters left: " + charactersLeft);
    });â€‹*/

    textarea.addEventListener("keypress", textareaLengthCheck(textarea), false);
});

function checkTel(input, nextField) {
    if (input.length == 3) {
        nextField.focus();
    } else if (input.length > 0) {
        clock.style.display = "block";
    } 
}

function textareaLengthCheck(textarea) {
    var length = textarea.length;
    var charactersLeft = 500 - length;
    count.innerHTML = "Characters left: " + charactersLeft;
} 
```

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-12-29T22:21:51.090

```
$("#textarea").keyup(function(){
  $("#count").text($(this).val().length);
}); 
```

以上将做你想要的。如果要倒计时，请将其更改为：

```
$("#textarea").keyup(function(){
  $("#count").text("Characters left: " + (500 - $(this).val().length));
}); 
```

`jQuery`或者，您可以在不使用以下代码的情况下完成相同的操作。（感谢@Niet）

```
document.getElementById('textarea').onkeyup = function () {
  document.getElementById('count').innerHTML = "Characters left: " + (500 - this.value.length);
}; 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2017-05-07T22:49:46.373

## ⚠️ 接受的解决方案已过时。

`keyup`以下是事件不会被触发的两种情况：

1.  用户将文本拖入文本区域。
2.  用户通过右键单击（上下文菜单）在文本区域中复制粘贴文本。

使用 HTML5`input`事件来获得更强大的解决方案：

```
<textarea maxlength='140'></textarea> 
```

JavaScript（[演示](https://codepen.io/etiennemartin/pen/qpwxZj)）：

```
const textarea = document.querySelector("textarea");

textarea.addEventListener("input", event => {
    const target = event.currentTarget;
    const maxLength = target.getAttribute("maxlength");
    const currentLength = target.value.length;

    if (currentLength >= maxLength) {
        return console.log("You have reached the maximum number of characters.");
    }

    console.log(`${maxLength - currentLength} chars left`);
}); 
```

如果你绝对想使用 jQuery：

```
$('textarea').on("input", function(){
    var maxlength = $(this).attr("maxlength");
    var currentLength = $(this).val().length;

    if( currentLength >= maxlength ){
        console.log("You have reached the maximum number of characters.");
    }else{
        console.log(maxlength - currentLength + " chars left");
    }
}); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-12-29T22:20:14.493

```
textarea.addEventListener("keypress", textareaLengthCheck(textarea), false); 
```

您正在*调用* `textareaLengthCheck`然后将其返回值分配给事件侦听器。这就是为什么它在加载后不更新或做任何事情的原因。试试这个：

```
textarea.addEventListener("keypress",textareaLengthCheck,false); 
```

除此之外：

```
var length = textarea.length; 
```

`textarea`是实际的文本区域，而不是值。试试这个：

```
var length = textarea.value.length; 
```

结合前面的建议，你的功能应该是：

```
function textareaLengthCheck() {
    var length = this.value.length;
    // rest of code
}; 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-06-17T04:18:44.757

这是简单的代码。希望它正在工作

```
$(document).ready(function() {
var text_max = 99;
$('#textarea_feedback').html(text_max + ' characters remaining');

$('#textarea').keyup(function() {
    var text_length = $('#textarea').val().length;
    var text_remaining = text_max - text_length;

    $('#textarea_feedback').html(text_remaining + ' characters remaining');
});

});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea id="textarea" rows="8" cols="30" maxlength="99" ></textarea>
<div id="textarea_feedback"></div>
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-03T07:10:35.440

`maxlength`此代码从 的属性中获取最大值，`textarea`并随着用户键入而减小该值。

**<[演示](https://jsfiddle.net/Kurenaikunai/8zLtdsm8/)>**

```
var el_t = document.getElementById('textarea');
var length = el_t.getAttribute("maxlength");
var el_c = document.getElementById('count');
el_c.innerHTML = length;
el_t.onkeyup = function () {
  document.getElementById('count').innerHTML = (length - this.value.length);
};
```

```
<textarea id="textarea" name="text"
 maxlength="500"></textarea>
<span id="count"></span>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-01-24T12:24:54.810

对于那些想要一个没有 jQuery 的简单解决方案的人来说，这里有一个方法。

textarea 和消息容器放入您的表单：

```
<textarea onKeyUp="count_it()" id="text" name="text"></textarea>
Length <span id="counter"></span> 
```

JavaScript：

```
<script>
function count_it() {
    document.getElementById('counter').innerHTML = document.getElementById('text').value.length;
}
count_it();
</script> 
```

该脚本最初对字符进行计数，然后对每次击键进行计数，并将数字放入计数器范围中。

马丁

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-22T00:11:42.350

我发现接受的答案并不完全适用于s 由于[Chrome 中](https://stackoverflow.com/q/10030921/892327)`textarea`指出的原因，由于换行符和回车符，在具有 maxlength 属性的 textarea 中计数字符错误，如果您需要知道何时会占用多少空间，这一点很重要将信息存储在数据库中。此外，由于从剪贴板拖放和粘贴文本，keyup 的使用被贬低，这就是我使用and事件的原因。下面考虑换行符并准确计算 a 的长度。`input``propertychange``textarea`

```
$(function() {
  $("#myTextArea").on("input propertychange", function(event) {
    var curlen = $(this).val().replace(/\r(?!\n)|\n(?!\r)/g, "\r\n").length;

    $("#counter").html(curlen);
  });
});

$("#counter").text($("#myTextArea").val().replace(/\r(?!\n)|\n(?!\r)/g, "\r\n").length);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<textarea id="myTextArea"></textarea><br>
Size: <span id="counter" />
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-27T18:34:18.790

```
var maxchar = 10;
$('#message').after('<span id="count" class="counter"></span>');
$('#count').html(maxchar+' of '+maxchar);
$('#message').attr('maxlength', maxchar);
$('#message').parent().addClass('wrap-text');
$('#message').on("keydown", function(e){
	var len =  $('#message').val().length;
	if (len >= maxchar && e.keyCode != 8)
		   e.preventDefault();
	else if(len <= maxchar && e.keyCode == 8){
		if(len <= maxchar && len != 0)
	   		$('#count').html(maxchar+' of '+(maxchar - len +1));
	   	else if(len == 0)
	   		$('#count').html(maxchar+' of '+(maxchar - len));
	}else
		 $('#count').html(maxchar+' of '+(maxchar - len-1)); 
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea id="message" name="text"></textarea>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-13T05:05:19.477

```
 $(document).ready(function(){ 
    $('#characterLeft').text('140 characters left');
    $('#message').keydown(function () {
        var max = 140;
        var len = $(this).val().length;
        if (len >= max) {
            $('#characterLeft').text('You have reached the limit');
            $('#characterLeft').addClass('red');
            $('#btnSubmit').addClass('disabled');            
        } 
        else {
            var ch = max - len;
            $('#characterLeft').text(ch + ' characters left');
            $('#btnSubmit').removeClass('disabled');
            $('#characterLeft').removeClass('red');            
        }
    });    
}); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-05T02:36:47.900

他们说 IE 对`input`事件有问题，但除此之外，解决方案相当简单。

```
ta = document.querySelector("textarea");
count = document.querySelector("label");

ta.addEventListener("input", function (e) {
  count.innerHTML = this.value.length;
});
```

```
<textarea id="my-textarea" rows="4" cols="50" maxlength="10">
</textarea>
<label for="my-textarea"></label>
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-04-05T13:39:32.900

此解决方案将响应键盘和鼠标事件，并应用于初始文本。

```
 $(document).ready(function () {
        $('textarea').bind('input propertychange', function () {
            atualizaTextoContador($(this));
        });

        $('textarea').each(function () {
            atualizaTextoContador($(this));
        });
    });

    function atualizaTextoContador(textarea) {
        var spanContador = textarea.next('span.contador');
        var maxlength = textarea.attr('maxlength');
        if (!spanContador || !maxlength)
            return;
        var numCaracteres = textarea.val().length;
        spanContador.html(numCaracteres + ' / ' + maxlength);
    }
```

```
 span.contador {
        display: block;
        margin-top: -20px;
    }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<textarea maxlength="100" rows="4">initial text</textarea>
<span class="contador"></span>
```

# java - 如何从 ActionEvent 中获取所有 JButton 组件的来源？

> ID：14086401
> 
> 赞同：0
> 
> 时间：2012-12-29T22:17:04.670
> 
> 标签：java, swing, user-interface

我正在尝试实现一个包含两个按钮`Yes`和`No`.

单击时`Yes`我想禁用`No`按钮，按下时`No`我想禁用`Yes`按钮。

我已经实现：

```
JButton btnYes = new JButton("Yes");
contentPane.add(btnYes);
btnYes.setActionCommand("Yes");
btnYes.addActionListener(this); 
```

*...`No`按钮也一样...*

现在我正在用这种方法捕捉事件：

```
public void actionPerformed(ActionEvent e) {
    if(e.getActionCommand().equals("Yes"))
    {
        //I know how to get the button that caused the event 
        //but I don't know how to disable the OTHER button.
        JButton source = (JButton)e.getSource();
        //Handle the source button...
    }

} 
```

在上述方法中，我可以访问导致事件的按钮，但不能访问其他按钮。

获得按钮的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:21:39.363

您应该将 ActionListener 实现为 Dialog 类的嵌套类，在这种情况下，您将可以完全访问外部类的所有字段（在创建按钮时应该在其中存储对按钮的引用）。

糟糕的肮脏解决方案（不应该使用）仍然存在：通过 JButton 的 getParent() 导航到板条，然后通过父母孩子的 getChildren() 导航到板条。只是为了表明无论如何都是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:27:45.063

您可以使用`JButton`数组作为类成员变量并检查哪个实例*没有*导致事件：

```
for (JButton button: buttonArray) {
   if (button != source) {
      button.setEnabled(false); // disable the other button
   }
} 
```

# c# - Ambiguous in the namespace issue, even after removing previous control

> ID：14086403
> 
> 赞同：0
> 
> 时间：2012-12-29T22:17:27.010
> 
> 标签：c#, .net, vb.net, visual-studio-2010, namespaces

I was using a control in my application and then decided to make some customizations to it so I modified the control and built it and removed the old control from my project and dropped the new one in. Now I am getting the error :'AutocompleteMenu" is ambiguous in the namespace 'AutocompleteMenuNS'.

Like I said I had removed the old control from the project so why is it still saying it is ambigous? Do I have to go through the project and remove every last entry of this control? Help would be appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:35:04.810

尝试删除您的 bin 和 obj 文件夹，然后重建您的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:17:52.833

这只是一个“技巧”，但在所有项目文件中尝试“在文件中查找”，并删除旧的命名空间

删除旧命名空间时的视觉不匹配...

# java - 使用正则表达式从字符串中删除可选编号

> ID：14086404
> 
> 赞同：0
> 
> 时间：2012-12-29T22:17:31.910
> 
> 标签：java, regex

我正在尝试创建一个正则表达式来捕获两个捕获组之间的令牌。

**示例输入**

```
Added experiencevalidator [Java] [Spring]
1\.  Added validators [Java] [Spring]
2\.  Fixed issues with deletes [JPA] [Java] 
```

基本上我想捕获编号（1.,2.）和标签（[Java] [Spring]）之间的标记。

**预期捕获**

匹配器应为每一行返回以下内容：

```
Added experiencevalidator
Added validators
Fixed issues with deletes 
```

我目前正在使用这段代码，它利用了积极的前瞻和后瞻。

```
private Pattern TITLE_REGEX = Pattern.compile("(?<=\\d\\.\\s)(.*?)(?=\\[.*)");

private String cleanseTitle(String title){
    Matcher m = TITLE_REGEX.matcher(title);
    if(m.find()){
        System.out.println("Match found");
        System.out.println(m.group(1));;
    }else{
        System.out.println("No Match");
    }
    return title;
} 
```

每行都`cleanseTitle`通过 title 参数传递给方法。我的问题是我不确定如何处理前面没有编号的行。该代码当前正确处理前面有编号的行，但是那些前面没有编号的行返回不匹配。

任何人都可以为我提供一个正则表达式来处理前面有编号的行或前面没有编号的行吗？我对任何正则表达式解决方案持开放态度，而且我不喜欢我当前的正则表达式，因此请随时更改它。任何可以帮助我了解更多有关正则表达式的随附解释也值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:20:50.797

您可以使用两个正则表达式：

1.  无所取代`^\d+\.\s+`，
2.  无所取代`(\s+\[[^]]+\])*\s*$`。

当然，不要忘记将 Java 字符串中的所有反斜杠加倍。

请注意，您不需要测试匹配：如果正则表达式不匹配，则不会发生替换。

示例代码：

```
private static final String
    BEGINNING_NUMBERS = "^\\d+\\.\\s+",
    ENDING_TOKENS = "(\\s+\\[[^]]+\\])*\\s*$";

private String cleanseTitle(String title)
{
    return title.replaceFirst(BEGINNING_NUMBERS, "")
        .replaceFirst(ENDING_TOKENS, "");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:21:02.063

只修复你的正则表达式而不写一个新的，你在一开始就匹配一个数字。为什么不让它成为可选的。

```
(?<=\\d\\.\\s)?(.*?)(?=\\[.*) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:31:39.080

由于您使用捕获组，因此您不需要环顾四周。我会将后视更改为交替，以匹配编号或前导可选空格：

```
^(?:\d+\.\s|\s*)(.*?)(?=\[.*) 
```

[在 Regexr 上](http://regexr.com?3394g)查看

交替中的顺序在这里很重要。您需要将编号作为第一个替代，因为第二个替代将始终匹配。

你也可以用这个跳过前瞻和惰性量词

```
^(?:\d+\.\s|\s*)([^\[]+) 
```

[在 Regexr 上](http://regexr.com?3394j)查看

# java - assembling a file received through UDP Datagram packets

> ID：14086405
> 
> 赞同：-2
> 
> 时间：2012-12-29T22:18:00.060
> 
> 标签：java, networking, udp, packet, datagram

I'm sending/receiving a file (on localhost) through UDP Datagram, and now I want to assemble the received packets to create that received file and save it on some path (desktop for example) .. what should I do? any idea?

You can find my client/server implementation here:

[Is it possible to use just 1 UDPSocket for sending/receiving on the same port?](https://stackoverflow.com/questions/14085606/is-it-possible-to-use-just-1-udpsocket-for-sending-receiving-on-the-same-port)

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T07:51:49.670

你要做的就是：像TCP这样的算法。通过 UDP 创建协议，如 TCP 协议。

1）您需要对 UDP 数据包进行排序 2）您不需要自定义校验和，因为 UDP 已经有 3）发送端缓冲区，您的代码将写入缓冲区，您的协议会将数据从缓冲区发送到接收器作为一些长度的数据包（MTU 大小很好，UDP数据包中大约1400字节）。数据包将具有序列号。4) 接收方在接收数据包时检查 seq。number，如果收到数据包的seq。no 是预期的 seq no，您可以将其缓冲以写入文件，否则将此数据包放入临时缓冲区并将丢失数据包的信息发送回发送者。5) 接收方将发送回接收到的最高 seq no 或丢失的 seq no 的 ACK。6) 发送方将根据接收方的回复执行。

我想你有一些想法。你需要多线程......在每台机器上你需要一些发送者、接收者、应用程序线程来实现这样的算法。

顺便说一句，我已经实现了这个算法，并得到了很好的结果。我能够以 75 Mbps 的速度传输文件，其中 TCP 在 100 Mbps 互联网连接上的峰值速度未能达到 5 Mbps 以上，往返时间约为 100-200 毫秒。从印度到加拿大。

我希望这对你有所帮助。

# apache - 如何在 apache(xampp) 服务器中创建子域？

> ID：14086408
> 
> 赞同：18
> 
> 时间：2012-12-29T22:18:20.980
> 
> 标签：apache, web, xampp, subdomain

一段时间以来，我一直在尝试在本地 xampp 安装中创建子域。我尝试编辑我的 httpd.conf 文件并输入以下内容：

```
NameVirtualHost *:80

<VirtualHost *:80>
DocumentRoot /ecommerce
ServerName ecomm.localhost
</VirtualHost> 
```

我还编辑了我的 Windows 主机文件并输入：127.0.0.1 ecomm.localhost

但是当我在我的 Firefox 中输入“ecomm.localhost”时，它给了我：禁止访问！！！可以请任何人帮助我吗？我到底做错了什么？我对此很陌生。我只是想在我的“htdocs”文件夹中创建多个文件夹，并将它们用作具有子域的不同网站。例如：c:\xampp\htdocs\mainSite -----> mainSite.com 或 mainSite.localhost c:\xampp\htdocs\subSite -----> subSite.mainSite.com 或 subSite.mainSite.localhost

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-30T05:40:27.073

试试这个 ：

```
NameVirtualHost 127.0.0.1:80
<VirtualHost *:80>
<Directory "C:\path\to\ecommerce">
    Options FollowSymLinks Indexes
    AllowOverride All
    Order deny,allow
    allow from All
</Directory>
ServerName ecomm.localhost
ServerAlias www.ecomm.localhost
DocumentRoot "C:\path\to\ecommerce"
</VirtualHost> 
```

是的，您正确编辑了主机文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-01-25T13:34:16.877

除了阿塔巴克的回答：

转到 Apache > Conf > Extra -> "httpd-vhosts.conf" 文件并添加：

```
<VirtualHost *:80>
DocumentRoot "C:/xampp/htdocs/subdomain"
ServerName subdomain.localhost.com
</VirtualHost> 
```

转到 C:\WINDOWS\system32\drivers\etc -> "hosts" 文件并添加：

```
127.0.0.1 subdomain.localhost 
```

来自[使用 Xampp 设置多个子域](http://www.codingcereal.com/2011/05/setting-up-multiple-subdomains-in-your-localhost-using-xampp) /

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-01-16T05:11:42.837

在 xampp\apache\conf\extra\httpd-vhosts.conf 文件中，在文件底部添加以下行以支持子域：

```
<VirtualHost *:80>
   DocumentRoot "C:/xampp/htdocs/sandbox"
   ServerName sandbox.localhost.com
</VirtualHost> 
```

然后在 C:\windows\System32\drivers\etc\hosts 文件中在文件底部添加以下行：

```
127.0.0.1    sandbox.localhost.com 
```

之后重新启动xampp服务器并打开一个新选项卡，在地址栏中写入

```
sandbox.localhost.com 
```

然后你会看到在沙盒文件夹中的 index.php 文件的输出

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-01-11T23:40:15.580

这对我有用。粘贴到 httpd-vhost.conf 文件的底部，位于 xampp > Apache > Conf > Extra。确保不要评论您添加的任何 vitualhost 标签，否则在重新启动服务器时会出现“尝试启动 Apache”错误。foodporch 是我的子域的名称

```
<VirtualHost *:80>
    DocumentRoot "c:/xampp/htdocs"
    ServerName localhost
    <Directory  "c:/xampp/htdocs">
       Require all granted
    </Directory>
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "c:/xampp/htdocs/foodporch"
    ServerName foodporch.localhost
    <Directory  "c:/xampp/htdocs/foodporch">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost> 
```

请记住将此行添加到主机文件的末尾 C:\WINDOWS\system32\drivers\etc -> `127.0.0.1 foodporch.localhost.com`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-21T21:32:37.293

在 httpd.xampp.conf 文件中添加此行以支持子域：

```
<VirtualHost *:80>
DocumentRoot "C:/xampp/htdocs/subdomain"
ServerName subdomain.localhost.com
</VirtualHost> 
```

然后添加：windows hosts 文件并输入：`127.0.0.1 subdomain.localhost`

为我工作

# django - 无法使用自定义 PASSWORD_HASHERS 进行身份验证

> ID：14086413
> 
> 赞同：1
> 
> 时间：2012-12-29T22:19:15.040
> 
> 标签：django, django-authentication

我正在将一个使用 php 的网站迁移到 Django 框架。

有用于特定的哈希密码算法，所以我不得不写：

```
#settings.py
PASSWORD_HASHERS = (
    'django.contrib.auth.hashers.PBKDF2PasswordHasher',
    'project.hashers.SHA1ProjPasswordHasher',        # that's mine
    'django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher',
 ...
) 
```

和：

```
#hashers.py

import hashlib

from django.contrib.auth.hashers import (BasePasswordHasher, mask_hash)
from django.utils.datastructures import SortedDict
from django.utils.encoding import force_bytes
from django.utils.crypto import constant_time_compare
from django.utils.translation import ugettext_noop as _

class SHA1ProjPasswordHasher(BasePasswordHasher):
    """
    Special snowflake algorithm from the first version.
    php code: $pass=substr(sha1(trim($_POST['password'])),0,8);
    """
    algorithm = "unsalted_and_trimmed_sha1"

    def salt(self):
        return ''

    def encode(self, password, salt):
        return hashlib.sha1(force_bytes(salt + password)).hexdigest()[:8]

    def verify(self, password, encoded):
        encoded_2 = self.encode(password, '')
        return constant_time_compare(encoded, encoded_2)

    def safe_summary(self, encoded):
        return SortedDict([
            (_('algorithm'), self.algorithm),
            (_('hash'), mask_hash(encoded, show=3)),
            ]) 
```

首次使用时效果很好`PBKDF2PasswordHasher`：

```
>>> from django.contrib.auth import authenticate
>>> u = authenticate(username='root', password='test')
>>> u.password
u'pbkdf2_sha256$10000$EX8BcgPFjygx$HvB6NmZ7uX1rWOOPbHRKd8GLYD3cAsQtlprXUq1KGMk='
>>> exit() 
```

然后我把我`SHA1ProjPasswordHasher`放在第一位，第一次验证效果很好。哈希已更改。：

```
>>> from django.contrib.auth import authenticate
>>> u = authenticate(username='root', password='test')
>>> u.password
'a94a8fe5'
>>> exit() 
```

二次认证失败。无法使用新哈希进行身份验证。

```
>>> from django.contrib.auth import authenticate
>>> u = authenticate(username='root', password='test')
>>> u.password
Traceback (most recent call last):
  File "<console>", line 1, in <module>
AttributeError: 'NoneType' object has no attribute 'password' 
```

可能是什么问题呢？谢谢。

* * *

更新：好的，问题变得更清楚了。当我从这里删除切片时：

```
return hashlib.sha1(force_bytes(salt + password)).hexdigest()[:8] 
```

一切正常。我不明白为什么..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-06T08:31:37.327

虽然几年过去了，我还是把我的解决方案放在这里以供将来参考

弗拉德部分正确；django.contrib.auth.hashers 中的以下方法似乎迫使您使用包含美元 $ 符号的哈希格式来标记用于 django 的算法来决定使用哪个哈希

```
def identify_hasher(encoded):
"""
Returns an instance of a loaded password hasher.
Identifies hasher algorithm by examining encoded hash, and calls
get_hasher() to return hasher. Raises ValueError if
algorithm cannot be identified, or if hasher is not loaded.
"""
# Ancient versions of Django created plain MD5 passwords and accepted
# MD5 passwords with an empty salt.
if ((len(encoded) == 32 and '$' not in encoded) or
(len(encoded) == 37 and encoded.startswith('md5$$'))):
algorithm = 'unsalted_md5'
# Ancient versions of Django accepted SHA1 passwords with an empty salt.
elif len(encoded) == 46 and encoded.startswith('sha1$$'):
algorithm = 'unsalted_sha1'
else:
algorithm = encoded.split('$', 1)[0]
return get_hasher(algorithm) 
```

有一种方法可以“欺骗”django，而无需破解您的 django 安装。您必须创建一个身份验证后端以用于您的身份验证。在那里你将覆盖 django 的 check_password 方法。我有一个哈希值所在的数据库，但`{SSHA512}hash`我无法更改它，因为我必须能够与 dovecot 通信。所以我把以下内容放在我的`backends.py`课堂上：

```
def check_password(self, raw_password, user):
        """
        Returns a boolean of whether the raw_password was correct. Handles
        hashing formats behind the scenes.
        """
        def setter(raw_password):
            user.set_password(raw_password)
            user.save(update_fields=["password"])
        return check_password(raw_password, "SSHA512$" + user.password, setter) 
```

这样，当 django 必须检查密码是否正确时，它将执行以下操作： - 从数据库中获取哈希 - 在开头`{SSHA512}hash` 临时附加一个`SSHA512$`字符串，然后检查

因此，当您`{SSHA512}hash`在数据库中时，当 django 使用此后端时，它会看到`SSHA512${SSHA512}hash`.

这样`hashers.py`你就可以在你的类中设置，`algorithm = "SSHA512"`这将提示 django 在这种情况下使用这个散列器。

您的`def encode(self, password, salt, iterations=None)`方法`hashers.py`将按照 dovecot 需要 {SSHA512} 哈希的方式保存哈希（您不必在编码方法中做任何奇怪的事情）。

但是，您的`def verify(self, password, encoded)`方法必须从传递的编码字符串中去除 SSHA512$ “技巧”，以将其与编码将创建的字符串进行比较。

所以你有它！Django 将使用您的散列器检查不包含美元符号的散列，并且您不必破坏 django 中的任何内容:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:37:30.617

只有未加盐的 md5 哈希不能包含美元符号：

```
# django/contrib/auth/hashers.py

def identify_hasher(encoded):
    """
    Returns an instance of a loaded password hasher.

    Identifies hasher algorithm by examining encoded hash, and calls
    get_hasher() to return hasher. Raises ValueError if
    algorithm cannot be identified, or if hasher is not loaded.
    """
    if len(encoded) == 32 and '$' not in encoded:
        algorithm = 'unsalted_md5'
    else:
        algorithm = encoded.split('$', 1)[0]
    return get_hasher(algorithm) 
```

所以最好的方法是将当前密码哈希转换为以下格式：`alg$salt$hash`

```
class SHA1ProjPasswordHasher(BasePasswordHasher):
    """
    Special snowflake algorithm from the first version.
    php code: $pass=substr(sha1(trim($_POST['password'])),0,8);
    """
    algorithm = "unsalted_and_trimmed_sha1"

    def salt(self):
        return ''

    def encode(self, password, salt):
        assert password
        assert '$' not in salt
        hash = hashlib.sha1(force_bytes(salt + password)).hexdigest()[:8]
        return "%s$%s$%s" % (self.algorithm, salt, hash)

    def verify(self, password, encoded):
        algorithm, salt, hash = encoded.split('$', 2)
        assert algorithm == self.algorithm
        encoded_2 = self.encode(password, salt)
        return constant_time_compare(encoded, encoded_2)

    def safe_summary(self, encoded):
        algorithm, salt, hash = encoded.split('$', 2)
        assert algorithm == self.algorithm
        return SortedDict([
            (_('algorithm'), algorithm),
            (_('salt'), mask_hash(salt, show=2)),
            (_('hash'), mask_hash(hash)),
            ]) 
```

.

```
>>> from django.contrib.auth import authenticate
>>> x = authenticate(username='root', password='test')
>>> x
<User: root>
>>> x.password
u'unsalted_and_trimmed_sha1$$a94a8fe5' 
```

# asp.net - IIS 7 上的条件 https 重定向

> ID：14086415
> 
> 赞同：3
> 
> 时间：2012-12-29T22:19:30.120
> 
> 标签：asp.net, asp.net-mvc, iis, iis-7, http-redirect

我在网站上有以下规则将 http 重定向到 https。我们刚刚发现，我们的应用程序仅使用 api 的 http 提交。在我们得到更新之前，我需要网站忽略对 /api 文件夹的调用，只重定向其他所有内容。我确信有一种方法可以说如果 URL 不包含 /api/ 然后重定向。

```
<rewrite>
  <rules>
    <rule name="HTTP to HTTPS redirect" stopProcessing="true">
      <match url="(.*)" />
      <conditions>
        <add input="{HTTPS}" pattern="off" ignoreCase="true" />
      </conditions>
      <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
    </rule>
  </rules>
</rewrite> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:25:05.697

添加一个类似的条目，`<add input="{R:0}" pattern="/api(/|$)(.*)" negate="true" />`以便整个文件为：

```
<rewrite>
  <rules>
    <rule name="HTTP to HTTPS redirect" stopProcessing="true">
      <match url="(.*)" />
      <conditions>
        <add input="{R:0}" pattern="/api(/|$)(.*)" negate="true" />
        <add input="{HTTPS}" pattern="off" ignoreCase="true" />
      </conditions>
      <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
    </rule>
  </rules>
</rewrite> 
```

示例网址：`http://site.com/api/function`

因此，如果站点之后的 URL 与以下任何一个匹配，它将停止处理（因此不会将用户推送到 https）

*   `/api`
*   `/api/anything`
*   任何`https`网址

我们在反向代理后面的 IIS 中运行大型应用程序时遇到了同样的事情。IIS 的 URL 重写插件（您似乎正在使用）有点痛苦，但它做得非常好并且可以容忍 MVC 框架。

正如您所提到的，简单地将重写块放在 API 目录中是行不通的，因为使用 MVC 没有目录。您会认为 MS 对此会有更好的解决方案——但他们没有。它使事情变得更具挑战性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:25:26.610

如果您在 /api 应用程序或目录中放置一个*单独*的Web.config 文件，您可以覆盖适用于整个站点的任何规则。

查看本文中的提示 #1，如果您有时间阅读它们：

[http://weblogs.asp.net/jgalloway/archive/2012/01/17/10-things-asp-net-developers-should-know-about-web-config-inheritance-and-overrides.aspx](http://weblogs.asp.net/jgalloway/archive/2012/01/17/10-things-asp-net-developers-should-know-about-web-config-inheritance-and-overrides.aspx)

John Galloway 的博客是有关 IIS 和 ASP.NET 的绝佳资源。

# c++ - 如何在 C++ 中编写自定义输入流

> ID：14086417
> 
> 赞同：69
> 
> 时间：2012-12-29T22:19:36.927
> 
> 标签：c++, iostream

我目前正在学习 C++（来自 Java），并且正在尝试了解如何在 C++ 中正确使用 IO 流。

假设我有一个`Image`包含图像像素的类，并且我重载了提取运算符以从流中读取图像：

```
istream& operator>>(istream& stream, Image& image)
{
    // Read the image data from the stream into the image
    return stream;
} 
```

所以现在我可以读取这样的图像：

```
Image image;
ifstream file("somepic.img");
file >> image; 
```

但现在我想使用相同的提取运算符从自定义流中读取图像数据。假设我有一个文件，其中包含压缩形式的图像。因此，我可能不想使用 ifstream 来实现自己的输入流。至少我会在 Java 中这样做。在 Java 中，我会编写一个自定义类来扩展`InputStream`该类并实现该`int read()`方法。所以这很容易。用法如下所示：

```
InputStream stream = new CompressedInputStream(new FileInputStream("somepic.imgz"));
image.read(stream); 
```

所以使用相同的模式也许我想在 C++ 中做到这一点：

```
Image image;
ifstream file("somepic.imgz");
compressed_stream stream(file);
stream >> image; 
```

但也许这是错误的方式，不知道。扩展`istream`类看起来很复杂，经过一番搜索，我发现了一些关于扩展的提示`streambuf`。但是对于这样一个简单的任务，这个[例子](http://icodesnip.com/snippet/cpp/an-example-of-implementing-a-custom-streambuf-performs-xor-encryption-dreamincode)看起来非常复杂。

那么在 C++ 中实现自定义输入/输出流（或 streambufs？）的最佳方法是什么？

# 解决方案

有些人建议根本不使用 iostreams，而是使用迭代器、boost 或自定义 IO 接口。这些可能是有效的替代方案，但我的问题是关于 iostreams。接受的答案导致下面的示例代码。为了更容易阅读，没有标题/代码分离，并且导入了整个 std 命名空间（我知道这在实际代码中是一件坏事）。

这个例子是关于读取和写入垂直异或编码的图像。格式很简单。每个字节代表两个像素（每像素 4 位）。每一行都与前一行异或。这种编码为压缩图像做准备（通常会产生很多更容易压缩的 0 字节）。

```
#include <cstring>
#include <fstream>

using namespace std;

/*** vxor_streambuf class ******************************************/

class vxor_streambuf: public streambuf
{
public:
    vxor_streambuf(streambuf *buffer, const int width) :
        buffer(buffer),
        size(width / 2)
    {
        previous_line = new char[size];
        memset(previous_line, 0, size);
        current_line = new char[size];
        setg(0, 0, 0);
        setp(current_line, current_line + size);
    }

    virtual ~vxor_streambuf()
    {
        sync();
        delete[] previous_line;
        delete[] current_line;
    }

    virtual streambuf::int_type underflow()
    {
        // Read line from original buffer
        streamsize read = buffer->sgetn(current_line, size);
        if (!read) return traits_type::eof();

        // Do vertical XOR decoding
        for (int i = 0; i < size; i += 1)
        {
            current_line[i] ^= previous_line[i];
            previous_line[i] = current_line[i];
        }

        setg(current_line, current_line, current_line + read);
        return traits_type::to_int_type(*gptr());
    }

    virtual streambuf::int_type overflow(streambuf::int_type value)
    {
        int write = pptr() - pbase();
        if (write)
        {
            // Do vertical XOR encoding
            for (int i = 0; i < size; i += 1)
            {
                char tmp = current_line[i];
                current_line[i] ^= previous_line[i];
                previous_line[i] = tmp;
            }

            // Write line to original buffer
            streamsize written = buffer->sputn(current_line, write);
            if (written != write) return traits_type::eof();
        }

        setp(current_line, current_line + size);
        if (!traits_type::eq_int_type(value, traits_type::eof())) sputc(value);
        return traits_type::not_eof(value);
    };

    virtual int sync()
    {
        streambuf::int_type result = this->overflow(traits_type::eof());
        buffer->pubsync();
        return traits_type::eq_int_type(result, traits_type::eof()) ? -1 : 0;
    }

private:
    streambuf *buffer;
    int size;
    char *previous_line;
    char *current_line;
};

/*** vxor_istream class ********************************************/

class vxor_istream: public istream
{
public:
    vxor_istream(istream &stream, const int width) :
        istream(new vxor_streambuf(stream.rdbuf(), width)) {}

    virtual ~vxor_istream()
    {
        delete rdbuf();
    }
};

/*** vxor_ostream class ********************************************/

class vxor_ostream: public ostream
{
public:
    vxor_ostream(ostream &stream, const int width) :
        ostream(new vxor_streambuf(stream.rdbuf(), width)) {}

    virtual ~vxor_ostream()
    {
        delete rdbuf();
    }
};

/*** Test main method **********************************************/

int main()
{
    // Read data
    ifstream infile("test.img");
    vxor_istream in(infile, 288);
    char data[144 * 128];
    in.read(data, 144 * 128);
    infile.close();

    // Write data
    ofstream outfile("test2.img");
    vxor_ostream out(outfile, 288);
    out.write(data, 144 * 128);
    out.flush();
    outfile.close();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-12-29T22:24:17.193

在 C++ 中创建新流的正确方法是派生`std::streambuf`并覆盖`underflow()`读取操作和写入操作`overflow()`和`sync()`操作。出于您的目的，您将创建一个过滤流缓冲区，该缓冲区将另一个流缓冲区（可能还有一个可以使用 从中提取流缓冲区的流`rdbuf()`）作为参数，并根据该流缓冲区实现其自己的操作。

流缓冲区的基本轮廓是这样的：

```
class compressbuf
    : public std::streambuf {
    std::streambuf* sbuf_;
    char*           buffer_;
    // context for the compression
public:
    compressbuf(std::streambuf* sbuf)
        : sbuf_(sbuf), buffer_(new char[1024]) {
        // initialize compression context
    }
    ~compressbuf() { delete[] this->buffer_; }
    int underflow() {
        if (this->gptr() == this->egptr()) {
            // decompress data into buffer_, obtaining its own input from
            // this->sbuf_; if necessary resize buffer
            // the next statement assumes "size" characters were produced (if
            // no more characters are available, size == 0.
            this->setg(this->buffer_, this->buffer_, this->buffer_ + size);
        }
        return this->gptr() == this->egptr()
             ? std::char_traits<char>::eof()
             : std::char_traits<char>::to_int_type(*this->gptr());
    }
}; 
```

看起来如何`underflow()`完全取决于正在使用的压缩库。我使用的大多数库都保留了一个内部缓冲区，该缓冲区需要填充并保留尚未使用的字节。通常情况下，将解压缩挂钩到`underflow()`.

创建流缓冲区后，您可以`std::istream`使用流缓冲区初始化一个对象：

```
std::ifstream fin("some.file");
compressbuf   sbuf(fin.rdbuf());
std::istream  in(&sbuf); 
```

如果您要经常使用流缓冲区，您可能希望将对象构造封装到一个类中，例如`icompressstream`. 这样做有点棘手，因为基类`std::ios`是一个虚拟基类，并且是存储流缓冲区的实际位置。因此，在将指针传递给 a 之前构造流缓冲区`std::ios`需要跳过几个环节：它需要使用`virtual`基类。这是大致的样子：

```
struct compressstream_base {
    compressbuf sbuf_;
    compressstream_base(std::streambuf* sbuf): sbuf_(sbuf) {}
};
class icompressstream
    : virtual compressstream_base
    , public std::istream {
public:
    icompressstream(std::streambuf* sbuf)
        : compressstream_base(sbuf)
        , std::ios(&this->sbuf_)
        , std::istream(&this->sbuf_) {
    }
}; 
```

（我只是输入了这段代码，没有简单的方法来测试它是否合理正确；请注意拼写错误，但整体方法应该按照描述的方式工作）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-29T22:50:00.340

boost（如果你对 C++ 很认真，你应该已经拥有它），有一个专门用于扩展和自定义 IO 流的库：[boost.iostreams](http://www.boost.org/doc/libs/release/libs/iostreams/doc/index.html)

特别是，它已经为一些流行格式（[bzip2](http://www.boost.org/doc/libs/release/libs/iostreams/doc/classes/bzip2.html#basic_bzip2_decompressor)、[gzlib](http://www.boost.org/doc/libs/release/libs/iostreams/doc/classes/gzip.html#basic_gzip_decompressor)和[zlib](http://www.boost.org/doc/libs/release/libs/iostreams/doc/classes/zlib.html#basic_zlib_decompressor)）提供了解压缩流

如您所见，扩展 streambuf 可能是一项涉及的工作，但如果您需要，该库可以很容易地[编写您自己的过滤 streambuf 。](http://www.boost.org/doc/libs/release/libs/iostreams/doc/tutorial/tutorial.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-29T22:23:47.763

不要，除非你想死于可怕的设计。IOstreams 是标准库中最糟糕的组件——甚至比语言环境还要糟糕。迭代器模型更有用，您可以使用 istream_iterator 从流转换为迭代器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T14:34:48.207

我同意@DeadMG，不建议使用 iostreams。除了糟糕的设计之外，性能通常比普通的老式 C 风格 I/O 更差。不过，我不会坚持使用特定的 I/O 库，而是创建一个具有所有必需操作的接口（抽象类），例如：

```
class Input {
 public:
  virtual void read(char *buffer, size_t size) = 0;
  // ...
}; 
```

然后，您可以为 CI/O、iostream`mmap`或其他任何东西实现此接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T22:28:29.973

这样做可能是可能的，但我觉得这不是 C++ 中这个特性的“正确”用法。iostream >> 和 << 运算符用于相当简单的操作，例如编写 a 的“名称、街道、城镇、邮政编码” `class Person`，而不是用于解析和加载图像。使用 stream::read() 会更好 - 使用`Image(astream);`，并且您可以实现压缩流，如 Dietmar 所述。

# css - CSS constants library support

> ID：14086419
> 
> 赞同：2
> 
> 时间：2012-12-29T22:19:40.910
> 
> 标签：css, tomcat

CSS doesn't support constants, particularly for colors, which makes css color maintenance a real pain.

Before I roll my own solution, are there any good libraries that work with tomcat that support the concept of CSS constants?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T03:53:51.910

主要选项：

最新的是浏览器中的实际变量 - [http://css3.bradshawenterprises.com/blog/css-variables/](http://css3.bradshawenterprises.com/blog/css-variables/)虽然支持（目前）很差。到2013年可能会有所改善。

主流是“Sass” - [http://sass-lang.com/](http://sass-lang.com/) - “Sass 让 CSS 再次变得有趣。Sass 是 CSS3 的扩展，添加了嵌套规则、变量、mixins、选择器继承等。它被翻译成很好 -使用命令行工具或网络框架插件格式化的标准 CSS。”

萨斯变量：`$blue: #3bbfce;`

此外，非常流行的“LESS” - [http://lesscss.org/](http://lesscss.org/) -“LESS 扩展了 CSS 的动态行为，例如变量、mixin、操作和函数。LESS 在服务器端运行（使用 Node.js 和 Rhino ) 或客户端（仅限现代浏览器）。”

少变量：`@color: #4D926F;`

Sass 和 Less 都编译成 css。

# c# - Treeview like Visual Studio 2010 toolbox in WPF

> ID：14086422
> 
> 赞同：0
> 
> 时间：2012-12-29T22:19:46.807
> 
> 标签：c#, wpf, xaml, treeview, custom-controls

I'm looking a very similar control like the VS 2010 toolbox.

A tree view where I can have a header and my subitems. Ando also the facility to move up or down the item (or drag and drop).

Does you have idea where can I get one? I'm interested in a WPF control.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:30:22.400

I don't think you need a special control. Just apply a [`HierarchicalDataTemplate`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDgQFjAA&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fsystem.windows.hierarchicaldatatemplate.aspx&ei=4m7fUN2fJoWA2AW9zoCQCQ&usg=AFQjCNF5bqK83UYRUTvbAcCzXuz25NOAnA&bvm=bv.1355534169,d.b2I) to make the layers look like you want them to.

Here's a quick [step-by-step](http://blogs.msdn.com/b/mikehillberg/archive/2009/10/30/treeview-and-hierarchicaldatatemplate-step-by-step.aspx) on how to do so with a `TreeView`.

# asp.net - asp:menu 无法正确呈现

> ID：14086434
> 
> 赞同：0
> 
> 时间：2012-12-29T22:21:44.107
> 
> 标签：asp.net, apache, menu, mono

我正在尝试在 ASP.NET 中部署一个使用 VS2010 开发的简单 Web 应用程序，在开发机器上本地的 IIS 上一切正常，但是一旦部署在 Apache 服务器上，我遇到了一个问题：菜单无法正确呈现，似乎不考虑 CSS。

有没有人已经有这样的问题？谢谢你的帮助 ！

[编辑] Appache 版本 2.2.22 Mono 版本 2.10.8.1

Site.Master：

```
<body>
<form runat="server">
    <div class="page">
        <div class="TopBlank"> </div>
        <div class="header">
            <div class="title">
                <h1>
                    My ASP.NET Application
                </h1>
            </div>            
            <div class="clear hideSkiplink">
                <asp:Menu ID="NavigationMenu" runat="server" CssClass="menu" EnableViewState="false" IncludeStyleBlock="false" Orientation="Horizontal">
                <Items>
                    <asp:MenuItem NavigateUrl="~/Default.aspx" Text="Home"/>
                    <asp:MenuItem Text="Google Maps">
                        <asp:MenuItem Text="HTML" Value="HTML" NavigateUrl="~/Map.htm"></asp:MenuItem>
                        <asp:MenuItem Text="ASPX" Value="ASPX" NavigateUrl="~/Map.aspx"></asp:MenuItem>
                    </asp:MenuItem>
                    <asp:MenuItem NavigateUrl="~/Liens.aspx" Text="Liens utiles"/>
                    <asp:MenuItem NavigateUrl="~/About.aspx" Text="About"/>
                </Items>
            </asp:Menu>
        </div>
    </div>
</form>
</body> 
```

CSS：

```
.menu
{
    padding: 4px 0px 4px 8px;
}

.menu ul
{
    list-style: none;
    margin: 0px;
    padding: 0px;
    width: auto;
}

.menu ul li a, .menu ul li a:visited
{
    background-color: #465c71;
    border: 1px #4e667d solid;
    color: #dde4ec;
    display: block;
    line-height: 1.35em;
    padding: 4px 20px;
    text-decoration: none;
    white-space: nowrap;
}

.menu ul li a:hover
{
    background-color: #bfcbd6;
    color: #465c71;
    text-decoration: none;
}

.menu ul li a:active
{
    background-color: #465c71;
    color: #cfdbe6;
    text-decoration: none;
}

.menu ul ul
{
    margin-left: 10%;
} 
```

我发现的问题是，在 IIS 上运行时，asp:menu 被转换为 HTML div，而 mono 被转换为 HTML 表。似乎在单声道上运行时，找不到 CSS 类，如源代码所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head><title>

</title><link rel="stylesheet" type="text/css" href="Styles/Site.css" />
<style type="text/css">

.ctl00_NavigationMenu_0 {background-color:White;}
.ctl00_NavigationMenu_1 {border-style:None;text-decoration:none;}
.ctl00_NavigationMenu_2 {}
</style></head>
<body>
    <form name="aspnetForm" method="post" action="Arduino.aspx" id="aspnetForm">
[......]
<div class="clear hideSkiplink">
                <a href="#ctl00_NavigationMenu_SkipLink">
 <img alt="Skip Navigation Links" height="0" width="0" src="/WebSite/WebResource.axd?d=2OmH9jTSogXsrUt6aDvnYEihIak%3d_NWdhSxeypCYSJgIFnBFWuKjP9Rs%3d_f&amp;t=634787585370000000" style="border-width:0px;" /></a>
<table cellpadding="0" cellspacing="0" border="0" id="ctl00_NavigationMenu" class="menu ctl00_NavigationMenu_2" IncludeStyleBlock="false">
    <tr>
        <td onmouseover="javascript:Menu_OverStaticLeafItem ('ctl00_NavigationMenu','0')" onmouseout="javascript:Menu_OutItem ('ctl00_NavigationMenu','0')">
<table id="ctl00_NavigationMenu_0i" cellpadding="0" cellspacing="0" border="0" width="100%">
            <tr>
                <td style="white-space:nowrap;"><a href="Default.aspx" class="ctl00_NavigationMenu_1" id="ctl00_NavigationMenu_0l">Home</a>
</td>
            </tr>
    </table>
</td>
<td style="width:3px;"></td>
<td onmouseover="javascript:Menu_OverItem ('ctl00_NavigationMenu','1',null)" onmouseout="javascript:Menu_OutItem ('ctl00_NavigationMenu','1')">
<table id="ctl00_NavigationMenu_1i" cellpadding="0" cellspacing="0" border="0" width="100%">
        <tr>
            <td style="white-space:nowrap;"><a href="javascript:__doPostBack('ctl00$NavigationMenu','1')" class="ctl00_NavigationMenu_1" id="ctl00_NavigationMenu_1l">Google Maps</a>
</td><td>
<img src="/WebSite/WebResource.axd?d=2OmH9jTSogXsrUt6aDvnYEihIak%3d_sxBDVaG6ao8vAH1kuYRka4pbdXI%3d_f&amp;t=634787585370000000" border="0" alt="Expand Google Maps" />
</td>
        </tr>
    </table> 
    </td>
<td style="width:3px;"></td>
<td onmouseover="javascript:Menu_OverStaticLeafItem ('ctl00_NavigationMenu','2')" onmouseout="javascript:Menu_OutItem ('ctl00_NavigationMenu','2')">
<table id="ctl00_NavigationMenu_2i" cellpadding="0" cellspacing="0" border="0" width="100%">
        <tr>
            <td style="white-space:nowrap;">
<a href="Liens.aspx" class="ctl00_NavigationMenu_1" id="ctl00_NavigationMenu_2l">Liens utiles</a>
</td>
        </tr>
    </table>
    </td>
<td style="width:3px;">
</td>
<td onmouseover="javascript:Menu_OverStaticLeafItem ('ctl00_NavigationMenu','3')" onmouseout="javascript:Menu_OutItem ('ctl00_NavigationMenu','3')">
<table id="ctl00_NavigationMenu_3i" cellpadding="0" cellspacing="0" border="0" width="100%">
        <tr>
            <td style="white-space:nowrap;">
<a href="About.aspx" class="ctl00_NavigationMenu_1" id="ctl00_NavigationMenu_3l">About</a>
</td>
        </tr>
    </table>
</td>
</tr>
</table>
<div class="" id="ctl00_NavigationMenu_1s" style="visibility:hidden;position:absolute;z-index:1;left:0px;top:0px;">
<div id="ctl00_NavigationMenu_1cu" onmouseover="Menu_OverScrollBtn ('ctl00_NavigationMenu','1','u')" onmouseout="Menu_OutScrollBtn ('ctl00_NavigationMenu','1','u')" style="display:block;text-align:center;">
    <img src="/WebSite/WebResource.axd?d=2OmH9jTSogXsrUt6aDvnYEihIak%3d_BDOep8uzgXhnBosTOAXwCS8Rjzo%3d_f&t=634787585370000000" alt="Scroll up" />
</div>
<div id="ctl00_NavigationMenu_1cb">
    <div id="ctl00_NavigationMenu_1cc">
        <table cellpadding="0" cellspacing="0" border="0">
<tr>
    <td onmouseover="javascript:Menu_OverDynamicLeafItem ('ctl00_NavigationMenu','1_0','1')" onmouseout="javascript:Menu_OutItem ('ctl00_NavigationMenu','1_0','1')">
<table id="ctl00_NavigationMenu_1_0i" cellpadding="0" cellspacing="0" border="0" width="100%">
        <tr>
            <td style="width:100%;white-space:nowrap;">
<a href="Map.htm" class="ctl00_NavigationMenu_1" id="ctl00_NavigationMenu_1_0l">HTML</a>
</td>
        </tr>
    </table>
</td>
</tr>
<tr>
    <td onmouseover="javascript:Menu_OverDynamicLeafItem ('ctl00_NavigationMenu','1_1','1')" onmouseout="javascript:Menu_OutItem ('ctl00_NavigationMenu','1_1','1')">
<table id="ctl00_NavigationMenu_1_1i" cellpadding="0" cellspacing="0" border="0" width="100%">
        <tr>
            <td style="width:100%;white-space:nowrap;">
<a href="Map.aspx" class="ctl00_NavigationMenu_1" id="ctl00_NavigationMenu_1_1l">ASPX</a></td>
        </tr>
    </table>
</td>
</tr>
</table>
    </div>
</div>
<div id="ctl00_NavigationMenu_1cd" onmouseover="Menu_OverScrollBtn ('ctl00_NavigationMenu','1','d')" onmouseout="Menu_OutScrollBtn ('ctl00_NavigationMenu','1','d')" style="display:block;text-align:center;">
    <img src="/WebSite/WebResource.axd?d=2OmH9jTSogXsrUt6aDvnYEihIak%3d_BiLWkNe4ZNGZnI7LWDxYAtinS8U%3d_f&t=634787585370000000" alt="Scroll down" />
    </div>
</div>
<a id="ctl00_NavigationMenu_SkipLink"></a>
            </div> 
```

与 IIS 版本进行比较：

```
<div class="clear hideSkiplink">
            <a href="#NavigationMenu_SkipLink"><img alt="Liens Ignorer la navigation" src="/WebResource.axd?d=vNc13qxX3XhBCykqqeAM4K6DxyzXtiKPMSkmgOEeg_C2LMTfPWT8UVPq_FQ2dO_k8csGANppvDNQ8U1ILvqfCCUzXeU7VT9PTkQGnNHogQU1&amp;t=634679288663570000" width="0" height="0" style="border-width:0px;" /></a><div class="menu" id="NavigationMenu">
<ul class="level1">
   <li>
      <a class="level1" href="Default.aspx">Home</a>
   </li>
   <li>
      <a class="popout level1" href="#" onclick="__doPostBack(&#39;ctl00$NavigationMenu&#39;,&#39;Google Maps&#39;)">Google Maps</a>
         <ul class="level2">
            <li>
               <a class="level2" href="Map.htm">HTML</a>
            </li>
            <li>
               <a class="level2" href="Map.aspx">ASPX</a>
            </li>
         </ul>
   </li>
   <li>
      <a class="level1" href="Liens.aspx">Liens utiles</a>
   </li>
   <li>
   <a class="level1" href="About.aspx">About</a>
   </li>
</ul>
</div>
   <a id="NavigationMenu_SkipLink"></a>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:40:52.833

好的，经过几个小时尝试在web.config中找到解决方案，我终于发现解决方案来自mono-apache-server的版本。我使用了 mono-apache-server2 而不是 4。然后我安装了正确的版本，配置了虚拟主机，现在一切正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T16:04:02.923

ASP.NET 放入的锚标记会自动在菜单上方添加额外的垂直空间。一个锚标记会自动放在菜单上方，这会破坏 Internet Explorer 和 Google Chrome 中的呈现。即使使用带有图像的锚点，它也可以在 Mozilla Firefox 中正常工作。

要解决此问题，请将 SkipLinkText="" 属性添加到您的 ASP.NET 菜单控件，这将解决呈现问题。

```
<asp:Menu ID="NavigationMenu" runat="server" CssClass="menu" EnableViewState="false" IncludeStyleBlock="false" Orientation="Horizontal" SkipLinkText=""> 
```

# jquery - 如何让 jQuery css 影响即将到来的元素

> ID：14086444
> 
> 赞同：1
> 
> 时间：2012-12-29T22:24:34.167
> 
> 标签：jquery, css

有没有办法让 jQuery（或任何 javascript）更改 CSS 方案，而不仅仅是将样式应用于与描述符匹配的当前元素？

假设我的 css 上有这个`.bla{ width: 200px;}`。如果我运行，`$('.bla').css('width', 300);`那么 jQuery 只会将其应用于现有元素。

我想要的是一种使新宽度成为新 .bla 元素的规则的方法。为了做到这一点，如果我继续添加 .bla 元素，那么它们将是 300 宽。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:30:17.643

试试这个：

```
var style = $('<style>body { background: green; }</style>')
$('html > head').append(style); 
```

这是取自[此](https://stackoverflow.com/questions/3393162/creating-a-css-class-in-jquery)链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:34:04.273

当你运行`$('.bla').css('width', 300);`它是由于你的页面中的一个条件。

如果将此条件存储在变量中，那么每次添加新的匹配元素时，您都可以检查它们是否需要修改

```
var someCondition=false;

/* later in code*/
$('.bla').css('width', 300);
someCondition=true;

/* then when add elements*/

var newBla=$('<div class="bla">')
if( someConditon){
  newBla.css('width', 300);
} 
```

如果您使用 CSS 和应用类来执行此操作，则可以使用：

```
toggleClass( 'bla_300_class', someCondition); /* second arument is boolean to add or remove*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T22:39:45.917

你可以这样做：

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" ></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.8/jquery-ui.min.js"></script>
</head>
<body>
<div class="style">
<style>.bla{ width: 200px;}</style>
</div>
<div id="divs"></div>

</div>
<button id="adddiv">Add div</button>
<button id="changeWidth">Click To Change Width</button>
<script>
$(function(){
$("#adddiv").click(function(){
$("#divs").append('<div class="bla" style="border:1px solid red;height:20px;margin:2px;">');
});
$("#changeWidth").click(function(){
$(".style").html("<style>.bla{width:300px;}</style>")
});
});
</script>
</html> 
```

你可以在这里在线测试脚本[JsFiddle](http://jsfiddle.net/s92XU/)

# php - adding if statement to mysql and carrying a search query to a new page?

> ID：14086445
> 
> 赞同：-1
> 
> 时间：2012-12-29T22:24:42.577
> 
> 标签：php, mysql

I'm trying to do 2 things with my search script.

One i want to know how i could add a if statement to say if not results found echo "no results".

And secondly at the moment i limit results to 5, but i want the user to be able to click view more results and if they have been searching for users in 'London' then once they click view all results this will open in a new window and have all the results for their search displayed in the new window?

Can anyone please help me, have been working on this for some time and am still learning php and mysql.

```
<?php
//PHP CODE STARTS HERE

if(isset($_GET['submit'])){

// Change the fields below as per the requirements
$db_host="###";
$db_username="###";
$db_password="";
$db_name="###";
$db_tb_atr_name="display_name";

//Now we are going to write a script that will do search task
// leave the below fields as it is except while loop, which will display results on screen

mysql_connect("$db_host","$db_username","$db_password");
mysql_select_db("$db_name");

$query=mysql_real_escape_string($_GET['query']);

$query_for_result=mysql_query("SELECT *
                        FROM ptb_stats
                        WHERE display_name like '%".$query."%' OR location LIKE '%".$query."%' OR hobbies LIKE '%".$query."%' OR nationality LIKE '%".$query."%' OR gender LIKE '%".$query."%' OR local_station LIKE '%".$query."%' LIMIT 5");
echo "<div class=\"search-results\">";
while($data_fetch=mysql_fetch_array($query_for_result))
{

    echo "<div class=\"text\"><a href=\"profile.php?id={$data_fetch['user_id']}\" class=\"search\">";
    echo "<div class=\"spacing\"><img width=35px height= 30px src=\"data/photos/{$data_fetch['user_id']}/_default.jpg\" class=\"boxgridsearch\"/> "; 
     echo substr($data_fetch[$db_tb_atr_name], 0,160);
    echo "</a></div></div>";

}
echo "<div class=\"morebutton-search\"><a href=\"search_escorts.php?to=echo '%".$query."%'\" target=\"_blank\" \">+ view more results</a></div>";

mysql_close();
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:32:02.137

For your first part you could check with [mysql_num_rows](http://php.net/manual/en/function.mysql-num-rows.php) if 0 rows were returned. Note that `mysql_` is deprecated though and you should be moving on to mysqli or PDO.

```
if(mysql_num_rows($query_for_result)==0){
    echo 'No Results';
}else{
    //process code
} 
```

For your second part it sounds as if you are looking for pagination. You would have a GET variable with the page number and based on that return the correct result set. You could have another GET called place with something like LONDON in. Then your query could be loaded in another page with the correct data displayed.

# ruby-on-rails - 运行“捆绑安装”时“pg gem”安装出错

> ID：14086446
> 
> 赞同：1
> 
> 时间：2012-12-29T22:24:50.947
> 
> 标签：ruby-on-rails, ruby, bundle, pg

运行“捆绑安装”时，我突然遇到了这个问题。一切似乎都正确安装，但后来我遇到了“pg”的问题，就像许多其他人似乎做的那样。正如消息所说，我尝试运行'gem install pg - '0.12.2''，但它仍然失败。

我在 Snow Leopard 10.6 上，这是我得到的错误：

```
Installing pg (0.12.2) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /Users/thomaskim/.rvm/rubies/ruby-1.9.3-p327/bin/ruby extconf.rb 
checking for pg_config... no
No pg_config... trying anyway. If building fails, please try again with
 --with-pg-config=/path/to/pg_config
checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/thomaskim/.rvm/rubies/ruby-1.9.3-p327/bin/ruby
    --with-pg
    --without-pg
    --with-pg-dir
    --without-pg-dir
    --with-pg-include
    --without-pg-include=${pg-dir}/include
    --with-pg-lib
    --without-pg-lib=${pg-dir}/lib
    --with-pg-config
    --without-pg-config
    --with-pg_config
    --without-pg_config

Gem files will remain installed in /Users/thomaskim/.bundler/tmp/1336/gems/pg-0.12.2 for inspection.
Results logged to /Users/thomaskim/.bundler/tmp/1336/gems/pg-0.12.2/ext/gem_make.out
An error occurred while installing pg (0.12.2), and Bundler cannot continue.
Make sure that `gem install pg -v '0.12.2'` succeeds before bundling. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-20T03:41:30.657

首先，您需要确保安装了命令行工具（Xcode 软件包）。由于您使用的是旧版本的 OSX - 您将不得不研究如何做到这一点。

比，使用 homebrew install postgress

```
brew install postgres 
```

在那之后，一切都应该毫无问题地捆绑在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:29:14.940

您似乎没有正确安装 postgres。当我尝试使用 npm 安装 pg 模块时，我遇到了类似的错误。正确安装 postgres 后它消失了。这是一个下载链接：[http ://www.postgresql.org/download/macosx/](http://www.postgresql.org/download/macosx/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:53:25.397

如果您仅在开发模式下在您的机器上运行 rails 并为此使用 sql lite，则无需安装生产包。

因此，如果您的 gemfile 看起来像这样：

```
group :production do
  gem 'pg'
end 
```

尝试使用以下命令安装捆绑包：

```
gem install --without production 
```

# ruby-on-rails - 回滚并更改或创建新的迁移

> ID：14086448
> 
> 赞同：0
> 
> 时间：2012-12-29T22:25:03.940
> 
> 标签：ruby-on-rails, rails-migrations

我只是好奇，
假设我创建了这个迁移：

```
def change
  create_table :pages do |t|
    t.string :title
    t.text :content

    t.timestamps
  end
end 
```

然后我运行迁移。

几个小时后，我记得我也应该添加一`slug`列。

现在（假设我在此之后没有创建任何其他迁移），我应该回滚并在此处添加新字段（在此迁移中），还是应该创建一个新迁移并在那里添加文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:28:44.587

如果您还没有将其推出生产，我会说只是回滚并将其添加到现有的迁移中。如果您已将其部署到生产环境，那么我将进行另一次迁移。

然而，这主要是一个偏好问题，如果没有数据会因此丢失。我只是想养成在生产中以更安全的方式做事的习惯。

# firefox - firefox div with overflow hides the characters on te right

> ID：14086451
> 
> 赞同：0
> 
> 时间：2012-12-29T22:25:21.383
> 
> 标签：firefox, text, overflow, hidden

I have an issue with the right part of the text in a div being hidden when the scrollbar is shown!

No problem with IE, but with Firefox or Chrome.

![enter image description here](../Images/553e7db27291fc1a215ea6ef56808285.png)

Does someone already seen this issue, and possibly have a fix?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:32:02.380

Try using some css properties like margin-right or word-break...

eg:

```
margin-right:10px; 
```

or

```
word-break: break-all; 
```

This might work...

# python - Python 中允许进行复值数学计算，但 numpy 中不允许

> ID：14086458
> 
> 赞同：1
> 
> 时间：2012-12-29T22:27:11.387
> 
> 标签：python, numpy

这在任何地方都有记录吗？为什么会有如此巨大的差异？

```
# Python 3.2
# numpy 1.6.2 using Intel's Math Kernel Library
>>> import numpy as np
>>> x = np.float64(-0.2)
>>> x ** 0.8
__main__:1: RuntimeWarning: invalid value encountered in double_scalars
nan
>>> x = -0.2 # note: `np.float` is same built-in `float`
>>> x ** 0.8
(-0.2232449487530631+0.16219694943147778j) 
```

这尤其令人困惑，因为[根据 this](https://stackoverflow.com/a/7825588/336527)和`np.float64`built-in`float`除了`__repr__`.

我可以看到警告`np`在某些情况下可能有用（特别是因为它可以在 中禁用或启用`np.seterr`）；但问题是返回值`nan`不是内置提供的复杂值。因此，当您开始使用`numpy`某些计算时，这会破坏代码，并且不要将其返回值显式转换为内置浮点数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:29:56.527

`numpy.float`可能是也可能不是`float`，但复数根本不是`float`：

```
In [1]: type((-0.2)**0.8)
Out[1]: builtins.complex 
```

所以没有`float`操作结果，因此`nan`.

如果您不想显式转换为`float`（[推荐](http://docs.scipy.org/doc/numpy/user/basics.types.html#array-scalars)），请`numpy`以复数进行计算：

```
In [3]: np.complex(-0.2)**0.8
Out[3]: (-0.2232449487530631+0.16219694943147778j) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:00:43.613

从浮点运算返回复数的行为当然不常见，并且仅在 Python 3 中引入（例如使用`/`运算符对整数进行浮点除法）。在 Python 2.7 中，您将获得以下信息：

```
In [1]: (-0.2)**0.8
ValueError: negative number cannot be raised to a fractional power 
```

在标量上，如果不是`np.float64`使用`np.float`，您将获得与`float`Python 使用的相同类型。（你要么在 2.7 中得到上述错误，要么在 3.x 中得到复数。）

对于数组，所有 numpy 运算符都返回相同类型的数组，并且大多数 ufunc 不支持从 float > complex 进行强制转换（例如， check `np.<ufunc>.type`）。

*   如果您想要的是对标量的一致操作，请使用`np.float`
*   如果您对数组操作感兴趣，则必须将数组转换为复杂的：`x = x.astype('complex')`

# xcode - 带有故事板的 ViewDeck

> ID：14086459
> 
> 赞同：2
> 
> 时间：2012-12-29T22:27:25.077
> 
> 标签：xcode, ios6, storyboard

[我的应用程序在使用ViewDeck](https://github.com/Inferis/ViewDeck)时遇到了一些问题。
我正在尝试将它与情节提要一起使用，示例仅显示如何将其与 nibfile 一起使用。我已经在 stackexchange 上检查了很多方法，但我似乎没有让它工作。

我在 appdelegate.m 文件中的代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    //UIViewController* leftController = [[UIViewController alloc] init];

    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

    RightViewController* rightController = [[RightViewController alloc] initWithNibName:@"RightViewController" bundle:nil];

    ViewController* centerController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
    self.centerController = [[UINavigationController alloc] initWithRootViewController:centerController];
    IIViewDeckController* deckController = [[IIViewDeckController alloc] initWithCenterViewController:self.centerController rightViewController:rightController];

    deckController.rightSize = 100;

    self.window.rootViewController = deckController;
    [self.window makeKeyAndVisible];
    return YES;

} 
```

我当然得到了预期的错误：

```
2012-12-29 03:55:18.501 Network[27451:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Could not load NIB in bundle: 'NSBundle </Users/Rostgaard/Library/Application Support/iPhone Simulator/6.0/Applications/C2BADD3B-660E-4363-8FC7-932B4E9D6172/Network.app> (loaded)' with name 'RightViewController''
*** First throw call stack:
(0x17cd012 0x15f2e7e 0x17ccdeb 0x755fac 0x61ae37 0x61b418 0x61b648 0x61b882 0xbcdf 0xe673 0xb7e2 0xada7 0x61d753 0x61da7b 0x61e964 0x581877 0x5885a3 0x580eed 0x56ab56 0x56adbf 0x56af55 0x573f67 0x2546 0x5377b7 0x537da7 0x538fab 0x54a315 0x54b24b 0x53ccf8 0x261adf9 0x261aad0 0x1742bf5 0x1742962 0x1773bb6 0x1772f44 0x1772e1b 0x5387da 0x53a65c 0x226d 0x2195 0x1)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-10T14:20:16.073

这是我正在使用的代码，它工作正常：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    UIStoryboard* mainStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle: nil];
    UIViewController* menuController = [mainStoryboard instantiateViewControllerWithIdentifier:@"LeftSideMenu"];

    UINavigationController* navigationController = (UINavigationController *) self.window.rootViewController;
    self.viewDeckController =  [[IIViewDeckController alloc] initWithCenterViewController:navigationController leftViewController:menuController rightViewController:nil];
    self.window.rootViewController = self.viewDeckController;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T00:23:38.660

好吧，我自己通过使用 ECSlidingViewController 解决了这个问题，已经用故事板进行了优化。

[https://github.com/edgecase/ECSlidingViewController](https://github.com/edgecase/ECSlidingViewController)

以防万一有人遇到同样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T18:38:10.017

试试这个[教程项目](https://github.com/simonrice/ViewDeckStoryboardExample)，它有效

# php - PHP：用 mysql 数据填充固定大小的图表

> ID：14086464
> 
> 赞同：0
> 
> 时间：2012-12-29T22:28:15.873
> 
> 标签：php, mysql

我有一个表格图表。让我们说5乘5。我运行一个循环，例如

```
<table>
    <tbody>
     <?php for ($i = 0; $i < 5; $i += 5) {
           echo "<tr>
              <td>one box</td>
              <td>one two</td>
              <td>one three</td>
              <td>one four</td>
           <tr>";
      }?>
     </tbody>
</table> 
```

它创建一个表，例如

```
 |      |      |      |      |       |
 -------------------------------------
 |      |      |      |      |       |
 -------------------------------------
 |      |      |      |      |       |
 -------------------------------------
 |      |      |      |      |       |
 -------------------------------------
 |      |      |      |      |       |
 ------------------------------------- 
```

现在我有我为我的目的加载的mysql数据，我需要它来分别放入数据，所以表格看起来像

```
 |      |      |      |      |       |
 -------------------------------------
 |      |      |      |      |       |
 -------------------------------------
 |      | Res 1|      |      |       |
 -------------------------------------
 |      |      |      | Res 3|       |
 -------------------------------------
 |      |Res 4 |      |      |  Res 2|
 ------------------------------------- 
```

我该怎么做？我有 50 个结果，需要将结果填充到正确的列和行中。我需要做某种 if(results[0-50]['id'] == rowcolumnid) 在执行 for 循环时回显正确表的结果。

* * *

编辑：这是我的完整代码。

```
 <table id="schedule">
        <tbody>
            <?php
            $time = mktime(0, 0, 0, 1, 1);
            for ($i = 28800; $i < 62200; $i += 1800) { ?>
             <tr id="row<?php echo $i; ?>">
                <td id="hour">
                    <?php 
                    printf('%1$s',date('g:i a', $time + $i)); 
                    ?>
                </td>
                                    <td id="sunday"></td>
                                    <td id="monday"></td>
                                    <td id="tuesday"></td>
                                    <td id="thursday"></td>
                                    <td id="friday"></td>
                                    <td id="saturday"></td>
            </tr>
            <?php } ?>
        </tbody>
    </table> 
```

我的 mysql 结果采用日期时间格式，我将使用它来传播表格。

结果：

```
ID| EVENT NAME | DATEOFEVENT
1 | event name | 2012-11-20 12:00:00
2 | event name | 2012-11-21 13:30:00
3 | event name | 2012-11-22 13:00:00
4 | event name | 2012-11-23 11:00:00
5 | event name | 2012-11-24 08:00:00 
```

等等

我可以做一个日期的 strtotime 和一个日期命令来匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:44:27.557

如果您首先获取数据（或者如果您首先获取第一个数据则对其进行了排序），那么您可以在匹配您迭代绘制表格的小时/时间时迭代数据。

例如，我选择只显示一个代表 5 小时 (1-5) 的列，其中一些可以匹配。那些匹配的存储在一个数组中，并作为迭代器 ( [`ArrayIterator`](http://php.net/ArrayIterator)) 提供：

```
$data = [3,5];
$datas = new ArrayIterator($data);
$datas->rewind(); 
```

匹配的时间用 1 表示，不匹配的用 0 表示：

```
echo "+---+---+\n";

foreach(range(1, 5) as $hour)
{
    if ($hasData = ($datas->valid() and $datas->current() === $hour)) {
        $datas->next();
    }
    $hasData = (int) $hasData;

    echo "| $hour | $hasData |\n";
    echo "+---+---+\n";
}; 
```

输出：

```
+---+---+
| 1 | 0 |
+---+---+
| 2 | 0 |
+---+---+
| 3 | 1 |
+---+---+
| 4 | 0 |
+---+---+
| 5 | 1 |
+---+---+ 
```

如果数据中的数据可用作迭代器（通常是这种情况，因为`mysql_*`您需要编写一个）并且它已排序，则此方法非常有效。

即使这只是一个列表，对于一个表来说，这实际上同样有效，因为表只是表示数据的另一种形式。

# ocaml - OCaml - GADT - 布尔表达式

> ID：14086470
> 
> 赞同：5
> 
> 时间：2012-12-29T22:28:46.510
> 
> 标签：ocaml, gadt

我想知道是否有某种方法可以做到这一点：

```
type binary_operator = And | Or;;

type canonical;;
type not_canonical;;

type 'canonical boolean_expression =
  | Var : int -> not_canonical boolean_expression
  | Not : 'canonical boolean_expression -> 'canonical boolean_expression
  | BinOp : canonical boolean_expression * binary_operator * canonical boolean_expression -> canonical boolean_expression
  | BinOp : _ boolean_expression * binary_operator * _ boolean_expression -> not_canonical boolean_expression
;; 
```

这里的问题是我不能定义 BinOp 两次，而我想取决于参数的类型......

PS：“canonical”的意思是“表达式中包含的n个变量用0到(n-1)的整数表示”。这是一个不变量，我需要对我的某些功能强制执行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T09:53:18.873

您必须为类型构造函数指定不同的名称，因为在某些情况下，gadt 的行为确实像 adt。

假设您要定义类型如下：

```
type 'canonical boolean_expression =
  | Bool : bool -> canonical boolean_expression (* here I assume that you wanted to have that case too *)
  | Var : int -> not_canonical boolean_expression
  | Not : 'canonical boolean_expression -> 'canonical boolean_expression
  | BinOpC : canonical boolean_expression * binary_operator * canonical boolean_expression -> canonical boolean_expression
  | BinOpNC : _ boolean_expression * binary_operator * _ boolean_expression -> not_canonical boolean_expression
 ;; 
```

现在考虑稍加修改的类型：

```
type 'canonical boolean_expression =
  | Bool : bool -> canonical boolean_expression
  | Var : int -> not_canonical boolean_expression
  | Not : 'canonical boolean_expression -> 'canonical boolean_expression
  | BinOpC : canonical boolean_expression * binary_operator * canonical boolean_expression -> canonical boolean_expression
  | BinOpNC : 'a boolean_expression * binary_operator * 'a boolean_expression -> 'a boolean_expression
;; 
```

`canonical boolean_expression`现在，您可以使用最后两个构造函数中的任何一个进行二进制操作。显然，通过任意选择结果值的类型获得的自由有其后果：您可以创建具有重叠“类型案例”的小工具。这样做时，任何采用这些值中的任何一个的函数都必须测试这两种情况。因此构造函数的名称不能相同，因为类型可能不足以知道我们正在处理哪些值。

例如下面的函数：

```
 let rec compute = function 
    | Bool b -> b   
    | BinOpC (a,And,b) -> compute a && compute b
    | BinOpC (a,Or,b) -> compute a || compute b
 ;; 
```

给定您的定义，应该对规范表达式进行类型检查并毫无问题地处理。通过我的修改，编译器将理所当然地抱怨也`BinOpNC`可能包含一个`canonical`表达式。

这似乎是暴露 gadt 的这一方面的一个愚蠢的例子（确实是这样），因为我对布尔表达式的修改定义显然是不正确的（从语义上讲），但编译器并不关心类型的语用含义。

本质上，gadt 仍然是 adt，因为您可能仍然会发现必须依靠构造函数来选择正确的操作过程的情况。

# html - HTML5 audio not streaming same file on multiple computers

> ID：14086473
> 
> 赞同：0
> 
> 时间：2012-12-29T22:29:10.933
> 
> 标签：html, html5-audio

I'm using the HTML5 audio tag to create a music player on my remote server. The audio tag works as expected when one computer is playing.

However, I'm getting a problem where if two computers are trying to play the same audio file, one of them will not stream until the other has paused its playing, finished streaming, or stopped streaming.

Is there some programming/server configuration that lets me stream the same file to multiple devices at the same time?

Here's the code, as requested

```
<html>
<body>
    <audio id="jukebox" controls>
    <source id="musiclocation" src="/music/test.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
    </audio>
</body>
</html> 
```

# jquery - 为什么类没有设置attr？

> ID：14086480
> 
> 赞同：0
> 
> 时间：2012-12-29T22:30:14.567
> 
> 标签：jquery, html, css

我有以下 jquery 代码：

```
function InitVoteContainer(voteContainer) {

    var _userVote = voteContainer.children(".storeUserVote").val();
    var _userObjectId = voteContainer.children(".storeObjectId").val();
    var _userVoteKey = voteContainer.children(".storeVoteKey").val();
    var _UserAuth = voteContainer.children(".storeUserAuth").val();

    var _voteButtonUp = voteContainer.children("div[pid='btUp']");
    var _voteButtonDown = voteContainer.children("div[pid='btDown']");

    var upBtValue = 0;
    var downBtValue = 0;

        _voteButtonUp.attr("class", "upVote_inactive");
        _voteButtonDown.attr("class", "downVote_inactive");

        _voteButtonUp.prop("onclick", null);
        _voteButtonDown.prop("onclick", null);

} 
```

该代码将在 upVote 和 downVote 按钮上切换类。代码运行良好，但从未设置类？问题是为什么？

编辑1：

更新一些代码：

此 jquery 代码在文档准备就绪时运行

```
function InitVoteControls() {

$("#mainPostList").find(".voteCon").each(function () {
    InitVoteContainer($(this));
});
} 
```

这是 jquery 使用的 HTML：

```
<ul id="mainPostList" class="verticalList">
        @foreach (var postViewModel in Model.Posts)
        {
            <li>

<div class="postContainer">

<div class="voteCon">
        <input class="storeUserVote" type="hidden" value="@Model.UserVote" />
        <input class="storeObjectId" type="hidden" value="@Model.ObjectId" />
        <input class="storeVoteKey" type="hidden" value="@Model.VoteKey" />
        <input class="storeUserAuth" type="hidden" value="@Request.IsAuthenticated" />

        @if (!Request.IsAuthenticated)
        {
            <div pid="btUpVote" class="upVote"></div>
        }
        else
        {
            <div pid="btUpVote" class="upVote_inactive"></div>
        }

        <br style="clear:both;" />
        <div class="voteCountBox">
            @Html.Encode(Model.VoteBalance)
        </div>
        <br style="clear:both;" />

        @if (!Request.IsAuthenticated)
        {
            <div pid="btDownVote" class="downVote"></div>
        }
        else
        {
            <div pid="btDownVote" class="downVote_inactive"></div>
        }
</div>
</div>
</li>
        }
    </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:32:43.463

您可以使用`addClass`

```
_voteButtonUp.addClass("upVote_inactive"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:47:05.963

真的很难回答这个问题，因为我们没有 HTML 或您如何调用`InitVoteContainer`. 但我可以向您保证，该`.attr`功能对于“类”和价值来说效果很好。

我的第一个猜测是，`voteContainer`参数确保它不为空，并且它是 jQuery 对象，`$(voteContainer)`如果它不是 jQuery 对象，则使用它。

第二个是 HTML 布局，children 函数仅适用于元素的直接子元素，请查看 jQuery 文档。正如您从下面看到的那样，使用`.find()`可以解决您的问题。

> .children() 方法与 .find() 的不同之处在于 .children() 仅沿 DOM 树向下移动一个级别，而 .find() 也可以向下遍历多个级别以选择后代元素（孙子等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T22:37:49.583

这应该有效。也许`_voteButtonUp`没有定义。检查您的选择器。但是，无论如何，使用它`addClass`来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T22:40:08.597

您需要使用 jQuery 中的**addClass()**方法来实现您想要的结果。

```
_voteButtonUp.addClass("upVote_inactive"); 
```

此外，如果您巧妙地使用 CSS 选择器，那么您可以执行**.addClass('inactive');** 在 JS 代码中...

```
#buttonUp .inactive
{
   /* style here */
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T23:03:36.450

在您的 JavaScript 中，您正在选择您的按钮

```
voteContainer.children("div[pid='btUp']"); 
```

这将返回一个空的 jQuery 对象，因为您的标记中没有具有确切属性的 div `pid='btUp'`。您应该使用`pid^='btUp'`- 或直接使用`pid='btUpVote'`。请参阅[此示例](http://css-tricks.com/attribute-selectors/)或[W3C 规范](http://www.w3.org/TR/css3-selectors/#attribute-substrings)。

# wpf - 如何将 DataTable 绑定到 DataGridComboBoxColumn

> ID：14086483
> 
> 赞同：0
> 
> 时间：2012-12-29T22:30:43.057
> 
> 标签：wpf, mvvm, datagridcomboboxcolumn

我在 DataGrid 和 DataGridComboBoxColumn 中有一个 WPF 窗口。我将 DataContext 分配给 Window 如下：

```
cls = new MyClass
            {
                selValue = 2,
                DataGrid = dtGrid,
                ComboGrid = dtCombo
            };

            this.DataContext = cls; 
```

以下是 DataGridComboBoxColumn 的 XAML：

```
 <DataGridComboBoxColumn Header="Item Name" SelectedValueBinding="{Binding Path=Item_Id}" SelectedValuePath="ItemId" DisplayMemberPath="ItemName">
            <DataGridComboBoxColumn.ElementStyle>
                <Style TargetType="ComboBox">
<!-- modified this code as per suggestion ///-->
                    <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.ComboGrid }" />
                </Style>
            </DataGridComboBoxColumn.ElementStyle>
            <DataGridComboBoxColumn.EditingElementStyle>
                <Style TargetType="ComboBox">
                    <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.ComboGrid }" />
                </Style>

            </DataGridComboBoxColu 
```

mn.EditingElementStyle>

仍然网格中的组合框显示空白。组合框中没有列出任何数据。然后，我在 Windows 代码隐藏中编写了以下代码，它开始工作。

```
((DataGridComboBoxColumn)this.testGrid.Columns[1]).ItemsSource = cls.ComboGrid.DefaultView; 
```

**无论如何使用 MVVM 在 XMAL 本身中处理这种情况？我不愿意使用这种方法。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:57:20.843

如果 itemsSource 不在 datagrids itemssource 中，则必须找到祖先：

```
 <DataGridComboBoxColumn itemsSource="{binding RelativeSource={RelativeSource ancestortype=Page}, path=DataContext.YourComboboxItemsSource}" /> 
```

假设您的数据网格在页面上，您可以将祖先类型更改为任何内容。不过，您可以在任何东西上使用 relativeSource。必须使用它的原因是您尝试设置的 itemssource 不是层次结构的一部分，因此无法找到它。希望这可以帮助。

MVVM 我会做类似的事情：

```
 public list<string> ComboboxGridItemsSource { get; set; }
 //Then add some data in the property above.
 ComboboxGridItemsSource.add("Hello world1"); , ect... 
```

当此列表被更改/更新时，请记住使用 INotifyPropertyChanged 提升属性。

```
 //After you implement INotifyPropertyChanged you can raise like this:
 RaiseProperty("ComboboxGridItemsSource"); 
```

使用 MVVM，您通常不会手动将属性直接设置到控件，而是将属性绑定到 xaml 中的该控件。

# c++ - Get the index of the selected item of a datagridview combobox

> ID：14086485
> 
> 赞同：0
> 
> 时间：2012-12-29T22:30:52.553
> 
> 标签：c++, .net, c++-cli

I've searched a lot about the way of getting inedx of selected item of combobox inside datagridview but i have not found it !!

I can get the value of selected item by :

```
dataGridView1[j,i]->FormattedValue 
```

But i can't get the index !

i've tried to cast DataGridView to DataGridViewComboBoxCell to use (SelectedIndex) property

```
DataGridViewComboBoxCell ^ t =  dynamic_cast<DataGridViewComboBoxCell ^>(dataGridView1[j,i]) 
```

but there isn't any propery shown for "t" !

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:24:33.633

DataGridViewComboBoxCell 不跟踪选定的索引。

您可以使用它的编辑控件 DataGridViewComboBoxEditingControl 来获取内部 ComboBox，但它会很笨拙。

您可以做的最简单的事情是通过**IndexOf**查找用于初始化 DataGridViewComboBoxColumn 的所有可能值集合中的单元格值。

# objective-c - Prevent duplicate printout of element in NSMutableArray

> ID：14086488
> 
> 赞同：-1
> 
> 时间：2012-12-29T22:31:09.773
> 
> 标签：objective-c, uiview, nsmutablearray, singleton, uitextfield

I am using a singleton class to transfer a NSMutableArray across views.

The issue I am having is my array is getting displayed multiple times.

Right now I am working with three UITextFields. Each is getting added to the array and outputted in a specific format. Here is what my output looks like:

A / B

C

A / B

C

A / B

C

All I need shown is:

A / B

C

Here is my code if someone can help me find what is missing or needs to be reworked:

To display the text:

```
 UILabel * myLabel = [[UILabel alloc] initWithFrame:CGRectMake(10, 10, 300, 200)];
    [myLabel setFont:[UIFont fontWithName:@"Helvetica" size:10.0]];
    myLabel.numberOfLines = 0;

    NSMutableString * string = [NSMutableString string];

    Education * myEducation = [Education sharedEducation];

    for (Education * output in myEducation.educationOutputArray)
    {
        [string appendString:[NSString stringWithFormat:@"%@ / %@ \n%@\n", [myEducation.educationOutputArray objectAtIndex:0], [myEducation.educationOutputArray objectAtIndex:1], [myEducation.educationOutputArray objectAtIndex:2], nil]];

    }

    myLabel.text = string;

    [self.view addSubview:myLabel]; 
```

Here is where I am saving the text:

```
 -(void)saveButtonTapped:(id)sender
 {
     [_educationArray addObject:_aTextField.text];
     [_educationArray addObject:_bTextField.text];
     [_educationArray addObject:_cTextField.text];

     Education * myEducation = [Education sharedEducation];
     myEducation.educationOutputArray = _educationArray;

     [self.navigationController popViewControllerAnimated:YES];
 } 
```

EDIT *

When a user is entering text into the text fields they can also add a new set of text using the same three text fields.

If I removed the for loop only the first is displayed. How can I get all of the text to display?

EDIT TWO *

I tried this:

```
[string appendString:[NSString stringWithFormat:@"%@ / %@ \n%@\n", [output major], [output university], [output timeAtSchool]]]; 
```

Results in this error:

```
2012-12-29 17:03:07.928 EasyTable[14501:c07] -[__NSCFString major]: unrecognized selector sent to instance 0x7176850
2012-12-29 17:03:07.941 EasyTable[14501:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString major]: unrecognized selector sent to instance 0x7176850'
*** First throw call stack:
(0x1c99012 0x10d6e7e 0x1d244bd 0x1c88bbc 0x1c8894e 0x6162 0xff817 0xff882 0xffb2a 0x116ef5 0x116fdb 0x117286 0x117381 0x117eab 0x1184a3 0x118098 0x2c10 0x10ea705 0x21920 0x218b8 0xe2671 0xe2bcf 0xe1d38 0x2e5213 0x1c61afe 0x1c61a3d 0x1c3f7c2 0x1c3ef44 0x1c3ee1b 0x1bf37e3 0x1bf3668 0x1e65c 0x240d 0x2335 0x1)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:43:37.917

你的`for`循环真的很奇怪；您遍历数组中的每个对象，然后在 for 循环中硬编码索引。我不确定那里发生了什么，但它肯定是奇怪输出的来源。指向`Education`对象的指针是您应该访问的。每次通过循环，使用 的值`output`。

如果您也遇到唯一性问题，请考虑使用 an`NSSet`而不是`NSMutableArray`. 如果您关心订单，请使用`NSOrderedSet`. 集合集合类型不允许重复值。

还有一点：如果您知道您只会访问索引 0、1 和 2 处的值，那么拥有`NSArray`. 只需单独存储每个值并直接访问它。至少没有理由 for 循环。

编辑：

你崩溃是因为你认为你的数组中有`Education`对象，但它确实有纯字符串：

> -[__NSCFString major]：无法识别的选择器发送到实例 0x7176850

请注意，它是说您试图`major`在（该苹果内部使用`__NSCFString`的私有子类）上调用该方法。`NSString`这是一个很好的指标，表明您的数组不包含您认为的内容。`Education`通过使用这三个数据构建对象，确保您将数据正确加载到数组中。

您还建议您尝试过

> [string appendString:[NSString stringWithFormat:@"%@ / %@ \n%@\n", 输出]];

基本上，`stringWithFormat:`所做的就是采用该格式字符串并将其用作模板，然后它需要尽可能多的参数来填充模板中的占位符。`%@`是对象描述的占位符，因此`stringWithFormat:`在格式字符串之后需要三个参数来填充每个`%@`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:43:07.760

您在数组中没有重复项：问题出在 for 循环中

```
for (Education * output in myEducation.educationOutputArray)
{
    [string appendString:[NSString stringWithFormat:@"%@ / %@ \n%@\n", [myEducation.educationOutputArray objectAtIndex:0], [myEducation.educationOutputArray objectAtIndex:1], [myEducation.educationOutputArray objectAtIndex:2], nil]];

} 
```

在这里，您循环遍历数组 3 次（因为数组中有 3 个对象），然后每次打印每个对象。我认为你应该只做 appendString: 没有 for 循环的行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T23:12:15.103

您一次将三个元素添加到数组中，然后您希望一次处理三个元素。

最好创建一个包含三个元素的容器类，并将容器类的实例添加到数组中。

但是如果你真的想这样做，你不能使用`for/in`循环。您必须使用索引变量：

```
NSArray *array = myEducation.educationOutputArray;
for (NSUInteger i = 0, count = array.count; i < count; i += 3) {
    [string appendFormat:@"%@ / %@\n%@\n", array[i], array[i+1], array[i+2]];
} 
```

# php - cannot redirect pages

> ID：14086491
> 
> 赞同：-1
> 
> 时间：2012-12-29T22:31:36.713
> 
> 标签：php, .htaccess, redirect, joomla

what i really need is to redirect this link in my joomla site [http://www.hibasfood.com/index.php/food/1704-2012--00-57-38/13312-2012--08-43-08](http://www.hibasfood.com/index.php/food/1704-2012--00-57-38/13312-2012--08-43-08)

to this link [http://www.hibasfood.com/index.php/food/17-2012-04-20-00-57-38/133-2012-12-28-08-43-08](http://www.hibasfood.com/index.php/food/17-2012-04-20-00-57-38/133-2012-12-28-08-43-08)

how shall i do this using 301 in joomla ?!

p.s i dont have .htaccess file in my joomla folder , but i do have htaccess.txt !

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:52:07.277

把它放在你的根 .htaccess 文件中。

```
Redirect 301  http://www.hibasfood.com/index.php/food/1704-2012--00-57-38/13312-2012--08-43-08    http://www.hibasfood.com/index.php/food/17-2012-04-20-00-57-38/133-2012-12-28-08-43-08 
```

例如：

```
Redirect 301 http://www.yourdomain.com/oldpage.html  http://www.yourdomain.com/newpage.html 
```

# algorithm - 将 Alpha Beta Pruning 算法应用于此树时遇到问题

> ID：14086493
> 
> 赞同：0
> 
> 时间：2012-12-29T22:31:40.810
> 
> 标签：algorithm, search, artificial-intelligence, alpha-beta-pruning

我正在尝试将 alpha beta 修剪算法应用于这个给定的树。

![在此处输入图像描述](../Images/b0a07314dd9a027bd9de5e182f8efe05.png)

当我点击节点 C 时我被卡住了，因为在展开 B 的所有子节点后，我给 A >= -4，然后我展开 C 得到 I =-3，它大于 -4 (-3 >= -4) . 因此，我是否将 A 更新为 -3？如果是这样，那么我之后是否修剪 J 和 K 因为 -3 >= -3 ？当我完成这个例子时，我修剪了 J、K、M 和 N。我真的不确定这个 =(

编辑：

另一个问题：在探索 B 并将 B 的值传递给 A 之后，我们是否将该值传递给 C 进而传递给 I？我看到一个例子就是这种情况。这是：[http ://web.cecs.pdx.edu/~mm/AIFall2011/alphabeta-example.pdf](http://web.cecs.pdx.edu/~mm/AIFall2011/alphabeta-example.pdf)

然而，在这个例子中，[http://web.cecs.pdx.edu/~mm/AIFall2011/alphabeta-example.pdf](http://web.cecs.pdx.edu/~mm/AIFall2011/alphabeta-example.pdf)，它似乎没有传递值，而是它似乎只向上传播值。我不确定哪一个是正确的，或者它是否有什么不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:49:22.700

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-31T13:02:22.900

Whenever I need to refresh my understanding of the algorithm I use this: [http://homepage.ufp.pt/jtorres/ensino/ia/alfabeta.html](http://homepage.ufp.pt/jtorres/ensino/ia/alfabeta.html)

You can enter your tree there and step through the algorithm. The values you would want are:

3 3 3 3

-2 -4 3 etc.

I find that deducing the algorithm from an example provides a deeper understanding.

# php - Assistance with OOP, PDO Shopping Cart Class

> ID：14086494
> 
> 赞同：0
> 
> 时间：2012-12-29T22:31:40.900
> 
> 标签：php, oop, pdo

> **Possible Duplicate:**
> [What is the best method for getting a database connection/object into a function in PHP?](https://stackoverflow.com/questions/228590/what-is-the-best-method-for-getting-a-database-connection-object-into-a-function)
> [Database and OOP Practices in PHP](https://stackoverflow.com/questions/1716652/database-and-oop-practices-in-php)

I am trying to build an OOP shopping cart.

At present, it is half OOP, and half procedural... e.g.

```
function removeFromCart() { 
    require_once('/.../.../connectPDO.php');
    $db = connectPDO();

    $sql = 'DELETE FROM Quotes WHERE User = :user and ProductId = :pid';
    $stmt = $db->prepare($sql); 
    $stmt->execute(array(':user' => $user, ':pid' => $pid));
} 
```

My problem is that if I wish to add to cart, then in my function addToCart, I will need to require the db connection again.

This seems like a complete waste, considering every function will need to contain the following:

```
 require_once('/.../.../connectPDO.php');
    $db = connectPDO(); 
```

I am aware that this is completely in-efficient, and was wondering if anybody could help me write a skeleton OOP cart class which uses the above connection to connect to the DB?

Does this go in the constructor??? Will this stay alive when a user navigates from one page to another at the front end?

I am new to OOP and am completely lost.

Many thanks in advance.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T22:47:06.180

类似以下内容应该可以帮助您入门：

```
$pdo = new PDO('your dsn');
$cartData = new CartData($pdo);
$cart = new Cart($cartData);

class CartData
{
    private $dbConnection;

    public function __construct(PDO $dbConnection)
    {
        $this->dbConnection = $dbConnection;
    }

    public function removeItem($userId, $productId) { 
        $sql = 'DELETE FROM Quotes WHERE User = :user and ProductId = :pid';

        $stmt = $this->dbConnection->prepare($sql);
        $stmt->execute(array(':user' => $userId, ':pid' => $productId));
    }
}

class Cart
{
    private $cartData;

    public function __construct(CartData $cartData)
    {
        $this->cartData = $cartData;
    }

    public function removeItem($userId, $productId) { 
        $this->cartData->removeItem($userId, $productId);
    }
} 
```

请注意，我已经从实际`Cart`类中删除了数据库调用，因为这只会在某些时候使交换到另一个数据库引擎变得困难/不可能。或者您可能想引入一种完整的其他存储数据的方式（嗯，单元测试）。另请注意，我已经使用依赖注入来为类提供它们需要能够执行它们所负责的任何事情的对象。

我已经对要注入的类对象使用了类型提示，但是最好对接口进行类型提示，因为这样可以很容易地将类换成其他类。我强烈建议你使用接口（我上面写的只是一个例子来理解这个想法）。这也使得为您的代码创建单元测试变得非常容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:47:30.920

在每个页面请求中，您都会建立一个新的数据库连接。您不能在请求之间共享连接。

有几种不同的设计模式（最佳实践）来处理这个问题。对于所有这些，您都需要一个 DB 抽象层（如 PDO、Doctrine DBAL 或其他东西）。

## 依赖注入（推荐）

处理这个问题最常用的设计模式是依赖注入：

```
class Foo
{
    /**
     * @var DatabaseAbstractionLayer
     */
    private $dbal;

    public function __construct(DatabaseAbstractionLayer $dbal)
    {
        $this->dbal = $dbal;
    }

    public function methodThatUsesTheDbal()
    {
        $this->dbal->query(...);
    }
}

$db = new DatabaseAbstractionLayer();
$foo = new Foo($db); // constructor injection

$bar = new Bar();
$bar->setDbal($db); // setter injection

$baz = new Baz();
$baz->dbal = $db; // property injection (almost never used) 
```

您可以使用服务容器轻松处理此问题（以[pimple](http://pimple.sensiolabs.org/)为例）：

```
$container = new Pimple();
$container['db'] = $container->share(function ($c) {
    return new DatabaseAbstractionLayer();
});
$container['foo'] = function ($c) {
    return new Foo($c['db']);
};

$foo = $container['foo']->methodThatUsesDbal(); 
```

## 辛格尔顿

```
class DatabaseAbstractionLayer
{
    private static $_instance;
    // ...

    private function __construct()
    {
        // ...
    }

    // ...

    public static function getInstance()
    {
        if (null === self::$_instance) {
            self::$_instance = new static();
        }

        return self::$_instance;
    }
}

class Foo
{
    public function methodThatUsesDbal()
    {
        $db = DatabaseAbstractionLayer::getInstance();
        // ...
    }
} 
```

## 注册处

```
Registery::set('db', new DatabaseAbstractionLayer());

class Foo
{
    public function methodThatUsesRegistery()
    {
        Registery::get('db');
        // ...
    }
} 
```

# java - A simple stack calculator in C, need help understanding details

> ID：14086497
> 
> 赞同：-3
> 
> 时间：2012-12-29T22:31:53.283
> 
> 标签：java, evaluate

```
String hello = "44+"
int result=0, top=-1;
int []stack = new int[hello.length()];
for(int i=0 ; i<hello.length() ; i++)
{
    char c = s.charAt(i);
    if(c >= '0' && c <= '9')
        stack[++top]=(int)(c-'0');
    else
    {
        int x=stack[top--]; //pop
        int y=stack[top--]; //pop
        switch(c)
        {
            case '+' : result = x + y;
                break;
            case '-' : result = y - x;
                break;
            case '*' : result = x * y;
                break;
            case '/' : result = y / x;
                break;
            default : result = 0;
        }
        stack[++top]=result; //push
    }
}
result = stack[top--]; //pop
return result; 
```

44+ stores 8 -> return result happens and when I print it on the main I get 8 as a output.. which is correct

if I replace this code

```
 stack[++top]=(int)(c-'0'); 
```

with this one

```
 stack[++top]=(int)(c); 
```

the output looks like this = 104.. the second code looks correct to me but it doesn't give me the correct output

My questions are

1.  why `c-'0'` is used and not a `c` only ?
2.  why `case '-' : result = y - x` is used and not `x - y` ?
3.  why `case '/' : result = y / x` is used and not `x / y` ?

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:58:22.720

一个字符串（例如“44+”）包含一组字符。字符串中的每个字符都由特定的代码或值表示。字符串“ABC”由值 65,66,67（十进制）表示。字符串“ABC0123456789”分别由值 65,66,67,48,49,50,51,52,53,54,55,56,57 表示。因此，要获得数字字符（“0”到“9”）的数值，您必须从字符代码中减去 48。

关于您的第二个和第三个问题：Y 是压入堆栈的第一个数字，X 是压入堆栈的第二个数字。由于运算应该在第一个和第二个数字之间，它应该是 YX 和 Y/X（它也应该是 Y+X 和 Y*X，但在这种情况下顺序不会改变结果）。

请注意，此代码不适用于两位以上的数字，或者当字符串的格式与示例中的格式不完全相同时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:38:06.817

48 是 '0' 的 ASCII。字符 '0', '1', '2', '3', '4', '5', '6', '7', '8', '9' 的 ASCII 值是 48,49,50 , ... , 57

因此，您可以通过减去 48（与 -'0' 相同）将数字的字符转换为其值

`c - '0'` 是相同的 `c- 48`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:40:27.727

`c`是字符代码，在 C 中基本上是整数。字符零也是如此`'0'`，但它也是数字 48（零的 ASCII 代码）。因此，要将数字字符转换为 C 语言整数，`c - '0'`通常使用类似代码。

换句话说，`char c = '0';`在`char c = 48;`C 中完全等效（在使用 ASCII 编码的计算机上）。

关于 and 的顺序`x`，`y`嗯，`x`在堆栈的顶部，换句话说，最后被推，并且`y`是第二个最上面的，所以你想使用哪个顺序......如果你想要正常的顺序，那就是字符串`"yx/"`意味着`y / x`，然后你需要这样写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T22:41:16.323

这段代码有错误，其中之一是：
行：

```
char c = s.charAt(i); 
```

应该：

```
char c = hello.charAt(i); 
```

此代码假设采用 a[`Postfix Expression`](http://www.cs.csi.cuny.edu/~zelikovi/csc326/data/assignment5.htm) 并计算总数

```
44+  is 4+4 
```

为了计算总数，您应该使用堆栈（在上面的代码中演示）：

44+ 通过两次`pop`操作（x=4 和 y=4）从堆栈中取出，操作是第三次弹出`+`

由于数字是从字符串中提取的字符，因此需要将其转换为 int，如果您检查*[ascii 表](http://www.asciitable.com/index/asciifull.gif)*，您会看到 '0' 是 48，所以当您使用 52 的 char '4' 并计算'4'-'0' 你得到 52-48 即 4 所要求的。

至于操作的顺序，按照`Postfix Expression`操作应该按一个顺序进行：

```
xy+ --> x+y
xy- --> x-y
xy/ --> x/y
xy* --> x*y 
```

以另一种方式（`y/x`例如）这样做是一个错误。

# yeoman - 在无头和浏览器中运行测试

> ID：14086501
> 
> 赞同：1
> 
> 时间：2012-12-29T22:32:21.057
> 
> 标签：yeoman

我想在 PhantomJS 中使用`yeoman test`以及在浏览器中使用`yeoman server:test`. 但问题是 PhantomJS 在我的中找不到我的包含`index.html`：

```
<script src="scripts/view/customer_view.js"></script> 
```

...因为它看起来在 -`test/`目录中。当然，如果我告诉我的咖啡任务将所有文件也复制到`test/`-directory 中，它会起作用。但这似乎是错误的。

那么，有什么方法可以使用：

1.  相同的包括无头和浏览器的路径？
2.  已经在 /temp/scripts 中创建的相同文件？（因为我使用的是 CoffeeScript）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T10:20:31.470

[在GitHub 上](https://github.com/yeoman/yeoman/issues/588)深入挖掘后，我发现我必须替换以下 URI `Gruntfile.js`：

```
// headless testing through PhantomJS
// mocha: {
jasmine: {
    // all: ["test/**/*.html"]
    all: ["http://localhost:3501/index.html"]
} 
```

**笔记**

从 Yeoman *0.9.6*开始，还需要修改 grunt 任务：

```
// Alias the `test` task to run the `jasmine` task instead
// grunt.registerTask("test", "jasmine");
grunt.registerTask("test", "server:phantom jasmine"); 
```

# c# - C# unsafe type -> char*[] , getting a pointer on char array

> ID：14086502
> 
> 赞同：1
> 
> 时间：2012-12-29T22:32:21.053
> 
> 标签：c#, arrays, pointers, pinvoke, unsafe

Have:

```
[DllImport("OpenAL32.dll")]
static extern void alcOpenDevice(char*[] devicename); 
```

Wanna send the name to this function like smth that:

```
char[] data = "Hello!".ToCharArray();
char*[] txt = &data; 
```

But getting the errors:

*   > cannot implicitly convert type `char[] *` to `char * []`

    (funny error, because C# compiler refuses to define `char[] *` in /unsafe mode also :) )

*   > Cannot take the address of, get the size of, or declare a pointer to a managed type (`char[]`)

PS
When does `char` become managed? It's a struct, isn't it?

```
public struct Char : IComparable, IConvertible, IComparable<char>, IEquatable<char> 
```

Although compiler showed info about declaring the pointer to a managed type (`char[]`). I can only suggest that when the type is an array CLR may present it like a managed type, but it sounds very crazy.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T22:46:51.797

alcOpenDevice 不采用`char*[]`或`char**`，它采用`char*`，您应该将其指定为`string`. 它还返回一个句柄。

```
 [DllImport("OpenAL32.dll", CharSet = CharSet.Ansi)]
    static extern IntPtr alcOpenDevice(string devicename); 
```

# ruby - Turning off logging output in activerecord sqlite3 adaptor in ruby

> ID：14086506
> 
> 赞同：0
> 
> 时间：2012-12-29T22:33:26.613
> 
> 标签：ruby, activerecord, sqlite

I use the ActiveRecord-gem for accessing a sqlite3-database, all without Rails. I use it like this:

```
ActiveRecord::Base.establish_connection(
  :adapter => "sqlite3", :database => name_file )

ActiveRecord::Schema.define do
  if ! table_exists? "db_table"
    do_something
  end
end 
```

And then I get an output like

```
-- table_exists?("db_table")
   -> 0.0048s 
```

Which I don't want. According to different posts, a simple

```
ActiveRecord::Base.logger = nil 
```

should do the trick. But this is already nil...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:18:49.117

这些看起来像迁移消息。这应该有助于：

```
ActiveRecord::Migration.verbose = false 
```

# android - YouTubeQuery API - NoClassDefFoundError - Android

> ID：14086512
> 
> 赞同：0
> 
> 时间：2012-12-29T22:34:08.537
> 
> 标签：android, youtube-api, noclassdeffounderror

我是一名 Java 人，最近开始探索 Android，我正在使用 android 开发 Youtube Data API 来查询 youtube 视频。

我在我的项目依赖项中添加了以下 jar 作为外部 jar。

*   激活.jar
*   gdata-client-1.0.jar
*   gdata-client-meta-1.0.jar
*   gdata-core-1.0.jar
*   gdata-youtube-2.0.jar
*   邮件.jar
*   servlet-api.jar

代码编译得很好，但是当我在模拟器中运行应用程序时，我得到了这个异常

```
AndroidRuntime(784): java.lang.NoClassDefFoundError: com.google.gdata.client.youtube.YouTubeQuery 
```

我正在使用日食朱诺。

这是我的 .classpath

```
 <?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="src" path="gen"/>
    <classpathentry kind="con" path="com.android.ide.eclipse.adt.ANDROID_FRAMEWORK"/>
    <classpathentry kind="con" path="com.android.ide.eclipse.adt.LIBRARIES"/>
    <classpathentry kind="lib" path="C:/apache-tomcat-6.0.36-windows-x64/apache-tomcat-6.0.36/lib/servlet-api.jar"/>
    <classpathentry kind="lib" path="C:/Vishwas/gdata-samples.java-1.47.1/gdata/java/lib/gdata-client-1.0.jar"/>
    <classpathentry kind="lib" path="C:/Vishwas/gdata-samples.java-1.47.1/gdata/java/lib/gdata-client-meta-1.0.jar"/>
    <classpathentry kind="lib" path="C:/Vishwas/gdata-samples.java-1.47.1/gdata/java/lib/gdata-core-1.0.jar"/>
    <classpathentry kind="lib" path="C:/Vishwas/gdata-samples.java-1.47.1/gdata/java/lib/gdata-youtube-2.0.jar"/>
    <classpathentry kind="lib" path="C:/Users/Vishwas/Downloads/activation.jar"/>
    <classpathentry kind="lib" path="C:/Users/Vishwas/Downloads/mail.jar"/>
    <classpathentry kind="lib" path="libs/activation.jar"/>
    <classpathentry kind="output" path="bin/classes"/>
</classpath> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T07:10:23.483

它终于为我工作了！！

这就是我所做的。

1）删除我通过属性-> JavaBuildPath->库添加的所有外部jar 2）直接将所有jar添加到libs文件夹中。

它就像一个魅力。我仍然不确定，为什么当我将它添加为外部 jar 时它没有使用 jar。

这是我最新的.classparth！

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="src" path="gen"/>
    <classpathentry kind="con" path="com.android.ide.eclipse.adt.ANDROID_FRAMEWORK"/>
    <classpathentry kind="con" path="com.android.ide.eclipse.adt.LIBRARIES"/>
    <classpathentry exported="true" kind="lib" path="libs/activation.jar"/>
    <classpathentry exported="true" kind="lib" path="libs/android-support-v4.jar"/>
    <classpathentry exported="true" kind="lib" path="libs/gdata-client-1.0.jar"/>
    <classpathentry exported="true" kind="lib" path="libs/gdata-client-meta-1.0.jar"/>
    <classpathentry exported="true" kind="lib" path="libs/gdata-youtube-2.0.jar"/>
    <classpathentry exported="true" kind="lib" path="libs/mailapi.jar"/>
    <classpathentry exported="true" kind="lib" path="libs/servlet-api.jar"/>
    <classpathentry kind="output" path="bin/classes"/>
</classpath> 
```

谢谢

# qt - 无法在 Qt creator 2.6.1 中创建源目录层级

> ID：14086515
> 
> 赞同：0
> 
> 时间：2012-12-29T22:35:10.907
> 
> 标签：qt, qt-creator

我正在使用作为 Qt 5 SDK 一部分的 qtcreator 2.6.1。

当我选择非 Qt 项目（纯 C/C++ 项目）时，它只有 2 个文件夹：标题和源代码，它们也只是合乎逻辑的。

我的文件都在一个文件夹中。编辑器似乎没有为项目创建新目录（甚至不是逻辑目录）的选项。

如何使用 Qt 在某些目录结构中排列我的 .h 和 .c 文件

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:28:54.847

您必须使用 qmake 脚本来描述您的项目。对于分组来源，有`subdirs`模式。CMake 也适用于 QtCreator，并允许您构建源代码。

# java - 为什么我的日期没有正确设置为未来 30 天？

> ID：14086516
> 
> 赞同：1
> 
> 时间：2012-12-29T22:35:17.350
> 
> 标签：java, date

我有以下内容：

```
 Date now = new Date();
    Date futureDate = new Date(now.getYear(), now.getMonth(), now.getDay() + 30); 
```

我想根据当前日期（现在）将未来日期值设置为未来 30 天。

当我调试它时，现在是正确的日期，而 futureDate 是：

```
Sat Jan 05 00:00:00 EST 2013 
```

今天的日期，now 的值为：Sat Dec 29 17:31:58 EST 2012。

这对我来说没有意义吗？

我正在使用 util.Date。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T22:37:48.413

因为`getDay()`返回一周中的某一天，而不是一个月中的某一天。

所以你的

```
now.getDay() + 30 
```

变为星期六 + 30 = 6 + 30 = 12 月 36 日 = 1 月 5 日

一个快速的解决方法是将您的代码替换为：

```
now.getDate() + 30 
```

* * *

但正如其他人已经建议的那样，`java.util.Date`它有点被弃用。你应该使用`Calendar.add()`. 所以你的代码会变成这样：

```
Calendar cal = Calendar.getInstance();
cal.add(Calendar.DATE, +30); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T22:38:31.470

您应该使用 Calendar 及其方法[Calendar](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html) .add

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:46:35.857

如果你想使用日期，你会看到添加天数的工作已经被各种弃用：

[http://docs.oracle.com/javase/7/docs/api/java/util/Date.html](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)

改为使用`new Date(now.getTime() + (MILLISECONDS_IN_DAY * 30))`。或者，如果您不喜欢日期，请使用日历。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T22:39:40.380

该构造函数不仅已弃用，而且仅接受有效日期（1-31）。

尝试改用 java.util.Calendar。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T22:41:49.773

`Date`不应该用于此类计算。

看看[JodaTime](http://joda-time.sourceforge.net/)，它对此类事情非常有用。

# sql - 优化数百万行的自连接

> ID：14086520
> 
> 赞同：6
> 
> 时间：2012-12-29T22:36:22.403
> 
> 标签：sql, sql-server, optimization, sql-server-2012

我有一个表，它是我的 SQL Server 2012 数据库中对象的链接表 ( `annonsid, annonsid2`)。该表用于创建三角形链甚至矩形链，以查看谁可以与谁交换。

这是我在`Matching_IDs`有 150 万行的表上使用的查询，使用此查询产生 1400 万条可能的链：

```
SELECT COUNT(*)
FROM Matching_IDs AS m
  INNER JOIN Matching_IDs AS m2
     ON m.annonsid2 = m2.annonsid
  INNER JOIN Matching_IDs AS m3
     ON m2.annonsid2 = m3.annonsid
       AND m.annonsid = m3.annonsid2 
```

我必须提高性能以花费 1 秒或更短的时间，有没有更快的方法来做到这一点？在我的电脑上查询大约需要 1 分钟。我通常使用 a `WHERE m.annonsid=x`，但它需要相同的时间，因为无论如何它都必须经过所有可能的组合。

更新：最新查询计划

```
|--Compute Scalar(DEFINE:([Expr1006]=CONVERT_IMPLICIT(int,[globalagg1011],0)))
   |--Stream Aggregate(DEFINE:([globalagg1011]=SUM([partialagg1010])))
        |--Parallelism(Gather Streams)
             |--Stream Aggregate(DEFINE:([partialagg1010]=Count(*)))
                  |--Hash Match(Inner Join, HASH:([m2].[annonsid2], [m2].[annonsid])=([m3].[annonsid], [m].[annonsid2]), RESIDUAL:([MyDatabase].[dbo].[Matching_IDs].[annonsid2] as [m2].[annonsid2]=[MyDatabase].[dbo].[Matching_IDs].[annonsid] as [m3].[annonsid] AND [MyDatabase].[dbo].[Matching_IDs].[annonsid2] as [m].[annonsid2]=[MyDatabase].[dbo].[Matching_IDs].[annonsid] as [m2].[annonsid]))
                       |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([m2].[annonsid2], [m2].[annonsid]))
                       |    |--Index Scan(OBJECT:([MyDatabase].[dbo].[Matching_IDs].[NonClusteredIndex-20121229-133207] AS [m2]))
                       |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([m3].[annonsid], [m].[annonsid2]))
                            |--Merge Join(Inner Join, MANY-TO-MANY MERGE:([m].[annonsid])=([m3].[annonsid2]), RESIDUAL:([MyDatabase].[dbo].[Matching_IDs].[annonsid] as [m].[annonsid]=[MyDatabase].[dbo].[Matching_IDs].[annonsid2] as [m3].[annonsid2]))
                                 |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([m].[annonsid]), ORDER BY:([m].[annonsid] ASC))
                                 |    |--Index Scan(OBJECT:([MyDatabase].[dbo].[Matching_IDs].[NonClusteredIndex-20121229-133152] AS [m]), ORDERED FORWARD)
                                 |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([m3].[annonsid2]), ORDER BY:([m3].[annonsid2] ASC))
                                      |--Index Scan(OBJECT:([MyDatabase].[dbo].[Matching_IDs].[NonClusteredIndex-20121229-133207] AS [m3]), ORDERED FORWARD) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T09:47:36.920

一些想法：

尝试两个索引 (annonsid,annonsid2) 和 (annonsid2,annonsid)

您是否尝试过列存储索引？它使表只读，但它可能会提高性能。

此外，查询的一些变体可能会有所帮助。例子：

```
SELECT COUNT(*)
FROM Matching_IDs AS m
  INNER JOIN Matching_IDs AS m2
     ON m.annonsid2 = m2.annonsid
  INNER JOIN Matching_IDs AS m3
     ON m2.annonsid2 = m3.annonsid
where m.annonsid = m3.annonsid2 
```

或者

```
SELECT COUNT(*)
FROM Matching_IDs AS m, Matching_IDs AS m2, Matching_IDs AS m3
where m2.annonsid2 = m3.annonsid
  and m.annonsid2 = m2.annonsid
  and m.annonsid = m3.annonsid2 
```

你检查 CPU/IO-Load 了吗？如果 IO-Load 很高，那么服务器不是在处理数字，而是交换 => 更多 RAM 可以解决问题。

这个查询有多快？

```
SELECT COUNT(*)
FROM Matching_IDs AS m
  INNER JOIN Matching_IDs AS m2
     ON m.annonsid2 = m2.annonsid 
```

如果这非常快，但添加下一个连接会减慢速度，那么您可能需要更多 RAM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:54:20.257

It seems like you already indexed this quite well. You can try converting the hash to a merge join by adding the right multi-column index, but it won't give you the desired speedup of 60x.

I think this index would be on `annonsid, annonsid2` although I might have made a mistake here.

It would be nice to materialize all of this but indexed views do not support self-joins. You can try to materialize this query (unaggregated) into a new table. Whenever you execute DML against the base table, also update the second table (using either application logic or triggers). That would allow you to query blazingly fast.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T07:36:32.730

您应该使这个查询更加分离。我认为首先您应该创建一个表，您可以在其中存储主键 + annonsid，annonsid2 -*如果 annosid 本身不是主键*。

```
DECLARE @AnnonsIds TABLE
(
primaryKey int,
-- if you need later more info from the original rows like captions  
-- AND it is not (just) the annonsid
annonsid int,
annonsid2 int
) 
```

如果你声明一个表，并且你在这个列上有索引，那么通过`WHERE annonsid = @annonsid OR annonsid2 = @annosid`

在第一步之后，你有一个小得多（我猜）和“薄”的桌子可以使用。然后你只需要在这里使用连接或者在上面创建一个临时表和一个 CTE。

我认为它应该更快，这取决于你的条件的选择性，`WHERE`如果有 110 万行适合它，那么它没有意义，但如果只有几百或 tousend，那么你应该试一试！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T07:42:34.513

1 - 将选择更改`Count(*)`为`Count(1)` 或 `Count(id)`

`set Nocount on` 2 -在存储过程的第一个或查询的第一个写入

3 - 使用索引`annonsid`，`annonsid2`

4 - 在你的表中的主键之后有你的索引

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T19:46:22.360

`RelatedIds`您可以通过添加带有`AnnonsId`和`RelatedAnnonId`的表来非规范化数据`Distance`。对于`AnnonsId`表的每个值都将包含每个行`RelatedAnnonId`以及需要遍历才能到达它的关系数，即`Distance`. 现有`MatchingIds`表上的触发器将使用某些已配置的最大值来维护新表`Distance`，例如 3 以处理矩形份额。`AnnonsId`在 ( , `Distance`)上索引表。

*编辑：*`Distance` ( , )上的索引`AnnonsId`将允许您快速找到具有足够相关条目以形成特定形状的行。`MaxDistance`如果您希望能够排除基于（例如，具有三角形但*非*矩形关系的行）的列，则添加列可能很有用。

新查询将`inner join RelatedIds as RI on RI.AnnonsId = m.AnnonsId and RI.Distance <= @MaxDistance`使用所需的“形状”来指示`@MaxDistance`.

它应该在`select`. 缺点是另一个表在更改表时具有大量行和触发器开销`MatchingIds`。

示例： 中有两个条目`Matching_IDs`：(1,2) 和 (2,3)。新表将包含 3 个条目：
1-> 2：距离 = 1
1-> 3：距离 = 2（从 1 到 3 需要一个中间“节点”）
2-> 3：距离 = 1

向匹配的 id (3,1) 添加一个条目将导致另一个条目：
1-> 1: distance = 3

瞧：你找到了一个三角形（距离=3）。

现在，要查找所有三角形，只需执行以下操作：

```
select * 
  from RelatedIds 
 where AnnonsId=RelatedAnnonId 
   and Distance=3 
```

# java - 将 CertPathBuilder 和 PKIX 与非 X509 证书一起使用

> ID：14086522
> 
> 赞同：1
> 
> 时间：2012-12-29T22:36:50.907
> 
> 标签：java, x509, pkix

我正在使用Java 中的[Card Verifiable Certificates](http://en.wikipedia.org/wiki/Card_Verifiable_Certificate)（使用 PrimeKey/EJBCA 的[cert-cvc 库](https://sourceforge.net/projects/ejbca/files/cert-cvc/cert-cvc-1.3.0/)），它们是非 X.509 证书，但它们实现了`java.security.cert.Certificate`.

我想使用现有的链构建算法，即使用`CertPathBuilder`及其 PKIX 实现（在 Oracle/Sun 的安全提供商或 Bouncy Castle 中）来构建这些 CVC 证书的链。我目前坚持使用`PKIXBuilderParameters`我的一组信任锚，因为它显然需要 X.509 证书。

有没有办法在 PKIX 中使用非 X.509 证书？如果没有，有没有办法使用`CertPathBuilder`非 X.509 证书而不必实现我自己的自定义`CertBuilderSpi`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T07:22:13.917

我认为 a`PKIX certpath builder`不适用于 CVC。根据`PKIX (rfc5280)`x.509 验证路径非常具体，包括名称约束、证书策略扩展等。这可能是 trustanchors 需要 x.509 证书的原因。

我能想到的唯一不需要您实现自定义的选项`CertBuilderSpi`是，如果 BC 有一个用于 CVC 的选项，因为它还实现了其他 CVC 证书。

但快速搜索：

```
find . -name "*.java" -exec grep -H "extends CertPathBuilderSpi" {} \; 
```

只显示`PKIX`类。并且 cert-cvc 也没有实现`CertPathBuilder`. 不过，这样的添加会很酷。

干杯，托马斯

# java - 禁用 JAVA 中的所有键和组合键

> ID：14086523
> 
> 赞同：2
> 
> 时间：2012-12-29T22:36:53.310
> 
> 标签：java, windows, focus, key

我想在我的对话框可见时禁用 Windows 键和所有 Windows 键 + X 组合。CTRL + SHIFT + ESC 和 ALT + TAB 也应该被禁用。这可能吗？我只希望我的 JDialog 始终位于顶部，因此即使 StartBar 也不应该是可见的。有人可以帮我解决这个问题吗？

编辑：或者禁用键盘的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:00:03.117

您可以尝试使用[机器人类](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Robot.html)并让机器人不断释放您提到的所有键。举个例子：

```
robot.keyRelease(KeyEvent.VK_CONTROL); 
```

我相信用户仍然可以使用 CTRL+ALT+DEL 来关闭程序。

也看看这个问题：[Use Java to lock a screen](https://stackoverflow.com/questions/6744535/use-java-to-lock-a-screen)

# cuda - 对数组进行排序，而不是对下一个数组进行相同的更改

> ID：14086524
> 
> 赞同：-1
> 
> 时间：2012-12-29T22:36:59.503
> 
> 标签：cuda, thrust

我正在寻找最简单和最快的方法来对一个包含 10^5 个条目的数组进行排序，然后对下一个数组执行相同的操作。数组的大小都相同。例如：

1 一
6 C
3 B

我必须对第一列进行排序，但 6 必须与 c 在同一行：

1 a 3 b 6 c

我想我找到了一些东西，但实现起来看起来很奇怪：

[如何使用 CUDA/Thrust 根据其中一个数组中的值对两个数组/向量进行排序](https://stackoverflow.com/questions/7038838/how-to-sort-two-arrays-vectors-in-respect-to-values-in-one-of-the-arrays-using)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:22:42.583

[推力::sort_by_key](http://docs.thrust.googlecode.com/hg/group__sorting.html#ga2bb765aeef19f6a04ca8b8ba11efff24)正是你所需要的。

这是他们文档中的一个示例。

```
#include <thrust/sort.h>
  ...
  const int N = 6;
  int    keys[N] = {  1,   4,   2,   8,   5,   7};
  char values[N] = {'a', 'b', 'c', 'd', 'e', 'f'};
  thrust::sort_by_key(keys, keys + N, values, thrust::greater<int>());
  // keys is now   {  8,   7,   5,   4,   2,   1}
  // values is now {'d', 'f', 'e', 'b', 'c', 'a'} 
```

如果您已经在 gpu 上有数据，您也可以使用 device_ptr 执行相同的操作。

# matlab - 在 MATLAB 中绘制作为矩阵的函数的梯度

> ID：14086526
> 
> 赞同：2
> 
> 时间：2012-12-29T22:37:21.657
> 
> 标签：matlab

我想在[MATLAB](http://en.wikipedia.org/wiki/MATLAB)中绘制以下函数的梯度。

```
g(x,y) = [(x^2)-1; -y] 
```

我的代码是：

```
x = linspace(-3,3);
y = linspace(-3,3);
[xx, yy] = meshgrid(x,y);
z = [xx.^2-1;-yy];
[dx,dy] = gradient(z,.3,.3);
contour(x,y,z)
hold on 
quiver(x,y,dx,dy) 
```

但我只是收到这个错误：

```
The size of Y must match the size of Z or the number of rows
of Z. 
```

我不知道如何才能使两者的大小匹配。`y`是一个 1x100 矩阵和`z`一个 200x100。为了匹配它们，我需要`y`成为 1x200 或`z`100x100，但我可以绘制它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T07:30:01.240

代替

```
z = [xx.^2-1;-yy]; 
```

分别尝试每个组件：

```
z1 = [xx.^2-1];
z2 = [-yy];
[dx,dy] = gradient(z1,.3,.3);
contour(x,y,z1)
%etc. 
```

`hold on`如果您真的希望它们在同一个情节中，请再次使用。

# php - 从时间戳中选择唯一年份 - 结果与预期不符

> ID：14086530
> 
> 赞同：0
> 
> 时间：2012-12-29T22:37:52.043
> 
> 标签：php, mysql

尝试从表中的时间戳列中选择唯一年份，但到目前为止不成功。大约有 50 行，它们之间有 3 个不同的年份。

```
$getyears = $dbh->prepare("SELECT DISTINCT DATE_FORMAT(timestamp, '%Y') as timestamp FROM press");
$getyears->execute();
$years = $getyears->fetchAll(PDO::FETCH_ASSOC);

print_r($years); 
```

结果是：

```
Array ( [0] => Array ( [timestamp] => ) ) 
```

应该有三个不同的年份。

我不是 MySQL 专家，对 PDO 也很陌生。看不到我哪里出错了。

**更新**

我`timestamp`用反引号括起来，但结果仍然相同。

打印`print_r($getyears->errorInfo());`返回的错误信息：

```
Array ( [0] => 00000 [1] => [2] => ) 
```

`timestamp`是一个`int`类型字段，经过仔细检查，整个表肯定包含 3 个唯一年份。

**更新 2**

更多信息：

所有行在`timestamp`字段 ( `int(11)`) 中都包含以下内容之一：

```
1230587568
1262123568
1356817968 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:44:08.773

您可以显示错误

```
print_r($dbh->errorInfo()); 
```

或者

```
print_r($getyears->errorInfo()); 
```

根据[Reserved Words](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，允许使用不`timestamp`带引号的。虽然，无论如何用反引号引用它是一个好习惯。

[`date_format`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)适用于`date`类型而不是`int`类型。如果`timestamp`是 unix 时间戳（自 1970-01-01 以来的秒数），您可以尝试[`from_unixtime`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_from-unixtime)改用。

# c# - Asp.net Membership Provider 在 url 中显示登录信息

> ID：14086536
> 
> 赞同：2
> 
> 时间：2012-12-29T22:38:53.093
> 
> 标签：c#, asp.net-mvc, razor

我不确定我做了什么，但现在我的网站将其显示为 url：

```
http://localhost:53187/Customer/AccountScreen?UserName=testx&Password=test12345&RememberMe=False&AccountId=5b89d595-ef19-4feb-b95d-bf39672c9ac4 
```

我正在调用客户的帐户屏幕，如下所示：

```
return RedirectToAction("AccountScreen", "Customer", model); 
```

所以，我不明白为什么它现在在 url 中显示这个。这对我来说真的是一个不好的做法。

有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:51:04.573

您可以只包含您感兴趣的值：

```
return RedirectToAction(
    "AccountScreen", 
    "Customer", 
    new { AccountId = mode.AccountId }
); 
```

将重定向到`http://localhost:53187/Customer/AccountScreen?AccountId=5b89d595-ef19-4feb-b95d-bf39672c9ac4`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:33:12.317

目前尚不清楚为什么要将模型传递给 RedirectToAction 方法。第三个参数用于 routeValues。

无论您传递给 routeValues 参数，都会在 url 中公开其属性。去掉第三个参数就OK了。如果您需要将任何内容传递给 AccountScreen，请使用类似

```
return RedirectToAction("AccountScreen", "Customer", new { id = model.Id }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:48:02.263

[RedirectToAction](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.redirecttoaction%28v=vs.108%29.aspx)方法向浏览器返回一个`HTTP 302`响应，这导致浏览器向`GET`指定的操作发出请求。因此，您看到的是一个以模型作为路由值的 get 请求。HTTP 不支持使用 POST 进行重定向，因此您无法更改它。

你可以做什么 - 从你的控制器调用方法而不返回浏览器（如果这是同一个控制器）：

```
return AccountScreen(model); 
```

* * *

您可以使用[TempData](http://blogs.teamb.com/craigstuntz/2009/01/23/37947/)来存储您的模型（这也将是 GET 请求，但模型不会在路由值中传递 - 它将存储在会话中）。在您的控制器中：

```
TempData["model"] = model;
return RedirectToAction("AccountScreen", "Customer"); 
```

在客户控制器中：

```
public ActionResult AccountScreen()
{
    YourModel model = TempData["model"] as YourModel;
    //...
} 
```

# python - 如何在两个类之间调用方法？

> ID：14086537
> 
> 赞同：1
> 
> 时间：2012-12-29T22:39:27.677
> 
> 标签：python, python-2.7, python-2.x

我有一堂课`A`。在`__init__`一个实例的方法期间`A`；

我创建了以下两个类实例`B`和`C`：

```
b = B()
c = C() 
```

一切就绪后，我需要在 的方法中调用`B`的方法`C`。

例子：

触发：

```
b.call_c() 
```

做：

```
def call_c(self):
    parent.c.a_method_of_c() 
```

我需要做什么来实现这个结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:45:15.997

您需要传递 of`self`或`c`to`B()`以便它可以了解其他对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:22:54.723

> 我需要在 的方法中调用`B`来自 的方法`C`。

基本上，如果方法不是*类方法*或*静态方法*，那么调用方法总是意味着您可以访问类的 ( `c`) 对象`C`。

看看这个例子：

```
#!python3

class B:
    def __init__(self, value):
        self.value = value

    def __str__(self):
        return 'class B object with the value ' + str(self.value)    

class C:
    def __init__(self, value):
        self.value = value

    def __str__(self):
        return 'class C object with the value ' + str(self.value)    

class A:
    def __init__(self, value):
        self.value = value
        self.b = B(value * 2)
        self.c = C(value * 3)

    def __str__(self):
        lst = ['class A object with the value ' + str(self.value),
               '  containing the ' + self.b.__str__(),
               '  containing also the ' + str(self.c),
               ]
        return '\n'.join(lst)

a = A(1)
print(a)
print(a.b)
print(a.c) 
```

这`self.b.__str__()`是从类对象的方法调用`B`类对象的方法的例子`A`。`str(self.c)`相同，只是通过函数间接调用`str()`。

显示如下：

```
class A object with the value 1
  containing the class B object with the value 2
  containing also the class C object with the value 3
class B object with the value 2
class C object with the value 3 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T23:42:55.223

如果您将 A 对象作为父/容器对象同时传递给 B 和 C，则如下所示：

```
class A(object):
    def __init__(self):
        self.b = B(self)
        self.c = C(self)

class B(object):
    def __init__(self, parent):
        self.parent = parent

    def call_c(self):
        self.parent.c.a_method_of_c()

class C(object):
    def __init__(self, parent):
        self.parent = parent

    # whatever... 
```

或者，您可以像这样将 C 实例传递给 B 的初始化程序：

```
class A(object):
    def __init__(self):
        self.c = C()
        self.b = B(self.c)

class B(object):
    def __init__(self, c):
        self.cobj = c

    def call_c(self):
        self.cobj.a_method_of_c()

class C(object):
    # whatever... 
```

我更喜欢第二种方法，因为它消除了 B 和 C 对 A 的依赖，以及 A 实现`b`和`c`属性的必要性。

如果 B 和 C 必须相互调用方法，您仍然可以使用 A 来建立这些关联，但要保持 B 和 C 不知道 A：

```
class A(object):
    def __init__(self):
        self.b = B()
        self.c = C()
        self.b.cobj = self.c
        self.c.bobj = self.b

class B(object):
    def __init__(self, c):
        self.cobj = None

    def call_c(self):
        if self.cobj is not None:
            self.cobj.a_method_of_c()
        else:
            raise Exception("B instance not fully initialized")

class C(object):
    # similar to B 
```

一般来说，您的目标是尽量避免或至少最小化这些依赖关系——让父母了解孩子，但孩子不了解父母。或者一个容器知道它包含的对象，但包含的对象不知道它们的容器。一旦添加了循环引用（对父对象或容器对象的反向引用），事情就会以各种令人惊讶的方式变得丑陋。当其中一个链接被清除而不是反射链接时，关系可能会被破坏。或者循环关系中的垃圾收集可能会变得棘手（在 Python 本身中处理，但如果这些对象和关系在框架中持久化或复制，则可能无法处理）。

# javascript - javascript 前置？

> ID：14086538
> 
> 赞同：0
> 
> 时间：2012-12-29T22:39:32.497
> 
> 标签：javascript, html

我正在尝试将 jquery UI 用于小书签中的滑块。并且 jquery ui 需要在普通 jquery 文件之后包含该文件。

所以到目前为止我所尝试的只是将脚本附加到标题，同时确保在普通 jquery 之后添加 ui 但这不起作用我怀疑这可能是因为我附加了它而不是预先附加了它。

因此，经过一段时间的搜索，我现在正在寻找在 Javascript 中预先添加的方法：

```
var parent_head = document.getElementsByTagName("head")[0];

document.getElementsByTagName("head")[0].appendChild(jqueryUI, parent_head.firstChild); 
```

然而，这似乎以正常方式附加它。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:54:35.307

使用[`insertBefore`](https://developer.mozilla.org/en-US/docs/DOM/Node.insertBefore)第一个孩子作为插入点。

```
parent_head.insertBefore(jqueryUI, parent_head.firstChild) 
```

例如，

```
var list = document.createElement('ul');
document.body.appendChild(list);
list.innerHTML = "<li>First</li><li>Second</li>";

var newItem = document.createElement('li');
newItem.innerHTML = "Firster";

list.insertBefore(newItem, list.firstChild); 
```

节目

*   第一
*   第一的
*   第二

# php - 根据各种标准使用 preg_match 验证用户名

> ID：14086540
> 
> 赞同：0
> 
> 时间：2012-12-29T22:39:37.160
> 
> 标签：php, regex, preg-match

所以我继续我的php之旅。现在创建注册表并验证用户请求的用户名。这是我到目前为止所拥有的：

```
if (preg_match("([a-z 0-9](?=.{3})(?!.{10}))", $user_Name)) 
```

我使用“RegExr”来创建这个匹配，但它似乎不起作用。添加了一个大写字母，它仍然说它是有效的

本来打算：

*   从 0 到 9 的数字
*   没有大写字母
*   完全没有特殊符号
*   最少 6 个字符
*   最多 10 个字符

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T03:49:14.143

根据您的规则，这应该有效：

```
if (preg_match('/^[a-z0-9]{6,10}$/', $user_name)) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-30T11:11:30.780

经过大约 3 小时的研究和故障排除后，我找到了正确的解决方案。事实证明，顺序非常重要：

(?=.{5}) <=== 字符串必须为 5 或更多

(?!.{11}) <=== 字符串不能超过 10 个字符

^[az 0 -9]+$ <=== 匹配任何仅包含 0 -9 中常见字母和数字的字符串

```
if (!preg_match('/(?=.{5})(?!.{11})^[a-z 0 -9]+$/', $user_Name)) {
            echo 'username is not valid</br>';
            echo $user_Name;
        }
        else {
            echo 'username is valid</br>';
            echo $user_Name;
        } 
```

# php - 如何关闭准备语句连接？这是对的？- PDO

> ID：14086544
> 
> 赞同：3
> 
> 时间：2012-12-29T22:39:51.587
> 
> 标签：php, html, pdo, prepare

我使用此代码，例如：

```
$result = $link->prepare("SELECT * FROM animals WHERE id = '$id'");
$result->execute();
$row = $result->fetch(PDO::FETCH_ASSOC);
$result = null;
$link = null; 
```

可以使用“$result = null;” 关闭这个连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:04:16.123

> 可以使用“$result = null;” 关闭这个连接？

它不会关闭数据库连接。但是它会关闭`PDOStatement $result`，这可能是您所关心的。

如果您想关闭与所有相关资源的连接，您可以使用

```
$link = null; 
```

你也有。所以我在这里根本看不到任何问题。我什至必须承认，我有点想知道是什么让你这么问。

# c++ - Qt QDbus 使用 QVariant 发送自定义类型

> ID：14086545
> 
> 赞同：0
> 
> 时间：2012-12-29T22:39:55.630
> 
> 标签：c++, qt, dbus, qvariant, qdbus

我正在尝试通过 Qt 中的 Dbus 会话总线在 2 个简单应用程序之间的 QVariant 内发送自定义类（“Span”）。Span 是一个包含 2 个双精度类型属性的简单类。我已经成功地通过 dbus 接口发送并恢复了一个仅包含 QString 的 QVariant，就像我在下面尝试使用自定义类的 QVariant 一样。

Span 在类头文件中包含以下 QMETATYPE QVariant 注册声明：

```
Q_DECLARE_METATYPE(Span) 
```

我有 2 个测试应用程序，一个发送者和一个接收者 - 两者都具有完全相同的“跨度”类定义。在我的发件人应用程序中，我这样做：

```
qDebug() << "Sending QVariant Span to receiver...";
//int spanID = QMetaType::type("Span");
Span span(100,0.5);
//QVariant settingVariant(spanID, &span);
//QVariant settingVariant(QString("HELLO"));
QVariant settingVariant;
settingVariant.setValue(span);

QDBusVariant setting( settingVariant );
response = client->setSetting(setting);
qDebug() << "RESPONSE: " << response;

QVariant result = setting.variant(); // THIS WORKS - I can just extract my 'Span' here with the correct property values set
QVariant test = QVariant::fromValue(result);
Span testSpan = test.value<Span>();
qDebug() << "Setting Span to -- Low: " << testSpan.m_lowTemp 
         << "High: " << testSpan.m_highTemp; 
```

'setSetting' 方法定义为：

```
inline QDBusPendingReply<int> setSetting(const QDBusVariant setting)
{
    QList<QVariant> argumentList;
    argumentList << QVariant::fromValue(setting);
    return asyncCallWithArgumentList(QLatin1String("setSetting"), argumentList);
} 
```

在接收器中，我像这样注册“跨度”类：

```
qRegisterMetaType<Span>();
qDBusRegisterMetaType<Span>(); 
```

然后我尝试像这样恢复 Span 类：

```
int DbusServerTemplate::setSetting( const QDBusVariant &setting ) {
    QVariant result = setting.variant();
    QVariant test = QVariant::fromValue(result);
    Span stuff = test.value<Span>();
    qDebug() << "Setting Span to -- Low: " << stuff.m_low 
             << "High: " << stuff.m_high; 
```

上面的代码给了我 Span 类属性的虚假值：

```
Setting Span to -- Low:  1.44144e-305 High:  5.24729e-261 
```

我究竟做错了什么？我可以在 Sender 应用程序中对 Span 实例进行编码和解码，但是一旦接收器类通过 dbus 获取它，我就会得到虚假值。我真的很感激任何想法/帮助！

注意：我确实在我的 Span 类中实现了流式操作符，如下所示（接收方和发送方应用程序中都存在相同的类实现）：

```
// Simple getters for the low and high temps
double Span::getHighTemp() const { return m_high; }
double Span::getLowTemp() const { return m_low; }

// Marshall the Data data into a D-Bus argument
QDBusArgument &operator<<(QDBusArgument &argument, const Span &span)
{
   argument.beginStructure();

   double high = span.getHighTemp();
   double low = span.getLowTemp();
   argument << high;
   argument << low;
   argument.endStructure();

   return argument;
}

// Retrieve the Data data from the D-Bus argument
const QDBusArgument &operator>>(const QDBusArgument &argument, Span &span)
{
   double high, low;

   argument.beginStructure();
   argument >> high;
   argument >> low;
   argument.endStructure();
   span.m_high = high;
   span.m_low = low;

   return argument;
} 
```

# javascript - 使用 JavaScript 的 Textarea 字符计数

> ID：14086546
> 
> 赞同：1
> 
> 时间：2012-12-29T22:40:02.580
> 
> 标签：javascript, jquery, textarea, addeventlistener, charactercount

我正在为表单的 textarea 字段实现字符计数。我目前有 jQuery 使用此代码计算和编写我的字符语句：

```
$("#textarea").keyup(function(){
    $("#count").text("Characters left: " + (500 - $(this).val().length));
}); 
```

但是，我想知道我的 JavaScript 有什么问题：

```
var textarea = document.forms["form"].elements.textarea;

textarea.addEventListener("keypress", textareaLengthCheck, false);

function textareaLengthCheck(textarea) {
var length = textarea.length;
console.log(length);
var charactersLeft = 500 - length;
console.log(charactersLeft);
count.innerHTML = "Characters left: " + charactersLeft;
} 
```

变量声明和事件侦听器位于 jQuery 文档就绪函数中。我不确定我在为我的事件侦听器或函数做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:46:39.003

该变量`textarea`不存在于函数的作用域中，您可以使用`this`关键字引用它

```
function textareaLengthCheck() {
    var length = this.value.length;
    var charactersLeft = 500 - length;
    var count = document.getElementById('count');
    count.innerHTML = "Characters left: " + charactersLeft;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T22:43:49.770

代码中的处理程序未传递与事件相关的元素。它传递了一个事件对象。因为您使用参数声明了函数，所以隐藏了在外部范围中声明的变量。

问题在这里：

```
function textareaLengthCheck(textarea) { 
```

您在函数定义中包含了一个名为“textarea”的参数。这就是符号在函数内部的含义，因此也称为“textarea”的外部变量在该函数内部不可见。

请注意，Firefox、Chrome 和 Safari 都会报告错误的`<textarea>`值长度。这些浏览器报告文本区域的长度，就好像所有显式换行符（即用户按“Enter”键的位置）作为一个字符。事实上，当浏览器发布一个包含 a 的表单时`<textarea>`，所有显式换行符都会转换为两个字符序列（回车和换行）。因此，如果您为了防止服务器溢出而设置最大长度，则除非您将换行符视为两个字符，否则它将不起作用。为此，您必须获取值的长度，然后在字符串中添加换行符的数量（使用正则表达式或其他东西找到）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T13:38:30.150

因为您使用的是 jquery

插件怎么样

[http://keith-wood.name/maxlength.html](http://keith-wood.name/maxlength.html)

```
$("#limited-textarea").maxlength({
    max: 400
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-27T18:42:37.940

```
var maxchar = 10;
$('#message').after('<span id="count" class="counter"></span>');
$('#count').html(maxchar+' of '+maxchar);
$('#message').attr('maxlength', maxchar);
$('#message').parent().addClass('wrap-text');
$('#message').on("keydown", function(e){
	var len =  $('#message').val().length;
	if (len >= maxchar && e.keyCode != 8)
		   e.preventDefault();
	else if(len <= maxchar && e.keyCode == 8){
		if(len <= maxchar && len != 0)
	   		$('#count').html(maxchar+' of '+(maxchar - len +1));
	   	else if(len == 0)
	   		$('#count').html(maxchar+' of '+(maxchar - len));
	}else
		 $('#count').html(maxchar+' of '+(maxchar - len-1)); 
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea id="message"></textarea>
```

# node.js - Nodemailer 错误：[错误：未定义传输方法]

> ID：14086550
> 
> 赞同：3
> 
> 时间：2012-12-29T22:40:36.853
> 
> 标签：node.js, sendgrid, nodemailer

我正在将 nodemailer 与 sendgrid 一起使用，但出现错误：`[Error: No transport method defined]`

我正在像这样设置传输：

```
var email = nodemailer.createTransport("STMP", {
service: "Sendgrid",
auth: {
    user: "username",
    pass: "pass"
}
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-10-21T16:30:10.187

它说“STMP”而不是“SMTP” - 简单的错字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-01T09:50:27.250

您使用了错误的方法...而不是 STMP 使用 SMPT（简单邮件传输协议）。如下

```
var transport = nodemailer.createTransport("SMTP", {
    service: 'gmail',
    auth: {
        user: 'youremail@address.com',
        pass: 'yourpassword'
    }
}) 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2018-02-09T08:21:16.753

只是打字错误。你写错了 SMTP 的拼写。因此，正确的解决方案是：-

```
var email = nodemailer.createTransport("SMTP", {
    service: "Sendgrid",
    auth: {
        user: "username",
        pass: "pass"
    }
}) 
```

# php - 正则表达式将引号添加到未引用的表达式

> ID：14086557
> 
> 赞同：0
> 
> 时间：2012-12-29T22:41:20.223
> 
> 标签：php, regex, pcre

我正在尝试构建一个正则表达式，`preg_replace`如果它没有被引用，它将用来引用表达式的右侧。

就这样`myvar = 3`变成了`myvar = '3'`。它应该只处理不带引号的连续字符串（因此，如果第一个字符串上的任何空格需要被引用，例如`myvar = 3 5`将变为`myvar = '3' 5`）。

我还希望它忽略任何带引号的字符串，因此`myvar = 'this is quoted'`不应修改。

到目前为止，我有以下代码：

```
$str = 'myvar = 3';
$regex = '/([\w\@\-]+) *(\=|\>|\>\=|\<|\<\=) *([\w]+)/i';
$replace = '\1 \2 \'\3\'';
$result = preg_replace($regex, $replace_str, $str); 
```

我需要投入什么才能完成`$regex`这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:47:21.640

您可以使用 preg_replace_callback，或者这可能有效（仅限正则表达式的右侧）：

`#([^\'\"])(\w+)([^\'\"])#`

并像这样替换：

```
$exp = '#([^\'\"])(\w+)([^\'\"])#';
$str = 'This is unquoted';
$quoted = preg_replace($exp, '\'$1$2$3\'', $str); // should hopefully be 'This is unquoted' after. Not tested. 
```

不过，这是一种 hacky 解决方法。

编辑：是的，不行。我会推荐 preg_replace_callback 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T12:43:10.833

我最终解决了以下问题：

```
$str = 'myvar = 3';
$regex = '/([\w\@\-]+) *(\=|\>|\>\=|\<|\<\=) *([^\s\']+)/i';
$replace = '\1 \2 \'\3\'';
$result = preg_replace($regex, $replace_str, $str); 
```

我需要这作为多步骤操作的一个步骤，所以我想使用这个正则表达式来烘焙一个可以一次性完成所有事情的超级正则表达式。然而，事实证明`preg_replace`也可以输入“搜索”和“替换”数组，因此我将其作为最终解决方案。这种方式也更容易掌握。

干杯。

# c++ - 代码行在两行之后不起作用

> ID：14086561
> 
> 赞同：3
> 
> 时间：2012-12-29T22:42:28.253
> 
> 标签：c++, list, function

这令人费解。我需要在我的程序中使用一个函数 CCountry::getName()。奇怪的是，在测试它是否完全有效时，它在一个地方有效，但在两行以下不起作用，我不知道为什么。例如...

```
while(line != "---" && line != "------")
    {
        CCountry *tempCountry = new CCountry(line);
        cout << tempCountry->getName() << flush;
        (*tempContinent).addCountry(*tempCountry);
        getline(filestr, line);

    } 
```

作品。它按顺序列出了所有国家/地区名称。然而...

```
 while(line != "---" && line != "------")
    {
        CCountry *tempCountry = new CCountry(line);
        (*tempContinent).addCountry(*tempCountry);
        getline(filestr, line);
        cout << tempCountry->getName() << flush;
    } 
```

不工作。它甚至无法打印一个国家/地区名称，而是在调用 getName() 的行上抛出一个段错误。

这里有两个函数供进一步参考，getName() 和 addCountry()

```
string CCountry::getName()
{
return *name;
} 
```

和

```
void CContinent::addCountry(CCountry country)
{
(*countries).push_back(country);
} 
```

根据请求，这里是 CCountry 构造函数：

```
CCountry::CCountry(string in_name)
{
name = new string;
*name = in_name;
player = new int;
*player = -1;
units = new int;
*units = 0;
neighbors = new list<CCountry>;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T23:00:40.980

我可以喋喋不休地列出一长串代码有问题的地方，但导致你的错误的最终原因如下：

**您的 CCountry 课程没有练习[3 规则，](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)因为它具有动态分配的成员，所以*必须这样做。***（顺便说一句，甚至不需要）。

您正在通过按值获取国家/地区的成员函数将您的 CCounty 对象添加到您的大陆。当时制作了对象的浅表副本。然后，您将其推送到大陆内的容器中，这会生成另一个浅表副本。在 addCountry() 退出时，原始浅表副本被破坏，并且在此过程中，当您返回调用代码时，CCountry 对象的内部已被破坏。因此，您的本地（不应该首先动态分配，顺便说一句）被正式冲洗。

你猜怎么着……你大陆集装箱里的那个也是。

我可能会首先考虑 CCountry 对象本身。就个人而言，我会在 CContinent 类而不是 CCountry 中管理 CCountry 的邻居，因为无论如何管理 CCountry 对象的集合，但对每个人都是自己的。如果您决定坚持使用当前模型，CCountry 的潜在替代方案可能是这样的：

```
class CCountry
{
public:
    CCountry(const std::string& name)
       : name(name), player(0), units(0)
    {
    }

    // properties
    const std::string& getName() const { return name; };
    int getPlayer() const { return player; };
    void setPlayer(int player) { this->player = player; };
    int getUnits() const { return units; };
    void setUnits(int units) { this->units = units; };

    // neighbor access
    const std::list<const CCountry*> getNeighbors() const
    {
        std::list<const CCountry*> res;
        for (auto it=neighbors.begin(); it != neighbors.end(); ++it)
            res.push_back(it->second);
        return res;
    }

    // adding a new neighbor
    void addNeighbor(const CCountry& other)
    {
        neighbors[ other.getName() ] = &other;
    }

private:
    std::string name;
    int player;
    int units;
    std::map<std::string, const CCountry*> neighbors;
}; 
```

但请注意：追求这样的模型（正如您所看到的，您的原始模型）将有潜在的陷阱，特别是 CCountry 可能具有指向另一个 CCountry 的指针的可能性，该指针在技术上 *它并不拥有*。这就是为什么我更喜欢由 CContinent 类本身管理邻居关联的原因，因为它同时拥有 CCountry 及其邻居关联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:01:54.377

我怀疑您已经定义了`CCountry`这样的析构函数：

```
~CCountry() {
    delete name;
    delete player;
    delete units;
    delete neighbors;
} 
```

但我怀疑你**没有**为`CCountry`. 这意味着编译器正在生成这样的复制构造函数：

```
CCountry(CCountry const &that) :
    name(that.name),
    player(that.player),
    units(that.units),
    neighbors(that.neightbors)
{ } 
```

现在，`CContinent::addCountry`被定义为采用 a `CCountry`，而不是 a `CCountry &`。因此，当您这样做时，您的程序会使用该编译器定义的复制构造函数来`(*tempContinent).addCountry(*tempCountry)`制作（临时）副本。`*tempCountry``CCountry`

所以现在你的程序有两个独立的实例`CCountry`：一个由 指向`tempCountry`，另一个在`CContinent::addCountry`'`country`参数中。但是由于编译器定义的复制构造函数的工作方式，两个实例都有`name`指向同一个`string`实例的成员变量。

删除临时副本时，其析构函数会删除该字符串实例。现在 指向的实例在其成员变量`tempCountry`中有一个悬空指针。`name`当您尝试取消引用该悬空指针时`getName`，该行为未定义，并导致您的分段错误。

将您的`name`、`player`、`units`和`neighbors`成员变量更改为*不是*指针。它们应该只是普通类型，如下所示：

```
class CCountry {
    string name;
    int player;
    int units;
    list<CCountry *> neighbors;
}; 
```

您可能还想更改函数以获取引用而不是副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T22:51:52.217

您是否有可能在 CCountry 的构造函数中造成某种覆盖？听起来对我来说。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T23:05:28.457

在 CCountry 的构造函数中，您使用 分配名称，`new string`而在析构函数中，您可能使用`delete name`. 我不知道你为什么需要这样做，它可能更简单存储而`string`不是`string*`作为`name`. `CCountry`当您将`CCountry`其作为参数传递给`CContinent::addCountry`临时副本时，它将被创建然后删除，这将导致删除`CCountry::name`在多个`CCountry`. 为避免这种情况，您需要使用 `string`而不是作为 CCountry的`string*`成员或实现您自己的 CCountry 复制构造函数。`name``CCountry`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T23:09:02.760

这段代码有很多问题，但对于初学者来说，确实`CCountry`有值语义或者它是一个实体类型。在第一种情况下，您不应该有指向它的指针，或者使用动态分配它`new`。并且您应该确保它可以被正确复制和分配。其次，您不应该将其按值传递给`CContinent::addCountry`（并且您可能应该通过将复制构造函数和赋值运算符设为私有或从 派生来禁止复制和赋值`boost::noncopyable`）。

您没有显示 的​​定义`CCountry`，但您初始化的方式`name`表明您假设它 `std::string`是一个实体对象。它不是——它具有值语义，并且几乎没有任何情况下你会有一个指向 a 的指针`std;:string`。（一个例外是作为函数参数或返回值，您希望支持空指针来指示值的缺失。）同样的事情适用于`player`,`units`和`neighbors`: 上下文，您将有一个指向`int`或指向标准容器仅限于需要空指针来指示缺少值的情况。

您也没有展示使用复制构造函数、赋值运算符或析构函数。如果您在析构函数中删除内存，并且没有复制构造函数，那么这就是问题的根源。编译器生成的复制构造函数执行浅复制，这意味着当您调用 时 `CContinent::addCountry`，您最终会得到两个具有相同指针的对象。当参数被破坏时，如果它删除任何东西，这会使作为参数传递的对象无效（它包含相同的指针）。有不同的方法来处理这个问题，但在几乎所有情况下，最合适的是不使用指针。（`std::string`例如，类有一个复制构造函数，它可以进行深度复制，所以使用它没有问题。）

*最后，关于一个完全不*相关的问题：在你的类名前面加上`C`不是一个好主意。微软已经为其类名采用了这种约定（至少在他们的一些库中），任何看到类似名称的读者都会认为它是来自微软库之一的类，并会尝试在微软文档中找到它，而不是在您的代码中。*`CCountry`*

# javascript - 从 json 动态创建的 Javascript 表单输入，需要将对象映射到另一个对象的正确字段并保存

> ID：14086564
> 
> 赞同：1
> 
> 时间：2012-12-29T22:42:50.567
> 
> 标签：javascript, jquery, json, forms, object

我将尽我所能解释我在这里要做的事情。它有点复杂（至少对我来说）

我目前有一个对象，我循环遍历并动态填充带有输入的 html 表单。此代码将对象值放在输入中，并允许我将它们编辑/保存回对象。

然而，我需要做的实际上是将对象字段映射到另一个对象中定义的一组字段。原因是原始对象有时会丢失数据，我想从我的表单中添加它。

例如：我的对象有一个属性“按钮”。并且该对象具有 k，v，例如宽度、高度和位置。但是在我的另一个定义“按钮”可用字段的对象中，它具有宽度、高度、位置、颜色和过渡。我想要做的是，当我单击“按钮”标签（请参阅我的演示）时，它会向我显示“控件”对象中的所有字段，并填写包含值的其他对象中的所有值。然后我可以将值添加到为空的输入中，并将它们保存回我的对象​​。

这是我的演示（点击标签查看表单输入）：http: [//jsfiddle.net/bGxFC/6/](http://jsfiddle.net/bGxFC/6/)

这是我的代码：

```
 var controls = {
    "Controls": [{
        "Button":[{"Transition": "","BackgroundImage": "","Position": "","Width": "","Height": ""}],

        "Image":[{"BackgroundImage": "","Position": "","Width": "","Height": "", "Type": ""}],

        "Label":[{"Position": "","Width": "","Height": "","Text": "","FontSize":"","Color": "", "FontType": ""}]
    }]
};

var str = 'View\n{\n    Image\n    {\n        BackgroundImage: Image.gif;\n        Position: 0, 0;\n        Width: 320;\n        Height: 480;\n    }\n\n    Button\n    {\n        BackgroundImage: Button.gif;\n        Transition: View2;\n        Position: 49, 80;\n        Width: 216;\n        Height: 71;\n    }\n\n    Button\n    {\n        BackgroundImage: Button2.gif;\n        Position: 65, 217;\n        Width: 188;\n        Height: 134;\n    }\n\n    Label\n    {\n        Position: 106, 91;\n        Width: 96;\n        Height: 34;\n        Text: "Button";\n        FontSize: 32;\n        Color: 0.12549, 0.298039, 0.364706, 1;\n    }\n    \n\n}';

str = str.replace(/(\w+)\s*\{/g, "$1:{"); // add in colon after each named object
str = str.replace(/\}(\s*\w)/g, "},$1"); // add comma before each new named object
str = str.replace(/;/g, ","); // swap out semicolons with commas
str = str.replace(/,(\s+\})/g, "$1"); // get rid of trailing commas
str = str.replace(/([\d\.]+(, [\d\.]+)+)/g, "[$1]"); // create number arrays
str = str.replace(/"/g, ""); // get rid of all double quotes
str = str.replace(/:\s+([^\[\d\{][^,]+)/g, ':"$1"'); // create strings
$("#parseList").html(str);

var objStr;
eval("objStr={" + str + "};");
//End Parse String

$(document).ready(function () {
    var $objectList = $('<div id="main" />').appendTo($('#main'));
    $.each(objStr.View, function(k, v) {
        $('<div/>').append(k).appendTo($objectList).on('click', function(){
            var $wrapper = $('#form .wrapper').empty();
            if(typeof v === 'string') {
                $('<div class="item" />').append('<span class="key">' + k + '</span>' + '<input value="' + v + '"/>').appendTo($wrapper);
            }
            else {//object
                $('<h3 class="formHeading" />').append(k).appendTo($wrapper);
                $.each(v, function(key, val) {
                    $('<div class="item" />').append('<span class="key">' + key + '</span>' + '<input value="' + val + '"/>').appendTo($wrapper);
                });
            }
            $("<button>Save</button>").appendTo($wrapper).on('click', function() {
                if(typeof v === 'string') {
                    v = $(this).closest(".wrapper").find("input").val();
                }
                else {//object
                    $(this).closest(".wrapper").find(".item").each(function(i, div) {
                        var $div = $(div),
                            key = $div.find(".key").text(),
                            val = $div.find("input").val();
                        v[key] = val;
                    });
                }
            });
        });
    });
}); 
```

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T01:51:09.287

您还需要 html 中的输入元素来包含它们关联的对象键。

就像是：

```
<div class="wrapper">
<h3 class="formHeading" data-item="Button_2">Button_2</h3>

<div class="item"><span class="key">Type</span><input value="Button" data-property="Type"></div>
<div class="item"><span class="key">BackgroundImage</span><input value="Button2.gif"  data-property="BackgroundImage"></div>
<div class="item"><span class="key">Position</span><input value="65,217"></div><button class="save">Save</button>

</div> 
```

JS

```
$('button.save').click(function(){
    var $form=$(this).closest( '.wrapper'), itemName=$form.find('.formHeading').data('item')
   var objectItem= storedObject[ itemName ];

   $('.item').each(function(){
        var $input=$(this).find(':input');
        objectItem[ $input.data('property')]= $input.val();
   })  

}) 
```

如果您可以摆脱所有字符串解析器并在演示中使用适当的 javascript 对象，并添加这些 html 修改，我将很乐意从那里帮助调试

# erlang - 如何在 Erlang shell 中运行 Erlang 应用程序

> ID：14086568
> 
> 赞同：4
> 
> 时间：2012-12-29T22:43:48.073
> 
> 标签：erlang

我有一个 Erlang 应用程序，我可以使用 basho rebar 轻松编译并运行它，它会生成一个独立的 escript 可执行文件。我从命令行运行它，例如： ./myapp myconfig.config

我的问题是如何在 Erlang shell 中运行它。此应用程序有四个其他应用程序作为依赖项。Rebar 编译所有的都很容易。但我需要从 shell 内部运行这个应用程序，例如：

erl -noshell -name node1@machine -run test start parameter1 -s init stop；

但我不知道我应该在哪条路径上运行它。当我在“ebin”文件夹（梁文件所在的位置）中尝试它时，无法访问依赖项。正如我所见，每个依赖应用程序都有自己的“ebin”文件夹。那么如何通过“erl -noshell”命令运行我的应用程序（考虑依赖应用程序）？Rebar 会自动处理所有这些事情。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T22:50:38.427

Rebar 驱动的 OTP 应用程序的典型目录结构如下所示：

```
/
  src/
  ebin/
  deps/
    dep1/
      src/
      ebin/
    dep2/
      src/
      ebin/ 
```

因此，如果您位于项目的根目录中，则可以`erl`使用参数指向正确的位置`-pa`。要告诉它在哪里可以找到您的应用程序及其依赖项的 BEAM 文件，请尝试以下操作：

```
erl [...] -pa ebin -pa deps/*/ebin 
```

# javascript - 访问对象中的属性

> ID：14086573
> 
> 赞同：2
> 
> 时间：2012-12-29T22:44:18.927
> 
> 标签：javascript

> **可能重复：**
> [JavaScript 属性访问：点符号与括号？](https://stackoverflow.com/questions/4968406/javascript-property-access-dot-notation-vs-brackets)

```
<script>      
  var foo = {          
    name: 'kevin'        
  };

  document.write(foo.name);
  document.write(foo['name']);

  var cool = 'name';
  document.write(foo.cool);

  document.write(foo[cool]);      
</script> 
```

1.  为什么`foo.cool`返回我 undefined where as `foo[cool] returns me kevin`。
2.  cool 实际上是如何在 foo 对象中引用我的 name 属性的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T22:46:23.107

1.  `cool`属性未定义在 上，`foo`因此`foo.cool`未定义。如果你这样做了`foo.name`，它会返回`kevin`。

2.  `cool`in`foo[cool]`是您在它上面的行中定义的那个，所以它实际上是`foo['name']`，它已定义并具有 value `kevin`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:54:11.380

您可以访问这些属性...

*   从字面上看他们的名字：`property.name`

*   间接地通过一个*表达式来计算他们的名字*: `property[expr]`。

因此，如果表达式`cool`具有 value `'name'`，则 then与or`foo[cool]`相同。`foo['name']``foo.name`

括号还允许...

1) 更复杂的表达式喜欢`foo["data_"+variable]`轻松访问名为 like 的字段`data_something`，
2) 不是简单标识符的属性名称，例如你可以说`foo["I'm long!"]`.

我希望这个解释能为你带来光明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:56:18.147

在 var foo = { name: 'kevin'}; 您将对象或字典存储到该变量...现在是键值对...因此您可以使用键访问对象的值...

因为它是一个键值对......你不能使用'。'访问它 运算符...因为 foo 不是类... foo 的类型将是字典或对象...

因此，要访问您需要使用 [] 括号的值...

# iphone - 如何为另一台设备复制整个 XCode 项目？

> ID：14086576
> 
> 赞同：1
> 
> 时间：2012-12-29T22:44:57.667
> 
> 标签：iphone, ios, xcode, ipad, project

好的，我有一个使用相机的 iPhone 项目。

我正在尝试为该项目的 iPad 版本使用 80% 的相同代码，但是，我必须更改一些值，因为后一种设备中的相机质量与我用作第一个设备的标准的一些参数相混淆.

所以我所做的是：我复制了 iPhone 项目，并且在同一个项目中总共有两个目标，第一个用于 iPhone（原版），第二个用于 iPad。

当我单击第二个目标并在某个 .m 文件上添加评论时，相同的评论也出现在 iPhone 版本文件的同一个 .m 文件中。

我不想要那样——如你所见，我想要分离。我想以iPhone项目为基础修改iPad项目的代码。但是我该怎么做呢？如果评论也出现在 iPhone .m 中，那么显然这意味着没有区别，而且我在 iPad .m 中所做的任何事情都会弄乱另一个 .m 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:51:06.087

看起来您的两个项目正在共享相同的文件。如果您想将它们分开，只需复制源文件并将它们单独添加回项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T22:50:54.993

我会创建一个通用应用程序。这样，您可以在单个项目中的两个设备之间共享所有代码。然后，您可以简单地将每种设备类型的逻辑分离到不同的文件中。因此，例如，`ViewControllerA`对于这两个设备，`ViewControllerA_iPhone`以及`ViewControllerA_iPad`对于每个单独的设备。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T22:51:40.660

可能重复： [ipad 和 iphone 之间的条件编译](https://stackoverflow.com/questions/7497207/conditional-compilation-between-ipad-and-iphone)

我认为您不需要第二个实现文件，您只需要针对不同的设备进行编译或检查您在运行时使用的设备并进行相应的调整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T23:35:04.950

我认为不需要复制整个项目。您可以只复制必要的文件并为 iPhone 和 iPad 创建逻辑组。如果是 iPad，则将设备类型检查到 appdelegate 类中，然后调用 iPad 相关类，否则为 iPhone。希望它会帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T22:57:12.623

在我看来，您需要“扩展”原始功能以合并新功能。

创建“接口”然后创建类的基本形式（可能使其抽象）不是最简单的吗，它实现了所有方法，但留下了那些可能有特殊需求的方法（只是让它们作为基本方法抛出错误功能）

然后对于 2 个项目，您可以扩展抽象类并覆盖添加所需功能的方法。

美妙之处在于，如果在覆盖的方法中有错误条件，您可以调用“超类”抽象方法并抛出错误消息，您可以决定超类方法应该采用字符串输入变量以使您能够使用一条自定义消息标记在抽象类的末尾。

大卫

# .net - 为什么 F# inline 会导致 11 倍的性能提升

> ID：14086580
> 
> 赞同：19
> 
> 时间：2012-12-29T22:45:20.890
> 
> 标签：.net, performance, struct, f#, inline

我正在处理一些繁重的 cpu 绑定问题。当我使用`inline`关键字时，我看到了很大的性能改进。我从标准 .net 库中创建了一个字典，传入了一个自定义键比较器，请参见下面的代码和计时结果

[https://gist.github.com/4409734](https://gist.github.com/4409734)

在 Eq_cmp 上没有内联关键字

```
> perf_run 10000000 ;;
Real: 00:00:11.039, CPU: 00:00:11.029, GC gen0: 771, gen1: 3, gen2: 1
val it : unit = () 
```

在 Eq_cmp 上使用 inline 关键字

```
perf_run 10000000 ;;
Real: 00:00:01.319, CPU: 00:00:01.388, GC gen0: 1, gen1: 1, gen2: 1
val it : unit = ()
> 
```

我还注意到 Gen 0 GC 的数量与内联代码和非内联代码的巨大差异。

有人可以解释为什么会有如此巨大的差异吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-29T23:49:44.417

*`inline`添加关键字后，我可以通过 3 倍的性能提升来重现我的机器上的行为。*

[在ILSpy](http://ilspy.net/)下并排反编译两个版本会得到几乎相同的 C# 代码。显着的区别在于两个相等测试：

```
// Version without inline
bool IEqualityComparer<Program.Pair<a>>.System-Collections-Generic-IEqualityComparer(Program.Pair<a> x, Program.Pair<a> y)
{
    a v@ = x.v@;
    a v@2 = y.v@;
    if (LanguagePrimitives.HashCompare.GenericEqualityIntrinsic<a>(v@, v@2))
    {
        a w@ = x.w@;
        a w@2 = y.w@;
        return LanguagePrimitives.HashCompare.GenericEqualityIntrinsic<a>(w@, w@2);
    }
    return false;
}

// Version with inline
bool IEqualityComparer<Program.Pair<int>>.System-Collections-Generic-IEqualityComparer(Program.Pair<int> x, Program.Pair<int> y)
{
    int v@ = x.v@;
    int v@2 = y.v@;
    if (v@ == v@2)
    {
        int w@ = x.w@;
        int w@2 = y.w@;
        return w@ == w@2;
    }
    return false;
} 
```

泛型相等的效率远低于专门的版本。

> 我还注意到 Gen 0 GC 的数量与内联代码和非内联代码的巨大差异。
> 
> 有人可以解释为什么会有如此巨大的差异吗？

看一下[F# 源代码](https://github.com/fsharp/fsharp/blob/master/src/fsharp/FSharp.Core/prim-types.fs#L1635)`GenericEqualityIntrinsic`中的函数：

```
let rec GenericEqualityIntrinsic (x : 'T) (y : 'T) : bool = 
    fsEqualityComparer.Equals((box x), (box y)) 
```

它对参数进行装箱，这解释了您的第一个示例中的大量垃圾。当 GC 过于频繁地发挥作用时，它会显着减慢计算速度。第二个示例（使用）在struct`inline`时几乎不会产生垃圾。`Pair`

也就是说，`inline`在调用站点使用专用版本时，这是关键字的预期行为。我的建议是始终尝试在相同的基准上优化和衡量您的代码。

您可能对一个非常相似的线程感兴趣[为什么这个 F# 代码这么慢？](https://stackoverflow.com/questions/6104221/why-is-this-f-code-so-slow).

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-31T17:38:58.787

类型专业化

没有`inline`，您使用的是非常低效的通用比较。使用`inline`，删除通用性并`int`直接使用比较。

# python - Python，拼接列表，步骤并且只提取第一个字符

> ID：14086581
> 
> 赞同：1
> 
> 时间：2012-12-29T22:45:24.310
> 
> 标签：python, slice

我知道如何进行基本的拼接。但我想知道是否可以拼接一个列表，每 10 个元素返回一次，并且只返回该元素的最后 2 个字符。

```
['1111',' 1112',' 1113',' 1114',' 1115',' 1116',' 1117',' 1118',' 1119',' 1120',' 1121',' 1122',' 1123',' 1124',' 1125',' 1126',' 1127',' 1128',' 1129',' 1130',' 1131',' 1132',' 1133',' 1134',' 1135',' 1136',' 1137',' 1138',' 1139',' 1140',' 1141',' 1142',' 1143',' 1144',' 1145',' 1146',' 1147',' 1148',' 1149',' 1150',' 1151',' 1152',' 1153',' 1154',' 1155',' 1156',' 1157',' 1158',' 1159',' 1160',' 1161',' 1162',' 1163',' 1164',' 1165',' 1166',' 1167',' 1168',' 1169',' 1170',' 1171',' 1172',' 1173',' 1174',' 1175',' 1176',' 1177',' 1178',' 1179',' 1180',' 1181',' 1182',' 1183',' 1184',' 1185',' 1186',' 1187',' 1188',' 1189',' 1190',' 1191',' 1192',' 1193',' 1194',' 1195',' 1196',' 1197',' 1198',' 1199'] 
```

我可以毫无问题地获得每 10 个字符串；

```
>>test[::10]
['1111', ' 1121', ' 1131', ' 1141', ' 1151', ' 1161', ' 1171', ' 1181', ' 1191'] 
```

我怎样才能得到上述字符串中的最后两个字符

所以我尝试了这个，但它不起作用。

```
test[::10][-2::]
[1181',' 1191] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T22:46:50.580

您必须使用列表推导将切片应用于包含的元素：

```
[v[-2:] for v in test[::10]] 
```

这给出了：

```
>>> [v[-2:] for v in test[::10]]
['11', '21', '31', '41', '51', '61', '71', '81', '91'] 
```

`test[::10]`返回一个列表本身，并且`[-2::]`只从该列表中获取最后两个元素，并且不将该切片应用于列表的*包含*元素。

# c++ - C++ 缩放图形内容

> ID：14086602
> 
> 赞同：0
> 
> 时间：2012-12-29T22:47:49.160
> 
> 标签：c++, sdl

我正在尝试制作一个处理图形的程序，但我不太确定如何实现缩放。我已经通过缩小它们对原始形状（例如线条和圆形）（使用 SDL_gfxPrimitives）进行了缩放效果，但这不适用于图片。我将如何实现缩放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:57:58.917

您的问题不够具体，无法产生一个具体的答案，可能会为您提供您所寻找的东西。

我能给你的是建议你首先想出一种**表示**缩放的方法。

如果您已经知道如何**绘制**图片，请考虑这样一个事实，即在涉及计算机图形时，几乎总是“放大”或“缩小”只不过是逐渐放大或缩小图片尺寸。

考虑到这一点，也许您会开始看到表示缩放概念的合理方法是使用某种形式的`Camera`类，该类将明确地确定您绘制的图片的大小和位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:05:36.790

有一个支持缩放的 SDL 库：

[SDL2_gfx 库](http://www.ferzkopp.net/joomla/content/view/19/14/)

> SDL_gfx 库从 SDL_gfxPrimitives 代码演变而来，该代码提供了基本的绘图例程，例如线、圆或多边形，以及 SDL_rotozoom，它为 SDL 表面实现了插值旋转缩放器。
> 
> > SDL_gfx 库的当前组件是：
> > 
> > *   图形基元 (SDL_gfxPrimitves.h)
> > *   旋转缩放器 (SDL_rotozoom.h)
> > *   帧率控制 (SDL_framerate.h)
> > *   MMX 图像过滤器 (SDL_imageFilter.h)
> > *   自定义 Blit 函数 (SDL_gfxB​​litFunc.h)

# c# - NHibernate HQL 连接列

> ID：14086607
> 
> 赞同：1
> 
> 时间：2012-12-29T22:48:46.957
> 
> 标签：c#, nhibernate, hql

我查看了休眠连接，但无法弄清楚连接是如何执行的。在示例中，它不提供执行连接的列。这些是根据映射自动执行的吗？

如果我有 2 个实体并且它们之间有 2 个独立的关系怎么办，这意味着加入 2 个实体有多种可能性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:14:33.207

答案是“这些是根据映射自动执行的”（正如您所说）。

作为 NHibernate 映射一部分的任何 C# 对象（PO​​CO 实体）都显式连接到下级表和列。实体级别 (C#) 上的任何关系在 DB 表关系中都有其类比。

**文档[14.3中](http://nhforge.org/doc/nh/en/index.html#queryhql-joins)**的 HQL示例。**[协会和加入](http://nhforge.org/doc/nh/en/index.html#queryhql-joins)：**

 **```
from Eg.Cat as cat 
  join cat.Mate as mate
  left join cat.Kittens as kitten 
```

...是完整的，并从映射中获利。这提供了足够的信息，*猫*和*伴侣*是如何相关的，如何加入它以获取*小猫列表*

**来自文档[5.1](http://nhforge.org/doc/nh/en/index.html#mapping-declaration)**的映射。**[映射声明](http://nhforge.org/doc/nh/en/index.html#mapping-declaration)**

 **```
<?xml version="1.0"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="Eg"
    namespace="Eg">

        <class name="Cat" table="CATS" discriminator-value="C">
                <id name="Id" column="uid" type="Int64">
                        <generator class="hilo"/>
                </id>
                <discriminator column="subclass" type="Char"/>
                <property name="BirthDate" type="Date"/>
                <property name="Color" not-null="true"/>
                <property name="Sex" not-null="true" update="false"/>
                <property name="Weight"/>
                <many-to-one name="Mate" column="mate_id"/>
                <set name="Kittens">
                        <key column="mother_id"/>
                        <one-to-many class="Cat"/>
                </set>
                <subclass name="DomesticCat" discriminator-value="D">
                        <property name="Name" type="String"/>
                </subclass>
        </class>

        <class name="Dog">
                <!-- mapping for Dog could go here -->
        </class>

</hibernate-mapping> 
```

**加入**。因此，如果我们选择 Mate，我们将使用 table 中的列`mate_id`从其`CATS`表中获取 Mate。当我们需要具有相同类型*（Cat）*的孩子时，我们将转到表`CATS`并搜索列`mother_id`等于当前`id`列值的所有记录。

所以，“这些是根据映射自动执行的”****

# java - Jar Maker - 哪个是主要课程？

> ID：14086613
> 
> 赞同：0
> 
> 时间：2012-12-29T22:50:50.153
> 
> 标签：java, jar, main, final

好的，所以我正在为一个小游戏的客户端制作一个 .jar，我知道如何使用所有东西，并且以前在 windows 上做过，现在我在 mac 上。这不应该有什么不同，但如果你想知道，那就去吧。

现在，我在 Eclipse 中有一个名为 client 的文件夹，现在通常 client.java 是主类，但还有另一个名为 EGUI，它有“public static void main(String[] args)”，但在我的 client.java文件，它也有这样的方法：

```
 public static final void main(String args[])
{
    try
    {
        anInt957 = 0;
        anInt958 = 0;
        method52(false);//highmem
        aBoolean959 = true;//members
        signlink.storeid = 32;
        signlink.startpriv(InetAddress.getLocalHost());
        client client1 = new client();
        client1.method1(503, false, 765);
        setserver(args[0], "5555");
        return;
    }
    catch(Exception exception)
    {
        return;
    }
} 
```

我想我的问题是，“最终”是否使其成为主文件？或者它仍然是 EGUI，它看起来像这样：

```
import java.awt.BorderLayout;
import java.awt.Cursor;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class EGUI
{ 
public static void main(String args[])
{
                client.main(new String[] {
            "127.0.0.1", "127.0.0.1", "127.0.0.1"
        });
    }
} 
```

那么，我要问的是，为什么当我将主文件设置为 EGUI 时，它不起作用？小程序打开了，但我每次都收到“连接到服务器时出错”消息，当我通过终端通过复制 run.bat 信息并粘贴它运行它时，它运行良好！任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:58:28.223

`public static void main(String args[])`意味着您可以从命令行执行该类。*final*关键字意味着该方法不能被子类覆盖。

在您的情况下，这不会使其成为 jar 的主要执行类。主类设置在**META-INF/MANIFEST.MF**中。通常它应该有一行：

```
Main-Class: classname 
```

但随后与实际课程。

因此，使用 zip 程序打开 jar，然后检查 MANIFEST.MF。

Your **client.java** has a **main** method, for testing purposes I suppose.

# sqlite - 如何使用两个 sql 语法关键字

> ID：14086615
> 
> 赞同：0
> 
> 时间：2012-12-29T22:50:57.130
> 
> 标签：sqlite

我有一个名为“名称”的列的 sqlite 数据库。

名称列包含 30 行。

5 用数据填充，25 给出空值。

我试图让 sqlite 只返回填充的行，然后按 asc 排序。

我认为这很容易

SELECT * FROM students WHERE name IS NOT NULL AND ORDER BY name ASC。

但是我错了。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T22:52:41.693

```
SELECT * FROM students WHERE name IS NOT NULL ORDER BY name ASC. 
```

省略 AND。

# vba - 每 x 行插入空白行

> ID：14086620
> 
> 赞同：2
> 
> 时间：2012-12-29T22:51:30.307
> 
> 标签：vba, excel

> **可能重复：**
> [在excel中每X行插入一行](https://stackoverflow.com/questions/5017181/insert-row-every-x-rows-in-excel)

我有一大组数据（假设它从 B5 到 J500，假设这个范围被命名为 rngOutput）。我正在尝试遍历这些数据并每**x**行添加 2 个空行，其中 x 是用户指定的数字。例如，如果 x 为 10，则每 10 行应插入 2 个新行。从概念上讲，这是应该工作的代码：

```
For i = 1 to Number of rows in rngOutput
   If i mod x = 0 Then
        Insert 2 Rows
   End If
Next i 
```

但是，当您插入 2 个新行时，行数会发生变化并且公式会混乱（即它在前 10 行之后添加 2 行，然后在接下来的 8 行之后添加另外 2 行（因为它计算了您添加为实际行），然后在接下来的 6 行之后再添加 2 行，依此类推。

我试图找出一种方法来干净地完成每 x 行添加 2 个新行以避免上述问题。

感谢您的帮助，如果您需要更多说明，请告诉我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:15:19.220

这就像克里斯的唯一充实。插入或删除行时，您必须从底部开始：

```
Sub InsertXRowsEveryYRows_WithMeaningfulVariableNames()
Dim NumRowsToInsert As Long
Dim RowIncrement As Long
Dim ws As Excel.Worksheet
Dim LastRow As Long
Dim LastEvenlyDivisibleRow
Dim i As Long

NumRowsToInsert = 2     'any number greater than 0
RowIncrement = 10       'ditto
Set ws = ActiveSheet
With ws
    LastRow = .Range("A" & .Rows.Count).End(xlUp).Row
    LastEvenlyDivisibleRow = Int(LastRow / RowIncrement) * RowIncrement
    If LastEvenlyDivisibleRow = 0 Then
        Exit Sub
    End If
    Application.ScreenUpdating = False
    For i = LastEvenlyDivisibleRow To 1 Step -RowIncrement
        .Range(i & ":" & i + (NumRowsToInsert - 1)).Insert xlShiftDown
    Next i
End With
Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T23:03:11.943

从范围底部开始计数

```
For i = Number of rows in rngOutput to 1 step -1
   If i mod x = 0 Then
        Insert 2 Rows
   End If
Next i 
```

# android - Android 分层首选项

> ID：14086621
> 
> 赞同：0
> 
> 时间：2012-12-29T22:51:34.957
> 
> 标签：android

我正在编写一个 Web 服务客户端，并具有三个明显的设置：url、用户名和密码。[为此， SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)中的键值对就足够了。但是当我想订阅多个服务器实例时遇到了障碍。我需要的是为用户添加的每个服务器实例存储一次的三个设置。这里最好的方法是什么？创建自定义设置活动并将其保存到[文件中](http://developer.android.com/training/basics/data-storage/files.html)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:55:39.630

您可以将 a 存储`Set<String>`在`SharedPreferences`. 您可以使用它来存储其他属性的密钥。

这样做的一种方法是存储一个集合，其中包含定义每个服务器的键（例如，“foo.com”和“bar.com”）。然后使用已知后缀为每个服务器存储您需要的属性。假设您需要存储每个用户名和密码，然后将“foo.com-username”和“foo.com-password”作为“foo.com”服务器的用户名和密码的键，与“bar.com”相同。

# java - 如何从映射器登录？（hadoop 与 commoncrawl）

> ID：14086631
> 
> 赞同：0
> 
> 时间：2012-12-29T22:53:26.903
> 
> 标签：java, hadoop, mapreduce, nosql, common-crawl

我正在使用他们的“ [Mapreduce for the Masses](http://commoncrawl.org/mapreduce-for-the-masses/) ”教程中的 commoncrawl 示例代码。我正在尝试对映射器进行修改，并且希望能够将字符串记录到某些输出中。我正在考虑设置一些 noSQL 数据库并将我的输出推送给它，但这并不是一个好的解决方案。从java进行这种日志记录的标准方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:34:44.293

虽然除了通常的记录器（至少我知道一个）之外，没有针对日志的特殊解决方案，但我可以看到一些解决方案。
a) 如果日志是用于调试目的 - 确实要编写通常的调试日志。如果任务失败，您可以通过 UI 找到它们并进行分析。
b）如果此日志是您希望与您的工作的其他输出一起获得的某种输出 - 为它们分配一些特殊键并写入上下文。然后在减速器中，您将需要一些特殊的逻辑将它们放到输出中。
c）您可以在 HDFS 上创建目录并让映射器写入那里。这不是 MR 的经典方式，因为它是副作用 - 在某些情况下它可能很好。特别是考虑到每个映射器将创建自己的文件之后 - 您可以使用命令 hadoop fs -getmerge ... 将所有日志作为一个文件获取。
c) 如果您希望能够监控您的工作进度、错误数量等 - 您可以使用计数器。

# ipad - 像在邮件应用程序中一样在 iPad 上使用自定义视图从 UIBarbuttonItems 呈现弹出窗口？

> ID：14086632
> 
> 赞同：3
> 
> 时间：2012-12-29T22:53:31.643
> 
> 标签：ipad, uipopovercontroller, uibarbuttonitem

我的问题类似于这个 < [question](https://stackoverflow.com/questions/11244244/show-uibarbuttonitem-just-like-apples-ipad-mail-app) > ，其中 OP 的目标是将 UIBarButtonItems 数组显示为 navigationItem.rightBarButtonItems 而没有 barbuttons 的轮廓/边框。他的解决方案，使用 UIButton 自定义视图初始化 UIBarButtonItem，给出了所需的外观，并且 UIButton 目标/操作模式适用于调用方法，但不适用于定位 UIPopoverController。

我要做的是在弹出窗口中显示一个 actionSheet（即在 iPad 上显示一个 actionSheet），并且（从不同的按钮）显示一个打印控制器弹出框，弹出框箭头指向选定的栏按钮，作为 rightBarButton iPad Mail 应用程序中的项目。

问题是，呈现 actionSheet 或弹出框的方法：

`[UIActionSheet showFromBarButtonItem:bbtn animated:YES];`

或者

`[UIPrintInteractionController presentFromBarButtonItem:printButton animated:YES completionHandler:completionHandler]`

使用 UIButton 发送方调用时不起作用。此外，从 CGRect 呈现的方法，例如

`[controller presentFromRect:rect inView:self.view animated:YES completionHandler:completionHandler]`

不要正确定位弹出指针。

我尝试使用`UIView convertRect:toView:`转换后的矩形转换按钮框架并显示弹出框，但我要么做错了，要么无法从没有框架属性的 UIBarButtonItem 超级视图正确转换。显示弹出框，但弹出框箭头未指向所选按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T19:54:34.640

尝试在导航控制器的视图坐标中计算转换后的按钮框架。例如

```
CGRect convertedRect = [self.navigationController.view convertRect:button.bounds fromView:button];
[controller presentFromRect:convertedRect inView:self.navigationController.view animated:YES completionHandler:completionHandler]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T11:11:33.127

我和你有完全相同的问题。我发现的一种解决方案是使用完全透明的图像作为 UIBarButton 项的背景。

```
UIBarButtonItem *button = [[BWBarButton alloc] initWithImage:[UIImage imageNamed:imageName] style:UIBarButtonItemStylePlain target:target action:selector];

[button setBackgroundImage:[UIImage imageNamed:@"barimage"] forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

这`barimage`是一个 60x60 的透明图像。我认为您可以使用 1x1px 图像。

祝你好运！

# android - 基于 Canvas 的游戏中的着色器 - Android

> ID：14086634
> 
> 赞同：0
> 
> 时间：2012-12-29T22:53:41.250
> 
> 标签：android, 2d

我的问题是直截了当的，我可以在 Android 上将着色器或其他一些技术应用于基于画布的游戏 (2d) 以制作看起来像纸上草图的游戏。

我想做一个看起来很粗略的游戏，我对怎么做很感兴趣？

# php - 显示多个视图的内容

> ID：14086643
> 
> 赞同：0
> 
> 时间：2012-12-29T22:55:24.200
> 
> 标签：php, ajax, cakephp, jqplot

我有一个渲染图表的函数：

```
function testSave(){
    $this->_renderChart(156);
} 
```

这是我用来测试的。testSave() 函数的视图显示`_renderChart(156)`调用的内容。但是当我这样做时

```
function testSave(){
    $this->_renderChart(156);
    $this->_renderChart(153);
} 
```

然后它只显示 `$this->_renderChart(153)`call 的内容，但不显示`$this->_renderChart(156)`.

`_renderChart($chart_id)`函数说明：

```
function _renderChart($chart_id = null){
    if($chart_id == null)
        return false;
    //some magic...
    $this->layout = 'dummyfolder\dummy_layout_name';
} 
```

在_renderChart 的函数视图中，我有一个javascript 代码，它通过ajax 将图表的图像保存`.png`在服务器上。但是，当调用两次时，`$this->renderChart()`只会渲染最后一次出现的图像，并且只保存一个图像而不是两个图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:14:55.863

嗯，也许是因为您连续调用“this”的函数。那么这意味着 $this 总是最后一次调用。如何将调用初始化为变量，然后返回变量。像这样的东西：

```
$var1 = $this->_renderChart(156);
$var2 = $this->_renderChart(153);

return array($var1, $var2); 
```

编辑：

```
$array = array("156", "153");
$this->_renderChart($array); 
```

然后是这样的：

```
function _renderChart($chart_id = null){
    if($chart_id == null)
        return false;
     foreach($chart_id as $key => $value) {
        //some magic...
     }
     $this->layout = 'dummyfolder\dummy_layout_name';
} 
```

# c# - 在 DataGridView 的第 5 列的单元格中添加单词“删除”

> ID：14086647
> 
> 赞同：0
> 
> 时间：2012-12-29T22:55:51.937
> 
> 标签：c#, datagridview

我的问题是如何在 DataGridView 的第 5 列的单元格中添加“删除”一词？

我正在实现一个删除功能，当用户单击 DataGridView 中第 5 列中的任意位置时删除一行。

我处理 CellClick 事件没有问题。但对我来说问题是如何在第 5 列的每个单元格中添加“删除”一词？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:27:42.767

在代码中，您可以使用以下语句，假设 Column(5) 是一个按钮：

```
CType(YourDataGridView.Columns(5), DataGridViewButtonColumn).UseColumnTextForButtonValue = True 
```

您还可以使用 DataGridView 控件的 Columns 属性（外观部分）设置此属性。

# javascript - Rails 包括 .js 文件

> ID：14086648
> 
> 赞同：0
> 
> 时间：2012-12-29T22:56:10.877
> 
> 标签：javascript, ruby-on-rails, asset-pipeline

我很好奇 Rails 包含 .js 文件的方式。除了资产管道，我对存储在 .js 文件中的 .js 文件感到好奇`view`。例如，如果您想将 ajax 调用应用于调用`like`in的操作`PostsController`，您只需将相关的 ajax 代码放在`like.js.erb`帖子视图文件夹中。然后，当用户调用 action 时，javascript 会自动触发`like`。

我的问题是

1.  调用动作时自动调用名称与某些动作匹配的javascript文件是否正确？
2.  如果我想在某个视图中包含一个不对应任何操作的 javascript 文件，我该怎么办？只需将其包含在应用程序清单中？更具体地说，我现在有`tag-autocomplete.js.erb`。`views/post`我是否将其移动到`assets`文件夹并从`application.css`?

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:07:10.160

1.  是的，虽然我看不出如果你同时拥有like.js.erb 和like.html.erb 会发生什么。似乎会选择其中一个，而且可能是任意的。

2.  在这种情况下，我通常会在脚本标记中内联 javascript。如果它真的只会在那个视图中使用，那是合理的。另一方面，application.js 被缓存了，这样可以节省带宽来放任何你可以放在那里的东西。但是，由于您询问的是涉及模板的事情，所以我认为缓存是不可取的。对此，我说你应该尽量减少在 JS 中使用模板。有时它是有道理的，但要小心。

（仅供参考：[这](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/lookup_context.rb#L116)是定义相关功能核心的地方。）

# java - 如何防止列表字段在自动刷新后显示重复数据

> ID：14086650
> 
> 赞同：0
> 
> 时间：2012-12-29T22:56:19.333
> 
> 标签：java, blackberry, java-me

我使用下面的代码每分钟使用从 xml Web 服务返回的数据刷新列表字段。但第一次刷新后，数据重复。如何防止它重复？

```
public final class MyScreen extends MainScreen implements ListFieldCallback
{
    ResponseHandler handler = new ResponseHandler();
    ListField listUsers = new ListField(handler.getItem().size());
    Manager mainManager = getMainManager();

    protected void onUiEngineAttached(boolean attached) {
        if (attached) {
            Timer timer = new Timer();
            // schedule the web service task to run every minute
            timer.schedule(new WebServiceTask(), 0, 3000);
        }
    }

    public MyScreen() {
        setTitle("Uikro");
        listUsers.setEmptyString("No Users found", 0);
        listUsers.setCallback(this);
        add(listUsers);
        handler.getItem().removeAllElements();
    }

    private class WebServiceTask extends TimerTask {
        public void run() {
            //Fetch the xml from the web service
            String wsReturnString = GlobalV.Fetch_Webservice("myDs");
            //Parse returned xml
            SAXParserImpl saxparser = new SAXParserImpl();
            ByteArrayInputStream stream = new ByteArrayInputStream(wsReturnString.getBytes());
            try {
                saxparser.parse( stream, handler );
            }
            catch ( Exception e ) {
                response.setText( "Unable to parse response.");
            }

            // now, update the UI back on the UI thread:
            UiApplication.getUiApplication().invokeLater(new Runnable() {
                public void run() {
                    //Return vector sze from the handler class
                    int currentIndex = listUsers.getSelectedIndex();
                    int scrollPosition = getMainManager().getVerticalScroll();
                    //Return vector sze from the handler class
                    listUsers.setSize(handler.getItem().size());
                    listUsers.setSelectedIndex(currentIndex);
                    getMainManager().setVerticalScroll(scrollPosition);
                }
            });
        }
    }

    public void drawListRow(ListField list, Graphics g, int index, int y, int w) {
        String personToDraw = (String) this.get(list, index);
        int drawColor = Color.RED;
        g.setColor(drawColor);
        g.drawText(personToDraw, 0, y, 0, w);
    }

    // get the selected index from the correct Vector
    public Object get(ListField list, int index) {
        return handler.getItem().elementAt(index);
    }

    public void insert(String toInsert, int index) {
        handler.getItem().insertElementAt(toInsert, index);
    }

    public int getPreferredWidth(ListField list) {
        return Display.getWidth();
    }

    public int indexOfList(ListField listField, String prefix, int start) {
        return handler.getItem().indexOf(prefix, start);
    }
}

public class ResponseHandler extends DefaultHandler
{
    boolean username=false;
    Vector _vectorUser = new Vector();

    public void startElement(String uri, String localName, String qName, Attributes attributes){
        if (qName.equalsIgnoreCase("U_Username")){
            username = true;
        }
    }

    public void characters(char[] ch, int start, int length) {
        if (username){
            _vectorUser.addElement(new String( ch, start, length ));
            username=false;
        }
    }

    Vector getItem(){
        return _vectorUser;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:48:01.607

所以，我认为问题出在`ResponseHandler`课堂上。该类使用成员变量`_vectorUser`来存储数据。向量在创建时`ResponseHandler`创建，元素在`characters(char[],int,int)`调用方法时添加。

但是，**从来没有真正清除过**（它在使用之前就被清除了，但这并不能防止这个问题）`_vectorUser`。

 **因此，您应该在每次向 Web 服务请求新数据时清除向量：

```
private class WebServiceTask extends TimerTask {
    public void run() {
        //Fetch the xml from the web service
        String wsReturnString = GlobalV.Fetch_Webservice("myDs");
        //Parse returned xml
        SAXParserImpl saxparser = new SAXParserImpl();
        ByteArrayInputStream stream = new ByteArrayInputStream(wsReturnString.getBytes());
        try {
            // clear out the vector first
            handler.getItem().removeAllElements();
            saxparser.parse( stream, handler );
        }
        catch ( Exception e ) {
            response.setText( "Unable to parse response.");
        } 
```

或者，只需创建一个 new `ResponseHandler`，这也将创建一个新向量：

```
private class WebServiceTask extends TimerTask {
    public void run() {
        //Fetch the xml from the web service
        String wsReturnString = GlobalV.Fetch_Webservice("myDs");
        //Parse returned xml
        SAXParserImpl saxparser = new SAXParserImpl();
        ByteArrayInputStream stream = new ByteArrayInputStream(wsReturnString.getBytes());
        try {
            // create a new handler
            handler = new ResponseHandler();
            saxparser.parse( stream, handler );
        }
        catch ( Exception e ) {
            response.setText( "Unable to parse response.");
        } 
```**

# android - 无法运行 Android SDK 管理器

> ID：14086652
> 
> 赞同：2
> 
> 时间：2012-12-29T22:56:44.197
> 
> 标签：android, eclipse, sdk

我正在使用 ubuntu 12.04 和 Eclipse Juno。我安装了 ADT 21.0.1 和所有 SDK 包。但是每次我启动 Eclipse 都会出现以下错误：

```
 eclipse.buildId=M20120914-1800
    java.version=1.7.0_09
    java.vendor=Oracle Corporation
    BootLoader constants: OS=linux, ARCH=x86, WS=gtk, NL=en_US
    Command-line arguments:  -os linux -ws gtk -arch x86

    Error
    Unable to find Action Set: org.eclipse.mylyn.context.ui.actionSet
    Unable to find Action Set: org.eclipse.mylyn.doc.actionSet
    Unable to find Action Set: org.eclipse.mylyn.tasks.ui.navigation
    Unable to find Action Set: org.eclipse.wb.core.ui.actionset 
```

当我尝试运行我的 sdk Manager 时，它显示一个错误：

```
 Failed to run the Android SDK Manager. Check the Android Console View for details. 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T19:21:13.373

在更新到 ADT 21.0.1 之后，在 Mac OS 下从 Eclipse 启动 SDK 管理器时，我遇到了类似的问题。我注意到 <sdk_tools_dir>/tools/android shell 程序文件不再是可执行文件。一个快速

```
chmod a+x android 
```

修复了问题，现在管理器从 Eclipse 中正确启动。您可能必须以 root 身份执行此操作。这可能是基于 Unix 的发行版更新后的一个错误，但由于我没有使用 Linux，我不能确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-19T16:34:27.713

我遇到了同样的问题，如前所述，sdk/tools/android 上的 chmod 有助于恢复 SDK 管理器窗口 ( `chmod a+x android`)。尽管如此，如果它仍然不适用于模拟器，请对所有以“模拟器”开头的文件（同一文件夹）执行相同的 chmod

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:17:08.057

我知道这听起来可能很愚蠢，但是您是否移动了任何文件？我对可执行文件做了一次，认为它会复制文件并创建一个快捷方式（就像在以前版本的 Windows 中所做的那样），但实际上它移动了文件位置，导致它抛出一个错误（尽管有点不同于你得到的那个）。

我也听说朱诺有错误。您可能只想卸载 Eclipse 及其所有文件关联，然后重新安装旧版本。

# android - Android 将 Maps v2 API 添加到主详细信息流 - 膨胀类片段时出错

> ID：14086653
> 
> 赞同：5
> 
> 时间：2012-12-29T22:57:04.000
> 
> 标签：android, google-maps-android-api-2

我正在尝试将使用版本 2 API 的 Google Maps 视图添加到内置的 Android Master Detail 流中。出于某种原因，我收到一个错误膨胀类片段异常：

```
 12-29 22:47:05.828: E/AndroidRuntime(1655): FATAL EXCEPTION: main
12-29 22:47:05.828: E/AndroidRuntime(1655): android.view.InflateException: Binary XML file line #48: Error inflating class fragment
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:697)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at com.reading.trackitparent.MapDetailFragment.onCreateView(MapDetailFragment.java:52)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.Fragment.performCreateView(Fragment.java:1460)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:911)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.os.Handler.handleCallback(Handler.java:605)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.os.Looper.loop(Looper.java:137)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.app.ActivityThread.main(ActivityThread.java:4424)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at java.lang.reflect.Method.invokeNative(Native Method)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at java.lang.reflect.Method.invoke(Method.java:511)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at dalvik.system.NativeStart.main(Native Method)
12-29 22:47:05.828: E/AndroidRuntime(1655): Caused by: java.lang.ClassCastException: com.google.android.gms.maps.MapFragment cannot be cast to android.support.v4.app.Fragment
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.Fragment.instantiate(Fragment.java:394)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.Fragment.instantiate(Fragment.java:369)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:272)
12-29 22:47:05.828: E/AndroidRuntime(1655):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:669) 
```

我创建了一个新的 MapDetailFragment：

```
package com.reading.trackitparent;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import com.reading.trackitparent.dummy.DummyContent;

/**
 * A fragment representing a single Item detail screen. This fragment is either
 * contained in a {@link ItemListActivity} in two-pane mode (on tablets) or a
 * {@link ItemDetailActivity} on handsets.
 */
public class MapDetailFragment extends Fragment {
    /**
     * The fragment argument representing the item ID that this fragment
     * represents.
     */
    public static final String ARG_ITEM_ID = "item_id";

    /**
     * The dummy content this fragment is presenting.
     */
    private DummyContent.DummyItem mItem;

    /**
     * Mandatory empty constructor for the fragment manager to instantiate the
     * fragment (e.g. upon screen orientation changes).
     */
    public MapDetailFragment() {
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        if (getArguments().containsKey(ARG_ITEM_ID)) {
            // Load the dummy content specified by the fragment
            // arguments. In a real-world scenario, use a Loader
            // to load content from a content provider.
            mItem = DummyContent.ITEM_MAP.get(getArguments().getString(
                    ARG_ITEM_ID));
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View rootView = inflater.inflate(R.layout.fragment_map_detail,
                container, false);

//      // Show the dummy content as text in a TextView.
//      if (mItem != null) {
//          ((TextView) rootView.findViewById(R.id.item_detail))
//                  .setText(mItem.content);
//      }

        return rootView;
    }
} 
```

我正在尝试使用以下布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ItemDetailActivity" >

    <fragment
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.MapFragment" />

</RelativeLayout> 
```

项目列表活动：

```
package com.reading.trackitparent;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.FragmentActivity;

/**
 * An activity representing a list of Items. This activity has different
 * presentations for handset and tablet-size devices. On handsets, the activity
 * presents a list of items, which when touched, lead to a
 * {@link ItemDetailActivity} representing item details. On tablets, the
 * activity presents the list of items and item details side-by-side using two
 * vertical panes.
 * <p>
 * The activity makes heavy use of fragments. The list of items is a
 * {@link ItemListFragment} and the item details (if present) is a
 * {@link ItemDetailFragment}.
 * <p>
 * This activity also implements the required {@link ItemListFragment.Callbacks}
 * interface to listen for item selections.
 */
public class ItemListActivity extends FragmentActivity implements
        ItemListFragment.Callbacks {

    /**
     * Whether or not the activity is in two-pane mode, i.e. running on a tablet
     * device.
     */
    private boolean mTwoPane;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_item_list);

        if (findViewById(R.id.item_detail_container) != null) {
            // The detail container view will be present only in the
            // large-screen layouts (res/values-large and
            // res/values-sw600dp). If this view is present, then the
            // activity should be in two-pane mode.
            mTwoPane = true;

            // In two-pane mode, list items should be given the
            // 'activated' state when touched.
            ((ItemListFragment) getSupportFragmentManager().findFragmentById(
                    R.id.item_list)).setActivateOnItemClick(true);
        }

        // TODO: If exposing deep links into your app, handle intents here.
    }

    /**
     * Callback method from {@link ItemListFragment.Callbacks} indicating that
     * the item with the given ID was selected.
     */
    @Override
    public void onItemSelected(String id) {
        if (mTwoPane) {
            // In two-pane mode, show the detail view in this activity by
            // adding or replacing the detail fragment using a
            // fragment transaction.
            Bundle arguments = new Bundle();
            arguments.putString(MapDetailFragment.ARG_ITEM_ID, id);
            MapDetailFragment fragment = new MapDetailFragment();
            fragment.setArguments(arguments);
            getSupportFragmentManager().beginTransaction()
                    .replace(R.id.item_detail_container, fragment).commit();

        } else {
            // In single-pane mode, simply start the detail activity
            // for the selected item ID.
            Intent detailIntent = new Intent(this, ItemDetailActivity.class);
            detailIntent.putExtra(MapDetailFragment.ARG_ITEM_ID, id);
            startActivity(detailIntent);
        }
    }
} 
```

我已经引用了 Google Play Services Libs。我的清单如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.reading.trackitparent"
    android:versionCode="1"
    android:versionName="1.0" >

    <permission
        android:name="com.reading.trackitparent.permission.MAPS_RECEIVE"
        android:protectionLevel="signature" />

    <uses-permission android:name="com.reading.trackitparent.permission.permission.MAPS_RECEIVE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

    <uses-feature
        android:glEsVersion="0x00020000"
        android:required="true" />

    <uses-sdk
        android:minSdkVersion="15"
        android:targetSdkVersion="15" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.reading.trackitparent.ItemListActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.reading.trackitparent.ItemDetailActivity"
            android:label="@string/title_item_detail" >
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".ItemListActivity" />
        </activity>

        <uses-library android:name="com.google.android.maps" />
    </application>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="xxxxxxxxxxxxxxxxxxxxxxxxxxx" />

</manifest> 
```

我真的很感激任何帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T23:25:07.460

替换`MapFragment`为`SupportMapFragment`。`SupportMapFragment`是与片段的 Android 支持包反向移植一起使用的一种。`MapFragment`适用于原生 API 级别 11 版本的片段。

# python - 如何诊断“ImportError：无法导入名称”

> ID：14086657
> 
> 赞同：1
> 
> 时间：2012-12-29T22:57:51.047
> 
> 标签：python, importerror, python-import

我正在寻找一种系统的方法来处理 python 中的“无法导入名称”错误。我想知道

1.  产生此消息的所有情况是什么
2.  可以做些什么来确定错误的原因。

我知道循环进口是一个常见原因，但似乎还有其他原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:00:46.320

回溯是确定导入是否周期性的一种方法。

另一种可能性是导入的模块中不存在该名称。您要么拼错了名称，要么导入了与预期*不同*的模块。通过运行诊断：

```
import module
print module.__file__ 
```

检查您是否获得了正确的模块。用于`dir(module)`检查它定义的名称。

# php - PhpMailer - 无法向大量订阅者发送时事通讯

> ID：14086667
> 
> 赞同：2
> 
> 时间：2012-12-29T22:59:24.873
> 
> 标签：php, email, send, phpmailer, newsletter

我这里有个大问题！我需要向我的所有订阅者（大约 1200 人）发送时事通讯，问题是它只向其中 150-180 人发送时事通讯。我有一个在 php 中实现的脚本，它使用 PhpMailer() 类将时事通讯发送给所有订阅者。

我在 MailJet 中购买了一个计划，该计划允许我每月发送 3 万封电子邮件，因此我使用他们的 SMTP 主机发送时事通讯。

这是我的脚本：

```
$mail             = new PHPMailer();
$body             = $message;
$body             = eregi_replace("[\]",'',$body);

$mail->IsSMTP();
$mail->SMTPAuth   = true;
$mail->Host       = "in.mailjet.com";
$mail->Port       = 80;
$mail->Username   = "username";
$mail->Password   = "password";

// thing regarding the body, subject, etc of the email //

$to_list = explode(',',$to);
$between_delay = 75; //max limit of mails send at a slot
$send_count = 1; 
$send_delay = 1; //Delays the program execution for the given number of seconds.

ignore_user_abort(true); // Ignore user aborts and allow the script to run forever
set_time_limit(300); //to prevent the script from dying

foreach($to_list as $row){
    if ( ($send_count % $between_delay) == 0 ){
        sleep( $send_delay ); //Delays the program execution for the given number of seconds.
    }
    $address = $row;
    if(!empty($address)) {
        $mail->AddAddress($address, "User");
        $mail->Send();
        $mail->ClearAddresses(); //clear address
   }
   $send_count++;
}

if(!empty($mail->ErrorInfo)) {
     // display an error
} 
```

我真的不知道可能是什么问题，但由于某种原因，它在大约 180 号之后停止发送电子邮件。可能是关于**set_time_limit(300);** ??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:35:53.103

我不建议将时事通讯的副本发送到每个单独的电子邮件地址；它浪费带宽并强制您的脚本发送消息的多个副本。

相反，请考虑使用 SMTP 服务器的密件抄送 (BCc) 功能来发送大量电子邮件。这将允许您的 SMTP 服务器优化时事通讯的传递，并且还可以节省您的带宽。

PHPMailer API 的快速查找表明您可以使用该`$mailer->AddBCC()`函数添加密件抄送地址。例如，`$php_mailer->AddBCC('somebody@example.com', 'Joe Somebody');`应该工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-01T10:47:35.087

只是为了更新这篇文章，[Mailjet](https://www.mailjet.com/)现在有一个易于使用的 PHP 包装器来发送您的电子邮件并在我们新的 REST API 上执行任何请求。

[您可以在此处](https://github.com/mailjet/mailjet-apiv3-php-simple)的Github 上找到它，并在[此处](http://dev.mailjet.com/)找到完整的文档。

# css - 从精灵中推断出 css 中的背景切片

> ID：14086668
> 
> 赞同：6
> 
> 时间：2012-12-29T22:59:47.623
> 
> 标签：css, sprite

Sprites 适用于不改变尺寸的小图标，但我倾向于使用很多 1px 宽的背景切片来处理按钮和 div 背景之类的东西。有没有办法将这些切片包含在精灵中？为了做到这一点，必须有一种方法从精灵中取出一小块并将其外推到元素的整个背景上，本质上是从精灵中切割它并让它重复，就好像它是一个独立的背景图像一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T03:20:27.743

听起来您正在使用 1px 宽的图像进行渐变。我猜你只想在一个方向上重复图像，而不是两个方向。如果是这种情况，您可以制作一个 1px 宽的图像精灵。诀窍是根据您将重复图像的方向布置您的精灵。还要注意是否将它们定位在右侧或底部，例如，如果您的渐变应该位于容器的底部，您可能希望将该渐变定位在精灵的底部。如果您的所有图像水平重复，您可以将它们布置为单个文件，一个在另一个之上。我喜欢在图像之间有一些透明度，或者将它们与网格线对齐，或者留出足够的空间，以便其他图像不会显示。

在除旧 IE 之外的大多数浏览器中，您可以通过 CSS 创建渐变，而无需使用任何图像。对于旧版本的 IE，您必须使用图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T10:05:15.650

如果我理解正确，Miriam 的答案就是正确的答案。

我将通过几个示例详细说明 Miriam 的答案。

这是使用按钮的渐变 CSS 精灵。

![CSS 渐变精灵](../Images/b66fbf178f0f98f5533bb629c8df6f11.png)

使用 CSS background-position 来定位您要用于特定按钮的特定渐变。

然而，带有图像的渐变已经过时了。对于大多数渐变，您可以简单地使用 CSS 和 IE 过滤器来实现相同的结果。甚至可以使用 CSS 制作非常复杂的渐变（IE 将回退到标准的“一种颜色到一种颜色”渐变。如果您真的希望 IE8 用户拥有与现代浏览器相同的视图，您仍然可以使用图像作为后备.

这是一个很棒的工具（类似于 photoshop），可以创建渐变并简单地复制/粘贴它生成的代码：http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T02:04:11.697

我能想到的*唯一方法是使用“SVG 堆栈”。*基本思想是每个精灵都在同一个“图块”上的不同“层”上，但它们通过 SVG 文件中的一些 CSS 隐藏/显示：

```
<style>
  svg .icon { display: none }
  svg .icon:target { display: inline } 
</style> 
```

这里有更深入的解释：http: [//simurai.com/post/20251013889/svg-stacks](http://simurai.com/post/20251013889/svg-stacks)

现在，这种方法的缺点是它目前仅适用于 Mozilla。没关系，我们可以通过使用线性渐变来解决这个问题，以确保除了 Mozilla 之外的所有人都能获得备用图像：

```
.element {
    background: url(myBG.png);
    background-image: -moz-linear-gradient(transparent, transparent), url(spriteStack.svg#myBG);
} 
```

一旦其他浏览器支持 SVG 背景上的片段，您就可以为它们添加适当的前缀线性渐变。

由于您的 bg 图像很小，我的建议是使用数据 URI。它们看起来像这样：

```
background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAADU5ErkJggg=="); 
```

如果您希望以任何频率更新此图像，Compass（Sass 扩展）可以自动为您生成这些图像，同时缩小您的 CSS（请参阅：[http ://compass-style.org/reference/compass/helpers/内联数据/#inline-image](http://compass-style.org/reference/compass/helpers/inline-data/#inline-image)）。

# optimization - 如何摆脱 Core 中的 `let`？

> ID：14086673
> 
> 赞同：10
> 
> 时间：2012-12-29T23:00:27.673
> 
> 标签：optimization, haskell, core

我有一个在内部循环中经常调用的函数。它看起来像这样：

```
import qualified Data.Vector.Storable as SV

newtype Timedelta = Timedelta Double

cklsLogDens :: SV.Vector Double -> Timedelta -> Double -> Double -> Double
cklsLogDens p (Timedelta dt) x0 x1 = if si <= 0 then -1e50 else c - 0.5*((x1-mu)/sd)^2 
  where
    al  = p `SV.unsafeIndex` 0
    be  = p `SV.unsafeIndex` 1
    si  = p `SV.unsafeIndex` 2
    xi  = p `SV.unsafeIndex` 3
    sdt = sqrt dt
    mu  = x0 + (al + be*x0)*dt
    sd  = si * (x0 ** xi) * sdt
    c   = sd `seq` -0.5 * log (2*pi*sd^2) 
```

（使用 Data.Vector.Storable 是因为该函数稍后需要处理来自 C 函数的数据）

GHC 已经很好地优化了这一点（据我所知，所有变量和操作都是原语），但是看看核心，还有一个`let`仍然在（什么是）函数体内部。我在[这里](http://www.haskell.org/ghc/docs/latest/html/users_guide/faster.html)（以及我不记得的其他地方）读到“让”分配惰性重击，因此可能不利于紧密循环中的性能。我可以摆脱它吗？如果一切可能，我宁愿不将我的函数转换为 20 个案例语句，但如果要求太多，我会接受。

这里是核心：

```
$wloop_s4Li [Occ=LoopBreaker]
  :: GHC.Prim.Double#
     -> GHC.Prim.Int# -> GHC.Prim.Int# -> GHC.Prim.Double#
[LclId, Arity=3, Str=DmdType LLL]
$wloop_s4Li =
  \ (ww_X4OR :: GHC.Prim.Double#)
    (ww1_X4OW :: GHC.Prim.Int#)
    (ww2_X4P1 :: GHC.Prim.Int#) ->
    case GHC.Prim.<# ww1_X4OW ww2_X4P1 of _ {
      GHC.Types.False -> ww_X4OR;
      GHC.Types.True ->
        case GHC.Prim.<=## x_a4tg 0.0 of _ {
          GHC.Types.False ->
            case GHC.Prim.indexDoubleArray#
                   rb2_a4rT (GHC.Prim.+# rb_a4rR (GHC.Prim.-# ww1_X4OW 1))
            of wild17_X4xM { __DEFAULT ->

            let {
      ----  ^^^^ want to get rid off this! 
      ----
      ----
              ipv1_X2S8 [Dmd=Just L] :: GHC.Prim.Double#
              [LclId, Str=DmdType]
              ipv1_X2S8 =
                GHC.Prim.*##
                  (GHC.Prim.*## x_a4tg (GHC.Prim.**## wild17_X4xM y_a3BN))
                  (GHC.Prim.sqrtDouble# tpl1_B3) } in
            case GHC.Prim.logDouble#
                   (GHC.Prim.*##
                      6.283185307179586 (GHC.Prim.*## ipv1_X2S8 ipv1_X2S8))
            of wild18_X3Gn { __DEFAULT ->
            case GHC.Prim.indexDoubleArray#
                   rb2_a4rT (GHC.Prim.+# rb_a4rR ww1_X4OW)
            of wild19_X4AY { __DEFAULT ->
            case GHC.Prim./##
                   (GHC.Prim.-##
                      wild19_X4AY
                      (GHC.Prim.+##
                         wild17_X4xM
                         (GHC.Prim.*##
                            (GHC.Prim.+##
                               x1_X3GA (GHC.Prim.*## x2_X3cb wild17_X4xM))
                            tpl1_B3)))
                   ipv1_X2S8
            of wild20_X3x8 { __DEFAULT ->
            $wloop_s4Li
              (GHC.Prim.+##
                 ww_X4OR
                 (GHC.Prim.-##
                    (GHC.Prim.negateDouble# (GHC.Prim.*## 0.5 wild18_X3Gn))
                    (GHC.Prim.*##
                       0.5 (GHC.Prim.*## wild20_X3x8 wild20_X3x8))))
              (GHC.Prim.+# ww1_X4OW 1)
              ww2_X4P1
            }
            }
            }
            };
          GHC.Types.True ->
            $wloop_s4Li
              (GHC.Prim.+## ww_X4OR -1.0e50)
              (GHC.Prim.+# ww1_X4OW 1)
              ww2_X4P1
        }
    }; } 
```

（是的，当然，既然你必须问，我在过早优化上花费了太多时间......）

这是 NOINLINE 的当前版本

```
import qualified Data.Vector.Storable as SV

newtype Timedelta = Timedelta Double

cklsLogDens :: SV.Vector Double -> Timedelta -> Double -> Double -> Double
{-# NOINLINE cklsLogDens #-}
cklsLogDens p (Timedelta dt) x0 x1 = si `seq` (if si <= 0 then -1e50 else (sd `seq` (c - 0.5*((x1-mu)/sd)^2)))
  where
    al  = p `SV.unsafeIndex` 0
    be  = p `SV.unsafeIndex` 1
    si  = p `SV.unsafeIndex` 2
    xi  = p `SV.unsafeIndex` 3
    sdt = sqrt dt
    mu  = x0 + (al + be*x0)*dt
    sd  = si * (x0 ** xi) * sdt
    c   = sd `seq` (-0.5 * log (2*pi*sd^2))

main = putStrLn . show $ cklsLogDens SV.empty (Timedelta 0.1) 0.1 0.15 
```

对应的核心片段：

```
Main.cklsLogDens [InlPrag=NOINLINE]
  :: Data.Vector.Storable.Vector GHC.Types.Double
     -> Main.Timedelta
     -> GHC.Types.Double
     -> GHC.Types.Double
     -> GHC.Types.Double
[GblId, Arity=4, Caf=NoCafRefs, Str=DmdType U(ALL)LLL]
Main.cklsLogDens =
  \ (p_atw :: Data.Vector.Storable.Vector GHC.Types.Double)
    (ds_dVa :: Main.Timedelta)
    (x0_aty :: GHC.Types.Double)
    (x1_atz :: GHC.Types.Double) ->
    case p_atw
    of _ { Data.Vector.Storable.Vector rb_a2ml rb1_a2mm rb2_a2mn ->
    case GHC.Prim.readDoubleOffAddr#
           @ GHC.Prim.RealWorld rb1_a2mm 2 GHC.Prim.realWorld#
    of _ { (# s2_a2nH, x_a2nI #) ->
    case GHC.Prim.touch#
           @ GHC.ForeignPtr.ForeignPtrContents rb2_a2mn s2_a2nH
    of _ { __DEFAULT ->
    case GHC.Prim.<=## x_a2nI 0.0 of _ {
      GHC.Types.False ->
        case x0_aty of _ { GHC.Types.D# x2_a13d ->
        case GHC.Prim.readDoubleOffAddr#
               @ GHC.Prim.RealWorld rb1_a2mm 3 GHC.Prim.realWorld#
        of _ { (# s1_X2oB, x3_X2oD #) ->
        case GHC.Prim.touch#
               @ GHC.ForeignPtr.ForeignPtrContents rb2_a2mn s1_X2oB
        of _ { __DEFAULT ->
        case ds_dVa
             `cast` (Main.NTCo:Timedelta :: Main.Timedelta ~# GHC.Types.Double)
        of _ { GHC.Types.D# x4_a13m ->
        let {
   --- ^^^^ want to get rid of this!
   ---
          ipv_sYP [Dmd=Just L] :: GHC.Prim.Double#
          [LclId, Str=DmdType]
          ipv_sYP =
            GHC.Prim.*##
              (GHC.Prim.*## x_a2nI (GHC.Prim.**## x2_a13d x3_X2oD))
              (GHC.Prim.sqrtDouble# x4_a13m) } in
        case x1_atz of _ { GHC.Types.D# x5_X14E ->
        case GHC.Prim.readDoubleOffAddr#
               @ GHC.Prim.RealWorld rb1_a2mm 0 GHC.Prim.realWorld#
        of _ { (# s3_X2p2, x6_X2p4 #) ->
        case GHC.Prim.touch#
               @ GHC.ForeignPtr.ForeignPtrContents rb2_a2mn s3_X2p2
        of _ { __DEFAULT ->
        case GHC.Prim.readDoubleOffAddr#
               @ GHC.Prim.RealWorld rb1_a2mm 1 GHC.Prim.realWorld#
        of _ { (# s4_X2pi, x7_X2pk #) ->
        case GHC.Prim.touch#
               @ GHC.ForeignPtr.ForeignPtrContents rb2_a2mn s4_X2pi
        of _ { __DEFAULT ->
        case GHC.Prim.logDouble#
               (GHC.Prim.*## 6.283185307179586 (GHC.Prim.*## ipv_sYP ipv_sYP))
        of wild9_a13D { __DEFAULT ->
        case GHC.Prim./##
               (GHC.Prim.-##
                  x5_X14E
                  (GHC.Prim.+##
                     x2_a13d
                     (GHC.Prim.*##
                        (GHC.Prim.+## x6_X2p4 (GHC.Prim.*## x7_X2pk x2_a13d)) x4_a13m)))
               ipv_sYP
        of wild10_a13O { __DEFAULT ->
        GHC.Types.D#
          (GHC.Prim.-##
             (GHC.Prim.negateDouble# (GHC.Prim.*## 0.5 wild9_a13D))
             (GHC.Prim.*## 0.5 (GHC.Prim.*## wild10_a13O wild10_a13O)))
        }
        }
        }
        }
        }
        }
        }
        }
        }
        }
        };
      GHC.Types.True -> lvl_r2v7
    }
    }
    }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T11:22:08.363

丹尼尔是对的——`let`事实上，这个问题并没有分配一个 thunk。这实际上是不可能的，因为诸如此类的原始类型`Double#`没有堆表示。这些`let`s实际上在所谓的核心准备阶段`case`转换为 STG 之前转换为表达式（这是“ = 分配”规则实际成立的地方）。[请参阅CorePrep.lhs](https://github.com/ghc/ghc/blob/master/compiler/coreSyn/CorePrep.lhs#L76)`let`中有关此主题的评论。

这是准备之前的核心（`-ddump-simpl`）：

```
 let {
      ipv_sPL [Dmd=Just L] :: GHC.Prim.Double#
      ipv_sPL =
        GHC.Prim.*##
          (GHC.Prim.*## x_a160 (GHC.Prim.**## x1_a11G x2_X17h))
          (GHC.Prim.sqrtDouble# x3_a11P) } in [...] 
```

在 ( `-ddump-prep`) 之后：

```
 case GHC.Prim.sqrtDouble# x3_s1aU of sat_s1cB { __DEFAULT ->
    case GHC.Prim.**## x1_s1aQ x2_s1aR of sat_s1cC { __DEFAULT ->
    case GHC.Prim.*## x_s1aC sat_s1cC of sat_s1cD { __DEFAULT ->
    case GHC.Prim.*## sat_s1cD sat_s1cB of ipv_s1aW [Dmd=Just L] { __DEFAULT -> 
```

所以实际上没有任何堆分配。

另一方面，请注意，核心准备还将每个应用程序显式包装到`let`or`case`语句中，从而产生非常冗长的代码。这就是为什么`-ddump-simpl`可能被认为是查看 Core 的默认设置，尽管它的性能模型实际上稍微令人惊讶。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T01:26:33.450

`-O`使用 ghc-7.6.1，我在and之间没有区别`-O2`，任何`seq`s 或 bang-patterns 也没有任何区别`let`。核心仍然存在。

但我怀疑这`let`是否真的有害，它绑定了一个原始值，而不是一个装箱的值，并且该值随后在三个地方使用。此外，在生成的程序集中，我找不到任何懒惰的提示（但由于我对程序集的了解相当有限，请不要将此视为福音）。

`let`我可以通过引入一个案例分支来摆脱它，

```
cklsLogDens p (Timedelta dt) x0 x1
    = case p `SV.unsafeIndex` 2 of
        si | si <= 0   -> -1e50
           | otherwise ->
                let al  = p `SV.unsafeIndex` 0
                    be  = p `SV.unsafeIndex` 1
                    xi  = p `SV.unsafeIndex` 3
                    sdt = sqrt dt
                    mu  = x0 + (al + be*x0)*dt
                in case si*(x0**xi)*sdt of
                     0   -> 0
                     sd -> -0.5*log (2*pi*sd^2) - 0.5*((x1-mu)/sd)^2 
```

仅`case`在核心中产生 s。由于`sd`永远不应该为 0，因此在循环中，即使是平庸的分支预测器也应该使该分支基本上自由。

但是，我怀疑这是否真的会提高性能。与 0 的比较需要一个寄存器，原始生成的程序集需要较少的间接寻址，并且可以在需要时在寄存器中保留更多的值。

# c++ - 适用于 iOS 和 Android 的 C++ 文件操作

> ID：14086674
> 
> 赞同：2
> 
> 时间：2012-12-29T23:00:30.023
> 
> 标签：c++, ios, file-io

我需要在 C++ 中执行某个文件操作，如下所示：

1.  查找并删除给定目录中的所有文件。
2.  查找给定文件是否存在，如果存在，则删除它等。

请告诉我一个适用于 android 和 iOS 平台的 C++ 解决方案/库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:05:57.350

C++ 为您提供了文件交互的规定。

我将向您展示我的 FileReader 类，该类使用 C++ 处理一些 C 风格的文件。

```
// BEGIN HEADER
#include <stdio.h>
#include <exception>
#include <stdexcept>

#define DISALLOW_COPY(type) \
    type(const type&); \
    void operator=(const type&)

class FileReader { // RAII applies to file contents
    FILE *file; // c-style open/close
    DISALLOW_COPY(FileReader);
protected:
    unsigned char *data; // local copy
    long size;
public:
    FileReader(const char *filename);
    ~FileReader();
    unsigned long getSize();
    unsigned char *getFileData();
};
// END HEADER

FileReader::FileReader(const char *filename) {

    file = NULL; data = NULL;
    if (!(file = fopen(filename, "rb"))) { throw std::runtime_error(std::string("File could not be opened: ")+filename); }
    fseek(file,0,SEEK_END);
    size = ftell(file);
    rewind(file);
    data = new unsigned char [size];
    VERIFY(size == (long)fread(data, 1, size, file)); // debug macro (just ignore it)
    fclose(file);
#ifdef DEBUG
    PRINT("FileReader opening file "); printf("%s, %ld bytes.\n",filename,size);
#endif
}
FileReader::~FileReader() {
    delete[] data;
}
unsigned char *FileReader::getFileData() { return data; }
unsigned long FileReader::getSize() { return size; } 
```

我会注意到，如果可以的话，您可能希望避免使用 C++ 列出目录中的文件。为什么你不能简单地假设某些文件是否存在？我已经完成了一些游戏编程，几乎唯一需要担心文件系统的时间是用于记录目的或加载资产。对于这两者，您几乎可以假设它们的路径是什么。

此外，您可能需要查看删除文件的[删除功能](http://www.cplusplus.com/reference/cstdio/remove/)。我想不出任何 C++ 中的原始代码来执行该任务`ls`。我不会使用 C++ 来完成这样的任务（提示：`ls`是一个非常简洁的程序）。

还请查看`stat`和`opendir`（感谢 Ben）应该在您的平台上可用。另一点要说明的是，诸如在目录中列出文件之类的任务通常是您要让操作系统内核为您做的事情。

另一个回答者提到的更高级的方法是 Boost Filesystem，这是一个可靠的选择，因为 Boost 通常是：看一下[这个目录迭代示例](http://www.boost.org/doc/libs/1_49_0/libs/filesystem/v3/doc/tutorial.html#Directory-iteration)。

从游戏编程的角度来看，我倾向于依赖 Lua 之类的东西`os()`。例如，如果您有一个 Python 程序，那么`os.system("ls")`假设您有一个可用的程序，您可以执行类似获取您的目录内容的`ls`操作。

您也可以`exec`使用`ls`C++ 程序中的程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:13:18.833

您可以尝试使用[Boost](http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/index.htm)库，这似乎是一个流行的选择。它在[iOS](http://www.danielsefton.com/2012/03/building-boost-1-49-with-clang-ios-5-1-and-xcode-4-3/)和[Android](http://www.mfoot.com/2011/12/building-boost-1-47-for-android-using-cmake-and-the-ndk/)上运行。

有关如何使用 Boost 以跨平台方式操作文件和目录的更多信息，请参阅SO 上的[此答案。](https://stackoverflow.com/a/612112/1448759)

例如，这里有一些来自 Boost 网站的代码，用于检查特定文件是否存在，在目录中递归检查：

```
#include "boost/filesystem/operations.hpp"
#include "boost/filesystem/path.hpp"
#include "boost/progress.hpp"
#include <iostream>

namespace fs = boost::filesystem;

int main( int argc, char* argv[] )
{
  boost::progress_timer t( std::clog );

  fs::path full_path( fs::initial_path<fs::path>() );

  if ( argc > 1 )
    full_path = fs::system_complete( fs::path( argv[1] ) );
  else
    std::cout << "\nusage:   simple_ls [path]" << std::endl;

  unsigned long file_count = 0;
  unsigned long dir_count = 0;
  unsigned long other_count = 0;
  unsigned long err_count = 0;

  if ( !fs::exists( full_path ) )
  {
    std::cout << "\nNot found: " << full_path.file_string() << std::endl;
    return 1;
  }

  if ( fs::is_directory( full_path ) )
  {
    std::cout << "\nIn directory: "
              << full_path.directory_string() << "\n\n";
    fs::directory_iterator end_iter;
    for ( fs::directory_iterator dir_itr( full_path );
          dir_itr != end_iter;
          ++dir_itr )
    {
      try
      {
        if ( fs::is_directory( dir_itr->status() ) )
        {
          ++dir_count;
          std::cout << dir_itr->path().filename() << " [directory]\n";
        }
        else if ( fs::is_regular_file( dir_itr->status() ) )
        {
          ++file_count;
          std::cout << dir_itr->path().filename() << "\n";
        }
        else
        {
          ++other_count;
          std::cout << dir_itr->path().filename() << " [other]\n";
        }

      }
      catch ( const std::exception & ex )
      {
        ++err_count;
                                                                                                                                                                        std::cout << dir_itr->path().filename() << " " << ex.what() << std::endl;
      }
    }
    std::cout << "\n" << file_count << " files\n"
              << dir_count << " directories\n"
              << other_count << " others\n"
              << err_count << " errors\n";
  }
  else // must be a file
  {
    std::cout << "\nFound: " << full_path.file_string() << "\n";    
  }
  return 0;
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T23:23:45.183

[Boost 文件系统](http://www.boost.org/doc/libs/1_52_0/libs/filesystem/doc/index.htm)非常适合您。[iOS 版本和 clang++](http://www.danielsefton.com/2012/03/building-boost-1-49-with-clang-ios-5-1-and-xcode-4-3/)。[升压和 NDK](http://www.mfoot.com/2011/12/building-boost-1-47-for-android-using-cmake-and-the-ndk/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T23:30:02.403

如果您正在为 Android 工作，您可能会在 Java Activity 中编写一些游戏，然后将大部分繁重的工作委托给您的本地 C/C++ 代码。

因此，如果 Steven Lu 的答案不是开箱即用，您可以使用 Java 的 File 类并列出任何目录下的所有文件名，然后将其传递给他的本机文件处理类并完成它。或者，只需用 Java 处理它。

不过对于 iOS，也许这会运行？

```
#include <dirent.h> // directory header
#include <stdio.h>

void listdir (const char *path)
{
    // first off, we need to create a pointer to a directory
    DIR *pdir = NULL; 
    pdir = opendir (path); // "." will refer to the current directory
    struct dirent *pent = NULL;
    if (pdir == NULL) // if pdir wasn't initialised correctly
    { // print an error message and exit the program
        printf ("\nERROR! pdir could not be initialised correctly");
        return; // exit the function
    } // end if

    while (pent = readdir (pdir)) // while there is still something in the directory to list
    {
        if (pent == NULL) // if pent has not been initialised correctly
        { // print an error message, and exit the program
            printf ("\nERROR! pent could not be initialised correctly");
            return; // exit the function
        }
        // otherwise, it was initialised correctly. let's print it on the console:
        printf ("%s\n", pent->d_name);
    }

    // finally, let's close the directory
    closedir (pdir);
}

/** EXAMPLE USAGE **/
int main ()
{
    listdir ("C:\\");
    return 0;
} 
```

但就像我说的，Android 会给你带来更大的问题，因为如果你想弄乱 AndroidManifest.xml 文件中的用户文件，你需要请求访问 SD_CARD 和 INTERNAL_STORAGE 的权限。主要是因为您的大部分内容都在 /data/data/your.package.name 文件夹中，因为您必须将游戏作为 APK 而不是本机应用程序（可执行二进制文件）发布

因此，您实际上并不需要一个 android 和 ios 库，您需要一个可以在 iOS 上运行的库，稍后您将使用 Android 的 Java (Activity) 来包装它:)

# javascript - 哪些浏览器支持 console.log()？

> ID：14086675
> 
> 赞同：28
> 
> 时间：2012-12-29T23:00:33.723
> 
> 标签：javascript, cross-browser, console.log

所有浏览器都支持吗？我想使用输出错误，`console.log()`但想知道是否所有浏览器都支持？

```
console.log("Error etc"); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-29T23:04:23.147

不，并非所有浏览器都支持`console.log`，因为它不是标准的一部分，并且是 DOM 的扩展，因此您不应该指望它的存在。为了使您的代码具有弹性，您应该假设它*不*存在并相应地编码。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-22T22:17:50.567

我过去做过这样的事情：

```
// Log to native console if possible, alert otherwise
window.console = typeof window.console === 'undefined'
    ? {log:function(/* polymorphic */){alert(arguments)}}
    : window.console; 
```

您可以将它放在 JS 的“顶部”，当您被迫使用不支持的浏览器进行调试时，它工作得非常好`console`，并且不需要您更改已经调用的其他 JS 源`console.log`到处都是。当然，除了`alert`保持理智之外，您可能还想做其他事情……

[http://jsfiddle.net/4dty5/](http://jsfiddle.net/4dty5/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-08-12T11:39:26.717

现在是*August 2015*，我认为这个问题的当前答案是：

**移动和桌面上的所有主要浏览器都支持 console.log。**（[犬](http://caniuse.com/#feat=console-basic)）

它不是任何标准的一部分，但它现在是一个完整的现代浏览器的预期交付物。

然而：

> 如果您需要支持旧浏览器（[IE<10](https://stackoverflow.com/questions/5472938/does-ie9-support-console-log-and-is-it-a-real-function#5473193) ）、更多移动浏览器或运行实验性浏览器的用户，那么使用 polyfill（[1、2、3、4](https://stackoverflow.com/questions/14086675/which-browsers-support-console-log#22846496) [）](https://github.com/paulmillr/console-polyfill)[来](https://github.com/h5bp/html5-boilerplate/blob/85d79ed6cc33eb7ba5e156085049758f07b47fd9/src/js/plugins.js)确保存在可能是[个好主意。](http://www.paulirish.com/2009/log-a-lightweight-wrapper-for-consolelog/)`window.console`
> 
> 它可能不适用于所有浏览器上的**WebWorkers**。( [MDN](https://developer.mozilla.org/en-US/docs/Web/API/Console/log) )
> 
> 在 UC Browser 和 Opera Mini 中，这些函数将运行，但您不会看到输出。（[犬](http://caniuse.com/#feat=console-basic)）

但是对于现在绝大多数的网络用户，我们可以假设`console.log`会按预期工作。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-04-03T18:55:50.117

此代码将检查该函数是否存在并创建一个虚拟函数以防它不存在。信用：[堆栈溢出](https://stackoverflow.com/a/9593812/441878)

```
if (!window.console) window.console = {};
if (!window.console.log) window.console.log = function () { }; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-12-29T23:06:20.593

做一个包装函数：

```
function log(text) {
  if (window.console) {
     window.console.log(text);
  }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-12-29T23:04:39.647

大多数浏览器都可以，但是 Internet Explorer 9 存在问题，除非您打开调试窗口，否则它不会运行任何 javascript。我们花了几个小时才找到解决这个问题的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-13T11:06:48.500

这是`console.log()`不可用时的解决方法。您必须`console.logs`自己检索。

```
 if (!window.console) window.console = {};
  if (!window.console.log) 
  {
    window.console.logs = [];
    window.console.log = function (string)
    {
      window.console.logs.push(string);
    };
  } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-11T16:52:30.253

尽管并非所有浏览器都支持这一点，但它可以通过一小段代码来完成。

在他的书“Javascript Ninja 的秘密”中，John Resig（jQuery 的创建者）有一个非常简单的代码来处理跨浏览器`console.log`问题。他解释说他希望有一个适用于所有浏览器的日志消息，这是他的编码方式：

```
 function log() {
  try {
     console.log.apply(console, arguments);
  } catch(e) {
  try {
     opera.postError.apply(opera, arguments);
  }
  catch(e) {
     alert(Array.prototype.join.call( arguments, " "));
  }
} 
```

# java - 如何在 Gnome/Linux 中监控通知点击？

> ID：14086681
> 
> 赞同：0
> 
> 时间：2012-12-29T23:01:35.083
> 
> 标签：java, notifications, gnome

我正在使用通知（通知发送，通知守护程序）向用户发送警报。我想知道如果/当用户单击通知弹出窗口时，无论是在弹出窗口上，还是在任务栏/面板上的菜单上，我将如何抓取。我正在使用 Java，所以如果可能的话，如果你有任何其他想法来获得类似的通知，那就太好了（我知道可以使用 Java AWT，但我觉得它看起来比普通通知更糟糕）。

任何帮助表示赞赏，链接或任何东西，不一定是代码。我觉得我只是不知道谷歌是什么。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T10:52:15.643

我不熟悉 java，但通知系统用于不中断用户，我不知道您请求的功能（我谈论通知守护程序和 freedesktop 通知规范）。但是，可以向通知气泡添加一个按钮（称为操作），因此用户可以单击它并激活您设置的回调（以便您可以交互）。也许这是一个解决方案？如果不是，您可能不必使用/编写“系统”通知，而是特定于应用程序的通知（如 OSD 库或类似的东西）。

*   [通知中的操作示例 (python)](http://blog.abhijeetr.com/2011/09/adding-buttons-while-using-python.html)
*   [Freedesktop 操作规范](https://developer.gnome.org/notification-spec/)

# asp.net - 从数据库中选择特定值

> ID：14086683
> 
> 赞同：-1
> 
> 时间：2012-12-29T23:01:45.313
> 
> 标签：asp.net, vb.net

我尝试使用以下代码从数据库中选择特定值：

```
 Dim rs, data, lo

    data = "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & _
    Server.MapPath("games.mdb")

    rs = Server.CreateObject("ADODB.Recordset")

    rs.open("select * FROM [index] where ID1=1 ", data)

    Image1.ImageUrl = "images/" + rs("url").ToString

    lo =rs("url")

    rs.MoveNext()
    rs.Close() 
```

当我运行它时，我得到：

```
show 

System.__ComObject 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:17:49.750

问题是您尝试使用 COM 对象，而实际上您应该使用本机[System.Data.OleDb](http://msdn.microsoft.com/en-us/library/6d9ew87b.aspx)类。

根据 Microsoft 提供的示例，这里是使用本机类重写的代码：

```
 Dim connectionString As String

    connectionString = "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & Server.MapPath("games.mdb")

    Using connection As New System.Data.OleDb.OleDbConnection(connectionString)
        Using command As New System.Data.OleDb.OleDbCommand("select * FROM [index] where ID1=1")
            ' Set the Connection to the new OleDbConnection.
            command.Connection = connection

            ' Open the connection and execute the select command. 
            Try
                connection.Open()
                Dim oReader As System.Data.OleDb.OleDbDataReader

                oReader = command.ExecuteReader()
                If oReader.Read() Then
                    Image1.ImageUrl = "images/" + oReader("url").ToString
                End If
            Catch ex As Exception
                Console.WriteLine(ex.Message)
            End Try
        End Using
        ' The connection is automatically closed when the code exits the Using block. 
    End Using 
```

# .net - 在 Base 对象中构造派生类型的对象

> ID：14086684
> 
> 赞同：5
> 
> 时间：2012-12-29T23:01:50.360
> 
> 标签：.net, vb.net, class

在 vb.net 中是否可以有一个方法来构造低音类中任何派生类的对象？在这段代码中，x.Clone 应该返回一个 Bar 对象。是用两种不同的对象类型复制两个类中的代码的唯一方法。

```
Module Module1

    Sub Main()
        Dim x As New Bar
        Dim y As Bar = x.Clone
    End Sub

End Module

Public Class Foo
    Implements ICloneable
    Public Function Clone() As Object Implements System.ICloneable.Clone
        Clone = Me.new() 'fails to compile as not in a constructor
        Clone = new Foo 'constructs a new foo in the derived class
    End Function
End Class

Public Class Bar
    Inherits Foo
    'additional implementation
    'but no addition fields
End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T23:55:14.910

The answer depends on specifically what you are trying to accomplish in the cloning method.

If you want to create a new instance of the current class without actually copying any of the properties (which is sounds like you may be interested in doing based on the sample code and description), then the simple solution is:

```
Public Class Foo
    Implements ICloneable

    Public Function Clone() As Object Implements System.ICloneable.Clone
        Return Activator.CreateInstance(Me.GetType)
    End Function
End Class 
```

You can test that this is called by adding a message (or some sort of debug or output) in Bar:

```
Public Class Bar
    Inherits Foo

    Public Sub New()
        MsgBox("Test")
    End Sub

End Class 
```

If you have `Option Strict On`, which I strongly recommend, the code in main would be:

```
Sub Main()
    Dim x As New Bar
    Dim y As Bar = DirectCast(x.Clone, Bar)
End Sub 
```

However, if you are interested in copying the member values from the current class, you can use [MemberwiseClone](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx):

```
Public Class Foo
    Implements ICloneable

    Public Function Clone() As Object Implements System.ICloneable.Clone
        Return Me.MemberwiseClone
    End Function
End Class 
```

However, this will only create a shallow copy, will copy references, and will not invoke the constructor on Bar. When we use MemberwiseClone in this manner, we always add an overridable method that can be used by inheritors to perform post-clone cleanup:

```
Public Class Foo
    Implements ICloneable

    Public Function Clone() As Object Implements System.ICloneable.Clone
        Dim oObject As Foo

        oObject = DirectCast(Me.MemberwiseClone, Foo)
        oObject.PostCloneCleanup()

        Return oObject
    End Function

    Protected Overridable Sub PostCloneCleanup()

    End Sub
End Class

Public Class Bar
    Inherits Foo

    Public Sub New()
        MsgBox("Test")
    End Sub

    Protected Overrides Sub PostCloneCleanup()
        MsgBox("PostCloneCleanup")
    End Sub

End Class 
```

Finally, if shallow copying or dealing with copied references is not to you liking, you can perform a deep copy using a cheap, but very effective trick: serialization and deserialization using the BinaryFormmater:

```
Public Function CreateDeepCopy(Of T)(ByVal oRecord As T) As T

    If oRecord Is Nothing Then
        Return Nothing
    End If

    If Not oRecord.GetType.IsSerializable Then
        Throw New ArgumentException(oRecord.GetType.ToString & " is not serializable")
    End If

    Dim oFormatter As New System.Runtime.Serialization.Formatters.Binary.BinaryFormatter

    Using oStream As IO.MemoryStream = New IO.MemoryStream
        oFormatter.Serialize(oStream, oRecord)
        oStream.Position = 0
        Return DirectCast(oFormatter.Deserialize(oStream), T)
    End Using
End Function 
```

This requires that the classes be serializable, but that is easy to do.

# wildcard - 如何在 Neo4j 的密码查询中对节点属性使用通配符

> ID：14086689
> 
> 赞同：1
> 
> 时间：2012-12-29T23:03:04.703
> 
> 标签：wildcard, neo4j, cypher, py2neo

我正在尝试从 Neo4j 中的查询参数创建搜索，但似乎无法识别通配符。“*”不适用于节点属性上的通配符。

我的代码如下：

```
price = "*" # by default
query = 'start b = product("*:*") WHERE has(b.public) and (b.public = 1) and (b.price = %d) RETURN ID(b) SKIP %d LIMIT %d;' % (price, skip, limit)
cypher.execute(cdb,query)[0] 
```

不幸的是，当我运行查询或切换到控制台时......

```
start b = product("*:*") WHERE has(b.public) and (b.public = 1) and (b.price = "*") RETURN ID(b) SKIP 0 LIMIT 10; 
```

...我得到空值，就好像价格试图从字面上匹配“*”而不是匹配任何东西，就像通配符一样。例如，当我用 0 替换变量`price`时，一切都很好。

我不太明白，因为[这](http://docs.neo4j.org/chunked/milestone/cypher-query-lang.html)表明我可以这样说：

```
WHERE follower.name =~ 'S.*' 
```

并且 "*" 作为 count(*) 和 node:indexes("*:*") 的通配符

如果这有什么不同，我正在使用 python 和 py2neo。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T11:02:32.143

根据[文档](http://docs.neo4j.org/chunked/stable/query-aggregation.html)， 的含义`count(*)`是计算匹配行的数量。但请记住，匹配是指`MATCH`子句返回的行，而不是通配符匹配。所以`"*"`这里不是普通的通配符。

在`node:indexes("*:*")`第一个“*”中表示“所有键”（索引的）。您不能说`"i*"`“所有以字母'i'开头的键”。

第二个“*”表示所有索引值。但在这里，您也可以说`"foo*"`，意思是“所有以 'foo' 开头的值”。

最后，`"WHERE follower.name =~ 'S.*'"`是一个正则**表达式**匹配。

`"price"`为了使您的案例有效，产品索引上应该存在一个名为的键。然后你可以使用`"price:whatever"`.

# java - Eclim 在启动 Java 程序时忽略本机库路径

> ID：14086691
> 
> 赞同：1
> 
> 时间：2012-12-29T23:03:13.870
> 
> 标签：java, vim, lwjgl, eclim

我正在使用[Eclim](http://eclim.org/)和 Vim 进行 Java 开发。我正在尝试设置[LWJGL](http://lwjgl.org/)，以便可以使用 Java 编写 OpenGL 的东西。因此，当我从 Vim 运行 :Java 以运行我制作的 lwjgl 测试程序时，Eclim 给出：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no lwjgl in java.library.path 
```

即使我使用 Eclipse 生成了这个[.classpath 文件](https://gist.github.com/4409676)，它清楚地包含了我的 Linux 机器的本地 lwjgl 库的路径。

这就是 Eclipse 运行我的程序的方式：

```
-Djava.library.path=/usr/share/lwjgl/native/linux -classpath /home/alex/code/java/OpenGL/bin:/usr/share/lwjgl/jar/lwjgl.jar Test 
```

我有一种 Eclim 省略的感觉：

```
-Djava.library.path=/usr/share/lwjgl/native/linux 
```

这是一个演示情况的[视频（和我的测试程序）。](http://www.youtube.com/watch?v=iNC77NzmIts&feature=player_embedded)

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:02:31.987

我修好了它。这是一个 Eclim 设置。

```
:EclimSettings
zR (to unfold the settings) 
```

找到 org.eclim.java.run.jvmargs 并在 [ ] 中添加：

```
 "-Djava.library.path=/usr/share/lwjgl/native/linux" 
```

# android - 使用挪威语言环境在 Android 中格式化时间返回点而不是冒号作为分隔符

> ID：14086696
> 
> 赞同：0
> 
> 时间：2012-12-29T23:04:10.307
> 
> 标签：android, datetime

在我们的应用程序中格式化本地时间时，我们以前在 .NET 上遇到过这个错误： [.NET (3.5) 使用点而不是冒号来格式化时间作为 IT 文化的 TimeSeparator？](https://stackoverflow.com/questions/7498058/net-3-5-formats-times-using-dots-instead-of-colons-as-timeseparator-for-it-it)这在 .NET 4.0 中已修复。

当我们测试本地时间的 Android 格式时，我们在挪威语言环境中得到相同的错误，我们得到的时间为“21.00”，而我们在挪威使用时间段，所以它应该是“21:00”。

```
DateFormat tf = android.text.format.DateFormat.getTimeFormat(m_activity); 
```

当我测试它时，这发生在 Android 4.2 和 4.0.4 上。这也是bug吗？

而且我看到 Android 在英国也使用 AM/PM，这也有点“不标准”？ [使用 en_GB 语言环境格式化时间在 Android 和标准 Java 中给出不同的结果](https://stackoverflow.com/questions/5490268/formatting-time-with-en-gb-locale-gives-different-results-in-android-and-standar)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:06:48.530

为什么不用[http://docs.oracle.com/javase/1.4.2/docs/api/java/text/NumberFormat.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/NumberFormat.html)自己格式化呢？

显然，在你从谷歌得到明确的答复之前，你不会知道它是一个功能还是一个错误，即使它确实得到了确认——天知道它什么时候会得到修复。他们仍然有 2009 年的未决错误！

我建议您使用 NumberFormat 进行“临时”解决方法来解析某些 DateFormat 输出并以这种方式“标准化”它们。节拍等待谷歌解决这个问题:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T21:33:25.410

谷歌工程师的回答： [http ://code.google.com/p/android/issues/detail?id=42104](http://code.google.com/p/android/issues/detail?id=42104)

“像往常一样，我的建议是不要使用 android.text.format.DateFormat。如果你使用 java.text.DateFormat，它将使用 CLDR 中的格式。

问题在于它不会尊重用户的 12/24 小时偏好。我正在努力尝试将这些信息传递到 libcore，以便我们可以做正确的事情。（然后我们可以将 frameworks/base 中的重复 API 切换到使用 libcore 实现。）”

# php - 如何在保留树层次结构的同时按字母顺序排列数组？

> ID：14086698
> 
> 赞同：3
> 
> 时间：2012-12-29T23:04:15.610
> 
> 标签：php, arrays, sorting, recursion

我有 2 个长度/深度未知的数组，看起来像这样

```
[1] => Hand Tools
[2] => Power Tools
[4] =>  ╚═►Outdoor Tools
[6] =>    ╚═►dvjdg
[5] =>  ╚═►Indoor Tools
[7] =>    ╚═►blaha
[8] =>    ╚═►blahb
[3] => Garden Tools 
```

和

```
[1] => 0
[2] => 0
[4] => 1
[6] => 2
[5] => 1
[7] => 2
[8] => 2
[3] => 0 
```

两个数组都使用 a`category id`作为数组索引，第二个数组包含每个类别的深度。第一个数组用于生成 HTML`<select>`输入，但我现在需要按字母顺序排列这个数组，同时保持正确的类别层次结构。所以我需要得到一个这样的输出数组。

```
[3] => Garden Tools
[1] => Hand Tools
[2] => Power Tools
[5] =>  ╚═►Indoor Tools
[7] =>    ╚═►blaha
[8] =>    ╚═►blahb
[4] =>  ╚═►Outdoor Tools
[6] =>    ╚═►dvjdg 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:38:12.703

考虑到这`$list`是您的数组，您无法轻松对其进行排序，因为每个“子”元素不携带其父元素的信息（文本）。所以首先是添加该信息：

1.  获得等级。
2.  设置该级别的当前值。
3.  删除更高级别。
4.  将所有级别与文本中未使用的字符合并在一起。

你有排序键。对所有列表条目执行此操作，您将获得所有排序键：

```
$sortkeys = [];
$levels   = [];
foreach ($list as $index => $entry) {
    $level            = strspn($entry, ' ');
    $levels[$level]   = $entry;
    $sortkey          = implode('|', array_slice($levels, 0, $level + 1));
    $sortkeys[$index] = $sortkey;
} 
```

此示例简化了获取级别信息。我计算了每个级别一个空间。您可能有不同的功能并使用不同的功能`strspn`。您很可能会为此使用第二个数组。我懒得打字了，所以我用函数做了。你可能只是：

```
$level = $category_levels[$index]; 
```

`$list`现在您可以根据数组对数组进行排序`$sortkeys`。这可以通过 PHPs 的[`array_multisort`](http://php.net/array_multisort)功能来完成。因为该函数会重新编号数字键，所以我们也对键进行排序，然后在排序后合并以保留它们：

```
$keys = array_keys($list);
array_multisort($sortkeys, SORT_ASC, $list, $keys);

print_r(array_combine($keys, $list)); 
```

这给了你：

```
Array
(
    [3] => Garden Tools
    [1] => Hand Tools
    [2] => Power Tools
    [5] =>  ╚═►Indoor Tools
    [7] =>   ╚═►blaha
    [8] =>   ╚═►blahb
    [4] =>  ╚═►Outdoor Tools
    [6] =>   ╚═►dvjdg
) 
```

观看完整的示例运行：[演示](http://eval.in/5563)

# javascript - GitHub 自述文件上带有图像的 Javascript 小书签

> ID：14086699
> 
> 赞同：2
> 
> 时间：2012-12-29T23:04:21.773
> 
> 标签：javascript, github, bookmarklet, github-flavored-markdown

我在将带有图像的 javascript 小书签添加到我的 github 自述文件时遇到了麻烦。该图像应该使用户可以轻松地将书签添加到他的书签栏。

基本上[，这（http://alaingilbert.github.com/Turntable-API/bookmarklet.html）](http://alaingilbert.github.com/Turntable-API/bookmarklet.html)是我想要实现的，而是在 github 自述文件上。

到目前为止，我有这个：

```
<table style="border: none;">

  <tbody>

    <tr style="border:none;">

      <td style="vertical-align: middle; padding-top: 10px; border: none;">

        <a href="javascript:(function(){ window.open(‘http://www.test.com/’); })();">

          <img src="http://i.imgur.com/vCSDi.png">

        </a>

      </td>

      <td style="vertical-align: middle; text-align: left; border: none;">

        ← Drag this to your bookmark bar.

      </td>

    </tr>

  </tbody>

</table> 
```

但是当我在 github 上查看我的自述文件的源代码时，我注意到 href 属性似乎已经消失了，所以小书签将不再起作用。

github会自动删除javascript href吗？有没有办法解决这个问题？

编辑：table、tbody、tr 和 td 标签的属性似乎也消失了。好像github不喜欢他们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:18:01.590

尝试改变这个：

```
 v                    v
<a href="javascript:(function(){ window.open(‘http://www.test.com/’); })();">
                                             ^                    ^ 
```

对此：

```
 v                    v
<a href="javascript:(function(){ window.open('http://www.test.com/'); })();">
                                             ^                    ^ 
```

您当前使用的引号不是有效的 Javascript 引号分隔符

编辑：演示：

[http://jsfiddle.net/BXn9Z/](http://jsfiddle.net/BXn9Z/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-15T09:02:06.517

重复：[在 GitHub README.md 中嵌入 Bookmarklet](https://stackoverflow.com/questions/19314567)。也有正确答案。无法从 github repo 自述文件中获取书签。相反，您可以使用 github 页面。

# ruby-on-rails - 无法使用此表单

> ID：14086701
> 
> 赞同：0
> 
> 时间：2012-12-29T23:04:35.047
> 
> 标签：ruby-on-rails

我有一个需要更新用户对象属性的表单。

以下是我归结为的三个步骤：

1.  动作“新”需要为表单提供一个对象来操作

2.  表单需要知道要为哪个对象收集值

3.  提交表单时，它需要将这些参数发送到更新用户对象的函数

如果这一切都是洁净的，这就是我为实现这一目标所做的努力。

在“新”操作中，我尝试像这样提供用户对象：

```
 @current_user  = current_user 
```

然后，在视图中，表单如下所示：

```
<%= form_for (@current_user) do |f| %>
   <%= f.label :target_bf_pct %>
   <%= f.text_field :target_bf_pct %>

   <%= f.label :activity_factor %>
   <%= options_for_select([['Sedentary (Desk Job)', 1.2],
                                           ['Light Activity (1-3 day a week)', 1.35],
                                           ['Moderate Activity (3-5 days a week)', 1.55],
                                           ['Very Active ( 6-7 days a week)', 1.75],
                                           ['Extremely Active (Atheletic Endurance)', 1.95]])
%>

  <%# f.submit "Post", class:"btn btn-large btn-primary" %> 
<% end %> 
```

我此时遇到的错误是：

```
undefined method `user_path' for #<#<Class:0x007fd943d00d08>:0x007fd944e5b6c0> 
```

它指的是表单 @current_user 对象，它应该对应于新操作中的 @current_user 实例......

重要的提示：

1.  我正在为我的会话控制器使用[设计](https://github.com/plataformatec/devise)来创建新用户和处理会话。

2.  我不相信我对表单助手 options_for_select 的使用被正确使用，因为我还没有为它分配一个一旦选择它应该代表的值，比如“activity_factor”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T23:10:02.193

此错误可能来自`form_for`助手。它试图找出`action`表单的 URL，所以它观察到它`@current_user`是 a `User`，所以调用`user_path(@current_user)`。如果方法没有定义，那通常意味着没有为 定义路由`users#update`。

尝试运行`rake routes`并确认该`users#update`路线存在。如果没有，请添加并重试。

*另外，一些注意事项：*

*   如果您要更新现有用户，表单可能应该在`edit`操作中。该`new`操作通常保留用于创建全新用户。
*   在`current_user`控制器和视图中都可以访问助手。因此，您可以`current_user`直接在视图中使用；在控制器中设置它有点多余。只是一件小事。
*   Devise 提供了自己的`users#edit`表单和`users#update`操作来更改密码等。我不确定细节，但似乎 Devise 可以轻松覆盖现有表单，只要您要编辑的所有字段都标记为`attr_accessible`. 如果将这些字段合并到现有的设计表单中是合适的，那可能值得进行一些研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:41:13.800

```
<%= form_for(@current_user) do |f| %>
            ^ no space please :) 
```

这不是一个玩笑。

```
<%= form_for (@current_user) do |f| %> 
```

将工作，但是，例如：

```
<%= form_for (@current_user, :class => "user_form") do |f| %> 
```

将不会。有了空间，你就会犯这样的错误。

第二个。您的环境不知道**user_path**

添加到 routes.rb （即使设计的语句存在）：

```
resources :users 
```

# android - 在 IntelliJ 中编译时找不到模块包

> ID：14086704
> 
> 赞同：10
> 
> 时间：2012-12-29T23:05:00.597
> 
> 标签：android, compilation, compiler-errors, intellij-idea

我正在尝试在 IntelliJ 中设置我的 Android 项目。我以前从未使用过它，而且我在模块依赖方面遇到了一些问题。

该项目依赖于几个模块，我在 Dependencies 选项卡中添加了这些模块。IntelliJ 检测到它们（即代码中没有抱怨），但它在编译时失败，并显示“包 xyz 不存在”。我也尝试过检查模块的“导出”，但这似乎没有效果。

我看到这个[问题](https://stackoverflow.com/q/9453900/210070)似乎是同一个问题，但没有解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T23:39:24.517

尝试将您的 src 添加为模块。

*   文件 > 添加模块
*   从现有源创建模块 -> your_src_path_top_level
*   下一步 > 下一步 > 完成
*   文件 > 项目结构 > 模块 > YourApp
*   加号按钮 > 模块依赖 > your_lib_you_added_earlier
*   使用向上/向下箭头移动到列表底部

这是我将 Google Play src 添加为模块的视觉效果。

![在此处输入图像描述](../Images/567ab65fd862098f487b59f9a79ac79a.png)

# css - 与过渡自定义效果以相同的方式进出

> ID：14086709
> 
> 赞同：0
> 
> 时间：2012-12-29T23:06:00.130
> 
> 标签：css, css-transitions

我得到了这个 CSS3 表，但我有一点问题

我需要让它以与它进入时相同的方式出去，我的意思是当它下跌时看看它

```
@-moz-keyframes custom_effect {
    0% { height: 60px;}
    100% {height: 225px;}
}
@-webkit-keyframes custom_effect {
    0% {height: 60px;}
    100% {height: 225px;}
}

ul#nav-drp li:hover {
    -moz-animation-name: custom_effect;
    -moz-animation-duration: 1.0s;
    -moz-animation-timing-function: ease;
    -moz-animation-iteration-count: 1;
    -moz-animation-direction: normal;
    -moz-animation-delay: 4;
    -moz-animation-play-state: running;
    -moz-animation-fill-mode: forwards;

    -webkit-animation-name: custom_effect;
    -webkit-animation-duration: 1.0s;
    -webkit-animation-timing-function: ease;
    -webkit-animation-iteration-count: 1;
    -webkit-animation-direction: normal;
    -webkit-animation-delay: 1;
    -webkit-animation-play-state: running;
    -webkit-animation-fill-mode: forwards; 
```

我无法让它以与进入时相同的方式退出，我试图将 ( `-webkit-animation-timing-function: ease;`)替换为 ()，`-webkit-transition: 1s ease-in-out;`但我没有工作，您能描述一下出了什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:58:24.947

不确定我是否正确理解了您的问题，但是当您说“以与进入相同的方式出去”时，听起来您希望它`height: 60px;`在您悬停时恢复动画？如果是这样，那么关键帧动画就不可能了。一旦你将鼠标悬停在外面，动画就会停止并且元素会跳回到它的原始状态。

然而，这可以使用转换来解决。

这是一个[演示](http://jsfiddle.net/sS7Ud/5/)，这是我的示例中的代码：

HTML

```
<div class="box"></div>​ 
```

CSS

```
.box {
    width: 100px;
    height: 60px;
    background: #005ca1;
    -webkit-transition: height 1s;
       -moz-transition: height 1s;
        -ms-transition: height 1s;
         -o-transition: height 1s;
            transition: height 1s;
}

.box:hover {
    height: 225px;
} 
```

在这种情况下，我已将其设置`height`为我想要`transition`的持续时间为的属性，`1s;`并将其添加到我想要转换的元素中，这将“双向”转换高度。在这种情况下，我以简短的形式编写了转换，但为了澄清起见，长形式的代码如下所示：

```
transition-property: height;
transition-duration: 1s; 
```

也可以添加计时功能等，但在我的示例中我尽量保持简单。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:15:53.590

尝试这个...

```
transition-timing-function:linear; 
```

尝试将转换定时功能从简单更改为线性...

因为 'ease' 属性将有一个缓慢的开始，然后稍微快一点，最后它会再次变慢......所以你不会得到与进出相同的效果......

但是，“线性”属性从开始到结束都会产生相同的效果......

可能工作...

# java - 根据角度和速度寻找速度矢量

> ID：14086721
> 
> 赞同：7
> 
> 时间：2012-12-29T23:08:56.833
> 
> 标签：java, vector, simulation, game-physics, angle

我正在为基于角度和速度的游戏编写一些 AI 运动。它是一个基于 x、y 轴的 2D 程序。我目前有一个位置矢量以及一个速度矢量，它说明了 AI 的速度和当前方向。每次我移动 AI 时，我只需将速度矢量添加到当前位置以获得我的新位置。此刻运动是 8 向的。我想要实现的是基于角度的运动（更现实的运动类型），并且想知道是否可以从角度和速度常数计算速度矢量。

提前致谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-29T23:14:47.197

这最好是可能的。

这就是我设想您的程序的工作方式

```
position_X += velocity_X
position_Y += velocity_Y 
```

通过三角函数你可以做到

```
velocity_X = velocity*cos(angle)
velocity_Y = velocity*sin(angle) 
```

![在此处输入图像描述](../Images/b2e30e4c30c60841e085dc5d743bc501.png)

要记住的几件事包括

1.  当您从上到下时，Y 很可能会增加
2.  逆问题有两种解决方案，您应该研究一个 2 输入反正切函数。请参阅[https://gamedev.stackexchange.com/questions/14602/what-are-atan-and-atan2-used-for-in-games](https://gamedev.stackexchange.com/questions/14602/what-are-atan-and-atan2-used-for-in-games)

# objective-c - __unsafe_unretained 并使用 ARC 释放

> ID：14086723
> 
> 赞同：0
> 
> 时间：2012-12-29T23:09:22.293
> 
> 标签：objective-c, memory-management, automatic-ref-counting

我**必须**使用一个包含类指针的联合，但打开 ARC，并且在这里很好地解释：[__unsafe_unretained NSString struct var](https://stackoverflow.com/questions/11857117/unsafe-unretained-nsstring-struct-var) you have to set the field `__unsafe_unretained`。

这意味着，如果我理解得很好，你必须自己管理它的生命周期。

例如：

```
typedef union FOO {
    char                                    __char;
    __unsafe_unretained NSMutableArray *    __array;
    __unsafe_unretained BarClass *          __bar;
} 
```

如果我这样做：

```
FOO * foo = malloc(sizeof(FOO));
foo.__bar = [[BarClass alloc] init];
... // I have fun with foo.__bar
[foo.__bar release] // this was before ARC and does not work anymore
free(foo); 
```

我该如何释放`foo.__bar`？因为有了 ARC 我不能再打电话了`release`？`autorelease`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:18:36.700

最简单的方法是使用强制转换`__bridge`和`CFRelease`：

```
CFRelease((__bridge void *)foo->__bar); 
```

其他一些注意事项：

1.  不要使用名称`__char`、`__array`和`__bar`。所有以两个连续下划线开头的标识符都被 C 标准保留。

2.  您还需要在创建它的语句结束之前保留该对象，因为在该语句结束时，ARC 将释放它。最简单的方法是滥用`CFBridgingRetain`：

    ```
    foo->__bar = (__bridge id)CFBridgingRetain([[NSObject alloc] init]); 
    ```

3.  你最好只转换`FOO`成一个 Objective-C 类，这样它就可以持有强引用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T23:23:23.720

我会持有一个额外的强指针，然后你就不必担心释放它。

```
BarClass *myStrongBar = [[BarClass alloc] init];

FOO * foo = malloc(sizeof(FOO));
foo.__bar = myStrongBar;
... // I have fun with foo.__bar
free(foo); 
```

# http - HTTP 状态 405 - 此 URL 不支持 HTTP 方法 GET

> ID：14086727
> 
> 赞同：0
> 
> 时间：2012-12-29T23:09:56.833
> 
> 标签：http, jakarta-ee, tomcat, http-status-code-405

我正在编写 jsp-servlet 应用程序并获得 405 http-status。我找了很长时间，但我不明白我做错了什么。

我的应用服务器是 Apache Tomcat-7.0.25。

我的 JSP 转发页面

```
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<body>
   <jsp:forward page="/myservlet" />
</body>
</html> 
```

我的小服务程序

```
public class MyServlet extends HttpServlet {

  private static final String url = "http://ibm.com";

  public void doGet(ServletRequest request, ServletResponse response)
       throws ServletException, IOException {

  URLConnection conn = null;
  URL connectURL = null;

  try {
    PrintWriter out = response.getWriter();
    connectURL = new URL(url);
    conn = connectURL.openConnection();
    DataInputStream theHTML = new DataInputStream(conn.getInputStream());
    String thisLine;
    while ((thisLine = theHTML.readLine()) != null) {
       out.println(thisLine);
    }
    out.flush();
    out.close();
   } catch (Exception e) {
    System.out.println("Exception in MyServlet: " + e.getMessage());
    e.printStackTrace();
   }
  }
} 
```

我的部署描述符 (web.xml) 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
       version="3.0">

   <display-name>My web application</display-name>
   <description>My servet application</description>

   <servlet>
       <servlet-name>MyServlet</servlet-name>
       <servlet-class>MyServlet</servlet-class>
   </servlet>

   <servlet-mapping>
       <servlet-name>MyServlet</servlet-name>
       <url-pattern>/myservlet</url-pattern>
   </servlet-mapping>

   <welcome-file-list>
       <welcome-file>index.html</welcome-file>
       <welcome-file>index.jsp</welcome-file>
   </welcome-file-list>

</web-app> 
```

这可能是什么原因，我该如何解决这个问题？你有什么假设吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:41:55.927

您在方法中有错误类型的参数`toGet()`。它们应该是[HttpServletRequest](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)和[HttpServletResponse](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)：

```
@Override
public void doGet(HttpServletRequest request, HttpServletResponse response) 
```

这样的错误非常令人不快，因为它们不容易被发现。所以不要忽视注释`@Override`。使用它来避免在方法名称或其签名中出现不同的错误打印和其他不幸的误解。它将帮助您在编译时发现这些错误。

# javascript - 正版 Jquery / javascript jpg 图片调整大小

> ID：14086728
> 
> 赞同：3
> 
> 时间：2012-12-29T23:09:59.500
> 
> 标签：javascript, jquery, image, resize

这是不使用 css 宽度/高度或 attr 宽度/高度的调整大小。我将 jpg 图像发布回必须为 1024x768 的服务器，但是，发布的图像可能是基于用户交互（外部加载）的其他尺寸。

例如，如何调整 1124x800 jpg 图像 tp 1024x768 的大小，以便实际调整大小，而不仅仅是通过其 attr 或 css 值标记显示？？？？？？

这可以用画布完成，还是我需要一个特殊的 jquery 插件？？？？？？任何帮助都感激不尽。这是一个开源项目，所以我不是在寻找商业插件，如果需要的话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:38:35.090

是的，这可以通过`<canvas>`.

```
function resize(img, width, height) {
    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    canvas.width = width;
    canvas.height = height;

    context.drawImage(img, 0, 0, width, height);

    img.src = canvas.toDataURL('image/png');
} 
```

我会发布 JSFiddle，但似乎他们的服务器已关闭。这是用法。

```
var image = document.getElementById('myImage');

resize(image, image.width * 0.75, image.height * 0.75); 
```

正如评论中所说，这在浏览器上对于更大的图像来说是密集的。

**注意：**您只能对本地托管的图像执行此操作。如果您尝试传入`src`来自不同域的图像，您将收到`SECURITY_ERR: DOM`.

# android - 在活动之间提供大量数据，寻找最佳解决方案

> ID：14086730
> 
> 赞同：0
> 
> 时间：2012-12-29T23:10:03.080
> 
> 标签：android, file, android-activity, large-data

我正在构建一个包含大量数据的应用程序，我需要一个好的解决方案来处理这个问题。我有一个代表数据集的类。它包含几个 ArrayList 和一些简单的数据类型。我想将 ArrayList 中的很多这些类保存到文件中。当我启动应用程序时，应该加载数据并且每个活动都应该使用这些数据。如何在我的不同活动之间共享这些数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:14:45.463

当您的第一个活动开始时，使用**AsyncTask**并从您的数据库或您放置在应用程序中的位置加载所有数据并将其设置为模型类。公开模型类以及所有变量和方法。以便应用程序的所有活动都可以使用该数据。例子在这里。

```
/* Calling a LoadDataBase() class extending AsyncTask 
* to run in background for creating or loading data base.
*/
new LoadDataBase().execute(); 
```

比将此 AsyncTask 类编码为：

```
// LoadDataBase class for background execution.
private class LoadDataBase extends AsyncTask<String, Void, String>{  
@Override
protected String doInBackground(String... arg0) {
    // DataBaseHelper class object.
    DataBaseHelperClass dbHelper = new DataBaseHelperClass(this);
    // Create database for the first time.
    try {
    dbHelper.createOrLoadDataBase();
} catch (IOException e) {
    e.printStackTrace();
}

    // Closing the database connection.
        dbHelper.close();
    return "";
}

@Override
protected void onPostExecute(String result) {
//Your code to set data loaded from database to model classes by using getter
    //setter methods.       
} // end onPostExecute(Void... values).
} // LoadDataBase. 
```

愿这对你有所帮助。

# javascript - ie9和opera的jquery对象问题

> ID：14086731
> 
> 赞同：3
> 
> 时间：2012-12-29T23:10:05.287
> 
> 标签：javascript, jquery, json, datejs

我一直在尝试让脚本在我的网站上运行，它适用于 Chrome、Safari 和 Firefox，但不适用于 IE 9（它将在兼容模式下运行）或 Opera。有没有我没有发现的问题？

这是脚本：

```
$(document).ready(function(){
$.getJSON('/storage/xml/biblereading2.json', function(data) {
today = Date.today();
var name = today.getDay();
var date = today.getDate();
var month = today.getMonth();
var year = today.getFullYear();
var fullday = name.toString();
var todaydoy = today.getDayOfYear();
var todaywoy = today.getWeekOfYear();
//array for months
fullmonth = new Array (12);
fullmonth[0] = "January";
fullmonth[1] = "February";
fullmonth[2] = "March";
fullmonth[3] = "April";
fullmonth[4] = "May";
fullmonth[5] = "June";
fullmonth[6] = "July";
fullmonth[7] = "August";
fullmonth[8] = "September";
fullmonth[9] = "October";
fullmonth[10] = "November";
fullmonth[11] = "December";
fullday = new Array (7);
fullday[0] = "Sunday";
fullday[1] = "Monday";
fullday[2] = "Tuesday";
fullday[3] = "Wednesday";
fullday[4] = "Thursday";
fullday[5] = "Friday";
fullday[6] = "Saturday";
var s = todaydoy - 1;
$("#biblereading").append('<p><span class="bold_font">Bible Reading for Today:</span>  </br>' + fullmonth[month] + ' ' + date + ', ' + year + '</br>' + data.schedule[s].portion.reading + '</br></p>');
});
}); 
```

我正在使用 date.js 来处理前几个变量中的日期问题，一个数组来给出拼写出来的月份和日期，并且我正在从同一服务器调用一个 json。

Opera 一直告诉我我在 data.schedule[s] 处有一个 TypeError

并且 IE 9 一直告诉我我在 data.schedule[s] 中有一个未定义或空值。

有任何想法吗？（您可以在首页上看到实施[http://rosemontbaptist.com](http://rosemontbpaptist.com/)的这种尝试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:27:27.143

如果你记录下今天是什么

```
var todaydoy = today.getDayOfYear(); 
```

你会看到它在 IE 中返回了错误的值，以下是从 IE9 控制台的监视窗口中复制的。

```
todaydoy    694324  Number 
```

您需要确定它们是否是您正在使用的日期库中的错误。

# html - 网页上的垂直文本

> ID：14086733
> 
> 赞同：4
> 
> 时间：2012-12-29T23:10:59.557
> 
> 标签：html, css, text-rotation

让我先说我知道这个问题已经被问了很多，但没有一个答案对我有用。

大多数解决方案都指示使用`transform:rotate(270deg);`，但是，这会与宽度混淆，因为块的生成方式不考虑旋转，从而使块比期望的更宽。

我的目标是获得如下内容（在表格中）：

![期望的结果](../Images/11f3beb0ad8d02ccd902b1368ba283c7.png)

我一直在玩各种不同的 CSS 属性，现在很幸运。这是我一直在使用[的一个基本沙箱，它展示了我遇到的一些问题。](http://jsfiddle.net/4qwgn/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T12:44:30.463

修改`th`如下：

```
<th>
    <div class="container">
        <div class="head">
            <div class="vert">Column 1</div>
        </div>
    </div>
</th>
<th>
    <div class="container">
        <div class="head">
            <div class="vert">Col 2</div>
        </div>
    </div>
</th>
<th>
    <div class="container">
        <div class="head">
            <div class="vert">Column Two</div>
        </div>
    </div>
</th> 
```

并添加小提琴中提供的 CSS，我希望你会得到想要的结果。

[小提琴](http://jsfiddle.net/4qwgn/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:01:36.350

JSFiddle 似乎已关闭，所以我看不到您的代码——但也许`transform-origin`除了`rotate`转换之外您还应该包括在内。这是我的意思的演示：http: [//jsbin.com/isinoh/2/edit](http://jsbin.com/isinoh/2/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T09:17:25.400

这里最困难的部分是将垂直文本与表格格式结合起来。参照。如何[使用 CSS 跨浏览器绘制垂直文本？](https://stackoverflow.com/questions/1080792/how-to-draw-vertical-text-with-css-cross-browser)似乎您可能需要在每个标题单元格中的两个级别上进行额外标记，因为您需要定位（为了将旋转的内容从单元格中取出，以便它们未旋转的尺寸不会弄乱表格格式）并且表格单元格不需要' t 定位时表现良好。

例子：

```
<!doctype html>
<style>
* { line-height: 1.3 }
table { border-collapse: collapse }
td, th
{
    border: 1px solid black;
    white-space: nowrap;
}
#title th
{
    width: 15px;
    height: 100px;
    vertical-align: bottom;
    font-weight: normal;
}
#title th > div {
   position: relative; 
}
#title th > div > div {
   position: absolute; 
   bottom: 0;
   -webkit-transform: rotate(-90deg);
   -ms-transform: rotate(-90deg);
   transform: rotate(-90deg);
   -webkit-transform-origin: 0 100%;
   -ms-transform-origin: 0 100%;
   transform-origin: 0 100%;
   left: 1.1em;
}
</style>
<table>
    <tr id="title">
        <th>&nbsp;</th>
        <th><div><div>Column 1</div></div></th>
        <th><div><div>Column 2</div></div></th>
        <th><div><div>Column 3</div></div></th>
    </tr>
    <tr>
        <td>Row 1</td>
        <td>...</td>
        <td>...</td>
        <td>...</td>
    </tr>
     <tr>
        <td>Row 2</td>
        <td>...</td>
        <td>...</td>
        <td>...</td>
    </tr>
    <tr>
        <td>Row 3</td>
        <td>...</td>
        <td>...</td>
        <td>...</td>
    </tr>
</table> 
```

在许多系统中，结果不会很漂亮，因为字体渲染问题导致旋转的文本不能很好地绘制（当您不编写正常的水平文本时，提示无济于事）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T23:12:57.537

您可以使用`canvas`可以手动呈现文本的元素。在这种情况下，您还必须手动调整元素的宽度和高度。

# bash - 将文件内容放在标准输入上而不发送 eof

> ID：14086738
> 
> 赞同：8
> 
> 时间：2012-12-29T23:12:23.973
> 
> 标签：bash

将文件内容放在标准输入上的典型方法如下：

```
./command.sh < myfile 
```

这会将 myfile 的所有内容放在 stdin 上，然后也发送 eof。我想将内容放在标准输入上而不添加 EOF。

对于各种交互程序，我希望以一系列命令开始程序，然后继续与程序交互。如果没有发送 eof，程序将等待更多输入，然后我可以交互输入。

这在bash中可能吗？我目前的解决方案是将内容扔到剪贴板上，然后粘贴它们。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T01:12:04.943

只需使用`cat`命令将文件与标准输入合并：

```
./command.sh < <(cat myfile -) 
```

或者

```
cat myfile - | ./command.sh 
```

### `cat`命令

`cat`代表*连接***：***_*** *_***

 **```
man cat
NAME
       cat - concatenate files and print on the standard output

SYNOPSIS
       cat [OPTION]... [FILE]...

DESCRIPTION
       Concatenate FILE(s), or standard input, to standard output.
... 
```

（请**阅读****精细**手册;-) **_** **_** _

 ****你可以写

```
cat file1 file2 file3 ... fileN 
```

也

```
cat file1 - file2

cat - file1

cat file1 - 
```

根据你的需要...

### 复杂示例，使用*heredoc*和*herestring*而不是文件

我用于`head -c -1`在*heredoc*中*删除*尾随*换行符*。command 确实**逐行**模拟任何命令处理：*`sed`*

 ***```
sed 's/.*/[&]/' < <(cat <(head -c -1 <<eof 
Here is some text, followed by an empty line

Then a string, on THIS line: 
eof
) - <<<'Hello world') 
```

应该输出：

```
[Here is some text, followed by an empty line]
[]
[Then a string, on THIS line: Hello world] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:32:15.247

另一种方法是使用另一个脚本来提供您的输入：

## `inputer.sh`：

```
cat $1
while read line; do
  echo $line
done 
```

## `Usage`：

```
sh inputer.sh input_file | sh your-script.sh 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T23:19:04.773

解决方案是使用[fifo](/questions/tagged/fifo "显示标记为“fifo”的问题")。

```
test -p /tmp/fifo || mkfifo /tmp/fifo

while true; do
    read line < /tmp/fifo
    echo "$line"
    [[ $line == break ]] && $line
done 
```

并喂食`fifo`：

```
echo foobar > /tmp/fifo 
```

停止“听”：

```
echo break > /tmp/fifo 
```

看`man mkfifo`*********

# java - 如何使用 InetSocketAdress 创建新的 MulticastSocket？我总是得到一个 BindException

> ID：14086740
> 
> 赞同：0
> 
> 时间：2012-12-29T23:12:46.280
> 
> 标签：java, windows, udp, bind, multicast

我正在创建一个需要通过多播和单播发送消息的应用程序。它适用于 Linux，但我很难让它适用于 Windows。

我一直得到一个 BindException，我在这段代码片段中隔离了这个问题：

```
import java.io.IOException;
import java.net.InetSocketAddress;
import java.net.MulticastSocket;

public class Test {
    public static void main(String[] args) {

        InetSocketAddress isa = new InetSocketAddress("239.255.0.113", 1234);
        try {
            MulticastSocket mcs = new MulticastSocket(isa);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

如果我运行这个程序，我会得到以下异常：

```
java.net.BindException: Cannot assign requested address: Cannot bind
    at java.net.TwoStacksPlainDatagramSocketImpl.bind0(Native Method)
    at java.net.AbstractPlainDatagramSocketImpl.bind(Unknown Source)
    at java.net.TwoStacksPlainDatagramSocketImpl.bind(Unknown Source)
    at java.net.DatagramSocket.bind(Unknown Source)
    at java.net.MulticastSocket.<init>(Unknown Source)
    at Test.main(Test.java:10) 
```

错误发生在 MulticastSocket 构造函数中。我不知道如何让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-09T15:07:08.897

可能有点晚了，但对于其他搜索网络的人来说：
您必须调用接受端口号的构造函数，然后加入组（组是 InetAddress）。

```
public class Test {
    public static void main(String[] args) {

        InetAddress ia = new InetAddress.getByName("239.255.0.113");
        try {
            MulticastSocket mcs = new MulticastSocket(1234);
            mcs.joinGroup(ia);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

完成后别忘了打电话`mcs.leaveGroup(ia)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T01:31:51.667

绑定到多播地址在 Windows 上不起作用。绑定到 null，这意味着 INADDR_ANY。

# java - 测试 android:text 会产生不同的结果，具体取决于它是否已被修改

> ID：14086742
> 
> 赞同：0
> 
> 时间：2012-12-29T23:13:05.723
> 
> 标签：java, android, gettext

我在我的代码上遇到了这个问题，我不知道为什么。基本上我在 XML 上将 android:text 设置为“0”，当使用 getText 检查它是否为“0”时，它返回 false。如果我使用 setText 将其设置为 0 并再次检查它会返回 true。

```
 <TextView android:id="@+id/edit_text"
        android:text="0" />

    TextView calc = (TextView) findViewById(R.id.edit_text);
    return( calc.getText() == "0" ); // false
    ----
    calc.setText( "0" );
    return( calc.getText() == "0" ); // true 
```

为什么会这样？如何检查 calc.getText() 是否为 0？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:14:59.177

您永远不会将 Objects (`String`是 的子类的`CharSequence`子类`Object`，我建议使用它们而不是`CharSequence`) 与`==`进行比较，因为它比较的是引用，而不是实际的 Object 内容。所有对象都有一个`equals()`方法，但字符串肯定会自定义它（覆盖）以实现检查要比较的字符串是否相同。

而是做`calc.getText().toString().equals ("0");`

因此，就它发生的原因而言 - Android 创建一个对象，然后当您指定“0”时，您创建另一个对象。使用`equals()`解决了这个问题，因为它首先检查内容然后给出结果（真/假）。

# java - Java 在窗口边界下绘制图形

> ID：14086745
> 
> 赞同：0
> 
> 时间：2012-12-29T23:13:25.310
> 
> 标签：java, swing, jframe

我正在尝试编写一个简单的 Java Applet/Application，它将根据它的大小调整自身的大小。我基本上可以正常工作，除非我在 JFrame grpahics (jframe.getGraphics()) 上绘制一些东西，在点 0,0，它似乎从窗口边界外的左上角开始。在窗口的顶栏下方有前 30 个左右的像素。jframe.getWidth() 和 jframe.getHeight() 也返回给我窗口的宽度和高度，而不是窗口内的可见部分。

这是我正在使用的代码的摘录，它演示了我的问题：

```
import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.image.BufferedImage;

public class ImageHandler {
    private boolean debug;
    private int rememberWidth, rememberHeight, contractedImageX,
            contractedImageY, imageTranslationX, imageTranslationY, realWidth,
            realHeight, fixedWidth, fixedHeight;
    private BufferedImage bImage1, bImage2;
    private Graphics2D bufferedGraphics1, bufferedGraphics2;
    private boolean resizeNext, isApplet;

    public ImageHandler(ObjectHandler objH) {
        debug = objH.isDebug();
        objH.setImageHandler(this);
        objectHandler = objH;
        isApplet = objectHandler.isApplet();
        fixedWidth = objectHandler.getScreenWidth();
        fixedHeight = objectHandler.getScreenHeight();
    }

    public void paint(Paintable p) {
        /*
         * If the screen is not the same size at remembered, then re-run the
         * image transformations
         */
        realWidth = getRealWidth();
        realHeight = getRealHeight();
        if (objectHandler.isFocused() == true
                || objectHandler.isApplet() == true) {
            if (!(rememberWidth == realWidth && rememberHeight == realHeight)
                    || resizeNext) {
                resizeNext = false;
                if (debug)
                    System.out.println("Re-sizing");
                /* Create New Images */
                bImage1 = new BufferedImage(realWidth, realHeight,
                        BufferedImage.TYPE_INT_ARGB);
                bImage2 = new BufferedImage(fixedWidth, fixedHeight,
                        BufferedImage.TYPE_INT_ARGB);
                bufferedGraphics1 = (Graphics2D) bImage1.getGraphics();
                bufferedGraphics1.setColor(Color.black);
                bufferedGraphics1.fillRect(0, 0, realWidth, realHeight);
                bufferedGraphics2 = (Graphics2D) bImage2.getGraphics();
                /*
                 * Remember The current Height and width, so that it can check
                 * if the height has changed before running this again
                 */
                rememberWidth = realWidth;
                rememberHeight = realHeight;
                /*
                 * Define contractedImageX and y depending on the height of the
                 * screen
                 */
                contractedImageY = realHeight;
                contractedImageX = (int) ((double) contractedImageY
                        / (double) fixedHeight * fixedWidth);
                /*
                 * If the graphics defined by using the height make it go off
                 * the sides of the screen, redefine with the width
                 */
                if (debug) {
                    System.out.println("1Real Height:" + realHeight + " Width:"
                            + realWidth + " contractedHeight:"
                            + contractedImageY + " contractedWidth:"
                            + contractedImageX);
                }
                if (contractedImageX > realWidth) {
                    contractedImageX = realWidth;
                    contractedImageY = (int) ((double) contractedImageX
                            / (double) fixedWidth * fixedHeight);
                }
                if (debug) {
                    System.out.println("2Real Height:" + realHeight + " Width:"
                            + realWidth + " contractedHeight:"
                            + contractedImageY + " contractedWidth:"
                            + contractedImageX);
                }
                /*
                 * Re Calculate Image Translations so that they position the
                 * image correctly
                 */
                imageTranslationX = (realWidth - contractedImageX) / 2;
                imageTranslationY = (realHeight - contractedImageY) / 2;
                if (debug) {
                    System.out.println("X: " + imageTranslationX + " Y: "
                            + imageTranslationY);
                }

            }
            // clears the screen
            bufferedGraphics2.setColor(Color.black);
            bufferedGraphics2.fillRect(0, 0, fixedWidth, fixedHeight);
            p.paint(bufferedGraphics2);
            bufferedGraphics1.setColor(Color.black);
            bufferedGraphics1.fillRect(0, 0, realWidth, realHeight);
            bufferedGraphics1.drawImage(bImage2, imageTranslationX,
                    imageTranslationY, contractedImageX + imageTranslationX,
                    contractedImageY + imageTranslationY, 0, 0, fixedWidth,
                    fixedHeight, null);
            drawFinalImage(bImage1);
        }
    }

    private void drawFinalImage(Image img) {
        if (isApplet) {
            if (objectHandler.getjApplet() != null) {
                objectHandler.getjApplet().getGraphics()
                        .drawImage(img, 0, 0, null);
            }
        } else {
            if (objectHandler.getjFrame() != null) {
                objectHandler.getjFrame().getGraphics()
                        .drawImage(img, 0, 0, null);
            }
        }
    }

    private int getRealWidth() {
        if (objectHandler.isApplet()) {
            if (objectHandler.getjApplet() != null) {
                Integer w = objectHandler.getjApplet().getWidth();
                if (w != null && w > 0) {
                    return w;
                }
            }
        } else {
            if (objectHandler.getjFrame() != null) {
                Integer w = objectHandler.getjFrame().getWidth();
                if (w != null && w > 0) {
                    return w;
                }
            }
        }
        return fixedWidth;
    }

    private int getRealHeight() {
        if (objectHandler.isApplet()) {
            if (objectHandler.getjApplet() != null) {
                Integer h = objectHandler.getjApplet().getHeight();
                if (h != null && h > 0) {
                    return h;
                }
            }
        } else {
            if (objectHandler.getjFrame() != null) {
                Integer h = objectHandler.getjFrame().getHeight();
                if (h != null && h > 0) {
                    return h;
                }
            }
        }
        return fixedHeight;
    }
} 
```

该代码不是我的整个程序，只是调整窗口大小和绘制图形的部分。Paintable 是我创建的具有方法paint(Graphcis g) 的接口。

我正在寻找一种方法来查找可见部分的宽度和高度，以及我需要在可见部分的左上角找到点的偏移量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:19:01.527

您必须添加自定义 JPanel 并覆盖 getPreferredSize，因为 JFrame 会考虑装饰（标题栏等）。

```
private class MyPan extends JPanel {
    public Dimension getPreferredSize() { return new Dimension(600, 600); }
    public void paintComponent(Graphics g) { /* do stuff */ }
} 
```

然后只需将面板添加到框架和 pack(); 框架。

# php - 使用 jQuery/Ajax 和 PHP 显示当前进度

> ID：14086747
> 
> 赞同：3
> 
> 时间：2012-12-29T23:14:07.557
> 
> 标签：php, javascript, jquery, ajax

**简短而甜蜜：** 寻找一种调用 PHP 文件并使用 jQuery 和/或 Ajax 显示进度的方法。调用 PHP 文件 upgrade.php?step=1，然后将返回的输出附加到 #upgradestatus。完成后，将调用 upgrade.php?step=2 并附加该输出，直到完成指定数量的步骤。

**说明：** 我正在尝试为在 PHP 中运行的软件创建一个插件。这个插件将通过 PHP 文件调用每个步骤来升级每个文件等。我希望能够在页面上显示进度而无需重新加载它以向用户显示已完成的操作以及进程所在的位置。

使用我的 PHP 思维过程，我想创建类似的东西：

```
for (var s=0; s<2; s++){
    $('#upgraderesult').load('upgrade.php', 'step=' + s, function() {
        $('#upgradestatus').append('Upgrade Step ' + s + ' Completed');
    });
} 
```

我也尝试使用 .ajax() ，并且通过这两种方法，我很快就了解到，作为异步，这将变得更加棘手。

我背后的想法是创建一个 FOR 循环，该循环将循环存在的步骤数量。然后，for 循环将生成必要的 jQuery/Ajax 代码，这些代码将使用状态消息附加到现有的 div #upgradestatus。我希望它附加在#upgraderesult 中加载的结果，但为了简单起见，我只是添加了“升级步骤 X 完成”。

所以现在我被卡住了，我想我可能只需要使用 PHP 来生成正确的 jQuery/Ajax 代码，但我想检查一下是否有其他人对如何以不同的方式完成此操作有任何意见或建议，或者即使我在想这完全错了。

我想要的只是能够根据流程中的步骤调用 PHP 文件，然后在浏览器中向用户显示进度……这比我想象的要困难得多。

感谢您的任何意见或建议/建议，我非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T00:07:02.807

每个人都感谢您的意见，在 Freenode #jQuery 中的一些人的帮助下，我们能够想出这个完美的方法：

```
var numSteps = 2;
function loadStepAjax(s) {
    $.ajax('upgrade.php', {
        type: 'GET',
        dataType: 'html',
        data: {
           step: s
        },
        success: function(data) {
            $('#upgradestatus').append(data);
            if (s < numSteps)
                loadStepAjax(s+1);
            }
     });
} 
```

然后调用该函数：

```
loadStepAjax(1); 
```

我们没有使用 FOR 循环，而是创建了一个函数 loadStepAjax，然后在回调中使用 IF 语句来确定是否再次调用该函数。

总是很简单不是吗！不过还是感谢大家的意见，不胜感激。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:31:00.577

您可以设置回调以在使用 ajax() 时运行，（post() 会是更好的选择）。你试过吗？当你尝试 ajax() 时，你还有代码吗？

它应该是这样的。

```
$.post('upgrade.php?step=1', function() {
    $('#upgradestatus').append('Upgrade Step 1 Completed');
    $.post('upgrade.php?step=2', function() {
        $('#upgradestatus').append('Upgrade Step 2 Completed');
        $.post('upgrade.php?step=2', function() {
                $('#upgradestatus').append('All done!'); }
    }
}); 
```

当然，您也可以返回 JSON 并说是的，一切正常或其他，但关键是您正在使用回调等待它完成调用下一步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T23:38:57.773

这个问题还有另一种方法。

我写了一个全面的例子来回答这个问题：

[在没有浏览器超时的情况下在 PHP 中处理大量数据](https://stackoverflow.com/questions/5533076/processing-large-amounts-of-data-in-php-without-a-browser-timeout/5533200#5533200)

PS：我的示例可以扩展为也可以在每个进度上传递消息 - 事实上，它非常灵活；您可以根据服务器上发生的任何情况仅更新您想要的 UI 的一部分，从而使客户端免于不必要的处理。

# jquery - 复选框总是返回检查它们是否是

> ID：14086748
> 
> 赞同：2
> 
> 时间：2012-12-29T23:14:09.637
> 
> 标签：jquery

的HTML：

```
<div id="appcheck">
  <input class="precheck" type="checkbox" /> 
  <input class="precheck" type="checkbox" />
  <input class="precheck" type="checkbox" />
</div> 
```

应该发现未经检查的结果的 jQuery。`not checked`无论选中多少个框，总是返回 3 。

```
$('input.precheck').each(function() {
  if($(this).not(':checked')) {
    console.log('not checked');
  }
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:15:33.353

您可以使用 `is`+ 否定运算符而不是`not`. `not`不返回布尔值；它返回一个 jQuery 对象，并且您的 if 语句始终为真。

```
if (!$(this).is(':checked')) { 
```

或者：

```
if (!this.checked) { 
```

您还可以编码：

```
var notChecked = $('input.precheck').filter(function(){
   return !this.checked;
}).length; 
```

# c++ - 如何强制 SetWindowPos 生成 WM_SIZE 消息

> ID：14086750
> 
> 赞同：2
> 
> 时间：2012-12-29T23:14:24.470
> 
> 标签：c++, c, winapi

我发现`SetWindowPos(...hwnd...)`如果新大小与以前相同，该函数将不会生成 WM_SIZE 消息。但有时即使大小没有改变，我也需要 SetWindowPos 来生成 WM_SIZE 消息。虽然我可以使用`SendMessage(hwnd, WM_SIZE...)`after `SetWindowPos`，但这是一个糟糕的解决方案，因为它可能会生成 WM_SIZE 两次。

所以，

`Is any flag for SetWindowPos or any similar functions so a WM_SIZE message is always generated?`

ps：

我有一个主窗口hwndMain、一个子窗口hwndChild和一个hwndChild的子窗口hwndChild2。当 hwndMain 调整大小时，它接收 WM_SIZE，并且有一个 MainOnSize(...) 函数调整 hwndChild 的大小。同样，如果调整 hwndChild 的大小，它会收到 WM_SIZE，并且有一个 ChildOnSize(...) 函数可以调整 hwndChild2 的大小。

但是情况是这样的：在创建了hwndMain和hwndChild之后，而不是hwndChild2，hwndMain收到了WM_SIZE，所以hwndMain和hwndChild被resize了。现在 hwndChild2 被创建后，hwndMain 仍然会收到一个 WM_SIZE（见备注），所以它调用 MainOnSize 来调整 hwndChild 的大小。但是 hwndChild 的大小没有改变，所以它不会生成 WM_SIZE，也不会调用 ChildOnsize()，因此 hwndChild2 没有调整大小。

评论：

hwndMain 第一次收到 WM_SIZE 是在创建时，第二次是在使用 ShowWindow(...) 显示时。

# python-2.7 - 创建具有不同变量的函数

> ID：14086759
> 
> 赞同：1
> 
> 时间：2012-12-29T23:15:19.973
> 
> 标签：python-2.7

我有一个不同的名称列表，例如木工、工程总共 15 个。在下面的代码中，我将其命名为 name1，但是变量名没有顺序。与其将这段代码写出 15 次，我如何创建一个函数，在每次更改名称的同时为每个条件执行相同的条件。

```
name1= int(raw_input("Please enter your value for name1: "))
if name1 <5:
status = "nill"
total = 0
if name1 >4 and name1 <8:
status = "valid"
total=1
if name1 >7 and name1 <12:
status = "superb"
total=5
if name1 >11:
status = "over qualified"
total=10
print "this is your current status ",status 
print "this equals ",total 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:05:47.530

我相信这可以满足您的需求。请注意，这可能不是您想要存储各个状态的方式（a`defaultdict`可能更有意义），但希望从概念的角度来看这是有意义的：

```
def comparisons(value):
    """Only change here is using x <= y < z syntax."""
    if value < 5:
        status = 'nill'
        total = 0
    elif 5 <= value < 8:
        status = 'valid'
        total = 1
    elif 8 <= value < 12:
        status = 'superb'
        total = 5
    else:
        status = 'over-qualified'
        total = 10
    # Here we return the status and the total for each item
    # This may not be what you want, so this can be adjusted
    return status, total

# Create a list that will contain your 15 items
items = ['Engineering', 'Carpentry']

# Create a container to hold the results.
# Note that we don't use different variables names each time -
# instead, we create an entry in a dictionary corresponding to
# our 'items' values.
results = {}

# Now we iterate through each item in our items list, running
# our function and storing the results. Note that this is a guess
# as to how you want to handle 'status' - a more useful solution
# could be to use a nested dictionary where each item has a dictionary
# with two sub-fields: 'status' and 'total'.
for item in items:
    status, total = comparisons(int(raw_input('{0}: '.format(item))))
    results[item] = [status, total]

# Print out each item
print '\nIndividual items:'
for item, values in results.iteritems():
    print item, values

# Example of how you could sum the totals
print '\nTotal score:'
print sum((results[x][1] for x in results)) 
```

输出：

```
Engineering: 10
Carpentry: 5

Individual items:
Engineering ['superb', 5]
Carpentry ['valid', 1]

Total scores:
6 
```

# ios - 来自其他用户的 iOS SoundCloud 流

> ID：14086762
> 
> 赞同：1
> 
> 时间：2012-12-29T23:15:39.270
> 
> 标签：ios, ios6, soundcloud

根据我在这些页面上看到的内容：

[http://developers.soundcloud.com/docs/api/ios-quickstart#](http://developers.soundcloud.com/docs/api/ios-quickstart#)

..https://github.com/soundcloud/CocoaSoundCloudAPI

它们仅描述了从自己的用户帐户流式传输音频的方法。

我正在构建一个应用程序，它将接收来自网站的请求并从中提取 soundcloud 链接，并且这些链接不是来自我自己的帐户。有没有办法只给一个链接就从随机用户那里流式传输？

此外，当从网站上的 JSON API 提取数据时，这是我收到的字符串

> [http://w.soundcloud.com//player//?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F53179275&show_artwork=true&auto_play=true](http://w.soundcloud.com//player//?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F53179275&show_artwork=true&auto_play=true) \

这是歌曲嵌入代码的结果。我是否必须对 URL 执行任何操作才能将其转换为不同的格式？

而且....有没有办法让波形也显示出来？

我正在为 ios6 开发并且在 xcode 4.5.2 上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T21:23:38.950

我想通了大部分。

我将使用的 Souncloud API 的唯一部分是在他们的网站上注册，为了获取实际的流链接，我输入了这个字符串，其中包含我的客户端 ID 和我从给定链接中提取的轨道 ID 的两个输入变量我的连接请求：

https://api.soundcloud.com/tracks/[track_id]@.json?client_id=[client_id]

这个json也有Waveform，我相信我将不得不手动实现播放器。

有谁知道一个好的流媒体播放器可以使用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-14T10:25:14.790

我将其用于特定用户。

```
http://api.soundcloud.com/users/[userid]/tracks.json?client_id=[client_id]&offset=20&limit=20 
```

对于菜单：

```
i.add(new NavItem("MENU TITLE", R.drawable.ic_details, NavItem.ITEM, SoundCloudFragment.class,
           new String[]{"USERID"})); 
```

# servicestack - ServiceStack CRUD 服务路由文档

> ID：14086763
> 
> 赞同：2
> 
> 时间：2012-12-29T23:15:49.053
> 
> 标签：servicestack

我找不到解释如何使用多种方法在服务堆栈中实现服务的文档（清除或其他）。所有示例都显示了仅具有一种方法的服务类。我无法想象如果您有一个具有 4+ 方法的服务，那么您真的需要创建 4+ 服务类、4+ 请求 DTO 和 4+ 响应 DTO。（[如图所示](https://github.com/ServiceStack/ServiceStack/wiki/New-Api)）

例子：

具有 4 种搜索方法的服务（method(Identifer1)、method2(identifer2)、method3(identifer3)）

基于请求 DTO（[服务堆栈 Wiki](https://github.com/ServiceStack/ServiceStack/wiki/Metadata-page)和[创建您的第一个 Web 服务](https://github.com/ServiceStack/ServiceStack/wiki/Create-your-first-webservice)）的文档结构，请求 DTO 的类属性，控制到服务类的路由，（如果我理解正确，但我再次在寻找文档或一个例子）

[关于路由的文档有点模糊，因为大多数示例不遵循“您的第一个 Web 服务说明](https://github.com/ServiceStack/ServiceStack/wiki/Your-first-webservice-explained)”中为请求/响应 DTo 定义的命名约定

我也读过这篇[SO Post](https://stackoverflow.com/questions/12612465/servicestack-is-there-an-up-to-date-complete-documentation)，但是在听从了建议之后，我仍然有同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:17:25.833

> 我无法想象如果您有一个具有 4+ 方法的服务，那么您真的需要创建 4+ 服务类、4+ 请求 DTO 和 4+ 响应 DTO。

不，您需要 1 个具有 4 种方法的服务类 - 每个方法当然需要一个请求 Dto 并返回一个响应 Dto。显然，对于某些方法，您可能不需要响应 Dto

例如，具有 5 种方法的典型服务可能如下所示：

```
public class ProductsService: Service
{
    [Route("/products")]
    public class GetProductsRequest: IReturn<List<ProductResponse>> {}

    public class ProductResponse
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    public object Get(GetProductsRequest request)
    {
        IEnumerable<ProductResponse> response = ...
        return response;
    }

    [Route("/products/{id}")]
    public class GetProductRequest: IReturn<ProductResponse> 
    {
        public int Id { get; set; }
    }

    public object Get(GetProductRequest request)
    {
        ProductResponse response = ...
        return response;
    }

    [Route("/products")]
    public class CreateProductRequest 
    {
        public string Name { get; set; }
    }

    public object Put(CreateProductRequest request)
    {
        ... create the product here
        return new HttpResult { StatusCode = HttpStatusCode.Created };
    }

    [Route("/products/{id}")]
    public class UpdateProductRequest
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    public object Patch(UpdateProductRequest request)
    {
        ... update the product here
        return new HttpResult { StatusCode = HttpStatusCode.Accepted };
    }

    [Route("/products/{id}")]
    public class DeleteProductRequest
    {
        public int Id { get; set; }
    }

    public object Delete(DeleteProductRequest request)
    {
        ... delete the product here
        return new HttpResult { StatusCode = HttpStatusCode.Accepted };
    }
} 
```

我已将请求和响应 DTO 作为嵌套类放入服务中，但将它们放在单独的文件中会更易读：

```
public class ProductsService: Service
{
    public object Get(GetProductsRequest request)
    {
        IEnumerable<ProductResponse> response = ...
        return response;
    }

    public object Get(GetProductRequest request)
    {
        ProductResponse response = ...
        return response;
    }

    public object Put(CreateProductRequest request)
    {
        ... create the product here
        return new HttpResult { StatusCode = HttpStatusCode.Created };
    }

    public object Patch(UpdateProductRequest request)
    {
        ... update the product here
        return new HttpResult { StatusCode = HttpStatusCode.Accepted };
    }

    public object Delete(DeleteProductRequest request)
    {
        ... delete the product here
        return new HttpResult { StatusCode = HttpStatusCode.Accepted };
    }
} 
```

# html - 将父页面链接链接到 iframe 中的锚点

> ID：14086767
> 
> 赞同：3
> 
> 时间：2012-12-29T23:16:16.120
> 
> 标签：html, iframe, anchor

我一直在搜索和搜索，但我对此感到非常困惑：我有一个 index.html 页面，其中有几个 iframe 以 100% 的宽度和高度堆叠在一起。该索引具有固定导航，其中 z-index 覆盖帧。我的索引基本上被javascript禁用了滚动。

因此，我试图将导航（位于索引页面上）链接到其中一个 iframe 中的特定锚点，该锚点将加载到该 iframe 中。我显然已经收集到这说起来容易做起来难。为什么我`<a href="iframe-src.html#anchor" target="iframe">`不知道为什么不起作用，但显然它没有。

这有什么解决方法？这是我的索引的基本设置方式：

```
 <html>
    <head>

    ** some CSS and Javascript here that I know's irrelevant. **

    <script type="text/javascript">
        document.documentElement.style.overflow = 'hidden';  // firefox, chrome
        document.body.scroll = "no";    // ie only
        document.documentElement.style.overflowX = 'hidden';     // horizontal scrollbar will be hidden
        document.documentElement.style.overflowY = 'hidden';     // vertical scrollbar will be hidden
    </script>
</head>
<body>
<iframe src="landing.html" name="landing" style="position: relative; width: 100%; height: 100%; border: 0;"></iframe>   
<iframe src="work1.html" name="work-iframe" style="position: relative; width: 100%; height: 100%; z-index: 1;"></iframe>
<iframe src="info.html" name="info" style="position: relative; width: 100%; height: 100%; z-index: 4;"></iframe>

<nav>   
    <a href="work.html#parker" target="work-iframe">PARKER BROTHERS CLASSICS</a>

    <a href="work.html#bohs" target="work-iframe">BOHS & HONS</a>

    <a href="work.html#companion" target="work-iframe">THE COMPANION SERIES</a>

    <a href="work.html#balmer" target="work-iframe">BALMER</a>

    <a href="work.html#hoeweler" target="work-iframe">MICHAEL HOEWELER</a>

    <a href="work.html#ampugreen" target="work-iframe">AMPUGREEN</a>

    <a href="work.html#occasional" target="work-iframe">OCCASIONAL SYMPHONY</a>

    <a href="work.html#type" target="work-iframe">TYPE & LOGOS</a>

    <a href="work.html#nextwave" target="work-iframe">NEXT WAVE FESTIVAL</a>

    <a href="work.html#illustration" target="work-iframe">ILLUSTRATIONS</a>

    <a href="work.html#stationnorth" target="work-iframe">STATION NORTH</a>
</nav> 
```

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-16T02:44:57.213

由于您使用的是纯 JavaScript 而没有库，因此我将解释如何去做而不是使用代码（因为它只是众多解决方案中的一种）。

您可能希望将您的 JS 移至 window.load 函数，除非您总是希望您的网站访问者使用 JavaScript。

隐藏除一个以外的所有 iframe（第一个？无论您选择什么作为默认 iframe）。

将事件处理程序（可能是 onclick）添加到您的导航超链接以执行一些操作：1\. 切换与特定导航项相关的可见性（并隐藏当前可见）iframe，如有必要（取决于单击了哪个） 2\. 检测使用（伪代码）iframe.ELEMENT.offsetTop 从 iframe 的特定锚点偏移到 iframe 页面的顶部，以便使用... 3\. ... iframe.ELEMENT.scrollTo(value_determined_in_step_2)

我*相信*这将适用于您所描述的特定用例。

# java - spring mvc rest端点可以映射到/users.json和/users.xml等2个不同的url吗？

> ID：14086768
> 
> 赞同：1
> 
> 时间：2012-12-29T23:16:25.167
> 
> 标签：java, spring, rest, spring-mvc

我正在创建一个 java rest endpoing，并使用 Ruby 使用它。

在 ruby​​/rails 世界中，使用 Active Resource，url 可以是：

```
/users.json 
```

或者

```
/users.xml 
```

目前我的控制器方法如下所示：

```
@ResponseBody
@RequestMapping(value = "/users.json", method = RequestMethod.GET)
public String list(HttpServletRequest request, HttpServletResponse response) {

} 
```

我不想复制此方法以映射到带有 .xml 扩展名的 url。

**我可以以某种方式同时处理两个网址吗？**

我还必须将内容类型设置为 json 或 xml。

我知道另一种方法是让spring查看请求标头，然后返回json或xml，但我似乎模仿rails的工作方式我需要users.json或users.xml（基于url结构为反对请求头）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:41:18.583

使用 @ResponseBody 时，您将绕过 ContentNegotiatingViewResolver。

让您的 url 为 /users 而不是 /users.json 或 /users.xml 并将您在 requestheaders 中的 Accept 标头设置为所需的媒体类型，框架将选择适当的消息转换器并为您完成工作。注意：messageconverter 应该存在于您的类路径中。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T06:08:21.260

是的，这可以通过 Spring 的`ContentNegotiatingViewResolver`. 请参阅此操作方法博客文章：[http ://www.mkyong.com/spring-mvc/spring-3-mvc-contentnegotiatingviewresolver-example/](http://www.mkyong.com/spring-mvc/spring-3-mvc-contentnegotiatingviewresolver-example/)

# objective-c - 从数组中选择最近的 NSNumber

> ID：14086770
> 
> 赞同：1
> 
> 时间：2012-12-29T23:16:47.503
> 
> 标签：objective-c, nsarray, nsnumber

我有一个带有一堆`NSNumber`s 的数组。当用户停止拖动它时，`UISlider`我会得到一个特定的值。我想从数组中获取关闭号码。

因此，例如，如果用户拖动`UISlider`to `13`，并且`NSArray`包含`NSNumbers`with`10`和`15`; 我想`15`从数组中获取。

数组示例：

```
NSArray *values = [NSArray arrayWithObjects:[NSNumber numberWithInt:15],
                    [NSNumber numberWithInt:20],
                    [NSNumber numberWithInt:30],
                    [NSNumber numberWithInt:45],
                    [NSNumber numberWithInt:60],
                    [NSNumber numberWithInt:90],
                    [NSNumber numberWithInt:110], nil]; 
```

如何从数组中获取正确的数字？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T23:42:12.663

在您的帖子中，数组已排序。如果它总是排序，你可以使用二分搜索。 `NSArray`有一个方便的方法：

```
CGFloat targetNumber = mySlider.value;
NSUInteger index = [values indexOfObject:@(targetNumber)
    inSortedRange:NSMakeRange(0, values.count)
    options:NSBinarySearchingFirstEqual | NSBinarySearchingInsertionIndex
    usingComparator:^(id a, id b) {
        return [a compare:b];
    }]; 
```

现在有四种可能：

1.  的每个元素`values`都大于`targetNumber`:`index`为零。
2.  的每个元素`values`都小于`targetNumber`:`index`是`values.count`。
3.  `values`contains `targetNumber`:`index`是`targetNumber`in的索引`values`。
4.  `index``values`是大于的最小元素的索引`targetNumber`。

我已经按照我们处理它们的顺序巧妙地列出了这些案例。这是案例1：

```
if (index == 0) {
    return [values[0] floatValue];
} 
```

这是案例2：

```
if (index == values.count) {
    return [[values lastObject] floatValue];
} 
```

我们可以一起处理案例 3 和案例 4：

```
CGFloat leftDifference = targetNumber - [values[index - 1] floatValue];
CGFloat rightDifference = [values[index] floatValue] - targetNumber;
if (leftDifference < rightDifference) {
    --index;
}
return [values[index] floatValue]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:23:07.553

如果您的`values`数组是有序的，并且您总是希望该值大于（或等于）输入的值，您可以执行以下操作：

```
NSInteger count = 0;
do {
    count++;
} while (enteredNum > [values[count] intValue]);

// Do something with [values[count] intValue] 
```

# ios6 - 在 UICollectionViewCell 中显示文本

> ID：14086771
> 
> 赞同：1
> 
> 时间：2012-12-29T23:16:57.393
> 
> 标签：ios6, uicollectionviewcell

我目前已经实现了一个带有 UICollectionViewCell 的 UICollectionView，它在单击时会完成一个 segue。但是，我想在 UICollectionViewCell 中显示文本。

我想知道最简单的方法是在 UICollectionViewCell 中仅显示文本并允许在按下文本时发生转场（而不是从空白的 UICollectionViewCell 运行转场）。我曾尝试在 UICollectionViewCell 中使用 TextView，但是当按下 TextView 时，我无法让 segue 运行。

任何意见，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:23:39.480

添加带有文本的按钮。

或者添加一个`UITextView`并使用执行 segue 的操作向它添加一个轻击手势识别器。

# eclipse - Zend Studio 9：远程服务器和点文件夹

> ID：14086773
> 
> 赞同：0
> 
> 时间：2012-12-29T23:17:33.010
> 
> 标签：eclipse, file, zend-framework, hidden, zend-studio

看起来 Zend Studio 9“远程服务器支持”工具只是忽略了以点开头的文件夹。而且我还没有发现我可以改变这种行为。

* * *

**例子：**

1.  假设我们在本地 Win7 x64 机器上有以下文件集：

    ```
    a/
     b/
      b_file1
      .c1/
         c_file1 
    ```

2.  从现有目录创建一个“PHP 项目”（目录 =“a”）

3.  设置连接（在项目属性 -> 远程服务器支持中）

4.  同意上传数据到服务器。

**结果：**

*   b_file1 上传成功。
*   c_file1 和 .c1 丢失。
*   此外（奖励）：如果创建 a/b/.c2 文件夹，它将被上传，但 a/b/.c2/c2_file 不会。

**问题：**

我如何也上传 c_file 和 .c1 文件夹？

PS：

以防我的描述不够准确，[这里是](http://www.youtube.com/watch?v=lT1TH2VQS1g)3.5 分钟长的屏幕视频（与上面的“示例”完全相同）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T02:16:11.987

不管“远程服务器支持”如何，我还是找到了几种同步此文件夹的方法

1.  [这是](http://kb.zend.com/index.php?View=entry&EntryID=414)Zend 的官方文章，关于如何使用 rsync 执行此操作

2.  [这是](http://i3vi3v.wordpress.com/2013/01/09/zend-studio-syncing-files-with-remote-server-using-unison/)一个关于如何使用另一个更高级的外部工具的教程 - unison，它也可以“集成”。

# php - 在 sql 函数后和重定向后回显消息？

> ID：14086779
> 
> 赞同：2
> 
> 时间：2012-12-29T23:18:20.563
> 
> 标签：php, mysql

我正在使用这个 sql 函数向收藏夹添加和删除用户，如果用户单击另一个用户配置文件上的添加到收藏夹按钮，那么它将链接到 favourite.php 并运行以下脚本。

我想要做的是，在 sql 运行然后重定向回用户个人资料页面之后，我想在该个人资料页面上回显一条消息，说明用户已添加到收藏夹（如果收藏夹已插入db）或用户已从收藏夹中删除（其中用户已从 db 的收藏夹中删除）。

代码：

```
 <?php

    require_once('includes/session.php');
    require_once('includes/functions.php');
    require('includes/_config/connection.php');

    session_start();

        confirm_logged_in();

        if (isset ($_GET['to'])) {
        $user_to_id = $_GET['to'];

    }

    if (!isset($_GET['to']))
        exit('No user specified.');

    $user_id = $_GET['to'];

    mysql_query("INSERT INTO ptb_favorites (user_id, favorite_id) VALUES (".$_SESSION['user_id'].", ".$user_to_id.")") 

    or mysql_query("DELETE FROM ptb_favorites WHERE user_id = ".$_SESSION['user_id']." AND favorite_id = ".$user_to_id.""); header("Location: {$_SERVER['HTTP_REFERER']}");

    #Method to go to previous page

    function goback()

    {
        header("Location: {$_SERVER['HTTP_REFERER']}fav=1");
        exit;
    }
    goback();

?> 
```

我已经尝试在重定向上添加扩展 fav=1 以回显消息，并在配置文件页面中放置了 $_GET 代码以在用户返回页面时显示错误：

```
<?
if (isset($_GET['fav']) && $_GET['fav'] == 1) {
            $message = "<div class=\"infobox-profile\"><strong>Added to Favourites.</strong>This user has been added to your favourites.</div>";
            echo "<a href=\"#\"><div class=\"infobox-close3\"></div></a>";

}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:22:41.310

使用该`$_SESSION`对象跨请求传递消息：

```
function goback()
{
    $_SESSION['flashmessage'] = "Some message";
    header("Location: {$_SERVER['HTTP_REFERER']}fav=1");
    exit;
} 
```

然后，在您的其他脚本中，只需检查该变量。

```
session_start();

if (isset($_SESSION['flashmessage'])) {
    echo $_SESSION['flashmessage'];

    unset($_SESSION['flashmessage']);
} 
```

**注意**：您不应该依赖`$_SERVER['HTTP_REFERER']`返回值。我不确定您如何管理您的应用程序，但成功应该转到成功页面，除非您明确设置转发 URL。只是说。

# python - python, 继承, super() 方法

> ID：14086782
> 
> 赞同：3
> 
> 时间：2012-12-29T23:18:48.207
> 
> 标签：python, inheritance, super

我是 python 新手，我有下面的代码，我无法工作：- 这是继承，我有一个圆形基类，我在一个`circle`类中继承它（这里只是单继承）。

我知道问题出在类中的`ToString()`函数内`circle`，特别是行，`text = super(Point, self).ToString() +..` 它至少需要一个参数，但我得到了这个：

`AttributeError: 'super' object has no attribute 'ToString'`

我知道`super`没有`ToString`属性，但是`Point`该类确实-

我的代码：

```
class Point(object):
    x = 0.0
    y = 0.0

    # point class constructor
    def __init__(self, x, y):
        self.x = x
        self.y = y
        print("point constructor")

    def ToString(self):
        text = "{x:" + str(self.x) + ", y:" + str(self.y) + "}\n"
        return text

class Circle(Point):
    radius = 0.0

    # circle class constructor
    def __init__(self, x, y, radius):
        super(Point, self)              #super().__init__(x,y)
        self.radius = radius
        print("circle constructor")

    def ToString(self):
        text = super(Point, self).ToString() + "{radius = " + str(self.radius) + "}\n"
        return text

shapeOne = Point(10,10)
print( shapeOne.ToString() ) # this works fine

shapeTwo = Circle(4, 6, 12)
print( shapeTwo.ToString() ) # does not work 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:21:12.230

您需要改为传递`Circle`课程：

```
text = super(Circle, self).ToString() + "{radius = " + str(self.radius) + "}\n" 
```

`super()`将查看第一个参数的基类以找到下一个`ToString()`方法，并且`Point`没有该方法的父类。

通过该更改，输出为：

```
>>> print( shapeTwo.ToString() )
{x:0.0, y:0.0}
{radius = 12} 
```

请注意，您在`__init__`;中犯了同样的错误。你根本没有调用继承`__init__`。这有效：

```
def __init__(self, x, y, radius):
    super(Circle, self).__init__(x ,y)
    self.radius = radius
    print("circle constructor") 
```

然后输出变为：

```
>>> shapeTwo = Circle(4, 6, 12)
point constructor
circle constructor
>>> print( shapeTwo.ToString() )
{x:4, y:6}
{radius = 12} 
```

# java - Eclipse，不会导入图像？

> ID：14086783
> 
> 赞同：0
> 
> 时间：2012-12-29T23:18:59.653
> 
> 标签：java, eclipse

由于某种原因，以下代码无法正确导入图像并显示它。如果我注释掉绘图部分，它会起作用。我不知道为什么。

```
import javax.swing.*;
import java.awt.*;
import java.net.URL;

public class BoardBuild extends JPanel{
    String picPath = "pictures/";
    String[] fileName = {"board.png"};
    ClassLoader cl = BoardBuild.class.getClassLoader();
    URL imgURL[] = new URL[1];
    Toolkit tk = Toolkit.getDefaultToolkit();
    Image imgBG;
    public BoardBuild() throws Exception {
        for (int x = 0; x < 1; x++)
            imgURL[x] = cl.getResource(picPath + fileName[x]);
        imgBG = tk.createImage(imgURL[0]);
    }
    public void paintComponent(Graphics g) {
        g.drawImage(imgBG, 0, 0, 150,150 , 0, 0,73, 73, this);
    }
} 
```

因为它是 Eclipse，所以图片在文件夹中`workspace\BoardMaskTest\src\pictures`。我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:25:35.890

不要在`picPath`

```
 String picPath = "/pictures/"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:28:33.200

资源取自类路径，使用 7zip 或 Winzip 在 jar 中查看：

```
String picPath = "/pictures/"; 
```

此外，图像可以加载为

```
 for (int x = 0; x < 1; x++)
        URL url = getClass(().getResource(picPath + fileName[x]);
        imgBG = ImageIO.read(url);
        InputStream in = getClass(().getResourceAsStream(picPath + fileName[x]);
        imgBG = ImageIO.read(in); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T23:23:52.173

放在这里：

```
workspace/BoardMaskTest/pictures/ 
```

相应地改变你的路径。

# php - 在php中选择带有数据库的标签

> ID：14086786
> 
> 赞同：-2
> 
> 时间：2012-12-29T23:19:05.303
> 
> 标签：php, mysql

我有一个问题需要学习如何解决！我正在制作一个包含一些选择标签下拉菜单的提交表单！所以所有这些下拉菜单都是从数据库中获取数据的#2！所以这是我的代码：-

```
<?php
echo "Choose your Source :<select name='source' value='Source'>
                      <option> </otpion>";
$sql = "SELECT City_name FROM city";
$info = mysql_query($sql);

while ($row = mysql_fetch_array($info)) {
    echo "<option > '" . @$row[0] . "'</option>";
}

echo "</select>";
echo "Choose your Destination :<select name='destination' value='Destination'>
                            <option> </otpion>";
echo @$source = $_POST['source'];
$sql = "SELECT Destination FROM Schedule  WHERE Source ='" . @$source . "'";
$info = mysql_query($sql);

while (@$row = mysql_fetch_array($info)) {
    echo "<option selected='selected'>'" . @$row['0'] . "'</option>";
}

echo "</select><br />";
?> 
```

所以现在我想知道的是，当我从“源”下拉菜单中选择一个值而不刷新页面或单击任何按钮时，如何从数据库中获取值到“目标”下拉菜单中！提前致谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:24:25.327

这将需要客户端脚本，例如 JavaScript。看来您可能想要使用 AJAX，它会利用 JavaScript 并允许您调用服务器（最终是您的数据库）上的 PHP 文件，而不会导致页面刷新。

如果你不熟悉 AJAX，我建议你做一些研究。最好的办法是使用带有 AJAX 功能的 JavaScript 库 - 例如 jQuery：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# sql - 如何在执行 INSERT 时加入 TOP 1？

> ID：14086787
> 
> 赞同：0
> 
> 时间：2012-12-29T23:19:10.353
> 
> 标签：sql, sql-server

我想从 SQL Server 进行特殊查询。它来自2张桌子：

1.  有列的猫表`catParentId`
2.  与`catId`列相关的消息表

我想通过 catId 获取与该类别相关的最后一条消息详细信息的猫。换句话说，我想获得父猫下每只猫的最后一条消息。

我创建了表变量并将值插入其中。这是最好的表现方式吗？

SP代码：

```
USE [Lovely_umbraco_cms]
GO
/****** Object:  StoredProcedure [dbo].[SP_Categories_GetCatsMsgs]    Script Date: 12/30/2012 01:21:33 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[SP_Categories_GetCatsMsgs]
 @CatId int
AS
set @catId =1;
declare @CatMessages Table(
     RowID       INT    IDENTITY ( 1 , 1 ), 
     CatName Nvarchar(50),
     MessageCount int,
     LastMessageName nvarchar(50),
     OwnerID uniqueidentifier, 
     CreatedDate date,
     Watched int,
     commentCount int
)
--------------- @CatTable --------
declare @RowsCount int;
Set @rowscount =1;

declare @CatTable table(
    id int identity(1,1),
    catId int,
    CatName nvarchar(50),
    CatParentId int
); 
--- Insert into @CatTable
insert into @CatTable(catId,catName,CatParentId )
select catId, CatName ,CatParentId from LS_Categories WHERE(CatParentId = @CatId);
-----------------------------------

declare @CatTableID int;

declare @CatName nvarchar(50);

-------Temp Message Table --------
declare @Temp_MessagesTable table(
    [Subject] nvarchar(255),
    [Date] [nvarchar](15) NULL,
    [OwnerId] [uniqueidentifier] NULL,
    [WatchCount] [bigint] NULL
);
--------------- @CatMessages Varibles-----

     declare @MessageCount int;
     declare @LastMessageName nvarchar(50);
     declare @OwnerID uniqueidentifier; 
     declare @CreatedDate date;
     declare @Watched int;
     declare @commentCount int;
-------
while @rowsCount <=(SELECT count(Catid) FROM  @CatTable)
begin
    select @CatTableID = CatId, @CatName = CatName from @CatTable where id= @rowsCount;

    delete from @Temp_MessagesTable;

    insert into @Temp_MessagesTable ([Subject],[Date],[OwnerId],[WatchCount])(
    SELECT      Subject, Date, OwnerId, WatchCount
    FROM         (SELECT     TOP (1) Subject, Date, OwnerId, WatchCount
    FROM         LS_Mssages 
    WHERE     (CatId = @CatTableID) ORDER BY MsgId DESC
    ) as s 
    );
    select @LastMessageName=[Subject],@CreatedDate=[Date],
            @OwnerID=[OwnerId],@Watched= [WatchCount] from @Temp_MessagesTable

    -- insert into CatMessages Table
    insert into @CatMessages(CatName,MessageCount,LastMessageName,OwnerID,CreatedDate,Watched,commentCount)
                             (select @CatName,@MessageCount,@LastMessageName,@OwnerID,@CreatedDate,@Watched,@commentCount);
    set @rowsCount = @rowsCount+1
End

select * from @CatMessages; 
```

我的表：[http ://ss-projects.com/t1.jpg](http://ss-projects.com/t1.jpg)

数据样本：[http ://ss-projects.com/data.jpg](http://ss-projects.com/data.jpg)

结果：[http ://ss-projects.com/result.jpg](http://ss-projects.com/result.jpg)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:49:47.047

这不是在 SQL 中执行此操作的最佳方法。

SQL 不是为循环而设计的，相反，您希望编写同时处理所有元素的查询，而不是一次处理一个。

以下与您的代码代码相同，并且还突出显示了错误（选择列表中的 NULLS）。

```
INSERT INTO CatMessages
  SELECT C.CatName, M.Subject, NULL as LastMessageName, M.OwnerID, M.Date, M.WatchCount, NULL as CommentCount
  FROM CatTable C
  JOIN LS_Mssage M ON C.CatID = M.CatID 
```

限制 LS_Mssage 表的最简单方法：

```
INSERT INTO CatMessages
  SELECT C.CatName, M.Subject, NULL as LastMessageName, M.OwnerID, M.Date, M.WatchCount, NULL as CommentCount
  FROM CatTable C
  JOIN (SELECT *, ROW_NUMBER() OVER (PARTITION BY CatID ORDER BY [Date] DESC) AS RN
        FROM LS_Mssage) M ON C.CatID = M.CatID AND M.RN = 1 
```

这是如何工作的：

首先请阅读 JOINS 在 SQL 中的工作原理。这是一个很深的话题，在网络上的任何搜索都会给你带来比我在这短短的篇幅中写的更好的解释。

我使用的高级技术是[OVER 子句](http://msdn.microsoft.com/en-us/library/ms189461.aspx)。这个 over 子句向我称之为 RN 的 LS_Mssage 表添加了一个新列。RN 是一个自动递增索引，每次 CatID 更改时都会重新启动 (PARTITION BY)，并应用于按日期降序排序的结果 (ORDER BY [Date] DESC)。这意味着最新的 RN 总是为 1。然后我加入这个表，只查看 RN 为 1 的行。

要真正理解这一点，请自行运行此查询：

```
SELECT *, 
       ROW_NUMBER() OVER (PARTITION BY CatID ORDER BY [Date] DESC) AS RN
FROM LS_Mssage 
```

查看并了解新表。

这比您的代码快得多，该表只需创建一次，但是在循环中，每次循环迭代都需要完成相同数量的工作。这就是为什么在使用 SQL 时需要在集合（或查询）中思考。

# php - 使用 preg_replace 用 php 保留字符串的一部分

> ID：14086789
> 
> 赞同：0
> 
> 时间：2012-12-29T23:19:25.293
> 
> 标签：php, regex, preg-replace

我有以下字符串。

```
http://www.sample.com/profile/272353.html 
```

我想使用 preg_replace 来保留这部分字符串。

```
profile/272353.html 
```

字符串的第一部分发生了变化，所以我只想确保保留字符串的那一部分。

我是模式的新手，但我仍然不明白，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:20:39.657

使用 parse_url(...)

```
php > var_dump(parse_url('http://www.sample.com/profile/272353.html'));
array(3) {
  ["scheme"]=>
  string(4) "http"
  ["host"]=>
  string(14) "www.sample.com"
  ["path"]=>
  string(22) "/profile/272353.html"
}
php > 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:40:50.727

好吧，按要求回答问题...

```
$modified = preg_replace("/.*([^\/]+\/[^\/]+$)/", $1, $string); 
```

# vb.net - VB相当于测试一些返回值

> ID：14086793
> 
> 赞同：0
> 
> 时间：2012-12-29T23:20:02.210
> 
> 标签：vb.net

在 CI 中可以这样做：

```
if(e=my_func()){
...
} 
```

VB中有一些等价物吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:27:47.230

我相信等价的是：

```
e = my_func()
If e Then
    '... 
```

您还必须记住，VB 有不同的规则将值隐式转换为布尔类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:22:41.840

你需要一个函数返回一些东西。假设它是一个布尔值。

```
Function x() As Boolean
     Return True
End Function 
```

现在你可以像这样检查它：

```
 If x() = True Then
        'do something
  End If 
```

或更简单地说：

```
 If x() Then
            'do something
   End If 
```

这是其他可能性，只是为了说清楚。

```
Function x() As Integer
     Return 5
End Function

If x() = 5 Then
    'do something
End If

If Not (x() = 5) Then
    'do something
End If

Dim y as Integer
y = x()

If y = 5 Then
    'do something
End If 
```

# - 榆树语言

> ID：14086795
> 
> 赞同：0
> 
> 时间：2012-12-29T23:20:02.340
> 
> 标签：

Elm 是一种函数式编程语言，用于编写可以完全替代 HTML/CSS/JavaScript 或与之互操作的 Web 应用程序。

# python - PyGTK：gtk.FileChooserButton 显示的文件夹与 gtk.FileChooserButton.get_current_folder() 不同

> ID：14086798
> 
> 赞同：2
> 
> 时间：2012-12-29T23:20:11.123
> 
> 标签：python, gtk, pygtk, filechooser

我在 Python 脚本中遇到了 gtk.FileChooserButton 的问题。如果您从按钮菜单中选择选项 ›Other ...‹，则会打开 gtk.FileChooserDialog，您可以在其中选择一个新文件夹。如果我通过双击选择这个新文件夹并通过单击 ›Open‹ 确认对话框，则所选文件夹名称显示在 gtk.FileChooserButton 中，并且 gtk.FileChooserButton.get_current_folder() 的值更改为所选文件夹的路径文件夹（您可以在示例的状态栏中看到）。这是预期的行为。

但是当我不是通过双击而是通过单击来选择新文件夹并通过单击 ›Open‹ 确认对话框时，所选文件夹名称显示在 gtk.FileChooserButton 中，但路径显示在 gtk.FileChooserButton.get_current_folder () 不是所选文件夹的路径，而是其父文件夹的路径。

这是一个错误还是我的脚本中有错误？按钮上的文件夹名称应始终与 gtk.FileChooserButton.get_current_folder() 的名称相同。在这里可以做什么？谢谢。

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import gtk, os

class MainClass(object):
    def __init__(self):
        self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
        self.window.set_position(gtk.WIN_POS_CENTER)
        self.window.set_default_size(400, 100)
        self.window.connect("delete_event", self.delete_event)
        self.window.connect("destroy", self.destroy)
        self.window.set_border_width(6)
        self.vbox1 = gtk.VBox(False, 0)
        self.window.add(self.vbox1)

        self.filechooserdialog1 = gtk.FileChooserDialog("Select a folder…", None, gtk.FILE_CHOOSER_ACTION_SELECT_FOLDER, (gtk.STOCK_CANCEL, gtk.RESPONSE_CANCEL, gtk.STOCK_OPEN, gtk.RESPONSE_OK))
        self.filechooserdialog1.set_default_response(gtk.RESPONSE_OK)
        self.filechooserbutton1 = gtk.FileChooserButton(self.filechooserdialog1)
        self.filechooserbutton1.set_current_folder(os.environ['HOME'])
        self.filechooserbutton1.connect('current-folder-changed', self.tell_folder)

        self.vbox1.pack_start(self.filechooserbutton1, True, False, 0)
        self.statusbar1 = gtk.Statusbar()
        self.vbox1.pack_start(self.statusbar1, False, False, 0)
        self.context_id = self.statusbar1.get_context_id("status")
        self.window.show_all()

    def tell_folder(self, data=None):
        self.statusbar1.push(self.context_id, self.filechooserbutton1.get_current_folder())

    def delete_event(self, widget, event, data=None):
        return False

    def destroy(self, data=None):
        gtk.main_quit()

    def main(self):
        gtk.main()

if __name__ == "__main__":
    MyApp = MainClass()
    MyApp.main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:30:38.213

您正在收听的信号仅在文件选择器中的视图文件夹更改时发出，而不是在选择父文件夹中的文件夹时发出，同样适用`get_current_folder()`，它会告诉您您正在查看哪个文件夹而不是您选择的。所以你的代码中发生的事情是双击首先更改了当前文件夹，然后“按下”确定。

`file-set`听 的信号似乎更合适`FileChooserButton`，尽管我不是 100% 确定您如何检查用户是否单击了任何按钮/退出了对话。要获得选择的内容，前提是您一次只允许选择一件事，您可以使用`FileChooser`'s `get_filename()`（或者`get_filenames()`如果您允许多选）。不幸的是，我无法测试解决方案，因为我在错误的计算机上，但它至少应该引导你朝着正确的方向前进。

作为旁注，我发现在需要对话时简单地调用`run()`并`FileChooserDialog`捕获它作为响应返回的内容（单击了什么按钮）然后使用`get_filename()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T13:42:25.330

如果您想要当前文件夹，最好监视**current-folder-changed**信号，然后您可以在回调中使用**get_current_folder**但仅在回调中可靠。这是一个不错的解决方法。

```
def on_current_folder_changed(widget):
    widget._folder = widget.get_current_folder()

def on_file_set(widget):
    # Lock that value in.
    if widget.get_current_folder() != widget._folder:
        widget.set_current_folder(widget._folder) 
```

# php - 在 php 中使用带有路径的 .htaccess

> ID：14086802
> 
> 赞同：-3
> 
> 时间：2012-12-29T23:21:07.250
> 
> 标签：php, .htaccess

我正在编写一个脚本，我想制作如下链接：

```
www.mysite.com/sites/info/siteid 
www.mysite.com/sites/edit/siteid
www.mysite.com/sites/delete/siteid 
```

我知道我应该使用 RewriteRule。这是我的 .htaccess

```
RewriteEngine On
RewriteRule ^/?([a-z]+)$ $1.php [L]

RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 

RewriteRule ^sites/(.*)$ sites.php?info=$1 [L] 
```

所以，在 php 中，我想获取 /info 或 /edit 或 /delete`$_GET['info'];`之类的。另外，我想以`siteid`同样的方式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:29:52.303

拆分参数`/`应该有效

```
RewriteRule ^/sites/(.*)/(.*)$ sites.php?info=$1&siteid=$2 [L] 
```

# c++ - 线程缓存对象引用

> ID：14086807
> 
> 赞同：2
> 
> 时间：2012-12-29T23:22:24.733
> 
> 标签：c++, c, memory

我需要创建一种共享对象（无论出于何种原因）。它不仅限于单线程使用。通常在这种情况下，联锁操作是可行的方法（例如Win32 上的`InterlockedIncrement`和`InterlockedDecrement`）。

尽管对象引用计数在任何情况下都应该正常工作，但我想针对单线程使用对其进行优化。互锁运算比标准算术运算要重得多。根据我的测量，一个联锁操作（发出完整的内存屏障）在我的“典型”CPU 上需要大约 40 个 CPU 周期，而标准算术运算低于任何测量精度（感谢 CPU 缓存）。

在内存分配方面也有类似的技术。有一些堆实现，例如“TCMalloc”，由一个集中的内存分区机制组成，由适当的同步对象保护，加上每线程**缓存**。在最常见的情况下，在每个线程缓存上分配/释放内存，这根本不涉及任何互锁操作，而且 CPU 缓存很有可能被利用。

因此，我认为有可能为支持引用的对象做类似的事情。任何想法如何实现这一目标？也欢迎原始想法。

在我的场景中，可以将实际的对象销毁延迟一段时间，如果这样可以提高性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:16:03.410

我不会打扰。我刚刚运行了这个基准测试：

```
#include<stdio.h>

#define SIZE 1000000

static __inline__ unsigned long long rdtsc(void)
{
    unsigned hi, lo;
    __asm__ __volatile__ ("rdtsc" : "=a"(lo), "=d"(hi));
    return ( (unsigned long long)lo)|( ((unsigned long long)hi)<<32 );
}

void print_avg(const char *str, const int *diff, int size)
{
    int i;
    long sum = 0;
    int max = -1, min = 10000;
    for(i = 0; i < size; i++)
    {
    int t = diff[i];
    sum += t;
    if (t > max) max = t;
    if (t < min) min = t;
    }

    printf("%s average =%f clocks, max =%d, min =%d\n", str, (double)sum / size, max, min);
}

int main()
{
    unsigned long long a, b;
    int diff[SIZE];
    int value = 0;
    int i;

    for(i = 0; i < SIZE; i++)
    {
    a = rdtsc();

    __sync_fetch_and_add(&value, 2);
    b = rdtsc();

    diff[i] = (int)(b - a);
    }

    print_avg("Locked", diff, SIZE);

    for(i = 0; i < SIZE; i++)
    {
    a = rdtsc();
        value += 2;
    b = rdtsc();
    diff[i] = (int)(b - a);
    }
    print_avg("Not locked", diff, SIZE);

    return 0;
} 
```

使用 gcc -O2 编译，结果如下：

```
Locked average =105.672402 clocks, max =38756, min =86  
Not locked average =80.540389 clocks, max =23433, min =73 
```

我跑了好几次，每次的结果都非常相似。请忽略最大值的大数字 - 那是处理器接受中断或其他东西的时候 - 它来自我为不同目的编写的一些代码，我只是为了这个测试回收了它。这个微小的差异应该适用于所有现代处理器（Intel iCore 和 AMD Athlon64 以及那些世代）

除非由于某种原因您的编译器没有内联 InterlockedIncrement，否则在您的代码上添加一个 if 语句很可能会花费至少 5 个周期，因此您最多可以节省 10 个周期。希望您做的不是增加和减少引用计数器。

编辑：添加内存屏障也没有太大区别 - 大约 10 个周期。

诚然，如果我在第二个循环中添加 10 个加法，则每个循环大约需要 5 个时钟周期（因此平均每个加法需要半个时钟），而锁定加法每次加法需要大约 20 个时钟。在我看来，仍然不值得添加 if 语句。但是，如果您想添加“if (nr_threads == 1) a = a + 1; else a = __sync_fetch_and_add(a, 1);”，[或任何你需要做的事情] 我不会阻止你. 但是请确保您对整个应用程序进行基准测试，并确保它的改进超过 1%——我对此表示怀疑。请回来告诉我们有什么区别。我在 Linux 内核的“解除分配页表条目”中添加的 if 语句使它慢了 2-5%，所以不值得。但是，如果您在代码中发现了这一点，那就值得了，做我的客人吧。我说的是经验，

# android - 重新启动应用程序时出现内存不足错误（Android）

> ID：14086808
> 
> 赞同：4
> 
> 时间：2012-12-29T23:22:37.870
> 
> 标签：android, memory-leaks, andengine

我正在开发一个使用 5 个大约 900x600 的大图像的游戏。当我退出游戏（按后退按钮）然后尝试启动游戏时，出现以下错误：

```
12-29 15:59:16.633: E/AndroidRuntime(18642): FATAL EXCEPTION: GLThread 17
12-29 15:59:16.633: E/AndroidRuntime(18642): java.lang.OutOfMemoryError: (Heap  Size=20423KB, Allocated=3473KB, Bitmap Size=77KB)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.util.GLHelper.getPixelsARGB_8888(GLHelper.java:165)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.util.GLHelper.getPixels(GLHelper.java:41)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.util.GLState.glTexImage2D(GLState.java:641)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.texture.bitmap.BitmapTexture.writeTextureToHardware(BitmapTexture.java:120)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.texture.Texture.loadToHardware(Texture.java:137)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.texture.TextureManager.updateTextures(TextureManager.java:254)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.engine.Engine.onDrawFrame(Engine.java:621)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at org.andengine.opengl.view.EngineRenderer.onDrawFrame(EngineRenderer.java:105)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1363)
12-29 15:59:16.633: E/AndroidRuntime(18642):    at android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1118) 
```

这真的很令人困惑，因为我在应用程序被销毁之前卸载了所有纹理。我知道这 5 张图片导致了错误，因为当我完全跳过加载它们时，我没有收到任何错误。为了确保所有纹理都被卸载，我加载了纹理并在卸载它们之后立即加载。然后我退出并重新启动游戏，但收到同样的错误。纹理也没有任何静态引用。我还使用 MAT 查看我在游戏中使用了多少内存，并注意到我只使用了 2.5MB，所以我不知道为什么错误是说“堆大小 = 20MB”。我暂时设法解决错误的唯一方法是包括

```
system.exit(0); 
```

我知道我不应该使用它，但我完全没有想法。

编辑：我确保正在卸载纹理。我在游戏中有一个按钮可以卸载所有纹理。当我按下它时，所有纹理都变黑了，我假设已卸载纹理。我在卸载纹理时使用的一般方法只是说

```
someTexture.unload(); 
```

这是一个 andEngine 方法。我不确定除此之外会发生什么。

编辑 2：我在一个名为 onCreateResources() 的方法中加载纹理，然后在 onDestroy() 上卸载它们。这些是我操纵纹理的唯一两个地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:09:59.810

垃圾收集器不会立即释放未使用的对象内存，因此如果您尝试在短时间内重新加载新的位图，则没有可用内存可供使用。

也许你应该使用 Wea​​kReference：JVM 必须在抛出 OutOfMemoryException 之前释放 WeakReference 对象。可以在这里找到一个例子：http: [//developer.android.com/training/displaying-bitmaps/display-bitmap.html](http://developer.android.com/training/displaying-bitmaps/display-bitmap.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:45:05.473

如果我从 Android API 中没记错的话：按下后退按钮并不一定意味着 onDestroy()。Android 操作系统会为您处理垃圾收集并在需要时调用 onDestroy()（例如，当您在按下返回按钮后启动了更多应用程序时）。

但是，有一些 ROMS 允许您通过长按返回按钮来“杀死”应用程序。

您可以尝试从 onStop() 卸载纹理并报告回来吗？

编辑：没有看到鲨鱼的回复。OnPause() 也可以工作——同样的概念......实际上 onPause() 总是在 OnStop() 之前调用，所以它可能是一个更好的解决方案。

# c++ - vector::clear() 幕后和破坏

> ID：14086816
> 
> 赞同：4
> 
> 时间：2012-12-29T23:23:19.077
> 
> 标签：c++, oop, stl, destructor, undefined-behavior

我研究了 STL 向量的实现。矢量容器被实现为动态数组。clear() 方法用于销毁向量中的所有元素，它将向量的大小设置为 0，但容量保持不变。所以，如果我理解正确，所有元素都被称为它们的析构函数，但动态分配的内存仍然可用。为了仍然释放它，我们可以这样做：

```
Vec.swap( vector<T>() ); // Capacity = 0. 
```

但是让我们假设我们没有使用交换，只是明确了。内部实现（如果我错了，请纠正我）大约等于以下内容（以非常简化的方式）：

```
// A contained type:
struct C {
    int m;
    C() : m(123){}
};
C * arr = new C[10];  //  Suppose this is the internal array in the container 
```

编辑：我知道上面的 new 运算符没有在实际实现中使用，并且 STL 使用分配器，我只是使用 new 作为测试用例来测试析构函数（这只是一个类比）。

```
// Calling clear() :
for(size_t i=0;i<SZ;i++)
    arr[i].~C();  //  Destroying ALL elements  
// some other actions . . . 
```

但是现在容量还是10，内存还有一些我们可以访问的数据：

```
// Accessing the vector at 0:
cout<<arr[0].m<<endl;  //  This prints 123 
```

这是未定义的行为吗？好吧，似乎是这样，但我想确定。

也许如果我更深入地了解调用析构函数时会发生什么（关于堆栈内存），我可以肯定地知道，这是否等于程序超出函数范围时调用析构函数，或者调用析构函数在退出范围之前被认为就像任何方法一样，并且对象的堆栈内存没有被释放？

免责声明：上面的代码非常简化，以象征 clear() 的部分功能，以及我从研究中得出的结论，如果我错了，您可以纠正我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:30:08.800

`std::vector<...>::clear()`只是销毁对象并适当设置其内部记录以指示没有对象是正确的。当访问被破坏的对象时，你有未定义的行为：虽然数据中的位可能没有改变，但关联的对象也可能已经被破坏，并且它们的内存可能被回收用于其他目的。

在您的示例中，`C`仅在析构函数中存储一个`int`并且不对其执行任何操作，这些位可能没有变化，但不能保证这种方式。特别是调试实现可能会浪费几个周期来故意将垃圾写入被破坏对象的内存中。

只是一个旁注：`std::vector<...>`不会使用`new C[n]`而是通过分配器分配和释放原始内存。不过，这是一个细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:58:51.587

您的程序使用内存区域：堆栈和堆。您将 arr 向量地址放在堆内存上，但 m 的值驻留在堆栈上。如果要删除堆内存使用 delete [] arr，如果要删除未寻址的内存使用

> arr=NULL 您的结构可以像这样轻松修改

```
struct C {
int *m;
C(int value) {
    m=new int(value);
}
~C()
{
    delete m;
} 
```

};

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T23:35:56.753

如果我理解正确，您的主要问题是：

> 这是未定义的行为吗？

使用常规数组，是的，由于上一个答案中解释的原因，您有一个未定义的行为。但是，如果您尝试访问`std::vector`索引等于或大于向量*大小*（注意，不要超出*容量*`std::out_of_range`）的元素，则访问运算符将引发异常（尽管函数`clear()`确实调用了每个向量的元素并且*不*改变其容量，它确实改变了向量包含多少元素的内部计数）。

# java - 如何使用 BufferedReader 检测文件末尾是否有空行？

> ID：14086821
> 
> 赞同：0
> 
> 时间：2012-12-29T23:23:53.887
> 
> 标签：java, file-read

我目前正在研究 INI 文件解析库，但是当我尝试使用我制作的方法创建类别时，我遇到了一个问题。

我正在使用的 INI 文件的内容如下：

```
; Format example
[Category]
key=value

; Just a test to see if setting the same key in a different category
; would mess up the reading, which it didn't.
[Language]
cplusplus=C++
key=java
(No extra line; file ends at "key=java") 
```

当我使用该方法创建一个类别时，它会尝试添加足够多的新行，以便每个类别在前一个类别的末尾和您正在创建的类别之间有 1 个空白行。如果我保持文件原样，文件末尾没有额外的空白行，它就可以正常工作。但是，如果我将文件内容更改为：

```
; Format example
[Category]
key=value

; Just a test to see if setting the same key in a different category
; would mess up the reading, which it didn't.
[Language]
cplusplus=C++
key=java

(File has extra line; file ends after the "key=java" line) 
```

它在两个类别之间创建了两个空行......但我不明白为什么，因为我检查最后一行是否已经是空白。我对Java有些陌生，所以如果我犯了一些明显的错误，请告诉我。

```
/**
 * Adds a category to the current INI file.
 * 
 * @param category The category to be added to the file
 */
public void addCategory(String category) {
    if (iniFile == null) return;

    // Checking to see if the file already contains the desired category
    boolean containsCategory = false;
    String lastLine = "";
    String string;

    try (BufferedReader in = new BufferedReader(new FileReader(iniFile))) {
        while ( (string = in.readLine()) != null) {
            // Line is a comment or is empty, ignoring
            if (!string.equals(""))
                if (string.charAt(0) == ';' || string.charAt(0) == '#')
                    continue;

            lastLine = string;

            // Line is a category, checking if it is the category that is
            // about to be created
            if (!string.equals("") && string.charAt(0) == '[') {
                String thisCategory = string.substring(1, string.length() - 1);
                if (thisCategory.equals(category))
                    containsCategory = true;
            }
        }
    } catch (IOException e) {}

    // The file does not contain the category, so appeanding it to the end
    // of the file.
    if (!containsCategory) {
        try (BufferedWriter out = new BufferedWriter(new FileWriter(iniFile, true))) {
            if (!lastLine.equals("")) {
                System.out.println("Adding extra whitespace");
                out.newLine();
                out.newLine();
            }

            out.write('[' + category + ']');
            out.close();
        } catch (IOException e) {}
    }
} 
```

如果你想查看完整的文件源，这里是它上传到的[GitHub的链接。](https://github.com/DealerNextDoor/INIParser/blob/master/src/net/netii/platinumcoding/ini/INIReader.java)

编辑：

我只是想我应该在调用该`addCategory(String)`方法后提供文件的外观。

在我调用`addCategory("Example")`第一个文件后（没有多余的空行）：

```
; Format example
[Category]
key=value

; Just a test to see if setting the same key in a different category
; would mess up the reading, which it didn't.
[Language]
cplusplus=C++
key=java

[Example] 
```

在我调用`addCategory("Example")`第二个文件后（文件末尾有一个额外的空行）：

```
; Format example
[Category]
key=value

; Just a test to see if setting the same key in a different category
; would mess up the reading, which it didn't.
[Language]
cplusplus=C++
key=java

[Example] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:29:32.343

你有反对使用扫描仪类的东西吗？

使用 Scanner，您可以逐行读取文件，然后在 = 处拆分结果字符串。如果在一行上拆分失败（结果 String[] 的长度为 1），那么您知道该行的格式不正确，如果该行的长度为 1 并且与 "\n" 匹配，则它是一个空行，如果扫描仪.hasNextLine() == 假，EOF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:10:32.907

`lastLine``""`如果文件中的最后一行只不过是`\n`（或），则将为空（`\r\n`）。`readLine`去除行尾字符。

如果不为空，则仅在写入文件时`lastLine`添加空格*。*所以……这不是问题。

然而：

1.  您没有考虑最后一行可能没有行尾字符。
2.  带有“额外”行的源文件......没有行尾字符，但有一个空格。

这是唯一会生成您显示的输出的东西。当您添加两个换行符时，您将在缺少它的额外行中添加一个，然后创建第二个“空白”行；没有行尾字符。

这也是为什么在以结尾的文件中添加两个换行符`key=java`只会产生一个“空白行”的原因。

您需要在阅读文件时考虑到这一点。也许是一个正则表达式？

老实说，每次编写整个文件更容易。这就是内置`Properties`对象在 java 中的作用。

# c++ - C++私有函数的内部链接？

> ID：14086824
> 
> 赞同：11
> 
> 时间：2012-12-29T23:24:46.133
> 
> 标签：c++, private

当我用 C 编写面向对象的代码时，我通常将结构定义与公共函数放在一个头文件中，并在单独的 .c 文件中实现公共函数。我将 static 关键字赋予这个类的所有“私有”函数，并在 .c 文件中实现它们。然后，公共函数可以调用属于同一类的私有函数。由于 static 关键字，不能从外部调用私有函数，因此 GCC 可以优化其中的许多函数。它们通常是内联的，并且原始函数会从输出目标文件中完全删除。

现在我的问题是：我怎样才能对 C++ 类做同样的事情？

假设我有一个头文件：

```
class A {
    int private_field;
    int private_function();
public:
    int public_function();
}; 
```

还有我的 .cpp 文件：

```
#include <iostream>
#include "A.h"

int A::private_function() {
    std::cin >> private_field;
    return private_field;
}

int A::public_function() {
    return private_function() + 4;
} 
```

在生成的目标文件中，private_function 保留为单独的符号，并且 public_function 调用 private_function（未内联）。我想给 private_function 内部链接，所以编译器可以做与我使用 C 时相同的优化。我尝试过使用匿名命名空间和静态，但我无法让它像我想要的那样工作。如何正确地做到这一点，甚至可能吗？我使用 GCC。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-29T23:28:42.643

类成员永远不会有内部联系。该标准说（第 9.3 节）：

> 命名空间范围内的类的成员函数具有外部链接。本地类的成员函数没有链接。

因此，如果要创建具有内部链接的辅助函数，则必须使用非成员。

```
static int private_function(A* pThis);

class A
{
    int private_field;
    friend int private_function(A* pThis);
public:
    int public_function();
}; 
```

进而

```
#include <iostream>
#include "A.h"

static int private_function(A* pThis)
{
    std::cin >> pThis->private_field;
    return private_field;
}

int A::public_function() {
    return private_function(this) + 4;
} 
```

请注意标准中的这条规则（第 11.3 节）：

> A function first declared in a friend declaration has external linkage. Otherwise, the function retains its previous linkage.

# python - 类中的Python调用方法

> ID：14086830
> 
> 赞同：57
> 
> 时间：2012-12-29T23:25:28.057
> 
> 标签：python, class, methods

我在这里的重量超过了我的体重，但请耐心等待这个 Python 业余爱好者。我是一名专业的 PHP 开发人员，以前几乎没有接触过这种语言。

我想要做的是在一个类中调用一个方法......听起来很简单吗？我对“自我”指的是什么以及在类内和类外调用这种方法的正确过程是什么感到完全困惑。

有人可以向我*解释一下*如何`move`使用变量调用该方法`RIGHT`。我曾尝试在几个“学习 python”网站上对此进行研究，并在 StackOverflow 上进行搜索，但无济于事。任何帮助将不胜感激。

以下类在 Scott 的 Python 脚本中工作，该脚本由终端 GUI (urwid) 访问。

我正在使用的函数是 Scott Weston 的导弹发射器 Python 脚本，我正在尝试将其挂接到 PHP 网络服务器中。

```
class MissileDevice:
  INITA     = (85, 83, 66, 67,  0,  0,  4,  0)
  INITB     = (85, 83, 66, 67,  0, 64,  2,  0)
  CMDFILL   = ( 8,  8,
                0,  0,  0,  0,  0,  0,  0,  0,
                0,  0,  0,  0,  0,  0,  0,  0,
                0,  0,  0,  0,  0,  0,  0,  0,
                0,  0,  0,  0,  0,  0,  0,  0,
                0,  0,  0,  0,  0,  0,  0,  0,
                0,  0,  0,  0,  0,  0,  0,  0,
                0,  0,  0,  0,  0,  0,  0,  0)
  STOP      = ( 0,  0,  0,  0,  0,  0)
  LEFT      = ( 0,  1,  0,  0,  0,  0)
  RIGHT     = ( 0,  0,  1,  0,  0,  0)
  UP        = ( 0,  0,  0,  1,  0,  0)
  DOWN      = ( 0,  0,  0,  0,  1,  0)
  LEFTUP    = ( 0,  1,  0,  1,  0,  0)
  RIGHTUP   = ( 0,  0,  1,  1,  0,  0)
  LEFTDOWN  = ( 0,  1,  0,  0,  1,  0)
  RIGHTDOWN = ( 0,  0,  1,  0,  1,  0)
  FIRE      = ( 0,  0,  0,  0,  0,  1)

  def __init__(self, battery):
    try:
      self.dev=UsbDevice(0x1130, 0x0202, battery)
      self.dev.open()
      self.dev.handle.reset()
    except NoMissilesError, e:
      raise NoMissilesError()

  def move(self, direction):
    self.dev.handle.controlMsg(0x21, 0x09, self.INITA, 0x02, 0x01)
    self.dev.handle.controlMsg(0x21, 0x09, self.INITB, 0x02, 0x01)
    self.dev.handle.controlMsg(0x21, 0x09, direction+self.CMDFILL, 0x02, 0x01) 
```

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-12-29T23:29:09.753

通常调用所有方法的第一个参数`self`。它指的是为其调用方法的实例。

假设您有：

```
class A(object):
    def foo(self):
        print 'Foo'

    def bar(self, an_argument):
        print 'Bar', an_argument 
```

然后，做：

```
a = A()
a.foo() #prints 'Foo'
a.bar('Arg!') #prints 'Bar Arg!' 
```

* * *

这个被称为没有什么特别的`self`，你可以执行以下操作：

```
class B(object):
    def foo(self):
        print 'Foo'

    def bar(this_object):
        this_object.foo() 
```

然后，做：

```
b = B()
b.bar() # prints 'Foo' 
```

* * *

在您的具体情况下：

```
dangerous_device = MissileDevice(some_battery)
dangerous_device.move(dangerous_device.RIGHT) 
```

（正如评论中所建议的，`MissileDevice.RIGHT`这里可能更合适！）

不过，您**可以**在模块级别声明所有常量，因此您可以这样做：

```
dangerous_device.move(RIGHT) 
```

但是，这将取决于您希望如何组织代码！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-19T10:49:59.870

假设你有一个闪亮的 Foo 类。那么你有3个选择：

1）您想在该类的定义中使用该类的方法（或属性）：

```
class Foo(object):
    attribute1 = 1                   # class attribute (those don't use 'self' in declaration)
    def __init__(self):
        self.attribute2 = 2          # instance attribute (those are accessible via first
                                     # parameter of the method, usually called 'self'
                                     # which will contain nothing but the instance itself)
    def set_attribute3(self, value): 
        self.attribute3 = value

    def sum_1and2(self):
        return self.attribute1 + self.attribute2 
```

2）你想使用该类定义之外的类的方法（或属性）

```
def get_legendary_attribute1():
    return Foo.attribute1

def get_legendary_attribute2():
    return Foo.attribute2

def get_legendary_attribute1_from(cls):
    return cls.attribute1

get_legendary_attribute1()           # >>> 1
get_legendary_attribute2()           # >>> AttributeError: type object 'Foo' has no attribute 'attribute2'
get_legendary_attribute1_from(Foo)   # >>> 1 
```

3）您想使用实例化类的方法（或属性）：

```
f = Foo()
f.attribute1                         # >>> 1
f.attribute2                         # >>> 2
f.attribute3                         # >>> AttributeError: 'Foo' object has no attribute 'attribute3'
f.set_attribute3(3)
f.attribute3                         # >>> 3 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-29T23:43:52.180

> 有人可以向我解释一下，如何使用变量 RIGHT 调用 move 方法

```
>>> myMissile = MissileDevice(myBattery)  # looks like you need a battery, don't know what that is, you figure it out.
>>> myMissile.move(MissileDevice.RIGHT) 
```

如果你用任何其他语言编写了类，除了python，这种事情

```
class Foo:
    bar = "baz" 
```

大概是陌生的。在python中，类是对象的工厂，但它本身就是一个对象；并且在其范围内定义的变量附加到*类*，而不是类返回的实例。参考`bar`上面，你可以直接调用它`Foo.bar`；您还可以通过类的实例访问类属性，例如`Foo().bar`.

* * *

> 我也完全对“自我”的含义感到困惑，

```
>>> class Foo:
...     def quux(self):
...         print self
...         print self.bar
...     bar = 'baz'
...
>>> Foo.quux
<unbound method Foo.quux>
>>> Foo.bar
'baz'
>>> f = Foo()
>>> f.bar
'baz'
>>> f
<__main__.Foo instance at 0x0286A058>
>>> f.quux
<bound method Foo.quux of <__main__.Foo instance at 0x0286A058>>
>>> f.quux()
<__main__.Foo instance at 0x0286A058>
baz
>>> 
```

当您访问 python 对象上的属性时，解释器会注意到，当查找的属性在类上并且是一个函数时，它应该返回一个“绑定”方法而不是函数本身。所有这一切都是安排实例作为第一个参数传递。

# python - 如何使用 MongoEngine 根据特定条件选择多个对象？

> ID：14086831
> 
> 赞同：1
> 
> 时间：2012-12-29T23:25:31.113
> 
> 标签：python, flask, pymongo, mongoengine, django-queryset

我正在使用 MongoDB 和 MongoEngine 构建 Python Flask Web 应用程序。我正在尝试根据某些标准选择多个对象。当我尝试`Item.objects.get(field="criteria")`时，它会抛出一个`MultipleObjectsReturned`错误，它应该根据文档返回（https://mongoengine-odm.readthedocs.org/en/latest/apireference.html#mongoengine.queryset.QuerySet）。我知道它应该返回多个对象。我可以使用什么查询来根据特定条件返回多个对象？

编辑：我尝试了 Item.objects.filter(field="criteria") 并忘记更改页面上的一个调用，所以它仍然返回`MultipleObjectsReturned`。看到答案后，我注意到了这个错误，现在它工作得很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:28:31.340

尝试：

```
Item.objects.filter(field="criteria") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:29:43.637

```
Item.objects(field="criteria") 
```

或者

```
Item.objects.filter(field="criteria") 
```

# php - 用于 PHP 的 Google 日历 API 用于获取日历事件的简单只读请求

> ID：14086833
> 
> 赞同：11
> 
> 时间：2012-12-29T23:25:37.307
> 
> 标签：php, oauth-2.0, google-calendar-api

我想为网站编写一些简单的 PHP 代码，以便使用 Google 的日历 API V3 获得对公共 Google 日历事件列表的只读访问权限。我只需要在网页上显示日历中即将发生的事件列表。我已经阅读了开发人员文档并查看了[**入门部分**](http://code.google.com/p/google-api-php-client/)和[**获取事件示例代码**](https://developers.google.com/google-apps/calendar/v3/reference/events/list#examples)，但我有点困惑。我在想：

*   有没有一种更简单的方法来做我需要的事情来避免所有这些 OAuth 东西？是否有非认证访问方法？

*   如果没有，看起来我需要在 code.google.com/apis/console/ 上为我的应用设置访问权限，然后生成 ApplicationName、ClientID、ClientSecret、RedirectURI 和 DeveloperKey。**ApplicationName**和**DeveloperKey**很简单，可以在 Google Console 中找到。但对于其他项目，我需要创建一个 OAuth 2.0 ClientID，这需要我选择应用程序类型是 Web 应用程序还是服务帐户。我的场景应该是什么？在这种情况下，不需要用户登录，因为我没有请求访问**他们的**日历——它只是我需要访问的公共日历。

*   什么是重定向 URI 以及如何使用它。我应该如何设置它？

*   Google 的 API 示例获取并缓存 Session 数据中的访问令牌。然后代码注释说不要这样做，你应该使用数据库。严重地？我真的需要处理缓存访问令牌吗？如果是这样，Google API 中是否有内置的数据库缓存机制，或者您如何处理？

我真的在寻找一种更简单的方法。欢迎您的指导！

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:27:19.907

我觉得你想太多了。如果您只需要访问*公共*日历上的事件，那么有一种方法可以做到这一点，而无需调用 Google Calendar API 和所有附加的复杂性。每个*公共*Google 日历都有一个 iCal 供稿，可以在特定 URL 上查看，通常采用以下形式：

```
http://www.google.com/calendar/ical/{OWNER}/public/basic.ics 
```

`{OWNER}`日历所有者的 URL 编码电子邮件地址在哪里。

您可以通过查看日历设置并滚动到“日历详细信息”选项卡的底部来找到特定的 URL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-24T06:09:27.050

执行此操作的一些提示嵌入在对查尔斯回答的评论中。无论如何，截至 2014 年（使用 Google Calendar v3 API），这就是我所做的：
去这里看看 v3 API 是如何工作的：
[https ://developers.google.com/google-apps/calendar/v3/reference/events /list#try-it](https://developers.google.com/google-apps/calendar/v3/reference/events/list#try-it)

在上述链接中提供的演示 Web 表单中至少填写以下三个字段：：
`calendarId`日历所有者的 URL 编码电子邮件地址。
`timeMax`: 结束时间
`timeMin`: 开始时间
（使用此时间格式：`2014-05-04T00:00:00-00:00`（Ymd T 毫秒 - 偏移量））

您将看到以下请求被发送出去。

```
GET https://www.googleapis.com/calendar/v3/calendars/{CALENDER_ID}/events?timeMax={start_time}&timeMin={end_time}&key={YOUR_API_KEY} 
```

现在，您可以根据您的要求自定义此请求 URL，并从您的代码发送常规 GET 请求。

PS - 要获取您的 API 密钥，请按照以下步骤操作：
[https ://developers.google.com/google-apps/calendar/auth](https://developers.google.com/google-apps/calendar/auth)

# java - Vaadin - 多个按钮实例 - 不同的点击监听器动作

> ID：14086837
> 
> 赞同：1
> 
> 时间：2012-12-29T23:26:13.577
> 
> 标签：java, vaadin

我在显示包含例如标签和按钮的多个面板时遇到问题。我想听按钮点击并从面板显示标签值。代码看起来像这样：

```
for(int i=0; i < 5;i++){
 Panel p = new Panel("panel "+i);
 Label l = new Label("label "+ i);
 p.addComponent(l);
 Button show = new Button("Show Label in subWindow", new Button.ClickListener() {
                public void buttonClick(ClickEvent event) {
                    Window sub = new Window("testing "+label);
                    getMainWindow().addWindow(sub);
                }
    });
} 
```

我知道每个按钮上的这段代码都会记住标签的最后一个值。我如何在循环中为每个传递绑定特定按钮以显示特定标签的值？我正在尝试在检票口中实现类似 PageableListView 控件的内容。

我希望你能理解我的问题！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T14:20:57.950

为什么不能子类化 Button 并使 Label 实例（Panel 实例或任何其他实例）成为其状态的一部分？

```
public class MyButton extends Button {

    private Label label;

    public MyButton (String title, Label l) {
        super(...);
        this.label = l;
        addListener(...);
    }
} 
```

换句话说，如果你需要一个按钮来链接到某个对象——显式地创建它。

# drupal-7 - 用于维护库存和图像缩放 drupal Commerce 的建议模块

> ID：14086838
> 
> 赞同：-1
> 
> 时间：2012-12-29T23:27:11.387
> 
> 标签：drupal-7, overlay, inventory, drupal-commerce

我已经使用 drupal 7 commerce 创建了一个网站，现在我需要一个具有两个功能的模块

1.) 管理网站的库存，以便用户只能按我的库存中可用的项目。

2.) 我想在产品页面上添加图像悬停效果和叠加效果，以便用户能够放大产品。

请建议合适的模块或者我需要为此编写自己的模块，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T06:40:43.973

对于库存管理，请尝试[Commerce Stock](http://drupal.org/project/commerce_stock)一个 contrib 模块。

如果您想要开箱即用的体验，您可以尝试[Commerce Kickstart 安装配置文件](http://drupal.org/project/commerce_kickstart)。如果您在安装 Commerce KS 时选择安装可选的演示商店，您可以查看放大产品功能的示例演示。由于缩放功能独立于 drupal commerce，您可以使用[Cloud Zoom](http://drupal.org/project/cloud_zoom)等任何模块来实现所需的效果。

# objective-c - 如何使用 plist 中的数据填充文本字段

> ID：14086839
> 
> 赞同：0
> 
> 时间：2012-12-29T23:27:23.547
> 
> 标签：objective-c, xml, plist, tableview

我试图弄清楚如何用 plist 中的数据填充 DVC 中的文本字段。我已经将数据填充到已知问题的 tableview 单元格中。我还没有发布。M 为 DVC，因为简单地说。我不知道要在那里添加什么...

xml / plist

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
    <dict>
        <key>cellName</key>
        <string>Sharon Lodge No. 327</string>
        <key>cellSubtitle</key>
        <string>McLean, VA</string>
        <key>address</key>
        <string>999 Balls Hill Road</string>
        <key>webSite</key>
        <string>www.website.com</string>
        <key>statedCom</key>
        <string>Hold meetins on...</string>
    </dict>
    <dict>
        <key>cellName</key>
        <string>Sharon Lodge No. 327</string>
        <key>cellSubtitle</key>
        <string>McLean, VA</string>
        <key>address</key>
        <string>999 Balls Hill Road</string>
        <key>webSite</key>
        <string>www.website.com</string>
        <key>statedCom</key>
        <string>Hold meetins on...</string>
    </dict> 
```

.h 用于 DVC

```
#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController

@property (strong, nonatomic) IBOutlet UILabel *address;
@property (strong, nonatomic) IBOutlet UILabel *webSite;
@property (strong, nonatomic) IBOutlet UILabel *statedCom;
@property (nonatomic, copy) NSDictionary *contactInfo; // added this 

@end 
```

.h 用于桌面视图

```
#import <UIKit/UIKit.h>

@interface plistTableViewController : UITableViewController
{
    NSArray *tabledata;
}

@end 
```

.M 表视图

```
#import "plistTableViewController.h"
#import "DetailViewController.h"
@interface plistTableViewController ()

@end

@implementation plistTableViewController

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{

    NSString *mylist = [[NSBundle mainBundle] pathForResource:@"lodges" ofType:@"plist"];
    tabledata = [[NSArray alloc]initWithContentsOfFile:mylist];
    NSLog(@"%@", tabledata);
    [super viewDidLoad];

   }

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{

    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.
    return [tabledata count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];

    if( cell == nil )
    {
        NSLog(@"Cell Creation");
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"Cell"];
    }

    //Set Data For each Cell
    cell.textLabel.text = [[tabledata objectAtIndex:indexPath.row]objectForKey:@"cellName"];
    cell.detailTextLabel.text = [[tabledata objectAtIndex:indexPath.row]objectForKey:@"cellSubtitle"];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
}

-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{ 
```

添加了这个 NSIndexPath *indexPath = [[self tableView] indexPathForSelectedRow]; NSDictionary *contactInfo = tabledata[indexPath.row]; DetailViewController *dvc = (DetailViewController *)[segue destinationViewController]; dvc.contactInfo = 联系人信息；dvc.address = [[tabledata objectAtIndex:@"address"]]; // 这是错误的，但不确定如何正确编写。

```
} 
```

.m 到 dvc

```
#import "DetailViewController.h"

@interface DetailViewController ()

@end

@implementation DetailViewController

@synthesize address,webSite,statedCom;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{

    self.address =[[tabledata objectAtIndex:address]]; // not sure how to complete this

    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:43:00.970

对您的设计做出一些假设 - 但我认为您想要执行以下操作：

在要表示的模型对象的详细视图控制器上实现一个属性。由于您使用的是内置集合类`NSArray`并且`NSDictionary`直接来自属性列表，我怀疑详细视图控制器上的属性将类似于：`@property (nonatomic, copy) NSDictionary
*contactInfo;`

在方法中的详细视图控制器上设置此属性 `prepareForSegue:sender:`。您需要从选定的索引路径中获取适当的字典，如下所示：

```
NSIndexPath *indexPath = [[self tableView] indexPathForSelectedRow];
NSDictionary *contactInfo = tabledata[indexPath.row];
DetailViewController *dvc = (DetailViewController *)[segue destinationViewController];
dvc.contactInfo = contactInfo; 
```

然后在该方法中，您可以将 UI 元素设置为您需要`DetailViewController` `viewDidLoad`的任何条目。`NSDictionary` `self.contactInfo`

# php - MySql 语法错误？

> ID：14086843
> 
> 赞同：0
> 
> 时间：2012-12-29T23:27:42.767
> 
> 标签：php, mysql

我收到此错误错误：`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'to, from, message, read) VALUES ('3','2','testmessage','0')' at line 1.`

我已经在这里待了几个小时，但在 SO 或任何其他站点都没有发现任何东西。提前感谢您的帮助。下面是一个简单的消息系统文件。

```
<?php
session_start();
$id = $_SESSION['id'];
$msg = $_POST['message'];
$theirs = $_POST['value'];
$read = 0;

$con = mysql_connect("127.0.0.1","root","");
mysql_select_db("test", $con);
if (!$con)
  die('Could not connect: ' . mysql_error());

$sql = "INSERT INTO  messages (to, from, message, read) VALUES ('$theirs','$id','$msg','$read')";

if (!mysql_query($sql,$con))
  die('Error: ' . mysql_error());

mysql_close($con); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:38:11.767

`to`,`from`和`read`是MySQL 中的[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。用反引号引用它们

```
INSERT INTO  messages (`to`, `from`, `message`, `read`) VALUES ('$theirs','$id','$msg','$read') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:39:54.947

`from`,`to`和`read`是 MySQL 的保留字。最好不要将它们用作列名（否则必须将它们括在反引号中），而是使用其他列名。

代替`from`你可以使用`sender`，并使用`recipient`代替`to`。也`read`换成`is_read`，你很好。

# php - 使用 X 和 Y 坐标在地图上查找相邻的六边形图块

> ID：14086845
> 
> 赞同：2
> 
> 时间：2012-12-29T23:27:55.780
> 
> 标签：php, distance, hexagonal-tiles

我一直在努力解决这个问题——所以我真的必须寻求帮助。

我创建了一个基于 CSS 的游戏地图，它以 Hexagon Tiles 的形式覆盖 DIV（如桌面游戏）。我正在尝试查找与当前活动图块相邻的图块。

我已经能够从左上角到右下角依次生成地图的 ID，并为每个图块分配坐标。从那里我使用勾股定理来计算 2 个 X&Y 坐标之间的距离（这花了我一段时间才弄清楚）。事情实际上非常接近，但问题是因为六角瓷砖地图本质上是“交错的”（例如，它不是方形网格并且两个相邻的瓷砖不在同一条确切的水平线上），当我计算距离时，一些瓷砖这实际上是 2 步之遥，数学上比相邻的瓷砖更近。

我已经展示了我构建的东西，所以你可以准确地看到我在说什么。

[http://www.pitashi.com/map/index.php](http://www.pitashi.com/map/index.php)

如果您单击任何图块，它将刷新页面并在您的“当前位置”上放置一个标志。然后每个图块显示坐标和计算出的与当前位置的距离。如果您四处点击，您会看到许多不与当前位置接壤的图块距离更近。

## 代码：

```
// load the map DIV tags (90 tiles)

if (isset($_GET['x'])) {
    $gl_map_x = $_GET['x'];
} else $gl_map_x = 0;

if (isset($_GET['y'])) {
    $gl_map_y = $_GET['y'];
} else $gl_map_y = 0;

if (isset($_GET['mapid'])) {
    $gl_map_id = $_GET['mapid'];
} else $gl_map_id = 42;                         

$i = 1;
$x = 0;
$y = 0;
while ($i <= 90) {
echo "<div class='hexagon hexagon" . $i . "' onclick=\"window.location=('index.php?mapid=". $i . "&x=" . $x . "&y=" . $y . "')\"><div class='hexagon-in1'>";
    echo "<div class='hexagon-in2'>";
        if ($i == $gl_map_id) { 
            echo "<img class='hexstar" . $i . "' src='images/map_star1.png' />";
        } 

        $distance = round(sqrt(pow($gl_map_x - $x, 2) + pow($gl_map_y - $y, 2)), 2);                                        
        echo "<div style='color:#ffffff; padding-left:48px; padding-top:30px;'>" . $x . ", " . $y . "<br />" . $distance . "</div>";
        //echo "<div style='color:#ffffff; font-weight:bold; padding-left:48px; padding-top:30px;'>" . $distance . "</div>";
        //echo "<div style='color:#ffffff; padding-left:48px; padding-top:30px;'>" . $i . "</div>";                                         

    echo "</div></div></div>";
    $i++;
    $x = $x + 63;
        if ($x > 756) { 
            $x = 63;
            $y = $y + 54;
        } elseif ($y == 432) {
            $x = $x + 63;
        }
}

?> 
```

* * *

我知道我必须使用一些额外的数学来补偿瓷砖的交错，但我在这方面的工资等级已经超出了我的水平。但是这个功能对于我的小 RPG 游戏来说是必不可少的。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:11:50.133

没有草图有点难以解释，但我认为解决方案相当简单。六边形的 x 坐标没问题，但 y 坐标的一半需要校正。当我单击上面的链接时，标记的六边形的坐标为 x= 315，y=162。此列中所有单元格的 y 坐标需要增加 27。因此，y 坐标应为 189，而不是 162。对于正上方的单元格，y 坐标。应从 108 更改为 135。在该单元格上方增加 y 坐标。从 54 到 81，依此类推。需要每隔一列进行这种更改，即所有六边形高度与我们刚刚讨论的列完全相同的列。如果您进行此更改，毕达哥拉斯计算可以让您测试相邻的单元格，因为它将产生六边形中心之间的距离。希望有帮助。祝你游戏好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:48:47.923

您可以使用 XY 平面中的欧几里得距离。

两个点 P1(x1, y1) 和 P2(x2, y2) 之间的距离由下式给出：

```
sqrt( (y1-x1)^2 + (y2-x2)^2 ) 
```

如果您不关心实际距离，而只关心最近的点，则不应取平方根，而应仅使用：

```
(y1-x1)^2 + (y2-x2)^2 
```

因为它是一个整数表达式（而不是浮点数），所以它更快、更准确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T23:48:57.273

你走错路了，将板概念化为页面上的一系列列。

```
{[0][0], NULL , [2][0]}
{ NULL ,[1][1],  NULL }
{[0][1], NULL , [2][1]}
{ NULL ,[1][2],  NULL }
{[0][2], NULL , [2][2]}
{ NULL ,[1][3],  NULL }
//The nulls are just to make it clearer feel free to optimize. 
```

很明显，我们有一个用 NULL 填充的参差不齐的 2D 空间数组来表示交错，如果我们想获得与 [0][2] 相邻的空间，我们会知道它们是

[0,1],[1,1],[2,1],[0,2],[2,2],[1,3]

# css - 标签悬停，活动和访问不起作用

> ID：14086846
> 
> 赞同：0
> 
> 时间：2012-12-29T23:28:18.177
> 
> 标签：css, hover

我在一些文本周围放了一个标签，并给它一个ID“主页”。然后我为“主页”添加 CCS，但不知何故，悬停、活动和访问效果根本没有显示。我在定义它们时做错了什么吗？我是一个新手，很困惑......请帮忙！

```
#mainpage {
    color: white; 
    text-decoration: none; 
    font-family: Georgia;
    font-size: 100px;
    color: white; 
    text-shadow: 0px 0px 1px white; 

}

#mainpage a:hover{
    color: yellow; 
    text-decoration: none; 
    font-family: Georgia;
    font-size: 100px;
    color: white; 
    text-shadow: 0px 0px 1px yellow; 
}

#mainpage a:active {
    color: yellow; 
    text-decoration: none; 
    font-family: Georgia;
    font-size: 100px;
    color: white; 
    text-shadow: 0px 0px 1px yellow; 
}

#mainpage a:visited {
    color: white; 
    text-decoration: none;
    font-family: Georgia;
    font-size: 100px;
    color: white; 
    text-shadow: 0px 0px 1px white;  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:30:08.517

更改`#mainpage a:hover`为`a#mainpage:hover`，然后重复其余部分（已访问，等等...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:34:26.727

试试这个...

`#mainpage:hover`对所有其他人也是如此……

这可能有效...

# c# - 我如何将时差解析为这样的字符串

> ID：14086847
> 
> 赞同：-4
> 
> 时间：2012-12-29T23:28:27.240
> 
> 标签：c#, string, parsing, datetime, datetime-format

我想解析 2 DateTime 差异，如下所示：

```
312 Days 21 Hours 16 Minutes 5 Seconds // there is difference > days
21 Hours 16 Minutes 5 Seconds // there is difference > hours
16 Minutes 5 Seconds // there is difference > minutes
5 Seconds // there is difference < minutes 
```

因此，如果天数以上有差异，它将解析天数，如果小时数以上有差异，它将解析小时数，依此类推。如果有不同年份，我仍然希望它解析为天数（天数差异 +（365*year））

C# 对此有什么功能吗？

```
DateTime dt1
DateTime dt2

TimeSpan span = dt1- dt2; 
```

并按上述方式解析 TimeSpan（2 个 DateTimes 之间的差异）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:04:42.553

这可能会有所帮助：

```
string[] formats = {
  "d' Days 'h' Hours 'm' Minutes 's' Seconds'",
  "h' Hours 'm' Minutes 's' Seconds'",
  "m' Minutes 's' Seconds'",
  "s' Seconds'",
  "d' Days 'h' Hours 'm' Minutes'",
  "d' Days 'h' Hours 's' Seconds'",
  "d' Days 'm' Minutes 's' Seconds'",
  "h' Hours 'm' Minutes'",
  "h' Hours 's' Seconds'",
  };

var result = TimeSpan.ParseExact(yourString, formats, CultureInfo.CurrentCulture); 
```

`TryParseExact`如果您担心`yourString`有时可能是非法的，还有。有关详细信息，请参阅[自定义 TimeSpan 格式字符串](http://msdn.microsoft.com/en-us/library/ee372287.aspx)。

**编辑：** Asker 澄清说他确实想要“格式化”，而不是“解析”，所以我的回答可能不相关。不知道这个答案还有什么问题。

现在，这是一个（未经测试的）解决方案。零部分被删除，不仅在最重要的部分为零时，而且在“中间”( `01:00:01`) 中的零部分也是如此。语法（复数和单数）应该没问题。中间和末端的空格应该是正确的。放入`static`类（扩展方法）：

```
public static string ToMyString(this TimeSpan ts)
{
  if (ts < TimeSpan.Zero)
    throw new ArgumentOutOfRangeException();

  var parts = new List<string>();
  AddPart(parts, ts.Days, "Day");
  AddPart(parts, ts.Hours, "Hour");
  AddPart(parts, ts.Minutes, "Minute");
  AddPart(parts, ts.Seconds, "Second");

  if (parts.Count == 0)
    return "0";

  return string.Join(" ", parts);
}

static void AddPart(List<string> parts, int number, string name)
{
  if (number == 1)
    parts.Add("1 " + name);
  else if (number > 1)
    parts.Add(string.Format("{0} {1}s", number, name));        
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:09:46.553

这比预期的要困难：

```
List<string> timespanStrings = new List<string>() { 
    "312 Days 21 Hours 16 Minutes 5 Seconds", "21 Hours 16 Minutes 5 Seconds",
    "16 Minutes 5 Seconds", "5 Seconds"
};
List<TimeSpan> timespans = new List<TimeSpan>();
foreach (string tsString in timespanStrings)
{
    List<Tuple<int, string>> pairs = new List<Tuple<int, string>>();
    var tokens = tsString.Split();
    if (tokens.Length % 2 == 0)
    {
        int duration;
        for (int i = 0; i < tokens.Length; i += 2)
        {
            string dur = tokens[i];
            string unit = tokens[i + 1];
            if (int.TryParse(dur, out duration))
            {
                pairs.Add(Tuple.Create(duration, unit));
            }
            else // invalid string
                break;
        }
    }

    // create the TimeSpan from the pair
    switch (pairs.Count)
    {
        case 4:  // days
            {
                var dayPair = pairs.First(p => p.Item2.Equals("Days", StringComparison.OrdinalIgnoreCase));
                TimeSpan ts = TimeSpan.FromDays(dayPair.Item1);
                var hourPair = pairs.First(p => p.Item2.Equals("Hours", StringComparison.OrdinalIgnoreCase));
                TimeSpan tsHour = TimeSpan.FromHours(hourPair.Item1);
                var minPair = pairs.First(p => p.Item2.Equals("Minutes", StringComparison.OrdinalIgnoreCase));
                TimeSpan tsMin = TimeSpan.FromMinutes(minPair.Item1);
                var secPair = pairs.First(p => p.Item2.Equals("Seconds", StringComparison.OrdinalIgnoreCase));
                TimeSpan tsSec = TimeSpan.FromSeconds(secPair.Item1);
                ts = ts + tsHour + tsMin + tsSec;
                timespans.Add(ts);
                break;
            }
        case 3:  // hours
            {
                var hourPair = pairs.First(p => p.Item2.Equals("Hours", StringComparison.OrdinalIgnoreCase));
                TimeSpan ts = TimeSpan.FromHours(hourPair.Item1);
                var minPair = pairs.First(p => p.Item2.Equals("Minutes", StringComparison.OrdinalIgnoreCase));
                TimeSpan tsMin = TimeSpan.FromMinutes(minPair.Item1);
                var secPair = pairs.First(p => p.Item2.Equals("Seconds", StringComparison.OrdinalIgnoreCase));
                TimeSpan tsSec = TimeSpan.FromSeconds(secPair.Item1);
                ts = ts + tsMin + tsSec;
                timespans.Add(ts);
                break;
            }
        case 2:  // minutes
            {
                var minPair = pairs.First(p => p.Item2.Equals("Minutes", StringComparison.OrdinalIgnoreCase));
                TimeSpan ts = TimeSpan.FromMinutes(minPair.Item1);
                var secPair = pairs.First(p => p.Item2.Equals("Seconds", StringComparison.OrdinalIgnoreCase));
                TimeSpan tsSec = TimeSpan.FromSeconds(secPair.Item1);
                ts = ts + tsSec;
                timespans.Add(ts);
                break;
            }
        case 1:  // seconds
            timespans.Add(TimeSpan.FromSeconds(pairs[0].Item1));
            break;
        default: 
            break;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T23:58:45.410

```
public static string ToFullString(this TimeSpan timeSpan)
{
    return
        (timeSpan.Days > 0 ? timeSpan.Days + " Days" : "") +
        (timeSpan.Hours > 0 ? " " + timeSpan.Hours + "Hours " : "") +
        (timeSpan.Minutes > 0 ? " " + timeSpan.Minutes + "Minutes " : "") +
        (timeSpan.Seconds > 0 ? " " + timeSpan.Seconds + "Seconds" : "");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T00:06:25.173

如果您的输入如下：

```
312 Days 21 Hours 16 Minutes 5 Seconds 
```

答案是否定的。您必须自己解析字符串并初始化 DateTime 变量。[简单明了的 c# DateTime 教程](http://www.dotnetperls.com/datetime)。

初始化后，您可以轻松地在这些日期时间之间进行减法。[日期时间差异的链接](http://www.c-sharpcorner.com/UploadFile/DipalChoksi/DateDiff_CS_DC09132006172429PM/DateDiff_CS_DC.aspx)。

如果您想使用以前的样式再次打印出差异：

```
312 Days 21 Hours 16 Minutes 5 Seconds 
```

从 DateTimeDifference 中获取 Days、Month 等很容易，例如：

```
DateTime yourDateTime = foo;
int month = yourDateTime.Month; 
```

# ruby - Sinatra 中的 DataMapper 错误 - NameError: 找不到 child_model

> ID：14086848
> 
> 赞同：1
> 
> 时间：2012-12-29T23:28:28.283
> 
> 标签：ruby, sinatra, datamapper, ruby-datamapper

使用 Sinatra 和 DataMapper。这是我第一次尝试使用两个以上的模型类。不确定是什么导致了错误。谢谢。

错误：

```
NameError: Cannot find the child_model ContactNote for Contact in contact_notes 
```

型号：

```
class Contact
    include DataMapper::Resource
    property :id, Serial
    property :fullname, Text, :required => true
    property :email, Text
    property :phone, Text
    has n, :contact_notes
    has n, :projects
end

class Contact_Note
    include DataMapper::Resource
    property :id, Serial
    property :contact_content, Text, :required => true
    property :created_at, DateTime
    property :updated_at, DateTime
    belongs_to :contact
end

class Project
    include DataMapper::Resource
    property :id, Serial
    property :project_name, Text, :required => true
    property :created_at, DateTime
    property :updated_at, DateTime
    belongs_to :contact
    has n, :project_notes
end

class Project_Note
    include DataMapper::Resource
    property :id, Serial
    property :project_content, Text, :required => true
    property :created_at, DateTime
    property :updated_at, DateTime
    belongs_to :project
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T23:36:18.220

Datamapper 根据 ruby​​ 约定对类名做出预期。它希望您的联系笔记在一个`ContactNote`类中，而您已将其命名为`Contact_Note`，因此它无法找到 ContactNote 的错误。

# c++ - 获取 64 位整数内的位位置数组

> ID：14086854
> 
> 赞同：14
> 
> 时间：2012-12-29T23:28:55.327
> 
> 标签：c++, c, 64-bit, bit-manipulation, bits

好的，这听起来可能有点复杂，但这是我想要做的：

*   以例如`10101010101`
*   并返回`{ 0, 2, 4, 6, 8, 10 }`- 一个包含所有已设置位位置的数组

这是我的代码：

```
UINT DQBitboard::firstBit(U64 bitboard)
{
    static const int index64[64] = {
    63,  0, 58,  1, 59, 47, 53,  2,
    60, 39, 48, 27, 54, 33, 42,  3,
    61, 51, 37, 40, 49, 18, 28, 20,
    55, 30, 34, 11, 43, 14, 22,  4,
    62, 57, 46, 52, 38, 26, 32, 41,
    50, 36, 17, 19, 29, 10, 13, 21,
    56, 45, 25, 31, 35, 16,  9, 12,
    44, 24, 15,  8, 23,  7,  6,  5  };

    static const U64 debruijn64 = 0x07EDD5E59A4E28C2ULL;

    #pragma warning (disable: 4146)
    return index64[((bitboard & -bitboard) * debruijn64) >> 58];  
}

vector<UINT> DQBitboard::bits(U64 bitboard)
{
    vector<UINT> res;

    while (bitboard)
    {
        UINT first = DQBitboard::firstBit(bitboard);
        res.push_back(first);

        bitboard &= ~(1ULL<<first);
    }

    return res;
} 
```

并且代码确实**有效**。

我的观点是：

*   您有什么更快的实施方案吗？
*   你注意到有什么可以优化的吗？如果是这样，是什么？

* * *

**提示：**

*   `UINT`是一个 typedef`unsigned int`
*   `U64`是一个 typedef`unsigned long long`
*   两种方法都是`static inline`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T00:05:29.077

这是另一个可以分析的建议（可以与其他建议结合以进行进一步优化）。注意，这里的循环是`O(number of set bits)`.

```
vector<UINT> bits_set (UINT64 data) 
{
    UINT n;
    vector<UINT> res;
    res.reserve(64);
    for (n = 0; data != 0; n++, data &= (data - 1))
    {
        res.push_back(log2(data & ~(data-1)));
    }
    return res;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-29T23:42:05.477

位移真的很便宜。查找表需要缓存空间，并且您的查找也有整数乘法。我预计，只是蛮力会比聪明的技术更快。

```
vector<UINT> DQBitboard::bits(U64 bitboard)
{
    vector<UINT> res;
    res.reserve(64);
    uint_fast8_t pos = 1;

    do {
        if (bitboard & 1) res.push_back(pos);
        ++pos;
    } while (bitboard >>= 1);

    return res;
} 
```

您可以稍微展开循环，这可能会使其更快。

这`std::vector`是迄今为止最昂贵的部分。考虑直接使用位板。例如：

```
struct bitboard_end_iterator{};
struct bitboard_iterator
{
    U64 value;
    uint_fast8_t pos;

    bitboard_iterator(U64 bitboard) : value(bitboard), pos(0)
    {
        ++(*this);
    }
    UINT operator*() const { return pos + 1; }
    bool operator==( bitboard_end_iterator ) const { return pos == 64; }
    operator bool() const { return pos < 64; }
    bitboard_iterator& operator++()
    {
        while (U64 prev = value) {
            value >>= 1;
            ++pos;
            if (prev & 1) return *this;
        }
        pos = 64;
        return *this;
    }
}; 
```

现在你可以写

```
for( bitboard_iterator it(bitboard); it; ++it )
    cout << *it; 
```

我想你会得到你的比特清单。

版本 2：

```
class bitboard_fast_iterator
{
    U64 value;
    uint_fast8_t pos;

public:
    bitboard_fast_iterator(U64 bitboard = 0) : value(bitboard), pos(__builtin_ctzll(value)) {}
    UINT operator*() const { return pos + 1; }
    operator bool() const { return value != 0; }
    bitboard_iterator& operator++()
    {
        value &= ~(1ULL << pos);
        pos = __builtin_ctzll(value);
        return *this;
    }
}; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-30T02:22:24.510

我一直想知道使用 bst 汇编指令是否会更快。所以我尝试了 3 次实现，并在 1000 万次迭代中得到了以下结果：

你的实现 (Dr.Kameleon) 1.77 秒

log2() 实现 (icepack) 2.17 秒

我的组装实现（我）0.16秒

输出：

```
bits version:
Function started at 0
           ended at 177
              spent 177 (1.770000 seconds)
c version:
Function started at 177
           ended at 394
              spent 217 (2.170000 seconds)
c version:
Function started at 394
           ended at 410
              spent 16 (0.160000 seconds) 
```

关于 C/C++ 的一点，静态是可怕的。它实际上是在 CPU 指令列表中编译的（也不是我所期望的！！！）相反，在函数之外的无名命名空间中使用数组。这将产生预期的效果。尽管在汇编中您可以使用 .long （或其他大小）然后 %rip 来引用来自 IP 的数据。

注意：编译后，我看不到我的程序集版本中使用的大小 (n)，所以我不太确定返回的数组是否有效。除此之外，代码本身变成了 5 个汇编指令的循环，因此速度有微小的提高（大约 x10）。

log2() 缓慢的原因是它将数字转换为 xmm 寄存器，然后调用另一个函数。然后它将 xmm 寄存器转换回常规寄存器。

```
#include <stdlib.h>
#include <stdio.h>
#include <inttypes.h>
#include <unistd.h>
#include <sys/times.h>
#include <string.h>
#include <math.h>
#include <vector>

using namespace std;

namespace
{
const int index64[64] = {
    63,  0, 58,  1, 59, 47, 53,  2,
    60, 39, 48, 27, 54, 33, 42,  3,
    61, 51, 37, 40, 49, 18, 28, 20,
    55, 30, 34, 11, 43, 14, 22,  4,
    62, 57, 46, 52, 38, 26, 32, 41,
    50, 36, 17, 19, 29, 10, 13, 21,
    56, 45, 25, 31, 35, 16,  9, 12,
    44, 24, 15,  8, 23,  7,  6,  5  };
const uint64_t debruijn64 = 0x07EDD5E59A4E28C2ULL;
}

int firstBit(uint64_t bitboard)
{
    return index64[((bitboard & -bitboard) * debruijn64) >> 58];  
}

vector<int> bits(uint64_t bitboard)
{
    vector<int> res;
    res.reserve(64);

    while(bitboard)
    {
        int first = firstBit(bitboard);
        res.push_back(first);

        bitboard &= ~(1ULL << first);
    }
    return res;
}

vector<int> bits_c(uint64_t bitboard)
{
    int n;
    vector<int> res;
    res.reserve(64);
    for (n = 0; bitboard != 0; n++, bitboard &= (bitboard - 1))
    {
        res.push_back(log2(bitboard & ~(bitboard - 1)));
    }
    return res;
}

vector<int> bits_asm(uint64_t bitboard)
{
    int64_t n(0);
    int res[64];
    asm(
    "bsf %[b], %%rax\n\t"
    "je exit\n\t"
    ".align 16\n"
"loop:\n\t"
    "mov %%eax, (%[r],%[n],4)\n\t"
    "btr %%rax, %[b]\n\t"
    "inc %[n]\n\t"
    "bsf %[b], %%rax\n\t"
    "je loop\n"
"exit:\n\t"
    : /* output */ "=r" (n)
    : /* input */ [n] "r" (n), [r] "r" (res), [b] "r" (bitboard)
    : /* state */ "eax", "cc"
    );
    return vector<int>(res, res + n);
}

class run_timer
{
public:
    run_timer()
    {
    }

    void start()
    {
        times(&f_start);
    }

    void stop()
    {
        times(&f_stop);
    }

    void report(const char *msg)
    {
        printf("%s:\n"
               "Function started at %ld\n"
               "           ended at %ld\n"
               "              spent %ld (%f seconds)\n",
               msg,
               f_start.tms_utime,
               f_stop.tms_utime,
               f_stop.tms_utime - f_start.tms_utime,
               (double)(f_stop.tms_utime - f_start.tms_utime)/(double)sysconf(_SC_CLK_TCK));
    }

    struct tms f_start;
    struct tms f_stop;
};

int main(int argc, char *argv[])
{
    run_timer t;

    t.start();
    for(int i(0); i < 10000000; ++i)
    {
        bits(rand());
    }
    t.stop();
    t.report("bits version");

    t.start();
    for(int i(0); i < 10000000; ++i)
    {
        bits_c(rand());
    }
    t.stop();
    t.report("c version");

    t.start();
    for(int i(0); i < 10000000; ++i)
    {
        bits_asm(rand());
    }
    t.stop();
    t.report("c version");

    return 0;
} 
```

使用以下命令行使用 g++ 编译：

```
c++ -msse4.2 -O2 -o bits -c bits.cpp 
```

尽管您可能认为 -msse4.2 可能是 log2() 版本的问题，但我尝试不使用它，然后 log2() 速度较慢。

顺便说一句，我不推荐这种方法，因为它不可移植。只有基于 Intel 的计算机才能理解这些指令。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-30T00:36:04.290

使用or指令将您的`firstBit`函数替换为内部函数，以实现大幅加速。`BSF``BSR`

在 gcc 中，它是`__builtin_ffsll`和`__builtin_ctzll`

使用 Visual C+，`_BitScanForward`以及`_BitScanReverse`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-29T23:33:11.213

我现在能想到的最快的方法是使用预先生成的~~`map`~~所有数字的数组（它不必是所有数字，例如，您可以将数字分解为 8 位或 16 位部分，然后将返回的数组与一些适当的添加连接起来，以说明位的实际位置）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-12-29T23:36:34.433

```
const size_t size = sizeof(U64)*8;
U64 val = 1;

vector<UINT> res;
res.reserve(size);

for ( size_t i = size; i > 0; --i ) {
  if ( ( val & bitboard ) != 0 ) {
    res.push_back(i);
  }
  val <<= 1;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-12-29T23:46:28.343

我尝试了一个简单的版本，它的时钟速度快了大约 2-3 倍，但首先保留了向量。在将保留应用于原始算法时，它击败了天真的算法。

所以我怀疑向量操作在这里是更大的成本，而不是位操作（甚至是下一位函数中使用的乘法）。

关于找到最低设置位，还有一些其他的加速。我本地的log2版本很差，原帖给出的功能也不是超级便宜。

这是我最好的尝试：

```
void bits(uint64 bitboard, vector<int> &res)
{
    res.resize(64);
    int i = 0;
    while (bitboard)
    {
        int first;
        _BitScanForward64((DWORD *)&first, bitboard);
        res[i++] = first;
        bitboard &= ~(1ULL<<first);
    }
    res.resize(i);
} 
```

用 asm 内在函数替换了 firstBit 函数。使用内在函数在这里得到了很大的推动。（这显然不是可移植的代码，尽管我怀疑 GCC 变体不应该太棘手）。

还假设向量是合理持久的，而不是一直动态分配/复制，并且只是适当地调整它的大小。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-12-29T23:46:54.397

我实际上认为最快、最简单的方法就是简单地循环，但如果我们传入一个向量而不是稍后制作一个副本，它应该会快一点。

```
void DQBitboard::bits(U64 bitboard, vector<UINT> &res)
{
    res.clear();   // Make sure vector is empty. Not necessary if caller does this!
    int bit = 0;
    while (bitboard)
    {
        if (bitboard & 1) 
            res.push_back(bit);
        bit++;
        bitboard >>= 1;
    }

    return res;
} 
```

findfirst 中的乘法会花费一点，所以我怀疑它是否真的值得。

# objective-c - 如何让在 IB 中创建的自定义 UITableViewCell 类加载到 UITableView 中？

> ID：14086855
> 
> 赞同：5
> 
> 时间：2012-12-29T23:28:58.137
> 
> 标签：objective-c, ios, uitableview

我是新手，所以请多多包涵：

我在 IB 中有一个 .xib，其中包含一个 UIScrollView，其中嵌入了一个 UITableView。我想将自定义 UITableViewCells 加载到 UITableView 中。我在 IB 中创建了四/五个自定义单元格，但无法正确加载第一个单元格。

以下是来自 IB 的相关截图：

![.xib](../Images/4c7c1b839fea1e6cd16ebea54ee08784.png) ![自定义单元格](../Images/2b15b4a1fd30af9d015f178a414628e3.png)

我已将在 IB 中创建的自定义 UITableViewCell 的类设置为我创建的名为“itemCell”的 UITableView 类。此外，我已将三个文本字段出口和代表连接到“itemCell”。

这是 itemCell.h：

```
#import <UIKit/UIKit.h>

@interface itemCell : UITableViewCell
@property (weak, nonatomic) IBOutlet UITextField *quantityTextField;
@property (weak, nonatomic) IBOutlet UITextField *itemTextField;
@property (weak, nonatomic) IBOutlet UITextField *priceTextField;

@end 
```

这是 itemCell.m：

```
#import "itemCell.h"

@implementation itemCell
@synthesize quantityTextField,itemTextField,priceTextField;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code

    }
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

@end 
```

在作为根控制器 .xib 的实现文件的 filecontroller.m 中，我根据用户按下按钮（将其添加到数组中）创建一个新单元格，然后重新加载 tableview。我没有收到任何错误，但我正在加载一个正常的单元格，而不是我在 IB 中创建的单元格。这是rootcontroller.m。任何帮助表示赞赏。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    scrollView =(UIScrollView *)self.view;
    items = [[NSMutableArray alloc] init];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [items count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
        return [items objectAtIndex:[indexPath row]];
}

- (UITableViewCell *)initiateNewCell{
    itemCell *cell = [[itemCell alloc] init];
    cell.accessoryType = UITableViewCellAccessoryNone;
    cell.selectionStyle = UITableViewCellSelectionStyleBlue;
    return cell;
}

- (IBAction)addItem:(id)sender {
    //creates the new cell to be added
    [items addObject:[self initiateNewCell]];
    [self.tableView reloadData]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T03:46:56.680

从 iOS 5 开始，您现在可以使用以下函数从 nib 加载 UITableViewCell 以进行单元重用。

**- (void)registerNib:(UINib *)nib forCellReuseIdentifier:(NSString *)identifier**

1.  首先确保您创建一个仅包含 UITableViewCell 的 IB 文件
2.  在识别检查器下：将 UITableViewCell 的类设置为“itemCell” ![在此处输入图像描述](../Images/37cd3e2babe1446426b8c9c9872f1513.png)
3.  在属性检查器下：将 UITableViewCell 的标识符设置为“itemCellIdentifier” ![在此处输入图像描述](../Images/265911fb564e0432bdf8eadcd164eda1.png)
4.  在 viewDidLoad: 中放置以下代码，并将 itemCellNibName 替换为包含 UITableViewCell 的 nib 的名称。

    ```
    NSString *myIdentifier = @"itemCellIdentifier";
    [self.tableView registerNib:[UINib nibWithNibName:@"itemCellNibName" bundle:nil] forCellReuseIdentifier:myIdentifier]; 
    ```

5.  在 cellForRowAtIndexPath: 中放置以下代码，您现在可以访问您在 itemCell 上设置的 IBOutlet 属性，并在 nib 中连接。

    ```
    -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath
    {
         static NSString *myIdentifier = @"itemCellIdentifier";

         itemCell *cell = (itemCell *)[tableView dequeueReusableCellWithIdentifier:myIdentifier];
         cell.textLabel.text = [NSString stringWithFormat:@"Test Row:%i!",indexPath.row];
         return cell;
    } 
    ```

另外：您不想将 UITableView 包含在 UIScrollView 中，UIScrollView 已经内置到 UITableView 中，它允许正确的单元格排队。

另外：我建议您在开始从数组中提取数据之前先了解这一点。

```
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
         return 10;
    } 
```

另外：正如其他人所提到的，该数组包含将填充 UITableViewCells 的数据，而不是实际的单元格本身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T23:50:06.307

在你的

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    //This identifier string needs to be set in cell of the TableViewController in the storyboard
    static NSString *CellIdentifier = @"Cell";

    // Resuse the cell
    SomeCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // If there are no cell to be reused we create a new one
    if(cell == nil) {
        cell = [SomeCustomCell new];
    }

    // Configure the cell...
    NSString *someString = [yourArrayWithStringsOrWhatEver objectAtIndex:indexPath.row];

    // Setting the some property of your custom cell
   [cell.yourSpecificCellProperty someString];

   [cell.yourOtherSpecificCellProperty setText:@"What Ever your want!"];
} 
```

您的单元格的属性可以是您在界面构建器中连接到您的自定义单元格的任何内容。

希望能帮助到你！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T23:50:56.650

那么有几件事是不对的：

*   类名以大写字母开头`itemCell`->`ItemCell`
*   您应该重复使用该单元格。按照您想要的方式，您将为每个索引路径创建一个单独的单元格。
*   该`items`数组应该只包含您的表格的数据源，而不是您的单元格
*   无需调用重新加载数据，您可以只向表格添加一行，并且它也可以动画化

尝试类似：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    scrollView =(UIScrollView *)self.view;
    items = [[NSMutableArray alloc] init];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [items count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (!cell) {
        cell = [[NSBundle mainBundle] loadNibNamed:@"itemCell" owner:self options:nil].lastObject;
        cell.reuseIdentifier = CellIdentifier;
    }

    // Do any additional setup to the cell

    return cell;
}

- (IBAction)addItem:(id)sender {
    [items addObject:[NSNumber numberWithInt:items.count]]; // Here comes the data source
    [self.tableView insertRowsAtIndexPaths:@[[NSIndexPath indexPathForRow:items.count - 1 inSection:0]] withRowAnimation:UITableViewRowAnimationAutomatic];
} 
```

PS：我是在没有IDE的情况下写的，所以可能会有一些错误

# jquery - JQuery 对话框在按钮旁边打开

> ID：14086856
> 
> 赞同：4
> 
> 时间：2012-12-29T23:29:03.793
> 
> 标签：jquery, html

如何定位一个 jquery 对话框，以便在单击时在按钮***旁边打开？***（有点像下拉菜单）

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T23:37:20.813

这是按钮点击事件

```
$('#myButton').click(function() {
  var x = $("#myButton").offset().left;
  var y = $("#myButton").offset().top;
  x += 100; // or whatever size of your button
  $('#myDialog').dialog({ position: { x,y}});
}); 
```

在[Dialog Docs](http://api.jqueryui.com/dialog/#option-position)中也有相对于另一个元素进行定位的能力，例如这个。

```
$( ".selector" ).dialog( "option", "position", { my: "left top", at: "left bottom", of: button } 
```

任何一个都可以，但第一个示例向您展示了如何实际获取被单击按钮的坐标，然后在它旁边设置一个对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:37:38.820

感谢您的回答，哦，天哪！

在这里为所有其他人：

```
$('#dialog').dialog({
  position: { 
    my: 'top',
    at: 'top',
    of: $('#some_div')
  }
}); 
```

# django - 如何防止从 CelerySearchIndex 索引内容

> ID：14086870
> 
> 赞同：1
> 
> 时间：2012-12-29T23:30:24.263
> 
> 标签：django, django-haystack, django-celery

我有一个部分看起来像这样的模型：

```
class Content(models.Model):
    published = models.BooleanField(default=False)
    public = models.BooleanField(default=False) 
```

我的搜索索引继承自 CelerySearchIndex：

```
class ContentIndex(celery_haystack_indexes.CelerySearchIndex, indexes.Indexable): 
```

当`SearchIndex`被调用时`Content.save()`，我*不*希望将此内容编入索引。我预计我网站上未发布的内容会经过大量修改，因此浪费对 Solr 的调用会对性能造成巨大影响。但是，文档中的任何内容似乎都不起作用。

我试过了：

```
def should_update(self, content):
    if content.published and content.public:
        return True
    return False 
```

我也尝试连接到`update_object()`.

在这两种情况下，任何一个例程都没有被调用。

有人知道怎么做吗？？？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:30:19.373

根据[文档](https://django-haystack.readthedocs.org/en/latest/searchindex_api.html#SearchIndex.should_update)，您的方法签名中似乎缺少传递给 should_update 的 **kwargs 。也许尝试添加？

# android - Intellij 减速，经常达到最大堆大小，然后提示退出

> ID：14086875
> 
> 赞同：2
> 
> 时间：2012-12-29T23:32:07.533
> 
> 标签：android, macos, intellij-idea

IntelliJ 慢到爬行。键之间没有 1-2 延迟几乎不能打字。我已经更新了堆大小。我在我的 Macbook Pro 上运行大约 2GB RAM。自从它开始放缓。我到处增加堆大小无济于事，如下所示：

*   在 info.plist (mac)
*   当它提示由于最大堆而退出时
*   在 java 编译器的首选项下
*   安卓dx编译器

真的很沮丧，因为它以前从未对我这样做过。刚才，我几乎没有编写代码，主要是浏览网页，而 IntelliJ 达到了它的堆大小并提示退出。

有什么建议么？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:40:04.807

1.  检查您使用的是[最新版本](http://www.jetbrains.com/idea/download/index.html)或[EAP 版本](http://confluence.jetbrains.net/display/IDEADEV/IDEA+12+EAP)。
2.  重命名[以下文件夹](http://devnet.jetbrains.net/docs/DOC-181)以使用所有默认设置、清理缓存和无第三方插件开始：

    > ```
    > Settings: ~/Library/Preferences/IntelliJIdea12
    > Caches: ~/Library/Caches/IntelliJIdea12
    > Plugins: ~/Library/Application Support/IntelliJIdea12 
    > ```

3.  如果问题仍然存在，请[提交错误报告](http://youtrack.jetbrains.net/issues/IDEA)并将[CPU/内存快照上传到 FTP](http://devnet.jetbrains.net/docs/DOC-192)。将`idea.log`( `Help`| `Reveal Log in ...`) 附加到报告的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:13:52.650

关闭 Github（在设置 > 版本控制下）解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-12T00:30:52.543

我有一个类似的问题，增加 VM 不起作用，只是将症状延迟了一点，要解决它，我必须通过 File > InvalidateCaches/Restart 使缓存无效。

[https://www.jetbrains.com/help/idea/2016.1/cleaning-system-cache.html](https://www.jetbrains.com/help/idea/2016.1/cleaning-system-cache.html)

# android - 加速度计，用于检测想要将手机铃声模式更改为 Ringer_Mode_silent 的设备的移动

> ID：14086878
> 
> 赞同：0
> 
> 时间：2012-12-29T23:32:21.107
> 
> 标签：android, accelerometer, detection

***我有一个应用程序试图使用加速度计来检测想要将手机的振铃模式更改为 Ringer_Mode_silent 的设备的移动 ***我实现了检测到来电的服务，但我不明白如何更改模式当我移动设备时手机在后台，请我帮我实现这个应用程序。

公共类 MainActivity 扩展 Activity 实现 SensorEventListener{

```
 private SensorManager mSensorManager;
  private Sensor mAccelerometre;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
    mAccelerometre =   mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER)  

Button b1=(Button)findViewById(R.id.start);
Button b2=(Button)findViewById(R.id.stop);
b1.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        //Intent intent=new Intent(Main.this,ServiceReceiver.class);
          Intent serv = new Intent(MainActivity.this, ServiceBroadcast.class);
  startService(serv);       
    } 
```

});

```
 b2.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        //Intent intent=new Intent(Main.this,ServiceReceiver.class);
          Intent serv = new Intent(MainActivity.this, ServiceBroadcast.class);
          stopService(serv);

}

 public void onSensorChanged()(SensorEvent event) {
    float azimuth,pitch,roll;
    if(mSensorManager==SensorManager.Sensor_Accelerometer)
     {
    azimuth = event.values[0];
    pitch = event.values[1];
    roll = event.values[2];
    ((TextView)findViewById(R.id.azimuth)).setText("Axe x "+azimuth);
    ((TextView)findViewById(R.id.pitch)).setText("Axe y "+pitch);
    ((TextView)findViewById(R.id.roll)).setText("Axe z "+roll);
}
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T14:22:19.363

使用加速度计很容易进行简单的运动检测（模式检测很困难）只需使用 sqrt(x^2+y^2+z^2) -9.81) 即可，其中 x,y,z 是加速度计读数。与一些比较阈值并在跨越时更改您的配置文件模式。

笔记：

正如您在代码加速度计中提到的那样，不要给出方位角、滚动、俯仰角。

values[0]：x 轴上的加速度减去 Gx

values[1]：y 轴上的加速度减去 Gy

values[2]：z 轴上的加速度减去 Gz

# asp.net-mvc - 从内部视图获取路线名称？

> ID：14086880
> 
> 赞同：4
> 
> 时间：2012-12-29T23:33:01.163
> 
> 标签：asp.net-mvc, attributerouting

使用[属性路由](http://attributerouting.net/#route-names)，您可以定义路由名称。有没有办法从我的视图中获取使用的路线的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:25:53.270

根据[这个答案](https://stackoverflow.com/a/1083781/538387)，您可以使用：

```
@{ var x = ViewContext.RouteData.Values["Action"]; } 
```

获取路线数据。然后根据这篇帖子[的正确答案](https://stackoverflow.com/a/2330191/538387)：“ [How to get a custom attribute from object instance in C#](https://stackoverflow.com/q/2329738/538387) ”，就可以拉出属性了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:24:43.080

这听起来不是一个真正的好主意。您可能应该添加路由名称来查看数据或视图模型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-14T10:09:00.813

`MapMvcAttributeRoutes`有多个重载，需要一个参数来`IDirectRouteProvider`实现。该接口负责生成路由。此接口的默认实现是`DefaultDirectRouteProvider`. 创建一个自定义类，该类继承`DefaultDirectRouteProvider`并覆盖所需的方法，如`GetActionDirectRoutes`or `GetControllerDirectRoutes`。在此方法中，您将获得`RouteEntry`包含路线名称的内容。您可以将此名称添加到数据令牌。

# ruby-on-rails - 脚本头过早结束：媒体（与 :rails app deployment+passenger+ubuntu+apache 相关的问题）

> ID：14086883
> 
> 赞同：3
> 
> 时间：2012-12-29T23:34:10.807
> 
> 标签：ruby-on-rails, ruby, apache, passenger, linode

我只是设置了一个 linode 服务器并在其上部署了我的 rails 3 应用程序。它启动并运行。问题是一些图像没有显示在生产中。在本地它们完美地工作。我仔细检查了日志文件（production.log ) 但什么也没找到。然后我检查了服务器 error.log 文件。

```
[Sat Dec 29 22:54:14 2012] [error] [client 182.177.228.157] Premature end of script headers: media, referer: http://50.116.57.152/app?v=11&o=33

Check out http://50.116.57.152/app?v=11&o=33  for live demo. 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T07:15:22.237

我想通了。ImageMagick gem 没有安装在我的 linode 服务器上，我使用蜻蜓来获取图像，这就是错误来的原因请注意，如果您遇到问题，请仔细检查所有已安装的必需 gem。

其次，如果您安装了 ruby​​ 1.9.3p360，请记住它存在错误，因为请求渲染未完成。所以解决方案是从 p360 到 p327 的 ruby​​ 版本，如果您将乘客用作 Web 服务器，则重新安装它。将安装后乘客提供的 3 行复制到您的 apache2.cong 文件中。重新启动服务器，此错误不应再次发生。谢谢。

# button - Highstock - 按功能缩放

> ID：14086887
> 
> 赞同：2
> 
> 时间：2012-12-29T23:35:02.220
> 
> 标签：button, zooming, highstock

我正在使用 Highstock。是否有可能在 Java Script 中以编程方式执行缩放到全部按钮？或者是否有任何具有相同功能的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T10:20:12.293

可以通过捕获按钮事件并添加状态来实现。您应该只检查索引并设置适当的。

[http://jsfiddle.net/jGALb/](http://jsfiddle.net/jGALb/)

```
chart.rangeSelector.buttons[4].setState(2);
chart.rangeSelector.clickButton(4,4,true); 
```

# html - ` 是什么意思

> ID：14086897
> 
> 赞同：0
> 
> 时间：2012-12-29T23:36:50.293
> 
> 标签：html, internet-explorer

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:40:13.733

它是无效的 HTML，仅此而已（并且可能是作者的错误）。举这个最小的例子

```
</div>
<!doctype html>
<html>
<head>
<title>Test</title>
</head>
<body>
</body>
</html> 
```

通过[W3C HTML Validator](http://validator.w3.org/)产生以下错误：

> 第 1 行，第 6 列：在没有先看到文档类型的情况下看到结束标记。预期`<!DOCTYPE html>`。
> 第 1 行，第 6 列：杂散结束标记 div。
> 第 2 行，第 15 列：Stray doctype。

条件注释与它没有任何关系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T23:39:53.403

没有什么是有效的，很可能是一个错字或包含文件服务器端的意外输出。

这不是黑魔法或黑客攻击，而是 [is] 只是一个格式错误的文档。

# java - JDO - 使用相同的键持久化两个实体

> ID：14086900
> 
> 赞同：0
> 
> 时间：2012-12-29T23:37:03.710
> 
> 标签：java, google-app-engine, google-cloud-datastore, jdo

我正在开发一个 AppEngine 项目，并且我在 AppEngine 数据存储之上使用 JDO 来实现持久性。我有一个实体，它使用编码字符串作为键，还使用应用程序生成的键名（也是字符串）。我这样做是因为我的应用程序会经常从野外收集数据（可能会收集相同的东西）并尝试持久化它们。为了避免持久化几个本质上包含相同数据的实体，我决定对这些数据的一些属性进行哈希处理，以获得一致的键名（由于实体关系而不直接操作键）。现在的问题是，每当我计算我的哈希（键名）并尝试存储实体时，如果它已经存在于数据存储中，数据存储（或 JDO 或任何罪魁祸首）默默地覆盖数据存储中实体的属性，而不会引发任何异常。这会对应用程序产生严重影响，因为它会覆盖实体（我们用于排序）的时间戳（一个字段）。我怎样才能最好地解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T12:07:05.200

你需要做get-before-set（检查和设置或CAS）。

CAS 是并发的基本租户，它是并行计算的必要弊端。

无论如何，获取比套装便宜得多，因此它实际上可以为您省钱。

与其盲目写入数据存储区，不如先检索；如果实体不存在，则捕获异常并放置实体。如果确实存在，请在保存之前进行深入比较。如果没有任何改变，请不要坚持（并节省成本）。如果它发生了变化，请随意选择合并策略。维护过时修订的一种（略显丑陋）方法是将先前的实体作为字段存储在更新的实体中（可能不适用于许多修订）。

但是，在这种情况下，您必须在设置之前获得。如果您不希望有很多重复项并且想要真正的 chintzy，您可以先执行 exists 查询...这是对您要使用的键执行仅键计数查询（成本比完整获取低 7 倍）。if (count() == 0) then put() else getAndMaybePut() fi

计数查询语法可能看起来很慢，但从我的基准测试来看，它是判断实体是否存在的最快（也是最便宜）的方法：

```
public boolean exists(Key key){
    Query q;
    if (key.getParent() == null)
      q = new Query(key.getKind());
    else
      q = new Query(key.getKind(), key.getParent());
    q.setKeysOnly();
    q.setFilter(new FilterPredicate(
      Entity.KEY_RESERVED_PROPERTY, FilterOperator.EQUAL, key));
    return 1 == DatastoreServiceFactory.getDatastoreService().prepare(q)
      .countEntities(FetchOptions.Builder.withLimit(1));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T09:42:30.520

在 put() 新实体之前，您必须执行 get() 以查看是否存在具有相同键的实体。没有办法做到这一点。

您可以使用 memcache 和本地“内存中”缓存来加快 get() 操作。如果您可能多次阅读相同的信息，这可能会有所帮助。如果没有，memcache 查询实际上可能会减慢您的进程。

为确保两个请求不会相互覆盖，您应该使用事务（不可能使用 Ajax 建议的查询，除非您将所有项目放在一个实体组中，这可能会将您的更新限制为每秒 1 次）

在伪代码中：

1.  从散列数据创建密钥
2.  检查内存缓存中的键（使用 ConcurrentHashSet 键），如果找到则返回
3.  检查 MemcacheService 的 key，如果找到则返回
4.  开始交易
5.  从数据存储中获取实体，如果找到则返回
6.  在数据存储中创建实体
7.  提交事务，如果并发更新失败则返回
8.  将密钥放入缓存（内存和内存缓存）

如果另一个请求（线程）已经同时写入了相同的密钥，则第 7 步将失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T18:27:47.757

我建议您不要将 ID 保存为字符串，而是为您的实体使用 Long ID，或者您可以使用由 appengine 自动生成的 Key 数据类型。

```
 @PersistenceCapable
   public class Test{
     @PrimaryKey
     @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
     private Long ID;

     // getter and setter 
   } 
```

> 这将每次都为您返回一个独特的价值。

# objective-c - 在控制器中声明类

> ID：14086912
> 
> 赞同：0
> 
> 时间：2012-12-29T23:38:41.210
> 
> 标签：objective-c

我正在阅读一本《Objective-C Fundamentals》一书，它引导我构建一个基本的应用程序。然而，它并不总是告诉我们该做什么。在某一时刻，它说

> 打开 RootViewController.h 并删除 PropertyType 枚举和 RentalProperty 结构的现有定义。将它们替换为 CTrentalProperty 类。

好的，很容易找到它所引用的枚举和结构......

```
typedef enum PropertyType {

    Unit,
    TownHouse,
    Mansion
} PropertyType;

typedef struct {

    NSString *address;
    PropertyType type;
    double weeklyRentalPrice;

} RentalProperty; 
```

但是当它说时它到底是什么意思（实际代码是什么）

> 将它们替换为 CTrentalProperty 类

我只是写吗

```
CTRentalProperty; 
```

可能不是。你能帮我理解作者在说什么吗？我们已经创建了**CTRentalProperty.h**和**CTRentalProperty.m**类/文件，但我不确定是否应该将代码从它们复制到控制器中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:47:41.847

不确定`enum`，但作者可能是这样的：

```
@interface CTRentalProperty : NSObject

@property(nonatomic, strong) NSString *address;
@property(nonatomic, assign) PropertyType type;
@property(nonatomic, assign) double weeklyRentalPrice;

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:54:36.550

大概意思是放

```
@interface CTRentalProperty : NSObject
{
    NSString *address;
    PropertyType type;
    double weeklyRentalPrice;
}
@end 
```

代替`CTRentalProperty.h`定义`struct`。然后你需要把

```
@implementation CTRentalProperty

@end 
```

进入`CTRentalProperty.m`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T00:45:25.017

发现作者后回答我自己的问题提供了源代码。尽管鉴于他在书中提供的说明，这似乎没有意义。这是控制器的外观

```
#import <UIKit/UIKit.h>

@interface RootViewController : UITableViewController {
    NSDictionary *cityMappings;
    NSArray *properties;
}

@end 
```

# ios - 添加新项目后，当我从主视图转移到详细视图时，我的详细视图为空

> ID：14086916
> 
> 赞同：0
> 
> 时间：2012-12-29T23:39:01.213
> 
> 标签：ios, xcode, uitableview, ios6

我正在制作一个示例应用程序来学习 iOS 开发，并且我让应用程序创建默认项目来最初填充 tableview，您也可以添加更多项目。

如果我点击默认的（嗯，只有一个）并转到详细视图，它会按预期显示所有详细信息（名称、位置和日期）。但是如果我添加一个新的，它会出现这些字段为空。

我不知道为什么。我似乎设置了所有视图刷新方法，它应该设置详细视图的数据对象，然后提供标签。

有人可以帮忙吗？如果需要，我会提供更多代码，我只是不知道现在要提供什么，因为我不确定问题出在哪里。不过，这是一个相当简单的应用程序。

项目在这里可用：http: [//cl.ly/3N0o272M3y1K](http://cl.ly/3N0o272M3y1K)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:26:36.350

好的，这比计划花费的时间要长一些 - 但这是一种学习的好方法。

我已将项目附加到一个 zip 文件中。

该代码与您发布的代码有些不同，但是如果您将它们并排比较，您会看到它们的计划和构建方式有何不同。

它显示了故事板中的 Segue 工作。

除了滥用方法之外，您的项目还有两个大问题。

*   如果你希望你的数据是持久的，你需要像 Core Data 这样的东西。在我给你的例子中，我使用了 Plist，这可以解决问题，但在这种情况下不是持久的。

*   此外，您的 detailViewController 没有显示文本的标签，因此您需要查看自定义单元格 - 以匹配您的设计。

祝你好运，我希望这很有用:-)

[更新项目](https://dl.dropbox.com/u/61711378/BirdWatching.zip)

# jquery - jquery - 如何检查节点是元素还是文本

> ID：14086917
> 
> 赞同：2
> 
> 时间：2012-12-29T23:39:03.373
> 
> 标签：jquery, parsing

我希望能够识别文本字符串的第一个子元素何时是元素或文本节点，例如：

我正在考虑这样做：`$('<span>'+my_html_string+'</span>').children().is('*')`

但这并不总是有效。

1：第一个孩子是文本。一些例子：

```
<span>some text<span> //works using above code
<div>here is some <span>text</span></div> //fails using above code
<pre>check out my text</pre> //works 
```

2：第一个孩子是任何元素，一些例子：

```
<div><span>I am an element</span></div> //works
<span><div>first child div</div>understand?</span> //works 
```

如何检测元素中的第一个项目是文本还是元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:43:52.663

我建议使用一些普通的 JavaScript（尽管结合 jQuery 对相关节点/元素进行迭代）。以下内容未经测试，但我认为明白了这一点：

```
function firstChildIs(el) {
    if (!el) {
        return false;
    }
    else {
        switch (el.firstChild.nodeType) {
            case 1:
            return 'Element is an element';
            break;
            case 2:
            return 'Element is an attribute node';
            break;
            case 3:
            return 'Element is a textNode';
            break;
            case 4:
            return 'Element is a CDATA section node';
            break;
            case 5:
            return 'Entity reference node';
            break;
            case 6:
            return 'entity node';
            break;
            case 7:
            return 'processing instruction node';
            break;
            case 8:
            return 'comment node';
            break;
            case 9:
            return 'document node';
            break;
            case 10:
            return 'document type node';
            break;
            case 11:
            return 'document fragment node';
            break;
            case 12:
            return 'document notation node';
            break;
            default:
            return 'Something horrible has probably happened...';
            break;
        }
    }
} 
```

并致电：

```
$(elementSelector).each(
    function(){
        console.log(firstChildIs(this));
    }); 
```

编辑是因为我认为使用数组可能比使用开关更容易：

```
function firstChildIs(el) {
    if (!el) {
        return false;
    }
    else {
        var nodetypes = ['element', 'attribute', 'text',
                         'CDATA section', 'entity reference',
                         'entity', 'processing instruction',
                         'comment', 'document', 'document type',
                         'document fragment', 'document notation'];
        return nodetypes[el.firstChild.nodeType - 1] || 'something really unexpected happened';
    }
} 
```

以与前面说明的相同方式调用，如果要添加单词“node”，请记住将其添加到函数返回的值中。

还值得记住的是，一些（尽管我不认为*全部*）浏览器确实将打开标签之间的空白（换行符和制表符）报告为文本节点，因此您完全有可能必须修剪白色-space 在评估 的`firstChild`节点类型之前。

参考：

*   [`Node.nodeType`](https://developer.mozilla.org/en-US/docs/DOM/Node.nodeType).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:41:52.370

```
$('....').get(0).nodeType == 3 // first node is a text node 
```

类似的东西？用于[`.get()`](http://api.jquery.com/get/)获取 DOM 元素，并检查[`nodeType`](https://developer.mozilla.org/en-US/docs/DOM/Node.nodeType).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T00:20:19.183

天真的方式：

```
$(my_html_string).html().substr(0,1) == '<' 
```

考虑使用[`jQuery.trim()`](http://api.jquery.com/jQuery.trim/)来摆脱最终的空白。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T23:43:00.643

试试这个：`$("element_selector:first-child")[0].nodeType == 3`

# vbscript - .vbs 文件可以是预定脚本吗？

> ID：14086918
> 
> 赞同：1
> 
> 时间：2012-12-29T23:39:10.257
> 
> 标签：vbscript, scheduled-tasks, windows-shell, wsh

我编写了一个 .vbs 脚本，目前由用户手动运行。第一次手动执行时，如何在 Windows XP 和 Windows 7 上的任务计划程序中自行安排此脚本（每天自动在固定时间运行）？

**编辑**

```
 Option Explicit

    Dim oShell : Set oShell = WScript.CreateObject ("WScript.Shell")
    Dim FSO : set FSO = CreateObject("Scripting.FileSystemObject") 
    Dim StartTime,Elapsed 

    'msgBox(oShell.CurrentDirectory)
    'MsgBox(FSO.GetFile(Wscript.ScriptFullName).ParentFolder )
    oShell.CurrentDirectory = FSO.GetFile(Wscript.ScriptFullName).ParentFolder

    StartTime = Timer

    oShell.run "ParentChildLinkFinal.vbs", 1, True
    oShell.run "Parent_Child_Merge_final.vbs", 1, True
    oShell.run "CycleTime.vbs", 1, True
    oShell.run "Baddata.vbs", 1, True
    oShell.run "Matrixrefresh.vbs", 1, True

    Elapsed = Timer - StartTime

    MsgBox("Total time taken to finish this task:" & Elapsed & "in Seconds") 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:22:18.933

创建计划任务以运行以下命令：

```
c:\windows\system32\cscript.exe PATH_TO_YOUR_VBS 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T21:26:42.123

您当然可以使 vbs 文件成为计划任务。

但是，需要注意的是，您不想提示用户……没有输入，没有消息框，什么都没有。确保您已经处理并记录了您的异常，否则您可能会发现自己的任务永远不会完成（或者更糟糕的是，操作会因为凌晨 3 点弹出消息框并停止生产过程而愤怒地打电话给您）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-10T09:04:50.443

在 Windows 8 上：触发具有消息框的 VBScript 的 Windows 任务将仅在 Windows 任务在真正登录机器的同一用户下运行并且如果 Windows 任务配置为“仅在用户已登录”我认为这在 Windows 8 上发生了变化，因为在 Windows 7 上我不必以这种方式配置任务

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-09-26T02:31:24.387

尝试这个

```
X=MsgBox("Take the Quiz!")

name=inputbox("Name")

q1=inputbox("Question 1 - How many days are there in a leap Year?")

q2=inputbox("Question 2 - How many Suns does Neptune have?")

q3=inputbox("Question 3 - What is your name?")

q4=inputbox("Question 4 - What did one computer say to the other?")

q5=inputbox("Question 5 - Why did the chicken cross the road?")

msgbox("Answers!")

msgbox("Q1 - How many days are there in a leap Year?, you answered ") + q1 + (" ,the correct answer is 366")

msgbox("Q2 - How many Suns does Neptune have?, you answered ") + q2 + (" ,the correct answere is one, our sun.")

msgbox("Q3 - What is your name?, you answered ") + q3 + (", the correct answer is ") + name + (" or is it?")

msgbox("Q4 - What did one computer say to the other?, you answered ") + q4 + (", the correct answer is, 011100110111010101110000 (Binary code for sup)")

msgbox("Q5 - Why did the chicken cross the road?, you answered ") + q5 + (", the correct answer is To get to the other side")

msgbox("Well done, ") + name + (" you have completed the quiz") 
```

# perl - Perl - fork() 之后的初始化与未初始化的词法变量

> ID：14086923
> 
> 赞同：1
> 
> 时间：2012-12-29T23:39:32.260
> 
> 标签：perl, variables, fork

我正在使用 Lincoln Stein 的优秀*Network Programming With Perl*书中的一些习语来编写服务器。对于在 fork 之前声明并在之后引用的变量，我似乎得到了奇怪的行为。

这是一个说明问题的完整程序。（我为它没有被更多地精简而道歉；当我把所有我认为不相关的东西都删掉时，问题就消失了。）如果你寻找，`##### MYSTERY #####`你会看到声明的两个版本`my $pid`。一个版本有效，而另一个版本无效。在调用`become_daemon()`将子 PID 分配给 $pid 之后，我尝试将其写入 PID 文件，然后验证它是否有效。根据我使用的声明方法，它要么成功，要么失败。我不明白！

```
#!/usr/bin/perl 
#
# Prototype contactd master server

use warnings;
use strict;
use Carp;
use Getopt::Std;
use File::Basename;
use IO::Socket;
use IO::File;
use Net::hostent;    # for OO version of gethostbyaddr
use POSIX qw{WNOHANG setsid};
use Data::Dumper;

#use 5.010;
sub say { print "@_\n"; }

my $program        = basename $0;
my $default_config = "$program.config";

$| = 1;              # flush STDOUT buffer regularly

my %opts;

my $config_file = $opts{c} || $default_config;

# Process the config file to obtain default settings
#
# Note: for now we'll hard code config values into the config hash.
#
my %config;

$config{PORT}      = 2000;
$config{DAEMONIZE} = 0;
$config{VERBOSE}   = 0;
$config{LOGDIR}    = "/mxhome/charrison/private/wdi/logs";
$config{PIDFILE}   = "/var/tmp/$program.pid";

# Process command line args to override default settings
#
my $server_port = $opts{p} || $config{PORT};
my $log_dir     = $opts{l} || $config{LOGDIR};
my $verbose   = !!( exists $opts{v} || $config{VERBOSE} );
my $daemonize = !!( exists $opts{d} || $config{DAEMONIZE} );
my $pid_file = $opts{P} || $config{PIDFILE};

################################################################################
# Set up signal handlers
#
# Caution: these call the logging manager servlog(), which has not yet been
# spawned.
################################################################################

# Set up a child-reaping subroutine for SIGCHLD
#
$SIG{CHLD} = sub {
    local ( $!, $^E, $@ );
    while ( ( my $kid = waitpid( -1, WNOHANG ) ) > 0 ) {
    }
};

# Set up a signal handler for interrupts
#
my $quit = 0;
$SIG{INT} = sub {
    $quit++;
};

# Set up signal handler for pipe errors
#
$SIG{PIPE} = sub {
    local ( $!, $^E, $@ );

};

################################################################################
#                           DAEMONIZATION OCCURS HERE
################################################################################

my $pid_fh = open_pid_file($pid_file);

##### MYSTERY #####

my $pid;           # this makes it work
# my $pid = $$;    # this breaks it!

$daemonize = 1;  # inserted here for demo

if ($daemonize) {
    say "Becoming a daemon and detaching from your terminal.  Bye!";
    $pid = become_daemon();    # update w/new pid
}

say "Here is pid: $pid.  Going to write it to $pid_file and close.";

# If we daemonized, then we are now executing with a different PID
#
# And in that case, the following fails silently!!
#

print $pid_fh $pid;    # store our PID in known location in filesystem
close $pid_fh;

say "Boo boo" if !-e $pid_file;
say qx{cat $pid_file};

##### END OF DEMO #####    

# open_pid_file()
#
# Courtesy of Network Programming with Perl, by Lincoln D. Stein
#
sub open_pid_file {
    my $file = shift;
    if ( -e $file ) {    # PID file already exists
        my $fh = IO::File->new($file) || return;
        my $pid = <$fh>;    # so read it and probe for the process
        croak "Server already running with PID $pid\n"    # die ...
            if kill 0 => $pid;                            # if it responds
        warn "Removing PID file for defunct server process $pid.";
        croak "Can't unlink PID file $file"               # die ...
            unless -w $file && unlink $file;              # if can't unlink
    }
    return IO::File->new( $file, O_WRONLY | O_CREAT | O_EXCL, 0644 )
        or die "Can't create PID file $file: $!\n";
}

# become_daemon()
#
# Courtesy of Network Programming with Perl, by Lincoln D. Stein
#
sub become_daemon {
    die "Can't fork" unless defined( my $child = fork );
    exit 0 if $child != 0;    # die here if parent

    # --- PARENT PROCESS DIES
    # --- CHILD PROCESS STARTS

    setsid();    # Become session leader
    open( STDIN, "</dev/null" );

    # servlog() writes to STDOUT which is being piped to log manager
    #
    #open( STDOUT, ">/dev/null" );
    open( STDERR, ">&STDOUT" );

    chdir '/';    # go to root directory
    umask(0);     # ??
    $ENV{PATH} = '/bin:/sbin:/use/bin:/usr/sbin';
    return $$;
}

END {
    unlink $pid_file if $pid == $$;    # only the daemon unlinks pid file
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:45:36.193

在代码的末尾，您有：

```
END {
    unlink $pid_file if $pid == $$;    # only the daemon unlinks pid file
} 
```

`$pid`如果在父进程中未定义，这可以正常工作。但是如果你把它初始化为父进程的ID，那么父进程会在`become_daemon`调用`exit`.

（~~在我看来，编写 PID 文件的孩子和取消链接的父母之间存在竞争，因此结果可能并不总是相同。~~）

**编辑：**实际上，没有种族，因为 PID 文件是在分叉之前打开的。所以父进程打开文件，分叉子进程，取消链接文件并退出。子进程仍然拥有该文件的句柄并且它[仍然可以对其进行写入](https://stackoverflow.com/q/4171713/)，但是该文件不再从文件系统中的任何位置链接，并且一旦子进程退出它就会消失。

# opengl - 将 GPU 计算的结果返回到 OpenGL 中的 CPU 程序

> ID：14086926
> 
> 赞同：20
> 
> 时间：2012-12-29T23:40:00.970
> 
> 标签：opengl, cpu, shader, video-card

有没有办法将运行在 GPU 上的着色器的结果返回到运行在 CPU 上的程序？

我想根据 GPU 上的计算成本高的算法从简单的体素数据生成多边形网格，但我需要 CPU 上的结果用于物理计算。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-30T01:12:56.140

定义“结果”？

一般来说，如果您使用 OpenGL 进行 GPGPU 风格的计算，您将需要围绕渲染系统的需求来构建着色器。渲染系统被设计成单向的：数据进入其中并生成图像。倒退，让渲染系统产生数据，通常不是渲染系统的结构。

当然，这并不意味着你不能这样做。但是您需要围绕 OpenGL 的限制来构建一切。

OpenGL 提供了许多钩子，您可以在其中写入来自某些着色器阶段的数据。其中大多数需要专门的硬件

## 片段着色器输出

任何能够使用片段着色器的硬件显然都允许您写入正在渲染的当前帧缓冲区。通过使用具有浮点或整数[图像格式的](http://www.opengl.org/wiki/Image_Format#Color_formats)[帧缓冲区对象](http://www.opengl.org/wiki/Framebuffer_Object)和纹理，您可以将几乎任何您想要的数据写入各种图像。一旦进入纹理，您可以简单地调用以获取渲染的像素数据。或者，如果 FBO 仍受约束，您可以直接获取它。无论哪种方式都有效。[`glGetTexImage`](http://www.opengl.org/wiki/GLAPI/glGetTexImage)[`glReadPixels`](http://www.opengl.org/wiki/GLAPI/glReadPixels)

这种方法的主要限制是：

*   您可以附加到帧缓冲区的图像数量；这限制了您可以写入的数据量。在 GL 3.x 之前的硬件上，FBO 通常仅限于 4 个图像加上一个深度/模板缓冲区。在 3.x 和更好的硬件中，您可以期望至少 8 个图像。

*   *你正在渲染*的事实。这意味着您需要设置顶点数据以将三角形准确定位在您希望它修改数据的位置。这不是一项微不足道的工作。获得有用的输入数据也很困难，因为您通常希望每个纹素彼此相当独立。围绕这些限制构建片段着色器是很困难的。并非不可能，但在许多情况下并非微不足道。

## 变换反馈

此 OpenGL 3.0 功能允许在一个或多个缓冲区对象中捕获来自 OpenGL 的[顶点处理](http://www.opengl.org/wiki/Vertex_Processing)阶段的输出（顶点着色器和可选的几何着色器）。

这对于捕获要播放或再次渲染的顶点数据来说更加自然。在您的情况下，您需要在渲染后将其读回，可能是通过`glGetBufferSubData`调用或使用`glMapBufferRange`for reading。

这里的限制是您通常只能捕获 4 个输出值，其中每个值都是一个 vec4。还有一些严格的布局限制。一些 OpenGL 3.x 和 4.x 硬件提供了将数据写入多个反馈流的能力，这些反馈流都可以写入不同的缓冲区。

## 图像加载/存储

这个 GL 4.2 特性代表了写入的巅峰：您可以绑定图像（缓冲区纹理，如果您想写入缓冲区），然后直接写入。您需要在其中工作的[内存排序限制。](http://www.opengl.org/wiki/Memory_Model#Incoherent_memory_access)

它非常灵活，但也非常复杂。除了难以正确使用它之外，还有许多限制。您可以写入的图像数量相当有限，可能是 8 个左右。并且实现可能具有总写入限制，因此要写入的 8 个图像可能必须由片段着色器的输出共享。

更重要的是，图像输出只保证片段着色器（和 4.3 的计算着色器）。也就是说，允许硬件禁止您在非 FS/CS 着色器阶段使用图像加载/存储。

# graphics - 是否有一个绘图工具可以让我约束 x 并自动布置 y？

> ID：14086928
> 
> 赞同：1
> 
> 时间：2012-12-29T23:40:24.193
> 
> 标签：graphics, graph, graphviz

我正在寻找一种类似于 graphviz 的工具，它可以渲染图形，但这将允许我只限制每个节点的 x 坐标。然后，该工具将自动选择 y 坐标以使图形看起来整洁。

基本上，我想制定一个时间表。

语言/平台/渲染介质不是很重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T06:51:59.390

如果您想要一个看起来整洁的图表，那么力导向算法将是您最好的选择。最好的之一是 SFDP（由 AT&T 开发，包含在 graphviz 中），尽管我似乎找不到伪代码或简单的实现。我不认为有任何专门的算法。值得庆幸的是，编写自己的代码很容易。我将展示一些伪代码，大部分来自维基百科，但经过适当的一维修改。我假设您有`n`顶点，并且 x 位置的向量是`x`，下标为`x.i`。

```
set all vertex velocities to (0,0)
set all vertex positions to (x.i, random)
while (KE > epsilon)
    KE = 0
    for each vertex v
        force = (0,0)
        for each vertex u != v
            force = force + (0, coulomb(u, v).y)
            if u is incident to v
                force = force + (0, hooke(u, v).y)
        v.velocity = (v.velocity + timestep * force) * damping
        v.position = v.position + timestep * v.velocity
        KE = KE + |v.velocity| ^ 2 
```

这里`.y`表示获得力的 y 分量。这确保了顶点位置的 x 分量永远不会改变您设置的位置。该参数由您设置，并且与您期望的（动能）`epsilon`相比应该很小 。`KE`此外，`|v|`表示向量的大小`v`（上述所有计算都是 2 向量，除了 KE）。请注意，我将所有节点的质量设置为 1，但您可以根据需要更改它。

`Hooke`和`Coulomb`函数计算节点之间的各自力；第一个顶点之间的距离是线性的，第二个是二次的，因此有保证的平衡。这些功能看起来像

```
def hooke(u, v)
    return -k * |u.position - v.position|

def coulomb(u, v)
    return C * |u.position - v.position| 
```

大多数计算都是向量形式的。C 和 k 具有实际值，但要尝试获得所需的图形。这通常不是必需的，因为缩放因子会在两个维度上扩展或收缩整个图形，但是这里设置了 x 距离，因此要获得漂亮的图形，您必须稍微更改值.

# php - 防止投票垃圾邮件的最佳方法是什么？即reddit是如何做到的

> ID：14086929
> 
> 赞同：1
> 
> 时间：2012-12-29T23:40:31.810
> 
> 标签：php, spam, slim, reddit

众所周知，Reddit 允许每个链接每个 IP 地址大约 1 票，以避免垃圾邮件发送者的问题。我正在开发一个具有投票功能的 Slim 应用程序，坦率地说，我不知道如何实现这样的系统，因为我没有使用 cookie 和本地会话的经验。此外，我的大多数函数都有类似（示例）localhost:8888/myapp/voteup/item-to-vote 的路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:48:42.417

对抗自动化机器人的最好方法是混淆它们。隐藏一些文本输入字段，以其他方式命名它们（名称字段，将它们命名为电子邮件，以及站点，将它们命名为名称等）

更喜欢仅使用 Javascript 提交，因此它可以帮助减轻来自外部的表单提交。CSRF 的使用也有帮助。强制使用 cookie、HTTP 自定义标头，所有这些都是为了确保只有浏览器且没有自动化手段可以重现。

逻辑问题也可以提供帮助，例如“1 + 1 是多少，写下来”（答案必须是 2，并使其随机化）或“以 W 开头的星期几”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:59:09.553

在我的网站上，我允许会员每 24 小时对一些代码进行 1 到 5 的评分。我通过添加哈希码并使用 ajax 提交投票来阻止垃圾邮件。自从我在 2012 年 6 月添加它以来，我没有收到任何垃圾邮件投票。我曾经每天从机器人那里获得大约 40 票，但现在已经被淘汰了。

例如，这是我的链接的样子：
[http ://phpsnips.com/process/vote.php?id=43&vote=3&enc=a560e4320af4e13e4170947cd42de18b](http://phpsnips.com/process/vote.php?id=43&vote=3&enc=a560e4320af4e13e4170947cd42de18b)

这样，每次页面加载时 enc 都会有所不同，并且一旦提交投票，它就会再次更改。

**我的脚步**

*   使用会话创建 md5 哈希
*   将哈希放在链接上或形成隐藏字段
*   在提交页面测试以确保会话与链接/字段匹配
*   重置哈希
*   重定向回原始页面（如果不使用 ajax）

# python - 安装 pybrain

> ID：14086930
> 
> 赞同：1
> 
> 时间：2012-12-29T23:40:33.580
> 
> 标签：python, git, pybrain

我正在尝试使用以下方法安装 pybrain：

```
git clone git://github.com/pybrain/pybrain.git 
```

我安装了 git，然后使用 windows 命令提示符执行上述命令。一切顺利，但是当我打开我的 python IDE 时，我无法导入 pybrain。该模块不存在。我想知道我是否应该做一些额外的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:52:21.297

根据[PyBrain 文档](http://pybrain.org/docs/#installation)，您缺少第二步，即安装代码。因此，在 pybrain 源目录中打开一个命令提示符（其中会有一个`setup.py`文件），然后运行以下命令：

```
python setup.py install 
```

作为参考，可以在[PyBrain Github wiki找到更详细的安装说明](https://github.com/pybrain/pybrain/wiki/installation)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-17T18:03:38.157

我有同样的问题。我的解决方案是调用 cmd.exe -“以管理员身份运行”，导航到此控制台中提取的 pybrain 源文件夹并最终运行“setup.py install”

如何检查时，安装了哪些 pybrain 并可用？简单的！在控制台调用 python 解释器：对我来说是

```
C:\Python27\python.exe 
```

在获得 Python cli 之后：

```
Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)] on win
32
Type "help", "copyright", "credits" or "license" for more information. 
```

键入以下行：

```
from pybrain.tools.shortcuts import buildNetwork 
```

如果没有产生错误，则一切正常:)

# c++ - Windows XP 用户文件夹的 CSIDL 常量

> ID：14086936
> 
> 赞同：2
> 
> 时间：2012-12-29T23:41:15.820
> 
> 标签：c++, winapi, windows-xp, windows-shell

我似乎找不到 Windows XP 的“C:\Documents and Settings\username”文件夹的 CSIDL 常量是什么？

编辑：我正在使用以下代码检索此路径：

```
HANDLE hUserToken = NULL;
if(WTSQueryUserToken(dwUserSessionID, &hUserToken))
{
    PIDLIST_ABSOLUTE pIdl = NULL;
    if(SHGetFolderLocation(NULL, nCSIDL, hUserToken, NULL, &pIdl) == S_OK)
    {
        SHGetPathFromIDList(pIdl, path_buf);

        ILFree(pIdl);
    }

    CloseHandle(hUserToken);
} 
```

问题变成了代码`C:\WINDOWS\system32\config\systemprofile`在我期待时返回管理帐户`C:\Documents and Settings\Administrator`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:46:33.120

检查此参考：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb762494%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762494%28v=vs.85%29.aspx)

您正在寻找的常数是`CSIDL_PROFILE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T09:15:53.303

*   获取位置的代码片段：[ConstantSpecialItems.cpp](http://www.alax.info/trac/public/browser/trunk/Utilities/Miscellaneous/ConstantSpecialItems/ConstantSpecialItems.cpp) + binary [ConstantSpecialItems.exe](http://www.alax.info/trac/public/browser/trunk/Utilities/Miscellaneous/ConstantSpecialItems/Release/ConstantSpecialItems.exe)如果您想自己打印它们

*   样品地点：

    *   [视窗](http://www.alax.info/trac/public/browser/trunk/Utilities/Miscellaneous/ConstantSpecialItems/Release/Windows%20version%205.1%2C%20Build%202600.txt)
    *   [视窗](http://www.alax.info/trac/public/browser/trunk/Utilities/Miscellaneous/ConstantSpecialItems/Release/Windows%20version%206.0%2C%20Build%206002.txt)
    *   [Windows 7的](http://www.alax.info/trac/public/browser/trunk/Utilities/Miscellaneous/ConstantSpecialItems/Release/Windows%20version%206.1%2C%20Build%207600.txt)

你要的那个：

```
Windows version 5.1, Build 2600

CSIDL paths: 
[...] 
CSIDL_PROFILE: C:\Documents and Settings\John Doe 
```

# android - Android 放置 TextView 依赖于它的中心

> ID：14086940
> 
> 赞同：0
> 
> 时间：2012-12-29T23:41:41.870
> 
> 标签：android, textview

如何在布局上放置 TextView 取决于代码中 TextView 的中心？默认情况下，我们可以根据其左上角创建它。方法 setGravity(Gravity.CENTER_HORIZONTAL) 没有帮助。

编辑

我想将 TextViews 放在圆圈中。对于我使用RelativeLayout。在layot TextViews 中以某个角度步长放置在for 循环中。这里有一些代码

```
 for (int i = 0; i < 62; i++) {
        TextView word = new TextView(context);
        word.setTextSize(13);
        // word.setGravity(Gravity.CENTER_HORIZONTAL);
        word.setTextColor(Color.BLACK);
        RotateAnimation rotateAnimation = new RotateAnimation(0,
                angle.get(i), 0, (float) (textHeight * 0.9 + rotateCircle));
        rotateAnimation.setFillAfter(true);
        rotateAnimation.setDuration(100);
        rotateAnimation.setStartOffset(100);

        word.setAnimation(rotateAnimation);
        word.setGravity(Gravity.CENTER);
        word.setPadding(10, 10, 10, 10);

        RelativeLayout.LayoutParams layoutparams = new RelativeLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
        layoutparams.leftMargin = Math.round(x_coords.get(i));

        layoutparams.topMargin = (int) (Math.round(y_coords.get(i)
                - textHeight * 0.9 - rotateCircle));
        textviews.add(word);

        words_layout.addView(word, layoutparams);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:18:01.430

使用**android:layout_gravity = CENTER_HORIZONTAL**使文本视图居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:44:08.063

a的*重力*`TextView`控制其内容*（文本）*的对齐方式，而不是视图本身在*布局*中的对齐方式。要控制*布局*`View`中的对齐方式，请改用属性或.*`android::layout_gravity``gravity``LayoutParams`*

# android - execSQL 导致语法错误

> ID：14086948
> 
> 赞同：1
> 
> 时间：2012-12-29T23:42:52.983
> 
> 标签：android, sqlite

我有以下 execSQL 引发语法错误并导致我的应用程序崩溃。考虑到我已经转义了单引号和双引号，我不知道为什么。

这是代码：

```
database.execSQL("insert into " + TABLE_EXERCISES + " (" + COLUMN_NAME + ", " + COLUMN_PRIMARY_MUSCLE + ", " + COLUMN_SECONDARY_MUSCLE + ", " + COLUMN_EQUIPMENT_TYPE + ", " + COLUMN_STEPS + ", " + COLUMN_IMAGES + ") values ('Cable Shrugs', 'Traps', 'None', 'Cable', 'Attach a flat shoulder width bar to the lowest cable pulley. Stand with your feet shoulder width apart. Keep your abs tight and a slight bend in your knees to protect your lower back. Starting with the bar at waist height, raise your shoulders toward your ears as if you\'re saying,\"I don\'t know.\" Hold briefly at the top of the contraction then lower in a slow and controlled manner.', 'cable-shrugs-1.png|cable-shrugs-2.png')"); 
```

有人知道吗？

这是日志：

```
12-29 23:31:54.174: E/AndroidRuntime(1207): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.gauvion.gfit/com.gauvion.gfit.RoutinesActivity}: android.database.sqlite.SQLiteException: near "re": syntax error (code 1): , while compiling: insert into exercises(name, primary_muscle, secondary_muscle, equipment_type, steps, images) VALUES ('Cable Shrugs', 'Traps', 'None', 'Cable', 'Attach a flat shoulder width bar to the lowest cable pulley. Stand with your feet shoulder width apart. Keep your abs tight and a slight bend in your knees to protect your lower back. Starting with the bar at waist height, raise your shoulders toward your ears as if you're saying,"I don't know." Hold briefly at the top of the contraction then lower in a slow and controlled manner.', 'cable-shrugs-1.png|cable-shrugs-2.png') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:10:51.163

> 你是

有你的错误。你没有逃避撇号。据我所知，如果您使用 '' 这将起作用。

注意：对于“使用”和对于“使用”

试试这个：

> database.execSQL("插入 " + TABLE_EXERCISES + " (" + COLUMN_NAME + ", " + COLUMN_PRIMARY_MUSCLE + ", " + COLUMN_SECONDARY_MUSCLE + ", " + COLUMN_EQUIPMENT_TYPE + ", " + COLUMN_STEPS + ", " + COLUMN_IMAGES + ") 值（'Cable Shrugs'、'Traps'、'None'、'Cable'、'将平肩宽杆连接到最低的电缆滑轮。站立时双脚与肩同宽。保持腹部收紧，膝盖略微弯曲保护你的下背部。从腰高的杠铃开始，将肩膀抬向耳朵，好像你在说“我不知道”。一种缓慢而受控制的方式。'，'cable-shrugs-1。png|cable-shrugs-2.png')");

# javascript - 在流星（使用流星路由器）中处理闪光通知的好方法是什么？

> ID：14086958
> 
> 赞同：9
> 
> 时间：2012-12-29T23:43:54.300
> 
> 标签：javascript, meteor

我正在使用[流星](http://meteor.com)和[流星路由器](https://github.com/tmeasday/meteor-router)进行客户端和服务器端路由。我想知道处理站点通知的好方法，特别是“flash”类型的通知。

在全局 layout.html 中，如果设置了“消息”会话变量，我可以让把手输出消息，但是一旦应用程序被路由到带有`Meteor.Router.to()`.

有什么“闪光”通知的好解决方案？或者，如何在路由到新 URL 后自动清除会话变量。

布局.html：

```
<head>
  <title>Meteor App</title>
</head>
<body>
  {{> global-layout}}
</body>

<template name="global-layout">
   {{#if message}}
      <div class="message">{{message}}</div>
   {{/if}}
   {{renderPage}}
</template> 
```

然后在 layout.js

```
Template['global-layout'].message = function () {
  return Session.get('message');
}; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T18:22:38.437

我`Meteor.Router.filter`为此使用了一个。此过滤器将应用于所有路由，因此所有 url 更改都会清除所有闪烁。

**路由.js**

```
Meteor.Router.filters({
  // clearSeenMessages filter clears all seen messages. 
  // This filters is applied to all pages 
  clearSeenMessages: function (page) {
    flash.clear();
    return page;
  },
});

// applies to all pages
Meteor.Router.filter('clearSeenMessages'); 
```

这是实现的其余部分，方面是从[telesc.pe借来的](http://telesc.pe)

**客户端/views/flashes/flash_item.html**

```
 <template name="flashItem">
      {{#if show}}
        <div class="alert-box {{type}}">
          {{message}}
          <a class="close"  href="">&times;</a>
        </div>
      {{/if}}
    </template> 
```

**客户端/views/flashes/flash_item.js**

```
// When the template is first created
Template.flashItem.created = function () {
  // Get the ID of the messsage
  var id = this.data._id;
  Meteor.setTimeout(function () {
    // mark the flash as "seen" after 100 milliseconds
    flash.Flashes.update(id, {$set: {seen: true}});
  }, 100);
} 
```

**客户端/视图/flashes/flashes.html**

```
<template name="flashes">
  {{#each flashes}}
    {{> flashItem}}
  {{/each}}
</template> 
```

**客户端/视图/flashes/flashes.js**

```
Template.flashes.flashes = function () {
  return flash.Flashes.find();
} 
```

**客户端/视图/app.html**

```
<body>
  <!-- add the flashes somewhere in the body -->
  {{> flashes}}
</body> 
```

**客户端/lib/flashes.js**

```
// flashes provides an api for temporary flash messages stored in a
// client only collecion
var flash = flash || {};

(function (argument) {
  // Client only collection
  flash.Flashes = new Meteor.Collection(null);

  // create given a message and optional type creates a Flash message.
  flash.create = function (message, type) {
    type = (typeof type === 'undefined') ? 'error' : type;
    // Store errors in the 'Errors' local collection
    flash.Flashes.insert({message: message, type: type, seen: false, show: true});
  };

  // error is a helper function for creating error messages
  flash.error = function (message) {
    return flash.create(message, 'error');
  };

  // success is a helper function for creating success messages
  flash.success = function (message) {
    return flash.create(message, 'success');
  };

  // info is a helper function for creating info messages
  flash.info = function (message) {
    return flash.create(message, 'info');
  };

  // clear hides viewed message
  flash.clear = function () {
    flash.Flashes.update({seen: true}, {$set: {show: false}}, {multi: true});
  };
})(); 
```

### 用法

```
flash.success('This is a success message');
flash.error('This is a error message');
flash.info('This is a info message'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T11:04:06.910

您现在可以使用[大气中可用的](http://atmosphere.meteor.com/)[路由器-带闪存](https://github.com/egtann/meteor-router)包来处理闪存通知。如果你使用陨石（你应该这样做），你可以在项目的根目录中进行。然后，要显示警报，您需要 -`mrt add router-with-flash`

```
Meteor.Router.to("/", { alert: "Some alert..." });
Meteor.Router.notification("alert"); 
```

这将显示警报，直到下一次调用`Meteor.Router.to()`。

# netlogo - 比较两个代理变量

> ID：14086966
> 
> 赞同：0
> 
> 时间：2012-12-29T23:44:42.773
> 
> 标签：netlogo

我目前正在使用遗传算法进行模拟（用于家庭作业）。我想做的是比较特定补丁上代理的适应度，适应度最低的那个会死。

我已经在网上搜索并找到了这段代码：`if any? breed1-here with [fitness > fitness-of myself] [die]]`

但这似乎不起作用，现在我完全没有想法了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:30:34.013

```
let goner min-one-of breed1-here [fitness]
if is-turtle? goner [ ask goner [ die ] ]` 
```

检查是必要的`is-turtle?`，因为补丁可能是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:33:28.990

是的，该代码来自旧版本的 NetLogo 语言。该行代码应重写为：

```
if any? breed1-here with [fitness > [fitness] of myself] [die]] 
```

当然，该代码将杀死一个补丁中的所有海龟，除了具有最大适应度的海龟，这并不是您想要的。

# python - 读取某个站点写入的cookies

> ID：14086968
> 
> 赞同：0
> 
> 时间：2012-12-29T23:44:56.020
> 
> 标签：python, cookies

我正在为某个网站开发客户端，

当我使用 Chrome/Firefox 访问网站时，它会在我的本地写入一些 cookie，除了 HTTP 响应中的 Cookie 字段，

我需要从本地文件中提取这些附加信息以发送可以被远程服务器成功接受的请求

谁能告诉我如何在 Python 中做到这一点？

最好的，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:52:15.780

你有很多选择。最好的似乎是使用 urllib2。看看[如何使用 Python 登录网页并检索 cookie 以供以后使用？](https://stackoverflow.com/questions/189555/how-to-use-python-to-login-to-a-webpage-and-retrieve-cookies-for-later-usage)一些优秀的答案。

这是那里的最佳答案的代码。它是登录、设置一些 cookie 并访问受限页面：

```
import urllib, urllib2, cookielib

username = 'myuser'
password = 'mypassword'

cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
login_data = urllib.urlencode({'username' : username, 'j_password' : password})
opener.open('http://www.example.com/login.php', login_data)
resp = opener.open('http://www.example.com/hiddenpage.php')
print resp.read() 
```

# php - PHP 编码电子邮件地址

> ID：14086970
> 
> 赞同：4
> 
> 时间：2012-12-29T23:45:19.693
> 
> 标签：php, hash, encode

我需要一种方法`PHP`来对电子邮件地址进行编码，仅使用`a-zA-Z0-9`基本上没有任何特殊字符的编码，但随后能够将其解码回原始地址。

例子：

```
 john+doe@mydomain.com => ENCODE => n6bvJjdh7w6QbdVB373483ydbKus7Qx
 n6bvJjdh7w6QbdVB373483ydbKus7Qx => DECODE => john+doe@mydomain.com 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T23:54:36.737

您可以进行网络安全 base64 编码：

```
// encode
$email_encoded = rtrim(strtr(base64_encode($email), '+/', '-_'), '=');

// decode
$email_decoded = base64_decode(strtr($email_encoded, '-_', '+/')); 
```

它将base64 字母表中的`+`and转换为更无害的and 。编码步骤还会在需要时删除尾随字符。`/``-``_``=`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:49:28.367

如果允许等号，则可以使用[`base64_encode()`](http://php.net/manual/en/function.base64-encode.php)and[`base64_decode()`](http://php.net/manual/en/function.base64-decode.php)

另一种选择是[`bin2hex()`](http://www.php.net/manual/en/function.bin2hex.php)和[`hex2bin()`](http://php.net/manual/en/function.hex2bin.php)

# objective-c - 编译器无法识别 switch 语句中的 typedef

> ID：14086971
> 
> 赞同：0
> 
> 时间：2012-12-29T23:45:29.297
> 
> 标签：objective-c, xcode, xcode4

我刚刚开始学习objective c，我在玩typedef、枚举、switch语句和函数，只是为了更熟悉它们。根据我的理解，这段代码应该都可以工作，但是我在声明 switch 语句的位置出现编译错误，上面写着“意外的类型名称'dinnerPreference'：预期的表达式。如果我使用 typedef 来定义dinnerPreference，那么为什么会发生这种情况。

```
typedef  enum { pizza = 0, steak = 1, seafood = 2} dinnerPreference;
int main(int argc, const char * argv[])
{

@autoreleasepool {

    dinnerPreference momDinnPref = pizza;
    dinnerPreference myDinnPref  = steak;
    dinnerPreference urDinnPref  = seafood;

    int dinnerPrefFunc ( dinnerPreference x ); {
        NSLog(@"Lets see what this guy wants for dinner");
        dinnerPreference x
        switch( dinnerPreference x ) {
            case pizza:
                NSLog(@"This person wants pizza");
                break;
            case steak:
                NSLog(@"This person wants steak");
                break;
            case seafood:
                NSLog(@"This person wants steak");
                break;
            default:
                NSLog(@"I dunno");
                break;
                return 0;
        };
    }
    dinnerPrefFunc(momDinnPref);
    dinnerPrefFunc(myDinnPref);
    dinnerPrefFunc(urDinnPref);
}
return 0; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:39:15.007

Objective-C（和 C、C++）不支持*在*其他函数中声明函数，至少不支持您尝试过的方式。尝试重新排序您的代码，如下所示：

```
typedef enum { pizza = 0, steak = 1, seafood = 2 } dinnerPreference;

int dinnerPrefFunc ( dinnerPreference x );
int dinnerPrefFunc ( dinnerPreference x )
{
    NSLog(@"Lets see what this guy wants for dinner");
    switch( x )
    {
        case pizza:
            NSLog(@"This person wants pizza");
            break;
        case steak:
            NSLog(@"This person wants steak");
            break;
        case seafood:
            NSLog(@"This person wants steak");
            break;
        default:
            NSLog(@"I dunno");
            break;
    }
    return 0;
}

int main(int argc, const char * argv[])
{

   @autoreleasepool
   {

      dinnerPreference momDinnPref = pizza;
      dinnerPreference myDinnPref  = steak;
      dinnerPreference urDinnPref  = seafood;

      dinnerPrefFunc(momDinnPref);
      dinnerPrefFunc(myDinnPref);
      dinnerPrefFunc(urDinnPref);
   }
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:48:27.927

这一行是错误的：

```
switch( dinnerPreference x ) { 
```

将其更改为：

```
switch (x) { 
```

还要注意，你还没有初始化 x。

# ruby-on-rails - collection_start validates_presence_of 冲突

> ID：14086977
> 
> 赞同：1
> 
> 时间：2012-12-29T23:45:59.283
> 
> 标签：ruby-on-rails

楷模

```
class Task < ActiveRecord::Base
  attr_accessible :deadline, :list_id, :name, :summary
  validates_presence_of :deadline, :list_id, :name, :summary

  belongs_to :list
end

class List < ActiveRecord::Base
  attr_accessible :name

  has_many :tasks, :dependent => :destroy
end

<%= collection_select(:post, :list_id, List.all, :id, :name, :prompt => true) %> 
```

渲染：

```
<select id="post_list_id" name="post[list_id]">
 <option value="">Please select</option>
 <option value="1">House</option>
 <option value="2">Car</option>
</select> 
```

我将 list_id 设置为必需，当我在添加任务时从下拉列表中选择列表 (list_id) 时，它表示未选择 list_id。我可能做错了什么？

![在此处输入图像描述](../Images/a2b78ea181d9f8b9c424035c04b8cef4.png)

更新：想通了，不得不修改表单视图中的collection_select行，我也没有包括f。参与其中

```
f.collection_select(:list_id, List.all, :id, :name, {:include_blank => true}) 
```

# php - 如果 isset 则 PHP 返回

> ID：14086980
> 
> 赞同：4
> 
> 时间：2012-12-29T23:46:35.797
> 
> 标签：php, isset, built-in

> **可能重复：**
> [设置默认值的更简洁的方法？](https://stackoverflow.com/questions/13507779/any-more-concise-way-to-set-default-values)

是否有像下面这样的内置 php 函数：

```
function isset_get($array, $key, $default = null) {
    return isset($array[$key]) ? $array[$key] : $default;
} 
```

我不喜欢

```
$my_var = isset($my_array['some Key']) ? $my_array['some Key'] : ''; 
```

并且更喜欢

```
$my_var = isset_get($my_array, 'some Key', ''); 
```

或类似的东西...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:57:58.730

不。在我的代码库中，我们有几个这种性质的助手。这些名称非常糟糕，但由于它们经常使用，因此简洁是必要的

`idx($array, $key, $default)` 如果 !isset($array[$key]) 返回 $default

`adx($array, $key, $default)` 像 idx，但强制 $array 实际上是一个数组，如果不是则抛出。

`edx($array, $key, $default)` 如果 !isset($array[$key]) 或 empty($array[$key]) 返回 $default

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:52:21.250

考虑使用`array_merge`. 合并将覆盖每个给定数组的键，允许您使用给定值覆盖默认值数组。

```
$defaults = array('some Key' => 'some Default Value');
$input = array('some Key' => 'a new value');
$merged = array_merge($defaults, $input);
$value = $merged['some Key']; 
```

但是，这不适用于数字键，因此您应该确保使用的是地图而不是矢量。

# postgresql - PostgreSQL、ODBC 和临时表

> ID：14086994
> 
> 赞同：0
> 
> 时间：2012-12-29T23:49:20.573
> 
> 标签：postgresql, odbc

你能告诉我为什么这个查询在 pgAdmin 中有效，但在使用 ODBC 的软件中无效：

```
CREATE TEMP TABLE temp296 WITH (OIDS) ON COMMIT DROP AS
SELECT age_group AS a,male AS m,mode AS t,AVG(speed) AS speed
FROM person JOIN info ON person.ppid=info.ppid
WHERE info.mode=2
GROUP BY age_group,male,mode;

SELECT age_group,male,mode,
CASE 
WHEN age_group=1 AND male=0 THEN (info_dist_km/(SELECT avg_speed FROM temp296 WHERE a=1 AND m=0))*60
ELSE 0
END AS info_durn_min
FROM person JOIN info ON person.ppid=info.ppid
WHERE info.mode IN (7) AND info.info_dist_km>2; 
```

我得到“42P01：错误：关系“temp296”不存在”。

我也尝试过“BEGIN; [...] COMMIT;” - “HY010：光标已打开”。

PostgreSQL 9.0.10，由 Visual C++ build 1500 编译，64 位 psqlODBC 09.01.0200 Windows 7 x64

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T09:31:31.667

我认为它对您不起作用的原因是因为默认情况下 OD​​BC 在自动提交模式下工作。如果你连续执行你的语句，第一个语句

```
CREATE TEMP TABLE temp296 ON COMMIT DROP ... ; 
```

完成后必须自动提交，因此删除了您的临时表。

不幸的是，ODBC 不支持直接使用语句`BEGIN TRANSACTION; ... COMMIT;`来处理事务。

[相反，您可以使用SQLSetConnectAttr](http://msdn.microsoft.com/en-us/library/ms713605.aspx)函数禁用自动提交，如下所示：

```
SQLSetConnectAttr(hdbc, SQL_ATTR_AUTOCOMMIT, SQL_AUTOCOMMIT_OFF, 0); 
```

但是，在你这样做之后，你必须记住使用[SQLEndTran](http://msdn.microsoft.com/en-us/library/windows/desktop/ms716544.aspx)提交任何更改，如下所示：

```
SQLEndTran(SQL_HANDLE_DBC, hdbc, SQL_COMMIT); 
```

虽然 WITH 方法作为一种解决方法对您有用，但值得注意的是，适当地使用事务比在自动提交模式下运行更快。

例如，如果您需要向表中插入许多行（数千或数百万），使用事务可以比自动提交快成百上千倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T17:30:10.673

临时表不能通过 ODBC 中的 SQLPrepare/SQLExecute 获得的情况并不少见，即在准备好的语句上，例如 MS SQL Server 就是这样。解决方案通常是使用 SQLExecDirect。

# javascript - Chrome Frame 真的是提升 IE 中 Raphael 性能的唯一选择吗？

> ID：14086997
> 
> 赞同：2
> 
> 时间：2012-12-29T23:49:30.620
> 
> 标签：javascript, raphael

我正在使用 Raphael 2.1 同时绘制 15 条线。每条线由 50 条 2 像素路径组成。性能在 Safari 和 Chrome 中最好，在 FF 中很好，在 Opera 中较弱，在 IE9 中表现不佳。微软表示 SVG 将在 IE9 中运行，但 Raphael.svg 在 IE9 中返回 false。

我整天都在阅读与 Raphael 和 IE 相关的帖子，而我看到的在 IE9 中提高 Raphael 性能的唯一解决方案是安装 Chrome Frame。

有没有人遇到过其他解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T11:02:09.847

Raphael 在 IE9 中使用 svg 并以合理的性能工作。您必须小心 IE 不会被强制进入 IE8 标准模式（这种情况经常发生）。如果 IE9 回退到 IE8 标准，那么它最终将使用 VML，这非常慢，并且在 IE8 或更低版本中通常没有有效的 SVG 替代方案。

当使用 IE8 遇到这个问题时，我最终使用 div 和 css 来实现线条、矩形和文本的渲染。因为这就是我所需要的，所以即使在 IE8 中它也非常快，通过缓冲容器内的 div 来提供帮助。如果您的问题足够简单，您可能希望考虑使用纯 DOM 解决方案。请参阅：[https](https://github.com/Matt-Esch/simpleCanvas.js) ://github.com/Matt-Esch/simpleCanvas.js以获得灵感。