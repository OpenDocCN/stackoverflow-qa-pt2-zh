# StackOverflow 问答 14491000-14491999

# zeromq - jeromq 生产准备好了吗？

> ID：14491000
> 
> 赞同：17
> 
> 时间：2013-01-23T23:00:11.397
> 
> 标签：zeromq, jeromq

我过去曾通过库将 ZeroMQ 与 JVM 应用程序一起使用`jzmq`。我计划在一个新项目中使用 zeromq，其中一些服务是在 JVM 上实现的。我刚刚发现了[jeromq](https://github.com/zeromq/jeromq)，它是 zeromq 的纯 java 实现，我想主要使用它，因为它跟踪 zeromq 3.x，它消除了处理`jzmq`. 但是，我无法从 repo 页面判断它是否已准备好生产。有人有`jeromq`生产经验吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-24T04:10:36.697

作为项目的作者，我有点偏见。

我制作 jeromq 的原因是我在部署具有 JNI 的 jzmq 时也遇到了一些麻烦。

该项目的历史很短，但从反馈和贡献中不断改进。

但它不是 jzmq 的替代品。这两个项目都很活跃，并由一个主要社区推动。您可以从社区获得帮助，也可以为项目做出贡献。

从 3.0-SNAPSHOT 开始，它具有 API 级别的兼容性。您可以在 jeromq 和 jzmq 之间轻松切换，而无需更改代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T14:11:03.313

为什么不编写一个与 0MQ 进行所有交互的 JNI？这会将问题交给您，而不是希望某些 3rd 方库足够成熟或可以投入生产。

这就是我要做的。zeromq 的 C/C++ API 恕我直言，是其中最成熟的，因此，我认为它会给您带来最大的好处。

编写 JNI 也不难，所以我认为这将是一个好方法。

# cocoa - NSPredicateEditorRowTemplate 视图未填充谓词

> ID：14491003
> 
> 赞同：1
> 
> 时间：2013-01-23T23:00:25.110
> 
> 标签：cocoa, nspredicateeditor

我有一个`NSPredicateEditor`我正在为其设置自定义模板行视图的。

模板生成正确的谓词，但是当我将编辑器设置`objectValue`为显示谓词时，视图没有填充。模板的`matchForPredicate`功能正常工作，并且正确的模板`setPredicate`在我设置编辑器后得到了编辑器发送的消息`objectValue`，但没有进一步发生。现在，模板的`setPredicate`函数只是调用`super`，但我还没有看到任何我应该做不同的事情。

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T18:54:24.307

这是一个保留问题；一旦修复，一切都按预期工作。

# javascript - 如何使用 bind() 创建隐私

> ID：14491005
> 
> 赞同：1
> 
> 时间：2013-01-23T23:00:36.983
> 
> 标签：javascript

我将一个对象字面量传递给一个名为`supportP()`. 这个对象字面量有一个特殊的属性叫做`_p`，它表示它的成员是私有的。从对象文字中的 with 可以通过`this._p`. 但是，当我将对象文字传递到“外部”范围时，我不会复制`_p`. 它现在已因遗漏而被私有化。为了从公共成员方法访问 _p，我使用将它们绑定到原始对象，`bind()`因此它们仍然可以通过 _p 访问`this`。

这行得通吗？还有其他需要考虑的事情吗？在我测试之前想要一些反馈。

以下是相关的片段。

```
/*$A.supportP
**
**
**
*/
$A.supportP = function (o, not_singleton) {
    var oo
        key;
    SupportList[o.Name] = {};
    if (not_singleton) {
        // ignore this section
    } else { // *look here - isFunc returns true if a function
        for (key in o) {
            if ((key !== '_p') && (isFunc(o[key])) {
                oo[key] = o[key].bind(o);
            } else if (key !== '_p') {
                oo[key] = o[key];
            } else {
                // private (_p) - anything to do here?
            }
        }
        return oo;
    }
};

/*$A.test
**
**
**
*/
var singleton_object = $A.supportP({
    _p: 'I am private',
    Name: 'test',
    publik_func: function () {
        // this will refer to this object so that it can access _p
        // this._p is accessible here due to binding
    }
}, false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:31:11.677

> 这行得通吗？

是的，您将能够通过 访问“私人”财产`this._p`。

> 还有其他需要考虑的事情吗？

您正在克隆对象。然而，它的方法无法访问它 - 它绑定到“旧”对象，其属性不会反映副本上的更改。我不确定这是设计使然还是偶然。

* * *

对于严格的隐私，您将需要使用带有局部变量的闭包。财产永远不能私有化。

```
var singleton_object = (function() {
    var _p = 'I am private'; // local variable
    return {
        Name: 'test',
        publik_func: function () {
            // this will refer to this object so that it can access the properties
            // _p is accessible here due to closure, but not to anything else
        }
    };
}()); // immediately-executed function expression 
```

* * *

另一种解决方案，使用两个不同的对象（一个隐藏的），它们被传递到框架方法中：

```
function bindPrivates(private, obj) {
    for (var key in obj)
        if (typeof obj[key] == "function")
            obj[key] = obj[key].bind(obj, private);
    return obj;
}

var singleton_object = bindPrivates({
    p: 'I am private'
}, {
    Name: 'test',
    publik_func: function (_) {
        // this will refer to this object so that it can access "public" properties
        // _.p, a "private property" is accessible here due to binding the private 
        //  object to the first argument
    }
}); 
```

# apache - 使用 Apache 重定向 URL

> ID：14491009
> 
> 赞同：0
> 
> 时间：2013-01-23T23:01:04.097
> 
> 标签：apache, url, redirect, rewrite

如何让 Apache 自动重定向 URL，例如：

mydomain.com/webpage.php?name=about_me mydomain.com/webpage.php?name=contact 等。

至：

mydomain.com/about_me mydomain.com/contact

此外， mydomain.com/webpage.php?name=home_page 应该简单地重定向到：mydomain.com/

现在，我的 .htaccess 文件中有：

RewriteEngine On RewriteRule ^$ pages.php?name=home_page [L] RewriteRule (.*)/$ pages.php?name=$1 [L]

但是 RewriteRule 不会自动重定向我的访问者，它只是让他们使用短 URL 或长 URL。换句话说，我想强制使用短 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:40:03.367

只是为了验证。你想让 apache 像这样工作吗：

访问者访问“mydomain.com/about_me”，出现“mydomain.com/webpage.php?name=about_me”。访问者访问“mydomain.com/contact”，出现“mydomain.com/webpage.php?name=contact”。

如果你想拥有这个。你应该试试这个：

```
RewriteEngine On
RewriteRule ^(.*)$ webpage.php?name=$1 [L] 
```

如果您希望“mydomain.com/webpage.php?name=about_me”自动重定向到“mydomain.com/about_me”。您应该在webpage.php 文件中添加额外的检查。检查应评估 URI 以查看是否使用了“webpage.php”，如果使用了，则应使用“header”函数重定向到短 URL。所以这里是代码：

```
$page="webpage.php";

if(substr($_SERVER["REQUEST_URI"],0,strlen($page)) == $page) {
  $location = "Location: http://".$_SERVER["SERVER_NAME"]."/".$_GET["name"];
  header($location);
} 
// whatever webpage.php does. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:09:12.013

尝试这个：

```
RewriteEngine On
RewriteRule ^webpage.php?name=(.*)$ /$1 [R=301,L]
RewriteRule ^$ webpage.php?name=home_page [L] 
RewriteRule (.*)/$ webpage.php?name=$1 [L] 
```

# ruby - 使用 Mail gem 从块内部访问变量

> ID：14491016
> 
> 赞同：0
> 
> 时间：2013-01-23T23:01:31.643
> 
> 标签：ruby, variables

我在访问某些变量的内容时遇到问题。我正在使用[Mail gem](https://rubygems.org/gems/mail)并具有以下代码：

```
class Email
  attr_accessor :server, :port, :username, :password, :ssl

  def check_mail
    # puts server --->  imap.googlemail.com ---> work
    Mail.defaults do
      # puts server --->  nil ---> not work
      retriever_method :imap, address:     server, #---> obviously not work
                                 port:       port,
                            user_name:   username,
                             password:   password,
                           enable_ssl:    ssl
    end
  end
end

def account
 acc          = Email.new
 acc.server   = 'imap.googlemail.com'
 acc.port     = '993'
 acc.username = 'xxx'
 acc.password = 'xxx'
 acc.ssl      = 'true'

 acc.check_mail
end 
```

我无法从内部访问变量`Mail.default do`，我想这将是一个类问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:12:58.983

给出的块很可能`Mail`在另一个上下文中执行，并且变量在该范围内不可用。这有时会发生在用 Ruby 编写的某些“领域特定语言”（DSL）中。

您需要桥接您想要使用的任何数据。如果您为配置创建命名空间，这将是可能的：

```
 Mail.defaults do
   retriever_method :...,
     :address => MyModule.address,
     # ...
 end 
```

`mattr_accessor`如果你有这些模块，可以很容易地创建。

也可以使用一种闭包来实现这一点：

```
this = self

Mail.defaults do
  retriever_method :...,
    :address => this.address,
    # ...
end 
```

# javascript - 淡入淡出jQuery

> ID：14491017
> 
> 赞同：-3
> 
> 时间：2013-01-23T23:01:32.407
> 
> 标签：javascript, jquery

我有这个代码：

```
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>

<script>
$(function()
{
    function animation()
    {
        $('#img0').attr('src',$('#img1').attr('src')).fadeOut(4000).attr('src',$('#img2').attr('src')).fadeIn(4000).fadeOut(4000).attr('src',$('#img3').attr('src')).fadeIn(4000).fadeOut(4000) ;
        animation();
    }
});
</script>

<body>
<img  id="img0" width="613" height="260" alt="OffLease Only Lot" />
<img src="static/images/home/slides/SLIDERS-mP.jpg" id="img1" width="613" height="260" alt="OffLease Only Lot" hidden="true" />
<img src="static/images/home/slides/slider_usa.jpg" id="img2"  width="613" height="260" alt="OffLease Only Lot" hidden="true" />
<img src="static/images/home/slides/SLIDERS-ODOMETER.jpg"  id="img3"  width="613" height="260" alt="OffLease Only Lot" hidden="true" />

</body>
</html> 
```

我希望通过更改图像源来幻灯片显示图像，然后通过出现和消失来继续。
但我的代码不起作用

*   为什么？
*   我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:18:40.650

如果您尝试循环三个图像，请执行以下操作：

```
function animate1() {
    $('#img1').fadeIn(4000, function() {
        $('#img1').fadeOut(4000, animate2);
    })
}

function animate2() {
    // Do the same thing here, and do animate3 too
}

$(function() { $('#img0').fadeOut(4000, animate1) }; 
```

我还需要花一点时间浏览一下 jQuery fadeOut 和 fadeIn 页面。我认为它们的工作方式与您认为的不同。

[http://api.jquery.com/fadeOut/](http://api.jquery.com/fadeOut/)

[http://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:07:34.117

您必须像这样等待动画首先完成...

```
element$.fadeOut(4000, function () {

  // Do something when faded out

  element$.fadeIn(4000, function () {

    // Do something when faded in

  });
}); 
```

# jquery - 当 Post 操作已用于文件上传时，如何将 viewModel 回发到控制器

> ID：14491019
> 
> 赞同：0
> 
> 时间：2013-01-23T23:01:38.987
> 
> 标签：jquery, asp.net-mvc

嗨，我有一个这样的控制器：

```
public class MyController : Controller
    {
        public MyController(Uow uow)
        {
            ;
        }

        public ActionResult Index()
        {
            return View();
        }

        [HttpPost]
        public ActionResult Index(HttpPostedFileBase file)
        {
            var validationResults = _uow.GetResults(file.FileName, file.InputStream);

            return View(new MyViewModel { Errors = validationResults.Errors, Data = validationResults.Data });
        }

        [HttpPost]
        public void Save(MyViewModel viewModel)
        {
            //Save the data
        }
    } 
```

这有一个像这样的视图：

```
@model MyViewModel 

<form action="" method="post" enctype="multipart/form-data">

    <label for="file" id="filelabel">Filename:</label>
    <input type="file" name="file" id="file" />

    <input type="submit" id="submitbtn" disabled="disabled" />
    <img class="loader" id="loader" style="display: none;" alt="Loading..." src="@Url.Content("~/Content/Images/ajax-loader.gif")" />

    @if (Model != null && Model.Errors.Any())
    {
        foreach (var error in Model.Errors)
        {
            <span class="error">@error</span>
        }    
    }

    <button id="savebtn" >Save</button>

</form>

<script type="text/javascript">

    $(document).ready(function () {

        $('#file').change(function () {
            alert("in here");
            $('#submitbtn').prop('disabled', false);

        });

        $('#submitbtn').click(function () {

            $('#loader').show();

        });

    });
</script> 
```

所以我在这里想要的是一种将文件上传到控制器的方法。我已经实现了这一点，并在 Index Post 中收到了它。然后我处理这个工作正常。然后我将相关数据放入 viewModel 并重新显示表单。

我想要的是，当按下 Save 按钮时，会使用填充的 viewModel 调用 Save Post 方法。但是，每当我按下按钮时，它都会发布到 Index Post，这是有道理的。

有人可以告诉我如何保留我的文件上传和处理代码，但是当我稍后按下 Save 按钮时，viewModel 会发送到 Save Post 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:28:55.983

如果您必须将这些操作分开并且不更改当前表单，那么您将需要一个单独的表单才能异步发布或不发布到其他操作......这意味着做一些讨厌的事情，比如使用 javascript 更新另一个表单中的隐藏字段每当对第一个表单进行更改...这不是万无一失的，因为可以通过多种方式更改表单字段而无需触发某些 javascript 事件。

当单击保存按钮时，也有可能使用 javascript 更改表单操作。但老实说，这对我来说似乎太脏了，我会使用 viewmodel 到 1 操作方法。

我建议`HttpPostedFileBase`在您的视图模型上使用 Index 操作来处理数据的验证和保存。

有关强类型表单帮助程序和注释，请参阅此示例：[如何在 asp.net mvc 3 中使用 jquery 和 dataannotation 验证输入文件](https://stackoverflow.com/questions/6285624/how-to-validate-input-file-with-jquery-and-dataannotation-in-asp-net-mvc-3)

它显示了一个`HttpPostedFileBase`带有 的属性`DataAnnotations`，如果您需要以这种方式验证它，您可能想尝试编写一个调用您的 UOW 的自定义注释.. 不知道为什么？

我也建议使用 Model.ValidationMessageFor() 帮助器。

接收视图模型的操作的一般模式如下所示：

```
[HttpPost]
public ActionResult Index(MyViewModel myViewModel)
{
    try
    {
        // Check your viewmodel is valid
        if (!ModelState.IsValid)
        {
            // not valid so return to the view with the view model as a param
            // The validation message helpers will display the relevant error messages
            return View(myViewModel);
        }

        // modelstate is valid so perform any work i.e. save to database
        // attach any additional information to the view modal to give feedback maybe?
        // or redirect the user to some other page
        return View(myViewModel);
    }
    catch
    {
        // any exceptions then go back to the view and hopefully the validation helpers will kick in
        return View(myViewModel);
    }
} 
```

就个人而言，我会做这种事情，但你可以明白：

在视图模型中

```
[DisplayName("Update your image")]
[Required]
public HttpPostedFileBase Image { get; set; }
public string ImageName { get; set; } 
```

在视图中

```
@if (Model.ImageName != null) { 
    <img src="@Url.Content("~/uploads/" + Model.ImageName)" alt="" />
}

<div class="control-group">
    @Html.LabelFor(model => model.Image)
    <div class="controls">
        @Html.TextBoxFor(model => model.Image, new { @type = "file", @class = "input-file" })
        @Html.ValidationMessageFor(model => model.Image)
    </div>
</div> 
```

在控制器发布动作中，检查后`ModelState.IsValid`

```
var fileName = "";
// check for a posted file and that it has a size to it before attempting to save the file
if (myViewModel.Image != null && myViewModel.Image.ContentLength > 0)
{
    var currentDate = DateTime.UtcNow.ToString("yyyymmddhhmmss");
    var fileType = Path.GetExtension(myViewModel.Image.FileName);
    Random random = new Random();
    fileName = Path.GetFileNameWithoutExtension(myViewModel.Image.FileName) + "-" + currentDate + random.Next(1, 10000) + fileType;

    // upload the file
    var path = Path.Combine(Server.MapPath("~/uploads"), fileName);
    myViewModel.Image.SaveAs(path);
}

// for saving to the database on an model entity
if (fileName != "")
{
    entity.ImageName = fileName;
} 
```

# bash - 如何在bash中按字母顺序对查找结果（包括嵌套目录）进行排序

> ID：14491020
> 
> 赞同：13
> 
> 时间：2013-01-23T23:01:41.013
> 
> 标签：bash, sorting, find

我有一个基于在 bash 中运行“查找”命令的结果的目录列表。例如， find 的结果是文件：

```
test/a/file
test/b/file
test/file
test/z/file 
```

我想对输出进行排序，使其显示为：

```
test/file
test/a/file
test/b/file
test/z/file 
```

有没有办法在 find 命令中对结果进行排序，或者通过管道将结果进行排序？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-23T23:12:28.747

如果你有 GNU 版本的 find，试试这个：

```
find test -type f -printf '%h\0%d\0%p\n' | sort -t '\0' -n | awk -F '\0' '{print $3}' 
```

要在循环中使用这些文件名，请执行

```
find test -type f -printf '%h\0%d\0%p\n' | sort -t '\0' -n | awk -F '\0' '{print $3}' | while read file; do
    # use $file
done 
```

find 命令为每个文件打印三件事：（1）它的目录，（2）它在目录树中的深度，以及（3）它的全名。通过在输出中包含深度，我们可以使用上面`sort -n`的排序。最后，我们使用删除前两列，因为它们仅用于排序。`test/file``test/a/file``awk`

用作`\0`三个字段之间的分隔符允许我们处理其中包含空格和制表符的文件名（但不幸的是，不是换行符）。

```
$ find test -type f
test/b/file
test/a/file
test/file
test/z/file
$ find test -type f -printf '%h\0%d\0%p\n' | sort -t '\0' -n | awk -F'\0' '{print $3}'
test/file
test/a/file
test/b/file
test/z/file 
```

如果您无法修改`find`命令，请尝试以下复杂的替换：

```
find test -type f | while read file; do
    printf '%s\0%s\0%s\n' "${file%/*}" "$(tr -dc / <<< "$file")" "$file"
done | sort -t '\0' | awk -F'\0' '{print $3}' 
```

它做同样的事情，`${file%/*}`用于获取文件的目录名称和`tr`用于计算斜杠数量的命令，这相当于文件的“深度”。

（我当然希望那里有一个更简单的答案。你所问的似乎并不难，但我正在空白一个简单的解决方案。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-20T19:11:57.400

```
find test -type f -printf '%h\0%p\n' | sort | awk -F'\0' '{print $2}' 
```

结果`find`是，例如，

```
test/a'\0'test/a/file
test'\0'test/file
test/z'\0'test/z/file
test/b'\0'test/b/text file.txt
test/b'\0'test/b/file 
```

其中`'\0'`代表空字符。

这些复合字符串可以用一个简单的正确排序`sort`：

```
test'\0'test/file
test/a'\0'test/a/file
test/b'\0'test/b/file
test/b'\0'test/b/text file.txt
test/z'\0'test/z/file 
```

最后的结果是

```
test/file
test/a/file
test/b/file
test/b/text file.txt
test/z/file 
```

（根据 John Kugelman 的回答，删除了“深度”元素，这绝对是多余的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:19:13.403

尝试这个。作为参考，它首先对第二个字段第二个字符进行排序。它仅存在于文件中，并且具有 ar 的反向含义，它是第一个，之后它将对第二个字段的第一个字符进行排序。[-t 是字段分隔符，-k 是关键]

```
find test -name file |sort -t'/' -k2.2r -k2.1 
```

做一个`info sort`了解更多信息。有很多不同的方法可以一起使用 -t 和 -k 来获得不同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-09T23:25:23.077

如果要按字母顺序排序，最好的方法是：

```
find test -print0 | sort -z 
```

（原始问题中的示例实际上想要目录之前的文件，这不一样，需要额外的步骤）

# sql-server - 如何将 wgs84 坐标映射到 sql server b-tree 索引（不使用内置空间索引）

> ID：14491023
> 
> 赞同：1
> 
> 时间：2013-01-23T23:01:45.807
> 
> 标签：sql-server, geometry, coordinate-systems, wgs84, tessellation

我希望能够将来自 WGS84 的地理点映射到为 ms sql server 格式化的单元格集，如果将相同的坐标对镶嵌到具有 4 个层次网格的 sql server 空间索引中，它将接触到的单元格集每个 256 个单元格。

sql server 2008 空间索引并不理想地满足我们的需求，因为它不支持在同一索引中同时使用地理和非地理数据。

如果我们自己知道如何进行翻译，那似乎可以让我们绕过上述限制。

[此页面](http://technet.microsoft.com/en-us/library/bb964712%28v=sql.100%29.aspx)直观地展示了如何将地理点映射到平面单元，这些平面单元可以单独编码为 1 到最多 4 个正整数的序列。有关编号单元格的示例，请参阅链接页面中的“最深单元格规则”部分。

我基本上是在寻找关于如何做到这一点的伪代码。

任何帮助将不胜感激，如果您知道算法细节，将不胜感激。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-13T09:46:30.880

一个简单的解决方案是交错 x 和 y 坐标，就像在 morton 曲线又名 z 曲线中一样。您可以通过使用最高有效位计算上限来验证它。必应地图使用莫顿曲线：http: [//msdn.microsoft.com/en-us/library/bb259689.aspx](http://msdn.microsoft.com/en-us/library/bb259689.aspx)但希尔伯特曲线要复杂得多，但在大多数情况下也更好。在希尔伯特曲线中，它使用格雷码作为坐标。这是一些代码示例：[将 N 维值映射到希尔伯特曲线上的点](https://stackoverflow.com/questions/499166/mapping-n-dimensional-value-to-a-point-on-hilbert-curve/10384110#10384110)。

# c - Arduino EEPROM 看起来很脆弱，我应该写两次吗？

> ID：14491028
> 
> 赞同：1
> 
> 时间：2013-01-23T23:02:07.703
> 
> 标签：c, arduino, eeprom

我习惯于使用高级语言对 PC 和智能手机进行编程，微控制器对我来说是一个新领域。它们是否在某种程度上不同，更不值得信赖，需要不同的技术？以下是在 Arduino Mega 上运行的 EEPROM 写入和读取的代码：（附有以太网屏蔽，此处未使用）

```
#include <EEPROM.h>
int addr = 0;
int val;
byte value;
void setup()
{
  Serial.begin(9600);
}
void loop()
{
  val = 9;
  EEPROM.write(addr, val);
  delay(500);
  addr = addr + 1;
  if (addr == 20) addr = 0;
  value = EEPROM.read(addr);
  Serial.print(addr);
  Serial.print("\t");
  Serial.print(value);
  Serial.println();  
} 
```

下面是结果：

```
1   91
2   91
3   9
4   9
5   9
6   9
7   9
8   9
9   9
10  9
11  9
12  202
13  202
14  202
15  202
16  202
17  202
18  202
19  202
0   9
1   89
2   91
3   9
4   9
5   9
6   9
7   9
8   9
9   9
10  9
11  9
12  9
13  9
14  9
15  9
16  9 
```

..... 一般来说，地址 1 和 2 总是不稳定的，需要两次写入才能更改 ~10 以上的内存位置。

我可以换掉另一块板，但仍然会遇到类似的怪事。

如何使我的编程适应这种看似不稳定的性能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T23:09:10.667

简而言之，您的代码是错误的。

逻辑地逐步完成它。您正在写入 address 的 EEPROM `addr`。然后等待 500 毫秒，递增`addr`，然后从新的`addr`. 因此，`addr`您读取的内容不是`addr`您写入的内容。

# php - 导出为 CSV PHP 作为下载文件

> ID：14491037
> 
> 赞同：1
> 
> 时间：2013-01-23T23:02:45.917
> 
> 标签：php, mysql, fopen, fputcsv

我正在使用 CSV 文件导出 mysql 表。`C:`既然它直接存储在云端硬盘上而没有任何通知，我如何将其作为下载文件查看

```
<?php
$host = 'localhost'; // <--  db address
$user = 'root'; // <-- db user name
$pass = 'root'; // <-- password
$db = 'urs'; // db's name
$table = 'veiwresult'; // table you want to export
$file = 'alaa'; // csv name.
$link = mysql_connect($host, $user, $pass) or die("Can not connect." . mysql_error());
mysql_select_db($db) or die("Can not connect.");
$result = mysql_query(" SELECT ApplicantNum,name, averg,choice FROM veiwresult");
fputcsv($f, array('ApplicantNum','name','averg', 'choice'));
$timestamp = date('Ymd-His'); 

$f = fopen("C:/mycsv-{$timestamp}.csv", 'w');
// Headers    
while($row = mysql_fetch_row($result))
{
fputcsv($f, $row);
}

fputcsv($f, $items_array);
fclose($f);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T16:29:38.510

如果你想存储 csv 文件，然后不点击就打开它，这是不可能的。

如果您只想打开它，请通过以下方式在浏览器窗口中打开它

```
header('Content-disposition: inline;filename=foobar.csv');
header('Content-Type: text/csv;charset=UTF-8');
echo $csv_content; 
```

其中 $csv_content 是一个包含 csv 文件内容的字符串。你的猫是这样理解的

```
$csv_content = file_get_contents('c:/mycsv.csv'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:07:21.073

要下载它...

```
<?php
$host = 'localhost'; // <--  db address
$user = 'root'; // <-- db user name
$pass = 'root'; // <-- password
$db = 'urs'; // db's name
$table = 'veiwresult'; // table you want to export
$file = 'alaa'; // csv name.
$link = mysql_connect($host, $user, $pass) or die("Can not connect." . mysql_error());
mysql_select_db($db) or die("Can not connect.");
$result = mysql_query(" SELECT ApplicantNum,name, averg,choice FROM veiwresult");
fputcsv($f, array('ApplicantNum','name','averg', 'choice'));
$timestamp = date('Ymd-His'); 

$f = fopen("C:/mycsv-{$timestamp}.csv", 'w');
// Headers    
while($row = mysql_fetch_row($result))
{
fputcsv($f, $row);
}

fputcsv($f, $items_array);
fclose($f);

header('Content-type: application/csv');
header('Content-Disposition: attachment; filename="mycsv-{$timestamp}"');
readfile('C:/mycsv-{$timestamp}.csv');
?> 
```

这仍会通知用户下载，并且根据他们的设置，他们可能需要接受下载。这个功能当然不能被覆盖。

# javascript - Youtube api 无法在 Firefox 上加载

> ID：14491041
> 
> 赞同：1
> 
> 时间：2013-01-23T23:02:53.970
> 
> 标签：javascript, jquery, youtube, youtube-api

我有以下控制嵌入式 youtube 播放器的代码片段。它适用于 Chrome 和 Safari，但不适用于 Firefox。

jsfiddle：http: [//jsfiddle.net/fuSSn/4/](http://jsfiddle.net/fuSSn/4/)

我的应用程序中的代码：

内嵌框架：

```
<div class="tubeframe" id="video-frame-155" style="">
<iframe title="YouTube video player" width="350" height="262"      src="http://www.youtube.com/embed/hc5xkf9JqoE?HD=1;rel=0;showinfo=0;autohide=1" frameborder="0" allowfullscreen="" id="video-frame-155-frame"></iframe>
</div> 
```

我的JavaScript：

```
var source_tag = document.createElement("script");

var first_source_tag = document.getElementsByTagName("script")[0];
first_source_tag.parentNode.insertBefore(source_tag, first_source_tag);

// This function will be called when the API is fully loaded
function onYouTubeIframeAPIReady() {
YT_ready(true)
console.log("api loaded! yikes")
}

function getFrameID(id){
var elem = document.getElementById(id);
if (elem) {
    if(/^iframe$/i.test(elem.tagName)) return id; //Frame, OK
    // else: Look for frame
    var elems = elem.getElementsByTagName("iframe");
    if (!elems.length) return null; //No iframe found, FAILURE
    for (var i=0; i<elems.length; i++) {
       if (/^https?:\/\/(?:www\.)?youtube(?:-nocookie)?\.com(\/|$)/i.test(elems[i].src)) break;
    }
    elem = elems[i]; //The only, or the best iFrame
    if (elem.id) return elem.id; //Existing ID, return it
    // else: Create a new ID
    do { //Keep postfixing `-frame` until the ID is unique
        id += "-frame";
    } while (document.getElementById(id));
    elem.id = id;
    return id;
}
// If no element, return null.
return null;
}
// Define YT_ready function.
var YT_ready = (function(){
  var onReady_funcs = [], api_isReady = false;
  return function(func, b_before){
      if (func === true) {
          api_isReady = true;
          while(onReady_funcs.length > 0){
              // Removes the first func from the array, and execute func
              onReady_funcs.shift()();
          }
      }
      else if(typeof func == "function") {
          if (api_isReady) func();
          else onReady_funcs[b_before?"unshift":"push"](func);
      }
  }
})();

var video = function ( videoid,  frameid) {
var player;
var that;
var seconds;
var duration;
var stateChangeCallback;
var update_play = 0;
  return {
    setOnStateChangeCallback: function(callback) {
      stateChangeCallback = callback;
    },
    getCurrentTime: function() {
      return player.getCurrentTime();
    },

    getPlayer: function () {
      return player;
    },
    getVideoFrameId: function () {
      return "video-frame-" + videoid;
    },
    initVideo: function (second) {
        console.log("initing")
      that = this;
      YT_ready(function(){
        var frameID = getFrameID("video-frame-" + videoid);
        console.log("creating player")
          console.log(frameID)
        if (frameID) { //If the frame exists
          console.log("frame exists")
          player = new YT.Player(frameID, {
              events: {
                  "onStateChange": that.stateChange
              }

          });
          console.log("Player Created!");
          if (second) {
            console.log(second)
            setTimeout(function() { console.log("seek to"); player.seekTo(second, false); player.stopVideo()}, 1000);
          }
        }
      });
    },
    stateChange: function (event) {
      console.log("event.data = ", event.data);
      switch(event.data) {
        case YT.PlayerState.PLAYING:
        {
          if (stateChangeCallback)
            stateChangeCallback("play", player.getCurrentTime(), player.getDuration());
            onsole.log("play");
        }
        break;
        case YT.PlayerState.PAUSED:
        case YT.PlayerState.CUED:
        case YT.PlayerState.ENDED:
        {
          if (stateChangeCallback)
            stateChangeCallback("pause", player.getCurrentTime(), player.getDuration());
          console.log("pause");
        }
        break;
      }
    },
    pauseVideo: function () {
      player.stopVideo();
      console.log('player.stopVid()');
    },
    seekTo: function(second) {
      player.seekTo(second, false);
    }
  };
};

function onStateChange(vid, action, second, total) {
if (Videos[vid]) {
  console.log( (second / total) * 100);
}
};

$(document).ready(function () {
var Videos = {};
logger.info("heyyy")
var videoId=155;
//if (videoId) {
  Videos[videoId] = video(videoId,  155);
    console.log(Videos[155])
  Videos[155].initVideo();
  Videos[155].setOnStateChangeCallback(function(action, second, total) {
    onStateChange(155, action, second, total);
  });
//}
Videos[155].seekTo(1000, false);
onStateChange(155, "start", 0, 0);
}); 
```

我知道正在添加所需的脚本标签，我可以从控制台进行测试。我也知道实际上调用了 onYouTubePlayerAPIReady() 。但我仍然收到类似的错误

> TypeError: player.stopVideo 不是函数

当我从 Firefox 的 Web 控制台再次运行添加源标签的三行代码时，api 似乎已加载，一切都重新开始工作。

我已经为此苦苦挣扎了好几天，我真的需要帮助找出可能出了什么问题。如果它有助于我的应用程序在 ruby​​ on rails 中开发，但我认为这不是相关信息。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T06:54:55.550

上面的代码没有问题。我的视频以引导模式加载。Modal 的 hide 属性将使其对 firefox 不可见，并且 firefox 根本不会加载 api。所以我删除了模态隐藏类，而不是 display:none 我使用 item.css("visibility", "visible"); 和 item.css("可见性", "隐藏"); 这使Firefox加载了api。

# mysql - 使用 INNER JOIN 进行 SQL 更新

> ID：14491042
> 
> 赞同：1
> 
> 时间：2013-01-23T23:02:54.657
> 
> 标签：mysql, sql, inner-join

我正在尝试使用此查询

```
UPDATE products  
SET products.product_price = '87.00000'
FROM products
INNER JOIN product_category
ON products.product_id = product_category.product_id 
WHERE product_category.category_id = '64' 
```

但是我收到此错误：`#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM table products INNER JOIN table product_category ON prod' at line 3`

我没有看到任何语法错误。我从这个论坛上的例子中提出了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:05:55.960

删除`FROM products`线。并将该 `SET ...`行放在`WHERE`子句之前。

要清楚：

```
UPDATE ...
JOIN ...
SET ...
WHERE ... 
```

你也可以

```
UPDATE products p
SET p.product_price='87.00000'
WHERE EXISTS (SELECT NULL 
              FROM product_category pc
              WHERE p.product_id = pc.product_id
              AND pc.category_id = '64'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:08:53.360

您可以使用以下内容：

```
UPDATE products 
INNER JOIN product_category
  ON products.product_id = product_category.product_id 
SET products.product_price = '87.00000'
WHERE product_category.category_id = '64'; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/00fee)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T23:09:26.923

我认为 SET 子句需要在表引用之后和 WHERE 子句之前，如下所示：

```
UPDATE products
 INNER
  JOIN product_category
    ON products.product_id = product_category.product_id 
   SET products.product_price = '87.00000'
 WHERE product_category.category_id = '64' 
```

* * *

当我需要这样的 UPDATE 时，这就是我获得该语法的方法。我总是从一个 select 语句开始，它让我知道哪些行将被更新。例如：

```
SELECT p.*, c.*
  FROM products p
  JOIN product_category c
    ON p.product_id = c.product_id 
 WHERE c.category_id = '64' 
```

要将其转换为更新语句，我`SET`在表引用之后和子句之前添加了一个“”子句`WHERE`，然后将“ `SELECT ... FROM`”替换为“ `UPDATE`”关键字。瞧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T23:09:40.373

```
UPDATE products
INNER JOIN product_category
ON products.product_id = product_category.product_id 
SET products.product_price = '87.00000'
WHERE product_category.category_id = '64' 
```

# php - 使用 codeigniter 检索用户的真实 IP

> ID：14491043
> 
> 赞同：7
> 
> 时间：2013-01-23T23:02:59.373
> 
> 标签：php, codeigniter

我的应用程序会跟踪登录该站点的用户的 IP 地址。跟踪在常规 Web 服务器上运行良好（我们在 hostgator 上），但是当我们切换到 PaaS 平台（pagodabox）时，似乎开始跟踪奇怪的 IP 地址。在与 pagodabox 支持人员交谈后，他们告诉我 IPs codeigniter 正在接收pagodabox 的负载均衡器/路由器的 IP 并获取用户的实际 IP 地址，我必须使用`HTTP_X_FORWARDED_FOR`

我正在使用 codeigniter 的输入类函数`$this->input->ip_address()`来检索用户的 IP。我查看了该功能，发现它们具有某种功能来检索 `HTTP_X_FORWARDED_FOR`IP 值，但我不知道如何使用它。我必须在配置中更改/添加一些东西吗？

编辑：在一些用户指出我应该在负载均衡器的 IP 地址列表中添加的位置之后，出现了一个新问题：如果 IP 列表经常更改，我该怎么办？（即没有静态IP，全是动态的）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-28T16:28:03.367

我确定您现在已经解决了这个问题，但我想我会发布正确的答案以供将来参考。我遇到了同样的问题（在 AWS 上使用负载均衡器和 CodeIgniter 应用程序。）正如您所指出的，使用 HTTP_X_FORWARDED_FOR 标头在负载均衡器或其他分布式环境后面获取正确的 IP 很容易。问题是我们如何在 CodeIgniter 中正确实现这个解决方案？正如前面的答案所指出的：编写自己的 IP 函数。问题在于，如果在整个应用程序中调用 ip_address() 会怎样？重写该函数不是更好吗（使用查看正确标题的函数）？CodeIgniter 有一个方便的机制，很方便：

解决方案是扩展 CodeIgniter Input 类，方法是在 /application/core 中创建一个名为 MY_Input.php 的新类文件（MY_ 是扩展的可配置前缀，您可以在配置文件中更改它）。使用扩展，您可以创建与原始类方法同名的函数，而无需破坏任何内容，也无需编辑核心文件。CodeIgniter 将只使用您的新方法。您的扩展输入类将如下所示：

```
class MY_Input extends CI_Input {

    function __construct()
    {
        parent::__construct();
    }
    //Overide ip_address() with your own function
    function ip_address() 
    {
        //Obtain the IP address however you'd like, you may want to do additional validation, etc..
        $correct_ip_address = $_SERVER['HTTP_X_FORWARDED_FOR'];  
        return $correct_ip_address;
    }
} 
```

通过这种方式，我们在不破坏框架的情况下更改了核心行为，并且整个应用程序中对 ip_address() 的现有调用现在将使用您的方法。

关于处理链中的其他 IP，如果您只对客户端 IP 感兴趣，那应该没关系。至少使用 AWS 负载均衡器，HTTP_X_FORWARDED_FOR 标头似乎总是包含正确的客户端 IP。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-12-19T10:00:58.823

Oliver 的解决方案有效，但在某些情况下，如果您知道正在使用的代理 IP 地址，则最好使用以下内容。编辑您的 application/config/config.php 文件以包含以下内容：

```
$config['proxy_ips'] = '1.2.3.4, 2.3.4.5'; 
```

另请注意，标头信息通常不可靠，不应用于安全敏感目的。例如，限制管理员用户仅使用某些白名单 IP 地址的情况并不少见。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T23:08:25.770

```
<?php 
function getIPfromXForwarded() 
{ 
    $ipString = @getenv("HTTP_X_FORWARDED_FOR"); 
    $addr     = explode(",",$ipString); 

    return $addr[sizeof($addr)-1]; 
} 
?> 
```

尝试类似的东西。看看它是否有效。用法：

```
<? echo getIPfromXForwarded(); ?> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-07T15:07:08.130

在您的情况下，您可以将指定的负载平衡器 IP 添加到`$config['proxy_ips']`( `application/config/config.php`) 中，例如：

```
$config['proxy_ips'] = ['192.168.1.2']; 
```

* * *

### 动态代理IP：

根据您的动态 IP 问题，您可以屏蔽 Load-Balancer 网络的 IP 范围，例如：

```
 $config['proxy_ips'] = '192.168.1.0/24'; 
```

> 掩码功能可以在 Codeigniter 3 中使用

* * *

### 获取IP方法：

```
$this->input->ip_address(); 
```

While`$this`指的是 CI 实例。

> 此方法会考虑 $config['proxy_ips'] 设置，并将返回报告的 HTTP_X_FORWARDED_FOR、HTTP_CLIENT_IP、HTTP_X_CLIENT_IP 或 HTTP_X_CLUSTER_CLIENT_IP 地址以获得允许的 IP 地址。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-04T09:53:43.643

我知道有一个很好的答案与您的问题相关并且被您接受，但对于未来的用户，我正在分享一个在所有情况下都对我完美运行的功能。

```
 public function ip()
    {
        $ipaddress = '';
        if ($_SERVER['HTTP_CLIENT_IP'])
            $ipaddress = $_SERVER['HTTP_CLIENT_IP'];
        else if($_SERVER['HTTP_X_FORWARDED_FOR'])
            $ipaddress = $_SERVER['HTTP_X_FORWARDED_FOR'];
        else if($_SERVER['HTTP_X_FORWARDED'])
            $ipaddress = $_SERVER['HTTP_X_FORWARDED'];
        else if($_SERVER['HTTP_FORWARDED_FOR'])
            $ipaddress = $_SERVER['HTTP_FORWARDED_FOR'];
        else if($_SERVER['HTTP_FORWARDED'])
            $ipaddress = $_SERVER['HTTP_FORWARDED'];
        else if($_SERVER['REMOTE_ADDR'])
            $ipaddress = $_SERVER['REMOTE_ADDR'];
        else
            $ipaddress = 'UNKNOWN';
        echo $ipaddress ;
     } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-06-21T14:42:21.500

我遇到了 Thava 解决方案的一个版本，该版本非常适用于负载均衡器 IP 可以更改（例如 AWS）并且仍然在本机利用 CI 配置文件的情况。当您知道您在 LB 后面运行时，您可以将 config.php 修改为：

```
$config['proxy_ips'] = isset($_SERVER["REMOTE_ADDR"]) ? $_SERVER["REMOTE_ADDR"] : ''; 
```

知道 REMOTE_ADDR 将永远是当前的 LB。

感谢 Eric Brown 在这里[https://expressionengine.com/forums/archive/topic/185751/amazon-load-balancing-and-codeigniter-configproxy_ips#925678](https://expressionengine.com/forums/archive/topic/185751/amazon-load-balancing-and-codeigniter-configproxy_ips#925678)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-06T18:53:19.847

我在工作中遇到了同样的情况，除了 IP 并不是真正的“动态”，而是管理代理和负载平衡器的“基础设施人员”出于未公开的原因经常更改它们。所以我们不得不协商，我们想出了一个解决方案，在他们的配置/配置管理工具中设置一个钩子，以便在某个地方（在运行我们的 Apache/PHP 的用户可以访问的文件夹中）写入一个配置文件。

因此，我使用 CI 挂钩在系统引导程序上读取该文件，以更改我的应用程序配置，更新代理 IP 列表、缓存路径、cookie 域等值。

# ruby-on-rails-3 - 在编辑表单中显示标题而不是 id

> ID：14491054
> 
> 赞同：0
> 
> 时间：2013-01-23T23:03:59.547
> 
> 标签：ruby-on-rails-3, nested-attributes, model-associations

假设我有一些清单和一些任务。每个列表可以有很多任务，一个任务属于一个列表。当我编辑其中一个任务栏时，在输入字段中显示相应列表的 ID。

如何显示列表的标题而不是 id？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:47:16.267

您可能想`select`在表单代码中使用与此类似的输入：

```
<%= f.select :list_id, List.all.collect { |l| [l.name, l.id] } %> 
```

这将显示`name`each `List`，但实际上会将 分配`id`给任务的`list_id`

# xml - 创作 XSD 以允许可扩展元素

> ID：14491056
> 
> 赞同：3
> 
> 时间：2013-01-23T23:04:32.930
> 
> 标签：xml, xsd, schema

我想编写一个 XSD 来验证 XML 文件。XML 文件的示例可能如下所示：

```
<person>
    <fullname>John Doe</fullname>
    <age>25</age>
    <gender>male</gender>
</person> 
```

其中一项要求是`<person>`标签是可扩展的，这意味着除了上面需要的 3 个子元素之外，它还可以包含任意名称的任意元素。因此，该文档在通过 XSD 验证时有效。

```
 <person>
    <fullname>John Doe</fullname>
    <age>25</age>
    <gender>male</gender>
    <address>USA</address>
    <profession>worker</profession>
</person> 
```

我阅读了有关`<xs:any />`元素的信息，但 XSD 不允许我放入`<xs:any />`元素`<xs:all />`中。我希望`<fullname>`,`<gender>`和`<age>`元素是必需的，并且它们中的每一个都必须恰好出现一个。除此之外，可以有零个或多个可选元素。

是否可以使用受支持的 XSD 规则来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-22T09:20:52.383

结合 xs:all 和 xs:any 可以创建模棱两可的内容，这就是不允许的原因。但如果内容包含在 xs:sequence 中，您可以这样做。

*注意：确保 xs:any 上的命名空间和 processContent 属性已根据您的要求正确设置。*

[他们在 XSD 1.1 中使用xs:openContent](http://www.liquid-technologies.com/Reference/XmlStudio/XsdEditorNotation_OpenContent.html)标签更好地支持这种可扩展性，但是对 XSD 1.1 的支持。仍然有限。

[![在此处输入图像描述](../Images/29ab65361e7029c4867f57997c002a72.png)](https://i.stack.imgur.com/EVGqF.png)

```
 <?xml version="1.0" encoding="utf-8" ?>
<!--Created with Liquid XML 2016 Developer Bundle Edition 14.1.3.6618 (https://www.liquid-technologies.com)-->
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="person">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="fullname" type="xs:string" />
                <xs:element name="age" type="xs:int" />
                <xs:element name="gender">
                    <xs:simpleType>
                        <xs:restriction base="xs:string">
                            <xs:enumeration value="male" />
                            <xs:enumeration value="female" />
                        </xs:restriction>
                    </xs:simpleType>
                </xs:element>
                <xs:any namespace="##any" processContents="skip" />
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

# python - 在 pySerial 中发送和读取 ASCII 值

> ID：14491061
> 
> 赞同：0
> 
> 时间：2013-01-23T23:04:52.027
> 
> 标签：python, pyserial

我正在尝试与使用 python 和 pySerial 以 ASCII 格式进行通信的秤进行通信。我从来没有使用过 ASCII 格式的经验。所以我有基本的问题。例如，我将如何使用 pySerial 发送一个字符 T 并使用 ASCII 格式使用 CRLF 终止它？我试过了

```
 myserialport.write('TCRLF')
 myserialport.write('T\r\n')
 myserialport.write('T\n\r') 
```

我也试图从规模中读取数据，例如，我希望以“208.01 g”的形式。但是当我使用

```
myserialport.read(10) 
```

或者

```
myserialport.readline(10) 
```

我从秤上得到这个

```
]ëýýÿ]W
ÿ]u_u]ÿ]uÕ
ýWýWë]uÝõW
ÿ½õÿ½WW]Ýý
WýW]Wÿ½ÿ×ë 
```

从谷歌搜索看来，pySerial 默认情况下应该接收 ASCII 格式的数据，并发送它......但我不知道它为什么不工作。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:45:48.337

这是将带有 CRLF 的字符发送到串行端口的正确方法：

```
myserialport.write('T\r\n') 
```

关于混乱的响应 - 确保正确设置波特率、数据位数、停止位和奇偶校验位。您可以在秤的数据表中找到所需的值。

例如：

```
from serial import Serial, SEVENBITS, STOPBITS_ONE, PARITY_EVEN
myserialport = Serial('/dev/ttyS0', baudrate=9600, bytesize=SEVENBITS, parity=PARITY_EVEN, stopbits=STOPBITS_ONE) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:16:03.317

问题是 USB 到串行转换器的接地连接（引脚 7 需要接地）。如果您有同样的问题，请检查您的引脚。（Fisher Scintific 秤使用引脚 7 作为接地，这是不正常的，因为引脚 5 接地......奇怪......）谢谢大家。

# macos - Webview loadRequest 不起作用

> ID：14491062
> 
> 赞同：3
> 
> 时间：2013-01-23T23:04:53.490
> 
> 标签：macos, cocoa

在我的应用程序中，我使用 Webview 根据用户的首选语言加载不同版本的网站。为此使用 WebFrame 的 loadRequest 方法 -

[[aWebView mainFrame] loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:aStr]]];

如果 aStr 仅包含英文字母，即如果 aStr = http : // ....../language/English ，则其工作正常且网页加载。但是，如果 aStr 类似于 http://....../language/ウンウンウン(Japanese)，则不会发生任何事情，WebView 既不会加载，也不会引发任何错误。如果我在 Safari 中粘贴相同的链接，网页会在那里加载。有关如何解决此问题的任何建议？

我也试过 [aWebView setMainFrameURL:aStr] 方法。那里也有同样的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:50:35.397

您必须先转义无效的 URL 字符，`aStr`然后才能使用它来创建 NSURL `[aStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]`。

```
//Encode invalid URL characters
aStr = [aStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]
[[aWebView mainFrame] loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:aStr]]]; 
```

`URLWithString:`如果字符串无效，则返回 nil 值。这就是为什么您的 UIWebView 没有错误并且不加载任何内容的原因。

# ios - 当用户在 iOS 版 Facebook 上传 2 张或更多照片时如何获取所有照片

> ID：14491063
> 
> 赞同：3
> 
> 时间：2013-01-23T23:05:10.687
> 
> 标签：ios, facebook, sdk

```
{
    comments =         {
        count = 0;
    };
    "created_time" = "2013-01-23T06:12:43+0000";
    from =         {
        id = 1171029418;
        name = "Ilse Anhy";
    };
    icon = "https://fbstatic-a.akamaihd.net/rsrc.php/v2/yz/r/StEh3RhPvjk.gif";
    id = "1171029418_10200426347839190";
    link = "https://www.facebook.com/photo.php?fbid=10200426378279951&set=a.3604514069432.2168112.1171029418&type=1&relevant_count=2";
    "object_id" = 10200426378279951;
    picture = "https://fbcdn-photos-a.akamaihd.net/hphotos-ak-ash4/265145_10200426378279951_1504367216_s.jpg";
    privacy =         {
        value = "";
    };
    "status_type" = "added_photos";
    story = "Ilse Anhy added 2 new photos.";
    "story_tags" =         {
        0 =             (
                            {
                id = 1171029418;
                length = 9;
                name = "Ilse Anhy";
                offset = 0;
                type = user;
            }
        );
    };
    type = photo;
    "updated_time" = "2013-01-23T06:12:43+0000";
} 
```

在“故事”对象中，它显示“Ilse Anhy 添加了 2 张新照片”。在“图片”对象中，它仅提供对单张照片的引用。我怎样才能检索另一张照片？

# r - R 中的 sys.frame、sys.nframe 等

> ID：14491064
> 
> 赞同：3
> 
> 时间：2013-01-23T23:05:14.310
> 
> 标签：r, operating-system, environment

有人可以向我解释一下这些不同的环境功能具体做什么吗？即哪一个返回什么帧？阅读文档后，我感到非常困惑（h​​ttp://stat.ethz.ch/R-manual/R-patched/library/base/html/sys.parent.html）

让我们对这个问题提出一些结构：

```
x = 1; y=2; z=3;
f = function() { ls(); ls(envir=sys.frame());}
#this first prints the contents of this function and then of the global environment 
```

我试图了解如何访问调用函数的环境并了解您所处的环境。例如`g`可以调用`f`：

```
g = function() { somevar=1; f() } 
```

如果我想获取 的内容`g`，我该怎么做？框架和环境有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:32:50.707

`parent.frame()`指调用环​​境。你通常不需要其余的。对于您的示例，请使用此列表`somevar`：

```
f <- function() ls(parent.frame()) 
```

# android - 标记位置更改事件

> ID：14491069
> 
> 赞同：3
> 
> 时间：2013-01-23T23:05:45.937
> 
> 标签：android, android-maps, android-maps-v2

我正在使用新的 Google Maps for Android v2。有没有办法为标记位置更改设置监听器？例如，当用户拖动标记时。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T23:16:20.130

引用[文档](https://developers.google.com/maps/documentation/android/marker#marker_drag_events)：

> 您可以使用 OnMarkerDragListener 来侦听标记上的拖动事件。要在地图上设置此侦听器，请调用 GoogleMap.setOnMarkerDragListener。要拖动标记，用户必须长按标记。当用户将手指从屏幕上移开时，标记将停留在该位置。拖动标记时，最初会调用 onMarkerDragStart(Marker)。在拖动标记时，会不断调用 onMarkerDrag(Marker)。在拖动结束时调用 onMarkerDragEnd(Marker)。您可以通过调用 Marker.getPosition() 随时获取标记的位置。

[这是一个示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/MapsV2/Drag)，演示了`OnMarkerDragListener`.

# java - 多边形区域内计算

> ID：14491076
> 
> 赞同：0
> 
> 时间：2013-01-23T23:06:21.400
> 
> 标签：java, math, gps

我得到以下代码，我从 XML 文件中读取 GPS 坐标，然后我想检查我当前的位置（纬度和经度）是否在这个多边形区域内......不确定是否做错了:(看起来像我的 IsInsideRegion 方法失败了欢迎任何建议。

公共类点{

```
private double _latitude = 0d;
private double _longitude = 0d;

public Point() {
}

public Point(double aLatitude, double aLongitude) {
    _latitude = aLatitude;
    _longitude = aLongitude;
}

public Point(String pointData) throws Exception {
    FromString(pointData);
}

public static String ToString(Point point) {
    StringBuilder result = new StringBuilder();
    result.append(point._latitude).append(",").append(point._longitude);
    return result.toString();
}

public void FromString(String pointData) throws Exception {

    String[] fields = pointData.split(",");
    if (fields.length != 2)
        throw new FormatException("Invalid input data: " + pointData + " in " + this.getClass().getName());

    _latitude = parseDouble(fields[0]);
    _longitude = parseDouble(fields[1]);
}

private double parseDouble(String aValue) {
    double result = 0d;
    try {
        result = Double.parseDouble(aValue);
    } catch (Exception ex) {
    }

    return result;
}

public double getLatitude() {
    return _latitude;
}

public double getLongitude() {
    return _longitude;
}

public boolean IsInsideRegion(double latitude, double longitude)
{

    //Log.d("<GPD><POLY>","PR :" + String.valueOf(_pointList));

    Boolean result = false;
    if (_pointList != null && _pointList.size() > 0) {
        int Index1 = 0;
        int Index2 = _pointList.size() - 1;

        while (Index1 < _pointList.size())
        {
            if ((((_pointList.get(Index1).getLongitude() <= longitude) && (longitude < _pointList.get(Index2).getLongitude())) || ((_pointList.get(Index2).getLongitude() <= longitude) && (longitude < _pointList.get(Index1).getLongitude()))))
            {
                if (latitude < (_pointList.get(Index2).getLatitude() - _pointList.get(Index1).getLatitude()) * (longitude - _pointList.get(Index1).getLongitude()) / (_pointList.get(Index2).getLongitude() - _pointList.get(Index1).getLongitude()) + _pointList.get(Index1).getLatitude())
                    result = !result;
            }

            Index2 = Index1;
            Index1++;
        }
    }
    if (result)
        Log.d("<GPD><POLY>", "In Polygon Region:" + this.getId());
    return result;
}

private void calculateMinMaxLatLong(double aMinLatitude, double aMaxLatitude, double aMinLongitude, double aMaxLongitude)
{
    /*
    _minLatitude = 0d;
    _maxLatitude = 0d;
    _minLongitude = 0d;
    _maxLongitude = 0d;

    for (Point currentPoint: _pointList)
    {
        if (currentPoint.getLatitude() < aMinLatitude)
            _minLatitude = currentPoint.getLatitude();

        if (currentPoint.getLatitude() > aMaxLatitude)
            _maxLatitude = currentPoint.getLatitude();

        if (currentPoint.getLongitude() < aMinLongitude)
            _minLongitude = currentPoint.getLongitude();

        if (currentPoint.getLongitude() > aMaxLongitude)
            _maxLongitude = currentPoint.getLongitude();
    }*/

    double smallestLat = _pointList.get(0).getLatitude();
    double largestLat = _pointList.get(0).getLatitude();

    double smallestLong = _pointList.get(0).getLongitude();
    double largestLong = _pointList.get(0).getLongitude();

    for (int x = 0; x < _pointList.size(); x++){

        if(smallestLat > _pointList.get(x).getLatitude())
            smallestLat = _pointList.get(x).getLatitude();

        if(largestLat < _pointList.get(x).getLatitude())
            largestLat = _pointList.get(x).getLatitude();

        if(smallestLong > _pointList.get(x).getLongitude())
            smallestLong = _pointList.get(x).getLongitude();

        if(largestLong < _pointList.get(x).getLongitude())
            largestLong = _pointList.get(x).getLongitude();
    }

    _minLatitude = smallestLat;
    _maxLatitude = largestLat;
    _minLongitude = smallestLong;
    _maxLongitude = largestLong;
} 
```

公共 RegionChecker() {}

```
public RegionChecker(boolean aEnterFirstOnly) {
    _enterFirstOnly = aEnterFirstOnly;
}

public List<Region> CheckGpsPosition(List<Region> aActiveRegion, List<Region> aRegionList, MyLocation aLocation, IRegionEventListener aListener) {
    List<Region> result = new ArrayList<Region>();
    Log.i("RegionChecker", "aRegionList " + String.valueOf(aRegionList.size()));

    boolean regionChanges = false;
    List<Region> overlappingPositionsList = new Regions().InsideRegions(aRegionList, aLocation.getLatitude(), aLocation.getLongitude());

    if (_enterFirstOnly)
    {
        if (overlappingPositionsList != null && overlappingPositionsList.size() > 0)
        {
            Region firstRegion = overlappingPositionsList.get(0);
            overlappingPositionsList.clear();
            overlappingPositionsList.add(firstRegion);
        }
    }

    Log.i("RegionChecker", "_activeRegions " + String.valueOf(aActiveRegion.size()));
    Log.i("RegionChecker", "overlappingPositionsList " + String.valueOf(overlappingPositionsList.size()));

    for(Region currentRegion: overlappingPositionsList) {

        Log.i("overlap check", String.valueOf(aActiveRegion.contains(currentRegion)));

        if (!aActiveRegion.contains(currentRegion)) {
            regionChanges = true;
            aListener.onRegionEnter(currentRegion, aLocation);
        }
    }

    for(Region currentRegion: aActiveRegion) {
           if (!overlappingPositionsList.contains(currentRegion)) {
               regionChanges = true;
               aListener.OnRegionExit(currentRegion, aLocation);
           }
    }

    result = overlappingPositionsList;

    if (regionChanges)
        aListener.OnCurrentRegionsChanged(result);

    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:23:05.183

我认为您必须修改您的区域检查器。

*   它应该使用经度或纬度，但不能同时使用两者。所以它会检查水平光线有多少次穿过顶点之间的线。或者它检查垂直线的次数。
*   它需要处理点对和索引 0 & 1、1 & 2 ... n-2 & n-1 和 n-1 & 0。

我没有看到你最后一对在哪里做的，但是有很多代码要阅读。

# html - 将子元素移出父元素

> ID：14491077
> 
> 赞同：1
> 
> 时间：2013-01-23T23:06:21.323
> 
> 标签：html, css

我有一个使用模板的自定义 PHP CMS。我有一个 layout.tpl，我在其中设置了网站的整体外观，包括一个名为 boxmain 的类，它是布局的中心内容。在那里，我定义了我的 style.css 文件，其中包含 boxmain 类。

```
.boxmain { 
    background-color:#F5F5F5; 
    width:1025px;
    height:auto; 
    margin:0 auto; 
    font-size:11px;
    overflow: hidden;
    padding-top: 15px;
    padding-left: 5px;
    padding-bottom: 15px;
} 
```

在它上面，我有一个图像横幅类。这也包含在内容和横幅之间创建空间的边距。

```
div#banner {
    background: url("../images/banners/banner1.jpg")  repeat scroll center center rgb(0, 0, 0);
    width: 100%;
    height: 270px;
    z-index: 1;
    margin-bottom: 25px; 
    -webkit-box-shadow:  0px 2px 15px 2px ;
    box-shadow: 0px 2px 15px 2px ;
} 
```

我想要做的是能够删除横幅和 boxmain 上的所有填充和边距，而无需修改样式表，而是将其包含在模板中。出于某种原因，当我在模板中执行此操作时它不起作用，它只是破坏了 Cufon。

```
<style type="text/css">
div.boxmain { margin: 0; padding; 0; }
div#banner { margin: 0; padding: 0; }
</style> 
```

因此，我在想，也许将子元素（基本上是模板中的所有内容）放在父元素（在 layout.tpl 中定义的 boxmain）之外，这将清除边距和填充，但是我该怎么做呢？它会工作吗？

模板中的内容基本上就是几个div标签和几张图片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:29:34.967

这是一个有效的[JSFiddle](http://jsfiddle.net/uTZBz/)。

```
<style type="text/css">
div.boxmain { margin: 0; padding; 0; }
div#banner { margin: 0; padding: 0; }
</style>

<div id="banner">Banner content</div>
<div class="boxmain">Main content</div> 
```

由于内联样式很容易覆盖主样式表，我想说这是一个排序问题。*您可能在内联样式之后*包含主样式表，这可以解释为什么它不起作用。

将内联也移动`<style>`到`boxmain`作品中

```
<div id="banner">Banner content</div>
<div class="boxmain">

    <style type="text/css">
    div.boxmain { margin: 0; padding; 0; }
    div#banner { margin: 0; padding: 0; }
    </style>

    Main content
</div> 
```

因此，以覆盖样式作为前缀`$page_content`也应该这样做。
见[JSFiddle](http://jsfiddle.net/uTZBz/1/)

免责声明：这仅在 Firefox 16 上进行了测试。

# magento - Magento 平面目录产品 - 1、2 和 3

> ID：14491080
> 
> 赞同：0
> 
> 时间：2013-01-23T23:06:53.153
> 
> 标签：magento

在magento中使用平面目录选项时，为什么magento有以下表格：

```
flat_catalog_product_1
flat_catalog_product_2
flat_catalog_product_3 
```

为什么不只有一张单桌？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:28:12.280

每个表对应于 Magento 中的一个 Store View。

因为您可以将产品名称或描述等属性定义为商店视图级别，所以此信息的“平面”版本需要在每个商店视图的不同表中。

有关此的更多信息：[Magento 中的平面表和产品集合](http://inchoo.net/ecommerce/magento/flat-tables-in-magento-and-product-collection/)

# php - Facebook。通过单击图像在 facebook 墙上发布文本

> ID：14491082
> 
> 赞同：0
> 
> 时间：2013-01-23T23:07:01.587
> 
> 标签：php, facebook, api, session, stream

我想制作一个 facebook 应用程序，当用户单击图像时，会在用户的墙上自动发布一些文本。

我有一个脚本：

```
<?php

define('FB_APIKEY', 'YOUR_API');
define('FB_SECRET', 'YOUR_SECRET');
define('FB_SESSION', 'YOUR_SESSION');

require_once('./files/Facebook.php');

echo "post on wall";
try {
  $facebook = new Facebook(FB_APIKEY, FB_SECRET);
  $facebook->api_client->session_key = FB_SESSION;
  $fetch = array(
       'friends' =>array(
           'pattern' => '.*',
           'query' => "select uid2 from friend where uid1={$user}"
            )   
         );
  echo $facebook->api_client->admin_setAppProperties(array('preload_fql' => json_encode($fetch)));

  $message = 'From My App: publish steven on facebook';
  if( $facebook->api_client->stream_publish($message))
    echo "Added on FB Wall";

} catch(Exception $e) {
    echo $e . "<br />";
}
?> 
```

据我了解，我需要输入名为“YOUR_API”、“YOUR_SECRET”、“YOUR_SESSION”的 api、秘密和会话。

但是我怎样才能得到我的会话密钥呢？

当我输入 API 时，SECRET 正确，但没有会话密钥我得到错误：

```
Fatal error: Call to a member function stream_publish() on a non-object in /home/padekime/domains/padekime.wu.lt/public_html/scriptas/index.php on line 12 
```

我花了很多时间，阅读了很多教程，但没有找到解决方案......

也许这里有任何其他脚本可以在用户的​​墙上发布一些文本？

当我尝试此解决方案时： [为状态更新授权 Facebook 粉丝页面时](https://stackoverflow.com/questions/2097665/authorizing-a-facebook-fan-page-for-status-updates) 出现错误：

```
FATAL error (Fatal error: Call to a member function stream_publish() on a non-object in ...) 
```

当我尝试这个时：

```
<?php
$msg = array (
'message' => 'bla bla bla ... bla bla bla...',
'name' => 'The BlaBla Mesage',
'caption' => 'link',
'link' => 'http://www.google.lt',
'description' => 'saf',
'picture' =>'',
'actions' => array(array(
'name' => 'Visit',
'link' => 'http://www.google.lt'))
);
$result = $facebook->api('/me/feed/','post',$msg);
var_dump($result);
?> 
```

我收到错误：

```
Fatal error: Call to a member function api() on a non-object in /home/padekime/domains/padekime.wu.lt/public_html/scriptas/index.php on line 22 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T03:49:40.757

我认为您最大的问题是您正在尝试使用过时的方法，并且可能是过时的 PHP SDK。`api_client()`当前php SDK代码中不存在该方法。

首先[从 GitHub 下载当前的 php SDK](https://github.com/facebook/facebook-php-sdk)。

[在Facebook 开发者网站上](https://developers.facebook.com/docs/reference/php/facebook-api/)有一个关于当前方法“将链接发布到用户墙”的完整教程。使用当前 SDK 遵循该教程，您应该处于良好状态。

# php - preg 替换 PHP 中的字符串

> ID：14491084
> 
> 赞同：0
> 
> 时间：2013-01-23T23:07:08.523
> 
> 标签：php, regex, escaping

我目前正在为 PHP 中的 PHP 编写代码混淆器，只是为了提高我使用正则表达式语法的技能。

目标是在任何混淆过程之前对字符串进行base64_encode，并在任何混淆过程之后对其进行解码。在像“foo bar”或“foo bar”这样的标准字符串上，一切正常，但它不适用于包含转义（双/简单）引号的字符串，例如：'return \'"\'.base64_encode($matches[0] ).\'"\';'

如您所见，我试图混淆我自己的代码，这似乎很有趣。但是我自己的代码包含未正确解析的特定正则表达式字符串。

这是负责对以单引号开头和结尾的字符串进行编码的代码（负责对双引号执行相同操作的代码几乎相同）：

```
 $this->output = preg_replace_callback('/(?<!\\\\)\'(.*)(?<!\\\\)\'/isU', create_function(
            '$matches',
            'return "\'".base64_encode($matches[0])."\'";'
        ), $this->output
    ); 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:03:15.407

请尽量减少您的问题（发布尽可能简单的代码不工作）。

```
$test = "bla blah 'match \' this' blah blah";
$test = preg_match('/(?<!\\\\)\'(.*)(?<!\\\\)\'/isU', $test, $matches);
var_dump($matches); 
```

起到魅力的作用。

# ruby-on-rails - Imagemagick 6.8.10 在山狮上使用 Rails 问题

> ID：14491085
> 
> 赞同：1
> 
> 时间：2013-01-23T23:07:09.137
> 
> 标签：ruby-on-rails, imagemagick, homebrew

我的代码在这里：[https ://github.com/pavankat/to_do_app](https://github.com/pavankat/to_do_app)

我使用了本教程： http: [//guides.railsgirls.com/thumbnails/](http://guides.railsgirls.com/thumbnails/)

*   在通过教程运行了一下之后，我在尝试编辑想法 1 的图片（几乎重新上传图片）时遇到了这个错误，所以缩略图会出现：

    使用 MiniMagick 操作图片失败，可能不是图片？原始错误：MiniMagick::Invalid

我认为它正在发生，因为我没有重新启动服务器，但我这样做了，它仍然发生。

我按照这里的说明进行操作：[Rails 和 OS X：如何安装 rmagick？](https://stackoverflow.com/questions/13963404/rails-and-os-x-how-to-install-rmagick)（TaianSu 和 chad bidwell 的问题），但没有运气。

然后我跟着这个：[为什么这个 RMagick 调用会产生分段错误？](https://stackoverflow.com/questions/2838307/why-is-this-rmagick-call-generating-a-segmentation-fault)（阿什柏林的回应）

```
$ brew uninstall imagemagick && brew install imagemagick --disable-openmp
Uninstalling /usr/local/Cellar/imagemagick/6.8.0-10...

Error: You must `brew link jpeg' before imagemagick can be installed 
```

所以我这样做了：

```
$ brew rm jpeg 
```

接着

```
$ brew install imagemagick --disable-openmp 
```

然后我重新启动了服务器

制作创意或编辑创意图片时仍然出现错误：图片无法使用 MiniMagick 操作，可能不是图片？原始错误：MiniMagick::Invalid

我这样做了：

```
$ sudo chmod 777 /usr/local 
```

但没有运气

根据[carrierwave + mini_magick gems = not an image error](https://stackoverflow.com/questions/9905499/carrierwave-mini-magick-gems-not-an-image-error) (B. Ruschill's response) 进行了尝试：

```
$ brew uninstall imagemagick
$ brew cleanup --force -s
$ brew rm jpeg
$ brew install imagemagick 
```

但后来它给了我一个错误，它无法链接 jpeg。

所以我尝试了 brew link jpeg。那没有用。

所以我尝试[了 brew link jpeg 问题](https://stackoverflow.com/questions/9762943/brew-link-jpeg-issues)（David Riccitelli 的回应）

我再次尝试了 brew link jpeg 。那没有用。

# python - 更改画布、Tkinter、Python 中像素的颜色

> ID：14491092
> 
> 赞同：1
> 
> 时间：2013-01-23T23:07:34.227
> 
> 标签：python, canvas, tkinter

有人知道是否可以在不使用 un 对象的情况下更改画布中像素的颜色，因此不使用类似`canvas.create_oval`or的东西`canvas.create_rectangle`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T12:03:09.290

除了创建某种 1x1 像素对象外，没有其他方法可以为像素着色。是的，在某些时候你会遇到性能问题。画布根本不适合以这种方式使用。

如果您确实需要创建一个可以管理单个像素的大区域，您可以创建一个具有与画布相同大小的单个图像的画布。然后，您可以通过照片图像界面设置图像上各个像素的颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:22:00.907

就`tkinter`其本身而言，这是不可能的。

即使您设法更改画布窗口上的像素（这可以通过 X11 和 Windows API 以平台相关的方式实现），您也必须确保正确地重新绘制它。

当然，您可以在画布上使用大小为 1x1 的`place`a `frame`，并使用您想要的背景颜色。这样，像素被“改变”并且没有画布对象被创建。如果问题背后有一个真实的（虽然奇怪的）问题，这个技巧可能是一个解决方案。

# java - Java+Spring：严重的 Servlet 服务

> ID：14491093
> 
> 赞同：0
> 
> 时间：2013-01-23T23:07:35.130
> 
> 标签：java, spring

我不知道我`listContacts`的控制器 有什么问题`map.put("contactList", contactService.listContact());` 有人可以帮助我吗？

> 严重：servlet [dispatcher] 的 Servlet.service() 在路径 [/test] 的上下文中抛出异常 [请求处理失败；嵌套异常是 java.lang.NullPointerException]，根本原因 java.lang.NullPointerException 在 pl.ivmx.contact.controller.ContactController.listContacts(ContactController.java:26) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 在 java.lang.reflect.Method.invoke(Method.java:601) 在 org.springframework。 web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176) 在 org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter。

```
package pl.ivmx.contact.controller;

import java.util.Map;    
import pl.ivmx.contact.dao.ContactDAO;
import pl.ivmx.contact.form.Contact;
import pl.ivmx.contact.service.ContactService;    
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
public class ContactController {

    @Autowired
    private ContactService contactService;

    @RequestMapping("/contact")
    public String listContacts(Map<String, Object> map) {
        map.put("contact", new Contact());
        map.put("contactList", contactService.listContact());       

        return "/contact";
    }

    @RequestMapping(value = "/add", method = RequestMethod.POST)
    public String addContact(@ModelAttribute("contact") Contact contact,
            BindingResult result) {

        contactService.addContact(contact);

        return "redirect:/contact";
    }

    @RequestMapping("/delete/{contactId}")
    public String deleteContact(@PathVariable("contactId") Integer contactId) {

        contactService.removeContact(contactId);

        return "redirect:/contact";
    }   
} 
```

* * *

```
package pl.ivmx.contact.dao;

import java.util.List;

import pl.ivmx.contact.form.Contact;

public interface ContactDAO {

    public void addContact(Contact contact);
    public List<Contact> listContact();
    public void removeContact(Integer id);
} 
```

* * *

包pl.ivmx.contact.dao；

```
import java.util.List;

import pl.ivmx.contact.form.Contact;

import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;

import org.springframework.stereotype.Repository;

@Repository
public class ContactDAOImpl implements ContactDAO {

    @Autowired
    private SessionFactory sessionFactory;

    public void addContact(Contact contact) {
        sessionFactory.getCurrentSession().save(contact);
    }

    public List<Contact> listContact() { 
        return  sessionFactory.getCurrentSession().createQuery("from Contact").list();      
    }

    public void removeContact(Integer id) {
        Contact contact = (Contact) sessionFactory.getCurrentSession().load(
                Contact.class, id);
        if (null != contact) {
            sessionFactory.getCurrentSession().delete(contact);
        }

    }
} 
```

* * *

包pl.ivmx.contact.service；

```
import java.util.List;

import pl.ivmx.contact.form.Contact;

public interface ContactService {

    public void addContact(Contact contact);
    public List<Contact> listContact();
    public void removeContact(Integer id);
} 
```

* * *

包pl.ivmx.contact.service；

```
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import pl.ivmx.contact.dao.ContactDAO;
import pl.ivmx.contact.form.Contact;

@Service
public class ContactServiceImpl implements ContactService {

    @Autowired
    private ContactDAO contactDAO;

    @Transactional
    public void addContact(Contact contact) {
        contactDAO.addContact(contact);
    }

    @Transactional
    public List<Contact> listContact() {
        return contactDAO.listContact();
    }

    @Transactional
    public void removeContact(Integer id) {
        contactDAO.removeContact(id);
    }  
} 
```

* * *

包pl.ivmx.contact.form；

```
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name="CONTACTS")
public class Contact {

    @Id
    @Column(name="ID")
    @GeneratedValue
    private Integer id;

    @Column(name="FIRSTNAME")
    private String firstname;

    @Column(name="LASTNAME")
    private String lastname;

    @Column(name="EMAIL")
    private String email;

    @Column(name="TELEPHONE")
    private String telephone;

    public String getEmail() {
        return email;
    }
    public String getTelephone() {
        return telephone;
    }
    public void setEmail(String email) {
        this.email = email;
    }
    public void setTelephone(String telephone) {
        this.telephone = telephone;
    }
    public String getFirstname() {
        return firstname;
    }
    public String getLastname() {
        return lastname;
    }
    public void setFirstname(String firstname) {
        this.firstname = firstname;
    }
    public void setLastname(String lastname) {
        this.lastname = lastname;
    }
    public Integer getId() {
        return id;
    }
    public void setId(Integer id) {
        this.id = id;
    }
} 
```

* * *

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    id="WebApp_ID" version="3.0">

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>WEB-INF/applicationContext.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener> 

    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.do</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.html</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>/pages/index.jsp</welcome-file>
    </welcome-file-list> 
```

应用程序上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:security="http://www.springframework.org/schema/security"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/security
        http://www.springframework.org/schema/security/spring-security-3.0.xsd">

    <context:annotation-config />
    <context:component-scan base-package="pl.ivmx.contact" />  

<!--    <bean id="messageSource"
        class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basename" value="messages_en.properties" />
        <property name="defaultEncoding" value="UTF-8" />
    </bean> -->

    <import resource="commonContext.xml" />

    <bean id="dataSource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="${jdbc.driverClassName}" />
        <property name="url" value="${jdbc.url}" />
        <property name="username" value="${jdbc.username}" />
        <property name="password" value="${jdbc.password}" />
    </bean>

    <bean id="userTestDao" class="pl.ivmx.dao.impl.UserTestDaoImpl">
    <!--     <property name="dataSource" ref="dataSource" />   -->
        <property name="sessionFactory" ref="sessionFactory" />             
    </bean>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean" >

    <!--    class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean"> -->
        <property name="dataSource" ref="dataSource" />                 
         <property name="configLocation" value="META-INF/hibernate.cfg.xml" />    
        <property name="configurationClass">
            <value>org.hibernate.cfg.AnnotationConfiguration</value>
        </property>
    <!--    <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>      
            </props>
        </property>         
        <property name="annotatedClasses">
            <list>
                <value>pl.ivmx.model.UserTest</value>
            </list>
        </property>    -->     
    </bean>    

    <bean id="transactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean> 
```

调度程序-servlet.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:tx="http://www.springframework.org/schema/tx"                                 
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd 
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd">

<!--  <bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping" />    -->

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/pages/</value>
        </property>
        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>

    <bean id="urlMapping"
        class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">

        <property name="urlMap">
            <map>
                <entry key="/index.do"> <ref bean="index" /></entry>
                <entry key="/registration.do"> <ref bean="registration" /></entry>
                <entry key="/usertestlist.do"> <ref bean="usertest" /></entry>  
                <entry key="/contact.do"> <ref bean="contact" /></entry>        
            </map>
        </property>
    </bean>

    <bean id="index" class="pl.ivmx.web.IndexController"/>

        <bean id="registrationValidator" class="pl.ivmx.validation.RegistrationValidator" />  
        <bean id="registration" class="pl.ivmx.web.RegistrationFormController" >                 
            <property name="commandName"><value>userTest</value></property> 
            <property name="commandClass"><value>pl.ivmx.model.UserTest</value></property> 
            <property name="validator"><ref local="registrationValidator"/></property>  
            <property name="formView"><value>registration</value></property> 
            <property name="successView"><value>registrationsuccess</value></property> 
            <property name="userTestDao"><ref bean="userTestDao"/></property>               
        </bean>     

        <bean id="usertest" class="pl.ivmx.web.UserTestController">                  
             <property name="userTestDao"><ref bean="userTestDao"/></property>          
        </bean>     

    <bean id="contact" class="pl.ivmx.contact.controller.ContactController">
    </bean>

    <bean id="contactService" class="pl.ivmx.contact.service.ContactServiceImpl">
    </bean>
    <bean id="contactDAO" class="pl.ivmx.contact.dao.ContactDAOImpl">
    </bean>

</beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:27:36.633

它看起来像这里的方法中抛出的 NullPointerException：

```
@RequestMapping("/contact")
public String listContacts(Map<String, Object> map) {
    map.put("contact", new Contact());
    map.put("contactList", contactService.listContact());       

    return "/contact";
} 
```

我将调试并检查 contactService 是否已正确自动接线。

空指针是第 26 行，如果该行包含`contactService.listContact()`则 contactService 为空。如果它是上面的行，`map`则为空。

我不确定，但尝试添加：

`<context:component-scan base-package="pl.ivmx.contact" />`

到 dispatcher-servlet.xml 也可能是注释没有得到处理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:25:43.487

您将`"/contact"`在方法中返回那里作为要显示的视图：

```
@RequestMapping("/contact")
public String listContacts(Map<String, Object> map) {
    map.put("contact", new Contact());
    map.put("contactList", contactService.listContact());       

    return "/contact"; // <---- here!
} 
```

这意味着您应该在某处定义一个名为 /contact 的视图，但我没有看到它。您需要有一个与您定义的值相对应的视图。

您可能希望返回一个值，`"contact"`而不是`"/contact"`然后在 webapp/WEB-INF/views 文件夹中拥有 contact.jsp（假设您使用 maven 标准目录布局）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:18:50.437

我没有看到任何明显的东西...... sessionFactory 可以为空吗？应该很容易找到，寿。单步调试调试器中的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T00:05:01.703

我认为您缺少将 contactService bean 添加到您的 applicationContext.xml 尝试将以下内容添加到标签

```
<bean id="contactService" class="pl.ivmx.contact.service.ContactServiceImpl">
<property name="contactDAO" ref="contactDAO" />
</bean>

<bean id="contactDAO" class="pl.ivmx.contact.dao.ContactDAOImpl" /> 
```

# python - CherryPy 和 MySQL 无法连接数据库

> ID：14491096
> 
> 赞同：0
> 
> 时间：2013-01-23T23:07:48.453
> 
> 标签：python, mysql, cherrypy

我在 Apache 下使用 modwsgi 建立了一个 CherryPy“站点”。它工作正常，我可以毫无问题地返回 hello world 消息。问题是当我尝试连接到我的 MySQL 数据库时。这是我正在使用的代码。

```
import sys
sys.stdout = sys.stderr

import atexit
import threading
import cherrypy

import MySQLdb

cherrypy.config.update({'environment': 'embedded'})

if cherrypy.__version__.startswith('3.0') and cherrypy.engine.state == 0:
    cherrypy.engine.start(blocking=False)
    atexit.register(cherrypy.engine.stop)

def initServer():
    global db
    db=MySQLdb.connect(host="localhost", user="root",passwd="pass",db="Penguin")

class Login(object):
    def index(self):
        return 'Login Page'
    index.exposed = True

class Root(object):
    login = Login();

    def index(self):
        # Sample page that displays the number of records in "table" 
        # Open a cursor, using the DB connection for the current thread 
        c=db.cursor()
        c.execute('SELECT count(*) FROM Users')
        result=cursor.fetchall()
        cursor.close()

        return 'Help' + result

    index.exposed = True

application = cherrypy.Application(Root(), script_name=None, config=None) 
```

其中大部分内容是从 CherryPy 网站上设置 modwsgi 时复制的，我只是添加了从各种互联网资源拼凑而成的数据库内容。

当我尝试查看根页面时，我收到 500 内部服务器错误。我仍然可以很好地进入登录页面，但我很确定我以某种方式弄乱了数据库连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T03:40:04.920

你有一堆错误，实际上与 CherryPy 无关。

```
def initServer():
    global db 
```

`db`未在全局范围内定义。尝试：

```
db = None
def initServer():
    global db 
```

此外，`initServer()`从不调用创建数据库连接。

其他：

```
c = db.cursor()
c.execute('SELECT count(*) FROM Users')
result = cursor.fetchall()
cursor.close() 
```

`cursor`没有定义。我想你的意思是`c`：

```
c = db.cursor()
c.execute('SELECT count(*) FROM Users')
result = c.fetchall()
c.close() 
```

# ios - 设置为对象时JSON结果为空，但结果可以打印出来

> ID：14491105
> 
> 赞同：0
> 
> 时间：2013-01-23T23:08:18.133
> 
> 标签：ios, json

我是 JSON 和 Web 服务的新手，所以请多多包涵。我正在从 Web 服务器返回响应。在 PostMan 中，它看起来像：

```
{
    "Response": {
        "TranscriptSource": "MD",
        "Result": [
            {
                "Variant": {
                    "Chromosome": "chr1",
                    "Position": 13302,
                    "ReferenceAllele": "C",
                    "VariantAlleles": "T"
                }
            }
        ],
        "JobId": 0
    }
} 
```

如果在我的 connectionDidFinishLoading 方法中，我这样做：

```
NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:self.receivedData options:kNilOptions error:&error];
[dict enumerateKeysAndObjectsUsingBlock:^(id obj, id key, BOOL *stop) {
    NSLog(@"key: %@ obj: %@\n", [key description], [obj description]);
}]; 
```

我得到相同的输出。基本上我想要那个“变体”字段中的内容。所以我想我会先做

```
id result = [dict objectForKey@"Result"]; 
```

当我单步调试调试器时，结果为零。我不知道为什么，因为我可以打印出来。

最后我的主要问题是，我如何访问响应的 Variant 部分，但如果你知道为什么`id result`会为零，那也很酷。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:10:55.633

您的顶级项目是具有单个键“响应”的对象。看起来你想要：

```
id result = [[dict objectForKey:@"Response"] objectForKey:@"Result"]; 
```

# php - 将 .key 转换为 .pem

> ID：14491106
> 
> 赞同：0
> 
> 时间：2013-01-23T23:08:18.220
> 
> 标签：php, encryption, key, private

我需要使用私钥进行加密，我正在尝试使用以下代码进行加密：

```
$content = file_get_contents("file.key");

$plaintext = "14d9df79-8c4c-4380-8444-d31e1fd3f78a";

openssl_private_encrypt($plaintext, $encrypted, $content);

$transfer = base64_encode($encrypted);

echo "text encrypted is:" . $transfer;  //encrypted string 
```

我收到错误：openssl_private_encrypt(): key param is not a valid private key in

我必须对密钥文件做些什么吗？它是二进制的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:12:42.930

首先，尝试使用 openssl 将密钥转换为 PEM 格式：

```
openssl rsa -inform der -in file.key -outform pem -out filekey.pem 
```

接下来，使用[openssl_pkey_get_private从 PEM 文件中提取私钥](http://php.net/manual/en/function.openssl-pkey-get-private.php)

```
$key = openssl_pkey_get_private(file_get_contents("filekey.pem"));

$plaintext = "14d9df79-8c4c-4380-8444-d31e1fd3f78a";

openssl_private_encrypt($plaintext, $encrypted, $key);

$transfer = base64_encode($encrypted);

echo "text encrypted is:" . $transfer;  //encrypted string 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:26:20.340

我不知道任何使用 .key 扩展名的 x509 文件格式。有 pem（这是您需要加载到 openssl 中的格式）、DER（文件可能具有 .der、.crt 或 .cer 扩展名）或 PKCS#12 (.pfx .p12)。*可能是*DER或 PKCS#12：

```
 openssl pkcs12 -in file.key -out file.pem -nodes 
```

...将 PKCS#12 转换为 file.pem，

```
openssl x509 -inform der -in file.key -out file.pem 
```

...转换 DER 文件。如果文件格式错误，他们会报告错误。OTOH，您可以只使用“文件”命令来找出文件类型。（这是假设你有一个 Posix / Linux 系统——你没有说）。

或者你可以问给你的人它是什么格式。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-24T17:49:02.510

解决了我只是使用

openssl pkcs8 .....

命令

希望这对其他人有用

# css - Joomla 仅加载 css 模板的某些部分

> ID：14491122
> 
> 赞同：0
> 
> 时间：2013-01-23T23:09:32.457
> 
> 标签：css, templates, joomla

我正在开发 Joomla！模板，我有我的索引和我的 template.css

当我将所有设计留在 css 中时，它似乎只加载有关 css 类的那些部分并且不做任何其他事情，所以最终我必须将其他所有内容写入 de index.php，这很愚蠢，因为我不应该这样做。

例如，这是我想要的 index.php 代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="<?php echo $this->language; ?>" lang="<?php echo $this->language; ?>" >  
<head>  
<link rel="stylesheet" href="<?php echo $this->baseurl ?>/templates/posgradostemplate/css/template.css" type="text/css" /> 
<jdoc:include type="head" />  
</head>  
<body>  
<div id="wrapper">  
    <div id="content">  
      <div class="mainmenu"> 
          <jdoc:include type="modules" name="mainmenu" />          
      </div>  
  </div>  
</div>  
</body>  
</html> 
```

但是包装器和内容的行为不符合预期，并且没有显示背景。这是我的 css 文件：

```
html {

/* IE10 Consumer Preview */ 
background-image: -ms-linear-gradient(top, #E6E6E6 0%, #858585 100%);

/* Mozilla Firefox */ 
background-image: -moz-linear-gradient(top, #E6E6E6 0%, #858585 100%);

/* Opera */ 
background-image: -o-linear-gradient(top, #E6E6E6 0%, #858585 100%);

/* Webkit (Safari/Chrome 10) */ 
background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #E6E6E6), color-stop(1, #858585));

/* Webkit (Chrome 11+) */ 
background-image: -webkit-linear-gradient(top, #E6E6E6 0%, #858585 100%);

/* W3C Markup, IE10 Release Preview */ 
background-image: linear-gradient(to bottom, #E6E6E6 0%, #858585 100%);
 margin: 0;
  padding: 0;
  border: 0;
}

html, body {
    height: 100%;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

body {
    margin: 0;
}

.mainmenu ul {
    font-family: Arial, Verdana;
    font-size: 12px;
    margin: 0;
    padding: 0;
    list-style: none;
}
.mainmenu ul li {
    display: block;
    position: relative;
    float: left;
}
.mainmenu li ul {
    display: none;
}
.mainmenu ul li a {
    display: block;
    text-decoration: none;
    color: #ffffff;
    border-top: 1px solid #000000;
    padding: 5px 15px 5px 15px;
    background: #000000;
    margin-left: 1px;
    white-space: nowrap;
}
.mainmenu li:hover li a:hover {
    background: #FFFF00;
    color: #FF0000;
}
.mainmenu ul li a:hover {
    background: #000000;
    color: #FFFF00;
}
.mainmenu li:hover ul {
    display: block;
    position: absolute; 
}
.mainmenu li:hover li {
    background: #FFFF00;
    float: none;
    font-size: 11px;
    color : #000000;
}
.mainmenu li:hover a { 
    background:  #FFFF00;
    color : #000000;
}

#wrapper{
  width: 100%;
  text-align: center;
}

#content{
    display: inline-block;

} 
```

除 mainmenu 之外的所有内容都无法按照 css 的指示工作。我在想它没有被正确加载，我希望它被急切地加载，以便将所有内容都牢记在心。现在它只有在我在索引中添加 css 代码时才有效，而且不应该那样。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:14:59.060

尝试使用以下内容加载 CSS 文件：

```
$document = JFactory::getDocument();
$document->addStyleSheet(JURI::root() . "templates/posgradostemplate/css/template.css"); 
```

# jsp - 在jsp中从数据库中动态下拉不起作用

> ID：14491127
> 
> 赞同：0
> 
> 时间：2013-01-23T23:09:46.230
> 
> 标签：jsp, drop-down-menu

我正在尝试填充一个下拉菜单。第二个和第三个下拉列表应该在从数据库中检索到之前选择的下拉值后显示值。任何人都可以指出我的代码中的错误。当我运行代码我无法在任何下拉列表中选择任何值。请帮助我。
[国家.jsp](https://docs.google.com/file/d/0Byr1U6uyUqbaYXQyc0pWYmJmRWM/edit)

[状态.jsp](https://docs.google.com/file/d/0Byr1U6uyUqbaMGNUdkRKdXU1SjA/edit)

City.jsp 与 state.jsp 几乎相同

我已经在数据库中添加了值。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T15:17:30.803

请使用预定义的框架，如 JSTL/SQL 和 jQuery.js

这应该有效：

```
<%--
    Document   : index
    Created on : Jan 23, 2013, 7:43:24 PM
    Author     : Ankit
--%>

<%@taglib uri="http://java.sun.com/jsp/jstl/sql" prefix="sql"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@page import="java.sql.*"%>
<sql:setDataSource driver="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@localhost:1521:XE" user="system" password="ankit" var="db" scope="request" />
<sql:query dataSource="${db}" var="countrys" sql="SELECT * FROM country" />
<sql:query dataSource="${db}" var="states" sql="SELECT * FROM state WHERE countryid=${param['countryid']}" />
<sql:query dataSource="${db}" var="cities" sql="SELECT * FROM city WHERE cityid=${param['cityid']}" />
<!DOCTYPE html>
<html>
    <head>
        <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
        <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
        <script type="text/javascript" language="javascript" src="jquery.js"></script>
    </head>
    <body>
        <form>
        <select name="countryid" id="countrylist" onclick="jQuery('#statelist').load('?countryid='+jQuery(this).val(),'#statelist');">
            <c:forEach items="${countrys}" var="country">
                <option value="${country.id}">${country.name}</option>
            </c:forEach>
        </select>
        <select name="stateid" id="statelist" onclick="jQuery('#citylist').load('?cityid='+jQuery(this).val(),'#citylist');">
            <c:forEach items="${states}" var="state">
                <option value="${state.id}">${state.name}</option>
            </c:forEach>
        </select>
        <select name="cityid" id="citylist">
            <c:forEach items="${cities}" var="city">
                <option value="${city.id}">${city.name}</option>
            </c:forEach>
        </select>
        <button>Finish</button>
        </form>
    </body>
</html> 
```

# php - 根据类别的产品获取过滤器的属性和属性值

> ID：14491131
> 
> 赞同：0
> 
> 时间：2013-01-23T23:10:09.050
> 
> 标签：php, mysql, database-schema

我有以下表结构：

**分类：**

```
 1\. id
 2\. parent_id
 3\. category 
```

**属性：**

```
 1\. id
 2\. attribute 
```

**类别_属性**

```
 1\. category_id
 2\. attribute_id 
```

**属性值**

```
 1\. id
 2\. attribute_id
 3\. value 
```

**产品**

```
 1\. id
 2\. category_id
 3\. product
 4\. price 
```

**产品_属性_值**

```
 1\. product_id
 2\. attribute_id
 3\. value_id 
```

现在，当我打开类别时，让我们说“珠子”（id = 1）。我选择此类别的所有属性及其属性的所有值。

问题是我有 10 个“直径”属性值（id = 1）：4mm、6mm、8mm、12mm、14mm、16mm、18mm、20mm、24mm、30mm（ids 1-10）它们都显示在过滤器中即使我没有直径为 20 毫米的产品。

如何根据类别产品及其属性和值选择属性和值？例如，如果 Beads 类别的产品仅具有 12mm 和 14mm 直径的产品，则应在过滤器中省略其他值。

我知道这可能很愚蠢，但这是我第一个使用这种数据库模式的项目，除了这个问题我已经解决了所有问题。

抱歉格式化，用我的手机写。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:13:57.303

您可以进行 JOIN 以确保该类别具有可连接的产品，然后 GROUP BY category.id 以便您只获得一次类别。

```
SELECT *
FROM   categories
JOIN   products ON products.category_id = categories.id 
GROUP BY categories.id, products.attribute 
```

# java - 单击时侦听器不会切换活动

> ID：14491134
> 
> 赞同：1
> 
> 时间：2013-01-23T23:10:27.073
> 
> 标签：java, android, android-intent, android-activity, onclicklistener

在 android 开发中从活动切换到活动需要一些帮助。我正在尝试从 MainActivity 活动转到 MainMenu 活动。我实现了一个 onclicklistener 来完成这项工作。当我在模拟器上运行应用程序时，它运行良好，但是当我单击使用 onclicklistener 实现的按钮时，它什么也不做。

```
package com.example.bmiworking;

import android.app.Activity;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

            public class MainActivity extends Activity implements OnClickListener{
            /** Called when the activity is first created. */
            Button btn;
            @Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.activity_main);
                 btn = (Button)findViewById(R.id.homeClickHandler);
            }
            public void onClick(View v){
                if(v.getId() == R.id.homeClickHandler){
                startActivity(new Intent(this,MainMenu.class));
                }
            }

            public void calculateClickHandler(View view) {
             // make sure we handle the click of the calculator button

             if (view.getId() == R.id.calculateButton) {

              // get the references to the widgets
              EditText weightText = (EditText)findViewById(R.id.weightText);
              EditText heightText = (EditText)findViewById(R.id.heightText);
              TextView resultText = (TextView)findViewById(R.id.resultLabel);

              // get the users values from the widget references

              float weight = Float.parseFloat(weightText.getText().toString());
              float height = Float.parseFloat(heightText.getText().toString());

              // calculate the bmi value

              float bmiValue = calculateBMI(weight, height);

              // interpret the meaning of the bmi value
              String bmiInterpretation = interpretBMI(bmiValue);

              // now set the value in the result text

              resultText.setText(bmiValue + "-" + bmiInterpretation);
             }
            }

            // the formula to calculate the BMI index

            // check for http://en.wikipedia.org/wiki/Body_mass_index
            private float calculateBMI (float weight, float height) {

             return (float) (weight * 4.88 / (height * height));
            }

            // interpret what BMI means
            private String interpretBMI(float bmiValue) {

             if (bmiValue < 16) {
              return "Severely Underweight - See Weight Gain";
             } else if (bmiValue < 18.5) {

              return "Underweight - See Weight Gain";
             } else if (bmiValue < 25) {

              return "Normal - No Recomendations";
             } else if (bmiValue < 30) {

              return "Overweight - See Weight Loss";
             } else {
              return "Obese - See Weight Loss";
             }

            }

            @Override
            public void onClick(DialogInterface arg0, int arg1) {
                // TODO Auto-generated method stub

            }
        }

     <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        tools:context=".MainActivity" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_centerHorizontal="true"
            android:text="BMI Calculator"
            android:textAppearance="?android:attr/textAppearanceLarge" />

        <EditText
            android:id="@+id/weightText"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/textView2"
            android:layout_centerHorizontal="true"
            android:ems="10"
            android:inputType="numberDecimal" >

            <requestFocus />
        </EditText>

        <TextView
            android:id="@+id/textView2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/textView1"
            android:layout_centerHorizontal="true"
            android:text="@string/weightLabel"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <TextView
            android:id="@+id/textView3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/weightText"
            android:layout_centerHorizontal="true"
            android:text="@string/heightLabel"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <EditText
            android:id="@+id/heightText"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignLeft="@+id/weightText"
            android:layout_below="@+id/textView3"
            android:ems="10"
            android:inputType="numberDecimal" />

        <Button
            android:id="@+id/calculateButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/heightText"
            android:layout_centerHorizontal="true"
            android:onClick="calculateClickHandler"
            android:text="@string/calculateButton" />

        <TextView
            android:id="@+id/resultLabel"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_below="@+id/calculateButton"
            android:layout_marginLeft="30dp"
            android:layout_marginTop="15dp"
            android:text="@string/emptyString"
            android:textAppearance="?android:attr/textAppearanceLarge" />

        <Button
            android:id="@+id/homeClickHandler"
            style="?android:attr/buttonStyleSmall"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:text="@string/homeButton" />

    </RelativeLayout>

    <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.example.bmiworking"
        android:versionCode="1"
        android:versionName="1.0" >

        <uses-sdk
            android:minSdkVersion="8"
            android:targetSdkVersion="17" />

        <application
            android:allowBackup="true"
            android:icon="@drawable/ic_launcher"
            android:label="@string/app_name"
            android:theme="@style/AppTheme" >
            <activity
                android:name="com.example.bmiworking.MainActivity"
                android:label="@string/app_name" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>
            <activity
                android:name="com.example.bmiworking.MainMenu"
                android:label="@string/app_name" >
                </activity>
        </application>

    </manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:13:12.647

您导入了错误的 OnClickListener，因此删除该导入并删除 DialogInterface onClick 方法。

```
import android.view.View.OnClickListener; 
```

在“btn = (Button)findViewById(R.id.homeClickHandler);”下方 和：

```
btn.setOnClickListener(this); 
```

完全的：

```
package com.example.bmiworking;

import android.app.Activity;
import android.content.DialogInterface;
import android.view.View.OnClickListener;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity implements OnClickListener {
/** Called when the activity is first created. */
Button btn;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    btn = (Button) findViewById(R.id.homeClickHandler);
    btn.setOnClickListener(this);
}

    @Override
public void onClick(View v) {
    if (v.getId() == R.id.homeClickHandler) {
        startActivity(new Intent(this, MainMenu.class));
    }
}

public void calculateClickHandler(View view) {
    // make sure we handle the click of the calculator button

    if (view.getId() == R.id.calculateButton) {

        // get the references to the widgets
        EditText weightText = (EditText) findViewById(R.id.weightText);
        EditText heightText = (EditText) findViewById(R.id.heightText);
        TextView resultText = (TextView) findViewById(R.id.resultLabel);

        // get the users values from the widget references

        float weight = Float.parseFloat(weightText.getText().toString());
        float height = Float.parseFloat(heightText.getText().toString());

        // calculate the bmi value

        float bmiValue = calculateBMI(weight, height);

        // interpret the meaning of the bmi value
        String bmiInterpretation = interpretBMI(bmiValue);

        // now set the value in the result text

        resultText.setText(bmiValue + "-" + bmiInterpretation);
    }
}

// the formula to calculate the BMI index

// check for http://en.wikipedia.org/wiki/Body_mass_index
private float calculateBMI(float weight, float height) {

    return (float) (weight * 4.88 / (height * height));
}

// interpret what BMI means
private String interpretBMI(float bmiValue) {

    if (bmiValue < 16) {
        return "Severely Underweight - See Weight Gain";
    } else if (bmiValue < 18.5) {

        return "Underweight - See Weight Gain";
    } else if (bmiValue < 25) {

        return "Normal - No Recomendations";
    } else if (bmiValue < 30) {

        return "Overweight - See Weight Loss";
    } else {
        return "Obese - See Weight Loss";
    }

}

} 
```

# hadoop - MapReduce 和 Hive 应用程序设计

> ID：14491136
> 
> 赞同：1
> 
> 时间：2013-01-23T23:10:28.417
> 
> 标签：hadoop, mapreduce, hive

我有一个设计问题，在我的 CDH 4.1.2(Cloudera) 安装中，我将每日滚动日志数据转储到 HDFS 中。我有一些报告来计算每天的成功率和失败率。

我有两种方法

1.  将每日日志数据加载到 Hive 表中并创建一个复杂的查询。
2.  每天预先运行 MapReduce 作业以生成摘要（基本上只有几行）并继续附加到一个公共文件，即 Hive 表。稍后在运行报告时，我可以使用简单的选择查询来获取摘要。

我试图了解这两者中哪种方法更好，或者是否有更好的方法。

第二种方法在合并文件方面增加了一些复杂性。如果不合并，我会有很多非常小的文件，这似乎是个坏主意。

感谢您的意见。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:26:41.617

Hive 似乎很适合这种任务，而且应该相当简单：

*   在 Hive 中创建一个`EXTERNAL`应该按天分区的表。目标是您将转储数据的目录将直接位于您的 Hive 表中。您可以在日常日志中指定字段的分隔符，如下所示，我使用逗号：

    ```
    create external table mytable(...) partitioned by (day string) row format delimited keys terminated by ',' location '/user/hive/warehouse/mytable` 
    ```

*   在 HDFS 中转储数据时，请确保将其转储到与**day=**相同的目录中，以便可以将其识别为 hive 分区。例如在`/user/hive/warehouse/mytable/day=2013-01-23`.

*   然后，您需要让 Hive 知道该表有一个新分区：

    ```
    alter table mytable add partition (day='2013-01-23') 
    ```

*   现在 Hive 元存储知道您的分区，您可以运行摘要查询。确保您只通过指定查询分区`... where day='2013-01-23'`

您可以轻松地编写脚本以每天在 cron 或其他东西中运行并获取当前日期（例如使用 shell`date`命令）并在执行上述步骤的 shell 脚本中替换变量。

# c++ - 错误转换为请求的非标量类型

> ID：14491138
> 
> 赞同：0
> 
> 时间：2013-01-23T23:10:43.837
> 
> 标签：c++, gcc, comparison

我的错误：

> 在 Main.cpp:18 包含的文件中：
> QuickSort.h：在成员函数中`'void CQuickSort<T>::Partition(std::vector<T, std::allocator<_CharT> >*, int, int, int) [with T = CMoviePointer]'`：
> QuickSort.h:49：从`'void CQuickSort<T>::Sort(std::vector<T, std::allocator<_CharT> >*) [with T = CMoviePointer]'`
> Main.cpp 实例化：70：从这里实例化
> QuickSort.h:31：错误：从`'std::vector<CMoviePointer, std::allocator<CMoviePointer> >'`非标量类型转换`'CMoviePointer'`请求
> 的 QuickSort.h:49：从`'void CQuickSort<T>::Sort(std::vector<T, std::allocator<_CharT> >*) [with T = CMoviePointer]'`
> Main.cpp 实例化：70：从此处实例化QuickSort.h:35：错误：在/usr/include/c++/4.4/bits/vector.tcc:156 中
> 不匹配 ：注意：候选是：`'operator='``'*(p_vec + ((long unsigned int)(((long unsigned int)upper) * 24ul))) = temp'`
> `std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = CMoviePointer, _Alloc = std::allocator<CMoviePointer>]`

这是我的程序。

```
#ifndef _QUICKSORT_H_
#define _QUICKSORT_H_

#include <vector>

template<class T>
class CQuickSort{
public:
    void Partition(std::vector<T> *p_vec, int upper, int lower, int size){
        if (size <2)
            return;

        int pivot_index = size/2;

        pivot_index += lower;

        while(lower < upper){ //do until start and end of list meet
            while(p_vec[lower] < p_vec[pivot_index]){
                lower--;
            }

            while(p_vec[pivot_index] < p_vec[upper]){
                upper--;
            }

            T temp = p_vec[lower];

            p_vec[lower] = p_vec[upper];

            p_vec[upper] = temp;  //swap upper and lower until lower is equal to or 
        }
    }

    void Sort(std::vector<T> *p_vec){
        int size = p_vec->size();

        if(size < 2)
            return;

        Partition(p_vec,0, size-1, size);
    }
};

#endif 
```

我无计可施。我不知道我做错了什么或实际问题出在哪里。任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:12:28.670

`p_vec`是一个指针，你正在做类似的事情

```
p_vec[lower] 
```

您可以像这样解决问题：

```
(*p_vec)[lower] // or p_vec->operator[](lower) 
```

或通过将向量作为参考传递。

```
void Partition(std::vector<T>& p_vec, int upper, int lower, int size){ ... } 
```

# c - 为什么递减在 C 编程中不能正常工作？

> ID：14491139
> 
> 赞同：2
> 
> 时间：2013-01-23T23:10:46.013
> 
> 标签：c

我正在尝试在 C 中创建一个金字塔，我需要得到下一个模式：

```
 A
   ABA
  ABCBA
 ABCDCDA
ABCDEDCBA 
```

我需要使用嵌套的 for 循环，但递减对我来说不能正常工作，这是我的代码：

```
int main(void)

{

    int i, j, k, g;
    char userLatter;
    printf("please enter an uppercase letter:\n");
    scanf("%c", &userLatter);
    int asci = userLatter;

    for (i = 0; i < 5; i++)
    {

        for (j = 4; j > i; j--)
        {
            printf(" ");
        }

        asci = userLatter;
        for (k = 0; k <= i ; k++)
        {
         printf("%c", asci++);
        }

        for (g = 1; g <= i; g++)
        {
            printf("%c", --asci);
        }

        printf("\n"); 
    }

} 
```

这是输入“a”

我得到的输出是：

```
 a
   abb
  abccb
 abcddcb
abcdeedcb 
```

你能告诉我我做错了什么吗？

tnx

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T23:14:37.670

添加一个：

```
--asci; 
```

两个`for`循环之间。

在第一个循环中，`asci++`执行*后缀*递增：表达式被计算为`asci`然后对象被递减。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:15:16.677

考虑到

```
printf("%c", --asci);//decreases the value and then prints 
```

不同于

```
printf("%c", asci--);//prints and then decreases the value 
```

# c# - protobuf-net、版本控制和代理类型的最佳实践

> ID：14491140
> 
> 赞同：6
> 
> 时间：2013-01-23T23:10:47.667
> 
> 标签：c#, versioning, protobuf-net

我正在尝试确定如何使用 protobuf-net（Marc Gravell 的实现）来解决这个用例。

*   我们有 A 类，它被认为是版本 1
*   A 类的一个实例已序列化到磁盘
*   我们现在有了 B 类，它被认为是 A 类的第 2 版（A 类有很多问题，我们必须为下一个版本创建 B 类）。A 类仍然存在于代码中，但仅用于遗留目的。
*   我想将 version:1 数据（存储到磁盘）反序列化为 B 类实例，并使用逻辑例程将数据从先前的 A 类实例转换为 B 类的新实例。
*   B 类的实例将在运行期间被序列化到磁盘。
*   应用程序应该期望反序列化 A 类和 B 类的实例。

我想到了数据契约代理和 DataContractSerializer 的概念。目标是将 version:1 数据转换为新的 B 类结构。

一个例子：

```
[DataContract]
public class A {

     public A(){}

     [DataMember]
     public bool IsActive {get;set;]

     [DataMember]
     public int VersionNumber {
          get { return 1; }
          set { }
     }

     [DataMember]
     public int TimeInSeconds {get;set;}

     [DataMember]
     public string Name {get;set;}

     [DataMember]
     public CustomObject CustomObj {get;set;} //Also a DataContract

     [DataMember]
     public List<ComplexThing> ComplexThings {get;set;} //Also a DataContract
     ...
}

[DataContract]
public class B {

     public B(A a) {
          this.Enabled = a.IsActive; //Property now has a different name
          this.TimeInMilliseconds = a.TimeInSeconds * 1000; //Property requires math for correctness
          this.Name = a.Name;
          this.CustomObject2 = new CustomObject2(a.CustomObj); //Reference objects change, too
          this.ComplexThings = new List<ComplexThings>();
          this.ComplexThings.AddRange(a.ComplexThings);
          ...
     }

     public B(){}

     [DataMember]
     public bool Enabled {get;set;]

     [DataMember]
     public int Version {
          get { return 2; }
          set { }
     }

     [DataMember]
     public double TimeInMilliseconds {get;set;}

     [DataMember]
     public string Name {get;set;}

     [DataMember]
     public CustomObject2 CustomObject {get;set;} //Also a DataContract

     [DataMember]
     public List<ComplexThing> ComplexThings {get;set;} //Also a DataContract
     ...
} 
```

A 类是我们对象的第一次迭代，并且正在积极使用中。数据以 v1 格式存在，使用 A 类进行序列化。

在意识到我们方法的错误之后，我们创建了一个新的结构，称为 B 类。A 和 B 之间有很多变化，我们觉得创建 B 更好，而不是适应原来的 A 类。

但是我们的应用程序已经存在，并且 A 类正在用于序列化数据。我们已经准备好将我们的更改推广到世界各地，但我们必须首先反序列化在版本 1 下创建的数据（使用 A 类）并将其实例化为 B 类。数据足够重要，我们不能只假设类中的默认值B 表示缺少数据，而是我们必须将数据从 A 类实例转换到 B 类。一旦我们有了 B 类实例，应用程序将以 B 类格式（版本 2）再次序列化该数据。

我们假设我们将来会对 B 类进行修改，并且我们希望能够迭代到版本 3，也许在一个新的“C”类中。我们有两个目标：处理已经存在的数据，并为将来的迁移准备我们的对象。

现有的“转换”属性（OnSerializing/OnSerialized、OnDeserializing/OnDeserialized 等）不提供对先前数据的访问。

在这种情况下使用 protobuf-net 时的预期做法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T22:47:16.543

对; 看着他们，你确实完全改变了合同。我知道没有基于合约的序列化程序会因此而爱你，protobuf-net 也不例外。如果您已经有一个根节点，您*可以*执行以下操作（在伪代码中）：

```
[Contract]
class Wrapper {
    [Member] public A A {get;set;}
    [Member] public B B {get;set;}
    [Member] public C C {get;set;}
} 
```

并且只需选择 A/B/C 中非空的任何一个，也许在它们之间添加一些转换运算符。但是，如果您在旧数据中只有一个裸 A，这会变得很困难。我能想到的方法有两种：

*   添加*许多*shim 属性以实现兼容性；***不太***可维护，我不推荐它
*   嗅探`Version`作为初始步骤，并告诉序列化程序会发生什么。

例如，您可以这样做：

```
int version = -1;
using(var reader = new ProtoReader(inputStream)) {
    while(reader.ReadFieldHeader() > 0) {
        const int VERSION_FIELD_NUMBER = /* todo */;
        if(reader.FieldNumber == VERSION_FIELD_NUMBER) {
            version = reader.ReadInt32();
            // optional short-circuit; we're not expecting 2 Version numbers
            break;
        } else {
            reader.SkipField();
        }
    }
}
inputStream.Position = 0; // rewind before deserializing 
```

现在您可以使用序列化程序，告诉它`version`它被序列化为什么；要么通过通用`Serializer.Deserialize<T>`API，要么通过`Type`来自两个非通用 API 的实例（`Serializer.NonGeneric.Deserialize`或者`RuntimeTypeModel.Default.Deserialize`- 无论哪种方式，你都会到达同一个地方；这实际上是通用还是非通用最方便的情况）。

然后，您将需要`A`/ `B`/之间的一些转换代码`C`- 通过您自己的自定义运算符 / 方法，或通过自动映射器之类的东西。

如果您不想要任何`ProtoReader`代码，您也可以这样做：

```
[DataContract]
class VersionStub {
    [DataMember(Order=VERSION_FIELD_NUMBER)]
    public int Version {get;set;}
} 
```

并运行`Deserialize<VersionStub>`，这将使您可以访问`Version`，然后您可以使用它来执行特定于类型的反序列化；这里的主要区别在于`ProtoReader`代码允许您在获得版本号后立即短路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T00:26:33.147

我没有预期的练习，但这就是我要做的。

假设您仍然可以访问您的 V1 类，请在您的 V1 类上添加一个提供 V2 实例的属性。

在你`ProtoAfterDeserialization`的 V1 中创建一个 V2 的实例并看到它是一个迁移我建议手动转移你需要的东西（或者如果它不太难，试试`Merge`YMMV）。

同样在你`ProtoBeforeSerialization`抛出某种形式的异常中，这样你就不会再试图写出旧的异常了。

编辑：使用这些示例（VB代码）

```
<ProtoBeforeSerialization()>
Private Sub BeforeSerialisaton()

End Sub

<ProtoAfterSerialization()>
Private Sub AfterSerialisaton()

End Sub

<ProtoBeforeDeserialization()>
Private Sub BeforeDeserialisation()

End Sub

<ProtoAfterDeserialization()>
Private Sub AfterDeserialisation()

End Sub 
```

在看到你的例子后，我希望这能满足你想要做的事情。`Class1`是您加载/转换的方式。

```
using ProtoBuf;
using System.Collections.Generic;
using System.IO;

public class Class1
{
    public Class1()
    {
        using (FileStream fs = new FileStream("c:\\formatADataFile.dat",
               FileMode.Open, FileAccess.Read))
        {
            A oldA = Serializer.Deserialize<A>(fs);
            B newB = oldA.ConvertedToB;
        }
    }
}

[ProtoContract()]
public class B
{

    public B(A a)
    {
        //Property now has a different name
        this.Enabled = a.IsActive; 
        //Property requires math for correctness
        this.TimeInMilliseconds = a.TimeInSeconds * 1000; 
        this.Name = a.Name;
        //Reference objects change, too
        this.CustomObject2 = new CustomObject2(a.CustomObj); 
        this.ComplexThings = new List<ComplexThings>();
        this.ComplexThings.AddRange(a.ComplexThings);
        //...
    }

    public B() { }

    //[DataMember]
    [ProtoMember(1)]
    public bool Enabled { get; set; }

    //[DataMember]
    public int Version
    {
        get { return 2; }
        private set { }
    }

    [ProtoMember(2)]
    public double TimeInMilliseconds { get; set; }

    [ProtoMember(3)]
    public string Name { get; set; }

    [ProtoMember(4)]
    public CustomObject2 CustomObject { get; set; } //Also a DataContract

    [ProtoMember(5)]
    public List<ComplexThing> ComplexThings { get; set; } //Also a DataContract

    ///...
}

[ProtoContract()]
public class CustomObject2
{
    public CustomObject2()
    {
        Something = string.Empty;
    }

    [ProtoMember(1)]
    public string Something { get; set; }
}

[ProtoContract()]
public class A
{

    public A()
    {
        mBConvert = new B();
    }

    [ProtoMember(1)]
    public bool IsActive { get; set; }

    [ProtoMember(2)]
    public int VersionNumber
    {
        get { return 1; }
        private set { }
    }

    [ProtoBeforeSerialization()]
    private void NoMoreSavesForA()
    {
        throw new System.InvalidOperationException("Do Not Save A");
    }

    private B mBConvert;

    [ProtoAfterDeserialization()]
    private void TranslateToB()
    {
        mBConvert = new B(this);
    }

    public B ConvertedToB
    {
        get
        {
            return mBConvert;
        }
    }

    [ProtoMember(3)]
    public int TimeInSeconds { get; set; }

    [ProtoMember(4)]
    public string Name { get; set; }

    [ProtoMember(5)]
    public CustomObject CustomObj { get; set; } //Also a DataContract

    [ProtoMember(6)]
    public List<ComplexThing> ComplexThings { get; set; } //Also a DataContract
    //...
}

[ProtoContract()]
public class CustomObject
{
    public CustomObject()
    {

    }
    [ProtoMember(1)]
    public int Something { get; set; }
}

[ProtoContract()]
public class ComplexThing
{
    public ComplexThing()
    {

    }
    [ProtoMember(1)]
    public int SomeOtherThing { get; set; }
} 
```

# ember.js - emberjs pre-4 和 ember-data：浏览器刷新没有数据

> ID：14491142
> 
> 赞同：0
> 
> 时间：2013-01-23T23:11:10.040
> 
> 标签：ember.js, ember-data, ember-router

如果我从索引浏览到游戏，则会显示数据，因为`{{#linkTo}}`s 上下文，但如果我正在刷新站点，则每次游戏名称都不会出现。

* * *

**编辑：**这是一个[小提琴](http://jsfiddle.net/Phosphoros/YdCFx/5/show/)，但不幸的是，带有夹具适配器的小提琴版本可以正常工作，即使肯建议从游戏模板中删除模型。

* * *

/api/games 返回的数据如下：

```
{
   "games":[
      {
         "id":1,
         "name":"First Game"
      }
   ]
} 
```

以及从 /api/games/1 返回的数据

```
{
  "game": [
    {
      "id": 1,
      "name": "First Game"
    }
  ]
} 
```

```
<script type="text/x-handlebars" data-template-name="application">
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="games">
  <ul>{{#each game in controller}}
    <li>{{#linkTo 'game' game}}{{game.name}}{{/linkTo}}</li>
  {{/each}}</ul>
</script>

<script type="text/x-handlebars" data-template-name="game">
  <h1>Name:{{model.name}}</h1>
</script> 
```

```
<script type="text/javascript">
  App = Ember.Application.create();

  App.Game = DS.Model.extend({
    name: DS.attr('string')
  });

  App.Store = DS.Store.extend({
    revision: 11,
    adapter: DS.RESTAdapter.create({
        namespace: 'api'
    })
  });

  App.GamesController = Ember.ArrayController.extend({
    content: []
  });

  App.GameController = Ember.ObjectController.extend({
    content: null
  });

  App.Router.map(function(match) {
    this.route("games", { path : "/" });
    this.route("game", { path : "/games/:game_id" });
  });

  App.GameRoute = Ember.Route.extend({
    model: function(params) {
        return App.Game.find(params.game_id);
    }
  });

  App.GamesRoute = Ember.Route.extend({
    setupController: function(controller) {
      controller.set('content', App.Game.find());
    }
  });
</script> 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T19:37:00.317

我的服务器对单个游戏的响应是错误的。我有一个包含单个对象的数组，但我使用了 Object 控制器，所以我只用响应来修复它

```
{
  "game": {
    "id": 1,
    "name": "First Game"
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:18:13.633

从你的游戏模板中删除模型，试试这个

```
<script type="text/x-handlebars" data-template-name="game">
  <h1>Name:{{name}}</h1>
</script> 
```

JSFiddle您的代码以查看问题出在哪里

# linq-to-sql - 使用 DataContext 缓存预加载子集合

> ID：14491143
> 
> 赞同：2
> 
> 时间：2013-01-23T23:11:13.113
> 
> 标签：linq-to-sql

为了减少到数据库的往返，我希望为父对象“预加载”子集合。我希望如果我将构成子集合的对象加载到 DataContext 缓存中，Linq2SQL 将使用这些对象而不是进入数据库。

例如，假设我有一个带有两个子集合的 Person 对象：Children 和 Cars。

我认为这可能有效：

```
var children = from p in dbc.Person
               select p.Children;

var cars = from p in dbc.Person
           select p.Cars;

var people = from p in dbc.Person
             select p;

var dummy1 = children.ToList();
var dummy2 = cars.ToList();

foreach(var person in people){
    Debug.WriteLine(person.Children.Count);
} 
```

但相反，每次调用 时，我仍然会访问一次数据库`person.Children.Count`，即使所有子项都已加载到 DataContext 中。

最终，我正在寻找一种在尽可能少的数据库访问中加载完整对象图（具有多个子集合）的方法。

我知道`DataLoadOptions`类（和`LoadWith`），但它仅限于一个子集合，这对我来说是个问题。

如果我仍然能够构建完整的对象图（当然还有一个 Linq2SQL 对象），而无需对对象进行大量额外操作，我不介意使用存储过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T18:40:40.993

我不认为您需要的内容可以直接使用 LINQ-SQL 甚至 SQL 以您期望的方式实现。

当您考虑 SQL 的工作原理时，单个一对多关系可以很容易地通过内部/左连接来展平。在此之后，如果您想要另一组对象，理论上您可以编写另一个左连接，它将带回另一个表中的所有行。但是想象一下 SQL 将提供的输出，它不容易返回到对象图中。ORM 通常会开始按行查询以提供此数据。这方面的一个例子是`DataLoadOptions`使用 LINQ-SQL 编写多个级别，您将开始看到这一点。

此外，许多 LEFT JOIN 对性能的影响很容易超过单次查询的好处。

考虑你的例子。您正在从这两个表中取回*所有行。*这进一步带来了两个问题：

*   这些表中的数据可能比您预期的要多得多。一次全部拉回 SQL 中的 1000 行可能不利于性能。然后，您期望 LINQ-SQL 在列表中搜索匹配的对象。根据使用情况，我想 SQL 可以更快地提供这些数据。

*   您期望的行为是隐藏的，对我来说，在大表上运行 SELECT 可能会通过缓存所有行来增加应用程序的内存使用量，这是不寻常的。也许他们可以将其作为一个选项包含在内，或者提供您自己的扩展方法。

**解决方案**

我个人会开始考虑在 LINQ-SQL 之外缓存数据，然后从 ASP.Net / Memory Cache / Your Cache provider 检索对象，如果认为创建完整对象图的成本很高的话。

`DataLoadOptions`依靠内置实体关系+一些手动缓存的一级加号可能会省去很多麻烦。

我遇到过这个特殊问题几次，还没有想到其他任何事情。

# c# - 如何制作动画按钮？

> ID：14491144
> 
> 赞同：2
> 
> 时间：2013-01-23T23:11:14.493
> 
> 标签：c#, android, mono, xamarin.android

我已经看过但找不到任何有用的东西。我是这一切的初学者，所以如果这是一个简单的问题，我深表歉意。

我想在 C# for Android (Monodroid) 中创建一个按钮，单击该按钮时会显示“按下状态”，以便用户知道该按钮已被使用。

我该怎么做呢？我的 drawables 文件夹中有两个图像，它们是来自 Photoshop 的 .png 文件 - 如何将其合并到我的项目中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:44:11.843

我相信你使用一个`State List`. 一个 XML 文件，它为不同的状态引用不同的位图图形（例如，在按下按钮时使用不同的图像）。创建一个 StateListDrawable。或许请参阅[State List 文档](http://androidapi.xamarin.com/?link=T%3aAndroid.Widget.Button)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:43:59.670

在 android 中执行此操作的标准方法是将按钮的背景设置为资源以指向状态列表可绘制 [StateList](http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)，其中包含按下和正常的状态，并指向每个状态的正确图像。

我对 monodroid 一无所知，所以我不知道你是否可以用它来做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-24T11:40:00.673

这里有一个包含两种状态的示例：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" 
        android:drawable="@drawable/button_pressed" />
    <item
         android:drawable="@drawable/button_default" />
</selector> 
```

# eclipse - Eclipse m2eclipse 没有拾取“提供的”传递依赖

> ID：14491151
> 
> 赞同：0
> 
> 时间：2013-01-23T23:12:06.420
> 
> 标签：eclipse, maven, dependencies

试图让[Roboguice](https://github.com/emmby/roboguice)在包含 2 个 Maven 项目、Astroboy 和 Roboguice 的 Eclipse 中工作（我们称它们为 A 和 B，其中 A 依赖于 B）。我的问题是 A 中的单元测试在 Maven 中工作正常会在 Eclipse 中产生编译错误，因为它找不到 Junit。Junit 在 A 的 pom 中声明为提供的依赖项，如下所示。我确实通过将 B 添加到 A 的构建路径/项目中来告诉 Eclipse 项目 A 依赖于 B。

```
 <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.8.2</version>
        <scope>provided</scope>
    </dependency> 
```

我通过更改要测试的范围（然后在 A 上执行 mvn install 和 maven/update 项目）让它暂时工作，但是我必须怎么做才能让它自己找到 Junit？

# javascript - Derby.js - 添加/删除唯一列表元素

> ID：14491160
> 
> 赞同：1
> 
> 时间：2013-01-23T23:13:04.157
> 
> 标签：javascript, model-view-controller, derbyjs

我将此作为我的引导数据，当从数据库中没有检索到任何内容时，我将其推送到模型：

```
var liveaudience = {

triggers : [
    {
        'trigger_id': 'vocal_stomp',
        'duration': 1000,
        'color': '#F23000',
        'sound': 'A#'
    },
    {
        'trigger_id': 'guitar_stomp',
        'duration': 600,
        'color': '#CC0234',
        'sound': 'Cmaj'
    },
    {
        'trigger_id': 'drum_pad',
        'duration': 1200,
        'color': '#CF2451',
        'sound': 'Emin'
    }
]

}; 
```

我有一条路线，它执行此操作，然后在模板上呈现这三个引导元素：

```
get('/:triggerId?', function(page, model, params){

    var triggers = model.get('liveaudience.triggers');
    if(typeof triggers === 'undefined'){
         // bootstrap triggers
         model.push('liveaudience.triggers', liveaudience.triggers);
    }

    model.subscribe("liveaudience.triggers", function(err, scopedModels){
        page.render({'triggers': scopedModels.get()[0]});
    });
}); 
```

然后是模板：

```
<ul id="triggers">
        {{#each triggers}}
            <li data-id="{{id}}" class="trigger" style="background-color:{{color}};">
                <span class="trigger-label">{{trigger_id}}</span>
                <a x-bind="click:removeTrigger" class="remove-trigger">x</a>
            </li>
        {{/}}
    </ul> 
```

一切都显示出来了，但 {{id}} 返回一个函数，我希望它是一个唯一分配的[GUID](http://derbyjs.com/#guids)。主要问题是我不知道在单击和触发`removeTrigger`处理程序时如何从 DOM 中获取和删除此元素。查看示例，我在处理程序中看到了这一点：

`model.at(e.target).remove();`

但这不起作用。

有任何想法吗？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-21T17:49:04.290

不要将触发器传递到 page.render 尝试使用 model.ref 像这样

对于德比 0.5

```
var triggers = model.at('liveaudience.triggers');
model.subscribe(triggers, function(err){
  model.ref('_page.triggers', triggers);
  page.render();
}); 
```

对于德比 0.3

```
model.subscribe('liveaudience.triggers', function(err,scopedModels){
  model.ref('_page.triggers', scopedModels);
  page.render();
}); 
```

然后像这样访问循环中的触发器

```
{{#each _page.triggers}} 
```

这应该正确设置绑定。

然后删除（对于 Derby 0.5，对于 0.3 不确定）

```
e.at().remove(); 
```

# php - 使用 GD 图像文件创建新的 Imagick 图像

> ID：14491163
> 
> 赞同：1
> 
> 时间：2013-01-23T23:13:29.980
> 
> 标签：php, gd, imagick

我有一个在 PHP 中使用 GD 创建图像的脚本。我想使用 Imagick 来扭曲这个图像。现在我的 GD 脚本是这样结束的：

```
imagepng($img);
imagedestroy($img); 
```

我删除了最后两行并将它们替换为：

```
$image = new imagick(); 
$image->readImageBlob($img); 
```

但它不起作用，它会出现以下错误：

```
PHP Fatal error:  Uncaught exception 'ImagickException' with message 'Can not process empty Imagick object' 
```

我不完全理解 readImageBlob 并且文档很糟糕，因此非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T21:57:11.603

readImageBlob函数将字符串作为参数，而不是 GD 资源[。](http://php.net/manual/en/imagick.readimageblob.php)*Blob*是二进制数据的字符串表示形式：因此您需要从 GD 资源中提取这些数据。

尝试以这种方式结束您的脚本：

```
ob_start();                   // starts output buffering
imagepng($img);               // writes image to that buffer
$blob = ob_get_clean();       // gets buffer as a string and clean it
$image = new imagick();  
$image->readImageBlob($blob); 
```

# python - Python unittest - 用列表断言字典

> ID：14491164
> 
> 赞同：15
> 
> 时间：2013-01-23T23:13:34.207
> 
> 标签：python, unit-testing, dictionary, assert

在为我的班级编写一些测试时，我遇到了有趣的简单问题。我想 assertDictEqual 包含一些列表的两个字典。但是这个列表可能不会以相同的方式排序 -> 导致测试失败

例子：

```
def test_myobject_export_into_dictionary(self):
    obj = MyObject()
    resulting_dictionary = {
            'state': 2347,
            'neighbours': [1,2,3]
        }
    self.assertDictEqual(resulting_dictionary, obj.exportToDict()) 
```

这有时会失败，具体取决于列表中元素的顺序

```
FAIL: test_myobject_export_into_dictionary
------------------------------------
-  'neighbours': [1,2,3],
+  'neighbours': [1,3,2], 
```

任何想法如何以简单的方式断言这一点？

在比较之前，我正在考虑使用`set`代替`list`或排序列表。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T02:36:26.160

您可以尝试[PyHamcrest](https://github.com/hamcrest/PyHamcrest) *（已纠正示例）*

```
assert_that(obj.exportToDict(), has_entries(
                                    { 'state': 2347,
                                      'neighbours': contains_inanyorder(1,2,3) })) 
```

（第一个值 2347 实际上被包装在一个隐式`equal_to`匹配器中。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:24:59.217

你可以做：

```
a = {i:sorted(j) if isinstance(j, list) else j for i,j in resulting_dictionary.iteritems()}
b = {i:sorted(j) if isinstance(j, list) else j for i,j in obj.exportToDict().iteritems()}
self.assertDictEqual(a, b) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:23:14.283

如何使用`all`：

```
assert all( (k,v) in resulting_dictionary.iteritems() 
            for (k,v) in obj.exportToDict().iteritems() ) 
```

我在 py.test 中使用了类似的东西，但我认为它应该适合你。

* * *

一位评论者指出，订单会在这里搞砸我——很公平……那么我只会使用套装。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-03T13:51:04.183

也许您可以分别检查这两个元素：

```
obj_dict = obj.exportToDict()
self.assertEqual(resulting_dictionary['state'], obj_dict['state'])
self.assertCountEqual(resulting_dictionary['neighbours'], obj_dict['neighbours']) 
```

# python - ReportLab 变量 nextPageTemplate 的

> ID：14491169
> 
> 赞同：2
> 
> 时间：2013-01-23T23:14:17.730
> 
> 标签：python, reportlab

我正在将数据库从 pfaf.org（面向未来的植物）转换为 pdf 书。关于pageTemplates，我遇到了一些绊脚石。

每个植物可以从左对齐或右对齐的页面开始；并且可能是两页或更多页。我有两个用于第一个工厂页面（左和右）的模板，还有两个用于潜在后续页面的模板。

目前处理如下（例如）：

```
for i, plant in enumerate(plants):
  #the first plant is printed on a right-hand page
  if i % 2 == 0:
    template = 'left'
    second = 'right'
  else:
    template = 'right'
    second = 'left'

  Story.append(nextPageTemplate(template,'*', 'secondary_'+template, 'secondary_'+second))
  Story.append(PageBreak())
  #append various paragraphs, jumping between frames, etc... 
```

代码（正如您可能知道的那样）适用于单页植物。对于多页植物，它也可以按预期工作（半）。

但是，您也可能看到，两（或四等）页植物会破坏模板排列，因为上面的代码假定页面位置基于植物编号，而不是页码。

我在上面的代码位置（即在 Story.append 循环期间）看不到解决方案 - 因为那时我无法判断工厂是否使用了超过一页，因此我是哪一页目前正在进行中。

我希望我可以从我的自定义 docTemplate 中调整 nextPageTemplate 结构，但我不知道这是否可能。

是吗？还是有其他解决方案？非常感谢任何帮助。一直在阅读，但我能找到的最好的例子并不能完全涵盖这种情况。

有任何问题，请提出。谢谢

* * *

谢谢你，Nitzle：
问题是我不知道每株植物会占用多少页。例如 - 一个新工厂从一个奇怪的页面开始，所以我给它一个模板循环（'right'，'*'，'secondaryLeft'，'secondaryRight'）。[辅助页面只是一个具有适当边距的框架。]

如果该植物有一页长，没问题，下一个植物将具有与上述相反的模板周期。但是，如果植物有两页，它会导致下一个植物再次落在奇数页上，因此模板周期不应该改变......我希望这是有道理的。

这是我无法解决的情况......如果我按照你说的那样做，它不允许多页植物。我的大部分代码如下；不过，我已经尝试将它缩小一点 :) 希望它仍然包含所有相关的东西，而不是太多不必要的东西。

```
import os
import sys
import MySQLdb

from reportlab.platypus import Spacer, Image, Table, TableStyle, PageBreak, FrameBreak, paraparser
from reportlab.platypus.doctemplate import BaseDocTemplate, PageTemplate, NextPageTemplate, _doNothing
from reportlab.platypus.tableofcontents import TableOfContents
from reportlab.platypus.frames import Frame
from reportlab.platypus.flowables import KeepInFrame
from reportlab.platypus.paragraph import Paragraph

from reportlab.lib.units import mm, cm
from reportlab.lib.pagesizes import A4, A5
from reportlab.lib.enums import TA_JUSTIFY, TA_CENTER, TA_RIGHT
from reportlab.lib.styles import StyleSheet1, ParagraphStyle as PS
from reportlab.lib import colors

from reportlab.graphics.shapes import Drawing, Rect, String

from reportlab.pdfbase.pdfmetrics import registerFont, stringWidth
from reportlab.pdfbase.ttfonts import TTFont
from reportlab.rl_config import warnOnMissingFontGlyphs
warnOnMissingFontGlyphs = 0

registerFont(TTFont('Museo_', '/home/wuwei/.fonts/Museo300-Regular.ttf'))
registerFont(TTFont('Museo_M', '/home/wuwei/.fonts/Museo500-Regular.ttf'))
registerFont(TTFont('Trebuchet', '/usr/share/fonts/truetype/msttcorefonts/Trebuchet_MS.ttf'))
registerFont(TTFont('Trebuchet_I', '/usr/share/fonts/truetype/msttcorefonts/Trebuchet_MS_Italic.ttf'))

## SOME VARIABLE DEFINITIONS ##

titleFont = "Museo_M"
subtitleFont = "Museo_"
stdFont = "Trebuchet"
stdItalic = "Trebuchet_I"
#stdSize = 14

"""CREATE GLOBALS"""
_w, _h = A4
_head_w = 17.5*cm
_head_pad = 0.2*cm
_main_w = 17.2*cm
_budge = 0.3*cm

_left_margin = 1.5*cm
_right_margin = 2.0*cm
_top_margin = 1.5*cm
_bottom_margin = 2.0*cm

_latinFontS = 18

#reset superFraction to style 'common name' placement
paraparser.superFraction = 0.15
paraparser.sizeDelta = 0

###########################################################################################################
#########################################                   ###############################################
########################################     DB FUNCTIONS     #############################################
#########################################                   ###############################################
###########################################################################################################

def connectToDB():
    try:
        connection = MySQLdb.connect (host = "localhost", 
                                user = "root", 
                                passwd = "****************", 
                                db = "pfaf")
    except MySQLdb.Error, e:
        print "I guess, either you don't have a local copy of the pfaf db"
        print "or something is wrong with your connection details."
        print "Error %d: %s" % (e.args[0], e.args[1])
        sys.exit (1)

    return connection

def close(item, exit=0):
    #used to close both database cursors and connections
    item.close()
    if exit == 1:
        sys.exit (0)

def runQuery(q, conn):
    results = conn.cursor(MySQLdb.cursors.DictCursor)
    results.execute (q)
    return results

def Fetch(results, fetchAll=0):
    if fetchAll:
        print "fetchAll"
        # FETCHALL option:
        rows = results.fetchall()
        #cursor.close()
        #conn.close()
        '''for row in rows:
            print "%s, %s" % (row["Latin Name"], row["Hardyness"])
        print "%d rows were returned" % results.rowcount'''
        return rows
    else:
        # FETCHONE option: 
        ##--- Print some debug info to command line ---##
        print "Latin Name  -  Common Name  -  Hardyness"       
        while (1):
            row = results.fetchone()
            if row == None:
                break

            latin_name = row["Latin Name"]
            common_name = row["Common name"]
            hardyness = row["Hardyness"]
            family = row["Family"]
            synonyms = row["Synonyms"]

        ##--- Print some more useful debug info to command line ---##
            print "%s  -  %s  -  %s" % (latin_name, common_name, hardyness)
        print row

        if results.rowcount != 1:
            print "%d rows were returned" % results.rowcount
        else:
            print "%d row was returned" % results.rowcount

        return row

###########################################################################################################
#########################################                   ###############################################
########################################  STORY PROCESSING    #############################################
#########################################                   ###############################################
###########################################################################################################

def drawBorders(canv, side):
    canv.saveState()
    d = Drawing(0,0)

    #header border#
    r = Rect( side-_budge, _h-(2.4*cm), _head_w+(_budge*2), 1.2*cm, rx=5, ry=5 )
    r.strokeColor = colors.black
    r.fillColor = colors.white
    r.strokeWidth = 1.5
    d.add(r)

    #hardyness border#
    rad = 5
    hWidth = 1.4*cm
    if side == _left_margin:
        hPos = -rad
    else:
        hPos = _w - hWidth + rad
    r = Rect( hPos, _h-(3.8*cm), hWidth, 1.2*cm, rx=rad, ry=rad )
    r.strokeColor = colors.black
    r.fillColor = colors.white
    r.strokeWidth = 1.5
    d.add(r)

    d.drawOn(canv, 0, 0)
    canv.restoreState()

def drawFooter(canv, doc):
    canv.saveState()
    canv.setFont(stdFont,10)
    canv.drawCentredString((_w/2.0), 1.5*cm, "%d - %s" % (doc.page, doc.latinName))        
    canv.restoreState()

class LeftPageTemplate(PageTemplate):
    def __init__(self):
        #allow a bigger margin on the right for binding
        latinF =    Frame(_left_margin, 27.5*cm,  _head_w,  0.8*cm,     id='latinL',    showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        hardyF =    Frame(0.1*cm, 26.05*cm,   cm,  cm,  id='hardL',       showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        synF =      Frame(_left_margin, 26.65*cm,   _main_w,  0.55*cm,  id='synL',       showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        otherF =    Frame(_left_margin, 22.1*cm,   12.4*cm,  4.5*cm,  id='otherL',       showBoundary=1)
        calF =      Frame(14.2*cm, 22.1*cm,   4.5*cm,  4.5*cm,  id='calL',       showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        flowF =     Frame(_left_margin, 2.0*cm,   _main_w,  19.85*cm,  id='flowL',     showBoundary=1)

        PageTemplate.__init__(self,
                              id='left',
                              frames=[latinF, hardyF, synF, otherF, calF, flowF], 
                              pagesize=A4)

    def beforeDrawPage(self, canv, doc):
        drawBorders(canv, _left_margin)

    def afterDrawPage(self, canv, doc): 
        drawFooter(canv, doc)

class RightPageTemplate(PageTemplate):
    def __init__(self):
        #allow a bigger margin on the left for binding
        latinF =    Frame(_right_margin, 27.5*cm,  _head_w,  0.8*cm,     id='latinR',    showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        hardyF =    Frame(_w-1.1*cm, 26.05*cm,   cm,  cm,  id='hardR',       showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        synF =      Frame(_right_margin+_budge, 26.65*cm,   _main_w,  0.55*cm,  id='synR',       showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        calF =      Frame(_right_margin+_budge, 22.1*cm,   4.5*cm,  4.5*cm,  id='calR',       showBoundary=0, 
                          rightPadding=0, leftPadding=0, topPadding=0, bottomPadding=0)
        otherF =    Frame(_right_margin+5.1*cm, 22.1*cm,   12.4*cm,  4.5*cm,  id='otherR',       showBoundary=1)
        flowF =     Frame(_right_margin+_budge, 2.0*cm,   _main_w,  19.85*cm,  id='flowR',     showBoundary=1)

        PageTemplate.__init__(self,
                              id='right',
                              frames=[latinF, hardyF, synF, otherF, calF, flowF], 
                              pagesize=A4)

    def beforeDrawPage(self, canv, doc):
        drawBorders(canv, _right_margin)

    def afterDrawPage(self, canv, doc):
        drawFooter(canv, doc)

class MyDocTemplate(BaseDocTemplate):
    _invalidInitArgs = ('pageTemplates',)

    def __init__(self, filename, **kw):
        self.allowSplitting = 0
        BaseDocTemplate.__init__(self, filename, **kw)

        self.latinName = "(none initially)"
        self.latinWidth = 0 #(none initially)

    def afterInit(self):
        self._calc() #in case we have changed margin sizes etc

        self.leftMargin = _left_margin
        self.rightMargin = _right_margin
        self.topMargin = _top_margin
        self.bottomMargin = _bottom_margin
        self.width = _w - self.leftMargin - self.rightMargin
        self.height = _h - self.topMargin - self.bottomMargin

        frameStd = Frame(cm, self.bottomMargin, (_w - 2*cm), (_h - 3*cm), id='cvr', showBoundary=0)
        frameToC = Frame(self.rightMargin, self.bottomMargin, self.width, self.height, id='tocFrame', showBoundary=0)
        frameL = Frame(self.leftMargin, self.bottomMargin, self.width, self.height, id='secLeftFrame', showBoundary=1)
        frameR = Frame(self.leftMargin, self.bottomMargin, self.width, self.height, id='secRightFrame', showBoundary=1)

        self.addPageTemplates( [PageTemplate(id='Cover', frames=frameStd, onPage=coverPage, pagesize=self.pagesize), 
                                PageTemplate(id='ToC', frames=frameToC, onPage=tocPage, pagesize=self.pagesize), 
                                PageTemplate(id='blank', frames=frameStd, onPage=_doNothing, pagesize=self.pagesize), 
                                LeftPageTemplate(), 
                                RightPageTemplate(),
                                PageTemplate(id='secondary_left', frames=frameL, onPage=_doNothing, pagesize=self.pagesize),
                                PageTemplate(id='secondary_right', frames=frameR, onPage=_doNothing, pagesize=self.pagesize)
                               ] )

    def afterFlowable(self, flowable):
        """Registers ToC entries - and captures latin name for footer"""
        if isinstance(flowable, Paragraph):
            style = flowable.style.name
            key = None
            firstWord = style.split('_',1)[0]
            if (style == 'LatinName') or (style == 'LatinNameR') or (firstWord == 'LatinName'):
                level = 0
                key = 'latin-%s' % self.seq.nextf('LatinName')
                self.canv.bookmarkPage(key)

                wholeStr = flowable.getPlainText()
                if self.page % 2 == 0: #even numbers are on left pages
                    latinOnly = wholeStr.split('\xc2\xa0\xc2\xa0')[0] #looks for '&nbsp&nbsp' as divider
                else:
                    latinOnly = wholeStr.split('\xc2\xa0\xc2\xa0')[1]
                self.latinName = latinOnly
                E = [level, latinOnly, self.page]
                if key is not None: E.append(key)
                self.notify('TOCEntry', tuple(E))
                '''elif (style == 'CommonName'):
                self.commonName = flowable.getPlainText()
                self.commonWidth = stringWidth(self.commonName, styles['common'].fontName, styles['common'].fontSize)'''
            else:
                return

""" coverPage and otherPages are intended for non-flowing (i.e standard) parts of the pages """
def coverPage(canvas, doc):
    Title = "Plants for a Future"
    pageinfo = "The full database collected as a printable book"
    canvas.setTitle(Title + " : " + pageinfo)

    print "creating cover page..."
    canvas.saveState()
    d = Drawing(0,0)

    r = Rect( 0, 0, 12*cm, 4*cm, rx=5, ry=5 )
    r.strokeColor = colors.black
    r.fillColor = colors.white
    r.strokeWidth = 3
    d.add(r)
    d.drawOn(canvas, (_w/2.0)-6*cm, _h-(6.2*cm))

    canvas.setFont(stdFont, 30)
    canvas.drawCentredString(_w/2.0, _h-108, Title)
    canvas.setFont(stdItalic, 14)
    canvas.drawCentredString(_w/2.0, _h-150, pageinfo)
    canvas.restoreState()

def tocPage(canvas, doc):
    canvas.saveState()
    canvas.setFont(stdFont,10)
    canvas.drawCentredString((_w/2.0), 1.5*cm, "Table of Contents")
    canvas.restoreState()

def getMedicinal(plant):
    p = plant
    initial = p["Medicinal"]
    return initial

""" Run after 'Story' has been fully populated """
def go():
    doc = MyDocTemplate('result01.pdf')
    passes = doc.multiBuild(Story)

########################################################################

"""Build StyleSheet"""
styles = buildStyle()

h1 = PS(name = 'HeadingOne',
        fontName = stdFont, 
        fontSize = 14,
        leading = 16)

h2 = PS(name = 'HeadingTwo',
        fontName = stdFont, 
        fontSize = 12,
        leading = 14,
        leftIndent = 1*cm)

Story=[]

a = Story.append
a(NextPageTemplate('blank'))
a(PageBreak())
a(NextPageTemplate('ToC'))
a(PageBreak())

toc = TableOfContents()
toc.levelStyles = [ h1, h2 ]
a(toc)

a(NextPageTemplate('blank'))
a(PageBreak())

"""###LEFT PAGES SHOULD BE STYLED RIGHT-ALIGNED, AND RIGHT PAGES LEFT-ALIGNED###"""
#print type(plants)
for i, plant in enumerate(plants):
    ### THIS INITIAL CHECK BREAKS AS IT NEEDS TO BE BASED ON PAGE NUMBER, NOT PLANT NUMBER!!! ###
    if i %2 == 0: #IF FIRST PLANT APPEARS ON A RIGHTSIDE PAGE, ELSE REVERSE THE R and L
        page='R'
        template = 'right'
        second = 'left'
    else:
        page='L'
        template ='left'
        second = 'right'

    #FIRST THINGS FIRST:
    #Make sure the page templates flow nicely for each plant "chapter"
    a(NextPageTemplate([template, '*', ('secondary_'+template), ('secondary_'+second) ]))
    a(PageBreak())

    '''CAPTURE PLANT INFO IN OBJECTS'''
    p = plant

    '''for info in plant:
        print info, p[info]'''

    '''Header'''
    latin = p["Latin Name"]
    common = p["Common name"]
    family = p["Family"]
    syn = p["Synonyms"]
    """X. congestum. (Lour.)Merrill.  X. racemosum. Miq.  Apactis japonica.  Croton congestum.  
                Flacourtia japonica. Walp.  Hisingera japonica.  H. racemosa."""
    hardy = str(p["Hardyness"])

    '''Basic Info'''
    author = p["Author"]
    botanicalrefs = p["Botanical references"]
    width = p["Width"]
    height = p["Height"]
    habit = p["Habit"]

    planttype = clean("Deciduous/Evergreen", p)

    plantrange = p["Range"]
    habitat = p["Habitat"]
    soil = clean("Soil", plant)
    shade = p["Shade"]
    moisture = p["Moisture"]
    drained = p["Well-drained"]
    nf = p["Nitrogen fixer"]
    pH = p["pH"]
    acid = p["Acid"]
    alkaline = p["Alkaline"]
    saline = p["Saline"]
    wind = p["Wind"]

    rate = clean("Growth rate", plant)
    pollution = p["Pollution"]
    poorsoil = p["Poor soil"]
    drought = p["Drought"]
    heavyclay = p["Heavy clay"]
    tender = clean("FrostTender", plant)

    inleaf = p["In leaf"]
    flowering = p["Flowering time"]
    seedripens = p["Seed ripens"]
    flowertype = p["Flower Type"]
    pollinators = p["Pollinators"]
    selffertile = clean("Self-fertile", plant)

    hazards = p["Known hazards"]

    rating_edible = p["Rating"]
    rating_med = p["Medicinal Rating"]
    edibleuses = p["Edible uses"]
    medicinaluses = getMedicinal(plant)
    otheruses = p["Uses notes"]
    #the following encoding allows for special characters such as degree symbol
    cultivation = unicode(p["Cultivation details"], 'latin-1')#'ISO-8859-1')
    propagation = p["Propagation 1"]

    scented = p["Scented"] #boolean - requires further lookup in `ScentedPlants` table

    string = '''%s is %s %s growing to %gm by %gm at a %s rate.<br/> 
                It's habitats are %s <br/><br/> Range: %s
                    <br/><br/>
                Suitable for %s soils. <br/><br/>
                Shade: %s, Moisture: %s <br/>
                Well-drained: %d, Nitrogen fixer: %d <br/> ph: %s <br/>
                Acid: %d, Alkaline: %d, Saline: %d <br/>
                Wind: %s 
                    <br/><br/>
                Author: %s <br/> Botanical References: %s''' % (
                    latin, planttype, habit.lower(), width, height, rate, 
                    habitat[0].lower()+habitat[1:], plantrange, 
                    soil, shade, moisture, drained,
                    nf, pH, acid, alkaline, saline, wind, author, botanicalrefs )
    string = unicode(string, 'latin-1')

    latinW = stringWidth(latin, styles['latin'].fontName, styles['latin'].fontSize)
    commonW = stringWidth(common, styles['common'].fontName, styles['common'].fontSize)

    if (latinW + commonW + (_head_pad*3)) > _head_w:
        styleName = "LatinName_" + str(i)
        latinStyle = PS( name=styleName, 
                         parent=styles['Normal'],
                         fontName=titleFont, 
                         fontSize=_latinFontS, 
                         leading=22, 
                         spaceAfter=0)
        j = 1
        #should the latin string be too long, attempt to shrink until it fits
        while (latinW + commonW + (_head_pad*3)) > _head_w:
            #change the font size until ok...
            latinStyle.fontSize = _latinFontS -j
            latinW = stringWidth(latin, latinStyle.fontName, latinStyle.fontSize)
            j += 0.2
    else:
        latinStyle = styles['LatinName']

    if page == 'L':
        headerText = '''<para align="left">
                            %s
                            <font face="%s" size="%d">&nbsp;&nbsp;<super>%s</super></font>
                        </para>''' % (latin, subtitleFont, 12, common)
    else:
        headerText = '''<para align="right">
                            <font face="%s" size="%d"><super>%s</super>&nbsp;&nbsp;</font>
                            %s
                        </para>''' % (subtitleFont, 12, common, latin)
    latinPara = Paragraph(headerText, latinStyle)

    a(FrameBreak('latin'+page))
    a(latinPara)

    a(FrameBreak('syn'+page))
    a(KeepInFrame(_main_w, 1.5*cm, 
                  [Paragraph(syn, styles['syn'+page])], 
                  mode="shrink")) #can be shrink, truncate or overflow

    a(FrameBreak('hard'+page))
    a(Paragraph(hardy, styles['hardy']))

    a(FrameBreak('cal'+page))
    #SHALL BE ULTIMATELY POPULATED VIA DATABASE#
    greyOut = [ [0,0,1,1,1,1,1,0,0,0,0,0], [0,0,0,0,0,1,1,1,1,0,0,0], [0,0,0,0,0,0,0,0,1,1,1,0] ]

    cal = drawCalendar(greyOut)
    a(cal)

    a(FrameBreak('flow'+page))
    a(Paragraph(string, styles['Normal']))
    a(Paragraph("Edible Uses", styles['title']))
    a(Paragraph("Medicinal Uses", styles['title']))
    a(Paragraph("Other Uses", styles['title']))

    a(Paragraph("Cultivation", styles['title']))
    a(Paragraph(cultivation, styles['Normal']))

    a(Paragraph("Propagation", styles['title']))
    a(Paragraph(propagation, styles['Normal']))

##ASSEMBLE PDF###
go() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:49:46.583

如果您只是在“左”和“右”模板之间切换，您可以尝试使用类的`_handle_nextPageTemplate`方法`BaseDocTemplate`。跟踪页码的一种方法是使用`afterPage`挂钩来增加页码。

```
from reportlab.platypus import BaseDocTemplate

class MyDocTemplate(BaseDocTemplate):
    def __init__(self, *args, **kwargs):
        BaseDocTemplate.__init__(self, *args, **kwargs)
        self.__pageNum = 1

    def afterPage(self):
        """Called after all flowables have been drawn on a page"""

        # Increment pageNum since the page has been completed
        self.__pageNum += 1

        # If the page number is even, force "left-side" template
        if self.__pageNum % 2 == 0:
            self._handle_nextPageTemplate('left_template')
        else:
            self._handle_nextPageTemplate('right_template') 
```

我没有测试过上面的代码，但是你可能需要使用`beforePage`它来代替它检查页面模板顺序的方式。

# java - 从另一个类设置 JTable 列宽

> ID：14491184
> 
> 赞同：0
> 
> 时间：2013-01-23T23:15:33.733
> 
> 标签：java, swing, user-interface, jtable, tablemodel

```
 public TableModel getTableData() {
     TableModel model=null;
    try {
        String sql = "SELECT eventID as 'Event ID', date as 'Date',eventName as 'Name', time as 'Start Time' FROM Event";
        pst = conn.prepareStatement(sql); 
        rs = pst.executeQuery();
        model = (DbUtils.resultSetToTableModel(rs));
       //CODE TO SET WIDTH OF JTABLE IN VIEWS
        }
    catch(SQLException e){
        e.printStackTrace();
    }
   finally {
        try {rs.close(); pst.close();}
        catch(SQLException e){}     }                                 
       return model; 
} 
```

上面是 Model 类的一个方法，负责为我在 Views 中调用的表设置表模型`tableEvent`。

Controller类使用上面的方法来设置改变Class`tableEvent`的状态。`Views`请注意`tableEvent`，视图中是空的/那里什么都没有。模型将值传递`rs`给`Controller`which 将更改表格的显示并填充值。

这就是我的意思：

`view.tableEvent.setModel(model.getTableData());`

但是，我试图将列的宽度设置为 in`Model`而不是`Views`through `tableEvent.getColumnModel().getColumn(1).setPreferredWidth(60);`。如果我将表本身传递给方法`getTableData()`以设置列的宽度，它实际上并没有工作。有没有一种方法可以以某种方式在 getTableData() 方法中的 Model 类中指定我想要的表的前 4 列的宽度，以便它始终保持一致。现在我在 Views 类的构造函数的一部分有这个，这显然意味着它只在初始化时才达到我想要的宽度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:20:06.640

如果`JTable`or`TableModel`为空且没有列信息，则您需要自己提供该信息。

您可以创建一个新的`TableColumnModel`，添加所需`TableColumns`的，提供您想要/需要的宽度信息并将该模型应用于`JTable`.

然后，您还需要填写`TableModel`并将其提供给`JTable`。

`ResultSet`在我尝试从中检索数据之前，我个人会从元数据中提取元数据。

# oop - OOP——继承

> ID：14491186
> 
> 赞同：1
> 
> 时间：2013-01-23T23:15:46.090
> 
> 标签：oop, class

如果我有课，动物课。

我有一个类 Dog 和一个类 Cat 都继承了 Animal。

Cat 可以调用 Animal 内部的方法。但是 Cat 可以调用 Dog 的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T23:23:39.803

可以这样回答您的问题的答案是猫是狗吗？

我会让你回答这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T23:21:58.023

不，它不能，也不应该（至少在谈论正确的 OOP 时）。如果一只猫真的需要一只狗（无论出于何种原因），你应该将狗注射到猫体内。如果你认为你需要它，你可能有错误的继承/抽象。

```
class Animal
{
    public annoy();
}

class Cat extends Animal
{
    private $dog;

    public function __construct(Dog $dog)
    {
        $this->dog = $dog;
    }

    public function annoyDog()
    {
        $this->dog->annoy();
    }
}

class Dog extends Animal
{
}

$dog = new Dog();
$cat = new Cat($dog);
$cat->annoyDog(); 
```

上面是一个注入的例子。请注意，正如托尼霍普金森所说，在这种情况下，您正在调用 dog 实例的方法。如果它们是，你可以调用类上的方法`public static`，但由于它被标记为 OOP，你真的不应该。PS 示例在 PHP 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T23:22:05.903

超类中定义的方法可以被任何子类访问。但是“姐妹”类不能访问彼此的（私有）方法。

因此，如果您的类`Cat`和`Dog`继承自`Animal`，那么`Cat`和`Dog`对象都可以从 调用方法`Animal`，但它们不能（*绝不能*）访问彼此的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-24T00:22:27.720

```
If I have a class, class Animal.

And I have a class Dog and a class Cat both inheriting Animal.

Cat can call methods inside Animal. But can Cat call methods of Dog? 
```

在javascript中，是的，我会使用coffeescript，因为它更容易编写：

```
class Animal
   bark:-> "i'm an animal"

class Dog extends Animal
  eatBone : -> "i'm eating a bone"

class Cat extends Animal

cat = new Cat

alert Dog::eatBone.call cat 
```

是否有意义 ？可能不是，但是在javascript中原型的方法没有绑定到一个对象（除非你用闭包强制它）。现在有人可能会争辩说 javascript 没有像 java 这样的类，但是 C++ 类像 Java 那样吗？像 Java 那样的 python 类？谁来决定什么是真正的课程？

我的观点是，这个问题在语言环境之外是无关紧要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T11:59:34.767

这里 cat 和 dog 是两个不同的类，它们之间没有直接关系。如果我们愿意，我们可以添加一些代码来链接这些类。在此之前，不能从另一个访问其中的成员。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T23:17:05.837

如果 Cat 没有从 Dog 继承，那么没有

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-24T09:22:32.120

恐怕……不。`Cat`大炮调用`Dog`方法。

继承允许在子类中“查看”父类（`public`/`protected`如果您使用 Java）方法，但不能在兄弟类中“查看”。

显然，如果`Cat`有一个`Dog`as 属性的实例（我不知道为什么它应该有......）它可以调用`public`该`Dog`实例的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-05T14:52:28.160

在 java 上下文中[我通过 Java 遇到过 OOP]

你不能。

对象可以调用的方法由引用变量决定。

如果您使用 Dog/Cat 引用变量，它只能访问 Dog/Cat 类中的方法（包括继承和覆盖的方法）

如果您使用 Animal(ieParent Class) 作为引用变量并让它引用 Cat/Dog 类对象。您只能使用该引用变量调用子类的继承/覆盖方法。这是在编译时决定的。[如果被调用的 fn 由引用变量标识或否]

Dog 类对象不知道专有的 Cat 类函数[除了继承和覆盖的函数]，因此它不能调用这些方法。

正如其他人所指出的，如果你有这样的情况，你可能不会寻找继承。

# html - 如何增加 dt 标签之间的间距

> ID：14491188
> 
> 赞同：0
> 
> 时间：2013-01-23T23:15:49.633
> 
> 标签：html, css

我无法弄清楚如何通过 css 增加这些 dt 标签之间的间距这是我的 html

```
 <div id="wrapper">
      <div id="content">

        <d1 id ="contact-info"><dt><h2>FIND OUT MORE ABOUT US</h2></dt>
          <dt><h2>AND OUR SERVICES:</h2></dt>

         <dt><h1>CLX Exchange Accommodators, Inc.</h1></dt>

          <dt>970 Main Avenue</dt>
         <dt>Durango, CO 81301</dt>
         <dt>(877) 776-1031 </dt>
         <dt>(970) 247-5464</dt>
         <dt>FAX (970) 247-0105</dt>
           <dt>E-mail: info@1031clx.com</dt>
        </d1>
      </div>
      <!--End of content -->
      <div id="footer">
         <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="whatIs1031.html">What is a 1031 Exchange?</a></li>
            <li><a href="exchangeRequ.html">
               1031 Exchange Requirements</a>
            </li>
            <li><a href="typesOfExchange.html">Types of Exchanges</a></li>
            <li><a href="howToStart.html">How to get Started</a></li>
            <li><a href="whyCLX.html">Why CLX?</a></li>
            <li><a href="resources.html">Resources</a></li>
            <li><a href="fAQs.html">FAQs</a></li>
            <li><a href="fees.html">Fees</a></li>
            <li><a href="contactUs.html">Contact Us</a></li>
         </ul>
      </div>
      <!--end of footer -->
   </div>
   <!--End of Wrapper --> 
```

我尝试将联系信息更改为显示块，因为我解决了显示内联问题，但我大部分都错了。我还尝试修改元素的填充和边距，但似乎没有效果。

这是我在 codepen [http://cdpn.io/hAJyF上的代码](http://cdpn.io/hAJyF)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:21:17.980

您可以为 dt 标签创建一个 css 规则：

```
#contact-info dt{

} 
```

在规则中，您可以指定填充或边距以增加它们之间的空间。或者，您可以`<br />`在它们之间添加一个以添加空行。

这确实引出了一个问题，即您为什么要在那里使用 dt 标签。

# c++ - 在插槽中使用 QMap

> ID：14491191
> 
> 赞同：0
> 
> 时间：2013-01-23T23:16:15.003
> 
> 标签：c++, qt4, qmap

我想使用我之前创建的用于插槽内的 QMap。我试过遵循[这个](https://stackoverflow.com/questions/4229080/qt-cant-pass-qmap-through-to-slot)，但它仍然没有用（我想我只是在做一些愚蠢的事情）。这是我正在使用的代码。

构造函数：

```
QMap <int, QList<int> > tiles;
connect(ui->lineEdit, SIGNAL(editingFinished()), this, SLOT(someSlot())); 
```

现在，每当我发送信号 editingFinished 时，我希望 someSlot 检查该值是否在 QMap 中，如果是，则继续处理各种条件。问题是，我如何将我的 QMap 传递给一个插槽？Qt 似乎不允许带参数的插槽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:46:16.907

插槽只是 Qt 调用的函数。它的调用方式很神奇，但它只是一个函数。参数被传递到信号中（就像常规函数一样），Qt 最终将该参数（或更可能是该参数的副本）传递给接收者插槽。在 Qt 中有一个逻辑，在定义连接时，您不必像传递信号那样向插槽传递尽可能多的参数，但这不是本次讨论的内容。

您不能在这样的连接中按名称传递参数。

您可以让您的瓦片对象成为实现 someSlot() 的类的成员变量，或者您必须将瓦片传递给连接到 someSlot(const QMap >&) 的信号

我的建议是让tiles成为成员变量，而不是堆栈变量

# .net - 将一个类映射到多个表

> ID：14491193
> 
> 赞同：1
> 
> 时间：2013-01-23T23:16:22.097
> 
> 标签：.net, nhibernate, fluent-nhibernate, nhibernate-mapping

我有一个类不能映射到一个显式表。它映射到的表取决于使用它的上下文。基本上它的工作方式应该与我试图将 an 绑定`IDictionary<string, int>`到表一样。

```
// this is a mapped entity, with a Guid Id, but it can't be mapped to one explicit table
public class NoTableClass : Entity<Guid>
{

}

// the table that this class gets its MyCollectionContext1 from depends on the HasMany mapping for that property
public class MappedClass1 : Entity<Guid>
{
    public IEnumerable<NoTableClass> MyCollectionContext1 { get; set; }
}

// the table that this class gets its MyCollectionContext2 from depends on the HasMany mapping for that property
public class MappedClass2 : Entity<Guid>
{
    public IEnumerable<NoTableClass> MyCollectionContext2 { get; set; }
}

// Mapping overrides

public void Override(AutoMapping<MappedClass1> mapping)
{
    mapping.HasMany(Reveal.Member<MappedClass1, IEnumerable<NoTableClass>>("MyCollectionContext1"))
        .Table("Table1")
        .Access.Field()
        .Cascade.AllDeleteOrphan();
}

public void Override(AutoMapping<MappedClass2> mapping)
{
    mapping.HasMany(Reveal.Member<MappedClass2, IEnumerable<NoTableClass>>("MyCollectionContext2"))
        .Table("Table2")
        .Access.Field()
        .Cascade.AllDeleteOrphan();
} 
```

`.Table()`当集合具有自定义类时，NHibernate 似乎忽略了映射方法。我不明白为什么可以以这种方式映射简单类型的字典，但具有自定义类的集合却不能。

注意：我有我的理由不想使用继承/泛型来解决这个问题，并且不想为我映射到的每个表都有一个具体的类型。我们有一个使用泛型的可行解决方案，但它会给我们带来其他问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T11:05:36.473

我认为您尝试做的事情可以通过组件来实现：

```
public static void Override(AutoMapping<MappedClass1> mapping) {
    mapping.HasMany(Reveal.Member<MappedClass1, IEnumerable<NoTableClass>>("MyCollectionContext1"))
            .Component(c => {
                c.Map(x => x.Id);
                c.Map(x => x.Name);
            })
            .Table("Table1")
            .Cascade.AllDeleteOrphan();
}

public static void Override(AutoMapping<MappedClass2> mapping) {
    mapping.HasMany(Reveal.Member<MappedClass2, IEnumerable<NoTableClass>>("MyCollectionContext2"))
            .Component(c => {
                c.Map(x => x.Id);
                c.Map(x => x.Name);
            })
            .Table("Table2")
            .Cascade.AllDeleteOrphan();
} 
```

这是要玩的代码：[https ://gist.github.com/4620069](https://gist.github.com/4620069)

# windows - 如何在 Windows 8 中运行 activex 控件

> ID：14491195
> 
> 赞同：0
> 
> 时间：2013-01-23T23:16:34.840
> 
> 标签：windows, activex, internet-explorer-10

我有一个使用 activex 的 Intranet 应用程序。它在 Windows 7 中运行良好，但在 Windows 8 中运行良好。我使用 caspol 来授予完全信任，我已将 IE 10 设置为允许下载和运行 activex 控件。

我什至尝试使用 activex 插件在 Chrome 中运行它。

似乎没有任何效果。

# mysql - 在 MySQL 中，如何连接多行然后搜索该数据？

> ID：14491198
> 
> 赞同：0
> 
> 时间：2013-01-23T23:17:03.827
> 
> 标签：mysql, group-concat

在 MySQL 上有点挣扎。我找到了`GROUP_CONCAT`适合我需要的功能，但我不知道如何使用它。我想做的是在几列以及 concat 列中进行搜索；所以如果任何一列等于我的搜索词（`%a%`在这个例子中）它应该被返回。我已经弄清楚如何返回连接的流派字符串，但我不知道如何搜索它。

```
SELECT albumArtworkURL, albumName, albumID, 
  b.artistID AS ArtistID, b.artistName AS ArtistName,
  GROUP_CONCAT(DISTINCT c.songGenre separator ',') AS genres
FROM album
LEFT JOIN artist b ON album.albumArtist = b.artistID
LEFT JOIN song c ON albumID = c.songOnAlbum
WHERE albumName LIKE '%a%' OR albumYear LIKE '%a%'
GROUP BY albumArtworkURL, albumName, albumID, ArtistID, ArtistName
ORDER BY albumYear ASC, albumName ASC 
```

非常感谢一些帮助。谢谢 ：-）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:23:49.093

要从 GROUP_CONCAT 中搜索结果，该谓词必须位于 HAVING 子句中，该子句应出现在 GROUP BY 之后和 ORDER BY 之前，例如

```
HAVING genres LIKE '%a%' 
```

请注意，在访问行时，GROUP_CONCAT 表达式的值不可用，即在评估 ON 和 WHERE 子句中的谓词时。在准备好结果集之前，该表达式不可用，这就是该谓词需要在 HAVING 子句中的原因。（HAVING 子句在执行计划中很晚才被处理，在应用 LIMIT 子句之前，并且可能在满足 ORDER BY 的排序操作之前。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:26:18.653

如果要搜索 的结果`GROUP_CONCAT()`，则可以将查询包装在另一个选择中：

```
SELECT *
FROM
(
  SELECT albumArtworkURL, 
    albumName, 
    albumID, 
    b.artistID AS ArtistID, 
    b.artistName AS ArtistName,
    GROUP_CONCAT(DISTINCT c.songGenre separator ',') AS genres
  FROM album
  LEFT JOIN artist b 
    ON album.albumArtist = b.artistID
  LEFT JOIN song c 
    ON albumID = c.songOnAlbum
  GROUP BY albumArtworkURL, albumName, albumID, ArtistID, ArtistName
) src
WHERE albumName LIKE '%a%' 
  OR albumYear LIKE '%a%'
  OR genres LIKE  '%a%'
ORDER BY albumYear ASC, albumName ASC 
```

但是除非我在你的解释中遗漏了一些东西，否则我不知道为什么你不能只搜索`songGenre`它的 concat 而不是它的版本：

```
SELECT albumArtworkURL, 
  albumName, 
  albumID, 
  b.artistID AS ArtistID, 
  b.artistName AS ArtistName,
  GROUP_CONCAT(DISTINCT c.songGenre separator ',') AS genres
FROM album
LEFT JOIN artist b 
  ON album.albumArtist = b.artistID
LEFT JOIN song c 
  ON albumID = c.songOnAlbum
WHERE albumName LIKE '%a%' 
  OR albumYear LIKE '%a%'
  OR songGenre LIKE '%a%'
GROUP BY albumArtworkURL, albumName, albumID, ArtistID, ArtistName
ORDER BY albumYear ASC, albumName ASC 
```

# forms - GWT 将值从 HTML 表单保存到数据库

> ID：14491199
> 
> 赞同：0
> 
> 时间：2013-01-23T23:17:04.857
> 
> 标签：forms, gwt, persistence

我正在 Jetty 上的 GWT 中开始一个新项目。我已经阅读了很多关于 GWT 应用程序和相关技术的内容。我将使用 GWTP 作为 MVP 模式的实现。但是，如何将数据从表单发送到数据库。在服务器端，我想为每个动作进行交易。我应该使用 JPA 还是 Spring？我知道在某些框架中，表单的验证是在一个地方定义的，在 GWT 中是否可能？或者也许我必须在客户端和服务器上的至少两个地方定义它？

GWT 有很多库。Guava、iBatis、Hibernate 是否有助于将数据从客户端传输到服务器，然后将其持久化。您使用什么库组合来解决这些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T10:57:23.743

您可以使用任何满足您对 GWT 应用程序服务器端要求的 Java 库或框架（Spring、JPA、iBatis 和...）。

关于 GWT 应用程序中的验证，GWT 具有[验证机制](http://code.google.com/p/google-web-toolkit/wiki/BeanValidation)（基于 JSR 303），并且还有多个第三方 GWT 库（例如[gwt-validation](http://code.google.com/p/gwt-validation/)）用于客户端验证。在服务器端，您可以使用 Java 验证库。我建议您同时使用服务器端和客户端验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T05:01:56.787

GWT---rpc--->HIBERNATE----------->Mysql

# ruby - 使用 session.exec 时出现 Ruby Net::SFTP 错误

> ID：14491201
> 
> 赞同：2
> 
> 时间：2013-01-23T23:17:17.180
> 
> 标签：ruby, net-ssh, net-sftp

我从`Net::SFTP`Ruby (ruby 1.9.3p194) 中得到了一些意想不到的行为。

**变体 #1**失败。它启动一个 SFTP 块并用于`session.exec!`运行 shell 命令。

```
Net::SFTP.start(...) do |sftp|
  sftp.session.exec! "mkdir -p ..."  # Fails here.
  sftp.upload!(...)
end 
```

**变体 #2**成功。它启动一个 SSH 块并用于`sftp.upload!`复制文件。

```
Net::SSH.start(...)  do |ssh|
  ssh.exec! "mkdir -p ..."
  ssh.sftp.upload!(...)
end 
```

任何想法或解释将不胜感激。

这是变体 #1 的堆栈跟踪：

```
can't add a new key into hash during iteration

net-ssh-2.6.3/lib/net/ssh/connection/session.rb:296:in `[]='
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:296:in `open_channel'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:320:in `exec'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:354:in `exec!'
dor-services-3.20.0/lib/dor/services/digital_stacks_service.rb:28:in `block in transfer_to_document_store'
net-sftp-2.0.5/lib/net/sftp/session.rb:939:in `call'
net-sftp-2.0.5/lib/net/sftp/session.rb:939:in `block in do_version'
net-sftp-2.0.5/lib/net/sftp/session.rb:939:in `each'
net-sftp-2.0.5/lib/net/sftp/session.rb:939:in `do_version'
net-sftp-2.0.5/lib/net/sftp/session.rb:909:in `when_channel_polled'
net-ssh-2.6.3/lib/net/ssh/connection/channel.rb:311:in `call'
net-ssh-2.6.3/lib/net/ssh/connection/channel.rb:311:in `process'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:214:in `block in preprocess'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:214:in `each'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:214:in `preprocess'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:197:in `process'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:161:in `block in loop'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:161:in `loop'
net-ssh-2.6.3/lib/net/ssh/connection/session.rb:161:in `loop'
net-sftp-2.0.5/lib/net/sftp/session.rb:802:in `loop'
net-sftp-2.0.5/lib/net/sftp/session.rb:787:in `connect!'
net-sftp-2.0.5/lib/net/sftp.rb:32:in `start' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-23T23:02:36.997

这是我为解决此问题而编写的代码：

```
def mkdir_p(sftp, path)
  memo = "/"
  # [0..-2] to skip the filename
  path.split("/")[0..-2].each do |dir|
    next if dir.empty?
    if sftp.dir.entries(memo).map { |entry| entry.name }.include?(dir)
      memo += "/#{dir}"
    else
      memo += "/#{dir}"
      puts "Creating the following directory: #{memo}"
      sftp.mkdir!(memo)
    end
  end
end 
```

# php - PHP解析类清理所见即所得的html输入（特别是字体属性）

> ID：14491203
> 
> 赞同：0
> 
> 时间：2013-01-23T23:17:24.753
> 
> 标签：php, regex, parsing, wysiwyg, redactor

我正在使用 Redactor WYSIWYG 编辑器，但我发现它并不总是像应有的那样清理粘贴上的输入。

所以我们最终会得到这样的结果：

```
<p><span style="font:12px arial; margin: 10px">blah blah blah</span></p>

<pstyle="font-family:Georgia: font-size:14px">more blah blah</span></p> 
```

我只想清理属性，特别`style=""`是在 p、a、div 或 span 标签上。

我可以使用一个可靠的类或正则表达式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:19:11.603

尝试 DOMDocument：

[使用 PHP 的 HTML DOMDocument 解析 HTML](https://stackoverflow.com/questions/2571232/parse-html-with-phps-html-domdocument)

[http://php.net/manual/en/class.domdocument.php](http://php.net/manual/en/class.domdocument.php)

**编辑：**顺便说一句，您也许还应该重新考虑您正在使用的 WYSIWYIG 编辑器。我一直在使用 ckeditor、tinymce 以及最近使用 aloha 编辑器，并且所有三个都按预期解析数据。此外，这三种方法都有根据您的喜好解析粘贴数据的方法。

# kendo-ui - 如何使用 Kendo UI Grid 重置列排序？

> ID：14491205
> 
> 赞同：6
> 
> 时间：2013-01-23T23:17:58.897
> 
> 标签：kendo-ui, kendo-grid

![在此处输入图像描述](../Images/45d2b9c3200e15ffa87f50530aae04c2.png)

我正在尝试重置列排序（参见上图），以便没有向下或向上箭头。我试图`$("#grid").data("kendoGrid").refresh()`重绘网格，但它没有取消对列的排序。除了刷新浏览器之外，我还能尝试什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-23T23:33:27.363

尝试：

```
$("#grid").data("kendoGrid").dataSource.sort({}); 
```

# python - 下载可执行文件时有时权限被拒绝

> ID：14491206
> 
> 赞同：1
> 
> 时间：2013-01-23T23:17:58.617
> 
> 标签：python, windows, permissions, download, urllib

所以我正在编写一个脚本来下载一个文件，如果它没有完成，则从它停止的地方重新开始下载。那部分已经处理好了。

我把所有这些部分都拿出来只显示不起作用的部分。我刚刚制作的亚马逊网址，所以如果你运行它，它实际上不会下载任何东西，但是用实际的下载链接替换网址，会：

```
import urllib
import time
import os

file_name = "setup.exe"
web_page = urllib.FancyURLopener().open("https://s3.amazonaws.com/some_bucket/files/"+file_name)
while True:
    data = web_page.read(8192)
    if not data:
        print "done"
        break
    #print os.getcwd()
    with open(file_name, "ab") as outputFile:
        outputFile.write(data)
    #print "going..."
    #time.sleep(1) 
```

发生的情况是（这仅在尝试下载 EXE 文件时），该过程将从 web_page 读取看似随机的次数（在 1 到 20 次之间），然后抛出 IOError: 13, Permission denied。同样，使用 .gif 或 .mov 或我测试过的其他一些东西，永远不会抛出权限被拒绝错误。

此外，取消注释 time.sleep(1) 行可以解决问题。就好像 with 语句在继续之前没有完全关闭文件。

我认为 with 语句应该处理关闭，不是吗？

我还认为，也许我*当前的*目录正在以某种方式被更改，但取消注释永远不会显示它（尽管按照相同的逻辑，它不一定必须这样做）。

（还有什么奇怪的是，如果我从桌面运行这个脚本[以便它也写入桌面]并在它前面打开 Aptana，权限被拒绝错误不会发生，但第二次我将文本编辑器最小化为聚焦桌面，抛出错误——我将此归因于 Aptana 在打开时占用了大量资源，因此减慢了其他进程并且有点像 time.sleep??)

非常感谢您的任何指点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T18:48:12.313

我不明白您为什么要为每次网络读取而重新打开和关闭文件。正如 Pavel 建议的那样，这可能会让病毒扫描程序有机会打开（并锁定？）文件以对其进行扫描。为什么不只打开一次，完成所有 I/O，然后关闭它？（我想这可能与您省略的代码有关。）

代替：

```
while True:
    data = web_page.read(8192)
    if not data:
        print "done"
        break
    with open(file_name, "ab") as outputFile:
        outputFile.write(data) 
```

尝试：

```
with open(file_name, "ab") as outputFile:
    while True:
        data = web_page.read(8192)
        if not data:
            print "done"
            break
        outputFile.write(data) 
```

# gwt - GWT - event.getX() 和 event.getClientX()

> ID：14491208
> 
> 赞同：1
> 
> 时间：2013-01-23T23:18:04.047
> 
> 标签：gwt

我将点击处理程序添加到流程面板，如下所示

```
this.addDomHandler(new ClickHandler(){

            @Override
            public void onClick(ClickEvent event) {

                Window.alert("event.getX()="+event.getX()+" event.getY()="+event.getY());
                Window.alert("event.getClientX()="+event.getClientX()+" event.getClientY()="+event.getClientY());

            }

            },ClickEvent.getType()); 
```

...我可以得到它 getX() 返回流程面板中的鼠标位置，但 getClientX() 返回另一个值，我无法获得该值来自。所以我的问题是 getClientXY() 方法的用途是什么？

PS GWT 2.2/2.3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:36:40.677

[javadoc](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/event/dom/client/MouseEvent.html#getClientX%28%29)很清楚：

`getClientX`: 获取**浏览器窗口**客户区内的鼠标 x 位置。

`getX`: 获取鼠标相对于事件**当前目标元素**的 x 位置。

因此，您可以使用 getClientX 来获取`left`某个元素的绝对位置。

# sql - 循环以有条件地导出表 SAS（大量变量）

> ID：14491209
> 
> 赞同：2
> 
> 时间：2013-01-23T23:18:13.740
> 
> 标签：sql, r, excel, sas

因此，我试图根据特定的变量分组分解一个大型数据集（70,000 个 obs 和 1,790 个变量）。Excel 或 CSV 是导出到的理想格式，但对可变数字有限制（260 或其他）。任何想法如何在 SAS（或 R / SQL 否则）中做到这一点？

我知道宏有效，我以前用过。错误消息读取已达到变量限制。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T23:32:19.057

创建 Excel 文件当然有限制，但不是 CSV 文件。下面是一个使用虚拟 SAS 数据集的示例：

```
data a;
  array x(*) x1-x1790;
  do j=1 to 5;
     do i=1 to dim(x);
        x(i) = ranuni(0);
        end;
     output;
     end;
run;

proc export data=a
   outfile="c:\temp\tempfile.csv"
   dbms=CSV
   replace;
run; 
```

这是相关的日志：

```
NOTE: The file 'c:\temp\tempfile.csv' is:
      Filename=c:\temp\tempfile.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=23Jan2013:15:27:13,
      Create Time=23Jan2013:15:27:13

NOTE: 6 records were written to the file 'c:\temp\tempfile.csv'.
      The minimum record length was 9636.
      The maximum record length was 23087.
NOTE: There were 5 observations read from the data set WORK.A.
NOTE: DATA statement used (Total process time):
      real time           0.26 seconds
      cpu time            0.09 seconds

5 records created in c:\temp\tempfile.csv from A.

NOTE: "c:\temp\tempfile.csv" file was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           2.04 seconds
      cpu time            0.26 seconds 
```

请注意，第一行包含列标题。

**更新：**如果您有最新版本的 SAS（9.3 TS1M1 或更高版本），您可以创建一个 Office 2010 Excel 电子表格，其中最多有 1,048,576 行 x 16,384 列。在这种情况下，您将使用`DBMS=XLSX`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T15:51:23.583

如果您对 XLSX 或 CSV 没问题，鲍勃的回答很好。如果您确实想制作一个 .xls excel 文件（限制为 255 列），或者没有 9.3TS1M1，这样做相当容易。具体如何取决于您要如何指定进入每个文件的列。

假设您只想将每 255 列放入一个单独的文件中，两个文件在中点拆分（35000 条记录放入文件 A，35001 条记录放入文件 B，每组变量）。你会做这样的事情：

```
options mprint symbolgen;
data test;
array xs x1-x1700;
do id = 1 to 70000;
 do _t = 1 to dim(xs);
  xs[_t]=ranuni(7);
 end;
 output;
end;
run;

%macro export_file(varstart=,varend=,varnumstart=0,varnumend=0,recstart=1,recend=0,keeplist=,dset=, libname=WORK, outfile=,sheet="sheet1");
%if &varnumstart ne 0 %then %do;
  proc sql noprint;
  select name into :varstart from dictionary.columns
    where libname=upcase("&libname.") and memname=upcase("&dset.") and varnum=&varnumstart.;    
  select name into :varend from dictionary.columns
    where libname=upcase("&libname.") and memname=upcase("&dset.") and varnum=&varnumend.;
  quit;
%end;
%if &varstart=%str() or &varend=%str() %then %do;
  %put "ERROR: MISSING PARAMETERS.  PLEASE CHECK YOUR MACRO CALL AND RERUN.  MUST HAVE VARSTART AND VAREND OR VARNUMSTART AND VARNUMEND.";
  %abort;
%end;

data _for_Export/view=_for_export;
set &libname..&dset;
keep &varstart.--&varend.
%if &keeplist ne %str() %then %do;
&keeplist
%end;
;
if _N_ ge &recstart.;
%if &recend ne 0 %then %do;
if _N_ le &recend.;
%end;
run;

proc export data=_for_export file=&outfile. dbms=excel replace;
sheet=&sheet.;
run;

proc datasets nolist noprint lib=work;
delete _for_export/memtype=view;
quit;
%mend export_file;
%export_file(varnumstart=1,varnumend=250, keeplist=id,recstart=1,recend=35000,dset=test,outfile="c:\temp\test.xls",sheet="sheet1");
%export_file(varnumstart=1,varnumend=250, keeplist=id,recstart=35001,recend=99999,dset=test,outfile="c:\temp\test.xls",sheet="sheet2");
%export_file(varnumstart=251,varnumend=500, keeplist=id,recstart=1,recend=35000,dset=test,outfile="c:\temp\test.xls",sheet="sheet3");
%export_file(varnumstart=251,varnumend=500, keeplist=id,recstart=35001,recend=99999,dset=test,outfile="c:\temp\test.xls",sheet="sheet4"); 
```

当我尝试导出 sheet4 时，我的失败，不确定 .xls 文件的总大小是否有限制，但您可以轻松修改它以创建单独的文件。如果您需要为每个单独的文件指定不连续的特定变量名称，这将不起作用，但是您可以相当容易地修改从 dictionary.columns 中提取的 SQL 代码，而不是从您创建的包含变量名称的表中提取您想要在每个文件中。

# android - 如何取消具有本机代码 (C/C++) 的任务？

> ID：14491211
> 
> 赞同：1
> 
> 时间：2013-01-23T23:18:25.183
> 
> 标签：android, android-ndk, android-asynctask, java-native-interface, cancellation

## 背景

我有一个简短而繁重的任务，它使用 NDK (JNI) 来进行一些位图操作。

在某些情况下，我需要取消任务并去做其他事情。

但是，由于该任务也使用了大量内存，并且最终还会创建一个大位图，这可能会导致内存不足错误。

## 问题

我应该如何取消包含本机代码的任务？对此有最佳做法吗？

也许某种我可以用于 C/C++ 的中断异常，以便一旦它被捕获，我至少可以释放所有内存？

也许我应该在本机代码中添加某种侦听器（观察者）？或者也许我应该调用一个我需要假设调用者拥有的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:30:52.550

最简单的方法？

在线程上旋转任务。您可以在 Java 中旋转线程并从那里调用 JNI。它比 pthreads 更容易。

引入一个 volatile 标志（布尔变量），在任务启动时将其设置为 false。

在任务中，尽可能多地检查停止标志。如果为真，则放弃任务（您可能会抛出异常以通过多层函数嵌套返回，但您不必这样做）。

当你想取消时，从主线程设置标志。等待任务注意到这一点。

如果任务中最慢的部分是调用库/操作系统函数，这将无法正常工作——该函数不会检查标志。

C++ 中没有安全的内置机制来正确终止不想终止的代码线程（可能是信号，但它们会终止整个进程，而不是线程）。定期检查标志就是我所说的“想要被终止”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:31:34.843

我以前见过这种方法，我认为最好的方法是创建一个`isCancelled()`方法，您可以从本机代码定期调用该方法以确定何时停止。如果您正在使用`AsyncTask`，则该方法应该已经存在。

# html - 将不强制页面重新加载的提交按钮放在一起

> ID：14491214
> 
> 赞同：1
> 
> 时间：2013-01-23T23:18:47.630
> 
> 标签：html, ajax

我在一个页面上有几个表单（1-20+），我希望每个表单都有自己的提交按钮。理想情况下，每个表单的提交按钮会将表单中的数据发布到处理程序 php 文件，该处理程序 php 文件会将其提交到数据库。如果它用一些“数据提交”确认文本替换表单也很好，但这是我可以稍后添加的顶部的绒毛。我想用 ajax 来做这件事，但我不确定如何做到这一点。

让我们假设我的表单是一个字段，它看起来像这样：

```
<form action="submitHandler.php" method="post">
    <input type="text" value="testdata" name="Details" id="details">
    <button type="submit" onclick="functionThatSendsData">Submit</button>
</form> 
```

这是我的 getXMLHTTP() 函数。我以前用它来处理其他一些与 ajax 相关的事情，所以我很确定它是正确的

```
function getXMLHTTP() { //function to return the xml http object
    var xmlhttp=false;  
    try{
        xmlhttp=new XMLHttpRequest();
    }
    catch(e)    {       
        try{            
            xmlhttp= new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch(e){
            try{
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
            }
            catch(e1){
                xmlhttp=false;
            }
        }
    }

    return xmlhttp;
} 
```

我不得不想象我的 SubmitHandler.php 会做这样的事情：

```
$data=$_POST['Details'];

//make connection to database, bail if no connection
$connection = odbc_pconnect('db','','');
if (!$connection) { exit("Connection Failed: " . $connection); }

//Insert Fields into DB
$sql = "INSERT INTO TestTable (Data) VALUES ('$data')";
$rs = odbc_exec($connection, $sql);
if (!$rs) { exit("Error in SQL"); } 
```

看来我最需要有关“functionThatSendsData”的帮助，该功能将在单击提交按钮时执行。这是一个简单的示例，但显然需要对其进行缩放以适应更多的字段值（10 左右）。有人可以帮我解决这个问题吗？如果我可以让它只使用一个数据，我假设我可以自己扩展它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:37:30.043

您需要取消按钮的提交操作。

经典地写 return false 作为脚本的返回值。

```
return false; 
```

或者在您使用 Jquery 时在您的操作开始时声明一个 preventdefault：http: [//api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T03:39:52.843

[http://www.webmaster-talk.com/javascript-forum/230390-how-can-i-submit-form-without.html](http://www.webmaster-talk.com/javascript-forum/230390-how-can-i-submit-form-without.html)

该线程中的第 8 篇文章对我帮助很大。想我会把它贴给后来偶然发现这个的人。

# mysql - 是否可以更改 Rackspace 客户端帐户上的 ft_min_word_len？

> ID：14491221
> 
> 赞同：1
> 
> 时间：2013-01-23T23:19:15.503
> 
> 标签：mysql, full-text-search, rackspace-cloud

我正在使用 Rackspace 客户端帐户（没有 shell 访问权限，能够修改核心配置文件等），我需要找到一种方法将 MySQL 的 ft_min_word_len 从 3 减少到 2。如果无法访问，这是否可能......漂亮很多……什么？我可以从 MySQL 服务器做些什么来更改此设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:43:21.363

你现在可能已经想通了，但到目前为止，还没有。我也需要改变它。

我已经多次联系支持，但无济于事。

我找到[了一个关于该主题的支持/建议线程](http://feedback.rackspace.com/forums/71021-product-feedback/suggestions/3530802-mysql-configuration-management)并添加了评论。我建议你这样做。希望它得到 Rackspace 的一些关注。

附带说明一下，[ft_min_word_len 的默认值](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_ft_min_word_len)实际上是 4。

# jquery - jQuery滚动功能不断跳跃

> ID：14491222
> 
> 赞同：1
> 
> 时间：2013-01-23T23:19:21.800
> 
> 标签：jquery, html, scroll

我已经设法让这个滚动功能工作，当你停止滚动时它会滚动到 div 的顶部，唯一的问题是，它根本不顺利，它只是不停地跳来跳去，不起作用很好。
这是我的js：

```
$(document).ready(function(){
        Resize();
        });

        //Every resize of window
        $(window).resize(function() {
            Resize();
        });

        //Dynamically assign height
        function Resize() {
            // Handler for .ready() called.
            var windowHeight = $(window).height() + 'px';
            $('.fill-browser').css('height', windowHeight);
        }

$(function(){
    var _top = $(window).scrollTop();
    var individualDivHeight = $(".fill-browser").height();

    $(window).scroll(function(){
        var _cur_top = $(window).scrollTop();
        var totalHeight = $('body').height();
        var posToScroll = Math.round(_cur_top / individualDivHeight) * individualDivHeight;

        $('html, body').stop().animate({scrollTop: posToScroll}, 200);
    });
}); 
```

这里也是一个工作小提琴来证明我的意思： http: [//jsfiddle.net/vHAWW/2/](http://jsfiddle.net/vHAWW/2/)
我希望当你停止滚动时该功能非常快，但它根本不流畅，似乎不能找出原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:34:21.017

我猜这`$(window).scroll(function(){`是由以下行递归调用的：

```
 $('html, body').stop().animate({scrollTop: posToScroll}, 200); 
```

您可以尝试设置一个可以禁用事件运行的标志吗？IE：

```
var _top = $(window).scrollTop();
var individualDivHeight = $(".fill-browser").height();
var running = false;

$(window).scroll(function(){

    if(running)
        return;

    running = true;
    var _cur_top = $(window).scrollTop();
    var totalHeight = $('body').height();
    var posToScroll = Math.round(_cur_top / individualDivHeight) * individualDivHeight;

    $('html, body').stop().animate({scrollTop: posToScroll}, {duration:200, complete: function(){running = false;}});
}); 
```

尽管您可以看到它在我开始滚动时直接运行。我建议你使用超时或类似的：

```
$(function(){
    var _top = $(window).scrollTop();
    var individualDivHeight = $(".fill-browser").height();
    var running = false;
    var timeout = null;

    $(window).scroll(function(){

        if(running)
            return;

        clearTimeout(timeout);
        timeout = setTimeout(function() {
            running = true;
            var _cur_top = $(window).scrollTop();
            var totalHeight = $('body').height();
            var posToScroll = Math.round(_cur_top / individualDivHeight) * individualDivHeight;

            $('html, body').stop().animate({scrollTop: posToScroll}, {duration:200, complete: function(){running = false;}});
        }, 200);

    });
}); 
```

JsFiddle： [jsfiddle.net/HmaWW/](http://jsfiddle.net/HmaWW/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:32:35.700

我建议在用户滚动自己时阻止 scrollTop 函数运行。经过一番搜索，我从另一个[堆栈问题中找到了这个不错的](https://stackoverflow.com/questions/9144560/jquery-scroll-detect-when-user-stops-scrolling)[小提琴](http://jsfiddle.net/hYsRh/4/)。这是使用滚动选项和一个名为[debounce](http://benalman.com/projects/jquery-throttle-debounce-plugin/)的插件。

```
$(window).scroll($.debounce( 250, function(){
    //Your scrollTop function
})); 
```

# jquery - 更改 Tooltipster 工具提示在图像地图上的位置

> ID：14491224
> 
> 赞同：0
> 
> 时间：2013-01-23T23:19:32.427
> 
> 标签：jquery, tooltip, tooltipster

我正在使用带有图像映射的 jQuery Tooltipster 工具提示，但不能让它正常运行。工具提示弹出，但在我浏览器的左上角。在 javascript 文件中使用“偏移”选项确实会移动它，但我认为这不是最好的选择。将此插件与图像上的图像地图/区域坐标一起使用的正确方法是什么？

这是我正在使用的内容，将鼠标悬停在最左边的橙色或绿色圆圈上以查看我在说什么：[http ://willryan.us/test/#anatomyBox](http://willryan.us/test/#anatomyBox)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-03T15:51:38.370

对于这种情况，我的解决方法是在插件中添加一个选项来检测鼠标（指针）位置并使工具提示出现在它附近。我调用了该选项`nearPointer`并将其默认设置为`false`.

这些是我添加到 beta V4 版本的行`v4.0.0rc5`

1.  第一次插入是`tooltipster`在主脚本中定义时设置的选项。

    ```
    var pluginName = "tooltipster",
    defaults = { (...)
        animation: 'fade',
        interactiveTolerance: 350,
        multiple: false,
        nearPointer: false, //added by mestrini
        offsetX: 0,
        offsetY: 0, (...) 
    ```

2.  第二次插入是通过捕获鼠标移动事件并存储坐标来获取鼠标位置的代码。您可以在上面的**默认**选项之后立即插入它。 *我必须提到这个片段最初不是我的，但我不记得我是从网络的哪个角落得到它的；所以我向创作者道歉，因为我没有给予信任。*

    ```
     // code added by mestrini
       document.onmousemove = getMousePosition;

       function getMousePosition(e) {
        var isIE = document.all? true:false;
        var _x, _y;

        if (isIE) {
            _x = event.clientX + document.body.scrollLeft;
            _y = event.clientY + document.body.scrollTop;
        } else {
            _x = e.pageX;
            _y = e.pageY;
        } 
        posX=_x;
        posY=_y;
      return true;
    }; 
    ```

3.  第三次插入是在`reposition: function()`计算地图区域的地方进行的，目的是通过检查`nearPointer`选项布尔值来绕过它们。查找下一行并添加此代码`& !self.options.nearPointer`

    ```
    if (self.$elProxy.is('area') & !self.options.nearPointer) { 
    ```

4.  最后插入`// our function and global vars for positioning our tooltip`在第 870 行附近的此注释之前。

    ```
    //  code added by mestrini
    if (self.options.nearPointer){
        var paddY = 0, paddX = 0;
        switch (self.options.position) { //moving the tooltip a bit away from the pointer
            case 'top':
            paddY = 3;
            break;
            case 'bottom':
            paddY = -3;
            break;
            case 'right':
            paddX = -3
            break;
            case 'left':
            paddX = 3
            break;
        }
        proxy.offset.top = posY - paddY; //giving it some padding
        proxy.offset.left = posX - paddX;
        proxy.dimension.width = 0; //disregarding the plugin area calculations
        proxy.dimension.height = 0;
    }; 
    ```

# rest - 发出 DELETE 请求时，我收到来自服务器的错误请求

> ID：14491226
> 
> 赞同：0
> 
> 时间：2013-01-23T23:19:59.870
> 
> 标签：rest, httprequest, afnetworking

我正在使用 AFNetworking 共享客户端向 REST 服务器发出请求。

我的删除代码是：

```
NSMutableDictionary* params = [[NSMutableDictionary alloc] init];
[[ApiClient sharedClient] deletePath:[NSString stringWithFormat:@"users/%@/venues/%@/", appDelegate.currentUser.userId, venue.venueId] parameters:params success:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSLog(@"venue deleted from saved");
}  failure:^(AFHTTPRequestOperation *operation, NSError *error){
    NSLog(error.description);
}]; 
```

当我配置客户端时，我添加：

```
[self registerHTTPOperationClass:[AFJSONRequestOperation class]];    
[self setDefaultHeader:@"Accept" value:@"application/json"];    
[self setDefaultHeader:@"Content-Type" value:@"application/json"];    
[self setParameterEncoding:AFJSONParameterEncoding]; 
```

POST 请求工作正常，但 DELETE 请求有问题。我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T15:19:14.713

您将需要查看错误并检查出了什么问题。如果错误没有帮助，那么您将需要使用代理（可能是[Charles](http://www.charlesproxy.com)）并准确查看请求发生了什么以及服务器不喜欢它的原因。

# matlab - 使用matlab中的wden函数进行小波去噪例程

> ID：14491228
> 
> 赞同：0
> 
> 时间：2013-01-23T23:20:08.800
> 
> 标签：matlab, noise, wavelet

我今天正在阅读一份报告，该报告着眼于从温度测量中测量湖泊的蓄热情况，以减少可能混淆蓄热短期变化估计的温度波动的影响，使用了小波去噪程序（daubechies小波工具箱中 wden 函数上使用的 4 个小波、单重缩放、最小/最大阈值），其中应用了 2 级小波滤波。这种技术可以使水温的时间变化更平滑，同时保持昼夜热量增加和损失的模式。

从这个描述中，考虑到我的温度测量值类似于

```
load sumsin; 
s = sumsin; 
plot(s); 
```

我将如何应用在 matlab 中使用 wden 函数描述的技术。

为这篇文章的含糊之处道歉，但鉴于我对如何完成这项任务一无所知，我会非常乐意提供一些建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:32:07.067

我假设您正在谈论通过对小波变换的细节系数进行阈值处理来进行降噪。wden 确实做到了这一点。但是，您尚未指定是硬阈值还是软阈值。

因为不想在这里重现 matlab 的帮助，

```
help wden 
```

将为您提供有关如何使用该功能的所需信息。鉴于您提供的信息，以及软阈值是适当的假设；（与大多数方法一样，除了 Donoho 的 Visushrink，wden 将其称为“sqtwolog”）

```
[s_denoised, ~, ~] = wden(s, 'minimaxi', 's', 'sln', 2, 'db4'); 
```

应该给你你想要的。这也假设您对分解的小波树不感兴趣

# deployment - RAD 未将 EAR 项目添加到 WAS 实例

> ID：14491230
> 
> 赞同：6
> 
> 时间：2013-01-23T23:20:21.317
> 
> 标签：deployment, websphere, packaging, rad, ejb-2.x

在我的 RAD 工作区中，我有一个 EAR 项目。现在我有一个从 RAD 内部创建的 WAS 6.1 实例。当我右键单击 WAS 6.1 实例并执行“添加删除项目”并选择 EAR 时，出现错误：

```
Cannot add an EAR project to the server unless it contains a Web, EJB, or Connector module. 
```

现在这不是真的，因为在我的 EAR 项目中有 META-INF/application.xml 并且它具有以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<application id="Application_ID" version="1.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/application_1_4.xsd">
    <display-name>
    someEAR</display-name>
    <module id="EjbModule_1291759813449">
        <ejb>someEJB.jar</ejb>
    </module>
    <module>
        <web>
            <web-uri>someWeb.war</web-uri>
            <context-root>someWeb</context-root>
        </web>
    </module>
</application> 
```

很明显它有一个`<web>`and`<ejb>`模块。为什么 RAD 抱怨？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T03:54:10.823

几个潜在的解决方案：

1.  卸载您的应用程序，停止服务器，重新安装您的应用程序，启动服务器。

2.  右键单击 EAR 并检查“部署程序集”并确保您的模块正在导出。如果是这样，最好删除它们并重新添加它们。

3.  检查“项目参考”并确保它们被选中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-05T05:58:10.133

要将项目添加回服务器，

1.  右键单击您的 jar 项目并转到属性，单击 Java EE 模块依赖项。选中可用 Java EE 模块下的项目 jar 复选框。这将使项目恢复。
2.  现在右键单击您的服务器并尝试添加/删除项目。它将出现在左侧面板中以供选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-14T19:15:21.717

就我而言，解决方案是：

1-确保 web 项目已经运行了 Maven，以便在 Target 中有 .war。

2-右键单击 ear 项目，转到 Properties > Deployment Assembly。

3-单击“添加”按钮，从工作区中选择档案。单击添加，然后选择您的战争。

4-战争现在在部署大会列表中。

5-启动服务器。

# postgresql - postgreSQL for-each-row before-update 触发器：NEW 和 OLD 伪行

> ID：14491232
> 
> 赞同：0
> 
> 时间：2013-01-23T23:20:26.443
> 
> 标签：postgresql, triggers, postgresql-9.2

自动返回触发器的函数是否能够在为每一行指定的更新前触发器中引用 NEW 和 OLD 伪行？

```
 CREATE TRIGGER foo_trigger BEFORE UPDATE ON emp
    FOR EACH ROW EXECUTE PROCEDURE foo();

   CREATE FUNCTION foo() RETURNS trigger AS $foo_trigger$
    BEGIN  
        NEW.taxrate := 5.5;        
        RETURN NEW;
    END;
    $foo_trigger$ LANGUAGE plpgsql; 
```

`$....$`并且函数最后一行中的字符串必须与`$foo_trigger$ LANGUAGE plpgsql;`CREATE TRIGGER 语句中的触发器名称完全匹配，还是只是一个占位符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:28:34.573

> *自动能够在为每一行指定的更新前触发器中引用 NEW 和 OLD 伪行*

是的。

引用手册[http://www.postgresql.org/docs/current/static/plpgsql-trigger.html](http://www.postgresql.org/docs/current/static/plpgsql-trigger.html)

> *当 PL/pgSQL 函数作为触发器调用时，会在顶层块中自动创建几个特殊变量。*

> *字符串 [...] 必须与 CREATE TRIGGER 语句中的触发器名称完全匹配，还是只是一个占位符*

不。

这个`$..$`东西被称为“美元引用”，它只是简单地替换单引号以使处理大字符串（带有嵌入式引号）更容易。唯一的要求是您在开始和结束时使用相同的“密钥”。你可以使用`$body$`（这很常见）或任何你喜欢的东西。

有关详细信息，请参阅手册：[http ://www.postgresql.org/docs/current/static/sql-syntax-lexical.html#SQL-SYNTAX-DOLLAR-QUOTING](http://www.postgresql.org/docs/current/static/sql-syntax-lexical.html#SQL-SYNTAX-DOLLAR-QUOTING)

# emacs - 带有 Emacs 和 Hunspell 的英国 LaTeX 文件

> ID：14491235
> 
> 赞同：1
> 
> 时间：2013-01-23T23:20:33.623
> 
> 标签：emacs, latex, hunspell, ispell

我在 Emacs 中使用 Hunspell。在我的 init.el 中，我将字典列表设置如下：

```
(setq ispell-local-dictionary-alist
      '(
        (nil       "[A-Za-z]" "[^A-Za-z]" "" nil ("-d" "en_US") nil utf-8)
        ("english" "[A-Za-z]" "[^A-Za-z]" "" nil ("-d" "en_GB") nil utf-8))) 
```

如果我拼写检查这个 TeX 文件：

```
\documentclass {paper}

\begin{document}
The word i.e. and contracted words aren't accepted. 
\end{document}

% Local IspellDict: english
# LocalWords: 
```

单词“ie”和“不是”无法识别，因为每个单词都包含点或单引号。`OTHERCHARS`在字典列表中设置为`"['.]"`没有帮助。

无论如何，如果我将字典“en_GB”更改为“en_US”，它就可以工作。

所以看来问题出在我的字典里。我从以下链接下载了它：
[http](http://en-gb.pyxidium.co.uk/dictionary/en_GB.zip) ://en-gb.pyxidium.co.uk/dictionary/en_GB.zip 在网站上找到： [http](http://wiki.openoffice.org/wiki/Dictionaries) ://wiki.openoffice.org/wiki/Dictionaries 。

# java - 带列的 Java 树

> ID：14491237
> 
> 赞同：2
> 
> 时间：2013-01-23T23:21:06.340
> 
> 标签：java, swing, jtree, multiple-columns

我有一个创建 java 树的任务，它包含三列：运动名称、运动类别中的运动计数和上次更新。下图显示了类似的东西：

![JTree的设计](../Images/4a18c111bfed61776d8a0f72f9daedb8.png)

如您所见，有 4 种运动：水上运动、球类运动、天空运动、舞蹈运动。当我扩展天空时，有 3 种类似的运动。

但是如何制作专栏。我可以用节点和东西制作 JTree，但是如何添加列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T12:25:17.210

听起来您想要一个像树一样*扩展*但具有像表格一样的*行和列的视图。*考虑，[这里](https://codereview.stackexchange.com/a/4447/6692)[`Outline`](http://bits.netbeans.org/dev/javadoc/org-netbeans-swing-outline/org/netbeans/swing/outline/Outline.html)引用。

![图片](../Images/7c1220f9da6f43a6289eb3845f86da6a.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T07:32:23.983

[这](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/SWTTreeWithMulticolumns.htm)是使用`Tree`多列的一个很好的例子。它看起来像这样：

![在此处输入图像描述](../Images/c72b626ddea4d671723b0c5990cb05bd.png)

但是，我建议使用 JFace [`TreeViewer`](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fjface%2Fviewers%2FTreeViewer.html)。[这里](http://www.eclipse.org/articles/Article-TreeViewer/TreeViewerArticle.htm)和[这里](http://www.vogella.com/articles/EclipseJFaceTree/article.html)都有很好的教程。

# function - VBA Excel 2010 函数进行单元格计算，然后使用不同的范围求和

> ID：14491242
> 
> 赞同：0
> 
> 时间：2013-01-23T23:21:17.883
> 
> 标签：function, excel, for-loop, excel-2010, vba

我正在尝试编写一个函数，该函数将通过对相邻单元格范围内不同数量的树木直径的各个计算求和来确定单元格中的总基底面积（以平方英尺为单位）。

我是 VBA 新手，我不断收到错误，我似乎无法在网上找到示例和答案。我的电子表格单元格使用它只是在单元格中返回一个#VALUE。

```
Function BArange(x As Range)
    Dim BArangeTot As Double
    BArangeTot = 0

    Dim y As Integer
    y = x.Count

    Dim BArangei As Integer
    BArangei = 0

    For i = 1 To y
        BArangei = 0.005454154 * x(1, i) ^ 2
        BArangeTot = BArangeTot + BArangei
    Next i

    Return

    MsgBox (BArangeTot)

End Function

Function BA(x As Double)
    BA = 0.005454154 * x ^ 2
End Function 
```

为了描述一个站点的树冠占用率，我们通常在电子表格中计算 4.5 英尺高的树木的横截面积，我们还需要总结多棵树干的树木。每英亩基础面积的平方英尺数是衡量场地密度/占用率的非常标准的指标。我认为定义一个我们可以使用的函数会很方便。

我已经为此花费了几个小时并尝试使用 Set 命令来启动我的变量，但我认为只有当它们是对象时才需要这样做。我已经尝试注释掉行并将程序运行到程序中的光标点，但是我没有得到任何可以作为类似示例答案查找的内容。我最近遇到的问题是它需要子、函数或属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T03:12:22.433

您可以将其作为标准 Excel 公式执行。

如果您的数据在`A1:A10`

`=SUMPRODUCT(A1:A10,A1:A10)*0.005454154`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:32:27.643

我建议进行一些更正：

1.  如果`x`是 a `Range`，如果你想读取单元格的值，你需要这样写：

    ```
    x.Cells(1,i) 
    ```

    或者

    ```
    x.Cells(1,i).Value 
    ```

    （我更喜欢第二种选择）

2.  如果要返回一个值，则需要对函数名进行赋值：

    ```
    BArange = BArangeTot 
    ```

3.  另外，我推断您的范围是一列，因此我将按`y`如下方式分配变量：

    ```
    y = x.Rows.Count 
    ```

4.  最后，删除`Return`.

希望这可以帮助你

# java - 无法理解 java 项目/IntelliJ 中外部库的使用

> ID：14491244
> 
> 赞同：1
> 
> 时间：2013-01-23T23:21:27.237
> 
> 标签：java, module, intellij-idea, classpath, libraries

现在我学到了更多，我可以问一个更直接的问题。

场景：我有一个 Java 项目`IntelliJ Idea`，最终目标是制作一个能够在 Windows 或 Linux 上运行的独立 .jar，可以从命令行运行，也可以`java -jar jarname.jar`像任何普通的简单 jar 一样通过双击运行。

我写了一些类，位于我的`src/package/name`目录中。但是，我的一个类需要使用外部类，即一个不在我的源目录中的类，或者不是 Java 的默认`.jar`'s集的一部分`JDK`。

如何进行配置`IntelliJ`以构建`.jar`工件并在其中包含必要的资源，并将所需的所有内容放在适当的位置，以便*我的*班级可以通过普通`import`语句使用资源？以示例形式给出的答案会很棒；我几乎想通了，但一定只有一件事我做得不对。

谢谢你的时间，

洋基队

> 资料来源：
> 
> [http://tukaani.org/xz/java.html](http://tukaani.org/xz/java.html)
> 
> 查看该源的目录结构可以更好地了解：
> 
> [http://git.tukaani.org/?p=xz-java.git;a=tree](http://git.tukaani.org/?p=xz-java.git;a=tree)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T06:56:09.990

# 人们不会简单地将魔多打包到他们的罐子里。

经过大量实验，我找到了一个解决方案，虽然可能不是正确的方法，但绝对有效。关键是：

1.  将您的外部库（在我的情况下为 .jar）定义为模块依赖项。

2.  将您的外部资源添加为（IntelliJ 称之为）“提取目录”。

对于第一项，转到文件 -> 项目结构。单击左侧“项目设置”列表中的“模块”。在右侧的列表中，您将看到属于您的项目的模块列表（无论它们是什么）。不要管它，但要确保它被突出显示/选择为当前模块。您想要的是该模块的设置，它将显示在右侧的窗口中。转到“依赖项”选项卡。屏幕的最右侧将是一个绿色的小加号。单击它，选择“罐子或目录”并导航到您想要与完成的罐子一起带来的相关资源。

### 注意：不要被“导出”复选框所迷惑。它的唯一目的是造成无尽的痛苦和折磨，因为您想知道为什么依赖项没有与您的 jar 一起导出。永远记住，导出框试图让你点击它。它*想*被勾选：3

接下来，通过转到文件 -> 项目结构将该资源添加为提取的目录。然后是左侧Project Settings列表中的“Artifacts”。单击顶部的绿色加号以创建一个新的“Jar”工件“来自具有依赖项的模块”。在右侧窗口的“输出布局”选项卡下，单击绿色的小加号并选择“提取目录”。再次浏览到您珍贵的罐子。

您现在应该能够成功构建一个 jar 工件，其中包含在您设计它时运行所需的所有资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T07:39:05.767

这是关于将外部库配置为模块依赖项的参考部分 -[链接](http://www.jetbrains.com/idea/webhelp/configuring-module-dependencies-and-libraries.html)。关于工件构造 - 可以精确指定其内容（包括依赖库内容） -[链接](http://www.jetbrains.com/idea/webhelp/configuring-artifacts.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T00:12:57.107

阅读[如何找到课程...](http://docs.oracle.com/javase/6/docs/technotes/tools/findingclasses.html)

可以（希望您）将您的程序放在您自己的 jar 中，并将依赖的“库”作为单独的 jar

您应该提供一种使用 java 命令的正确 -classpath 参数运行程序的方法，以便 java 可以找到您的 jar 和依赖的 jar……有多种方法可以做到这一点……请参阅链接多于。

罗尔夫

# android - 如何从 Android 上的 VideoView 中播放的 RTSP 流中消除延迟

> ID：14491245
> 
> 赞同：2
> 
> 时间：2013-01-23T23:21:35.727
> 
> 标签：android, android-videoview, rtsp, vlc, lag

我的目标是让计算机将视频从 USB 网络摄像头传输到我自己的 Android 应用程序。

在 PC 上，我正在运行 VLC，它通过端口 8554 上的 RTSP 流式传输捕获设备（网络摄像头），具有以下设置：

```
Video Codec: H.264
Video Resolution: 1600x1200 x 0.25= 400 x 300 px
Video Frame Rate: 12 fps
Video Bitrate: 56 Kbps
and NO audio 
```

我选择了非常低的设置来查看它是否会改善延迟，但对延迟几乎没有影响。这是生成的输出流字符串 VLC 给我：

```
:sout=#transcode{vcodec=h264,vb=56,fps=12,scale=0.25,acodec=none}:rtp{sdp=rtsp://:8554/} :sout-keep 
```

在 onCreate 方法的 android 端，我有：

```
String url = "rtsp://192.168.1.103:8554/";
vid = (VideoView) findViewById(R.id.videoView1);
mc = new MediaController(this);
vid.setMediaController(mc);
vid.setVideoURI(Uri.parse(url));
vid.requestFocus();
vid.setOnPreparedListener(new OnPreparedListener(){
    @Override
    public void onPrepared(MediaPlayer mp) {
        // TODO Auto-generated method stub
        vid.start();
    }
}); 
```

结果：

当应用程序加载时，VideoView 全黑大约 10-20 秒，同时在 LogCat 中弹出两条消息：

```
Tag             Text
MediaPlayer     Couldn't open file on client side, trying server side
MediaPlayer     getMetadata 
```

视频显示后，会有大约 20 秒的延迟，大约 30-60 秒后，视频仍然冻结。一旦视频开始播放，这些消息也会出现：

```
Tag             Text
MediaPlayer     info/warning (3, 0)
MediaPlayer     Info (3, 0) 
```

我还尝试使用 VLC 从同一网络上的另一台 PC 捕获流，似乎延迟仍然存在，但它永远不会冻结。不确定我是否应该使用不同的 RTSP 服务器，例如 Darwin？使用不同的协议，HTTP 或 RTP？或者是否需要在 android 端进行更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T20:39:34.107

尝试来自 VLC 的 http 流。转码时您永远无法消除所有延迟，但应该能够将其降低到 < 10 秒。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-09-25T20:06:13.737

我不确定您是否可以使用`VideoView`. Android 的 RTSP 支持似乎很弱：当我尝试播放 VLC 生成的视频流时，我不断收到“不支持的格式”错误，即使 VLC（和其他播放器）可以很好地处理流。

当我们尝试 http 流时，我们得到了惊人的 90 秒延迟！

最后，我编写了自己的最小 RTSP 客户端，并将 H264 数据包直接传递给[`MediaCodec`](http://developer.android.com/reference/android/media/MediaCodec.html). 这需要“相当”数量的代码（3200 多行）并且“相当”困难，但延迟远低于一秒。（这是使用在硬件中进行 H264 编码的相机；软件编码器可能会施加更高的最小延迟。）

# java - ESB 可以模仿数据库存储过程并将请求传递给 Web 服务吗？

> ID：14491250
> 
> 赞同：1
> 
> 时间：2013-01-23T23:22:17.660
> 
> 标签：java, stored-procedures, esb, mule, spring-integration

我有一个可以调用存储过程但不能调用网络服务的旧系统。此存储过程中的业务逻辑正在迁移到 Web 服务中。是否有任何 ESB 适配器可以模拟数据库并以存储的 proc 输入变量的形式接受输入，然后转身调用 Web 服务？Web 服务返回结果后，需要将答案映射到结果集和/或输出变量中并发送回客户端。我更喜欢使用 Spring Integration 或 Mule 或其他一些基于 Java 的 ESB，但愿意考虑其他选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:34:18.870

如果遗留应用程序使用 JDBC，请使用[**p6spy**](http://sourceforge.net/projects/p6spy/)驱动程序拦截调用并将它们重定向到 Web 服务。

# asp.net - 在基于 PHP 的网站中嵌入 ASP.NET 网页

> ID：14491257
> 
> 赞同：-1
> 
> 时间：2013-01-23T23:23:05.630
> 
> 标签：asp.net, mvvm, asp.net-mvc-4, asp.net-web-api, embed

我们有集中的后台系统，我们保留所有产品信息，最近我们的客户要求我们为他们部署网站，以便他们可以在他们的网站上展示他们的产品，客户有他们自己的基于 php 或 java 或其他开发的网站，他们由于 iframe 中的一些 SEO 问题，不喜欢使用 iframe 来展示他们的产品，我们想在他们的网站内部署我们的电子商务网站，我们想在 div 等 HTML 标记中展示我们的网站，我们不喜欢为任何个人客户设计和开发新网站，我很想知道您的想法和任何替代解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T04:40:48.907

因此，我不会专注于开发可嵌入的网站，而是专注于以下两种方法之一：1）制作 Web 服务/REST API，2）编写 Javascript 库。

**制作 REST API**

您可以编写客户端可用于集成到其站点的 Web 服务（或 REST API）。这会将您的数据/服务/功能暴露给他们。当然，他们必须做一些编程才能与服务集成，但这是一种选择。

**编写一个 Javascript 库**

您可以编写一个 Javascript 库来动态引入数据（当然调用您托管的 Web 服务），然后您可以获取该数据并将它们放入 div 等。

这样做的好处是您可以告诉客户“只需将这 5 行代码放到您的页面上，剩下的就交给它了”。它对客户的进入门槛很低。

# xcode - ... 被拒绝为 '...' 的隐式依赖项，因为它的架构 'armv6 armv7' 不包含所有必需的架构 'armv7 armv7s'

> ID：14491258
> 
> 赞同：1
> 
> 时间：2013-01-23T23:23:10.650
> 
> 标签：xcode, cocos2d-iphone, xcode4.5, kobold2d

我正在尝试在发布模式下构建我的应用程序，但我不断收到这些警告，我似乎无法弄清楚如何修复它们。

```
chipmunk-ios was rejected as an implicit dependency for 'libchipmunk-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
cocos2d-extensions-ios was rejected as an implicit dependency for 'libcocos2d-extensions-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
kobold2d-ios was rejected as an implicit dependency for 'libkobold2d-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
chipmunk-spacemanager-ios was rejected as an implicit dependency for 'libchipmunk-spacemanager-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
cocos2d-ios was rejected as an implicit dependency for 'libcocos2d-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
box2d-ios was rejected as an implicit dependency for 'libbox2d-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
cocos3d-ios was rejected as an implicit dependency for 'libcocos3d-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
objectal-ios was rejected as an implicit dependency for 'libobjectal-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
cocosdenshion-ios was rejected as an implicit dependency for 'libcocosdenshion-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s'
sneakyinput-ios was rejected as an implicit dependency for 'libsneakyinput-ios.a' because its architectures 'armv6 armv7' didn't contain all required architectures 'armv7 armv7s' 
```

我正在使用 kobold2d 1.1.3 和 cocos2d cocos2d v1.1.0-beta2b 构建我的项目

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-12T02:31:34.873

尝试设置`Build active architecture only`为`NO`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-23T10:54:47.017

如果您有这些库（libchipmunk-ios.a、libcocos2d-extensions-ios.a、...），那么它们缺少架构 armv7s：请联系您的库源以获得额外的架构支持。

如果您从源代码构建这些库，那么您需要将每个子项目构建设置配置为以 $(ARCHS_STANDARD_32_BIT) 架构为目标，而不仅仅是旧的 armv6 和 armv7。

# sql-server-2008 - 在可执行 JAR 中时 sqljdbc4 连接失败

> ID：14491262
> 
> 赞同：1
> 
> 时间：2013-01-23T23:23:23.407
> 
> 标签：sql-server-2008, jdbc, executable-jar, sqljdbc

我有一个使用 sqljdbc4.jar 连接到 SQL Server 2008 数据库的 GUI 应用程序。如果我从命令行运行它，效果很好。

但是，一旦我将它包装到一个可执行的 JAR 中，我就会得到一个“没有为 jdbc:sqlserver://myServer:1433;databaseName=myDb 找到合适的驱动程序”错误。我知道我的 Windows 系统 CLASSPATH 一旦在 JAR 中就会被忽略，但我无法弄清楚在可执行 JAR 中包含 sqljdbc4.jar 并获得可移植应用程序。

我最近尝试解决这个问题如下：

我的 MANIFEST.MF 文件：

```
Manifest-Version: 1.0
Class-Path: lib/sqljdbc4.jar
Created-By: 1.7.0_11 (Oracle Corporation)
Main-Class: MyApp 
```

我用来编译 JAR 的命令：

```
jar cmf MANIFEST.MF MyApp.jar MyApp.class help.html lib 
```

我的目录结构如下。我`jar`在 MyApp 目录中运行命令。

```
+ MyApp
    + lib
        - sqljdbc.jar
    - help.html
    - MANIFEST.MF
    - MyApp.class
    - MyApp.java 
```

当我创建 JAR 并在 MyApp 目录中运行它时，它工作正常。一旦我将其从目录中拉出，我就会收到错误消息。如何让 JAR 访问内部可用的 sqljdbc.jar？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T12:55:17.967

当您`MyApp.jar`在 manifest.mf 中有一个带有条目的可执行 jar 时：

```
Class-Path: lib/sqljdbc4.jar 
```

这意味着 jar`sqljdbc4.jar`在 (relative) 文件夹中具有外部依赖关系`lib`。它不包含在您创建的 jar 中！因此，当您执行它时，您需要确保有一个`lib`包含相对于该 jar 的 -folder 。`sqljdbc4.jar`所以执行时的文件夹结构需要是；

```
+ (a folder)
   + lib
      - sqljdbc.jar
   - MyApp.jar 
```

# c# - 如何确定当前数据上下文中是否存在实体？

> ID：14491265
> 
> 赞同：0
> 
> 时间：2013-01-23T23:23:42.520
> 
> 标签：c#, linq, linq-to-sql

例如，假设我正在创建或获取一些稍后计划插入、更新或丢弃的实体：

```
foreach (var foo in foos) {
    if (foo.condition)
        _myEntityCollection.Add(new Some_Entity_Type());
    else
        _myEntityCollection.Add(dc.Some_Entity_Types
          .Where(t => t.ID == someID).FirstOrDefault());
} 
```

当需要恢复时，我可以这样做：

```
// Exception gets thrown here if entity didn't exist in data context
_myEntityCollection.ForEach(t => dc.Refresh(RefreshMode.OverwriteCurrentValues, t)); 
```

我希望能够遍历`_myEntityCollection`并确定该实体是我获取的实体，还是新实体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:29:56.910

您可以使用对象状态管理器来测试对象上下文是否知道特定实体。

```
var objectStateManager = context.ObjectStateManager;

ObjectStateEntry temp;
var result = objectStateManager.TryGetObjectStateEntry(myEntity, out temp); 
```

*更新*

上面的代码适用于实体框架，但问题涉及 LINQ to SQL。您可以尝试检查[`ChangeSet`](http://msdn.microsoft.com/en-us/library/system.data.linq.changeset.aspx)返回的[`DataContext.GetChangeSet()`](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.getchangeset.aspx). 它包含三个用于添加、删除和更新实体的列表。

# parsing - 在编译之前向 Haskell 函数添加额外的参数

> ID：14491266
> 
> 赞同：1
> 
> 时间：2013-01-23T23:23:42.513
> 
> 标签：parsing, haskell, preprocessor, metaprogramming

作为将用户输入的字符串动态加载为 Haskell 源代码的程序的一部分，我想在编译之前对用户的输入进行一些预处理。

我想做的一件事是搜索特定函数出现的源并为它们添加一个额外的参数。因此，例如，我可能想要所有出现的：

```
addThreeNumbers 3 5 
```

成为：

```
addThreeNumbers 3 5 10 
```

完成这种行为的最佳方法是什么？是否足够复杂以保证使用 GHC API / Template Haskell 中的函数来操作某种抽象语法树？或者这是否可以通过某种 Haskell 预处理/解析库来完成？如果是这样，您会推荐哪些图书馆和资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:34:08.250

Ghc 7.6[限定导入](http://www.haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#package-imports)、ghc-pkg hide 和 ghc 的 -package 选项允许您在导入文件和导入文件之间无缝添加一层。

例子：

使用您自己的 Data.Char 创建一个包，使用标准 .cabal 文件和 cabal 安装。

```
{-# language PackageImports #-}                                                  

module Data.Char (                                                               
      toUpper                                                                    
    , Char                                                                       

    , String                                                                     
    -- ...  Export every else from "Base" Data char because the limitation of
    --     the current export facility you can not use
    --     module Data.Char hiding (toUpper)
    ) where                                                                      

import "base" Data.Char hiding (toUpper)                                         
import qualified "base" Data.Char as OldChar                                     

toUpper :: Char -> IO Char                                                       
toUpper c = do                                                                   
    print "Oh Yeahhhhhhhhh"                                                      
    return $ OldChar.toUpper c 
```

隐藏基本包`ghc-pkg hide base`——在这种情况下隐藏了许多模块，如果需要，您需要将它们全部包装起来。

```
> ghci -XNoImplicitPrelude --  We need language flag because the Prelude is in
                           -- base and I did not make a wrapped Prelude
ghci> import Data.Char
ghci> toUpper 'c'  -- The wrapped function
"Oh Yeahhhhhhhhh"
'C'
ghci> isSpace ' '  -- The unwrapped normal Data.Char function
True 
```

现在您可以使用模板 Haskell 来包装您的函数并调用您需要获取外部信息的任何 IO 操作。用户甚至不需要更改任何函数调用或模块导入，只需在名称中添加“内部”即可。

能够无缝地封装模块接口还意味着您可以更改导入模块的植入，而无需接触包/模块代码或您正在使用的现有代码库；你只需要做一个中间层。

编辑对问题的回复：

当然可以，ghc-api 可以让您完成所有这些工作，但是要复杂得多，比我想要的例子更少，而且我似乎看到更多人在使用它时遇到困难，然后是成功案例。

*   用于评估代码[提示](http://hackage.haskell.org/package/hint)
*   [建议使用插件](http://hackage.haskell.org/package/plugins)来动态加载模块
*   haskell-src-ext 建议用于解析和更改代码。这就是[style-haskell](http://hackage.haskell.org/package/stylish-haskell)用来对代码进行小修改的方法，是你最好的选择。据报道，它涵盖了 Haskell 2010 的大部分（全部？），以及许多但不是所有 GHC 扩展，如果您不喜欢我提供的第一个解决方案，它可能是您最好的选择。

据我所知，GHC-API 是唯一一个与 GHC 兼容代码完全兼容的代码，但要复杂得多，文档记录较少，而且更有可能从 GHC 版本更改为 GHC 版本，或者至少没有承诺会根据我有限的经验，是一样的。我建议将一个模块放在中间，因为它似乎是最快的获得良好的测试覆盖率，需要最少的新知识并满足我从你的问题中挑选出来的要求。

# asp.net - 本地主机与开发服务器上 IE8 的奇怪显示行为

> ID：14491268
> 
> 赞同：0
> 
> 时间：2013-01-23T23:23:59.150
> 
> 标签：asp.net, html, css, internet-explorer

刚刚创建了一个站点，使用标准的 html/css - 没什么特别的。只需 div 即可创建框架外观。服务器代码是 asp.net (4.0)。

当我从 Visual Studio 2012 本地调试程序时，页面看起来与我在所有浏览器（ie8/ff/chrome）中设计的完全一样。当我将它发布到我的开发服务器并在 IE8 中打开它时，布局混乱（即，我的登录框现在位于页面底部而不是中心）。但是，如果我在开发服务器上使用 firefox 或 chrome 打开同一页面，它看起来是正确的。

我试过删除所有文件并重新发布。我查看了工作（本地主机）和损坏（开发服务器）背后的源代码，它是相同的。

我可以尝试任何想法或其他故障排除步骤吗？

谢谢。

编辑：
屏幕截图：http: [//i.imgur.com/tNiIFCz.png](http://i.imgur.com/tNiIFCz.png)（并排 dev 与 localhost）

母版页：http : [//pastebin.com/c94Pinih](http://pastebin.com/c94Pinih)

CSS：http : [//pastebin.com/Txtac3kw](http://pastebin.com/Txtac3kw)

登录页面：（IE8中乱码的页面）： http: [//pastebin.com/BN5bBamP](http://pastebin.com/BN5bBamP)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:48:48.473

你可以试试：

*   确保您的所有资源都正确加载（IE8 可以做到这一点，但其他工具可用）
*   验证 HTML/CSS
*   在本地与生产中检查您的渲染模式。如果这是问题所在，您可能可以使用 X-UA-Compatible 元标记来强制使用特定版本的 IE 渲染引擎。
*   检查任何页面/脚本错误
*   在本地查看时检查生产中的源是否与源匹配
*   检查 IIS 之间的差异

同样通过“标准 html/css”，我假设这是 HTML4/CSS2？你有链接可以查看吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T17:51:29.337

删除了顶级 div 并且它起作用了。仍然不确定为什么它在本地机器上的 ie8 中工作，而不是在开发机器上工作。

# c - afplay 错误：AudioFileOpen 失败 (-43)

> ID：14491271
> 
> 赞同：0
> 
> 时间：2013-01-23T23:24:18.927
> 
> 标签：c

代码：

```
#include<stdio.h>
#include<string.h>

int main (int argc, char *argv[]) {
    char folderPath[1024];
    int i = 0;
    for (i; i < (strlen(argv[0]) - 7); i++) {
        folderPath[i] = argv[0][i];
    }
    printf("Command: afplay %ssong.mp3\n", folderPath);
    system("afplay %ssong.mp3", folderPath);
    return 0;
} 
```

所有输出：

```
Command: afplay /Users/carloabelli/Desktop/FUNNY/song.mp3
Error: AudioFileOpen failed (-43) 
```

当我从终端运行命令时，它运行良好。我想知道出了什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:29:36.847

`system()`不使用格式字符串。它将整个命令作为文字字符串。用于`sprintf()`将您的命令格式化为缓冲区，然后将该缓冲区发送到系统。

```
char buf[1024];
snprintf(buf, 1024, "afplay %ssong.mp3", folderPath);
system(buf); 
```

或类似的东西。

# php - Yii 上的 Zii 小部件 - JqueryUI 版本

> ID：14491274
> 
> 赞同：0
> 
> 时间：2013-01-23T23:24:48.553
> 
> 标签：php, jquery, jquery-ui, yii, yii-extensions

我最近才开始玩 Yii 框架。然而，我对 Zii Widgets 感到困惑。我知道 Zii 小部件使用 jquery UI 来实现其功能。查看文件，我发现 jquery ui 1.9.2 包含在框架中。由于最近 jquery ui 整体发生了重大变化，我想知道我是否使用最新版本的 jquery UI，这会破坏 zii 小部件的功能。无论如何使用带有 jquery ui 1.10 的 Zii 小部件并以某种方式禁用框架附带的默认 jquery ui？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:29:51.173

这个问题太笼统了，这取决于 Jquery UI 小部件的变化，一些 Zii 小部件可能工作，有些可能不行。如果您**不需要**最新版本的 Jquery UI 并想使用 Zii 小部件，请坚持使用包含的版本并处理它。

# xcode - 无法从第二个 Viewcontroller Ctrl+拖入 ViewController.h

> ID：14491275
> 
> 赞同：1
> 
> 时间：2013-01-23T23:24:51.173
> 
> 标签：xcode, interface-builder

我正在构建一个有趣的 iOS 应用程序，这就是我遇到麻烦的地方。我可以通过 ctrl+drag 方法直接从我的第一个 View Controller 在 ViewController.h 文件中插入插座和操作；但是，当我在第二个 ViewController 上尝试 ctrl+drag 时，它不会允许我。

Ctrl+拖动第一个 ViewController

![](../Images/89c05bd45c26cb0d520c1ba87d95bc4e.png)

Ctrl+拖动第二个 ViewController

![](../Images/d3778f997e5ed6dd7d77d2322fa45c1f.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:30:51.250

您在助理编辑器中打开了错误的文档。它应该是 ViewController.h，但您正在显示 UIViewController.h。

检查您是否已使用 Identity Inspector（右侧实用程序面板的第三个）正确地将您的第二个视图控制器设置为您的自定义类 ViewController，然后确保它的头文件是您在右侧显示的文档。

*更新*

根据您的评论，您很难将第二个视图控制器设置为自定义类。

这是您在情节提要中选择它的方法。请注意，您选择的是*View Controller*，而不是最顶层的*View*

![在此处输入图像描述](../Images/4ed5cb654d87ac43196f349e89da262b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-04T00:18:47.057

将课程复制并粘贴到“课程”字段中。然后您需要按 ENTER 才能生效。[例子](http://i.stack.imgur.com/R2MnR.png)

# c# - 在对象设置器中处理空对象

> ID：14491276
> 
> 赞同：2
> 
> 时间：2013-01-23T23:24:53.517
> 
> 标签：c#

我正在尝试使用一个不错的近对象设置器，但有空问题。

我现在的代码：

```
var Result = new RefundReplyObject
{
    AuthorisationNumber = reply.refundResponse.transactionDetails.authorisationNumber,
    ChargeValue = reply.refundResponse.transactionDetails.totalAmount.amount, 
    Message = reply.refundResponse.transactionDetails.message,
    ReconciliationReference = reply.refundResponse.transactionDetails.reconciliationReference,
    SettlementDate = reply.refundResponse.transactionDetails.settlementDate,
    Status = TransactionStatusToLocalModel(reply.refundResponse.transactionDetails.status),
    TransactionReference = reply.refundResponse.transactionDetails.transactionReference
}; 
```

但是...“totalAmount”可能为空。所以，我得到错误。

有没有一种巧妙的方法来处理这个问题，如果“totalAmount”为空，那么将chargevalue设置为零？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:28:02.067

三元运算符如何检查总金额是否为空。如果不是，则使用 it's `amount`，否则为 0。

```
ChargeValue = (reply.refundResponse.transactionDetails.totalAmount != null) ? reply.refundResponse.transactionDetails.totalAmount.amount : 0, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:27:54.840

你可以这样做，例如：

```
ChargeValue = reply.refundResponse.transactionDetails.totalAmount != null ? reply.refundResponse.transactionDetails.totalAmount.amount : 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T23:29:13.240

三元运算符来救援！

`ChargeValue = totalAmount ? totalAmount.amount : 0;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T23:27:58.670

像这样的东西？

```
ChargeValue = (null == reply.refundResponse.transactionDetails.totalAmount) 
    ? 0
    : reply.refundResponse.transactionDetails.totalAmount.amount 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T23:30:11.480

您将无法在事情的二传手方面做到这一点，因为在您到达那里之前就发生了异常。您可以通过执行以下操作来获得您所追求的（并在此过程中大量清理您的代码）：

```
var trans = reply.refundResponse.transactionDetails;

var Result = new RefundReplyObject
{
    AuthorisationNumber = trans.authorisationNumber,
    ChargeValue = trans.totalAmount == null ? 0 : trans.totalAmount.amount, 
    Message = trans.message,
    ReconciliationReference = trans.reconciliationReference,
    SettlementDate = trans.settlementDate,
    Status = TransactionStatusToLocalModeltrans.status),
    TransactionReference = trans.transactionReference
}; 
```

# spring - Spring & 静态内容 (css, js)

> ID：14491279
> 
> 赞同：1
> 
> 时间：2013-01-23T23:25:03.587
> 
> 标签：spring, model-view-controller, static-content

我想创建一个简单的应用程序，它将使用 css 和 js。但我无法达到那个静态内容......我找到了一些解决方案，但我无法为我的解决方案修改它们:(

有人会这么好心并且可以显示一些明确的解决方案（在哪里添加/修改某些东西以及究竟要添加/修改什么）？

我在导航器中的应用程序结构：http: [//i.nahraj.to/f/gNc.jpg](http://i.nahraj.to/f/gNc.jpg)

web.xml 和 servlet-context.xml 的内容[http://pastebin.com/fVcNZPst](http://pastebin.com/fVcNZPst)

我在 tomcat 服务器上运行我的应用程序。

home.jsp 页面是正确的，因为当我将其重写为 home.html 并通过 Web 浏览器打开时，它显示正确。我真的很感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:12:29.163

你的结构有几个问题：

一个。你已经把`<resources mapping="/resources/**" location="/resources/" />`你的资源映射了，这会将任何以uri开头的东西映射`/resources/`到你的webapp下的位置，在你的结构中`src/main/webapp/resources`，你没有那个文件夹。

湾。如果您希望您的文件从`webapp/css`, `webapp/img`,`webapp/js`可用，您可以将它们移动到`src/main/webapp/resources`文件夹中并使用`/resources/js/test.js`uri 访问它们，或者只需将此条目也放入您的 servlet-context.xml 文件`<mvc:default-servlet-handler />`中 - 如果您有兴趣，我[在这里提供了更多详细信息](http://www.java-allandsundry.com/2012/10/spring-mvc-static-resource-handling.html)

# php - 与 Core Data SQLite 文件交互的 Web 服务器代码？

> ID：14491280
> 
> 赞同：0
> 
> 时间：2013-01-23T23:25:05.203
> 
> 标签：php, iphone, ios, sqlite, core-data

我正在构建一项服务，用户将我的应用程序与网站集成。部分原因是他们将上传他们的核心数据数据库。是否有工具包或库（最好是 PHP）可以读取 Core Data sqlite 并操作它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:41:41.753

如果它是 SQLite，那么任何 SQLite 客户端都应该能够 - rDBMS 系统的全部意义在于模式由数据库描述，因此它包含 Apple Core Data 模型的事实是无关紧要的。您已将其标记为[PHP](http://php.net/manual/en/book.sqlite.php)，当您尝试使用 PHP 访问它时发生了什么？

# python - Django 子域

> ID：14491284
> 
> 赞同：7
> 
> 时间：2013-01-23T23:25:18.637
> 
> 标签：python, django, e-commerce

我正在尝试制作一个基本的商店应用程序。我已经建立了一个数据库，以便每个产品都与一个特定的商店相关联：让我们称商店为鞋、玩具和书籍。我需要为应用程序设置子域（它在分配规范中，没有选择）这样我就可以映射到 shoes.myapp.com、toys.myapp.com 和 books.myapp.com。我*认为*我需要做的是以某种方式设置子域（我已经用谷歌搜索过但很困惑：[这是要走的路吗？](http://thingsilearned.com/2009/01/05/using-subdomains-in-django/)）然后，我想，从子域中的信息中过滤我的数据库，这样只有例如，商店名称为“Shoes”的产品会出现在页面上。我是否正在接近正确的轨道，还是有更好的方法来构建它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:21:54.850

我建议你使用这个应用程序：django-subdomains。[http://django-subdomains.readthedocs.org/en/latest/index.html](http://django-subdomains.readthedocs.org/en/latest/index.html)

然后，在您的 settings.py 中，您应该使用：

```
SUBDOMAIN_URLCONF = {
    'toys': 'yourproject.urls.toys',
    'shoes': 'yourproject.urls.shoes'
(...)
} 
```

如果您需要在视图中使用子域的名称，它将附加到请求对象：

```
def your_view(request):
    subdomain = request.subdomain
    products = Products.objects.filter(store=subdomain) #an example how to use it to specif database queries. I dont know how your models are 
```

# javascript - 格式化灯箱中的数据标题

> ID：14491286
> 
> 赞同：1
> 
> 时间：2013-01-23T23:25:27.397
> 
> 标签：javascript, jquery, jquery-plugins, lightbox

如何格式化数据标题我计划在单击立方体灯箱打开后为单个图像显示三个不同的名称，标题带有 div 标签，但我想在灯箱上一一显示

没有灯箱它工作正常

```
$data = '';
$('[data-caption]').each(function(){
    $data += '<div>' + $(this).data('caption') + '</div>';
});
$('body').append('<div id="more-info">' + $data + '</div>'); 
```

[http://jsfiddle.net/ZrpLT/52/](http://jsfiddle.net/ZrpLT/52/)

```
 <body>
            <div class="row">
                <div class="span10">
                    <div class="melonhtml5_gallery">
                        <div data-caption="<div>Paul Scholes</div> <div>Wayne Rooney</div> <div>Sir Alex Ferguson</div>" data-image="http://www.defie.co/designerImages/thumbnails/inventory.png"></div>

                </div>
            </div>
    </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:31:16.727

[http://jsfiddle.net/ZrpLT/63/](http://jsfiddle.net/ZrpLT/63/)

这需要更新`Gallery`要使用的类，`.html`而不是`.text`专门在`onClick`函数中附加标题时就行了：

```
var m = $("<div>").addClass("caption").html(g ? g : ""), 
```

只要你能够做到这一点，你就可以让它为你工作。

# php - 自动创建magento媒体文件夹

> ID：14491288
> 
> 赞同：0
> 
> 时间：2013-01-23T23:25:34.760
> 
> 标签：php, magento

如何阻止 magento 自动创建媒体文件夹？我有一个包含所有要使用的正确文件的媒体文件夹，但是当我重命名当前媒体文件夹时，它会自动重新创建；这是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:32:49.857

有一次，我陷入了同样的境地，对我有用的是..

*   删除`app/etc/local.xml`
*   上传您的`Media`文件夹
*   重新运行安装向导

大约一个月前它对我有用，我的版本是 Mag EE-1.12

希望这可以帮助

# javascript - 正则表达式获取由“=”分隔的字段

> ID：14491295
> 
> 赞同：0
> 
> 时间：2013-01-23T23:25:57.237
> 
> 标签：javascript, jquery, regex, json

我正在`$.getJSON`检索一些数据，它给了我以下信息：

```
address = 1233 Abc St
address2 = Suite 123
city = San Francisco
state = CA
zip = 12345 
```

我理想情况下想要的是把它分解成一个数组，比如：

```
array['address'] = "1233 Abc St"
array['address2'] = "Suite 123"
... 
```

这似乎是简单的正则表达式，但我无法完全理解它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T23:30:06.453

这更容易通过迭代完成：

```
var lines = source.split("\n"), l = lines.length, i, out = {}, line;
for(i=0; i<l; i++) {
    line = lines[i].split(/\s+=\s+/);
    out[line[0]] = line[1];
} 
```

# eclipse - Eclipse Javadoc 无法正确呈现

> ID：14491296
> 
> 赞同：3
> 
> 时间：2013-01-23T23:26:01.010
> 
> 标签：eclipse, javadoc

我目前正在尝试在 Ubuntu 12.10 中设置我的工作环境，而我目前对 Eclipse 中的 Javadoc 样式感到迷茫。Javadoc 透视图中显示的工具提示和 Javadoc 根本没有正确呈现 HTML。这是在我的 Eclipse 的 Windows 7 安装中的样子： ![Javadoc 透视 Win7](../Images/bf543027f18056aacc7d50b31a1d04a1.png)

在 Ubuntu 上，它看起来完全损坏并且无法正确呈现任何内容，当 Javadoc 中包含大量文本、代码或其他内容时，这尤其令人分心： ![Javadoc 透视 Ubuntu](../Images/77d5255f827d8e1ff417ed7a03a475ca.png)

以前有没有人遇到过这种问题，或者可能能够提供其他帮助？注意：我还稍微更改了我的 gtkrc 以更改工具提示的颜色，因为它曾经只是黑色背景上的非常暗的文本，但这应该只改变了一般的字体和背景颜色，而不是 HTML 的呈现。

我刚刚发现了这个非常相关的问题： [Eclipse is formatting javadoc tooltips very bad on Ubuntu](https://stackoverflow.com/questions/12926774/eclipse-is-formatting-javadoc-tooltips-very-poorly-on-ubuntu?rq=1)

但是，没有人能够回答提出问题的人

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:44:41.027

有同样的问题 - 解决方案很简单：安装默认 ubuntu 存储库中可用的 libwebkitgtk-1.0-0 包。

（如果您不使用 Ubuntu，请了解如何在您的发行版中调用该组件以及如何安装它）

# jsf-2 - 将选项卡动态添加到丰富：tabPanel

> ID：14491297
> 
> 赞同：1
> 
> 时间：2013-01-23T23:26:02.847
> 
> 标签：jsf-2, richfaces

我正在开发我的第一个 jsf2 Richfaces 应用程序，现在我面临以下问题：

我有以下菜单

```
<rich:panelMenu >
            <rich:panelMenuGroup >
                 <rich:panelMenuItem label="Users" name="Users " />
                 <rich:panelMenuItem label="Orders" name="Orders"  />
            </rich:panelMenuGroup>

</rich:panelMenu> 
```

我希望在单击 panelMenuItem 时创建一个新选项卡，并且在此新选项卡中必须插入一个包含我的应用程序的所有用户的表

我看到了一些这种类型的例子

```
 <rich:tabPanel switchType="client" id="tabPanel">
    <c:forEach items="#{handlerTab.tabsName}" var="tabName">
        <rich:tab name = ... >

    </rich:tab>
</c:foreach> 
```

但不知道在我的新标签中插入表格

我能怎么做？

* * *

坦克供您回复，但我不想在视图中声明所有选项卡，我想动态添加和删除选项卡，现在我已经设法做到了

```
 <rich:panelMenu >
 <rich:panelMenuGroup >
     <rich:panelMenuItem label="Users" name="Users"  action="#{tabsBean.createTabs()}" render="tabs" />
     <rich:panelMenuItem label="Orders" name="Orders"  action="#{tabsBean.createTabs()}" render="tabs" />
 </rich:panelMenuGroup> 
```

```
<h:panelGrid id="tabs" binding="#{tabsBean.panelGrid}"/> 
```

然后我有一个管理标签的bean

```
@ManagedBean
@SessionScoped
public class TabsBean {

   private HtmlPanelGrid panelGrid;
   private Integer numOfTabs;

   @PostConstruct
   public void init(){numOfTabs=1;}

   public Integer getNumOfTabs() {
    return numOfTabs;
   }

   public void setNumOfTabs(Integer numOfTabs) {
    this.numOfTabs = numOfTabs;
   }

   public TabsBean() {
   }

   public HtmlPanelGrid getPanelGrid() {
    return panelGrid;
   }

   public void setPanelGrid(HtmlPanelGrid panelGrid) {
    this.panelGrid = panelGrid;
   }

   public void createTabs (){       

    FacesContext context = FacesContext.getCurrentInstance();
    Application application = context.getApplication();
    UITabPanel tabPanel = (UITabPanel)application.createComponent(UITabPanel.COMPONENT_TYPE);
    tabPanel.setSwitchType(SwitchType.ajax);

    for (int i=0; i<numOfTabs; i++){
        UITab tab = new UITab();
        tab = (UITab)application.createComponent(UITab.COMPONENT_TYPE);
        tab.setName("User Count "+i);
        tabPanel.getChildren().add(tab);

    }
    numOfTabs++;
    panelGrid.getChildren().clear();
    panelGrid.getChildren().add(tabPanel);
   }

} 
```

现在我的问题是我必须在此选项卡中添加组件（包含所有用户的数据表、用于插入用户的表单等）

我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T12:12:22.487

如果您希望菜单打开具有特定内容的选项卡，最好预先创建选项卡并将其隐藏，并根据要求显示（渲染）。要创建，`Users`请执行以下操作：

创建一个`User`类（如果你没有）

```
public class User {     

    private String name;
    private String country;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getCountry() {
        return country;
    }

    public void setCountry(String country) {
        this.country = country;
    }
} 
```

创建`UserTab`托管 bean

```
import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;

@ManagedBean
@ViewScoped
public class UserTab implements Serializable {

    private List<User> users;
    private boolean rendered;

    public UserTab() {
        //Initialize list
        users = new ArrayList();

        //Initialize rendered attribute
        rendered = false;

        //Replace this for your User data retrieving method
        createDummyUsers();
    }

    private void createDummyUsers() {
        User user = new User();

        user.setName("John Doe");
        user.setCountry("USA");
        users.add(user);

        user = new User();
        user.setName("Bill Doe");
        user.setCountry("Canada");
        users.add(user);

        user = new User();
        user.setName("Winston Doe");
        user.setCountry("England");
        users.add(user);
    }

    public void showTab() {
        rendered = true;
    }

    public void hideTab() {
        rendered = false;
    }

    public List<User> getUsers() {
        return users;
    }

    public void setUsers(List<User> users) {
        this.users = users;
    }

    public boolean isRendered() {
        return rendered;
    }

    public void setRendered(boolean rendered) {
        this.rendered = rendered;
    }
} 
```

创建一个选项卡处理程序：

```
import java.io.Serializable;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;

@ManagedBean
@ViewScoped
public class TabHandler implements Serializable {

    private String activeTab;

    public TabHandler() {
        activeTab = "none";
    }

    public String getActiveTab() {
        return activeTab;
    }

    public void setActiveTab(String activeTab) {
        this.activeTab = activeTab;
    }
} 
```

创建视图

```
<h:body>
        <h:form>
            <rich:panelMenu >
                <rich:panelMenuGroup >
                    <rich:panelMenuItem label="Users" name="Users" 
                                        actionListener="#{userTab.showTab()}">
                        <f:ajax event="select"
                                execute="@this"
                                render="tabPanel"
                                listener="#{tabHandler.setActiveTab('usersTab')}"/>
                    </rich:panelMenuItem>
                    <rich:panelMenuItem label="Orders" name="Orders"  />
                </rich:panelMenuGroup>
            </rich:panelMenu>

            <rich:tabPanel id="tabPanel"
                           switchType="client"
                           activeItem="#{tabHandler.activeTab}">

                <rich:tab id="mainTab">

                </rich:tab>

                <rich:tab id="usersTab"
                          rendered="#{userTab.rendered}">
                    <f:facet name="header">
                        <h:outputLabel value="Users"/>
                        <h:commandLink value="  X" actionListener="#{userTab.hideTab()}"/>
                    </f:facet>
                    <rich:dataTable value="#{userTab.users}"
                                    var="user">

                        <rich:column>
                            #{user.name}
                        </rich:column>

                        <rich:column>
                            #{user.country}
                        </rich:column>
                    </rich:dataTable>

                </rich:tab>

            </rich:tabPanel>
        </h:form>
    </h:body> 
```

执行相同的步骤并为类添加所需的标签`Order`。

请参阅： [RichFaces 动态 TabPanel](https://stackoverflow.com/questions/14319124/richfaces-dynamic-tabpanel)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T09:19:07.843

`c:forEach`如果您想通过单击添加选项卡，则不是一个选项。您想要的是动态添加组件：

*   [如何动态添加 JSF 组件](https://stackoverflow.com/questions/3409053/jsf2-can-i-add-jsf-components-dynamically)
*   [ui中动态添加的输入字段：表单提交期间不处理重复](https://stackoverflow.com/questions/8280168/dynamically-added-input-field-in-uirepeat-is-not-processed-during-form-submit)
*   [如何在 JSF 中动态添加字段？](https://stackoverflow.com/questions/3640635/how-to-dynamically-adding-fields-in-jsf)

# eclipse - 在“更新 Maven 依赖项”期间发生内部错误

> ID：14491298
> 
> 赞同：7
> 
> 时间：2013-01-23T23:26:15.863
> 
> 标签：eclipse, dependencies

每当我运行 eclipse 时，我都会收到以下消息：

```
An internal error occurred during: "Updating Maven Dependencies".
Lorg/codehaus/plexus/archiver/jar/JarArchiver; 
```

我正在运行 maven 版本 3.0.4，并且我尝试更新 JarArchiver 只是因为它一次又一次地失败。

有没有人对可能导致问题的原因有任何想法？如果您有解决方案，那也将非常有帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-01T23:38:21.063

关闭 Eclipse 后，我删除了`~/.m2/repository/org/codehaus/plexus/plexus-archiver`除最新版本之外的所有版本。

在随后的 Eclipse 启动期间，另一个导致错误的工件是 Maven Archiver，因此我也删除了旧版本`~/.m2/repository/org/apache/maven/maven-archiver`。

在另一个 Eclipse 重新启动后，我执行了 Maven -> 更新项目。在那之后一切都很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-22T18:55:16.287

Steps below worked for me to resovle the issue(Add the following in pom.xml)

```
<plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-jar-plugin</artifactId>
          <version>2.4</version>
 </plugin> 
```

Reimport the project again in Eclipse/STS.

The plugin configuration is taken from the maven site below: [http://maven.apache.org/plugins/maven-jar-plugin/plugin-info.html](http://maven.apache.org/plugins/maven-jar-plugin/plugin-info.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-24T15:26:11.773

user2125483 的回答对我不起作用。我尝试有选择地删除`org.maven`和`org.codehaus.plexus`打包本地 Maven 存储库 ( `~/.m2`) 的子目录，而错误消息没有任何更改。我需要对我的整个本地 Maven 存储库进行核攻击并从无到有重建，以使此错误消失。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-18T10:04:00.697

删除 ./m2 中的存储库对我有用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-23T11:24:56.020

对我来说，尝试使用 JDK 11 导入和构建旧项目时发生此错误。我切换回 JDK 8，它现在似乎可以工作了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-26T14:34:41.947

我尝试了上述所有解决方案，但错误并没有消失。然后我检查了我的 Windows 机器上的已安装程序，发现安装了两个不同版本的 Java。（9.0.4 和 10.0.0）我删除了 Java 10，现在 Maven 更新工作了。希望这可以帮助。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-05-04T10:38:55.507

导航到 C:\Users\.m2\repository\org\codehaus\plexus 并删除 plexus 中的所有子文件夹并重新运行 pom.xml 文件

！！有效 ！！

# xml - 缓存电子标签查看

> ID：14491302
> 
> 赞同：0
> 
> 时间：2013-01-23T23:26:42.133
> 
> 标签：xml, caching, etag

我是 XML 和缓存的新手，其中一条评论是：

所有目录方法现在都将返回一个 ETag 标头，如下所示：ETag: “686897696a7c876b7e” - 我应该能够在 JSON Feed 中查看它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:53:50.603

不，它们是 HTTP 响应标头的一部分。JSON 数据将被视为响应正文的一部分。

# scala - 隐式解析或类型推断的限制

> ID：14491303
> 
> 赞同：2
> 
> 时间：2013-01-23T23:26:46.873
> 
> 标签：scala, type-inference, implicit-conversion

我试图理解为什么以下 Scala 代码的隐式解析（或者可能是类型推断）失败。在此代码中，编译在倒数第二行失败，但在显式提供类型的行的修改版本上成功。

```
object O {
  trait Wrapper[-A, +B] {
    def func: A => B
  }

  object Identity

  implicit class Identity2Wrapper[A](self: Identity.type) extends Wrapper[A, A] {
    override def func: A => A = identity
  }

  // Compilation fails on the next line with error: 
  // found String("hello") 
  // required: A
  Identity.func("hello")
  // This line compiles.
  implicitly[Identity.type => Wrapper[String, String]].apply(Identity).func("hello")
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T09:04:06.767

Travis Brown 似乎是对的，这是以下情况的发生：[https ://issues.scala-lang.org/browse/SI-6472](https://issues.scala-lang.org/browse/SI-6472)

作为证明，我可以使用 Travis 本人在此处给出的解决方法对其进行编译：[https ://issues.scala-lang.org/browse/SI-6776](https://issues.scala-lang.org/browse/SI-6776)

```
object O {
  trait Wrapper[-A, +B] {
    val funcFunc: A => B
    def func( arg: A ): B = funcFunc( arg )
  }

  private class Private
  trait BaseWrappable {
    // Dummy method (cannot ever be called, just a work around to help the compiler)
    def func( a: Private ) = ???
  }

  object Identity extends BaseWrappable

  implicit class Identity2Wrapper[A](self: Identity.type) extends Wrapper[A, A] {
    val funcFunc: A => A = identity
  }

  Identity.func("hello")
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T09:00:57.317

您编写的代码与以下内容相同：

```
class Identity2Wrapper[A](self: Identity.type) extends Wrapper[A, A] {
  override def func: A => A = identity
}

implicit def identityToIdentityWrapper[A](self: Identity.type) = new Identity2Wrapper[A](self) 
```

请注意，在`func`使用调用结果之前，类型参数 A 是未绑定的。Scala 编译器不够聪明，无法向前看并确定 A 的类型。此外，您不能`[A] A => A`在 Scala 中创建类型的值。实际上，我很惊讶编译器不会将 A 推断为 Nothing 类型，就像您`identityToIdentityWrapper`显式调用时所做的那样。

# ruby-on-rails - Rails 有一个 Rspec 测试告诉我统一常量

> ID：14491304
> 
> 赞同：0
> 
> 时间：2013-01-23T23:26:55.283
> 
> 标签：ruby-on-rails, ruby, rspec, constants, shoulda

我在两个模型之间有一个关系。这种关系有效，但问题是当我用 shoulda 匹配器编写 Rspec 测试时，我得到了一个错误。

```
 Failure/Error: it { should have_one(:userresetpassword)}
 NameError:
   uninitialized constant User::Userresetpassword 
```

我的代码在`user.rb`

```
has_one :userresetpassword 
```

我的 rspec 测试

```
describe "associations" do
  it { should have_one(:userresetpassword)}
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:45:35.037

您的关联名称错误，并且 rails、shouda-matchers 或两者都很难从中猜出类名。

你有两个选择。首先，最好将关联重命名为常规：

`has_one :user_reset_password`

这将允许 rails 正确猜测类名`UserResetPassword`

其次，您可以简单地消除猜测并告诉 rails 类名是什么。仅当您不能或非常不想更改关联名称时，这才是可取的。

`has_one :userresetpassword, :class_name => "UserResetPassword"`

# ruby-on-rails - 如何构建 Rack 中间件作为表单验证器

> ID：14491306
> 
> 赞同：1
> 
> 时间：2013-01-23T23:27:12.637
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rack

在这里开始机架开发。

我在[http://guides.rubyonrails.org/getting_started.html上构建了基本的博客应用程序](http://guides.rubyonrails.org/getting_started.html)

我可以创建一个帖子，进行更改....很好。

现在...

我正在学习如何使用 Rack，我正在尝试创建一些中间件......

我已经关注了 railscast #150 和 #151 ......你可以在 github 上看到我的代码......

[https://github.com/thefonso/form_challenge](https://github.com/thefonso/form_challenge)

当我在 chrome 的 url 行执行此操作时.....http://localhost:3000/?name=foo

我在命令行上得到了想要的结果。

```
aleph@mage:~/Projects/form_challenge git:master$ rails s
=> Booting WEBrick
=> Rails 3.2.11 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2013-01-23 17:01:30] INFO  WEBrick 1.3.1
[2013-01-23 17:01:30] INFO  ruby 1.9.2 (2012-04-20) [x86_64-darwin12.2.0]
[2013-01-23 17:01:30] INFO  WEBrick::HTTPServer#start: pid=32068 port=3000
{"name"=>"foo"} 
```

太棒了，我可以看到我发送的数据......所以我希望当我从我的博客“创建帖子”页面发送数据时......我应该能够捕获该数据。

但是如何让应用程序的其余部分正常工作？

当我去......http://localhost:3000/

我得到 Rack 应用程序...我想要 Rails 应用程序

现在我运行了这个 Rack 中间件……它“接管”了应用程序的其余部分。我无法到达 Rails 应用程序的“开始”，也无法到达我希望从中接收数据的表单。

整个应用程序再次位于此处....

[https://github.com/thefonso/form_challenge](https://github.com/thefonso/form_challenge)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:04:26.370

在编写中间件时，您有责任调用下一个中间件或应用程序。您的中间件现在所做的只是简单地对每个请求做出空响应，您永远不会调用，因此 rails 甚至会看到该请求。您可以使用以下行修复它：

`@app.call(env)`

这是贯穿所有中间件的调用链的关键线。

所以在[你的中间件](https://github.com/thefonso/form_challenge/blob/master/app/middleware/form_validator.rb)中，做`@app.call(env)`而不是`return response`.

如果要操纵来自 rails 的响应，请执行

```
@status, @headers, @response = @app.call(env) 
```

并且一定要

```
return [@status, @headers, @response] 
```

当你完成时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:55:09.787

您的中间件在其构造函数中传递了另一个中间件/应用程序。该应用程序响应`#call`，因此如果您想将 [可能更改的] 请求和环境传递给下一个应用程序，您需要做的就是调用`#call`该内部应用程序。

将中间件想象成管道：

A -> B -> C

您的请求进入最外层的中间件 A，它可以立即返回响应，或者调用中间件 B（它有一个引用）并根据 B 的返回值和 B 所做的任何修改决定要做什么。B 也一样，取决于 C。

说得通？

# java - 使用 RestTemplate 反序列化嵌套对象

> ID：14491309
> 
> 赞同：12
> 
> 时间：2013-01-23T23:27:27.437
> 
> 标签：java, web-services, spring, jackson, resttemplate

我正在使用 RestTemplate 并且在反序列化对象时遇到问题。这就是我正在做的事情。JSON 响应看起来像，

```
{
    "response": {
        "Time": "Wed 2013.01.23 at 03:35:25 PM UTC",
        "Total_Input_Records": 5,
    },-
    "message": "Succeeded",
    "code": "200"
} 
```

[使用jsonschema2pojo](http://code.google.com/p/jsonschema2pojo)将此 Json 有效负载转换为 POJO

```
public class MyClass {
    @JsonProperty("response")
    private Response response;
    @JsonProperty("message")
    private Object message;
    @JsonProperty("code")
    private Object code;
    private Map<String, Object> additionalProperties = new HashMap<String, Object>();
    //bunch of getters and setters here
}
public class Response {
    @JsonProperty("Time")
    private Date Time;
    @JsonProperty("Total_Input_Records")
    private Object Total_Input_Records;
    private Map<String, Object> additionalProperties = new HashMap<String, Object>();
//bunch of getters and setters here
} 
```

这是我遇到异常的请求处理，

```
String url = "http://example.com/someparams";
RestTemplate template = new RestTemplate(
                new HttpComponentsClientHttpRequestFactory());
FormHttpMessageConverter converter = new FormHttpMessageConverter();
List<MediaType> mediaTypes = new ArrayList<MediaType>();
mediaTypes.add(new MediaType("application", "x-www-form-urlencoded"));
converter.setSupportedMediaTypes(mediaTypes);
template.getMessageConverters().add(converter);
MyClass upload = template.postForObject(url, null, MyClass.class); 
```

这是令人沮丧的部分，异常（故意修剪，不完整）。有什么我想念的吗？

```
org.springframework.http.converter.HttpMessageNotReadableException: Could not read JSON: Unrecognized field "Time" (Class com.temp.pointtests.Response), not marked as ignorable
 at [Source: org.apache.http.conn.EofSensorInputStream@340ae1cf; line: 1, column: 22  (through reference chain: com.temp.pointtests.MyClass["response"]->com.temp.pointtests.Response["Time"]);] 
```

**+++++更新已解决++++++**

我看到 Spring 添加了使用 Jackson 2 的 MappingJackson2HttpMessageConverter。因为我上面的代码中的 MappingJacksonHttpMessageConverter 使用 Jackson Pre2.0 版本并且它不起作用。但是它适用于杰克逊 2.0。随着 MappingJackson2HttpMessageConverter 现在可用，我现在可以将它添加到我的 RestTemplate 并且一切正常:-)。这是有相同问题的人的代码，

```
String url = "http://example.com/someparams";
RestTemplate template = new RestTemplate();
HttpHeaders headers = new HttpHeaders();
headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);  
HttpEntity request = new HttpEntity(headers);
List<HttpMessageConverter<?>> messageConverters = new ArrayList<HttpMessageConverter<?>>();
MappingJackson2HttpMessageConverter map = new MappingJackson2HttpMessageConverter();
messageConverters.add(map);
messageConverters.add(new FormHttpMessageConverter());
template.setMessageConverters(messageConverters);
MyClass msg = template.postForObject(url, request, MyClass.class); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-20T11:38:44.863

使用 org.codehaus.jackson.map.JsonDeserializer 的 @JsonSerialize(using = JsonDateSerializer.class) 或 @JsonDeserialize(using = JsonDateDeSerializer.class) 注解；它将解决问题或用户 ObjectMapper(org.codehaus.jackson.map.ObjectMapper) 转换为 Json 字符串。

objectMapper.writeValueAsString(Object); // 这将给出 json 字符串

# sql-server - 增加部分PK

> ID：14491320
> 
> 赞同：1
> 
> 时间：2013-01-23T23:28:33.297
> 
> 标签：sql-server

我有一张桌子：

```
INSTRUCTIONS:
  RecipeID
  Step
  ... 
```

`RecipeID`由另一个系统生成。不需要有明确的外键关系`RecipeID`。当我为特定配方插入步骤`Instructions`时，我想`Step`增加。向新配方添加步骤时，`step`应返回 0，如下所示：

```
RecipeID | Step
---------------
    0    |  0
    0    |  1

RecipeID | Step
---------------
    0    |  0
    0    |  1
    0    |  2

RecipeID | Step
---------------
    0    |  0
    0    |  1
    0    |  2
    1    |  0 
```

我将如何产生这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:56:26.900

不要这样做 你自己的问题表明这是一个糟糕的主意。你怎么能有一个部分密钥？根据定义，部分键不能是唯一的。

步骤中唯一需要的是订单，将它们显示（或使用 Row_number 查询它们）为 0 到 n 是微不足道的。

想想你必须做什么，插入你错过的步骤，或者交换它们......

RecipeStepID（作为代理主键）

RecipeID,StepNumber 作为索引

表的任何外键链接都使用代理键

然后重新订购只是在搞乱 StepNo

从来没有见过你试图不变成灾难的方法，而且我可以数出它在不脱手套的情况下没有作为灾难开始的次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:03:46.667

**免责声明：请参阅底部的注释。我不一定建议使用触发器。**

您可以使用`instead of`触发器来更改`step`将插入的值：

```
Create Trigger Instructions_UpdateSet
  On [Instructions]
  Instead of Insert
AS
BEGIN
  insert instructions
  select
    i.recipe,
    coalesce(ii.maxstep, -1)
      + row_number() over (partition by i.recipe order by i.step),
    i.instruction
  from inserted i
  left join (select recipe, max(step) as maxstep from instructions group by recipe)
    ii on i.recipe = ii.recipe
END; 
```

这应该无缝地处理单个或多个记录的插入。如果您确实在单个查询中插入多条记录，您可以提供一个`step`值来指示传入插入记录的顺序，它们将被适当地排序并重新编号以在现有记录之后按顺序跟随。

演示：[http ://www.sqlfiddle.com/#!6/b13d5/1](http://www.sqlfiddle.com/#!6/b13d5/1)

* * *

在应用程序中使用触发器时需要注意的一些事项：

*   很容易忘记触发器，因为它们隐藏得很好。确保记录它们，否则当他们插入的数据在数据库中不同时，下一个开发人员会感到困惑。
*   如果您正在使用缓存层，请确保在插入记录后刷新缓存以获取由触发器引起的更改。
*   一般来说，我建议避免触发业务逻辑。如果您正在寻找性能，最好使用存储过程，这对于意图和行为来说更加明显。触发器最适合透明操作，如数据验证、级联更新/删除、审计等。

# java - 如何在 Linux 上为 Firefox 添加 java 插件？

> ID：14491322
> 
> 赞同：20
> 
> 时间：2013-01-23T23:28:37.317
> 
> 标签：java, firefox, plugins, firefox-addon

我想在 Linux（Centos 5.6 64bit）上为 FireFox（v10.0.12）添加 java 插件。

我安装了 JDK 1.7.0_12，并将 /usr/lib/mozilla 下的插件文件夹的符号链接添加到 (JRE)/lib/amd64/ 下的文件 libnpjp2.so 中遵循此 [http://www.oracle.com/ technetwork/java/javase/manual-plugin-install-linux-136395.html](http://www.oracle.com/technetwork/java/javase/manual-plugin-install-linux-136395.html)

但我仍然无法在我的 Firefox 附加组件管理器中找到 java 插件。

可能是什么问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-23T23:33:37.037

你想要JDK还是JRE？无论如何，几周前我也遇到了这个问题。我按照此处的说明进行操作，并且有效：

[http://www.backtrack-linux.org/wiki/index.php/Java_Install](http://www.backtrack-linux.org/wiki/index.php/Java_Install)

### 注意：在安装 Java 之前，请确保您杀死了 Firefox。

根@bt:~#`killall -9 /opt/firefox/firefox-bin`

### 你可以从官网下载java。（下载 tar.gz 版本）

### 我们首先创建目录并将 java 放在那里：

根@bt:~#`mkdir /opt/java`

根@bt:~#`mv -f jre1.7.0_05/ /opt/java/`

### 最后的改动。

根@bt:~#`update-alternatives --install /usr/bin/java java /opt/java/jre1.7.0_05/bin/java 1`

根@bt:~#`update-alternatives --set java /opt/java/jre1.7.0_05/bin/java`

根@bt:~#`export JAVA_HOME="/opt/java/jre1.7.0_05"`

### 将插件添加到 Firefox。

**对于 Java 7（32 位）**

根@bt:~#`ln -sf $JAVA_HOME/lib/i386/libnpjp2.so /usr/lib/mozilla/plugins/`

**对于 Java 8（64 位）**

根@bt:~#`ln -sf $JAVA_HOME/jre/lib/amd64/libnpjp2.so /usr/lib/mozilla/plugins/`

### 测试插件。

根@bt:~#`firefox http://java.com/en/download/testjava.jsp`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-23T23:30:57.487

您应该在用户主页中将插件添加到本地设置的 Firefox

```
 vladimir@shinsengumi ~/.mozilla/plugins $ pwd
 /home/vladimir/.mozilla/plugins 
 vladimir@shinsengumi ~/.mozilla/plugins $ ls -ltr
 lrwxrwxrwx 1 vladimir vladimir 60 Jan  1 23:06 libnpjp2.so -> /home/vladimir/Install/jdk1.6.0_32/jre/lib/amd64/libnpjp2.so 
```

# excel - Excel公式生成字符串的所有前缀数组

> ID：14491324
> 
> 赞同：0
> 
> 时间：2013-01-23T23:28:46.753
> 
> 标签：excel, excel-formula, excel-2010

给定任何数字字符串，我想使用 Excel 2010 中的公式生成所有字符串前缀的数组。

示例（输入 -> 输出）：

```
"12345" -> {"12345","1234","123","12","1"}

"6524" -> {"6524","652","65","6"}

"1" -> {"1"} 
```

输出顺序对我来说很重要，但作为这个问题的答案并不是必需的，因为有可用的排序公式可以在之后应用于输出。

错误的输入（例如空字符串、错误值或其他）应该返回一个空数组、一些错误值或其他同样明显的输出，以显示公式由于输入错误而失败。

必须适用于可变长度输入字符串。我不会接受假设固定长度输入的答案。

必须是 Excel 公式（因此是 excel-formula 标记）并且不依赖于 VBA 宏。我可以编写一个宏来执行此操作，但出于我的目的，我需要一个公式。

必须在 Excel 2010 中工作（因此有 excel-2010 标签）。

**备择方案**

如果您知道如何生成这样的输出：

```
"12345" -> {5,4,3,2,1}

"6524" -> {4,3,2,1}

"1" -> {1} 
```

甚至只是：

```
"12345" -> {1,1,1,1,1}

"6524" -> {1,1,1,1}

"1" -> {1} 
```

这也会有很大帮助，因为我相信这些可以用作找到解决方案的中间步骤。让我卡住的是基于输入字符串长度的可变长度输出数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T02:10:01.233

如果您的值在 A4 中

```
=TRANSPOSE(MID(A4,1,ROW(OFFSET($A$1,0,0,LEN(A4),1)))) 
```

将为您提供长度为 1 到整数的所有子字符串的数组。

在 VBA 中：

```
Sub tester()

Dim v, x

v = Application.Evaluate("=TRANSPOSE(MID(A4,1,ROW(OFFSET($A$1,0,0,LEN(A4),1))))")

For x = LBound(v) To UBound(v)
    Debug.Print x, v(x)
Next x

End Sub 
```

# ms-word - 修复双语错误的从右到左的文本

> ID：14491325
> 
> 赞同：2
> 
> 时间：2013-01-23T23:28:47.563
> 
> 标签：ms-word, right-to-left

我希望我能正确解释问题！有一个文档在 Word 中包含一些波斯语/阿拉伯语和英语的句子，基本上是按“从左到右”的方向书写，并且显示正确，因为原作者已手动将单词放置在正确的位置。下图可能会更好地描述： ![在这张图片中，问题已得到解释](../Images/2bd9014032161ddcc829ab0437a19ed8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T20:56:20.393

请查看[这篇博客文章](http://marc.durdin.net/2012/08/mixing-rtl-and-ltr-plaintext-vs-html.html)，其中讨论了 MS Office 产品中的这个问题。混合文本`LTR`和`RTL`文本的处理实际上来自纯文本和 HTML 解析器处理数据的方式不匹配。

本质上，它与解析器如何假设文本是主要`right-to-left`还是主要有关`left-to-right`。

在 MS Word 中，当您单击`Align Left`或`Align Right`按钮时，您实际上去除了已经存在的格式，并将块级格式应用于段落本身。

看起来您的文档主要是用`RTL`文本编写的，其中包含一些`LTR`基于英语的单词。不幸的是，根据您的系统设置，当您点击`Align Left`或`Align Right`按钮时，您正在编辑的单个段落可能会被推入`LTR`英语模式，这将*完全按照*您所看到的：移动英语单词，并将每个`LTR` *短语*视为一个`RTL` *单词*- 这使得排序变得疯狂。

在编辑此类文档时，一种可能的解决方案可能是查看 MS Office 的`LTR`和`RTL`模式选项。以下是一些可能对您有所帮助的资源，具体取决于您的 Word 版本：

*   [在 Word 中使用 RTL 语言（Office 2007 及更早版本）](http://symbolcodes.tlt.psu.edu/keyboards/winrtl.html)
*   [Microsoft Word 中的双向功能](http://blogs.technet.com/b/office_global_experience/archive/2010/03/04/bidirectional-features-in-microsoft-word.aspx)
*   [如何使用 Office 2010 输入我的语言](http://blogs.technet.com/b/office_global_experience/archive/2009/08/17/how-to-type-in-my-language-using-office-2010.aspx)

我希望这有帮助！

# windows - 使用 1394 连接调试 Windows XP 内核

> ID：14491326
> 
> 赞同：2
> 
> 时间：2013-01-23T23:28:48.507
> 
> 标签：windows, debugging, kernel, windbg, firewire

主机：Windows 7 x64

访客：Windows XP SP3 x86

我在两端安装了 2 个 PCI 火线卡（SIIG 1394 安装为德州仪器 OHCI 兼容 IEEE 1394 主机控制器）。

在 Windows XP 上，我在 boot.ini 中添加了以下内容： /debug /debugport=1394 /channel=10

我重新启动了 Windows XP 并且 OHCI 驱动程序被黄色撞击（这是预期的）。

在 Windows 7（主机）上，我运行 WinDBG(x86)，打开内核调试，1394，指定通道 10 并运行

它说：

> 使用 1394 进行调试
> 
> 检查 1394 调试驱动程序版本。
> 
> 打开\.\DBG1394_INSTANCE10
> 
> 计时器分辨率设置为 1000 微秒。
> 
> 等待重新连接...

没发生什么事。（已安装 1394 Windows 内核模式驱动程序）。

在每张火线卡上，我都有 3 个端口，但我不确定需要使用哪个端口是否重要。

请告知上面的配置可能有什么问题。

如何独立测试1394连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T20:09:51.207

我的两端都没有多个 OHCI 控制器。

最后，通过简单的一一更换组件，我确定问题是由火线电缆故障引起的。它在视觉上没有损坏，但它看起来像是被意外用于除火线端口之外的其他东西。

不幸的是，由于微软没有提供任何实用程序来确保两台机器之间的物理连接，因此需要时间来确定根本原因。

# django - Django 和 Celery：未导入的任务

> ID：14491327
> 
> 赞同：5
> 
> 时间：2013-01-23T23:29:06.143
> 
> 标签：django, celery, django-celery, kombu

我正在使用 Django 和 Celery 在后台运行与联系人/电子邮件解析相关的两个任务。

结构是：

```
project
   /api
   /core
       tasks.py
   settings.py 
```

settings.py 文件包含：

```
BROKER_URL = 'django://'
BROKER_BACKEND = "djkombu.transport.DatabaseTransport"

#celery
BROKER_HOST = "localhost"
BROKER_PORT = 5672
BROKER_USER = "guest"
BROKER_PASSWORD = "guest"
BROKER_VHOST = "/"

sys.path.append(os.path.dirname(os.path.basename(__file__)))
CELERY_IMPORTS = ['project.core.tasks']

import djcelery
djcelery.setup_loader()

# ....

INSTALLED_APPS = (
    #...

    'kombu.transport.django',
    'djcelery',
) 
```

tasks.py 包含：

```
from celery.task import Task
from celery.registry import tasks

class ParseEmails(Task):
    #...

class ImportGMailContactsFromGoogleAccount(Task):
    #...

tasks.register(ParseEmails)
tasks.register(ImportGMailContactsFromGoogleAccount) 
```

此外，在 wsgi.py 中添加

```
os.environ["CELERY_LOADER"] = "django" 
```

现在，我将这个应用程序托管在 WebFactional 服务器上。在我的本地主机上运行良好，但在 Django 应用程序部署在 Apache 服务器上的 WebFaction 服务器上，我得到：

```
2013-01-23 17:25:00,067: ERROR/MainProcess] Task project.core.tasks.ImportGMailContactsFromGoogleAccount[df84e03f-9d22-44ed-a305-24c20407f87c] raised exception: Task of kind 'project.core.tasks.ImportGMailContactsFromGoogleAccount' is not registered, please make sure it's imported. 
```

但任务显示为已注册。如果我跑

```
python2.7 manage.py celeryd -l info 
```

我得到：

```
 -------------- celery@web303.webfaction.com v3.0.13 (Chiastic Slide)
---- **** ----- 
--- * ***  * -- [Configuration]
-- * - **** --- . broker:      django://localhost//
- ** ---------- . app:         default:0x1e55350 (djcelery.loaders.DjangoLoader)
- ** ---------- . concurrency: 8 (processes)
- ** ---------- . events:      OFF (enable -E to monitor this worker)
- ** ---------- 
- *** --- * --- [Queues]
-- ******* ---- . celery:      exchange:celery(direct) binding:celery
--- ***** ----- 

[Tasks]
  . project.core.tasks.ImportGMailContactsFromGoogleAccount
  . project.core.tasks.ParseEmails 
```

我认为这可能是一个相对的导入错误，但我认为 settings.py 和 wsgi.py 的更改会阻止这种情况。

我认为 WebFactional 支持的多个 Python 版本可能与此有关，但是我为 Python 2.7 安装了所有库，并且我还在为 2.7 运行 Django，所以应该没有问题。

使用 celeryd -l info 在 localhost 中运行，当我启动工作程序时，任务也会显示在列表中，但是当我调用任务时它不会输出错误 - 它运行良好。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T09:02:42.167

我在新的 Ubuntu 12.04 / Apache / mod_wsgi / Django 1.5 / Celery 3.0.13 生产环境中遇到了同样的问题。在我的 Mac Os X 10.8 笔记本电脑和我的旧服务器（具有 Celery 3.0.12）上一切正常，但在新服务器上却不行。

芹菜似乎有一些问题： [https ://github.com/celery/celery/issues/1150](https://github.com/celery/celery/issues/1150)

我最初的解决方案是将基于 Task 类的任务更改为基于 @task 装饰器，如下所示：

```
class CreateInstancesTask(Task):
    def run(self, pk):
        management.call_command('create_instances', verbosity=0, pk=pk)
tasks.register(CreateInstancesTask) 
```

像这样：

```
@task()
def create_instances_task(pk):
    management.call_command('create_instances', verbosity=0, pk=pk) 
```

现在这项任务似乎有效，但当然我必须做一些进一步的测试......

# arrays - 为一组标签设置样式 - Flash Builder 4.6

> ID：14491335
> 
> 赞同：0
> 
> 时间：2013-01-23T23:29:31.533
> 
> 标签：arrays, actionscript-3, apache-flex, styles, label

在 for 循环中设置标签颜色有点麻烦

这按预期工作：

```
label1.styleName = "myStyle"; 
```

但是，这不会：

```
for (var j:int = 0; j < labels.length; j++) {
    labels[j].styleName = "myStyle";
} 
```

当我跟踪样式时，我得到了样式名称，但在视觉上没有任何变化，就像在第一个示例中那样。

我尝试过其他方法，例如：

```
(labels[j] as Label).setStyle('color', 0xFFFFFF); // Null object reference 
```

以及我能想到的所有变体...... setStyle（），作为LabelItemRenderer......

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:58:03.813

啊，对于碰巧遇到这个不寻常问题的其他人，我将元素添加到数组中是错误的......

我已经将它们全部添加到一个循环中，而没有使用 'this' 关键字引用.... 上面的代码没有错，只是数组。卧槽！

# python - 检测就职演说语言中的典故（例如非常模糊的匹配）

> ID：14491340
> 
> 赞同：6
> 
> 时间：2013-01-23T23:29:55.033
> 
> 标签：python, text, nlp, nltk

我正在尝试开发一个 Python 脚本来检查巴拉克奥巴马第二次就职演说中的每个句子，并在过去的就职典礼中找到类似的句子。我开发了一个非常粗糙的模糊匹配，我希望改进它。

我首先将所有就职典礼减少为无停用词的句子列表。然后我建立一个频率指数。

接下来，我将奥巴马 2013 年演讲中的每个句子与其他演讲中的每个句子进行比较，并像这样评估相似度：

```
#compare two lemmatized sentences. Assumes stop words already removed. frequencies is dict of frequencies across all inaugural    
def compare(sentA, sentB, frequencies):
    intersect = [x for x in sentA if x in sentB]
    N = [frequencies[x] for x in intersect]
    #calculate sum that weights uncommon words based on frequency inaugurals
    n = sum([10.0 / (x + 1) for x in N])
    #ratio of matches to total words in both sentences. (John Adams and William Harrison both favored loooooong sentences that tend to produce matches by sheer probability.)
    c = float(len(intersect)) / (len(sentA) + len(sentB))
    return (intersect, N, n, c) 
```

最后，我根据 n 和 c 的任意截止值过滤掉结果。

它的效果比人们想象的要好，它可以识别出占总单词比例不可忽略的不常见单词的句子。

例如，它选择了这些匹配项：

* * *

**奥巴马，2013 年：** 因为历史告诉我们，虽然这些真理可能是不言而喻的，但它们从来都不是自动执行的；虽然自由是上帝的礼物，但它必须由他在地球上的子民来保障。

**肯尼迪，1961 年：** 凭着良心，我们唯一确定的回报，历史是我们行为的最终审判者，让我们前去领导我们所爱的土地，祈求他的祝福和帮助，但要知道上帝在地球上的工作必须真正成为我们自己的。

* * *

**奥巴马，2013** 通过鞭子抽的血和剑抽的血，我们了解到，建立在自由和平等原则之上的任何工会都无法在半奴隶半自由的情况下生存。

**林肯，1861** 然而，如果上帝愿意的话，它会一直持续下去，直到奴隶主两百五十年徒劳无功所积累的所有财富都被沉没，直到用鞭子抽出的每一滴血都被另一个用剑抽出的血偿清为止，正如三千年前所说的那样，仍然必须说“耶和华的审判是真实和公义的。

* * *

**奥巴马，2013 年** 这一代美国人经历了危机的考验，这些危机坚定了我们的决心并证明了我们的韧性

**肯尼迪，1961** 自从这个国家成立以来，每一代美国人都被召集来见证其对国家的忠诚。

* * *

但它非常粗糙。

我没有大型机器学习项目的能力，但如果可能的话，我确实想应用更多的理论。我了解二元组搜索，但我不确定这是否会在这里起作用——我们感兴趣的不是精确的二元组，而是引号之间共享的两个单词的普遍接近度。是否有一个模糊的句子比较，它着眼于单词的概率和分布，而不是太死板？典故的本质是它非常近似。

[Cloud9IDE 上可用的](https://c9.io/wilson428/inaugurals)当前工作

**更新，2013 年 1 月 24 日** 根据接受的答案，这是一个用于二元窗口的简单 Python 函数：

```
def bigrams(tokens, blur=1):
    grams = []
    for c in range(len(tokens) - 1):
        for i in range(c + 1, min(c + blur + 1, len(tokens))):
            grams.append((tokens[c], tokens[i]))
    return grams 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:14:28.593

如果你受到启发使用二元组，你可以建立你的二元组，同时允许一个、两个甚至三个单词的间隙，以便稍微放宽二元组的定义。这可能会起作用，因为允许*n 个*间隙意味着甚至没有*n*倍的“bigrams”，而且您的语料库非常小。例如，有了这个，您第一段中的“bigram”可能是`(similar, inaugurals)`.

# ember.js - 从模板访问模型

> ID：14491347
> 
> 赞同：5
> 
> 时间：2013-01-23T23:30:13.247
> 
> 标签：ember.js

玩弄 ember，我发现有时模型存储在控制器的`content`属性中，有时模型也直接在控制器上可用。但是，我不明白什么时候是这种情况。

让我通过一个我在组装我的 ember MVC 时找到的例子来解释它。

**设置 A - 开始**

*   我定义了一个自定义`Member`对象、对应`MemberRoute`的`MemberView`类和一个名为 的模板`member`。
*   该`Member`对象具有一些属性，例如`id`,`nickname`等。
*   **注意**：没有`MemberController`定义表单的控制器，因此按照 ember 的约定，它自己提供控制器。

**设置 B - 自定义**

*   与设置 A 相同，但现在有一个`MemberController`定义，其中包含一些从模板内触发的操作方法。

**奇怪的行为**（分别是我不完全理解的）

*   在设置 A 中，我可以使用或`Member`直接引用 的属性。`{{id}}``{{nickname}}`
*   在设置 B 中，我必须使用`{{content.id}}`或`{{content.nickname}}`

如 ember 的文档`MemberView`中所述，

```
setupController : function(controller, member) {
    controller.set('content', member);
}, 
```

那么，有人可以帮我理解为什么会有差异以及差异在哪里吗？目前，我的猜测是

*   模板的上下文不同（可能在控制器的设置中缺少代码片段？）

或者

*   ember 自动提供的默认控制器有一些额外的魔法，这些魔法不能直接用于自定义控制器。

任何帮助理解这一点都非常感谢。我已经花了很长时间才走到这一步。我首先认为这可能是使用 requireJS 的项目设置引入的模块化（嗯，我仍然认为这可能会产生影响）。Ember 是 v1.0pre4。

提前致谢！帕特里克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T23:45:50.653

> 那么，有人可以帮我理解为什么会有差异以及差异在哪里吗？目前，我的猜测是模板的上下文不同（可能在控制器的设置中缺少代码片段？）或者由 ember 自动提供的默认控制器具有一些不直接的附加魔法可用于定制控制器。

如果没有看到您的代码，很难确定，但我最好的猜测是您的`MemberController`extends `Ember.Controller`。ember 提供的默认值（在这种情况下）是`Ember.ObjectController`. 如果这是您想要的，请将您的 MemberController 定义更改为：

```
App.MemberController = Ember.ObjectController.extend({
  myProperty: 'value'
}); 
```

objectController 充当其`content`属性的代理，通常是 ember 模型。因此，如果连接正确，您将永远不需要通过“内容”属性访问模型。如果你看到类似的东西：

```
{{content.id}} or {{content.nickname}} 
```

这表明您应该更改为 ObjectController。请参阅[EMBER 指南：代表单个模型](http://emberjs.com/guides/controllers/representing-a-single-model-with-objectcontroller/)！以获得更详细的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:03:01.037

an`ObjectController`充当设置为控制器内容的对象的代理。当没有定义控制器时，Ember 将为您创建一个控制器，并将其内容默认设置为`model() function`路由中的 （如果已定义）返回的任何对象。无论您是定义自己的控制器还是让 Ember 为您定义一个，行为都应该是相同的

模板中的默认上下文是控制器本身，即`this = an instance of your controller or the generated one`. 当您尝试在该上下文中访问昵称时，Ember 将首先尝试根据控制器本身解析它，如果没有找到，它会根据其内容解析它，即如果您已经手动将其设置为控制器内容的对象。

最后，Route 中没有默认实现，`model() function`除非您使用动态 url，`say /foo/id that resolves against /foo/:id`Ember 使用提供的 id 来加载具有提供的 id 的 Foo 对象，从而为 model() 函数提供默认实现。最后归结为相同的机制，只是为了您的方便而自动化。

我建议您收听[这篇](https://www.youtube.com/watch?v=4Ed_o3_59ME)文章，以了解更多有关 Ember 如何为您实现自动化的见解。但是当涉及到显示的内容时，您不必手动连接控制器的内容。

# sed - 使用 sed 更改 /etc/fstab，第二部分

> ID：14491359
> 
> 赞同：1
> 
> 时间：2013-01-23T23:31:23.807
> 
> 标签：sed, awk

我正在尝试`/etc/fstab`使用`sed`/进行修改`awk`。然而，就像在[这个问题](https://stackoverflow.com/questions/9118123/using-sed-to-change-etc-fstab)中一样，该问题中的解决方案对我来说并不*完全*有效。

我需要将`nodev`(and `nosuid`) 选项添加到`nfs`或`nfs4`挂载点。

我有工作；

```
awk '$4!~/nodev/&&$3~"nfs"{$4=$4",nodev"}1' OFS="\t" /etc/fstab > /etc/fstab.tmp && mv /etc/fstab.tmp /etc/fstab

awk '$4!~/nosuid/&&$3~"nfs"{$4=$4",nosuid"}1' OFS="\t" /etc/fstab > /etc/fstab.tmp && mv /etc/fstab.tmp /etc/fstab 
```

但是，它会消除现有的空白并替换为单个选项卡。我的问题是：**我怎样才能以一种不那么侵入性的方式进行这种改变？** [这个答案](https://stackoverflow.com/a/9118513/1207760)看起来很有希望，但我对它的理解还不够好，无法适应我的使用。

我对`sed`or以外的解决方案持开放`awk`态度，但任何其他工具都需要存在于默认的 Red Hat/CentOS 环境中（在 Kickstart 的 %post 期间。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:49:05.173

不幸的是，`awk`如果您更改任何字段，确实倾向于使用空格。但这对于 sed 来说非常简单。如果您的 sed 支持`\S`表示非空白，您可以执行以下操作：

`sed 's/\S\S*/&,nodev/4'`附加`,nodev`到第 4 列。所以试试：

```
sed -e '/nfs/{/nodev/!s/\S\S*/&,nodev/4}' -e '/nfs/{/nosuid/!s/\S\S*/&,nosuid/4}' 
```

如果您的 sed 不允许`/S`，请`[^ ]`改用（实际空格和括号内的制表符。）这不会将匹配限制为`nfs`第三列。练习留给读者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-31T17:14:22.320

尽管这有点晚了——这是我在我的 KickStart 文件中使用的一种方法来更改 /etc/fstab

```
 sed -i '/tmp\s/ s/defaults/rw,nodev,noexec,nosuid/' /etc/fstab 
```

基本上，当它看到与`/tmp`后跟至少一个空格的行时，它将用 替换`defaults`单词`rw,nodev,noexec,nosuid`。没有大惊小怪，没有混乱。

# android - 通过远程桌面测试 Android 应用

> ID：14491360
> 
> 赞同：1
> 
> 时间：2013-01-23T23:31:28.327
> 
> 标签：android

当我离开电脑时，我喜欢使用 TeamViewer 访问它并在我的 Android 应用程序上工作。我将未签名的 .apk 文件保存到我的 Google Drive，这样我也可以在旅途中测试它们。我通过 Drive 应用程序将 .apk 文件下载到我的 Android 设备，但我遇到了问题。

当我从 Google Drive 下载后去安装该应用程序时，Android 会询问我是否要安装该应用程序。当我单击“是”时，它开始安装过程，但随后退出并出现“未安装应用程序”错误。似乎没有任何其他迹象表明发生了什么。

我已经用我的几个 .apk 文件尝试过这个，但它们都给了我同样的问题。如果有帮助，这些是我之前通过将我的安卓设备插入计算机运行应用程序而下载的应用程序。在尝试通过 .apk 文件安装它之前，我确保先卸载该应用程序。我正在 Google Nexus 7 32GB 上进行测试。

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:22:42.930

对我来说，听起来您正在尝试安装一个使用与设备上安装的证书不同的证书签名的 APK。

运行 logcat，您将看到一条消息，其中包含有关正在发生的确切情况的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:13:40.263

根据现在已删除（？）的评论，您正在尝试安装未签名的 APK。

唉，您不能安装未签名的 APK。Android——模拟器和设备——只运行签名的 APK。

正常开发过程的结果是使用调试签名密钥签名的 APK，而不是未签名的 APK。有一个未签名 APK 的概念，但您必须不遗余力地正常创建一个，这通常只是签署它的中间步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:40:01.680

尝试过[通过 ADB 安装未签名的 APK](http://developer.android.com/tools/help/adb.html#move)吗？这应该让您看到安装该 APK 时出现的任何错误，例如安全设置。

# php - 从多维数组中获取值

> ID：14491362
> 
> 赞同：0
> 
> 时间：2013-01-23T23:31:43.307
> 
> 标签：php, arrays, object

我收到一个包含以下信息的对象

```
Array ( [0] => stdClass Object ( [campaigns_id] => 100 [views] => 28 )
        [1] => stdClass Object ( [campaigns_id] => 99 [views] => 346 )
        [2] => stdClass Object ( [campaigns_id] => 98 [views] => 73 )
        [3] => stdClass Object ( [campaigns_id] => 97 [views] => 204 )
        [4] => stdClass Object ( [campaigns_id] => 96 [views] => 10 )
        [5] => stdClass Object ( [campaigns_id] => 57 [views] => 12 )
      ) 
```

基本上，它的每一行都有两个值——一个 ID 和一个视图计数。

如果我的“活动 ID”为“100”，我将如何成功地从该对象中获取数字“28”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:40:15.197

尝试，

```
//$arr is the array, loop through it
foreach ($arr as $v) {
 if( $v->campaigns_id === 100 ) //Similarly you can get any other value for 'views'
  echo $v->views;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:40:45.120

循环遍历你的数组

```
$yourval = 0;;

foreach( $yourarray as $id => $val ){

if( $val->campaigns_id === 100 ){
  $yourval = $val->views;
}

}

echo $yourval; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T23:41:20.587

您可以内联或作为函数执行此操作，我认为您可能更容易将其视为函数，所以在这里。

```
$view = get_view($the_array);

function get_view(& $my_array) {

  foreach($my_array as $object) {

    if($object->campaigns_id == 100) return $object->views;

  }

  return false;

} 
```

# javascript - 尽管 CSS 相同，但我网站上的一个 div 高于另一个。为什么？

> ID：14491366
> 
> 赞同：0
> 
> 时间：2013-01-23T23:32:06.880
> 
> 标签：javascript, jquery, html, css

[http://christianselig.com](http://christianselig.com)

在我的两张标题图片中，一张大约高出 10 像素左右，但我不知道是什么原因造成的。我已经爬取了我的代码，但我就是想不通。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:35:27.097

左侧链接中似乎有一个额外的换行符。

# python - Python POST 错误 500，仅适用于 Windows 7 且文件大于 1Mb

> ID：14491368
> 
> 赞同：2
> 
> 时间：2013-01-23T23:32:13.420
> 
> 标签：python, windows, post, size

我正在使用 Python 2.7 将一些数据发布到服务器：虽然这适用于 Linux 和 OS X，但在 Windows 中它会持续上传超过 4 分钟，然后放弃“**错误 500** ”。但仅当文件 > 1Mb 时。在服务器端，由于文件传输损坏而产生错误。我也尝试过 Python 2.5，在虚拟机和两个不同的本地 Windows 环境中运行它。Windows 版本为 Win7 x64。

1.  适用于**<1Mb的文件**
2.  适用于 OS X 和 Linux (Ubuntu) 下的**任何文件大小**
3.  如果我通过 web 界面、linux 或 os/x 上传相同的文件，**它可以**完美运行，所以问题似乎不在于文件本身。

代码：

```
data = {
    'title': title,
    'file': open(filename),
    'filename': filename
}

datamulti, headers = multipart_encode(data)
request = urllib2.Request(url, datamulti, headers)
print(result.read()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T12:54:47.093

试试这个：

```
data = {
    'title': title,
    'file': open(filename, 'rb'),
    'filename': filename
} 
```

这将使文件以二进制模式而不是文本模式打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T12:49:50.653

这是一个工作版本，在win32中测试：

```
 data = {
    'title': title,
    'file': open(filename, 'rb'),
    'filename': filename
    }

    datamulti, headers = multipart_encode(data)
    request = urllib2.Request(url, datamulti, headers, None, True)
    print urllib2.urlopen(request).read() 
```

# xml - 在 CakePHP 中格式化我的 XML 输出

> ID：14491376
> 
> 赞同：0
> 
> 时间：2013-01-23T23:32:34.220
> 
> 标签：xml, cakephp

我的`players`桌子上有三个`field id`, `first_name`, `last_name`。显示表中每个玩家的`PlayersController`have 方法`index`：

```
public function index() {
        $output = $this->Player->find('all');
        $this->set(array(
            'output' => $output,
            '_serialize' => array('output')
        ));
        $this->render('generic_response');
    } 
```

generic_response 是一个 XML 视图，如下所示：

```
<?php
$xml = Xml::fromArray(array('response' => $output));
echo $xml->asXML(); 
```

生成的 XML 是：

```
<response>
  <output>
     <Player>
       <id>2</id>
       <first_name>Ciro</first_name>
       <second_name>Spee</second_name>
     </Player>
   </output>
   <output>
     <Player>
       <id>3</id>
       <first_name>Ugo</first_name>
       <second_name>Ridi</second_name>
     </Player>
   </output>
</response> 
```

但我想要类似的东西：

```
<response>
  <players>
     <Player>
       <id>2</id>
       <first_name>Ciro</first_name>
       <second_name>Spee</second_name>
     </Player>
     <Player>
       <id>3</id>
       <first_name>Ugo</first_name>
       <second_name>Ridi</second_name>
     </Player>
   </players>
</response> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T03:26:11.563

旧代码：

```
$output = $this->Player->find('all');
$this->set(array(
    'output' => $output,
    '_serialize' => array('output')
)); 
```

新代码：

```
$output = array(
    'Player' => Hash::combine(
        $this->Player->find('all'),
        '{n}.Player.id',
        '{n}.Player'
    )
);

$this->set(array(
    'players' => $output,
    '_serialize' => array('players')
)); 
```

# winapi - WinAPI C++ 客户端在读取之前检测匿名管道上的写入

> ID：14491378
> 
> 赞同：3
> 
> 时间：2013-01-23T23:32:48.670
> 
> 标签：winapi, visual-c++, pipe

我正在编写一个从 STDIN 上的匿名管道读取的 C++ (Windows) 客户端控制台应用程序。我希望能够按如下方式使用我的程序：

```
echo input text here | my_app.exe 
```

并使用管道输入的文本在应用程序中执行某些操作

**或者**

```
my_app.exe 
```

然后在应用程序内部使用一些默认文本，而不是来自管道的输入。

鉴于第一种情况，我目前有成功从 STDIN 上的管道读取的代码：

```
#include <Windows.h>
#include <iostream>
#include <string>

#define BUFSIZE 4096

int main(int argc, const char *argv[]) {
    char char_buffer[BUFSIZE]; 
    DWORD bytes_read;
    HANDLE stdin_handle;
    BOOL continue_reading;
    unsigned int required_size;
    bool read_successful = true;

    stdin_handle = GetStdHandle(STD_INPUT_HANDLE);

    if (stdin_handle == INVALID_HANDLE_VALUE) {
        std::cout << "Error: invalid handle value!\n\n";
    } else {
        continue_reading = true;

        while (continue_reading) { 
            continue_reading = ReadFile(stdin_handle, char_buffer, BUFSIZE,
                &bytes_read, NULL); 

            if (continue_reading) {
                if (bytes_read != 0) {
                    // Output what we have read so far
                    for (unsigned int i = 0; i < bytes_read; i++) {
                        std::cout << char_buffer[i];
                    }
                } else {
                    continue_reading = false;
                }
            }
        }
    }

    return 0;
} 
```

我知道我对匿名管道的唯一选择是使用 ReadFile 进行阻塞读取。如果我理解正确，关于我如何调用它，ReadFile 将继续从 STDIN 上的缓冲区读取，直到它检测到管道另一端的写操作结束（也许读取某种“写结束”令牌？？）。我想知道是否有某种“开始写入”令牌将在缓冲区中，如果正在传输某些东西，我可以在调用 ReadFile**之前检查 STDIN。**如果是这种情况，我可以跳过调用 ReadFile 并使用一些默认文本。

如果没有办法做到这一点，我总是可以传入一个命令行参数，表示我不应该检查管道而只使用默认文本（或相反），但我更愿意这样做我指定的方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T01:16:41.203

看[`PeekNamedPipe()`](http://msdn.microsoft.com/en-us/library/aa365779.aspx)。尽管它的名字，它适用于命名和匿名管道。

```
int main(int argc, const char *argv[])
{
    char char_buffer[BUFSIZE]; 
    DWORD bytes_read;
    DWORD bytes_avail;
    DWORD dw;
    HANDLE stdin_handle;
    bool is_pipe;

    stdin_handle = GetStdHandle(STD_INPUT_HANDLE);
    is_pipe = !GetConsoleMode(stdin_handle, &dw);

    if (stdin_handle == INVALID_HANDLE_VALUE) {
        std::cout << "Error: invalid handle value!\n\n";
    } else {
        while (1) { 
            if (is_pipe) {
                if (PeekNamedPipe(stdin_handle, NULL, 0, NULL, &bytes_avail, NULL)) {
                    if (bytes_avail == 0) {
                        Sleep(100);
                        continue;
                    }
                }
            }

            if (!ReadFile(stdin_handle, char_buffer, min(bytes_avail, BUFSIZE), &bytes_read, NULL)) {
                break; 
            }

            if (bytes_read == 0) {
                break;
            }

            // Output what we have read so far
            for (unsigned int i = 0; i < bytes_read; i++) {
                std::cout << char_buffer[i];
            }
        }
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-24T08:25:59.240

看起来您在这里真正想要做的是确定您是否有控制台输入（使用默认值）与管道输入（使用管道输入）。

建议直接测试而不是尝试检查是否有输入准备好：尝试嗅探管道中是否有数据的问题是，如果源应用程序生成输出的速度很慢，那么您的应用程序可能会做出不正确的假设，因为没有t 输入*尚未*可用。（也有可能，由于提前输入，在您的应用程序开始检查输入是否可用之前，用户可能已经输入了准备从控制台 STDIN 读取的区域的字符。）

另外，请记住，允许您的应用程序与文件重定向一起使用可能很有用，而不仅仅是管道 - 例如：

```
myapp.exe < some_input_file 
```

在 unix 上执行此“交互模式，与使用重定向输入”测试的经典方法是使用 isatty(); 幸运的是，在 Windows CRT 中有一个等价物 - 请参阅[函数 _isatty()](http://msdn.microsoft.com/en-us/library/f4s0ddew.aspx)；或使用[GetFileType()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364960%28v=vs.85%29.aspx)检查 GetStdHandle(STD_INPUT_HANDLE) 上的 FILE_TYPE_CHAR - 或像 Remy 那样使用说 GetConsoleMode，这只会在真正的控制台句柄上成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:44:59.720

这在使用第二个线程时也可以在没有重叠 I/O 的情况下工作，该线程执行同步 ReadFile 调用。然后主线程等待任意时间并像上面一样行事......

希望这可以帮助...

# php - 从其他网站检索数据的最佳方法是什么？

> ID：14491381
> 
> 赞同：-1
> 
> 时间：2013-01-23T23:32:50.533
> 
> 标签：php, xml, curl, file-get-contents

我想从其他网站获取一张表格（该表格每天都在更新），并且我希望它显示在我的网站上，只是与原始网站中的排列方式不同。

所以我使用 curl 和 strstr() 获得了表格，但使用字符串函数编辑整个表格似乎毫无意义。我确信有一种更简单的方法可以做到这一点。

也许有一种方法可以创建 xml 格式的原始表，我可以更轻松地使用该结构？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T22:38:14.120

Here's a crude example of how you might consume the table (only to echo out another table), Below I'm using SimpleXML and xpath to search the document for the element that has a class of Table Data and looping through all the TR's and putting some special conditions to deal with the and blocks that exist

Obvious downside is if the third party website's layout changes, your code will stop functioning.

```
header('Content-Type: text/html; charset=UTF-8');
$html = file_get_contents('http://www.votes-19.gov.il/nationalresults'); // or use curl
$html = mb_convert_encoding($html, 'HTML-ENTITIES', "UTF-8"); 

$doc = new DOMDocument();
$doc->strictErrorChecking = FALSE;
$doc->loadHTML($html);
$xml = simplexml_import_dom($doc);

echo '<!doctype html><html><head><style type="text/css">body{direction: rtl;}</style></head><body><table>';
if($trxpath = $xml->xpath('//table[@class="TableData"]/tr'))
{
  foreach($trxpath as $tr)
  {
    echo '<tr>';
    echo '<th>' . $tr->th . '</th>';
    foreach($tr->td as $td)
    {
      if($td->div)
        echo '<td>' . $td->div . '</td>';
      else
        echo '<td>' . $td . '</td>';
    }
    echo '</tr>';
  }
}
echo '</table></body></html>'; 
```

# oracle - 在Oracle中的一个选择查询中合并不同表的不同列

> ID：14491383
> 
> 赞同：-1
> 
> 时间：2013-01-23T23:33:23.243
> 
> 标签：oracle

我有两个表： 表： AA 与列 A、 B 、 C、 D 表： BB 与列 E 、 FG

我想得到输出，它是这两个表的组合，如下所示：

```
A | B | C | D | E | F | G 
```

我目前正在执行以下操作：

```
Select * from ( 

( select A, B, C ,D from AA where some condition)

UNION ALL

( select E , F , G , NULL from BB where some condition) ) 
```

但它给我的输出只包含 AA 表中的 A 、 B 、 C 、 D ，而它没有从表 BB 中添加 E 、 F 、 G 。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:40:53.490

不确定您的想法是什么，但是如果您只想在同一个表中显示来自 AA 和 BB 的纯数据，那么您可以使用类似这样的东西

```
 ( select A, B, C ,D, NULL as E, NULL as F, NULL as G from AA where some condition)

 UNION ALL

( select NULL as A , NULL as B, NULL as C, NULL as D, E , F , G  from BB where some condition) ) 
```

但不确定这是什么意思：|

如果你想要一些数据组合，那么连接是必须的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:41:42.933

如果您正在寻找看起来像这样的结果：

```
A1  B1  C1  D1 
A2  B2  C2  D2 
A3  B3  C3  D3 
E1  F1  G1 
E2  F2  G2 
```

然后尝试类似的东西

```
(select A Fld1, B Fld2, C Fld3, D Fld4 from AA where some condition)
union
(select E Fld2, F Fld2, G Fld3, Null from BB where some condition) 
```

换句话说，为两个选择之间相同的字段提供一个通用别名。当然，字段必须是相同的类型。

# c# - 推断列表初始化可能吗？

> ID：14491388
> 
> 赞同：4
> 
> 时间：2013-01-23T23:34:15.140
> 
> 标签：c#, .net

我知道我可以按如下方式初始化集合

```
var array = []{"1", "2", "3"}; 
```

这将自动推断我想创建一个字符串类型的数组，但这将限制我在数组中添加或删除索引，因为数组具有固定大小。

无论如何对通用列表类型做同样的事情，编译器应该根据初始化程序中的项目推断哪种类型“T”？

也许像 new List(){...}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:37:48.323

不，这不受支持 - 您必须指定类型参数，但仍然可以使用[集合初始](http://msdn.microsoft.com/en-us/library/vstudio/bb384062.aspx)值设定项。

```
var list = new List<String> { "1", "2", "3" }; 
```

但是，您可以创建一个辅助方法

```
public static class ListUtilities
{
    public static List<T> New<T>(params T[] items)
    {
        return new List<T>(items);
    }
} 
```

并像这样使用它。

```
var list = ListUtilities.New("1", "2", "3"); 
```

但这可能不值得，如果有什么好处，您也不会获得太多收益。这将首先创建一个数组并使用它来填充一个列表。所以这与基思尼古拉斯的没有什么不同`var list = new[] { "1", "2", "3" }.ToList();`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:37:22.540

这是一个非常漂亮的例子：

```
static void Main(string[] args)
{
    var Customer = new { FirstName = "John", LastName = "Doe" };
    var customerList = MakeList(Customer);

    customerList.Add(new { FirstName = "Bill", LastName = "Smith" });
}

public static List<T> MakeList<T>(T itemOftype)
{
    List<T> newList = new List<T>();
    return newList;
} 
```

[http://kirillosenkov.blogspot.com/2008/01/how-to-create-generic-list-of-anonymous.html](http://kirillosenkov.blogspot.com/2008/01/how-to-create-generic-list-of-anonymous.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:36:39.163

是的。但没有推论。

```
var li = new List<int> {1,2,3,4,5,6}; 
```

您将得到的最接近的是

```
var li = new List<dynamic> {1,2,3,4,5} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T23:42:28.223

```
var list = new[] {"1", "2", "3"}.ToList(); 
```

# java - 大文本中的最长公共子串

> ID：14491389
> 
> 赞同：3
> 
> 时间：2013-01-23T23:34:15.643
> 
> 标签：java

我有这个学校任务，要求我们编写代码来找到最长的公共子字符串。我已经这样做了，但它只适用于不太大的文本，并且被要求找到 Moby Dick 和 War And Peace 的公共子字符串。如果你能指出我做错了什么的正确方向，我将不胜感激。当我调用它来创建 SuffixArray 时，编译器抱怨错误出现在 MyString 类的子字符串方法中，但我不知道为什么它说它太大，给了我内存不足

```
package datastructuresone;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.Arrays;
import java.util.Scanner;

 class SuffixArray
 {

private final MyString[] suffixes;
private final int N;

public SuffixArray(String s)
{
    N = s.length();
    MyString snew = new MyString(s);
    suffixes = new MyString[N];
    for (int i = 0; i < N; i++)
    {
        suffixes[i] = snew.substring(i);
    }
    Arrays.sort(suffixes);
}

public int length()
{
    return N;
}

public int index(int i)
{
    return N - suffixes[i].length();
}

public MyString select(int i)
{
    return suffixes[i];
}

// length of longest common prefix of s and t
private static int lcp(MyString s, MyString t)
{
    int N = Math.min(s.length(), t.length());
    for (int i = 0; i < N; i++)
    {
        if (s.charAt(i) != t.charAt(i))
        {
            return i;
        }
    }
    return N;
}

// longest common prefix of suffixes(i) and suffixes(i-1)
public int lcp(int i)
{
    return lcp(suffixes[i], suffixes[i - 1]);
}

// longest common prefix of suffixes(i) and suffixes(j)
public int lcp(int i, int j)
{
    return lcp(suffixes[i], suffixes[j]);

}
}

public class DataStructuresOne
{

public static void main(String[] args) throws FileNotFoundException
{
    Scanner in1 = new Scanner(new File("./build/classes/WarAndPeace.txt"));
    Scanner in2 = new Scanner(new File("./build/classes/MobyDick.txt"));

    StringBuilder sb = new StringBuilder();
    StringBuilder sb1 = new StringBuilder();

    while (in1.hasNextLine())
    {
        sb.append(in1.nextLine());

    }
    while (in2.hasNextLine())
    {
        sb1.append(in2.nextLine());
    }

    String text1 = sb.toString().replaceAll("\\s+", " ");
    String text2 = sb1.toString().replaceAll("\\s+", " ");

    int N1 = text1.length();
    int N2 = text2.length();

    SuffixArray sa = new SuffixArray(text1 + "#" + text2);
    int N = sa.length();

    String substring = "";
    for (int i = 1; i < N; i++)
    {

        // adjacent suffixes both from second text string
        if (sa.select(i).length() <= N2 && sa.select(i - 1).length() <= N2)
        {
            continue;
        }

        // adjacent suffixes both from first text string
        if (sa.select(i).length() > N2 + 1 && sa.select(i - 1).length() > N2 + 1)
        {
            continue;
        }

        // check if adjacent suffixes longer common substring
        int length = sa.lcp(i);
        if (length > substring.length())
        {
            substring = sa.select(i).toString().substring(0, length);
            System.out.println(substring + " ");
        }
    }

    System.out.println("The length of the substring " + substring.length() + "length on    first N " + N1 + " length of Second N " + N2
            + "The length of the array sa: " + N);
   System.out.println("'" + substring + "'");

   final class MyString implements Comparable<MyString>
{

public MyString(String str)
{
    offset = 0;
    len = str.length();
    arr = str.toCharArray();
}

public int length()
{
    return len;
}

public char charAt(int idx)
{
    return arr[ idx + offset];
}

public int compareTo(MyString other)
{
    int myEnd = offset + len;
    int yourEnd = other.offset + other.len;
    int i = offset, j = other.offset;

    for (; i < myEnd && j < yourEnd; i++, j++)
    {
        if (arr[ i] != arr[ j])
        {
            return arr[ i] - arr[ j];
        }
    }

    // reached end.  Who got there first?
    if (i == myEnd && j == yourEnd)
    {
        return 0;   // identical strings
    }
    if (i == myEnd)
    {
        return -1;
    } else
    {
        return +1;
    }
}

public MyString substring(int beginIndex, int endIndex)
{
    return new MyString(arr, beginIndex + offset, endIndex - beginIndex);
}

public MyString substring(int beginIndex)
{
    return substring(beginIndex, offset + len);
}

public boolean equals(Object other)
{
    return (other instanceof MyString) && compareTo((MyString) other) == 0;
}

public String toString()
{
    return new String(arr, offset, len);
}

private MyString(char[] a, int of, int ln)
{
    arr = a;
    offset = of;
    len = ln;
}
private char[] arr;
private int offset;
private int len;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T23:48:21.710

这里：

```
for (int i = 0; i < N; i++)
{
    suffixes[i] = snew.substring(i);
} 
```

您不仅要存储整个长字符串，还要存储整个字符串 - 1 个字母和整个字符串 - 2 个字母等。所有这些都单独存储。

如果您的字符串只有 10 个字母，那么您将在 10 个不同的字符串中存储总共 55 个字符。

在 1000 个字符中，您总共存储了 500500 个字符。

更一般地说，您必须处理 length*(length+1)/2 个字符。

* * *

只是为了好玩，我不知道战争与和平中有多少字符，但页数约为 1250，典型的单词/页估计为 250，平均单词长度约为 5 个字符，得出：

(1250 * 250 * 5)*(1250 * 250 * 5 + 1)/2 = 1.2207039 * 10^12 个字符。

内存中 char 的大小为 2 个字节，因此您看到的大小约为 2.22 TB（相比之下，仅小说文本为 1.49 MB）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:45:57.120

在代码的前几行中，我计算了这两个文本的至少 3 个副本。这里有一些想法

*   在读取每一行时转换空格 - 而不是在它们是巨大的字符串之后。不要忘记行首和行尾空格的情况。
*   使用 StringBuilder 作为基础而不是 String 来构建您的 MyString 类。如果可以的话，用它的本机方法在 StringBuilder 内部进行所有的查看。
*   不要再提取字符串了。

查找 -Xmx java 运行时选项并将堆空间设置为大于默认值。你必须谷歌这个，因为我没有记住它。请注意 -Xmx=1024M 最后需要那个 M 。（看文件大小，看看这两本书有多大。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T05:18:44.623

我用 Scala 编写了这个程序。也许你可以把它翻译成Java。

```
class MyString private (private val string: String, startIndex: Int, endIndex: Int) extends Comparable[MyString] {
  def this(string: String) = this(string, 0, string.length)
  def length() = endIndex-startIndex
  def charAt(i: Int) = {
    if(i >= length) throw new IndexOutOfBoundsException
    string.charAt(startIndex + i)
  }
  def substring(start: Int, end: Int): MyString = {
    if(start < 0 || end > length || end < start) throw new IndexOutOfBoundsException
    new MyString(string, startIndex + start, startIndex + end)
  }
  def substring(start: Int): MyString = substring(start, length)
  def longestCommonSubstring(other: MyString): MyString = {
    var index = 0
    val len = math.min(length, other.length)
    while(index < len && charAt(index) == other.charAt(index)) index += 1
    substring(0, index)
  }
  def compareTo(other: MyString): Int = {
    val len = math.min(length, other.length)
    for(i <- 0 until len) {
      if(charAt(i) > other.charAt(i)) return 1
      if(charAt(i) < other.charAt(i)) return -1
    }
    length-other.length
  }
  def >(other: MyString) = compareTo(other) > 0
  def <(other: MyString) = compareTo(other) < 0
  override def equals(other: Any) = other.isInstanceOf[MyString] && compareTo(other.asInstanceOf[MyString]) == 0
  override def toString() = "\"" + string.substring(startIndex, endIndex) + "\""
}

def readFile(name: String) = new MyString(io.Source.fromFile(name).getLines.mkString(" ").replaceAll("\\s+", " "))
def makeList(str: MyString) = (0 until str.length).map(i => str.substring(i)).toIndexedSeq

val string1 = readFile("WarAndPeace.txt")
val string2 = readFile("MobyDick.txt")

val (list1, list2) = (makeList(string1).sorted, makeList(string2).sorted)

var longestMatch = new MyString("")
var (index1, index2) = (0,0)
while(index1 < list1.size && index2 < list2.size) {
  val lcs = list1(index1).longestCommonSubstring(list2(index2)) 
  if(lcs.length > longestMatch.length) longestMatch = lcs
  if(list1(index1) < list2(index2)) index1 += 1
  else index2 += 1
}

println(longestMatch) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T23:57:19.353

当您构造 MyString 时，您调用`arr = str.toCharArray();`which 创建字符串字符数据的新副本。但是在 Java 中，字符串是不可变的——那么为什么不存储对字符串的引用而不是其数据的副本呢？

您一次构造每个后缀，但一次只引用一个（嗯，两个）。如果您重新编码您的解决方案以仅引用它当前关心的后缀，并仅在需要它们时构建它们（然后丢失对它们的引用），它们可能会被 Java 垃圾收集。这将减少内存不足的可能性。比较存储 2 个字符串与存储数十万个字符串的内存开销：)

# javascript - HTML5视频结束倒计时

> ID：14491392
> 
> 赞同：4
> 
> 时间：2013-01-23T23:34:34.990
> 
> 标签：javascript, html, video, countdown

我可以倒计时到 HTML5 视频的结尾吗？

```
<video id="video" width="400" height="225" preload="auto">
    <source src="video.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />
</video>
<div id="countdown">Video ends after <span>XX</span> seconds.</div> 
```

我知道必须等待视频加载，然后如果加载了视频，则需要知道长度并运行视频和计数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T00:02:43.030

监听视频对象触发的 timeupdate 事件并更新剩余时间。

像这样的东西应该工作：

```
var video = document.getElementById('video');
video.addEventListener('timeupdate', updateCountdown);

function updateCountdown() {
    var timeSpan = document.querySelector('#countdown span');
    timeSpan.innerText = video.duration - video.currentTime;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:42:56.110

这应该为您解决问题

```
countdown = video.duration - video.currentTime 
```

请参阅[此处](http://www.w3schools.com/tags/ref_av_dom.asp)了解更多详细信息

# c# - 如何在 C# 控制台应用程序中设置出站/发送 IP 地址？

> ID：14491394
> 
> 赞同：1
> 
> 时间：2013-01-23T23:35:14.943
> 
> 标签：c#, sockets, networking

我的专用服务器有 5 个可用的静态 IP 地址。该服务器的主要目标是创建和维护到单个目的地的数百个连接。可以理解的是，在建立了几百个连接之后，我遇到了套接字读/写异常和大量断开连接。发生这种情况的原因可能是目的地识别出单一源 IP 地址并暂时阻止它，或者因为 A 和 B 之间的单一链路变得不稳定。

实际上，我想见证在多个源 IP 地址之间划分连接的结果。

到目前为止，我的研究使我得到了类似[这样](https://stackoverflow.com/questions/9141342/how-to-send-request-from-different-static-ip-address-to-a-any-website)的问题和答案，建议使用`ServicePoint.BindIPEndPointDelegate`.

但是，我想将整个控制台应用程序绑定到特定的 IP 地址。我该如何做到这一点？

注意：我目前正在使用 FluorineFX。如果存在一种解决方案来告诉 FluorineFX 从哪个 IP 地址进行连接，那也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:43:08.277

在 .NET 中使用 TCP 功能时，很容易指定源 IP 地址。如果您使用`TcpClient`，只需使用`TcpClient(IPEndPoint localEndPoint)`构造函数，它将绑定到指定的本地 IP 地址。对于使用`Socket`该类建立的连接，您需要使用`Bind(EndPoint localEP)`套接字上的方法将其与本地地址相关联。

# android - Trigger.io - 启动画面消失，但直到我点击屏幕才会加载 webview

> ID：14491397
> 
> 赞同：0
> 
> 时间：2013-01-23T23:35:29.673
> 
> 标签：android, kendo-ui, trigger.io

我有一个 android trigger.io 应用程序，我正在使用自定义启动屏幕。一旦这个初始屏幕消失，我有时会留下黑色/灰色渐变背景，而我的 webview 没有加载我的应用程序的内容（登录或配置页面）

当我试图立即显示 Kendo UI 模态窗口时（我将一个用于“欢迎使用应用程序”的第一次消息），这种情况似乎更频繁地发生，而当它没有显示时，这种情况发生的频率较低。

Trigger 和 Kendo 之间是否存在任何已知的兼容性问题，我应该注意修复或解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T21:19:20.547

这会在所有 Android 设备上发生，还是仅在具有 ICS（Android 4+）的设备上发生？

我在 ICS 上遇到了类似的问题。原来是CSS规则造成的`-webkit-transform: translate3d(0,0,0)`。

# python - 数据库驱动程序的 Gevent/Eventlet 猴子补丁

> ID：14491400
> 
> 赞同：9
> 
> 时间：2013-01-23T23:36:04.807
> 
> 标签：python, asynchronous, pymongo, gevent, eventlet

在进行 Gevent/Eventlet 猴子补丁之后 - 我可以假设每当 DB 驱动程序（例如*redis-py*、*pymongo*）通过标准库（例如`socket`）使用 IO 时，它都是异步的吗？

因此，使用 eventlets 猴子补丁就足以使例如：*redis-py*在 eventlet 应用程序中非阻塞？

据我所知，如果我关心连接使用（例如，为每个greenlet 使用不同的连接）就足够了。但我想确定。

如果您知道还需要什么，或者如何在 Gevent/Eventlet 中正确使用 DB 驱动程序，请同时输入。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-24T01:55:45.907

如果以下所有条件都属实，您可以假设它将被神奇地修补。

*   您确定 I/O 是建立在标准 Python`socket`或其他`eventlet`/`gevent`猴子补丁之上的。没有文件，没有本机 (C) 套接字对象等。
*   您传递`aggressive=True`给`patch_all`（或`patch_select`），或者您确定该库不使用`select`或类似的东西。
*   驱动程序不使用任何（隐式）内部线程。（如果驱动程序*确实*在内部使用线程，`patch_thread` *可能会*工作，但可能不会。）

如果您不确定，它很容易测试——可能比通读代码并尝试解决它更容易。有一个greenlet，它只是做这样的事情：

```
while True:
    print("running")
    gevent.sleep(0.1) 
```

然后让另一个对数据库运行慢查询。如果是monkeypatched，循环greenlet 将保持打印“运行”10 次/秒；如果没有，当程序在查询中被阻塞时，循环的 greenlet 将不会运行。

那么，如果您的驱动程序阻塞，您会怎么做？

最简单的解决方案是使用真正并发的线程池进行数据库查询。这个想法是您将每个查询（或批处理）作为线程池作业启动，并`gevent`在该作业完成时阻止您的。（对于非常简单的情况，您不需要很多并发查询，您可以只`threading.Thread`为每个查询生成一个，但通常您无法逃脱。）

如果驱动程序做了重要的 CPU 工作（例如，您正在使用运行进程内缓存的东西，甚至是像 sqlite 这样的整个进程内 DBMS），您希望这个线程池实际上是在进程之上实现的，否则GIL 可能会阻止您`greenlets`运行。否则（特别是如果您关心 Windows），您可能想要使用操作系统线程。（但是，这意味着您不能`patch_threads()`；如果您需要这样做，请使用流程。）

如果您正在使用`eventlet`，并且想要使用线程，那么有一个名为的内置简单解决方案[`tpool`](http://eventlet.net/doc/threading.html#tpool-simple-thread-pool)可能就足够了。如果您正在使用`gevent`，或者您需要使用流程，这将不起作用。不幸的是，在真正的线程对象上阻塞一个greenlet（不阻塞整个事件循环）在`eventlet`and之间有点不同`gevent`，并且没有很好地记录，但`tpool`源代码应该会给你这个想法。除了那部分之外，其余的只是使用[`concurrent.futures`](http://docs.python.org/3/library/concurrent.futures.html)（[`futures`](http://pypi.python.org/pypi/futures/2.1.3)如果您在 2.x 或 3.1 中需要，请参阅 pypi）来执行 a`ThreadPoolExecutor`或`ProcessPoolExecutor`. （或者，如果您愿意，您可以直接使用`threading`或`multiprocessing`代替使用`futures`。）

* * *

> 你能解释一下为什么我应该在 Windows 上使用操作系统线程吗？

简短的总结是：如果你坚持使用线程，你几乎可以只编写跨平台代码，但如果你使用进程，你实际上是在为两个不同的平台编写代码。

首先，阅读模块的编程[指南](http://docs.python.org/3/library/multiprocessing.html#programming-guidelines)`multiprocessing`（“所有平台”部分和“Windows”部分）。幸运的是，DB 包装器不应该遇到这种情况。您只需要通过`ProcessPoolExecutor`. 而且，无论您是在游标操作级别还是查询级别进行包装，您的所有参数和返回值都将是可以腌制的简单类型。不过，这是您必须小心的事情，否则不会成为问题。

同时，Windows 的进程内同步对象开销很低，但进程间同步对象开销很大。（它还具有非常快的线程创建和非常慢的进程创建，但如果您使用的是池，这并不重要。）那么，您如何处理呢？我在创建操作系统线程以等待跨进程同步对象并发出信号时获得了很多乐趣，但是您对乐趣的定义可能会有所不同。

最后，`tpool`可以很容易地适应`ppool`Unix，但在 Windows 上需要更多的工作（你必须了解 Windows 才能完成这项工作）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T09:27:38.890

abarnert 的回答是正确且非常全面的。我只想补充一点，eventlet 中没有“积极的”补丁，可能是 gevent 功能。此外，如果库使用`select`这不是问题，因为 eventlet 也可以对其进行修补。

实际上，在大多数情况下`eventlet.monkey_patch()`，您只需要。当然，必须在创建任何套接字之前完成。

如果您仍有任何问题，请随时打开问题或写信给 eventlet 邮件列表或 G+ 社区。所有相关链接都可以在[http://eventlet.net/找到](http://eventlet.net/)

# javascript - 如何检索所有标题，并显示特定播放列表中的所有描述和缩略图

> ID：14491401
> 
> 赞同：2
> 
> 时间：2013-01-23T23:36:10.910
> 
> 标签：javascript, api, youtube, youtube-api

我确信这是一个简单的问题，但我是 JavaScript 新手。此链接[retrieve-youtube-video-title](http://salman-w.blogspot.com/2010/01/retrieve-youtube-video-title.html)上的代码显示了如何检索单个youtube 缩略图、描述和标题等，并且可以正常工作。但是我怎样才能获得代码以从播放列表提要中显示相同的信息？我可以使用这个提要 URL：

```
http://gdata.youtube.com/feeds/api/playlists/719DC9340EXAMPLE?alt=json-in-script&format=5&... 
```

# c++ - c++异常和对union的不好读

> ID：14491402
> 
> 赞同：-1
> 
> 时间：2013-01-23T23:36:26.817
> 
> 标签：c++, exception

我有一个包含联合作为字段的类。联合是指向两个不同类的指针。作为第二个字段，我的类包含一个标志，通知当前存储的是哪种类型。

```
class Item {
    std::string *title;
    bool who_am_I;
    union { Submenu *smenu; Function *call; } content;
    public:
    bool am_I_a_submenu();
    bool am_I_a_function();
    Submenu *give_me_submenu();
    Function *give_me_function();
    /*(...)*/
}; 
```

现在，在每次使用我的“give_me”方法之前，我敦促用户通过访问标志的适当方法检查类型，即“am_I”方法。不过，如果用户碰巧忘记了它，我希望我的库抛出适当的异常。我可以在不检查“give_me”方法中的标志的情况下这样做吗？我问是因为这意味着在正常使用中该标志被不必要地检查了两次。

我想知道一旦出现类型冲突导致程序故障，c++ 是否会在构建异常中抛出一些异常以及何时会抛出一些异常。或者也许我应该以其他方式处理这种情况，最好还是不仔细检查标志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:41:56.443

好的，首先......你为什么要关心标志是否被检查了两次？这**真的**是你的产品中一个严重的性能瓶颈，分析表明必须优化吗？我**非常**怀疑。

但即使是性能瓶颈，还有什么更重要的呢？在我看来，一个*正常运行*且不会崩溃的应用程序对于极少量的额外开销来说是一个可以接受的折衷方案。

但是您可能应该重新设计您的界面，以便用户始终知道他拥有什么并且不会犯这样的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:41:48.417

无法检查 union 中存储的内容。如果您使用联合，则由您来确保始终访问正确的元素。读错是未定义的行为，不会抛出异常。

我不知道你在做什么，但我建议你根本不要使用`union`。这是一种节省一些内存的老式方法，不值得它可能引入的错误。在您的情况下，它根本不节省内存（由于内存对齐，前面的布尔值占用的内存与指针一样多）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T23:39:23.507

通过使用联合，您告诉编译器这两种类型是兼容的。通常从两者转换会导致编译时问题，因为没有用户指定的转换，也没有默认转换，但是由于您将其定义为联合，因此对这两种类型都有默认转换。

我假设在这种情况下额外调用检查布尔值可能不会太贵。

# javascript - Javascript按值将数组传递给函数，保持原始数组不变

> ID：14491405
> 
> 赞同：42
> 
> 时间：2013-01-23T23:36:55.797
> 
> 标签：javascript, arrays

我在这里阅读了许多关于“按值”和“按引用”传递将数组发送到 javascript 函数的答案。但是，我在将数组发送到函数并使原始数组保持不变时遇到问题。这个例子说明了这个问题：

```
function myFunction(someArray)
{
// any function that makes an array based on a passed array;
// someArray has two dimensions;
// I've tried copying the passed array to a new array like this (I've also used 'someArray' directly in the code);

funcArray = new Array();
funcArray = someArray;

var i = 0;

    for(i=0; i<funcArray.length; i++)
    {
    funcArray[i].reverse;
    }

return funcArray;

} 
```

我不明白为什么这个函数中的任何东西都应该改变原始数组。

如果将函数调用分配给新数组，则调用此函数会直接更改原始数组：

```
myArray = [["A","B","C"],["D","E","F"],["G","H","I"]];
anotherArray = new Array();

anotherArray = myFunction(myArray);
// myArray gets modified!; 
```

我尝试使用 .valueOf() 发送原语：

```
anotherArray = myFunction(myArray.valueOf());
// myArray gets modified!; 
```

我什至尝试将数组逐个元素和子元素分解，并将所有元素分配给一个新的二维数组，而原始数组仍然会被修改。

我还将子元素加入到一个字符串中，处理它们，将它们拆分回数组，原始数组仍然会被修改。

请问，有人知道我如何将数组值传递给函数而不改变传递的数组吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-01-23T23:40:47.383

在你的函数里面有这个：

```
funcArray = new Array();
funcArray = someArray; 
```

这实际上不会复制`someArray`而是引用它，这就是修改原始数组的原因。

您可以使用[`Array.slice()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/slice)数组创建所谓的浅表副本。

```
var funcArray = someArray.slice(0); 
```

原始数组将保持不变，**但**其每个元素仍将引用原始数组中的相应条目。对于“深度克隆”，您需要递归地执行此操作；以下问题讨论了最有效的方法：

[在 JavaScript 中深度克隆对象的最有效方法是什么？](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)

*顺便说一句，我之前添加`var`了`funcArray`。这样做会使它成为函数的局部变量，而不是全局变量。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-23T23:42:15.413

制作您可以使用的数组的副本。

一个简单的方法是使用`var clone = original.slice(0);`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-02-27T19:42:57.853

那么[解构赋值](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)（ES6+，检查[兼容性](http://kangax.github.io/compat-table/es6/#test-destructuring)）呢？漂亮干净的解决方案。

```
function myFunction(someArray) {

  for(let i = 0; i < someArray.length; i++)
  {
    someArray[i].reverse();
  }

  return someArray;
}

let myArray = [["A","B","C"],["D","E","F"],["G","H","I"]];

// Using destructuring assignment.
// NOTE: We can't just use `[...myArray]` because nested arrays will still be copied by reference.
let anotherArray = myFunction([...myArray.map(nested => [...nested])]);

console.log({original: myArray, copy: anotherArray});
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-12-28T02:13:00.407

使用 ES6，您可以使用[扩展语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)和[解构](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)直接在参数列表中执行浅拷贝，从而使原始数组保持不变。

请参见下面的示例：

```
const arr = [1, 2, 3, 4, 5];

function timesTen([...arr]) { // [...arr] shallow copy the array
  for(let i = 0; i < arr.length; i++) {
    arr[i] *= 10; // this would usually change the reference
  }
  return arr;
}

console.log(timesTen(arr));
console.log(arr); // unaltered
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-23T23:41:47.767

指向数组的变量是对它的引用。当你传递一个数组时，你正在复制这个引用。

您可以使用[`slice()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/slice). 如果你想要一个完整的深度复制，那么在子对象中递归，在复制一些对象时要记住注意事项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-20T01:24:48.697

如果您需要对一个对象执行此操作，请尝试这个花哨的技巧......

```
MY_NEW_OBJECT = JSON.parse(JSON.stringify(MY_OBJECT)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-23T23:41:59.930

一个通用的解决方案是......

```
// Use the JSON parse to clone the data.
function cloneData(data) {
  // Convert the data into a string first
  var jsonString = JSON.stringify(data);

  //  Parse the string to create a new instance of the data
  return JSON.parse(jsonString);
}

// An array with data
var original = [1, 2, 3, 4];

function mutate(data) {
  // This function changes a value in the array
  data[2] = 4;
}

// Mutate clone
mutate(cloneData(original));

// Mutate original
mutate(original); 
```

这适用于对象和数组。

当您需要深度克隆或者您不知道类型是什么时非常有效。

深度克隆示例...

```
var arrayWithObjects = [ { id: 1 }, { id: 2 }, { id: 3 } ];

function mutate(data) {
  // In this case a property of an object is changed!
  data[1].id = 4;
}

// Mutates a (DEEP) cloned version of the array
mutate(cloneData(arrayWithObjects));

console.log(arrayWithObjects[1].id) // ==> 2 
```

**警告**

*   使用 JSON 解析器进行克隆并不是最高效的选择！

*   它不克隆函数，只克隆 JSON 支持的数据类型

*   无法克隆循环引用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-23T09:30:27.247

默认情况下，javascript 中除了对象和数组之外，所有内容都是按值复制的，但如果您想对数组使用按值复制：使用 [yourArray].slice(0) 和对象使用 Object.assign(target, . ..来源）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-09-25T22:19:00.490

```
var aArray = [0.0, 1.0, 2.0];
var aArrayCopy = aArray.concat();
aArrayCopy[0] = "A changed value.";
console.log("aArray: "+aArray[0]+", "+aArray[1]+", "+aArray[2]);
console.log("aArrayCopy: "+aArrayCopy[0]+", "+aArrayCopy[1]+", "+aArrayCopy[2]); 
```

此答案已被编辑。最初我提出`new`操作员处理了解决方案，但很快就意识到了这个错误。相反，我选择使用 concat() 方法来创建副本。原来的答案没有显示整个数组，所以错误被无意中隐藏了。下面显示的新输出将证明此答案按预期工作。

```
aArray: 0, 1, 2
aArrayCopy: A changed value., 1, 2 
```

# java - 对 Java 集合进行排序和重复数据删除

> ID：14491408
> 
> 赞同：1
> 
> 时间：2013-01-23T23:37:07.503
> 
> 标签：java

我想实现以下目标，我有一个列表形式的日期集合，我想对其进行重复数据删除和排序。我正在使用 collections.sort 按日期升序对列表进行排序，然后使用 treeSet 从列表中复制和删除元素。这是2次射击的方法？有更快的一步法吗？

```
EDIT:: 

Metadata
{
 String name;
 Date sourceDate;
} 
```

基本上我想根据 sourceDate 订购 Metadata 对象并对其进行重复数据删除。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:38:42.440

您可以跳过这`Collections#sort`一步：`TreeSet`将删除重复项并对条目进行排序。所以基本上它是一个单行操作：

```
Set<Date> sortedWithoutDupes = new TreeSet<Date> (yourList); 
```

如果日期是对象中的一个字段，您可以：

*   让您的对象实现 Comparable 并根据对象的日期比较对象
*   或将 a`Comparator<YourObject>`作为参数传递给 TreeSet 构造函数，该构造函数按日期对对象进行排序

在这两种情况下，您都不需要对列表进行预先排序。

**重要的提示：**

TreeSet 用于`compareTo`比较键。因此，如果 2 个键具有相同的日期但不同的名称，则应确保您的 compare 或 compareTo 方法返回非 0 值，否则 2 个对象将被视为相等，并且只会插入一个。

**编辑**

代码可能如下所示（未经测试+您应该处理空值）：

```
Comparator<Metadata> comparator = new Comparator<Metadata>() {
    @Override
    public int compare(Metadata o1, Metadata o2) {
        if (o1.sourceDate.equals(o2.sourceDate)) {
            return o1.name.compareTo(o2.name);
        } else {
            return o1.sourceDate.compareTo(o2.sourceDate);
        }
    }
};

Set<Metadata> sortedWithoutDupes = new TreeSet<Metadata> (comparator);
sortedWithoutDupes.addAll(yourList); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:38:54.070

TreeSet 将自动对其元素进行排序，因此您不需要在添加到集合之前对列表进行排序。

# ms-access - MS Access 查询时双击事件

> ID：14491409
> 
> 赞同：0
> 
> 时间：2013-01-23T23:37:09.960
> 
> 标签：ms-access, vba, ms-access-2007, crosstab

MS Access 2007，Win 7 32 位

有没有办法可以访问数据表视图中的打开查询以获取当前字段值和当前字段名称？

我不会把它放到一个表单中，因为它是一个交叉表查询，我必须动态地生成和删除控件，但我不喜欢用 VBA 那样弄乱表单控件。我知道我可以放置一个动态列报告并在控件上绑定一个事件，但我问是否有事件或对象可以让我直接访问查询。

也许是记录集克隆？但我在谷歌上没有找到任何东西。

当然这是在 VBA 中

此致，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T14:19:34.513

也可以输入[MacDermott的代码](http://www.pcreview.co.uk/forums/getting-index-controls-property-vba-t1158911.html)来获取当前控件的索引，这样xtab查询子窗体上选中的当前控件就动态显示了

```
Public Function ControlIndex(ctl as Control) as long
 Dim i as Integer
  For i=0 to Me.Controls.Count-1
   if me.Controls(i) is ctl then
    ControlIndex=i
   exit for
  end if
  next
 End Function 
```

最后，当在同一记录中从一个控件更改为另一个控件以保持文本框最新时，[这会有所帮助。](https://stackoverflow.com/questions/10655262/active-control-change-event-msaccess)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:31:20.637

有可能解决您的要求。交叉表包含在一个子表单中：

```
Source Object : Query.xtab 
```

![交叉表](../Images/aabfb20bd2945811a9bda14437b6f1bf.png)

两个文本框的控制源是：

```
Ctrl   : =[screen].[activecontrol].[name]
Content: =[screen].[activecontrol] 
```

这意味着它们会显示用户在交叉表子表单中选择的列和列内容。但是，它们还将在表单上显示任何其他选定的控件。ClickMe 不会更改所选控件，因此所选项目在文本框中保持不变。

# expressionengine - 基于 url 段的 ExpressionEngine 内容

> ID：14491412
> 
> 赞同：0
> 
> 时间：2013-01-23T23:37:25.983
> 
> 标签：expressionengine

我刚刚学习 EE，我有以下示例 url， http: [//mydomain.com/work/preview/clientname](http://mydomain.com/work/preview/clientname)

我希望客户端名称与我设置的频道字段（“ *client_name* ”）匹配，并且仅当它与该频道字段匹配时才拉入频道内容。

例如，如果特定条目的指定频道字段“client_name”是“google” ，则[http://mydomain.com/work/preview/google将显示频道内容。](http://mydomain.com/work/preview/google)

我知道如何使用以下内容从频道“视频”中提取内容：

```
{exp:channel:entries channel="videos"}
    {title}
{/exp:channel:entries} 
```

...但是我如何为不同的 url 段实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T03:57:30.123

我相信您正在寻找的是按字段名称[搜索频道条目标签。](http://ellislab.com/expressionengine/user-guide/modules/channel/channel_entries.html#search-field-name)

这是一个例子：

```
{exp:channel:entries channel="videos" search:client_name="google"}
    {title}
{/exp:channel:entries} 
```

请记住，如果您想为此使用段，则可能必须将段作为变量通过嵌入传递。您可以[在此处阅读相关内容](http://ellislab.com/expressionengine/user-guide/templates/embedding.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-13T12:33:52.577

进行此更改对我有用：

```
{exp:channel:entries channel="videos" dynamic="no" search:client_name="segment_2"}
{title}
{/exp:channel:entries} 
```

# file - 在 vim 中查找文件：如何使用 Explore **/* 进行部分文件名匹配

> ID：14491421
> 
> 赞同：2
> 
> 时间：2013-01-23T23:38:26.883
> 
> 标签：file, search, vim

我最近发现了以下在 Vim 中查找文件的方法。

```
 :Explore **/[pattern] 
```

查找文件对我来说非常重要，我不敢相信我已经完成了 8 年。我可以理解这位先生所说的话：http: [//vim.wikia.com/wiki/Find_files_in_subdirectories](http://vim.wikia.com/wiki/Find_files_in_subdirectories)

我看到人们在 TextMate 中搜索文件，不得不羞愧地低下头 :(

因此，使用上面的方法，我可以“理论上”搜索文件，但输出让我感到困惑，并且经常有不匹配的文件。我将使用 Rails 示例。

例如这样做：

```
Explore **/envir* 
```

产生这个，一堆额外的奇怪文件：

```
../
deploy/
environments/
initializers/
locales/
.DS_Store
application.rb
authorization_rules.rb
boot.rb
config.yml
database.yml
deploy.rb
development.sphinx.conf
environment.rb
production.sphinx.conf
routes.rb
sphinx.yml
staging.sphinx.conf
test.sphinx.conf 
```

这至少是可用的，我可以向下滚动到 environment.rb 并打开它。

但是假设我想找到所有助手的列表。我认为这是：

```
Explore **/*help* 
```

可以，但找不到文件。

有人可以照亮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T08:47:27.847

不，`:Ex[plore] **/foo*`糟透了。

上面提到的 CtrlP 是一种美（尽管有一些限制，但我广泛使用），它允许您在项目中查找文件和其他细节。[FuzzyFinder](http://www.vim.org/scripts/script.php?script_id=1984)和[Command-T](http://www.vim.org/scripts/script.php?script_id=3025)是值得的选择，[LustyExplorer](http://www.vim.org/scripts/script.php?script_id=1890)也是如此，显然还有很多其他选择。

但是 Vim 本身就很有能力。`wildmenu`选项是关键，在这里。只需将这两行添加到您的`~/.vimrc`：

```
set wildmenu           " see :h 'wildmenu'
set wildmode=list:full " see :h 'wildmode' for all the possible values 
```

使用上面的设置，以下命令会向您显示一个准确的匹配列表，您可以轻松且相对直观地导航。

```
:e **/foo*<Tab>        " see :h starstar 
```

如果“工作目录”设置为您的项目目录，那么该命令肯定会给您带来良好的结果。它不是很性感（不过我喜欢它），但它*非常*有效和可靠。当然，这种方法可以与`:sp`,`:vs`或一起使用`:tabe`。

该`:find`命令甚至更好，可能更适合您的需求：它查看`path`选项中定义的目录。`:set path=/path/to/project`在会话开始时，您可以使用以下命令打开项目中的任何文件：

```
:find foo<tab>         " see :h :find 
```

整洁的。

另一种可能性是使用“args”。您将所有匹配某种模式的文件添加到“参数列表”并使用缓冲区导航命令：

```
:argadd ./**/*.js      " see :h arglist
:sb foo<tab> 
```

但这可能有点混乱。

总的来说，在 Vim 中处理文件导航有很多优雅的方法（我什至没有提到`tags`基于 - 的导航！）。插件可以为许多导航需求提供一个很好的统一 UI，但它们不是有效查找文件所必需的。完全没有。

有趣的是，TextMate 和 Sublime Text 的模糊搜索实现实际上都仅限于当前的“项目”，而这些 Vim 插件或 Vim 的内置文件处理并非如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T23:41:20.157

你看过 Ctrl-P.vim 插件吗？[https://github.com/kien/ctrlp.vim](https://github.com/kien/ctrlp.vim)

此插件以与您显示的内容类似的方式查找文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T08:46:39.497

如果您想要的只是简单的 :find 类型功能，但部分文件名与选项卡自动完成匹配，那么[find-complete](http://www.vim.org/scripts/script.php?script_id=4426)插件很好。

# python - 使用python代码连接路由器时出错

> ID：14491422
> 
> 赞同：0
> 
> 时间：2013-01-23T23:38:35.397
> 
> 标签：python, pyserial, pexpect

我正在尝试使用上面的代码连接到某个路由器，我正在使用 juniperj2320.py 模块，在测试文件中我正在使用来自此[http://subversion.assembla.com/svn/clauzsistel08/trunk/dist/的代码库](http://subversion.assembla.com/svn/clauzsistel08/trunk/dist/)

```
#!/usr/bin/python
 from localconf import *
 from juniperj2320 import *
 import sys
 import traceback

 SERIALDEVICE = '/dev/ttyUSB0'

 # Now configure the router
 try:
    router = JuniperJ2320(SERIALDEVICE)

 except RouterConfigurationException, err:
    print "Router configuration error: ", err
    print "Please try again."
    sys.exit(1) 
```

但我收到以下错误

```
    ./test.py
    > /root/pyserial-2.6/examples/serialrouter.py(37)__init__()
    -> serial.Serial.__init__（自我，串行设备，波特率=波特率，\
    (pdb) c
    回溯（最近一次通话最后）：
      文件“./test.py”，第 30 行，在
        路由器 = JuniperJ2320（串行设备）
      文件“/root/pyserial-2.6/examples/juniperj2320.py”，第 32 行，在 __init__
        字节大小、奇偶校验、停止位、超时）
      文件“/root/pyserial-2.6/examples/serialrouter.py”，第 44 行，在 __init__
        fdpexpect.fdspawn.__init__(self, self.fileno())
      __init__ 中的文件“/usr/lib/python2.6/site-packages/fdpexpect.py”，第 40 行
        spawn.__init__(self, None, args, timeout, maxread, searchwindowsize, logfile)
      文件“/usr/lib/python2.6/site-packages/pexpect.py”，第 412 行，在 __init__
        self.closed = True # 类似文件的对象。
    AttributeError：无法设置属性

```

并且绝对不知道这里发生的事情！任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:05:25.960

这有点像在黑暗中拍摄，因为我不熟悉您正在使用的模块，但根据回溯，看起来构造函数需要一个类似文件的对象，而不仅仅是文件路径. 试试这个。

```
SERIALDEVICE = '/dev/ttyUSB0'

# Now configure the router
try:
    router = JuniperJ2320(open(SERIALDEVICE)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T15:07:17.983

与其编写自己的串行通信程序，不如让 pexpect 驱动像 minicom 这样的串行程序会更容易吗？

# graphics - MPEG4 3DMC Mesh 编码算法软件

> ID：14491424
> 
> 赞同：0
> 
> 时间：2013-01-23T23:38:39.530
> 
> 标签：graphics, mesh, mpeg-4

我想知道在哪里可以找到 MPEG4 标准中出现的 3DMC 网格编码算法的良好 C/C++ 实现。

谢谢，德巴拉蒂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:24:17.223

[http://www.mymultimediaworld.com/](http://www.mymultimediaworld.com/)

是地方，

SC3DMC 是准确的标准，它比旧的 3DMC 标准具有更快的解码速度。

该实现在 Windows 中运行良好，在 linux 中需要一些 tweeks，

最好的，

鲁法尔

# php - 使用 PDO 回显显示表中的所有行

> ID：14491430
> 
> 赞同：6
> 
> 时间：2013-01-23T23:39:09.337
> 
> 标签：php, pdo

我正在尝试使用 PDO 回显表的所有行，但遇到了麻烦。

用旧的做事方式，我会这样做

```
$result = mysql_query($sql);
while ($row = mysql_fetch_array($result)){
   $title= $row['title'];
   $body= $row['body'];
} 
```

但是我正在尝试使用 PDO；

```
$result = $db->prepare("SELECT title, body FROM post");
$result->execute();

while ($row = $db->fetchAll(PDO::FETCH_ASSOC))
{
$title = $row['title'];
$body = $row['body'];
}

echo $title;
echo $body; 
```

这一直给我打电话给未定义的方法 PDO::fetchAll()

执行手册中给出的示例

```
<?php
$sth = $dbh->prepare("SELECT name, colour FROM fruit");
$sth->execute();

/* Fetch all of the remaining rows in the result set */
print("Fetch all of the remaining rows in the result set:\n");
$result = $sth->fetchAll();
print_r($result);
?> 
```

有效，但我认为我无法像使用 $row=['blah']; 那样控制各个列 我呢？它也像这样打印出来；相当丑陋：

> Array ( [0] => Array ( [title] => 这是数据库中输入的测试标题[0]

需要做什么才能正确使用 PDO 来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T23:47:36.293

改变：

```
while ($row = $db->fetchAll(PDO::FETCH_ASSOC))
{
$title = $row['title'];
$body = $row['body'];
} 
```

到：

```
while ($row = $result->fetch(PDO::FETCH_ASSOC))
{
$title = $row['title'];
$body = $row['body'];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:48:29.770

> 这一直给我打电话给未定义的方法 PDO::fetchAll()

这应该给你提示，你正在使用错误的对象。如您在第二个示例中所见，它是[PDOStatement::fetchAll ，或者如果您想在 while 循环](http://php.net/pdostatement.fetchall)[PDOStatement::fetch](http://php.net/pdostatement.fetch)中使用它：

```
while ($row = $result->fetch(PDO::FETCH_ASSOC))
{
    $title = $row['title'];
    $body = $row['body'];
} 
```

补充笔记：

1.  `$result`是一个误导性的变量名称，正如您从该`$result->execute()`行中看到的那样。您不执行*结果*，而是执行*语句*。这就是为什么在手册中使用`$stmt`或`$sth`（我猜是语句句柄）。
2.  这些`echo`行应该在while循环内，否则你一次又一次地覆盖，然后只输出最后一行。

# c# - 用 C# 播放 .wav 文件

> ID：14491431
> 
> 赞同：9
> 
> 时间：2013-01-23T23:39:23.300
> 
> 标签：c#

我正在尝试播放位于我项目内的文件夹中的 .Wav 文件。

声音文件位于“Resource/Sounds/slot_roll_on.Wav”

资源文件夹是我自己创建的文件夹，在项目的根目录中。

这是我用来运行 .wav 文件的代码

```
 Assembly a = Assembly.GetExecutingAssembly();
        Stream s = a.GetManifestResourceStream("kisscam.g.resources.Resources.Sounds.slot_roll_on.wav");
        SoundPlayer snd = new SoundPlayer(s);
        snd.Play(); 
```

我无法播放声音，我不断收到 windows 声音，因为没有找到声音。

在堆栈溢出的某个地方，我发现了这段代码来找到正确的汇编路径应该是什么。

```
 Assembly a = Assembly.GetExecutingAssembly();
            string[] resourceNames = Assembly.GetExecutingAssembly().GetManifestResourceNames();
            int i;
            for (i = 0; i < resourceNames.Length; i++)
            {

                MessageBox.Show(resourceNames[i]);

            } 
```

它输出这两条路径

```
kisscam.Properties.Resources.resources 
```

和

```
kissscam.g.resources 
```

我尝试同时使用它们，但它们都不起作用。

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-24T00:37:52.037

通过转到您的项目属性-> 资源选择音频并浏览到文件，将您的 Wav 文件添加到资源中。然后，您将能够将其视为 pf 部分`Propeties.Resources`。它会将其添加到资源文件夹中，您可以在其中将其设置为嵌入或保持原样，将其设置为内容

![在此处输入图像描述](../Images/ce8cfe8411ac28b000ce741ddb2d5a1d.png)

像这样访问

```
private void button1_Click(object sender, EventArgs e)
{
    SoundPlayer snd = new SoundPlayer( Properties.Resources.tada);
    snd.Play();

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-05T15:42:31.187

如果您想通过在项目中播放**.wav**文件来在程序中添加音乐。然后你必须像这样添加**.wav**文件。

```
 using System.Media; //  write down it at the top of the FORM

   SoundPlayer my_wave_file = new SoundPlayer("F:/SOund wave file/airplanefly.wav");
   my_wave_file.PlaySync(); // PlaySync means that once sound start then no other activity if form will occur untill sound goes to finish 
```

请记住，文件的路径必须用**正斜杠**（/）格式写入，在给文件路径时不要使用**反斜杠**（），否则会报错

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-24T02:29:38.470

目前我知道两种方法，见下文：

1.  **使用文件路径**
    先把文件放在项目的根目录下，然后无论你在`Debug`还是`Release`模式下运行程序，都可以肯定地访问到文件。接下来使用该类`SoundPlayer`来播放它。

    ```
     var basePath = System.AppDomain.CurrentDomain.BaseDirectory;
        SoundPlayer player = new SoundPlayer();
        player.SoundLocation = Path.Combine(basePath, @"./../../Reminder.wav");
        player.Load();
        player.Play(); 
    ```

2.  **使用资源**
    按照下面的动画，将“现有文件”添加到项目中。

[![在此处输入图像描述](../Images/f0972a33f2ec89e910285b0946dceff3.png)](https://i.stack.imgur.com/dLQrG.gif)

```
 SoundPlayer player = new SoundPlayer(Properties.Resources.Reminder);
        player.Play(); 
```

这种方式相对于其他方式的优势在于：
运行程序时只需要复制“bin”目录下的“Release”文件夹即可。

# javascript - 在 ng-repeat 中访问模型

> ID：14491433
> 
> 赞同：2
> 
> 时间：2013-01-23T23:39:35.890
> 
> 标签：javascript, html, angularjs

我有一个`ng-repeat`循环`processes`。我想要做的是通过带有选择框的表单`block`向当前添加一个新的。`process`但是，我的问题是我无法从控制器访问循环内的模型。`ng-repeat`我想这是因为在循环中创建了一个新范围。

我仍然找不到从控制器访问模型的方法。这是 html 和 javascript 代码片段，让您更好地理解问题。

```
<div class="container" ng-controller="ProcessCtrl">
    <div class="process" ng-repeat="process in processes">
        <form class="form-inline" ng-submit="addBlock($index)">
            <select ng-model="blockType">
                <option value="1">type1</option>
                <option value="2">type2</option>
                <option value="3">type3</option>
            </select>
            <button type="submit">add</button>
        </form>
    </div>
</div> 
```

angularjs控制器

```
function ProcessCtrl($scope, $filter) {
    //...

    $scope.addBlock = function(index) {
        alert($scope.blockType); // undefined
        $scope.processes[index].blocks.push({type: $scope.blockType});
    };
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:43:54.303

是的，问题是父作用域无法访问由 ng-repeat 创建的子作用域。

修改 addBlock 以同时传递 blockType：

```
ng-submit="addBlock($index, blockType)" 
```

# sql - SQL Compact Edition LEFT OUTER JOIN 平均

> ID：14491434
> 
> 赞同：0
> 
> 时间：2013-01-23T23:39:46.030
> 
> 标签：sql, join, sql-server-ce, left-join, outer-join

我有一张带有产品的表格和一张带有评级的表格。我有以下查询；

```
SELECT products.name, ratings.rating 
FROM   products 
       LEFT OUTER JOIN ratings 
       ON products.id = ratings.product_id; 
```

分别返回给我一个很好的行列表，其中包含产品名称和每个评级。

我试图实现它返回一行，显示产品名称及其平均评分。似乎无法找出如何。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:43:08.713

您想查看[GROUP BY 语句](http://msdn.microsoft.com/en-us/library/ms177673.aspx)。例子：

```
SELECT products.name AS Product_Name, 
       AVG(ratings.rating) AS Average_Rating
FROM   products 
       LEFT OUTER JOIN ratings 
       ON products.id = ratings.product_id
GROUP BY products.name
ORDER BY products.name; 
```

* * *

在使用 GROUP BY 语句时，您可能希望根据一个或多个聚合函数的结果过滤结果集。您使用[HAVING 语句](http://msdn.microsoft.com/en-us/library/ms180199.aspx)来执行此操作：

```
SELECT products.name AS Product_Name, 
       AVG(ratings.rating) AS Average_Rating
FROM   products 
       LEFT OUTER JOIN ratings 
       ON products.id = ratings.product_id
GROUP BY products.name
HAVING AVG(ratings.rating) >= 3
ORDER BY products.name; 
```

# sql-server - SQL XML 查询帮助

> ID：14491435
> 
> 赞同：0
> 
> 时间：2013-01-23T23:39:56.210
> 
> 标签：sql-server, xquery

我在 SQL Server 2008 数据库中有一个表，其中包含一个包含 XML 数据的 nvarchar(MAX) 列。数据代表搜索条件。下面是搜索条件的 XML 的样子，其中一个顶级“OR”组包含一个单一条件和一个嵌套的两个条件“AND”组。

```
<?xml version="1.0" encoding="utf-16"?>
<SearchCriterionGroupArgs xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <SingleCriteria>
    <SearchCriterionSingleArgs>
      <Operator>Equals</Operator>
      <Value>test</Value>
      <FieldIDs>
        <int>1026</int>
        <int>478</int>
      </FieldIDs>
      <EntityID>92</EntityID>
    </SearchCriterionSingleArgs>
  </SingleCriteria>
  <GroupCriteria>
    <SearchCriterionGroupArgs>
      <SingleCriteria>
        <SearchCriterionSingleArgs>
          <Operator>GreaterThan</Operator>
          <Value>2010-01-23</Value>
          <FieldIDs>
            <int>1017</int>
          </FieldIDs>
          <EntityID>92</EntityID>
        </SearchCriterionSingleArgs>
        <SearchCriterionSingleArgs>
          <Operator>LessThan</Operator>
          <Value>2013-01-23</Value>
          <FieldIDs>
            <int>1018</int>
          </FieldIDs>
          <EntityID>92</EntityID>
        </SearchCriterionSingleArgs>
      </SingleCriteria>
      <GroupCriteria />
      <EntityID>92</EntityID>
      <LogicalOperator>AND</LogicalOperator>
    </SearchCriterionGroupArgs>
  </GroupCriteria>
  <EntityID>92</EntityID>
  <LogicalOperator>OR</LogicalOperator>
</SearchCriterionGroupArgs> 
```

给定一组 FieldID 值的输入，我需要搜索表以查找是否有任何记录的搜索条件引用其中一个值（这些在“FieldIDs”节点下的“int”节点中表示。）

通过运行此查询：

```
select CAST(OptionalConditions as xml).query('//FieldIDs')
from tblMyTable 
```

我得到结果：

```
<FieldIDs>
  <int>1026</int>
  <int>478</int>
</FieldIDs>
<FieldIDs>
  <int>1017</int>
</FieldIDs>
<FieldIDs>
  <int>1018</int>
</FieldIDs> 
```

（目前表中只有一条记录，其中包含 xml 数据。）

但是我才刚刚开始使用这些东西，我不知道检查这些列表是否存在任意一组 FieldID 的符号是什么。我不需要检索任何特定节点，只需要判断输入字段 ID 是否在搜索中的任何位置引用即可。

谢谢你的帮助！

编辑：使用Ranon的解决方案，我使用这样的查询让它工作：

```
SELECT *
FROM myTable
WHERE CAST(OptionalConditions as xml).exist('//FieldIDs/int[.=(1019,111,1018)]') = 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:35:04.030

获取所有 FieldID 并将它们与要检查的设置 id ID 进行比较。XQuery 的`=`-operator 以基于集合的语义进行比较，因此如果左侧的 ID 之一与右侧的 ID 相等，则此表达式的计算结果为 true。

```
//FieldIDs/int = (42, 478) 
```

由于“478”是一个 FieldID，因此该查询将返回 true。“42”是一个不可用的。

我不确定您是否能够将结果转换为某种 sql-server-boolean-type，因为我还没有运行它，但您可以轻松地自己尝试。

* * *

如果您也对包含的节点感兴趣，可以使用以下查询：

```
//FieldIDs/int[. = (42,478)] 
```

# php - php 和 asp.net 可以使用同一个数据库吗？

> ID：14491437
> 
> 赞同：-3
> 
> 时间：2013-01-23T23:40:02.373
> 
> 标签：php, asp.net, .net, sql, database

我使用 php，但有一个用 .net 编写的程序，我想从中提取数据。该公司愿意与我合作并允许我提取数据......但我对.net一无所知，所以我不知道我是否能够使用php或者我是否会必须雇用精通.net 的人。任何帮助是极大的赞赏 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:44:39.000

几乎可以肯定 .net 应用程序与[SQL Server](http://php.net/manual/en/book.mssql.php)对话。连接起来很简单。不管是什么数据库，很可能至少有 ODBC 驱动程序。所以理论上你应该能够与任何数据库交谈。

[这是](http://php.net/manual/en/refs.database.vendors.php)php 原生支持的数据库列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:44:41.407

PHP 支持许多数据库。请参阅此列表： http: [//php.net/manual/en/refs.database.php](http://php.net/manual/en/refs.database.php)

# yii - 为 yii 使用 javascript 变量

> ID：14491438
> 
> 赞同：0
> 
> 时间：2013-01-23T23:40:03.500
> 
> 标签：yii, datatable

我有一个控制器，它输出一个用于绘制带有 highcharts 的图形的 json

1-首先我必须选择一个时间范围，将 timepicker 开始日期和结束日期变量传递给我的控制器，并根据这个时间获取数据并生成图表。

2-现在想要使用相同的 json 输出来绘制相同的数据，但以表格格式。

我可以使用 highchart 代码中使用的开始日期和结束日期来绘制带有数据表的表格吗？

我的 json 看起来像这样

```
{"name":"sensor_1","data":[["2012-12-01 15:00:00.070",45],["2012-12-01 15:00:00.281",95],["2012-12-01 15:00:00.883",104]]  ........]},"name":"sensor_2","data":[[]........]} 
```

我用了这段代码

```
 $(document).ready(function(){ 

var startDateTextBox = $('#startDate');  ///  start date  passed to yii controller
var endDateTextBox = $('#endDate'); 

$("#btnSubmit").click(function() {
    if(startDateTextBox.val()!="" && endDateTextBox.val()!=""){
        $.ajax({
            type: "get",
            url: "<?php echo                  
                    CController::createUrl('ecg/GetSensorsData'); ?>",
            data: {"ecgId" : "<?php echo $modelsensors['node_id'] ;?>" , 
                  "sDate": $('#startDate').val() , "eDate": $('#endDate').val()},
            dataType:"json",
            success: function(response, status) {                   
                var chart;                      

                chart = new Highcharts.Chart({                   
                    chart: {                         
                        renderTo: 'container',
                         type: 'spline'                         
                    },  
                    },
                    xAxis: {
                        type: 'datetime',
                    },    
                    },
                    series: response
                });                     
            },
            error: function (response, status) {
                    alert("An error occured while loading 
                                          data!");
            }
        });
    }
    else
    {
        alert("Choose date range!")
           }   
});
startDateTextBox.datetimepicker({ 
    //showSecond: true,
    dateFormat : 'yy-mm-dd',
    timeFormat: 'HH:mm ',
    stepHour: 1,
    stepMinute: 1,
    //stepSecond: 0.5,

    onClose: function(dateText, inst) {
        if (endDateTextBox.val() != '') {
            var testStartDate = 
                  startDateTextBox.datetimepicker('getDate');
            var testEndDate = endDateTextBox.datetimepicker('getDate');
            if (testStartDate > testEndDate)
                endDateTextBox.datetimepicker('setDate', 
                                                       testStartDate);
        }
        else {
            endDateTextBox.val(dateText);
        }
    },
    onSelect: function (selectedDateTime){
        endDateTextBox.datetimepicker('option', 'minDate',            
            startDateTextBox.datetimepicker('getDate') );
    }
});

endDateTextBox.datetimepicker({ 
    showSecond: true,
    dateFormat : 'yy-mm-dd',
    timeFormat: 'HH:mm:ss',
    stepHour: 1,
    stepMinute: 1,
    stepSecond: 0.5,
    onClose: function(dateText, inst) {
        if (startDateTextBox.val() != '') {
            var testStartDate = startDateTextBox.datetimepicker('getDate');
            var testEndDate = endDateTextBox.datetimepicker('getDate');
            if (testStartDate > testEndDate)
                startDateTextBox.datetimepicker('setDate', testEndDate);
        }
        else {
            startDateTextBox.val(dateText);
        }
    },
    onSelect: function (selectedDateTime){
        startDateTextBox.datetimepicker('option', 'maxDate', 
          endDateTextBox.datetimepicker('getDate') );
    }
});
      });
      </script> 
```

在我看来，我获取所有数据，我想做与 highchart 相同的操作（过滤数据）

```
 <tbody>
 <?php  if(count($modelSensors)>=1) {
 foreach($modelSensors as $models) : ?>
 <tr>
 <td>  <?php echo $models['information_sensor_id'] ; ?> </td>
 <td> <?php echo $models['information_sensor_time'] ; ?> </td>
  <td> <?php echo $models['information_sensor_value'] ; ?> </td>    
  <td> <?php echo $models['sensor_id'] ; ?> </td>                                                 
  </tr>
  <?php endforeach; 
  }else {?>

   <tr>
   <td colspan='2' style="text-align:center;">Sorry no data found for this Node</td>
   </tr>
   <?php } ?>
  </tbody> 
```

编辑：

```
 var_dump($modelSensors);
    array
    0 => 
    object(SensorInfo)[1384]
     private '_md' (CActiveRecord) => 
    object(CActiveRecordMetaData)[85]
        public 'tableSchema' => 
        object(CMysqlTableSchema)[98]
          ...
      public 'columns' => 
        array
          ...
      public 'relations' => 
        array
          ...
      public 'attributeDefaults' => 
        array
          ...
      private '_model' => 
        object(SensorInfo)[84]
          ...
      private '_new' (CActiveRecord) => boolean false
       private '_attributes' (CActiveRecord) => 
       array
      'information_sensor_id' => string '1' (length=1)
      'information_sensor_time' => string '2012-12-01 15:00:00' (length=19)
      'information_sensor_value' => string '95' (length=2)
      'sensor_id' => string 'sensor1' (length=7)
       .................... 
```

# c++ - C ++：将父类转换为子类

> ID：14491440
> 
> 赞同：10
> 
> 时间：2013-01-23T23:40:13.200
> 
> 标签：c++, oop, class, inheritance, casting

我对 C++ 相当陌生，这就是我遇到的问题：我有两个类，`Client`并且`Host`. 当所有内容都加载完毕后，您可以选择按下两个按钮，如果按下按钮 1`Client`则加载，如果按下按钮 2`Host`则加载。

现在两者`Client`都是`Host`相当大的类，我不想把它们都放在记忆中。所以我的想法是创建一个`Base`类，然后两者都`Client`应该`Host`扩展基类，然后我唯一要做的就是：

```
Base connection;

//If button 1 is pressed:
connection = Client();

//If button 2 is pressed:
connection = Host(); 
```

好吧，这听起来好得令人难以置信，当我尝试它时，我没有收到任何错误。现在问题来了，`Base`有一个名为 的函数`A`，`Client`还有一个名为 的函数`B`。所以这个函数`B`是类独有的`Client`。

当我尝试调用函数时，`B`我收到此错误：`'class Base' has no member named 'B'`. 我怎样才能让 C++ 知道我正在与班级交谈`Client`或`Host`代替`Base`？我也愿意采用全新的方法来解决这个问题。也许这只是我思维过程中的一个错误。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T23:46:26.300

您遇到了我们称之为*对象切片*的情况，这是具有*值语义*的语言（如 C++）中的常见问题。

当您将子类型的值分配给`connection`超类型的新位置（您的变量）时，就会发生对象切片。这引入了实例的新副本，但它是超类型，而不是子类型，因此您丢失了有关您想要实例化的具体类的信息。

为避免这种情况，您有多种选择。

*经典*方法使用**指针**：

```
Base * connection;
connection = new YourConcreteType(); 
```

然后，要使用此对象，您必须使用星号运算符 ( ) 取消对它的*引用*`*`：

```
(*connection).function();
connection->function();    // syntactic sugar, semantically equivalent 
```

不要忘记：您必须在使用后*删除*对象：

```
delete connection; 
```

为了简化这一点，C++ 引入了两个概念：**引用**和**智能指针**。虽然前者有一个限制，只能分配*一次*，但它是语法上最简单的一个。后者类似于指针方法，但您不必关心删除，因此您不太可能遇到内存泄漏情况：

```
std::shared_ptr<Base> connection;

connection = make_shared<YourConcreteType>(); // construction via 'make_shared'

// ... use as if it were just a pointer ...

connection->function();

// no delete! 
```

还有其他“智能指针”类型，例如`unique_ptr`，如果您不打算传递指针（如果它保持*在范围内*），可以使用它们。

现在，您可以分别实现两个类中的功能。为了利用多态性，这意味着在运行时，要么调用一个子类的函数，要么调用另一个子类的函数，这取决于构造了哪个，你应该将基类中的函数声明为 is `virtual`，否则，函数`Base`无论您构造的具体类型如何，都会调用定义。

在您的情况下，您想要调用一个应该根据类型执行不同操作的函数。虽然您的方法是引入两个不同的函数，即`A`and `B`，但您可以只声明一个函数，让我们将其`handleEvent`称为基类中的*纯虚拟*（=抽象）函数，这意味着“此函数将在子类中实现classes”，并在两个子类中独立定义：

```
Base {
    ....
    virtual void handleEvent(...) = 0; // "= 0" means "pure"
};

// Don't provide an implementation 
```

```
Client {
    void handleEvent(...); // override it
};

// define it for Client:
void Client::handleEvent(...) {
    ...
} 
```

```
Host {
    void handleEvent(...); // override it
};

// define it for Host:
void Host::handleEvent(...) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T23:46:08.533

当你这样做时：

```
Base connection; 
```

您创建的对象`connection`恰好具有 type 所需的内存`Base`。

当你这样做时：

```
connection = Client(); 
```

您没有扩展分配的内存或转换`connection`为`Client`实例。相反，您正在创建一个更大的对象，该对象被“切片”成一个较小的对象。

您想要做的是使用指针（或引用或智能指针），以便您保留的只是可能是一种类型或另一种类型的对象的地址。像这样：

```
Base *connection;
...
connection = new Client(); 
```

第一条语句创建一个指向`Base`类型化对象的指针，第二条语句为类型化对象分配内存，对其进行`Client`初始化并将其地址分配给`connection`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T23:47:55.450

如果您仍然想使用 Base ，那么您将不得不这样做才能使用这些功能：

```
if (Button1) {
    dynamic_cast<Client*>(connection)->A();
} else {
    dynamic_cast<Host*>(connection)->B();   
} 
```

您需要将连接设为指针。`Base * connection`.

不过，这并不理想。您应该像其他答案一样研究一种不同的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-23T23:49:15.817

首先，这条线

```
connection = Client(); 
```

正在使用赋值运算符从临时对象设置`connection`a的状态。仍然是一个对象。您可以执行以下操作：`Base``Client``connection``Base`

```
std::unique_ptr<Base> makeBase(someFlagType flag)
{
  if (flag) {
    return std::unique_ptr<Base>(new Cient);
  } else {
    return std::unique_ptr<Base>(new Host);
  }
} 
```

然后

```
std::unique_ptr<Base> b = makeBase(myFlag);
b->someBaseMethod(); 
```

关于铸造部分，我想说，如果你发现自己不得不强制转换为子类型，你应该重新考虑类的设计。

# python - 如何根据所选的“国家”更新“城市”下拉菜单？

> ID：14491443
> 
> 赞同：0
> 
> 时间：2013-01-23T23:40:19.120
> 
> 标签：python, django

如何根据所选的“国家”更新“城市”下拉菜单？有什么建立在 Django 上来促进这一点的吗？

```
class Country(models.Model):
    name            = models.CharField(max_length=50)
    ...

class City(models.Model):
    name         = models.CharField(max_length=50)
    country      = models.ForeignKey(Country)

class UserProfile(models.Model):
    ...
    country             = models.ForeignKey(Country, default=1)
    city                = models.ForeignKey(City, default=1)
    user                = models.OneToOneField(User) 
```

在我看来，我有：

```
{{ profile_form.country }}
{{ profile_form.city }} 
```

但是所有城市都会同时显示。

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T02:55:20.703

使用[django-smart-selects](https://github.com/digi604/django-smart-selects)。它包括更新表单字段的 js 功能，并帮助我节省了大量使用 javascript 编写 ajax 调用的时间。示例项目包含一个类似于您上面提到的用例。对您来说，它可能看起来像这样：

```
from smart_selects.db_fields import ChainedForeignKey 

class City(models.Model):
    name = models.CharField(max_length=50)
    country = models.ForeignKey(Country)

class UserProfile(models.Model):
    country = models.ForeignKey(Country)
    city = ChainedForeignKey(City, chained_field="country", chained_model_field="country") 
```

从文档：

> 链接字段是该字段也应该链接的同一模型上的字段。链式模型字段是链式模型的字段，对应于链式字段也链接的模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:44:06.760

我的回答会有点长，所以我建议你可以看看这个[实现](https://github.com/thikonom/django_countries_states/blob/master/countries_states/forms.py#L37)，它准确地回答了你正在寻找的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T00:23:59.047

这似乎是您可能希望在客户端计算机上使用 javascript 执行的操作。您的网络服务器（运行 Django 的机器）不知道用户何时在下拉菜单上做出了选择，直到他们单击提交。（这会向您的网络服务器发出 HTTP POST 请求，并传递该表单的所有参数）。

在 javascript 中，您可以注册一个函数，以便在更改“国家”下拉列表时，动态重新填充“城市”下拉列表。

希望这可以帮助！

# hexagonal-tiles - 在六边形网格上计算距离

> ID：14491444
> 
> 赞同：16
> 
> 时间：2013-01-23T23:40:39.583
> 
> 标签：hexagonal-tiles

我想做的是找出六边形网格上两点之间有多少个六边形。我曾尝试在线搜索公式，但找不到与我正在使用的十六进制网格类型匹配的公式。

六角网格的布局与此类似，具有相同的坐标系：[http ://www.gamedev.net/index.php?app=core&module=attach§ion=attach&attach_rel_module=ccs&attach_id=1962](http://www.gamedev.net/index.php?app=core&module=attach&section=attach&attach_rel_module=ccs&attach_id=1962)

我知道使用此坐标系可能无法做到这一点，但这是我回去更改它之前的最后努力。非常感谢您提前。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-23T04:38:41.200

如果您使用的坐标系在两个方向上沿着六边形的纹理，您可以使用：

```
distance = max(
     abs(dest.y - start.y),     
     abs(dest.x - start.x),
     abs((dest.x - dest.y)*-1 - (start.x - start.y)*-1)
) 
```

但是您没有使用，您使用的是波浪形坐标系，该坐标系仅沿一个方向（水平）与谷物一起使用。幸运的是，我们可以在两者之间转换使用

```
straight.y = squiggle.y
straight.x = ciel(squiggle.y / -2) + squiggle.x 
```

因此，使用这个方程组求解距离可以得到：

```
distance = max(
     abs(dest.y - start.y),     
     abs(ceil(dest.y / -2) + dest.x - ceil(start.y / -2) - start.x),
     abs(-dest.y - ceil(dest.y / -2) - dest.x + start.y  + ceil(start.y / -2) + start.x)
) 
```

这将使您仅使用它们的坐标来获得两个六角形之间的曼哈顿距离（假设我没有对 x 和 y 进行任何拼写错误，因为您的网格与我的网格旋转了 90 度）。但是你必须为我的中学代数老师买一块饼干才能让它起作用，否则我会搞砸分配属性。

注意：可能需要摆弄负坐标，我没有检查。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-11-12T18:01:35.910

感谢@user2709663 和@jonathankoren 提供答案。我花了很多时间来回答你的问题，但发现这两个都有一些问题。或者至少没有明确说明为这些答案考虑的网格类型。然而，我发现了一个非常好的教程和这个问题的代码实现，以及一个用于管理十六进制网格的库： [http](http://www.redblobgames.com/grids/hexagons/) ://www.redblobgames.com/grids/hexagons/ （库代码：[http://www.redblobgames .com/grids/hexagons/implementation.html](http://www.redblobgames.com/grids/hexagons/implementation.html)）。我还为“odd-q”垂直布局实现了距离代码的matlab版本，如下所示：

```
function f = offset_distance(x1,y1,x2,y2)
    ac = offset_to_cube(x1,y1);
    bc = offset_to_cube(x2,y2);
    f = cube_distance(ac, bc);
end

function f = offset_to_cube(row,col)
    %x = col - (row - (row&1)) / 2;
    x = col - (row - mod(row,2)) / 2;
    z = row;
    y = -x-z;
    f = [x,z,y];
end

function f= cube_distance(p1,p2)
    a = abs( p1(1,1) - p2(1,1));
    b = abs( p1(1,2) - p2(1,2));
    c = abs( p1(1,3) - p2(1,3));
    f =  max([a,b,c]);
end 
```

这是一个matlab测试代码

```
sx = 6;
sy = 1;
for i = 0:7
    for j = 0:5
        k = offset_distance(sx,sy,i,j);
        disp(['(',num2str(sx),',',num2str(sy),')->(',num2str(i),',',num2str(j),')=',num2str(k)])
    end
end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-23T04:24:34.530

[接受的答案](https://stackoverflow.com/a/18394812/241211)不正确。当它提到在非正交轴上使用正交坐标时，我最初对此表示怀疑，但是针对我自己的解决方案运行代码表明距离的过度估计是复合的。

实际正确的解决方案是：

```
def hexDistance(start, dest):
  if (start.x == dest.x):
    return abs(dest.y - start.y)
  elif (start.y == dest.y):
    return abs(dest.x - start.x)
  else:
    dx = abs(dest.x - start.x)
    dy = abs(dest.y - start.y)
    if start.y < dest.y:
      return dx + dy - int(math.ceil(dx / 2.0))
    else:
      return dx + dy - int(math.floor(dx / 2.0)) 
```

这使用 hex->square 表示：

```
        ------        
 ------ 0, +1 ------
 -1, +1 ------ +1, +1  
 ------ 0, 0 ------
 -1, 0 ------ +1, 0  
 ------ 0, -1 ------
        ------        

 --------------------------
| -1, +1 | 0, +1 | +1，+1 |
|--------------------------
| -1, 0 | 0, 0 | +1, 0 |
|--------------------------|
| | 0, -1 | |
 --------------------------

```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-24T00:53:59.997

要找到两个六角形之间的最短路径：

1.  从一个十六进制开始，
2.  在不同的行上，沿着对角线朝向另一行。
3.  在同一行时，直奔另一个六角形。

我们称 x 方向`dx`的差异和 y 方向的差异`dy`。如果`dy / 2 > dx`，你不必做第二步，那么距离就是`dy`。否则，距离为`dy + (dx - dy / 2)`。除非我犯了错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-11T09:35:40.017

MH Rasel 在他之前的回答中链接了这篇文章：[Hexagonal Grids](http://www.redblobgames.com/grids/hexagons/)。在这篇优秀的帖子之后，我发现我需要立方体坐标；这提供了计算距离的最简单方法。这是 Kotlin 中的代码片段：

```
data class Point(val x: Int, val y: Int, val z: Int) {

    fun distance(b: Point): Int {
        return (abs(x - b.x) + abs(y - b.y) + abs(z - b.z)) / 2
    }

}

var x = 0
var y = 0
var z = 0

val p1 = Point(x, y, z)    // starting position

val steps = "ne,ne,ne".split(",")    // go to North-East 3 times

for (direction in steps) {
    when(direction) {
        "n"  -> { ++y; --z }
        "ne" -> { ++x; --z }
        "se" -> { ++x; --y }
        "s"  -> { --y; ++z }
        "sw" -> { --x; ++z }
        "nw" -> { ++y; --x }
    }
}

val p2 = Point(x, y, z)    // we arrived here
val dist = p1.distance(p2)    // the result is here (in this example: 3) 
```

*编辑：*我假设一个平顶六角网格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-24T01:46:29.450

If tiles on the grid can potentially become blocked then you are interested in the A* (or A-Star) maze-solving algorithm: [http://labs.makemachine.net/2010/03/a-star-maze-solver/](http://labs.makemachine.net/2010/03/a-star-maze-solver/)

The mechanism used in this video applies to a grid of squares, but with hardly any extra coding one could apply it to a hexagon mesh. For every tile, the solver knows which tiles to try next because the tiles store pointers to their surrounding tiles. In a grid of squares each tile would store a maximum of 4 pointers (*maximum* because they only store pointers to unblocked tiles), and the only difference in your case would be storing a maximum of 6 pointers.

If tiles are always traversable then A* will still certainly get the job done, however there is likely a faster way. If I'm interpreting your question correctly you're interested not in a distance, but in a whole-number count of the number of hexes between 2 given hexes? Try the following:

```
class Coord {
    int x;
    int y;
}

int dist(Coord hex1, Coord hex2) {
    int xSteps = Math.abs(hex1.x - hex2.x);
    int ySteps = Math.abs(hex1.y - hex2.y);

    return Math.max(xSteps, ySteps) + Math.abs(xSteps - ySteps);
} 
```

Why you may ask? This question is about determining how many times we must move *vertically* or *horizontally* as opposed to *diagonally*. We want to move diagonally as much as possible, otherwise we're not being smart about our distances. `Math.abs(xSteps - ySteps)` is the number of non-diagonal moves we must make. Add to that the greater of the distances of x and y, and you're done.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-24T00:20:59.177

这是一个次优但不是太次优（应该是 O(n)）的算法：

首先，制作一个函数来确定六边形网格中某个位置的六边形是否与具有某个起点和终点的线段相交（例如，计算它所组成的六条线并执行以下操作：[http： //alienryderflex.com/intersect/](http://alienryderflex.com/intersect/)。）

其次，创建一个函数来确定一个点在六边形网格上的哪个六边形。

现在，像这样编写你的算法：

*   保留到目前为止线段重叠的所有六边形的列表
*   从线段起点所在的六边形开始
*   对于最近重叠的六边形周围的每个六边形，如果它不在列表中，请查看直线段是否与该六边形相交。如果是这样，请将其作为列表的新标题并重复
*   如果我们用完了要测试的六边形，请返回我们制作的列表

我建议您测试线段与六边形之间的接缝完全平行并沿着接缝延伸的情况，以查看您是否在一侧、两侧或都没有（因此停止）获得六边形。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-15T19:56:18.033

如果您的六角平铺有方向：N、NE、SE、S、SW、NW，就像在[Advent of Code 2017 问题 11](http://adventofcode.com/2017/day/11)中一样，并且您将目标偏移到 (0,0)（通过预先从目标中减去您的位置）以下逻辑对我有用：

```
def distance(self):
    # Take diagonal steps towards self.x == 0
    steps = abs(self.x)
    # y moves closer to 0 by steps because moving diagonal, but never moving too far
    if self.y > 0:
        # Might still be positive, but never negative
        y = max(self.y - steps, 0)
    else:
        # Might still be negative, but not positive
        y = min(self.y + steps, 0)
    # You move 2 positions north/south by a single move so divide y's by 2
    return abs(y) // 2 + abs(steps) 
```

我认为它可能适用于具有 EAST 和 WEST 方向的六角网格，而不是像你这样的 NORTH 和 SOUTH，只需切换 x 和 y 的角色。在这种情况下，您将朝着 self.y == 0 对角线移动（如果需要）等。

# tcl - TCL - objc 将另外 1 个虚拟值传递给 C 端

> ID：14491448
> 
> 赞同：1
> 
> 时间：2013-01-23T23:40:57.510
> 
> 标签：tcl

在我的 TCL 命令的 C 端实现中，例如，在以下签名中：

myfunc(ClientData c, Tcl_Interp *interp, int objc, Tcl_Obj * const objv[]);

我发现有时候objc大于传入的参数个数，对应的objv值不是“0”就是“1”。

我在谷歌搜索中找不到任何报告此类问题，应该在我的 TCL 方面有问题，但不知道是怎么回事。

我的 TCL 端使用 2 个参数或 3 个参数调用命令 -

```
myfunc arg1 "word1 word2"   
<... some code ...>
myfunc arg1  ""  "checker1 checker2" 
```

第一次调用是 2 个参数，接下来是 3 个参数。

我提到的问题是当我期望 2 个参数时，我看到“objc”是 3，而“objv[3]”是“0”或“1”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:52:32.003

我不知道这是否是您的问题（可能是拼写错误），但是当 objc 仅为 3 时，objv[3] 访问越界，因为当计数为 3 时，最大可访问索引为 2。您应该从objv[0] 访问数组内容。

# xsd - XML 模式的公共托管

> ID：14491452
> 
> 赞同：4
> 
> 时间：2013-01-23T23:41:08.980
> 
> 标签：xsd

有谁知道提供 XML 模式公共托管的免费服务？我只是希望能够上传一个 XSD 文件，以便可以公开访问它们以验证并合理地确信该 URL 将长期可用。

考虑到模式的意图，这似乎很自然，但我找不到任何类似的东西。

当然 XSD 可以托管在任何可公开访问的 Web 服务器上，但我真的在寻找 XSD 托管的专用服务：例如，可以索引 XSD、使其可搜索、可标记等的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T02:45:59.160

xsd 只是一个文件，因此您可以使用任何托管服务，大多数免费用于公共和/或“小型”（例如 <2GB）存储：github、bitbucket、google appengine、heroku、dropbox

# objective-c - 如何使用手势而不是物理旋转设备来旋转 iPad 屏幕

> ID：14491463
> 
> 赞同：1
> 
> 时间：2013-01-23T23:41:57.397
> 
> 标签：objective-c, ipad, rotation

这是我用户的 iPad 要求。两个用户坐在一张桌子旁，中间夹着一台 iPad。每个用户都需要能够通过做一个手势来“控制”应用程序，将屏幕向他旋转。这相当于拿起 iPad 并改变它的旋转以面对用户。关于这个的几个问题：

1) iOS 中是否有任何默认行为可以做到这一点？

2）你知道有什么应用程序可以做到这一点，以便我可以看到它的运行情况吗？

3）最后，我该如何为我的应用启用此功能？我的应用程序中的所有 UIViewController 都应该可以使用此功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T02:17:44.637

我不是该主题的专家，但这是我的想法：

如果您还想让应用程序响应设备旋转，则该建议有点复杂。但是，如果您想消除物理设备旋转反应以支持自己旋转应用程序，则只需几个步骤：

1.  阻止视图自动旋转。在**iOS 6**中，这就像实现`shouldAutorotate:`方法和返回一样简单，`NO`并且该`supportedInterfaceOrientations`方法仅返回您希望在控制器层次结构**根部的视图控制器中允许的一个方向。**在**iOS 5**和更早版本中，您希望实现`shouldAutorotateToInterfaceOrientation:`仅返回视图控制器中位于视图控制器层次结构**顶部**`YES`的一个方向。

***   添加对您要用于旋转屏幕的手势做出反应的代码（可能是手势识别器）。

    *   当用户执行手势时，旋转应用程序中视图层次结构底部的任何视图。您可能会旋转由`rootViewController`. 请记住，您需要处理此视图的新大小，而不仅仅是方向。为了影响旋转，我认为最好的方法是对视图层应用仿射变换。如果您不熟悉仿射变换，[这将非常有用。](http://www.informit.com/articles/article.aspx?p=1951182)**

# php - CodeIgniter：jQuery 发布并加载下一页

> ID：14491466
> 
> 赞同：0
> 
> 时间：2013-01-23T23:42:09.660
> 
> 标签：php, codeigniter, jquery

我成功地使用 ajax post 保存了输入值，但它没有加载下一页。

客户端代码：

```
<script type="text/javascript">
    function notifyEmail() {

      var form_data = {
                  'email':$('#inviteEmail').val()
                };
        alert($('#inviteEmail').val());
      $.ajax({
                  url: "<?php echo site_url('main/email_invites'); ?>",
                  type: 'POST',
                  data: form_data,
                  success: function(msg) {
                    return true;
                  }
            });
    }
  </script>

<input type='text' id='inviteEmail' placeholder='Enter email'/>
        <a href='#' name='email' id='invite-all' onclick='notifyEmail();' class='btn'>Notify Me</a> 
```

控制器代码：

```
function email_invites()
    {
        $this->load->model('emailInvites');
        if($query = $this->emailInvites->saveEmailInvite())
        {
                $this->load->view('emailInvites');

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T23:33:46.383

我所做的是以下可以帮助你的

```
<script type="text/javascript">
    function notifyEmail() {

      var form_data = {
                  'email':$('#inviteEmail').val()
                };
        alert($('#inviteEmail').val());
      $.ajax({
                  url: "<?php echo site_url('main/email_invites'); ?>",
                  type: 'POST',
                  data: form_data,
                  dataType:'json',
                  success: function(msg) {
                    if(msg.response)
                       //load the content in the body or wherever you want  
                       jQuery('body').load("<?php echo site_url('main/email_invites/show'); ?>"); 
                    else
                       console.log("Opps, Something wrong happend"); 
                    return true;
                  }
            });
    }
  </script>

    <input type='text' id='inviteEmail' placeholder='Enter email'/>
    <a href='#' name='email' id='invite-all' onclick='notifyEmail();' class='btn'>Notify Me</a> 
```

**在控制器中**

```
function email_invites($action = 'process')
    {
        if($action == 'process')
        {
               $this->load->model('emailInvites');
               $query['response'] = $this->emailInvites->saveEmailInvite(); 
               echo json_encode($query); 

        }
        else
        {
              $this->load->view('emailInvites');
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:51:24.140

您不需要回显 url，只需像这样在 ajax 调用中使用它，

```
$.ajax({
              url: 'main/email_invites',
              type: 'POST',
              data: form_data,
              success: function(msg) {
                return true;
              }
        }); 
```

如果`site_url`方法返回所需的url，那么需要ajax调用，

```
 $.ajax({
              url: "<?php echo site_url('main/email_invites'); ?>",
              type: 'POST',
              data: form_data,
              success: function(msg) {
                return true;
              }
        }); 
```

# c# - 发布版本中的 FWTools/GDAL 错误

> ID：14491472
> 
> 赞同：1
> 
> 时间：2013-01-23T23:42:45.337
> 
> 标签：c#, exception, gis, access-violation, gdal

我正在使用 FWTools 和 SharpMap（带有 gdal_sharp）来构建应用程序。我有一个奇怪的错误。加载栅格图层在调试模式下运行良好，但在发布时调用时在构造函数中的 SharpMap.Layers.GdalRasterLayer 中引发异常

```
 _projectionWkt = _gdalDataset.GetProjectionRef(); 
```

完整的例外是：

```
{System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
   at OSGeo.GDAL.GdalPINVOKE.Dataset_GetProjectionRef(HandleRef jarg1)
   at OSGeo.GDAL.Dataset.GetProjectionRef()
   at SharpMap.Layers.GdalRasterLayer..ctor(String strLayerName, String imageFilename) in d:\Fakultet\IX Semestar\GIS\Projekat\GreenGIS\SharpMap.Extensions\Layers\GdalRasterLayer.cs:line 404
   at GreenGIS.Form1.addRasterLayer() in d:\Fakultet\IX Semestar\GIS\Projekat\GreenGIS\GreenGIS\Form1.cs:line 50
   at GreenGIS.Form1.toolStripButtonAddVector_Click(Object sender, EventArgs e) in d:\Fakultet\IX Semestar\GIS\Projekat\GreenGIS\GreenGIS\Form1.cs:line 129
   at System.Windows.Forms.ToolStripItem.RaiseEvent(Object key, EventArgs e)
   at System.Windows.Forms.ToolStripButton.OnClick(EventArgs e)
   at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)
   at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)
   at System.Windows.Forms.ToolStripItem.FireEventInteractive(EventArgs e, ToolStripItemEventType met)
   at System.Windows.Forms.ToolStripItem.FireEvent(EventArgs e, ToolStripItemEventType met)
   at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)
   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.ScrollableControl.WndProc(Message& m)
   at System.Windows.Forms.ToolStrip.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
   at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
   at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
   at System.Windows.Forms.Application.Run(Form mainForm)
   at GreenGIS.Program.Main() in d:\Fakultet\IX Semestar\GIS\Projekat\GreenGIS\GreenGIS\Program.cs:line 19} 
```

奇怪的是，在 Debug 中一切正常。构建设置是准确的，包括 .Net 4.0、x86 平台。

有任何想法吗？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T22:23:16.493

我遇到了类似的问题，但是在使用来自[http://www.gisinternals.com/sdk/](http://www.gisinternals.com/sdk/)的当前编译的二进制文件后，问题得到了解决。我在[http://vipassanaandenvironmentalinformatics.blogspot.co.nz/2013/03/getting-started-with-c-and-gdal.html](http://vipassanaandenvironmentalinformatics.blogspot.co.nz/2013/03/getting-started-with-c-and-gdal.html)记录了对我有用的步骤。

希望这个答案仍然对其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T00:52:27.677

这似乎是 Windows 8 的问题，它是 DEP 实现以及 .Net 4.0。我在包装器中使用了 C++ dll，操作系统不允许它执行。它可以通过编辑 DLL 或关闭数据执行保护来解决。

# python - 使用 numpy.take 进行更快的花式索引

> ID：14491480
> 
> 赞同：14
> 
> 时间：2013-01-23T23:43:11.913
> 
> 标签：python, numpy

**编辑**我在下面保留了我面临的更复杂的问题，但我的问题`np.take`可以更好地总结如下。假设您有一个`img`形状数组`(planes, rows)`，还有另一个`lut`形状数组`(planes, 256)`，并且您想使用它们来创建一个新`out`的形状数组`(planes, rows)`，其中`out[p,j] = lut[p, img[p, j]]`. 这可以通过花哨的索引来实现，如下所示：

```
In [4]: %timeit lut[np.arange(planes).reshape(-1, 1), img]
1000 loops, best of 3: 471 us per loop 
```

但是，如果不是花哨的索引，而是使用 take 和 python 循环，则`planes`可以大大加快速度：

```
In [6]: %timeit for _ in (lut[j].take(img[j]) for j in xrange(planes)) : pass
10000 loops, best of 3: 59 us per loop 
```

可以`lut`并且`img`以某种方式重新排列，以便在没有 python 循环的情况下进行整个操作，而是使用`numpy.take`（或替代方法）而不是传统的花式索引来保持速度优势？

* * *

**原始问题** 我有一组要在图像上使用的查找表 (LUT)。保存 LUT 的数组是有形的`(planes, 256, n)`，而图像是有形的`(planes, rows, cols)`。两者都是，与LUT`dtype = 'uint8'`的轴相匹配。`256`这个想法是从LUT的第`p`-平面运行图像的第-平面通过每个LUT。`n``p`

如果我的`lut`和`img`是以下：

```
planes, rows, cols, n = 3, 4000, 4000, 4
lut = np.random.randint(-2**31, 2**31 - 1,
                        size=(planes * 256 * n // 4,)).view('uint8')
lut = lut.reshape(planes, 256, n)
img = np.random.randint(-2**31, 2**31 - 1,
                    size=(planes * rows * cols // 4,)).view('uint8')
img = img.reshape(planes, rows, cols) 
```

使用像这样的精美索引后，我可以实现我的目标

```
out = lut[np.arange(planes).reshape(-1, 1, 1), img] 
```

这给了我一个 shape 数组`(planes, rows, cols, n)`，其中`out[i, :, :, j]`保存了穿过LUT 的 -th`i`平面的-th LUT 的-th 平面......`img``j``i`

一切都很好，除了这个：

```
In [2]: %timeit lut[np.arange(planes).reshape(-1, 1, 1), img]
1 loops, best of 3: 5.65 s per loop 
```

这是完全不可接受的，特别是因为我有以下所有看起来不太好看的替代品，`np.take`而不是运行得更快：

1.  单个平面上的单个 LUT 运行速度大约 x70：

    ```
    In [2]: %timeit np.take(lut[0, :, 0], img[0])
    10 loops, best of 3: 78.5 ms per loop 
    ```

2.  运行所有所需组合的 python 循环几乎快 x6 完成：

    ```
    In [2]: %timeit for _ in (np.take(lut[j, :, k], img[j]) for j in xrange(planes) for k in xrange(n)) : pass
    1 loops, best of 3: 947 ms per loop 
    ```

3.  即使在 LUT 和图像中运行所有平面组合，然后丢弃`planes**2 - planes`不需要的平面组合，也比花哨的索引更快：

    ```
    In [2]: %timeit np.take(lut, img, axis=1)[np.arange(planes), np.arange(planes)]
    1 loops, best of 3: 3.79 s per loop 
    ```

4.  我能想到的最快的组合是一个 python 循环在平面上迭代并更快地完成 x13：

    ```
    In [2]: %timeit for _ in (np.take(lut[j], img[j], axis=0) for j in xrange(planes)) : pass
    1 loops, best of 3: 434 ms per loop 
    ```

当然，问题是如果`np.take`没有任何 python 循环就没有办法做到这一点？理想情况下，需要的任何重塑或调整大小都应该发生在 LUT 上，而不是图像上，但我对你们能想出的任何事情持开放态度......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-09T11:03:05.237

首先，我不得不说我真的很喜欢你的问题。无需重新排列`LUT`或`IMG`以下解决方案有效：

```
%timeit a=np.take(lut, img, axis=1)
# 1 loops, best of 3: 1.93s per loop 
```

但是从结果中你必须查询对角线：a[0,0], a[1,1], a[2,2]; 得到你想要的。我试图找到一种仅对对角线元素进行索引的方法，但仍然没有成功。

以下是重新排列`LUT`and的一些方法`IMG`：如果索引`IMG`为 0-255，第 1 平面，256-511 用于第 2 平面，512-767 用于第 3 平面，则以下方法有效，但这会阻止您using `'uint8'`，这可能是一个大问题......：

```
lut2 = lut.reshape(-1,4)
%timeit np.take(lut2,img,axis=0)
# 1 loops, best of 3: 716 ms per loop
# or
%timeit np.take(lut2, img.flatten(), axis=0).reshape(3,4000,4000,4)
# 1 loops, best of 3: 709 ms per loop 
```

在我的机器中，您的解决方案仍然是最佳选择，而且非常足够，因为您只需要对角线评估，即 plane1-plane1、plane2-plane2 和 plane3-plane3：

```
%timeit for _ in (np.take(lut[j], img[j], axis=0) for j in xrange(planes)) : pass
# 1 loops, best of 3: 677 ms per loop 
```

我希望这可以让您对更好的解决方案有所了解。使用 寻找更多选项以及与或`flatten()`类似的方法会很不错，这似乎很有希望。`np.apply_over_axes()``np.apply_along_axis()`

我使用下面的代码来生成数据：

```
import numpy as np
num = 4000
planes, rows, cols, n = 3, num, num, 4
lut = np.random.randint(-2**31, 2**31-1,size=(planes*256*n//4,)).view('uint8')
lut = lut.reshape(planes, 256, n)
img = np.random.randint(-2**31, 2**31-1,size=(planes*rows*cols//4,)).view('uint8')
img = img.reshape(planes, rows, cols) 
```

# .htaccess - mod重写递归

> ID：14491485
> 
> 赞同：0
> 
> 时间：2013-01-23T23:43:34.697
> 
> 标签：.htaccess, mod-rewrite

我试图了解为什么在我的 .htaccess 文件中出现内部服务器错误：

```
<IfModule mod_rewrite.c>
  RewriteEngine on 
  RewriteCond %{REQUEST_FILENAME} !-d 
  RewriteCond %{REQUEST_FILENAME}\.php -f 
  RewriteRule ^(.*?)(/)?$ $1.php
  Options +FollowSymlinks
</IfModule> 
```

我正在尝试将 /about/ 和 /work/ 之类的 URI 指向 about.php 和 work.php

这是我收到 500 错误时的示例：

我访问 example.com/about/probablydoesntexist

我查看了重写日志，我可以看到它一直在尝试这样：

about/probablydoesntexist.php about/probablydoesntexist.php.php about/probablydoesntexist.php.php.php 等等。

为什么它不满足该 php 文件的 RewriteCond 不存在？

如何防止递归？

# css - 带有切口的 CSS 导航作为标记

> ID：14491486
> 
> 赞同：0
> 
> 时间：2013-01-23T23:43:42.273
> 
> 标签：css, navigation, transparency

我知道我以前在某个地方见过这个，但我正在尝试创建一个黑色固定导航栏，其标记是透明的切出三角形。我需要帮助使三角形切口对背景透明，因此当您滚动页面时，您可以看到下面的内容：

我有一个带有 javascript 的标准列表/锚导航，可以根据页面部分移动 .current 类：

```
<div class="navbar">
<ul>
    <li class="current"><a>home</a></li>
    <li><a>products</a></li>
    <li><a>services</a></li>
    <li><a>contact us</a></li>
</ul>
</div> 
```

使用以下 CSS 设置样式：

```
.navbar {
    width: 100%;
    position: fixed;
    background: black;
    float: left;
}

ul, li {
    list-style: none;
    margin: 0;
    padding: 0;
    float: left;
}

a {
    padding: 10px 20px 20px;
}

.current a {
    background: transparent url('../img/wedge-red.png') center bottom no-repeat;            
} 
```

我能想到的唯一方法是在ul的任一侧添加额外的div并为其分配背景，然后使用带有切口的透明png作为li a的背景。

有没有办法做到这一点而不会变得像那样丑陋并添加额外的div？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:03:02.440

试试 CSS 伪元素！

在 DOM 中的现有元素之前和之后添加 2 个空闲 DOM 元素。当您不想在标记中添加内容以满足样式需求时，这是理想的选择。

**CSS 标记**

```
.item:before {
    content:"";
    display: inline-block;
    width: 20px;
    height: 20px;
    background-color: silver;
}
.item:after {
    content:"";
    display: inline-block;
    width: 20px;
    height: 20px;
    background-color: gray;
} 
```

**HTML**

```
<div class="item">Content</div> 
```

查看此[JSFiddle](http://jsfiddle.net/9Qged/)以获取演示。

确保设置**content: ""**和**display:block**以便查看它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T21:30:45.160

这就是我最终得到的结果——扩展边界并用溢出裁剪它们：隐藏；（有点 hacky，但它可以工作并且不会向 DOM 添加元素）：

```
 .navbar {
        width: 100%;
        height: 60px;
        position: fixed;
        overflow: hidden;
    }

    ul {
        border-left: solid black 2000px;
        border-right: solid black 2000px;
        position: absolute;
        top: 0;
        left: 50%;
        margin-left: -2000px;
    } 
```

以上内容非常适合我的目的，并且在响应式环境中运行。

此页面上的另一个答案，使用 :before 和 :after 伪元素不适用于我的目的。它最终过于繁琐，伪元素无法正确对齐，并且在调整浏览器窗口大小时一直换行到下一行。建议的解决方案适用于固定宽度的元素，而不是原始问题中指定的百分比。

# .net - 使用sos查看datetime方法参数

> ID：14491491
> 
> 赞同：3
> 
> 时间：2013-01-23T23:44:15.557
> 
> 标签：.net, debugging, windbg, sos

如何查看作为参数传入的日期时间？

我在互联网上找到了这个例子，但我在理解它时遇到了问题？我根本看不到他们在哪里使用 clrstack 的输出，它只是说“通过从 ESP 转发内存来查看堆栈：”

[http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/4968f566-ef4c-4e29-ae23-6a17705178c4](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/4968f566-ef4c-4e29-ae23-6a17705178c4)

在 RSP 之后，我看到了很多这样的东西。有没有真正的方法可以做到这一点？

```
000000001d25f010 000007ff001872de method(System.DateTime)
    PARAMETERS:
        this = 0x00000000024ebcf8
        time = 0x48cfc7d6ced5a501

00000000`1d25ef28 000007fef1b11b6a 0000000000000001 0000000000000001 000000000002bf20 00000000024ebe18
00000000`1d25ef50 0000000000000002 00000000024ebeb8 00000000025022c0 000007fef1e37e24 00000000025022c0
00000000`1d25ef78 000000000002bf20 00000000024ebe01 000007fef2cb8d00 0000000000000000 0000000000000000
00000000`1d25efa0 0000000000000001 00000000024ebeb8 0000000000000000 000000001d25f0c0 0000000000000001
00000000`1d25efc8 000007fef2441085 0000000000000000 000007fef2cb9d69 0000000002409a88 0000000002409a88
00000000`1d25eff0 0000000002409a88 0000000000000000 00000000024ebff8 000007ff0018b2c1 48cfc7d6ced5a501
00000000`1d25f018 000000006b49d200 00000000024ebff8 000007ff0018b15f 000000006b49d200 0000010000000000
00000000`1d25f040 48cfc7d6ced5a501 0000000000000000 48cfc7d6638bd301 000000006b49d200 0000000100000000
00000000`1d25f068 48cfc7d6ced5a501 48cfc7d6638bd301 000000006b49d200 48cfc7d6ced5a501 0000000000000001
00000000`1d25f090 000000001d25f0c0 000007ff001872de 00000000024ebcf8 48cfc7d6ced5a501 00000000024ebdac 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T13:26:21.280

从 Microsoft 下载 psscor2 或 psscor4（它是 sos 的超集）并使用以下命令：

## !help 打印日期时间

!PrintDateTime object_address

!PrintDateTime 将打印出传递给它的 System.DateTime 对象的时间。

附言。psscor2 适用于 .net v2，psscor4 适用于 .net v4

# firebase - 向一组用户授予对 Firebase 位置的访问权限

> ID：14491496
> 
> 赞同：23
> 
> 时间：2013-01-23T23:44:50.633
> 
> 标签：firebase

我在文档中找不到它，但是有没有办法定义一组用户并使用该组来授予对不同位置的访问权限，而不是授予对单个用户的访问权限？

问候， LT

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-24T00:53:30.743

Firebase 中没有明确支持“组”，因为您可以很容易地自己表示它们。根据您的情况，这里有两种选择。

# 在 firebase 中存储组信息。

以下数据可用于表示 2 个组（“alpha”和“beta”）和 3 条受保护数据（“thing1”、“thing2”和“thing3”）

```
{
  "groups": {
    "alpha": {
      "joe": true,
      "sally": true
    },
    "beta": {
      "joe": true,
      "fred": true
    }
  },
  "data": {
    "thing1": {
      "group": "alpha"
      /* data accessible only by the "alpha" group */
    },
    "thing2": {
      "group": "beta"
      /* data accessible only by the "beta" group */
    },
    "thing3": {
      "group": "alpha"
      /* more data accessible by the "alpha" group */
    }
  }
} 
```

然后我们可以使用以下规则来强制执行安全性：

```
{
  "rules": {
    "data": {
      "$thing": {
        ".read":  "root.child('groups').child(data.child('group').val()).hasChild(auth.id)",
        ".write": "root.child('groups').child(data.child('group').val()).hasChild(auth.id)"
      }
    }
  }
} 
```

因此，如果我使用 { id: 'sally' } 作为我的身份验证对象进行了身份验证，我将可以访问 thing1 和 thing3，但不能访问 thing2。

# 将组信息存储在身份验证令牌中。

如果您正在生成自己的身份验证令牌，并且您知道用户在进行身份验证时所在的组，则可以将组列表存储在您生成的身份验证令牌中。例如，当您为用户“fred”生成身份验证令牌时，包括“{ id: 'fred', groups: { alpha: true, beta: true } }”

然后您可以通过以下方式强制执行组成员身份：

```
{
  "rules": {
    "data": {
      "$thing": {
        ".read": "auth[data.child('group').val()] != null",
        ".write": "auth[data.child('group').val()] != null"
      }
    }
  }
} 
```

# java - 使用 .NET Web 服务时在 JAVA 中将 ArrayOfStrings 转换为 String[]

> ID：14491498
> 
> 赞同：0
> 
> 时间：2013-01-23T23:45:00.420
> 
> 标签：java, .net, arrays, web-services, list

在 JAVA 中，我正在使用（JAX-WS 客户端）.NET webservice，它返回**string[]**类型的数据。

在 JAVA 中使用 Web 服务后，我得到了对象 ArrayOfStrings，但我不知道如何处理它。该类由 wsimport 工具生成。

**我需要以某种方式将其转换为 String[]**

我尝试将 Web 服务更改为返回 List，但在 java 中，结果数据始终是 ArrayOfStrings 类型。

有没有办法在 JAVA 中接收列表或数组？

。网

```
 [WebMethod]
    public List<string> GetListADocuments(string code)
    { ... } 
```

爪哇：

```
 WebServiceSoap service = client.getWebServiceSoap();
    result = service.getListADocuments(code); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:51:46.653

它没有方法 result.getString() 吗？返回一个 String[] 或 List

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:41:16.010

获取它的长度，使 String[] 具有相同的长度，遍历 ArrayOfStrings 的内容，用它填充 String[]。如果 ArrayOfStrings' 有任何直接返回 String[] 的方法，当然可以使用它。

# c# - 调用基方法和派生方法

> ID：14491513
> 
> 赞同：1
> 
> 时间：2013-01-23T23:46:02.637
> 
> 标签：c#, c++

在 C# 和 C++ 中，是否可以同时调用具有相同签名的方法的基版本和派生版本，而不是覆盖基类版本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T23:52:58.467

在 C# 中，如果派生方法是覆盖，则不是，但如果它被标记为`new`. 但是，在使用此构造时必须小心，因为在大多数情况下，这并不是您的对象的消费者所期望的。

```
static class Program
{
    static void Main()
    {
        Base baseObject = new Derived();
        Derived derivedObject = new Derived();
        Console.Write(derivedObject.Test());
        Console.Write(baseObject.Test());
        Console.Write(((Base)derivedObject).Test());
    }
}

class Base
{
    public virtual int Test()
    {
        return 1;
    }
}

class Derived : Base
{
    public new int Test()
    {
        return 2;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T23:50:01.217

对于 C++，您可以使用范围解析运算符：

```
Derived d;
d.Base::Method(); 
```

# javascript - webapi 返回的动态 JavaScript

> ID：14491518
> 
> 赞同：3
> 
> 时间：2013-01-23T23:46:10.453
> 
> 标签：javascript, asp.net-web-api

我正在使用 requirejs 为我的页面加载 JavaScript。我有一个 webApi 路由，它动态地从文件中读取并使用 Newtonsoft JObject 返回 JSON。然后在客户端，我获取结果并将其分配给本地 JavaScript 变量。

> 定义（['jquery']，函数（$）{
> 
> ```
> function dynoFile() {
>     $.get('/api/resources/dynofile', function (results) {
>         myNamespace.dynoFile = results;
>     });
> }
> 
> return new dynoFile(); }); 
> ```

此示例确实有效，但它会导致其他期望 myNamespace.dynoFile 存在的 JavaScript 文件出现问题。由于这个文件加载得很好，其他文件不会等待 $.get 完成。

是否有可能让 web api 方法只返回 JavaScript 并让浏览器将其识别为 JavaScript 而不仅仅是文本？我尝试在 web api 中设置响应标头以及返回生成的脚本的多种方式。

这可能吗？

**更新：**

更详细一点，我正在使用我的 Web API 来处理我的资源文件并将 JSON 返回给客户端，因为它是一个单页应用程序。我希望只从我可以使用 RequireJS 加载的 Web API 返回 JavaScript。我现在将它作为 JSON 工作，并认为我会分享我所拥有的。

这是我的 WebApi 方法，它读取资源文件并将其作为 JSON 返回：

```
public JObject Get()
{
    var data = new JObject();

    var type = typeof(Translations);
    var properties = type.GetProperties();

    foreach (var property in properties)
    {
        if (property.Name != "ResourceManager" && property.Name != "Culture")
        {
            data.Add( property.Name, property.GetValue(type, null).ToString());
        }
    }

    HttpContext.Current.Response.Headers.Add("Content-Type", "application/json");

    return data;
} 
```

这是我的 translations.js 文件：

```
define(['jquery', 'underscore'], function ($) {

    function translations() {
    }

    _.extend(translations.prototype, {
        target: '/api/resources/translations',

        getTranslations: function () {
            return $.ajax({
                url: 'api/resources/translations',
                type: 'GET',
                dataType: 'json'
            });
        }
    });

    return (translations);
}); 
```

由于我的其他几个文件依赖于现有的翻译，我需要在我的 main.js 中嵌套 2 个 RequireJS 语句：

```
requirejs(['application/translations', 'whatever other resources that can load that don't depend on translations'], function () {
    var trans = new translations();

    trans.getTranslations()
        .done(function (result) {
            // set translations into a variable, we chose it to be part of the global namespace
            window.Translations = result;

            // load remaining dependencies that require translations to exist
            requirejs(['myotherjsfiles', 'blahblah', function () {
                // you get the idea...
            });
        });
}); 
```

这允许我的翻译首先加载（使用任何非依赖文件，如 bootstrap、jquery 等），然后加载我所有依赖的 JavaScript 文件。我还针对 RequireJs 优化方法对此进行了测试，它能够解决嵌套需求。希望这可以帮助其他人了解如何将翻译下载到客户端和/或如何使用 RequireJS 加载动态模块。

如果有人知道如何让 WebApi 返回 JavaScript，我很想听听！

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-26T19:11:15.813

你想问这个问题： [有没有办法强制 ASP.NET Web API 返回纯文本？](https://stackoverflow.com/questions/11581697/is-there-a-way-to-force-asp-net-web-api-to-return-plain-text/11582207#comment28130776_11582207)

您不需要创建一个`PlainTextFormatter`（我认为唯一的好处是在`text/plain`请求时自动捕获？），您只需要一个辅助方法：

```
 /// <summary>
    /// Generate raw content from the given string output.
    /// <para>See https://stackoverflow.com/a/13028027/1037948 and https://stackoverflow.com/a/11582207/1037948 </para>
    /// </summary>
    /// <param name="responseBody"></param>
    /// <param name="mediaType"></param>
    /// <returns></returns>
    private HttpResponseMessage getRawResponse(string responseBody, string mediaType = "text/plain") {

        var response = Request.CreateResponse(HttpStatusCode.OK);
        response.Content = new StringContent(responseBody, Encoding.UTF8, mediaType);
        return response;
    } 
```

然后对于任何`GetSomething`方法，你写：

```
 public object GetMySomething1() {

        return getRawResponse(string.Format(@"window.SomeValue = {{{0}}}",
                            string.Join(",",
                                        Enum.GetValues(typeof(RandomEnum)).Cast<RandomEnum>().Select(o => string.Format("{0}:\"{1}\"", o, o)))
            ));
    } 
```

这导致请求`/myapicontroller/getmysomething1/`（假设您的路线设置为允许操作）返回：

```
window.SomeValue = {RandomValue1:"RandomValue1",RandomValue2:"RandomValue2",...} 
```

# rest - JMeter POST 返回 415 - 不支持的媒体类型

> ID：14491521
> 
> 赞同：7
> 
> 时间：2013-01-23T23:46:19.407
> 
> 标签：rest, jmeter

对我来说，这是前进一步，后退两步。感谢你们，我终于获得了在 JMeter 中工作的网络服务的 GET。现在我正在尝试 POST，但我再一次没有得到任何结果。

我正在使用 HTTP 请求并使 POST 正文尽可能小：`<the_tag></the_tag>`.
我什至把 xml 拿出来，只用了文本。
无论身体里有什么，我都会收到 415 错误。
我错过了什么？
我的实现是 HC3，协议 https，我没有选择其他任何东西（当然除了 POST）。我还将 Content-Type 设置为 text/xml。

PS 我应该补充一点，这个 POST 在 SoapUI 中运行良好，所以我认为这不是服务器问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-24T06:53:06.260

您是否检查了请求的内容类型？

它是什么 ？应该是什么？要设置它，请将标头管理器添加为采样器的子级并设置：

*   第 1 列中的内容类型

*   第 2 列中的应用程序/xml

如果你想正确地学习 jmeter，这[本书](https://leanpub.com/master-jmeter-from-load-test-to-devops)会对你有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-08-06T14:09:07.723

不要忘记标头管理器，还有：

[![在此处输入图像描述](../Images/6e4d9fc1fafa4c4db81ad2f58b3a85f9.png)](https://i.stack.imgur.com/qc0L6.png)

# r - 如何比较R中的平等环境

> ID：14491523
> 
> 赞同：9
> 
> 时间：2013-01-23T23:46:54.357
> 
> 标签：r, frame, environment

我想检查当前环境是否是 R 中的全局环境。但是，直接比较似乎不适用于环境。做这个的最好方式是什么？

```
#doesn't work
sys.frame() == .GlobalEnv 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-23T23:50:43.640

马修普洛德的解决方案：

```
> identical(sys.frame(),.GlobalEnv)
[1] TRUE 
```

您也可以检查名称，尽管这可能不太可靠：

```
> environmentName(sys.frame())=="R_GlobalEnv"
[1] TRUE 
```

# wordpress - 在 buddypress 网站的任何地方添加“添加朋友按钮”

> ID：14491524
> 
> 赞同：3
> 
> 时间：2013-01-23T23:47:13.087
> 
> 标签：wordpress, buddypress

我正在尝试在成员页面之外的循环内放置一个“添加朋友”按钮，以便该按钮出现在帖子中作者头像的旁边。我尝试添加；

```
<?php if ( bp_is_active( 'friends' ) ) { ?>

                        <?php bp_add_friend_button( $user_ids['users'][$i]->id ) ?>

                    <?php } ?> 
```

在循环内部，但它没有返回任何结果。然后我在functions.php中放置了以下动作挂钩，它显示了循环内的按钮，但是一旦点击，帖子列表中的所有按钮也都被点击了。

```
 add_action( ‘the_content’, ‘bp_add_friend_button’, 5 ); 
```

所以现在我被困住了。我想，在模板中添加一个模板标签会起作用，因为它适用于“发送消息”按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T21:49:04.680

尝试

`<?php if ( function_exists( 'bp_add_friend_button' ) ) : ?> <?php bp_add_friend_button() ?> <?php endif; ?>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-29T17:02:37.013

这是一个对我有用的示例，希望对您有所帮助。

```
$id_or_email = $result -> user_ID;
$avatar_default = get_avatar($id_or_email, $size, $default = '', $alt = '', $args = null);
$potential_friend_id = $id_or_email;
$friend_status = false;
$friend_button = bp_add_friend_button($potential_friend_id, $friend_status);
 echo '<li>'. $avatar_default. $user_info->user_nicename . $friend_button . '</li> '; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-04T12:53:29.810

可能有一个插件可以解决这个问题，但要跟进 Rafa 的解决方案。这个完整的代码对我有用。

1.  在 bp-custom.php 中（这是您需要创建的文件）

    ```
     function my_id_text_processor($friend_id)
     {
       //Return string id without 'uid-' attached
       $search = 'uid-';
       $replace_with = '';
       return  str_replace($search, $replace_with, $friend_id);

     } 
    ```

    2.  在您希望按钮出现的文件中放置此代码。

    ```
     < ?php $friend_id = my_id_text_processor(bp_get_group_invite_item_id()) ? >

     $avatar_default = get_avatar($friend_id, $size, $default = '', $alt = '', $args = null);
     $friend_status = false;
     $friend_button = bp_add_friend_button($friend_id, $friend_status);
     echo '<li>'. $avatar_default,bp_group_invite_user_link(),$friend_button . '</li> '; 
    ```

# sql - postgres - 递归

> ID：14491526
> 
> 赞同：3
> 
> 时间：2013-01-23T23:47:18.073
> 
> 标签：sql, postgresql, recursive-query

我希望以下内容返回所有元组，将层次结构中的每个父级解析到顶部，但它只返回最低级别（其 ID 在查询中指定）。如何返回给定 level_id 的整棵树？

```
create table level(
level_id int,
level_name text,
parent_level int);

 insert into level values (197,'child',177), (  177, 'parent', 3 ), (  2, 'grandparent',  null  );

WITH RECURSIVE recursetree(level_id, levelparent) AS (
 SELECT level_id, parent_level 
 FROM level 
 where level_id = 197

UNION ALL
SELECT t.level_id, t.parent_level
FROM level t, recursetree rt 
WHERE rt.level_id = t.parent_level
)

SELECT * FROM recursetree; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T00:16:56.663

首先，如果它真的是祖父母，你`(2, 'grandparent', null)`应该是。`(3, 'grandparent', null)`其次，您在查询的递归部分中的（隐式）连接条件是向后的，您希望让父级脱离`rt.levelparent`而不是`t.parent_level`：

```
WITH RECURSIVE recursetree(level_id, levelparent) AS (
    SELECT level_id, parent_level 
    FROM level 
    WHERE level_id = 197

    UNION ALL

    SELECT t.level_id, t.parent_level
    FROM level t JOIN recursetree rt ON rt.levelparent = t.level_id
    -- join condition fixed and ANSI-ified above
)
SELECT * FROM recursetree; 
```

# javascript - 在外部 js 文件中使用 .on 时出错 - jquery 1.7.2

> ID：14491529
> 
> 赞同：-4
> 
> 时间：2013-01-23T23:47:37.950
> 
> 标签：javascript, jquery, external

我为此代码创建了一个外部 JS 文件：

```
$(document).ready(function () {
  $(document).on("click", '.siteusemore', function ()
  //$('.siteusemore').on("click",function() 
  {
    var ID = $(this).attr("id");
    if (ID) {
      $("##siteusemore" + ID).html('<img src="/images/processing.gif" />');
      $.ajax({
        type: "POST",
        url: "/ajax_results.cfm?rpp=#url.rpp#&ajax_type=my_profile&status_action=#url.status_action#&comments_action=#url.comments_action#&myscript=#urlencodedformat(arguments.myscript)#",
        data: "lastmsg=" + ID,
        cache: false,
        success: function (html) {
          $("ol##siteuseupdates").append(html);
          $("##siteusemore" + ID).remove();

        }
      });
    } else {
      $(".siteusemorebox").html('The End');
    }
    return false;
  });

  $(document).on("click", '.teamsusemore', function ()
  //$('.teamsusemore').live("click",function() 
  {
    var ID = $(this).attr("id");
    if (ID) {
      $("##teamsusemore" + ID).html('<img src="/images/processing.gif" />');
      $.ajax({
        type: "POST",
        url: "/ajax_results.cfm?rpp=#url.rpp#&ajax_type=my_teams&myscript=#urlencodedformat(arguments.myscript)#",
        data: "lastmsg=" + ID,
        cache: false,
        success: function (html) {
          $("table##grouplisting").append(html);
          $("##teamsusemore" + ID).remove();

        }
      });
    } else {
      $(".teamsusemorebox").html('No more records.');
    }
    return false;
  });

  $(document).on("click", '.teamsusemore', function ()
  //$('.leaguesusemore').live("click",function() 
  {
    var ID = $(this).attr("id");
    if (ID) {
      $("##leaguesusemore" + ID).html('<img src="/images/processing.gif" />');
      $.ajax({
        type: "POST",
        url: "/ajax_results.cfm?rpp=#url.rpp#&ajax_type=my_leagues&myscript=#urlencodedformat(arguments.myscript)#",
        data: "lastmsg=" + ID,
        cache: false,
        success: function (html) {
          $("table##leaguelisting").append(html);
          $("##leaguesusemore" + ID).remove();

        }
      });
    } else {
      $(".leaguesusemorebox").html('No more records.');
    }
    return false;
  });
}); 
```

当我调用它时，它会在 jquery 1.7.2.min.js 中引发脚本错误

> 行：3 错误：语法错误，无法识别的表达式：#

该脚本的目的是处理页面上发生的所有三个单独的 ajax 事件。

```
<div id="siteusemore#evaluate(currentpage + 1)#" class="siteusemorebox">    
    <a href="##" class="siteusemore" id="#evaluate(currentpage + 1)#">View more items</a>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:59:15.060

您将在选择器中遇到这么多哈希的问题。问题是 jQuery 使用“#”来查找具有该 ID 的内容。试图从 jQuery 的角度阅读它，你试图告诉它找到 ID 为 siteusemore 和 ID 为 evaluate(currentpage + 1) 然后 ID 为......好吧，什么都没有，因为哈希在结局没有意义。我会从您的 ID 中删除哈希和括号，然后重试。

# php - pygments pygmentize 传递字符串

> ID：14491535
> 
> 赞同：1
> 
> 时间：2013-01-23T23:48:02.640
> 
> 标签：php, shell, pygments

我决定将[Pygments](http://pygments.org)用于我正在开发的网站，但我缺乏终端知识是惊人的。

我想用来`pygmentize`突出博客文章中的语法，但由于它们存储在数据库中，我不能只将文件名传递给它。有什么办法可以将字符串传递给它吗？

如果没有，我将不得不将帖子内容保存在临时文件中，对其进行 pygmentize 并加载到数据库中，但这会增加开销，如果可能的话，我真的很想避免。

我没有看到[CLI 文档](http://pygments.org/docs/cmdline/)对此有任何说明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:35:35.307

[手册页](http://linux.die.net/man/1/pygmentize)说，如果省略 infile ，它将从 stdin 读取，如果省略 outfile，它将写入 stdout。

因此，在 cmdline 上，您将键入：

```
$ pymentize -l php -f html
<?php

echo 'hello world!';
^D // type: Control+D 
```

pymentize 将输出：

```
<div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">echo</span> <span class="s1">&#39;hello world!&#39;</span><span class="p">; </span>
</pre></div> 
```

如果您要使用 PHP 运行它，则必须使用 pygmentize 开始，[`proc_open()`](http://php.net/manual/de/function.proc-open.php)因为您必须写入它的标准输入。这里有一个简短的例子如何做到这一点：

```
echo pygmentize('<?php echo "hello world!\n"; ?>');

/**
 * Highlights a source code string using pygmentize
 */
function pygmentize($string, $lexer = 'php', $format = 'html') {
    // use proc open to start pygmentize
    $descriptorspec = array (
        array("pipe", "r"), // stdin
        array("pipe", "w"), // stdout
        array("pipe", "w"), // stderr
    );  

    $cwd = dirname(__FILE__);
    $env = array();

    $proc = proc_open('/usr/bin/pygmentize -l ' . $lexer . ' -f ' . $format,
        $descriptorspec, $pipes, $cwd, $env);

    if(!is_resource($proc)) {
        return false;
    }   

    // now write $string to pygmentize's input
    fwrite($pipes[0], $string);
    fclose($pipes[0]);

    // the result should be available on stdout
    $result = stream_get_contents($pipes[1]);
    fclose($pipes[1]);

    // we don't care about stderr in this example

    // just checking the return val of the cmd
    $return_val = proc_close($proc);
    if($return_val !== 0) {
        return false;
    }   

    return $result;
} 
```

顺便说一句，pygmentize 是很酷的东西！我也在用它:)

# python - 使用 Python 在特定时间间隔内计算随机数

> ID：14491542
> 
> 赞同：1
> 
> 时间：2013-01-23T23:48:59.473
> 
> 标签：python, random, python-3.x

我在发布之前做了一些研究，但似乎迷失了方向（在编码方面没有太多经验）。

我正在尝试使用 Python 生成或计算特定时间间隔的随机数。我不是在寻找完整的代码，如果使用正确的时间库，我需要帮助。

**伪代码：**

让 python [PC] 计算一个随机数 3 秒

------> 将计算的生成存储在一个值中*（我可以处理这个）*

然后，我将使用随机生成的值来链接访问 python 列表（这也将通过随机数生成自动生成，但我可以弄清楚）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:00:51.257

我不知道你为什么要这样做，但这里是如何计算许多随机数，把它们中的大部分扔掉，然后在 3 秒后使用最后一个。

```
import random
import time

start = time.clock()
while time.clock() - start < 3:
    random_number = random.randint(0,100)

print random_number 
```

这毫无意义地在我的机器上丢弃了大约 200 万个非常好的随机数。

（而且，正如[abarnert](https://stackoverflow.com/users/908494/abarnert)指出的那样，这也会在繁忙循环中的整个 3 秒内最大限度地利用一个 CPU 内核，这非常非常浪费，但我认为这就是你所要求的？）

**编辑：**更新为使用[time.clock](http://docs.python.org/2/library/time.html#time.clock)而不是[time.time](http://docs.python.org/2/library/time.html#time.time)，正如 abarnert 再次建议的那样（谢谢），因为这似乎可以提供更好的跨平台分辨率，并且在系统时间在中间更改时不会出现问题程序运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:01:15.123

首先，您没有说要生成什么样的随机数，但鉴于您的示例是`10`，我假设它是某个范围内的整数 - 假设您正在调用[`random.randrange(30)`](http://docs.python.org/3/library/random.html#random.randrange).

现在，您想在 3 秒内每秒计算一个数字，然后保留最后一个。我不知道你为什么要这样做，但你可以这样做：

```
for i in range(3):
    number = random.randrange(30)
    time.sleep(1.0) 
```

在 3 秒结束时，`number`将生成第三个随机数。

这里的关键是，每秒执行一次（在同步程序中——不要在 GUI 或服务器中这样做！）——你只需调用[`time.sleep`](http://docs.python.org/3/library/time.html#time.sleep).

如果您正在执行的操作花费大量时间（或更长），那么这是不合适的。相反，您需要计算开始时间，然后睡到一秒钟：

```
t0 = time.monotonic()
for i in range(3):
    number = random.randrange(30)
    t0 += 1
    time.sleep(t0 - time.monotonic()) 
```

请注意，我在[`time.monotonic`](http://docs.python.org/3/library/time.html#time.monotonic)这里使用过。此功能专为此类用例而设计。它以合理的效率返回尽可能多的精度（特别是，与 不同`time.time`，它在某些平台上不会为您提供 1 秒的精度），并且它保证您永远不会倒退，即使，例如，您更改系统时钟在程序的中间。如果您使用的是 3.2 或更早版本，请查看文档以找到最佳替代方案（可能使用`time.clock()`），或查看 using`ctypes`以调用适当的平台本机函数。

但在这种情况下，`random.randrange`将需要大约一微秒的时间，这比大多数系统的简单计时器的最小分辨率要少得多，因此没有理由做这样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T14:49:05.487

如果你想花 3 秒得到一个随机数，因为你关心随机数的质量，你可以使用 os.urandom() 来生成值。如果您真正想做的只是从列表中随机选择一个项目，您可以使用 random.choice()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-08T15:13:27.780

注意：函数 time.clock() 已被删除，自 Python 3.3 起已被弃用：根据您的要求使用 time.perf_counter() 或 time.process_time() 来获得明确定义的行为。（由 Matthias Bussonnier 在 bpo-36895 中贡献。）

# spring - 我还可以使用哪些其他方式来访问我的 Web 表单字段？

> ID：14491546
> 
> 赞同：0
> 
> 时间：2013-01-23T23:49:28.293
> 
> 标签：spring, spring-mvc

我目前用来`@ModelAttribute ClassName className`将我的网络表单“投射”到一个类中。

```
@RequestMapping("/SaveEventRegistration")
public ModelAndView saveEventRegistration(@ModelAttribute EventRegistration userEventRegistration) { 
```

我只是想知道我是否真的需要这样做。因为有一个通用`form`类列出了我的网络表单中的所有字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:46:34.783

您可以访问请求：

```
@RequestMapping("/SaveEventRegistration")
public ModelAndView saveEventRegistration(HttpServletRequest request) { 
```

然后让你手动使用表单数据：

```
request.getParameter("fieldName"); 
```

# python - Scipy：稀疏矩阵是否支持高级索引？

> ID：14491548
> 
> 赞同：10
> 
> 时间：2013-01-23T23:49:54.493
> 
> 标签：python, numpy, scipy

没问题：

```
>>> t = np.array([[1,1,1,1,1],[2,2,2,2,2],[3,3,3,3,3],[4,4,4,4,4],[5,5,5,5,5]])
>>> x = np.arange(5).reshape((-1,1)); y = np.arange(5)
>>> print (t[[x]],t[[y]]) 
```

大问题：

```
>>> s = scipy.sparse.csr_matrix(t)
>>> print (s[[x]].toarray(),s[[y]].toarray())
Traceback (most recent call last):
  File "<pyshell#22>", line 1, in <module>
:               :
:               :
ValueError: data, indices, and indptr should be rank 1 
```

`s.toarray()[[x]]`效果很好，但是由于我的数组太大，因此破坏了我使用稀疏矩阵的全部目的。我已经检查了与一些稀疏矩阵相关联的属性和方法，以获取任何引用高级索引的内容，但没有骰子。有任何想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-24T00:57:36.697

稀疏矩阵的索引支持非常有限，可用的索引取决于矩阵的格式。

例如：

```
>>> a = scipy.sparse.rand(100,100,format='coo')
>>> a[2:5, 6:8]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'coo_matrix' object has no attribute '__getitem__' 
```

但

```
>>> a = scipy.sparse.rand(100,100,format='csc')
>>> a[2:5, 6:8]
<3x2 sparse matrix of type '<type 'numpy.float64'>'
    with 0 stored elements in Compressed Sparse Column format> 
```

虽然

```
>>> a[2:5:2, 6:8:3]
Traceback (most recent call last):
...
ValueError: slicing with step != 1 not supported 
```

还有

```
>>> a = scipy.sparse.rand(100,100,format='dok')
>>> a[2:5:2, 6:8:3]
Traceback (most recent call last):
...
NotImplementedError: fancy indexing supported over one axis only
>>> a[2:5:2,1]
<3x1 sparse matrix of type '<type 'numpy.float64'>'
    with 0 stored elements in Dictionary Of Keys format> 
```

乃至

```
>>> a = scipy.sparse.rand(100,100,format='lil')
>>> a[2:5:2,1]
<2x1 sparse matrix of type '<type 'numpy.int32'>'
    with 0 stored elements in LInked List format>
C:\Python27\lib\site-packages\scipy\sparse\lil.py:230: SparseEfficiencyWarning: Indexing into a lil_matrix with multiple indices is slow. Pre-converting to CSC or CSR beforehand is more efficient.
  SparseEfficiencyWarning)
>>> a[2:5:2, 6:8:3]
<2x1 sparse matrix of type '<type 'numpy.int32'>'
    with 0 stored elements in LInked List format> 
```

# php - md5_file 在 2 个结果之间随机选择

> ID：14491549
> 
> 赞同：1
> 
> 时间：2013-01-23T23:49:58.763
> 
> 标签：php, image, jpeg, md5, md5-file

类似于这里的这个问题：[php md5_file function with gif file?](https://stackoverflow.com/questions/14055780/php-md5-file-function-with-gif-file) 但答案并不适合我的情况。

在我应用的某些图像`md5_file`上，有一些（20000 个）随机给出 2 个不同的结果。

示例代码：

```
<?php
$moo = 'http://a1100.phobos.apple.com/us/r1000/069/Purple/v4/03/0f/cd/030fcd97-3958-5a96-f1ae-86e55382c529/mzl.lepmgpwz.350x350-75.jpg';
echo md5_file($moo);
?> 
```

结果：673ec8b2f87df0b41ebc17bba85edd9a 或：235bf518387d59b13a7c820abe73d5eb

我尝试使用 ,`md5(file_get_contents($moo));`和 的类似版本`sha1`，`sha256`但我尝试过的版本都随机得出 2 个不同的结果。

我的快速回声测试记事本：

```
<?php
$moo = 'http://a1100.phobos.apple.com/us/r1000/069/Purple/v4/03/0f/cd/030fcd97-3958-5a96-f1ae-86e55382c529/mzl.lepmgpwz.350x350-75.jpg';
echo $moo.'<br /><br />';

echo '- '.md5(file_get_contents($moo)).'<br />';
echo '- '.md5_file($moo).'<br />';
echo '- '.md5($moo).'<br />';

echo '- '.sha1(file_get_contents($moo)).'<br />';
echo '- '.sha1_file($moo).'<br />';
echo '- '.sha1($moo).'<br/>';

?> 
```

这很常见吗？有什么办法可以避免这种情况吗？

现在我被一些死图像困住了，因为`md5_file('my_image');`我的 dB 中有 1 个函数的名称与保存`md5_file('my_image);`为的调整大小函数不同。

# iphone - 将现有 XCode 项目添加到新项目

> ID：14491552
> 
> 赞同：0
> 
> 时间：2013-01-23T23:50:16.957
> 
> 标签：iphone, ios, xcode

这可能是一个扩展

> [如何在 XCode 4 中将现有项目添加为工作副本？](https://stackoverflow.com/questions/5301572/how-can-i-add-an-existing-project-as-a-working-copy-in-xcode-4)

我有一个现有的 iOS XCode 项目“Project A”，它有一个目标，即它构建的应用程序。

现在我有另一个项目“项目 B”，我目前正在从事这项工作，并希望将第一个项目按原样添加到这个项目中，并将其作为一项功能包含在内。

当我拖动A的.xcodeproj文件时，我可以看到项目进来了，但是它也带来了目标。当我查看 A 中任何文件的“目标成员资格”时，它具有 A 的目标，而我看不到 B 的目标。

我想做的只是有B的目标并将A中的所有文件链接到B。

我尝试从 A 创建一个库，但这个过程要乏味得多。我真的很想继续复制+链接路径。有人可以建议可以做什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:33:26.623

听起来您可能对[Xcode Workspace](http://developer.apple.com/library/ios/#featuredarticles/XcodeConcepts/Concept-Workspace.html#//apple_ref/doc/uid/TP40009328-CH7-SW1)更感兴趣，除非您真的对永久合并这两个项目感兴趣。

如果您想引入其他项目的所有源文件，您可以在 Xcode 中右键单击该项目并选择“将文件添加到 'MyProject' ...”，然后在显示的界面中选择目标成员资格。我会走这条路线将项目“合并”在一起，而不是拖入完整的 Xcode 项目。

很可能有一种方法可以按照您的希望进行，但这是我知道并将采取的路线。

# c - 默认情况下使用 unifdef 省略未定义的预处理器分支的方法？

> ID：14491555
> 
> 赞同：4
> 
> 时间：2013-01-23T23:50:24.890
> 
> 标签：c, c-preprocessor

我正在使用包含许多编译选项的复杂 C 代码。这使得代码很难阅读。我想生成一份反映其实际编译方式的代码副本。我使用“unifdef”实用程序获得了相当不错的结果，直到最近我才知道。但是，我很困惑为什么它如此难以调用，并且想知道我是否遗漏了一些东西。

考虑这个例子：

```
#ifdef A
  printf("A\n");
#endif
#ifdef B
  printf("B\n");
#endif 
```

如果你用“unifdef -DA junk.c”调用 unifdef，你会得到：

```
 printf("A\n");
#ifdef B
  printf("B\n");
#endif 
```

因为您没有告诉 unifdef B 未定义，所以它没有将其取出。

我希望该实用程序的行为使得当我说 unifdef -DA 时，我得到的是：

```
 printf("A\n"); 
```

这将对应于 C 预处理器的实际操作：省略任何未定义的分支。

要使用 unifdef 获得这种行为，我似乎需要使用“unifdef -DA -UB junk.c”，明确告诉它 B 未定义。虽然也许我错过了一种更简单的调用它的方法。

我编写了一个 python 脚本来从我正在使用的代码的 Makefile 中生成一长串所需的 -D 和 -U 标志（通常每个例程 80 个）。结果非常好。但我想知道这样的脚本是否真的有必要。

另一个实用程序（sunifdef？coan？）也可能已经内置了我想要的行为；如果有，请提及。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T00:55:12.063

该[`coan`](http://coan2.sourceforge.net/)实用程序可以使用`-m`标志满足您的需求：

```
$ coan source -DA -m test.c 
  printf("A\n"); 
```

从手册页：

```
-m, --implicit
    Assume that any symbol that is not --define-ed is implicitly
    --undef-ed. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T10:48:01.623

您可以使用 unifdef 附带的 unifdefall 实用程序。见[http://dotat.at/prog/unifdef](http://dotat.at/prog/unifdef)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T00:03:18.307

如果我正确理解了您的问题，您想在预处理器运行后查看代码，对吗？那么为什么不让预处理器运行它并查看它产生的输出呢？只需使用与编译时完全相同的参数运行编译调用，但将参数添加`-E`到其中，这意味着“除了预处理之外什么都不做”。

```
$ cat preproc.c 
#ifdef A
  printf("A\n");
#endif
#ifdef B
  printf("B\n");
#endif

$ gcc -E preproc.c 
# 1 "preproc.c"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "preproc.c"

$ gcc -E -DA preproc.c 
# 1 "preproc.c"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "preproc.c"

  printf("A\n");

$ gcc -E -DB preproc.c
# 1 "preproc.c"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "preproc.c"

  printf("B\n");

$ 
```

# java - 检索第一个 OU 以搜索 distinctName 属性

> ID：14491557
> 
> 赞同：0
> 
> 时间：2013-01-23T23:50:40.993
> 
> 标签：java

我正在使用 Spring Security 3.1 Active Directory。

我有一个 AD 结构，我需要从 AD 结构 distinctName 属性中获取一个 OU 值。

我想要的 OU 将始终是最后一个 DC 之后的第一个 OU。

下面是我的代码示例 -**我需要获取 myCompany OU 值**，必须有更好的方法来做到这一点：

公共类测试{

```
public static void main(String[] args) {

    String s = "cn=harry,cn=group,ou=myCompany,ou=customers,dc=this,dc=that";

    System.out.println("s: "+s);

    String s1 = s.substring(s.indexOf("ou=") + 3);

    System.out.println("s1: "+s1);

    String s2 = s1.substring(s1.indexOf(""), s1.indexOf(",ou="));

    System.out.println("s2: "+s2);

} 
```

}

这将输出以下内容：

```
s: cn=harry,ou=myCompany,ou=customers,dc=this,dc=that 
s1: myCompany,ou=customers,dc=this,dc=that 
s2: myCompany 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:55:23.127

正则表达式！在下面选择你的口味（第一个或第二个）：

```
public static void main (String[] args){
     String s = "cn=harry,cn=group,ou=users,ou=myCompany,ou=customers,dc=this,dc=that";

     String first = s.replaceAll(".*?,ou=(.*?),.*", "$1");
     String middle = s.replaceAll(".*?,ou=.*?,ou=(.*?),.*", "$1");
     String third = s.replaceAll(".*,ou=(.*?),.*", "$1");

     System.out.println(first);
     System.out.println(middle);
     System.out.println(third);
} 
```

# asp.net - 页面中只能添加一个 ScriptManager 实例：Ajax Toolkit 有问题吗？

> ID：14491561
> 
> 赞同：1
> 
> 时间：2013-01-23T23:51:01.223
> 
> 标签：asp.net, visual-studio-2012, master-pages, scriptmanager, toolkitscriptmanager

我在 Visual Studio 2012 上。我需要为我的网站添加 CollapsablePanelExtender。因为 MasterPage 上有一个 ScriptManager，所以我不知道如何在 ToolkitScriptManager 中添加。当我尝试使用 Scriptmanagerproxy 时，web.config 崩溃并告诉我必须使用 ToolkitScriptManager。当我将我的 toolkitscriptmanager 与母版页的 scriptmanager 一起使用时，该站点也崩溃并说找不到 ToolkitScriptManager，并且“只允许一个 ScripManager 实例。

我在 masterPage 上有以下代码：

```
<asp:ScriptManager runat="server">
    <Scripts>
        <%--Framework Scripts--%>
        <asp:ScriptReference Name="MsAjaxBundle" />
        <asp:ScriptReference Name="jquery" />
        <asp:ScriptReference Name="jquery.ui.combined" />
        <asp:ScriptReference Name="WebForms.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebForms.js" />
        <asp:ScriptReference Name="WebUIValidation.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebUIValidation.js" />
        <asp:ScriptReference Name="MenuStandards.js" Assembly="System.Web" Path="~/Scripts/WebForms/MenuStandards.js" />
        <asp:ScriptReference Name="GridView.js" Assembly="System.Web" Path="~/Scripts/WebForms/GridView.js" />
        <asp:ScriptReference Name="DetailsView.js" Assembly="System.Web" Path="~/Scripts/WebForms/DetailsView.js" />
        <asp:ScriptReference Name="TreeView.js" Assembly="System.Web" Path="~/Scripts/WebForms/TreeView.js" />
        <asp:ScriptReference Name="WebParts.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebParts.js" />
        <asp:ScriptReference Name="Focus.js" Assembly="System.Web" Path="~/Scripts/WebForms/Focus.js" />
        <asp:ScriptReference Name="WebFormsBundle" />
        <%--Site Scripts--%>

    </Scripts>
</asp:ScriptManager> 
```

我有以下代码要在实际页面中使用。

```
 <asp:ToolkitScriptManager ID="ToolkitScriptManager2" runat="server"></asp:ToolkitScriptManager>
<h3>We suggest the following:</h3>
<ol class="round">
    <li class="one">
        <asp:Panel ID="pnlRec" runat="server"><h5>Getting Started with Recreation</h5><br />
            <asp:Label ID="lblMsg" runat="server" Text="Label"></asp:Label></asp:Panel>
        <asp:Panel ID="cpnlRec" runat="server"><table><tr>
                <td>Stuff</td><td>Stuff</td><td>Stuff</td>
                   </tr></table></asp:Panel>
        <asp:CollapsiblePanelExtender  ID="cpeRec" runat="server"  CollapseControlID="pnlClick" Collapsed="True" ExpandControlID="pnlClick" CollapsedText="Show" ExpandedText="Hide" TextLabelID="lblMsg" TargetControlID="cpnlRec">

        </asp:CollapsiblePanelExtender> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-14T09:46:40.383

检查 Designer.cs 文件并确认您没有对 toolkitscriptmanager 的任何其他引用。如果发现删除这些引用。清理它并构建它。这可能是错误的原因。

# mysql - Codeigniter 多对多关系循环

> ID：14491563
> 
> 赞同：0
> 
> 时间：2013-01-23T23:51:05.080
> 
> 标签：mysql, codeigniter

我有一个这样的数据库设置：

post_id | 标题

1 | 一些标题

2 | 另一个标题

* * *

tag_id | 标签

1 | 标签01

2 | 标签02

* * *

post_id | tagt_id

1 | 1

1 | 2

2 | 1

我使用以下代码加入了这些表：

```
$this->db->select('*');
$this->db->from('posts');
$this->db->join('posts_tags', 'posts.post_id = post_tags.post_id', 'inner');
$this->db->join('tags', 'posts_tags.tag_id = tags.tag_id', 'inner'); 
```

在我看来，我可以使用

```
$post['tag'] 
```

这会导致与其关联的每个标签都有重复的帖子。

问题是我如何遍历与一篇文章相关的所有标签？

预期的输出将是：

post_id 1 = 标签01，标签02

代替

post_id 1 = tag01

post_id 1 = tag02

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:03:38.833

尝试这个

```
 $this->db->select('posts.post_id,GROUP_CONCAT(posts.tag) as all_tags');
   $this->db->from('posts');
   $this->db->join('posts_tags', 'posts.post_id = post_tags.post_id', 'inner');
   $this->db->join('tags', 'posts_tags.tag_id = tags.tag_id', 'inner'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:01:53.550

如果您只想查找仅与单个帖子相关的标签，则需要过滤查询以仅使用`WHERE`子句查找您关注的帖子。

如果您的意图是返回所有帖子的所有标签，但每个帖子只有一行，标签列为逗号分隔值（或类似值），您需要查看使用这样的`GROUP_CONCAT`函数`SELECT`：

```
SELECT pt.post_id AS `post_id`, GROUP_CONCAT(t.tag) AS `tags`
FROM post_tags AS pt
INNER JOIN tags AS t ON pt.tag_id = t.tag_id
GROUP BY `post_id` 
```

# netlogo - 试图让派系分段安排？NetLogo 代码建议

> ID：14491565
> 
> 赞同：0
> 
> 时间：2013-01-23T23:51:28.000
> 
> 标签：netlogo

我制作了一个模型，将派系（不同颜色的海龟）排列成一个圆圈。

目前他们随机排列，想知道是否有人可以帮我安排它们，例如，红色占据前 90 度，蓝色占据下一个 90 度，等等（在设置中）。

这是我的代码...

```
ask patch 0 0
[ ask patches in-radius ( max-pxcor * .9) with [  random-float 100 < density ]
  [ sprout 1
    [ set breed cons
      set shape "circle" 
      set faction random factions
      set heading random 360
      set size 1
    ]
  ]
] 
```

.. 猜测我将不得不做 360 / 分数，但不知道如何表达它，如果有人可以帮助我，那就太好了。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T06:09:03.203

与您想要做的最接近的 NetLogo 原语是`in-cone`，它报告位于另一只海龟的“视锥”中的海龟集。但是你的“馅饼片”应该只是相对于`patch 0 0`，而不是另一只乌龟！没问题：只需在 处制作一个临时海龟`patch 0 0`，用它来获取`in-cone`角度合适的海龟，然后杀死你的临时海龟。

以下过程可以“按原样”与您的代码一起使用（只需`setup`在创建海龟后完全按照您之前所做的那样从您的过程中调用它）：

```
to assign-factions
  let angle 360 / factions
  foreach n-values factions [?] [
    ask patch 0 0 [ 
      sprout 1 [
        set heading ? * angle
        ask turtles in-cone max-pxcor angle [ set faction ? + 1 ]
        die
      ]
    ]
  ]
end 
```

代码非常简单，除了可能更晦涩难懂`n-values`。如果您愿意，可以用`while`循环替换它，但它实际上只是从`0`to数数`factions`。

以下是 5 个派系你会得到的：

![派系](../Images/da7a7d3159e0fba2d83bd1427c4b119c.png)

# git - Git：删除 repo 中的所有文件然后回滚提交有什么长期影响吗？

> ID：14491571
> 
> 赞同：5
> 
> 时间：2013-01-23T23:52:17.060
> 
> 标签：git

在我们的 git repo 中，我们不小心做了一个提交，删除了我们所有的文件。此提交已推送到我们的中央服务器，并已被其他开发人员拉下并构建服务器，因此重写历史以撤消此操作并不理想。相反，我们进行了另一次回滚提交，以将所有文件恢复到之前的状态，并在两者之间进行了另一次尝试的回滚提交，以某种方式仅恢复了一些文件。

```
cc043989 Rollback commit (goes back to 4bf31def)
f5d7f10e Failed rollback commit
cd60376f Delete all files commit
4bf31def Last good commit
.
.
. 
```

我们担心的是这是否会导致任何长期影响，特别是关于合并到/从功能分支和到/从子树存储库。如果将来要不断进行合并或其他更具挑战性的事情，那么可能值得重写历史并手动处理构建服务器/其他开发人员存储库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:27:57.323

假设您的历史记录如下所示：

```
A --- B --- C --- D 大师
 \
  E --- F 话题

```

在提交“B”中，您不小心删除了所有文件。在提交“C”中，您恢复所有文件。

当您将主题分支合并到主分支时，您将获得比其他方式*更多*的合并冲突。我建议重写历史，就好像文件从未被删除一样，因为保留该提交并没有真正的好处（除非它是一个非常公共的分支）。

要删除提交，

```
git checkout master
git rebase -i 4bf31def 
```

然后注释掉错误的提交：

```
# cc043989 回滚提交（回到 4bf31def）
# f5d7f10e 回滚提交失败
# cd60376f 删除所有提交的文件
4bf31def 最后一次好的提交

```

好消息是你可以慢慢来。您可以继续工作并稍后修复历史记录，也可以现在修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:24:55.443

我想说的简单答案不要担心。

如果它确实成为一个问题，你可能不得不结束有问题`git rebase`的提交。它将改写历史，但到那时它可能是不可避免的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T01:47:15.660

如果您保留回滚，结果将类似于删除所有文件，然后添加所有文件。回滚之前的任何更改都会发生冲突，因为您将有两个用于任何文件的源。

子树也会受到同样的影响，您将有一个删除所有内容的提交和另一个重新创建它的提交，从而使以前的任何更改都被视为冲突。

# c# - In C#, how do I remove a property from an ExpandoObject?

> ID：14491577
> 
> 赞同：29
> 
> 时间：2013-01-23T23:52:44.997
> 
> 标签：c#, expandoobject

Say I have this object:

```
dynamic foo = new ExpandoObject();
foo.bar = "fizz";
foo.bang = "buzz"; 
```

How would I remove `foo.bang` for example?

I don't want to simply set the property's value to null--for my purposes I need to remove it altogether. Also, I realize that I could create a whole new ExpandoObject by drawing kv pairs from the first, but that would be pretty inefficient.

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-01-23T23:55:25.287

Cast the expando to `IDictionary<string, object>` and call [`Remove`](http://msdn.microsoft.com/en-us/library/bb356469.aspx):

```
var dict = (IDictionary<string, object>)foo;
dict.Remove("bang"); 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-11-26T15:15:23.477

You can treat the [`ExpandoObject`](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx) as an [`IDictionary<string, object>`](http://msdn.microsoft.com/en-us/library/s4ys34ea.aspx) instead, and then remove it that way:

```
IDictionary<string, object> map = foo;
map.Remove("Jar"); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-01-23T23:55:56.367

MSDN Example:

```
dynamic employee = new ExpandoObject();
employee.Name = "John Smith";
((IDictionary<String, Object>)employee).Remove("Name"); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-23T23:55:27.307

You can cast it as an `IDictionary<string,object>`, and then use the explicit [Remove](http://msdn.microsoft.com/en-us/library/dd630196.aspx) method.

```
IDictionary<string,object> temp = foo;
temp.Remove("bang"); 
```

# javascript - 打开新窗口时，带有 Chrome 框架的 IE8、IE9 崩溃

> ID：14491578
> 
> 赞同：1
> 
> 时间：2013-01-23T23:52:52.570
> 
> 标签：javascript, internet-explorer, google-chrome, frame

此页面作为文件存在于目标框架 3.5 的 ASP.NET 应用程序中。

我在我的网站上遇到了一个错误（昨天首次报告），这与在 IE8 或 IE9 上安装了 Chrome Frame 的用户有关，他们点击了打开新窗口的链接。子页面打开，但是当子窗口关闭（或有时之前）时，父窗口崩溃。（屏幕完全是灰色的）。

复制此问题的测试代码如下，但我不知道发生了什么或如何解决它。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />

    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="" />
</head>
<body>
    <button id="open-link">Hi</button>

    <script>
        var a = document.getElementById("open-link");
        a.addEventListener("click", function () {
            window.open("http://google.com", "Browser");
        }, false); 
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T22:35:47.040

我在不同的平台上看到了同样的问题，所以它不是 ASP.net。如果您使用的是 Chrome Frame，请使用 window.open 打开另一个窗口，然后关闭该窗口，它会使剩余的选项卡/窗口崩溃。如果您打开的窗口不在同域策略范围内，则它会在打开而不是关闭时使打开的选项卡崩溃。

我还没有解决方法或解决方案，如果我找到了会发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:04:30.113

可以使用普通的锚链接，你说它是动态生成的。

将动态 url 设置为视图中的标签或全局命名空间中的变量。

```
var dynamicUrl = {{myUrl}},
    urlTitle = {{myUrl.title}}; // Or whatever construct is generating. 
```

HTML

```
<a href="dynamicUrl" target="_blank" alt="urlTitle">Hi</a> 
```

# c - 交流计算

> ID：14491579
> 
> 赞同：0
> 
> 时间：2013-01-23T23:52:57.527
> 
> 标签：c

这个计算背后一定有一些逻辑。但我无法得到它。正常的数学不会导致这种行为。谁能帮我解释一下原因

`printf ("float %f \n", 2/7 * 100.0);` 结果打印 1.000000

为什么这样？我不明白原因

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:54:21.210

整数除法。`2/7 = 0`作为整数，`0 * 100.0 = 0.0`作为浮点数。

做得到你`2.0/7 * 100.0`正在寻找的答案。

# ios - ios应用程序在来自后台后直接点击shouldstartloadwithrequest

> ID：14491584
> 
> 赞同：0
> 
> 时间：2013-01-23T23:53:31.227
> 
> 标签：ios, ios5.1, uiapplication, openurl

我的 mainviewcontroller 中有一个 webview，我正在 viewdidload 方法中加载一个网页，如下所示：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];

    [_loginWebView loadRequest:requestObj];

} 
```

在 shouldstartloadwithrequest 方法中，我检查 url 是否包含“itunes”，并且我有以下代码：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{

NSRange textRange4;
            textRange4 =[[[request URL] absoluteString] rangeOfString:@"itunes.apple.com"];
            if(textRange4.location != NSNotFound)
            {

               UIApplication *app = [UIApplication sharedApplication];
                NSString *newPath = [[request URL] absoluteString] ;

                if ([newPath rangeOfString:@"insider"].location != NSNotFound) {
                    NSURL *myURL = [NSURL URLWithString:@"insider://"];
                    if ([app canOpenURL:myURL]) {
                        [app openURL:myURL];
                        NSLog(@"insider");

                    }
                    else 
                    {
                        [app openURL:[NSURL URLWithString:newPath]];
                    }

                }
                else if ([newPath rangeOfString:@"reuters-news-pro-for-ipad"].location != NSNotFound) {

                      [app openURL:[NSURL URLWithString:newPath]];

                }
                else if ([newPath rangeOfString:@"thomson-reuters-marketboard"].location != NSNotFound) {
                    NSURL *myURL = [NSURL URLWithString:@"marketboard://"];
                    if ([app canOpenURL:myURL]) {
                        [app openURL:myURL];
                        NSLog(@"marketboard");
                    }
                    else
                    {
                       [app openURL:[NSURL URLWithString:newPath]];
                    }

                }
                else
                {
                    [app openURL:[NSURL URLWithString:newPath]];

                }

                return NO;

            }
return YES;
} 
```

上面的代码可以打开我想要的应用程序，但是当我从 ipad 回到我的应用程序时，而不是去主视图控制器，它会重新打开以前打开的应用程序。例如，如果我打开了 marketboard 应用程序，当我从 ipad 主页点击应用程序图标时，它会重新打开它。但是上面只发生在ios5.0，它不会发生在6.0，这真的很奇怪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:15:37.090

当您在 ios5.0 的 viewdidload 方法中有 webview loadrequest 并且他们已在 ios6.0 中修复它时，这是默认行为

# database - Magento 错误 SQLSTATE[23000]：违反完整性约束：

> ID：14491586
> 
> 赞同：0
> 
> 时间：2013-01-23T23:53:57.027
> 
> 标签：database, magento

最近，我们将选择的产品、客户、订单等从 Zen Cart 迁移到 Magento。第一次迁移完美无缺，索引很好，所以我们继续迁移所有产品等。迁移所有产品后，我们尝试运行各种重新索引，但出现错误。下面是错误日志。

```
Error:
SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`ecigexpr_newecx`.`cataloginventory_stock_status`, CONSTRAINT `FK_CATINV_STOCK_STS_WS_ID_CORE_WS_WS_ID` FOREIGN KEY (`website_id`) REFERENCES `core_website` (`website_id`) ON DELETE CASCADE ON)

2013-01-23T23:43:38+00:00 DEBUG (7): Exception message: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`ecigexpr_newecx`.`cataloginventory_stock_status`, CONSTRAINT `FK_CATINV_STOCK_STS_WS_ID_CORE_WS_WS_ID` FOREIGN KEY (`website_id`) REFERENCES `core_website` (`website_id`) ON DELETE CASCADE ON)
Trace: #0 /home/ecigexpr/public_html/ecximproved/lib/Varien/Db/Statement/Pdo/Mysql.php(110): Zend_Db_Statement_Pdo->_execute(Array)
#1 /home/ecigexpr/public_html/ecximproved/lib/Zend/Db/Statement.php(300): Varien_Db_Statement_Pdo_Mysql->_execute(Array)
#2 /home/ecigexpr/public_html/ecximproved/lib/Zend/Db/Adapter/Abstract.php(479): Zend_Db_Statement->execute(Array)
#3 /home/ecigexpr/public_html/ecximproved/lib/Zend/Db/Adapter/Pdo/Abstract.php(238): Zend_Db_Adapter_Abstract->query('INSERT INTO `ca...', Array)
#4 /home/ecigexpr/public_html/ecximproved/lib/Varien/Db/Adapter/Pdo/Mysql.php(419): Zend_Db_Adapter_Pdo_Abstract->query('INSERT INTO `ca...', Array)
#5 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Resource/Abstract.php(179): Varien_Db_Adapter_Pdo_Mysql->query('INSERT INTO `ca...')
#6 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Resource/Helper/Mysql4.php(48): Mage_Index_Model_Resource_Abstract->insertFromSelect(Object(Varien_Db_Select), 'cataloginventor...', Array, false)
#7 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Resource/Abstract.php(153): Mage_Index_Model_Resource_Helper_Mysql4->insertData(Object(Mage_CatalogInventory_Model_Resource_Indexer_Stock), Object(Varien_Db_Select), 'cataloginventor...', Array, false)
#8 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Resource/Abstract.php(113): Mage_Index_Model_Resource_Abstract->insertFromTable('cataloginventor...', 'cataloginventor...', false)
#9 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/CatalogInventory/Model/Resource/Indexer/Stock.php(251): Mage_Index_Model_Resource_Abstract->syncData()
#10 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Indexer/Abstract.php(143): Mage_CatalogInventory_Model_Resource_Indexer_Stock->reindexAll()
#11 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Process.php(209): Mage_Index_Model_Indexer_Abstract->reindexAll()
#12 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Process.php(255): Mage_Index_Model_Process->reindexAll()
#13 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/Model/Process.php(249): Mage_Index_Model_Process->reindexEverything()
#14 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Index/controllers/Adminhtml/ProcessController.php(124): Mage_Index_Model_Process->reindexEverything()
#15 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Core/Controller/Varien/Action.php(419): Mage_Index_Adminhtml_ProcessController->reindexProcessAction()
#16 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('reindexProcess')
#17 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#18 /home/ecigexpr/public_html/ecximproved/app/code/core/Mage/Core/Model/App.php(354): Mage_Core_Controller_Varien_Front->dispatch()
#19 /home/ecigexpr/public_html/ecximproved/app/Mage.php(683): Mage_Core_Model_App->run(Array)
#20 /home/ecigexpr/public_html/ecximproved/index.php(89): Mage::run('', 'store')
#21 {main} 
```

我可以清楚地看到问题出在 cataloginventory_stock_status 和 website_id 中，但不知道如何纠正它。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:11:34.087

我们永远找不到真正的解决方案，但我们最终转移到另一台服务器并安装了一个新的 magento 副本。然后我们在 phpmyadmin 中导入数据库，一切正常。由于数据库中的任何内容都没有改变，因此我相信可能是锁定文件、损坏或其他原因导致了文件方面的问题（而不是在数据库中）。如果您遇到这种情况，您可能需要先清除缓存和锁定文件，然后用备份覆盖。如果这不起作用，导出数据库，重新安装 magento 并导入数据库是我能想出的唯一解决方案。虽然不是最佳解决方案，但我们不再遇到问题。

# javascript - knockout.js - 嵌套数组数据和级联预填充下拉列表绑定

> ID：14491591
> 
> 赞同：4
> 
> 时间：2013-01-23T23:54:27.747
> 
> 标签：javascript, data-binding, knockout.js, cascadingdropdown

我对 knockout.js 还很陌生，但是，我一直很高兴在我的 ASP.NET MVC 4 项目中使用它，直到我遇到了这个困扰我一段时间的障碍，似乎无法将我的手指在它上面。

我正在处理的场景需要位置数据（地区、国家、城市）的多种组合，即级联下拉列表，在输入新数据时这不是问题，但我在尝试时遇到了问题编辑保存的数据。

数据采用 JSON 格式，带有嵌套数组，如下所示（为便于说明而缩短）：

```
var newData = 
[
  {
    "ID":1,
    "Name":"Australia and New Zealand",
    "Countries":[
      {
        "ID":13,
        "Name":"Australia",
        "Cities":[
          {
            "ID":19,
            "Name":"Brisbane"
          },
          {
            "ID":28,
            "Name":"Cairns"
          },
... 
```

我怀疑我无法正确加载数据（或更清楚地，**绑定**它），因为我无法访问 Region 子数组（包含 Region 的国家）和 Country 子数组（包含国家的城市） .

然后是预填充选项的问题，它部分工作，视图模型加载行数，但不选择任何内容。

这是虚拟机：

```
 var existingRows = [
    {
        "Region": 1,
        "Country": 13,
        "City": 19
    },
    {
        "Region": 1,
        "Country": 158,
        "City": 3
    }];

   var Location = function (region, country, city) {
       var self = this;
       self.region = ko.observable(region);
       self.country = ko.observable(country);
       self.city = ko.observable(city);

       // Whenever the region changes, reset the country selection
       self.region.subscribe(function () {
           self.country(undefined);
       });

       // Whenever the country changes, reset the city selection
       self.country.subscribe(function () {
           self.city(undefined);
       });
   };

   var LocationViewModel = function (data) {
       var self = this;

       self.lines = ko.observableArray(ko.utils.arrayMap(data, function (row)
       {
           var rowRegion = ko.utils.arrayFirst(newData, function (region)
           {
               return region.ID == row.Region;
           });
           var rowCountry = ko.utils.arrayFirst(rowRegion.Countries, function (country) {
               return country.ID == row.Country;
           });
           var rowCity = ko.utils.arrayFirst(rowCountry.Cities, function (city) {
           return city.ID == row.City;
           });
           return new Location(rowRegion, rowCountry, rowCity);
       }));

       // Operations
       self.addLine = function () {
           self.lines.push(new Location())
       };
       self.removeLine = function (line) {
           self.lines.remove(line)
       };
   };

   var lvm = new LocationViewModel(existingRows);

   $(function () {
       ko.applyBindings(lvm);
   }); 
```

HTML 代码：

```
<tbody data-bind="foreach: lines">
    <tr>
        <td><select data-bind="options: newData, optionsText: 'Name', optionsValue: 'ID', optionsCaption: 'Select a region...', attr: { name: 'SubRegionIndex' + '['+$index()+']' }, value: region"></select></td>
        <td><select data-bind="options: Countries, optionsText: 'Name', optionsValue: 'ID', optionsCaption: 'Select a country...', attr: { name: 'CountryIndex' + '['+$index()+']' }, value: country"></select></td>
        <td><select data-bind="options: Cities, optionsText: 'Name', optionsValue: 'ID', optionsCaption: 'Select a city...', attr: { name: 'CityIndex' + '['+$index()+']' }, value: city"></select></td>
        <td><a href='#' data-bind='click: $parent.removeLine'>Remove</a></td>
    </tr>    
</tbody> 
```

我尝试使用预填充数据修改来自 knockout.js 网站的购物车编辑器示例，但并没有真正取得太大进展，我似乎遗漏了一些东西。没有真正找到嵌套数组的任何东西，所以我被困在这里......

我在 JSFiddle 上放了完整的代码：http: [//jsfiddle.net/fgXA2/1/](http://jsfiddle.net/fgXA2/1/)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T20:56:11.230

问题是您绑定到选择列表中所选项目的方式：

```
<select data-bind="
    options: newData, 
    optionsText: 'Name', 
    optionsValue: 'ID', 
    value: region">
</select> 
```

在这里`ID`，您将 JSON 数据中的`region`属性绑定到视图模型上的属性。

这意味着当您绑定第二个选择列表时：

```
<td data-bind="with: region">
    <select data-bind="
        options: Countries, 
        optionsText: 'Name', 
        optionsValue: 'ID', 
        value: $parent.country">
    </select>
</td> 
```

您尝试绑定到`region.Countries`. 但是，`region`仅包含所选区域`ID`。在这种情况下，控制台是您的朋友：

> 未捕获的错误：无法解析绑定。消息：ReferenceError：未定义国家；

您的第三个 Cities 选择列表也存在同样的问题，因为您现在尝试绑定到`country.Cities`where`country`也只是`ID`.

这里有两个选项。第一个是删除参数，从而将*实际*`optionsValue`的 JSON 对象绑定到您的视图模型属性。唯一的问题是您的 Cities 选择框上的绑定错误（您绑定到而不是）：*`CityName``Name`*

 *[http://jsfiddle.net/benfosterdev/wHtRZ/](http://jsfiddle.net/benfosterdev/wHtRZ/)

从示例中可以看出，我使用该`ko.toJSON`实用程序来输出视图模型的对象图。这对于解决问题非常有用（在您的情况下，您会看到该`region`属性只是一个数字）。

上述方法的缺点是您最终会在视图模型中存储所选国家/地区的所有国家及其城市的副本。

如果处理大型数据集，一个更好的解决方案是只存储选定的标识符（我相信你最初试图这样做），然后定义计算属性来过滤你的单个数据集以获得所需的值。

这方面的一个例子可以在[http://jsfiddle.net/benfosterdev/Bbbt3](http://jsfiddle.net/benfosterdev/Bbbt3)看到，使用以下计算属性：

```
 var getById = function (items, id) {
        return ko.utils.arrayFirst(items, function (item) {
            return item.ID === id;
        });
    };

    this.countries = ko.computed(function () {
        var region = getById(this.selectedRegion.regions, this.selectedRegion());
        return region ? ko.utils.arrayMap(region.Countries, function (item) {
            return {
                ID: item.ID,
                Name: item.Name
            };
        }) : [];
    }, this);

    this.cities = ko.computed(function () {
        var region = getById(this.selectedRegion.regions, this.selectedRegion());
        if (region) {
            var country = getById(region.Countries, this.selectedCountry());
            if (country) {
                return country.Cities;
            }
        }

    }, this); 
```

您可以从渲染的对象图中看到，只有当前选定的国家和城市被复制到视图模型中。*

# javascript - 使用 JavaScript 防止下拉列表中的重复选择

> ID：14491594
> 
> 赞同：-1
> 
> 时间：2013-01-23T23:54:40.407
> 
> 标签：javascript

我有 5 个下拉列表，命名为 sample1 到 sample5...每个下拉列表都包含相同的选项列表（使用 ASP 从我的 SQL 填充），但我需要阻止它们提交重复项。所有5个都需要不同。但是，可以接受 0 作为它们中的每一个的值（空白）。

```
FREE Sample Choice 1: <select name="sample1" onChange="JavaScript:FOSamples()">
<option value="0"></option>
<option value="FOABSOLUTETULIP">Fragrance Oil: Absolute Tulip BBW Type</option>
<option value="FOAFRICANMUSK">Fragrance Oil: African Musk</option>
<option value="FOALMOND">Fragrance Oil: Almond</option>
<option value="FOAMAR">Fragrance Oil: Amaretto</option>
<option value="FOAMBER">Fragrance Oil: Amber</option>
<option value="FOAMBERROM">Fragrance Oil: Amber Romance Victoria's Secret Type</option>
<option value="FOANAIS">Fragrance Oil: Anais Anais Type</option>
<option value="FOANGEL">Fragrance Oil: Angel Type</option>
<option value="FOAPPLEBLOS">Fragrance Oil: Apple Blossoms</option>
<option value="FOAPPLEJACK">Fragrance Oil: Apple Jack & Peel</option>
<option value="FOAPPLESP">Fragrance Oil: Apple Spice</option>
<option value="FOAPPLEOAK">Fragrance Oil: Apples & Oak</option>
<option value="FOAPRICOT">Fragrance Oil: Apricot</option>
<option value="FOAPRICOTPEAR">Fragrance Oil: Apricot & Pear Yankee Type</option>
<option value="FOAPRCREME">Fragrance Oil: Apricot Creme</option>
<option value="FOAQUAREEF">Fragrance Oil: Aqua Reef Old Spice Type</option>
<option value="FOARABIANMUSK">Fragrance Oil: Arabian Musk</option>
<option value="FOASIANPEAR">Fragrance Oil: Asian Pear</option>
<option value="FOASIANPLUM">Fragrance Oil: Asian Plum Blossom</option>
<option value="FOAUTUMNWOODS">Fragrance Oil: Autumn Woods</option>
</select><br>
FREE Sample Choice 2: <select name="sample2" onChange="JavaScript:FOSamples()">

<option value="0"></option>
<option value="FOABSOLUTETULIP">Fragrance Oil: Absolute Tulip BBW Type</option>
<option value="FOAFRICANMUSK">Fragrance Oil: African Musk</option>
<option value="FOALMOND">Fragrance Oil: Almond</option>
<option value="FOAMAR">Fragrance Oil: Amaretto</option>
<option value="FOAMBER">Fragrance Oil: Amber</option>
<option value="FOAMBERROM">Fragrance Oil: Amber Romance Victoria's Secret Type</option>
<option value="FOANAIS">Fragrance Oil: Anais Anais Type</option>
<option value="FOANGEL">Fragrance Oil: Angel Type</option>
<option value="FOAPPLEBLOS">Fragrance Oil: Apple Blossoms</option>
<option value="FOAPPLEJACK">Fragrance Oil: Apple Jack & Peel</option>
<option value="FOAPPLESP">Fragrance Oil: Apple Spice</option>
<option value="FOAPPLEOAK">Fragrance Oil: Apples & Oak</option>
<option value="FOAPRICOT">Fragrance Oil: Apricot</option>
<option value="FOAPRICOTPEAR">Fragrance Oil: Apricot & Pear Yankee Type</option>
<option value="FOAPRCREME">Fragrance Oil: Apricot Creme</option>
<option value="FOAQUAREEF">Fragrance Oil: Aqua Reef Old Spice Type</option>
<option value="FOARABIANMUSK">Fragrance Oil: Arabian Musk</option>
<option value="FOASIANPEAR">Fragrance Oil: Asian Pear</option>
<option value="FOASIANPLUM">Fragrance Oil: Asian Plum Blossom</option>
<option value="FOAUTUMNWOODS">Fragrance Oil: Autumn Woods</option>
</select><br>

FREE Sample Choice 3: <select name="sample3" onChange="JavaScript:FOSamples()">
<option value="0"></option>
<option value="FOABSOLUTETULIP">Fragrance Oil: Absolute Tulip BBW Type</option>
<option value="FOAFRICANMUSK">Fragrance Oil: African Musk</option>
<option value="FOALMOND">Fragrance Oil: Almond</option>
<option value="FOAMAR">Fragrance Oil: Amaretto</option>
<option value="FOAMBER">Fragrance Oil: Amber</option>
<option value="FOAMBERROM">Fragrance Oil: Amber Romance Victoria's Secret Type</option>
<option value="FOANAIS">Fragrance Oil: Anais Anais Type</option>
<option value="FOANGEL">Fragrance Oil: Angel Type</option>
<option value="FOAPPLEBLOS">Fragrance Oil: Apple Blossoms</option>
<option value="FOAPPLEJACK">Fragrance Oil: Apple Jack & Peel</option>
<option value="FOAPPLESP">Fragrance Oil: Apple Spice</option>
<option value="FOAPPLEOAK">Fragrance Oil: Apples & Oak</option>
<option value="FOAPRICOT">Fragrance Oil: Apricot</option>
<option value="FOAPRICOTPEAR">Fragrance Oil: Apricot & Pear Yankee Type</option>
<option value="FOAPRCREME">Fragrance Oil: Apricot Creme</option>
<option value="FOAQUAREEF">Fragrance Oil: Aqua Reef Old Spice Type</option>
<option value="FOARABIANMUSK">Fragrance Oil: Arabian Musk</option>
<option value="FOASIANPEAR">Fragrance Oil: Asian Pear</option>
<option value="FOASIANPLUM">Fragrance Oil: Asian Plum Blossom</option>
<option value="FOAUTUMNWOODS">Fragrance Oil: Autumn Woods</option>
</select><br>

FREE Sample Choice 4: <select name="sample4" onChange="JavaScript:FOSamples()">
<option value="0"></option>
<option value="FOABSOLUTETULIP">Fragrance Oil: Absolute Tulip BBW Type</option>
<option value="FOAFRICANMUSK">Fragrance Oil: African Musk</option>
<option value="FOALMOND">Fragrance Oil: Almond</option>
<option value="FOAMAR">Fragrance Oil: Amaretto</option>
<option value="FOAMBER">Fragrance Oil: Amber</option>
<option value="FOAMBERROM">Fragrance Oil: Amber Romance Victoria's Secret Type</option>
<option value="FOANAIS">Fragrance Oil: Anais Anais Type</option>
<option value="FOANGEL">Fragrance Oil: Angel Type</option>
<option value="FOAPPLEBLOS">Fragrance Oil: Apple Blossoms</option>
<option value="FOAPPLEJACK">Fragrance Oil: Apple Jack & Peel</option>
<option value="FOAPPLESP">Fragrance Oil: Apple Spice</option>
<option value="FOAPPLEOAK">Fragrance Oil: Apples & Oak</option>
<option value="FOAPRICOT">Fragrance Oil: Apricot</option>
<option value="FOAPRICOTPEAR">Fragrance Oil: Apricot & Pear Yankee Type</option>
<option value="FOAPRCREME">Fragrance Oil: Apricot Creme</option>
<option value="FOAQUAREEF">Fragrance Oil: Aqua Reef Old Spice Type</option>
<option value="FOARABIANMUSK">Fragrance Oil: Arabian Musk</option>
<option value="FOASIANPEAR">Fragrance Oil: Asian Pear</option>
<option value="FOASIANPLUM">Fragrance Oil: Asian Plum Blossom</option>
<option value="FOAUTUMNWOODS">Fragrance Oil: Autumn Woods</option>
</select><br>

FREE Sample Choice 5: <select name="sample5" onChange="JavaScript:FOSamples()">
<option value="0"></option>
<option value="FOABSOLUTETULIP">Fragrance Oil: Absolute Tulip BBW Type</option>
<option value="FOAFRICANMUSK">Fragrance Oil: African Musk</option>
<option value="FOALMOND">Fragrance Oil: Almond</option>
<option value="FOAMAR">Fragrance Oil: Amaretto</option>
<option value="FOAMBER">Fragrance Oil: Amber</option>
<option value="FOAMBERROM">Fragrance Oil: Amber Romance Victoria's Secret Type</option>
<option value="FOANAIS">Fragrance Oil: Anais Anais Type</option>
<option value="FOANGEL">Fragrance Oil: Angel Type</option>
<option value="FOAPPLEBLOS">Fragrance Oil: Apple Blossoms</option>
<option value="FOAPPLEJACK">Fragrance Oil: Apple Jack & Peel</option>
<option value="FOAPPLESP">Fragrance Oil: Apple Spice</option>
<option value="FOAPPLEOAK">Fragrance Oil: Apples & Oak</option>
<option value="FOAPRICOT">Fragrance Oil: Apricot</option>
<option value="FOAPRICOTPEAR">Fragrance Oil: Apricot & Pear Yankee Type</option>
<option value="FOAPRCREME">Fragrance Oil: Apricot Creme</option>
<option value="FOAQUAREEF">Fragrance Oil: Aqua Reef Old Spice Type</option>
<option value="FOARABIANMUSK">Fragrance Oil: Arabian Musk</option>
<option value="FOASIANPEAR">Fragrance Oil: Asian Pear</option>
<option value="FOASIANPLUM">Fragrance Oil: Asian Plum Blossom</option>
<option value="FOAUTUMNWOODS">Fragrance Oil: Autumn Woods</option>
</select><br> 
```

[5 Dropdowns Fiddle 示例](http://jsfiddle.net/Kateriana/nDGu8/)

下拉列表是相同的，所以也许在选择时从其他 4 个中删除选项会更好？我真的不确定 JavaScript 的功能（我的专长是 ASP 和 SQL）。我应该做一个下拉菜单并将其限制为 5 个 Ctrl+单击选项吗？我也开始尝试这种布局。

[单个多个下拉](http://jsfiddle.net/Kateriana/N4uHd/1/)

我不确定我的老板会更喜欢哪个选项。我们现在使用 5 个下拉菜单，但也许另一个会更干净。您是否对人们不了解如何选择多个项目有问题？

你们中的一位 JavaScript 专家可以编写我的 FOSamples 函数来工作吗？OnChange 是要使用的正确 javascript 吗？现在，办公室只需要注意重复并手动删除并替换为其他内容。

```
<script type="text/javascript">
<!--
    function FOSamples() {

    }
-->
</script> 
```

马哈洛！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:15:37.273

快速而肮脏的纯 JS 实现：http: [//jsfiddle.net/nDGu8/8/](http://jsfiddle.net/nDGu8/8/)

```
var old_values = {}; // memorize old value of select before it was changed

// to be called with an event listener, i.e. this refers to the changed <select>
function FOSamples() {
    if (old_values[this.name]) { // if there were options disabled, re-enable them
        // find all <options value=OLD_VALUE>
        var s = document.querySelectorAll('option[value="' + old_values[this.name] + '"]');
        [].forEach.call(s, function (option) {
            option.disabled = false;
        });
    }
    // find all <options value=NEW_VALUE>
    var s = document.querySelectorAll('option[value="' + this.value + '"]');
    [].forEach.call(s, function (option) {
        if (option.parentNode !== this) {
            // if it is not the <select> the user has just changed, disable the <option>
            option.disabled = true;
        }
    }, this);
    // memorize value
    old_values[this.name] = this.value;
} 
```

使用 JQuery 实现整个实现会更容易。如果您考虑使用 JQuery，最好使用评论中提到的 widged @btoueg。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T21:52:15.013

这是使用 jQuery 和多选小部件的方法：http: [//jsfiddle.net/YQZw8/2](http://jsfiddle.net/YQZw8/2)

```
$(function(){
    // make sure no option is selected by default
    $("select").prop("selectedIndex", -1);
    // add "multiple select" widget, and set max options to 5
    $("select").multiselect({
      click: function(e){
        if( $(this).multiselect("widget").find("input:checked").length > 5 ){
          return false;
        }
      }
    }); 
}); 
```

不过，您需要包含一些 javascript 和 CSS。

# javascript - 如何下载网页的源代码？

> ID：14491598
> 
> 赞同：2
> 
> 时间：2013-01-23T23:55:07.120
> 
> 标签：javascript, html, r

当我使用 FireFox 的“检查元素”功能时，HTML 源文件中没有显示 div 标签。换句话说，我需要的信息是 JavaScript 代码，而不是 HTML 页面源代码。有没有办法将此信息读入R？

我发现了一个类似的问题：[如何使用 R 查看网页源代码？](https://stackoverflow.com/questions/9778076/how-to-view-webpage-source-code-using-r?rq=1)

带有建议的代码：

```
mz <- socketConnection("localhost", "4242")
writeLines("var w=window.open(\"https://google.com\")\n",mz)
out <- readLines(mz) #empty the buffer
writeLines("w.document.getElementsByTagName('html')[0].innerHTML\n", mz)
out <- readLines(mz)
str(out) 
```

但它为我返回 chr(0)。

有人可以提供上述 R 代码的帮助，或提出替代解决方案吗？

谢谢。

已解决：上面的代码以前不起作用，但这是由于没有给页面足够的时间来加载。可能不是解决这个问题的最有效方法，但仍然是一个解决方案。感谢大家

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-24T00:35:43.300

您可以使用`getURL`from [**RCurl**](http://cran.r-project.org/package=RCurl)来获取 HTTP 响应。

```
library(RCurl)
address <- "https://discussions.apple.com/thread/4356115?tstart=0"
txt <- getURL(address) 
```

现在您可以在开始标签上吐出字符串，然后在结束标签上拆分它

```
ss <- strsplit(txt, "<strong class=\"jive-thread-reply-message-correct-label\">")[[1]]
strsplit(ss[2], "</strong>")[[1]][1] 
```

这使：

```
[1] "This solved my question" 
```

* * *

事实证明，您想要的 div 标签不止一个，而上面的标签是错误的。我不知道如何纯粹在 R 中做到这一点，但我遵循了[VitoshKa](https://stackoverflow.com/users/453735/vitoshka)[引用](https://stackoverflow.com/a/9790136/967840)的帖子，我让它工作了。

首先，在 Firefox 中，转到工具 -> 附加组件。搜索并安装 mozrepl。然后，在 Firefox 中单击工具 -> MozRepl -> 开始。

现在，在**R**中：

```
mz <- socketConnection("localhost", "4242")
writeLines("var w=window.open(\"https://discussions.apple.com/thread/4356115?tstart=0\")\n",mz)
out <- readLines(mz) #empty the buffer
writeLines("w.document.getElementsByTagName('html')[0].innerHTML\n", mz)
out <- readLines(mz)

(loc <- grep("jive-thread-reply-message-correct-label", out))
#[1] 1150 2845 
```

现在，`out`是一个向量`loc`保存包含您的标签的字符串的位置。它出现两次。第一个是你感兴趣的。

```
out[loc[1]] 
```

您可以使用上面显示的相同方式从中提取信息`strsplit`，或者使用正则表达式和`gsub`

* * *

您可以关闭打开的窗口`writeLines("w.window.close()", mz)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:59:59.397

您必须在 html 上运行完整的 javascript 解释器。

你可以使用[犀牛](https://developer.mozilla.org/en-US/docs/Rhino)。它会很慢。

否则，您将需要像[selenium RC](http://seleniumhq.org/projects/remote-control/)那样驱动浏览器。（您可以使用 selenium .net 库）

您最好通过检查来弄清楚 javascript 的作用，而不是幼稚的抓取。

如果您对抓取很认真，还可以学习 XPATH 查询。

# javascript - 如何使用 Google Maps API 设置图层顺序？

> ID：14491600
> 
> 赞同：1
> 
> 时间：2013-01-23T23:55:11.017
> 
> 标签：javascript, google-maps-api-3

我正在开发一个网络地图站点（使用谷歌地图 api 3.0 和 javascript），它结合了显示在谷歌地图顶部的 wms 图层和地面叠加层（上传的栅格）。该软件运行良好，除了我在控制图层的绘制顺序时遇到问题。我希望将 wms 图层（NRCS 土壤图层）显示在自定义光栅图像的顶部，并将谷歌地图作为基础图层。目前，wms 图层按预期显示在谷歌地图图层之上，但被栅格图层覆盖。问题是：谷歌地图 api 是否允许控制图层的显示顺序（在我的情况下，矢量图层位于谷歌地图之上的栅格层之上）？我曾尝试设置显示顺序的 zindex，但这没有奏效（但我很容易遗漏一些东西）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T05:28:41.720

WMS 图层也是栅格，而不是矢量——我假设您将 ImageMapType 与 GroundOverlay 一起使用？

撇开这一点不谈，一旦将图层添加到地图中，目前就无法控制图层顺序。

作为一个黑客（未经测试），您可能希望按照您希望它们被绘制的顺序添加图层，在它们之间有一些超时......我认为这可能有效（再次，未经测试）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-08T08:40:18.713

（可选的）。我如何订购它。

首先我像这样在对象中创建图层。

```
 layer = {};
        layer.nrcs_soils= new google.maps.ImageMapType({
            getTileUrl: function (coord, zoom) {
                return getTileWmsUrl(coord, zoom, "nrcs_soils");
            },
            tileSize: new google.maps.Size(256, 256),
            opacity: 1,
            name:'nrcs_soils',
            alt:{
                layer_name:'nrcs_soils'
                ,order   : 0
            },
            isPng: true
        }); 
```

之后，我创建了简单的函数将图层添加到地图。

```
add_layer = function(layer_name){
   //-- get order from object layer
   var order_layer =layer[layer_name].alt.order;
   map.overlayMapTypes.insertAt(order_layer ,layer[layer_name]); 
```

}

只需从对象层的设置中调用此函数以添加和订购层。

```
add_layer("nrcs_soils"); 
```

# c# - Windows 8 问题（为什么使用 App.Current.Resources？为什么使用 GridView 项？）

> ID：14491601
> 
> 赞同：1
> 
> 时间：2013-01-23T23:55:11.457
> 
> 标签：c#, windows-8

[关于我正在阅读的教程](http://msdn.microsoft.com/en-us/library/windows/apps/br211380.aspx)，我有 2 个问题。

Q1。

通过教程，他们使用数据源

> 使用应用程序中的数据
> 
> 若要在应用程序中使用数据，请在 App.xaml 中创建数据源实例作为资源。您将实例命名为 feedDataSource。
> 
> BR211380.wedge(zh-cn,WIN.10).gif向应用程序添加资源
> 
> ```
> Double-click App.xaml in Solution Explorer. The file opens in the XAML editor.
> Add the resource declaration, <local:FeedDataSource x:Key="feedDataSource"/>, to the root ResourceDictionary, after the
> MergedDictionaries collection. 
> ```

然后他们在 OnLaunch 方法中使用它。

```
 var connectionProfile = Windows.Networking.Connectivity.NetworkInformation.GetInternetConnectionProfile();
 if (connectionProfile != null)
 {
     FeedDataSource feedDataSource = (FeedDataSource)App.Current.Resources["feedDataSource"];
     if (feedDataSource != null)
     {
         if (feedDataSource.Feeds.Count == 0)
         {
             await feedDataSource.GetFeedsAsync();
         }
     }
 } 
```

我想知道他们为什么将它存储在资源中？为什么不只创建一个类的实例并从中获取结果？

Q2。

在文章的后面，他们将此数据源项与“网格视图项”一起使用。我在他们的其他模板项目中看到了这一点。我想知道是否有制作界面的标准方法？

起初我想也许只是在屏幕上放一些图像按钮并连接他们的点击事件，但现在我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:47:19.640

The XAML Resource essentially does create an instance for you and makes it available in the Resources collection, so you could instantiate the class yourself. Having it as a resource keeps this object around and makes it accessible across the various pages in your application. You could certainly create the class explicitly, and if you enforce the singleton pattern on it, it would be semantically equivalent.

I'm not sure I see the context of your second question in the tutorial, but in general the pattern you are seeing is [Model-View-ViewModel (MVVM)](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj721615), which is the de facto standard pattern for Windows Store apps. `feedDataSource` is providing the model and portions of that are assigned to `DefaultViewModel`, which is the `DataContext` for all of the binding markup in the XAML pages, which are the views. The idea behind this to separate your data from your model, so that when you do things like load a new data feed, etc., all you need to do is change the data source, and all of the data binding markup will automatically reflect the new data in your user interface.

If you find yourself writing code that looks like TextBox.Text = "My text", then you're deviating from the pattern.

# url - 如何在 CakePHP 中检查控制器的操作是否有路由 URL？

> ID：14491604
> 
> 赞同：1
> 
> 时间：2013-01-23T23:55:15.030
> 
> 标签：url, cakephp, routing, routes

当请求创建 URL/链接（使用路由器数组）时，是否有一个 CakePHP 方法会响应是否匹配模式，因此是否可以为请求返回友好的 URL？

**示例：**没有路由匹配`array('controller' => 'thing', 'action' => 'show', 'abc' => 'def')`将返回 'default'*控制器/操作/参数：值*结构`/thing/show/abc:def`。

我想知道 URL 请求是否由路由形成。否则，该 URL 以及控制器的操作不应公开访问。

**笔记：**

我已经从**routes.php**`require CAKE . 'Config' . DS . 'routes.php';`中删除了该行，所以不应该有任何控制器/动作的“默认”匹配，但使用*url*方法仍然返回“默认”结构化 URL。将此结果用作测试 URL 请求是否有效/公开可用会更方便。

 ***我知道*Router*使用的*CakeRoute*具有在对所有连接的路由进行测试后在不匹配的 URL 上返回 false 的方法，但我不知道如何从*Router*访问此功能。*`match()`****

# selenium - selenium：测试“提交时禁用”行为

> ID：14491608
> 
> 赞同：3
> 
> 时间：2013-01-23T23:55:50.003
> 
> 标签：selenium, webdriver, selenium-webdriver

我们正在使用 Selenium WebDriver 来测试一个具有双重预防行为的表单。有一些简单的 javascript 会在单击时禁用按钮，这样用户就不会意外地两次发布相同的内容。

我们如何测试这个？

问题是`button.click()`在下一页加载之前的块，此时我们当然不能断言关于前一页上的按钮的任何内容。即使我们要以某种方式使`.click()`非阻塞，也存在固有的竞争条件；如果浏览器/javascript 比测试系统快得多，它将能够在测试断言有关按钮的任何内容之前卸载页面。

没有 javascript 注入黑客的解决方案的奖励积分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T01:57:26.937

基于`Esc`取消每个浏览器和操作系统中的页面加载的假设，这应该有效：

```
WebElement input = driver.findElement(By.tagName("input")); 
input.sendKeys(Keys.ENTER, Keys.ESCAPE);
Assert.assertFalse(input.isEnabled()); 
```

它快速连续发送`Enter`和`Esc`到按钮，以便触发 JavaScript，但页面加载没有机会启动。我能看到的唯一问题是你将无法使用这个进入下一页除非您刷新并发送新表格，否则请进行测试。但无论如何，我们一次只应该测试一个功能，所以你很好;-)。

* * *

**编辑**（解决您的评论）

其实，是！您可以尝试通过[高级用户交互 API](http://seleniumhq.org/docs/04_webdriver_advanced.jsp#advanceduserinteractions) ( [JavaDocs](http://selenium.googlecode.com/svn/trunk/docs/api/java/index.html?org/openqa/selenium/interactions/Actions.html) )`Esc`同时发送点击和密钥。*您也可以通过这种方式实现非阻塞点击。*

 *无论如何，这种方法仍然发送两个请求，这不是可以想象的最快的事情，但它（有时几乎没有）通过了我的测试，所以你可以试一试：

```
WebElement input = driver.findElement(By.tagName("input"));
new Actions(driver)
        .click(input)
        .sendKeys(input, Keys.ESCAPE)
        .perform(); 
```

* * *

测试环境：带有本地存储文件的IE8和FF18以及Selenium 2.29.1；赢得 XP SP3。测试文件如下所示：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Test</title>
</head>
<body>
    <a href="http://google.com/">
        <input type="button" value="Hello." onclick="this.disabled='true';" />
    </a>
</body>
</html> 
```*

# actionscript-3 - 对嵌套在其他 displayObjects 中的 displayObject 进行视觉克隆，并将克隆添加到相同位置、旋转等的舞台层

> ID：14491610
> 
> 赞同：2
> 
> 时间：2013-01-23T23:55:55.650
> 
> 标签：actionscript-3, matrix, bitmap, transform, bitmapdata

我希望能够抓取嵌套在其他*转换*后的DisplayObject（旋转、缩放、拉伸的对象）中的 DisplayObject 的副本，并能够将其标记回相同的视觉位置，但在舞台层上。本质上，能够克隆嵌套的 DisplayObject，但能够将克隆添加到舞台层，但使其与原始对象（相同的位置、比例、旋转）完美对齐（视觉上）

我一直在从事以下工作：

```
// draw the pixels of a displayobject into a new bitmap object
var bitmapData:BitmapData = new BitmapData(nestedSprite.width, nestedSprite.height, true, 0xFFFFFF);
var bitmap:Bitmap = new Bitmap(bitmapData);
bitmapData.draw(nestedSprite);

// put the copy on the top most layer
stage.addChild(bitmap);

// position the copy to perfectly overlay the original, but on the top stage layer
var point:Point = nestedSprite.localToGlobal(new Point(0, 0));
bitmap.x = point.x;
bitmap.y = point.y; 
```

但这仅适用于父母未转换的 displayObjects；`(0,0)`对于完全位于原点的 displayObjetcs 。对于居中对齐的对象或缩放的父对象等，它会崩溃。

我知道我可以在`.draw()`方法中添加一个矩阵参数，以及一个剪切矩形，然后缩放我的位图，或者将一个对象的变换设置为另一个，或者使用`.transform.concatenatedMatrix`，或者使用`nestedObject.getBounds(null)`，或者`nestedSprite.getBounds(nestedSprite)`，等等。但我有不幸的是，陷入了对这个问题进行*试错编程*，并且有很多变量，这从来都不是解决编程问题的好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:09:16.560

我相信这个函数应该可以工作，唯一的额外步骤是偏移连接矩阵，以便目标将在位图的左上角 (0, 0) 处绘制，即使它的原点在其他地方。希望其余部分是不言自明的，但如果有什么没有意义，我可以添加更多评论。

```
function createBitmapClone(target:DisplayObject):Bitmap {
    var targetTransform:Matrix = target.transform.concatenatedMatrix;
    var targetGlobalBounds:Rectangle = target.getBounds(target.stage);
    var targetGlobalPos:Point = target.localToGlobal(new Point());

    // Calculate difference between target origin and top left.
    var targetOriginOffset:Point = new Point(targetGlobalPos.x - targetGlobalBounds.left, targetGlobalPos.y - targetGlobalBounds.top);

    // Move transform matrix so that top left of target will be at (0, 0).
    targetTransform.tx = targetOriginOffset.x;
    targetTransform.ty = targetOriginOffset.y;

    var cloneData:BitmapData = new BitmapData(targetGlobalBounds.width, targetGlobalBounds.height, true, 0x00000000);
    cloneData.draw(target, targetTransform);
    var clone:Bitmap = new Bitmap(cloneData);

    // Move clone to target's global position, minus the origin offset.
    clone.x = targetGlobalPos.x - targetOriginOffset.x;
    clone.y = targetGlobalPos.y - targetOriginOffset.y;

    return clone;
} 
```

~~不幸的是，如果 DisplayObjects 上有任何过滤器，pixelBounds 似乎返回 (0, 0) 的原点，这显然会破坏事情。~~

*编辑：*替换`target.transform.pixelBounds`为`target.getBounds(target.stage)`略有改进。如果有过滤器，这可以保持位置正确，但**仍不会包含父 DisplayObjects**上的过滤器，并且**目标上的过滤器可以与 Bitmap 的边缘重叠**。我不确定是否有一种简单的方法可以解决这个问题。

*更新：* Jimmi Heiserman 发现如果 swf 被缩放，这个函数就会被破坏。没有`stage.scaleMode = StageScaleMode.NO_SCALE;`，`stageWidth`and`stageHeight`参数似乎保持不变，所以我发现的唯一（相当hacky）解决方法是添加一个“未缩放”测试Sprite并使用*它* `concatenatedMatrix`来调整克隆的位置和比例：

```
function createScaledBitmapClone(target:DisplayObject):Bitmap {
    var targetTransform:Matrix = target.transform.concatenatedMatrix;
    var targetGlobalBounds:Rectangle = target.getBounds(target.stage);
    var targetGlobalPos:Point = target.localToGlobal(new Point());

    // Calculate difference between target origin and top left.
    var targetOriginOffset:Point = new Point(targetGlobalPos.x - targetGlobalBounds.left, targetGlobalPos.y - targetGlobalBounds.top);

    // Create a test Sprite to check if the stage is scaled.
    var testSprite:Sprite = new Sprite();
    target.stage.addChild(testSprite);
    var testMatrix:Matrix = testSprite.transform.concatenatedMatrix;
    target.stage.removeChild(testSprite);

    // Move transform matrix so that top left of target will be at (0, 0).
    targetTransform.tx = targetOriginOffset.x * testMatrix.a;
    targetTransform.ty = targetOriginOffset.y * testMatrix.d;

    var cloneData:BitmapData = new BitmapData(targetGlobalBounds.width * testMatrix.a, targetGlobalBounds.height * testMatrix.d, true, 0x00000000);
    cloneData.draw(target, targetTransform);
    var clone:Bitmap = new Bitmap(cloneData);

    // Move clone to target's global position, minus the origin offset, and cancel out stage scaling.
    clone.x = targetGlobalPos.x - targetOriginOffset.x;
    clone.y = targetGlobalPos.y - targetOriginOffset.y;
    clone.scaleX = 1 / testMatrix.a;
    clone.scaleY = 1 / testMatrix.d;

    return clone;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T03:26:39.740

您是否尝试过将父母转换为画图？[draw](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#draw%28%29)将变换矩阵作为第二个参数。

如果你对父母有一个句柄，你可以使用这样的东西

```
bitmapData.draw(nestedSprite, parent.transform.matrix); 
```

# excel - 我可以评估字符串格式的 Excel VB 常量吗？

> ID：14491613
> 
> 赞同：3
> 
> 时间：2013-01-23T23:56:24.507
> 
> 标签：excel, constants, evaluate, vba

是否可以评估包含有效 Excel VB 常量名称的字符串以返回该常量的值？

例如

```
 Dim ConstantName as String
    Dim ConstantValue as Long

    ConstantName="xlValues"

    ConstantValue= UnknownFunction(ConstantName)

    'would set ConstantValue=-4163 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:05:01.567

乐趣！

```
Option Explicit

Function getConstantValue(constStr As String) As Variant

    Dim oMod As VBIDE.CodeModule
    Dim i As Long, _
        num As Long

    Set oMod = ThisWorkbook.VBProject.VBComponents("Module1").CodeModule

    For i = 1 To oMod.CountOfLines
        If oMod.Lines(i, 1) = "Function tempGetConstValue() As Variant" Then
            num = i + 1
            Exit For
        End If
    Next i

    oMod.InsertLines num, "tempGetConstValue = " & constStr

    getConstantValue = Application.Run("tempGetConstValue")

    oMod.DeleteLines num

End Function

Function tempGetConstValue() As Variant
End Function 
```

所有代码都必须在一个名为 Module1 的模块中。这可以通过更改例程中的文本“Module1”来轻松更改。

您需要添加对`Microsoft Visual Basic for Applications Extensibility x.x`

有多种方法可能会失败。如果您有任何问题，请告诉我:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T18:18:19.433

您可以使用字典而不是使用常量

```
Dim dict As Object

Sub InitialiseDict()
    Set dict = CreateObject(Scripting.Dictionary)
    dict("xlValues") = -4163
    dict("const1") = value1
    ... 
    dict("constN") = valueN
End Sub

ConstValue = dict("xlValues") 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-24T17:41:38.827

是否需要使用字符串值？

```
Dim anyConstant as Long
anyConstant = xlValues

msgbox anyConstant 
```

将 anyConstant 设置为您喜欢的任何 xl 常量，它们都是枚举的 Long 值。

然而，提供的第一个解决方案确实更有趣。

# php - PHP：合并两个数组，第一个键不同，第二个键相加

> ID：14491616
> 
> 赞同：3
> 
> 时间：2013-01-23T23:56:33.840
> 
> 标签：php, arrays, merge, sum

我有两个数组：

```
$array1 = array (a => '501', b => '1');
$array2 = array (a => '501', b => '2'); 
```

合并后的数组应如下所示：

```
$merged_array = array (a => '501', b => '3'); 
```

我尝试了很多建议，其中之一是：

```
 $sums = array();
  foreach (array_keys($array1 + $array2) as $key) {
    $sums[$key] = (isset($array[$key]) ? $array[$key] : 0) + (isset($array2[$key]) ? $array2[$key] : 0);
  } 
```

但这会导致：

```
$merged_array = array (a => '1002', b => '3'); 
```

我该怎么做？非常感谢任何建议

**编辑：在阅读了一些评论后，我意识到我应该更清楚。见下文**

4个数组，注意'a'中的重复项：

```
 $array1 = array (a => '501', b => '1');
  $array2 = array (a => '501', b => '2');
  $array3 = array (a => '505', b => '1');
  $array4 = array (a => '509', b => '1'); 
```

4个合并数组和序列化应该变成*类似*

```
a:2:{s:1:"a";i:501;s:1:"b";i:3; s:1:"a";i:505;s:1:"b";i:1; s:1:"a";i:509;s:1:"b";i:1;} 
```

所以：2x a => '501' 变成 1x a => '501' 并且它的 'b' 键变成 '3' （求和）

和： 1x a=> '505' 和 b => '1'

和： 1x a=> '509' 和 b => '1'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:07:08.523

```
$array1 = array (a => '501', b => '1');
$array2 = array (a => '501', b => '2');

function super_merge($a1, $a2)
{
  $a = array();
  $k_ar = array_keys($a1 + $a2);

  foreach ($k_ar as $k)
  {
    if (isset($a1[$k]) && isset($a2[$k]) && $a1[$k] == $a2[$k])
      $a[$k] = $a1[$k];
    else
      $a[$k] = (isset($a1[$k]) ? $a1[$k] : 0) + (isset($a2[$k]) ? $a2[$k] : 0);
  }

  return $a;
}

var_dump(super_merge($array1, $array2)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T09:47:10.020

您可以构建一个以“a”值作为键、“b”值作为值的数组

```
function map_a_to_b($array) {
    return array($array['a'] => $array['b'];
} 
```

适用`map_a_to_b`于所有输入数组。然后你可以递归地合并数组：

```
$merged = array_merge_recursive($array1, $array2, $array3, $array4); 
```

结果将是（对于您的示例）：

```
 array ('501' => array('1', '2'),
         '505' => '1',
         '509' => '1') 
```

现在像这样对内部数组求和：

```
$summed = array_map(function($item) { return array_sum((array) $item); }, $merged); 
```

并将键值数组转换回您的 a/b 结构。我不知道它应该是什么样子，因为我不能流利地读取序列化数组。因此，如果您需要帮助，请将所需的输出显示为未序列化的数组。

# python-3.x - 为什么 ipython3 和 ipython3 笔记本之间的 map() 存在差异？

> ID：14491617
> 
> 赞同：0
> 
> 时间：2013-01-23T23:56:46.420
> 
> 标签：python-3.x, ipython, ipython-notebook

这是我在 shell 中运行 ipython3 (Python3.2.3) 时预期的结果：

```
In [1]: sum(map(int, str(79)))
Out[1]: 16 
```

现在这是 ipython3 笔记本中的相同代码：

```
In [5]: sum(map(int, str(79)))
Out[5]: <builtins.map at 0x5c26950> 
```

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:59:00.157

如果您想使用带有`--pylab`选项的 ipython3 笔记本，但仍然具有所有内置功能，您可以简单地执行以下操作：

```
 In [1]: from builtins import * 
```

感谢@minrk 和@DSM 让我在这里走上正轨！

# html - HTML/CSS - 在块元素中垂直居中 ul

> ID：14491619
> 
> 赞同：0
> 
> 时间：2013-01-23T23:57:05.880
> 
> 标签：html, css, vertical-alignment

**的HTML**

```
<nav class="cf">
  <div class="logo">
    <a href="#">Logo</a>
  </div>
  <ul>
    <li><a href="#">Link 1</a></li>
    <li><a href="#">Link 2</a></li>
    <li><a href="#">Link 3</a></li>
  </ul>
</nav> 
```

**CSS**

```
.cf:before, .cf:after { content: " "; display: table; }
.cf:after { clear: both; }

ul {
  margin: 0;
  padding: 0;
  list-style: none;
  background: red;
}

nav {
  background: grey;
  text-align: center;
}

nav ul {
  font-size: 0px;
  text-align: right;
}

nav li {
  font-size: 14px;
  display: inline;
}

nav li a {
  display: inline-block;
  width: auto;
  background: green;
}

.logo {
  font-size: 33px;
  background: orange;
  float: left;
} 
```

**小提琴**
[http://jsfiddle.net/M9Sdd/](http://jsfiddle.net/M9Sdd/)

**问题**
如何`ul`在（灰色背景）内垂直居中（红色背景`nav`）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:23:41.603

您也可以在不添加其他元素的情况下使用它：

```
nav {
    display: table;
    width: 100%;
}

ul {
    display: table-cell;
    vertical-align: middle;
    height: 100%;
    width: 100%;
} 
```

*注意：我只能在 Chrome 中测试代码。

[http://jsfiddle.net/RfF7t/](http://jsfiddle.net/RfF7t/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:08:03.763

在 ul 周围添加一个包装器，使其成为表格单元格并垂直居中对齐。

[http://jsbin.com/otucom/4/edit](http://jsbin.com/otucom/4/edit)

# haskell - 使用 RankNTypes 编码 ExistentialQuantification

> ID：14491620
> 
> 赞同：4
> 
> 时间：2013-01-23T23:57:13.613
> 
> 标签：haskell, existential-type, higher-rank-types

我在一些地方读到过声称`ExistentialQuantification`可以使用`RankNTypes`. 有人可以举例说明为什么这是或不可能的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-24T00:29:18.303

通常，Haskell 中的所有类型变量都在类型的最外层范围内隐式地普遍量化。 `RankNTypes`允许通用量词`forall`出现嵌套，例如类型与 .`forall a b. (a -> a) -> b -> b`非常不同 `forall b. (forall a. a -> a) -> b -> b`。

从某种意义上说，函数箭头左侧的类型在逻辑上是“否定的”，与`(->)`逻辑含义大致相同。从逻辑上讲，全称量词和存在量词通过 De Morgan 对偶关系：(∃x.P(x)) 等价于 ¬(∀x.¬P(x))，或者换句话说“存在一个 x 使得P(x)”对应于“并非对于所有 x，P(x) 都是假的”。

因此，函数箭头左侧的 forall 被“否定”并且表现得像存在主义。如果你把整个东西放在另一个函数箭头的左边，它是双重否定的，并且再次表现为一个全称量词，对一些繁琐的细节取模。

否定的相同想法也适用于值，因此要编码`exists x. x`我们想要的类型：

1.  `forall x.`在逆变（否定）位置
2.  该类型的值`x`在*协变*（正）位置。

由于值必须在量词的范围内，我们唯一的选择是双重否定——基本上是 CPS 变换。为了避免以其他方式限制事物，我们将在函数箭头右侧的类型上进行普遍量化。所以`exists x. x`翻译为`forall r. (forall x. x -> r) -> r`. 将此处的类型和量词的放置与上述要求进行比较，以验证其是否满足要求。

用更可操作的术语来说，这只是意味着给定一个具有上述类型的函数，因为我们给它一个具有全称量化参数类型的函数，它可以将该函数应用于`x`它喜欢的任何类型，并且因为它没有其他方法可以获得类型的值，`r`我们知道它将将该函数应用于*某事*。So `x`will 指代*某种*类型，但我们不知道是什么——这基本上是存在量化的本质。

在更实际的日常术语中，如果您从函数类型的“另一面”来看，任何普遍量化的类型变量都可以被视为存在。因为作为类型推断的一部分执行的统一超越了量词范围，所以有时您可能会遇到这样一种情况，即 GHC 必须将外部范围中的类型变量与嵌套范围中的量化类型统一起来，这就是您获得编译器错误的方式关于转义类型和 skolem 等等，后者（我假设）与[Skolem 范式](http://en.wikipedia.org/wiki/Skolem_normal_form)有关。

这与使用存在的数据类型相关的方式是，虽然您可以声明这样的类型：

```
data Exists = forall a. Exists a 
```

这代表一个存在类型，要获得“存在类型”，您需要通过模式匹配来解开它：

```
unexist :: Exists -> r
unexist (Exists x) = foo x 
```

但是，如果您考虑`foo`此定义中的类型必须是什么，您最终会得到类似 的`forall a. a -> r`内容，这相当于上面的 CPS 样式编码。CPS 转换和数据类型的 Church 编码之间有着密切的关系，因此 CPS 形式也可以看作是模式匹配的具体化版本。

最后，将事物与逻辑联系起来——因为这就是“存在量词”一词的来源——请注意，如果你认为被箭头留下是否定的，并且有点斜视以忽略`forall r. ...`CPS，这些存在类型的编码与作为起点的德摩根二元形式 ¬(∀x. ¬P(x)) 完全相同。所以这些实际上都是看待同一个概念的不同方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-24T02:31:33.607

# java - http 帖子：NullPointerException

> ID：14491623
> 
> 赞同：-4
> 
> 时间：2013-01-23T23:57:35.337
> 
> 标签：java, http, http-post, httpurlconnection

我是 Java 新手，应该将 XML 文件发送到 HTTP 服务器。应首先将 XML 文件转换为字符串：

我从服务器收到错误：

```
[stdout] (http--127.0.0.1-8080-1) failed in postjava.lang.NullPointerException

[stdout] (http--127.0.0.1-8080-1) received post request : 
```

似乎我没有向服务器发送任何内容。

**这是代码**

```
import java.io.*;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLEncoder;
import java.util.Scanner;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.transform.*;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;
import javax.xml.transform.stream.StreamSource;

import org.w3c.dom.Document;

public class try_post {

    public static void main(String[] args) {

        try{
            BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));

            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
            DocumentBuilder builder = factory.newDocumentBuilder();

            Document doc = builder.parse("D:\\n.xml");
            StringWriter stringWriter = new StringWriter(); 

            Transformer transformer =TransformerFactory.newInstance().newTransformer(); 

            transformer.transform(new DOMSource(doc), new StreamResult(stringWriter)); 
            String strFileContent = stringWriter.toString();  
            System.out.println(strFileContent);
            System.out.println( strFileContent.getClass().getName());
            System.out.println("xml file converted to string"); 

            String param="param1=" + URLEncoder.encode(strFileContent ,"UTF-8");

            URL url = new URL("http://localhost:8080/");
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();

            connection.setDoOutput(true);
            //      connection.setInstanceFollowRedirects(false);
            connection.setRequestMethod("POST");

            connection.setFixedLengthStreamingMode(param.getBytes().length);
            connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

            OutputStreamWriter writer = new OutputStreamWriter(connection.getOutputStream());

            writer.write(param);
            writer.flush();

            String line;
            BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));

            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            writer.close();
            reader.close();

            String response= "";

            StreamSource source = new StreamSource(fileReader);
            StreamResult result = new StreamResult(os);
            transformer.transform(source, result);*/

            DataOutputStream fos = new DataOutputStream(connection.getOutputStream ());

            System.out.println("Response code: " + connection.getResponseCode());
            connection.disconnect();}
        catch (MalformedURLException ex) {
            System.out.print("MalformedURLException");

        } catch (Exception ex) {
            System.out.print(" Exception: "+ex.getMessage());

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:02:16.837

没有人可以根据您发布的内容提供帮助。堆栈跟踪必须有更多。

您的代码有很多问题：

1.  打印堆栈跟踪，而不仅仅是消息。它会有更多的信息。
2.  您使用连接对象而不首先检查它是否为空。可能就是这样。
3.  与该 Document 对象相同。您如何知道 XML 已被读取？

看起来您正在尝试从文件中读取 XML 并将其发布到在您的本地主机上侦听的 servlet。您只需检查响应代码。我错过了什么？

你的防御力还不够我的口味。难怪你有问题。

打印堆栈跟踪，如下所示：

```
 catch (MalformedURLException ex) {
        ex.printStackTrace();
    } catch (Exception ex) {
        ex.printStackTrace();
    } 
```

另一个明智的尝试是在 IntelliJ 之类的 IDE 中运行，并使用调试器单步执行您的代码。你会明白为什么你得到 NPE 的时间比你在这里等待答案的时间短。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T00:28:19.410

我懂了。只需使用 Ruby。

```
require "net/http"; require "uri"
params = { param1: File.read("D:\\n.xml") }
uri = URI.parse("http://localhost:8080/")
resp = Net::HTTP.post_form(uri, params)
puts "Response code: #{resp.code}" 
```

对不起，我不得不这样做。*反对投票的大括号*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T00:48:42.197

异常发生在服务器端，而不是在您的代码中。异常堆栈跟踪是否记录在服务器上？您可能需要查看服务器端代码来调试它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T00:08:19.807

据我所知，你做事很艰难。尝试使用 HTTPClient 库。这应该会大大简化您的代码。

对于 maven 依赖项，请参见： [http ://search.maven.org/#artifactdetails%7Ccommons-httpclient%7Ccommons-httpclient%7C3.1%7Cjar](http://search.maven.org/#artifactdetails%7Ccommons-httpclient%7Ccommons-httpclient%7C3.1%7Cjar)

有关工作代码示例，请参阅：请参阅：[http ://www.kodejava.org/browse/47.html](http://www.kodejava.org/browse/47.html)

# dynamics-ax-2009 - 是否可以在 Dynamics AX 中捕获“对象未初始化”异常？

> ID：14491624
> 
> 赞同：1
> 
> 时间：2013-01-23T23:57:59.430
> 
> 标签：dynamics-ax-2009, x++, axapta

**问题：**

我有一些代码失败，因为对象尚未初始化。检测到此错误的解决方案很容易修复。然而，令我惊讶的是，我精心处理的异常处理并没有捕捉到这个异常。这意味着没有记录或处理异常，并且 try catch 块之后的代码从未执行过。try...catch 块在事务之外，所以那里没有问题。

在这种特殊情况下，异常发生在批处理 (RunBaseBatch) 作业中。该作业处理了几个不相关的处理任务。一旦满足异常条件，作业就会终止，因此其他不相关的处理任务永远不会被调用。

有谁知道是否可以在 Dynamics AX 2009 中捕获“对象未初始化”异常？我读过一篇文章说可能无法在 AX 中捕获某些异常，但是，我希望情况并非如此（参考：[https ://community.dynamics.com/product/ax/f/33/p/ 16352/23700.aspx#23700](https://community.dynamics.com/product/ax/f/33/p/16352/23700.aspx#23700)）。

**代码示例：** 这是一些重现问题的简单代码：

```
server static void main(Args args)
{
    Array   arr;
    ;
    info ("debug: before try...catch");
    try
    {
//        ttsbegin;       // enable/disable to test with transactions
//        arr = new Array(Types::String);     // Enabling this line will prevent the exception
          arr.exists(3);
//        ttscommit;      // enable/disable to test with transactions
    }
    catch (Exception::Internal)  // This exception handler was the Magic Sauce!!
    {
        info ("debug: catch (Exception::Internal)");
    }
    catch (Exception::Error)
    {
        info ("debug: catch (Exception::Error)");
    }
    catch
    {
        info ("debug: catch");
    }
    info ("debug: after try...catch");
} 
```

**更新 2013-01-29** 我正在等待接受答案，直到更多地查看此问题。谢谢你到目前为止的答案。

我知道我给出的例子很简单。这种类型的错误在已知时很容易修复。防御性编程总是一个好主意。

然而，在现实世界中，出现错误的代码非常复杂。该错误发生在子类的重载方法的几个层次。它发生在特定场景中，当重载方法破坏了超类中成员变量的受保护值时。这就是代码中出现错误的地方，但是，直到超类再次尝试使用成员变量，它才显现出来。该错误在被检测到并被追踪时被立即修复。

防御性地，是的，您可以在每次使用它时检查每个受保护的成员变量，但这确实开始影响性能、代码可读性、实用性等，这就是语言提供异常处理的原因。

这里的问题是**如何捕获这些类型的错误以使代码更加健壮和防弹**？在大多数开发环境（例如 C、C++、C# 或 Java）中，顶级的 try...catch 可用于捕获、记录和清理**所有**意外异常。因此代码将能够继续处理其他不相关的任务。AX 在某种程度上仍在继续，因为当这个错误发生时，整个系统并没有停止。但是，由于 AX/X++ 中的缺陷，此作业中 catch 之后的代码没有执行。

我正在寻找一种创新的解决方案或解决方法（如果存在）来捕获“对象未初始化”异常（实际上是所有异常）并继续处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T20:19:12.767

你不能在传统意义上“抓住”它，但你可以避免它发生。在运行任何东西之前简单地测试对象是否存在：

```
if(object)
{
    // Exists; Execute statements with object here
}
else 
{
    // Doesn't exist
} 
```

这是有效的，因为如果对象未初始化，它将被转换为 null。（空 == 0）== 假

如果对象已初始化，它将具有除 null 之外的其他值。(!Null != 0) == 真

希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T13:58:26.463

详细说明一下，如您链接到的帖子中所述，您无法捕获 Object Not Initialized 错误。但是，您可以通过在尝试针对您无法控制的变量运行函数之前添加一个简单的检查来“修复”代码（例如，如果您请求 Array 类型作为函数的参数并且您希望函数从类外调用）。

```
 try
    {
          if (arr)
              arr.exists(3);
    } 
```

如果对象尚未实例化，if(arr) 语句足以跳过处理，有效地绕过错误。但是，这显然不会将错误进一步推向链条。如果你真的想要，你可以让它抛出一个可以被捕获的不同错误，但显然这不太理想。

在这种情况下，由于 RunBaseBatch 类可能不是您想要修改的东西，因此在调用问题方法之前确保正确定义导致问题的对象并在测试中发现这些错误可能会更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T11:01:03.230

You can, but you shouldn't. A behavior like this is almost certainly a bad design of your code, that will **inevitably** end in more problems in the future.

You need to make your code **defensive** to this case, making sure the object is instanciated before using it. Otherwise, you're using the `catch` code to an expected behavior, wich makes no sense.

**EDIT 2013/02/18**

In complex scenarios like what you're describing, it's usually very hard to get a solution fully controlled. In AX, `try..catch` statement is quite simplified and in a very large range of situations is not really needed (unlike Java, C#, ... where is always recommended).

This simplification is nice in almost all situations of AX development, as you don't need to waste time on exception handling. Just let them raise, and the InfoLog will handle them on a simple and reliable way.

The big problem comes where you **really** need this control... when there is not really a way of force it. I'm not sure if this is really an standard issue or it's espected by the product team to work that way, but this cases are always giving troubles in AX. When you need to catch some specific issue you have to be very creative and deffensive to prevent the exception as catching it will become even more creative...

Hope this helps :)

# javascript - 使用体素生成球体

> ID：14491627
> 
> 赞同：3
> 
> 时间：2013-01-23T23:58:28.103
> 
> 标签：javascript, 3d, voxels

我一直在玩[voxeljs](http://voxeljs.com/)，我是 3D 编程新手，它在[文档](https://github.com/maxogden/voxel-engine#api)中说这段代码生成了“球体世界”：

```
generate: function(x,y,z) {
   return x*x+y*y+z*z <= 20*20 ? 1 : 0 // sphere world
}, 
```

这实际上是如何生成一个球体的？从我的简单理解来看，我认为它基本上是“循环”通过 3D 世界中的每个“块”？任何进一步的解释或指向一个好的教程都会有很大的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T00:09:48.267

你的功能说：

> 如果体素`(x, y, z)`是球体的一部分，则返回`1`，否则`0`。

作者应用[球面方程](http://en.wikipedia.org/wiki/Sphere#Equations_in_R3)。您的球体由以下一组体素组成：

![在此处输入图像描述](../Images/62dd61ccdbebe5bb8a54bbe644c81561.png)

这基本上意味着体素是球体的一部分，如果到中心的距离`(0, 0, 0)`小于半径。距离是使用勾股定理计算的。通过平方半径（在您的情况下`20`），您可以将其与平方距离进行比较，而无需计算平方根。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-24T00:09:38.987

这是基于三维空间中的距离公式，因为您可以将球体定义为距中心点一定距离内的每个点。

任意两个物体之间的距离等于 (x1-x2)^2 + (y1-y2)^2 + (z1-z2)^2 的平方根。

如果每个体素在原点的 20 个单位内，则上述函数会对其进行标记。由于原点是 (0, 0, 0)，距离函数简化为 x1^2 + y1^2 + z1^2 的平方根。通过去掉平方根并将结果与​​ 20^2 进行比较，这也引发了另一种优化。

# javascript - 在 JSF 中提交表单后，MaskInput 不起作用

> ID：14491628
> 
> 赞同：3
> 
> 时间：2013-01-23T23:58:43.727
> 
> 标签：javascript, validation, jsf, jsf-2, maskedinput

我有这个 maskinput 定义：

```
<ui:define name="additional-javascript">
    <h:outputScript name="jquery.maskedinput-1.3.min.js" library="javascript" />
    <script>
            jQuery(function($){
            $("[id='register_form:cnpj']").mask("99.999.999/9999-99");
        });
    </script> 
</ui:define> 
```

以这种形式：

```
<h:form id="register_form">
    <div class="four columns alpha">
        CNPJ : <h:message id="m_cnpj" for="cnpj" styleClass="red" />
        <h:inputText id="cnpj" value="#{clientec.cb.cliente.cnpj}" styleClass="cnpj">
            <f:ajax event="blur" render="m_cnpj" />
        </h:inputText>
    </div>
   <div class="twelve columns alpha"></div>
   //.. other input fields
</h:form> 
```

效果很好，但是如果用户在表单中填写错误并提交，则此输入字段中的掩码将不再起作用。

这是为什么 ？任何人都知道为什么？这对我来说似乎有点奇怪，因为 HTML 在提交表单后不会改变任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T02:35:56.567

如果输入组件本身在表单提交时重新渲染，就会发生这种情况。重新渲染将导致 HTML DOM 中的原始 HTML 元素被来自 ajax 响应的新 HTML 元素替换。尽管它们可能表示完全相同，但新的 HTML 元素不再附加 jQuery 掩码。基本上，您需要在其上重新执行 jQuery 掩码。但是，您在那里声明的 jQuery 函数仅在 DOM 就绪时运行（在页面加载时）。它不会在后续的 ajax 请求中重新执行。

你基本上有2个选择：

1.  不要在表单提交的重新渲染中包含输入组件。例如，让表单提交仅重新呈现消息组件而不是`@form`。

    ```
    <h:form>
        <h:inputText id="input1" ... />
        <h:message id="m_input1" ... />
        <h:inputText id="input2" ... />
        <h:message id="m_input2" ... />
        <h:inputText id="input3" ... />
        <h:message id="m_input3" ... />
        <h:commandButton ...>
            <f:ajax ... render="m_input1 m_input2 m_input3" />
        </h:commandButton>
    </h:form> 
    ```

2.  在表单提交完成后重新运行 jQuery 函数。有几种方法可以实现这一点。基本上，要么将`<script>`to 移到内部`<h:form>`（假设您`@form`在重新渲染中使用）

    ```
    <h:form>
        <h:inputText id="input1" ... />
        <h:message id="m_input1" ... />
        <h:inputText id="input2" ... />
        <h:message id="m_input2" ... />
        <h:inputText id="input3" ... />
        <h:message id="m_input3" ... />
        <h:commandButton ...>
            <f:ajax ... render="@form" />
        </h:commandButton>
        <script>$("[id='register_form:cnpj']").mask("99.999.999/9999-99");</script>
    </h:form> 
    ```

    或定义一个在完成时运行的 JSF ajax 事件处理程序并将其挂钩到`<f:ajax onevent>`. 例如

    ```
    <f:ajax ... render="@form" onevent="function(data) { if (data.status == 'success') applyMask() }" /> 
    ```

# jsp - 如何在 CQ5.5 中禁用 .export.zip 选择器/扩展？

> ID：14491630
> 
> 赞同：0
> 
> 时间：2013-01-23T23:58:55.637
> 
> 标签：jsp, content-management-system, osgi, aem, day-cq

我试图确保 CQ5 中的所有默认处理程序都是已知的，并且在不需要时被禁用/覆盖。一个难倒我：*.export.zip

我可以使用调度程序或 servlet 过滤器阻止它，但我假设有一种方法可以禁用它（可能是我缺少的 OSGi 配置）或覆盖它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:22:14.697

如果您禁用以下捆绑包：

*   Day Communique 5 内容同步 (com.day.cq.cq-content-sync)
*   Day Communique 5 内容同步扩展 (com.day.cq.wcm.cq-wcm-content-sync)

它将删除 .export.zip 扩展的处理程序

扩展包应该可以解决问题，但也可以禁用主要内容同步包。

您可以在此处找到这些（在您的本地服务器上）：

```
http://localhost:4502/system/console/bundles/com.day.cq.cq-content-sync
http://localhost:4502/system/console/bundles/com.day.cq.wcm.cq-wcm-content-sync 
```

# excel - 在excel中使用if语句计算单元格范围最小值的函数

> ID：14491631
> 
> 赞同：3
> 
> 时间：2013-01-23T23:58:56.597
> 
> 标签：excel, function, excel-formula, cells

我正在尝试计算一系列单元格的最小值。

单元格 D3:D153 包含干的或湿的，单元格 C3:C153 包含从 0 到 10 的数字。

我想计算干燥且 <=5 的细胞的最小值

```
=MIN(IF(AND(D3:D153="Dry", C3:C153<=5)), C3:C153) 
```

我认为上述方法可行，但最终出现功能错误。

我还有其他列，例如 G3:G153 包含干或湿的列，F3:F153 包含从 0 到 10 的数字。如果我想将其包含在原始函数中，我将如何组合它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:28:28.410

尝试这个：

```
{=MIN(IF((D3:D153="Dry")*(C3:C153<=5),C3:C153,11))} 
```

输入时，使用 Ctrl+Shift+Enter 获取大括号（并使其成为数组公式）。

**编辑，你问题的第二部分：**

```
{=MIN(IF((D3:D153="dry")*(C3:C153<=5),C3:C153,11),IF((G3:G153="dry")*(F3:F153<=5),F3:F153,11))} 
```

好吧！

# php - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '(...) 附近使用正确的语法

> ID：14491633
> 
> 赞同：-3
> 
> 时间：2013-01-23T23:59:19.233
> 
> 标签：php, mysql, sql, syntax-error

我已经查看了许多其他关于同一问题的帖子，但我似乎仍然无法找出我的代码有什么问题。请注意，我这周开始学习 PHP 和 SQL，所以如果我犯了一个愚蠢的错误，请原谅。另外，我确信值得注意的是，在标题中发布的错误消息出现之前，还有另一个错误（在我的代码中定义）。那个错误是：

> “ 已经存在。”

这告诉我该`$_POST["file"]["name"]`变量未出于任何原因设置。任何帮助表示赞赏。但是，如果您要告诉我我的代码易受 SQL 注入攻击，我知道。上传脚本只能通过我的（安全）登录脚本访问。再次，欢迎所有帮助！

```
<?php
  /* Process uploaded file */

if ($_FILES["file"]["size"] < 2097152)
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Error: " . $_FILES["file"]["error"] . "<br>";
    }
  else
    {
      if (file_exists($_POST["class"] . "/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists.";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
        $_POST["class"] . "/" . $_FILES["file"]["name"]);
        $newpath = mysql_real_escape_string("uploads/" . $_POST['class'] . "/" . $_FILES['file']['name']);
        $filename = mysql_real_escape_string($_FILES['file']['name']);
        $description = mysql_real_escape_string($_POST["description"]);
        echo "Stored in: " . $newpath;
      }
    }
  }
else
  {
  echo "File must be less than two megabytes.";
  }

  /* Create and store information in MySQL Database */

  $con = mysql_connect("localhost","user","password");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }
mysql_select_db("1169030_dsp", $con);

$sql="INSERT INTO $_POST[class] (Description, Filename, File)
VALUES
  ('$description','$filename','$newpath')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "Your file was successfully uploaded.";

mysql_close($con);
?> 
```

* * *

这是我的输入表单 HTML：

```
 <center>
    <form action="uploadfile.php" method="post" style="background-color:#009933;color:#FFFFFF;width:320px;text-align:left;">
  Description: <input type="text" name="description"><br>
  File:        <input type="file" name="file"><br>
      Class:<br>
  <Select name="Class">
    <option value="period1">APES : period1</option>
    <option value="period2">Chemistry I : period2</option>
    <option value="period3">Lab Assist/Sci : period 3</option>
    <option value="period4">Lab Assist/Sci : period 4</option>
    <option value="period4">APES : period 4</option>
    <option value="period5">APES : period 5</option>
    <option value="period6">Lab Assist/Sci : period 6</option>
    <option value="period7">Chemistry I : period 7</option>
  </Select><br>
      <input type="submit" name="Upload">
</form>
  <center> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:19:14.300

您的问题是您的表单没有设置 enctype 属性。它应该是：

```
<form action="uploadfile.php" method="post" enctype="multipart/form-data" style="background-color:#009933;color:#FFFFFF;width:320px;text-align:left;"> 
```

`enctype="multipart/form-data"`需要`$_FILES`填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:15:35.490

你的变量`$_POST[class]`是错误的，应该是`$_POST['class']`

尝试这个

```
$sql="INSERT INTO $_POST['class'] (Description, Filename, File)
       VALUES
      ('".$description."','".$filename."','".$newpath."')"; 
```

# python - 文件到字典

> ID：14491640
> 
> 赞同：-1
> 
> 时间：2013-01-24T00:00:24.037
> 
> 标签：python, dictionary

> **可能重复：**
> [Python - 文件到字典？](https://stackoverflow.com/questions/4803999/python-file-to-dictionary)

我一直在看这个网站，绞尽脑汁，但我就是找不到答案。我有一个与数字匹配的单词文件，用“*”分隔。现在我必须找到一种方法将此文件转换为 python 中的字典并从另一个文本中查找单词并从字典文件中分配值。

我知道如何导入纯文本文件，只是不知道如何让它“像字典一样”有人有什么想法吗？

感谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:07:14.200

假设您的文件是每行一个，例如

```
chicken*5
dog*3
... 
```

你可以做

```
with open("path/to/file") as f:
    data = [line.split("*") for line in f]
data = dict((word, int(cnt)) for (word, cnt) in data) 
```

# python - Pygame、distutils 和字体

> ID：14491642
> 
> 赞同：0
> 
> 时间：2013-01-24T00:00:36.823
> 
> 标签：python, pygame, distutils

我想在我的应用程序中使用字体文件（pygame 需要字体文件的确切路径）并且我还想使用 distutils 打包这个应用程序。包必须独立于平台工作。如何编辑 setup.py 文件来实现这一点？我使用 Ubuntu。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:35:44.990

所以，如果我理解你的话；您想使用字体，但避免使用 Sysfont 对吗？

在这种情况下，我要做的是下载字体并将其写入我的程序：

```
fontSize = 15
workdir = os.getcwd()
path_to_font = os.path.join(workdir, 'your-font.ttf')
myFont = pygame.font.Font(path_to_font, fontSize) 
```

然而，这意味着您下载的字体在您的工作目录中

你可以在这里阅读更多关于它的信息：http: [//www.pygame.org/docs/ref/font.html#pygame.font.Font](http://www.pygame.org/docs/ref/font.html#pygame.font.Font)

# javascript - 粘性导航问题

> ID：14491644
> 
> 赞同：0
> 
> 时间：2013-01-24T00:00:41.503
> 
> 标签：javascript, jquery, html

[我在我的网站](http://thecharlesnyc.com/dev/dgi/ExpressionEngine/index.php#.UQBzwkrjmFd)上创建粘性导航时遇到问题。
我注意到，当向下滚动站点时，导航的活动状态的转换略微关闭。例如，当您滚动到网站的“名册”部分时，导航菜单会突出显示“关于”，直到您稍微向下滚动。

我认为这与我的固定标题有关...？我正在使用[锚滚动插件](http://www.webmuse.co.uk/blog/jquery-plugin-to-animate-scrolling-to-anchor/)。但是，我为粘性导航应用了一些 Jquery。

```
 $(window).scroll(function () {
         if ($(window).scrollTop()>$("#contact").offset().top){  $("ul.nav-bar > li").removeClass("active")  $("#nav_5").parent().addClass("active") } else  if ($(window).scrollTop()>$("#client").offset().top){ $("ul.nav-bar > li").removeClass("active") $("#nav_4").parent().addClass("active") } else if ($(window).scrollTop()>$("#roster").offset().top){ $("ul.nav-bar > li").removeClass("active") $("#nav_3").parent().addClass("active") } else if ($(window).scrollTop()>$("#about").offset().top){ $("ul.nav-bar > li").removeClass("active") $("#nav_2").parent().addClass("active") } else if ($(window).scrollTop()>$("#home").offset().top ){ $("ul.nav-bar > li").removeClass("active") $("#nav_1").parent().addClass("active") } }); 
```

为了解决这个问题，我需要将什么应用于我的 js 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:09:43.073

似乎您还必须考虑 #headerContainer 的高度。

```
$(window).scroll(function() {
    if ($(window).scrollTop() > ($("#contact").offset().top - $("#headerContainer").height())) {
        $("ul.nav-bar > li").removeClass("active")
        $("#nav_5").parent().addClass("active")
    } else if ($(window).scrollTop() > ($("#client").offset().top - $("#headerContainer").height())) {
        $("ul.nav-bar > li").removeClass("active")
        $("#nav_4").parent().addClass("active")
    } else if ($(window).scrollTop() > ($("#roster").offset().top - $("#headerContainer").height())) {
        $("ul.nav-bar > li").removeClass("active")
        $("#nav_3").parent().addClass("active")
    } else if ($(window).scrollTop() > ($("#about").offset().top - $("#headerContainer").height())) {
        $("ul.nav-bar > li").removeClass("active")
        $("#nav_2").parent().addClass("active")
    } else if ($(window).scrollTop() > ($("#home").offset().top - $("#headerContainer").height())) {
        $("ul.nav-bar > li").removeClass("active")
        $("#nav_1").parent().addClass("active")
    }
}); 
```

# ios - iOS - 隐藏在项目目录中的 xib 文件

> ID：14491645
> 
> 赞同：0
> 
> 时间：2013-01-24T00:00:46.343
> 
> 标签：ios, xcode, xib, finder

不知何故，我有一个隐藏的 .xib 文件。当我在 Xcode 中右键单击并选择“在 finder 中显示”时，它只会将我带到顶层项目文件夹。如果我在 Alfred 中搜索该文件，它会在 en.lproj 目录内的主项目文件夹中找到它。

我需要将此 .xib 文件复制并粘贴到另一个项目中。

1.  这个 .xib 文件怎么可能放在这里而不是放在我可以访问它的常规文件系统目录中？

2.  如何在 Finder 中访问它？就像我说的我需要复制文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:48:53.007

`<lang-code>.lproj`如果您告诉 Xcode 这是本地化文件，则该文件将被放入文件夹中。当尝试从资源文件夹访问这样一个本地化文件时，资源加载代码将查看当前系统语言是什么，并首先尝试在该`.lproj`文件夹中找到该语言的文件。如果存在这样的文件夹并且找到该文件，它将打开它。如果没有，它将`.lproj`在默认语言的文件夹中搜索文件。如果存在这样的文件夹并且找到该文件，它将打开它。如果没有，它将直接在资源文件夹中搜索文件。如果在那里找到此文件，它将打开它。否则，打开文件将失败。

如果您无法`en.lproj`通过双击在 Finder 中打开该文件夹，则似乎某些应用程序已将该扩展注册`.lproj`为您系统上的捆绑包。Bundles 只是文件夹，但 Finder 不会这样对待它们。双击一个捆绑包将使用为此捆绑包注册的任何应用程序打开它。在我的系统上，这些文件夹不是捆绑包，因此 Xcode 默认情况下不会将它们打包（必须是您安装的其他应用程序）。尽管 Finder 对包进行了特殊处理，但它们毕竟仍然是普通文件夹。您可以通过在 Finder 中右键单击它并从上下文菜单中选择来查看**捆绑包。**`Show Package Content`这适用于所有已注册的捆绑包。

# c++ - 标准输入的 C++ IO 优化和字符串处理

> ID：14491648
> 
> 赞同：0
> 
> 时间：2013-01-24T00:01:27.483
> 
> 标签：c++, performance, methods, io

我正在为使用 C++ 的“标准标准输入程序”的比赛编写程序。输入的第一行表示从那时起预计有多少行 (x) 作为输入。这些输入行可以是字符串、整数或两者的某种组合，并且每一行正好包含两个由空格分隔的元素。目前，我以类似于以下的方式一次接收每一行（在请求下一行之前处理信息）：

```
 string initial;
  getline (cin,initial);
  istringstream stringStream (initial);
  vector<string> parsedString;
  vector<int> data;
  char splitToken = ' ';
  while ( !stringStream.eof() )
  {
    string subString;
    getline( stringStream, subString, splitToken);
    parsedString.push_back( subString );
  }

  for (int i = 0; i <parsedString.size(); i++)
  {
    string temp = parsedString[i];
    int intTemp = atoi(temp.c_str());
    data.push_back(intTemp);
  }
  unsigned int n = data[0];
  unsigned int m = data[1]; 
```

在这种特定情况下，我知道传入的数据将是两个整数，但情况并非总是如此。我想知道是否有某种方法可以使我的代码更快，或者通过改变我的方法（也许在知道有多少输入行之后立即获取所有输入行）或者通过使用更好的内置 C++ 函数来拆分传入的行空间到组成它们的两个元素。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:10:59.927

通常，在 C++ 中读取输入的习惯用法更接近于以下方面：

```
std::ios_base::sync_with_stdio(false); //tell iostreams to be fast
int number_of_lines;
std::cin >> number_of_lines;
if (!std::cin) *ERROR*;

for( ; number_of_lines>0; --number_of_lines) {
    unsigned n, m;
    std::cin >> n >> m;
    if (!std::cin) *ERROR*;
    //process n and m here
} 
```

您说“这些输入行可以是字符串、整数或两者的某种组合”，但您如何知道哪些是哪些？上面的代码假设一切都是一个数字，因为如果你不知道类型，输入是没有用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:25:02.903

好的，如果您想谈论其他方法，这里是另一种方法：几乎所有使用字符串繁重的代码的大（性能）问题，即有**很多复制**操作......一种天真的方法（使用由初学者）是在从字符串或内存缓冲区中查找/解析/提取smth时制作大量临时字符串......

另一种方法（当源缓冲区的生命周期允许时）是从缓冲区中查找、解析或提取数据，而无需复制源字符串的任何特定部分。为此，可以使用`boost::range`库和`boost::iterator_range`类（与 boost string_algo 结合使用）。这样可以执行通常的查找/解析任务并避免复制部分字符串。

我的经验中的一个例子：前段时间（用于性能测试）我的同事写了 3 个版本的相同配置解析器（配置文件大约几兆字节）：

*   使用`std::string::find`
*   使用`boost::tokenizer`
*   和`boost::iterator_range`

结果令人惊讶：

*   使用 -O0 优化`std::string::find`获胜（基于解析器的大约 3 倍`boost::tokenizer`和大约 5 倍）`iterator_range`
*   但在 -O3 一切都变了：`boost::iterator_range`绝对是赢家！（大约 12 倍以上`std::string::find`！）

结果是相当可预测的：高度模板化的代码`boost::string_algo`和朋友也高度内联......

这就是为什么我个人喜欢用它`boost::iterator_range`来解析字符串......

* * *

所以我建议将所有内容（尽可能多地）读入一个`std::string`，`std::vector<char>`（更好的一个，因为它有内存连续性保证，所以你可以`read()`直接从流到容器中）或`std::deque<char>`，然后使用`boost::string_algo`和`boost::iterator_range`解析它试图避免任何（无用的）从源字符串复制到临时位置......也尝试使用`boost::lexical_cast`转换数字（或您自己的范围感知数字转换器）

还有一个建议：尽量避免内存（通常）分配——这确实是一个繁重的操作。`rserve()`当您知道您想要存储的数据的可能大小时，请使用容器成员。最后，尝试使用自定义（棘手的）分配器而不是（通常是愚蠢的）默认分配器。

**请注意**，在 C++11`std::string`中，内存连续性保证为`std::vector`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T00:11:46.177

在许多系统上（包括 Linux 上的 GCC），C++ I/O 流非常慢。如果速度是您最关心的问题，请使用`<stdio.h>`, eg `scanf()`and (even faster:) `getchar()`，并手动进行解析，如下面的状态机：

```
int c;
int state = 0;
while ((c = getchar()) >= 0) {
  switch (c) {
   case ' ': case '\t':
    ...;
    ... if (state == ...) { ...; state = ...; }
    break;
   case '\n':
    ...;
    break;
   default:
    ...;
  }
} 
```

尽可能少地复制数据。（比如问题`string temp = ...`中做了一个不必要的副本，可以通过引用来消除：`string &temp = ...`.）如果可能的话，用状态找出下一个字符的最终位置`c`，并把它放在那里，不要将来复制或移动它。

# javascript - jQuery 与 Ajax.Request 的等价物是什么，以及 onSuccess 和 onComplete？

> ID：14491649
> 
> 赞同：1
> 
> 时间：2013-01-24T00:01:34.653
> 
> 标签：javascript, jquery, prototypejs

这是我的代码：

```
this.ajax = new Ajax.Request(this.url, {
  method: 'get',
  parameters: { 'timestamp' : this.timestamp },
  onSuccess: function(transport) {
    // handle the server response
    var response = transport.responseText.evalJSON();
    this.comet.timestamp = response['timestamp'];
    this.comet.handleResponse(response);
    this.comet.noerror = true;
  },
  onComplete: function(transport) {
    // send a new ajax request when this request is finished
    if (!this.comet.noerror)
      // if a connection problem occurs, try to reconnect each 5 seconds
      setTimeout(function(){ comet.connect() }, 5000); 
    else
      this.comet.connect();
    this.comet.noerror = false;
  }
}); 
```

我主要是想了解`onComplete`功能，这就是我在思考的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T00:03:54.853

一个这样的功能是`.ajax`。文档非常详尽：[jQuery .ajax function](http://api.jquery.com/jQuery.ajax/)。

`onSuccess`和-like 功能的一个例子`onComplete`可能是这样的......

```
$.ajax({
    url: "test.php",
    type: "post",
    data: values,
    success: function() {
        alert("success");
    },
    error: function() {
        alert("failure");
    },
    complete: function() {
        alert("both success and error have been checked, request finished!");
    }
}); 
```

还有个人`.post`和`.get`功能，但最好避免使用它们，因为它们会对响应做出假设，这可能导致意外失败。

# opengl - LibGDX 移动旋转相机

> ID：14491650
> 
> 赞同：4
> 
> 时间：2013-01-24T00:01:49.990
> 
> 标签：opengl, matrix, camera, rotation, libgdx

我在使用 LibGDX 构建的应用程序中遇到了一种情况，我需要相机能够旋转，用户也可以移动，并且能够缩放。我的用于移动和缩放相机的相机控件可以很好地工作，但是，当相机旋转时，相机会根据该旋转移动。例如，如果相机向左旋转 45 度，并且用户向右拖动以移动相机，它将向右上角移动，因为这是相机右侧现在指向的位置。相反，我需要相机始终相对于屏幕/用户输入移动，无论其旋转如何。

对于这个问题，我确实有一个解决方案，那就是简单地使用“世界坐标”来定位相机，而不是基于我现在尝试使用的“窗口坐标”。但是，这会造成非常不愉快的用户体验，因为它使相机相当不稳定，并导致我的缩放系统出现问题。我想我可以通过大量调整来解决这些问题，但是，因为它已经使用窗口坐标更加平滑，所以我真的更喜欢走那条路。

我怀疑这个看似简单的问题有一个优雅的解决方案，我可以对矩阵或类似的东西进行简单的计算，但是我对 OpenGL 的了解仍然非常缺乏，我似乎无法弄清楚到底需要发生什么要解决这个问题。任何来自更擅长 OpenGL 和所有这些矩阵的人的想法将不胜感激！

**===编辑===**

这里用来保存值的对象本质上只是我自己的 Vector2 版本，它在应用程序的不同部分中是必需的。我不太记得那里 0.7f 的确切原因，但大概只是为了降低机芯的灵敏度，如果我将其移除，问题仍然存在。

```
camera.position.set(cameraStartPosition.getX() - ((zoomCurrentPosition.getX() - zoomStartPosition.getX()) * 0.7f), cameraStartPosition.getY() + ((zoomCurrentPosition.getY() - zoomStartPosition.getY())  * 0.7f), 0); 
```

cameraStartPosition - 用户开始移动相机时的 X 和 Y 坐标。

zoomStartPosition - 开始缩放的初始触摸的 X 和 Y 坐标

zoomCurrentPosition - 当前控制缩放的触摸所在的 X 和 Y 坐标

其中的 x 和 y 值直接取自 touchDown 和 touchDragged 方法。如果我将设置这些代码的代码放在以下代码之后，则会产生我在原始帖子中提到的问题，它会以应有的方式移动，但非常不稳定。

```
 Vector3 vector = new Vector3(x, y, 0);
    camera.unproject(vector);
    x = (int) vector.x;
    y = CanvasAnywhereMain.HEIGHT - (int) vector.y; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T09:34:26.917

我今天在编写轨道相机时正在处理类似的问题。我将尝试向您描述我是如何处理这个问题的。

我希望我的轨道相机能够同时绕 X 轴和 Y 轴旋转，但它不起作用。我只能分别围绕这个轴旋转。

对我来说，诀窍是：

```
Vector3 target = Vector3.zero
Vector3 right = new Vector().set(camera.direction).crs(camera.up).nor();

// This angles usualy comes from touchDragged event in your input processor
// class implementing the InputProcessor, where you do your calculations
deltaAngleX = 1.1f;
deltaAngleY = 1.9f;

// Rotate around X axis
camera.rotateAround(target, right, deltaAngleX);

// Rotate around Y
camera.updateRotation(Vector3.Y, deltaAngleY); 
```

当您围绕 Y 轴旋转时，一切都很好，因为 Y 轴不会根据您的 X 旋转而改变。你总是想绕着世界 Y 轴旋转，而不是任何一个局部的。

但是当你围绕 X 旋转时，你不能使用 Vector3.X，因为这个轴不会相对于你的相机位置和方向。所以我们需要计算相机的“局部 Y”轴。为此，我们需要知道两个向量的叉积是什么。请参阅[wiki 上的 Cross product](http://en.wikipedia.org/wiki/Cross_product)和[libgdx 类参考上的 crs()](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/math/Vector3.html#crs%28com.badlogic.gdx.math.Vector3%29)

以下代码片段将返回新的 Vector3，它将指向相对于当前相机的右轴。请注意，调用 nor() 是因为我们想要规范化该向量。

**长话短说：**

```
Vector3 right = new Vector().set(direction).crs(up).nor(); 
```

Crs 从两个向量（在我们的例子中是 camera.direction 和 camera.up）创建叉积向量。

我不明白为什么在 Vector3 中没有公开正确的成员变量或者为什么不存在正确的向量计算方法，但这无论如何都可以解决问题

只需很少的代码编辑，您就可以围绕您需要的轴移动您的播放器、相机或世界上的任何东西。您只需要了解基本的 Vector 操作，因此我建议您了解它们

*最后一点：*

您必须先绕 X 轴旋转，因为绕 Y 旋转会改变需要重新计算的局部 X 轴（右矢量）。

# android - 以编程方式访问 rowlistview

> ID：14491652
> 
> 赞同：0
> 
> 时间：2013-01-24T00:01:54.923
> 
> 标签：android

我正在尝试以`ListView`编程方式更改文本的对齐方式，而不是更改 xml 文件。

这是我的`row_listview.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/textViewRowList" 
    android:layout_height="?android:attr/listPreferredItemHeight"
    android:layout_width="fill_parent"
    android:textSize="20sp"
    android:paddingLeft="6dip"
    android:paddingRight="6dip" 
    android:gravity="left" 
    android:textColor="#330033"
    android:textStyle="bold"/> 
```

并在那里定义`activity_main.xml`了以下内容`ListView`

```
<ListView
    android:id="@+id/listView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:divider="@null"
    android:dividerHeight="0dp"
    tools:listitem="@android:layout/simple_list_item_1" 
    android:background= "#FF6600">
 </ListView> 
```

因此，`mainactivity.java`当用户单击我的活动上的按钮时，我试图在运行时更改列表视图中文本的对齐方式

```
private ListView lv;
private TextView tvRowListView;
lv.setAdapter(new ArrayAdapter<String>(this,R.layout.row_listview, sampleStringArray));
tvRowListView = (TextView) findViewById(R.id.textViewRowList);
tvRowListView.setGravity(Gravity.CENTER); 
```

然而，上面的最后一行是抛出空指针异常。我不确定为什么。有人可以在这里提出一些想法/解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:09:14.480

您的 textViewRowList 存在于该列表中的每个项目，如果您想更改它的属性，您需要`Adapter`在其中进行，`getView`这意味着您需要制作一个自定义适配器

# jquery - Jquery 可删除函数参数

> ID：14491656
> 
> 赞同：2
> 
> 时间：2013-01-24T00:02:33.900
> 
> 标签：jquery, jquery-ui

有什么方法可以一次将多个变量传递给 Jquery.droppable 函数，而不是两次使用相同的函数减速但名称不同？

或者这不能正常工作？

**所以像**

```
var $Monday = $( "#Monday" );
var $Tuesday = $( "#Tuesday" );

$Monday.droppable, $Tuesday.droppable({      
    accept: "#gallery > li",      
    activeClass: "ui-state-highlight",    
    drop: function( event, ui ) {   
      } 
```

代替

```
$Monday.droppable({      
    accept: "#gallery > li",      
    activeClass: "ui-state-highlight",    
    drop: function( event, ui ) {   
      }

$Tuesday.droppable({      
    accept: "#gallery > li",      
    activeClass: "ui-state-highlight",    
    drop: function( event, ui ) {   
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:08:34.730

看看 .add()

```
$Monday.add($Tuesday).doStuff(...) 
```

# mysql - 尝试使用 phpMyAdmin 创建 MySQL 触发器，但出现 MySQL 错误 #1422

> ID：14491659
> 
> 赞同：0
> 
> 时间：2013-01-24T00:02:45.210
> 
> 标签：mysql, triggers

我正在尝试在 MySQL 中创建一个在表更新后触发的触发器。（我遇到了一个小问题，在调用我的代码之前会插入一堆行。第一个 if 语句正在检查它。）所以我得到了错误`#1422 - Explicit or implicit commit is not allowed in stored function or trigger.`

那是我的代码：

```
DELIMITER //

CREATE TRIGGER
    `Update_Player_Rankings`
AFTER INSERT ON
    `sg_playerstats`
FOR EACH ROW

BEGIN
    SET
        @test1 = 0,
        @test2 = 0;

    SELECT
        `gameno`
    INTO
        @test1
    FROM
        `sg_gamestats`
    ORDER BY
        `gameno` DESC
    LIMIT
        0,
        1;

    SELECT
        COUNT(*)
    INTO
        @test2
    FROM
        `sg_playerstats`
    WHERE
        `gameno` = @test1
    GROUP BY
        `gameno`
    LIMIT
        0,
        1;

    IF
        @test1 = @test2
    THEN

        SET
            @var1 = 1,
            @var2 = 0;

        SELECT
            `id`
        INTO
            @var1
        FROM
            `sg_playerstats`
        ORDER BY
            `id` DESC
        LIMIT
            0,
            1;

        SELECT
            `Last Updated`
        INTO
            @var2
        FROM
            `sg_playerranking`
        LIMIT
            0,
            1;

        IF
            @var1 > @var2
        THEN

            TRUNCATE
                `sg_playerranking`;

            SET
                @Rank := 0;

            INSERT INTO
                `sg_playerranking`
            SELECT
                @Rank := @Rank + 1 AS `Rank`,
                t.*,
                @var1 AS `Last Updated`
            FROM
                (
                    SELECT
                        `player` AS `Player`,
                        SUM(1) AS `Games`,
                        SUM(`points`) AS `Points`,
                        SUM(`points`) / SUM(1) AS `Points per Game`,
                        SUM(IF(`position` = 1, 1, 0)) AS `Wins`,
                        SUM(IF(`position` = 1, 1, 0)) / SUM(1) AS` Wins per Game`,
                        SUM(IF(`position` = 1, 0, 1)) AS `Loses`,
                        SUM(IF(`position` = 1, 0, 1)) / SUM(1) AS `Loses per Game`,
                        SUM(`kills`) AS `Kills`,
                        SUM(`kills`) / SUM(1) AS `Kills per Game`,
                        SUM(`death`) AS `Deaths`,
                        SUM(`death`) / SUM(1) AS `Deaths per Game`,
                        SEC_TO_TIME(SUM(`time`) / 1000) AS `Time played`,
                        ROUND(sqrt(SUM(`points`)) + 10 * SUM(`points`) / SUM(1) + 10 * sqrt(SUM(IF(`position` = 1, 1, 0))) + 100 * SUM(IF(`position` = 1, 1, 0)) / SUM(1) - 5 * sqrt(SUM(IF(`position` = 1, 0, 1))) - 50 * SUM(IF(`position` = 1, 0, 1)) / SUM(1) + 7.5 * sqrt(SUM(`kills`)) + 75 * SUM(`kills`) / SUM(1) - 3.75 * sqrt(SUM(`death`)) - 37.5 * SUM(`death`) / SUM(1), 2) AS `Score`
                    FROM
                        `sg_playerstats`
                    GROUP BY
                        `player`
                    ORDER BY
                        `Score` DESC,
                        `Points per Game` DESC,
                        `Wins per Game` DESC,
                        `Loses per Game` ASC,
                        `Kills per Game` DESC,
                        `Deaths per Game` ASC,
                        `Points` DESC,
                        `Wins` DESC,
                        `Loses` ASC,
                        `Kills` DESC,
                        `Deaths` ASC,
                        `Games` DESC,
                        `Time played` DESC,
                        `Player` DESC
                ) t;
        END IF;
    END IF;
END;

//

DELIMITER; 
```

我希望你能帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:07:49.917

问题是您的 TRUNCATE 语句。该语句不能从触发器执行，因为该语句执行隐式提交。（可能还有其他原因，但一个就足够了。）

# android - 事件未触发

> ID：14491663
> 
> 赞同：0
> 
> 时间：2013-01-24T00:03:10.543
> 
> 标签：android, android-layout

我正在开发一个具有登录活动的应用程序。该视图有一个电子邮件字段、一个密码字段和一个按钮。

我创建了一些侦听器来捕捉各种可能性，但在其中任何一个上都没有触发 onClick 和/或 onTouch 方法。

这是代码：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.net.URI;
import java.net.URISyntaxException;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;

import android.os.Bundle;
import android.app.Activity;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.MenuItem;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.View.OnFocusChangeListener;
import android.view.View.OnTouchListener;
import android.view.inputmethod.EditorInfo;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.TextView.OnEditorActionListener;
import android.support.v4.app.NavUtils;

public class LoginActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_login);
    // Show the Up button in the action bar.
    getActionBar().setDisplayHomeAsUpEnabled(true);

    final EditText txtemail;
    final EditText txtpassw;

    Button btlogin;
    btlogin = (Button) findViewById(R.id.btLogin);

    txtemail = (EditText) findViewById(R.id.txtEmail);
    txtpassw = (EditText) findViewById(R.id.txtPassword);

    txtemail.setOnFocusChangeListener(new OnFocusChangeListener() {
        @Override
        public void onFocusChange(View v, boolean hasFocus) {
            String txt = txtemail.getText().toString();
            if (!hasFocus) {
                if (!validateEmail(txt)) {
                    txtemail.setError("This is not a valid email address!");
                } else {
                    if (!txt.contains("something.com") && !txt.contains("something.nl")) {
                        txtemail.setError("You cannot use this tool with this email address!");
                    } else {
                        if (txt.length() == 0) {
                            txtemail.setError("This field cannot be blank!");
                        } else {
                            txtemail.getNextFocusDownId();
                        }
                    }
                }
            }
        }
    });

    txtpassw.setOnFocusChangeListener(new OnFocusChangeListener() {
        @Override
        public void onFocusChange(View v, boolean hasFocus) {
            String txt = txtpassw.getText().toString();
            if (!hasFocus) {
                if (txt.length() == 0) {
                    txtpassw.setError("This field cannot be blank!");
                }
            }
        }

    });

    txtpassw.setOnEditorActionListener(new OnEditorActionListener() {
        @Override
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
            if (actionId == EditorInfo.IME_ACTION_DONE) {
                String txt = txtpassw.getText().toString();
                if (txt.length() == 0) {
                    txtpassw.setError("This field cannot be blank!");
                    return false;
                }
                if (checkLogin(txtemail.getText().toString(),txtpassw.getText().toString())) {
                    closeActivity();
                    return true;
                } else {
                    txtpassw.setError("These credentials are not correct!");
                    return false;
                }
            }
            return false;
        }
    });

    btlogin.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View arg0, MotionEvent arg1) {
            if (checkLogin(txtemail.getText().toString(),txtpassw.getText().toString())) {
                closeActivity();
                return true;
            } else {
                txtpassw.setError("These credentials are not correct!");
            }
            return false;
        }
    });

    btlogin.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            if (checkLogin(txtemail.getText().toString(),txtpassw.getText().toString())) {
                closeActivity();
            } else {
                txtpassw.setError("These credentials are not correct!");
            }
        }
    });
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_login, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        // This ID represents the Home or Up button. In the case of this
        // activity, the Up button is shown. Use NavUtils to allow users
        // to navigate up one level in the application structure. For
        // more details, see the Navigation pattern on Android Design:
        //
        // http://developer.android.com/design/patterns/navigation.html#up-vs-back
        //
        NavUtils.navigateUpFromSameTask(this);
        return true;
    }
    return super.onOptionsItemSelected(item);
}

public boolean validateEmail(String email) {

    Pattern pattern;
    Matcher matcher;
    String EMAIL_PATTERN = "^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$";
    pattern = Pattern.compile(EMAIL_PATTERN);
    matcher = pattern.matcher(email);
    return matcher.matches();

}

public void closeActivity() {
    NavUtils.navigateUpFromSameTask(this);
} 
```

我第一次尝试创建登录活动时，我使用了 Eclipse 可以创建的默认登录活动，但在那里我也遇到了同样的问题。

这里有什么问题？我错过了什么？

rg，埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T02:59:11.867

请注意在您的活动类中实现 onTouchListener 和 onFocusChangedListener

```
 public class LoginActivity extends Activity implements OnTouchListener,
      ,OnFocusChangeListener{

 @Override
 public boolean onTouch(View v, MotionEvent event) {
 // TODO Auto-generated method stub
 return false;
  }

  @Override
  public void onFocusChange(View v, boolean hasFocus) {
  // TODO Auto-generated method stub

  }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T21:04:38.497

弄清楚了。

从主活动开始，而不是为登录活动开始新的意图，我将 contentview 设置为登录布局。

显然这是错误的。

# objective-c - NSMutableDictionary 和 [NSNull null] 值

> ID：14491667
> 
> 赞同：1
> 
> 时间：2013-01-24T00:03:22.197
> 
> 标签：objective-c, cocoa-touch, nsdictionary, nsnull

好的。我已经搜索和搜索无济于事，我一直在努力解决这个问题。

我正在尝试确定 UITextField 是否具有空白值，如果是，则将空值发送到服务器，而不仅仅是空白字符串。

以下代码

```
NSDictionary *locationDict = @{
    @"country":countryVal,
    @"state":stateVal,
    @"city":[cityField.text isEqualToString:@""] ? [NSNull null] : cityField.text
};
NSLog(@"%@", locationDict); 
```

记录这个

```
{
    city = "<null>";
    country = US;
    state = TN;
} 
```

我无法弄清楚为什么`[NSNull null]`会在`"<null>"`. 如果用户不输入值，应用程序会继续将该字符串作为城市发送，显然不是我想要的。我没有在这里显示网络调用，但我正在使用 AFNetworking 来执行此操作。不过，在我调用 AFN 之前，我可以确认字典包含该字符串而不是 null。所以我知道问题不在于AFN。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T00:19:32.063

`<null>`是 的结果`[[NSNull null] description]`。您可以使用`NSLog(@"%@", [NSNull null]);`. 如果您想要`<null>`用户不输入城市时以外的其他内容，请使用您想要的值而不是`[NSNull null]`在您的 line`@"city":[cityField.text isEqualToString:@""] ? [NSNull null] : cityField.text`中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T00:26:47.620

当您记录一个 Obj-C 对象（使用`%@`）时，NSLog 函数将实际调用`-(NSString*)description`它并打印返回的任何字符串。此方法继承自`NSObject`并`NSDictionary`已覆盖它。它创建一个字符串，它是一个键/值对列表，由花括号分隔`=`并包裹在花括号中。因此它将调用`description`该字典的任何键和任何值。如果你调用`description`一个`NSNull`对象，它会返回字符串`<null>`。的`desription`方法`NSNull`如下所示：

```
- (NSString *)description
{
    return @"<null>";
} 
```

周围的引号由 加上`NSDictionary`，因为每个包含 ASCII 字母和数字以外的字符（在本例中为`<`and `>`）的字符串都包含在引号中。如果您替换`US`by`US.`和`TN`by `!TN`，则这两个也在引号中。

我不明白的是你为什么首先使用`NSNull`。将空字符串放入字典中没有问题，服务器可以简单地检查字符串是否为空。

```
NSDictionary *locationDict = @{
    @"country":@"US",
    @"state":@"TN",
    @"city":@""
};
NSLog(@"%@", locationDict); 
```

输出

```
{
    city = "";
    country = US;
    state = TN;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T01:27:41.007

如果您需要一个以不同方式描述自己的空值，您可以考虑将 NSNull 子类化，或者您可以将 NSValue 子类化——子类化 NSValue 可以为您提供可以解码/编码为 NSPropertyList 的东西的额外好处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T00:31:15.097

关于 [[NSNull null] description] 的答案是正确的。

IMO 如果您想向服务器发送“空”值，请不要填充该键/值对。如果你想在这里做一些特别的事情，你必须预处理字典。

这在很大程度上取决于您是否可以控制服务器处理事物的方式以及您发送的格式。

将 NSNull 转换为 nil 并返回到集合处理代码中的代码是非常典型的。

# android - 在 TextView 的开头显示 @

> ID：14491674
> 
> 赞同：1
> 
> 时间：2013-01-24T00:03:56.947
> 
> 标签：android, android-layout, textview

`TextView`我需要在以 @ 符号开头的 Twitter 句柄中显示一个字符串。当我将字符串放入我的 strings.xml 时，它不喜欢字符串开头的 @ 并给出错误：

```
error: Error: No resource type specified (at 'twitter_handle' with value '@twitter_handle'). 
```

其中包含使用字符串资源的 layout.xml`TextView`给出了错误：

```
The following classes could not be found:
- TextView (Change to android.widget.TextView, Fix Build Path, Edit XML) 
```

如果 @ 符号不在文本开头，而是在字符串中的任何其他位置，则不会出现错误。

`&#64`如果我使用或转义 @ 符号`\u0040`，则该错误在 strings.xml 中消失，但我仍然在 layout.xml 中收到错误。

有没有办法`TextView`在 layout.xml 中使用以 @ 符号开头的字符串？

字符串.xml：

```
...
<string name="twitter_handle">@twitter_handle</string>
... 
```

布局.xml：

```
...
<TextView
    ...
    android:text="@string/twitter_handle"
    ... />
... 
```

毫无疑问，问题与前导 @ 暗示对资源的引用有关，但不应该考虑转义 @ 符号并正常工作吗？

**更新：**这个问题被发现是 ADT Eclipse 插件中的一个错误。安装最近发布的最新版本修复了该问题，并且在 strings.xml 中转义 @ 不再导致错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:06:04.803

用前导斜杠转义它，如下所示：`<string name="test">\@twitter</string>`

编辑：我应该读过。您可以通过`String`从中`TextView`获取字符串并将其设置为`TextView`

```
 String twitter = getString(R.id.twitter);
 textView.setText(twitter); 
```

编辑2：试试这个而不是@符号：`&#64;`。这是标志的html代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:41:54.917

你可以试试这个。在 string.xml 中创建一个字符串并在您的布局代码中使用它。

```
<string name="example"><Data>@twitter</Data></string> 
```

@twitter 是你的字符串的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T01:50:06.467

这段代码对我来说很好，刚刚测试过。请注意仅在 strings.xml 上的反斜杠

字符串.xml：

```
...
<string name="twitter_handle">\@twitter_handle</string>
... 
```

布局.xml：

```
...
<TextView
    ...
    android:text="@string/twitter_handle"
    ... />
... 
```

并`@twitter_handle`在文本视图中显示

# python - Flask SQLAlchemy 设置动态 URI

> ID：14491678
> 
> 赞同：5
> 
> 时间：2013-01-24T00:04:35.163
> 
> 标签：python, sqlalchemy, flask, uri

我在 WSGI 下提供了一个 Flask 应用程序，其中数据库 URI 随时间而变化。每两个小时，URI 就会切换到另一个数据库。我正在利用这段时间来填充一个数据库，而另一个正在为应用程序提供数据。

我很难弄清楚如何最好地配置会话，以便在发生切换时，客户端将在下一次请求时获得正确的（不同的）数据库。根据我的测试，如果我在顶层初始化数据库，当切换发生时，客户端仍然指向旧数据库。

我考虑过在页面（索引等）本身内设置会话，但是太痛苦了，然后我担心打开和关闭太多的数据库连接并让它们闲置。我想我可以通过在启动时初始化两个会话来使其工作，然后选择在每个页面内的切换时使用哪个会话。这似乎效率低下，我相信有更好的方法。

帮助？！

~~~~~~~~~

这是我目前正在做的事情的一般概念，但无法更改请求之间的 URI。顶级代码只运行一次，或者每隔一段时间运行一次。

```
if now.hour % 2:
    db_name = 'db1'
else:
    db_name = 'db2'

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = "mysql://foo:poo@localhost:3306/%s" % db_name

def init_db(uri, **kwargs):
    engine = create_engine(uri, **kwargs)

    Base.metadata.create_all(bind=engine)

    global db_session
    db_session = scoped_session(sessionmaker(autocommit=False, autoflush=False, bind=engine))
    Base.query = db_session.query_property()

init_db(app.config['SQLALCHEMY_DATABASE_URI'], pool_recycle=3600)

@app.teardown_request
def shutdown_session(exception=None):
    db_session.remove()

@app.route('/')
def index():
    ...etc... 
```

工作示例 - 美丽。

```
app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = "mysql://foo:poo@localhost:3306/%s"

class SessionManager(object):
    def __init__(self, base_uri=None, **kwargs):
        self.session = None
        self.base_uri = base_uri
        self.kwargs = kwargs

    def get_session(self):
        if now.hour % 2:
            db_name = 'db1'
        else:
            db_name = 'db2'

        if self.session:
            if self.session.name == db_name:
                return self.session
            else:
                self.session.remove()
                self.session = None

        if not self.session:
            engine = create_engine(self.base_uri % db_name, **self.kwargs)
            db_session = scoped_session(sessionmaker(bind=engine))
            db_session.name = db_name
            self.session = db_session
        return db_session

session_manager = SessionManager(base_uri=app.config['SQLALCHEMY_DATABASE_URI'], pool_recycle=3600)

db_session = LocalProxy(session_manager.get_session) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T09:51:12.253

您可以为会话创建自定义构建器，当您的规则规定时，它将重新创建引擎和范围会话。就像是

```
class SessionManager(object):

    def __init__(self):
        self.session = None

    def get_session(self):
        # return existing session or make a new engine and scoped_session 
```

要使此类透明，请使用[Werkzeug 的 LocalProxy](http://werkzeug.pocoo.org/docs/local/#werkzeug.local.LocalProxy)。使用会话的代码根本不需要更改。

```
session_manager = SessionManager()
db_session = LocalProxy(session_manager.get_session) 
```

# android - 将空视图添加到列表视图

> ID：14491679
> 
> 赞同：0
> 
> 时间：2013-01-24T00:04:37.053
> 
> 标签：android, listview, layout

不，它不是重复的。

我有一个`ListView`（不是`View`布局 xml 文件中的`View`as 类）并且想要显示空状态的视图。
该`addView`方法不可用，简单替换`ListView`不起作用，因为父级是`ViewPager`.

**有任何想法吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:39:29.183

> 我的父母是 ViewPager，我不知道如何只在一个页面上创建视图

您的页面`ViewPager`是由某种形式的`PagerAdapter`. 据推测，从您描述事物的方式来看，您推出了自己的`PagerAdapter`，而不是使用基于片段的内置片段之一。而且，大概`PagerAdapter`是为一个或多个页面返回 a `ListView`，您想要一个“空视图”。

简单地说：你将不得不改变它`PagerAdapter`。与其返回 a `ListView`，不如返回`FrameLayout`包含您`ListView`和您的“空视图”之类的东西。无论您是用 Java 还是通过扩展布局资源来创建这些对象，都取决于您。一路上，呼吁`setEmptyView()`把`ListView`和`ListView`“空景”联系在一起。

# spring-mvc - Spring Webflow 状态下的部分 JSR303 分组验证

> ID：14491680
> 
> 赞同：1
> 
> 时间：2013-01-24T00:04:41.117
> 
> 标签：spring-mvc, spring-webflow, bean-validation, hibernate-validator

我有一个实体，它有几个带有 JSR303 注释约束的字段。我希望用户分几个步骤设置这些字段。我认为具有显式绑定属性的视图状态可以完成这项工作。

我通过将 LocalValidatorFactoryBean 设置为`<webflow:flow-builder-services … validator="flowValidator"/>`. hibernate-validator-5 在类路径中。

```
@Configuration
@ImportResource("classpath:/flow.xml")
public class FlowConfiguration {
   @Bean LocalValidatorFactoryBean flowValidator() {
            return new LocalValidatorFactoryBean();
    }
} 
```

这并不能满足我的需要。使用启用的验证器，视图状态会验证完整的实体，但由于存在 @NotNull 约束而失败。尽管视图状态只有一个子集。

```
<view-state id="insertUser" view="registration/insertUser" model="vendor">
        <binder>
            <binding property="email" required="true" />
            <binding property="name"  required="true" />
        </binder>
  …
</view-state> 
```

通过进一步阅读，我发现我在谈论 JSR-303 组。是否支持使用 Spring Web 流验证组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T00:32:59.533

[SWF-1453](https://jira.springsource.org/browse/SWF-1453)表示它包含在 SWF 2.4.0 中，并且已经在最新的 SNAPSHOT 中可用。

# git - 提交时git中的父树哈希是否改变？

> ID：14491681
> 
> 赞同：0
> 
> 时间：2013-01-24T00:04:59.403
> 
> 标签：git

我执行了第一次提交并查看树的哈希值是什么，我运行了`git cat-file -P HEAD`给我以下输出的命令；

```
tree ac9b570150cca9243e1546f6c1b393f851dd7559
author pm 1358978176 +1300
committer pm 1358978176 +1300 
```

然后我进入`add`一个新目录，然后是`commit`. 然后我运行了`git cat-file -p HEAD`具有以下输出的命令；

```
tree 297f145b042bf11f16ac39fa109df151a8d56ae3
parent dc2683fdf1bf9d5db5f1dc6fbb62576d10d57ae7
author pm 1358985313 +1300
committer pm 1358985313 +1300 
```

我会认为父哈希是前面提交的哈希，即`ac9b570150cca9243e1546f6c1b393f851dd7559`. 我是否没有正确理解父哈希的使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:12:04.353

`ac9b570150cca9243e1546f6c1b393f851dd7559`是，根据您的信息，前一棵树的哈希，而不是前一次提交。您不会在此处显示初始提交 ID，但`git log`会显示给您。

例如，给定：

```
$ git log
commit be2ddc1cdc0cbe0dad791712806b5c155fa357fc
Author: Lars Kellogg-Stedman <lars@oddbit.com>
Date:   Wed Jan 23 19:13:27 2013 -0500

    second commit

commit 0e25b7e892bc6e637704909b3d66612807c8edc6
Author: Lars Kellogg-Stedman <lars@oddbit.com>
Date:   Wed Jan 23 19:13:03 2013 -0500

    initial commit 
```

我们可以运行`git cat-file -p HEAD`：

```
$ git cat-file -p HEAD
tree cdbd58dcba3cf89422f444a310979f6b40dde1ad
parent 0e25b7e892bc6e637704909b3d66612807c8edc6
author Lars Kellogg-Stedman <lars@oddbit.com> 1358986407 -0500
committer Lars Kellogg-Stedman <lars@oddbit.com> 1358986407 -0500

second commit 
```

在这个输出中，`tree`是当前树的哈希值，并且`parent`与上一次提交的 id 匹配。

# javascript - 更改字符串中的某些数字

> ID：14491684
> 
> 赞同：3
> 
> 时间：2013-01-24T00:05:31.593
> 
> 标签：javascript

我有一个字符串，它有时包含 css 字体大小。例如：

```
str = '<span style="font-size: 200px;white-space:nowrap;">Text</span>
<br><span style="color:#555555;font-size:10px;">Some otherText</span>'; 
```

我需要通过将它们全部乘以例如 1.5 的设定比率来更改所有字体大小

```
var ratio = 1.5; 
```

搜索和替换不是我的强项。如何在字符串中搜索所有字体大小，然后对每个数字进行数学运算？

这样上面这个比例的字符串就变成了：

```
str = '<span style="font-size: 300px;white-space:nowrap;">Text</span>
<br><span style="color:#555555;font-size:15px;">Some otherText</span>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:11:06.927

假设将它作为一个字符串并且没有更好的方法（如果它来自`innerHTML`左右，你做错了），那么......

```
var fauxDocFrag = document.createElement("div");
var elements, i, len;

fauxDocFrag.innerHTML = str;

elements = fauxDocFrag.getElementsByTagName("*");

for (i = 0, len = elements.length; i < len; i++) {
    elements[i].style.fontSize = (parseInt(elements[i].style.fontSize) * 1.5)
                                 + "px";
}

str = fauxDocFrag.innerHTML; 
```

[js小提琴](http://jsfiddle.net/vK59Z/)。

如果你的浏览器没有坏...

```
var fauxDocFrag = document.createElement("div");

fauxDocFrag.innerHTML = str;

[].forEach.call(fauxDocFrag.getElementsByTagName("*"), function(element) {
     element.style.fontSize = (parseInt(elements.style.fontSize) * 1.5)
                              + "px";
});

str = fauxDocFrag.innerHTML; 
```

如果任何声明不在`style`属性中，您可以使用`getComputedStyle()`.

我没有使用 real `documentFragment`，因为它不支持该`innerHTML`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:14:59.907

亚历克斯是对的，可能有更好的方法，但是用字符串替换答案来回答你的问题：

```
str = str.replace(/(\d+)px/g, function (fullStr, pixels) {
  return (pixels * 1.5) + 'px';
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T00:14:21.543

您可以使用对象的`replace`方法`String`，并指定一个函数作为替换值。

```
str.replace(/font-size:\s*(\d*)/g,
            function (line, p1) { return ratio * parseInt(p1) }) 
```

# c# - 回弹旋转的 BoundingSphere

> ID：14491685
> 
> 赞同：4
> 
> 时间：2013-01-24T00:05:49.177
> 
> 标签：c#, xna, geometry

我正在制作一个 2d 弹球游戏并使用 BoundingSphere 作为命中框，作为捷径。

我遇到的问题是很多东西一直在旋转，我需要找到一种方法来计算当球撞击其他圆形物体时“准确”的回弹角度。

任何帮助，轻推和线索将不胜感激

/Edit 找不到任何东西，但设法解决了这个问题，有点工作

一旦检测到两个 BoundingSphere 之间的碰撞，就会调用此方法。

```
 private void CollisionRebound(Sprites.BaseSprite attacker, Vector2 defender)
    {
        //Work out the rotation that would result in a "dead on" collision
        //thus rebounding the attacker straight back the way they came.
        float directHitRotation = (float)Math.Atan2(defender.Y - attacker.Position.Y , defender.X - attacker.Position.X);
        //only really needed if the rotation is a negative value but is easier to work from in general.
        float attackerRotation = attacker.rotation;

        //This makes the rotation a positive number, it cant be less that -2PI
        //so adding 2PI will leave us with a positive rotation.
        if (attackerRotation < 0)
        {
            attackerRotation += (float)(Math.PI * 2);
        }

        //If the rotation is greater than the "dead on" rotation the rotation
        //needs to increase.
        if (attackerRotation > directHitRotation)
        {
            //we add "PiOver2" or "90 degrees" to "dead on" rotation because we do, dont know enough
            //trig to explain it just know it works, we then add 90 degrees minus the difference between
            //our two rotation to give us our outgoing angle, the +0.01f is for the rare case where the
            //difference is 90 which would give us no change in rotation but if the two spheres have collided
            //(which they have to before coming to this code chunk) there will be at least some change.
            attackerRotation = directHitRotation + (float)MathHelper.PiOver2 + ((float)MathHelper.PiOver2 -
                (attackerRotation - directHitRotation) + 0.01f);
        }
            //If the rotation is less than the "dead on" rotation the rotation
            //need to decrease.
        else if (attackerRotation < directHitRotation)
        {
            //same as previous chunk but we will be minusing the angle
            attackerRotation = directHitRotation - (float)MathHelper.PiOver2 - ((float)MathHelper.PiOver2 -
                (attackerRotation - directHitRotation) - 0.01f);
        }
        else if (attackerRotation == directHitRotation)
        {
            //either of the two calculations could be used here but would result in the same outcome
            //which is rotating the attacker 180 degrees, so just add 2PI instead.
            attackerRotation += (float)Math.PI;
        }

        //Here we just assign out new output rotation to the attacker entity.
        attacker.rotation = attackerRotation;
    } 
```

只是偶尔让“攻击者”粘在“防守者”身上，有什么解决这个问题的建议吗？

添加注释以向有兴趣使用它的其他人解释代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T04:19:21.403

我打算试一试，没有实际尝试，所以我不能保证这是准确的。此外，这是伪代码。

我们需要知道球体之间的碰撞点。如果您正在等待每一帧检测到碰撞，那么您的球体可能会部分相互穿透，所以我要做的第一件事就是将它们相互推出。为了做到这一点，您需要知道将每个推到多远。

```
Vector3 BtoA = (SphereA.center - SphereB.center);
Vector3 AtoB = (SphereB.center - SphereA.center);

float currentDistance = AtoB.length();

float minimumDistance = SphereA.radius + SphereB.radius;

// If the spheres are interpenetrating then push them apart until 
// they're colliding only at a single point.

// Do a quick sanity check here
if ( currentDistance > minimumDistance )
{
    // Your spheres aren't close enough to be touching, how did you get here?
}
else if ( currentDistance < minimumDistance )
{
    // We move each sphere away by half of the penetration distance.
    float penetrationDistance = currentDistance - minimumDistance;

    Vector3 unitBtoA = BtoA.unitize();
    SphereA.position = SphereA.position + (unitBtoA * penetrationDistance * 0.5f);

    Vector3 unitAtoB = AtoB.unitize();
    SphereB.position = SphereB.position + (unitAtoB * penetrationDistance * 0.5f);

    // Note that now that we have repositioned the spheres they have different AtoB and
    // BtoA vectors, and theoretically could be colliding with spheres very close to
    // them that they weren't colliding with before. We now recalculate our difference vectors
    BtoA = (SphereA.center - SphereB.center);
    AtoB = (SphereB.center - SphereA.center);
}

// Ok, now we know that the spheres are only touching at one point. We can now calculate
// the reflection/deflection

// I believe the code for calculating a deflection of a velocity off of a surface
// given the normal of that surface is something like this. This assumes no energy
// is lost on the bounce as well, which isn't realistic.
Vector3 Reflect( Vector3 velocity, Vector3 surfaceNormal )
{
    const float dotProductTimesTwo = velocity.Dot(surfaceNormal) * 2.0f; 
    velocity.x -= dotProductTimesTwo * surfaceNormal.x;
    velocity.y -= dotProductTimesTwo * surfaceNormal.y;
    velocity.z -= dotProductTimesTwo * surfaceNormal.z;
}

// Using the above function, we reflect the velocities of both spheres
Vector3 unitBtoA = BtoA.unitize();
Vector3 unitAtoA = AtoA.unitize();

SphereA.velocity = Reflect( SphereA.velocity, unitBtoA );
SphereB.velocity = Reflect( SphereA.velocity, unitAtoB ); 
```

如果您希望反弹更准确，您应该能够根据球体的穿透深度计算出如果您不使用基于帧的应用程序，它们会发生碰撞后经过了多长时间。这应该可以让您计算它们现在应该相隔多远，因为它们已经相互反弹。如果您计算该时间，那么您可以采用我们在上面计算的球体的速度，并将球体的位置修改该时间量。

```
// This variable would hold the amount of time since the spheres actually would have collided
float extra_time;

SphereA.position = SphereA.position + (SphereA.velocity * extra_time);
SphereB.position = SphereB.position + (SphereB.velocity * extra_time); 
```

正如我之前所说，我没有测试过这段代码，所以它可能根本不起作用，但至少这对你来说可能是一个很好的起点，或者可能接近功能。希望这会有所帮助。祝你好运。

# sql - SQL AND 约束导致性能问题

> ID：14491690
> 
> 赞同：1
> 
> 时间：2013-01-24T00:06:19.553
> 
> 标签：sql, sql-server, performance, join, indexing

我有一个看似简单的查询案例，其中添加约束会导致性能大幅下降。受 AND 子句约束的三列都是 bigint。如果我使用其中任何两个（但不是全部三个），查询会立即运行，但只要我添加第三个 AND，它就会运行缓慢。

```
WITH tb AS (SELECT
   DISTINCT u.*  
FROM
   [user] u  
INNER JOIN
   user_personal up 
      ON up.user_id = u.user_id        
WHERE
   1=1  
   AND u.site_instance_id = 1      
   AND u.graduation_class_id = 27  
   AND u.graduation_term_id IN (76,75) 
   ) SELECT
   COUNT (*) AS count 
FROM
   ( SELECT
      ROW_NUMBER() OVER (
   ORDER BY
      last_name ASC) AS row,
      * 
   FROM
      tb) sub 
```

这是否与所有这三个列都是 bigint 的事实有关？还是与这些列上的表索引有关？（我没有为这些列设置任何索引）。或者它可能是别的东西？

注意 - 在这种情况下，AND u.site_instance_id = 1 是多余的，但没关系，不是吗？

编辑使用 SET showplan_all ON 后：

```
 |--Compute Scalar(DEFINE:([Expr1005]=CONVERT_IMPLICIT(int,[Expr1008],0)))
   |--Stream Aggregate(DEFINE:([Expr1008]=Count(*)))
        |--Nested Loops(Left Semi Join, WHERE:(.[dbo].[user].[user_id] as [u].[user_id]=.[dbo].[user_personal].[user_id] as [up].[user_id]))
             |--Clustered Index Scan(OBJECT:(.[dbo].[user].[PK__user__B9BE370F7F60ED59] AS [u]), WHERE:(.[dbo].[user].[site_instance_id] as [u].[site_instance_id]=(1) AND .[dbo].[user].[graduation_class_id] as [u].[graduation_class_id]=(27) AND (.[dbo].[user].[graduation_term_id] as [u].[graduation_term_id]=(75) OR .[dbo].[user].[graduation_term_id] as [u].[graduation_term_id]=(76))))
             |--Clustered Index Scan(OBJECT:(.[dbo].[user_personal].[PK__user_per__C701FAD641EDCAC5] AS [up])) 
```

...并且只有两个 AND 子句...

```
|--Compute Scalar(DEFINE:([Expr1005]=CONVERT_IMPLICIT(int,[Expr1008],0)))
       |--Stream Aggregate(DEFINE:([Expr1008]=Count(*)))
            |--Hash Match(Left Semi Join, HASH:([u].[user_id])=([up].[user_id]), RESIDUAL:(.[dbo].[user].[user_id] as [u].[user_id]=.[dbo].[user_personal].[user_id] as [up].[user_id]))
                 |--Clustered Index Scan(OBJECT:(.[dbo].[user].[PK__user__B9BE370F7F60ED59] AS [u]), WHERE:(.[dbo].[user].[graduation_class_id] as [u].[graduation_class_id]=(27) AND (.[dbo].[user].[graduation_term_id] as [u].[graduation_term_id]=(75) OR .[dbo].[user].[graduation_term_id] as [u].[graduation_term_id]=(76))))
                 |--Clustered Index Scan(OBJECT:(.[dbo].[user_personal].[PK__user_per__C701FAD641EDCAC5] AS [up])) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:34:36.693

我仍然不确定我是否理解你的问题——@Hogan 有一个更简单的查询版本。尽管如此，您应该在您加入的每个字段以及您始终搜索的任何字段上都有索引。

在你的情况下，我会确保你有以下索引：

*   user.user_id（估计已经有PK了）
*   user_personal.user_id
*   user.site_instance_id、user.graduation_class_id 和 user.graduation_term_id

您也可以考虑分别为 WHERE 条件中的 3 个字段中的每一个添加索引，但这应该会产生更好的性能。另外，请改用@Hogan 的查询。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:24:19.573

这个故事一定还有更多。显然，以下代码与发布的代码相同且更简单（我希望更快）：

```
 SELECT COUNT(DISTINCT u.user_id)) as count
  FROM [user] u  
  INNER JOIN  user_personal up ON up.user_id = u.user_id        
  WHERE
   u.site_instance_id = 1   AND   
   u.graduation_class_id = 27  AND
   u.graduation_term_id IN (76,75) 
```

# visual-studio - 是什么导致符号无法从 PDB 文件加载？

> ID：14491691
> 
> 赞同：4
> 
> 时间：2013-01-24T00:06:25.577
> 
> 标签：visual-studio, pdb-files

*   第 1 步：我构建 myProgram.exe 并在其旁边生成 myProgram.pdb。
*   第 2 步：我故意导致 myProgram.exe 崩溃。
*   第 3 步：有人问我是否要使用 Visual Studio 作为调试器，我就这样做了。
*   第 4 步：Visual Studio 从 myProgram.pdb 加载符号。
*   第 5 步：我检查调用堆栈以确定发生崩溃的（已知）位置。
*   第6步：我不会皱眉或看起来很困惑，因为它应该是这样的。

但是，如果我将 myProgram.exe 和 myProgram.pdb 重命名为 SomethingElse.exe 和 SomethingElse.pdb 并重复这些步骤，则从第 4 步开始的结果会混合在一起。据我所知，在我的构建机器上，VS 总是会从重命名的 PDB 文件中成功加载符号。但是，在我的远程目标机器上，VS 永远不会加载符号——它总是告诉我 PDB 文件与可执行文件不匹配。为什么不？我违反了一条晦涩难懂的规则吗？我在任何地方都运行 Visual Studio 2005，以防万一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T23:05:20.413

这里打破的简单微妙规则是 PDB 文件名似乎被编码到 EXE 文件中，而不是从 EXE 文件名派生而来。因此，例如，如果您在 Windows 资源管理器中通过简单的复制和粘贴创建“myProgram.exe 的副本”和“myProgram.pdb 的副本”，尽管名称更改，但似乎正在加载符号。但这只有在原始的“myProgram.pdb”文件也存在时才有效 - 如果您删除“myProgram.pdb”并且只有“myProgram.pdb 的副本”，这些符号可能是兼容的，但 Visual Studio 不会甚至尝试加载它们。

在我办公室的远程机器上进行的快速脏测试中，改变的只是文件名，而不是文件版本，而在实际的远程机器上，名称和文件版本都不同，所以永远不可能看起来有效的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-25T20:07:03.307

如果我的中间目录是输出目录的子目录，Visual Studio 2013 Update 5 会为我创建损坏的 [1] PDB。我解决问题的差异

```
-    <IntDir>$(OutDir)/$(TargetName)/</IntDir>
+    <IntDir>$(OutDir)</IntDir> 
```

[1] 已验证与 windbg 的不匹配`!itoldyouso`

# java - Android_id 的字节长度是多少？

> ID：14491693
> 
> 赞同：1
> 
> 时间：2013-01-24T00:06:41.820
> 
> 标签：java, android, mobile

Secure.Android_ID 的典型长度是多少？在我的测试中，我只遇到了这些长度为 16 个字节的字符串，但我想确保因为我正在构建一个需要区分 Android_ID 和来自 Telephonymanager 的设备 ID 的系统，因为我们的 API 使用相同的 GET 参数Android_ID 和 Device_ID。

[http://developer.android.com/reference/android/provider/Settings.Secure.html#ANDROID_ID](http://developer.android.com/reference/android/provider/Settings.Secure.html#ANDROID_ID)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T00:11:17.523

文档说它是“64 位数字（作为十六进制字符串）”。每个十六进制数字代表 4 位，因此它将是 16 个字符`String`。在所有当前发布的 API >= 3 中都应该是这样。Google 可以随时弃用它并在将来更改它。

# ajax - 使用 remote => true 从 rails 表单渲染没有布局的内容

> ID：14491694
> 
> 赞同：0
> 
> 时间：2013-01-24T00:06:47.580
> 
> 标签：ajax, ruby-on-rails-3, response

我有一个表格将任务标记为已完成：

```
<%= simple_form_for task, :html => { :class => "check-task", :id => ("task" + task.id.to_s) }, :method => :put, :remote => true do |f| %>
  <% task_class = ("#task" + task.id.to_s) %>
  <%= f.check_box :completed, :onclick => "$('#{task_class}').submit()" %>
<% end %> 
```

所以我在点击复选框时通过 js/ajax 提交了这个表单。

响应数据现在包括整个页面`<head>`以及所有内容：

```
respond_to do |format|
  if @task.update_attributes(params[:task])
    format.html { redirect_to @task, notice: 'Task was successfully updated.' }
    format.js { redirect_to request.referer, notice: 'Task was successfully updated.' }
    format.json { head :no_content }
  else
    format.html { render action: "edit" }
    format.json { render json: @task.errors, status: :unprocessable_entity }
  end
end 
```

那么，如何才能取回相应部分中的内容呢？

看这里：

```
<%#= link_to 'New Task', new_task_path, :class => "pull-right" %>
<div class="clearfix"></div>
<div class="row">
  <div class="span6 sidebar">
    <ul class="nav nav-pills nav-stacked">
      <% for stock_list in @stock_lists %>
        <%= navigation_li_link stock_list.title, list_tasks_path(stock_list) %>
      <% end %>  
      <% for user_list in @user_lists %>
        <%= navigation_li_link user_list.title, list_tasks_path(user_list) %>
      <% end %>      
    </ul>
  </div>
  <div class="span18 content">
    <% unless @tasks.empty? %>
      <div class="row">
        <% @tasks.each do |task| %>
          <div class="span18 task<%= task.state %>">
            <div class="row">
              <div class="span1">
                <%= simple_form_for task, :html => { :class => "check-task", :id => ("task" + task.id.to_s) }, :method => :put, :remote => true do |f| %>
                  <% task_class = ("#task" + task.id.to_s) %>
                  <%= f.check_box :completed, :onclick => "$('#{task_class}').submit()" %>
                <% end %>
              </div>
              <div class="span9"><%= task.content %></div>
              <div class="span5"><%= task.due_at %></div>
              <div class="span3">
                <%= link_to '<i class="icon-edit"></i>'.html_safe, edit_task_path(task) %>
                <%= link_to '<i class="icon-trash"></i>'.html_safe, task, method: :delete, data: { confirm: 'Are you sure?' } %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="lead">No Task in here</p>
    <% end%>
  </div>
</div> 
```

谢谢各位！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T10:27:05.630

你可以添加smth。像这样在格式块中：

```
format.json { render :layout => false } 
```

# javascript - js sort() 自定义函数如何传递更多参数？

> ID：14491695
> 
> 赞同：12
> 
> 时间：2013-01-24T00:07:05.077
> 
> 标签：javascript, parameters, sorting, optional-parameters

我有一个对象数组，我需要对自定义函数进行排序，因为我想对几个对象属性执行多次此操作，我想动态地将属性的键名传递给自定义排序函数：

```
function compareOnOneFixedKey(a, b) {
    a = parseInt(a.oneFixedKey)
    b = parseInt(b.oneFixedKey)
    if (a < b) return -1
    if (a > b) return 1
        return 0
}

arrayOfObjects.sort(compareByThisKey) 
```

应该变成这样：

```
function compareOnKey(key, a, b) {
    a = parseInt(a[key])
    b = parseInt(b[key])
    if (a < b) return -1
    if (a > b) return 1
        return 0
}
arrayOfObjects.sort(compareOn('myKey')) 
```

这可以以方便的方式完成吗？谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-24T00:11:18.390

您可以添加一个包装器：

```
function compareOnKey(key) {
    return function(a, b) {
        a = parseInt(a[key], 10);
        b = parseInt(b[key], 10);
        if (a < b) return -1;
        if (a > b) return 1;
        return 0;
    };
}

arrayOfObjects.sort(compareOnKey("myKey")); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-24T00:15:20.760

您需要[部分应用](http://en.wikipedia.org/wiki/Partial_application)该功能，例如使用[`bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
arrayOfObjects.sort(compareOn.bind(null, 'myKey')); 
```

或者您只需`compareOn`返回实际的排序函数，使用外部函数的参数进行参数化（如其他函数所示）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-24T00:11:25.817

是的，让比较器从生成器返回，该生成器需要一个参数，这是您想要的关键

```
function compareByProperty(key) {
    return function (a, b) {
        a = parseInt(a[key], 10);
        b = parseInt(b[key], 10);
        if (a < b) return -1;
        if (a > b) return 1;
        return 0;
    };
}
arrayOfObjects.sort(compareByProperty('myKey')); 
```

`compareByProperty('myKey')`返回进行比较的函数，然后将其传递给`.sort`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-29T21:44:02.020

```
const objArr = [{
    name: 'Z',
    age: 0
  }, {
    name: 'A',
    age: 25
  }, {
    name: 'F',
    age: 5
}]

const sortKey = {
    name: 'name',
    age: 'age'
}

const sortArr = (arr, key) => {
    return arr.sort((a, b) => {
        return a[key] < b[key] ? -1 : a[key] > b[key] ? 1 : 0
    })
}

console.log("sortKey.name: ", sortArr(objArr, sortKey.name))
console.log("sortKey.age: ", sortArr(objArr, sortKey.age))
```

# java - Java 反射错误：参数数量错误

> ID：14491699
> 
> 赞同：6
> 
> 时间：2013-01-24T00:07:33.727
> 
> 标签：java, reflection, constructor

所以我试图在运行时调用一个类构造函数。我有以下代码片段：

```
String[] argArray = {...};
...
Class<?> tempClass = Class.forName(...);
Constructor c = tempClass.getConstructor(String[].class); 
c.newInstance(argArray);
... 
```

每当我编译代码并将其传递给一个类时，我都会收到 IllegalArgumentException: wrong number of arguments。我正在调用的类的构造函数将 String[] 作为唯一参数。同样奇怪的是，如果我将构造函数更改为接受整数并使用 Integer.TYPE 并调用 c.newInstance(4) 或其他东西，它就可以工作。有人可以向我解释我做错了什么吗？谢谢你。

编辑;; 完全错误：

```
java.lang.IllegalArgumentException: wrong number of arguments
[Ljava.lang.String;@2be3d80c
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
at java.lang.reflect.Constructor.newInstance(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-24T00:25:25.583

发生这种情况是因为[`newInstance(Object...)`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Constructor.html#newInstance%28java.lang.Object...%29)需要[varargs](http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html)，`Object`换句话说`Object[]`。由于数组是协变的，所以 a`String[]`也是一个`Object[]`, 并且`argArray`被解释为*所有参数*而不是*第一个参数*。

[jdb 的解决方案](https://stackoverflow.com/a/14491805/697449)之所以有效，是因为它可以防止编译器产生误解。你也可以写：

```
c.newInstance(new Object[] {argArray}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-24T00:19:07.757

我不确定这是否是最好的解决方法，但这应该可以：

```
c.newInstance((Object)argArray); 
```

# apache - 从不同的计算机访问修改后的 localhost 目录

> ID：14491701
> 
> 赞同：0
> 
> 时间：2013-01-24T00:07:43.803
> 
> 标签：apache, networking, ubuntu, localhost

首先，我在 ubuntu 12.10 上运行最新的 apache 补丁。我知道如何从其他计算机访问我服务器的默认 localhost 目录。当我在另一台计算机上输入 192.168.1.** 时，我可以访问 /var/www/ 目录。

但是，如果我想将其指定到不同的目录怎么办？***我在哪里***以及***如何***修改它？主机，conf.d等？以及如何使用域名而不是 IP 访问它？提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:16:12.787

进去看看`/etc/apache2/sites-available`。您很可能会找到一个名为的文件`default`和另一个名为`default-ssl`. `DocumentRoot`可以在此文件中更改。记得重启 Apache...

```
sudo service apache2 restart 
```

或者...

```
sudo apache2ctl graceful 
```

或者...

```
sudo /etc/init.d/apache2 reload 
```

在 中列出多个虚拟主机并不罕见`sites-available`，请记住，这些配置必须具有符号链接`sites-enabled`才能被 Apache 看到。

虚拟主机文件看起来像这样......

```
Listen 80
<VirtualHost *:80>
    DocumentRoot /www/example1
    ServerName www.example.com

    # Other directives here
</VirtualHost> 
```

进一步阅读：[Apache 文档 - 虚拟主机](http://httpd.apache.org/docs/2.2/vhosts/)

# php - 使用 PHP 传递 javascript 数组值以链接和检索它

> ID：14491704
> 
> 赞同：0
> 
> 时间：2013-01-24T00:07:54.397
> 
> 标签：php, javascript, arrays, get

> **可能重复：**
> [参考：为什么我的 Javascript 中的 PHP 代码不起作用？](https://stackoverflow.com/questions/13840429/reference-why-does-the-php-code-in-my-javascript-not-work)

即使我已经检查了一些复选框，输出也总是`bool(false)`如此，我不知道出了什么问题。

到目前为止，这是我尝试过的

这是我的代码：

```
 <a onclick="href='wp-content/themes/twentyelevenchild/addmarked.php?asin=<?php echo serialize('+asinValues+')?>'" class="addmarkeditems fancybox.ajax">Save Test 2</a>
</form>
<div id="results"></div>
<script type="text/javascript">
    var asinValues = $('input[name=checkboxlist]:checked').map(function(){
        return $(this).val();
    }).get();
</script> 
```

在我的`addmarked.php`

```
<?php 
var_dump(unserialize($_GET['asin']));
?> 
```

我的萤火虫截图：

![在此处输入图像描述](../Images/5e86841352aea80082a5adc0e6e3116e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:10:12.247

我做了一个你可能正在寻找的快速工作示例：

[http://jsfiddle.net/ithcy/X3Ecx/2/](http://jsfiddle.net/ithcy/X3Ecx/2/)

您`addmarked.php`应该能够使用`explode(",", $_GET["asin"])`或类似的方法来处理所有已选中复选框的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:29:33.103

假设您添加了丢失的回声：

```
<?php echo serialize('+asinValues+')?> 
```

这完全不像你认为的那样。你不能像这样混合 PHP 和 JS，因为 PHP 首先在服务器上执行，如果它恰好生成 JavaScript，这将在客户端上执行。

那么，PHP 在这里做什么呢？用加号和字母序列化字符串：`'+asinValues+'`. 序列化它看起来像这样：`s:12:"+asinValues+";`

所以你所拥有的 HTML/JS 是：

```
<a onclick="href='wp-content/themes/twentyelevenchild/addmarked.php?asin=s:12:"+asinValues+";'" class="addmarkeditems fancybox.ajax">Save Test 2</a> 
```

由于 PHP 的反序列化没有 JS 对应物，因此您将需要另一种方法来序列化。JSON 将是一个好主意：

**JavaScript**

```
'...?asin=' + JSON.stringify(asinValues) 
```

**PHP**

```
json_decode($_GET['asin']) 
```

# callback - 如何在ajax成功回调中使用live()

> ID：14491705
> 
> 赞同：0
> 
> 时间：2013-01-24T00:07:59.293
> 
> 标签：callback, jquery

我正在开发一个使用 AJAX 显示文章的 wordpress 网站。我在成功回调中添加了一些 jquery 代码。我的需求之一是在鼠标悬停时显示图像。除了鼠标悬停效果外，我所有的代码都有效。

所以这是我的 ajax 函数：

```
function loadArticle(pageNumber, loop, term){    
    $.ajax({
        url: ajax_var.url,
        type:'POST',
        data: someData, 
        success: function(html){
            // This will be the div where our content will be loaded
            $("#content").append(html);    

            // Zoom box
            $('img.static').hide();
            $(".ad-preview").live({
                mouseover: function() {
                    $(this).find('img.static').stop().fadeIn();
                },
                mouseout: function() {
                    $(this).find('img.static').stop().fadeOut();
                }
            });

            //  Other stuff...
        });

        return false;
    }

}); 
```

和 HTML：

```
<div class="ad-preview">
    <a target="_blank" href="">
        <img src="img/zoom.png" /></a>            
    </a>
</div> 
```

实现这种效果的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:12:28.740

首先，您可能应该使用[on](http://api.jquery.com/on)而不是`live`. 其次，委托处理程序不必在回调中应用。因为它们被委派给保留在页面上的更高级别的元素，所以您可以在页面加载时应用它们。

```
 $("body").on('mouseover', '.ad-preview', function() {
            $(this).find('img.static').stop().fadeIn();
    })
    .on('mouseout', '.ad-preview', function() {
            $(this).find('img.static').stop().fadeOut();
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T00:11:43.647

.live 是一个活跃的监听器，被[.on取代](http://api.jquery.com/on/)

您可以将它放在 ajax 调用之外，在 js 的基础级别 - 换句话说，不是在 document.ready 调用或其他函数中。它将适用于通过 ajax 加载的 dom 元素。

# python - 在嵌套类中使用对象继承对象进行迭代

> ID：14491712
> 
> 赞同：2
> 
> 时间：2013-01-24T00:08:21.107
> 
> 标签：python, oop

我正在构建一个粒子过滤器来处理来自 pandas DataFrame 的数据。过滤器背后的一个想法是迭代以估计最佳结果（类似于蒙特卡洛）。我有一个基类`ExperimentalData()`，它具有收集数据等的基本方法。我将构建另一个具有不同过滤器的类。过滤器的类总是派生自`ExperimentalData()`.

在我的内部，我`class ParFilter(ExperimentalData)`有`def particleFilter(self, N=1000)`运行过滤器并获得所需估计的方法。由于我需要在迭代期间访问数据，因此我在内部构建`class Iterator(object)`了要处理数据的位置。

我在将数据传递到 class 时遇到问题`Iterator()`。我尝试大多数情况下我认为应该工作但有`AttributeError: 'Iterator' object has no attribute 'myData'`. 最终我能够传递一些数据，但它与我期望的数据对象不同。

我的代码简化以说明示例：

```
import numpy as np
import pandas as pd

class ExperimentalData(object):
    def __init__(self):
        self.xTrueSource = 100
        self.yTrueSource = -7
        print 'source %s  %s' % (self.xTrueSource,self.yTrueSource)
        xSampPoints = np.arange(0,200)
        yTrueSignal = 100/(np.sqrt((self.xTrueSource - xSampPoints)**2 + (self.yTrueSource)**2))
        ySampPoints = yTrueSignal+np.random.randn(200)
        self.myData = pd.DataFrame({'x':xSampPoints,'ySamp':ySampPoints,'yTrue':yTrueSignal})
        #print self.myData
    def __str__(self, rows=2):           
        dfPrintStart = (self.myData[:rows]).to_string()
        dfPrintEnd =(self.myData[-rows:]).to_string()
        stringToPrint='\nPRINTNG INITIAL DATAFRAME FIRST %d ROWS and LAST %d ROWS \n %s\n...\n%s\n'\
                        % (rows, rows, dfPrintStart, dfPrintEnd)
        return stringToPrint

class ParFilter(ExperimentalData):

    def particleFilter(self, N=1000):
        '''function runs particle filter'''
        class Iterator(object):
            def __init__(self):
                '''initialise all values for iteration'''
                self.iteration = 0
                frameToWork = ParFilter().myData                
                print 'FROM CLASS Iterator.__init__ \n%s' % frameToWork
            def iterate(self):
                '''performing one step at the time'''
                self.iteration += 1
                print self.iteration
        myPartFilter = Iterator()
        for n in range(N):
            myPartFilter.iterate()
        return myPartFilter

if __name__ == '__main__':
    data = ParFilter()
    print data
    data.particleFilter(10) 
```

问题是，当我初始化我的类时，我有具有特定值的 dataFrame，但是当我执行以下步骤时：我`frameToWork = ParFilter().myData`不是采用相同的数据对象，而是生成具有不同数据的新对象。输出快照：

```
PRINTNG INITIAL DATAFRAME FIRST 2 ROWS and LAST 2 ROWS 
   x     ySamp     yTrue
0  0  0.510414  0.997559
1  1  1.522934  1.007585
...
       x     ySamp     yTrue
198  198  1.508216  1.017815
199  199  2.409181  1.007585

FROM CLASS Iterator.__init__ 
   x     ySamp     yTrue
0  0  0.727060  0.997559
1  1  0.631976  1.007585 
```

in 初始化的第一个值`ySamp`是 0.510414，它应该与 in 相同，`Iterator`而不是 0.727060。所以我创建了新对象。

我无法弄清楚如何将原始`myData`对象放入`Iterator`我尝试：

```
 class Iterator(ParFilter):
        def __init__(self):
            '''initialise all values for iteration'''
            self.iteration = 0
            frameToWork = self.myData 
```

与`AttributeError: 'Iterator' object has no attribute 'myData'`.

我尝试：`class Iterator(self.ParFilter)`有`AttributeError: 'ParFilter' object has no attribute 'ParFilter'`更多但没有结果。

（我必须使用 pandas DataFrame，因为我的基类非常大，并且得到的 dataFrame 不像示例中那样大）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T02:20:36.530

您的代码的问题是内部类正在尝试访问外部类的成员变量。这是不可能的，因为它们都使用`self`来引用它们当前的实例，并且内部类的`self`参数隐藏了外部类的`self`. 您需要为其中一个使用不同的名称。

虽然您实际上可以在其中一个方法中为第一个参数名称使用不同的名称，但我建议`self`在定义嵌套类之前简单地将附加名称绑定到外部对象：

```
class Outer(object):
    def __init__(self):
        self.foo = "foo"

    def do_stuff(self):
        outer_self = self # give an extra name to `self` that won't be shadowed

        class Inner(object):
            def __init__(self):
                 self.bar = "bar"

            def do_inner_stuff(self):
                print(outer_self.foo, self.bar) # access the outer class's data

        i = Inner()
        i.do_inner_stuff() 
```

这可行，但它仍然可能不是最好的设计。嵌套类是不可序列化的，调试起来很麻烦，如果可能的话应该避免。

一个更好的想法是取消嵌套类，只需将所需的数据从外部类传递到内部类的构造函数，其中可以将引用保存为成员变量：

```
class Outer(object):
    def __init__(self):
        self.foo = "foo"

    def do_stuff(self):
        i = Inner(self.foo) # pass relevant data to constructor
        i.do_inner_stuff()

class Inner(object):
    def __init__(self, foo):
        self.foo = foo # keep a reference to passed data
        self.bar = "bar"

    def do_inner_stuff(self):
        print(self.foo, self.bar)  # use the data 
```

# angularjs - 在AngularJS中动态应用0个或多个ng-repeat过滤器？

> ID：14491713
> 
> 赞同：1
> 
> 时间：2013-01-24T00:08:29.697
> 
> 标签：angularjs

假设我有以下观点：

```
<tr ng-repeat="user in users" >
    <td>{{$index + 1}}</td>
    <td>{{user.id}}</td>
    <td>{{user.pageViews}}</td>
    <td>{{user.urls}}</td>
</tr> 
```

我可以像这样静态应用多个过滤器：

```
<tr ng-repeat="user in users | filter:idFilter | filter:pageViewFilter | filter:urlsFilter"> 
```

如何动态地将 0 到 N 个过滤器应用于我的 ng-repeat？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T05:28:44.983

您可以通过 $filter 访问控制器中的过滤器。这是**演示：http:** [//jsfiddle.net/EGVwG/6/](http://jsfiddle.net/EGVwG/6/)

```
<ul ng-repeat="num in getData()" >
  <li>{{num.val}}</li>
</ul>

$scope.getData = function() {
  var finalData = $scope.arrVal;

  if($scope.bFilterEnabled)
    finalData = $filter('filter')(finalData, $scope.searchText);

  if($scope.bSortEnabled)
    finalData = $filter('orderBy')(finalData, 'val');

  return finalData;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:25:44.317

如何应用所有过滤器，但其中一些“什么都不做”（通过所有条件）。或者，您可以创建另一个自定义过滤器来链接结果。

# c# - 冻结 DataGrid 列时在水平滚动条的空白区域添加任何控件

> ID：14491715
> 
> 赞同：1
> 
> 时间：2013-01-24T00:08:35.490
> 
> 标签：c#, wpf

![在此处输入图像描述](../Images/097822e533efc77ab9d7f5067c67d62c.png)

你好，

我有一个`FrozenColumnCount = 3`总是`HorizontalScrollBar`可见的。现在，我需要在空白区域（滚动条左侧）添加控件——请参见图像中红色突出显示的区域。

我怎样才能在那里添加任何控件？如果可以通过 XAML (ControlTemplates) 实现这种类型的东西会很棒吗？我`WPF v4.0 datagrid`在我的应用程序中使用标准。

> 注意：样本可以从这里下载 - [http://blogs.msdn.com/b/vinsibal/archive/2008/10/31/wpf-datagrid-frozen-row-sample.aspx](http://blogs.msdn.com/b/vinsibal/archive/2008/10/31/wpf-datagrid-frozen-row-sample.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T14:01:55.120

我将从[DataGrid Styles and Templates](http://msdn.microsoft.com/en-us/library/cc278066%28VS.95%29.aspx)的文档开始。

注意看起来像这样的模板部分

```
 <Grid Grid.Column="1"
                Grid.Row="2">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="{Binding NonFrozenColumnsViewportHorizontalOffset, 
                  RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ScrollBar x:Name="PART_HorizontalScrollBar"
                       Grid.Column="1"
                       Orientation="Horizontal"
                       ViewportSize="{TemplateBinding ViewportWidth}"
                       Maximum="{TemplateBinding ScrollableWidth}"
                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                       Value="{Binding HorizontalOffset, Mode=OneWay, 
                RelativeSource={RelativeSource TemplatedParent}}"/>
          </Grid> 
```

此部分定义 DataGrid 中的底部滚动条区域。注意与 NonFrozenColumnsViewportHorizo​​ntalOffset 的绑定——该值决定了左侧空白区域的宽度。

您可以将整个 DataGrid 模板复制到项目中的应用程序资源中的样式中。然后，插入您自己命名的水平 StackPanel，其中 Grid.Column="0"（ScrollBar 的兄弟），然后您可以添加自己的子按钮、文本等作为新 StackPanel 的子项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:19:28.023

你有两种方法来解决它。

一个。安装 snoop，找出这个区域属于什么元素，看看它是否可以在模板中访问（我希望你知道如何在 Blend 中创建模板副本）。

湾。处理大小/移动事件并在此区域上方放置一个控件，只需将控件精确定位，就好像它们在网格模板中一样......

# javascript - IE7 :: SCRIPT1014：无效字符

> ID：14491717
> 
> 赞同：1
> 
> 时间：2013-01-24T00:09:06.337
> 
> 标签：javascript, html, internet-explorer-7

我有一个我最近更改的网页，它在除 IE7 之外的所有浏览器上都运行良好。在 IE7 上，我看到以下内容：

> SCRIPT1014：无效字符 blah.html，第 1 行字符 1

**截屏：**

![在此处输入图像描述](../Images/b0d60f7bba212e1e1f6b7413ca739e69.png)

我已经多次审查了代码，没有任何突出之处。我知道它是一个 javascript 错误，但我无法确定在哪里。

令人沮丧的部分是不知道在哪里看（第 1 行字符 1）并且错误很模糊。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:09:06.337

## 简而言之，错误

问题是调用`window.setTimeout`.

## 更多详情

in 中的字符串`window.setTimeout([string], [int])`作为 eval 执行，因此在执行期间导致了 javascript 错误，对我来说恰好是在 window onload 事件期间。

**为什么错误说“无效字符”？**

因为我使用 a`#`而不是 a`$`来启动 jquery 命令。javascript 编译器不知道该怎么做，`#`所以它抛出了一个错误。

**为什么错误报告在第 1 行字符 1 上？**

由于中的字符串`window.setTimeout`是作为 eval 执行的，所以在第 1 行字符 1 上报告了错误——这终于有意义了！

**用于复制问题的示例 html**

这是我创建的一个示例页面，用于演示该问题：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Test Page</title>
    <script src="http://code.jquery.com/jquery-1.9.0.min.js"></script>
</head>
<body>
    <h1>Test Page</h1>
    <script type="text/javascript">
        $(document).ready(function(){
            window.setTimeout("#('#sdfl');", 1000);
        });
    </script>
</body>
</html> 
```

## 解析度

我不小心在 eval 字符串中为 jquery 命令使用了 a`#`而不是 a 。`$`这实际上是遗留代码，所以我将它重构为调用特定函数而不是在字符串 ( **evil** ) 上调用 eval 所以它现在看起来更像：

```
window.setTimeout(function(){
      $('#sdfl');
   }, 1000); 
```

请注意，通过此更改，查找原始错误会容易得多，因为它会给出与页面相关的特定行和字符编号，而不是 eval 字符串。

# vba - 如何将分发列表项添加到分发列表？

> ID：14491720
> 
> 赞同：1
> 
> 时间：2013-01-24T00:09:17.223
> 
> 标签：vba, outlook, distribution-list

我正在尝试通过 Outlook 2010 VBA 添加多个子分发列表作为父分发列表的成员。

[Sue Mosher](http://www.pcreview.co.uk/forums/adding-distribution-list-distributionlist-distlistitem-t2141961.html)在网上发布的基本代码（其中 objItem 是子 DL，通过 For/Next 循环发现）是：

```
Set objRecipient = Application.Session.CreateRecipient(objItem.Subject)
objRecipient.Resolve
objDistributionList.AddMember objRecipient 
```

这是将子 DL 添加为“联系人”，而不是链接到原始子 DL 的成员。
当我打开应该是父 DL 中的子 DL 的成员时，它显示为带有“未知”电子邮件地址的电子邮件联系人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T18:11:34.677

您不能在 Outlook 对象模型中执行此操作。
您可以尝试使用[Redemption](http://www.dimastr.com/redemption/home.htm)，它公开[RDODistListItem](http://www.dimastr.com/redemption/RDODistListItem.htm) .AddContact 方法 - 它可以让您传递 ContactItem 以及 DistListItem 对象作为参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-04T01:14:11.937

事实证明，实际上**可以**在 VBA 中执行此操作，尽管它有点迂回，我无法理解它为什么起作用。

通过将子分发列表添加到邮件项目对象的“收件人”字段，它将邮件项目的收件人解析为分发列表。然后，您可以将这些收件人添加到父分发列表。请注意，这要求子列表仍然单独存在，即。如果子列表被删除，父列表将无法找到它

```
Sub NestedDistLists()
    Dim outApp As Object
    Dim outMail As Object
    Dim distRecipients As Object
    Dim distListChild As Object
    Dim distListParent As Object

    Set outApp = CreateObject("Outlook.Application")
    Set outMail = outApp.createItem(0)
    Set distListChild = outApp.createItem(7)
    Set distListParent = outApp.createItem(7)
    Set distRecipients = outMail.recipients

    distListChild.dlName = "Test Child"
    distRecipients.Add "john@example.com"
    distRecipients.resolveall
    distListChild.addmembers distRecipients
    distListChild.Save
    outMail.to = distListChild

    distListParent.dlName = "Test Parent"
    distListParent.addmembers distRecipients
    distListParent.Save

    distListParent.display
End Sub 
```

# git - 'git add --patch' 包含新文件？

> ID：14491727
> 
> 赞同：128
> 
> 时间：2013-01-24T00:09:49.087
> 
> 标签：git, shell, git-add

当我运行时`git add -p`，git有没有办法选择新制作的文件作为选择？

因此，如果我创建一个名为 的新文件`foo.java`，然后运行 ​​git add -p，git 不会让我选择要添加到索引中的文件内容。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2013-07-31T20:38:04.380

当我尝试`git add -p someNewFile.txt`一个新文件（一个未跟踪的文件）时，git 会简单地输出`No changes.`并停止。我不得不告诉 git 我打算先跟踪新文件。

```
git add -N someNewFile.txt
git add -p 
```

然而，由于该文件未被跟踪，它会显示为一个无法拆分的巨大块（因为它是全新的！）。所以，然后我需要将大块编辑成更小的位。如果您对此不熟悉，请查看[此参考](http://nuclearsquid.com/writings/git-add/)以开始使用。

**更新 - 大块编辑信息** *我想更新它以防上述参考消失。*因为新文件未跟踪，所以`git add -p`将文件中的每一行显示为一个大块中的新行。然后它会问你想用那个大块做什么，给你以下提示：

`Stage this hunk [y,n,q,a,d,/,e,?]?`

假设您不想提交整个大块（因此，整个文件；因为我不确定您为什么要`git add -p`在这种情况下使用？），您将需要指定选项`e`来告诉 git 您要编辑大块头。

一旦你告诉 git 你想编辑大块，它应该让你进入你选择的编辑器，这样你就可以进行更改。所有行都应以 a 为前缀，并且 git在文件末尾`+`有一些解释性注释（以 a 为前缀）。`#`只需在文件的初始提交中删除您不想要的任何行。然后保存并退出编辑器。

Git对git的hunk选项的解释：

```
y - stage this hunk
n - do not stage this hunk
q - quit; do not stage this hunk or any of the remaining ones
a - stage this hunk and all later hunks in the file
d - do not stage this hunk or any of the later hunks in the file
g - select a hunk to go to
/ - search for a hunk matching the given regex
j - leave this hunk undecided, see next undecided hunk
J - leave this hunk undecided, see next hunk
k - leave this hunk undecided, see previous undecided hunk
K - leave this hunk undecided, see previous hunk
s - split the current hunk into smaller hunks
e - manually edit the current hunk
? - print help 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2017-08-11T17:44:32.297

要包含每个新文件，您可以运行：

```
git add -N .
git add -p 
```

如果你想经常使用它，你可以在你的`~/.bashrc`:

```
alias gapan='git add --intent-to-add . && git add --patch' 
```

* * *

*注意*：如果你将它与一个空的新文件一起使用，git 将无法修补它并跳到下一个。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2020-08-26T21:18:47.667

[Catshoes](https://stackoverflow.com/users/1296968/catshoes)的回答包括：

> 当我尝试`git add -p someNewFile.txt`一个新文件（一个未跟踪的文件）时，git 会简单地输出 No changes。并停下来。
> 我不得不告诉 git 我打算先跟踪新文件。

```
git add -N someNewFile.txt
git add -p 
```

Git 2.29（2020 年第四季度）应该会很快改变这种情况。

最新版本的 " [`git diff-files`](https://github.com/git/git/blob/ca81676a105dbd387c28fbcc428e8959990678ec/Documentation/git-diff-files.txt)" ^(( [man](https://git-scm.com/docs/git-diff-files) ))显示了索引和工作树之间的差异，作为“新文件”补丁的“intent-to-add”路径；
" [`git apply --cached`](https://github.com/git/git/blob/ca81676a105dbd387c28fbcc428e8959990678ec/Documentation/git-apply.txt#L72)" ^(( [man](https://git-scm.com/docs/git-apply#Documentation/git-apply.txt---cached) ))应该能够采用 " `git diff-files`" 并且应该作为路径的 " `git add`" 等效项，但是对于这样的路径，该命令未能这样做。

请参阅[Raymond E. Pasco ( ) 的](https://github.com/juped)[提交 4c025c6](https://github.com/git/git/commit/4c025c667ee29dd5e9260f423e8b0b3cc37e5e8c)、[提交 e3cc41b](https://github.com/git/git/commit/e3cc41b4f939a64c74b6d4a2d59f6efe006c4e4b)（2020 年 8 月 8 日）和[提交 7cfde3f](https://github.com/git/git/commit/7cfde3fa0f175d6c184d7876576c236b367d97bb)（2020 年 8 月 6 日[）](https://github.com/juped)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([ca81676 提交中](https://github.com/git/git/commit/ca81676a105dbd387c28fbcc428e8959990678ec))^(，2020 年 8 月 17 日）)[`juped`](https://github.com/juped)
^([`gitster`](https://github.com/gitster))

> ## [`apply`](https://github.com/git/git/commit/7cfde3fa0f175d6c184d7876576c236b367d97bb)：允许 ita 条目上的“新文件”补丁
> 
> ^(帮助者：Junio C Hamano)
> ^(签字者：Raymond E. Pasco)

> `diff-files`最近更改为将对索引中标记为“intent to add”的路径的更改视为新文件差异，而不是来自空 blob 的差异。
> 
> 但是，`apply`拒绝在现有索引条目之上应用新的文件差异，除非是重命名。
> 这会导致使用 apply 的 " [`git add -p`](https://github.com/git/git/blob/7cfde3fa0f175d6c184d7876576c236b367d97bb/Documentation/git-add.txt#L89)" ^(( [man](https://git-scm.com/docs/git-add#Documentation/git-add.txt--p) ))在记录添加意图时尝试从文件暂存大块时失败。
> 
> `check_to_create()`这改变了以两种方式检查索引中是否已存在条目的逻辑：
> 
> *   首先，如果`ok_if_exists`为假，我们只搜索索引条目；
> *   其次，我们检查`CE_INTENT_TO_ADD`找到的任何索引条目上的标志，如果已设置，则允许应用程序继续进行。

* * *

和：

在 Git 2.29（2020 年第四季度）中，“ `add -p`”现在允许编辑仅在意图中添加的路径。

请参阅[Phillip Wood ( ) 的](https://github.com/phillipwood)[提交 75a009d](https://github.com/git/git/commit/75a009dc29d943554b39233286f02d34ead9a666)（2020 年 9 月 9 日[）](https://github.com/phillipwood)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 458205f](https://github.com/git/git/commit/458205ff0f43f8f0ffe70aa7f06d314fcce25809))^(中，2020 年 9 月 22 日）)[`phillipwood`](https://github.com/phillipwood)
^([`gitster`](https://github.com/gitster))

> ## [`add -p`](https://github.com/git/git/commit/75a009dc29d943554b39233286f02d34ead9a666)：修复意图添加路径的编辑
> 
> ^(签字人：Phillip Wood)
> ^(报道人：Thomas Sullivan)
> ^(报道人：Yuchen Ying)

> 部分暂存新文件的一种流行方法是运行^( ^([man](https://git-scm.com/docs/git-add#Documentation/git-add.txt--N)) ^)，然后使用 (man) 的大块编辑^来^([选择](https://git-scm.com/docs/git-add#Documentation/git-add.txt--p))^(用户)希望暂存的文件部分。[`git add -N <path>`](https://github.com/git/git/blob/75a009dc29d943554b39233286f02d34ead9a666/Documentation/git-add.txt#L147)[`git add -p`](https://github.com/git/git/blob/75a009dc29d943554b39233286f02d34ead9a666/Documentation/git-add.txt#L89)
> 
> 自[85953a3187](https://github.com/git/git/commit/85953a318734a9ad479626fbe53985da1475ec0b)（“diff-files --raw：显示意图添加文件的正确后图像”，2020-07-01，Git v2.28.0-rc0 --[批处理 #7](https://github.com/git/git/commit/4a0fcf9f760c9774be77f51e1e88a7499b53d2e2)中列出的[合并](https://github.com/git/git/commit/0ac0947b1470b2157fd4c085a1fd0b207d94b40b)）以来，这已停止工作因为意图添加路径现在显示为新文件，而不是对空 blob 的更改，并且^( ^([man](https://git-scm.com/docs/git-apply)) ^)拒绝为标记为意图添加的路径应用创建补丁。[7cfde3fa0f](https://github.com/git/git/commit/7cfde3fa0f175d6c184d7876576c236b367d97bb)（“应用：允许 ita 条目上的“新文件”补丁”，2020-08-06）修复了应用的问题，但仍然无法正确编辑添加的块。[`git apply`](https://github.com/git/git/blob/75a009dc29d943554b39233286f02d34ead9a666/Documentation/git-apply.txt)
> 
> [2c8bd8471a](https://github.com/git/git/commit/2c8bd8471a6abc68064dafc743362547fc730f77)（“ `checkout -p`：正确处理新文件”，2020-05-27，Git v2.28.0-rc0 -[批次 #2](https://github.com/git/git/commit/0313f36c6ebecb3bffe6f15cf25a4883100f0214)中列出的[合并](https://github.com/git/git/commit/2bdf00e66ae501c417fa33f887f2c60ef8719b2a)）之前已更改为处理新文件，但未正确实现补丁编辑。 perl 版本简单地禁止编辑，而 C 版本打开编辑器时会显示完整的差异，而不仅仅是 hunk，这意味着用户必须手动编辑 hunk 标头才能使其工作。`add -p`
> 
> 问题的根本原因是添加的文件将差异标头与大块数据一起存储，而不是像我们对其他更改所做的那样将两者分开。更改添加的文件以单独存储 diff 标头修复了编辑问题，但代价是必须进行特殊情况下的空添加，因为它们不再具有与它们关联的任何块，只有 diff 标头。
> 
> 这些更改将一些现有代码移动到有条件的更改缩进中，最好查看它们`--color-moved-ws=allow-indentation-change`（或`--ignore-space-change`很好地了解更改的概述）

* * *

Git 2.32（2021 年第二季度）增加了一些清晰度：

请参阅[Peter Oliver ( ) 的](https://github.com/mavit)[提交 7a14acd](https://github.com/git/git/commit/7a14acdbe6ff9934da6efd7d165dee4d205ec8fb)（2021 年 4 月 27 日[）](https://github.com/mavit)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 e60e9cc](https://github.com/git/git/commit/e60e9cc20ea4723b299425271be3a78946659251))^(中，2021 年 5 月 7 日）)[`mavit`](https://github.com/mavit)
^([`gitster`](https://github.com/gitster))

> ## [`doc`](https://github.com/git/git/commit/7a14acdbe6ff9934da6efd7d165dee4d205ec8fb): 指向补丁格式文档中的差异属性
> 
> ^(签字人：彼得·奥利弗)

> 从使用 diff 相关命令生成补丁文本的文档中，请参阅 diff 属性的文档。
> 
> 该属性影响生成补丁的方式，但之前在^( ^([man](https://git-scm.com/docs/git-diff)) ^)手册页中没有提到这一点。[`git-diff`](https://github.com/git/git/blob/7a14acdbe6ff9934da6efd7d165dee4d205ec8fb/Documentation/git-diff.txt)

`diff-generate-patch`现在在其[手册页](https://github.com/git/git/blob/7a14acdbe6ff9934da6efd7d165dee4d205ec8fb/Documentation/diff-generate-patch.txt#L77-L81)中包含：

> 5.  大块标题提到大块应用的函数的名称。[`gitattributes`](https://git-scm.com/docs/gitattributes)有关如何针对特定语言进行定制的详细信息，请参阅“定义自定义 hunk-header” 。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-08-23T14:07:49.940

`git add -p`实际上是关于向已跟踪的文件添加更改。

交互式选择要添加的文件的命令是`git add -i`. 例如：

```
$ git add -i

*** Commands ***
  1: status   2: update   3: revert   4: add untracked
  5: patch    6: diff     7: quit     8: help
What now> a
  1: another-new.java
  2: new.java
Add untracked>> 2
  1: another-new.java
* 2: new.java
Add untracked>> 
added one path

*** Commands ***
  1: status   2: update   3: revert   4: add untracked
  5: patch    6: diff     7: quit     8: help
What now> q
Bye.
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

        new file:   new.java

Untracked files:
  (use "git add <file>..." to include in what will be committed)

        another-new.java 
```

（真正的命令有我无法在这里剪切和粘贴的颜色，所以它比看起来更好）

实际上，patch 命令的作用与 相同，所以第二个是**第**一个的子集（尽管我承认我爱自己也恨自己！）。`git add -i``git add -p``add -p``add -i`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-09-16T20:52:48.623

还有一种非常相似的方法利用`--cached`标志......

1)**将您未暂存的更改转换为暂存，就像您添加的文件一样。**

```
git add edited-file.txt
git add new-file.txt
git add directory-of-changes/ 
```

2）查看差异（注意：您可以包括编辑和新文件）。

```
git diff --cached 
```

3)**创建补丁。**

```
git diff --cached > my_patch_file.patch 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2021-08-02T18:20:31.913

您可以在一行中使用`git add --intent-to-add -p .` The behavior is the same，但避免重复。

# arduino - 带条件的开关盒内的功能

> ID：14491728
> 
> 赞同：1
> 
> 时间：2013-01-24T00:09:51.250
> 
> 标签：arduino

如何在案例中添加条件。我想添加一个功能，如果结果小于 15 厘米，汽车停止，返回并左转或右转。

```
if (Serial.available())
  { val = Serial.read();
  switch(val)
{
 case 'a':
   servoX.write(lx);
    qian(); // forward
    break;
  case 'b':
    hou(); //back
    break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:01:39.123

@Barmar 是正确的，没有什么可以阻止您在 switch 语句中形成嵌套逻辑，因此可以在其中一个 case 块中添加 if 条件。

附带说明：如果这是您第一次在墙壁上跑步，避免开车，请注意当某些东西离传感器太近时您的信号会发生什么，与大多数传感器一样，您将开始获得读数，表明您正在远离传感器移动到比它的工作范围更近的地方。出于这个原因，您需要尝试并比仅仅设置一个限制更聪明，或者将您的限制设置为比传感器的最小工作范围高一点。在这方面，超声波传感器比便宜的红外距离传感器要好，但在加快速度时仍然需要小心。我还建议使用非常灵敏的超声波传感器，在对它们做出反应之前，您需要连续读取几个一致的读数。

# vba - 如何从 .XLL 获取程序集版本（当 DLL 转换为 XLL 时）

> ID：14491734
> 
> 赞同：0
> 
> 时间：2013-01-24T00:10:29.523
> 
> 标签：vba, excel-dna

我使用 ExcelDna 将 dll（VB.NET 项目的）转换为 xll。xll 中是否带有程序集版本？如果没有..我如何对 .xll 文件进行版本控制？一旦我这样做了，我必须在 VBA 代码中以编程方式获取程序集版本。非常感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T10:19:38.437

如果您只想要 .dll 的版本信息，您的代码可以执行类似的操作

```
Dim myAssemblyName As AssemblyName = _
    new AssemblyName(Assembly.GetExecutingAssembly().FullName)
Dim myVersion As Version = myAssemblyName.Version 
```

要从 VBA 访问它，您可以在您的加载项中创建一个隐藏的 UDF，您可以使用`Application.Run`.

.xll 有它自己的版本信息，不会从您嵌入的 .dll 中自动更新。您可以使用[“verpatch”版本资源工具](http://www.codeproject.com/Articles/37133/Simple-Version-Resource-Tool-for-Windows)来更新 .xll 的版本信息，正如[Excel-DNA Google Group 中所讨论的那样](https://groups.google.com/group/exceldna/browse_frm/thread/1aeb03c92d127f45)。

如果您想从 VBA 读取由“verpatch”更新的 .xll 版本，您需要从 VBA 调用 WIN32 版本 API，[知识库文章 139491](http://support.microsoft.com/kb/139491)对此进行了讨论。

# jquery - 如何在网页中呈现单个推文？

> ID：14491741
> 
> 赞同：2
> 
> 时间：2013-01-24T00:11:23.787
> 
> 标签：jquery, twitter

我正在尝试在网页中包含渲染的推文。我四处寻找，最终得到了这个解决方案：

```
<script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>

<script type='text/javascript'>
$(document).ready(function(){
    $.getJSON("https://api.twitter.com/1/statuses/oembed.jsonid=287348974577385474&align=center&callback=?",
        function(data{$('#tweet123').html(data.html);});
});
</script>

<div id="tweet123"></div> 
```

现在，这只是给我推文文本。我想要漂亮呈现的推文，就像我在这里看到的那样：[https ://dev.twitter.com/docs/embedded-tweets](https://dev.twitter.com/docs/embedded-tweets)

我想我应该提到我想要制作的页面上的其他地方有 jquery。我想如果我需要这样做以使渲染工作，我可以将其删除。但我宁愿不要。

**编辑：**页面看起来像这样，我对渲染不满意： ![没有按照我想要的方式呈现](../Images/934cf2d5783368685ef7f13ed4d95fcc.png)

**编辑：**我现在的代码，请耐心等待我对网络编程几乎一无所知：

```
<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<script language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
<script language="javascript" src="../supporting_data/seaofclouds-tweet-d433d14/tweet/jquery.tweet.js" type="text/javascript"></script>
<script type="text/javascript"src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA4aH3NUbCC-DiqD1hUcsy6EMPmqDgn-Yo&sensor=false"></script>

<script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>

<script type='text/javascript'>
jQuery(function(){
    $.getJSON("https://api.twitter.com/1/statuses/oembed.json?id=287348974577385474&align=center&callback=?,
        function(data{$('#tweet123').html(data.html);});
});
</script>

</head>

<body>

<p>
<div id='tweet123'></div>  
</p>

<!-- experiment with seaofclouds -->
        <script type='text/javascript'>
            jQuery(function($){
                $(".coffeeTweet").tweet({
                    username: "coffee_dad",
                    join_text: "auto",
                    avatar_size: 32,
                    count: 5,
                    loading_text: "downloading tweets..."
                });
            });
        </script>
<p>
<div class="coffeeTweet"></div>
</p>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T02:09:40.950

首先，您可以尝试更改`//platform.twitter.com/widgets.js`为`http://platform.twitter.com/widgets.js`

**编辑：**

以下工作在我的电脑上。

```
<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<script language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>

<script type='text/javascript'>
$(document).ready(function(){
    $.getJSON("https://api.twitter.com/1/statuses/oembed.json?id=287348974577385474&align=center&callback=?",
        function(data){$('#tweet123').html(data.html);});
});
</script>

</head>

<body>

<div id='tweet123'></div>  

</body>
</html> 
```

![HTML 输出](../Images/805266d0d46a5804fbaf19860d7992d0.png)

**编辑：** 我正在从我计算机上的本地 Web 服务器运行此网页。如果我只是使用`file:///`协议在浏览器中打开文件，我会得到与您相同的结果。

`file:///`我会尝试在 Web 服务器上运行该文件，因为出于安全原因，您的浏览器通常会在协议下限制某些操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:15:05.187

我假设您还需要包含关联的 css，这些 css 用于设置来自 twitter 的此标记的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T00:18:37.303

如果您想要完全呈现的推文，则必须使用此处找到的方法嵌入它：[https ://dev.twitter.com/docs/embedded-tweets](https://dev.twitter.com/docs/embedded-tweets)

# algorithm - FIFA 情景逻辑

> ID：14491746
> 
> 赞同：0
> 
> 时间：2013-01-24T00:11:49.967
> 
> 标签：algorithm, functional-programming, logic, game-engine, game-physics

我一直想知道 FIFA 的（游戏）逻辑。

他们是否依赖大量的 if 语句来表示游戏规则和其他规则的东西？

喜欢：

```
if( ball.x > areaLeft.x || ball.y > areaTop.y ) {
     out();
}

if( playersCollision > 100 ) {
    giveFoul(firstPlayer, secondPlayer);
} 
```

等等。对于这些事情，一切真的是“如果”还是有其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T10:52:14.443

这绝对不是“如果”。那将是一团糟。 [专家系统](http://en.wikipedia.org/wiki/Expert_system)是为处理此类情况而设计的，您希望在这些情况下维护一个受复杂规则约束的知识库。这个想法是，您使用基于逻辑的语言编写一组规则。例如

```
giveFoul(Context) :- 
    closePlayers(Context, A, B),
    attackingPlayer(context, A, B),
    defendingSkills(A, ASkill),
    ASkill < 80
    ...

closePlayers(Context, A, B) :-
    position(Context, A, CoordXA, CoordYA),
    position(Context, B, CoordXB, CoordYB),
    ... 
```

您可以看到，使用这种方法，您可以通过重新定义这些规则来改变系统的行为，并让您的推理系统完成其余的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T11:01:11.400

等式中总是有*如果。*问题是它不像建议的算法那么简单，主要是因为它不是由计算机决定的，而是由一个或多个人决定的...... [特别是。FIFA，因为他们不想根据视频实施仲裁]

无论如何它会更像

```
 // x in [0,99], the higher x is, the more probable the event is
 function fate(x) {
    return (random () % 100) <= x)
 }

 // if ball out, 75% chance there is an out event
 if( (ball.x > areaLeft.x || ball.y > areaTop.y) && fate(75) ) {
   out();
 }

 // if there is a collision, 50% chance the referee gives a foul 
 if( playersCollision > 100 && fate(50)) {
   giveFoul(firstPlayer,secondPlayer);
 }

etc.... 
```

# c - 分段错误错误

> ID：14491747
> 
> 赞同：-2
> 
> 时间：2013-01-24T00:11:52.563
> 
> 标签：c

我收到分段错误错误。谁能告诉我为什么？

```
 #include <stdio.h>
        #include <stdlib.h>

       char sumArrays(int * arr1[], int * arr2[], int length, int count){
       if(count == length){
           return ' ';
       }
       else{
          int sum = 0;
       sum =  *arr1[count] + *arr2[count];
       char ch = '            
       ch = ch + (char)sum;
       return ch + sumArrays(arr1, arr2, length, count+1);
    }
  }

int main(int argc, char * arr[]){
    int length = 6;
    printf("Enter the first row of 6 integers:");
    int * arr1 = malloc(length * sizeof(int));
    int * arr2 = malloc(length * sizeof(int));
    int counter = 0;
    int number = 0;
    while(counter < length){
       scanf("%d", &number);
       arr1[counter]=number;
       counter++;
    }
    counter = 0;
    printf("Enter the second row of 6 integers:");
    while(counter < length){
      scanf("%d", &number);
      arr2[counter] = number;
      counter++;
    }
    char sum = sumArrays(&arr1, &arr2, length, 1);
    free(arr1);
    free(arr2);
    printf("Their sums are : %c ", sum);
    return 0;
  } 
```

我是 C 新手，对这门语言了解不多。我能够用 Java 编写程序并让它工作。任何帮助表示赞赏！

谢谢！

编辑：分段错误已修复，但现在它不打印总和的实际字符....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:19:28.693

这是“&array 不创建指针数组”的另一种情况。

这是一个指针数组：

```
 int * arr1[] 
```

这会生成一个指向整数数组的指针；

```
&arr1     // That is, one pointer to your array of integers. 
```

因此，当您访问它以获取 count > 0 时，编译器会尝试读取您尚未给出的指针值。

```
*arr1[count] 
```

解决方法是在这里和那里删除星号以及在其他地方的 &：

消除`*`

```
 char sumArrays(int * arr1[], int * arr2[], int length, int count){
   sum =  *arr1[count] + *arr2[count]; 
```

消除 ＆：

char sum = sumArrays(&arr1, &arr2, 长度, 1);

我个人也会改变这一点：

```
int length = 6;
int * arr1 = malloc(length * sizeof(int));
int * arr2 = malloc(length * sizeof(int)); 
```

至：

```
const int length = 6;
int arr1[length];
int arr2[length]; 
```

并摆脱`free(arr1); free(arr2)`底部。在数组变得非常大之前无需分配数组，几百个整数就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:18:33.117

在这一行：

```
sum =  *arr1[count] + *arr2[count]; 
```

您以错误的顺序取消引用二级指针。正确的一个是：

```
sum =  (*arr1)[count] + (*arr2)[count]; 
```

但真正的答案是：您不需要获取`arr1`. 将 sumArrays 声明更改为：

```
char sumArrays(int arr1[], int arr2[], int length, int count) 
```

# unix - 使用 Raspberry Pi 移动大文件

> ID：14491752
> 
> 赞同：2
> 
> 时间：2013-01-24T00:12:11.197
> 
> 标签：unix, file-io, raspberry-pi

我正在尝试将文件从远程计算机 (OSX) 移动到连接到 Raspberry Pi (4GB) 的本地 USB 硬盘 (320GB)。

问题是 Raspberry Pi OS 在 4GB 卡上运行，当我尝试将文件从驱动器移动到另一个驱动器时，总是空间不足。

我已经尝试使用 rsync、sshfs 和 Python 脚本来分块移动文件，但显然没关系，它总是空间不足（可能是因为将其保存到缓存中？）

有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:17:07.333

您也许可以使用以[块](http://jwalanta.blogspot.com/2009/01/using-wget-and-dd-to-download-file.html)`curl`的形式传输文件 。

```
curl -o gpl_segment.txt -r 888-1297 http://www.gnu.org/licenses/gpl-2.0.txt 
```

# string - Scala 大文本文件

> ID：14491756
> 
> 赞同：2
> 
> 时间：2013-01-24T00:12:37.320
> 
> 标签：string, scala, nlp

我是 Scala 编程的新手。

我必须处理**NLP**任务。

我在处理**Scala中****的大型文本文件**时遇到问题。

 **我已将 100+ MB 文件的整个文本读入内存（读入字符串）并且必须对其进行处理（我相信处理大型文本文件是自然语言处理中的一项常见任务）。

**目标是计算给定字符串**（即整个文件）中唯一子字符串/单词的数量。

我想在*List*对象中使用“ *distinct* ”方法，但是使用“ *.split ”方法将***字符串转换为列表**会引发内存不足错误（“java.lang.OutOfMemoryError: Java heap space”错误）。

 ****我想知道我是否可以在不使用 Scala 中使用字符串或正则表达式方法的列表的情况下完成这项任务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T02:27:20.607

毫无疑问，可能必须增加默认的 JVM 堆大小。我非常怀疑使用 split 或任何其他基于 RE 的方法对于这么大的输入是否容易处理。同样，如果您将输入转换为 a`List[Char]`以利用精彩的集合库，您将看到内存需求过度增加；规模膨胀将至少是十进制数量级。

鉴于相对简单的分解（由空格或标点符号分隔的单词），我认为可能需要一个更平淡的解决方案。强制迭代字符串的字符（但不是通过隐式转换为任何类型的`Seq[Char]`）并找到单词，将它们转储到`mutable.Set[String]`. 一方面，这将消除重复。或许使用 a`Buffer[Char]`来累积每个单词的字符，然后再将它们变成`String`要添加到`Set[String]`.

这是一个削减：

```
package rrs.scribble

object  BigTextNLP {
  def btWords(bt: String): collection.mutable.Set[String] = {
    val btLength = bt.length
    val wordBuffer = collection.mutable.Buffer[Char]()
    val wordSet = collection.mutable.Set[String]()

    /* Assuming btLength > 0 */

    import bt.{charAt => chr}
    import java.lang.Character.{isLetter => l}

    var inWord = l(chr(0))

    (0 until btLength) foreach { i =>
      val c = chr(i)
      val lc = l(c)

      if (inWord)
        if (lc)
          wordBuffer += c
        else {
          wordSet += wordBuffer.mkString
          wordBuffer.clear
          inWord = false
        }
      else
        if (lc) {
          inWord = true
          wordBuffer += c
        }
    }

    wordSet
  }
} 
```

在 REPL 中：

```
scala> import rrs.scribble.BigTextNLP._
import rrs.scribble.BigTextNLP._

scala> btWords("this is a sentence, maybe!")
res0: scala.collection.mutable.Set[String] = Set(this, maybe, sentence, is, a) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T09:07:57.243

我假设您将文件作为`List[String]`内存，并且列表中的每个条目都是文件的一行。

```
val textStream = text.toStream
val wordStream = textStream.view.flatMap(s => s.split(" "))
val distinctWordStream = wordStream.foldLeft(Stream.empty[String])((stream, string) =>
  if (stream.contains(string)) stream else string #:: stream
) 
```

首先，您创建一个 Stream，因此您不必处理整个字符串。下一步是创建一个视图并对其进行映射，因此每个字符串中只有一个单词而不是一行。最后你逐字折叠结果。如果一个词被包含，它将被删除。除了折叠，您还可以使用这一行：

```
val wordSet = wordStream.toSet 
```

在这一点上，获取不同单词的数量应该是微不足道的。你只需要调用`length`或`size`为 Set。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T19:45:48.130

[看看这个](http://bcomposes.wordpress.com/2011/09/19/first-steps-in-scala-for-beginning-programmers-part-8/)讨论你的问题和不同方法的博客。******

# algorithm - 在依赖图上搜索不相交并集的算法

> ID：14491758
> 
> 赞同：2
> 
> 时间：2013-01-24T00:13:05.797
> 
> 标签：algorithm, disjoint-union, dependency-graph

首先，关于这个问题的一些背景：

我正在一个具有多种类型资源（A、B、C ...）的系统中工作。我有一些资源需求，我需要确定我是否能负担得起。

为此，我有一些资源，每个资源都可以提供不止一种类型的资源，但我需要为每种资源选择我要使用的资源。

例如，如果我需要支付 1A、2B 和 0C（表示为 (1,2,0)）并且我有这个来源：

1.  (1,1,0) //意味着我必须选择生产 A 或 B
2.  (0,1,1) //意味着我必须选择生产 B 或 C
3.  (1,1,0)

很明显，我必须将源 2 用于资源 B，我可以选择 1 和 3，其中一个产生 A 和 B

我实现这一点的方法是将其视为一个依赖关系图，其中上述情况表示如下：

![在此处输入图像描述](../Images/be7b6182440b068fef2c1afbea6a1d2c.png)

因此，我遍历资源，并且对于每个资源，我都会遍历到达它的链接。如果删除当前资源的当前节点意味着其他资源有足够的剩余到达链接来支付剩余的费用，我使用它。

对于前面的示例，我首先尝试将源 1 用于资源 A。B 仍然有 2 个链接，所以我可以做到。只剩下 B 类资源需要支付，所以我使用剩余资源支付 B。

好的，但现在我需要在一个新场景中工作，其中有两种类型的资源，每一种以成本 1 或成本 2 生产一种资源，我需要最小化总成本。

对示例的轻微更改可能是这样的： ![在此处输入图像描述](../Images/0e1a0aa7c61c6e769684cbb5c076b41d.png)

常识解决方案应该是使用1和2支付B，使用3支付A，总成本为1，但在我的实现中，如上所述，源1用于支付A，因为B还有2个链接到它，所以最后我必须使用成本为 2 的源 3。

如果可能，应避免暗示尝试所有选择组合的解决方案。

您是否知道可以应用于这种情况的任何具有已知解决方案的一般算法问题？或者如何改进我的实际解决方案以在这个新场景中工作？还是我应该采取另一种不同的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T15:53:30.883

这个问题简化为在流网络中找到[最大流。](http://en.wikipedia.org/wiki/Maximum_flow_problem)

这是想法：

1.  对于每种类型的资源（A，B，...），一个节点具有来自**源**节点的传入边（源节点与问题的源无关，它是网络流理论中使用的常用标签，通常标记为**s** ) 的容量等于给定资源的所需数量。例如，如果您需要*2B*，则容量为 2。

2.  对于每个*源*（我的意思是问题描述所定义的源），您创建一个节点，该节点具有到接收器的出边（通常标记为**t**），容量为 1。

3.  从步骤 1 中的每个节点开始，为步骤 2 中的每个节点添加一条传出边，这些节点可以提供所需类型的资源。

例如，您的情况的图表如下所示：

![流程图](../Images/c3632717ccdc27abec626c25ef4eafc1.png)

现在这个网络中的最大 ST 流将为您提供答案。*类型*节点（A、B、C）和*源*节点（src1、src2、src3）之间基本上饱和的边会告诉你哪个*源*应该提供哪种*类型*的资源。

可以使用任何经典算法找到最大流量，例如**增加路径** （*Ford-Fulkerson*、*Dinic's*等）或**推送重新标记**方法之一（*Goldberg-Tarjan*、*Relabel-to-Front*等）。

最大流量的这种特殊应用也可以被视为一种广义的[二分匹配](http://en.wikipedia.org/wiki/Matching_(graph_theory)#Maximum_matchings_in_bipartite_graphs)，您将每种类型的资源与可能的多个来源进行匹配，但每个来源只能处理一个资源。这个想法很容易扩展到源可以处理多种类型的情况（通过简单地将**src - T**边缘容量从 1 更改为所需的容量）。

# c# - 如何在不预先实现连接字符串的情况下动态绑定数据

> ID：14491765
> 
> 赞同：2
> 
> 时间：2013-01-24T00:14:11.573
> 
> 标签：c#, visual-studio-2008, connection-string

我有我的 sql 数据源，但我希望我的程序将其动态绑定到数据源。我希望`dataAdapter`通过项目文件夹（项目/应用程序的源文件夹）查看它来绑定到数据文件。我如何动态生成一个`ConnectionString`将自己定位并绑定到文件的`MyData.mdf`文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:06:01.587

您可以使用您的 C# 文件来实现他们建立连接字符串的代码。

```
public SqlConnection GetConnection()
{
string connectionString = ConfigurationManager.ConnectionStrings['"' + DatabaseName + '"' ].ConnectionString;
SqlConnection con = new SqlConnection (connectionString);
return con;
} 
```

在上面提到的语句中，您可以动态调用 Database 变量并运行 GetConnection() 方法来创建到该特定数据库的连接 在您的 web.config 中添加您的文件位置

```
<connectionStrings>
 <add name="DynamicconnectionString" connectionString="Data Source = //your path for the DB file // "/>
</connectionStrings> 
```

# batch-file - 列出具有某些字符的文件并输出文件名和其他字符

> ID：14491766
> 
> 赞同：1
> 
> 时间：2013-01-24T00:14:12.247
> 
> 标签：batch-file, dos

我正在尝试创建一个批处理脚本来生成一个 xml 文件。我正在努力的部分是列出目录中包含文本“@isTest”的文件（不带扩展名）的名称，并在名称前添加某些字符。因此，例如在带有文件的目录中

```
a.cls
b.cls 
```

我想获得这样的xml文件

```
<runTest>a</runTest>
<runTest>b</runTest> 
```

我已经设法列出了文件，但我不知道如何取名称、删除扩展名并添加额外的字符。

findstr /s /i /m "@isTest" *.cls >> file.xml

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T01:30:53.697

使用 FOR /F 迭代任何命令的结果 - 每次迭代一行。键入`HELP FOR`或`FOR /?`从命令提示符获取更多信息。

您正在使用递归 FINDSTR `/S`选项，因此您的输出也可能包含路径信息。

如果您真的只想要名称，没有路径或扩展名，那么以下将起作用：

```
for /f "eol=: delims=" %%F in (
  'findstr /s /i /m "@isTest" *.cls'
) do (echo ^<runTest^>%%~nF^</runTest^>) >>output.xml 
```

修饰符只保留值的`~n`名称，丢弃路径和扩展信息。请注意我是如何转义特殊字符的`<`，`>`因此它们不被视为重定向运算符。

如果您想保留路径和名称，并且只删除扩展名，那么只需使用`~dpn`：

```
for /f "eol=: delims=" %%F in (
  'findstr /s /i /m "@isTest" *.cls'
) do (echo ^<runTest^>%%~dpnF^</runTest^>) >>output.xml 
```

以上将 FINDSTR 提供的相对路径展开为完整路径。

如果您只想保留相对路径，则需要执行子字符串操作，而不是使用 FOR 变量修饰符。我在循环中打开和关闭延迟扩展，以保留`!`文件名中可能出现的任何内容。

```
for /f "eol=: delims=" %%F in (
  'findstr /s /i /m "@isTest" *.cls'
) do (
  set "file=%%F"
  setlocal enableDelayedExpansion
  (echo ^<runTest^>!file:~0,-4!^</runTest^>)
  endlocal
) >>output.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:29:12.087

```
set noext=%file:~0,-4%
echo %noext% >> output.xml 
```

# bash - iterm gnu bash 视觉损坏

> ID：14491772
> 
> 赞同：-2
> 
> 时间：2013-01-24T00:14:52.557
> 
> 标签：bash, gnu, ncurses, curses, iterm

当我将命令粘贴到 bash 并按 Enter 键时，下一行提示符包含之前发出的命令的一半。例如：

`host:/Users/user $ some really long command pasted in`

`-bash: some: command not found`

`host:/Users/user $ some really command pasFoo`

`-bash: Foo: command not found`

我在下一个提示符下输入了 Foo 并回车。你可以看到它只识别了 Foo 命令，所以前一个命令的视觉效果是“不是真的存在”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:25:16.313

您的提示是否包含颜色？如果是这样，[告诉 bash 什么是可打印的，什么是不可打印的](http://mywiki.wooledge.org/BashFAQ/053)，它应该正确地换行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:20:26.657

你用的是什么终端？如果在 Windows 上使用 Cygwin 或 MingW，我已经看到当 bash 环境变量`TERM`设置不正确时会发生这种情况。

基本上，无论您使用哪种终端，屏幕的显示界面（通过诸如curses或ncurses之类的东西）都无法正常工作，并且可能有改进方法：

有时，我可以通过做来改进`export TERM=vt100`（这甚至在 Linux 上的常规终端窗口中帮助了我。vt100 是一种非常古老且高度兼容的终端类型。

执行`echo $TERM`以查看当前 TERM 是什么。

# ios - 按下时的 UIButton 动画

> ID：14491776
> 
> 赞同：0
> 
> 时间：2013-01-24T00:15:09.013
> 
> 标签：ios, animation, uibutton

我们如何对 UIButton 进行动画处理，以达到按下按钮时会显示缓慢按下效果的效果，并且感觉就像您在按下柔软的垫子一样。将手指移开时也是如此。有没有办法通过编程或使用一些图像来做到这一点？

# c# - Windows Live SDK 不 LogOut()

> ID：14491783
> 
> 赞同：3
> 
> 时间：2013-01-24T00:15:50.893
> 
> 标签：c#, windows-8, windows-store-apps, windows-live-id

Microsoft Live ID 现在称为 Microsoft 帐户。话虽如此，假设我以身份登录 Windows 8`sam@email.com`并运行应用程序。

该应用程序使用 Live SDK 访问我的 Microsoft 帐户配置文件。但是，在它这样做之前，我必须给予它明确的许可并登录。到目前为止，完美。

尽管我授予了应用程序权限，`sam@email.com`但我想将其更改为，`janet@email.com`因此我单击了从 SDK`Logout`查询的应用程序按钮。`LiveAuthClient.CanLogout()`令人困惑的是，SDK 返回 false（我无法注销）。

**为什么不？**当前 Windows 8 用户使用 Windows Live SDK 登录到 Windows 8 应用程序后，他们如何注销（当 CanLogOut() 始终返回 false 时）？是否有设置或允许这样做的东西？

> 事实证明，这个问题的答案（http://stackoverflow.com/questions/13294496/can-the-windows-8-live-sdk-use-another-microsoft-account-other-than-the-current）是不准确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T10:12:14.780

这是预期的行为。请查看以下[链接](http://msdn.microsoft.com/pt-PT/library/windows/apps/xaml/hh968445.aspx#signout)。

如果用户使用 Microsoft 帐户或连接到 Microsoft 帐户的本地或域帐户登录 Windows 8，则提供自定义注销按钮无效。因此，让用户连接到具有不同 Microsoft 帐户的应用程序的唯一方法是，如果用户没有将他的 Microsoft 帐户与 Windows 8 相关联。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T10:52:22.097

检查你的范围。如果您使用`wl.signin`，则无法再通过代码注销，因为它是单点登录。请尝试`wl.basic`改用。更多关于范围[的信息](http://msdn.microsoft.com/en-us/library/live/hh243646.aspx)。当您意外使用时，`wl.signin`您必须登录仪表板并手动删除应用程序连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-19T15:32:36.937

确保您不在您的范围内使用“wl.signin”。如果您一直在测试您的应用程序，请进入您的真实帐户的帐户首选项，然后从应用程序的访问权限中删除此选项。现在，这将允许多个用户登录。

```
 private LiveAuthClient authClient;

private void PhoneApplicationPage_Loaded_1(object sender, RoutedEventArgs e)
{
    this.authClient = new LiveAuthClient("yourclientidhere");
}
then you can call this.authClient.Logout(); when you want to change users. 
```

# xsl-fo - xsl:fo 在一个块中使用不同的颜色/字体

> ID：14491789
> 
> 赞同：9
> 
> 时间：2013-01-24T00:16:44.300
> 
> 标签：xsl-fo

假设我有一个 xsl:fo 块：

```
<fo:block>one two three</fo:block> 
```

我可以让“三”与“一”和“二”的颜色不同吗？注意：我宁愿不为此使用表格。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-24T00:37:55.900

你可以给我们一个[`<fo:inline>`](http://www.w3.org/TR/2001/REC-xsl-20011015/xslspec.html#fo_inline)元素。

> fo:inline 格式化对象通常用于格式化带有背景的部分文本或将其包含在边框中。

例如，为了使“三”字变成红色：

```
<fo:block>one two <fo:inline color="#FF0000">three</fo:inline></fo:block> 
```

# jquery - spy 和 stub 有什么区别？

> ID：14491794
> 
> 赞同：8
> 
> 时间：2013-01-24T00:17:53.267
> 
> 标签：jquery, backbone.js, sinon

我刚刚开始使用`sinon.js`，我完全被这些术语难住了。我在`subview's`渲染方法中使用了存根。但是**间谍**的解释对我来说并不清楚。谁能解释这两者之间到底有什么区别？

还想知道如果我想测试一个新模型是否已添加到集合中，该方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-24T00:19:55.687

我不是很熟悉`sinon.js`，但由于这些是一般的 TDD 术语而不是特定于 sinon 的术语，我想我仍然可以回答你的问题。

主要区别在于存根的存在纯粹是为了“通过代码”。除了保存虚拟值和方法之外，存根本身不做任何事情。

另一方面，间谍是检查放入其中的值或调用它们的方法的存根。换句话说，两者之间的主要区别在于断言语句：存根没有，而间谍有一些（或者它们在测试代码的其他地方存储断言的值）。

换句话说：

```
var Stub = Backbone.Model.extend();
var stub = new Stub({value: 'test value'});
// This can be fed to any view for testing

var Spy = Backbone.Model.extend({
    initialize: function() {
        this.on('change:value', this.handleValueChange);
    },
    handleValueChange: function(value) {
        assert(!isNaN(value));
    };
    value: 'test value'
});
var spy = new Spy({value: 'test value'});
// This can be fed to any view for testing AND it ensures that,
// if that view sets its "value", that that value is a number 
```

哦，回答：

> > 还想知道如果我想测试一个新模型是否已添加到集合中，该方法是什么？

再说一次，不用专门介绍诗乃，有两个明显的地方可以“窥探”模型：模型本身和它的收藏。

您可以将事件处理程序添加到（或硬连线到测试方法上）您的模型，该模型检查`this.collection`以确定是否/哪个集合被添加到。相反，您可以绑定事件或覆盖集合本身的方法，然后检查`this.models`.

# sencha-touch - 将 sencha app 2.1 加载到 cordova 2.3

> ID：14491795
> 
> 赞同：0
> 
> 时间：2013-01-24T00:17:56.030
> 
> 标签：sencha-touch, sencha-touch-2, cordova, windows-phone-8

如何使用 windows visual studio 2012 将 sencha touch 应用程序加载到 cordova 2.3。

所以我有一个我准备好的测试煎茶应用程序，我可以使用我的网络服务器在本地查看它。

我还在 Visual Studio Express 2012 中为手机创建了一个 Cordova WP8 完整项目。该项目有一个 www 文件夹，其中包含所需的导入等。

当我运行科尔多瓦项目时，它会加载 app.initialize()

```
<body>
    <div class="app">
        <h1>Apache Cordova</h1>
        <div id="deviceready" class="blink">
            <p class="event listening">Connecting to Device</p>
            <p class="event received">Device is Ready</p>
        </div>
    </div>
    <script type="text/javascript" src="cordova-2.3.0.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
    </script>
</body> 
```

如果我复制资源和其他 sencha 文件夹，包括 sencha app.js 文件，我假设将 sencha 应用程序加载到 www 文件夹（cordova 项目内的 www 文件夹）。如何让 cordova 框架加载 sencha 应用程序。

这是加载 sencha 应用程序的 sencha index.html 中的行。我需要将哪些文件夹复制到 www 文件夹以及路径等方面，我不确定它们应该去哪里。

```
<script type="text/javascript" src="app.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T20:38:40.723

您将需要一个 Sencha Touch 2.2 sdk（现在有 alpha 版本）+ 根据发行说明，您需要将您的应用程序更新到 2.2。

[Sencha Touch 2.2.0 alpha](http://www.sencha.com/forum/announcement.php?f=91&a=36)

我建议等待一段时间，直到有可用的详细技术文章如何在 wp8 上运行 sencha+cordova。

# javascript - 如何在孤立字符的基础上进行拆分？

> ID：14491796
> 
> 赞同：2
> 
> 时间：2013-01-24T00:18:09.383
> 
> 标签：javascript, regex

```
'a|b||c|d'.split(re) 
```

我*想要*的结果是

```
[ 'a', 'b||c', 'd' ] 
```

也就是说，`b`和`c`保持在一起，因为有*两个*垂直条，而不是一个。

我试过：

```
 /(?:[^|])\|(?:[^|])/ 
```

也就是说，“匹配但不捕获分隔符前后的非垂直条”。不，根本不起作用。

（这是在 Javascript 中，但我认为很多 RE 库都会以相同的方式工作。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T00:26:45.543

您需要[环视](http://www.regular-expressions.info/lookaround.html)( `/(?<!\|)\|(?!=\|)/`)，但 JavaScript 不支持环视。不要拆分字符串，而是尝试匹配：

```
'a|b||c|d'.match(/([^|]|\|{2,})+/g) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:41:50.380

在您的情况下，由于管道字符`|`不是您可以使用的单词字符：

```
'a|b||c|d'.split(/\b\|(?!\|)/) 
```

解决 JS 缺乏后视的问题。

这将在第*一个* `|` 确保它后面不跟一个`|`.

但是，如果您的分隔项以符号结尾，例如“a.|b||c|d”——“a” ，它将**失败。**不会被拆分出来。

我认为您最好的选择是遵循@NullUserException 的建议并替换 '||' 使用占位符、拆分和替换，**或者**@Bergi 的匹配解决方案而不是拆分。

# html - 如何摆脱 div 的填充区域？

> ID：14491798
> 
> 赞同：0
> 
> 时间：2013-01-24T00:18:29.100
> 
> 标签：html, css

假设我有一个这样的 div 区域：

```
<html>
<head>
</head>

<body>
    <div id="logo_area" style="background-color:gray;height:40px;">
    <div id="logo" style="float:left;margin-left:auto;margin-right:auto;width:80%;height:50%;padding-left:50px;">
    <img border="0" src="images.jpg" width="30" height="30">
    </div>
    <div id="admin" style="padding:15px;">
    <a>LOG IN</a>|<a>SIGN UP</a>
    </div>
    </div>
</body>

</html> 
```

我想让 logo_area 成为页面的顶部（即灰色区域填充网页顶部）。但它总是在灰色背景周围有一些白色填充区域。

谁能告诉我如何摆脱白色区域？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:22:14.730

您需要重置`body`标签上的边距：

```
body {
  margin: 0;
} 
```

见[演示](http://jsfiddle.net/LDc5p/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:20:28.743

添加`margin:0;padding:0`到您的`id="logo_area"`风格。也添加`style="margin:0;padding:0"`到您的身体标签。

另请注意，与这些内联样式相比，使用单独的 CSS 文件通常是更好的做法。

# asp.net-mvc - MVC4 优化如何允许部分视图脚本？

> ID：14491801
> 
> 赞同：9
> 
> 时间：2013-01-24T00:18:38.307
> 
> 标签：asp.net-mvc, asp.net-mvc-4

部分视图和 MVC 的一个问题是，如果您的可重用部分视图需要某些 javascript，则无法包含它并将其加载到页面底部的脚本部分。除了性能问题之外，这意味着像 jquery 这样必要的东西还没有出现，您必须使用任何 jquery 相关代码的时髦延迟执行。

这个问题的解决方案是允许部分中的部分，这样部分可以注册它的脚本出现在布局的正确位置。

据说，MVC4 的优化/捆绑功能应该可以解决这个问题。但是，当我在部分中调用 @Scripts.Render 时，它会将它们包含在部分所在的任何位置。将脚本放在页面末尾不会有任何魔力。

在这里查看 Erik Porter 的评论： [http ://aspnet.uservoice.com/forums/41199-general-asp-net/suggestions/2351628-support-section-render-in-partialviews](http://aspnet.uservoice.com/forums/41199-general-asp-net/suggestions/2351628-support-section-render-in-partialviews)

我在其他一些地方看到有人说 MVC 4 解决了这个问题，但没有关于如何解决的例子。

如何在其他脚本之后在正文末尾包含部分所需的脚本，使用 MVC4 优化来解决问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T02:59:51.577

您可以做的一件事是创建一些 HtmlHelper 扩展方法，如下所示：

```
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Optimization;

public static class ScriptBundleManager
{
    private const string Key = "__ScriptBundleManager__";

    /// <summary>
    /// Call this method from your partials and register your script bundle.
    /// </summary>
    public static void Register(this HtmlHelper htmlHelper, string scriptBundleName)
    {
        //using a HashSet to avoid duplicate scripts.
        HashSet<string> set = htmlHelper.ViewContext.HttpContext.Items[Key] as HashSet<string>;
        if (set == null)
        {
            set = new HashSet<string>();
            htmlHelper.ViewContext.HttpContext.Items[Key] = set;
        }

        if (!set.Contains(scriptBundleName))
            set.Add(scriptBundleName);
    }

    /// <summary>
    /// In the bottom of your HTML document, most likely in the Layout file call this method.
    /// </summary>
    public static IHtmlString RenderScripts(this HtmlHelper htmlHelper)
    {
        HashSet<string> set = htmlHelper.ViewContext.HttpContext.Items[Key] as HashSet<string>;
        if (set != null)
            return Scripts.Render(set.ToArray());
        return MvcHtmlString.Empty;
    }
} 
```

从你的部分，你会像这样使用它：

```
@{Html.Register("~/bundles/script1.js");} 
```

在您的布局文件中：

```
 ...
   @Html.RenderScripts()
</body> 
```

由于您的部分在布局文件结束之前运行，所有脚本包都将被注册并且它们将被安全地呈现。

# java - 线程程序规范的含义

> ID：14491809
> 
> 赞同：0
> 
> 时间：2013-01-24T00:19:30.037
> 
> 标签：java, c++, multithreading, stream

我应该实现一个多线程应用程序，但我以前从未做过。我找到了一些很好的教程，并且开始了解多线程。但是，我被分配了一个线程应用程序的任务，我不知道他们要求什么：

> 通过以下方式实现多线程应用程序：5 个读取器线程从 5 个字符数据流中读取数据，将数据转换为大写，并将转换后的数据传递给 2 个写入器线程。

谁能向我解释他们的意思？我应该从 5 个文件中读取并写入两个文件吗？我真的只是不明白他们的术语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:23:22.387

是的，这听起来像是对作业的合理解释，对我来说很有意义（作为学术练习）。

打开 5 个文件，让 5 个线程读取这些文件，将数据发送到某个“同步”存储，然后让另外两个线程从该存储读取（同步），每个线程将数据写入其输出文件。

提示：考虑队列、并发、同步和线程。

# python - httplib.InvalidURL：非数字端口：

> ID：14491814
> 
> 赞同：12
> 
> 时间：2013-01-24T00:19:59.180
> 
> 标签：python, file

我正在尝试做一个脚本来检查是否存在许多网址：

```
import httplib

with open('urls.txt') as urls:
    for url in urls:
        connection = httplib.HTTPConnection(url)
        connection.request("GET")
        response = connection.getresponse()
        if response.status == 200:
            print '[{}]: '.format(url), "Up!" 
```

但我得到了这个错误：

```
Traceback (most recent call last):
  File "test.py", line 5, in <module>
    connection = httplib.HTTPConnection(url)
  File "/usr/lib/python2.7/httplib.py", line 693, in __init__
    self._set_hostport(host, port)
  File "/usr/lib/python2.7/httplib.py", line 721, in _set_hostport
    raise InvalidURL("nonnumeric port: '%s'" % host[i+1:])
httplib.InvalidURL: nonnumeric port: '//globo.com/galeria/amazonas/a.html 
```

怎么了？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-08-30T05:51:20.187

这可能是一个简单的解决方案，在这里

```
connection = httplib.HTTPConnection(url) 
```

您正在使用，`httpconnection`因此无需提供诸如[http://OSMQuote.com](http://osmquote.com)之类的网址，但您需要提供[OSMQuote.com](http://osmquote.com)。

简而言之，从您的 URL 中删除`http://`and `https://`，因为它`httplib`被视为`:`端口号，并且端口号必须是数字，

希望这可以帮助！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-24T00:27:18.233

`httplib.HttpConnection`在其构造函数中获取远程 URL的`host`and `port`，而不是整个 URL。

对于您的用例，它更易于使用`urllib2.urlopen`。

```
import urllib2

with open('urls.txt') as urls:
    for url in urls:
        try:
            r = urllib2.urlopen(url)
        except urllib2.URLError as e:
            r = e
        if r.code in (200, 401):
            print '[{}]: '.format(url), "Up!"
        elif r.code == 404:
            print '[{}]: '.format(url), "Not Found!" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-04T15:08:36.410

非数字端口：

解决方案 ：

> http.client.HTTPSConnection("api.cognitive.microsofttranslator.com")

从服务 URL 或端点中删除“ **https://** ”，它将起作用。

[https://appdotpy.wordpress.com/2020/07/04/errorsolved-nonnumeric-port/](https://appdotpy.wordpress.com/2020/07/04/errorsolved-nonnumeric-port/)

# facebook - 从 Facebook 通知中获取更多详细信息？

> ID：14491815
> 
> 赞同：1
> 
> 时间：2013-01-24T00:20:09.833
> 
> 标签：facebook, facebook-graph-api

我正在编写一个从用户 Facebook 通知中收集信息的应用程序。使用[Graph Explorer](https://developers.facebook.com/tools/explorer/)，我要求：

```
me/notifications?include_read=true 
```

这会返回一堆数据。每个项目都是您在登录 Facebook 时会看到的通知项目。例如（ID/名称略有变化）：

```
{
  "id": "notif_630262196_168132987", 
  "from": {
    "name": "John Bloggs", 
    "id": "822724665"
  }, 
  "to": {
    "name": "Dermot Bloggs", 
    "id": "680265196"
  }, 
  "created_time": "2013-01-23T22:58:28+0000", 
  "updated_time": "2013-01-23T22:58:28+0000", 
  "title": "John Bloggs commented on your link: \"Goodbye Great Barrier Reef. Goodbye...\"", 
  "link": "http://www.facebook.com/<removed>/posts/330788937030559?comment_id=1702155", 
  "application": {
    "name": "Links", 
    "id": "2309869772"
  }, 
  "unread": 0, 
  "object": null
} 
```

通知与评论有关，但如果“标题：”字段太长，则会被截断。

**有没有一种干净的方法可以直接以编程方式访问评论，所以我可以获得所有文本，即使它是 1000 个字符的评论？**

谢谢！:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:47:55.207

You should be able to get the comment by parsing the `link` field and querying:

```
/330788937030559_1702155 
```

or

```
/POSTID_COMMENTID 
```

When I tested this on my account, I am getting a `comments` object in the returned data, with the full text of the comments. I've got most permissions enabled in my Graph API. I suspect adding `read_stream` to the permissions is what will give you this data.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T21:56:47.987

你可以避免解析！我一直在对通知进行大量实验，并获得了我所谓的“源”对象（源对象是发出通知的 Facebook 图形对象）。不幸的是，我找不到任何关于这种机制究竟是如何工作的文档，但如果您的应用程序已被授予大量权限，那么`"object"`您发布的 JSON 中的字段`null`实际上将填充“源对象”。而不仅仅是`"object" : null`它看起来像这样：

```
"object": {
    "id": "587140489_588632201147717", 
    "from": {
      "name": "Dave Rodríguez", 
      "id": "587140489"
    }, 
    "message": ":D ", 
    "picture": "https://fbcdn-vthumb-a.akamaihd.net/hvthumb-ak-prn1/632550_478955408819349_478954732152750_60483_1892_t.jpg", 
    "link": "https://www.facebook.com/photo.php?v=478954732152750", 
    "source": "http://video.ak.fbcdn.net/hvideo-ak-prn1/v/754708_478955348819355_1792301950_n.mp4?oh=c7295ccfc3773f24de931e4c29f512ce&oe=513F1728&__gda__=1363127340_9302c108824176369427a0b17491b800", 
    "name": "¡¡¡EL SECRETO DE LA CHANCLA!!!!", 
    "description": "EL SECRETO DE LAS MADRES, EL MÁS UTILIZADO EN TODAS LAS GENERACIONES, VÉALO USTED MISMO Y ((COMPARTA))!", 
    "properties": [
      {
        "name": "Length", 
        "text": "1:13"
      }
    ], 
    "icon": "https://fbstatic-a.akamaihd.net/rsrc.php/v2/yD/r/aS8ecmYRys0.gif", 
    "actions": [
      {
        "name": "Comment", 
        "link": "https://www.facebook.com/587140489/posts/588632201147717"
      }, 
      {
        "name": "Like", 
        "link": "https://www.facebook.com/587140489/posts/588632201147717"
      }
    ], 
    "privacy": {
      "value": ""
    }, 
    "type": "video", 
    "status_type": "shared_story", 
    "object_id": "478954732152750", 
    "application": {
      "name": "Video", 
      "namespace": "video", 
      "id": "2392950137"
    }, 
    "created_time": "2013-03-10T20:45:20+0000", 
    "updated_time": "2013-03-10T20:45:20+0000", 
    "likes": {
      "data": [
        {
          "name": "Adrian Guerra Cuenta Verificada", 
          "id": "674364748"
        }
      ], 
      "count": 1
    }, 
    "comments": {
      "count": 0
    }
  } 
```

我希望比我更有知识的人能准确地告诉我们，我们需要什么权限才能看到这个字段被填充。我自己会弄清楚，但是权限太多，强制使用`SUM(nCk(77,k),k,1,77)=151115727451828646838271`可能的权限组合需要很长时间。

# php - 高亮当前页面菜单 li

> ID：14491817
> 
> 赞同：0
> 
> 时间：2013-01-24T00:20:11.343
> 
> 标签：php, css, wordpress

有没有办法让我根据页面 id 突出显示菜单 li？我似乎无法找到一种方法来做到这一点。

[http://www.dawaf.co.uk/cthm/work/](http://www.dawaf.co.uk/cthm/work/)

```
<div id="header">
    <h1>
        <a href="http://www.dawaf.co.uk/cthm/work">
            <img src="http://www.dawaf.co.uk/cthm/wp-content/uploads/2013/01/logo2.png" alt="CTHM Logo" id="logo" width="140" height="44" />    
        </a>
        <div id="contact-details">
            26 Queen Anne Road, London, E9 7AH<br />
            t + 44 7912325101<br />
            <a href="mailto:hello@cthm.co.uk">hello@cthm.co.uk</a>
        </div>
    </h1>
    <div id="nav">
        <span id="nav-li">
            <a href="http://www.dawaf.co.uk/cthm/work/" class="work-current">Work</a>
            <a href="http://www.dawaf.co.uk/cthm/studio/" class="studio-current">Studio</a>
            <a href="http://cthmplus.tumblr.com/" target="_blank">CTHM&#43;</a>
            <a href="https://twitter.com/hello_cthm" target="_blank">
                <img src="http://www.dawaf.co.uk/cthm/wp-content/uploads/2013/01/twitter.png" alt="Twitter" width="13" height="13">
            </a>
        </span>
    </div>
</div>

<div id="content"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:14:29.877

你有两个选择。一个是 Zak 提到的，您需要使用 jQuery 为您的网站一次仅将一个项目标记为“活动”。另一个选项是 CSS :active 选择器，它将自动将 CSS 应用到正在使用的链接（目前）。例如：

```
#nav li a:active {
  /* Insert styling here, such as, background-color: #01B */
} 
```

让我知道这是否有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:32:03.463

我建议向导航项添加一个活动类。像这样的东西：

```
<a href="http://www.dawaf.co.uk/cthm/work/" class="active">Work</a> 
```

然后是 CSS：

```
#nav a.active {
  /* your active style here */
} 
```

# c# - 在运行时创建文本框

> ID：14491819
> 
> 赞同：-2
> 
> 时间：2013-01-24T00:20:23.500
> 
> 标签：c#, .net, winforms, textbox, runtime

使用此代码，我可以在运行时创建文本框组件：

```
 List<TextBox> customTextBox = new List<TextBox>();

 foreach (string ValutaCustomScelta in Properties.Settings.Default.ValuteCustom)
     {
       TextBox textbox = new TextBox();
       textbox.Location = new System.Drawing.Point(295, 117 + customTextBox.Count * 26);       textbox.BackColor = Color.Black;
       textbox.ForeColor = Color.Lime;
       textbox.Parent = tabPage2;
       textbox.Name = "textbox_" + SelectValute;
       textbox.Size = new System.Drawing.Size(80, 21);

       customTextBox.Add(textbox);
       tabPage2.Controls.Add(textbox);
       tabPage2.Controls.SetChildIndex(textbox, 0);
      } 
```

此代码放置在表单 2 中，但我需要创建的文本框位于表单 1 中。我不知道在这段代码中添加它需要哪条指令。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:29:23.433

编辑：

您需要保留对`Form1`in的引用`Form2`。例如：

```
public partial class Form2 : Form {
    private Form1 _form1;

    public Form2(Form1 form) {
        _form1 = form;
    }
} 
```

然后你可以使用它`Form2`：

```
_form1.Controls.Add(textbox);
_form1.Controls.SetChildIndex(textbox, 0); 
```

您需要`Form2`像这样创建（来自`Form1`）：

```
Form2 form2 = new Form2(this); 
```

# css - 带有拆分器的 HTML、CSS 布局问题

> ID：14491823
> 
> 赞同：1
> 
> 时间：2013-01-24T00:20:28.813
> 
> 标签：css, layout, html

我在尝试向页面添加拆分器时遇到问题。不幸的是，添加拆分器的 jQuery 脚本弄乱了我的布局。

这是一个 jsfiddle 供您查看正在发生的事情。 [http://jsfiddle.net/dUTdN/1/](http://jsfiddle.net/dUTdN/1/)

有谁知道使用上面 jsfiddle 示例中来自[http://methvin.com/splitter/的 jQuery 拆分器脚本来确保拆分器与内容水平拉伸（进入可滚动区域）的方法？](http://methvin.com/splitter/)

如果需要更多信息，请询问。

**CSS：**

```
html,
body { 
  height: 100%; 
    margin:0;
    padding:0;
}
#wrap { 
  background-color: purple;
  min-height: 100%;
}
#header {
  background-color: yellow;
  height: 50px;
}
#pageheader {
  background-color: orange;
  height: 50px;
}
#mybody {
  background-color: red;
  overflow-y: auto;

  position: absolute;
  bottom: 50px;
  top: 100px;
  left: 0px;
  right: 0px;
}
#splitter {
  background-color: green;
  height: 100%;
  position: relative;
}
#sidebar {
  background-color: blue;
  width: 100%;
}
#content {
  background-color: white;
  width: 100%;
}
#footer {
  background-color: gray;
  position: absolute;
  bottom: 0;
  height: 50px;
  width: 100%;
}
.vsplitbar {
    width: 5px;
    background: #cab;
} 
```

**HTML：**

```
<div id="wrap">
  <div id="header">
    Site Header -> Welcome to my site
  </div>
  <div id="pageheader">
    Page Title -> You are currently viewing the main page
  </div>
  <div id="mybody">
    <div id="splitter">
        <div id="sidebar">
            My Sidebar<br />Menu Item 1<br />Menu Item 2<br />Menu Item 3<br />Menu Item 4<br />Menu Item 5
        </div>
        <div id="content">
            This is where all the content will go.<br /><br />
            Assuming your window is small enough, you should be able to scroll this section. If you do, you will see that the background colour changes to red and the splitter is no longer shown below that point. <br /><br />
            Is anyone able to figure out how to change this configuration so that I can have a section that stretches horizontally to fit the content with a splitter?<br /><br />
            asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />
            asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />
            asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />
            asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />asdfasdf<br />
        </div>
    </div>
  </div>
  <div id="footer">
    Website Footer -> Copyright and all that junk.
  </div>
</div> 
```

**脚本：**

```
$().ready(function() {
    $("#splitter").splitter();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-30T17:03:12.460

而不是放弃`overflow-y: auto;`in `#mybody`，它应该是 in `#content`。我已经更新了你的**[小提琴](http://jsfiddle.net/dUTdN/9/)**来演示。

# c++ - 渲染到纹理时的 DX11 Alpha 混合

> ID：14491824
> 
> 赞同：4
> 
> 时间：2013-01-24T00:20:35.343
> 
> 标签：c++, alphablending, directx-11, render-to-texture, rendertarget

**最终编辑：**

已解决...只需要深入了解 Alpha 混合的工作原理。我应该有：oBlendStateDesc.RenderTarget[a].DestBlendAlpha = D3D11_BLEND_ZERO; ...设置为 D3D11_BLEND_ONE 以保留 alpha。

当渲染到后台缓冲区时，一旦颜色混合正常，就不会注意到问题，这就是最终输出。当渲染到纹理时，同样的事情也适用，然后将纹理渲染到后台缓冲区，不正确的 alpha 在将纹理错误地混合到后台缓冲区中起作用。

然后我遇到了另一个问题，alpha 似乎正在下降。这是因为颜色混合了两次，例如...

```
Source.RBGA = 1.0f, 0.0f, 0.0f, 0.5f
Dest.RGBA   = 0.0f, 0.0f, 0.0f, 0.0f 
```

渲染成纹理...

```
Result.RGB = Source.RBG * Source.A +  Dest.RGB * (1 - Source.A) = 0.5f, 0.0f, 0.0f
Result.A   = Source.A * 1 + Dest.A * 1 = 0.5f 
```

现在...

```
Source.RBGA = 0.5f, 0.0f, 0.0f, 0.5f
Dest.RGBA   = 0.0f, 0.0f, 0.0f, 0.0f 
```

渲染到后台缓冲区...

```
Result.RGB = Source.RBG * Source.A +  Dest.RGB * (1 - Source.A) = 0.25f, 0.0f, 0.0f
Result.A = Source.A * 1 + Dest.A * 1 = 0.5f 
```

为了解决这个问题，在将纹理渲染到后台缓冲区时，我使用相同的混合状态，但将 SrcBlend 更改为 D3D11_BLEND_ONE，这样颜色就不会混合两次。

希望这可以帮助其他有类似问题的人....

**编辑结束**

为了提高性能，我试图渲染一串永远不会变成纹理的文本，以节省每次渲染每个单独的字符。

由于我严格使用 2D 渲染，因此我在启用 Alpha 混合的同时禁用了深度和模板测试。

问题是似乎没有发生任何 alpha 混合，最后绘制的任何内容都会用自己的数据覆盖当前像素......没有混合。

我使用一个我不会改变的混合状态。渲染到后台缓冲区时，混合工作正常。将最终纹理渲染到后台缓冲区时，混合也可以正常工作。只是当我渲染到混合似乎失败的纹理时。

以下是我设置单一混合状态的方法：

```
D3D11_BLEND_DESC oBlendStateDesc;

oBlendStateDesc.AlphaToCoverageEnable = 0;
oBlendStateDesc.IndependentBlendEnable = 0; //set to false, dont need loop below... but just incase

for (unsigned int a = 0; a < 8; ++a)
{
oBlendStateDesc.RenderTarget[a].BlendEnable = 1;
oBlendStateDesc.RenderTarget[a].SrcBlend = D3D11_BLEND_SRC_ALPHA;
oBlendStateDesc.RenderTarget[a].DestBlend = D3D11_BLEND_INV_SRC_ALPHA;
oBlendStateDesc.RenderTarget[a].BlendOp = D3D11_BLEND_OP_ADD;
oBlendStateDesc.RenderTarget[a].SrcBlendAlpha = D3D11_BLEND_ONE;
oBlendStateDesc.RenderTarget[a].DestBlendAlpha = D3D11_BLEND_ZERO;
oBlendStateDesc.RenderTarget[a].BlendOpAlpha = D3D11_BLEND_OP_ADD;
oBlendStateDesc.RenderTarget[a].RenderTargetWriteMask = D3D11_COLOR_WRITE_ENABLE_ALL;
}

// Create the blend state from the description
HResult = m_poDevice->CreateBlendState(&oBlendStateDesc, &m_poBlendState_Default);

m_poDeviceContext->OMSetBlendState(m_poBlendState_Default, nullptr, 0xffffff); 
```

在渲染到纹理时，我是否缺少任何额外的步骤来启用混合？

编辑：如果我将 AlphaToCoverageEnable 设置为 true，它会混合，但看起来很糟糕。这至少证实了它使用相同的混合状态......只是根据渲染到后缓冲区或纹理时的不同工作方式：/这是我的纹理描述......

```
m_oTexureDesc.Width = a_oDesc.m_uiWidth;
m_oTexureDesc.Height = a_oDesc.m_uiHeight;
m_oTexureDesc.MipLevels = 1;
m_oTexureDesc.ArraySize = 1;
m_oTexureDesc.Format = DXGI_FORMAT_R32G32B32A32_FLOAT;
m_oTexureDesc.SampleDesc.Count = 1; //No sampling
m_oTexureDesc.SampleDesc.Quality = 0;
m_oTexureDesc.Usage = D3D11_USAGE_DEFAULT; //GPU writes & reads
m_oTexureDesc.BindFlags = D3D11_BIND_RENDER_TARGET | D3D11_BIND_SHADER_RESOURCE;
m_oTexureDesc.CPUAccessFlags = 0;
m_oTexureDesc.MiscFlags = 0; 
```

编辑：这是一些可视化... ![文本](../Images/074deb35f9d22c85c73c7117d7af7454.png)

1.  渲染到后备缓冲区 - 启用 AlphaBlending。
2.  渲染到纹理 - 启用 AlphaBlending。
3.  渲染到后备缓冲区 - 禁用 AlphaBlending。
4.  取自字体文件的字母 T

*当禁用 AB 渲染时，字母完全匹配（比较 4 和 3）

*在启用 AB 的情况下渲染到后台缓冲区时，字母渲染略微（几乎不明显）褪色但仍然混合（比较 4 和 1）

*在启用 AB 的情况下渲染到纹理时，字母渲染得更加明显，而根本没有混合。（比较 4 和 2）

不知道为什么颜色会在启用 alpha 混合的情况下被洗掉......但也许它是一个线索？

编辑：如果我清除渲染目标纹理说...... 0.0f，0.0f，1.0f，1.0f（RGBA，蓝色）......这是结果： ![在此处输入图像描述](../Images/85850876af288b03df01eccf6322a6f6.png)

只有 alpha > 0.0f & < 1.0f 的像素与颜色混合。另一个线索，但我不知道如何解决这个问题......

# android - 实施类似于“不保留活动”的行为

> ID：14491825
> 
> 赞同：2
> 
> 时间：2013-01-24T00:20:56.960
> 
> 标签：android, android-intent, android-activity, activity-stack, activity-state

在我的应用程序中有一个场景，它可以无限地进行活动 a-> 活动 b-> 活动 a-> 活动 b...，最终它会得到 OOM。

有没有人知道一种使它像“不保留活动”行为的方法，例如活动将被杀死以释放内存但仍然在历史中，所以它可以在用户导航回来时重新创建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T19:49:02.690

这是不可能的。活动需要存在于堆栈中，Android 才能**返回**它们。您可以做的是跟踪活动自己管理的数据，以便当用户从 ActivityA 到 ActivityB 再到 ActivityA 时，您不断将数据包推送到两个活动都可用的堆栈上。然后你可以使用 `Intent.FLAG_ACTIVITY_REORDER_TO_FRONT' 从一个活动过渡到下一个活动。

在这种情况下，您将只有一个 ActivityA 实例和一个 ActivityB 实例，但它们应该能够在每次获得控制权时向用户呈现不同的视图，只需查看堆栈顶部的数据包即可。当用户按下**后退按钮**时，您应该从堆栈中弹出顶部数据包，然后为其启动适当的活动（使用 `Intent.FLAG_ACTIVITY_REORDER_TO_FRONT' 以确保您不会创建新实例）。

# android - Android Sim Change Detect，Log.e 中的错误

> ID：14491827
> 
> 赞同：0
> 
> 时间：2013-01-24T00:21:06.097
> 
> 标签：android, service, broadcastreceiver

参考 LogCat 时出现错误。我已经存储了存储的simcard（1st）并与currentsimcard（2nd）进行比较，如果sim序列不同，logcat将打印出sim changed。但是当我运行它时，我的服务出现了问题。下面是我的代码

**LogCat 显示**

```
Tag SimSerial::            8944110065486249080  
Tag Current Sim Serial::   8944110065486249080  
Tag Sim Status             Sim no changed !!!  

Tag SimSerial::            8944110065486249080   
Tag Current Sim Serial::   8944110065486249080   
Tag Sim Status             Sim changed !!! 
```

第一部分是正确的，但第二部分 Sim Status 也不应该是“Sim no changed”。有谁知道错误在哪里？

**引导完成接收器**

```
public class BootCompleteReceiver extends BroadcastReceiver {   

    Context context;
    SharedPreferences settings;
    public static final String PREFS_NAME = "MyPrefsFile";

     @Override  
    public void onReceive(Context context, Intent intent) {  

        Intent service = new Intent(context, MyService.class);  
        context.startService(service);   

    }  

} 
```

**我的服务**

```
public class MyService extends Service {  

    String storedSimSerial;
    String currentSimSerial;

    @Override  
    public void onCreate() {  
        super.onCreate();    
    }  

    @Override  
    public int onStartCommand(Intent intent, int flags, int startId) {  

        Toast.makeText(this, "Service Started", Toast.LENGTH_LONG).show();

        TelephonyManager telephoneMgr = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
        storedSimSerial = telephoneMgr.getSimSerialNumber();
        Log.e("SimSerial::",storedSimSerial);

        TelephonyManager tmMgr = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
        currentSimSerial = tmMgr.getSimSerialNumber();
        Log.e("Current Sim Serial::",currentSimSerial);

        if(currentSimSerial==storedSimSerial)
        {
            Log.e("Sim Status","Sim no changed !!!");
        }             
        else
            Log.e("Sim Status","Sim changed !!!");

        return Service.START_STICKY;  
    }  

    @Override
    public void onDestroy() {

        super.onDestroy();
        Toast.makeText(this, "Service Destroy", Toast.LENGTH_LONG).show();
    }

    @Override  
    public IBinder onBind(Intent arg0) {  
        return null;  
    }  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:22:32.047

像这样写你的`if`：

```
 if(currentSimSerial.equals(storedSimSerial))
    {
        Log.e("Sim Status","Sim no changed !!!");
    }             
    else
        Log.e("Sim Status","Sim changed !!!"); 
```

当您使用时，`==`您比较对象引用，而不是很少适用于字符串的内容。

# ios - 如何将设备添加到 Adhoc 分发配置文件

> ID：14491831
> 
> 赞同：0
> 
> 时间：2013-01-24T00:21:36.440
> 
> 标签：ios, testflight

我正在尝试通过试飞安装应用程序

当我单击 Test Flight 提供的 URL 时，我收到“此版本不适用于此设备”

我怀疑这是因为在我的 iOS 配置门户上 - 在分发配置文件下，我尝试安装的设备未列出

这个假设是否正确 - 如果正确，如何将设备添加到分发供应配置文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:26:16.640

您需要[将设备添加到您的开发者门户](http://developer.apple.com/library/ios/#recipes/ProvisioningPortal_Recipes/AddingaDeviceIDtoYourDevelopmentTeam/AddingaDeviceIDtoYourDevelopmentTeam.html)

然后您需要创建/修改配置文件，确保您的设备包含在列表中

[创建分发配置文件](http://developer.apple.com/library/ios/#recipes/ProvisioningPortal_Recipes/CreatingaDistributionProvisioningProfile/CreatingaDistributionProvisioningProfile.html#//apple_ref/doc/uid/TP40011211-CH3-SW1)

# html - 使用 jQuery hide() 的可点击 DIV

> ID：14491834
> 
> 赞同：0
> 
> 时间：2013-01-24T00:21:51.497
> 
> 标签：html, hide, jquery

我有一个可点击、可折叠的 div 脚本：

```
$(document).ready(function() {
    $(".toggle-content").hide();
    $(".byline").click(function() {
        $(".toggle-content").hide();
        $(this).next(".toggle-content").slideToggle(500);   
    });
}); 
```

一开始是这样的：

```
$(document).ready(function() {
    $(".toggle-content").hide();
    $(".byline").click(function() {
        $(this).next(".toggle-content").slideToggle(500);   
    });
}); 
```

第二个示例运行良好，但它使用户可以打开所有`div`s，这使得页面太高。我添加了该`hide()`功能，但现在它导致了另一个问题。

我想添加功能，当`div`再次单击每个功能时，它实际上会关闭它（隐藏它）。然后，`div`此时所有 s 都将关闭（隐藏）。目前，一个`div`始终处于打开状态（可见）。如果可能的话，我想要这两个功能......

我在其他地方使用手风琴（我知道这可以在这里使用），但我有点需要快速完成，所以我不想在这里实现更简单的脚本。如果我可以使用现有脚本找到修复程序，我会很兴奋。

**编辑**

我编辑了小提琴以显示改进的修复：

[http://jsfiddle.net/nicorellius/gsDVS/](http://jsfiddle.net/nicorellius/gsDVS/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:27:56.587

这应该有效。它将忽略隐藏与单击元素相关的内容，并将相应地滑动切换该 div

```
$(document).ready(function() {
    $(".toggle-content").hide();
    $(".byline").click(function() {
        var $next= $(this).next(".toggle-content");
        $(".toggle-content").not($next).hide();
        $next.slideToggle(500);   
    });
}); 
```

# c++ - 列表时内容会发生什么 被分配到另一个列表 多变的？

> ID：14491843
> 
> 赞同：2
> 
> 时间：2013-01-24T00:22:38.427
> 
> 标签：c++

我有一个`list<Myobj>`包含一些`Myobj`实例的源，如果我将它分配给一个空`list<MyObj>`目标，那么在内容方面究竟会发生什么？

`Myobj`实例是否通过浅拷贝在目标中重复？复制构造函数被调用了吗？或者它们根本没有重复？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-24T00:23:47.460

第一个列表中的所有对象都复制到第二个列表中。这里最好不要考虑“浅”和“深”的复制。元素被复制，复制的“深度”取决于类的复制构造函数或赋值运算符的作用。如果您的类型 T 是普通指针，则指针将被复制，但不会复制它们指向的内容。没有特殊的魔法发生。

请注意，有些细微之处取决于作业的来源或 RHS 是什么（感谢@mooingduck 提醒我这一点）。在 C++11 中，存在可以将 RHS 的内容*移动*到 LHS 的情况，在这种情况下根本没有复制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-24T00:30:15.540

赋值之后，左侧在语义上等同于赋值之前的右侧，只要类型`Myobj`足够健全（例如，如果它是类类型，它的复制构造函数和赋值运算符也满足这一点）。

# csv - 更改文件中的分隔符

> ID：14491846
> 
> 赞同：1
> 
> 时间：2013-01-24T00:22:49.577
> 
> 标签：csv, sed, awk

下面我有他们应该做的文件，再往下是我到目前为止所做的。我认为在我的代码中是问题的根源：分隔符，但我不能让它变得更好。

我的源文件带有`;`分隔符，我的数据库文件带有分隔`,`符；此外，字符串在“”之间：

类别文件应该是这样的：

```
"1","1","testcategory","testdescription" 
```

制造商文件，如下所示：

```
"24","ASUS",NULL,NULL,NULL
"23","ASROCK",NULL,NULL,NULL
"22","ARNOVA",NULL,NULL,NULL 
```

我此刻所拥有的：

```
- category file:
1;2;Alarmen en beveiligingen;
2;2;Apparatuur en toebehoren;
3;2;AUDIO;

- manufacturers file:
315;XTREAMER;NULL;NULL;NULL
316;XTREMEMAC;NULL;NULL;NULL
317;Y-CAM;NULL;NULL;NULL
318;ZALMAN;NULL;NULL;NULL 
```

我尝试了一下使用`sed`；首先，在类别文件上：

```
cut -d ";" -f1 /home/arno/pixtmp/pixtmp.csv |sort | uniq >        /home/arno/pixtmp/categories_description-in.csv
sed 's/^/;2;/g' /home/arno/pixtmp/categories_description-in.csv > /home/arno/pixtmp/categories_description-in.tmp
sed -e "s/$/;/" /home/arno/pixtmp/categories_description-in.tmp > /home/arno/pixtmp/categories_description-in.tmp2
awk 'BEGIN{n=1}{printf("%s%s\n",n++,$0)}' /home/arno/pixtmp/categories_description-in.tmp2 > /home/arno/pixtmp/categories_description$ 
```

然后在制造商文件上：

```
cut -d ";" -f5 /home/arno/pixtmp/pixtmp.csv |sort | uniq > /home/arno/pixtmp/manufacturers-in
sed 's/^/;/g' /home/arno/pixtmp/manufacturers-in > /home/arno/pixtmp/manufacturers-tmp
sed -e "s/$/;NULL;NULL;NULL/" /home/arno/pixtmp/manufacturers-tmp > /home/arno/pixtmp/manufacturers-tmp2
awk 'BEGIN{n=1}{printf("%s%s\n",n++,$0)}' /home/arno/pixtmp/manufacturers-tmp2 > /home/arno/pixtmp/manufacturers.ok 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:43:28.443

您试图通过使用 cut、sed 和 AWK 来解决问题。AWK 本身就足以解决您的问题。

我编写了一个可以处理您的两个示例的 AWK 程序。如果 NULL 不是特殊情况，并且制造商的文件是不同的格式，您将需要制作两个 AWK 程序，但我认为应该清楚如何去做。

我们在这里所做的只是告诉 AWK “字段分隔符”是分号。然后 AWK 将输入行拆分为我们的字段。我们遍历字段，边走边打印。

```
#!/usr/bin/awk -f

BEGIN {
    FS = ";"

    DQUOTE = "\""
}

function add_quotes(s) {
    if (s == "NULL")
        return s
    else
        return DQUOTE s DQUOTE
}

NF > 0 {
    # if input ended with a semicolon, last field will be empty
    if ($NF == "")
        NF -= 1  # subtract one from NF to forget the last field

    if (NF > 0)
    {
        for (i = 1; i <= NF - 1; ++i)
            printf("%s,", add_quotes($i))
        printf("%s\n", add_quotes($i))
    }
} 
```

# jquery - 在 mouseenter/mouseleave 上显示/隐藏子元素（“.class”）

> ID：14491848
> 
> 赞同：1
> 
> 时间：2013-01-24T00:23:07.143
> 
> 标签：jquery, html, hide, toggle, show

我实际上是在尝试使用 jquery (1.8.3) 悬停时在另一个 div 中显示/隐藏一个 div，并带有 jquery ui (1.9.2) “puff”效果。这是我的 HTML：

```
<li id="category_1">
  <div class="item_menu">
     <img src="image.jpg"/>
     <div class="titre" style="display:none;">menu title</div>
  </div></li>
<li id="category_2">
  <div class="item_menu">
     <img src="image.jpg"/>
     <div class="titre" style="display:none;">menu title</div>
  </div></li>
  ... 
```

这是我的js：

```
$(".item_menu").mouseenter(function(){
   $(this).children(".titre").show("puff");
}).mouseleave(function(){
   $(this).children(".titre").hide("puff");
}); 
```

问题是当鼠标在动画结束之前出现时，.titre div 不会隐藏。

我尝试了许多方法来使用 stop() 处理它，使用 toggle() 进行动画处理或使用 hover() 而不是 mouseenter/mouseleve 和许多其他方法，并且它总是呈现相同的。我试过一次：

```
$(".item_menu").mouseenter(function(){
   $(".titre").show("puff");
}).mouseleave(function(){
   $(".titre").hide("puff");
}); 
```

令我惊讶的是，它就像一个魅力，但是......因为它是它的类所指向的菜单项，当然它显示/隐藏每个项目而不是悬停的项目......所以，我认为这是 $(this).children 的问题...如果我不使用 jquery ui“puff”效果（与任何其他 jquery ui 效果一样），它也可以工作...但我被要求使用这个具体的效果。所以我认为我的问题来自 $(this).children 的组合和 jquery ui 效果的使用。

由于此菜单是动态生成的，因此我无法真正使用 id 指向项目并轻松检索它们...

小提琴：http: [//jsfiddle.net/EECW8/6/](http://jsfiddle.net/EECW8/6/)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-24T00:35:47.657

尝试使用 .hover ：悬停文档[http://api.jquery.com/hover](http://api.jquery.com/hover)

像这样的东西：

```
$("#divToBeHoveredOn").hover(
           function()
           { 
                 // content to show
           },
           function() 
           { 
         //content to hide }
        ); 
```

# iframe - 隐藏引荐来源 iFrame

> ID：14491849
> 
> 赞同：0
> 
> 时间：2013-01-24T00:23:13.450
> 
> 标签：iframe

我的网站是 www.A.com。在我的网站中，我有一个 iframe，其 src 是 www.B.com，但我并不拥有。

我不想让 B.com 知道我正在通过 iframe 将他们的网站插入我的网站。

有没有办法做到这一点？

# jquery - 无限滚动 (jQuery)

> ID：14491853
> 
> 赞同：1
> 
> 时间：2013-01-24T00:23:54.210
> 
> 标签：jquery, html, css, scroll

我正在实现无限滚动。一切正常，但是当我尝试向后滚动时，浮动条会跳到身体的顶部。我知道这是因为工作部分没有相对位置，但如果我添加它，则会出现另一个问题 - 浮动条跳到工作部分的底部（因为顶部偏移量是从工作部分顶部计算的，而不是主体)

**示例：http:** [//jsfiddle.net/XC6Tz/3/](http://jsfiddle.net/XC6Tz/3/)

**HTML：**

```
<div id="wrapper">
    <section id="about">
         <h2>About Me</h2>

</div>
<section id="work">
    <!-- <div id="bar-wrap"> -->
    <div id="floating-bar">
         <h2>Floating bar</h2>

        <p id="echo1"></p>
    </div>
    <!-- </div> -->
    <div id="work-prieview">
         <h2>Work preview</h2>

    </div>
    <div id="works">
         <h2>Works</h2>

        <p id="echo2"></p>
    </div>
    </div>
    <section id="contact">
         <h2>Contact Me</h2>

        </div>
        </div> 
```

**CSS**

```
 /* GLOBAL */

    /* -------------------------------------------------------------- */
     html, body, div, span, img, ul, li, h1, h2, h3, h4, h5, h6, p, a, hr, form, label, input, textarea, button, header, footer, nav, section {
        margin: 0;
        padding: 0;
        border: 0;
        font-size: 100%;
        font: inherit;
        vertical-align: baseline;
    }
    header, footer, nav, section {
        display: block;
    }
    h1, h2, h3, h4, h5, h6 {
        font-weight: normal;
    }
    body {
        font: 14px"Helvetica Neue", Helvetica, Arial, Sans-Serif;
        color: #FFFFFF;
    }
    section h2 {
        font-size: 54px;
        padding: 50px 0 0 50px;
    }
    section p {
        font-size: 30px;
        margin: 0 0 50px 50px;
    }
    /* CONTENT */

    /* -------------------------------------------------------------- */
     #about {
        height: 800px;
        background-color: #0054a6;
    }
    #work {
    }
    #bar-wrap {
        position: absolute;
        width: 100%;
    }
    #floating-bar {
        position: absolute;
        width: 100%;
        height: 180px;
        background: #00a651;
    }
    #work-prieview {
        padding-top: 180px;
        height: 1600px;
        background-color: #ed1c24;
    }
    #works {
        height: 800px;
        background: #0054a6;
    }
    #contact {
        height: 1600px;
        background: #ed1c24;
    } 
```

**Javascript**

```
 $(document).ready(function () {

       var top = $('#floating-bar').offset().top;
       var bottom = $('#works').offset().top - 180;

       $(window).scroll(function () {

           y = $(window).scrollTop();

           $('#echo1').text(y);

           if (y > top) {
               $('#floating-bar').css({
                   position: 'fixed',
                   top: 0
               });

               if (y > bottom) {
                   $('#floating-bar').css({
                       position: 'absolute',
                       top: $('#works').offset().top - 180
                   });
               }

           } else {
               $('#floating-bar').css({
                   position: 'absolute',
                   // top: 0
               });
           }

       });

       $('#echo2').text(bottom);

   }); 
```

# php - 如何在 php 中使用这些数组

> ID：14491855
> 
> 赞同：0
> 
> 时间：2013-01-24T00:23:58.310
> 
> 标签：php

有人可以解释这些代码中发生了什么吗？我不明白 cols 和 rows 是如何被使用的。谢谢

```
$chartdata['cols'][] = array('label'=>'Days Range','type'=>'string');

$chartdata['rows'][] = array('c'=>array(array('v'=>$month),array('v'=>$prevyearbal))); 
```

这些关联数组如何保存在二维数组中？是`$chardata['cols'][]`从第*0*行到第*n*行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:26:21.500

正如[文档](http://php.net/array#language.types.array.syntax.modifying)中所解释的，分配到与函数调用`[]`基本相同，`array_push`但没有函数调用。

# xcode - Xcode-无法创建新项目

> ID：14491857
> 
> 赞同：1
> 
> 时间：2013-01-24T00:24:08.670
> 
> 标签：xcode, project

我最近换了电脑（从 iMac 换到新的 Mac Mini），我刚刚完成了钥匙串信息、开发人员资料等的传输。我转到文件 > 新建 > 项目，输入了一个简短的名称，并注意到“下一步按钮”不起作用（它看起来完全是灰色的，就好像它没有启用一样）。我仔细检查了我的所有信息都输入了，但仍然没有。

我觉得答案很明显，所以感谢您的帮助！

更新：这里是截图的链接： http: [//s1337.beta.photobucket.com/user/znichols1131/media/ScreenShot2013-01-23at72110PM_zps0af03a90.png.html](http://s1337.beta.photobucket.com/user/znichols1131/media/ScreenShot2013-01-23at72110PM_zps0af03a90.png.html)

解决方案：我回到我的旧电脑上，尝试创建一个新项目，它成功了。因此，我仔细查看了旧计算机上的“新建项目”屏幕，并将信息复制到了新计算机上。看起来我要么忘记了公司标识符（如屏幕截图中所示），要么输入了一个奇怪的标识符。感谢您的所有帮助，很抱歉浪费您的时间！

# database - 数据库：一个属性与多个实体实例之间的关系

> ID：14491858
> 
> 赞同：0
> 
> 时间：2013-01-24T00:24:12.383
> 
> 标签：database, relation

有这样的事吗？我没有实现任何东西，我只是从中创建一个 ER 图。这是一个简单的例子：

```
ENT(Ent_ID, Group_IDs)
GROUP(Group_ID, Att) 
```

该属性`Group_ID`将与 的不同实例具有一对多关系`GROUP`。（这里的实例这个词正确吗？）

Ps：我知道如果我正在实现它，我可以创建一个以 Ent_ID 和 Group_ID 作为属性的第三个实体来建立关系，但我不知道这是否必须在图中指定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:32:51.890

我理解你的例子的方式，你有一个*一对多的*关系：

每个`GROUP`实例可以有许多`ENT`相关的实例，但每个`ENT`实例都与一个*且仅一个* `GROUP`实例相关。

# css - 位置：固定是否为 z 索引创建新的堆叠上下文？

> ID：14491859
> 
> 赞同：0
> 
> 时间：2013-01-24T00:24:13.370
> 
> 标签：css, z-index

[z-index 规范](http://www.w3.org/TR/CSS2/visuren.html#z-index)没有特别提到`position: fixed`，但是这个[小提琴](http://jsfiddle.net/7zNPm/3/)在 Chrome 24 上对元素进行了不同的排序。设置是否为子元素`position: fixed`创建了一个新的[堆叠上下文？](https://developer.mozilla.org/en-US/docs/CSS/Understanding_z-index/The_stacking_context)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:24:13.370

根据[这篇文章](http://updates.html5rocks.com/2012/09/Stacking-Changes-Coming-to-position-fixed-elements)，Chrome 22+ 模仿移动 WebKit 的行为并为固定位置元素创建新的堆叠上下文。

Firefox 至少 17 遵循规范并且不会创建新的上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-09T10:48:25.300

这是一个示例，其中我有两个固定元素，每个元素都有自己的堆叠上下文。我将第二个元素从固定位置切换到相对位置。当第二个元素更改为固定而不指定其 z-index 时，其子元素是一个新的本地堆叠上下文，其父元素的全局 z-index 为 0。因此，更改子元素的 z-index 没有效果，它仍然是被隐藏，尽管它的 z-index 比其他固定元素高。

```
let fixed = false;
function handleClick() {
  const elem = document.getElementById('toggle');
  const buttonElem = document.querySelector('button');
  if (!fixed) {
    elem.className = 'content--fixed';
    fixed = true
    buttonElem.innerText = 'Remove Fixed';
  } else {
    elem.className = 'content';
    fixed = false;
    buttonElem.innerText = 'Add Fixed';
  }
}
```

```
body {
  margin: 0;
  padding: 0;
}

.sidebar {
  position: fixed;
  width: 30%;
  background-color: #ccc;
  min-height: 100vh;
  z-index: 500;
}

.content--fixed {
  left: 30%;
  width: 50vw;
  position: fixed;
}

.content {
  padding-left: 30%;
  position: relative;
}

.hover {
  position: absolute;
  background-color: red;
  color: white;
  width: 400px;
  height: 10vh;
  left: -200px;
  z-index: 600;
}

.content .hover {
  left: 100px;
}
```

```
<div class="sidebar">
  Sidebar
</div>
<div id="toggle" class="content">
    <button onclick="handleClick()">Add Fixed</button>
  <div class="hover">
    Hover
  </div>
</div>
```

# objective-c - 表视图上的 UIPopoverController

> ID：14491864
> 
> 赞同：0
> 
> 时间：2013-01-24T00:24:54.800
> 
> 标签：objective-c, uitableview, uipopovercontroller

我在我的工具栏项目上使用了 UIPopoverController .. 当用户单击按钮时，它会在表格视图中显示项目列表.. 请在下面截图..

![在此处输入图像描述](../Images/fc0086f375b18b06b5b20b46f025aee8.png)

问题是您如何专注于弹出窗口上的表格视图并允许用户滚动到单元格..？

谢谢，

关联

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T01:46:47.813

好的，所以现在我更好地理解了你的问题。您`UITableViewDelegate`的弹出窗口中的 tableview 应该实现`tableView:didSelectRowAtIndexPath:`. 在这种方法中，您将执行以下操作。

1.  确定使用哪一行被选中`indexPath`
2.  根据选定的行，为其他 tableview 过滤您的数据源并`[myOtherTableView reloadData]`直接调用、发布通知、执行块或进行另一层委托
3.  解雇你的`UIPopoverController`

# javascript - 从外部调用 bootstrap typeahead updater 函数

> ID：14491866
> 
> 赞同：1
> 
> 时间：2013-01-24T00:24:55.953
> 
> 标签：javascript, jquery, twitter-bootstrap, scope, typeahead

有没有办法让我从预输入范围之外访问更新程序功能？

我当前的示例是，在更新程序函数中，我有一些自定义逻辑，可以创建一些 html 并将其附加到正文中，例如以下代码片段示例：

```
 updater: function(item){
                $input = $('<span/>',{
                   class:'label label-info',
                   text:item,
                   style:'margin-left:4px'
                 });
                ...
                $('#tagContainer').append($input);

             } 
```

现在我的问题是：考虑到我会将'item'参数传递给它，我是否可以将此功能链接到按钮，以便在单击按钮时触发它？

我想这个问题涉及到一些关于函数范围的问题，这是我缺乏知识的地方，需要一些洞察力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:26:43.347

将其定义为单独的函数：

```
function appendInput(item) {
   //same contents
}

update: appendInput ...

$("button").on('click', function () { appendInput(this); }); 
```

# python - MySQLdb 安装程序说在注册表中找不到 python 2.7

> ID：14491868
> 
> 赞同：1
> 
> 时间：2013-01-24T00:25:10.820
> 
> 标签：python, mysql, windows, python-2.7, installation

我正在使用 Django 并且需要 MySQLdb 包。当我下载并运行安装程序时，它说

> 需要 Python 2.7 版本，但在注册表中找不到

或类似的东西，我不能在安装程序中继续。

如果这很重要，我正在使用 Windows 7 家庭高级版 64 位 x86。谢谢

# java - 如何有效地将自定义 JPanel 绘制为 JScrollPane 的 ViewportView？

> ID：14491875
> 
> 赞同：0
> 
> 时间：2013-01-24T00:26:06.793
> 
> 标签：java, swing, jscrollpane, viewport, custom-painting

我有一个`JScrollPane`显示（作为它的视口视图）`MyPanel`，一个`JPanel`.

`MyPanel`通过重载实现自定义绘画`paintComponent`。的可显示内容的总大小`MyPanel`通常很宽（意味着比`JScrollPane`视口的大小宽 50 倍到 200 倍）并且使用`Timer`，我水平滚动以查看底层的不同部分`MyPanel`。我还允许使用滚动条拇指手动寻找`MyPanel`.

在我的`paintComponent`实现中，我目前正在`MyPanel`使用 查找当前在视口中可见的部分`JViewport#getVisibleRect`，并且每次更改视口位置时只需绘制该部分。

这很好用——但我最终会`MyPanel`一遍又一遍地重新绘制可见部分的很大一部分，因为定时滚动一次只会将视口移动 1/50 的视口宽度。此外，我通常最终会滚动浏览 的整个水平范围`MyPanel`，因此无论如何我都必须至少绘制一次。

这让我想到`MyPanel`只绘制一次的全部内容（到一个`BufferedImage`？），然后让`JScrollPane`（或`JViewport`）处理剪辑和只对`BufferedImage`.

直觉上，在我看来，这似乎是处理这个问题的最有效方式，而且是相对常见的。

当我研究 Swing 教程和其他资源时，我了解到 Swing 已经是双缓冲的。如果我尝试用我自己的蛮力来强制执行此操作，而不依赖于 Swing 功能，听起来我最终会使用三重缓冲。

我还没有找到`JScrollPane`为我做这件事的方法（如果存在的话）。

是否有可用的示例或有关如何执行此操作的某些方向（如果可能）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T02:55:39.570

Swing 仅自动为您绘制组件的最小必要区域。`repaint(4 args)`仅当组件部分更改并且您不希望重新绘制整个可见区域时才有用。而在你的实践中，它的效果与`repaint(no-args)`.

如您在问题中所述，自动裁剪区域已经足够小，可以解决可见性问题。你可以在你的程序中配置它。

此外，您无需担心滚动—— JScrollPane 会自动调用其子项的重绘。

您可以轻松地尝试这些：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Rectangle;
import java.util.Random;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

public class Test extends JFrame {

    private Random rnd = new Random();
    private Color c = Color.WHITE;

    public Test () {
        final JPanel pnl = new JPanel() {

            @Override
            public void paintComponent (Graphics g) {
                super.paintComponent(g);
                g.setColor(c);
                g.fillRect(0, 0, getWidth(), getHeight());
                Rectangle r = g.getClipBounds();
                System.out.println(r.width + ", " + r.height);
            }
        };
        pnl.setPreferredSize(new Dimension(10000, 10000));

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setSize(400, 400);
        setLocationRelativeTo(null);

        add(new JScrollPane(pnl));

        setVisible(true);

        new Thread() {

            @Override
            public void run () {
                while (true) {
                    c = new Color(rnd.nextInt(0xffffff));
                    pnl.repaint();
                    try {
                        Thread.sleep(100);
                    } catch (InterruptedException e) {}
                }
            }
        }.start();
    }

    public static void main (String args[]) {
        new Test();
    }
} 
```

# ada - Ada 的命令行参数

> ID：14491899
> 
> 赞同：10
> 
> 时间：2013-01-24T00:28:33.570
> 
> 标签：ada

我正在编写一个应该对字母字符进行大小写转换的 Ada 程序。该程序使用 1、2 或 3 个命令行参数。我几乎把事情写好了，但我不知道如何进行争论。命令行参数是：

1.  单个字符，指定是大写转换还是小写转换应用于输入。'U' 或 'u' 表示大写转换；'L' 或 'l' 指定小写转换。该参数是程序运行所必需的。
2.  （可选）用于输入大写/小写转换的文件名。如果未指定此参数，则程序必须从标准输入中读取。
3.  （可选，仅在还提供第三个命令行参数时使用）用于加密或解密过程输出的文件的名称。如果未指定此参数，则程序必须写入标准输出。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-24T00:46:32.283

您可以使用标准包[`Ada.Command_Line`](http://www.ada-auth.org/standards/12rm/html/RM-A-15.html)来访问命令行参数。

你有`Argument_Count`参数的数量。您必须`Argument(Number : Positive)`在 position 处获取参数字符串`Number`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-24T12:06:16.383

Ada.Command_Line 包是标准的，完全适合您的任务。

使用 Ada.Command_Line 进行更复杂的命令行解析变得很困难。如果您的命令行需要命名而不是位置关联，请参阅Adacore 的[Gem 中](https://www.adacore.com/gems/gem-138-gnatcoll.command-line)关于将 Gnat.Command_Line 用于（不太便携，如果这很重要，但是）更多类似 Unix 的参数和选项命令行序列。

还有一个我在一个小项目中成功使用的[通用命令行解析器。](https://launchpad.net/gclp/1.0/1.0.0)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-24T16:12:18.127

正如使用 Ada.Command_Line 已经说过的那样，我会建议类似的东西：

```
with
    Ada.Text_IO,
    Ada.Command_Line,
            Ada.Strings.Bounded;

use 
    Ada.Text_IO,
        Ada.Command_Line;

procedure Main is

     package SB is new Ada.Strings.Bounded.Generic_Bounded_Length (Max => 100);
     use SB;

     Cur_Argument : SB.Bounded_String;
     Input_File_Path : SB.Bounded_String;
     Output_File_Path : SB.Bounded_String;
     I : Integer := 1;

begin

     -- For all the given arguments
     while I < Argument_Count loop
          Cur_Argument := SB.To_Bounded_String(Argument(I));      

          if Cur_Argument = "U" or Cur_Argument = "u"
          then
             -- stuff for uppercase         
          elsif Cur_Argument = "L" or Cur_Argument = "l"    
          then
             -- stuff for lowercase         
          elsif Cur_Argument = "i"
          then
             -- following one is the path of the file
             Input_File_Path := SB.To_Bounded_String(Argument(I+1));      
             i := i + 1;
          elsif Cur_Argument = "o"
          then
             Output_File_Path := SB.To_Bounded_String(Argument(I+1));
             i := i + 1;
          else
             Put_Line("Wrong arguments");
          end if;   

          i := i + 1;      
     end loop;     

end Main; 
```

# ios - NSArray 在 iOS6 中有 5 个对象，但在 iOS5 中有 4 个对象？

> ID：14491902
> 
> 赞同：0
> 
> 时间：2013-01-24T00:28:58.077
> 
> 标签：ios, ios6, nsarray, ios5.1

`[taskValues count]`iOS6.0下为5，iOS5.1下为4。帮助 ：）

```
 NSArray *taskValues = [NSArray arrayWithObjects:task.name, task.description,
                           task.duration, task.notification, task.notificationThereafter, nil]; 
```

编辑：

解决了。太丢脸了。你当然是对的。iOS5 模拟器上的持久化状态与 iOS6 模拟器上的状态不同，底层数据模型很久以前就发生了变化，iOS5 模拟器从未重置。我正在使用一个 iOS6 应用程序并支持它为 iOS5.1 工作。你帮我看到了光明！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:31:51.917

我最可能的猜测是`task.notificationThereafter`当`nil`你在 iOS 5.1 下运行你的应用程序时。当然，我对您的应用程序了解得不够多，无法知道造成这种情况的*原因*。

# mysql - 更改mysql日期中的年份

> ID：14491906
> 
> 赞同：38
> 
> 时间：2013-01-24T00:29:17.113
> 
> 标签：mysql, date

我的数据库中有一堆日期存储在标准 mysql 日期类型中。

无论原始日期如何，我如何将一年转换为 2013 年。

因此，如果日期是 2009-01-01，它将是 2013-01-01，但如果是 2012-01-04，它将转换为 2013-01-14。

我认为这很简单明了，但我想不通=/

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-24T01:03:24.403

这很简单：

日期时间：

```
UPDATE table_name
SET date_col=DATE_FORMAT(date_col,'2013-%m-%d %T'); 
```

日期：

```
UPDATE table_name
SET date_col=DATE_FORMAT(date_col,'2013-%m-%d'); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-03-02T16:50:28.473

当前答案的问题是它们都没有考虑闰年。如果您获取日期“2016-02-29”并通过连接将其转换为 2013 年，则会得到“2013-02-29”，这不是有效日期。如果你运行 DATE_FORMAT('2013-02-29', '%Y-%m-%d') 结果是`null`. 在此处查看示例：

[http://sqlfiddle.com/#!9/c5358/11](http://sqlfiddle.com/#!9/c5358/11)

更改年份的更好方法是使用 DATE_ADD，因为它考虑了夏令时。例如：

```
SELECT
DATE_FORMAT(DATE_ADD(datecol, INTERVAL (YEAR(CURRENT_DATE()) - YEAR(datecol)) YEAR), '%Y-%m-%d') `date`
FROM t; 
```

如果您仍想将所有日期转换为 2013 而不是当前年份，则可以将 CURRENT_DATE() 替换为 '2013-01-01'。此解决方案的示例如下：

[http://sqlfiddle.com/#!9/c5358/12](http://sqlfiddle.com/#!9/c5358/12)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-24T00:30:31.620

```
UPDATE tableName
SET    dateColumn = dateColumn + INTERVAL 4 YEAR 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/dd557/2)

另一种方法是连接它，

```
UPDATE Table1
SET    DateColumn = CONCAT(YEAR(CURDATE()), '-', DATE_FORMAT(dateColumn, '%m-%d')) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/801e8/1)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-24T00:34:59.067

如果它是一个日期字段：

```
 UPDATE table_name SET date_field_name = CONCAT("2013", RIGHT(date_field_name,6)); 
```

如果它是一个日期时间字段：

```
UPDATE table_name SET date_field_name = CONCAT("2013", RIGHT(date_field_name,15)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-06T17:26:15.403

任务的当前日期是 2013 年，我知道您希望将当前年份设置为日期。

```
UPDATE table_name SET date_col=DATE_FORMAT('2013-05-06',YEAR(CURRENT_DATE)-%m-%d); 
```

# vhdl - VHDL - 设计库不包含单元

> ID：14491912
> 
> 赞同：3
> 
> 时间：2013-01-24T00:29:44.240
> 
> 标签：vhdl

我有以下架构：

```
architecture datapath of DE2_TOP is
begin
U1: entity work.lab1 port map (
    clock => clock_50,
    key => key,
    hex6 => hex6,
    hex5 => hex5,
    hex4 => hex4
);
end datapath; 
```

我收到以下错误：`Error (10481): VHDL Use Clause error at DE2_TOP.vhd(276): design library "work" does not contain primary unit "lab1"`在线：`U1: entity work.lab1 port map (`。有谁知道这是什么原因造成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T10:46:21.100

在编译之前，您至少需要编译`entity`for`lab1``DE2_TOP`

# objective-c - 无法弹出视图控制器

> ID：14491914
> 
> 赞同：0
> 
> 时间：2013-01-24T00:30:18.577
> 
> 标签：objective-c, uiviewcontroller

我有 2 个视图，`TableController`并且`WirelessController`. 在 TableController 中，我需要弹出 WirelessController 视图。这是我尝试过的，没有任何反应，也没有控制台输出。

```
WirelessController *wCon = [[WirelessController alloc] init];
[[wCon navigationController] popViewControllerAnimated:YES]; 
```

这也有同样的问题。

```
[self navigationController] popViewControllerAnimated:YES]; 
```

当它是基于视图的应用程序时，我正在使用 UINavigationController 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:08:42.147

我认为你的意思是推动，而不是流行......

```
WirelessController *wCon = [[WirelessController alloc] init]; 
```

[[self navigationController] pushViewControllerAnimated:YES];

Push 将一个新项添加到栈顶；pop 从堆栈中删除顶部项目。

*更新*

从你的评论看来...

*   您的第一个视图是 WirelessController 的一个实例。

*   从那里你以模态方式呈现一个 TableController

*   现在你想回到你的无线控制器。

在这种情况下，您需要向*呈现*视图控制器 (wirelessController) 发送一条消息，要求它关闭它*呈现*的视图控制器(tableController)

在表控制器中：

```
 [self presentingViewController] dismissViewControllerAnimated:YES 
                                                     completion:nil]]; 
```

无论发生什么，您当然不想这样做：

```
WirelessController *wCon = [[WirelessController alloc] init]; 
```

此行将创建一个新对象。您想返回到现有对象。

*推送*和*弹出*视图控制器是一个通常与导航控制器相关联的活动，导航控制器保留了一组托管视图控制器。在这种情况下，您将*push*以将新控制器添加到堆栈顶部，然后*pop*以将其从堆栈中删除。在没有导航控制器的情况下，没有这样的堆栈，所以 push 和 pop 没有意义。

# jquery - 在 Javascript 中循环遍历奇怪的 JSON

> ID：14491916
> 
> 赞同：0
> 
> 时间：2013-01-24T00:30:30.943
> 
> 标签：jquery, json

我有一个 PHP 脚本，它返回一个 json 编码的结果，如下所示：

```
// I added "var jsonp =" manually to make it an array variable.

var jsonp = [
    [
        {
            "txtHide": "Y",
            "data": "2012-12-21",
            "phone": "+15879891300",
            "Text": "Hello"
        },
        {
            "txtHide": "Y",
            "data": "2013-01-08",
            "phone": "+15879891400",
            "Text": "Issue"
        },
        {
            "txtHide": "Y",
            "data": "2013-01-19",
            "phone": "+15879891040",
            "Text": "This is a test "
        }
    ],
    [],
    [
        {
            "txtHide": "Y",
            "data": "2013-01-16",
            "phone": "+142610588790",
            "Text": "kkk 1"
        },
        {
            "txtHide": "Y",
            "data": "2013-01-18",
            "phone": "+123610588790",
            "Text": "Test 23"
        },
        {
            "txtHide": "N",
            "data": "2013-01-22",
            "phone": "+123610588790",
            "Text": "Hi"
        }
    ],
    [],
    [],
    [],
    [
        {
            "txtHide": "Y",
            "data": "2013-01-05",
            "phone": "+221522988655",
            "Text": "oo 12"
        }
    ]
] 
```

如何使用 JQuery 遍历这个 JSON 结果？

这是我所做的，但它只打印前四行：

```
$.each(jsonp, function(i,val) {
        console.log(val[i].txtshare);
        console.log(val[i].dtzserver);
        console.log(val[i].txtphonee164);
        console.log(val[i].txtfinding);
    }); 
```

我的 Firebug 控制台输出：

```
Y
2012-12-21
+15879891300
Hello 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:40:37.137

你有一个 3 维数组，所以你需要两个循环：

```
$.each(jsonp, function() {
    $.each(this, function () {
        console.log(this.txtshare);
        console.log(this.dtzserver);
        console.log(this.txtphonee164);
        console.log(this.txtfinding);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:42:17.553

在您的示例中，“val”指的是主“jsonp”数组中的嵌套数组。您需要一个嵌套的 $.each 结构来获取嵌套数组的内部内容，例如：

```
$.each(jsonp, function(index, value){
    $.each(value, function(index, innerval){
        console.log(innerval.txtshare);
        //... and so on
    });
}); 
```

# jquery - jQuery 插件开发事件处理程序

> ID：14491921
> 
> 赞同：0
> 
> 时间：2013-01-24T00:30:45.213
> 
> 标签：jquery

我正在尝试学习开发 jQuery 插件。我阅读了 jQuery 网站上的基础教程，并尝试了解它的工作原理以及插件的结构。

我做了一些快速测试，但我现在卡住了，我不知道如何过去。

这是代码：

```
var myElement = $("#Foo");
var myButton = $("#Bar");
(function($) {
var showAlert;
var mathWorks;
var methods = {
    init : function(options) {

    // Declaring Default Options
    var defaults = 
    {
        option1 : 'Default',
        option2 : false
    }

    // Merge Options
        var opt =  $.extend(defaults, options);

    showAlert = function(txt)
    {
        alert(txt);
    }

    mathWorks = function(a,b)
    {
        alert('Result of '+a+'*'+b+' = '+ a*b);
    }

    methods.doSomething(opt.option1);
},

doSomething: function(text)
{
    alert(text);
},

doMathWorks: function(a,b)
{

    mathWorks(a,b)
}

};

$.fn.testPlugin = function() {
    var method = arguments[0];

    if(methods[method]) {
        method = methods[method];
        arguments = Array.prototype.slice.call(arguments, 1);
    } else if( typeof(method) == 'object' || !method ) {
        method = methods.init;
    } else {
        $.error( 'Method ' +  method + ' does not exist on jQuery.pluginName' );
        return this;
    }
    return method.apply(this, arguments);   

}
})(jQuery); 
```

**我在哪里声明事件处理程序？**

像：

```
myButton.bind('click', function()
        {
            alert('test');
            //methods.doSomething("Testing");
}); 
```

而且，像我一样在插件之前声明元素变量是正确的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:33:02.890

您应该为您的插件使用单一范围，以将其与页面上的其他插件和 JavaScript 代码隔离开来。

[这](http://msdn.microsoft.com/en-us/magazine/ff608209.aspx)是如何开发插件的绝佳教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:33:03.320

1.  在方法中声明事件处理程序`init`，但使用`.on`而不是`.bind`. 我假设这些是您希望作为插件行为的一部分绑定到按钮的事件。
2.  像你一样声明元素是不正确的，因为你的插件根本不应该依赖于现有的 DOM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T01:31:47.267

您可以在方法之外完全定义您`showAlert`的私有实用程序函数。在外部声明它们并在内部定义它们没有任何优势，并且可能会造成混淆。`mathWorks``init()`

事件处理程序可以附加在您向其传递 jQuery 集合（或由此类方法调用的实用程序函数）的任何方法中。确保方法内部有一个`return this.each(function(){...})`结构，从而寻址集合的所有成员，并将其返回以进行方法链接。

# jquery - 正确使用 jQuery 效果

> ID：14491922
> 
> 赞同：2
> 
> 时间：2013-01-24T00:30:56.577
> 
> 标签：jquery, css, jquery-ui

我正在使用 jQuery 弹跳效果来验证表单条目。当文本字段反弹时，它会失去其 CSS 属性： 原始： ![在此处输入图像描述](../Images/732c6db91b21037d70c3f9be90e7b333.png)

效果期间：![在此处输入图像描述](../Images/d479aff0cef7afb6e8db6406ed29af6b.png)

HTML：

```
<span class='notify'>
        <span class='getin'>Get in early</span>
        <input type='text' id='inviteEmail' placeholder='Enter email'/>
        <a href='#' name='email' id='invite-all' onclick='notifyEmail();' class='btn'>Notify Me</a>
      </span> 
```

CSS：

```
.notify {
    position: absolute;
    bottom: 0;
    padding-left: 50px;
}

a.btn {

    padding: 6px 7px;
    background: #000000;
    color: #3be2da !important;
    border: 2px solid rgba(33, 68, 72, 0.59);
    border-radius: 7px;
    -moz-border-radius: 7px;
    -webkit-border-radius: 7px;
    text-align: center;
    text-decoration: none;
    font: bold 14px;
    margin-left: 10px;
}
a.btn:hover {
    background: #3d7a80;
}
span.getin {
    font: bold 16px Tahoma;
    margin-right: 35px;
}
input[type='text']{
   text-align:center;
   font-weight: bold;
   width: 220px;
   height: 35px;
   -webkit-border-radius: 7px;
   -moz-border-radius: 7px;
    border-radius: 7px;
    border: 2px solid #616565;
    font-size: 18px;
}

a.invitelink {
    padding: 6px 7px;
    background: #000000;
    color: #3be2da !important;
    border: 2px solid rgba(33, 68, 72, 0.59);
    border-radius: 7px;
    -moz-border-radius: 7px;
    -webkit-border-radius: 7px;
    text-align: center;
    text-decoration: none;
    font: bold 14px Tahoma,Helvetica, Geneva, sans-serif;
    margin-left: 10px;
} 
```

以及如何在生效后清除文本框并保留占位符文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:38:31.033

添加

```
.notify .ui-effects-wrapper {
  display: inline-block;   
} 
```

到您的样式表：

[http://jsfiddle.net/7rCZW/](http://jsfiddle.net/7rCZW/)

# ghostscript - 如何将多个不同大小的 PostScript 文件转换为单个 PDF？

> ID：14491923
> 
> 赞同：0
> 
> 时间：2013-01-24T00:31:07.593
> 
> 标签：ghostscript

我正在使用与此类似的命令：

```
gswin32c.exe -dNOPAUSE -dBATCH -q -dSAFER -sDEVICE=pdfwrite -dPDFSETTINGS=/prepress -sOutputFile="path/output.pdf" <PSfiles> 
```

这给了我一个 pdf 文档，每个 PS 文档都表示为一个页面。但是，页面大小不能很好地转换。原始 PS 文件大小不同，每个生成的 pdf 页面都被截断为相同大小，看起来像横向 A4。

当我使用完全相同的命令转换单个 PS 文件时，会保留页面大小。所以看起来因为所有的 PS 文件都被发送到同一个 pdf，它们必须都具有相同的页面大小并且我丢失了内容。无论如何在仍然使用单个命令的同时保留文档大小吗？

更新：我最初使用的是 GS 8.63，但我下载了 9.06 并且遇到了同样的问题。此外，我已经缩小了问题的范围。似乎有一个特定的 PS 文件（称为problemFile.ps）会导致问题，因为只要我排除problemFile.ps，我就可以成功运行该命令。如果它是命令行中包含的最后一个文件，它只会导致问题。我不能发布整个文件，但是我应该查看任何潜在的问题区域吗？

Update2：好的，我说有一个特定的问题文件是错误的。似乎命令行中包含的最后一个文件的页面大小设置了所有结果页面的最大页面大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T08:37:29.607

只要每个 PostScript 文件（或实际上是每个页面）实际请求不同的媒体大小，那么生成的 PDF 文件就会接受这些请求。我知道这至少曾经有效，我已经测试过了。

但是，您可能需要重新考虑命令行中的一些内容：

1) 在调查 GS 的问题时，*不要*使用 -q，这会阻止 Ghostscript 告诉你可能有用的东西。

2)*不要*使用 -dPDFSETTINGS 除非您已阅读相关文档并了解每个参数设置的含义。

3）您可能想要关闭 AutoRotatePages，或者至少将其设置为 /PageByPage

我的猜测是您的 PostScript 文件不要求媒体大小，因此使用默认媒体。当然，我不能不看一个例子来判断。

注意你也没有说你使用的是什么版本的 Ghostscript。

# java - CMD 在 Maven 中无法识别

> ID：14491928
> 
> 赞同：3
> 
> 时间：2013-01-24T00:31:22.300
> 
> 标签：java, maven

我有一个 maven 项目，当我运行它时，它会成功构建，但不会启动服务器，而是打印出以下“ **'cmd' 不被识别为内部或外部命令、可运行程序或批处理文件。** ”。我实际上已经尝试重新安装netbeans，但这似乎并没有解决问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-10T08:55:08.373

这不是您的 IDE 或 MAVEN 的问题。检查您的“system32”`PATH`在 windows 的环境变量中是否正确定义。在此之前验证您的 JAVA_HOME 和 M2_HOME 路径是否正确

```
Path = %SystemRoot%\system32; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-18T12:40:22.583

将 C:\Windows\System32 添加到环境变量中的 Path 变量中，它应该可以工作。

# php - JOIN 查询返回 100450(inetuser)

> ID：14491933
> 
> 赞同：0
> 
> 时间：2013-01-24T00:31:54.050
> 
> 标签：php, group-by, max, jointable

我正在做一个私人消息系统。我的表单正确地发布到我的表中，但返回查询拉出了一些奇怪的东西。我对加入表格有点陌生......

带有 sql 查询的 PHP 代码：

```
function fetch_messages()  {
    $sql = "SELECT
                `conversations`.`con_id`,
                `conversations`.`con_subject`,
                MAX(`conversations_messages`.`message_date`) AS `con_last_reply`
            FROM `conversations`
            LEFT JOIN `conversations_messages` ON `conversations`.`con_id` = `conversations_messages`.`con_id`
            INNER JOIN `conversations_members` ON `conversations`.`con_id` = `conversations_members`.`con_id`
            WHERE `conversations_members`.`user_id` = 31
            AND `conversations_members`.`con_deleted` = 0
            GROUP BY `conversations`.`con_id`
            ORDER BY `con_last_reply` DESC";

    $result = mysql_query($sql);

    $conversations = array();

    while (($row = mysql_fetch_assoc($result))  !== false)  {

        $conversations[] = array(
        `id`        => $row['con_id'],
        `subject` => $row['con_subject'],
        `con_last_reply` => $row['last_reply']
        );
    }
    return $conversations;
} 
```

返回数组：

```
Array ( [0] => Array ( 
                [uid=8927072(user007) gid=100450(inetuser) groups=100450(inetuser) ] => 1
                [] => ) ) 
```

（这几乎就像它在返回我的 ftp 信息？user007 是我打开的 ftp 连接名称，但这不是表格中的内容！！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:21:54.827

您使用了错误类型的引号。它应该是：

```
 $conversations[] = array(
    'id'        => $row['con_id'],
    'subject' => $row['con_subject'],
    'con_last_reply' => $row['last_reply']
    ); 
```

反引号就像在 shell 或 Perl 中一样，它们运行命令并将其输出作为字符串返回。

直到这个问题我才知道 PHP 有这个功能。

[文档](http://php.net/manual/en/language.operators.execution.php)

# ios - 动画容器视图控制器

> ID：14491936
> 
> 赞同：2
> 
> 时间：2013-01-24T00:32:10.670
> 
> 标签：ios, objective-c, core-animation, container-view

我的主屏幕上有 2 个容器视图控制器，其中一个用作顶部的全局工具栏。这在大多数情况下都很棒，但我需要在屏幕外设置动画，以便为用户提供更多空间来查看屏幕上的大量信息。这可能吗？我一直在查看文档，但不确定是否需要使用转换动画或更改帧/边界。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:34:24.380

您应该能够更改标准 UIView 动画（块或其他）中的帧/边界。无需引用“包含”视图。

更新：这是一个块动画示例。

```
[UIView animateWithDuration:1.0f
                 animations:^{
                     view1.frame = CGRectMake(blah...);
                 }
                 completion:^(BOOL finished){
                     // do something here if you wish.
                 }]; 
```

# python - Python GDal 安装

> ID：14491938
> 
> 赞同：0
> 
> 时间：2013-01-24T00:32:45.653
> 
> 标签：python, gis, gdal

在 Windows 7 32 位上使用 python 2.7 安装 Gdal 时遇到一些问题。我正在运行 MSVC 2010。我已按照博客网站的说明进行操作

[http://cartometric.com/blog/2011/10/17/install-gdal-on-windows/](http://cartometric.com/blog/2011/10/17/install-gdal-on-windows/)

安装很好。最后，我能够在 MS-DOS 中运行 ogr2ogr 并获得与博客中列出的类似屏幕。

但是，当我尝试在 Python IDLE GUI shell 上使用命令“import osgeo”时。一系列的错误信息被释放出来，如下所示

“DLL 错误：.......”

我相信这可能意味着 python 绑定的版本错误。我通过删除以下内容清理了我的安装：Python-Gdal binding, Gdal, Python 2.7

删除它们后，我用 Python 3.2.3 重试了我的安装，并相应地加载了 Gdal 包和 python 绑定。但是，返回相同的错误。

我可以采取任何中间步骤来验证安装。我必须安装绑定的任何其他建议？或者我的重新安装方法是否正确？

我也尝试安装 FWTools。它似乎也不起作用。我已经从 EV-shell 运行 Python shell 并输入“import osgeo”。收到消息“不存在模块......”

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:53:06.573

从这里获取预编译的 gdal：

[http://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal](http://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal)

如果您需要，我还有一些关于在此处设置 postgres 和 postgis 2.0 的注意事项：

[http://monkut.webfactional.com/blog/archive/2012/5/2/using-django-14-with-gdal-19-and-postgis-20/](http://monkut.webfactional.com/blog/archive/2012/5/2/using-django-14-with-gdal-19-and-postgis-20/)

# c# - 检测未实现的 LINQ 查询

> ID：14491939
> 
> 赞同：3
> 
> 时间：2013-01-24T00:32:48.433
> 
> 标签：c#, .net

我有一个我使用的 Cache 包装类，它提供类型安全和分段以及其他好东西。

我想通过缓存一个未物化的 LINQ 查询并只接受列表/集合来防止我在脚下开枪......

有没有办法检测 IEnumerable 是否是 LINQ 查询？

也许我正在回答我自己的问题，并且当 T 是 IEnumerable 但不是 ICollection 时应该抛出异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T00:36:42.763

我建议将其包装`IEnumerable<T>`在您自己的收藏中，自己“实现”它。

这将提供完全的安全性和更高的一致性，但可能会生成另一个集合实例并复制引用。

您总是可以检查`ICollection<T>`而不重新生成或类似的，但是将内容复制到您自己的列表中仍然有好处。一个主要的问题是，您可以控制集合的唯一实例——您不必担心另一个对象添加或删除项目（这可能是也可能不是问题，但对于分段可能有问题）。

# nginx - Nginx 将子域转换为路径组件而不重定向

> ID：14491944
> 
> 赞同：34
> 
> 时间：2013-01-24T00:33:10.927
> 
> 标签：nginx, rewrite, subdomain, roundtrip

这个想法是接受传入的请求`http://abc.example.com/...`并将它们重写为`http://example.com/abc/...`

使用 301/302 重定向很容易做到这一点：

```
# rewrite via 301 Moved Permanently
server {
  listen 80;
  server_name abc.example.com;
  rewrite ^ $scheme://example.com/abc$request_uri permanent;
} 
```

诀窍是在指向同一个 Nginx 实例时，对客户端**透明**地更改此 URL 。`abc.example.com``example.com`

换句话说，Nginx 是否可以在**没有其他客户端往返**的情况下从请求`example.com/abc/...`时提供内容？`abc.example.com/...`

 ****起点配置**

使用 301 完成任务的 Nginx 配置：

```
# abc.example.com
server {
  listen 80;
  server_name abc.example.com;
  rewrite ^ $scheme://example.com/abc$request_uri permanent;
}

# example.com
server {
  listen 80;
  server_name example.com;
  location / { 
    # ...
  }
} 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-24T02:09:15.467

```
# abc.example.com
server {
  listen 80;
  server_name abc.example.com;
  location / {
    proxy_pass http://127.0.0.1/abc$request_uri;
    proxy_set_header Host example.com;
  }
} 
```**

# python - 为什么我在 Pygame 的 Pong 游戏中球不反弹？

> ID：14491949
> 
> 赞同：1
> 
> 时间：2013-01-24T00:33:38.420
> 
> 标签：python, pygame, pong

我正在尝试在 Pygame 中制作 Pong 克隆。我对 Python 还很陌生，遇到了一些麻烦。该程序应该使两个桨可移动，并且球在屏幕边缘弹跳，但球没有弹跳。为什么？

```
bif="bg.jpg"

import pygame, sys
from pygame.locals import *

pygame.init()
pygame.display.set_caption("Griffin West's Python Pong")
pygame.mixer.init()
sounda= pygame.mixer.Sound("Music.wav")

sounda.play()

screen=pygame.display.set_mode((1280,720),0,32)
background=pygame.image.load(bif).convert()

color1=(255,255,255)
color2=(255,255,0)
color3=(0,0,255)
color4=(0,255,0)
pos1=(640,0)
pos2=(640,720)
pos3=(640,360)
pos4=(0,360)
pos5=(1280,360)
radius=(100)
x1,y1=75,0
x2,y2=1175,0
x3,y3=0,0
clock=pygame.time.Clock()
speed=750
movex1, movey1=0,0
movex2, movey2=0,0

while True:

    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type==KEYDOWN:
            if event.key==K_w:
                movey1=-2
            elif event.key==K_s:
                movey1=+2
            if event.key==K_UP:
                movey2=-2
            elif event.key==K_DOWN:
                movey2=+2
        if event.type==KEYUP:
            if event.key==K_w:
                movey1=0
            elif event.key==K_s:
                movey1=0
            if event.key==K_UP:
                movey2=0
            elif event.key==K_DOWN:
                movey2=0

    x1+=movex1
    y1+=movey1
    x2+=movex2
    y2+=movey2

    milli=clock.tick()
    seconds=milli/1000.0
    dm=seconds*speed
    x3+=dm
    y3+=dm

    if x3>1280: 
        x3+=-dm
    if y3>720:
        y3+=-dm
    if x3<0:
        x3+=dm
    if y3<0:
        y3+=dm

    screen.blit(background, (0,0))

    screen.lock()
    pygame.draw.line(screen, color1, pos1, pos2, 1)
    pygame.draw.circle(screen, color1, pos3, radius, 1)
    pygame.draw.circle(screen, color1, pos4, radius, 1)
    pygame.draw.circle(screen, color1, pos5, radius, 1)
    pygame.draw.rect(screen, color3, Rect((x1,y1),(30,100)))
    pygame.draw.rect(screen, color2, Rect((x2,y2),(30,100)))
    pygame.draw.circle(screen, color4, (int(x3),int(y3)), 15)

    screen.unlock()
    myfont = pygame.font.SysFont("Press Start 2P", 50)
    label = myfont.render("Python", 1, (255,0,0))
    screen.blit(label, (494, 115))
    myfont = pygame.font.SysFont("Press Start 2P", 50)
    label = myfont.render("Pong", 1, (255,0,0))
    screen.blit(label, (544, 175))
    pygame.display.update() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T01:13:45.917

免责声明：我不是 pyGame 人。但是，我认为这是一个逻辑问题。

我猜测当前编码的行为是球从左上角（0,0）移动到右下角（1280,720），然后就停在那里。

您想确保球在撞墙时*改变方向*，因此您需要为 x 和 y 设置单独的速度，而不是速度（当您希望球以不同的角度移动时，这也将有所帮助，具体取决于从桨击中）。然后，当球碰到墙壁时，您会改变行进方向。

替换这个：

```
dm=seconds*speed
x3+=dm
y3+=dm

if x3>1280: 
    x3+=-dm
if y3>720:
    y3+=-dm
if x3<0:
    x3+=dm
if y3<0:
    y3+=dm 
```

像这样（适当初始化 speedx,speedy）：

```
dx=seconds*speedx
dy=seconds*speedy
x3+=dx
y3+=dy

if x3>1280: 
    x3+=-dx  # get ball out of the wall
    speedx = -speedx  # change direction
if y3>720:
    y3+=-dy
    speedy = -speedy
if x3<0:
    x3+=dx
    speedx = -speedx
if y3<0:
    y3+=dy
    speedy = -speedy 
```

# javascript - 如何在javascript中为新添加的div指定另一个宽度

> ID：14491950
> 
> 赞同：0
> 
> 时间：2013-01-24T00:33:40.510
> 
> 标签：javascript, jquery, html, css

我正在自定义以下脚本：[http ://tympanus.net/Tutorials/ExpandingImageMenu/index_3.html](http://tympanus.net/Tutorials/ExpandingImageMenu/index_3.html)

但不是 6 个 div（或者在这种情况下是 6 个家伙），我有 11 个，其中最后 4 个 div 使用自定义导航打开。

但我想让最后 4 个 div 的大小变宽，如果可能的话，可变大小以填充内容 div 的右侧。

我该怎么做？

提前致谢！

```
/* get the item for the current */
var $item   = $menuItems.eq(current);
var $item2  = $menuItems + 7; /* i added this line */ 
```

&

```
/* if not just show it */
$item.css({width : '400px'})
$item2.css({width : '700px'}) /* and this one */
.find('.ei_image')
.css({left:'0px', opacity:1,}); 
```

我试过 + + + + + css thingie 但我没有运气，但我已经上传了网站...... [http://www.vernietig.be/depandoering/index2.html](http://www.vernietig.be/depandoering/index2.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:45:09.250

您可以尝试使用 css nth-child，查看下面 jsfiddle 中的示例

```
div{
    width:20px;
    height:100px;
    float:left;
    margin:1px;
    background:blue;
}
div:nth-child(n+7){
    width:100px;
} 
```

[http://jsfiddle.net/k39B7/1/](http://jsfiddle.net/k39B7/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:57:55.173

目前有几件事是错误的。首先，您添加的第二行代码实际上是一些链式方法的一部分。

您不需要添加的第一行代码。

在检查脚本之后，看起来该`current`变量包含触发器列表中项目的从零开始的数组索引。如果它不是基于零的，您可能需要在下面的代码中将 6 更改为 7（或任何适当的值）。

我的建议是：

```
/* if not just show it */
var itemWidth = current < 6 ? '400px' : '700px';
$item.css({width : itemWidth})
.find('.ei_image')
.css({left:'0px', opacity:1,}); 
```

**编辑：**更新以包含另一行要更改的代码

好的，您也可以尝试更改此行：

```
itemParam   = (dir) ? {width : '400px'} : {width : '75px'}, 
```

至

```
itemParam   = (dir) ? current < 7 ? {width : '400px'} : {width : '700px'} : {width : '75px'}, 
```

**编辑 2：**更新发现一个 css 更改

在你的 css 中`.ei_menu ul`删除`width: 1300px;`

如果您不希望滚动条出现，您也可以`overflow: scroll;`从`.ei_descr2`.

**编辑 3：**更新最后 4 个 div 以具有可变宽度。

您可以更改`.ei_descr2`您尝试`width: 100%;`的位置`min-width: 300px;`，这将导致 div 的最小宽度为 300 像素，并且如果需要，它们将扩展以获取更多内容。注意：您可以将`min-width`值更改为您喜欢的任何值。

# android - “无法启动活动组件信息”android xml 解析

> ID：14491951
> 
> 赞同：0
> 
> 时间：2013-01-24T00:33:45.143
> 
> 标签：android

我正在尝试为 android 进行 xml 解析

我按照本教程制作它：

[http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/](http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/)

当我运行该应用程序时，我收到此错误：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.aka.bdb/com.aka.bdb.MainActivity}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list' 
```

我做了 ListView id:list 但我得到了同样的错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:36:08.177

您需要一个带有`@android:id/list`，而不是的列表`@+id/list`。

# node.js - 从 Node.JS / Express.JS 读取时，IronMQ 会从推送队列中清空消息体

> ID：14491952
> 
> 赞同：3
> 
> 时间：2013-01-24T00:33:47.977
> 
> 标签：node.js, express, iron.io, ironmq

我正在玩 node + express + IronMQ，但遇到了一个小问题。

在我的 express.js POST 回调中，我将 {} 作为请求正文，但我确定消息内容是从我的 IronMQ 消息队列中推送的。

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:33:47.977

好的，我已经找到了问题的原因及其解决方案。所以回答我自己的问题：

问题：

* * *

1) 我从 IronMQ 推送队列 ( [http://dev.iron.io/mq/reference/push_queues/](http://dev.iron.io/mq/reference/push_queues/) ) 接收 POST 消息，它们的内容类型是 text/plain。

2) 我正在使用 connect.js 中间件 (express.connect)，它只解析 application/json、application/x-www-form-urlencoded 和 multipart/form-data。 [http://www.senchalabs.org/connect/bodyParser.html](http://www.senchalabs.org/connect/bodyParser.html)

因此正文被解析，并且由于其内容类型不受支持，结果是 {}

## 解决方案：

为了获得我的文本/普通请求的正文，我必须自己解析它，如[https://stackoverflow.com/a/9920700](https://stackoverflow.com/a/9920700)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-06T00:51:49.543

IronMQ 现在已更新其推送队列以发送自定义标头。如果在创建队列时将订阅者列表中的标头设置为 'Content-Type': 'application/json'，则正文将被正确解析。例如

```
# update groups queue
payload =
  subscribers: [
    {
      url: "#{process.env.ROOT_URL}/groups/update"
      headers:
        'Content-Type': 'application/json' # this fixes request parsing issue
    }
  ]
  push_type: 'multicast'
  retries: 3
  retries_delay: 10
  error_queue: 'groups_errors'

url = "https://mq-aws-us-east-1.iron.io/1/projects/#{process.env.IRON_MQ_PROJECT_ID}/queues/groups"

headers =
  'Authorization': "OAuth #{process.env.IRON_MQ_TOKEN}"
  'Content-Type': 'application/json'

result = HTTP.post url, {headers: headers, content: JSON.stringify(payload)} 
```

[这是github上的相关更改](https://github.com/iron-io/docs/pull/371/files)

# coldfusion - ColdFusion 日期减法

> ID：14491957
> 
> 赞同：1
> 
> 时间：2013-01-24T00:34:25.333
> 
> 标签：coldfusion

我正在将 ColdFusion 应用程序转换为 .NET，并且我有一个关于日期减法的问题。

在下面的 if 语句中，qTripID.etd 是航班起飞的 UTC 日期和时间，注释说它正在测试航班是否已经起飞。

```
<cfif qTripID.etd - DateConvert("local2utc",Now()) LT 0.166666666666667> 
```

上面的表达式返回什么类型的信息？

分钟？天？小时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T00:58:21.783

整个表达式：

`qTripID.etd - DateConvert("local2utc",Now()) LT 0.166666666666667`

返回一个布尔值：“LT”是 ColdFusion 的“小于”运算符。

我想你问的是什么单位`0.166666666667`？在这种情况下是天 - 0.1666... 值是 4 小时。

# opencv - 如何使用 OpenCV 为 Kinect 项目设置 OpenNI 2.0？

> ID：14491963
> 
> 赞同：9
> 
> 时间：2013-01-24T00:35:33.263
> 
> 标签：opencv, kinect, openni

我正在做我最后一年的项目。我需要使用 Kinect 来检测手部动作。我尝试了几种方法并得到了一些结果，但是没有一个足以满足项目的需要。很久以前看过[这个视频](https://www.youtube.com/watch?v=Fxa43qcm1C4)，最近才知道他们开源了。所以我试了一下。

我现在的问题是如何设置。

上面这个很棒的项目使用了带有 Kinect 的 OpenNI。我尝试按照[OpenCV 教程](http://docs.opencv.org/doc/tutorials/introduction/windows_install/windows_install.html#windows-installation)从源代码构建它，让 OpenCV 与 OpenNI 一起工作。

问题：

1.  它说“对于 OpenNI 框架，您需要安装开发版本和 PrimeSensor 模块。” 但是当我跟随链接时，其中一些已经死了。似乎 OpenNI 2.0 不再使用 PrimeSensor。

2.  它还说在 Cmake 文件夹中，一个是`OpenCV/Src`，另一个是`/build`. 但是我下载的 OpenCV 没有任何 Src 文件夹。

3.  我仍然将整个文件夹用作 Src，并将其构建到构建文件夹并检查`WITH OPENNI`. 我在下载的 OpenNI2 中使用了 Include 和 Lib 文件夹，但是当我构建 OpenCV 解决方案（已经从 CMake 生成）时，所有构建都失败了。

4.  此外，在使用 Cmake 生成时，即使我未来的 OpenCV 解决方案已经成功构建（事实并非如此），Cmake 也会不断告诉我如何 PrimeSense 不可用，这让我感到非常不安全。:(

5.  我对 32 位和 64 位有点困惑。我想关注的上述项目说它适用于 64 位。但我使用 MS C++ Express，所有项目都是 32 位的。那么我应该使用哪些 PrimeSense 驱动程序（在 OpenNI2 中提供）？

谁能告诉我如何将所有这些东西（OpenNI2.0、OpenCV 2.4.3、PrimeSense）设置在一起，以便我可以使用 Kinect？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-15T09:26:24.300

不久前，我写了两篇关于 1）如何使用 NITE 设置 OpenNI 1.5 2）如何在 OpenNI 支持下编译 OpenCV 的教程。

这些可以在[这里](http://seevisionc.blogspot.co.uk/2012/06/installation-of-openni-with-nite.html)和[这里找到](http://seevisionc.blogspot.co.uk/2012/07/compiling-opencv-with-openni-for.html)

我知道这不是您要求的，但是使用 OpenNI 2.0 编译 OpenCV 的过程应该类似，并且可能会帮助您了解哪里出错了。

我将尝试编写一个更新的教程，但是由于我目前无法访问传感器，因此我可能无法测试它最终是否有效。

编辑：我编写了一些代码来使用 OpenNI 2.x 访问 OpenCV Mat 格式的 Kinect 数据流。代码 github repo 可以在[这里](https://github.com/masad801/OpenCVKinect)找到。可以在[此处](http://seevisionc.blogspot.co.uk/2013/12/opencvkinect-acquiring-kinect-data.html)找到有关如何设置所有内容的详细指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-13T09:23:05.187

OpenNI 2.x 比以前的版本先进很多。您不需要安装 primesense sensorkinect 驱动程序。您可以将 OpenNI 2.x 与 Microsoft Kinect SDK 1.x 一起使用。

如果您有 Windows 7 x64，则安装 64 位和 32 位 OpenNI 2.x，否则只有 32 位。使用 Visual Studio 2010 或 12 对其进行配置。您可以观看此视频：

[http://www.youtube.com/watch?v=ACqPsV0R4to](http://www.youtube.com/watch?v=ACqPsV0R4to)

然后为 Visual Studio 2010 或 12 配置 OpenCV。您可以点击此链接：

[http://4someonehelp.blogspot.in/2013/04/install-opencv-245-using-visual-studio.html](http://4someonehelp.blogspot.in/2013/04/install-opencv-245-using-visual-studio.html)

谢谢

# php - 包含类中的文件数组

> ID：14491965
> 
> 赞同：0
> 
> 时间：2013-01-24T00:35:39.410
> 
> 标签：php, arrays, class, include

> **可能重复：**
> [我可以在 PHP 类中包含代码吗？](https://stackoverflow.com/questions/1957732/can-i-include-code-into-a-php-class)
> [在数组中包含文件](https://stackoverflow.com/questions/14490911/include-file-in-array)

我有这个 php 代码

```
 <?php
   class Config {

   public static $__routes = array(

   "Home"                    => "index.php",
   "Support"                 => "support.php",
   "Ads"                     => "ads.php",

   );

   }

   ?> 
```

我有这样的 ex.php 文件

```
"Upgrade"                 => "upgrade.php",
"Faq"                     => "faq.php",
"Tos"                     => "tos.php", 
```

我想将 ex.php 文件包含在“类”中的“公共静态 $__routes 数组”中

有点像

```
 <?php
   class Config {

   public static $__routes = array(

   "Home"                    => "index.php",
   "Support"                 => "support.php",
   "Ads"                     => "ads.php",

   include 'ex.php';

   );

   }

   ?> 
```

请问我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:51:46.897

你不能，我已经在你的[最后一个问题中解释](https://stackoverflow.com/questions/14490911/include-file-in-array?rq=1)**了原因**：

> 每个文件本身必须是有效的 PHP 代码，因为包含只发生在运行时（即到达该确切代码行时），而不是在解析时（即加载文件时）

现在不同的是，替代解决方案不起作用，因为您不能使用表达式（即`A + B`）初始化类属性，只能使用文字（标量值和标量值数组）

由于属性是静态的，你甚至不能使用构造函数，你必须在类之外分配它：

```
class Config {

   public static $__routes = array(

       "Home"                    => "index.php",
       "Support"                 => "support.php",
       "Ads"                     => "ads.php",

   );

   // ...
}

Config::__routes += (include 'example.php'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:41:58.523

那是行不通的。声明类属性时，您不能执行任何类型的评估。为什么不直接加入项目？

如果您只是必须在另一个文件中配置一些路由，那么我建议将此属性设为受保护或私有，并让调用者使用静态方法来获取此信息。在这个静态方法中，您可以将静态属性数组中定义的路由与包含文件中的数组（不仅仅是您显示的数组段）中定义的路由连接起来，然后返回这个合并的数组。

# java - 这是一个“足够好”的随机算法吗？如果它更快，为什么不使用它？

> ID：14491966
> 
> 赞同：171
> 
> 时间：2013-01-24T00:35:42.903
> 
> 标签：java, performance, algorithm, random

我创建了一个名为 的类`QuickRandom`，它的工作是快速生成随机数。这真的很简单：只需取旧值，乘以 a `double`，然后取小数部分。

这是我`QuickRandom`的全部课程：

```
public class QuickRandom {
    private double prevNum;
    private double magicNumber;

    public QuickRandom(double seed1, double seed2) {
        if (seed1 >= 1 || seed1 < 0) throw new IllegalArgumentException("Seed 1 must be >= 0 and < 1, not " + seed1);
        prevNum = seed1;
        if (seed2 <= 1 || seed2 > 10) throw new IllegalArgumentException("Seed 2 must be > 1 and <= 10, not " + seed2);
        magicNumber = seed2;
    }

    public QuickRandom() {
        this(Math.random(), Math.random() * 10);
    }

    public double random() {
        return prevNum = (prevNum*magicNumber)%1;
    }

} 
```

这是我为测试它而编写的代码：

```
public static void main(String[] args) {
        QuickRandom qr = new QuickRandom();

        /*for (int i = 0; i < 20; i ++) {
            System.out.println(qr.random());
        }*/

        //Warm up
        for (int i = 0; i < 10000000; i ++) {
            Math.random();
            qr.random();
            System.nanoTime();
        }

        long oldTime;

        oldTime = System.nanoTime();
        for (int i = 0; i < 100000000; i ++) {
            Math.random();
        }
        System.out.println(System.nanoTime() - oldTime);

        oldTime = System.nanoTime();
        for (int i = 0; i < 100000000; i ++) {
            qr.random();
        }
        System.out.println(System.nanoTime() - oldTime);
} 
```

这是一个非常简单的算法，只需将前一个双精度数乘以一个“幻数”双精度数。我很快就把它拼凑起来，所以我可能会做得更好，但奇怪的是，它似乎工作得很好。

这是方法中注释掉的行的示例输出`main`：

```
0.612201846732229
0.5823974655091941
0.31062451498865684
0.8324473610354004
0.5907187526770246
0.38650264675748947
0.5243464344127049
0.7812828761272188
0.12417247811074805
0.1322738256858378
0.20614642573072284
0.8797579436677381
0.022122999476108518
0.2017298328387873
0.8394849894162446
0.6548917685640614
0.971667953190428
0.8602096647696964
0.8438709031160894
0.694884972852229 
```

嗯。很随意。事实上，这适用于游戏中的随机数生成器。

以下是未注释部分的示例输出：

```
5456313909
1427223941 
```

哇！它的执行速度比`Math.random`.

我记得在某个地方读到`Math.random`过`System.nanoTime()`很多疯狂的模数和除法的东西。这真的有必要吗？我的算法执行得更快，而且看起来很随机。

我有两个问题：

*   我的算法是否“足够好”（例如，对于**真正**随机数不太重要的游戏）？
*   `Math.random`当看起来只是简单的乘法和去掉小数就足够了，为什么要做这么多呢？

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2013-01-24T01:14:59.650

您的`QuickRandom`实现并没有真正均匀分布。频率通常在较低值处较高，同时`Math.random()`具有更均匀的分布。这是一个[SSCCE](http://sscce.org)，它表明：

```
package com.stackoverflow.q14491966;

import java.util.Arrays;

public class Test {

    public static void main(String[] args) throws Exception {
        QuickRandom qr = new QuickRandom();
        int[] frequencies = new int[10];
        for (int i = 0; i < 100000; i++) {
            frequencies[(int) (qr.random() * 10)]++;
        }
        printDistribution("QR", frequencies);

        frequencies = new int[10];
        for (int i = 0; i < 100000; i++) {
            frequencies[(int) (Math.random() * 10)]++;
        }
        printDistribution("MR", frequencies);
    }

    public static void printDistribution(String name, int[] frequencies) {
        System.out.printf("%n%s distribution |8000     |9000     |10000    |11000    |12000%n", name);
        for (int i = 0; i < 10; i++) {
            char[] bar = "                                                  ".toCharArray(); // 50 chars.
            Arrays.fill(bar, 0, Math.max(0, Math.min(50, frequencies[i] / 100 - 80)), '#');
            System.out.printf("0.%dxxx: %6d  :%s%n", i, frequencies[i], new String(bar));
        }
    }

} 
```

平均结果如下所示：

```
QR distribution |8000     |9000     |10000    |11000    |12000
0.0xxx:  11376  :#################################                 
0.1xxx:  11178  :###############################                   
0.2xxx:  11312  :#################################                 
0.3xxx:  10809  :############################                      
0.4xxx:  10242  :######################                            
0.5xxx:   8860  :########                                          
0.6xxx:   9004  :##########                                        
0.7xxx:   8987  :#########                                         
0.8xxx:   9075  :##########                                        
0.9xxx:   9157  :###########                                       

MR distribution |8000     |9000     |10000    |11000    |12000
0.0xxx:  10097  :####################                              
0.1xxx:   9901  :###################                               
0.2xxx:  10018  :####################                              
0.3xxx:   9956  :###################                               
0.4xxx:   9974  :###################                               
0.5xxx:  10007  :####################                              
0.6xxx:  10136  :#####################                             
0.7xxx:   9937  :###################                               
0.8xxx:  10029  :####################                              
0.9xxx:   9945  :################### 
```

如果你重复测试，你会看到 QR 分布变化很大，这取决于初始种子，而 MR 分布是稳定的。有时它会达到所需的均匀分布，但通常不会。这是一个更极端的例子，它甚至超出了图表的边界：

```
QR distribution |8000     |9000     |10000    |11000    |12000
0.0xxx:  41788  :##################################################
0.1xxx:  17495  :##################################################
0.2xxx:  10285  :######################                            
0.3xxx:   7273  :                                                  
0.4xxx:   5643  :                                                  
0.5xxx:   4608  :                                                  
0.6xxx:   3907  :                                                  
0.7xxx:   3350  :                                                  
0.8xxx:   2999  :                                                  
0.9xxx:   2652  : 
```

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2013-01-24T00:51:55.133

您所描述的是一种称为[线性同余生成器](http://en.wikipedia.org/wiki/Linear_congruential_generator)的随机生成器。生成器的工作原理如下：

*   从种子值和乘数开始。
*   要生成随机数：
    *   将种子乘以乘数。
    *   将种子设置为等于该值。
    *   返回这个值。

这个生成器有很多不错的属性，但是作为一个好的随机源存在很大的问题。上面链接的维基百科文章描述了一些优点和缺点。简而言之，如果您需要好的随机值，这可能不是一个很好的方法。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2013-01-24T00:53:06.607

您的随机数函数很差，因为它的内部状态太少——函数在任何给定步骤输出的数字完全取决于前一个数字。例如，如果我们假设它`magicNumber`是 2（举例来说），那么序列：

```
0.10 -> 0.20 
```

由相似的序列强烈反映：

```
0.09 -> 0.18
0.11 -> 0.22 
```

在许多情况下，这会在您的游戏中产生明显的相关性——例如，如果您连续调用您的函数来为对象生成 X 和 Y 坐标，那么这些对象将形成清晰的对角线图案。

除非您有充分的理由相信随机数生成器会降低您的应用程序的速度（这不太可能），否则没有充分的理由尝试自己编写。

* * *

## 回答 #4

> 赞同：110
> 
> 时间：2013-01-25T17:03:19.357

真正的问题是它的输出直方图很大程度上依赖于初始种子——大部分时间它会以接近均匀的输出结束，但很多时候会有明显不均匀的输出。

受[这篇关于 php`rand()`功能](http://boallen.com/random-numbers.html)`QuickRandom`有多糟糕的文章的启发，我使用和制作了一些随机矩阵图像`System.Random`。此运行显示有时种子可能会产生不良影响（在这种情况下有利于较低的数字），因为`System.Random`它是非常均匀的。

# `QuickRandom`

![](../Images/ae255788fed5160f7d592410d24c5d4f.png)

# `System.Random`

![](../Images/723b3107b07cf27fa5b5a27f28494721.png)

# 更糟

如果我们`QuickRandom`在`new QuickRandom(0.01, 1.03)`得到这个图像时进行初始化：

![](../Images/4da98f91de7d2a7eda3a4a7900ce6917.png)

# 编码

```
using System;
using System.Drawing;
using System.Drawing.Imaging;

namespace QuickRandomTest
{
    public class QuickRandom
    {
        private double prevNum;
        private readonly double magicNumber;

        private static readonly Random rand = new Random();

        public QuickRandom(double seed1, double seed2)
        {
            if (seed1 >= 1 || seed1 < 0) throw new ArgumentException("Seed 1 must be >= 0 and < 1, not " + seed1);
            prevNum = seed1;
            if (seed2 <= 1 || seed2 > 10) throw new ArgumentException("Seed 2 must be > 1 and <= 10, not " + seed2);
            magicNumber = seed2;
        }

        public QuickRandom()
            : this(rand.NextDouble(), rand.NextDouble() * 10)
        {
        }

        public double Random()
        {
            return prevNum = (prevNum * magicNumber) % 1;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var rand = new Random();
            var qrand = new QuickRandom();
            int w = 600;
            int h = 600;
            CreateMatrix(w, h, rand.NextDouble).Save("System.Random.png", ImageFormat.Png);
            CreateMatrix(w, h, qrand.Random).Save("QuickRandom.png", ImageFormat.Png);
        }

        private static Image CreateMatrix(int width, int height, Func<double> f)
        {
            var bitmap = new Bitmap(width, height);
            for (int y = 0; y < height; y++) {
                for (int x = 0; x < width; x++) {
                    var c = (int) (f()*255);
                    bitmap.SetPixel(x, y, Color.FromArgb(c,c,c));
                }
            }

            return bitmap;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2013-01-24T00:54:40.383

您的随机数生成器的一个问题是没有“隐藏状态” - 如果我知道您在最后一次通话中返回的随机数，我知道您将发送的每个随机数直到时间结束，因为只有一个可能的下一个结果，依此类推。

要考虑的另一件事是随机数生成器的“周期”。显然，对于有限状态大小，等于双精度数的尾数部分，它在循环之前最多只能返回 2^52 个值。但这是最好的情况——你能证明不存在周期 1、2、3、4...的循环吗？如果有，在这些情况下，您的 RNG 将出现糟糕的、退化的行为。

此外，您的随机数生成是否会针对所有起点均匀分布？如果没有，那么您的 RNG 将有偏见 - 或者更糟糕的是，根据起始种子的不同，以不同的方式产生偏见。

如果你能回答所有这些问题，那就太棒了。如果你不能，那么你知道为什么大多数人不重新发明轮子并使用经过验证的随机数生成器；）

*（顺便说一句，一句好的格言是：最快的代码是不运行的代码。你可以制作世界上最快的 random()，但如果不是很随机就不好）*

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2013-01-24T21:12:21.047

我在开发 PRNG 时经常做的一项常见测试是：

1.  将输出转换为 char 值
2.  将字符值写入文件
3.  压缩文件

这让我可以快速迭代对于大约 1 到 20 兆字节的序列“足够好”的 PRNG 的想法。它还提供了比仅用肉眼检查更好的自上而下的图片，因为任何“足够好”的带有半个字状态的 PRNG 都可能很快超过您的眼睛看到循环点的能力。

如果我真的很挑剔，我可能会采用好的算法并对它们进行 DIEHARD/NIST 测试，以获得更多的洞察力，然后再回去进行更多的调整。

与频率分析相比，压缩测试的优势在于，很容易构建一个良好的分布：只需输出一个包含 0 - 255 值的所有字符的 256 长度块，然后执行 100,000 次。但是这个序列有一个长度为 256 的循环。

一个偏斜的分布，即使是很小的幅度，也应该被压缩算法拾取，特别是如果你给它足够的序列（比如 1 兆字节）来处理它。如果某些字符、bigrams 或 n-grams 更频繁地出现，压缩算法可以将此分布倾斜编码为有利于使用较短代码字的频繁出现的代码，并且您会获得压缩增量。

由于大多数压缩算法速度很快，并且它们不需要实现（因为操作系统只是将它们放在周围），因此压缩测试对于快速评估您可能正在开发的 PRNG 的通过/失败非常有用。

祝你的实验好运！

哦，我在上面的 rng 上执行了这个测试，使用你的代码的以下小模块：

```
import java.io.*;

public class QuickRandom {
    private double prevNum;
    private double magicNumber;

    public QuickRandom(double seed1, double seed2) {
        if (seed1 >= 1 || seed1 < 0) throw new IllegalArgumentException("Seed 1 must be >= 0 and < 1, not " + seed1);
        prevNum = seed1;
        if (seed2 <= 1 || seed2 > 10) throw new IllegalArgumentException("Seed 2 must be > 1 and <= 10, not " + seed2);
        magicNumber = seed2;
    }

    public QuickRandom() {
        this(Math.random(), Math.random() * 10);
    }

    public double random() {
        return prevNum = (prevNum*magicNumber)%1;
    }

    public static void main(String[] args) throws Exception {
        QuickRandom qr = new QuickRandom();
        FileOutputStream fout = new FileOutputStream("qr20M.bin");

        for (int i = 0; i < 20000000; i ++) {
            fout.write((char)(qr.random()*256));
        }
    }
} 
```

结果是：

```
Cris-Mac-Book-2:rt cris$ zip -9 qr20M.zip qr20M.bin2
adding: qr20M.bin2 (deflated 16%)
Cris-Mac-Book-2:rt cris$ ls -al
total 104400
drwxr-xr-x   8 cris  staff       272 Jan 25 05:09 .
drwxr-xr-x+ 48 cris  staff      1632 Jan 25 05:04 ..
-rw-r--r--   1 cris  staff      1243 Jan 25 04:54 QuickRandom.class
-rw-r--r--   1 cris  staff       883 Jan 25 05:04 QuickRandom.java
-rw-r--r--   1 cris  staff  16717260 Jan 25 04:55 qr20M.bin.gz
-rw-r--r--   1 cris  staff  20000000 Jan 25 05:07 qr20M.bin2
-rw-r--r--   1 cris  staff  16717402 Jan 25 05:09 qr20M.zip 
```

如果输出文件根本无法压缩，我会认为 PRNG 很好。老实说，我不认为你的 PRNG 会做得这么好，对于这样一个简单的结构来说，大约 20 Megs 上只有 16% 是相当可观的。但我仍然认为这是失败的。

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2013-01-29T02:25:33.763

您可以实现的最快的随机生成器是：

![在此处输入图像描述](../Images/462c88d666709f0616e47b811b69709c.png)

XD，除了笑话，除了这里所说的一切，我想贡献一下，引用测试随机序列“是一项艰巨的任务”[1]，并且有几个测试可以检查伪随机数的某些属性，你可以找到一个这里有很多：[http ://www.random.org/analysis/#2005](http://www.random.org/analysis/#2005)

评估随机生成器“质量”的一种简单方法是旧的卡方检验。

```
static double chisquare(int numberCount, int maxRandomNumber) {
    long[] f = new long[maxRandomNumber];
    for (long i = 0; i < numberCount; i++) {
        f[randomint(maxRandomNumber)]++;
    }

    long t = 0;
    for (int i = 0; i < maxRandomNumber; i++) {
        t += f[i] * f[i];
    }
    return (((double) maxRandomNumber * t) / numberCount) - (double) (numberCount);
} 
```

引用 [1]

> χ² 检验的思想是检查产生的数字是否合理分布。如果我们生成*N个小于**r*的正数，那么我们期望得到每个值的*N* / *r*个数。但是——这就是问题的本质——所有值的出现频率不应该完全相同：那不会是随机的！
> 
> 我们只需计算每个值出现频率的平方和，按预期频率缩放，然后减去序列的大小。这个数字，“χ² 统计量”，可以在数学上表示为

![卡方公式](../Images/896c0d94cb06a9fa02c83418204cc579.png)

> 如果 χ² 统计量接近*r*，则数字是随机的；如果它太远，那么它们不是。“近”和“远”的概念可以更精确地定义：存在的表格准确地说明了统计数据与随机序列的属性之间的关系。对于我们正在执行的简单测试，统计量应该在 2√r

使用这个理论和以下代码：

```
abstract class RandomFunction {
    public abstract int randomint(int range); 
}

public class test {
    static QuickRandom qr = new QuickRandom();

    static double chisquare(int numberCount, int maxRandomNumber, RandomFunction function) {
        long[] f = new long[maxRandomNumber];
        for (long i = 0; i < numberCount; i++) {
            f[function.randomint(maxRandomNumber)]++;
        }

        long t = 0;
        for (int i = 0; i < maxRandomNumber; i++) {
            t += f[i] * f[i];
        }
        return (((double) maxRandomNumber * t) / numberCount) - (double) (numberCount);
    }

    public static void main(String[] args) {
        final int ITERATION_COUNT = 1000;
        final int N = 5000000;
        final int R = 100000;

        double total = 0.0;
        RandomFunction qrRandomInt = new RandomFunction() {
            @Override
            public int randomint(int range) {
                return (int) (qr.random() * range);
            }
        }; 
        for (int i = 0; i < ITERATION_COUNT; i++) {
            total += chisquare(N, R, qrRandomInt);
        }
        System.out.printf("Ave Chi2 for QR: %f \n", total / ITERATION_COUNT);        

        total = 0.0;
        RandomFunction mathRandomInt = new RandomFunction() {
            @Override
            public int randomint(int range) {
                return (int) (Math.random() * range);
            }
        };         
        for (int i = 0; i < ITERATION_COUNT; i++) {
            total += chisquare(N, R, mathRandomInt);
        }
        System.out.printf("Ave Chi2 for Math.random: %f \n", total / ITERATION_COUNT);
    }
} 
```

我得到以下结果：

```
Ave Chi2 for QR: 108965,078640
Ave Chi2 for Math.random: 99988,629040 
```

其中，对于 QuickRandom，远离*r* （在 之外 `r ± 2 * sqrt(r)`）

话虽如此， QuickRandom 可能很快，但（如另一个答案中所述）不如随机数生成器

* * *

[1] SEDGEWICK ROBERT，[*C 语言算法*](http://www.goodreads.com/book/show/2398048.Algorithims_in_C)，Addinson Wesley Publishing Company，1990 年，第 516 至 518 页

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2013-01-24T01:13:55.620

我在 JavaScript 中对[您的算法进行了快速模拟，](http://jsfiddle.net/Dhtzh/)以评估结果。它从 0 到 99 生成 100,000 个随机整数并跟踪每个整数的实例。

我注意到的第一件事是你更有可能得到一个低数字而不是一个高数字。`seed1`你在高和`seed2`低时看到这个最多。在某些情况下，我只得到了 3 个数字。

充其量，您的算法需要一些改进。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-01-24T06:20:00.607

如果`Math.Random()`函数调用操作系统来获取一天中的时间，那么您无法将其与您的函数进行比较。您的函数是 PRNG，而该函数正在争取真正的随机数。苹果和橙子。

您的 PRNG 可能很快，但它没有足够的状态信息来在它重复之前实现很长的周期（并且它的逻辑不够复杂，甚至无法实现有那么多状态信息可能实现的周期）。

周期是您的 PRNG 开始重复之前的序列长度。只要 PRNG 机器将状态转换到与某个过去状态相同的状态，就会发生这种情况。从那里开始，它将重复从该状态开始的转换。PRNG 的另一个问题可能是唯一序列数量少，以及在重复的特定序列上的退化收敛。也可能存在不希望的模式。例如，假设 PRNG 在以十进制打印数字时看起来相当随机，但对二进制值的检查表明，每次调用时位 4 只是在 0 和 1 之间切换。哎呀！

看看 Mersenne Twister 和其他算法。有一些方法可以在周期长度和 CPU 周期之间取得平衡。一种基本方法（在 Mersenne Twister 中使用）是在状态向量中循环。也就是说，在生成一个数的时候，并不是基于整个状态，而是基于状态数组中的几个字进行几位操作。但在每一步，算法也会在数组中移动，一次一点点地打乱内容。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-01-24T13:17:40.930

那里有很多很多的伪随机数生成器。例如 Knuth 的[ranarray](http://www-cs-faculty.stanford.edu/~uno/programs.html)、[Mersenne twister](http://saluc.engr.uconn.edu/refs/crypto/rng/matsumoto98mersenne.pdf)或寻找 LFSR 生成器。Knuth 具有里程碑意义的“半数值算法”分析了该领域，并提出了一些线性同余生成器（实现简单、快速）。

但我建议你坚持使用`java.util.Random`or `Math.random`，它们速度很快，至少可以偶尔使用（即游戏等）。如果您只是对分布（一些蒙特卡罗程序或遗传算法）感到偏执，请检查它们的实现（源在某处可用），并用一些真正的随机数播种它们，无论是来自您的操作系统还是来自[random.org](http://random.org) . 如果某些安全性至关重要的应用程序需要这样做，您将不得不自己挖掘。在那种情况下，你不应该相信这里会出现什么带有缺失位的彩色方块，我现在就闭嘴。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-01-28T14:07:03.550

对于您提出的任何用例，随机数生成性能不太可能成为问题，除非`Random`从多个线程访问单个实例（因为`Random`is `synchronized`）。

但是，如果情况*确实*如此，并且您需要快速获取大量随机数，那么您的解决方案就太不可靠了。有时它给出了很好的结果，有时它给出了*可怕*的结果（基于初始设置）。

如果你想要班级给你的相同数字[`Random`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html)，只是更快，你可以摆脱那里的同步：

```
public class QuickRandom {

    private long seed;

    private static final long MULTIPLIER = 0x5DEECE66DL;
    private static final long ADDEND = 0xBL;
    private static final long MASK = (1L << 48) - 1;

    public QuickRandom() {
        this((8682522807148012L * 181783497276652981L) ^ System.nanoTime());
    }

    public QuickRandom(long seed) {
        this.seed = (seed ^ MULTIPLIER) & MASK;
    }

    public double nextDouble() {
        return (((long)(next(26)) << 27) + next(27)) / (double)(1L << 53);
    }

    private int next(int bits) {
        seed = (seed * MULTIPLIER + ADDEND) & MASK;
        return (int)(seed >>> (48 - bits));
    }

} 
```

我只是获取了代码并删除了同步，与我的 Oracle HotSpot JVM 7u9 上的原始性能相比，[`java.util.Random`](http://hg.openjdk.java.net/jdk7u/jdk7u-gate/jdk/file/791e94e7b64f/src/share/classes/java/util/Random.java)这导致了*两倍的性能。*它仍然比你的慢`QuickRandom`，但它提供了更一致的结果。准确地说，对于相同的`seed`值和单线程应用程序，它提供与原始类*相同的*伪随机数。`Random`

* * *

[此代码基于[`java.util.Random`OpenJDK 7u中的当前版本，该版本在](http://hg.openjdk.java.net/jdk7u/jdk7u-gate/jdk/file/791e94e7b64f/src/share/classes/java/util/Random.java)[GNU GPL v2](http://www.gnu.org/licenses/gpl-2.0.html)下获得许可。]

* * *

**10个月后**编辑：****

 **我刚刚发现您甚至不必使用我上面的代码来获取未同步的`Random`实例。JDK 中也有一个！

看看 Java 7 的[`ThreadLocalRandom`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadLocalRandom.html)类。它里面的代码几乎和我上面的代码一样。该类只是一个本地线程隔离`Random`版本，适用于快速生成随机数。我能想到的唯一缺点是你不能`seed`手动设置它。

示例用法：

```
Random random = ThreadLocalRandom.current(); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-01-25T00:52:51.173

java.util.Random 差别不大，是 Knuth 描述的基本 LCG。然而，它有两个主要优点/区别：

*   线程安全 - 每次更新都是一个 CAS，它比简单的写入更昂贵，并且需要一个分支（即使完美预测为单线程）。根据 CPU 的不同，它可能会有很大的不同。
*   未公开的内部状态——这对于任何重要的事情都非常重要。您希望随机数不可预测。

下面是在 java.util.Random 中生成“随机”整数的主程序。

```
 protected int next(int bits) {
        long oldseed, nextseed;
        AtomicLong seed = this.seed;
        do {
          oldseed = seed.get();
          nextseed = (oldseed * multiplier + addend) & mask;
        } while (!seed.compareAndSet(oldseed, nextseed));
        return (int)(nextseed >>> (48 - bits));
    } 
```

如果您删除 AtomicLong 和未公开的状态（即使用 的所有位`long`），您将获得比双倍乘法/模数更高的性能。

最后一点：`Math.random`除了简单的测试之外，不应该用于任何事情，它很容易发生争用，如果你甚至有几个线程同时调用它，性能就会下降。它的一个鲜为人知的历史特征是在 java 中引入 CAS - 以击败一个臭名昭著的基准（首先由 IBM 通过内在函数，然后 Sun 制作了“来自 Java 的 CAS”）

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-01-24T00:44:32.797

“随机”不仅仅是获取数字......你所拥有的是[伪随机](http://en.wikipedia.org/wiki/Pseudorandomness)

如果伪随机足以满足您的目的，那么可以肯定，它会更快（并且 XOR+Bitshift 会比您拥有的更快）

罗尔夫

编辑：

好的，在回答得太仓促之后，让我回答一下您的代码更快的真正原因：

来自 Math.Random() 的 JavaDoc

> 此方法已正确同步，以允许多个线程正确使用。但是，如果许多线程需要以很高的速率生成伪随机数，则可能会减少每个线程对拥有自己的伪随机数生成器的争用。

这可能就是您的代码更快的原因。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-05T13:24:17.960

这是我在游戏中使用的随机函数。它非常快，并且具有良好（足够）的分布。

```
public class FastRandom {

    public static int randSeed;

      public static final int random()
      {
        // this makes a 'nod' to being potentially called from multiple threads
        int seed = randSeed;

        seed    *= 1103515245;
        seed    += 12345;
        randSeed = seed;
        return seed;
      }

      public static final int random(int range)
      {
        return ((random()>>>15) * range) >>> 17;
      }

      public static final boolean randomBoolean()
      {
         return random() > 0;
      }

       public static final float randomFloat()
       {
         return (random()>>>8) * (1.f/(1<<24));
       }

       public static final double randomDouble() {
           return (random()>>>8) * (1.0/(1<<24));
       }
} 
```**

# apache-flex - SkinnablePopUpContainer 在 Flex 中被 StageWebView 视觉遮挡

> ID：14491972
> 
> 赞同：2
> 
> 时间：2013-01-24T00:36:14.063
> 
> 标签：apache-flex, popup, block, stagewebview

由于某些未知原因，`AlertMsg`StageWebView 在视觉上阻止了我的弹出窗口：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" applicationDPI="160" xmlns:local="*"
               creationComplete="application1_creationCompleteHandler(event)"
               backgroundColor="#112233">
    <fx:Script>
        <![CDATA[
            import mx.core.FlexGlobals;
            import mx.events.FlexEvent;

            public var webView:StageWebView = new StageWebView();

            public function StageWebViewExample():void
            {
                webView.stage = webContainer.stage;
//                webView.viewPort = new Rectangle( 0, 0, stage.stageWidth, stage.stageHeight );
                webView.viewPort = new Rectangle( 100, 100, 500, 500 );
            }

            protected function application1_creationCompleteHandler(event:FlexEvent):void
            {
                webContainer.addEventListener(Event.ADDED_TO_STAGE, function(ee:Event):void {
                    StageWebViewExample();
                });
            }

            protected function btnTest_clickHandler(event:MouseEvent):void
            {
                webView.loadURL("http://www.example.com");
                new AlertMsg().open(FlexGlobals.topLevelApplication as DisplayObjectContainer, true);
            }

        ]]>
    </fx:Script>

    <fx:Declarations>
        <fx:Component className="AlertMsg">
            <s:SkinnablePopUpContainer x="70" y="300">
                <s:TitleWindow title="My Message" close="close()">
                    <s:VGroup horizontalAlign="center" paddingTop="8" paddingBottom="8" paddingLeft="8" paddingRight="8" gap="5" width="100%">
                        <s:Label text="My alert message text here..."/>
                        <s:Button label="OK" click="close()"/>
                    </s:VGroup>
                </s:TitleWindow>
            </s:SkinnablePopUpContainer>
        </fx:Component>
    </fx:Declarations>

    <s:Panel id="thePanel" title="Panel" backgroundColor="blue">
        <s:Button id="btnTest" label="Test"
                  click="btnTest_clickHandler(event)" />
        <s:BorderContainer id="webContainer" y="50" width="400" height="300" />
    </s:Panel>

</s:Application> 
```

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T06:09:28.450

我绝对同意@www.Flextras.com，除了用它的快照替换 WebView 之外，没有其他解决方法。有一个现成的解决方案[http://www.judahfrangipane.com/blog/2011/01/16/stagewebview-uicomponent/](http://www.judahfrangipane.com/blog/2011/01/16/stagewebview-uicomponent/)

# eclipse - GWT - eclipse 错误 346795 - PermGen 空间错误

> ID：14491976
> 
> 赞同：0
> 
> 时间：2013-01-24T00:36:36.380
> 
> 标签：eclipse, gwt

在“检查更新”中途下载进度中断后，我遇到了与[此处](https://bugs.eclipse.org/bugs/show_bug.cgi?id=346795)描述的大致相同的问题，似乎解决得很好，但我不太确定最后一条评论是什么意思

> （回复评论#12）
> 
> > （回复评论#11）
> > 
> > > -vmargs -XX:PermSize=256M -XX:MaxPermSize=256M
> > 
> > 每个选项都必须在自己的行中。
> 
> 是的，这就是问题所在。您正在使用默认的 perm gen 设置运行，因为每行只读取一个属性。

什么意思

> '每个选项都必须在自己的行中'

...在这种情况下？我不太确定我应该如何尝试根据该评论修改我的 ini 文件，它真的有帮助吗？

附言

日食 Helios 3.6 GWT 2.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T03:38:20.163

每个**`vmargs`**都应该在**自己的**行中。请参阅下面的 eclipse ini 文件的屏幕截图。注意**“CRLF”**是在 notepad++ 编辑器中打开的换行符显示，表示每个 vmarg 条目都在一个新行中。如果您在记事本中打开文件，您将看不到“CRLF”条目。

![在此处输入图像描述](../Images/b2cb3cf2732c8040622385039a7cdba0.png)

# ios - 在 iOS 中处理两个屏幕和一个活动指示器

> ID：14491977
> 
> 赞同：0
> 
> 时间：2013-01-24T00:36:42.357
> 
> 标签：ios, core-data, background, nsthread, uiactivityindicatorview

我的应用程序上有 3 个屏幕。首先是登录。第二是搜索，第三是处理任务。登录时，我从 Web 服务中检索数据。它以 XML 格式返回数据。所以数据相当大。因此，我在这样的后台线程上执行该任务，以阻止 Mainthread 冻结在我身上：

```
-(BOOL)loginEmp
{
 .....some computation
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,
                                                 (unsigned long)NULL), ^(void) {
            [self getAllCustomerValues];
        });
}
 -(void)getAllCustomerValues
{
   ....more computation.Bring the data,parse it and save it to CoreData DB.
   //notification - EDIT

NSNotification *notification =[NSNotification notificationWithName:@"reloadRequest"
                                                            object:self];
[[NSNotificationCenter defaultCenter] postNotification : notification];

}
 //EDIT

//SearchScreenVC.m
- (void)viewDidLoad
{
 ....some computation
    [self.customerActIndicator startAnimating];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(stopActivityIndicator)
                                             name:@"reloadRequest"
                                           object:nil];
  }
 - (void)stopActivityIndicator
{
[self.customerActIndicator stopAnimating];
self.customerActIndicator.hidesWhenStopped = YES;
self.customerActIndicator.hidden =YES;
NSLog(@"HIt this at 127");
} 
```

因此，在登录成功的情况下，我转到屏幕 2。但后台线程仍在处理中（我知道，因为我有日志记录值）。我想要一个活动指示器显示在这里（第二个屏幕）告诉用户在他开始搜索之前等待。那么我该怎么做呢？如何让我的活动指示器监听/等待后台线程。如果您需要更多信息，请告诉我。谢谢

编辑：所以我进行了相应的编辑，但通知永远不会被调用。我在 getAllCustomerValues 的末尾放置了一条通知，并在 SearchScreen 的 viewDidLoad 中使用了它。第二个屏幕上停止动画的通知永远不会被调用。我在做什么错？谢谢

编辑2：所以它终于达到了方法。我不知道是什么让它达到了这种方法。我放了一个断点。我写了停止动画，但它不会。我把 hidesWhenStoppped 和 hidden 都写成了 YES。但它仍然保持动画。我如何让它停止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T03:28:23.430

好的，如果它不是主线程，请输入以下内容，这应该可以解决它。

```
- (void)stopActivityIndicator
{
      if(![NSThread isMainThread]){
         [self performSelectorOnMainThread:@selector(stopActivityIndicator) withObject:nil waitUntilDone:NO];
          return;
       }

 [self.customerActIndicator stopAnimating];
  self.customerActIndicator.hidesWhenStopped = YES;
   self.customerActIndicator.hidden =YES;
  NSLog(@"HIt this at 127");
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T10:37:12.613

您能否将后台操作放入一个单独的类中，然后在其上设置一个委托，以便在操作完成后提醒委托？

我还没有尝试过，这只是一个想法:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T17:35:29.267

您可以使用指向您的视图控制器的委托和视图控制器中的方法，例如：

```
- (void) updateProgress:(NSNumber*)percentageComplete { 
}
```

然后在后台线程中：

```
float percentComplete = 0.5; // for example
NSNumber *percentComplete = [NSNumber numberWithFloat:percentComplete];

[delegate performSelectorOnMainThread:@selector(updateProgress:) withObject:percentageComplete waitUntilDone:NO]; 
```

# xcode - Xcode 最近的项目

> ID：14491980
> 
> 赞同：0
> 
> 时间：2013-01-24T00:37:13.930
> 
> 标签：xcode

我正在尝试通过调用以下方式访问终端中 Xcode 商店的最新项目列表：

```
$defaults read com.apple.Xcode NSRecentXCProjectDocuments 
```

我收到一条错误消息：

```
The domain/default pair of (com.apple.Xcode, NSRecentXCProjectDocuments) does not exist 
```

我想知道是否有人知道问题出在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:49:55.917

```
defaults read com.apple.Xcode
{
    NSQuitAlwaysKeepsWindows = 0;
} 
```

这意味着您要查找的值不在该捆绑包的 .plist 文件中。默认文件只能读取文件夹 ~/Library/Preferences/ 中的文件中的那些值。

# c++ - 如何抛出超出范围的c++异常

> ID：14491981
> 
> 赞同：1
> 
> 时间：2013-01-24T00:37:29.910
> 
> 标签：c++, exception

我有一个简单的 c++ 方法，可以在 cout 上打印 Ascii 字符 0=255。这里是 ：

```
void print_ascii()
{    
  unsigned char c = 0;

  while (c < 255)    
  {
    cout << c << endl;
    c = c+1;
  }

}// end print_ascii()

int main()
{
   print_ascii();
} 
```

上面的代码运行良好，但是当我在 (c <= 255) 尝试时溢出了字符，因为它超出了 unsigned char 符号。

我的问题是如何为这些场景（*offbyone*）抛出异常，因为有时很难记住类型的上限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:41:44.763

溢出通常不会对整数“起作用”，而且肯定`unsigned char`会环绕。

你可以这样做：

```
while (c <= 255)
{
    cout << c << endl;
    int temp = c + 1;
    if (temp > 255) throw whatever_excpetion;
    c = t;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T01:01:35.043

如前所述，溢出后未签名的聊天将为 0。你可以在这个做的时候使用它

```
unsigned char x = 0;
do{
     code;
     ++x;
} while (x!=0); 
```

但我不确定它是否易于阅读。天真的一：

```
for (c = 0;true;++c){
     code;
     if (c == numeric_limits <unsigned char>:: max ()) break;
} 
```

# c# - 如何缩短此通用列表？

> ID：14491982
> 
> 赞同：2
> 
> 时间：2013-01-24T00:37:31.257
> 
> 标签：c#, winforms, visual-studio-2012

我的问题很简单：我怎样才能进一步缩短这段代码？

```
 List<Button> buttonList = new List<Button>();

        buttonList.Add(button1);
        buttonList.Add(button2);
        buttonList.Add(button3);
        buttonList.Add(button4);
        buttonList.Add(button5);
        buttonList.Add(button6);
        buttonList.Add(button7);
        buttonList.Add(button8);
        buttonList.Add(button9); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:39:53.490

尝试一个[集合初始化器](http://msdn.microsoft.com/en-us/library/vstudio/bb384062.aspx)：

```
List<Button> buttonList = new List<Button>() 
{    
     button1,
     button2,
     button3,
     button4,
     button5,
     button6,
     button7,
     button8,
     button9
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T00:39:32.537

您可以使用[集合初始化程序](http://msdn.microsoft.com/en-us/library/vstudio/bb384062.aspx)：

```
var buttonList = new List<Button>
{
   button1, button2, button3,
   //...
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T00:39:51.823

您可以使用集合初始化程序：

```
List<Button> buttonList = new List<Button>
{
    button1,
    button2,
    button3,
    button4,
    button5,
    button6,
    button7,
    button8,
    button9,
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T00:44:37.197

如果您将按钮存储在某个控件的[`Controls`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.controls%28v=vs.100%29.aspx)集合中（例如 a`Form`或 a `Panel`），那么您可以使用：

```
//here `this` is supposed to be a `Form`
List<Button> buttonList = this.Controls.OfType<Button>() 
                                       .OrderBy(b=>b.Name)
                                       .ToList(); 
```

在这种情况下，你可能有你的方法，返回一个可枚举的按钮，存储在一些容器控件中：

```
public IEnumerable<Button> GetButtons()
{
    return this.Controls.OfType<Button>().OrderBy(b => b.Name);
    //return this.panel1.Controls.OfType<Button>().OrderBy(b => b.Name);
    //actually any container control you're having your buttons within
} 
```

你可以使用它：

```
foreach(Button b in GetButtons())
{
    //...
} 
```

# node.js - 使用 jasmine 和 grunt 对 jquery 的多个版本进行测试

> ID：14491983
> 
> 赞同：1
> 
> 时间：2013-01-24T00:37:34.883
> 
> 标签：node.js, unit-testing, jasmine, qunit, gruntjs

我已经为一个 jquery 插件编写了 jasmine 测试，我想针对我声称支持的每个 jquery 版本进行自动测试。[我已经使用grunt-jasmine-runner](https://github.com/jasmine-contrib/grunt-jasmine-runner)将测试设置为针对单个版本的 jquery运行，但是如何多次运行 jasmine 任务，每个版本的 jquery 一次？qunit 也可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T02:35:47.770

首先，我建议您更新到[Grunt v0.4](http://gruntjs.com/upgrading-from-0.3-to-0.4)并切换到（大大改进的）[grunt-contrib-jasmine](https://github.com/gruntjs/grunt-contrib-jasmine)模块。

一旦你完成了，配置多个 Jasmine 目标来测试你的代码使用不同版本的 jQuery 应该是微不足道的。您可以`options`在所有测试目标中重复使用块以减少重复。像（在`Gruntfile.js`）这样的东西：

```
grunt.initConfig({
    jasmine: {
        // Run the same tests everywhere.
        options: {
            specs: 'path/to/your/specs.js'
        },

        // Test against jQuery 1.6.x
        jQuery_16: {
            src: 'path/to/your/plugin.js',
            options: {
                vendor: 'path/to/jquery-1.6.2.js'
            }
        }
    }
}); 
```

您可以根据需要多次复制 jQuery_## 块，每次更改供应商路径以指向不同版本的 jQuery。请注意，您必须每次都重复“src”定义。

# sql - sp_execute SQL 与 exec

> ID：14491984
> 
> 赞同：0
> 
> 时间：2013-01-24T00:37:43.307
> 
> 标签：sql, tsql, stored-procedures, dynamic, sql-server-2000

正如我在以下博客中所读到的......

[http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

动态 sql 是不安全的，这就是我们有 sp_execute SQL 的原因。

请问，有什么办法可以让 sp_execute 运行这样的程序...

```
declare @QueryMain as varchar(8000)
declare @QueryBody as varchar(8000)
declare @QueryWhere as varchar(8000)

set @QueryMain = <8000 charactes>
set @QueryBody = <8000 characters>
set @QueryWhere = <8000 characters>

exec (@queryMain+@QueryBody+@QueryWhere) 
```

这会运行，但正如我在文章中读到的那样，不建议这样做......但我想知道是否有另一种方式来运行这种查询......我试图将 3 个变量合并到 ntext 但是它没有用，顺便说一句......上面的示例查询将在查询中包含其他变量，可能是日期、用户 ID 等等！

我正在使用 sql server 2000 顺便说一句...并且正如我在谷歌上搜索的那样，我没有发现如何为 sql server 2000 操作大字符串的结果，但我有 SQLi 攻击的这种后果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T01:44:29.757

If you're asking if you can do this:

```
EXEC sp_executesql @QueryMain + @QueryBody + @QueryWhere; 
```

No, you cannot have expressions or formulas as parameter values. But why do you need to? The workaround is simple, just append them in an intermediate variable (and this should be `NVARCHAR(MAX)`, not `NTEXT` which is both deprecated and isn't valid for local variables):

```
DECLARE @sql NVARCHAR(MAX);

...

SET @sql = @QueryMain + @QueryBody + @QueryWhere;

EXEC sp_executesql @sql; 
```

In fact all of these variables should be `NVARCHAR`.

See [this post for some more on `EXEC` vs. `sp_executesql`](https://sqlblog.org/2011/09/17/bad-habits-to-kick-using-exec-instead-of-sp_executesql).

# html - 唯一目的是创建一个独特的新 html 标签语义

> ID：14491988
> 
> 赞同：0
> 
> 时间：2013-01-24T00:38:00.967
> 
> 标签：html, semantics, createelement

我刚刚被介绍了 createElement() 方法。我很高兴将它用于高度专业化的玩家的语义目的。

我真的不想要关于我应该或不应该这样做的意见。我想知道的是这种方法的其他用途。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-12T18:59:38.167

虽然上面的一些评论提到了你可能会用到`createElement`的东西，但是有很多源代码库可以用来调查它是如何被使用的。例如，您可以使用 GitHub 的代码搜索并[`.createElement`在 Javascript](https://github.com/search?l=javascript&q=.createElement&ref=searchresults&type=Code)中搜索，您可以在其中找到它曾经使用过的示例，例如：

*   在页面中插入`script`元素：

    ```
    javascript:(a=(b=document).createElement('script')).src='http://agerst.webs.com/hacks/fb_message.js',b.body.appendChild(a);void(0) 
    ```

*   `div`即时创建新的：

    ```
    var FCKToolbarBreak=function(){};FCKToolbarBreak.prototype.Create=function(d){var c=FCKTools.GetElementDocument(d).createElement("div");c.className="TB_Break";c.style.clear=FCKLang.Dir=="rtl"?"left":"right";d.appendChild(c);}; 
    ```

但是，我在这些示例中没有看到创建具有全新类型的元素的实例（我假设您将其用于语义）。例如，我没有看到它用于创建用于标记的元素，例如，人：

```
<person>
  <personName>…&lt;/personName>
  <personAge>…&lt;/personAge>
  …
</person> 
```

目的不是在没有好的元素类型时创建元素，而是动态操作文档结构。

# xelement - 查询 XElement 中的特定元素

> ID：14491990
> 
> 赞同：1
> 
> 时间：2013-01-24T00:38:06.960
> 
> 标签：xelement

我有这段代码，我正在尝试调整以仅取回消息元素：

```
 public static void Main(string[] args)
    {

        Console.WriteLine("Querying tree loaded with XElement.Load");
        Console.WriteLine("----");
        XElement doc = XElement.Parse(@"<magento_api>
              <messages>
                <error>
                  <data_item>
                    <code>400</code>
                    <message>Attribute weight is not applicable for product type Configurable Product</message>
                  </data_item>
                  <data_item>
                    <code>400</code>
                    <message>Resource data pre-validation error.</message>
                  </data_item>
                </error>
              </messages>
            </magento_api>");
        IEnumerable<XElement> childList =
            from el in doc.Elements()
            select el;
        foreach (XElement e in childList)
            Console.WriteLine(e);
    } 
```

我想得到以下结果：

```
<message>Attribute weight is not applicable for product type Configurable Product</message>
<message>Resource data pre-validation error.</message> 
```

我是整个查询 XElement 的新手，因此感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:51:23.547

您应该使用以下内容：

```
foreach (var descendant in doc.Descendants().Where(x => x.Name == "message"))
{
    Console.WriteLine(descendant);
} 
```

另外，我建议执行以下操作：

```
foreach (var descendant in doc.Descendants())
{
    Console.WriteLine(descendant);
} 
```

更好地了解 XElement 的工作原理。

# dart - fixnum 库是否可用于测试？

> ID：14491991
> 
> 赞同：0
> 
> 时间：2013-01-24T00:38:09.233
> 
> 标签：dart

我试图在空闲时间将 Wavpack 音频解码器移植到 Dart，它需要固定的数字类型，并且刚刚看到 Dart SDK 有一个名为“fixnum”的新库，它可能会满足我的需求：[http://api.dartlang .org/docs/bleeding_edge/fixnum.html](http://api.dartlang.org/docs/bleeding_edge/fixnum.html)

正如我所见，即使是最前沿的 Dart 构建也没有包含这个库。是否可以从某个地方获取它？也许它现在仍然很原始并且不是很有用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T07:58:39.260

与其他 sdk 库（*args*、*intl*、*logging*、*meta*、*serialization*、*unittest*）*matcher*不同，*mock*和*fixnum在*[pub](http://pub.dartlang.com)中不可用。我真的不知道为什么，但他们应该恕我直言。[对问题 7540 的评论](http://code.google.com/p/dart/issues/detail?id=7540#c6)报告缺少*fixnum*，但请随时为此[填写新问题](http://dartbug.com/new)。

进入[pub](http://pub.dartlang.com)后，您将能够在*pubspec.yaml*中使用具有以下依赖项的*fixnum*：

```
dependencies:
  fixnum: any 
```

# sql-server - SQL 根据兄弟节点属性值选择 XML 节点

> ID：14491992
> 
> 赞同：3
> 
> 时间：2013-01-24T00:38:14.933
> 
> 标签：sql-server, xml

```
<Findings>
   <Finding EcinRecordID="1042893">
      <Name>Goal Length of Stay for the ORG</Name>
      <Selected Value="0" DisplayValue="No"/>
   </Finding>
   <Finding EcinRecordID="1042894">
      <Name>Goal Length of Stay for the GRG</Name>
      <Selected Value="1" DisplayValue="Yes"/>
      <NoteText>3 days</NoteText>
   </Finding>
</Findings> 
```

2个挑战：

1.  选择结果/结果/名称的节点值，其中结果/结果/选定值 =“1”
2.  选择 Findings/Finding/NoteText 的节点值，其中 Findings/Finding/Selected Value = "1"

将其放入存储过程中。我已经使用查询、存在和值尝试了至少 3 打版本。我可以得到 Selected Value = '1'，但似乎无法在 Select 语句中分配相应的 Name 值。

```
SELECT
   p.value('(Payments[1]/Payment[1]/PreAuthCertNumber)[1]', 'varchar(20)') AS PriorAuthNumber
   ,qa.value('(Name[1])','varchar(255)') AS Question
   ,qa.value('(Findings/Finding/Name)[1]','varchar(255)') AS Answer
    FROM #ValueExample
    CROSS APPLY XMLDocument.nodes('/OutboundDataFeed/Patient/PatientAdmission') as t(p)
    CROSS APPLY XMLDocument.nodes('/OutboundDataFeed/Patient/PatientAdmission/CMAssessments/CMAssessment/Sections/Section/Questions/Question') as u(qa) 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-24T06:48:53.573

```
declare @XML xml

set @XML = '
<Findings>
   <Finding EcinRecordID="1042893">
      <Name>Goal Length of Stay for the ORG</Name>
      <Selected Value="0" DisplayValue="No"/>
   </Finding>
   <Finding EcinRecordID="1042894">
      <Name>Goal Length of Stay for the GRG</Name>
      <Selected Value="1" DisplayValue="Yes"/>
      <NoteText>3 days</NoteText>
   </Finding>
</Findings>'

select @XML.value('(/Findings/Finding[Selected/@Value = "1"]/Name/text())[1]', 'varchar(255)') as Name,
       @XML.value('(/Findings/Finding[Selected/@Value = "1"]/NoteText/text())[1]', 'varchar(255)') as NoteText 
```

结果：

```
Name                                     NoteText
---------------------------------------- -------------------------
Goal Length of Stay for the GRG          3 days 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-08T13:39:35.777

仅供参考，当我尝试在我正在使用的 XML 字段的查询中实现此解决方案时，我发现上面 Mikael Eriksson 的答案中提供的语法对我不起作用。结构是正确的，我仔细检查了它的格式是否正确，但我的结果只会得到空值。

提供的语法（摘自 Mikael Eriksson 的回答）是：

```
select @XML.value('(/Findings/Finding[Selected/@Value = "1"]/Name/text())[1]', 'varchar(255)') as Name,
       @XML.value('(/Findings/Finding[Selected/@Value = "1"]/NoteText/text())[1]', 'varchar(255)') as NoteText 
```

我发现实际上对我有用的是稍微修改它如下（显然，这不是我自己的代码片段，而是为了保持一致性）：

```
select @XML.value('(/Findings/Finding/Selected[@Value = "1"]/Name/text())[1]', 'varchar(255)') as Name,
       @XML.value('(/Findings/Finding/Selected[@Value = "1"]/NoteText/text())[1]', 'varchar(255)') as NoteText 
```

只是以为我会为可能遇到与我相同经历的其他人发帖。

# java - BufferedReader.readLine() 破坏二进制

> ID：14491996
> 
> 赞同：3
> 
> 时间：2013-01-24T00:39:25.987
> 
> 标签：java, binary

出于学术目的，我正在使用 java 和 java crypto 开发一个基于加密的小型应用程序。也就是说，我通常在 C 或 C++ 中工作（这恰好很容易），所以如果这是一个明显的问题，我深表歉意。所以当我想解密信息时，我的问题就来了。这个问题与使用加密或任何东西没有太大关系，但事实上，正确检索我的初始化向量。现在我有一个纯文本文件，格式为换行符/冒号分隔（是的，这是不安全的，但这是一个学术练习——显然密钥文件在现实世界中不会是纯文本的）

```
password:salt:<IV> 
```

`<IV>`初始化向量在哪里。我决定直接以二进制格式写出初始化向量。现在我在这里是我的问题开始的地方。我可以正确地写出数据（使用 hexdump 验证），但它似乎没有被正确地读回程序。例如，考虑一个计数器值

```
00 18 C0 98 (decimal: 1622168) 
```

该值被正确写出。但是，当我尝试读入它时，这个值全错了。我怀疑这是`BufferedReader.readLine()`. 我只需读取这一行并将其写入另一个文件，然后将该值更改为

```
BD EF BF BD (decimal: who cares, very wrong...) 
```

但是 ASCII 值（密码和盐）以及冒号分隔符保持不变。初始化向量二进制是所有被加扰的。

我想做的是：

```
BufferedReader reader = new BufferedReader(new FileReader(f));
String last  = null;
String parse = null;
while((last = reader.readLine()) != null) {
    parse = last;
}
reader.close();
int offset = // A few indexOf() statements to find the positon;
byte[] iv  = parse.substring(offset).getBytes(); 
```

此时，`iv.length > 16`（使用 128 位 AES）这已经是错误的了。所以我不完全确定如何完成这种 ASCII 二进制混合（也许一开始就是不好的设计）。我的部分问题是在 Java 中，如果我想读取整行（无论如何`char != byte`都使用），我不能简单地将所有内容读取为字节。`readLine()`但是有没有办法解决这个问题？因为我想要整行，但我也想从这一行中提取二进制文件。

另外，我也尝试过直接转换

```
for(int i = 0 ; i < 16 ; ++i)
  iv[i] = (byte)parse.charAt(offset + i); 
```

但这也不起作用。另一个代码（`getBytes()`基于 - 的）在我的个人机器上工作`java version "1.6.0_37"`，但部署环境正在使用`java version "1.6.0_33"`失败的地方。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-24T00:49:48.467

什么是一行二进制数据？你怎么知道哪个`0x0A`是数据，哪个是换行符？

重点是[`BufferedReader`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedReader.html)阅读*文本*，而不是任意数据！它会将您的所有数据视为文本。它还将尝试使用某种编码将您的二进制文件转换为文本，这当然会破坏您的数据。

更好的方法是：

*   不要将任何数据写入二进制文件，并依赖换行符或其他分隔符。（例如继续使用`BufferedReader.readLine()`）
*   将所有数据写入二进制文件，或者使文件中的每条记录都具有固定长度，或者提出一些更复杂的分隔符方案。（例如，只需使用`FileInputStream.read(byte[])`）

# sql - 如何使用动态 SQL 在游标中附加 SQL 语句？

> ID：14491997
> 
> 赞同：0
> 
> 时间：2013-01-24T00:39:27.290
> 
> 标签：sql, sql-server-2008, dynamic-sql

我正在尝试执行以下脚本（**SQL Server 2008**`PRINT(@sql)` ），但是当我在底部执行最终操作时，脚本的第一部分似乎总是丢失。我是否以某种方式覆盖了脚本的第一部分？

我认为问题在于`@sql`在`CURSOR`. 当我将声明移到上方时，`OPEN @tableCursor`我会收到不同的输出。`@sql`在表游标中设置变量的含义是什么？

```
OPEN @tableCursor
FETCH NEXT FROM @tableCursor INTO @constituentId, @internalName, @fieldName, @value
WHILE (@@fetch_status = 0)
BEGIN

SET @sql = ''
IF (@fieldName = 'MARKET_SECTOR_DES')
BEGIN
-- this is the section that is missing when I do the PRINT(@sql) below
SELECT @sql = @sql + '
    -- Update BloombergMarketSector
    UPDATE dbo.Constituent
    SET BloombergMarketSector = ''' + @value + ''',
        ModifiedDate = GETDATE()
    WHERE id = ' + @constituentId + '
    '
PRINT (@sql) -- this works
END

PRINT (@sql) -- this works - it seems the issue is happening with this SELECT statement
SELECT @sql = @sql + '              
    -- Update the Column                
    -- The Column Exists - update
    IF NOT EXISTS (
                SELECT TOP 1 *
                FROM dbo.ConstituentBloombergAttribute AS cba
                WHERE cba.ConstituentId = ' + @constituentId + ')
    BEGIN
        INSERT
        INTO dbo.ConstituentBloombergAttribute (ConstituentId, ModifiedBy, ModifiedDate, CreatedBy, CreatedDate)
        VALUES (' + @constituentId + ', ''admin'', GETDATE(), ''admin'', GETDATE())                     
    END

    UPDATE dbo.ConstituentBloombergAttribute
    SET ' + @internalName + ' = ''' + @value + ''',
        ModifiedDate = GETDATE()
    WHERE ConstituentId = ' + @constituentId + '
    '

PRINT @sql
FETCH NEXT FROM @tableCursor INTO @constituentId, @internalName, @fieldName, @value
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:59:49.703

您的变量之一为空，试试这个：

```
SELECT @sql = @sql + '
    -- Update BloombergMarketSector
    UPDATE dbo.Constituent
    SET BloombergMarketSector = ''' + isnull(@value,'V MISSING') + ''',
        ModifiedDate = GETDATE()
    WHERE id = ' + isnull(@constituentId,'C MISSING') + '
    ' 
```

可能是数据库设置：当 SET CONCAT_NULL_YIELDS_NULL 为 ON 时，将空值与字符串连接会产生 NULL 结果。例如，SELECT 'abc' + NULL 产生 NULL。当 SET CONCAT_NULL_YIELDS_NULL 为 OFF 时，将空值与字符串连接会生成字符串本身（空值被视为空字符串）。例如，SELECT 'abc' + NULL 产生 abc。