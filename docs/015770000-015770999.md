# StackOverflow 问答 15770000-15770999

# jquery - 检测由邮政编码查找自动填充的输入字段中的值变化

> ID：15770000
> 
> 赞同：2
> 
> 时间：2013-04-02T17:03:46.343
> 
> 标签：jquery, validation

[我在我的网站 ( https://www.postcodeanywhere.co.uk](https://www.postcodeanywhere.co.uk) )上使用邮政编码查找服务。该脚本为我提供了一个接受邮政编码、地址等的输入字段，然后显示适当的结果。一旦我选择了正确的地址，它就会自动填充我确定的剩余输入字段（门牌号、街道等）。

如果填写正确，我想验证这些字段（在其右侧显示一个图标），但问题是它没有检测到值更改。如果我再次在填充的输入字段内单击，它确实会开始验证。

我尝试了 .change()、.bind()、keyup() 和其他事件，但无法让它工作。还有其他想法吗？

更新：这是代码：

```
$('#postcode').bind('blur', function(){
   validatePostCode();
});

function validatePostCode() {
  var postCode = $('#postcode').val();

  if( !alphaNumericRegex.test(postCode) ) {
    $('#postCodeWrap').find('.errorMessage').html('Must contain six characters.);
    $('#postCodeWrap').find('.validationSuccess').hide();
    $('#postcode').css('background', 'rgb(242, 222, 222)');
    $('#postcode').addClass('errorVisible');
    return false;
  } else {
    $('#postCodeWrap').find('.validationSuccess').show();
    $('#postCodeWrap').find('.errorMessage').html('');
    $('#postcode').css('background', '#FFFFFF');
    $('#postcode').removeClass('errorVisible');
    return true;
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:06:49.713

当使用 JS 以编程方式更改值时，不会触发任何事件。当第一个字段更改时，您可以自己触发事件：

```
$('#first-field').on('change', function() {
    $('.the_rest_of_my_fields').trigger('change');
}); 
```

# twitter-bootstrap - Bootstrap 导航栏无法打开或不会关闭

> ID：15770001
> 
> 赞同：0
> 
> 时间：2013-04-02T17:03:46.977
> 
> 标签：twitter-bootstrap, navbar

我在我的骨干项目中使用引导程序。我只（目前）使用“经典”响应式导航栏，当您缩小浏览器或使用一部手机进入时，您会看到一个按钮，这会扩展响应式菜单，如果您有大屏幕，它会看到您的典型菜单。

像[http://twitter.github.com/bootstrap/components.html](http://twitter.github.com/bootstrap/components.html)（您可以在顶部菜单中看到文本，但如果您缩小浏览器屏幕，您会看到底部）

我在移动/低分辨率/等的打开/关闭时刻遇到问题。如果我在看到缩小版本时按下打开菜单，有时它不会打开菜单，或者有时它不会关闭菜单。有时关闭菜单并重新打开....

我不搜索具体的响应，但是，我需要一些指导来找到 CSS 问题。¿ 当我在减少/响应菜单中按下导航栏底部时，我在哪里看到发生了什么？我不知道:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T22:02:04.790

I couldn't tell you for sure without looking at code but if you are not properly removing views from the DOM you could have multiple bindings to the click on the navbar. So the view may not be showing but events are still being fired. For example you could be showing the navbar and use it to navigate the page and somewhere along the line the navbar is recreated binding yet another event to it even though only one is showing. You need to make sure to unbind all events for your views. A good article to solve this is:

[Backbone View Managment](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/)

Just a thought but can't really know without looking at code.

# string - matlab中的字符串匹配

> ID：15770002
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:03:51.810
> 
> 标签：string, matlab, computer-vision, signals, signal-processing

我有两个短（S，大小为 1x10）和很长（L，大小为 1x1000）字符串，我将在 L 中找到与 S 匹配的位置。

![在此处输入图像描述](https://i.stack.imgur.com/2FnWj.png)

在这个特定的匹配中，我只是想匹配 S 中的一些特定字符串（黑色字符串）。matlab中是否有任何函数或方法可以匹配某些特定的字符串（例如S中的1、5、9的字符串编号）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:31:34.863

如果我正确理解您的问题，您希望找到`L`包含与某些位置相同的字母（字符）的子字符串`S`（假设由 array 给出`idx`）。正则表达式在这里是理想的，所以我建议使用`regexp`.

在正则表达式中，点 ( `.`) 匹配任何字符，花括号 ( `{}`) 可以选择指定所需出现的次数。例如，要匹配长度为 6 的字符串，其中第二个字符是“a”，第五个字符是“b”，我们的正则表达式可以是以下任何语法：

```
.a..b.
.a.{2}b.
.{1}a.{2}b.{1} 
```

这些都是正确的。所以我们先构造一个正则表达式模式：

```
in = num2cell(diff([0; idx(:); numel(S) + 1]) - 1);  %// Intervals
ch = num2cell(S(idx(:)));                            %// Matched characters
C = [in(:)'; ch(:)', {''}];
pat = sprintf('.{%d}%c', C{:});                      %// Pattern for regexp 
```

现在剩下的就是喂食`regexp`所需`L`的模式：

```
loc = regexp(L, pat) 
```

瞧！

### 例子

让我们假设：

```
S = 'wbzder'
L = 'gabcdexybhdef'
idx = [2 4 5] 
```

首先我们建立一个模式：

```
in = num2cell(diff([0; idx(:); numel(S) + 1]) - 1);
ch = num2cell(S(idx(:)));
C = [in(:)'; ch(:)', {''}];
pat = sprintf('.{%d}%c', C{:}); 
```

我们得到的模式是：

```
pat =
    .{1}b.{1}d.{0}e.{1} 
```

显然我们可以在 中添加美化这种模式的代码`.b.de.`，但这确实是不必要的优化（`regexp`可以处理前者）。

在我们这样做之后：

```
loc = regexp(L, pat) 
```

我们得到以下结果：

```
loc =
     2     8 
```

似乎是正确的。

# php - 相同的 php 变量，不同的内容。如何区分？

> ID：15770005
> 
> 赞同：0
> 
> 时间：2013-04-02T17:03:58.060
> 
> 标签：php, opencart

我的 Opencart 商店和 php 变量有点卡住了。事情是这样的：

每个产品都有`<?php echo $product['name']; ?>`名称（以及类似的拇指、价格等）。我有列出多个产品的页面。例如，我想为每个产品添加一些悬停 div，其中包含名称、拇指、价格等。

但是，当我将相应的脚本添加到我的模板中时，`<div id="hidden"><?php echo $product['name']; ?></div>`它会为我提供第一个产品的名称，而不是我切换的那个特定产品的名称。

如果变量完全相同，我将如何让它显示特定元素的数据？我将不胜感激任何提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:58:36.203

你的意思是你想在你的每个产品中添加一个事件悬停？也许你可以试试这个，例如：

```
 <?php 
  while($product = mysql_fetch_array($query))
  { ?>
  <div class="thumb-prod">
    <img src="img/<?php echo $product['image'] ?>" />
    <div class="name-prod">
        <?php echo $product['name'] ?>
    </div>
  </div>
  <?php } ?> 
```

现在，需要最新的 jquery 并添加这个脚本：

```
<script>
   $(document).ready(function(){
      jQuery('.thumb-prod').hover(function(){
           var name = $(this).find('.name-prod');
           name.show();
      }, function(){
           var name = $(this).find('.name-prod');
           name.hide();
      });
   });
</script> 
```

# django - 数据未存储在数据库django中

> ID：15770008
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:03.297
> 
> 标签：django, django-models, django-templates, django-views

我的第一个问题是数据没有进入数据库。它没有显示任何错误，但也没有存储。我的第二个问题是我正在使用下拉列表中的查询集预先填充表单字段，但它向我显示 id（主键），我想显示其他字段。我该怎么做？

我的观点

```
def payment(request):
    #form = jobpostForm_first()
    #country_list = Country.objects.all()
    if request.POST:
        form = jobpostForm_detail(request.POST)

        if form.is_valid():
            if '_Submit' in request.POST:
              form.save()
              return HttpResponseRedirect('/thanks/')
    else:
        form = jobpostForm_detail()
        #form.fields['country'].queryset = Country.objects.all()

    c = {}
    c.update(csrf(request))

    return render_to_response('portal/display.html',{
        'form':form
    },context_instance=RequestContext(request)) 
```

我的模型：

```
class jobpostForm_detail(ModelForm):
    class Meta:

        model = payment_detail
        fields = ('payment_type','country')

    def __init__(self, *args, **kwargs):
        super(jobpostForm_detail, self).__init__(*args, **kwargs)

        self.fields['country'].queryset = Country.objects.all()
        self.fields['payment_type'].queryset = Payment_types.objects.all()

        self.helper = FormHelper()
        self.helper.form_class = 'horizontal-form'
        self.helper.form_id = 'id-jobpostform'
        self.helper.form_class = 'blueForms'
        self.helper.form_method = 'post'

        self.helper.add_input(Submit('submit_addcontent', 'Pay'))

        super(jobpostForm_detail, self).__init__(*args, **kwargs) 
```

我的模板：

```
<form method="post" action="/portal/next/post/" class="blueForms" id="id-jobpostform">

    {% csrf_token %}

    {% crispy form %}

    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:17:52.310

你为什么要`"_Submit"`在你的视图中检查？

我建议您阅读[如何在视图中使用表单](https://docs.djangoproject.com/en/dev/topics/forms/#using-a-form-in-a-view)，尤其是评论：

```
...
def contact(request):
    if request.method == 'POST': # If the form has been submitted...
        form = ContactForm(request.POST) # A form bound to the POST data
        if form.is_valid(): # All validation rules pass
            # Process the data in form.cleaned_data
... 
```

在您的情况下，您只需要`form.save()`在`form.is_valid()`

给你的问题：你能在你的表单类中解释一下这段代码吗？错字，我猜？

```
widgets = {

        }),

} 
```

# python - 创建一个函数来生成所有排名高于 base_card 的卡的列表？

> ID：15770009
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:03.390
> 
> 标签：python

我必须创建一个函数higher_in_rank，它使用一张卡片base_card，并生成一个排名高于base_card的所有卡片的列表，按排名递增的顺序排序。卡牌排名如下：

*   在花色方面，梅花低于菱形，低于红心，低于黑桃，无论价值如何。
*   如果两张牌的花色相同，则数值较大的牌等级较高。

例如：

```
 higher_in_rank(card('spades', 8)) => [card('spades', 9), card('spades', 10)] 
 higher_in_rank(card('diamonds', 6)) =>
    [card('diamonds',7), card('diamonds', 8), ..., card('hearts',1),
    ..., card('hearts',10), card('spades', 1), ..., card('spades', 10)] 
```

我什至不知道从哪里开始。我有以下内容：

```
class card:
    'Fields: suit, value'
    def __init__(self, suit, value):
        self.suit = suit
        self.value = value
    def __repr__(self):
        return '{suit} {value}'.format(suit=self.suit,value=self.value)
  # A card is an object card(suit, value) where
  # * suit is one of 'clubs', 'spades', 'diamonds', 'hearts', and
  # * value is an integer in the range 1..10

def higher_in_rank(base_card):
    if base_card.suit == 'clubs':
        return     #clubs, diamonds, hearts, spades
    if base_card.suit == 'diamonds':
        return     #diamonds, hearts, spades
    if base_card.suit == 'hearts':
        return     #hearts, spades
    if base_card.suit == 'spades':
        return     #spades 
```

我不知道如何为此创建代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:11:21.333

我会使用它们的数字等级来识别卡片，并从中得出花色和价值：

```
class Card(object):
    suits = ('clubs', 'diamonds', 'hearts', 'spades')
    values = ('2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A')
    def __init__(self, rank):
        self.rank = rank
    def get_suit(self):
        return Card.suits[self.rank // 13]
    def get_value(self):
        return Card.values[self.rank % 13]
    def __str__(self):
        return '{suit} {value}'.format(suit=self.get_suit(),value=self.get_value())

def higher_in_rank(base_card):
    for rank in range(base_card.rank, 52):
        yield Card(rank)

base_card = Card(0 * 13 + 5)
for card in higher_in_rank(base_card):
    print card 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:17:07.327

我会设置所有卡片的排序列表，然后您可以通过查找给定卡片的索引并返回列表中的所有内容来快速获取高于给定卡片的所有卡片。例如：

```
class card:
    'Fields: suit, value'
    def __init__(self, suit, value):
        self.suit = suit
        self.value = value
    def __repr__(self):
        return '{suit} {value}'.format(suit=self.suit,value=self.value)
    def __eq__(self, other):
        return (isinstance(other, self.__class__) and 
                self.suit == other.suit and self.value == other.value)

all_cards = [card(s, v) 
             for s in ('clubs', 'diamonds', 'hearts', 'spades')
                 for v in range(1, 11)]

def higher_in_rank(base_card):
    return all_cards[all_cards.index(base_card)+1:] 
```

例子：

```
>>> higher_in_rank(card('spades', 8))
[spades 9, spades 10]
>>> higher_in_rank(card('diamonds', 6))
[diamonds 7, diamonds 8, diamonds 9, diamonds 10, hearts 1, hearts 2, hearts 3, hearts 4, hearts 5, hearts 6, hearts 7, hearts 8, hearts 9, hearts 10, spades 1, spades 2, spades 3, spades 4, spades 5, spades 6, spades 7, spades 8, spades 9, spades 10] 
```

# c# - 使用 caliburn.micro wpf c# 更改视图名称

> ID：15770010
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:07.437
> 
> 标签：c#, wpf, view, header, caliburn.micro

在我的视图的标题中，文本是：BImporter.ViewModels.MainViewModel

我怎样才能改变它（例如：MAIN）？?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:59:02.613

`Screen`您可以从或其中一种导体类型派生您的视图模型并设置`DisplayName`属性。

```
public class MyViewModel : Screen
{
    protected override void OnInitialize()
    {
        this.DisplayName = "My Name";
    }
} 
```

# php - PHP Select List - 在数据库中插入多个值

> ID：15770011
> 
> 赞同：3
> 
> 时间：2013-04-02T17:04:09.580
> 
> 标签：php, mysql, selectlist, multiple-value

我正在尝试使用选择列表在数据库中插入多个值。到目前为止我得到了什么：

HTML

```
<form enctype="multipart/form-data" action="" method="post">
            <select name="cars[]" multiple="multiple" style="width:300px">
            <?php 
            $getcars = mysql_query("SELECT cars_id, cars_name FROM car");
            while ($row = mysql_fetch_assoc($getcars)) {
                $car_id = $row['cars_id'];
                $car_name = $row['cars_name'];
            ?>
            <option value="<?php echo $car_id ?>"><?php echo $car_name ?></option>
            <?php } ?>
            </select><br />
            <input type="submit" name="submit" value="Submit"/><br/>
        </form> 
```

PHP

```
 $cars= $_POST['cars'];
        echo $cars;
        for($i = 0; $i < count($cars); $i++){
            echo $cars[$i];
            $carGroups = mysql_query("INSERT INTO car_groups VALUES('$company','$cars[$i]]')"); 
        } 
```

不幸的是，它不起作用，我尝试打印 $cars 来检查结果值。它打印“数组”，当我尝试打印 $cars[$i] 时，它什么也没打印。

有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:08:43.797

有一个额外的右括号应该被移除。您没有检查您的查询是否成功。

```
$carGroups = mysql_query("INSERT INTO car_groups VALUES('$company','$cars[$i]]')"); 
```

应该：

```
$carGroups = mysql_query("INSERT INTO car_groups VALUES('$company','$cars[$i]')") or die(mysql_error()); 
```

由于 $cars 是一个数组，您可以使用[print_r](http://php.net/print_r)或[var_dump](http://php.net/var_dump)打印其内容：

```
print_r($cars);
var_dump($cars); 
```

有用的阅读：
[如何在 PHP 中获取有用的错误信息？](https://stackoverflow.com/q/845021/1409082)
[mysql_* 函数已弃用](https://stackoverflow.com/q/15293872/1409082)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:13:47.407

您有错误 $cars[$i]] 需要更改 $cars[$i]

```
$carGroups = mysql_query("INSERT INTO car_groups VALUES('$company','$cars[$i]]')"); 
```

用好的 sql 为你修复 php

```
 $cars= $_POST['cars'];
    echo $cars;
    foreach($cars as $i => $cars_name){
        echo $cars_name;
        $carGroups = mysql_query("INSERT INTO car_groups SET `fieldcompany`='{$company}', `fieldcars`='{$cars_name}'"); 
    } 
```

# perl - 意外标记“|”附近的语法错误 Perl 代码

> ID：15770014
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:27.087
> 
> 标签：perl, shell, fedora

我正在尝试在我的 perl 脚本中执行此操作

```
my $command = `ps -p  $pidnumber |  wc -l`; 
```

但是当我运行脚本时，它会显示如下内容：

sh：-c：第 1 行：意外标记 `|' 附近的语法错误

sh：-c：第 1 行：` | 厕所-l'

哪个可能是错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:47:03.497

我同意其他答案，即管道之前的额外换行很可能是原因

但是该命令并不真正需要管道！

强制引用的命令将其值作为列表返回，然后获取列表的长度，你就得到了 wc -l "line count"

```
my $command_str = "ps -p  $pidnumber";
my $linecount = () = qx!$command_str!; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:16:19.903

是否`$pidnumber`以新行结束？见[`chomp`](http://search.cpan.org/perldoc?perlfunc#chomp)功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:54:25.973

在执行命令之前尝试打印，因为`$pidnumber`可能有一些奇怪的东西：

```
my $command_str = "ps -p  $pidnumber |  wc -l";
print $command_str, "\n";
my $command = qx!$command_str!; 
```

正如@mob 所说，如果换行符出现在打印句子中，请使用 chomp 。

# vb.net - 创建一个只有某些类型的枚举作为约束的泛型方法

> ID：15770015
> 
> 赞同：1
> 
> 时间：2013-04-02T17:04:28.970
> 
> 标签：vb.net, generics, enums

关于如何为泛型类型创建枚举约束有很多问题。[ex1](https://stackoverflow.com/questions/79126/create-generic-method-constraining-t-to-an-enum) , [ex2](https://stackoverflow.com/questions/588643/generic-methods-and-multiple-constraints) , [ex3](https://stackoverflow.com/questions/5067724/how-to-limit-a-generic-type-parameter-to-system-enum)等

我很好奇是否有可能更进一步，只需要某些本地定义的枚举作为通用方法的约束。

目前，我正在使用建议的解决方案，即在泛型类型上使用结构、Iconvertible 约束来处理允许泛型类型的枚举。在 vb.net 中看起来像这样：

```
Private Function MyMethod(Of T As {Structure, IConvertible})(ByVal myEnum As T) As Object
     '...
End Function 
```

现在，如果我想进一步将约束强制限制在我的两个枚举中会发生什么，定义如下：

```
Public Enum EnumOne
    Height
End Enum

Public Enum EnumTwo
    Width
End Enum 
```

我还没有弄清楚语法。

虽然我在 VB.net 中编程，但也欢迎 C# 答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:59:31.407

不，你不能像那样约束类型参数，这些枚举类型没有任何共同点。只能处理两种类型参数类型的泛型函数没有太多价值，只提供函数的两个非泛型重载要简单得多：

```
Private Function MyMethod(ByVal value as EnumOne) As Object
     '' etc
End Function

Private Function MyMethod(ByVal value as EnumTwo) As Object
     '' etc
End Function 
```

可能还有另一种私有方法，为这些功能提供通用实现。

# python - 不理解我的 python 困境

> ID：15770016
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:31.217
> 
> 标签：python, if-statement

我正在尝试完成班级“成绩确定”的作业

编写一个程序，输入 3 个测试分数。程序应确定并显示它们的平均值。然后程序应根据平均值显示适当的字母等级。字母等级应使用标准 10 分制确定：（A = 90-100；B = 80-89.999；C = 70-79.999 等）

到目前为止，我已经能够放在一起，（它的工作平均）

```
def main():  
    score1 = input("What is the first test score? ")
    score2 = input("What is the second test score? ")
    score3 = input("What is the third test score? ")
    scoreaverage = score1 + score2 + score3
score = (scoreaverage / 3)
    if score < 60:
        grade="F"
elif score < 70:
        grade="C"
elif score < 80:
        grade="B"
elif score < 90:
        grade="A"
else:
        print score, " is the student's grade average!"

main() 
```

如果我用成绩替换分数，我会得到一个错误。

```
raceback (most recent call last):
File "<stdin>", line 1, in <module>
  File "<stdin>", line 16, in main
UnboundLocalError: local variable 'grade' referenced before assignment 
```

所以我的问题是如何让字母等级正确打印？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:12:05.663

```
def main():  
    score1 = input("What is the first test score? ")
    score2 = input("What is the second test score? ")
    score3 = input("What is the third test score? ")
    scoreaverage = score1 + score2 + score3
    score = (scoreaverage / 3)
    if score < 60:
        grade="F"
    elif score < 70:
        grade="C"
    elif score < 80:
        grade="B"
    elif score < 90:
        grade="A"
    else:
        print score, " is the student's grade average!"

main() 
```

这将是您的缩进代码。你确定你得到你提到的错误吗？以下代码将生成您提到的错误。

```
 print grade, " is the student's grade average!" 
```

您可以通过以下方式修复它：

```
def main():  
    score1 = input("What is the first test score? ")
    score2 = input("What is the second test score? ")
    score3 = input("What is the third test score? ")
    scoreaverage = score1 + score2 + score3
    score = (scoreaverage / 3)
    grade = 'Unknown'
    if score < 60:
        grade="F"
    elif score < 70:
        grade="C"
    elif score < 80:
        grade="B"
    elif score < 90:
        grade="A"

    print "%s is the student's grade average!" % grade

main() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T18:21:34.223

欢迎来到 SO。正如其他人所解释的那样，您的问题是在为其分配值之前访问成绩。这是做你想做的事情的另一个建议：（见评论）

```
#disregard next line if you are using Python 3.3
from __future__ import division

#use a list to store the scores
scores = []

#if you are using 2.7 replace input with raw_input
#use float() to convert the input to float
scores.append(float(input("First score? ")))
scores.append(float(input("Second score? ")))
scores.append(float(input("Third score? ")))

#More general way of calculating the average
score = sum(scores) / len(scores)

#You could use a dictionary for score-grade mapping
grades = {100: 'A', 90: 'A', 80: 'B',
          70: 'C', 60: 'D', 50: 'E',
          40: 'F', 30: 'F', 20: 'F',
          10: 'F', 0: 'F'}

#removes the remainder from the score
#to make use of the above dictionary
grade = grades[score - (score % 10)]

#Use string formatting when printing
print('grade: %s, score: %.2f' % (grade, score)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:23:41.743

您的成绩比较差了 10 分。如果分数在 90 到 100 之间，您将不会为评分分配任何内容。对于新手程序员的一条建议：使用调试器。如果您逐步解决问题，您将在几分钟内发现问题。

尝试：

```
if score < 60:
    grade="F"
elif score < 70:
    grade="D"
elif score < 80:
    grade="C"
elif score < 90:
    grade="B"
else:
    grade="A" 
```

# regex - htaccess 重定向以

> ID：15770017
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:34.057
> 
> 标签：regex, .htaccess, redirect

我正在尝试添加一个简单的 .htaccess 301 重定向。像这样的网址：

```
s.nl/sc/2.f?...
s.nl/it...
s.nl/?=... 
```

我想匹配任何以“s.nl”开头的网址。

我一直在尝试的是：

```
RewriteRule ^s\.nl/.*$ / [L,R=301] 
```

更新：这是正确工作的最终规则：

```
RewriteRule /s\.nl.*$ /? [R=301] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T21:06:02.040

您拥有的正则表达式几乎是正确的。在您的 RewriteRule 中，您似乎正在尝试匹配`/`after `s.nl`，如果是这种情况，则`/`必须转义 ( `\/`)：

```
RewriteRule ^s\.nl\/ / [R=301] 
```

该`L`标志很可能不需要，除非您有使用`RewriteCond`.

如果您想在之后匹配任何内容，`s.nl`那么`RewriteRule`就是：

```
RewriteRule ^s\.nl / [R=301] 
```

**注意**。如果您希望在重定向时删除查询字符串，您可以添加`?`到重定向目标：

```
RewriteRule ^s\.nl.*$ /? [R=301] 
```

# css - 如何：背景大小：100% 自动，背景附件：滚动

> ID：15770023
> 
> 赞同：2
> 
> 时间：2013-04-02T17:04:53.487
> 
> 标签：css, firefox, background

Firefox 有一个关于背景附件和背景大小的奇怪错误。我称它为错误，我怀疑它不是，但这呈现了我认为它应该在其他主要浏览器中的方式（我认为强调）。所需的效果是将垂直重复背景的大小调整为 100% 宽度，同时保持图像比例。

这是我的原始 CSS，在这个版本中，背景不会为 firefox 渲染（即使使用 firefox 特定的背景标签）。

```
body {
    background: #000 url('../background.jpg') left top repeat-y;
    background-attachment: scroll;
    background-size: 100% auto;
} 
```

更改`background-attachment: scroll;`为`background-attachment: fixed;`会导致背景呈现，但不希望出现“浮动背景”行为。

**[更新]**

删除背景位置会导致图像再次正确渲染。

例如

```
body {
    background: #000 url('../background.jpg') repeat-y;
    background-size: 100% auto;
} 
```

这实际上是一个有问题的修复，因为我的位置值实际上是“左 113 像素”。我可以通过将背景应用于站点标题下方的包装 div 而不是 body 元素来解决此问题，但事实仍然是 Firefox 无法使用 background-size: 100% auto; 渲染背景图像；当使用位置值并且附件是滚动时。

**[更新 2]**

我意识到只有在存在额外的 CSS 时才会出现该错误。这并不是说额外的 CSS 有问题（不是），而是说这个 Firefox 特定的渲染错误是由它引起的。

额外的 CSS（用于创建灵活的 100% 高度的布局）

```
html {  width: 100%;    height: 100%;   position: absolute; } 
```

以及完整的正文 CSS 来复制错误

```
body  {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    margin: 0;
    background: #000 url('image.jpg') top left repeat-y;
    background-size: 100% auto;
} 
```

**[解决方案]** 我通过立即在正文中创建一个额外的包装 div 并在此处附加背景而不指定位置属性来解决我的问题。

```
#wrapper {
    position: absolute;
    min-height: 100%;
    width: 100%;
    background: #000 url('image.jpg') repeat-y;
    background-size: 100% auto;
} 
```

但是因为我现在有一个额外的包装器，我可以继续从 中删除位置、高度和宽度属性`html`，渲染错误并允许我设置背景的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T16:20:30.693

我通过立即在正文中创建一个额外的包装 div 并在此处附加背景而不指定位置属性来解决我的问题。

```
#wrapper {
    position: absolute;
    min-height: 100%;
    width: 100%;
    background: #000 url('image.jpg') repeat-y;
    background-size: 100% auto;
} 
```

但是因为我现在有一个额外的包装器，我可以继续从 html 中删除位置、高度和宽度属性，渲染错误并允许我设置背景的位置。（请参阅我原来的问题中的更新 2）

# ios - 如何向 GPXFramework 代码添加自定义扩展标签？

> ID：15770024
> 
> 赞同：0
> 
> 时间：2013-04-02T17:04:54.827
> 
> 标签：ios, xml, frameworks, gps, gpx

我发现了开源 iOS GPX 框架 ( [http://gpxframework.com/](http://gpxframework.com/) ) 的优秀资源，它允许我创建和读取 GPX 文件。但是我想添加一个自定义扩展来存储特定于我的应用程序的数据。我可以看到 GPX 框架实现了文件 GPXExtensions.h 和 .m，但我不确定如何添加一个标签，用于在 GPX 中的特定坐标处存储速度数据。我猜我必须将我想作为扩展添加到 GPXExtensions 类的数据添加为属性，然后以某种方式修改此方法中的代码：

```
- (void)addChildTagToGpx:(NSMutableString *)gpx indentationLevel:(NSInteger)indentationLevel
{
    [super addChildTagToGpx:gpx indentationLevel:indentationLevel];
} 
```

但我不确定这种方法应该做什么，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T21:34:44.170

这基本上是正确的想法。Jaime Machuca 的 fork 包含一个[提交](https://github.com/jmachuca77/iOS-GPX-Framework/commit/9c3b091a541882a69badeb6080bf076bbf7b5c99)，他在其中添加了心率等。它应该为您提供了一个很好的模板，您可以从中创建自己的修改。请注意，如果您想要更复杂的东西，您可能需要创建自己的 GPXElement 子类，以便您可以利用树结构。

# iis-7 - 在asp中，如何将布尔值设置为英语？

> ID：15770025
> 
> 赞同：1
> 
> 时间：2013-04-02T17:05:13.410
> 
> 标签：iis-7, asp-classic, boolean

当我运行这个：

```
 <%
    www = false
    response.write www
    response.write "UPDATE table SET domain='"&www&"' WHERE id=n"
    %> 
```

我明白了：

```
 false
    UPDATE table SET domain='Falso' WHERE id=n 
```

请注意葡萄牙语而不是英语中的“Falso”一词。

是否可以将布尔值更改为英语？

我在 pt-BR 中有一个 Windows 2008 / IIS 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:18:52.817

这个问题最近才[在这里被问到](https://stackoverflow.com/questions/15760035/boolean-values-in-local-language/15767841#15767841)

我没有一台好的机器来测试以下代码，这些代码来自一个有效的解决方案。它强制您需要的位置（当然，如果 1033 不是您的目标，您可以将位置更改为您需要的位置）

```
<%
Response.Write FormatDateTime(Now) & "<br />"
oldLocale = SetLocale(1033) '1033=English(US)
Response.Write FormatDateTime(Now) & "<br />"
SetLocale oldLocale 
Response.Write FormatDateTime(Now) & "<br />"
%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T08:52:19.403

只需使用字符串：

```
www = "false" 
```

那么它就不会受到区域设置的影响。

如果您想继续使用实际的布尔值，请使用参数而不是原始 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T18:41:27.097

我将无法再为这个“问题”提供任何测试。

那是因为我已经决定格式化我的 Windows 并现在用英文安装一个新的.. 我这样做是因为我的时间不多了，我需要尽快让这个服务器工作..

但我要感谢所有为解决这个问题做出贡献的人 =)

如果有人遇到同样的问题，请留下您的评论，以便其他人可以提供更多选项来尝试解决此问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T09:34:02.153

如果您不介意更改代码，可以使用函数来打印布尔值。对我来说那不是一个选择，但我开始相信这是唯一的方法。

```
Function PB(pVal)
  If pVal Then
    PB = "true"
  Else
    PB = "false"
  End If
End Function

Response.Write "UPDATE table SET domain='"&PD(www)&"' WHERE id=n" 
```

# content-management-system - ESB 与雅虎管道

> ID：15770028
> 
> 赞同：0
> 
> 时间：2013-04-02T17:05:17.923
> 
> 标签：content-management-system, pipe, esb

我是 ESB 的新手，想知道是否有人可以帮助我解决以下问题。我想建立一个系统来获取数据（即 RSS 提要，但可以是任何类型的数据/新闻源），将它们泵入 CMS 系统，让内容管理员批准，并在必要时调整此内容。之后，我会让内容管理员选择他想要将内容分发到的频道，然后我希望 CMS 将此内容分发到内容管理员选择的适当频道。

我的看法是，在数据源和 CMS 之间会有一个类似 ESB 的架构，然后在 CMS 和要发布到的通道之间再一次。

这是一种正确的思维方式吗？还是我的假设完全错误？另外，我想知道我是否需要一个完整的 ESB 设置，或者我可以只使用 Yahoo Pipes 设置，它将所有传入的数据源转换为一个提要，我从一侧拉入 CMS，并从CMS，可以被对方单独的内容通道调用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T16:56:53.540

一个忠告，不要太复杂。您可以使用事件 SOA，但我看不到您会从中获得什么好处，因为您的案例场景并不复杂，并不是说您只使用具有复杂要求的事件 SOA 架构。您需要提前考虑未来，SLA（事务数量，负载平衡......）只有在您知道架构的约束之后，您才能决定是否需要在分布式系统中构建系统从一开始的方式或只有基础，作为服务合同，如果需要，您可以采用分布式方式。分发系统已经很复杂了，因此在您认为需要这样做之前，您需要了解系统的 SLA，并制定可扩展性计划。

# java - 如何创建使用其他接口的特定实现的接口实现？

> ID：15770029
> 
> 赞同：1
> 
> 时间：2013-04-02T17:05:20.033
> 
> 标签：java, design-patterns

我绝对无法解释我在标题中的意思。这个问题要么太愚蠢，要么太复杂，但归根结底是我找不到合适的设计模式。

因此，让我们假设我们有一个类 A，其中包含对接口 B 的引用。计算过程确定 B 的哪个实现是合适的并实例化一个新对象。到目前为止一切顺利（我认为）。

现在 B 有一个基于一组参数的方法。对象 A 拥有一组默认参数，但可以按需提供任何参数。棘手的部分是接口 B 的实现之间的参数完全不同。实际上，这些参数本身就是不同的对象，它们有自己的方法，每个 B 的实现都不同。

我最初的方法是为参数创建一个接口 C，然后为 B 的每个实现创建一个 C 实现（它是一对一的关系），但这似乎不正确。如果没有别的，在 B 的每个唯一实现中，我必须将 C 转换为调用其唯一函数所需的相应实现。

只能假设有更漂亮的方法！有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:18:43.063

如果 B 的用户需要使用依赖于底层实现的特定参数调用其方法，则 B 不是一个合适的接口。你应该重新考虑你的设计。为什么 A 甚至可以访问这些参数？它们是否属于每个 B 实现？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:16:52.013

正如在其他答案中所指出的那样，`B`这不是一个适当的界面（在道德意义上）。如果这些参数真的不能成为每个`B`实现的一部分，那么您仍然可以通过抽象细节来实现正确的接口：

```
interface BWrapper {
    public void doSomething();
}

class ConcreteB {
    public static class Params { ... }

    public class Wrapper implements BWrapper() {
        public Wrapper(Params params) { this.params = params; }
        @Override
        public void doSomething()     { ConcreteB.doSomething(params); }
        private final Params params;
    }

    public void doSomething(Params params) { ... }
}

class A {
    void setWrapper(BWrapper wrapper) { this.wrapper = wrapper; }
    void foo()                        { wrapper.doSomething(); }

    private BWrapper wrapper;
}

...

A a = new A();

ConcreteB.Params p1 = new ConcreteB.Params();
a.setWrapper(new ConcreteB.Wrapper(p1)); 
a.doSomething();

ConcreteB.Params p2 = new ConcreteB.Params();
a.setWrapper(new ConcreteB.Wrapper(p2)); 
a.doSomething(); 
```

# django - Django：如何在 urls.py 中提供在运行时更改的类别？

> ID：15770031
> 
> 赞同：0
> 
> 时间：2013-04-02T17:05:35.633
> 
> 标签：django, url, django-views

我正在尝试在我的 django 电子商务网站中创建一个新的 URL 级别，这意味着如果用户在`domain.com/category/foo/`我试图添加下一个级别，他们点击 foo 中的某个元素并结束在`domain.com/category/foo/tag/bar/`. 为此，我创建了我的 urls.py 行来检测这一点，我相信这里没有问题：

```
(r'^category/(?P<category_slug>[-\w]+)/tag/(?P<tag_slug>[-\w]+)/$', 'show_tag', {
'template_name':'catalog/product_list.html'},'catalog_tag'), 
```

通过 urls.py 映射请求后，我知道它需要 view.py 中的一些变量`get_adsolute_url`才能完成它的工作，所以我创建了视图：

```
def show_tag(request, 
                  tag_slug, 
                  template_name="catalog/product_list.html"):
    t = get_object_or_404(Tag, 
                          slug=tag_slug)
    products = t.product_set.all()
    page_title = t.name
    meta_keywords = t.meta_keywords
    meta_description = t.meta_description
    return render_to_response(template_name, 
                              locals(), 
                              context_instance=RequestContext(request)) 
```

最后，在我的 Tag 模型中，我设置了 my`get_absolute_url`来填充关键字参数：

```
@models.permalink
    def get_absolute_url(self):
        return ('catalog_tag', (), { 'category_slug': self.slug, 'tag_slug': self.slug }) 
```

我确定我要请求的类别和标签存在，然后我输入 domain.com/category/foo/tag/bar 并收到一个

```
TypeError at /category/foo/tag/bar/
show_tag() got an unexpected keyword argument 'category_slug' 
```

我相信我知道错误在哪里，但我不知道如何解决它。我的`get_abolute_url`集合`'category_slug': self.slug`，但正如我所说，这个定义存在于我的标签模型中。我的 Category 模型位于同一个 models.py 中，但我如何告诉我`get_absolute_url`去查找它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:14:33.860

您的视图`show_tag`必须有一个参数来接受`category_slug`现在不存在的参数：

```
def show_tag(request, 
    category_slug, tag_slug, 
    template_name="catalog/product_list.html") 
```

# ado.net - SQL Server Compact 是否支持括号？

> ID：15770041
> 
> 赞同：0
> 
> 时间：2013-04-02T17:06:07.443
> 
> 标签：ado.net, sql-server-ce

根据这个[http://technet.microsoft.com/en-us/library/ms174147.aspx](http://technet.microsoft.com/en-us/library/ms174147.aspx) SQL Server Compact 4.0 不支持括号。查看 EF5 迁移 SQL 命令（`-verbose`在包管理器控制台中使用），我得到如下代码：

```
CREATE TABLE [Products] (
    [Id] [int] NOT NULL,
    [Name] [nvarchar](4000),
    CONSTRAINT [PK_dbo.Products] PRIMARY KEY ([Id])
) 
```

我在这里错过了什么吗？也许 ADO.NET 有一些特殊处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T08:21:27.107

SQL Server Compact 支持标识符的括号，这似乎是一个文档问题。

# ms-access - 规范化 - 理解概念

> ID：15770046
> 
> 赞同：0
> 
> 时间：2013-04-02T17:06:15.760
> 
> 标签：ms-access, database-design

在入门级别，是否有一种简单的方法来理解 3NF 的规范化？为了解释我的困惑，我有一个示例表，其中包含附属政党代码以及描述、作为国会议员或参议员的描述以及每个人的代码、4 个人的姓名和 4 个投票通过的法案示例，是或没有个人投票。每个都有投票日期，我必须允许将来对各种法案进行额外的投票。我必须强制执行参照完整性。我不是在问答案，但是在尝试规范化时，我是否必须在每个表上强制执行完整性？我缺少一些了解如何将表格标准化为 3NF 的内容。

# java - 我无法让 MergeSort 正常工作

> ID：15770047
> 
> 赞同：0
> 
> 时间：2013-04-02T17:06:20.213
> 
> 标签：java

到目前为止，我有以下代码：

```
public class MergeSort {
int[] theList;
int counter;  //required for analysis later
double time;  //required for analysis later

MergeSort(int[] n){
    int len = n.length;
    this.theList = mergeSort(n, 0, len);
}

int[] mergeSort(int[] n, int p, int r){
    if((p + 1 )<r){
        int q = (r + p)/2;
        mergeSort(n, p, q);
        mergeSort(n, q+1, r);
        merge(n, p, q, r);
    }
    return n;

}
public void merge(int[] input, int p, int q, int r){
    int lefti = q - p;
    int righti = r - q;
    int[] left = new int[lefti+1];
    int[] right = new int[righti+1];
    for(int i = 0; i < lefti; i++){
        this.counter++;
        left[i] = input[p+i];
    }
    for(int i = 0; i < righti; i++){
        this.counter++;
        right[i] = input[q+i];
    }
    left[left.length - 1] = 1000000;
    right[right.length - 1] = 1000000;
    int i = 0;
    int j = 0;
    for(int k = p; k < r; k++){
        this.counter++;
        if(left[i] < right[j]){
            input[k] = left[i];
            i++;
        }
        else{
            input[k] = right[j];
            j++;
        }
    }
} 
```

}

我想我已经盯着这个太久了。如果有人能够引导我朝着更好的方向前进，我将不胜感激。

现在，输入 MergeSort([9, 8, 7, 6, 5, 4, 3, 2, 1, 0])，theList 等于 [4, 1, 0, 2, 3, 7, 5, 6 , 8, 9]。

我很感谢我可能收到的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T19:45:04.070

看起来您的 mergeSort 方法需要一个基本案例。如果 (p+1) >= r 则对子数组进行排序（即子数组的大小应为 1 或 2，如果大小为 1 则不执行任何操作，如果大小为 2 则交换如果它们乱序，则这两个值）

# c++ - 微优化 c++ 比较函数

> ID：15770049
> 
> 赞同：12
> 
> 时间：2013-04-02T17:06:23.307
> 
> 标签：c++, optimization, branch-prediction

我有一个`Compare()`看起来像这样的函数：

```
inline bool Compare(bool greater, int p1, int p2) {
  if (greater) return p1>=p2;
  else return p1<=p2;
} 
```

我决定优化以避免分支：

```
inline bool Compare2(bool greater, int p1, int p2) {
  bool ret[2] = {p1<=p2,p1>=p2};
  return ret[greater];
} 
```

然后我通过这样做进行测试：

```
bool x = true;
int M = 100000;
int N = 100;

bool a[N];
int b[N];
int c[N];

for (int i=0;i<N; ++i) {
  a[i] = rand()%2;
  b[i] = rand()%128;
  c[i] = rand()%128;
}

// Timed the below loop with both Compare() and Compare2()
for (int j=0; j<M; ++j) {
  for (int i=0; i<N; ++i) {
    x ^= Compare(a[i],b[i],c[i]);
  }
} 
```

结果：

```
Compare(): 3.14ns avg
Compare2(): 1.61ns avg 
```

我会说案例关闭，避免分支FTW。但是为了完整起见，我替换了

```
a[i] = rand()%2; 
```

和：

```
a[i] = true; 
```

并得到了完全相同的测量结果，约为 3.14ns。据推测，那时没有分支发生，编译器实际上正在重写`Compare()`以避免该`if`语句。但是，为什么`Compare2()`更快呢？

不幸的是，我是汇编代码文盲，否则我会尝试自己回答这个问题。

**编辑**：下面是一些程序集：

```
_Z7Comparebii:
.LFB4:
    .cfi_startproc
    .cfi_personality 0x3,__gxx_personality_v0
    pushq   %rbp
    .cfi_def_cfa_offset 16
    movq    %rsp, %rbp
    .cfi_offset 6, -16
    .cfi_def_cfa_register 6
    movl    %edi, %eax
    movl    %esi, -8(%rbp)
    movl    %edx, -12(%rbp)
    movb    %al, -4(%rbp)
    cmpb    $0, -4(%rbp)
    je      .L2
    movl    -8(%rbp), %eax
    cmpl    -12(%rbp), %eax
    setge   %al
    jmp     .L3
.L2:
    movl    -8(%rbp), %eax
    cmpl    -12(%rbp), %eax
    setle   %al
.L3:
    leave
    ret
    .cfi_endproc
.LFE4:
    .size   _Z7Comparebii, .-_Z7Comparebii
    .section        .text._Z8Compare2bii,"axG",@progbits,_Z8Compare2bii,comdat
    .weak   _Z8Compare2bii
    .type   _Z8Compare2bii, @function
_Z8Compare2bii:
.LFB5:
    .cfi_startproc
    .cfi_personality 0x3,__gxx_personality_v0
    pushq   %rbp
    .cfi_def_cfa_offset 16
    movq    %rsp, %rbp
    .cfi_offset 6, -16
    .cfi_def_cfa_register 6
    movl    %edi, %eax
    movl    %esi, -24(%rbp)
    movl    %edx, -28(%rbp)
    movb    %al, -20(%rbp)
    movw    $0, -16(%rbp)
    movl    -24(%rbp), %eax
    cmpl    -28(%rbp), %eax
    setle   %al
    movb    %al, -16(%rbp)
    movl    -24(%rbp), %eax
    cmpl    -28(%rbp), %eax
    setge   %al
    movb    %al, -15(%rbp)
    movzbl  -20(%rbp), %eax
    cltq
    movzbl  -16(%rbp,%rax), %eax
    leave
    ret
    .cfi_endproc
.LFE5:
    .size   _Z8Compare2bii, .-_Z8Compare2bii
    .text 
```

现在，执行测试的实际代码可能正在使用上述两个函数的内联版本，因此这可能是要分析的错误代码。话虽如此，我在 中看到一个`jmp`命令`Compare()`，所以我认为这意味着它正在分支。如果是这样，我想这个问题就变成了：为什么分支预测器不能提高`Compare()`我`a[i]`从`rand()%2`to `true`（或`false`就此而言）改变时的性能？

**EDIT2**：我用“分支”替换了“分支预测”，以使我的帖子更明智。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T20:46:21.627

我想我想出了大部分。

当我在我的 OP 编辑​​中发布函数的程序集时，我注意到内联版本可能不同。我没有检查或发布时序代码，因为它更复杂，而且我认为内联过程不会改变分支是否发生在`Compare()`.

当我取消内联函数并重复我的测量时，我得到了以下结果：

```
Compare(): 7.18ns avg
Compare2(): 3.15ns avg 
```

然后，当我替换`a[i]=rand()%2`为 时`a[i]=false`，我得到以下信息：

```
Compare(): 2.59ns avg
Compare2(): 3.16ns avg 
```

这证明了分支预测的好处。替换没有产生任何改进的事实`a[i]`最初表明内联删除了分支。

所以最后一个谜团是为什么 inlined`Compare2()`优于 inlined `Compare()`。我想我可以发布时序代码的程序集。函数如何内联的一些怪癖可能会导致这种情况似乎很合理，所以我很乐意在这里结束我的调查。我将在我的应用程序中替换`Compare()`为。`Compare2()`

感谢您提供许多有用的评论。

编辑：我应该补充一点，击败所有其他人的可能原因`Compare2`是处理器能够并行执行这两个比较。正是这种直觉让我按照自己的方式编写函数。所有其他变体本质上都需要两个逻辑串行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T00:38:36.693

我编写了一个名为 Celero 的 C++ 库，旨在测试这些优化和替代方案。（无耻的自我宣传：[https](https://github.com/DigitalInBlue/Celero) ://github.com/DigitalInBlue/Celero ）

我使用以下代码运行您的案例：

```
class StackOverflowFixture : public celero::TestFixture
{
  public:
    StackOverflowFixture()
    {
    }

    inline bool NoOp(bool greater, int p1, int p2) 
    {
      return true;
    }

    inline bool Compare(bool greater, int p1, int p2) 
    {
      if(greater == true)
      {
        return p1>=p2;
      }

      return p1<=p2;
    }

    inline bool Compare2(bool greater, int p1, int p2)
    {
      bool ret[2] = {p1<=p2,p1>=p2};
      return ret[greater];
    }

    inline bool Compare3(bool greater, int p1, int p2) 
    {
      return (!greater != !(p1 <= p2)) | (p1 == p2);
    }

    inline bool Compare4(bool greater, int p1, int p2) 
    {
      return (greater ^ (p1 <= p2)) | (p1 == p2);
    }
};

BASELINE_F(StackOverflow, Baseline, StackOverflowFixture, 100, 5000000)
{
  celero::DoNotOptimizeAway(NoOp(rand()%2, rand(), rand()));
}

BENCHMARK_F(StackOverflow, Compare, StackOverflowFixture, 100, 5000000)
{
  celero::DoNotOptimizeAway(Compare(rand()%2, rand(), rand()));
}

BENCHMARK_F(StackOverflow, Compare2, StackOverflowFixture, 100, 5000000)
{
  celero::DoNotOptimizeAway(Compare2(rand()%2, rand(), rand()));
}

BENCHMARK_F(StackOverflow, Compare3, StackOverflowFixture, 100, 5000000)
{
  celero::DoNotOptimizeAway(Compare3(rand()%2, rand(), rand()));
}

BENCHMARK_F(StackOverflow, Compare4, StackOverflowFixture, 100, 5000000)
{
  celero::DoNotOptimizeAway(Compare4(rand()%2, rand(), rand()));
} 
```

结果如下所示：

```
[==========]
[  CELERO  ]
[==========]
[ STAGE    ] Baselining
[==========]
[ RUN      ] StackOverflow.Baseline -- 100 samples, 5000000 calls per run.
[     DONE ] StackOverflow.Baseline  (0.690499 sec) [5000000 calls in 690499 usec] [0.138100 us/call] [7241140.103027 calls/sec]
[==========]
[ STAGE    ] Benchmarking
[==========]
[ RUN      ] StackOverflow.Compare -- 100 samples, 5000000 calls per run.
[     DONE ] StackOverflow.Compare  (0.782818 sec) [5000000 calls in 782818 usec] [0.156564 us/call] [6387180.672902 calls/sec]
[ BASELINE ] StackOverflow.Compare 1.133699
[ RUN      ] StackOverflow.Compare2 -- 100 samples, 5000000 calls per run.
[     DONE ] StackOverflow.Compare2  (0.700767 sec) [5000000 calls in 700767 usec] [0.140153 us/call] [7135039.178500 calls/sec]
[ BASELINE ] StackOverflow.Compare2 1.014870
[ RUN      ] StackOverflow.Compare3 -- 100 samples, 5000000 calls per run.
[     DONE ] StackOverflow.Compare3  (0.709471 sec) [5000000 calls in 709471 usec] [0.141894 us/call] [7047504.408214 calls/sec]
[ BASELINE ] StackOverflow.Compare3 1.027476
[ RUN      ] StackOverflow.Compare4 -- 100 samples, 5000000 calls per run.
[     DONE ] StackOverflow.Compare4  (0.712940 sec) [5000000 calls in 712940 usec] [0.142588 us/call] [7013212.893091 calls/sec]
[ BASELINE ] StackOverflow.Compare4 1.032500
[==========]
[ COMPLETE ]
[==========] 
```

鉴于此测试，**Compare2 似乎**是此微优化的最佳选择。

编辑：

Compare2 组装（最好的情况）：

```
cmp r8d, r9d
movzx   eax, dl
setle   BYTE PTR ret$[rsp]
cmp r8d, r9d
setge   BYTE PTR ret$[rsp+1]
movzx   eax, BYTE PTR ret$[rsp+rax] 
```

Compare3 组装（次佳案例）：

```
xor r11d, r11d
cmp r8d, r9d
mov r10d, r11d
setg    r10b
test    dl, dl
mov ecx, r11d
sete    cl
mov eax, r11d
cmp ecx, r10d
setne   al
cmp r8d, r9d
sete    r11b
or  eax, r11d 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:52:55.713

这个怎么样...

```
inline bool Compare3(bool greater, int p1, int p2) 
{
  return (!greater != !(p1 <= p2)) | (p1 == p2);
} 
```

或者

```
inline bool Compare4(bool greater, int p1, int p2) 
{
  return (greater ^ (p1 <= p2)) | (p1 == p2);
} 
```

# java - 我在java中输入了一个字母

> ID：15770052
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:06:30.013
> 
> 标签：java

我怎么知道字符串字母是否等于字符数组

```
String[] choose = {"a","d","t","b","s","f","x"};
    String check;
    boolean error = false;

        System.out.print("Enter");

        Scanner sn = new Scanner(System.in);    
         check = sn.nextLine();
        for (int i = 0 ; i < choose.length;i++){

            if(choose[i] == check){
                System.out.print("you entered" + choose[i]);
                break;
            }
        } 
```

我所做的是它没有确认我输入了字母 a 但“你输入了”没有出现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:07:59.820

您不能使用`==`. 那只比较引用（内存地址）。你需要使用[`String#equals(Object)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals(java.lang.Object)). 一般来说，如果您正在测试相等性，`==`那肯定是您**不想要的，****除非**您正在检查两个变量是否指向*同一个*实例。这种情况很少发生，因为您*通常*对测试*值*是否相等感兴趣。

所以你需要做的是：

```
if(choose[i].equals(check)) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:10:36.693

您正在尝试使用 == 比较字符串，它只比较引用，而不比较值。你想用的是

```
if(check.equals(choose[i])) 
```

# java - 如何从字符串库名称中获取 jar 库名称和版本？

> ID：15770058
> 
> 赞同：0
> 
> 时间：2013-04-02T17:06:46.377
> 
> 标签：java, maven, jar

我的目录中有许多 jar 文件：

*   一些-lib-2.0.jar
*   一些-lib-2.1-SNAPSHOT.jar
*   some-lib-3.RELEASE.jar
*   一些-lib-R8.jar
*   一些-lib-core-1.jar
*   一些-lib-2.patch2.jar
*   some-lib-2-alpha-4.jar
*   一些lib.jar
*   一些-lib2-4.0.jar

如何从文件名中获取库名称和版本？

正则表达式 ((?:(?!-\d)\S)+)-(\S*\d\S*(?:-SNAPSHOT)?).jar$ 对提取名称和版本有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T19:09:39.093

JAR 文件名中的版本号只是 Maven 构建的 JAR 的约定和默认值。它可能已被覆盖，并且仅从文件名中读取版本号并不总是可靠的。

从 JAR 读取版本号的更可靠方法是查看 JAR 文件内部。根据 JAR 的构建方式，您有几个选项：

*   查看`META-INF/maven/.../pom.properies`并`pom.xml`从中读取版本 - 这应该存在于 Maven 构建的二进制文件中
*   有时版本号（如果存在于 META-INF/MANIFEST.MF`Specification-Version`或`Implementation-Version`属性下）

如果失败，则回退到从 JAR 名称中读取版本号，因为没有其他可用信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:15:23.117

不同库的命名策略可能不同，因此您无法使用一条规则从包名称中提取名称/版本，有关详细信息，您应该查看项目文档。

在 Maven 的情况下，您可以使用`finalName` `pom.xml`配置选项配置构建工件的最终名称。Maven 文档很好地[介绍](http://maven.apache.org/guides/introduction/introduction-to-the-pom.html)了 pom 结构。以下是文档中的示例：

```
<build>
    ...
    <finalName>${artifactId}-${version}</finalName>
    ...
</build> 
```

# ios - 是否可以调整图像大小但在 iOS 上保持边框相同？

> ID：15770059
> 
> 赞同：1
> 
> 时间：2013-04-02T17:06:46.917
> 
> 标签：ios, image, resize, border

我有一个带有固定边框的图像，我需要能够将图像的高度从例如 25 像素更改为 300 像素，但这样顶部的边框仅构成它最初的 5 像素。当然，可以将同一图像的多个版本保留为不同尺寸，就像我拥有的​​尺寸一样，但这会占用大量内存，或者我可以尝试将一张图像由 5 个部分组成，即上边框、下边框、左右边框以及实际内容。不过这样比较不方便

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:41:49.053

您正在寻找`UIImage`方法

```
-(UIImage *)resizableImageWithCapInsets: 
```

将此消息发送到您的原始图像并传递`UIEdgeInsetsMake(topFixedBorderSize, leftFixedBorderSize, bottomFixedBorderSize, rightFixedBorderSize)`，您将获得“可调整大小”的图像。当您以更大的尺寸绘制可调整大小的图像时，只会拉伸未被帽插图覆盖的像素。每一侧被帽插图覆盖的像素将保持固定在边缘上。

# oracle - 我可以在 Oracle 的 FOR 循环选择语句中使用词法参数吗

> ID：15770064
> 
> 赞同：0
> 
> 时间：2013-04-02T17:06:54.703
> 
> 标签：oracle, plsql

我正在尝试在 FOR 循环中的 FROM 和 WHERE 子句中使用词法参数。词法参数在运行时填充。当我尝试在 TOAD 中运行它时出现编译错误：

```
FOR r_inv IN (SELECT i.SERIAL_NO,i.HDD_MODEL,i.HDD_SN FROM inventory i &LP_from) 
LOOP ... 
```

我什至可以这样做吗？我知道你不能在 PL/SQL 代码中使用词法参数，但在这里我实际上是在尝试将它与 PL/SQL 代码中的 SQL 语句一起使用。

我得到的错误是：

> 找到“&LP_from”，期待：`* + - : CASE CONNECT_BY_ROOT CONTINUE CURSOR decimal number EXECUTE FALSE float FORALL integer MERGE MOD MULTISET NEW NULL PRIOR REM SQL string THE TRUE -or- ( identifier REVERSE`

# c# - WPF 中的父级更改

> ID：15770069
> 
> 赞同：2
> 
> 时间：2013-04-02T17:07:21.733
> 
> 标签：c#, wpf, parent-child, frameworkelement

有没有一种方法可以在 FrameworkElement 的可视父级更改时得到通知，而无需重写 OnVisualParentChanged 方法，只需使用事件？

[这](https://stackoverflow.com/questions/4159419/wpf-usercontrol-on-parent-changed-event)是使用“加载”事件的想法，但这似乎并不安全。

当视觉父级更改/更改时，是否有明确触发的事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-20T22:39:54.417

在我的测试中，当父母发生变化时，Loaded Unloaded 确实会被解雇，所以我会说回复它们是安全的。但是，如前所述，您只能在挂钩 OnVisualParentChanged 时访问旧父级（到 _Unloaded 被称为 VisualParent 时已经为空）如果这是您所关心的，覆盖 OnVisualParentChanged 非常简单。

```
 void _Loaded(object sender, RoutedEventArgs e)
    {
        DoSmthng();
    }

    void _Unloaded(object sender, RoutedEventArgs e)
    {
        DoSmthngElse();
    }

    protected override void OnVisualParentChanged(DependencyObject oldParent)
    {
        DoSmthngOther();

        // Call base class to perform standard event handling. 
        base.OnVisualParentChanged(oldParent);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:24:18.020

这与`OnVisualParentChanged`. 在[FrameworkElement.cs](http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/wpf/src/Framework/System/Windows/FrameworkElement@cs/1305600/FrameworkElement@cs)实现中，它`private void TryFireInitialized()`会调用`protected virtual void OnInitialized(EventArgs e)`，因此您可以在其中挂接。

这取决于您需要了解哪些信息。据我所知，唯一能得到通知父母正在改变并且能够访问旧父母的地方是 OnVisualParentChanged （旧父母作为参数传入）。否则，任何其他挂接您的地方都只能访问新的父级，因为它已经被更改了。

您可能还想调查一些继承 FrameworkElement 的类，看看它们是否公开了可以帮助您的任何其他属性或方法。

# ruby-on-rails - 如何发送两封不同的电子邮件以进行设计确认和设计再确认？

> ID：15770070
> 
> 赞同：5
> 
> 时间：2013-04-02T17:07:27.387
> 
> 标签：ruby-on-rails, devise, devise-confirmable

两者都设计可确认（用户注册时的电子邮件确认）和可重新确认（用户更改电子邮件时的电子邮件确认）模块发送相同的电子邮件模板“confirmation_instructions”。如何获取它以便使用不同的电子邮件模板进行确认？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-02-08T14:38:18.967

您可以在邮件程序`options[:template_name]`的方法中覆盖。`#confirmation_instructions`

```
class AuthMailer < Devise::Mailer
  helper :application
  include Devise::Controllers::UrlHelpers
  default template_path: 'devise/mailer'

  def confirmation_instructions(record, token, options={})
    # Use different e-mail templates for signup e-mail confirmation and for when a user changes e-mail address.
    if record.pending_reconfirmation?
      options[:template_name] = 'reconfirmation_instructions'
    else
      options[:template_name] = 'confirmation_instructions'
    end

    super
  end
end 
```

还要从 device.rb 更改此行

```
# config.mailer = 'Devise::Mailer'
config.mailer = 'AuthMailer' 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-02T16:03:53.197

```
#Devise Mailer

def confirmation_instructions(record)
  @resource = record
    if @resource.pending_reconfirmation?
      mail(to: @resource.unconfirmed_email, subject: "Confirm new email") do |format|
        format.html { render ... }
      end
    else
      mail(to: @resource.email, subject: "Confirm new account") do |format|
        format.html { render .... }
      end
    end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T02:19:03.057

刚刚查看了文档，您可以在模型中覆盖一个 send_on_create_notification 方法。所以只需要重写这个方法，这样就不会发送确认电子邮件，而是发送另一封电子邮件。在那封电子邮件中，我只有确认链接。

# django-sessions - 我们如何使用 Django-allauth 和lazysignup

> ID：15770071
> 
> 赞同：3
> 
> 时间：2013-04-02T17:07:28.330
> 
> 标签：django-sessions, django-allauth, lazy-registration

我正在使用 Django-allauth 进行社交和简单的登录。我希望当尚未注册或未登录的用户列出项目候选名单时，当用户注册或登录时，候选名单仍然存在。所以我使用的是 Django-lazysignup。

现在，每次我没有使用 Facebook 登录时都会创建一个新的lazy_user，或者它给我一个“列 user_id 不是唯一的”错误。候选名单也没有转换。

我们如何将两者结合起来？或者我们如何在不使用lazysignup的情况下做到这一点？

对此的任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T21:17:56.863

看看这里：

[https://github.com/pennersr/django-allauth/blob/327f5b60f31e9b3db18d461266084a44f04888dc/allauth/account/adapter.py#L117](https://github.com/pennersr/django-allauth/blob/327f5b60f31e9b3db18d461266084a44f04888dc/allauth/account/adapter.py#L117)

和这里：

[https://github.com/pennersr/django-allauth/blob/327f5b60f31e9b3db18d461266084a44f04888dc/allauth/socialaccount/adapter.py#L40](https://github.com/pennersr/django-allauth/blob/327f5b60f31e9b3db18d461266084a44f04888dc/allauth/socialaccount/adapter.py#L40)

在这里，分别为本地用户和社交用户创建了一个新`User`实例。这些适配器方法可以被覆盖，而不是产生一个新实例，它们可以被更改为返回一个现有的惰性用户实例。

开箱即用`django-allauth`，您可能会遇到无法访问`request`此处实例的问题，但我愿意适应`allauth`您的用例...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-29T21:33:20.017

您可以使用以某种方式调整的[自定义用户模型（Django 1.5）](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#specifying-a-custom-user-model)，例如，它使用会话密钥作为标识符。稍后注册..只需填写用户名和/或电子邮件等。

如果您想保存懒惰的用户交互，即使他们没有注册（例如用于统计用途），这可能是有意义的。我没有测试过这个..但它可能会起作用。:)

# java - 如何分析未列出 Java 进程的 jstatd 问题？

> ID：15770072
> 
> 赞同：0
> 
> 时间：2013-04-02T17:07:30.707
> 
> 标签：java, profiling, jstatd

直到最近，我才能够`jstatd -J-Djava.security.policy=c:\path\to\jstatd.policy`在 Windows 2008 服务器机器上成功运行 jstatd ( ) 和 visualvm (1.3.5)。正确列出了所有正在运行的 Java (1.6.0_31) 进程。出于某种原因，我无法再查看某些正在运行的进程，它们确实正在运行。我该怎么做才能正确分析这一点？

我的策略文件看起来像 jstatd 站点的默认示例：

```
grant codebase "file:${java.home}/../lib/tools.jar" {
   permission java.security.AllPermission;
}; 
```

我不确定如何进一步调查。我在 Linux 下的设置完全相同，并且运行良好。

# ajax - 获取每个帖子 ID 的 .ajax 结果

> ID：15770074
> 
> 赞同：1
> 
> 时间：2013-04-02T17:07:35.647
> 
> 标签：ajax, jquery, each

在 Tumblr 上，我有几篇文章正在尝试使用 .ajax 专门从中获取数据。我正在使用 .each 仅获取音频帖子的数据。但我遇到的问题是它会返回所有帖子，而不仅仅是音频帖子。我什至为每个特定的帖子 ID 指定了 json 路径。我知道我可能设置完全错误，因为我不太熟悉使用 .ajax。

```
$('.audio.post').each(function() {
    var audiopostID = $(this).attr('id');
    var audioPath = '/api/read/json?id=' + audiopostID;

    $.ajax({
        url: audioPath,
        dataType: 'jsonp',
        timeout: 5000,
        success: function(data) {
            console.log(data);
        }
    });
}); 
```

正如我所提到的，它返回所有的帖子，而不是我试图获得的特定帖子`audioPath`。单独的 json 路径确实存在，似乎 .ajax 忽略了单独的路径并抓取了所有内容。这是前两个音频帖子 json 路径：

*   [http://testrtheme.tumblr.com/api/read/json?id=46623753663](http://testrtheme.tumblr.com/api/read/json?id=46623753663)
*   [http://testrtheme.tumblr.com/api/read/json?id=46483357977](http://testrtheme.tumblr.com/api/read/json?id=46483357977)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:39:53.887

您正在从以下代码中提取 ID 字段：

```
<article class="post text brick" id="post-46308156089" data-postID="46308156089" data-permalink="http://testrtheme.tumblr.com/post/46308156089/test"> 
```

这里的id是：

```
post-46308156089 
```

基于此，您的 URL 如下所示：

```
/api/read/json?id=post-46308156089 
```

尝试将您的代码更改为以下内容：

```
$('.audio.post').each(function() {
var fullaudiopostID = $(this).attr('id').split('-');
var audiopostID = fullaudiopostID[1];
var audioPath = '/api/read/json?id=' + audiopostID;

$.ajax({
    url: audioPath,
    dataType: 'jsonp',
    timeout: 5000,
    success: function(data) {
        console.log(data);
    }
});
}); 
```

# javascript - 如何避免 aptana 将 getter 和 setter 检测为 JavaScript 中的错误？

> ID：15770076
> 
> 赞同：3
> 
> 时间：2013-04-02T17:07:39.850
> 
> 标签：javascript, validation, aptana, jslint

我有这个代码：

```
function A(){}
A.prototype = {
    set a(v){},
    get a(){return}
}; 
```

***Aptana 在这一行设置 a(v){}***检测到错误，但它适用于现代浏览器。

我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:31:59.593

Aptana 目前无法识别用于在 JavaScript 中定义 getter 和 setter 的`get`and`set`关键字。您无法解决此问题，但是，有一种方法可以解决它。Aptana 原生使用 JSLint 进行 JavaScript 验证，并允许您过滤掉您可能不关心的警告和错误。

它在那条线上发现的错误是：

> 应为运算符，而是看到“{”。
> 应为“：”，而是看到“a”。

您可以告诉 Aptana 忽略这些，方法是转到**Preferences** -> **Aptana Studio** -> **Validation**，选择**JSLint**验证器，并将这些错误添加到要从验证中过滤的错误和警告列表中（您可以使用整个错误字符串或一些正则表达式）。

**警告**：您可能不想忽略这些错误，因为它们是语法错误，如果您错过它们，将导致您的 JavaScript 在加载时崩溃。

# vb.net-2010 - 当前 Web 请求执行期间发生未处理的异常。

> ID：15770078
> 
> 赞同：1
> 
> 时间：2013-04-02T17:07:44.237
> 
> 标签：vb.net-2010

请尝试从我正在处理的网站申请请求，但我收到此错误： `Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression. Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression. The 'CalCulateClaimForDeath' procedure attempted to return a status of NULL, which is not allowed. A status of 0 will be returned instead.`

源错误将我指向此代码：

`Line 239: Line 240: //finally, execute the command. Line 241: int retval = cmd.ExecuteNonQuery(); Line 242: Line 243: // detach the SqlParameters from the command object, so they can be used again.`

需要帮助。谢谢

# javascript - 在 websocket 中解码延续帧

> ID：15770079
> 
> 赞同：2
> 
> 时间：2013-04-02T17:07:46.273
> 
> 标签：javascript, node.js, websocket

你如何解码websocket中的延续帧？有人可以给我一个有用的见解吗？将延续框架解码为文本框架会导致错误。

我正在向服务器发送一个大文本字符串，我只能设法解码第一个传入的文本帧，然后失败。

这是nodejs中处理文本帧解码的一个简单函数 -

```
function decodeWS(data)
{
    var dl = data[1] & 127;
    var ifm = 2;
    if (dl == 126) 
    {
        ifm = 4;
    } else if (dl == 127) 
    {
        ifm = 10;
    }
    var i = ifm + 4;
    var masks = data.slice(ifm,i);
    var index = 0;
    var output = "";
    var l=data.length;
    while (i < l) 
    {
        output += String.fromCharCode(data[i++] ^ masks[index++ % 4]);
    }
    return output;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-01-06T23:14:26.543

获取特定的帧位

# 鳍片

```
bool fin = (data[0] & 128) == 128; 
```

# 操作码

```
int opCode = data[0] & 15; 
```

# 是蒙面的

```
bool isMasked = (data[1] & 128) == 128; 
```

# 数据长度

```
int dataLength = data[1] & 127; 
```

* * *

# Websocket框架概述

```
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-------+-+-------------+-------------------------------+
|F|R|R|R| opcode|M| Payload len |    Extended payload length    |
|I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
|N|V|V|V|       |S|             |   (if payload len==126/127)   |
| |1|2|3|       |K|             |                               |
+-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
|     Extended payload length continued, if payload len == 127  |
+ - - - - - - - - - - - - - - - +-------------------------------+
|                               |Masking-key, if MASK set to 1  |
+-------------------------------+-------------------------------+
| Masking-key (continued)       |          Payload Data         |
+-------------------------------- - - - - - - - - - - - - - - - +
:                     Payload Data continued ...                :
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
|                     Payload Data continued ...                |
+---------------------------------------------------------------+ 
```

* * *

# 有关如何获取字节的特定位的一般信息

*示例：获取 FIN 位*

首先写下第一个字节的二进制表示，假设第一位是`130`，所以`1000 0010`在二进制或更易于理解的 Fin 位集和二进制数据的操作码 2 中。如果您想要获得最重要的位，您需要使用逻辑 AND (&) 运算符和`128`( `1000 0000`in Binary)。

所以基本上 1 和 1 将是 1，其他一切都将是 0。

```
1000 0010 -> First Byte
1000 0000 -> Our Masking Byte => 128 in Decimal
---------
1000 0000 -> Resulting Byte => 128 in Decimal (Fin bit set) 
```

另一个示例 Fin 位未设置和文本数据。

```
0000 0001 -> First Byte
1000 0000 -> Our Masking Byte -> 128 in Decimal
---------
0000 0000 -> Resulting Byte => 0 in Decimal (Fin bit not set) 
```

*示例：获取 OpCode（OpCode 告诉您此帧的用途）*

OpCode 可以从第一个字节的前 4 位收集。假装 FIN 位已设置且 OpCode 为 Text。

```
1000 0001 -> First Byte
0000 1111 -> Our Masking Byte => 15 in Decimal
---------
0000 0001 -> Resulting Byte => 1 in Decimal (Text OpCode) 
```

# css - 如何使 DIV 在 HTML5 全屏视频上可见？

> ID：15770080
> 
> 赞同：11
> 
> 时间：2013-04-02T17:07:48.693
> 
> 标签：css, html, fullscreen

我现在的最终目标是在视频结束时在视频顶部显示一个链接。使用 JW Players 功能，我已确定如何在视频完成时显示链接，但仅在标准视图中显示。如果用户全屏观看视频，则链接不会出现。我已经广泛阅读并了解，当它处于全屏模式时，视频处于 Flash 状态，如果不将链接集成到 swf 文件中，我无法覆盖 Flash 功能，我不想这样做。

我所做的是使用皮肤删除 JW Player 视频播放器中的全屏按钮。然后我创建了一个按钮，使用 HTML5 全屏功能全屏显示视频。（我知道 IE 不能用这个......现在很好）。我还可以创建一个全屏状态更改事件侦听器，以便我的链接出现在视频顶部。但它不起作用。

无论我如何设计包含链接的 DIV，它都不会出现在视频顶部。

有人可以指出我正确的方向吗？

感谢您提供的任何帮助，任何人都可以给我。

代码示例：

```
#container{
       position:relative;
   z-index:0;
}

#overlay {
   visibility:hidden; 
   width: 700px; 
   height:50px; 
   color:#FFF; 
   position: absolute; 
   top: 532px; 
   margin:8px; 
   padding:5px; 
   background-color:#000;   
   text-align:center;
}

#overlayfullscreen{
   visibility:hidden;
   text-align:center;
   color:#FFF;
   font-size:26px;
   z-index: 1000;
   position: absolute;          
   top: 800px;
   margin:8px; 
   padding:5px; 
   overlay:hidden;          
}

<div id="container">
    Loading the player, if not working please update your browser.
</div>                      

<button onClick="goFullscreen('container'); return false">Click for Fullscreen</button>

var path = '<?php echo $video_path ?>';

jwplayer("container").setup(
{
autostart: <?php echo $autostart ?>,        
file: "<?php echo $full_video_path ?>",                                 
height: <?php echo $height ?>,
width: <?php echo $width ?>,
skin: '<?php echo $skin ?>',

events: {
    onComplete: function(){
         document.getElementById('overlay').style.visibility = 'visible';                                       
      }                                 
    }                                   
});

document.addEventListener("mozfullscreenchange", function () 
{                                   
document.getElementById('overlayfullscreen').style.visibility = 'visible';              
}, false); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-11-20T15:29:58.467

这是一个简单的技巧，您需要将 z-index 的最大值 (z-index: 2147483647;) 添加到覆盖元素中。该技巧将解决您的问题。

```
z-index: 2147483647; 
```

这是您更新的小提琴：http: [//jsfiddle.net/TcpX5/36/](http://jsfiddle.net/TcpX5/36/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:33:40.333

我设置了一个小演示，我使用的是 HTML5 视频，而不是 Flash Player，但行为应该是相同的：http: [//jsfiddle.net/sandro_paganotti/TcpX5/](http://jsfiddle.net/sandro_paganotti/TcpX5/)

要切换全屏，我建议使用 screenfull ( [https://github.com/sindresorhus/screenfull.js](https://github.com/sindresorhus/screenfull.js) )，它基本上可以处理 Firefox 和 Chrome 之间的细微差别。

这是代码，只需将`<video>`元素替换为您的 JW Player 实现即可：

## HTML

```
<div id="video">
    <video width="100%" src="yourmovie.webm" controls></video><br/>
    <button>go full screen</button>
    <a href="#">Special link</a>
</div> 
```

## CSS

```
#video{ position: relative; }
a{  position: absolute; top: 10px; right: 10px;
    border: 1px solid red; display: block; background: #FFF } 
```

## Javascript

```
$('button').click(function(){
    screenfull.request();
}); 
```

最后一点：jsfiddle 禁止全屏模式（来源：[https](https://webapps.stackexchange.com/questions/26730/can-full-screen-mode-be-activated-in-jsfiddle) ://webapps.stackexchange.com/questions/26730/can-full-screen-mode-be-activated-in-jsfiddle ）查看演示，您必须手动使用上面链接中指定的 chrome devtools 或 firebug 调整 jsfiddle iframe。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-27T17:08:38.580

HTML：

```
<div id="wrapper">
  <a>element I want to be visible in full screen mode</a>
  <video ...>
</div> 
```

JS：

```
const wrapper = this.document.getElementById('wrapper')
wrapper.requestFullscreen() 
```

此代码通常会在单击按钮时执行。包装器内的所有元素现在将在全屏模式下可见。您可能需要在全屏模式下对元素应用不同的样式。例如，您可能希望将视频宽度或高度设为 100%

使用它来了解您是否处于全屏模式：

```
document.onfullscreenchange = () => {
  this.isFullScreen = !!document.fullscreenElement
} 
```

使用它退出全屏模式：

```
document.exitFullscreen() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:09:22.397

问题是正在显示视频`absolutely`。您可以使您的链接具有`position: absolute`，并且应该这样做。

# ruby-on-rails - 将 object_id 批量分配给对象

> ID：15770085
> 
> 赞同：1
> 
> 时间：2013-04-02T17:07:59.830
> 
> 标签：ruby-on-rails, ruby, sqlite

我有两个类：`Schedule`它们`Interaction`看起来如下：

```
class Schedule < ActiveRecord::Base
  has_many :interactions

end

class Interaction < ActiveRecord::Base
  attr_accessible :schedule_id

  has_one :schedule

end 
```

迁移如下所示：

```
class CreateSchedules < ActiveRecord::Migration
  def change
    create_table :schedules do |t|
      t.timestamps

    end
  end
end

class CreateInteractions < ActiveRecord::Migration
  def change
    create_table :interactions do |t|
      t.integer :schedule_id

      t.timestamps
    end
  end
end 
```

当我这样做时：

```
irb(main):003:0> interaction_high_1 = Interaction.create()
irb(main):003:0> interaction_high_2 = Interaction.create()
irb(main):003:0> interaction_high_3 = Interaction.create()
irb(main):003:0> interaction_high_4 = Interaction.create()
irb(main):003:0> interaction_high_5 = Interaction.create()

irb(main):003:0> schedule1 = Schedule.create(:name => "high1").interactions << interaction_high_1, interaction_high_2, interaction_high_3, interaction_high_4, interaction_high_5 
```

只`Interaction_high_1`获取指定的**schedule_id**，其余的只是**nul**

谁能告诉我为什么会这样以及我该如何解决？

谢谢你的回答！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:15:12.323

您正在创建交互而不将它们与计划相关联。稍后仅附加它们不会满足您的需要。改为这样做：

```
schedule1 = Schedule.create(:name => "high1")

1...5.times do
  schedule1.interactions.create
end 
```

此外，`:has_one`将交互模型中的 更改为`:belongs_to`.

# java - MongoDB Spring 数据 Criteria.all

> ID：15770086
> 
> 赞同：2
> 
> 时间：2013-04-02T17:08:00.973
> 
> 标签：java, spring, mongodb

在 mongo 控制台中，我有：

```
> db.test.find({})
{ "_id" : ObjectId("515afcfedba6a529520becfa"), "array" : [ { "key" : "one", "value" : 1 }, { "key" : "two", "value" : 2 } ] }
{ "_id" : ObjectId("515b0e48dba6a529520becfd"), "array" : [ { "key" : "one", "value" : 1 }, { "key" : "two", "value" : 2 }, {"key" :"three", "value" : 3 } ] }

> db.test.find({array: {$all:[{key:'one', value:1}, {key:'two',value:2}]}});
{ "_id" : ObjectId("515afcfedba6a529520becfa"), "array" : [ { "key" : "one", "value" : 1 }, { "key" : "two", "value" : 2 } ] }
{ "_id" : ObjectId("515b0e48dba6a529520becfd"), "array" : [ { "key" : "one", "value" : 1 }, { "key" : "two", "value" : 2 }, {"key" :"three", "value" : 3 } ] }

> db.test.find({_id:ObjectId("515afcfedba6a529520becfa"), array: {$all:[{key:'one', value:1}, {key:'two',value:2}]}});
{ "_id" : ObjectId("515afcfedba6a529520becfa"), "array" : [ { "key" : "one", "value" : 1 }, { "key" : "two", "value" : 2 } ] } 
```

如何使用 org.springframework.data.mongodb.core.query.Criteria 编写第二个和第三个查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T08:56:30.857

这是迄今为止我找到的最佳解决方案：

```
...

DBObject obj = new BasicDBObject();
obj.put( "key", 1 );
obj.put( "value", "one" );
DBObject obje1 = new BasicDBObject();
obje1.put( "$elemMatch", obj );

obj = new BasicDBObject();
obj.put( "key", 2 );
obj.put( "value", "two" );
DBObject obje2 = new BasicDBObject();
obje2.put( "$elemMatch", obj );

Query qry = new Query( where("array").all(obje1, obje2) );

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-22T00:14:13.373

这是一个我认为可行的选项：

```
Criteria criteria = new Criteria("array");
criteria.all(Criteria.where("key").is(1).and("value").is("one"),Criteria.where("key").is(2).and("value").is("two"));
Query query = new Query(criteria); 
```

# html - CSS 导航栏

> ID：15770088
> 
> 赞同：0
> 
> 时间：2013-04-02T17:08:15.563
> 
> 标签：html, css, xhtml

我正在玩 CSS，到目前为止我正在尝试制作一个网站。我制作了一个导航栏，它正在下降，所以它是水平的。我需要它穿过，我还需要像 1 条灰线来分隔标签。这是我到目前为止得到的。

HTML：

```
<div class="horizontal">
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="Register.html">Register</a></li>
<li><a href="Rules.html">Rules</a></li>
</ul>
</div> 
```

CSS：

```
div.horizontal
{
width:809px;
height:63px;
position:relative;
top: -1046px;
left: 104px;
}
div.horizontal ul
{
list-style-type:none;
margin:0;
padding:0;
}
div.horizontal li
{
float:left;
}
div.horizontal a
{
display:block;
width:809px;
}
div.horizontal a:link,div.horizontal a:visited
{
font-weight:bold;
color:#FFFFFF;
background-color:#000000;
text-align:center;
padding:4px;
text-decoration:none;
text-transform:uppercase;
}
div.horizontal a:hover,div.horizontal a:active
{
background-color:#999999;
} 
```

所以这又是向下的，我需要它走到一边，就像一条线将每个标签分开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:11:05.497

```
div.horizontal
{
width:809px;
height:63px;
position:relative;
left: 104px;
}
div.horizontal ul
{
list-style-type:none;
margin:0;
padding:0;
}
div.horizontal li
{
display: inline-block;
    margin-left:5px;
}
div.horizontal a
{
display:block;
width:809px;
}
div.horizontal a:link,div.horizontal a:visited
{
font-weight:bold;
display: inline;
color:#FFFFFF;
background-color:#000000;
padding:4px;
text-decoration:none;
text-transform:uppercase;
}
div.horizontal a:hover,div.horizontal a:active
{
background-color:#999999;
} 
```

工作小提琴：

[http://jsfiddle.net/EpPSv/10/](http://jsfiddle.net/EpPSv/10/)

# c# - 正则表达式，子字符串 htmlstring

> ID：15770090
> 
> 赞同：-5
> 
> 时间：2013-04-02T17:08:28.617
> 
> 标签：c#

我有一个要解析的 html 字符串。结果字符串

```
 <table id="Table1">
            <tr>
              <td width="50%">
                 Result: <span style="font-weight:bold; color:GREEN;"></span>
               </td>
               <td width="50%">
                  ID: <span style="font-weight:bold;">790043</span>
               </td>
           </table>
         <table id="Table2">
            <tr>
              <td class="name">
                Status:
             </td>
             <td class="value">
                None
             </td>
             </tr>

        </table>
<br /><br />
<a href="#" onclick="$('#vvvv').toggle();return false;" /></a>
<br />
<div id="pp1" style="displa
</div> 
```

我将如何仅提取/子串两个表格标签中的文本。所以我的 html 字符串将是

```
 <table id="Table1">
            <tr>
              <td width="50%">
                 Result: <span style="font-weight:bold; color:GREEN;"></span>
               </td>
               <td width="50%">
                  ID: <span style="font-weight:bold;">790043</span>
               </td>
           </table>
         <table id="Table2">
            <tr>
              <td class="name">
                Status:
             </td>
             <td class="value">
                None
             </td>
             </tr>

        </table> 
```

请建议

感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:15:10.320

您想转换 HTML 文件吗？这是一项[XSLT](http://en.wikipedia.org/wiki/XSLT)工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:15:50.543

如建议的那样，您应该使用 HTML 解析器，例如[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)。否则，如果您有嵌套结构等，您可能会遇到问题。

不过，对于这个简单的情况，您可以使用这个正则表达式：

```
string html = Regex.Match(ResultsString,
                          @"<table.+<\/table>",
                          RegexOptions.Singleline).Value; 
```

但同样，只有当您的输入字符串像您向我们展示的那样简单！

# php - php pdo多行插入

> ID：15770092
> 
> 赞同：0
> 
> 时间：2013-04-02T17:08:28.963
> 
> 标签：php, mysql, pdo

我在一个 pdo 查询中插入多行时遇到了一些麻烦。我使用我制作的这段代码。但是当我在数据库中查看插入时，自动增量 id 会上升，但缺少一些插入。只有第一个插入留在数据库中。

```
id  idcom   couleurb    couleurf    taille
169 160 blanc       grisfonc    Tableau L
170 161 blanc       grisfonce   Tableau L
172 162 blanc       grisfonce   Tableau L   

<?php    
foreach ($panier->getContenu() as $produit) {
    $queryTableau = $bdd->prepare('INSERT INTO tableaux (idcommande, colorfront, colorback, size, police, mots) VALUES (:id, :cf, :cb, :si, :po, :mo)');
    $queryTableau->bindParam(':id', $id);
    $queryTableau->bindParam(':cf', $cf);
    $queryTableau->bindParam(':cb', $cb);
    $queryTableau->bindParam(':si', $si);
    $queryTableau->bindParam(':po', $po);
    $queryTableau->bindParam(':mo', $mo);

    $description = $produit->getDescription();
    $id = $_SESSION['commande']['id'];
    $cf = $description['couleurFront'];
    $cb = $description['couleurBack'];
    $si = $produit->getNameProduit();
    $po = $description['police'];
    $mo = $description['mots'];

    $queryTableau->execute();
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:39:14.340

根据[http://php.net/manual/en/pdostatement.execute.php](http://php.net/manual/en/pdostatement.execute.php)一些驱动程序需要在执行下一条语句之前关闭光标。

```
$queryTableau->execute();
$queryTableau->closeCursor(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:15:46.450

不要在每次 foreach 迭代中进行准备。

```
<?php    

$queryTableau = $bdd->prepare('INSERT INTO tableaux (idcommande, colorfront, colorback, size, police, mots) VALUES (:id, :cf, :cb, :si, :po, :mo)');

foreach ($panier->getContenu() as $produit) {

    $queryTableau->bindParam(':id', $id);
    $queryTableau->bindParam(':cf', $cf);
    $queryTableau->bindParam(':cb', $cb);
    $queryTableau->bindParam(':si', $si);
    $queryTableau->bindParam(':po', $po);
    $queryTableau->bindParam(':mo', $mo);

    $description = $produit->getDescription();
    $id = $_SESSION['commande']['id'];
    $cf = $description['couleurFront'];
    $cb = $description['couleurBack'];
    $si = $produit->getNameProduit();
    $po = $description['police'];
    $mo = $description['mots'];
   $queryTableau->execute();
 }
?> 
```

看看将您的数据与准备/执行分开是否可以解决您的一些问题。

# iphone - 使用 NSDictionary iPhone 读取字符串

> ID：15770095
> 
> 赞同：1
> 
> 时间：2013-04-02T17:08:34.020
> 
> 标签：iphone, objective-c, xcode, theos

我想知道如何构建一个从设置中读取文本/字符串的应用程序。是的，这仅适用于越狱设备。是的，我知道我不能把它放到应用商店。

我已经知道如何用 int 或 bool 来做，但我对字符串没有任何想法，请帮助我！这是代码：

```
int F1;
bool F2; 
```

这是它的读取方式：

```
F1 = [[[NSDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences/com.xx.pxx.plist"]valueForKey:@"kF1"]intValue];
F2 = [[[NSDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences/com.xx.pxx.plist"]objectForKey:@"kF2"]boolValue]; 
```

EDIT1：以及我必须如何或在设置 plist 中更改什么：

```
 <dict>
        <key>cell</key>
        <string>PSSwitchCell</string>
        <key>default</key>
        <true/>
        <key>defaults</key>
        <string>com.xx.pxx</string>
        <key>key</key>
        <string>kF1</string>
        <key>label</key>
        <string>Activate the tool</string>
    </dict> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:10:43.320

对于字符串：

```
NSString *string = [[NSDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences/com.xx.pxx.plist"]objectForKey:@"kF2"]; 
```

# c# - 重命名数据表中的行

> ID：15770096
> 
> 赞同：3
> 
> 时间：2013-04-02T17:08:41.607
> 
> 标签：c#, sql-server, datatable, sqldatareader

我目前正在为第 3 方应用程序使用数据库，该应用程序没有对我正在使用的列中的数据进行表单检查。我正在使用`SqlDataReader`（因为这不需要修改数据库中的现有表）将数据放入数据表并删除重复项，但是当我删除重复项时，我仍然会因为不同的人错误地输入数据而留下垃圾重复项。例如;

*   苹果
*   应用程序
*   香蕉
*   班南
*   巴纳
*   奥朗
*   ETC...

如何在数据表中更正它们，以便数据表只有 Apple、Orange 等...

幸运的是，此列中只有几个不同的项目，并且都以不同的字符串开头，例如 cen、cas，所以如果我能够更改所有以 app 开头的项目

不幸的是，修改原始程序以在输入时检查数据不是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:00:13.737

我认为这个脚本会对你有所帮助。

```
update [TableName]
set [ColumnName] = 'someName'
where [ColumnName] in 
(
select [ColumnName] from [TableName]
where [ColumnName] != 'someName'
and [ColumnName] != 'someName'
and [ColumnName] != 'someName'
and [ColumnName] != 'someName'
and [ColumnName] != 'someName'
)
--to be safe google "begin transaction" and how to "rollback" the changes 
```

更改列名称后，您可以根据更改的名称删除列。

```
delete [TableName]
where [ColumnName] = 'TheName' 
```

# jsf-2 - JSF Mojarra 中的文档类型

> ID：15770100
> 
> 赞同：4
> 
> 时间：2013-04-02T17:08:47.083
> 
> 标签：jsf-2, doctype, mojarra

我应该在 JSF 页面中使用什么 Doctype？前几天我试图从 Mojarra 2.1.13 迁移到 2.1.18，似乎解释文档类型的方式发生了变化。在根模板中，我有以下 DOC TYPE

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

我也必须包括这个吗？

```
<?xml version="1.0"?> 
```

在复合材料（使用此模板）中，我曾经有以下 doctype

```
 <!DOCTYPE composite PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

但似乎 Mojarra 2.1.18 并不真正支持这一点。此外，我在任何 JSF 2.0 参考资料中都没有找到它，这是我们曾经在 JSF 1.2 中使用的。如果我在复合页面中有这个 doctype，它将呈现复合 doctype 而不是模板中的 html。结果，css 样式被弄乱了。

那么 JSF 2.0 中文档类型的正确用法是什么？或者这是 Mojarra 的问题？我没有找到任何关于此的参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T14:51:00.913

我为此创建了一个 JIRA 问题：http: [//java.net/jira/browse/JAVASERVERFACES-2820](http://java.net/jira/browse/JAVASERVERFACES-2820)

它已被关闭，因为这是预期的行为。

“复合页面是您实际使用模板的地方。因此，它是您指定文档类型的最外层文件。因此，它定义了将呈现的文档类型。”

只需在模板中指定文档类型即可

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T08:39:58.093

我还将 Jboss 7.1 迁移到了 JBoss EAP 6.1

我发现不是很好的解决方法 - 在每个页面上插入（不是模板）：

```
<!DOCTYPE html> 
```

例如：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html" template="template.xhtml"> 
```

还有其他方法 - 从主模板中读取 doctype 吗？

# performance - Haskell获取函数运行时间

> ID：15770109
> 
> 赞同：0
> 
> 时间：2013-04-02T17:09:39.933
> 
> 标签：performance, haskell

如何捕获 Haskell 函数的运行时，例如，使用 GHC 编译的文件 Main.hs，其中包含对列表中的项目进行排序的函数“bubbleSort”：

```
 bubbleSort :: (Ord t) => [t] -> [t]
 bubbleSort a = loop (length a) bubble a 

 bubble :: (Ord t) => [t] -> [t]
 bubble (a:b:c) | a < b = a : bubble (b:c)
       | otherwise = b : bubble (a:c)
 bubble (a:[]) = [a] 
 bubble [] = []

 loop :: (Num a, Ord a) => a -> (t -> t) -> t -> t
 loop num f x | num > 0 =  loop (num-1) f x'
     | otherwise = x
     where x' = f x 
```

注意：我知道这不是最有效的排序方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:44:29.223

你可以试试这样的标准，

```
import System.Random
import Data.List
import Criterion.Main
import Criterion.Config

bubbleSort :: (Ord t) => [t] -> [t]
bubbleSort a = loop (length a) bubble a 

loop :: (Num a, Ord a) => a -> (t -> t) -> t -> t
loop num f x 
    | num > 0 =  loop (num-1) f x'
    | otherwise = x
        where x' = f x

bubble :: (Ord t) => [t] -> [t]
bubble (a:b:c) | a < b = a : bubble (b:c)
               | otherwise = b : bubble (a:c)
bubble (a:[]) = [a] 
bubble [] = []

randomlist :: Int -> StdGen -> [Int]
randomlist n = take n . unfoldr (Just . random)

main = do 
    seed <- newStdGen 
    let 
        xs100  = randomlist 100  seed  
        xs500  = randomlist 500  seed 
        xs2500 = randomlist 2500 seed 
      in defaultMainWith defaultConfig (return ()) [
            bgroup "bubble" [
                bench "bubble 100"  $ nf bubble xs100
              , bench "bubble 500"  $ nf bubble xs500
              , bench "bubble 2500" $ nf bubble xs2500
              ],
            bgroup "bubble Sort" [
                bench "bubbleSort 100"  $ nf bubbleSort xs100
              , bench "bubbleSort 500"  $ nf bubbleSort xs500
              , bench "bubbleSort 2500" $ nf bubbleSort xs2500
              ]
            ] 
```

而输出，

```
warming up
estimating clock resolution...
mean is 2.181457 us (320001 iterations)
found 41466 outliers among 319999 samples (13.0%)
  2428 (0.8%) low severe
  39038 (12.2%) high severe
estimating cost of a clock call...
mean is 105.7764 ns (13 iterations)

benchmarking bubble/bubble 100
mean: 5.174493 us, lb 5.158926 us, ub 5.190592 us, ci 0.950
std dev: 80.64570 ns, lb 70.99540 ns, ub 93.12886 ns, ci 0.950
variance introduced by outliers: 8.479%
variance is slightly inflated by outliers

benchmarking bubble/bubble 500
mean: 28.41568 us, lb 28.22828 us, ub 28.64927 us, ci 0.950
std dev: 1.071815 us, lb 843.6888 ns, ub 1.531296 us, ci 0.950
found 4 outliers among 100 samples (4.0%)
  2 (2.0%) high mild
  1 (1.0%) high severe
variance introduced by outliers: 34.577%
variance is moderately inflated by outliers

benchmarking bubble/bubble 2500
mean: 132.3620 us, lb 131.0149 us, ub 134.1072 us, ci 0.950
std dev: 7.802474 us, lb 6.333342 us, ub 11.58801 us, ci 0.950
found 1 outliers among 100 samples (1.0%)
  1 (1.0%) high severe
variance introduced by outliers: 56.487%
variance is severely inflated by outliers

benchmarking bubble Sort/bubbleSort 100
mean: 399.7690 us, lb 398.7208 us, ub 400.7847 us, ci 0.950
std dev: 5.291009 us, lb 4.761788 us, ub 5.961798 us, ci 0.950
variance introduced by outliers: 6.563%
variance is slightly inflated by outliers

benchmarking bubble Sort/bubbleSort 500
mean: 15.42273 ms, lb 15.26078 ms, ub 15.60196 ms, ci 0.950
std dev: 872.8984 us, lb 784.0365 us, ub 967.8269 us, ci 0.950
variance introduced by outliers: 54.470%
variance is severely inflated by outliers

benchmarking bubble Sort/bubbleSort 2500
collecting 100 samples, 1 iterations each, in estimated 48.56091 s
mean: 473.5322 ms, lb 472.0005 ms, ub 474.9877 ms, ci 0.950
std dev: 7.695022 ms, lb 6.700990 ms, ub 9.001423 ms, ci 0.950
found 2 outliers among 100 samples (2.0%)
  2 (2.0%) low mild
variance introduced by outliers: 9.408%
variance is slightly inflated by outliers 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:49:58.057

最简单、最简单的方法是，首先使用 编译文件`ghc --make yourfile.hs`，然后在 shell *⁄*命令提示符下运行它`> yourfile +RTS -s`并检查统计信息打印输出。

该文件应以

```
{-# OPTIONS_GHC -O2 #-}

module Main 
where 
```

并包含一个`main`类型的值`IO ()`，例如

```
main :: IO ()
main = print $ bubbleSort ([1..50]++[42]) 
```

要从中获得任何有意义的读数，您应该找出算法的[经验增长顺序](http://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth)；只有一个数据点不会告诉你太多。

# wpf - 动画后窗口奇怪的冻结边缘

> ID：15770110
> 
> 赞同：0
> 
> 时间：2013-04-02T17:09:45.627
> 
> 标签：wpf, animation, user-controls, storyboard, transitions

好的，我是唯一遇到这种事情的人吗？我有一个简单的故事板：

```
 <Storyboard x:Key="slideInStoryboard" >
    <ThicknessAnimation Duration="0:0:.75" Storyboard.TargetProperty="Margin" To="1,0,0,0" DecelerationRatio=".9" />
    <DoubleAnimation Duration="0:0:.25" Storyboard.TargetProperty="Opacity" From="0" To="1" />
</Storyboard> 
```

我从 CodeBehind 实例化并运行它以进行页面转换：

```
 private void ShowModule(string currentModule)
    {
        Storyboard sIn = (Storyboard)this.FindResource("slideInStoryboard");
        Storyboard sOut = (Storyboard)this.FindResource("slideOutStoryboard");

        foreach (UserControl uc in ModulesPanel.Children)
        {
            if (uc.Name == currentModule)
            {
                uc.BeginStoryboard(sIn);
            }
            else
            {
                uc.BeginStoryboard(sOut);
            }
        }            
    } 
```

slideOutStoryboard 相同但方向相反。看起来不错。一切似乎都按预期工作，除了：当包含的窗口展开时（默认情况下开始），屏幕左侧 2 英寸左右内的任何控件都不会响应点击或任何东西。如果我抓住窗口的左边距并将其向右移动几英寸，然后我可以在这些文本框内单击并单击组合框的箭头等。一旦我抓住左边距并将其拖回左边，它们就会再次停止工作。他们几乎看起来残疾，但没有变灰。如果我删除动画，则没有任何问题。

是的，我绝对是一个新手，但我肯定不知道我是如何使屏幕左侧无响应的！欢迎任何帮助，甚至是建议的提示！提前致谢。

# php - 需要在 php 文件中创建一个数组，并在每次通过 ajax 调用该 php 文件时为其添加值

> ID：15770111
> 
> 赞同：0
> 
> 时间：2013-04-02T17:09:55.233
> 
> 标签：php, ajax, arrays, multidimensional-array

我需要在 php 文件中创建一个数组，并在每次通过 ajax 调用该 php 文件时为其添加值（如 $array[] = something）

我尝试过使用全局和会话，但不起作用我在文件中有这样的内容：

每次从 javascript (ajax) 代码调用 php 时，都会更改 $_GET['index']。

```
if(isset($_GET['value']) && isset($_GET['next']) && isset($_GET['actl']) && isset($_GET['index'])){
  $_SESSION['filters'][$_GET['index']]['id_feature'] = $_GET['actl'];
  $_SESSION['filters'][$_GET['index']]['value'] = $_GET['value'];

  print_r($_SESSION['filters']);
} 
```

问题是重置其值并始终显示添加到数组中的最后一个值。

请原谅我的英语

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:13:02.077

*不是答案，只是带有大量代码的评论*

这个：

```
$a = array();
$a[]['id_feature'] = $_GET['actl'];
$a[]['value'] = $_GET['value']; 
```

可能会这样做：

```
array(
    0 => array(
        "id_feature" => "foo"
    ),
    1 => array(
        "value" => "bar"
    )
) 
```

但是，你可能想得到这个：

```
array(
    0 => array(
        "id_feature" => "foo",
        "value" => "bar"
    )
) 
```

像这样写：

```
$a = array();
$a[] = array(
    'id_feature' => $_GET['actl'],
    'value' => $_GET['value']
); 
```

# javascript - 主干获取属性返回未定义

> ID：15770112
> 
> 赞同：0
> 
> 时间：2013-04-02T17:10:07.030
> 
> 标签：javascript, jquery, backbone.js, backbone-views, backbone-events

我的骨干模型定义如下：

```
define (require) ->
 Backbone = require 'backbone'
 class IndexModel extends Backbone.Model
  defaults:
    status: ""
    country: ""
    language: "" 

  initialize: (attributes,options) ->
    @set 'country', attributes.country
    @set 'language', attributes.language ||= 'en'

  url: -> "/v0/index/#{@get 'country'}/#{@get 'language'}.json" 
```

然后我的观点是这样的：

```
define (require) ->
 Backbone = require 'backbone'
 template = require 'text!templates/index-page.html'
 IndexModel = require 'cs!models/index'

class IndexView extends Backbone.View
  template: _.template(template)

  el: 'article.main'
  events:
   "click .image_button": "connect"

  initialize: ->
    _.bindAll(@, "render","connect")
    @render()

  render: ->
    @$el.html(@template)

  connect: (e) ->
   @model = new IndexModel({country: e.currentTarget.alt, language: window.language})
   @model.save()
   console.dir @model
   console.log 'Status: ', @model.get 'status
   no 
```

我正在尝试获取状态属性，但它似乎是空的并且返回未定义。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:01:03.780

我假设正在服务器上设置“状态”属性。如果是这样，则 model.save() 调用是异步的，并且该属性在完成之前将不可用。要访问它，您需要绑定到调用 save 时传递的成功回调，例如：

```
_self = @
@model.save success: ->
  console.log 'Status: ', _self.model.get('status') 
```

或者，您可以绑定到模型上的“同步”事件，该事件将在每次成功保存后触发，例如：

```
@model.on 'sync', (model) ->
  console.log 'Status: ', model.get('status') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T14:12:02.297

@robmisio 非常感谢您的回复，我尝试了您的两个建议，但没有一个对我有用.. 我使用这个解决方法...

```
connect: (e) ->
  @model = new IndexModel({country: e.currentTarget.alt, language: window.Language})
  $('#spinner_ajax').show()
  @model.save(null, {
    success: @success
    error: @error
  })

error: (xhr, status, thrown) ->
  console.log "AJAX Error: #{status}"
  alert "AJAX Error: #{status}: Server is probably down."
  $('#spinner_ajax').hide();
  no
success: (model) ->
  console.log "Status: #{model.get('status')}"
  if model.get('status')
    window.lmStatus = true
    window.location.hash = 'connection'
    $('#spinner_ajax p').html('You are being redirected ')
  else
    alert 'This connection is currently not active.'
    $('#spinner_ajax').hide();
  no 
```

# perl - 原型不匹配错误（perl）

> ID：15770114
> 
> 赞同：18
> 
> 时间：2013-04-02T17:10:14.763
> 
> 标签：perl, module

将我编写的模块导入我的 Dancer 应用程序时，我遇到了这个奇怪的错误。

```
Prototype mismatch: sub main::from_json: none vs ($@) at mymodule.pm line 6.
Prototype mismatch: sub main::to_json: none vs ($@) at mymodule.pm line 6. 
```

我想这是因为在我的模块中我正在导入 perl JSON 模块。

一切似乎都很好，但我想知道这个错误/警告是怎么回事？我似乎在网上找不到任何关于它的信息。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-05-28T15:00:39.793

出现这种情况的另一种情况是，当*您加载的其他模块*定义了 from_json/to_json 时。我最近多次提到的一个例子是 Dancer。如果你有一个包

```
package Foo;

use Dancer qw/:syntax/;
use JSON;

1; 
```

您将收到该警告，因为（显然）具有 :syntax 导入的 Dancer 将 from_json 和 to_json 放入您的命名空间。

在这种情况下，一个快速的解决方案是从 JSON 中显式导入任何内容：

```
package Foo;

use Dancer qw/:syntax/;
use JSON qw//;

1; 
```

然后在您的代码中，您将需要使用完整的包名来获取 JSON 的 subs，如下所示：

```
my $hash = JSON::from_json('{"bob":"sally"}'); 
```

但是，在这种情况下，*您希望使用完整的包名称*，以便清楚您获得的是哪个函数——to_json/from_json 有多个声明，所以让我们非常清楚我们指的是哪一个。

如果您将以下内容放入 Foo.pm 并使用“perl Foo.pm”运行，无论有无`qw//`后`use JSON`，您都可以看到它是如何工作的：

```
package Foo;

use Dancer qw/:syntax/;
use JSON qw//;

print Dumper( JSON::from_json('{"bob":"sally"}') ); use Data::Dumper;

1; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-11T12:47:06.083

我相信 Dancer/2 提供`to_json`给`from_json`你，所以你不必使用 JSON。

这将起作用：

```
use Dancer2 ':syntax';
get '/cheeseburgers' => {
    return to_json($restaurant->make_cheeseburgers);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T18:18:01.240

我收到此错误的原因是因为在我自己的模块中，我在声明自己的包命名空间之前使用了 use 指令并导入 JSON 和其他模块，

```
package mymodule 
```

而不是之后。包声明必须放在第一位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T17:15:48.963

[请参阅perlsub](http://p3rl.org/perlsub)中的原型。函数`from_json`和`to_json`定义的原型与代码中使用的原型不同。

# iphone - 如何从 UILabel 获取字体样式？

> ID：15770115
> 
> 赞同：-2
> 
> 时间：2013-04-02T17:10:15.300
> 
> 标签：iphone, ios, uilabel

如何获取 UILabel 的字体样式？是粗体还是斜体？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:12:38.250

您将需要检查字体名称。

`myLabel.font.fontName`

[http://developer.apple.com/library/ios/documentation/uikit/reference/UIFont_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006891-CH4-SW16](http://developer.apple.com/library/ios/documentation/uikit/reference/UIFont_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006891-CH4-SW16)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:22:34.693

试试这个：

```
NSAttributedString *string=yourLabel.attributedText;
if ([[textFieldFontName rangeOfString:string] length] > 0){
    NSLog(@"Bold");
}
if ([[textFieldFontName rangeOfString:string] length] > 0){
    NSLog(@"Italic");
} 
```

**请注意，如果您的字符串同时包含两者，这可能不起作用*

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-02T17:14:08.110

在界面构建器（xib 或故事板）中选择您的标签，然后转到 Attributes Inspector。按字体单击“T”，然后将字体设置为自定义。现在您可以更改字体、大小等。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-03T09:03:14.843

```
UILabel *myLabel;   
myLabel.font = [UIFont fontWithName:@"fontName" size:16.0];//set font according your choice
myLabel.font = [UIFont boldSystemFontOfSize:16.0];//bold font
myLabel.font = [UIFont systemFontOfSize:16.0];//system font 
```

希望对你有帮助......

# flash - 如何使我在 Flash 中插入的图像服从我的图层顺序？

> ID：15770118
> 
> 赞同：0
> 
> 时间：2013-04-02T17:10:25.833
> 
> 标签：flash, actionscript, layer

所以我用动作脚本将图像动态插入到 Flash 中；那没问题。但是，我想将图像设置为显示在按钮层下方，因为当我插入图像时，它会覆盖所有按钮。

我试过“addChildIndex(myLoader, 0)”，但它似乎把图像放在所有东西后面，增加索引号也有同样的效果。

我已经将我的actionsript 层放在按钮层下面，认为这会起作用，但当然不是那么简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T20:33:06.760

试试这个：

```
addChildAt(myLoader, getChildIndex(yourDisplayObject)); 
```

其中“yourDisplayObject”是您希望加载程序出现在后面的显示对象（我猜是您的情况下的按钮）

这会将 myLoader 添加到 yourDisplayObject 占用的“深度”，并将 yourDisplayObject（以及它前面的任何其他对象）向上移动一个级别/深度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T15:53:50.483

有人为我想出了一个解决办法；而不是“addChildIndex（myLoader，#）”更改“numChildren -#”的数字。它将图像推回到每个对象后面。如果我的功能有误，请纠正我。

# matlab - 在 Matlab 中生成版本信息（Matlab 编译器）

> ID：15770120
> 
> 赞同：5
> 
> 时间：2013-04-02T17:10:36.547
> 
> 标签：matlab, dll, version-control, compiler-construction

我目前正在使用 Matlab 编译器生成一些 DLL（点网）。为了我自己，我想在我的 DLL 中添加一个版本信息（这将在设置信息中可见）

有人可以向我解释我必须遵循的步骤来做这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T14:06:44.713

[检查这个](http://www.mathworks.com/support/solutions/en/data/1-2GWE9P/)

标题：如何在 MATLAB 7.13 (R2011b) 中为使用 Microsoft Visual C/C++ 编译器编译的 DLL 指定版本信息？

# ios - iOS 中的可编辑字段

> ID：15770122
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:10:39.240
> 
> 标签：ios, xcode, sqlite, plist, field

我正在构建应用程序，将有一个“管理面板”，可以在其中打开和关闭功能。我开始意识到我不确定这将如何工作。我会创建一个 Db 并使其可编辑，还是需要制作一个 plist 并让选项从那里工作？一些可以打开和关闭的选项的范围从页面到页面的某些部分。任何人有任何建议或某个地方可以为我指明获得这个答案的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:14:35.737

这个问题非常广泛，答案可能是“视情况而定”。一种典型的方法是在那里利用`NSUserDefaults`和存储偏好。阅读[有关 NSUserDefaults 的文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)并查阅[Preferences and Settings Programming Guide](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html#//apple_ref/doc/uid/10000059i)以获得更大的图景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:40:39.947

我最近这样做了，并决定不使用数据库来存储这些选项，因为仅存储一些设置似乎不必要地复杂。OTOH，我选择不使用 plist。最后，我决定使用 NSKeyedArchiver 将这些设置保存到文件系统中的文件中。我反对 plist 的决定是基于我有几个想要保存的复杂数据结构的事实。

可能它可以在 plist 或使用 NSDefaults 中完成，但保存和加载方法只需要几行代码，然后我创建了一个包含我需要保存的所有项目的类。

如果我再做一次，我想我会以同样的方式做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:05:23.597

您决定如何保存数据取决于您。您可以尝试[NSUSerDefaults](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)。

无论您如何存储数据，您都可以使用单元格样式为 UITableViewCellStyleValue1 的可编辑 [UITableView](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/c/econst/UITableViewCellStyleValue1)。这类似于在“设置”应用程序中处理的设置数量。

> `UITableViewCellStyleValue1`
> 
> 单元格左侧带有标签的单元格样式，带有左对齐和黑色文本；右侧是具有较小蓝色文本且右对齐的标签。设置应用程序使用这种样式的单元格。

# asp.net-mvc - 无法调用 Delete Web Api

> ID：15770123
> 
> 赞同：0
> 
> 时间：2013-04-02T17:10:40.323
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-web-api

当我尝试调用 Delete Web API 时，我得到：

```
NetworkError: 404 Not Found - /api/tradespendentryip/5 
```

我的 API 控制器如下所示：

```
public class TradeSpendEntryIPController : ApiController
{
    // DELETE api/tradespendentryip/5
    public void Delete(int id)
    {
        string x = id.ToString(); //I put a breakpoint here which never gets hit
    }
} 
```

我用这个 jQuery 片段调用它，硬编码创建 Web API 时生成的提示 URL：

```
$.ajax({
                type: "DELETE",
                url: "/api/tradespendentryip/5"
                }).done(function( msg ) {
                    alert( 'Record deleted.');
                }).fail(function(jqXHR, textStatus){
                    alert('Unable to delete this record at this time.');
                }); 
```

检查 Firebug 中的网络选项卡，我总是得到“NetworkError：404 Not Found - /api/tradespendentryip/5”

根据网络上的一些研究，我尝试调整我的 web.config 以便 WebDAV 不会干扰：

```
<modules runAllManagedModulesForAllRequests="true">
  <remove name="WebDAVModule" />
  <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" preCondition="managedHandler" />
  <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" preCondition="managedHandler" />
  <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" preCondition="managedHandler" />
</modules>
<handlers>
  <remove name="WebDAV" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
</handlers> 
```

有没有人知道可能是什么问题？我的日志中也生成了这个事件，表明“**路径'DELETE'被禁止。** ”：

```
Event code: 3005 
Event message: An unhandled exception has occurred. 
Event time: 02/04/2013 1:50:18 PM 
Event time (UTC): 02/04/2013 4:50:18 PM 
Event ID: 646d46d6edab4c049b10948279201c2f 
Event sequence: 42 
Event occurrence: 1 
Event detail code: 0 

Application information: 
Application domain: 972ee575-22-130093949467510162 
Trust level: Full 
Application Virtual Path: / 
Application Path: C:\Sites\TPS\Development\Source\TPS\Source\TPS.Website\ 
Machine name: MACHINENAME

Process information: 
Process ID: 6532 
Process name: WebDev.WebServer40.exe 
Account name: domain\chardie 

Exception information: 
Exception type: HttpException 
Exception message: Path 'DELETE' is forbidden. 
```

在 System.Web.HttpMethodNotAllowedHandler.ProcessRequest(HttpContext context) 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep 步骤，布尔和完成同步)

```
Request information: 
Request URL: /Canada/TradeSpendingSales/api/tradespendentryip/5 
Request path: /Canada/TradeSpendingSales/api/tradespendentryip/5 
User host address: ::1 
User: domain\chardie 
Is authenticated: True 
Authentication Type: NTLM 
Thread account name: domain\chardie 

Thread information: 
Thread ID: 14 
Thread account name: domain\chardie 
Is impersonating: False 
Stack trace:    at System.Web.HttpMethodNotAllowedHandler.ProcessRequest(HttpContext context)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:30:48.797

你在什么网络服务器上开发？我相信旧的卡西尼开发服务器除了get和post之外对http动词没有很好的支持。如果您使用的是 cassini，请尝试使用 IIS Express。

# asp.net - 如何更改一个下拉列表中的值取决于 aspx 中另一个下拉列表中的值

> ID：15770125
> 
> 赞同：0
> 
> 时间：2013-04-02T17:10:47.933
> 
> 标签：asp.net, vb.net, sql-server-2008

我在 aspx 页面中有两个下拉框。一个用于位置，一个用于供应商列表。我正在从此位置的下拉列表中获取值

```
 SELECT Location_ID LocationID, Location_Name LocationDesc, BusinessID
 FROM inventory.tbl_location
union 
SELECT '' LocationID,'select a location' LocationDesc,0 BusinessID
ORDER BY BusinessID,Location_Name 
```

我可以从中获取供应商下拉列表中所有记录的列表：

```
SELECT p.PayeeID, isnull(Name1_Last,'') + ',  ' + isnull(Name1_First,'') VendorName, b.BusinessID
from tblVendor_Payees p join tblVendor_Business b 
on p.PayeeID=b.PayeeID 
where VendorType=1
order by isnull(Name1_Last,'') + ',  ' + isnull(Name1_First,'') 
```

我只想根据位置下拉列表列出那些供应商记录。怎么做？。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:29:05.197

您将设置一个下拉列表，该列表将数据绑定到单独的选择语句以获取供应商类型。

您的查询看起来像这样

```
 SqlCommand cmd = new SqlCommand();
            cmd.CommandText = "
SELECT p.PayeeID, isnull(Name1_Last,'') + ',  ' + isnull(Name1_First,'') VendorName, b.BusinessID
from tblVendor_Payees p join tblVendor_Business b 
on p.PayeeID=b.PayeeID 
where VendorType= @vender 
order by isnull(Name1_Last,'') + ',  ' + isnull(Name1_First,'') "

cmd.Parameters.Add("@vender", SqlDbType.VarChar).Value = drop_down_list_vendor .Text; 
```

然后您所要做的就是构建用户从中选择供应商的下拉列表。

# javascript - 允许公开 dynamodb 只读用户的密钥是错误的吗？

> ID：15770131
> 
> 赞同：0
> 
> 时间：2013-04-02T17:11:16.147
> 
> 标签：javascript, amazon-web-services, amazon-dynamodb

所以我有一个 dynamodb 表，我使用 iam 控制台在一个组中创建了一个用户，该用户对该表具有只读访问权限。

在客户端 javascript 中使用此用户私钥有什么问题，以便我可以签署对表的 GET 请求并使用 ajax 直接从表中提取？我的意思是，如果表中的所有信息都是公开的，那么只读访问密钥是否已知并不重要吗？

我知道我可以设置一个令牌自动售货机，但我想知道对于一个全部内容都公开可用的表的只读访问权限，我可以绕过 TVM 而不关心公开私钥吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T22:18:05.423

这实际上似乎是一个非常糟糕的主意。你应该在你的 javascript 和 Dynamo 之间实现一个 web 服务。这将提供一些好处：

*   您将对最终用户隐藏数据库凭据
*   您可以控制服务器的 CORS 策略以实际允许跨域请求
*   您可以控制验证请求是否来自有效用户，以便您应该将请求传递给 Dynamo
*   您可以以最方便在 javascript 中使用的方式格式化对客户端的响应
*   如果合适，您可以引入响应缓存以进一步减少对 Dynamo 的读取
*   您可以将数据库交互逻辑放在更容易维护/改进和向客户端推出更改的服务器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:34:10.400

您可能成为 DoS 攻击的受害者，防御起来会很痛苦。

假设攻击者获取了您的密钥并开始发出大量请求：您可能会消耗所有读取单元，这会给其他客户端带来问题。如果您取消该令牌，那么所有其他合法用户也会遇到问题。最后，如果您有自动缩放功能，您最终可能会收到巨额账单。

# wcf - wcf 具有单个地址的多个端点

> ID：15770135
> 
> 赞同：2
> 
> 时间：2013-04-02T17:11:24.100
> 
> 标签：wcf

我已经在我的应用程序中导入了很多 wcf 服务。例如

```
<endpoint address="http://localhost:1044/PersonSearchWebService.svc" behaviorConfiguration="ClientBehavior"
            binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IPersonSearchWebService"
            contract="WSPersonSearch.IPersonSearchWebService" name="BasicHttpBinding_IPersonSearchWebService" />
        <endpoint address="http://localhost:1044/TransferService.svc"
            binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_ITransferService"
            contract="WSFileTransfer.ITransferService" name="BasicHttpBinding_ITransferService" />
        <endpoint address="http://localhost:1044/ScannedFileSearchWebService.svc"
            binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IScannedFileSearchWebService"
            contract="WSScannedFileSearch.IScannedFileSearchWebService"
            name="BasicHttpBinding_IScannedFileSearchWebService" /> 
```

它们都共享相同的服务器地址。我可以将它们提取到一个变量中，因此当我移动到实时服务器时，我只需要在一个空间中修改配置吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:14:18.780

您可以在服务配置中定义**基地址**，然后根据该基地址在端点中使用相对地址：

```
<service name=".....">
   <host>
      <baseAddresses>
         <add baseAddress="http://localhost:1044/" />
      </baseAddresses>
   </host>

   <endpoint name="BasicHttpBinding_IPersonSearchWebService"
       address="PersonSearchWebService.svc" 
       behaviorConfiguration="ClientBehavior"
       binding="basicHttpBinding" 
       bindingConfiguration="BasicHttpBinding_IPersonSearchWebService"
       contract="WSPersonSearch.IPersonSearchWebService"  />

    <endpoint name="BasicHttpBinding_ITransferService" 
        address="TransferService.svc"
        binding="basicHttpBinding"  
        bindingConfiguration="BasicHttpBinding_ITransferService"
        contract="WSFileTransfer.ITransferService" />

    <endpoint name="BasicHttpBinding_IScannedFileSearchWebService"
        address="ScannedFileSearchWebService.svc"
        binding="basicHttpBinding" 
        bindingConfiguration="BasicHttpBinding_IScannedFileSearchWebService"
        contract="WSScannedFileSearch.IScannedFileSearchWebService" />
</service> 
```

**更新：**不幸的是，此功能仅适用于**服务器端**- 客户端配置没有等效功能。

在客户端，您需要完整地拼出所有 URL——即使它们共享例如服务器名称和端口。

# ios - 将 TICoreDataSync 添加到 ios/mac 项目

> ID：15770136
> 
> 赞同：4
> 
> 时间：2013-04-02T17:11:28.150
> 
> 标签：ios, macos, ticoredatasync

我正在尝试将 TICoreDataSync 添加到我的项目中，我的计划是在 2 个应用程序（mac 和 ios）之间同步核心数据。我尝试按照教程（[对于 ios](http://timisted.github.com/TICoreDataSync/ios-tutorial.html)，[对于 mac](http://timisted.github.com/TICoreDataSync/mac-tutorial.html)），但它似乎很旧，所描述的文件夹与 repo 中的最后一个版本不同。

有什么可以帮助我的吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T03:48:57.977

我们刚刚发布了框架的 1.0.2 版本，并更新了示例应用程序和教程，以及大量文档。在项目 wiki 上查看它们，如果您在项目的问题页面上打开问题遇到任何问题，请告诉我。[https://github.com/nohirst/TICoreDataSync/wiki](https://github.com/nothirst/TICoreDataSync/wiki)

# css - 找出给定页面上使用的 CSS 样式

> ID：15770138
> 
> 赞同：10
> 
> 时间：2013-04-02T17:11:34.947
> 
> 标签：css, http, styles

我有一个包含多个样式表的页面，并且其中的大部分样式实际上并未在页面中使用（已弃用等）。我想**导出一个新样式表**，其中包含页面上实际使用的所有样式。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-03T20:53:40.847

我也遇到了同样的问题，因为我需要分析的页面是仅登录的，而且是为了工作，所以我无法将我的登录名提供给外部应用程序（这就是未使用的 css.com 在登录后抓取页面的方式墙）。

我找到了两个 Chrome 扩展：

1.  [CSS 移除和合并](https://chrome.google.com/webstore/detail/css-remove-and-combine/cdfmaaeapjmacolkojefhfollmphonoh?hl=en-GB)
2.  [未使用的CSS](https://chrome.google.com/webstore/detail/unusedcss/dokggbghedajooenkgjbamikfgnngeik?hl=en-US)

我只使用了第一个，因为它做得很好。它计算页面上的 CSS 元素，告诉我有多少已使用和未使用，并让我下载所有已使用元素的样式表。它似乎不包括浏览网站和积累看到的元素的功能，它只是逐页的，但它仍然让我将 450 修剪到 150。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-27T01:36:03.857

我认为这个网站可以满足您的需求：[CSS Trashman](http://www.csstrashman.com/)。运行需要一点时间，但它可以工作。它将我个人网站的 CSS 从 3.31 KB 减少到 402 字节。

如果您更愿意使用命令行工具，[CSS Rationator](https://github.com/begriffs/css-ratiocinator)支持 CSS Trashman。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-01T16:52:54.757

在[**Chrome DevTools**](https://developer.chrome.com/devtools)中，有一个 Audits 选项卡，可让您运行网页性能审核并查看未使用的 CSS 规则列表：

[![在此处输入图像描述](https://i.stack.imgur.com/qWNPt.jpg)](https://i.stack.imgur.com/qWNPt.jpg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T17:14:19.847

我发现了这个：[http ://unused-css.com/](http://unused-css.com/)

> 特征
> 
> *   自动浏览您网站的页面，找到未使用的 CSS 选择器并创建新的干净的 CSS 文件，您可以下载
> *   验证并浏览需要验证的页面。然后它将检查未使用的 CSS 规则。
> *   在 javascript 文件中搜索 CSS 规则
> *   自定义要保留的 CSS 选择器列表
> *   预览对 CSS 文件所做的更改
> *   遵循 CSS 导入命令
> *   为爬虫设置用户代理

但我不确定这是否是一个好主意，例如：javascript 触发选择器、上下文显示、代码条件布局……因此，如果您尝试“批量”处理 .css 文件，请小心。

# ruby-on-rails - Ruby (1.8.7) on rails (2.0.1) - NoMethodError on call to model symbol

> ID：15770145
> 
> 赞同：0
> 
> 时间：2013-04-02T17:11:55.930
> 
> 标签：ruby-on-rails

当我尝试访问模型 NewsItem.published 中的符号时，我收到了 NoMethodError。

调用的控制器是显示：

```
class NewsItemsController < ApplicationController
  def index
    @news_items = NewsItem.published
  end

  def show
    @news_item = NewsItem.find(params[:id])
  end

end 
```

错误是：

```
undefined method `published' for #<Class:0x105ca3fe0>

vendor/rails/activerecord/lib/active_record/base.rb:1541:in `method_missing_without_paginate'
vendor/plugins/will_paginate/lib/will_paginate/finder.rb:93:in `method_missing'
app/controllers/news_items_controller.rb:3:in `index' 
```

型号代码为：

```
class NewsItem < ActiveRecord::Base
  belongs_to :news_category
  validates_presence_of :title, :summary, :body, :release_at

  scope :published, :conditions => ["news_items.release_at > ?", Time.now]
  scope :homepage_published, :conditions => ["news_items.release_at > ?", Time.now], :limit => 3
end 
```

我已经合并了另一个开发人员代码，所以我想知道是否可能缺少一些方法声明......

任何帮助或建议将不胜感激。谢谢。

编辑 - 在模型代码中添加了 lambda：

```
class NewsItem < ActiveRecord::Base
  belongs_to :news_category
  validates_presence_of :title, :summary, :body, :release_at

  scope :published, lambda { 
    where(["news_items.release_at > ?", Time.now])
  }  
  scope :homepage_published, lambda { 
    where(["news_items.release_at > ?", Time.now])
  }  
  #scope :published, :conditions => ["news_items.release_at > ?", Time.now]
  #scope :homepage_published, :conditions => ["news_items.release_at > ?", Time.now], :limit => 3
end 
```

值得一提的是，这个应用程序处于版本控制之下，在合并了添加新闻项目代码的开发人员的更改后，我运行了：

```
bundle exec rake db:migrate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:44:12.570

用这个：

```
scope :published, lambda { 
  where(["news_items.release_at > ?", Time.now])
} 
```

# jquery - Kendo UI Mobile - TabStrip 数据 - * 在加载带有查询字符串的远程视图后未定义

> ID：15770147
> 
> 赞同：1
> 
> 时间：2013-04-02T17:12:06.337
> 
> 标签：jquery, html, kendo-ui

我正在使用弹出窗口来选择一个项目，然后应用程序将使用特定的查询字符串加载远程视图。这很好用，但是，它似乎破坏了我在布局中使用的选项卡条中的一些功能。首先，选定的标签条图标将不再应用活动的 CSS 属性（例如图标不会改变颜色）。其次，在显示带有（查询字符串参数）的新远程视图后尝试使用选项卡条时收到以下错误：

```
Uncaught TypeError: Cannot call method 'switchTo' of undefined general.mobile.functions.js:150
resetTabStripgeneral.mobile.functions.js:150
closeModalViewAndResetTabStripgeneral.mobile.functions.js:59
i.extend.triggerkendo.mobile.min.js:9
o.extend._releasekendo.mobile.min.js:14
arguments.length.t.(anonymous function)kendo.mobile.min.js:10
b.event.dispatchjquery.min.js:3
v.handle 
```

这是在我的函数 resetTabStrip 中引发错误的代码行：

```
$("[data-role=\"tabstrip\"]").data("kendoMobileTabStrip").switchTo("#test1"); 
```

这是标签条在 DOM 内部的外观（在我的初始页面/视图中使用 JQuery 初始化）：

```
<footer data-role="footer" class="m-footer km-footer" style="padding: 0; background-color: rgb(26, 46, 120);">
    <div class="m-tabstrip km-tabstrip" data-role="tabstrip">
        <a href="#test1" data-icon="favorites" data-rel="popover">Test1</a>
        <a href="#test2" data-icon="home">Test2</a>
        <a href="#test3" data-icon="action" data-rel="modalview">Test3</a>
    </div>
</footer> 
```

最后，当我尝试输出`$("[data-role=\"tabstrip\"]").data("kendoMobileTabStrip")`到 Google Chrome 的控制台时，我得到了未定义。

我正在使用带有 JQuery 1.9.1 的 Kendo Q1 2013 版本。

**更新：**

`data-reload="true"`在当前视图上使用时会发生此问题

**更新 2：**

在谷歌浏览器的控制台窗口中，我正在观察标签条元素`data()`被添加到我的 SPA 中。当我到达我的问题视图（带有`data-reload="true"`）时，tabstrip 工作正常。一旦我离开该视图，`data()`添加到我的 SPA 中的第一个 tabstrip 元素就会未定义，随后很快就会出现其余元素。

我认为最近的 tabstrip 元素`data()`将变为未定义，因为它属于使用`data-reload="true"`. 我开始相信这可能是 Kendo 破坏此视图的标签条的方式中的一个错误，因为它应该破坏最新的标签条，而不是第一个。

# android - 从没有代码的应用程序中检索包名称

> ID：15770149
> 
> 赞同：0
> 
> 时间：2013-04-02T17:12:15.047
> 
> 标签：android, intentfilter

我希望 APP1 动态检索 APP2 的包名，即没有硬编码 APP2 包名。

最明显的方法是在 APP2 的一个组件中定义一个意图过滤器，例如接收器、活动、活动别名和服务。然后，APP1 将查询特定的意图过滤器，然后魔术就完成了。

然而 APP2 只是一个资源包，实际上它的 android 清单`hasCode="false"`在应用程序会话中声明。所以，APP2（我认为）不能放置带有意图过滤器的组件。

请记住 APP2 不得包含任何代码，有没有办法让 APP1 以编程方式检索 APP2 包名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:00:01.867

我发现，即使您在 AndroidManifest.xml 中声明了一个活动，您也可能不会在应用程序项目中创建相应的 java 类。该项目编译良好。

到目前为止，解决方案是在 AndroidManifest 中创建一个虚拟活动标签，声明一个意图过滤器并使用此过滤器查询此包名称。

意识到如果您尝试使用该意图过滤器启动虚拟活动，您可能会收到 ActivityNotFoundException。

我认为这不是一个优雅的解决方案，但它现在有效。我希望你在这里发布更好的解决方案。

# javascript - jquery javascript 验证

> ID：15770156
> 
> 赞同：0
> 
> 时间：2013-04-02T17:12:40.213
> 
> 标签：javascript, jquery, verification

我在验证时遇到了一些问题。在这里，正在检查一个输入，它是一个数字，不是 = 到无，它大于或 = 到 3 并且小于或 = 到 12。由于某种原因，我只能成功验证第一部分. 我无法让 ">3= && <=12" 工作，请帮助。

```
}else if(question_pos==2){
        if( $("#myinput").val() != "" && Number($("#myinput").val() ) && $("#myinput").val() >= "3" && $("#myinput").val() <= "12" ){
        return true;
    }else{
        return false;
    } 
```

这是问题的一部分

```
$("#baseline_05_ft").val() >= "3" && $("#baseline_05_ft").val() <= "12" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:17:34.207

您的代码很混乱，这可能是导致错误的原因。

像这样写：

```
var value = parseInt($("#myinput").val(), 10 /*radix*/);
if (isNaN(value) === false && value >= 3 && value <= 12) {
    // ..
} 
```

永远不要在你的意思是数字的地方比较字符串。比较你应该比较的东西。它使代码更易于阅读和理解。

* * *

这也允许您将严格比较 ( `!==`and `===`) 用作：

```
3 === 3; // true
3 === "3"; // false
3 == "3"; // true 
```

我从来没有发现你想使用`==`而不是`===`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:20:01.373

您应该将其转换为整数-

```
var myVal = parseInt($("#myinput").val(), 10);
if(!isNaN(myVal) && myVal >= 3 && myVal <= 12) {
    //do stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:18:32.510

您正在比较字符串，而不是数字。没有在词法上比较大于`"3…"`但小于的值`"1…"`。

```
if (question_pos==2) {
    var strVal = $("#myinput").val();
    var val = Number(strVal);
    return strVal != "" && !isNaN(val) && val >= 3 && val <= 12;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:18:37.620

首先使用 javascript，您应该`===`在进行逻辑比较时使用运算符。其次，您的问题部分是比较两个字符串，而不是数字。尝试先将它们转换为数字。

```
var myInput = parseInt($('#myinput').val(), 10); //always declare a base when doing parseint
if(myInput >= 3 && myInput <= 12){
    //its valid do stuff to it
} 
```

# android - 带有原生列表和 setemptyview 的对话框

> ID：15770158
> 
> 赞同：0
> 
> 时间：2013-04-02T17:12:44.793
> 
> 标签：android

我有一个片段对话框。在它的 onCreateDialog 方法中，我使用 AlertDialog.Builder 和 .setAdapter() 创建对话框。这种组合为我提供了简单的单选列表。但是如果数据库中没有记录，我会得到一个没有项目的空列表。如何获取对话框列表以在其上使用 setEmptyView() 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:22:40.113

> 如何获取对话框列表以在其上使用 setEmptyView() 方法？

您可以像这样获取 Dialog 的 ListView：

```
ListView listView = ((AlertDialog) dialogFragment.getDialog()).getListView(); 
```

从这里你可以打电话`setEmptyView()`（或任何你想要的。）

# junit - JAVA——单元测试

> ID：15770159
> 
> 赞同：-2
> 
> 时间：2013-04-02T17:12:46.707
> 
> 标签：junit

我正在使用 TestNG 在 java 中进行单元测试（由其他学生编写的代码）。问题是我无法在代码中模拟对象，因为每个函数都采用 ArrayList 的 ArrayList（arrayList 下的值是 ArrayList 的对象）。请向我推荐任何用于模拟的工具或任何好的方法，我尝试了 easyMock 和其他人，但遇到了同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:19:29.367

您正在测试的代码的设计似乎非常可疑，但这不应阻止您对其进行测试。仅仅因为您正在编写测试并不意味着您需要模拟*所有内容*。您可以预先创建需要传入的对象，然后将其提供给您正在测试的方法：

```
@Test
public void testStuff() {
    List outerList = new ArrayList();
    List innerList = new ArrayList();
    innerList.add("something");
    outerList.add(innerList);
    someObject.crazyMethod(outerList);
} 
```

需要有某种文档，你的同学解释如何调用他的代码，这样你就可以知道要传递什么。如果他坚持让他的对象被调用的方式是疯狂的，那不应该是你的错。

我有另一个问题的答案，该问题涉及何时模拟，何时不在[这里](https://stackoverflow.com/a/15160629/217324)。

# jquery - 使用 JQuery 从“If”、“Else If”或“Else”语句中传递变量？

> ID：15770160
> 
> 赞同：1
> 
> 时间：2013-04-02T17:12:50.887
> 
> 标签：jquery

我想知道是否可以将变量从“If”、“Else If”或“Else”语句中传递到另一个部分，而无需 PHP，只需使用 JQuery。

* * *

**jQuery代码：**

```
$('#Info-Side-Tabs a').click(function() {
    var clicked = $(this).attr('href');
    if (clicked == "#Map-Selection-Info-Close") {
        $('#Info-Side-Tabs li').removeClass('active');
        $(this).parent().addClass('active');
        $(this).attr("href","#Map-Selection-Info-Open");
        $(this).text('Open Me');
        $('#Map-Selection-Info').animate({marginLeft: '978px'}, 1000);
        $('#ATWI80C-Map').animate({width: '900px' }, 1000);
    } else if (clicked == "#Map-Selection-Info-Open") {
        $(this).parent().removeClass('active');
        $(this).attr("href","#Map-Selection-Info-Close");
        $(this).text('Close Me');
        $('#Map-Selection-Info').animate({marginLeft: '670px'}, 1000);
        $('#ATWI80C-Map').animate({width: '600px' }, 1000);
    } else {
        $('#Info-Side-Tabs li').removeClass('active');
        $(this).parent().addClass('active');
        var activeTab = $(this).attr('href');
        $('#tab-content > div:visible').hide();
        $(activeTab).show();
        return false;
    }
}); 
```

* * *

在上面，它将关闭或打开带有标签的我的辅助信息。如果单击不等于“#Map-Selection-Info-Close”，我需要设置名称的变量。我想这样做的原因是#Map-Selection-Info-Close/#Map-Selection-Info-Open 在选项卡切换器上，但是它们没有内容，所以它保留以前的内容但切换关闭时向活跃的班级上课。打开后，您可以看到以前的内容，但是我不知道如何将活动类设置回显示的当前内容。

我对 JQuery 很陌生，这是迄今为止我做过的最好的事情，我想我现在点击后可以轻松地拿起所有东西，但是如果可能的话，我不知道如何做上述和我感谢您在做我希望实现的目标时提供的任何帮助和/建议。

最好的祝福，

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T20:02:03.930

我一直在寻找答案，阅读文章并学习并使用新的关键词来定义新的搜索结果。我了解到我首先需要创建一个全局变量；

```
// To set fully global for all your functions, set it here
var lastclicked;
$('#Info-Side-Tabs a').click(function() {
    var clicked = $(this).attr('href');
    if (clicked == "#Map-Selection-Info-Close") {
        // functions
    } else if (clicked == "#Map-Selection-Info-Open") {
        // functions
    } else {
        // functions
    }
}); 
```

所以我将我的新变量“lastclicked”设置为没有值。下一步是能够使用此全局变量的键值。如果你想在任何地方设置这个全局变量，你可以省略'var'，例如；

```
$('#Info-Side-Tabs a').click(function() {
    var lastclicked;
    var clicked = $(this).attr('href');
    if (clicked == "#Map-Selection-Info-Close") {
        // functions 
    } else if (clicked == "#Map-Selection-Info-Open") {
        // functions
    } else {
        lastclicked = clicked;
    }
    alert(lastclicked);
}); 
```

我希望这对其他试图找到类似解决方案的人有所帮助。

最好的祝福，

蒂姆

# plugins - Cordova 2.5.0 - 将 appDelegate.m 引用到 PushPlugin 后出现错误

> ID：15770163
> 
> 赞同：1
> 
> 时间：2013-04-02T17:12:55.873
> 
> 标签：plugins, push-notification, cordova, xcode4.5, appdelegate

我在让 Xcode 中的 PushNotification-Plugin 工作时遇到了一些麻烦。这是我到目前为止所做的（直到最后一点没有错误）：

*   [我从https://github.com/phonegap-build/PushPlugin/](https://github.com/phonegap-build/PushPlugin/)下载了最新的插件
*   我将 PushNotification 文件夹拖放到 XCode 中的 Plugins 文件夹中，并选择“为任何添加的文件夹创建组”作为复制选项
*   将 Xcode 之外的 PushNotification.js 复制到我项目的 www 文件夹中
*   添加了一个脚本标签来引用我的 HTML 文件中的 PushNotification.js 文件
*   在 config.xml 中添加了插件 name="PushPlugin" 和 value="PushPlugin"

还没有错误（尽管我认为它可能有用，你知道，我已经做了什么）

好的，现在错误开始了：我将带有这些方法的代码块添加到我的 AppDelegate.m

```
#pragma PushNotification delegation

- (void)application:(UIApplication*)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData*)deviceToken
{
PushNotification* pushHandler = [self.viewController getCommandInstance:@"PushNotification"];
[pushHandler didRegisterForRemoteNotificationsWithDeviceToken:deviceToken];
}

- (void)application:(UIApplication*)app didFailToRegisterForRemoteNotificationsWithError:(NSError*)error
{
PushNotification* pushHandler = [self.viewController getCommandInstance:@"PushNotification"];
[pushHandler didFailToRegisterForRemoteNotificationsWithError:error];
}

- (void)application:(UIApplication*)application didReceiveRemoteNotification:(NSDictionary*)userInfo
{
PushNotification* pushHandler = [self.viewController getCommandInstance:@"PushNotification"];
NSMutableDictionary* mutableUserInfo = [userInfo mutableCopy];

// Get application state for iOS4.x+ devices, otherwise assume active
UIApplicationState appState = UIApplicationStateActive;

    if ([application respondsToSelector:@selector(applicationState)]) {
    appState = application.applicationState;
    }
    [mutableUserInfo setValue:@"0" forKey:@"applicationLaunchNotification"];

    if (appState == UIApplicationStateActive) {
    [mutableUserInfo setValue:@"1" forKey:@"applicationStateActive"];
    } else {
    [mutableUserInfo setValue:@"0" forKey:@"applicationStateActive"];
    [mutableUserInfo setValue:[NSNumber numberWithDouble: [[NSDate date] 
    timeIntervalSince1970]] forKey:@"timestamp"];
    [pushHandler.pendingNotifications addObject:mutableUserInfo];
    }
 } 
```

所以这是我收到的错误：

*   使用未声明的标识符“pushHandler”；你的意思是“onpushHandler”吗？
*   未知类型名称“PushNotification”；你的意思是“NSNotification”吗？</li>
*   在“NSNotification *”类型的对象上找不到属性“pendingNotifications”-

我将 'pushHandler' 更改为 'onpushHandler' - 但我不知道这是否正确，因为插件的开发人员没有以第一种方式将其命名为 onpushHandler。

对于其他两件事，我不知道将其更改为 NSNotification 是否是正确的处理方式

也许有人可以帮助我     

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T07:48:49.063

检查 xcode 中的 Pushnotification 文件夹，它是否有“Pushnotification.m”文件或“PushPlugin.m”文件。如果是 PushPlugin.m 文件，则不要复制 AppDelgate.m 文件中的代码。从 github 复制 AppDelegate

如果是 PushNotification.m 文件，那么只需在 AppDelegate.m 文件的顶部添加代码

# 导入“PushNotification.h”

[我建议您通过查看此链接](https://github.com/mgcrea/cordova-push-notification)从头开始。

# python - 在 mlpy 3.5.0 中找不到 dtw_std

> ID：15770164
> 
> 赞同：0
> 
> 时间：2013-04-02T17:13:01.260
> 
> 标签：python

我试图在 Ubuntu 10.04.4 LTS ( Python 2.6.5 ) 上使用 mlpy-3.5.0，但是在导入包之后，我将执行 DTW 指令，发生错误并显示以下日志：

> 回溯（最后一次调用）：文件“”，第 1 行，在 AttributeError 中：“模块”对象没有属性“dtw_std”

[当我在谷歌上搜索它并找到这个相关主题](https://groups.google.com/forum/?fromgroups=#!topic/mlpy-general/7902Ae6soCI)时，也会发生一件有趣的事情：如果我替换为`mlpy.Dtw()`，它会起作用！所以我想要一些帮助。

这里是源代码，也由包提供：

```
import mlpy
x = [0,0,0,0,1,1,2,2,3,2,1,1,0,0,0,0]
y = [0,0,1,1,2,2,3,3,3,3,2,2,1,1,0,0]
dist, cost, path = mlpy.dtw_std(x, y, dist_only=False) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T07:13:47.850

您没有正确的 mlpy 安装。

`sudo apt-get install libgsl0-dev` 从[http://sourceforge.net/projects/mlpy](http://sourceforge.net/projects/mlpy)获取`tar -xvfz mlpy-3.5.0.tar.gz`tar.gz和`cd mlpy-3.5.0``sudo python setup.py install`

# python - 如何在类定义中将python类属性设置为另一个先前定义的类属性的值？

> ID：15770166
> 
> 赞同：1
> 
> 时间：2013-04-02T17:13:03.653
> 
> 标签：python, oop, class

我正在定义一个 python 类，并希望声明一组类属性，然后使用这些属性初始化一个列表，该列表也将存储为类属性。

```
class SampleClass( models.Model ):

    #----------------------------------------------------------------------
    # Class attributes
    #----------------------------------------------------------------------

    # field names
    FIELD_NAME_ID = "ID"
    FIELD_NAME_USER = "User"

    # Field name list
    FIELD_NAME_LIST = []
    FIELD_NAME_LIST.append( SampleClass.FIELD_NAME_ID ) # = "ID"
    FIELD_NAME_LIST.append( SampleClass.FIELD_NAME_USER ) # = "User"

    # rest of class definition
    # ...

#-- END class SampleClass --# 
```

这在 Java 中类似于定义类变量，然后使用它们来初始化其他随后定义的类变量。

在这个例子中，我尝试使用类名来引用它们，例如：`SampleClass.FIELD_NAME_ID`

这不起作用（它破坏了类定义）。

添加这样的列表项：

```
FIELD_NAME_LIST.append( "ID" ) # = "ID" 
```

工作正常。

在 python 中初始化另一个类属性时，有没有办法使用一个类属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:15:01.783

类主体作为函数执行，本地命名空间条目成为类属性。因此，在类体执行期间，您可以将其他名称视为局部变量：

```
FIELD_NAME_ID = "ID"
FIELD_NAME_USER = "User"

FIELD_NAME_LIST = [FIELD_NAME_ID, FIELD_NAME_USER] 
```

自从您`FIELD_NAME_LIST.append("ID")`成功调用以来，您已经发现了这一点。

# sql-server - 在 Windows Server 2003 上执行 SQL Server 2012 包？

> ID：15770167
> 
> 赞同：0
> 
> 时间：2013-04-02T17:13:04.237
> 
> 标签：sql-server, ssis, sql-server-2012

我有 SQL Server 2012 SSIS 格式的包。我需要在安装了 SQL Server 2008 的 Windows Server 2003 服务器上运行它。我将文件复制到服务器并`Dtexec.exe`运行`dtexec.exe.config`

```
dtexec /f mypackage.dtsx 
```

但是，程序退出而没有任何错误消息。我应该怎么做才能让它在 SQL Server 2008 / Windows Server 2003 上运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-30T18:57:48.533

您将需要使用 BIDS 重新创建包。SQL Server Data Tools 在 SSIS 中引入了旧 BIDS 版本中不可用的新功能。

# ruby - if 语句中的局部变量

> ID：15770170
> 
> 赞同：5
> 
> 时间：2013-04-02T17:13:15.607
> 
> 标签：ruby, ruby-2.0

我想知道，为什么是`a`可见的？

```
if true
  puts 'true'
else
  puts 'false'
  a = 123
end

puts a # no error

# or 
# my_hash = {key: a}
# puts my_hash # :key => nil 
```

但这会导致错误，即使会显示“真实”

```
if true
  puts 'true'
else
  puts 'false'
  a = 123
end

puts a2 # boooooom 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:20:35.860

如果没有为对象定义方法，则`a`在内部引用具有将其声明为变量的效果。`if``a=`

由于 Ruby 不需要使用与引用变量或分配给变量相同的语法来调用方法，因此它需要对相关标记的性质进行评估。如果它*可能*是一个方法调用，因为已经定义了具有该名称的方法，那么它将被解释为这样。如果在编译源代码时不存在这样的方法，则默认情况下它将是一个变量。

# css - 使用第一行的自然宽度将带有 css 的块居中

> ID：15770173
> 
> 赞同：1
> 
> 时间：2013-04-02T17:13:35.890
> 
> 标签：css

我有我想这样显示的文本：

```
SOME HEADING TEXT
And then a bunch
of text under
that wrapped to
the width of the
heading. 
```

我的意思是，我想要一个标题，下面有一些正文。我希望此块内的文本左对齐。我希望块的宽度由标题的宽度定义。然后我希望整个块以它的父级为中心。

如果我知道标题是 100 像素，我可以这样写：

```
<div style="width: 100px;margin:0 auto">
etc. 
```

但我不知道标题的宽度。即使它是静态的并且我测量了它，我认为这在不同的浏览器上是不可靠的，如果用户改变他的字体大小等。

我试着说 width:0 并将  's 放入标题中。标题显示正常，但正文显示每行一个单词。

有什么有用的提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:40:59.253

您可以通过将文本绝对定位在包含的标题元素中来完成您想要做的事情。

HTML：

```
<h1>
    SOME HEADING TEXT

    <span>
        And then a bunch
        of text under
        that wrapped to
        the width of the
        heading.
    </span>

</h1> 
```

CSS：

```
h1 { display: inline-block; position: relative; }
h1 span { text-align: center; display: block; position: absolute; font: 14px/20px Helvetica, sans-serif; } 
```

小提琴：http: [//jsfiddle.net/ftkdD/1/](http://jsfiddle.net/ftkdD/1/)

**注意：我只在 Firefox 中测试过。此外，重要的是要注意，如果在元素下方设置了内容以清除高度，则元素高度可能会成为问题，您需要应用底部边距或填充，因为绝对定位的文本不会有任何影响元素的整体高度。正如你在这里看到的：http: [//jsfiddle.net/ftkdD/2/](http://jsfiddle.net/ftkdD/2/) **

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:16:12.093

这个小提琴看起来像你想要的吗？

[http://jsfiddle.net/2Rc2j/3/](http://jsfiddle.net/2Rc2j/3/)

CSS：

```
#main{
    width: 200px;
    height: 50px;
    margin: 0 auto;
    background: red;
}

#header{
    background: blue;
} 
```

HTML：

```
<div id="header">
    <div id="main">

    </div>
</div> 
```

# windows - 如何在 Eclipse for Windows 上使用 egit 切换到新的本地 git 存储库

> ID：15770181
> 
> 赞同：0
> 
> 时间：2013-04-02T17:14:10.190
> 
> 标签：windows, eclipse, git, egit

我是 Eclipse 和 git 的新手，最近在网络驱动器上建立了一个存储库，现在正在与其他人共享。因此，我想在我和网络存储库之间添加我自己的本地存储库。我应该如何创建本地存储库并切换到它，同时仍然能够推送到网络存储库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:36:09.427

我相信您可以通过使用克隆网络存储库来做到这一点

```
git clone <network repo path> 
```

在您想要本地存储库的位置执行此操作。C:\gitRepo 或其他任何你想要的命令提示符。您现在可以提交到本地存储库并随时推送到网络存储库或源。

你可以在这里找到基本的 git 命令[http://rogerdudler.github.com/git-guide/](http://rogerdudler.github.com/git-guide/)

编辑

刚刚看到你用eclipse和egit标记了这个，如果你想用eclipse做这个，你可以点击import和“import projects from git”并选择URI，然后你可以提供网络路径并选择你想要克隆它的位置,更多信息请参考[http://wiki.eclipse.org/EGit/User_Guide/Remote#Cloning_remote_Repositories](http://wiki.eclipse.org/EGit/User_Guide/Remote#Cloning_remote_Repositories)

# c# - MSChart：条形图中X轴上重复的标签

> ID：15770186
> 
> 赞同：0
> 
> 时间：2013-04-02T17:14:23.617
> 
> 标签：c#, mschart

我正在尝试按照代码创建条形图，其中条形必须按用户名分组，但不知何故重复问题标签如下所示，

![在此处输入图像描述](https://i.stack.imgur.com/w4SaM.png)

我的数据表类似于，

```
Question="Gravimetry"
Project-test1=0
Project-test2=1

Question="Sub-Surface"
Project-test1=0
Project-test2=2

Question="VSP"
Project-test1=2
Project-test2=3
..... 
```

C# 是，

```
 Series Series = new Series("Series1");
            Chart4.Series.Add("Series1");
            Chart4.Series.Add("Series2");

            Chart4.ChartAreas.Add("ChartArea1");

            // Set series chart type
            Chart4.Series["Series1"].ChartType = SeriesChartType.Bar;
            Chart4.Series["Series2"].ChartType = SeriesChartType.Bar;

            // Set series point width
            Chart4.Series["Series1"]["PointWidth"] = "0.6";
            Chart4.Series["Series2"]["PointWidth"] = "0.6";

            // Show data points labels
            Chart4.Series["Series1"].IsValueShownAsLabel = true;
            Chart4.Series["Series2"].IsValueShownAsLabel = true;

            // Set data points label style
            Chart4.Series["Series1"]["BarLabelStyle"] = "Center";
            Chart4.Series["Series2"]["BarLabelStyle"] = "Center";

            // Draw as 3D Cylinder
            Chart4.Series["Series1"]["DrawingStyle"] = "Cylinder";
            Chart4.Series["Series2"]["DrawingStyle"] = "Cylinder";

            Chart4.DataSource = dt.DefaultView;

            Chart4.ChartAreas["ChartArea1"].AxisX.Interval = 1;

            Chart4.Series["Series1"].XValueMember = "Question";

            //Chart4.Series["Series1"].YValuesPerPoint = 2;

            Chart4.Series["Series1"].YValueMembers = "Project-test1";
            Chart4.Series["Series2"].YValueMembers = "Project-test2";

            Chart4.DataBind(); 
```

任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:59:13.160

看一下[Chart.DataBindTable 方法](http://msdn.microsoft.com/en-us/library/dd467865.aspx)；它似乎绑定到表并提供按列分组。例如：

```
Chart4.DataBindTable(dt, "Question"); 
```

应该为表中的每个附加列创建一个系列，按问题列分组。

如果您需要更多自定义，还有[Chart.DataBindCrossTable 方法](http://msdn.microsoft.com/en-us/library/dd489089.aspx)，它允许您指定用于创建系列值的列。

# objective-c - Objective-C 注册类运行时参考

> ID：15770190
> 
> 赞同：2
> 
> 时间：2013-04-02T17:14:34.553
> 
> 标签：objective-c, class, objective-c-runtime

所以我有一堂课`MyClass`。它的名字是`char * myclasses[]`. 我想使用 objc 运行时 api 分配它。
1）这是最好的方法吗？我的目标是在真正需要使用它们之前不分配 10 或 15 个 ViewController，并且也没有巨大的 switch 语句来创建它们。

```
Class aClass = NSClassFromString ( [NSString stringWithUTF8String:myclasses[1]] );
id myClass = class_createInstance(aClass, 0); 
```

我也试图了解注册课程..

2）由于我不是在运行时创建一个新类（只是分配），我不应该注册它，对吗？
3) 课程注册如何正常进行？（请随时将我指向某处的文件）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T17:42:10.283

1) class_createInstance 与 +alloc 没有明显区别。我建议只打电话

```
[aClass alloc] 
```

（然后`-init*`像往常一样，当然）。无需使用 ObjC 运行时函数进行正常分配。

2) 对，不用注册

3）动态类创建是一项棘手的工作，但基本上你用 分配一个类（不是该类的实例） ，然后用and`objc_allocateClassPair`向它添加 ivars 和方法，然后用它调用。之后就可以正常使用了。`class_addMethod``class_addIvar``objc_registerClassPair`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:49:04.020

如果您将类名作为 C 字符串，则可以执行以下操作：

```
const char * classNames[] = {
    "NSObject"
} ;

[ [ objc_getClass( classNames[0] ) alloc ] init ] ; 
```

但是你可以只保留一个 NSStrings 列表：

```
NSString * classNames[] = {
    @"NSObject"
} ;

[ [ NSClassFromString(classNames[0]) alloc ] init ] ; 
```

# mysql - 如何在mysql中选择日期作为整数

> ID：15770195
> 
> 赞同：-4
> 
> 时间：2013-04-02T17:14:49.817
> 
> 标签：mysql

是否可以在 mysql 中选择日期类型作为整数？将其输出到 .csv 文件中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:17:12.073

使用[UNIX_TIMESTAMP()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_unix-timestamp)将日期转换为整数。

```
mysql> SELECT UNIX_TIMESTAMP();
        -> 1196440210
mysql> SELECT UNIX_TIMESTAMP('2007-11-30 10:30:19');
        -> 1196440219 
```

* * *

要导出到 CSV，请使用[SELECT...INTO](http://dev.mysql.com/doc/refman/5.0/en/select-into.html)：

```
SELECT a,b,a+b INTO OUTFILE '/tmp/result.txt'
  FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
  LINES TERMINATED BY '\n'
  FROM test_table; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:17:18.190

是的，有可能。请参阅 Unix_Timestamp 函数：[https ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_unix-timestamp](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_unix-timestamp)

要导出到 CSV 文件，请参阅：[http ://dev.mysql.com/doc/refman/5.0/en/select-into.html](http://dev.mysql.com/doc/refman/5.0/en/select-into.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:16:28.593

您可以使用：

```
select UNIX_TIMESTAMP(date)
from MyTable 
```

[UNIX_TIMESTAMP](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_unix-timestamp)

> 如果不带参数调用，则返回 Unix 时间戳（自 '1970-01-01 00:00:00' UTC 以来的秒数）作为无符号整数。如果使用日期参数调用 UNIX_TIMESTAMP()，它会返回参数的值作为自 '1970-01-01 00:00:00' UTC 以来的秒数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:48:26.997

三种可能的解决方案：

1.  Unix 时间戳
2.  代表日期的数字
3.  自“纪元”以来经过的天数

## Unix 时间戳

正如 RedFilter 发布的那样，`unix_timestamp(date)`返回 Unix 时间戳的值，这是一个无符号整数，表示自 1970 年 1 月 1 日 00:00:00 UTC 以来经过的秒数。

## 代表日期的数字

在某些情况下，您可能需要将日期表示为数字；例如：`20130331`对于 2013 年 3 月 31 日。这只是一个格式问题：

```
select cast(date_format(date, `%Y%m%d') as int) 
```

检查参考手册以了解`cast()`和`date_format()`功能的适当用法。

## 自“纪元”以来经过的天数

如果您需要计算自某一天（例如 2011 年 5 月 15 日）以来经过的天数，您将需要以下`datediff()`功能：

```
SELECT DATEDIFF('2013-03-31','2011-05-15') 
```

检查参考手册以了解`datediff()`功能的适当用法。

希望这对您有所帮助。

# asp.net - 在 Web API 格式化程序中设置过期/缓存标头

> ID：15770202
> 
> 赞同：4
> 
> 时间：2013-04-02T17:15:35.707
> 
> 标签：asp.net, asp.net-web-api

是否可以在 Web API 的 MediaTypeFormatter 内设置过期/缓存标头？我尝试覆盖 SetDefaultContentHeaders 并设置 expires 标头，如下所示：

```
public override void SetDefaultContentHeaders(Type type, System.Net.Http.Headers.HttpContentHeaders headers, System.Net.Http.Headers.MediaTypeHeaderValue mediaType)
    {            
       headers.Expires = DateTime.Now.AddHours(24);            
    } 
```

但是，当在 Chrome 工具等 Web 调试器中查看时，过期标头总是返回 -1。似乎也无法在此处设置 CacheControl 标头，因为这是响应标头而不是内容标头（无论这意味着什么）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-15T11:16:10.257

似乎任何设置`HttpResponseMessage.Headers.CacheControl`都会导致 Expires 标头按设置发出，但没有它设置 Expires 发出的值为 -1。尝试设置`response.Headers.CacheControl = new CacheControlHeaderValue()`但*不设置 max-age*。您应该能够在任何暴露的地​​方执行此操作`HttpResponseMessage`；例如在`ApiController`或 中`DelegatingHandler`。

根据[RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.3)，如果 CacheControl 的 max-age 存在，它会覆盖 Expires，但如果您只是按上述方式设置它，它应该可以工作。

这是否是一个好主意值得商榷，因为 Expires 是 HTTP 1.0，而 CacheControl 是 HTTP 1.1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-24T16:07:14.763

您应该在定义过期时间的输出 HttpResponse 对象中设置相应的缓存控制标头。不幸的是，WebAPI 没有开箱即用的内置支持，但幸运的是实现起来并不难。举个例子看看这里：[http ://blog.turlov.com/2013/11/setting-cache-control-http-headers-in.html](http://blog.turlov.com/2013/11/setting-cache-control-http-headers-in.html)

# android - FFmpegFrameGrabber 尝试在 Android 上压缩视频时 100% 崩溃

> ID：15770205
> 
> 赞同：1
> 
> 时间：2013-04-02T17:15:45.973
> 
> 标签：android, video, encoding, ffmpeg, javacv

我正在尝试在上传之前使用 javacv/ffmpeg 在 Android 设备上压缩视频。我正在使用这段代码：

```
FrameGrabber grabber = new FFmpegFrameGrabber(inputFile.getAbsolutePath()); 
grabber.start();
FFmpegFrameRecorder recorder = new FFmpegFrameRecorder(outputFile.getAbsolutePath(), 
   grabber.getImageWidth(), grabber.getImageHeight(), 
   grabber.getAudioChannels()); 

recorder.setVideoCodec(com.googlecode.javacv.cpp.avcodec.AV_CODEC_ID_MPEG4);
recorder.setAudioCodec(com.googlecode.javacv.cpp.avcodec.AV_CODEC_ID_PCM_S16LE);
recorder.setPixelFormat(com.googlecode.javacv.cpp.avutil.AV_PIX_FMT_YUV420P);

/* Unclear if I need these lines or not */
// recorder.setFrameRate(grabber.getFrameRate()); 
// recorder.setSampleRate(grabber.getSampleRate()); 
// recorder.setFormat("mp4");
/* End unclear lines */

recorder.start();

Frame frame; 
int totalFrames = grabber.getLengthInFrames();
for (int i = 0; i < totalFrames; i++) {
  frame = grabber.grabFrame();
  if (frame == null) break;
  recorder.record(frame);
}

recorder.stop();
grabber.stop(); 
```

此代码在 FFmpegFrameGrabber 第 584 行发生 100% 的崩溃，即：

```
frame.samples = samples_buf.position(0).limit(data_size / av_get_bytes_per_sample(samples_frame.format())); 
```

这是因为 samples_buf 为空，因为 samples_frame.format() 似乎不匹配任何情况（AV_SAMPLE_FMT_U8、AV_SAMPLE_FMT_S16、AV_SAMPLE_FMT_S32、AV_SAMPLE_FMT_FLT、AV_SAMPLE_FMT_DBL）。

我试图通过使用grab() 方法而不是grabFrame() 方法来避免这种崩溃，因为grab() 方法会跳过音频处理。但是，例如，当我将其从设备中提取并尝试在 Web 浏览器中播放时，我最终得到的视频不会播放。

我已经尝试过多次迭代这段代码，包括[这段代码](https://code.google.com/p/javacv/issues/detail?id=160#c93)，都无济于事，因为上面的行而全部崩溃。

谁能建议在 Android 上使用 javacv/ffmpeg 压缩视频的最短工作路径？

谢谢！

# concatenation - 如何连接两个字符串并将结果用作coldfusion中的变量名？

> ID：15770208
> 
> 赞同：7
> 
> 时间：2013-04-02T17:15:49.933
> 
> 标签：concatenation, cfml, evaluate

我有一个表单，它有很多字段，格式为

*   名称=“字段-1”
*   名称="字段-2"
*   名称="字段-3"
*   名称=“字段-4”
*   ETC....

在表单操作页面上，我希望能够使用循环并能够使用循环的索引与这样的字符串前缀连接`<cfset newField = "field-" & #index#>`，然后使用`#Variables.newField#`访问上一页的表单字段。

我一直在玩这个`Evaluate()`功能，但没有运气。我不怎么使用 ColdFusion，所以我可能只是在语法上有点偏离。

我如何使用它的一个例子是：

```
<cfset newField = "form.field-" & #index#>
<input type="hidden" 
      name="field-<cfoutput>#index#</cfoutput>" 
      value="<cfoutput>Evaluate(Variables.newField)</cfoutput>"> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-02T17:22:50.700

对于这种情况，您根本不必使用评估。只需通过键名访问变量结构。

```
<cfset newField = "form.field-" & index>
<cfset value = variables[newField]> 
```

要不就

```
<cfset value = variables["form.field-#index#"]> 
```

或者如果您不想使用中间变量

```
<cfoutput>#variables["form.field-" & index]#</cfoutput> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-02T17:26:10.607

无需将其设置为`variables`范围。在您的循环中，您可以使用关联数组表示法直接从`form`范围内访问表单字段值，如下所示：

```
<input type="hidden" name="field-<cfoutput>#index#</cfoutput>" 
value="<cfoutput>#form['field-' & index]#</cfoutput>"> 
```

为了更加安全，明智的做法是在尝试显示每个表单字段之前检查它是否存在：

```
<cfif structKeyExists(form, 'field-' & index)>
    <!--- display field --->
</cfif> 
```

# ios - iOS AppStore 上的 CCATS 和加密

> ID：15770215
> 
> 赞同：17
> 
> 时间：2013-04-02T17:16:10.493
> 
> 标签：ios, encryption, appstore-approval

这将是一个很长的问题......实际上是一组相关的问题......我想制作一个 iOS 应用程序，它将在 Apples App Store 上出售，（显然）。我的应用程序将在文档目录中存储一些敏感的用户数据。出于安全原因，我想到了一种可以保护这些数据的密码系统。有趣的事情从这里开始……这种数据安全机制几乎是牢不可破的。我将使用 AES-128/256、TwoFish 128/256 和 Serpent 128/256。用户可以选择在哪里使用什么...我可能正在使用双重加密，数据先用 AES 加密，然后用 Serpent 加密，或者两者的任意组合。

我显然需要检查应用商店上的“使用加密”按钮。问题是：

**1) 我需要 CCAT 或 ERN 什么认证？**

从 ：

[http://tigelane.blogspot.ro/2011/01/apple-itunes-export-restrictions-on.html](http://tigelane.blogspot.ro/2011/01/apple-itunes-export-restrictions-on.html)

> 1.  转到此链接并使用他的说明。这是一篇很棒的帖子：http: [//zetetic.net/blog/2009/08/03/mass-market-encryption-commodity-classification-for-iphone-applications-in-8-easy-steps/](http://zetetic.net/blog/2009/08/03/mass-market-encryption-commodity-classification-for-iphone-applications-in-8-easy-steps/)
> 2.  对所有情况执行第 1 步和第 2 步。如果您构建了自己的加密机制，请遵循整篇文章。如果您使用 SSL 或其他公共域加密，那么您可以在拥有 SNAP-R 帐户后停止。

我显然需要完成整个认证过程......我确实建立了自己的机制。

**2) 完整的 CCATS 可以 100% 在线完成吗？**

在那篇“8 个简单步骤”的帖子中，它说我需要通过（蜗牛）邮件发送一些文件。后来有用户说没必要了。注意：这些博客文章似乎很旧（2 年）。

> 很棒的描述！仅供参考：获取 SNAP-R 的 CIN/PIN 的过程现在完全是电子化的

另一位用户说：

> 您可能需要考虑更新您的帖子。BIS 顾问刚刚告诉我，不再需要邮寄申请表和证明文件的硬拷贝。这对某些人来说可能是微不足道的，但在国际运费上浪费 80 美元就是白白浪费了 80 美元。

我希望我不需要通过邮件发送所有文件，因为从欧盟将它们送到美国需要一段时间。

欧盟是否有人最近使用过 ERN/CCATS 流程？

**3）我还看到他们要你提供传真号码……我没有传真。这是个大问题吗？**

如果真的有必要，在线传真服务可以吗？

**4）我需要详细解释整个加密机制吗？还是只是算法？我可以因为“对大众市场加密系统太好了”而被拒绝吗？**

大多数情况下，我是否需要解释或声明某些数据将被加密两次？或者“将数据加密存储在磁盘上”是否足够好的解释？

**5）我将使用一些密码扩展算法和散列（HMAC，使用 SHA-2，也许是 SHA-3）...我也需要报告 thous 吗？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-24T22:54:52.243

StormCloud 的回答很棒。我打电话给 BIS，并与代表谈了一个小时，涵盖了许多理论细节。我还了解到（代表说代表不应该告诉我这个）他们对那些只是打电话而不是先弄清楚流程的人感到恼火。因此，我想分享我在 2013 年 9 月 24 日致电 BIS 后的发现。

**文件参考：**

[本页列出了](https://www.bis.doc.gov/index.php/policy-guidance/encryption)所有相关文件。文档链接列在此网页的左侧和中心，位于名为“加密链接”的组中。

**如何处理它们：**

在文档“第 774 部分第 5 部分第 ii 部分的补充 1”中，请参阅“注释 4”以确定您的应用程序的所有**主要**功能是否都免于第 5 类第 2 节。语言令人困惑。那里至少有一个双重否定。如果有疑问，只需将其归类为大众市场商品。

该代表敦促我不仅要考虑主要功能是否按预期用途豁免，还要考虑如果用户以任何其他方式使用该应用程序，它们是否会被豁免。同样，如果有疑问，请归类为大众市场商品。

如果您选择归类为大众市场商品，则需要参考三个文件。请参阅 740.17 以确定您的软件是否应归类为 B1、B2 或 B3。B2x 类型肯定需要归类为大众市场商品。我没有说明 B1 或 B2 类型是否需要归类为大众市场商品。
增补 5 涉及 Bx 类型的分类。您将复制此文档并填写相关信息，然后与您的 SNAP-R 工作项一起提交。**此外，请参阅您必须**在一月份提交
的报告的补充 8 。

 ****我们对我们的应用程序的结论：**

我们的特定应用程序（尚未）归类为第 5 类第 2 部分。这意味着我可以选择将我们的应用程序“自我分类”为 EAR99，而不是 ECCN 5D992（大众市场）或 5D002（非大众市场）。这也意味着我不需要在 SNAP-R 工作项中创建导出项。:)

**这是我从 BIS 代表处收到的完整电子邮件，旨在引导我将软件归类为大众市场商品：**

导出前必须获得加密注册号 (ERN)。ERN 是您获得一次并永久使用的东西，或者直到您提供的信息发生更改。获得 ERN 只需几分钟的工作。您将在提交请求后大约一小时内收到 ERN。之后，始终将其包含在任何分类请求的附加信息块中，并将其用于第 742 部分报告的补充 8 的主题行中。

如果您无法立即提交 ERN 请求，并且了解在您提交之前您无权出口，请回复说明相同的内容，我将在其表面上使用 ERN 所需语言发布分类。我希望您继续请求加密注册号 (ERN) 并使用您的 ERN 回复此请求。我会将您的 ERN 放在附加信息块中，并在不参考 ERN 的情况下签发 CCATS。

今后，请始终按照第 740.17(b)(2) 或 (b)(3) 节和第 742.15(b)(3) 节所述物品分类规定的要求，将您的 ERN 包含在附加信息块中。耳朵。即使是 740.17(b)(1) 或 742.15(b)(1) 授权的物品，也需要在出口前进行加密注册。因此，即使对于“B1”请求，在发出分类请求之前获取并提供附加信息块中的 ERN 通常是有意义的。

如何获得 ERN：

在 BIS 主网站 www.bis.doc.gov 上，单击 Policy Guidance 下拉菜单下的“Encryption”一词。这将打开主要的加密网页。页面左侧第一列有两个蓝色框；但是，您可能需要向下滚动才能找到第二个蓝色框。第二个蓝色框表示“加密链接”，是一套重要的加密规则，包括 Supp。5 到第 742 部分。选择法规“第 742 部分的第 5 号补充”。将补充 5 问题复制到文字处理文档中。回答问题并将您的回答 PDF 格式。打开 SNAP-R 并选择“创建工作项” 从工作项类型列表中选择“加密注册”。附上您刚刚创建并提交的 .pdf。一个小时内，计算机应该会回复您的 ERN “

TMI ...我知道。有人读到这么远吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-11T00:26:56.700

我认为您应该请一位投保的出口委员提供法律建议，因为您在某些问题中真正要求的是合理的法律建议。

[bis.doc.gov](https://www.bis.doc.gov/forms/formslist.html)上列出了许多出口委员。

bis.doc.gov 上还有一个广泛的常见问题解答，其中涵盖了您的一些问题（下面的链接）。

*   [http://www.bis.doc.gov/licensing/do_i_needaneccn.html](http://www.bis.doc.gov/licensing/do_i_needaneccn.html)
*   [http://www.bis.doc.gov/licensing/index.htm#faqs](http://www.bis.doc.gov/licensing/index.htm#faqs)
*   [http://www.bis.doc.gov/encryption/enc_faqs.htm](http://www.bis.doc.gov/encryption/enc_faqs.htm)

希望这会为您指明正确的方向。**

# c# - 在 Windows Phone 8 sdk 中显示“正在加载”

> ID：15770222
> 
> 赞同：4
> 
> 时间：2013-04-02T17:16:32.530
> 
> 标签：c#, windows-phone-8

刚刚进入 Windows phone 8 sdk。今天想找几本书，没有成功。

我想在我的 SOAP 请求尝试下载数据时创建一个简单的显示加载信息（就像加载应用程序时一样）。

我无法在网上找到一些东西......我正在用 c# 而不是 JavaScript 编程。

有人有一些好的教程、参考资料的链接吗？

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T12:49:03.857

查看[进度条](http://msdn.microsoft.com/en-us/library/windowsphone/design/hh202917%28v=vs.105%29.aspx)：

> ProgressBar 控件显示具有已知持续时间的操作的进度，或显示正在进行的不确定操作。

这是一个使用它的[例子](http://www.jeffblankenburg.com/2011/11/15/31-days-of-mango-day-15-the-progress-bar/)。

# scala - 为什么 Heroku 报告错误代码 H12 Request timeout for 30-sec-long requests？

> ID：15770223
> 
> 赞同：1
> 
> 时间：2013-04-02T17:16:39.963
> 
> 标签：scala, heroku, playframework-2.1

我们正在 Heroku 上使用 Play 应用程序。我们在服务器端处理消耗计算，这需要超过 30 秒的请求。在语言环境机器上一切正常。但是在 heroku 上，我们总是得到一个错误代码 H12（[请求超时](https://devcenter.heroku.com/articles/error-codes#h12-request-timeout)）。

在 play 和 scala （使用 2.1 版本）的情况下是否有针对此问题的任何技巧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:20:50.800

Heroku 不支持长期存在的请求。解决这个问题的最好方法是给你的客户一个回调 url 并让他们拉取响应。有一个库可以帮助你做一些事情并为你很好地包装它。它被称为彗星。

这是它的使用示例

```
public static Result index() {
  // Prepare a chunked text stream
  Chunks<String> chunks = new StringChunks() {

    // Called when the stream is ready
    public void onReady(Chunks.Out<String> out) {
      //Start your long running process here
      out.write("<script>console.log('kiki')</script>");
      out.write("<script>console.log('foo')</script>");
      out.write("<script>console.log('bar')</script>");
      out.close();
    }

  }

  response().setContentType("text/html");

  ok(chunks);
} 
```

可以在此处找到有关使用 play 进行 asyn http 编程的更多信息： [http ://www.playframework.com/documentation/2.0/JavaComet](http://www.playframework.com/documentation/2.0/JavaComet)

# android-ndk - ndk-gdb 中的 vi 绑定

> ID：15770233
> 
> 赞同：1
> 
> 时间：2013-04-02T17:17:13.673
> 
> 标签：android-ndk, gdb, vi, ndk-gdb

我知道`C+M+j`在 gdb 中进入 vi 模式。Cygwin-gdb 似乎服从我的 shell 设置 ( `set -o vi`) 并自动处于 vi 模式。但是，我似乎无法让 ndk-gdb 进入 vi 模式。有谁知道怎么做？

# javascript - Selenium IDE 卡在弹出窗口 javascript

> ID：15770236
> 
> 赞同：1
> 
> 时间：2013-04-02T17:17:22.380
> 
> 标签：javascript, html, css, ajax, selenium

我是使用火狐的 selenium ide 的新手。我正在尝试测试一个弹出 html 的日历，我读了很多东西，大部分都说我需要编写“javascrtip select element ...”命令，但无论我尝试了多少次，我都无法让它工作。这是网站[http://demo.owncloud.org/index.php/apps/calendar](http://demo.owncloud.org/index.php/apps/calendar)。当您单击日历日期时，会出现一个弹出窗口，让我选择日期和时间等。我不知道你如何让弹出窗口在硒中工作。我什至不知道你会如何理解它是 ajax 还是 javascript 这里是关于选择日历的部分代码

```
<div id="notification" style="display:none;"></div>
<div id="controls">
    <form id="view">
        <input type="button" value="Week" id="oneweekview_radio" original-title="">
        <input type="button" value="Month" id="onemonthview_radio" original-title="" class="active">
        <input type="button" value="List" id="listview_radio" original-title="">&nbsp;&nbsp;
        <img id="loading" src="/core/img/loading.gif" style="display: none;">
    </form>
    <form id="choosecalendar">
        <!--<input type="button" id="today_input" value="Today"/>-->
        <button class="settings generalsettings" title="Settings"><img class="svg" src="/core/img/actions/settings.svg" alt="Settings"></button>
    </form>
    <form id="datecontrol">
        <input type="button" value="&nbsp;&lt;&nbsp;" id="datecontrol_left" original-title="">
        <input type="button" value="April 2013" id="datecontrol_date" original-title="" class="hasDatepicker">
        <input type="button" value="&nbsp;&gt;&nbsp;" id="datecontrol_right" original-title="">
    </form>
</div>
<div id="fullcalendar" class="fc"><div class="fc-content" style="position: relative; min-height: 1px;"><div class="fc-view fc-view-month fc-grid" style="position: relative;" unselectable="on"><table class="fc-border-separate" style="width:100%" cellspacing="0"><thead><tr class="fc-first fc-last"><th class="fc-mon fc-widget-header fc-first" style="width: 182px;">Mon.</th><th class="fc-tue fc-widget-header" style="width: 182px;"> 
```

我真的很感激任何提示或帮助。

这是我所拥有的

```
 <tr>
    <td>open</td>
    <td>/index.php/apps/files</td>
    <td></td>
</tr>
<tr>
    <td>clickAndWait</td>
    <td>//ul[@id='apps']/li[3]/a/img</td>
    <td></td>
</tr>

---------Popup shows here ----------
<tr>
    <td>click</td>
    <td>id=category</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>id=ui-id-6</td>
    <td></td>
</tr>
<tr>
    <td>select</td>
    <td>name=calendar</td>
    <td>label=test</td>
</tr>
<tr>
    <td>select</td>
    <td>name=accessclass</td>
    <td>label=Bizalmas</td>
</tr>
<tr>
    <td>click</td>
    <td>id=from</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>link=12</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>id=to</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>link=27</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>id=submitNewEvent</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>//body[@id='body-user']/div[9]/div/button</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>id=oneweekview_radio</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>id=oneweekview_radio</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>id=onemonthview_radio</td>
    <td></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:29:52.653

这是一个您可以使用 Selenium IDE 与之交互的日历。尽管您还应该考虑使用 Selenium Grid 的 Selenium Webdriver，这将允许您在多个浏览器中测试您的代码。话虽如此，让您与此日历弹出窗口进行交互！

我建议使用元素的 id（如果可用），当没有 id 或 id 是动态的时使用 xpath。

对于没有 id 的元素，例如 Title 旁边的 input 元素，如下图所示，使用以下命令单击它的文本框。

命令`click`

目标`//input[contains(@placeholder, 'Title of the Event')]`

![在此处输入图像描述](https://i.stack.imgur.com/pqa3r.png)

上图的 Selenium IDE 的图像

![在此处输入图像描述](https://i.stack.imgur.com/6Df86.png)

提示：使用`Find`按钮查看您是否使用 xpath 正确指定了元素。它将突出显示。

对于大多数其他元素，您可以使用他们的 id

命令`'click'` 目标`id=fromtime`

我可以添加的最大提示是使用 FIREBUG！如果您使用的是 Selenium IDE，那么 Firebug 将为您提供极大的帮助。您可能已经在使用它，但这只是对遇到此问题的任何人的提示。

# c - 高效的 RC6 和 Mars 加密算法实现

> ID：15770240
> 
> 赞同：0
> 
> 时间：2013-04-02T17:17:46.880
> 
> 标签：c, linux, encryption, linux-kernel, cryptoapi

我正在运行 linux 内核 2.6.32，它在其加密 API 中不提供 rc6 和 mars 加密算法，我需要将这些算法作为内核模块嵌入并将它们注册到 linux 的加密 API 中。

一种方法是编写我自己的这些算法的实现，但我不想重新发明轮子，所以我需要知道这些算法在 C 中是否有任何广泛使用的实现？我知道这个问题没有一个明确的答案，但如果你们中的任何一位大师都可以告诉我一些最好的开源实现。这对我很有帮助。

提前致谢。

# error-handling - Crystal Reports 中的 TryParse 或 Try/Catch 等效项？

> ID：15770242
> 
> 赞同：0
> 
> 时间：2013-04-02T17:17:51.077
> 
> 标签：error-handling, crystal-reports, type-conversion

我在 Crystal Reports 中创建了一个报表，它接受一个文本列并根据分隔符对其进行拆分，然后将数组的第一部分转换为数字，第二部分转换为日期。我们有一些未转换的不良数据导致报告崩溃，我想创建另一个报告来帮助查找不良数据。此报告将显示其他报告中无法解析的所有记录。

我主要是一名 .Net 开发人员，我们拥有出色的能力来执行返回布尔值的 DateTime.TryParse(string) 之类的事情。我需要能够在 Crystal Reports 公式字段中执行类似的操作，但在我的一生中，我找不到等效项或任何类型的 try/catch 错误处理。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:22:38.297

**处理 Crystal Report 引擎的异常**

当您通过应用程序运行 Crystal Reports 时，Crystal Report Engine 有时可能会导致异常。发生异常时，可能会导致出现错误对话框或导致报告停止处理。异常的一些原因是：

*   报表引擎无法连接到数据库。这可能是因为已将数据库位置或不正确的登录参数传递给报表引擎。也可能是由于其他数据库错误，例如表被另一个用户锁定、数据库引擎安装不正确或表损坏。

*   已将不正确的数据传递给参数。如果参数从代码或用户输入中接收到不正确的数据，可能会导致
    报告停止运行。例如，传递给
    数字参数的字符串值将停止运行报告。

*   在 Crystal Reports 公式中发现错误。如果无法正确评估报告中的某个公式，
    则会引发异常。这可能是由于公式中的语法不正确或其他程序错误，例如除以零错误。

*   报表引擎无法打开报表。如果提供了不正确的文件名或路径、
    选择了非 Crystal 报告或报告已损坏，则可能会发生这种情况。

您可以选择让 Crystal Report Engine 自己处理异常，并显示它自己的错误消息，或者您可以决定自己处理异常。以编程方式处理异常的一些优点是：

*   您可以自定义向用户显示的错误消息。例如，当报表无法连接到数据源时，您可以显示更完整的消息，而不是显示“登录失败”，例如“无法连接到数据库，提供的登录参数不正确”。这将为用户提供更详细的信息。

*   您可以将事件写入应用程序的日志文件。您可以选择将错误消息、错误 ID、发生时间和其他相关信息写入日志文件。这将允许稍后跟踪和审查错误。

*   您可以使用自己的代码处理异常，以允许报表继续处理。通过检查错误是什么，您可以编写代码来处理错误并使用正确的信息重新运行报告。

[http://msdn.microsoft.com/en-us/library/aa288423%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa288423%28v=vs.71%29.aspx)

# c# - 在 C# 中的对象之间传输事件处理程序

> ID：15770245
> 
> 赞同：3
> 
> 时间：2013-04-02T17:17:58.460
> 
> 标签：c#, mvvm, event-handling

我搜索了一下，很惊讶我没有找到更简单的答案。我遵循一个简单的 MVVM 模型，并有一个视图模型（“parentVM”），它包含另一个视图模型（“childVM”）作为由公共属性（get/set）公开的字段。我遇到的问题是我试图在父的初始化程序中订阅子视图模型的 propertychanged 事件。但是当设置一个新的 childVM 时，事件处理程序就会丢失。

```
public parentVM : INotitifyPropertyChange{
    private _childVM = new childVM();

    public parentVM(){
        _childVM.PropertyChanged += someHandler;
    }

    public childVM {
         get{
             return _childVM;
         }
         set{
             _childVM = value;
             //EVENTHANDLERS ARE NOW GONE
         }
    }
    ....
} 
```

有没有办法将现有的事件处理程序转移到新对象？

这是一个简化的例子。我知道我可以简单地移动这条线：

```
_childVM.PropertyChange += someHandler; 
```

但这不适用于订阅该事件的外部对象。在这些情况下，您不太可能知道对象是什么以及处理程序是什么。

也许有一种解决方法，方法是在内部引用一个 List，从 += eventHandler 更改为更手动的 AddHander 方法，然后填充 List 以供将来参考。不知道在这一点上只是在考虑外卖。

PS如果示例中有语法错误，请原谅，我没有智能感知，这不是真正的代码......只是试图传达这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:46:50.267

我会考虑根本不创建一个新实例`childVM`，而只是更新它的内部模型。

但是，假设您不希望这样做，下面的代码应该按照您的描述进行。请注意，它还从原始文件中删除了事件处理程序`ChildVM`（我在代码中使用了更标准的大写字母）。未能删除事件处理程序通常会导致内存泄漏。

```
class ParentVM
{
    private ChildVM _childVM = new ChildVM();

    public ParentVM()
    {
        _childVM.PropertyChanged += SomeHandler;
    }

    public ChildVM ChildVM
    {
        get
        {
            return _childVM;
        }
        set
        {
            foreach (var handler in _childVM.GetPropertyChangedHandlers())
            {
                _childVM.PropertyChanged -= handler;
                value.PropertyChanged += handler;
            }

            _childVM = value;
        }
    }

    private void SomeHandler(object sender, PropertyChangedEventArgs e)
    {
    }
} 
```

不幸的是，您将在子视图模型类中需要这个额外的方法`GetPropertyChangedHandlers`，因为您不能[`GetInvocationList`](http://msdn.microsoft.com/en-us/library/system.multicastdelegate.getinvocationlist.aspx)从定义事件的类型之外调用。这是代码`ChildVM`：

```
class ChildVM : INotifyPropertyChanged
{
    public PropertyChangedEventHandler[] GetPropertyChangedHandlers()
    {
        return PropertyChanged.GetInvocationList().
               OfType<PropertyChangedEventHandler>().ToArray();
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

回到替代解决方案：您确定有必要考虑订阅这些事件的外部代码吗？如果您正在执行简单的数据绑定，则应该在设置属性时引发该属性的`PropertyChanged`事件`ChildVM`，这应该可以解决您的问题，而无需所有这些额外的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:55:24.660

您是否考虑过迁移到 EventAggregator？

它们周围有很多，例如在 Prism 和 caliburn.micro 中。

基本思想是：有实体发布事件和实体订阅事件（即处理它们）。因此，您从直接订阅 (+=) 转移到更松散耦合的架构，因为您仅将事件发布到 EventAggregator 并且它处理应该调用这些事件的处理程序的位置（多播委托与 += 之前一样）

这真的很容易，您的代码中不再有这种依赖关系。

请查看以下链接

[MSDN Prism 对 EventAggregator 的描述（非常好）](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.20%29.aspx)

[EventAggregator 的 caliburn.micro 描述](http://caliburnmicro.codeplex.com/wikipage?title=The%20Event%20Aggregator)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:39:31.980

**更好的答案：**

在 ParentVM 上实施 INotifyPropertyChanged。更改 ChildVM 时引发事件。订阅 ChildVM 事件的外部对象可以订阅 ParentVMs 属性更改事件，并且可以在收到更改通知时更新 ChildVM 上的事件处理程序。

**原始答案：** 我会创建两种方法`SubscribeChildVMEvents(ChildVM)`，`UnsubscribeChildVMEvent(ChildVM)`并在您的设置器中执行此操作：

```
set{
  UnsubscribeChildVMEvents(_childVM);
             _childVM = value;
  SubscribeChildVMEvents(_childVM);
             //EVENTHANDLERS ARE NOW NOT GONE
         } 
```

从对象中删除事件处理程序是一种很好的做法。

# excel - 如何从没有 VBA 的文件路径中获取文件夹名称

> ID：15770246
> 
> 赞同：0
> 
> 时间：2013-04-02T17:17:59.473
> 
> 标签：excel

我有一长串文件路径，我包括每个文件/文件夹的包含文件夹。我需要从

```
c:\Top\Middle\Bottom\file1.jpg
c:\Top\Middle\file2.jpg 
```

到

```
c:\Top\Middle\Bottom
c:\Top\Middle 
```

可能存在深度嵌套的文件夹，并且文件名的长度各不相同。

如何在没有 VBA 代码的情况下使用公式（MID、RIGHT、LEFT、SUBSTITUTE、FIND 等）来完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T17:28:27.533

这是一个嵌套公式的野兽，但它确实有效。

```
LEFT(A1,SEARCH("\@\",SUBSTITUTE(A1,"\","\@\",LEN(A1)-LEN(SUBSTITUTE(A1,"\",""))))) 
```

*基于[http://www.mrexcel.com/archive/VBA/5563.html上的公式](http://www.mrexcel.com/archive/VBA/5563.html)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:33:03.820

试试这个数组公式：

```
 =LEFT(A1,LEN(A1)-MATCH("\",MID(A1,LEN(A1)-ROW(1:255),1),0)-1) 
```

必须使用`Control`- `Shift`-`Enter`组合键输入。

# javascript - 为什么 $(div#id) 比 $(#id) 慢？

> ID：15770247
> 
> 赞同：4
> 
> 时间：2013-04-02T17:18:00.470
> 
> 标签：javascript, jquery, performance, google-chrome

除非我的测试有问题，否则当我在 Chrome 上运行这个 jsfiddle 时，`$("#id")`选择器大约需要 11 毫秒，选择器大约需要 56 毫秒`$(div#id)`。

```
$(document).ready(function(){
    startTime = new Date().getTime();
    for (i = 0; i < 10000; i++)
    {
        s = $("#idC12");
    }           
    $("#idResults").html("c12 by id only time: "+elapsedMilliseconds(startTime));

    startTime = new Date().getTime();
    for (i = 0; i < 10000; i++)
    {
        s = $("div#idC12");
    }           
    $("#classResults").html("c12 by tagname#id: "+elapsedMilliseconds(startTime));
});

function elapsedMilliseconds(startTime)
{
    var n = new Date();
    var s = n.getTime();
    var diff = s - startTime;
    return diff;
} 
```

[http://jsfiddle.net/MhWUc/](http://jsfiddle.net/MhWUc/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-02T17:18:58.167

这是因为`$("#id")`内部使用了原生[document.getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)函数，该函数使用从 id 链接到具有此 id 的（唯一）元素的映射。

这是 jQuery 源代码中的相关代码：

```
 // Easily-parseable/retrievable ID or TAG or CLASS selectors
        rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/
        ...
        // Speed-up: Sizzle("#ID")
        if ( (m = match[1]) ) {
            if ( nodeType === 9 ) {
                elem = context.getElementById( m );
                // Check parentNode to catch when Blackberry 4.6 returns
                // nodes that are no longer in the document #6963
                if ( elem && elem.parentNode ) {
                    // Handle the case where IE, Opera, and Webkit return items
                    // by name instead of ID
                    if ( elem.id === m ) {
                        results.push( elem );
                        return results;
                    }
                } else {
                    return results;
                }
            } else {
                // Context is not a document
                if ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&
                    contains( context, elem ) && elem.id === m ) {
                    results.push( elem );
                    return results;
                }
            } 
```

你会注意到：

*   当正则表达式检测到`#someId`表单时使用它
*   任何提供的上下文只会增加一个测试，并不会让它更快

请注意，在 jQuery 之外，此规则仍然适用，在定义 CSS 规则或使用`document.querySelector`: 时，当您知道 id 时，没有什么比使用`document.getElementById`（除了缓存的元素...）更快的了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:19:29.277

自从我进入源代码以来已经有一段时间了，但我知道`#some-id`选择器`document.getElementById()`曾经`tagName#some-id`由`document.querySelectorAll`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:19:35.247

`$('div#id')`速度较慢，因为它不直接映射到本机`getElementById()`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:20:04.890

使用 div#id 时，首先选择所有 div。

当您使用#id 时，它会直接转到 id 表。

# vba - 在线形状上使用 vba 模拟单词边框和阴影选项“适用于：”（文本）

> ID：15770248
> 
> 赞同：0
> 
> 时间：2013-04-02T17:18:03.423
> 
> 标签：vba, ms-word, border

我有一个宏，它有一个表，第一行是该表的名称，所有后续行都是粘贴的打印屏幕。宏的作用是，当粘贴新的打印屏幕时，图像会调整为特定大小并添加 050pt 的边框。

我被要求将边框应用于文本：例如：![在此处输入图像描述](https://i.stack.imgur.com/1FXie.png)

我在图像上所做的是选择整个表格，左上角有一个小十字，右键单击鼠标，选择“边框和阴影”选项，最后格式化我的边框，如下所示：.5pt 框单线样式。所有这一切都很好，问题是红色框在哪里，我如何用 VBA 模仿“应用到：文本”选项。当您选择该选项时，它会做什么？当图像表现得像 inlineShape 时，你甚至如何将边框设置为文本有没有办法做到这一点？

注意：如您所见，它是 Office Word 2010

编辑：

有什么方法可以不使用`Selection`吗？问题是我的 sub 是这样工作的：`For Each inlineShape in ActiveDocument.InlineShapes`要获取文档中的所有形状，或者我可以使用 For Each 将所有形状存储在一个变量中并将该变量视为一个`Selection`？我这样做是为了在对文档进行多次更改后，子会触发并检查文档中的每个屏幕截图，以便即使进行了更改也保持一致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T06:58:02.273

大多数情况下，`Range`在 Word 中我们会想到文本。但是，`InlineShapes`它们是`Range`文档中对象的一部分。它们都 - text 和 InlineShapes 可以有边框。我对您的简单想法是在您选择一些文本和/或`InlineShape`.

```
Sub BorderingText_InLnShapes()

With Selection.Range
    .Borders(wdBorderTop).LineStyle = wdLineStyleSingle
    .Borders(wdBorderLeft).LineStyle = wdLineStyleSingle
    .Borders(wdBorderRight).LineStyle = wdLineStyleSingle
    .Borders(wdBorderBottom).LineStyle = wdLineStyleSingle
End With
End Sub 
```

使用宏记录器时，您可以使用类似的宏来引用`Font`对象：

```
Sub Alternative()
'based on recorder
With Selection.Font
    With .Borders(1)
        .LineStyle = wdLineStyleSingle
        .LineWidth = wdLineWidth050pt
        .Color = wdColorAutomatic
    End With
    .Borders.Shadow = False
End With
End Sub 
```

上面的代码与 InlineShape 有点不同，但与文本几乎相同。我希望它有点帮助。

# c - 文件扫描C中的二维数组

> ID：15770251
> 
> 赞同：0
> 
> 时间：2013-04-02T17:18:05.303
> 
> 标签：c, arrays, 2d

我正在解决一个问题，我必须对输入文件进行文件扫描，然后将变量分配给 i 和 j。输入文件 (input.txt) 必须如下所示：

```
100 20
500 70
10 3
250 25
600 100 
```

我的代码看起来像这样。

```
int i, j;
float table[5][5];
FILE * ifp = fopen("input.txt","r");
// initiliaze array
for (i=0; i <=1; i++)
    for (j=0;j<=4;j++)
        fscanf(ifp,"%f",&table[i][j]); 
```

我遇到的问题是所有值都首先按顺序输入到 J 中。我需要将两列拆分，以便 J 先读取左行。例如
，这`table[0][3]`将代表。`250`所以这`table[1][0]`将代表`20`。
或者
如果更容易。将所有列`1`放入`i`并将列`2`放入`j`。让我知道

```
 a[0]  a[1]
a[0][0]--> 100   20  <--a[1][0]
a[0][1]--> 500   70  <--a[1][1]
a[0][2]--> 10    3   <--a[1][2]
a[0][3]--> 250   25  <--a[1][3]
a[0][4]--> 600   100 <--a[1][4] 
```

谢谢。我已经为此苦苦挣扎了一段时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:20:48.353

您正在寻找将文件的列复制到数组的行

要做的事：反转`for`循环

```
for (j=0;j<=4;j++)
    for (i=0; i <=1; i++) 
```

就这样。你会在你的数组中按照你想要的顺序得到数字

**顺便提一句**

改用这个

```
fscanf(ifp," %f",&table[i][j]); 
```

在scanf的字符串格式开头加空格应该是`" %f"`

添加的空间将允许捕获文件的换行符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:28:43.430

首先有几件事：

*   您是否看到您的桌子尺寸太大而无法满足您的要求？
*   您的嵌套`for`循环块没有用大括号括起来。如果您有多个语句要在一个`for`循环中执行，则除非将它们括在大括号中，否则您不会全部执行它们。

现在到你的程序的功能。

*   您可以使用单个`fscanf`语句读取一行中的两个值。您的格式化字符串将类似于`"%f %f"`，然后您将有两个参数。
*   你*总是*会有一个不超过五行的输入文件吗？如果它可以更长，那么您需要随时分配内存。

希望对一些人有所帮助。

# c# - 将像素数据转换为位图 int 数组-WP8-C#

> ID：15770253
> 
> 赞同：2
> 
> 时间：2013-04-02T17:18:20.770
> 
> 标签：c#, bitmap, camera, windows-phone-8

我想制作一个使用相机的应用程序，从中获取框架，将其转换并放在屏幕上。我从微软找到了一个教程，它通过转换为灰度来做到这一点，但我真的不需要那个。相反，我需要从 8b 位图中得到的 int 数组，这样我的转换函数才能正常工作。所以主要问题是如何将该像素数据数组转换为位图数组，然后将其转回以便我可以显示它屏幕？另一种解决方案是直接从相机获取位图 int 数组，但我该怎么做呢？

我需要处理以下代码：

```
 void PumpARGBFrames()
    {
        // Create capture buffer.
        Width = (int)cam.PreviewResolution.Width;
        Height = (int)cam.PreviewResolution.Height;
        int[] ARGBPx = new int[Width * Height];

        try
        {
            PhotoCamera phCam = (PhotoCamera)cam;

            while (pumpARGBFrames)
            {
                pauseFramesEvent.WaitOne();

                phCam.GetPreviewBufferArgb32(ARGBPx);

                //here i need to do the conversion back and forward

                pauseFramesEvent.Reset();
                Deployment.Current.Dispatcher.BeginInvoke(delegate()
                {
                    ARGBPx.CopyTo(wb.Pixels, 0);
                    wb.Invalidate();

                    pauseFramesEvent.Set();
                });
            }

        }
        catch (Exception e)
        {
            this.Dispatcher.BeginInvoke(delegate()
            {
                // Display error message.
                txtDebug.Text = e.Message;
            });
        }
    } 
```

所以，事实是我不需要位图，而是需要一个 int 数组作为 8b 位图的来源。我从微软那里得到的教程在[这里](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202982%28v=vs.105%29.aspx)。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:31:37.127

尝试类似：

```
Bitmap bmp = new Bitmap(Width, Height);

for (int i = 0; i < ARGBPx.Length; ++i)
{
    bmp.SetPixel(
        i % Width,
        i / Width,
        /* something to create a Color object from the pixel int value */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T00:33:17.950

好的，我意识到像素数据数组实际上是一个颜色数组，在 32b 中。所以我必须将 32b 颜色转换为 8b 颜色，并不像我想象的那么难。

谢谢。

# python - 使用 sys.exit() 终止 python 线程

> ID：15770261
> 
> 赞同：1
> 
> 时间：2013-04-02T17:19:04.417
> 
> 标签：python, multithreading, exit, terminate

我正在寻找一种使用 sys.exit() 来终止线程的方法。我有两个函数`add1()`和`subtract1()`，它们分别由每个线程`t1`和执行`t2`。我想`t1`在完成后`add1()`和`t2`完成后终止`subtract1()`。我可以看到这样`sys.exit()`做的工作。这样做可以吗？

```
import time, threading,sys

functionLock = threading.Lock()
total = 0;

def myfunction(caller,num):
    global total, functionLock

    functionLock.acquire()
    if caller=='add1':
        total+=num
        print"1\. addition finish with Total:"+str(total)
        time.sleep(2)
        total+=num
        print"2\. addition finish with Total:"+str(total)

    else:
        time.sleep(1)
        total-=num
        print"\nSubtraction finish with Total:"+str(total)
    functionLock.release()

def add1():

    print '\n START add'
    myfunction('add1',10)
    print '\n END add'
    sys.exit(0)
    print '\n END add1'           

def subtract1():

  print '\n START Sub'  
  myfunction('sub1',100)   
  print '\n END Sub'
  sys.exit(0)
  print '\n END Sub1'

def main():    
    t1 = threading.Thread(target=add1)
    t2 = threading.Thread(target=subtract1)
    t1.start()
    t2.start()
    while 1:
        print "running"
        time.sleep(1)
        #sys.exit(0)

if __name__ == "__main__":
  main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:17:39.643

[sys.exit()](http://docs.python.org/2/library/sys.html)实际上只会引发 SystemExit 异常，并且只有在主线程中调用它才会退出程序。您的解决方案“有效”，因为您的线程没有捕获 SystemExit 异常，因此它终止了。我建议您坚持使用类似的机制，但使用您自己创建的异常，这样其他人就不会被 sys.exit() 的非标准使用（它并没有真正退出）所迷惑。

```
class MyDescriptiveError(Exception):
    pass

def my_function():
    raise MyDescriptiveError() 
```

# c# - 批量/批量 SQL 服务器更新

> ID：15770262
> 
> 赞同：0
> 
> 时间：2013-04-02T17:19:05.930
> 
> 标签：c#, asp.net, entity-framework-5, azure-sql-database, eager-loading

## 代码

```
foreach (var item in _context.Duiven.
                .Include(p => p.Duivenmelker.VoedselInstelling)
                .Include(p => p.VoedselHistoriek)
                .Include(p => p.Duivenmelker.Personeel)
                .Include("Ziektes.DuifZiekte")
                .ToList() // 25.000)
            {
                item.FoodHistory();
                item.HealthSimulation();
                item.DiseaseSimulation(diseaseTypes);
                item.CureSimulation(_context);
                item.DeathSimulation();
                item.Feed();
}

_context.SaveChanges() 
```

## 问题

上面的代码通过 aprox 循环。25000 项。它更新这些对象上的各种东西（这个过程大约需要10分钟）问题在于将所有这些更改保存到数据库中，这需要将近2个小时。

它可能会一一更新（sql）每个更改？（这是 sql azure）该过程还包括删除 25000 条记录和插入 25000 条新记录（4 个整数）

我通过包含很多需要的内容减少了对数据库的调用。但我发现这不是过程，而是需要这么长时间的节省：S

## 问题

[更新记录中的所有值]和[删除当前值并插入新值]之间的性能有区别吗？

我该如何改进将其保存到数据库中？像 10 分钟而不是 160m ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:23:58.240

实体框架不太适合批量更新。

我遇到了同样的情况，最终重写了我的批量更新逻辑以将 ADO.Net 与存储过程一起使用。对于我的特定用例，性能增益约为 10 倍。

根据您的具体情况，另一种选择可能是[SqlBulkCopy 。](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:25:14.623

您可以使用一些技巧，例如每 100 次左右的操作才提交一次。

但是，我总是不得不回退到为从 ORM 执行太慢的数据库操作编写存储过程。

# javascript - JavaScript - 如何拥有第三个“子变量”

> ID：15770269
> 
> 赞同：1
> 
> 时间：2013-04-02T17:19:27.230
> 
> 标签：javascript, html, variables, random-sample

好的，我忘记了链接到列表中已经存在的单个变量的变量列表的名称是什么，但请看一下：

```
function Models(Make) {
    var cars = {
        "Acura": ['Integra', 'NSX', 'RSX', ],
        "BMW": ['M3', ],
        "Buick": ['Regal', ],
        "Cadillac": ['CTS', ],
        "Honda": ['Accord', 'Civic', 'CR-Z', 'Prelude', ],
        "Mazda": ['3', 'MX-5', 'MX-6', 'RX-7', 'RX-8', ],
        "Mini": ['Cooper', ],
        "Nissan": ['240SX', '350Z', 'Fairlady', 'GT-R', 's13', 's14', 's15', ],
        "Toyota": ['Celica', 'MR2', 'Supra', ],
    };
    var holder = cars[Make]
    var Model = holder[Math.floor(Math.random() * holder.length)];
    return Model;
}

function main() {
    var Makes = [
            'Acura',
            'BMW',
            'Buick',
            'Cadillac',
            'Honda',
            'Mazda',
            'Mini',
            'Nissan',
            'Toyota',
    ];
    var Make = Makes[Math.floor(Math.random() * Makes.length)];
    var Model = Models(Make);
    var Out = Make + " " + Model;
    return Out;
}

document.write(main()); 
```

我想在车辆型号之后添加第三类（例如 Mini Cooper “S” 或 Honda Civic “Del Sol”），我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:39:08.493

您的`cars`对象包含许多属性，这些属性都是`Array`s，并且这些`Array`s 被索引，包含`String`s。

如果您想存储的不仅仅是一个字符串（模型），那么您必须将其更改为数组或对象：

```
var cars = {
    "Acura": [
        {
            base: 'Integra'
            submodals: ['S', 'Coupe', 'Si']
        },
        {
            base: 'NSX',
            submodels: ['A', 'B', 'C']
        },
        // ...
    ]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T18:43:06.023

我会编写一个函数，它可以将任意深度的嵌套对象作为参数。然后像这样构造它：

```
var cars = {
    "Acura": {
        "Integra": ['S', 'Coupe', 'Si'],
        "NSX": "",
        "RSX": ""
    },
    "BMW": ['M3'],
    "Buick": ['Regal'],
    "Cadillac": ['CTS'],
    "Honda": {
        "Accord": "",
        "Civic": ["Del Sol"],
        "CR-Z": "",
        "Prelude": ""
    },
    "Mazda": ['3', 'MX-5', 'MX-6', 'RX-7', 'RX-8'],
    "Mini": {
        "Cooper": ["S"]
    },
    "Nissan": ['240SX', '350Z', 'Fairlady', 'GT-R', 's13', 's14', 's15'],
    "Toyota": ['Celica', 'MR2', 'Supra']
};
// (and notice: no trailing commas!) 
```

然后你可以递归地选择一个随机模型：

```
function main() {
    return getRandom(cars).join(" ");
}
function getRandom(o) {
    if (o instanceof Array)
        return o.slice(~~(Math.random()*o.length), 1); // a random item in an array
    // else
    var props = Object.keys(o),
        r = props[ ~~(Math.random()*props.length) ],
        p = o[r];
    if (typeof p == "object") {
        var res = getRandom(p); // recurse
        res.unshift(r);
        return res;
    } // else
    return [ r ]; // an array literal with the random key
} 
```

# html - 如何在不破坏过渡 CSS/HTML 的情况下添加链接

> ID：15770270
> 
> 赞同：0
> 
> 时间：2013-04-02T17:19:27.553
> 
> 标签：html, css, hyperlink, transition

我将如何去做，以便当用户单击图像时，它会将他们带到另一个页面，尽管不会破坏过渡，因为我尝试过的一切都有效，但会删除过渡或使其中一个图像消失

html

```
<div class="box1"> 
<img class="bottom" src="images/eventbox2.png"/>
<img class="top" src="images/eventbox.png"/>
</div> 
```

css

```
.box1 {
  width:430px;
  height:450px;
}

#imagetrans {
  position:relative;
  margin:0 auto;
}

#imagetrans img.top:hover,
#container > div img.top:hover {
  opacity:0;
  margin:0 auto;
}

#imagetrans img,
#container > div img {
  position:absolute;
  -webkit-transition: opacity 0.3s ease-in-out;
  -moz-transition: opacity 0.3s ease-in-out;
  -o-transition: opacity 0.3s ease-in-out;
  transition: opacity 0.3s ease-in-out;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:31:26.023

您是否尝试过在 CSS 中添加“a”

```
#imagetrans img,
#container > div img a {
    position:absolute;
    -webkit-transition: opacity 0.3s ease-in-out;
    -moz-transition: opacity 0.3s ease-in-out;
    -o-transition: opacity 0.3s ease-in-out;
    transition: opacity 0.3s ease-in-out;
} 
```

# jquery - 任何用于在 Google 日历中制作“快速添加”功能的 js 库？

> ID：15770276
> 
> 赞同：1
> 
> 时间：2013-04-02T17:19:47.233
> 
> 标签：jquery, javascript

我一直在环顾四周，发现了一些库，如 jquery datepicker 或 xdate。但是我还没有找到任何能够标记输入的东西，例如“明天下午 5 点去健身房”，并将其转换为带有适当日期对象的 JSON 输入。

我正在考虑从头开始构建自己的日历，但由于谷歌日历已经存在了很长时间，我想知道是否有人听说过任何图书馆在做同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:41:30.803

[Datejs](http://www.datejs.com/)将是一个好的开始，它可以计算出“明天”（参见[此处](http://www.datejs.com/test/relative/index.html)）和“下午 5 点”（参见[此处](http://www.datejs.com/test/time/index.html)）部分，但我认为您必须分别输入它们。

# c# - 如何在 ExplorerBrowser 中显示文件列表？

> ID：15770277
> 
> 赞同：0
> 
> 时间：2013-04-02T17:19:47.230
> 
> 标签：c#, wpf, windows-api-code-pack

我编写了一个算法来查找符合特定条件的文件。获得这些文件（`FileInfo`对象）后，如何在`ExplorerBrowser`控件中显示？我对 Windows API 代码包非常陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:58:39.287

您可以使用`Treeview`来显示它们，然后使用`ProcessStartInfo`来打开这些想要的文件，例如：

```
foreach(FileInfo file in objects)
       {
          treeView1.Nodes.Add(file.FullName);
       } 
```

使用后`NodeMouseClick`：

```
 private void treeView1_NodeMouseClick(object sender, TreeNodeMouseClickEventArgs e)
        {
            treeView1.SelectedNode = e.Node;
            string args = string.Format("/Select, {0}", treeView1.SelectedNode.Text);

            ProcessStartInfo process= new ProcessStartInfo("explorer.exe", args);
            System.Diagnostics.Process.Start(process);
        } 
```

# python - 在 python 中使用布尔列表

> ID：15770282
> 
> 赞同：2
> 
> 时间：2013-04-02T17:19:58.840
> 
> 标签：python, list, boolean

我正在为班级制定锦标赛计划。该程序应该让用户输入所有团队名称，选择2个团队，并询问用户哪个团队获胜，获胜者将继续前进。我想通过使用布尔值在一个数组中完成这一切。我希望数组中的所有值都以 开头`false`，如果他们获胜，则团队名称将变为`true`。

到目前为止我有这个

```
amount = int(raw_input('How many teams are playing in this tournament?   ')
teams = []
i = 0
while i < amount:
    teams.append(raw_input("please enter team name:   ")
    i = i + 1 
```

现在，我怎样才能列出整个清单`false`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:27:39.903

在我看来，使用字典而不是列表是一种更好的方法。您只需将每个团队名称作为键添加到字典中，并将其对应的值分别设置为`False`or `True`：

```
amount = int(raw_input('How many teams are playing in this tournament?   ')
teams = {}
i = 0
while i < amount:
    team_name = raw_input("please enter team name: ")
    teams[team_name] = False
    i = i + 1 
```

如果您想选择赢得比赛的球队，您只需在字典中查找球队名称并将其值设置为`True`。这样，您可以将团队名称和布尔值保留在一个数据结构中，而不需要两个数据结构或总是用根本没有意义的布尔值替换团队名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:21:25.803

由于您已经知道团队的数量（数量），您可以这样做

```
team_status = [False]*amount 
```

`teams`在这里，和的索引`team_status`是相同的，因此每次您想要特定团队的状态时都可以进行简单的查找。

或者

你可以用字典

```
amount = int(raw_input('How many teams are playing in this tournament?   ')
teams = {}
for i < range(amount):
    team_name = raw_input("please enter team name:   ")
    teams.update({team_name: False}) 
```

# android - 是否可以使应用程序徽标图标超过操作栏的高度？

> ID：15770288
> 
> 赞同：3
> 
> 时间：2013-04-02T17:20:09.060
> 
> 标签：android, android-actionbar, android-icons

我的视觉设计师刚刚递给我一个样机，在操作栏中有一个超大的应用程序徽标图标。我从未见过在 Android 应用程序中取得成功。是否有可能，如果可以，指定图标的高度在哪里？

我正在拍摄看起来像右侧示例的东西。

![超大操作栏图标的模拟](https://i.stack.imgur.com/ZUWze.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:29:24.313

这是不可能的，但你可以用一点小费来做到

如果你的设计师将图标分成两部分，在这种情况下，机器人的顶部和机器人的腿，你将这个腿添加到带有 ImageView/View 的 Activity 布局中，你可以模拟更大图标的效果。

唯一的问题是图标填充，但我认为您可以设置为 0。如果您使用 ActionBar Sherlock 库并更改代码（其开源）ActionBar Sherlock 和 ActionBar 本机是平等的，也许它更容易

# node.js - 未找到带有 npm 的优雅 fs 模块

> ID：15770290
> 
> 赞同：0
> 
> 时间：2013-04-02T17:20:11.890
> 
> 标签：node.js, npm

我正在尝试使用 npm 安装模块，但不断收到有关“graceful-fs”的错误。

```
$ npm install testacular
  node.js:201
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
  Error: Cannot find module 'graceful-fs'
    at Function._resolveFilename (module.js:334:11)
    at Function._load (module.js:279:25)
    at Module.require (module.js:357:17)
    at require (module.js:368:17)
    at Object.<anonymous> (/usr/share/npm/lib/utils/ini.js:32:10)
    at Module._compile (module.js:432:26)
    at Object..js (module.js:450:10)
    at Module.load (module.js:351:31)
    at Function._load (module.js:310:12)
    at Module.require (module.js:357:17) 
```

然后我尝试安装'graceful-fs'并得到完全相同的错误。所以，我然后尝试查看我安装的 npm 版本并得到相同的...确切...错误...

我目前正在使用 node.js 版本 0.5.11-pre。我该如何解决这个问题？似乎一切都需要这个缺少的模块，我无法下载它。

编辑：

我发现 graceful-fs.js 实际上位于我的 /usr/lib/nodejs 目录中。我尝试运行：

```
npm install graceful-fs 
```

仍然，同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T19:18:07.073

您可能想尝试重新安装节点。在你使用它的同时更新，除非你有一个非常具体的理由使用 0.5 - 奇数版本被指定为不稳定，偶数版本被指定为稳定。0.8 是最新的稳定版本。

当一个模块无法通过 npm 安装时，我偶尔会看到这个错误。如果 npm 不执行任何操作，请尝试从 nodejs 目录中删除 graceful-fs，如果它在更新 Node 后仍然存在的话。

# c# - 使用 HTML 元素更新查询字符串并在页面上重新加载内容

> ID：15770295
> 
> 赞同：0
> 
> 时间：2013-04-02T17:20:42.440
> 
> 标签：c#, jquery, html, ajax

此代码的目标是通过单击表格数据来动态更新网站。命令字符串有可变章节，我只喜欢更新和重新加载 gridview。

```
protected void Page_Load(object sender, EventArgs e)
{
string masterfile = "C://Temp/List of Validations.xlsx";
string CS = "Provider=Microsoft.ACE.OLEDB.12.0; Data Source=" + masterfile + ";Extended Properties=Excel 12.0;";
using (OleDbConnection con = new OleDbConnection(CS))
{
con.Open();
    OleDbCommand cmd = new OleDbCommand("SELECT * FROM [Validation$] where chapter = @chapter", con);
//How to Dynamically assign this ch variable using the value table data text(01, 02, 03) and reload the contents in the gridview1\.  
    cmd.Parameters.AddWithValue("@chapter", ch)
    using (OleDbDataReader rdr = cmd.ExecuteReader())
{
             DataTable mastertable = new DataTable();
               mastertable.Columns.Add("Chapter");
               mastertable.Columns.Add("Section");
}
etc...
GridView1.DataSource = mastertable;
GridView1.DataBind();
} 
```

以下是我使用服务器对象所做的测试，它工作得很好

```
public OleDbConnection connectionobject() {
connection object code 
return con;
}
public OleDbCommand commandobject(OleDbConnection con, int ch) {
command object code
return cmd;
}
protected void Button1_Click(object sender, EventArgs e)
{
int ch = Convert.ToInt32(TextBox1.Text);
OleDbConnection con;
con = connectionobject();
OleDbCommand cmd;
cmd = commandobject(con, ch);
con.Open();
using (OleDbDataReader rdr = cmd.ExecuteReader())
{
GridView3.DataSource = rdr;
GridView3.DataBind();
} 
```

# python - 漂亮的字典初始化（Perl 风格）

> ID：15770299
> 
> 赞同：-3
> 
> 时间：2013-04-02T17:20:50.823
> 
> 标签：python, dictionary

在 Perl 初始化中，散列的散列如下所示：

```
 my %data_ops = (
    data1 => { 
      conv_to_num   => \&data1_to_num, 
      conv_to_str   => \&data1_to_str, 
      gen_rand_val  => \&data1_gen_rand,
    },

    data2 => { 
      conv_to_num   => \&data2_to_num, 
      conv_to_str   => \&data2_to_str, 
      gen_rand_val  => \&data2_gen_rand,
    },
  ); 
```

有没有办法在 Python 中做同样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:24:34.460

默认的 dict 文字语法没有错：

```
data_ops = {
    'data1': { 
        'conv_to_num':  data1_to_num, 
        'conv_to_str':  data1_to_str, 
        'gen_rand_val': data1_gen_rand,
    },

    'data2': { 
        'conv_to_num':  data2_to_num, 
        'conv_to_str':  data2_to_str, 
        'gen_rand_val': data2_gen_rand,
    },
} 
```

或者您可以使用`dict()`构造函数，前提是您的密钥也是有效的 python 标识符：

```
data_ops = dict(
    data1=dict( 
        conv_to_num=data1_to_num, 
        conv_to_str=data1_to_str, 
        gen_rand_val=data1_gen_rand,
    ),

    data2=dict( 
        conv_to_num=data2_to_num, 
        conv_to_str=data2_to_str, 
        gen_rand_val=data2_gen_rand,
    ),
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:24:06.427

等效的 Python 可能看起来像这样（我只是使用常量来清楚地显示结构）：

```
data_ops = {
  'data1': {
    'conv_to_num': 1,
    'conv_to_str': '1',
    'gen_rand_val': 6,
  },

  'data2': {
    'conv_to_num': 2,
    'conv_to_str': '2',
    'gen_rand_val': 3,
  },
} 
```

显示访问权限的示例：

```
>>> data_ops['data1']['conv_to_num']
1
>>> data_ops['data2']['gen_rand_val']
3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:24:19.490

抱歉，没有办法在 Python 中使用 Perl 语法。但是，当然，您可以在 Python 中初始化 dicts。

```
data_ops = {
    data1: { 
        "conv_to_num": data1_to_num, 
        "conv_to_str": data1_to_str, 
        "gen_rand_val": data1_gen_rand,
    },

    data2: { 
        "conv_to_num": data2_to_num, 
        "conv_to_str2: data2_to_str, 
        "gen_rand_val": data2_gen_rand,
    },
} 
```

重要的一点是在赋值的行上打开大括号`=`，这将告诉编译器继续语句/表达式，直到找到匹配的大括号。

# refactoring - 重构：将方法提取到类中

> ID：15770302
> 
> 赞同：0
> 
> 时间：2013-04-02T17:21:02.137
> 
> 标签：refactoring, resharper, coderush, coderush-xpress

有没有一种工具可以让我在没有太多手动工作的情况下将方法提取到类中？我需要大规模的，100 种方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T08:55:43.353

ReSharper 7.0 中有一个`Extract class`重构。您可以选择哪些方法将进入提取的类。但是您不能通过单击一个按钮一次提取 100 个类。我怀疑是否有工具可以做到这一点。但是你总是可以尝试为 ReSharper 编写一个插件来完成这个任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T23:43:00.150

这是我使用 resharper 的方法：将插入符号放在方法名称中，调出 resharper 菜单（Ctrl+Shift+R），选择“移动到另一种类型”，这将打开一个对话框，可以帮助您找到“转移到位置”。

或者，如果您在 Visual Studio 中使用 resharpers 默认快捷方式，只需将插入符号放在方法名称中，然后按 F6。

# php - 在 php/mysql 中使用表名变量

> ID：15770304
> 
> 赞同：0
> 
> 时间：2013-04-02T17:21:13.843
> 
> 标签：php, mysql, tablename

我对 php 和 mysql 很陌生。我在一页上创建了一个 html 表单。该操作转到另一个页面，该页面在 mysql 数据库中创建一个表并输入输入到表单中的所有信息。然后在原始页面上，我调用创建的表并将信息打印到表中。这一切都很好。

我的问题是我需要在大约 6,000 页上包含此表格和表格。我只想使用一个动作文件，但为每个页面创建一个不同的表名。

是否可以让表名成为一个变量，我可以在每个表单页面上更改它的值并让它在操作页面上自动更改。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:29:44.857

我不确定为什么每次都需要不同的表名，但是您是否考虑过另一个名称表，当您调用它时可能与表相关联，或者如果您希望每个实例都有一个唯一的，甚至给它一个 guid姓名。

# javascript - 如何在没有脚本标签但在 js 文件中的 javascript 中执行 http 回调请求？

> ID：15770309
> 
> 赞同：0
> 
> 时间：2013-04-02T17:21:36.177
> 
> 标签：javascript, http, twitter, request

我想把这个

```
<script type="text/javascript" src="https://api.twitter.com/1/statuses/user_timeline/EricClaptonNews.json?callback=twitterCallback2&count=10"></script> 
```

当我在脚本标签中的 html 文件中，在我的一个 .js 文件中使用它时，它会起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:25:06.190

您需要为上述链接创建一个[XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)，确保省略该`callback`参数，因为只有`JSONP`请求才需要该参数。

但是，由于 Twitter 域与您的网站不在同一个域中，因此此调用将失败[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)。

因此，您唯一的选择（如果您不愿意使用`JSONP`）是从服务器端拨打电话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:30:10.130

```
var head = document.getElementsByTagName("head")[0];

head.innerHTML += "<script type="text/javascript" src="https://api.twitter.com/1/statuses/user_timeline/EricClaptonNews.json?callback=twitterCallback2&count=10"></script>"; 
```

或者

```
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = "https://api.twitter.com/1/statuses/user_timeline/EricClaptonNews.json?callback=twitterCallback2&count=10";

head.appendChild(script); 
```

但我和@RobertHarvey 在一起，你为什么要这样做？

**编辑：**

阅读您对@RobertHarvey 的评论，您会想要使用我建议的第二种方法，然后您可以像这样构建您的网址：

```
function url_builder(foo){
    var url = https://api.twitter.com/1/statuses/user_timeline/EricClaptonNews.json?callback=twitterCallback2&count="+foo; //dynamically call a number stored in foo
    return url;
}

var url = url_builder(30);  //want to get 30 tweets instead of 10!
var script = document.createElement("script");
script.type = 'text/javascript';
script.src = url;

head.appendChild(script); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:32:22.683

首先，在您的 html 中定义标签`<form>`：

```
<html>
<body>

<form name="Form1">
...

</form>

</body>
</html> 
```

然后在你的 .js 中试试这个

```
document.forms[0].action="https://api.twitter.com/1/statuses/user_timeline/EricClaptonNews.json?callback=twitterCallback2&count=10";
document.forms[0].submit(true); 
```

我们希望它会有所帮助。

# php - 从文本数组中提取数值

> ID：15770310
> 
> 赞同：0
> 
> 时间：2013-04-02T17:21:36.627
> 
> 标签：php, arrays, string, int

如何从这个数组中提取数值？

```
array (
  0 => '\'268',
  1 => '252',) 
```

只需要去掉数字，然后我需要做一些计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:32:36.543

```
$source = array(
    0 => '\'268',
    1 => '252',
);

function strip($element)
{
    $matches = array();
    preg_match('#[0-9]+#', $element, $matches);
    return (int)reset($matches);
}

$result = array_map('strip', $source);

var_dump($result); 
```

结果：

```
array (size=2)
  0 => int 268
  1 => int 252 
```

# ms-access - 如何更改访问邮件合并源？

> ID：15770311
> 
> 赞同：2
> 
> 时间：2013-04-02T17:21:45.173
> 
> 标签：ms-access

我有一个表达式，它从一个字段（日期）中提取月份和日期，然后从另一个字段（DOB - 出生日期）中提取年份。

来自字段的示例数据：

**日期：2003 年 1 月 2 日**

**出生日期：1953 年 1 月 15 日**

**一个表达式：**

```
Cancel Date: DatePart("m",[Date]) & "/" & DatePart("d",[Date]) & "/" & (DatePart("yyyy",[DOB])+60) 
```

**将返回：2013 年 1 月 2 日**

我的问题是：如果 DOB 发生在该年现有 DATE 周年之后，那么取消日期应该增加 1 年，所以上面的表达式应该返回 2014。我将如何去包含它并简化这个表达式？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:44:39.623

我还没有测试过这个查询，所以它可能需要调整才能得到你想要的。这个想法是用来`Format()`简化*m/d/*部分。然后使用`IIf()`表达式来确定要添加多少年`Year([DOB])`。

```
SELECT
    Format([Date], 'm/d/') & (Year([DOB])
        + IIf(DatePart('y', [DOB]) > DatePart('y', [Date]), 61, 60))
        AS [Cancel Date]
FROM YourTable; 
```

该方法依赖于`DatePart('y', ...)`，它为您提供*“一年中的一天”*。例如，`DatePart("y", #2013-04-02#)`返回 92。您可以使用此方法将一个日期的月/日部分与另一个日期的月/日部分进行比较……这是一种捷径，以避免单独检查月和日。

**不幸**的是，`DatePart('y', ...)`没有正确计算闰年。（见下面戈德的评论。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:52:31.523

我相信这就是你所追求的：

```
Cancel Date: DatePart("m", [Date]) & "/" & DatePart("d", [Date]) & "/" & (DatePart("yyyy", [DOB]) + IIf((DatePart("m", [DOB]) < DatePart("m", [Date])) Or (DatePart("m", [DOB]) = DatePart("m", [Date]) And DatePart("d", [DOB]) < DatePart("d", [Date])), 60, 61)) 
```

该`IIf()`部分基本上说

```
If (Month([DOB]) < Month([Date]))
        Or (Month([DOB]) = Month([Date]) And Day([DOB]) < Day([Date])) Then
    add 60
Else
    add 61
End If 
```

# r - 根据其他列的条件将数值替换为 NA

> ID：15770317
> 
> 赞同：1
> 
> 时间：2013-04-02T17:21:59.080
> 
> 标签：r, data.table

这与可以在以下位置找到的先前问题有关：

[根据其他列的条件将数值替换为 NA：](https://stackoverflow.com/questions/15768417/)

下面是数据：

```
DT <- data.table(a = sample(c("C","M","Y","K"),  100, rep=TRUE),
                   b = sample(c("A","S"),  100, rep=TRUE),
                   f = round(rnorm(n=100, mean=.90, sd=.08),digits = 2) ); DT 
```

我想对以下功能进行优雅而简洁的重写：

```
`%between%` <- function(x, vals) { x >= vals[1] & x <= vals[2]}
`%nbetween%` <- Negate(`%between%`) 
```

以及以下脚本将满足某些条件的某些值替换为 NA

```
DT[a == "C" & b %in% c("A", "S") & f %nbetween% c(.85, .95), f := NA]
DT[a == "M" & b %in% c("A", "S") & f %nbetween% c(.85, .95), f := NA]
DT[a == "Y" & b %in% c("A", "S") & f %nbetween% c(.80, .90), f := NA]
DT[a == "K" & b %in% c("A", "S") & f %nbetween% c(.95, 1.10), f := NA] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:57:14.740

如果你对你的函数进行矢量化，那么你可以让它更优雅一点：

```
`%between%` <- function(x, vals, vals2)  x >= vals & x <= vals2
`%nbetween%` <- Negate(`%between%`)

# This will get you a nice ranges table.
ranges<-data.table(a=c('C','M','Y','K'),low=c(0.85,0.85,0.80,0.95),high=c(0.95,0.95,0.90,1.10))
# Set the keys for an easy merge.
setkeyv(ranges,'a')
setkeyv(DT,'a')
# Merge and filter.    
DT<-merge(DT,ranges,all.x=TRUE)[b %in% c('A','S') & `%nbetween%`(f,low,high),f:=NA ]
# A nice suggestion from the comments:
DT<-DT[ranges][b %in% c('A','S') & `%nbetween%`(f,low,high),f:=NA]

#     a b    f  low high
#  1: C S 0.88 0.85 0.95
#  2: C S   NA 0.85 0.95
#  3: C S 0.92 0.85 0.95
#  4: C A 0.94 0.85 0.95
#  5: C S   NA 0.85 0.95
#  6: C S 0.90 0.85 0.95 
```

# c# - .NET Framework 的目标版本与启动条件不匹配

> ID：15770318
> 
> 赞同：41
> 
> 时间：2013-04-02T17:21:59.510
> 
> 标签：c#, .net, visual-studio-2010, windows-installer

我有一个在 VS 2010 中构建的 ac# 项目。它通过 COM 引用了一个 C++ 项目，这也是解决方案的一部分。上周五，我进行了一次成功的构建，更改了一行代码，又进行了一次构建，然后我开始收到有关 .NET 的错误。

项目中 .NET Framework 的目标版本与 .NET Framework 启动条件版本“.NET Framework 3.5”不匹配。在高级编译选项对话框 (VB) 或应用程序页面（C#、F#）中更新 .NET Framework 启动条件的版本以匹配 .NET Framework 的目标版本。

*   项目 -> 属性 -> 应用程序 -> 目标框架（对于调试和发布中的每个项目）
*   项目 -> 属性 -> 发布 -> 先决条件（确认 .NET 3.5 和 Windows Installer 3.1）
*   设置 -> 启动条件 -> .NET Framework
*   设置 -> 属性 -> 先决条件

我还查看了我的安装程序的 vdproj 代码，确认启动条件是 .NET 3.5：

```
"ComponentsUrl" = "8:"
"Items"
{
    "{EDC2488A-8267-493A-A98E-7D9C3B36CDF3}:Microsoft.Net.Framework.3.5.SP1"
    {
        "Name" = "8:.NET Framework 3.5 SP1"
        "ProductCode" = "8:Microsoft.Net.Framework.3.5.SP1"
    }
    "{EDC2488A-8267-493A-A98E-7D9C3B36CDF3}:Microsoft.Windows.Installer.3.1"
    {
        "Name" = "8:Windows Installer 3.1"
        "ProductCode" = "8:Microsoft.Windows.Installer.3.1"
    }
}

"ComponentsUrl" = "8:"
"Items"
{
     "{EDC2488A-8267-493A-A98E-7D9C3B36CDF3}:Microsoft.Net.Framework.3.5.SP1"
     {
         "Name" = "8:.NET Framework 3.5 SP1"
         "ProductCode" = "8:Microsoft.Net.Framework.3.5.SP1"
     }
     "{EDC2488A-8267-493A-A98E-7D9C3B36CDF3}:Microsoft.Windows.Installer.3.1"
     {
         "Name" = "8:Windows Installer 3.1"
         "ProductCode" = "8:Microsoft.Windows.Installer.3.1"
     }
}

"LaunchCondition"
{
    "{A06ECF26-33A3-4562-8140-9B0E340D4F24}:_799EF2A78D074B669D0B30310FD56A67"
    {
        "Name" = "8:.NET Framework"
        "Message" = "8:[VSDNETMSG]"
        "FrameworkVersion" = "8:.NETFramework,Version=v3.5"
        "AllowLaterVersions" = "11:FALSE"
        "InstallUrl" = "8:http://go.microsoft.com/fwlink/?LinkId=131000"
    }
} 
```

因为我为 x86 和 x64 编译器构建，所以我有两个设置项目。第二个，对于 x86 处理器，没有出现 .NET 错误。我已经将它的 vdproj 中的代码与这个进行了比较，它看起来是一样的。

我在这个问题上找到了几个线程，包括一个非常好的线程，但它们都没有帮助我解决这个问题[。](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/5167197a-12a5-473e-940a-569e92f08f37/)任何的意见都将会有帮助。

**编辑**

我将所有内容都更改为 .NET 4.0，只是为了看看它是否有所作为，并且项目构建成功。我把它改回来了，它又给了我 .NET 版本错误。我检查了 vdproj 文件中是否有任何“4.0”参考，并且只找到了 AspNetVersion，它也出现在有效的 x86 版本的安装程序中。

```
"AspNetVersion" = "8:4.0.30319.0" 
```

我需要使用 .NET 3.5 发布，所以这只是一个练习，看看将版本更改为其他版本并返回是否可以解决问题。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2015-10-12T10:31:26.223

通过 UI（不是文本编辑器）更改它。取自[这里](https://social.msdn.microsoft.com/Forums/windows/en-US/5167197a-12a5-473e-940a-569e92f08f37/error-the-version-of-the-net-framework-launch-condition-net-framework-4-does-not-match-the?forum=winformssetup)。

> 1) 选择安装项目
> 
> 2）在解决方案资源管理器或解决方案导航器中单击面板顶部的“启动条件编辑器”图标（在 VS2010 中，它是带有双筒望远镜的图标，在 VS2015 和 VS2017 中，图标是一张纸，前面有一个过滤器（在评论中向 Mat 和 Bob Van de Vijver 喊叫）。
> 
> 3）在启动条件下，在“属性”中选择右侧的“.Net framework”选择“版本”，您将看到一个下拉列表。将框架更改为您的目标框架。
> 
> 4) 构建和安装。

如果您随后收到类似于以下内容的消息：

> 警告：.NET Framework 启动条件“.NET Framework 4”的版本与所选的 .NET Framework 引导程序包不匹配。更新 .NET Framework 启动条件以匹配在先决条件对话框中选择的 .NET Framework 版本。

执行以下步骤：

> 1) 右键单击​​安装程序项目，然后单击“属性”。
> 
> 2) 单击“先决条件”按钮。
> 
> 3) 根据需要进行更改。

编辑：根据评论更新了不同版本 VS 的启动条件编辑器图标描述。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-03T00:07:14.063

事实证明，出于某种原因，C++ 代码也与 .NET 相关联。我使用[这篇](http://msdn.microsoft.com/en-us/library/vstudio/ff770576%28v=vs.100%29.aspx)文章帮助我将 c++ .NET 版本从 4.0 更改为 3.5。基本步骤是

1.  在文本编辑器中打开 c++ 项目 vcxproj
2.  寻找`<TargetFrameworkVersion>v4.0</TargetFrameworkVersion>`
    *   这可能需要在 Globals PropertyGroup 下创建
3.  将 4.0 更改为 3.5
4.  在VS中打开项目
5.  右键单击 c++ 项目并选择属性
6.  选择Common Properties并确认版本是3.5
7.  选择配置属性 -> 常规
8.  确保平台工具集设置为 v90

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-01T18:16:31.013

与该项目从 2008 年到 2010 年转换时存在相同的问题。

要更改引导程序，我打开了 .csproj 并从其中手动删除了 3.5 中的实例：

```
<BootstrapperPackage Include="Microsoft.Net.Client.3.5">
  <Visible>False</Visible>
  <ProductName>.NET Framework 3.5 SP1 Client Profile</ProductName>
  <Install>false</Install>
</BootstrapperPackage>
<BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
  <Visible>False</Visible>
  <ProductName>.NET Framework 3.5 SP1</ProductName>
  <Install>false</Install>
</BootstrapperPackage> 
```

此外，我发现您只需右键单击安装和部署项目，点击属性，转到先决条件，然后选择正确的 .NET 框架。

很难找到它，您必须单击先决条件按钮。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-02-10T09:54:16.627

即使在上面提到的所有地方都设置了框架版本和设置项目先决条件之后。错误继续出现。然后我查看了安装项目文件，发现之前的 NET 框架版本仍然在配置/调试部分下被提及，因此在 Visual Studio 中我将编译模式设置回调试，重复相同的更改并为我清除了错误。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-02-12T09:56:24.510

我也面临同样的问题。我犯了一个错误，即目标框架在所有地方都不同。你可以验证在下面提到的地方应该选择相同的框架。我使用的是 VS2015。放置1-右键Project->Properties->application->target framework for me（.Net framework 4）你可以根据你的项目选择。位置 2 - 右键单击​​安装程序项目 -> 属性 -> 先决条件 -> 选择 microsoft framework 4（X86 和 X64），这取决于您的目标框架。位置 3 - 右键单击​​安装程序项目 -> 单击视图 -> 启动条件 -> .net Framework -> 右键单击​​属性 -> 选择 >net framework 4\. 我正在使用 Windows 服务并在从 vs 2010 更新时遇到此问题到2015。希望对你有所帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-03-15T21:59:06.310

*   在主菜单上选择“项目”
*   选择选项“属性”
*   将打开一个表单，选择“构建”，单击“先决条件”按钮，选择您的 .Net 版本。

# excel - 使用 Excel 在一年内随机唯一的星期五日期

> ID：15770320
> 
> 赞同：0
> 
> 时间：2013-04-02T17:22:24.103
> 
> 标签：excel, random, unique, excel-formula

我需要在特定年份内生成唯一的随机星期五日期。

我有一个或多或少的工作示例：随机唯一日期，周一至周五，一年内您可以查看：[http ://www.get-digital-help.com/2010/11/26/create-random -dates-mon-to-fri-within-a-year-in-excel/](http://www.get-digital-help.com/2010/11/26/create-random-dates-mon-to-fri-within-a-year-in-excel/) 这个例子的问题：它不是星期五日期，它没有生成唯一的日期，有重复的日期。

该列表必须生成 N 个随机日期，在特定单元中通知 N 个数字。示例： A1: 4（则列表必须生成 4 个随机日期） A1：8（则列表必须生成 8 个随机日期） A1：20（则列表必须生成 20 个随机日期）

如果我有选项我会要求不要使用 vba .. 有没有办法只在 excel 公式中做？

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:41:47.843

好的，这是一种方法 - 这将为您提供指定年份中的随机数量的星期五...为了简化它仅从前 52 个星期五中选择，如果一年中有 53 个星期五，它不会选择那个第53个....虽然可以更改公式来这样做。

在 A1 中放入年份，例如 2013 年，在 A2 中放入要生成的数字，例如 4，在 C1 中放入一些文本，例如“日期” - 现在在 C2 中复制以下公式：

`=IF(ROWS(C$2:C2)>A$2,"",SMALL(IF(COUNTIF(C$1:C1,DATE(A$1,1,1+7*ROW(INDIRECT("1:52")))-WEEKDAY(DATE(A$1,1,2)))=0,DATE(A$1,1,1+7*ROW(INDIRECT("1:52")))-WEEKDAY(DATE(A$1,1,2))),RANDBETWEEN(1,53-ROWS(C$2:C2))))`

用`CTRL``SHIFT`++确认`ENTER`并向下复制到 C53。如果 A2 数字较低，则后面的单元格将保持空白。现在您可以根据需要更改 A1 和 A2 以生成新列表

这是一个示例的[链接](https://www.dropbox.com/s/38xryyec14eli3k/RandomFridays.xlsx)- A2 是一个随机数 - 按 F9 重新生成“测试”列只显示每个日期有多少个实例 - 因为不应该有重复，应该总是一个

...或者这是[另一个版本](https://www.dropbox.com/s/pgzxsevlpv8tsat/RandomDays.xlsx)，其中包含一些帮助单元格来简化公式 - 在 B1 中指定年份，在 B2 中显示日期数，在 B3 中指定日期：

C2中的公式是

=IF(ROWS(D$2:D2)>B$2,"",SMALL(IF(COUNTIF(D$1:D1,B$4+ROW(INDIRECT("1:"&B$5))*7-7)=0 ,B$4+ROW(间接("1:"&B$5))*7-7),RANDBETWEEN(1,B$5+1-ROWS(D$2:D2))))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:01:56.437

这是一个非常简单的方程式，您可以将其粘贴到 A1 中并向下拖动。

```
=DATE(2012,1,(RANDBETWEEN(-100,100)*7)-1) 
```

下面是它的工作原理。

我首先生成一个从 2012 年开始的日期。
`=date(2012,1,1)`恰好是星期六。所以，我知道我需要从最终日期中减去 1 天。

接下来，我知道一周有 7 天，所以我生成了一个从 -100 到 100 的随机数，`randbetween(-100,100)`并将这个数字乘以 7。这将为您提供 2012 年 4 年内的日期，无论是哪个方向。

当前的每个日期都将是星期六，因为它是 7 天的倍数。所以，减 1。

# java - Java：使用 NIO 读取可变大小的数据包

> ID：15770328
> 
> 赞同：0
> 
> 时间：2013-04-02T17:22:56.767
> 
> 标签：java, networking, nio

我正在编写我正在处理的应用程序的服务器组件。我正在使用 NIO 来处理网络，但我正在努力寻找一种有效的方式来处理阅读。客户端应用程序可以向服务器发送大小差异很大的数据包。它可以是 100 字节的文本消息，也可以是 500 KB 的图片，并且服务器需要能够处理这些数据包。通常，我会创建一个足够大的缓冲区以包含最大可能的数据包，但在这个应用程序的情况下，这意味着我可能必须有*兆字节的缓冲区*每个客户端的大小，这会吞噬内存。在和我的朋友讨论之后，我决定我想像使用旧 IO 一样处理这个问题。这意味着我将为每个数据包分配一个新缓冲区，该缓冲区的容量与传入数据包的长度完全相同。我的数据包结构如下：

[int] [length]
[byte] [opcode]
[byte...] [payload]

我的方法是有两个单独的缓冲区：一个容量为 4 的缓冲区来读取长度，另一个缓冲区将不断地以不同的容量重新初始化 - 数据包的长度。这是我想出的代码：

```
User user = (User) selectionKey.attachment();
SocketChannel socketChannel = user.getSocketChannel();
ByteBuffer readBuffer = user.getReadBuffer();
ByteBuffer lengthBuffer = user.getLengthBuffer();
/*
 * Read as many packets as possible.
 */
while (true) {
    /*
     * Read the length if it has not been read yet.
     */
    if (lengthBuffer.hasRemaining()) {
    socketChannel.read(lengthBuffer);
    /*
     * If the length could not be read, stop reading and wait for
     * more data to arrive.
     */
    if (lengthBuffer.hasRemaining()) {
        break;
    }
    } else {
    /*
     * Create a read buffer if one has not been created for the
     * incoming packet.
     */
    if (readBuffer == null) {
        lengthBuffer.flip();
        user.setReadBuffer(ByteBuffer.allocate(lengthBuffer
            .getInt()));
    }
    /*
     * Attempt to read the packet.
     */
    socketChannel.read(readBuffer);
    /*
     * If the packet was not completely read, then stop reading
     * altogether because all of the data has not been received yet.
     */
    if (readBuffer.hasRemaining()) {
        break;
    } else {
        /*
         * Otherwise, handle the data and prepare the buffers for
         * the next packet read.
         */
        readBuffer.flip();
        user.handleData();
        user.setReadBuffer(null);
        lengthBuffer.clear();
    }
    }
} 
```

我看到了一些问题。一方面，我有时会在线收到 NullPointerException `socketChannel.read(readBuffer)`。除此之外，这个解决方案似乎并不干净。感觉代码里逻辑太多，好像有问题。有人可以为我提供一些修改或我的代码或完全不同的方法吗？我会很感激的。谢谢。

附带说明一下，任何人都可以在评论中发布一种将 Eclipse 中的代码粘贴到此处并正确格式化的好方法吗？我使用了代码按钮，但缩进仍然不正确，您可能已经注意到了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:41:06.963

我建议你使用 netty 框架。因为它已经有处理这类问题的机制。看看[这个](http://netty.io/4.0/guide/#start.pojo)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-02T22:57:25.213

您需要将连接视为字节流。TCP 中没有数据包这样的东西。服务器可能会向您发送 100 个字节，然后是 500 个字节，但它可能会一起到达接收器，一次一个字节，或者介于两者之间。因此，如果您的协议中有不同的消息，第一个要求是您能够自己拆分它们，就好像您是从文件而不是套接字中读取它们一样。在您将其构建到您的协议中之前，问题是无法解决的。

# angularjs - AngularJS：（ng-）隐藏一个元素但不隐藏它的孩子

> ID：15770330
> 
> 赞同：2
> 
> 时间：2013-04-02T17:23:09.080
> 
> 标签：angularjs

如何创建一个类似 ng-show 的指令来隐藏元素但不隐藏子元素？

我在想`url`变量是否存在角度模板

```
<a ng-show-link="url" ng-href="{{url}}">
  <img ng-src="picture.png" />
</a> 
```

会打印出来

```
<a href="/url">
  <img src="picture.png" />
</a> 
```

, 如果`url`不存在

```
<img src="picture.png" /> 
```

. 与 ng-repeat 一起使用时，将有助于减少额外的容器元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T19:17:00.580

我认为有一个标签会更容易，然后如果存在 url `<img>`，则编写一个指令用标签*包装*它。`<a>`添加/包装比删除现有标签更干净。

尽管您认为有一点冗余，但您也可以在没有指令的情况下执行此操作：

```
<a ng-show="url" ng-href="{{url}}"><img src="picture.png" /></a>
<img ng-hide="url" src="picture.png" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T19:02:22.793

创建一个自定义指令并将其应用于`<a>`标签并在属性中传递 url。如果未定义 url，请使用 JQuery dom 操作来删除`<a>`并保留`<img>`在它的位置。

尽管仅禁用链接或`javascript:;`在其位置使用要简单得多。试图删除`<a>`是一种过早的优化。

# javascript - Javascript日期夏令时问题

> ID：15770331
> 
> 赞同：0
> 
> 时间：2013-04-02T17:23:14.230
> 
> 标签：javascript, dst

我在处理日期时遇到了javascript中的夏令时问题。相关国家是英国。

早些时候，在 3 月 31 日之前，以下代码给出了准确的日期：

```
var caseClosed = new Date(now.getUTCFullYear(), now.getUTCMonth(), 
now.getUTCDate(), now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds()); 
```

所以，当我用它来区分两个日期时，上面代码检索到的日期和另一个日期（来自根据系统日期时间存储正确日期的旧系统），我得到了一个正确的正值。

但是在那之后，比如说今天，每当我使用上面的代码时，我都会少一个小时；这导致两个日期之间出现负值。

比如说，如果时间是 18:06，我通过使用上面的代码得到 17:06。所以我尝试使用以下代码，它现在给了我正确的时间：

```
var caseClosed = new Date(now.getFullYear(), now.getMonth(), 
now.getDate(), now.getHours(), now.getMinutes(), now.getSeconds()); 
```

任何人都可以解释发生了什么，如果上面的代码（不使用 UTC 的东西）即使在不给额外的一小时（60 分钟）的情况下关闭夏令时也能工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:27:26.563

好吧，UTC日期与系统日期不同。虽然系统日期受日光变化的影响，但 UTC 不受...注意，如果您希望使用此值在服务器上存储任何内容，则应使用服务器时间，而不是客户端时间...

# hibernate - 休眠错误 - 已经有关联的托管连接

> ID：15770333
> 
> 赞同：0
> 
> 时间：2013-04-02T17:23:37.920
> 
> 标签：hibernate, tomcat, transactions

我随机收到这个休眠错误，我无法重现它。

已有关联的托管连接

和堆栈跟踪如下...

```
INFO   | jvm 1    | 2013/03/31 18:16:20 | org.hibernate.TransactionException: Transaction not successfully started
INFO   | jvm 1    | 2013/03/31 18:16:20 |       at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:170)
INFO   | jvm 1    | 2013/03/31 18:16:20 |       at com.xxx.sss.helpers.HibernateUtil.getObjectsByCriteria(HibernateUtil.java:54) 
```

我的选择器方法是这样的：

```
public static ArrayList<?> getObjectsByCriteria(String sqlQuery, List<Object> params, int firstResult, int maxSize)
{
    ArrayList<Object> result = null;
    try
    {
        SessionFactoryHelper.getSessionFactory().getCurrentSession().getTransaction().begin();
        Query q =  SessionFactoryHelper.getSessionFactory().getCurrentSession().createQuery(sqlQuery);

        if(params != null)
        {
            for (int i = 0; i < params.size(); i++)
            {
                q.setParameter(i, params.get(i));
            }
        }
        if(firstResult != -1 && maxSize != -1)
        {
            q.setFirstResult(firstResult);
            q.setMaxResults(maxSize);
        }
        q.setReadOnly(true);

        result = (ArrayList<Object>) q.list();

    }
    catch(HibernateException ex)
    {
        logger.log(Level.SEVERE, ex.getMessage());
        logQueryAndParams(sqlQuery, params);

    }
    catch(Exception ex)
    {
        logger.log(Level.SEVERE, ex.getMessage());
        logQueryAndParams(sqlQuery, params);

    }
    finally
    {
        if(!SessionFactoryHelper.getSessionFactory().getCurrentSession().getTransaction().wasCommitted())
            SessionFactoryHelper.getSessionFactory().getCurrentSession().getTransaction().commit();
    }
    return result;  
} 
```

知道为什么我会得到这个吗？我用谷歌搜索了它，但很少有回应。我没有直接使用 Tomcat/Hibernate 的 Spring。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T21:35:55.020

我注意到，如果发生错误（在`catch`块内），您永远不会回滚事务。我不确定这是否是您的问题的原因。此外，处理事务的通常方法是在块的末尾而`try`不是在块中进行提交，因为如果出现错误`finally`，您不想调用。[这是一个例子](http://www.mkyong.com/hibernate/hibernate-transaction-handle-example/)。`commit`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:41:22.037

一方面，Hibernate 的 Session 类有两个非常重要但又截然不同的方法。一种是`session.createQuery()` createQuery() 方法使用映射到数据库表的 Java 对象在数据库上执行 HQL（Hibernate 查询语言）语句。

但是，在上面的方法中查看你的参数名称，似乎你正在执行一个 SQL 查询；不是 HQL 查询。因此，必须使用 Session 类提供的替代方法：

```
session.createSQLQuery() 
```

因此，如果您在数据库上执行 SQL 查询，而不是 HQL 查询，那么您的代码将如下所示：

```
Query q =  SessionFactoryHelper.getSessionFactory().getCurrentSession().createSQLQuery(sqlQuery); 
```

希望这会有所作为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-25T08:23:38.863

此错误意味着您的 JDBC 连接上已经有一个正在运行的事务问题可能是由于您可能正在使用的 @PersistenceContext 注释

替换 @PersistenceContext(type = PersistenceContextType.EXTENDED)

使用 @PersistenceContext(type = PersistenceContextType.TRANSACTION) 或 @PersistenceContext

# php - 使用 MySQL 数据库 PHP 中的计数填充列表

> ID：15770336
> 
> 赞同：0
> 
> 时间：2013-04-02T17:23:42.173
> 
> 标签：php, mysql, filtering

我正在尝试根据从 MySQL 数据库中的列中使用通配符选择的结果创建一个列表。我能够做到，但它似乎很慢，而且可能是错误的方式。这是我现在正在修改的代码

```
$optarr = array("leather", "cruise", "tint", "sunroof", "moonroof", "navigation", "antilock");
 foreach ($optarr as $i) {
    $refquery = "SELECT stock, COUNT(stock) FROM vehicle_list AND options LIKE '%$i%'"; 
    $refresult = mysql_query($refquery) or die(mysql_error());
    $row = mysql_fetch_array($refresult);

    if ($row['COUNT(stock)'] != '0') {
    echo "".ucfirst($i)." (".$row['COUNT(stock)'].")<br />";
    }
} 
```

这将输出以下内容

```
Leather(234)
Cruise(343)
Tint(231)
Sunroof(343)
..... 
```

该列表最终将包含大约 20-30 个不同的过滤器选项，现在在 4-5 时，我可以看到相当长的延迟。我做错了什么，只是不知道是什么。也许整个方法？

数据库中的选项列是由 @ 符号分隔的整个文本块，因此我使用 Like 通配符来提取车辆选项。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:26:30.880

在 foreach 循环之前进行数据库调用。这是在每个循环上调用数据库，并且会像预期的那样慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:30:12.833

从规范化和优化的角度来看，您应该将您的选项放在一个单独的表中，然后使用一个表将 vehicle_list 表链接到您的选项。

这将允许您使用 join 和 group by 仅使用一个查询来获得所需的结果，而不是使用双面类似的查询负载（即使使用索引也不是一个好主意）。

[http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:30:29.333

你必须加入表格

```
 $optarr = array("leather", "cruise", "tint", "sunroof", "moonroof", "navigation", "antilock");
     foreach ($optarr as $i) {
    $refquery = "SELECT stock, COUNT(stock)  FROM vehicle_list 
    LEFT JOIN options ON vehicle_list.stock=options.stock LIKE '%$i%'"; 
    $refresult = mysql_query($refquery) or die(mysql_error());
    $row = mysql_fetch_array($refresult);

    if ($row['COUNT(stock)'] != '0') {
    echo "".ucfirst($i)." (".$row['COUNT(stock)'].")<br />";
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:31:06.183

似乎您正在为每次出现在`$optarr`

您可以尝试先创建条件列表，然后触发单个查询

就像是

```
$optarr = array("leather", "cruise", "tint", "sunroof", "moonroof", "navigation", "antilock");
 $strCondition = NULL;
 foreach ($optarr as $i) {
    $strCondition .= ( true == is_null(strCondition ) )? "LIKE '%$i%'" : "OR LIKE '%$i%'"; 
}

if( false != $strCondition ) {
    $refresult = mysql_query( 'SELECT stock, COUNT(stock) FROM vehicle_list AND options ' . $strCondition ) or die(mysql_error());
     while( $row = mysql_fetch_array($refresult) )
     {
         if ($row['COUNT(stock)'] != '0') {
         echo "".ucfirst($i)." (".$row['COUNT(stock)'].")<br />";
     }
} 
```

可能有一些`syntax errors`，因为我没有测试它：p。

上述方法会给出一个`performance gain`，一般来说，您应该以您希望检索它们的方式将值存储在表中（我建议添加一个新的列条件仅值，如'皮革'、巡航'..等）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-02T17:33:58.213

您可能应该规范化您的选项，以便它们位于与该表相关的`vehicle_list`表中。这将使您的生活更加轻松。

所以说你有一张`vehicle_options`这样的桌子

```
vehicle_option_id -> primary_key, autoincrement
vehicle_id -> foreign key to vehicle_list table
option -> text string describing option 
```

所有三个字段都需要一个索引。

然后，您可以从针对此表的单个查询中获取计数。在这种情况下，您甚至根本不需要查询 vehicle_list。

```
SELECT option, COUNT (vehicle_option_id) AS `option_count` FROM
vehicle_options
GROUP BY option 
```

为了进一步规范化，您甚至可以考虑使用另一个表选项，该选项实际上包含可用选项的描述，并使`vehicle_options`表简单充当多对多连接表。使用此架构，您的表将如下所示：

`vehicle_options`

```
vehicle_id -> foreign key to vehicle_list table
option_id -> foreign key to option table 
```

您将在两个字段中都有一个主键

`options`

```
option_id -> primary_key, autoincrement
option -> text string describing option 
```

如果您要将其用于分组/排序目的，您将需要一个索引选项

您的查询将如下所示：

```
SELECT o.option AS `option`, COUNT (vo.option_id) AS `option_count`
FROM vehicle_options AS vo
INNER JOIN options AS o
GROUP BY `option` 
```

# search-engine - 如何在 nutch 中合并两个 crawldb

> ID：15770337
> 
> 赞同：0
> 
> 时间：2013-04-02T17:23:43.243
> 
> 标签：search-engine, web-crawler, nutch

假设我有两台不同的机器正在使用 nutch 抓取两个不同的域。

现在我想将他们的 crawldb 合并为一个。我怎样才能做到这一点 ？

我在某处读到过 - 命令：

```
bin/nutch mergedb <crawldb1> <crawldb2> 
```

做我打算做的事？

此外，如果假设其中一个 crawldb 是由本地托管网站的站点生成的，即说 wikipedia 自己爬网并将其存储为 crawldb1

和其他一些网站可以说stackoverflow也做了同样的事情。

在这种情况下，我可以将这两个 crawldb 合并为一个，但它会修改这些以反映它们的实际 url 而不是相对的（我的意思是 url wrt 数据库的新位置）。

对不起，如果我在描述中不是很清楚。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T16:57:22.100

只有一种方法可以确定它是否有效，试一试。并首先阅读手册，您缺少合并的数据库参数。见[http://wiki.apache.org/nutch/bin/nutch%20mergedb](http://wiki.apache.org/nutch/bin/nutch%20mergedb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T14:05:07.247

可以合并两个db的所有url，在crawldb中总是完整存储的。Nutch 从不​​存储相对于任何东西的 URL。

您编写的命令会将 crawldb2 合并到 crawldb1

如果你想合并 crawldb localcrawldb 和 stackoverflowcrawldb

你写

bin/nutch crawldb mergecrawldb localcrawldb stackoverflowcrawldb

并且两个 crawldb 都将合并到 mergecrawldb 中。

# github - 在没有源分支的新计算机上工作 Octopress 博客？

> ID：15770341
> 
> 赞同：2
> 
> 时间：2013-04-02T17:24:08.993
> 
> 标签：github, jekyll, octopress

我最近更换了计算机，并且不小心删除了包含所有源（Markdown 文件等）的本地版本。不管我怎么想，这一切都在 Github 中（我使用 GitHub 页面），所以我可以从那里开始。但是，我进入了 Github 并且我的源分支不存在（很有可能我一开始就没有生成它！）。

因此，有没有一种快速的方法可以使用新的源分支进行发布，而不会丢失我以前的所有博客文章？或者我可以从 Master 重新生成降价吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T08:28:11.970

好的，所以我现在通过[编写一个脚本](https://gist.github.com/pezholio/5299018)来解决这个问题，该脚本会抓取生成的站点并重新创建帖子：

[https://gist.github.com/pezholio/5299018](https://gist.github.com/pezholio/5299018)

只需克隆您的 master 分支，克隆 Octopress 源（到不同的文件夹），将 gist 下载到您的源文件夹并运行如下：

`ruby import.rb {path}`

`{path}`（克隆的 github 页面主分支的完整路径在哪里）

你还需要整理你的设置和主题，但你自己在那里！

# ios - 如何向 UIApplication 上的类别添加/删除通知的侦听器

> ID：15770348
> 
> 赞同：1
> 
> 时间：2013-04-02T17:24:21.797
> 
> 标签：ios, objective-c

我已经向 UIApplication 添加了一个类别，我想让它监听通知。

如果是我的课，我可以在 init/dealloc 中做到这一点。但作为内置类的一个类别，最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:32:03.163

您可以从应用程序中的任何位置访问共享的 UIApplication ，`[UIApplication sharedApplication]`因此如果您想让它侦听通知，您可以在（例如）`application:didFinishLaunchingWithOptions:`应用程序委托的方法中以通常的方式进行操作：

```
[[NSNotificationCenter defaultCenter] addObserver:[UIApplication sharedApplication] selector:@selector(yourCategoryMethod:) name:@"WhateverNotificationName" object:WhateverObject]; 
```

（您也可以使用作为参数传递的应用程序，`application:didFinishLaunchingWithOptions:`而不是在`[UIApplication sharedApplication]`此处进行通知设置。这两个对象肯定是相同的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:48:24.580

第 1 步：创建一个方法来处理通知事件

```
-(void)myObserver
{
    // some action here
} 
```

第 2 步：在您的 viewDidLoad 方法中创建一个观察者并将其注册到您的 ViewController 类以获取某些操作的通知

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(myObserver) name:@"YourObserverKey" object:nil]; 
```

第 3 步：发布/触发通知，以便所有的Listners 都能收到通知

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"YourObserverKey" object:nil]; 
```

第 4 步：千万不要错过，在离开 ViewController 时移除您的观察者，否则可能导致应用程序崩溃。通常在 viewDidUnLoad 方法中。

```
[[NSNotificationCenter defaultCenter] removeObserver:self forKeyPath:@"YourObserverKey"]; 
```

# java - 如何解决这个 Gradle 构建错误 - 找不到注释？

> ID：15770349
> 
> 赞同：1
> 
> 时间：2013-04-02T17:24:30.507
> 
> 标签：java, build, annotations, gradle

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<parent>
    <groupId>org.atmosphere.samples</groupId>
    <artifactId>atmosphere-samples</artifactId>
    <version>1.1.0-SNAPSHOT</version>
</parent>
<modelVersion>4.0.0</modelVersion>
<groupId>org.atmosphere.samples</groupId>
<artifactId>atmosphere-atmospherehandler-pubsub2</artifactId>
<packaging>war</packaging>
<version>1.1.0-SNAPSHOT</version>
<name>atmosphere-atmospherehandler-pubsub2</name>
<url>http://maven.apache.org</url>

<dependencies>
    <dependency>
        <groupId>org.atmosphere</groupId>
        <artifactId>atmosphere-jquery</artifactId>
        <version>${project.version}</version>
        <type>war</type>
    </dependency>
    <dependency>
        <groupId>org.atmosphere</groupId>
        <artifactId>atmosphere-runtime</artifactId>
        <version>${project.version}</version>
    </dependency>
    <dependency>
        <groupId>org.apache.geronimo.specs</groupId>
        <artifactId>geronimo-servlet_3.0_spec</artifactId>
    </dependency>

    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>${logback-version}</version>
    </dependency>

    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-core</artifactId>
        <version>${logback-version}</version>
    </dependency>

    <!-- This is ONLY required if you use Atmosphere's annotation. If you use atmosphere.xml, not required -->
    <dependency>
        <groupId>eu.infomas</groupId>
        <artifactId>annotation-detector</artifactId>
        <version>3.0.0</version>
    </dependency>
</dependencies> 
```

```
apply plugin: 'war'
apply plugin: 'jetty'

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'org.atmosphere', name: 'atmosphere-runtime', version: '1.0.12'
    compile group: 'org.atmosphere', name: 'atmosphere-jquery', version: '1.0.12'
    compile group: 'ch.qos.logback', name: 'logback-core', version: '1.0.7'
    compile group: 'ch.qos.logback', name: 'logback-classic', version: '1.0.6'
    compile group: 'eu.infomas', name: 'annotation-detector', version: '3.0.0'
    compile group: 'org.apache.geronimo.specs', name: 'geronimo-servlet_3.0_spec',   version: '1.0'
}

httpPort = 8085
stopPort = 9451
stopKey = 'monkey' 
```

以上是 Atmosphere Web 套接字示例程序的 maven pom.xml（可在[https://github.com/Atmosphere/atmosphere/tree/master/samples](https://github.com/Atmosphere/atmosphere/tree/master/samples)获得）。我正在尝试将 maven 构建转换为 Gradle，但注释出现错误。

```
:compileJava
/home/shawn/dev/web/atmosphere/samples/jquery-atmospherehandler-pubsub2/src/main/java/org/atmosphere/samples/pubsub2/AtmosphereHandlerPubSub.java:18: error: cannot find symbol
import org.atmosphere.config.service.Get;
                                    ^
  symbol:   class Get
  location: package org.atmosphere.config.service
/home/shawn/dev/web/atmosphere/samples/jquery-atmospherehandler-pubsub2/src/main/java/org/atmosphere/samples/pubsub2/AtmosphereHandlerPubSub.java:19: error: cannot find symbol
import org.atmosphere.config.service.ManagedService;
                                    ^
  symbol:   class ManagedService
  location: package org.atmosphere.config.service
/home/shawn/dev/web/atmosphere/samples/jquery-atmospherehandler-pubsub2/src/main/java/org/atmosphere/samples/pubsub2/AtmosphereHandlerPubSub.java:20: error: cannot find symbol
import org.atmosphere.config.service.Message;
                                    ^
  symbol:   class Message
  location: package org.atmosphere.config.service
/home/shawn/dev/web/atmosphere/samples/jquery-atmospherehandler-pubsub2/src/main/java/org/atmosphere/samples/pubsub2/AtmosphereHandlerPubSub.java:36: error: cannot find symbol
@ManagedService(path = "/")
 ^
  symbol: class ManagedService
/home/shawn/dev/web/atmosphere/samples/jquery-atmospherehandler-pubsub2/src/main/java/org/atmosphere/samples/pubsub2/AtmosphereHandlerPubSub.java:39: error: cannot find symbol
    @Get
     ^
  symbol:   class Get
  location: class AtmosphereHandlerPubSub
/home/shawn/dev/web/atmosphere/samples/jquery-atmospherehandler-pubsub2/src/main/java/org/atmosphere/samples/pubsub2/AtmosphereHandlerPubSub.java:44: error: cannot find symbol
    @Message
     ^
  symbol:   class Message
  location: class AtmosphereHandlerPubSub
6 errors
:compileJava FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':compileJava'.
> Compilation failed; see the compiler error output for details.

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

BUILD FAILED

Total time: 5.821 secs 
```

上面的错误和下面的来源......

```
package org.atmosphere.samples.pubsub2;

import org.atmosphere.config.service.Get;
import org.atmosphere.config.service.ManagedService;
import org.atmosphere.config.service.Message;
import org.atmosphere.cpr.AtmosphereResource;
import org.atmosphere.cpr.Broadcaster;
import org.atmosphere.cpr.BroadcasterFactory;

import java.io.IOException;

@ManagedService(path = "/")
public class AtmosphereHandlerPubSub  {

    @Get
    public void onRequest(AtmosphereResource r) throws IOException {
        r.setBroadcaster(lookupBroadcaster(r.getRequest().getPathInfo()));
    }

    @Message
    public String onMessage(String message) throws IOException {
        if (message != null && message.indexOf("message") != -1) {
            return (message.substring("message=".length()));
        } else {
            return "=error=";
        }
    }

    Broadcaster lookupBroadcaster(String pathInfo) {
        String[] decodedPath = pathInfo.split("/");
        Broadcaster b = BroadcasterFactory.getDefault().lookup(decodedPath[decodedPath.length - 1], true);
        return b;
    }

} 
```

我确定这是一个菜鸟问题，但我找不到答案。

编辑：似乎 pom.xml 的“父”部分是问题所在，那里有更多的依赖项。我仍然找不到我需要解决这个问题的那个。

# css - 嵌入 Vimeo 的 CSS3 列 = 空白

> ID：15770355
> 
> 赞同：1
> 
> 时间：2013-04-02T17:24:57.627
> 
> 标签：css, iframe, embed, vimeo, multiple-columns

如果我设置了一个使用 CSS3 列的布局，并尝试在该布局中嵌入一个 Vimeo iframe，它会显示为一个黑框。

这是一个小提琴来说明我的意思：http: [//jsfiddle.net/tMyfa/](http://jsfiddle.net/tMyfa/)

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>demo</title>
<link rel="stylesheet" type="text/css" href="/css/result-light.css">  
<style type='text/css'>
body {
-webkit-column-count: 3;
-webkit-column-gap: 2em;
}
</style>
</head>
<body>
<body>
<p>Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus. Mauris iaculis porttitor posuere. Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam.<p>
<p>Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus. Mauris iaculis porttitor posuere. Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam.<p>
<p>Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus. Mauris iaculis porttitor posuere. Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam.<p>
<p>Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus. Mauris iaculis porttitor posuere. Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam.<p>
<p><iframe src="http://player.vimeo.com/video/4716148" width="300" height="169" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></p>
<p>Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus. Mauris iaculis porttitor posuere. Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam.<p>  
</body>
</html> 
```

如果将列数设置为 1，问题就会消失。

有人对这个问题有任何见解吗？

这是一个更新的小提琴以更好地显示问题：http: [//jsfiddle.net/t7AP7/](http://jsfiddle.net/t7AP7/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T20:09:05.313

消除

```
.post_content iframe {
   width: 100% !important;
   height: 200px !important;
} 
```

并尝试像这样设置 iframe 的宽度：

```
 <iframe src="http://player.vimeo.com/video/62257681" 
    width="250" height="150" frameborder="0" 
    webkitallowfullscreen mozallowfullscreen allowfullscreen>
    </iframe> 
```

# javascript - 我如何根据请求编译翡翠，而不仅仅是服务器启动？

> ID：15770361
> 
> 赞同：0
> 
> 时间：2013-04-02T17:25:20.277
> 
> 标签：javascript, node.js, pug

我希望在服务器请求/响应上编译我的翡翠，这样我就可以对翡翠文件进行更改并实时查看它，而不必每次都重新启动服务器。这是我到目前为止的假模型。

```
var http = require('http')
  , jade = require('jade')
  , path = __dirname + '/index.jade'
  , str  = require('fs').readFileSync(path, 'utf8');

    function onRequest(req, res) {
        req({
            var fn   = jade.compile(str, { filename: path, pretty: true});
        });
        res.writeHead(200, {
            "Content-Type": "text/html"
        });

        res.write(fn());
        res.end();
    }

http.createServer(onRequest).listen(4000);
console.log('Server started.'); 
```

我希望我说清楚了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:27:38.260

您只在服务器启动时读取文件一次。如果您想让它读取更改，则必须根据要求阅读它，这意味着您的模型看起来更像：

```
function onRequest(req, res) {
    res.writeHead(200, {
        "Content-Type": "text/html"
    });

    fs.readFile(path, 'utf8', function (err, str) {
        var fn = jade.compile(str, { filename: path, pretty: true});
        res.write(fn());
        res.end();
    });
} 
```

这样的东西每次都会读取文件，这对于开发目的来说可能是可以的，但是如果你*只想*在发生变化时重新加载/处理文件，你可能会使用文件观察器（`fs.watch`可能适合这个账单）。

像这样的东西（只是一个未经测试的例子作为一个想法）：

```
var fn;

// Clear the fn when the file is changed
// (I don't have much experience with `watch`, so you might want to 
// respond differently depending on the event triggered)
fs.watch(path, function (event) {
    fn = null;
});

function onRequest(req, res) {
    res.writeHead(200, {
        "Content-Type": "text/html"
    });

    var end = function (tmpl) {
      res.write(tmpl());
      res.end();
    };

    if (fn) return end(fn);

    fs.readFile(path, 'utf8', function (err, str) {
        fn = jade.compile(str, { filename: path, pretty: true});
        end(fn);
    });
} 
```

# ios - 如何实现只为未经身份验证的用户显示的 iOS 登录屏幕

> ID：15770362
> 
> 赞同：3
> 
> 时间：2013-04-02T17:25:21.770
> 
> 标签：ios, objective-c

我知道这个问题有点开放，但我试图让它尽可能具体，因为我真的不知道 iOS 的这种类型的事情的标准约定是什么。我一直在考虑在我的应用程序上实现登录屏幕，但是我无法找出最佳方法。我在下面列出了三种方法，有人可以告诉我其中一种方法更好或更正确吗？（或者如果有什么我完全错过了）。

第一种方法 - 我最初有一个导航控制器作为我的根控制器，登录屏幕是堆栈上的第一个视图。然后当用户登录时，我只是将主 UI 推送到堆栈。然后，用户可以使用后退按钮返回登录屏幕。我知道这种技术有效，但是当重新启动应用程序时，用户不需要再次登录。我不确定我是否应该以相同的方式设置堆栈（首先登录页面）然后将主 UI 推到顶部？这是一种常见的技术吗？

下一种方法，我在这里找到了如何替换根控制器[如何从 CustomViewController 中更改 RootViewController（在 AppDelegate 中）？](https://stackoverflow.com/questions/6675730/how-to-change-rootviewcontroller-in-appdelegate-from-within-customviewcontroll)我更喜欢这个想法，我可以在登录后摆脱登录屏幕并添加某种类型的按钮以使其在注销时重新出现。然后在重新启动期间，我可以完全跳过添加登录屏幕。

第三种方法可能是在主 UI 之上覆盖登录，但我还没有找到任何代码来执行此操作。这似乎也有点奇怪，因为我的主 UI 可能会开始触发我不希望在登录后发生的消息，所以我必须考虑到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:49:06.290

我建议你有一个带有空白视图的根视图控制器。此控制器在 AppDelegate 的 applicationDidFinishLaunching: 方法中设置为根视图控制器。

这个根视图控制器的作用是最初通过登录视图控制器显示登录屏幕。登录视图控制器在成功登录后委托给根视图控制器以从根视图和根视图控制器中删除自己，然后设置要显示的下一个控制器。

这样，您可以在通过根视图控制器显示主视图之前管理多个视图（如果有的话）。

在根视图之上显示登录视图有多种方式。

1）呈现一个没有动画的登录视图控制器。

2) 在根视图之上添加登录视图作为子视图 [注意：在 iOS 5 之前，您不会获得旋转和视图生命周期回调，您应该编写自己的代码将回调传递给顶部添加的视图的根视图。从 iOS 5 开始，您可以使用视图包含概念来维护父子关系。]

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:40:59.627

我们有一个类似的应用程序。我们的故事板看起来有点像一个轮子。

我们有一个导航控制器作为我们的根控制器，然后它转到一个带有微调器的视图控制器。该控制器处理调用以查看用户是否已登录。它连接到两个不同的控制器。

如果他们已经登录，它会转到主视图控制器。如果他们还没有登录，它会转到登录视图控制器。登录视图控制器将在成功时返回初始视图控制器，并且由于它们随后将被登录，它会转到主控制器。

为了回退，我们一直回到带有微调器的初始视图控制器。

您可以在主视图之前隐藏每个视图上的导航栏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-25T18:13:52.650

我们所有的 ViewController 都是从 uiviewcontroller 的自定义子类继承而来的。这使我们能够对行为、约束、......

如果用户未登录，我们的超级视图控制器类通过在 viewWillAppear 上调用模态视图来处理身份验证。它的作用就像处理断开连接和从应用程序中的任何点恢复一样的魅力。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-14T12:11:06.523

我总是用故事板来实现它。只需将**Storyboard ID**添加到您的登录视图控制器，例如*Onboarding*。

然后在里面写这样的东西`application: didFinishLaunchingWithOptions:`

```
if (![[NSUserDefaults standardUserDefaults] objectForKey:TRAIN_COMPLETE]) {
    UIStoryboard* storyboard = [UIStoryboard storyboardWithName:@"Main" bundle:nil];
    self.window.rootViewController = [storyboard instantiateViewControllerWithIdentifier:@"Onboarding"];
} 
```

# php - $_GET 不反序列化/从选中的复选框中获取值

> ID：15770363
> 
> 赞同：3
> 
> 时间：2013-04-02T17:25:24.540
> 
> 标签：php, javascript, get

我没有太多经验`$_GET`。我尝试总是使用 POST 方法，所以我可能会遗漏一些明显的东西。

我正在使用一个插件，它通过 GET 方法向服务器发送一个请求，其值是用 jQuery`serialize()`从表单中完成的序列化表单。

通常，至少在使用 时`$_POST`，该值可以很容易地分配给接收 PHP 文件中的工作变量。据我所知，这并没有发生。

它保持其序列化表示。当我尝试使用 反序列化它时`$array = unserialize($string)`，它`bool(false)`返回了。

接收端的 A`var_dump($_GET)`举个例子：

```
array(2) {
  ["hook"]=>
  string(15) "hook%5B2%5D=107"
  ["_"]=>
  string(13) "1364920519074" //This is a serial no. generated by the plugin
} 
```

在类似情况下， A`var_dump($_POST)`将直接显示值“107”，这正是我要寻找的。

我感谢您的帮助。

这是Javascript：

```
$(document).ready(function () {
  var str;
  oTable = $("#myTable").dataTable({
    "fnServerParams": function (aoData) {
      aoData.push({
        name: 'hook',
        value: str
      });
    },
  });
  $("#filter").change(function () {
    str = $("#filter").serialize();
    oTable.fnReloadAjax("filter_prange.php");
  });
}); 
```

为了将来参考，我在 Scones 的评论后展示了修改后的脚本。因此解决方案是返回原始 php 文件并更改检索值的方式。从表单中获取值的方法从serialize()更改为适应插件，它只能处理硬数字。所以这实际上显示了从选中的复选框中检索值的两种不同方式。我相应地修改了标题。

```
<script>
$(document).ready(function() {
    var str = [];
        oTable = $("#myTable").dataTable({
    "fnServerParams": function (aoData) {
        aoData.push({ name:'str', value:str });}
});

$("#filter").change(function(){
str=[];
 $('#filter :checked').each(function() {
   str.push($(this).val());
 });
oTable.fnReloadAjax("filter_prange.php");
 }); 
```

});

这是触发这一切的形式：

```
 <form id = "filter">
<input class="hook1" type="checkbox" value="115" name="hook[0]">  
<input class="hook1" type="checkbox" value="116" name="hook[1]"> 
<input class="hook1" type="checkbox" value="107" name="hook[2]">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:17:42.723

答案涉及错误的假设。隐含的假设：“javascript 已正确发送到 php”是错误的。

PHP 接收字符串 "?hook=hook%2b2%2d=107&_=1364920519074" 并将其转换为上面显示的数组。

有2个问题浮现在脑海：

*   为什么使用自定义发送方法而不是预定义的发送方法`$.ajax()`？您是否使用其他框架进行数据传输？
*   `str`提供的javascript中的真实内容是什么`aoData.push({name : 'hook', value : str });},`

如果没有关于函数`dataTable`和生成的 html 的更多内容，就没有更多关于这个问题的内容了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:41:59.007

```
/**
 * Temp fix to get value. Try serializing the contents of the variable, and not the 
 * variable itself.
 */
if (preg_match('/\=(.*)/', $_GET["hook"], $match))
{
  $val = $match[1];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T20:41:31.470

我建议您编写自己的序列化方法来永远解决问题。但是我有一个问题，你有没有发现这个序列化 id 是从哪里以及为什么为复选框生成的？我猜这种行为不是 JQuery 的一部分（参见：[http](http://api.jquery.com/serialize/) ://api.jquery.com/serialize/ ）。

# javascript - 使用统一数组设置批处理顶点数组的 Alpha

> ID：15770366
> 
> 赞同：0
> 
> 时间：2013-04-02T17:25:46.787
> 
> 标签：javascript, canvas, 2d, glsl, webgl

我正在使用 WebGL 创建一个 2D 渲染引擎，其中我使用纹理图集并一次批处理数百个实体。我需要为每个实体设置一个唯一的 alpha 值，我不知道如何做到这一点。

我当前的片段着色器是这样的：

```
 precision mediump float;

    uniform float u_alpha;
    uniform sampler2D u_image;

    varying vec2 v_texCoord;

    void main () {
        vec4 texture = texture2D(u_image, v_texCoord);
        gl_FragColor = vec4(texture.rgb, texture.a * u_alpha);
    } 
```

我想将该全局统一更改为统一缓冲区或将应用于 v_texCoord 的唯一值数组，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T17:38:24.250

您需要将这些值作为属性传递，就像`v_texCoord`.

在顶点着色器中

```
attribute float a_alpha;
varying float v_alpha;
...
void main() {
   ...
   v_alpha = a_alpha;  // pass the alpha values to the fragment shader.
   ...
} 
```

在片段着色器中

```
varying float v_alpha;
...
gl_FragColor = vec4(texture.rgb, texture.a * v_alpha); 
```

除了使用单独的属性，您还可以让您的纹理坐标具有 3 个值。u、v 和 alpha。换句话说，更改`v_texCoord`为`vec3`. 更新顶点着色器中的属性以获取`vec3`. 更新您的 UV 数据，以便每个 UV 也有一个 alpha。将您的片段着色器更改为。

```
varying vec3 v_texCoord;

void main () {
    vec4 texture = texture2D(u_image, v_texCoord.xy);
    gl_FragColor = vec4(texture.rgb, texture.a * v_texCoord.z);
} 
```

# vb.net - 如何仅读取从 VB.Net 中的网站获取的文本的第二行

> ID：15770368
> 
> 赞同：0
> 
> 时间：2013-04-02T17:25:55.527
> 
> 标签：vb.net

我正在使用我的 vb.net 应用程序从网站获取 3 行文本，并且我只想在按下按钮时在我的标签中显示第二行。我目前拥有的代码向我展示了所有 3 行。我怎样才能只显示第二行。

```
Dim webAddress As String = "Website"

    Dim reader As StreamReader
    Dim request As WebRequest
    Dim response As WebResponse
    Dim data As String = ""

    Try
        request = WebRequest.Create(webAddress)
        request.Timeout = 30000
        response = request.GetResponse()
        reader = New StreamReader(response.GetResponseStream())
        data = reader.ReadToEnd
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:31:28.820

您可以在 ReadToEnd 之后执行此操作：

```
Label1.Text = Split(data, VBCrLf)(1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:32:46.490

阅读单行：

```
reader.ReadLine() 'read and discard the first line
data = reader.ReadLine() 'read the line you want
reader.ReadToEnd 'read and discard the rest 
```

# html - 具有最大高度的流体人像图像

> ID：15770374
> 
> 赞同：0
> 
> 时间：2013-04-02T17:26:16.523
> 
> 标签：html, css, responsive-design, fluid-layout

使用最大高度时，我遇到了流体图像的一些问题。我正在尝试将图像绑定在一个最多为 450x450 的盒子或任何与图像的纵横比不同的任意盒子中。发生的事情是图像的宽度被限制为 450px，但高度不是，并且图像溢出了包装器 div。

我的代码是：

```
<div class="wrapper">
    <div class="container">
        <img src="http://i.imgur.com/iw4yOa0.jpg"/>
    </div>
</div> 
```

有关完整代码和 css，请参阅[http://jsfiddle.net/5fuZ5/](http://jsfiddle.net/5fuZ5/)。

我知道我可以通过使用 jquery 来实现这一点，但我需要一个不需要 javascript 的响应式解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:29:20.660

好的，我遇到了类似的问题，找不到任何帮助。我的情况是，我有一列流动的图像（适合其容器 100% 的宽度）适用于横向图像，但肖像是巨大的，因为它的宽度适合，因此又高又瘦的图像（肖像）有它宽度适合容器，因此使其非常高。

我的解决方案是考虑容器，如果在纵向图像的实例中我将容器设置为横向容器的 50%，那么当我将图像宽度（纵向时）适合较小的容器时，我会得到它们的比例（ish ）。

因此，您想要使用 2 个容器，一个用于纵向和横向，横向一个将是您想要的最大宽度，即 450 像素。现在将您的肖像容器设置为宽度的一半，即 225px（宽度的一半），如果您的所有图像都具有相同的纵横比，那么它们应该都很好地匹配并为您提供结构化的网格 - 或者如果单列肖像图像将或多或少与风景图像一样高。

如果你想看到这个工作（短时间内）我会留下这个链接，这样你就可以看到我是如何解决它的。这个例子是我正在制作的一封电子邮件（请不要抱怨糟糕的编码，它没有完成）模板，我在其中有一列图像（它的响应式），包括纵向和横向 - 使用表格上包含的类肖像图像（class=portrait），但这很容易成为一个 div。

[http://www.sink140.com/sf-test/single.html](http://www.sink140.com/sf-test/single.html)

我的主要观点是停止考虑试图控制高度，只需控制容器，让图像填充它，通过调整容器的宽度（使其更小）你自然会降低图像的高度。

一般来说，图像的纵横比将确保您可以预测布局，因为您有各种基线 - 纵向图像与横向图像相关。

希望这有助于或至少给你另一个想法。

# maven - 哪个antlr4-runtime？

> ID：15770380
> 
> 赞同：1
> 
> 时间：2013-04-02T17:26:25.513
> 
> 标签：maven, antlr4

我正在尝试在 Eclipse 中添加依赖**antlr4-runtime**。它显示了两个可供选择的实例。

1.  com.tunnelvisionlabs::antlr4-runtime (324566 b)
2.  org.antlr::antlr4-runtime (242694 b)

这些文件大小不同。

我应该使用哪一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:47:33.720

[The Definitive ANTLR 4 Reference](http://pragprog.com/book/tpantlr2/the-definitive-antlr-4-reference) book with JavaDocs[发布在 antlr.org](http://antlr.org/api/Java/index.html)中描述的参考运行时是**org.antlr::antlr4-runtime**。

另一个版本是一个高度实验性的分支，它针对 Tunnel Vision Labs 的 IDE 产品进行了高度优化。此版本在许多方面与文档版本有所不同，因此如果遇到问题，您可能需要靠自己。

# extjs - Extjs 3 - 带有复选框的网格分组

> ID：15770381
> 
> 赞同：2
> 
> 时间：2013-04-02T17:26:26.743
> 
> 标签：extjs, extjs3, extjs2

我有一个配置了**GroupingStore**、**GroupingView**和**CheckColumn**的网格，它使用 extjs 3 显示分组数据。我在网格中显示的数据是学生列表作为行和主题作为标题。我会将属于每个部分的所有学生分组并显示在每个组下。网格中的每个单元格都是一个复选框（使用 Ext.grid.CheckColumn），如果用户传入该主题，则将对其进行检查，否则未选中。管理员必须选中/取消选中所有框并根据学生的分数生成报告。我想在每个主题的组标题中提供一个额外的复选框，以便如果管理员检查该单元格，该列（在该组中）下的所有复选框将被自动检查。我的 qns 似乎类似于[extjs 分组网格的组头复选框](https://stackoverflow.com/questions/4246940/checkbox-for-group-header-of-extjs-grouping-grid)。它只讨论每个组的 1 个复选框，而不是一个组的多个复选框（即每列一个）....有什么想法吗？？？

# macos - 在 Mac 浏览器上控制“脱离顶部”滚动的内容？

> ID：15770383
> 
> 赞同：1
> 
> 时间：2013-04-02T17:26:32.157
> 
> 标签：macos, webkit

在基于 Webkit 的 Mac 浏览器的页面“下方”是否可以控制内容的内容（通常是灰色亚麻布）？

![滚动区域示例](https://i.stack.imgur.com/x7TsE.png)

例如，我想在页面“顶部上方”扩展我的页面上的图像，以便从顶部滚动的 Mac 用户可以看到一些额外的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T09:57:56.103

这在基于 WebKit 的浏览器中目前是不可能的。悬垂区域的亚麻纹理无法以任何方式配置。

# java - 使用 REST 的 neo4j java API 快速示例

> ID：15770384
> 
> 赞同：2
> 
> 时间：2013-04-02T17:26:34.373
> 
> 标签：java, api, rest, neo4j

我正在尝试从 github 获取项目。
可以在这里找到：[https ://github.com/neo4j/java-rest-binding](https://github.com/neo4j/java-rest-binding)

有没有人已经把它放入 JAR 中？我要连接到本地 neo4j 商店。任何其他建议将不胜感激。我只想能够快速访问节点零。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:54:24.143

你可以在 Neo4j 的 maven repo 中找到它们：

[http://m2.neo4j.org/content/repositories/releases/org/neo4j/neo4j-rest-graphdb/](http://m2.neo4j.org/content/repositories/releases/org/neo4j/neo4j-rest-graphdb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T10:36:12.173

作为 Axel 答案的补充，这里有一个很好的可用教程，您可以在其中找到很多 Neo4J 使用的示例（核心 API、索引、遍历、Cypher 和 REST 交互）：[https ://github.com/jimwebber/neo4j-教程](https://github.com/jimwebber/neo4j-tutorial)。

特别是，[Koan11](https://github.com/jimwebber/neo4j-tutorial/blob/master/src/koan/java/org/neo4j/tutorial/Koan11.java)类演示了如何调用内置的 REST API，[Koan12](https://github.com/jimwebber/neo4j-tutorial/blob/master/src/koan/java/org/neo4j/tutorial/Koan12.java)显示了如何通过[*非托管扩展*](http://docs.neo4j.org/chunked/stable/server-unmanaged-extensions.html)滚动您自己的 API 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T13:54:49.783

我最近在这里发布了一个类似问题的答案。

> [Neo4j、REST API、java - 密码查询](https://stackoverflow.com/questions/21954850/neo4j-rest-api-java-cypher-queries/)

从那里您可以获取我的 pom.xml 和我的 java 文件作为您的快速示例。

此外，您可能会发现本教程很有帮助。

> [http://thought-bytes.blogspot.com/2013/07/getting-started-with-neo4j-java-rest-heroku.html](http://thought-bytes.blogspot.com/2013/07/getting-started-with-neo4j-java-rest-heroku.html)

# c# - 我应该如何为应用程序实施 OAuth？

> ID：15770385
> 
> 赞同：13
> 
> 时间：2013-04-02T17:26:41.240
> 
> 标签：c#, asp.net, asp.net-mvc, oauth, oauth-2.0

我正在为需要执行以下操作的客户端创建应用程序：

*   允许用户使用 Google、Facebook、Twitter 和 LinkedIn 进行身份验证。
*   允许用户在注册后添加其他提供商。（即，如果用户通过 Google 进行了身份验证，那么他们也应该能够添加任何或所有其他提供商。）
*   允许用户导入 Google 联系人、Facebook 好友列表、Twitter 关注者和 Linkedin 好友，以构建自定义联系人列表。

开始学习这方面的最佳地点在哪里？.NET 中是否有每个人都使用这些东西的标准？我已经在谷歌上搜索了几个小时，虽然似乎大多数人都指向[DotNetOpenAuth](http://www.dotnetopenauth.net/) ，但我似乎找不到任何关于如何使用该库的可靠教程。下载带有示例，但它仍然让我感到困惑。

我认为它会很简单：

*   配置提供者的秘密。
*   使用提供商开始登录
*   使用 auth cookie 对用户进行身份验证
*   在我的数据库中创建用户记录并存储来自提供商的唯一 ID。

但似乎每个提供商都有自己的一组代码，而且这一切都如此不同和令人困惑。Facebook 有一些图形对象，twitter 有一些我不明白的“InMemoryTokenManager”，而谷歌甚至没有身份验证示例，只有一个谷歌地址簿示例。最重要的是，出于某种原因，您必须将示例中的一些 ApplicationBlock 演示中的一些代码复制到您自己的应用程序中，并且在不知道它到底要做什么的情况下编译所有代码是一项艰巨的任务。

我觉得我在这一切中缺少一些基本的东西。

在这一点上，即使是书籍推荐也会很棒。

我相信我了解 OAuth 的高级概念，但是一旦我尝试深入了解细节，我就会立即迷失方向。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T17:40:33.760

首先，如果您在 net 4.5 上使用外部库，其中默认的 asp.net 模板带有大多数提到的提供程序的身份验证代码，那么使用外部库确实没有意义。

其次，如果您仍然需要有关 oauth2 身份验证的一些详细信息的好教程，请查看 Ben Foster 的这篇精彩文章[http://ben.onfabrik.com/posts/oauth-providers](http://ben.onfabrik.com/posts/oauth-providers)

第三，不幸的是，如果您需要身份验证以外的任何其他内容，则没有单一协议。因此，每个提供者都有自己的方式来公开这些额外的数据——联系人、帖子等。你不能做太多事情，它与 oauth2 无关，而只是一种调用特定 api 的方式，这种方式通常是偶然的暴露为基于 oauth2 身份验证的 rest/xml Web 服务。这意味着如果您只进行身份验证，则每个提供商的协议基本相同。任何更多的都是具体的。

第四，我会坚持使用提供商返回的电子邮件地址，而不是内部 ID。并非所有提供商都支持该 ID，而所有提供商都可以返回用户电子邮件。您可以信任此信息，因为提供商会在通过 oauth2 返回电子邮件之前对其进行验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:31:06.753

我建议你使用 PureKrome 的 World Domination，它使用起来很简单，有据可查而且非常好！

[https://github.com/PureKrome/WorldDomination.Web.Authentication](https://github.com/PureKrome/WorldDomination.Web.Authentication)

它通过简单的单行配置处理 Twitter、Google、Facebook 等，并处理其他所有内容。

创作者也经常在 n jabbr.net 上闲逛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:34:21.660

ASP.NET MVC 4 'Internet Application' 模板已经`DotNetOpenAuth`在上面实现，如果你还没有的话，你应该看看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T20:23:53.133

看看[Social Bootstrap API](http://bootstrapapi.apphb.com/timelines)项目（它使用 servicestack，但很高兴看到所有这些流行语技术在一个可读的示例中协同工作）。

此外，如果您想更好地了解 OAuth 的工作原理，[Mashape 有很好的解释](https://github.com/Mashape/mashape-oauth/blob/master/FLOWS.md#sources)。这将使您了解大多数包装器实现的幕后东西。

[Rick Strahl 有一个例子](http://www.west-wind.com/weblog/posts/2009/Sep/17/Integrating-OpenID-in-an-ASPNET-MVC-Application-using-DotNetOpenAuth)，我多年前用它在 MVC 中实现 OpenID。它有点过时了，但它是当时最直接的实现之一。我使用该实现构建的几个客户站点仍然运行良好。

# javascript - jQuery递增类名和函数

> ID：15770388
> 
> 赞同：3
> 
> 时间：2013-04-02T17:26:57.953
> 
> 标签：javascript, jquery, increment

我对 javascript 非常陌生，我每天都在向您的社区学习。但是，我找不到针对当前问题的干净解决方案。

我在幻灯片的第一张幻灯片上有一个瓷砖网格，我希望每个都链接到相应的幻灯片。例如，类名为“linkSlide3”的图块转到幻灯片“3”。现在我想避免重复以下目前正在工作的功能：

```
$('.linkSlide3').click(function() {
    $('.slider').mySuperSlider('goTo', 3);
    return false;
}); 
```

我需要从1递增到20，请问我怎样才能写得好？

非常感谢您的帮助！:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:32:22.023

对于这种情况，我使用数据属性来引用相应的元素：

```
$('.linkSlide').click(function() {
    $('.slider').mySuperSlider('goTo', $(this).data('slide'));
    return false;
}); 
```

在 HTML 中，您`data-slide`为每个重复元素添加属性：

```
<a class="linkSlide" data-slide="3">...</a> 
```

*这是这种绑定如何工作的抽象示例：http:* [//jsfiddle.net/rNvKe/](http://jsfiddle.net/rNvKe/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:59:43.743

而不是命名您的操作按钮

> .linkSlide1
> .linkSlide2
> .linkSlide3
> .etc...

你可以做

> .linkslide

并确保按钮的父级内没有其他元素，这样您的`.linkslide`元素将按`index`from `0`to组织`19`（对于 20 个按钮）。
比去抓住`.index()`点击的按钮并将其发送到`.superSlider( THAT INDEX!! )`.
要为滑块设置动画，您可以**将检索到的索引乘以 one-slide-width**：

`**[LIVE DEMO](http://jsbin.com/afizod/5/edit)**`

**jQuery：**

```
$('.linkSlide, .back').click(function() {
    var ind = $(this).index()+1; // +1 cause we are already at 0
    if($(this).hasClass('back')) ind = 0; // go to slide index 0
    superSlider( ind ); 
});

function superSlider( ind ){
  var oneSlideWidth = $('.slide').width();
  $('#allSlides').stop().animate({left: -(ind*oneSlideWidth) },700);  
} 
```

**HTML：**

```
<div id="slider">  
  <div id="allSlides">

    <div class="slide"> <!-- index = 0 -->
        Slide 0
       <button class="linkSlide">Tile index 1</button> <!-- index = 0, add 1-->
       <button class="linkSlide">Tile index 2</button> <!-- index = 1, add 1 -->
       <button class="linkSlide">Tile index 3</button> <!-- index = 2, add 1 -->
    </div>

    <div class="slide"> <!-- index = 1 -->
      Slide 1
      <button class="back">Back to 0</button>      
    </div>

    <div class="slide"> <!-- index = 2 -->
      Slide 2
      <button class="back">Back to 0</button>      
    </div>

    <div class="slide"> <!-- index = 3 -->
      Slide 3
      <button class="back">Back to 0</button>      
    </div>

  </div>
</div> 
```

**CSS：**

```
#slider{
  position:relative;
  width:100px;
  height:95px;
  background:#eee;
  text-align:center;
  overflow:hidden;  
}
#allSlides{
  position:absolute;
  left:0;
  width:9999px;
  height:95px;
}

.slide{
  position:relative;
  width:100px;
  height:95px;
  float:left;
} 
```

探索我使用的 jQuery 方法：

[http://api.jquery.com/click/](http://api.jquery.com/click/)
[http://api.jquery.com/index/](http://api.jquery.com/index/)
[http://api.jquery.com/hasclass/](http://api.jquery.com/hasclass/)
[http://api.jquery.com/width/](http://api.jquery.com/width/)
[http: //api.jquery.com/stop/](http://api.jquery.com/stop/)
[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T20:35:47.780

这是我在这个网站上的第一个问题，没想到这么多详细的答案……这么快！因此，感谢你们所有人，感谢你们的时间、技能和善意！

我跟着 dfsq 的回答，它工作得很好:-)

HTML：

```
 <div class="linkSlide" data-slide="1"></div>
    <div class="linkSlide" data-slide="2"></div>
    <div class="linkSlide" data-slide="3"></div>
    etc… until 20 
```

JS：

```
$('.linkSlide').click(function() {
    $('.slider').mySuperSlide('goTo', $(this).data('slide'));
    return false;
}); 
```

# image - 使用 refline 时如何阻止 MATLAB 调整图像大小或缩放图像

> ID：15770395
> 
> 赞同：3
> 
> 时间：2013-04-02T17:27:44.437
> 
> 标签：image, matlab, resize, plot, scaling

我一直在寻找这个，但是当我使用 refline 命令时，我不知道如何阻止 MATLAB 调整我的图像大小。线条画得很完美，但我的图像被缩小到非常小的尺寸，以适应窗口中的线条和图像。当我调用 refline 命令时，有没有办法阻止 MATLAB 这样做？

例如： imshow('picture') userline=refline((真的很大的数字让说 99),2); 设置（用户线，'颜色'，'m'，'线宽'，2）

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:39:19.407

`refline`您可以将轴的限制设置为与调用之前相同。

```
plot(1:10)
ax = gca;
refline(0.5,-1)
set(gca,'Ylim',get(ax,'Ylim'))
set(gca,'Xlim',get(ax,'Xlim')) 
```

# asp.net - 自定义用户控件数据源

> ID：15770399
> 
> 赞同：2
> 
> 时间：2013-04-02T17:28:05.457
> 
> 标签：asp.net, user-controls

我有一个自定义控件，里面有一个 DropDownList，它是由 CreateUserControl 创建的。我将数据源直接保存到下拉控件。页面回发后，我的绑定数据消失了。我应该以某种棘手的方式自己保存/恢复绑定的数据吗？

```
public class EnumDropDownList : UserControl
{
    private readonly DropDownList _ddlSelector;
    private Dictionary<long, string> _dataSource;

    public EnumDropDownList()
    {
        _ddlSelector = new DropDownList();
        _dataSource = new Dictionary<long, string>();
    }

    public object DataSource
    {
        set
        {
            // datasource logic
        }
    }

    public long SelectedValue
    {
        get { return Convert.ToInt64(_ddlSelector.SelectedValue); }
        set { _ddlSelector.SelectedValue = value.ToString(); }
    }

    public override void DataBind()
    {
        _ddlSelector.DataSource = _dataSource;
        _ddlSelector.DataTextField = "Value";
        _ddlSelector.DataValueField = "Key";
        _ddlSelector.DataBind();

        base.DataBind();
    }

    [PermissionSet(SecurityAction.Demand, Name = "Execution")]
    protected override void CreateChildControls()
    {
        Controls.Add(_ddlSelector);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:45:34.070

在某些情况下，我将数据集保存在会话变量中。然后可以在回发后引用 Whicn。像这样的东西：

```
Session.Add("dataSource", _dataSource);//create the session variable 
```

然后您可以引用它，具体取决于数据源的类型（例如，我使用了数据表）

```
_ddlSelector.DataSource = (DataTable)Session["dataSource"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:26:24.093

您的代码是`UserControl`和的组合`CustomServerControl`。

如果您实现一个而不是组合，它可能会容易得多。

我创建了两个控件 -`UserControl`和`CustomServerControl`.

**用户控制**

将下拉列表放置到 ASPX 而不是动态加载。如果动态加载，则必须注意控制的持久性。

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="EnumDropDownList.ascx.cs"
    Inherits="WebApplication2010.EnumDropDownList" %>
<asp:DropDownList runat="server" ID="DropDownList1" />

public partial class EnumDropDownList : System.Web.UI.UserControl
{
    private Dictionary<long, string> _dataSource;

    public EnumDropDownList()
    {
        _dataSource = new Dictionary<long, string>();
    }

    public Dictionary<long, string> DataSource
    {
        set { _dataSource = value; }
    }

    public long SelectedValue
    {
        get { return Convert.ToInt64(DropDownList1.SelectedValue); }
        set { DropDownList1.SelectedValue = value.ToString(); }
    }

    public override void DataBind()
    {
        DropDownList1.DataSource = _dataSource;
        DropDownList1.DataTextField = "Value";
        DropDownList1.DataValueField = "Key";
        DropDownList1.DataBind();

        base.DataBind();
    }
} 
```

**自定义服务器控制（根据您的情况实施要容易得多）**

它基本上继承了 DropDownList web 控件。

```
public class MyDropDownList : DropDownList
{
    public long SelectedInt64Value
    {
        get { return Convert.ToInt64(SelectedValue); }
        set { SelectedValue = value.ToString(); }
    }

    public Dictionary<long, string> DataSource
    {
        get { return (Dictionary<long, string>)ViewState["DataSource"]; }
        set { ViewState["DataSource"] = value; }
    }

    public override void DataBind()
    {
        foreach (var item in DataSource)
            Items.Add(new ListItem(item.Value, item.Key.ToString()));

        base.DataBind();
    }
} 
```

**用法**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm5.aspx.cs" Inherits="WebApplication2010.WebForm5" %>

<%@ Register Src="EnumDropDownList.ascx" TagName="EnumDropDownList" TagPrefix="uc1" %>
<%@ Register TagPrefix="asp" Namespace="WebApplication2010" Assembly="WebApplication2010" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <uc1:EnumDropDownList ID="EnumDropDownList1" runat="server" />
    <asp:Button runat="server" ID="Button1" Text="Submit" OnClick="Button1_Click" />
    <asp:MyDropDownList id="MyDropDownList1" runat="server" />
    </form>
</body>
</html>

protected void Page_Load(object sender, EventArgs e)
{
    if(!IsPostBack)
    {
        Dictionary<long, string> dataSource  = new Dictionary<long, string>();
        dataSource.Add(1, "One");
        dataSource.Add(2, "Two");

        EnumDropDownList1.DataSource = dataSource;
        EnumDropDownList1.DataBind();

        MyDropDownList1.DataSource = dataSource;
        MyDropDownList1.DataBind();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T07:52:22.637

这是 aspx 文件：

```
 <telerik:RadComboBox ID="cmbCurrency" runat="server" Width="200px" MaxHeight="200px"
                    EmptyMessage="Select a currency" AutoPostBack="true" Filter="Contains" EnableLoadOnDemand="true">
                </telerik:RadComboBox> 
```

这是后面的代码：

```
 if (!IsPostBack)
            {
                popCurrencyName();              
            }    

    public void popCurrencyName()
                {
                    DataTable dtCurrency = objCurrencyBAL.getCurrency(long.MinValue);

                    if (dtCurrency.Rows.Count > 0)
                    {
                        cmbCurrency.DataSource = dtCurrency;
                        cmbCurrency.DataTextField = "Name";
                        cmbCurrency.DataValueField = "CurrencyId";
                        cmbCurrency.DataBind();
                    }
                } 
```

试试这个代码：

# php - 是否可以在 magento 中显示关联产品的属性？

> ID：15770400
> 
> 赞同：3
> 
> 时间：2013-04-02T17:28:10.757
> 
> 标签：php, javascript, magento

我正在开发一个电子商务网站。我们展示了每种产品的营养成分，大多数产品都是可配置的产品，这些产品有不同的口味。因为它们有不同的口味，这意味着成分不同，百分比也略有不同。

我已经制作了一个在前端可见的自定义属性，如果我把它放在可配置产品中就会显示出来，但是我想在每个简单的产品中放置不同的标签，然后有一个下拉菜单，以便在口味之间交换（相同用于选择属性的下拉列表类型）。我有一个下拉设置，它替换了我想要的文本，我需要帮助的是动态地填充该下拉列表和具有自定义属性值的数组。

看看我设置的这个测试产品。我通过静态块在侧栏中有营养成分，然后指向我设置的 php 文件。[http://hyperionsupps.com/test/index.php/red-bull2.html](http://hyperionsupps.com/test/index.php/red-bull2.html)

**静态块代码**

```
Nutritional Facts
{{block type="core/template" name="nutritionalfacts" template="nutritionalfacts.phtml"}} 
```

**边栏代码**（现在我用营养表硬编码了数组）

```
 <script type="text/javascript">

 var textBlocks = new Array( 
 'Select from the list to change this box', 
 '<table id="label_outer_table" class="outer_label"><tbody><tr id="facts_outer_line" class="outer_label"><td id="facts_outer_cell" class="outer_label"><table id="facts_table" class="facts_label"><tbody><tr id="facts_line_0" class="facts_label"><td id="facts_cell_0_1" class="seq_span label_size"><span id="facts_span_0_1_1" class="seq_span label_size">1 - 2 Fl. Oz. Bottle</span></td><td id="facts_cell_0_3" class="seq_span label_flavor" colspan="2"><span id="facts_span_0_3_1" class="seq_span label_flavor">Pomegranate</span></td></tr><tr id="facts_line_1" class="facts_label"><td id="facts_cell_1_1" class="seq_span label_title" colspan="3"><span id="facts_span_1_1_1" class="seq_span label_title">Supplement Facts</span></td></tr><tr id="facts_line_2" class="facts_label"><td id="facts_cell_2_1" class="seq_span label_serving" colspan="3"><span id="facts_span_2_1_1" class="seq_span label_serving">Serving Size</span><span id="facts_span_2_1_2" class="seq_span_non_first label_serving">2</span><span id="facts_span_2_1_3" class="seq_span_non_first label_serving">Fl Oz</span></td></tr><tr id="facts_line_3" class="facts_label"><td id="facts_cell_3_1" class="seq_span label_serving" colspan="3"><span id="facts_span_3_1_1" class="seq_span label_serving">Servings Per Container</span><span id="facts_span_3_1_2" class="seq_span_non_first label_serving">1</span></td></tr><tr id="facts_line_4" class="facts_label"><td id="facts_cell_4_1" class="seq_span label_divider medium" colspan="3"></td></tr><tr id="facts_line_5" class="facts_label"><td id="facts_cell_5_1" class="seq_span label_heading_l"><span id="facts_span_5_1_1" class="seq_span label_heading_l">Amount Per Serving</span></td><td id="facts_cell_5_3" class="seq_span label_heading_r" colspan="2"><span id="facts_span_5_3_1" class="seq_span label_heading_r">% Daily Value</span></td></tr><tr id="facts_line_6" class="facts_label"><td id="facts_cell_6_1" class="seq_span label_divider narrow" colspan="3"></td></tr><tr id="facts_line_7" class="facts_label"><td id="facts_cell_7_1" class="seq_span label_ing"><span id="facts_span_7_1_1" class="seq_span label_ing">Calories</span></td><td id="facts_cell_7_2" class="seq_span label_qty"><span id="facts_span_7_2_1" class="seq_span label_qty"></span><span id="facts_span_7_2_2" class="seq_span_non_first label_qty">4</span></td><td id="facts_cell_7_3" class="seq_span label_dv"><span id="facts_span_7_3_1" class="seq_span label_dv"></span></td></tr><tr id="facts_line_8" class="facts_label"><td id="facts_cell_8_1" class="line_above seq_span label_ing line_indent"><span id="facts_span_8_1_1" class="seq_span label_ing line_indent">Calories From Fat</span></td><td id="facts_cell_8_2" class="line_above seq_span label_qty"><span id="facts_span_8_2_1" class="seq_span label_qty"></span><span id="facts_span_8_2_2" class="seq_span_non_first label_qty">0</span></td><td id="facts_cell_8_3" class="line_above seq_span label_dv"><span id="facts_span_8_3_1" class="seq_span label_dv"></span></td></tr><tr id="facts_line_9" class="facts_label"><td id="facts_cell_9_1" class="line_above seq_span label_ing"><span id="facts_span_9_1_1" class="seq_span label_ing">Niacin (As Niacinamide)</span></td><td id="facts_cell_9_2" class="line_above seq_span label_qty"><span id="facts_span_9_2_1" class="seq_span label_qty"></span><span id="facts_span_9_2_2" class="seq_span_non_first label_qty">30</span><span id="facts_span_9_2_3" class="seq_span_non_first label_qty">mg</span></td><td id="facts_cell_9_3" class="line_above seq_span label_dv"><span id="facts_span_9_3_1" class="seq_span label_dv">150%</span></td></tr><tr id="facts_line_10" class="facts_label"><td id="facts_cell_10_1" class="line_above seq_span label_ing"><span id="facts_span_10_1_1" class="seq_span label_ing">Vitamin B6 (As Pyridoxine Hydrochloride)</span></td><td id="facts_cell_10_2" class="line_above seq_span label_qty"><span id="facts_span_10_2_1" class="seq_span label_qty"></span><span id="facts_span_10_2_2" class="seq_span_non_first label_qty">40</span><span id="facts_span_10_2_3" class="seq_span_non_first label_qty">mg</span></td><td id="facts_cell_10_3" class="line_above seq_span label_dv"><span id="facts_span_10_3_1" class="seq_span label_dv">2,000%</span></td></tr><tr id="facts_line_11" class="facts_label"><td id="facts_cell_11_1" class="line_above seq_span label_ing"><span id="facts_span_11_1_1" class="seq_span label_ing">Folic Acid</span></td><td id="facts_cell_11_2" class="line_above seq_span label_qty"><span id="facts_span_11_2_1" class="seq_span label_qty"></span><span id="facts_span_11_2_2" class="seq_span_non_first label_qty">400</span><span id="facts_span_11_2_3" class="seq_span_non_first label_qty">mcg</span></td><td id="facts_cell_11_3" class="line_above seq_span label_dv"><span id="facts_span_11_3_1" class="seq_span label_dv">100%</span></td></tr><tr id="facts_line_12" class="facts_label"><td id="facts_cell_12_1" class="line_above seq_span label_ing"><span id="facts_span_12_1_1" class="seq_span label_ing">Vitamin B12 (As Cyanocobalamin)</span></td><td id="facts_cell_12_2" class="line_above seq_span label_qty"><span id="facts_span_12_2_1" class="seq_span label_qty"></span><span id="facts_span_12_2_2" class="seq_span_non_first label_qty">500</span><span id="facts_span_12_2_3" class="seq_span_non_first label_qty">mcg</span></td><td id="facts_cell_12_3" class="line_above seq_span label_dv"><span id="facts_span_12_3_1" class="seq_span label_dv">8,333%</span></td></tr><tr id="facts_line_13" class="facts_label"><td id="facts_cell_13_1" class="line_above seq_span label_ing"><span id="facts_span_13_1_1" class="seq_span label_ing">Sodium</span></td><td id="facts_cell_13_2" class="line_above seq_span label_qty"><span id="facts_span_13_2_1" class="seq_span label_qty"></span><span id="facts_span_13_2_2" class="seq_span_non_first label_qty">10</span><span id="facts_span_13_2_3" class="seq_span_non_first label_qty">mg</span></td><td id="facts_cell_13_3" class="line_above seq_span label_dv"><span id="facts_span_13_3_1" class="seq_span label_dv">&lt;1%</span></td></tr><tr id="facts_line_14" class="facts_label"><td id="facts_cell_14_1" class="line_above seq_span label_divider medium" colspan="3"></td></tr><tr id="facts_line_15" class="facts_label"><td id="facts_cell_15_1" class="seq_span label_ing"><span id="facts_span_15_1_1" class="seq_span label_ing">Energy Blend</span></td><td id="facts_cell_15_2" class="seq_span label_qty"><span id="facts_span_15_2_1" class="seq_span label_qty"></span><span id="facts_span_15_2_2" class="seq_span_non_first label_qty">1870</span><span id="facts_span_15_2_3" class="seq_span_non_first label_qty">mg</span></td><td id="facts_cell_15_3" class="seq_span label_dv"><span id="facts_span_15_3_1" class="seq_span label_dv">†&lt;/span></td></tr><tr id="facts_line_16" class="facts_label"><td id="facts_cell_16_1" class="line_above seq_span label_ing line_indent" colspan="3"><span id="facts_span_16_1_1" class="seq_span label_ing line_indent">Citicoline, Glucuronolactone, N-Acetyl L-Tyrosine, L-Phenylalanine, Taurine, Malic Acid, Caffeine</span></td></tr><tr id="facts_line_17" class="facts_label"><td id="facts_cell_17_1" class="seq_span label_divider hairline" colspan="3"></td></tr><tr id="facts_line_18" class="facts_label"><td id="facts_cell_18_1" class="seq_span label_ing"><span id="facts_span_18_1_1" class="seq_span label_ing">Enzyme Blend</span></td><td id="facts_cell_18_2" class="seq_span label_qty"><span id="facts_span_18_2_1" class="seq_span label_qty"></span><span id="facts_span_18_2_2" class="seq_span_non_first label_qty">1</span><span id="facts_span_18_2_3" class="seq_span_non_first label_qty">mg</span></td><td id="facts_cell_18_3" class="seq_span label_dv"><span id="facts_span_18_3_1" class="seq_span label_dv">†&lt;/span></td></tr><tr id="facts_line_19" class="facts_label"><td id="facts_cell_19_1" class="line_above seq_span label_ing line_indent" colspan="3"><span id="facts_span_19_1_1" class="seq_span label_ing line_indent">Amylase, Protease, Lipase, Cellulase, Lactase</span></td></tr><tr id="facts_line_20" class="facts_label"><td id="facts_cell_20_1" class="seq_span label_divider medium" colspan="3"></td></tr><tr id="facts_line_21" class="facts_label"><td id="facts_cell_21_1" class="seq_span label_notes_sm" colspan="3"><span id="facts_span_21_1_1" class="seq_span label_notes_sm">† Daily Value not established.</span></td></tr></tbody></table></td></tr><tr id="other_outer_line" class="outer_label"><td id="other_outer_cell" class="outer_label"><table id="other_table" class="other_label"><tbody><tr id="other_line_23" class="other_label"><td id="other_cell_23_1" class="seq_span label_title_2" colspan="3"><span id="other_span_23_1_1" class="seq_span label_title_2">Other Ingredients</span></td></tr><tr id="other_line_24" class="other_label"><td id="other_cell_24_1" class="seq_span label_ing_2"><span id="other_span_24_1_1" class="seq_span label_ing_2">Purified Water</span><span id="other_span_25_1_1" class="seq_span label_ing_2">, Natural And Artificial Flavors</span><span id="other_span_26_1_1" class="seq_span label_ing_2">, Sucralose</span><span id="other_span_27_1_1" class="seq_span label_ing_2">, Potassium Sorbate</span><span id="other_span_28_1_1" class="seq_span label_ing_2">, Sodium Benzoate</span><span id="other_span_29_1_1" class="seq_span label_ing_2">, EDTA (To Protect Freshness)</span></td></tr></tbody></table></td></tr></tbody></table>', 

 '<table class="outer_label" id="label_outer_table"><tbody><tr class="outer_label" id="facts_outer_line"><td class="outer_label" id="facts_outer_cell"><table class="facts_label" id="facts_table"><tbody><tr class="facts_label" id="facts_line_0"><td class="seq_span label_size" id="facts_cell_0_1"><span class="seq_span label_size" id="facts_span_0_1_1">     12 - 2 Fl. Oz. Bottles</span></td><td class="seq_span label_flavor" id="facts_cell_0_3" colspan="2"><span class="seq_span label_flavor" id="facts_span_0_3_1">Grape</span></td></tr><tr class="facts_label" id="facts_line_1"><td class="seq_span label_title" id="facts_cell_1_1" colspan="3"><span class="seq_span label_title" id="facts_span_1_1_1">Supplement Facts</span></td></tr><tr class="facts_label" id="facts_line_2"><td class="seq_span label_serving" id="facts_cell_2_1" colspan="3"><span class="seq_span label_serving" id="facts_span_2_1_1">Serving Size</span><span class="seq_span_non_first label_serving" id="facts_span_2_1_2">2</span><span class="seq_span_non_first label_serving" id="facts_span_2_1_3">Fl Oz</span></td></tr><tr class="facts_label" id="facts_line_3"><td class="seq_span label_serving" id="facts_cell_3_1" colspan="3"><span class="seq_span label_serving" id="facts_span_3_1_1">Servings Per Container</span><span class="seq_span_non_first label_serving" id="facts_span_3_1_2">12</span></td></tr><tr class="facts_label" id="facts_line_4"><td class="seq_span label_divider medium" id="facts_cell_4_1" colspan="3"></td></tr><tr class="facts_label" id="facts_line_5"><td class="seq_span label_heading_l" id="facts_cell_5_1"><span class="seq_span label_heading_l" id="facts_span_5_1_1">Amount Per Serving</span></td><td class="seq_span label_heading_r" id="facts_cell_5_3" colspan="2"><span class="seq_span label_heading_r" id="facts_span_5_3_1">% Daily Value</span></td></tr><tr class="facts_label" id="facts_line_6"><td class="seq_span label_divider narrow" id="facts_cell_6_1" colspan="3"></td></tr><tr class="facts_label" id="facts_line_7"><td class="seq_span label_ing" id="facts_cell_7_1"><span class="seq_span label_ing" id="facts_span_7_1_1">Calories</span></td><td class="seq_span label_qty" id="facts_cell_7_2"><span class="seq_span label_qty" id="facts_span_7_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_7_2_2">4</span></td><td class="seq_span label_dv" id="facts_cell_7_3"><span class="seq_span label_dv" id="facts_span_7_3_1"></span></td></tr><tr class="facts_label" id="facts_line_8"><td class="line_above seq_span label_ing line_indent" id="facts_cell_8_1"><span class="seq_span label_ing line_indent" id="facts_span_8_1_1">Calories From Fat</span></td><td class="line_above seq_span label_qty" id="facts_cell_8_2"><span class="seq_span label_qty" id="facts_span_8_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_8_2_2">0</span></td><td class="line_above seq_span label_dv" id="facts_cell_8_3"><span class="seq_span label_dv" id="facts_span_8_3_1"></span></td></tr><tr class="facts_label" id="facts_line_9"><td class="line_above seq_span label_ing" id="facts_cell_9_1"><span class="seq_span label_ing" id="facts_span_9_1_1">Niacin (As Niacinamide)</span></td><td class="line_above seq_span label_qty" id="facts_cell_9_2"><span class="seq_span label_qty" id="facts_span_9_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_9_2_2">30</span><span class="seq_span_non_first label_qty" id="facts_span_9_2_3">mg</span></td><td class="line_above seq_span label_dv" id="facts_cell_9_3"><span class="seq_span label_dv" id="facts_span_9_3_1">150%</span></td></tr><tr class="facts_label" id="facts_line_10"><td class="line_above seq_span label_ing" id="facts_cell_10_1"><span class="seq_span label_ing" id="facts_span_10_1_1">Vitamin B6 (As Pyridoxine Hydrochloride)</span></td><td class="line_above seq_span label_qty" id="facts_cell_10_2"><span class="seq_span label_qty" id="facts_span_10_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_10_2_2">40</span><span class="seq_span_non_first label_qty" id="facts_span_10_2_3">mg</span></td><td class="line_above seq_span label_dv" id="facts_cell_10_3"><span class="seq_span label_dv" id="facts_span_10_3_1">2,000%</span></td></tr><tr class="facts_label" id="facts_line_11"><td class="line_above seq_span label_ing" id="facts_cell_11_1"><span class="seq_span label_ing" id="facts_span_11_1_1">Folic Acid</span></td><td class="line_above seq_span label_qty" id="facts_cell_11_2"><span class="seq_span label_qty" id="facts_span_11_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_11_2_2">400</span><span class="seq_span_non_first label_qty" id="facts_span_11_2_3">mcg</span></td><td class="line_above seq_span label_dv" id="facts_cell_11_3"><span class="seq_span label_dv" id="facts_span_11_3_1">100%</span></td></tr><tr class="facts_label" id="facts_line_12"><td class="line_above seq_span label_ing" id="facts_cell_12_1"><span class="seq_span label_ing" id="facts_span_12_1_1">Vitamin B12 (As Cyanocobalamin)</span></td><td class="line_above seq_span label_qty" id="facts_cell_12_2"><span class="seq_span label_qty" id="facts_span_12_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_12_2_2">500</span><span class="seq_span_non_first label_qty" id="facts_span_12_2_3">mcg</span></td><td class="line_above seq_span label_dv" id="facts_cell_12_3"><span class="seq_span label_dv" id="facts_span_12_3_1">8,333%</span></td></tr><tr class="facts_label" id="facts_line_13"><td class="line_above seq_span label_ing" id="facts_cell_13_1"><span class="seq_span label_ing" id="facts_span_13_1_1">Sodium</span></td><td class="line_above seq_span label_qty" id="facts_cell_13_2"><span class="seq_span label_qty" id="facts_span_13_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_13_2_2">18</span><span class="seq_span_non_first label_qty" id="facts_span_13_2_3">mg</span></td><td class="line_above seq_span label_dv" id="facts_cell_13_3"><span class="seq_span label_dv" id="facts_span_13_3_1">&lt;1%</span></td></tr><tr class="facts_label" id="facts_line_14"><td class="line_above seq_span label_divider medium" id="facts_cell_14_1" colspan="3"></td></tr><tr class="facts_label" id="facts_line_15"><td class="seq_span label_ing" id="facts_cell_15_1"><span class="seq_span label_ing" id="facts_span_15_1_1">Energy Blend</span></td><td class="seq_span label_qty" id="facts_cell_15_2"><span class="seq_span label_qty" id="facts_span_15_2_1"></span><span class="seq_span_non_first label_qty" id="facts_span_15_2_2">1870</span><span class="seq_span_non_first label_qty" id="facts_span_15_2_3">mg</span></td><td class="seq_span label_dv" id="facts_cell_15_3"><span class="seq_span label_dv" id="facts_span_15_3_1">†&lt;/span></td></tr><tr class="facts_label" id="facts_line_16"><td class="line_above seq_span label_ing line_indent" id="facts_cell_16_1" colspan="3"><span class="seq_span label_ing line_indent" id="facts_span_16_1_1">Taurine, Glucuronolactone, Malic Acid, N-Acetyl L-Tyrosine, L-Phenylalanine, Caffeine, Citicoline</span></td></tr><tr class="facts_label" id="facts_line_17"><td class="seq_span label_divider medium" id="facts_cell_17_1" colspan="3"></td></tr><tr class="facts_label" id="facts_line_18"><td class="seq_span label_notes_sm" id="facts_cell_18_1" colspan="3"><span class="seq_span label_notes_sm" id="facts_span_18_1_1">†† Daily Value not established</span></td></tr></tbody></table></td></tr><tr class="outer_label" id="other_outer_line"><td class="outer_label" id="other_outer_cell"><table class="other_label" id="other_table"><tbody><tr class="other_label" id="other_line_20"><td class="seq_span label_title_2" id="other_cell_20_1" colspan="3"><span class="seq_span label_title_2" id="other_span_20_1_1">Other Ingredients</span></td></tr><tr class="other_label" id="other_line_21"><td class="seq_span label_ing_2" id="other_cell_21_1"><span class="seq_span label_ing_2" id="other_span_21_1_1">Purified Water</span><span class="seq_span label_ing_2" id="other_span_22_1_1">, Natural And Artificial Flavors</span><span class="seq_span label_ing_2" id="other_span_23_1_1">, Sucralose</span><span class="seq_span label_ing_2" id="other_span_24_1_1">, Potassium Sorbate</span><span class="seq_span label_ing_2" id="other_span_25_1_1">, Sodium Benzoate</span><span class="seq_span label_ing_2" id="other_span_26_1_1">, And EDTA (To Protect Freshness)</span></td></tr></tbody></table></td></tr></tbody></table>');

 function changeText(elemid) { 
 var ind = document.getElementById(elemid).selectedIndex; 
 document.getElementById("display").innerHTML=textBlocks[ind]; 
 } 
 </script>

 </head><body>
 <?php $_helper = $this->helper('catalog/output'); ?>
 <?php $_product = Mage::registry('current_product'); ?>
 <?php //echo $_product->getNutrionfacts(); ?>

 <form> 
 <select id="whatever" onChange="changeText('whatever');"> 
 <option value="0">Select</option> 
 <option value="1">One</option> 
 <option value="2">Two</option> 
 </select><br> 
 </form> 

 <div id="display">Select from the list to change this box</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T20:48:26.897

我总是对使用 Magento 感到沮丧——可能是因为我不理解它。

您要查找的数据可能存储在 $_product 对象中 - 试试这个：

```
<?php
    $attributeNames = array_keys($_product->getData());
    echo '<pre>'.print_r($attributeNames, true).'</pre>';
?> 
```

祝你好运。

# sql - SQL 2008+ NOLOCK 与 READPAST 报告准确性的注意事项

> ID：15770402
> 
> 赞同：4
> 
> 时间：2013-04-02T17:28:12.773
> 
> 标签：sql, sql-server, locking

了解最终决策是业务决策，SQL 2008 R2 中运行的 NOLOCK 和 READPAST 之间的准确性考虑是什么？在与业务领域讨论更改之前，我希望有一个更好的了解。

我继承了许多查询，用于为管理报告创建数据视图。'WITH (NOLOCK)' 被广泛使用但不一致。正在读取的数据来自不断更新的广泛使用的应用程序的生产服务器。我们正在从 SQL 2005 服务器迁移到 SQL 2008 R2 服务器。这些报告需要比存档服务器上的 24 小时旧数据更新的数据。NOLOCK 的使用暗示了过去的决定；存在冲突的可能性，并且有点准确性损失是可以接受的。数据用于填充仪表板以进行人类意识/决策。

所有查询都是 SELECT，对数据视图登录具有只读访问权限。大多数查询是带有少量 2 和 3 表连接的单表。鉴于连接的低级别 WITH () 似乎比 SET TRANSACTION ISOLATION LEVEL {} 更好

表提示（Transact-SQL）[http://msdn.microsoft.com/en-us/library/ms187373.aspx](http://msdn.microsoft.com/en-us/library/ms187373.aspx)（以及关于 SO 的多个问题）说 NOLOCK 和/或 READUNCOMMITTED 可能有重复读取问题，除了丢失锁定的记录。

READPAST 看起来更准确，因为它只会错过锁定的记录而没有重复的机会。但我不确定它和 NOLOCK 之间丢失锁定记录的级别是否一致。

Tim Chapman 有一篇很好的文章比较了这两者，但它写于 2007 年，大部分评论围绕 2000 年和 2005 年，其中一条评论表明 READPAST 在 2008 R2 中存在问题

参考

[SELECT 语句中 NOLOCK 提示的效果](https://stackoverflow.com/questions/210171/effect-of-nolock-hint-in-select-statements)

[什么时候应该使用“with (nolock)”](https://stackoverflow.com/questions/686724/sql-when-should-you-use-with-nolock)

[在 SQL Server 中使用 NOLOCK 和 READPAST 表提示（作者 Tim Chapman）](http://www.techrepublic.com/article/using-nolock-and-readpast-table-hints-in-sql-server/6185492)

**编辑：**

以下两个答案建议使用快照隔离。快照隔离是数据库的依赖设置，这个 Q/A [https://serverfault.com/questions/117104/how-can-i-tell-if-snapshot-isolation-is-turned-on](https://serverfault.com/questions/117104/how-can-i-tell-if-snapshot-isolation-is-turned-on)描述了如何查看什么设置都在数据库中。我现在知道它已被禁用，我正在阅读来自主要应用程序数据库的报告。更改设置不是一种选择。+- 几个百分比的准确度是可以接受的，应用程序 (OLTP) 影响是不可接受的。大多数简单查询不需要考虑锁定，但在某些极端情况下，需要考虑锁定。随着 SQL 2005 快照隔离的出现，关于 SQL 2008 或更高版本中的 NOLOCK 和 READPAST 行为的可用信息很少。然而，它们仍然是我唯一的选择。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T17:35:19.477

一个值得考虑的更好的选择是为数据库本身启用 READ COMMITTED SNAPSHOT。这使用 tempdb 中的版本控制在事务开始时捕获表的状态。

[在http://www.brentozar.com/archive/2013/01/implementing-snapshot-or-read-committed-snapshot-isolation-in-sql-](http://www.brentozar.com/archive/2013/01/implementing-snapshot-or-read-committed-snapshot-isolation-in-sql-server-a-guide/)上有关于 NOLOCK、READPAST 等各个方面的很好读物[服务器指南/](http://www.brentozar.com/archive/2013/01/implementing-snapshot-or-read-committed-snapshot-isolation-in-sql-server-a-guide/)

`WITH (NOLOCK)`如果在您从中选择表格时有人正在更新表格，则可能会提供不正确的结果。如果在您阅读表格时由于插入而发生页面拆分，并且新页面恰好超出您已阅读的点，`WITH (NOLOCK)`则将已经从旧页面返回行，然后将返回重复行从新页面。这只是为什么`(NOLOCK)`不好的一个例子。

`WITH (READPAST)`当您从表中读取时，将跳过任何正在更新或插入的记录。在繁忙的数据库中，这两个选项都不好。

鉴于最近对您的问题进行的编辑，您声明您无法更改数据库设置`READ COMMITTED SNAPSHOT`，也许您应该考虑使用存储过程为您的报告收集数据，并在存储过程开始时使用`SET TRANSACTION ISOLATION LEVEL SNAPSHOT;`. 为此，您需要更改数据库选项“允许快照隔离”。

来自 SQL Server 联机丛书：

快照

指定事务中任何语句读取的数据将是事务开始时存在的数据的事务一致版本。事务只能识别在事务开始之前提交的数据修改。当前事务开始后其他事务所做的数据修改对于当前事务中执行的语句是不可见的。效果就好像事务中的语句获得了事务开始时已提交数据的快照。

除非正在恢复数据库，否则 SNAPSHOT 事务在读取数据时不会请求锁定。读取数据的 SNAPSHOT 事务不会阻止其他事务写入数据。写入数据的事务不会阻止 SNAPSHOT 事务读取数据。

在数据库恢复的回滚阶段，如果尝试读取被正在回滚的另一个事务锁定的数据，则 SNAPSHOT 事务将请求锁定。SNAPSHOT 事务被阻塞，直到该事务被回滚。锁被授予后立即释放。

在启动使用 SNAPSHOT 隔离级别的事务之前，必须将 ALLOW_SNAPSHOT_ISOLATION 数据库选项设置为 ON。如果使用 SNAPSHOT 隔离级别的事务访问多个数据库中的数据，则必须在每个数据库中将 ALLOW_SNAPSHOT_ISOLATION 设置为 ON。

不能将事务设置为以另一个隔离级别开始的 SNAPSHOT 隔离级别；这样做会导致事务中止。如果事务以 SNAPSHOT 隔离级别启动，您可以将其更改为另一个隔离级别，然后再返回到 SNAPSHOT。事务在第一次访问数据时开始。

在 SNAPSHOT 隔离级别下运行的事务可以查看该事务所做的更改。例如，如果事务对表执行 UPDATE，然后针对同一个表发出 SELECT 语句，则修改后的数据将包含在结果集中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T17:42:16.633

`NOLOCK`可能导致读取重复数据、丢失数据以及查询实际上失败并显示错误消息（与“数据移动”有关）。

另一方面，非`NONLOCK`查询也*可以*读取重复数据和错误数据！它绝不是数据库的一致快照。不同的是它不会读取未提交的数据并且永远不会失败。

问题`NOLOCK`主要是它可能会随机失败，因此您需要重试。此外，读取错误数据的概率略高。

`NOLOCK`在进行表扫描时有一个很大的优势：SQL Server 可以使用分配顺序扫描而不是索引顺序扫描。`TABLOCK`有同样的效果。在存在碎片的情况下，这可能是一个显着的加速。

考虑只使用快照隔离级别，因为它消除了所有这些问题。它带有其他一些权衡，并且您不会获得分配顺序扫描。但它永久且全面地消除了锁定问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T13:20:03.587

[在使用 SQLQueryStress http://www.datamanipulation.net/sqlquerystress/](http://www.datamanipulation.net/sqlquerystress/)进行压力测试后回答我自己的问题（这是非常易于使用的出色工具）。SQLQueryStress 的结果针对 SQL Server Profiler 进行了测试；精度与 SQL Server Profiler 相同，尽管进动少了小数点后两位（但对于此测试来说已经足够了）。

如问题中所述，主要关注的是应用程序性能影响，报告准确性和性能是次要考虑因素。所有测试都发生在测试应用程序处于活动状态并且有一些次要活动的测试服务器上。

下载并熟悉 SQLQueryStress 后，我设置了一个简单的“ReportQuery”来充当资源猪。它设置为使用 15 个线程运行 15 次迭代（总共 225 个查询）。总运行时间约为 28 秒，平均迭代时间为 1.49 秒。

创建了一个添加/删除“ApplicationQuery”来表示正在进行的应用程序活动。它设置为使用 1 个线程运行 2000 次迭代。有两个版本，带有 select 语句（运行 31 秒）和不带 select 语句（运行 28 秒）。这些代表正常的高峰时间应用程序活动。

运行“ReportQuery”三个版本中的每一个的 10 次测试运行，这是为了确定在 'with(nolock)'、'with(readpast) 和 without hints 之间是否有任何性能优势。结果表明，ReportQuery 在大约 28 秒内持续运行，平均迭代时间为 1.5 秒，没有显着差异。

没有大的异常值，因此决定为以下测试减少 5 次测试运行。

使用 select 语句对 ApplicationQuery 进行 5 次测试；三个版本的“ReportQuery”中的一个也在运行。在 15 次总计测试中，手动启动 ApplicationQuery，之后立即手动启动 ReportQuery。此场景表示资源繁重的报告查询与应用程序正在进行的资源活动作斗争。

重复了测试运行，但这次使用了没有选择语句的 ApplicationQuery。

结果：在每种情况下，ApplicationQuery 都被限制为几乎没有前进的进度，而 ReportQuery 正在运行。

使用多个 ApplicationQuery 对数据库进行资源争夺时，ReportQuery 没有明显的性能损失。

ApplicationQuery 能够与 ReportQuery 并行运行查询，但在争夺资源时进度非常缓慢。本质上，运行 2000 个应用程序添加/删除查询的总时间被 ReportQuery 使用的时间延长了。

最初的问题是关于哪个更准确，变得毫无意义。使用或不使用提示 NOLOCK 或 READPAST 之间基本上没有报告或应用程序性能差异，因此不要在繁忙的数据库中使用并尽可能获得最高精度。

'报告查询'</p>

```
select 
ID
, [TABLE_NAME]
, NUMBER
, FIELD
, OLD_VALUE
, NEW_VALUE
, SYSMODUSER
, SYSMODTIME
, SYSMODCOUNT

from dbo.UPMCINCIDENTMGMTAUDITRECORDSM1 

where Number like '%'
or NUMBER like '2010-01-01' 
```

'ApplicationQuery'（带有 Select 语句）

```
select * 

from dbo.UPMCINCIDENTMGMTAUDITRECORDSM1 
where FIELD = 'JJTestingPerformance'

insert into dbo.UPMCINCIDENTMGMTAUDITRECORDSM1 (ID
, [TABLE_NAME]
, NUMBER
, FIELD
, OLD_VALUE
, NEW_VALUE
)

values ('Test+Time'
, 'none'
, 'tst01'
, 'JJTestingPerformance'
, 'No Value'
, 'Test'
)

delete from dbo.UPMCINCIDENTMGMTAUDITRECORDSM1

where FIELD = 'JJTestingPerformance' 
```

'ApplicationQuery'（不带 Select 语句）

```
insert into dbo.UPMCINCIDENTMGMTAUDITRECORDSM1 (ID
, [TABLE_NAME]
, NUMBER
, FIELD
, OLD_VALUE
, NEW_VALUE
 )

values ('Test+Time'
, 'none'
, 'tst01'
, 'JJTestingPerformance'
, 'No Value'
, 'Test'
)

delete from dbo.UPMCINCIDENTMGMTAUDITRECORDSM1

where FIELD = 'JJTestingPerformance' 
```

![测试结果截图](https://i.stack.imgur.com/aXzT5.jpg)

# ruby-on-rails - heroku 服务器上的应用程序错误

> ID：15770404
> 
> 赞同：0
> 
> 时间：2013-04-02T17:28:21.573
> 
> 标签：ruby-on-rails, heroku

我试图将我的第一个 rails 项目推到 heroku。但我收到“应用程序错误”：应用程序发生错误，无法提供您的页面。请稍后重试。如果您是应用程序所有者，请查看您的日志以获取详细信息。

我无法理解错误是什么。我的日志：

```
C:\Sites\calend>heroku logs
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/railtie/configurable.rb:30:in `method_missing'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from script/rails:6:in `<main>'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/application.rb:136:in `initialize!'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `instance_exec'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from script/rails:6:in `require'

←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/config/environment.rb:
5:in `<top (required)>'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/engine.rb:587:in `each'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:245:in `load'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in
require'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `run_initializers'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/builder.rb:40:in `parse_file'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `run'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:55:in `block in run_initialize
rs'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/engine.rb:587:in `block in <class:Engine>'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `each'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/builder.rb:40:in `eval'
←[36m2013-04-02T16:43:48+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/server.rb:200:in `app'
←[36m2013-04-02T16:43:50+00:00 heroku[web.1]:←[0m Process exited with status 1
←[36m2013-04-02T16:43:50+00:00 heroku[web.1]:←[0m State changed from starting to
 crashed
←[36m2013-04-02T16:54:08+00:00 heroku[web.1]:←[0m State changed from crashed to
starting
←[36m2013-04-02T16:54:10+00:00 heroku[web.1]:←[0m Starting process with command
`bundle exec rails server -p 53576`
←[36m2013-04-02T16:54:13+00:00 app[web.1]:←[0m DEPRECATION WARNING: You have Rai
ls 2.3-style plugins in vendor/plugins! Support for these plugins will be remove
d in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in t
o your app as lib/myplugin/* and config/initializers/myplugin.rb. See the releas
e notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-r
c2-has-been-released. (called from <top (required)> at /app/config/environment.r
b:5)
←[36m2013-04-02T16:54:13+00:00 app[web.1]:←[0m DEPRECATION WARNING: You have Rai
ls 2.3-style plugins in vendor/plugins! Support for these plugins will be remove
d in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in t
o your app as lib/myplugin/* and config/initializers/myplugin.rb. See the releas
e notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-r
c2-has-been-released. (called from <top (required)> at /app/config/environment.r
b:5)
←[36m2013-04-02T16:54:13+00:00 app[web.1]:←[0m DEPRECATION WARNING: You have Rai
ls 2.3-style plugins in vendor/plugins! Support for these plugins will be remove
d in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in t
o your app as lib/myplugin/* and config/initializers/myplugin.rb. See the releas
e notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-r
c2-has-been-released. (called from <top (required)> at /app/config/environment.r
b:5)
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m => Rails 3.2.1 application starti
ng in production on http://0.0.0.0:53576
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m => Booting WEBrick
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m => Ctrl-C to shutdown server
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_depe
ndency'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/connec
tion_specification.rb:25:in `spec'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m Exiting
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m /app/vendor/bundle/ruby/1.9.1/gem
s/bundler-1.3.2/lib/bundler/rubygems_integration.rb:214:in `block in replace_gem
': Please install the postgresql adapter: `gem install activerecord-postgresql-a
dapter` (pg is not part of the bundle. Add it to Gemfile.) (LoadError)
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m => Call with -d to detach
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/connec
tion_specification.rb:127:in `establish_connection'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/lazy_load_hooks.rb:36:in `instanc
e_eval'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/connec
tion_specification.rb:48:in `resolve_hash_connection'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.
1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/connect
ion_specification.rb:39:in `resolve_string_connection'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/lazy_load_hooks.rb:36:in `execute
_hook'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in
require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activerecord-3.2.1/lib/active_record/railtie.rb:76:in `block (2 levels)
in <class:Railtie>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_depe
ndency'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/devise-2.2.3/lib/devise/orm/active_record.rb:3:in `<top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in
require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/postgresql_adap
ter.rb:6:in `<top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/devise-2.2.3/lib/devise.rb:258:in `setup'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/config/initializers/de
vise.rb:3:in `<top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/config/initializers/de
vise.rb:16:in `block in <top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/lazy_load_hooks.rb:42:in `run_loa
d_hooks'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/lazy_load_hooks.rb:42:in `each'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activerecord-3.2.1/lib/active_record/base.rb:716:in `<top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/lazy_load_hooks.rb:43:in `block i
n run_load_hooks'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:245:in `load'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/engine.rb:588:in `block (2 levels) in <class:En
gine>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/engine.rb:587:in `block in <class:Engine>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `instance_exec'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:245:in `load'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:245:in `block in
load'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_depe
ndency'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:55:in `block in run_initialize
rs'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `run'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/railtie/configurable.rb:30:in `method_missing'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/config/environment.rb:
5:in `<top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in
require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/application.rb:136:in `initialize!'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/engine.rb:587:in `each'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `each'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/config.ru:3:in `block
in <main>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `run_initializers'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/server.rb:200:in `app'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_depe
ndency'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/server.rb:304:in `wrapped_app'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands/server.rb:46:in `app'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/config.ru:in `<main>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/builder.rb:40:in `eval'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/config.ru:in `new'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/builder.rb:40:in `parse_file'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/rack-1.4.5/lib/rack/server.rb:254:in `start'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from script/rails:6:in `<main>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands/server.rb:70:in `start'
←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from script/rails:6:in `require'

←[36m2013-04-02T16:54:15+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9
.1/gems/railties-3.2.1/lib/rails/commands.rb:55:in `block in <top (required)>'
←[36m2013-04-02T16:54:16+00:00 heroku[web.1]:←[0m Process exited with status 1
←[36m2013-04-02T16:54:16+00:00 heroku[web.1]:←[0m State changed from starting to
 crashed
←[33m2013-04-02T16:58:52+00:00 heroku[api]:←[0m Starting process with command `b
undle exec rake -T` by aigool@mail.ru
←[32m2013-04-02T16:58:54+00:00 heroku[run.1117]:←[0m Awaiting client
←[32m2013-04-02T16:58:54+00:00 heroku[run.1117]:←[0m Starting process with comma
nd `bundle exec rake -T`
←[32m2013-04-02T16:58:56+00:00 heroku[run.1117]:←[0m State changed from starting
 to up
←[32m2013-04-02T16:59:00+00:00 heroku[run.1117]:←[0m Process exited with status
0
←[32m2013-04-02T16:59:00+00:00 heroku[run.1117]:←[0m State changed from up to co
mplete 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:37:16.623

您在错误消息中看到它：

```
Please install the postgresql adapter: `gem install activerecord-postgresql-adapter` 
(pg is not part of the bundle. Add it to Gemfile.) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:26:03.890

最好有如下组。

示例 Gemfile：

开发组：sqlite3，因为与 postgresql 相比，它不需要任何数据库设置过程

```
group :development do
  gem 'sqlite3'
end 
```

生产组

```
group :production do
  gem 'pg'
end 
```

# linux - 以 Mac、Linux 和 Windows 结尾的默认文件，用于在 shell/终端中运行可执行文件

> ID：15770409
> 
> 赞同：0
> 
> 时间：2013-04-02T17:28:38.820
> 
> 标签：linux, shell, executable, pyinstaller

我为 Mac、Windows 和 Linux 创建了一个 Python 脚本的可执行文件（通过 pyinstaller）。对于 Linux 和 Mac，我在 shell 中运行它们，因为它没有自己的界面：只需打开一个 shell 并输入程序的名称。

我想知道是否有办法使用某些文件结尾，所以如果用户单击该程序，它将在 shell 或终端中自动执行。或者，我将不胜感激有关如何执行此操作的任何其他想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T21:37:51.487

好的，现在我终于找到了我的问题的解决方案。在文件浏览器中单击程序后执行程序所需要做的就是添加结尾`.command`并使其可执行

例如，`exampleprogram.command`。点击它会执行shell中的程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:36:10.073

这样做的方法不是附加某个文件结尾，而是如注释中所指出的，使文件可执行（`chmod +x <file>`）并将魔术字节添加到文件的开头，告诉系统如何执行它。

魔术字节`#!`后面是可执行文件的路径。因此，对于 python 脚本，您可以在文件顶部放置以下内容：

```
#!/usr/bin/env python 
```

# asp.net-mvc - 在 ASP.NET MVC 控制器中与授权和未授权用户共享操作

> ID：15770413
> 
> 赞同：1
> 
> 时间：2013-04-02T17:28:45.587
> 
> 标签：asp.net-mvc, authorization

我有一个带有控制器的 ASP.NET MVC 应用程序。此控制器中的所有操作都可以由匿名用户访问。但是，如果用户通过了身份验证，我想在操作中做一些特别的事情。目前，我注意到无论如何，在此操作的上下文中，User.Identity.IsAuthenticated 始终为 false。这是我的代码：

```
public class MyController : Controller
{
  public ActionResult GetProfile(string id)
  {
    if (User.Identity.IsAuthenticated) {
      ViewBag.ShowAuthStuff = true;
    } else {
      ViewBag.ShowAuthStuff = false;
    }
  }
} 
```

如何使经过身份验证和未经身份验证的用户都可以访问相同的操作，但做不同的事情？我不明白为什么 User.Identify.IsAuthenticated 总是假的。我检查了我的饼干。当我登录时，有一个名为：

.ASPXAUTH

但是，当我访问该操作时，该 cookie 不再可用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T19:22:04.767

只需同时使用`Authorize`和`AllowAnonymous`过滤器：

```
[Authorize]
[AllowAnonymous]
public ActionResult GetProfile(string id)
{
    if (User.Identity.IsAuthenticated) {
        ViewBag.ShowAuthStuff = true;
    } else {
        ViewBag.ShowAuthStuff = false;
    }
} 
```

尽管匿名访问“个人资料”并没有多大意义。

此外，通常，您不希望在同一控制器中混合授权和未经授权的操作。最好将必须或可能需要在一个控制器中授权的操作放在一起，而在单独的控制器中进行未经授权的操作。在这种情况下，您可以`Authorize`在控制器本身上指定过滤器，然后`AllowAnonymous`在任何想要与经过身份验证的用户交互但不需要它的单个操作上指定过滤器。

例如在“Accounts”控制器中：

```
[Authorize]
public class AccountsController : Controller
{
    public ActionResult Profile()
    {
        // Login required to reach here
    }

    [AllowAnonymous]
    public ActionResult Login()
    {
        if (User.Identity.IsAuthenticated)
        {
            // Already logged in, redirect to profile
            return RedirectToAction("Profile");
        }

        // Show login form for anonymous user
        return View()
    }
} 
```

# c++ - VCL TWinControl 的子类化后代

> ID：15770417
> 
> 赞同：0
> 
> 时间：2013-04-02T17:28:59.077
> 
> 标签：c++, c++builder, vcl

使用伪函数进行子类化：

```
CreateSpecialHandle(TWinControl *Control, const TCreateParams &Params, const AnsiString SubClass)  
{  
......;  
    set Control DefWndProc to SubClass.lpfnWndProc  
    set Control WindowHandle from CreateWindowEx 
......;  
subclass(TWinControl *Control);  
}

subclass(TWinControl *Control)
{
  ......;
  oldWProc = (void*)GetWindowLong(Control->Handle, GWL_WNDPROC);
  oldDefWProc = (void*)(Control->DefWndProc);
  oldWindowProc = Control->WindowProc;
  MakeObjectInstance(newWProc) for SetWindowLong
  MakeObjectInstance(newDefWProc) for Control->DefWndProc
  Control->WindowProc = newWindowProc;
  ......;
} 
```

现在，我们有子类控件的意外行为。 `WM_NCHITTEST`结果 0 等...
例如，当`newWProc`拦截`WM_NCHITTEST`并设置`Result`为`HTCLIENT` 我们有鼠标响应时，但是，由于我的错误和错误的子类化，如果没有设置`msg.result`为 1 就 没有响应`msg.msg WM_NCHITTEST`，我们还需要手动处理什么？

*   `newWProc`回调`oldWProc`
*   `newDefWProc`回调`oldDefWProc`
*   `newWindowProc`来电`oldWindowProc`

我们是否也必须对子类控件的父控件进行子类化？
此外，发送`WM_GETTEXT`带有空缓冲区的结果。
显然，我们在这里做错了什么。我们需要解释，
提前谢谢大家
**更新：**

```
 in TDCEdit:public TCustomEdit overriding CreateWindowHandle
   void __fastcal CreateWindowHandle(const TCreateParams &Params)
      {
       CreateSpecialHandle(this,Params,TEXT("EDIT"));
      }
     void CreateSpecialHandle(TWinControl *Control,const TCreateParams &Params, AnsiString SubClass)  
     {
     ... 
     Control->WindowHandle = CreateWindowEx(...,"EDIT",....);
     ....
     subclass(Control);
     }
     subclass(TWinControl* Control)
     {
     ......;
     oldWProc = (void*)GetWindowLong(Control->Handle, GWL_WNDPROC);
     oldDefWProc = (void*)(Control->DefWndProc);
     oldWindowProc = Control->WindowProc;
     MakeObjectInstance(newWProc) for SetWindowLong
     MakeObjectInstance(newDefWProc) for Control->DefWndProc
     Control->WindowProc = newWindowProc;
     ......;
     } 
```

现在，当我使用 TDCEdit 并在 newWProc 中拦截 Message.Msg == WM_NCHITTEST
时，Message.Result 为 0 并在所有消息处理链中保持为 0。
请注意，子类化 TCustomEdit 是我们需要
在项目中子类化的其他控件之一，我们尝试对所有控件使用相同的子类（TWinControl*）函数。

这是 newWProc 的一部分，还有几行专注于问题

```
void __fastcall TControlWrapper::newWProc(Messages::TMessage &Message)
 {
   if(Message.Msg == WM_NCHITTEST ) // TEST
            if(Message.Result == 0) 
                  Message.Result=1;//<- WHY I NEED TO DO THIS
    if( Message.Msg == WM_DESTROY) {
      HandleWMDestroy(Message);
      return; 
    }
      CallWindowProcW( (int(__stdcall*)())oldWProc, 
              Handle, Message.Msg, Message.WParam, 
              Message.LParam);

     if(Message.Msg == WM_NCHITTEST )
            if(Message.Result == 0)Message.Result=1;//<- OR THIS

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T13:36:03.533

这是一个令人困惑的问题 - 您的代码示例不是 C++ 并没有帮助。

```
set Control DefWndProc to SubClass.lpfnWndProc 
```

例如，不是 C++ 函数中的一行。你能**显示你的实际代码**吗？

我可以猜测您要做什么：您是否要对窗口（可能是表单？）进行子类化，以便在单击鼠标时移动它？如果是这样，您不需要执行任何原始 Windows API 样式的子类化，就像您使用`GetWindowLong`. 在 C++ Builder 中，VCL 是围绕 Windows API 的面向对象的包装器，您可以通过以下两种更简洁的方式之一来执行此操作：

1.  创建一个新的`WindowProc`并设置它；这是一个指向新窗口过程的属性，您也只需调用旧的；
2.  创建您的后代类`TWinControl`（如果您使用的是表单，则已经有一个）并实现虚拟方法`WndProc`。

Delphi 中的#1 示例（但您应该能够轻松地将其转换为 C++）在[Embarcadero 文档中关于 WndProc 的子类化](http://docwiki.embarcadero.com/CodeExamples/XE3/en/SubClassWndProc_%28Delphi%29)。

#2 的一个例子，最干净的 OO 版本，在这里，它实际上也展示了如何做你想做的事情：[C++Builder: Create a TForm with BorderStyle bsNone that is但是可移动和可调整大小](https://stackoverflow.com/questions/7178030/cbuilder-create-a-tform-with-borderstyle-bsnone-that-is-nevertheless-movable/7184434#7184434)

鉴于您似乎想要做的事情，我建议您使用＃2。

# javascript - WebService 响应 IE 时出错

> ID：15770418
> 
> 赞同：0
> 
> 时间：2013-04-02T17:29:00.983
> 
> 标签：javascript, web-services, internet-explorer

我在下面使用这个脚本，并且可以在 chrome 和 firefox 上完美运行，但是在 ie 上，我无法从 webservice 获得响应。如果成功或错误，我需要打开/重定向到其他网站！为什么可以在 IE 上读取 webservice 的响应，以及如何解决这个问题？

```
function sendInfo(userId, Code) {
// text with all info to send to controller
var values = {
    "token": Code,
    "code": userId
}

// POST THE CHANGE HERE TO THE DATABASE
var url = "WSFacebook.asmx/saveToken";
$.post(url, values, function(data) {

            if (window.ActiveXObject) {
                return data.xml;
            }
            var xmlString = new XMLSerializer().serializeToString(data);
            var xml = xmlString,
                xmlDoc = $.parseXML(xml),
                $xml = $(xmlDoc),
                $title = $xml.find("string");
            var texto = $title.text();
            if ($title.text() == "Success") {
                window.location = '<%=ConfigurationManager.AppSettings["successUrl"].ToString() %>';
            } else {
                window.location = '<%=ConfigurationManager.AppSettings["errorUrl"].ToString() %>';
            }
    }); 
```

}

# php - 高级 PHP 排序

> ID：15770420
> 
> 赞同：0
> 
> 时间：2013-04-02T17:29:07.423
> 
> 标签：php, sorting

我了解如何使用标准 php 函数（例如 natsort()）使用基本排序，甚至使用 usort() 进行一些自定义排序。我的问题是当有多种形式的变量时如何获得自然排序结果。

例子：

```
$test = array('3,000 Numeral', '2 A', '2 A+', '2 B', '2 C', '3 A', '3 B', '4 A', '4 A+', '4 B', 'A', 'A+', 'B', 'C'); 
```

使用 usort 或 natsort 我们最终得到数组首先输出数值，最后输出字母数字。更糟糕的是，排序函数将逗号分隔的数值视为逗号后面的数字不存在。我们最终得到：

```
array('2 A', '2 A+', '2 B', '2 C', '3 A', '3 B', '3,000 Numeral', '4 A', '4 A+', '4 B', 'A', 'A+', 'B', 'C') 
```

所以我想我的问题是如何使用高级排序来处理多个级别的排序逻辑，以最终实现自然进程。就像是：

```
array('A', 'A+', 'B', 'C', '2 A', '2 A+', '2 B', '2 C', '3 A', '3 B', '4 A', '4 A+', '4 B', '3,000 Numeral') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:57:36.483

未经测试也不完整的建议：

获取单词的每个字母，如果是数字，则将其放入`array`：

`$array[] = $letter`

否则，从中减去`A`并将结果放入`array`：

`$array[] = ord($letter) - ord('A')`

你会有一个数字，一个数字代表每个字母与“A”的距离。

我想您还必须对符号和空格进行一些其他检查。

# c# - 为重复行的特定实例解析分隔数据

> ID：15770421
> 
> 赞同：4
> 
> 时间：2013-04-02T17:29:08.530
> 
> 标签：c#, linq, parsing

我有一个以下格式的字符串数组，其中每个字符串都以一系列三个字符开头，指示它包含的数据类型。例如：

> ABC|.....
> DEF|...
> RHG|1........
> RHG|2........
> RHG|3........
> XDF|... ...

我想找到任何重复的行（本例中为 RHG）并用特殊字符标记最后一行：

> >RHG|3…………

最好的方法是什么？我当前的解决方案有一种方法来计算行标题并创建一个包含标题计数的字典。

```
protected Dictionary<string, int> CountHeaders(string[] lines)
{
    Dictionary<string, int> headerCounts = new Dictionary<string, int>();
    for (int i = 0; i < lines.Length; i++)
    {
        string s = lines[i].Substring(0, 3);

        int value;
        if (headerCounts.TryGetValue(s, out value))
            headerCounts[s]++;
        else
            headerCounts.Add(s, 1);
    }
    return headerCounts;
} 
```

在主要的解析方法中，我选择了重复的行。

```
var repeats = CountHeaders(lines).Where(x => x.Value > 1).Select(x => x.Key);
foreach (string s in repeats)
{
    // Get last instance of line in lines and mark it
} 
```

这是我所得到的。我想我可以用另一个 LINQ 查询做我想做的事，但我不太确定。另外，我不禁觉得有一个更优化的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:39:56.847

您可以使用 LINQ 来实现这一点。

输入字符串：

```
var input = @"ABC|.....
DEF|...
RHG|1........
RHG|2........
RHG|3........
XDF|......"; 
```

`LINQ`询问：

```
var results = input.Split(new[] { Environment.NewLine })
                   .GroupBy(x => x.Substring(0, 3))
                   .Select(g => g.ToList())
                   .SelectMany(g => g.Count > 1 ? g.Take(g.Count - 1).Concat(new[] { string.Format(">{0}", g[g.Count - 1]) }) : g)
                   .ToArray(); 
```

我使用`Select(g => g.ToList())`投影在进一步的查询步骤中进行`g.Count` *O(1)*操作。

您可以`Join`使用以下方法将数组转换为一个字符串`String.Join`：

```
var output = String.Join(Environment.NewLine, results); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:49:59.657

或者，您可以找到带有反向引用正则表达式的重复行。我使用您的示例数据编写了这个 hacky 正则表达式，它匹配以前面的“标签”开头的行，管道分隔值。

```
^(?<Tag>.+)[|].+[\n\r](\k<Tag>[|].+[\n\r])+ 
```

匹配范围从第一个 RHG 行的开头开始，一直选择到最后一个 RHG 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:35:21.643

这是一个在一个 Linq 语句中包含解析和计数的示例 - 如果您愿意，请随时将其分解：

```
string[] data = new string[]
{
    "ABC|.....",
    "DEF|...",
    "RHG|1........",
    "RHG|2........",
    "RHG|3........",
    "XDF|......"
};

data.Select(d=> d.Split('|'))                     // split the strings
    .Select(d=> new { Key = d[0], Value = d[1] }) // select the key and value
    .GroupBy (d => d.Key)                         // group by the key
    .Where(g=>g.Count() > 1 )                     // find duplicates
    .Select(d => d.Skip(1))                       // select the repeating elements
    .SelectMany(g=>g)                             // flatten into a single list
    ; 
```

这将为您提供重复的键/值对列表。所以使用样本数据它将返回

```
Key Value 
RHG 2........ 
RHG 3........ 
```

我不确定你所说的“标记”这条线是什么意思，但是......

# javascript - ColdFusion 表单中的复选框

> ID：15770423
> 
> 赞同：1
> 
> 时间：2013-04-02T17:29:14.893
> 
> 标签：javascript, coldfusion, cfml

我的代码如下。我需要在页面加载时默认选中两个复选框。这将显示查询的结果。现在，当取消选中其中一个复选框时，需要提交表单并显示不同的查询结果。即使我取消选中复选框，也始终选中复选框。有人可以在这里指导我吗？

```
<form action="abc.cfm?show=yes" method="post" name="myform">
    <table align="center">
    <tr>
        <td>
            <input type="checkbox" checked="checked" name="chkbox" id="chkbox1"> <strong> Agreement Only</strong> 
            &nbsp;&nbsp;<input type="hidden" name="chk" id="chk1">
            <input type="checkbox" checked="checked" name="chkbox" id="chkbox2"> <strong>Active Employees</strong> 
            &nbsp;&nbsp;<input type="hidden" name="chk" id="chk2">
        </td>
        <td>
            <input type="Submit" name="submitnow" value="View now">
        </td>
    </table>
</form>

<cfif isdefined("form.chk1")>
    query 1
<cfelseif isdefined("form.chk2")>
    query 2
</cfif> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:43:28.303

您已经将复选框命名为相同的东西并且总是检查它们，那么为什么不检查它们呢？

您需要对它们进行唯一命名，并在提交页面后检查表单中是否存在密钥。或在表单尚未提交时将框显示为已选中

表格尚未提交 -`NOT structKeyExists(form,'fieldnames')`

表单已提交并选择了 chkbox1 -`structKeyExists(form,'chkbox1')`

```
 <td>
   <input type="checkbox"<cfif NOT structKeyExists(form,'fieldnames') OR structKeyExists(form,'chkbox1')> checked="checked"</cfif> name="chkbox1" id="chkbox1"> <strong> Agreement                        Only</strong> 
    &nbsp;&nbsp;<input type="hidden" name="chk" id="chk1">
     <input type="checkbox"<cfif NOT structKeyExists(form,'fieldnames') OR structKeyExists(form,'chkbox2')> checked="checked"</cfif> name="chkbox2" id="chkbox2"> <strong>Active                  Employees</strong> 
   &nbsp;&nbsp;<input type="hidden" name="chk" id="chk2">
  </td> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:51:55.347

有多种方法可以完成您尝试做的事情。我不确定你隐藏字段的目的是什么，所以我修改了一些东西，试图让生活更轻松一些。

有些人可能会建议 structkeyexists，但我不想介绍您可能不熟悉的新命令。

```
<cfparam name="form.chkbox" default="">

<form action="abc.cfm?show=yes" method="post" name="myform">
  <table align="center">
    <tr>
      <td><input type="checkbox" <cfif form.chkbox eq "" or listfind(form.chkbox, 1)>checked="checked"</cfif> name="chkbox" id="chkbox1" value="1">
        <strong> Agreement                        Only</strong> &nbsp;&nbsp;
          <input type="checkbox" <cfif form.chkbox eq "" or listfind(form.chkbox, 2)>checked="checked"</cfif> name="chkbox" id="chkbox1" value="2">
        <strong>Active                  Employees</strong> &nbsp;&nbsp;
</td>
      <td><input type="Submit" name="submitnow" value="View now"></td>
  </table>
</form>
<cfif listfind(form.chkbox, 1) and listfind(form.chkbox,2)>
  query 1
  query 2
</cfif> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:24:09.320

问题是提交表单时输入（`chk1`和`chk2`）确实存在于表单范围内。然而，它们的值是空的。

为了证明这一点，请在检查`form`之前转储范围。`isdefined`

```
<cfdump var="#form#" label="form scope"> 
```

![形成范围转储](https://i.stack.imgur.com/RgS4F.png)

您需要检查输入的`value`or`length`属性。

```
<cfif len(form.chk1)>
    query 1
</cfif> 
```

**但！**

这实际上似乎不是您想要做的。`chk1`并且`chk2`是您的*TEXT*输入，而不是您的*CHECKBOX*输入。

如果您想根据*复选框*进行操作，则需要检查`value`复选框输入的 - 这给我们带来了另一个问题：您没有`value`为复选框设置属性。

```
<input type="checkbox" value="1"...> 
```

现在，您需要`param`这些复选框的值以确保字段完全存在

```
<cfparam name="form.chkbox1" value="0"> 
```

然后检查值

```
<cfif form.chkbox1 EQ 1>
    query 1
</cfif> 
```

# ruby - 有没有办法强制 RSpec 重新评估 let 语句？

> ID：15770426
> 
> 赞同：7
> 
> 时间：2013-04-02T17:29:26.510
> 
> 标签：ruby, rspec, tdd, bdd

这个例子有点做作，但很好地解释了用例。

```
let( :number_of_users ){ User.count }

it 'counts users' do
  User.create
  number_of_users.should == 1
  User.create
  number_of_users.should == 2
end 
```

此测试失败，因为`number_of_users`只评估一次，并且变得陈旧。有没有办法在每次调用时重新评估它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-02T17:33:54.820

您可以只定义一个常规方法：

```
def number_of_users
  User.count
end

it 'counts users' do
  User.create
  number_of_users.should == 1
  User.create
  number_of_users.should == 2
end 
```

有关更多详细信息，请参阅此[博客文章](http://testdrivenwebsites.com/2011/08/17/different-ways-of-code-reuse-in-rspec/)，包括如何将辅助方法存储在单独的模块中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T17:40:14.250

如何编写这样的测试：

```
it "counts user" do
  expect {
    User.create
  }.to change(User, :count).by(1)
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:34:30.853

简短回答“不”（AFAIK）

如果你的方法或对象有一个有用的容器，你可能会通过为它分配一个变量来获得一些东西。

比你的例子更做作：

```
let( :user_module ){ User }

it 'counts users' do
  User.create
  user_module.count.should == 1
  User.create
  user_module.count.should == 2
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-19T11:09:19.790

你也可以使用过程

```
let( :number_of_users ){ proc { User.count } }

it 'counts users' do
  User.create
  number_of_users.call.should == 1
  User.create
  number_of_users.call.should == 2
end 
```

# php - 如何访问具有 @ 符号的 PHP 对象属性？

> ID：15770429
> 
> 赞同：0
> 
> 时间：2013-04-02T17:29:41.803
> 
> 标签：php, variables, special-characters

我的问题与此类似

[如何访问具有美元符号的 PHP 对象属性？](https://stackoverflow.com/questions/2093169/how-do-i-access-a-php-object-attribute-having-a-dollar-sign)

但我有一个@ (at) 符号而不是一美元。

对象是这样的：

```
object(SimpleXMLElement)#8 (1) { 
  ["@attributes"]=> array(3) { 
  ["type"]=> string(9) "image/png" 
  ["href"]=> string(62) "http://someurl.com/images/193/image_normal.jpg" 
  ["rel"]=> string(5) "image" 
  } 
} 
```

我必须访问 @attributes 变量（真的是 href 组件），但是 PHP 不允许这样的语法：

```
$object->@attributes 
```

在引用的资源之后，我尝试了这种方式：

```
$object->{'@attributes'}; 
```

或者

```
$myvar = '@attributes';
$object->$myvar; 
```

但是这两种形式都不会导致访问变量。它打印：

```
object(SimpleXMLElement)#8 (0) {} 
```

虽然我希望有一个向量。

任何的想法？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:36:43.633

在正常情况下`$object->{'@attributeName'}`- 问你的问题。

但是，您想使用 SimpleXMLElement 获取[xml 元素的属性](http://www.php.net/manual/en/simplexml.examples-basic.php#example-5346)- 这样做是这样的：

```
$attributeValue = (string) $xmlElement['attributeName']; 
```

更多用法：

[http://www.php.net/manual/en/simplexml.examples-basic.php](http://www.php.net/manual/en/simplexml.examples-basic.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:34:38.260

有关更多信息，请`attributes`参见[SimpleXMLElement::attributes](http://www.php.net/manual/en/simplexmlelement.attributes.php)

例子

```
foreach($xml->attributes() as $a => $b) {
    echo $a,'="',$b,"\"\n";
} 
```

# macos - 从 Ubuntu 主机共享文件夹和文件到 VM ware 工作站 mac os x lion

> ID：15770431
> 
> 赞同：1
> 
> 时间：2013-04-02T17:29:44.557
> 
> 标签：macos, osx-mountain-lion, ubuntu-12.04, vmware-workstation

我正在尝试将文件从 ubuntu 主机共享到安装在我的 VMware 工作站 8 中的 mac os x lion。我已在 vmware 选项设置中启用文件共享。我还在 mac os x 中启用了文件共享。我仍然看不到任何挂载的迹象，也看不到去哪里访问 ubuntu 中可用的文件。

将不胜感激详细说明如何做到这一点:) 谢谢。

# php - 如何从 PHP 中插入 NULL 值？

> ID：15770447
> 
> 赞同：1
> 
> 时间：2013-04-02T17:30:19.670
> 
> 标签：php, pdo

Let`x`是表中`t`允许 NULL 值的列。

下面的 PDO 语句应该使用哪个值`$value`来插入 NULL 值？

`$db->prepare("INSERT t SET x=:x")->execute(array(':x'=>$value));`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:31:20.147

您只需将其插入为`null`：

```
$db->prepare("INSERT t SET x=:x")->execute(array(':x'=>null)); 
```

如果需要，还可以添加[PDO::PARAM_NULL](http://uk.php.net/manual/en/pdo.constants.php)的数据类型。

# sql-server - sql server 恢复到较新版本，索引最佳实践

> ID：15770450
> 
> 赞同：1
> 
> 时间：2013-04-02T17:30:32.593
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, sql-server-2008-r2

我在一个他们正在从 2005 年到 2008 年升级 sql 服务器（数据仓库）的站点。我的理解是总是重建每个索引并在从以前的版本恢复后更新所有统计信息。如果不立即重建，会不会对性能造成很大影响？停机时间是一个问题，所以我必须一次安排一些重建。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:34:26.137

SQL Server 备份是执行备份时数据库的映像。您不需要重建索引或更新统计信息，因为恢复的数据库索引将具有与执行备份时相同的碎片。

# c++ - 封闭命名空间中的模板类作为朋友

> ID：15770451
> 
> 赞同：3
> 
> 时间：2013-04-02T17:30:35.500
> 
> 标签：c++, templates, namespaces, clang, friend

我的代码具有以下基本结构

```
namespace my {
  template<typename> class A;              // forward declaration
  namespace details {
    template<typename T> class B
    {
      const T*const t;
      B(const T*x) : t(x) {}               // non-public constructor
      template<typename> friend class A;   // friend declaration
    };
  }
  template<typename T> class A
  {
    T*const t;
  public:
    A(T*x) : t(x) {}
    details::B<T> makeb() const            // offending method:
    { return details::B<T>(t); }           //   calls non-public constructor
  };
} 
```

它在 gcc（4.7 和 4.8，using `-std=c++11`）和 icpc（13.1）下编译得很好，但不是 clang（using `-std=c++11 -stdlib=libc++`），它抱怨使用了非公共构造函数（在实例化有问题的方法时）。事实证明，如果朋友声明给出了完整的限定名，clang 很高兴，如

```
template<typename> friend class my::A; 
```

这是clang的错误吗？我原以为封闭命名空间中的任何可见符号都可以在内部命名空间`my`中使用*，而无需进一步限定*`my::details`。2011 年标准怎么说？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:39:24.323

我认为 Clang 是对的：

> ### 7.3.1.2 命名空间成员定义[namespace.memdef]
> 
> ³在命名空间中首先声明的每个名称都是该命名空间的成员。如果`friend`非本地类中的声明首先声明了类、函数、类模板或函数模板，则友元是最内层封闭命名空间的成员。在该命名空间范围内（在授予友谊的类定义之前或之后）提供匹配声明之前，未限定查找 (3.4.1) 或限定查找 (3.4.3) 无法找到朋友的名称。如果调用友元函数或函数模板，则可以通过名称查找找到其名称，该名称查找考虑来自与函数参数类型相关联的命名空间和类的函数（3.4.2）。如果`friend`声明中的名称既不是限定的也不是*模板 ID*并且声明是函数或*详细类型说明符*，**确定实体是否先前已声明的查找不应考虑最内层封闭命名空间之外的任何范围**。[*注意：*其他形式的友元声明不能声明最内层封闭命名空间的新成员，因此遵循通常的查找规则。—*尾注*] [*示例：*

```
// Assume f and g have not yet been declared.
void h(int);
template <class T> void f2(T);
namespace A {
  class X {
    friend void f(X);         // A::f(X) is a friend
    class Y {
      friend void g();        // A::g is a friend
      friend void h(int);     // A::h is a friend
                              // ::h not considered
      friend void f2<>(int);  // ::f2<>(int) is a friend
    };
  };

  // A::f, A::g and A::h are not visible here
  X x;
  void g() { f(x); }          // definition of A::g 
  void f(X) { /* ...  */}     // definition of A::f 
  void h(int) { /* ...  */ }  // definition of A::h
  // A::f, A::g and A::h are visible here and known to be friends
}

using A::x;

void h() {
  A::f(x);
  A::X::f(x);      // error: f is not a member of A::X
  A::X::Y::g();    // error: g is not a member of A::X::Y
} 
```

> —*结束示例*]

注意`// ::h not considered`.

# php - 为什么 pcntl_fork() 复制 PHP 对象？

> ID：15770453
> 
> 赞同：5
> 
> 时间：2013-04-02T17:30:41.220
> 
> 标签：php, fork, pcntl

[pcntl_fork()](http://php.net/manual/en/function.pcntl-fork.php)的手册说：

> pcntl_fork() 函数创建一个子进程，该子进程与父进程的区别仅在于它的 PID 和 PPID。

然而，运行这个简单的测试让我感到惊讶：

```
class Foo
{
    public function bar()
    {
        if (pcntl_fork()) {
            echo spl_object_hash($this), PHP_EOL;
        } else {
            echo spl_object_hash($this), PHP_EOL;
        }
    }
}

(new Foo)->bar(); 
```

结果如下所示：

```
000000005ec7fd31000000003f0fcfe6
000000006b4cd5fc000000007fee8ab7 
```

从文档的内容来看，我希望父母和孩子共享相同的变量，特别是当从一个对象中进行 fork() 时，我希望对对象的引用在两者中都是相同的过程。但上面的例子表明他们不是。

有趣的是，这里没有发生克隆，看起来对象只是被复制了。如果我添加一个`__clone()`函数，我可以看到它在分叉期间没有被调用。

两个进程不共享变量/对象的任何原因，或者对主题人员的任何良好阅读？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:03:49.733

分叉进程中对对象的引用*是*一样的，因为对象在子进程内存空间中的内存位置是一样的。

哈希计算为对象地址异或随机掩码（仅生成一次），您可以在 PHP 源代码中阅读`ext/spl/php_spl.c`：

```
PHPAPI void php_spl_object_hash(zval *obj, char *result TSRMLS_DC) /* {{{*/
{
    intptr_t hash_handle, hash_handlers;
    char *hex;

    if (!SPL_G(hash_mask_init)) {
        if (!BG(mt_rand_is_seeded)) {
            php_mt_srand(GENERATE_SEED() TSRMLS_CC);
        }    

        SPL_G(hash_mask_handle)   = (intptr_t)(php_mt_rand(TSRMLS_C) >> 1);
        SPL_G(hash_mask_handlers) = (intptr_t)(php_mt_rand(TSRMLS_C) >> 1);
        SPL_G(hash_mask_init) = 1; 
    }    

    hash_handle   = SPL_G(hash_mask_handle)^(intptr_t)Z_OBJ_HANDLE_P(obj);
    hash_handlers = SPL_G(hash_mask_handlers)^(intptr_t)Z_OBJ_HT_P(obj);

    spprintf(&hex, 32, "%016x%016x", hash_handle, hash_handlers);

    strlcpy(result, hex, 33); 
    efree(hex);
}
/* }}} */ 
```

如果在调用函数之前随机数生成器被播种，您将获得子进程和父进程完全相同的输出。但在这种情况下它不是，每个进程计算它自己的种子。的代码`GENERATE_SEED`去：

```
#ifdef PHP_WIN32
#define GENERATE_SEED() (((long) (time(0) * GetCurrentProcessId())) ^ ((long) (1000000.0 * php_combined_lcg(TSRMLS_C))))
#else
#define GENERATE_SEED() (((long) (time(0) * getpid())) ^ ((long) (1000000.0 * php_combined_lcg(TSRMLS_C))))
#endif 
```

如您所见，种子取决于*进程 ID*，这对于父进程和子进程来说当然是不同的。

所以，不同的随机数生成器种子，不同的随机掩码，不同的哈希。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:37:29.033

创建对象时不会计算对象哈希（正如人们所想的那样）。对象哈希值将在`spl_object_hash()`对象第一次被调用时计算。在您的示例中，这是在 fork 之后。

进一步注意，对于散列的计算，使用了一些随机性，因此使用了不同的散列。

# android - 无法单击 PopupWindow 中按钮上的按钮

> ID：15770456
> 
> 赞同：1
> 
> 时间：2013-04-02T17:30:51.257
> 
> 标签：android, button, click, popupwindow

当我显示包含 Button 的 PopupWindow 时，我无法单击他。执行 onclick，但不更改图形。

它显示弹出窗口：

```
public void btn_friendsgame_newClick(View v) {
    LayoutInflater layoutInflater = 
            (LayoutInflater)getBaseContext().getSystemService(LAYOUT_INFLATER_SERVICE);  

    View popupView = layoutInflater.inflate(R.layout.custom_dialog, null);

    RelativeLayout content = (RelativeLayout) popupView.findViewById(R.id.layout_content);

    Button b = new Button(this); // THIS BUTTON CAN'T CLICK!

    b.setText("Test");
    b.setLayoutParams(new LayoutParams(
            ViewGroup.LayoutParams.WRAP_CONTENT,
            ViewGroup.LayoutParams.WRAP_CONTENT));
    content.addView(b);

    final PopupWindow popupWindow = new PopupWindow(popupView, 
               LayoutParams.MATCH_PARENT,  LayoutParams.WRAP_CONTENT);  

    popupWindow.showAtLocation(this.findViewById(R.id.main), Gravity.CENTER, 0, 0);
    Button close = (Button) popupView.findViewById(R.id.btn_popup_settings);
    close.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            popupWindow.dismiss();
        }
    }); 
```

custom_dialog.xml：[http ://pastebin.com/dLivuE17](http://pastebin.com/dLivuE17)

如何修复这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:33:51.867

您不会`onClickListener`像使用按钮那样将他附加到一个`close`按钮上。我不知道你想做`b`什么，所以我不能给你任何代码，但你显然知道如何将`onClick`事件附加到按钮，因为你已经有了 with `close`。做同样的事情，`b`把你需要的任何逻辑放在里面`onClick()`，你应该可以点击他。

```
public void btn_friendsgame_newClick(View v) {
    LayoutInflater layoutInflater = 
            (LayoutInflater)getBaseContext().getSystemService(LAYOUT_INFLATER_SERVICE);  

    View popupView = layoutInflater.inflate(R.layout.custom_dialog, null);

    RelativeLayout content = (RelativeLayout) popupView.findViewById(R.id.layout_content);

    Button b = new Button(this); // THIS BUTTON CAN'T CLICK!

    b.setText("Test");
    b.setLayoutParams(new LayoutParams(
            ViewGroup.LayoutParams.WRAP_CONTENT,
            ViewGroup.LayoutParams.WRAP_CONTENT));
    content.addView(b);

   // here set onClick
   b.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
        // put logic in here to do whatever you want
      }

    final PopupWindow popupWindow = new PopupWindow(popupView, 
               LayoutParams.MATCH_PARENT,  LayoutParams.WRAP_CONTENT);  

    popupWindow.showAtLocation(this.findViewById(R.id.main), Gravity.CENTER, 0, 0);
    Button close = (Button) popupView.findViewById(R.id.btn_popup_settings);
    close.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            popupWindow.dismiss();
        }
    }); 
```

# objective-c - 从子类访问超类属性

> ID：15770457
> 
> 赞同：2
> 
> 时间：2013-04-02T17:30:54.277
> 
> 标签：objective-c

我在实现一个简单的超/子类方案时遇到了一些麻烦。我在超类中声明了一个 NSMutableDictionary，并试图在子类中访问它，但它只返回 null。任何帮助，将不胜感激。

```
@interface RootModel : NSObject <Updatable, TouchDelegate>
@property (nonatomic) NSMutableDictionary *gameValues;
@end

@interface SubclassModel : RootModel
@end

@implementation RootModel

- (id)initWithController:(id)controller {
    if ((self = [super init])) {
        _controller = controller;

        _gameValues = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                       [NSNumber numberWithFloat:300.0f], KEY_JUMP_VELOCITY,
                       [NSNumber numberWithFloat:49.47f], KEY_GRAVITY,
                       [NSNumber numberWithFloat:0.25f], KEY_JUMP_TIME_LIMIT,
                       nil];

        NSLog(@"%@", _gameValues);

    }
    return self;
}

@implementation SubclassModel

- (id)init{
    if ((self = [super init])) {
        // This NSLog prints "(null)" if using super.gameValues or self.gameValues, why?
        NSLog(@"subclass: %@", super.gameValues);

    }
    return self;
}
@end 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:52:35.067

正如 Catfish_Man 回答的那样，您的`init`方法需要调用`[super initWithController:]`. 但是，您的评论似乎表明对类/超类继承模型的误解：

> 我的超类由另一个控制器类初始化。对超级属性的任何调用（在 initWithController: 中初始化）都是有效的（它们返回值，而不是 null）。

当您创建一个实例时，`SubclassModel`该实例*本身就有*一个`RootModel`实例。该`RootModel`实例*不*`SubclassModel`与or的任何其他实例共享`RootModel`。

因此，如果“另一个控制器类”创建并初始化 的实例`RootModel`，然后显示您的`NSLog`输出，那么这是与您的实例完全不同的对象`SubclassModel`- 并且您的实例`RootModel`的一部分`SubclassModel`未初始化，因为您不调用`[super initWithController:]`，因此你`NSLog`在`SubclassModel`节目中`nil`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:34:11.163

您的子类`init`方法需要调用`[super initWithController:]`，因为这是实际初始化发生的地方。

（或者超类`initWithController:`需要调用`[self init]`，并且您需要将您所依赖的初始化工作移至`init`）

# c++ - C++ 使用参数初始化引用

> ID：15770459
> 
> 赞同：2
> 
> 时间：2013-04-02T17:30:58.517
> 
> 标签：c++

我有以下代码，我想知道为什么它写出“22”而不是垃圾

```
class example
{

public:

    example(int ea) : ref(ea)
    {
    }

    int& ref;
};

int main ()
{
    example obj(22);

    cout << obj.ref; // Writes out 22

    return 0;
} 
```

我认为这应该发生：

*   obj(22) 将 22 隐式转换为临时整数
*   整数被复制到 int ea 参数
*   ref 使用对 ea 参数的引用进行初始化
*   ea参数被破坏

为什么参考仍然有效？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:33:56.353

简短的回答：这是无效的，它只是碰巧起作用。

长答案：您的事件顺序是正确的。引用指向一个超出范围的变量（在构造函数的末尾）。因此，它是一个悬空参考。从那时起对该引用的任何使用都会表现出未定义的行为。在这种情况下，它恰好打印出该值，但它也可以轻松地执行其他任何操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T17:34:56.060

该引用仍然无效，并且访问它所引用的内存会产生未定义的行为。对你来说，它恰好指的是曾经包含一个值为 22 的整数并且尚未被重用的内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T17:38:47.257

其未定义的行为。

试试这段代码看看有什么不同：

```
example obj(22);
example obj2(33);
example obj3(44);

cout << obj.ref; // <-- writes out 44 instead of 22 
```

# java - 绘图表面，unlockCanvasAndPost 和 IllegalArgumentException

> ID：15770467
> 
> 赞同：3
> 
> 时间：2013-04-02T17:31:06.980
> 
> 标签：java, android, post, android-canvas, unlock

我的绘图应用程序有问题。当我离开绘图活动（例如使用返回按钮）时，出现以下错误。我看过帖子，但似乎没有任何帮助。拜托，如果你能看看我的绘图表面活动，那将意味着很多，因为我一直在努力让它工作一段时间！非常感谢 ：）

错误 ：

```
03-25 13:41:36.760: E/AndroidRuntime(6642): FATAL EXCEPTION: Thread-423
03-25 13:41:36.760: E/AndroidRuntime(6642): java.lang.IllegalArgumentException
03-25 13:41:36.760: E/AndroidRuntime(6642):     at android.view.Surface.nativeUnlockCanvasAndPost(Native Method)
03-25 13:41:36.760: E/AndroidRuntime(6642):     at android.view.Surface.unlockCanvasAndPost(Surface.java:457)
03-25 13:41:36.760: E/AndroidRuntime(6642):     at android.view.SurfaceView$4.unlockCanvasAndPost(SurfaceView.java:812)
03-25 13:41:36.760: E/AndroidRuntime(6642):     at com.ecp.drawing.DrawingSurface$DrawThread.run(DrawingSurface.java:80) 
```

DrawingSurface 的主要代码：

```
 public void run() {
        Canvas canvas = null;
        while (_run){
            if(isDrawing == true){
                try{
                    canvas = mSurfaceHolder.lockCanvas(null);
                    if(mBitmap == null){
                        mBitmap =  Bitmap.createBitmap (1, 1, Bitmap.Config.ARGB_8888);
                    }
                    final Canvas c = new Canvas (mBitmap);

                    c.drawColor(0, PorterDuff.Mode.CLEAR);
                    canvas.drawColor(0, PorterDuff.Mode.CLEAR);

                    commandManager.executeAll(c,previewDoneHandler);
                    previewPath.draw(c);

                    canvas.drawBitmap (mBitmap, 0,  0,null);
                } finally {
                    mSurfaceHolder.unlockCanvasAndPost(canvas);
                }

            }

        }

    } 
```

已经有一个表面破坏功能：

```
public void surfaceDestroyed(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    boolean retry = true;
    thread.setRunning(false);
    while (retry) {
        try {
            thread.join();
            retry = false;
        } catch (InterruptedException e) {
            // we will try it again and again...
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-25T19:49:35.310

我在 4.3 中遇到了类似的问题，在阅读了一段时间其他开发人员如何*绕过*这个错误之后，我来到了这个问题。

要记住的步骤：**lockCanvas**，**draw**然后**unlockCanvas**。

```
/**
 * Note: The drawing thread doesn't loop, it just runs once and exits
 */
@Override
public void run() {
    /* This should never happen but just to be sure... */
    if (mSurfaceHolder == null || mSurfaceView == null) {
        return;
    }

    /**
     * In order to work reliable on Nexus 7, we place ~500ms delay at the start of drawing thread
     * (AOSP - Issue 58385)
     */
    if (android.os.Build.BRAND.equalsIgnoreCase("google") &&
            android.os.Build.MANUFACTURER.equalsIgnoreCase("asus") &&
            android.os.Build.MODEL.equalsIgnoreCase("Nexus 7")) {

        Log.w(this, "Sleep 500ms (Device: Asus Nexus 7)");

        try {
            Thread.sleep(500);
        } catch (InterruptedException ignored) {
        }
    }

    Canvas canvas = null;

    while (mRunning) {
        try {
            Surface surface = mSurfaceHolder.getSurface();

            /* Check availability of surface */
            if (surface != null && surface.isValid()) {

                canvas = mSurfaceHolder.lockCanvas();

                synchronized (mSurfaceHolder) {
                    if (canvas != null) {

                        //TODO call drawing code
                    }
                }
            }

        } catch (Exception e) {
            Log.e(TAG, "[Drawing Thread]", e);

        } finally {
            /**
             * Do this in a finally so that if an exception is thrown during the above,
             * we don't leave the Surface in an inconsistent state
             */
            if (canvas != null && mSurfaceHolder != null) {
                mSurfaceHolder.unlockCanvasAndPost(canvas);
            }
        }
    }
} 
```

我希望这可以帮助某人。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-23T19:48:29.170

我猜这`lockCanvas`引发了一个异常，该异常被`canvas`设置为空。该异常将执行发送到`finally`调用的子句，该子句`unlockCanvasAndPost`引发了一个新异常。新的例外掩盖了旧的例外。

（这看起来有点像 4.3 中的错误，但这是在 4.3 出来之前发布的。）

# java - 打印 Java 变量的类型

> ID：15770469
> 
> 赞同：25
> 
> 时间：2013-04-02T17:31:14.123
> 
> 标签：java

在Java中，是否可以打印变量的类型？

```
public static void printVariableType(Object theVariable){
    //print the type of the variable that is passed as a parameter
    //for example, if the variable is a string, print "String" to the console.
} 
```

解决这个问题的一种方法是为每个变量类型使用一个 if 语句，但这似乎是多余的，所以我想知道是否有更好的方法来做到这一点：

```
if(theVariable instanceof String){
    System.out.println("String");
}
if(theVariable instanceof Integer){
    System.out.println("Integer");
}
// this seems redundant and verbose. Is there a more efficient solution (e. g., using reflection?). 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-02T17:36:42.843

根据您的示例，您似乎想要获取变量持有的*值*类型，而不是声明的变量类型。所以我假设如果`Animal animal = new Cat("Tom");`你不想`Cat`得到`Animal`。

要仅获取名称而不使用包部分使用

```
String name = theVariable.getClass().getSimpleName(); //to get Cat 
```

除此以外

```
String name = theVariable.getClass().getName(); //to get full.package.name.of.Cat 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-02T17:32:22.130

```
System.out.println(theVariable.getClass()); 
```

阅读[javadoc](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-02T17:33:04.417

您可以使用该`".getClass()"`方法。

```
System.out.println(variable.getClass()); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-02T17:34:17.183

```
variable.getClass().getName(); 
```

[对象#getClass()](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#getClass%28%29)

> 返回此 Object 的运行时类。返回的 Class 对象是被表示类的静态同步方法锁定的对象。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-02T17:32:51.230

```
public static void printVariableType(Object theVariable){
    System.out.println(theVariable.getClass())
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-04-02T17:34:03.570

你可以在课堂上阅读，然后得到它的名字。

```
Class objClass = obj.getClass();  
System.out.println("Type: " + objClass.getName()); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-01T13:17:55.713

```
public static void printVariableType(Object theVariable){
    System.out.println(theVariable);        
    System.out.println(theVariable.getClass()); 
    System.out.println(theVariable.getClass().getName());}

   ex- printVariableType("Stackoverflow");
    o/p: class java.lang.String // var.getClass()
         java.lang.String       // var.getClass().getName() 
```

# ruby - 如何通过 FFI 更改图标位置？

> ID：15770484
> 
> 赞同：1
> 
> 时间：2013-04-02T17:32:02.583
> 
> 标签：ruby, winapi, ruby-ffi

我正在尝试使用带有 FFI gem 的 Ruby 更改 Windows 7 桌面中图标的位置。

到目前为止，“[管理桌面图标](http://www.hackishcode.com/showstory.php?id=66)”拥有我想要的大部分内容，但它对我不起作用。

这篇文章曾经使用`LVA_ALIGNLEFT`过，但我知道我需要`LVS_ALIGNLEFT`根据“ [LVM_ARRANGE message](http://msdn.microsoft.com/en-us/library/windows/desktop/bb774884%28v=vs.85%29.aspx) ”来使用。

```
require 'ffi'

module Win32
  extend FFI::Library
  ffi_lib 'user32'
  ffi_convention :stdcall

  enum :lvm, [:LVM_GETITEMCOUNT, 4100,
              :LVM_ARRANGE, 4118,
              :LVM_SETITEMPOSITION, 4111]

  enum :parameter, [:GW_CHILD, 5,
                    :LVS_ALIGNLEFT, 2048 ]

  # Uses C Function to find the window handle(HWND) of a window with the specified text, in this case 'ProgMan'
  attach_function :findWindow, 
    :FindWindowA,[ :string, :parameter ], :int

  # Gets passed in window's child window 
  attach_function :getChildWindow,
    :GetWindow, [ :int, :parameter], :int

  # Sends a message to the passed in window  
  attach_function :sendMessage,
    :SendMessageA, [ :int, :lvm, :parameter, :long], :int
end

# Finds Windows handle for FolderView, SysListView32 which is the icon list
DesktopHandle = Win32.findWindow('ProgMan', 0)
DesktopHandle = Win32.getChildWindow(DesktopHandle, :GW_CHILD)
DesktopHandle = Win32.getChildWindow(DesktopHandle, :GW_CHILD)

# Aligns icons left?
Win32.sendMessage(DesktopHandle, :LVM_ARRANGE, :LVS_ALIGNLEFT, 0) 
```

`Win32.sendMessage(DesktopHandle, :LVM_ARRANGE, :LVS_ALIGNLEFT, 0)`应该左对齐图标但什么都不做。

我曾经`Win32.sendMessage(DesktopHandle, :LVM_GETITEMCOUNT, 0, 0)`确保我有正确的句柄，这确实输出了我拥有的相同数量的图标。

我从“ [LVM_* defs](http://www.winehq.org/pipermail/wine-devel/2002-October/009527.html) ”中获取了我的大部分值。

我只是不确定为什么这不起作用。

编辑：看起来左对齐实际上正在工作我只是没有意识到它在做什么，我认为使用这个命令应该将我所有的图标移动到我的屏幕左侧，但是这个命令只会改变对齐方式！当您左对齐某些内容或将某些内容居中时，Microsoft word 中的 IE 会改变文本的样式。

现在我需要得到改变图标位置的实际部分来工作：

```
for (int i=0; i<200; i++)
  SendMessage(DesktopHandle, LVM_SETITEMPOSITION, 0, MAKELPARAM(10, i)); 
```

我仍在寻找的唯一部分是如何`MAKELPARAM(10, I)`在 ruby​​ 中完成该部分，我想我可能想使用 Ruby 的 array#pack，但我不确定如何去做。

更新：原来我的 LVM 值的来源不是我需要的，而是我使用了“ [List-View Messages](http://www.geoffchappell.com/studies/windows/shell/comctl32/controls/listview/messages/index.htm?tx=25) ”中的值。（我更新了我的数字，所以上面的内容很好）

我还为 MAKELPARAM()找到了“ [Ruby Class: Object ”。](http://www.ruby-doc.org/gems/docs/v/vruby-2004.08.07/Object.html)

```
def MAKELPARAM(w1,w2)
  return (w2<<16) | w1
end 
```

这移动了我的一个图标`Win32.sendMessage(DesktopHandle, :LVM_SETITEMPOSITION, 0, makeLPARAM(10, 1))`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T13:42:03.830

原来我在我的发送消息中发送了错误的值。

计算图标数量的代码，然后将一个图标移动到某个 x、y 位置（这会将列表中的第一个图标移动到左上角位置，在我的情况下，我什么都没有。

```
require 'ffi'

module Win32
  extend FFI::Library
  ffi_lib 'user32'
  ffi_convention :stdcall

  enum :lvm, [:LVM_GETITEMCOUNT, 4100,
          :LVM_DELETEALLITEMS, 4105,
          :LVM_GETNEXTITEM, 4108,
          :LVM_SETITEMPOSITION, 4111,
          :LVM_GETITEMPOSITION, 4112,
          :LVM_ARRANGE, 4118,
          :LVM_UPDATE, 4138,
          :LVM_GETITEMTEXTA, 4141,
          :LVM_SETITEMTEXTA, 4142 ]

  enum :parameter, [:GW_CHILD, 5,
                    :LVS_ALIGNLEFT, 2048 ]

  # Uses C Function to find the window handle(HWND) of a window with the specified text, in this case 'ProgMan'
  attach_function :findWindow, 
    :FindWindowA,[ :string, :parameter ], :int

  # Gets passed in window handle's child window 
  attach_function :getChildWindow,
    :GetWindow, [ :ulong, :parameter], :int

  # Sends a message to the passed in window  
  attach_function :sendMessage,
    :SendMessageA, [ :ulong, :lvm, :parameter, :long], :int

end # end of Win32

def makeLPARAM(w1, w2)
  return (w2<<16) | w1
end

# Finds Windows handle for FolderView, SysListView32 which is the icon list
DesktopHandle = Win32.findWindow('ProgMan', 0)
DesktopHandle = Win32.getChildWindow(DesktopHandle, :GW_CHILD)
DesktopHandle = Win32.getChildWindow(DesktopHandle, :GW_CHILD)

# Gets count of icons on desktop
Win32.sendMessage(DesktopHandle, :LVM_GETITEMCOUNT, 0, 0)

# Moves the first icon in the list to the top leftmost position on the screen
Win32.sendMessage(DesktopHandle, :LVM_SETITEMPOSITION, 0, makeLPARAM(10, 1)) 
```

这比我想象的要困难得多！尽管很多都没有正确的价值观，但有人能指出我应该首先寻找价值观的地方吗？

# c# - 在多个 excel 文件的情况下，使用 c# 在 excel 中设置边框属性不起作用

> ID：15770486
> 
> 赞同：0
> 
> 时间：2013-04-02T17:32:05.700
> 
> 标签：c#

我正在使用 c# 中的 Microsoft.Office.Interop.Excel 库设计一个小程序。我的程序读取excel文件（名称为1.xlss，2.xlsx等）并制作一个新的excel文件，然后将所有excel文件的数据复制到一个行间距的新excel文件中。我还设置了单元格的某些属性，如边框、字体、背景颜色等。

第一个 excel 文件（1.xls）一切都很好，但在第 2、第 3 等情况下，它没有设置单元格的边框属性。这是我的代码

```
// data member initialization for reading the sheet
        Excel.Application app;
        Excel.Workbook workbook;
        Excel.Worksheet worksheet;
        Excel.Range range;

        // data member initialization for writing sheet
        Excel.Application finalApp;
        Excel.Workbook finalWorkBook;
        Excel.Worksheet finalWorkSheet;

        String path = this.textBox1.Text;
        String numberOfFiles = (String)this.comboBox1.SelectedItem;
        int count = 1;
        int row = 1, col = 1;
        try
        {
            // Object creation for the final sheet
            finalApp = new Excel.ApplicationClass();
            finalApp.Visible = true;
            finalWorkBook = finalApp.Workbooks.Add(1);
            finalWorkSheet = (Excel.Worksheet)finalWorkBook.Sheets[1];

            // opening a excel file
            app = new Excel.ApplicationClass();
            Excel.Borders b=null;
            Excel.Borders fb = null;
            try
            {
                for (int k = 0; k < Int32.Parse(numberOfFiles); k++)
                {
                    fullPath = @path + @"\" + count + ".xlsx";
                    workbook = app.Workbooks.Open(fullPath, Missing.Value, Missing.Value,
                        Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value
                        , Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value,
                        Missing.Value);
                    worksheet = (Excel.Worksheet)workbook.Sheets.get_Item(1);
                    range = worksheet.UsedRange;
                    int cnum1 = range.Columns.Count;
                    int rnum1 = range.Rows.Count;
                    int i, j;
                    for (i = 1; i <= rnum1; i++)
                    {
                        for (j = 1; j <= cnum1; j++)
                        {
                            if ((range.Cells[i, j] as Excel.Range).Value2 != null)
                            {
                                string value1 = (range.Cells[i, j] as Excel.Range).Value2.ToString();
                                finalWorkSheet.Cells[row, col] = value1;
                                b= (Excel.Borders)(range.Cells[i, j] as Excel.Range).Borders;
                                //MessageBox.Show(b.Weight.ToString());
                                fb=(finalWorkSheet.Cells[i, j] as Excel.Range).Borders;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeBottom].Weight= b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeBottom].Weight;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeTop].Weight = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeTop].Weight;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeLeft].Weight = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeLeft].Weight;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeRight].Weight = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeRight].Weight;

                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeBottom].LineStyle = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeBottom].LineStyle;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeTop].LineStyle = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeTop].LineStyle;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeLeft].LineStyle = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeLeft].LineStyle;
                                fb[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeRight].LineStyle = b[Microsoft.Office.Interop.Excel.XlBordersIndex.xlEdgeRight].LineStyle;
                                //fb.Color = b.Color;
                                //(finalWorkSheet.Cells[i, j] as Excel.Range).BorderAround(b.LineStyle,(Excel.XlBorderWeight)b.Weight,
                                //(Excel.XlColorIndex)b.ColorIndex,b.Color);
                            } 
                            (finalWorkSheet.Cells[row, col] as Excel.Range).Interior.Color = (range.Cells[i, j] as Excel.Range).Interior.Color;
                            (finalWorkSheet.Cells[row, col] as Excel.Range).Font.Color = (range.Cells[i, j] as Excel.Range).Font.Color;
                            col++;
                        }
                        row++;
                        col = 1;
                    }
                    //finalWorkBook.SaveAs("hello.xlsx", Excel.XlFileFormat.xlExcel4Workbook, Missing.Value,
                    //Missing.Value, Missing.Value, Missing.Value, Excel.XlSaveAsAccessMode.xlNoChange, Missing.Value, Missing.Value,
                    //Missing.Value, Missing.Value, Missing.Value);

                    workbook.Close(false, false, Missing.Value);
                    count++;
                    row++;
                    col = 1;
                }
            }
            catch (FileNotFoundException fnfe)
            {
                MessageBox.Show("Error while opening the file "+fullPath);
            }
            //finalWorkBook.Close(true,false,Missing.Value);
        }
        catch (Exception ex)
        {
            MessageBox.Show(@"Some Error has occurred.Please check the path Correctly
            whether it's correct or not");
        }
    } 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:40:00.217

```
fb=(finalWorkSheet.Cells[i, j] as Excel.Range).Borders; 
```

应该

```
fb=(finalWorkSheet.Cells[row, col] as Excel.Range).Borders; 
```

# python - 使用 Django Rest Framework 返回当前用户

> ID：15770488
> 
> 赞同：77
> 
> 时间：2013-04-02T17:32:08.743
> 
> 标签：python, django, api, django-rest-framework

我目前正在使用 Django 开发 API。

**但是**，我想创建一个视图，该视图返回具有以下端点的当前用户：`/users/current/`。

为此，我创建了一个列表视图并过滤了发出请求的用户的查询集。这行得通，但结果是一个列表，而不是单个对象。结合分页，与其他端点相比，结果看起来过于复杂和不一致。

我还尝试创建详细视图并过滤查询集，但 DRF 抱怨我没有提供 pk 或 slug。

你有什么主意吗？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-04-03T08:35:59.700

有了这样的东西，你可能最好打破通用视图并自己编写视图。

```
@api_view(['GET'])
def current_user(request):
    serializer = UserSerializer(request.user)
    return Response(serializer.data) 
```

你也可以像这样使用基于类的视图来做同样的事情......

```
class CurrentUserView(APIView):
    def get(self, request):
        serializer = UserSerializer(request.user)
        return Response(serializer.data) 
```

当然，你也不需要使用序列化器，你同样可以从用户实例中提取你需要的字段。

```
@api_view(['GET'])
def current_user(request):
    user = request.user
    return Response({
        'username': user.username,
        'email': user.email,
        ...
    }) 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2016-04-14T14:36:48.527

最好的方法是使用`viewsets.ModelViewSet`like 的力量：

```
class UserViewSet(viewsets.ModelViewSet):
    queryset = User.objects.all()
    serializer_class = UserSerializer

    def get_object(self):
        pk = self.kwargs.get('pk')

        if pk == "current":
            return self.request.user

        return super(UserViewSet, self).get_object() 
```

`viewsets.ModelViewSet`是`mixins.CreateModelMixin`+ `mixins.RetrieveModelMixin`+ `mixins.UpdateModelMixin`+ `mixins.DestroyModelMixin`+ `mixins.ListModelMixin`+的组合`viewsets.GenericViewSet`。如果您只需要列出所有或获取特定用户，包括当前经过身份验证的用户，您只需像这样替换它

```
class UserViewSet(mixins.RetrieveModelMixin, mixins.ListModelMixin, viewsets.GenericViewSet):
    # ... 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-01-21T09:49:07.930

如果出于某种原因必须使用通用视图集，则可以执行以下操作，

```
class UserViewSet(viewsets.ModelViewSet):
    model = User
    serializer_class = UserSerializer

    def get_object(self):
        return self.request.user

    def list(self, request, *args, **kwargs):
        return self.retrieve(request, *args, **kwargs) 
```

`retrieve`当客户端使用诸如主键之类的标识符请求单个实例时`/users/10`调用方法将正常触发检索方法。检索自身调用`get_object`。如果您希望视图始终返回当前使用的视图，则可以通过在其中调用和返回来修改`get_object`并强制`list`方法返回单个项目而不是列表`self.retrieve`。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-12-01T22:14:36.400

您可以使用 mixins，而不是使用 ModelViewSet 的全部功能。就像这里提到的那样，有用于检索单个对象的 RetrieveModelMixin - [http://www.django-rest-framework.org/api-guide/viewsets/#example_3](http://www.django-rest-framework.org/api-guide/viewsets/#example_3)

```
class UserViewSet(mixins.RetrieveModelMixin, viewsets.GenericViewSet):
    permission_classes = (permissions.IsAuthenticated,)
    queryset = User.objects.all()
    serializer_class = UserSerializer

    def get_object(self):
        return self.request.user 
```

如果您还需要更新模型，只需添加 UpdateModelMixin。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-12-13T14:44:51.567

我使用了这样的 ModelViewSet：

```
class UserViewSet(viewsets.ModelViewSet):
    model = User
    serializer_class = UserSerializer

    def dispatch(self, request, *args, **kwargs):
        if kwargs.get('pk') == 'current' and request.user:
            kwargs['pk'] = request.user.pk

        return super(UserViewSet, self).dispatch(request, *args, **kwargs) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-10-26T10:30:05.383

使用这种方式在django rest框架中获取登录用户数据

```
class LoggedInUserView(APIView):
    def get(self, request):
        serializer = UserSerializer(self.request.user)
        return Response(serializer.data) 
```

在 urls.py 文件中添加 api。

```
path('logged_in_user', LoggedInUserView.as_view()) 
```

# android - 为什么 Spydroid-ipcamera 在使用 RTPsocket 之前需要两个套接字？

> ID：15770490
> 
> 赞同：3
> 
> 时间：2013-04-02T17:32:14.070
> 
> 标签：android, sockets, android-mediarecorder

Spydroid-ipcamera 是一个开源的 Android 代码，可将手机的摄像头和麦克风传输到浏览器或 VLC。它的网站在这里：[http ://code.google.com/p/spydroid-ipcamera/](http://code.google.com/p/spydroid-ipcamera/)

当有人询问有关流式传输 Android 手机的相机时，这是 stackoverflow 中的一个典型示例。

查看它的代码：

(1) 它将两个套接字构建为一对：mSender、mReceiver

```
private LocalServerSocket mLss = null;
mLss = new LocalServerSocket("net.majorkernelpanic.librtp-"+sId);

mReceiver = new LocalSocket();
mReceiver.connect( new LocalSocketAddress("net.majorkernelpanic.librtp-" + mSocketId ) );
mReceiver.setReceiveBufferSize(500000);
mSender = mLss.accept();
mSender.setSendBufferSize(500000); 
```

(2)摄像头的输出写入mSender：在streaming/MediaStream.java中

```
// We write the ouput of the camera in a local socket instead of a file !   
setOutputFile(mSender.getFileDescriptor()); 
```

(3) 它构建了另一个对象mPacketizer，它包含一个RtpSocket 的成员。mPacketizer 对象从 mReceiver 接收摄像头输入流，将摄像头流封装成 RTP 数据包，然后通过网络发送数据包。

```
// the packetizer encapsulates this stream in an RTP stream and send it over the network
mPacketizer.setInputStream(mReceiver.getInputStream()); 
```

从这个意义上说，整个摄像机流是：

相机流 --> mSender --> mReceiver --> mPacketizer, RtpSocket --> 发送到网络。

我的问题是：为什么它需要两个套接字，mSender 和 mReceiver？一个套接字是否足以调解相机流和 RtpSocket？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-10T09:40:17.310

MediaRecorder 允许您将相机流写入文件或套接字。现在，当您需要直播供稿时，您可以将其发送到 LocalSocket（给您自己）并在接收器套接字处接收以进行进一步处理。

# java - Android TCP 连接到 Arduino

> ID：15770491
> 
> 赞同：2
> 
> 时间：2013-04-02T17:32:20.637
> 
> 标签：java, android, tcp, arduino

我正在尝试使用 TCP 将 Arduino 与 Android 连接起来。对于 Android 设备，我在端口 5554 上使用 AVD。当我在 Arduino 中运行 TCP 服务器并在 Android 中运行客户端时，一切都很好。问题是当我在 Android 中运行 TCP 服务器并在 Arduino 中运行客户端时，客户端只是在等待服务器。

这种方法（在 Arduino 代码中）实际上是失败的方法：

```
if (client.connect(serverIP, serverPort)) 
```

我知道我应该在这里做一个端口转发。我做了

```
telnet localhost 5554
redir add tcp:7600:7700 //7600 specified in client program. 7600 specified as Android server port 
```

此外，为了测试实际问题，我用 C 编写了一个 TCP 服务器和客户端。然后我尝试了所有，Audrino、C 和 Android 服务器/客户端组合。除了 Audrino 客户端和 Android 服务器之外的所有组合都在工作。

错误在哪里？

# applescript - applescript 到 osascript 的转换？

> ID：15770495
> 
> 赞同：2
> 
> 时间：2013-04-02T17:32:26.603
> 
> 标签：applescript, osascript

我正在使用 max msp 来运行 shell 命令，我一直在 applescript 中对代码进行原型设计，并且需要它们在 osascript 中运行，例如 -

```
tell application "Google Chrome" to close tab 1 of window 1 
```

转换为

```
osascript -e 'tell application \"Google Chrome\" to close tab 1 of window 1' 
```

我已经转换了大约 10 个命令，但被困在最后一个命令上

```
tell application "Google Chrome" to activate
tell application "System Events"
    tell process "Google Chrome"
        do shell script "/usr/local/bin/cliclick/ c:360,550"
    end tell
end tell 
```

我认为去

```
osascript -e 'tell application \"Google Chrome\" to activate' -e 'tell application \"System Events\" to tell process \"Google Chrome\" to do shell script \"/usr/local/bin/cliclick c:360, 550\"' 
```

cliclick 允许您通过 shell 使用鼠标。[http://www.bluem.net/en/mac/cliclick/](http://www.bluem.net/en/mac/cliclick/)。c是点击的命令标识符，所以在x360 y550

我的语法正确吗？当我不包含 c 标识符时它可以工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:30:57.920

我试过这个，它给了我这个错误信息：

```
99:151: execution error: System Events got an error: Invalid argument “360,” to command “c”: Expected two coordinates, separated by a comma. Example: “c:123,456” (1) 
```

解决方案：在数字 550 (c:360, 550) 之前有一个额外的空格，第二个值会丢失。删除空格字符，它应该可以工作（c：360,550）......</p>

这是我还更改了引用的版本：

```
osascript -e "tell application \"Safari\" to activate" -e "tell application \"System Events\" to tell process \"Safari\" to do shell script \"/usr/local/bin/cliclick c:360,550\"" 
```

# jquery - jquery .css() 仅设置找到的第一个匹配样式值

> ID：15770497
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:32:36.083
> 
> 标签：jquery, dynamic, css

这对我没有任何意义。

我正在尝试使用 jquery .css() 根据窗口高度设置某些按钮的“最小高度”。

不管出于什么原因，它只是设置了第一个按钮匹配的最小高度，但是有 16 个匹配按钮。

[http://jsfiddle.net/VDtgT/20/embedded/result/](http://jsfiddle.net/VDtgT/20/embedded/result/)

“#tab-btn-2”是问题所在。这是我正在使用的 javascript：

```
<script>
$( document ).ready( function(){
  setMaxHeight();
  $( window ).bind( "resize", setMaxHeight ); 

  function setMaxHeight() {
    $( "#tab-content-1" ).css( "max-height", ( $( window ).height() * 0.67 | 0 ) + "px" );
    $( "#tab-content-1" ).css( "min-height", ( $( window ).height() * 0.67 | 0 ) + "px" );
    $( "#tab-content-2" ).css( "max-height", ( $( window ).height() * 0.67 | 0 ) + "px" );
    $( "#tab-content-2" ).css( "min-height", ( $( window ).height() * 0.67 | 0 ) + "px" );
    $( "#tab-content-3" ).css( "max-height", ( $( window ).height() * 0.67 | 0 ) + "px" );
    $( "#tab-content-3" ).css( "min-height", ( $( window ).height() * 0.67 | 0 ) + "px" ); 
    $( "#tab-btn-2" ).css( "min-height", ( $( window ).height() * 0.67 | 0 ) + "px" );

  }

});
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:35:46.187

ID 是唯一的，jQuery 只会找到具有特定 ID 的第一个元素，因为应该只有一个。

您需要改用一个类。

```
$( ".tab-btn-2" ).css( .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:36:19.760

一种选择是为每个按钮提供相同的类名并使用该类来设置最小高度（相对于 id）。对于页面上的每个元素，您的 id 应该是唯一的。

```
<input type=button id=whatever class="tab-btn-2" />
...
$( ".tab-btn-2" ).css( "min-height", ( $( window ).height() * 0.67 | 0 ) + "px" ); 
```

# xml - 将 SOAP 请求放入此处的字符串中

> ID：15770506
> 
> 赞同：0
> 
> 时间：2013-04-02T17:33:21.040
> 
> 标签：xml, powershell, soap

我正在尝试编写一个脚本，该脚本将发送随机 SOAP 请求以测试另一个进程。但是我似乎无法创建变量。每次我将代码从记事本复制/粘贴到 PS 控制台时，脚本都会以 >> 结尾（即使在多次按 Enter 后也是如此）。即使我只复制/粘贴`$SOAPRequest`脚本的一部分，也会发生同样的事情。如果我注释掉整个 here-string，脚本就会运行（尽管由于缺少 SOAP 内容而出现错误）。

我尝试了以下各种组合：

*   用反斜杠转义英镑符号
*   删除包含磅符号的行
*   在 Powershell v1 和 Powershell v2 中使用 SOAP 请求创建变量
*   删除所有带有 http 地址的行
*   使用@''@（不仅没有用，而且我需要变量扩展）

**问题**：如何让 Powershell 将 here-string 中的内容设置为`$SOAPRequest`变量？换句话说，我怎样才能停止>>？通常这意味着我错过了括号、括号或双引号，但我似乎找不到类似的东西。我不知道为什么这不起作用。

我寻求帮助的页面：

*   [带参数的 Powershell SOAP 请求](https://stackoverflow.com/questions/12401776/powershell-soap-request-with-parameter)
*   [http://blogs.technet.com/b/heyscriptingguy/archive/2011/02/17/use-powershell-to-simplify-working-with-xml-data.aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2011/02/17/use-powershell-to-simplify-working-with-xml-data.aspx)

$SOAPRequest 变量：

```
$SOAPRequest = [xml] @"
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soa="http://bmc.com/ao/xsd/2008/09/soa">
<soapenv:Header>
<wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" soapenv:mustUnderstand="1">
<wsse:UsernameToken>
<wsse:Username>USER</wsse:Username>
<wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">#PASSWD#</wsse:Password>
</wsse:UsernameToken>
</wsse:Security>
</soapenv:Header>
<soapenv:Body>
<soa:executeProcess>
<soa:gridName>GRID</soa:gridName>
<soa:processName>Software_Distribution</soa:processName>
<soa:parameters>
<soa:Input>
<soa:Parameter>
<soa:Name required="true">Software Request</soa:Name>
<soa:Value soa:type="xs:anyType">
<soa:XmlDoc>
<request>
<Source>SourceName</Source>
<Command>create</Command>
<Debug>true</Debug>
<DeployType>standard</DeployType>
<PkgId>$pkgID</PkgId>
<PackageName>$pkgName</PackageName>
<PackageShareLocation>\\Network\Share\With\Content</PackageShareLocation>
<PackageFormat>exploded</PackageFormat>
<InstallScript>install.bat</InstallScript>
<InstallTimeout>3600</InstallTimeout>
<SilentInstall>True</SilentInstall>
<Emails />
</request>
</soa:XmlDoc>
</soa:Value>
</soa:Parameter>
</soa:Input>
</soa:parameters>
</soa:executeProcess>
</soapenv:Body>
</soapenv:Envelope>
"@ 
```

尽管这个问题似乎与 here-string 相关，但这是上下文脚本的其余部分：

```
#----------------------------------------------------------------------
# Variables
#----------------------------------------------------------------------
$pkgID = 346
$pkgNameList = @("Package_ABC", "Package_DEF", "Package_XYZ", "Package_123" )

#Set start/end datestamps
$now= Get-Date
$end = Get-Date "04/03/2013 08:00 AM"

$testDirectory = "C:\Users\UserName\Desktop\AutomatedSOAPTest"
if (!(Test-Path $testDirectory)){
    New-Item $testDirectory -itemType directory | Out-Null
}

#----------------------------------------------------------------------
# Functions
#----------------------------------------------------------------------
#Function to write to SOAP request log
function Write-Log($message)
{
    $logDate = Get-Date -format "MM/dd/yy HH:mm:ss"
    $logPath = "$testDirectory\progress.log"

    Write-Output "$logDate $message" | Out-File -FilePath $logPath -Append
}#end Write-Log function

#Function to write to SOAP return log
function Write-Return($xml, $item)
{
    $logDate = Get-Date -format "MM/dd/yy HH:mm:ss"
    $logPath = "$testDirectory\SOAP_return-$item.log"

    $success = $xml.status.success
    $message = $xml.status.message

    Write-Output "Request returned for $item on $logDate" | Out-File -FilePath $logPath -Append
    Write-Output "Success: $success" | Out-File -FilePath $logPath -Append
    Write-Output $message | Out-File -FilePath $logPath -Append
}#end Write-Log function

#Function to call SOAP request
function Execute-SOAPRequest(
    [Int]    $pkgID,
    [String] $pkgName
)
{
    $SOAPRequest = [xml] @"
        <SOAP request content here>
    "@

    $SOAPurl = "http://<site where requests are sent>"

    Write-Log "Sending SOAP Request for $pkgName To Server: $SOAPurl"
    $soapWebRequest = [System.Net.WebRequest]::Create($SOAPurl)
    $soapWebRequest.Headers.Add("SOAPAction","`"`"")

    $soapWebRequest.ContentType = "text/xml;charset=`"utf-8`""
    $soapWebRequest.Accept      = "text/xml"
    $soapWebRequest.Method      = "POST"

    Write-Log "Initiating Send."
    $requestStream = $soapWebRequest.GetRequestStream()
    $SOAPRequest.Save($requestStream)
    $requestStream.Close()

    Write-Log "Send Complete, Waiting For Response."
    $resp = $soapWebRequest.GetResponse()
    $responseStream = $resp.GetResponseStream()
    $soapReader = [System.IO.StreamReader]($responseStream)
    $ReturnXml = [Xml] $soapReader.ReadToEnd()
    $responseStream.Close()

    Write-Log "Response Received."

    Write-Return $ReturnXml.status.success
    Write-Return $ReturnXml.status.message
}#End Execute-SOAPRequest function

#----------------------------------------------------------------------
# Code
#----------------------------------------------------------------------

while($now -lt $end)
{
    $pkgList = Get-Random -input $pkgNameList -count 4

    foreach($pkgName in $pkgList)
    {
        #Run function to execute SOAP request
        Execute-SOAPRequest $pkgID $pkgName

        $pkgID++
    }

    Start-Sleep -s 3600
    $now = Get-Date
} 
```

Execute-SOAPRequest 函数的代码来自这里：[http ://www.iislogs.com/steveschofield/execute-a-soap-request-from-powershell](http://www.iislogs.com/steveschofield/execute-a-soap-request-from-powershell)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:36:13.763

您的此处字符串中的终止“@”必须从第 1 列开始。

当您将其粘贴到代码中时，它会出现缩进，并且缩进中的前导空格导致解析器继续读取以下代码作为此处字符串的一部分。由于字符串从未正确终止，>> 提示输入此处字符串的更多数据，或终止的“@.

编辑：如果您不想弄乱 Process 块中的缩进，您可以将可扩展的 here-string 作为脚本块移动到 Begin 块中，稍后再调用它：

```
Begin{
$SoapString = {
@"
This is my here-string containing $variable
"@
}
}

Process{
$variable = "MY VARIABLE"

  foreach ($x in 1)
   {
     &$SoapString
    }
}

This is my here-string containing MY VARIABLE 
```

如果你不喜欢让脚本的头部变得杂乱无章，你可以将 Being 块放在底部。Powershell 仍然会按照 Begin、Process、End 的顺序运行它们，无论它们在脚本中的顺序是什么：

```
Process{
$variable = "MY VARIABLE"

  foreach ($x in 1)
   {
     &$SoapString
   }
}

Begin{
$SoapString = {
@"
This is my here-string containing $variable
"@
}
}

This is my here-string containing MY VARIABLE 
```

# c - C fgets。我暂时使用它，但第一次使用它就像它不存在一样

> ID：15770507
> 
> 赞同：0
> 
> 时间：2013-04-02T17:33:26.887
> 
> 标签：c, fgets

我有一个关于 C 编程中 fgets 的问题。

我在 do-while 中的代码（输入示例：A4 N）中使用 fgets() 函数。（以便输入正确）但由于某种原因，第一次就像 fgets() 不存在一样。

为了帮助您理解我，这是运行它后出现的内容。我也尝试使用 scanf() 但失败了..

```
Example of positioning: G3 E
Aircraft carrier (5 places), Give location and direction: 
1
Aircraft carrier (5 places), Give location and direction: 
```

我的代码是：

```
void arrayFill(char **array, int r, int c, int player)
{
char position[10];
printf("\n%s", "Example of positioning: G3 E");
do
{
    printf("\n%s", "Aircraft carrier (5 places), Give location and direction: ");
    fgets(position, 10, stdin);
    printf("\n%s", "1");
}while(validPosition(array, r, c, position, 5) == 2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:59:41.907

这是混合面向场的输入（`scanf()`使用什么）和面向行的输入的一个非常常见的陷阱。面向字段的输入不太关心换行，当你使用类似的东西时

```
scanf("%d", &num); 
```

然后你输入 "42\n" ， "\n" 实际上是留在`stdin`. 您不会在后续`scanf()`调用中注意到它，因为（除了少数例外）`scanf()`将忽略前导空格。

当您`fgets()`一个接一个地`scanf()`打电话时，有一个`'\n'`left on `stdin`，并且`fgets()`很乐意为您接受这个“空行”。编写代码以在完成后忽略一行的其余部分很容易`scanf()`：

```
int ch;
/* call to scanf() */
while ((ch = getchar()) != '\n' && ch != EOF) { /* do nothing */ } 
```

完成此操作后，将不会有任何剩余的换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:54:18.830

问题可能与 '\n' 字符有关。[这里](https://stackoverflow.com/questions/14033477/why-is-the-first-string-ignored-when-reading-with-fgets-from-stdin?rq=1)还有另一个主题可以提供帮助。

# java - 即使在活动重新加载后也提交对组视图的更改

> ID：15770516
> 
> 赞同：0
> 
> 时间：2013-04-02T17:34:03.283
> 
> 标签：java, android

我有一种方法可以将项目添加到`Group View`：

```
void addItem(String name,String quantity,String value,ViewGroup view_group,int index)
    {
        LayoutInflater layoutInflater = (LayoutInflater)myAct.getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        LinearLayout itemLayout = (LinearLayout) layoutInflater.inflate(R.layout.request_object_list, null);

        ((TextView)itemLayout.findViewById(R.id.object_name)).setText(name);

        ((TextView)itemLayout.findViewById(R.id.object_quantity)).setText(quantity);

        ImageButton botaoAdd = ((ImageButton)itemLayout.findViewById(R.id.addButton));
        ImageButton botaoSubtract = ((ImageButton)itemLayout.findViewById(R.id.subtractButton));

        buttons.put(botaoAdd, ((TextView)itemLayout.findViewById(R.id.object_quantity)));
        buttons.put(botaoSubtract, ((TextView)itemLayout.findViewById(R.id.object_quantity)));

        botaoAdd.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {

                ImageButton botao = (ImageButton)arg0;

                TextView textView = buttons.get(botao);

                Integer quantidade = Integer.parseInt(textView.getText().toString());

                quantidade++;

                textView.setText(quantidade.toString());
            }
        });

        botaoSubtract.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {

                ImageButton botao = (ImageButton)arg0;

                TextView textView = buttons.get(botao);

                Integer quantidade = Integer.parseInt(textView.getText().toString());

                if(quantidade != 1)
                    quantidade--;

                textView.setText(quantidade.toString());
            }
        });

        ((TextView)itemLayout.findViewById(R.id.object_value)).setText(value);
        (itemLayout.findViewById(R.id.select_check)).setVisibility(View.VISIBLE);
        (itemLayout.findViewById(R.id.select_check)).setId(index);

        view_group.addView(itemLayout);
    } 
```

如您所见，我有 2 个按钮，可以对`Group View`. 尽管重新加载后`Activity`，组视图的项目与最初添加时的值完全相同。如何提交更改？

# .net - Web 角色中的 app.config 未在 Azure SDK 1.8 和 Visual Studio 2010 中复制

> ID：15770524
> 
> 赞同：1
> 
> 时间：2013-04-02T17:34:22.607
> 
> 标签：.net, visual-studio-2010, azure, azure-web-roles, azure-sdk-.net

正如 Stack Overflow 上的[这些](https://stackoverflow.com/a/15228015/753737) [答案](https://stackoverflow.com/a/14073251/753737)所建议的那样，我已经`app.config`向我的 web 角色添加了一个文件，以便在调用`Role.OnStart`in process期间提供一些绑定重定向`WaIISHost.exe`。

这个技巧在计算模拟器下有效，但是当我在 Azure 上部署托管服务时，我在角色启动时遇到了异常——也就是说，如果我省略该文件`System.IO.FileLoadException`，我会在计算模拟器上遇到同样的情况。`app.config`

我正在使用 Visual Studio 2010 和 Azure SDK 1.8。该解决方案是使用 .NET 4.0 构建的，我有几个用于不同目的的云项目（调试、生产……）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:34:22.607

我分析了`.cspkg`Visual Studio 创建的文件，发现在`bin`web 角色的文件夹中没有`.config`文件（正如链接的答案所建议的那样）。

然后我重命名`app.config`项目中的文件以匹配程序集名称，并将其`Copy local`属性设置为`true`-- 这样我就能够成功部署我的托管服务。

我不知道这种行为是否是由解决方案中存在多个云项目触发的。

# google-app-engine - 如何为 BigQuery 中的嵌套字段指定架构？

> ID：15770528
> 
> 赞同：1
> 
> 时间：2013-04-02T17:34:27.447
> 
> 标签：google-app-engine, schema, google-bigquery, google-cloud-storage

我正在使用的数据有一个嵌套字段“位置”，如下所示：

```
"location": {
    "city": "Amherst",
    "region": "NS",
    "country": "CA"
}, 
```

如何使用 Java API 指定嵌套字段的架构？

目前，我的代码如下所示：

```
List<TableFieldSchema> fields = new ArrayList<TableFieldSchema>();
TableFieldSchema fieldLocation = new TableFieldSchema();
fieldFoo.setName("location");
fieldFoo.setType("record");
TableFieldSchema fieldLocationCity = new TableFieldSchema();
fieldBar.setName("location.city");
fieldBar.setType("string");
...
fields.add(fieldLocation);
fields.add(fieldLocationCity);
TableSchema schema = new TableSchema();
schema.setFields(fields); 
```

这不起作用，因为我收到以下错误：

```
CONFIG: {
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "invalid",
    "message": "Record field location must have a schema."
   }
  ],
  "code": 400,
  "message": "Record field location must have a schema."
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:28:04.143

我认为您想要执行以下操作：

```
List<TableFieldSchema> inner = new ArrayList<TableFieldSchema>();
List<TableFieldSchema> outer = new ArrayList<TableFieldSchema>();

TableFieldSchema fieldLocationCity = new TableFieldSchema();
fieldLocationCity.setName("city");
fieldLocationCity.setType("string");
// Add the inner fields to the list of fields in the record.
inner.add(fieldLocationCity);
...(add region & country, etc)...

TableFieldSchema fieldLocation = new TableFieldSchema();
fieldLocation.setName("location");
fieldLocation.setType("record");
// Add the inner fields to the location record.
fieldLocation.setFields(inner);

outer.add(fieldLocation);

TableSchema schema = new TableSchema();
schema.setFields(outer); 
```

# android - 有没有办法隐藏 NumberPicker 中的上限值和下限值

> ID：15770530
> 
> 赞同：15
> 
> 时间：2013-04-02T17:34:37.143
> 
> 标签：android

我想用[这个 NumberPicker](https://github.com/SimonVT/android-numberpicker)（因为默认的不是太多可定制的），但我想隐藏上层和下层，只显示中间行......这可能吗？我也尝试删除 fadingEdges 但是，当我阅读时，它是一个已弃用的属性；甚至 overScrollMode 也不起作用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T18:27:21.150

> 我想隐藏上下层，只显示中间行……这可能吗？

查看源代码，您可以尝试几件事。最简单的方法是将以下常量更改为`1`，因为它控制选择器“wheel”中显示的项目数：

```
private static final int SELECTOR_WHEEL_ITEM_COUNT = 3; 
```

如果这不起作用，您可以修改绘图例程以跳过不在中心行中的任何索引。您需要查看[第 1468 - 1482 行](https://github.com/SimonVT/android-numberpicker/blob/master/library/src/net/simonvt/numberpicker/NumberPicker.java#L1468)。

我不确定你想对褪色边缘说什么，但如果你想删除它们，它可能就像`0`在这两种方法中返回一样简单，在[第 1426 - 1434 行](https://github.com/SimonVT/android-numberpicker/blob/master/library/src/net/simonvt/numberpicker/NumberPicker.java#L1426)：

```
@Override
protected float getTopFadingEdgeStrength() {
    return TOP_AND_BOTTOM_FADING_EDGE_STRENGTH;
}

@Override
protected float getBottomFadingEdgeStrength() {
    return TOP_AND_BOTTOM_FADING_EDGE_STRENGTH;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-04-13T12:00:12.280

不幸的是，我发现没有办法这样做......对于那些想要替代解决方案的人......我应用了 Viewpager 而不是数字选择器来使其垂直我尝试了[链接](https://medium.com/@jimitpatel/viewpager-with-vertical-swiping-ability-e40200094281)并应用了 Onpagechangelistner。干脆...

# python - Python Mechanize文件上传不断上传1kb文件

> ID：15770534
> 
> 赞同：2
> 
> 时间：2013-04-02T17:34:42.620
> 
> 标签：python, file, upload, mechanize

这就是我初始化机械化浏览器的方式

```
# Browser
br = mechanize.Browser()
# Cookie Jar
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

# Browser options
br.set_handle_equiv(True)
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False) 
```

登录并移动到上传页面后，我使用此代码上传

它有效，只是它不断上传的图像总是不完整，大小为 1kb -.-

```
br.select_form(nr=0)
filepath = 'C:\Users\myusernamelol\Desktop\d6sEz.jpg'

br.form.add_file(open(filepath), 'text/plain', 'd6sEz.jpg', nr=0, name='file[]')

br.submit() 
```

是什么让 mechanize 不上传完整图像？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T18:24:16.997

尝试以二进制模式打开文件：

```
br.form.add_file(open(filepath, 'rb'), 'text/plain', 'd6sEz.jpg', nr=0, name='file[]') 
```

而且，替换`text/plain`为`image/jpeg`

# python - for 循环：范围（sth） sth 正在增加。这是错的吗？

> ID：15770537
> 
> 赞同：0
> 
> 时间：2013-04-02T17:35:07.420
> 
> 标签：python, loops, range

```
for j in xrange(len(self.segments)):
    *
    ***some code here*** 
    *
    if (****condition*****):
        self.segments.append(segB) 
```

所以，我有一个 for 循环和 xrange(self.segments)，其中 self.segments 正在增加！你觉得有问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:35:58.680

您不会遍历与您添加的元素相对应的索引，因为`xrange`在循环*开始*时进行评估。之后不会重新评估它。

这是否错误完全取决于您要做什么。如果你想遍历列表的元素（并且你想捕捉你正在添加的元素），那么你可能会逃脱：

```
for item in self.segments:
    #...
    if whatever:
        self.segments.append(segB) 
```

这是因为列表以可预测的方式迭代。`.insert`这仅在您添加到列表末尾时才有效——如果您在中间的某个地方提供数据，则不一定有效。

# c# - 等待 .NET 线程启动的正确方法是什么？

> ID：15770538
> 
> 赞同：2
> 
> 时间：2013-04-02T17:35:09.910
> 
> 标签：c#, multithreading, doevents

我在微软网站的线程教程中阅读了以下内容：

[http://msdn.microsoft.com/en-us/library/aa645740(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa645740%28v=vs.71%29.aspx)

MSDN 建议使用以下方法等待线程变为活动状态：

```
while (!oThread.IsAlive); 
```

这是推荐的等待方式吗？插入“DoEvents”调用以允许主线程保持响应会更好吗？如果出现问题并且线程永远不会“活着”，应该如何进行错误处理？如果这是不好的做法，什么时候最好使用 IsAlive？

一些版主已将此标记为重复，但他们引用的另一个问题没有提及有关 IsAlive、DoEvents 或线程无法启动时的正确错误处理的任何内容。我的问题与我在问题中链接到的 MSDN 文章及其建议使用 IsAlive 的繁忙循环特别相关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T11:07:56.127

看到还没有官方的答案……你在 MSDN 上看到的是 2003 年的，这是比较老的技术。对于您想做的事情，我会使用[Task Parallel Library (TPL)](http://msdn.microsoft.com/en-gb/library/dd460717.aspx)。这需要 .NET 框架 4.0+。

有关如何根据需要使用 TPL 的精彩教程，请参阅：

1.  [n 的并行任务 1](http://www.codeproject.com/Articles/152765/Task-Parallel-Library-1-of-n)。

2.  [J. Albahari 在 C# 中的线程](http://www.albahari.com/threading/)。

一旦您掌握了 TPL，请随时返回并寻找提出特定问题。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T11:16:09.347

除了 Killercam 的回答，我想指出链接页面上的示例代码是垃圾。看起来有人被告知“创建一个仅显示我们在一个页面上拥有的所有不同方法的示例”。它真的是这样出来的......

在进行线程处理时，您几乎从不在轮询循环中等待。尤其是没有任何等待的紧张。它们会使 CPU 变热，不可靠，如果您在那里休眠，则具有高延迟，并且有更好的方法来做到这一点。自旋循环适用于知道他们在非常具体的情况下正在做什么的专家。

等待线程“活着”是没有意义的。为什么有人会在真实代码中这样做？这甚至不意味着您的线程 proc 已经开始执行（真的！它没有。）。

我建议你使用现代范式。TPL 是一个很好的起点。请参阅 Killercam 的答案。

# api - 如何使用 Oauth2 和 YouTube API v3 上传到特定的 YouTube 频道

> ID：15770541
> 
> 赞同：2
> 
> 时间：2013-04-02T17:35:16.383
> 
> 标签：api, oauth, upload, youtube

我正在按照 YouTube 的 API V3 指南使用 Oauth2 上传视频：

[https://developers.google.com/youtube/v3/guides/uploading_a_video](https://developers.google.com/youtube/v3/guides/uploading_a_video)

但是，我不清楚如何上传到特定用户的频道。该指南允许在一个地方指定客户端 ID、客户端密码 ID，我两者都有。

我还有一个访问令牌和刷新令牌，用于授权上传到特定频道，但我没有看到我的访问令牌包含在哪里。

请阐明一些观点；）

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T20:32:17.627

[YouTube API 文档](https://developers.google.com/youtube/v3/docs/)列出了您可以发送访问令牌的两种方式：

> API 支持 OAuth 2.0 身份验证协议。您可以通过以下任一方式提供 OAuth 2.0 令牌：
> 
> *   像这样使用 access_token 查询参数：?access_token=oauth2-token
> *   像这样使用 HTTP Authorization 标头： Authorization: Bearer oauth2-token
> 
> 有关在您的应用程序中实施 OAuth 2.0 身份验证的完整说明，请参阅[身份验证指南](https://developers.google.com/youtube/v3/guides/authentication)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-30T02:03:06.053

本月早些时候我问过自己同样的事情，我发现的答案是您不需要在请求中添加频道。实际上，当您询问 OAuth2 凭据时，系统会提示您选择一个通道，并且该通道与您获得的凭据相关联。因此，当您上传视频时，频道将由您使用的访问令牌确定。

因此，如果您想使用不同的通道，则需要获取该其他通道的凭据，但没有选项可以将其指定为参数。如果您需要在频道之间切换，这篇[文章](https://youtube-eng.googleblog.com/2013/06/google-page-identities-and-youtube-api_24.html)非常有趣。

我希望这会*照亮*你的道路;-)

# javascript - 从 div 或模板中获取所有车把表达式？

> ID：15770545
> 
> 赞同：1
> 
> 时间：2013-04-02T17:35:26.507
> 
> 标签：javascript, jquery, ember.js, handlebars.js

我有一个车把模板，我只想从 div 中获取所有车把表达式？

**html代码**

```
 <div id="comp_login_i18n">
        <form name="loginForm">
            <table>
                <tr class="requiredField">
                    <td>
                        <label>{{content.token1Label}}</label>
                    </td>
                    <td >
                        <input type="text">
                    </td>
                </tr>

                <tr class="requiredField">
                    <td>
                        <label>{{content.token2Label}}</label>
                    </td>
                    <td>
                        <input type="text">
                    </td>
                </tr>
                <tr>
                    <td class="tableWidth" colspan="2">
                        <button {{action submitForm}} class="submit" type="button">{{content.button}}</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>

</script> 
```

我正在编写一个方法，该方法从该 div 获取所有车把表达式并根据所选语言更改标签。我不知道如何在这个 div 中获取车把表达式。任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:35:04.570

我建议不要尝试即时构建模板文件。最好在模板的上下文中注入“i18n”属性，并根据您选择的语言进行更改。

服务器端伪代码：

```
language = getUserLanguage();//user's desired language
data = ...; //data that is needed for your templates (other that i18n stuff)
data.i18n = getStringsForLanguage(language);//get strings for selected language
render(template, data);//invoking template rendering 
```

模板：

```
...
<label>{{i18n.token1Label}}</label>
... 
```

然后，您需要在某处为每种语言定义字符串（以进入`getStringsForLanguage`）f.ex：

字符串：

```
token1Label = This is token1Label in English 
```

de.strings：

```
token1Label = This is token1Label in German 
```

# c# - ASP.NET MVC 项目 EF 存储库模式

> ID：15770547
> 
> 赞同：6
> 
> 时间：2013-04-02T17:35:27.540
> 
> 标签：c#, asp.net-mvc, dependency-injection

如果我在 ASP.NET MVC 应用程序中使用存储库模式，我需要 DI 让程序知道，接口必须映射类。如果我实现 Unity，我需要将 DAL 项目添加到我的 MVC 项目中，然后在 global.asax 中注册类型。

在我看来，我认为将 DAL 层的命名空间添加到 MVC 项目中是不好的，中间还有一个业务层。我认为，在业务层中注入 DAL 类并且只在 MVC 应用程序中注入业务层映射会很漂亮。

去这里的路是什么？你有什么建议吗？

更新：让我清楚。在服务层，只有 DTO 和业务和数据访问层的 DI。在服务层中，我将 DTO 映射到域模型。我不明白的是，我怎么能调用业务层方法呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:40:17.483

如果要务实，真正的 3 层架构需要一个服务层。服务和 MVC 之间是数据传输对象 (DTO)。服务层隐藏了 DAL 和业务层。

如果你这样设置，MVC 本身对 DAL 一无所知，只知道 DTO 和服务（合同）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T17:55:26.677

即使您不使用不同的服务层，您也可以完成您想要的，即使用 DI 将 MVC 应用程序与 DAL 项目解耦。

实现这一点的方法是在它们之间添加几个项目/程序集，将 IoC 容器与您定义的接口的特定实例连接起来。

我通常使用这个命名约定：

*   MyCompany.MyProject.Infrastructure

*   MyCompany.MyProject.Abstract

然后，您的主 MVC 项目将引用您的 Abstract 和 Infrastructure 项目。您的基础设施项目将引用抽象和实例特定项目，如业务和 DAL 项目。在基础架构项目中，您可以连接依赖项。

您必须为您的 MVC 项目设置一种机制，以在 Infrastructure 程序集中引导您的 IoC。您可以在 global.asax 中或作为 App_Start 方法执行此操作，并在基础结构程序集中调用 Registration 类。

我们使用的是 StructureMap，但概念是一样的。这是一些示例代码。

在您的 MVC 应用程序中，创建一个 App_Start 方法来设置 DI。

```
public static class StructuremapMvc
{
    public static void Start()
    {

        // Create new Structuremap Controller factory so Structure map can resolve the parameter dependencies.
        ControllerBuilder.Current.SetControllerFactory(new StructuremapControllerFactory());

        IContainer container = IoC.Initialize();

        DependencyResolver.SetResolver(new StructureMapDependencyResolver(container));

        GlobalConfiguration.Configuration.DependencyResolver = new StructureMapDependencyResolver(container);
    }
} 
```

在您的基础设施程序集中，连接依赖项。

```
public static class IoC
{
    public static IContainer Initialize()
    {
        ObjectFactory.Initialize(x =>
                    {
                        x.Scan(scan =>
                                {
                                    scan.TheCallingAssembly();
                                    scan.WithDefaultConventions();
                                });
                        x.For<IRepositoryNum1>().Use<Num1Repository>();
                        x.For<IRepositoryNum2>().Use<Num2Repository>();
                        x.For<IRepositoryNum3>().Use<Num3Repository>();
                    });

        return ObjectFactory.Container;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:45:10.683

您应该使用 DI 将 Domain/DAL 接口注入到您的构造函数中。这有很多好处，包括允许您在编写单元测试时自定义接口。您可以使用 Autofac 来处理注入。

# mysql - MySQL - 遍历行

> ID：15770552
> 
> 赞同：3
> 
> 时间：2013-04-02T17:35:49.620
> 
> 标签：mysql, sql, database, loops, rows

我有以下代码

```
select count(*)
from (select Annotations.user_id
from Annotations, Users
where Users.gender =  'Female'
and Users.user_id = Annotations.user_id
and image_id = 1
group by Annotations.user_id
having sum(case when stem = 'taxi' then 1 else 0 end) > 0 and
       sum(case when stem = 'zebra crossing' then 1 else 0 end) > 0
) Annotations 
```

它会计算有多少女性给了图像 1 的茎“出租车”和“斑马线”。

样本数据

```
 user id, image id, stem
 1           1      image
 1           1      taxi
 1           1      zebra crossing
 2           1      person
 2           1      zebra crossing
 2           1      taxi
 3           1      person
 3           1      zebra crossing 
```

预期结果（或类似）

```
stem1,  stem2,            count
taxi ,  zebra crossing      2
person, zebra crossing      2 
```

但是，由于有 2000 多个词干，我无法全部指定。

我将如何使用 image_id = 1 和性别 = 女性而不是指定词干字符串来遍历词干行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:04:43.380

**更新：**据我了解，您想要选择 2 个词干的所有组合，并计算有多少用户拥有该词干组合。这是我的解决方案：

```
SELECT stem1, stem2, count(*) as count FROM
(
    SELECT a.user_id,a.image_id,a.stem as stem1,b.stem as stem2
    FROM Annotations a JOIN Annotations b
    ON a.user_id=b.user_id && b.image_id=a.image_id && a.stem!=b.stem
    JOIN Users ON Users.user_id = a.user_id
    WHERE Users.gender = "Female"
) as stems GROUP BY stem1, stem2 having count > 1 WHERE image_id=1; 
```

这里需要注意的是，它将为每个词干组合返回 2 行。（第二次出现的词干顺序相反）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T18:04:52.387

~~据我了解，您需要获取拥有`2 or more stems`~~

**更新：**似乎您需要显示具有另一个用户使用的词干的用户，我已经更新了相同的查询

```
 SELECT
    distinct a.user_id,
    group_concat(DISTINCT a.stem ORDER BY a.stem)
 FROM
    Annotations a 
    JOIN Users u ON ( a.user_id = u.user_id AND u.gender =  'Female' )
    JOIN 
        (
            SELECT 
                b.user_id,
                b.stem
            FROM
                Annotations b
        ) AS b ON ( a.user_id <> b.user_id AND b.stem = a.stem )
 WHERE
    a.image_id = 1
GROUP BY
  a.user_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T20:08:55.280

这是我解决您的问题的尝试：

```
SELECT COUNT(*) AS Count, a1.stem AS Stem1, a2.Stem AS Stem2 
FROM Annotations AS a1
INNER JOIN Annotations AS a2 ON a1.user_id = a2.user_id AND a1.image_id = a2.image_id
                          AND a1.stem < a2.stem 
WHERE a1.image_id = 1
GROUP BY a1.stem, a2.Stem
HAVING COUNT(*) > 1; 
```

我没有包括`image_id`逻辑。

请在此处查看我的 SQL Fiddle： [http ://sqlfiddle.com/#!2/4ee69/33](http://sqlfiddle.com/#!2/4ee69/33)

根据以下数据（从您的数据中复制），我得到了发布在其下方的结果。

```
CREATE TABLE Annotations
    (`user_id` int, `image_id` int, `stem` varchar(14))
;

INSERT INTO Annotations
    (`user_id`, `image_id`, `stem`)
VALUES
    (1, 1, 'image'),
    (1, 1, 'taxi'),
    (1, 1, 'zebra crossing'),
    (2, 1, 'person'),
    (2, 1, 'zebra crossing'),
    (2, 1, 'taxi'),
    (3, 1, 'person'),
    (3, 1, 'zebra crossing')
; 
```

 ````
 COUNT STEM1   STEM2
    2   person  zebra crossing
    2   taxi    zebra crossing 
````

# jquery - 使用 Cycle2 链接幻灯片

> ID：15770558
> 
> 赞同：1
> 
> 时间：2013-04-02T17:36:02.110
> 
> 标签：jquery, jquery-plugins, cycle, jquery-cycle2

我正在寻找一种使用 Cycle2 将幻灯片链接在一起的方法。我知道在原来的 Cycle 中有一种方法可以做到这一点，但是新的 API 有很大的不同。

基本上，我需要 2 个单独的区域来播放不同的幻灯片，但我需要将它们链接起来，这样如果我要在一个幻灯片上单击下一步，另一个也会前进。这也适用于寻呼机；当我尝试`data-cycle-pager="#pager"`在两个幻灯片上使用时，寻呼机被复制，并且事情开始中断。

对此的任何运气都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T19:20:04.130

我会做以下事情：

1.  将下一个/上一个添加到其中一个幻灯片
2.  挂钩到该幻灯片的事件后并手动更改另一个滑块。

这是代码：http: [//jsfiddle.net/lucuma/tQ4Jj/4/](http://jsfiddle.net/lucuma/tQ4Jj/4/)

HTML：

```
<div id="slideone" class="cycle-slideshow item" data-cycle-timeout="3000" data-cycle-speed="300" data-cycle-slides="> div.cycle-slide" data-cycle-fx="fade" data-cycle-pager-template="<a href='#'>{{cycleTitle}}</a>">

    <div class="cycle-slide"  data-cycle-title="Title 1" >
        <img src="http://placehold.it/550x550/" />
        <h2>My title 1</h2>
    </div>
    <div class="cycle-slide">
        <img src="http://placehold.it/550x550/ff0000" data-cycle-title="Title 2" /> 
<h2>My title 2</h2>
    </div>
    <div class="cycle-slide" data-cycle-title="Title 3">
        <img src="http://placehold.it/550x550/" />
<h2>My title 3</h2>
    </div>

     <a class="cycle-prev">Prev</a>&nbsp;&nbsp;<a class="cycle-next">Next</a>
</div>

<br /><br /><br /><br /><br />
<div id="slidetwo"  class="cycle-slideshow item" data-cycle-timeout="3000" data-cycle-speed="300" data-cycle-slides="> div.cycle-slide" data-cycle-fx="fade" data-cycle-paused="true">

    <div class="cycle-slide"  data-cycle-title="Title 1" >
        <img src="http://placehold.it/550x550/" />
        <h2>My title 1</h2>
    </div>
    <div class="cycle-slide">
        <img src="http://placehold.it/550x550/ff0000" data-cycle-title="Title 2" /> 
<h2>My title 2</h2>
    </div>
    <div class="cycle-slide" data-cycle-title="Title 3">
        <img src="http://placehold.it/550x550/" />
<h2>My title 3</h2>
    </div>

</div> 
```

JS：

```
$( '#slideone' ).on( 'cycle-next', function( event, opts ) {
   $('#slidetwo').cycle('next'); 
});

$( '#slideone' ).on( 'cycle-prev', function( event, opts ) {
    $('#slidetwo').cycle('prev');
}); 
```

# java - 装箱到 Object 类型以避免编译失败

> ID：15770562
> 
> 赞同：3
> 
> 时间：2013-04-02T17:36:12.323
> 
> 标签：java, java-7, autoboxing

考虑以下代码

```
public class Foo
{

  int value;
  public Foo (final String str, Object ... bug)
  {
    System.out.println ("Should work! 1");
  }

  public Foo (final String str, final int value, Object ... bug)
  {
     this.value = value;
    System.out.println ("Should work! 2");
  }

  public static void main (String[]args)
  {
    Foo f = new Foo ("Foo", 3); //Line 14
    System.out.println(f.value);
  }
} 
```

当我使用 jdk-1.6.x 时，我成功地编译了它。但是在升级到 jdk-1.7 时它给了我错误：

`Foo.java:18: error: reference to Foo is ambiguous, both constructor Foo(String,Object...) in Foo and constructor Foo(String,int,Object...) in Foo match Foo f = new Foo ("Foo", 3); //Line 14`

所以为了避免这个错误，我将第二个 Ctor 更改为

```
 public Foo (final String str, final Integer value, Object ... bug)
  {
     this.value = value;
    System.out.println ("Should work! 2");
  } 
```

这样它就可以自动装箱为 Integer 并跳过编译错误。

几个问题：
1）这是一个好习惯吗？如果没有那么还有其他方法吗？
2）为什么java开发人员会决定给出错误而不是允许它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:50:48.673

这是设计使然，也是 Java 6 和 Java 7 之间已知的不兼容区域，因为重载解析算法在 Java 7 中已修复。在 Java 5 和 6 中，以下代码无法编译：

```
class Test {
    void foo(int... i) {}
    void foo(double... d) {}

    void test() {
       foo(1,2,3);
    }
} 
```

编译器会抱怨调用不明确。但这不是真的，因为`double`它比更通用`int`，因此`int`在这种情况下是最具体的选项。

但是，此修复导致不兼容（查看[发行说明](http://www.oracle.com/technetwork/java/javase/compatibility-417013.html#jdk7)；搜索“varargs”）。结果是你不能选择最具体的方法`int`，`Object`因为两者都不是另一个的子类型。所以这不应该编译。但是，您可以使用`Integer`, 因为`Integer`是 的子类型，`Object`在这种情况下它是最具体的选项，因此编译器可以选择它。

发行说明中的​​相关部分：

> 虽然`javac`编译器接受的代码比 JDK 7 之前的代码多，但在以下情况下，此修复也会导致轻微的源不兼容：

```
class Test {
    void foo(int... i) {}
    void foo(Object... o) {}

    void test() {
       foo(1,2,3);
    }
} 
```

> 此代码在 JDK 6 中编译（最具体的方法是`foo(int...)`）。此代码无法在 JDK 7 下编译。根据[15.12.2.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2.5)，无法在 和 之间进行选择`foo(int...)`，`foo(Object...)`因为既不`int`是 的子类型`Object`，也不`Object`是 的子类型`int`。这个程序应该被禁止（事实上，它一开始就不应该被允许）。
> 
> 不兼容的性质：行为和来源
> 
> 射频：[6199075](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6199075)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T18:01:46.607

> 为什么java开发人员会决定给出错误而不是允许它？

[由于在 JDK 7 中感知](http://docs.oracle.com/javase/7/docs/technotes/guides/language/non-reifiable-varargs.html)var-args 的方式发生了变化，因此发生错误。

> 1）这是一个好习惯吗？如果没有那么还有其他方法吗？

虽然您可以使用整数来解决这个问题，但类 Foo 最初有一个 int 作为其成员变量，我会保持这种状态。请注意，`Integer value;`现在可以接受 null。检查代码中的 null 并用于`value.intValue()`将值分配给成员变量。

未捕获的 NPE 和性能是自动装箱/拆箱的大麻烦。

# python - Else 语句仅在循环 Python 中执行 1 次

> ID：15770568
> 
> 赞同：0
> 
> 时间：2013-04-02T17:36:25.857
> 
> 标签：python

我有这个代码

```
def filtraValoraciones (nomFichero = "valoraciones.data"):
# Se crea el archivo de salida
crearArchivoValoracionesFiltradas()
contadorLineasTotal = 0
contadorLineasValidas = 0
lineas = [(l.strip()).split("\t") for l in (open(nomFichero).readlines())]
for l in lineas:
    contadorLineasTotal = contadorLineasTotal + 1
    # Se lee Usuario, Restaurante, Precio y Calidad
    idUsuari = int(l[0])
    idRestaurant = int(l[1])
    precio = round(float(l[2]),2)
    calidad = round(float(l[3]),2)
    if (idUsuari >= 0 and idUsuari <= 99) and (idRestaurant >= 0 and idRestaurant <= 49) and precio > 0.00 and (calidad >= 0.0 and calidad <= 10.00):
        # Tiene valores coherentes --> se vuelcan a otro fichero
        cadena = str(idUsuari) + "    " + str(idRestaurant) + "    " + str(precio) + "    " + str(calidad) + "\n"
        salida = open('valoracionesFiltradas.data','a')
        salida.write (cadena);
        salida.close()
        contadorLineasValidas = contadorLineasValidas + 1
    else:
        cadena2 = str(idUsuari) + "    " + str(idRestaurant) + "    " + str(precio) + "    " + str(calidad) + "\n"
        print cadena2

print "El numero de valoraciones filtradas han sido: " + str(contadorLineasTotal-contadorLineasValidas) 
```

当我执行此操作时，如果语句对 lineas.len 正常工作，但 else 语句似乎执行了 1 次，而不是 (contadorLineasTotal-contadorLineasValidas) 次。

有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:45:17.783

该`else`行用空格缩进，而该`if`行用制表符缩进。从 Python 的角度来看，这两个缩进可能不匹配，因此`else`与 that 不匹配`if`。可能它与`for`([也可以有一个`else`块](http://docs.python.org/2/reference/compound_stmts.html#for)) 在同一个缩进上。

使用一致的缩进来避免此类问题。`-t`当使用制表符和空格缩进时，您还可以使用标志运行 python以获取警告。

# matlab - 你如何创建一个 3d 数组来增加 Matlab 中每一层的值？

> ID：15770569
> 
> 赞同：1
> 
> 时间：2013-04-02T17:36:28.827
> 
> 标签：matlab, multidimensional-array

即，一个 3d 矩阵，其中每层上的所有值都相同，但每张纸上的值随着层数的增加而增加。

例如，增量可以由 x = (0:0.5:2*pi) 定义。

我尝试过使用 repmat，但这似乎只会产生另一个方向的矩阵。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T18:20:10.260

另一种可能性：使用`ndgrid`，这里用于创建一个 4×5×#x 数组：

```
x = 0:0.5:2*pi;

[~,~,out] = ndgrid(1:4,1:5,x); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:46:25.220

您可以使用`repmat`and执行此操作`permute`：

```
x = (0:0.5:2*pi);
y = repmat(x',[1,5,5]);
z = permute(y,[2,3,1]);
size(z)
ans =

    5    5   13

z(:,:,1)
ans =

   0   0   0   0   0
   0   0   0   0   0
   0   0   0   0   0
   0   0   0   0   0
   0   0   0   0   0

z(:,:,2)
ans =

   0.50000   0.50000   0.50000   0.50000   0.50000
   0.50000   0.50000   0.50000   0.50000   0.50000
   0.50000   0.50000   0.50000   0.50000   0.50000
   0.50000   0.50000   0.50000   0.50000   0.50000
   0.50000   0.50000   0.50000   0.50000   0.50000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:57:35.940

定义 x

```
x = (0:0.5:2*pi); 
```

这将具有沿行（第二维）变化的值。将您的 x 更改为沿您想要的维度（第 3 维度）变化：

```
x = permute(x, [1, 3, 2]); 
```

然后重新格式化它：

```
x = repmat(x, [3, 3, 1]); 
```

# vba - 如何计算宏中的非空单元格

> ID：15770574
> 
> 赞同：0
> 
> 时间：2013-04-02T17:37:03.837
> 
> 标签：vba, excel, cell

嗨，我想出了一个打开多个工作簿的代码。代码是

```
Sub OPEN_hari()
Dim r As Long
For r = 1 To 10
    Workbooks.Open Filename:=Sheet2.Cells(r, 1).Value
Next r
End Sub 
```

但这里的问题是，如果只有 3 个单元格 ((1,1) (2,1) (3,1)) 具有工作簿文件的路径，则会抛出无法打开“”文件的错误消息。我怎样才能使这个宏只打开没有错误消息提到的文件。因为我是初学者，所以非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:24:41.687

有两种方法可以满足您的需求：

1.  运行一个无限循环，检查单元格是否为空：

    ```
    Dim i as Long: i = 0 

    While Not IsEmpty(Sheet1.Cells(i + 1, 1)) 'assuming the value is in Column A
        'your code
        i = i + 1 
    Wend 
    ```

2.  获取已使用的行数，但存在可能已使用单元格但现在没有数据的风险，因此我将检查：

    ```
    Dim ur as Long: ur = Sheet1.UsedRange.Rows.Count
    Dim i as Long

    For i = 0 to (ur - 1)
         If LenB(Sheet1.Cells(i + 1, 1).Value) > 0 then
            'your code
         End If 
    Next i 
    ```

# thread-safety - boost::condition_variable 线程安全？

> ID：15770578
> 
> 赞同：1
> 
> 时间：2013-04-02T17:37:25.343
> 
> 标签：thread-safety, boost-thread

[这个关于条件变量](http://www.boost.org/doc/libs/1_43_0/doc/html/thread/synchronization.html#thread.synchronization.condvar_ref)的 boost 示例表明互斥锁不必在调用`cond.notify_one()`. 这是否意味着这`boost::condition_variable`是线程安全的？即如果“准备数据”线程释放互斥锁并尝试调用`cond.notify_one()`，而另一个线程现在获取释放的互斥锁并同时尝试调用会发生`cond.wait(...)`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T04:24:45.350

该示例并不意味着这`boost::condition_variable`是线程安全的。尽管如此，、 、`wait`和`wait_for`是线程 安全的成员函数。`wait_until``notify_one``notify_all`

Boost.Thread 记录了其[对 C++11 标准线程库的一致性和扩展](http://www.boost.org/doc/libs/1_53_0/doc/html/thread/compliance.html#thread.compliance.cpp11)。它列出了条件变量、Class`condition_variable`和 Class`condition_variable_any`以符合要求。

标准的相关部分（§ 30.5-2）规定：

> 条件变量允许同时调用、`wait`、`wait_for`和`wait_until`成员函数。`notify_one``notify_all`

# mysql - SQL 重命名 NULL

> ID：15770580
> 
> 赞同：0
> 
> 时间：2013-04-02T17:37:30.790
> 
> 标签：mysql, sql, database

我现在搜索并尝试了很多，以弄清楚如何在运行此查询时替换表中的名称“NULL”：

```
SELECT 
YEAR(orderdate) AS Years,
       (CASE WHEN country = 'US' THEN 'US' ELSE 'WORLD' END) AS region,
   SUM(netamount) AS TotSales
FROM orders o JOIN
     customers c 
     ON o.customerid = c.customerid
GROUP BY  (CASE WHEN country = 'US' THEN 'US' ELSE 'WORLD' END),YEAR(orderdate) WITH ROLLUP; 
```

我得到这张表：http: [//imgur.com/pzHa8fK](http://imgur.com/pzHa8fK)

我想将 Null 分别替换为 'SubTotal' 和 'GrandTotal'。我试过了：

```
COALESCE(year(orderdate), 'Subtotal') years,... 
```

和 'IFNULL(...)' 相同，但不是替换名称，而是创建一个额外的列，其中包含所有年份，并且 NULL 仍然保留。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:40:36.237

您可以这样做的一种方法是将查询包装在另一个选择中，然后用 a或表达式替换`null`值：`COALESCE``CASE`

```
select 
    case 
        when Years is null and region is null then 'GrandTotal'
        when Years is null then 'SubTotal' 
        else Years end Years,
    coalesce(region, '') region,
    TotSales
from
(
    SELECT YEAR(orderdate) AS Years,
       (CASE WHEN country = 'US' THEN 'US' ELSE 'WORLD' END) AS region,
       SUM(netamount) AS TotSales
    FROM orders o JOIN
         customers c 
         ON o.customerid = c.customerid
    GROUP BY  (CASE WHEN country = 'US' THEN 'US' ELSE 'WORLD' END),YEAR(orderdate) WITH ROLLUP
) d 
```

请注意，我使用的是`CASE`表达式，因为您要比较多个列。

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/a84ae/2)

# hyperlink - 角度指令编译顺序

> ID：15770581
> 
> 赞同：3
> 
> 时间：2013-04-02T17:37:35.317
> 
> 标签：hyperlink, compilation, angularjs, directive

我试图编写一个简单的指令来生成（可能）更复杂的 dom 元素。我对这里发生的事情感到很困惑，但我认为我在指令中使用的指令首先被链接？无论如何，我正在生成的元素在它应该出现的地方是不可见的。

对不起，所有的混乱，这里是 plunkr： [http ://plnkr.co/edit/vWxTmA1tQ2rz6Z9dJyU9?p=preview](http://plnkr.co/edit/vWxTmA1tQ2rz6Z9dJyU9?p=preview)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T04:25:32.410

> 我认为我在指令中使用的指令首先被链接？

是的。子指令的链接函数将在父指令的链接函数之前执行。

这是一个显示两个嵌套指令的[小提琴](http://jsfiddle.net/mrajcok/xfh3F/)，

```
<div d1>
  <div d2></div>
</div> 
```

它记录指令的控制器和链接函数何时被调用。

* * *

您的 Plunker 存在一些问题：

由于您使用`@`的是隔离范围，因此您需要在属性值中使用 {{}}：

```
<visible value='{{visible}}'>plop</visible>
<invisible value='{{visible}}'>plop</invisible> 
```

由于`$scope.visible`在您的控制器中定义，我假设您打算使用该值，而不是`test`.

在`invisible`指令中，您需要`value`在链接函数中使用隔离范围属性。属性`visible`可用于嵌入范围（如果您`template`在 @Langdon 之类的指令中使用 a 则该属性有效），但隔离范围不可用，这是链接函数所看到的。

```
var template = "<span ng-show='value'>{{value}}</span>"; 
```

[笨蛋](http://plnkr.co/edit/p7EmUctUIovk1PDpm3if?p=preview)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T19:03:42.567

如果你想要一个*简单*的指令，你最好让 Angular 通过`ngTransclude`, 和`$watch`.

**[http://plnkr.co/edit/xYTNIUKYuHWhTrK80qKJ?p=preview](http://plnkr.co/edit/xYTNIUKYuHWhTrK80qKJ?p=preview)**

HTML：

```
 <!doctype html>
      <html ng-app="app">
      <head>
        <meta charset="utf-8">
        <title>trying to compile stuff</title>
        <script src="http://code.angularjs.org/1.1.1/angular.js"></script>
        <script src="app.js"></script>
      </head>
      <body>
          <div ng-controller="AppCtrl">
            <input type="checkbox" ng-model="test" id="test" /><label for="test">Visibility (currently {{test}})</label>
            <br />
            <br />
            <visible value='test'>visible tag</visible>
            <invisible value='test'>invisible tag</invisible>
          </div>
      </body>
      </html> 
```

JavaScript：

```
angular
  .module('app', [])
  .controller('AppCtrl', function($scope) {
    $scope.test = false;
  })
  .directive('visible', function() {
    return {
      restrict: 'E',
      transclude: true,
      template: '<span ng-transclude></span>',
      replace: true,
      scope: {
        value: '='
      },
      link: function(scope, element, attrs) {
        console.log(attrs);

        scope.$watch('value', function (value) {
          element.css('display', value ? '' : 'none');
        });

        console.log(attrs.value);
      }
    };
  })
  .directive('invisible', function() {
    return {
      restrict: 'E', 
      transclude: true,
      template: '<span ng-transclude></span>',
      replace: true,
      scope: {
        value: '='
      },
      link: function(scope, element, attrs) {
        scope.$watch('value', function (value) {
          element.css('display', value ? 'none' : '');
        });
      }
    };
}); 
```

# php - 如何在 for 循环中使用计数器作为变量扩展？

> ID：15770583
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:37:44.363
> 
> 标签：php, for-loop

这是我的代码

```
for ($m = 1; $m <= $j; $m++)
    {
        if ($_POST['item_id".$m."'] > 0)
        {
        mysqli_query($con,"UPDATE Orders SET ProductID = '$_POST['item_id".$m."']' WHERE PO = '$k'");
        mysqli_query($con,"UPDATE Orders SET Product_Name = '$_POST['item_name".$m."']' WHERE PO = '$k'");
        mysqli_query($con,"UPDATE Orders SET Quantity_Ordered = '$_POST['item_qty".$m."']' WHERE PO = '$k'");
        }
    } 
```

但我明白了

> 语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

我也试过

```
mysqli_query($con,"UPDATE Orders SET ProductID = '$_POST['item_qty$m']' WHERE PO = '$k'"); 
```

得到相同的结果。

有人可以帮助我吗？谢谢>-：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:42:32.553

您的报价没有正确平衡。修复它们会给你这个：

```
for ($m = 1; $m <= $j; $m++)
{
    if ($_POST["item_id".$m] > 0)
    {
       mysqli_query($con,"UPDATE Orders SET ProductID = '" . $_POST["item_id".$m]   . "' WHERE PO = '$k'");
       mysqli_query($con,"UPDATE Orders SET Product_Name = '" . $_POST["item_name".$m] . "' WHERE PO = '$k'");
       mysqli_query($con,"UPDATE Orders SET Quantity_Ordered = '" . $_POST["item_qty".$m]  . "' WHERE PO = '$k'");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:38:30.070

您必须转义 MySQL 查询中的变量：

从

```
 mysqli_query($con,"UPDATE Orders SET ProductID = '$_POST['item_id".$m."']' WHERE PO = '$k'"); 
```

到

```
 mysqli_query($con,"UPDATE Orders SET ProductID = '". $_POST['item_id".$m."'] . "' WHERE PO = '$k'"); 
```

其他人也一样。全部一起：

```
mysqli_query($con,"UPDATE Orders SET ProductID = '". $_POST['item_id".$m."'] . "' WHERE PO = '$k'");
mysqli_query($con,"UPDATE Orders SET ProductID = '". $_POST['item_name".$m."'] ."' WHERE PO = '$k'");
mysqli_query($con,"UPDATE Orders SET ProductID = '". $_POST['item_qty".$m."'] ."' WHERE PO = '$k'"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:44:05.657

也许是这样？

```
for ($m = 1; $m <= $j; $m++) {
    $item = $_POST['item_id' . $m];
    if ($item > 0) {
        $itemName = $_POST['item_name' . $m];
        $itemQty = $_POST['item_qty' . $m];
        mysqli_query($con, "UPDATE Orders SET ProductID = '" . $item . "' WHERE PO = '" . $k . "'");
        mysqli_query($con, "UPDATE Orders SET ProductID = '" . $itemName . "' WHERE PO = '" . $k . "'");
        mysqli_query($con, "UPDATE Orders SET ProductID = '" . $itemQty . "' WHERE PO = '" . $k . "'");
    }
} 
```

# matlab - 从三角球体生成 FV（面和顶点）

> ID：15770586
> 
> 赞同：0
> 
> 时间：2013-04-02T17:37:55.913
> 
> 标签：matlab, image-segmentation

我在 MATLAB 中使用 fileexchange 中的这段代码来生成球体三角剖分。

[http://www.mathworks.com/matlabcentral/fileexchange/38909-parametrized-uniform-triangulation-of-3d-circlesphere](http://www.mathworks.com/matlabcentral/fileexchange/38909-parametrized-uniform-triangulation-of-3d-circlesphere)

所以我可以在主动轮廓分割中使用它。问题在这里

[http://www.mathworks.com/matlabcentral/fileexchange/28149-snake-active-contour](http://www.mathworks.com/matlabcentral/fileexchange/28149-snake-active-contour)

球体的面和顶点已经在 mat 文件中定义，并且使用的球体对我来说不是最好的。我读到要生成 FV 矩阵，我必须使用等值面函数，但我不知道如何。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-08T15:13:29.473

我在另一个问题中找到了这段代码

```
function [p, t] = TriSphere(N, R)
% TRISPHERE: Returns the triangulated model of a sphere using the
% icosaedron subdivision method.
%
% INPUT:
% N (integer number) indicates the number of subdivisions,
%   it can assumes values between 0-inf. The greater N the better will look
%   the surface but the more time will be spent in surface costruction and
%   more triangles will be put in the output model.
%
% OUTPUT:
% In p (nx3) and t(mx3) we can find points and triangles indexes
% of the model. The sphere is supposed to be of unit radius and centered in
% (0,0,0). To obtain spheres centered in different location, or with
% different radius, is just necessary a traslation and a scaling
% trasformation. These operation are not perfomed by this code beacuse it is
% extrimely convinient, in order of time perfomances, to do this operation
% out of the function avoiding to call the costruction step each time.
%
% NOTE:
% This function is more efficient than the matlab command sphere in
% terms of dimension fo the model/ accuracy of recostruction. This due to
% well traingulated model that requires a minor number of patches for the
% same geometrical recostruction accuracy. Possible improvement are possible
% in time execution and model subdivision flexibilty.
%
% EXAMPLE:
%
%  N=5;
%
%  [p,t] = TriSphere(N);
%
%  figure(1) axis equal hold on trisurf(t,p(:,1),p(:,2),p(:,3)); axis vis3d
%  view(3)

% Author: Giaccari Luigi Created:25/04/2009%
% For info/bugs/questions/suggestions : giaccariluigi@msn.com
% ORIGINAL NAME: BUILDSPHERE
%
% Adjusted by Rody Oldenhuis (speed/readability)

    % error traps
    error(nargchk(1,1,nargin));
    error(nargoutchk(1,2,nargout));
    if ~isscalar(N)
        error('Buildsphere:N_mustbe_scalar',...
            'Input N must be a scalar.');
    end    
    if round(N) ~= N
        error('Buildsphere:N_mustbe_scalar',...
            'Input N must be an integer value.');
    end

    % Coordinates have been taken from Jon Leech' files

    % Twelve vertices of icosahedron on unit sphere
    tau = 0.8506508083520400; % t   = (1+sqrt(5))/2, tau = t/sqrt(1+t^2)
    one = 0.5257311121191336; % one = 1/sqrt(1+t^2)  (unit sphere)    
    p = [
        +tau  +one  +0     % ZA
        -tau  +one  +0     % ZB
        -tau  -one  +0     % ZC
        +tau  -one  +0     % ZD
        +one  +0    +tau   % YA
        +one  +0    -tau   % YB
        -one  +0    -tau   % YC
        -one  +0    +tau   % YD
        +0    +tau  +one   % XA
        +0    -tau  +one   % XB
        +0    -tau  -one   % XC
        +0    +tau  -one]; % XD

    % Structure for unit icosahedron
    t = [  
         5  8  9 
         5 10  8 
         6 12  7 
         6  7 11 
         1  4  5 
         1  6  4 
         3  2  8 
         3  7  2 
         9 12  1 
         9  2 12 
        10  4 11 
        10 11  3 
         9  1  5 
        12  6  1 
         5  4 10 
         6 11  4 
         8  2  9 
         7 12  2 
         8 10  3 
         7  3 11 ];

    % possible quick exit
    if N == 0, return, end

    % load pre-generated trispheres (up to 8 now...)
    if N <= 8
        S = load(['TriSphere', num2str(N), '.mat'],'pts','idx');
        p = S.pts; t = S.idx; 
        if nargin == 2, p = p*R; end
        return
    else
        % if even more is requested (why on Earth would you?!), make sure to START 
        % from the maximum pre-loadable trisphere
        S = load('TriSphere8.mat','pts','idx');
        p = S.pts; t = S.idx; clear S; N0 = 10;
    end

    % how many triangles/vertices do we have? 
    nt = size(t,1); np = size(p,1); totp = np;    
    % calculate the final number of points    
    for ii=N0:N, totp = 4*totp - 6; end    
    % initialize points array
    p = [p; zeros(totp-12, 3)];

    % determine the appropriate class for the triangulation indices
    numbits   = 2^ceil(log(log(totp+1)/log(2))/log(2));
    castToInt = ['uint',num2str(numbits)];

    % issue warning when required
    if numbits > 64
        warning('TriSphere:too_many_notes',...
            ['Given number of iterations would require a %s class to accurately ',...
            'represent the triangulation indices. Using double instead; Expect ',...
            'strange results!']);
        castToInt = @double;
    else
        castToInt = str2func(castToInt);
    end

    % refine icosahedron N times
    for ii = N0:N
        % initialize inner loop
        told  = t;
        t = zeros(nt*4, 3);
        % Use sparse. Yes, its slower in a loop, but for N = 6 the size is
        % already ~10,000x10,000, growing by a factor of 4 with every
        % increasing N; its simply too memory intensive to use zeros().
        peMap = sparse(np,np); 
        ct    = 1;        
        % loop trough all old triangles        
        for j = 1:nt

            % some helper variables
            p1 = told(j,1);
            p2 = told(j,2);
            p3 = told(j,3);
            x1 = p(p1,1); x2 = p(p2,1); x3 = p(p3,1);
            y1 = p(p1,2); y2 = p(p2,2); y3 = p(p3,2);
            z1 = p(p1,3); z2 = p(p2,3); z3 = p(p3,3);

            % first edge
            % -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

            % preserve triangle orientation
            if p1 < p2, p1m = p1; p2m = p2; else p2m = p1; p1m = p2; end

            % If the point does not exist yet, calculate the new point            
            p4 = peMap(p1m,p2m);
            if p4 == 0
                np = np+1;
                p4 = np;
                peMap(p1m,p2m) = np;%#ok
                p(np,1) = (x1+x2)/2;
                p(np,2) = (y1+y2)/2; 
                p(np,3) = (z1+z2)/2;
            end

            % second edge
            % -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

            % preserve triangle orientation
            if p2 < p3; p2m = p2; p3m = p3; else p2m = p3; p3m = p2; end

            % If the point does not exist yet, calculate the new point
            p5 = peMap(p2m,p3m);
            if p5 == 0
                np = np+1;
                p5 = np;
                peMap(p2m,p3m) = np;%#ok
                p(np,1) = (x2+x3)/2; 
                p(np,2) = (y2+y3)/2; 
                p(np,3) = (z2+z3)/2;
            end

            % third edge
            % -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

            % preserve triangle orientation
            if p1 < p3; p1m = p1; p3m = p3; else p3m = p1; p1m = p3; end

            % If the point does not exist yet, calculate the new point            
            p6 = peMap(p1m,p3m);
            if p6 == 0
                np = np+1;
                p6 = np;
                peMap(p1m,p3m) = np;%#ok
                p(np,1) = (x1+x3)/2; 
                p(np,2) = (y1+y3)/2;
                p(np,3) = (z1+z3)/2;                
            end

            % allocate new triangles
            %   refine indexing
            %          p1
            %          /\
            %         /t1\
            %      p6/____\p4
            %       /\    /\
            %      /t4\t2/t3\
            %     /____\/____\
            %    p3    p5     p2            
            t(ct,1) = p1; t(ct,2) = p4; t(ct,3) = p6; ct = ct+1;            
            t(ct,1) = p4; t(ct,2) = p5; t(ct,3) = p6; ct = ct+1;
            t(ct,1) = p4; t(ct,2) = p2; t(ct,3) = p5; ct = ct+1;            
            t(ct,1) = p6; t(ct,2) = p5; t(ct,3) = p3; ct = ct+1;

        end % end subloop
        % update number of triangles
        nt = ct-1;         
    end % end main loop

    % normalize all points to 1 (or R)
    p = bsxfun(@rdivide, p, sqrt(sum(p.^2,2)));
    if (nargin == 2), p = p*R; end
    % convert t to proper integer class
    t = castToInt(t);    

end % funciton TriSphere 
```

# django - Django中的自动完成字段

> ID：15770587
> 
> 赞同：12
> 
> 时间：2013-04-02T17:38:02.550
> 
> 标签：django, autocomplete, django-forms

我有类似于以下的模型：

```
class Country(models.Model):    
        name = models.CharField(max_length=50, unique=True)

class City(models.Model):
        name = models.CharField(max_length=50, unique=True)
        country = models.ForeignKey(Country) 
```

基本上我想在我的模板中向数据库添加一个城市。在此之前，我应该将它链接到已经存在的国家，所以我想在我的模板中使用“自动完成字段”来从数据库中获取国家

我定义了以下表格：

```
class AddCityForm(forms.ModelForm):
    city_name = forms.CharField(max_length=100)
    country_name = forms.CharField(max_length=100) 
```

在我的模板中，我有这样的表格：

```
<form action="/city/add" method="post">{% csrf_token %}
{{ add_city_form.as_p }}
<input type="submit" value="Submit" />
</form> 
```

那么在 django 中是否有任何解决方案，可以从数据库中自动完成“country_name”字段？

干杯，Django的新手。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-09-25T13:40:42.760

随着时间的推移，Django 应用程序起起落落。有一个网格`djangopackages.org`可以比较各种自动完成解决方案并提供有关其开发状态的提示：[https ://djangopackages.org/grids/g/auto-complete/](https://djangopackages.org/grids/g/auto-complete/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-02T17:39:14.980

是的。您可以检查django [-autocomplete](https://code.google.com/p/django-autocomplete/)

# git - 如何使用 --dir-diff 选项设置 git mergetool？

> ID：15770590
> 
> 赞同：7
> 
> 时间：2013-04-01T11:43:54.593
> 
> 标签：git

difftool 有一个很好的用户友好选项来查看差异。它的 --dir-diff 选项 - 允许您随意浏览两个目录。

git mergetool 有一个非常笨拙和不友好的用户界面。解决合并冲突必须按照 git 给出的严格顺序来完成。

是否有可能设置类似的选项，如 $ git difftool --dir-diff？说 $ git mergetool --dir-merge 调用例如 winmerge 的目录比较？或者是否有另一种解决方案来提供用户友好的界面来解决多个文件合并冲突？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:52:44.510

You can pass in a list of files to `git mergetool`'

To get a list of unmerged files, you can use `git ls-files --unmerged $DIR`'

In summary, do

```
git mergetool `git ls-files --unmerged $DIR` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T12:58:22.433

有一个名为[meld](http://meld.sourceforge.net/)的简单 Python 程序，但任何可视化合并三个窗格的东西都可以。

要将它用于合并解析，请安装它，然后在 git 中的未解析合并中，键入：`$ git mergetool`。

有关您可以阅读的主题的更多信息：[Git 中的无痛合并冲突解决方案](http://blog.wuwon.id.au/2010/09/painless-merge-conflict-resolution-in.html)

> ...我发现可用于执行合并的工具和接口并没有让程序员充分地有效地完成它们。通常情况下，程序员会简单地运行 git merge 并希望 git 能处理大部分的问题。在有冲突的大块头中，掌舵的人通常的合并策略是使用周围的上下文来粗略地猜测预期的程序应该是什么样子。
> 
> 本文将有望证明，可以有一个更可衡量的过程来解决合并冲突，从而消除这种冒险操作的猜测......

# php - 简单的广告块 drupal

> ID：15770593
> 
> 赞同：0
> 
> 时间：2013-04-02T17:38:24.083
> 
> 标签：php, drupal, drupal-7, ads

我正在寻找一个允许我管理广告的简单模块/代码。

我尝试了许多模块，但我发现只是复杂的东西并且具有非逻辑结构，我也尝试编辑一些模块，但是要做的工作太多。

我只想创建带有图像字段和跟踪系统（印象、点击等）的自定义块。
所以广告经理可以直接进入页面，点击上下文链接，查看展示次数/点击次数，然后他可以为广告上传新图片。

我的意思是一些非常简单和直观的东西，我在网站周围放置块，广告管理器（网站管理员）上传管理块。

我找不到任何以这种简单方式工作的东西，而且我不知道如何写下一些代码来让这个简单的系统工作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:52:10.257

我建议使用 Simpleads 模块。我在一个网站上使用它来进行简单的广告跟踪，就像你描述的那样。

这是该模块的链接。 [http://drupal.org/project/simpleads](http://drupal.org/project/simpleads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T04:17:59.077

您是否尝试过使用此模块[http://drupal.org/project/ad](http://drupal.org/project/ad)，我想这会对您有所帮助

# vbscript - 关于在 Vbscript 中使用双引号

> ID：15770599
> 
> 赞同：18
> 
> 时间：2013-04-02T17:38:43.350
> 
> 标签：vbscript

我对VB脚本有一个非常基本的疑问：

```
Msgbox "This is myName" ' This works fine

Msgbox "This is "myName""  ' This gives an error

Msgbox "This is ""myName"""   'This works fine 
```

我的问题是如果我需要保存（在变量中）或用双引号显示字符串，为什么我需要为单词或短语使用两次双引号。使用常见的双引号是否意味着我要显示整个内容或可以将其保存为变量中的字符串？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-02T18:26:48.900

在 VBScript 中，字符串文字用双引号 ( `"`) 括起来。这是您的第一个示例显示的内容：

```
Msgbox "This is myName" ' This works fine 
```

但是，如果您想在字符串文字中包含一个双引号字符*，*就会遇到问题，因为 VBScript 会将它找到的第二个双引号字符解释为表示字符串文字的结尾。这是您的第二个示例显示的内容：

```
Msgbox "This is "myName""  ' This gives an error
                       ^   ' because it prematurely terminates the string here
                           ' and doesn't know what to do with the trailing " 
```

幸运的是，有一个逃生舱口。它涉及用另一个字符*转义*双引号字符，表明 VBScript 应将其作为文字双引号字符处理，而不是神奇的“字符串结尾文字”字符。VBScript 使用的转义字符恰好是双引号字符。这是您的第二个示例显示的内容：

```
Msgbox "This is ""myName"""   'This works fine 
```

*   您以单个双引号开始字符串，表示字符串文字的开始。
*   然后你想要一个嵌入的双引号字符，所以你使用其中的两个。这是转义开始的地方：你用另一个双引号字符*转义*双引号字符。
*   然后你再次做那个逃避的事情。
*   最后，您用另一个双引号字符终止整个字符串文字。

其他语言通常使用反斜杠 ( `\`) 作为转义字符。这可能会让事情更容易看到。假设 VBScript 使用反斜杠作为转义字符而不是双引号，您的代码将如下所示：

```
Msgbox "This is \"myName\""   ' doesn't work in VBScript; example only 
```

如果这种语法让您感到困扰，您可以为双引号声明一个常量并每次都使用它：

```
Const Quote = """"

' ... later in the code ...

Msgbox "This is " & Quote & "myName" & Quote 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-03T10:23:55.353

每种语言都有自己的[转义字符](http://en.wikipedia.org/wiki/Escape_character)。偶然与否，在 VB/VBS 中它是双引号。而且无论是否偶然，我们只能在文字字符串中嵌入双引号。例如，我们不能嵌入其他特殊字符作为 Tab。

但是，使用 VB/VBS 转义字符简化了我们的编码。

```
str = """D:\path\to\xyz.exe"" ""arg 1"" ""arg 2"""
WScript.Echo str  ' "D:\path\to\xyz.exe" "arg 1" "arg 2"

str = Chr(34) & "D:\path\to\xyz.exe" & Chr(34) & " " _
    & Chr(34) & "arg 1" & Chr(34) & " " & Chr(34) & "arg 2" & Chr(34)
WScript.Echo str  ' "D:\path\to\xyz.exe" "arg 1" "arg 2"

str = Join(Array("", "D:\path\to\xyz.exe", " ", "arg 1", " ", "arg 2", ""), Chr(34))
WScript.Echo str  ' "D:\path\to\xyz.exe" "arg 1" "arg 2" 
```

但我个人更喜欢使用`Replace`它，因为它使我的代码更具可读性。

```
str = Replace("'D:\path\to\xyz.exe' 'arg 1' 'arg 2'", Chr(39), Chr(34))
WScript.Echo str  ' "D:\path\to\xyz.exe" "arg 1" "arg 2" 
```

您可以使用`Replace`（如果方便的话）和其他特殊字符。

```
str = Replace(Replace("A|B|C!1|2|3", "!", vbNewLine), "|", vbTab)
WScript.Echo str
'A  B   C
'1  2   3 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-02T17:52:00.193

必须对字符串文字进行分隔以将字符串中的内容与外部分开。VBScript 中的字符串定界符是 "（双引号）。其他语言也使用 "，有些语言使用 '（单引号）作为替代或语义稍有不同的定界符。

要在字符串文字中包含分隔符，必须对其进行转义（标记为不表示字符串的“结束”或“开始”。字符串文字中“的转义标记是”。给出“” - 在 VBscript 中。其他语言使用`\"`转义双引号。

所以

```
Msgbox "This is ""myName"""   'This works fine
x = "This is ""myName""" 
```

如果您要显示（或存储）什么，则 VBScript 是正确的`This is "myName"`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T17:51:51.350

VBScript 中的双引号包含一个字符串。如果在字符串中插入单个双引号，它会过早终止字符串，其余部分会导致错误。因此，您必须在字符串中转义双引号，这可以通过将它们加倍来完成。这就是为什么您的第 3 个^(命令)有效而您的第 2个^(命令)无效的原因。

# mysql - 嵌套 SQL 语句未按预期计算 SUM

> ID：15770600
> 
> 赞同：1
> 
> 时间：2013-04-02T17:38:46.677
> 
> 标签：mysql, sql, nested, sum, statements

我正在尝试做一个快速的会计 sql 语句，但遇到了一些问题。

我有 3 个表格注册、活动和付款表格。注册是个人交易，事件是有关他们注册内容的信息，付款是对事件的付款。

我想合计注册支付的金额，将活动名称和活动开始日期放入一列，然后合计迄今为止支付的金额。如果可能的话，我还想找到一个未付的总额。我相信底部会计算出除了支付总额之外的所有内容。付款总额比它应该的要大得多，很可能通过使用 SUM 因为嵌套而多次计算付款。

```
select 
  sum(`reg_amount`) as total, 
  event_name, 
  event_startdate, 
  (
    select sum(payment_amount) as paid 
    from registrations 
    group by events.event_id
  ) pay
FROM registrations 
  left join events 
    on events.event_id = registrations.event_id
  left join payments 
    on payments.event_id = events.event_id
group by registrations.event_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:00:29.837

首先，您应该使用别名，以便我们知道所有字段的来源。我猜这`payment_amount`来自`payments`table 而不是来自`registrations`.

如果是这样，您的子查询正在为注册中的每一行添加*外部*表中的付款。可能不是你想要的。

我想你想要这样的东西：

```
select sum(`reg_amount`) as total, 
       e.event_name, 
       e.event_startdate, 
       p.TotPayements
FROM registrations r left join
     events e
     on e.event_id = r.event_id left join
     (select event_id, sum(payment_amount) as TotPayments
      from payments
      group by event_id
     ) p
     on p.event_id = e.event_id
group by r.event_id; 
```

这个想法是在尽可能低的水平上汇总付款，以避免因加入而造成的重复。即在加入*前聚合。*

这是对正确 SQL 的猜测，但它应该让您走上正确的道路。

# ios - 将两个 UIViewController 并排放在屏幕上

> ID：15770602
> 
> 赞同：2
> 
> 时间：2013-04-02T17:38:49.993
> 
> 标签：ios, ipad, uiviewcontroller, uikit

在 iPad 上，我有一个主 UIViewController，它应该并排嵌入两个 childViewController。我怎样才能实例化它们，并将它们放在屏幕上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:44:24.660

您可以在 IB 中使用容器视图。将 2 个容器视图拖到控制器视图中，并根据需要调整它们的大小。您将自动获得两个连接的视图控制器，大小适当。主视图控制器及其两个子视图控制器都将同时实例化。如果您需要从父级访问子级，则使用 self.childViewControllers。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T00:21:54.597

听起来您应该使用[UISplitViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UISplitViewController_class/Reference/Reference.html)作为两个视图控制器的容器：

> UISplitViewController 类是一个容器视图控制器，用于管理两个并排视图控制器的呈现。

# php - 将linkedin oauth v1 api密钥转换为v2 api密钥？

> ID：15770605
> 
> 赞同：0
> 
> 时间：2013-04-02T17:39:10.523
> 
> 标签：php, api, linkedin, api-key

我有一些代码可以让用户使用 oauth v1 api 通过链接登录。这会将两个密钥返回给我，它们是用户令牌和用户密码。

我曾尝试将它们与 v2 api 一起使用，但似乎它需要 oauth2_access_token。

有什么方法可以使用用户令牌和用户密码进行 api 调用？

如果没有，有没有办法将用户令牌和用户密码转换为 v2 所需的新 oauth2_access_token？

如果没有，有没有办法让 v2 ​​检查用户是否已经验证了应用程序并返回新的 v2 密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T11:52:54.213

如果您已经成功设置了 OAuth v1 身份验证，我建议您坚持下去，因为 Linkedin 将支持这两种身份验证方案。您可以将所有 API 函数与两种身份验证方案一起使用。我看不出有任何理由重写您的身份验证方案。

# c++ - 模板重载 ostream 运算符

> ID：15770613
> 
> 赞同：6
> 
> 时间：2013-04-02T17:39:24.627
> 
> 标签：c++, templates, operator-overloading

我正在尝试漂亮地打印一个 STL 容器。我想要的是打印用分隔符分隔的容器的元素。但是我遇到了几个问题。

**1\. g++ 与 VC++**

```
ostream& operator<<(ostream& o, const vector<string>& v) {
    copy(v.begin(), v.end(), std::ostream_iterator<string>(o,","));
}

int main()
{

    vector<string> s_v;
    s_v.push_back("one");
    s_v.push_back("two");

    cout << s_v;

} 
```

g++（mingw32 上的 gcc 版本 4.4.0）可以编译它并且工作正常。VC++ (Visual Studio 9) 无法编译此代码。

```
error C2679: binary '<<' : no operator found which takes a right-hand operand of type 'const std::string' (or there is no acceptable conversion)
1>        c:\program files (x86)\microsoft visual studio 9.0\vc\include\ostream(653): could be 'std::basic_ostream<_Elem,_Traits> &std::operator <<<char,std::char_traits<char>>(std::basic_ostream<_Elem,_Traits> &,const char *)'
1>        with
1>        [ 
```

**为什么是这样？这个代码是非法的吗？或者它只是VC++ beign VC++？**

* * *

**2\. 未使用的模板变量会破坏编译。**

如果现在我像这样向ostream添加一个模板（它没有被使用，只是坐在那里）

```
template <typename T>  // <----- Here
ostream& operator<<(ostream& o, const vector<string>& v) {
    copy(v.begin(), v.end(), std::ostream_iterator<string>(o,","));
}

int main()
{

    vector<string> s_v;
    s_v.push_back("one");
    s_v.push_back("two");

    cout << s_v;

} 
```

**gcc 不能再匹配运算符了。**

```
 error: no match for 'operator<<' in 'std::cout << s_v'

and a lot more candidates... 
```

**为什么？该模板未使用。应该有关系吗？**

* * *

**编辑：这已经解决了。我不得不返回；**

**3\. 使用过的模板**

```
template <typename T>
ostream& operator<<(ostream& o, const vector<T>& v) {
    copy(v.begin(), v.end(), std::ostream_iterator<T>(o,","));

    return o; // Edited
}

int main()
{

    vector<string> s_v;
    s_v.push_back("one");
    s_v.push_back("two");

    vector<int> i_v;
    i_v.push_back(1);
    i_v.push_back(2);

    cout << s_v;
    cout << i_v;
} 
```

**如果我知道使用模板类型。g++ 可以编译它，但随后以异常终止。**

```
terminate called after throwing an instance of 'std::bad_cast'
  what():  std::bad_cast 
```

VC++ 只是坐着看着 gcc 做这一切。不编译其中任何一个。

有人可以为我澄清一下吗？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:49:18.663

**前提：**

首先，代码是非法的，因为它错过了一条`return`语句（这可能是导致第三版中引发异常的原因）：

```
ostream& operator<<(ostream& o, const vector<string>& v) {
    copy(v.begin(), v.end(), std::ostream_iterator<string>(o,","));
    return o; // <== THIS ONE WAS MISSING
} 
```

这会将未定义的行为注入您的程序。实际上，根据 C++11 标准的第 6.6.3/1 段：

> [...] 从函数末尾流出相当于没有值的返回；**这会导致值返回函数中的未定义行为**。

**关于你的第一个问题：**

一旦修复了，你的代码就很好了，而且 VC9 附带的标准库的实现可能有一个错误。

事实上，编译器应该`operator <<`在参数 ( `std`) 的命名空间和进行调用的命名空间（全局命名空间）中查找符合条件的重载。只要您的运算符在全局命名空间中定义*并且*语句`cout << s_v`在全局命名空间中，重载解析就应该成功地选择您的重载。

**关于你的第二个问题：**

> 为什么？该模板未使用。应该有关系吗？

这很简单：编译器无法`T`从函数参数中推导出来，因此除非您明确指定它，否则这将导致编译错误。但是，显式指定模板参数将意味着执行以下操作，这几乎是无意义的：

```
::operator << <void>(std::cout, s_v); 
```

在 C++11 中，您可以为 指定一个默认参数`T`，这将使函数调用合法，然后再次出现错误，目的是什么？

**关于你的第三个问题：**

当`T`用于推导上下文中至少一个函数参数的类型时，编译器将允许从函数参数中推导它（在这种情况下，它将推导`T = std::string`，您不必显式指定它。

**结论：**

所以总结一下：添加必要的`return`语句后，你的程序的第一个和第三个版本是合法的并且有意义，而第二个不是并且没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:52:56.310

1.  如发布的那样，您的代码不应使用任何编译器进行编译。您缺少包括，以及很多`std::`. 我*怀疑* 正在发生的事情是您没有所有必要的包括；特别是，那`#include <string>`是缺失的，而 g++ 间接地捡起了它。这很好奇。问题通常是相反的：VC++ 获得了很多额外的包含。但是，有时只是部分了解（因此您最终可能会了解`std::string`，但不了解与其关联的非成员函数，例如`operator<<`）。但是，如果没有看到您的实际包含，很难说。

2.  编译器只能对函数执行重载解析，不能对函数模板执行重载解析。在开始重载解析之前，它会尝试用正确的名称实例化一个函数模板。成功的实例化会产生一个函数，并将其添加到重载集。但是它应该如何实例化您的函数模板。它无法知道该用于什么`T`。所以它没有实例化（模板参数推导失败），并且没有它的实例进入重载集。

3.  我在这里没有立即看到任何东西。在 中添加缺少的返回后`operator<<`，它可以在 VC++ 上正确编译和运行。

# sql-server - 使用 TVP 表值参数，有哪些注意事项？

> ID：15770621
> 
> 赞同：1
> 
> 时间：2013-04-02T17:39:51.630
> 
> 标签：sql-server, sql-server-2008, ado.net

我在 ADO.NET 中使用表值参数，但我的存储过程无法正常工作。我还有另外 2 个可以正常工作。我将代码与表格等的顺序进行了比较，它们似乎都还可以。

数据从我的代码传递到存储过程，没有错误，它不会简单地插入。我想知道是否有什么我不知道我错过了......我完全迷失了......花了很多时间试图弄清楚但不能。

一切似乎都很好，没有错误，但它无法正常工作。

这是类型：

```
CREATE TYPE [dbo].[NameTableType] AS TABLE(
[ID] [int] NULL,
[MYID] [int] NULL,
[Name] [varchar](50) NULL,
    )
    GO 
```

这是我的桌子

```
ALTER PROCEDURE [dbo].[Insert]
(
@TVP as NameTableType readonly
)                                      
AS
  BEGIN TRANSACTION
  BEGIN TRY
      INSERT INTO [dbo].[MYTABLE]
      ([ID],[MYID],[NAME])
      SELECT [ID],[MYID],[NAME]
       from @TVP
      COMMIT TRANSACTION
  END TRY

  BEGIN CATCH
      ROLLBACK TRANSACTION
  END CATCH 
```

我的数据库中有什么我应该小心的吗？它是什么？如果程序失败，有没有办法返回错误？

任何意见是极大的赞赏。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:50:04.683

而不是仅仅捕获和丢弃错误，尝试：

```
BEGIN CATCH
    ROLLBACK TRANSACTION;
    DECLARE @msg NVARCHAR(MAX) = ERROR_MESSAGE();
    RAISERROR(@msg, 11, 1);
    RETURN;
END CATCH 
```

现在，您基本上是在说“如果有错误，请忽略它”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:56:09.710

1.  检查是否有任何触发器导致问题。
2.  Sql Profiler 在这种情况下很有用

# jquery - jquery帮助延迟

> ID：15770630
> 
> 赞同：0
> 
> 时间：2013-04-02T17:40:16.593
> 
> 标签：jquery

我试图在每个动画之间添加延迟。

试过了

```
slicebox = $( '#sb-slider3' ).delay(2000).slicebox({ 
```

在最后一个，但不是快乐。有任何想法吗？对 jQuery 来说还是新手

* * *

## 完整代码如下

```
<script type="text/javascript">
$(function() {
    var Page = (function() {
        var $navArrows = $('#nav-arrows').hide(),
            $navDots = $('#nav-dots').hide(),
            $nav = $navDots.children('span'),
            $shadow = $('#shadow').hide(),
            slicebox = $('#sb-slider3').delay(2000).slicebox({
                onReady: function () {
                    $navArrows.show();
                    $navDots.show();
                    $shadow.show();
                },
                onBeforeChange: function(pos) {
                    $nav.removeClass('nav-dot-current');
                    $nav.eq(pos).addClass('nav-dot-current');
                }
            }),
            init = function() {
                initEvents();
            },
            initEvents = function() {
                // add navigation events
                $navArrows.children(':first').on('click', function() {
                    slicebox.next();
                    return false;
                });
                $navArrows.children(':last').on('click', function() {
                    slicebox.previous();
                    return false;
                });
                $nav.each(function(i) {
                    $(this).on('click', function(event) {
                        var $dot = $(this);
                        if (!slicebox.isActive()) {
                            $nav.removeClass('nav-dot-current');
                            $dot.addClass('nav-dot-current');
                        }
                        slicebox.jump(i + 1);
                        return false;
                    });
                });
            };
        return {
            init: init
        };
    })();
    Page.init();
});
</script> 
```

然后重复

```
slicebox = $( '#sb-slider3' ).delay(2000).slicebox( { 
```

变成

```
slicebox = $( '#sb-slider2' ).delay(1000).slicebox( { 
```

和 slicebox = $( '#sb-slider0' ).delay(3000).slicebox( {

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:45:44.557

`delay()`仅对动画有用，但您可以使用[queue()](http://api.jquery.com/queue/)将您自己的函数注册到动画队列：

```
slicebox = $("#sb-slider3").delay(2000).queue(function() {
    $(this).slicebox({
        onReady: function() {
            $navArrows.show();
            $navDots.show();
            $shadow.show();
        },
        onBeforeChange: function(pos) {
            $nav.removeClass('nav-dot-current');
            $nav.eq(pos).addClass('nav-dot-current');
        }
    }).dequeue();
}); 
```

这可能比[setTimeout() 更具可读性（并且更易于链接）](https://developer.mozilla.org/en/docs/DOM/window.setTimeout)。

# ruby-on-rails - 如何在连接数据的地方使用 AREL eq() 方法

> ID：15770642
> 
> 赞同：0
> 
> 时间：2013-04-02T17:40:42.227
> 
> 标签：ruby-on-rails, activerecord, arel

我目前有这个范围：

```
class User

  has_many :inbox_messages, :through => :message_users do
    def unread
      published.where(:message_users => { :sender => false, :trash => false , :deleted => false}).where(MessageUser.arel_table[:read_at].not_eq(nil))
    end

  end
end 
```

它正在工作。但我想知道是否有办法将第二个合并`where`到第一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T18:24:59.863

如果我正确理解您的代码，您应该能够做到这一点

```
published.where(:message_users => { :sender => false, :trash => false , :deleted => false, :read_at => nil }) 
```

# c++ - 动态分配类型是模板类型的另一个对象的模板类时出现编译器错误

> ID：15770643
> 
> 赞同：1
> 
> 时间：2013-04-02T17:40:55.860
> 
> 标签：c++, templates

这是我目前得到的编译器错误

错误 C2679：二进制“=”：未找到采用“对”类型的右侧操作数的运算符（或没有可接受的转换）

```
using namespace std;

template<typename T, typename U>
Array< Pair<T, U>>* zip(Array<T> & lhs,Array<U> & rhs) 
{
    int zipLen = (lhs.getLength() < rhs.getLength() ? lhs.getLength() : rhs.getLength());

    Array<Pair<T, U>>* zipped= new Array<Pair<T,U>>(zipLen);

    for (int i=0; i<zipLen; i++)
        zipped[i] = Pair<T, U>(lhs[i], rhs[i]);//and this is the line giving me problems

    return zipped;
}

int main()
{
    Array<int> a1(5);
    Array<char>a2(3);

    Array<Pair<int,char>>*a3;

    for(int i =1;i<5;i++)
        a1[i-1]=i;

    for(char ch='a';ch<='c';ch++)
        a2[ch-'a']=ch;

    a3=zip(a1,a2);

    cout<<a3;

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:48:46.263

我相信您已将“压缩”声明为指向对数组的指针。因此，要访问数组的元素，您必须首先取消引用指针：

```
(*zipped)[i] = Pair<T, U>(lhs[i], rhs[i]); 
```

# php - 如果当前文章类别 ID 为，Joomla 显示内容

> ID：15770644
> 
> 赞同：0
> 
> 时间：2013-04-02T17:40:56.657
> 
> 标签：php, joomla

我正在使用 joomla 2.5，我只想在属于类别 id 11 的文章中显示一些特殊文本。

获取类别 id 我试过：

```
<?php $catid = JRequest::getInt('catid'); echo $catid; ?> 
```

检查当前类别 ID 是否为 11，然后显示我使用的特殊文本：

```
<?php $catid = JRequest::getInt('catid'); if ($catid == 11) {?>SPECIAL TEXT<?php } ?> 
```

但它不起作用:(在所有类别中都可以看到文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T23:05:52.197

你的`if`陈述看起来不正确......试试这个：

```
<?php $catid = JRequest::getInt('catid'); if ($catid == 11) : ?>SPECIAL TEXT<?php endif; ?> 
```

请参阅[php.net 上的“控制结构的替代语法”](http://www.php.net/manual/en/control-structures.alternative-syntax.php)

# php - CRM 动态 2011 XML 缺少请求

> ID：15770647
> 
> 赞同：0
> 
> 时间：2013-04-02T17:41:05.400
> 
> 标签：php, dynamics-crm-2011

我的 XML 请求遇到问题，该请求是 2011 年 CRM 动态网络的一部分，用于创建潜在客户。

我目前陷入的代码如下：

```
 <s:Body>
                <Create xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">
                <entity xmlns:b="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
                    <b:Attributes xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">
                        <b:KeyValuePairOfstringanyType>
                            <c:key>name</c:key>
                            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">Name Test 1</c:value>
                            <c:key>E-mail</c:key>
                            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">test@test.com</c:value>
                        </b:KeyValuePairOfstringanyType>
                    </b:Attributes>
                    <b:EntityState i:nil="true"/>
                    <b:FormattedValues xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>
                    <b:Id>00000000-0000-0000-0000-000000000000</b:Id>
                    <b:LogicalName>account</b:LogicalName>
                    <b:RelatedEntities xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>
                </entity>
                </Create>
            </s:Body> 
```

该名称已在我找到的代码中可用，我尝试添加电子邮件属性（甚至是地址），但在 CRM 中除了名称之外什么都没有，代码中的错误到底是什么？应该如何修复？

任何帮助表示赞赏，并提前感谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T01:57:39.560

我相信您需要使用属性的逻辑名称而不是显示名称（emailaddress1 而不是 E-mail）。此外，我相信您需要为要发送的每个属性都有一个 KeyValuePair 节点，因为它是您要发送的属性数组。试试这个：

```
<b:KeyValuePairOfstringanyType>
    <c:key>name</c:key>
    <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">Name Test 1</c:value>
</b:KeyValuePairOfstringanyType>
<b:KeyValuePairOfstringanyType>
    <c:key>emailaddress1</c:key>
    <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">test@test.com</c:value>
</b:KeyValuePairOfstringanyType> 
```

# clojure - Storm > 如何将 Java 回调集成到 Spout 中

> ID：15770650
> 
> 赞同：5
> 
> 时间：2013-04-02T17:41:12.130
> 
> 标签：clojure, streaming, message-queue, apache-storm

我正在尝试将 Storm（[请参见此处](https://github.com/nathanmarz/storm/wiki/Clojure-DSL)）集成到我的项目中。我理解了拓扑、spout 和 bolts 的概念。但现在，我试图弄清楚一些事情的实际实现。

**A)**我有一个使用 Java 和 Clojure 的多语言环境。我的 Java 代码是一个回调类，其中包含触发流数据的方法。推送到这些方法的事件数据是我想用作 spout 的。

所以第一个问题是如何将进入这些方法的数据连接到一个 spout ？我正在尝试**i)**传递一个*backtype.storm.topology.IRichSpout*，然后**ii)**将一个*backtype.storm.spout.SpoutOutputCollector*（[参见此处](https://github.com/nathanmarz/storm/blob/master/src/jvm/backtype/storm/spout/SpoutOutputCollector.java)）传递给该 spout 的***打开***函数（[参见此处](https://github.com/nathanmarz/storm/blob/master/src/jvm/backtype/storm/spout/ISpout.java#L40)）。但我看不到实际传递任何类型的地图或列表的方法。

**B)**我项目的其余部分都是 Clojure。通过这些方法将有大量数据。每个事件的 ID 介于 1 和 100 之间。在 Clojure 中，我希望将来自 spout 的数据拆分到不同的执行线程中。我认为，这些将是螺栓。

如何设置 Clojure bolt 从 spout 获取事件数据，然后根据传入事件的 ID 中断线程？

提前感谢蒂姆

**[编辑 1]**

我实际上已经解决了这个问题。我最终**1)**实现了我自己的 IRichSpout。然后我**2)**将该 spout 的内部元组连接到我的 java 回调类中的传入流数据。我不确定这是否是惯用的。但它编译并运行没有错误。但是，**3）**我没有看到通过***printstuff***螺栓传入的流数据（肯定在那里）。

为了确保事件数据得到传播，在 spout 或 bolt 实现或拓扑定义中是否需要做一些特定的事情？谢谢。

```
      ;; 将 Java 回调绑定到我创建的 Spout
      (.setSpout java-callback ibspout)

      (storm/defbolt printstuff ["word"] [元组收集器]
        (println (str "printstuff --> tuple["tuple"] > collector["collector"]"))
      )
      （风暴/拓扑
       { "1" (storm/spout-spec ibspout)
       }
       { "3" (storm/bolt-spec { "1" :shuffle }
                               印刷品
             )
       })

```

**[编辑 2]**

根据 SO 成员[Ankur](https://stackoverflow.com/users/553209/ankur)的建议，我正在调整我的拓扑结构。创建 Java 回调后，我将它的元组传递给下面的 IBSpout，使用`(.setTuple ibspout (.getTuple java-callback))`. 我没有传递整个 Java 回调对象，因为我得到了 NotSerializable 错误。一切都编译并运行没有错误。***但同样，我的printstuff***螺栓没有数据。嗯。

```
    公共类 IBSpout 实现 IRichSpout {

      /**
       *风暴喷口的东西
       */
      私人 SpoutOutputCollector _collector;

      私有列表 _tuple = new ArrayList();
      public void setTuple(List tuple) { _tuple = tuple; }
      公共列表 getTuple() { return _tuple; }

      /**
       * Storm ISpout 接口函数
       */
      public void open(Map conf, TopologyContext context, SpoutOutputCollector 收集器) {
        _collector = 收集器；
      }
      公共无效关闭（）{}
      公共无效激活（）{}
      公共无效停用（）{}
      公共无效 nextTuple() {
        _collector.emit(_tuple);
      }
      公共无效确认（对象 msgId）{}
      公共无效失败（对象 msgId）{}

      public void declareOutputFields(OutputFieldsDeclarer 声明者) {}
      public java.util.Map getComponentConfiguration() { return new HashMap(); }

    }

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T04:42:44.310

似乎您正在将 spout 传递给您的回调类，这似乎有点奇怪。当一个拓扑被执行时，storm会定期调用spouts`nextTuple`方法，因此你需要做的是将java回调传递给你的自定义spout实现，这样当storm调用你的spout时，spout调用java回调来获取下一组元组被馈送到拓扑中。

要理解的关键概念是 Spouts在风暴请求时**提取数据，您****不会将**数据推送到 spouts。您的回调不能调用 spout 将数据推送到它，而是当您的 spout`nextTuple`方法被调用时，您的 spout 应该（从某些 java 方法或任何内存缓冲区）提取数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T19:24:28.437

对 B 部分的回答：

对我来说，直截了当的答案听起来就像您正在寻找一个字段分组，这样您就可以控制在执行期间按 ID 将哪些作品分组在一起。

也就是说，我不相信这真的是一个完整的答案，因为我不知道你为什么要这样做。如果您只想要平衡的工作负载，则随机分组是更好的选择。

# directx - 使用directx选择图像的一部分

> ID：15770658
> 
> 赞同：0
> 
> 时间：2013-04-02T17:41:48.060
> 
> 标签：directx, directx-11

我正在使用 directx 11 渲染图像。目标是从该图像中选择像素，然后用鼠标移动它。选择可以是任何几何形状，例如贝塞尔曲线、矩形等。

我是directx的新手，有人可以建议一种方法来实现这一点吗？

谢谢。

# java - 如何键入强制转换以编程方式初始化的类

> ID：15770661
> 
> 赞同：0
> 
> 时间：2013-04-02T17:42:01.860
> 
> 标签：java

我正在尝试以编程方式初始化一个类并将其添加到列表中。我不知道如何输入`workflowClass`以便`extends BaseWorkflow`列表接受它。目前它说我不能`Object`在期待的时候添加`? extends BaseWorkflow`。

```
private static List<? extends BaseWorkflow> workflowList = new ArrayList<BaseWorkflow>();

/**
 * Initialize the production line
 */
public static void init() {
    //load active workflows into memory
    WorkflowService workflowService = (WorkflowService) ApplicationContextProvider.getApplicationContext().getBean("workflowService");
    for (Workflow workflow: workflowService.findActive()) {
        try {
            Class<?> clazz = Class.forName(workflow.getClassName());
            Object workflowClass = clazz.newInstance();
            workflowList.add(workflowClass); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:44:25.827

您将无法向`List<? extends BaseWorkflow>`. 该列表应声明为`List<BaseWorkflow>`. 实际上，`List<? extends BaseWorkflow>`意味着：*一些未知类型的列表，它是或扩展 BaseWorkflow*。由于类型是未知的，因此向该列表添加任何内容（除 null 外）都会破坏其类型安全性。

然后一个简单的演员就可以了：

```
workflowList.add((BaseWorkflow) workflowClass); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:45:15.183

尝试显式转换 Object：

```
workflowList.add((BaseWorkflow) workflowClass) 
```

# c++ - Python 版本的 C++ all_of

> ID：15770666
> 
> 赞同：4
> 
> 时间：2013-04-02T17:42:31.220
> 
> 标签：c++, python, built-in

有没有更好的方法（使用内置函数）来重写以下代码：

```
def all_of(iterable, predicate):
    for elem in iterable:
        if not predicate(elem):
            return False
    return True 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T17:43:21.417

[`all`](http://docs.python.org/2/library/functions.html#all)是内置的：

```
all(predicate(e) for e in iterable) 
```

我认为定义这样的东西是不值得的：

```
def all_of(iterable, predicate):
    return all(predicate(e) for e in iterable) 
```

# html - 背景拉伸与 div + 表格中的内容

> ID：15770667
> 
> 赞同：0
> 
> 时间：2013-04-02T17:42:31.843
> 
> 标签：html, css, html-table

我想在 div 和表格中放置一个覆盖整个窗口和内容的拉伸背景图像。

此代码工作正常：

> ```
> <!doctype html>
> <html>
> <head>
> <title>Background to fit screen</title>
> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
> <meta http-equiv="Imagetoolbar" content="no">
> 
> <style type="text/css">
> /* pushes the page to the full capacity of the viewing area */
> html {height:100%;}
> body {height:100%; margin:0; padding:0;}
> /* prepares the background image to full capacity of the viewing area */
> #bg {position:fixed; top:0; left:0; width:100%; height:100%;}
> /* places the content ontop of the background image */
> #content {position:relative; z-index:1;}
> </style>
> </head>
> 
> <body>
> <div id="bg"><img src="../images/background.jpg" width="100%" height="100%" alt=""></div>
> <div id="content">
> 
> <table>
> <tr>
> <td>
> <img src="images/1.jpg">
> </td>
> <td>
> <img src="images/2.jpg">
> </td>
> </tr>
> </table>
> 
> </div>
> </body>
> </html> 
> ```

问题是表格单元格中图像之间的间距！一旦你有一张非常大的桌子，里面有大量的图像，那就太糟糕了。

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:35:09.030

对于您的表格 div，您可以对其进行返工并添加 background-size: 100% 100%;

```
<div id ="bg" style="background-image: url(../image/background.jpg); background-size: 100% 100%;">
    <table>
    <!--table stuff-->
    </table>
</div> 
```

显然，您希望将我的内联 css 提取到您的 css 文件中，但这为您提供了总体思路。对于您的 IE 6 版本，由于它不支持 CSS3，您可能只想使用背景颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:43:02.587

给你的表格宽度 100% 并给表格样式

```
#content { background-image:url('image.jpg'); } 
```

# html - Bootstrap doctype 导致宽度被忽略

> ID：15770670
> 
> 赞同：0
> 
> 时间：2013-04-02T17:42:39.347
> 
> 标签：html, twitter-bootstrap, width, doctype

我在使用 Twitter Bootstrap 时遇到了一个非常奇怪的问题。我正在使用通过 Bootstrap 网站中的“自定义”页面下载的自定义版本的 Bootstrap。我正在使用自定义版本，因为我需要使用 24 列而不是 12 列，以便为我提供所需的各种列宽。

这些是我在 Bootstrap 网站上的自定义表单中输入的自定义值：

```
@gridColumns 24px
@gridColumnWidth 30px
@gridGutterWidth 10px 
```

我把所有选项都选中了，除了响应复选框。我正在构建的站点将仅是固定宽度，因此我关闭了所有五个响应选项。

下载文件后，我创建了一个非常基本的 HTML 页面来测试网格系统。

这是 HTML 代码：

```
<!DOCTYPE html>
<html>
<head>
<title>Bootstrap 101 Template</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Bootstrap -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet" media="screen">
</head>

<body>

<header>
<div class="container">
    <div class="row">
        <div class="span9" style="background: #F00;">SPAN 9 COLUMN</div>
        <div class="span15" style="background: #0F0;">SPAN 15 COLUMN</div>
    </div>
</div>
</header>

<script src="http://code.jquery.com/jquery.js"></script> 
<script src="assets/js/bootstrap.min.js"></script>
</body>
</html> 
```

问题是浏览器似乎忽略了在 bootstrap.min.css 文件中设置的 .row 和 .spanXX 样式上设置的 CSS 宽度。我检查了 CSS 文件，宽度肯定包括在内：

bootstrap.min.css 的第 42-90 行

```
.container,.navbar-static-top .container,.navbar-fixed-top .container,.navbar-fixed-bottom .container{width:974;}
.span24{width:974;}
.span23{width:933;}
.span22{width:892;}
.span21{width:851;}
.span20{width:810;}
.span19{width:769;}
.span18{width:728;}
.span17{width:687;}
.span16{width:646;}
.span15{width:605;}
.span14{width:564;}
.span13{width:523;}
.span12{width:482;}
.span11{width:441;}
.span10{width:400;}
.span9{width:359;}
.span8{width:318;}
.span7{width:277;}
.span6{width:236;}
.span5{width:195;}
.span4{width:154;}
.span3{width:113;}
.span2{width:72;}
.span1{width:31;}
.offset24{margin-left:994;}
.offset23{margin-left:953;}
.offset22{margin-left:912;}
.offset21{margin-left:871;}
.offset20{margin-left:830;}
.offset19{margin-left:789;}
.offset18{margin-left:748;}
.offset17{margin-left:707;}
.offset16{margin-left:666;}
.offset15{margin-left:625;}
.offset14{margin-left:584;}
.offset13{margin-left:543;}
.offset12{margin-left:502;}
.offset11{margin-left:461;}
.offset10{margin-left:420;}
.offset9{margin-left:379;}
.offset8{margin-left:338;}
.offset7{margin-left:297;}
.offset6{margin-left:256;}
.offset5{margin-left:215;}
.offset4{margin-left:174;}
.offset3{margin-left:133;}
.offset2{margin-left:92;}
.offset1{margin-left:51;} 
```

经过多次反复试验，我发现如果我完全删除 HTML 文件顶部的 Doctype 行，页面将正确显示！此行为在 Firefox (19.02) 和 IE 10 上是一致的。

当我在 Firebug 中检查 rowXX 和 span DIV 标签时，当 HTML 中包含 DOCTYPE 行时，CSS 被指示为空 - 请参阅下面的附加屏幕截图。

*来自 Firefox 的截屏，其中 Doctype 从 HTML 中删除：http:* [//tinypic.com/r/24gp1er/6](http://tinypic.com/r/24gp1er/6)

*[来自 Firefox 的截屏，文档类型包含在 HTML 中： http](http://tinypic.com/r/13ye05g/6) *://tinypic.com/r/13ye05g/6**

 *提前感谢您提供任何有助于解决此问题的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:54:53.810

您的 CSS 文件可能有问题。首先`@gridColumns 24px`应该是`@gridColumns 24`（即，指定列数，而不是宽度。

检查[http://fiddle.jshell.net/panchroma/pegjC/show/](http://fiddle.jshell.net/panchroma/pegjC/show/)或[jsFiddle的结果和页面源](http://fiddle.jshell.net/panchroma/pegjC/)

[您可以从https://dl.dropbox.com/u/2665617/bootstrap-24grid/css/bootstrap.css](https://dl.dropbox.com/u/2665617/bootstrap-24grid/css/bootstrap.css)和[https://dl.dropbox.com/u/2665617/bootstrap](https://dl.dropbox.com/u/2665617/bootstrap-24grid/css/bootstrap.min.css)获取我的自定义 24col css 版本[-24grid/css/bootstrap.min.css](https://dl.dropbox.com/u/2665617/bootstrap-24grid/css/bootstrap.min.css)

希望这可以帮助！*

# php - 如何使用存储的刷新令牌获取更新的访问令牌

> ID：15770674
> 
> 赞同：9
> 
> 时间：2013-04-02T17:42:54.123
> 
> 标签：php, oauth-2.0, google-analytics-api, google-api-php-client

我正在构建一个应用程序，允许管理员验证对其分析帐户的访问权限以供离线使用，并将刷新令牌存储在数据库中。

现在，当我尝试在前端使用 API 时，它返回以下错误：

```
"Access Token Expired. There wan a general error : The OAuth 2.0 access token has expired, and a refresh token is not available. Refresh tokens are not returned for responses that were auto-approved." 
```

到目前为止，这是我生成此错误的代码：

```
require_once "lib/google/Google_Client.php";
require_once "lib/google/contrib/Google_AnalyticsService.php";

$_analytics = new analytics();
$_googleClient = new Google_Client();
$_googleClient->setClientId($_analytics->gaClientId);
$_googleClient->setClientSecret($_analytics->gaClientSecret);
$_googleClient->setRedirectUri($_analytics->gaRedirectUri);
$_googleClient->setScopes($_analytics->gaScope);
$_googleClient->setAccessType($_analytics->gaAccessType);

// Returns last access token from the database (this works)
$_tokenArray['access_token'] = $_analytics->dbAccessToken($_agencyId);
$_googleClient->setAccessToken(json_encode($_tokenArray));

if($_googleClient->isAccessTokenExpired()) {
    // Don't think this is required for Analytics API V3
    //$_googleClient->refreshToken($_analytics->dbRefreshToken($_agencyId));
    echo 'Access Token Expired'; // Debug
}

if (!$_googleClient->getAccessToken()) {
    echo '<h2>Error - Admin has not setup analytics correct yet</h2>';
} 
```

我正在寻找一个运行类似 setRefreshToken 的函数 - 从数据库中输入值，从管理员之前在线验证它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T00:07:56.693

您可以尝试以下操作，您需要添加代码以将新令牌存储在数据库中。

```
if($_googleClient->isAccessTokenExpired()) {
    // Don't think this is required for Analytics API V3
    //$_googleClient->refreshToken($_analytics->dbRefreshToken($_agencyId));
    echo 'Access Token Expired'; // Debug

    $_googleClient->authenticate();
    $NewAccessToken = json_decode($_googleClient->getAccessToken());
    $_googleClient->refreshToken($NewAccessToken->refresh_token);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-01T08:06:00.763

使用 try/catch 并使用 catch 重定向/刷新访问令牌。以下是我用于类似问题的解决方案：

```
$plus = new Google_Service_Plus($client);
try {
$me = $plus->people->get('me');
} catch(Exception $e){
        if(!(strpos($_SERVER["REQUEST_URI"],'logout'))){
         if (isset($authUrl)){
                $redirect = $authUrl;
        }
        else{
                  $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['SCRIPT_NAME'] .'?logout';
        }
        header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));
        exit;
} 
```

您可以将 try 下的语句替换为抛出异常的行，我想那是

```
$_googleClient->setClientId($_analytics->gaClientId); 
```

或者您也可以尝试按照此处给出的解决方案刷新令牌：

[https://stackoverflow.com/a/22096740/1675384](https://stackoverflow.com/a/22096740/1675384)

# c# - ClientBase 没有实现 IDisposable 成员

> ID：15770683
> 
> 赞同：11
> 
> 时间：2013-04-02T17:43:29.140
> 
> 标签：c#, .net, wcf, c#-4.0, idisposable

如果 Dispose() 方法声明不可见/未声明，System.ServiceModel.ClientBase 抽象类如何实现 IDisposable 接口？

如果我尝试做同样的事情，我会收到错误并且无法编译

```
abstract class ATeste : IDisposable
{
} 
```

'ATTeste' 没有实现接口成员 'System.IDisposable.Dispose()'

我正在使用 VS 2010 和 Framework 4.0。

检查 ClientBase 声明：

```
 // Summary:
//     Provides the base implementation used to create Windows Communication Foundation
//     (WCF) client objects that can call services.
//
// Type parameters:
//   TChannel:
//     The channel to be used to connect to the service.
public abstract class ClientBase<TChannel> : ICommunicationObject, IDisposable where TChannel : class
{
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class using the default target endpoint from the application configuration
    //     file.
    //
    // Exceptions:
    //   System.InvalidOperationException:
    //     Either there is no default endpoint information in the configuration file,
    //     more than one endpoint in the file, or no configuration file.
    protected ClientBase();
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class using the callbackInstance as the callback object in a duplex conversation.
    //
    // Parameters:
    //   callbackInstance:
    //     The callback object that the client application uses to listen for messages
    //     from the connected service.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The callback instance is null.
    //
    //   System.InvalidOperationException:
    //     Either there is no default endpoint information in the configuration file,
    //     more than one endpoint in the file, or no configuration file.
    protected ClientBase(InstanceContext callbackInstance);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class using the configuration information specified in the application configuration
    //     file by endpointConfigurationName.
    //
    // Parameters:
    //   endpointConfigurationName:
    //     The name of the endpoint in the application configuration file.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The specified endpoint information is null.
    //
    //   System.InvalidOperationException:
    //     The endpoint cannot be found or the endpoint contract is not valid.
    protected ClientBase(string endpointConfigurationName);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class using the specified binding and target address.
    //
    // Parameters:
    //   binding:
    //     The binding with which to make calls to the service.
    //
    //   remoteAddress:
    //     The address of the service endpoint.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The binding is null.
    //
    //   System.ArgumentNullException:
    //     The remote address is null.
    protected ClientBase(Binding binding, EndpointAddress remoteAddress);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class using the specified callback service and endpoint configuration information.
    //
    // Parameters:
    //   callbackInstance:
    //     The callback object that the client uses to listen for messages from the
    //     connected service.
    //
    //   endpointConfigurationName:
    //     The name of the endpoint in the application configuration file.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The callback instance is null.
    //
    //   System.ArgumentNullException:
    //     The endpoint is null.
    //
    //   System.InvalidOperationException:
    //     The endpoint cannot be found or the endpoint contract is not valid.
    protected ClientBase(InstanceContext callbackInstance, string endpointConfigurationName);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class using the specified target address and endpoint information.
    //
    // Parameters:
    //   endpointConfigurationName:
    //     The name of the endpoint in the application configuration file.
    //
    //   remoteAddress:
    //     The address of the service.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The endpoint is null.
    //
    //   System.ArgumentNullException:
    //     The remote address is null.
    //
    //   System.InvalidOperationException:
    //     The endpoint cannot be found or the endpoint contract is not valid.
    protected ClientBase(string endpointConfigurationName, EndpointAddress remoteAddress);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class.
    //
    // Parameters:
    //   endpointConfigurationName:
    //     The name of the endpoint in the application configuration file.
    //
    //   remoteAddress:
    //     The address of the service.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The endpoint is null.
    //
    //   System.ArgumentNullException:
    //     The remote address is null.
    //
    //   System.InvalidOperationException:
    //     The endpoint cannot be found or the endpoint contract is not valid.
    protected ClientBase(string endpointConfigurationName, string remoteAddress);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class.
    //
    // Parameters:
    //   callbackInstance:
    //     The callback service.
    //
    //   binding:
    //     The binding with which to call the service.
    //
    //   remoteAddress:
    //     The address of the service endpoint.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The callback instance is null.
    //
    //   System.ArgumentNullException:
    //     The binding is null.
    //
    //   System.ArgumentNullException:
    //     The remote address is null.
    protected ClientBase(InstanceContext callbackInstance, Binding binding, EndpointAddress remoteAddress);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class.
    //
    // Parameters:
    //   callbackInstance:
    //     The callback object that the client uses to listen for messages from the
    //     connected service.
    //
    //   endpointConfigurationName:
    //     The name of the endpoint in the application configuration file.
    //
    //   remoteAddress:
    //     The address of the service.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The callback instance is null.
    //
    //   System.ArgumentNullException:
    //     The endpoint is null.
    //
    //   System.ArgumentNullException:
    //     The remote address is null.
    //
    //   System.InvalidOperationException:
    //     The endpoint cannot be found or the endpoint contract is not valid.
    protected ClientBase(InstanceContext callbackInstance, string endpointConfigurationName, EndpointAddress remoteAddress);
    //
    // Summary:
    //     Initializes a new instance of the System.ServiceModel.ClientBase<TChannel>
    //     class.
    //
    // Parameters:
    //   callbackInstance:
    //     The callback object that the client uses to listen for messages from the
    //     connected service.
    //
    //   endpointConfigurationName:
    //     The name of the endpoint in the application configuration file.
    //
    //   remoteAddress:
    //     The address of the service.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     The callback instance is null.
    //
    //   System.ArgumentNullException:
    //     The endpoint is null.
    //
    //   System.ArgumentNullException:
    //     The remote address is null.
    //
    //   System.InvalidOperationException:
    //     The endpoint cannot be found or the endpoint contract is not valid.
    protected ClientBase(InstanceContext callbackInstance, string endpointConfigurationName, string remoteAddress);

    // Summary:
    //     Gets the inner channel used to communicate with the service.
    //
    // Returns:
    //     An implementation of the target service contract interface passed as the
    //     type parameter to the constructor.
    protected TChannel Channel { get; }
    //
    // Summary:
    //     Gets the underlying System.ServiceModel.ChannelFactory<TChannel> object.
    //
    // Returns:
    //     A System.ServiceModel.ChannelFactory<TChannel> object.
    public ChannelFactory<TChannel> ChannelFactory { get; }
    //
    // Summary:
    //     Gets the client credentials used to call an operation.
    //
    // Returns:
    //     Returns a System.ServiceModel.Description.ClientCredentials that represents
    //     the proof of identity presented by the client.
    public ClientCredentials ClientCredentials { get; }
    //
    // Summary:
    //     Gets the target endpoint for the service to which the WCF client can connect.
    //
    // Returns:
    //     The target endpoint.
    public ServiceEndpoint Endpoint { get; }
    //
    // Summary:
    //     Gets the underlying System.ServiceModel.IClientChannel implementation.
    //
    // Returns:
    //     The client channel for the WCF client object.
    public IClientChannel InnerChannel { get; }
    //
    // Summary:
    //     Gets the current state of the System.ServiceModel.ClientBase<TChannel> object.
    //
    // Returns:
    //     The value of the System.ServiceModel.CommunicationState of the object.
    public CommunicationState State { get; }

    // Summary:
    //     Causes the System.ServiceModel.ClientBase<TChannel> object to transition
    //     immediately from its current state into the closed state.
    public void Abort();
    //
    // Summary:
    //     Causes the System.ServiceModel.ClientBase<TChannel> object to transition
    //     from its current state into the closed state.
    public void Close();
    //
    // Summary:
    //     Returns a new channel to the service.
    //
    // Returns:
    //     A channel of the type of the service contract.
    protected virtual TChannel CreateChannel();
    //
    // Summary:
    //     Instructs the inner channel to display a user interface if one is required
    //     to initialize the channel prior to using it.
    public void DisplayInitializationUI();
    //
    // Summary:
    //     Replicates the behavior of the default keyword in C#.
    //
    // Type parameters:
    //   T:
    //
    // Returns:
    //     Returns null if T is a reference type and zero if T is a numeric value type.
    protected T GetDefaultValueForInitialization<T>();
    protected void InvokeAsync(ClientBase<TChannel>.BeginOperationDelegate beginOperationDelegate, object[] inValues, ClientBase<TChannel>.EndOperationDelegate endOperationDelegate, SendOrPostCallback operationCompletedCallback, object userState);
    //
    // Summary:
    //     Causes the System.ServiceModel.ClientBase<TChannel> object to transition
    //     from the created state into the opened state.
    public void Open();

    // Summary:
    //     A delegate that is used by System.ServiceModel.ClientBase<TChannel>.InvokeAsync(System.ServiceModel.ClientBase.BeginOperationDelegate,System.Object[],System.ServiceModel.ClientBase.EndOperationDelegate,System.Threading.SendOrPostCallback,System.Object)
    //     for calling asynchronous operations on the client.
    //
    // Parameters:
    //   inValues:
    //     The input values to the asynchronous call.
    //
    //   asyncCallback:
    //     Reference to the method to be called when the corresponding asynchronous
    //     operation completes.
    //
    //   state:
    //     An System.Object that lets the client distinguish between different asynchronous
    //     calls. It is made available to the client in the arguments parameter of the
    //     event completion callback.
    //
    // Returns:
    //     The result of the asynchronous call.
    protected delegate IAsyncResult BeginOperationDelegate(object[] inValues, AsyncCallback asyncCallback, object state);

    // Summary:
    //     A delegate that is invoked by System.ServiceModel.ClientBase<TChannel>.InvokeAsync(System.ServiceModel.ClientBase.BeginOperationDelegate,System.Object[],System.ServiceModel.ClientBase.EndOperationDelegate,System.Threading.SendOrPostCallback,System.Object)
    //     on successful completion of the call made by System.ServiceModel.ClientBase<TChannel>.InvokeAsync(System.ServiceModel.ClientBase.BeginOperationDelegate,System.Object[],System.ServiceModel.ClientBase.EndOperationDelegate,System.Threading.SendOrPostCallback,System.Object)
    //     to System.ServiceModel.ClientBase<TChannel>.BeginOperationDelegate.
    //
    // Parameters:
    //   result:
    //     The result returned by the call made by System.ServiceModel.ClientBase<TChannel>.InvokeAsync(System.ServiceModel.ClientBase.BeginOperationDelegate,System.Object[],System.ServiceModel.ClientBase.EndOperationDelegate,System.Threading.SendOrPostCallback,System.Object)to
    //     System.ServiceModel.ClientBase<TChannel>.BeginOperationDelegate.
    //
    // Returns:
    //     An array of System.Object that contains the results of the call to the asynchronous
    //     method. The operation may have multiple return values, which are all returned
    //     in this object array.
    protected delegate object[] EndOperationDelegate(IAsyncResult result);

    // Summary:
    //     Stores the results from an asynchronous call made by the client.
    protected class InvokeAsyncCompletedEventArgs : AsyncCompletedEventArgs
    {
        // Summary:
        //     Gets the results from an asynchronous call made by the client.
        //
        // Returns:
        //     An array of System.Object that contains the results from an asynchronous
        //     call made by the client.
        public object[] Results { get; }
    }
} 
```

* * *

我再次测试，但这次明确实现 IDisposable。现在它是有道理的

```
abstract class ATest : IDisposable
{
    void IDisposable.Dispose()
    {
        throw new NotImplementedException();
    }
}

class Test : ATest
{
} 
```

现在，当我实例化测试类时，我无法访问 Dispose() 方法：

```
 Test t = new Test();
        t.Dispose(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-02T17:47:22.367

[使用显式接口实现](http://msdn.microsoft.com/en-us/library/aa288461%28v=vs.71%29.aspx)。

`IDisposable`是可见的，可以调用为

```
var client = new WCFTestServiceClient(); // assumingWCFTestServiceClient is WCF client proxy that inherits from ClientBase
(client as IDisposable).Dispose(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-02T18:02:49.007

正如几乎每个人都指出的那样，接口方法是显式实现的。您看到的源代码`ClientBase<TChannel>`是`from Metadata`（请参阅[元数据作为](http://msdn.microsoft.com/en-us/library/ms236403%28v=vs.80%29.aspx "元数据作为源")Visual Studio 中的源）。请注意缺少任何函数或`partial`关键字的实现。

Visual Studio 不会显示显式实现的接口成员`from Metadata`（请参阅[Stack Overflow 问题 72686320](https://stackoverflow.com/questions/7268632/why-does-the-vs-metadata-view-does-not-display-explicit-interface-implemented-me)）

* * *

编辑：

**必须直接从接口调用显式**实现的接口方法（这就是它与**隐式**实现的不同之处）。正确的调用方式如下

```
using System;

abstract class ATest : IDisposable
{
    void IDisposable.Dispose()
    {
        throw new NotImplementedException();
    }
}

class Test : ATest
{
}

class OtherClass
{
    public static void Main()
    {
        Test t = new Test();
        ((IDisposable)t).Dispose();
    }
} 
```

结果是`Unhandled Exception: System.NotImplementedException: The requested feature is not implemented.`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-02T17:48:00.853

`ClientBase<TChannel>``IDisposable`使用[显式接口实现](http://msdn.microsoft.com/en-us/library/ms173157.aspx)来实现。

对此的实现只是调用close：

```
void IDisposable.Dispose()
{
    this.Close();
} 
```

# jcl - NOTIFY=&SYSUID 是什么意思？

> ID：15770686
> 
> 赞同：1
> 
> 时间：2013-04-02T17:43:54.073
> 
> 标签：jcl

`NOTIFY=&SYSUID`JCL 的第一行是什么意思？例如在下面的声明中：

```
//DEV1000D JOB (0998,DEV,000,US),'TEST',        
//         CLASS=D,MSGCLASS=V,NOTIFY=&SYSUID 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:48:26.423

`NOTIFY=&SYSUID`表示提交作业的用户应在作业完成时收到通知。

从 MVS JCL 手册： **通知：**

> 在非 APPC 调度环境中，请求系统在此后台作业完成时向用户 ID 发送消息。

**&SYSUID**

> 系统将 &SYSUID 替换为作业将在其权限下运行的用户 ID，通常是以下之一：
> 
> *   JOB 语句中的 USER 参数（如果指定），或
> *   提交作业的用户 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-21T04:12:58.757

让我解释一下什么是**NOTIFY**

NOTIFY 语句是指示系统，它必须在完成工作后发送成功失败消息。

`syntax :NOTIFY=userid/&SYSUID`

简单地说，通知必须发送给哪个用户 &SYSID 是提交 jcl 的用户 ID

例如：NOTIFY=TRC033 将发送成功/失败消息到 trc033

NOTIFY=&SYSUID 将发送发送/失败消息给提交作业的用户

# maven - 在 maven 中本地安装 jar，但 maven 仍然在 Intranet repo 中搜索 jar

> ID：15770689
> 
> 赞同：1
> 
> 时间：2013-04-02T17:43:57.537
> 
> 标签：maven

我是 Maven 环境的新手。在我的项目中，我需要使用我在本地安装的外部 jar，但是在构建编译时，maven 仍然搜索 Intranet repo 并且构建编译失败。在日志中，我可以看到它在进行 make 时安装了外部 jar，但是在编译时（或者可能是在项目 pom 并找到依赖项时）它尝试再次从 Intranet repo 下载相同的 jar 并失败。

这是我在makefile中用来在本地安装jar的命令，

```
$(MVNBLD) install:install-file -Dfile=jarName.jar -DgroupId=com.example.project -DartifactId=jarName -Dversion=1.0 -Dpackaging=jar -Dgenerate`enter code here`Pom=true -gs settings.xml 
```

有什么办法可以强制 maven 去查看本地 repo 而不是上网。

=============

我尝试了[Maven 中给出的解决方案：通过相对路径向 jar 添加依赖项](https://stackoverflow.com/questions/2229757/maven-add-a-dependency-to-a-jar-by-relative-path)...。​​至少我没有遇到 jar 下载问题。但它仍然无法使用以下错误编译构建，

```
Exception in thread "main" java.lang.NoClassDefFoundError: '-Xmx1024m
Caused by: java.lang.ClassNotFoundException: '-Xmx1024m
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: '-Xmx1024m.  Program will`enter code here` exit.
make: *** [prod_jar] Error 1
Command finished (error code: 2) 
```

它仍然没有找到依赖jar吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T11:41:08.493

> 线程“主”java.lang.NoClassDefFoundError 中的异常：'-Xmx1024m

这意味着您的`MAVEN_OPTS`环境变量定义错误。检查您是否有`'`字符并删除。

# html - Angular Seed项目，默认设置index.html

> ID：15770693
> 
> 赞同：0
> 
> 时间：2013-04-02T17:44:13.873
> 
> 标签：html, node.js, angularjs

我正在使用[Angular Seed 项目](https://github.com/angular/angular-seed)来构建一个简单的网站。当我启动节点服务器并在 localhost:8000 输入 url 时，它会提供目录内容。我希望它提供 index.html 文件，但希望在没有重定向的情况下执行此操作。

我相信我需要修改以下函数，并且我应该更改`isDirectory`检查的代码，但我不确定这是否是正确的方法。任何建议，将不胜感激。

```
StaticServlet.prototype.handleRequest = function(req, res) {
    var self = this;
    var path = ('./' + req.url.pathname).replace('//','/').replace(/%(..)/g, function(match, hex){
        return String.fromCharCode(parseInt(hex, 16));
    });
    var parts = path.split('/');
    if (parts[parts.length-1].charAt(0) === '.')
        return self.sendForbidden_(req, res, path);
    fs.stat(path, function(err, stat) {
        if (err)
            return self.sendMissing_(req, res, path);
        if (stat.isDirectory())
            return self.sendDirectory_(req, res, path);
        return self.sendFile_(req, res, path);
    });
} 
```

* * *

**更新#1**

我有两个屏幕截图要澄清。第一张图是我目前得到的，第二张图是我想要的。

**我得到什么** ![我得到什么](https://i.imgur.com/C7ISpOR.png)

* * *

**我想要的是** ![我想要的是](https://i.stack.imgur.com/fEtVV.png)

* * *

**更新#2**

使用下面的 Restify 链接，我发现以下示例正是我所需要的。

```
var server = restify.createServer();
var io = socketio.listen(server);

server.get('/', function indexHTML(req, res, next) {
    fs.readFile(__dirname + '/index.html', function (err, data) {
        if (err) {
            next(err);
            return;
        }

        res.setHeader('Content-Type', 'text/html');
        res.writeHead(200);
        res.end(data);
        next();
});

io.sockets.on('connection', function (socket) {
    socket.emit('news', { hello: 'world' });
    socket.on('my other event', function (data) {
            console.log(data);
    });
});

server.listen(8080, function () {
    console.log('socket.io server listening at %s', server.url);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T17:32:26.180

angular-seed 项目是客户端的起点，但实际上不是服务器端的起点。它们包括一个没有依赖关系的简单 Web 服务器节点脚本。这样你就不需要 npm 或其他模块。

对于服务器端，您可以将 node 与[connect](http://senchalabs.org/connect) / [express](http://expressjs.com)或任何其他 Web 服务器/语言一起使用。您只需要提供休息服务并提供一些静态 html。

由于您已经安装了 Node ， [restify](http://mcavage.github.io/node-restify/)可能适合您。

**更新**：我创建了一个使用 angular-seed 和 restify 的基本示例：
[https ://github.com/roelandmoors/restify-angular-seed](https://github.com/roelandmoors/restify-angular-seed)

# javascript - 隐藏的 Backbone.js 模型

> ID：15770700
> 
> 赞同：0
> 
> 时间：2013-04-02T17:44:30.813
> 
> 标签：javascript, backbone.js

我在玩backbone.js 并陷入了僵局。这是我的代码：

```
window.Car = Backbone.Model.extend();
window.CarCollection = Backbone.Collection.extend( {
    model: Car,
    url:"../api/car/",

});

window.CarListView = Backbone.View.extend({
    tagName:'ul',

    initialize: function() {
        this.model.on("reset", this.render);
    },

    render: function (eventName) {
        console.log(this.model);        //is an object
        console.log(this.model.models); //is an empty array

        return this;
    },
});

 // Router
var AppRouter = Backbone.Router.extend({

    routes:{
        "":"list",
        "cars/:id":"carDetails"
    },

    list:function () {
        this.carList = new CarCollection();
        this.carListView = new CarListView({model:this.carList});
        this.carList.fetch();
        $('#sidebar').html(this.carListView.render().el);
    },

});

$(function () {
    app = new AppRouter();
    Backbone.history.start();
}); 
```

我没有足够的声誉来发布图片，所以这里是来自 chrome 开发者工具的控制台的文本版本：

```
V r {length: 0, models: Array[0], _byId: Object, _events: Object, constructor: function…}
    > _byId: Object
    > _events: Object
    > length: 4
    > models: Array[4]
    > __proto__: s 
```

我的问题是我正在尝试访问似乎“隐藏”在空模型后面的非空模型属性。如何访问长度为 4 的模型属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:50:59.317

这是一个控制台怪癖，但这里的核心问题很常见 - 您正在调用`.fetch()`（异步加载）然后立即调用`.render()`，期望加载数据。您需要等到数据加载后才能访问它 - 有几种方法可以做到这一点，但最简单的可能是将`success`回调传递给`fetch`：

```
var carListView = this.carListView;
this.carList.fetch({
    success: function() {
          $('#sidebar').html(carListView.render().el);
    }
}); 
```

控制台奇怪地记录了这一点，因为当您`console.log`在集合尚未加载时调用（显示`Array[0]`）但在加载完成后手动检查它（显示`Array[4]`）。

# html - css如何创建导航栏

> ID：15770701
> 
> 赞同：0
> 
> 时间：2013-04-02T17:44:33.017
> 
> 标签：html, css, xhtml

我正在尝试用 CSS 制作这个。试图制作这个导航栏。任何帮助都会很棒。这就是我想要做的：

![在此处输入图像描述](https://i.stack.imgur.com/XB4Jw.png)

所以第一张图片是用户进入网站时的样子。然后，如果他们将鼠标悬停在任何选项卡上，它应该只是改变颜色。任何试图做到这一点的帮助都会很棒。我试过这个但不会工作。

HTML：

```
<div class="horizontal">
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="Register.html">Register</a></li>
<li><a href="Rules.html">Rules</a></li>
</ul>
</div> 
```

只需要看看css会是什么样子。再次感谢

编辑我所做的事情，因为人们想要 2 看到：

```
div.horizontal
{
width:809px;
height:63px;
position:relative;
top: -1046px;
left: 104px;
}
div.horizontal ul
{
list-style-type:none;
margin:0;
padding:0;
}
div.horizontal li
{
  display: inline-block;
  margin-left: 5px;
}
div.horizontal a
{
display:block;
width:809px;
}
div.horizontal a:link,div.horizontal a:visited
{
font-weight:bold;
color:#FFFFFF;
background-color:#000000;
text-align:center;
padding:4px;
text-decoration:none;
text-transform:uppercase;
}
div.horizontal a:hover,div.horizontal a:active
{
background-color:#999999;
} 
```

就像我说的那样，这是不对的，但这就是我能做的。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:52:31.747

使用您的**HTML**，您可以执行以下操作：

**CSS**

```
ul{
    list-style:none;
}

li{
    float:left;
    width:100px;
    height:50px;
    background:black;
    border:2px solid gray;
    text-align:center;
}

a{
    color:white;
    text-decoration:none;
    font-size:24px;
    font-weight:bold;
    line-height:50px;
    font-style:italic
}

li:hover{
    background:gray;
} 
```

[JSF](http://jsfiddle.net/NuePK/)中。

只是改变颜色。

# javascript - 发送 Google Analytics 事件，然后立即离开

> ID：15770702
> 
> 赞同：10
> 
> 时间：2013-04-02T17:44:34.783
> 
> 标签：javascript, google-analytics

我可以像这样发送 Google Analytics 事件并立即离开吗？

```
_gaq.push(['_trackEvent', 'foobar']);
window.location = "/"; 
```

如果 Google Analytics 在调用它时执行某种 AJAX 请求，那么无论我们是否停留在页面上，它都应该可以工作。我担心的是，它似乎有时只是将东西放入数组中以供以后处理。我认为这只会在最初发生，当时谷歌分析还没有时间初始化，但我想确定这一点。

我用 GA 调试做了一个测试，它似乎奏效了，但我不确定这是否意味着它总是取决于加载速度，而不是什么。

我可以这样做并且永远不会丢失任何事件吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T18:03:42.043

我这样做的方式是这样的：

```
_gaq.push(['_trackEvent', '...', '...', '...']);
_gaq.push(function(){
    // do stuff here
});

$('#logo').on('click', function(){
    var curPage = window.location.href;
    _gaq.push(['_trackEvent', curPage, '#logo']);
    _gaq.push(function(){
        window.location.href = '/';
    });
}); 
```

第二个推送调用将始终在第一个之后运行，因为 Google 将所有推送调用排队，因此第一个将运行并完成，*然后*第二个将运行并完成。Google 允许您将函数放入 push 方法中，以便您可以对它们进行排队。

来源：[https ://developers.google.com/analytics/devguides/collection/gajs/#PushingFunctions](https://developers.google.com/analytics/devguides/collection/gajs/#PushingFunctions)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-03T14:53:07.110

`setTimeout`如果新页面没有在新窗口中打开，我会稍微延迟（通过）。

我还没有机会尝试这个，但谷歌新的[Universal Analytics](https://developers.google.com/analytics/devguides/collection/analyticsjs/?hl=en)有一个[`hitCallback`](https://developers.google.com/analytics/devguides/collection/analyticsjs/advanced#hitCallback)在数据发送后执行的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-08T22:35:48.777

[@mike](https://stackoverflow.com/a/15790747/1081234)提到[`hitCallback`](https://developers.google.com/analytics/devguides/collection/analyticsjs/advanced#hitCallback)了 analytics.js 文档中描述的方法：

> 在某些情况下，例如当您跟踪出站链接时，您可能想知道跟踪器何时完成发送数据。这样，只有在用户的点击被报告给 Google Analytics（分析）后，您才能将用户发送到他们的目的地。为了解决这个问题，send 命令允许您在字段名称对象中指定一个 hitCallback 函数，该函数将在 analytics.js 完成发送数据后立即执行。

这太棒了，除了该片段*仍*处于公开测试阶段。如果由于某种原因（*啊哈*技术恐惧政策*啊哈*）您仅限于 ga.js 功能，您可以使用[此解决方法](http://www.joelpeterson.com/blog/2013/02/using-hitcallback-in-google-analytics-with-ga-js/)：

```
_gaq.push(['_set', 'hitCallback', function(){
  document.location='someOtherPage.html';   
}]);
_gaq.push(['_trackEvent', 'category', 'event', 'value']); 
```

`_gaq`另一个明智的建议是，如果未定义回调，则立即执行回退。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:51:34.147

看起来您对失去赛事的担忧是合理的，请参阅[这个问题](https://stackoverflow.com/questions/3427580/race-condition-and-using-google-analytics-asynchronous-gaq-synchronously)。[关于谷歌更改其代码的一个答案](https://stackoverflow.com/a/5251741/403846)似乎有点脆弱，但可以让您在导航到链接之前确认事件跟踪。那可能是“近乎立即的”。

# jquery - 使用 jQuery 向上滑动和删除子菜单

> ID：15770704
> 
> 赞同：0
> 
> 时间：2013-04-02T17:44:38.780
> 
> 标签：jquery, submenu

这是有问题的代码：

```
 $('a.delete').click(function(e) {

            e.preventDefault();
            var parent = $(this).parent();

            $.ajax({
                type: 'get',
                url: 'deletemenu.php',
                data: 'ajax=1&delete=' + parent.attr('id').replace('menu-',''),
                beforeSend: function() {
                parent.animate({'backgroundColor':'#fb6c6c'},300);
            },
                    success: function() {

                    parent.slideUp(300,function() {
                        parent.remove();
                    });

                    $('.menusub').slideUp(300,function() {
                        $('.menusub').remove();
                    });
                }
            });
        }); 
```

好的，我想做的是向上滑动并删除特定菜单下的所有子菜单（删除此菜单时）。现在我有`$('.menusub').slideUp(300,function() { $('.menusub').remove(); });`。为达到这个。当然，这段代码的问题在于它会使所有子菜单（具有 menusub 类）消失。我如何确保只有特定菜单下的子菜单才会消失？

顺便说一下，这是查看菜单的代码

```
 $result = mysql_query("SELECT * FROM Menu") or die(mysql_error());
        while($row = mysql_fetch_array($result)){
            echo '<div class="menu" id="menu-',$row['menu_id'],'">';
            echo $row['menu_name']. " - ". $row['menu_weight']. "<a class='delete' href='?delete=".$row['menu_id']."'> delete</a>";
            echo '</div>';

            $sub = mysql_query("SELECT * FROM SubMenu INNER JOIN Menu WHERE SubMenu.menu_id = Menu.menu_id AND Menu.Menu_id = ".$row['menu_id']."") or die(mysql_error());
            while($subrow = mysql_fetch_array($sub)){
                echo '<div class="menusub" id="menusub-',$subrow['submenu_id'],'">';
                echo "-- ".$subrow['submenu_name']." - ".$subrow['submenu_weight']."<a class='deletesub' href='?deletesub=".$subrow['submenu_id']."'> delete</a><br/>";
                echo '</div>';
            }
        }` 
```

Tnx 回复！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:13:20.790

这可能会帮助您：

改变 ：

```
$('#menusub-').slideUp(300,function() {
    $('.menusub').remove();
}); 
```

至：

```
var rowid = parent.attr('id').split('-')[1];
$('#menusub-'+rowid).slideUp(300,function() {
    $(this).remove();
}); 
```

**编辑：** 建议，`rel`向子菜单添加一个属性，如下所示：

```
rel="$row['menu_id']" 
```

并使您的脚本如下：

```
$('a.delete').click(function(e) {

    e.preventDefault();
    var parent = $(this).parent();
    parent.slideUp(300,function() {
        parent.remove();
});

var id = parent.attr('id').split('-')[1];
$('div.submenu').each(function(index, element) {
    $this = $(this);
    if($this.attr('rel') == id) {
        $this.slideUp(300,function() {
            $this.remove();
        });
    }
    });

}); 
```

# ios - 以编程方式 UIViewController 自动旋转

> ID：15770711
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:08.903
> 
> 标签：ios, objective-c, cocoa-touch, uiviewcontroller

我有一个`UIViewController`包含按钮的 XIB 文件。在`IBAction`按钮的方法中，我`UIViewController`只用一个 WebView 创建了一个新的。

```
UIViewController *onlineViewCtrl = [[UIViewController alloc]init];
[onlineViewCtrl.view addSubview:WebView]; 
```

我介绍这个新的 ViewController：

```
[self.navigationController pushViewController:onlineViewCtrl animated:YES]; 
```

这可以按预期工作，但现在在 iOS 版本 <6 上我遇到了屏幕自动旋转的问题。

`onlineViewCtrl`不旋转！通常我会包含 autorotate 方法，但如果`onlineViewCtrl`我没有自己的类或 xib，我应该怎么做？

有趣的是，在 iOS 6 上一切正常。有人知道为什么吗？但更重要的是它如何在 iOS <6 上工作？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T16:09:47.130

最后我找到了一个解决方案： 类别
我为 NavigationController 创建了自己的类别并添加了自动旋转方法。

# android - 如何使应用程序无法通过主页和后退按钮关闭？

> ID：15770716
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:17.287
> 
> 标签：android

是否可以制作只能通过该应用程序布局中的按钮而不是返回和主页 HW/SW 按钮关闭的 Android 应用程序？

我想为自己做一个单一用途的应用程序，我可以为应用程序设置所有权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:53:29.730

你不应该那样做。这就是 Home 按钮的全部目的和概念。如果您可以解释您的用例，可能有其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T18:14:57.790

在您当前的活动中，您可以使用方法覆盖后退按钮功能`onBackPressed`。

当您按下主页按钮时，`onPause`将调用方法（活动进入暂停阶段）。所以你可以用你的自定义代码覆盖它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:50:45.660

后退按钮 - 覆盖 onBackPressed 并且不调用 super.onBackPressed。我不认为你可以在家，但你可以尝试捕获击键。

# android - 翻译物体背后的动画

> ID：15770719
> 
> 赞同：2
> 
> 时间：2013-04-02T17:45:24.117
> 
> 标签：android, animation

我有翻译动画的问题。我希望动画发生在所有其他对象之上，在我的情况下，动画对象移动到其他对象后面。谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T19:05:40.390

在制作动画之前将视图移到前面。例子：

```
private void startTranslateAnimation(View v, TranslateAnimation ta)
{
    v.bringToFront();
    v.startAnimation(ta);
} 
```

# sql - 检索售出两次以上的商品

> ID：15770725
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:36.510
> 
> 标签：sql, ms-access

我有 3 个表；sale、sale_detail、item，它们的关系是 sale 1:M sale_detail 和 item 1:M sale

在项目表中

```
item_id
1
2
3
4 
```

在销售表中

```
sale_id
1
2
3 
```

在 sale_detail 表中

```
sale_id    items_id
1          1
1          2
1          3
2          2
2          3 
```

我想检索售出两次以上的商品 ID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:50:15.277

您可以使用具有属性的 group by

```
SELECT i.item_id
FROM sale_detail sd
    INNER JOIN item i ON sd.items_id = i.item_ID
    INNER JOIN sale s ON sd.sale_id = s.sale_id
GROUP BY i.item_id HAVING COUNT(s.sale_id) > 2 
```

# php - 新记录未保存且没有错误消息

> ID：15770726
> 
> 赞同：1
> 
> 时间：2013-04-02T17:45:38.503
> 
> 标签：php, activerecord, yii

我正在尝试将新行保存到报价中，但 Yii 不保存 QuoteRow。它只保存新服务（是的，数据库结构有点奇怪）。我似乎无法弄清楚。如果该行没有被保存， $qr->save() 应该返回 false 但它没有。服务已成功插入，但报价行没有。

```
$service = new Services;
$service->label = $row['title'] ?: "Övrigt";
$service->is_priced_per_unit = 1;
$service->price_per_unit = $row['price']*0.8;
$service->is_default = 0;
$service->rot_deductable = (int)isset($row['rot']);
$service->rot_deduction_percentage = 0.5;
if (!$service->save()) $this->addError('Kunde inte spara raden',$service->getErrors());
    else{
    $qr = new QuoteRows;
    $qr->quote_service_id = Yii::app()->db->getLastInsertID();
    $qr->quote_id = $id;
    $qr->unit_size = $row['amount'] ?: 0;
    $qr->raw_price = $row['price']*0.8*($row['amount'] ?: 1);
    $qr->is_rot_deductable = isset($row['rot']) ? 1 : 0;
    $qr->is_active = 1;

    if (!$qr->save()) $this->addError('Kunde inte spara raden',$qr->getErrors());
} 
```

如果 $qr 没有保存，我应该得到错误。我还尝试使用 validate-function 来验证 $qr，它声称它是完全有效的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:48:09.427

要么使用调试模式，要么在模型中使用带有 print_r($model) 的 beforeValidate、beforeSave 方法；

如果设置了所有属性，则应保存新数据；显然缺少一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-30T07:12:04.313

我有同样的问题，但我忘记了 beforSave 方法。它返回 false 但我没有设置任何错误。所以 getErrors 方法的返回数组是空的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-05T02:49:21.680

确保你的 beforeSave、afterSave 函数返回 true

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-31T07:56:50.703

您在同一个控制器中使用两个模型。最好在“服务模型”中公开将“报价行”中的所有字段导入“服务”。在保存的同时使用 POST 方法获取值并通过 QuoteRows 模型保存。您也可以在“服务模型”中添加验证条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-16T16:19:09.663

您可能在模型中使用了一个不返回 true 的事件。例如。`public function beforeSave() {....... return true;//must return true after everything}`

# jquery - 将类添加到 li 并在 jquery 中引用

> ID：15770727
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:39.143
> 
> 标签：jquery

我正在制作一个我有课的菜单

这是我的html

```
 <ul class="dropdown-menu">
       <li>
             <a href="http://localhost/final/?page_id=53">Comber Noil</a>
           </li>
           <li>
         <a href="http://localhost/final/?page_id=41" class="nav-active">Social</a>
           </li>
      </ul> 
```

这是我的jQuery

```
 $(document).ready(function() {
          $('a.nav-active').parent().addClass('myclass');    
           }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:46:51.377

您的 JavaScript 看起来正确（假设您正在等待 DOM 就绪事件），但您的标记已损坏。您需要在链接`<li>`之前添加一个开始标签：`.nav-active`

```
<ul class="dropdown-menu">
    <li>
        <a href="http://localhost/final/?page_id=53">Comber Noil</a>
    </li>
    <li>
        <a href="http://localhost/final/?page_id=41" class="nav-active">Social</a>
    </li>
</ul> 
```

* * *

编辑：根据下面的一些评论，看起来你想要的是......

*当用户单击 中的链接时`.dropdown-menu`，您想爬回到下拉列表的根目录并在`nav-active`其中的嵌套`a`元素中`li`*添加一个类？

假设是这样，这是执行此操作的 JavaScript：

```
$('.dropdown-menu > li > a').click(function(e) {
    e.preventDefault();
    $(this).closest('.dropdown').children('a').addClass('nav-active');
}); 
```

希望有帮助！

# c++ - 在 QListView 中显示向量

> ID：15770729
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:40.133
> 
> 标签：c++, qt, vector

我想知道在 QlistView 中显示矢量内容的最佳方式是什么。我对 QT 相当陌生，因此这个问题。矢量内容变化非常快，因此速度至关重要。我知道你可以通过设置模型在 QT 中设置模型

```
QStringList list;
list << "item1" << "item2" << "item3" << "item4" << "item5";
ui.listView->setModel(new QStringListModel(list)); 
```

我将如何使用向量或双端队列类型做类似的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T19:28:38.600

正如 Matt Philips 所提到的，它可以通过继承 QAbstractListModel 来完成。然而，更简单的方法是使用内置的 QList 静态成员将 QVector/std::vector 转换为 QList：

```
ui.listView->setModel(new QStringListModel(QList<QString>::fromVector(yourQVector))); 
```

或者

```
ui.listView->setModel(new QStringListModel(QList<QString>::fromStdVector(yourStdVector))); 
```

我怀疑这种转换会产生很高的开销，如果你可以通过子类化 QAbstractListModel 来显着优化......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T19:16:25.090

您需要[继承 QAbstractListModel](http://qt-project.org/doc/qt-5.0/qtcore/qabstractlistmodel.html)。这将使您可以使用所需的任何数据结构。为此，您需要实现几个纯虚函数，`rowCount()`并且`data()`. Qt 的模型/视图编程框架很好，但需要一些时间来适应，阅读他们的[指南](http://qt-project.org/doc/qt-4.8/modelview.html)可能是个好主意。

# php - 如何保持文本缩进与用户在</h1> <div id="body"><p>i am using php.my project is to build a forum...everything is fine and ok except onething...there is a <code><textarea></code> on top of my site,through which user can ask t

> ID：15770730
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:43.393
> 
> 标签：php, html, mysql, forum

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T19:03:47.537

尝试使用像 tinyMCE 这样的 WYSIWYG 编辑器，而不是使用直接文本区域，在稍微调整设置后，您将能够使用它来创建用户输入内容的 HTML，因此您可以获得换行符以转换为`<br>`标签和选项卡转换为`&nbsp;`(x4) 或 x8 或任何你想要的。您还可以删除所有控件，使其看起来不一定像 WYSIWYG 编辑器。

编辑：所见即所得（所见即所得）- tinyMCE（[http://www.tinymce.com/](http://www.tinymce.com/)）就是这样的编辑器之一。您可以按照他们网站上的说明进行操作，但它基本上是从 JS 加载并使用他们的编辑器覆盖您的文本区域。当用户单击保存或其他任何操作（您通过 JS 告诉 tinyMCE 用户已完成）时，它将按照您看到的方式获取他们的文本并将其转换为 html，转换后的文本就是您将存储在数据库中的内容。由于存储的是 html，因此所有换行符和空格都被保留。像这样的工具确实需要一些 JS 技能来实现，尝试一下，看看你会遇到什么问题。这是一种矫枉过正的解决方案。但是，如果您正确设置了 tinyMCE，它将让您完全控制存储在数据库中的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T19:53:12.527

试试这个，看看它是否有效

```
echo str_replace(array("\t","    "),"&nbsp;&nbsp;&nbsp;&nbsp;", $text); 
```

也试试

```
echo nl2br($text); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:47:20.623

用`<pre>`标签或任何带有`white-space: pre`or的标签来回显它`white-space: pre-wrap`。也用`htmlspecialchars`在上面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T20:05:05.593

好的解决方案是使用上面建议的编辑器。这很容易，您只需下载包，包括 js、css 等，然后将您的 textarea 与编辑器绑定。我用过 ckeditor（[http://ckeditor.com/](http://ckeditor.com/)）。它的作用是将您的测试转换为 html。还提供更多功能，如字体颜色、字体大小下划线、粗体、斜体等等。你可以看看这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-02T19:48:17.163

我刚刚想出了一个更简单的替代方案，可能对你有用。向您的表单 onSubmit() 添加一个函数，该函数将简单地对您的文本区域进行编码，以便您将 JS 编码的文本存储在您的数据库中，例如`document.getElementById('textArea').value = encodeURI(document.getElementById('textArea').value);`

然后你只需要解析该文本以正确显示它，我相信 php 使用 urldecode() 函数。虽然如果您需要将其转换为 HTML 以正确显示，您可能只需要进行一些 regEx 替换。

# java - 错误：org.json.JSONEXception：java.lang.String 类型的值访问无法转换为 JSONObject

> ID：15770731
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:43.900
> 
> 标签：java, android, json

我正在尝试制作一个 android 登录应用程序，如您所见，您可以使用登录按钮登录。它将向服务器发送 POST 请求，服务器将返回 JSON 数据。我的应用程序接收数据但无法解析它。在此之后它不会做任何事情，但我首先想让它工作。这是我的代码：

**MainActivity.java**

```
public class MainActivity extends Activity {

private static String readAll(Reader rd) throws IOException {
    StringBuilder sb = new StringBuilder();
    int cp;
    while ((cp = rd.read()) != -1) {
      sb.append((char) cp);
    }
    return sb.toString();
  }

  public static JSONObject readJsonFromUrl(String url) throws IOException, JSONException {
    InputStream is = new URL(url).openStream();
    try {
      BufferedReader rd = new BufferedReader(new InputStreamReader(is, Charset.forName("UTF-8")));
      String jsonText = readAll(rd);
      JSONObject json = new JSONObject(jsonText);
      return json;
    } finally {
      is.close();
    }
  }

  private EditText inpUsername;
  private EditText inpPassword;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    inpUsername = (EditText) findViewById(R.id.inpUsername);
    inpPassword = (EditText) findViewById(R.id.inpPassword);

}

public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

public void checkLogin(View v)
{
    new DoLoginAsyncTask().execute();
}   

  private class DoLoginAsyncTask extends AsyncTask<String, Void, String> {      
    private ProgressDialog LoadingDialog;
    String response = "";

    String LoadingDialogLoggingIn = getResources().getString(R.string.logging_in);

    @Override
    protected void onPreExecute() {
        LoadingDialog = new ProgressDialog(MainActivity.this);
        LoadingDialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
        LoadingDialog.setMessage(LoadingDialogLoggingIn);
        LoadingDialog.setCancelable(false);
        LoadingDialog.show();
    }

    @Override
    protected String doInBackground(String... params) {
        String username = inpUsername.getText().toString();
        String password = inpPassword.getText().toString();

        // Creating HTTP client
        HttpClient httpClient = new DefaultHttpClient();

        // Creating HTTP Post
        HttpPost httpPost = new HttpPost("http://mysite/");

        // Building post parameters
        // key and value pair
        List<NameValuePair> nameValuePair = new ArrayList<NameValuePair>(2);
        nameValuePair.add(new BasicNameValuePair("tag", "login"));
        nameValuePair.add(new BasicNameValuePair("username", username));
        nameValuePair.add(new BasicNameValuePair("password", password));

        // Url Encoding the POST parameters
        try {
            httpPost.setEntity(new UrlEncodedFormEntity(nameValuePair));
        } catch (UnsupportedEncodingException e) {
            // writing error to Log
            e.printStackTrace();
            response = response+"printStackTrace";
        }

        // Making HTTP Request
        try {
            HttpResponse response = httpClient.execute(httpPost);

            // writing response to log
            Log.d("Http Response:", response.toString());
        } catch (ClientProtocolException e) {
            // writing exception to log
            e.printStackTrace();
            response = response+"ClientProtocolException";
        } catch (IOException e) {
            // writing exception to log
            e.printStackTrace();
            response = response+"IOException";
        } 

        try{
            JSONObject json = readJsonFromUrl("http://mysite/");
            System.out.println(json.toString());
            System.out.println(json.get("id"));
        } catch(IOException e) {
            e.printStackTrace();
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return response;
    }

    @Override
    protected void onPostExecute(String result) {
        LoadingDialog.dismiss();
        LoadingDialog = null;
        if(response != "") {
            Toast.makeText(getApplicationContext(), response, Toast.LENGTH_LONG).show();
        }
    }

}

} 
```

**服务器上的PHP代码：**

```
<?php
header('Content-type: application/json; charset=utf-8');
if (isset($_REQUEST['tag']) && $_REQUEST['tag'] != '') {
$tag = $_REQUEST['tag'];
require 'config.php';
$response = array("tag" => $tag, "success" => 0, "error" => 0);
mysql_connect("$mysql_host", "$mysql_username", "$mysql_password") or die(mysql_error()); 
mysql_select_db("$mysql_db_name") or die(mysql_error());

if($tag='login') {
    if(isset($_REQUEST['username']) && $_REQUEST['username'] != '' && isset($_REQUEST['password']) && $_REQUEST['password'] != '') {
        $username = $_REQUEST['username'];
        $password = $_REQUEST['password'];
        $hash = md5($password);
        $search = mysql_query("SELECT * FROM users WHERE username='".$username."' AND password='".$hash."' AND active='1'") or die(mysql_error());
        $match  = mysql_num_rows($search);
        $result = mysql_fetch_array($search);
        if($match > 0) {
            $response['tag']="login";
            $response['success']="1";
            $response['error']="0"; 
            $response['uid']=$result['id'];
            $response['username']=$result['username'];
            $response['name']=$result['name'];
            $response['surname']=$result['surname'];
            $response['email']=$result['email'];
        } else {
            $response['tag']="login";
            $response['success']="0";
            $response['error']="10";
        }
    } else {
        //username or password not filled in
        $response['tag']="login";
        $response['success']="0";
        $response['error']="11";
    }
}

            echo json_encode($response);

} else {
echo 'Access denied';
}
?> 
```

**来自服务器的 JSON 响应示例：**

```
{"tag":"login","success":"0","error":"10"} 
```

**我从 LogCat 得到的错误：**

```
org.json.JSONException: Value Access of type java.lang.String cannot be converted to JSONObject
at org.json.JSON.typeMismatch(JSON.java:107)
at org.json.JSONObject.<init>(JSONObject.java:158)
at org.json.JSONObject.<init>(JSONObject.java:171)
at com.example.myapp.MainActivity.readJsonFromUrl(MainActivity.java:56)
at com.example.myapp.MainActivity$DoLoginAsyncTask.doInBackground(MainActivity.java:147)
at com.example.myapp.MainActivity$DoLoginAsyncTask.doInBackground(MainActivity.java:1)
at android.os.AsyncTask$2.call(AsyncTask.java:185)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019) 
```

我希望你能帮助我解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:52:52.913

你回来了：`Access denied`这意味着你的 if 语句返回 false。我离开了`PHP`很长一段时间，但`if($tag='login')`看起来不对，你的意思是`if($tag=='login')`？

在 Java 上，赋值`=`总是返回 true，不确定这在 PHP 上的行为是否不同。

PS：如果你期望 JSON，你也应该返回一个有效的 json 错误对象而不是一个`Access Denied`字符串。例如，让您的 json 响应包含`"status"`with`success`或`failure`简单地检查。这将很容易区分成功响应或失败响应。

PPS：我看到你尝试过，`$response = array("tag" => $tag, "success" => 0, "error" => 0);`所以基本上在那里添加错误代码或类似内容并返回它而不是字符串。

**编辑** 你正在做两个请求，你知道吗？

```
// Making HTTP Request
try {
    // Fist request! With your tag and username and more
    HttpResponse response = httpClient.execute(httpPost);

    // writing response to log
    Log.d("Http Response:", response.toString());
} catch (ClientProtocolException e) {
    // writing exception to log
    e.printStackTrace();
    response = response+"ClientProtocolException";
} catch (IOException e) {
    // writing exception to log
    e.printStackTrace();
    response = response+"IOException";
} 

try{
    // second request! No tag, username...
    JSONObject json = readJsonFromUrl("http://mysite/");
    System.out.println(json.toString());
    System.out.println(json.get("id"));
} catch(IOException e) {
    e.printStackTrace();
} catch (JSONException e) {
    e.printStackTrace();
} 
```

改变它并尝试组合它：

```
try {
    // Fist request! With your tag and username and more
    HttpResponse response = httpClient.execute(httpPost);

    // writing response to log
    Log.d("Http Response:", response.toString());
    // try to parse it to json
    JSONObject json = new JSONObject(response.toString());
    // do what ever you like...
} catch (ClientProtocolException e) {
    // writing exception to log
    e.printStackTrace();
    response = response+"ClientProtocolException";
} catch (IOException e) {
    // writing exception to log
    e.printStackTrace();
    response = response+"IOException";
} 
```

# postgresql - 在 PostgreSQL 9.2 中更新数据库行而不锁定表

> ID：15770734
> 
> 赞同：9
> 
> 时间：2013-04-02T17:45:54.630
> 
> 标签：postgresql, sql-update, database-cursor

尝试使用 PostgreSQL 9.2 在表上运行这样的更新语句：

```
UPDATE table
    SET a_col = array[col]; 
```

我们需要能够在大约 10M 行的表上运行它，而不是让它锁定表（因此在更新运行时仍然可以进行正常操作）。我相信使用游标可能是正确的解决方案，但我真的不知道它是否是或者我应该如何使用游标来实现它。

我想出了这个光标代码，我认为这可能很好。

**编辑：添加光标功能**

```
创建或替换函数 update_fields() 返回无效为 $$
宣布
        游标 CURSOR FOR SELECT * FROM table ORDER BY id FOR UPDATE;
开始
        FOR 行 IN 游标 LOOP
                更新表 SET
                        a_col = 数组[col],
                        a_col2=数组[col2]
                WHERE CURRENT OF 游标；
        结束循环；
结尾;
$$ 语言 plpgsql;

```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-02T18:04:14.803

### MVCC

首先，如果“正常操作”包含`SELECT`查询，[MVCC 模型](http://www.postgresql.org/docs/current/interactive/mvcc-intro.html)会自动处理它。`UPDATE`不会阻塞`SELECT`，反之亦然。`SELECT`只看到已提交的数据（或在同一事务中已完成的内容），因此在`UPDATE`完成（已提交）之前，其他事务的结果对其他事务不可见。

### 性能/膨胀

*如果*您没有其他对象引用该表，
*并且*您没有并发写操作（这会丢失！），
*并且*您可以在表上提供一个非常短的排他锁，
*并且*您有额外的磁盘空间，当然：
您可以通过在后台创建表的更新版本来将锁定保持在最低限度。确保它具有作为替代品的*所有内容*，然后删除原件并重命名副本。

```
CREATE TABLE tbl_new (LIKE tbl_org INCLUDING CONSTRAINTS);

INSERT INTO tbl_new 
SELECT col_a, col_b, array[col] aS col_c
FROM   tbl_org; 
```

我正在使用`CREATE TABLE (LIKE .. INCLUDING CONSTRAINTS)`，因为（[在此处引用手册](http://www.postgresql.org/docs/current/interactive/sql-createtable.html)）：

> 非空约束总是被复制到新表中。`CHECK` 仅当指定时才会复制约束`INCLUDING CONSTRAINTS`；永远不会复制其他类型的约束。

确保新表已准备就绪。然后：

```
DROP tbl_org;
ALTER TABLE tbl_new RENAME TO tbl_org; 
```

导致非常短的时间窗口，其中表被独占锁定。

这实际上仅与性能有关。它会很快创建一个没有任何膨胀的新表。如果你有外键或视图，你仍然可以走这条路，但你必须准备一个脚本来删除和重新创建这些对象，这可能会创建额外的独占锁。

### 并发写入

使用并发写入操作，您实际上所能做的就是将您的更新分成几块。您不能在单个事务中执行此操作，因为锁定仅在事务结束时释放。

您*可以*使用[**dblink**](http://www.postgresql.org/docs/current/interactive/dblink.html)，它可以在另一个数据库（包括它自己）上启动独立事务。这样，您可以在单个`DO`语句或带有循环的 plpgsql 函数中完成所有操作。这是一个松散相关的答案，其中包含有关 dblink 的更多信息：

*   [从 PostgreSQL 中的存储过程删除或创建数据库](https://stackoverflow.com/questions/15256793/drop-or-create-database-from-stored-procedure-in-postgresql/15260931#15260931)

### 您使用光标的方法

函数内的光标不会给您带来*任何好处*。任何功能都自动包含在事务中，所有锁仅在事务结束时释放。即使您使用[`CLOSE cursor`](http://www.postgresql.org/docs/9.2/static/plpgsql-cursors.html#AEN57057)（您不使用）它也只会释放一些资源，但*不会*释放表上获得的锁。我引用手册：

> `CLOSE`关闭打开光标下的门户。这可用于在事务结束之前释放资源，或释放游标变量以再次打开。

您需要运行***单独*的事务**或（ab）使用为您执行此操作的[dblink](http://www.postgresql.org/docs/current/interactive/dblink.html)。

# java - 子类实现上的@Required注解

> ID：15770735
> 
> 赞同：0
> 
> 时间：2013-04-02T17:45:57.200
> 
> 标签：java, spring, spring-mvc

我有一种情况，我想将 setter 方法注释为`@Required`仅在我的`parentClass`. 但是，除非我注释基类 Spring 不会将该方法标识为配置中的必需方法（也就是说，如果该字段不存在，我不会得到“缺少必需的属性：foo”。下面是我尝试使用的代码：

```
public abstract class parentClass {
  public abstract void setFoo(Object foo);
}

public abstract class childClass extends parentClass {
  @Override
  @Required 
  public void setFoo(Object foo) {
    //setter code
  }
} 
```

我在这里做错了什么？是否可以仅为某些子类指定注释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:51:42.553

类以外的项目上的注释不会被继承。请参阅[@Inherited Javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/annotation/Inherited.html)

> 请注意，如果注释类型用于注释类以外的任何内容，则此元注释类型无效。另请注意，此元注释仅导致注释从超类继承；已实现接口上的注释无效。

我不确定 JSR 305 处理器如何管理这个技巧。

# php - 使用 PHP 连接到 MySQL DB，错误“不在对象上下文中使用 $this”

> ID：15770738
> 
> 赞同：0
> 
> 时间：2013-04-02T17:46:07.020
> 
> 标签：php

我不知道如何编写 PHP 函数。
我收到此错误“不在对象上下文中使用 $this”。
我只插入了第 3 行和第 4 行（MySQL 连接代码），其余代码都很好。
如何修复这些线条？

```
<?php

 $this->connection = mysql_connect('localhost', 'mbrconsu_un394x', 'y1cz9,rd+hf6') or die(mysql_error());
 mysql_select_db('mbrconsu_mmx', $this->connection) or die(mysql_error());

$sql="SELECT tema FROM treinamentos ORDER BY tema ASC";
$result = mysql_query($sql);
$stack=array();
    while($row = mysql_fetch_array($result))
          {
            array_push($stack,array($row['column1'],$row['column2']));
          }

echo json_encode($stack);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:50:00.937

您不能`$this`在对象类之外使用，这似乎是这里发生的事情。只需在所有位置重命名`$this->connection`为。`$connection`

请注意，您也不应该使用`mysql_*`函数，因为它们已被弃用。您可能想改用`mysqli_*`函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:50:07.140

1.  `$this`仅当您想要引用您正在其中工作的类的属性或函数时，才在类中使用。
2.  你不在课堂上，所以替换`$this->connection`为`$connection`.
3.  避免使用 mysql_* 函数，它们已被弃用。通过学习 PDO 或 mySQLi，您将帮自己一个忙。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:52:41.913

只需删除关键字“this”和指针“->”

```
<?php 

$connection = mysql_connect('localhost', 'mbrconsu_un394x', 'y1cz9,rd+hf6') or die(mysql_error());
mysql_select_db('mbrconsu_mmx', $connection) or die(mysql_error());

$sql="SELECT tema FROM treinamentos ORDER BY tema ASC";
$result = mysql_query($sql);
$stack=array();
    while($row = mysql_fetch_array($result))
          {
            array_push($stack,array($row['column1'],$row['column2']));
          }

echo json_encode($stack);

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T17:55:04.080

`$this`仅在定义的类内具有价值。即，我们通常在定义一个类以指向该类中的方法或属性时使用它。

```
mysql_connect('localhost', 'mbrconsu_un394x', 'y1cz9,rd+hf6') or die(mysql_error());
mysql_select_db('mbrconsu_mmx') or die(mysql_error());; 
```

这会很好用。

顺便使用`mysqli_*`还是`pdo`为了更好的效果。

# html - HTML DIV 内联块

> ID：15770739
> 
> 赞同：2
> 
> 时间：2013-04-02T17:46:09.280
> 
> 标签：html, css

我有这个代码：

```
<div style="margin-top: 5px"></div>
<div style="width:175px; height: 25px; margin: 0 auto; background-color:#fff;">
    <div style="font-weight: bold; text-align: center; width: 175px; height: 50px; margin:0; font-family: 'Droid Sans', sans-serif; color:#666666; font-size:12px; border:0; height:100%; line-height: 25px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
        Top 5 Números Sorteados
    </div>
</div>
<center>
<div style="margin-top: 1.5px"></div>
<div style="display:inline-block; width:55px; height: 100%; background-color:#fff; ">
    <div style="font-weight: bold; text-align: center; width: 55px; height: 100%; font-family: 'Droid Sans', sans-serif; color:#666666; font-size:12px; height:100%; line-height: 25px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
        <p>1.</p>
        <p>2.</p>
        <p>3.</p>
        <p>4.</p>
        <p>5.</p>
    </div>
</div>
<div style="display:inline-block; width:56px; height: 100%; background-color:#fff; ">
    <div style="font-weight: bold; text-align: center; width: 56px; height: 100%; font-family: 'Droid Sans', sans-serif; color:#666666; font-size:12px; height:100%; line-height: 25px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
        <p>1.</p>
        <p>2.</p>
        <p>3.</p>
        <p>4.</p>
        <p>5.</p>
    </div>
</div>
<div style="display:inline-block; width:55px; height: 100%; background-color:#fff; ">
    <div style="font-weight: bold; text-align: center; width: 55px; height: 100%; font-family: 'Droid Sans', sans-serif; color:#666666; font-size:12px; height:100%; line-height: 25px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
        <p>1.</p>
        <p>2.</p>
        <p>3.</p>
        <p>4.</p>
        <p>5.</p>
    </div>
</div>
</center> 
```

这给了我以下输出：http: [//jsfiddle.net/VmBR7/](http://jsfiddle.net/VmBR7/)

我想知道如何制作没有这种边框的内联 3 个 div。我一直在寻找样式选项，但找不到任何可以产生的东西。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T18:20:41.747

内联块元素用边框呈现自己。这可以在[这里找到](http://robertnyman.com/2010/02/24/css-display-inline-block-why-it-rocks-and-why-it-sucks/)

为了达到要求，我`inline-block`从元素中删除了 display 属性`div`，而是让它们`float:left`

然后我将所有底部元素包装`div`到一个父元素中，该父元素使用与顶部元素`div`类似的样式`div`

也不建议使用内联样式，我重构了一些..

所以这里是[JSFIDDLE](http://jsfiddle.net/VmBR7/6/)

# javascript - 滑动菜单突出显示不起作用

> ID：15770741
> 
> 赞同：0
> 
> 时间：2013-04-02T17:46:09.390
> 
> 标签：javascript, jquery

我正在尝试实现[这个滑动菜单突出显示](http://css-tricks.com/jquery-magicline-navigation/)但有一些困难。我有[一个小提琴](http://jsfiddle.net/raddevon/3C89r/1/)来证明这个问题。

HTML：

```
<div class="nav top-nav clearfix">
    <ul>
        <li class="current_page_item">
            <a href="#" title="Home">Home</a>
        </li>
        <li class="page_item page-item-880"> 
            <a href="#">Contact</a>
        </li>
        <li class="page_item page-item-948"> 
            <a href="#">Portfolio</a>
        </li>
    </ul>
</div> 
```

CSS：

```
body {
    background: #ccc;
}
.nav {
    border:0;
}
.nav ul {
    margin:auto
}
.nav li {
    float:left;
    position:relative
}
.nav li a {
    border-bottom:0
}
.nav li ul.sub-menu, .nav li ul.children {
    margin-top:0;
    border:1px solid #ccc;
    border-top:0;
    position:absolute;
    display:none;
    z-index:8999
}
.nav li ul.sub-menu li a, .nav li ul.children li a {
    padding-left:10px;
    border-right:0;
    display:block;
    width:180px;
    border-bottom:1px solid #ccc
}
.nav li ul.sub-menu li:last-child a, .nav li ul.children li:last-child a {
    border-bottom:0
}
.nav li:hover ul {
    top:auto;
    display:block
}
.nav.top-nav ul {
    margin:0 auto;
    list-style:none;
    position:relative
}
.nav.top-nav ul li {
    display:inline-block
}
.nav.top-nav ul li a {
    position:relative;
    z-index:200;
    display:block;
    float:left;
    padding:6px 10px 4px 10px
}
.nav.top-nav ul li a:hover {
    color:#fff
}
.nav.top-nav ul li#sliding-highlight {
    position:absolute;
    top:0;
    left:0;
    width:100px;
    background:#f2065f;
    z-index:100;
    -moz-border-radius:25px 25px 25px 25px;
    -webkit-border-top-left-radius:25px;
    -webkit-border-top-right-radius:25px;
    -webkit-border-bottom-right-radius:25px;
    -webkit-border-bottom-left-radius:25px;
    border-radius:25px 25px 25px 25px
}
.nav.top-nav ul .current_page_item a {
    color:#fff
}
.nav .ie6 .top-nav li, .nav .ie7 .top-nav li {
    display:inline
} 
```

JavaScript：

```
/* Menu sliding animation script */
$(function () {

    var $el, leftPos, newWidth;
    $mainNav = $(".top-nav ul");

    $mainNav.append("<li id='sliding-highlight'></li>");

    var $slidingHighlight = $("#sliding-highlight");

    $slidingHighlight.width($(".current_page_item").width())
        .height($mainNav.parent().height())
        .css("left", $(".current_page_item a").position().left)
        //.data("origLeft", $(".current_page_item a").position().left)
        .data("origWidth", $slidingHighlight.width());

    $(".top-nav li a").hover(function () {
        $el = $(this);
        leftPos = $el.position().left;
        newWidth = $el.parent().width();
        $slidingHighlight.stop().animate({
            left: leftPos,
            width: newWidth,
            backgroundColor: $el.attr("rel")
        })
    }, function () {
        $slidingHighlight.stop().animate({
            left: $slidingHighlight.data("origLeft"),
            width: $slidingHighlight.data("origWidth")
        });
    });

    /* Kick IE into gear */
    $(".current_page_item a").mouseenter();

}); 
```

我现在知道两个问题：

1.  脚本创建的 li 项目没有设置高度。
2.  触发悬停事件时未设置左侧位置属性。

我知道我用来获取高度和左侧位置的选择器很好，因为宽度等其他属性设置正确。

有什么建议可以让我完成这项工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:25:05.703

我认为 position() 方法有问题尝试使用 offset() 方法我已经在 [fiddler][1] 中更新了您的代码，请检查并让我知道您有任何疑虑

jsfiddle.net/3C89r/3/

# c# - C# VS2010 错误：找不到可安装的 ISAM

> ID：15770742
> 
> 赞同：0
> 
> 时间：2013-04-02T17:46:10.877
> 
> 标签：c#, visual-studio-2010, excel, oledb

我正在尝试使用 OleDb 连接来使用 excel 文件中的数据填充数据表，但是我收到以下错误：“找不到可安装的 ISAM”。

任何帮助将非常感激。

我尝试了其他类似错误帖子的建议，但无济于事。

```
 string cnStr = @"Provider=Microsoft.ACE.OLEDB.12.0;'C:\Users\Nick\Documents\Visual Studio 2010\Projects\ExcelTest1\ExcelTest1\CapitalPlan.xlsx';Extended Properties=" + "\"Excel 12.0 Xml;HDR=YES;IMEX=1\"";
         DataTable dt = new DataTable();
        `string sql = "Select * From [Sheet1$]";`

        `using (OleDbConnection cn = new OleDbConnection(cnStr))
        {
            using (OleDbDataAdapter adapter = new OleDbDataAdapter(sql, cn))
            {
                adapter.Fill(dt);
            }
        }` 
```

![在此处输入图像描述](https://i.stack.imgur.com/vUXAu.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T10:55:04.223

下面回答：

```
string cnStr = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Docs\\Book2.xlsx;Extended Properties='Excel 12.0 xml;HDR=YES;'"; 
```

这是 OleDb 连接字符串中的语法。

更多详细信息： [如何使用 ADO.NET 读取 .XLSX (Excel 2007) 文件？我发现“找不到可安装的 ISAM”-错误](https://stackoverflow.com/questions/4005704/how-to-read-an-xlsx-excel-2007-file-using-ado-net-i-am-finding-could-not-fi?rq=1)

# canvas - 在 Flex 中清除图形对象后无法绘制

> ID：15770744
> 
> 赞同：0
> 
> 时间：2013-04-02T17:46:27.637
> 
> 标签：canvas, apache-flex, graphics, drawing

我有一个前段时间构建的小型绘图应用程序。我刚刚重新打开项目以添加一些改进，但现在每当我调用 graphics.clear() 时，我都无法再次绘制。我已经扭转了我改变的一切，但无济于事。这是我的自定义绘图组件中的相关代码（基于 s:Group）：

```
private var prevX:Number = 0;
private var prevY:Number = 0;

private function startDrawing(event:MouseEvent):void {
    addEventListener(MouseEvent.MOUSE_MOVE, handleMouseMove, false, 0, true);
}

private function stopDrawing(event:MouseEvent):void {
    prevX = 0;
    prevY = 0;
    removeEventListener(MouseEvent.MOUSE_MOVE, handleMouseMove, false);
}

private function handleMouseMove(event:MouseEvent) {
    //Set line style using graphics.lineStyle()

    graphics.moveTo(prevX, prevY);
    graphics.lineTo(event.localX, event.localY);

    prevX = event.localX;
    prevY = event.localY;
}

public function clearCanvas():void {
    //After I call this I can no longer draw.
    graphics.clear();
} 
```

任何帮助将不胜感激，谢谢！

编辑：一些附加信息：在 MouseDown 上调用 startDrawing，在 MouseUp 上调用 stopDrawing，并通过按下按钮调用 clearCanvas。我也从 Flash Builder 4.6 升级到 4.7，不确定是否有 SDK 更改。

编辑：我今天对代码做了一些工作，这就是我想出的。单击并拖动时，我可以看到该线，但由于某种原因无法将其重新绘制到 MouseUp 的主画布上。当我跟踪代码时，它正在传输并且显然正确地绘制了所有内容（尽管平滑模式还没有工作）。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:mx="http://www.adobe.com/2006/mxml"
         xmlns:local="*" 
         xmlns:s="library://ns.adobe.com/flex/spark" 
         mouseEnabledWhereTransparent="true"
         mouseDown="startDrawing(event)" 
         mouseUp="stopDrawing(event)">
    <mx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;
            import mx.containers.Canvas;

            //########## Public Variables ##########

            public var __DrawingColor:uint = 0x000000;
            public var __DrawingWidth:Number = 4;
            public var __DrawingAlpha:Number = 1;
            public var __DrawingSmoothing:Boolean = false;

            //########## Private Variables ##########

            private static const ___SMOOTHING_AMOUNT:Number = 5;

            private var _History:ArrayCollection;
            private var _CurrentPoints:Array;
            private var _LiveCanvas:Canvas;
            private var _LiveObject:Object;
            private var _PrevX:Number = 0;
            private var _PrevY:Number = 0;

            //########## Public Functions ##########

            public function init():void{
                _History = new ArrayCollection();
            }

            public function clearAll():void {
                graphics.clear();
                _History = new ArrayCollection();

                graphics.beginFill(0xffffff, 0);
                graphics.drawRect(0, 0, width, height);
                graphics.endFill();
            }

            public function clearLast():void {
                if (_History.length > 0) {
                    _History.removeItemAt(_History.length - 1);
                    drawLines(_History);
                }
            }

            //########## Private Functions ##########

            private function startDrawing(event:MouseEvent):void {
                addEventListener(MouseEvent.MOUSE_MOVE, handleMouseMove, false, 0, true);
                _CurrentPoints = new Array();

                _LiveCanvas = new Canvas();
                addElement(_LiveCanvas);
                _LiveCanvas.x = 0;
                _LiveCanvas.y = 0;
                _LiveCanvas.width = this.width;
                _LiveCanvas.height = this.height;

                _LiveCanvas.setStyle("backgroundColor", 0xFFFFFF);
                _LiveCanvas.setStyle("backgroundAlpha", "0");
            }

            private function handleMouseMove(event:MouseEvent):void {
                if (_PrevX != 0 && _PrevY != 0) {
                    _CurrentPoints.push(new Point(event.localX, event.localY));
                    _LiveCanvas.graphics.lineStyle(__DrawingWidth, __DrawingColor, __DrawingAlpha);
                    _LiveCanvas.graphics.moveTo(_PrevX, _PrevY);
                    _LiveCanvas.graphics.lineTo(event.localX, event.localY);
                }
                _PrevX = event.localX;
                _PrevY = event.localY;
            }

            private function stopDrawing(event:MouseEvent):void {
                _CurrentPoints.push(new Point(event.localX, event.localY));

                _PrevX = 0;
                _PrevX = 0;
                this.removeElement(_LiveCanvas);
                _LiveCanvas = null;

                if (__DrawingSmoothing) {
                    _CurrentPoints = smoothPoints(_CurrentPoints);
                }

                var addItem:Object = new Object();
                addItem.color = __DrawingColor;
                addItem.width = __DrawingWidth;
                addItem.alpha = __DrawingAlpha;
                addItem.lines = pointsToLines(_CurrentPoints);

                _History.addItem(addItem);
                drawLines(_History);
                removeEventListener(MouseEvent.MOUSE_MOVE, handleMouseMove, false);
            }

            private function smoothPoints(points:Array):Array {
                var len:uint = points.length;
                var p:Point;
                var ret:Array = new Array();
                var t:Number = 1 / ___SMOOTHING_AMOUNT;
                while (t < 1) {
                    p = getPoint(t, points);
                    ret.push(p);
                    t += 1 / ___SMOOTHING_AMOUNT;
                }
                return ret;
            }

            private function pointsToLines(points:Array):Array {
                var ret:Array = new Array();
                var lineObject:Object = new Object();
                for (var i:Number = 0; i < points.length; i++) {
                    if (!lineObject.hasOwnProperty("x1")) {
                        lineObject.x1 = Point(points[i]).x;
                        lineObject.y1 = Point(points[i]).y;
                    } else if (!lineObject.hasOwnProperty("x2")) {
                        lineObject.x2 = Point(points[i]).x;
                        lineObject.y2 = Point(points[i]).y;
                    } else {
                        ret.push(lineObject);
                        lineObject = new Object();
                        lineObject.x1 = Point(points[i]).x;
                        lineObject.y1 = Point(points[i]).y;
                    }
                }
                return ret;
            }

            private function drawLines(lines:ArrayCollection):void {
                graphics.clear();
                graphics.beginFill(0xFFFFFF, 0);
                graphics.drawRect(0, 0, width, height);
                graphics.endFill();
                var currentPoints:Object;
                for (var x:Number = 0; x < lines.length; x++) {
                    currentPoints = lines[x];
                    graphics.lineStyle(currentPoints.width, currentPoints.color, currentPoints.alpha);
                    for (var i:Number = 0; i < currentPoints.lines.length; i++) {
                        graphics.moveTo(currentPoints.lines[i].x1, currentPoints.lines[i].y1);
                        graphics.lineTo(currentPoints.lines[i].x2, currentPoints.lines[i].y2);
                    }
                }
            }

            private function getPoint(t:Number, points:Array):Point {
                var x:Number = 0;
                var y:Number = 0;
                var n:uint = points.length-1;
                var factn:Number = factoral(n);
                for (var i:uint=0;i<=n;i++) {
                    var b:Number = factn/(factoral(i)*factoral(n-i));
                    var k:Number = Math.pow(1-t, n-i)*Math.pow(t, i);
                    x += b*k*points[i].x;
                    y += b*k*points[i].y;
                }
                return new Point(x, y);
            }

            private function factoral(value:uint):Number {
                if (value==0)
                    return 1;
                var total:Number = value;
                while (--value>1)
                    total *= value;
                return total;
            }

        ]]>
    </mx:Script>
</s:Group> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T01:57:41.303

我尝试使用您的代码并遇到了同样的问题。我的解决方案是用颜色填充组，使其再次接受鼠标事件。

为了不改变背景，我使用了 alpha = 0。

```
public function clearCanvas():void {
    graphics.clear();

    graphics.beginFill(0xffffff, 0);
    graphics.drawRect(0, 0, width, height);
    graphics.endFill();
} 
```

如果它没有帮助你，我会在这里发布我的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T02:59:21.267

终于弄明白了，如果有人感兴趣，工作代码会在下面发布。谢谢！

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml"
         xmlns:local="*" 
         xmlns:s="library://ns.adobe.com/flex/spark" 
         mouseDown="startDrawing(event)" 
         mouseUp="stopDrawing(event)">
    <mx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;

            //########## Public Variables ##########

            public var __DrawingColor:uint = 0x000000;
            public var __DrawingWidth:Number = 4;
            public var __DrawingAlpha:Number = 1;
            public var __DrawingSmoothing:Boolean = false;

            //########## Private Variables ##########

            private var _History:ArrayCollection;
            private var _CurrentPoints:Array;
            private var _LiveObject:Object;

            //########## Public Functions ##########

            public function init():void{
                _History = new ArrayCollection();
            }

            public function clearAll():void {
                graphics.clear();
                _History = new ArrayCollection();

                graphics.beginFill(0xffffff, 0);
                graphics.drawRect(0, 0, width, height);
                graphics.endFill();
            }

            public function clearLast():void {
                if (_History.length > 0) {
                    _History.removeItemAt(_History.length - 1);
                    drawLines(_History);
                }
            }

            //########## Private Functions ##########

            private function startDrawing(event:MouseEvent):void {
                addEventListener(MouseEvent.MOUSE_MOVE, handleMouseMove, false, 0, true);
                _CurrentPoints = new Array();
                _CurrentPoints.push(new Point(event.localX, event.localY));
                _LiveCanvas.visible = true;
                _LiveCanvas.graphics.clear();
                _LiveCanvas.graphics.beginFill(0xFFFFFF, 0);
                _LiveCanvas.graphics.drawRect(0, 0, width, height);
                _LiveCanvas.graphics.endFill();
                _LiveCanvas.graphics.moveTo(event.localX, event.localY);
            }

            private function handleMouseMove(event:MouseEvent):void {
                _CurrentPoints.push(new Point(event.localX, event.localY));
                _LiveCanvas.graphics.lineStyle(__DrawingWidth, __DrawingColor, __DrawingAlpha);
                _LiveCanvas.graphics.lineTo(event.localX, event.localY);
            }

            private function stopDrawing(event:MouseEvent):void {
                removeEventListener(MouseEvent.MOUSE_MOVE, handleMouseMove, false);
                _CurrentPoints.push(new Point(event.localX, event.localY));

                _LiveCanvas.graphics.clear();
                _LiveCanvas.visible = false;

                if (__DrawingSmoothing) {
                    _CurrentPoints = smoothPoints(_CurrentPoints);
                }

                var addItem:Object = new Object();
                addItem.color = __DrawingColor;
                addItem.width = __DrawingWidth;
                addItem.alpha = __DrawingAlpha;
                addItem.points = _CurrentPoints;

                _History.addItem(addItem);
                drawLines(_History);
            }

            private function smoothPoints(points:Array):Array {
                var len:uint = points.length;
                var p:Point;
                var ret:Array = new Array();
                var t:Number = 1 / (points.length);
                while (t < 1) {
                    p = getPoint(t, points);
                    ret.push(p);
                    t += 1 / (points.length);
                }
                return ret;
            }

            private function drawLines(lines:ArrayCollection):void {
                graphics.clear();
                graphics.beginFill(0xFFFFFF, 0);
                graphics.drawRect(0, 0, width, height);
                graphics.endFill();
                var currentPoints:Object;
                for (var x:Number = 0; x < lines.length; x++) {
                    currentPoints = lines[x];
                    graphics.lineStyle(currentPoints.width, currentPoints.color, currentPoints.alpha);
                    if (currentPoints.points.length > 0) {
                        graphics.moveTo(Point(currentPoints.points[0]).x, Point(currentPoints.points[0]).y);
                        for (var i:Number = 0; i < currentPoints.points.length; i++) {
                            graphics.lineTo(currentPoints.points[i].x, currentPoints.points[i].y);
                        }
                    }
                }
            }

            private function getPoint(t:Number, points:Array):Point {
                var x:Number = 0;
                var y:Number = 0;
                var n:uint = points.length-1;
                var factn:Number = factoral(n);
                for (var i:uint=0;i<=n;i++) {
                    var b:Number = factn/(factoral(i)*factoral(n-i));
                    var k:Number = Math.pow(1-t, n-i)*Math.pow(t, i);
                    x += b*k*points[i].x;
                    y += b*k*points[i].y;
                }
                return new Point(x, y);
            }

            private function factoral(value:uint):Number {
                if (value==0)
                    return 1;
                var total:Number = value;
                while (--value>1)
                    total *= value;
                return total;
            }

        ]]>
    </mx:Script>
    <mx:Canvas id="_LiveCanvas" left="0" right="0" top="0" bottom="0" backgroundAlpha="0" backgroundColor="0xFFFFFF"/>
</mx:Canvas> 
```

# javascript - JavaScript 半冒号问题

> ID：15770746
> 
> 赞同：-6
> 
> 时间：2013-04-02T17:46:35.687
> 
> 标签：javascript

我有以下 javascript 代码

```
var foo = function () {
   var func = function () {
        var one = 0;
        if (one === 0) {
            alert('func');
        }

    }

    return {
        func: func
    };
}

foo = new foo();
foo.func(); 
```

我上面的代码警报`func`很好。现在，当我将对象文字更改`return {}`为以下时

```
return
{
    func: func
} 
```

然后它不返回任何东西。`;`我知道为什么，因为 JavaScript在返回末尾添加了分号。所以暂时搁置这部分，让我们回顾一下我的原始代码。当我将`if`声明更改为以下时

```
if (one === 0)
{
    alert('func');
} 
```

然后它会发出警报`func`。**为什么？**. 因为在这种情况下，javascript也应该在末尾添加分号，`if(one === 0)`所以我认为它应该返回错误。

等一下，还有更多。现在让我们把你的注意力带回到我在顶部的原始代码。现在，当我将内部功能更改为以下时

```
var func = function ()
{
    //code here
} 
```

然后它再次执行此代码并发出警报`func`。为什么**？**外部功能也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:48:51.037

不，分号不会插入到行的每一端。[规则要复杂得多](http://bclary.com/2004/11/07/#a-7.9.1)：

> 当从左到右解析程序时，遇到任何语法生成都不允许的标记（称为违规标记）时，如果出现以下一项或多项，则在违规标记之前自动插入分号条件为真：
> 
> 1.  违规标记与前一个标记至少由一个 LineTerminator 分隔。
>     
>     
> 2.  有问题的令牌是 }。
>     
>     
> 
> 当程序从左到右解析时，遇到输入令牌流的结尾，并且解析器无法将输入令牌流解析为单个完整的 ECMAScript 程序，则在末尾自动插入分号输入流。当程序从左到右解析时，遇到某个语法产生式允许的记号，但产生式是受限制的产生式，并且该记号将是紧跟注释之后的终端或非终端的第一个记号“[no LineTerminator here]”在受限生产中（因此这样的令牌称为受限令牌），并且受限令牌与前一个令牌至少有一个 LineTerminator 分开，然后在受限标记之前自动插入一个分号。但是，前面的规则还有一个额外的覆盖条件：如果分号随后将被解析为空语句，或者如果该分号将成为 for 语句标题中的两个分号之一（部分12.6.3)。

ECMAScript 规范给出了这个建议：

> 给 ECMAScript 程序员的实用建议是：
> 
> 后缀 ++ 或 -- 运算符应与其操作数出现在同一行。
> 
> return 或 throw 语句中的 Expression 应与 return 或 throw 标记在同一行开始。
> 
> break 或 continue 语句中的标签应与 break 或 continue 标记位于同一行。

但是要记住的真正实际的事情是它很复杂，所以自己附加分号，不要乞求错误。

# c - C 调查计划

> ID：15770747
> 
> 赞同：1
> 
> 时间：2013-04-02T17:46:35.903
> 
> 标签：c, file-io

嗨，我对 C 相当陌生，我正在尝试在 C 中制作一个调查程序，允许用户在不同类型的问题之间做出选择并将调查存储在文件中。我的代码没有进入 while 循环并在它之前终止。有人可以指出错误吗？

```
 makesurvey()
{
int tfquestions, mcq, shortq,essayq,rankq ;
int i=1;
char *buffer;
printf("\nEnter the number of True/False Questions, Multiple Choice, Short answer , EssayAnswer and rank the   choice questions ");
scanf("%d",&tfquestions);
scanf("%d",&mcq);
scanf("%d",&shortq);
scanf("%d",&essayq);
scanf("%d",&rankq);
FILE *fp;
fp = fopen("survey.txt","w");
    while(i=!tfquestions)
    {
            if(fp != NULL)
            {
            fprintf(fp,"Enter The True false question");
            buffer = (char*)malloc(sizeof(40));
            fscanf(fp,"%c",buffer);
            fclose(fp);
            }

            else
            {
                    printf("Could not open the file");
            }
    i++;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:54:32.347

你需要使用 != 而不是 =!

```
fp = fopen("survey.txt","w");
    while(i!=tfquestions)
    {
        if(fp != NULL)
        {
        fprintf(fp,"Enter The True false question");
        buffer = (char*)malloc(sizeof(40));
        fscanf(fp,"%c",buffer);
        fclose(fp);
        }

        else
        {
                printf("Could not open the file");
        }
i++;
} 
```

# html - 将主要内容放入列表项的语义

> ID：15770750
> 
> 赞同：0
> 
> 时间：2013-04-02T17:46:41.747
> 
> 标签：html, html-lists, semantic-markup

正如标题所说，我正在考虑将我的 HTML 页面的主要内容放在一个列表项中。我不知道这是多么语义化。列表中的文章并没有非常具体（也许他们不应该）关于被认为是列表项目的内容。所以考虑以下几点：

```
<ul>
    <li><h5>Main Content</h5>
        <ul>
            <li><article><h1>Article Title</h1>
                    <p>Here's my main, feed-ready content.</p></article></li>
            <li><aside>Related Links</aside></li>
        <ul>
    </li>
    <li><aside>Recommended Links</aside></li>
</ul> 
```

现在，我出于样式目的进行了这种安排（我知道......开始语义对话的最糟糕的地方）。在我的标记中，我`<ul>'s`的样式与其他地方一起设置`display:table;`和设置`<li>'s`样式。`display:table-cell;`所以如果我也能把它带到我的主要内容中，那就太方便了。

与其说是寻找最佳实践（尽管随时发表评论），但如果这在*语义上*是不正确的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:49:39.147

只要它们是 the 的子元素`li`而**不是**兄弟元素，**它**在 HTML4 和 HTML5 中语义上是正确和有效的。

**一个很好的例子：**

```
<ul>
    <li><article>Article Here</article></li>
    <li></li>
</ul> 
```

**一个不好的例子：**

```
<ul>
    <li></li>
    <article>Article here.</article>
    <li></li>
</ul> 
```

[此处](http://www.w3.org/TR/html-markup/li.html)允许的内容部分解释了更多关于 a`li`可以包含的内容（基本上是任何[流元素](http://www.w3.org/TR/html-markup/common-models.html#common.elem.flow)，如下所示）。

![在此处输入图像描述](https://i.stack.imgur.com/aG2Ac.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T17:25:24.423

我认为你不应该那样做。

您页面的主要内容当然可以放入`ul`. 但这取决于内容的种类是否合适。

一个有意义的简单示例：一个标题为“我最喜欢的水果”的页面，其中包含一个`ul`每个水果都是一个`li`.

但是在您的情况下，列表的内容在任何有意义的意义上都没有关联。你的清单是*关于*什么的？一个......好吧，什么，页面组件的列表？如果你走这条路，你也可以使用 a`ul`来表示段落列表，或者句子中的单词列表，或者单词中的字母列表。

我并不是说您“不得”这样做（规范对 的使用非常开放[`ul`](http://www.w3.org/TR/html5/grouping-content.html#the-ul-element)），但我建议不要这样做，就像我建议不要使用：

```
<ul>
  <li><h1>Fruits!</h1></li>
  <li>Welcome to my site.</li>
  <li>I write about fruits here and I hope you enjoy your visit.</li>
  <li><h2>What I like about fruits</h2></li>
  <li>They are tasty.</li>
  <li>And healthy.</li>
</ul>

<ul>
  <li>Hi, </li>
  <li>my </li>
  <li>name </li>
  <li>is </li>
  <li>John. </li>
</ul> 
```

以这种不那么有意义的方式使用列表也可能会使一些屏幕阅读器用户感到困惑，因为他们通常具有跳转到页面上的列表并通过列表项导航等功能。此外，一些屏幕阅读器可能会在阅读您的之前宣布“列表项”内容。

你只需要它来做造型。所以请改用`div`元素（带类）。

# javascript - Javascript - 计算锚标记的字符

> ID：15770757
> 
> 赞同：1
> 
> 时间：2013-04-02T17:47:12.800
> 
> 标签：javascript, jquery

基本上我想创建一个函数，它将在字符串中搜索锚标记，当它找到一个时，计算它们之间的字符并返回该数字。我正在为一个正在计算 textarea 中字符数的编辑器执行此操作，因为 textarea 有用户可以输入的限制，我不希望链接中的字符计入该总数。

如果我在文本区域中有这个：

```
This is what it looks like here <a href="http://www.bmhl.com">Placeholder</a>.  Please click the link to go to the page. 
```

锚点之前有 32 个字符，中间有 11 个字符，之后有 42 个字符，总共 85 个。在锚点标签中有 34 个字符，我不想计算在内。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:15:41.313

为什么你只想剥离锚标签？你可能想看看[这个问题](https://stackoverflow.com/a/822486/263773)。这是一个修改后的答案，用于返回一些 html 代码的长度。

```
function plainTextLength(html) {
    var tmp = document.createElement("div");
    tmp.innerHTML = html;
    var txt = tmp.textContent||tmp.innerText;
    return txt.length;
} 
```

这也适用于您上面的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:04:56.663

如果输入应该是一个字符串：

```
function getLength (string) {
     return string.match(/<a[^>]+>([^<]+)<\/a>/)[1].length
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:12:10.527

不完全确定您需要什么，但此函数为您的示例文本返回 11：

```
function count(textareaInput) {  
  var count = 0;  
  $(textareaInput).filter('a').each(function() { 
    count += $(this).text().length;
  });
  return count;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T18:20:37.643

你可以使用这样的东西：

```
$('textarea').keyup(function() {
    $('#count').text( this.value.replace(/<\/?a\s*[^>]*>/g, '').length );
}); 
```

[请参阅工作演示](http://jsfiddle.net/snwdm/4/)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-02T18:07:28.717

```
var a = document.getElementById('link');
var b = a.outerHTML.length - a.innerHTML.length; 
```

我没有测试它，但它可能会工作。

# php - 如何设计这个领域模型？

> ID：15770758
> 
> 赞同：1
> 
> 时间：2013-04-02T17:47:17.130
> 
> 标签：php, domain-driven-design, aggregateroot

所以我有以下域：

*   应用程序和版本，它们实际上是软件应用程序
*   设备，安装应用程序的设备
*   在设备上安装的应用程序
*   按已安装应用程序订阅通知

到目前为止，我最终得到了以下模型：

*   `Application`实体，由名称、操作系统和类型定义
*   `Version`值对象，它基本上包装了版本信息（主要、次要等）
*   `Release`实体，它是一个组合对象，它引用了一个应用程序实体并嵌入了一个版本值对象
*   `Device`实体，由序列号标识
*   `NotitificationSubscription`实体（允许我按属性查询）

现在我想知道如何“关联”`Device`实体，`Release`因为`NotificationSubscription`它应该与 a 上的“已安装”关联`Release`并`Device`包含一些额外信息（如身份验证令牌）。

鉴于我的 ORM (Doctrine2) 和 RDMS (MySQL) 的限制，我一直在寻找一个好的设计。

想象一下以下工作流程：

1.  我`Device`从由其序列号标识的数据库中获取实体
2.  我确定正在运行`Release`的`Device`是否已经与它关联，如果没有，我创建一个关联
3.  然后我需要`NotificationSubscription`为当前的设备发布关联添加或删除

我的问题是我最终有很多间接性。

为了允许我为关联设置额外的数据，我创建了一个关联类，它本身就是一个引用设备和发布的实体。

一个设备可能安装并运行了不同的 Release，例如，我不知道如何查询以下信息：“Fetches all the notification subscriptions for the current release for the current device”

我显然在存储库中添加了一个方法，`findSubscriptionsByDeviceAndRelease($device, $release);`这意味着我可以通过使用存储库和图表来查询此信息`$device->getInstalledReleases()->filter($identifiedRelease)->getNotificationSubscriptions();`

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:01:47.167

保持简单：你不需要一个领域模型，你只需要一个好的实体关系模型。您可能也不需要 Doctrine，因为 sql 查询应该足够简单。

# sql - SQL查询双重查询

> ID：15770761
> 
> 赞同：0
> 
> 时间：2013-04-02T17:47:24.377
> 
> 标签：sql, geolocation, where-clause

我有这张表（CheckinTable）：

*   ID
*   创建
*   纬度
*   经度
*   用户身份

`user_id`UserTable 的外键在哪里。

对于我有更多签到的每个用户，我需要执行一个查询，根据创建的字段返回最新签到。

`ORDER BY`我可以通过修改来获取最新的签入，`DESC`但如果我必须设置另一个条件（例如`WHERE p.latitude BETWEEN 44.00 AND 41.00 AND p.longitude BETWEEN 9.18 AND 9.44`），我如何将这两个查询合并为一个以加载尊重地理定位子句的最新签入？

***编辑***：

为避免误解，我只需要在用户的最新检查中执行查询，按创建的 DESC 排序。我认为我需要为每个用户提取单个最新签入（在签入表中），然后应用地理定位子句。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:54:01.830

`WHERE`子句和`ORDER BY`子句是完全独立的，可以根据需要混合和匹配。`ORDER BY`必须总是在之后`WHERE`。

```
SELECT * 
FROM CheckinTable as p 
WHERE p.latitude BETWEEN 44.00 AND 41.00 AND p.longitude BETWEEN 9.18 AND 9.44 
ORDER BY modified DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:54:46.613

假设我理解您的问题，您正在尝试返回每个用户及其最大（创建）日期。如果是这种情况，我通常会自行加入表（尽管还有其他选项取决于您的 RDBMS）：

```
select distinct t.*
from yourtable t
  join (
      select max(created) maxcreated, user_id
      from yourtable
      group by user_id
    ) t2 on t.user_id = t2.user_id and t.created = t2.maxcreated 
```

如果您`WHERE`有条件，请将其放在子查询中：

```
select distinct t.*
from yourtable t
  join (
      select max(created) maxcreated, user_id
      from yourtable
      where latitude between 44.00 and 41.00
      group by user_id
    ) t2 on t.user_id = t2.user_id and t.created = t2.maxcreated 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/20704/3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:08:12.210

只是为单个用户提取适当的记录，其中`user_id`是`12345`：

```
SELECT TOP 1 CheckinTable.*
FROM         CheckinTable
WHERE        CheckinTable.user_id = 12345
AND          CheckinTable.latitude >= 44.00
AND          CheckinTable.latitude <= 41.00
AND          CheckinTable.longitude >= 9.18
AND          CheckinTable.longitude <= 9.44
ORDER BY     CheckinTable.modified DESC 
```

如果您尝试为多个用户提取它，则需要使用子查询或`over`and`partition by`语句（`partition by`比分组更有效，但使用起来有点古怪）：

```
SELECT p.id ,
       p.created ,
       p.latitude ,
       p.longitude ,
       p.user_id
FROM   (
    SELECT CheckinTable.id ,
    CheckinTable.created ,
    CheckinTable.latitude ,
    CheckinTable.longitude ,
    CheckinTable.user_id ,
    ROW_NUMBER() OVER (PARTITION BY
        CheckinTable.user_id) AS the_row_number
    FROM         CheckinTable
    WHERE        CheckinTable.latitude >= 44.00
    AND          CheckinTable.latitude <= 41.00
    AND          CheckinTable.longitude >= 9.18
    AND          CheckinTable.longitude <= 9.44
    ORDER BY     CheckinTable.modified DESC ) p
WHERE    the_row_number = 1 
```

请注意，我更喜欢使用`>=`or`<=`和类似的语句，而不是`between`，这仅仅是因为有时您希望对返回的内容进行比`between`（包括、排他等）更多的控制。`where`另请注意，如果子句中的条件没有为该特定用户返回任何内容，您显然不会得到任何结果。

# javascript - 使用 ID 隐藏的选择性 div

> ID：15770762
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:47:28.150
> 
> 标签：javascript, jquery

我有四列详细说明了游戏的更改日志，我想添加一个选项，允许用户只需单击一个按钮，然后只让他们查看最新更新。每个更新都有自己的 div。我是否可以通过 JQuery 来做到这一点，方法是向这些最近的更新 div（例如“当前”）添加一个 id，然后单击一个按钮，删除所有具有“更新”类但没有“当前”id 的 div ?

四列 --> 每列都有最近的更新，如下所示：-

```
<div class="ch-update">
            <div class="ch-update-header active">
                Minecraft 1.5.1
            </div>
            <ul>
                <li>Fixed a bunch of bugs</li>
                <li>Improved performance</li>
                <li>Notable: Crash on Mac OS X on "OpenGL Function Not Supported"</li>
                <li>Notable: Unable to place paintings</li>
            </ul>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:49:27.950

与其通过类维护您的状态，您可能只想利用 DOM 排序。即，只需删除所有`div`不是最后一个的 '。例如，

我当然在这里对您的标记做出假设，因为它没有提供。但是交互可能看起来像这样：

```
$('#view-recent-for-column-1').click(function() {
    $('#column-1 > div').slice(0, -1).remove();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:58:03.390

你的要求——

*删除所有具有“更新”类但没有“当前”ID的div*

我认为应该这样做：

```
$('button').click(function(){
   $('.update:not(#current)').fadeOut().remove();
}); 
```

# javascript - window.find 跨块元素工作？

> ID：15770764
> 
> 赞同：1
> 
> 时间：2013-04-02T17:47:34.253
> 
> 标签：javascript, dom

window 的 find 方法正在跨行内元素边界工作：

```
Some <em>sample</em> text.
console.log( window.find('le te') );    // true 
```

但它似乎不适用于块元素边界：

```
Some <div>sample</div><div>text</div>.
console.log( window.find('le\r\nte') ); // false 
```

我是否错误地使用了该方法，或者我需要一个解决方法吗？
我的目标是在上面的示例中找到“lete”以便对其进行操作。
（不需要 RegExp - 只搜索明确的字符串）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:53:51.157

`textContent`搜索文档正文还有另一种方法：

```
Some <div>sample</div><div>text</div>.
console.log(document.body.textContent.search(/le\s*te/)>-1); // true 
```

请参阅[参考资料](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent)。

正如您对问题的评论所指出的那样，它应该如何工作没有标准。如果您删除该`\r`字符，此代码在 Chrome 中有效，但在 FF 中无效：

```
Some <div>sample</div><div>text</div>.
console.log( window.find('le\nte') ); // true 
```

# php - 用于保持列表的运行记录的脚本

> ID：15770767
> 
> 赞同：0
> 
> 时间：2013-04-02T17:47:43.340
> 
> 标签：php, sql, list, sum

我一直在运行一系列游戏，获胜者在每场比赛结束时获得一定数量的积分。我正在尝试编写一个生成“排行榜”的脚本 - 从本质上讲，它会记录各种玩家的累积分数。我将用一个例子来解释我的问题：

一群朋友（爱丽丝、布赖恩、卡罗尔……）每天早上打篮球，并记录每个人每天得了多少分。他们想知道每个人在整个一周内总共得了多少分。

当他们在周一早上比赛时，每个球员的得分如下：

爱丽丝：3

布赖恩：10

卡罗尔：5

其他人：0

这群朋友周二又玩了。以下是分数：

爱丽丝：2

大卫：3

艾米丽：8

其他人：0

以及他们在周三比赛中的得分：

卡罗尔：6

大卫：4

弗兰克：2

其他人：0

他们想知道，在每天结束时，到目前为止谁得分最高，所以他们编写了一个脚本来跟踪。以他们每天的分数作为输入，以下是他们的脚本返回的内容：

星期一的期望输出：

1.  布赖恩 (10)
2.  卡罗尔 (5)
3.  爱丽丝 (3)

周二的输出：

1.  布赖恩 (10)
2.  艾米丽 (8)
3.  爱丽丝 (5)
4.  卡罗尔 (5)
5.  大卫 (3)

周三的输出：

1.  卡罗尔 (11)
2.  布赖恩 (10)
3.  艾米丽 (8)
4.  大卫 (7)
5.  爱丽丝 (5)
6.  弗兰克 (2)

如果我把每天的结果放到一个 SQL 表中，有没有办法使用 SQL 或 PHP 来生成每个人总分的排序列表？

提前感谢您的帮助，如果我听到解决方案或自己找到解决方案，我会在这里发布，以便人们将来使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:58:02.277

如果 SQL 表设置如下：

```
name    day    score
Alice   M      2
Bob     M      3
Carol   M      1
Alice   T      2
Bob     T      4
David   T      1
etc... 
```

那么你的 SQL 代码将是

```
SELECT name, SUM(score) FROM table GROUP BY name 
```

如果您无法通过代码破译，这将给出如下内容：

```
name    score
Alice   4 (or whatever it actually is)
Bob     5 (or whatever...)
etc... 
```

（编辑：在 SQL 语句中忘记了逗号）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:07:06.480

```
DROP TABLE #TempTest
CREATE TABLE #TempTest (
        ID int IDENTITY(1,1)
        ,Name varchar(10)
        ,Points int
        ,MatchDate datetime
        )

INSERT INTO #TempTest (Name,Points,MatchDate)
SELECT 'Alice',3,'1/1/2013'
UNION
SELECT  'Brian',10,'1/1/2013'
UNION
SELECT 'Carol',5,'1/1/2013'
Union
SELECT 'Alice',2,'1/2/2013'
UNION
SELECT  'David',3,'1/2/2013'
UNION
SELECT 'Emily',8,'1/2/2013'
UNION
SELECT 'Carol',6,'1/3/2013'
UNION
SELECT  'David',4,'1/3/2013'
UNION
SELECT 'Frank',2,'1/3/2013'

SELECT * FROM #TempTest

SELECT Name,SUM(Points) AS TotalPoints FROM #TempTest
WHERE MatchDate <='1/1/2013'
GROUP BY Name
ORDER BY SUM(Points) DESC

SELECT Name,SUM(Points) AS TotalPoints FROM #TempTest
WHERE MatchDate <='1/2/2013'
GROUP BY Name
ORDER BY SUM(Points) DESC

SELECT Name,SUM(Points) AS TotalPoints FROM #TempTest
WHERE MatchDate <='1/3/2013'
GROUP BY Name
ORDER BY SUM(Points) DESC 
```

您需要在点上添加降序排序，以确保板正确显示。

# java - Java小程序访问环境变量

> ID：15770773
> 
> 赞同：3
> 
> 时间：2013-04-02T17:48:05.443
> 
> 标签：java, applet

我们有一个（签名的）Java Applet，它读取并读取多年的环境变量（Linux 下的 Windows 相同）以加载库。

现在突然间，这似乎不再可能了。有没有人也有过这样的经历？现在是否有安全策略更改拒绝为小程序读取此类变量？任何文件？

因此，如果不更改小程序，它就不再起作用了...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T18:14:08.897

它是一个签名的小程序？检查有效性。在以下代码示例中：

```
 keytool -genkey -alias sickpea -validity 3650 -dname \
    "CN=Sickpea, OU=Engineering, O=Sickpea, L=San Francisco, S=CA, C=US"
$ keytool -selfcert -alias sickpea -validity 3650 
```

有效期设置为 10 年。

和：

```
jarsigner -verbose -certs -verify myApplet.jar 
```

您可以验证有效性。

# parameters - 子类别中的批量压缩/归档文件（文件必须在根目录中）

> ID：15770775
> 
> 赞同：0
> 
> 时间：2013-04-02T17:48:08.270
> 
> 标签：parameters, batch-file, zip, archive, subdirectory

我一直在寻找一段时间，将不同目录中的大量照片存档到单独的 zip 存档中。到目前为止没有运气。怎么会？我有一些具体要求；

目录结构：

YEAR => 类别（12 个目录，每年相同）=> 每个类别都有自己的活动 => 每个活动都有自己的图片。例如：

2013\

--------类别1\

--------类别2\

--------第三类\

-----------------------子类别1\

--------Category4\

--------Category5\

--------6类\

-----------------------子类别1\

-----------------------子类别2\

------------------------------------------Photograph1.jpg

------------------------------------------Photograph2.jpg

--------第7类\

等等...

年份：7 个目录每年文件夹中的子类别：12 每个子类别文件夹中的子子类别：100-200 所有文件夹中的照片：70GB，不知道具体有多少文件。

# 我的问题

我想为每个子类别创建单独的 zip 存档。问题是： zip 档案必须满足 2 个请求：

1) 照片必须放在压缩包的根目录下。当您打开 zip 存档时，您首先要看到的是照片。没有（子）目录。

2) 如果可能，每个 zip 档案的文件大小必须限制为 150mb。因此，即使子类别包含 200mb 的照片，脚本/参数也必须对文件大小设置限制。不仅仅是“拆分”一个 200mb 的 zip-archives，而是真正制作 2 个单独的 zip-archives。一个大小为 150mb，另一个为 50mb。

这可能吗？有很多方法可以通过脚本归档文件，我确实尝试了一些，但它们似乎都没有按照我希望的方式工作；-)

所以...除了照片之外，zip-archives 必须放在同一个子类别中，每个不能超过 150mb，并且必须了解必须压缩哪些文件（子类别中的内容年类别中的子类别）。

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T19:47:50.690

干得好。用`.vbs`扩展名保存它。我还没有彻底测试它，但我认为它应该可以工作。对于每个包含文件的目录，它会将这些文件压缩到同一包含目录中的存档中。

哦，欢迎来到 SO！由于您是新手，您可能需要查看[此链接](https://meta.stackexchange.com/a/5235/187716)。

```
' archive_limit.vbs
' usage: cscript archive_limit.vbs (directory, optional)
' If directory is not supplied, traverse subdirectories of current

on error resume next
if WSH.arguments.count = 0 then
    dir = left(WSH.ScriptFullName,(Len(WSH.ScriptFullName))-(len(WSH.ScriptName)))
else
    dir = WSH.arguments(0)
    if not Right(dir, 1) = "\" then
        dir = dir & "\"
    end if
end if

set fso = createobject("scripting.filesystemobject")
set shl = createobject("shell.application")

EnumFolders(fso.GetFolder(dir))

WSH.Quit 0

Sub EnumFolders(fFolder)
    Set objFolder = fso.GetFolder(fFolder.Path)
    Set colFiles = objFolder.Files
    zipnum = 1
    For Each objFile in colFiles
        zipfile = fFolder.Path & "\archive" & zipnum & ".zip"

        If fso.FileExists(zipfile) Then
            projected = fso.GetFile(zipfile).Size + objFile.Size
            if projected >= 157286400 Then
                zipnum = zipnum + 1
                zipfile = fFolder.Path & "\archive" & zipnum & ".zip"
            End If
        End If

        if not fso.FileExists(zipfile) Then
            set zip = fso.createtextfile(zipfile)
            zip.write "PK" & chr(5) & chr(6) & string(18, chr(0))
            zip.close
        End If

        If Not LCase(fso.GetExtensionName(objFile.name)) = "zip" Then
            ' uncomment the following line to log progress to the console
            ' WSH.Echo "Zipping " & fFolder.Path & "\" & objFile.name & " to " & zipfile
            zipitems = shl.namespace(zipfile).items.count
            shl.namespace(zipfile).copyhere(fFolder.Path & "\" & objFile.name)
            do until shl.namespace(zipfile).items.count > zipitems
                WSH.Sleep 100
            loop
        End If

    Next

    For Each Subfolder in fFolder.SubFolders
        EnumFolders(Subfolder)
    Next
End Sub 
```

# java - 如何在不知道 UNTIL CREATION 行的情况下将 JButton (JAVA) 文本拆分为多行

> ID：15770776
> 
> 赞同：1
> 
> 时间：2013-04-02T17:48:08.493
> 
> 标签：java, jbutton

如何将一条长线分成多条线，使其适合按钮？

大多数其他答案都使用了 HTML，但他们将字符串硬编码到行中，使得在创建按钮时无法动态拆分行。

编辑：在研究、询问并没有得到关于如何动态执行此操作的好答案后，我添加了一种方法来执行此操作。

请分享您的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:49:20.357

这是一个使用 HTML 标签动态分割行的示例方法

```
/**
         * This method divides the button text into lines by applying
         * html tags. Only way to get multiple lines on a JButton.
         * @param string
         * @return
         */
        private String wrapText(String string){
            //Return string initialized with opening html tag
            String returnString="<html>";

            //Get max width of text line
            int maxLineWidth = new ImageIcon("Images/buttonBackground.png").getIconWidth()-10;

            //Create font metrics
            FontMetrics metrics = this.getFontMetrics(new Font("Helvetica Neue", Font.PLAIN, 15));

            //Current line width
            int lineWidth=0;

            //Iterate over string
            StringTokenizer tokenizer = new StringTokenizer(string," ");
            while (tokenizer.hasMoreElements()) {
                String word = (String) tokenizer.nextElement(); 
                int stringWidth = metrics.stringWidth(word);

                //If word will cause a spill over max line width
                if (stringWidth+lineWidth>=maxLineWidth) {

                    //Add a new line, add a break tag and add the new word
                    returnString=(returnString+"<br>"+word);

                    //Reset line width
                    lineWidth=0;
                }else{

                    //No spill, so just add to current string
                    returnString=(returnString+" "+word);
                }
                //Increase the width of the line
                lineWidth+=stringWidth;
            }

            //Close html tag
            returnString=(returnString+"<html>");

            //Return the string
            return returnString;
        } 
```

# apache - 为别名配置 Apache .conf

> ID：15770778
> 
> 赞同：25
> 
> 时间：2013-04-02T17:48:15.067
> 
> 标签：apache, httpd.conf

所以我无法在包含我所有虚拟主机的“/etc/httpd/conf.d/vhosts.conf”中获得别名：

```
<VirtualHost *> 
    ServerName example.com
    Alias /ncn /var/www/html/ncn
    DocumentRoot /var/www/html/mjp
</VirtualHost> 
```

我希望我的别名能够正常工作，这样我就可以将 example.com/ncn 指向“/var/www/html/ncn”。

如果我在“/etc/httpd/conf/httpd.conf”中有它，但在我的“/etc/httpd/conf.d/vhosts.conf”中没有

任何想法为什么？其他一切似乎都有效，即 ServerAlias 的

干杯，彼得

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-04-02T18:34:58.410

抱歉，不确定最终发生了什么：

```
<VirtualHost *> 
    ServerName example.com
    DocumentRoot /var/www/html/mjp

    Alias /ncn "/var/www/html/ncn"

    <Directory "/var/www/html/ncn">
        Options None
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

# php - 在动态生成的页面上预取图像

> ID：15770783
> 
> 赞同：0
> 
> 时间：2013-04-02T17:48:31.807
> 
> 标签：php, html, get, google-chrome-devtools, prefetch

HTML5 Prefetching 是一个很棒的工具，过去它在浏览图片库时为用户提供了更好的用户体验。不过，在这种情况下，我似乎无法让我的图像正确预加载。当我在 Chrome 开发工具中查看网络选项卡时，我看到 GET 请求已处理，但在状态下它们被列为（已取消）& 类型为“待处理”。

知道为什么这些请求会被取消吗？

我正在使用基本的 PHP for 循环来遍历 JSON 数组以检索您可以在此处看到的图像路径：

```
 <?php foreach($this->slideShow as $key => $value ) {?>
    <link rel="prefetch" href="<?= $value->mainImage ?>">
 <?php } ?> 
```

以下是上述循环运行时返回的示例：

```
<link rel="prefetch" href="http://cdnl.mysite.com/mp/620/400/leadimage1.jpg">
<link rel="prefetch" href="http://cdnl.mysite.com/mp/620/400/leadimage2.jpg">
<link rel="prefetch" href="http://cdnl.mysite.com/mp/620/400/leadimage3.jpg">
<link rel="prefetch" href="http://cdnl.mysite.com/mp/620/400/leadimage4.jpg">
<link rel="prefetch" href="http://cdnl.mysite.com/mp/620/400/leadimage5.jpg"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-19T18:57:33.477

预取被取消，因为开发人员工具已打开。如果您使用该`chrome://net-internals`工具，您将在开发工具关闭时看到它们成功。取消的预取很吵，但没有错。

# ruby-on-rails - 使用 mongoDB 和 Backbone 在 Rails 中验证表单的最佳实践是什么

> ID：15770785
> 
> 赞同：1
> 
> 时间：2013-04-02T17:48:39.780
> 
> 标签：ruby-on-rails, validation, mongodb, backbone.js

嗨，我是这三件事的新手。我正在尝试尽可能多地使用 Rails，并使用主干进行 ajax 发送或事件处理，而 Rails 无法处理。

现在我正在尝试在保存到数据库之前验证表单。我看到了一些使用 Active Record 或 Jquery 验证的验证实践。由于我使用 mongodb，我认为我不能使用 Active Record。并且 Jquery 验证对我来说有点慢和不方便，所以我现在只想将主干用于脚本语言..

所以我的问题是使用 mongoDB 和 Backbone 在 Rails 中验证表单的最佳实践是什么。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T20:49:40.690

在客户端，我认为您应该查看主干验证 [https://github.com/thedersen/backbone.validation](https://github.com/thedersen/backbone.validation)

# f# - F# 中的重复序列

> ID：15770791
> 
> 赞同：7
> 
> 时间：2013-04-02T17:49:06.293
> 
> 标签：f#

我有一个“压缩”的值流，附加了该值的出现次数，例如：

```
let a = [ (),1; (),4; (),3;] 
```

我想“解压缩”该序列并发出原始序列。我可以定义一个重复组合器来产生！为此

```
let rec repeat avalue n =  seq { if n > 0 then 
                                    yield avalue; yield! repeat avalue (n-1) }

let b = seq { for v,n in a do
                yield! repeat v n }  |> Seq.toList 
```

有没有办法以组合的形式表达这种内联？

```
let c = a |> Seq.XXX(fun e -> ...) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T18:02:58.273

您可以使用以下方法执行此操作`Enumerable.Repeat`：

```
> Seq.collect Enumerable.Repeat [ 1, 2; 3, 4; 5, 6 ] |> List.ofSeq;;
val it : int list = [1; 1; 3; 3; 3; 3; 5; 5; 5; 5; 5; 5] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T18:03:49.173

怎么样

```
let c = a |> Seq.collect (fun (v,i) -> [1..i] |> Seq.map (fun x -> v)) 
```

~~我不知道类似于 Enumerable.Repeat 的库函数；如果有人知道，请添加评论。~~

**编辑**

我发现了一个类似于 Enumerable.Repeat 的库函数，虽然它在`List`模块中：

```
let c = a |> Seq.collect (fun (v,i) -> List.replicate i v) 
```

如果源序列中的对被颠倒，这会更优雅：

```
let c = a |> Seq.collect ((<||) List.replicate) 
```

所以似乎 Enumerable.Repeat （如在接受的答案中）确实是最好的解决方案，因为它的元组参数与序列元素匹配：

```
let c = a |> Seq.collect Enumerable.Repeat 
```

如果有人知道保留在 F# 库中的类似优雅的解决方案，请添加评论；谢谢。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T18:08:15.440

```
let rec repeat (item,n) = seq { if n > 0 then yield item; yield! repeat(item, n-1)}
a |> Seq.collect repeat 
```

例如，

```
[('a',2); ('b',2)] |> Seq.collect repeat

val it: seq<char> = seq ['a';'a';'b';'b'] 
```

# rest - AngularJS 控制器/服务/http 通信

> ID：15770803
> 
> 赞同：3
> 
> 时间：2013-04-02T17:49:36.823
> 
> 标签：rest, angularjs, angularjs-scope, angularjs-service

我已经将我的 REST API 封装在一个注入控制器的 AnguarJS 服务中。很标准，对。现在我希望该服务拦截任何 401 响应并以某种方式触发注销或重新登录提示或其他内容。问题是：该服务无权访问任何范围。广播该错误的最佳方法是什么？我提出了一些想法，但我是 Angular 的新手，想知道是否有人可以告诉我这样做的“Angular”方式？

1）我可以让服务充当我的 AppCtrl 可以监听的事件池。但这似乎有点过于复杂。所以：

```
myService.on('logout', function() { 
    $scope.isLoggedIn = false;
}); 
```

2）我可以将 $rootScope 注入服务，并直接修改服务`isLoggedIn`。但这似乎完全是错误的。我想明确区分服务服务数据、控制器控制范围以及指令与 dom 混在一起的地方。

3）我的每个控制器都可以监视一个被拒绝的承诺，如果原因是 401 错误，然后到达 $scope 并设置`isLoggedIn`为 false，但这个选项显然很糟糕。

有什么帮助吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T21:27:43.567

我们需要三个组件来进行交流；你已经知道有发生 ngSwitch 的控制器和 API 服务。第三个是您用来管理用户信息的某种类型的用户状态服务。这种类型的服务在 AngularJS 应用程序中很常见。请参阅**[此答案](https://stackoverflow.com/a/14206567/259038)**以了解该服务的外观。

您的 API 服务会在 401 上告诉该服务我们当前已注销。您也可以`$http`为此使用通用拦截器，但它会影响*所有* `$http`调用。您的选择在这里。

然后你的控制器只需要观察这个当前状态：

```
$scope.$watch( AuthService.isLoggedIn, function ( isLoggedIn ) {
  $scope.isLoggedIn = isLoggedIn;
}); 
```

您的模板可以在该范围变量上使用 ngShow：

```
<div class="login" ng-show="!isLoggedIn">
  ...
</div> 
```

该服务也可供任何需要它的控制器使用。如果我们*事先*知道用户未登录，您的 API 服务甚至可以在发出任何请求之前检查该值，以防止任何不必要的 API 调用。

这取决于您的应用程序的结构和您现有的代码，有无数的变化，但希望这会让您走上正确的道路。

# oracle - 单行子查询错误

> ID：15770804
> 
> 赞同：1
> 
> 时间：2013-04-02T17:49:38.413
> 
> 标签：oracle

我在 oracle sql 上有一个名为employees 的表。我要做的是返回所有员工的部门 ID 和最低工资，按部门 ID 分组，最低工资大于部门 ID 不等于 50 的员工的最低工资。

这就是我想出的：

```
select department_id, min(salary) 
from employees where min(salary)>(select min(salary) from employees 
where department_id!=50)
group by department_id; 
```

Oracle 给我错误：ORA-00934: group function is not allowed here

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:50:59.593

由于您使用聚合函数进行过滤，因此您需要将该代码放在一个[`HAVING`](http://www.techonthenet.com/sql/having.php)子句中。您不能在`WHERE`子句中使用聚合函数：

```
select department_id, min(salary) 
from employees
group by department_id
having min(salary)>(select min(salary) 
                     from employees 
                     where department_id!=50) 
```

# dns - Dig doman.com @nameserver 显示一个域的两条不一致的 A 记录

> ID：15770808
> 
> 赞同：1
> 
> 时间：2013-04-02T17:49:58.720
> 
> 标签：dns, ip-address, a-records

我已经要求另一家公司的技术人员将他们控制的域（例如，odddomain.com）指向我的一个 IP 地址（108.59.2.66）。在此之前，它被指向他们的ip，nn.nn.nn.nn。他通过电子邮件说一切都很好并且完成了。

我跑

```
whois odddomain.com 
```

并被告知 ns27.domaincontrol.com 是该域的两个权威 DNS 之一。

所以我跑

```
dig odddomain.com @NS28.DOMAINCONTROL.COM 
```

并得到

```
;; ANSWER SECTION:
odddomain.com.  3600    IN  A   nn.nn.nn.nn
odddomain.com.  3600    IN  A   108.59.2.66

;; AUTHORITY SECTION:
odddomain.com.  3600    IN  NS  ns28.domaincontrol.com.
odddomain.com.  3600    IN  NS  ns27.domaincontrol.com. 
```

“挖odddomain.com @NS28.DOMAINCONTROL.COM”的结果相同

odddomain.com 的 ip 的两个不一致的答案是否来自不同的 dns 控制器？我不确定我会如何创造这样的情况，所以我不知道如何告诉我的同事来解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:12:08.050

我的同事回复了我。他的 DNS 表中确实有两条不一致的 A 记录。他删除了其中一个，现在挖掘报告一切都很好。

# android - 我如何摆脱这些 Log cat 错误..？

> ID：15770810
> 
> 赞同：0
> 
> 时间：2013-04-02T17:50:00.247
> 
> 标签：android, thread-safety, android-activity, android-logcat, android-context

我在运行我的 android 应用程序时遇到以下错误...请帮助我解决它没有任何意义..

```
04-02 23:01:33.375: E/AndroidRuntime(4779): FATAL EXCEPTION: main
04-02 23:01:33.375: E/AndroidRuntime(4779): java.lang.RuntimeException: Unable to start service com.salesforce.samples.templateapp.MyServices@413c8878 with Intent { cmp=com.salesforce.samples.templateapp/.MyServices }: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2403)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.app.ActivityThread.access$1900(ActivityThread.java:127)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1221)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.os.Looper.loop(Looper.java:137)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.app.ActivityThread.main(ActivityThread.java:4448)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at java.lang.reflect.Method.invokeNative(Native Method)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at java.lang.reflect.Method.invoke(Method.java:511)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:823)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:590)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at dalvik.system.NativeStart.main(Native Method)
04-02 23:01:33.375: E/AndroidRuntime(4779): Caused by: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.app.ContextImpl.startActivity(ContextImpl.java:877)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.content.ContextWrapper.startActivity(ContextWrapper.java:276)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at com.salesforce.samples.templateapp.MyServices.onStartCommand(MyServices.java:43)
04-02 23:01:33.375: E/AndroidRuntime(4779):     at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2386) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:52:17.617

当您从服务调用 startActivity 时，请像上面所说的那样指定 FLAG_ACTIVITY_NEW_TASK。否则你会继续崩溃。

# java - 在运行时获取泛型类型类名称

> ID：15770816
> 
> 赞同：0
> 
> 时间：2013-04-02T17:50:14.377
> 
> 标签：java, reflection

我的应用程序正在抛出

```
java.lang.ClassCastException: java.lang.Class cannot be cast to java.lang.reflect.ParameterizedType 
```

对于此代码：

```
public class DsMap<K,V> implements Map<K, V>{
    protected Class<K> kClazz;
    protected Class<V> vClazz;  

    // Called during DS.getMap(mapName) method
    public DsMap(String name) {
        ParameterizedType genericSuperclass = (ParameterizedType) getClass().getGenericSuperclass();
        Type typeK = genericSuperclass.getActualTypeArguments()[0];
        Type typeV = genericSuperclass.getActualTypeArguments()[1];

        if (typeK instanceof Class) {
            this.kClazz = (Class<K>) typeK;
        } else if (typeK instanceof ParameterizedType) {
            this.kClazz = (Class<K>) ((ParameterizedType)typeK).getRawType();
        }

        if (typeV instanceof Class) {
            this.vClazz = (Class<V>) typeV;
        } else if (typeV instanceof ParameterizedType) {
            this.vClazz = (Class<V>) ((ParameterizedType)typeV).getRawType();
        }           
    }
} 
```

我想要实现的是在运行时获取`K`和的类名：`V`

这样做：

```
Map<String,String> dsMap = DS.getMap(mapName); 
```

我将获取and`java.lang.String`的类名，或者获取任何参数化的类名（不实例化and ）`kClazz``vClazz``Class<K>``Class<V>`

我的代码可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:13:36.120

参数化类型表示泛型类型的*具体*实现。*您可以像考虑模板*和*文档*之间的关系一样考虑泛型和参数化类型之间的关系。模板告诉您将在哪里填写信息，文档包含实际填写的信息。在您的示例中：

```
public class DsMap<K,V> implements Map<K, V> 
```

两者都是泛型类型（`DsMap`或`Map`模板）。它们的实际泛型参数不是由类本身指定的，因此编译器不会捕获它们。换句话说，它们的通用信息在运行时不可用。

为了在运行时捕获实际的泛型参数，这些参数需要成为类签名的一部分。例如，您的类的这个简单扩展将起作用：

```
public class DsMapIntegerString extends DsMap<Integer, String> 
```

因为你提供了具体的参数，返回的类型`getClass().getGenericSuperclass()`实际上是一个参数化的类，你的代码将不再失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:10:48.217

`DsMap`实现了一个泛型接口 ( `Map<K,V>`)，但它没有扩展一个泛型类。所以`getClass().getGenericSuperclass()`返回一个对 的引用`java.lang.Object`，它不能被强制转换为`ParameterizedType`。

该`(ParameterizedType) getClass().getGenericSuperclass()`技巧仅适用于 1) 子类扩展泛型类 2) 子类在编译时声明其类型参数

例如：

```
public abstract class DsMap<K, V> implements Map<K, V> { 
```

...

```
public class StringIntDsMap extends DsMap<String, Integer> { 
```

...

然后，`getGenericSuperclass()`将 return `DsMap`，它可以转换为，并且从返回的数组`ParameterizedType`中的条目可以转换为。`Type[]``getActualTypeArguments()``Class`

不幸的是，这不是一个非常普遍的情况。我经常使用它在单元测试之间共享代码（我可以在编译时声明泛型类型）。但它并没有推广到类型在运行时才可用的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:17:30.893

目视检查说尝试改变：

```
static public class DsMap<K, V> implements Map<K, V> { 
```

至

```
static public class DsMap<K, V> extends HashMap<K, V> { 
```

# java - Asynctask 等待函数导致错误

> ID：15770818
> 
> 赞同：0
> 
> 时间：2013-04-02T17:50:18.613
> 
> 标签：java, android, android-asynctask, udp

我试图运行这段代码

```
protected String doInBackground(String... params) {
    InetAddress client = null;
    boolean run = true;
    String data = "";
    DatagramPacket packet = null;
    while( run )
    {
        if( data.equalsIgnoreCase( "" ) )
        {

        }

        //Send some data
        if( data.equalsIgnoreCase( "connect" ) )
        {

        }

        //Log.d(TAG, "Data received was :" + data);

        try 
        {
            this.wait( 25 );
        } 
        catch (InterruptedException e) 
        {
            // TODO Auto-generated catch block
            Log.d(TAG, "Error with trying to sleep");
            e.printStackTrace();
        }
    }
    Log.d(TAG, "Error with while run value");
    return "finished";
} 
```

一旦它到达 this.wait(25); 我收到这个错误

```
04-02 18:49:25.070: D/gameObject(9065): New game object
04-02 18:49:25.085: W/dalvikvm(9065): threadid=12: thread exiting with uncaught exception (group=0x40015560)
04-02 18:49:25.089: E/AndroidRuntime(9065): FATAL EXCEPTION: AsyncTask #2
04-02 18:49:25.089: E/AndroidRuntime(9065): java.lang.RuntimeException: An error occured while executing doInBackground()
04-02 18:49:25.089: E/AndroidRuntime(9065):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.FutureTask.run(FutureTask.java:138)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.lang.Thread.run(Thread.java:1019)
04-02 18:49:25.089: E/AndroidRuntime(9065): Caused by: java.lang.IllegalMonitorStateException: object not locked by thread before wait()
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.lang.Object.wait(Native Method)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.lang.Object.wait(Object.java:395)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at com.example.gelorph_v1.gameServer.doInBackground(gameServer.java:116)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at com.example.gelorph_v1.gameServer.doInBackground(gameServer.java:1)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-02 18:49:25.089: E/AndroidRuntime(9065):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
04-02 18:49:25.089: E/AndroidRuntime(9065):     ... 4 more 
```

为什么会发生这种情况？

帆布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:54:06.403

我不认为`wait`这是你想要的。`thread`这告诉它等待另一个通过调用来通知它`notify()`。尝试

`Thread.sleep(25);` // 25 是以毫秒为单位的睡眠时间

反而。这将使`thread`睡眠（显然）达到您在继续之前声明的时间

[线](http://developer.android.com/reference/java/lang/Thread.html)

[等待](http://developer.android.com/reference/java/lang/Object.html#wait%28long%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:54:21.250

您确定要等待而不是睡觉吗？如果您希望它始终暂停 25 毫秒，请使用睡眠。如果您确实想使用等待，则需要在您正在等待的对象的同步块中这样做。

# ruby - ruby 模块中的模块函数、实例方法和类方法有什么区别？

> ID：15770820
> 
> 赞同：2
> 
> 时间：2013-04-02T17:50:32.273
> 
> 标签：ruby, namespaces, scope

我想知道当模块中定义的方法被定义为module_functions、类方法（即'def self.foo'）和实例方法（即'def foo'）时，它们的作用域的细节

如果将模块包含在不同的类中，行为会如何变化？

我一直在互联网上四处寻找，但无法找到一个好的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:59:03.600

在模块上定义了一个类（或者更准确地说是模块）方法，并以模块作为接收者来调用。你的时候不会混进去的`include YourModule`。

当你这样做时，模块的实例方法作为调用者的实例方法混合在一起`include YourModule`。

该`module_function`方法采用您在模块中定义的实例方法，将其设为私有（混入时将保持私有），并将其转换为公共模块方法。

# regex - 正则表达式序列匹配

> ID：15770826
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:50:57.410
> 
> 标签：regex

是否可以创建一个正则表达式来查找十六进制数字的递增序列？我试图在看似随机的十六进制数字字符串中找到数字序列（4 个数字长）。

`... 59 fd 25 bf b1 b2 b3 b4 39 ca ...`
`... 35 c1 55 c4 c5 c6 c7 74 92 e1 ...`

我希望`b1 b2 b3 b4`在第 1 行和`c4 c5 c6 c7`第 2 行中找到模式。

组匹配将找到*相同*的数字序列......`/(\w\w)\1{3}/`会找到`c4 c4 c4 c4`但我还没有找到匹配递增序列的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:06:42.497

`Regex`用于匹配重复出现的模式**不**用于匹配增量出现的模式

你最好用你自己的解析器来解析它

# memory - 神经网络/机器学习内存存储

> ID：15770832
> 
> 赞同：20
> 
> 时间：2013-04-02T17:51:10.817
> 
> 标签：memory, machine-learning, neural-network

我目前正在尝试建立一个用于信息提取的神经网络，并且我对神经网络的（基本）概念非常熟悉，除了一个似乎让我感到困惑的概念。这可能很明显，但我似乎无法找到有关它的信息。

*神经网络在哪里/如何存储它们的记忆？（/机器学习）*

网上有很多关于神经网络和机器学习的信息，但它们似乎都跳过了内存存储。例如重新启动程序后，它在哪里找到它的内存来继续学习/预测？许多在线示例似乎并没有“保留”内存，但我无法想象这对于实际/大规模部署是“安全的”。

我很难说出我的问题，所以如果我需要详细说明，请告诉我。谢谢，

* * *

编辑： - 跟进以下答案

> 每个神经网络都会有与之相关的边权重。这些边缘权重在神经网络的训练期间进行调整。

这正是我苦苦挣扎的地方，我应该/应该如何看待这个二级记忆？这像RAM吗？这似乎不合逻辑..我之所以问，是因为我没有遇到在线定义或指定此辅助内存的示例（例如在更具体的东西中，例如 XML 文件，甚至可能是一个巨大的数组）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-03T13:41:17.840

内存存储是特定于实现的，而不是算法本身的一部分。考虑您需要存储*什么而不是**如何*存储它可能更有用。

考虑一个 3 层多层感知器（全连接），在输入层、隐藏层和输出层中分别具有 3、8 和 5 个节点（对于本次讨论，我们可以忽略偏差输入）。那么表示所需权重的一种合理（且有效）的方法是通过两个矩阵：`3x8`输入层和隐藏层之间的`8x5`权重矩阵和隐藏层和输出层之间的权重矩阵。

对于此示例，您需要存储权重和网络形状（每层的节点数）。您可以通过多种方式存储此信息。它可以在 XML 文件或用户定义的二进制文件中。如果您使用的是 python，则可以将两个矩阵保存到二进制`.npy`文件中，并在文件名中编码网络形状。如果您实现了算法，则取决于您如何存储持久数据。另一方面，如果您正在使用现有的机器学习软件包，它可能具有自己的 I/O 功能，用于存储和加载经过训练的网络。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-02T18:00:25.350

每个神经网络都会有与之相关的边权重。这些边缘权重在神经网络的训练期间进行调整。我想您的疑问是关于存储这些边缘权重。好吧，这些值分别存储在辅助存储器中，以便可以保留它们以供将来在神经网络中使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T17:57:20.310

我希望对模型设计（神经网络）的讨论与实现的讨论分开，其中解决了诸如持久性之类的数据要求。

特定的库或框架可能对持久存储有特定的答案，但如果您是从头开始自己开发，那么这取决于您。

例如，为什么不把训练好的权重和拓扑写在一个文件中呢？YAML 或 XML 之类的东西可以作为一种格式。

此外，当我们谈论状态/存储和神经网络时，您可能对研究[联想记忆](http://en.wikipedia.org/wiki/Associative_memory)感兴趣。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-12T07:24:33.347

这可以分两步回答：

1.  什么是神经网络（简称 NN）中的“记忆”？

> 在训练神经网络 (NN) 时，它会构建一个数学模型，告诉 NN 为特定输入提供什么作为输出。想想当你训练某人说一门新语言时会发生什么。人脑创建了语言模型。类似地，NN 会为您尝试教它的内容创建数学模型。它将输入到输出的映射表示为一系列函数。这个数学模型就是记忆。这个数学模型是网络中不同边的权重。通常，训练一个 NN，并将这些权重/连接写入硬盘（XML、Yaml、CSV 等）。每当需要使用 NN 时，就会回读这些值并重新创建网络。

2.  如何让网络忘记它的记忆？

> 想想一个学过两种语言的人。让我们假设个人在 15 到 20 年内从未使用这些语言中的一种，而是每天使用另一种语言。每天很可能会学习几个新单词，而忘记许多不常用语言的单词。这里的关键部分是人类每天都在“学习”。在 NN 中，可以通过使用新数据训练网络来观察到类似的现象。如果旧数据不包含在新的训练样本中，那么基础数学模型将发生很大变化，以至于旧的训练数据将不再在模型中表示。可以通过改变训练过程来防止神经网络“忘记”旧模型。然而，这有一个副作用，即这样的 NN 无法学习全新的数据样本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-23T16:42:35.373

我会说你的方法是错误的。神经网络不是我们在计算机上看到的内存转储。没有特定内存块所在的地址。所有神经元一起确保给定的输入导致特定的输出。

让我们将其与您的大脑进行比较。当你品尝糖时，舌头的味蕾是读取化学信号并将电信号传输到大脑的输入节点。然后大脑使用各种电信号组合来确定味道。

没有查找表。没有初级和次级记忆，只有短期和长期记忆。

# php - jquery $.post 添加不需要的字符

> ID：15770835
> 
> 赞同：0
> 
> 时间：2013-04-02T17:51:26.437
> 
> 标签：php, javascript, jquery, ajax

我正在使用 jquery 的 post 方法与 php 通信并登录用户。这是代码：

```
 var user = $('#user').val();
    var pass = $('#password').val();
    $.post('php/login.php',
          {
              post_code:'login',
              username:user,
              password:pass
          },
          function(response){                
              alert(response);
              if(response== 'good'){
                changePage('homePage');
              }
              else{alert('bad info');}
     }); 
```

因此，成功登录后，php会回`good`显，当 javascript 发出警报时，它也会发出警报`good`。通过做一些调试，我发现 php 回显了一个`good`长度为 4 的字符串，但是 javascript 以某种方式在字符串的开头添加了两个空格并使它成为`__good`。我的解决方法是：

```
 response= response.substr(response.length - 4); 
```

但是我仍然对为什么将这两个空格添加到响应字符串中感到好奇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:56:48.093

如果您的 php 脚本中有空格，`<?php`它们将被添加到您的`"good"`答案字符串中。

# html - 网站有水平滚动条

> ID：15770842
> 
> 赞同：1
> 
> 时间：2013-04-02T17:51:41.900
> 
> 标签：html, css

我目前正在制作一个网站，但我有一个水平滚动条......这是 body/html 的 CSS

```
body,html {
    min-width:600px;
    height:100%;
    margin:0;
    padding:0;
    font-family:Calibri;
} 
```

这是一个小提琴：http: [//jsfiddle.net/charliejsford/8DSBY/](http://jsfiddle.net/charliejsford/8DSBY/)

即使更改了屏幕尺寸，我如何才能摆脱水平滚动条？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T17:58:39.533

您应该从页脚 css 中删除 width 属性。

溢出会掩盖问题，但不能解决布局的根本问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:54:40.847

您可以在 CSS 正文标记中使用以下内容：

```
overflow-y: scroll;
overflow-x: hidden; 
```

这将删除您的滚动条。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:49:10.057

```
width:auto; can solve your doubt? 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-11T23:28:39.600

尝试从 CSS 中删除 width:100%

# javascript - django 通过 js 添加另一个字段和一个模型字段

> ID：15770850
> 
> 赞同：0
> 
> 时间：2013-04-02T17:52:02.070
> 
> 标签：javascript, python, django

我想在 django admin 中添加“添加另一个字段”和“删除字段”按钮，从而分别添加/删除一个文本字段。并且所有这些字段都应该连接（通过某个字符分隔）并分配到一个模型文本字段中。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T20:14:07.837

你最好的选择是使用 Javascript。让 Javascript 在按钮单击时创建新字段（或删除它）。让用户根据需要填写该字段。当它们准备好保存时，您需要捕获提交（再次使用 Javascript）并将所有内容连接到初始 textarea 字段中，然后让它提交到 Django 应该处理它的服务器。

然后，您还必须在页面加载时运行 Javascript 以检查 textarea 并拆分 textarea 的不同部分。

或多或少这就是你将要如何去做的事情。如果你想让某人为你写它，那将是一个完全不同的讨论。

（我知道很容易站出来说“为什么那样做，那不是最好的方法”。我经常遇到最好的方法行不通的约束，所以我尽量不要在不知道他们的约束的情况下敲打别人。 )

# c++ - istringstream 无效错误初学者

> ID：15770851
> 
> 赞同：0
> 
> 时间：2013-04-02T17:52:04.633
> 
> 标签：c++, istringstream

我有这段代码：

```
if(flag == 0)
{
// converting string value to integer

istringstream(temp) >> value ;
value = (int) value ; // value is a 
} 
```

我不确定我是否使用`istringstream`正确的操作员。我想将变量“值”转换为整数。

```
Compiler error : Invalid use of istringstream. 
```

我应该如何解决？

*在尝试使用第一个给出的答案进行修复之后。它向我显示以下错误：*

```
stoi was not declared in this scope 
```

有没有办法我们可以克服它。我现在使用的代码是：

```
int i = 0 ;
while(temp[i] != '\0')
{
  if(temp[i] == '.')
     {
       flag = 1;
       double value = stod(temp);
     }
     i++ ;
}
if(flag == 0)
{
// converting string value to integer
int value = stoi(temp) ;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:59:21.987

除非您真的需要这样做，否则请考虑仅使用以下内容：

```
 int value = std::stoi(temp); 
```

如果您必须使用 a `stringstream`，您通常希望将其包装在一个`lexical_cast`函数中：

```
 int value = lexical_cast<int>(temp); 
```

代码看起来像：

```
 template <class T, class U>
 T lexical_cast(U const &input) { 
     std::istringstream buffer(input);
     T result;
     buffer >> result;
     return result;
 } 
```

`stoi`至于如果你没有如何模仿，我会`strtol`以此为起点：

```
int stoi(const string &s, size_t *end = NULL, int base = 10) { 
     return static_cast<int>(strtol(s.c_str(), end, base);
} 
```

请注意，这几乎是一种快速而肮脏的模仿，根本没有真正满足`stoi`正确的要求。例如，如果输入根本无法转换（例如，以 10 为基数传递字母），它应该真的抛出异常。

对于双精度，您可以`stod`以大致相同的方式实现，但`strtod`改为使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:59:12.010

首先，`istringstream`不是运营商。它是一个对字符串进行操作的输入流类。

您可以执行以下操作：

```
 istringstream temp(value); 
   temp>> value;
   cout << "value = " << value; 
```

您可以在此处找到 istringstream 使用的简单示例：[http ://www.cplusplus.com/reference/sstream/istringstream/istringstream/](http://www.cplusplus.com/reference/sstream/istringstream/istringstream/)

# c - 如何使用 SetConsoleCursorPosition 函数

> ID：15770853
> 
> 赞同：4
> 
> 时间：2013-04-02T17:52:16.540
> 
> 标签：c, winapi, graphic

我刚刚在 c 中编写了河内塔的代码，我想使用字符以图形模式显示解决方案。

我想使用 windows.h 和`SetConsoleCursorPosition`函数在控制台中移动光标。

你能告诉我这个功能是否有效以及如何使用它来帮助我吗？请举一些例子。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-02T17:55:54.383

下面是如何调用`SetConsoleCursorPosition`函数的示例，取自[cplusplus](http://www.cplusplus.com/forum/beginner/4234/)：

```
void GoToXY(int column, int line)
{
    // Create a COORD structure and fill in its members.
    // This specifies the new position of the cursor that we will set.
    COORD coord;
    coord.X = column;
    coord.Y = line;

    // Obtain a handle to the console screen buffer.
    // (You're just using the standard console, so you can use STD_OUTPUT_HANDLE
    // in conjunction with the GetStdHandle() to retrieve the handle.)
    // Note that because it is a standard handle, we don't need to close it.
    HANDLE hConsole = GetStdHandle(STD_OUTPUT_HANDLE);

    // Finally, call the SetConsoleCursorPosition function.
    if (!SetConsoleCursorPosition(hConsole, coord))
    {
        // Uh-oh! The function call failed, so you need to handle the error.
        // You can call GetLastError() to get a more specific error code.
        // ...
    }
} 
```

您还可以通过查看 SDK 文档了解如何使用 Win32 函数。谷歌搜索函数的名称通常会在第一次点击时找到相应的文档页面。
因为`SetConsoleCursorPosition`，页面在[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686025.aspx)，而对于`GetStdHandle`，页面在[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683231.aspx)。

# php - mysql 仅当用户存在于数据库中时才插入数据库？

> ID：15770854
> 
> 赞同：0
> 
> 时间：2013-04-02T17:52:17.040
> 
> 标签：php, mysql

嗨，我正在寻找一种在 php 或 mysql 中实现条件的方法，仅当数据库中存在“from_user_id”时才执行以下 mysql 查询？

我有一个名为 ptb_users 的表，它存储所有用户 ID，下面的查询插入内容的另一个表是 ptb_wallposts。

用户可以在其他用户墙上书写，但在用户可以在用户墙上书写之前/在插入查询运行之前，我希望条件与 ptb_users 交叉引用以确保发送消息的用户/from_user_id 存在。因此，如果用户 1 已登录并想向用户 2 的墙发送消息，则它首先检查 from_user_id 是否与 ptb_users 中的 user_id 匹配。

因此，例如，我不希望人们通过能够使 from_user_id 为 0 来将数据注入数据库，它必须与数据库中的 user_id 匹配或显示和错误消息。

有人可以建议我如何做到这一点。谢谢。

我的 ptb_wallposts 表看起来像这样

```
id   |     from_user_id   |  to_user_id  |  content

1               2                3            hello 
```

我的 ptb_users 表如下所示：

```
id   |     user_id   |  

1             2 
```

mysql查询：

```
$sql = "INSERT INTO ptb_wallposts (id, from_user_id, to_user_id, content) VALUES (NULL, '".$_SESSION['user_id']."', '".$profile_id."', '".$content."');";
            mysql_query($sql, $connection); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:04:34.517

使用外键，SQL 为您完成这项工作。首先，您需要像这样添加它们

```
ALTER TABLE `ptb_wallposts`
    ADD CONSTRAINT `users_wallposts_fk_1` FOREIGN KEY (`from_user_id`) REFERENCES `ptb_users` (`id`) ON DELETE CASCADE,
    ADD CONSTRAINT `users_wallposts_fk_2` FOREIGN KEY (`to_user_id`) REFERENCES `ptb_users` (`id`) ON DELETE CASCADE; 
```

现在，如果您想插入一个`id`不在其中的内容，`ptb_users`您将收到 SQL 错误。

有关含义的信息，请参阅[此链接](https://stackoverflow.com/questions/1481476/when-to-use-on-update-cascade)`ON DELETE CASCADE`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-02T18:22:35.303

你可以试试这个：

```
if(mysql_num_rows(mysql_query("SELECT id  FROM ptb_users WHERE user_id='".$_SESSION['user_id']."'"))){
        //your insert statement 
}

else{
        //not allowed 
} 
```

我看到您正在使用 $_SESSION 变量我认为您不需要检查 user_id 是否存在于数据库中，因为最终用户无法操作 $_SESSION 变量。

# jquery - 不能使用 jQuery 的 form.serialize 排除空字段

> ID：15770858
> 
> 赞同：0
> 
> 时间：2013-04-02T17:52:23.350
> 
> 标签：jquery, ajax, forms, input

[如何使用 jQuery 的 form.serialize 但排除空字段](https://stackoverflow.com/questions/608730/how-do-i-use-jquerys-form-serialize-but-exclude-empty-fields)我遇到了与此处提到的相同的问题，我正在尝试使用答案

```
var form = $(this).parents('form:first');//this is inside the button.clicks callback 
var values = form.find(':input').not('[value=""]').serialize(); 
```

但这似乎不起作用

```
values = form.find(":input[value][value!='']").serialize(); 
```

这也不起作用我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:56:43.103

您可以禁用空元素序列化然后启用它们

```
form.find(":input").each(function(){
    if (this.value == '') this.disabled = true;
})
values = form.serialize();
form.find(":input:disabled").prop('disabled',false); 
```

# oracle - 对可以逆向工程和处理超大型数据库的 Oracle 数据建模器的建议

> ID：15770859
> 
> 赞同：0
> 
> 时间：2013-04-02T17:52:25.087
> 
> 标签：oracle, data-modeling, toad

非常大，我的意思是在成千上万张桌子的范围内。我已经能够使用 Toad Data Modeler 进行逆向工程，但是一旦它加载了它创建的 txp 文件，它就会发出嘶哑的声音。即使尝试拆分模型也是不可能的，因为 TDM 只是静止不动。

所以，我想知道还有哪些其他选项，也许有任何 32 位应用程序可以处理这样的数据库模型（考虑到它使用的内存约为 750MB，我认为它对于 32 位来说不会太大具有最大 RAM 的计算机）。

另外需要注意的是，我不是想用这个创建一个图表（除非你已经知道系统，否则这么大的图表实际上是无用的），而是需要导出数据库的设计。所以数据模型工具不需要支持任何类型的奇特图形，这在给定大小的情况下可能是不可能的。

编辑：我找到了导致 TDM 工作的潜在解决方案。您必须关闭项目，关闭 TDM，打开 TDM，然后打开项目。如果你只是在进程被冻结时杀死它，这将不起作用。这样做是将显示图形表示的屏幕缩放到正常视图级别，而通常在逆向工程之后，整个数据库都被放入视图中（如果你只是杀死进程，当你再次打开文件时，你会看到整个数据库）。虽然我不确定细节，但它似乎被放大了，这使得 TDM 运行更加顺畅，不会冻结或崩溃，因此我能够继续在其中工作以做我需要的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:27:36.237

Oracle 自己的[SQL Developer Data Modeler](http://www.oracle.com/technetwork/developer-tools/datamodeler/overview/index.html)怎么样？

# c# - 无法为媒体类型“application/x-www-form-urlencoded”生成样本

> ID：15770860
> 
> 赞同：30
> 
> 时间：2013-04-02T17:52:25.303
> 
> 标签：c#, asp.net, asp.net-web-api

我最近开始创建一个 ASP.net Web API

出于某种原因，我在查看自动生成的帮助文档时不断收到此错误：

![在此处输入图像描述](https://i.stack.imgur.com/TBpyI.jpg)

这是一个 POST 方法

示例对于 application/json 和 application/xml 显示良好

我不太确定，但 application/-x-www-form-urlencoded 不断出现

我已经用谷歌搜索了很多错误，但找不到可能导致此错误的原因

我非常感谢可以提供的任何帮助，如果您有任何问题，请告诉我。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-02T21:44:07.097

这是预期的行为。HelpPage 示例生成使用 HttpConfiguration 上的实际格式化程序来“写入”示例对象。FormUrlEncodedMediaTypeFormatter 无法“写入”任何类型，因此 HelpPage 无法为其生成样本。作为一种解决方法，您可以显式提供特定类型的示例（如 Areas\HelpPage\App_Start\HelpPageConfig.cs 的注释代码中所示）。

```
config.SetSampleForType("[0]=foo&[1]=bar", new MediaTypeHeaderValue("application/x-www-form-urlencoded"), typeof(IEnumerable<string>)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-02-24T16:17:12.543

答案帮助了我，但我厌倦了为系统不知道的每种类型编写一个示例......我最终做的是这个

```
Type[] types = { typeof(MyType), typeof(AnotherType), *add more here* };

foreach(Type t in types)
{
    List<string> propExample = new List<string>();
    foreach(var p in t.GetProperties())
    {
        propExample.Add(p.Name + "=value");
    }

    config.SetSampleForType(string.Join("&", propExample), new MediaTypeHeaderValue("application/x-www-form-urlencoded"), t);            
} 
```

有人可以变得聪明并对其进行扩展，以便它根据属性类型输入默认值，但这对于我的目的来说已经足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-05T15:05:04.107

我意识到我参加聚会迟到了...

借鉴@Adween 的答案并尝试应对挑战。

> “有人可以变得聪明并扩展它，以便它根据属性类型放入默认值......”

我尝试为参数插入样本值。我不喜欢我必须对示例值进行 URLEndcode，但我更喜欢输出。

```
foreach ( Type t in new Type[] { typeof( MyType ) } )
{
    List<string> propExample = new List<string>();
    foreach ( var p in t.GetProperties() )
    {
        propExample.Add( p.Name + "=" + HttpUtility.UrlEncode( config.GetHelpPageSampleGenerator().GetSampleObject(p.PropertyType).ToString() ) );
    }

    config.SetSampleForType( string.Join( "&", propExample ), new MediaTypeHeaderValue( "application/x-www-form-urlencoded" ), t );
} 
```

# php - 在具有多个字段的准备好的语句中仅查询一个参数

> ID：15770868
> 
> 赞同：0
> 
> 时间：2013-04-02T17:52:46.760
> 
> 标签：php, prepared-statement

我从多个表单字段中获取值并使用准备好的语句来查询数据库。虽然下面的代码适用于在单个字段中输入的条件，但如果我在多个字段中输入，它不会返回任何值。原因似乎是页面只处理输入的最后一个字段。当我之前`echo`的值我只得到一个值...`$params``$results->execute(array($params));`

这是我所拥有的：

```
<?php

$dbhost     = "ip_address";
$dbname     = "db_name";
$dbuser     = "db_login";
$dbpass     = "db_pass"; 

$conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);

    $query = "SELECT * FROM tbl_name WHERE 1=1";

    foreach ($_POST as $k => $v) 
    { 
      if(!empty($v)) {
        $query .= " AND $k LIKE ?";
        $params[] = '%'.$v;     
      }  
    }   

    $results = $conn->prepare($query);
    $results->execute($params);

    $results->bindColumn(1, $no);
    $results->bindColumn(2, $date);
    $results->bindColumn(3, $name);
    $results->bindColumn(4, $id);
    $results->bindColumn(5, $path);

?> 
```

## 编辑：

我将上面的代码更改为工作脚本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:14:24.890

您应该首先定义`$params`为一个数组，然后像@mkjasinski 所说的那样做。也是`prepare`在完整的查询构建之前完成的，因此发送到数据库的查询是：

`SELECT * FROM tbl_name WHERE 1=1`

我相信做好这两件事会让你得到你想要的。

# ruby - 我们如何使用 rspec 测试 /user/show?id=xx？

> ID：15770874
> 
> 赞同：2
> 
> 时间：2013-04-02T17:53:02.933
> 
> 标签：ruby, testing, rspec, controller, routes

我系统中的路线是：

```
user_show GET /user/show(.:format)  user#show. 
```

控制器代码为：

```
def show
    @user = User.find(params[:id])
    respond_to do |format|
        format.html # show.html.erb
        format.json { render json: @user}
    end
end 
```

_spec.rb

```
describe 'GET #show' do
    it 'should return success' do
        get :show, id:@user.id
        expect(response).to be_success
    end
end 
```

结果是：

> 失败/错误：expect(response).to be_success
> 
> 预期成功？返回真，得到假

在浏览器中，当我输入 xxx/user/show 时，它会出错。

> ActiveRecord::RecordNotFound in UserController#show

但是如果我输入 xxx/user/show?id=31，它会显示 id=31 的用户！！

感谢@Alex Wayne，我在这里添加了更多信息：我检查了 routes.rb 文件：

```
 get "user/show"
  get "user/index"
  get "user/delete"
  get "user/edit"
  post "user/update"
  resource :users, :path => :user, :as => :user 
```

[我个人认为我的队友不应该根据Rails Routing](http://guides.rubyonrails.org/routing.html)写下“get user/show, get user/index....” 。但我无法更改他们的代码。那么，有人知道如何测试 user/show?id=xxx 吗？非常感谢~！！！！

# ios - 在另外两个标签之间垂直居中 UILabel

> ID：15770875
> 
> 赞同：1
> 
> 时间：2013-04-02T17:53:03.227
> 
> 标签：ios, position, uilabel

我在故事板中绘制了 3 个 UILabel，它们位于彼此之上。

静态 UI 标签 1

动态 UI 标签 2

静态 UI 标签 3

标签 1 和 3 是静态的，永远不会改变。标签 2 是动态的，并且总是一个句子长，但可以是一个短句或长句。我希望标签 2 根据有多少文本在标签 1 和标签 3 之间完全垂直居中。任何想法如何做到这一点？非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:59:48.480

将 Label1 和 Label3 的中心值相加，除以 2 使其成为 label2 的中心

```
CGPoint point = CGPointMake(Label2.Center.x,(Label1.center.y+Label3.center.y)/2);
Label2.center = point; 
```

就这样....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T18:04:38.127

如果您使用的是自动布局（默认情况下启用），那么您可以拉伸中间标签，直到它的顶部和底部与其他两个标签的标准距离为标准距离（当您到达该位置时，您会看到一条蓝色虚线距离）。这假设您的标签具有清晰的背景，或者您不介意看到一个高大的标签（如果没有的话）。无论行数如何，文本都将在此高标签中垂直居中。它也将保持以旋转为中心。

# c# - 类 Quadrilateral 的 C# 继承层次结构？

> ID：15770876
> 
> 赞同：0
> 
> 时间：2013-04-02T17:53:03.823
> 
> 标签：c#, class, object, inheritance

我有以下代码，但它没有给我任何输出。我完全不知道接下来要做什么。需要以下输出

四边形的坐标为：( 1.1, 1.2 ), ( 6.6, 2.8 ), ( 6.2, 9.9 ), ( 2.2, 7.4 )

```
 using System;

  class testquadrilaterals 
  {
static void Main() 
{
    quadrilateral obj1 = new quadrilateral(1.1, 1.2, 6.6, 2.8, 6.2, 9.9, 2.2, 7.4);
    Console.ReadLine();
}
  }

  class point 
  {
private double x;
private double y;

public point(double x_coord, double y_coord)
{
    x = x_coord;
    y = y_coord;
}

public double X { get { return x; } set { x = value; } }
public double Y { get { return y; } set { y = value; } }

public void printcoord()
{
    Console.WriteLine("(" + X + ", " + Y + ")");
}
  }

  class quadrilateral
  {
point p1, p2, p3, p4;

public quadrilateral(double x1, double y1, double x2, double y2,
    double x3, double y3, double x4, double y4)
{
    p1 = new point(x1, y1);
    p2 = new point(x2, y2);
    p3 = new point(x3, y3);
    p4 = new point(x4, y4);
}

public point P1 { get { return p1; } set { p1 = value; } }
public point P2 { get { return p2; } set { p2 = value; } }
public point P3 { get { return p3; } set { p3 = value; } }
public point P4 { get { return p4; } set { p4 = value; } }

public string printcoordinates() 
{
    return "Coordinates of Quadrilateral are " + p1.ToString() + " " + p2.ToString() + " " + p3.ToString() + " ";
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:54:25.300

您需要调用您的打印方法：

```
class testquadrilaterals 
{
    static void Main() 
    {
        quadrilateral obj1 = new quadrilateral(1.1, 1.2, 6.6, 2.8, 6.2, 9.9, 2.2, 7.4);
        Console.WriteLine(obj1.printcoordinates()); // Call your print method
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:59:37.197

修复您的打印坐标并调用它：

```
public void printcoordinates() 
{
    console.writeline("Coordinates of Quadrilateral are " + p1.ToString() + " " + p2.ToString() + " " + p3.ToString() + " ");

}

class testquadrilaterals 
{
    static void Main() 
    {
        quadrilateral obj1 = new quadrilateral(1.1, 1.2, 6.6, 2.8, 6.2, 9.9, 2.2, 7.4);
        obj1.printcoordinates(); // Call your print method
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T17:59:20.680

您`point`似乎没有`ToString`覆盖-我认为-您有打印但未连接。

看来您想要的是定义调用该打印的 ToString - 如果我做对了，代码

我会这样做 - 对于`point`：

```
public override string ToString()
{
    return "(" + X + ", " + Y + ")";
} 
```

......对于四级......

```
public override string ToString()
{
    return "Coordinates of Quadrilateral are " + p1.ToString() + " " + p2.ToString() + " " + p3.ToString() + " ";
} 
```

像这样称呼它：

```
Console.Write(obj1.ToString()); 
```

# javascript - 如何告诉 Sonar 使用我的万无一失的报告来获取单元测试结果

> ID：15770877
> 
> 赞同：4
> 
> 时间：2013-04-02T17:53:06.213
> 
> 标签：javascript, sonarqube, surefire

我们有一个包含一堆 javascript 文件的 Jenkins 作业。我们通过 grunt 构建我们的项目，并在构建结束时运行 JSCover 来运行我们的单元测试并收集代码覆盖率。这一切都有效。我们得到了一个不错的 LCOV 文件，我们在 target/surefire-reports/ 目录中得到了一堆 TEST-*.xml。

Sonar 显示代码覆盖率结果，但不显示通过/失败甚至执行的测试数量。

我如何告诉声纳使用万无一失的报告？我想通过设置这个属性，它会消耗它，但没有爱：

```
sonar.surefire.reportsPath=target/surefire-reports 
```

这是我的项目属性文件：

```
# project metadata (required)
sonar.projectKey=pure.cloud.browser.app
sonar.projectName=Pure Cloud Browser App
sonar.projectVersion=1.0
# path to source directories (required)
sonar.sources=src
sonar.exclusions=js/lib/**,js/test/lib/**,js/test/tools/**
# The value of the property must be the key of the language.
sonar.language=js

# Advanced parameters
sonar.surefire.reportsPath=target/surefire-reports
sonar.javascript.lcov.reportPath=target/test-coverage/jscover.lcov
sonar.dynamicAnalysis=reuseReports 
```

感谢 Fabrice 在我之前的问题中向我推荐以下链接： [https](https://github.com/SonarSource/sonar-examples/tree/master/projects/languages/javascript/javascript-sonar-runner-JsTestDriver) ://github.com/SonarSource/sonar-examples/tree/master/projects/languages/javascript/javascript-sonar-runner-JsTestDriver但我可以'找不到方法告诉 Sonar 以某种方式显示存储在 surefire-reports 目录中的单元测试结果（测试数、失败数等）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T13:31:14.873

在 Sonar Javascript 1.3 中，“sonar.surefire.reportsPath”已被“sonar.javascript.jstestdriver.reportsPath”取代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-25T18:01:13.137

该属性不再存在。见[http://jira.codehaus.org/browse/SONARJS-163](http://jira.codehaus.org/browse/SONARJS-163)

# c++ - 将音频样本转换为可听文件格式

> ID：15770878
> 
> 赞同：0
> 
> 时间：2013-04-02T17:53:17.010
> 
> 标签：c++, audio, wav, sampling, pcm

几天来，我一直在尝试将大量数据（约 900 MB）转换为可听文件格式。我收到了一个 .dat 文件，其中包含 9 亿个浮点样本（每行一个），代表 90 秒的 10 MHz 音乐。

我下采样到 40 KHz，但现在我不知道如何才能听到隐藏在这些字节中的音频。我正在 Linux 环境中编写 C++ 程序，但如果有人知道如何使用 Matlab、Octave、Python、Audacity、MPlayer 或任何其他工具完成此任务，请站出来说话：) 非常感谢任何数量的贡献.

```
    头 -n 5 ~/input.dat
    -2.4167
    -7.5322e-016
    -0.2283
     0.13581
    -0.51926

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:56:58.867

[wav 文件格式](https://ccrma.stanford.edu/courses/422/projects/WaveFormat/)是一种相当简单的格式。

您只需要编写该链接中定义的 44 字节标头块，然后将您的数据转换为整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:58:39.453

将您的采样率设定为 44100 赫兹（或 48000、22050、11025 或 8000 赫兹）

将您的音频样本转换为 16 位有符号整数（-32768 到 +32767）。

请按照此处有关 WAV 文件合成的说明进行操作： [WAV 文件从头开始合成 - C](https://stackoverflow.com/questions/10844122/wav-file-synthesis-from-scratch-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T18:30:53.317

如果您有一个字节序列并想将其转换为音频，您需要做的就是向它写入一个标头。既然你提到你可以使用`MatLAB`，我会推荐`wavwrite`命令。它很简单，经过试验和测试，非常适合原型制作。这是文档的链接：http:
[//www.mathworks.in/help/matlab/ref/wavwrite.html](http://www.mathworks.in/help/matlab/ref/wavwrite.html)

如果您使用`wavwrite`.
- 由于您的输入数据是浮点数，因此将文件中的数据缩放到 [-1, 1] 的范围内。
- 一旦数据被缩放插入并插入函数调用。- 使用命令
播放 wav 文件。`wavplay`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-21T00:26:03.680

WAV 允许浮点采样数据和广泛的采样率（1Hz 到 4.2GHz，以 1Hz 为增量，如果有记忆的话）。

您无需费心转换为整数值。只需适当地设置 WAV 文件的标题并将 32 位浮点数作为二进制数据写入数据部分。

从存储的角度来看，10MHz 的采样率对于 WAV 文件来说是没有问题的。然而，回放需要转换为硬件可以处理的东西。这些天的上限通常是 96 或 192 kHz。

# php - Unix 时间戳到 LDAP 时间戳

> ID：15770879
> 
> 赞同：2
> 
> 时间：2013-04-02T17:53:21.040
> 
> 标签：php, windows, unix, time, ldap

有很多关于如何转换 LDAP-> Unix 的例子，但我不能像在 Unix-> LDAP 中那样将它转换回来。

这是我为 LDAP->Unix 准备的：

[如何将 LDAP 时间戳转换为 Unix 时间戳](https://stackoverflow.com/questions/4647169/how-to-convert-ldap-timestamp-to-unix-timestamp)
[http://www.morecavalier.com/index.php?whom=Apps%2FLDAP+timestamp+converter](http://www.morecavalier.com/index.php?whom=Apps%2FLDAP+timestamp+converter)

```
function LDAPtoUnix($t) {
    $secsAfterADepoch = $t / (100000000);
    $AD2Unix = ( (1970-1601) * 365 -3 + round((1970-1601)/4) ) * 86400;
    return intval($secsAfterADepoch-$AD2Unix);
} 
```

我认为应该是准确的。但是我正在扭曲我那微不足道的小大脑来扭转数学，我无法弄清楚它。我的脑袋正在沸腾，只是为了计算不同时期之间的秒差，然后简单地将它们加/减到给定的时间参数？

有人可以阐明如何反转时间戳吗？

参考： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms679430 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679430(v=vs.85).aspx)

除了我的大脑不想计算数学之外，我还问的主要原因是 PHP 的浮点机制似乎没有它需要的那么具体？如果我计算 Unix->LDAP 时间戳，我最终会得到`1.3009518089E+17`并且我不确定 Active Directory 是否喜欢这个特定的符号，所以我需要将它存储在一个字符串中，但我不知道如何计算这些大数字，而不是双倍。

目前我有：

```
printf("%.0f", UnixToLDAP(time())); 
```

这给了我正确的长度，但它并不是很具体。

# 我需要的

`pwdLastSet`适合Active Directory的简短而简单的 Unix->LDAP 时间戳。此外，它必须尽可能完美，我的尝试在检查时并没有很好地结束：[http ://www.morecavalier.com/index.php?whom=Apps%2FLDAP+timestamp+converter](http://www.morecavalier.com/index.php?whom=Apps%2FLDAP+timestamp+converter)

# 谷歌：自动解决方案（Windows 2012 Active Directory）

您可以简单地在 pwdLastSet 中声明 -1，Windows 会自动将时间设置为更改密码后的最后一次登录时间。它并不完美，但它适用于任何在谷歌上搜索并最终来到这里的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T18:11:44.447

您可以通过正确命名输入参数并在返回之前分配一个中间变量来使您的函数更具可读性。由于`$AD2Unix`实际上是一个固定项，它可能是一个常数；现在，我刚刚将它移到函数的顶部：

```
function LDAPtoUnix($ldap_ts) {
    $AD2Unix = ( (1970-1601) * 365 -3 + round((1970-1601)/4) ) * 86400;

    $secsAfterADepoch = $ldap_ts / 100000000;
    $unix_ts = intval( $secsAfterADepoch - $AD2Unix );

    return $unix_ts;
} 
```

我们现在有 2 行要反转；它们显然需要以相反的顺序发生，然后使用简单的代数重新排列每个（`/`变成`*`，`-`变成`+`）中的项，我们得到：

```
function UnixtoLDAP($unix_ts) {
    $AD2Unix = ( (1970-1601) * 365 -3 + round((1970-1601)/4) ) * 86400;

    $secsAfterADepoch = intval( $AD2Unix + $unix_ts );
    $ldap_ts = $secsAfterADepoch * 100000000;

    return $ldap_ts;
} 
```

一些测试表明这很好地反转了原始数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-05T06:51:46.503

不要使用`intval()`，在 32 位 PHP 上会溢出，让 PHP 使用 float。

```
function toLdap($unixTimeStamp) {
    return ($unixTimeStamp + 11644473600) * 10000000;
}

function toUnix($ldapTimeStamp) {
    return (int) (($ldapTimeStamp / 10000000) - 11644473600);
} 
```

`DateTime`您可以使用（更具可读性）计算 Unix 和 LDAP 时间的差异

```
$diff = (new DateTime('1970-01-01'))
     ->diff(new DateTime('1601-01-01'))
     ->days * (24 * 60 * 60);

echo $diff; // 11644473600 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T18:12:16.860

像这样的东西？

```
function UnixToLDAP($t) {
    $AD2Unix = ( (1970-1601) * 365 -3 + round((1970-1601)/4) ) * 86400;
    return intval($t+$AD2Unix) * 100000000;
} 
```

# java - 使用java代码截断表

> ID：15770882
> 
> 赞同：-2
> 
> 时间：2013-04-02T17:53:26.153
> 
> 标签：java, ms-access

如何使用java代码截断表

```
try{
        con=db.setConnetion();
        stm=con.createStatement();
        stm.executeUpdate("TRUNCATE TABLE temptblDateWiseReport");
        System.out.println("Truncated");           
        stm.close();
        con.close();
    }catch(SQLException ex){
        System.out.println("General Info Error");
        ex.printStackTrace();
    } 
```

它给出了错误

```
 java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Invalid SQL statement; expected 'DELETE', 'INSERT', 'PROCEDURE', 'SELECT', or 'UPDATE'.
    at sun.jdbc.odbc.JdbcOdbc.createSQLException(JdbcOdbc.java:6956)
    at sun.jdbc.odbc.JdbcOdbc.standardError(JdbcOdbc.java:7113)
    at sun.jdbc.odbc.JdbcOdbc.SQLExecDirect(JdbcOdbc.java:3109)
    at sun.jdbc.odbc.JdbcOdbcStatement.execute(JdbcOdbcStatement.java:337)
    at sun.jdbc.odbc.JdbcOdbcStatement.executeUpdate(JdbcOdbcStatement.java:287)
    at com.AshaIndustry.gui.DateWiseReport.jbtnPrintActionPerformed(DateWiseReport.java:245) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T17:57:09.480

AFAIK MS Access 不支持 TRUNCATE 关键字。您可以使用：

```
delete from temptblDateWiseReport 
```

# java - 如何获取标签名称以特定字符串结尾的所有 XML 节点

> ID：15770883
> 
> 赞同：-1
> 
> 时间：2013-04-02T17:53:27.750
> 
> 标签：java, xml

我试图弄清楚如何解决一个非常琐碎的问题。假设我有两个“家族”的 xml 文档：“请求”和“响应”。

属于“请求”的文档至少有一个以“请求”结尾的标签名称，如下所示：

```
<MyMessage>
    <doSomethingRequest>
         ...
    </doSomethingRequest>
    ...
</MyMessage> 
```

显然属于“响应”的消息将是

```
<MyMessage>
    <doSomethingResponse>
         ...
    </doSomethingResponse>
    ...
</MyMessage> 
```

现在这个问题很简单。如果消息属于两个家庭之一，我如何才能有效地理解？

我试过类似的东西：

```
public static String getMessageFamily(Document xml){
    if(xml.getElementsByTagName("*Request").getLength() != 0){
        return "I'm a Request!";
    } else if(xml.getElementsByTagName("*Response").getLength() != 0){
        return "I'm a Response!";
    } else {
        return "don't know who I am";
    }
} 
```

但显然这不起作用（实际上我很确定这不起作用，因为通配符`org.w3c.dom.Document`只允许独立匹配所有标签）。

任何的想法？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T19:58:54.553

正如所指出的，这个问题是微不足道的，答案也是如此：使用 XPath，以函数结尾。

```
public static String getMessageType(Document xml) {
    try {
        xpathFactory = XPathFactory.newInstance(NamespaceConstant.OBJECT_MODEL_SAXON);
        XPath xpath = xpathFactory.newXPath();

        XPathExpression searchRequest = xpath.compile("//*[ends-with(name(),'Request')]");
        XPathExpression searchResponse = xpath.compile("//*[ends-with(name(),'Response')]");
        NodeList requestResult = (NodeList) searchRequest.evaluate(xml, XPathConstants.NODESET);
        NodeList responseResult = (NodeList) searchResponse.evaluate(xml, XPathConstants.NODESET);

        if(requestResult.getLength() != 0) return "REQ";
        if(responseResult.getLength() != 0) return "RESP";
    } catch (XPathExpressionException e) {
        e.printStackTrace();
        return null;
    } catch (XPathFactoryConfigurationException e) {
        e.printStackTrace();
        return null;
    }
} 
```

# android - 如何处理 ImageView 上的向下滑动手势

> ID：15770887
> 
> 赞同：1
> 
> 时间：2013-04-02T17:53:56.530
> 
> 标签：android, gesture

我正在尝试识别图像视图上的向下滑动手势。我试过`GestureDetector`了，但现在不推荐使用了。我正在使用的示例代码如下。但是，它不会进入 onFling() 方法。

```
GestureDetector gestureDetector;
gestureDetector = new GestureDetector(new GestureListener());

        view.findViewById(R.id.imageView).setOnTouchListener(new OnTouchListener() {
            public boolean onTouch(View v, MotionEvent event) {
                if (gestureDetector.onTouchEvent(event)) {
                    System.out.println("DONE-------");
                    updateSwipeAction();
                    return true;
               }
                return false;
            }
        });

class GestureListener extends SimpleOnGestureListener {

        private static final int SWIPE_MIN_DISTANCE = 10;
        private static final int SWIPE_THRESHOLD_VELOCITY = 10;

        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
            if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE) {
                //From Right to Left
                return true;
            } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE) {
                //From Left to Right
                return true;
            }

            if (e1.getY() - e2.getY() > SWIPE_MIN_DISTANCE) {
                //From Bottom to Top
                return true;
            } else if (e2.getY() - e1.getY() > SWIPE_MIN_DISTANCE) {
                //From Top to Bottom
                return true;
            }
            return false;
        }

        @Override
        public boolean onDown(MotionEvent e) {
            //always return true since all gestures always begin with onDown and<br>
            //if this returns false, the framework won't try to pick up onFling for example.
            return true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:02:57.180

试试这个，实现 ongestureListener 并且有一个 onscroll 方法你可以直接访问

> @SuppressLint("NewApi")

```
public class AndroidExplorer extends Activity implements    
     android.view.GestureDetector.OnGestureListener

    {
    private Handler mHandler = new Handler();
    @Override
    protected void onCreate(Bundle mybundle) 
    {
    // TODO Auto-generated method stub  
    super.onCreate(mybundle);
    setContentView(R.layout.main);
    }
    @Override
    public boolean onDown(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        // TODO Auto-generated method stub
        return false;
    }
    @Override
    public void onLongPress(MotionEvent e) {
        // TODO Auto-generated method stub

    }
    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
            float distanceY) {
        // TODO Auto-generated method stub
        return false;
    }
    @Override
    public void onShowPress(MotionEvent e) {
        // TODO Auto-generated method stub

    }
    @Override
    public boolean onSingleTapUp(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }

} 
```

# ajax - jQuery 通过 URL 更改在 ajax 请求上保持全屏模式

> ID：15770892
> 
> 赞同：1
> 
> 时间：2013-04-02T17:54:16.967
> 
> 标签：ajax, jquery, fullscreen

我的项目是用 ajax 开发的，带有 HTML5 URL 历史记录来更改/更新。在页面更改时是否有任何建议保持全屏模式？加载新页面时，浏览器退出全屏模式。我需要避免更新 URL 并且仅在用户退出全屏模式时才这样做？你知道可能是什么问题吗？有什么建议吗？

# asp.net - 如何在使用 PhoneGap 构建的移动应用程序中正确登录用户

> ID：15770894
> 
> 赞同：2
> 
> 时间：2013-04-02T17:54:19.423
> 
> 标签：asp.net, cordova, jquery-mobile

我在 PhoneGap 上构建了一个移动应用程序。我创建了几个静态 HTML 页面（本地存储在手机上）并尝试使用 AJAX 从服务器加载一些数据。

```
$( document ).bind( "mobileinit", function() {
        $.support.cors = true;
        $.mobile.allowCrossDomainPages = true; 
    });

$(document).ready(function () {
    ajaxDeferred = $.ajax({
        url: 'http://example.com/api/isAuthorized'
        type: method,
        data: parameters,
        timeout: 40000
    });

    ajaxDeferred
        .done(function(data) {  

              alert(data.result);     

         })
        .fail(onFailHandler);
}); 
```

在服务器端我有这个代码

```
public ActionResult IsAuthorized()
{
        FormsAuthentication.SetAuthCookie("shade", true);

        return this.Json(
            new
                {
                    result = this.HttpContext.User.Identity.IsAuthenticated
                },
                JsonRequestBehavior.AllowGet
            );
 } 
```

我预计：

*   在第一次运行时收到“假”结果，因为用户未经授权
*   在第二次运行时收到“True”，因为 SetAuthCookie

当我在浏览器中尝试时，它按预期工作。但无论我运行移动应用程序，我总是收到 False，就像 cookie 没有被转移一样。

所以问题是如何使用 AJAX 正确登录用户，这可能吗？什么是最佳做法？由于未知原因，PhoneGap 手册并未涵盖这种简单的场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T16:00:31.443

好的，我找到了答案：

```
$(document).ready(function () {

   ...

}); 
```

不适合。相反，必须使用

```
document.addEventListener(
  "deviceready",
  function() {

     ... at this point cookies are working fine!

  },
  false); 
```

不需要 Access-Control-Allow-Origin 和 Access-Control-Allow-Credentials 标头以及其他跨域技术

# ruby - 如何使用指南针精灵？

> ID：15770897
> 
> 赞同：2
> 
> 时间：2013-04-02T17:54:23.590
> 
> 标签：ruby, sass, compass-sass

我一直在玩 Compass，使用 Scout GUI，现在已经有一天了，精灵让我发疯。

Compass 正在创建精灵，但似乎 CSS 指向了错误的位置。

导入语句如下所示：

```
@import "images/icon/*.png"; 
```

而且，我是这样称呼它的：

```
 h1{

    @include icon-sprite("social"); 
```

在 CSS 中创建的链接是：

```
http://localhost/images/icon-s25f42076dc.png 
```

我希望它是：

```
http://localhost/compass/images/icon-s25f42076dc.png 
```

这是我的 config.rb：

```
http_path = ""
css_dir = "css"
sass_dir = "scss"
images_dir = "images"
relative_assets = true 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T23:07:59.613

将“relative_assets”更改为 false。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-02T18:20:13.720

想通了：导入路径需要是 @import "../compass/images/icon/*.png";

# jquery - Jquery中表中的兄弟姐妹

> ID：15770900
> 
> 赞同：0
> 
> 时间：2013-04-02T17:54:25.783
> 
> 标签：jquery, css, parent, children, siblings

我很难让它发挥作用。

这是我的html布局

```
<td class="subpages-cell">
<span class="subpages-posts-image">
    <a href="">
         <figure class="tint t7">
             <img src="" class="subpages-image">
         </figure>
    </a>
</span>
<p class="subpages-text">
    <a href="">Hello</a>
</p>
</td> 
```

我希望隐藏“子页面文本”类，当使用的鼠标悬停在“子页面图像”类上时，我希望它显示。我使用 css 和 .hove Jquery 尝试了多种方法，但无法找到正确的方法。

截至目前，我使用以下方法修复了它：

```
p.subpages-text { display:none;}

.subpages-cell:hover p.subpages-text a {display:block;} 
```

但由于 td 有一个填充，所以你悬停的区域会延伸到图像上。

这是我的第一篇文章，我试图做尽可能多的研究。如果我违反任何规则，请告诉我。干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:24:59.483

首先，您应该给您`p`的类与其所在的类不同`td`，否则您的 css 规则也会隐藏容器（这也会隐藏其中的所有内容）。

然后，您可以使用 jQuery 找到`p.subpages-text`最接近`img`您悬停的那个。

为此，您可以编写如下内容：

```
$('.subpages-image').hover(
    function(){
        $(this).closest("span").siblings(".subpages-text").show();
    },
    function(){
        $(this).closest("span").siblings(".subpages-text").hide();
    }
); 
```

小提琴：http: [//jsfiddle.net/Aj87N/3/](http://jsfiddle.net/Aj87N/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:17:11.567

让我知道这是否是您正在寻找的

```
$('.subpages-image').hover(
function(){
  $('.subpages-text a').show();
},
function(){
  $('.subpages-text a').hide();
}
); 
```

JS小提琴在这里：http: [//jsfiddle.net/Aj87N/](http://jsfiddle.net/Aj87N/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T18:33:25.397

由于您要与之交互的元素嵌套在您要根据交互显示/隐藏的元素的兄弟元素之下，这不能用 CSS 完成（尽管 JavaScript 是一个选项，当然）；但是，如果您将交互移动到`span`元素的兄弟`p`元素，这是可能的（尽管这不是*您*想要的，我知道）：

```
<table>
    <tbody>
        <tr>
            <td class="subpages-text">
                <span class="subpages-posts-image">
                    <a href="">
                         <figure class="tint t7">
                             <img src="http://lorempixel.com/200/200/nightlife" class="subpages-image" />
                         </figure>
                    </a>
                </span>

                <p class="subpages-text"><a href="">Hello</a>

                </p>
            </td>
        </tr>
    </tbody>
</table> 
```

然后以下 CSS 将起作用：

```
.subpages-text p.subpages-text {
    display: none;
}

.subpages-text:hover span:hover + p.subpages-text {
    display: block;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Pt5y7/1/)。

# php - 检查php中的链接是否损坏

> ID：15770903
> 
> 赞同：18
> 
> 时间：2013-04-02T17:54:29.317
> 
> 标签：php

我想知道是否有任何好的 PHP 脚本（库）来检查链接是否损坏？我在 mysql 表中有指向文档的链接，并且可能只检查链接是否指向文档，或者我是否被重定向到另一个 url。任何的想法？我宁愿用 PHP 来做。

可能与： [检查链接是否有效，如果没有直观地识别为已损坏](https://stackoverflow.com/questions/11168570/check-link-works-and-if-not-visually-identify-it-as-broken)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-02T18:17:18.363

您可以使用此功能检查断开的链接：

```
function check_url($url) {

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    curl_setopt($ch , CURLOPT_RETURNTRANSFER, 1);
    $data = curl_exec($ch);
    $headers = curl_getinfo($ch);
    curl_close($ch);

    return $headers['http_code'];
} 
```

您需要`CURL`安装它才能工作。现在您可以使用以下方法检查损坏的链接：

```
$check_url_status = check_url($url);
if ($check_url_status == '200')
   echo "Link Works";
else
   echo "Broken Link"; 
```

另请检查此链接以获取 HTTP 状态代码：[HTTP 状态代码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

我认为您还可以检查`301`状态`302`代码。

另一种方法是使用`get_headers`function 。但这仅在您的 PHP 版本大于 5 时才有效：

```
function check_url($url) {
   $headers = @get_headers( $url);
   $headers = (is_array($headers)) ? implode( "\n ", $headers) : $headers;

   return (bool)preg_match('#^HTTP/.*\s+[(200|301|302)]+\s#i', $headers);
} 
```

在这种情况下，只需检查输出：

```
if (check_url($url))
   echo "Link Works";
else
   echo "Broken Link"; 
```

希望这可以帮助你:)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-02T18:15:23.613

您可以通过以下几种方式做到这一点：

第一种方式——卷曲

```
function url_exists($url) {
    $ch = @curl_init($url);
    @curl_setopt($ch, CURLOPT_HEADER, TRUE);
    @curl_setopt($ch, CURLOPT_NOBODY, TRUE);
    @curl_setopt($ch, CURLOPT_FOLLOWLOCATION, FALSE);
    @curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
    $status = array();
    preg_match('/HTTP\/.* ([0-9]+) .*/', @curl_exec($ch) , $status);
    return ($status[1] == 200);
} 
```

第二种方式 - 如果你没有安装 curl - 获取标题

```
function url_exists($url) {
    $h = get_headers($url);
    $status = array();
    preg_match('/HTTP\/.* ([0-9]+) .*/', $h[0] , $status);
    return ($status[1] == 200);
} 
```

第三种方式——fopen

```
function url_exists($url){
    $open = @fopen($url,'r');
    if($handle !== false){
       return true;
    }else{
       return false;
    }
} 
```

[第一和第二解决方案](http://www.barattalo.it/2010/01/06/test-if-a-remote-url-exists-with-php-and-curl/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T18:01:46.770

作为快速解决方法检查，您可以将全局变量[$http_response_header](http://www.php.net/manual/es/reserved.variables.httpresponseheader.php)与[file_get_contents()](http://php.net/manual/es/function.file-get-contents.php)函数一起使用。

例如（摘自 PHP 文档）：

```
<?php
function get_contents() {
  file_get_contents("http://example.com");
  var_dump($http_response_header);
}
get_contents();
var_dump($http_response_header); 
```

然后检查第一行的状态代码是否有“HTTP/1.1 200 OK”或其他[HTTP 状态代码](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T18:09:27.070

试试这个：

```
$url = '[your_url]';
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

$result = curl_exec($curl);

if ($result === false) {
    echo 'broken url';
} else {
    $newUrl = curl_getinfo($curl, CURLINFO_EFFECTIVE_URL);

    if ($newUrl !== $url) {
        echo 'redirect to: ' . $newUrl;
    }
}
curl_close($curl); 
```

# json - BigQuery 在导入 JSON 时对缺失字段和未知/额外字段的处理

> ID：15770911
> 
> 赞同：3
> 
> 时间：2013-04-02T17:54:47.440
> 
> 标签：json, google-app-engine, schema, google-bigquery, google-cloud-storage

我的 BigQuery 表的架构如下所示：

```
A:STRING,B:STRING,C:STRING,D:STRING,E:STRING,F:STRING,createdAt:INTEGER,updatedAt:INTEGER,I:STRING 
```

云存储中的文件 (JSON) 有一个项目，它看起来像：

```
{
    "A": "AAA",
    "B": "BBB",
    "E": "EEEEE",
    "F": "FFFFF",
    "createdAt": 1364226047214,
    "XXXX": "XXXXXXXXXXX",
    "I": "IIIIII",
    "YYYY": {
        "Y1": 1.99,
        "Y2": "YYYYYY"
    },
    "location": {
        "city": "Amherst",
        "region": "NS",
        "country": "CA"
    },
    "purchaseDate": 1364225968000,
    "updatedAt": 1364226052634
} 
```

我收到以下错误：

```
Errors:
Line:1 / Column:173, The field "createdAt" was not found on the current message.
Too many errors encountered. Limit is: 0. 
```

与上述错误相关的两个问题：

1.  BigQuery 如何处理数据中的缺失字段？默认情况下不是所有字段都可以为空吗？

2.  BigQuery 如何处理数据中的未知/额外字段？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T15:17:18.037

我刚刚使用[webUI](https://bigquery.cloud.google.com/)测试了您的架构/数据并收到以下错误：

```
Line:1 / Column:84, The field "XXXX" was not found on the current message.
Too many errors encountered. Limit is: 0. 
```

1.  是的，默认情况下字段可以为**空**。如果要更改字段模式，则需要显式定义字段模式（可为空、必需或重复）。如果您的 JSON 数据中缺少必填字段，您将收到错误消息，但如果该字段可以为空，它将起作用。

2.  正如您在“XXXX”字段中看到的错误，如果您的数据包含额外的字段，它将失败。**您的数据必须与**[文档](https://developers.google.com/bigquery/docs/tables#addmoredata)中描述的表架构匹配，并且您不能修改[不可变](https://developers.google.com/bigquery/articles/ingestionbestpractices#immutable)的表架构（如果您需要使用另一个表添加字段，可以[在此处](https://developers.google.com/bigquery/docs/tables#addmoredata)找到一些信息）

3.  对处理 JSON 数据的人可能有用的另一件事是，**每个数据行必须包含在**文件中的一行中（如在[google 示例文件](https://developers.google.com/bigquery/docs/personsData.json)中）。如果你的 json 数据格式很漂亮，数据导入会失败。

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-16T14:38:15.023

本周我遇到了这个问题，最近几天我一直在查看代码，问题是 BQ TableRow 没有在 Big Query TableSchema 上定义的所有元素。

请重新检查您在 TableRow 上添加的所有参数，并确保该参数在 TableSchema 上正确表示。

祝你好运！

# code-coverage - 有没有办法将 Cobertura XML 转换为 HTML 报告？

> ID：15770918
> 
> 赞同：14
> 
> 时间：2013-04-02T17:55:05.160
> 
> 标签：code-coverage, cobertura

我有一个在测试中生成的 XML 文件。有没有办法将它转换为 ala Jenkins 的 HTML 报告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-06-21T20:32:39.723

[pycobertura](https://pypi.org/project/pycobertura/)可以`coverage.xml`将其转换为外观合理的 HTML。我现在正在将它与一些 Erlang 源代码一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T16:15:20.497

如果你使用 Ant，你可以使用（注意 'format=" **html** "'）：

```
<cob:cobertura-report format="html" datafile="${cobertura.ser.file}" destdir="${todir}">
     <fileset dir="${srcdir}" includes="**/*.java"/>
</cob:cobertura-report> 
```

使用 maven pom，请参阅：[手册](http://mojo.codehaus.org/cobertura-maven-plugin/examples/report-formats.html)，例如：

```
<plugin>
   <groupId>org.codehaus.mojo</groupId>
   <artifactId>cobertura-maven-plugin</artifactId>
   <configuration>
     <formats>
       <format>html</format>
       <!-- format>xml</format -->
     </formats>
   </configuration>
</plugin> 
```

使用命令行脚本，也请参阅[手册](https://github.com/cobertura/cobertura/wiki/Command-Line-Reference#reporting)，例如：

```
cobertura-report.bat --format html --datafile C:\MyProject\build\cobertura.ser --destination C:\MyProject\reports\coverage C:\MyProject\src 
```

# jquery - JQuery - 使用通配符查找类

> ID：15770921
> 
> 赞同：3
> 
> 时间：2013-04-02T17:55:20.240
> 
> 标签：jquery, jquery-selectors

我的页面中有多个类，例如：

```
<input class="someclass1 condition[operator]" type="text">
<input class="someclass2 condition[value]" type="text">
<input class="condition[percentage]" type="text"> 
```

我想使用 jquery 基本上循环，`find("some_selector_i_need").each()`但我不知道如何使用通配符来做到这一点。

这甚至可能吗？像`find("condition[*]").each()`我可以拉出的东西`*`是什么？

我最终想格式化一个数组，如：

```
Array
(
  operator => 'value1',
  value => 'value2',
  percentage => 'value3'
) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T17:58:01.893

```
var obj = {};

$('[class*="condition"]').each(function(i,ele) {
    var type = ele.className.match(/\[(.*?)\]/)[1];
    obj[type] = 'value' + (i+1);
}); 
```

[**小提琴**](http://jsfiddle.net/G89jx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T17:57:27.407

```
.find("[class*=condition]").each() 
```

# asp.net-mvc-4 - 数据库中未添加的新字段 代码优先

> ID：15770924
> 
> 赞同：1
> 
> 时间：2013-04-02T17:55:25.520
> 
> 标签：asp.net-mvc-4, entity-framework-5, entity-framework-migrations

我正在关注[本](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties)`SimpleMembershipProvider`教程，该教程是关于使用 userprofile 表中的自定义字段移动到您自己的数据库。我在代码中添加了一些新字段：

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public string Mobile { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

然后我运行 Add-Migration 命令。它会生成一个如下所示的######.cs 文件：

```
namespace MVC4SimpleMembershipCodeFirstSeedingEF5.Migrations
{
    using System;
    using System.Data.Entity.Migrations;

    public partial class test : DbMigration
    {
        public override void Up()
        {
        }

        public override void Down()
        {
        }
    }
} 
```

up() 和 Down() 方法的主体是空的。不知何故，它没有检测到我所做的新更改（添加了 FirstName 和 LastName 字段）。

我在这里想念什么？

**编辑：**

我将相同的字段添加到我创建的另一个表中，并且该表确实在数据库中得到了更新。

这是 Add-Migration 产生的：

```
namespace MVC4SimpleMembershipCodeFirstSeedingEF5.Migrations
{
    using System;
    using System.Data.Entity.Migrations;

    public partial class test : DbMigration
    {
        public override void Up()
        {
            AddColumn("dbo.TestTabel", "FirstName", c => c.String());
            AddColumn("dbo.TestTabel", "LastName", c => c.String());
        }

        public override void Down()
        {
            DropColumn("dbo.TestTabel", "LastName");
            DropColumn("dbo.TestTabel", "FirstName");
        }
    }
} 
```

所以问题已经缩小到 userprofile 表。这张桌子有什么特别之处，无法更改？

# sql-server-2008-r2 - SQL Server Column 将 FileName 保存为 varchar 需要从字符串中删除目录

> ID：15770926
> 
> 赞同：0
> 
> 时间：2013-04-02T17:55:29.660
> 
> 标签：sql-server-2008-r2, sql-update

我的表中有一个名为 FileName 的列，没有意识到我所做的是我还保存了目录，例如一个值是 \test-srv-1\Uploads\Test.jpg 我想运行一个更新语句来删除目录并留下Test.jpg。我有 1000 行要更新。有没有使用更新语句在 SQL Server 中执行此操作的简单方法？现在服务器正在更改，这将成为维护的噩梦。啊，我希望我很久以前就抓住了这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:06:36.933

这种事情很容易使用[REVERSE](http://msdn.microsoft.com/en-us/library/ms180040.aspx)。

您可以执行以下操作来测试重命名的外观：

```
select right(MyColumn, charindex('\', reverse(MyColumn)) - 1)
from MyTable
where charindex(MyColumn, '\') > 0 
```

如果您对输出感到满意，请执行以下操作：

```
update MyTable
set MyColumn = right(MyColumn, charindex('\', reverse(MyColumn)) - 1)
where charindex(MyColumn, '\') > 0 
```

# exchangewebservices - ServiceId.UniqueId 最大长度和格式

> ID：15770929
> 
> 赞同：8
> 
> 时间：2013-04-02T17:55:40.633
> 
> 标签：exchangewebservices, ews-managed-api

Exchange Web Services (EWS) Managed API 中的每个[`Item`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item%28v=exchg.80%29.aspx)（例如）都有一个类型为 的属性，然后它有一个名为（继承自——呸，明白了吗？）的属性。[`Task`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task%28v=exchg.80%29.aspx)`Id`[`ItemId`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemid%28v=exchg.80%29.aspx)`String`[`UniqueId`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.serviceid.uniqueid%28v=exchg.80%29.aspx)[`ServiceId`](http://msdn.microsoft.com/en-us/library/dd635957%28v=exchg.80%29.aspx)

我打算将值保留`UniqueId`在数据库中，所以我需要知道列的最大长度应该是多少。一些测试表明它的长度至少为`152`字节，但这似乎是一个奇怪的最大值。

这个问题的第二部分是值的格式。这是否可以解析为更常见的类型，例如 a [`Guid`](http://msdn.microsoft.com/en-us/library/system.guid.aspx)？我知道，我正抓着稻草。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-25T22:36:32.237

为了安全起见，我们建议为 EWS 标识符[留出 512 个字符](http://blogs.msdn.com/b/exchangedev/archive/2012/04/03/ews-item-identifier-and-your-database.aspx)。虽然我预计它不会被延长到接近 512 个字符，但 Microsoft 保留更改格式的权利。我非常怀疑 Exchange 在这一点上会改变格式。

关于标识符的格式——它是不透明的，因此它既不应该被解析也不应该被重构。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-14T06:16:34.693

来自[Exchange 中的 EWS 标识符](https://msdn.microsoft.com/en-us/library/office/dn605828(v=exchg.150).aspx#bk_WorkingWithIdentifiers)：

*   文件夹和项目的 ItemID 元素值区分大小写。如果您查看 FindItem 操作（或 FindItems EWS 托管 API 方法）返回的文件夹或项目的项目 ID，您可能会认为它与另一个项目 ID 重复；但是，两个项目的项目 ID 中的一个或多个字符将有不同的大小写。
*   如果您要将项目 ID 存储在数据库中以供以后检索，我们建议字段大小为 512 字节，这样它就足以容纳 GUID。
*   如果您以后需要取回物品，请不要假设您的 ID 始终有效。如果商品在商店中移动，则 ID 可能会因处理移动的方式而改变。实际复制一个item，生成一个新的id，然后删除原来的item。

# node.js - Node.js 版本不正确？

> ID：15770932
> 
> 赞同：-2
> 
> 时间：2013-04-02T17:55:49.633
> 
> 标签：node.js

我刚刚通过他们的网站下载了 node.js，发现我在本地机器上的版本已经过时了（v5.11pre）。所以，看到有一个 10.2 版本，我决定从我的机器上完全卸载 node.js 并重新安装最新最好的版本！

在完成安装所有内容的步骤后，我运行了以下命令并发现了一些奇怪的东西：

```
$ node --version
v0.5.11-pre 
```

有人可以解释为什么 node 10.2 的 tarball 刚刚安装了一个非常旧的 node 版本吗？另外，我怎样才能获得最新版本！？

编辑：

如果有帮助，我正在使用 Ubuntu 12.04。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T17:59:07.910

我猜确实安装了正确的版本，但是您的路径仍然指向旧安装。

# android - 如何以编程方式更改 ActionBar 中微调器中的项目

> ID：15770933
> 
> 赞同：3
> 
> 时间：2013-04-02T17:55:50.490
> 
> 标签：android, spinner

我的 ActionBarSherlock 中有一个微调器，里面有 5 个元素。通过单击屏幕底部的两个按钮之一（见图），我想更改`item id`.`spinner`

![在此处输入图像描述](https://i.stack.imgur.com/U7oyi.png)

这是相关代码：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
/* ... some code ...*/
Context context = getSupportActionBar().getThemedContext();
ArrayAdapter<CharSequence> list = ArrayAdapter.createFromResource(context, R.array.arr_contents, R.layout.sherlock_spinner_item);
list.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);
    getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    getSupportActionBar().setListNavigationCallbacks(list, this);

    getSupportActionBar().setDisplayShowHomeEnabled(false);
    getSupportActionBar().setTitle(title);
/*... some other code ...*/
}

@Override
public boolean onNavigationItemSelected(int itemPosition, long itemId) {

    switch(itemPosition) {
        case 0:
            // Do stuff
            break;
        case 1:
            // Do stuff
            break;
        case 2:
            // Do stuff
            break;
        case 3:
            // Do stuff
            break;
        case 4:
            // Do stuff
            break;
        default:
            // Do stuff
            break;
    }
    return true;
} 
```

例如，我尝试调用`onNavigationItemSelected(3, R.array.arr_contents);`以移动到微调器的第三个元素，但它不起作用。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T18:02:13.700

不确定但可能：

```
getSupportActionBar().setSelectedNavigationItem(itemPosition); 
```

[文档](http://developer.android.com/reference/android/app/ActionBar.html#setSelectedNavigationItem%28int%29)

# c# - MVC4 ActionLink 不传递参数

> ID：15770936
> 
> 赞同：0
> 
> 时间：2013-04-02T17:55:54.253
> 
> 标签：c#, asp.net-mvc-4

第一个 MVC4 项目，我已经达到了缓冲区...

我希望能够引用我的网站页面；

菜单/子菜单/文档/ID

如果 ID 值是可选的，并且最后标记了任何其他内容，模型将处理文档部分，该部分将作为文本，例如，

HOME/欢迎光临/欢迎光临本店

所以我设置了一条路线（只有一条路线）

```
routes.MapRoute(
    name: "Default",
    url: "{menu}/{submenu}/{document}/{id}",
    defaults: new {
        controller = "Page", 
        action= "Data", 
        menu = "",
        submenu = "",
        document = "", 
        id = ""} 
```

我有一个控制器；

```
public class PageController : Controller
{

    // Default view option for documents

    public ActionResult Data(string menu, string submenu, string document, string parameters)
    {

        // Set the View to use rather than it default;
        string thisView = "Data";

        return View(thisView);
    }

} 
```

我们有一个引用 _MenuPartial.cshtml 文件的 _Layout.cshtml 文件

```
@model MyNameSpace.Models.PageModel
<ul>
    @foreach (var item in Model.Menus.MainMenu)
    {
        <li>@Html.ActionLink(item.Label, "Page", "Data", new
           {
               menu = "MENU",
               submenu = "SUBMENU"
           },
           null
           )
        </li>
    }
</ul> 
```

以上所有内容都使用正确的文本等动态地写出我的主菜单。

但是，当我单击一个标签时，路由似乎很高兴地映射到 PageControllers Data 函数，但字符串菜单、字符串子菜单、字符串文档、字符串参数的值为“”或 null。

如果我修改 URL，那么它们会正确传递。

我确信这只是对我应该做的事情的误解，我希望一旦有好心人发现它，我就会离开并逃跑！

谢谢安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T09:00:52.687

尝试`UrlParameter.Optional`在路由中为文档和 ID 提供默认值，并在操作中为文档和 ID 参数提供默认值 "" ( `string document = ""`)。这应该允许路由将操作链接路由数据与路由相协调。

# ruby-on-rails - 文档大小无效。它不应大于 100KB

> ID：15770937
> 
> 赞同：0
> 
> 时间：2013-04-02T17:56:03.727
> 
> 标签：ruby-on-rails, indextank, searchify

我在 Heroku 上使用 Searchify 和 Tanker 作为我的宝石。当我尝试在某些模型上运行重新索引时，我得到一个无效的文档大小错误。我试图改变批量大小，但没有运气。

```
Model.tanker_reindex(:batch_size => 1000) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:18:22.170

所有文本字段的总大小必须小于 100KB。编制索引时，只需验证您的文档是否在此限制范围内。

使用 Tanker gem 时，它会使大多数文档的大小翻倍，因为它将文本字段复制到一个名为 __any 的字段中（它可能提供一种自定义和覆盖此行为的方法）。您还可以使用直接的 Ruby IndexTank 客户端，它可以让您更好地控制索引（但不会自动执行那么多操作）：

[http://www.searchify.com/documentation/ruby-client](http://www.searchify.com/documentation/ruby-client)

[https://github.com/flaptor/indextank-rb](https://github.com/flaptor/indextank-rb)

# jquery - jQuery检测调整大小浏览器和tabSlideOut插件

> ID：15770941
> 
> 赞同：0
> 
> 时间：2013-04-02T17:56:13.790
> 
> 标签：jquery, window-resize, tabslideout

我正在使用 tabSlideOut 插件 ( [http://www.building58.com/examples/tabSlideOut.html](http://www.building58.com/examples/tabSlideOut.html) )，除了我调整浏览器大小时，它的效果很好。该代码基本上检查文档准备好的浏览器大小和浏览器调整大小以确定是否应显示选项卡。但是，在调整大小时，选项卡无法正常工作，并且在单击时会多次滑入和滑出。有人可以帮忙吗？

```
function doMenu() {

    var width = $(window).width();

    if (width < 530) {

     $('.slide-out-div').tabSlideOut({
         tabHandle: '.handle',
         pathToTabImage: null,
         imageHeight: null,
         imageWidth: null,
         tabLocation: 'right',
         speed: 300,
         action: 'click',
         topPos: '0',
         leftPos: '20px',
         fixedPosition: false,
         toogleHandle: false
     });
   }

}
$(document).ready(doMenu);
$(window).resize(doMenu); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:22:03.680

您可能`tabSlideOut`多次初始化插件 - 每次调整浏览器窗口大小时，它都会添加一个`click`运行滑动动画的新处理程序。尝试类似：

```
var menuInitialized = false;
var handle = null;
function doMenu() {
    if(handle === null) {
        handle = $(".handle");
    }
    var width = $(window).width();
    if (width < 530) {
        if(!menuInitialized) {
            //only call $.tabSlideOut once
            menuInitialized = true;
            $('.slide-out-div').tabSlideOut({
                tabHandle: '.handle',
                pathToTabImage: null,
                imageHeight: null,
                imageWidth: null,
                tabLocation: 'right',
                speed: 300,
                action: 'click',
                topPos: '0',
                leftPos: '20px',
                fixedPosition: false,
                toogleHandle: false
            });
        }
        handle.show();
   } else {
        handle.hide();
   }
}
$(document).ready(doMenu);
$(window).resize(doMenu); 
```

# javascript - 用于验证表单并显示 css 加载屏幕的 Javascript 函数

> ID：15770943
> 
> 赞同：0
> 
> 时间：2013-04-02T17:56:16.450
> 
> 标签：javascript, css, forms, validation, loading

我是一个 javascript 新手，我正在尝试组合两段单独工作但不一起工作的代码：

1.  验证我的表单以检查长度、宽度和高度是否非零
2.  如果表单有效，则提交表单并在内容加载时显示 css 初始加载屏幕

这是我不成功的尝试：

```
<script type = "text/javascript">

function notEmpty(elem, helperMsg){
    if (elem.value.length == 0) {
        alert(helperMsg);
        elem.focus(); // set the focus to this input
        return false;
    }
    return true;
}

function show() {
    if ((notEmpty(document.getElementById('length'), 'Please Enter a Length')==true) &&
        (notEmpty(document.getElementById('height'), 'Please Enter a Height')==true) &&
        (notEmpty(document.getElementById('weight'), 'Please Enter a Weight')==true)) {
        document.getElementById("myDiv").style.display="block";
        setTimeout("hide()", 10000);  // 10 seconds
    }
}
function hide() {
    document.getElementById("myDiv").style.display="none";
}
</script> 
```

我的表单将调用`show()`表单提交。myDiv 是一个 CSS 加载页面元素，在页面加载时出现。再次，如果我的尝试失败了，我深表歉意，我对 javascript 很陌生，如果有任何建议可以为我指明正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T18:09:24.790

以下是一个可行的解决方案（可能不是最好的或理想的），它也应该适用于您。尝试将该功能附加到提交按钮。使其键入“按钮”将“显示”附加到其单击事件并稍微修改“显示”方法，如下所示。希望这可以帮助：

```
<html>
<head>
<script type = "text/javascript">

function notEmpty(elem, helperMsg){
    if (elem.value.length == 0) {
        alert(helperMsg);
        elem.focus(); // set the focus to this input
        return false;
    }
    return true;
}

function show() {
    if ((notEmpty(document.getElementById('length'), 'Please Enter a Length')==true) &&
        (notEmpty(document.getElementById('height'), 'Please Enter a Height')==true) &&
        (notEmpty(document.getElementById('weight'), 'Please Enter a Weight')==true)) {
        document.getElementById("myDiv").style.display="block";
        setTimeout("hide()", 10000);  // 10 seconds
        document.getElementById("myform").submit();
    }
}
function hide() {
    document.getElementById("myDiv").style.display="none";
}
</script>
</head>
<body>
<form id="myform" action="someAction" onSubmit="show()">
    <input type="text" id="length"/>
    <input type="text" id="height"/>
    <input type="text" id="weight"/>
    <input type="button" value="submit" id="mySubmitBtn" onClick="show()"/>
</form>
<div id="myDiv"></div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:24:52.967

在 HTML 表单中添加`onClick="validate(event)"`提交按钮：

```
<form action="someAction">
    <input type="text" id="length"/><br/>
    <input type="text" id="height"/><br/>
    <input type="text" id="weight"/><br/>
    <input type="submit" onClick="validate(event)"/>
</form>
<div id="myDiv" style="display: none">Loading....</div> 
```

然后试试这个代码：

```
function validate(e) {
    (e.preventDefault) ? e.preventDefault() : e.returnValue = false;//stop the form from submitting before validating
    var arr = ['length', 'height', 'weight'],
        valid = true,
        helperMsg = ['please choose length value', 'please choose height value', 'please choose weight vale'];
    for (var i in arr) {
        var elm = document.getElementById(arr[i]);
        if (elm.value.length == 0) {
            alert(helperMsg[i]);
            elm.focus();
            valid = false;            
            break;//stop looping and move to the next step
        }
    }
    if (valid) {
        var div = document.getElementById('myDiv');
        document.getElementsByTagName('form')[0].submit();//submit the first form, or you can change it to document.getElementBY('id') instead if you add an id to your form which would be better.
        div.style.display = 'block';//show div
        setTimeout(function () {
            div.style.display = 'none';//hide div after 10 sec
        }, 10000);
    }

} 
```

[演示](http://jsfiddle.net/arcm111/thPX5/)

# java - 有没有办法使用创建 JOptionPane 的字符串的方法？（爪哇）

> ID：15770947
> 
> 赞同：2
> 
> 时间：2013-04-02T17:56:31.253
> 
> 标签：java, identifier

我已经用谷歌搜索了神圣的 bejaysus ，但找不到正确的单词组合。如何在没有标识符的东西上使用方法？例如;

```
String inputBio = JOptionPane.showInputDialog(null, heroPane, "Please enter details...", JOptionPane.OK_CANCEL_OPTION); 
```

我如何引用该对话框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:14:02.560

所以你想把输入框中输入的值赋给String？您需要创建一个 Integer 并将其分配给 JOptionPane.showInputDialog，然后使用构造函数来实例化具有所需选项的 Input Dialog 的新实例。

现在，要提取数据，添加一个 IF 语句并检查呈现给用户的可能选项。如果您添加了 JoptionPane.OK_CANCEL_OPTION，那么您有两个选项：OK 和 CANCEL。IF 语句应该是：如果用户选择 OK，提取字符串，ELSE 做任何你想做的事情。

该字符串应从创建的文本字段中提取（我假设它位于“heroPane”中的某处）

这是代码中的样子

```
//the string we use for input
String inputBio;

int optionBox = JOptionPane.showInputDialog(null, heroPane, "Please enter details...", JOptionPane.OK_CANCEL_OPTION);
//now the integer value represents the option selected (OK or CANCEL)
//All we need to do is extract the data and assign it to the string

if (optionBox == JOptionPane.OK_OPTION) {
//the OK option
inputBio = nameOfYourTextField.getText();

} else {
// we have a CANCEL option
} 
```

当然，您可以在没有 IF 语句的情况下执行此操作，但请确保您相应地处理所有选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:11:22.453

如果您需要对 的引用`JOptionPane`，则不能使用`showInputDialog`便捷方法。您将需要构造一个`JOptionPane`对象。

# foreign-keys - xml 模式中的主键和外键

> ID：15770948
> 
> 赞同：8
> 
> 时间：2013-04-02T17:56:34.747
> 
> 标签：foreign-keys, xsd, primary-key

我正在尝试在下面的 XSD 模式文件中插入主键和外键：-

主键是 StudentID，外键是 courseID、AddressID、GradeID。

```
<?xml version="1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="Student">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="Title" type="xs:string"/>
      <xs:element name="FirstName" type="xs:string"/>
      <xs:element name="LastName" type="xs:string"/>
      <xs:element name="Dateborn"  type="xs:date"/>
      <xs:element name="Gender"  type="xs:string"/>
    </xs:sequence>
  </xs:complexType>
</xs:element>
</xs:schema> 
```

但是上面的代码在我的设置中不起作用，请帮助我追踪问题，

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-03T13:50:31.807

一般来说，您需要在问题中添加更多细节......所以这应该足以理解您可能需要定义的其他内容以及如何定义。我将通过说明假定的学生/地址关系来解决理解如何定义主键/外键所需的内容。

首先，您需要定义这些约束成立的上下文。在我修改后的 XSD 中，我称它为“世界”。

```
<?xml version="1.0" encoding="utf-8" ?>
<!-- XML Schema generated by QTAssistant/XSD Module (http://www.paschidev.com) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="World">
        <xs:complexType>
            <xs:sequence>
                <xs:element ref="Student" maxOccurs="unbounded"/>   
                <xs:element ref="Address" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>          
        </xs:complexType>
        <xs:key name="PKStudents">
            <xs:selector xpath="Student/StudentID"/>
            <xs:field xpath="."/>
        </xs:key>
        <xs:key name="PKAddresses">
            <xs:selector xpath="Address/AddressID"/>
            <xs:field xpath="."/>
        </xs:key>
        <xs:keyref name="FKStudentToAddress" refer="PKAddresses">
            <xs:selector xpath="Student/AddressID"/>
            <xs:field xpath="."/>
        </xs:keyref>
    </xs:element>
    <xs:element name="Student">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="Title" type="xs:string"/>
                <xs:element name="FirstName" type="xs:string"/>
                <xs:element name="LastName" type="xs:string"/>
                <xs:element name="Dateborn" type="xs:date"/>
                <xs:element name="Gender" type="xs:string"/>
                <xs:element name="StudentID" type="xs:string"/>
                <xs:element name="AddressID" type="xs:string" minOccurs="0"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
    <xs:element name="Address">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="AddressID" type="xs:string"/>
                <xs:element name="Street" type="xs:string"/>
                <xs:element name="City" type="xs:string"/>
                <xs:element name="Province" type="xs:string" minOccurs="0"/>
                <xs:element name="Country" type="xs:date" minOccurs="0"/>
                <xs:element name="PostalCode" type="xs:string" minOccurs="0"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

然后像这样的 XML 将通过或失败，这取决于您对 StudentID 和 AddressID 字段中的值执行的操作。

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!-- Sample XML generated by QTAssistant (http://www.paschidev.com) -->
<World xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <Student>
        <Title>Title1</Title>
        <FirstName>FirstName1</FirstName>
        <LastName>LastName1</LastName>
        <Dateborn>1900-01-01</Dateborn>
        <Gender>Gender1</Gender>
        <StudentID>StudentID1</StudentID>
        <AddressID>AddressID1</AddressID>
    </Student>
    <Student>
        <Title>Title1</Title>
        <FirstName>FirstName1</FirstName>
        <LastName>LastName1</LastName>
        <Dateborn>1900-01-01</Dateborn>
        <Gender>Gender1</Gender>
        <StudentID>StudentID2</StudentID>
        <AddressID>AddressID1</AddressID>
    </Student>
    <Address>
        <AddressID>AddressID1</AddressID>
        <Street>Street1</Street>
        <City>City1</City>
        <Province>Province1</Province>
        <Country>1900-01-01</Country>
        <PostalCode>PostalCode1</PostalCode>
    </Address>
    <Address>
        <AddressID>AddressID2</AddressID>
        <Street>Street1</Street>
        <City>City1</City>
        <Province>Province1</Province>
        <Country>1900-01-01</Country>
        <PostalCode>PostalCode1</PostalCode>
    </Address>
</World> 
```

要完成您的解决方案，您需要在“世界”中定义**课程**和**成绩**`xs:key`“实体”，为每个实体定义类似于**Student** /* *Address* *，然后将*CourseID*和*GradeID*属性添加到需要它们的实体中，以及最后，如上所述，为**Entity** to **Grade**和**Entity** to **Course**定义 keyref 。

# c# - 使用 OpenXML 创建 PowerPoint 演示文稿时损坏的 PPTX 文件

> ID：15770958
> 
> 赞同：1
> 
> 时间：2013-04-02T17:57:01.530
> 
> 标签：c#, powerpoint, openxml

******重要：代码块后回答的问题******

 ****平台：** C#、OpenXML SDK (2.5)、.NET 4.0

**我想要达到的目标**

我一直在尝试从来自我的数据库的一些数据和图像生成一个 pptx 演示文稿。任何生成的文件都会损坏，但它确实通过了 OOXML 验证。我真的不知道我还能做什么。

**我已经尝试过的**

我试图删除图像、文本，然后我评论了删除第一张（模板）幻灯片的代码，但没有改变我的最终结果：文件损坏。

**错误**

当我尝试打开文件时：“PowerPoint 无法显示文件“filename.pptx”中幻灯片上的某些文本、图像或对象，因为它们已损坏。受影响的幻灯片已被替换为空白幻灯片演示文稿，并且无法恢复丢失的信息。为确保文件可以在早期版本的 PowerPoint 中打开，请使用“另存为”命令（“文件”菜单）并使用相同或新名称保存文件。

**代码**

这是我用来生成 PPTX 的代码：

```
void GenerateSlides(string fullPath, string path, IEnumerable<Data> data)
    {
        var slidePath = fullPath;

        if (!Directory.Exists(path))
            Directory.CreateDirectory(path);

        // Copy the template file to generate new slides
        File.Copy(string.Format("{0}{1}", path, "TemplateTF.pptx"), slidePath, true);

        using (var presentationDocument = PresentationDocument.Open(slidePath, true))
        {
            var presentationPart = presentationDocument.PresentationPart;
            var slideTemplate = (SlidePart)presentationPart.GetPartById("rId2");

            // Recover the data to fullfill the slidepart
            int i = 1;

            foreach (var singleData in data)
            {
                (...)

                // Creates the new image
                var newSlide = CloneSlidePart(presentationPart, slideTemplate);
                var imgId = "rIdImg" + i;
                var imagePart = newSlide.AddImagePart(ImagePartType.Jpeg, imgId);
                var stream = new MemoryStream();
                using (var file = File.Open(string.Format("{0}{1}"
                    , WebConfigurationManager.AppSettings["pathImages"]
                    , singleData.ImageName), FileMode.Open))
                {
                    var buffer = new byte[file.Length];
                    file.Read(buffer, 0, (int)file.Length);
                    stream.Write(buffer, 0, buffer.Length);
                    imagePart.FeedData(new MemoryStream(buffer));
                }
                // Important method to swap the original image
                SwapPhoto(newSlide, imgId);
                i++;

                InsertContent(newSlide, (...));
                SwapPhoto(newSlide, imgId);
                newSlide.Slide.Save();
            }

            DeleteTemplateSlide(presentationPart, slideTemplate);
            presentationPart.Presentation.Save();
        }
    }

void SwapPhoto(SlidePart slidePart, string imgId)
    {
        var blip = slidePart.Slide.Descendants<Drawing.Blip>().First();
        blip.Embed = imgId;
        slidePart.Slide.Save();
    }

void DeleteTemplateSlide(PresentationPart presentationPart, SlidePart slideTemplate)
    {
        var slideIdList = presentationPart.Presentation.SlideIdList;
        foreach (SlideId slideId in slideIdList.ChildElements)
        {
            if (slideId.RelationshipId.Value.Equals("rId2"))
            {
                slideIdList.RemoveChild(slideId);
            }
        }
        presentationPart.DeletePart(slideTemplate);
    }

SlidePart CloneSlidePart(PresentationPart presentationPart, SlidePart slideTemplate)
    {
        var newSlidePart = presentationPart.AddNewPart<SlidePart>("newSlide" + i);
        i++;
        newSlidePart.FeedData(slideTemplate.GetStream(FileMode.Open));
        newSlidePart.AddPart(slideTemplate.SlideLayoutPart);

        var slideIdList = presentationPart.Presentation.SlideIdList;

        uint maxSlideId = 1;
        SlideId prevSlideId = null;
        foreach (SlideId slideId in slideIdList.ChildElements)
        {
            if (slideId.Id > maxSlideId)
            {
                maxSlideId = slideId.Id;
                prevSlideId = slideId;
            }
        }
        maxSlideId++;

        var newSlideId = slideIdList.InsertAfter(new SlideId(), prevSlideId);
        newSlideId.Id = maxSlideId;
        newSlideId.RelationshipId = presentationPart.GetIdOfPart(newSlidePart);

        return newSlidePart;
    }

void InsertContent(SlidePart slidePart, (...))
    {
        SwapPlaceholderText(slidePart, "Title", "ReplacementString1");
        SwapPlaceholderText(slidePart, "Text", "ReplacementString2");
    }

    void SwapPlaceholderText(SlidePart slidePart, string placeholder, string value)
    {
        var textList = slidePart.Slide.Descendants<Drawing.Text>().Where(
           t => t.Text.Equals(placeholder)).ToList();

        foreach (Drawing.Text text in textList)
        {
            text.Text = value;
        }
    } 
```

**回答**

好的，我意识到 MS Office 版本可以有多么不同。

**a)**如果我尝试使用 Office 2013 打开 .pptx 文件：错误消息 + 完美打开，没有徽标图像或幻灯片部分显示任何附加信息

**b)**如果我尝试使用 Office 2007 打开 .pptx 文件：错误消息 + 空白幻灯片，根本没有信息

**c)**如果我尝试使用 Office 2010 打开 .pptx 文件：错误消息 + 空白幻灯片和我可能拥有的最重要信息：徽标位置的图标损坏！！！

我从模板中删除了徽标图像，瞧，文件已完美生成。现在，如果我真的需要添加徽标图像，我可以以编程方式完成。

谢谢！一周后试图了解到底发生了什么，我的一个好朋友使用 Office 2010 打开了该文件，然后我确实意识到我的原始模板文件中的徽标图像已损坏。

**谢谢 ：）**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T17:17:02.940

好的，我意识到 MS Office 版本可以有多么不同。

a) 如果我尝试使用 Office 2013 打开 .pptx 文件：错误消息 + 完美打开，没有徽标图像或幻灯片部分显示任何附加信息 b) 如果我尝试使用 Office 2007 打开 .pptx 文件：错误消息 + 空白幻灯片, 没有任何信息 c) 如果我尝试使用 Office 2010 打开 .pptx 文件：错误消息 + 空白幻灯片和我可能拥有的最重要的信息：徽标位置的图标损坏！！！

我从模板中删除了徽标图像，瞧，文件已完美生成。现在，如果我真的需要添加徽标图像，我可以以编程方式完成。

谢谢！一周后试图了解到底发生了什么，我的一个朋友使用 Office 2010 打开了文件，然后我确实意识到我的原始模板文件中的徽标图像已损坏。**

# android - 如何使用restfb从我在facebook上的新闻源中获取包含某些文本的帖子

> ID：15770959
> 
> 赞同：0
> 
> 时间：2013-04-02T17:57:05.967
> 
> 标签：android, facebook, facebook-graph-api, restfb, android-facebook

嗨，我的任务非常直接：
我想查询我的新闻提要中包含的所有帖子（从过去 24 小时开始），其中包含**“nice”**一词。
我正在使用 restFB 客户端。
我试过这个：（使用 Graph API）

```
Connection<Post> targetedSearch = facebookClient.fetchConnection(
        "me/home?q=facebook", Post.class, Parameter.with("q", "nice"),
        Parameter.with("type", "post")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T14:10:22.320

这是我能找到的最好的答案是从[这里](http://steve.veerman.ca/2012/facebook-api-fql-tutorial/)，正在使用 FQL

```
SELECT post_id, app_id, source_id, updated_time, filter_key, attribution, message, action_links, likes, permalink FROM stream WHERE filter_key ="nf" and strpos(lower(message),lower("nice")) > 0 
```

# jquery - jQuery Sortable 只对句柄进行排序

> ID：15770960
> 
> 赞同：0
> 
> 时间：2013-04-02T17:57:07.713
> 
> 标签：jquery, jquery-ui-sortable, handle

我想拖动一些 div，但只能在 y 轴上。通过使用可拖动它是可能的，但它必须在放置时在其他 div 之间进行排序。所以我选择了可​​排序的。我必须使用句柄 div，但它不起作用。谷歌和这里的所有例子都在工作，除了我的。

你对我有什么提示吗？小提琴：http: [//jsfiddle.net/rQ8wu/](http://jsfiddle.net/rQ8wu/)

JS-Part 是问题所在：

```
$('.block').sortable({
    handle: '.handle',
    axis: 'y',
    containment: 'parent'
}); 
```

**他在做什么**：只移动把手。

**他应该做什么**：移动整个 div（“块”类）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:36:46.730

您正在初始化错误的 div。您需要调用`sortable`包含 div 的`.block`div。

见[http://jsfiddle.net/rVDu2/](http://jsfiddle.net/rVDu2/)

# tsql - 如何在 TSQL 中使用循环？

> ID：15770973
> 
> 赞同：10
> 
> 时间：2013-04-02T17:57:42.623
> 
> 标签：tsql, loops, for-loop, while-loop

在 TSQL 中，我想将以下代码从必须使用硬编码的 dhome 更改为使用循环进行优化。我尝试添加循环失败的尝试也包括在内。

```
Declare  @dhome Tinyint, @bp smallint, @lr smallint, @q smallint

    // Set @dhome = 1
  While(@dhome <= 3) // My attempt to add a loop

  SELECT @lr = MAX(NQdDate), @q = NQd
  FROM NQdHistory
  WHERE dhomeId = @dhome 
  GROUP BY NQdDate, NQd

  SELECT @bd = COUNT(*)
  FROM bdhome
  WHERE NQdDate= @lr AND dhomeID= @dhome 

  DELETE FROM ND1 WITH(XLOCK)
  WHERE dhomeID= @dhome  AND NQdDate= @lr

  UPDATE NQdHistory
  SET Nbd = @q - @@RowCount - @bp, NBd = @bp
  WHERE NQdDate= @lr AND dhomeID= @dhome 

  Set @dhome = @dhome +1 //My attempt to end a loop 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-02T17:59:29.667

你在正确的轨道上。你错过了开始和结束。另外，一定要给出`@dhome`一个值。看起来你已经开始并在你的第三行注释掉了：

```
Declare  @dhome Tinyint, @bp smallint, @lr smallint, @q smallint

    // Set @dhome = 1
While(@dhome <= 3) // My attempt to add a loop
begin
  SELECT @lr = MAX(NQdDate), @q = NQd
  FROM NQdHistory
  WHERE dhomeId = @dhome 
  GROUP BY NQdDate, NQd

  SELECT @bd = COUNT(*)
  FROM bdhome
  WHERE NQdDate= @lr AND dhomeID= @dhome 

  DELETE FROM ND1 WITH(XLOCK)
  WHERE dhomeID= @dhome  AND NQdDate= @lr

  UPDATE NQdHistory
  SET Nbd = @q - @@RowCount - @bp, NBd = @bp
  WHERE NQdDate= @lr AND dhomeID= @dhome 

  Set @dhome = @dhome +1 //My attempt to end a loop
end 
```

如果您熟悉 C/C#/C++，可以将 T-SQL 的 Begin 和 End 想象成花括号`{`和`}`，如果您更熟悉 VB`Then`和`End If`. 或者更像帕斯卡`Begin`和`End`. 你明白了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:59:29.863

在你的时间里错过了开始和结束。

[同时 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms178642.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-01T18:22:39.233

**示例 1**

```
DECLARE @I INT,@COUNTVAR INT
SET @I = 1
DECLARE @Parent_Child TABLE(ID INT IDENTITY(1,1),ParentPositionID INT NULL,ChildPositionId Int)

INSERT INTO @Parent_Child(ParentPositionID,ChildPositionId) 
SELECT DISTINCT PARENT_POSITION_ID,CHILD_POSITION_ID from tblPOSITION_HIERARCHY 
--WHERE CHILD_POSITION_ID IN (--YOUR CONDITION IF ANY)
SELECT @COUNTVAR =COUNT(*) FROM @PTS_Parent_Child
DECLARE @int_SUPE_POSITION_ID INT, @int_CHILD_POSITION_ID INT
 --loop through records here 
WHILE @I <= @COUNTVAR
BEGIN
SELECT @int_SUPE_POSITION_ID=ParentPositionID,@int_CHILD_POSITION_ID=ChildPositionId  FROM @Parent_Child WHERE ID=@I   
--Whatever you want to do with records
SET @I=@I+1
END 
```

**示例 2**

如果您可以使用临时表，这只是另一种方法。我已经亲自测试过了，它不会导致任何异常（即使临时表没有任何数据。）

```
CREATE TABLE #TempTable
    (
      ROWID int identity(1,1) primary key,
      HIERARCHY_ID_TO_UPDATE int,
    )
    --INSERT DATA INTO TEMP TABLE USING INSERT INTO CLAUSE OR FOR EAXMPLE BELOW
    --INSERT INTO #TempTable VALUES(1)
    --INSERT INTO #TempTable VALUES(2)
    --INSERT INTO #TempTable VALUES(4)
    --INSERT INTO #TempTable VALUES(6)
    --INSERT INTO ##TempTable VALUES(8)

    DECLARE @MAXID INT
    SET @COUNTER =1
    SELECT @MAXID=COUNT(*) FROM #TempTable
    --PRINT @MAXID
    WHILE (@MAXID > 0)
    BEGIN
         --DO THE PROCESSING HERE 
         SELECT @HIERARCHY_ID_TO_UPDATE =PT.HIERARCHY_ID_TO_UPDATE FROM      #TempTable  PT WHERE ROWID=@COUNTER
         --PRINT '@MAXID VALUE '
         --PRINT  @MAXID
        SET @MAXID=@MAXID-1
        SET @COUNTER =@COUNTER + 1
    End

    If(OBJECT_ID('tempdb..#TempTable') IS NOT NULL)
    BEGIN
        DROP TABLE #TempTable
    END 
```

# javascript - sql 文件上的 ER_PARSE_ERROR

> ID：15770975
> 
> 赞同：2
> 
> 时间：2013-04-02T17:57:47.330
> 
> 标签：javascript, mysql, node.js

我正在尝试从 nodejs 中的文件执行 sql 查询。

这是（摘要）代码：

```
var fs = require("fs");
var mysql = require("mysql");

fs.readFile("path/to/my.sql", function(error, query) {
    mysql.connect(configuration, function(error, connection) {
        connection.query(query.toString(), callback); // this doesn't work
    }
} 
```

执行后，以下错误被传递给我的回调函数：

```
{"code":"ER_PARSE_ERROR","index":0} 
```

我已经证实：

*   我可以连接到mysql主机
*   我可以执行内联查询
*   我可以在 mysql 工作台中执行文件
*   我可以在 node.js 中打开文件并将其记录到控制台

# html - html/css 为 ul/li 选择 last-child 的 last-child

> ID：15770977
> 
> 赞同：1
> 
> 时间：2013-04-02T17:57:54.797
> 
> 标签：html, css, css-selectors

我有一个`<ul> <li>`结构，我想做的是

`.div ul:last-child li:last-child {border-bottom:1px etc}`,

所以它会`<li>`从最后一个中选择最后一个`<ul>`。

```
<div id="accord_wrapper">
        <div class="accordionButton"></div>
            <div class="accordionContent">
                <ul>
                    <li><a href="http://www.google.com">one</a></li>
                    <li><a href="http://www.yahoo.com">two</a></li>
                </ul>
        </div>          
        <div class="accordionButton">Button 2 Content</div>
        <div class="accordionContent"><ul>
                    <li><a href="http://www.google.com">one</a></li>
                    <li><a href="http://www.yahoo.com">two</a></li>
                </ul></div>
        <div class="accordionButton">Button 3 Content</div>
        <div class="accordionContent"><ul>
                    <li><a href="http://www.google.com">one</a></li>
                    <li><a href="http://www.yahh.com">two</a></li>
                </ul></div>
        <div class="accordionButton">Button 4 Content</div>
        <div class="accordionContent"><ul>
                    <li><a href="http://www.google.com">one</a></li>
                    <li><a href="http://www.stackoverflow.com">two</a></li>
                </ul></div>
    </div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T18:20:14.920

在您的实际代码中，每个`ul`都是其 parent 的最后一个也是唯一的孩子`div.accordionContent`。这就是为什么每一个`ul`都被你的选择器匹配的原因。

由于最后一个`div.accordionContent`恰好也是顶级元素的最后一个子元素，因此您应该可以这样做：

```
#accord_wrapper .accordionContent:last-child ul li:last-child 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T18:07:53.253

`:last-child`伪选择器来自 CSS3，因此您的浏览器需要兼容才能使用它。见[http://caniuse.com/#search=%3Alast-child](http://caniuse.com/#search=%3Alast-child)

顺便说一句，`.div ul:last-child li:last-child {border-bottom:1px etc}`正如你所描述的那样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-14T13:56:47.153

您可以通过使用选择 ul 中的任何 li`:nth-child(number)`

这是一个例子

html:

```
<ul>

     <li>one</li>
     <li>two</li>
     <li>three</li>
     <li>four</li>
     <li>five</li>

</ul> 
```

假设我们要选择 ul 中的第三个孩子，那么我们将使用 nth-child(3)

CSS：

```
ul:last-child li:nth-child(3) {
    /*style something*/
} 
```

# jquery - 关闭带有父 ID 的 jquery-ui 对话框

> ID：15770983
> 
> 赞同：0
> 
> 时间：2013-04-02T17:58:03.703
> 
> 标签：jquery, jquery-ui

有没有一种方法可以获取我父 div 的 id 而不必像下面那样在前面附加“#”？

谢谢

```
var parentDivId = $(div).closest("div").attr("id");
$("#" + parentDivId).dialog('close'); 
```

这将关闭对话框：

```
$("#" + parentDivId).dialog('close'); 
```

这不起作用：

```
$(parentDivId).dialog('close'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:01:38.630

如果我没记错的话，你也许可以这样做：

```
$(div).parent().dialog('close'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T18:04:14.317

您的变量`parentDivId`足以完成它，请尝试以下方法：

```
$('[id="' + parentDivId + '"]').dialog('close'); 
```

# primefaces - 如何通过它的 id 在 Primefaces 选项卡视图中设置活动选项卡？

> ID：15770985
> 
> 赞同：3
> 
> 时间：2013-04-02T17:58:09.327
> 
> 标签：primefaces

有什么方法可以通过它的 ID 以编程方式设置活动选项卡，而不是索引？我的选项卡视图中的选项卡是动态变化的，我可以可靠地引用它们的唯一方法是通过 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-18T07:37:25.227

我找到了一个解决方案：

您可以通过在 javascript 中执行此操作来获取给定选项卡 ID 的选项卡索引：

```
function getTabIndex(tabId) {

    var tabLinks = $('#tabViewId li a').toArray();

    for(var tabIndex = 0; tabIndex < tabLinks.length; tabIndex++) {
        if($(tabLinks[tabIndex]).attr('href') == ('#tabViewId:'+ tabId)) {
            return tabIndex;
        }
    }

    return -1;
} 
```

然后，一旦获得索引，您就可以执行以下操作：

```
tabView.select(tabIndex) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T19:52:13.317

你这样做使用

您为 p:focus 组件动态传递活动 id

[http://www.primefaces.org/showcase/ui/focus.jsf](http://www.primefaces.org/showcase/ui/focus.jsf)

# c# - CSP 未在远程桌面上检测到智能卡微型驱动程序

> ID：15770986
> 
> 赞同：2
> 
> 时间：2013-04-02T17:58:10.550
> 
> 标签：c#, .net, cryptography, remote-desktop, smartcard

我正在编写一个使用智能卡进行 xml 签名的简单程序。

示例代码：

```
var cspParams = new CspParameters(1, "Microsoft Base Smart Card Crypto Provider")
{
    KeyPassword = password,
    Flags = CspProviderFlags.UseDefaultKeyContainer
 };

var rsaKey = new RSACryptoServiceProvider(cspParams); 
```

此代码在本地机器上运行良好，但在远程桌面上我收到以下消息：

> “检测到智能卡，但不是当前操作所需的。您使用的智能卡可能缺少所需的驱动程序软件或所需的证书。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T13:33:29.880

这是由远程桌面安全策略引起的，它将所有对智能卡的请求从远程计算机重定向到本地计算机。使用不同的[VNC](http://en.wikipedia.org/wiki/Virtual_Network_Computing)客户端和服务器。

# magento - 获取所有产品图片，包括排除的图片

> ID：15770987
> 
> 赞同：2
> 
> 时间：2013-04-02T17:58:11.473
> 
> 标签：magento

我一直在使用 getMediaGalleryImages，但我刚刚意识到它不会返回排除的图像。还有另一种类似的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T18:47:36.413

```
$product = $this->getProduct();
$galleryData = $product->getData('media_gallery'); 
```

类似上面的代码将获取产品的所有媒体图像。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-22T17:16:15.510

有点晚了，但其他人可能想尝试

```
$product->getMediaGallery('images') 
```

用于获取数组中的所有图像，包括标有“排除”的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-13T16:39:17.023

如果您使用自定义集合，请尝试添加：

```
->addAttributeToSelect('*') 
```

# java - 如何在所述 API 中找到 RESTful API 的 URL

> ID：15770989
> 
> 赞同：0
> 
> 时间：2013-04-02T17:58:19.410
> 
> 标签：java, url, rest

假设我有这个端点：

```
@GET
@Path("/{product}")
@Produces(MediaType.APPLICATION_JSON)
public String getProduct(
        @PathParam("product") final String product) {
    return createSignature(<<PLACE COMPLETE URL HERE>>);
} 
```

我如何知道从端点内部调用的完整 URL，以便基于它创建签名？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:02:17.897

`@Context HttpServletRequest request`您可以通过将参数添加到您的方法来访问原始请求。然后，您可以访问您想要对请求执行的任何操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T18:06:55.033

有几种方法。通常，您可以向资源类的方法或字段添加特殊参数。特殊参数由类型（HttpServletRequest 或 UriInfo）识别，应使用 annotaiton 进行标记`@Context`。

@StormBringerX 已经提到可以使用方法参数（+1）传递信息。我个人更喜欢将其添加为您的类的一个字段，因为我认为这更清晰，并且允许创建仅接受应用程序级参数的方法。

# css - CSS 悬停替代（自动）

> ID：15770996
> 
> 赞同：4
> 
> 时间：2013-04-02T17:58:45.670
> 
> 标签：css, hover, transition

我的 CSS 必须使用过渡来更改，直到现在我都使用`div:hover`它。

当您单击另一个时需要激活过渡`div`，而不是当您将鼠标悬停在`div`必须移动/更改的 时。

我怎样才能做到这一点 ？

谢谢

翻转

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T18:02:03.133

您无法使用 css 处理 dom 元素上的点击事件，您需要为此使用 javascript。

您可以将单击事件添加到单击它时触发的第一个 div。在事件中，您选择另一个 div，并进行转换。

[工作演示](http://jsfiddle.net/dEpzu/)

您可以通过添加具有 css 转换的类来做到这一点：

**html:**

```
<div id="clickme">1</div>
<div id="changeMe">2</div> 
```

**Javascript：**

```
var el = document.getElementById('clickme');

el.onclick = function() {
    document.getElementById('changeMe').className = "transition";
}; 
```

**CSS：**

```
.transition{
   /* transition css */
} 
```

# ios - 将 RACCommand 与异步网络操作一起使用

> ID：15770998
> 
> 赞同：7
> 
> 时间：2013-04-02T17:58:56.517
> 
> 标签：ios, objective-c, reactive-cocoa, raccommand

我`UAGitHubEngine`用来访问 GitHub 的 API。我想编写一个功能性的反应式应用程序来获取一些数据。我依靠[这里](https://github.com/ReactiveCocoa/ReactiveCocoa)的代码来设置异步网络请求。我正在寻找的是一些名为“General”的团队的团队 ID。我可以做过滤/打印部分OK：

```
[[self.gitHubSignal filter:^BOOL(NSDictionary *team) {
    NSString *teamName = [team valueForKey:@"name"];
    return [teamName isEqualToString:@"General"];
}] subscribeNext:^(NSDictionary *team) {

    NSInteger teamID = [[team valueForKey:@"id"] intValue];

    NSLog(@"Team ID: %lu", teamID);
}]; 
```

但是设置命令对我来说是个谜：

```
self.gitHubCommand = [RACCommand command];

self.gitHubSignal = [self.gitHubCommand addSignalBlock:^RACSignal *(id value) {
    RACSignal *signal = ???

    return signal;
}]; 
```

如何设置信号块以在某些异步网络调用返回时返回推送事件的信号？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T18:24:37.200

答案在 中`RACReplaySubject`，[AFNetworking 使用它](https://github.com/prabirshrestha/reactive-cocoa-playground/blob/master/src/reactive-cocoa-playground/AFNetworking/Api.m#L28-L51)来包装它的异步请求。

```
self.gitHubCommand = [RACCommand command];

self.gitHubSignals = [self.gitHubCommand addSignalBlock:^RACSignal *(id value) {
    RACReplaySubject *subject = [RACReplaySubject subject];

    [engine teamsInOrganization:kOrganizationName withSuccess:^(id result) {

        for (NSDictionary *team in result)
        {
            [subject sendNext:team];
        }

        [subject sendCompleted];            
    } failure:^(NSError *error) {
        [subject sendError:error];
    }];

    return subject;
}]; 
```

由于`addSignalBlock:`返回一个信号信号，我们需要订阅它发出的下一个信号。

```
[self.gitHubSignals subscribeNext:^(id signal) {
    [signal subscribeNext:^(NSDictionary *team) {
        NSInteger teamID = [[team valueForKey:@"id"] intValue];

        NSLog(@"Team ID: %lu", teamID);
    }];
}]; 
```

最后，在`addSignalBlock:`执行命令之前不会执行该块，我使用以下命令进行管理：

```
[self.gitHubCommand execute:[NSNull null]]; 
```