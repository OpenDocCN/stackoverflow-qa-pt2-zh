# StackOverflow 问答 13693000-13693999

# java - Java中的binarySearch，策划游戏

> ID：13693001
> 
> 赞同：0
> 
> 时间：2012-12-03T22:35:59.923
> 
> 标签：java, arrays, binary-search

现在，对于 Java 课程，我正在尝试构建一个类似于 Mastermind 的游戏。在这个游戏中，生成一个 4 位随机数，用户尝试猜测该数字。每次猜测时，计算机都会说明有多少正确的数字按正确的顺序排列，有多少正确的数字按错误的顺序排列。

出于某种原因，一切都取决于我对该程序的二进制搜索，这实际上是该程序的核心。我花了几个小时来调整它，但我仍然无法得到它。有任何想法吗？

在这个例子中，我试图猜测 9935，但我意识到这不是一个随机数。

非常感谢！

编辑：当我运行这个程序并使用猜测“9875”时，它并没有给我正确的结果。

我需要找到的猜测和结果是：

> 请输入四位数字：9874
> 
> 正确但位置错误的位数：0
> 
> 正确位置的正确位数：1
> 
> 请输入四位数字：9899
> 
> 正确但位置错误的位数：1
> 
> 正确位置的正确位数：1
> 
> 请输入四位数字：9593
> 
> 正确但位置错误的位数：3
> 
> 正确位置的正确位数：1
> 
> 请输入四位数字：9935
> 
> 正确但位置错误的位数：0
> 
> 正确位置的正确位数：4
> 
> 你是对的！

```
public class Mastermind {

public static void main(String[] args) {

    Random randomGenerator = new Random();
    Scanner input = new Scanner(System.in);

    int randomNumber = 9935;

    int[] randomArray = new int[4];

    int temp = randomNumber;
    for (int i = 3; i >= 0; i--){
        int n = temp%10;
        randomArray[i] = n;
        temp /= 10;
    }

    boolean found = false;

    while (found == false){

        System.out.print(Arrays.toString(randomArray));
        int[] guessArray = new int[4];
        System.out.print("Please enter a four-digit number: ");
        int guessTemp = input.nextInt();
        for (int i = 3; i >= 0; i--){
            int n = guessTemp%10;
            guessArray[i] = n;
            guessTemp /= 10;
        }

        if (Arrays.equals(randomArray, guessArray)){
            System.out.println("You are correct!");
            found = true;
        } else {

            int numberRightRight = 0;
            int numberRightWrong = 0;
            int indexFound = 0;
            for(int i = 0; i < guessArray.length; i ++){
                System.out.println(randomArray[i]);
                indexFound = Arrays.binarySearch(guessArray, randomArray[i]);
                System.out.println(indexFound);
                if (indexFound >= 0){
                    if(indexFound == i){
                        numberRightRight++;
                    } else {
                        numberRightWrong++;
                    }
                }
            }
           System.out.println("The number of correct digits but in the wrong place: " + numberRightWrong);
           System.out.println("The number of correct digits in the right place: " + numberRightRight);
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:05:10.403

如果您不需要使用`Arrays.binarySearch(int[], int)`，您可以使用自己的简单查找方法来查找未排序的数组：

```
public static int findInArray(int[] array, int value) {
  for (int i = 0; i < array.length; i++) {
    if (array[i] == value) {
        return i;
    }
  }
  return -1;
} 
```

现在而不是打电话`Arrays.binarySearch(guessArray, randomArray[i]);`只是打电话`findInArray(guessArray, randomArray[i])`

# jpa - 将数据持久化到数据库导致非法状态异常

> ID：13693004
> 
> 赞同：0
> 
> 时间：2012-12-03T22:36:07.637
> 
> 标签：jpa, jpa-2.0

我有一个 JPA 问题。

假设我有一个如下设置的实体（只是一个假设）。

```
@Entity
@Table (name = "TESTTABLE")
public class TestTable {

@Id
@Basic (optional = false)
private String id;

@JoinColumn(name="TESTID", referencedColumnName = "ID")
@OneToOne(optional = true)
private TestTable testId;

} 
```

基本上，
--=---=--=---=----
|TestTable....... |
--=---=---=---=----
| 字符串 id..........|<------------------------|
| 字符串 testId....|------------TestId = id |
--=--=--=--=--=-=

我在数据库中设置了 foreign_key 约束，并且在代码方面，我期望返回正常的“完整性约束违反 - 未找到父键”约束，如果为 testId 输入的值在 TestTable 中没有对应的 id 值（因此，如果我仅有的条目是 (1, null) 和 (2, 1), (3, 17) 将导致失败）。

但是，当我尝试将诸如上述 (3, 17) 的条目持久保存到数据库时，我收到 IllegalStateException 错误（因为我没有 CascadeType.PERSIST 并且我试图持久保存数据库中不存在的对象）。我知道这是预期的行为，但是有没有绕过这个，让数据库处理它（从而返回预期的约束）？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T15:16:36.740

只需在关系中使用级联 PERSIST。

在 EclipseLink 中，您还可以使用持久性单元属性，

```
"eclipselink.persistence-context.commit-without-persist-rules"="true" 
```

# python - 如何用beautifulsoup提取特定句子后的文本？

> ID：13693005
> 
> 赞同：0
> 
> 时间：2012-12-03T22:36:07.693
> 
> 标签：python, beautifulsoup

我想提取文件中特定句子之后的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:46:57.453

您是否特别需要 BeautifulSoup？如果不使用以下内容：

要在特定句子后立即拆分文本，请尝试此操作，因为我不确定您在句子后具体要提取什么，所以我假设您的意思是句子后的所有内容，

例如，如果我有一个文件`file.txt:`

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。Vivamus congue mattis risus，坐在 amet elementum lorem gravida eu。Cras vitae ante vel erat feugiat scelerisque。Etiam nec urna sed enim blandit blandit non nec odio。Quisque lacinia tempus rhoncus。**Mauris euismod leo ut velit lobortis feugiat。**Phasellus ultrices nunc sit amet tortor pretium eu mollis neque condimentum。Fusce placerat bibendum diam eget euismod。Phasellus ultricies erat nibh, sed volutpat quam。Nunc quis mauris sed purus aliquet aliquam。整数 viverra rutrum arcu ac tempor。

我的句子是，`Mauris euismod leo ut velit lobortis feugiat.`

你可以这样做：

```
with open("file.txt") as file: #open a file securily, then automitaclly close it
    seperator = "Mauris euismod leo ut velit lobortis feugiat." #assign pre-opt variable for the sentence
    for line in file:
        text = line.split(seperator,1)[1]
    print text

>>> Phasellus ultrices nunc sit amet tortor pretium eu mollis neque condimentum. Fusce placerat bibendum diam eget euismod. Phasellus ultricies erat nibh, sed volutpat quam. Nunc quis mauris sed purus aliquet aliquam. Integer viverra rutrum arcu ac tempor. 
```

使用`BeautifulSoup`您可以从文件中提取所有文本，如果您需要更具体的内容，请告诉我。

```
from bs4 import BeautifulSoup

soup = """<html><body><div style="DISPLAY: block; TEXT-INDENT: 0pt"><br/></div> <div align="justify" style="DISPLAY: block; MARGIN-LEFT: 0pt; TEXT-INDENT: 0pt; MARGIN-RIGHT: 0pt"><font style="DISPLAY: inline; FONT-WEIGHT: bold; FONT-SIZE: 10pt; FONT-FAMILY: Arial">Our Earnings are Significantly Affected by General Business and Economic Conditions</font></div></body></html>"""

print(soup.get_text()) 
```

输出：

```
 Our Earnings are Significantly Affected by General Business and Economic Conditions 
```

# java - 为 CMU Sphinx 4 输入转换音频文件

> ID：13693006
> 
> 赞同：7
> 
> 时间：2012-12-03T22:36:15.840
> 
> 标签：java, audio, ffmpeg, speech-recognition, cmusphinx

我有一大堆文件想在使用 CMU Sphinx 4 时运行识别。Sphinx 需要以下格式：

*   16 千赫兹
*   16 位
*   单核细胞增多症
*   小端

我的文件类似于 44100 khz、32 位立体声 mp3 文件。我尝试使用 Tritonus，然后使用它的更新版本 JavaZoom，使用来自[bakuzen](http://www.bakuzen.com/FileRecognizerForcedAlignment.java)的代码进行转换。但是，`AudioSystem.getAudioInputStream(File)`抛出一个`UnsupportedAudioFileException`，我无法弄清楚为什么，所以我继续前进。

现在我正在尝试 ffmpeg。该命令`ffmpeg -i input.mp3 -ac 1 -ab 16 -ar 16000 output.wav`似乎应该可以解决问题（小端除外），但是当我使用 Audacity 检查输出时，它仍然将其标记为“32 位浮点数”。我在[这个网站](http://wiki.roberttwomey.com/Solipsist_Development)上找到的命令也使用`-acodec pcm_s16le`了 ，从它的名字看似乎是输出 16 位小端；但是，Audacity 仍然告诉我输出是`32 bit float`.

谁能告诉我如何将音频文件转换为 CMU Sphinx 4 所需的格式？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-04T01:46:18.230

你真的尝试过 CMU Sphinx 4 中 ffmpeg 的输出吗？32 位浮点数可能是您在 Audacity 中的默认采样格式（*Edit > Preferences > Quality*）。我猜它会将任何导入的文件转换为这些设置，因此它可能不会报告实际文件的参数，但可能是 Audacity 中的工作文件。

删除`-ab 16`. 这将指示编码器使用 16 位/秒，而 ffmpeg 无论如何都会为 pcm_s16le 忽略它。所以你的命令看起来像：

```
ffmpeg -i input.mp3 -acodec pcm_s16le -ac 1 -ar 16000 output.wav 
```

在 Linux 中转换目录中的所有 mp3 文件：

```
for f in *.mp3; do ffmpeg -i "$f" -acodec pcm_s16le -ac 1 -ar 16000 "${f%.mp3}.wav"; done 
```

或视窗：

```
for /r %i in (*) do ffmpeg -i %i -acodec pcm_s16le -ac 1 -ar 16000 %i.wav 
```

在 Windows 批处理文件中：

```
for /r %%i in (*.mp3) do ffmpeg -i "%%i" -acodec pcm_s16le -ac 1 -ar 16000 "%i.wav" 
```

`file`您可以使用、`ffmpeg`、`ffprobe`以及`mediainfo`其他实用程序查看文件信息：

```
$ file hjl0bC.wav 
hjl0bC.wav: RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, mono 16000 Hz

$ ffmpeg -i hjl0bC.wav
[...]
Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s 
```

# sql - 用于分组或过滤结果集的 SQL 查询

> ID：13693007
> 
> 赞同：0
> 
> 时间：2012-12-03T22:36:17.710
> 
> 标签：sql, filter, group-by, sql-server-2008-r2

我有一张这样的桌子...

```
Name   | Clause
---------------
TableA  Dependency1
TableA  Dependency2
TableA  Dependency3
TableB  Dependency1
TableB  Dependency2
................... 
```

并希望对其进行过滤或分组，使其看起来像这样：

```
Name   | Clause
---------------
TableA  Dependency1
        Dependency2
        Dependency3
TableB  Dependency1
        Dependency2
................... 
```

对此的 SQL 查询是什么？

# javascript - 相机在 ThreeJS 中有奇怪的行为

> ID：13693011
> 
> 赞同：0
> 
> 时间：2012-12-03T22:36:48.053
> 
> 标签：javascript, 3d, webgl, three.js

我在 ThreeJS 中设置了一个包含两个立方体、一个相机、一个灯光和一个平面的场景。立方体在飞机上，相机在绿色立方体周围绕圈飞行。

我的问题是摄像机角度有一个奇怪的行为。当相机飞行时，它会自行旋转并进入倒置位置，然后回到正常位置并继续下去。我正在使用 lookAt() 方法。我不知道出了什么问题。我查看了 ThreeJS 的其他一些示例，并得出结论认为这段代码应该可以工作。你能告诉我我做错了什么吗？我希望相机在绿色立方体周围飞行而不倒置。所以我希望它直接看立方体，在它飞行时只改变 z 轴。

这是我的渲染循环：

```
function render() {            
    requestAnimationFrame(render);
    var timer = -0.0002 * Date.now();

    camera.position.x =  5 * Math.cos( timer );
    camera.position.y =  5 * Math.sin( timer );

    camera.lookAt( cube.position );

    renderer.render(scene, camera)
} 
```

这是整个例子：http: [//jsfiddle.net/szivak009/8S5hq/6/](http://jsfiddle.net/szivak009/8S5hq/6/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T12:27:02.040

你的代码很好。请参阅我上面的评论和小提琴[http://jsfiddle.net/8S5hq/9/](http://jsfiddle.net/8S5hq/9/)。

您可以像这样更改相机的`up`方向：

```
camera.up.set( 0, 0, 1 ); 
```

# android - 实例化一个活动对象，对性能和内存有什么影响？

> ID：13693012
> 
> 赞同：0
> 
> 时间：2012-12-03T22:36:49.737
> 
> 标签：android

假设我有一个活动 MyMainActivity，假设有一堆代码足够复杂。

从另一个活动中，访问公共变量或我实例化的方法：

```
MyMainActivity ma = new MyMainActivity();
ma.editVariableMethod();
String example_variable = ma.public_examplevariable; 
```

当我实例化 MyMainActivity ma 时，是否就像再次创建孔活动并将所有从 MyMainActivity 存储到内存一样，如果我启动 MyMainActivity，它会占用相同数量的内存，或者它只是一个允许的链接从 MyMainActivity 编辑变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:42:07.563

你不能实例化一个活动。框架必须照顾它。如果您想使用公共方法，要么将它们设为静态，要么获取对活动对象的有效实例的引用。

编辑：

正如 Squonk 指出的那样，根据您的用例，将共享逻辑提取到另一个新类可能是一个更好的主意，至少在您知道自己在做什么之前。对 Activity 中的内部变量甚至方法进行“完全访问”似乎可行，但这*很可能*不是正确的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:22:41.663

在 Android 中的对象之间共享内存驻留对象是一种不好的做法，无论对象是什么。Android 无法确保它能够正常工作。大多数用例都有可用的替代方案。在另一个 Activity 中“访问公共变量”的特殊情况下，您可以调用 startActivityForResult()，或确保您的 Activity 将他们想要“共享”的数据存储在 SharedPreferences 等中。如果您有两个或多个使用同样的方法，你应该首先考虑是否需要将类抽象成一个单独的对象。理想情况下，活动应该是委托给 POJO 的框架。

# eclipse - 应用和确定按钮之间的区别

> ID：13693013
> 
> 赞同：1
> 
> 时间：2012-12-03T22:36:53.760
> 
> 标签：eclipse, user-interface

Eclipse 首选项中的 Apply 和 OK 的区别是什么。

我在更改首选项后使用 OK 按钮来应用更改并关闭弹出窗口，而使用 Apply 则打开弹出窗口。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T22:38:26.527

“确定”是“应用”+关闭窗口的组合。这不仅仅是 Eclipse 的事情。大多数 GUI 应用程序（至少在 Windows 下）都以相同的方式运行。

# java - protobuf（协议缓冲区）是否允许自定义类型？

> ID：13693017
> 
> 赞同：1
> 
> 时间：2012-12-03T22:37:10.407
> 
> 标签：java, flash, protocol-buffers

我想在 Java 和 Flash 中使用 protobuf。它们都有 protobuf 实现。我想创建以下结构：

```
class UserDetails
{
  int age;
  int weight;
  int lenght;
}

class User
{
  string firstName;
  string lastName;
  UserDetails details;
} 
```

关于*UserDetails 详细信息的问题；*谷歌协议缓冲区是否允许？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T22:44:40.860

是的，您甚至可以定义嵌套消息：

```
message User {
    required string firstName = 1;
    required string secondName = 2;

    message UserDetails {
        required int age = 1;
        required int weight = 2;
        required int lenght = 3;
    }

    required UserDetails details = 3;
} 
```

[您可以在此处](https://developers.google.com/protocol-buffers/docs/proto)获得有关消息的更多信息。

# ruby-on-rails - Rails with Devise - 在'remote => true'提交后使用current_user

> ID：13693018
> 
> 赞同：0
> 
> 时间：2012-12-03T22:37:11.637
> 
> 标签：ruby-on-rails, ajax, devise, warden

我有一个三部分的用户注册，它使用两个单独的模型：用户和客户信息。我远程提交了一个用户注册，它进入表单的下一部分。我希望能够`current_user`在提交客户信息行时使用该变量。当我在没有遥控器的情况下进行测试时，以下代码有效，但当我使用遥控器进行测试时，它甚至根本不创建行。我可以使用另一个变量来代替这个变量吗？或者有没有更好的方法来实现这一点？

```
 def create
    @customer_info = CustomerInfo.new(params[:customer_info].merge(:user_id => current_user.id))

    respond_to do |format|
      if @customer_info.save
        format.html { redirect_to tasks_url, notice: 'Customer info was successfully created.' }
        format.json { render json: tasks_url, status: :created, location: @customer_info }
      else
        format.html { render action: "new" }
        format.json { render json: @customer_info.errors, status: :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:20:56.240

原来这是一个设计配置情况。我不允许用户在任何时间内未经确认，因此“curent_user”即使在他们注册后也保持空白。我添加`config.allow_unconfirmed_access_for = 2.days`并重新启动了服务器并且工作正常。

# jquery - jquery 循环 + 响应式设计 - 绝对项目

> ID：13693021
> 
> 赞同：1
> 
> 时间：2012-12-03T22:37:20.690
> 
> 标签：jquery, html, css

我正在一个网站上工作，该网站有一些“广告块”，可以宣传该网站的各个方面。我的网站是使用 Skeleton 框架设置的，因此它是响应式的。我拥有的一个广告块只是两个相互旋转的图像......它可以随着屏幕尺寸的旋转而适当地创建和调整大小。

我有另一个广告块，它是一个带有背景图像的 div，然后它的特定部分（中间）具有旋转的图像（使用 jquery 循环插件）。我有绝对定位的图像部分，以便我可以让它显示在我想要的位置，并且只有那个方面在图像中旋转。背景图像部分会适当地调整大小，但是我的图像不会……它们保持相同的大小，因此会在我将其“框起来”的背景图像之外打破。

我模拟了正在发生的事情的快速小提琴：http: [//jsfiddle.net/DjvS9/1/](http://jsfiddle.net/DjvS9/1/)

请注意，我只是放置了一个带有一些文本的 div，而不是构成它的背景图像。

关于我做错了什么以及我需要解决什么的任何想法？是因为绝对定位..？？

我用来为第一个有效的广告块修复它的前提是我在这个小提琴中找到的例子：http: [//jsfiddle.net/vengiss/QRWAD/6/](http://jsfiddle.net/vengiss/QRWAD/6/)

任何帮助将不胜感激！

谢谢！！

html代码：

```
<div id="bkgd">
<div id="MyAdBlock">
text<br />        
    text<br />
text<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

<div id="MyAds" class="MyAdImg">
    <img src="http://placehold.it/165x197" width="165" class="placeholder1" />
    <a href="#" target="_blank"><img src="http://placekitten.com/165/197" class="image_size" alt="Img1" /></a>
    <a href="#" target="_blank"><img src="http://placekitten.com/165/194" class="image_size" alt="Img2" /></a>
    <a href="#" target="_blank"><img src="http://placekitten.com/165/195" class="image_size" alt="Img3" /></a>
    <a href="#" target="_blank"><img src="http://placekitten.com/165/196" class="image_size" alt="Img4" /></a>
</div> 
```

CSS：主体{背景：#000;
}

```
#bkgd{

}

#MyAdBlock{
position:relative;
background:#ffffff;  
max-width:50%;
height:auto;
border:5px solid red;
}

.MyAdImg{
position:absolute;
top:73px;
left:28px;
}

 .image_size{
max-width: 100%;
height: auto;
 } 
```

# c# - Linq To SQL 选择语句转换为 Where 0 = 1

> ID：13693025
> 
> 赞同：3
> 
> 时间：2012-12-03T22:37:40.720
> 
> 标签：c#, sql-server, linq-to-sql

我有以下 Linq to SQL 查询。

```
var users = rdc.Users.Where(u => u.EmailAddress.Equals(emailaddress) && password.Equals(hash)); 
```

但它总是转化为：

```
SELECT [t0].[Id], [t0].[Guid], [t0].[RoleId], [t0].[EmailAddress], [t0].[Password], [t0].[FirstName], [t0].[LastName], [t0].[Created], [t0].[Activated], [t0].[LastAction]
FROM [dbo].[Users] AS [t0]
WHERE 0 = 1 
```

我刚刚将表重新导入到我的 DBML 文件中，以确保反映最新的模式，但它仍然删除了我的子句并添加了`WHERE 0 = 1`

我可以使用`ExecuteQuery<T>(string, params[])`，但我想找到它的根本原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T22:42:58.440

是否`hash`和`password`定义在这条线之上？看起来您可能忘记`u.`在查询中添加 。如果`password`已经定义，那么您不会看到错误，但它永远不会等于`hash`.

你的意思是写：

```
var users = rdc.Users.Where(u => u.EmailAddress == emailaddress && u.Password == hash);
                                                                   ^^^ 
```

此外，@Mark 指出使用`==`运算符会显示`.Equals`运算符可能忽略的错误。

# c++ - 多维数组的常量

> ID：13693028
> 
> 赞同：0
> 
> 时间：2012-12-03T22:37:48.427
> 
> 标签：c++, arrays

我正在尝试创建一个多维数组，用户将提供其大小。

到目前为止，我有这个：

```
int definedgroups; // for number of groups needed

cout << "Enter the Number of Groups you require: " << endl;
cin >> definedgroups;
const int definedgroups = definedgroups;

int User_Groups [definedgroups] [4]; 
```

我相信数组需要常量值，所以我尝试将我的变量分配为常量，但仍然没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:00:20.703

在 C++ 中，**静态**数组，即像这样定义的数组：

```
foo arrayStatic[bar]; 
```

要求`bar`是一个常数整数。换句话说，程序员需要事先知道它的值。

无论何时`bar`未知，都可以使用**动态数组。**它们的定义如下：

```
foo* arrayDynamic;
arrayDynamic = new foo[bar]; 
```

在这里，`bar`可能是一个整数变量。

不要忘记动态内存最终必须被释放。因此，在这种情况下，我们可以`arrayDynamic`像这样解除分配：

```
delete [] arrayDynamic; 
```

类似地定义二维动态数组：

```
foo** arrayDynamic2D;
arrayDynamic2D = new foo*[bar];
for (int i = 0; i < bar; i++)
   arrayDynamic2D[i] = new foo[baz]; 
```

并以类似的方式释放：

```
for (int i = 0; i < bar; i++)
   delete [] arrayDynamic2D[i];
delete [] arrayDynamic2D; 
```

静态内存在**堆栈**中分配，而动态内存在**堆中**分配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T22:42:50.330

在 C++ 中使用静态数组是不可能的。以分层方式（即向量的向量）使用`std::vector`来轻松实现多维数组（尽管不一定非常有效）。

例如

`std::vector<std::vector<double> > array(nrows, std::vector<double>(ncols));`

创建一个`nrows`x`ncols`矩阵。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T22:42:56.630

您需要使用动态内存分配`new`：

```
int **User_Groups = new int*[definedgroups];
//Allocate memory for 2nd dimension
for (int i = 0; i < 4; ++i)
    User_Groups[i] = new int[4]; 
```

# sql-server-2008 - 按最近日期和最高版本选择所有列

> ID：13693029
> 
> 赞同：-1
> 
> 时间：2012-12-03T22:37:49.130
> 
> 标签：sql-server-2008

我已经为此困扰了一段时间。Request#、SlotId、Segment 和 Version 都构成了主键。我想要从我的存储过程中获得的是能够通过传入请求#和段来检索所有行，但是对于每个插槽，我想要今天或之前的最新生效日期，并且我需要最高版本#。我感谢你的时间。

```
Values in database
Request#  SlotId  Segment Version Effective Date  ContentId
 A123       1       A       1         2012-01-01      1
 A123       2       A       1         2012-01-01      2 
 A123       2       A       2         2012-02-01      34
 A123       2       A       3         2012-02-01      24
 A123       2       A       4         2015-01-01      6 //beyond todays date. dont want 
```

当我为请求#传入 A123 和为段传入 A 时，我想从我的存储过程中返回的值。

```
 A123       1       A       1         2012-01-01      1
 A123       2       A       3         2012-02-01      24 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:53:27.057

查询可以这样写：

```
; WITH cte AS
    ( SELECT Request, SlotId, Segment, Version, [Effective Date], ContentId,
             ROW_NUMBER() OVER ( PARTITION BY Request, Segment, SlotId
                                 ORDER BY Version DESC ) AS RowN
      FROM
            tableX
      WHERE
            Request = @Req  AND  Segment = @Seg             --- the 2 parameters
        AND [Effective Date] < DATEADD(day, 1, GETDATE())
    )
  SELECT Request, SlotId, Segment, Version, [Effective Date], ContentId
  FROM cte
  WHERE Rn = 1 ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:07:48.247

考虑一下：

```
;
WITH A as
(
   SELECT DISTINCT
       Request
   ,   Segment
   ,   SlotId
   FROM Table1
)
SELECT A.Request
 ,    A.SlotId
 ,    A.Segment
 ,    B.EffectiveDate
 ,    B.Version
 ,    B.ContentID
   FROM   A
     JOIN (
        SELECT  Top 1 
            Request
        ,   SlotId
        ,   Segment
        ,   EffectiveDate
        ,   Version
        ,   ContentId
        FROM  Table1 t1
        WHERE  t1.Request = A.Request
           AND t1.SlotId = A.SlotId
           AND T1.Segment = A.Segment
           AND T1.EffectiveDate <= GetDate()
        ORDER BY
           T1.EffectiveDate DESC
        ,  T1.Version DESC
    ) as B
       ON  A.Request = B.Request
       AND A.SlotId = B.SlotId
       AND A.Segment = B.Segment 
```

# video.js - Firefox 仅适用于所有其他 video.js

> ID：13693034
> 
> 赞同：1
> 
> 时间：2012-12-03T22:38:15.463
> 
> 标签：video.js

我将 video.js 与 mp4 文件一起使用，它在 chrome 中运行良好，但只能在所有其他视频上正常运行（偶数，而不是奇数）

我的代码格式如下

```
<link href="http://vjs.zencdn.net/c/video-js.css" rel="stylesheet">
<script src="http://vjs.zencdn.net/c/video.js"></script>
<video id="video_1" class="video-js vjs-default-skin" controls data-setup="{}" width="580" height="317">
<source src="/path/to/file.mov" type="video/mp4">
Video tag not supported.
</video> 
```

使视频成为绝对链接不起作用，源标签的自动关闭或正常关闭不起作用，删除“不支持视频标签”。不起作用。我现在唯一的解决方法是在每个实际视频之前加载一个空的视频标签，然后用 css 隐藏它。

加载失败的视频有一个与我的视频标签具有相同属性的 div，其中有一个流体宽度视频说唱歌手 div，以及一个 swf 对象，但没有一个 vjs div

# tfs - 签入后任务与哪个分支相关？

> ID：13693038
> 
> 赞同：0
> 
> 时间：2012-12-03T22:38:23.573
> 
> 标签：tfs

我的目标是生成一个构建中发生的更改列表。我在 TFS 中有一个用于发布构建的分支，以及一个用于新开发的分支。所以人们都在提交对两者的更改，其中发布分支的更改通常是错误修复。我想收集所有提交到发布分支的新项目（任务/错误），并排除提交到开发分支的项目。问题是 TFS 查询将所有任务一起提供给我，无论它们适用于哪个分支，我无法区分下一个发布的内容与开发分支中更远的内容和未发布的内容。

关于如何做到这一点的任何想法？

**编辑：**

添加更多细节。我有使用代码签入以形成变更集的项目。此变更集包含 X 分支的代码。我想查询这个：

“给我所有影响 X 分支中代码的项目”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:52:58.660

如果您的构建正确映射到每个分支中的特定文件夹，并且如果您将关联更改集和工作项设置为 true，并且标签源设置为 true，那么当您获得构建报告时，您将获得每个签入和任何关联的工作项自上次构建以来，这些将特定于签入构建工作区中的文件夹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T06:16:00.280

如果您的工程师在签入时将错误/需求/任务与他们的代码相关联，您应该能够查询上次发布的构建和新构建之间的所有工作项。

对于自上一个版本以来的每个构建，获取“迭代”等于该构建号的所有工作项并将其连接在一起。您可能想要整理结果，因为工程师倾向于检查任务和错误，但我认为对您最有价值的项目是需求和错误。

使用此方法，您应该能够获得：

*   自上次发布以来在生产分支中修复的所有错误
*   在合并到生产之间的开发中完成的所有错误和要求

通过这种方式，您可以为发布生成两个发布说明，并根据您的变更控制批准同步生产中所做的事情.. 或您正在做的任何事情......

# math - （球拍/方案）减法收益率以极小的幅度下降

> ID：13693041
> 
> 赞同：2
> 
> 时间：2012-12-03T22:38:41.317
> 
> 标签：math, floating-point, lisp, scheme, precision

我目前正在搞乱“[如何设计程序](http://www.htdp.org/)”——使用方案/球拍；我在 Scheme 的 R5RS 版本中遇到了一个非常特殊的功能。

在进行简单的减法运算时，尽管使用具有小数点精度的值，但答案与预期的结果相差甚远。

例如; 给定以下减法运算：

```
(- 5.00 4.90)
=> 0.09999999999999965 
```

什么时候肯定应该期待干净的 0.10？整数减法按预期工作；

```
> (- 5 4)
 => 1
> (- 5 4.9)
 => 0.09999999999999965 
```

**以练习 3.1.1**为例：

> 下一步是为每个功能制作示例。确定有多少观众能够以 3.00 美元、4.00 美元和 5.00 美元的票价购买演出。使用这些示例制定一个通用规则，说明如何根据票价计算参加者人数。如有需要，请编造更多示例。

示例中的规则是票价每减少 0.10 美元，就会有 15 人参加。所以像这样的快速功能会起作用..

```
(define (attendees ticket-price)
  (+ 120 (* (/ (- 5.00 ticket-price) 0.10) 15))) 
```

但是，这会返回（相当烦人的）..

```
> (attendance 4.90)
 => 134.99999999999994 
```

因此，在尝试了教科书中的（几乎相同的）解决方案之后..

```
(define (attendance price)
  (+ (* (/ 15 .10) (- 5.00 price))
    120)) 
```

我得到了完全相同的错误。这是我的本地系统特有的吗？我很好奇——实际上我可以简单地使用某种形式的舍入来纠正这个问题；但我宁愿知道为什么它首先发生！

除此之外，我建议任何对 Lisp 感兴趣的人看看 HTDP。从略读来看，它似乎是一个相当温和的文本，非常实用。我确实喜欢 SICP——但这更像是一个长期的事情；我似乎花了好几天的时间阅读，然后练习，然后赶上在线讲座。HTDP 似乎更像是“*哦，我有 15 分钟的空闲时间 - 我会看看 HTDP* ”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T22:46:27.757

浮点数并不总是存储为您期望的确切值。参见例如[The Perils of Floating Point](http://www.lahey.com/float.htm)。

如果您想要精确计算，您可以在您的情况下使用整数算术，将值存储为美分而不是美元。

```
(define (attendees ticket-price-cents)
  (+ 12000 (* (/ (- 500 ticket-price-cents) 10) 1500))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T23:15:22.967

除了先前的（正确的）答案之外：您真正应该问的问题是：“为什么这不会发生在其他语言级别？” 答案是：许多其他语言级别将 5.03 解释为精确数字（百分之五和百分之三）而不是浮点数。

仅供参考！

# java - Semaphore.drainPermits() 有什么意义？

> ID：13693044
> 
> 赞同：7
> 
> 时间：2012-12-03T22:38:50.793
> 
> 标签：java, concurrency

公共 int drainPermits():

> 获取并返回所有立即可用的许可证。返回： 获得的许可数量。

为什么有人想要从 Semaphore 获取然后立即释放所有可用的许可？如果他们想查看可用许可证的数量，为什么不使用`Semaphore.availablePermits()`？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-03T22:45:51.217

它不会释放它们。它获取了所有这些，仅此而已：

```
Semaphore s = new Semaphore(10);
System.out.println(s.availablePermits()); // 10
s.drainPermits();
System.out.println(s.availablePermits()); // 0 
```

# git - 添加 gitignore 文件

> ID：13693045
> 
> 赞同：1
> 
> 时间：2012-12-03T22:38:51.407
> 
> 标签：git, windows-7, gitignore

我在 C:\MyProject 有一个预先存在的存储库。它有一个 .git 文件夹，但我没有 .gitignore。我用记事本创建了一个（上面写着它是一个文本文档），当我要提交时，.gitignore 文件夹被添加到 repo 中。

我该如何解决？

我正在使用 Windows 7 专业版。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:41:21.600

这很可能是因为您的文件已经被跟踪，

[看看这个](https://stackoverflow.com/questions/1139762/gitignore-file-not-ignoring)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T22:43:59.207

您不能添加具有相同路径的文件和文件夹。.gitignore 文件夹中有什么？这应该是一个文件。

# php - 如何向 str_replace 添加第二条规则？

> ID：13693048
> 
> 赞同：0
> 
> 时间：2012-12-03T22:39:03.980
> 
> 标签：php

我正在使用以下代码将所有空格替换为“-”，以便创建 URL

```
<?php echo strtolower( str_replace(' ', '-', $city['name']) ); ?> 
```

如何向该代码添加第二条规则，这样我不仅可以替换所有空格......而且我还想用“&”符号替换所有“+”符号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T22:41:43.397

`str_replace()`允许您传入数组而不是字符串，因此您可以一次替换多个字符/术语：

```
echo strtolower( str_replace(array(' ', '+'), array('-', '&'), $city['name']) ); 
```

文档`str_replace`： http: [//php.net/str_replace](http://php.net/str_replace)

请注意，您可以`str_replace`从 PHP 4.0.5 开始传递数组。

# javascript - 上一个选项列表中所选项目的动态选项

> ID：13693049
> 
> 赞同：0
> 
> 时间：2012-12-03T22:39:11.220
> 
> 标签：javascript, html, dynamic, options

我正在编写一个应该包含两个选择标签的 html。为了清楚起见，第一个选择标签包括大陆的名称，用户应该选择其中一个。第二个选择标签应在第一个选择标签中动态显示所选大陆的国家名称。谁能帮我理解我应该如何通过 JavaScript 函数来实现它？应该在第一个选择标签上设置什么事件？应该在选项或选择标签上设置事件吗？

```
<html lang="en">
<head>
<meta cahrset="utf-8">
    <title>Java Script Question Exam</title>
    <script  type="text/javascript">
    var la=["chili","castarica","cuba","jamaieca"];
    var as=["Iran","Iraq","China","Japan"];
    var eu=["Italy","France","Sweden"];
    var af=["Egypt","Morocco"];
    var continents=new Array(la,as,eu,af);

function ContinentFun(input)
{
    var cont=document.getElementById("continent");
    var selected=cont.options.selectedIndex;
    var e=continents[selected];
    var d = document.getElementById(input);
    if(d.length==0)
    {
        for(var j=0; j<e.length;j++)
        {   
            d.add(new Option(e[j],"")); 
        }
    }
    else 
    {
        if (d.length<e.length)
        {
            for(var i=0; i<d.length;i++)
            {   
                d.options[i].text=e[i];     
            }
            for(var j=d.length; j<e.length;j++)
            {   
                d.add(new Option(e[j],"")); 
            }
        }
        else 
        {
            if(d.length>e.length)
            {
                for(var i=0; i<e.length;i++)
                {   
                    d.options[i].text=e[i];     
                }
                for(var j=e.length; j<d.length;j++)
                {   
                    d.remove(j);    
                }
            }
            else
            {
                for(var i=0; i<e.length;i++)
                {   
                    d.options[i].text=e[i];     
                }
            }
        }
    }
}
         </script>
</head>
<body>
    <form id="form1">

        <table id="t1" border="2">
            <tr>
            <td>Select your Continent</td>
            <td>
              <select id="continent" size="1" onchange='ContinentFun("country")'>
                <option>Latin America</option>
                <option>Asia</option>
                <option>Eroupa</option>
                <option>Africa</option>
              </select>
             </td>
            </tr>
            <tr>
                <td>Select Country</td>
                <td>
                    <select id="country" size="1" width="15">
                    </select>
                </td>
            </tr>
        <tr>
            <td></td>
            <td>
               <input type="button" name="Send" value="Send" onclick='PrintInfo("continent","country","t1")' />
            </td>
        </tr>
    </table>
    <br><br><br>
    <textarea id="t1">
    </textarea>
</form>
</body>
</html> 
```

它现在和我想要的一样好......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:45:34.420

**HTML**

```
<select id='continentSelector'>
    <option>Africa</option>
    <option>Antarctica</option>
    <option>Asia</option>
    <option>Australia</option>
    <option>Europe</option>
    <option>North America</option>
    <option>South America</option>
</select> 
```

**Javascript**

```
var selector = document.getElementById('continentSelector');
selector.addEventListener("change",function() {
     alert(this.value); // that will alert 'Africa' / 'Europe' .. etc

     // you can do your logic for the second selector here
     // eg. getCountriesByContinent(this.value);
},false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:41:25.663

在第一个`select`框中，您将要绑定到`onchange`事件。然后，您的事件处理程序将向服务器（提供所选大陆）进行 AJAX 回调，该服务器将返回国家列表（概率为 JSON）。

然后，您可以使用该列表来填充`options`您的第二个`select`框。

# python - 从元类调用 __new__ 时出错

> ID：13693050
> 
> 赞同：6
> 
> 时间：2012-12-03T22:39:10.760
> 
> 标签：python

以下代码会产生错误：

```
class FooMeta(type):
  def __new__(mcl, classname, bases, classdict):
   return type.__new__(mcl, classname, bases, dict())

  def __init__(cls, name, bases, classdict):
    super(FooMeta, cls).__init__(name, bases, classdict)

    d = dict()
    for key, item in classdict.items():
      if key.startswith("_"):
        setattr(cls, key, item)
      else:
        d[key] = item
    setattr(cls, '_items', d)

class Foo(object):
  __metaclass__ = FooMeta

class Passing(Foo):
  def __init__(self, *args, **kw):
    pass

class Failing(Foo):
  def __new__(cls, *args, **kw):
    return super(Failing, cls).__new__(cls)

  def __init__(self, *args, **kw):
    pass

fail = Failing() 
```

错误是

```
Traceback (most recent call last):
  File ".../FooMeta,py", line 30, in <module>
    fail = Failing()
TypeError: unbound method __new__() must be called with Failing instance as first argument (got FooMeta instance instead) 
```

`__new__`从元类调用时，调用方式似乎有所不同。

1）有人知道为什么会这样吗？2）有什么办法可以解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:09:08.077

如果您允许按照通常的方式设置属性：

```
class FooMeta(type):
    def __new__(mcl, classname, bases, classdict):
        return type.__new__(mcl, classname, bases, classdict) 
```

并且不要摆弄它们`__init__`，您会看到这`Failing.__new__`通常是一个静态方法：

```
class FooMeta(type):
    def __new__(mcl, classname, bases, classdict):
        return type.__new__(mcl, classname, bases, classdict)
        # return type.__new__(mcl, classname, bases, dict())

    def __init__(cls, name, bases, classdict):
        super(FooMeta, cls).__init__(name, bases, classdict)
        d = dict()
        for key, item in classdict.items():
            if key.startswith("_"):
                # setattr(cls, key, item)
                pass
            else:
                d[key] = item
        setattr(cls, '_items', d)

class Foo(object):
    __metaclass__ = FooMeta

class Failing(Foo):
    def __new__(cls, *args, **kw):
        return super(Failing, cls).__new__(cls)

    def __init__(self, *args, **kw):
        pass

print(Failing.__dict__['__new__'])
foo = Failing() 
```

产量：

```
<staticmethod object at 0xb774ba94> 
```

但是，如果您运行您发布的代码，并在末尾添加了此打印语句：

```
print(Failing.__dict__['__new__'])
foo = Failing() 
```

您会看到`__new__`已更改为函数：

```
<function __new__ at 0xb747372c> 
```

您可以通过允许像通常那样设置 classdict 中的所有属性，然后删除那些不以 开头的属性来解决此问题`_`：

```
class FooMeta(type):
    def __new__(mcl, classname, bases, classdict):
        return type.__new__(mcl, classname, bases, classdict)

    def __init__(cls, name, bases, classdict):
        super(FooMeta, cls).__init__(name, bases, classdict)
        d = dict()
        for key, item in classdict.items():
            if not key.startswith("_"):
                delattr(cls, key)
                d[key] = item
        setattr(cls, '_items', d)

class Foo(object):
    __metaclass__ = FooMeta

class Passing(Foo):
    def __init__(self, *args, **kw):
        pass

class Failing(Foo):
    def __new__(cls, *args, **kw):
        return super(Failing, cls).__new__(cls)

    def __init__(self, *args, **kw):
        pass

print(Failing.__dict__['__new__'])
foo = Failing() 
```

# jquery - 预加载然后在模态中显示变量

> ID：13693051
> 
> 赞同：0
> 
> 时间：2012-12-03T22:39:15.343
> 
> 标签：jquery, modal-dialog

我正在加载一个 MODAL，该 MODAL 输入了我在点击时获取并加载的图像。有人可以解释如何加载然后在单击时显示我的图像，以便对话框正确居中。就目前而言，对话框不知道图像大小，因此它偏离中心加载。我尝试使用 .load 函数，但不知道该放在哪里；因为它给了我错误。下面的代码功能齐全，但我需要它在将 deIMG 提供给对话框之前预加载它，以便它知道大小。

```
function thumbNailModal() {
    $('.thumb').click(function() {
        picDES = document.getElementById(this.id).getAttribute('id');
        var desIMG = $('<img/>', {
                        "class":"inline",
                        src: '/images/design/full/' + picDES
                    });
        $(desIMG).dialog(
            {
                modal:      true,
                draggable:  false,
                title:      'Designs',
                height:     'auto',
                width:      'auto',
                open:       function(){
                    jQuery('.ui-widget-overlay').bind('click',function(){
                        jQuery(desIMG).dialog('close');
                    })
                }
            }
        );
        $(".ui-dialog-titlebar").hide();
    });
} 
```

**编辑**

```
 function thumbNailModal() {
        $('.thumb').click(function() {
.load(
            picDES = document.getElementById(this.id).getAttribute('id');
            var desIMG = $('<img/>', {
                            "class":"inline",
                            src: '/images/design/full/' + picDES
                        });
) 
```

我想要更多类似的东西。您单击的位置然后加载。不只是在加载页面后立即预加载所有图像。

# gcc - 似乎 malloc 要求的内存太多

> ID：13693054
> 
> 赞同：0
> 
> 时间：2012-12-03T22:39:30.423
> 
> 标签：gcc, malloc, sbrk

我有一个使用 yagarto GCC 编译器的 STM32F0 应用程序。我已经实现了_sbrk newlib_stubs.c。我遇到的问题是我在调用 _sbrk 并要求 4K 内存时调用 malloc(256) 依次调用 malloc。我的系统总共只有 8K，所以显然这是个问题。我已经监视了对 _sbrk 的调用，它似乎在分配较少的内存之前进行了一些调用。

现在我正在通过捂住鼻子避免恶臭并做类似的事情来解决这个问题：

```
if(requested > 512)
    requested = 512; 
```

在我重新定位堆之前在 _sbrk 中。

尽管该系统看起来坚如磐石，但我相当肯定它会在我最不期待的时候再次出现并困扰我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T14:44:47.523

通过评论中提供的关于不使用 malloc 的微妙提示，我最终创建了一些东西来分配我自己的内存。我不需要发布它，这样就很简单了。唯一让我难过一个小时的事情是保持 32 位对齐。

这是我的实现 pm_ 代表穷人。

```
#define HEAPSIZE 0x800 //2K

    uint16_t __heapPtr = 0;
    uint8_t __customHeap[HEAPSIZE];
    void *pm_malloc(uint16_t size){
        while(__heapPtr % 4 != 0)
            __heapPtr++;

        void *block = &__customHeap[__heapPtr];
        if(size + __heapPtr > HEAPSIZE)
            return 0;

        __heapPtr += size;
        return block;
    } 
```

在过去的 15 年里，我的生活一直是 C#、Java 和 Objective-C，所以任何反馈都将不胜感激。

# php - 阻止 PHP 在 $_POST 超全局中创建数组

> ID：13693056
> 
> 赞同：3
> 
> 时间：2012-12-03T22:39:39.160
> 
> 标签：php, html, forms, superglobals

PHP会自动转换

```
<input type="text" name="foo[0]" value="x" />
<input type="text" name="foo[1]" value="y" /> 
```

进入

```
$_POST['foo'] = array(
    0 => 'x', 
    1 => 'y'
); 
```

这是你最想要的。但是，在这种情况下，我不希望这种情况发生。反正有没有告诉PHP不要这样做？

我意识到我可以解析`php://input`自己，但如果可以避免的话，我宁愿不这样做。

我也没有重命名输入名称的选项。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T22:42:32.767

通过使用方括号`[]`，您可以明确告诉 PHP 创建一个数组，但不要使用方括号：

```
<input type="text" name="foo_0" value="x" />
<input type="text" name="foo_1" value="y" /> 
```

这些字段将在 $_POST 数组中作为`$_POST['foo_0']`和可用`$_POST['foo_1']`。

如果您对标记没有影响（这很奇怪，因为您总是可以在客户端更改它们），您需要展平数组。

```
$post = array();

foreach ($_POST as $key => $value) {
    if (!is_array($value)) {
        $post[$key] = $value;
    } else {
        foreach ($value as $foo => $item) {
            $post[$foo] = $item;
        }
    }
} 
```

或者阅读一些[关于数组展平的重要信息](https://stackoverflow.com/questions/1319903/how-to-flatten-a-multidimensional-array)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:47:12.320

我不认为您可以在不重新编译 php 的情况下禁用此功能。

我想警告您通过遍历 multi dim 数组来重建原始变量名称。您无法完全重构名称，因为 php 重命名了某些字符。例如，php 不允许在 $_POST/$_GET/etc 中的顶级数组键中使用某些字符......因此它用下划线替换 char。这使得无法区分它们，`a.b` `a b` `a[b`因为它们都显示为`a_b`。此外，与解析请求变量的数组语法相关的长期存在的错误会导致此行为。这是我几年前提交的错误报告[https://bugs.php.net/bug.php?id=48597](https://bugs.php.net/bug.php?id=48597)不太可能修复。

此外，`magic_quotes_gpc`如果启用了该设置，它会将其爪子放入阵列键中。

但是，如果您对上述这些边缘情况失败感到满意，那么您可以按如下方式重建数组：

```
$ritit = new RecursiveIteratorIterator(new RecursiveArrayIterator($_POST));
$result = array();
foreach ($ritit as $k => $leafValue) {
    if ($ritit->getDepth() > 0) {
        $path = array($ritit->getSubIterator(0)->key());
        foreach (range(1, $ritit->getDepth()) as $depth) {
            $path[] = sprintf('[%s]', $ritit->getSubIterator($depth)->key());
        }
        $result[ join('', $path) ] = $leafValue;
    } else {
        $result[$k] = $leafValue;
    }
}

print_r($result); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T22:53:33.080

恢复数组转换应该像这样完成：

```
$POST = array('foo' => array('bar', 'baz'));

foreach ($POST['foo'] as $key => $value) {
    $POST['foo['.$key.']'] = $value;
}
unset($POST['foo']);

var_dump($POST); 
```

输出：

```
array(2) {
  'foo[0]' =>
  string(3) "bar"
  'foo[1]' =>
  string(3) "baz"
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T01:52:44.860

我最终采用了 markus-tharkun 建议的扁平化方法。对于那些感兴趣的人，这是我最终使用的代码：

```
function flatten($model) {
    $repeat = false;
    foreach ($model as $name => $value) {
        if (is_array($value)) {
            $repeat = true;
            foreach ($value as $sub_name => $sub_value) {
                $model["{$name}[$sub_name]"] = $sub_value;
            }
            unset($model[$name]);
        }
    }
    if ($repeat) {
        $model = flatten($model);
    }
    return $model;
} 
```

# c++ - 如何将这些连接在一起？

> ID：13693064
> 
> 赞同：1
> 
> 时间：2012-12-03T22:40:37.500
> 
> 标签：c++, mysql, phpmyadmin, qt-creator

我有一个由 phpMyAdmin 创建的 mysql 数据库，我想在我的 Qt 项目中使用它。我在带有 qt 插件的 Visual Studio 2010 上进行了尝试，但没有成功。

在 Qt Creator 中，我添加：

```
QT += sql 
```

在 .pro 文件中并包括：

```
#include <QSqlDatabase> 
```

在主文件中，但存在驱动程序错误。

我什至不知道从哪里开始，每个谷歌页面都显示不同的东西。我试图寻找一些指南，但没有什么与 []s 中的所有内容有关。

**编辑：**

错误：未加载 QMYSQL 驱动程序

我知道我应该看这里：[http](http://doc.qt.digia.com/stable/sql-driver.html) ://doc.qt.digia.com/stable/sql-driver.html但我不知道我在找什么。

我试过这个：[http](http://www.seppemagiels.com/blog/create-mysql-driver-qt-windows) ://www.seppemagiels.com/blog/create-mysql-driver-qt-windows但我没有 mingw 东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T11:03:57.550

您必须与 Qt 分开编译驱动程序。在这种情况下，您需要 MySql 驱动程序。看这里： [http ://doc.qt.digia.com/stable/sql-driver.html](http://doc.qt.digia.com/stable/sql-driver.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T10:13:42.027

安装[Qt Visual Studio 插件](https://qt-project.org/downloads#qt-other)并在 Qt 项目选项中标记 SQL（不确定名称是否正确，但我稍后会告诉你）。就这样。

# spring - Spring 应用程序上下文模式中的错误

> ID：13693065
> 
> 赞同：18
> 
> 时间：2012-12-03T22:40:39.863
> 
> 标签：spring, xsd, spring-data

我在 Eclipse 中有一个 maven-spring 项目，并且在我的一个 spring 上下文中出现了这个烦人的错误消息：

> 引用的文件包含错误（jar:file:/M2_HOME/repository/org/springframework/spring-beans/3.1.2.RELEASE/spring-beans-3.1.2.RELEASE.jar!/org/springframework/beans/factory/xml /spring-tool-3.1.xsd)。有关更多信息，请右键单击问题视图中的消息并选择“显示详细信息...”

演出细节导致了这一点：

![在此处输入图像描述](../Images/5ccb47fe112743491b90c6971c295e39.png)

我使用 spring-data-jpa 1.2.0.RELEASE，其余的 spring jar 是 3.1.3.RELEASE。关于 spring-data-commons-core - 我什至在我的 pom 中都没有对这个 jar 的依赖，但我可以在我的 m2 存储库中看到它以及 spring-data-commons-parent 和版本 1.4.0.RELEASE ，我不知道为什么（也许这些是 spring-data-jpa 的一部分？）。

我的应用程序上下文架构：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:jpa="http://www.springframework.org/schema/data/jpa"
    xsi:schemaLocation="
   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
   http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
   http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.2.xsd"> 
```

我不明白为什么我不断收到此错误。基本上它没有任何影响，应用程序编译、部署和运行都很好，只是 Eclipse 中这个恼人的红色错误标记让我发疯:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-01-14T19:51:59.407

我最近在最新的 Eclipse (Kepler) 中遇到了类似的问题，并通过在 Preferences > XML > XML Files > Validation 中禁用“尊重所有 XML 模式位置”选项来修复它。它禁用对指向不同模式位置的相同命名空间的引用的验证，只采用通常在被验证的 XML 文件中找到的第一个。此选项来自 Xerces 库。

WTP 文档： http: [//www.eclipse.org/webtools/releases/3.1.0/newandnoteworthy/sourceediting.php](http://www.eclipse.org/webtools/releases/3.1.0/newandnoteworthy/sourceediting.php)

Xerces 文档：http: [//xerces.apache.org/xerces2-j/features.html#honour-all-schemaLocations](http://xerces.apache.org/xerces2-j/features.html#honour-all-schemaLocations)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-06T08:31:52.913

我通过做 3 件事解决了这个问题：

1.  将此存储库添加到我的 POM：

    ```
    <repository>
        <id>spring-milestone</id>
        <name>Spring Maven MILESTONE Repository</name>
        <url>http://repo.springsource.org/libs-milestone</url>
    </repository> 
    ```

2.  我正在使用这个版本的 spring-jpa：

    ```
    <dependency>
        <groupId>org.springframework.data</groupId>
        <artifactId>spring-data-jpa</artifactId>
        <version>1.2.0.RELEASE</version>
    </dependency> 
    ```

3.  我从上下文中删除了 xsd 版本（尽管我不确定是否有必要）：

    > ```
    > <?xml version="1.0" encoding="UTF-8"?>
    > <beans xmlns="http://www.springframework.org/schema/beans"
    >   xmlns:context="http://www.springframework.org/schema/context"
    >   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jdbc="http://www.springframework.org/schema/jdbc"
    >   xmlns:jpa="http://www.springframework.org/schema/data/jpa" xmlns:tx="http://www.springframework.org/schema/tx"
    >   xsi:schemaLocation="
    >    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    >    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
    >    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
    >    http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
    >    http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd"> 
    > ```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-10-03T07:44:56.067

有时 spring config xml 文件在下一次 eclipse 打开时效果不佳。

它显示由模式定义引起的xml文件中的错误，无论是重新打开eclipse还是清理项目都不起作用。

但是试试这个！

> 右键单击 spring config xml 文件，然后选择`validate`.

过了一会儿，错误消失了，eclipse 告诉你这个文件没有错误。

真是笑话...

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-22T11:20:19.947

我对 spring-data-jpa-1.3 所做的是将一个版本添加到 xsd 并将其降低到 1.2。然后错误消息消失。像这样

```
<beans
        xmlns="http://www.springframework.org/schema/beans"
        ...
        xmlns:jpa="http://www.springframework.org/schema/data/jpa"
        xsi:schemaLocation="
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
    ...
    http://www.springframework.org/schema/data/jpa
    http://www.springframework.org/schema/data/jpa/spring-jpa-1.2.xsd"> 
```

似乎它是为 1.2 修复的，但随后又出现在 1.3 中。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-01-13T03:31:57.413

我最近对 ​​Spring 4.0 有同样的问题。

这是由`spring-beans-4.0.xsd`和的名称冲突引起的`spring-context-4.0.xsd`。打开`spring-context-4.0.xsd`你可以看到`spring-beans-4.0.xsd`导入如下：

```
<xsd:import namespace="http://www.springframework.org/schema/beans"  
schemaLocation="http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"/> 
```

这些名称的冲突使 Eclipse 抱怨“......一个模式不能包含两个具有相同名称的全局组件......”

一个值得注意的方面是 Eclipse Kepler SR2 但 Eclipse Luna SR1 没有这个问题，比较两种关于 XML 验证的偏好，它们是相同的。

**它是通过从 xsi:schemaLocation 属性中删除 spring-context-4.0.xsd 来解决的：**

```
http://www.springframework.org/schema/context   
http://www.springframework.org/schema/context/spring-context-4.0.xsd 
```

在此之后，一切都按预期工作。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-17T04:30:31.027

我最近对 ​​JPA-1.3 有同样的问题

在我使用明确的 tools.xsd 链接之前没有任何效果

```
xsi:schemaLocation=" ...
    http://www.springframework.org/schema/tool
    http://www.springframework.org/schema/tool/spring-tool-3.2.xsd
    ... "> 
```

像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p" 
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:jdbc="http://www.springframework.org/schema/jdbc"
    xmlns:jpa="http://www.springframework.org/schema/data/jpa"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
        http://www.springframework.org/schema/tx 
        http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
        http://www.springframework.org/schema/jdbc 
        http://www.springframework.org/schema/jdbc/spring-jdbc-3.2.xsd
        http://www.springframework.org/schema/data/jpa
        http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd
        http://www.springframework.org/schema/tool
        http://www.springframework.org/schema/tool/spring-tool-3.2.xsd
        "> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-05-17T07:25:45.527

如果您无法控制这些文件，因为这些文件可能是其他项目的一部分并且您无权进行任何更改，那么您可以通过 Preferences --> XML --> XML Files 在 eclipse 中绕过这些错误--> 验证 --> 引用的文件包含错误 --> 选择忽略选项。

并让项目得到验证，错误消息将消失。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-07-23T11:52:48.643

@forhas 和 @HRgiger 所做的也对我有用。我正在使用`spring-data-mongodb`而不是`jpa`.

但是，对于 mongodb 绑定，您不应删除 mongodb 引用 xsd 的版本，只需将其保留为 version: `http://www.springframework.org/schema/data/mongo/spring-mongo-1.0.xsd`。`context`和`beans`版本应该被删除。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-09-02T00:08:23.103

我通过更新版本号删除了这个错误

```
 xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd 
```

到 4.3，因为我在 pom 中将 spring 版本更新为 4.3.7.RELEASE

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-02T11:44:51.707

我也遇到了这个问题，并通过从 XSD 名称中删除版本部分来修复它。

```
http://www.springframework.org/schema/beans/spring-beans-4.2.xsd to http://www.springframework.org/schema/beans/spring-beans.xsd 
```

没有 XSD 的版本将映射到应用程序中使用的框架的当前版本。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-15T09:48:50.850

> 引用的文件包含错误（[http://www.springframework.org/schema/context/spring-context-3.0.xsd](http://www.springframework.org/schema/context/spring-context-3.0.xsd)）

我遇到了这个问题，当我配置 dispatcher-servlet.xml 时，你可以删除这个：

```
xsi:schemaLocation="http://www.springframework.org/schema/beans
  http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
  http://www.springframework.org/schema/context
  http://www.springframework.org/schema/context/spring-context-3.0.xsd" 
```

从您的 xml 中，您还可以按照步骤转到窗口 -> 首选项 -> 验证 -> 和未选中的 XML 验证器和 XML 模式验证器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-03-12T12:54:56.257

用这个：

```
xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd" 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-07-15T12:00:47.377

升级eclipse版本后发生在我身上。对我有用的是清理 eclipse 缓存。转到窗口 > 首选项 > 网络连接 > 缓存 > 全部删除。

我希望这对任何人都有效！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-24T04:54:38.303

解决此问题的步骤 1.右键单击您的项目 2.单击验证选项

结果：TODO 问题已解决

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-06-29T07:48:14.797

添加此 xml 配置文件。这不是显示错误。

```
 http://www.springframework.org/schema/tool
        http://www.springframework.org/schema/tool/spring-tool.xsd 
```

例子

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context.xsd
    http://www.springframework.org/schema/tool
    http://www.springframework.org/schema/tool/spring-tool.xsd">
</beans> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-10T10:29:01.143

确保 jar 文件已正确添加，然后转到[此处](https://www.codetd.com/en/article/6850606)进行其余操作

# c++ - 数组乘法任务

> ID：13693067
> 
> 赞同：-4
> 
> 时间：2012-12-03T22:40:50.057
> 
> 标签：c++, c, arrays

我想弄清楚如何将 2 个数组中的值相乘（作为输入）以获得输出。我遇到的问题是如何增加循环以实现如下所示的任务

```
#include <iostream>

using namespace std;

main()
{
 int* filter1, *signal, fsize1 = 0, fsize2 = 0, i = 0;

 cout << " enter size of filter and signal" << endl;
 cin >> fsize1 >> fsize2;

filter1 = new int [fsize1];
signal = new int [fsize2];

cout << " enter filter  values" << endl;
for (i = 0; i < fsize1; i++)
cin >> filter1[i];
 cout << " enter  signal values" << endl;
for (i = 0; i < fsize2; i++)
cin >> signal[i];

/* 
```

这两个数组应该由用户填写，但使用下面的数组进行测试：

```
int array1[6] = {2, 4, 6, 7, 8, 9};
int array2[3] = {1, 2, 3};

The output array should be

array3[8]= {1 * 2, (1 * 4 + 2 * 2), (1 * 6 + 2 * 4 + 3 * 2), (1 * 7 + 2 * 6 + 3 * 4), (1 * 8 + 2 * 7 + 3 * 6), (1 * 9 + 2 * 8 + 3 * 7), (2 * 9 + 3 * 8), 3 * 9}

*/

 return 0;
 } 
```

这是有关采样信号过滤器的更大任务的一部分，但我无法完成这种乘法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:22:19.727

在这里查看有关[卷积](http://www.songho.ca/dsp/convolution/convolution.html)的信息。

一旦你理解了这个过程，那么编码就不应该那么难了。该网站还包含一个用于二维卷积的 C++ 算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:46:51.813

假设您有三个长度数组`N`：

*   `input1`, 第一个输入数组
*   `input2`，第二个输入数组
*   `output`, 输出数组

然后，对于`i`from `0`to `N - 1`，循环并将结果`input1[i] * input2[i]`放入 into `output[i]`（假设为[点积](http://en.wikipedia.org/wiki/Dot_product)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T02:20:05.243

我已经有 7 年没有读过关于卷积的文章了。以下代码（适用于您的测试值）完全基于您的示例。由于您没有以任何正式的方式阐明所需的算法，我无法确定此代码是否会为其他输入产生所需的输出。

我已经更改了您的一些变量名称，并重新排序了您提供的一些代码，以便我可以真正思考问题。

```
#include <iostream>
using namespace std;

void main ()
{
    int *signal, *filter, signalLength = 0, filterLength = 0, i = 0;

    cout << "Enter size of signal and filter" << endl;
    cin >> signalLength >> filterLength;

    signal = new int [signalLength];
    filter = new int [filterLength];

    cout << "Enter  signal values" << endl;
    for (i = 0; i < signalLength; i++)
    {
        cin >> signal[i];
    }

    cout << "Enter filter  values" << endl;
    for (i = 0; i < filterLength; i++)
    {
        cin >> filter[i];
    }

    // It was a stated requirement that the filter array be smaller than
    // the signal array.
    // add a check here and act accordingly

    int outputLength = signalLength + filterLength - 1;
    int *output = new int[outputLength];
    int signalLeft = 0;
    int signalRight = 1;
    int filterLeft = 0;
    int filterRight = 1;
    int outputIndex = 0;
    while (signalLeft < signalLength)
    {
        int indexWidth = signalRight - signalLeft;

        // I sure hope I've interpretted your question correctly.
        // I recommend you read over this loop
        // carefully to ensure it matches your understanding of the problem at hand.
        output[outputIndex] = 0;
        int j = 0;
        while (j < indexWidth)
        {
            output[outputIndex] += signal[signalLeft + j] * 
                                   filter[filterRight - j - 1];

            ++j;
        }

        // The left and right indexes will start the loop 1 index apart
        // The right indexes will increment until the distance between
        //    left and right is equal to the length of the filter array.
        // Then, the signal indexes will increment until the right signal
        //   index is equal to the length of the signal array.
        // Then, both left indexes will increment until the left and right
        //   indexes are again 1 index apart.
        if (filterRight < filterLength)
        {
            ++signalRight;
            ++filterRight;
        }
        else if (signalRight < signalLength)
        {
            ++signalLeft;
            ++signalRight;
        }
        else
        {
            ++signalLeft;
            ++filterLeft;
        }

        ++outputIndex;
    }

    for (i = 0; i < outputLength; ++i)
    {
            cout << i << ": " << output[i] << endl;
    }

    char dummy;
    cin >> dummy;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T02:29:48.773

```
int newLength = fSize1 + fSize2 - 1;

int *array3 = new int[newLength];
int count = 0;

// initialize all array3 value to 0
for(int k = 0; k<newLength; k++)
{
    array3[k] = 0;
}

for(int i = 0; i<newLength; i++)
{
    for(int j = 0; j<fSize2; j++)
    {
        // to avoid outofbound error
        if(i==0)
            array3[i] = array2[i] * array1[j];
        else
            array3[i] = array3[i- 1] + (array2[i] * array1[j]);
    }
} 
```

希望这可以帮助。

# xcode - typedef 结构中的 Objective-c 对象（在 ARC 中被禁止）

> ID：13693070
> 
> 赞同：2
> 
> 时间：2012-12-03T22:41:01.367
> 
> 标签：xcode, object, struct, automatic-ref-counting

我是 Objective-C 编程和 Xcode 的新手。我继承了一个项目的旧版本（3.2.5），最近将其转换为最新版本（4.5.2）。我将此项目转换为 ARC，但我在 typedef 结构中找到了一个objective-c 对象时遇到了问题：

```
typedef struct _BitmapFontChar {
    int charID;
    int x;
    int y;
    int width;
    int height;
    int xOffset;
    int yOffset;
    int xAdvance;
    Image * image; // Objective-C object in struct forbidden in ARC
    float scale;
} BitmapFontChar; 
```

当我尝试使用`__unsafe __unretained_`它时，它在 ARC 中编译得很好，但该项目不再工作了。当然，*image 对象没有保留，我的项目崩溃了。

结构体的使用如下：

```
@interface BitmapFont : NSObject {

    GameController * sharedGameController;
    Image * image;
    BitmapFontChar * charsArray; // typedef struct
    int commonHeight;
    Color4f fontColor;
}​
...

charsArray = calloc(kMaxCharsInFont, sizeof(BitmapFontChar)); 
```

如何将此代码转换为可以保留`*image`对象但也可以在 ARC 中使用的代码？

编辑：好的，我使用 CFTypeRef 使用 Jano 的建议。我仍然在同一行代码中遇到相同的崩溃（EXC_BAD_ACCESS）。我想我没有正确使用 CFBridgingRetain 。下面是我的 .h 文件：

```
#import "Global.h"

@class Image;
@class GameController;

#define kMaxCharsInFont 223

typedef struct _BitmapFontChar {
    int charID;
    int x;
    int y;
    int width;
    int height;
    int xOffset;
    int yOffset;
    int xAdvance;
    CFTypeRef image;
    float scale;
} BitmapFontChar;

enum {
    BitmapFontJustification_TopCentered,
    BitmapFontJustification_MiddleCentered,
    BitmapFontJustification_BottomCentered,
    BitmapFontJustification_TopRight,
    BitmapFontJustification_MiddleRight,
    BitmapFontJustification_BottomRight,
    BitmapFontJustification_TopLeft,
    BitmapFontJustification_MiddleLeft,
    BitmapFontJustification_BottomLeft
};

@interface BitmapFont : NSObject {

    GameController *sharedGameController;
    Image *image;
    BitmapFontChar *charsArray;
    int commonHeight;
    Color4f fontColor;
}

@property(nonatomic, strong) Image *image;
@property(nonatomic, assign) Color4f fontColor;

- (id)initWithFontImageNamed:(NSString*)aFileName ofType:(NSString*)aFileType 
  controlFile:(NSString*)aControlFile scale:(Scale2f)aScale filter:(GLenum)aFilter;

- (id)initWithImage:(Image *)aImage controlFile:(NSString *)aControlFile 
  scale:(Scale2f)aScale filter:(GLenum)aFilter;

-(void)renderStringAt:(CGPoint)aPoint text:(NSString*)aText;

-(void)renderStringJustifiedInFrame:(CGRect)aRect justification:(int)aJustification 
  text:(NSString*)aText;

-(int)getWidthForString:(NSString*)string;
-(int)getHeightForString:(NSString*)string;

@end 
```

下面是我的 .m 文件的一部分，其中包含发生崩溃的方法和代码行：

```
-(void)renderStringAt:(CGPoint)aPoint text:(NSString*)aText {
    float xScale = image.scale.x;
    float yScale = image.scale.y;

    for(int i=0; i<[aText length]; i++) {

        unichar charID = [aText characterAtIndex:i] - 32;

        int y = aPoint.y + (commonHeight * yScale) - (charsArray[charID].height 
            + charsArray[charID].yOffset) * yScale;
        int x = aPoint.x + charsArray[charID].xOffset;
        CGPoint renderPoint = CGPointMake(x, y);

        CFTypeRef vpImage = CFBridgingRetain(image); //???
        ((__bridge Image *)(charsArray[charID].image)).color = fontColor;//CRASH EXC_BAD_ACCESS

        [((__bridge Image *)(charsArray[charID].image)) renderAtPoint:renderPoint];

        aPoint.x += charsArray[charID].xAdvance * xScale;
    }
} 
```

再次感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:51:59.533

使用`__unsafe_unretained`并重新引入该特定结构字段的显式保留/释放。大概这以前有效，所以今天没有理由不能工作。

当然，ARC 不允许你调用`-retain`and `-release`。但它确实允许你调用`CFRetain()`and `CFRelease()`，当在 obj-c 对象上调用时它会做同样的事情。

或者，如果您想将代码转换为 Obj-C++，您可以`__strong`在 C++ 结构中嵌入对象，编译器将为您生成正确的析构函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:45:05.963

> 如何将此代码转换为可以保留 *image 对象但也可以在 ARC 中使用的代码？

一种方法是转换`struct _BitmapFontChar`为适当的 Objective-C 类。然后引用其他 Obj-C 对象就可以了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T23:38:54.030

What Kevin and Caleb said.

Since I wanted to try this myself here is a small example for CodeRunner:

```
#import <Foundation/Foundation.h>
int main(int argc, char *argv[]) {
    @autoreleasepool {

        typedef struct _person {
            char name[25];
            CFTypeRef avatar;
        } person;

        NSObject *avatar = [NSObject new];
        CFTypeRef vpAvatar = CFBridgingRetain(avatar);
        person carol = { "Carol", vpAvatar }; 

        CFBridgingRelease(carol.avatar);
    }
} 
```

CFRefType is just a void* which is the alternative to __unsafe_unretained, and the CFBridging functions cast an Objc pointer to Core Foundation (CFBridgingRetain) and back (CFBridgingRelease).

The easiest thing seems to be creating a lightweight object and let ARC handle it.

# ajax - 如何使用 mongoose.js 合并更新文档？

> ID：13693080
> 
> 赞同：4
> 
> 时间：2012-12-03T22:41:49.257
> 
> 标签：ajax, node.js, mongodb, express, mongoose

我有一个带有模式的模型：

```
schema = new Schema({
    name: String,
    sections: [{
        name: String,
        columns: [{
            name: String      
        }]
    }]
}];

//Lets call the model a Page 
```

为简单起见，我检索整个模型：

```
app.get('/page/:name', function(req, res){
    Page.findOne( {name: req.params.name}, function(err, page){
        //error handling
        res.send page
    });
}); 
```

通过请求 GET /page/myPage 我收到：

```
{
    //_id, __v, etc..
    name: 'myPage',
    sections: [{
        name: 'Section 1',
        columns [{
            name: 'My #1 Column'
        }]
    }]
} 
```

我将第 0 列名称更改为 My #1 Column FOOBAR！在客户端

```
{
    //_id, __v, etc..
    name: 'myPage',
    sections: [{
        name: 'Section 1',
        columns [{
            name: 'My #1 Column FOOBAR!'
        }]
    }]
} 
```

另一个用户添加了一个名称为“我的 #2 列！！！”的列

```
 {
        //_id, __v, etc..
        name: 'myPage',
        sections: [{
            name: 'Section 1',
            columns [{
                name: 'My #1 Column'
            },
            {
                name: 'My #2 Column!!!'
            }]
        }]
    } 
```

两个用户都将整个不同步的 JSON 发布到服务器。我想合并它们。

这是我目前的保存方法：

```
app.post('/page/save', function(req, res) {
  var newPage = req.body.page;

  Page.findOne({
    _id: newPage._id
  }, function(err, page) {
    if (err) {
      return res.send(err);
    }

    // this portion is obviously problematic as it doesn't merge the objects
    // it simply overwrites it with whatever page JSON you received at the time
    // of the request.
    page.sections = newPage.sections;

    page.save(function(err) {
      if (err) {
        res.send(err);
      } else {
        res.send('success!');
      }
    });

  });
}); 
```

我是否需要创建自己的更新队列，首先从服务器检索最新文档，将文档合并在一起，然后保存它们。或者这是由 mongodb 处理的。

另外，是否有像更新这样的简单方法，将旧对象与新对象合并并保存？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-03-02T14:15:20.830

我这样做：

```
.put('/:pr_id', (req, res, next) => {
      let pr_id = req.params.pr_id;

      PR.findById(pr_id, (err, doc) => {
        if (err) {
          return res.status(500).json({error: err});
        }
        if (!doc){
          return res.status(404).json({error: 'Document not found'});
        }

        let updated = req.body.pr;
        Object.assign(doc, updated);

        doc.save((err) => {
          if (err) {
            return res.status(500).json({error: err});
          }

          res.json(doc);
        });
      }); 
```

Object.assign 基本上合并了两个对象（[https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-06-25T21:33:33.937

[`_.merge`](https://lodash.com/docs#merge)方法可以使用一个警告：你不能合并一个猫鼬文档，它必须是一个普通的对象，可以找到`.lean()`或转换为`.toObject()`

```
Model.update({
  _id: doc._id
}, {
  $set: _.merge(doc.toObject(), {
    stuff: {
      hello: 'world'
    }
  })
}) 
```

# javascript - 使用带有 Twitter Bootstrap 按钮的 wysihtml5 工具栏

> ID：13693082
> 
> 赞同：3
> 
> 时间：2012-12-03T22:41:52.660
> 
> 标签：javascript, css, twitter-bootstrap, wysiwyg, wysihtml5

我正在尝试将 twitter 引导按钮与 wysihtml5 工具栏一起使用。我的简单问题是按钮上的 CSS 与工具栏`exec()`命令相反。因此，我单击粗体按钮，按钮获取活动状态类，但文本不会变为粗体，直到单击第二个按钮，此时按钮失去其活动状态。所以 CSS 和 JS 是异相的。

想法？

`.btn`这是 HTML，如果其中包含 wyishtml5.js 和 bootstrap.js 文件（切换's get `.active`CSS 类），这实际上是 JS 方面所需的全部内容。

另外，这里的[jsfiddle](http://jsfiddle.net/trpeters1/VVEuc/5/)还没有完全证明这个问题，但我现在正在处理它。

```
<span class="btn-group" data-toggle="buttons-checkbox" >
  <a data-wysihtml5-command="bold" title="Bold" class="btn" ><span class="icon-darkGray txt18" ><b>B</b></span></a> 
  <a data-wysihtml5-command="italic" title="Italics" class="btn" ><span class="icon-darkGray txt18" style="font-style:italic">I</span></a>
  <a data-wysihtml5-command="underline" title="Underline" class="btn" ><span class="icon-darkGray txt18" style="text-decoration:underline">U</span></a>
</span> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T00:06:53.837

我回答了我自己的问题。与其尝试在这些按钮上使用 twitter bootstrap JS，不如使用 wysihtml5 JS 行为，它将类添加`wysihtml5-command-active`到任何活动按钮。

因此，要设置这些按钮的样式，您需要添加 reset.css 文件是以下 CSS：

```
.wysihtml5-action-active, .wysihtml5-command-dialog-opened,
.wysihtml5-command-active {
  box-shadow: inset 0 1px 6px rgba(0, 0, 0, 0.2);
  background: #eee !important;
} 
```

因此，您不需要 twitter bootstrap.js 数据属性：`data-toggle="buttons-checkbox"`您的最终 HTML 如下所示：

```
<span class="btn-group" >
  <a data-wysihtml5-command="bold" title="Bold" class="btn" ><span class="icon-darkGray txt18" ><b>B</b></span></a> 
  <a data-wysihtml5-command="italic" title="Italics" class="btn" ><span class="icon-darkGray txt18" style="font-style:italic">I</span></a>
  <a data-wysihtml5-command="underline" title="Underline" class="btn" ><span class="icon-darkGray txt18" style="text-decoration:underline">U</span></a>
</span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T12:17:23.843

您可能要考虑使用[wysihtml5-bootstrap](http://jhollingworth.github.com/bootstrap-wysihtml5/)。它已经将 wysihtml5 与 bootsrap 集成在一起，包括向`btn`按钮添加一个类。

# android - 如何获取从相机活动发送的数据？

> ID：13693087
> 
> 赞同：2
> 
> 时间：2012-12-03T22:42:11.487
> 
> 标签：android, android-camera-intent

我对 Android 编程还很陌生，我不太明白相机活动如何返回数据。我正在从视频教程中学习，但在理解某些东西时遇到了问题，所以就这样（代码中的例外）：

```
int cameraData = 0;

intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
startActivityForResult(intent, cameraData); 
```

我了解这部分以隐式意图启动 Activity 并等待 Camera 返回结果

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == RESULT_OK) {
        Bundle extras = data.getExtras();
        bmp = (Bitmap) extras.get("data");
        iv.setImageBitmap(bmp);
    }
} 
```

而这个等待接收来自该 Activity 的数据，其中

*   `requestCode`是 0 从`cameraData`
*   `resultCode`是`RESULT_OK`如果照片被拍了
*   `data`是来自相机的数据接收器

我很难理解`bmp = (Bitmap) extras.get("data");`

我应该如何确切地知道使用哪个 String 键来获取特定数据？我找不到有关相机返回结果的数据类型和形式的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:49:14.307

The [documentation](http://developer.android.com/training/camera/photobasics.html) says that the "data" key holds a thumbnail and that if you need full image you should provide a filename by calling `putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(f))` on your Intent, where f is a File.

# php - 按字母排序数组

> ID：13693100
> 
> 赞同：0
> 
> 时间：2012-12-03T22:43:08.210
> 
> 标签：php

是否可以将数组的结果输出到按字母顺序排序的 HTML 列表中。这就是我的意思。我有一个格式如下的数组：

```
$myArray = array(
    "apple" => "Fruit that grows ...", 
    "car" => "Vehicle on four...", 
    "ant" => "Insect ..."
    ...
); 
```

期望的输出：

```
<ul>A
   <li>ant</li>
   <li>apple</li>
</ul>
<ul>C
   <li>car</li>
</ul> 
```

等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:47:12.097

您可以使用以下命令按字母顺序对数组进行排序：

```
ksort($myArray); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:09:32.627

首先，按键按字母顺序对数组进行排序：

```
ksort($myArray); 
```

或者，如果您想进行不区分大小写的排序：

```
uksort($myArray, "strnatcasecmp"); 
```

然后创建一个临时数组，将所有以相同字母开头的单词分组到子数组中：

```
$arrTemp = array();
foreach($myArray as $strKey => $strValue) {
    $strLetter = strtolower( substr($strKey, 0, 1) );
    if(array_key_exists($strLetter, $arrTemp) === FALSE) {
        $arrTemp[$strLetter] = array();
    }
    array_push( $arrTemp[$strLetter], $strKey );
} 
```

最后，渲染 HTML：

```
foreach($arrTemp as $strLetter => $arrWords) {
    print('<ul>' . strtoupper($strLetter));
    foreach($arrWords as $strWord) {
        print('    <li>' . $strWord . '</li>');
    }
    print('</ul>');
} 
```

# node.js - Express SessionID 与 Cookie 中的 SessionID 不同

> ID：13693101
> 
> 赞同：13
> 
> 时间：2012-12-03T22:43:11.537
> 
> 标签：node.js, session, express, redis, socket.io

通过使用给定的示例，我遇到了相应的问题。在示例中，通过首先重新加载会话在 WebSocket 中使用会话：

```
 socket.on('set value', function (val) {
    sess.reload(function () {
      sess.value = val;
      sess.touch().save();
    });
  }); 
```

尝试在我自己的应用程序中使用它，我得到以下异常：

```
 sess.reload(function () {
       ^
TypeError: Object #<Object> has no method 'reload' 
```

我认为问题是，没有人将变量 sess 定义为会话：

```
io.listen(app).set('authorization', function (data, accept) {
  if (!data.headers.cookie) 
    return accept('No cookie transmitted.', false);

  data.cookie = parseCookie(data.headers.cookie);
  data.sessionID = data.cookie['express.sid'];

  store.load(data.sessionID, function (err, session) {
    if (err || !session) return accept('Error', false);

    data.session = session;
    return accept(null, true);
  });
}) 
```

也许有些人对此有一个简短的解决方案？

**问题已解决：**我尝试使用此示例：[https](https://github.com/DanielBaulig/sioe-demo/blob/master/app.js) ://github.com/DanielBaulig/sioe-demo/blob/master/app.js与 Express 3.0 和 Redis。

因此我创建了一个 Redis Store (connect-redis) 而不是 MemoryStore：

```
app.use(express.session({cookie: {expires: new Date(Date.now() + 30*60*60*24*1000)}, secret: SESSION_SECRET, key: SESSION_KEY, store: new RedisStore({host:'localhost', port:'6379', client: dbRedis})})); 
```

由于连接中的 parseCookie-Method 移动了我使用

```
parseCookie = require('cookie').parse 
```

代替

```
connect.utils.parseCookie 
```

要访问 cookie 中的会话，我使用以下内容修改了示例：

```
sio.set('authorization', function (data, accept) {
  if (!data.headers.cookie) 
    return accept('No cookie transmitted.', false);

  data.cookie = parseCookie(data.headers.cookie);
  log.info('Cookie: $s', JSON.stringify(data.cookie));
  data.sessionID = data.cookie['letter.sid'];
  log.info('SessionId: %s', data.sessionID);

  dbRedis.get(data.sessionID, function (err, session) {
    if (err || !session) return accept('Error ' + session, false);

    data.session = session;
    return accept(null, true);
  });
}) 
```

现在我的问题是，我无法从 Redis 加载会话，因为会话 ID 不同 在页面上打印会话 ID (req.sessionID) 我得到：n+57bnkLr+iXkMLbStWdFzK5 但在 Redis 中存储了以下 ID：

```
[2012-12-03T22:14:56.632Z]  INFO: Postbox/78964 on capns-mba.local: Cookie: $s {"SQLiteManager_currentLangue":"4","connect.sid":"s:xvYdDm5C0MEIg53EG8JgqBnM.Tx8+PMKa570zk6qt9vmCjRz2p/LP/COyyqGSm+VKxww","letter.sid":"s:n+57bnkLr+iXkMLbStWdFzK5.XPHh1xXrK9D4cPfJ7HcHO11PKk8FXLg6fIRGaWb/+jI"}
[2012-12-03T22:14:56.632Z]  INFO: Postbox/78964 on capns-mba.local: SessionId: s:n+57bnkLr+iXkMLbStWdFzK5.XPHh1xXrK9D4cPfJ7HcHO11PKk8FXLg6fIRGaWb/+jI 
```

显然 req.sessionID 是保存在 cookie/redis 中的 SessionID 的一部分——但是为什么呢？哪个是正确的 sessionID？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-03T23:00:56.380

查看[会话中间件](https://github.com/senchalabs/connect/blob/master/lib/middleware/session.js)中的这段代码（第 267 行）：

```
var val = 's:' + signature.sign(req.sessionID, secret); 
```

其中`signature.sign`function 是一个连接（伪代码）：

```
req.sessionID + "." + hash(secret) 
```

`hash`自定义函数在哪里（[有关详细信息，请参阅此内容](https://github.com/visionmedia/node-cookie-signature/blob/master/index.js)）。

这意味着它只是 cookie 的签名约定（使其更安全）。您可以通过调用来检索您的 sid：

```
var signature = require( "cookie-signature" ),
    prefix = "s:";

var real_sid = sid.replace( prefix, "" );
real_sid = signature.unsign( real_sid, SESSION_SECRET ); 
```

# .net - 是否有任何宏可以在 Visual Studio 中获取 TFS Sourcecontrol 的根目录？

> ID：13693102
> 
> 赞同：2
> 
> 时间：2012-12-03T22:43:18.943
> 
> 标签：.net, visual-studio-2010, tfs, post-build-event, visual-studio-macros

是否有任何内置宏来获取 Visual Studio 中的 TFS Sourcecontrol 根目录？

例如就像 $(ProjectDir)，我会使用 $(TFSSourceControlRoot) 或类似的东西吗？

我需要这个的原因是为了在 xcopy 命令中使用这个路径，我需要它作为构建后操作的一部分。我不想写像 C:\Source\Scripts 这样的东西，而是想写像 $(TFSSourceControlRootDir)\Source\Scripts 这样的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:50:21.233

*如果您指的是服务器*上文件夹结构的根目录，那么您可以简单地引用它`$/`。但是，如果您指的是映射到的本地文件夹，则没有宏。原因是您可以将服务器层次结构中的任意数量的文件夹映射到本地磁盘文件夹，因此不一定有一个根目录 - 也不一定有一个文件夹可以映射到`$/`。

（也就是说，如果您能解释为什么需要它，可能会有其他建议......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-20T21:11:38.460

对于较新的搜索者，我发现了这个[构建变量 page](https://www.visualstudio.com/en-us/docs/build/define/variables)，这是特定于 TFS 2015 的，但它具有：

> BUILD_SOURCESDIRECTORY
> 
> 下载源代码文件的代理上的本地路径。例如：c:\agent_work\1\s。

# matlab - 将 mat 文件加载到 matlab 并稍后在 .m 文件中使用变量

> ID：13693104
> 
> 赞同：1
> 
> 时间：2012-12-03T22:43:36.400
> 
> 标签：matlab, matlab-load

我只想将很多.mat文件（a1.mat，a2.mat.....）中的一些变量加载到.m文件中，并将它们用作函数。这是我的代码

```
files=dir('a*.mat'); 
numfiles=length(files);

for k=1:numfiles
filename=files(k).name;
data=load(filename,'Name','Age','Country');
end

data_jan_name=[data.Name] 
```

但是，它总是返回一条错误消息：

```
??? Undefined variable "data" or function "data.Name". 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:50:50.047

这一切看起来都不错。我会检查它是否真的通过 for 循环运行。让它打印出文件名。否则，文件中可能不存在这些变量`Name, Age and Country`，所以也可以让它打印数据。

如果您向我们展示常规 a.mat 文件的外观，我可以扩展此答案。

# javascript - jQuery滚动到特定元素上方一定数量的像素（或其他单位）

> ID：13693106
> 
> 赞同：1
> 
> 时间：2012-12-03T22:43:40.953
> 
> 标签：javascript, jquery

我有一个滚动到特定元素的页面。问题是，页面一直滚动到元素的顶部......我想在页面顶部和元素之间有一点“缓冲区”。我目前正在做：

`$("html,body").animate({scrollTop: $("#elementID").offset().top},"slow");`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:48:57.343

杰兹：`$("html,body").animate({scrollTop: $("#elementID").offset().top - 300},"slow");`

# localhost - 我应该将本地主机的文件上传到哪里？

> ID：13693107
> 
> 赞同：0
> 
> 时间：2012-12-03T22:43:42.560
> 
> 标签：localhost

我已经在我的系统（Windows XP Service Pack 3）上安装了 XAMPP，并且我已经全部运行了，但是我找不到将文件放到 localhost 的位置。假设我正在我的本地主机上创建一个网站。我将这些文件放在哪个目录中？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:48:16.207

根据 XAMPP 网站 -[问题 2：我应该将我的 Web 内容放在哪里？](http://www.apachefriends.org/en/xampp-windows.html#1168)

> 所有 WWW 文档的主目录是 \xampp\htdocs。如果您将文件“test.html”放在此目录中，则可以使用 URI“http://localhost/test.html”访问它。

# sql-server - 如何在sql server中使用闭包表获取极左和右叶节点

> ID：13693108
> 
> 赞同：2
> 
> 时间：2012-12-03T22:43:44.170
> 
> 标签：sql-server, closures

```
CREATE TABLE [dbo].[Nodes](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Data] [nvarchar](50) NOT NULL,
    [ParentId] [int] NULL,
    [Position] [char](1) NULL,
    CONSTRAINT [PK_Customer] PRIMARY KEY CLUSTERED (
    [Id] ASC)
)

CREATE TABLE [dbo].[Closure](
    [ParentId] [int] NOT NULL,
    [ChildId] [int] NOT NULL,
    [PathLength] [int] NOT NULL,
    CONSTRAINT [PK_Closure] PRIMARY KEY CLUSTERED(
    [ParentId] ASC,
    [ChildId] ASC )
) 
```

我需要做的是为特定节点获取最右边的节点。

对查询有任何帮助来解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T12:11:03.203

**假设**

1.  `Nodes.Position`确定子节点在父节点下的位置，并且是父节点唯一的，而不是全局唯一的。
2.  的值`Nodes.Position`不是硬编码的，也不是事先知道的。
3.  如果按 排序`Nodes.Position`，第一项是左边的，最后一项是右边的。
4.  *极端*节点的定义是取一个节点的最左边或最右边的子节点得到的一个节点。

**解决方案**

该解决方案仅使用`dbo.Nodes`，因为我无法找到一个解决方案，其中使用闭包表遍历树深度优先会更容易，并且在您的场景中重要的`Position`列是 on `dbo.Nodes`。您可以从中获取父子 ID`dbo.Closure`并加入`dbo.Nodes`以获取`Position`，但这只会添加一些不必要的连接。

下面的查询是针对最右边的节点，要找到最左边的节点，将排序更改为`ASC`。

```
;WITH
RecCTE AS
(
    SELECT
        Id,
        1 AS NodeLevel
    FROM
        (
            SELECT
                N.Id, 
                ROW_NUMBER() OVER (PARTITION BY N.ParentId ORDER BY N.Position DESC) AS NodeRank
            FROM 
                dbo.Nodes AS N
            WHERE
                N.ParentId = @Parent
        ) AS SQ
    WHERE
        NodeRank = 1

    UNION ALL

    SELECT
        Id,
        NodeLevel + 1 AS NodeLevel
    FROM
        (
            SELECT
                N.Id,
                R.NodeLevel,
                ROW_NUMBER() OVER (PARTITION BY N.ParentId ORDER BY N.Position DESC) AS NodeRank
            FROM 
                dbo.Nodes AS N
                INNER JOIN RecCTE AS R ON N.ParentId = R.Id
        ) AS SQ
    WHERE
        NodeRank = 1
)
SELECT 
    Id 
FROM 
    RecCTE
WHERE
    NodeLevel IN ( SELECT MAX(NodeLevel) FROM RecCTE ) 
```

**更新：嵌套集解决方案**

如果您愿意更改表结构，我建议您在这种情况下查看嵌套集方法。例如，如果您有此表（根据节点位置填充）：

```
CREATE TABLE [dbo].NestedSets
(
    Id int NOT NULL PRIMARY KEY CLUSTERED,
    LeftNum int NOT NULL,
    RightNum int NOT NULL,
    PathLength int NOT NULL
) 
```

然后找到你的最左节点应该很简单

```
SELECT
    C.Id
FROM
    dbo.NestedSets AS C
    INNER JOIN dbo.NestedSets AS P
        ON P.LeftNum < C.LeftNum AND P.RightNum > C.RightNum
WHERE
    P.Id = @Parent 
    AND C.LeftNum = C.RightNum - 1
    AND C.LeftNum = P.LeftNum + C.PathLength - P.PathLength 
```

最右节点：

```
SELECT
    C.Id
FROM
    dbo.NestedSets AS C
    INNER JOIN dbo.NestedSets AS P
        ON P.LeftNum < C.LeftNum AND P.RightNum > C.RightNum
WHERE
    P.Id = @Parent 
    AND C.LeftNum = C.RightNum - 1
    AND C.RightNum = P.RightNum - (C.PathLength - P.PathLength) 
```

我不确定在您的上下文闭包方法中是否比嵌套集更有意义，但出于此查询的目的，差异非常显着。

# stylesheet - 使用变量导入样式表

> ID：13693111
> 
> 赞同：1
> 
> 时间：2012-12-03T22:44:00.377
> 
> 标签：stylesheet, sass

我`.scss`在我的 Rails 应用程序中使用文件，之前我使用的是：

```
@import "bootswatch/superhero/variables";
@import "bootswatch/superhero/bootswatch"; 
```

但我想做类似的事情：

```
$theme: 'superhero';
@import "bootswatch/#{$theme}/variables";
@import "bootswatch/#{$theme}/bootswatch"; 
```

不幸的是，这不起作用，变量没有被嵌入。当我想更改主题时，我该如何做才能避免`application.css.scss`多次更改？

**其他没有成功的尝试**

```
@import "bootswatch/" + $theme + "/variables";

$theme_variables: "/bootswatch/#{$theme}/variables";
@import $theme_variables; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:52:08.703

看起来你不能：

> 导入可能包含 #{} 插值，但只有某些限制。无法基于变量动态导入 Sass 文件；插值仅适用于 CSS 导入。因此，它仅适用于 url() 导入。”

见[http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import)

这可能是因为它试图通过计算依赖关系来最小化导入之间的重新编译——我想动态导入会变得非常困难。

我建议每个主题都有一个主文件并导入它。

# android - 使用 /mnt/sdcard 检查文件是否存在

> ID：13693117
> 
> 赞同：0
> 
> 时间：2012-12-03T22:44:44.870
> 
> 标签：android

我和很多人一样使用 Environment.getExternalStorageDirectory().toString() 来确定 SDCard 在手机上的位置。我已经购买了 Galaxy S3，但遇到了这款手机的问题。

Environment.getExternalStorageDirectory().toString() 没有去正确的地方。（请参阅此[如何获取适用于 Android 4.0+ 的外部 SD 卡路径？](https://stackoverflow.com/questions/11281010/how-can-i-get-external-sd-card-path-for-android-4-0)）了解更多信息。

我已经使用该方法（hashset one）来计算出外部 sdcard 的路径，但是当我使用它时，它不起作用

```
HashSet<String> testing = getExternalMounts();

Iterator it = testing.iterator();

while(it.hasNext())
        {

            String value = (String)it.next();
            File file = new File(value, DB_EXPORTED_NAME);

            if(file.exists()){
                Toast.makeText(context, "File exists", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(context, "Not Found", Toast.LENGTH_SHORT).show(); 
            }
} 
```

它总是以未找到的形式出现。有人可以让我知道我哪里出错了吗

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:46:51.190

尝试 .getAbsolutePath() 函数而不是 .toString()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:53:34.143

行。这是我在晚上 11 点尝试编码。该文件位于我尚未添加到字符串中的目录中。添加它并完美运行。

```
File file = new File(value, SAVED_DIR + "\" + DB_EXPORTED_NAME); 
```

对此感到抱歉

# apache - 我的 xsl-fo 代码有什么问题

> ID：13693118
> 
> 赞同：0
> 
> 时间：2012-12-03T22:44:49.707
> 
> 标签：apache, xslt, xsl-fo, apache-fop

我正在尝试使用 apache-fop 从以下命令生成 pdf。

`C:\fop-1.0-bin\fop-1.0>fop -xml sample1.xml -xsl xsl-fo.xsl -pdf sample2.pdf`

我的 xml 看起来像这样

```
<?xml version="1.0" encoding="iso-8859-1"?>
<service>
    <serviceId>11111</serviceId>
    <openDate>2012-02-16</openDate>
    <closeDate>2012-02-16</closeDate>
    <description>INSPECT MACHINE</description>
    <repairCost>$266.76</repairCost>
</service> 
```

我的 xsl-fo xslt 文件看起来像这样

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.1"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:fo="http://www.w3.org/1999/XSL/Format"
    >
    <xsl:output encoding="iso-8859-1" />
    <xsl:template match ="Service">
        <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
            <fo:layout-master-set>
                <fo:simple-page-master master-name="Service">
                    <fo:region-body></fo:region-body>
                </fo:simple-page-master>
            </fo:layout-master-set>

            <fo:page-sequence master-reference="Service">
                <fo:flow flow-name="xsl-region-body">
                    <fo:block>
                        <fo:table>
                            <fo:table-body>
                                <fo:table-row>
                                    <fo:table-cell border="solid 1px black" 
                                    text-align="center" font-weight="bold">
                                        <fo:block>Service Id</fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px black" 
                                    text-align="center" font-weight="bold">
                                        <fo:block>Open Date</fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px black" 
                                    text-align="center" font-weight="bold">
                                        <fo:block>Close Date</fo:block>
                                    </fo:table-cell>                                    
                                    <fo:table-cell border="solid 1px black" 
                                    text-align="center" font-weight="bold">
                                        <fo:block>Order Status</fo:block>
                                    </fo:table-cell>                                    
                                    <fo:table-cell border="solid 1px black" 
                                    text-align="center" font-weight="bold">
                                        <fo:block>Description</fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px black" 
                                    text-align="center" font-weight="bold">
                                        <fo:block>Repair Cost</fo:block>
                                    </fo:table-cell>
                                </fo:table-row>
                                <xsl:for-each select="./servicetype">
                                    <fo:table-row>
                                        <fo:table-cell border="solid 1px bold" text-align="center">
                                            <fo:block><xsl:value-of select="serviceId" /></fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="solid 1px bold" text-align="center">
                                            <fo:block><xsl:value-of select="openDate" /></fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="solid 1px bold" text-align="center">
                                            <fo:block><xsl:value-of select="closeDate" /></fo:block>
                                        </fo:table-cell>                                

                                        <fo:table-cell border="solid 1px bold" text-align="center">
                                            <fo:block><xsl:value-of select="description" /></fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="solid 1px bold" text-align="center">
                                            <fo:block><xsl:value-of select="repairCost" /></fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:for-each>
                            </fo:table-body>
                        </fo:table>
                    </fo:block>
                </fo:flow>
            </fo:page-sequence>
        </fo:root>
    </xsl:template>
</xsl:stylesheet> 
```

我收到错误。有人可以指出我在代码中的错误。我正在关注这个例子[http://www.codeproject.com/Articles/37663/PDF-Generation-using-XSLFO-and-FOP](http://www.codeproject.com/Articles/37663/PDF-Generation-using-XSLFO-and-FOP)

```
SEVERE: org.apache.fop.fo.ValidationException: Document is empty (something migh
t be wrong with your XSLT stylesheet).
Dec 3, 2012 4:27:27 PM org.apache.fop.cli.Main startFOP
SEVERE: Exception
javax.xml.transform.TransformerException: org.apache.fop.fo.ValidationException:
 Document is empty (something might be wrong with your XSLT stylesheet).
        at org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:302)
        at org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:130)
        at org.apache.fop.cli.Main.startFOP(Main.java:174)
        at org.apache.fop.cli.Main.main(Main.java:205)
Caused by: javax.xml.transform.TransformerException: org.apache.fop.fo.Validatio
nException: Document is empty (something might be wrong with your XSLT styleshee
t).
        at org.apache.xalan.transformer.TransformerImpl.transformNode(Transforme
rImpl.java:1430)
        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp
l.java:709)
        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp
l.java:1284)
        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp
l.java:1262)
        at org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:299)
        ... 3 more
Caused by: org.apache.fop.fo.ValidationException: Document is empty (something m
ight be wrong with your XSLT stylesheet).
        at org.apache.fop.events.ValidationExceptionFactory.createException(Vali
dationExceptionFactory.java:38)
        at org.apache.fop.events.EventExceptionManager.throwException(EventExcep
tionManager.java:54)
        at org.apache.fop.events.DefaultEventBroadcaster$1.invoke(DefaultEventBr
oadcaster.java:175)
        at $Proxy0.emptyDocument(Unknown Source)
        at org.apache.fop.fo.FOTreeBuilder.endDocument(FOTreeBuilder.java:158)
        at org.apache.xml.serializer.ToXMLSAXHandler.endDocument(ToXMLSAXHandler
.java:181)
        at org.apache.xalan.transformer.TransformerImpl.transformNode(Transforme
rImpl.java:1378)
        ... 7 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:56:22.427

尝试更改 foreach 中的 xpath

```
<xsl:for-each select="./service"> 
```

xml:

```
<?xml version="1.0" encoding="iso-8859-1"?>
<services>
    <service>
        <serviceId>11111</serviceId>
        <openDate>2012-02-16</openDate>
        <closeDate>2012-02-16</closeDate>
        <orderStatus>Status2</orderStatus>
        <description>INSPECT MACHINE</description>
        <repairCost>$266.76</repairCost>
    </service>
    <service>
        <serviceId>11111</serviceId>
        <openDate>2012-02-16</openDate>
        <closeDate>2012-02-16</closeDate>
        <orderStatus>Status1</orderStatus>
        <description>INSPECT MACHINE</description>
        <repairCost>$266.76</repairCost>
    </service>
</services> 
```

xsl:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.1"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:fo="http://www.w3.org/1999/XSL/Format">
<xsl:output encoding="iso-8859-1" />
<xsl:template match ="services">
    <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
        <fo:layout-master-set>
            <fo:simple-page-master master-name="service">
                <fo:region-body></fo:region-body>
            </fo:simple-page-master>
        </fo:layout-master-set>

        <fo:page-sequence master-reference="service">
            <fo:flow flow-name="xsl-region-body">
                <fo:block>
                    <fo:table>
                        <fo:table-body>
                            <fo:table-row>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Service Id</fo:block>
                                </fo:table-cell>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Open Date</fo:block>
                                </fo:table-cell>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Close Date</fo:block>
                                </fo:table-cell>                                    
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Order Status</fo:block>
                                </fo:table-cell>                                    
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Description</fo:block>
                                </fo:table-cell>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Repair Cost</fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <xsl:for-each select="./service">
                                <fo:table-row>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="serviceId" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="openDate" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="closeDate" /></fo:block>
                                    </fo:table-cell>                                
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="orderStatus" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="description" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="repairCost" /></fo:block>
                                    </fo:table-cell>
                                </fo:table-row>
                            </xsl:for-each>
                        </fo:table-body>
                    </fo:table>
                </fo:block>
            </fo:flow>
        </fo:page-sequence>
    </fo:root>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:44:44.473

会不会像案件的问题一样简单？您的示例 XML`<service>`用作根标记，但您有`<xsl:template match="Service">`（大写 S）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-18T08:39:20.717

FOP 不支持自动表格布局，而是使用固定表格布局

FOP 不支持自动布局，因为页面具有静态宽度 [A4, A3...] 仅在 html 渲染中支持自动模式，因为页面的大小可能会改变（取决于分辨率，调整大小窗口...）见：

```
http://mail-archives.apache.org/mod_mbox/xmlgraphics-fop-dev/200510.mbox/%3C20051005124250.8A19A21E@ajax.apache.org%3E

http://wiki.apache.org/xmlgraphics-fop/Troubleshooting/CommonLogMessage 
```

注意：为避免警告，您应该指定 table-layout="fixed" ，并在定义列 widht 时使用 width="100%" 和 "*"

# asp.net-mvc - 在外键上创建聚集索引是个好主意吗？

> ID：13693122
> 
> 赞同：1
> 
> 时间：2012-12-03T22:45:08.613
> 
> 标签：asp.net-mvc, sql-server-2008

我有一个登录表，其中有一个身份字段“Id”作为主键（集群），以及其他字段，如电子邮件、密码等。我将使用此表的唯一时间是对用户进行身份验证。之后我将永远查询其他表，如 user_profile、user_comments 等，这些表具有登录表的外键 Login_id。我的问题是，将 user_profile 和 user_comments 表中的 Login_id 设为聚集索引是否是个好主意？我不会对 Login 表进行任何连接，因为在用户成功通过身份验证后，我会将 LoginId 保留在 FormsAuthentication.SetAuthCookie 中，以便将来查询子表。

我正在使用 C# 和 .Net 开发一个 Web 应用程序。

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:00:42.730

由于您将不断使用 Login_id 从 user_profile 和 user_comments 获取数据，并且假设在这些表中使用 login_id 进行的这些搜索将比在这些表中的任何其他列（如 Id）更频繁，那么 "login_id" 应该是聚集索引的。基本上，您会希望在查询最多的列上使用聚集索引。它可以是两列，例如“名字”和姓氏。来自 MSDN

> 用尽可能少的列定义聚集索引键很重要。如果定义了较大的聚集索引键，则在同一个表上定义的任何非聚集索引都将显着增大，因为非聚集索引条目包含聚集键。将 SQL 脚本保存到可用空间不足的磁盘时，索引优化向导不会返回错误。

# c# - 最大化远程 IE 浏览器

> ID：13693124
> 
> 赞同：0
> 
> 时间：2012-12-03T22:45:18.010
> 
> 标签：c#, selenium, webdriver, virtual-machine, microsoft-test-manager

一段时间以来，我一直在远程 XP 客户端上运行测试。我的测试是使用 Selenium 的 WebDriver（版本 2.20.0）和 IE 驱动程序（版本 2.20.1.0）用 C# 编写的，这些测试在 Microsoft 实验室管理管理的 XP 客户端上远程运行。

我的问题是，在创建 IE 浏览器时，我无法通过 Selenium 调用在客户端上最大化它。相反，我正在手动尝试以下操作：

```
_driver.Manage().Window.Size = new Size(System.Windows.Forms.Screen.PrimaryScreen.WorkingArea.Width, System.Windows.Forms.Screen.PrimaryScreen.WorkingArea.Height); 
```

连同*WorkingArea*我也尝试过*Bounds*，但无济于事，因为两者都增加了窗口大小，但没有将其正确定位到中心。我认为这是因为 VM 没有监视器，因此无法知道实际分辨率？我只想调用一些将窗口“最大化”到全屏而不指定大小的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T11:46:21.053

由于您正在远程运行测试，并且您需要在客户端调整窗口大小。我建议你通过 JavaScript 注入来实现。

最好的事情......它在客户端执行，所以不用担心。在 JavaScript 中，我首先将窗口移动到 (0,0) 轴，然后将窗口屏幕最大化到最大可用（宽度，高度）。

这是代码...在 C# 中

```
 IWebDriver driver = new InternetExplorerDriver();
    driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10));
    driver.Navigate().GoToUrl("http://www.google.com");

    IJavaScriptExecutor JSDriver = (IJavaScriptExecutor)driver;

    JSDriver.ExecuteScript("window.moveTo(0, 0)");
    JSDriver.ExecuteScript("window.resizeTo(screen.availWidth, screen.availHeight);"); 
```

我希望这会有所帮助......一切顺利

# java - setNull 和 setInt 在这个语句中做了什么？

> ID：13693125
> 
> 赞同：0
> 
> 时间：2012-12-03T22:45:20.947
> 
> 标签：java, sql, jdbc

我想知道以下代码段中的 setNull 和 setInt 方法中的输入参数引用了什么。什么是参数索引。SQL 类型是什么，我如何从数据库列/数据中确定它？

公共无效测试QUERY_UPDATEPORTFOLIO（）抛出异常{

```
 UnitTestHelper helper = new UnitTestHelper();
    Connection con = helper.getConnection(helper.sourceDBUrl);
    Connection conTarget = helper.getConnection(helper.targetDBUrl);

    PreparedStatement stmt = con.prepareStatement(TRScheduleStatusCalculator.QUERY_UPDATEPORTFOLIO);
    stmt.setNull(1,Types.INTEGER);
    stmt.setInt(2,2290);
    ResultSet sourceVal = stmt.executeQuery();

    stmt = conTarget.prepareStatement(TRScheduleStatusCalculator.QUERY_UPDATEPORTFOLIO);
    stmt.setNull(1,Types.INTEGER);
    stmt.setInt(2,2290);
    ResultSet targetVal = stmt.executeQuery();

    assertTrue(helper.resultSetsEqual(sourceVal,targetVal));

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:47:02.063

[setNull](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull%28int,%20int%29)方法允许您将JDBC/SQL NULL 值作为 IN 参数发送到数据库。

请参阅此[线程](https://stackoverflow.com/questions/4243513/why-does-preparedstatement-setnull-requires-sqltype)以了解更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:47:28.803

[PreparedStatement.setnull(paraIndex, SQLType)](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull%28int,%20int%29)将指定占位符的**SQL varchar**类型设置为**Null**。 [stmt.setInt(2,2290);](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setInt%28int,%20int%29) 在第二个占位符处设置一个 int 值 2290 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T22:47:54.287

将值设置为空：[http ://www.java2s.com/Code/Java/Database-SQL-JDBC/DemoPreparedStatementSetNullforintvaluecolumn.htm](http://www.java2s.com/Code/Java/Database-SQL-JDBC/DemoPreparedStatementSetNullforintvaluecolumn.htm)

这是非常常见的做法，您可以为数据库表中的特定列明确设置 null

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T22:48:58.597

setNull() 调用将为第一个占位符提供 null 值。

setInt() 调用将值 2290 分配给第二个占位符。

您需要检查 QUERY_UPDATEPORTFOLIO 以找到占位符（问号）以确定它们在您的数据库中对应的内容。

# jboss - Jboss 7 中的错误 listenerStart

> ID：13693128
> 
> 赞同：2
> 
> 时间：2012-12-03T22:45:38.627
> 
> 标签：jboss, jboss7.x

我正在使用 JBoss 7。它是 spring hibernate 应用程序。我正进入（状态

```
ERROR [org.apache.catalina.core.StandardContext] (MSC service thread 1-1) Error listenerStart 
```

当我重新启动我的 JBoss 时。早些时候我在tomcat中遇到了这个问题，但通过添加`logging.porpeties`classes文件夹解决了这个问题。我能够看到哪个侦听器在 tomcat 中引起问题。但在 JBoss 中，我不知道如何修复它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T07:47:37.413

更新：如果您使用 JBoss EAP 6 或 AS 7.1.2+ 并且没有获得太多日志记录，那么指定系统属性可能会有所帮助`-Dorg.jboss.as.logging.per-deployment=false`：[https ://stackoverflow.com/a/14575830/14379](https://stackoverflow.com/a/14575830/14379)

问题是“Error listenerStart”是一个非常通用的错误消息。它应该出现在其他更有用的错误消息之前，但在某些情况下并非如此。

其他[人](https://community.jboss.org/message/762525#762525)已经通过从 war 文件或其中的 jar 中删除来解决日志记录问题，因此在 JBoss AS 7 上部署时`log4j.properties`尝试省略。`log4j.properties`

就我而言，没有`log4j.properties`删除。我发现的唯一解决方法是`org.apache.catalina.core.StandardContext.contextListenerStart()`在它调用的地方设置一个断点`getLogger().error()`，然后在部署我的 war 文件时以调试模式运行 JBoss。然后我可以检查一下`Throwable`，看看出了什么问题。

在 Eclipse 中，我配置了一个 Debug Detail Formatter（在 Preferences 中），`java.lang.Throwable`它返回堆栈跟踪：

```
java.io.StringWriter sw = new java.io.StringWriter();
this.printStackTrace(new java.io.PrintWriter(sw));
return sw.toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:55:47.420

如果您正在部署 EAR，请尝试单独部署 WAR，因为 JBoss 将显示有关错误的更多信息。

# android - WebView 链接突出显示出现在某些设备上，而不是在其他设备上

> ID：13693129
> 
> 赞同：3
> 
> 时间：2012-12-03T22:45:50.703
> 
> 标签：android, android-webview

由于点击链接的反馈很重要，我希望这在所有设备上都发生。我尝试在 CSS 中设置`-webkit-tap-highlight-color`和设置，`-webkit-focus-ring-color`但它对我的 4.0.4 设备没有影响。我的几个测试人员报告说它可以在他们的设备上运行，所以这似乎是一个特定于设备的问题。我该如何强制 WebView 突出显示，最好（但不是必需）以一种可以由标题中的 CSS 自定义的方式？

我的应用程序可能加载的示例页面：http: [//pastebin.com/UQCVhZEX](http://pastebin.com/UQCVhZEX)

# java - Java 中的 SOAP XML 请求 (KSOAP2)

> ID：13693131
> 
> 赞同：0
> 
> 时间：2012-12-03T22:45:55.553
> 
> 标签：java, android, ksoap2, android-ksoap2, ksoap

我们在制定对仅使用 XML 协议的远程 API 的请求时遇到问题。我们使用 Apache CXF 项目将 WSDL 文件解析为可轻松导入到我们项目中的类型（.java 文件）。在 CXF 上使用默认参数 none。

我们不确定如何让 KSOAP2 根据接收到的类型来格式化 XML。任何帮助是极大的赞赏。

凯文

```
public class SOAPRequestTest {

    private static final String NAMESPACE = "http://schemas.xmlsoap.org/soap/envelope/"; 
    private static final String SERVER_HOST = "https://xx.xx.xx.xx/services/LoginService";
    private static final String SERVER_METHOD = "urn:LoginService";

    public void execute() {
        Logger.d("--> Hello");

        new Thread(new Runnable() {
            @Override
            public void run() {
                SoapObject request = new SoapObject(NAMESPACE, SERVER_METHOD);
                GetSecurityInfo getSecurityInfo = new GetSecurityInfo();

                SecurityLogin securityLogin = new SecurityLogin();
                securityLogin.setUserId("testUser");
                securityLogin.setPassword("password");
                securityLogin.setType("consumer");
                securityLogin.setIP("128.2.20.181");
                securityLogin.setLocale("en_US");

                getSecurityInfo.setUser(securityLogin);

                request.addAttribute("user", getSecurityInfo);

                SoapSerializationEnvelope soapSerializationEnvelope = new SoapSerializationEnvelope(1);
                soapSerializationEnvelope.addTemplate(request);
                soapSerializationEnvelope.addMapping("http://xx.xxx.xxx.xxx", "user", GetSecurityInfo.class);

                HttpTransportSE httpTransportSE = new HttpTransportSE(SERVER_HOST);

                httpTransportSE.debug = true;

                try {
                    httpTransportSE.call("getSecurityInfo", soapSerializationEnvelope);

                    Logger.d(httpTransportSE.requestDump);

                    SoapObject soapObject = (SoapObject) soapSerializationEnvelope.getResponse();
                } catch (Exception e) {
                    e.printStackTrace();
                }

            }
        }).start();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T18:42:49.417

这可能会有所帮助，您可以通过以下方式解析 xml

```
public ArrayList<OrderBills> getOrderBills(SoapObject result)
    {       
        ArrayList<OrderBills> list=new ArrayList<OrderBills>();

        for(int i=0;i<result.getPropertyCount();i++)
        {   
            OrderBills orderBill=new OrderBills();

            orderBill.setOrderId(Integer.parseInt(((SoapObject)result.getProperty(i)).getProperty(0).toString()));  
            orderBill.setTableNo(((SoapObject)result.getProperty(i)).getProperty(1).toString());
            orderBill.setBillStatus(((SoapObject)result.getProperty(i)).getProperty(2).toString());
            orderBill.setDate(((SoapObject)result.getProperty(i)).getProperty(3).toString());
            orderBill.setTime(((SoapObject)result.getProperty(i)).getProperty(4).toString());

            list.add(orderBill);
        }
        return list;

    } 
```

# mysql - 将两个表组合在一起以获取所有列，但我需要单独的数据行而不是一行

> ID：13693133
> 
> 赞同：1
> 
> 时间：2012-12-03T22:46:07.083
> 
> 标签：mysql, sql

我需要一些帮助来确定将两个表组合成一个表的 SQL。我想合并表格并在每个表格的不同行上显示数据，但我下面的内容只显示一行。

以下是表格：

```
CREATE TABLE tenant_invoices(
  invoice_id INT,
  col1 INT,
  col2 INT
)

CREATE TABLE tenant_payments(
  pmt_invoice_id INT,
  colA INT,
  colB INT
) 
```

这是我需要创建的临时表：

```
CREATE TEMPORARY TABLE tenant_invoices
    SELECT * FROM invoices

CREATE TEMPORARY TABLE tenant_payments
    SELECT * FROM payments

select ti.*, tp.*
from tenant_invoices ti
left join tenant_payments tp
  on ti.invoice_id = tp.pmt_invoice_id
ORDER BY ti.invoice_date DESC; 
```

这导致两个表合并在一起，但只创建了一行：

```
invoice_id   col1   col2    pmt_invoice_id   colA   ColB
1            ABC    XYZ     1                111    222 
```

我希望表格能够将表格合并在一起，以便获得所有列，但是我希望将行分开而不是包含合并数据的一行，以便我可以以更合乎逻辑的方式循环遍历数据：

```
invoice_id   col1   col2    pmt_invoice_id   colA   ColB
1            ABC    XYZ     null             null   null
                            1                111    222 
```

有没有办法可以用 SQL 完成这个？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:53:11.377

为了达到这个结果...

```
invoice_id col1 col2 pmt_invoice_id colA ColB
1 ABC XYZ null null null
                            1 111 222
```

你可以`UNION ALL`这样使用：

```
SELECT invoice_id, col1, col2, NULL AS pmt_invoice_id, NULL AS colA, NULL AS col
FROM tenant_invoices
UNION ALL
SELECT NULL, NULL, NULL, pmt_invoice_id, colA, colB
FROM tenant_payments 
```

如前所述，要将两张表简单地堆叠在一起，然后对齐列并使用`UNION ALL`. 如果要删除重复项，可以使用`UNION`.

# windows - 正确删除 Windows 驱动程序中的（虚拟）设备

> ID：13693134
> 
> 赞同：1
> 
> 时间：2012-12-03T22:46:16.693
> 
> 标签：windows, kernel, driver

我正在写一个 WDM 驱动程序。它不操作任何物理设备，它是一种过滤驱动程序。我想跳过所有不相关的细节。简而言之，问题是这样的：

现在，我在例程中创建了一个设备对象 + 符号链接 ( `IoCreateDevice`+ `IoCreateSymbolicLink`) `DriverEntry`，以与用户模式组件进行通信。

我的目标是能够在需要时创建和删除设备对象。这样多个用户模式组件可以与驱动程序通信，而对于每个组件，我将有一个单独的上下文（与此设备对象相关联）。我考虑`IoDeleteDevice`在需要时创建和删除设备对象（通过）。但我在这里闻到了比赛条件。

这到底是如何与我的调度程序同步的？我的意思是，在删除设备时，我实际上可以为它处理一个 IRP（由用户模式启动）。

我发现[这篇文章](http://msdn.microsoft.com/en-us/library/windows/hardware/gg463218.aspx)描述了（至少我理解的是）这种确切的情况。

这是解决此问题的预期方法吗？

**编辑**：到目前为止，上述文章无法解决我的问题。它说我的驱动程序应该`IoAcquireRemoveLock`在启动 I/O 时调用。然而我的问题是不同的。I/O 代表用户模式 ​​-> I/O 管理器启动。所以在我到达调度程序之前我不会谈论这个。

我将以不同的方式重新表述这个问题：是否`IoDeleteDevice`立即删除设备 + 扩展程序？或者它检查设备是否仍在使用中？如果是这样 - 我应该在调用之前或之后执行扩展的清理`IoDeleteDevice`，还是应该等待`IRP_MJ_whatever`设备引用计数最终为零的意思？

提前致谢。

# excel - VBA 中的加权 Damerau-Levenshtein

> ID：13693149
> 
> 赞同：11
> 
> 时间：2012-12-03T22:47:11.490
> 
> 标签：excel, levenshtein-distance, vba

我正在为 Microsoft Office 套件构建一个私人拼写检查器。我正在对拼写错误及其潜在修复进行字符串比较，以确定我想要包含哪些更正。

我已经为字符串比较的**加权**Damerau-Levenshtein 公式寻找高低，因为我希望交换、插入、删除和替换都具有不同的权重，而不仅仅是“1”的权重，所以我可以优先考虑一些更正超过其他人。例如，错字“agmes”理论上可以更正为“games”*或*“ages”，因为两者都只需要一次编辑即可移动到正确拼写的单词，但我想给“swap”编辑一个较低的权重，所以“游戏”将显示为首选更正。

我使用 Excel 进行分析，所以我使用的任何代码都需要在 Visual Basic for Applications (VBA) 中。我能找到的最好的是[this example](https://github.com/KevinStern/software-and-algorithms/blob/master/src/main/java/blogspot/software_and_algorithms/stern_library/string/DamerauLevenshteinAlgorithm.java)，它看起来很棒，但它是用Java编写的。我尽力转换，但我远非专家，需要一点帮助！

任何人都可以查看附加的代码并帮助我找出问题所在吗？

谢谢你！

编辑：我让它自己工作。这是 VBA 中的加权 Damerau-Levenshtein 公式。它使用 Excel 的内置数学函数进行一些评估。在将错字与两个可能的更正进行比较时，成本*最高的更正是首选词。*这是因为两次交换的成本必须大于删除和插入的成本，如果您分配具有最低成本的交换（我认为这是理想的），这是不可能的。如果您需要更多信息，请查看 Kevin 的博客。

```
Public Function WeightedDL(source As String, target As String) As Double

    Dim deleteCost As Double
    Dim insertCost As Double
    Dim replaceCost As Double
    Dim swapCost As Double

    deleteCost = 1
    insertCost = 1.1
    replaceCost = 1.1
    swapCost = 1.2

    Dim i As Integer
    Dim j As Integer
    Dim k As Integer

    If Len(source) = 0 Then
        WeightedDL = Len(target) * insertCost
        Exit Function
    End If

    If Len(target) = 0 Then
        WeightedDL = Len(source) * deleteCost
        Exit Function
    End If

    Dim table() As Double
    ReDim table(Len(source), Len(target))

    Dim sourceIndexByCharacter() As Variant
    ReDim sourceIndexByCharacter(0 To 1, 0 To Len(source) - 1) As Variant

    If Left(source, 1) <> Left(target, 1) Then
        table(0, 0) = Application.Min(replaceCost, (deleteCost + insertCost))
    End If

    sourceIndexByCharacter(0, 0) = Left(source, 1)
    sourceIndexByCharacter(1, 0) = 0

    Dim deleteDistance As Double
    Dim insertDistance As Double
    Dim matchDistance As Double

    For i = 1 To Len(source) - 1

        deleteDistance = table(i - 1, 0) + deleteCost
        insertDistance = ((i + 1) * deleteCost) + insertCost

        If Mid(source, i + 1, 1) = Left(target, 1) Then
            matchDistance = (i * deleteCost) + 0
        Else
            matchDistance = (i * deleteCost) + replaceCost
        End If

        table(i, 0) = Application.Min(Application.Min(deleteDistance, insertDistance), matchDistance)
    Next

    For j = 1 To Len(target) - 1

        deleteDistance = table(0, j - 1) + insertCost
        insertDistance = ((j + 1) * insertCost) + deleteCost

        If Left(source, 1) = Mid(target, j + 1, 1) Then
            matchDistance = (j * insertCost) + 0
        Else
            matchDistance = (j * insertCost) + replaceCost
        End If

        table(0, j) = Application.Min(Application.Min(deleteDistance, insertDistance), matchDistance)
    Next

    For i = 1 To Len(source) - 1

        Dim maxSourceLetterMatchIndex As Integer

        If Mid(source, i + 1, 1) = Left(target, 1) Then
            maxSourceLetterMatchIndex = 0
        Else
            maxSourceLetterMatchIndex = -1
        End If

        For j = 1 To Len(target) - 1

            Dim candidateSwapIndex As Integer
            candidateSwapIndex = -1

            For k = 0 To UBound(sourceIndexByCharacter, 2)
                If sourceIndexByCharacter(0, k) = Mid(target, j + 1, 1) Then candidateSwapIndex = sourceIndexByCharacter(1, k)
            Next

            Dim jSwap As Integer
            jSwap = maxSourceLetterMatchIndex

            deleteDistance = table(i - 1, j) + deleteCost
            insertDistance = table(i, j - 1) + insertCost
            matchDistance = table(i - 1, j - 1)

            If Mid(source, i + 1, 1) <> Mid(target, j + 1, 1) Then
                matchDistance = matchDistance + replaceCost
            Else
                maxSourceLetterMatchIndex = j
            End If

            Dim swapDistance As Double

            If candidateSwapIndex <> -1 And jSwap <> -1 Then

                Dim iSwap As Integer
                iSwap = candidateSwapIndex

                Dim preSwapCost
                If iSwap = 0 And jSwap = 0 Then
                    preSwapCost = 0
                Else
                    preSwapCost = table(Application.Max(0, iSwap - 1), Application.Max(0, jSwap - 1))
                End If

                swapDistance = preSwapCost + ((i - iSwap - 1) * deleteCost) + ((j - jSwap - 1) * insertCost) + swapCost

            Else
                swapDistance = 500
            End If

            table(i, j) = Application.Min(Application.Min(Application.Min(deleteDistance, insertDistance), matchDistance), swapDistance)

        Next

        sourceIndexByCharacter(0, i) = Mid(source, i + 1, 1)
        sourceIndexByCharacter(1, i) = i

    Next

    WeightedDL = table(Len(source) - 1, Len(target) - 1)

End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-08T16:00:08.993

我可以看到您自己已经回答了这个问题：几年前，我为地址匹配编写了一个修改后的 Levenshtein 编辑距离算法（该站点现在托管在俄罗斯，去那里是个坏主意），但这根本没有执行好吧，“通用字符串的总和”方法足以完成手头的任务：

[Excel 中使用 VBA 中简化的“编辑距离”代理的模糊匹配字符串](http://excellerando.blogspot.com/2010/03/vlookup-with-fuzzy-matching-to-get.html "使用 VBA 和简化的“编辑距离”算法在 Excel 中进行模糊匹配")

该代码可能需要重新测试和重新工作。

查看您的代码，如果您想重新访问它，这里**有一个速度提示**：

```
将 arrByte() 调暗为字节
将 byteChar 调暗为字节
arrByte = strSource
for i = LBound(arrByte) 到 UBound(arrByte) 步骤 2
    byteChar = arrByte(i) ' 我将在 char 上使用整数运算进行一些比较操作
接下来我

```

VBA 中的字符串处理速度非常慢，即使您使用 Mid$() 而不是 Mid()，但数值运算非常好：字符串实际上是字节数组，编译器会按面值接受。

循环中 2 的“步骤”是跳过 unicode 字符串中的高位字节 - 您*可能*正在对普通 ASCII 文本运行字符串比较，您会看到（比如说）的字节数组“ABCd”是 (00, 65, 00, 66, 00, 67, 00, 100)。西欧国家的大多数拉丁字母 - 重音、变音符号、双元音和所有 - 将适合 255 以下，并且不会冒险进入该 wxample 中显示为零的高阶字节。

*您将在希伯来语、希腊语、俄语和阿拉伯语的严格单语*字符串比较中摆脱它，因为每个字母表中的高字节是恒定的：希腊语“αβγδ”是字节数组 (177,3,178,3,179,3,180,3)。但是，这是草率的编码，当您尝试跨语言进行字符串比较时，它会咬住（或字节）您。而且它永远不会在东方字母中飞翔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T10:57:55.917

相信这些线是**错误**的：-

```
deleteDistance = table(0, j - 1) + insertCost
insertDistance = ((j + 1) * insertCost) + deleteCost 
```

认为应该是：-

```
deleteDistance = ((j + 1) * insertCost) + deleteCost
insertDistance = table(0, j - 1) + insertCost 
```

还没有通过代码来弄清楚发生了什么但是下面是奇怪的！！！

```
If Left(source, 1) <> Left(target, 1) Then
    table(0, 0) = Application.Min(replaceCost, (deleteCost + insertCost))
End If 
```

因为您需要替换、删除或插入它可能应该是：-

```
If Left(source, 1) <> Left(target, 1) Then
    table(0, 0) = Application.Min(replaceCost, Application.Min(deleteCost, insertCost))
End If 
```

# ruby-on-rails - Ruby 形式和符号

> ID：13693152
> 
> 赞同：1
> 
> 时间：2012-12-03T22:47:27.950
> 
> 标签：ruby-on-rails, ruby

当使用带有 html.erb 页面的 form_for 助手时，很多工作都为您抽象出来，所以像

```
f.label :book 
```

变成了一个html标签。我想用一个字符串填充一个文本字段，这样我就可以获取与多个符号关联的值，将它们组合成一个字符串，然后将该字符串放入 :value 键中。

```
<%= form_for(@backpack) do |f| %>
  <ul>
    <% @backpack.errors.full_messages.each do |error| %>
        <li><%= error %></li>
    <% end %>
  </ul>
  <p>
    <%= f.label :calculator %><br/>
    <%= f.text_field :calculator %>
  </p>
  <p>
    <%= f.label :lunchbox %><br/>
    <%= f.text_field :lunchbox %>
  </p>
    <%= f.label :books %><br/>
  </p>
    <%= f.fields_for :books do |g| %>
      <p>
        <%= g.text_field :book, :value => MY_STRING %>
      </p>
    <% end %>
  </p>
  <p>
    <%= f.submit %>
  </p>
<% end %> 
```

MY_STRING = :title by :author

因此，如果我将 g.text_field 与 :book 单独分开，它会自动填充与该符号关联的字符串。如何以我的自定义方式实现它？符号究竟是如何引用嵌套形式中的实际数据的？

我还应该提到我有

```
accepts_nested_attributes_for :books 
```

我的背包控制器中的属性，所以我可以访问第二个模型/数据库

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:57:59.573

符号只是一个符号。与对象没有直接联系。但是您可以使用附加到表单构建器的 book 对象来创建一个描述该书的字符串：

```
<%= g.text_field :book, :value => "#{g.object.title} by #{g.object.author}" %> 
```

更好的是，您可以编写一个助手来为您处理这个问题：

```
# in backpacks_helper.rb
def book_title(book)
  "#{book.title} by #{book.author}"
end 
```

并像这样使用它：

```
<%= g.text_field :book, :value => book_title(g.object) %> 
```

# java - 我应该导入什么才能正确使用以下代码？

> ID：13693159
> 
> 赞同：-1
> 
> 时间：2012-12-03T22:48:02.187
> 
> 标签：java, android

您好我正在尝试将 Excel 文件读入我的 android 应用程序。我尝试使用此代码：

```
try {
    POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(file));
    HSSFWorkbook wb = new HSSFWorkbook(fs);
    HSSFSheet sheet = wb.getSheetAt(0);
    HSSFRow row;
    HSSFCell cell;

    int rows; // No of rows
    rows = sheet.getPhysicalNumberOfRows();

    int cols = 0; // No of columns
    int tmp = 0;

    // This trick ensures that we get the data properly even if it doesn't start from first few rows
    for(int i = 0; i < 10 || i < rows; i++) {
        row = sheet.getRow(i);
        if(row != null) {
            tmp = sheet.getRow(i).getPhysicalNumberOfCells();
            if(tmp > cols) cols = tmp;
        }
    }

    for(int r = 0; r < rows; r++) {
        row = sheet.getRow(r);
        if(row != null) {
            for(int c = 0; c < cols; c++) {
                cell = row.getCell((short)c);
                if(cell != null) {
                    // Your code here
                }
            }
        }
    }
} catch(Exception ioe) {
    ioe.printStackTrace();
} 
```

我想知道是否应该导入任何东西或任何库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:53:54.780

如果您使用 Eclipse 作为您的 IDE（我假设您是因为这与 Android 相关），您可以按 ctrl + shift + O 并且它会自动导入您需要的任何内容，假设您的构建路径中包含库。但是，听起来您没有 Apache POI 库。首先，您需要[下载](http://poi.apache.org/download.html#POI-3.8)库。下载它们后，您需要使用以下方法将它们添加到构建路径中：（再次假设您使用 Eclipse 作为 IDE）

1.  在项目资源管理器中右键单击您的项目。
2.  选择构建路径 -> 配置构建路径
3.  选择库选项卡。
4.  单击“添加 JAR...”
5.  查找并选择您刚刚下载的 JAR 文件。（您可能需要将 JAR 复制到您的项目中，以便您能够选择它）

或者，您可以将库添加到您的项目文件夹之一（通常是“lib”文件夹），在 Eclipse 中右键单击它并选择“添加到构建路径”。

它现在应该添加到您的构建路径中。再次尝试按 ctrl + shift + O ，将为您进行必要的导入。

# magento - Magento 相关产品不会显示

> ID：13693160
> 
> 赞同：2
> 
> 时间：2012-12-03T22:48:08.713
> 
> 标签：magento

我希望我的产品有各种尺寸和颜色。通过我的可配置产品的“关联产品”部分，我添加了 5 种不同颜色和尺寸的产品。例如

![产品选项](../Images/cb788f906953408a4a3e3e00a8f438c6.png)

*   这些产品都没有在 [“关联产品”](https://i.imgur.com/M4B0V.png)选项卡下或数据库表 shop_catalog_product_relation 或 shop_catalog_product_super_link下显示为链接到可配置产品
*   可配置产品说缺货

我试过了：

*   添加关联产品后，我确保单击主保存按钮以保存父产品的设置
*   将父产品的“管理库存”设置为“否”和“是”。没什么区别。
*   我尝试手动将关系插入到 shop_catalog_product_relation 表中
*   我已经对子产品的所有数量和“启用”性进行了三次检查。
*   异常日志中没有任何内容。
*   [https://stackoverflow.com/a/2493774/193244](https://stackoverflow.com/a/2493774/193244)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-07T00:16:14.613

在深入研究 Magento 核心代码后，我发现了问题所在。我的产品有 2 个属性：颜色和尺寸。尺寸和颜色属性仅适用于“可配置产品”而非“简单产品”。Magento 要求相关的“简单产品”具有颜色和尺寸。当它发现他们没有它们时，它会将它们过滤掉 - 因此是“缺货”。更令人困惑的是为什么 Magento 让我在创建相关产品时选择颜色和尺寸，即使它们不允许具有这些属性。

课程：确保产品属性应用于管理员的“管理属性”部分中的“简单产品”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T14:25:15.283

当我尝试创建组产品时，我注意到我的一些相关产品没有出现。我发现的问题与我创建简单产品时所做的事情有关。它们是我在产品信息选项卡下使用的一个称为自定义选项的选项，它允许您为正在创建的简单产品创建个性化属性。当我删除我为产品创建的那些属性时，简单产品出现在产品组中。

看起来他们是系统中的一个错误，我希望有人可以修复它。

# sql-server - 查询链接服务器上的全局临时表

> ID：13693177
> 
> 赞同：8
> 
> 时间：2012-12-03T22:49:56.240
> 
> 标签：sql-server, sql-server-2008, distributed-transactions

我已经看过所有关于如何在两个不同的 SQL 服务器上查询两个不同的表的参考资料，并且我了解它是如何实现的。但是，该命令似乎不适用于使用`##`.

如果我在一台服务器上编写连接，并且它引用该服务器上的一个临时表和另一台服务器上的一个临时表，SQL Server 假定因为`##`命令中的 ，它会自动查看本地服务器的`tempdb`，而不是远程一。我此时也无法使用`OPENROWSET`，因为该功能已被禁用，我必须获得批准才能重新打开它。

所以我的问题是有一种方法可以重新配置此命令以识别`tempdb`要查看的命令吗？

```
SELECT * 
FROM (##mytemptable1 Demog 
INNER JOIN MyServer.tempdb.dbo.##mytemptable2 PeakInfo ON (Demog.SAMPLE_NO = PeakInfo.SampleNum)  AND  (Demog.JOB_NO = PeakInfo.JobNum) )
ORDER BY PeakInfo.JobNum, PeakInfo.SampleNum,   PeakInfo.Replicate ,PeakInfo.Reinjection ,PeakInfo.PeakNameCustSort 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-08-20T16:21:24.413

试试这个从链接服务器查询全局临时表

```
SELECT * FROM OPENQUERY(linkedServerName, 'SELECT * FROM ##temp') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T17:37:20.623

MSDN [http://msdn.microsoft.com/en-us/library/ms186986(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms186986(v=sql.105).aspx)说全局临时表仅在 SQL Server 的特定实例上可见：

> 全局临时表在创建后对任何用户和任何连接都是可见的，并在引用该表的所有用户与 SQL Server 实例断开连接时被删除。

此外，对远程全局临时表尝试的任何操作都会导致明确的错误消息：

```
SELECT * FROM LinkedServerName.TempDB.dbo.##GLOBTABLE 
```

`Database name 'TempDB' ignored, referencing object in tempdb.`

看起来答案是否定的，没有（简单的）方法。

# php - 搜索第一个字母等于数字或符号的数据库

> ID：13693179
> 
> 赞同：1
> 
> 时间：2012-12-03T22:50:06.340
> 
> 标签：php, mysql, mysqli

因此，我设置了查询以在表中搜索以特定字母开头的用户名。

我的查询是这个

```
if(isset($_POST['search']) || (isset($_GET['search']))){
if($_GET['search'] && !$_POST['search']){
if($_GET['search'] == "!"){
   $search = //What here for number and symbol check;
}
   else
   {
      $search = $_GET['search'];
   }
      $search = $_GET['search'];
}
elseif($_POST['search'] && !$_GET['search'])
{
   $search = $_POST['search'];
}

$stmt = $db->prepare("SELECT * FROM accounts WHERE username LIKE CONCAT(?, '%') OR id LIKE CONCAT('%', ?, '%') LIMIT $start, $limit"); 
```

它适用于所有字母 az，但我还需要检查那些出于某种原因决定以数字或符号开头的用户名（客户不希望我在注册时阻止特殊字符）所以我该怎么做检查这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:17:29.927

听起来你需要用 mysql 查看正则表达式。您需要搜索不是“alpha”的内容： [[:alpha:]] Alpha - 任何字母。等效于 [az] 和 [AZ] 在此处查看此链接以获得更多帮助：[http ://www.techotopia.com/index.php/MySQL_Regular_Expression_Searches](http://www.techotopia.com/index.php/MySQL_Regular_Expression_Searches)

# html - 单击链接时未显示图形。（HTML 问题？）

> ID：13693182
> 
> 赞同：1
> 
> 时间：2012-12-03T22:50:15.643
> 
> 标签：html, ruby

我有地图，人们可以在其中单击标记位置以查看我大学校园内的建筑物。[http://mypower.herokuapp.com/map](http://mypower.herokuapp.com/map)

然后，用户可以单击图片或标题，它们都链接到能源使用图表页面。

但是，当我尝试从地图页面执行此操作时，建筑物图表页面缺少图表和其他图形元素。此外，当我单击图表页面左下角的“图表”选项卡时，它会将我带回地图页面，这是不应该发生的。

***现在，当我完成所有这些，然后手动刷新我所在的损坏的图形页面时，页面看起来很棒（它应该看起来像这样）。***

使用 html 和一点 ruby​​ 的组合，我为地图标记的弹出窗口的内容创建了一个 html 字符串。

```
 def gmaps4rails_infowindow
    "<center><a href=\"/halls/#{self.id}/\"> #{self.name}</a>
     <br>
     <a href=\"/halls/#{self.id}\"><img src= \"/smallbuildings/#{self.name}.jpg\"></a></center>"
  end 
```

单击链接转到正确的页面。由于某种原因，图形元素没有被渲染。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:17:28.533

添加`target="_parent"`固定的一切。

```
def gmaps4rails_infowindow
    "<center><a href=\"/halls/#{self.id}/\" target=\"_parent\"> #{self.name}</a>
     <br>
     <a href=\"/halls/#{self.id}\" target=\"_parent\"><img src= \"/smallbuildings/#{self.name}.jpg\"></a></center>"
  end 
```

# c# - 构建用于测试的 HttpContext，如何指定 HttpRequest 是 POST？

> ID：13693185
> 
> 赞同：10
> 
> 时间：2012-12-03T22:50:24.227
> 
> 标签：c#, unit-testing, testing, httprequest, httphandler

我正在为将 HttpContext 作为参数的方法编写一些单元测试。我想测试当请求是 POST 时行为是否符合预期。

创建 System.Net.HttpWebRequest 时，设置方法很容易，但在创建 HttpContext 中使用的 System.Web.HttpRequest 时，我看不到指定方法的方法。

有任何想法吗？

对于上下文，该方法由 httphandler 调用，如果请求不是 POST，则应该抛出 405。我知道我可以使用 web.config 中的 Verbs 属性过滤允许的方法，并且我会，但是没有什么可以阻止将来有人更改 verbs 属性以允许其他方法，在这种情况下我希望处理程序注意它本身。

当前使用的辅助方法：

```
 private HttpContext GetHttpContext(string requestUrl)
    {
        var httpRequest = new HttpRequest("", requestUrl, "");            
        var stringWriter = new StringWriter();
        var httpResponce = new HttpResponse(stringWriter);
        return new HttpContext(httpRequest, httpResponce);
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-04T02:58:43.170

我建议出于单元测试的目的研究模拟对象。有一些可用于 .NET 的模拟框架可以准确地促进这种类型的测试。

比如[这里](http://blog.kurtschindler.net/post/extending-steve-sandersone28099s-contextmocks-class)的文章使用Moq框架设置HttpMethod。

来自文章：

```
public ContextMocks(Controller onController, string HTTPMethod)
{
    //...
    Request = new Moq.Mock<HttpRequestBase>();
    Request.Setup(x => x.HttpMethod).Returns(HTTPMethod);
    //...
} 
```

也就是说，如果这是一次性测试，我不能强调这一点，并且在您的特定情况下引入对象模拟所产生的开销是不必要的，那么以下反射将设置 HttpMethod：

```
typeof(HttpRequest).GetField("_httpMethod", BindingFlags.NonPublic | BindingFlags.Instance).SetValue(httpRequest, "POST"); 
```

正如我之前提到的，如果使用 、 等进行测试`HttpContext`是`HttpRequest`或将成为一个反复出现的主题，那么请利用模拟框架。从长远来看，您将节省自己的时间。

# node.js - 咕噜力手表？

> ID：13693188
> 
> 赞同：0
> 
> 时间：2012-12-03T22:50:26.373
> 
> 标签：node.js, gruntjs

我在 grunt watch 上运行指南针。我希望 grunt watch 在启动时始终运行任务。我称它为强制运行，但它可能被称为别的东西。提前感谢您的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T00:00:42.697

在调用 watch 之前注册一个任务来调用 compass 任务。

```
grunt.registerTask('dev', [ 'compass:dev', 'watch' ]); 
```

从命令行运行只是做

```
$ grunt dev 
```

我正在使用[**grunt-compass**](https://github.com/kahlil/grunt-compass)，它工作正常。

# javascript - 如何在 javascript/jquery 中动态构建 fancybox 库？

> ID：13693189
> 
> 赞同：1
> 
> 时间：2012-12-03T22:50:26.263
> 
> 标签：javascript, jquery, fancybox

所以我在页面上有这个元素，当用户点击我想打开一个fancybox画廊时。页面上的元素是动态生成的，每个相册中的图像数量会有所不同。

我有一个名为的对象`imginfo`，它也包含专辑信息和图像网址。`imginfo.url`其中 url 是一个数组。看起来像这样。。

`imginfo.url[0]='http://i.imgur.com/blah.jpg'` `imginfo.url[1]='http://i.imgur.com/blah.jpg'`ETC

我的代码

```
$('#clickbox').click(function() {
    var holderr = new Array();
    var mini = new Array();

    for(i=0;i<imginfo.album;i++){

        mini['href'] = imginfo.url[i];
        mini['title'] = 'title';
        holderr[i] = mini;
    }
    var h = JSON.stringify(holderr);                            
    $.fancybox([ 
        {href : imginfo.url[0], title : 'Title'},//this is the part that needs to dynamic that i dont know how to do
        {href : imginfo.url[1], title : 'Title'},
        {href : imginfo.url[2], title : 'Title'} 
        ]); 

} 
```

所以是的，无法为fancybox 生成正确的格式。有什么建议么？

# matlab - Matlab 在簇上放置标签

> ID：13693190
> 
> 赞同：5
> 
> 时间：2012-12-03T22:50:32.620
> 
> 标签：matlab, plot

我已经实现了一个算法，这是我的资源书中的一个情节：

![在此处输入图像描述](../Images/40bf25eb583dd361a3a5eaefbd11cd0d.png)

我是 Matlab 的新手。我有一个 xValues 列表、yValues 列表（我已将最终矩阵划分为 x 轴和 y 轴，我不确定这是不是真的，如果您提出建议，欢迎您）和一个标签向量。

我想得到一个像上面一样的图像。我怎样才能像给定的图像一样放置一些类标签（即 0、1、2、3 ..）？

**PS：**我是这样绘制的：`plot(xValues,yValues,'b.');`但是我的点就像钻石一样，而不是像图像中那样指向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:04:01.853

您可以使用`text`在场景中绘制文本。（MATLAB帮助：）

```
text(X,Y,'string') adds the text in the quotes to location (X,Y)
on the current axes, where (X,Y) is in units from the current
plot. 
```

您需要知道要在图表上的哪个位置绘制文本，但您可以这样做：

```
x = -pi:.1:pi;
y = sin(x);
p = plot(x,y)

text(-pi/4,sin(-pi/4),'7')
text(-pi/4+1,sin(-pi/4),sprintf('%d', 8))
text(-pi/4+2,sin(-pi/4),'9') 
```

这会给你这个：

![在此处输入图像描述](../Images/1b5c0a3113f761ac6d4d3a1c81476c3f.png)

您可以使用常规的 matlab 注释添加不同的文本样式等。您还可以使用 sprintf 命令为集群自动添加所需的数字，正如我在绘制 8 时所显示的那样。

祝你好运。

# c# - SQLite如何查询一条记录是否存在？

> ID：13693192
> 
> 赞同：6
> 
> 时间：2012-12-03T22:50:41.093
> 
> 标签：c#, linq, sqlite, windows-store-apps, sqlite-net

在下面注释掉的行中，PlatypusId 为红色/无法识别，尽管它确实存在于相应的表中。

在对 queryResult、PlatypusId、where 和 count 的多行跨越分配中，红色/无法识别。

```
 //var queryResult = await conn.Table<PlatypiRequested>().CountAsync().(x => x.PlatypusId.Equals(personId));
    var queryResult = from p in PlatypiRequested
                      where p.PlatypusId.Equals(platypusId)
                      select count; 
```

IOW，当我添加这个时：

```
 var conn = new SQLiteAsyncConnection(SQLitePath);
    var queryResult = await conn.Table<PlatypiRequested>().CountAsync().(x => x. 
```

...在“x => x”之后没有任何可能性。

查询我的 SQLite 表需要什么样的代码？

我正在使用 SQLite-net 包/扩展，但它的文档（什么文档？）并不过分冗长。纵观 SQLite.cs 和 SQLiteAsync.cs，我一点也不聪明……

## 更新

好的，Harvey 先生的回答评论让我看到了这个工作代码（Count() 不可用，只有 CountAsync()）：

```
public async Task<bool> PlatypusAlreadyAdded(string platypusId)
{
    var conn = new SQLiteAsyncConnection(SQLitePath);
    var queryResult = await conn.Table<PlatypiRequested>().Where(x => x.PlatypusId == platypusId).CountAsync();
    return queryResult > 0;
} 
```

正如 Jackie DeShannon（与我无关，AFAIK）所唱的那样，“世界现在需要的是“用于 C# Windows Store 应用程序的 SQLite/SQLite-net”一书（或者至少是一篇冗长/内容丰富的博客文章，其中包含所有示例常见的 SQL 语句类型 (CRUD)）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T23:25:29.157

我认为您真正要寻找的是

```
var queryResult = await conn.Table<PeopleRequested>()
                            .Where(x => x.someField == someValue)
                            .CountAsync(); 
```

你的方法行不通，因为最后一个`.`运算符期待一个方法调用，而不是一个左括号或 lambda 表达式。

# breeze - Breeze 示例因“找不到资源”而失败

> ID：13693201
> 
> 赞同：2
> 
> 时间：2012-12-03T22:51:37.987
> 
> 标签：breeze

我下载了一个 Breeze 示例，在 Visual Studio 中打开它，按 F5 在调试下运行它（或 ctrl-F5 不调试），IE 报告“请求的 URL：/Views/Home/Index.cshtml”找不到。

如果我通过“项目 | 属性 | Web”将项目“开始操作”设置为“特定页面”，问题就会消失。我可以将页面名称留空；只需单击该单选按钮。

你为什么不为我们这样做，这样就没有人遭受这种经历了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:16:51.400

我很同情自己多次经历过这种令人不安的经历。我希望我们能做点什么。这是 MVC 页面和 Visual Studio 之间不幸交互的产物。

您的建议 - 设置“特定页面” - 确实有效，我推荐给大家。我只希望我们能为你设置它。

不幸的是，与许多其他设置一样，此设置存储在解决方案“ **.suo** ”文件中（例如，“ ***Todo*** *-Angular.v11.suo* **”）。**

 **我们不会将“.suo”文件（或“.csproj.user”文件）保留在源代码管理中，并且我们不会将它们与示例一起提供，因为这些文件不是“我们的”。它们在技术上是“你的”。“.suo”文件是“每个用户”文件，用于记录您对解决方案的个人体验。它们包括您在上次会话中在编辑器中打开的文件、隐藏的文件夹、展开或折叠的区域等等。也许我们应该重新审视我们的决定……但忽略这些文件是行业惯例。

因此，由于我们无法为您设置“特定页面”标志，您必须自己设置。

还有另一个因素，你可能没有注意到。如果当前在打开的代码编辑器中选择了“ *cshtml* ”文件 (a) 或 (b) 在解决方案资源管理器中选择了，您只会遇到此特定故障。选择任何非*cshtml*（或非*html*）文件......应用程序启动正常。去搞清楚。**

# prestashop - Prestashop - 在哪里查看 Web 服务 API

> ID：13693202
> 
> 赞同：0
> 
> 时间：2012-12-03T22:51:38.393
> 
> 标签：prestashop

我对 Prestashop 编程非常陌生，我有一项关于修复当前 Prestashop 网络服务的任务，因为我们发现它有问题。

我对 Prestashop 编程不熟悉，所以我有一个问题，关于在哪里可以找到 web 服务的特定代码，例如产品资源。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T19:09:49.643

好吧，您必须先访问 prestashop 管理面板。在 Tools -> Webservice 下，您将看到预配置端点和帐户的列表。这将是了解当前实现能力的一个很好的起点。还可以查看 prestashop 文档以获取有关使用的信息[http://doc.prestashop.com/display/PS15/Using+the+PrestaShop+Web+Service](http://doc.prestashop.com/display/PS15/Using+the+PrestaShop+Web+Service)

更新：如果您需要处理请求的实际代码，它位于 yourshop.com/webservice/dispatcher.php

它调用应该提供 Web 服务操作的类方法。

# c - 如何将获取请求发送到洪流跟踪服务器

> ID：13693203
> 
> 赞同：4
> 
> 时间：2012-12-03T22:51:42.427
> 
> 标签：c, get, bittorrent

我想实现一个有点洪流的客户端。我从这里获取我的信息：[http](http://wiki.theory.org/BitTorrent_Tracker_Protocol) ://wiki.theory.org/BitTorrent_Tracker_Protocol 。

我想向跟踪器发送获取请求以获取对等列表。我应该建立一个 udp 连接并在 80 端口连接到 udp://tracker.thepiratebay.org 吗？这是我的请求消息的样子吗？

```
"udp://tracker.thepiratebay.org??info_hash=12345678901234567890
&peer_id=ABCDEFGHIJKLMNOPQRST
port=6888
&downloaded=0
&left=0
&event=started " 
```

这是我的代码的一部分：

```
 char *requestToSend;
    int sock;
    struct sockaddr_in servAddr; 
    struct sockaddr_in fromAddr;    
    int fromSize; 
    int respStringLen;

    int portNum =80;
    char data_recv[ECHOMAX];

    char *hash="12345678901234567890";
    char *id="ABCDEFGHIJKLMNOPQRST";
    char *temp ="udp://tracker.thepiratebay.org??info_hash=12345678901234567890\n&peer_id=ABCDEFGHIJKLMNOPQRST\nport=6888\n&downloaded=0\n&left=0\n&event=started";
    requestToSend = malloc(sizeof(temp)+1);
    sprintf(requestToSend, "%s??info_hash=%s\n&peer_id=%s\nport=%s\n&downloaded=0\n&left=0\n&event=started\0","udp://tracker.thepiratebay.org", hash,id,"6888");
    printf("%s to send \n",  requestToSend);

   /* Create a datagram/UDP socket */
    if ((sock = socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP)) < 0){
        printf("fail create socket");
        return 0;
    }

    /* Construct the server address structure */
    struct hostent *hp = gethostbyname("udp://tracker.thepiratebay.org");   
    memset(&servAddr, 0, sizeof(servAddr));    /* Zero out structure */
    servAddr.sin_family = AF_INET;                 /* Internet addr family */
    memcpy( (char *) &servAddr.sin_addr.s_addr, hp->h_addr, hp->h_length );
    servAddr.sin_port   = htons(portNum);     /* Server port */

    //send request to tracker server 
    if (send(sock, requestToSend, strlen(requestToSend), 0) != strlen(requestToSend)){
        printf("fail send");
        return 0;
    }

    /* Recv a response */
    fromSize = sizeof(fromAddr);
    if ((respStringLen = recvfrom(sock, data_recv, ECHOMAX, 0, 
         (struct sockaddr *) &fromAddr, &fromSize)) != strlen(requestToSend)){
        printf("fail to recv");
        return 0;
    } 
```

这是我从种子文件中得到的

```
 dict {
    announce => str = http://tracker.thepiratebay.org/announce (len = 40)
    announce-list => list [
        list [
            str = http://tracker.thepiratebay.org/announce (len = 40)
        ]
        list [
            str = udp://tracker.thepiratebay.org:80/announce (len = 42)
        ]
        list [
            str = http://tracker.openbittorrent.com/announce (len = 42)
        ]
        list [
            str = udp://tracker.openbittorrent.com:80/announce (len = 44)
        ]
    ]
    creation date => int = 1174816388
    encoding => str = UTF-8 (len = 5)
    info => dict {
        filehash => str =
¸¥£öüËXþÐS®(äfn6 (len = 20)
        length => int = 2222949
        name => str = Audacity.zip (len = 12)
        name.utf-8 => str = Audacity.zip (len = 12)
        piece length => int = 32768
        pieces => str = (null) (len = 0)
    }
}
d8:announce40:http://tracker.thepiratebay.org/announce13:announce-listll40:http:                         //tracker.thepiratebay.org/announceel42:udp://tracker.thepiratebay.org:80/announ                         ceel42:http://tracker.openbittorrent.com/announceel44:udp://tracker.openbittorre                         nt.com:80/announceee13:creation datei1174816388e8:encoding5:UTF-84:infod8:fileha                         sh20:
¸¥£öüËXþÐS®(äfn66:lengthi2222949e4:name12:Audacity.zip10:name.utf-812:Audacity.z                         yf3-ûBÎNrl lengthi32768e6:pieces1360:þ]úÙÉÅ'NÕæ+gd3fi6è6¶ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-10T23:26:17.787

该网站上给出的示例不适用于 UDP 通信。它用于通过 TCP 进行通信，更具体地说，是 HTTP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T05:40:40.357

你检查 gethostbyname 确实返回了一个有效的地址吗？我认为您不应该将 http:// 或 udp:// 协议字符串部分添加为 gethostbyname 参数。

```
struct hostent *hp = gethostbyname("tracker.thepiratebay.org");
if(!hp)
{
  herror("gethostbyname(): ");
  exit(1);
} 
```

添加此行以确保 gethostbyname 确实可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-12T22:38:02.187

如果 tracker 使用**UDP**，您不应该发送`GET`请求，而是在指定端口建立连接，然后执行 4 个步骤：

1.  发送连接请求
2.  通过读取 16 字节的响应来确认连接请求，并保持**连接 ID**
3.  发送带有连接 ID 的通知
4.  解析announce response，它的大小取决于指定的peer数量

全部的 UDP 连接需要更少的数据包来交换相同数量的信息，但它更多地涉及为客户端实现:)

这个[wiki](https://github.com/naim94a/udpt/wiki/The-BitTorrent-UDP-tracker-protocol)详细介绍了 UDP 消息应该包含的内容。它们类似于您发送给对等方的消息（也就是说，它们使用编码为固定字节长度的**大端整数）**

或者[规格](http://www.bittorrent.org/beps/bep_0015.html)可以提供帮助

# android - 将硬搜索键连接到 SearchView

> ID：13693207
> 
> 赞同：0
> 
> 时间：2012-12-03T22:52:13.510
> 
> 标签：android, android-widget, android-searchmanager, google-now

我在操作栏中有一个带有搜索视图的应用程序，除了触摸视图之外，我还试图获取硬搜索键来激活它，但我尝试的所有操作都导致从我的应用程序启动 Google Now。

我尝试了以下方法。注释代码是我第二次尝试模拟用户触摸搜索视图，但它不起作用。搜索功能通过触摸屏完美运行我只是在获取硬键来激活它时遇到问题。

```
@Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        switch(keyCode) {
        case KeyEvent.KEYCODE_SEARCH:
            /*mSearchView.setFocusable(true);
            mSearchView.setIconified(false);
            mSearchView.requestFocus();*/
            onSearchRequested();
            return true;
        }
        return super.onKeyDown(keyCode, event);
    } 
```

**动作视图**

```
<item
        android:id="@+id/search"
        android:actionViewClass="android.widget.SearchView"
        android:icon="@drawable/ic_menu_search"
        android:orderInCategory="2"
        android:showAsAction="ifRoom"
        android:title="@string/menu_search"/> 
```

# android - Android 本地化值-** 文件夹名称

> ID：13693209
> 
> 赞同：23
> 
> 时间：2012-12-03T22:52:33.340
> 
> 标签：android, localization, locale

我见过几个显示本地化以及它们应该采用什么名称的冲突表

他们中的很多人建议每个国家/地区都有语言的版本，这很好，对于像英语、西班牙语和中文这样的语言，我可以选择制作一个`values-en`文件`values-en_US`夹，如果我想让它更具体，我可以选择一个文件夹

但是像希腊语这样的其他一些语言有一个语言环境名称`el_GR`，我可以只制作一个文件夹名称`values-el`还是必须这样做`values-el_GR`

这只是一个例子，我不相信我读过的表格，android 开发者指南几乎没有列出可用的语言环境

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-05-27T09:36:15.270

Android字符串文件的文件夹名称格式如下：

*   没有区域变体：`values-[locale]`
*   区域变体：`values-[locale]-r[region]`
*   例如：`values-en`, `values-en-rGB`, `values-el-rGR`。

在您的情况下，您只需要`values-el`为希腊语翻译和`values-el-rGR`特定国家/地区的希腊语翻译创建一个文件夹。

此外，您可以利用 Android 中的资源回退机制，以允许在本地进一步翻译特定的字符串。

例如，假设您有一个名为“R.string.title”的字符串并且语言环境是“el-GR”，Android 将通过按以下顺序搜索文件来查找“R.string.title”的值：

*   `res/values-el-rGR/strings.xml`
*   `res/values-el/strings.xml`
*   `res/values/strings.xml`

因此，您可以将特定国家/地区的翻译放在 中`res/values-el-rGR/strings.xml`，然后让`res/values-el/strings.xml`商店存储通用翻译。

通过利用这种回退机制，它可以避免在不同的语言文件中复制你的字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-05-12T10:48:13.337

右键单击项目中的“res”文件夹。选择 > 新建 > Android 资源文件 > 本地化 - 它会为您提供所有可能的语言和区域设置选项，甚至创建所需的文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-12T02:53:23.147

都可以在[https://developer.android.com/index.html找到](https://developer.android.com/index.html)

1.  在[https://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources](https://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)

页面描述多个资源定义，如 drawable ， value

2.  在[https://developer.android.com/training/basics/supporting-devices/languages.html](https://developer.android.com/training/basics/supporting-devices/languages.html)

该页面提供语言资源定义，它是导入如何创建语言环境目录和资源文件。

格式是`<resource type>-b+<language code>[+<country code>]`.

和`language code` `country code`参考[https://developer.android.com/reference/java/util/Locale.html](https://developer.android.com/reference/java/util/Locale.html)

语言 ISO 639 alpha-2 或 alpha-3 语言代码，或最多 8 个字母字母的注册语言子标签（用于未来增强）。当一种语言同时具有 alpha-2 代码和 alpha-3 代码时，必须使用 alpha-2 代码。您可以在 IANA 语言子标签注册表中找到有效语言代码的完整列表（搜索“类型：语言”）。 [https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry](https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry)

国家（地区）ISO 3166 alpha-2 国家代码或 UN M.49 numeric-3 区域代码。您可以在 IANA 语言子标签注册表中找到有效国家和地区代码的完整列表（搜索“类型：地区”）。

[https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry](https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry)

其他参考：[https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)

# unit-testing - Visual Studio 2012 Express Web 忽略单元测试

> ID：13693212
> 
> 赞同：0
> 
> 时间：2012-12-03T22:52:55.140
> 
> 标签：unit-testing, visual-studio-2012

一个快速的，你可能已经解决了：

我在 VS2010 SP1 中创建了一个测试项目。项目被导入到 VS2012 Express 中。测试资源管理器窗口没有显示测试（虽然现在有两个）。所以我点击“全部运行”，这会导致以下控制台输出（粗略翻译，不知道确切的未本地化等效项）：

```
========== Build: 0 successful, 0 erroneous, 2 current, 0 skipped ========== 
```

没有结果，没有测试资源管理器中的测试......有什么想法吗？

蒂亚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T09:36:43.630

显然，问题在于测试类库是在 VS 2010 中创建的。在以下屏幕截图中，您可以看到被 VS 2012 测试运行器（底部图标）和新创建的 c# .Net 忽略的项目4.0 测试项目，所有测试都按预期执行（最上面的图标）。

![项目变化](../Images/aa01fa3edd09dab36199fa67b796351a.png)

# python - 从文件中删除字符串和字符串之前的所有行

> ID：13693213
> 
> 赞同：2
> 
> 时间：2012-12-03T22:52:54.673
> 
> 标签：python, xml, string, parsing

我有一个包含数千行数据的文件名。我正在读取文件名并对其进行编辑。

以下标签大约有 900 行或更多行（每个文件不同）：

```
<Report name="test" xmlns:cm="http://www.example.org/cm"> 
```

我需要在几个文件中删除该行及其之前的所有内容。所以我需要代码来搜索该标签并将其删除，它上面的所有内容并不总是向下 900 行，它会有所不同；但是，标签将始终相同。

我已经有代码可以读取行并写入文件。我只需要找到那条线并删除它以及它之前的所有内容背后的逻辑。

我尝试逐行读取文件，然后在遇到该字符串后写入新文件，但逻辑不正确：

```
readFile = open(firstFile)
lines = readFile.readlines()
readFile.close()
w = open('test','w')
for item in lines:
    if (item == "<Report name="test" xmlns:cm="http://www.example.org/cm">"):
        w.writelines(item)
w.close() 
```

此外，每个文件中的确切字符串也不相同。“测试”的值会有所不同。我可能需要检查标签名称“”<Report name”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:22:43.017

您可以使用标志`tag_found`来检查何时应将行写入输出。您最初将标志设置为`False`，然后`True`在找到正确的标签后将其更改为。当标志为`True`时，您将该行复制到输出文件。

```
TAG = '<Report name="test" xmlns:cm="http://www.domain.org/cm">'

tag_found = False
with open('tag_input.txt') as in_file:
    with open('tag_output.txt', 'w') as out_file:
        for line in in_file:
            if not tag_found:
                if line.strip() == TAG:
                    tag_found = True
            else:
                out_file.write(line) 
```

PS：`with open(filename) as in_file:`语法使用 Python 所称的“上下文管理器”——请参阅[此处](http://python3porting.com/improving.html#coding-with-context-managers)了解概述。对它们的简短解释是，当块完成时，它们会自动为您安全地关闭文件`with:`，因此您不必记住放入`my_file.close()`语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:46:55.363

您可以使用正则表达式来匹配您的行：

```
regex1 = '^<Report name=.*xmlns:cm="http://www.domain.org/cm">$' 
```

获取与正则表达式匹配的项目的索引：

```
listIndex = [i for i, item in enumerate(lines) if re.search(regex, item)] 
```

切片列表：

```
listLines = lines[listIndex:] 
```

并写入文件：

```
with open("filename.txt", "w") as fileOutput:
    fileOutput.write("\n".join(listLines)) 
```

*伪代码*

尝试这样的事情：

```
import re

regex1 = '^<Report name=.*xmlns:cm="http://www.domain.org/cm">$' # Variable @name
regex2 = '^<Report name=.*xmlns:cm=.*>$' # Variable @name & @xmlns:cm

with open(firstFile, "r") as fileInput:
    listLines = fileInput.readlines()

listIndex = [i for i, item in enumerate(listLines) if re.search(regex1, item)]
# listIndex = [i for i, item in enumerate(listLines) if re.search(regex2, item)] # Uncomment for variable @name & @xmlns:cm

with open("out_" + firstFile, "w") as fileOutput:
    fileOutput.write("\n".join(lines[listIndex:])) 
```

# python - 一个查询中打开了多少个plpython执行环境？

> ID：13693215
> 
> 赞同：1
> 
> 时间：2012-12-03T22:53:01.630
> 
> 标签：python, database, postgresql, greenplum, plpython

postgres（和greenplum）中的用户定义函数是独立运行的吗？当我使用 plpythonu 用户定义函数进行查询时，打开了多少个执行环境？运行查询时是否有任何共享的 python 解释器状态？

假设我有一个 plpython 用户定义函数：

```
CREATE OR REPLACE FUNCTION file2text(path string) RETURNS text AS $$
    f = open(path, 'r')
    return f.read()
    f.close()
$$ LANGUAGE plpythonu; 
```

对于一个表`create table files (name varchar, path varchar)`和对该表的查询，如下所示：

```
SELECT f.name
FROM files f
WHERE character_length( file2text(f.path) ) > 4096
ORDER BY f.name 
```

每次执行我的 plpython 函数都会产生一个新的 python 环境吗？在 MPP 数据库中，我可以假设 postgres 的行为在每个段之间重复，而段之间没有共享状态吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:56:49.727

PL/Python 状态在会话之间是隔离的，并在会话内共享。

您可以通过在`sys`模块中放置一个变量（仅用于测试！）或更好地在您导入的自定义模块中轻松测试它。您应该看到该变量对在同一会话（连接）中运行的其他函数可见，但对其他会话中的函数不可见。

# erlang - 如何获得 Erlang 的光束大小？

> ID：13693216
> 
> 赞同：1
> 
> 时间：2012-12-03T22:53:04.280
> 
> 标签：erlang, gen-server, beam

我有一个需要优化的遗留 Erlang 程序。这段代码在运行时最多使用 20G 内存。我想知道是否有办法在运行时获取进程本身的 Erlang Beam 大小？如果这是可能的，那么我可以做一些事情，比如如果光束大小>10GB，然后拒绝所有对 gen_server 进程的调用。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T15:53:53.183

只需`memory()`从 shell 调用以了解它是否在二进制文件、ets、进程等中，内存是否被保留。接下来，如果某个进程是罪魁祸首，您可以要求一个工具`etop`为您提供使用最多内存的进程。这通常可以追踪问题。

如果问题是 ETS 或二进制文件，那么由于其中的子二进制指针，您可能会长时间保留某些大型二进制文件。这需要 GC 调整来修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:17:33.273

也许您可以使用一些 proces_info 数据：

> {memory, Size}：Size 是进程的字节大小。这包括调用栈、堆和内部结构。

```
process_info(self(), memory).   
{memory,17128} 
```

# python - 在 Python 中从二维数组中选择列的最快方法？

> ID：13693223
> 
> 赞同：1
> 
> 时间：2012-12-03T22:53:37.533
> 
> 标签：python, performance

我正在尝试提高一个函数的性能，该函数计算 Python 中二维数组的一列中某个元素的出现次数。时间来自 cProfile，它也告诉我`count()`每 357595 次调用仅花费 ~.08 秒。

for 循环最快（357595 次调用为 0.375 秒）：

```
def count_column(grid, j, element):
    count = 0
    for x in range(0, len(grid)):
        if grid[x][j] == element:
            count += 1
    return count 
```

列表推导的速度可以忽略不计（357595 次调用为 0.400 秒）：

```
def count_column(grid, j, element):
    return [x[j] for x in grid].count(element) 
```

Zip 是最慢的，幅度很大（357595 次调用为 0.741 秒）：

```
def validate_column(grid, j, element):
    return zip(*grid)[j].count(element) 
```

有没有更快的方法来做到这一点，或者最好的方法是用 扁平化数组`chain.from_iterable`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:22:41.167

这是我得到的一系列不同变化的时间：

```
cc_explicit 5000 0.00290012359619
cc_explicit_xrange 5000 0.00145506858826
cc_filter 5000 0.00117516517639
cc_genexp 5000 0.00100994110107
cc_ifilter 5000 0.00170707702637
cc_izip 1 3.21103000641
cc_listcomp 5000 0.000788927078247
cc_zip 5000 12.1080589294 
```

代码和测试驱动程序位于[http://pastebin.com/WSAUqTyv](http://pastebin.com/WSAUqTyv)

由于 zip 和 izip 太慢了，我把它们排除在外，然后用其余的进行 500000x10 测试：

```
cc_explicit 500000 0.105982065201
cc_explicit_xrange 500000 0.103507995605
cc_filter 500000 0.0856108665466
cc_genexp 500000 0.0679898262024
cc_ifilter 500000 0.144966125488
cc_listcomp 500000 0.0396680831909 
```

因此，最快的解决方案是`listcomp`. 但是当我向它扔随机数据和更大的行时，有时两者都 beat ，`genexp`并且它们在大多数测试中都非常接近，并且使用的内存要少得多，所以我会这样做：`explicit_xrange``listcomp``genexp`

```
def cc_genexp(grid, j, element):
    return sum(x[j] == element for x in grid) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:29:42.873

如果我可以在这里提供我的 2 美分，您还应该查看*Numpy*，正如已经建议的那样。或者，如果您不想处理非标准库，您应该查看`collections.Counter()`. 是的，它会带来很大的前期成本，但是如果您发现自己在同一个数据集中计算了许多不同的值，您可能会发现初始投资得到了回报。

# https - 在 https 连接中查看用户代理？

> ID：13693230
> 
> 赞同：0
> 
> 时间：2012-12-03T22:54:08.897
> 
> 标签：https, wireshark

我有一个应用程序，它与服务器建立 https 连接。是否可以使用诸如wireshark或charlesproxy之类的东西来查看它正在连接的用户代理？我不想看到任何实际数据，只是用户代理 - 但我不确定它是否也被加密？（如果值得一试）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:10:00.900

> 是否有可能...

不会。浏览器首先与服务器建立安全连接，然后将其用于传输所有数据，包括请求数据、各种标头等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-10T10:01:40.173

对于最初的询问者来说为时已晚，但答案是在某些情况下它可能是可能的，这取决于应用程序的实现。您可以使用提琴手，并且通过打开“解密 https 流量”，您还可以在某些情况下查看 HTTPS 内容。fiddler 所做的（至少在 Windows 上）是在 wininet 中将自己注册为系统代理。它还可以添加证书（当您选择解密 https 流量时需要您的批准）并为访问的域生成动态证书，因此是 MitM。使用此基础架构的应用程序将“暴露”于此 MitM。我运行了 fiddler 并运行了一些应用程序，并且能够查看与办公产品（winword、powerpoint、outlook）其他 MS 可执行文件（Searchprotocolhost.

# sql - Django 真正简单的聚合（或 Group By）

> ID：13693232
> 
> 赞同：1
> 
> 时间：2012-12-03T22:54:41.223
> 
> 标签：sql, django, group-by, aggregation

想象一下，我只想知道Django 的*auth app中具有相同***first_name**的用户数量。我知道如何在 SQL 中非常容易地做到这一点：

 *```
SELECT first_name, COUNT(1) as num_users 
  FROM auth_user 
  GROUP BY first_name
  ORDER BY num_users DESC; 
```

而且我还知道如何在 Django 中获得所需的输出（例如，像浏览所有用户，获取他们的电子邮件并进行*过滤*和*计数*）。

**难道没有更简单的方法可以通过 Django 的 ORM 做到这一点吗？**如果我使用外键而不是表字段之一进行聚合，我可以完成它。我很确定我错过了一些东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:17:27.010

Django 的[注释](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#generating-aggregates-for-each-item-in-a-queryset)允许您将一些基本计算附加到查询集中的每个对象（或整个查询集中的聚合），但您不能过滤这些注释（即，在您的情况下，您只想计算那些共享您的名字的用户）

Django 还[`F() objects`](https://docs.djangoproject.com/en/dev/topics/db/queries/#filters-can-reference-fields-on-the-model)允许您在查询中使用字段值。理想情况下，您可以将这些与注释结合使用来过滤您要注释的对象，[但目前还不可能（正在修复）](https://code.djangoproject.com/ticket/14030)

因此，一个简单的解决方案是手动执行注释：

```
users = User.objects.all().extra(select={
    'same_name_count' : """
    SELECT COUNT(*)
    FROM auth_user
    WHERE auth_user.first_name = user.first_name
    """
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:23:27.763

几年前，我在博客上讨论过[这个问题。](http://blog.roseman.org.uk/2010/05/10/django-aggregation-and-simple-group/)与其他答案相反，在 Django 中完全有可能，不需要原始 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:05:09.007

检查这个：[https ://docs.djangoproject.com/en/dev/topics/db/aggregation/](https://docs.djangoproject.com/en/dev/topics/db/aggregation/)

```
from django.db.models import Count
auth_user.objects.annotate(num_users=Count('first_name')) 
```

对于更复杂的查询，您可以使用普通 SQL，但尽量避免使用它。

**UPD**代码已修复。感谢 Timmy O'Mahony 的提及！*

# ruby-on-rails - 只显示前几段。Ruby on Rails

> ID：13693233
> 
> 赞同：0
> 
> 时间：2012-12-03T22:54:41.170
> 
> 标签：ruby-on-rails

我正在使用 simple_format(@company.description) 将文本制作成多个段落。在一页上，我只想展示前三段。是否有任何漂亮的 ruby​​ 方法可以在这里提供帮助，或者我应该阅读我的正则表达式技巧，这些技巧已经过时了。

干杯卡尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:01:31.077

[truncate helper 方法](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-truncate)需要一个可选的`:separator`. 由于 simple_format 使用`<br />`标签来指示段落，您应该能够执行以下操作：

```
truncate(simple_format(@company.description), length: 3, separator: '<br />') 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-03T23:36:16.537

Personally, I'd round the text before putting it into a formatter. I'd assume you have a \r\n or \n in your text. Why format 1000 paragraphs if all you need is the first 3\.

```
def get_first_paragraphs(text, desired = 3)
   text.each_with_index do |character, index| 
      if(character == "\n")
         desiredParCount -= 1
         return text[0..index] if(desiredParCount <= 0)
      end
   end
   return text;
end 
```

It's a function sure, but it's the fastest method.. if speed is important. (it always is, ALWAYS!) :)

# java - 使用 GWT 重复发布帖子

> ID：13693236
> 
> 赞同：1
> 
> 时间：2012-12-03T22:54:56.263
> 
> 标签：java, html, gwt

```
<div class="post">
   <div class="post-user-image">
         image
   </div>

   <div class="post-content">
        <h4>
        link to user profile, firstname and last name of the post owner
        </h4>  
        <p>......messege itself......</p>
        <div class="post-footer">
            post --> date and post --> likes...
        </div>
  </div>
</div> 
```

我有上面的 html 代码，它代表用户墙上的帖子，我希望这对于用户使用 GWT 的帖子数量再次出现。我不知道如何解决我对将 GWT 集成到现有 html 代码感到不舒服的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T02:00:44.387

[您可以从GWT 开发指南](https://developers.google.com/web-toolkit/doc/latest/DevGuide)的资源中熟悉 GWT 。

对于您的特定问题，我建议您查看[UiBinder](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder)。

您可以使用您的 HTML 片段作为 UiBinder GWT 小部件的模板。您的小部件将具有图像/链接/内容/您想要显示的任何内容的参数。

让我们将您的小部件称为 Post。每次你想向显示添加一个新实例时，你可能会这样做：

```
// Crete and populate our Post
Post newPost = new Post();
newPost.setUsername("XXX");
newPost.setLink("xxx");
newPost.setDate("xxx");

// Display the post.
postContainer.add(newPost); 
```

请注意，'postContainer' 可以是任何东西 - [GWT Panels](https://developers.google.com/web-toolkit/tools/gwtdesigner/layoutmanagers/gwt/)之一，用于将小部件显示到其中的自定义容器等。

# ios - 使用 Google Drive SDK iOS 创建文件夹

> ID：13693238
> 
> 赞同：3
> 
> 时间：2012-12-03T22:55:02.080
> 
> 标签：ios

我正在尝试使用适用于 iOS 的 Google Drive SDK 创建一个文件夹。从此处的 Google Drive 文档：

[https://developers.google.com/drive/folder](https://developers.google.com/drive/folder)

它说创建文件夹就像创建具有特殊 MIME 类型的“文件”。

```
GTLUploadParameters *uploadParameters = nil;

self.driveFile = [GTLDriveFile object];
self.driveFile.title = foldername;

uploadParameters = [GTLUploadParameters new];
uploadParameters.MIMEType = @"application/vnd.google-apps.folder";

GTLQueryDrive *query = nil;
query = [GTLQueryDrive queryForFilesInsertWithObject:self.driveFile
                                    uploadParameters:uploadParameters];

[self.driveService executeQuery:query completionHandler:^(GTLServiceTicket *ticket,
                                                          GTLDriveFile *updatedFile,
                                                          NSError *error) { 
```

但是当我执行查询时，我得到：

'NSInternalInconsistencyException'，原因：'上传数据和文件句柄是互斥的'

这表明我应该使用预定义的 GTLUploadParameters 工厂方法之一：

```
+ (GTLUploadParameters *)uploadParametersWithData:(NSData *)data
                                         MIMEType:(NSString *)mimeType;

+ (GTLUploadParameters *)uploadParametersWithFileHandle:(NSFileHandle *)fileHandle
                                               MIMEType:(NSString *)mimeType; 
```

但是这些都不合适（或者像我尝试过的那样有效）。有没有人在 iOS 上使用 Google Drive 成功创建文件夹？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T23:27:10.763

我这样做：

```
 GTLDriveFile *folderObj = [GTLDriveFile object];
    folderObj.title = folderName;
    folderObj.mimeType = @"application/vnd.google-apps.folder";

    // To create a folder in a specific parent folder, specify the identifier
    // of the parent:
    // _resourceId is the identifier from the parent folder
    if (_resourceId.length && ![_resourceId isEqualToString:@"0"]) {
        GTLDriveParentReference *parentRef = [GTLDriveParentReference object];
        parentRef.identifier = _resourceId;
        folderObj.parents = [NSArray arrayWithObject:parentRef];
    }

    GTLQueryDrive *query = [GTLQueryDrive queryForFilesInsertWithObject:folderObj uploadParameters:nil];

    // executeQuery:... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-11T03:53:07.647

这是另一个更完整的变体：

```
+ (void)createFolderWithService:(GTLServiceDrive *)service
                     folderName:(NSString *)folderName
                       parentId:(NSString *)parentId
                completionBlock:(void (^)(GTLServiceTicket *, GTLDriveFile *, NSError *))completionBlock {
  GTLDriveFile *folderObj = [GTLDriveFile object];
  folderObj.title = folderName;
  folderObj.mimeType = @"application/vnd.google-apps.folder";

  if (parentId.length && ![parentId isEqualToString:@"0"]) {
    GTLDriveParentReference *parentRef = [GTLDriveParentReference object];
    parentRef.identifier = parentId;
    folderObj.parents = [NSArray arrayWithObject:parentRef];
  }

  GTLQueryDrive *query = [GTLQueryDrive queryForFilesInsertWithObject:folderObj uploadParameters:nil];
  [service executeQuery:query completionHandler:completionBlock];
} 
```

# linux - Cmake Unix：链接器问题 - 没有从 target_link_libraries 添加 -L

> ID：13693240
> 
> 赞同：2
> 
> 时间：2012-12-03T22:55:06.343
> 
> 标签：linux, g++, makefile, cmake

我的 cmake 项目在 linux 上遇到了一些链接器问题。

我已经安装了一个包（nvidias Cg 工具包），它将库文件放在 /usr/lib64

我在这里使用查找脚本：[http ://code.google.com/p/nvidia-texture-tools/source/browse/branches/2.0/cmake/FindCg.cmake?r=452](http://code.google.com/p/nvidia-texture-tools/source/browse/branches/2.0/cmake/FindCg.cmake?r=452)

如果我在运行 find 脚本后使用 message() 打印出 CG_LIBRARY 和 CG_GL_LIBRARY，它们都被设置为正确的文件和路径：/usr/lib64/libCg.so-lpthread /usr/lib64/libCgGL.so

查找脚本将 -lpthread 添加到 CG_LIBRARY。我还尝试删除添加它的行并将其手动添加到目标项目中。

然后我使用 target_link_libraries() 将这些变量添加到目标项目中。

当我运行 make 它说： /usr/bin/ld: cannot find -lCg /usr/bin/ld: cannot find -lCgGL collect2: error: ld returned 1 exit status

现在，如果我使用 VERBOSE=1 运行 make，我可以看到没有 -L/usr/lib64 条目。如果我编辑 CMakeFiles/MyProject.dir/link.txt 并手动添加条目，它会很好地链接它。cmake 不应该使用 target_link_libraries() 自动添加 -L 条目吗？我也尝试过使用 link_directories 手动添加 -L ，但这也无济于事..

# codeigniter - 燃料模块禁用创建按钮

> ID：13693242
> 
> 赞同：0
> 
> 时间：2012-12-03T22:55:14.903
> 
> 标签：codeigniter, fuelcms

可以禁用 Fuel CMS 客户模块中的“创建”按钮。

我知道我可以使用 create_action_name 配置名称，但我想禁用该按钮或隐藏它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:02:45.820

```
'item_actions' => array('view') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-22T07:48:26.333

```
$config['modules']['dummy'] = array(
'table_actions'=>array('edit','view','delete'),
'item_actions' => array('edit','save','view','delete')
); 
```

# node.js - Coffeescript / Node.js - 如何根据与 DB 的比较从对象中删除元素

> ID：13693247
> 
> 赞同：0
> 
> 时间：2012-12-03T22:55:39.077
> 
> 标签：node.js, asynchronous, coffeescript, javascript-objects

我正在开发一个将为用户发布定期 XML 更新的项目。我试图压制自上次更新以来没有改变的信息。

在 node.js 中，我组装了一个用于生成 XML 的用户对象：

```
users = 
  # actual application has 25 properties per user
  [
    {
      USERID: 150927,
      EMAIL: 'irving.block@email.net',
      FIRSTNAME: 'Irving',
      LASTNAME: 'Block',
      COLOR: 'Green'
    },
    {
      USERID: 1246007,
      EMAIL: 'allen.adler@email.net',
      FIRSTNAME: 'Adler',
      LASTNAME: 'Allen',
      COLOR: 'Blue'
    },
    {
      CLKEY: 1248350,
      EMAIL: 'walter.pidgeon@email.net',
      FIRSTNAME: 'Walter',
      LASTNAME: 'Pidgeon',
      COLOR: 'Red'
    }
  ] 
```

我还加载了一个对象，它有助于将用户数据映射到最终的 XML 字段：

```
xml_map =
  [
    {
      ID: 1,
      ELEMENT: 'xml_map_assigned_id',
      MAPPPED: 'USERID' 
    },
    {
      ID: 2,
      ELEMENT: 'xml_map_email_address',
      MAPPPED: 'EMAIL' 
    },
    {
      ID: 3,
      ELEMENT: 'xml_map_user_firstname',
      MAPPPED: 'FIRSTNAME' 
    },
    {
      ID: 4,
      ELEMENT: 'xml_map_user_lastname',
      MAPPPED: 'LASTNAME' 
    },
    {
      ID: 5,
      ELEMENT: 'xml_map_user_color',
      MAPPED: 'COLOR'
    }
  ] 
```

使用这些对象，我需要与上次更新进行比较，并删除匹配的属性（因为我只想发布已更改数据的更新）。这是最后一次更新（存储在数据库中）的示例：

```
# nothing like this is used in the real application
# just showing here to give an idea of what the DB could look like
db_data = 
  [ 
    {
      USERID: 150927,
      EMAIL: 'irving.block@email.net',
      FIRSTNAME: 'IRVING',
      LASTNAME: 'Block',
      COLOR: 'Orange'
    },
    {
      USERID: 1246007,
      EMAIL: 'new.email@somewhere.com',
      FIRSTNAME: 'Adler',
      LASTNAME: 'Allen',
      COLOR: 'Blue'
    },
    {
      USERID: 1248350,
      EMAIL: 'walter.pidgeon@email.net',
      FIRSTNAME: 'Walt',
      LASTNAME: 'Pidgeon',
      COLOR: 'Red'
    }
  ] 
```

使用这些示例，我想最终得到一个这样的 User 对象（因为每个用户只有一件事发生了变化）：

```
users_final = 
  [
    {
      USERID: 150927,
      COLOR: 'Orange'
    },
    {
      USERID: 1246007,
      EMAIL: 'new.email@somewhere.com',
    },
    {
      USERID: 1248350,
      FIRSTNAME: 'Walt',
    }
  ] 
```

现在对于显示我一直在尝试完成此操作的伪代码：

```
async = require "async"

handleChanges = (users, map, callback) ->
  sql1 = "select..."
  sql2 = "update..."
  sql3 = "insert..."
  db.query sql1, [], (err, rows, def) ->
    if err? then console.log err
    if rows[0]
      if rows[0].ELEMENT_VALUE.toString() is users[map.MAPPED].toString() 
      # nothing has changed since last update
        db.query sql2, ['Old'], (err, rows, def) ->
          if err? then console.log err
          callback null, map.MAPPED
      else # this value has changed since the last update. Run update query
        db.query sql2, ['New'], (err, rows, def) ->
          if err? then console.log err
          callback null, null
    else # no value has ever been saved for this combo. Run insert query
      db.query sql3, [], (err, rows, def) ->
        if err? then console.log err
        callback null, null

updateStore = (users, callback) ->
  for map in xml_map
    do(map) ->
      handleChanges users, map, (err, del) ->
        if del? then delete r[del]
  callback null, r

async.map users, updateStore, (err, results) ->
  console.log results 
```

这显然是行不通的。我确定 updateStore 函数需要做一些不同的事情，但我不知所措。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T02:49:18.950

我在项目中做了类似的事情，但我使用 json 而不是 xml。

我所做的是从数据库中检索对象列表。并计算每个对象的哈希值。

```
users = 
  [
    {
      USERID: 150927,
      EMAIL: 'irving.block@email.net',
      FIRSTNAME: 'Irving',
      LASTNAME: 'Block',
      COLOR: 'Green'
    },
    {
      USERID: 1246007,
      EMAIL: 'allen.adler@email.net',
      FIRSTNAME: 'Adler',
      LASTNAME: 'Allen',
      COLOR: 'Blue'
    }
  ]
hash = [
  'c8addc875913a367486ba8343f68e349667e0334',
  'df3d067e876437996237d0fde90466703ea303b9'
] 
```

在客户端，我将每个旧哈希与新哈希进行比较。如果不同，我使用 php.js 或 underscore.js。php.js 可以做 array_diff 来获得两个对象之间的差异。当然，您可以通过比较哈希来做 array_diff。

如果您的数据结构是这样嵌套的

```
{
  User: {
    FIRSTNAME: 'Irving',
    LASTNAME: 'Block',
    USERID: 150927
  }
  OtherInfo: {
    EMAIL: 'irving.block@email.net'
  }
} 
```

您可以在执行 array_diff 之前将其展平为跟随，因为 array_diff 仅在一个级别上工作。

```
{
  "User.FIRSTNAME": 'Irving',
  "User.LASTNAME": 'Block',
  "User.USERID": 150927,
  "OtherInfo.EMAIL": 'irving.block@email.net'
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T04:17:52.620

我不确定是否有足够的关于您预期的 XML 输出的信息可供我帮助，但是`users_final`您正在寻找的结果可以使用相当直接的比较算法来计算。核心算法是：

```
difference = (a, b, idFieldName) ->
  if a[idFieldName] != b[idFieldName]
    throw new Error("#{idFieldName} values must match.")
  diff = {}
  diff[idFieldName] = a[idFieldName]
  isDifferent = false
  for key, value of b
    if key != idFieldName and a[key].toUpperCase() != value.toUpperCase()
      isDifferent = true
      diff[key] = value
  if isDifferent
    return diff
  else
    return false 
```

[这](http://coffeescript.org/#try%3ausers%20=%20%0A%20%20#%20actual%20application%20has%2025%20properties%20per%20user%0A%20%20%5B%0A%20%20%20%20%7B%0A%20%20%20%20%20%20USERID%3a%20150927,%0A%20%20%20%20%20%20EMAIL%3a%20%27irving.block@email.net%27,%0A%20%20%20%20%20%20FIRSTNAME%3a%20%27Irving%27,%0A%20%20%20%20%20%20LASTNAME%3a%20%27Block%27,%0A%20%20%20%20%20%20COLOR%3a%20%27Green%27%0A%20%20%20%20%7D,%0A%20%20%20%20%7B%0A%20%20%20%20%20%20USERID%3a%201246007,%0A%20%20%20%20%20%20EMAIL%3a%20%27allen.adler@email.net%27,%0A%20%20%20%20%20%20FIRSTNAME%3a%20%27Adler%27,%0A%20%20%20%20%20%20LASTNAME%3a%20%27Allen%27,%0A%20%20%20%20%20%20COLOR%3a%20%27Blue%27%0A%20%20%20%20%7D,%0A%20%20%20%20%7B%0A%20%20%20%20%20%20USERID%3a%201248350,%0A%20%20%20%20%20%20EMAIL%3a%20%27walter.pidgeon@email.net%27,%0A%20%20%20%20%20%20FIRSTNAME%3a%20%27Walter%27,%0A%20%20%20%20%20%20LASTNAME%3a%20%27Pidgeon%27,%0A%20%20%20%20%20%20COLOR%3a%20%27Red%27%0A%20%20%20%20%7D%0A%20%20%5D%0A%0Adb_data%20=%20%0A%20%20%5B%20%0A%20%20%20%20%7B%0A%20%20%20%20%20%20USERID%3a%20150927,%0A%20%20%20%20%20%20EMAIL%3a%20%27irving.block@email.net%27,%0A%20%20%20%20%20%20FIRSTNAME%3a%20%27IRVING%27,%0A%20%20%20%20%20%20LASTNAME%3a%20%27Block%27,%0A%20%20%20%20%20%20COLOR%3a%20%27Orange%27%0A%20%20%20%20%7D,%0A%20%20%20%20%7B%0A%20%20%20%20%20%20USERID%3a%201246007,%0A%20%20%20%20%20%20EMAIL%3a%20%27new.email@somewhere.com%27,%0A%20%20%20%20%20%20FIRSTNAME%3a%20%27Adler%27,%0A%20%20%20%20%20%20LASTNAME%3a%20%27Allen%27,%0A%20%20%20%20%20%20COLOR%3a%20%27Blue%27%0A%20%20%20%20%7D,%0A%20%20%20%20%7B%0A%20%20%20%20%20%20USERID%3a%201248350,%0A%20%20%20%20%20%20EMAIL%3a%20%27walter.pidgeon@email.net%27,%0A%20%20%20%20%20%20FIRSTNAME%3a%20%27Walt%27,%0A%20%20%20%20%20%20LASTNAME%3a%20%27Pidgeon%27,%0A%20%20%20%20%20%20COLOR%3a%20%27Red%27%0A%20%20%20%20%7D%0A%20%20%5D%0A%0Adifference%20=%20%28a,%20b,%20idFieldName%29%20-%3E%0A%20%20if%20a%5BidFieldName%5D%20!=%20b%5BidFieldName%5D%0A%20%20%20%20throw%20new%20Error%28%22#%7BidFieldName%7D%20values%20must%20match.%22%29%0A%20%20diff%20=%20%7B%7D%0A%20%20diff%5BidFieldName%5D%20=%20a%5BidFieldName%5D%0A%20%20isDifferent%20=%20false%0A%20%20for%20key,%20value%20of%20b%0A%20%20%20%20if%20key%20!=%20idFieldName%20and%20a%5Bkey%5D.toUpperCase%28%29%20!=%20value.toUpperCase%28%29%0A%20%20%20%20%20%20isDifferent%20=%20true%0A%20%20%20%20%20%20diff%5Bkey%5D%20=%20value%0A%20%20if%20isDifferent%0A%20%20%20%20return%20diff%0A%20%20else%0A%20%20%20%20return%20false%0A%0AarrayToMap%20=%20%28a,%20idFieldName%29%20-%3E%0A%20%20result%20=%20%7B%7D%0A%20%20for%20row%20in%20a%0A%20%20%20%20if%20result%5Brow%5BidFieldName%5D%5D?%0A%20%20%20%20%20%20throw%20new%20Error%28%22#%7BidFieldName%7D%20values%20must%20be%20unique%22%29%0A%20%20%20%20result%5Brow%5BidFieldName%5D%5D%20=%20row%0A%20%20return%20result%0A%0AidFieldName%20=%20%27USERID%27%0A%0AusersMap%20=%20arrayToMap%28users,%20idFieldName%29%0A%0Ausers_final%20=%20%5B%5D%0Afor%20b%20in%20db_data%0A%20%20a%20=%20usersMap%5Bb%5BidFieldName%5D%5D%0A%20%20diff%20=%20difference%28a,%20b,%20idFieldName%29%0A%20%20if%20diff%0A%20%20%20%20users_final.push%28diff%29%0A%0Aalert%28JSON.stringify%28users_final,%20undefined,%202%29%29%0A)是一个完整的示例，包括使用您提供的输入......但有一个例外。我认为您的`users`文字中有错字。我将它从 切换`CLKEY`到`USERID`以便它与其他行匹配。只需点击链接后右上角的“运行”按钮即可查看您的预期`users_final`结果。

# php - 如何调整加载到页面上的图像大小？

> ID：13693248
> 
> 赞同：1
> 
> 时间：2012-12-03T22:55:43.517
> 
> 标签：php, css, image, web-scraping

所以我建立了一个网站，加载[Imgur](http://imgur.com)的主页并将图像拉成全尺寸，然后将它们放在我网站的主页上。唯一的问题是一些图像很大，我不知道如何调整它们的大小。我不知道我是否应该使用 CSS、Javascript，或者是否可以使用 PHP。

仅供参考，我正在使用简单的 HTML Dom Scraper

这是我的网站：[www.probablycats.com](http://probablycats.com)

这是我的 PHP 代码：

```
$imgur = file_get_html('http://www.imgur.com');
foreach($imgur->find('div[class="post"]') as $images)
{
    $imagelink = 'http://www.imgur.com/gallery/'.$images->id;
    $imagepage = file_get_html($imagelink);
    foreach($imagepage->find('#image') as $image2)
    {
        echo "<div class=\"images\">$image2</div>";
    } 
```

}

这是我的 CSS 代码：

```
html
{
    background-color:#D0D0D0;
    max-width:100%;
}

.images
{
    padding:20px 20px;
    float:left;
} 
```

所以澄清一下，有些图像很大，超出了屏幕的宽度。我将如何调整它们的大小？如果需要，我可以解释更多，但如果有人可以帮助我，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:57:23.977

最简单的方法是使用 CSS：

```
.images img
{
    max-width: 200px;
} 
```

这将以所需的最大尺寸渲染图像，同时保持原始比例。 **注意：使用 HTML 宽度属性调整大小不会在所有浏览器中保持原始比例**，但不会物理调整图像大小。但是，由于您引用的是来自 Imgur 服务器的图像，因此这不会影响您自己站点的带宽。

要使用 PHP 执行此操作，需要将图像加载到您的服务器上，使用 gd2 或 imagick 调整它们的大小，保存它们，然后引用服务器上保存的图像以在页面上显示。这也可能违反了 Imgur 的 T&C

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T22:57:55.207

您可以在此处指定宽度：

```
echo "<div class=\"images\" width=\"150px\">$image2</div>"; 
```

但是，这仍然会加载整个图像，而不是在技术上将其缩小。因此，如果图像很大，它仍然会加载缓慢

# c++ - int->double->int 是否保证保值？

> ID：13693249
> 
> 赞同：23
> 
> 时间：2012-12-03T22:55:48.000
> 
> 标签：c++, c++11

如果我有 a `int`，将其转换为 a `double`，然后将其转换`double`为a ，`int`我是否保证获得与开始时相同的值？换句话说，给定这个函数：

```
int passThroughDouble(int input)
{
  double d = input;
  return d;
} 
```

我能保证`passThroughDouble(x) == x`所有`int`的 s`x`吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-03T22:59:32.703

不，不是。该标准没有说明 和 的相对`int`大小`double`。

如果`int`是 64 位整数并且`double`是标准 IEEE 双精度，那么对于大于`2^53`.

* * *

也就是说，`int`在今天的大多数环境中仍然是 32 位的。所以它在很多情况下仍然成立。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-04T00:15:58.410

如果我们将考虑限制为浮点类型的“传统”IEEE-754 样式表示，那么当且仅当该类型的尾数`double`具有与非类型中的符号位`int`。

经典 IEEE-754`double`类型的尾数是 53 位宽（包括“隐含”的前导位），这意味着您可以`[-2^53, +2^53]`精确地表示范围内的整数。超出此范围的所有内容通常都会失去精度。

因此，这完全取决于您`int`与`double`. 答案取决于具体的平台。对于 32 位`int`和 IEEE-754 `double`，应该保持相等性。

# java - 如何通过http发送文件和参数

> ID：13693258
> 
> 赞同：2
> 
> 时间：2012-12-03T22:56:23.733
> 
> 标签：java, android

我正在尝试将 zipfile 从我的 android 应用程序发送到我们的服务器，但我不断收到 411 length required 错误。

这是我用来执行此操作的代码。

```
 HttpPost post = new HttpPost("http://www.xyz.org/upload.json");
    post.setHeader(C.constants.HTTP_CONTENT_TYPE, "application/octet-stream");

    try {
        FileInputStream fis = new FileInputStream("/data/data/org.myapp.appname/app_content.zip");

        InputStreamEntity reqEntity = new InputStreamEntity(fis, -1);
        post.setEntity(reqEntity);
        String response = doPost(post);

        Log.v(tag, "response from server " + response);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } 
```

我在这里做错了什么，我是否也知道如何在这篇文章中添加更多参数以将它们发送到服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:02:13.650

您应该使用`multipart`MIME 类型，并为每个参数和文件使用部分。请参阅[我的这篇旧博客文章](http://zybnet.com/java-http-client-and-post-requests/)。

如您所知，HTTP 请求（和响应也是）由两部分组成：标头和正文（也称为*实体*）。在标头中指定 a`Content-Type`以便服务器脚本知道如何解释以下字节（您还可以在同一行上指定文本数据的编码）。

在标头之后，客户端发送一个空行和一个可选实体。多部分实体就像由边界分隔的一堆*部分。*这就是您想要的 HTTP 请求在网络上的样子：

```
POST /path/to/script.json HTTP/1.1
Host: localhost
Content-Type: multipart/form-data; boundary=a2ksdf0?--

a2ksdf0?--
Content-Disposition: form-data; name="profile_picture"; filename="me.png"
Content-Type: image/png

<content here>
a2ksdf0?--
Content-Disposition: form-data; name="username";
Content-Type: text/plain

Joe Black 
```

顺便说一句，这是我第一次看到名为`upload.json`. 你在服务器端使用什么？

# c# - 从锯齿状数组中获取值

> ID：13693260
> 
> 赞同：0
> 
> 时间：2012-12-03T22:56:44.817
> 
> 标签：c#, .net, jagged-arrays

我想创建一个程序来获取学生的姓名和他们在 2 个科目中的分数，并以表格格式显示它们，我使用的是锯齿状数组，如果我只显示标记它工作得很好，但我也想包括学生的名字显示的信息，下面是我的代码。

```
public void GetSquareArray()
        {
            const int STUDENTS = 1;
            const int MARKS = 2;
            string[] numbers = { "First", "Second", "Third", "Fourth", "Fifth" };
            string[][] company_details = new string[STUDENTS][];
            for (int i = 0; i < STUDENTS; i++)
            {
                company_details[i] = new string[MARKS];
                /*Console.WriteLine("Enter {0} Student Name", numbers[i]);
                company_details[i][0] = Console.ReadLine();*/ commenting this works fine
                for (int j = 0; j < MARKS; j++)
                {
                    Console.WriteLine("Enter Marks {0}:", j + 1);
                    company_details[i][j] = Console.ReadLine();
                }
            }

            for (int x = 0; x < STUDENTS; x++)
            {
                /*Console.Write("STUDENTS {0}: ", company_details[x]);*/ commenting this works fine.
                for (int y = 0; y < MARKS; y++)
                {
                    Console.Write("{0}\t", company_details[x][y]);
                }
                Console.WriteLine("");
            }
        } 
```

谁能告诉我如何在显示的信息中包含学生信息（姓名），就像它应该显示的一样

```
Abbas: 12   12 
```

# sql - 在 PL/SQL 中创建引用

> ID：13693261
> 
> 赞同：1
> 
> 时间：2012-12-03T22:56:50.310
> 
> 标签：sql, oracle, user-defined-types

基本上，我想创建对记录的引用，一种记录类型是另一种的超类型。我对此有点困惑。

这是我的类型：

```
 CREATE OR REPLACE TYPE  module_t AS OBJECT (
     moduleCode# char(4),
     moduleName char(10)
) NOT FINAL;
/

CREATE OR REPLACE TYPE  specialised_module_t under module_t (
     someSpecialAttribute char(10)
);
/

CREATE OR REPLACE TYPE  course_t AS OBJECT (
     courseCode# char(4),
     module1 REF module_t,
     module2 REF specialised_module_t
);
/ 
```

这是我的表：

```
CREATE TABLE module_tab OF module_t(
    moduleCode# PRIMARY KEY NOT NULL
);

CREATE TABLE course_tab OF course_t(
    courseCode# PRIMARY KEY NOT NULL,
    scope for (module1) is module_tab,
    scope for (module2) is module_tab
); 
```

我在包含标准模块的模块表中插入一条记录：

```
insert into module_tab values(
'm001', 'physics'
); 
```

我将一条记录插入到由专用模块组成的模块表中：

```
insert into module_tab
    values( specialised_module_t(
    'm002',
    'physics',
    'special'
    )
); 
```

这是棘手的一点：

我想在课程表中创建课程记录。在这条记录中，`module1`属性需要引用模块`m001`（第一个模块记录），`module2`属性需要引用模块`m002`

我曾想过它可能看起来像这样：

```
INSERT into course_tab VALUES(
       'c001',
        SELECT REF(c) FROM module_tab c WHERE c.moduleCode# = 'm001',
        SELECT REF(c) FROM module_tab c WHERE c.moduleCode# = 'm002'
) 
```

这只是行不通:(

这是错误消息：

```
ERROR at line 3:
ORA-00936: missing expression 
```

显然我的语法是错误的，但我不知道如何纠正它：/

我在这上面花了很长时间，但我无法弄清楚:(
非常感谢帮助 :D
谢谢

更新：

在@a_horse_with_no_name 的帮助下，我的新代码是：

```
INSERT into course_tab VALUES(
       'c001',
        (SELECT REF(c) FROM module_tab c WHERE c.moduleCode# = 'm001'),
        (SELECT treat(REF(c) as ref specialised_module_t) FROM module_tab c WHERE treat(values(c) as moduleCode).person# = 'm002')
); 
```

但现在我得到了错误：

```
ERROR at line 4:
ORA-00936: missing expression 
```

请帮忙，谢谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T08:40:27.030

如果要使用 SELECT 语句在 VALUES 子句中插入标量值，则需要将 SELECT 语句放在括号之间：

```
INSERT into course_tab 
   (coursecode#, module1, module2)
VALUES 
   (
    'c001',
    (SELECT REF(c) FROM module_tab c WHERE c.moduleCode# = 'm001'),
    (SELECT REF(c) FROM module_tab c WHERE c.moduleCode# = 'm002')
   ); 
```

尽管当我使用您的示例进行尝试时（顺便说一句，其中还有很多其他语法错误），但我收到了错误消息：

> ORA-00932: 不一致的数据类型: 预期 REF SPECIALISED_MODULE_T 得到 REF MODULE_T [SQL 状态 = 42000，数据库错误代码 = 932]

不过，我真的不知道该怎么做（正如我所说，我还没有真正使用过 Oracle 对象类型，并且表定义对`course_tab`我来说是全新的。

# python - Python中的单行和多行循环和向量化

> ID：13693275
> 
> 赞同：4
> 
> 时间：2012-12-03T22:57:50.153
> 
> 标签：python, loops

Python中的单行循环只能用于构建列表吗？（即列表推导），还是可以用于更通用的计算？

例如，我知道 Python 中的列表推导（~单行循环），例如

```
my_list = [ 2*i for i in range(10)] 
```

也可以用多行循环构建：

```
my_list = []
for i in range(10):
    my_list.append(2*i) 
```

但是我们**总**能把一般的多线循环转换成单线循环吗？

例如，假设我们有以下多行 for 循环：

```
my_array = np.ones(10*10)

for x in range(10):
     my_array[x,:] = 0 
```

我们可以将其转换为单行循环吗？更普遍：

**Q1。**这两种形式在功能上是等价的吗？（即它们支持相同的操作/操作集）

**Q2。**我想我之前读过 Python 中的单行循环是**矢量化**的。这是真的？这是否意味着它们可以比多行循环**更快地迭代？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T23:02:39.280

> 但是我们是否总是可以将 Python 中的一般多行循环转换为单行循环？

最简洁的答案是不。

列表推导适用于投影（映射）和/或过滤。

例如，如果您有这样的代码：

```
result = []
for x in seq:
    if bar(x):
        result.append(foo(x)) 
```

然后，正如您所指出的，它可以从重写为列表理解中受益：

```
result = [foo(x) for f in seq if bar(x)] 
```

然而，列表推导通常不适合不适合此投影或过滤模式的操作。

例如，如果您需要改变元素但不需要结果，则列表推导不适合。以下代码不方便编写为列表推导式（假设两种方法都返回`None`）：

```
for x in seq:
    x.foo()    # Modify x
    x.bar()    # Modify x again 
```

理解中不允许某些操作。一个例子是，如果满足条件，则提前退出循环：

```
for x in seq:
    if x.foo():
        break
    else:
        x.bar() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:06:28.387

我要指出的一件事是它不仅仅是列表，您可以使用理解来创建集合甚至字典。

```
>>> {i**2 for i in range(5)}
set([0, 1, 4, 16, 9])
>>> {i : str(i) for i in range(5)}
{0: '0', 1: '1', 2: '2', 3: '3', 4: '4'} 
```

此外，列表理解*通常*比使用`append`多次（如您的示例）更快，因为理解是由底层 C 代码完成的，而不是`append`具有额外 Python 层的 .

当然，理解与其他任何事物一样有局限性。如果您想对列表/集合的每个元素执行更大的操作集，那么普通循环可能更合适。

# javascript - 带有 twitter bootstrap 的日期范围选择器

> ID：13693278
> 
> 赞同：1
> 
> 时间：2012-12-03T22:57:56.917
> 
> 标签：javascript, jquery, html, forms, twitter-bootstrap

我正在使用 twitter 引导程序，找不到任何符合我需要或 html 的日期选择器。

我有一个表格，里面有一些选择标签。我想知道如何为 twitter bootstrap 插入一个日期选择器，然后在用户提交请求后发送相关的选择日期。到目前为止，这是我的 html：

```
<div class="row">
<div class="span11">
<form id ="eventForm">         
     <select name="event" id="abc">
        <option value="w" selected="selected">US</option>
        <option value="e">uk</option>
        <option value="r">prk</option>
        <option value="t">chn</option>  
     </select>

     <select name="period" id="time">
        <option value="beginning" selected="selected">from start</option>
        <option value="the last 24 hours">Last 24 hours</option>
        <option value="the previous week">Previous week</option>  
     </select>

    <input type="submit" id="open" onclick="heading()" value="Start" />
    <input type="button" onclick="closeMap()" value="Stop Request"/>
</form>
</div>

 <div class="span1">
   <form name="moreAnalysis" id="moreAnalysis" action="/p" method="post">
    <input type="submit" value="Further Analysis">
   </form>
 </div>
</div> 
```

因此，理想情况下，我让用户选择时间段，我希望他们从日期菜单中进行选择。

我已经尝试了几个选项，但似乎都没有工作，这作为一个 html/javascript 新手已经花了一整天的时间。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:01:08.610

我会推荐 Stafan Petre 的这个

[http://www.eyecon.ro/bootstrap-datepicker/](http://www.eyecon.ro/bootstrap-datepicker/)

# sql - 在表格或列中查找文本

> ID：13693287
> 
> 赞同：-2
> 
> 时间：2012-12-03T22:58:54.210
> 
> 标签：sql, sql-server, search

我有一个带有 column 的表`dbo.tb_item_description`。在其中，我想找到字符串 'For North America Only' 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:07:41.393

看起来你想要[charindex](http://msdn.microsoft.com/en-us/library/aa258228%28v=sql.80%29.aspx)。

# ios - 加密 iOS Xcode

> ID：13693291
> 
> 赞同：0
> 
> 时间：2012-12-03T22:59:10.983
> 
> 标签：ios, base64

我对私有的网络服务有疑问。我的意思是为了访问这个网络服务我需要用户名..我怎样才能进入我的网络服务内部。你有什么建议吗？

有一些视觉 - [http://www.test.com/event](http://www.test.com/event) （这是一个例子）

```
-(void)startConnection
{
    NSString *urlString = GET_EVENT_URL_STRING;

    NSURL *url = [NSURL URLWithString:urlString];

    if (!url)
    {
        NSString *reason = [NSString stringWithFormat:@"Could not create URL from string %@", GET_EVENT_URL_STRING];
        [self.delegate didGetEventInCorrect:reason];
        return;
    }

        theRequest = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval: 30.0];

    // Set the HTTP method of the request to POST
    [theRequest setHTTPMethod:@"POST"];

    if (!theRequest)
    {
        NSString *reason = [NSString stringWithFormat:@"Could not create URL request from string %@", GET_EVENT_URL_STRING];
        [self.delegate didGetEventInCorrect:reason];
        return;
    }

    theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

    if (!theConnection)
    {
        NSString *reason = [NSString stringWithFormat:@"URL connection failed for string %@", GET_EVENT_URL_STRING];
        [self.delegate didGetEventInCorrect:reason];
        return;
    }

    if (theConnection)
    {
        myData = [[NSMutableData alloc]init];
    }
} 
```

例如，当我单击此链接时，我有一个带有用户名和密码屏幕的警报..当我输入我可以访问的信息时..此代码用于连接我的网络服务，我该如何管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:07:19.463

您需要将身份验证标头添加到您的`theRequest`对象。

```
NSString *authStr = [NSString stringWithFormat:@"%@:%@", [self username], [self password]];
NSData *authData = [authStr dataUsingEncoding:NSASCIIStringEncoding];
NSString *authValue = [NSString stringWithFormat:@"Basic %@", [authData base64EncodingWithLineLength:80]];
[theRequest setValue:authValue forHTTPHeaderField:@"Authorization"]; 
```

# c# - 用于标准浏览器的 Web 上的 C# XNA 代码

> ID：13693292
> 
> 赞同：0
> 
> 时间：2012-12-03T22:59:13.867
> 
> 标签：c#, browser, web, xna, executable

显然，有一种方法可以将 C# XNA 项目添加到网站，这样就可以从普通的 Web 浏览器在网站上查看它们，大概浏览器会强制执行安全方面的让步。

这是怎么做到的？

编辑：我认为 C# 项目可能只在服务器上运行，客户端被发送它可以理解的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:17:56.010

有[http://jsil.org](http://jsil.org)可以将已编译的 .Net 应用程序转换为客户端 Javascript“应用程序”......并且已经证明可以在 XNA 游戏上相当成功地工作。

它只处理 2D 的东西，并且在我上次检查时需要手动重写声音，但从我所看到的情况来看，它的工作非常令人印象深刻。

应该注意的是，虽然这可以完成工作，但它肯定不会产生接近从一开始就用 JS 编写的游戏的质量（即可维护性）的 JS（使用类似 three.js 或 easle 的东西） .js)...因此，如果这用于商业产品，您可能希望探索专门为网络重写/移植游戏作为一种严肃的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:10:29.567

没有插件这是不可能的。显然，该插件只能在 Windows 上运行，因为 XNA 是基于 DirectX 构建的。

据我所知，目前没有插件可以做到这一点。

编写插件并不难，但是，您必须为要运行插件的每个浏览器执行此操作。

如果您希望您的游戏内容在网络上，更好的途径可能是[HTML5 及其 Canvas 功能](http://net.tutsplus.com/articles/web-roundups/21-ridiculously-impressive-html5-canvas-experiments/)，它适用于所有现代浏览器。[您可能会对这篇文章](http://blogs.msdn.com/b/davrous/archive/2011/09/09/html5-platformer-the-complete-port-of-the-xna-game-to-lt-canvas-gt-with-easeljs.aspx)感兴趣，该文章讨论了将 2D XNA 游戏移植到 HTML5 Canvas。

如果您需要 3D 支持，您可以使用 HTML5 WebGL 路线，尽管 Internet Explorer 不支持它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:49:59.490

您可能想要的是[Google Native Client (NaCl)](https://developers.google.com/native-client/)。我还没有玩过它（还），但据我所知，一些像 Unity 这样的游戏引擎可以使用它。

希望能帮助到你。

# javascript - li 元素的斑马条纹组

> ID：13693293
> 
> 赞同：4
> 
> 时间：2012-12-03T22:59:25.190
> 
> 标签：javascript, jquery

我有以下 HTML，我想以 3 组为一组对内容进行斑马条纹处理：

```
<ul id="item-order">

    <li class="thumbnail">Item 1</li>
    <li class="thumbnail">Item 2</li>
    <li class="thumbnail">Item 3</li>
    <li class="thumbnail">Item 4</li>
    <li class="thumbnail">Item 5</li>
    <li class="thumbnail">Item 6</li>
    <li class="thumbnail">Item 7</li>
    <li class="thumbnail">Item 8</li>
    <li class="thumbnail">Item 9</li>

</ul> 
```

所以我想使用jQuery生成以下内容：

```
<ul id="item-order">
    <li class="thumbnail stripe">Item 1</li>
    <li class="thumbnail stripe">Item 2</li>
    <li class="thumbnail stripe">Item 3</li>
    <li class="thumbnail">Item 4</li>
    <li class="thumbnail">Item 5</li>
    <li class="thumbnail">Item 6</li>
    <li class="thumbnail stripe">Item 7</li>
    <li class="thumbnail stripe">Item 8</li>
    <li class="thumbnail stripe">Item 9</li>
</ul> 
```

我该怎么办？我有这样的想法，但我不确定在 if 语句中放什么。

```
$('#item-order li:visible').each(function (i) {
    if (...) $(this).addClass('stripe');
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T23:05:23.080

如果要将其添加到 6 组中的前 3 个中，可以使用模 6 运算符。如果您想从条纹开始，请使用以下内容：

```
$('#item-order li:visible').each(function (i) {
    if (i%6 <= 2) {
        $(this).addClass('stripe');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:00:48.703

jquery 有 :odd 和 :even 选择器，所以你可以这样做：

```
$( '#item-order li:odd' ).addClass( 'odd' );
$( '#item-order li:even' ).addClass( 'even' ); 
```

编辑，完全没有抓住重点，这应该是你想要的：

```
$('#item-order li:visible').each(function (i) {
    if( i % 6 <= 2 ) $(this).addClass('stripe');
}); 
```

# c++ - 到目前为止添加到 C++1y 的语言功能

> ID：13693294
> 
> 赞同：1
> 
> 时间：2012-12-03T22:59:26.973
> 
> 标签：c++, standards, c++14

我可以在某处找到迄今为止已被 C++1y 工作文件接受的语言特性列表，最好带有已合并的提案文件的链接？

[http://gcc.gnu.org/gcc-4.8/changes.html](http://gcc.gnu.org/gcc-4.8/changes.html)建议 N3386 （“正常功能的返回类型扣除”）可能已被接受，但我想知道去哪里正式检查（除了手动检查最新的工作草案以查看论文的提议措辞是否已合并）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:50:01.460

没有简单的方法可以确定提案是否已被接受（但...）。官方信息可在对提案进行投票的会议的会议记录中获得。N3386 是在[2012 年波特兰之前的邮件](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/#mailing2012-09)中，所以如果你去[波特兰会议](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3454.pdf)的会议记录（或者，更确切地说，论文发布后的每次会议，在这种情况下只是波特兰会议），然后去那个部分有你应该看到的票数，如果它被批准应用于工作文件。除非我弄错了，否则不是。

有趣的是，这些会议纪要包括有人提出缺少文件状态列表的问题……另一个人自愿保留这样的列表，但我不知道这是否已经完成。

* * *

论文[列表](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/)似乎有一个新列，列出每篇论文的“处置”，说明论文是否已被较新版本修订或是否已被采用。我不确定这个列表是如何保持最新的，但这似乎是现在获取这些信息的最简单方法。

# c++ - 使用 KDevelop 4.4.1 的未定义参考

> ID：13693299
> 
> 赞同：0
> 
> 时间：2012-12-03T22:59:43.510
> 
> 标签：c++, reference, kdevelop

我是 C++ 的初学者。我写了以下内容：

```
// GradeBook.h
#include <iostream>
#include <string> 
using namespace std;

class GradeBook { 
public:
    GradeBook(string); // constructor that initializes courseName
    void setCourseName(string); // function that sets the course name
    string getCourseName(); // function that gets the course name
    void displayMessage(); // function that displays a welcome message 
private:
    string courseName; // course name for this GradeBook
};

// GradeBook.cpp
#include <iostream>
#include "GradeBook.h"
using namespace std;

GradeBook::GradeBook(string name)
{
    setCourseName(name);
} 

void GradeBook::setCourseName(string name)
{
    courseName = name;
}

string GradeBook::getCourseName()
{
    return courseName;
}

void GradeBook::displayMessage()
{
    cout << "Welcome to the grade book for\n" << getCourseName() << "!" << endl;
}

// main.cpp
#include <iostream>
#include "GradeBook.h"
using namespace std;

int main()
{
    GradeBook gradeBook1("CS101 Introduction to C++ Programming");
    GradeBook gradeBook2("CS102 Data Structures in C++");

    cout << "gradeBook1 created for course: " << gradeBook1.getCourseName()
         << "\ngradeBook2 created for course: " << gradeBook2.getCourseName()
         << endl;
} 
```

我正在使用 KDevelop 4.4.1，然后我继续执行我的 main.cpp，我得到了：

> /home/brallan/projects/Hola/build> 使
> 链接 CXX 可执行 hola
> CMakeFiles/hola.dir/main.o：在函数 main'： /home/brallan/projects/Hola/main.cpp:
> 8：未定义对 GradeBook 的引用::GradeBook(std::string)'
> /home/brallan/projects/Hola/main.cpp:9: 未定义对 GradeBook::GradeBook(std::string)'
> /home/brallan/projects/Hola/main 的引用。 cpp:12: 未定义对 GradeBook::getCourseName()'
> /home/brallan/projects/Hola/main.cpp:11: 未定义引用 GradeBook::getCourseName()'
> collect2: error: ld 返回 1 个退出状态
> make[ 2]: [hola] 错误 1
> ​​make[1]: [CMakeFiles/hola.dir/all] 错误 2
> make: [all] 错误 2
> 失败

如果我从 Eclipse Juno CDT 运行相同的代码，它会返回：

```
gradeBook1 created for course: CS101 Introduction to C++ Programming
gradeBook2 created for course: CS102 Data Structures in C++ 
```

谁能帮我从 KDevelop 运行它？

**更新：**根据评论，KDevelop 没有编译项目中的其他文件：s 我想这是要解决的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T05:10:04.073

首先，将该行`#error`（或任何其他语法错误）添加到 GradeBook.cpp 的末尾。确保在尝试构建该行时收到编译错误。如果不是，请检查项目或 makefile 中文件引用的拼写和大小写。

如果您确实收到语法错误，或者如果您没有但无法弄清楚为什么没有引用该文件，请尝试以下操作：`#error`从 GradeBook.cpp 中删除，并添加`#include "GradeBook.cpp"`到 main.cpp 的末尾. 这有两个目的：它让你开始（现在应该能够构建和运行）并且它有助于缩小问题（如果它有效，你知道问题在于引用 GradeGook.cpp，而不是它的内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T08:46:46.097

看来您没有编译 GradeBook.cpp

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T01:15:57.343

在项目文件夹中，有一个名为 CMakeList.txt 的文件，上面是项目的一部分。我尝试将文件 GradeBook.cpp 添加到 add_executable 行，但仍然没有工作。但是，当我用小写替换文件名并修改我描述的行时，一切正常。我不确定如果文件名没有大写或类似的错误，如果我将它添加到此列表中，就像它所调用的一样。

然后，我重命名了文件gradebook.h 和gradebook.cpp 并将gradebook.cpp 添加到add_executable 行。

# fiddler - 用于在远程机器上运行的网站的提琴手

> ID：13693300
> 
> 赞同：7
> 
> 时间：2012-12-03T22:59:48.327
> 
> 标签：fiddler

我需要监控远程 Web 服务器上运行的网站的 http 请求和响应。Web 服务器进行大量 Web 服务调用并希望跟踪它们。

如果网站在本地运行，Fiddler 会跟踪每个 Web 服务调用请求并为我提供报告。有人可以帮我解决同样的问题吗

*例如

*如果 Web 应用程序在本地运行并调用两个 Web 服务，fiddler 会显示统计的总时间。但是，如果 Web 应用程序在托管在内部托管的不同 Web 服务器（Intranet）上的 Web 服务器上运行，并且我在我的机器上运行了 fiddler，我不会获得每个 Web 服务调用的统计信息。我只能看到 aspx 页面的总时间。**

所以问题是（如果可能的话）我如何跟踪由运行在不同机器上的 Web 应用程序调用的每个 Web 服务的统计信息，并且 Fiddler 正在我的机器上运行。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T11:06:58.333

如果你和服务器在同一个网络上，你总是可以使用 WireShark [http://www.wireshark.org/](http://www.wireshark.org/)来捕获所有的数据包。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T21:32:54.217

假设您正在一台名为 WEBSERVER 的机器的 80 端口上运行一个网站。您在无法配置 Web 代理的 Windows 智能手机设备上使用 Internet Explorer 移动版连接到网站。您想要捕获来自电话的流量和服务器的响应。

> 0.) 在 WEBSERVER 机器上启动 Fiddler，在默认端口 8888 上运行。

```
1.)Click Tools | Fiddler Options, and ensure the "Allow remote clients to connect" checkbox is checked.  Restart if needed.
2.)Choose Rules | Customize Rules.
3.)Inside the OnBeforeRequest handler, add a new line of code:
if (oSession.host.toLowerCase() == "webserver:8888") oSession.host = "webserver:80";
5.)  navigate to http://webserver:8888 
```

来自 SmartPhone 的请求将出现在 Fiddler 中。请求从端口 8888 转发到运行 Web 服务器的端口 80。响应通过 Fiddler 发送回 SmartPhone，它不知道内容最初来自端口 80。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T19:05:20.827

您可以在您的机器中设置 Fiddler，并将其设置为您想要跟踪的 Web 应用程序中的代理。在网络内部很容易，在互联网上则不那么容易。

# sql - SQL Server：如果不存在则添加行，增加一列的值，原子

> ID：13693302
> 
> 赞同：9
> 
> 时间：2012-12-03T22:59:48.767
> 
> 标签：sql, sql-server, sql-server-2008, atomic

我有一个记录用户操作的表。每完成一个动作，价值就需要增加。由于用户可以同时拥有多个会话，因此该进程需要是原子的以避免多用户问题。

该表有 3 列：

*   `ActionCode`作为`varchar`
*   `UserID`作为`int`
*   `Count`作为`int`

我想将`ActionCode`and传递`UserID`给一个函数，如果一个新行不存在，它将添加一个新行，并将计数设置为 1。如果该行确实存在，它只会将计数增加一。 `ActionCode`并`UserID`构成该表的主唯一索引。

如果我需要做的只是更新，我可以做一些简单的事情（因为`UPDATE`查询已经是原子的）：

```
UPDATE (Table)
SET Count = Count + 1 
WHERE ActionCode = @ActionCode AND UserID = @UserID 
```

我是 SQL 中原子事务的新手。这个问题可能已经在这里的多个部分得到了回答，但我很难找到这些部分并将这些部分放在一个解决方案中。这也需要非常快，不要变得复杂，因为这些操作可能会经常发生。

编辑：对不起，这可能是[MySQL 如何在单个查询中执行 if exists increment](https://stackoverflow.com/questions/4728325/mysql-how-to-do-an-if-exist-increment-in-a-single-query)的欺骗。我搜索了很多，但`tsql`在我的搜索中，一旦我改为`sql`改为，那是最好的结果。这是否是原子的并不明显，但可以肯定的是。我可能会投票删除这个作为欺骗，除非有人认为这个问题和答案可以增加一些新的价值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T23:03:23.093

假设您在 SQL Server 上，要制作单个原子语句，您可以使用[MERGE](http://technet.microsoft.com/en-us/library/bb510625.aspx)

```
MERGE YourTable AS target
USING (SELECT @ActionCode, @UserID) AS source (ActionCode, UserID)
ON (target.ActionCode = source.ActionCode AND target.UserID = source.UserID)
WHEN MATCHED THEN 
    UPDATE SET [Count] = target.[Count] + 1
WHEN NOT MATCHED THEN   
    INSERT (ActionCode, UserID, [Count])
    VALUES (source.ActionCode, source.UserID, 1)
OUTPUT INSERTED.* INTO #MyTempTable; 
```

**更新**如有必要，使用输出选择值。代码更新了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:21:52.453

在 SQL Server 2008 中使用 MERGE 可能是最好的选择。还有另一种简单的方法来解决它。

如果 UserID/Action 不存在，请使用 0 插入新行`Count`。如果该语句由于它已经存在而失败（正如另一个并发会话刚刚插入的那样），只需忽略该错误。

如果您想在执行时执行插入和阻塞以消除任何错误的机会，您可以添加一些锁定提示：

```
INSERT dbo.UserActionCount (UserID, ActionCode, Count)
SELECT @UserID, @ActionCode, 0
WHERE NOT EXISTS (
   SELECT *
   FROM dbo.UserActionCount WITH (ROWLOCK, HOLDLOCK, UPDLOCK)
   WHERE
      UserID = @UserID
      AND ActionCode = @ActionCode
); 
```

然后像往常一样使用 + 1 进行更新。问题解决了。

```
DECLARE @NewCount int,

UPDATE UAC
SET
   Count = Count + 1,
   @NewCount = Count + 1
FROM dbo.UserActionCount UAC
WHERE
   ActionCode = @ActionCode
   AND UserID = @UserID; 
```

注意 1：MERGE 应该没问题，但要知道，仅仅因为某事在一个语句中完成（因此是原子的）并不意味着它没有并发问题。在查询执行的整个生命周期中，随着时间的推移获取和释放锁。像下面这样的查询将遇到并发问题，导致重复 ID 插入尝试，尽管是原子的。

```
INSERT T
SELECT (SELECT Max(ID) FROM Table) + 1, GetDate()
FROM Table T; 
```

注 2：我在超高事务量系统中经验丰富的人员阅读的一篇文章说，他们发现“try-it-then-handle-any-error”方法提供比获取和释放锁更高的并发性。这可能并非在所有系统设计中都是如此，但至少值得考虑。此后我多次（包括刚刚）搜索过这篇文章，但无法再次找到它......我希望有一天能找到它并重读它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T05:28:16.950

万一其他人需要语法在存储过程中使用它并返回插入/更新的行（我很惊讶 insert.* 也返回更新的行，但确实如此）。这就是我最终得到的。我忘记了我的主键（ActionKey）中有一个额外的列，它反映在下面。如果只想返回Count，也可以做“输出插入.Count”，比较实用。

```
CREATE PROCEDURE dbo.AddUserAction
(
@Action varchar(30),
@ActionKey varchar(50) = '',
@UserID int
)
AS

MERGE UserActions AS target
USING (SELECT @Action, @ActionKey, @UserID) AS source (Action, ActionKey, UserID)
ON (target.Action = source.Action AND target.ActionKey = source.ActionKey AND target.UserID = source.UserID)
WHEN MATCHED THEN 
    UPDATE SET [Count] = target.[Count] + 1
WHEN NOT MATCHED THEN   
    INSERT (Action, ActionKey, UserID, [Count])
    VALUES (source.Action, source.ActionKey, source.UserID, 1)
output inserted.*; 
```

# html - 家谱嵌套列表中的相对位置

> ID：13693303
> 
> 赞同：0
> 
> 时间：2012-12-03T22:59:51.390
> 
> 标签：html, css

我正在尝试制作具有多个父选项的家谱。我环顾四周，并没有发现任何与这方面有关的东西。

从[http://thecodeplayer.com/walkthrough/css3-family-tree](http://thecodeplayer.com/walkthrough/css3-family-tree)开始，我对其进行了一些修改以得到这个： [http ://www.gmrv.es/~sschvartzman/Sara_C._Schvartzman/prueba.html](http://www.gmrv.es/~sschvartzman/Sara_C._Schvartzman/prueba.html)

婚姻链接只是父母列表的另一个元素，但高度为 0。我现在的问题是我不能让孩子们在婚姻中处于中心地位。也就是说，在示例中，将第二次婚姻的孩子设置为家庭的权利。只有孩子 2.1 和 2.2 在第二次婚姻中居中。

如果我将子列表的所有元素都设置为 position:relative，为什么会发生这种情况？

这是html代码：

```
 <!DOCTYPE html>
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link href="tree.css" rel="stylesheet">
<title>Family Tree</title>
</head>
<body>
<div class="tree">
  <ul class="pf">
    <li class="parent"><a href="" class="m">
      <div style="display:inline-block; vertical-align:central; padding:30px 10px; width:80px;">Husband<br>1<span>(1861 - 1894)</span></div>
      </a>
    </li>
    <li class="marriage">
          <ul class="c">
            <li><a href="indi.asp?id=13612" class="md">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px;">Child<br>
                1.1<span>(1893 - 1919)</span></div>
              </a></li>
            <li><a href="indi.asp?id=13613" class="f">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px;">Child<br>
                1.2<span>(1895 - )</span></div>
              </a>               
            </li>

          </ul>
    </li>  

    <li class="parentWithAncestor"><a href="" class="f">
      <div style="display:inline-block; vertical-align:central; padding:30px 10px; width:80px;">Main <br>Person<span>(1866 - )</span></div>
      </a>
    </li>    

    <li class="marriage" style="position: relative">
          <ul class="c" style="position: relative">
            <li style="position: relative"><a href="indi.asp?id=04947" class="md" style="position: relative">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px; position: relative">Child<br>
                2.1<span>(1900 - 1943)</span></div>
              </a>
            </li>
            <li style="position: relative"><a href="indi.asp?id=04950" class="m" style="position: relative">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px; position: relative">Child<br>
                2.2<span>(1902 - )</span></div>
              </a></li>
            <li style="position: relative"><a href="indi.asp?id=04950" class="m" style="position: relative">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px; position: relative">Child<br>
                2.3<span>(1902 - )</span></div>
              </a></li>
            <li style="position: relative"><a href="indi.asp?id=04950" class="m" style="position: relative">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px; position: relative">Child<br>
                2.4<span>(1902 - )</span></div>
              </a></li>
            <li style="position: relative"><a href="indi.asp?id=04950" class="m" style="position: relative">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px; position: relative">Child<br>
                2.5<span>(1902 - )</span></div>
              </a></li>
            <li style="position: relative"><a href="indi.asp?id=04950" class="m" style="position: relative">
              <div style="display:inline-block; vertical-align:text-top; padding:30px 10px; position: relative">Child<br>
                2.6<span>(1902 - )</span></div>
              </a></li>
          </ul>
    </li>
    <li class="parent"><a href="" class="m">
      <div style="display:inline-block; vertical-align:central; padding:30px 10px; width:80px;">Husband<br>2<span>(1861 - 1894)</span></div>
      </a>
    </li>
  </ul>
</div>
</body>
</html> 
```

和CSS：

```
.tree * {margin: 0; padding: 0;}

body {

    font-family: arial, verdana, tahoma;
    font-size: 12px;
    color: #666;
    background-color:#fff;

}

.tree{
    white-space:nowrap;
}

.tree ul {
    padding-top: 5px; position: relative;
    display: table;
    margin: 0 auto;
    font-size:0;

    transition: all 0.5s;
    -webkit-transition: all 0.5s;
    -moz-transition: all 0.5s;
}

.tree li {
    //float: left; 
    display:inline-block;
    text-align: center;
    list-style-type: none;
    position: relative;
    padding: 70px 5px 0 5px;
    font-size: 12px;

    transition: all 0.5s;
    -webkit-transition: all 0.5s;
    -moz-transition: all 0.5s;
}

/*We will use ::before and ::after to draw the connectors*/

.tree li::before, .tree li::after{
    content: '';
    position: absolute; top: 0; right: 50%;
    border-top: 1px solid #ccc;
    width: 50%; height: 70px;
}
.tree li::after{
    right: auto; left: 50%;
    border-left: 2px solid #ccc;
}

/*We need to remove left-right connectors from elements without 
any siblings*/
.tree li:only-child::after {
    display: none;
}

/*Remove space from the top of single children*/
//.tree li:only-child{ padding-top: 0;}

/*Remove left connector from first child and 
right connector from last child*/
.tree li:first-child::before, .tree li:last-child::after{
    border: 0 none;
}

/*Adding back the vertical connector to the last nodes*/
.tree li li:last-child::before{
    border-right: 2px solid #ccc;
    border-radius: 0 5px 0 0;
    -webkit-border-radius: 0 5px 0 0;
    -moz-border-radius: 0 5px 0 0;
}
.tree li:first-child::after{
    border-radius: 5px 0 0 0;
    -webkit-border-radius: 5px 0 0 0;
    -moz-border-radius: 5px 0 0 0;
}

.tree li li:only-child::before {
    right: auto; left: 50%;
    border-left: 2px solid #ccc;
    border-right:none;
}

.tree ul.p>li::before {
    border:none;
    content: '&';
    left:0;
    width:100%; 
    }

.tree ul.p>li::after{
    content: '';
    position: absolute; top: 0; right: 50%;
    border-top: none;
    width: 50%; height: 20px;
}

.tree ul.p>li::after{
    border-left: none;
}

/* Use pf to indicate that its a child of another family. */
.tree ul.pf>li::before {
    right: auto; left: 50%;
    border-left: 2px solid #ccc;
    border-right:none;
    }

.tree ul.pf>li::after{
    content: '';
    position: absolute; top: 0; right: 50%;
    border-top: none;
    width: 50%; height: 20px;
}

.tree ul.pf>li::after{
    border-left: none;
}

/*Time to add downward connectors from parents*/

.tree ul.c {
    padding-top: 70px; 
    }

.tree ul ul.c::before{
    content: '';
    position: absolute; top: 0; left: 50%;
    border-left: 2px solid #ccc;
    width: 0; height: 20px;
    border: none;
}

.tree li a{
    border: 1px solid #ccc;
    padding: 0px;
    text-decoration: none;
    color: #666;
    background-color:#fff;
    /*background-image:url(circle.jpg)*/
    /*color: #fff;
    background-color:#999;*/
    display: inline-block;
    min-width:50px;

    border-radius: 5px;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;

    transition: all 0.5s;
    -webkit-transition: all 0.5s;
    -moz-transition: all 0.5s;
}

.tree li a span{
    display:block;
    font-size: 10px;

    }   

.tree li a.m{width:100px;height:100px;border-radius:15px;font-size:12px;color:#000;text-align:center;background: #c8e4fb; box-shadow:1px 1px 2px #000}
.tree li a.f{width:100px;height:100px;border-radius:50px;font-size:12px;color:#000;text-align:center;background: #ffc0cb; box-shadow:1px 1px 2px #000}
.tree li a.m_dead{width:100px;height:100px;border-radius:15px;font-size:12px;color:#000;text-align:center;background: #F1F9FE; box-shadow:1px 1px 2px #000}
.tree li a.f_dead{width:100px;height:100px;border-radius:50px;font-size:12px;color:#000;text-align:center;background: #FFF0F2;box-shadow:1px 1px 2px #000}
.tree li a.m_nolink{width:100px;height:100px;border-radius:15px;font-size:12px;color:#000;text-align:center;background: #c8e4fb; box-shadow:1px 1px 2px #000}
.tree li a.f_nolink{width:100px;height:100px;border-radius:50px;font-size:12px;color:#000;text-align:center;background: #ffc0cb; box-shadow:1px 1px 2px #000}
.tree li a.m_dead_nolink{width:100px;height:100px;border-radius:15px;font-size:12px;color:#000;text-align:center;background: #F1F9FE; box-shadow:1px 1px 2px #000}
.tree li a.f_dead_nolink{width:100px;height:100px;border-radius:50px;font-size:12px;color:#000;text-align:center;background: #FFF0F2;box-shadow:1px 1px 2px #000}

.tree li.marriage{width:200px;height:1px; border: 1px; border-color: #000; color: #000; border-style: solid; padding: 0 ; background: #000; position: relative;}
.tree li.marriage::before{border: none}
.tree  ul.pf>li.parent::before{border: none}
.tree  ul.pf>li.parentWithAncestor::before{border-top: none;}

.tree li a.m:hover{width:100px;height:100px;border-radius:15px;font-size:12px;color:#000;text-align:center;background: #c8e4fb; box-shadow:0 0 4px #222 inset}
.tree li a.f:hover{width:100px;height:100px;border-radius:50px;font-size:12px;color:#000;text-align:center;background: #ffc0cb; box-shadow:0 0 4px #222 inset}
.tree li a.m_dead:hover{width:100px;height:100px;border-radius:15px;font-size:12px;color:#000;text-align:center;background: #F1F9FE; box-shadow:0 0 4px #222 inset}
.tree li a.f_dead:hover{width:100px;height:100px;border-radius:50px;font-size:12px;color:#000;text-align:center;background: #FFF0F2; box-shadow:0 0 4px #222 inset} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:18:22.487

所以你想把阶级婚姻的孩子放在这个元素下面吗？

您必须使用位置左边距或负边距，因为子元素的边界，即 ul 元素，是具有较小宽度的元素 .marriage。

因此，我看不到任何其他机会，因为使用 position left 属性或负边距将元素水平居中定位。

但我不确定你的问题是否正确。

# c - 我如何知道调制解调器何时完成对 AT 命令的响应？

> ID：13693305
> 
> 赞同：1
> 
> 时间：2012-12-03T23:00:03.633
> 
> 标签：c, modem, at-command, cellular-network

> **可能重复：**
> [对 AT 命令的响应结束](https://stackoverflow.com/questions/13286086/end-of-response-to-an-at-command)

我正在尝试使用 CDMA 调制解调器，但在知道响应何时结束时遇到了问题。目前我只是为每个命令设置一个超时。但是，我刚换了一个新的调制解调器（相同的型号），一切都需要不同的时间。必须有更好的方法来处理这个问题。

手册说它有“硬件握手”，并列出了 UART 的以下引脚：RXD、DSR、CTS、RING、DCD、TXD、DTR 和 RTS。TXD 和 RXD 很明显。我假设 RTS 和 CTS 与可用串行缓冲区的关系比与命令执行和 DCD（数据载体检测）和 RING 与单元连接本身有关。DTR 是否表明调制解调器处于空闲状态？

是否有其他带内方式可以知道调制解调器已经发送了它要发送的所有内容？

对于真正勇敢/乐于助人的人，这里是手册的链接：[http ://www.janus-rc.com/Documentation/terminus_cf_user_guide.pdf](http://www.janus-rc.com/Documentation/terminus_cf_user_guide.pdf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:06:40.663

已经很久了，但据我记得，调制解调器应该通过在处理命令时发送“OK”作为响应来确认每个 AT 命令。所以你最好的选择是听这个。当然，您还应该在等待响应时定义一个超时，但是您不依赖于确切的时间。

# scala - 玉“包含”没有按预期工作

> ID：13693307
> 
> 赞同：1
> 
> 时间：2012-12-03T23:00:08.957
> 
> 标签：scala, pug, scalatra, scalate

从一个内部引用另一个 Jade 文件：

```
include ../widget 
```

像这样渲染 HTML：

```
<include>../widget</include> 
```

特别是使用 Scalatra。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T18:56:43.667

Scalate Jade 与 JavaScript Jade 不同，因此标签也不相同。您必须完整引用文件名，如下所示：

```
- include("../widget.jade") 
```

# mysql - 触发器 - 错误 #1442 无法更新 [MYSQL]

> ID：13693309
> 
> 赞同：0
> 
> 时间：2012-12-03T23:00:17.710
> 
> 标签：mysql, syntax, triggers, mysql-error-1442

> **可能重复：**
> [MySQL 触发器无法更新触发器分配到的同一表中的行。建议的解决方法？](https://stackoverflow.com/questions/2334478/mysql-triggers-cannot-update-rows-in-same-table-the-trigger-is-assigned-to-sugg)

我对这个触发器有一些问题：

```
create trigger pay_out before insert on `payment_out`
for each row
then
UPDATE `payment_out` o
INNER JOIN payment p ON p.id_1 = o.id_1 AND o.id2 = p.id2
SET o.`how_much_to_pay` = p.cash / p.months;
end;
$$ 
```

```
表 payment_out
id1
id2
how_much_to_pay

餐桌付款
id1
id2
现金
月
```

错误：

> 1442 - 无法更新存储函数/触发器中的表 payment_out，因为它已被调用此存储函数/触发器的语句使用。

当我制作类似“new.o.how_much_to_pay”的内容时，它说它没有看到名为 new.o.how_much_to_pay 的列。有任何想法吗？

# soundcloud - 为 SoundCloud 和 mp3 创建一个停靠的音乐播放器

> ID：13693310
> 
> 赞同：0
> 
> 时间：2012-12-03T23:00:19.283
> 
> 标签：soundcloud, jplayer

我正在尝试创建一个网站，该网站从多个来源提取免费歌曲，并允许用户通过单击他们的封面艺术来播放它们，然后在页面底部的停靠音乐播放器中启动它们。Soundcloud 的 api 为我提供了很多歌曲，但它们是流式 api 格式，而不是 mp3 格式。

SoundCloud 提供的音乐播放器非常适合这些流媒体歌曲，但它不适用于我从其他网站提取的 mp3。像 Jplayer 这样的 Mp3 播放器非常适合 mp3，但我不知道如何让它与流式 soundcloud 格式一起使用。

想想像 ex.fm 这样的网站：[http](http://ex.fm/search/bob%20dylan) ://ex.fm/search/bob%20dylan 他们从许多来源提取音轨，但都可以通过他们的一个播放器播放。

对此的任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:02:13.020

检查 SoundCloud API [http://developers.soundcloud.com/docs/api/reference#tracks](http://developers.soundcloud.com/docs/api/reference#tracks)

`stream_url`在SoundCloud 之外可以流式传输的每个轨道都有一个属性。

您需要在 Soundcloud 上注册您的应用并获取 API Key。使用该键，您可以在自己的播放器中播放曲目。

**编辑**，感谢[gryzzly](https://stackoverflow.com/users/236135/gryzzly)。与 jPlayer 一起使用的 SoundCloud API 示例：

```
var SOUNDCLOUD_API = 'http://api.soundcloud.com',
    CLIENT_ID = '?client_id=REPLACE_WITH_YOUR_CLIENT_ID';

$(document).ready(function() {
  var apiRequest;

  $.get(SOUNDCLOUD_API + '/tracks/6981096.json' + CLIENT_ID)
   .done(handleRepsonse);

  function handleResponse (soundData) {
    $("#jquery_jplayer_1").jPlayer({
      ready: function () {
        $(this).jPlayer("setMedia", {
          // stream_url is good enough for jPlayer,
          mp3: soundData.stream_url + CLIENT_ID
        });
      },
      swfPath: "http://www.jplayer.org/2.1.0/js"
    });
  }

}); 
```

您可以在[jsbin.com/ajaken/4/edit上实时查看](http://jsbin.com/ajaken/4/edit)

# java - Java - 将 unicode 撇号分配给 char

> ID：13693312
> 
> 赞同：12
> 
> 时间：2012-12-03T23:00:20.793
> 
> 标签：java, unicode

我想将 aphostrophe 的值分配给一个字符：

```
char a = '\''; 
```

但是，我想使用 unicode 版本的撇号 (\u0027) 使其与我的代码保持一致：

```
char a = '\u0027'; 
```

但是这样做会产生一个错误，说“未封闭的字符文字”。

如何在代码中仍然包含 unicode 代码的情况下执行此任务？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T23:05:36.923

`\u0027`不起作用的原因是编译器*很早就*处理了 unicode 转义，当然，它最终是`'` - 终止文字。编译器实际上看到了这一点：

```
char a = '''; 
```

...这自然是一个问题。[JLS 在第 3.10.4 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.4)（*字符文字*）中讨论了与换行有关的内容。

坦率地说，我认为你最好写

```
char a = '\''; 
```

...但是`char`是数字类型，所以你可以这样做：

```
char a = 0x0027; 
```

当然，你*可以*这样做：

```
char a = "\u0027".charAt(0); 
```

...但我认为我们都同意这有点矫枉过正。;-)

哦，或者查看[Greg 的答案](https://stackoverflow.com/a/13693486/157247)：（当然是反斜杠 - 所以编译器会看到`char a = '\u005c\u0027';`）。`\u005c``'\''`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-03T23:12:47.687

你也可以这样做

```
char a = '\u005c\u0027'; 
```

其中**\u005c**是 \ 的 Unicode

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:09:04.110

在 javac 做任何其他事情之前，它首先将所有 \u#### 转换为 char。所以你的代码相当于

```
char a = '''; 
```

这就是它不编译的原因。

\u#### 不仅适用于字符/字符串文字，您可以在任何地方使用它，例如在变量名中。

然而，人们很少在标识符中使用非拉丁字符；如果有人这样做，他可能会使用他的本机字符集，而且他也不需要 \u####。

因此，除了字符/字符串文字之外，我们从未真正在任何地方看到 \u####，这会给不知情的人留下错误的印象。

如果有时间机器，我们可能应该取消此功能，因为它令人困惑且未被使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T23:10:23.670

这是另一种选择，虽然确实有点矫枉过正：

```
char c = "\u0027".charAt(0); 
```

# python - 在元组列表中使第一个值为正

> ID：13693313
> 
> 赞同：0
> 
> 时间：2012-12-03T23:00:23.307
> 
> 标签：python, list, tuples

我有以下元组列表：

```
>>> list_of_tuples = [(0, 0), (0, -1), (1, -1), (1, -2), (1, -3), (1, -4), (0, -4), (0, -3), (-1, -3), (-2, -3), (-2, -2), (-2, -1), (-1, -1), (-1, -2), (0, -2)] 
```

我想要以下内容：

```
>>> addvalues(list_of_tuples)
[(2, 0), (2, -1), (3, -1), (3, -2), (3, -3), (3, -4), (2, -4), (2, -3), (1, -3), (0, -3), (0, -2), (0, -1), (1, -1), (1, -2), (2, -2)]
#original
>>> list_of_tuples
[(0, 0), (0, -1), (1, -1), (1, -2), (1, -3), (1, -4), (0, -4), (0, -3), (-1, -3), (-2, -3), (-2, -2), (-2, -1), (-1, -1), (-1, -2), (0, -2)] 
```

对于list_of_tuples 中的元组，元组[0] 中的最小值是-2，我想为每个元组[0] 添加一个值，直到最小值为0，你是怎么做到的？（通常最低值不需要是-2）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:07:22.930

可能有更好的方法，但这很有效。找到最小的项目。如果小于 0，则将其添加到每个元组中的第一项。

```
list_of_tuples = [(0, 0), (0, -1), (1, -1), (1, -2), (1, -3), (1, -4), (0, -4), (0, -3), (-1, -3), (-2, -3), (-2, -2), (-2, -1), (-1, -1), (-1, -2), (0, -2)]
to_add = min(list_of_tuples)[0]
if to_add < 0:
    list_of_tuples = [(a[0]-to_add, a[1]) for a in list_of_tuples]

# [(2, 0), (2, -1), (3, -1), (3, -2), (3, -3), (3, -4), (2, -4), (2, -3), (1, -3), (0, -3), (0, -2), (0, -1), (1, -1), (1, -2), (2, -2)] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:12:42.760

您可以执行以下操作：-

```
list_of_tuples = [(0, 0), (0, -1), (1, -1), (1, -2), (1, -3), (1, -4), (0, -4), (0, -3), (-1, -3), (-2, -3), (-2, -2), (-2, -1), (-1, -1), (-1, -2), (0, -2)]

# get the min of x
minx = min(x for x, y in list_of_tuples)

# create the new list
new_tuples = [(x - minx, y) for x, y in list_of_tuples]

# do a test
assert new_tuples == [(2, 0), (2, -1), (3, -1), (3, -2), (3, -3), (3, -4), (2, -4), (2, -3), (1, -3), (0, -3), (0, -2), (0, -1), (1, -1), (1, -2), (2, -2)]
print("Passed") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:13:57.630

你需要找到最小值然后减去它。

```
min_ = min(l, key=lambda x:x[0])[0] 
```

这样，它首先将每个元素传递给函数“key”，然后找到最小值。由于传递的函数返回元组的第一个元素，您可以看到它为什么起作用。（我展示了如何使用 key 参数；在这种情况下你不需要它，因为 min 已经首先检查了元组的第一个元素。但是，如果你想考虑第二个，或者他们的产品，那就是这样去）

修改列表，如果我理解正确你想要做什么，你可以做

```
[(x[0] + min_, x[1]) for x in l] 
```

这称为列表推导，相当于

```
for x in l:
    y = (x[0] + min, x[1])
    new_list.append(y) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T23:15:19.180

如果你需要处理正数/负数的东西，你可以试试这个。它在元组列表中找到最小的 x 值，如果该值小于 0，则取绝对值并将所有数字增加该数字。如果最小数字大于 0，则将数字增加 0（即不改变任何内容）。返回的结果是更新后的元组列表。

```
In [65]: def addvalues(l):
    min_x = min(l, key=lambda x: x[0])[0] # x[1] to work with the second element
    min_x = abs(min_x) if min_x < 0 else 0
    return [tuple((x+min_x, y)) for x, y in l]
   ....:

In [69]: addvalues(list_of_tuples)
Out[69]:
[(2, 0),
 (2, -1),
 (3, -1),
 (3, -2),
 (3, -3),
 (3, -4),
 (2, -4),
 (2, -3),
 (1, -3),
 (0, -3),
 (0, -2),
 (0, -1),
 (1, -1),
 (1, -2),
 (2, -2)] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T23:10:21.100

另一种方法：

```
to_add = 0 - min(list_of_tuples)[0]
new_list = [(i[0] + to_add, i[1]) for i in list_of_tuples] 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-03T23:06:50.680

```
In [52]: list_of_tuples = [(0, 0), (0, -1), (1, -1), (1, -2), (1, -3), (1, -4), (0, -4), (0, -3), (-1, -3), (-2, -3), (-2, -2), (-2, -1), (-1, -1), (-1, -2), (0, -2)]

In [53]: to_add = min(list_of_tuples, key=operator.itemgetter(0))[0] *-1

In [54]: to_add
Out[54]: 2

In [55]: [tuple([t[0]+2,t[1]]) for t in list_of_tuples]
Out[55]: 
[(2, 0),
 (2, -1),
 (3, -1),
 (3, -2),
 (3, -3),
 (3, -4),
 (2, -4),
 (2, -3),
 (1, -3),
 (0, -3),
 (0, -2),
 (0, -1),
 (1, -1),
 (1, -2),
 (2, -2)]

In [56]: list_of_tuples # input unchanged
Out[56]: 
[(0, 0),
 (0, -1),
 (1, -1),
 (1, -2),
 (1, -3),
 (1, -4),
 (0, -4),
 (0, -3),
 (-1, -3),
 (-2, -3),
 (-2, -2),
 (-2, -1),
 (-1, -1),
 (-1, -2),
 (0, -2)] 
```

希望这可以帮助

# ruby-on-rails - 随着时间的推移跟踪属性

> ID：13693316
> 
> 赞同：0
> 
> 时间：2012-12-03T23:00:37.503
> 
> 标签：ruby-on-rails, mongoid

我有一个文档集合，每个文档都有一个“值”，我希望能够随着时间的推移跟踪值，我的第一个想法是在 before_save 中创建文档的快照，然后执行 group_by {|t| t.created_at.hour} 在这些快照上创建一个折线图。这应该可行，还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:06:34.707

mongoid gem 有一个名为`Mongoid::Versioning`. 只需将其包含在您的模型中，如下所示：

```
class Person
  include Mongoid::Document
  include Mongoid::Versioning
end 
```

这将使您可以通过`@instance.versions`.

[http://mongoid.org/en/mongoid/docs/extras.html#versioning](http://mongoid.org/en/mongoid/docs/extras.html#versioning)

# regex - `{m}` 和 `{m}?` 量词之间有什么区别吗？

> ID：13693322
> 
> 赞同：1
> 
> 时间：2012-12-03T23:00:59.457
> 
> 标签：regex, quantifiers

请举一个例子，可以看出“repeat-exactly-m-times”量词的贪婪和懒惰版本之间的区别。
问题来自[这里](http://msdn.microsoft.com/en-us/library/3206d374.aspx#sectionToggle10)和[这里](http://docs.oracle.com/javase/tutorial/essential/regex/quant.html)。
如果没有差异，那么`{m}?`量词存在什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:07:03.020

我不相信和之间有任何真正的区别`{m}`，`{m}?`因为每个都指定了 m 次。`{m,}`但是， and `{m,}?`（和`{m,}+`，当我们在这里时）之间是有区别的。一般而言，它对于量词是合适和需要的，即使在特定情况下不需要它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:05:14.223

正如评论中所说，Oniguruma 正则表达式引擎以不同的方式对待它，作为一个例外：`{m}?`不是非贪婪精确 m（与贪婪精确 m 相同），而是 0-or-m。我尝试过的所有其他引擎都像其他海报所说的那样：没有区别。

非贪婪精确 m 存在的原因：如果不存在，则为例外。异常更难记住，也更难实现——这是额外的工作，在这种情况下，由于语义相同，它不会伤害任何人。

我喜欢 Oniguruma，并且感谢他们可能想要将不需要的部分更改为更有用和更高效的东西，但这看起来像是一个等待发生的错误。幸运的是，没有一个理智的人会写出非贪婪的精确...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:03:14.467

完全匹配没有区别`{m}`。

但是，`{m,}`贪婪限定符匹配尽可能多的字符会有所不同，而惰性限定符匹配尽可能少。

* * *

给定字符串`"Baaaaaaaaaaaa"`

正则表达式`(B[a]{2,}?)`将匹配`"Baa"`

正则表达式`(B[a]{2,})`将匹配`"Baaaaaaaaaaaa"`

* * *

然而，完全匹配`{m}`：

正则表达式`(B[a]{2}?)`将匹配`"Baa"`

正则表达式`(B[a]{2})`也将匹配`"Baa"`

# visual-studio-2010 - Visual Studio 2012 调试测试键盘快捷键

> ID：13693324
> 
> 赞同：14
> 
> 时间：2012-12-03T23:01:01.453
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012, keyboard-shortcuts

在 Visual Studio 2010 中，有用于调试所有测试、在上下文中调试测试等的键盘快捷键。

作为参考，在 VS 2010 中，和弦是：

*   调试：解决方案中的所有测试：`Ctrl`+ `R`、`Ctrl`+`A`
*   调试：上下文中的所有测试：`Ctrl`+ `R`，`Ctrl`+`T`

VS2010 也有键盘命令来运行所有测试

在 VS 2012 中，我找到了用于运行所有测试的键盘命令`Ctrl`+ `R`，`A`但找不到用于调试所有测试的键盘命令，我发现这是一个非常有用的命令。

我是不是很密集而错过了它？他们是否删除了键盘快捷键？我没有找到太多使用 Google 或 Bing 搜索的信息。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-03T23:08:18.063

看起来它们在工具 --> 选项 --> 键盘中，没有分配快捷键。看起来您以前使用的组合仍然可用。

![在此处输入图像描述](../Images/0d18433bca2263b53c0454c6516013d8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-23T14:34:33.617

我好像有`TestExplorer.DebugAllTests`设置`Ctrl+D, A`...

而且我非常确信我没有设置它，但不确定它来自哪里或者它是否是标准的 VS 2012 键盘快捷键

# asp.net - 是否可以在 Microsoft Outlook 中拥有 ASP.NET 应用程序

> ID：13693325
> 
> 赞同：0
> 
> 时间：2012-12-03T23:01:06.443
> 
> 标签：asp.net, email, outlook-2010

用户需要填写访问请求，完成并点击提交后，它会将请求通过电子邮件发送给他们的主管。是否可以在电子邮件中通过电子邮件发送整个表单（包含用户数据以及主管填写的字段），以便主管可以选择接受，并且更改将反映在 Outlook 本身的 SQL 数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:26:38.570

可以通过电子邮件发送表格。也可以编写 Outlook 加载项。但是，如果您只是在您的 Web 应用程序中编写一个“批准”页面，并在电子邮件中将指向该页面的链接发送给主管，您将节省大量时间。当然，您可以在电子邮件中输入您想要的任何信息。

ETA：但实际上建议一个解决方案：您可以发送一封包含超链接的电子邮件，其中包括查询字符串中的识别信息，并将其用作向网页或 Web 服务发出信号表明请求应该被批准的一种方式。当然，您必须解决一些安全和身份验证问题，这样不只是任何人都可以调用该页面并批准请求。

# c++ - c++，“错误：聚合对象需要使用 '{...}' 进行初始化”

> ID：13693331
> 
> 赞同：2
> 
> 时间：2012-12-03T23:01:42.513
> 
> 标签：c++

编译此代码时，`"Error: initialization with '{...}' expected for aggregate object"`在我的函数调用中出现错误。我正在使用 Visual Studio 11 进行编译。

```
#include <iostream>
#include <string>
#include <array>
using namespace std;

typedef std::array<string, 5> string_t;
string_t centerString(std::array<string, 5> (&tempArray),unsigned short int length);
string_t evenString(std::array<string, 5> (&tempArray),unsigned short int length);

int main(){
    std::array<string, 5> aArray = {"a","aa","aaa","aaaa","aaaaa"};

    std::array<string, 5> evenStr[5] = evenString(aArray,5);
    std::array<string, 5> centerStr[5] = centerStr(aArray,5);
}

 string_t evenString(std::array<string, 5> (&srcArray),unsigned short int length){
     std::array<string, (sizeof(srcArray)/sizeof(srcArray[0]))> trgtArray= {};
     for(unsigned short int x = 0; x < (sizeof(srcArray)/sizeof(srcArray[0]));x++){
         trgtArray[x] = srcArray[x];
         for(unsigned short int y = 0; y < (length-trgtArray[x].length()); y++){
             trgtArray[x] += " ";
         }
     }

     return(trgtArray);
}

 string_t centerString(std::array<string, 5> (&srcArray),unsigned short int length){
     std::array<string, (sizeof(srcArray)/sizeof(srcArray[0]))> trgtArray= {};
     unsigned short int remainder;
     string spacer = "";
     for(unsigned short int x = 0; x < (sizeof(srcArray)/sizeof(srcArray[0]));x++){
         remainder = length - srcArray[x].length();
         if((remainder % 2) == 0){
            trgtArray[x] = srcArray[x];
            for(unsigned short int y = 0; y < (length-srcArray[x].length()); y++){
                trgtArray[x] += " ";
            }
         }else{
             for(unsigned short int z = 0; z < (remainder/2); z++){
                 spacer += " ";
             }
             trgtArray[x] = spacer + srcArray[x] + spacer + " ";
         }
     }

     return(trgtArray);
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:34:01.177

您正在返回临时参考`centerString`

```
string_t& centerString(std::array<string, 5> (&tempArray),unsigned short int length); 
```

centerStr 是数组，不能作为函数使用

```
std::array<string, 5> centerStr = centerStr(aArray,5); 
```

我猜你的意思是

```
std::array<string, 5> centerStr = centerString(aArray,5); 
```

您可以尝试下面的示例函数，只需返回数组，RVO 应该会启动。

```
std::array<string,5> evenString(std::array<string, 5> (&srcArray), unsigned short length){
     std::array<string,5> trgtArray = {};
    //....
     return trgtArray;
}  

std::array<string, 5> evenStr = evenString(aArray,5);
std::array<string, 5> centerStr = centerString(aArray,5); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:11:24.003

永远不要使用原生数组，它们非常糟糕，这是它们糟糕的方式之一。基本上，这将要求数组正常运行，而它们不会。语言强制的糟糕基本上意味着它们无法完成您对任何其他数据类型所期望的大量事情，而且当您可以`std::array`像~~正常人~~一样使用它们时，它们真的不值得花时间使用。

使用`std::array`并感激甚至委员会接受 C 数组的吸吮。

有趣的是，我注意到您确实包含`<array>`，但后来没有使用`std::array`.

# actionscript-3 - Actionscript 对象同步

> ID：13693336
> 
> 赞同：0
> 
> 时间：2012-12-03T23:02:07.677
> 
> 标签：actionscript-3, apache-flex

我有 3 个计时器可以访问和修改相同的资源（一个数组）。

有什么方法可以避免在 actionscript 中同时修改和访问数组？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:15:14.600

您不必担心——AS3 是单线程的。

# mysql - OpenJPA + Tomcat JDBC 连接池 = 陈旧数据

> ID：13693337
> 
> 赞同：1
> 
> 时间：2012-12-03T23:02:11.653
> 
> 标签：mysql, tomcat, connection-pooling, openjpa, autocommit

我在 Web 应用程序中使用带有 OpenJPA 的 Tomcat JDBC 连接池。应用程序看不到更新的数据。具体来说，另一个 java 应用程序在数据库中添加或删除记录，但 Web 应用程序永远不会看到这些更新。这是一个相当严重的问题。我一定缺少一些基本的东西。

如果我从实现中删除连接池，Web 应用程序会看到更新。就好像 Web 应用程序的提交永远不会在 Connection 上调用。

版本信息：

Tomcat JDBC 连接池：org.apache.tomcat tomcat-jdbc 7.0.21

OpenJPA：org.apache.openjpa openjpa 2.0.1

下面是创建 DataSource 的代码片段（DataSourceHelper.findOrCreateDataSource 方法）：

```
PoolConfiguration props = new PoolProperties();
props.setUrl(URL);
props.setDefaultAutoCommit(false);
props.setDriverClassName(dd.getClass().getName());
props.setUsername(username);
props.setPassword(pw);
props.setJdbcInterceptors("org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;"+
              "org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer;"+
              "org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReportJmx;"+
              "org.apache.tomcat.jdbc.pool.interceptor.ResetAbandonedTimer");   
props.setLogAbandoned(true);
props.setSuspectTimeout(120);
props.setJmxEnabled(true);
props.setInitialSize(2);
props.setMaxActive(100);
props.setTestOnBorrow(true);
if (URL.toUpperCase().contains(DB2)) {
    props.setValidationQuery("VALUES (1)");
} else if (URL.toUpperCase().contains(MYSQL)) {
    props.setValidationQuery("SELECT 1");
    props.setConnectionProperties("relaxAutoCommit=true");
} else if (URL.toUpperCase().contains(ORACLE)) {
    props.setValidationQuery("select 1 from dual");
}
props.setValidationInterval(3000);
dataSource = new DataSource();
dataSource.setPoolProperties(props); 
```

下面是使用 DataSource 创建 EntityManagerFactory 的代码：

```
//props contains the connection url, user name, and password
DataSource dataSource = DataSourceHelper.findOrCreateDataSource("DATAMGT", URL, username, password);
props.put("openjpa.ConnectionFactory", dataSource);
emFactory = (OpenJPAEntityManagerFactory) Persistence.createEntityManagerFactory("DATAMGT", props); 
```

如果我像这样注释掉 DataSource，那么它就可以工作。请注意，OpenJPA 在 props 中有足够的信息来配置连接，而无需使用 DataSource。

```
//props contains the connection url, user name, and password
//DataSource dataSource = DataSourceHelper.findOrCreateDataSource("DATAMGT", URL, username, password);
//props.put("openjpa.ConnectionFactory", dataSource);
emFactory = (OpenJPAEntityManagerFactory) Persistence.createEntityManagerFactory("DATAMGT", props); 
```

所以不知何故，OpenJPA 和连接池的组合无法正常工作。

更新：

实际上，当底层数据库是 MySQL 时，它似乎会失败。如果底层数据库是 DB2，它在有和没有池的情况下都能正常工作。

更新#2：

我在池中添加了一个 JdbcInterceptor 以记录在连接上调用的方法。如果数据库是 DB2，则在创建 EntityManager 时调用 setAutoCommit(true)。当数据库是 MySQL 时，它不会被调用。

这将解释行为的差异。即使应用程序在 EntityManager 上调用提交，连接上也没有相应的提交。由于事务期间执行的所有查询都是只读的，因此 OpenJPA 似乎认为不需要提交。

这是来自 MySQL 的日志：

```
 INFO : .store.EMHandler.getConfig: ******************Start JPA Properties:
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionDriverName: com.mysql.jdbc.Driver
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionPassword: *******
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionUserName: *******
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionURL: jdbc:mysql://localhost:3306/datamgt
 INFO : .store.EMHandler.getConfig: *********openjpa.Log: log4j
 INFO : .store.EMHandler.getConfig: ***** Found Driver :com.mysql.jdbc.Driver class: class com.mysql.jdbc.Driver
 INFO : .store.EMHandler.getConfig: ******************End JPA Properties:
 DEBUG: .store.impl.EMHandlerImpl.em: ********EntityManagerFactory created
 DEBUG: .store.impl.EMHandlerImpl.em: ******** Creating EntityManager
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: ********Entity manager created 
```

这是来自 DB2 的日志（注意 setAutoCommit）：

```
 INFO : .store.EMHandler.getConfig: ******************Start JPA Properties:
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionDriverName: com.ibm.db2.jcc.DB2Driver
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionPassword: *******
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionUserName: *******
 INFO : .store.EMHandler.getConfig: *********openjpa.ConnectionURL: jdbc:db2://localhost:50000/DATAMGT
 INFO : .store.EMHandler.getConfig: *********openjpa.Log: log4j
 INFO : .store.EMHandler.getConfig: ***** Found Driver :com.ibm.db2.jcc.DB2Driver class: class com.ibm.db2.jcc.DB2Driver
 INFO : .store.EMHandler.getConfig: ******************End JPA Properties:
 DEBUG: .store.impl.EMHandlerImpl.em: ********EntityManagerFactory created
 DEBUG: .store.impl.EMHandlerImpl.em: ******** Creating EntityManager
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****setAutoCommit Args: true 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection createStatement Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getTransactionIsolation Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: ********Entity manager created 
```

自从发现这一点以来，我在创建 EntityManagerFactory 之前尝试将 autoCommit 设置为 true：

```
dataSource.setDefaultAutoCommit(true); 
```

这没有效果。我已经阅读了关于 OpenJPA 将 autoCommit 设置为 false 的 stackoverflow 上的其他帖子，并且我在日志中看到了这一点，但仅在提交包含数据库更新的事务时。

我最近一直在检查 transactionIsolationLevel，结果发现 MySQL 的默认级别是 4，而 DB2 是 2。这是 java.sql.Connection 类中这些的定义。请注意，2 比 4 更轻松，所以这可能不是原因。

```
/**
 * A constant indicating that
 * dirty reads are prevented; non-repeatable reads and phantom
 * reads can occur.  This level only prohibits a transaction
 * from reading a row with uncommitted changes in it.
 */
int TRANSACTION_READ_COMMITTED   = 2;

/**
 * A constant indicating that
 * dirty reads and non-repeatable reads are prevented; phantom
 * reads can occur.  This level prohibits a transaction from
 * reading a row with uncommitted changes in it, and it also
 * prohibits the situation where one transaction reads a row,
 * a second transaction alters the row, and the first transaction
 * rereads the row, getting different values the second time
 * (a "non-repeatable read").
 */
int TRANSACTION_REPEATABLE_READ  = 4; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:54:48.700

答案是 OpenJPA 中存在一个错误。解决方法是自己在连接上调用 commit。

从 EntityManager 获取连接，将其转换为 java.sql.Connection 并调用 commit()。

错误是 OpenJPA 永远不会在**只读**事务的连接上调用 commit。如果 autoCommit 设置为 true，这会很好，但 OpenJPA 坚持让 autoCommit 为 false。创建 EntityManager 时，如果基础连接将 autoCommit 设置为 true，则 OpenJPA 将其设置为 false。

在下面的日志片段中，我在创建 EntityManager 之前从 DataSource 获得了一个连接，并记录了 autoCommit 和 transactionIsolation。在创建 EntityManager 期间，日志显示 autoCommit 然后设置为 false。

```
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getTransactionIsolation Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: Isolation level: 4 autoCommit: true
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: ********EntityManagerFactory created
 DEBUG: .store.impl.EMHandlerImpl.em: ******** Creating EntityManager
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****setAutoCommit Args: false 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: ********Entity manager created 
```

另一方面，当数据库是 DB2 时，情况正好相反。在下面的日志片段中，autoCommit 未设置为 false。

```
DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getTransactionIsolation Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: Isolation level: 2 autoCommit: true
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: ********EntityManagerFactory created
 DEBUG: .store.impl.EMHandlerImpl.em: ******** Creating EntityManager
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getMetaData Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection createStatement Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getTransactionIsolation Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.em: ********Entity manager created 
```

此外，如果 autoCommit 设置开始时为 false，OpenJPA 将其设置为对 DB2 为 true，而对 MySQL 保持不变。我不会费心显示这些案例的日志。

为了完整起见，我将提及我在更新期间观察到的内容。对于 DB2，autoCommit 设置为 false，执行更新，在连接上调用 commit，并将 autoCommit 设置回 true。这是 DB2 的日志片段：

```
DEBUG: .store.impl.EMHandlerImpl.commitTransaction: >>>calling COMMIT transaction 544096693
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection getTransactionIsolation Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****setAutoCommit Args: false 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection isReadOnly Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: INSERT INT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: INSERT INT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: INSERT INT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: UPDATE DAT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: UPDATE DAT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****commit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****setAutoCommit Args: true 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.commitTransaction: >>>finished COMMIT transaction 544096693 
```

对于 MySQL，由于 autoCommit 已经为 false，因此在更新期间不会更改。无论如何，这是日志：

```
 DEBUG: .store.impl.EMHandlerImpl.commitTransaction: >>>calling COMMIT transaction 2103121779
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****getAutoCommit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection isReadOnly Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: INSERT INT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: INSERT INT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: INSERT INT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: UPDATE DAT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection prepareStatement Args: UPDATE DAT 1003 1007 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection !****commit Args: 
 DEBUG: .store.util.CommitInterceptor.invoke: Method called on connection close Args: 
 DEBUG: .store.impl.EMHandlerImpl.commitTransaction: >>>finished COMMIT transaction 2103121779 
```

有趣的是，这个错误只在使用连接池时出现。我建议这是因为永远不会在重用的连接上调用提交。如果没有连接池，OpenJPA 每次都会获得一个新连接，因此所有同时发生的更新都会在下一个查询中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T05:40:38.227

Julie，我正在使用 tomcat 7（带有本地池）和 openjpa 2.2。我遇到了一个问题，即 JPA 有时（！）在页面刷新后会带来陈旧的数据。

当我添加

```
defaultAutoCommit="true" 
```

在连接池配置 (server.xml) 中，这成功了。

> **defaultAutoCommit** - (boolean) 此池创建的连接的默认自动提交状态。如果未设置，则默认为 JDBC 驱动程序默认值（如果未设置，则不会调用 setAutoCommit 方法。）

# php - AS or not to AS, 查询

> ID：13693340
> 
> 赞同：3
> 
> 时间：2012-12-03T23:02:31.123
> 
> 标签：php, mysql

我对 PHP/MySql 相当陌生，并且通常使用查询。我只是想知道在查询中使用“AS”是否有任何好处，而不是试图让它看起来更干净？它是否会加快查询速度？我可能可以通过谷歌搜索来解决这个问题，但我想问我的第一个问题，看看它是如何工作的。我会选择一个答案（不像某些人......）

和：

```
SELECT
news.id as id
news.name as name
FROM news 
```

没有：

```
SELECT
news.id
news.name
FROM news 
```

我发现的多对多关系教程中的一个更复杂的示例：

```
SELECT
c.name,
cf.title
FROM celebrities AS c
JOIN (
    SELECT
    icf.c_id,
    icf.f_id,
    f.title
    FROM int_cf AS icf
    JOIN films AS f
    ON icf.f_id = f.f_id
) AS cf
ON c.c_id = cf.c_id
ORDER BY c.c_id ASC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:04:45.543

如果您知道不会与其他列发生冲突，则没有理由使用它。性能没有差异，但它确实改变了输出列的名称。当您构建动态选择时，它非常有用。例如，如果你有一个`first_name`和一个`last_name`字段，你可以使用 CONCAT 函数来做：

```
SELECT CONCAT(first_name, ' ', last_name) AS name FROM whatever 
```

此外，AS 运算符在定义子查询表时起作用，正如您在该 JOIN 中所示。如果没有该 AS，您将无法在 ON 子句或 SELECT 字段中引用该表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:04:39.000

1）不，它不会以一种或另一种方式影响性能

2) 就 SQL 查询的可读性而言，这只是一个偏好问题

3）它确实影响了输出的可读性（它改变了列标题）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T23:05:31.353

仅关于歧义和保留字。它不影响性能。歧义是指来自不同表的具有相同名称的两列。其他 RDBMS 会为此打你一巴掌。保留字是指必须使用反引号或别名转义的系统字。

对于子查询，别名列可能不会派生到子级别之后。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T23:06:14.217

使用别名（“AS”关键字）和不使用别名时的查询执行速度是相同的。使用它们的原因：

*   如果您有非常长或复杂的表名或列名，它可以更轻松地使用数据库：

> ```
> SELECT c.Construction_ID, c.Name, c.Price 
> FROM Constructions c LEFT JOIN 
> Constructions_Orders co ON c.Construction_ID = co.Construction_ID
> WHERE c.OrderID='1' AND c.Name='ConstructionName' 
> ```

但是，它会更改输出列的名称，也要考虑到它（使阅读代码的人更难）。

*   别名对于创建动态选择很有用：

> ```
> mysql> SELECT CONCAT(id, name, work_date) as profile
>     -> FROM employee_tbl;
> +-----------------------------+
> | profile                     |
> +-----------------------------+
> | 1John2007-01-24             |
> | 2Ram2007-05-27              |
> | 3Jack2007-05-06             |
> | 3Jack2007-04-06             |
> | 4Jill2007-04-06             |
> | 5Zara2007-06-06             |
> | 5Zara2007-02-06             |
> +-----------------------------+
> 7 rows in set (0.00 sec) 
> ```

# r - 读取文件 - 警告信息

> ID：13693341
> 
> 赞同：8
> 
> 时间：2012-12-03T23:02:36.960
> 
> 标签：r, warnings, read.table

我有一个 22268 行乘 2521 列的文件。当我尝试使用这行代码读取文件时：

```
file <- read.table(textfile, skip=2, header=TRUE, sep="\t", fill=TRUE, blank.lines.skip=FALSE) 
```

但我只读入 13024 行乘 2521 列，并出现以下错误：

> 警告消息：在 scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings, : 读取的项目数不是列数的倍数

我还使用此命令查看哪些行的列数不正确：

```
x <-count.fields(textfile, sep="\t", skip=2)
incorrect <- which(x != 2521) 
```

并取回了大约 20 行不正确的列表。

有没有办法用 NA 值填充这些行？

我认为这就是 read.table 函数中“填充”参数的作用，但事实并非如此。

或者

有没有办法忽略在“不正确”变量中标识的这些行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T23:09:58.197

您可以使用`readLines()`输入数据，然后找到有问题的行。

```
 con <- file("path/to/file.csv", "rb")
    rawContent <- readLines(con) # empty
    close(con)  # close the connection to the file, to keep things tidy 
```

然后看看`rawContent`

要查找列数不正确的行，例如：

```
 expectedColumns <- 2521
    delim <- "\t"

    indxToOffenders <-
    sapply(rawContent, function(x)   # for each line in rawContent
        length(gregexpr(delim, x)[[1]]) != expectedColumns   # count the number of delims and compare that number to expectedColumns
    ) 
```

然后读入您的数据：

```
 myDataFrame <- read.csv(rawContent[-indxToOffenders], header=??, sep=delim) 
```

# android - Phonegap 应用 (Android) 中的 Dropbox 链接

> ID：13693343
> 
> 赞同：0
> 
> 时间：2012-12-03T23:02:43.150
> 
> 标签：android, google-chrome, cordova, webkit, dropbox

我尝试创建文件的可下载链接，单击链接后可以直接下载这些文件。我在保管箱链接的末尾添加了“dl”而不是“www”和“?dl=1”（[保管箱 api：强制下载文件或文件夹](https://www.dropbox.com/help/201/en)）。直接下载在 chrome 浏览器中完美运行，但如果我将应用程序与 phonegap for android 打包并单击生成的应用程序中的相同链接，则不会下载文件。这在 android 浏览器中是不可能的，还是我必须修改一些 android 浏览器首选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T17:51:27.527

问题似乎是phonegap的版本。它适用于Phonegap 2.0，据我记得也适用于phonegap 1.4，但不在1.5和2.0之间，也不高于2.0。

# android - NoClassDefFoundError 与新的 Eclipse 包

> ID：13693344
> 
> 赞同：0
> 
> 时间：2012-12-03T23:02:45.180
> 
> 标签：android, noclassdeffounderror

一位客户通知我，他们收到了错误消息。在他们提交的报告中，不断出现 NoClassDefFoundError。我的其他客户似乎都没有这个问题。我在摩托罗拉 Droid Maxx 上运行应用程序时没有这个问题。客户正在根植的 Droid Bionic 上运行应用程序。在我的 2.3 版本上一切正常，但是当我将其更新到 2.4 时，出现了这个问题。我还用新的计算机替换了我的计算机，现在我正在运行 Windows 8 并安装了 adt 包。我对相关文件所做的唯一更改是将 >-90 更改为 >-85。下面是代码...我还在代码下面包含了错误报告。这仅发生在电话上。

```
 import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.os.Bundle;
import android.telephony.PhoneStateListener;
import android.telephony.SignalStrength;
import android.telephony.TelephonyManager;

public class ConnectivityCheck extends Activity {

    TelephonyManager        Tel;
   MyPhoneStateListener    MyListener;
   boolean isGsm;
   boolean cellAvailable;
int strengthAmplitudeGSM;
int strengthAmplitudeCDMA;

@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);         

    ConnectivityManager connec =  (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);

    if (connec.getNetworkInfo(0) != null)
    {
        cellAvailable = true;
    }

    if (cellAvailable)
    {
    /* Update the listener, and start it */
        MyListener   = new MyPhoneStateListener();
        Tel = ( TelephonyManager )getSystemService(Context.TELEPHONY_SERVICE);
        Tel.listen(MyListener ,PhoneStateListener.LISTEN_SIGNAL_STRENGTHS);
    }

 if (connec.getNetworkInfo(1).getState() == NetworkInfo.State.CONNECTED)
     {
        startActivity(new Intent(ConnectivityCheck.this, LicenseCheck.class));
        if (cellAvailable)
        {
        Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE);
        }
        finish();
     }
  else if (cellAvailable)
  {
     if (connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTED && strengthAmplitudeCDMA >= -90)
     {
         startActivity(new Intent(ConnectivityCheck.this, LicenseCheck.class));
        Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE);
        finish();
     }
     else if (connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTED && isGsm && strengthAmplitudeGSM >= 10 && strengthAmplitudeGSM <= 31)
     {
        startActivity(new Intent(ConnectivityCheck.this, LicenseCheck.class));
        Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE); 
        finish();
     }
     else 
    {

        startActivity(new Intent(ConnectivityCheck.this, ProtocolsMMenuActivity.class));
        Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE); 
        finish();
     }
  }
  else
  {
        startActivity(new Intent(ConnectivityCheck.this, ProtocolsMMenuActivity.class));  
        if (cellAvailable)
        {
        Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE);
        }
    finish();
  }

}

/* Called when the application is minimized */
    @Override
   protected void onPause()
    {
      super.onPause();
            if (cellAvailable)
        {
        Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE);
        }
   }

    /* Called when the application resumes */
   @Override
   protected void onResume()
   {
      super.onResume();
        if (cellAvailable)
        {
        Tel.listen(MyListener, PhoneStateListener.LISTEN_SIGNAL_STRENGTHS);
        }
       }

   /* Start the PhoneState listener */
    private class MyPhoneStateListener extends PhoneStateListener
    {
      /* Get the Signal strength from the provider, each tiome there is an update */
      @Override
      public void onSignalStrengthsChanged(SignalStrength signalStrength)
      {

    isGsm = signalStrength.isGsm();
    strengthAmplitudeGSM = signalStrength.getGsmSignalStrength();
    strengthAmplitudeCDMA = signalStrength.getCdmaDbm();

     super.onSignalStrengthsChanged(signalStrength);
 }
};/* End of private Class */
} 
```

这是错误报告

```
 java.lang.NoClassDefFoundError: com.emsprotocols.njalsprotocolspaidac.ConnectivityCheck
at com.emsprotocols.njalsprotocolspaidac.ProtocolsSplashActivity$1.onAnimationEnd        (ProtocolsSplashActivity.java:144)
 at android.view.animation.AnimationSet.getTransformation(AnimationSet.java:411)
 at android.view.animation.Animation.getTransformation(Animation.java:920)
 at android.view.ViewGroup.drawChild(ViewGroup.java:2657)
 at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2489)
 at android.view.ViewGroup.drawChild(ViewGroup.java:2885)
 at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2489)
 at android.view.ViewGroup.drawChild(ViewGroup.java:2885)
 at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2489)
 at android.view.View.draw(View.java:11009)
 at android.widget.FrameLayout.draw(FrameLayout.java:450)
 at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:2154)
 at android.view.ViewRootImpl.draw(ViewRootImpl.java:2096)
 at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1679)
 at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2558)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:137)
 at android.app.ActivityThread.main(ActivityThread.java:4722)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:511)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
 at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:25:51.217

这是 r21 版本 SDK 工具的常见问题。进入您的项目设置，然后进入 Java Build Path。如果您展开“Android Dependencies”，您将看到您的 libs 文件夹中的一些 .jars 现在存在重复项。

从顶层删除所有重复项，只保留 Android Dependencies 文件夹中的那些。然后清理你的项目，你应该很高兴再去一次。

# r - 如何多次绑定同一个向量？

> ID：13693349
> 
> 赞同：13
> 
> 时间：2012-12-03T23:02:54.213
> 
> 标签：r

如何`o = c(1,2,3,4)`多次绑定同一个向量以获得如下矩阵：

```
o = array(c(1,2,3,4,1,2,3,4,1,2,3,4), dim(c(4,3))
     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    2    2    2
[3,]    3    3    3
[4,]    4    4    4 
```

以一种更好的方式比：`o = cbind(o,o,o)`并且可能更概括（`duplicate`）？我需要这个来为`textplot`.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-03T23:04:02.263

R 回收。它非常环保：

```
o=c(1,2,3,4) 
> matrix(o,nrow = 4,ncol = 4)
     [,1] [,2] [,3] [,4]
[1,]    1    1    1    1
[2,]    2    2    2    2
[3,]    3    3    3    3
[4,]    4    4    4    4 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-03T23:11:16.803

您可以使用`replicate`

```
> o = c(1,2,3,4) 
> replicate(4, o)
     [,1] [,2] [,3] [,4]
[1,]    1    1    1    1
[2,]    2    2    2    2
[3,]    3    3    3    3
[4,]    4    4    4    4 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:57:12.503

你可以使用外

```
outer(1:4,1:4,function(x,y)x)
     [,1] [,2] [,3] [,4]
[1,]    1    1    1    1
[2,]    2    2    2    2
[3,]    3    3    3    3
[4,]    4    4    4    4 
```

# c# - 在 C# 中比较多个字符串

> ID：13693356
> 
> 赞同：0
> 
> 时间：2012-12-03T23:03:47.610
> 
> 标签：c#, string, compare

我希望能够相互比较多个字符串，`true`如果它们都相等则返回。如果任何字符串等于“N/A”，那么它们将在比较中被忽略。例如：

```
string1 = "hi";
string2 = "hi";
string3 = "hi";
string4 = "N/A"; 
```

会返回`true`，但是：

```
string1 = "hi";
string2 = "hey";
string3 = "hi";
string4 = "hi"; 
```

会回来`false`的。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T23:05:58.707

```
if (myStrings.Where(s => s != "N/A").Distinct().Count() > 1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:08:00.803

假设您已将字符串存储在数组或列表等集合中，您可以使用[`Enumerable.All`](http://msdn.microsoft.com/en-us/library/bb548541.aspx)：

```
string first = strings.FirstOrDefault(s => s != "N/A");
bool allEqual = first == null ||  strings.All(s => s == "N/A" || s == first); 
```

**说明**：您可以将所有字符串与您选择的一个（我选择第一个）进行比较，如果一个不同`allEqual`必须是假的。我需要使用`FirstOrDefault`，因为可能所有字符串都是“N/A”或列表为空，然后`First`会抛出异常。

[**演示**](http://ideone.com/7r5E9D)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:47:07.767

这个问题已经回答了，但我想我会陈述最明显的代码来做到这一点：

```
bool notEqual = false;
for (int i = 0; i < list.Count - 1; i++) {
   for (int j = i + 1; j < list.Count; j++) {
      if (!(list[i].Equals(list[j])) {
         notEqual = true;
         break;
      }
   }
} 
```

这个想法很简单。对于第一个元素，您必须查看下一个 (length - 1) 元素。但是，对于第二个元素，您已经将其与第一个元素进行了比较，因此您可以查看下一个 (length - 2) 个元素。您以 length - 1 结尾，因为此时您将比较倒数第二个和最后一个元素，这是最后可能的比较。

无论如何，上述答案要简洁/优雅得多。这只是为了向您展示在最基本的 C# 级别上实际发生的情况。

# jquery - 最佳 jQuery 拖放解决方案

> ID：13693359
> 
> 赞同：0
> 
> 时间：2012-12-03T23:03:57.800
> 
> 标签：jquery, drag-and-drop

我正在做一个相当复杂的项目，其中会有很多 LI 对象，我想让它们可拖放到几个预定义的 UL 中，然后根据已放入的 UL 组执行特定命令。

我为此找到了很多不同的 jQuery 插件，但是我想知道什么是最好和最容易适应这样的东西？

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:07:52.523

查看可排序的 JQuery UI 组件。该组件可以在 UL 容器之间拖放 Li 元素。

# python - 更新嵌入文档中的新密钥

> ID：13693365
> 
> 赞同：0
> 
> 时间：2012-12-03T23:04:22.907
> 
> 标签：python, mongodb, pymongo

db.stuff 中的文档是：

```
{ ...,
counts : [ {name: Alice, age: 18, pay: 27}, {name : Jen, age: 23, pay: 56}, ... ] ,
  ... } 
```

我正在使用以下代码来尝试一一更新嵌入式文档。我遍历嵌入的文档，执行计算，然后想在每个单独的子文档中设置一个新键。

```
x = [3, 45, 77, 61, 98, 76, 32, ... ]

for i in db.stuff.find():
    for element in i['counts']:
        x.append(element['pay'])
        total = 1.0 - ((sorted(x).index(element['pay']) + 1) / float(len(x)))
        db.stuff.update({'id': i['id']}, {'$set':{ element['new_key'] :total}})
        x.remove(element['pay']) 
```

但是，这返回`<type 'exceptions.KeyError'>`or `< class 'bson.erros.InvalidDocument' >`，我相信这是因为我没有将新密钥插入嵌入文档的正确方法。我需要找到一个替代品，`{'$set':{ element['new_key'] :total}`但我被困住了。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:05:08.870

试试这个（使用位置参数）

```
db.stuff.update({'id':i['id'], 'counts.name':element['name']}, {'$set': {'counts.$.newfield':total}}) 
```

这会在 db 中查询 id=i['id'] 并在 counts 数组中查找 name=element['name'] 的条目，然后使用“$”将新的 key/val 对添加到第一个匹配的子文档中

# html - 与 IE、Firefox 和 Chrome 兼容的 CSS 下拉菜单（无浮动/无浮动）

> ID：13693386
> 
> 赞同：0
> 
> 时间：2012-12-03T23:06:03.003
> 
> 标签：html, css, drop-down-menu, cross-browser, css-float

我的菜单和 IE 有问题。Firefox 和 Chrome 将菜单呈现得恰到好处，完全符合我的要求。你能看看我的css并帮我解决问题吗？

-我很确定这只是我没有看到的一些更正。

PS。请不`float: left;`

jsFiddle：http: [//jsfiddle.net/omarjuvera/P8Mdk/#base](http://jsfiddle.net/omarjuvera/P8Mdk/#base)

IE截图：http: [//img29.imageshack.us/img29/4012/screenshothd.jpg](http://img29.imageshack.us/img29/4012/screenshothd.jpg)

**HTML**

```
 <!-- START: menu -->
    <nav id="main-menu" class="conteiner">
    <ul id="menu" class="content">
        <li class="logo" ><a href="#" title="Home"><img src="http://www.firstchoicehousing.com/_img/menu/help/logo.png" alt="First Choice Housing" /></a></li>
        <li class="menu" ><a href="#">Menu 1</a></li>
        <li class="menu" ><a href="#">Menu 2</a></li>
        <li class="menu" ><a href="#">Menu 3</a>
            <ul class="submenu" >
                <li><a href="#">Sub 1</a></li>
                <li><a href="#">Sub 2</a></li>
                <li><a href="#">Sub 3</a></li>
                <li><a href="#">Sub 4</a></li>
                <li><a href="#">Sub 5</a></li>
                <li><a href="#">Sub 6</a></li>
                <li><a href="#">Sub 7</a></li>
            </ul>
        </li>
        <li class="menu" id="resident"><a href="#">Menu 4</a>
            <ul class="submenu">
                <li><a href="#">Sub 1</a></li>
                <li><a href="#">Sub 2</a></li>
                <li><a href="#">Sub 3</a></li>
                <li><a href="#">Sub 4</a></li>
                <li><a href="#">Sub 5</a></li>
                <li><a href="#">Sub 6</a></li>
            </ul>
        </li>
        <li class="menu" id="community"><a href="#">Menu 5</a>
            <ul class="submenu">
                <li><a href="#">Sub 1</a></li>
                <li><a href="#">Sub 2</a></li>
                <li><a href="#">Sub 3</a></li>
                <li><a href="#">Sub 4</a></li>
                <li><a href="#">Sub 5</a></li>
                <li><a href="#">Sub 6</a></li>
                <li><a href="#">Sub 7</a></li>
                <li><a href="#">Sub 8</a></li>
            </ul>        
        </li>
        <li class="menu"><a href="#">Menu 6</a>
            <ul class="submenu">
                <li><a href="#">Sub 1</a></li>
                <li><a href="#">Sub 2</a></li>
                <li><a href="#">Sub 3</a></li>
                <li><a href="#">Sub 4</a></li>
                <li><a href="#">Sub 5</a></li>
                <li><a href="#">Sub 6</a></li>
                <li><a href="#">Sub 7</a></li>
                <li><a href="#">Sub 8</a></li>
            </ul>        
        </li>
        <li class="menu"><a href="#">Menu 7</a></li>
        <li class="menu"><a href="#">Menu 8</a></li>
    </ul> <!-- /#menu -->
    </nav>
    <!-- END: menu -->
    <!--

        <ul>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        <ul>

     -->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
<img src="http://img811.imageshack.us/img811/9566/76079487.jpg" alt="Some Sample image" title="Some Sample image" />
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text ->
Some sample text -> 
```

**CSS**

```
@charset "utf-8";
body { background: url(http://img59.imageshack.us/img59/5056/bodyrpt.jpg); }
.conteiner {
    width: 100%;
    margin: 0;
    padding: 0;
}
.content {
    width: 1000px;
    margin: 0 auto;
}
/*  ****** FUNCTIONALITY ***********************************************************************************************************
    (Hide menu/Set sub-menu to the right)
        Documentation:
        http://stackoverflow.com/questions/4873604/css-menu-without-javascript
        http://www.htmldog.com/articles/suckerfish/dropdowns/
*/
#menu { position: relative; }
    /*Submenus*/
#menu li>.submenu { position: absolute; left: -999em; }
#menu li:hover>.submenu { left: auto; width: 12em; }

/*  ****** STYLE **************************************************************************
    Looks and feel of the menus and submenus
*/
/* ---- Container Styling ---- */
#main-menu { background-image: url('http://imageshack.us/a/img203/8503/navg.jpg'); }
/* ---- Menu Styling ---- */
#menu {
    width: 1000px;
    padding: 0px;

    background-color: black;
    background-color: rgba( 0,0,0,0.80 );
    background-image: url('http://imageshack.us/a/img208/1033/menudz.jpg');

}
#menu ul { list-style: none; list-style-type: none; margin: 0; padding: 0px; }
    /* ALL-menu's text */
#menu a {
    display: inline-block;
    font-size: 0.8em;
    text-decoration: none;

    font-family: "Arial Black", Gadget, sans-serif;

    color: #ecc676;
    padding: 0em .5em 0em .5em;
    }

/* ---- First-level menu Styling ---- */
    /*Menu*/
#menu>li {
    display: inline-block;
    vertical-align: middle;
}
    /*Text*/
#menu .menu>a {
    color: #a6625a;

    padding: 22px 4px;
}
#menu .menu>a:hover {
    color: #ecc676;
    background: #270909;
}
    /*Submenu*/
#menu .submenu>li {
    border-bottom: 2px groove #CCCCCC; /*Light Grey*/
    border-bottom: 2px groove #808080; /*Grey*/
    border-bottom: 2px groove #3E1612; /*thefirst_choice.css*/
}
#menu .submenu a {
    display: block;
    padding: 8px 0px 8px 5px;

    color: #fff;
    font-size: 0.8em;
    font-weight: bold;
    font-family: Arial,Helvetica,sans-serif;

    background-color:  #330000;
    background-color:  rgb( 78,25,25 );
    background-color: rgba( 78,25,25,0.80 );

    }
#menu .submenu a:hover {
    color: #330000;
    background-color: #eee9e9;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:21:47.530

对我来说，它在 IE9 和 Chrome 中的工作原理完全相同......你使用的是什么版本的 Internet Explorer？IE 中的菜单到底有什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T01:43:16.963

**jsFiddle**：http: [//jsfiddle.net/omarjuvera/P8Mdk/11/](http://jsfiddle.net/omarjuvera/P8Mdk/11/)

**CSS：**

```
@charset "utf-8";
body { background: url(http://img59.imageshack.us/img59/5056/bodyrpt.jpg); }
.doc {
    width: 100%;
    margin: 0;
    padding: 0;
}
.content {
    width: 1000px;
    margin: 0 auto;
}
/******* FUNCTIONALITY ***********************************************************************************************************
    (Hide menu/Set sub-menu to the right)
        Documentation:
        http://stackoverflow.com/questions/4873604/css-menu-without-javascript
        http://www.htmldog.com/articles/suckerfish/dropdowns/
*/
    /* Menus */
#main-menu #menu                        { position: relative; }
#main-menu #menu>li                 { display: inline-block; }
    /* Submenus */
#main-menu #menu li>.submenu            { position: absolute; left: -999em; }
#main-menu #menu li:hover>.submenu  { display: block; left: auto; width: 12em; }

/******* STYLE ***********************************************************************************************************
    Looks and feel of the menus and submenus
*/
    /* GENERAL SETTINGS */
#main-menu ul               { list-style-type: none; }
#main-menu #menu a          { display: block; text-decoration: none; }
#main-menu .menu a          { padding: 0.8em .8em; } /* menu: left-right padding | submenu: top-bottom */
#main-menu #menu li         { vertical-align: middle; white-space: nowrap; }
#main-menu img, #main-menu a    { border: none; outline:none; }

    /* container */
#main-menu { background-image: url('http://imageshack.us/a/img203/8503/navg.jpg'); }

    /* menu */
#main-menu #menu {
    padding: 0px;
    background-image: url('http://imageshack.us/a/img208/1033/menudz.jpg');
}
#main-menu .menu>a {
    color: #a6625a;
    font-size: 0.795em; 
    font-family: "Arial Narrow", Arial, Gadget, sans-serif;
    text-transform: uppercase;
    padding: 1.77em .5em;
}
#main-menu .menu>a:hover        { color: #ecc676; background: #270909; }
#main-menu .menu>a:active   { color: #ecc676; background: #270909; }
#main-menu .menu>a:visited  { color: #a6625a; }

    /* Sub-menu */
#main-menu .submenu {
    padding: 0;

    background-color:  #330000;
    background-color:  rgb( 78,25,25 );
    background-color: rgba( 78,25,25,0.85 );
}
#main-menu .submenu li { border-bottom: 2px groove #3E1612; }
#main-menu .submenu a {
    color: #fff;
    font-size: 0.8em;
    font-weight: bold;
    font-family: Arial, Helvetica, sans-serif;
}
#main-menu .submenu>li>a:hover  { color: #330000; background-color: #eee9e9; }
#main-menu .submenu>li>a:active { color: #330000; background-color: #eee9e9; }
#main-menu .submenu>li>a:visited    { color: #fff; } 
```

# php - Why is my variable undefined?

> ID：13693388
> 
> 赞同：0
> 
> 时间：2012-12-03T23:06:06.870
> 
> 标签：php

I have noticed this is a common error in `php` and i tried to search the net and i can not get my answer, I am trying to create a simpe forum and I am getting these errors

```
Notice: Undefined variable: topics in C:\xampp\htdocs\mysite\Students forum\view_category.php on line 83

Notice: Undefined variable: topic in C:\xampp\htdocs\mysite\Students forum\view_category.php on line 86 
```

and this is the code on line 83

```
$topics .= "<table width='100%' style='border-collapse: collapse;'>"; 
```

and this is the code on line 86

```
$topic .= "<tr><td colspan='4'><hr /></td></tr>"; 
```

and this is my code

```
if (mysql_num_rows($res2) > 0) {
        // Appending table data to the $topics variable for output on the page
        $topics .= "<table width='100%' style='border-collapse: collapse;'>";
        $topics .= "<tr><td colspan='4'><a href='index.php'>Return To Forum Index</a>".$logged."<hr /></td></tr>";
        $topics .= "<tr style='background-color: #dddddd;'><td>Topic Title</td><td width='65' align='center'>Last User</td><td width='65' align='center'>Replies</td><td width='65' align='center'>Views</td></tr>";
        $topic .= "<tr><td colspan='4'><hr /></td></tr>";
        // Fetching topic data from the database
        while ($row = mysql_fetch_assoc($res2)) {
            // Assign local variables from the database data
            $tid = $row['id'];
            $title = $row['topic_title'];
            $views = $row['topic_views'];
            $date = $row['topic_date'];
            $creator = $row['topic_creator'];
            // Check to see if the topic has every been replied to
            if ($row['topic_last_user'] == "") { $last_user = "N/A"; } else { $last_user = getusername($row['topic_last_user']); }
            // Append the actual topic data to the $topics variable
            $topics .= "<tr><td><a href='view_topic.php?cid=".$cid."&tid=".$tid."'>".$title."</a><br /><span class='post_info'>Posted by: ".getusername($creator)." on ".convertdate($date)."</span></td><td align='center'>".$last_user."</td><td align='center'>".topic_replies($cid, $tid)."</td><td align='center'>".$views."</td></tr>";
            $topics .= "<tr><td colspan='4'><hr /></td></tr>";
        }
        $topics .= "</table>";
        // Displaying the $topics variable on the page
        echo $topics;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:09:29.823

The operator `.=` is typically used for concatenation of the right and left argument, but in this case, you do not have a left argument. You must instantiate the variable like so:

```
$topics = "<table width='100%' style='border-collapse: collapse;'>";
$topic = "<tr><td colspan='4'><hr /></td></tr>";

if( ... ) {
    while( ... ) {
        $topics .= ...
        $topic .= ...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:10:36.880

Declare the variable first before you use `$topics .="anything"`

```
$topics =''; 
$topics .= "whatever you want"; // must have been declared before 
```

So in this case, it can be like

```
if (mysql_num_rows($res2) > 0) {
    $topics="<table width='100%' style='border-collapse: collapse;'>"
    $topics .= "<tr><td colspan='4'><hr /></td></tr>";
    // rest of your code
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:11:12.770

This `$topics .=` is a shorthand for `$topics = $topics .` and if you use it the first time you use a variable, the variable is not considered 'defined'.

So you should at least do:

```
$topics = '';
$topic = ''; 
```

Before you start using the shorthand.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T23:27:38.487

```
$topic .= 'something'; 
```

Is the same as

```
$topic = $topic . 'something'; 
```

It effectively means:

1.  take $topic,
2.  join 'something' behind it
3.  put the result back in $topic

If $topic wasn't used anywhere before this line, the first step fails, since the $topic variable doesn't exist yet.

First time you put something in $topic, use simple

```
= 
```

instead, then you can join more stuff to it via

```
.= 
```

# windows - 是否可以在批处理脚本中同时显示和重定向标准输出？

> ID：13693389
> 
> 赞同：1
> 
> 时间：2012-12-03T23:06:08.147
> 
> 标签：windows, cmd, batch-file

我正在尝试做

```
 call script.bat > script.log 
```

但它不会在控制台中显示结果。所以目前我必须做

```
 call script.bat
 call script.bat > script.log 
```

这真的是低效的。

有没有办法将输出显示到控制台并将其输出到日志文件？我知道其中一种选择是

```
call script.bat > script.log
type script.log 
```

但是，如果 script.bat 只是一个长批处理过程中的一个步骤，那么这并没有真正起作用，我希望看到每个步骤的输出，因为它被调用而不是在所有结束时执行一次类型电话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:11:58.023

如果您使用 windows Power-Shell（我假设 windows 标签），则有一个名为 Tee-Object 的 cmdlet。

```
help Tee-Object

NAME
    Tee-Object

SYNOPSIS
    Saves command output in a file or variable and displays it in the console. 
```

在 Unix 下，有提供相同功能的程序*tee 。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:26:19.130

你不能。

选项1：

```
call "script.bat" > "script.log" | type "script.log" 
```

选项 2：

**wintee** [http://code.google.com/p/wintee/](http://code.google.com/p/wintee/)

# .net - 使用 ActiveMQ NMS 处理事务和事件驱动的消费者

> ID：13693398
> 
> 赞同：0
> 
> 时间：2012-12-03T23:06:49.840
> 
> 标签：.net, activemq, messaging, message-driven-bean, nms

引用 Hohpe G. 和 Woolf B. 的 EIP 模式书：

> 请注意，在 JMS 中，同时也是事务客户端的事件驱动消费者将无法按预期工作。通常，当事务中的代码抛出异常时，事务会回滚，但 MessageListener.onMessage 签名不提供抛出异常（例如 JMSException），并且运行时异常被认为是程序员错误。如果发生运行时异常，JMS 提供者通过传递下一条消息进行响应，因此导致异常的消息丢失。要成功实现事务、事件驱动的行为，请使用消息驱动的 EJB。

我明白这一点，但如果我从 .Net 客户端使用 Apache NMS (ActiveMQ) 怎么办？我没有MDB，所以我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:20:25.993

ActiveMQ NMS 客户端异步消费者的功能与 Java 版本基本相同。您应该在回调中处理异常，因为它们在 NMS 中也被视为程序员错误，并且在事务中传递下一条消息。

# java - 试图从 a 中删除罗马数字和数字 数组列表

> ID：13693401
> 
> 赞同：2
> 
> 时间：2012-12-03T23:06:55.063
> 
> 标签：java, arrays, list, numbers

我正在尝试删除诸如“我”之类的东西。“二。” “279”（页码和章节）等来自故事“罗宾汉”的文本文件。到目前为止，我无法弄清楚如何摆脱数字（这`arraylist`是一个字符串）

```
for (int x = 0; x < list.size(); x++) {

    if (list.get(x).equalsIgnoreCase("I.") || list.get(x).equalsIgnoreCase("II.") || list.get(x).equalsIgnoreCase("III.") || list.get(x).equals("IV.") || list.get(x).equals("V.") || list.get(x).equalsIgnoreCase("VI.") || list.get(x).equalsIgnoreCase("VII.") || list.get(x).equalsIgnoreCase("VIII.") || list.get(x).equals("IX.") || list.get(x).equals("X.") || list.get(x).equals("XI.") || list.get(x).equalsIgnoreCase("XII.") || list.get(x).equalsIgnoreCase("XIII.") || list.get(x).equalsIgnoreCase("XIV.") || list.get(x).equalsIgnoreCase("XV.") || list.get(x).equalsIgnoreCase("XVI.") || list.get(x).equalsIgnoreCase("XVII.") || list.get(x).equalsIgnoreCase("XVIII.") || list.get(x).equalsIgnoreCase("XIX.") || list.get(x).equalsIgnoreCase("XX.") || list.get(x).equalsIgnoreCase("XXI.")) {
        list.remove(x);
        numWords--;
    }

    for (int y = 0; y < 9; y++) {
        if (list.get(x) == y) {
            list.remove(x);
            numWords--;
        }

    }

} 
```

我知道我正在查看是否存在错误，`y == list.get(x)`但我真的想不出另一种删除数字的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T23:17:58.023

而不是有那个庞大的`if`声明，你也许可以做类似的事情

```
if (list.get(x).toUpperCase().matches("[IVXLCDM]+\\.")) {...} 
```

`[IVXLCDM]`匹配任何一个`I`，`V`.. `M`- 所以`[IVXLCDM]+`匹配这些字符的任何连续字符串。`\.`确保字符串以句点结尾。

现在，如果您想匹配数字，您可以使用正则表达式`"\\d+"`，并应用与上述相同的想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:21:45.620

您需要使用正则表达式来找出匹配数字或罗马数字的行。您需要的正则表达式（正则表达式的缩写）可能类似于：

```
^([0-9]+)|([IVXLCM]+)\\.?$ 
```

检查阿拉伯数字和罗马数字。这是一个关于正则表达式的[教程](http://docs.oracle.com/javase/tutorial/essential/regex/)，它为您提供了一个示例应用程序来尝试正则表达式，并解释了语法。

# java - java使用listIterator插入元素

> ID：13693406
> 
> 赞同：0
> 
> 时间：2012-12-03T23:07:03.320
> 
> 标签：java, arraylist, iterator, listiterator

我正在为一种玩具编程语言构建一个图形着色分配器。在生成溢出代码时，有时我必须在当前指令之前插入一个加载{用于恢复}或在当前指令之后插入一个插入{用于溢出}。我的代码表示为一个图，每个基本块都有一个节点，块内有一个指令列表，

我生成了一个 dfs 有序的图形节点列表，对于每个节点，我使用 codeList.listIterator() 遍历节点内的指令列表，我可以分别通过 next 和 previous 来回执行，并为 insert after 和 insert before 添加。

如何使用 add() 方法在列表的开头进行插入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:18:34.120

来自 ListIterator.add API

```
The element is inserted immediately before the element that would be returned by next(), if any, and after the element that would be returned by previous(), if any. (If the list contains no elements, the new element becomes the sole element on the list.) The new element is inserted before the implicit cursor: a subsequent call to next would be unaffected, and a subsequent call to previous would return the new element. 
```

这是它在实践中如何工作的示例

```
 List<String> l = new ArrayList<String>();
    l.add("1");
    ListIterator<String> i = l.listIterator();
    i.add("2");
    while (i.hasPrevious()) {
        i.previous();
    }
    i.add("3");
    System.out.println(l); 
```

输出

```
[3, 2, 1] 
```

我们可以用 ListIterator 做更多的技巧

# cakephp - cakephp 复杂查找

> ID：13693407
> 
> 赞同：0
> 
> 时间：2012-12-03T23:07:07.123
> 
> 标签：cakephp, find

当客户连接时，我想找到有关关注用户的所有新闻（actus）。

我创建了这些表

**用户**
ID
用户名
创建

**关注
id
user_id **follow_id**** 

 ****Actus**
id
user_id
内容已
创建

模型用户通过 Hasmany 关节链接到 Follow 和 Actu

我试试这个，但它似乎不起作用

```
 $this->Follow->find('all', array(
        'conditions' => array('Follow.user_id' => $this->Session->read('Auth.User.id')),
        'contain' => array('User' => array('Actu','conditions'=>array('User.id = Follow.follow_id'))))); 
```

有人可以帮助我吗？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T13:44:02.107

这是结果

数组（[0] => 数组（[关注] => 数组（[id] => 12 [user_id] => 2 [followed_id] => 21）

```
 [User] => Array
            (
                [id] => 21
                [username] => isabelle
                [mail] => isabelle@
                [password] => 0469e87ef6441742744443fd1fc10f6bf59ee238
                [created] => 2012-04-24 15:28:07
                [lastlogin] => 2012-11-30 17:22:24
                [active] => 1
                [firstname] => Isabelle
                [lastname] =>
                [avatar] => 1335274087.jpg
                [age] => 29
                [town] => Paris
                [url] => 
                [Actu] => Array
                    (
                        [0] => Array
                            (
                                [id] => 2
                                [user_id] => 2
                                [content] => <a href="/users/view/2">rti</a> a post&eacute; un message sur la page <a href="/events/view/4"></a>
                                [created] => 2012-11-30 11:23:23
                            ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T06:15:53.513

我认为您的关联需要修改（修改您的模型和表格）

将 follow_id 放入 Actus 表中，然后将相关表放入 Actus 表并确认表名是 Users

您需要像 Follows hasmany Actus 和 Follows 属于用户这样的关联

如果您拥有所有正确的关联，那么您可以使用 find 查询这样

```
$this->Follow->find('all',array('conditions'=>array('Follow.user_id' => $this->Session->read('Auth.User.id'))); 
```

请检查这个

1.  确保表名是用户
2.  将 follow_id 放入 Actus 表中
3.  确保关联**

# playframework-2.1 - 构建多个 Play Framework (2.1) 项目以进行继承

> ID：13693414
> 
> 赞同：2
> 
> 时间：2012-12-03T23:07:27.640
> 
> 标签：playframework-2.1

我希望使用 Play 创建多个站点，但希望以某种方式构建它，以便可以共享大多数代码和路由。我已经看到了许多依赖于其他项目的项目示例，并发现 2.1 候选版本允许导入路由，但仍然不知道如何设置项目。我想要实现的图层如下所示：

**Core** - 包含核心路由、控制器、助手、核心静态资源和视图的单个共享项目

**模板**- 少数包含模板特定路由、控制器、静态资源和视图的模板项目

**站点**- 大量包含 css (scss) 和配置的站点

然后，单个正在运行的应用程序将包含一个构建在单个模板项目之上的站点，该模板项目构建在核心之上。

这样做背后的想法是能够跨站点共享尽可能多的代码，并能够快速构建它们（假设模板存储库中已经有一个符合要求的模板项目）。

我最初的想法是有一个看起来像这样的结构：

```
->core
->templates
       ->template1Project
       ->template2Project
->sites
       ->site1project
       ->site2project
       .
       . 
```

然后我将在每个站点下的模块目录中创建一个符号链接，指向模板和核心，这将允许我在每个站点中将这些作为 PlayProject 依赖项，但仍然只维护一个。

我在做什么感觉很不对劲，还有其他人以更好的方式实现了类似的项目结构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T14:53:12.757

我确实必须构建一个多项目 Play 应用程序结构，这就是我们最终要做的。

### Scala 构建工具

Play 项目或模块基本上是[sbt 项目](http://www.scala-sbt.org/)，sbt 不允许从父目录导入模块。如果要导入项目，则需要可从项目的根目录访问它。将符号链接添加到父目录可以解决问题，但它是某种猴子补丁。

相反，您可以完全使用 sbt 并从*主*项目定义项目层次结构和依赖关系。

### 超级工程

您在问题中建议的层次结构似乎很自然而且很好，需要做的是定义一个将监督所有模块和项目的项目。它将是应用程序的唯一入口点。

所以这个超级模块的文件系统应该是这样的：

```
/core
/templates
  /template1
  /template2
  ...
/sites
  /site1
  /site2
  ...
/project           --> Normal Play config files
  Build.scala      
  build.properties
  plugins.sbt
/conf
  application.conf --> emtpy file so Play recognises it as a project. 
```

这里的关键是在`Build.scala`. 根据您的项目，它可能如下所示：

```
import sbt._
import Keys._
import play.Project._

object ApplicationBuild extends Build {
  val commonDependencies = Seq( javaCore, javaJdbc, javaEbean )

  val coreDeps = commonDependencies
  val core = play.Project("core", "1.0.0", coreDeps, path=file("core"))

  val template1Dependencies = comonDependencies

  // Define the template, note that the dependsOn() adds local dependencies
  // and the aggregate() asks to first compile the dependencies when building
  // this project.
  val template1 = play.Project("template1", "1.0.0", template1Dependencies,
                               path=file("templates/template1")).dependsOn(core)
                                                                .aggregate(core)

  val site1Deps = commonDependencies
  val site1 = play.Project("site1", "1.0.0", site1Deps,
                           path=file("sites/site1")).dependsOn(core, template1)
                                                    .aggregate(core, template1)

  val main = play.Project("master-project", appVersion)
} 
```

另请注意，您的任何子模块都不需要`/project`目录，因为所有内容都在主`Build.scala`文件中定义。只有`conf/application.conf`每个子项目都需要。

然后你需要做的就是从主目录加载 play 并从 sbt 提示符中选择项目：

```
[master-project]> project site1
[site1]> compile
[site1]> run 
```

该`projects`命令将列出您在`Build.scala`文件中定义的所有项目，并且该`project <project name>`命令将切换到所需的项目。

# asp.net - `Web Deploy` 错误 - 无法创建数据库

> ID：13693417
> 
> 赞同：1
> 
> 时间：2012-12-03T23:07:35.153
> 
> 标签：asp.net, webdeploy

我在使用 Web 部署时遇到问题。尤其：

1.  我不确定要在发布配置文件中使用什么用户名/密码/serviceurl/站点/应用程序。

2.  我也对需要在连接字符串中包含的内容感到困惑。

我要么收到一条错误消息，指出无法创建我的一个数据库，要么是这样：

> 错误 1 ​​Web 部署任务失败。（（2012 年 12 月 3 日下午 4:57:59）在远程计算机上处​​理请求时出错。）
> 
> （2012 年 12 月 3 日下午 4:57:59）在远程计算机上处​​理请求时发生错误。处理（url）上的“创建目录”操作时遇到错误 I/O 发生错误。

我正在使用提供的“Arvixe”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:00:48.710

好的，事实证明我的一切都是正确的。

问题是服务器要求我手动创建数据库。

之后，我可以运行我的代码来生成表并用数据填充它们。

问题在于最初创建的数据库。

# javascript - jquery拖放：我可以防止一个元素在被删除后被拖放到另一个div吗？

> ID：13693419
> 
> 赞同：0
> 
> 时间：2012-12-03T23:07:41.050
> 
> 标签：javascript, jquery

我一直在努力完成这项工作，但没有任何运气，我决定在这里问。

我正在使用 jquery ui 库创建拖放 div。

目前，我在页面上动态添加了许多带有“父”类的 div：

```
$( ".parent" ).droppable({
        accept: ".child",
        activeClass: "ui-state-hover",
        hoverClass: "ui-state-active",
    tolerance:'touch',
        drop: function( event, ui ) {
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "Dropped!" ).appendTo(ui.Target);
        }
    }); 
```

然后，我使用“child”类动态创建一个 div，并且可以将子 div 拖放到任何父 div 中。请注意，对于父级 droppable，容差设置为“触摸”

```
$( ".child" ).draggable(); 
```

父 div 的大小比子 div 小。每当我拖动一个子 div 并将其移动到两个父 div 上时（请注意，此时我还没有删除子 div），理想情况下，我希望子 div 仅被拖放到第一个父 div 中。

发生的情况是子 div 被附加到第一个父 div 中。然后它从第一个父 div 移动到第二个父 div。

有没有办法让子 div 保持可拖动但只能放入第一个父 div？

谢谢阅读。

如果不清楚，请告诉我，我会改写

将孩子拖到父母 2 和 3 上显示相同的行为：http: [//jsfiddle.net/Dyawa/3/](http://jsfiddle.net/Dyawa/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:48:21.687

我注意到您注意到它设置为：

```
tolerance:'touch' 
```

但这正是这意味着 - 'Draggable 与 droppable 任何数量的重叠。（来自[http://api.jqueryui.com/droppable/#option-tolerance](http://api.jqueryui.com/droppable/#option-tolerance)）

检查一下：http: [//jsfiddle.net/Dyawa/2/](http://jsfiddle.net/Dyawa/2/) - 只需消除公差即可查看差异。

建议您使用：

```
tolerance: 'pointer' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:09:35.053

由于我没有看到整个代码，因此有点难以猜测，但请尝试以下操作：

```
$( ".parent" ).droppable({
        accept: ".child",
        activeClass: "ui-state-hover",
        hoverClass: "ui-state-active",
    tolerance:'touch',
        drop: function( event, ui ) {
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "Dropped!" ).appendTo(ui.Target);
                     event.preventDefault(); // or `return false;` 
        }
    }); 
```

# jsp - IDEA：如何自动格式化 JSP

> ID：13693421
> 
> 赞同：1
> 
> 时间：2012-12-03T23:07:42.783
> 
> 标签：jsp, intellij-idea

使用`IntelliJ Idea`, 有没有办法自动格式化`JSP`，类似于`Java`文件的格式化方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T00:19:10.683

`Code`| **重新格式化代码**适用于 IntelliJ IDEA Ultimate Edition 中的 JSP 页面，当您的 JSP 文件扩展*名*`Settings`映射到 `File Types`.

# oracle - 使用 sqlnet.ora 的 jdbc

> ID：13693425
> 
> 赞同：1
> 
> 时间：2012-12-03T23:07:56.120
> 
> 标签：oracle, jdbc

我有一个程序想要连接到我们网络上的 oracle 数据库。这个程序是用java编写的，必须使用jdbc。我们的 PC 设置为使用 sqlnet.ora 文件来确定如何解决的顺序。我们所有的PC首先检查ldap（ldap文件在所有这些PC上指向ldap服务器）然后使用tnsnames.ora文件，但是这个文件现在是空的所以基本上我想使用ldap，但是通过sqlnet.ora。任何想法对于 url 参数的连接是什么样的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:19:03.783

来自[JDBC 开发人员指南](http://docs.oracle.com/cd/E11882_01/java.112/e16548/urls.htm#BEIDIJCE)

> *oracle.net.tns_admin 系统属性必须设置为 tnsnames.ora 文件的位置，以便 JDBC Thin 驱动程序可以找到 tnsnames.ora 文件。例如：*

```
System.setProperty("oracle.net.tns_admin", "c:\\Temp");
String url = "jdbc:oracle:thin:@tns_entry";
DriverManager.getConnection(url, ...); 
```

由于系统属性，瘦驱动程序能够找到 tnsnames.ora 文件，从而可以解析 URL 中指定的 TNS 名称。因为瘦驱动程序通常旨在在*没有*安装 Oracle 客户端的情况下工作，所以默认情况下不启用。

据我记得，您*只*需要 tnsnames.ora，即使指定 TNS 名称，使用瘦驱动程序时也不需要 Oracle 客户端。

如果您的程序不允许设置系统属性，您有两种选择：

1.  在启动程序时指定它`java -Doracle.net.tns_admin=c:/foobar ...`
2.  设置一个`JAVA_TOOLS_OPTIONS`包含`-Doracle.net.tns_admin=c:/foobar`. *然后它将被任何*Java程序自动拾取

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:27:23.790

来自[Oracle JDBC 常见问题解答](http://www.oracle.com/technetwork/database/enterprise-edition/jdbc-faq-090281.html#05_04)

```
jdbc:oracle:oci:@<<TNS alias>> 
```

`<<TNS alias>>`如果您通过 SQL*Plus 进行连接，您将使用的 LDAP 条目在哪里

# ajax - jQuery .load() 等到内容被加载

> ID：13693428
> 
> 赞同：4
> 
> 时间：2012-12-03T23:08:11.540
> 
> 标签：ajax, http, jquery

如何防止jQuery`$('body').load('something.php');`更改**任何**DOM，直到**something.php**（包括图像，js）的所有内容**完全** **加载**

- 可以说一些实际内容是：

```
Hello world 
```

`something.php`内容是：

```
image that loads for 10 seconds
20 js plugins 
```

触发 .load() 函数后什么都不会发生，直到图像和 js 文件完全加载，并`THEN`立即更改内容。

可能会出现一些预加载器，但它不是问题的主题。

**[编辑] - - - - - - - - - - - - - - - - - - - - - - - - ----------------------**

我的解决方案是跨浏览器不透明度为 0 的 css 代码（总是在构建 dom 之前加载 css）。

```
.transparent{
    -moz-opacity: 0.00;
    opacity: 0.00;
    -ms-filter:"progid:DXImageTransform.Microsoft.Alpha"(Opacity=0);
    filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0);
    filter:alpha(opacity=0);
} 
```

它通常但并非总是防止内容的不良闪烁。现在它可以以某种方式检测到内容是由 jQuery ajax 加载的，并应用一些显示超时等等。但实际上问题仍然存在。

现在为这个问题做一个更简单的例子：

单击触发 .load('something.php') 函数的链接后，如何在 $('body').load('something.php') 之后以 3000 毫秒的延迟开始更改 DOM？（浏览器应该立即开始下载，但 DOM 更改必须稍后启动）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T10:42:35.317

改用[.get](http://api.jquery.com/jQuery.get/)并在成功回调中分配内容：

```
$.get('something.php', function(result) {
    $('body').html(result);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T10:44:00.900

您可能需要自己解决一些实现细节，但这里有一个粗略的解决方案：

1.  不要`.load()`直接使用。无法更改为等待所有图像加载。

2.  用于`$.get()`将 HTML 提取到变量中，我们称之为`frag`.

3.  用于`$(frag).find('img').each(fn)`查找所有图像并将每个图像转储`this.src`到预加载器中。

    ```
    var images = [], 
    $frag = $(frag),
    loaded = 0;

    function imageLoaded()
    {
        ++loaded;
        // reference images array here to keep it alive
        if (images.ready && loaded >= images.length) {
            // add $frag to the DOM
            $frag.appendTo('#container');
        }
    }

    $frag.find('img').each(function() {
        var i = new Image();
        i.onload = i.onerror = imageLoaded;
        i.src = this.src;

        images[images.length] = i;
    });

    // signal that images contains all image objects that we wish to monitor
    images.ready = true; 
    ```

    [**演示**](http://jsfiddle.net/B8B6u/3/)

4.  加载所有图像`frag`后，使用`$frag.appendTo('#container')`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T11:18:26.937

这是一个概念的快速证明，它在将 HTML 片段插入 DOM 之前加载相关图像：http: [//jsfiddle.net/B8B6u/5/](http://jsfiddle.net/B8B6u/5/)

您可以使用 onload 处理程序预加载图像以触发迭代：

```
var images = $(frag).find('img'),
loader = $('<img/>');

function iterate(i, callback) {
    if (i > 0) {
        i--;
        loader.unbind("load");
        loader.load(function() {
            iterate(i, callback);
        });
        loader.attr('src', images[i].src);
    }else{
        callback();
    }
}

iterate(images.length,function(){
    $('#container').html(frag);
}); 
```

这应该可以工作，因为每个图像都是在前一个图像完成加载之后加载的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T10:36:53.337

你试过这个吗？

```
$(function(){$('body').load('something.php')}); 
```

**编辑：**我刚刚意识到您实际上是想等待东西加载，然后再将其放入体内。

以下是指向类似问题的三个链接。

[使用 jQuery 预加载图像](https://stackoverflow.com/questions/476679/preloading-images-with-jquery)

[是否可以使用 ajax/jquery 技术预加载页面内容？](https://stackoverflow.com/questions/728261/is-it-possible-to-preload-page-contents-with-ajax-jquery-technique)

[使用 PHP 和 jQuery 预加载图像 - 逗号分隔数组？](https://stackoverflow.com/questions/9071289/preloading-images-using-php-and-jquery-comma-seperated-array)

您也可以将它们调整为脚本。

这也可能奏效。

```
 $.ajax({
    'url': 'content.php',
    'dataType': 'text',
    'success': function(data){
        var docfrag = document.createDocumentFragment();
        var tmp = document.createElement('div'), child;
        //get str from data here like: str data.str
        tmp.innerHTML = str;
        while(child = tmp.firstChild){
            docfrag.appendChild(child);
        }
        $('body').append(docfrag);
    }
  }); 
```

按照影子向导的建议，这是一种更长的方法，但它可能会奏效。嗯。没关系。杰克的回答看起来最好。我会等一会儿，如果没有人喜欢我的答案，我会删除它。

**编辑：**看起来附加到文档片段可以做http请求。任何使用 createDocumentFrament 的脚本都可以从预加载中受益。

在这个问题中，即使 createDocumentFragment 正在这样做，他们也不需要 http 请求： [Using documentFragment to parse HTML without sent HTTP requests](https://stackoverflow.com/questions/12747350/using-documentfragment-to-parse-html-without-sending-http-requests)。

我不能确定这是否适用于所有浏览器或仅在运行 console.log 时，但如果这种行为是通用的，它可能是一个很好的预加载选择。

# java - 通过方法名从 IType 中查找 IMethod

> ID：13693431
> 
> 赞同：0
> 
> 时间：2012-12-03T23:08:20.823
> 
> 标签：java, eclipse, eclipse-jdt

假设我有 Hello 类，它有 hello 方法。

```
public class Hello {
public int hello(int x, int y) 
```

我需要获取“hello”方法的 IMethod 引用。这是我可以获得 IType (Hello) 的代码。

```
IWorkspaceRoot root = ResourcesPlugin.getWorkspace().getRoot();
// 1\. The name of the project in the workspace
IProject project = root.getProject("Hello");
project.open(null /* IProgressMonitor */);

IJavaProject javaProject = JavaCore.create(project);
// 2\. The name of the Type (including the namespace)
IType itype = javaProject.findType("smcho.HelloRenameMethod");

IMethod method = itype.findMethod() // ??? 
```

我搜索了 IType#findMethod()，但[该方法的输入参数是 IMethod 实例，而不是字符串](http://publib.boulder.ibm.com/infocenter/iadthelp/v6r0/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IType.html)。

如何使用方法名称从 IType 获取 IMethod？或者，我如何使用`IType#findMethod()`来获取 IMethod？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:22:57.417

我需要使用`getMethod`方法名称来获取 IMethod。

```
IMethod method = itype.getMethod("hello", new String[] {"I", "I"}); 
```

# jquery - 在jquery中获取链接的颜色

> ID：13693438
> 
> 赞同：0
> 
> 时间：2012-12-03T23:09:20.303
> 
> 标签：jquery, css, pseudo-class

我想用 jquery 在我的页面上获取链接的颜色。坦率地说，我想跟踪访问我页面的访问者，看看他们是否访问过另一个网站，然后根据他们访问过的网站进行推断。

这个想法是这样的：我有一个链接，比如说，profootballtalk.com。如果他们访问过该站点，则链接应通过使用 :active 伪类显示为红色。如果不是，它是蓝色的。然后我使用 jquery 来获取链接元素的 css("color")，如果它返回 "red"，则告诉我他们去过那个网站。

所以我建立了一个简单的 html 页面，你猜怎么着……它说链接每次都是蓝色的，即使它是红色的。有谁知道发生了什么？我认为这不会属于通常的“jquery 不支持伪类”答案，因为它实际上只与获取元素的渲染颜色有关。

这是我的整个 html 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">
<style>
a:visited {
    color:red;
}
</style>
</head>
<body>
<a href="http://www.w3schools.com/css/css_pseudo_classes.asp">Linkitylinklinklink</a>
<a id="thisguy" href="http://whatscookinerndog.blogspot.com/2010/07/casa-de-luz-sun-cheese.html">facebook</a>
<script>
$(document).ready(function(){
    var color = $("#thisguy").css("color");
    alert(color);
});
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:55:49.210

由于现代浏览器（例如 FireFox）中的安全功能，这不再可能：http: [//hacks.mozilla.org/2010/03/privacy-related-changes-coming-to-css-vistited/](http://hacks.mozilla.org/2010/03/privacy-related-changes-coming-to-css-vistited/)

您将不得不使用 HTML5 localStorage、cookie 或服务器端存储等其他东西来记住用户的移动。

# jquery - 单选按钮呈现为“已检查=已检查”，不确定来源

> ID：13693441
> 
> 赞同：0
> 
> 时间：2012-12-03T23:09:32.003
> 
> 标签：jquery, html, asp.net-mvc

我有一个包含 8 个不同单选按钮组（“是/否”按钮组）的页面。最初我已经编写了 html 以在选中“否”按钮的情况下进行渲染，但现在我需要在未选择任何按钮的情况下进行渲染。

我删除了“已检查 = 已检查”并刷新，但仍选择了“否”按钮。我再次刷新，清除缓存，并在不同的浏览器上运行无济于事。我正在寻求帮助找出可能的原因。

我的 MVC 代码：

```
@Html.RadioButtonFor(m => m.IsFelon, true, new { @class = "commentBox RadioIf" })
    <label for="PersonModel_Felon">Yes</label>
@Html.RadioButtonFor(m => m.IsFelon, false, new { @class = "commentBox" })
    <label for="PersonModel_Felon">No</label> 
```

它是如何呈现的：

```
<input class="commentBox" data-val="true" data-val-required="The ChildAbusePast field is required." id="ChildAbusePast" name="ChildAbusePast" type="radio" value="True" />
   <label for="HistoryModel_ChildAbusePast">Yes</Label>
<input checked="checked" class="commentBox" id="ChildAbusePast" name="ChildAbusePast" type="radio" value="False" />
   <label for="HistoryModel_ChildAbusePast">No</Label> 
```

唯一与此有关的是一些jquery：

```
$(document).ready(function () {
        $("input.commentBox").click(function () {
            if ($(this).closest('div.editor-field2').children('input:checked').val() == "True") {
               $(this).closest('div.formQuestion').children('div.hidden').slideDown(800);
          } else {
               $(this).closest('div.formQuestion').children('div.hidden').slideUp("fast");
         }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:58:53.333

如果您没有初始化 IsFelon，那么默认情况下，它将设置为“False”，这是布尔类型对象的本质。

另一方面，如果您希望默认情况下不选择收音机，那么您不应该使用 bool，您应该使用“bool”？它将默认值设置为“null”，因此不会选择任何无线电。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:23:05.533

您的模型的属性是否`IsFelon`有价值？如果它是标准布尔值，它会。因此，当您将该属性映射到值为 False 的单选按钮时，MVC 会识别它们匹配并将按钮设置为`checked`.

我能想到的最简单的解决方案是不将这些单选按钮映射到模型属性，而只是检索这些值并在回发时在控制器中以编程方式设置模型属性。您也可以考虑创建`IsFelon`一个可为空的属性，但在 MVC 中使用可为空的属性可能会涉及一些摆弄。

# ios - AVCaptureSession and AVCaptureMovieFileOutput frame timestamp

> ID：13693444
> 
> 赞同：12
> 
> 时间：2012-12-03T23:09:37.653
> 
> 标签：ios, ipad, avcapturesession, avcapturemoviefileoutput

I am recording a movie with AVCaptureSession and AVCaptureMovieFileOutput. I am also recording acceleration data and trying to align the acceleration data with the video.

I am trying to figure out a way to get the time the video file recording started. I am doing the following:

```
currentDate = [NSDate date];
[output startRecordingToOutputFileURL:fileUrl recordingDelegate:self]; 
```

However, according to my tests, the video recording starts 0.12 seconds before the call to startRecordingToOutputFileURL is made. I'm assuming this is because the various video buffers are already full of data which get added to the file.

Is there anyway to get the actual NSDate of the first frame of the video?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2022-03-03T09:37:20.573

I had the same issue and I finally found the answer. I will write all code below this, but the missing piece I was looking for was:

```
self.captureSession.masterClock!.time 
```

The masterClock in the captureSession is the clock where the relative time every buffer is based on (`presentationTimeStamp`).

* * *

**Full code and explanation**

First thing you have to do is convert the `AVCaptureMovieFileOutput` to `AVCaptureVideoDataOutput` and `AVCaptureAudioDataOutput`. So make sure your class implements `AVCaptureVideoDataOutputSampleBufferDelegate` and `AVCaptureAudioDataOutputSampleBufferDelegate`. They share the same function, so add it to your class (implementation I will get to later):

```
 let videoDataOutput = AVCaptureVideoDataOutput()
    let audioDataOutput = AVCaptureAudioDataOutput()

    func captureOutput(_ output: AVCaptureOutput, didOutput sampleBuffer: CMSampleBuffer, from connection: AVCaptureConnection) {
        // I will get to this
    } 
```

At the capture session adding the output my code looks like this (you can change the videoOrientation and other things if you want)

```
 if captureSession.canAddInput(cameraInput)
                && captureSession.canAddInput(micInput)
//                && captureSession.canAddOutput(self.movieFileOutput)
                && captureSession.canAddOutput(self.videoDataOutput)
                && captureSession.canAddOutput(self.audioDataOutput)
            {
                captureSession.beginConfiguration()
                captureSession.addInput(cameraInput)
                captureSession.addInput(micInput)
//                self.captureSession.addOutput(self.movieFileOutput)

                let videoAudioDataOutputQueue = DispatchQueue(label: "com.myapp.queue.video-audio-data-output") //Choose any label you want

                self.videoDataOutput.alwaysDiscardsLateVideoFrames = false
                self.videoDataOutput.setSampleBufferDelegate(self, queue: videoAudioDataOutputQueue)
                self.captureSession.addOutput(self.videoDataOutput)

                self.audioDataOutput.setSampleBufferDelegate(self, queue: videoAudioDataOutputQueue)
                self.captureSession.addOutput(self.audioDataOutput)

                if let connection = self.videoDataOutput.connection(with: .video) {
                    if connection.isVideoStabilizationSupported {
                        connection.preferredVideoStabilizationMode = .auto
                    }
                    if connection.isVideoOrientationSupported {
                        connection.videoOrientation = .portrait
                    }
                }

                self.captureSession.commitConfiguration()

                DispatchQueue.global(qos: .userInitiated).async {
                    self.captureSession.startRunning()
                }
            } 
```

To write the video like you would with `AVCaptureMovieFileOutput`, you can use `AVAssetWriter`. So add the following to your class:

```
 var videoWriter: AVAssetWriter?
    var videoWriterInput: AVAssetWriterInput?
    var audioWriterInput: AVAssetWriterInput?

    private func setupWriter(url: URL) {
        self.videoWriter = try! AVAssetWriter(outputURL: url, fileType: AVFileType.mov)

        self.videoWriterInput = AVAssetWriterInput(mediaType: .video, outputSettings: self.videoDataOutput.recommendedVideoSettingsForAssetWriter(writingTo: AVFileType.mov))
        self.videoWriterInput!.expectsMediaDataInRealTime = true
        self.videoWriter!.add(self.videoWriterInput!)

        self.audioWriterInput = AVAssetWriterInput(mediaType: .audio, outputSettings: self.audioDataOutput.recommendedAudioSettingsForAssetWriter(writingTo: AVFileType.mov))
        self.audioWriterInput!.expectsMediaDataInRealTime = true
        self.videoWriter!.add(self.audioWriterInput!)

        self.videoWriter!.startWriting()
    } 
```

Every time you want to record, you first need to setup the writer. The `startWriting` function doesn't actually start writing to the file, but prepares the writer that something will be written soon.

The next code we will add the code to start or stop recording. But please note I still need to fix the stopRecording. stopRecording actually finishes recording too soon, because the buffer is always delayed. But maybe that doesn't matter to you.

```
 var isRecording = false
    var recordFromTime: CMTime?
    var sessionAtSourceTime: CMTime?

    func startRecording(url: URL) {
        guard !self.isRecording else { return }
        self.isRecording = true
        self.sessionAtSourceTime = nil
        self.recordFromTime = self.captureSession.masterClock!.time //This is very important, because based on this time we will start recording appropriately
        self.setupWriter(url: url)
        //You can let a delegate or something know recording has started now
    }

    func stopRecording() {
        guard self.isRecording else { return }
        self.isRecording = false
        self.videoWriter?.finishWriting { [weak self] in
            self?.sessionAtSourceTime = nil
            guard let url = self?.videoWriter?.outputURL else { return }

            //Notify finished recording and pass url if needed
        }
    } 
```

And finally the implementation of the function we mentioned at the beginning of this post:

```
 private func canWrite() -> Bool {
        return self.isRecording && self.videoWriter != nil && self.videoWriter!.status == .writing
    }

    func captureOutput(_ output: AVCaptureOutput, didOutput sampleBuffer: CMSampleBuffer, from connection: AVCaptureConnection) {
        guard CMSampleBufferDataIsReady(sampleBuffer), self.canWrite() else { return }

        //sessionAtSourceTime is the first buffer we will write to the file
        if self.sessionAtSourceTime == nil {
            //Make sure we start by capturing the videoDataOutput (if we start with the audio the file gets corrupted)
            guard output == self.videoDataOutput else { return }
            //Make sure we don't start recording until the buffer reaches the correct time (buffer is always behind, this will fix the difference in time)
            guard sampleBuffer.presentationTimeStamp >= self.recordFromTime! else { return }
            self.sessionAtSourceTime = sampleBuffer.presentationTimeStamp
            self.videoWriter!.startSession(atSourceTime: sampleBuffer.presentationTimeStamp)
        }

        if output == self.videoDataOutput {
            if self.videoWriterInput!.isReadyForMoreMediaData {
                self.videoWriterInput!.append(sampleBuffer)
            }
        } else if output == self.audioDataOutput {
            if self.audioWriterInput!.isReadyForMoreMediaData {
                self.audioWriterInput!.append(sampleBuffer)
            }
        }
    } 
```

So the most important thing that fixes the time difference start recording and your own code is the `self.captureSession.masterClock!.time`. We look at the buffer relative time until it reaches the time you started recording. If you want to fix the end time as well, just add a variable `recordUntilTime` and check if in the didOutput sampleBuffer method.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-08T17:40:49.133

if i get your question correctly, you want to know the timestamp of when the first frame is recorded. you could try

```
CMTime captureStartTime = nil;

- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection { 

      if !captureStartTime{ 
         captureStartTime = CMSampleBufferGetPresentationTimeStamp(sampleBuffer);
      }
  // do the other things you want
 } 
```

# javascript - IE8+ 中的 TinyMCE 奇怪的显示行为

> ID：13693445
> 
> 赞同：0
> 
> 时间：2012-12-03T23:09:50.433
> 
> 标签：javascript, html, css, internet-explorer, tinymce

TinyMCE 出现的间距远大于应有的间距。

这是我遇到的一个新问题，我已经将 TinyMCE 放在了很多站点中，但从未遇到过这个问题：

![问题图片](../Images/2f7d4fda842a732853ba23fc988f22a7.png)

我曾尝试将 TinyMCE 负载更改为各种负载，甚至直接从他们网站上的 TinyMCE 示例中复制，它做同样的事情。还删除了我的 CSS 表单样式，但没有任何运气。它只是 IE8/9 中的一个问题，但在 Firefox 或 Chrome 中没有。

我的标题如下：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- GET CSS -->
<link href="http://resources.domain.co.nz/styles/reset.css" rel="stylesheet" type="text/css" media="all" /> 
<link href="http://resources.domain.co.nz/styles/administration.css" rel="stylesheet" type="text/css" media="all" /> 
<link href="http://resources.domain.co.nz/styles/webfont.css" rel="stylesheet" type="text/css" media="all" /> 
<!--Get SCRIPTS -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.js"></script>
<script type="text/javascript" src="http://resources.domain.co.nz/scripts/slimScroll.min.js"></script>
<script type="text/javascript" src="http://resources.domain.co.nz/scripts/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
tinyMCE.init({
        // General options
        mode : "textareas",
        theme : "advanced",
        plugins : "pagebreak,style,iespell,inlinepopups,insertdatetime,searchreplace,print,contextmenu,paste,directionality,visualchars,nonbreaking",

        // Theme options
        theme_advanced_buttons1 : "bold,italic,underline,strikethrough,|,sub,sup,|,cut,copy,paste,pastetext,pasteword,|,print",
        theme_advanced_buttons2 : "bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,insertdate,inserttime,|,search,replace,iespell",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : false,
});
</script> 
```

非常感谢任何和所有帮助。

# c - 尝试使用“execvp()”运行“ls | grep r”

> ID：13693446
> 
> 赞同：0
> 
> 时间：2012-12-03T23:09:52.710
> 
> 标签：c

1.  我`pipe`在两个子进程之间创建了一个，首先，我运行`ls`，它写入正确的 fd，然后，我运行`grep r`，它从正确的 fd 中读取，

2.  我可以在终端中看到该`grep`命令工作正常（输出）

3.  问题是它`grep`不会退出，它会留在那里，即使`ls`不再运行

对于其他程序，`pipe`工作正常..

```
for (i = 0; i < commands_num ; i++) {   //exec all the commands instants
    if (pcommands[i]._flag_pipe_out == 1) { //creates pipe if necessary 
        if (pipe(pipe_fd) == -1) {
            perror("Error: \"pipe()\" failed");
        }
        pcommands[i]._fd_out = pipe_fd[1];
        pcommands[i+1]._fd_in = pipe_fd[0]; 
    }
    pid = fork();   //the child exec the commands  
    if (pid == -1) {
        perror("Error: \"fork()\" failed");
        break;          
    } else if (!pid) { //child process

        if (pcommands[i]._flag_pipe_in == 1) {  //if there was a pipe to this command
            if (dup2(pcommands[i]._fd_in, STDIN) == -1) {
                perror("Error: \"dup2()\" failed");
                exit(0);
            }
            close(pcommands[i]._fd_in);
        }

        if (pcommands[i]._flag_pipe_out == 1) { //if there was a pipe from this command
            if (dup2(pcommands[i]._fd_out, STDOUT) == -1) {
                perror("Error: \"dup2()\" failed");
                exit(0);
            }
            close(pcommands[i]._fd_out);
        } 
        execvp(pcommands[i]._commands[0] , pcommands[i]._commands); //run the command

        perror("Error: \"execvp()\" failed");
        exit(0);
    } else if (pid > 0) { //father process
    waitpid(pid, NULL, WUNTRACED);
    }
}
//closing all the open fd's
for (i = 0; i < commands_num ; i++) {
    if (pcommands[i]._fd_in != STDIN) { //if there was an other stdin that is not 0
        close(pcommands[i]._fd_in);
    }           
    if (pcommands[i]._fd_out != STDOUT) { //if there was an other stdout that is not 1
        close(pcommands[i]._fd_out);            
    }   
} 
```

所以，我有一个“命令”瞬间`pcommands[i]` 它有：pipein、pipeout fdin、fdout 的标志和一个 char**（对于真正的命令，如“ls -l”）

可以说一切都很好，这意味着：

```
pcommands[0]:
pipein=0
pipeout=1
char** = {"ls","-l",NULL}

pcommands[1]:
pipein=1
pipeout=0
char** = {"grep","r",NULL} 
```

现在，循环将在第一次执行两次（因为我有两个命令瞬间），它将看到 pcommands[0] has pipeout==1 create pipe do fork pcommands[0] has pipeout==1 child: dup2 to标准输出 execvp

第二次：不创建管道做叉子：pcomands[1] 有 pipein==1 然后：dup2 到输入 exevp ..

这个命令有效，我的输出是：

> errors.log exer2.pdf multipal_try

（所有带有'r'的东西）但是它卡住了，并且没有摆脱`grep`..在我可以看到的另一个终端`grep`中仍在工作

我希望我关闭所有我需要关闭的fd...

我不明白为什么它不起作用，似乎我做得对（好吧，它适用于其他命令..）

有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:18:05.380

您没有关闭足够的管道文件描述符。

### 经验法则：

*   如果您使用`dup()`或`dup2()`将管道文件描述符复制到标准输入或标准输出，您应该关闭*两个*原始管道文件描述符。

您还需要确保如果父 shell 创建管道，它会关闭其管道文件描述符的两个副本。

另请注意，应允许管道中的进程同时运行。特别是，管道的容量有限，当管道中没有剩余空间时，进程会阻塞。限制可能非常小（POSIX 要求它必须至少为 4 KiB，但仅此而已）。如果您的程序处理兆字节的数据，则必须允许它们在管道中同时运行。因此，`waitpid()`应该发生在启动孩子的循环之外。您还需要在等待之前关闭父进程中的管道；否则，读取管道的孩子将永远不会看到 EOF（因为理论上父母可以写入管道，即使它不会）。

您有名称以下划线开头的结构成员。那很危险。以下划线开头的名称保留用于实现。C标准说：

> **ISO/IEC 9899:2011 §7.1.3 保留标识符**
> 
> — 以下划线和大写字母或另一个下划线开头的所有标识符始终保留用于任何用途。
> — 所有以下划线开头的标识符始终保留用作普通和标记名称空间中具有文件范围的标识符。

这意味着，如果你遇到问题，那么问题是你的，而不是系统的。显然，您的代码可以工作，但是您应该意识到可能遇到的问题，并且避免它们是最明智的。

* * *

### 示例代码

这是基于上述代码的固定 SSCCE：

```
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/wait.h>
#include <unistd.h>

typedef struct Command Command;
struct Command
{
    int _fd_out;
    int _fd_in;
    int _flag_pipe_in;
    int _flag_pipe_out;
    char **_commands;
};

typedef int Pipe[2];

enum { STDIN = STDIN_FILENO, STDOUT = STDOUT_FILENO, STDERR = STDERR_FILENO };

int main(void)
{
    char *ls_cmd[] = { "ls", 0 };
    char *grep_cmd[] = { "grep", "r", 0 };
    Command commands[] =
    {
        {
            ._fd_in  = 0, ._flag_pipe_in  = 0,
            ._fd_out = 1, ._flag_pipe_out = 1,
            ._commands = ls_cmd,
        },
        {
            ._fd_in  = 0, ._flag_pipe_in  = 1,
            ._fd_out = 1, ._flag_pipe_out = 0,
            ._commands = grep_cmd,
        }
    };
    int commands_num = sizeof(commands) / sizeof(commands[0]);

    /* Allow valgrind to check memory */
    Command *pcommands = malloc(commands_num * sizeof(Command));
    for (int i = 0; i < commands_num; i++)
        pcommands[i] = commands[i];

    for (int i = 0; i < commands_num; i++) {   //exec all the commands instants
        if (pcommands[i]._flag_pipe_out == 1) { //creates pipe if necessary
            Pipe pipe_fd;
            if (pipe(pipe_fd) == -1) {
                perror("Error: \"pipe()\" failed");
            }
            pcommands[i]._fd_out = pipe_fd[1];
            pcommands[i+1]._fd_in = pipe_fd[0];
        }
        pid_t pid = fork();   //the child exec the commands
        if (pid == -1) {
            perror("Error: \"fork()\" failed");
            break;
        } else if (!pid) { //child process

            if (pcommands[i]._flag_pipe_in == 1) {  //if there was a pipe to this command
                assert(i > 0);
                assert(pcommands[i-1]._flag_pipe_out == 1);
                assert(pcommands[i-1]._fd_out > STDERR);
                if (dup2(pcommands[i]._fd_in, STDIN) == -1) {
                    perror("Error: \"dup2()\" failed");
                    exit(0);
                }
                close(pcommands[i]._fd_in);
                close(pcommands[i-1]._fd_out);
            }

            if (pcommands[i]._flag_pipe_out == 1) { //if there was a pipe from this command
                assert(i < commands_num - 1);
                assert(pcommands[i+1]._flag_pipe_in == 1);
                assert(pcommands[i+1]._fd_in > STDERR);
                if (dup2(pcommands[i]._fd_out, STDOUT) == -1) {
                    perror("Error: \"dup2()\" failed");
                    exit(0);
                }
                close(pcommands[i]._fd_out);
                close(pcommands[i+1]._fd_in);
            }
            execvp(pcommands[i]._commands[0] , pcommands[i]._commands); //run the command

            perror("Error: \"execvp()\" failed");
            exit(1);
        }
        else
            printf("Child PID %d running\n", (int)pid);
    }

    //closing all the open pipe fd's
    for (int i = 0; i < commands_num; i++) {
        if (pcommands[i]._fd_in != STDIN) { //if there was another stdin that is not 0
            close(pcommands[i]._fd_in);
        }
        if (pcommands[i]._fd_out != STDOUT) { //if there was another stdout that is not 1
            close(pcommands[i]._fd_out);
        }
    }

    int status;
    pid_t corpse;
    while ((corpse = waitpid(-1, &status, 0)) > 0)
        printf("Child PID %d died with status 0x%.4X\n", (int)corpse, status);

    free(pcommands);

    return(0);
} 
```

> 就我所知，你会怎么做，所以它不会变得“无可争辩地混乱”？

我可能会保留管道信息，这样孩子就不必担心断言中包含的条件（在管道中访问孩子之前或之后的孩子信息）。如果每个孩子只需要访问自己的数据结构中的信息，那就更干净了。我将重新组织“结构命令”，使其包含两个管道，以及哪个管道包含需要关闭的信息的指示符。在许多方面，与您所拥有的并没有根本不同；那个孩子更整洁，*我*只需要看看`pcommands[i]`。

[您可以在C Minishell 添加管道](https://stackoverflow.com/questions/13636252)的不同上下文中看到部分答案。

# c# - 如何在 Visual Studio 2010 的数据库中包含图像

> ID：13693454
> 
> 赞同：3
> 
> 时间：2012-12-03T23:10:23.070
> 
> 标签：c#, database, image, visual-studio-2010

我对 C# .Net 相当陌生。我们在大学学习它，并且正在使用 Visual Studio 创建 Windows 窗体。作为该主题的新部分，我们正在使用数据库、表格和数据集。

我打开了一个新的 Windows 窗体项目，并立即向其中添加了一个新数据库。我要创建的表将有 2 列 - ImageID 和图像本身。我以什么方式将图像添加到框中？我已经尝试过完整路径、相对路径和拖动图像，但无论我做什么，我都会收到相同的错误消息....

> *无效值
> 此单元格中更改的值未被识别为有效。.Net Framework 数据类型：字节 []
> 错误消息：您不能使用结果窗格将此字段数据设置为 NULL 以外的值
> 键入适合数据类型的值或按 ESC 取消更改*

我怎样才能在里面放图像？我只是不知道如何在表中使用图像数据类型。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:34:37.293

一种更简单的方法是将图像存储在文件系统中，并且仅将其路径存储在数据库中。基本上你定义一个基本文件夹：

```
string baseFolder = "c:\Program Files\MyApp\Images"; 
```

并用它来存储数据库中的相对路径：

```
INSERT INTO ImagesTable (Name, Path)
Values ('German Shepherd', 'Dogs\german-shepherd.jpg') 
```

然后，当您需要检索图像时，您可以这样做：

```
string path = Path.Combine(baseFolder, 'Dogs\german-shepherd.jpg');
Image img = Image.FromFile(path); 
```

在以下 SO 问题中，您可以找到有关此方法优缺点的更多信息：

*   [我应该将图像存储在数据库还是文件夹中？](https://stackoverflow.com/questions/713243/should-i-store-my-images-in-the-database-or-folders)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T01:19:17.243

您可以将图像存储在 sql server 2008 中。只需创建具有列数据类型“图像”的数据库表。现在从.net代码中使用文件上传控件选择图像文件，然后将图像参数转换为字节[]，然后将图像数据插入数据库。

# ruby-on-rails-3 - Capybara 2.0 / Cucumber 中的存根 request.host

> ID：13693462
> 
> 赞同：1
> 
> 时间：2012-12-03T23:11:11.437
> 
> 标签：ruby-on-rails-3, cucumber, capybara

我的应用程序需要对某些 ​​request.host 值采取不同的行动。我用 Cucumber 测试了这种行为。在 Capybara 2.0 之前，我可以通过执行以下 Cucumber 步骤来模拟正确的 request.host 值：

```
Given /^the url starts with "([^"]*)"$/ do |url|
  Capybara.app_host = "http://#{url}"
end 
```

但是现在使用 Capybara 2.0.1，我的浏览器实际上导航到设置的 URL，而不是停留在我的测试服务器上并假装来自该 URL。

所以我的问题是：如何在 Capybara 2.0 中正确地“存根 request.host”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-29T13:53:50.783

我设法通过存根`request.host`而不是设置这些来度过难关：

```
default_url_options[:host] = host
Capybara.app_host = "http://" + host 
```

希望有帮助。

# c# - $.ajax() POST 命令未连接到 WCF 服务

> ID：13693463
> 
> 赞同：1
> 
> 时间：2012-12-03T23:11:11.637
> 
> 标签：c#, jquery, ajax, wcf, rest

我可以使用简单的 POST 表单连接到服务，但 $.ajax 方法不起作用，并且出现错误：“无传输”

接口/合约：

```
[ServiceContract]
public interface IService1
{

    [OperationContract]
    Msg updateMessageJSON(Msg message);
} 
```

数据合同和数据成员：

```
[DataContract]
public class Msg{
    [DataMember]
    public string GUID;

    [DataMember]
    public string message;
} 
```

服务等级：

```
public class Service1 : IService1
 [WebInvoke(
    Method = "POST",
    ResponseFormat = WebMessageFormat.Json,
    RequestFormat = WebMessageFormat.Json,
    BodyStyle = WebMessageBodyStyle.Bare,
    UriTemplate = "updateMessageJSON"
    )]
    public Msg updateMessageJSON(Msg message)
    {
        using (masterEntities1 entx = new masterEntities1())
        {
            entx.AddToErrorMessageDatas(
                    new ErrorMessageData() { messageData = message.message }
                );
            entx.SaveChanges();
        }

        message.GUID = Guid.NewGuid().ToString();
        return message;
    } 
```

配置文件：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="JSONServiceTest.Service1">
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8733/Design_Time_Addresses/JSONServiceTest/Service1/" />
          </baseAddresses>
        </host>
        <endpoint address="" binding="basicHttpBinding" contract="JSONServiceTest.IService1">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="json" binding="webHttpBinding" contract="JSONServiceTest.IService1" behaviorConfiguration="jsonBehavior"></endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="True" httpsGetEnabled="True" />
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="jsonBehavior">
          <webHttp />
        </behavior>
      </endpointBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

jQuery：

```
function exec() {
        $.ajax({
            url: "http://localhost:8733/Design_Time_Addresses/JSONServiceTest/Service1/json/updateMessageJSON",
            type: 'POST',
            data: "{ 'message':'get the new guid','GUID':''}",
            contentType: "application/json; charset=utf-8",
            success: function (msg) {
                alert(msg);
            },

            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError.responseText);
            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:40:20.933

这可能是因为您正在执行跨站点脚本，假设这`http://localhost:8733`也不是您页面的地址（端口有所不同）。

请改用 JSONP。你的回复应该是这样的：

```
myCallback(['your data structure here']) 
```

`myCallback()`JavaScript 中的有效函数在哪里。`$.ajax`调用也需要这个：

```
dataType: 'jsonp' 
```

另请参阅：[远程 JSON](http://bob.ippoli.to/archives/2005/12/05/remote-json-jsonp/)

# c# - OpenFileDialog 用 exe 打开文件夹

> ID：13693465
> 
> 赞同：-1
> 
> 时间：2012-12-03T23:11:15.360
> 
> 标签：c#, openfiledialog

如何使用 OpenFileDialog 及时打开应用程序的文件夹？

```
 OpenFileDialog openFileDialog1 = new OpenFileDialog();
        openFileDialog1.Filter = "txt files (*.txt)|*.txt|All files (*.*)|*.*";
        if (openFileDialog1.ShowDialog() == DialogResult.OK)
        {
           ...........

        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T23:27:42.963

猜测您的意思是“从我的应用程序文件夹开始显示 OpenFileDialog”，只需`OpenFileDialog.InitialDir`在显示`OpenFileDialog`.

```
string AppPath = Path.GetDirectoryName(Application.ExecutablePath);;
openFileDialog1.InitialDir = AppPath; 
```

如果您在查找应用程序目录时需要帮助，请参阅[获取应用程序的根文件夹](https://stackoverflow.com/q/5908343/62576)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:26:49.827

如果您希望覆盖设置其值的默认方式之一（在 MSDN 上描述），请使用[FileDialog.InitialDirectory 属性。](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.initialdirectory.aspx)

```
openFileDialog1.InitialDirectory = @"C:\";  // based on comment of question 
```

# asp.net-mvc - MVC4 未绑定基本类型列表

> ID：13693467
> 
> 赞同：2
> 
> 时间：2012-12-03T23:11:22.140
> 
> 标签：asp.net-mvc, jquery, asp.net-web-api, model-binding

在我的一生中，我无法让这些数据绑定。这是我的 JavaScript：

```
var params = { 'InvItemIDs': ["188475", "188490"]};
$.post("api/Orders/OrderFromInventory?" + $.param(params)) 
```

和控制器动作：

```
public HttpResponseMessage OrderFromInventory(IList<int> InvItemIDs)
{
    return new HttpResponseMessage();
} 
```

我已经构建了查询字符串，以便它发送：

```
?InvItemIDs=188475&InvItemIDs=188490 
```

也

```
?InvItemIDs[]=188475&InvItemIDs[]=188490 
```

乃至

```
?InvItemIDs[0]=188475&InvItemIDs[1]=188490 
```

它们都没有约束力。`InvItemIDs`总是`null`。我究竟做错了什么？

编辑：

所以事实证明，这一切都是 MVC4 中新的 Web API 控制器代码中的一个错误（或什么）。一旦我将完全相同的代码移到标准控制器上，它就开始工作了。

如果有人对 Web API 为什么会破坏此绑定有任何见解，我仍然很感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:27:36.490

它不起作用的原因是因为您使用的是 [HttpPost] ，它期望将数据发布在“post body”而不是 URL 中。

你可以

```
1, remove httpPost
2\. put the list in the post content 
```

您需要设置“traditional：true”才能使数组正常工作。这是我在本地项目中测试过的示例代码，试一试

```
var InvItemIDs = ["188475", "188490"];
$.ajax({ type: "POST",
    url: "Home/TestIndex",
    datatype: "json",
    traditional: true,
    data:
    {
        'InvItemIDs': InvItemIDs
    }              
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:56:21.053

这篇[Haacked 博客文章](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)可能会有所帮助。具体来说，看看他的第一个例子，如果你改为 会发生`IList`什么`ICollection`？

像这样的“应该”工作

```
[HttpGet]
public HttpResponseMessage OrderFromInventory(IList<int> InvItemIDs)
{
    return new HttpResponseMessage();
} 
```

使用查询字符串

```
?InvItemIDs=188475&InvItemIDs=188490 
```

# c# - 当作为 COM 对象访问时，SslStream 的响应不同

> ID：13693469
> 
> 赞同：0
> 
> 时间：2012-12-03T23:11:24.480
> 
> 标签：c#, c++, com, sslstream

我正在处理一个大部分代码是 C++ 的项目。从长远来看，这家商店正在迁移到 C#，因此我们尽可能用 C# 编写新代码并通过 COM 向 C++ 公开。

我在一个 COM 对象中包装了一个 System.Net.Sockets.SslStream 和一些其他功能，用于发送和接收消息。从测试 C# 程序调用此类上的函数时，我能够毫无问题地发送和接收消息。通过 COM 公开的相同调用似乎也可以正常工作，只是在发送后我无法立即接收数据。

从 C# 测试数据发送和接收的速度非常快，我得到了我应该得到的响应。从 C++ 开始，我总是遇到超时错误。调用 Read 的函数中的数据在 C# 测试和 C++ 程序中是相同的。SslStream 中的大部分状态是相同的。就在 write 调用之后和 Read 之前，唯一的区别似乎是几个句柄和似乎是内存地址的东西，但我认为这些并不重要。与此同时，我注意到在一个名为“base”的项目中，然后在一个名为“InnerStream”的项目中，然后在“System.Net.Sockets.NetworkStream”中有一个名为“DataAvailable”的属性。这在 C# 测试中有效，而在 C++ 程序中失败。

我可以提供有关故障排除或代码片段的更多详细信息。我没有在这里包含代码，因为与问题相关的部分仍然是巨大的。我希望对于正在发生的事情有某种神奇的答案，但是几乎可以肯定该错误是深入且非常具体的。我将不胜感激任何提供有关进一步故障排除步骤的见解的东西。

通过 COM 调用 C# 会带来哪些我可能没有考虑到的复杂情况？

如果没有进入 SslStream 缓冲区，对方的消息去了哪里？

我应该在哪里寻找？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T15:49:11.170

我找到了答案，它与 COM、C#、C++ 无关，而是与相关系统之间发送的消息的格式有关。另一个系统使用额外的回车来指示消息的结束。当缺少远程系统时，会停止响应，直到另一个 SSL 会话启动。

在项目的前一点，我在发送到服务器的消息末尾添加了一个额外的换行符。我复制了其中一条消息来生成我的完全 c# 测试。有几次，我还将两个代码库发送的消息放入合并/差异查看器中。我从未注意到这种差异，因为我禁用了空白匹配。

从现在开始，当我将原始输出与其他原始输出进行比较时，我将确保我的任何工具都不会对我隐藏差异。

# django - Fabric:Python as ???:Javascript

> ID：13693479
> 
> 赞同：2
> 
> 时间：2012-12-03T23:12:18.147
> 
> 标签：django, node.js, heroku, fabric

我一直在使用[Fabric](https://github.com/fabric/fabric)为 Django 应用程序进行部署。我现在正在使用一些 node.js 的东西，我想看看是否有一个工具可以做 Fabric 为 python 所做的事情——但这主要是为 javascript 和 node 构建的。

我的主要用例是将所有内容保存到 git 并通过键入`fab deploy`- 但对于 node.js 部署到 heroku。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T12:42:21.913

尝试[NodeJS](https://github.com/VanCoding/NodeSSH/blob/master/examples/sample.js)或[node-control](https://github.com/tsmith/node-control)。两者都是 node.js ssh 客户端。

# php - 通过 PHP 从目录中的文件生成 XML

> ID：13693480
> 
> 赞同：3
> 
> 时间：2012-12-03T23:12:19.880
> 
> 标签：php, xml, directory

我有两个文件夹图像和带有照片的大图像。

我想生成一个具有两个属性的 XML 文件，如下所示：

```
<images>
    <image source="images/image1" lightbox="bigimages/image1" />
    .....
</images> 
```

我有这样的事情：

```
<?php

    // enter the path to the folder
    $path = "images/";

    // opendir
    $dir_handle = @opendir($path) or die("Unable to open $path");

    // table photos
    $filetypes = array("jpg", "png");

    // forming xml
    $doc = new DomDocument('1.0');

    $doc->formatOutput = true;

    // forming images

    $root = $doc->createElement('images');
    $root = $doc->appendChild($root);

    while ($file = readdir($dir_handle)) {

        $file = rawurlencode($file);

        $split = explode(".", $file);
        $ext = strtolower($split[count($split)-1]);

        if (in_array($ext, $filetypes)) {

            // additional image
            $item = $doc->createElement("image");
            $item = $root->appendChild($item);

            $file = $path.$file;

            // adding an attribute source
            $item->setAttribute('source', $file);

        }

    }

    // closure
    closedir($dir_handle);

    // Save to XML
    $doc->save("plik.xml");
    echo "plik xml wygenerowany poprawnie!!!";
?> 
```

现在的问题是如何在“bigimages”目录中添加第二个带有图像路径的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:17:56.887

这应该这样做：

```
$big_image = 'bigimages/' . basename($file);

if (file_exists($big_image)) {
    $item->setAttribute('source', $big_image);
} 
```

参见：[basename()](http://www.php.net/basename)

# css - 有没有办法在 HTML5 数据列表选项上应用 CSS 样式？

> ID：13693482
> 
> 赞同：107
> 
> 时间：2012-12-03T23:12:28.903
> 
> 标签：css, html, option, html-datalist

我想修改我的数据列表的不同选项列表的显示方式。是否可以在其上应用一些 CSS 属性？

```
<input list="languages" id="language_id">
<datalist id="languages">
      <option value="html">HTML</option>
      <option value="java">Java</option>
      <option value="perl">Perl</option>
      <option value="php">PHP</option>
      <option value="ruby-on-rails">Ruby on Rails</option>
</datalist> 
```

我试过

```
option {
    background: red;
} 
```

但它似乎不起作用。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-12-03T23:48:07.207

与*select*元素一样，*datalist*元素在样式方面几乎没有灵活性。如果这是您的问题，则您无法设置任何建议术语的样式。

浏览器为这些元素定义自己的样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-03-06T19:41:53.327

您可以使用 Jquery 创建替代 Datalist

```
$(document).on('dblclick', 'input[list]', function(event){
    event.preventDefault();
        var str = $(this).val();
    $('div[list='+$(this).attr('list')+'] span').each(function(k, obj){
            if($(this).html().toLowerCase().indexOf(str.toLowerCase()) < 0){
                $(this).hide();
            }
        })
    $('div[list='+$(this).attr('list')+']').toggle(100);
    $(this).focus();
})

$(document).on('blur', 'input[list]', function(event){
        event.preventDefault();
        var list = $(this).attr('list');
        setTimeout(function(){
            $('div[list='+list+']').hide(100);
        }, 100);
    })

    $(document).on('click', 'div[list] span', function(event){
        event.preventDefault();
        var list = $(this).parent().attr('list');
        var item = $(this).html();
        $('input[list='+list+']').val(item);
        $('div[list='+list+']').hide(100);
    })

$(document).on('keyup', 'input[list]', function(event){
        event.preventDefault();
        var list = $(this).attr('list');
    var divList =  $('div[list='+$(this).attr('list')+']');
    if(event.which == 27){ // esc
        $(divList).hide(200);
        $(this).focus();
    }
    else if(event.which == 13){ // enter
        if($('div[list='+list+'] span:visible').length == 1){
            var str = $('div[list='+list+'] span:visible').html();
            $('input[list='+list+']').val(str);
            $('div[list='+list+']').hide(100);
        }
    }
    else if(event.which == 9){ // tab
        $('div[list]').hide();
    }
    else {
        $('div[list='+list+']').show(100);
        var str  = $(this).val();
        $('div[list='+$(this).attr('list')+'] span').each(function(){
          if($(this).html().toLowerCase().indexOf(str.toLowerCase()) < 0){
            $(this).hide(200);
          }
          else {
            $(this).show(200);
          }
        })
      }
    })
```

```
* {
  scrollbar-width: thin;
    scrollbar-color: #BBB #EEE;
}

*::-webkit-scrollbar {
  width: 10px;
}

*::-webkit-scrollbar-track {
  background: #C0C3C6;
}

*::-webkit-scrollbar-thumb {
  background-color: #888;
  border-radius: 10px;
  border: 3px solid #C0C3C6;
}

table {
    width: 400px;
    margin: 0 auto;
    background: #EEE;
    font-family: Arial;
    padding: 10px 30px;
  border-radius: 5px;
  box-shadow: 0 5px 5px -5px #000;
    --border: 1px solid #ABC;
}
table td {
  padding-bottom: 10px;
}
table h4 {
  text-align: center;
  color: #567;
  border: 1px solid #567;
  border-radius: 3px;
  padding: 15px 0;
}
input {
    padding: 10px;
    font-size: 1em;
    width: calc(100% - 20px);
    border: var(--border);
    border-radius: 3px;
}
input[list]:focus {
    outline: none;
}
input[list] + div[list] {
    display: none;
    position: absolute;
    width: 100%;
    max-height: 164px;
    overflow-y: auto;
    max-width: 330px;
    background: #FFF;
    border: var(--border);
    border-top: none;
  border-radius: 0 0 5px 5px;
  box-shadow: 0 3px 3px -3px #333;
    z-index: 100;
}
input[list] + div[list] span {
    display: block;
    padding: 7px 5px 7px 20px;
    color: #069;
    text-decoration: none;
    cursor: pointer;
}
input[list] + div[list] span:not(:last-child) {
  border-bottom: 1px solid #EEE;
}
input[list] + div[list] span:hover {
    background: rgba(100, 120, 140, .2);
}

table .instructions {
  font-size: .9em;
  color: #900;
}
table .instructions b {
  color: #123;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<table width="400">
    <tr>
        <td> <h4>DATALIST STYLING ALTERNATIVE</h4> </td>
    </tr>
    <tr>
        <td>
            <div>Programming languages</div>
            <input type="text" name="language" list="list-language">
            <div list="list-language">
                <span>CSharp</span>
                <span>Delphi</span>
                <span>Flutter</span>
                <span>Java</span>
                <span>Java Script</span>
                <span>PHP</span>
                <span>Python</span>
                <span>Ruby</span>
                <span>SAP</span>
                <span>Visual Basic</span>
            </div>
        </td>
    </tr>
    <tr>
        <td>
            <div>Cities</div>
            <input type="text" name="cities" list="list-cities">
            <div list="list-cities">
                <span>Athens</span>
                <span>Beijing</span>
                <span>Berlin</span>
                <span>Cairo</span>
                <span>Lisbon</span>
        <span>London</span>
        <span>Mexico City</span>
                <span>Moscow</span>
                <span>New York</span>
                <span>Rio de Janeiro</span>
                <span>Rome</span>
                <span>Tokyo</span>
            </div>
        </td>
    </tr>
  <tr>
    <td>
      <div class='instructions'>
        <b>INSTRUCTIONS:</b><hr>
        <p><b>Double click on the input:</b><br>Show/hide the datalist.</p>
        <p><b>Press esc on the input:</b><br>Hides datalist if visible.</p>
        <p><b>Onkeypress in the input:</b><br>Displays the datalist filtering according to the entered string.</p>
        <p><b>On pressing enter:</b><br>Ff there is only 1 element in the datalist, this value will be loaded into the input.</p>
      </div>
    <td>
  </tr>
</table>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-10T07:32:11.073

编辑：
查看其他几个库后，我发现[react-datalist-input](https://github.com/andrelandgraf/react-datalist-input)提供了与数据列表交互的最简单方法，包括反应、样式和功能。

您可以通过以下方式访问样式

```
.datalist-input 
```

下面是一个简单的代码片段：

```
const DataListWrapper = styled.div`
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 6px;

    .datalist-input {
        width: 50%;
        color: black;
    }
`;

const SomeComponent = () => {
    return (
        <DataListWrapper>
            <ReactDataList
                forcePoly
                placeholder="Search Something..."
                list="my_list"
                options={options}
                onOptionSelected={(e) => foo(e)}
            />
        </DataListWrapper>
    );
}; 
```

旧答案：（
注意：`react-datalist`没有被维护，它的一些依赖项已被弃用）

使用 react 时，您可以使用以下方式设置选项和数据列表本身的样式

```
react-datalist 
```

[https://www.npmjs.com/package/react-datalist](https://www.npmjs.com/package/react-datalist)

您可以使用 CSS 或 styled-components 访问这些

```
.react-datalist  
.react-datalist-option 
```

这是一个使用样式组件的简单代码片段：

```
 const DataListWrapper = styled.div`
          display: flex;
          justify-content: center;
          align-items: center;
          margin-top: 6px;

          .datalist-input {
              width: 50%;
              color: black;
          }
    `;

    const SomeComponent = () => {
        return (
            <>
                <DataListWrapper>
                    <DataListInput
                        placeholder="Search Something..."
                        items={items}
                        onSelect={DoSomething}
                    />
                </DataListWrapper>
            </>
        );
    }; 
```

* * *

## 回答 #4

> 赞同：-11
> 
> 时间：2014-05-09T03:42:32.527

尝试：

```
input[list]
{
  background: red;
} 
```

# android-layout - 使用媒体查询的设备布局 - 手机上的纵向，平板电脑上

> ID：13693487
> 
> 赞同：1
> 
> 时间：2012-12-03T23:12:50.593
> 
> 标签：android-layout, css, cordova, jquery-mobile

我有一个使用 jQuery Mobile 和 PhoneGap 创建的 Android 移动应用程序。我想根据设备和方向有 3 个单独的布局：

1.  纵向手机 - 在智能手机上我想始终使用纵向布局
2.  肖像平板电脑 - 与手机不同
3.  风景平板电脑

这可以通过 CSS 媒体查询来实现吗？我知道改变布局是可能的，但不知道如何只为智能手机强制纵向布局，同时允许平板电脑横向布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T13:42:07.563

大多数设备将采用以下 3 种分辨率
1) HVGA-VGA 的一半 (320 x 240)
2) WVGA-wide VGA(800x 480) - 几乎是 HVGA 的 1.5 倍
3) HVGA 2x- (640 x 960) - IPHONE 4 使用此分辨率

根据您的要求
1）和 2）您可以在 @media 中编写您的样式，如下所示。您可以使用 HVGA 或 WVGA。根据需要更改宽度和高度

```
@Media screen and (min-width: 320px) and (max-width: 480px){
/* css files here*/
} 
```

3）对于横向视图，请使用orientation:landscape，如下例所示

```
@media only screen and (-webkit-min-device-pixel-ratio: 2) and (orientation:landscape){
/* css files here */
} 
```

代码片段仅供您参考。您的需求可能不同，请根据您的需要更改屏幕/仅、最小设备像素比、最大设备像素比等参数

# java - Spring中如何使用WebLogic提供的JNDI DataSource？

> ID：13693488
> 
> 赞同：5
> 
> 时间：2012-12-03T23:13:00.193
> 
> 标签：java, spring, weblogic, datasource, jndi

Spring javadoc中关于DriverManagerDataSource类的文章中说，这个类很简单，推荐

使用容器提供的 JNDI 数据源。这样的 DataSource 可以通过 JndiObjectFactoryBean 暴露为 Spring ApplicationContext 中的 DataSource bean

问题是：如何做到这一点？

例如，如果我希望 DataSource bean 访问我的 custo oracle 数据库，那么我需要什么？在上下文配置等中写什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:29:27.650

要访问 JNDI 数据源，您可以执行以下操作：

```
<bean id="dbDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="jdbc/MyDatabase"/>
</bean> 
```

或者看看春天的'jee'模式。

数据库连接的细节在WebLogic中配置，应用程序通过jndi名称访问数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-11T17:13:08.753

或者使用基于 Java 的配置并这样做：

```
@Bean(destroyMethod = "")
public DataSource dataSource() throws NamingException{
    Context context = new InitialContext();
    return (DataSource)context.lookup("jdbc.mydatasource");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-07T19:05:15.557

还有另一种选择：

```
<jee:jndi-lookup id="dbDataSource" jndi-name="jdbc/MyLocalDB"
        expected-type="javax.sql.DataSource" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-24T12:58:21.657

您可以使用以下 jndi 配置。

```
<beans:bean id="weblogicDataSource" class="org.springframework.remoting.rmi.JndiRmiProxyFactoryBean">
    <beans:property name="jndiName" value="ConnectionPoolJNDINameAsConfigured"></beans:property>
    <beans:property name="jndiEnvironment">
        <beans:props>
            <beans:prop key="java.naming.factory.initial">weblogic.jndi.WLInitialContextFactory</beans:prop>
            <beans:prop key="java.naming.provider.url">iiop://localhost:7001</beans:prop>
        </beans:props>
    </beans:property>
    <beans:property name="serviceInterface" value="javax.sql.DataSource"></beans:property>
</beans:bean> 
```

并且您将注入的类文件引用为

```
<beans:bean id="xxxx" class="xxxxxxxx">
    <beans:property name="wlDataSource"  ref="weblogicDataSource" />
</beans:bean> 
```

在你的实现类中，使用

```
import javax.sql.DataSource; 
```

将实例作为私有 DataSource wlDataSource；

和相应的二传手。现在您可以根据自己的实现思路自由使用 JDBCTemplate 或 SimpleJDBCCall 等。

*   希望这会有所帮助。

# windows - VBS 或 Bat - 确定操作系统和 Office 版本

> ID：13693490
> 
> 赞同：2
> 
> 时间：2012-12-03T23:13:12.850
> 
> 标签：windows, batch-file, vbscript, ms-office

有没有人可以在同一脚本中确定 Windows 操作系统和 Office 版本的脚本。

我有脚本的零碎部分，但我似乎无法弄清楚如何在脚本中合并 OS 和 Office 版本。我从蝙蝠开始，现在我转向 VBS，因为它似乎能够提供更多详细信息，但是，如果有人能在下面的逻辑方面提供帮助，我可能会继续前进。

我想知道如何设置这样的脚本。

```
If Windows 7 64bit & Office 2010
    do this
If Windows XP 32bit & Office 2007
    do this  
If Windows 7 & Office 2007
    do this 
```

检测 Windows 版本的代码 -- BAT 脚本

```
Echo Please wait.... detecting Windows OS version...
ver | find "2003" > nul
if %ERRORLEVEL% == 0 goto done

ver | find "XP" > nul
if %ERRORLEVEL% == 0 goto ver_xp

ver | find "2000" > nul
if %ERRORLEVEL% == 0 goto done

ver | find "NT" > nul
if %ERRORLEVEL% == 0 goto done

if not exist %SystemRoot%\system32\systeminfo.exe goto warnthenexit

systeminfo | find "OS Name" > %TEMP%\osname.txt
FOR /F "usebackq delims=: tokens=2" %%i IN (%TEMP%\osname.txt) DO set vers=%%i

echo %vers% | find "Windows 7" > nul
if %ERRORLEVEL% == 0 goto ver_7

echo %vers% | find "Windows Server 2008" > nul
if %ERRORLEVEL% == 0 goto done

echo %vers% | find "Windows Vista" > nul
if %ERRORLEVEL% == 0 goto ver_7

goto warnthenexit 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T18:24:39.690

尽管 Office 部分有点慢，但它确实有效。

只需将其包含在名称为**getversions.vbs的文件中即可**

在我的电脑上，它打印：

**微软视窗 8 企业版**

**Microsoft Office 32 位组件 2013，版本 15**

```
 strComputer = "."
    Set objWMIService = GetObject("winmgmts:" _
        & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

    Set colOperatingSystems = objWMIService.ExecQuery _
        ("Select * from Win32_OperatingSystem")

    For Each objOperatingSystem in colOperatingSystems
        Wscript.Echo objOperatingSystem.Caption
    Next

    Set colSoft = objWMIService.ExecQuery("SELECT * FROM Win32_Product WHERE Name Like 'Microsoft Office%'")

    If colSoft.Count = 0 Then
      wscript.echo "NO OFFFICE INSTALLED" 
    else
       For Each objItem In colSoft
          Wscript.echo objitem.caption & ", Version" & Left(objItem.Version, InStr(1,objItem.Version,".")-1)
          exit for
       Next
    End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-19T14:36:14.247

将此（VB 脚本）文件另存为 GetVersions.vbs。它有效 问候，肖恩

```
Option Explicit ' Enforce variable declaration
    ' Declare objects
Dim oShell
Dim sOSVersion
Dim lOfficeVersion

Set oShell = CreateObject("WScript.Shell")

On Error Resume Next
sOSVersion = oShell.RegRead("HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName")' Read the registry for the operating system version

lOfficeVersion = GetOfficeVersionNumber() ' Read the office version from the function

MsgBox "sOSVersion = " & sOSVersion & vbCrLf & "lOfficeVersion = " & lOfficeVersion

    Function GetOfficeVersionNumber()
        GetOfficeVersionNumber = ""  ' or you could use "Office not installed"
        Dim sTempValue
                    ' Read the Classes Root registry hive (it is a memory-only instance amalgamation of HKCU\Software\Classes and HKLM\Software\Classes registry keys) as it contains a source of information for the currently active Microsoft Office Excel application major version - it's quicker and easier to read the registry than the file version information after a location lookup). The trailing backslash on the line denotes that the @ or default registry key value is being queried.
        sTempValue = oShell.RegRead("HKCR\Excel.Application\CurVer\")
        If Len(sTempValue) > 2 Then GetOfficeVersionNumber = Replace(Right(sTempValue, 2), ".", "") ' Check the length of the value found and if greater than 2 digits then read the last two digits for the major Office version value
    End Function    ' GetOfficeVersionNumber 
```

# php - 在数据库中创建另一个表或使用 xml？

> ID：13693493
> 
> 赞同：-1
> 
> 时间：2012-12-03T23:13:21.307
> 
> 标签：php, xml, database

我正在开发一个数据库驱动的 Web 应用程序。但我现在进退两难了。我的数据由名称和他们的密码组成。代码是数据库表字段名称。我需要显示相应代码的名称。相同的名称可能包含不同的代码。

我应该创建另一个数据库表还是使用 xml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:20:13.980

这肯定取决于您必须处理多少条目以及数据更改的频率。交换 xml 文件或更新数据库更容易吗？

但就好像数据库已经存在一样，我建议使用它。如果使用数据库，您不必处理持久性和此类事情。

但无论如何，使用什么是无休止的冲突。两种方式都有效。两者都有优点和缺点。

# javascript - 代码在 js fiddle 中有效，但在 Dreamweaver 或服务器上无效

> ID：13693494
> 
> 赞同：0
> 
> 时间：2012-12-03T23:13:29.470
> 
> 标签：javascript, jquery, hover, jsfiddle, spritely

[http://jsfiddle.net/reveries/9Dt7n/](http://jsfiddle.net/reveries/9Dt7n/) http://www.reveriesrefined.com/test/

当您将鼠标悬停在门上时，它应该动画......并且在 jsfiddle 中它工作得很好，但是一旦我将此代码放在我的网站上，它就会停止工作。您仍然会看到图像，但是当您将鼠标悬停在它上面时，没有动画。我想知道js fiddle是否有一些我不包括的隐藏代码？

jQuery (w/srpitely)

```
var iFrames = 23,
iFps = 24,
bRewind = false,
iStartFrame = -1,
bAnimating = false,
stopAndRewind = function(oAnim) {
    iStartFrame = ~iStartFrame ? -1 : iFrames - 2;
    bRewind = !bRewind;
    bAnimating = false;
    oAnim.spStop();
};
$("#door").on("mouseenter mouseleave", function() {
var iCurFrame = iStartFrame;
if ($._spritely.instances && $._spritely.instances[$(this).prop("id")])
{
    if (bAnimating)
    {
        iCurFrame = $(this).spGet("current_frame");
        stopAndRewind($(this));
    }
    $(this).destroy();
}
bAnimating = true;
$(this).sprite({
    fps: iFps,
    no_of_frames: iFrames,
    start_at_frame: iCurFrame,
    rewind: bRewind,
    on_frame: (function() {
        var o = {},
            i = 1;
        if (!bRewind)
        {
            i = iFrames - 2;
        }
        o[i] = stopAndRewind;
        return o;
    })()
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:17:01.710

**完全改变答案**：

在您的网站上，您的文件中有无效字符`/test/javascript/open_close.js`。因此，该文件中的任何内容都不会起作用，因为解析器会阻塞它们。

文件的结尾是：

```
});â€‹

}); 
```

注意无效字符。

如果您从 jsFiddle 复制并粘贴，那可能就是它们的来源。jsFiddle 的编辑器字段中有这些奇怪的字符，我不知道为什么。过去我曾多次注意到它。

* * *

**实际查看网站之前的原始答案（错过了链接）**：

您已将 jsFiddle 设置为将您的代码包含在`onload`处理程序中，因此它发生在页面加载周期的后期，一旦所有 DOM 元素都存在（并且图像已下载等）。（这是 jsFiddle 的默认设置，我不能告诉你为什么，你不是第一个与它发生冲突的人。）如果你自己的页面有脚本只是内联，特别是如果`script`标签在它使用的元素之上， 那就是问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:22:29.510

我不确定这是否*是*问题所在，但 Firefox 的错误控制台报告您在`open_close.js`.

# php - 如何将可编辑文本块添加到 wordpress 主页？

> ID：13693496
> 
> 赞同：2
> 
> 时间：2012-12-03T23:13:46.987
> 
> 标签：php, wordpress

这里有点 wordpress 业余爱好者。

我正在创建一个主题。在主页上将有 2 个部分...

1.  最新帖子摘录（我知道该怎么做！）

2.  “关于我们”部分 - 我希望客户能够在管理部分编辑的文本段落，而不是硬编码。如何为此创建代码？

我正在考虑在管理员中创建一个页面，然后在主页上使用 PHP 包含来显示该页面，但我认为这不是最好的方法。

任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:17:34.413

又快又脏。。

```
<?php
$content = get_posts(array('post_type'=>'page'));
foreach ($content as $post):
    if ($post->ID == 6) {
        setup_postdata($post);
        the_content();
    }
endforeach;
?> 
```

替换`6`为“关于”页面的 ID。这不是一个优雅的解决方案，但它会完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T11:08:42.920

在这里，您使用了 Wordpress Advance 自定义字段插件中最好的插件：

[http://wordpress.org/extend/plugins/advanced-custom-fields/screenshots/](http://wordpress.org/extend/plugins/advanced-custom-fields/screenshots/)

安装在您的 Wordpress 站点中。

为特定页面创建一个组。

在这里，您可以从管理员端为特定页面（如主页、关于我们页面等）创建特定块。

和

在主页中获取此值并显示它。

注意：请阅读说明并查看此插件的屏幕截图

# c# - SQL 左外连接、groupby 和 orderby 到 LINQ 方法查询或方法语法

> ID：13693498
> 
> 赞同：0
> 
> 时间：2012-12-03T23:13:56.040
> 
> 标签：c#, sql, linq, entity-framework, join

主要目标是根据受欢迎程度（根据有多少人最喜欢的特定成分表示）以排序顺序返回成分列表。SQL 等价物如下：

```
select distinct COUNT(PersonalInfoes.FavoriteIngredient_ID) as NoUsing, 
Ingredients.Name 
from PersonalInfoes  right join Ingredients
on PersonalInfoes.FavoriteIngredient_ID = Ingredients.ID
group by Ingredients.Name
order by NoUsing desc 
```

产生与上述相同结果的方法语法的等效 SQL 查询是什么？我得到的最接近的是：

```
from i in db.Ingredients 
join p in db.PersonalInfos on i.ID equals p.FavoriteIngredient.ID into ing
from p in ing.DefaultIfEmpty()
group i by i.Name into g
from p in g
orderby g.Count() descending
select new { Name = g.Key, Count = g.Count() }.Name; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T01:52:48.090

您的查询执行左外连接以包含没有收藏夹的成分。问题是，对于没有收藏夹的每种成分，您都在计算 DefaultIfEmpty() 生成的单个值。您可以在计算时排除默认值，如下所示：

`orderby g.Count(x => x != null) descending`

您实际上不必执行左连接。您可以将组加入的组数相加：

```
from i in db.Ingredients 
join p in db.PersonalInfos on i.ID equals p.FavoriteIngredient.ID into faves
group faves.Count() by i.Name into faveCounts
let count = faveCounts.Sum()
orderby count descending
select new { Name = faveCounts.Key, Count = count }; 
```

您的代码的一个主观问题是它与所有`group by`and`from`子句都非常混乱。如果您发现这是一个问题，您可以尝试使用更具描述性的名称、使用子查询或使用方法语法。

**编辑：**这是一个方法语法版本。它不是从查询语法版本的直接转换，因为那会非常难看。

```
db.Ingredients
  .GroupJoin(db.PersonalInfos,
             i => i.ID,
             p => p.ID, 
             (i, g) => new { i.Name, FaveCount = g.Count() })
  .GroupBy(x => x.Name,
           (key, grp) => new { Name = key, Count = grp.Sum(y => y.FaveCount) })
  .OrderByDescending(x => x.Count); 
```

# c++ - C++绘制矩形位置

> ID：13693501
> 
> 赞同：1
> 
> 时间：2012-12-03T23:14:01.880
> 
> 标签：c++, position, draw

我有我的课：

```
class Rectangle : public TwoDim
{
public:
    void fun() {};
    void printShape();
    Rectangle(int x1, int y1, int height1, int width1)
    {
        x = x1;
        y = y1;
        height = height1;
        width = width1;

    }

}; 
```

以及打印它的功能：

```
void Rectangle::printShape()
{
    {

        cout << "+";
        for (int i = 0; i <  width - 2; i++)
        {
            cout << "-";
        }
        cout << "+\n";

        for (int i = 0; i < height - 2; i++)
        {
            cout << "|";
            for (int j = 0; j < +width - 2; j++)
            {
                cout << " ";
            }
            cout << "|\n";
        }

        cout << "+";
        for (int i = 0; i < width - 2; i++)
        {
            cout << "-";
        }
        cout << "+\n";
    }

} 
```

如何更改我的函数以便从该点开始绘制矩形`(x, y)`？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:18:46.100

我首先`y` `std::endl`在实际打印之前输出 s，然后`x` `" "`在有效打印每一行之前输出。

# javascript - Wordpress 注册和排队各种脚本

> ID：13693502
> 
> 赞同：0
> 
> 时间：2012-12-03T23:14:02.847
> 
> 标签：javascript, jquery, wordpress, content-management-system

我对 wordpress 还是很陌生，并且已经建立并开发了我的第一个主题（一切正常）。我在 wordpress 上的 CMS 网站上的第二次尝试遇到了一些麻烦。那个麻烦是 jQuery。
该网站一切正常（除了 jQuery），这是令人沮丧的部分，在阅读了如何在 wordpress 中正确调用 jQuery 之后，我读到正确的方法是通过将脚本排入函数文件中。
从我的第一个站点的functions.php中获取代码并在这个站点上使用它

```
<?php
function fff_script_method() {
    wp_deregister_script( 'jquery' );
    wp_register_script( 'jquery', '/themes/wahoo/js/jquery.min.js');
    wp_enqueue_script( 'jquery' );
}
remove_filter( 'the_content', 'wpautop' );
remove_filter( 'the_excerpt', 'wpautop' );
add_action('wp_enqueue_scripts', 'fff_script_method');
?> 
```

但这一次似乎不起作用，我还需要调用各种脚本，上次我通过functions.php调用了这个脚本，其余的在我的header.php文件中使用常规方法

```
<script type="text/javascript" src="/wp-content/themes/wahoo/js/jquery.imagesloaded.js"></script> 
```

但是这一次似乎又不起作用了，我在 function.php 文件中所做的任何更改都只会导致语法错误，这意味着我必须再次替换 FTP 上的文件。
这令人难以置信的令人沮丧，我似乎无法弄清楚为什么这次要加载 jQuery，我还努力确保我的 jQuery 文件不冲突并使用“jQuery”而不是“$”。
任何建议将不胜感激，您如何正确注册和排队多个脚本，以便我可以查看它是否也有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:37:16.840

Rather than de- and re-registering jQuery (which shouldn't be necessary if you're avoiding conflicts), try this:

```
function imagesloaded_script(){
      wp_register_script('imagesloaded', get_template_directory_uri() . '/js/jquery.imagesloaded.js', 'jquery');
      wp_enqueue_script('imagesloaded');
    }

add_action( 'wp_enqueue_scripts', 'imagesloaded_script'); 
```

The function calls wp_register_script with three arguments: 1) a string to name the script, 2) the path of the script using `get_template_directory_uri()` to make sure you aren't messing up the paths, and 3) any dependancies - jQuery in this case.

# php - WP：在用户注册时添加额外的操作

> ID：13693503
> 
> 赞同：0
> 
> 时间：2012-12-03T23:14:14.580
> 
> 标签：php, wordpress, hook, registration

我的 WordPress 数据库中有一个新表，用于存储附属会员信息。所有注册的新用户都将自动获得一个会员 ID。

我如何做到这一点，以便当新用户注册时，他们不仅在网站上注册为作者，而且一些信息，如作者 ID 和一些自定义字段信息也被添加到附属表中？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-04T01:41:33.480

如果要自动执行此操作，可以覆盖该功能

```
wp_new_user_notification 
```

您可以在文件中找到原始功能

```
wp-includes/pluggable.php 
```

它在用户注册后调用，并且注册没有错误。

# json - 试图在一次调用中获取多个图形的原始 Graphite 数据......是否可以嵌套目标？

> ID：13693507
> 
> 赞同：3
> 
> 时间：2012-12-03T23:14:51.023
> 
> 标签：json, graph, get, graphite, graphiti-js

为了使我的 Graphite 图表更具可定制性和交互性，我正在从 Graphiti 切换到获取原始数据并使用 Javascript 库 (flot) 绘制它。我大约每 10 秒从 Graphite 获取页面上每个图表的原始 JSON 数据，但我想在单个 GET 请求中获取所有数据。我可以要求多个目标，但我还没有找到组织它们的方法。理想情况下，我想找到一种方法将与每个图相关的目标嵌套到它们自己的 JSON 对象中。我试图避免必须解析所有目标名称并将它们分类到它们的透视图中。

示例：如果我这样做：

```
mysite.com/graphite/render/?format=json&from=-1minute&target=aliasByNode(stats.production.api.response_codes.*,6)&target=aliasByNode(stats.production.app.*.CPUUtilization.Average,3) 
```

我得到这样的东西：

```
[ {"target": "400", "datapoints": [...]},
{"target": "500", "datapoints": [...]},
{"target": "cpu.5", "datapoints": [...]},
{"target": "cpu.1", "datapoints": [...]},
{"target": "cpu.2", "datapoints": [...]},
{"target": "cpu.3", "datapoints": [...]},
{"target": "cpu.4", "datapoints": [...]},
{"target": "cpu.5", "datapoints": [...]} ] 
```

我想找回这样的东西：

```
[ {"api_errors": {
    {"target": "400", "datapoints": [...]},
    {"target": "500", "datapoints": [...]} },
  {"cpu_utilization": {
    {"target": "cpu.5", "datapoints": [...]},
    {"target": "cpu.1", "datapoints": [...]},
    {"target": "cpu.2", "datapoints": [...]},
    {"target": "cpu.3", "datapoints": [...]},
    {"target": "cpu.4", "datapoints": [...]},
    {"target": "cpu.5", "datapoints": [...]} }
} ] 
```

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T21:34:27.280

抱歉，这是不可能的 - Graphite Web 应用程序不是为该用例设计的。

[您总是可以在石墨网络应用](https://github.com/graphite-project/graphite-web)程序上使用新功能提出问题/拉取请求。

# c# - 在 MVC 中向 HtmlHelper 添加虚线属性

> ID：13693511
> 
> 赞同：1
> 
> 时间：2012-12-03T23:15:17.960
> 
> 标签：c#, asp.net-mvc-3, razor

我在 MVC4 项目中使用 Html.TextBoxFor 助手。我们的网页设计师为他的框使用了“错误类型”的自定义属性，jquery/javascript 查看该属性以确定应该如何为该文本框呈现错误。

我尝试做类似的事情：

```
@Html.TextBoxFor(m => m.SomeValue, new { error-type="blue" }); 
```

但是 C# 不喜欢“错误类型”的属性名称。

有没有办法在通过 Razor 渲染自定义属性时使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:18:15.087

使用下划线；助手会将包含下划线的属性名称转换为破折号。仅供参考，我相信这仅适用于 MVC-3 或更高版本。

另一种方法是使用接受`IDictionary<string, object>`HTML 属性的重载。这将是向前和向后兼容的。

```
 @Html.TextBoxFor(m => m.SomeValue, new Dictionary<string, object>{{"error-type", "blue"}}) 
```

# math - 您将如何不断改进曼德布罗分形？

> ID：13693514
> 
> 赞同：3
> 
> 时间：2012-12-03T23:15:27.233
> 
> 标签：math, fractals, mandelbrot

我见过许多 mandelbrot 图像生成器绘制 mandelbrot 的低分辨率分形，然后不断改进分形。这是平铺算法吗？这是一个例子： http: [//neave.com/fractal/](http://neave.com/fractal/)

更新：我发现这个关于递归细分和计算曼德布洛特：[http](http://www.metabit.org/~rfigura/figura-fractal/math.html) ://www.metabit.org/~rfigura/figura-fractal/math.html 。也许可以使用 kd-tree 来细分图像？

更新 2：[http](http://randomascii.wordpress.com/2011/08/13/faster-fractals-through-algebra/) ://randomascii.wordpress.com/2011/08/13/faster-fractals-through-algebra/ 更新 3：[http ://www.fractalforums.com/programming/mandelbrot-exterior-optimization/15/](http://www.fractalforums.com/programming/mandelbrot-exterior-optimization/15/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-03-12T00:09:38.857

Fractal eXtreme 的作者和此处问题中链接的 randomascii 博客文章。

Fractal eXtreme 做了一些事情来提供逐渐改善的分形图像：

1.  从中间开始，而不是从顶部开始。这是许多早期分形程序忽略的微不足道的变化。中心应该是用户最关心的区域。这可以从中心线开始，也可以螺旋形向外。螺旋出有更多的开销，所以我只在计算密集的图像上使用它。
2.  使用 8x8 块进行初始低分辨率传递（计算 64 个像素中的一个）。这给出了一个粗略的初始视图，该视图逐渐以 4x4、2x2 和 1x1 分辨率进行细化。请注意，每次传递的像素数是之前所有传递的三倍——不要重新计算原始点。随后的传球也从中心开始，因为那更重要。
3.  多遍方法很适合猜测。如果两行中的四个像素具有相同的值，那么中间的像素可能具有相同的值，所以不要计算它们。这在某些图像上非常有效。最后进行清理以查找计算错误的像素是必要的，并且通常会发现一些错误，但在清理通过后我从未见过可见的错误，这可以提供 10 倍以上的加速。可以禁用此功能。此功能的成功（猜测百分比）可以在状态窗口中查看。
4.  放大时（双击放大倍率）可以将之前计算的像素作为起点，这样只有四分之三的像素需要计算。当所需的精度增加但这些不连续性很少见时，这不起作用。

更复杂的算法绝对是可能的。例如，曲线跟随。

快速数学也有帮助。FX 中的高精度例程是使用 64 位乘法的完全展开的汇编语言（由 C# 代码生成）。

FX 还对两个最大灯泡内的点进行了几次检查，以避免计算它们。它还监视计算中的周期——如果出现完全相同的点，则计算将重复。

要查看此操作，请访问[http://www.cygnus-software.com/](http://www.cygnus-software.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:47:19.637

老式的 Mandelbrot 渲染算法是从左上角开始计算像素，向右移动直到到达屏幕末尾，然后移动到下一行的开头，就像普通的打字机（视觉上）。

链接算法只是以不同的顺序计算像素，当它计算一个时，它会快速*假设*某些相邻像素，然后再返回以正确重绘它们。那是当您看到*改进*时，将其视为显示渐进式 JPEG。如果您放大该集合，某些像素值将保持不变（它们不需要重新计算），中间像素将被猜测、快速绘制并稍后重新计算。

不断改进的 Mandelbrot 只是为了您的眼睛，它永远不会比可以检测“岛屿”的正确计算的每像素算法更早完成。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-04T09:30:34.847

我认为该网站并不像您认为的那样聪明。我认为缩放时发生的事情是这样的：

*   取上一张图像，使用标准插值方法将其放大。这为您提供了“模糊”放大的图像。单击放大按钮几次以查看最佳效果
*   然后，在从中心点开始的同心圆中，为新的缩放级别以全分辨率重新计算图像的正方形。这会从中心向外逐渐“锐化”图像。因为您可能正在查看中心，所以您会立即看到改进。

您可以通过放大远距离更清楚地看到它在做什么，然后沿对角线方向*拖动*图像，这样几乎所有的屏幕都未绘制。当您释放拖动时，您将看到图像逐渐呈现为正方形，从新中心开始呈同心圆。

我还没有检查过，但我认为以不同的方式处理嵌入点并没有什么聪明的地方——只是因为完全嵌入的正方形在重新渲染之前和之后都是黑色的，所以你看不到不同之处。

# iphone - iPhone 上的应用程序图标下使用什么字体和大小？

> ID：13693515
> 
> 赞同：1
> 
> 时间：2012-12-03T23:15:32.207
> 
> 标签：iphone, text, font-size

我想知道 Apple 在 iPhone 主屏幕上的应用程序图标下方使用什么字体类型和大小。提前致谢 ：）

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-12-04T05:38:53.663

没有字体大小的限制，但他们会检查您的应用程序图标大小，主图标应为 57*57，视网膜显示应为 114*114。

# c# - 如何在 If 语句中评估 Enum？

> ID：13693520
> 
> 赞同：3
> 
> 时间：2012-12-03T23:16:00.867
> 
> 标签：c#, if-statement, enums, evaluate

我第一次尝试在我的代码中实现 Enum。我有一个简单的自定义类，如下所示：

```
public class Application
{
    //Properties
    public string AppID { get; set; }
    public string AppName { get; set; }
    public string AppVer { get; set; }
    public enum AppInstallType { msi, exe }
    public string AppInstallArgs { get; set; }
    public string AppInstallerLocation { get; set; }
} 
```

我在该类中有一个名为 Install() 的方法，如下所示：

```
 public void Install()
    {
        if (AppInstallType.exe)
        {
            ProcessStartInfo procInfo = new ProcessStartInfo("cmd.exe");
            procInfo.Arguments = "/c msiexec.exe /i " + AppInstallerLocation + " " + AppInstallArgs; ;
            procInfo.WindowStyle = ProcessWindowStyle.Normal;

            Process proc = Process.Start(procInfo);
            proc.WaitForExit();
        }
        else
        {
            ProcessStartInfo procInfo = new ProcessStartInfo("cmd.exe");
            procInfo.Arguments = "/c " + AppInstallerLocation + " " + AppInstallArgs;
            procInfo.WindowStyle = ProcessWindowStyle.Normal;

            Process proc = Process.Start(procInfo);
            proc.WaitForExit();
        }
    } 
```

当 AppInstallType 是一个字符串时，我的 Install 方法开头的 If 语句工作正常（AppInstallType = "msi"）。当我将 AppInstallType 更改为 Enum 时，我似乎无法确定 if 语句的语法。

如果可能的话，我想避免将任何参数传递给 Install() 方法。如果能够通过调用 Application 对象上的 Install() 方法来安装应用程序，那就太好了，如下所示：

```
Application app1 = new Application;
app1.AppInstallType = msi;
app1.Install(); 
```

我该怎么办？提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T23:20:34.267

您还没有声明 Enum 的实例，您只是声明了它。

你需要

```
 public enum AppInstallType { msi, exe }

public class Application
{
    //Properties
    public string AppID { get; set; }
    public string AppName { get; set; }
    public string AppVer { get; set; }
    public string AppInstallArgs { get; set; }
    public AppInstallType InstallType;
    public string AppInstallerLocation { get; set; }
}

if(InstallType == AppInstallType.msi) 
```

# objective-c - iOS 错误 - “无法识别的选择器”

> ID：13693521
> 
> 赞同：0
> 
> 时间：2012-12-03T23:16:02.723
> 
> 标签：objective-c, ios, ios5, twitter-oauth, unrecognized-selector

主程序

```
NSDictionary *additionalQueryParameters = [NSURL ab_parseURLQueryString:[url query]]; 
```

OAuth.h

```
@interface NSURL (OAuthAdditions)

+ (NSDictionary *)ab_parseURLQueryString:(NSString *)query;

@end 
```

OAuth.m

```
@implementation NUSL (OAuthAdditions)

+ (NSDictionary *)ab_parseURLQueryString:(NSString *)query
{
 does something..
} 
```

当它运行该行时，它会引发此错误...

> 2012-12-03 15:10:58.506[12500:1d403] +[NSURL ab_parseURLQueryString:]：无法识别的选择器发送到类 0xaece26c
> 
> 2012-12-03 15:10:58.508[12500:1d403] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“+ [NSURL ab_parseURLQueryString:]：无法识别的选择器发送到类 0xaece26c”
> 
> *** First throw call stack: (0xada8012 0xa3d6e7e 0xae332ad 0xad97bbc 0xad9794e 0x17b5ee8 0x17b5724 0x17b58d6 0xa84f53f 0xa861014 0xa8522e8 0xa851fcb 0x96097b24 0x960996fe) libc++abi.dylib: terminate called throwing an exception

知道为什么找不到它以及如何修复它吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T16:00:26.813

您的类别实现 (OAuth.m) 被命名为 NUSL，而不是 NSURL。编译器对该方法很好，因为类别接口（标题）命名正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:21:05.640

确保 OAuth.m 实际上在目标中并在您的项目中构建......

# netlogo - 如何使用 netlogo 在上方、下方和对角线上计算海龟？

> ID：13693530
> 
> 赞同：1
> 
> 时间：2012-12-03T23:16:54.907
> 
> 标签：netlogo

我正在使用 netlogo 为作业创建一个四人连接游戏。我无法跟踪连续有多少红色或蓝色。（确定获胜者）

这几乎就是我想要它做的事情：

如果这个圆圈是红色的，那么在连续的圆圈中加一，否则将连续的红色设置回 0 如果连续的红色为 4（或更大），则表明你赢了好友/加仑，否则将连续的红色设置为 0

这是我尝试过但不起作用的方法。

```
ifelse any? patches with [ (pcolor = red) and (pxcor 1)]
    [set successive-reds = successive-reds + 1]
    [set successive-reds 0]
    if successive-reds = 4
       [show "you won"] 
```

我已经搜索了 stackoverflow 以寻求帮助，并找到了执行此操作的方法，但没有使用 netlogo 程序。我也尝试过使用邻居和海龟，但找不到一种方法让海龟问他们的邻居海龟它们的颜色是否与海龟问的颜色相同。

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T04:23:52.630

啊……我知道，既然这是一个任务，我应该轻轻地引导你自己弄清楚如何去做，但这是一个很酷的小问题，NetLogo 非常适合，我忍不住发布解决方案：

```
to-report wins? ; patch procedure
  report member? true map wins-in-direction? n-values 8 [ ? * 45 ]
end

to-report wins-in-direction? [ h ] ; patch procedure
  report not member? false map [
    ([ pcolor ] of patch-at-heading-and-distance h ?) = red
  ] (n-values 4 [ ? ])
end 
```

给定上面的代码，如下语句：

```
any? patches with [wins?] 
```

...会告诉你是否有任何补丁是获胜序列的末端。

现在，除非您理解它，否则您不应该使用该代码。如果您不习惯这种风格，使用[`map`](http://ccl.northwestern.edu/netlogo/docs/dictionary.html#map)and[`n-values`](http://ccl.northwestern.edu/netlogo/docs/dictionary.html#n-values)可能会带来一点挑战，但请随时在评论中提出问题，我会更新我的答案以解决这些问题。

**奖励积分：**这只检查红色胜利。概括这一点，以便它可以检查另一种颜色，而不会天真地复制代码。

# ios - xcode 示例项目“CurrentAddress”：当前位置来自哪里？

> ID：13693531
> 
> 赞同：-2
> 
> 时间：2012-12-03T23:16:56.543
> 
> 标签：ios, xcode, cllocationmanager

我使用的是 Xcode 4.5.1 版和 OS X 10.8.2 版。

我下载了 CurrentAddress 示例项目（1.2 版），当我第一次运行它时，它会提示“'CurAddress' 你想使用你当前的位置吗”，我说好的。我无法弄清楚代码从哪里获取它最终使用的位置，该位置位于旧金山内或附近，纬度 37.7858，长 -122.406。我查看了整个项目，看不到这些值来自哪里。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:20:09.190

这来自 CLLocationManager，它要么从 iPhone 设备中的 GPS 传感器获取数据，要么从 iPhone Simulator 中内置的 GPS 模拟获取数据。
旧金山是默认的 GPS 模拟赛道，靠近 Apples 总部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:23:10.253

如果您在模拟器中运行，请转到模拟器调试菜单 -> 位置 -> 您可以在此处设置任何位置。如果我是正确的，您的 CLLocationManager 应该从这里选择模拟器中的当前位置。在设备中，如果启用了相同的位置，它应该选择当前位置。

# escaping - 如何在 HAML 中的行首写百分号 (%)？

> ID：13693533
> 
> 赞同：11
> 
> 时间：2012-12-03T23:17:05.443
> 
> 标签：escaping, haml

如何在 HAML 文件中以百分比开头？

这不起作用：

```
%p
  = my_ruby_var
  % 
```

=== 更新 ===

注意：不接受此答案。我不想计算任何红宝石：

```
%p
  = my_ruby_var
  = '%' 
```

=== 更新 2 ===

有关信息：我在同一个文档参考中发现也可以转义 HTML：

***&**后跟一个或两个等号字符会评估 Ruby 代码，就像没有 & 号的等号一样，但会清理**代码**结果中的任何 HTML 敏感字符。*

例如：

```
&= "I like cheese & crackers" 
```

编译为

```
I like cheese &amp; crackers 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-03T23:21:42.617

尝试

```
\% 
```

也许..

因为它在[http://haml.info/docs/yardoc/file.REFERENCE.html#escaping_](http://haml.info/docs/yardoc/file.REFERENCE.html#escaping_) 中说 \ 是转义字符

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:25:08.233

我刚刚测试了在 % 前加上[\](http://haml.info/docs/yardoc/file.REFERENCE.html#escaping_)并产生了 % 符号。希望有帮助

# java - 在不同的包中生成JNI头文件

> ID：13693536
> 
> 赞同：0
> 
> 时间：2012-12-03T23:17:23.953
> 
> 标签：java, header, java-native-interface, classpath

如果我将所有 .java 和 .class 文件放在一个地方（即在默认包中），那么一切正常，我会做所有 JNI 的东西，等等。但在这种情况下，我有 package-ception（很多目录），我的类和Java文件是分开的`/bin`等等`/src`。而且我需要生成头文件，但我一直收到错误。我尝试了很多命令，我看到了不同的教程。我已经别无选择了。所以我的项目在里面`c://gvk/SEP3`，然后我要使用的带有本机方法的类和 Java 文件在`/bin/CalculatorServer`里面`/src/CalculatorServer`

我一直`javah`从具有本机方法的类文件所在的目录运行命令。到目前为止我尝试过的命令是：

```
javah -d ./CalculatorServer NativeMethodsCalculator 
```

错误：找不到“NativeMethodsCalculator”的类文件。

```
javah -d ./CalculatorServer CalculatorServer.NativeMethodsCalculator 
```

错误：找不到“CalculatorServer.NativeMethodsCalculator”的类文件。

```
javah -d c://gvk/SEP3/bin/CalculatorServer -classpath c://gvk/SEP3/bin/CalculatorServer NativeMethodsCalculator 
```

错误：找不到“NativeMethodsCalculator”的类文件。

```
javah -classpath c://gvk/SEP3/bin/CalculatorServer -o NativeMethodsCalc.h src.CalculatorServer.NativeMethodsCalculator 
```

错误：找不到“src.CalculatorServer.NativeMethodsCalculator”的类文件。

```
javah -jni bin.CalculatorServer.NativeMethodsCalculator 
```

错误：找不到“bin.CalculatorServer.NativeMethodsCalculator”的类文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:33:24.383

> 我一直从具有本机方法的类文件所在的目录中运行 javah 命令

那是你的错误。您应该从包含最外层包的目录中运行它，内部包及其 .class 文件位于其下方。那么你不需要 -d 参数或 -classpath 参数。假设你最外层的包是CalculatorServer，你应该在CalculatorServer所在的目录下，需要的命令行是`javah CalculatorServer.NativeMethodsCalculator`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T10:32:58.610

你没有尝试的：只是去`/bin/`（**而不是**进入`CalculatorServer`）并运行

`javah -jni CalculatorServer.NativeMethodsCalculator`

**这是运行它的唯一方法**。只需查看[javah 文档](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javah.html)。它在概要中说“*完全限定的类名”。*“*完全合格*”意味着**完整的类路径**。你只给它类名。到目前为止，它只对您有用，因为您使用的是默认包，这意味着您的完全限定类名等于裸类名。

选项`-d`并且`-o`不影响类查找，只影响本机结果的存储。您尝试的所有变体对您的错误没有任何影响。

# django - 如何在通过 pip 安装的应用程序中包含 django 模板？

> ID：13693550
> 
> 赞同：9
> 
> 时间：2012-12-03T23:18:29.607
> 
> 标签：django, manifest, pip, django-apps, pypi

我正在开发一个 django 应用程序（[django-flux](https://github.com/deanmalmgren/django-flux)），我正在尝试使用[pypi](http://pypi.python.org/pypi?name=django-flux&version=0.1.0&:action=display)的 pip 正确安装它。例如，从[这篇博客文章](http://blog.nyaruka.com/adding-a-django-app-to-pythons-cheese-shop-py)和[distutils 文档中，我的](http://docs.python.org/2/distutils/setupscript.html#installing-package-data)[setup.py](https://github.com/deanmalmgren/django-flux/blob/e876e23917788b77a5954eef740112cf3dba7cbf/setup.py)和[MANIFEST.in](https://github.com/deanmalmgren/django-flux/blob/e876e23917788b77a5954eef740112cf3dba7cbf/MANIFEST.in)文件似乎应该包含`flux/templates/flux/*.html`数据文件，但由于某种原因，当我通过 pip 安装应用程序时它们不包含在内。

关于我做错了什么的任何建议？如何安装 django 模板（在其他非 python 文件中）？

作为参考，我有 distutils 2.7.3。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-04T00:05:27.887

您的设置功能中缺少`include_package_data=True`。

有关这方面的更多信息，您可以求助于 Flask 的优秀文档，其中涵盖了编写[基本设置脚本](http://flask.pocoo.org/docs/patterns/distribute/#basic-setup-script)：

> include_package_data 告诉分发查找 MANIFEST.in 文件并将所有匹配的条目安装为包数据。

然后你正在导入`find_packages`但到目前为止还没有使用它（`packages = find_packages()`）

# ruby-on-rails - ruby net_dav 示例放置

> ID：13693552
> 
> 赞同：0
> 
> 时间：2012-12-03T23:18:37.613
> 
> 标签：ruby-on-rails, exception, webdav, null

我正在尝试将文件放在带有 WEB_DAV 的站点上。（红宝石）

当我按照示例进行操作时，我得到一个 nil 异常

```
#### GEMS
require 'rubygems'
begin
  gem "net_dav"
rescue LoadError
  system("gem install net_dav")
  Gem.clear_paths
end
require 'net/dav'

uri = URI('https://staging.web.mysite');
user = "dave"
pasw = "correcthorsebatterystaple"

dav = Net::DAV.new(uri, :curl => false)
dav.verify_server = false
dav.credentials(user, pasw)

cargo = ("testing.txt")
File.open(cargo, "rb") { |stream|
  dav.put(urI.path +'/'+ cargo, stream, File.size(cargo))
} 
```

当我运行它时，我得到

```
`digest_auth': can't convert nil into String (TypeError) 
```

这与我的 nav.rb 文件中的第 197 行有关。

```
 request_digest << ':' << params['nonce'] 
```

所以我想知道的是我没有添加哪一步？是否有正确使用此宝石的合理示例？做一些有效的事情会很甜蜜:)

*附带问题：* 这是用于执行 web_DAV 的正确 gem 吗？它似乎是一个旧的无人维护的宝石，也许有更多的东西用来完成任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:53:27.257

尝试使用符号而不是字符串来引用哈希，即

```
request_digest << ':' << params[:nonce] 
```

在一个简单的测试中

baz = "baz" 参数 = {:foo => "bar"} baz << ':' << params['foo']

导致与您得到的错误相同。

# spring - Hibernate + Spring 自动装配错误

> ID：13693554
> 
> 赞同：2
> 
> 时间：2012-12-03T23:18:39.890
> 
> 标签：spring, hibernate

我有几天这个错误，似乎没有运气。尝试谷歌搜索，但仍然无法正常工作。查看日志，它不断告诉我我的 SessionFactory 有问题，但我就是无法理解。UserDao 和 RoleDao 都是我实现的接口。希望收到你们的来信。

**错误日志。**

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.database.dao.UserDao com.database.service.UserServiceImpl.userDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.database.dao.UserDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.hibernate.SessionFactory] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:286)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1064)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:563)
        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:872)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:423)
        at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:276)
        at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:197)
        at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4723)
        at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5226)
        at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5221)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.database.dao.UserDao com.database.service.UserServiceImpl.userDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.database.dao.UserDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.hibernate.SessionFactory] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:507)
        at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:84)
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:283)
        ... 21 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.database.dao.UserDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.hibernate.SessionFactory] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:286)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1064)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:827)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:769)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:686)
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
        ... 23 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.database.dao.UserDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.hibernate.SessionFactory] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:507)
        at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:84)
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:283)
        ... 34 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.hibernate.SessionFactory] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:903)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:772)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:686)
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
        ... 36 more 
```

调度程序上下文.xml：

```
<bean name="indexController"
    class="org.springframework.web.servlet.mvc.ParameterizableViewController"
    p:viewName="index" />

<bean
    class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping" />
<bean name="sessionFactory"
    class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="configLocation">
        <value>classpath:hibernate.cfg.xml</value>
    </property>
    <property name="configurationClass">
        <value>org.hibernate.cfg.AnnotationConfiguration</value>
    </property>
</bean>
<tx:annotation-driven />
<bean name="transactionManager"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>

applicationContext.xml:

<context:annotation-config />
<bean id="dataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver" />
    <property name="url" value="jdbc:mysql://localhost:3306/test" />
    <property name="username" value="truffles" />
    <property name="password" value="Teoric123$" />
</bean>

<bean name="userService" class="com.database.service.UserServiceImpl" />
<bean name="roleService" class="com.database.service.RoleServiceImpl" />

<bean name="roleDao" class="com.database.dao.RoleDaoImpl" />
<bean name="userDao" class="com.database.dao.UserDaoImpl" /> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T23:40:40.027

您`<context:annotation-config/>`在您的`applicationContext.xml`其中没有可以映射到您的`sessionFactory`. 看起来您要么需要合并这两个配置，要么`dispatcher-context.xml`在`applicationContext.xml`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-13T18:09:33.160

有同样的问题，无法进行注射。

我的问题是“顺序”。必须首先调用 Hibernate xml。

调度程序-servlet.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.1.xsd
    http://www.springframework.org/schema/mvc
    http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<!-- init hibernate first -->
<import resource="classpath:HibernateContext.xml"/>

<bean id="viewResolver"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/pages/" />
    <property name="suffix" value=".jsp" />
</bean>
<mvc:annotation-driven />
<context:component-scan base-package="com.xxx.yyy" /> 
```

# requirejs - 在 require.js 中定义全局变量时遇到问题

> ID：13693555
> 
> 赞同：0
> 
> 时间：2012-12-03T23:18:42.813
> 
> 标签：requirejs

我正在尝试定义一个可以在所有模块中引用的全局对象。但是，在模块中，我无法引用我的路径，并且说“g”不存在。

在 main1.js 中，我有这个：

```
requirejs.config({
  paths: {
    Underscore: 'lib/underscore/1.3.3/underscore.min',
    Backbone: 'lib/backbone/0.9.2/backbone.min',
    Globals: 'lib/backbone/ globalVars'
  }
});

require([ 'views/pages', 'views/filters'], function(allPages, filters) {
  filters.render();
  allPages.render();
}); 
```

在 globalVars.js 中，我有这个：

```
(function() {
    var Globals = {
        isDemo: false
    }
    console.log('in globalvars') // this shows in my console
}).call(this); 
```

最后，在 view/pages.js 中，我有这个：

```
define([
  'Globals',
  'Underscore',
  'Backbone'
], function(g, _, Backbone){
console.log(g.isDemo)  //<-- returns "TypeError: g is undefined" 
```

如果我在 main1.js 中使用这样的定义：

```
define( 'Globals', function() {
    return {
        isDemo: true
    }
}) 
```

它工作得很好。我没有太多运气试图弄清楚为什么这不起作用。我希望能够只包含指向 globalVars 的路径，而不是在需要它的每个模块中粘贴定义块的样板，因为将 isDemo 更改为 false 将需要更新许多其他模块页面（main2.js、main3.js）。 js 等）。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T16:48:47.700

好吧，首先，您`globalVars.js`不在模块模式中，因此 requirejs 不知道您要注册为模块的内容。如果您更改该文件以使用该模式，例如您添加到 main1.js 中的定义，那么您应该已准备就绪。您没有将其定义为模块是否有原因？

# java - Java stock 默认配置文件

> ID：13693561
> 
> 赞同：0
> 
> 时间：2012-12-03T23:19:12.940
> 
> 标签：java, configuration-files

> **可能重复：**
> [如何访问 jar 中的配置文件？](https://stackoverflow.com/questions/944610/how-do-i-access-a-config-file-inside-the-jar)

首先我给你一个我的代码示例，然后我问我打算做什么：

```
public static void resetGlobalConfigFile() throws IOException{

        File f=new File("appconfig.conf");

        FileWriter fWritter = new FileWriter(f);
        BufferedWriter bWritter = new BufferedWriter(fWritter);

        bWritter.write("# Path to the campaigns config file (xml)\r\n");
        bWritter.write("campaigns_xml_file=./campaigns/campaigns.xml");

        bWritter.close();

        f.createNewFile();
    } 
```

事实上，当我分发我的 jar 时，有一个配置文件（appconfig.conf）。

在我的代码中，我完成了 resetGlobalConfigFile() 方法，以允许用户使用默认值重置此配置文件。

但我认为最好**存储一个默认配置文件（例如嵌入在我的 .jar 中；这可能吗？）**，我可以使用我最喜欢的文本编辑器轻松管理（在开发阶段）。编译应用程序时，没有人可以编辑默认配置文件。

但我不知道该怎么做？也许您还有其他解决方案？因为真正的目标是可以**用文本编辑器编写这个默认文件**（在开发阶段），并且在编译时（生产阶段）没有人可以**更改默认值！**

谢谢阅读。

# solr - 哪种工具更适合存储启用 html 的文本（封闭式电子邮件系统）？

> ID：13693562
> 
> 赞同：0
> 
> 时间：2012-12-03T23:19:18.277
> 
> 标签：solr, full-text-search, full-text-indexing

所以我的案例是一个封闭的电子邮件系统。

电子邮件启用了 HTML。

**需要什么：**
全文搜索（数据库中有超过 100 万封电子邮件，但它们通常是根据最近活跃的用户预先过滤的）
存档 - 我如何存档旧的电子邮件（超过 1-2 年） .

保存这些电子邮件的更好方法是什么？作为服务器上的文件，或数据库表中的文件。还是两者的结合（由于归档）？

在上述问题之后 - 我可以使用哪些特定工具/插件来简化工作。我记得听说过一点 Solr，但我不确定还有哪些其他选择/可能性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T08:22:40.207

Solr 会在搜索方面为您提供帮助，但与存档无关。看看 Solr DIH，有一个 contrib 模块（我认为）可以读取 IMAP 源。

关于存档，那是一个很大的领域……有很多问题你必须回答：

*   您想将邮件作为一个整体存储，或分解其部分，以便您可以对不同邮件中重复的部分进行重复数据删除。
*   我倾向于存储在文件系统上，但要注意：
*   您需要设计一种方法来检测重复数据删除
*   巧妙地存储在一棵目录树上，这样您就不会减慢每个目录的浏览速度。
*   需要时压缩（不是较小的或不可压缩的）

# perforce - 在 Perforce 文件中查找字符串而不同步

> ID：13693563
> 
> 赞同：5
> 
> 时间：2012-12-03T23:19:18.800
> 
> 标签：perforce

不确定这是否可能，但我想我会问是否有人知道。是否可以在 Perforce 存储库中找到包含字符串的文件？具体来说，是否可以在不*先将*整个存储库同步到本地目录的情况下这样做？（它很大——我认为即使我删除了很多东西我也没有空间——这就是存档服务器的用途。）

有许多工具可以搜索本地目录中的文件（我个人使用 Agent Ransack，但这只是其中之一），但这些工具*不会*搜索远程 Perforce 目录，除非我有一些（最好是免费的）工具不知道有这个功能，或者 Perforce 本身有一些隐藏的功能？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T23:56:35.360

`p4 grep`是你的朋友。来自[perforce 博客](http://www.perforce.com/blog/100712/p4-grep)

> 'p4 grep' 允许用户使用简单的文件搜索以及正则表达式来搜索 head 的文件内容以及存储在服务器上的文件的早期版本。虽然不是标准 grep 的每个选项都受支持，但最重要的选项都是可用的。以下是根据“p4 help grep”的命令语法：

```
p4 grep [ -a -i -n -v -A after -B before -C context -l -L -t -s -F -G ] -e pattern file[revRange]... 
```

另请参阅[手册页](http://www.perforce.com/perforce/doc.current/manuals/cmdref/grep.html)。

**更新：**请注意，Perforce 在单个`p4 grep`命令中搜索的文件数量是有限制的。大概这是为了帮助降低服务器上的负载。这表现为错误：

```
Grep revision limit exceeded (over 10000). 
```

如果您有足够的 perforce 权限，您可以使用[`p4 configure`](http://www.perforce.com/perforce/doc.current/manuals/cmdref/configure.html)将`dm.grep.maxrevs`设置从默认的 10K 增加到更大的值。例如设置为 100 万：

```
p4 configure set dm.grep.maxrevs=1M 
```

如果您无权更改此设置，则可以通过将`p4 grep`up 拆分为子目录上的多个命令来解决此问题。根据您的仓库结构，您可能需要进一步拆分为子目录等。

例如，可以在 bash shell 中使用此命令一次搜索一个子目录的每个子目录`//depot/trunk`。使用[`p4 dirs`](http://www.perforce.com/perforce/doc.current/manuals/cmdref/dirs.html)命令从服务器获取子目录列表。

```
for dir in $(p4 dirs //depot/trunk/*); do
  p4 grep -s -i -e the_search_string $dir/...
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T23:59:43.600

实际上，我自己解决了这个问题。 `p4 grep`确实成功了。 *[文档在这里](http://www.perforce.com/blog/100712/p4-grep)*。您必须仔细缩小范围才能正常工作 - 在我们的服务器上，至少您必须将其缩小到 < 10000 个文件。我还必须将输出重定向到一个文件，而不是在控制台中打印出来，添加`> output.txt`，因为控制台中每行有 4096 个字符的限制，而且文件路径很长。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:40:39.473

这不是你可以用标准的 perforce 工具做的事情。一个有用的命令可能是`p4 print`，但它并不比我想象的同步快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T23:53:09.133

这是一个很大的问题，但如果您可以访问服务器，您可以在 perforce 目录上运行 agent ransack。Perforce 将所有版本化文件存储在磁盘上，它只是数据库中的元数据。

# jquery - 将两个功能分配给同一个按钮？

> ID：13693566
> 
> 赞同：1
> 
> 时间：2012-12-03T23:19:45.133
> 
> 标签：jquery, html

我正在尝试将单击事件附加到按钮以弹出更多 div。在弹出更多div并单击按钮后，我还希望同一个按钮执行另一个功能。我怎么做？

提前致谢。

我的代码：

jQuery

```
$('#add').click(function(){
        $('.detail').fadeIn(300);
        $(this).attr('id', 'add_go');

     })

$('#add_go').click(function(){
     //same button click the second time
     alert('second function!');
}) 
```

html

```
<div>
   <a href='#' id='add'>add</div>

<div class='detail' style='display:none;'>more dive</div>
<div class='detail' style='display:none;'>more dive</div>
<div class='detail' style='display:none;'>more dive</div>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:29:46.243

在您描述的情况下，我会保留它的一个功能：

```
$('#add').click(function(){
      //Check if divs are visible
      if($('.detail').is(':visible'){
         alert('second function');   
      }else{            
         $('.detail').fadeIn(300);
      }
}) 
```

# ruby-on-rails - 延迟作业未知属性错误

> ID：13693567
> 
> 赞同：1
> 
> 时间：2012-12-03T23:19:46.390
> 
> 标签：ruby-on-rails, ruby, delayed-job

我设置了延迟的工作，它工作了一段时间。突然`unknown attribute: queue` ，当我尝试将以下行添加到我的一个控制器时，我得到了：

```
Delayed::Job.enqueue(EmailJob.new()) 
```

任何提示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T12:53:46.590

# ruby - “if”和“while”之类的循环方法如何捕获它们之前的块？

> ID：13693572
> 
> 赞同：1
> 
> 时间：2012-12-03T23:20:13.763
> 
> 标签：ruby

在红宝石中，您可以：

`do_stuff if foo == bar`

从技术上讲，是否有一个`&block`捕获之前的代码块`if`？这东西是怎么工作的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:51:14.880

它们不是方法，它们是关键字。它们的行为由语言规范定义，不受语言规则的限制。他们可以做任何他们想做的事。

# opengl - GL 图像和加载 OpenGL 函数

> ID：13693574
> 
> 赞同：0
> 
> 时间：2012-12-03T23:20:25.423
> 
> 标签：opengl

为什么某些 GL Image 函数需要使用 GL Load 来初始化 OpenGL 上下文？是否可以使用 GLEW 充分利用 GL Image 来初始化 OpenGL 上下文？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T01:53:29.930

如果你说的是[Unofficial SDK 的](http://glsdk.sourceforge.net/docs/html/index.html) [GL Image system](http://glsdk.sourceforge.net/docs/html/group__module__glimg.html)，答案是否定的。SDK 旨在成为一揽子交易；如果您使用其中的一部分，则应该使用其余部分。毕竟，如果您可以构建并包含 GL Image，您也可以使用 GL Load，因为它们是捆绑在一起的。

而 GL Load 正是 GLEW 所做的；它在很多方面都更好，因为它不需要那种“实验性”的东西来让它在核心环境中工作。通过 C 接口，您可以将所有`#include <GL/glew.h>`部分替换为`#include <glload/gl_[Insert Version Here].h>`. 您不需要修改除此之外的任何代码（当然还有初始化代码）。

话虽如此，您应该能够同时使用 GL Load 和 GLEW，*只要*：

1.  你初始化*他们两个*。这意味着在创建 OpenGL 上下文之后调用`glewInit` *和。* `LoadFunctions`他们的变量不应该相互作用或任何东西。

2.  您*永远不要*尝试将它们的两个非系统标头包含在同一个文件中。GL Image`TextureGenerator.h`实际上是专门设计为*不需要*包含 OpenGL 标头的（也就是说，它不直接使用像`GLint`or之类的 GL 类型`GLenum`）。

这显然是浪费，因为他们做的工作完全相同。但它应该工作。

# jaxb - OpenJDK JAXB 实现中奇怪的 NullPointerException Catch

> ID：13693577
> 
> 赞同：3
> 
> 时间：2012-12-03T23:20:47.353
> 
> 标签：jaxb, nullpointerexception, openjdk

我在 OpenJDK JAXB 中发现了一些奇怪的代码：

com.sun.xml.internal.bind.v2.model.impl.ModelBuilder

```
 try {
        XmlSchema s = null;
        s.location();
    } catch (NullPointerException e) {
        // as expected
    } catch (NoSuchMethodError e) {
        ...
    } 
```

有人可以解释他们为什么这样做吗？或者这只是需要修复的错误代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:57:59.980

他们使用此代码作为测试来确定正在使用哪个版本的[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222) API。该`location`参数已添加到`@XmlSchema`JAXB 2.1 中，如果`NoSuchMethodError`被抛出，则使用 JAXB 2.0 API。

**见第 158-177 行**

*   [http://grepcode.com/file/repo1.maven.org/maven2/org.jvnet.jaxb.reflection/jaxb2-reflection/2.1.4/org/jvnet/jaxb/reflection/model/impl/ModelBuilder.java](http://grepcode.com/file/repo1.maven.org/maven2/org.jvnet.jaxb.reflection/jaxb2-reflection/2.1.4/org/jvnet/jaxb/reflection/model/impl/ModelBuilder.java)

**Javadoc - @XmlSchema.location**

*   [http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/annotation/XmlSchema.html#location()](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/annotation/XmlSchema.html#location%28%29)

# ios - 当您在 xcode 上执行构建和运行时会发生什么？用户（非开发人员）可以重现吗？

> ID：13693579
> 
> 赞同：0
> 
> 时间：2012-12-03T23:20:57.693
> 
> 标签：ios, xcode, build, compilation

当您的应用程序版本存在于 iOS 设备上并且您决定在同一设备上构建和运行时会发生什么？这与一个人更新他们的应用程序时一样吗？

我问的一个重要原因是，当我在已经有该应用程序的开发设备上构建和运行我们的应用程序时，我的应用程序行为有点不正常。但是，如果没有构建和运行，我无法重现不良行为。所以我想知道是否有任何用户能够通过用户（非开发人员）触发的操作来体验这种意外行为......比如构建和运行。

# javascript - 如何将 document.getElementById 值转换为整数变量，而不是字符串？

> ID：13693580
> 
> 赞同：12
> 
> 时间：2012-12-03T23:21:02.737
> 
> 标签：javascript

我想传入一个从 html 对象获得的值，将该值转换为整数，以便在输出之前对其进行算术运算。就我现在的代码而言，它只是像字符串一样将它们相加。所以值 5 + 修饰符 100 最终等于 = 5100，而不是 105。

这是我的表单代码：

```
<form>
    Add Amount: <select id="addTweets">
    <option value=5>5</option>
    <option value=10>10</option>
    <option value=15>15</option>
    </select>
    </br>
    <input type="button" value="Add It" onclick="addTweet()" />
</form> 
```

这是我的脚本：

```
function addTweet()
{
var mod = 100;
var results = document.getElementById("addTweets").value;
results += mod;

document.getElementById("tweetsOutput").innerHTML = results;
} 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-03T23:23:05.140

一元加号 ( `+`) 将其操作数强制转换为数字：

```
var results = +document.getElementById("addTweets").value;
    ...

typeof( results ); // number 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:25:30.357

使用 parseInt：

```
var results = document.getElementById("addTweets").value;
var intResults = parseInt(results, 10) + mod; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T23:24:32.117

您可以使用`parseInt`

```
var results = parseInt(document.getElementById("addTweets").value); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T23:23:52.973

只需添加 parseInt，然后您可以正常添加它

```
 var results = parseInt(document.getElementById("addTweets").value); 
```

编辑：

parseInt 备用，您可以使用“|0”使用按位或零

```
 var results = document.getElementById("addTweets").value|0; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T23:39:01.303

尝试：

```
var valResult = document.getElementById("addTweets").value; // get the value of the field

var results = parseInt(valResult) + mod; // convert the value to int to do calculation

document.getElementById("addTweets").value = results; // assign results to the field value 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-05T03:20:50.447

通常，您可以通过对其进行数学运算将字符串数值转换为整数：

```
x = "9"; //String numerical value
y = 10;//integer value
alert(x+y)// output 910;
x = x*1;
alert(x+y) // output 19 
```

查看此[演示](http://jsbin.com/boxinekixe/edit?html,output)

# function - PL/pgSQL 触发器功能无法正常工作

> ID：13693583
> 
> 赞同：2
> 
> 时间：2012-12-03T23:21:21.180
> 
> 标签：function, postgresql, triggers, plpgsql

我在我的程序中遇到了这个功能的问题。

该函数的目的是实现一个触发器，该触发器检查用户 (utente) 的帐户 (saldo) 是否有足够的钱，以便将自己添加到乘车 (boleia)。

我可以从我的函数的行为中收集到用户（Utente）和乘车（Boleia），但他们的属性，特别是他的余额（saldo）没有被正确访问。这是因为每次我尝试将用户添加到行程中时，都会抛出异常“O Utente não tem saldo suficiente”，这意味着用户没有足够的钱。

我想不出我可能做错了什么。Utente 和 Boleia 表都被正确插入，每个属性也被插入，但我似乎无法在我的函数中访问它们。

这是函数的代码：

```
create or replace function assocpass_trigger_proc() returns trigger
as $$
declare
    x record;
    y record;
    balancetemp numeric;
begin
    select into x * from Utente where(nick=new.nick_passenger);
    select into y * from Boleia
    where(nick=new.nick_planner and date_time=new.date_time);
    select x.balance into balancetemp;
    if(found and (balancetemp>=y.cost_passenger)) then
       update Utente set balance = balancetemp-y.cost_passenger
       where Utente.nick = new.nick_passenger;
       insert into InscricaoP(nick_passenger,nick_planner,data_hora) 
       values(new.nick_passenger, new.nick_planner, new.date_time);
    elseif(found and (x.saldo<y.custo_passageiro)) then 
       raise exception 'O Utente não tem saldo suficiente';
    else
       raise exception 'A Boleia não existe'; 
    end if;
end
$$ language plpgsql; 
```

这是关系的插入：

```
insert into InscricaoP(nick_planner,date_time,nick_passenger)
values('zero','15/06','cinco'); 
```

nick_planner 和 nick_passenger 都来自“user”（Utilizador）实体 Date_time，cost_passenger 来自“ride”（Boleia）实体。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T07:41:54.880

特殊变量[`FOUND`](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-DIAGNOSTICS)在您的每个`SELECT INTO`命令之后设置。如果只在最后一个之后检查，则无法正确测试。

我认为您的功能可以这样工作：

```
CREATE OR REPLACE FUNCTION assocpass_trigger_proc()
  RETURNS trigger AS
$func$
BEGIN

UPDATE utente u
SET    balance = balance - b.cost_passenger
FROM   boleia b
WHERE  u.nick = NEW.nick_passenger
AND    b.nick = NEW.nick_planner
AND    b.date_time = NEW.date_time
AND    u.balance >= b.cost_passenger;

IF FOUND THEN
    INSERT INTO inscricaop(nick_passenger, nick_planner, data_hora) 
    VALUES (NEW.nick_passenger, NEW.nick_planner, NEW.date_time);

ELSIF EXISTS (
    SELECT 1
    FROM   utente u, boleia b
    WHERE  u.nick = NEW.nick_passenger
    AND    b.nick = NEW.nick_planner
    AND    b.date_time = NEW.date_time
    AND    u.saldo < b.custo_passageiro) THEN

    RAISE EXCEPTION 'O Utente não tem saldo suficiente';
ELSE
    RAISE EXCEPTION 'A Boleia não existe'; 
END IF;

END
$func$ LANGUAGE plpgsql; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:49:00.170

我将通过向 utente 表添加检查约束来解决此问题，以便余额必须大于或等于零，并尝试通过乘车费用从帐户中扣除。如果资金不足，则会引发违反约束的错误。

# python - Python - 列出超出范围的索引将对象循环到新位置

> ID：13693590
> 
> 赞同：0
> 
> 时间：2012-12-03T23:21:57.510
> 
> 标签：python, indexing

我已经搜索了好几次，我无法弄清楚这是什么问题。相关的代码行是：

```
WallList=[]
def createWallList():
    i=0
    while i<=numberWalls:
        newWall=box(pos=(0,(arenaSize-(i*2))-1,0), height=.1, width=1, length=(randomValue(0,20)), color=color.green)
        WallList.append(newWall)
        i=i+1

if WallList[i].pos.y>arenaSize:
    WallList[i].pos.y=-arenaSize 
```

我在控制台中收到错误消息：

```
Traceback (most recent call last):
    File "/Users/samwhaverly/Documents/FallDownGameWIP.py", line 76
    if WallList[i].pos.y>arenaSize:
IndexError: list index out of range 
```

对不起，这里有这么多，但我不知道出了什么问题。如果你们中的任何人都可以提供见解，那将非常有帮助。如有必要，我可以提供更多详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:39:01.097

You're getting an error because your indentation is wrong. Here's what's happening:

```
i = 0
Is i <= numberWalls? Yes.
Make a new wall.
Increment i to 1.
Is i <= numberWalls? Yes.
Make a new wall.
Increment i to 2.
...
Increment i to numberWalls + 1.
Is i <= numberWalls? No.
if WallList[i] <- ERROR: there is no wallList[i] 
```

# twitter-bootstrap - 不同页面的不同页面宽度

> ID：13693591
> 
> 赞同：-1
> 
> 时间：2012-12-03T23:21:58.070
> 
> 标签：twitter-bootstrap, fixed-width

在安装引导程序并使用它之后，我以某种方式为不同的页面设置了不同的页面宽度，我只是讨厌。我想我必须在我的 .css 文件中添加一些东西来修复页面宽度，但到目前为止我在 stackoverflow 和谷歌上找到的所有内容都没有帮助。所以我需要你的帮助。这是我的应用程序：http: [//murmuring-headland-8091.herokuapp.com/](http://murmuring-headland-8091.herokuapp.com/)

这是我的 .css 文件：

```
@import "bootstrap";
/* universal */

html {
  overflow-y: scroll;
}

body {
  padding-top: 60px;

}

body {
  background-image: url(http://i.imm.io/NOW7.png);
background-attachment:fixed;
}

section {
  overflow: auto;
}

textarea {
  resize: vertical;
}

.center {
  text-align: center;
}

.center h1 {
  margin-bottom: 10px;
}

/* typography */

h1, h2, h3, h4, h5, h6 {
  line-height: 1;
}

h1 {
  font-size: 3em;
  letter-spacing: -2px;
  margin-bottom: 30px;
  text-align: center;
}

h2 {
  font-size: 1.7em;
  letter-spacing: -1px;
  margin-bottom: 30px;
  text-align: center;
  font-weight: normal;
  color: #999;
}

p {
  font-size: 1.1em;
  line-height: 1.7em;
}

/* header */

#logo {
  float: left;
  margin-right: 10px;
  font-size: 1.7em;
  color: black;
  text-transform: uppercase;
  letter-spacing: -1px;
  padding-top: 0px;
  font-weight: bold;
  line-height: 1;
}

#logo:hover {
  color: red;
  text-decoration: none;
}
.navbar-inner {
  background-color: #fff; /* place your solid color here */
  background-image: none;
  background-repeat: no-repeat;
  filter: none;
}
.navbar .nav,
.navbar .nav > li {
    float:none;
    display:inline-block;
    *display:inline; /* ie7 fix */
    *zoom:1; /* hasLayout ie7 trigger */
    vertical-align: top;
}

.navbar-inner{
border-radius:50px;
background: #fff !important; 
background-image: none;
background-repeat: no-repeat;
filter: none !important;
border-top:10px solid #fff !important;
border-bottom:10px solid #fff !important;
border-left:5px solid #fff !important;
border-right:5px solid #fff !important;
}

.navbar .nav > li > a{
padding:12px 15px 12px;
color:#000000 !important;
text-shadow:none !important;
border-right: 1px solid #5BB75B;
border-left:1px solid #5BB75B;
-webkit-transition:background 1s ease;
-moz-transition:background 1s ease;
-o-transition:background 1s ease;
transition:background 1s ease;
}

.navbar .nav > li > a:hover{
background:#5BB75B !important;
color:#fff !important;
-webkit-transition:background 1s ease;
-moz-transition:background 1s ease;
-o-transition:background 1s ease;
transition:background 1s ease;
}

.navbar .nav .active > a,
.navbar .nav .active > a:hover,
.navbar .nav .active > a:focus {
color: #fff;
box-shadow:none;
background: #5BB75B !important;
}
.main-width { margin: 0px auto; } 
```

也许我的 home.html.erb 文件有问题，因为主页是唯一与其他页面不同的页面。如果您需要，我也可以发布它的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T09:22:05.570

好的，我有一些用于主页的 css 和一个单独的文件，我杀了它，现在一切都很好。

# actionscript-3 - 如何使用 as3 在 css 中动态设置文本大小

> ID：13693601
> 
> 赞同：1
> 
> 时间：2012-12-03T23:22:47.013
> 
> 标签：actionscript-3

我目前正在尝试通过基本字体大小变量基于全局样式表动态设置文本大小。我目前正在使用方法 tfWidthController 来检查宽度是否大于所需宽度，如果是，则减小 css 中的字体大小并重新解析 css 并使其自动调整大小。但由于某种原因，它没有自动调整大小，而是正在操纵 css。你看到我做错了什么吗？感谢您花时间帮助我！

```
 package com.intentionally censored.view {
import flash.display.MovieClip;
import flash.text.TextField;
import flash.text.StyleSheet;
import com.intentionally censored.model.MatchupModel;
import com.ff0000.ads.utils.Trace;
import com.google.analytics.debug.Info;

public class MatchupView extends MovieClip {

    // on stage
    public var maxTextFieldWidth = 150;
    public var tf:TextField;
    private var baseFontSize = 10;
    public var $_tfCurrentWidth;

    public function tfWidthController():void {
        $_tfCurrentWidth = tf.textWidth;
        trace('textfields current width is ' + $_tfCurrentWidth);
        trace('textfields max width is ' + maxTextFieldWidth);
        while ($_tfCurrentWidth > maxTextFieldWidth) {
            trace ('$_tfCurrentWidth is '+$_tfCurrentWidth);
            trace ('maxTextFieldWidth is '+maxTextFieldWidth);
            baseFontSize-=1;
            applyStyles();
        }
    }

    private function get styles():StyleSheet {
        var _styles:StyleSheet = new StyleSheet();
        _styles.parseCSS("* {font-family:Playoff Bold Italic;font-style:boldItalic;}.em {font-size:"+(baseFontSize+2)+"px; }.redMicroTxt{font-size:"+baseFontSize+"pt;color:#c00000;}.medWhiteTxt{font-size:"+(baseFontSize+3)+"pt;color:#FFFFFF;}.redMediumTxt{font-size:"+(baseFontSize+6)+"pt;color:#c00000;}.whiteLargeTxt,.whiteMedTxt{font-size:"+(baseFontSize+6)+"pt;color:#FFFFFF;font-style:italic;}");   
        return _styles;
    }

    public function MatchupView() {
        tfWidthController();
        applyStyles();

    }

    protected function applyStyles():void {
        tf.styleSheet = styles;
        tf.autoSize = "center";
    }

    public function prepareFor( $_matchupModel:Object ):void {
        Trace.out( this, 'prepareFor()' );
        var _timeMessage:String = '';
        var _dateMessage:String = 'LIVE NOW'; // -------------- logic for 160 includes "\r"
        trace( $_matchupModel.gameStatus );
        if( $_matchupModel.gameStatus != 'Live Now' ) {             
            _timeMessage = $_matchupModel.timeMessage;
            _dateMessage = 'PM/ET';
        }

        tf.htmlText = '<span class="redMicroTxt">' + $_matchupModel.team1Rank + " "+'</span>'+
                        '<span class="whiteLargeTxt">' + $_matchupModel.team1 + '</span>'+
                        '<span class="medWhiteTxt"> vs </span>'+
                        '<span class="redMicroTxt">' + $_matchupModel.team2Rank + " "+'</span>'+
                        '<span class="whiteLargeTxt">' + $_matchupModel.team2 + '</span> '+
                        '<span class="redMediumTxt">' + _timeMessage +
                        '<span class="redMicroTxt">' + _dateMessage + '</span></span>';
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:56:51.913

我想通了 - 每次调整大小时都需要更改 htmlText。

```
while ($_tfCurrentWidth > maxTextFieldWidth) {
    trace ('$_tfCurrentWidth is '+$_tfCurrentWidth);
    trace ('maxTextFieldWidth is '+maxTextFieldWidth);
    var oldHtml:String = tf.htmlText;
    tf.htmlText = '';
    tf.htmlText = oldHtml;
    baseFontSize-=1;
    applyStyles();
} 
```

我也为此做了一个工作测试，你可以在这里看到它： [http ://wonderfl.net/c/A310](http://wonderfl.net/c/A310)

# javascript - 使用 AJAX 和 PHP 检查用户是否存在

> ID：13693602
> 
> 赞同：0
> 
> 时间：2012-12-03T23:22:54.750
> 
> 标签：javascript, php, jquery, sql, ajax

我正在尝试创建一个注册表单来检查用户是否存在于数据库中，我插入了一个示例用户，当我尝试与该用户注册时，它并没有说它已经被使用。我做错了什么？

JavaScript：

```
function formSubmit()
    {
    document.getElementById('email_valid').innerHTML = '';

    var temail=document.forms["signup_form"]["temail"].value.replace(/^\s+|\s+$/g, '');

      var atpos=temail.indexOf("@");
        var dotpos=temail.lastIndexOf(".");
        if (atpos<1 || dotpos<atpos+2 || dotpos+2>=temail.length)
          {
          //alert("Not a valid e-mail address");
          setTimeout(function(){document.getElementById('email_valid').innerHTML = '<br/>Email must be valid...';},1000);
          var temailsub=0;
          }
          else
          {
          $.post('/resources/forms/signup/email.php',{email: temail}, function(data){
            document.getElementById('email_valid').innetHTML = data;
            if(data.exists){
                    document.getElementById('email_valid').innetHTML = '<br/>The email address you entered is already in use.';
                    var temailsub=0;
                }else{
                    var temailsub=1;
                }
            }, 'JSON');
          }
    if(temailsub==1e)
      {
        setTimeout(function(){document.getElementById("signup_form").submit();},1000);
      }
      else
      {

        return false;
      }
    } 
```

PHP 文件（email.php）：

```
<?php
header('content-type: text/json');
require_once $_SERVER['DOCUMENT_ROOT']."/resources/settings.php";
$query = $pdo->prepare("SELECT * FROM users WHERE email=:email");
$query->execute(array(
    ":email"=> $_POST['email']
));
echo json_encode(array('exists' => $query->rowCount() > 0));
?> 
```

我已经检查并仔细检查了代码，我仍然看不出为什么它没有检测到电子邮件已被使用......我需要做些什么来解决这个问题并在未来避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:31:37.103

问题是[PDOStatement::rowCount()](http://php.net/manual/en/pdostatement.rowcount.php)返回受最后一条 SQL 语句影响的行数。您正在执行 a `SELECT`，因此该值将始终为`0`。`SELECT`不影响任何行。相反，您需要计算行数：

```
$query = $pdo->prepare("SELECT COUNT(*) FROM users WHERE email=:email");
$query->execute(array(
    ":email"=> $_POST['email']
));
$rows = $query->fetchColumn();

echo json_encode(array('exists' => $rows); 
```

同样来自上面 jtheman 的评论，您应该在 JavaScript 中替换`innetHTML`为。`innerHTML`

# google-sheets - 如何使用 API 格式化 Google 表格电子表格单元格？

> ID：13693612
> 
> 赞同：5
> 
> 时间：2012-12-03T23:23:22.800
> 
> 标签：google-sheets, google-api, google-drive-api, google-api-client, google-sheets-api

我的应用程序生成一个数据表并在用户的 Google Drive 中创建一个新的电子表格文档。如何向单个单元格添加格式（颜色、字体粗细、宽度等）？我似乎找不到任何文档，更不用说如何通过[`google-api-ruby-client`](https://code.google.com/p/google-api-ruby-client/).

我的大部分发现都可以追溯到 Google API 邮件列表，该列表声明它不受支持。
但是，我发现另一个应用程序实现了我想要的结果。将文档导出到 Google Drive 的“Smartsheet”示例：

来自 Smartsheet.com：

![在 Smartsheet.com](../Images/62450b6fccfd61e905a498141617dbdc.png)

我的 Google Drive 中的结果表：

![在我的 Google 云端硬盘中](../Images/531e480069fcb9ca93c9aadbc9771a14.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-03-09T04:58:43.120

**（2017 年 2 月）** [从 Google I/O 2016 开始](https://gsuite-developers.googleblog.com/2016/05/apps-dev-sheets-api.html)，开发人员不再需要导出到 Excel 或创建具有所需格式的新工作表，因此其他答案现在已过时。您现在可以使用[Google Sheets API](http://developers.google.com/sheets)格式化单元格。这是一个简短的 Python 示例，将第一行加粗（假设文件 ID 是`SHEET_ID`并且`SHEETS`是 API 服务端点）：

```
DATA = {'requests': [
    {'repeatCell': {
        'range': {'endRowIndex': 1},
        'cell':  {'userEnteredFormat': {'textFormat': {'bold': True}}},
        'fields': 'userEnteredFormat.textFormat.bold',
    }}
]}

SHEETS.spreadsheets().batchUpdate(
        spreadsheetId=SHEET_ID, body=DATA).execute() 
```

如果有帮助，我还制作了一个关于这个主题的开发者视频（见下文）。顺便说一句，您可以在 Ruby（请参阅[其 API 快速入门示例）或](http://developers.google.com/sheets/api/quickstart/ruby)[Google APIs Client Libraries](http://developers.google.com/discovery/libraries)支持的任何其他语言中执行相同操作。

Sheets API 提供了旧版本中没有的功能，即让开发人员以编程方式访问工作表，就像您使用用户界面一样（冻结行、单元格格式 [!]、调整行/列大小、添加数据透视表、创建图表等.)。如果您是 API 新手，我制作了一些视频，其中包含更多“真实世界”示例：

*   [将 SQL 数据迁移到工作表](http://gsuite-developers.googleblog.com/2016/06/introducing-google-sheets-api-v4.html)加代码深入研究[帖子](http://wescpy.blogspot.com/2016/06/using-new-google-sheets-api.html)
*   [使用 Sheets API](http://gsuite-developers.googleblog.com/2016/11/formatting-cells-with-the-google-sheets-api.html)和代码深潜[帖子格式化文本](http://wescpy.blogspot.com/2016/09/formatting-cells-in-google-sheets-with.html)
*   从电子表格数据和代码深入研究生[成](http://wescpy.blogspot.com/2016/11/generating-slides-from-spreadsheet-data.html)[幻灯片](https://gsuite-developers.googleblog.com/2016/11/generating-slides-from-spreadsheet-data.html)

[要了解您还可以通过其 REST API 或Google Apps 脚本](http://developers.google.com/apps-script)使用 Google 表格做什么，请查看我的其他[视频](https://developers.google.com/sheets/api/videos)。如您所知，Sheets API 主要用于上述面向**文档的功能，但要执行****文件**级访问，例如导入/导出、复制、移动、重命名等，请改用[Google Drive API](http://developers.google.com/drive)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T04:53:13.153

API 仅提供对数据的访问，不公开任何添加格式的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-13T20:13:11.593

Smartsheet 利用 Google API 的功能来导入 Excel 文件。代码大致如下：

```
DocsService client = new DocsService(<YOUR APP NAME>);
client.setOAuthCredentials(<OAUTH PARAMETERS>);

DocumentListEntry newEntry = new SpreadsheetEntry();
newEntry.setMediaSource(new MediaByteArraySource(<EXCEL FILE BYTE ARRAY OUTPUT STREAM>, DocumentListEntry.MediaType.XLS.getMimeType()));
newEntry.setTitle(new PlainTextConstruct(<FILE NAME>));

DocumentListEntry insertedEntry = client.insert(new URL("https://docs.google.com/feeds/default/private/full/"), newEntry);

// This is your URL to the new doc
String docUrl = insertedEntry.getDocumentLink().getHref(); 
```

我们已经能够通过 Apache POI 将 Smartsheet 导出到 Excel 文件并进行格式化。将导出添加到 Google 电子表格对我们来说实现起来非常简单，它提供了一些额外的功能，超出了您可以通过 API 完成的功能。

很抱歉延迟回复 - 刚刚发生在这个问题上。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-12T05:26:13.403

另一种选择（也是最终使用的）是手动创建一个谷歌表格文件，所有格式都预先配置，作为模板。然后，不要在用户的 Google Drive 中创建新的电子表格文档，而是复制模板，如下所示：

```
var config = require('./config');
var google = require('googleapis');

function createSheetFromTemplate(user, templateFileId, done) {

  var oauth2Client = new google.auth.OAuth2(config.google.clientId, config.google.clientSecret);

  oauth2Client.setCredentials({
    access_token: user.google.token,
    refresh_token: user.google.refreshToken,
  });

  var drive = google.drive({
    version: 'v2',
    auth: oauth2Client
  });
  drive.files.copy({
    fileId: templateFileId,
    resource: {
      title: 'New Google Sheet',
      parents: [{
        id: 'root'
      }]
    }
  }, function(err, response) {
    if (err) done(err)

    initializeSpreadsheet(response.id, user, done);
  });
} 
```

在该代码中，templateFileId 是共享模板的文件 ID。您可以通过多种方式从共享模板文件中获取此 fileId，但最简单的方法是在共享时将其从 URL 中复制并粘贴出来。

例如，如果共享 URL 是：

[https://docs.google.com/spreadsheets/d/1234567890abcdefghijklmnop/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1234567890abcdefghijklmnop/edit?usp=sharing)

那么文件id是**1234567890abcdefghijklmnop**

在我的例子中，模板本身没有任何私有内容，所以我只是与配置为“可以查看”的“任何有链接的人”共享它，如下所述：

[https://support.google.com/drive/answer/2494886](https://support.google.com/drive/answer/2494886)

如果您需要将模板文件的内容保密，那么您需要找到某种方法来确保 config.google.clientId 指定的帐户可以访问它。

希望有帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-12T17:28:38.507

如果像我一样，上传预先格式化的 Excel 工作表还不够，那么 Google Apps Script 看起来可能是不错的选择。Range 类专门允许您操作至少一些您所询问的格式。

[https://developers.google.com/apps-script/reference/spreadsheet/range](https://developers.google.com/apps-script/reference/spreadsheet/range)

setFontColor() 和 setFontWeight() 在那里，但我还不知道单元格宽度的任何内容。

重要的是，我还没有弄清楚如何将 Google Apps 脚本绑定到我使用 Google Drive API SDK（在我的情况下为 Node/Javascript，在你的情况下为 Ruby）创建的工作表上。

[https://developers.google.com/apps-script/guides/bound](https://developers.google.com/apps-script/guides/bound)

你的问题已经有一段时间了，所以我打赌你已经以其他方式解决了它。我也不一定建议将您应用程序中的所有内容都移植到 Google Apps Script（尽管我自己也在认真考虑...），但如果您或其他读者知道如何将 Google App Script 绑定到电子表格使用 google-api-ruby-client，您可能会很好。

# ruby - Screen scraping in clojure

> ID：13693615
> 
> 赞同：3
> 
> 时间：2012-12-03T23:23:32.427
> 
> 标签：ruby, clojure, screen-scraping, nokogiri

I googled, but I can't find a satisfactory answer. [This](https://stackoverflow.com/questions/2122779/is-there-a-library-similar-to-lxml-or-nokogiri-for-java) SO question is related but kinda old as well as the exact opposite of what I am looking for: a way to do screen-scraping using XPath, not CSS selectors.

I've used enlive for some basic screen-scraping but sometimes one needs the power of XPath selectors. So here it is:

Is there any equivalent to Nokogiri or lxml for clojure (java)? What is the state of the "pure java Nokogiri"? Any way to use the library from clojure? Any better alternatives than [this hack](https://gist.github.com/3058641)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T03:11:14.250

There are a couple of possibilities here.

Several of these require semi-well formed XML to work. If you don't have it, I would pair [clj-tagsoup](https://github.com/nathell/clj-tagsoup) with [hiccup](https://github.com/weavejester/hiccup) to produce the XML (parse with clj-tag-soup, which produces a form that hiccup and write out as XML) and work with that.

First, just use the native JDK capabilities. Assuming the document is well formed enough, try using [clj-xpath](https://github.com/kyleburton/clj-xpath) which provides a wrapper around the native JDK parsing.

If that doesn't suffice, consider taking a more Clojure data structure based route. A simpler path could just use the output of TagSoup and a combination of maps, filters, and nths.

If you need something more advanced, consider using zippers to provide structure around the data, making it easier to manipulate. Use `clojure.xml/parse` and `clojure.zip/xml-zip` to produce the zipper, and go from there. An example can be found at [http://techbehindtech.com/2010/06/25/parsing-xml-in-clojure/](http://techbehindtech.com/2010/06/25/parsing-xml-in-clojure/).

Using the native structures is my preferred route for anything complicated, as you can bring the full power of the language to bear.

If you provide a sample of why you need XPath, I can provide some sample code.

# google-drive-api - 使用 drive.file 范围执行查询时出现错误 500

> ID：13693617
> 
> 赞同：1
> 
> 时间：2012-12-03T23:23:40.647
> 
> 标签：google-drive-api

此代码在“https://www.googleapis.com/auth/drive”范围内运行良好

```
File folderEntry = drive.files().get("XXXXj0_srDPPGUEtHaVYtZFljMEk").execute();
String driveQuery = "title = '" + "test" + "' and mimeType = 'application/vnd.google-apps.folder' and ";
driveQuery += "'" + folderEntry.getId() + "' in parents";
Files.List request = drive.files().list();
request.setQ(driveQuery);
FileList files = request.execute(); 
```

但是，如果我在凭据和 API 客户端访问面板中将范围更改为“https://www.googleapis.com/auth/drive.file”，则会引发错误 500。

```
500 Internal Server Error {   "code" : 500,   "errors" : [ {
    "domain" : "global",
    "message" : "Internal Error",
    "reason" : "internalError"   } ],   "message" : "Internal Error" } 
```

我正在使用服务帐户，父文件夹是由应用程序创建的。

我不明白为什么我不能执行这个查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:21:50.030

我也得到同样的错误。然而，这种解决方法确实得到了我创建的文件夹的所有子项，直到谷歌修复了我认为的查询问题。

```
ChildList list = service.children().list(FILEID).execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T23:13:52.470

这可能有点晚了，但是......我相信问题会发生，因为当您使用范围[https://www.googleapis.com/auth/drive.file](https://www.googleapis.com/auth/drive.file)运行时，您只能查看您的应用创建的文件。但是，您的查询可能会返回您的身份验证范围之外的元数据。

我也遇到了同样的问题，并设法通过*添加*DRIVE_METADATA_READONLY 范围来解决它：

```
credential = GoogleAccountCredential.usingOAuth2(this, DriveScopes.DRIVE_FILE, **DriveScopes.DRIVE_METADATA_READONLY**); 
```

# c# - 在 WPF 中使用 Xceed Datagrid 更改网格标题的颜色

> ID：13693619
> 
> 赞同：0
> 
> 时间：2012-12-03T23:23:49.130
> 
> 标签：c#, wpf, xceed-datagrid

我正在使用 Xceed 数据网格控件，我正在尝试更改标题颜色，但似乎遇到了一些问题。我现在拥有的是以下代码片段：

```
Style style = new Style(typeof(ColumnManagerRow));
style.Setters.Add(new Setter(ColumnManagerRow.BackgroundProperty, Brushes.Black));
this.grid.Resources[typeof(ColumnManagerRow)] = style; 
```

这在大多数情况下都有效，但我仍然看到它周围有一些灰色。任何帮助将不胜感激。

**编辑**

我添加了一个图像，其中包含我希望具有相同颜色的选定区域。 ![在此处输入图像描述](../Images/1c467b9df575f26fdbefcaef973abd75.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T11:24:55.200

您可以在 XAML 中执行此操作：

```
<ControlTemplate x:Key="HeaderTemplate" TargetType="{x:Type xcdg:ColumnManagerCell}">
    <TextBlock Text="{TemplateBinding Content}">
        <TextBlock.Style>
            <Style TargetType="{x:Type TextBlock}">
                <Setter Property="Background" Value="Black" />
                <Setter Property="Foreground" Value="Red" />
            </Style>
        </TextBlock.Style>
    </TextBlock>
</ControlTemplate>

<Style TargetType="{x:Type xcdg:ColumnManagerRow}">
    <Setter Property="Background" Value="Black"/>
    <Setter Property="BorderBrush" Value="Black"/>
</Style>                

<Style TargetType="{x:Type xcdg:ColumnManagerCell}">
    <Setter Property="Template" Value="{StaticResource HeaderTemplate}"/>
</Style> 
```

# javascript - 有没有办法将信息传递给 async.js 并行调用，所以我不必使用全局变量？

> ID：13693620
> 
> 赞同：1
> 
> 时间：2012-12-03T23:23:52.130
> 
> 标签：javascript, node.js, asynchronous

有没有办法将信息传递给 async.js 并行调用，所以我不必使用全局变量？

```
async.parallel([
  function(callback){
      setTimeout(function(){
          callback(null, 'one');
      }, 200);
  },
    function(callback){
      setTimeout(function(){
          callback(null, 'two');
      }, 100);
  },
],
// optional callback
function(err, results){
  console.log(info)
    // the results array will equal ['one','two'] even though
  // the second function had a shorter timeout.
}); 
```

我希望最终回调知道“信息”的值。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:35:56.363

To avoid introducing a global variable you could place it within an enclosure:-

```
(function() {
    var info = "Some info";

    async.parallel([
        function(callback) {
            setTimeout(function() {
                callback(null, "one");
            }, 200);
        }, 
        function(callback) {
            setTimeout(function() {
                callback(null, "two");
            }, 100);
        }
    ], 
    function(error, result) {
        console.log(info);
    });

}) (); 
```

That way the final callback has access to it but it won't be visible outside of the scope of the anonymous self-executing function that encloses that code.

**EDIT** To do an enclosure in coffeescript:-

```
(() ->
  # my code
)() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T04:47:48.753

另一种方法是：

```
(function(protectedVariable1,protectedVariable2) {
    //do something with protected variables
})(variable1,variable2); 
```

# ruby - 如何编写日期转换方法？

> ID：13693622
> 
> 赞同：0
> 
> 时间：2012-12-03T23:23:51.923
> 
> 标签：ruby

这很简单。这是我想要对格式为 YYYYMMDD 的日期执行的操作：

```
month = datestring[0:2]
day = datestring[2:2]
year = datestring[4:4]
return "#{month}/#{day}/#{year}" 
```

问题是，我从来没有理解过关于 Ruby 的这一点，我会这样做：

*   一个模块？
*   混音？
*   别的东西？

我知道我想做什么，我只是不知道将它放入什么样的文件或结构中。如果它是一个模块，我是否在方法名称前加上模块名称：

```
module DateHelper
  def DateHelper.transform(datestring)
     ...
  end
end 
```

为什么或为什么我不这样做？非常感谢您帮助清除对我来说代表心理障碍的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:29:39.100

考虑使用具有组合的对象，而不是模块：

```
class DateString
  def initialize(date)
    @date_string = date
  end

  def format
    ...
  end
end 
```

现在你可以这样做：

```
my_date_string = DateString.new("20121203")
puts my_date_string.format # => "12/03/2012" 
```

这个答案涵盖了您问题的红宝石哲学部分，但如果您正在进行大量日期格式设置，请考虑使用已经为您完成的 gem。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T00:22:32.587

您问题中的代码暗示了 mixin，这是一种可能的方法。它更习惯地写成这样：

```
module DateHelper
  def date_to_some_format(date)
    ...
  end
end 
```

请注意，该方法是一个实例方法，并且它的名称不会与任意类中的其他方法发生潜在冲突。如果您希望该方法在类级别可用，您可以这样做的一种方法是：

```
class SomeClass
  class << self
    include DateHelper
    ...
  end
end 
```

这是处理类级别混入的一种方法；还有其他的。

是否需要 mixin 取决于上下文。日期格式是否涉及您发现在不相关的类中到处重复的代码？它是一次性的，您将永远不会再使用？需要记住状态吗？日期格式是否非常有用，可以作为核心库的扩展？这些问题的答案将表明代码是否应该在 mixin 中或以其他方式处理。（mixin 通常在 Ruby 中通过模块实现。）真正学习 ruby​​ 的一部分是在不同的上下文中了解这些问题的答案。在这方面几乎没有简单的答案，并且在一定程度上取决于惯例、个人喜好和房屋风格。

顺便说一句，获取您正在寻找的日期格式的一种方法是（遵循您的输入日期格式 YYYYMMDD）：

```
Date.strptime("20100101", "%Y%m%d").strftime("%m/%d/%Y") 
```

您不必在代码中以这种方式将其链接在一起——例如，Brendan Benson 的响应提供了一种很好的方法——尽管如果您只在一个地方这样做，您可能不需要花哨的东西。

# iphone - 在模拟器中登录 ios 应用程序的第二次运行

> ID：13693623
> 
> 赞同：1
> 
> 时间：2012-12-03T23:24:03.377
> 
> 标签：iphone, ios, xcode, ipad, ios5

我有一个问题，这似乎应该是一个相当普遍的现象。我正在尝试测试仅在第一次安装 ios 应用程序时运行的代码。虽然原则上这很容易，但我在应用程序第二次运行时无法正常运行（注意，这*与*崩溃无关）。

我已经使用 plist 中的“应用程序不在后台运行”标志第二次强制运行该应用程序，然后点击主页按钮。这很好用，除了我在第一次运行后停止获取日志数据。

有谁知道如何在应用关闭后继续查看日志信息的方式来测试这种情况？例如，如果有办法将 xcode 记录器附加到新的进程 ID？或者只是另一种在不丢失日志记录功能的情况下强制重启应用程序的方法？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:34:27.003

Use the debugger menu:

```
Product>Attach To Process 
```

(Results may vary with different versions of Xcode).

Also, you might need to insert a sleep at the very start of your launch to catch the very early log messages.

**EDIT:** If you're on a device then you can use the *Device Organizer* (cmd+shift+2) to watch all logs on a device.

# sql - SQL UNION 查询同一张表，同一个字段

> ID：13693625
> 
> 赞同：0
> 
> 时间：2012-12-03T23:24:07.450
> 
> 标签：sql, union

我正在尝试构建一个 SQL 联合查询，该查询将返回两列（每个选择一个），其结果来自同一字段，并使用 WHERE 子句进行排序。

这是我尝试的：

```
SELECT scg.grade AS course_1
FROM cp_StudentCourseGrade AS scg
JOIN cp_CourseSecSem AS css ON
css.courseSecSem_id = scg.courseSecSem_id
JOIN cp_Course AS c1 ON
c1.course_id = css.course_id
UNION
SELECT scg.grade AS course_2
FROM cp_StudentCourseGrade AS scg
JOIN cp_CourseSecSem AS css ON
css.courseSecSem_id = scg.courseSecSem_id
JOIN cp_Course AS c2 ON
c2.course_id = css.course_id**
WHERE c1.course_id = c2.course_id AND c1.course_id=1 AND c2.course_id=2; 
```

这应该返回给我类似的东西：

```
 course_1 | course_2
    -------------------
    4.0      | 6.0
    4.5      | 6.0
    6.0      | 5.5
    2.5      | 5.0
    1.0      | 4.0
    5.5      | 4.5 
```

但我有一个错误说：

> 未知列 c1.course_id

有谁知道我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:29:07.487

If the grades are supposed to be linked to the same student, I'm going to guess something like this:

```
Select
  scg.student_id,
  Sum(Case When css.course_id = 1 Then scg.grade Else Null End) as course_1,
  Sum(Case When css.course_id = 2 Then scg.grade Else Null End) as course_2
From
  cp_StudentCourseGrade As scg
    Inner Join 
  cp_CourseSecSem As css 
    On css.courseSecSem_id = scg.courseSecSem_id
Group By
  scg.student_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T00:21:30.757

这就是你需要的：

```
SELECT scg1.grade AS course_1, scg2.grade AS course_2
FROM cp_StudentCourseGrade AS scg1
JOIN cp_CourseSecSem AS css1 ON
css1.courseSecSem_id = scg1.courseSecSem_id
JOIN cp_Course AS c1 ON
c1.course_id = css1.course_id AND c1.course_id=1 
JOIN cp_StudentCourseGrade AS scg2
JOIN cp_CourseSecSem AS css2 ON
css2.courseSecSem_id = scg2.courseSecSem_id
JOIN cp_Course AS c2 ON
c2.course_id = css2.course_id AND c2.course_id=2; 
```

# ruby-on-rails - HTML5 缓存和授权问题

> ID：13693626
> 
> 赞同：1
> 
> 时间：2012-12-03T23:24:14.890
> 
> 标签：ruby-on-rails, html, authentication, caching, backbone.js

在将 HTML5 缓存添加到在 Rails 上以主干编写的单页应用程序后，我遇到了问题。浏览器（chrome）没有重新加载 html，这会以两种方式导致问题：

1) 主干的骨架 html 有时会发生变化 - 至少让主干知道用户已登录。但是，由于没有加载 html，应用程序不知道这一点（例如刷新后）。我可以在页面加载时查询服务器，但这是我希望避免的另一个请求。此外，这将强制将所有权限逻辑移动到客户端 - 因此要么从服务器复制 cancan 设置，要么将其嵌入到 html 中 - 我们遇到了上述问题。

2) Rails 的 csrf 标记在 html 中，它们也不会改变 - 导致任何 ajax 帖子都不起作用。对于这个我不知道该怎么做。从我读到的 csrf 令牌是为会话生成的，所以也许在登录/注销时我可以用 js 更新它。但是在哪里得到它，它会工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T15:56:14.610

我知道这个问题很老，但我刚刚遇到了 CSRF 问题。

尝试在清单文件中包含 CSRF 令牌作为注释。因此，每当它更改时，它都会更改清单并强制重新加载。

```
CACHE MANIFEST
# include CSRF token in manifest to force reload when it changes
# <%= form_authenticity_token %> 
```

为了安全起见，您可以通过哈希算法运行它几次

# winapi - 如何更改控件的文本但不影响窗口的标题？（或相反亦然）

> ID：13693629
> 
> 赞同：0
> 
> 时间：2012-12-03T23:25:03.343
> 
> 标签：winapi

我创建了一个简单的窗口：

```
CreateWindowExW(
WS_EX_TOPMOST,
L"RichEdit20W",
L"window_text",
WS_OVERLAPPEDWINDOW | WS_BORDER | WS_HSCROLL | WS_VSCROLL | ES_MULTILINE //... 
```

现在每次我挂起“窗口文本”参数时，控件和窗口标题都在变化，与`SetWindowTextW()`and相同`SendMessageW(hwnd, WM_SETTEXT, ...)`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T00:22:29.017

编辑控件（和丰富的编辑控件）并没有真正设计为具有这样的“标题”。将控件用作顶级窗口是很不寻常的。相反，您应该注册自己的窗口类以用于顶级窗口（然后可以有自己的标题文本）并使编辑控件成为子窗口。

# c++ - 使用 OpenCV 读取视频文件

> ID：13693631
> 
> 赞同：1
> 
> 时间：2012-12-03T23:25:19.107
> 
> 标签：c++, opencv

我正在尝试使用此示例代码来读取视频文件，但每次编译时都会出现这些错误。

这是代码：

```
#include "cv.h"   
#include "highgui.h"

int main(int argc, char** argv)
{
   CvCapture* capture=0;
   IplImage* frame=0;

capture = cvCaptureFromAVI("~/Documents/OpenCV/OpenCV-2.4.2/samples/c/tree.avi"); // read AVI video

if( !capture )
    throw "Error when reading steam_avi";

cvNamedWindow( "w", 1);

for( ; ; )
{
  /*  int cvGrabFrame (CvCapture* capture);

    IplImage* cvRetrieveFrame (CvCapture* capture)*/

    frame = cvQueryFrame( capture );

    if(!frame)
        break;

    cvShowImage("w", frame);

}

cvWaitKey(0); // key press to close window

cvDestroyWindow("w");

cvReleaseCapture(&capture); 
```

这是我编译的内容：

```
 g++ CaptureVideo.cpp -o CaptureVideo \-I /usr/local/include/opencv -L /usr/local/lib \-lm -lcv -lhighgui -lcvaux 
```

我正在使用 Ubuntu 12.04。编译时出现这些错误

```
"/usr/bin/ld: cannot find -lcv"

"/usr/bin/ld: cannot find -lhighgui"

"/usr/bin/ld: cannot find -lcvaux"

"collect2: ld returned 1 exit status" 
```

# php - PHPUnit 因 Symfony2 会话而失败

> ID：13693636
> 
> 赞同：5
> 
> 时间：2012-12-03T23:25:47.350
> 
> 标签：php, symfony, phpunit

尝试在实现会话的控制器方法上运行基于控制器的单元测试时遇到问题。

在这种情况下，这里是控制器方法：

```
/**
 * @Route("/api/logout")
 */
public function logoutAction()
{
    $session = new Session();
    $session->clear();

    return $this->render('PassportApiBundle:Login:logout.html.twig');
} 
```

和功能测试：

```
public function testLogout()
{
    $client = static::createClient();
    $crawler = $client->request('GET', '/api/logout');
    $this->assertTrue($client->getResponse()->isSuccessful());
} 
```

产生的错误：

> 无法启动会话，因为标头已发送。（500内部服务器错误）

我试过`$this->app['session.test'] = true;`参加测试，但还是不行。有没有人尝试解决这样的问题来对使用会话的控制器进行单元测试？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-04T08:11:22.820

首先，您应该使用容器中的会话对象。所以你的动作应该更像：

```
/**
 * @Route("/api/logout")
 */
public function logoutAction()
{
    $session = $this->get('session');
    $session->clear();

    return $this->render('PassportApiBundle:Login:logout.html.twig');
} 
```

然后在您的测试中，您可以将服务注入“客户的容器”。所以：

```
public function testLogout()
{
    $sessionMock = $this->getMockBuilder('Symfony\Component\HttpFoundation\Session')
        ->setMethods(array('clear'))
        ->disableOriginalConstructor()
        ->getMock();

    // example assertion:
    $sessionMock->expects($this->once())
        ->method('clear');

    $client = static::createClient();
    $container = $client->getContainer();
    $container->set('session', $sessionMock);

    $crawler = $client->request('GET', '/api/logout');
    $this->assertTrue($client->getResponse()->isSuccessful());
} 
```

使用此代码，您可以使用会话服务做任何您想做的事情。但是你必须知道两件事：

*   这个模拟将只为一个请求设置（如果你想在下一个请求中使用它，你应该重新设置它）。这是因为客户端在每个请求之间重新启动内核并重建容器。
*   Symfony 2.1 中的会话处理与 Symfony 2 略有不同

编辑：

我添加了一个断言

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-31T17:38:37.230

就我而言，设置就足够了

```
framework:
    session:
        storage_id: session.storage.mock_file 
```

在`config_test.yml`. YMMV，我对我实际上在做什么并没有太多了解，但它对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-30T14:59:53.883

这里只是为了完成 Cyprian 的回复。

正如 Sven 解释的那样，在查看 symfony 的文档[http://symfony.com/doc/2.3/components/http_foundation/session_testing.html](http://symfony.com/doc/2.3/components/http_foundation/session_testing.html)时，您必须使用 MockFileSessionStorage 对象作为第一个构造函数参数来实例化模拟会话。

您需要使用：

```
 use Symfony\Component\HttpFoundation\Session\Storage\MockFileSessionStorage; 
```

代码应该是：

```
 $sessionMock = $this->getMockBuilder('Symfony\Component\HttpFoundation\Session\Session')
        ->setMethods(array('clear'))
        ->disableOriginalConstructor()
        ->setConstructorArgs(array(new MockFileSessionStorage()))
        ->getMock(); 
```

# c# - .NET Collection 用于 2d 网格？

> ID：13693638
> 
> 赞同：1
> 
> 时间：2012-12-03T23:26:16.817
> 
> 标签：c#, .net

我将尝试编写游戏。我的游戏需要在传统游戏网格上运行[A*寻路算法。](http://en.wikipedia.org/wiki/A%2a_search_algorithm)

例如：（S=Start，G=Goal，X=Wall）

```
-------------------------------
|  |  |  |  |  |  |  |  | G|  |
-------------------------------
|  |  |  |  |  |  |  |  |  |  |
-------------------------------
|  | X| X| X| X|  |  |  |  |  |
-------------------------------
|  |  |  |  | X|  |  |  |  |  |
-------------------------------
| S|  |  |  |  |  |  |  |  |  |
------------------------------- 
```

要实现 A*，我需要能够获取任何节点的“邻居”。（例如，Start 有 3 个邻居（Above、Diagonal 和 Right）。）

想到在数据层映射它的方法是二维数组或链表。

该阵列似乎是性能最高且易于实现的。所以如果`S`是`[0][4]`，那么它的邻居将是`[0 + 1][4]`（右），`[0][4 - 1]`（上），`[0 + 1][4 - 1]`（对角线）

但是在进行了几年的 .NET 应用程序开发之后，基本数组对我来说似乎有点过时了。

所以在我走这条路之前，我想我会问是否有一个很好的 .NET 集合类型可以用来绘制一个网格（在数据层，而不是 UI）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:48:34.750

您不需要绘制整个网格。按需为给定节点生成邻居要容易得多。即节点（x，y）的邻居将是`{x-1, x, x+1} x {y-1, y, y+1} - (x, y)`。如果这些点中的任何一个位于网格尺寸之外，则不考虑它们。如果这些位置中的任何一个有墙，您也可以忽略它们。所以现在你只需要考虑如何有效地检查一个位置的墙壁。因为可以在这个特定问题中使用上述方法找到节点的邻居，所以我认为您在这里不需要邻接列表或邻接矩阵。

编辑：在检查某个位置的墙壁时，我曾经使用从坐标到整数的映射来做到这一点。即`(x, y) => x + y*MaxWidth`。您会为每个坐标获得一个唯一的整数。现在，您只需使用该整数将墙壁位置存储在哈希表或类似的东西中即可进行有效查找。如果网格的尺寸相当大，则此方法胜过二维数组表示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:49:30.657

在这种情况下，数组听起来是正确的选择。请记住，提供的大多数数据结构都试图提供不同的功能。

鉴于您需要的唯一抽象方法（邻居）是快速实现，因此没有理由使用任何更复杂的方法作为基础。

# html - createElement 唯一标识符

> ID：13693640
> 
> 赞同：1
> 
> 时间：2012-12-03T23:26:23.807
> 
> 标签：html, image, image-gallery, createelement

我正在用 Html 建立一个小画廊，但遇到了一些麻烦。我有一个循环，每次迭代时都会`for`创建一个。`img`问题是，一旦我生成了所有图像并尝试将唯一变量传递给显示单击图像的其他函数，我就无法传递唯一值。

我可能没有很好地解释它，但如果你运行它，你就会明白我的意思。任何帮助弄清楚我如何获得每个缩略图的唯一标识符将不胜感激。

下面是代码。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script>
function loadPictures(){
    var a = new Array();

    a[0] = '1-m';
    a[1] = '2-m';
    a[2] = '3-m';

    document.getElementById('inWin').innerHTML='<img src="images/1-m.png" width="620px" height="auto" />';

    var ci = document.getElementById('pics');
    var newImg, divIdName;

    for(x=0; x<a.length; x++)
    {
        newImg = document.createElement('img');
        divIdName = 'portrait'+x;
        newImg.setAttribute('id',divIdName);
        newImg.setAttribute('src', 'images/' + a[x] + 'thumb.png');
        newImg.setAttribute('onclick','changeContent(x);'); // for FF
        newImg.onclick = function() {changeContent(x);}; // for IE
        ci.appendChild(newImg); 
    }
}   
</script>

<script>
function changeContent(num){
    alert(num);
    var a = new Array();
    x=num;
    a[0] = '1-m';
    a[1] = '2-m';
    a[2] = '3-m';

    document.getElementById('inWin').innerHTML='<img src="images/'+ a[x] +'thumb.png" width="620px" height="auto" />';
}
</script>
</head>
<body onload="loadPictures()">
<div id="inWin">
</div>
<div id="pics">
</div>
</body>
</html> 
```

*由于我是新会员，无法上传图片，抱歉。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T14:40:26.707

每个图像已经有一个唯一的标识符，ID 属性。您可以通过不同的方式使用它来获得您想要的东西。这是它的样子：

```
<script>

var a = [ '1-m',
          '2-m',
          '3m'
        ];
function loadPictures(){

    document.getElementById('inWin').innerHTML='<img src="images/1-m.png" width="620px" height="auto" />';

    var ci = document.getElementById('pics');
    var newImg, divIdName;

    for(x=0; x<a.length; x++)
    {
        newImg = document.createElement('img');
        divIdName = 'portrait'+x;
        newImg.setAttribute('id',divIdName);
        newImg.setAttribute('src', 'images/' + a[x] + 'thumb.png');
        if(document.addEventListener)
            newImg.addEventListener('click', changeContent, false);
        else if(document.attachEvent)
            newImg.attachEvent('onclick', changeContent);
        ci.appendChild(newImg); 
    }

}   

function changeContent(){

    x = this.id.split('portrait')[1];

    document.getElementById('inWin').innerHTML='<img src="images/'+ a[x] +'.png" width="620px" height="auto" />';
}
</script> 
```

# .htaccess - 一个查询字符串参数 301 重定向到主页

> ID：13693642
> 
> 赞同：0
> 
> 时间：2012-12-03T23:26:41.107
> 
> 标签：.htaccess, redirect

我的问题是指向域而不是主域上的 utm_source=xxx 参数的反向链接太多。
是否可以在我的 htaccess 中进行重写/重定向以重定向`www.mydomain.com/?utm_source=twitterfeed`到`www.mydomain.com`？
因此，无论何时`www.mydomain.com/?utm_source=twitterfeed`运行，它将被重定向到`www.mydomain.com`.

提前感
谢阿亚兹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:16:21.503

基本上你必须删除查询字符串，如下所示：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^utm_source.*$ 
RewriteRule (.*)  http://www.mydomain.com? [L] 
```

尚未测试，但应该可以工作。

**更新**

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^utm_source=twitterfeed.*$ 
RewriteRule (.*)  http://www.mydomain.com? [L] 
```

# wordpress - wordpress 中的基本搜索

> ID：13693644
> 
> 赞同：1
> 
> 时间：2012-12-03T23:26:44.933
> 
> 标签：wordpress, search

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:52:06.893

The important file is search.php, which displays any matching results, or a failure message if there are no matches. Try something like this:

```
<?php
/**
 * Search results page
 */
?>
<?php if ( have_posts() ): ?>
<h2>Search Results for '<?php echo get_search_query(); ?>'</h2> 
<ol>
<?php while ( have_posts() ) : the_post(); ?>
    <li>
            <h2><a href="<?php esc_url( the_permalink() ); ?>" title="Permalink to <?php the_title(); ?>" rel="bookmark"><?php the_title(); ?></a></h2>
            <time datetime="<?php the_time( 'Y-m-d' ); ?>" pubdate><?php the_date(); ?> <?php the_time(); ?></time> <?php comments_popup_link('Leave a Comment', '1 Comment', '% Comments'); ?>
            <?php the_content(); ?>
    </li>
<?php endwhile; ?>
</ol>
<?php else: ?>
<h2>No results found for '<?php echo get_search_query(); ?>'</h2>
<?php endif; ?>

<?php get_sidebar(); ?>
<?php get_footer(); ?> 
```

# ios - 禁用 UIWebView 超链接

> ID：13693646
> 
> 赞同：0
> 
> 时间：2012-12-03T23:27:04.870
> 
> 标签：ios

我的目标是允许 UIWebView 加载初始链接，但不允许任何进一步的导航。

我看到问题：

[禁用 UIWebView 中的超链接](https://stackoverflow.com/questions/1783074/disable-hyperlinks-in-uiwebview)

因此，我从界面生成器连接了引用的 webView 属性。

我指定我的 UIViewController 使用 UIWebViewDelegate：

```
@interface LegalViewController : UIViewController<UIWebViewDelegate> 
```

在代码中，在 viewDidLoad 上，我执行以下操作：

```
 mFirstLoad = TRUE;
 webView.delegate = self; 
```

我有以下代码：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    if (!mFirstLoad)
        return FALSE;

    mFirstLoad = FALSE;
    return TRUE;
} 
```

shouldStartLoadWithRequest 在初始调用和单击链接时都被调用。但是，即使 shouldStartLoadWithRequest 返回 FALSE，UIWebView 仍会继续并加载新页面。

我在 iOS Simulator 6.0 上看到了这个问题

我该如何解决这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:39:07.300

根据类型返回 NO 以排除链接

返回 !(navigationTpe==UIWebViewNavigationTypeLinkClicked);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T06:41:41.690

您的布尔值是否可能以某种方式重置？如果你只返回 NO 会发生什么`(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T22:35:09.440

这是我在评论中写的相同内容：

我想我找到了问题的原因。我不确定如何正确调用它（不是 HTML 和 Javascript 方面的大专家）。但是链接有以下代码：`"<a href="/something" data-transition="flip"</a>`结果，回调被调用，但看起来这个回调的结果被忽略了。

结果最有可能的解决方案在这里：[Remove hyperlinks in uiwebview](https://stackoverflow.com/questions/3880250/remove-hyperlinks-in-uiwebview?rq=1)

# sql - 如何申请加入只有它是必需的

> ID：13693652
> 
> 赞同：1
> 
> 时间：2012-12-03T23:27:19.630
> 
> 标签：sql, sql-server, tsql

我有一个表（例如`Motherboard`），其中包含我正在寻找的值（例如`RAM`）...并假设主板有 2 个字段作为 PK，例如：`model_id`和`part_number`...如果我有 model_id 和所有RAM容量相同我不在乎零件编号。查询将类似于：

```
SELECT Top 1 ram FROM Motherboard WHERE model_id = @model_id 
```

否则，我们必须加入`MyMBInfo`存储该part_number 的表（例如）。

```
SELECT Top 1 ram FROM Motherboard m
    LEFT JOIN MyMBInfo i ON SUBSTRING(i.model_id_and_other_stuff, 1, 9) = m.model_id and i.part_number = m.part_number
    WHERE model_id = @model_id 
```

我总是可以使用第二个查询，但它似乎是一个相当昂贵的（连接、子字符串等）......我有数百万需要计算 Ram 值的主板。

我想应用第一个查询，如果需要，应用第二个查询，因为（在我的数据中）不同部分具有不同 RAM 的概率非常罕见（如 1%）。

如果您可能知道如何编写将这两者结合起来的查询，例如：

```
SELECT Top 1 ram ... WHERE .... distinct_counter > 1 and part_number in SELECT ... FROM MyMBInfo WHERE...) 
```

或者创建一个辅助函数。

请分享。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:44:18.927

一个简单的`IF`就可以了：

```
if (select count(distinct ram) from dbo.Motherboard WHERE model_id = @model_id) = 1
    select ram from dbo.Motherboard WHERE model_id = @model_id 
else 
    SELECT Top 1 ram FROM Motherboard m
            LEFT JOIN MyMBInfo i ON SUBSTRING(i.model_id_and_other_stuff, 1, 9) = m.model_id and i.part_number = m.part_number
            WHERE model_id = @model_id 
```

实际的查询执行计划会因条件而异，因此您应该只推断必要的成本。

*题外话*：我非常赞同@Amadan`SUBSTRING`在你的`JOIN`.

# redis - Redis 按位键

> ID：13693656
> 
> 赞同：0
> 
> 时间：2012-12-03T23:27:29.937
> 
> 标签：redis, bit-manipulation

我正在尝试对 redis 中的键进行一些按位操作。我必须存储键值 12:CA foo 12:US bar 42:CA tag

而且我正在尝试能够使用 CA 查询所有内容或使用 12 查询所有内容这甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:31:08.460

我可能误解了这个问题，但如果你有 key => 值，比如

```
12:CA => foo
12:US => bar
42:CA => tag 
```

并且您想提取所有匹配 CA 或 12 的密钥，那么您可以只使用密钥运算符和通配符

```
keys *:CA
keys 12:* 
```

**注意**这只会返回匹配的键。要获取值，您需要使用返回的键。

# jquery - Jquery Masonry 布局，强制内容进入特定列

> ID：13693663
> 
> 赞同：2
> 
> 时间：2012-12-03T23:27:53.747
> 
> 标签：jquery

我正在使用砖石进行布局。我只为内容框使用了 2 个 div 宽度，240 像素和 500 像素。我想做的总是将 500px 的框强制到布局的中间，所以我有一个更有序的薄厚薄的布局。我创建了一个 jpeg 来演示我想要实现的目标。

![在此处输入图像描述](../Images/8a614c91b25cdf2449638df5cdce4f6e.png)

我深入研究了 jquery.masonry.js 文件的代码，试图弄清楚。到目前为止，我取得的最好成绩是操纵 div 的 X 位置，但是当我这样做时，它不会调整 Y 位置并且会抛出进一步 div 的高度计算。查询不是我的第一语言，我很难弄清楚每列的 Y 高度是如何计算的。以前有人挖过砖石吗？

我所取得的成就是：

```
 if($brick.width() === 240) { 
      //code here to make sure this div's x position is either 5 or 785

     if($brick.width() > 260) { 
     //code here to make sure this divs x position is set at 265 
```

但是在我重新定位这些 div 之后，Y pos 被丢弃，并且当我遍历内容时，进一步的 div Y pos 将被关闭。

你可以在这里看到原始的完整砌体js：[https ://github.com/desandro/masonry/blob/master/jquery.masonry.js](https://github.com/desandro/masonry/blob/master/jquery.masonry.js)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-06T18:47:48.067

添加`horizontalOrder: true`到您的函数中，它将强制从左到右。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-27T00:52:50.143

我的建议是创建 3 个砖石容器；左，中，右。虽然我不完全确定你为什么使用砖石，但对于这个简单的布局来说似乎是最重要的。我想它让响应式网站更容易，但我相信你可以用 CSS 实现你的 jpeg。

# mysql - 无法在 MYSQL 5.5 w/MYSQL Workbench 中更改模式名称

> ID：13693665
> 
> 赞同：23
> 
> 时间：2012-12-03T23:28:03.027
> 
> 标签：mysql, database, schema, mysql-workbench

为什么我不能从 MYSQL Workbench 更改我的模式名称？我错过了什么吗？:(

如您所知，名称已禁用

![在此处输入图像描述](../Images/b6cf66091069171ab25690473b52c340.png)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-04T00:26:29.753

没有可用于模式名称的 RENAME。您必须导出架构，然后使用新的数据库名称导入。

这是 MySQL 服务器本身的限制。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-03-23T19:20:55.317

实际上，您可以很容易地重命名数据库名称，

1.  转到顶部菜单 -> 数据库 -> 逆向工程，选择您的数据库并继续前进，直到您获得数据库的 er 图，
2.  在下面有一个名为 Catalog Area 的区域之后，您可以看到您的数据库名称，右键单击该区域并选择编辑模式。并更改您的数据库名称
3.  现在再次转到顶部菜单 -> 数据库 -> 正向工程并使用向导完成数据库工程。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-08-20T05:34:59.583

我无法想象有人仍在使用 5.5 版，但这是我在 8 版中遵循的过程。如果您确实有旧/新版本，这可能仍然有效。

1.  连接到数据库。
2.  打开数据库菜单并选择迁移向导。
3.  开始迁移。
4.  源和目标都将是当前的 MySQL 服务器。
5.  选择要重命名的架构。
6.  对于源对象，请确保选择所有表。
7.  单击下一步，您将看到源和目标相同的消息。
8.  现在您应该看到“手动编辑”步骤。
9.  在目标对象列下，单击数据库名称并进行更改。
10.  现在您可以一直单击下一步。
11.  完成后，您将拥有一个新重命名的架构。

> 目前我的数据库没有索引、存储过程等。在删除旧数据库之前，您需要确认所有相关对象都已迁移。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-04T20:16:27.907

Gavin 是对的，但是如果你的服务器有 phpMyAdmin，你可以用它来重命名你的数据库（模式）：

1.  转到您的 phpMyAdmin URL。默认为[http://yourdomain.com/phpMyAdmin/](http://yourdomain.com/phpMyAdmin/)

2.  如果出现提示，请输入您的数据库用户名和密码。

3.  单击“操作”选项卡。

4.  在“将数据库重命名为：”下写下您的新数据库名称。

5.  单击“开始”按钮。

6.  如果出现提示，请单击“确定”。

7.  几秒钟后，根据您的数据库内容，您将重命名数据库。

phpMyAdmin 实际上在做的是用你的新名字创建一个新的数据库，从你当前的数据库中导入内容并删除你当前的数据库。

# sql - 优化查询组合子查询

> ID：13693666
> 
> 赞同：0
> 
> 时间：2012-12-03T23:28:06.523
> 
> 标签：sql, sql-server, subquery

我有一个 SQL Server 数据库，我需要存储未知数量的列，所以我有 2 个这样的表：

1.  表`Master`，包含这些列：（`id, data1, data2`固定列）
2.  `unknown_fields`包含这些列的表：`id_master_record, id_field, value_field`

我做这样的查询：

```
SELECT id, data1, data2, 
  (SELECT value_field FROM unknown_fields
    WHERE id_master_record = Master.id AND id_field = 1) AS data3
  (SELECT value_field FROM unknown_fields 
    WHERE id_master_record = Master.id AND id_field = 2) AS data4
  (SELECT value_field FROM unknown_fields 
    WHERE id_master_record = Master.id AND id_field = 3) AS data5
 ... SO for each 
FROM Master 
```

我想知道是否有更好的方法来做这个查询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:47:48.120

你可以试试这个，它可能会稍微快一点。最好两个都测试。对第二个表进行聚类`(id_master_record, id_field)`可能会对这两个查询都有帮助。

```
Select
  m.id,
  m.data1,
  m.data2,
  Max(Case u.id_field When 1 Then u.value_field End) As data3,
  Max(Case u.id_field When 2 Then u.value_field End) As data4,
  Max(Case u.id_field When 3 Then u.value_field End) As data5
From
  xmaster m
    Left Outer Join
  unknown_fields u
    On m.id = u.id_master_record
Group By
  m.id,
  m.data1,
  m.data2; 
```

您也可以尝试使用[Pivot](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)

```
Select
  id,
  data1,
  data2,
  [1] as data3,
  [2] as data4,
  [3] as data5
From (
  Select
    m.id,
    m.data1,
    m.data2,
    id_field,
    value_field
  From
    Master m
      left outer join
    unknown_fields u
      On m.id = u.id_master_record
    ) as s
Pivot (
  max(value_field)
For 
    id_field In ([1], [2], [3])
) As p; 
```

[http://sqlfiddle.com/#!6/f9bca/11](http://sqlfiddle.com/#!6/f9bca/11)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T10:47:38.120

您的初始查询是完成您需要的相当好的方法，相反我可能会建议您查看查询执行计划，并尝试提高 field_id 上的索引，也许这会加快您的查询速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T00:11:27.783

另一种可能的重写：

```
SELECT Master.id, Master.data1, Master.data2, 
       u3.value_field AS data3,
       u4.value_field AS data4,
       u5.value_field AS data5,
       ... so for each 
FROM Master
  LEFT JOIN unknown_fields AS u3
    ON  u3.id_master_record = Master.id 
    AND u3.id_field = 1
  LEFT JOIN unknown_fields AS u4
    ON  u4.id_master_record = Master.id 
    AND u4.id_field = 2
  LEFT JOIN unknown_fields AS u5
    ON  u5.id_master_record = Master.id 
    AND u5.id_field = 3
  ... so for each  ; 
```

如果您想优化性能，您应该检查各种重写的执行计划，并在您的服务器中使用您的数据进行测试。表上的索引对于效率至关重要。聚集索引的选择，尤其是表的选择`unknown_fields`也会影响这个查询。

`unknown_fields`are`(id_master_record, id_field, value_field)`和 the（不同排序）的两个可能索引：`(id_field, id_master_record, value_field)`

# c# - 对于每个类别，显示其子类别

> ID：13693671
> 
> 赞同：1
> 
> 时间：2012-12-03T23:28:45.633
> 
> 标签：c#, asp.net, sql-server

我对 SQL 和 asp.net 有点陌生，正在尝试创建一个论坛应用程序。我创建了两个表。我正在使用此查询选择表中的数据：

```
SELECT 
    forum_categories.CategoryName, forum_subcategories.SubCategoryName  
FROM     
    forum_categories  
LEFT JOIN 
    forum_subcategories ON forum_categories.CategoryId = forum_subcategories.CategoryId 
```

![在此处输入图像描述](../Images/a033cdbb66b5701fb54523eaaa764f19.png)

这是查询返回的内容：

![在此处输入图像描述](../Images/a75a2a87d1a3847f626e7e38454cab5b.png)

现在我需要的是每个 CategoryName 我需要显示它的子类别。我为此使用 ListView：

```
<asp:ListView ID="ListView1" runat="server" DataSourceID="ForumDataSource">
    <ItemTemplate>
        <div id='<%#Eval("CategoryName") %>' class="PostCategories">
            <h2><asp:Label ID="Label1" runat="server" Text='<%#Eval("CategoryName") %>'></asp:Label></h2>
            <table class="ForumPosts">
                <thead>
                    <td>Category</td>
                    <td>Posts</td>
                    <td>Last Post</td>
                </thead>
                <tbody>
                    <tr>
                        <td><asp:Label ID="Label2" runat="server" Text='<%#Eval("SubCategoryName") %>'></asp:Label></td>
                    </tr>
                </tbody>
            </table>
       </div>           
    </ItemTemplate>
    <EmptyDataTemplate>
        <p>No Data Found</p>
    </EmptyDataTemplate>
</asp:ListView>
<asp:SqlDataSource ID="ForumDataSource" runat="server" 
    ConnectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\ASPNETDB.MDF;Integrated Security=True;User Instance=True" 
    ProviderName="System.Data.SqlClient" 
    SelectCommand="SELECT forum_categories.CategoryName, forum_subcategories.SubCategoryName FROM forum_categories  LEFT JOIN forum_subcategories ON  forum_subcategories.CategoryId = forum_categories.CategoryId">
</asp:SqlDataSource> 
```

现在每个人都可能已经从代码中了解到这将返回 8 个表。

我想得到的是每个类别都显示它的子类别数据。在这种情况下，应该只有 3 个表

我应该如何解决这个问题？

这应该使用 SQL 解决还是使用服务器端语言处理接收到的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T04:34:26.743

我不是 ListViews 的忠实粉丝。不过你可以试试这个

您需要两个列表视图。外部列表视图和内部列表视图。

外层将遍历类别，因此它应该只给你三个表。确保只选择不同的。

然后内部列表视图将遍历每个 CategoryID 并获取链接到 CategoryID 的子类别。

# regex - 带前导零的正则表达式

> ID：13693672
> 
> 赞同：3
> 
> 时间：2012-12-03T23:29:06.213
> 
> 标签：regex

我对正则表达式比较陌生，需要一个简单表达式的帮助。我正在使用 Pentaho 进行 ETL（字符串转换中的替换），并且我有列值，我需要将前导零添加到并解析出作为数据库导入的一部分的文本。到目前为止，我一直无法添加前导零。

该列称为**Region**，值为**"region 8"**、**"region 10"**、**"region 11"**。我的正则表达式是 ['Region'] 它将消除区域文本但产生结果 =“8”、“10”、“11”。我需要产生“08”、“10”、“11”的值。所以所有个位数的数字都必须有前导零。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T01:55:02.123

分两步使用前瞻：

```
Regex 1:   region (?=\d\D)
Replace 1: 0

Regex 2:   region (?=\d\d)
Replace 2: (nothing) 
```

向前看是不消耗的，因此您不必为反向引用等而烦恼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:33:00.520

```
s/^region[0-9][0-9]$/region
s/^region\([1-9]\)$/region0\1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:47:06.253

您必须使用反向引用和多次检查，但这是可能的。这是一个使用 JavaScript 的示例：

```
"region 8".replace(/\D/g, '').replace(/^(\d)$/, '0$1');
//returns "08"

"region 18".replace(/\D/g, '').replace(/^(\d)$/, '0$1');
//returns "18"

"region 188".replace(/\D/g, '').replace(/^(\d)$/, '0$1');
//returns "188" 
```

第一步是删除所有非数字字符`.replace(/\D/g, '')`并将任何单个数字替换为 0 后跟自身。您可以使用反向引用 ( `$1`) 来执行此操作：`.replace(/^(\d)$/, '0$1')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T11:02:42.153

Javascript 示例使用匿名函数来检查捕获的数字的值，`0`如果它小于 10，则将 a 添加到返回值。例如：

```
column = "region 8";

column.replace(/region (\d+)/, function(s, p1){return parseInt(p1) < 10 ? '0' + p1 : p1}); 
```

该函数将整个匹配的字符串`s`和捕获的部分`p1`作为参数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T12:16:32.857

一种 perl 方法：

```
while(<DATA>) {
    chomp;
    s/\D+//g;
    printf("%02d\n", $_);
}

__DATA__
region 8
region 10
region 11 
```

**输出：**

```
08
10
11 
```

# git - git文件没有从heroku中删除

> ID：13693676
> 
> 赞同：0
> 
> 时间：2012-12-03T23:29:40.737
> 
> 标签：git, heroku

我有一个正在尝试加载到heroku 的应用程序，并且我删除了一个名为variations.rb 的文件。

我跑去`git -u`更新目录并删除文件，然后`git add .`我用`git commit -m "removed the error causing file"`.

当我运行`git ls-files`它时，有问题的文件`admin/variety.rb`不在列表中。然后我推到heroku，并得到错误

```
2012-12-03T23:08:32+00:00 应用程序 [web.1]:/app/app/admin/varieties.rb:1:in
 `': 未初始化的常量 Variety (NameError)

```

这让我相信，由于某种原因，在推送到 heroku 时，heroku 只是更新文件，而不是删除已删除的文件。

push 命令不应该同步所有文件，而不仅仅是更新吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:00:49.643

显然`git add -A`解决了这个问题。不知道为什么，据我了解，它与`git add -U`后面的相同`git add .`

# php - 如何从模型中提取变量以在 CodeIgniter 中的控制器上使用？

> ID：13693679
> 
> 赞同：0
> 
> 时间：2012-12-03T23:29:45.963
> 
> 标签：php, oop, codeigniter

我试图在我的控制器中使用一个在我的模型中创建的变量。

这是模型：

```
public function validate_retrieve($data) {

            $query = $this->db->where($data)->get('users', '1');

            foreach ($query->result() as $user)
            {
                $user->email;
                $user->salt;
                $user->id;

            }

            $token = sha1($user->email.$user->salt).dechex($user->id);
            $reset_token = array(
                'token' => $token,
                'email' => $user->email
            );

            $insert = $this->db->insert('reset', $reset_token, '1');
            return $reset_token;
        } 
```

在我的控制器上，我尝试使用`$token`在模型中创建的控制器：

```
public function retrieve()
        // REQUEST PASSWORD RESET
        // LOADED WHEN THE FORM IS SUBMITTED OFF THE PASSWORD PAGE AND SENDS THE EMAIL WITH TOKEN AND INSTRUCTIONS
        {
            $this->load->library('form_validation');
            $this->load->library('session');
            $this->form_validation->set_rules('email', 'Email', 'trim|required|valid_email');
            $this->load->model('user_model', 'um');
            $this->load->library('encrypt');
            $this->load->helper('url');
            $submit = $this->input->post('submit');
            $salt = $this->_salt();

            if($submit)
            // IF THE SUBMIT BUTTON IS SET
            {

                // START PROCESS TO CREATE $USER VARIABLE THAT HOLDS WHAT THE USER ENTERED IN THE FORM AND THAT CAN GET CHECKED AGAINST THE DB IN THE MODEL
                $user = $this->um->validate_retrieve(array('email' => $this->input->post('email')));

                // IF THE USER IS CREATED AND CHECKS OUT AND ALL OF THE ERRORS ARE CLEARED ON THE FORM
                if( $user && $this->form_validation->run() == TRUE ) {

                    $domain = "clci.dev/index.php";

                    // CREATE A TOKEN LINK TO SEND TO THE USERS EMAIL THAT EXIST IN THE DB AND WAS ENTERED

                    $token = $this->um->token;
                    $link = "http://www.".$domain."/auth/reset/?token=$token";

                        $this->load->library('email');

                        $this->email->from('noreply@cysticlife.org', 'CysticLife');
                        $this->email->to($this->input->post('email')); 

                        $this->email->subject('Reset Password');
                        $this->email->message("Please go to the following web address to reset your password:\n\n$link\n\n-Your friends at CysticLife\n\nPlease remember to add the cysticlife.org domain to your address book to ensure that you receive your CysticLife e-Notifications as requested.");  

                        $this->email->send();
                        redirect('auth/success');
                        exit;

                    }
                    $this->form_validation->run() == FALSE;
                    $data['main_content'] = 'auth/password';
                    $this->load->view('includes/templates/main_page_template', $data);
                    $data['email_error'] = 'This email is invalid';
                }
            } 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:33:46.740

您正在尝试将数组作为对象访问。

```
$reset_token = $this->um->validate_retrieve($whatever_id);
$token = $reset_token['token']; 
```

这就是您访问此函数返回结果的令牌部分的方式。

根据您的最新更新，您实际上可以像这样访问它：

```
$token = $user['token']; 
```

因为在以下行中，您将 validate_retrieve 方法的结果分配给变量 $user：

```
$user = $this->um->validate_retrieve(array('email' => $this->input->post('email'))); 
```

# java - 如果正在读取的文件格式不正确，请关闭程序？

> ID：13693681
> 
> 赞同：-1
> 
> 时间：2012-12-03T23:29:53.917
> 
> 标签：java, error-handling, assertions

我的程序读取用户选择的文件。编辑：该文件在一行中包含 4 个字符的字符串、4 位整数和 char（按此顺序），行数未公开。

如果其中一个格式错误或丢失，程序需要提供错误消息并关闭。

我将如何检查错误？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:34:00.687

You can try parsing the content of the file within a try/catch bracket and if an exception is caught you display an error message and exit by with `System.exit(0)`;

```
try {
    //parsing
}
catch (Exception e) {
    System.out.prinln("Error message");
    System.exit(0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:40:12.473

为了实现您的目标，您应该阅读自己的*正则表达式*和*java*中的错误处理。

然后，您可以使用正则表达式检查您输入的天气格式是否正确，最后，如果需要，抛出一个自定义异常，告诉大家发生了什么。

[正则表达式](http://www.vogella.com/articles/JavaRegularExpressions/article.html)

# xcode - Xcode、LLVM 4.1、NSMutableArray、循环中未使用的块崩溃。为什么？

> ID：13693682
> 
> 赞同：0
> 
> 时间：2012-12-03T23:29:55.573
> 
> 标签：xcode, loops, nsmutablearray, block, llvm

这是我的第一篇文章。我为错误道歉。

我有一个可以修复的崩溃，但我不明白为什么它首先会崩溃。我试图将代码简化为使其崩溃的基本要素：

```
GCFTile *currentTile;
NSInteger repeatCount = 0;
do {

    currentTile = self.remainingTilesArray[0];
    if (repeatCount == 0) {

        [self.remainingTilesArray removeObjectAtIndex:0];
        [self.remainingTilesArray addObject:currentTile];
    }
    void (^myBlock)() = ^{

        currentTile;
    };
    repeatCount++;
} while (repeatCount == 1); 
```

我正在使用 Xcode 4.5.2、iOS 5、ARC。此外，仅当 LLVM 编译器优化设置为“快速”或更高时，它才会崩溃。

上面的代码将从 NSMutableArray 中获取和删除一个对象，将其放回原处，然后从数组中获取另一个对象。*上面的代码将运行而不会崩溃*，但是如果我稍后扫描数组中的所有元素（例如，从不同的方法），那么它就会崩溃。看起来随机内存地址被添加到数组中（可能来自上面对 addObject 的调用）。

上面的块应该什么都不做，但如果我改变它，那么以后就不会崩溃了。（例如，空块 = 没有崩溃。不要将块声明为“myBlock” = 没有崩溃。）如果我不重复循环，就没有崩溃。如果我不重新添加对象，则不会发生崩溃。如果我使用 __block 或在 do 循环中声明 currentTile，则不会发生崩溃。

我知道块是“堆栈本地的”，但这个块没有做任何事情！它运行良好，无需编译器优化。

知道发生了什么吗？

编辑（12-5-12）：有人要求提供崩溃日志。我正在模拟器中运行，所以我不知道如何获得它。但这里有一些来自 Debug Navigator 的内容：

```
#0  0x0140409b in objc_msgSend ()
#1  0x00010931 in __33-[GCFGame checkThatTilesAreValid]_block_invoke_0 at /Users/geoffrey2/personal/projects/Color Fever/Color Fever/GCFGame.m:54
#2  0x01cb24a5 in __NSArrayEnumerate ()
#3  0x01cb2026 in -[NSArray enumerateObjectsWithOptions:usingBlock:] ()
#4  0x01cb1f35 in -[NSArray enumerateObjectsUsingBlock:] ()
#5  0x000108f6 in -[GCFGame checkThatTilesAreValid] at /Users/geoffrey2/personal/projects/Color Fever/Color Fever/GCFGame.m:52 
```

并且主窗口显示了这一点（加上更多行）：

```
libobjc.A.dylib`objc_msgSend:
0x140408c:  movl   8(%esp), %ecx
0x1404090:  movl   4(%esp), %eax
0x1404094:  testl  %eax, %eax
0x1404096:  je     0x14040e8                 ; objc_msgSend + 92
0x1404098:  movl   (%eax), %edx
0x140409a:  pushl  %edi
0x140409b:  movl   8(%edx), %edi 
```

错误是`EXC_BAD_ACCESS(code=2, adddress=0x9).`

# playframework - 持久化嵌入式哈希映射

> ID：13693687
> 
> 赞同：0
> 
> 时间：2012-12-03T23:30:43.467
> 
> 标签：playframework, siena

下面的值“.2F”不会保留。我没有收到任何错误，但只返回 null。您能否建议对以下代码进行更正或改进？我正在尝试将其保存在 GAE 测试数据库中。

我在尝试使用 EmbeddedMap 时留下了评论，但是，我认为这没有必要，因为我使用的是具有简单类型的 Map。

```
public class UserBeanApp extends Model {

    private static final long serialVersionUID = 1L;

    @Id(Generator.AUTO_INCREMENT)
    public Long id;

    @Unindexed
    private RequiredReturnsBean requiredReturns;

    public RequiredReturnsBean getReqRetBean() {
        if (requiredReturns == null)
            requiredReturns = new RequiredReturnsBean();
        else
            requiredReturns.get();

        return requiredReturns;
    }
}

public class RequiredReturnsBean extends Model {

    @Id(Generator.AUTO_INCREMENT)
    public Long id;

    // @EmbeddedMap
    // public static class RequiredReturn {
    // public RequiredReturn(Float requiredReturn) {
    // this.val = requiredReturn;
    // }
    //
    // public Float val;
    // }

    @Unindexed
    @Embedded
    public Map<Long, Float> requiredReturn = new HashMap<Long, Float>();

    public Map<Long, Float> getReqRetMap() {
        if (requiredReturn == null) {
            requiredReturn = new HashMap<Long, Float>();
        }

        return requiredReturn;
    }

} 
```

... 创造 ...

```
UserBeanApp bean = get....//already persisted
RequiredReturnsBean rrBean = bean.getReqRetBean();
rrBean.getReqRetMap().put(1L, .2F);
rrBean.save(); 
```

... 选择 ...

```
UserBeanApp bean = get....//already persisted
RequiredReturnsBean rrBean = bean.getReqRetBean();
requiredReturn = rrBean.getReqRetMap().get(1L);//always null 
```

gae-1.6.0 锡耶纳-2.0.6

# orm - FluentData IDbContext 的生命周期

> ID：13693688
> 
> 赞同：1
> 
> 时间：2012-12-03T23:30:47.527
> 
> 标签：orm, fluentdata

我在我的数据访问层中使用 FluentData ORM for .NET。但是，这个问题可能适用于大多数 ORM。

IDbContext 的正确寿命是多少？每次执行对数据库的新查询时是否应该实例化一个新的数据库上下文？我有以下两种情况，哪个是正确的用法？请注意，我正在查询 MS SQL 以及 MySQL 服务器。所以，我想知道是否有任何影响达到最大连接数。是的，我在多个线程上调用数据库。这两种情况都是线程安全的吗？

情景一：

我的存储库类实现了 IDisposable 并拥有一个 IDbContext 类型的私有变量。这个变量在构造函数中被实例化，并在类被释放时被释放。存储库中只有一个上下文实例。

场景 B：

我的存储库类有一个私有方法，它返回一个新的 IDbContext 实例。每当另一个方法调用数据库时，它们都会调用此方法来获取新的数据库上下文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:27:37.640

来自官方文档：

* * *

**你应该什么时候处理？**

*   如果您启用了 UseTransaction 或 UseSharedConnection，则必须释放 DbContext。
*   如果您启用了 UseMultiResult（或 MultiResultSql），则必须释放 DbCommand。
*   如果启用了 UseMultiResult，则必须释放 StoredProcedureBuilder。

在所有其他情况下，处置将由 FluentData 自动处理。这意味着数据库连接在查询执行前打开，在执行完成后关闭。

* * *

[http://fluentdata.codeplex.com/documentation#Dispose](http://fluentdata.codeplex.com/documentation#Dispose)

希望它可以帮助某人。

# c - WIN32 内存宏与 cstring 内存操作的区别？

> ID：13693693
> 
> 赞同：2
> 
> 时间：2012-12-03T23:31:14.513
> 
> 标签：c, winapi, visual-c++

c 中的内存块操作（例如 memcpy）允许优化操作以移动或清除内存块。我最近发现 WIN32 API 提供的宏支持类似但不完全相同的功能，例如 ZeroMemory。我不知道区别并希望找出答案。 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa366920(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366920(v=vs.85).aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:33:25.357

`ZeroMemory`是一个调用的宏`memset`，`CopyMemory`是一个调用的宏`memcpy`，等等。所以，根本没有区别。

# wpf - 像飘落的雪花一样移动元素

> ID：13693694
> 
> 赞同：8
> 
> 时间：2012-12-03T23:31:27.943
> 
> 标签：wpf, vb.net

我发现[了一个有趣的程序](http://www.softwareok.com/?seite=Freeware/DesktopSnowOK)，它可以让你[在桌面和窗口上覆盖雪花](http://www.youtube.com/watch?v=fuv8MsnssX8)。作为一项编程挑战，我有兴趣自己尝试弄清楚如何做到这一点。更不用说这个程序有点占用内存（如果它没有内存泄漏的话）。下面是我的开始。我正在尝试用一张图片来了解基础知识，然后再进行扩展。

我真正需要帮助的是使图像移动更流畅自然。

* * *

编辑：

我在答案部分的下方发布了一个解决方案，但它比我想要的 CPU 密集度更高，有什么想法吗？

* * *

WPF XAML 代码：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    AllowsTransparency="True"
        WindowStyle="None"
    Title="MainWindow" Height="350" Width="525" Background="Transparent" Topmost="True" WindowState="Maximized" ResizeMode="NoResize">
    <Grid Name="grid1">
        <Image Height="26" HorizontalAlignment="Left" Margin="{Binding flakeMargin}" Name="Image1" Stretch="Fill" VerticalAlignment="Top" Width="28" Source="/snowTest;component/Images/blue-pin-md.png" />
    </Grid>
</Window> 
```

VB代码：

```
Imports System.ComponentModel

    Class MainWindow
        Dim bw As BackgroundWorker = New BackgroundWorker
        Dim flake0 As New flake

        Private Sub Window_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
            grid1.DataContext = flake0
            AddHandler bw.DoWork, AddressOf backgroundMover
            bw.RunWorkerAsync()
        End Sub

        Private Sub backgroundMover(ByVal sender As Object, ByVal e As System.ComponentModel.DoWorkEventArgs)
            While (True)
                flake0.move()
                System.Threading.Thread.Sleep(100)
            End While
        End Sub
    End Class 
```

薄片类：

```
Imports System.ComponentModel

Public Class flake
    Implements INotifyPropertyChanged

    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

    Private Sub NotifyPropertyChanged(ByVal info As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
    End Sub

    Private Property startLeft As Integer = 300
    Private Property left As Integer = left
    Private Property top As Integer = 100
    Private Property speed As Integer = 1

    Public ReadOnly Property flakeMargin As Thickness
        Get
            Return New Thickness(left, top, 0, 0)
        End Get
    End Property

    Public Sub move()
        top += speed
        left = (Math.Cos(top - 100)) * 6 + startLeft
        NotifyPropertyChanged("flakeMargin")
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:20:37.630

这是我目前提出的解决方案：最终最大的校正因素是我使用了画布，它允许我以非整数增量移动，并且我还更有效地使用了 cos 函数。它比我想要的 CPU 密集度更高（25-30%）。有没有人对减少对CPU的影响有任何想法？

WPF/XAML：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    AllowsTransparency="True"
        WindowStyle="None"
    Title="MainWindow" Height="350" Width="525" Background="Transparent" Topmost="True" WindowState="Maximized" ResizeMode="NoResize">
    <Canvas Name="canvas1">

    </Canvas>
</Window> 
```

VB.NET 主窗口：

```
Imports System.ComponentModel

Class MainWindow

    Dim bw As New BackgroundWorker
    Dim flakes(17) As flake

    Private Sub Window_Loaded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
        For i = 0 To flakes.Count - 1
            flakes(i) = New flake
            flakes(i).image.DataContext = flakes(i)
            flakes(i).image.SetBinding(Canvas.LeftProperty, "left")
            flakes(i).image.SetBinding(Canvas.TopProperty, "top")
            canvas1.Children.Add(flakes(i).image)
        Next

        AddHandler bw.DoWork, AddressOf backgroundMover
        bw.RunWorkerAsync()
    End Sub

    Private Sub backgroundMover()
        While (True)
            For Each f In flakes
                f.move()
            Next
            System.Threading.Thread.Sleep(50)
        End While
    End Sub
End Class 
```

VB.Net 薄片类：

```
Imports System.ComponentModel

Public Class flake
    Implements INotifyPropertyChanged

    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

    Private Sub NotifyPropertyChanged(ByVal info As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
    End Sub

    Private Property startLeft As Double
    Private Property _left As Double
    Private Property _top As Double
    Private Property speed As Double
    Private Property amplitude As Double
    Private Property period As Double
    Public Property image As New Image
    Private Shared Property r As New Random

    Public Sub New()
        _image.Width = 28
        _image.Height = 26
        _image.Source = New System.Windows.Media.Imaging.BitmapImage(New Uri("/snowTest;component/Images/blue-pin-md.png", UriKind.Relative))
        startFresh()
    End Sub

    Public ReadOnly Property left As Double
        Get
            Return _left
        End Get
    End Property

    Public ReadOnly Property top As Double
        Get
            Return _top
        End Get
    End Property

    Public Sub startFresh()
        _top = -30
        amplitude = r.Next(5, 35)
        period = 1 / r.Next(20, 60)
        speed = r.Next(15, 25) / 10
        startLeft = r.Next(0, System.Windows.SystemParameters.PrimaryScreenWidth)
    End Sub

    Public Sub move()
        If _top > System.Windows.SystemParameters.PrimaryScreenHeight Then
            startFresh()
        Else
            _top += speed
            _left = amplitude * Math.Cos(period * _top) + startLeft
        End If

        NotifyPropertyChanged("top")
        NotifyPropertyChanged("left")
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T03:35:29.577

为什么你自己移动它而不是使用动画？

如果你使用 WPF 的动画（这在 Expression Blend 中很容易做到），我认为你会得到你想要的平滑度，并且你可以获得一些运动变化，使它更真实。

[WPF 表达式混合视频](http://expression.microsoft.com/en-us/cc197141)

[基础动画](http://expression.microsoft.com/en-us/cc263921)

# sql-server - 在 TSQL 中聚合通用列

> ID：13693699
> 
> 赞同：2
> 
> 时间：2012-12-03T23:31:53.013
> 
> 标签：sql-server, tsql

我们有一个表格，可以收集连接到嵌入式计算机的传感器的计数。我有一个具有以下架构的表：

```
CREATE TABLE Demo (
  PKColumn BIGINT
  , FKColumn INT
  , ...
  , EventDateTime DATETIME
  , Count1 INT
  , Count2 INT
  , Count3 INT
  , Count4 INT
) 
```

问题是，对于 FKColumn = 1，净计数将是 (Count1 + Count3) - (Count2 + Count4)。但对于 FKColumn = 2，净计数将为 (Count2 + Count4) - (Count1 + Count3)。数据从嵌入式计算机流入，根据该计算机上传感器的校准方式，我们可以对每个计数的含义有不同的定义。

幸运的是，一旦安装了传感器，它们就永远不会改变。

不幸的是，传感器的安装方式缺乏控制……这就是问题所在。

由于每个 FKColumn 值的每个列的定义可能不同，因此构建聚合函数的最高效方式是什么。我正在考虑使用一个映射表来定义每个 FKColumn 的每个传感器是什么，但是当我构建该解决方案时，看起来每个计算的查找都会花费太多。

数据库在 Azure 中运行，因此没有 CLR 函数。

有没有其他人遇到过这种情况？你是怎么解决的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T00:07:28.067

像这样创建一个映射表：

```
CREATE TABLE Map
(
  PKColumn INT NOT NULL 
  , Count1 INT NOT NULL 
  , Count2 INT NOT NULL 
  , Count3 INT NOT NULL 
  , Count4 INT NOT NULL 
) 
```

根据您的示例，填充：

```
INSERT INTO MAP (Count1, Count2, Count3, Count4)
VALUES (1, -1, 1, -1)

INSERT INTO MAP (Count1, Count2, Count3, Count4)
VALUES (-1, 1, -1, 1) 
```

然后创建一个视图：

```
CREATE View DemoSum
AS
SELECT CountSum = (m.Count1*d.Count1 + m.Count2*d.Count2 + 
                   m.Count3*d.Count3 + m.Count4*d.Count4)
       , d.PKColumn
       , d.FKColumn
FROM Demo d
INNER JOIN Map m ON m.PKColumn = d.FKColumn 
```

[您可能需要考虑 Demo 表计数列中的空值。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T00:08:44.070

我认为您需要创建一个名为 multipliers 的表，其结构类似于：

```
CREATE TABLE multipliers (
 FKColumn INT NOT NULL PRIMARY KEY,
 Mult1 INT,
 Mult2 INT,
 Mult3 INT,
 Mult4 INT) 
```

然后将 Mult1 到 Mult4 的值定义为 1 或 -1。对于提供的示例，值将是：

```
INSERT INTO multipliers (FKColumn, Mult1, Mult2, Mult3, Mult4) 
VALUES(1, 1, -1, 1, -1);
INSERT INTO multipliers (FKColumn, Mult1, Mult2, Mult3, Mult4) 
VALUES(2, -1, 1, -1, 1); 
```

然后你所要做的就是加入表格：

```
SELECT a.FKColumn, 
Count1 * Mult1 + Count2 * Mult2 + Count3 * Mult3 + Count4 * Mult4 AS net
FROM Demo a, multipliers b 
WHERE a.FKColumn = b.FKColumn 
```

# php - 删除关联数组中的键不起作用

> ID：13693700
> 
> 赞同：3
> 
> 时间：2012-12-03T23:32:28.700
> 
> 标签：php, arrays, associative-array

我试图只保留某些键，并从外部 API 中删除其余键。我有一个数组（[http://pastebin.com/vU8T4y7h](http://pastebin.com/vU8T4y7h)），包含对象的“数据”：

```
foreach ($data as $media) {
    foreach (array_keys($media) as $media_key) {
        if ($media_key!=="created_time" && $media_key!=="likes" && $media_key!=="images" && $media_key!=="id") {
            unset($media[$media_key]);
        }
    }
} 
```

在这种情况下，我试图只保留`created_time`、`likes`、`images`和`id`键，但是，上面的代码不起作用。关于为什么的任何想法？还有其他优雅的解决方案来实现同样的目标吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T23:38:23.863

这不起作用的原因是因为您没有从原始`$data`对象中取消设置。您可以通过以下两种方式之一修复它。通过引用访问或更新您`unset`以对原始`$data`对象进行操作。

使用参考：

```
foreach($data as &$media) { 
```

取消设置`$data`

```
unset($data[$media][$media_key]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:39:02.860

foreach 创建每个数组元素的**副本**，因此取消设置 $media[$media_key] 只会从副本中取消设置；并且您想从原始 $data 数组中取消设置：

```
foreach ($data as $mediaRef => $media) {
    foreach (array_keys($media) as $media_key) {
        if ($media_key!=="created_time" && $media_key!=="likes" && $media_key!=="images" && $media_key!=="id") {
            unset($data[$mediaRef][$media_key]);
        }
    }
} 
```

或（通过引用）

```
foreach ($data as &$media) {
    foreach (array_keys($media) as $media_key) {
        if ($media_key!=="created_time" && $media_key!=="likes" && $media_key!=="images" && $media_key!=="id") {
            unset($media[$media_key]);
        }
    }
}
unset($media); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:41:32.163

您可以使用[array_intersect_key](http://php.net/manual/en/function.array-intersect-key.php)轻松完成此类操作：

```
$keepTheseKeys = array_flip(array('created_time', 'likes', 'images', 'id'));

foreach ($data as &$media) {
    $media = array_intersect_key($media, $keepTheseKeys);
}
unset($media); 
```

# 错误

问题代码中的错误是您正在更新临时变量，或者通过引用传递媒体（参见上面的示例） - 或者引用原始变量：

```
foreach ($data as $i => $media) {
    $data[$i] = ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T23:43:23.757

寻求优雅的解决方案：

```
foreach ($data as $key => $media) {
    foreach (array_keys($media) as $media_key) {
        if (!in_array($media_key, array("created_time", "likes", "images", "id"))) {
            unset($data[$key][$media_key]);
        }
    }
} 
```

我会尽量避免在 foreach 循环中使用引用，因为您需要取消设置引用的变量。如果没有，就会发生难以检测的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T23:41:54.037

首先，你不需要使用

```
foreach (array_keys($media) as $media_key) { 
```

您可以使用

```
foreach($media as $media_key => $media_value){ 
```

反而

但是对于您的问题，在第一行中，您正在遍历 $data，并且在每个周期中，$data 中的当前值被分配给 $media。但是媒体与原始 $data 没有任何联系，因此在下一次迭代中，当新值从 $data 分配给 $media 时，它会被丢弃。

你有两个选择：

1.  使用参考：

    ```
    foreach($data as &$media) { // and so on... this should work, but i don't suggest it 
    ```

2.  在第一行，写

    ```
    foreach($data as $media_k => $media) { 
    ```

    在第四行，写

    ```
    unset($data[$media_k][$media_key]); // 
    ```

# iphone - Spotify 简单播放器示例和 libspotify

> ID：13693703
> 
> 赞同：1
> 
> 时间：2012-12-03T23:32:55.163
> 
> 标签：iphone, ios, xcode, spotify, cocoalibspotify-2.0

我已经下载了用于 iOS 编程的 libspotify，并且正在尝试运行 Simple Player 示例。但是，我不断收到以下错误：

`Command /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool failed with exit code 1"`

可以在[此处](http://imgur.com/5o8hS,S6s1T)和[此处找到屏幕截图](http://imgur.com/5o8hS,S6s1T#1)

这是我第一次尝试使用 XCode 未附带的任何框架，所以我对此感到很迷茫。我有一个来自 developer.spotify.com 的应用程序密钥，但我不确定如何将它添加到我的项目或简单的播放器示例中。不幸的是，我似乎无法很好地遵循在线提供的文档。任何帮助都会非常有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T09:52:32.110

该屏幕截图听起来像是由于某种原因您有一个损坏的 libspotify 副本。您应该删除整个 repo，从 GitHub 中彻底检查，然后重试。

# java - Java 中的 Stack 出现 EmptyStackException 错误

> ID：13693707
> 
> 赞同：2
> 
> 时间：2012-12-03T23:33:07.443
> 
> 标签：java, stack

我要做的是让 eval 变量将其每个字母放入堆栈然后打印出来。我收到 EmptyStackException 错误（假设这意味着堆栈中没有任何内容）。我不明白的是，我认为 eval 字符串被放入变量堆栈中。为什么是空的？

```
public static void main(String[] args)
{

   Stack<String> variable = new Stack<String>();

   String eval = StdIn.readString();
   String alphabet = "abcdefghjiklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";

   for (int i = 0; i < eval.length(); i++)
   {
       eval = eval.substring(i,i);

       if (eval.equals(alphabet.substring(0, 52)))// checks if eval is equal to any letter of alphabet
     {
           variable.push(eval);

       System.out.println(variable.pop());
     }
   } 
  }
} 
```

我使用日食

* * *

样品运行：

```
input: hello
Exception in thread "main" java.util.EmptyStackException
at java.util.Stack.peek(Unknown Source)
at java.util.Stack.pop(Unknown Source)
at eval.main(eval.java:31) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T23:41:15.970

我可以看到一些问题：

1.  `eval.substring(i,i);`每次都会返回一个空字符串。你想要`eval.substring(i,i + 1);`，甚至更好，`eval.charAt(i);`。

2.  您需要将返回的子字符串/charAt 字符放在`for`循环中它自己的变量中。目前它`eval`在第一次迭代后覆盖字符串。

3.  `if (eval.equals(alphabet.substring(0, 52)))`从您的评论来看，它并没有像您认为的那样做。如果您想检查一个字符串是否包含另一个字符串（甚至只是一个字符），请使用方法：`String#contains`或`String#indexOf`.

* * *

这是一个简单的更正片段：

```
 String alphabet = "abcdefghjiklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
    String eval = "blah";
    Stack<Character> chars = new Stack<Character>();

    for(char c : eval.toCharArray()) {
        if(alphabet.indexOf(c) != -1) {
            chars.push(c);
            System.out.println(chars.pop());
        }
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-03T23:42:27.837

您收到此错误的唯一方法是：

```
for (int i = 0; i < eval.length(); i++)
   {
       eval = eval.substring(i,i);

       if (eval.equals(alphabet.substring(0, 52)))
     {
           variable.push(eval);

     }
 System.out.println(variable.pop());
   } 
```

如果你有 `System.out.println(variable.pop());`if 条件的外部。

**[流行音乐](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Stack.html#push%28java.lang.Object%29)**

```
public Object pop() 
```

> 移除此堆栈顶部的对象并将该对象作为此函数的值返回。
> 
> 返回： 此堆栈顶部的对象（Vector 对象的最后一项）。抛出：

**EmptyStackException** - 如果此堆栈为空。

在您发布的代码中，这是不可能的，因为您有相同数量的`push`and `pop`，并且`push`操作比`pop`.

**你放的代码**：

![在此处输入图像描述](../Images/e7a9f28fd1e88e5210fc4960cb4c870f.png)

**你得到的错误**：

![在此处输入图像描述](../Images/755435284f418dc1825dd5dc2ea47841.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T23:44:57.130

`eval`在将其压入堆栈之前，您需要检查其中的每个字母是否都是一个字母。遍历完 中的所有字符后`eval`，将所有内容从堆栈中弹出并打印出来。

```
for(int i = 0; i < eval.length(); i++) {

    if(alphabet.contains(eval.charAt(i))) {

        variable.push(eval.charAt(i));
    }
}

while(!variable.isEmpty()) {

    System.out.println(variable.pop());
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-04T00:11:43.023

这应该可以解决您的问题：您应该只在推送后弹出。因此，它们都应该在 if 语句中。

```
 for (int i = 0; i < eval.length(); i++)
    {
       if (alphabet.contains(eval.substring(i,i+1))
       {
           variable.push(eval.substring(i,i+1));
           System.out.println(variable.pop());
       }
     } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-03T23:56:08.720

您想检查从输入读取的字符串中的字符是否是字母，并将它们放入 stac 您应该考虑使用[Character 类](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Character.html)，它可以让您对字符执行各种测试，而不必担心编码。在您的情况下可能有用的方法是`isLetter`，它检查字符是否为字母。

至于堆栈问题，您的代码实际上将一个值压入堆栈顶部，然后立即`pop`将其压入，这解释了为什么您的堆栈在循环结束时为空。您应该改用该`peek`方法。

# ruby - 使用 RbConfig 而不是过时和不推荐使用的 Config

> ID：13693713
> 
> 赞同：20
> 
> 时间：2012-12-03T23:33:33.947
> 
> 标签：ruby, ruby-on-rails-3.2, rubygems

当我在 Ubuntu 上的 WEBrick 中运行我的 Rails 应用程序时，升级到 ruby​​-1.9.3-p327 后，我收到以下错误：

> [rake --tasks] /home/dsilver/.rvm/gems/ruby-1.9.3-p327/gems/em-dir-watcher-0.9.4/lib/em-dir-watcher.rb:7：使用 RbConfig而不是过时和弃用的 Config。

知道发生了什么吗？

我已经看到一些将其与 Windows 上的 ImageMagick 相关联的帖子。我在 Ubuntu 上，但该应用程序确实使用 ImageMagick，并且自从 ruby​​ 从 1.9.2 升级到 1.9.3 以来，ImageMagick 功能似乎已经损坏。我怀疑有联系。

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-31T20:11:10.403

该`Config`模块已重命名为`RbConfig`. 为了向后兼容，仍然可以使用旧名称，但如果这样做，Ruby 会[发出警告。](https://github.com/ruby/ruby/blob/v1_9_3_327/lib/rbconfig/obsolete.rb#L4)

gem使用[`em-dir-watcher`旧名称](https://github.com/mockko/em-dir-watcher/blob/v0.9.4/lib/em-dir-watcher.rb#L7)，因此在加载时您会看到警告。有人已经发送了一个[拉取请求](https://github.com/mockko/em-dir-watcher/pull/11)来解决这个问题，但是最后一次更新`em-dir-watcher`是在两年多以前，所以它可能不会被合并。

这是生成的警告，而不是错误，因此您的代码实际上应该仍然可以正常工作。如果你真的想摆脱警告，你可以在你之前添加这样的东西`require 'em-dir-watcher'`：

```
Object.send :remove_const, :Config
Config = RbConfig 
```

这与Ruby的定义`Config`相同，但会阻止警告。`RbConfig`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-06T22:15:03.173

你可以这样做（不推荐）：

转到文件**../lib/ruby/1.9/rbconfig/obsolete.rb**

编辑文件，更改是注释**#warn ...**

随着这种变化，消除了“警告”的建议

# ios - AFNetworking POST Never Succeeding - Unexpected Behavior Occurring on Different Devices

> ID：13693715
> 
> 赞同：2
> 
> 时间：2012-12-03T23:33:40.200
> 
> 标签：ios, post, afnetworking, freeze

I am currently developing an iOS app that allows a user to post a classified listing for other users to see. On all devices, that app hangs in a "O% Uploaded" `SVProgressHUD` for a while before displaying "Our server is temporarily unavailable. Please try again later.", which is what I have coded in the case of a Status Code 500 error from the server side. However, on the iOS simulator, everything works smoothly.

All other functionality involving network requests is working perfectly except for this, so it must have something to do with the actual upload process. I've posted the corresponding code below; if you require anything additional to help figure this out, please let me know.

**Networking Code**

```
- (IBAction)publishPressed:(UIBarButtonItem *)sender {
    [SVProgressHUD showWithStatus:@"Loading..." maskType:SVProgressHUDMaskTypeBlack];

    // Set the params for the API call in an NSMutableDictionary called mutableParams.

    // Create the form request with the post parameters and image data to pass to the API.
    NSMutableURLRequest *request = [[UAPIClient sharedClient] multipartFormRequestWithMethod:@"POST" 
                                                              path:@"mobPost.php" 
                                                              parameters:mutableParams 
                                                              constructingBodyWithBlock:^(id<AFMultipartFormData> formData) {
        if (self.imageHasBeenSet) {
            [self.listingImageView.image fixOrientation];
            NSData *imageData = UIImagePNGRepresentation(self.listingImageView.image);
            [formData appendPartWithFileData:imageData name:@"userfile" 
                      fileName:@"postImage.png" mimeType:@"image/png"]; 
        }
    }];

    // Create the `AFJSONRequestOperation` from the form request, with appropriate success and failure blocks.
    AFJSONRequestOperation *operation = [[AFJSONRequestOperation alloc] initWithRequest:request];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseJSON) {
        if ([[responseJSON objectForKey:@"status"] intValue] == 1) {
            dispatch_async(dispatch_get_main_queue(), ^{
                [SVProgressHUD showSuccessWithStatus:@"Success!"];
            });
            // Pass a message back to the delegate so that the modal view controller
            // can be dismissed successfully.
            [self.delegate uCreateListingTableViewController:self didCreateListing:YES];
        } else {
            dispatch_async(dispatch_get_main_queue(), ^{
                [SVProgressHUD showErrorWithStatus:@"Post failed. Please try again."];
            });
            NSLog(@"Status %@", [responseJSON objectForKey:@"status"]);
        }
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        NSLog(@"Error: %@", error);
        dispatch_async(dispatch_get_main_queue(), ^{
            [SVProgressHUD showErrorWithStatus:@"Our server is temporarily unavailable. Please try again later."];
        });
    }];

    [operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
        dispatch_async(dispatch_get_main_queue(), ^{
            [SVProgressHUD showSuccessWithStatus:[[NSString stringWithFormat:@"%lli", (totalBytesWritten / totalBytesExpectedToWrite)] stringByAppendingString:@"% Uploaded"]];
        });
    }];

    [[UAPIClient sharedClient] enqueueHTTPRequestOperation:operation];
} 
```

**UAPIClient.m**

```
#import "UAPIClient.h"
#import "AFJSONRequestOperation.h"

static NSString * const kUAPIBaseURLString = @"hiding string for privacy";

@implementation UAPIClient

+ (UAPIClient *)sharedClient {
    static UAPIClient *_sharedClient;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        _sharedClient = [[UAPIClient alloc] initWithBaseURL:[NSURL URLWithString:kUAPIBaseURLString]];
    });

    return _sharedClient;
}

- (id)initWithBaseURL:(NSURL *)url {
    self = [super initWithBaseURL:url];
    if (self) {
        [self registerHTTPOperationClass:[AFJSONRequestOperation class]];

        // Accept HTTP Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1
        [self setDefaultHeader:@"Accept" value:@"application/json"];
    }

    return self;
}

@end 
```

# postgresql - 如何在准备好的语句中传递带有''（时间戳）的字符串？

> ID：13693723
> 
> 赞同：5
> 
> 时间：2012-12-03T23:34:02.263
> 
> 标签：postgresql, syntax-error, insert-update, timestamp-with-timezone

我正在尝试执行以下查询

```
INSERT INTO hotspot(timestamp) VALUES 
(timestamp with time zone '2012-10-25 14:00:00 +05:00' at time zone 'EET'); 
```

我想将时间戳作为变量传递。

我的时间戳列是带有时区的时间戳类型。

你知道如何做到这一点吗？

当我这样做时......（Java，Postgresql）

```
 String stm= "INSERT INTO hotspot(timestamp) VALUES(timestamp with time zone ? at time zone 'EET')";
    pst = con.prepareStatement(stm);
    pst.setString(1, "2012-08-24 14:00:00 +05:00");
    pst.executeUpdate(); 
```

我在“$1”处或附近收到语法错误

无论如何我可以克服这个错误吗？先感谢您！！

***更新：***我尝试通过以下方式使用 setTimestamp ......

```
Calendar c=Calendar.getInstance(TimeZone.getTimeZone("GMT+05:00"));
String stm= "INSERT INTO hotspot(timestamp) VALUES(?)";
pst = con.prepareStatement(stm);
pst.setTimestamp(1,Timestamp.valueOf("2012-01-05 14:00:00"), c );
pst.executeUpdate(); 
```

我想数据库中的正确值应该是（关于我的本地时区是 EET (+02)）

2012-01-05 11:00:00 +02

但是使用 pgadmin 我检查了值，我得到了

2012-01-05 14:00:00 +02

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T23:49:50.157

考虑使用**setTimestamp()**方法而不是**setString()**方法。检查[此链接](http://www.java2s.com/Code/Java/Database-SQL-JDBC/DemoPreparedStatementSetTimestamp.htm)以了解如何使用*PreparedStatement*。

编辑：正如我在评论中解释的那样，使用三个参数检查 setTimestamp()的[API 参考：](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setTimestamp%28int,%20java.sql.Timestamp,%20java.util.Calendar%29)

> 使用给定的 Calendar 对象将指定参数设置为给定的 java.sql.Timestamp 值。驱动程序使用日历对象构造一个 SQL TIMESTAMP 值，然后驱动程序将其发送到数据库。使用 Calendar 对象，驱动程序可以在考虑自定义时区的情况下计算时间戳。如果未指定日历对象，则驱动程序使用默认时区，即运行应用程序的虚拟机的时区。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T00:13:30.003

Federico Cristina 说得很对，这`setTimestamp`是正确的做法。

语法错误的原因是您在传递参数时无法使用前导类型说明符指定类型。该`INTEGER '4'`样式仅对*文字*有效，对参数无效。

您的代码将`PREPARE`d 然后`EXECUTE`d 在协议级别。如果我`PREPARE`这样做，会发生以下情况：

```
regress=> PREPARE blah(timestamptz) AS INSERT INTO hotspot(timestamp) VALUES(timestamp with time zone $1 at time zone 'EET');
ERROR:  syntax error at or near "$1"
LINE 1: ...otspot(timestamp) VALUES(timestamp with time zone $1 at time... 
```

由于数据类型在查询参数中指定，您可以省略它，改为：

```
String stm= "INSERT INTO hotspot(\"timestamp\") VALUES(? at time zone 'EET')"; 
```

请注意，我也使用了双引号`"timestamp"`，因为它是保留字。在某些情况下，它可以在没有引号的情况下工作，但在其他情况下则不行。选择数据类型名称或保留字作为列名通常不是一个好主意。

# grails - Accessing nested LDAP roles in Oracle Internet Directory (OID) within Grails and SpringSecurity

> ID：13693726
> 
> 赞同：1
> 
> 时间：2012-12-03T23:34:31.560
> 
> 标签：grails, spring-security, ldap

In our LDAP directory, we have users, who are mapped to groups. Those groups may be mapped to other groups. For example:

```
cn=group1,cn=groups,dc=example,dc=com
    uniquemember cn=user1,cn=user,dc=example,dc=com
cn=group2,cn=groups,dc=example,dc=com
    uniquemember cn=user2,cn=user,dc=example,dc=com
    uniquemember cn=group1,cn=user,dc=example,dc=com 
```

So User1 belongs to Group1, but User2 belongs to Group2, which in turn belongs to Group1

Within Grails, User1 has authority to Group1, but User2 only has authority to Group2\. From what I've seen, there is no way to cause it to recursively look at the tree. Realistically, I probably only need a 2 level hierarchy, but even that doesn't seem to work.

I'm attempting to work through the Custom UserDetailsContextManager to see if I can iterate over the initial results and re-query LDAP by group, but I thought I'd see if there was an easier/better way.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T04:48:59.453

您可能已经看到了，但这是来自文档：

// 如果您不想支持组成员递归（组中的组），请使用以下设置 // grails.plugins.springsecurity.ldap.authorities.groupSearchFilter = 'member={0}' // Active Directory 特定

// 如果您希望支持以组为成员的组（递归组），请使用以下 grails.plugins.springsecurity.ldap.authorities.groupSearchFilter = '(member:1.2.840.113556.1.4.1941:={0})' // Active Directory 特定

[http://grails-plugins.github.com/grails-spring-security-ldap/docs/manual/guide/2.%20Usage.html](http://grails-plugins.github.com/grails-spring-security-ldap/docs/manual/guide/2.%20Usage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-28T00:53:23.717

Oracle OID 具有用于遍历层次结构[的特定于产品的扩展](http://docs.oracle.com/cd/E25054_01/oid.1111/e10029/grp_admin.htm)，称为`CONNECT_BY`，它具有 LDAP OID `2.16.840.1.113894.1.8.3`。您可以将此添加为请求控件，以要求服务器根据您指定的属性连接/遵循层次结构。这可以使用 Java LDAP 客户端程序或使用类似 OpenLDAP`ldapsearch`的程序来完成，尽管设置有点棘手。

如果您想使用 Java 来遵循层次结构，[此页面](http://www.oracle.com/technetwork/middleware/id-mgmt/learnmore/oid-demos-182820.html)包含一个[示例程序](http://www.oracle.com/technetwork/middleware/id-mgmt/learnmore/sampleconnectby-350418.zip)，该示例程序显示了如何设置所需的`javax.naming.ldap.Control`实现类，在本例中名为`ConnectByControl`.

您也可以使用 执行这种分层搜索`ldapsearch`，但它需要一些准备和对所需控制值的隐含理解，因为值是连接然后进行 base64 编码的。该值分为两部分 - 跟随我的深度（0=无限），后跟连接属性名称（在这种情况下，`uniquemember`是所需的名称）。将查询中的 baseDN 设置为要开始分层搜索的条目。

```
ldapsearch -H ldap://myoidserver.mycompany.com:389 -e 2.16.840.1.113894.1.8.3=MBECAQAEDHVuaXF1ZW1lbWJlcg== -b cn=some_group_containing_groups_nested_by_uniquemember,cn=some_groups,dc=mycompany,dc=com "(objectClass=*)" dn uniquemember 
```

`-e 2.16.840.1.113894.1.8.3=`添加`CONNECT_BY`请求控件。对于上述深度和属性名称，值`MBECAQAEDHVuaXF1ZW1lbWJlcg==`是 ASN.1 BER 编码然后是 base64 编码值。`0uniquemember`这将首先打印`dn`for`cn=some_group_containing_groups_nested_by_uniquemember,...`及其直接 (user) `uniquemember`，然后每个都`uniquemember`将被“连接”或跟随。如果该条目本身具有一组`uniquemember`，即它是一个嵌套组，则该过程将继续，直到到达没有嵌套`uniquemember`s 的叶/用户条目。

# sql - SQL 更新的行为，其中更新的表不符合条件

> ID：13693729
> 
> 赞同：1
> 
> 时间：2012-12-03T23:35:00.170
> 
> 标签：sql, sql-server, sql-update

运行以下查询时

```
UPDATE Invoices
SET PaymentTotal = 1
FROM Vendors
WHERE Vendors.VendorID = 34 -- true for some row 
```

SQL Server 更新发票中的所有记录。但是，当条件与 Vendors 表中的任何行都不匹配时：

```
UPDATE Invoices
SET PaymentTotal = 1
FROM Vendors
WHERE Vendors.VendorID = -34 -- false for all rows 
```

没有行得到更新。为什么？

编辑：**这是一个完全学术问题**，我知道这不是编写查询的理想方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:40:13.170

您的原始查询：

```
UPDATE Invoices
SET PaymentTotal = 1
FROM Vendors
WHERE Vendors.VendorID = 34 
```

相当于：

```
update i set paymenttotal = 1
from vendors v
cross join invoices i
where v.vendorid = 34 
```

交叉连接返回两个集合的乘积，当`vendors`使用条件减少为空集时，`v.vendorid = -34`结果集为空，因为任何乘以零的值都为零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:42:22.707

这是因为在第一种情况下，对于 Invoices 中的每个值（存在ID 为 34*的供应商），WHERE 子句都被评估为 true，因此当 ID=-34 时，**每条*记录都会更新，反之亦然——没有记录更新，因为 VendorID= -34 总是错误的。

例如，假设我们设置了 Invoices`I {... does not matter ... }`和 Vendors `V.VendorIDs {1 .. 35}`。

```
set PaymentTotal = 1 when VendorID=34 exists  
-- 34 exists so this is executed

set PaymentTotal = 1 when VendorID=-34 exists
-- -34 does not exists so this is never executed 
```

这些是不相关集合之间的集合操作，因此不会出现预期结果（不经过此类分析）。

如果你要将它们关联起来（如下面的查询），那么这个逻辑就会改变，你会得到“预期的”结果。

* * *

我相信你想要这些方面的东西：

```
UPDATE Invoices
SET PaymentTotal = 1
FROM Vendors
WHERE Vendors.VendorID = 34 and Invoices.VendorID = Vendors.VendorID 
```

...而且我假设您实际上并不知道 VendorID，而是知道另一个 Vendor 字段，这样该查询才有意义（因为如果您已经知道 ID，则查询另一个表是没有用的）。

# javascript - javascript不访问基于asp .net的html页面元素

> ID：13693730
> 
> 赞同：0
> 
> 时间：2012-12-03T23:35:04.507
> 
> 标签：javascript, html, asp.net, textbox

我只是想访问一个文本框控件的值（它具有 runat="server" 属性）。被困了几个小时寻找答案。每次我尝试获取该值时，它都是空的。

**javascript文件：**

```
function validateRegistration() {
var username = document.getElementById("<%=username.ClientId%>").value;
document.write(username);
} 
```

**.aspx 文件：**

```
<asp:Content ID="Content3" ContentPlaceHolderID="mainContentPlaceHolder" runat="server">
    <p>
        Fill in the following form to register:</p>
    <p>
        Username:
        <asp:TextBox ID="username" name="username" runat="server"></asp:TextBox></p>
    <input id="register" type="submit" value="Register" onclick="validateRegistration()"/>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:38:29.087

它应该是（注意大写 D）：

```
var username = document.getElementById("<%=username.ClientID%>").value;
document.write(username); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T01:45:49.053

你试过用

`var username = document.getElementById('<%= username.ClientID%>').value;`?

我的页面中有类似的代码并且工作正常。

# jquery - page scrolls when hiding/showing content from select option change using jQuery

> ID：13693732
> 
> 赞同：0
> 
> 时间：2012-12-03T23:35:14.313
> 
> 标签：jquery

I have written a piece of jQuery that hides/shows a specified element when a drop down option/s is selected.

The problem I am having is that when one of the options is selected the page scrolls so that the bottom of the browser aligns with the top of the content that has just been hidden/shown. How do I stop this happening?

Below is a summarised version of the code.

```
$(function() {
    $('#billing_address2').change(function() {
        $('.calendar').hide();
        if ($(this).val() == "None") {
            $('.empty').show();
        }
        if ($(this).val() == "Arch Hill" || $(this).val() == "Balmoral" || $(this).val() == "Central Business District" || $(this).val() == "Eden Terrace" || $(this).val() == "Ellerslie" || $(this).val() == "Epsom") {
            $('.central').show();
        }
        if ($(this).val() == "Albany" || $(this).val() == "Bayswater" || $(this).val() == "Bayview" || $(this).val() == "Belmont") {
            $('.north').show();
        }
        if ($(this).val() == "Glendowie" || $(this).val() == "Kohimarama" || $(this).val() == "Meadowbank" || $(this).val() == "Mission Bay") {
            $('.east').show();
        }
        if ($(this).val() == "Avondale" || $(this).val() == "Blockhouse Bay" || $(this).val() == "Glen Eden" || $(this).val() == "Glendene") {
            $('.west').show();
        }
    ;});
});

<select id="billing_address2">
    <option selected value="None">Suburb...</option>
    <option value="Albany">Albany</option>
    <option value="Arch Hill">Arch Hill</option>
    <option value="Avondale">Avondale</option>
    <option value="Balmoral">Balmoral</option>
    <option value="Bayswater">Bayswater</option>
    <option value="Bayview">Bayview</option>
    <option value="Belmont">Belmont</option>
    <option value="Blockhouse Bay">Blockhouse Bay</option>
    <option value="Central Business District">Central Business District</option>
    <option value="Eden Terrace">Eden Terrace</option>
    <option value="Ellerslie">Ellerslie</option>
    <option value="Epsom">Epsom</option>
    <option value="Glen Eden">Glen Eden</option>
    <option value="Glendene">Glendene</option>
    <option value="Glendowie">Glendowie</option>
    <option value="Kohimarama">Kohimarama</option>
    <option value="Meadowbank">Meadowbank</option>
    <option value="Mission Bay">Mission Bay</option>
</select> 
```

# facebook - Rss feed from facebook without logging in

> ID：13693737
> 
> 赞同：0
> 
> 时间：2012-12-03T23:35:56.270
> 
> 标签：facebook

I have a facebook page that i'd like to pull the wall posts from and into a personal web page. I cannot figure out how to do this without making users log into facebook. I do not want the user to have to log into facebook in order for my wall posts to show up.

I am using asp.net. Ideally, i'd like to execute code on the server side and log into facebook using my ID on the server and pull my wall posts and display it to the users. However, this doesn't seem to be possible without getting an access token which can't be done programmatically from what I've seen. All code snippets i've seen to log into facebook requires their oauth web form to popup and you have to type in your user name and password, ideally i'd like to hard code my user name and password on the server and the server will log in for me and then fetch the data on my behalf.

Anyone know if this can be accomplished?

# jpa - JPA 中是否有隐式版本字段？

> ID：13693745
> 
> 赞同：3
> 
> 时间：2012-12-03T23:36:38.937
> 
> 标签：jpa, eclipselink, objectdb

我是 JPA 的新手，注意到可以通过使用`@Version`. 我只是好奇持久性提供程序是否会创建一个隐式版本字段，如果以前不存在的话。例如[objectdb](http://www.objectdb.com/java/jpa/persistence/lock#Optimistic_Locking_)的网站指出：

> “使用 ObjectDB 时，默认启用乐观锁定并且是全自动的。”

但这似乎是特定于供应商的行为，因为例如在 EclipseLink 中默认情况下不会启用乐观锁定。因此，如果我想使用锁定（是的，我想要:-)），我是否需要为我的所有实体创建一个额外的属性？规范中有任何提示吗？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T05:34:19.927

是的，JPA`@Version`注释允许你定义一个版本属性，我假设 ObjectDB 默认只创建一个这个属性。

您自己的属性可以是 Integer、Long 或 Short（或它们的原始等价物）或 java.sql.Timestamp。

我知道的大多数 JPA 提供程序仅在您明确使用`@Version`注释时才进行乐观锁定。

# css - IE9 and CSS dropdown list positioning

> ID：13693746
> 
> 赞同：0
> 
> 时间：2012-12-03T23:36:40.490
> 
> 标签：css, drop-down-menu, internet-explorer-9, hover

I have a pure CSS dropdown on our website. It works fine in Chrome, but in IE9, the child elements are to the right of the parent rather than below the parent.

CSS code:

```
/* drop down menus on front page */

ul#dropdown {
  font-size: 14pt;
    margin: 0;
    padding: 0;
    padding-top: 10px;
    color: #92008f;
    width: 100%;
    font-family: Times New Roman, Georgia, Times;
    z-index: 1;
}

ul#dropdown li, ul#dropdown li ul li {
    list-style: none;
    margin: 0;
    padding: 0;
    float: left;
    position: relative;
    overflow: visible;
    width: 140px;
    text-align: center;
    z-index: 1;
}

li ul {
    display: none;
    list-style: none;
    position: absolute;
    font-size: 11pt;
    width: 140px;
    font-family: Times New Roman, Georgia, Times;
    color: #000000;
    overflow: auto;
    background-color: #efdaef;
    border: 1px solid #92008f;
    margin: 0;
    padding: 0;
    z-index: 1;
}

li:hover ul {display: block;} 
```

HTML:

```
<!DOCTYPE html>
<?php
  $author='STARK HOUSE'; 
include 'header.php'; ?>

<div id="wrapper">
     <ul id="dropdown">
<!--    STARK HOUSE -->
        <ul>
          <li><img src="images/downarrow.jpg" style="margin:0"> STARK HOUSE 
            <ul>
          <li><a href="pages/mysteryclub.html">Crime Book Club</a>
          <li><a href="http://www.ollerman.com/starkhouse/shnewsletter.html">Newsletter</a>
            </ul>
      </ul>
 <!--   FANTASY -->
        <ul>
          <li><img src="images/downarrow.jpg" style="margin:0">FANTASY
            <ul>
        <li><a href="blackwood.php">Algernon Blackwood</a>
          <li><a href="butzen.php">Catherine Butzen</a>
          <li><a href="constantine.php">Storm Constantine</a>
            </ul>
      </ul> 
```

website: [http://starkhousepress.com](http://starkhousepress.com)

thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:10:02.137

我相信你的问题出在 IE7 上，我用 IE9 测试过并且工作正常：

试试下面的代码（我在 IE 7 8 9 和其他 .. 上测试过） HTML：

```
<div id="wrapper">
    <div id="dropdown">
        <!--    STARK HOUSE -->
        <div class="drop">
            <div class="menu"><img src="http://starkhousepress.com/images/downarrow.jpg" style="margin:0"> STARK HOUSE </div>
            <ul>
                <li><a href="pages/mysteryclub.html">Crime Book Club</a></li>
                <li><a href="http://www.ollerman.com/starkhouse/shnewsletter.html">Newsletter</a></li>
            </ul>
        </div>
        <!--   FANTASY -->
        <div class="drop">
            <div class="menu"><img src="http://starkhousepress.com/images/downarrow.jpg" style="margin:0">FANTASY</div>
            <ul>
                <li><a href="blackwood.php">Algernon Blackwood</a></li>
                <li><a href="butzen.php">Catherine Butzen</a></li>
                <li><a href="constantine.php">Storm Constantine</a></li>
            </ul>
        </div>
    </div>
</div> 
```

CSS：

```
#dropdown {
    font-size: 14pt;
    margin: 0;
    padding: 0;
    padding-top: 10px;
    color: #92008f;
    width: 100%;
    font-family: Times New Roman, Georgia, Times;
    z-index: 1;
}
.drop {
    display:inline-block;
    width:140px;
    vertical-align:top;
    *display:inline;
}
.drop ul{
    display:none;
}

.drop:hover ul {
    display: block;
}
​ 
```

[http://jsfiddle.net/vRRw8/8/](http://jsfiddle.net/vRRw8/8/) 希望对你有所帮助

# ruby-on-rails - 安装 devise gem 时出现拼写错误后未初始化的常量错误消息

> ID：13693748
> 
> 赞同：1
> 
> 时间：2012-12-03T23:37:13.913
> 
> 标签：ruby-on-rails, ubuntu, devise, ruby-1.9.3, ruby-on-rails-3.2

我刚开始学习如何编程，但使用 Ubuntu 已经有几年了，所以我对研究问题和错误非常熟悉，但要么这个领域对我来说太新，要么我真的找不到任何具体的答案。

我正在参加 ruby​​ on rails 介绍课程，到了必须安装设计 gem 的地步，这就是我犯错误的地方。

在按照[设计 github 页面](https://github.com/plataformatec/devise)上的说明操作时，我不小心输入了：

```
rails generate devise install 
```

代替

```
rails generate devise:install 
```

现在，每当我尝试加载

> 导轨

我收到此错误消息：

```
/home/amer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/inflector/methods.rb:230:in `block in constantize': uninitialized constant Install (NameError)
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/inflector/methods.rb:229:in `each'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/inflector/methods.rb:229:in `constantize'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise.rb:256:in `get'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/mapping.rb:77:in `to'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/mapping.rb:72:in `modules'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/mapping.rb:89:in `routes'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/mapping.rb:156:in `default_used_route'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/mapping.rb:66:in `initialize'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise.rb:290:in `new'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise.rb:290:in `add_mapping'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/rails/routes.rb:208:in `block in devise_for'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/rails/routes.rb:207:in `each'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/devise-2.1.2/lib/devise/rails/routes.rb:207:in `devise_for'
from /home/amer/Documents/Rails_Projects/omrails/omrails1/config/routes.rb:3:in `block in <top (required)>'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:282:in `instance_exec'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:282:in `eval_block'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:260:in `draw'
from /home/amer/Documents/Rails_Projects/omrails/omrails1/config/routes.rb:1:in `<top (required)>'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:40:in `each'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:40:in `load_paths'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:16:in `reload!'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:26:in `block in updater'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/file_update_checker.rb:78:in `call'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/file_update_checker.rb:78:in `execute'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:27:in `updater'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application/finisher.rb:66:in `block in <module:Finisher>'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/initializable.rb:30:in `instance_exec'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/initializable.rb:30:in `run'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/initializable.rb:55:in `block in run_initializers'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/initializable.rb:54:in `each'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/initializable.rb:54:in `run_initializers'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/application.rb:136:in `initialize!'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/railtie/configurable.rb:30:in `method_missing'
from /home/amer/Documents/Rails_Projects/omrails/omrails1/config/environment.rb:5:in `<top (required)>'
from /home/amer/Documents/Rails_Projects/omrails/omrails1/config.ru:4:in `block in <main>'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
from /home/amer/Documents/Rails_Projects/omrails/omrails1/config.ru:1:in `new'
from /home/amer/Documents/Rails_Projects/omrails/omrails1/config.ru:1:in `<main>'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands/server.rb:46:in `app'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands/server.rb:70:in `start'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:55:in `block in <top (required)>'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:50:in `tap'
from /home/amer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:50:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

在此处发布之前，我尝试重新安装 ruby​​ 1.9.3。使用 rvm。我尝试使用

```
rvm gemset empty [gemset_name] 
```

正如[RVM 中所述：卸载 gemset 的所有 gem，](https://stackoverflow.com/questions/4693445/rvm-uninstalling-all-gems-of-a-gemset)但这也没有真正的帮助。

我该怎么办？谁能向我解释这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T04:40:54.417

我理解你的问题。你已经写了`rails generate devise install`。这意味着您已将其关联`install`为模型来设计而不是配置它。因此，您的文件是在没有设计配置的情况下创建的。

你只需按照我写的： 1）在**'/config/initializers'**
中 创建一个**`devise.rb`**文件 2）在其中编写以下代码：

 **`Devise.setup do |config|`
  `config.mailer_sender = "devise@example.com"`
  `config.scoped_views = true`
  `require 'devise/orm/active_record'`**#[这对你有用]**
  `config.case_insensitive_keys = [ :email ]`
  `config.strip_whitespace_keys = [ :email ]`
  `config.skip_session_storage = [:http_auth]`
  `config.stretches = Rails.env.test? ? 1 : 10`
  `config.reconfirmable = true`
  `config.reset_password_within = 6.hours`
  `config.sign_out_via = :delete`
`end`

**`rails destroy devise install`**2）并在终端中写入。就是这样。
我认为以上肯定会奏效。

3）现在再次启动您的服务器**`rails s`**。
4) 再次小心安装设备。然后继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T01:07:32.487

我认为您没有 gem 问题，只是混淆了 Devise 设置，这很可能很容易混淆。

当您运行 Devise 生成器（带有`rails generate Devise:something`）时，它会运行代码以在您的应用程序树 (app/*) 中创建一些特定于您的应用程序的文件。我正在查看一个设计安装，并认为它主要位于`app/views/devise`目录中，但它也有可能更新您的用户模型。它肯定会更新您的`app/routes.rb`文件并在`config/initializers`. 可能还有其他人。

删除其中任何一个。语言环境中可能还有其他文件，db/migrate（有一个迁移——不要运行它，或者`rake db:rollback`如果有的话，在删除它之前运行）。

然后重新运行安装。

如果这不起作用，另一种方法是创建一个新的虚拟 Rails 应用程序，在那里安装设计，然后查看创建了哪些文件——通常生成器会报告它们在做什么。**

# python - 我们如何将 numpy 数组的两列连接成一列，用空格分隔值？

> ID：13693751
> 
> 赞同：1
> 
> 时间：2012-12-03T23:38:01.777
> 
> 标签：python, numpy

我有一个 numpy 字符串数据数组，我目前正在使用`data_subset = original_data[:, [1, 3, 8]]`. 但是，我希望我的数据子集中的一列是我的原始数据的两列组合，并用空格连接。

我正在考虑的组合示例如下。我有 2 列代表名字和姓氏。作为示例数据，行将`John`在第 3 列和`Smith`第 4 列中，但在我的新数据中，我想要一个列`John Smith`。是否有一个很好的 numpy 函数来执行这样的连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T05:40:20.847

我建议使用`pandas`库而不是`numpy`这里——使用`numpy`数组作为字符串通常比它的价值更麻烦。OTOH，您想要的非常简单`pandas`：

```
>>> from pandas import DataFrame
>>> df = DataFrame({"first": ["John", "Jane"], "last": ["Smith", "Jones"]})
>>> df
  first   last
0  John  Smith
1  Jane  Jones
>>> df["first"] + " " + df["last"]
0    John Smith
1    Jane Jones 
```

但是，如果您绝对想使用`numpy`，则可以将 更改`dtype`为`object`：

```
>>> import numpy as np
>>> a = np.array([["John", "Smith"], ["Jane", "Jones"]])
>>> a = a.astype(object)
>>> a[:,0] += " " + a[:,1]
>>> a = a[:,:1]
>>> a
array([[John Smith],
       [Jane Jones]], dtype=object) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:47:51.240

您可以使用标准 Python 进行连接，这样应该可以：

```
data_subset = original_data[:, [1, 3]]
data_subset[:, 1] += " " + original_data[:, 8] 
```

# entity-framework - Entity framework error with AsNoTracking and ObjectStateManager

> ID：13693757
> 
> 赞同：2
> 
> 时间：2012-12-03T23:38:39.417
> 
> 标签：entity-framework

As you can see from the code below i use AsNoTracking to get my object. I then even use ObjectSateManager to see what is going on and i can see nothing being tracked in the l* collections and yet i still get

"An object with the same key already exists in the ObjectStateManager. The ObjectStateManager cannot track multiple objects with the same key".

Any ideas?

==========================================
BasketRepository repo = new BasketRepository();

```
 var ba = repo.GetById(8);

            var bpro = new BasketProduct(ba, ba.BasketProducts.First().Product, 3);

            repo.AddToBasket(bpro);
           repo.Save(); 
```

==================================

```
 public Basket GetById(int basketId)
    {
        // eager-load product info
        var basket = dbContext.Baskets.Include("BasketProducts")
                                      .Include("BasketProducts.Product.Brand").AsNoTracking().SingleOrDefault(b => b.BasketId == basketId);;
        return basket;
    } 
```

======================================

```
 public void AddToBasket(BasketProduct product)
    {
        var ctx = ((IObjectContextAdapter)dbContext).ObjectContext;
        ObjectStateManager objectStateManager = ctx.ObjectStateManager;
        var l1 = objectStateManager.GetObjectStateEntries(EntityState.Added);
        var l2 = objectStateManager.GetObjectStateEntries(EntityState.Modified);
        var l3 = objectStateManager.GetObjectStateEntries(EntityState.Deleted);
        //var l4 = objectStateManager.GetObjectStateEntries(EntityState.Detached);
        var l5 = objectStateManager.GetObjectStateEntries(EntityState.Unchanged);

        var existingProductInBasket = dbContext.BasketProducts.AsNoTracking().SingleOrDefault(b => b.BasketId == product.BasketId && b.ProductId == product.ProductId);
        var l6 = objectStateManager.GetObjectStateEntries(EntityState.Added);
        var l7 = objectStateManager.GetObjectStateEntries(EntityState.Modified);
        var l8 = objectStateManager.GetObjectStateEntries(EntityState.Deleted);
        //var l4 = objectStateManager.GetObjectStateEntries(EntityState.Detached);
        var l9 = objectStateManager.GetObjectStateEntries(EntityState.Unchanged);

        //objectStateManager.
        dbContext.Entry<BasketProduct>(product).State = existingProductInBasket == null ? EntityState.Added : EntityState.Modified;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-28T19:59:30.303

当您使用 asNoTracking() 时，您会得到一个无法使用 EntityState.Modified 正常更新的未连接实体。然后，一个技巧是用非缓存的实体值替换缓存的实体值。

这是我在需要 asNoTracking 的特殊情况下使用的源代码。有可能

```
private T ReplaceEntity(T cachedEntity, T nonCachedEntity) {

     dbContext.Entry(cachedEntity).CurrentValues.SetValues(nonCachedEntity);

     return cachedEntity;
} 
```

一个常见的用途可以是：

```
public virtual T FindFirstBy(System.Linq.Expressions.Expression<Func<T, bool>> predicate, bool asNoTracking = false)
{
     if (asNoTracking)
     {
          T cachedEntity = dbContext.Set<T>().FirstOrDefault(predicate);
          T nonCachedEntity = dbContext.Set<T>().AsNoTracking().FirstOrDefault(predicate);

          return ReplaceEntity(cachedEntity, nonCachedEntity);
     }
     return dbContext.Set<T>().FirstOrDefault(predicate);
} 
```

对于您的情况：

```
var cachedEntity = dbContext.BasketProducts.SingleOrDefault(b => b.BasketId == product.BasketId && b.ProductId == product.ProductId);
var nonCachedEntity = dbContext.BasketProducts.AsNoTracking().SingleOrDefault(b => b.BasketId == product.BasketId && b.ProductId == product.ProductId);

var product= ReplaceEntity(cachedEntity, nonCachedEntity);
dbContext.Entry<BasketProduct>(product).State = EntityState.Modified; 
```

希望能帮助到你！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T17:49:04.120

那实际上是坏事。从概念上讲，要习惯 EF 如何附加和跟踪事物的想法可能有点困难。秘诀是要记住，如果您有一个对象图（与其他对象有关系的对象），只要该图的一个对象与状态 X 相连，那么图中的所有其他对象似乎也都处于该状态。

在我的场景中，我非常愚蠢地使用 var bpro = new BasketProduct(ba, ba.BasketProducts.First().Product, 3); 创建一个实际已经存在于数据库中的测试产品，它是包含篮子及其产品的对象图的一部分。当我尝试附加这个“新”篮子时，EF 正确地抱怨附加图中已经存在具有相同键的对象！

# ios - 核心数据为现有实体获取多对象

> ID：13693758
> 
> 赞同：0
> 
> 时间：2012-12-03T23:38:43.940
> 
> 标签：ios, core-data

我有一个实体，我们称它为 Parent，Parent 最多有 5 个 Child 实体作为一对多关系。

我在 UITableView 中显示这些“父”关系；当用户选择父实体的行时，我想显示另一个视图，显示该父实体的一些详细信息，包括所有子实体（如果有）。

我不明白的是我如何从核心数据中获取这些子实体！！！我已经尝试了一切，我尝试从托管上下文中刷新父级，我尝试使用以下方法从托管上下文中再次获取它：

```
[managedObjectContext existingObjectWithID:[swingSession objectID] error:&error]; 
```

我真的是在我的智慧尽头，我不知道该怎么办！

请帮忙，我错过了什么？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:42:53.227

您可以通过父对象中的 NSSet 属性访问子对象，如下所示：

```
NSLog(@"This is a child object: %@", [[parent.children allObjects]objectAtIndex:0]); 
```

这是假设关系设置正确。一对多关系是 NSSet 类型。

您的实体应该这样设置：

```
Parent.children(relationship)<->>Child.parent(relationship) 
```

确保您在子级与父级上建立了反向一对一关系。

# ruby-on-rails - Rspec不适用于控制器中的<运算符

> ID：13693759
> 
> 赞同：0
> 
> 时间：2012-12-03T23:38:47.970
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, controller, operators

我正在关注关于密码重置的 Ryan Bates railscasts。我决定通过 TDD 实现他的代码，但我的一个测试拒绝工作。每当我跑步

```
context "for checking update succeeds" do
  before do
    post :update, id: "2012-12-03 04:23:13 UTC"
  end

  it { should assign_to(:user) }      
  it { should respond_with(:redirect) }
  it { should redirect_to(signin_path) }
  it { should set_the_flash.to("Password has been reset.")}

end 
```

我收到以下错误

```
 Failure/Error: post :update, id: "2012-12-03 04:23:13 UTC"
 NoMethodError:
   undefined method `<' for nil:NilClass 
```

我的控制器如下

```
def update
  @user = User.find_by_password_reset_token!(params[:id])
  if @user.password_reset_sent_at < 2.hours.ago
    redirect_to new_password_reset_path, flash[:error] = "Password reset has expired"
  elsif @user.update_attributes(params[:user])
    redirect_to root_url, flash[:success] = "Password has been reset."
  else 
    render :edit
  end
end 
```

我不得不假设我以某种形式或方式写错了我的测试。我该如何解决？请注意，我知道 UTC 时间已过时，并且基于昨天的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T00:05:41.910

复制自评论：

好像`@user.password_reset_sent_at`是`nil`。如果允许的话`nil`，你应该检查

```
if @user.password_reset_sent_at && @user.password_reset_sent_at < 2.hours.ago 
```

如果不允许这样做，则说明模型中某处存在错误。测试看起来不错。

# jquery - jQuery Autocomplete with XML database

> ID：13693760
> 
> 赞同：1
> 
> 时间：2012-12-03T23:38:48.280
> 
> 标签：jquery, xml, jquery-autocomplete

I'm trying to create an autocomplete search bar that implements an XML file that I created. I'm following the XML demo on jQuery. My script is as follows:

```
$(function() {
    function log( message ) {
        $( "<div/>" ).text( message ).prependTo( "#log" );
        $( "#log" ).attr( "scrollTop", 0 );
    }

    $.ajax({
        url: "courses.xml",
        dataType: "xml",
        success: function( xmlResponse ) {
            var data = $( "course", xmlResponse ).map(function() {
                return {    
                    value: $( "department_name", this ).text() + ", " +
                        ( $.trim( $( "class_number", this ).text() ) || "(unknown course)" ),
                    id: $( "id", this ).text()
                };
            }).get();

            $( "#results" ).autocomplete({
                source: data,
                minLength: 0,
                select: function( event, ui ) {
                    log( ui.item ?  
                        "Selected: " + ui.item.value + ", ID: " + ui.item.id :
                        "Nothing selected, input was " + this.value );
                }
            });
        }
    });
}); 
```

The XML file has the following format:

```
<courses>
<course id="1">
    <department_name>ELEC</department_name>
    <class_number>2001</class_number>
    <section_number>001</section_number>
    <professor>Chris, Michael</professor>
    <class_title>Electrical Engineering Concepts</class_title>
    <time_of_day>14:00-15:15</time_of_day>
    <days_of_week>TuTh</days_of_week>
    <building>Randalph Hall</building>
</course> 
```

The search bar isn't returning anything though. There's no autocomplete working.
All help is appreciated

# plot - 在直方图/条形图中将计数置于 bin 上方

> ID：13693761
> 
> 赞同：2
> 
> 时间：2012-12-03T23:38:49.640
> 
> 标签：plot, octave

我想知道是否有办法将垃圾箱的计数放在垃圾箱本身上方的直方图/条形图中。我知道可以将 xtick 值更改为您想要的任何值（在 bin 下方），但是，我想保留 xtick 值，因为它们与我的情节相关。我想可以使用 text(x, y, z, label) 函数在绘图上放置文本，但是，这需要您手动设置文本出现的位置，我最好寻找一个 less繁琐的方法。

任何建议都会很棒。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T15:52:13.787

这是一个半自动的方法。它使用 for 循环和文本

```
[H X] = hist(data,bins);
bin_width = X(2) - X(1);

x_offset = 4;
y_offset = 20;    

figure();
bar_plot = bar(X, H)
for ii=1:length(H)
    text(X(ii)-bin_width/x_offset, H(ii)+max(H)/y_offset, num2str(H(ii)) );
end 
```

然后，您需要使用的仅有的两个参数是 x_offset 和 y_offset。希望这可以帮助。

# iphone - Jquery Mobile 标题未显示在应用程序中

> ID：13693767
> 
> 赞同：0
> 
> 时间：2012-12-03T23:39:36.190
> 
> 标签：iphone, xcode, cordova, jquery-mobile

我正在Phonegap 和jQuery Mobile 中构建一个iphone 应用程序。到目前为止使用非常基本的元素，但我的标题没有显示在 xcode iphone 模拟器中（参见屏幕截图）。任何人都知道问题可能是什么？

这是我使用的 html 结构：http: [//pastebin.com/czRyhRhM](http://pastebin.com/czRyhRhM)

![Chrome 和 iphone 模拟器中应用程序的屏幕截图](../Images/970254ba437ce12a82fe4f59a279eea1.png)

# python - 优化：如何搜索大解空间

> ID：13693768
> 
> 赞同：1
> 
> 时间：2012-12-03T23:39:46.263
> 
> 标签：python, optimization

开发 Python 例程...我需要帮助来制定这个问题：

工程问题：我有 3 个位置（（x=3），每个位置有 4 个物理支撑（y=4）：

```
Loc 1:    {H1, L1, R1, G1}
Loc 2:    {H2, L2, R2, G2}
Loc 3 (x):{H3, L3, R3, G3} 
```

跨位置的有效组合（用于测试和优化）是：

```
H1(Loc1), H2(Loc2), H3(Loc3)------ cost 1
H1(Loc1), H2(Loc2), L3(Loc3)------ cost 2
H1(Loc1), H2(Loc2), R3(Loc3)------ cost 3
H1(Loc1), H2(Loc2), G3(Loc3)------ cost 4 
```

下一组，

```
H1(Loc1), L2(Loc2), H3(Loc3)------ cost 5
H1(Loc1), L2(Loc2), L3(Loc3)------ cost 6
H1(Loc1), L2(Loc2), R3(Loc3)------ cost 7
H1(Loc1), L2(Loc2), G3(Loc3)------ cost 8 
```

下一组，

```
H1(Loc1), R2(Loc2), H3(Loc3)------ cost 9
H1(Loc1), R2(Loc2), L3(Loc3)------ cost 10
H1(Loc1), R2(Loc2), R3(Loc3)------ cost 11
H1(Loc1), R2(Loc2), G3(Loc3)------ cost 12 
```

下一组，

```
H1(Loc1), G2(Loc2), H3(Loc3)------ cost 13
H1(Loc1), G2(Loc2), L3(Loc3)------ cost 14
H1(Loc1), G2(Loc2), R3(Loc3)------ cost 15
H1(Loc1), G2(Loc2), G3(Loc3)------ cost 16 
```

总共有 16 套，每套都有成本。并且，还会有 3 套 16 套（总共 64 套）。顺便说一句，顺序很重要，但不要重复。因此，{H1,G2,H3} 不同于 {G2,H1,H3} 和 {H1,H3,G2} 等等。

首先，我是否正确假设解决方案空间中可能的集合总数为 4^3 (y^x) 个集合？这个叫什么？我对术语感到困惑。排列，组合？

我需要选择成本最低的集合，或者显示所有成本大致相同的集合（比如彼此相差 10% 以内）。对于这个例子，我想我可以通过设置 3 个循环来处理它，每个位置一个循环，并迭代项目。

```
prevcost = 0.0
for loc1 items i:1 to 4
    for loc2 items j: 1 to 4
        for loc3 items k: 1 to 4
            cost = findcost(i,j,k)
            if cost < prevcost:
               prevcost = cost 
```

因为我已经有了与每组相关的成本；这是我调用的一个单独的例程来查找一组成本，我可以完成这项工作。

但是，如果我在每个位置有 40 个位置和 5 个可能的项目，我是否必须处理 5^40 组（9E+27！！）？我无法设置 40 个嵌套循环；递归是一个答案。但这需要一个聪明的搜索程序。我刚读完“模拟退火”技术，但不知道如何适应它。

该例程（最终）将能够为工业厂房环境中的管道系统找到物理现场支持的最佳组合。最好，我的意思是在支撑上产生最小负载的支撑组合。我计划（a）一次有选择地选择一个组合，（b）通过工程求解器运行它，（c）然后让我的例程解析结果文件以找到支撑载荷的总和（在所有位置），并迭代继续前进，直到找到最佳组合。

我用于“成本计算”的结果文件的格式在这里： [python genfromtxt questions](https://stackoverflow.com/questions/13595945/python-genfromtxt-problems)

寻找想法。感激地接受所有答案。谢谢你。

# javascript - javascript中是否有类似手写效果的插件？

> ID：13693769
> 
> 赞同：0
> 
> 时间：2012-12-03T23:39:55.407
> 
> 标签：javascript, jquery, fonts, html5-canvas, effects

我是一名学生，想为我的新生班级创建仪表板。为了让它更漂亮，我想使用手写效果。让我解释。

假设我有文本：“概率和预测的概念”。加载页面时，我希望该文本看起来好像正在被查看时写在页面上。

我是否疯狂地认为这是可能的，或者是否有我可以使用的 jquery 插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:50:55.820

如果您正在谈论打字机效果（参见我的评论），您可以找到像[这样的](http://return-true.com/2011/04/jquery-typewriter-revisited/)jQuery 插件。

如果您的意思是实际绘制字母，那么它超出了 jQuery 的基本功能，您需要查看图形/图表库。

[编辑] 请注意，无需插件即可在 jQuery（或 JavaScript）中轻松创建简单的打字机效果，[请参阅此处的几个示例](https://stackoverflow.com/questions/13461922/how-do-i-make-a-new-line-or-add-html-to-this-javascript-function)（包括我的现场演示）。但是，如果您需要处理 html，而不仅仅是文本，插件会有所帮助。

# java - Java GUI，多帧

> ID：13693776
> 
> 赞同：0
> 
> 时间：2012-12-03T23:40:24.910
> 
> 标签：java, swing, user-interface, jframe, overlay

我如何着手创建我在下面描述的内容？

首先，这是我的 GUI 的基本外观：

![在此处输入图像描述](../Images/6eee05f32b656750b4fabc0acdc58f69.png)

当我单击时，`Add New Account`我想让 GUI 弹出一个小窗口，用户可以在其中输入登录凭据。我需要将这些信息传递回主 GUI，所以我不知道如何处理这个问题。

`Preferences`或也是如此`Remove Account`。我如何着手创建各种“GUI 覆盖”。抱歉，我无法找出我正在寻找的效果的正确术语。

我想尝试使用`JOptionPane`'s，但经过一些研究，这似乎不是要走的路线。

`JFrame`当动作开始时，我也在玩弄创造一个新的想法。应该如何处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T00:15:03.677

首先在框架上使用对话框。对话框旨在从用户那里收集少量信息。

我将为您要执行的每个操作创建一个单独的组件。在这些组件中，我将提供 setter 和 getter 以允许您访问由组件管理的信息。

从那里我将使用 a`JOptionPane`或`JDialog`向用户显示组件。对我来说使用一个而不是另一个的原因归结为开始能够控制操作按钮（`Okay`例如`Cancel`）。对于像登录对话框这样的东西，我想限制用户开始点击`Login`按钮，直到他们提供了足够的信息来进行尝试。

基本的跟随将是这样的......

```
LoginDialog dialog = new LoginDialog(SwingUtilities.getWindowAncestor(this)); // this is a reference any valid Component
dialog.setModal(true); // I would have already done this internally to the LoginDialog class...
dialog.setVisible(true); // A modal dialog will block at this point until the window is closed
if (dialog.isSuccessfulLogin()) {
    login = dialog.getLogin(); // Login is a simple class containing the login information...
} 
```

`LoginDialog`可能看起来像这样......

```
public class LoginDialog extends JDialog {
    private LoginPanel loginPane;
    public LoginDialog(Window wnd) {
        super(wnd);
        setModal(true);
        loginPane = new LoginPanel();
        setLayout(new BorderLayout());
        add(loginPane);
        // Typically, I create another panel and add the buttons I want to use to it.
        // These buttons would call dispose once they've completed there work
    }

    public Login getLogin() {
        return loginPane.getLogin();
    }

    public boolean isSuccessfulLogin() {
        return loginPane.isSuccessfulLogin();
    }
} 
```

该对话框只是充当登录窗格的代理/容器。

这当然是一个概述，您需要填写空白；）

现在，如果您不想麻烦地创建自己的对话框，您可以利用它[`JOptionPane`](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)来代替。

```
LoginPanel loginPane = new LoginPanel();
int option = JOptionPane.showOptionDialog(
     this, // A reference to the parent component
     loginPane,
     "Login", // Title
     JOptionPane.YES_NO_OPTION,
     JOptionPane.QUESTION_MESSAGE,
     null, // You can supply your own icon it if you want
     new Object[]{"Login", "Cancel"}, // The available options to the user
     "Login" // The "initial" option
     );
if (option == 0) {
    // Attempt login...
} 
```

# scala - 为什么我在 Play 2 中收到“配置错误[Missing application.secret]”？

> ID：13693780
> 
> 赞同：2
> 
> 时间：2012-12-03T23:40:55.473
> 
> 标签：scala, playframework-2.0

我编写了一个 scala 方法来进行身份验证并在会话中保存一个特定的令牌，如下所示：

```
def logIn = Action(parse.json) { request =>
request.body.validate.map { entity =>
  Authentication.authenticate(entity.username, entity.password) match {
    case "" => NotFound(RestResponses.toJson(RestResponse(NOT_FOUND, "Invalid username or password.")))
    case token: String => Ok(RestResponses.toJson(RestResponse(OK, "Username %s has been succesfully logged in".format(entity.username)))).withSession(TokenKey -> token)
  }
}
  .recover { Result =>
    BadRequest(RestResponses.toJson(RestResponse(BAD_REQUEST, "Unable to parse content type for user authentication.")))
  } 
```

}

为了测试`logIn`方法，我写了一个测试方法：

```
"A POST request to login a user" should "return OK " in {
running(FakeApplication()) {
  val node = Json.toJson(AuthenticationUser("cristi", "cristi-password"))(controllers.AuthenticationService.authUserWrites);
  val result = AuthenticationService.logIn(new FakeRequest(Helpers.POST, "/", FakeHeaders(), node))

  status(result) should equal(OK)
  contentType(result) should be(Some("application/json"))
  contentAsString(result) should include("succesfully logged in")
} 
```

}

我只是不明白为什么会收到此错误：

```
[info] - should return OK  *** FAILED ***
[info]   play.api.PlayException: Configuration error[Missing application.secret]

[info]   at play.api.libs.Crypto$$anonfun$sign$2.apply(Crypto.scala:30)
[info]   at play.api.libs.Crypto$$anonfun$sign$2.apply(Crypto.scala:30) 
```

我确定这与会话有关...但是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T01:04:46.903

`application.secret=changeme`在您的`conf/application.conf`文件中添加一个。

# ios5 - iOS 版 Twitter 框架 - 为什么要导入 TWrequest.h ?

> ID：13693781
> 
> 赞同：0
> 
> 时间：2012-12-03T23:40:59.357
> 
> 标签：ios5, twitter, social, social-framework

在 Twitter 框架内部的 TWRequest.h 内部，它导入了这个

```
#import <Social/SLRequest.h> 
```

但是 TWRequest 是为 iOS 5 构建的，那么为什么它会导入 Social Framework 的文件，因为它们是为 iOS 6 构建的呢？

我收到这个错误..

```
'Social/SLRequest.h' file not found 
```

当然没有找到是因为我没有在Social Framework中添加，因为我要使用Twitter Framework。我不能简单地删除它，因为该文件是从社交框架引用的，我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T16:14:05.223

在 iOS 6 中，不推荐使用 Twitter 框架方法。相反，您应该使用 Social.framework。其中包括共享 Twitter 和 Facebook。

示例代码检查正在运行的操作系统版本以及可用的框架类是 iOS 5 - Twitter.framework 还是 6 - Social.framework

```
#import <Twitter/Twitter.h>
#import <Social/Social.h>

- (void) postTweet {
NSString *someTweet = @"someTweet";

// running on iOS5
if (NSClassFromString(@"TWTweetComposeViewController") && [TWTweetComposeViewController canSendTweet]) {

    TWTweetComposeViewController *tweetSheet = [[TWTweetComposeViewController alloc] init];

    [tweetSheet setInitialText:someTweet];
    [self presentModalViewController:tweetSheet animated:YES];

    // running on iOS6
} else if ( NSClassFromString(@"SLComposeViewController") && [SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter] ) {

    SLComposeViewController *tweetSheet = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];

    [tweetSheet setInitialText:someTweet];
    [self presentViewController:tweetSheet animated:YES completion:NULL];
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:14:35.663

这似乎更像是一个 xcode 问题。有时它有效，有时它抛出错误。我不得不退出 xcode 并重新启动它才能再次工作。它最终修复了自己。

# javascript - 在 Win 8 应用搜索合同中集成指向我的数据库的链接

> ID：13693790
> 
> 赞同：1
> 
> 时间：2012-12-03T23:41:59.543
> 
> 标签：javascript, windows-8

在我的 Win 8 应用程序中，基于空白模板，我已成功添加搜索合同，尽管我尚未将其链接到任何数据，但它似乎可以工作，所以，现在，当我在我的应用程序中搜索任何术语时它只是将我带到带有“未找到结果”消息的 searchResults 页面，这是我最初所期望的。

现在我想做的是将我的数据库链接到 searchResults.js 文件中，以便我可以查询我的数据库。现在在搜索合同之外，我已经测试并连接了我的 Db 并且它可以工作；我使用`WinJS.xhr`, 连接到我的网络服务，该服务反过来查询我的数据库并返回一个 JSON 对象。

在我的测试中，我只对 url 进行了硬编码，但是我现在需要做两件事。将用于连接我的数据库的测试`WinJS.xr`数据移动到搜索合同代码中，然后 - 将硬编码的 url 更改为接受用户搜索词的动态 url。

目前我对Win 8搜索的了解，搜索合约的实际数据查询部分如下：

```
// This function populates a WinJS.Binding.List with search results for the provided query.
    _searchData: function (queryText) {
        var originalResults;
        // TODO: Perform the appropriate search on your data.
        if (window.Data) {
            originalResults = Data.items.createFiltered(function (item) {
                return (item.termName.indexOf(queryText) >= 0 || item.termID.indexOf(queryText) >= 0 || item.definition.indexOf(queryText) >= 0);
            });
        } else {`enter code here`
            originalResults = new WinJS.Binding.List();
        }
        return originalResults;
    }
}); 
```

我需要转移到本节的代码如下；现在我不得不承认我目前不理解上面的代码块，也没有找到一个好的资源来逐行分解它。如果有人可以提供帮助，那将是非常棒的！我下面的代码，我基本上是想整合它，然后让 searchString 等于用户搜索词。

```
 var testTerm = document.getElementById("definition");
    var testDef = document.getElementById("description");

    var searchString = 2;
    var searchFormat = 'JSON';

    var searchurl = 'http://www.xxx.com/web-service.php?termID=' + searchString +'&format='+searchFormat;

    WinJS.xhr({url: searchurl})
      .done(function fulfilled(result)

      {
          //Show Terms                 
          var searchTerm = JSON.parse(result.responseText);

          // var terms is the key of the object (terms) on each iteration of the loop the var terms is assigned the name of the  object key
          // and the if stament is evaluated

          for (terms in searchTerm) {

              //terms will find key "terms"
              var termName = searchTerm.terms[0].term.termName;
              var termdefinition = searchTerm.terms[0].term.definition;

              //WinJS.Binding.processAll(termDef, termdefinition);
              testTerm.innerText = termName;
              testDef.innerText = termdefinition;
          }              
    },
              function error(result) {
                  testDef.innerHTML = "Got Error: " + result.statusText;
              },
              function progress(result) {
                  testDef.innerText = "Ready state is " + result.readyState;
              }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T07:25:21.807

我将尝试为您不太理解的代码段提供一些解释。我相信您上面的代码来自 Visual Studio 添加的默认代码。请参阅注释中的解释。

```
/**
 * This function populates a WinJS.Binding.List with search results 
 * for the provided query by applying the a filter on the data source
 * @param {String} queryText - the search query acquired from the Search Charm
 * @return {WinJS.Binding.List} the filtered result of your search query.
 */
_searchData: function (queryText) {
    var originalResults;
    // window.Data is the data source of the List View 
    // window.Data is an object defined in YourProject/js/data.js
    // at line 16 WinJS.Namespace.define（"Data" ...
    // Data.items is a array that's being grouped by functions in data.js
    if (window.Data) {
        // apply a filter to filter the data source
        // if you have your own search algorithm, 
        // you should replace below code with your code
        originalResults = Data.items.createFiltered(function (item) {
            return (item.termName.indexOf(queryText) >= 0 ||
                    item.termID.indexOf(queryText) >= 0 || 
                    item.definition.indexOf(queryText) >= 0);
            });
    } else {
        // if there is no data source, then we return an empty WinJS.Binding.List
        // such that the view can be populated with 0 result
        originalResults = new WinJS.Binding.List();
    }
    return originalResults;
} 
```

由于您正在考虑在自己的 Web 服务上进行搜索，因此您始终可以使您的`_searchData`函数异步并让您的视图等待从您的 Web 服务返回的搜索结果。

```
_searchData: function(queryText) {
    var dfd = new $.Deferred();
    // make a xhr call to your service with queryText
    WinJS.xhr({
        url: your_service_url,
        data: queryText.toLowerCase()
      }).done(function (response) {
           var result = parseResultArrayFromResponse(response);
           var resultBindingList = WinJS.Binding.List(result);
           dfd.resolve(result)
      }).fail(function (response) {
          var error = parseErrorFromResponse(response);
          var emptyResult = WinJS.Binding.List();
          dfd.reject(emptyResult, error);
      });
    return dfd.promise();
}
...
// whoever calls searchData would need to asynchronously deal with the service response.

_searchData(queryText).done(function (resultBindingList) {
    //TODO: Display the result with resultBindingList by binding the data to view
}).fail(function (resultBindingList, error) {
    //TODO: proper error handling
}); 
```

# raphael - 使用 Raphael 创建可重用对象

> ID：13693793
> 
> 赞同：0
> 
> 时间：2012-12-03T23:42:11.337
> 
> 标签：raphael

我遇到了一个简单的问题（我刚开始使用 lib）：

创建对象集、复制对象和转换对象的最有效方法是什么？

围绕中心点创建一堆圆圈：

```
var height = 150,
    width = 150,
    branchRadius = 20,
    centerX = width / 2,
    centerY = height / 2,
    treeCrownCenterOffset = 10,
    treeCrownRotationCenterX = centerX,
    treeCrownRotationCenterY = centerY - treeCrownCenterOffset,
    rotationCenter = [treeCrownRotationCenterX , treeCrownRotationCenterY],
    paper = Raphael('logo', height , width ),
    outerCircle = paper.circle(treeCrownRotationCenterX, treeCrownRotationCenterY, branchRadius).attr({fill:'#F00'}),
    innerCircle = paper.circle(treeCrownRotationCenterX, treeCrownRotationCenterY, branchRadius - 4).attr({fill:'#000'}),
    branch = paper.set([outerCircle, innerCircle]),
    crown = paper.set(),
    numCircles = 8, rotationStep = 360 / numCircles, i = 0;

for(; i < numCircles - 1 ; i++) {
    //Cloning a branch and pushing it to the crown after transforming it
    crown.push(branch.clone().transform('r' + ((i + 1) * rotationStep) + ',' + rotationCenter));

}

//Putting a second crown 200px right of the first crown
//Yes, I'm building a tree :-) No trunk at this point

crown.clone().transform('t200,0');​​​​​ 
```

如果你喜欢小提琴，这里是[小提琴](http://jsfiddle.net/kzSvA/42/)。

这是我的幼稚代码，认为一组克隆集（克隆分支的冠部）确实会移动到第一个冠部旁边的位置 (200, 0)。

它不起作用：看起来无法移动克隆的一组克隆元素：

```
crown.clone().transform('t200,0');​ 
```

执行此行时不会发生太多事情。

似乎“克隆”没有按照我的预期进行，并且转换不会被带到第二个（克隆的）对象集合中。

基本问题是：

如何使用 Raphael 创建可重用的对象？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T14:07:42.430

您正在克隆该集合，但由于您的画布只有 150 像素宽，因此将其翻译 200 像素会将其发送到保留位置 :)

但是，当您确实扩大画布的大小时，您会看到似乎只有一个圆圈已被克隆。不是这种情况。问题不在于克隆，而在于转型。

我发现转换是一个非常令人头疼的问题。行“crown.clone().transform('t200,0');​”正在将该转换应用于集合中的每个对象，但*我相信*它会覆盖旋转。即使不是，它也会在旋转后应用平移，使圆圈像离心力一样散开。

我知道您想避免遍历克隆集，但这有效：

```
var crown2 = crown.clone();
for (i = 0; i < crown2.length; i ++) {
    crown2[i].transform('t200,0r' + (i * rotationStep) + ',' + rotationCenter);
​}​ 
```

另外，请注意您没有将原始分支添加到集合中。你需要这个：

```
branch = paper.set([outerCircle, innerCircle]),
crown = paper.set(),
numCircles = 8, rotationStep = 360 / numCircles, i = 0;

//ADD ORIGINAL BRANCH TO SET
crown.push(branch); 
```

[更新了小提琴](http://jsfiddle.net/kzSvA/51/)。

# android - 将 jar 添加到构建路径后的 NoClassDefFoundError

> ID：13693802
> 
> 赞同：0
> 
> 时间：2012-12-03T23:42:46.547
> 
> 标签：android, eclipse, jar, noclassdeffounderror, dx

我正在 Eclipse 中开发一个 android 项目。我正在使用一些已添加到名为 lib 的文件夹中的 3rd 方 jar，并且已将所有 Jars 添加到构建路径中。我正在使用大约 44 个罐子。运行应用程序时出现 NoClassDefFoundError。为什么即使在将它添加到我的 buid 路径后我也会遇到这个问题？我真的很困惑，我将非常感谢一些帮助！

**编辑**我尝试在一个普通的java项目中使用相同的类文件，但没有出现错误，但它似乎不适用于android。我需要使用 dx 工具吗？

**编辑**我已将文件夹的名称更改为 libs，但是当我尝试运行我的应用程序时仍然出现某种错误，这是我在控制台中得到的：

```
 (org.apache.commons.logging.impl.LogFactoryImpl$1) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:31 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.impl.LogFactoryImpl$2) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:31 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.impl.LogFactoryImpl$3) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:31 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.impl.SimpleLog$1) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:31 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.impl.WeakHashtable$1) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:31 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.LogFactory$1) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:32 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.LogFactory$2) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:32 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.LogFactory$3) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:32 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.LogFactory$4) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:32 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.LogFactory$5) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:32 - NatureNation] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.logging.LogFactory$6) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class.
[2012-12-03 19:27:32 - NatureNation] Dx 
trouble processing "javax/xml/XMLConstants.class":

Ill-advised or mistaken usage of a core class (java.* or javax.*)
when not building a core library.

This is often due to inadvertently including a core library file
in your application's project, when using an IDE (such as
Eclipse). If you are sure you're not intentionally defining a
core class, then this is the most likely explanation of what's
going on.

However, you might actually be trying to define a class in a core
namespace, the source of which you may have taken, for example,
from a non-Android virtual machine project. This will most
assuredly not work. At a minimum, it jeopardizes the
compatibility of your app with future versions of the platform.
It is also often of questionable legality.

If you really intend to build a core library -- which is only
appropriate as part of creating a full virtual machine
distribution, as opposed to compiling an application -- then use
the "--core-library" option to suppress this error message.

If you go ahead and use "--core-library" but are in fact
building an application, then be forewarned that your application
will still fail to build or run, at some point. Please be
prepared for angry customers who find, for example, that your
application ceases to function once they upgrade their operating
system. You will be to blame for this problem.

If you are legitimately using some code that happens to be in a
core package, then the easiest safe alternative you have is to
repackage that code. That is, move the classes in question into
your own package namespace. This means that they will never be in
conflict with core system classes. JarJar is a tool that may help
you in this endeavor. If you find that you cannot do this, then
that is an indication that the path you are on will ultimately
lead to pain, suffering, grief, and lamentation.

[2012-12-03 19:27:32 - NatureNation] Dx 1 error; aborting
[2012-12-03 19:27:32 - NatureNation] Conversion to Dalvik format failed with error 1 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:50:47.533

您拥有库的文件夹必须命名为 libs，而不是 lib。请参阅[此处](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)了解更多信息。

# input - 从 J 中的行读取输入

> ID：13693806
> 
> 赞同：2
> 
> 时间：2012-12-03T23:42:59.427
> 
> 标签：input, j

我对 J 很陌生（为了好玩而学习它），我正在尝试从键盘读取数据。我试图制作一个读取字符串并将其反转的小脚本：

```
|.(1!:1 3) 
```

当我运行它时，我得到一个排名错误。（我使用 1!:1 3 而不是定义动词，因为 codegolf ...）是否有可以检查 1!:1 3 等级的命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T00:51:41.453

这是外国人常犯的错误。

外国的[定义](http://www.jsoftware.com/help/dictionary/dx001.htm)`1!:1`没有帮助，因为它真的写着：

```
1!:1 年阅读。y 是文件名或文件号（由 1!:21 产生）；这
结果是文件内容的字符串。例如 1!:1 <'abc.q'。以下
y 的值也是允许的：

1 从键盘读取（在脚本中不起作用）
3 从标准输入（stdin）读取

```

所以替换`y`应该`3`有效，对吧？好吧，不完全是，因为您真正以书面形式给出的论点是：

```
1!:1 3 
```

是一个由 组成的数组`1 3`。有点像给它：

```
1!:(1 3) 
```

当你想要的时候：

```
1!:1 (3) 
```

出于代码高尔夫的目的，请使用右括号：

```
1!:1]3 
```

# matlab - 使用 fopen/fclose 在 Matlab 中导入 CSV 文件，该文件具有不同长度的注释，没有特定的前导字符

> ID：13693808
> 
> 赞同：2
> 
> 时间：2012-12-03T23:43:08.843
> 
> 标签：matlab

我需要将一个 CSV 文件导入到 matlab 中，该文件有 ~160,000 行和 25 列。第 33 列对某些行进行了评论。评论有不同的长度，并且是文本的，例如，评论可能读作（没有引号）“因压制而死亡”（它是一个森林清单数据库）。

前四列代表树木测量的地点和时间。

该程序的最终目标是将文件中的信息整合到独特的小文件中，每个文件都将保存所有树木数据的独特地点和时间组合。

目前我使用的导入策略是

```
fid = fopen('TP07303_v1.csv','r');
tline = fgetl(fid);

% split the title line (header) and call it A
A(1,:) = regexp(tline,'\,','split');

% parse and read the rest of the file
ctr = 1;
while(~feof(fid))
    if ischar(tline)
        ctr = ctr + 1;
            tline = fgetl(fid);
            A(ctr, :) = regexp(tline,'\,','split');
    else
        break;
    end
end

fclose(fid); 
```

但是当我到达第一行的评论时，它就卡住了。我不需要评论我正在做的任何事情，并且很高兴不完全导入该列。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T13:17:43.163

我也对列数（25 或 33+？）感到困惑，但如果每行上的逗号数量不同，这就是你遇到问题的原因。这就是你不使用dlmread的原因吗？

此外 ischar 似乎是多余的，因为 tline 将始终是一个字符，除非您位于文件的末尾，但您正在循环该条件。实际上，您连续两次检查同一件事。

```
while(~feof(fid))
    ctr       = ctr + 1;
    tline     = fgetl(fid);
    tmp       = regexp(tline,'\,','split');
    % make sure to not assign more than 25 elements to this row of A
    A(ctr, :) = tmp(1:25);
    if numel(tmp)>25
        % do something with the rest
    end
end 
```

并且永远不会少于 25 个元素，对吧？

# java - 非静态方法

> ID：13693809
> 
> 赞同：0
> 
> 时间：2012-12-03T23:43:10.850
> 
> 标签：java, non-static

我在这里有一门课，目的是在按下键时在窗口中移动枪。但是，我收到关于从类型中引用非静态方法的错误。这是两个部分。错误出现在两个“if (k == .....”行。

```
private class Keyboard extends KeyAdapter {

    public void keyPressed (KeyEvent e) {

        int k = e.getKeyCode();

        if (k == 39) {Gun.move(10);}
        if (k == 37) {Gun.move(-10);}

    }

} 
```

* * *

```
public class Gun {

        private Color color;
        private int A,B,C,D;
        private int E,F,G,H;

        public Gun (Color c) {

            color = c;
            A = 375;
            B = 550;
            C = 50;
            D = 10;
            E = 395;
            F = 540;
            G = 10;
            H = 10;

        }

        public void move(int xAmount){

            A = A + xAmount;
            E = E + xAmount;

        }

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:45:42.663

哪个`Gun`？您需要一个*实例*，即对`Gun`由此创建的对象的引用：

```
Gun gun = new Gun(...);
gun.move(amount); 
```

您的`Keyboard`对象必须以某种方式引用该`Gun`对象，或者可能是某个知道您正在尝试移动`Gun`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:46:03.333

您的**move 方法**是一个**非静态方法**，因此应该使用 Gun 类的实例调用它。

```
 Gun gun = new Gun();//creating an instance of a Gun class.            
    if (k == 39) {gun.move(10);}
    if (k == 37) {gun.move(-10);} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:51:07.567

静态方法是不特定于给定对象实例的方法。它不适用于任何使一把枪与另一把枪不同的东西（实例变量）。您的移动方法不是静态的。它移动特定的枪。

当您将其称为：

```
Gun.move(10) 
```

您是在所有枪支上调用它，而不是在特定枪支上调用它（因此出现关于静态方法的错误）。为了移动一把枪，你必须有一把你想移动的枪。因此，您需要创建一把新枪（使用`new Gun(...)`）。

# grails - 圣杯邮件插件 - 无法添加多个收件人地址？

> ID：13693811
> 
> 赞同：2
> 
> 时间：2012-12-03T23:43:24.047
> 
> 标签：grails, grails-2.0, grails-controller

Grails 世界的新手。我在将逗号分隔的表单值从表单传递到 grails 邮件插件的“TO”属性时遇到问题。无论我尝试什么，我似乎都可以将它放入一个数组或接受多个电子邮件地址。

我收到以下错误；我已经删除了域名，所以请忽略它们。

```
Could not parse mail; nested exception is javax.mail.internet.AddressException:
Illegal address in string ``"ian@email.com","ian@otheremail.com"'' 
```

现在挠头，任何关于我在下面的代码中哪里出错的想法。我完全被难住了。！！

在 emailpublication GSP 表格中我有。这些字段是从数据库和文档 ID 中自动填充的。

```
<g:form action="emailpublication">

<g:field type="text" name="whogetsemail" value="${publicationInstance?.portfolio?.emailtemplates?.toemailtemplate}" /> 
<g:field type="text" name="publicationName" value="${publicationInstance?.publicationName}" />
<g:textArea type="text" name="publicationContent" value="${publicationInstance?.publicationContent}" cols="20" rows="20"/> 
<g:hiddenField name="id" value="${publicationInstance?.id}" />

<input type="submit" value="Send Email"/>
</g:form> 
```

在发布控制器中，我有以下内容；我需要通过 emailpublication gsp 表单中 whogetsemail 字段填充的一个或多个电子邮件地址发送至

```
def emailpublication(){

  List<String> recipients = request.getParameterValues("whogetsemail")
    try {
     sendMail{
             to  (recipients.toArray())
             from "ineilsen@emailaddress.com"
             subject params.publicationName
             text params.emailbodyheader + "\n"+"\n" + params.publicationContent + "\n"+"\n" + params.footeremailtemplate
         }

    }
    catch (MailException e) {
        log.error "Failed to send emails: $e.message", e
    }
    catch (MessagingException e) {
        log.error "Failed to send emails: $e.message", e
    }
    redirect(uri: "/publication/show/${params}")
            flash.message = "${params.publicationName} sent to ${params.emailto}"
} 
```

谢谢大家，期待回复，我很沮丧

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T03:21:57.683

该插件支持多个地址，它们可以是`Object[]`数组或`List`. 但是你得到一个逗号分隔的字符串，因为只有一个`whogetsemail`字段。`request.getParameterValues()`仅当有多个同名输入时才返回多个值。

如果您将其更改为以下内容，它应该可以工作：

```
List<String> recipients = params.whogetsemail.split(',').collect { it.trim() } 
```

和

```
to recipients 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:50:39.560

尝试去掉 to 地址周围的括号：

```
to  recipients.toArray() 
```

我在很多地方都这样做...

# jquery-mobile - 在 JQuery Mobile 中显示加载指示器

> ID：13693814
> 
> 赞同：2
> 
> 时间：2012-12-03T23:43:51.040
> 
> 标签：jquery-mobile

我们如何以编程方式`page loading`在 JQuery Mobile 中显示指标？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T23:46:55.050

```
$.mobile.loading("show");
$.mobile.loading("hide"); 
```

[http://jquerymobile.com/demos/1.2.0/docs/api/methods.html](http://jquerymobile.com/demos/1.2.0/docs/api/methods.html)

# r - 如何为泊松回归构建分层数据

> ID：13693817
> 
> 赞同：3
> 
> 时间：2012-12-03T23:44:07.360
> 
> 标签：r, regression, poisson

我正在尝试使用 R 对我拥有的一些数据进行泊松回归。目前的数据结构如下：

数据根据三个职业进行分层。数据中有四个收入水平。在每个阶层内，对于每个收入水平，都有

1.  发生的工作场所事故的数量，以及
2.  观察到的总人月数。

这是设置的示例。括号中的数字是观察到的总人月数，括号中的数字是工作场所事故的数量。

[![](../Images/637274debd510e2d68041cf5f9efef40.png)](https://i.stack.imgur.com/sWQxY.png)

我的问题是如何设置这些数据并对收入水平对工作场所事故发生的影响进行泊松回归？理想情况下，我想调整职业并找出仅收入的影响，但作为起点，我根本不知道如何将其设置为泊松回归问题。我想过做一些事情，比如将受伤次数除以观察月数，但这样会给出非整数值，所以我认为这不是正确的做法。

重申一下，预测指标：收入水平；反应变量：工作场所事故。

顺便说一句，如果这样做有意义的话，将括号数字分开并将它们放入自己的列中会很容易。

我非常感谢有关如何设置它的任何建议。我确信其他统计学家正在使用类似的结构化数据，并且可能也希望获得一些见解。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T00:08:47.880

@thelatemail 认为这更适合 stats.stackexchange.com 可能是正确的，但这里有一些 R 代码。该数据是宽格式的，您需要将其重新构建为长格式。（并且您不希望包括总计列。将前四列转换为长格式后，您将“职业”和“级别”作为因子类变量，将事故“计数”和“暴露”“月”作为数字列，您可以使用此调用来`glm`.

```
fit <- glm( counts ~ level + occup + offset(log(months)), data=dfrm, family="poisson") 
```

偏移量需要 log()-ed 以与 poisson-family 的默认链接函数创建的记录计数一致。

（你不能真的指望我们重做那个数据输入任务，现在可以吗？）

# c# - c#在if语句中为对象赋值

> ID：13693821
> 
> 赞同：-2
> 
> 时间：2012-12-03T23:44:48.000
> 
> 标签：c#, class, object, if-statement

我正在阅读一个文件，并逐行提供信息（这是我无法更改的）。如果该行具有 x 值并且如果该行具有 y 值，我想创建一个对象，则为该对象分配一些值。这被证明是非常具有挑战性的。显然我做错了什么。

```
if (line_split[i].Contains("LabelId"))
{
   try
   {
       gen.m_LabelId_pos.Add(multicast_ports[3], i);
       multicast my_multicast = new multicast();
   }
   catch
   {
   }
}
else if (line_split[i].Contains("TotalFrameSentCount_PerSecond"))
{
    try
    {                                    
        gen.m_TotalFrameSentCount_PerSecond_pos.Add(multicast_ports[3], i);
        // want to assign y value to the object here. but cant
    }
    catch
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:51:49.110

您可以在语句之外声明对象`if`，在块中实例化它，并在检查它不是之后`if`在块中设置它的值。像这样的东西：`else``null`

```
multicast my_multicast = null;
if (line_split[i].Contains("LabelId"))
{
   try
   {
       gen.m_LabelId_pos.Add(multicast_ports[3], i);
       my_multicast = new multicast();
   }
   catch
   {
   }
}
else if (line_split[i].Contains("TotalFrameSentCount_PerSecond"))
{
    try
    {                                    
        gen.m_TotalFrameSentCount_PerSecond_pos.Add(multicast_ports[3], i);
        if(my_multicast!=null)
        {
            //do something with my_multicast here
        }
    }
    catch
    {
    }
} 
```

顺便说一句，你应该避免吃你的`Exceptions`，如果出现问题，它们是为了帮助你，这样 catch 块会隐藏它们，你不会知道出了什么问题。采用

```
catch(Exception err)
{
} 
```

# mysql - SQL Server 中的 MySQL CREATE 语句

> ID：13693824
> 
> 赞同：1
> 
> 时间：2012-12-03T23:45:01.133
> 
> 标签：mysql, sql, sql-server

我是 SQL Server 的新手，需要将`CREATE`类似于以下的 MySQL 语句转换为 SQL Server。它包含“NOT NULL”列和其他一些类型。有人可以提供这个吗？很少有工具可以从 MySQL -> SQL Server 转换，尽管有几个可以反过来做。

```
CREATE TABLE a 
( a VARCHAR(100) NOT NULL
, b VARCHAR(150)
, c INT
, d DOUBLE
, e BIGINT
, f SMALLINT
) ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:14:26.063

MSDN 网站是帮助您入门的非常有价值的资源。`CREATE TABLE` [您可以在此处](http://msdn.microsoft.com/en-us/library/ms174979.aspx)阅读文档。

如果您还没有平台，请使用[SQL Fiddle](http://www.sqlfiddle.com)测试您的语句。`CREATE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T01:22:05.653

SQL Server 支持 NOT NULL（就像我所知道的每个 SQL 实现一样）

所以像：

```
CREATE TABLE table1
(
    cola VARCHAR(100) NOT NULL,
    colb VARCHAR(150),
    colc INT,
    cold FLOAT,
    cole BIGINT,
    colf SMALLINT
); 
```

应该可以正常工作。

请注意，SQL Server 不提供 DOUBLE 数据类型，但如果您确实需要存储那么多数据，则可以使用其他数据类型（例如十进制）来完成。

# markdown - Markdown：防止段落标签被包裹在标准 HTML 跨度标签周围

> ID：13693827
> 
> 赞同：4
> 
> 时间：2012-12-03T23:45:14.120
> 
> 标签：markdown, html, word-wrap

我想混合标准 HTML 和 Markdown。我有一个用 Markdown 编写的段落，然后是一个 HTML`<span>`元素。

问题是：如果我不在段落后面加上 return：`<span>`将紧跟在段落`<p>`标签内的文本之后：

```
<p>Some text  
<span>My span</span>  
</p> 
```

但是，如果我确实在段落之后放了 return（用 Markdown 编写），那么`<span>`单独的将被包裹在`<p>`标签中，如下所示：

```
<p>Some text</p>  
<p><span>My span</span></p> 
```

我想要的只是这样：

```
<p>Some text</p><span>My span</span> 
```

对不起，如果我忽略了一些非常明显的东西，我很累。谢谢！

（如果有帮助，我正在使用 Kramdown 进行转换）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T00:35:45.043

没关系，我已经想通了！:) 因此，在 Kramdown 中，您可以使用某种转义，以防止解析其中的内容，但您必须小心在前后都留下空白行：

```
<p>Some text</p>  
return  
{::nomarkdown}  
<span>My Span</span>  
{:/}  
return  
... 
```

# javascript - jquery表单将更改的值提交到整个表单

> ID：13693831
> 
> 赞同：0
> 
> 时间：2012-12-03T23:45:27.453
> 
> 标签：javascript, jquery

在我的jQuery中，我有

```
$('form#submit :input').val(""); 
```

成功后将表单的值更改为空：。问题在于它改变了表单中所有内容的每个值。

```
<form id="submit" method="post" name="submit" action=""><input type="hidden" name="word" id="word" value="<?=$word?>"><textarea name="sentence" id="sentence" cols="45" rows="5"></textarea><input type="submit" value="Submit" style="font-size:2em; vertical-align:bottom" /></form> 
```

所以 textarea 和 submit 按钮被清空了。我希望 textarea 空白，而不是按钮。有没有办法只指定按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:48:42.370

这样做

```
$('form#submit :input').not('input[type="submit"]').val(""); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/ag6z9/)**

# jquery - 尝试使用 Yii 框架将 HTML5 画布作为图像保存到服务器

> ID：13693833
> 
> 赞同：1
> 
> 时间：2012-12-03T23:45:34.767
> 
> 标签：jquery, canvas, yii

我一直在尝试解决这个问题大约一周，并使用了网上找到的几种解决方案。我无法将它们中的任何一个应用于 yii。

这是单击提交后触发没有问题的单击功能。

```
<script>

function saveDrawing() {
 var canvas = document.getElementById("canvas").toDataURL("image/png");
 $.post('<?php echo Yii::app()->createUrl("generator/save")? >', { imageData: canvas } );
}
</script> 
```

我通过 firebug 运行它，似乎它没有找到处理此请求的 URL。我尝试了几种不同的 URL 参数来访问表单处理页面。

这是生成器控制器中它试图找到的动作

```
 public function actionSave()
    {

        if(isset($_POST['imageData']))
        {
           $data = substr($_POST['imageData'], strpos($_POST['imageData'], ",") + 1);
            $decodedData = base64_decode($data);
            $model->image=$_POST['imageData'];
            $model->save();
            $fp = fopen(Yii::app()->request->baseUrl.'/images/canvas.png', 'wb');
            fwrite($fp, $decodedData);
            fclose();
        }
       $this->render('save');

    } 
```

# iphone - 导航项顶部的 UIView

> ID：13693836
> 
> 赞同：0
> 
> 时间：2012-12-03T23:45:43.743
> 
> 标签：iphone, objective-c, uiview, storyboard

我有一个嵌入在导航控制器中的视图控制器。因此这个视图控制器在顶部有一个导航项。您可以在 ios6 故事板中做的一件事是您可以为此视图控制器设置标题、提示和后退按钮（因为它嵌入在导航控制器中）。

话虽如此，当我指定标题并测试应用程序时，一切看起来都不错。但是，当我将一个透明的 UIView 放在导航项的顶部（例如标题所在的位置）时，标题本身就消失了。我在界面生成器中输入的文本本身已经消失了。我已经证明了这一点，因为如果我删除我创建的视图，我最初拥有的文本就会消失。

我试图通过在界面构建器之外实际设置标题本身来解决问题：

```
self.navigationItem.title=@"My Title"; 
```

但这似乎也不起作用。有没有人知道如何在导航控制器中的 navigationItem 顶部隐藏/显示透明 UIView？

**编辑**

我放置在导航控制器工具栏中的任何 UI 元素似乎都阻止了底层标题文本的显示。即使元素被标记为透明并且它被设置为隐藏，也会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T01:18:46.120

我的理解是，如果您使用 UIBarButtonItem 类以编程方式执行相同的操作，Interface Builder 或多或少会模仿您会做什么。导航栏中的各种项目是 UIBarButtonItem 类的实例。此类具有以下初始值设定项：

```
– initWithBarButtonSystemItem:target:action:
– initWithCustomView:
– initWithImage:style:target:action:
– initWithTitle:style:target:action:
– initWithImage:landscapeImagePhone:style:target:action: 
```

当您只有导航控制器的标题时，Interface Builder 会将其视为使用`initWithTitle:`初始化程序。基本上，这意味着，在后台，使用给定标题创建了一个 UILabel 类，并将 UILabel 用作 UIBarButtonItem 的视图。

但是，当您将透明视图拖到标题上时，Interface Builder 正在执行相当于调用`initWithCustomView:`. 这意味着您提供的视图被用作 UIBarButtonItem 的视图。换句话说，当您将自定义视图拖到标题上时，您并没有将其*放在*标题的顶部。您正在用透明视图*替换*标题。

一种选择可能是创建一个同时具有 UILabel 和透明视图作为子视图的视图。然后将该视图作为导航栏的标题。如果你给那个 UILabel 正确的字体大小和阴影，它看起来与系统的默认标题没有区别，你也可以在它上面有透明的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:28:28.893

在 IB 中，您可以将 UIView 拖到导航栏的中心，这将替换默认存在的 titleView（您可以在代码中使用 setTitleView 进行操作：）。如果您使其背景清晰并为其添加标签以保存标题，它将看起来像默认标题。然后，您可以添加另一个 UIView 作为此视图的子视图，就像添加任何其他 UIView 一样。

# php - 查找会话数组中所有键的总和

> ID：13693840
> 
> 赞同：0
> 
> 时间：2012-12-03T23:46:29.013
> 
> 标签：php, arrays, session, key, sum

我正在使用表单在 Session 中创建多个数组。每次提交表单时，都会创建一个包含新数组的新 _SESSION['item'][]。代码：

```
$newitem = array (
    'id' => $row_getshoppingcart['id'] ,
    'icon' => $row_getimages['icon'],
    'title' => $row_getimages['title'],
    'medium' => $row_getshoppingcart['medium'],
    'size' => $row_getshoppingcart['size'],
    'price' => $row_getshoppingcart['price'],
    'shipping' => $row_getshoppingcart['shipping']);

$_SESSION['item'][] = $newitem; 
```

根据用户提交表单的次数，可以有任意数量的项目数组。如何从整个会话中的每个项目中获取关键“价格”的总和并在页面上回显？

提前感谢您的宝贵时间。对此，我真的非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:53:44.957

试试这个（未经测试）：

```
$sum = 0;
foreach ($_SESSION['item'] as $item)
    $sum += $item['price'];
echo $sum; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:51:47.423

遍历它们：

```
$total = 0;
foreach($_SESSION['item'] as $item) {
    $total += $item['price'];
}
echo $total; 
```

# c++ - 为什么我收到错误“cin 没有命名类型”

> ID：13693842
> 
> 赞同：4
> 
> 时间：2012-12-03T23:46:40.247
> 
> 标签：c++, compiler-errors

尝试编写此代码时，出现错误`"cin doesnt name a type"`。我不知道到底是什么问题，我试着写“使用命名空间标准；” 但它给出了同样的错误。

这是代码

```
#include<iostream>

namespace myStuff {

    int value = 0;

}

using namespace myStuff;

int main {

    std::cout << "enter integer " << ;
    std::cin >> value;
    std::cout << "\nyouhaveenterd a value" << value ;

    return 0;

} 
```

这是编译错误：

```
: extended initializer lists only available with `-std=c++0x` or `-std=gnu++0x` [enabled by default]|
: expected primary-expression before ‘;’ token|
 expected `}` before `;` token|
 `cin` does not name a type|
: `cout` does not name a type|
: expected unqualified-id before `return`|
: expected declaration before `}` token|
||=== Build finished: 6 errors, 1 warnings ===| 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T23:49:30.457

```
int main{ 
```

应该

```
int main(){ 
```

和

```
std::cout << "enter integer " << ; 
```

应该

```
std::cout << "enter integer "; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:49:17.997

在这条线上：

```
std::cout << "enter integer " << ; 
```

没有相应的操作数可以使语句在语法上有效。这可能是你错误的根源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:50:04.410

它的前一行。

```
 cout<<"enter integer" **<<** ; 
```

最后一个 << 期待一个从未给出的论点

# maven - Maven 仓库

> ID：13693852
> 
> 赞同：2
> 
> 时间：2012-12-03T23:47:18.997
> 
> 标签：maven

我是新手。我仍然无法掌握它的概念。

例如，我正在寻找 com.extjs:gxt:jar:2.2.5 或 org.syslog4j:syslog4j:jar:0.9.46。我在任何回购中都找不到它们。然而，它们似乎相当普遍。

这是否意味着我必须手动下载它们？它不是打败了 maven 的整个想法吗？

我在哪里可以找到一个包含所有这些工件的好的存储库，这样我就不需要手动下载 jars 了？

使用 maven 时我做错了什么，这绝对不是要走的路……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T03:28:28.793

你没有做错什么。问题是这些工件不存在于[Maven 中央存储库](http://search.maven.org/#browse)中。默认情况下，这是 Maven 将从中下载的唯一存储库。您可以添加其他存储库（请参阅 maven 文档）来配置未自动镜像到中央的存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T06:35:26.000

正如@Michael 所说，你没有做错任何事。

默认的 Maven 中央存储库不会提供地球上所有可能的工件。

通常你可以有两种方法来解决它：

1）您使用的工件可能由某些组织提供，他们提供自己的存储库来托管这些工件。告诉 Maven 查找这些存储库，以便 Maven 可以检索相应的工件。

或者

2）获取JAR等并放入您的本地环境。

上述工作有两种最常用的方式：

A) 拥有一个“本地”maven 存储库/代理（例如 Nexus、Artifactory），并使您的 Maven 指向该存储库。添加新的远程存储库 (1) 主要是通过在本地 Maven 存储库下向代理添加额外的存储库来完成的。通过将 JAR 部署到本地存储库来手动处理第 3 方工件 (2)。

B) 全部由您当地的 Maven 在本地完成。通过更新 settings.xml（或您的项目 POM.xml）来添加新的远程仓库 (1)。通过将 3rd 方 JAR 安装到本地存储库来手动处理 3rd 方工件 (2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-21T13:00:44.620

您可以使用

```
<dependency>
        <groupId>com.extjs</groupId>
        <artifactId>gxt</artifactId>
        <version>2.3.0-gwt22</version>
    </dependency> 
```

# javascript - Highcharts - 如何从任意值开始 x 轴

> ID：13693854
> 
> 赞同：7
> 
> 时间：2012-12-03T23:47:26.573
> 
> 标签：javascript, highcharts

我正在使用 [highcharts][1] 在数据库中的一系列值之间绘制图表。我希望 X 轴值从用户输入开始。

例如，如果用户想要介于 50 和 100 之间的值，我希望我的 x 轴从 50 开始。

该范围将具有可变大小。数据的大小很大，所以我不能做一些事情，比如获取所有数据并使用最小值和最大值进行显示。

提前致谢。

这是我的图表对象。我有两个用户输入字段，用于查询数据库并返回其间的行。

我使用多种类型的图表。问题是，如果我从数据库中获取 50 到 100 之间的数据，我不知道如何将 X 轴的起点定义为 50。它显示 50 个值，但从 0 到 50 开始。

我尝试了 10 分钟等。那确实从该值开始，但会跳过前 10 个左右的值。

输入字段的 id 为“lower”和“upper”。

* * *

```
var options = {
      chart: {
        renderTo: ctn.attr('id'),
        type: $('#graph_type option:selected').val(),
        zoomType: 'x'
      },
      title: {
        text: $('#graph_title').val()
      },
      subtitle: {
          text: "Graph - " + (graph_no + 1)
      },
      xAxis: {

        title: {
           text: $('#x_label').val()
        }
      },
      yAxis: {
        title: {
          text: $('#y_label').val()
        }
      },

      credits: {
        enabled: false
      },
      series: []
    }; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-04T17:16:39.900

感谢大家的回复。我找到了解决方案。Min max 实际上并没有按照我的意愿去做。

我找到了解决方案。

要从所需值开始 x 轴值，请使用

```
plotOptions:
     <your_graph_type>:{
             pointStart: <your_value>
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-04T05:28:18.370

我认为为 xAxis 设置最小值和最大值会起作用。 [参考这个链接](http://api.highcharts.com/highcharts#xAxis.min)

你可以说

startOnTick：假，endOnTick：假

例如参考：[example](http://jsfiddle.net/nagoba/dP8cL/)

我将 y 的最小值设置为 20，最大值设置为 217，

```
yAxis: {
        min: 20,
        max:217,
        startOnTick: false,
        endOnTick:false
    }, 
```

查看图表的显示方式。我希望这有帮助。

# php - PHP MYSQL 类和 SQL 问题

> ID：13693864
> 
> 赞同：0
> 
> 时间：2012-12-03T23:48:41.667
> 
> 标签：php, mysql

我已经使用 PHP 好几年了，OOP、类等对我来说并不是一个陌生的概念，但出于某种原因，有一些事情（没有）发生，我可以理解，现在是凌晨 1 点，并且它可能与它有关，但请......有人让我摆脱了午夜的痛苦！

我有一个 PHP DB 类和一个填充的 DB，还有几个函数在这里发挥作用。我知道数据库中有超过 50 行应该返回，但我一直只得到一个！

这是我的数据库连接课程..

```
Class DbConnect { 

var $host = 'localhost'; 
var $user = 'user'; 
var $password = 'pass'; 
var $database = 'db'; 
var $persistent = false; 

var $conn = NULL; 

var $result= false; 
var $error_reporting = false; 

/*constructor function this will run when we call the class */ 

function DbConnect () {

    $host = 'localhost'; 
    $user = 'user'; 
    $password = 'pass'; 
    $database = 'db'; 
    $persistent = false;
    $error_reporting = true;

    $this->host = $host; 
    $this->user = $user; 
    $this->password = $password; 
    $this->database = $database; 
    $this->persistent = $persistent; 
    $this->error_reporting = $error_reporting;

} 

function open() { 

    if ($this->persistent) { 

        $func = 'mysql_pconnect'; 

    } else { 

        $func = 'mysql_connect'; 

    }             

    /* Connect to the MySQl Server */ 

    $this->conn = $func($this->host, $this->user, $this->password); 

    if (!$this->conn) { 

        return false; 

    } 

    /* Select the requested DB */ 

    if (@!mysql_select_db($this->database, $this->conn)) { 

        return false; 
    } 

    return true; 
} 

/*close the connection */ 

function close() { 

    return (@mysql_close($this->conn)); 

} 

/* report error if error_reporting set to true */ 

function error() { 

    if ($this->error_reporting) { 

        return (mysql_error()) ; 

    } 

} 

function query($sql) { 

    $this->result = @mysql_query($sql, $this->conn); 

    return($this->result != false); 

}

function affectedrows() { 

    return(@mysql_affected_rows($this->conn));

} 

function numrows() { 

    return(@mysql_num_rows($this->result)); 

}

function fetchobject() { 

    return(@mysql_fetch_object($this->result, MYSQL_ASSOC)); 

}

function fetcharray() { 

    return(mysql_fetch_array($this->result)); 

 } 

 function fetchassoc() { 

     return(@mysql_fetch_assoc($this->result)); 
 } 

 function freeresult() { 

      return(@mysql_free_result($this->result)); 

 } 
```

}

好的，这是我的实际查询功能...

```
function getAllProperties() {

    $propertyArray = array();
    $db = new DbConnect(); 
    $db->open() or die($db->error());      
    $db->query("select * from properties");
    $details=$db->fetchassoc();
    // UNCOMMENT FOR DEBUG ---->> var_dump($details);
    $a=0;
    foreach($details as $field=>$value) {

        if($field == 'pid') {
            $propertyArray[$a] = getPropertyDetails($value);
            $a++;
        }
    }
    $db->close();
    return $propertyArray;
}

function getPropertyDetails($pid) {

$propertyArray = array();
$propertyDetails = array();
$propertyFeatures = array();
$propertyImages = array();
    $propertyReviews = array();
    $propertyBookings = array();

    $db = new DbConnect(); 
    $db->open() or die($db->error());

    // property details
    $db->query("select * from properties where pid = $pid");
$a = 0;
    while($details=$db->fetchassoc()) {
    $propertyDetails[$a]['pid'] = $details['pid'];
            $propertyDetails[$a]['name'] = $details['name'];
    $propertyDetails[$a]['description'] = $details['description'];
    $propertyDetails[$a]['rooms'] = $details['rooms'];
    $propertyDetails[$a]['baths'] = $details['baths'];
    $propertyDetails[$a]['sleeps'] = $details['sleeps'];
    $propertyDetails[$a]['rental'] = $details['rental'];
    $propertyDetails[$a]['sale'] = $details['sale'];
    $propertyDetails[$a]['forsale'] = $details['forsale'];
    $a++;
    }

    // property details
    $db->query("select * from images where pid = $pid order by weight asc");
$a = 0;
    while($details=$db->fetchassoc()) {
            $propertyImages[$a]['src'] = $details['img'];
    $propertyImages[$a]['thumb'] = $details['thumb'];
    $propertyImages[$a]['alt'] = $details['description'];
    $propertyImages[$a]['weight'] = $details['weight'];
    $propertyImages[$a]['iid'] = $details['iid'];
    $propertyImages[$a]['pid'] = $details['pid'];
    $a++;
    }

    // property details
    $db->query("select * from property_features pf join features f on f.fid = pf.fid where pid = $pid");
$a = 0;
    while($details=$db->fetchassoc()) {
    $propertyFeatures[$a]['fid'] = $details['fid'];
    $propertyFeatures[$a]['name'] = $details['name'];
    $propertyFeatures[$a]['description'] = $details['description'];
    $propertyFeatures[$a]['img'] = $details['img'];
    $propertyFeatures[$a]['pid'] = $details['pid'];
    $a++;
    }

    // property details
    $db->query("select * from testimonials where pid = $pid");
$a = 0;
    while($details=$db->fetchassoc()) {
    $propertyReviews[$a]['tid'] = $details['tid'];
    $propertyReviews[$a]['pid'] = $details['pid'];
    $propertyReviews[$a]['by'] = $details['by'];
    $propertyReviews[$a]['body'] = $details['body'];
    $propertyReviews[$a]['stars'] = $details['stars'];
            $propertyReviews[$a]['cid'] = $details['cid'];
    $a++;
    }

    // property details
    $db->query("select * from availability where pid = $pid");
    $b = 0;
    while($bookings=$db->fetchassoc()) {
            $propertyBookings[$b]['aid'] = $bookings['tid'];
            $propertyBookings[$b]['pid'] = $bookings['pid'];
            $propertyBookings[$b]['from'] = $bookings['by'];
            $propertyBookings[$b]['to'] = $bookings['body'];
            $propertyBookings[$b]['cid'] = $bookings['cid'];
            $b++;
    }

    $db->close();

$propertyArray = array(
    'details' => $propertyDetails,
    'images'  => $propertyImages,
    'features'=> $propertyFeatures,
            'reviews' => $propertyReviews,
            'bookings'=> $propertyBookings
            );

    return $propertyArray;

} 
```

我的期望是看到一个漂亮的胖数组，其中包含大量属性（我的意思是建筑物）和大量子数组以及更多数据......我得到的是这个微不足道的产品......

```
array(1) { 
[0]=> array(5) { 
    ["details"]=> array(1) { 
        [0]=> array(9) { 
            ["pid"]=> string(1) "1" 
            ["name"]=> string(12) "Casa De Paul" 
            ["description"]=> string(134) "a small, dark, damp building in the middle of nowhere with no shops, or roads, lots of spiders and a spikey bed for almost one person." 
            ["rooms"]=> string(1) "2" 
            ["baths"]=> string(1) "1" 
            ["sleeps"]=> string(1) "4" 
            ["rental"]=> string(4) "0.00" 
            ["sale"]=> string(4) "0.00" 
            ["forsale"]=> string(1) "0" } } 
    ["images"]=> array(0) { } 
    ["features"]=> array(0) { } 
    ["reviews"]=> array(0) { } 
    ["bookings"]=> array(0) { } } } 
```

仅供参考：当我使用“从属性中选择 *”查询 phpMyAdmin 中的数据库时，我得到了我所期望的所有结果......

我错过了一些东西 - 或者烤过头了，我看不到它，我的头快要流行了！

在此先感谢 SO 的人们：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:47:49.883

似乎在您调用`mysql_fetch_assoc($this->result)`第一个详细信息查询并循环遍历资源结果之后，指针不再指向任何行。

如果您决定再次循环遍历相同的资源结果，该函数将始终返回 false，因为它将假定没有更多行。

尝试在每次循环后重置指针：

```
// Reset Pointer.
mysql_data_seek( $this->result );

$db->query("select * from images where pid = $pid order by weight asc");
$a = 0;
while($details=$db->fetchassoc()) {
    $propertyImages[$a]['src'] = $details['img'];
    $propertyImages[$a]['thumb'] = $details['thumb'];
    $propertyImages[$a]['alt'] = $details['description'];
    $propertyImages[$a]['weight'] = $details['weight'];
    $propertyImages[$a]['iid'] = $details['iid'];
    $propertyImages[$a]['pid'] = $details['pid'];
    $a++;
}

mysql_data_seek( $this->result );

// etc.... 
```

然后继续您的下一个查询并获取数据循环。

# facebook - 访问未发布页面中的预定帖子

> ID：13693865
> 
> 赞同：2
> 
> 时间：2012-12-03T23:48:55.737
> 
> 标签：facebook, scheduling

我注意到我可以通过在 Facebook 帖子中设置 schedule_publish_time 字段来安排帖子。

我注意到我还可以在未发布的页面上安排帖子。但是，当我查询页面的 Graph API 端点时，我无法查询我已经安排的任何这些帖子，这些帖子是我之前使用该方法安排的。

有没有办法在未发布的页面中查看这些预定的帖子？

# html - 如何删除 CSS line-through

> ID：13693866
> 
> 赞同：10
> 
> 时间：2012-12-03T23:48:56.980
> 
> 标签：html, css

我正在尝试删除`text-decoration:line-through;`应用于我的元素的样式，但我似乎无法这样做。我已经尝试过`text-decoration:none;`，但它不起作用。

当我申请`text-decoration:underline;`时`span`，似乎`line-through`浏览器没有替换样式，而是添加了`underline`样式。

我知道我总是可以重新编写我的 HTML，因此需要 a 的元素`line-through`有自己的类。我想知道除了重组我的 HTML 是否还有其他选择。

[http://jsfiddle.net/wshHW/](http://jsfiddle.net/wshHW/)

```
<style>
p { text-decoration:line-through; }
span { text-decoration:none; }
</style>

<p>Foo <span>bar</span></p> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T23:49:56.000

> 我知道我总是可以重新编写我的 HTML，因此需要 a 的元素`line-through`有自己的类。我想知道除了重组我的 HTML 是否还有其他选择。

并不真地。您看到的行为完全[是设计使然](http://www.w3.org/TR/CSS21/text.html#lining-striking-props)；祖先将始终将其文本装饰传播给某些后代，相反，您不能从后代中影响祖先的文本装饰。

[`text-decoration-skip`尽管从即将到来的 CSS3 文本装饰模块](http://www.w3.org/TR/css-text-decor-3/#text-decoration-skip-property)看起来很有希望，但目前还没有一个非常可行的重组替代方案。

# php - 在 PHP 命名空间中定义全局函数

> ID：13693868
> 
> 赞同：24
> 
> 时间：2012-12-03T23:49:06.630
> 
> 标签：php, namespaces

是否**可以**从 PHP 命名空间（在具有[命名空间](http://php.net/manual/en/language.namespaces.definition.php)声明的文件中）定义全局函数？如果是这样，怎么做？

```
<?php
namespace my_module;

# bunch of namespaced functions
# ...
# then I want to define a global function my_module()
# that is an alias to my_module\mymodule() 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-03T23:59:14.170

这是可能的，但除了设计不好之外，您还必须将代码括在每个命名空间[的括号内](http://php.net/manual/en/language.namespaces.definitionmultiple.php)，并且无法使用，`namespace my_module;` 而是必须是`namespace my_module { ... }`.

例子：

```
namespace my_module {

    function module_function()
    {
        // code
    }
}

namespace {
    // global namespace.

    function my_module()
    {
        // call your namespaced code
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-11T10:37:56.893

“包含”文件中定义的函数具有全局范围。

所以（我还没有验证这一点）你可以把你的函数声明放在一个小文件中，并包含它。

不完全是问题中的设想。

另一种方法是创建一个局部函数，并在其中使用“全局”关键字，并将一个闭包分配给一个全局变量——然后可以在任何你想要的地方“作为一个函数”使用它。我当然已经为普通变量做到了这一点，而且我认为它没有理由不适用于闭包。

# c++ - 不可复制类型的复制列表初始化

> ID：13693871
> 
> 赞同：10
> 
> 时间：2012-12-03T23:49:21.043
> 
> 标签：c++, c++11

**12.6.1 - 显式初始化**

```
struct complex {
  complex();
  complex(double);
  complex(double,double);
};

complex sqrt(complex,complex);

complex g = { 1, 2 };  // construct complex(1, 2) 
                       // using complex(double, double) 
                       // and *copy/move* it into g 
```

**8.5 初始化器**

> 14 - 表单中发生的初始化
> 
> `T x = a;`
> 
> 以及在参数传递、函数返回、抛出异常 (15.1)、处理异常 (15.3) 和聚合成员初始化 (8.5.1)**中称为复制初始化**。[注意：复制初始化可能会调用移动（12.8）。——尾注]
> 
> 15 - 表单中发生的初始化
> 
> `T x(a);`
> 
> `T x{a};`
> 
> 以及在 new 表达式 (5.3.4)、static_cast 表达式 (5.2.9)、函数符号类型转换 (5.2.3) 以及基类和成员初始化器 (12.6.2)**中称为直接初始化**。

**8.5.4 列表初始化[dcl.init.list]**

> 1 - 列表初始化是从一个花括号初始化列表初始化一个对象或引用。这样的初始化器称为初始化器列表，列表中以逗号分隔的初始化器子句称为初始化器列表的元素。初始化列表可能为空。列表初始化可以发生在直接初始化或复制初始化上下文中；**直接初始化上下文**中的列表 初始化称为直接列表初始化，而**复制初始化上下文**中的列表初始化称为复制列表初始化。

## 原子问题

**29.6.5 原子类型操作的要求 [atomics.types.operations.req]**

> `#define ATOMIC_VAR_INIT(value)`见下文
> 
> 该宏扩展为一个令牌序列，适用于对与值初始化兼容的类型的静态存储持续时间的原子变量的常量初始化。[注意：此操作可能需要初始化锁。— end note ] 对正在初始化的变量的并发访问，即使是通过原子操作，也构成了数据竞争。[ 例子：
> 
> `atomic<int> v = ATOMIC_VAR_INIT(5);`

根据前面的部分，似乎不应该在没有涉及复制构造函数的情况下进行赋值初始化，即使它根据 §12.8.31 和 §12.8.32 被省略，但原子定义为：

**29.5 原子类型 [atomics.types.generic]**

```
atomic() noexcept = default;
constexpr atomic(T) noexcept;
atomic(const atomic&) = delete;
atomic& operator=(const atomic&) = delete;
atomic& operator=(const atomic&) volatile = delete;
T operator=(T) volatile noexcept;
T operator=(T) noexcept; 
```

没有复制构造函数！

通常，`ATOMIC_VAR_INIT`扩展为大括号表达式以进行大括号初始化，但`atomic<int> v = {5}`仍然是赋值初始化，并且在直接构造临时对象后暗示复制构造。

我查看了“常量初始化”部分，看看是否存在允许在没有副本的情况下执行此操作的漏洞（因为“宏扩展为一个令牌序列，适合于常量初始化一个类型的静态存储持续时间的原子变量初始化兼容值”），但我已经放弃了。

相关讨论：

[http://thread.gmane.org/gmane.comp.lib.qt.devel/8298](http://thread.gmane.org/gmane.comp.lib.qt.devel/8298)

[http://llvm.org/bugs/show_bug.cgi?id=14486](http://llvm.org/bugs/show_bug.cgi?id=14486)

## 编辑

在构建扣除过程时引用相关标准部分的答案将是理想的。

## 结论

因此，在 Nicol Bolas 给出了很好的回答之后，有趣的结论是`complex g = { 1, 2 }`标准建议的不复制（复制列表初始化像直接列表初始化一样解析）的副本（它是复制初始化上下文）有一个复制操作（12.6.1: `...and copy/move it into g`）。

## 使固定

拉取请求：[https ://github.com/cplusplus/draft/pull/37](https://github.com/cplusplus/draft/pull/37)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-04T00:52:50.287

```
complex g = { 1, 2 };  // construct complex(1, 2) 
                       // using complex(double, double) 
                       // and *copy/move* it into g 
```

这是不真实的。我并不是说复制/移动会被忽略；我的意思是不会有复制或移动。

您引用了 8.5 p14，它定义`T x = a;`为*copy-initialization*。这是真的。但它接着定义了初始化的实际工作方式：

从 8.5，第 16 页开始：

> 初始化器的语义如下。目标类型是正在初始化的对象或引用的类型，源类型是初始化表达式的类型。如果初始化器不是单个（可能是带括号的）表达式，则未定义源类型。
> 
> *   如果初始值设定项是（无括号的）大括号初始化列表，则对象或引用是列表初始化的（8.5.4）。

那里的权利意味着*复制初始化*规则*不适*用于*花括号初始化列表*。它们使用一组单独的规则，如 8.5.4 中所述。

您引用了 8.5.4，它定义`T x = {...};`为*copy-list-initialization*。您的推理出错的地方是您从未查看过*copy-list-initialization 的*实际*作用*。没有复制；这就是它的*名字*。

*复制列表初始化*是列表初始化的一个子*集*。因此，它遵循 8.5.4, p3 规定的所有规则。我不打算在这里引用它们，因为它们有几页长。我将按`complex g = {1, 2};`顺序简单地解释规则如何适用于 ：

1.  初始化器列表有元素，所以这条规则不算数。
2.  `complex`不是聚合，所以这条规则不算数。
3.  `complex`不是 的特化`initializer_list`，所以这条规则不算。
4.  根据 13.3 和 13.3.1.7 的规则，通过重载决议考虑适用的构造函数。这会找到需要两个双精度的构造函数。

因此，不会创建和复制/移入临时文件。

*复制列表初始化*和*直接列表*初始化之间的唯一区别在 13.3.1.7, p1 中说明：

> [...] 在复制列表初始化中，如果选择了显式构造函数，则初始化格式错误。

这是和之间的*唯一区别*。它们都是 的示例，除了使用显式构造函数外，它们以统一的方式工作。`complex g{1, 2}``complex g = {1, 2}``list-initialization`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-03T23:58:27.597

constructor-from-`T`不是*显*式的，并且复制列表初始化与复制初始化不同。两者都导致“考虑构造函数”，但复制初始化总是“考虑”复制构造函数，而列表初始化考虑填充列表元素的构造函数（加上一些细节）。以机智：

```
struct Foo
{
    Foo(int) {}
    Foo(Foo const &) = delete;
};

int main()
{
    Foo f = { 1 };  // Fine
} 
```

（如果构造函数是 ，这将失败`explicit`。此外，`Foo x = 1;`由于已删除的复制构造函数，这当然会失败。）

也许是一个更有启发性的用例：

```
Foo make() { return { 2 }; }

void take(Foo const &);
take(make()); 
```

为此所需的一切都在 8.5.4/3 和 13.3.1.7/1 中。

# python - SQLAlchemy 事件可以用于更新非规范化数据缓存吗？

> ID：13693872
> 
> 赞同：15
> 
> 时间：2012-12-03T23:49:24.577
> 
> 标签：python, sqlalchemy, denormalization

出于性能原因，我有一个非规范化数据库，其中一些表包含从其他表中的许多行聚合而来的数据。我想通过使用[SQLAlchemy events](http://docs.sqlalchemy.org/en/rel_0_8/orm/events.html)来维护这个非规范化的数据缓存。例如，假设我正在编写论坛软件，并希望每个软件`Thread`都有一个列来跟踪线程中所有评论的组合字数，以便有效地显示该信息：

```
class Thread(Base):
    id = Column(UUID, primary_key=True, default=uuid.uuid4)
    title = Column(UnicodeText(), nullable=False)
    word_count = Column(Integer, nullable=False, default=0)

class Comment(Base):
    id = Column(UUID, primary_key=True, default=uuid.uuid4)
    thread_id = Column(UUID, ForeignKey('thread.id', ondelete='CASCADE'), nullable=False)
    thread = relationship('Thread', backref='comments')
    message = Column(UnicodeText(), nullable=False)

    @property
    def word_count(self):
        return len(self.message.split()) 
```

所以每次插入评论时（为了简单起见，我们假设评论永远不会被编辑或删除），我们想要更新`word_count`关联`Thread`对象的属性。所以我想做类似的事情

```
def after_insert(mapper, connection, target):
    thread = target.thread
    thread.word_count = sum(c.word_count for c in thread.comments)
    print("updated cached word count to", thread.word_count)

event.listen(Comment, "after_insert", after_insert) 
```

因此，当我插入 a 时`Comment`，我可以看到事件触发并看到它已正确计算字数，但该更改并未保存到`Thread`数据库中的行中。[我在after_insert 文档](http://docs.sqlalchemy.org/en/rel_0_8/orm/events.html#sqlalchemy.orm.events.MapperEvents.after_insert)中没有看到有关更新其他表的任何警告，尽管我确实在其他一些表格中看到了一些警告，例如[after_delete](http://docs.sqlalchemy.org/en/rel_0_8/orm/events.html#sqlalchemy.orm.events.MapperEvents.after_delete)。

那么有没有支持的方式来使用 SQLAlchemy 事件呢？我已经将 SQLAlchemy 事件用于许多其他事情，所以我想以这种方式做所有事情，而不必编写数据库触发器。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-12-07T15:15:38.673

after_insert() 事件是执行此操作的一种方法，您可能会注意到它传递了一个 SQLAlchemy`Connection`对象，而不是`Session`其他刷新相关事件的情况。映射器级别的刷新事件通常用于在给定的情况下直接调用 SQL `Connection`：

```
@event.listens_for(Comment, "after_insert")
def after_insert(mapper, connection, target):
    thread_table = Thread.__table__
    thread = target.thread
    connection.execute(
            thread_table.update().
             where(thread_table.c.id==thread.id).
             values(word_count=sum(c.word_count for c in thread.comments))
    )
    print "updated cached word count to", thread.word_count 
```

这里值得注意的是，直接调用 UPDATE 语句也比在整个工作单元过程中再次运行该属性更改的性能要高得多。

然而，这里并不真正需要像 after_insert() 这样的事件，因为我们甚至在刷新发生之前就知道“word_count”的值。我们实际上知道它是因为 Comment 和 Thread 对象是相互关联的，我们也可以使用属性事件在内存中始终保持 Thread.word_count 完全新鲜：

```
def _word_count(msg):
    return len(msg.split())

@event.listens_for(Comment.message, "set")
def set(target, value, oldvalue, initiator):
    if target.thread is not None:
        target.thread.word_count += (_word_count(value) - _word_count(oldvalue))

@event.listens_for(Comment.thread, "set")
def set(target, value, oldvalue, initiator):
    # the new Thread, if any
    if value is not None:
        value.word_count += _word_count(target.message)

    # the old Thread, if any
    if oldvalue is not None:
        oldvalue.word_count -= _word_count(target.message) 
```

这种方法的最大优点是也不需要遍历 thread.comments，这对于未加载的集合意味着发出另一个 SELECT。

还有一种方法是在 before_flush() 中进行。下面是一个快速而肮脏的版本，可以对其进行细化以更仔细地分析发生了什么变化，以确定是否需要更新 word_count：

```
@event.listens_for(Session, "before_flush")
def before_flush(session, flush_context, instances):
    for obj in session.new | session.dirty:
        if isinstance(obj, Thread):
            obj.word_count = sum(c.word_count for c in obj.comments)
        elif isinstance(obj, Comment):
            obj.thread.word_count = sum(c.word_count for c in obj.comments) 
```

我会使用属性事件方法，因为它是性能最高且最新的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-08T02:20:29.997

您可以使用 SQLAlchemy-Utils`aggregated`列执行此操作：http: [//sqlalchemy-utils.readthedocs.org/en/latest/aggregates.html](http://sqlalchemy-utils.readthedocs.org/en/latest/aggregates.html)

# c# - 未使用异步套接字接收所有数据

> ID：13693873
> 
> 赞同：0
> 
> 时间：2012-12-03T23:49:24.867
> 
> 标签：c#, sockets, networking, asynchronous

所以，我有一个异步套接字设置，但是当我读取数据时并没有收到所有数据。有时会收到大部分数据，有时则不会。然后它挂在我程序的一部分上，因为它没有接收到要解析/处理的数据。

代码：

```
public static void OnArrival(IAsyncResult ar)
{
    connection = (Socket)ar.AsyncState;
    string data;
    try
    {
        int bytesRead = connection.EndReceive(ar);
        if (Sock.IsConnected(connection))
        {
            connection.BeginReceive(BufferData, 0, BufferData.Length, SocketFlags.None, new AsyncCallback(OnArrival), connection);
        }
        else
        {
            connection.Close();
        }
        if (bytesRead > 0)
        {
            data = System.Text.Encoding.ASCII.GetString(BufferData, 0, bytesRead);
            HandleData.ProcessData(connection, data);
        }
    }
    catch (Exception ex)
    {
        Logger.WriteError(ex.ToString());
        connection.Close();
    }
} 
```

当 HandleData.ProcessData 被调用时，并不是所有的数据都被接收到。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:04:45.460

您正在使用`BufferData`之前`BeginReceive`已完成。切换到同步 IO 或正确实现异步 IO（使用回调或任务）。

# java - FFmpeg 和 Android 编码问题

> ID：13693877
> 
> 赞同：0
> 
> 时间：2012-12-03T23:49:32.490
> 
> 标签：java, android, encoding, ffmpeg

我为 Android 编译了 ffmpeg。可执行文件从设备终端运行，我可以进行正常的视频操作。我正在尝试在设备的命令行中加入使用相机捕获的 2 个 mpeg 文件。

首先，我使用相机拍摄 2 个视频并保存到 sdcard、one.mpeg 和 two.mpeg。然后我做：

```
 ffmpeg -i one.mpeg onenew.mpeg
 ffmpeg -i twompg.mpeg twonew.mpeg 
```

（如果我不执行上述 2 个命令，那么它根本不起作用）

```
 cat onenew.mpeg twonew.mpeg > joined.mpeg
 ffmpeg -i joined.mpeg -acodec copy -vcodec copy final.mpeg 
```

输出（final.mpeg）不会在设备上播放，但如果我复制到我的 linux 桌面，它会打开并正常播放。我在 2.3.3 设备和 2.3.6 设备上测试了 final.mpeg。

有人知道为什么设备无法播放视频文件吗？

**更新** 我的朋友在运行 3.0 的设备上测试了视频，默认播放器从未播放过视频，但是“moboplayer”确实播放了，但我需要它在默认播放器上播放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:58:14.300

[http://ffmpeg.mplayerhq.hu/faq.html#How-can-I-concatenate-video-files_003f](http://ffmpeg.mplayerhq.hu/faq.html#How-can-I-concatenate-video-files_003f)

阅读上述链接中的第 3.14.2 节。在 linux 上的 ffmpeg 环境中连接媒体文件已经做了大量工作，在你的 android 设备上应该没有什么不同。

在手机终端上运行 ffmpeg 应该就像在 linux 中运行一样（就像在 faq 中做 cat 的示例一样）

在 linux 上测试它，然后相同的表达式应该在你的 android 设备上运行。

您只需要获取适合连接的文件类型，然后使用 F 系统对文件进行分类。

# android - 隐藏 Android 虚拟键盘

> ID：13693880
> 
> 赞同：1
> 
> 时间：2012-12-03T23:49:49.950
> 
> 标签：android, virtual-keyboard, android-virtual-keyboard

我有一个显示 EditText 和两个底部的活动。

当我点击 EditText 时，会出现 Android 虚拟键盘，以便我可以输入文本。现在，在点击任何底部之前，我想隐藏键盘。我想通过点击屏幕来做到这一点。

我在stackoverflow中看到过一些类似问题的帖子，但这看起来不像工作。我试图设置一个监听器：

```
 // Create an anonymous implementation of OnFocusChangeListener
   private OnFocusChangeListener mFocusListener = new OnFocusChangeListener() {
       public void onFocusChange(View v, boolean b) {
          // do something when the focus changes
        hideSoftKeyboard(v);
        }
    };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //setupUI(findViewById(R.id.parent));
        EditText editText = (EditText) findViewById (R.id.edit_message);
        editText.setOnFocusChangeListener(mFocusListener);
        setContentView(R.layout.activity_main);
    } 
```

我还尝试创建一个父活动，该活动递归地将 onTouch 事件关联到不是文本视图的每个视图，但它确实只注册了文本视图（我从另一个 stackoverflow 帖子中获取了这段代码）

```
 public void setupUI(View view) {

    //Set up touch listener for non-text box views to hide keyboard.
    if(!(view instanceof EditText)) {

        view.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                hideSoftKeyboard(v);
                return false;
            }

        });
    }

    //If a layout container, iterate over children and seed recursion.
    if (view instanceof ViewGroup) {

        for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {

            View innerView = ((ViewGroup) view).getChildAt(i);

            setupUI(innerView);
        }
    }
} 
```

有什么直截了当的解决方案吗？我不敢相信没有更简单的方法可以做到这一点。我正在使用 Gingerbread API（API 级别 10）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T00:14:15.220

好的，我找到了一种非常简单的方法：XML 布局定义。由于 Layout 是一个 ViewGroup，我们可以在其上实现事件。去定义处理点击布局的方法（hideSoftKeyboard）

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" 
    android:id="@+id/main_layout" 
    android:onClick="hideSoftKeyboard" > 
```

这是我实现该方法的方式：

```
public void hideSoftKeyboard(View view) {
    InputMethodManager inputMethodManager = (InputMethodManager)  getSystemService(Activity.INPUT_METHOD_SERVICE);
    inputMethodManager.hideSoftInputFromWindow(getCurrentFocus().getWindowToken(), 0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T08:30:18.107

我出于相同目的使用了以下方法

```
private void hideKeypad(){
    EditText edtView=(EditText)findViewById(R.id.username);

    InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
    imm.hideSoftInputFromWindow(edtView.getWindowToken(), 0);
} 
```

# testing - Pex – 测试输入生成器

> ID：13693882
> 
> 赞同：1
> 
> 时间：2012-12-03T23:49:51.300
> 
> 标签：testing, pex

我已经在 c# 中创建了示例方法。我在 Visual Studio 2010 中使用 Pex 插件。我必须通过少量测试来测试我的示例方法。我应该自动而不是手动执行此操作。我阅读了很多关于 PUT（参数化单元测试）的文章) 与 Pex。我不明白 Pex 如何自动创建测试输入。我不太擅长编程，所以我自己不这样做。谁能给我推荐一些适合初学者的好教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:07:17.723

官方网站不仅提供文档，还提供综合教程。

您还可以试用[Pex4Fun](http://pex4fun.com/)，它是一个基于 Web 的 Pex 前端。

# c# - 为什么我的树视图没有接收到我的 xsl 更改？

> ID：13693886
> 
> 赞同：0
> 
> 时间：2012-12-03T23:49:59.083
> 
> 标签：c#, asp.net, treeview

我正在使用asp.net 2.0 中包含的treeview 控件。

我想使用我创建的 xsl 文件 (test3.xslt)。

为什么 Treeview 没有拾取使用 xsl（我认为是 tw）对树所做的更改并显示它们？

tw 具有 xslt 转换所做的更改...

我的树视图的 DataSourceID 是我的 xmldatasource (xmldatasource1)。

谢谢，

蓝色的

```
 argsList.AddParam("Groups_From_Logged_In_User","",myLocalGroups);

        XslCompiledTransform xslTransform = new XslCompiledTransform();

        xslTransform.Load("C:\\ANewBeginning3\\test3.xslt");
        StringWriter tw = new StringWriter();

        using (StreamWriter sw = new StreamWriter("C:\\ANewBeginning3\\output.xml"))
        {
            xslTransform.Transform(xmldoc.CreateNavigator(), argsList, tw);

            XmlDataSource1.Data = tw.ToString();
        }
        XmlDataSource1.DataBind();           

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:22:24.513

我想到了...

首先，如果指定了 xmldatasource.DataFile，则 xmldatasource 会阻止任何其他 xml。我在上面使用 xmldatasource.data 并指定了 DataFile。（参见[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xmldatasource.data.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xmldatasource.data.aspx)）

其次，也不要在 xmldatasource 中指定 xslt 文件。我试图同时转换它（使用 xslTransform）并在 xmlDatasource.TransFormFile （http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xmldatasource.transformfile.aspx）中指定相同的样式表）。不要两者都做（除非你知道你为什么这样做。）

# python - 在 Django 模板中使用前导下划线访问 dict 元素

> ID：13693888
> 
> 赞同：10
> 
> 时间：2012-12-03T23:50:02.370
> 
> 标签：python, django, elasticsearch

我正在尝试使用以下划线字符开头的键访问 dict 的元素。例如：

`my_dict = {"_source": 'xyz'}`

我正在尝试在 Django 模板中访问它们。显然，我意识到您无法从 Django 模板访问带下划线的 Python 变量（因为它们在 Python 中被认为是私有的），但这是一个 dict 对象，其中任何不可变对象都是有效键。

我无法使用 {{ my_dict._source }} 在 Django 模板中访问上述字典，所以我认为 Django 正在阻止它。那准确吗？

我有点希望 Django 对以下划线开头的变量做一些理智的事情，比如仍在进行 dict 查找（第一件事应该是尝试），但拒绝进行属性查找、方法调用和列表索引查找，因为带下划线的前缀变量将是无效的。不过，我很快就失去了希望。

作为记录，我知道有人会建议只更改字典，但这实际上是在 ElasticSearch 实例上执行 REST API 请求时由 rawes 库返回的多级字典。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-04T00:08:45.367

[文档提到](https://docs.djangoproject.com/en/dev/ref/templates/api/#variables-and-lookups)你不能有一个以下划线开头的变量：

> 变量名称必须由任意字母 (AZ)、任意数字 (0-9)、下划线（但不得以下划线开头）或点组成。

但您可以轻松编写[自定义模板过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)来模仿字典的[`get`](http://docs.python.org/2/library/stdtypes.html#dict.get)方法：

```
@register.filter(name='get')
def get(d, k):
    return d.get(k, None) 
```

和

```
{{ my_dict|get:"_my_key" }} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-10T22:36:31.173

就我而言，如果我知道 dict 元素，而且它只有一个，我更喜欢使用以下命令重命名 dict 键`pop`：

```
my_dict['new_key'] = my_dict.pop('_old_key') 
```

这样我就可以在字典上获得一个新名称，并且可以毫无问题地在模板中访问。

# c# - GridView 事件无法正常工作

> ID：13693890
> 
> 赞同：1
> 
> 时间：2012-12-03T23:50:28.860
> 
> 标签：c#, asp.net, .net, gridview, event-handling

我一直在努力寻找一个非常令人沮丧的问题。起初是没有触发的 RowDataBound 事件，现在重写了整个 gridview 之后，它是排序事件。这次它抱怨没有为事件注册处理程序。这是个谎言！！！！！！！！我已经尝试了很多事情，在这一点上我很绝望，我真的不知道发生了什么。任何帮助将不胜感激。

```
 protected void ContactsSGV_Sorting2(object sender, GridViewSortEventArgs e)
    {
        var PLEASE_WORK = true;
    }
<CC:SortableGridView runat="server" ID="ContactsSGV" Width="100%" DataKeyNames="ContactID,ContactType"
AllowPaging="True" AllowSorting="True" AutoGenerateColumns="false" OnRowDataBound="ContactsSGV_RowDataBound"
OnPageIndexChanging="ContactsSGV_PageIndexChanging" OnSorting="ContactsSGV_Sorting2">
<Columns>
<CC:SortableBoundField HeaderText="First Name" DataField="FirstName" SortExpression="FirstName"
DefaultImageUrl="~/Images/sortable.png" AscImageUrl="~/Images/arrow-up.png" DescImageUrl="~/Images/arrow-dn.png"
meta:resourcekey="BoundFieldFirstNameResource1" ItemStyle-Width="15%" />
<CC:SortableBoundField DataField="MiddleName" HeaderText="Middle Name" SortExpression="MiddleName"
DefaultImageUrl="~/Images/sortable.png" AscImageUrl="~/Images/arrow-up.png" DescImageUrl="~/Images/arrow-dn.png"
meta:resourcekey="BoundFieldMiddleNameResource1" ItemStyle-Width="15%" />
<CC:SortableBoundField DataField="LastName" HeaderText="Last Name" SortExpression="LastName"
DefaultImageUrl="~/Images/sortable.png" AscImageUrl="~/Images/arrow-up.png" DescImageUrl="~/Images/arrow-dn.png"
meta:resourcekey="BoundFieldLastNameResource1" ItemStyle-Width="15%" />
<CC:SortableBoundField DataField="Company" HeaderText="Company" SortExpression="LastName"
DefaultImageUrl="~/Images/sortable.png" AscImageUrl="~/Images/arrow-up.png" DescImageUrl="~/Images/arrow-dn.png"
meta:resourcekey="BoundFieldCompanyResource1" ItemStyle-Width="15%" />
<CC:SortableBoundField DataField="Email" HeaderText="Email" SortExpression="Email"
meta:resourcekey="BoundFieldEmailResource1" DefaultImageUrl="~/Images/sortable.png"
AscImageUrl="~/Images/arrow-up.png" DescImageUrl="~/Images/arrow-dn.png" ItemStyle-Width="16%" />
<CC:SortableBoundField DataField="Phone" HeaderText="Work Phone" SortExpression="Phone"
DefaultImageUrl="~/Images/sortable.png" AscImageUrl="~/Images/arrow-up.png" DescImageUrl="~/Images/arrow-dn.png"
meta:resourcekey="BoundFieldPhoneResource1" ItemStyle-Width="14%" />
<asp:TemplateField>
<ItemTemplate>
<asp:ImageButton ID="ViewButton" runat="server" Width="25px" Height="30px" ToolTip="View"
CommandName="Select" CommandArgument='<%# Eval("ContactID") %>' ImageUrl="~/Images/View_24.png"
meta:resourcekey="GVBtnViewResource1" />
</ItemTemplate>
<ItemStyle HorizontalAlign="Center" Width="5%" />
</asp:TemplateField>
<asp:TemplateField>
<ItemTemplate>
<asp:ImageButton ID="EditButton" runat="server" Width="25px" Height="30px" ToolTip="Edit"
CommandName="Edit" ImageUrl="~/Images/Edit_32x32.png" meta:resourcekey="GVBtnEditResource1" />
</ItemTemplate>
<ItemStyle HorizontalAlign="Center" Width="5%" />
</asp:TemplateField>
</Columns>
</CC:SortableGridView>
 System.Web.HttpException was unhandled by user code
 Message=The GridView 'ContactsSGV' fired event Sorting which wasn't handled.
 Source=System.Web
 ErrorCode=-2147467259
 WebEventCode=0
 StackTrace:
 at System.Web.UI.WebControls.GridView.OnSorting(GridViewSortEventArgs e)
 at CustomControls.SortableGridView.OnSorting(GridViewSortEventArgs e) in E:\Local\ProTrackPlus_GroupBy2+\CustomControls\SortableGridView.cs:line 314
 at System.Web.UI.WebControls.GridView.HandleSort(String sortExpression, SortDirection sortDirection)
 at System.Web.UI.WebControls.GridView.HandleSort(String sortExpression)
 at System.Web.UI.WebControls.GridView.HandleEvent(EventArgs e, Boolean causesValidation, String validationGroup)
 at System.Web.UI.WebControls.GridView.OnBubbleEvent(Object source, EventArgs e)
 at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)
 at System.Web.UI.WebControls.GridViewRow.OnBubbleEvent(Object source, EventArgs e)
 at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)
 at System.Web.UI.WebControls.LinkButton.OnCommand(CommandEventArgs e)
 at System.Web.UI.WebControls.LinkButton.RaisePostBackEvent(String eventArgument)
 at System.Web.UI.WebControls.LinkButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)
 at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)
 at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
 at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
 InnerException:   

 protected void ContactsSGV_RowDataBound(object sender, GridViewRowEventArgs e)
 {
        //THIS ONE WORKS
        var isItWorking = "YES IT IS OMG ";
 }
 protected void ContactsSGV_Sorting2(object sender, GridViewSortEventArgs e)
 {
 //THIS IS HELL!
 var PLEASE_WORK = true;
 }
 public class SortableGridView : GridView{
 //STUFF
 }

 protected override void OnSorting(GridViewSortEventArgs e)
 {
 //This is inside my SortableGridView Class.
 //As you can see I am calling the base method and this in fact DOES WORK
 //Is my Handler on a page using this control that does not handle the raised event.
 setSortData(e.SortExpression);
 base.OnSorting(e);
    } 
```

[工作事件](http://www.fotoshack.us/foto.php?id=24534WorkingEvent.JPG) [不工作](http://www.fotoshack.us/foto.php?id=87632NotWorkingEvent.jpg)

为了避免进一步关注第三方控件，我将 gridview 改回了常规的 asp。这就是现在的结构。......注意：没有足够的声誉添加链接:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T12:28:25.330

您在页面中使用的 SortableGridView 是第三方控件，它不属于 asp 控件集。它与 asp gridview 控件不同。可能会或可能不会发生 onrowdatabound 事件。这取决于控件创建者。您可以通过右键单击“SortableGridView”类并单击“转到定义”，查看 SortableGridView 类中使用的类和方法列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T15:49:37.420

解决了！！！！所以事实证明，这是一条让整个事情崩溃的单行代码。在数据绑定包装函数中有一个 ContactsSGV.Dispose() 调用，它有效地解除了处理程序的绑定。我以前没有注意它，因为我不知道它到底做了什么。我之前在我正在从事的项目的其他页面上看到过它，它没有造成任何麻烦。无论如何，删除这条线使得一切都可以使用常规的 gridview 和我自己的组件。

[http://forums.asp.net/t/1336965.aspx/1](http://forums.asp.net/t/1336965.aspx/1)

问候
0x

# objective-c - 如何显示我的核心数据值？

> ID：13693895
> 
> 赞同：0
> 
> 时间：2012-12-03T23:51:02.593
> 
> 标签：objective-c, uitableview, core-data, uiviewcontroller, nsstring

我有一个基础`UITableView`，我可以使用 Core Data 添加项目以及在需要时删除。

假设我向`UITableView`. 我还想在另一个视图上显示这五个项目，最好是 PDF。

实现这一目标的最佳方法是什么？

我也在尝试使用`NSUserDefaults`，但唯一出现的值是输入的最后一个值。

这是使用的一些主要代码。任何建议表示赞赏！

这是`UIViewController`我输入文本的地方：

```
-(NSManagedObjectContext * )managedObjectContext
{
    return [(AppDelegate *) [[UIApplication sharedApplication] delegate] managedObjectContext];
}

-(void)saveButtonTapped:(id)sender
{

    [self.managedObjectContext save:nil];

    if (_majorTextField.text == nil)
    {
        _majorString = @"";
    }
    else
    {
        _majorString = [[NSString alloc] initWithFormat:@"%@", _majorTextField.text];
        self.task.title = self.majorTextField.text;
        NSUserDefaults * majorDefault = [NSUserDefaults standardUserDefaults];
        [majorDefault setObject:_majorString forKey:@"major"];
    }
    [self.navigationController popViewControllerAnimated:YES];
 } 
```

这是我在我的 PDF 中添加文本的地方：

```
 +(void)createPDF:(NSString*)filePath
 {
    // Create the PDF context using the default page size of 612 x 792.
    UIGraphicsBeginPDFContextToFile(filePath, CGRectZero, nil);
    // Mark the beginning of a new page.
    UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0, 612, 792), nil);

    NSUserDefaults * majorDefault = [NSUserDefaults standardUserDefaults];
    NSString * majorString = [majorDefault stringForKey:@"major"];

    [PDFRenderer drawText:majorString inFrame:CGRectMake(35, 190, 300, 50) fontName:@"TimesNewRomanPSMT" fontSize:14];

    UIGraphicsEndPDFContext();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T02:04:06.800

`NSManagedObjectContext`在您对视图控制器中的表示对象进行更改之前，您正在保存您的。在`saveButtonTapped:`你保存上下文但只是稍后设置`self.task.title ...` 也许我错过了一些东西；但我认为您想在更改后保存上下文`self.task.title`。

在需要访问相关托管对象的其他视图中，您需要通过构造 an`NSFetchRequest`并针对`NSManagedObjectContext`. 在不了解您的模型的情况下，我无法举出任何实质性的例子；但这是基本的想法。

根据您的需要，Core Data 可能是理想的，也可能是矫枉过正。将 Core Data 用于您的对象图持久性技术有很多好处——但也有很多微妙之处。正如苹果所说。“Core Data 不是入门级技术。” （Apple，*“核心数据入门”*）

我们可能都对此感到内疚，但是您应该传入一个错误对象`[self.managedObjectContext save:nil];`并处理返回值，因此：

```
NSError *saveError = nil;
if( ![[self managedObjectContext] save:&saveError] ) {
    // do something with saveError
} 
```

编辑：

Core Data 适合您在评论中描述的内容。这只是理解持久存储、托管对象上下文等的基本原理的问题。您使用 Core Data 获得的是一组在表视图中显示数据的便利，即`NSFetchedResultsController`.

# c# - 使用 c# + xaml 对图像进行像素化

> ID：13693896
> 
> 赞同：1
> 
> 时间：2012-12-03T23:51:04.120
> 
> 标签：c#, image-processing, windows-8

我打算在**Windows 8的应用程序****c# + xaml**中**像素化**图像（Windows 商店应用程序）最好的方法是什么？

 ****我在 C# ( [http://notes.ericwillis.com/2009/11/pixelate-an-image-with-csharp/](http://notes.ericwillis.com/2009/11/pixelate-an-image-with-csharp/) ) 中找到了这段代码，但命名空间 System.Drawing 和 Bitmap 不再存在。

欣赏任何想法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T05:01:19.233

您只需将其缩放两次，一次通过插值缩小，第二次在没有任何插值的情况下进行备份。

只需通过分割段大小的宽度和高度来计算“像素”（段）大小。这将是您缩小到的新临时尺寸。

通过使用插值，您将在缩小/调整大小时获得颜色值的近似平均值。放大时关闭插值将为每个像素创建纯色块，即像素化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T14:01:42.160

在 xaml 中使用像素着色器。本教程（虽然适用于 silverlight）有一个像素化示例：

[http://msdn.microsoft.com/en-us/silverlight4trainingcourse_webcam_topic3.aspx](http://msdn.microsoft.com/en-us/silverlight4trainingcourse_webcam_topic3.aspx)****

# regex - Capybara使用正则表达式从下拉列表中选择？

> ID：13693902
> 
> 赞同：4
> 
> 时间：2012-12-03T23:51:53.883
> 
> 标签：regex, select, drop-down-menu, capybara

我正在尝试使用 Capybara 抓取一个网页，它工作正常，除了我在某个页面上遇到问题。它有一个使用以下 HTML 定义的下拉列表：

```
<select onChange="this.form.submit();" id="AcctNumber" name="AcctNum">
<option value="MU:P2" selected="true">Investment &nbsp;-&nbsp;2845</option>
<option value="MU:P0">Patrick UGMA&nbsp;-&nbsp;1585</option>
<option value="MU:P1">Lisa UGMA&nbsp;-&nbsp;1655</option> 
```

我试图选择一个在这个主题上有很多变化的值

```
selector = 'Investment - 2845'
selector = 'Investment &nbsp;-&nbsp; 2845'
selector = 'Investment    &nbsp;-&nbsp;   2845'
select selector, :from => "AcctNumber" 
```

所有这些（以及更多）都会产生`ElementNotFound`错误。

有没有办法只使用正则表达式，比如`/Invest/`or`/Pat/`或`/Lisa/`选择项目？这肯定比试图猜测什么文字字符串会匹配那些连字符周围的神秘空白更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:20:30.777

您的问题可能*是*连字符周围没有空格。在`&nbsp;`浏览器中呈现时，它是一个不间断的空格字符 - 但当被屏幕抓取器读取时，它是 6 个字符。“ `&nbsp;`”。

这意味着当您尝试将其与屏幕抓取器匹配时，您可能应该尝试匹配 HTML，而不是呈现的版本。

我从您的剪切粘贴中注意到的第二件事是它们周围有制表符。RegEx 中的制表符和空格都使用`\s`选择器进行匹配。

试试这个 RegEx 作为开始：

```
(Investment|Patrick|Lisa)[\s]*(&nbsp;)[-](&nbsp;)[\s]*[0-9](,4) 
```

首先匹配单词“Investment”或“Patrick”或“Lisa”——然后是任意数量的空格（空格、制表符等）——然后是文字“”，破折号，再次是文字“”，任意数量再次空格，然后是 4 位数字 0-9。

**注意：** *我没有测试过这个 RegEx。*但是，它应该为您提供一个良好的构建起点。如果您需要更多帮助来调整它，我建议您[使用 Regular-Expressions.info 。](http://www.regular-expressions.info/)

# python - 如何在多个进程之间共享缓存？

> ID：13693906
> 
> 赞同：20
> 
> 时间：2012-12-03T23:52:30.723
> 
> 标签：python, multiprocessing

我正在使用[LRU 缓存](http://code.activestate.com/recipes/498245/)来加速一些相当繁重的处理。它运行良好并且大大加快了速度。然而...

当我多进程时，每个进程都会创建自己的单独缓存，并且同一事物有 8 个副本。这似乎不是问题，直到盒子内存不足并因此发生坏事......

理想情况下，我的应用程序只需要大约 300 个项目的缓存大小，1*300 将适合我必须使用的 7GB，但 8*300 不适合。

如何让所有进程共享同一个缓存？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-04T00:33:55.757

我相信您可以使用 a`Manager`在进程之间共享字典。从理论上讲，这应该让您对所有功能使用相同的缓存。

但是，我认为更明智的逻辑是让*一个*进程通过在缓存中查找查询来响应查询，如果它们不存在，则将工作委托给子进程，并在返回结果之前缓存结果。你可以很容易地做到这一点

```
with concurrent.futures.ProcessPoolExecutor() as e:
    @functools.lru_cache
    def work(*args, **kwargs):
        return e.submit(slow_work, *args, **kwargs) 
```

请注意，这`work`将返回`Future`消费者必须等待的对象。将`lru_cache`缓存未来的对象，以便它们自动返回；我相信您可以多次访问他们的数据，但现在无法对其进行测试。

如果您不使用 Python 3，则必须安装`concurrent.futures`和`functools.lru_cache`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:54:53.380

将共享缓存传递给每个进程。父进程可以实例化一个缓存并将其作为参数引用到每个进程...

```
@utils.lru_cache(maxsize=300)
def get_stuff(key):
    """This is the routine that does the stuff which can be cached.
    """
    return Stuff(key)

def process(stuff_obj):
    """This is the routine which multiple processes call to do work with that Stuff
    """
    # get_stuff(key) <-- Wrong; I was calling the cache from here
    stuff_obj.execute()

def iterate_stuff(keys):
    """This generates work for the processses.
    """
    for key in keys:
        yield get_stuff(key)  # <-- I can call the cache from the parent

def main():
    ...
    keys = get_list_of_keys()
    for result in pool.imap(process, iterate_stuff(keys)):
         evaluate(result)
    ... 
```

这个例子很简单，因为我可以在调用进程之前查找缓存。某些场景可能更喜欢将指针传递给缓存而不是值。例如：

```
 yield (key, get_stuff) 
```

卡特里尔让我走上了正确的道路，我会实施这个答案，但是，愚蠢的我，我的错误比他建议的更容易解决。

# servicestack - ServiceStack.Razor CustomHttpHandler 未显示 HttpStatusCode.BadRequest

> ID：13693908
> 
> 赞同：3
> 
> 时间：2012-12-03T23:52:49.420
> 
> 标签：servicestack

我正在尝试使用 ServiceStack.Razor 让一个最小的应用程序工作，但我无法让 CustomHttpHandler 工作。我已按照[此处](https://github.com/ServiceStack/ServiceStack/wiki/Create-your-first-webservice)和[此处](http://razor.servicestack.net/)的说明进行操作，但无法正常工作。

我正在使用以下代码为以下代码注册一个自定义 http 处理程序`HttpStatusCode.BadRequest`：

```
public override void Configure(Container container)
{
    this.Plugins.Add(new RazorFormat());
    this.SetConfig(new EndpointHostConfig
    {
        CustomHttpHandlers =
        {
            { HttpStatusCode.NotFound, new RazorHandler("/notfound") }, 
            { HttpStatusCode.BadRequest, new RazorHandler("/error") }
        }, 
        DebugMode = true
     });
} 
```

问题是，`/notfound`处理程序完美地适用于 404，但无论我做什么，我都无法在抛出`/error`an 时显示剃刀文件。`ArgumentNullException`

我的服务方法如下所示：

```
public object Any(Hello request)
{
    if (string.IsNullOrEmpty(request.Name))
    {
        throw new ArgumentNullException("Name");
    }

    return new HelloResponse { Result = "Hello " + request.Name };
} 
```

ServiceStack 返回 400 状态，这很好，但它仍然显示我拥有的视图`HelloResponse`：

![400 错误请求](../Images/1cfb110524dd7f5c457d1137d8029854.png)

我错过了什么？我是否误解了 CustomHttpHandlers 应该如何工作？

作为参考，我把项目[放在了 github 上](https://github.com/rossipedia/ServiceStackTest)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:46:12.290

是的，CustomHttpHandlers 只是用于处理未处理的系统生成的错误。目前，它们仅限于：

*   **NotFound (404)**用于未处理的请求
*   **对禁止的文件或资源发出请求时**禁止 (403)****

 **这些是发生在 ServiceStack 之外的错误，因此无法由[现有 ServiceStack 的事件挂钩或用户定义的自定义逻辑](https://github.com/ServiceStack/ServiceStack/wiki/Order-of-Operations)处理，因此我们允许用户在这种情况下通过`CustomHttpHandlers`.

[错误处理 wiki](https://github.com/ServiceStack/ServiceStack/wiki/Error-Handling)描述了如何处理 ServiceStack 中的错误。

尽管在处理异常后允许回退以允许通过将其呈现到用户指定的页面来进一步处理它可能是有意义的（因为它是选择加入的），但您希望在此处执行此操作。

我们将着眼于在未来尝试探索类似的东西。随意将这些未来的功能请求添加到[ServiceStack 的问题列表中](http://github.com/ServiceStack/ServiceStack/issues)，这样我们就不会忘记。**

# ruby-on-rails - 用于 application.rhtml.erb 的 Rails 控制器？

> ID：13693912
> 
> 赞同：1
> 
> 时间：2012-12-03T23:53:25.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在做一个带有会话管理的应用程序，我想在每个页面的顶部显示用户是否登录。我在 application.rhtml.erb 中有这个前端，是否有任何控制器/方法可以让我设置站点范围的变量？因为我为每个单独的页面定义了条件，所以必须有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:01:28.970

将您的方法放入`application_helper.rb`文件中。这将在整个站点范围内可用。

# android - listenUsingRfcommWithServiceRecord（字符串名称，UUID uuid）不起作用

> ID：13693916
> 
> 赞同：1
> 
> 时间：2012-12-03T23:53:57.457
> 
> 标签：android, sockets, bluetooth

所以我试图让这段代码运行

```
public AcceptThread() {
    // Use a temporary object that is later assigned to mmServerSocket,
    // because mmServerSocket is final
    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
    BluetoothServerSocket tmp = null;
    try {
        // MY_UUID is the app's UUID string, also used by the client code
        tmp = mBluetoothAdapter.listenUsingRfcommWithServiceRecord("Server", MY_UUID);
    } catch (IOException e) { }
    mmServerSocket = tmp;
} 
```

但是当我从应该分配 tmp 的行继续时，它仍然为空。蓝牙已激活，一切都已激活，但当我使用它时，它根本不会将 tmp 设置为任何东西。有什么想法为什么不呢？顺便说一句。这种方法在 2.2 的 android 机器上不起作用，因为它在我的 2.2 机器上的那条线上崩溃，但在我的 4.1.2 设备上却没有。

如果需要更多信息才能回答，请提出要求，并尽我所能提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-14T21:46:40.570

I am completely new to Android development and ran into the same problem. Here is more help if other people run into this:

Because this is happening on the server side, be sure discoverability is enabled before starting the accept-connection thread. This can by starting the thread in the onActivityResult() method when the proper resultCode is received.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T13:12:38.063

发现我没有授予应用程序使用蓝牙的权限，所以解决了。

# applescript - 图像事件：相同的脚本在一台 Mac 上另存为 RGB JPEG，在另一台 Mac 上另存为 CMYK JPEG

> ID：13693918
> 
> 赞同：0
> 
> 时间：2012-12-03T23:54:18.257
> 
> 标签：applescript, image-events

这是有问题的代码：

```
repeat with this_indd_jpeg in indd_jpeg_list
  set original_name to name of this_indd_jpeg
  set the_small_path to export_path & original_name as string
  set the_large_path to (Large_Folder as string) & original_name as string
  tell application "Image Events"
    launch
    set this_image to open (this_indd_jpeg as alias)
    scale this_image to size target_length_large
    save this_image as JPEG in file the_large_path with icon
    scale this_image to size target_length_small
    save this_image as JPEG in file the_small_path with icon
    close this_image
  end tell              
end repeat 
```

问题在于，在一台 Mac（10.7.5）上，它将 JPEG 保存为 RGB（所需的行为），而在另一台（10.6.8）上，它将它们保存为 CMYK，这绝对是不受欢迎的。

是否有人知道 10.6 和 10.7 中的图像事件版本之间的任何变通方法或差异？我不确定：这只是在黑暗中刺伤。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T10:01:32.930

我不知道 10.7.5 和 10.6.8 之间图像事件的区别。但是你可以尝试用 sips 改变颜色空间：

```
set theImage to quoted form of POSIX path of (the_large_path)
do shell script "/usr/bin/sips -m '/System/Library/ColorSync/Profiles/Generic RGB Profile.icc' " & " " & theImage 
```

# oracle-coherence - 跨线程使用 Oracle Coherence CacheFactory.getCache()

> ID：13693922
> 
> 赞同：3
> 
> 时间：2012-12-03T23:55:16.980
> 
> 标签：oracle-coherence

我们有一个多线程应用程序，它大量使用 Oracle Coherence 3.5 L1/L2 缓存（1k 请求/秒），其中性能至关重要......

1.  我需要同步访问`CacheFactory.getCache()`吗？

2.  我应该将`NamedCache`结果重用于后续请求吗？

目前它正在执行以下操作以最小化对 CacheFactory 的调用并同步对它的访问...

```
static ConcurrentHashMap<String, NamedCache> cacheMap = new ConcurrentHashMap<String, NamedCache>();
protected static NamedCache getCache(String cacheName)
{
    NamedCache cache = cacheMap.get(cacheName);
    if (cache == null)
    {
        cache = CacheFactory.getCache(cacheName);
        cacheMap.put(cacheName, cache);
    }

    return cache;
} 
```

更新：经过一番探索之后，这似乎没有必要，因为 Coherence API 应该是线程安全的......似乎我可以简化为这个，对吗？

```
protected static NamedCache getCache(String cacheName)
{
    return CacheFactory.getCache(cacheName);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T05:20:24.647

经过一些性能测试......似乎重用 NamedCache 确实证明稍微快一些，所以这就是我最终的结果......删除同步，改用 putIfAbsent()

```
protected static NamedCache getCache(String cacheName)
{
    NamedCache cache = cacheMap.get(cacheName);
    if (cache == null)
    {
        cache = CacheFactory.getCache(cacheName);
        NamedCache existing = cacheMap.putIfAbsent(cacheName, cache);
        if (existing != null)
            return existing;
    }

    return cache;
} 
```

# java - 如何从类中获取对象？

> ID：13693923
> 
> 赞同：-1
> 
> 时间：2012-12-03T23:55:16.370
> 
> 标签：java, object, reflection

我有一个类 Person 有 2 个字段：名称和年龄，我想像这样在类中声明这个类的实例。

```
public class Person implements ToCSV {

private String name;
private int age;

public Person(String name, int age) {
    this.name = name;
    this.age = age;
}

public Person(){

}
public String getName() {
    return name;
}
public void setName(String name) {
    this.name = name;
}

public int getAge() {
    return age;
}
public void setAge(int age) {
    this.age = age;
}

Person p1 = new Person("Patrick", 24);
Person p2 = new Person("Bernard", 20);
Person p3 = new Person("Lam", 23); 
```

}

我的问题是：我可以按一般方式取对象 p1、p2、p3 的所有值吗？

我的目标是将所有对象的数据保存到 txt 之类的文件中……该文件将具有以下内容：“Patrick - 24, Bernard - 20, Lam - 23”，我想要一些通用的东西来自动生成文件 txt。所以我必须尝试检索类的对象

我尝试使用 Java 反射。它像字段一样识别 p1、p2、p3，但我无法访问该对象的值。任何想法？感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:14:18.053

有趣的是，您发布的代码将产生一个`StackOverflowError`- 对第一个构造函数的每个构造函数调用都将尝试再产生*3 个* `Person`实例。你的意思是做`Person`田地`static`吗？

如果你这样做了，你可以这样做：

```
for (Field f : Person.class.getDeclaredFields()) {
    try {   
        System.out.println(((Person)f.get(null)).getName());
    } catch (IllegalAccessException e) {
        // do something
    }
} 
```

```
帕特里克
伯纳德
我是

```

如果可能的话，我通常会试图说服人们去寻找除反射之外的方法。在您的情况下，您可能能够将`p1`..存储`p3`在一个数组中，然后遍历该数组。

# objective-c - application:handleOpenUrl: 将错误的扩展名附加到文件

> ID：13693924
> 
> 赞同：0
> 
> 时间：2012-12-03T23:55:22.393
> 
> 标签：objective-c, ios

当我尝试从 Mail 中将文件导出到我的应用程序时，它正在发送文件以使用错误的扩展名导出。

这是一个例子：

1.  我通过电子邮件将附件发送给自己
2.  在邮件中打开附件
3.  导出文件并使用我的应用程序打开
4.  传递给 application:handleOpenUrl: 的 url 错误

我尝试导出的文件名为“NSIS.nsi”（不带引号）。邮件（iOS？）通过应用程序将文件传递回我的应用程序时将文件重命名为“NSIS.4th”：handleOpenUrl。我注意到的一件事是 Exported Type UTIs > Item 0 > Conforms to UTIs > Equivalent Types > public.filename-extension 中的第一个扩展名（项目）是“4th”（同样，没有引号）。

另一件需要注意的是，我在同一个 public.filename-extension 数组中*确实有“nsi”扩展名。*

还有一点*需要*注意的是，这似乎只发生在“nsi”扩展名中。我还没有测试我的应用程序支持的所有扩展（有 92 个。大约第 40 个后我就累了）。但是这个扩展特别有问题。

顺便说一下，这里是代码示例……真的就是这么简单。传递的 NSURL 包含错误的扩展名。这将记录传递的 url - 这是错误的。因此，我可以肯定地说，在将 NSURL 传递给 application:handleOpenUrl: 之前，我的应用程序中没有任何东西在使用它。

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url
{
    NSLog(@"url: %@", url);
    ...
} 
```

我也不知道这是否有帮助，但在邮件应用程序中，它确实在 NSIS.nsi 文件旁边显示了我的应用程序图标。是的，文件名在 Mail 中显示为“NSIS.nsi”。

**更新 2**

我能够确认将第一个扩展名更改为“5th”（用于踢球），然后导入“NSIS.nsi”文件，它确实将文件扩展名更改为“NSIS.5th”。我认为正在发生的事情是我正在定义我的应用程序不正确支持的 UTI。我只想说，“嘿，iOS，我支持所有这些文件扩展名。不要更改名称。只要给我文件，让我做我需要做的事情。” 实际上，我只是希望我的应用程序支持所有类型的文本文件（文本、utf8、utf16 等）。这就是最终结果。

问题是，当我告诉 iOS 我支持纯文本、utf8 和 utf16 时，它仍然不会在可以打开文件的应用程序列表中显示我的应用程序，除非我在 public.filename-extension 数组中*专门*设置了扩展名. 我希望 plist 中只有一个包罗万象的“我支持所有文本文件”配置值。

我注意到的另一件事是该问题确实会影响其他文件扩展名。例如，我有一个文件要从 Mail 导出到我的应用程序，名为“Ada.adb”。iOS 将文件作为“Ada.ada”返回（注意末尾的“a”而不是“b”）。这是有道理的......我什至在 public.filename-extension 数组或我的应用程序中的*任何地方的文件扩展名列表中都没有'ada'。*

**更新 3**

我想出了如何支持所有类型的 public.text 文件。

```
<key>CFBundleDocumentTypes</key>
<array>
    <dict>
        <key>CFBundleTypeIconFiles</key>
        <array>
            <string>icon_buffer_ipad_small.png</string>
            <string>icon_buffer_iphone_small.png</string>
        </array>
        <key>LSItemContentTypes</key>
        <array>
            <string>public.text</string>
        </array>
        <key>NSExportableTypes</key>
        <array>
            <string>public.text</string>
        </array>
        <key>CFBundleTypeName</key>
        <string>Source File</string>
        <key>LSHandlerRank</key>
        <string>Default</string>
    </dict>
</array> 
```

本质上，除了**LSItemContentTypes**之外，您还需要包含**NSExportableTypes**。当我弄清楚如何制作其他“public.text”文件类型（例如 4th、md 以及与您的应用程序相关联的 public.text 其他文件类型的巨大列表）时，我将添加更新。希望这不是必需的。无论如何，我会更新我的发现。

 ****更新 4**

你们不会相信这个的。这个问题会影响我测试过的*每个应用程序。*本质上，当我尝试导出“Ada.adb”文件时，它会将文件作为“Ada.ada”导出到*每个*应用程序。哇！我要弄清楚如何向Apple提交这个错误。当然，除非这是预期的行为！

小更新：我将错误提交给 Apple。错误 ID# 12802236

我不记得这发生在 iOS 5 中。我相信这是 iOS 6 中引入的回归。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:55:47.480

如果文件名没有改变，那么在`- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url`收到文件后手动更改其扩展名如何`url`？当然，您必须知道正确的扩展名是什么。**

# jquery - 不是jquery中的函数

> ID：13693927
> 
> 赞同：-4
> 
> 时间：2012-12-03T23:55:46.810
> 
> 标签：jquery

我有一个大问题，我无法正确执行我的 jQuery 代码。

我编辑了帖子以显示html...

```
<select id="corrector" name="availability" value="" onchange="escorrecto();" >
    <option value="correcto"></option>
    <option value="incorrecto"></option>
    <option value="nodefinido"></option>
</select> 
```

和 jQuery 代码...

```
function escorrecto() 
{
    switch ($('corrector').value) 
    {
        case 'correcto':
            alert($('corrector').value)
        break;
        case 'incorrecto':
            alert($('corrector').value)
        break;

        case 'nodefinido':
            alert($('corrector').value)
            $("#campo").prop("disabled",true); 
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:57:27.730

```
$('campo').value 
```

应该是

`$('.campo').val()`如果类 **或** `$('#campo').val()`如果 id

**.value**是`native javascript method`

**.val()**是一个`jQuery method`

如果你想使用，`.value`那么这应该工作

```
$('#campo')[0].value; 
```

也在`$("otro").attr("disabled","disabled");`

更喜欢使用`.prop()` 而不是`.attr()`

```
$("#otro").prop("disabled",true); 
```

**校验码**

```
<select id="corrector" name="availability" value="" onchange="escorrecto();" >
    <option value="correcto">Correcto</option>
    <option value="incorrecto">Incorrecto</option>
    <option value="nodefinido">Nodefinido</option>
</select>

<input type="text" id="campo" value="Submit" />
<script>
    function escorrecto() 
{
    var val = $('#corrector')[0].value
    switch (val) 
    {
        case 'correcto':
            alert(val)
        break;
        case 'incorrecto':
            alert(val)
        break;

        case 'nodefinido':
            alert(val)
            $("#campo").prop("disabled",true); 
        break;
    }
}
</script> 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/tq2MA/)** </p>

# php - 如何将变量中的mysql行数传递给android

> ID：13693930
> 
> 赞同：0
> 
> 时间：2012-12-03T23:55:51.527
> 
> 标签：php, android, mysql, json

使用php脚本查询mysql数据库没有问题。但是我无法用 JSON 解析结果并将其发送回 android。我对数组进行编码/解析没有问题 - 单个变量不同吗？有没有更好的方法将行数发送回android？

php代码：

```
$result = mysql_query("SELECT * FROM logs WHERE uid = '$uid' AND tableid = '$tid'");
$num_rows = mysql_num_rows($result);

echo json_encode($num_rows); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:01:43.793

您只需选择查询中的行数。

选择计数（*）...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T18:51:56.613

我不确定您在问什么，上面的代码只会输出行数，要使其在 android 应用程序中可访问，您必须将其设置为键值对，以便您可以使用键访问行号下面给出，

```
$result = mysql_query("SELECT * FROM logs WHERE uid = '$uid' AND tableid = '$tid'");
$num_rows = mysql_num_rows($result);
$output = array("count" => $num_rows);
echo json_encode($output); 
```

这将输出 {"count":123}

# c# - rowUpdating 似乎触发了两次 - 第二次出错时参数太多

> ID：13693931
> 
> 赞同：1
> 
> 时间：2012-12-03T23:55:59.210
> 
> 标签：c#, asp.net, gridview

我有一个网格视图，我正在尝试更新该行。如果我在行更新事件上放置一个断点，它会在第一次被击中并且行更新成功。当我继续单步执行该代码时，第二次没有命中，但是我得到一个异常，即来自该更新的存储过程具有太多参数并引发错误。

我确实将 autoeventwireup 设置为 true。这是一个问题吗？我尝试将其设置为 false，但我在 page_load 中发生了其他事情，这些事情没有发生并破坏了页面。另外，从我读过的内容来看，这可能不是问题。任何帮助是极大的赞赏！

这是错误的堆栈跟踪

```
[SqlException (0x80131904): Procedure or function RecordingUpdateName has too many arguments specified.]
   System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +2084358
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +5096328
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +234
   System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +2294
   System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +215
   System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) +987
   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +162
   System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) +178
   System.Data.SqlClient.SqlCommand.ExecuteNonQuery() +137
   System.Web.UI.WebControls.SqlDataSourceView.ExecuteDbCommand(DbCommand command, DataSourceOperation operation) +394
   System.Web.UI.WebControls.SqlDataSourceView.ExecuteUpdate(IDictionary keys, IDictionary values, IDictionary oldValues) +697
   System.Web.UI.DataSourceView.Update(IDictionary keys, IDictionary values, IDictionary oldValues, DataSourceViewOperationCallback callback) +95
   System.Web.UI.WebControls.GridView.HandleUpdate(GridViewRow row, Int32 rowIndex, Boolean causesValidation) +1226
   System.Web.UI.WebControls.GridView.HandleEvent(EventArgs e, Boolean causesValidation, String validationGroup) +855
   System.Web.UI.WebControls.GridView.OnBubbleEvent(Object source, EventArgs e) +95
   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37
   System.Web.UI.WebControls.GridViewRow.OnBubbleEvent(Object source, EventArgs e) +121
   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37
   System.Web.UI.WebControls.LinkButton.OnCommand(CommandEventArgs e) +125
   System.Web.UI.WebControls.LinkButton.RaisePostBackEvent(String eventArgument) +169
   System.Web.UI.WebControls.LinkButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +9
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +176
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563 
```

和：

```
<asp:GridView ID="grdvwRecordings" runat="server"
    DataSourceID="sqldataRecordings"
    EmptyDataText="No recordings have been saved. Select Call Now below. "
    DataKeyNames="RecordingID"
    onrowdeleting="grdvwRecordings_RowDeleting"
    onrowupdating="grdvwRecordings_RowUpdating"
    onrowediting="grdvwRecordings_RowEditing"
    AutoGenerateColumns="False"
    onrowdatabound="grdvwRecordings_RowDataBound">

    <Columns>
        <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" />
        <asp:TemplateField HeaderText="Recording">
            <ItemTemplate>
                <asp:Label ID="lblRecordingName" Text='<%# Bind("Name") %>' runat="server"></asp:Label>
            </ItemTemplate>
            <EditItemTemplate>
                <asp:TextBox ID="txtRecordingName" Text='<%# Bind("Name") %>' runat="server"></asp:TextBox>
            </EditItemTemplate>
        </asp:TemplateField>

        <asp:TemplateField HeaderText="Date Recorded">
            <ItemTemplate>
                <asp:Label ID="lblDateRecorded" Text='<%# Bind("EntryDate") %>' runat="server"></asp:Label>
            </ItemTemplate>
        </asp:TemplateField>

        <asp:TemplateField HeaderText="Duration">
            <ItemTemplate>
                <asp:Label ID="lblDuration" Text='<%# Bind("Duration") %>' runat="server"></asp:Label>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>
<asp:SqlDataSource ID="sqldataRecordings" SelectCommand="[RecordingSelectByClient]"
   SelectCommandType="StoredProcedure" runat="server"
   ConnectionString="<%$ ConnectionStrings:VB %>"
   onselecting="AddClientIDParameter_Selecting"
   UpdateCommand="RecordingUpdateName"
   UpdateCommandType="StoredProcedure"
   DeleteCommand="RecordingDelete"
   DeleteCommandType="StoredProcedure">

    <UpdateParameters>
        <asp:Parameter Name="RecordingName" Type="String" />
        <asp:Parameter Name="RecordingID" Type="Int32" />
    </UpdateParameters>

</asp:SqlDataSource> 
```

和：

```
protected void grdvwRecordings_RowUpdating(object sender, GridViewUpdateEventArgs e)
{

   this.sqldataRecordings.UpdateParameters["RecordingID"].DefaultValue = e.Keys["RecordingID"].ToString();
   this.sqldataRecordings.UpdateParameters["RecordingName"].DefaultValue = e.NewValues["Name"].ToString();

    this.sqldataRecordings.Update();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T02:04:52.723

请尝试以下方法：

`onrowupdating="grdvwRecordings_RowUpdating"`从 GridView 属性中删除

在`SqlDataSource`标签中替换为`UpdateParameters`：

```
<UpdateParameters>
    <asp:QueryStringParameter Name="RecordingName" QueryStringField="Name" Type="String" />
    <asp:QueryStringParameter Name="RecordingID" QueryStringField="RecordingID" Type="String" />
</UpdateParameters> 
```

我认为正在发生的事情是您在 GridView （使用`OnRowUpdated`属性）和`SqlDataSource`.

**编辑：**
正如 Tim Brooks 在下面的评论中指出的那样，他需要使用`<%# Eval("Name") %>`而不是 Bind，因为绑定的字段会自动作为参数添加到更新命令中。

此外，我不会担心通过进行我建议的更改来暴露您的主键。由于这是一个 Web 应用程序，并且您正在从 GridViewUpdateEventArgs 获取 RecordingID，因此您已经将信息传递到 ViewState 中的用户计算机。如果这是不可接受的，我建议您加密 ViewState。可能会有明显的性能影响，但 ViewState 将不会被读取。
有关详细信息，请参阅[Page.ViewStateEncryptionMode 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.page.viewstateencryptionmode.aspx)、[加密 ASP.NET 2.0](http://msdn.microsoft.com/en-us/library/aa479501.aspx)中的 ViewState 和[保护视图状态](http://msdn.microsoft.com/en-us/library/ms178199.aspx)。

如果您需要 ViewState 入门，您可以从[这篇文章](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)开始，但我相信还有很多其他好的。

# mysql - IF 内的子查询作为具有空值的列的值

> ID：13693936
> 
> 赞同：3
> 
> 时间：2012-12-03T23:56:27.217
> 
> 标签：mysql, if-statement, subquery

鉴于：

```
t1{id,type}
t2{type,table1_id} 
```

我正在使用这个：

```
SELECT IF(t1.type IS NULL, 'some default', t1.type) as ret from t1 
```

我想做这样的事情：

```
SELECT IF(
    t1.type IS NULL, 
    IF(
        (SELECT t2.type FROM t2 WHERE t2.table1_id=t1.id LIMIT 1) IS NOT NULL,
        table2.type,
        'some defaults'
    ),
    t1.type
) as ret from table1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T00:16:22.330

这 -

```
SELECT IF(
    t1.type IS NULL, 
    IF(
        (SELECT t2.type FROM t2 
           WHERE t2.table1_id=t1.id LIMIT 1)
           IS NOT NULL,
        t2.type,
        'some defaults'),
    t1.type
) as ret from t1, t2 where t1.id = t2.table1_id 
```

似乎[工作](http://sqlfiddle.com/#!2/0d7b5/1)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T00:01:31.967

我相信你正在寻找[`IFNULL`](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html).

> `IFNULL(expr1,expr2)`
> 
> 如果`expr1`不是`NULL`，则`IFNULL()`返回`expr1`；否则返回`expr2`。`IFNULL()`返回一个数字或字符串值，具体取决于使用它的上下文。

这会将您当前的声明转换为：

```
SELECT IFNULL(t1.type, 'some default') AS ret FROM t1 
```

或者，您可以使用[`CASE`](http://dev.mysql.com/doc/refman/5.0/en/case.html)块。

```
SELECT
    (SELECT CASE
        WHEN t1.type IS NULL
            THEN 'some default'
        ELSE t1.type
    END AS ret) AS subq
... 
```

希望这可以帮助。

# javascript - 如何将屏幕截图从扩展移动到内容脚本？

> ID：13693939
> 
> 赞同：4
> 
> 时间：2012-12-03T23:56:40.540
> 
> 标签：javascript, google-chrome-extension, screen-capture

所以这个想法是这样的......我要做的就是在加载特定内容脚本后立即调用扩展背景页面。（在这种情况下，当加载页面时）我的内容脚本中有类似的内容。

```
var port = chrome.extension.connect({name: "screenshot"});
port.postMessage({request: "screenshot"});
port.onMessage.addListener(function(msg) {
    var img = document.createElement('img');
    img.src = msg.response;
    document.body.appendChild(img);
}); 
```

在我的 background.js 页面中是这样的

```
function takeScreenshot(){
    chrome.tabs.captureVisibleTab(null, function(img) {
        return img;

    });
}
chrome.extension.onConnect.addListener(function(port) {
    console.assert(port.name == "screenshot");
    port.onMessage.addListener(function(msg) {
    if (msg.request == "screenshot"){
        port.postMessage({response: takeScreenshot() });
    }
    });
}); 
```

但是我没有运气......我让图像出现在身体上，但是当从 takeScreenshot 返回 img 时它实际上并没有传递图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T03:18:05.837

[问题是您试图在后台页面](https://developer.chrome.com/extensions/background_pages.html)中实现同步和异步事件之间的同步

a) [chrome.tabs.captureVisibleTab()](https://developer.chrome.com/extensions/tabs.html#method-captureVisibleTab)是异步的

b) [port.postMessage()](http://developer.chrome.com/extensions/messaging.html)是同步的

当`port.postMessage({response: takeScreenshot() });`被调用时，它不会等待*takeScreenshot()* [**回调**](https://developer.chrome.com/extensions/tabs.html#method-captureVisibleTab)，即；`return img;`所以一个空的 JSON 对象被发送到[内容脚本](http://developer.chrome.com/extensions/content_scripts.html)

[回拨](https://developer.chrome.com/extensions/tabs.html#method-captureVisibleTab)返回后通过[发布消息](http://developer.chrome.com/extensions/messaging.html)来避免它

```
chrome.extension.onConnect.addListener(function(port) {
    console.assert(port.name == "screenshot");
    port.onMessage.addListener(function(msg) {
    if (msg.request == "screenshot"){
        chrome.tabs.captureVisibleTab(null,{format:"jpeg",quality:100},function(img) {
        //post message only after call back return with Data URL
        port.postMessage(img);
        });
    }
    });
}); 
```

**工作版演示**

***清单.json***

```
{
"name":"Screen Shot Demo",
"description":"This demonstrates Screen Shot API",
"manifest_version":2,
"version":"1",
"permissions":["tabs","<all_urls>"],
"background":{
    "scripts":["background.js"]
},
"content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["myscript.js"]
    }
  ]
} 
```

***背景.js***

```
chrome.extension.onConnect.addListener(function(port) {
    console.assert(port.name == "screenshot");
    port.onMessage.addListener(function(msg) {
    if (msg.request == "screenshot"){
        chrome.tabs.captureVisibleTab(null,{format:"jpeg",quality:100},function(img) {
        //post message only after call back return with Data URL
        port.postMessage(img);
        });
    }
    });
}); 
```

***myscript.js***（内容脚本）

```
var port = chrome.extension.connect({
    name: "screenshot"
});
port.postMessage({
    request: "screenshot"
});
port.onMessage.addListener(function (msg) {
    var img = document.createElement('img');
    img.src = msg;
    document.body.appendChild(img);
}); 
```

如果您需要更多信息，请与我们联系。

# java - 为什么 Java 可以有很多 Main，您可以决定要运行哪个 java 文件，但对于 C++，您只有一个 Main？

> ID：13693943
> 
> 赞同：-3
> 
> 时间：2012-12-03T23:57:17.993
> 
> 标签：java, c++

每次我写C++，我需要把不同的代码放到main中，有什么办法让它简单，比如a1.cpp有main，a2.cpp有另一个main，比如a1.cpp

```
int main() {
    printf("a1");
} 
```

在 a2.cpp 中

```
int main() {
    printf("a2");
} 
```

当你运行 a1.cpp 你得到`a1`打印输出，当你运行时`a2`，你得到字符串`a2`，我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T00:08:13.430

技术性：您可以`main`在 C++ 程序中拥有任意数量的函数，但在*全局命名空间*中只有一个具有外部链接。

如果您想要 C++ 程序中的多个入口点，最简单的可能是使用命令行参数，并`main`根据该参数对其他启动函数进行主要调度。

一种替代方法是构建多个可执行文件，一个用于您想要的每个启动功能。您可以通过与具有该启动功能的目标代码文件链接来选择启动功能。或者，您可以使用预处理器指令有条件地仅包含每个构建的相关定义`main`。

另一种选择是创建一个具有多个导出函数的 Windows DLL，但它是特定于系统的。然后可以通过`rundll32.exe`标准 Windows 程序运行 32 位这样的 DLL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T23:59:04.573

只要您不将目标文件链接在一起，它就有效。按原样，文件`a1.cpp`, `a2.cpp`,`a42.cpp`完全不相关。您可以将它们编译为单独的可执行文件，然后单独执行它们就可以了。

这一点的重要方面是你不“跑” `a1.cpp`。您在处理完之后“运行”编译器的输出`a1.cpp`。

在 C++ 中，`main`——程序的入口点——驻留在全局范围内，与 Java 不同，它被包装在一个类中。因此，由于多重定义，您不能`main`在单个程序中有多个 s 。与此等效的 Java 将具有同一类（相同名称）的多个定义，这也是非法的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T00:07:57.827

嗯，我认为主要区别在于 Java 字节码是在 JVM 上执行的，它是在 OS 上执行的，而 C++ 程序是直接在 OS 上执行的，所以基本上你可以告诉 JVM 应用程序的入口点是什么，而你在 OS 上运行入口点是由内存位置预先定义的（至少据我所知，如果我错了，有人纠正我），因此无法更改。虽然您可以轻松地编写 BASH 脚本（用于 *NIX）或 Windows 上的 *.bat 文件，但它们会将文件名作为输入，编译它，然后执行它。在 bash 中看起来像：

构建.sh：

```
#!/bin/bash
gcc $1 -o prog.out && ./prog.out && rm prog.out 
```

.

```
./build.sh a1.cpp
./build.sh a2.cpp 
```

# opengl - 使用 GLSL 着色器进行图像处理？

> ID：13693946
> 
> 赞同：7
> 
> 时间：2012-12-03T23:57:56.827
> 
> 标签：opengl, image-processing, glsl

我参加了着色器课程，对计算机视觉和图像处理感兴趣。我想知道如何将 GLSL 着色器知识与图像处理相结合？如果我用 GLSL 实现图像处理算法，我会得到什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-11-16T19:47:59.540

**案例研究：CPU 与 GPU 片段着色器上的实时框模糊**

我在 CPU 和 GPU 片段着色器上实现了一个简单的框模糊[https://en.wikipedia.org/wiki/Box_blur](https://en.wikipedia.org/wiki/Box_blur)算法，看看哪个更快：

*   演示视频[https://www.youtube.com/watch?v=MRhAljmHq-o](https://www.youtube.com/watch?v=MRhAljmHq-o)
*   源代码：[https ://github.com/cirosantilli/cpp-cheat/blob/cfd18700827dfcff6080a938793b44b790f0b7e7/opengl/glfw_webcam_image_process.c](https://github.com/cirosantilli/cpp-cheat/blob/cfd18700827dfcff6080a938793b44b790f0b7e7/opengl/glfw_webcam_image_process.c)

[![在此处输入图像描述](../Images/35135586816cb17f285e46d786d1016e.png)](https://i.stack.imgur.com/gZ87k.gif)

我的相机刷新率将 FPS 限制在 30，所以我测量了盒子的宽度，并且仍然保持 30 FPS。

在图像尺寸为 960x540 的 Lenovo T430 (2012)、NVIDIA NVS5400、Ubuntu 16.04 上，最大宽度为：

*   显卡：23
*   中央处理器：5

由于计算是二次的，因此加速比为：

```
( 23 / 5 ) ^ 2 = 21.16 
```

GPU比CPU快！

并非所有算法在 GPU 上都更快。比如像交换RGB这样对单张图片的操作，在CPU上达到30FPS，所以再增加GPU编程的复杂度是没有用的。

就像任何其他 CPU 与 GPU 加速问题一样，如果您有足够的每个字节传输到 GPU 的工作量，那么一切都会下降，而基准测试是您能做的最好的事情。一般来说，二次算法或更差的算法对于 GPU 来说是一个不错的选择。另请参阅：[术语“CPU 限制”和“I/O 限制”是什么意思？](https://stackoverflow.com/questions/868568/what-do-the-terms-cpu-bound-and-i-o-bound-mean/33510470#33510470)

代码的主要部分（只是从 GitHub 克隆）：

```
#include "common.h"
#include "../v4l2/common_v4l2.h"

static const GLuint WIDTH = 640;
static const GLuint HEIGHT = 480;
static const GLfloat vertices[] = {
/*  xy            uv */
    -1.0,  1.0,   0.0, 1.0,
     0.0,  1.0,   0.0, 0.0,
     0.0, -1.0,   1.0, 0.0,
    -1.0, -1.0,   1.0, 1.0,
};
static const GLuint indices[] = {
    0, 1, 2,
    0, 2, 3,
};

static const GLchar *vertex_shader_source =
    "#version 330 core\n"
    "in vec2 coord2d;\n"
    "in vec2 vertexUv;\n"
    "out vec2 fragmentUv;\n"
    "void main() {\n"
    "    gl_Position = vec4(coord2d, 0, 1);\n"
    "    fragmentUv = vertexUv;\n"
    "}\n";
static const GLchar *fragment_shader_source =
    "#version 330 core\n"
    "in vec2 fragmentUv;\n"
    "out vec3 color;\n"
    "uniform sampler2D myTextureSampler;\n"
    "void main() {\n"
    "    color = texture(myTextureSampler, fragmentUv.yx).rgb;\n"
    "}\n";

static const GLchar *vertex_shader_source2 =
    "#version 330 core\n"
    "in vec2 coord2d;\n"
    "in vec2 vertexUv;\n"
    "out vec2 fragmentUv;\n"
    "void main() {\n"
    "    gl_Position = vec4(coord2d + vec2(1.0, 0.0), 0, 1);\n"
    "    fragmentUv = vertexUv;\n"
    "}\n";
static const GLchar *fragment_shader_source2 =
    "#version 330 core\n"
    "in vec2 fragmentUv;\n"
    "out vec3 color;\n"
    "uniform sampler2D myTextureSampler;\n"
    "// pixel Delta. How large a pixel is in 0.0 to 1.0 that textures use.\n"
    "uniform vec2 pixD;\n"
    "void main() {\n"

    /*"// Identity\n"*/
    /*"    color = texture(myTextureSampler, fragmentUv.yx ).rgb;\n"*/

    /*"// Inverter\n"*/
    /*"    color = 1.0 - texture(myTextureSampler, fragmentUv.yx ).rgb;\n"*/

    /*"// Swapper\n"*/
    /*"    color = texture(myTextureSampler, fragmentUv.yx ).gbr;\n"*/

    /*"// Double vision ortho.\n"*/
    /*"    color = ("*/
    /*"        texture(myTextureSampler, fragmentUv.yx ).rgb +\n"*/
    /*"        texture(myTextureSampler, fragmentUv.xy ).rgb\n"*/
    /*"    ) / 2.0;\n"*/

    /*"// Multi-me.\n"*/
    /*"    color = texture(myTextureSampler, 4.0 * fragmentUv.yx ).rgb;\n"*/

    /*"// Horizontal linear blur.\n"*/
    /*"    int blur_width = 21;\n"*/
    /*"    int blur_width_half = blur_width / 2;\n"*/
    /*"    color = vec3(0.0, 0.0, 0.0);\n"*/
    /*"    for (int i = -blur_width_half; i <= blur_width_half; ++i) {\n"*/
    /*"       color += texture(myTextureSampler, vec2(fragmentUv.y + i * pixD.x, fragmentUv.x)).rgb;\n"*/
    /*"    }\n"*/
    /*"    color /= blur_width;\n"*/

    /*"// Square linear blur.\n"*/
    "    int blur_width = 23;\n"
    "    int blur_width_half = blur_width / 2;\n"
    "    color = vec3(0.0, 0.0, 0.0);\n"
    "    for (int i = -blur_width_half; i <= blur_width_half; ++i) {\n"
    "       for (int j = -blur_width_half; j <= blur_width_half; ++j) {\n"
    "           color += texture(\n"
    "               myTextureSampler, fragmentUv.yx + ivec2(i, j) * pixD\n"
    "           ).rgb;\n"
    "       }\n"
    "    }\n"
    "    color /= (blur_width * blur_width);\n"

    "}\n";

int main(int argc, char **argv) {
    CommonV4l2 common_v4l2;
    GLFWwindow *window;
    GLint
        coord2d_location,
        myTextureSampler_location,
        vertexUv_location,
        coord2d_location2,
        pixD_location2,
        myTextureSampler_location2,
        vertexUv_location2
    ;
    GLuint
        ebo,
        program,
        program2,
        texture,
        vbo,
        vao,
        vao2
    ;
    unsigned int
        cpu,
        width,
        height
    ;
    uint8_t *image;
    float *image2 = NULL;
    /*uint8_t *image2 = NULL;*/

    if (argc > 1) {
        width = strtol(argv[1], NULL, 10);
    } else {
        width = WIDTH;
    }
    if (argc > 2) {
        height = strtol(argv[2], NULL, 10);
    } else {
        height = HEIGHT;
    }
    if (argc > 3) {
        cpu = (argv[3][0] == '1');
    } else {
        cpu = 0;
    }

    /* Window system. */
    glfwInit();
    glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);
    window = glfwCreateWindow(2 * width, height, __FILE__, NULL, NULL);
    glfwMakeContextCurrent(window);
    glewInit();
    CommonV4l2_init(&common_v4l2, COMMON_V4L2_DEVICE, width, height);

    /* Shader setup. */
    program = common_get_shader_program(vertex_shader_source, fragment_shader_source);
    coord2d_location = glGetAttribLocation(program, "coord2d");
    vertexUv_location = glGetAttribLocation(program, "vertexUv");
    myTextureSampler_location = glGetUniformLocation(program, "myTextureSampler");

    /* Shader setup 2\. */
    const GLchar *fs;
    if (cpu) {
        fs = fragment_shader_source;
    } else {
        fs = fragment_shader_source2;
    }
    program2 = common_get_shader_program(vertex_shader_source2, fs);
    coord2d_location2 = glGetAttribLocation(program2, "coord2d");
    vertexUv_location2 = glGetAttribLocation(program2, "vertexUv");
    myTextureSampler_location2 = glGetUniformLocation(program2, "myTextureSampler");
    pixD_location2 = glGetUniformLocation(program2, "pixD");

    /* Create vbo. */
    glGenBuffers(1, &vbo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);
    glBindBuffer(GL_ARRAY_BUFFER, 0);

    /* Create ebo. */
    glGenBuffers(1, &ebo);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ebo);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);

    /* vao. */
    glGenVertexArrays(1, &vao);
    glBindVertexArray(vao);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ebo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo);
    glVertexAttribPointer(coord2d_location, 2, GL_FLOAT, GL_FALSE, 4 * sizeof(vertices[0]), (GLvoid*)0);
    glEnableVertexAttribArray(coord2d_location);
    glVertexAttribPointer(vertexUv_location, 2, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), (GLvoid*)(2 * sizeof(vertices[0])));
    glEnableVertexAttribArray(vertexUv_location);
    glBindVertexArray(0);

    /* vao2\. */
    glGenVertexArrays(1, &vao2);
    glBindVertexArray(vao2);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ebo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo);
    glVertexAttribPointer(coord2d_location2, 2, GL_FLOAT, GL_FALSE, 4 * sizeof(vertices[0]), (GLvoid*)0);
    glEnableVertexAttribArray(coord2d_location2);
    glVertexAttribPointer(vertexUv_location2, 2, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), (GLvoid*)(2 * sizeof(vertices[0])));
    glEnableVertexAttribArray(vertexUv_location2);
    glBindVertexArray(0);

    /* Texture buffer. */
    glGenTextures(1, &texture);
    glBindTexture(GL_TEXTURE_2D, texture);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

    /* Constant state. */
    glViewport(0, 0, 2 * width, height);
    glClearColor(1.0f, 1.0f, 1.0f, 1.0f);
    glActiveTexture(GL_TEXTURE0);

    /* Main loop. */
    common_fps_init();
    do {
        /* Blocks until an image is available, thus capping FPS to that.
         * 30FPS is common in cheap webcams. */
        CommonV4l2_updateImage(&common_v4l2);
        image = CommonV4l2_getImage(&common_v4l2);
        glClear(GL_COLOR_BUFFER_BIT);

        /* Original. */
        glTexImage2D(
            GL_TEXTURE_2D, 0, GL_RGB, width, height,
            0, GL_RGB, GL_UNSIGNED_BYTE, image
        );
        glUseProgram(program);
        glUniform1i(myTextureSampler_location, 0);
        glBindVertexArray(vao);
        glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);
        glBindVertexArray(0);

        /* Optional CPU modification to compare with GPU shader speed.  */
        if (cpu) {
            image2 = realloc(image2, 3 * width * height * sizeof(image2[0]));
            for (unsigned int i = 0; i < height; ++i) {
                for (unsigned int j = 0; j < width; ++j) {
                    size_t index = 3 * (i * width + j);

                    /* Inverter. */
                    /*image2[index + 0] = 1.0 - (image[index + 0] / 255.0);*/
                    /*image2[index + 1] = 1.0 - (image[index + 1] / 255.0);*/
                    /*image2[index + 2] = 1.0 - (image[index + 2] / 255.0);*/

                    /* Swapper. */
                    /*image2[index + 0] = image[index + 1] / 255.0;*/
                    /*image2[index + 1] = image[index + 2] / 255.0;*/
                    /*image2[index + 2] = image[index + 0] / 255.0;*/

                    /* Square linear blur. */
                    int blur_width = 5;
                    int blur_width_half = blur_width / 2;
                    int blur_width2 = (blur_width * blur_width);
                    image2[index + 0] = 0.0;
                    image2[index + 1] = 0.0;
                    image2[index + 2] = 0.0;
                    for (int k = -blur_width_half; k <= blur_width_half; ++k) {
                        for (int l = -blur_width_half; l <= blur_width_half; ++l) {
                            int i2 = i + k;
                            int j2 = j + l;
                            // Out of bounds is black. TODO: do module to match shader exactly. 
                            if (i2 > 0 && i2 < (int)height && j2 > 0 && j2 < (int)width) {
                                unsigned int srcIndex = index + 3 * (k * width + l);
                                image2[index + 0] += image[srcIndex + 0];
                                image2[index + 1] += image[srcIndex + 1];
                                image2[index + 2] += image[srcIndex + 2];
                            }
                        }
                    }
                    image2[index + 0] /= (blur_width2 * 255.0);
                    image2[index + 1] /= (blur_width2 * 255.0);
                    image2[index + 2] /= (blur_width2 * 255.0);
                }
            }
            glTexImage2D(
                GL_TEXTURE_2D, 0, GL_RGB, width, height,
                0, GL_RGB, GL_FLOAT, image2
            );
        }

        /* Modified. */
        glUseProgram(program2);
        glUniform1i(myTextureSampler_location2, 0);
        glUniform2f(pixD_location2, 1.0 / width, 1.0 / height);
        glBindVertexArray(vao2);
        glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);
        glBindVertexArray(0);

        glfwSwapBuffers(window);
        glfwPollEvents();
        common_fps_print();
    } while (!glfwWindowShouldClose(window));

    /* Cleanup. */
    if (cpu) {
        free(image2);
    }
    CommonV4l2_deinit(&common_v4l2);
    glDeleteBuffers(1, &vbo);
    glDeleteVertexArrays(1, &vao);
    glDeleteTextures(1, &texture);
    glDeleteProgram(program);
    glfwTerminate();
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T01:25:46.910

第一个明显的答案是您获得了并行性。现在，为什么使用 GLSL 而不是说更灵活的 CUDA 呢？GLSL 不需要您拥有 NVIDIA 显卡，因此它是一种更便携的解决方案（尽管您仍然可以选择 OpenCL）。

您可以通过并行获得什么？大多数时候，您可以独立处理像素。例如，增加图像的对比度通常需要您遍历所有像素并应用像素值的仿射变换。如果每个像素都由单独的线程处理，那么您不再需要执行此循环：您只需对四边形进行分级，然后应用像素着色器读取当前栅格化点处的纹理，然后输出到渲染目标 (或屏幕）转换后的像素值。

缺点是您的数据需要驻留在 GPU 上：您需要将所有图像传输到 GPU，这可能需要一些时间，并且会使并行化获得的加速变得无用。因此，GPU 实现通常在要进行的操作是计算密集型时完成，或者当整个管道可以保留在 GPU 上时（例如，如果目标是仅在屏幕上显示修改后的图像，则无需将图像传回 CPU 上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:54:29.613

OpenGL 4.3（在 SIGGRAPH 2012 上宣布）支持计算着色器。如果您正在做严格的图形工作，并且已经在使用 OpenGL，那么使用它可能比 OpenCL / OpenGL 互操作（或 CUDA / OpenGL 互操作）更容易。

以下是 Khronos 对何时使用 4.3 Compute shaders 与 OpenCL 的对比：[链接到 PDF；见幻灯片 5](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&ved=0CEwQFjAD&url=http%3A%2F%2Fwww.khronos.org%2Fassets%2Fuploads%2Fdevelopers%2Flibrary%2F2012-siggraph-opencl-bof%2FOpenCL-BOF-Intro-SIGGRAPH_Aug12.pdf&ei=hOvEULn6DvGFyQG4roGgBw&usg=AFQjCNEFMVhXdyp3Lw1TAxYcd1zHMTkVSA&sig2=qLYTDGsHcVwZnZnoyDMS3w&cad=rja)。

# amazon-web-services - 当您的实例位于 ELB 之后时，您如何为 AWS 建立维护页面？

> ID：13693947
> 
> 赞同：48
> 
> 时间：2012-12-03T23:57:56.630
> 
> 标签：amazon-web-services, amazon-elb, amazon-route53

当您想在 ELB 后面部署新版本的应用程序时，如何在 AWS 中建立维护页面？我们希望在新的自动扩展实例出现时让 ELB 将流量路由到维护实例，并且只有在它们完全启动后才“翻转”到新实例。我们使用自动缩放来降低现有实例并启动具有新代码的新实例。

我们试图避免的情况是让 ELB 为新 EC2 实例提供流量，同时还提供维护页面。由于我们没有启用粘性会话，我们希望防止用户在维护模式页面和部署在 EC2 实例中的应用程序之间来回切换。我们也不能只是扩大规模（例如从 2 个实例增加到 4 个实例，然后再回到 2 个）来引入新实例，因为代码更改可能涉及数据库更改，这会破坏旧代码的更改。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2018-12-17T13:54:16.353

我意识到这是一个老问题，但在今天（2018 年 12 月）面临同样的问题之后，似乎还有另一种方法可以解决这个问题。

今年早些时候，AWS 引入了[对应用程序负载均衡器的重定向和固定响应的](https://aws.amazon.com/about-aws/whats-new/2018/07/elastic-load-balancing-announces-support-for-redirects-and-fixed-responses-for-application-load-balancer/)支持。简而言之：

*   在控制台中找到您的 ELB。
*   查看相应侦听器的规则。
*   为应用程序的主机名添加固定的 503 响应规则。
*   可选择提供一个`text/plain`或`text/html`响应（即您的维护页面 HTML）。
*   保存更改。

一旦规则传播到 ELB（我花了大约 30 秒），当您尝试在浏览器中访问您的主机时，您将看到 503 维护页面。

部署完成后，只需删除您添加的规则。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-12-04T10:05:43.143

AWS 上最简单的方法是使用他们的 DNS 服务[Route 53](http://aws.amazon.com/route53/)。

您可以使用[加权循环](http://aws.amazon.com/about-aws/whats-new/2011/05/24/amazon-route53-elb-integration-wrr-ga/)的功能。

> “您可以使用 WRR 将服务器投入生产，执行 A/B 测试，或平衡跨区域或不同规模数据中心的流量。”

[AWS 文档中有关此功能](http://docs.amazonwebservices.com/Route53/latest/DeveloperGuide/WeightedResourceRecordSets.html)的更多信息

编辑：Route 53 最近添加了一项新功能，允许 DNS 故障转移到 S3。查看他们的文档以获取更多详细信息： http: [//docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-failover.html](http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-failover.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-09-24T23:47:35.613

想出了另一个对我们很有效的解决方案。以下是获得简单 503 http 响应所需的步骤：

1.  复制您的 EB 环境以创建另一个环境，`app-environment-maintenance`例如将其命名为 。
2.  更改自动缩放的配置并将最小和最大服务器都设置为零。这不会花费您任何 EC2 服务器，并且环境将变为灰色并位于您的列表中。
3.  最后，您现在可以使用 AWS CLI 交换环境 CNAME 以使您的主环境进入维护模式。例如：

    ```
    aws elasticbeanstalk swap-environment-cnames \
        --profile "$awsProfile" \
        --region "$awsRegion" \
        --output text \
        --source-environment-name app-prod \
        --destination-environment-name app-prod-maintenance 
    ```

这会将您的`app-prod`环境切换到维护模式。这将导致 ELB 抛出 503，因为没有任何正在运行的 EC2 实例，然后 Cloudfront 可以捕获 503 并返回您的自定义 503 错误页面，如果您愿意，如下所述。

* * *

使用 Cloudfront 的自定义错误页面的奖励配置：

我们使用 Cloudfront，就像许多人使用 HTTPS 等一样。Cloudfront 有错误页面。这是一个要求。

1.  使用您的错误页面创建一个新的 S3 网站托管存储桶。考虑为响应代码、503 等创建单独的文件。有关目录要求和路由，请参见 #6。
2.  将 S3 存储桶添加到您的 Cloudfront 分配。
3.  为类似`/error/*`.
4.  在 Cloudfront 中设置错误页面以处理 503 响应代码并将其指向您的 S3 存储桶路由，例如`/error/503-error.html`

现在，当您的 ELB 抛出 503 时，将显示您的自定义错误页面。

就是这样。我知道有很多步骤可以获取自定义错误页面，并且我尝试了很多建议的选项，包括 Route53 等。但是所有这些都存在与 ELB 和 Cloudfront 等的工作方式的问题。

请注意，在您交换环境的主机名后，传播大约需要一分钟左右。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-04-26T15:30:36.777

Route53 不是解决这个问题的好办法。在维护页面显示之前，DNS 条目需要很长时间才能过期（然后在维护完成后更新它们需要同样的时间）。我意识到在提出这个问题时 Lambda 和 CodeDeploy 触发器并不存在，但我想让其他人知道 Lambda 可用于为此创建一个相对干净的解决方案，我在博客文章中对此进行了详细说明： [http： //blog.ajhodges.com/2016/04/aws-lambda-setting-temporary.html](http://blog.ajhodges.com/2016/04/aws-lambda-setting-temporary.html)

该解决方案的要点是将 Lambda 函数订阅到 CodeDeploy 事件，该事件将您的 ASG 替换为在部署期间为负载均衡器中的静态页面提供服务的微型实例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-08T03:00:28.240

据我所知，我们处于上述答案不适用或不理想的情况。

我们有一个在 64 位 Amazon Linux/2.9.0 上运行 Puma 和 Ruby 2.3 的 Rails 应用程序，它似乎带有（经典）ELB。

所以 ALB 503 处理不是一种选择。

我们还有各种硬件客户端，我不相信它们总是尊重 DNS TTL，所以 Route53 是有风险的。

似乎运行良好的是平台附带的 nginx 上的辅助端口。

我将此添加为`.ebextensions/maintenance.config`

```
files:
  "/etc/nginx/conf.d/maintenance.conf":
    content: |
      server {
        listen 81;
        server_name _ localhost;
        root /var/app/current/public/maintenance;
      }

container_commands:
  restart_nginx:
    command: service nginx restart 
```

[并将https://gist.github.com/pitch-gist/2999707](https://gist.github.com/pitch-gist/2999707)的副本放入`public/maintenance/index.html`

现在要设置维护，我只需将我的 ELB 侦听器切换为指向端口 81 而不是默认的 80。没有额外的实例、s3 存储桶或等待客户端访问新的 DNS。

beantalk（可能主要等待后端的云形成）只需要大约 15 秒左右即可申请。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-20T04:03:57.903

我们的部署过程首先运行一个 cloudformation 来启动一个 ec2 微实例（维护实例），它将预定义的静态页面从 s3 复制到 ec2 上。Cloudformation 随 elb 一起提供，微 ec2 实例连接到该 elb。然后运行脚本（powershell 或 cli）以从 elb 的离开维护实例中删除 Web 实例（ec2）。

这样我们在部署过程中切换到维护实例。

在我们的例子中，我们有两个 elb，一个用于外部，另一个用于内部。在此过程中，我们的内部 elb 不会更新，这也是我们完成产品部署后冒烟测试的方式。测试完成后，我们运行另一个脚本将 Web 实例附加回 elb 并删除维护堆栈。

# hadoop - 将日志发送到远程 hadoop 的问题

> ID：13693949
> 
> 赞同：1
> 
> 时间：2012-12-03T23:58:18.303
> 
> 标签：hadoop

BucketWriter: 创建 hdfs://192.168.1.9:9000/flume/test/FlumeData.1354578514087.tmp 2012-12-03 18:51:07,417 WARN hdfs.HDFSEventSink: HDFS IO error org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hdfs.server.namenode.SafeModeException：无法创建文件/flume/test/FlumeData.1354578514087.tmp。名称节点处于安全模式。上报区块 0.0000 的比例未达到阈值 0.9990。安全模式将自动关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:05:35.203

您的名称节点处于安全模式：

```
Name node is in safe mode. The ratio of reported blocks 0.0000 has not reached the threshold 0.9990 
```

0.0000 的比率通常表示您的数据节点都没有上线，或者它们与名称节点之间存在连接问题。建议您检查数据节点的日志

# twitter - 如何在没有用户交互的情况下获得给定推文的 retweet_count？

> ID：13693950
> 
> 赞同：2
> 
> 时间：2012-12-03T23:58:18.277
> 
> 标签：twitter, oauth

我有一个使用我制作的主题标签的推文列表。我正在使用搜索 API 获取这些推文。我想要的只是获得转发的数量。我不需要代表他们发帖。我需要让每个用户登录到我的网站，登录到 twitter 并通过 OAUTH 批准我的申请，以获取我列表中的每条推文，这看起来很荒谬。必须有一种方法可以在不需要 oauth 的情况下获得该号码。

我尝试直接从搜索 api 中获取它，但这并不一致。我已经尝试过[https://api.twitter.com/1/statuses/show/275729088709283840.json](https://api.twitter.com/1/statuses/show/275729088709283840.json)但由于某种原因这不起作用。有没有办法在不走用户交互的愚蠢道路的情况下完成这个极其简单的任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T18:12:54.327

您必须创建一个使用流 API 的后台进程。Phirehose 是一个 php 库，用于执行此操作：[https ://github.com/fennb/phirehose](https://github.com/fennb/phirehose)

# php - .htaccess 为 Codeigniter 重写 URI 语言代码

> ID：13693951
> 
> 赞同：0
> 
> 时间：2012-12-03T23:58:20.017
> 
> 标签：php, codeigniter, mod-rewrite

我有一个使用“语言”URI 属性来设置语言的网站

```
oursite.com/home?language=en 
```

我们还需要能够使用对 SEO 友好的 2 字符 URI 前置程序

```
oursite.com/en/home 
```

我目前正在重定向到 .htaccess 中的 index.php 文件，但有一些例外，所以我的 .htaccess 有这两行用于重写

```
RewriteRule ^([a-z]{2}|[a-z]{2}-[A-Z]{2})/(.*)? ?$2/language=$1
RewriteRule !^(index\.php|robots\.txt|sitemap\.xml|robots\.txt) /index.php?/$1 
```

我需要进行逻辑重写以结束

```
/index.php?/home?language=en 
```

什么是正确的重写规则集来实现这一点？真的有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T08:00:54.080

该`RewriteRule !^(index\.php|robots\.txt|sitemap\.xml|robots\.txt) /index.php?/$1`行不起作用，因为您无法创建对否定匹配的反向引用。

此外，像: 这样的请求`/index.php?/home?language=en`有点模棱两可，`?`是保留的，需要在查询字符串中编码，否则，可以附加它（这样`?`就变成了 a `&`）。尝试类似：

```
RewriteRule ^([a-z]{2}|[a-z]{2}-[A-Z]{2})/(.*)? /$2?language=$1 [L]
RewriteRule !^(index\.php|robots\.txt|sitemap\.xml|robots\.txt) /index.php?%{REQUEST_URI} [L,QSA] 
```

这需要:`http://oursite.com/en/home`并在内部将其重写为 URI `/index.php?/home&language=en`。但是，如果您确实想要`?`在查询字符串中进行编码，则将第二条规则更改为：

```
RewriteRule !^(index\.php|robots\.txt|sitemap\.xml|robots\.txt) /index.php?%{REQUEST_URI}\%3F%{QUERY_STRING} [L,NE] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T20:32:01.390

您可以在第一条规则中执行此操作。

```
RewriteRule ^([a-z]{2}|[a-z]{2}-[A-Z]{2})/(.*)? /index.php?/$2?language=$1 
```

至于第二条规则（对于没有语言前缀的 url），你可以这样做。正如乔恩所说，您不能反向引用否定匹配。

```
RewiteCond $1 !^index\.php|robots\.txt|sitemap\.xml|robots\.txt
RewriteRule (.*) /index.php?/$1 
```

# opencart - opencart中的可变日期选项

> ID：13693954
> 
> 赞同：-1
> 
> 时间：2012-12-03T23:59:04.503
> 
> 标签：opencart

第一次我想删除日期的文本字段，以便日历将替换它。

2nd 我要进行状态订单.. 我想出售服务，所以我需要按日历进行预订订单。如果日期是绿色客户可以下订单。如果为红色，则客户无法预订订单。如果是黄色，则可以订购某些物品。

![在此处输入图像描述](../Images/2421a95e76947c9355a37e1fa56e0ab5.png)

我希望有人能帮帮忙..

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T14:16:27.730

你必须至少尝试一些东西，然后只征求意见。

无论如何，一些建议：

1.  它不能使用日期类型的选项字段来完成，至少不能使用默认的日期选择器。
2.  您将需要创建自己的日期选择器组件，该组件将在数据库中搜索免费/部分/完全订购的日期并相应地为表格单元格着色。
3.  隐藏输入不是很明智——这个可见的用户可以随时检查他选择了什么日期——如果它不可见，他将需要始终打开日期选择器来检查它......
4.  不允许基于某些预订来订购某些服务会大大降低您的转化率 - 从而减少您的收入。我肯定会采取让用户随时购买/订购任何东西的方式，同时拥有单独的预订系统。如果用户在感谢页面购买服务，我会建议他预订服务的具体日期。在这里，您无需与完全针对您正在尝试的不同事物的产品选项进行斗争。

记住这一点（主要是第四^点）并重新考虑你的问题。

# html - 随机颜色 CSS - 防止使用两次

> ID：13693957
> 
> 赞同：0
> 
> 时间：2012-12-03T23:59:11.213
> 
> 标签：html, css, arrays, random, colors

我之前问过一个问题 -[这里](https://stackoverflow.com/questions/13445658/random-border-color-css)- 关于如何将我的边框颜色设置为随机颜色。我有这个工作。

如您所见，我的数组中有 7 种颜色。如何编辑我的代码，以便一旦选择了颜色，就不会重复使用它。我的页面上有 3 个 div 将使用颜色，所以我想要可能的 7 种颜色中的 3 种不同颜色。

我如何使用它的完整代码：

```
<div id="featured-posts" class="container_12">
<?php
 global $post;
 $myposts = get_posts('numberposts=3&category=12');
 foreach($myposts as $post) :
 ?>

 <?php global $post; ?>
    <?php
    $src = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), array( 5600,1000 ), false, '' );
    ?>

        <?php
            $colors = array("#000000", "#949c51", "#571c1e", "#f36533", "#782a80", "#f6a41d", "#ed1b24");
            $randomColor = $colors[array_rand($colors)];
        ?>

<a href="<?php the_permalink(); ?>">
<div class="grid_4 featured-home" style="background: url(<?php echo $src[0]; ?> ) !important;">
    <div class="featured-details" style="border-color: <?php echo $randomColor; ?>;">   
        <h4 style="color: <?php echo $randomColor; ?>;"><?php the_title(); ?></h4>
        <p><?php the_excerpt(); ?>  <q style="color: <?php echo $randomColor; ?>; font-weight:bold !important;">Read more &gt;</q></p>
    </div>
    <div class="featured-lower" style="border-color: <?php echo $randomColor; ?>;"></div>
</div></a>
 <?php endforeach; ?>
 </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T00:15:51.963

您可以[洗牌](http://php.net/manual/en/function.shuffle.php)，然后每次从数组中[弹出最后一个元素：](http://php.net/manual/en/function.array-pop.php)

定义你的颜色数组一次（这需要从你的循环中删除）：

```
$colors = array("#000000", "#949c51", "#571c1e", "#f36533", "#782a80", "#f6a41d", "#ed1b24"); 
```

然后每次使用 randomColor 时，都会对其进行洗牌并删除要使用的数组的最后一个元素：

```
shuffle($colors);
$randomColor = array_pop($colors); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:07:42.340

您必须添加一个函数，其中从数组中选择随机颜色，从数组中删除并返回。然后你必须在你的内联样式设置上调用这个函数。

但是你真的应该避免使用内联样式。[你也可以用更简洁的方式用SASS](http://sass-lang.com/)做这样的事情。

# google-app-engine - 如何让自定义 ndb.Model 方法工作（GAE 和 Python）

> ID：13693964
> 
> 赞同：2
> 
> 时间：2012-12-04T00:00:13.887
> 
> 标签：google-app-engine, model, python-2.7

为什么以下示例都不起作用？

```
class Person(ndb.Model):
   first_name = ndb.StringProperty()
   last_name = ndb.StringProperty()
   city = ndb.StringProperty()
   birth_year = ndb.IntegerProperty()
   height = ndb.IntegerProperty()

  @classmethod
  def get_person(self, _last_name, _max_height):
     a_person = Person.query(
           ndb.AND(
              Person.last_name == _last_name,
              Person. height == _max_height
       ))
      return a_person 
```

另一个示例替换`Person`为`self`：

```
@classmethod
  def get_person(self, _last_name, _max_height):
     a_person = self.query(
           ndb.AND(
              self.last_name == _last_name,
              self. height == _max_height
       ))
      return a_person 
```

所以基本上我希望能够调用该`get_person`方法`last_name`并`max_height`让它返回一个人（假设只有一个匹配项）。我该如何做到这一点？

调用类/对象有以下几行：

```
my_person = Person.get_person('Doe',7)
if my_person.first_name is None:
   my_person.first_name = 'John' 
```

但是代码失败说`my_person`没有属性`first_name`（或我尝试的任何其他属性）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T01:06:04.733

以下作品：

```
@classmethod
def get_person(self, _last_name, _max_height):
 a_person = Person.query(
       ndb.AND(
          Person.last_name == _last_name,
          Person. height == _max_height
   ))
  return a_person.get() 
```

# neural-network - 神经网络 - 为每个小批量选择数据

> ID：13693966
> 
> 赞同：7
> 
> 时间：2012-12-04T00:00:44.820
> 
> 标签：neural-network

可能是关于最小批处理的 ANN 101 问题。谷歌似乎没有答案。在这里搜索也没有产生任何结果。我的猜测是某处有一本书说，“这样做！” 我只是没读过那本书。

我正在用 Python 编写一个神经网络（语言并不重要）。我正在尝试添加小批量更新而不是完整批量。是否有必要为每个时期选择一次观察？小批量将是数据值 1:10、11:20、21:30 等，以便使用所有观察值，并且它们都使用一次。

或者根据概率从训练数据集中随机选择小批量是否正确？结果是每个观察在任何给定的时期都可以使用一次、多次或根本不使用。对于每个 epoch 的 20 个 mini-batch，每个数据元素将有 5% 的机会被选择用于任何给定的 mini-batch。小批量将随机选择且大小随机，但每 20 个数据点中大约有 1 个数据点将包含在 20 个小批量的每一个中，不能保证选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T23:15:52.780

关于小批量训练的一些提示：

**在每个时代之前洗牌你的样本**

原因与您在在线训练中打乱样本的原因相同：否则网络可能会简单地记住您提供样本的顺序。

**为每个批次和每个时期使用固定的批次大小**

可能还有一个统计原因，但它简化了实现，因为它使您能够使用矩阵乘法的快速实现来进行计算。（例如 BLAS）

**使您的学习率适应批量大小**

对于较大的批次，您必须使用较小的学习率，否则 ANN 往往会收敛到次优最小值。我总是将我的学习率按 1/sqrt(n) 缩放，其中 n 是批量大小。请注意，这只是实验的经验值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T02:34:52.210

你的第一个猜测是正确的。只需先随机化您的数据集。然后（比如说）20 个小批量。使用：1-20，然后是 21-40，等等……所以，你所有的数据集都将被使用。

Ben不要说数据集只使用一次。您通常需要在所有数据集上执行多个 epoch 才能让您的网络正确学习。

小批量主要用于加速学习过程。

# jquery - 响应式缩略图模态框

> ID：13693968
> 
> 赞同：0
> 
> 时间：2012-12-04T00:01:07.347
> 
> 标签：jquery, html, css

有人可以帮我让“响应式缩略图模式框”工作吗？

```
Code so far: 
```

[http://jsfiddle.net/YCcNY/1/](http://jsfiddle.net/YCcNY/1/)

它应该有：

*   2行，每行5张

*   动态高度：自动

*   宽度：屏幕的 75%

*   始终停留在屏幕的绝对中心

*   调整大小时保持纵横比（响应式）

我会很感激只使用 css 的方式，但 jquery 也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:37:31.540

对基本结构进行了一些快速更改，以使您开始走上正轨。

```
Code: 
```

[http://jsfiddle.net/purplenurple/YCcNY/29/](http://jsfiddle.net/purplenurple/YCcNY/29/)

有很多不必要的 CSS。始终注意不要使事情过于复杂。CSS 有时就是这样，你认为你需要添加一些东西来解决问题，但实际上你需要删除最初并不明显的问题。

注意：没有 JavaScript 就不可能垂直居中，因为模态框和它的容器都没有固定的高度。您必须通过脚本获取高度并相应地设置框的位置。

我没有为您实现任何 JavaScript，因为 StackOverflow 的目的不是外包您的工作，而是帮助您自己找到解决方案:)

希望这可以帮助您回到正轨。

# javascript - 重复侦听器激活 javascript

> ID：13693973
> 
> 赞同：0
> 
> 时间：2012-12-04T00:02:02.263
> 
> 标签：javascript, jquery, events, listeners

如果以下任何一个监听器被激活，它们将被激活 2^x 次，x 是其中任何一个被触发的次数。第一次它将运行 2 次，十次 4、8、16 等。我错过了什么不止一次触发它们？

```
$(document).on('click',"#post-ride",(function() {
  addRide(currentDriver, $(destinationInput).val(), $(originInput).val(),$(dateInput).val(), $(timeInput).val());
  console.log("add ride called");
$.getScript("scripts/myRides.js", function() {
});
}));

$(document).on('click',"#request-ride",(function() {
  requestRide(currentDriver, $(destinationInput).val(), $(originInput).val(),            $(dateInput).val(), $(timeInput).val());
$.getScript("scripts/myRides.js", function() {   
});
}));

$(document).on('click',"#leave-ride",(function() {
leaveRide(currentDriver, $(this).closest('div').attr('id') );
$.getScript("scripts/myRides.js", function() {
});
console.log("leave ride called");
}));

$(document).on('click',"#cancel-ride",(function() {
cancelRide(currentDriver, $(this).closest('div').attr('id') );
$.getScript("scripts/myRides.js", function() {
});
}));

$(document).on('click',"#remove-friend",(function() {
removeFriend(currentDriver, $(this).closest('div').attr('id') );
$.getScript("scripts/friends.js", function() {
});
}));

$(document).on('click',"#add-friend",(function() {
addFriend(currentDriver, $(this).closest('div').attr('id') );
$.getScript("scripts/friends.js", function() {
});
})); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:07:31.203

据推测，每次加载时，其中一个或两个都会添加重复的事件侦听器 `myRides.js`。`friends.js`

要问的合乎逻辑的问题是你为什么一遍又一遍地加载相同的脚本？你可能不应该那样做。

如果您要执行该脚本中的一个函数，您可以测试该函数是否已加载，如果是，则调用它。如果没有，则加载脚本并让它在加载时执行。

如果您一遍又一遍地加载相同的脚本还有其他原因，那么您可以通过跟踪您是否已将每个事件侦听器加载到它自己的状态变量中来保护每个事件侦听器免于安装后续副本，尽管这是可能是解决问题的更乏味的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:05:20.663

每次“getScript”时都会添加新的处理程序

# sql - 如何使用 SSIS 将 NTEXT 值转换为 BOOLEAN

> ID：13693974
> 
> 赞同：0
> 
> 时间：2012-12-04T00:02:25.477
> 
> 标签：sql, tsql, ssis, sql-server-2008-r2

我正在使用 SSIS 将 SalesForce 数据导入 SQL Server。在 SF 中，我有包含诸如“Live/Not Live”之类的值的 ntext 文件，这些值可以通过 SQL Server 中的位文件轻松解释。

有没有办法使用 SSIS 将这些 ntext 字段转换为布尔值。我尝试使用派生列转换并得到以下错误：

> [插入目标 [807]] 错误：SSIS 错误代码 DTS_E_OLEDBERROR。
> 发生 OLE DB 错误。错误代码：0x80040E21。OLE DB 记录可用。来源：“Microsoft SQL Server Native Client 10.0” Hresult：0x80040E21 描述：“多步 OLE DB 操作产生错误。检查每个 OLE DB 状态值（如果可用）。没有完成任何工作。”。
> 
> [插入目标 [807]] 错误：SSIS 错误代码 DTS_E_INDUCEDTRANSFORMFAILUREONERROR。“输入“OLE DB 目标输入”(820)”失败，因为发生错误代码 0xC020907B，并且“输入“OLE DB 目标输入”(820)”上的错误行处理指定错误失败。指定组件的指定对象发生错误。在此之前可能会发布错误消息，其中包含有关失败的更多信息。
> 
> [SSIS.Pipeline] 错误：SSIS 错误代码 DTS_E_PROCESSINPUTFAILED。处理输入“OLE DB 目标输入”(820) 时，组件“插入目标”(807) 上的 ProcessInput 方法失败，错误代码为 0xC0209029。

已识别的组件从 ProcessInput 方法返回错误。该错误是特定于组件的，但该错误是致命的，将导致数据流任务停止运行。在此之前可能会发布错误消息，其中包含有关失败的更多信息。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T00:53:13.687

NTEXT 是您的 unicode 文本流。你不能对流做很多事情，所以我们需要把它变成更易于管理的东西，比如 DT_STR 或 DT_WSTR。您的文本数据是否具有国际化只有您自己知道。无论哪种方式，将[数据转换转换](http://msdn.microsoft.com/en-us/library/ms141706.aspx)连接到您的 SF 源，并使该数据成为非流类型（给它一个最大宽度）。此操作的目标是获取流数据并将其转换为纯文本值（Live，Not Live）。我假设此列将被调用`IsLiveString`

现在您正在处理字符串类型，请将派生列转换添加到转换输出，这里您需要一个表达式来确定数据转换任务提供的值是否计算为真/假。即使 SQL Server 理解`Live`转换为 1（真），我也没有办法永远依赖这种魔法。相反，我希望创建一个新列 IsLiveBoolean 并且它的表达式类似于`([IsLiveString]=="Live") ? True : False`That expression isapproximate，我没有坐在 SSDT/BIDS 的实例中。它也可以通过消除代替相等检查的三元表达式来简化。如果您需要处理 IsLiveString 列中的 NULL 值，则三元运算符语法使评估更容易。

## 编辑

一张图片值一千字，所以考虑一下这个 3k 和一些变化。这代表数据流中的操作。我使用了一个简单的查询来 POC 您的示例。我生成了一个数据类型为 ntext 的列，其值为“Live”和“Not Live”以及一个 NULL。从源头上，我使用如上所述的数据转换任务。我与 DT_WSTR 一起使这个答案适用于尽可能广泛的受众，并将长度保留为默认值 50。为了优化内存使用，您希望减少长度以匹配源系统中最长的可能值。

![数据流](../Images/5e7b9bf25ef457233d895aa5f0fab2b3.png)

我因此配置了我的派生列转换。有用于处理 NULL 的选项，或者如果您知道您的数据是 NULL 免费的，那么第一个将起作用。

![派生列变换](../Images/b29775799a985db4d4fcca0f88c6a862.png)

结果。您可以观察到这正确地将字符串转换为相应的布尔对应项。然后这些将通过管道传输到您的目标组件中。

![在此处输入图像描述](../Images/66843699fd0540c66ed0964810e1eb92.png)

# mdx - 每天在 Mondrian MDX 中获取用户数量

> ID：13693976
> 
> 赞同：2
> 
> 时间：2012-12-04T00:03:39.547
> 
> 标签：mdx, olap, data-warehouse, pentaho, mondrian

我正在尝试编写一个查询来给我每天每个客户的用户总数。

这是我到目前为止所拥有的，对于每个客户/天组合，它给出了用户维度条目的总数，而不是按客户/天拆分它们。

```
WITH MEMBER [Measures].[MyUserCount]
  AS COUNT(Descendants([User].CurrentMember, [User].[User Name]), INCLUDEEMPTY)
SELECT
  NON EMPTY CrossJoin([Date].[Date].Members, [Customer].[Customer Name].Members) ON ROWS,
  {[Measures].[MyUserCount]} on COLUMNS
FROM
  [Users] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T05:02:35.860

您计算的成员的问题在于，`[User].CurrentMember`它设置`All`为每个行元组的成员，因此计数是总数。您需要的是一种`[Customer].CurrentMember`有效`[Date].CurrentMember`过滤`[User]`维度的方法。

您需要使用有意义的度量，即对于您感兴趣的维度成员的有意义连接，该度量将具有非空值。

要找出这一点，您可以从运行如下查询开始：

```
SELECT
  NON EMPTY CrossJoin(
    [User].[User Name].Members, 
    [Measures].[Some measuse]
  ) ON COLUMNS,
  NON EMPTY CrossJoin(
    [Date].[Date].Members, 
    [Customer].[Customer Name].Members
  ) ON ROWS
FROM [Project] 
```

你会选择`Some measure`得当。该查询的结果将是很多空单元格，但在给定的行中，具有值的列对应于与给定 Customer x Date 元组（在行上）相关的用户。您想为每一行计算这些列。COUNT 和 FILTER 是你需要的，那么计算成员的查询将是

```
WITH MEMBER [Measures].[User count] AS
  COUNT(
    FILTER(
      [User].[User Name].Members, 
      NOT ISEMPTY([Measures].[Some measure])
    )
  )
SELECT
  NON EMPTY {[Measures].[User count]} ON COLUMNS,
  NON EMPTY CrossJoin(
    [Date].[Date].Members, 
    [Customer].[Customer Name].Members
  ) ON ROWS
FROM [Users] 
```

我在这里假设了一点，但是通过一些实验你应该能够解决它。

# php - LESS CSS & Symfony - 动态更新配色方案

> ID：13693981
> 
> 赞同：1
> 
> 时间：2012-12-04T00:04:04.847
> 
> 标签：php, css, symfony1, symfony-1.4, less

我正在使用 Symfony 1.4，并且在使用 LESS CSS 预处理器时遇到了一些问题。

假设我有 2 个带有颜色特定变量的 Less 文件。它们被称为`blue.less`和`red.less`。

他们来了：

**无蓝**

```
@mainBorder: blue;
@pulldownBackground: blue; 
```

**红色.less**

```
@mainBorder: red;
@pulldownBackground: red; 
```

现在假设我有一个**layout.less**文件，看起来像这样：

```
// Colored line under Nav
.main {
    border: 1px solid @mainBorder;
    .pullDown { background: @pullDownBackground; }
} 
```

如果我想使用其中一个颜色变量文件，我需要在**layout.less**文件的顶部声明它，如下所示：

```
@import 'red.less'; 
```

由于该语句必须引用特定文件，所以每当我想更改配色方案时，我`@import`如何能够动态传递给 @import 语句？`blue.less`

**有没有办法使用 PHP 和 Symfony 框架动态声明哪些颜色特定的 LESS 文件将传递给该导入语句？**

或者这个问题可以在没有服务器端代码的情况下解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T15:52:50.673

我从未使用过 Symphony，但这应该让您朝着正确的方向前进，而不管框架如何。

首先，您要创建 LESS 文件：

```
<?php
$color_scheme = "red"; // we're simplifying here for now, but this could be set via $_POST variable

/*
    it would probably be a good idea to check if the file exists first before we import it.
    see function: file_exists()
*/

$contents = "
@import '$color_scheme.less';
@import 'main_styles.less';
@import 'other_stuff.less';
";

file_put_contents("path/to/styles.less");
?> 
```

现在您有一个准备好处理的 LESS 文件，就像您手动编写它一样，但颜色方案很容易交换。如果我使用纯 PHP 执行此操作，我将使用该`exec()`函数来调用可通过命令行使用的命令。这是通过调用 SASS 的示例`exec()`（我从未以这种方式使用过 LESS，因此您必须在此处填写空白）。

```
<?php
exec("sass --compile path/to/sass:path/to/public/css");
?> 
```

如果您的 Symphony 插件无需使用 exec/命令行即可为您进行编译，那么您可能希望这样做。

# cakephp - CakePHP：authErrors，仅在 Safari 中

> ID：13693983
> 
> 赞同：0
> 
> 时间：2012-12-04T00:04:09.220
> 
> 标签：cakephp, safari

所以我将 checkAgent 设置为 false，但我仍然在 Safari 中收到有关允许操作的 authError。在其他浏览器中一切正常。

该错误似乎总是发生在使用大量 JS 和一些 AJAX 的页面上。这可能是什么原因造成的？

# java - 无法将组件添加到扩展 JFrame 的类

> ID：13693985
> 
> 赞同：0
> 
> 时间：2012-12-04T00:05:06.803
> 
> 标签：java, swing, graphics, components, conways-game-of-life

我正在尝试写人生的游戏。但是，无论我多么努力，我似乎​​都无法使用按钮将 Cell 组件添加到框架上。如果我制作一个新框架并添加它们，它们确实会出现，但即便如此，我似乎无法添加多个组件。

那么我如何将组件添加到框架中，上面有所有的东西，以及如何添加多个组件？谢谢！

这是我的代码：

```
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;

import java.awt.Color;
import java.awt.Component;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

public class Visuals extends JFrame implements ActionListener{ 

    private static Board b;
    private GameOfLife g;
    private JButton nextGen;
    private JButton random;

    public Visuals(Board b){
        super("The Game of Life");
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel panel=new JPanel();
        nextGen = new JButton("Next Generation");
        panel.add(nextGen);
        nextGen.addActionListener(this);

        random = new JButton("Random");
        panel.add(random);
        random.addActionListener(this);
        this.add(panel);

        this.setSize(800, 700);
        this.setVisible(true);

        /*for(int i=0, yShift=80; i<b.getRow(); i++, yShift+=20){
            for (int j=0, xShift=30; j<b.getCol(); j++, xShift+=20){
                Cell c= new Cell(xShift,yShift,i,j);
                this.add(c);
            }
        }*/
        Cell c= new Cell(100,100,1,1);
        Cell d= new Cell(200,200,1,1);
        this.add(c);
        this.add(d);

        JFrame frame=new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(800, 700);
        frame.setVisible(true);

        frame.add(c);
        frame.add(d);

    }

    public void paint(Graphics g){
        super.paint(g);
        for(int i=0, yShift=80; i<b.getRow(); i++, yShift+=20){
            for (int j=0, xShift=30; j<b.getCol(); j++, xShift+=20){    
                if(b.getSpot(i, j)==1){
                    g.setColor(Color.red);
                    g.fillRect(xShift, yShift, 10, 10);
                }
                else{
                    g.setColor(Color.white);
                    g.fillRect(xShift, yShift, 10, 10);
                }
            }   
        }
    }   

    public static void main(String[] cnbe){
        b= new Board (30,30);
        Visuals v = new Visuals(b);
    }

    public void actionPerformed(ActionEvent event) {
        Object cause = event.getSource();
        if(cause == nextGen){
            GameOfLife g=new GameOfLife(b);
            g.nextGeneration();
            System.out.println(g);
            this.repaint();
        }
        if(cause == random){
            GameOfLife g=new GameOfLife(b);
            g.random();
            System.out.println(g);
            this.repaint();
        }   
    }

    public class Cell extends JComponent{
        int row;
        int col;
        int x;
        int y;
        Rectangle r;

        public Cell(int x, int y, int row, int col){
            r= new Rectangle(x,y,10,10);
                this.row=row;
                this.col=col;
                this.x=x;
                this.y=y;

        }   

        public void paintComponent(Graphics g) {
            super.paintComponent(g);

            g.drawString("DRAW ME",200,200);
            Graphics2D g2= (Graphics2D) g;
            g2.setColor(Color.green);
            r= new Rectangle(x,y,100,100);
            g2.fill(r);

            /*if(b.getSpot(row, col)==1){

                g.setColor(Color.red);
                g.fillRect(x, y, 10, 10);
            }
            else{

                g.setColor(Color.white);
                g.fillRect(x, y, 10, 10);
            }*/
        }

        class MousePressListener implements MouseListener{

            public void mousePressed(MouseEvent event) {
                /*int x= event.getX();
                int y= event.getY();
                if(x>r.getX() && x<r.getX()+10 && y>r.getY() && y<r.getY()+10){
                    if(b.getSpot(row, col)==1){
                        b.setSpot(row, col, 0);
                        repaint();
                    }
                    else{
                        b.setSpot(row, col, 1);
                        repaint();
                    }
                }*/
            }

            public void mouseReleased(MouseEvent arg0) {
            }
            public void mouseClicked(MouseEvent arg0) {
            }
            public void mouseEntered(MouseEvent arg0) {
            }
            public void mouseExited(MouseEvent arg0) {
            }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T12:34:17.913

您对布局管理器有疑问。每次向 JFrame 添加组件时，都会覆盖已经存在的内容。我对 Game of Life 不太熟悉，但我认为您不希望您的单元格成为 JComponents。您可以将您的板表示为一个布尔数组，表示活动和死亡状态，因此您的 Visual 构造函数变为：

```
public Visuals(Board b) {
    super("The Game of Life");
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    Container container = getContentPane(); // 1
    JPanel panel = new JPanel(new FlowLayout()); // 2
    nextGen = new JButton("Next Generation");
    panel.add(nextGen);
    nextGen.addActionListener(this);

    random = new JButton("Random");
    panel.add(random);
    random.addActionListener(this);
    container.add(panel); // 3

    setSize(800, 700);
    setVisible(true);

} 
```

在您的 Board 类中，您可以将板表示为一个数组：

```
public class Board{
    private boolean[][] board;

    public Board(int x, int y) {

        board = new boolean[x][y];
    }
} 
```

然后在`nextGeneration`您的 GameOfLife 类的方法中，执行您正在执行的任何计算并设置棋盘上位置的真/假（或活/死）状态。

然后，您的 Visuals.paint 方法将变为：

```
public void paint(Graphics g) {
    super.paint(g);
    for (int i = 0, yShift = 80; i < b.getRow(); i++, yShift += 20) {
        for (int j = 0, xShift = 30; j < b.getCol(); j++, xShift += 20) {
            if (b.isAlive(i, j)) {
                g.setColor(Color.red);
                g.fillRect(xShift, yShift, 10, 10);
            } else {
                g.setColor(Color.white);
                g.fillRect(xShift, yShift, 10, 10);
            }
        }
    }
} 
```

`iaAlive`只是返回该位置的板数组的值：

```
public boolean isAlive(int i, int j) {
    return board[i][j];
} 
```

但就像我说的，我不熟悉这个游戏。

# groovy - 如何在 POI/ExcelBuilder 中按列名访问带有空格的 Excel 单元格

> ID：13693998
> 
> 赞同：0
> 
> 时间：2012-12-04T00:05:52.107
> 
> 标签：groovy, apache-poi, builder

感谢[http://www.technipelago.se/content/technipelago/blog/44](http://www.technipelago.se/content/technipelago/blog/44) 可以通过行迭代器和列名访问 excel 单元格。但似乎无法通过名称包含空格的列名进行访问。请给我一些关于如何在 ExcelBulider 上下文中通过带有空格的偶数名称访问单元格的指示。以下是用于说明的示例：

```
new ExcelBuilder("customers.xls").eachLine([labels:true]) {
    print firsname // this already possible
    print <a column name with space> // I wish to have
} 
```

`firstname`列名在哪里。我希望可以使用空格访问另一列名称。

我可以使用字典来封装从列名到列 inedx 的映射，以在 ExcelBuilder 之外实现按列访问的逻辑，但我希望它更多地封装在 ExcelBuilder 中的一个地方/逻辑中。

也许，我对 POI 和 Groovy 的 builder 技术还没有足够的了解。

请帮忙！

谢谢，

于

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:36:19.427

这应该有效：

```
new ExcelBuilder("customers.xls").eachLine([labels:true]) {
    print firsname
    print delegate.'a column name with space'
} 
```