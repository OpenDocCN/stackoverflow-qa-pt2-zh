# StackOverflow 问答 15456000-15456999

# java - 硒Java。通过 linkText 问题导航 WebElement

> ID：15456009
> 
> 赞同：2
> 
> 时间：2013-03-16T23:37:41.857
> 
> 标签：java, selenium

我正在运行 Selenium 测试。我有需要点击的链接。我做了很多链接，但是这个不允许我点击它......但是，当我手动完成它时它工作得非常好！这是它的链接元素的html：

```
 <a href="form_general_power.asp" onclick="resetSearch();" target="mainFrame">Advanced Search</a> 
```

我尝试了以下每一项

```
WebElement element = driver.findElement(By.xpath("//a [@href='form_general_power.asp']"));
 WebElement element = driver.findElement(By.xpath("//a [@onclick='resetSearch();']"));
 WebElement element = driver.findElement(By.xpath("//a [@target='mainFrame']"));
 WebElement element = driver.findElement(By.linkText("Advanced Search"));

element.click(); 
```

有没有其他处理链接的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T01:22:37.580

您也可以尝试使用 css 选择器。

```
WebElement element = driver.findElement(By.cssSelector("/...")); 
```

linkText 的问题是有时不是响应式 element.click();

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T05:15:05.613

尝试

```
WebElement element = driver.findElement(By.xpath("//a[text()=\"Advanced Search\"]"));
element.click(); 
```

请注意，xpath 中没有空格，就像您在示例中那样。

# prolog - 在处理列表时，Prolog 中的“-”符号是什么意思？

> ID：15456014
> 
> 赞同：9
> 
> 时间：2013-03-16T23:38:57.027
> 
> 标签：prolog, dcg, prolog-cut, difference-lists

我正在阅读[这个](https://stackoverflow.com/questions/9759264/how-to-read-an-array-list-print-it-in-prolog)问题的答案，

```
p(X) :- read(A), q(A,X-[]).

q(end,X-X) :- !.    
q(A,[A|X]-Y) :- read(B), q(B,X-Y). 
```

上面的代码使用语法**List-List**。我有点理解发生了什么，但我想知道“-”符号/谓词在这里究竟做了什么。另外，这个 SWI 是特定的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T00:40:24.440

`(-)/2`表示差异列表是一个相当不常见的约定。在较旧的书中，`(\)/2`也使用了另一个运算符。

许多人更喜欢使用两个单独的参数。与使用运算符相比，有几个优点：

1.  谓词不能意外地与参数的未实例化变量一起使用。考虑调用`q(A, X)`代替`q(A, X-[])`.

2.  使用两个参数时，执行效率甚至更高。许多系统，如 SWI，必须`(-)/2`动态创建每个结构。

不过，还有另一种使用差异列表的方法，这种方法通常不太容易出错：您可以为此目的使用[dcg 。](/questions/tagged/dcg "显示标记为“dcg”的问题")

实际上，程序有两个错误，其中一个是差异列表的处理方式造成的。另一个错误是程序不处理文件结尾。`end_of_file`代替.使用会更好`end`。但这是一件肤浅的事情，你迟早会发现自己。

另一个更细微的错误是由于差异列表和剪辑之间的相互作用造成的。我不是削减的忠实粉丝，但让我们看看这条规则。在其左侧的所有内容都已执行后进行剪切。

```
q(end_of_file,X-X) :- !. 
```

第一个参数是 atom `end_of_file`。由于我们`q/2`只使用作为第一个参数的结果`read/1`，这只能是一个比较。所以我们在文件（或流）的末尾。然而，还有更多的事情必须坚持。只有当它们也成功时，才会执行剪切：第二个参数必须是 a `(-)/2`（好吧，在所有地方都有一个减号）。然后： 的两个参数`(-)/2`必须相同（必须统一）。为什么？我们在文件的末尾，但如果这些参数不统一，将尝试另一个规则。

这什么时候发生？这是一个令人讨厌的案例：

```
p([X,Y,Z]). 
```

只需输入一个常数，比如说`my_constant.`然后按`Cntrl-d`或`Cntrl+z`。`p/1`在这种情况下应该怎么办？理想情况下，它会在您完成输入后失败。但是，它将等待进一步的输入。

原因是切口放置不当。`p/1`我们说不**坚定**。这是 Prolog 程序中的常见错误。我只能建议减少削减的使用和 DCG 的采用。使用 DCG，这不会发生：

```
p2(X) :- read(A), phrase(q2(A),X).

q2(end_of_file) --> !.
q2(A) --> [A], {read(B)}, q2(B). 
```

对于 DCG，无论 的参数如何，都会执行剪切`p/1`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T00:02:36.360

我以为你的意思是:-。

这是一个差异列表。

[http://en.wikibooks.org/wiki/Prolog/Difference_Lists](http://en.wikibooks.org/wiki/Prolog/Difference_Lists)

# vb.net - 如何使 vb 显示（最大化）另一个进程（窗口）

> ID：15456015
> 
> 赞同：0
> 
> 时间：2013-03-16T23:39:22.037
> 
> 标签：vb.net

我有另一个程序正在运行，它的进程名称是`met2.exe`. 如何让另一个程序最大化`met2.exe`并在开始栏中保持打开状态？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T00:11:03.487

尝试使用[GetProcessesByName](http://msdn.microsoft.com/en-us/library/z3w4xdc9.aspx)

```
Private Declare Function ShowWindow Lib "user32" (ByVal handle As IntPtr, ByVal nCmdShow As Integer) As Integer
Sub ShowAppWindow()
    Try
        Dim localByName As Process() = Process.GetProcessesByName("met2")
        For Each p As Process In localByName
            ShowWindow(p.MainWindowHandle, 3) ' SW_MAXIMIZE
        Next
    Catch ex As Exception
        ' do something
    End Try
End Sub 
```

# java - 实现哈希图的数组列表

> ID：15456018
> 
> 赞同：0
> 
> 时间：2013-03-16T23:39:34.740
> 
> 标签：java, arraylist, hashmap

这更像是实现 [一个包含 k = Date object v = 一个数组的哈希映射的](https://stackoverflow.com/questions/15455311/implement-a-hash-map-that-takes-in-k-date-object-v-an-array)**后续问题** 我 正在用 Java 编写代码. 现在我想使用这个哈希图的多个实例。由于我的项目涉及主题公园数据，因此每个景点都会有一个哈希图。那么我将如何实现哈希映射的数组列表。跟踪 20 个景点？如果有人可以向我展示一个初始化所有内容的示例设置代码，那将很有帮助。

谢谢，

# jquery - 无法通过 jquery .attr 为 flowplayer 设置 src

> ID：15456019
> 
> 赞同：0
> 
> 时间：2013-03-16T23:39:35.340
> 
> 标签：jquery, ajax, flowplayer

我通过 rest 请求一个安全链接并将其插入 flowplayer。

```
<script type="text/javascript">
$(document).ready(function(){
       $.get('rest/movies/1/getmovie', function(data) {
                $('source').attr('src',data);
    });
});
</script>

<div class="flowplayer" data-swf="flowplayer.swf" data-ratio="0.417">
      <video>
         <source type="video/mp4" src=""/>
      </video> 
```

控制台显示：

```
<div class="flowplayer is-loading is-mouseover" data-swf="flowplayer.swf" data-ratio="0.417">
  <video class="fp-engine">
     <source type="video/mp4" src="*url*/video/4d90d2bb6bjj84dbf8ccjbfb38778987/514500bb/video.mp4">
  </video> 
```

flowplayer 将保持白色，视频不会显示。这是一个有效的 url，当我直接将 url 输入到 src 属性时，我可以访问视频。

知道如何解决这个问题吗？

编辑：控制台显示根本没有到视频服务器的连接请求。

编辑2：

我将代码编辑为：

```
<script type="text/javascript">
$(document).ready(function(){
       $.get('rest/movies/1/getmovie', function(data) {

           $('.flowplayer video').load(data);

           });
});
</script> 
```

铬返回：

```
XMLHttpRequest cannot load 
*url*27c87a2a56e117acf25a7bb1182e122b/5145219f/video.mp4\. Origin localhost:8080 is not allowed by Access-Control-Allow-Origin. 
```

# r - 试图删除 ggplot2 可视化的边距

> ID：15456020
> 
> 赞同：3
> 
> 时间：2013-03-16T23:40:27.867
> 
> 标签：r, ggplot2

该功能`scale_y_continuous(expand=c(0,0))`给了我错误：

```
Error: Discrete value supplied to continuous scale 
```

我真的不明白这是什么意思。该函数被调用`scale_y_continuous`，而不是`scale_y_discrete`。[这是我的数据](http://share.kevin-funk.com/Retail_Gas_Prices.csv)。

```
require(ggplot2)  # ggplot
gp <- read.csv("Retail_Gas_Prices.csv")
gp$Date <- as.Date(substr(gp$Date, 1, 10), "%m/%d/%Y")
gp_melted <- melt(gp, id = "Date")

gas_ml_plot <- ggplot(subset(gp_melted, variable != "Weekly.US"), 
               aes(Date, value, colour = variable)) + 
               geom_line() + ggtitle("Retail Gas Prices In The US") + 
               theme(axis.title.x = element_blank()) +
               ylab("Cost in Dollars") + 
               theme(axis.ticks = element_blank()) + 
               labs(colour = "US Region") + 
               scale_color_discrete(labels = c("East Coast", "Midwest", 
               "Gulf Coast", "Rocky Mountain", "West Coast")) + 
               theme(legend.background = element_blank()) + 
               theme(legend.position = c(0, 1)) + 
               theme(legend.justification = c(0, 1)) + 
               scale_y_continuous(expand = c(0, 0)) + 
               scale_x_discrete(expand = c(0, 0)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T23:54:55.377

错误消息是错误的，因为问题是 Date 对象被传递给离散的 x 比例，**而不是**离散值被提供给连续比例。解决方案是使用正确的 x 比例；由于 x 变量是一个日期，请使用`scale_x_date(expand = c(0, 0))`.`scale_x_discrete(expand = c(0, 0))`

我已在[https://github.com/hadley/ggplot2/issues/783提交了描述此问题的错误报告](https://github.com/hadley/ggplot2/issues/783)

# php - 是否可以在 2 秒内向 Google API 发送超过 1 个请求？

> ID：15456029
> 
> 赞同：0
> 
> 时间：2013-03-16T23:41:38.113
> 
> 标签：php, google-places-api

首先，我向 Google API 发送一个文本搜索请求以获取搜索结果。我得到 20 个结果和一个令牌来获取下一页的 20 个结果。

当我向 Google API 发送下一个请求以获取下一个 20 个结果时，如果我的 PHP 至少 2 秒不休眠，它将无法工作。

我该如何解决这个问题以减少我的 Web 应用程序延迟？

附加细节：我使用免费版的 Google API。

这是我发送查询太快时遇到的错误：

```
<PlaceSearchResponse>
  <status>INVALID_REQUEST</status>
</PlaceSearchResponse> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T23:45:30.067

您的代码不符合 API 要求。API 文档 100% 明确指出，检索下一页的尝试**必须**由**用户**操作触发。服务器故意限制您，如果您继续这样做，您将获得个人联系。

Google Maps API 和 Google Places API 产品经理 Thor Mitchell 说：

> 关键是*对另一页结果的请求必须由某种形式的用户操作触发*。不允许在服务器端预加载所有 60 个结果并将它们一次全部呈现给用户。我们将监控请求模式以识别执行此操作的应用程序，并联系开发人员让他们知道这是不允许的，他们必须相应地更新他们的应用程序。

# postgresql - 从 MyBatis 返回值 映射方法

> ID：15456033
> 
> 赞同：20
> 
> 时间：2013-03-16T23:43:04.800
> 
> 标签：postgresql, mybatis

我有一个使用 MyBatis 访问 PostgreSQL 数据库的 Java 项目。PostgreSQL 允许在语句之后返回新创建的行的字段`INSERT`，我想用它来返回自动生成`BIGSERIAL` `id`的新创建的记录。因此，我`insert`将 XML 中的命令更改为使用 PostgreSQL 的`resultType="long"`特性，为标签添加一个属性`<insert>`，并在映射器的 Java 接口中将插入方法设置为 return`long`而不是`void`.

当我尝试运行它时，我得到一个`org.xml.sax.SAXParseException`说法`Attribute "resultType" must be declared for element type "insert"`。

现在，当我将`<insert>`标签更改为`<select>`一切正常时，我使用`<select>`标签来执行`INSERT`语句让我很困扰。

有没有办法让映射到`<insert>`标签的方法返回结果，或者 MyBatis 不是为此而设计的，我应该将它们保留为`<select>`标签？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-18T09:49:59.520

映射插入方法的返回类型可以是`void`或`int`（在这种情况下，它将返回插入行的编号）。您可以执行以下机制来返回生成的 id：

```
<insert id="insert" parameterClass="MyParameter">
  <selectKey order="AFTER" keyProperty="id" resultType="long">
    SELECT currval('my_seq')
  </selectKey>
  INSERT INTO mytable(col1, col2) VALUES (#{val1}, #{val2})
</insert> 
```

这会将生成的`id`列设置`id`为参数类的属性。之后，您作为参数传递的对象将`id`在其属性中生成集合。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-19T19:35:29.387

您可以如下使用。在xml中

```
 <insert id="insertNewUser" parameterType="User">
            <selectKey keyProperty="userId" resultType="Integer" order="BEFORE">
                select NEXTVAL('base.user_id_seq')
            </selectKey>
            INSERT INTO base.user(
                user_id, user_name)
            VALUES (#{userId}, #{userName});
    </insert> 
```

在您调用插入方法的 Java 类中，您可以通过调用`user.getUserId()`.

基本上下一个 val 存储在对象的变量中。`Here userId inside User.`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-09-20T09:55:39.287

有两种方法（至少我知道）来获取一个插入记录的 ID：

例如，我们有一个类`EntityDao`：

```
public class EntityDao {
     private Long id;
     private String name;
     // other fields, getters and setters
} 
```

* * *

## 1\. 使用`insert`标签并返回一个对象实例

MyBatis 界面

```
public interface EntityDaoMapper {
    EntityDao insert(EntityDao entity);
} 
```

MyBatis XML 映射器：

```
<insert id="insert" parameterType="com.package.EntityDao" useGeneratedKeys="true" keyColumn="entity_id" keyProperty="id">
    INSERT INTO some_table (name, type, other_fields, etc)
    VALUES (#{name}, #{type}, #{other_fields}, #{etc}) 
</insert> 
```

示例代码：

```
 EntityDao saved = entityDaoMapper.insert(entityToSave);
    System.out.println(saved.getId()); 
```

## 2.使用`select`and`resultType`标签只返回记录的ID

MyBatis 界面

```
public interface EntityDaoMapper {
    Long insert(EntityDao entity);
} 
```

MyBatis XML 映射器：

```
<select id="insert" parameterType="com.package.EntityDao" resultType="long">
    INSERT INTO some_table (name, type, other_fields, etc)
    VALUES (#{name}, #{type}, #{other_fields}, #{etc}) 
    RETURNING entity_id       <-- id only or many fields
</select> 
```

示例代码：

```
Long id = entityDaoMapper.insert(entityToSave);
System.out.println(id); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-22T11:25:26.477

您还可以使用生成的密钥：

```
 <insert id="create" parameterType="Skupina" useGeneratedKeys="true" keyColumn="id" keyProperty="id">
        INSERT INTO ODBOR 
            (NAZEV, POPIS, ZKRATKA, WEBROLE, JEODBOR, AKTIVNI)
        VALUES 
            (#{nazev}, #{popis}, #{webrole}, #{webrole}, false, #{aktivni})
  </insert> 
```

插入后，参数将属性**id**设置为列**id**中的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-28T13:25:09.167

在此示例中使用选项

```
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Options;
import org.apache.ibatis.annotations.Param;

@Mapper
public interface POJOCustomMapper {
    @Options(useGeneratedKeys = true, keyProperty = "ID", keyColumn = "ID") 
    @Insert({
        "insert into TABLE_A ( NAME "
        "values (#{NAME,jdbcType=VARCHAR})"
    })
    long insert(POJO record); 
```

# razor - 从 db.query 获取列表

> ID：15456039
> 
> 赞同：0
> 
> 时间：2013-03-16T23:43:27.177
> 
> 标签：razor

我想知道是否有办法在列表中检索 sql 结果。我有： var ingredients = db.Query("Select * FROM Ingredients");

有没有办法在列表中获取它，因为我不想使用 foreach 循环，我想在特定索引中获取结果。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T23:48:28.997

该[`Query`](http://msdn.microsoft.com/en-us/library/webmatrix.data.database.query%28v=vs.111%29.aspx)方法返回一个`IEnumerable<object>`. 所以你可以使用`.ToList()`扩展方法来获得一个`List<object>`.

```
var ingredients = db.Query("Select * FROM Ingredients").ToList(); 
```

然后能够通过索引访问单个元素：

```
var fifthIngredient = ingredients[4]; 
```

当然，在这样做之前，您应该确保此列表至少包含您尝试访问索引的元素数量，否则`IndexOutOfRangeException`当您尝试访问更大索引处的元素时，您将在运行时得到一个。

你的目标不是很清楚，所以很遗憾很难为你提供一些更好的选择。

# c++ - 具有与复制构造函数冲突的概念的通用编程

> ID：15456043
> 
> 赞同：2
> 
> 时间：2013-03-16T23:44:11.307
> 
> 标签：c++, templates, c++11, constructor, concept

我正在尝试使用通用编码样式将受限概念 API 包装在通用堆栈上。我遇到的问题是我的一个构造函数，最重要的一个采用模板化堆栈的构造函数，正在覆盖我的复制构造函数。我对所讨论的类有一个要点，一些测试代码，以及我从这里的编译器得到的错误：[https ://gist.github.com/biot023/5178831](https://gist.github.com/biot023/5178831)

我希望能够将值语义与我创建的堆栈一起使用，我可以在将其分配给它们的向量时使用。但是，这给了我复制构造函数的问题。

谁能建议我如何显式触发复制构造函数（我只需要在我的测试代码中这样做），或者告诉我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T23:55:32.090

问题是您的构造函数模板比​​您的复制构造函数更匹配：

```
// Copy constructor
WrappedStack( const WrappedStack &other )

// Constructor template
template <typename S>
WrappedStack( S &stack ) 
```

当使用类型对象`WrappedStack<T>`（*类*`T`模板参数在哪里）进行实例化时，构造函数模板的实例化签名将如下所示：

 *```
WrappedStack( WrappedStack<T> &stack ) 
```

如果参数的类型不是 - 限定的，这比复制构造函数更好`const`，因为它不需要`const`转换。因此，构造函数模板将被重载解析选中，并且其主体将被实例化，从而导致您遇到的错误。

`WrappedStack<T>`要强制编译器在适当时使用复制构造函数，您可以使用 SFINAE 在使用 类型或可隐式转换为 的类型的对象实例化构造函数模板时导致替换失败`WrappedStack<T>`。例如：

```
#include <type_traits>

template<
    typename S,
    typename std::enable_if<
        !std::is_convertible<S, WrappedStack<T> const&>::value
        >::type* = nullptr>
WrappedStack( S &stack ) : __stack( new wrapped_stack_t<S, T>( stack ) ) {} 
```

[查看此成功编译](http://liveworkspace.org/code/4cvdpz%2453)的实时示例。*

# java - 逗号运算符在“eval()”中做了什么？

> ID：15456048
> 
> 赞同：1
> 
> 时间：2013-03-16T23:45:28.183
> 
> 标签：java, comma

我正在尝试学习 java，我在旧的 UIL 练习测试中遇到了这段代码，我无法弄清楚这部分代码在做什么。

```
d[i][j] = eval(d[i-1][j]+1
[i][j-1]+1, d[i-1][j-1] + cost); /* the commas confuse me, I don't know what to add to cost */ 
```

如果有帮助，这是整个代码

```
private static int eval(int a, int b, int c) {
    int m;
    m = a;
    if (b < m)
        m = b;
    if (c < m)
        m = c;
    return m;
}

public static int comp(String s, String t) {

    int d[][];
    int n, m, i, j;
    char si, tj, cost;
    n = s.length();
    m = t.length();

    if (n == 0) {
        return m;
    }

    if (m == 0) {
        return n;
    }

    d = < * 1 >;

    for (i = 0; i <= n; i++) {
        d[i][0] = i;
    }

    for (j = 0; j <= m; j++) {
        d[0][j] = j;
    }

    for (i = 1; i <= n; i++) {

        si = s.charAt(i - 1);

        for (j = 1; j <= m; j++) {

            tj = t.charAt(j - 1);

            if (si == tj) {
                cost = 0;
            } else {
                cost = 1;
            }

            d[i][j] = eval(d[i - 1][j] + 1,
            d[i][j - 1] + 1, d[i - 1][j - 1] + cost);
        }
    }
    return d[n][m];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T23:47:46.083

方法中的逗号用于分隔参数。

如您所见，`eval`方法需要树参数

```
private static int eval (int a, int b, int c){ 
```

在您的代码示例中，您正在像这样调用它

```
 d[i][j] = eval(d[i - 1][j] + 1, //<-there is comma here in your code
        d[i][j - 1] + 1, d[i - 1][j - 1] + cost); 
```

这等于

```
d[i][j] = eval(d[i-1][j]+1, d[i][j-1]+1, d[i-1][j-1] + cost); 
```

所以参数`a`将是`d[i-1][j]+1`, `b`=`d[i][j-1]+1`和`c`=的值`d[i-1][j-1] + cost`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T23:47:42.510

`eval()`在这种情况下，逗号只是用来分隔方法调用的不同参数。例如，如果我们这样调用`eval()`：

```
eval(1, 2, 3) 
```

然后，在`eval()`'s body 内部，参数将被绑定如下：

```
a = 1
b = 2
c = 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T00:01:40.670

在 Java 中，逗号永远不是运算符。它始终只是一个分隔符。

```
 d[i][j] = eval(d[i - 1][j] + 1,
                   d[i][j - 1] + 1, 
                   d[i - 1][j - 1] + cost); 
```

在这种情况下，它只是将方法调用中的实际参数表达式分开。（我已经修复了缩进以明确这一点。）

因此，在您的示例中，逗号只是分隔调用的 3 个参数表达式`eval`。也许您只是被一些“非标准”缩进误导了。

* * *

（在 C 和 C++ 中，有*一个*逗号[运算符](http://en.wikipedia.org/wiki/Comma_operator)；例如

```
 a = x(), y(); 
```

意味着调用`x`并丢弃结果，然后调用`y`并将结果分配给`a`. 但是，该语句不是有效的 Java 代码。）

# ajax - 在 yii 中使用 ajax 创建或更新

> ID：15456052
> 
> 赞同：0
> 
> 时间：2013-03-16T23:46:16.883
> 
> 标签：ajax, drop-down-menu, yii

我目前正在 yii-framework 中创建一个应用程序。该应用程序的目的之一是能够在不同的预定义类别和平台上对游戏进行评分。一个游戏可以属于多个平台。

一个例子：我选择给一个名为“x”的游戏评分。我可以看到游戏在 4 个不同的平台上发布，所以当我对游戏进行评分时，我会选择我玩它的平台。此后，我对 5 个不同类别的游戏进行评分。如果我稍后回到这个游戏，我应该能够更新该评级，但我也应该能够为不同的平台创建一个新的评级。

尤其是我不确定的最后一部分。我对如何做到这一点的猜测是创建一个包含游戏所属平台的下拉列表，并让一些 AJAX 函数决定它应该创建新评级还是更新现有评级。但是，我不知道如何做到这一点，因为我很少使用 AJAX 做某事。

你能给我一些关于如何实现这一目标的提示吗？

编辑：看起来我可能没有尝试过什么，所以我会发布一些我到目前为止创建的代码（出于某种原因，我将它命名为排名而不是评级......）。如您所见，它没有任何 AJAX，并且没有考虑平台：

```
protected function createRanking($model)
    {
        $user_id=Yii::app()->user->getId(); 
        $game_id=$model->id;
        $rank=ranking::model()->find("create_user_id=$user_id and game_id=$game_id"); 

        if($rank===null){
        $ranking=new Ranking;
        }
        else{
        $ranking=$rank;
        }

        if(isset($_POST['Ranking']))
        {
            $ranking->game_id=$model->id;
            $ranking->attributes=$_POST['Ranking'];

            $valid = $ranking->validate();
            if ($valid)
            {
                $ranking->save(false);
                $this->redirect(array('index'));
            }
        }
        return $ranking;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T14:25:25.737

[http://www.yiiframework.com/wiki/394/javascript-and-ajax-with-yii/](http://www.yiiframework.com/wiki/394/javascript-and-ajax-with-yii/) [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

我认为你应该先阅读那些（并且有一些 PHP 和 javascript 知识）。

如果您想使用 DropDowns，您应该查看 EventHandlers（jQuery 可以帮助您）。通过下拉列表的选择器，您可以附加这样的处理程序。我不会再添加任何内容，使用我给你的关键字，你应该找到关于该主题的优秀文档。

在 Yii 方面，您处理 AjaxRequest 就像处理普通 HTTP 请求一样。所以你会有一个动作，你有控制流来检查记录的存在（findByPk 是一个选项）。

在我看来，你有非常基本的问题，给你代码只会让你在短期内变得容易。我真的建议您阅读 yii-framework 的教程： [http ://www.yiiframework.com/doc/guide/](http://www.yiiframework.com/doc/guide/) [http://www.yiiframework.com/doc/blog/](http://www.yiiframework.com/doc/blog/)

编辑：你的问题仍然不是很清楚imo（哪种暗示缺乏关于该主题的阅读）。正如您已经知道“isNewRecord”是要走的路，用于检查它是更新还是创建。如果有一些与之相关的问题，您应该考虑发布包含它的代码并重新处理问题。

无论如何，这是对您的代码的一些与问题无关的次要建议：

```
$ranking = ranking::model()->findByAttributes(array(
    "create_user_id" => $user_id,
    "game_id" => $game_id
));

if($ranking===null) {
    $ranking=new Ranking;
} 
```

排名/排名变量声明不清楚，因为您对同一事物使用不同的名称。此外，正如上面的代码所示，它不是必需的。此外，您基本上在您的 find 方法中使用了 SQL，这被认为是一种不好的做法，因为 Yii 的整个想法仅在绝对无法绕过它时才使用 DB 语言。此外，与数组的参数绑定方式更安全（在这种情况下，我认为这不是什么大问题）。

# java - requestFocusInWindow(boolean) 在 JComponent 中有受保护的访问吗？

> ID：15456056
> 
> 赞同：0
> 
> 时间：2013-03-16T23:46:58.563
> 
> 标签：java, swing, user-interface, jcomponent

我正在尝试为程序分配构建 GUI，该程序分配基本上在顶部有 2 个按钮，从左侧开始，在右侧恢复，面板位于底部。但它告诉我：

> 错误：requestFocusInWindow(boolean) 在 JComponent 中具有受保护的访问权限

我以前遇到过一次，我觉得我不明白这意味着什么，任何人都有一个很好的解释，我用谷歌搜索，似乎找不到任何东西，所以我认为这可能很愚蠢。

这是我用来构建 GUI 的代码：

```
import javax.swing.*;
import java.awt.*;

public class PendulumWindow {

    protected JFrame pendFrame;
    protected JPanel pendPanel;
    protected JButton resume;
    protected final int SIZE_X = 500;
    protected final int SIZE_Y = 450;
    protected Dimension pendPanSize = new Dimension(SIZE_X, SIZE_Y);

    public PendulumWindow() {

    }

    public PendulumWindow(String s) {
        makePanel();
        makeFrame();
    }

    public void makePanel() {
        pendPanel = new JPanel();

        pendPanel.setPreferredSize(pendPanSize);
        pendPanel.setFocusable(true);
        pendPanel.requestFocusInWindow(true);
        pendPanel.setBackground(Color.BLUE);
   }

   public void makeFrame() {
        pendFrame = new JFrame("Pendulum");
        start = new JButton("start");
        resume = new JButton("resume");

        //---------- FRAME PROPERTIES ----------//

        pendFrame.setSize(500,500);
        pendFrame.setVisible(true);
        pendFrame.setResizable(true);
        pendFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //---------- ADD ELEMENTS TO FRAME ----------//

        pendFrame.setLayout(new BorderLayout());
        pendFrame.add(start, BorderLayout.WEST);
        pendFrame.add(resume, BorderLayout.EAST);
        // pendFrame.add(pendPanel, BorderLayout.SOUTH);
   }

   public static void main(String[] args) {
        PendulumWindow window = new PendulumWindow("Pendulum");
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T23:55:04.643

文档显示[requestFocusInWindow(boolean)](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#requestFocusInWindow%28boolean%29)只能`protected`由`JComponent`. 相反，您应该使用可公开访问的[requestFocusInWindow](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#requestFocusInWindow%28%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:00:30.297

使用`requestFocus()`，不使用`requestFocusInWindow()`。

# java - Java小学生招生系统

> ID：15456058
> 
> 赞同：0
> 
> 时间：2013-03-16T23:47:17.177
> 
> 标签：java

我必须设计一个带有 GUI 的小型课后俱乐部管理系统（在开始时就已经设计好了）。该系统应该执行一些功能： - 添加学生， - 添加俱乐部， - 将学生添加到指定的俱乐部。当用户点击一个俱乐部时，它应该列出所有加入该俱乐部的学生。另一方面，当用户点击学生时，它应该列出学生加入的所有俱乐部。前两个功能已完成并正常工作。但是，我正在努力将学生添加到指定的俱乐部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:08:44.160

根据给定的标准，

> 对该方法的给定评论是：（1）俱乐部和（2）学生必须已经添加到数据库中，并且（3）学生之前必须没有被添加到俱乐部。如果不满足这些条件，则该方法不应执行任何操作并返回 false。如果满足，则将学生添加到俱乐部，并且该方法返回 true 。

```
public boolean addPupilToClub(String clubName, String firstName, String lastName) {
    String studentID = firstName + " " + lastName;
    if (clubs.indexOf(clubName) == -1   // (1) the clubName  does not exist
        || pupils.indexOf(studentID) == -1)  // (2) OR the pupil does not exist {
          return false;
    } 

    //the rest is pseudo code

    else if (<<(3) the specified club already contains the student>>) {
          return false;
    } else { 
      //student never added to the club before
          <<insert code that adds student to club>>

          //additional check whether club is already included in master list (say, pupilsInClub?)
          //if not, add club to master list

          return true;
    }
} 
```

理想情况下，如果您想打印出俱乐部及其学生的列表，则应该有一个俱乐部（包含学生）的主列表，例如`pupilsInClub`，类型为 `List<Club>`。然后你可以迭代`pupilsInClub`每个俱乐部，利用课堂上的一些方法`Club`来转储它的学生。

注意：您还必须确保`A`尚未将俱乐部添加到`pupilsInClub`. 如果俱乐部 A 已存在于 中`pupilsInClub`，只需将新学生添加到俱乐部 A。否则，您还必须将俱乐部 A 添加到`pupilsInClub`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T23:53:33.793

您可能应该维护类`Pupil`内部的列表`Club`。所以在里面`Club`：

```
private List<Pupil> pupils; 
```

以及添加`Pupil`到此列表的方法：

```
public void addPupil(Pupil p) {
    pupils.add(p);
} 
```

在该`addPupilToClub`方法中，这是您将 a 添加`Pupil`到 a 的方式`Club`：

```
Club c = new Club(clubName);
Pupil p = new Pupil(firstName, lastName);
c.addPupil(p); 
```

请记住`pupils`在`Club`构造函数中进行初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T00:05:44.737

我想你可能会因为`if`在`addPupilToClub`. 将其分解为嵌套语句将允许您对每个语句进行评论：

```
public boolean addPupilToClub(String clubName, String firstName, String lastName) {
    if (clubs.indexOf(clubName) != -1) {   // the clubName exists
        if (pupils.indexOf(firstName + " " + lastName) != -1) { // the pupil exists
            if (newList.indexOf(firstName + " " + lastName)==-1)) {  // the pupil isn't in newList
                Club c=new Club(clubName);
                Pupil p = new Pupil(firstName,lastName);
                newList.add(p.getFullName());
                pupilsInClub.add(newList);
                removeDuplicates();
                System.out.println(pupilsInClub); 
```

一旦我们这样做了，我认为在你发现俱乐部和学生已经存在之后，你会更容易看到你正在创建一个新的俱乐部和一个新的学生。这看起来像一个错误。

# python - 设置项目时列表引用会发生什么

> ID：15456059
> 
> 赞同：0
> 
> 时间：2013-03-16T23:47:17.377
> 
> 标签：python, dictionary, variable-assignment

```
def foo():
    testdict = {'A': '1235', 'B': '6458', 'C': 54156}
    dofoo(testdict)

def dofoo(testdict):
    testdict['A'] = testdict['A'].replace('2', '') 
```

`testdict`设置时对变量值的引用发生了什么`testdict['A']`？只有那个项目失去了对原始价值的引用吗？

**编辑：**

因为如果我会这样做：

```
def foo():
    testdict = {'A': '1235', 'B': '6458', 'C': 54156}
    dofoo(testdict)

def dofoo(testdict)
    testdict = {'F' : '156', 'G' : '6875'} 
```

然后参考将丢失。那么，如果您设置此类集合的项目，为什么不呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T23:52:30.470

```
testdict = {'A': '1235', 'B': '6458', 'C': 54156}

def foo(x):
    x['A'] = 0;

foo(testdict)

print testdict['A'] 
```

testdict['A'] 的输出为 0。

这是因为 dict 作为引用传递给 foo 函数。

因此，当您将 testdict 传递给 foo 时，x 不是作为 testdict 副本的新 dict - 它实际上是指向同一个 testdict 的指针。当 x['A'] 改变时，这意味着 testdict['A'] 也会改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T00:46:06.293

在任何给定时间，了解您使用给定名称所指的值非常重要。这就是我的意思：

```
def doFoo1(testdict):
    testdict["A"] = "test1" # this changes a value contained in testdict
    print(id(testdict)) # the id

def doFoo2(testdict):
    testdict = {some:"new dict"} # this creates a new dict object
    print(id(testdict)) # prints a different id, since testdict is a new object

def foo():
    mydict = {'A': '1235', 'B': '6458', 'C': 54156}
    print(id(mydict))
    doFoo1(mydict)
    print(id(mydict))
    doFoo2(mydict)
    print(id(mydict)) 
```

这是我系统上的输出（Windows 7 上的 64 位 Python 3.3）：

```
>>> foo()
59383560
59383560
59383560
59413832
59383560 
```

打印了五个`id`值，三个（第一个、第三个和第五个）`foo`来自每个`doFoo`函数（第二个和第四个）。doFoo2 中的一个是唯一与其他不同的，因为该语句`testdict = {some:"new dict"}`创建了一个新对象，该对象绑定到该`testdict`函数命名空间内的名称。该更改不会反映在`foo`函数中，因为它的`mydict`名称仍绑定到原始对象。

这是 Python 的一部分，与大多数其他编程语言不同。与 C 中变量名对应于内存中的特定位置的 C 不同，在 Python 中，名称指的是特定对象。如果再次分配给该名称，那只会将该名称重新绑定到另一个对象（根本不会影响原始对象，尽管如果没有其他对它的引用，它可能会被垃圾收集）。

这段[代码的一部分（如 Pythonista](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#other-languages-have-variables)演示文稿）对于理解这种区别非常有帮助。我认为它的“nametag”隐喻非常有助于理解名称绑定在 Python 中的工作原理。

# sencha-touch - 如何在 sencha touch 中为 Overlay Panel 赋予透明背景

> ID：15456061
> 
> 赞同：2
> 
> 时间：2013-03-16T23:47:25.357
> 
> 标签：sencha-touch, sencha-touch-2, sencha-touch-2.1

下面的代码只改变面板周围边框的颜色，而不是面板本身。

```
var overlay = Ext.Viewport.add({                
    xtype: 'panel',
    centered: true,
    style:'background-color: transparent;',
    modal: {
        style: 'opacity: 0'
    },
    hideOnMaskTap:true,
    width:'20%',
    height: '50%',
    styleHtmlContent:true,
    items:[{
        xtype:'button',
        test:'hey',
        cls:'notrans',
        style: 'opacity: 1'
    }]
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T02:37:58.427

**当面板居中**时，您需要更改`x-panel-inner`面板的 cls 。所以你想要做的是给你的面板一个例如：.**`cls``cls: my-panel`**

 **```
var overlay = Ext.Viewport.add({
    xtype: 'panel',
    centered: true,
    style:'background-color: transparent;',
    cls: 'my-panel',
    ....
}); 
```

现在在您的自定义样式表中：

```
.my-panel .x-panel-inner {
    background-color: transparent !important;
} 
```

所以现在你的居中面板的背景应该是透明的。**

# java - 可以防止一次触发动作侦听器吗？

> ID：15456064
> 
> 赞同：2
> 
> 时间：2013-03-16T23:48:09.243
> 
> 标签：java, swing, actionlistener, jradiobutton

*情况：*一组组件的状态被保存到一个 XML 文件中。一切都很好。我正在尝试将相同的数据加载到相同的组件中（尽管应用程序的其余部分可能处于不同的状态，例如应用程序的新实例）。

*问题：*其中一个组件是 JRadioButton，我想启用此按钮**而不会**触发其动作侦听器（侦听器调用此时可能未创建的对象）。

*问题：*是否可以在不触发其侦听器的情况下启用 JRadioButton？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:34:29.637

我解决了这个问题。谢谢您的意见。

*我做了什么：*我创建了一个布尔值“加载”。在我加载 XML 数据时将此设置为 true，执行我想做的操作并将此值设置回 false。单选按钮上的 actionPerformed 仅在加载为 false 时运行。

# mono - Xamarin Studio / MonoTouch iOS - NewtonSoft Json.net 的运行时问题

> ID：15456067
> 
> 赞同：0
> 
> 时间：2013-03-16T23:48:28.727
> 
> 标签：mono, json.net, xamarin.ios

我想我会试试 Monotouch。我想使用 Json.net 反序列化 JSON 数据（System.Runtime.Serialization.Json 不包含在 monotouch 中）。[所以我从Xamarin 开发者中心](http://components.xamarin.com/)下载了 json.net 程序集。当我运行应用程序时，我得到一个 System.IO.FileNotFound 异常，抱怨它找不到'Newtonsoft.Json，版本 = 4.5.0.0'

我只是引用了程序集并尝试像在 VS 中一样使用它。还有更多我需要做的吗？我在编译项目时注意到一个警告，指出该程序集使用的 .net 框架版本比 monotouch 支持的新版本，但由于我是从 Xamarine 的网站下载的，所以我认为它可以工作。

我也尝试自己从源代码构建这个程序集，但这还没有成功。Json.net 项目引用已损坏，并且我是 monotouch 的新手，我不知道如何修复它们。

有人可以帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T16:59:01.907

您是否使用解决方案中的 Components 文件夹添加了程序集？

很有可能，您下载了该组件，但没有添加 Xamarin 组件，而是转到引用对话框并安装了针对您的系统 .NET 版本编译的系统组件，而不是经过修改以在 iOS 上运行的组件。

# python-3.3 - 整数或列表的 id 的 python 元组

> ID：15456074
> 
> 赞同：1
> 
> 时间：2013-03-16T23:48:51.480
> 
> 标签：python-3.3

在适用于 Windows 的 Python 3.3 中，每个列表在创建时都会获得不同的 id：

```
>>> id([3])
46555784
>>> id([3])
47920192
>>> id([4])
46532048 
```

但是如果我写一个元组询问两个列表的 id，每个列表似乎都得到相同的 id：

```
>>> id([3]), id([4])
(43079000, 43079000) 
```

我期待一个具有两个不同 ID 的元组。这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:01:47.530

根据[Python 3.3 id Documentation](http://docs.python.org/3.3/library/functions.html#id)，CPython 的 id 给出了对象的内存地址。

当我尝试执行以下操作时：

```
print(id([3]))
print(id([4]))
print(id([5]))
print((id([3]), id([4]))) 
```

我为每个列表获得了相同的内存地址。

但是，如果您执行以下操作：

```
print(id([3]))
print(id([4]))
print(id([5]))
i = [3]
j = [4]
print((id(i), id(j))) 
```

前 3 个打印语句和元组的第一个 id 相同，但元组中的第二个 id 不同。这是有道理的，因为创建并分配了两个不同的对象，*然后*检索了 id。

但正如您的帖子所暗示的那样，这些是在 python 脚本中，而不是在交互模式下。但是，我在交互模式下得到了有效的相同结果。

因此，为了回答您的问题，解释器*似乎*正在将数组分配到调用之间的不同位置。但是在声明元组时，它似乎分配、获取 id、空闲、分配、获取 id 和空闲，它恰好是同一个位置。

我在回应 Blender 的评论，如果我没有声明一个数组或者没有嵌套数组，我会得到所有相同的 id 结果。

当我尝试这样的事情时：

```
print(id([3]), id([3]))
print(id([3]), id([3,[3]])) 
```

第一个打印语句 id 具有相同的 id 结果，但第二个打印语句 id 不同，但其中一个 id 与第一个打印语句共享相同的 id。

# android - Android：既不能加载 res/raw 文件也不能加载资产

> ID：15456076
> 
> 赞同：0
> 
> 时间：2013-03-16T23:48:56.180
> 
> 标签：android, file, assets

我尝试在 android 中加载一个 .ini 文件，但它不起作用。到目前为止，我已经尝试了以下两种方法：

从 res/raw 文件夹加载文件：

```
int fileId = context.getResources().getIdentifier(fileName, "raw", context.getPackageName());
bufferedReader = new BufferedReader(new InputStreamReader(Resources.getSystem().openRawResource(fileId)));

// I tried this too:
//context.getResources().openRawResource(fileId))); 
```

我首先认为上下文可能是问题，但 getIdentifier() 方法返回正确的 R.raw id，并且在 openRawResource() 处，logcat 始终显示：

```
03-17 00:17:41.627: W/ResourceType(28752): No known package when getting value for resource number 0x7f040000
03-17 00:17:41.627: W/System.err(28752): android.content.res.Resources$NotFoundException: Resource ID #0x7f040000 
```

当我尝试从 /assets 目录加载文件时：

```
AssetManager assetManager = context.getAssets();
bufferedReader = new BufferedReader(new InputStreamReader(assetManager.open(fileName))); 
```

...我总是得到 FileNotFoundException：

```
03-17 00:33:32.006: W/System.err(30447): java.io.FileNotFoundException: /file.ini: open failed: ENOENT (No such file or directory) 
```

我希望有人可以帮助我解决这个问题，我只是不知道在哪里看。我也在网上搜索了类似的问题，但没有解决办法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T23:51:56.133

如果`fileName`是`file.ini`，那么您的`getIdentifier()`调用将失败，因为资源名称不包含文件扩展名。使用`file`（或者，更好的是，完全摆脱`getIdentifier()`并使用`R.raw.file`）。

关于第二种方法，您的项目目录需要是`assets/`，而不是`asset/`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T23:54:20.937

非常仔细地检查您的文件名：

1) 确保它们都是小写并在您的编码中定义为这样 2) 确保 yoru 文件类型正确（例如，作为 .TTF 引用的 .OTF 会导致此问题） 3) 确保您的文件路由正确。egrid.whatever

玩得开心 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T14:26:44.897

好吧，现在我发现了错误。我在上面发布的代码正在运行，但在此之后我的程序立即调用了一个导致 FileNotFoundException 的方法（它不应该做的事情）。因此，我总是查看代码的错误部分。现在我使用从 /assets 目录打开文件的方法，它的工作原理应该是这样。不过，感谢您的帮助。

# c++ - cout 没有命名类型

> ID：15456091
> 
> 赞同：0
> 
> 时间：2013-03-16T23:51:06.560
> 
> 标签：c++

我是 C++ 新手，我正在使用“hello world”程序，但我不断收到错误消息

“cout”没有命名我在 Ubuntu 上使用 geany 的类型，如果这有所不同，这是我的代码：

```
#include <iostream>

int main ()
{
extern cout << "hello world!";
    return 0;
} 
```

我不想提出新问题，所以我将在此处添加

提供的修订版现在可以编译，但是当我运行程序时出现错误

```
./geany_run_script.sh: 5: ./geany_run_script.sh: ./hello: not found 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T23:53:43.783

更改`extern`为`std::`。第一个问题是`extern`它只在类型名称之前有效，所以这就是编译器所抱怨的。第二个是`cout`在 namespace 中定义的`std`，所以你需要告诉编译器去那里看。好在代码没有说`using namespace std;`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T23:52:50.653

改变：

```
extern cout << "hello world!"; 
```

也

```
std::cout << "hello world!";  // You probably want \n on the end. 
```

这是因为`cout`是在命名空间中定义的对象`std`。因此，您需要通过在它前面加上 . 来让编译器知道在哪里可以找到它`std::`。有几种替代技术，但我认为这是最好的。

备选方案一：使用`using directive`

```
using std::cout;
cout << "hello world!"; 
```

`using std::cout;`告诉编译器在`std`调用中有一个我们想在本地使用的对象`cout`，它被带入当前上下文，从而允许您直接使用它。

# database - microsoft visual studio 2010 asp.net 数据库使用部分匹配搜索

> ID：15456092
> 
> 赞同：0
> 
> 时间：2013-03-16T23:51:15.300
> 
> 标签：database, visual-studio-2010

我正在尝试查询数据库，以便如果搜索“Street”，则会显示所有带有“Street”的地址。

```
Address: <asp:TextBox ID="txtAddress" runat="server"></asp:TextBox>
<asp:SqlDataSource ID="sqlAddress" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ConnectionDataBase %>" 
    SelectCommand="SELECT Address, City, State, County, Type FROM Addresses WHERE (Address = @Address)"
    FilterExpression="Address like '%{0}%'"
    EnableCaching="True">
    <SelectParameters>
    </SelectParameters>
    <FilterParameters>
          <asp:ControlParameter ControlID="txtAddress" Name="Address" PropertyName="Text" Type="String" />
   </FilterParameters>
</asp:SqlDataSource>

<asp:GridView ID="grdAddress" DataSourceID="sqlAddress" 
    AutoGenerateColumns="False" runat="server">
    <Columns>
        <asp:BoundField DataField="Address" HeaderText="Address" 
            SortExpression="Address" />
      </Column>
</asp:GridView> 
```

# firefox-os - 如何在 MacOS 上安装 Firefox OS SDK？

> ID：15456093
> 
> 赞同：4
> 
> 时间：2013-03-16T23:51:17.967
> 
> 标签：firefox-os

我想开始为 Firefox OS 开发，但安装时遇到问题。我正在关注 mozilla 的 wiki，但现在我不知道如何继续。我已经下载了 XULRunner，但是我该怎么办？我正在尝试关注 wiki，但没有找到解决方案。

链接：[https ://developer.mozilla.org/en-US/docs/Getting_started_with_XULRunner](https://developer.mozilla.org/en-US/docs/Getting_started_with_XULRunner)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T14:08:55.943

Firefox OS 没有 SDK。你到底想达到什么目的？

Firefox OS 上的应用程序是 Web 应用程序，因此您可以使用您已经用于 Web 开发的任何工具来开发应用程序。如果您想在 Firefox OS 提供的移动 UI 环境中测试您的应用程序，您可以使用 Firefox OS Simulator，它是一个 Firefox 插件[https://addons.mozilla.org/en-US/firefox/addon /火狐操作系统模拟器/](https://addons.mozilla.org/en-US/firefox/addon/firefox-os-simulator/)

如果您想为 Gaia（构成用户界面的网络应用程序集合）做出贡献，请查看[https://developer.mozilla.org/en-US/docs/Mozilla/Firefox_OS/Platform/Gaia/黑客攻击](https://developer.mozilla.org/en-US/docs/Mozilla/Firefox_OS/Platform/Gaia/Hacking)

如果您想构建整个操作系统和/或为 Gonk（内核）和 Gecko（Web 应用运行时）部分做出贡献，请查看 GitHub 上的 README [https://github.com/mozilla-b2g/B2G /blob/master/README.md](https://github.com/mozilla-b2g/B2G/blob/master/README.md)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-10T03:23:13.067

也许它会很有用

这是一张不错的幻灯片 [http://shafiul.github.io/slides/kickstart_fxos.html#/](http://shafiul.github.io/slides/kickstart_fxos.html#/)

还有阿尔法模拟器 [http://people.mozilla.org/~myk/r2d2b2g/](http://people.mozilla.org/~myk/r2d2b2g/) 它对我很有效

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-28T13:32:31.453

您只需要最新版本的 Firefox 和[Firefox OS 模拟器](https://developer.mozilla.org/en/docs/Tools/Firefox_OS_Simulator)（考虑安装 Firefox Nightly）

[https://developer.mozilla.org/en-US/Apps/Quickstart/Build/Your_first_app](https://developer.mozilla.org/en-US/Apps/Quickstart/Build/Your_first_app)

# html - 悬停放大时的跨度和图像大小

> ID：15456097
> 
> 赞同：1
> 
> 时间：2013-03-16T23:52:22.893
> 
> 标签：html, css, twitter-bootstrap

我发现了一些 css 可以让您在悬停时放大图像，并且在大多数情况下效果很好。

我的问题是我一直在处理特定尺寸的所有图像，它对他们来说效果很好，现在我在另一个页面上，有两种不同的尺寸，所以我必须制作另一个 css 类。

[http://jsfiddle.net/fj8hP](http://jsfiddle.net/fj8hP)

jsFiddle 的播放方式与我的网站不同......但它可以更好地可视化我的问题。

图像上方的部分，白色框，似乎与图像大小直接相关。我有所有短宽度和长图像，所以很好，但现在我正在处理更宽的图像，并且不喜欢跨越整个图像的框。所以如果我在这部分设置宽度为 300px

```
ul.enlarge2 span {
    position:absolute;
    height:10px;
    width:300px;
} 
```

图像将以所需大小显示。我希望它不大于 100，并以图像为中心。有任何想法吗？

这是CSS：

```
ul.enlarge2 {
    list-style-type:none;
    /*remove the bullet point*/
    margin-left:0;
}
ul.enlarge2 li {
    display:inline-block;
    /*places the images in a line*/
    position: relative;
    z-index: 0;
    /*resets the stack order of the list items - later we'll increase this*/
    margin:5px 10px 0 10px;
}
ul.enlarge2 img {
    background-color:#eae9d4;
    padding: 6px;
    -webkit-box-shadow: 0 0 6px rgba(132, 132, 132, .75);
    -moz-box-shadow: 0 0 6px rgba(132, 132, 132, .75);
    box-shadow: 0 0 6px rgba(132, 132, 132, .75);
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
}
ul.enlarge2 span {
    position:absolute;
    height:10px;
    width:100px;
    left: -9999px;
    background-color:white;
    padding: 10px;
    font-family:'Droid Sans', sans-serif;
    font-size:.9em;
    text-align: center;
    color: transparent;
    -webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .75));
    -moz-box-shadow: 0 0 20px rgba(0, 0, 0, .75);
    box-shadow: 0 0 20px rgba(0, 0, 0, .75);
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius:8px;
}
ul.enlarge2 li:hover {
    z-index: 150;
    cursor:pointer;
}
ul.enlarge2 span img {
    padding:2px;
    background:#ccc;
}
ul.enlarge2 li:hover span {
    top: 100px;
    /*the distance from the bottom of the thumbnail to the top of the popup image*/
    left: 0px;
    /*distance from the left of the thumbnail to the left of the popup image*/
}
ul.enlarge2 li:hover:nth-child(2) span {
    left: -200px;
}
ul.enlarge2 li:hover:nth-child(3) span {
    left: -200px;
}
ul.enlarge2 img, ul.enlarge span {
    behavior: url(pie/PIE.htc);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:58:14.950

您需要将文本放入其中`span1`并将内容放入`ul.enlarge2 span`css for 中的新标签中`span1`。这样你就可以更容易地操纵那个白盒子。你也需要`display:block`和`margin:0 auto`使`span1`居中。

```
ul.enlarge2 span{
position:absolute;
left: -9999px;
background-color:white;
} 
```

这就是您在该部分中需要的所有内容，其他所有内容都进入`span1`标签。

这是带有不同图片的小提琴[http://jsfiddle.net/JVQp7/](http://jsfiddle.net/JVQp7/)

它可能不是这样做的最优雅的方式，并且它可能无法验证，因为我已将 div 放入 span 等。

如果您希望该框出现在图像`span1`之前。 [http://jsfiddle.net/JVQp7/1/](http://jsfiddle.net/JVQp7/1/)

# c# - 我不希望浏览器缓存响应重定向

> ID：15456098
> 
> 赞同：-1
> 
> 时间：2013-03-16T23:52:23.533
> 
> 标签：c#, asp.net, caching, redirect, response.redirect

当发生错误时，我正在做 Response.Redirect

但我看到这给一些游客带来了麻烦。因为愚蠢的浏览器使用缓存，他们无法再次看到该页面。由于错误是暂时的，因此造成了巨大的麻烦

所以我不希望缓存任何这些重定向

我做了一些搜索并想出了

```
Response.Cache.SetCacheability(HttpCacheability.ServerAndNoCache) 
```

但我希望一切都被缓存（图像）期望重定向本身。那么最好的解决方案是什么？

Asp.net c# 4.5 - 网络框架 4.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:09:05.157

一个简单的技巧是在重定向 URL 的末尾添加一个随机参数。

例如

```
Response.Redirect("/page.aspx?_rnd=" + RndNumber); 
```

随机数在哪里`RndNumber`，您通过检查是否有其他参数来创建 url，以正确添加随机数。浏览器将页面 url 与 url 参数一起缓存，因此您可以避免提到的问题。

# php - 在某些用户定义的函数中执行 mysqli_query 后出错

> ID：15456100
> 
> 赞同：-2
> 
> 时间：2013-03-16T23:52:38.870
> 
> 标签：php, mysqli

使用一种方法 getField的**getUserName.php**文件的内容：

```
<?php
function getfield($field)
{
if(isset($_SESSION['user_id']) && !empty($_SESSION['user_id']))
    {
    $query="SELECT `$field` FROM `user` WHERE `id`='".$_SESSION['user_id']."'";
    if($query_run=mysqli_query($conn,$query))
    {
      if($query_result=mysqli_fetch_field($query_run))
       {
        return $query_result;
       }
     } else {
        printf("error: %s\n", mysqli_error($conn));
        }       
}  
?> 
```

**index.php**的内容，包括包含**$conn**对象和**getUserName.php的****connection.php**：

 ****```
<?php 
include_once('connection.php');
include_once('function.php');
$fname=getfield('Fname');
$lname=getfield('Lname');

echo $name=$fname.' '.$lname;
?> 
```

执行后，我收到如下错误消息：

**`Warning: mysqli_query() expects parameter 1 to be mysqli, null given in /home/confessi/public_html/college/profile/function.php on line 8`**

任何想法？为什么我会收到错误消息？任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T23:59:25.690

变量在您的函数范围内`$conn`不可用。`getfield`

在函数内部声明它是全局的应该可以解决问题：

```
<?php
function getfield($field)
{
    global $conn;

    if(isset($_SESSION['user_id']) && !empty($_SESSION['user_id']))
    {
        $query="SELECT `$field` FROM `user` WHERE `id`='".$_SESSION['user_id']."'";
        if($query_run=mysqli_query($conn,$query))
        {
            if($query_result=mysqli_fetch_field($query_run))
            {
                return $query_result;
            }
        }
        else
        {
            printf("error: %s\n", mysqli_error($conn));
        }       
    }  
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T23:55:00.417

`$conn`未在 的本地范围内定义`getfield($field)`。您需要将其作为参数发送：

```
$fname=getfield($conn, 'Fname');
$lname=getfield($conn, 'Lname');

function getfield($conn, $field) {
    ... 
```****

# c# - 将数组数据添加到排序列表中

> ID：15456101
> 
> 赞同：1
> 
> 时间：2013-03-16T23:52:40.173
> 
> 标签：c#, sortedlist

我试图找到一种方法可以将提取的数组列表扩展到排序列表？这是我下面的代码，它根据每个候选人水平显示结果，但是我看到了如何将其合并到 SortedList 中，在那里我可以按区域排序？

我尝试了排序列表的一些变体，但是我唯一的成功是垂直打印出第一列（仅）。

X 012

X 075

X 050

X 040

```
string[] voting = { "X012033001140", "C075100026080", "A050070060100", "Q040088050090" };
//int length = voting.Length;
int starter = 0;

int total_a = 0;
int total_b = 0;
int total_c = 0;
int total_d = 0;

int precinct_x = 0;

Console.WriteLine("VOTING RESULTS");
Console.WriteLine("--------------------");

Console.WriteLine("Precinct\tCandidate A \tCandidate B\tCandidate C\tCandidate D\tTotal Precinct Votes");

while (starter < voting.Length)
{
    string precinct = voting[starter].Substring(0, 1);
    string cand_a = voting[starter].Substring(1, 3);
    string cand_b = voting[starter].Substring(4, 3);
    string cand_c = voting[starter].Substring(7, 3);
    string cand_d = voting[starter].Substring(10, 3);
    int counter = 0;

    //Converting the vote counts from strings to ints in order to calculate
    int a = Convert.ToInt32(cand_a);
    int b = Convert.ToInt32(cand_b);
    int c = Convert.ToInt32(cand_c);
    int d = Convert.ToInt32(cand_d);

    precinct_x = a + b + c + d;
    counter++;

    //Console.WriteLine(precinct);
    Console.WriteLine(precinct + "\t\t" + cand_a + "\t\t" + cand_b + "\t\t" + cand_c + "\t\t" + cand_d + "\t\t" + precinct_x + "\t");

    double precinct_total = Convert.ToDouble(precinct_x);

    //This is required in order to continuously loop up to the maximum of the voting Length
    starter = starter + 1;

    //Calculations for Candidate A
    total_a = total_a + a;

    total_b = total_b + b;
    total_c = total_c + c;
    total_d = total_d + d;

}
Console.WriteLine("\nTOTAL RESULTS");
Console.WriteLine("--------------------------------------------------------------------------------");
Console.WriteLine("\t\t" + total_a + "\t\t" + total_b + "\t\t" + total_c + "\t\t" + total_d);

Console.ReadLine(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:57:56.273

首先，您需要创建一个可以保存要排序的数据的类

```
public class VotingResult
{
    public VotingResult(int numberOfCandidates)
    {
        Candidates = new int[numberOfCandidates];
    }

    public string Precinct { get; set; }
    public int[] Candidates { get; private set; }
    public int PrecinctTotal { get { return Candidates.Sum(); } }
} 
```

然后填写一个列表

```
const int NumberOfCandidates = 4;
var votingResults = new List<VotingResult>();
foreach (string s in voting) {
    votingResult = new VotingResult(NumberOfCandidates);
    votingResult.Precinct = s.Substring(0, 1);
    for (int cand = 0; cand < NumberOfCandidates; cand++) {
        votingResult.Candidates[cand] = Convert.ToInt32(s.Substring(3 * cand + 1, 3));
    }
    votingResults.Add(votingResult);
} 
```

现在您可以对列表进行排序

```
var sortedResults = votingResults.OrderBy(v => v.Precinct);

// Or, depending on what you want to sort

var sortedResults = votingResults.OrderByDescending(v => v.PrecinctTotal); 
```

现在您可以打印了

```
var totals = new int[NumberOfCandidates];
foreach (VotingResult v in sortedResults) {
    Console.WriteL(v.Precinct + "\t\t");
    for (int cand = 0; cand < NumberOfCandidates; cand++) {
        Console.Write(v.Candidates[cand]  + "\t\t");
        total[cand] += v.Candidates[cand];
    }
    Console.WriteLine(v.PrecinctTotal);
}
Console.WriteLine("\nTOTAL RESULTS\t\t");
for (int cand = 0; cand < NumberOfCandidates; cand++) {
     Console.Write(totals[cand]  + "\t\t");
}
Console.WriteLine(); 
```

不要忘记代码顶部的这一行，因为我们使用 LINQ 进行排序和求和。

```
using System.Linq; 
```

* * *

您也可以使用`SortedList`原因。如果您需要多次访问排序结果，或者如果您想向列表中添加其他条目并且希望列表一直排序，而不仅仅是在最后排序，这是一个优势。

```
var sortedList = new SortedList<string, VotingResult>();

...
sortedList.Add(votingResult.Precinct, votingResult);
... 
```

或者，如果您想按行总数降序排序

```
var sortedList = new SortedList<int, VotingResult>();

...
sortedList.Add(-votingResult.PrecinctTotal, votingResult);
... 
```

其余部分保持不变，除了您可以删除排序部分并且您必须循环遍历`sortedList.Values`.

* * *

有很多方法可以做到这一点，但无论如何，为列表条目创建一个类是有利的，因为它允许您将所有数据放在一起排序。

# synchronization - cpu挂在insmod上

> ID：15456103
> 
> 赞同：1
> 
> 时间：2013-03-16T23:52:47.093
> 
> 标签：synchronization, device-driver, kernel-module

我正在尝试以将 I/O 请求移交给单独的工作线程的方式编写块设备驱动程序。工作线程等待获取请求，然后执行实际的 I/O。

我正在使用完整的结构在工作线程和传输请求函数之间进行同步。工作线程在处理请求之前执行 wait_for_completion 并在传输请求得到请求时被唤醒。

但是，当我尝试执行 insmod 时，我的系统会挂起。这是回溯在每个 CPU 上的样子

```
[  152.036031] BUG: soft lockup - CPU#0 stuck for 22s! [mount:1752]
[  152.036046] CPU 0
[  152.036046] Call Trace:
[  152.036046]  [<ffffffff8108d3e3>] smp_call_function+0x33/0x60
[  152.036046]  [<ffffffff8108d443>] on_each_cpu+0x33/0xa0
[  152.036046]  [<ffffffff81189e95>] __blkdev_put+0x185/0x1f0
[  152.036046]  [<ffffffff8115570a>] __fput+0xaa/0x200
[  152.036046]  [<ffffffff81151f3f>] filp_close+0x5f/0x90
[  152.036046]  [<ffffffff8115201d>] sys_close+0xad/0x120
[  152.036046]  [<ffffffff815a7312>] system_call_fastpath+0x16/0x1b

[  158.233026] INFO: rcu_preempt_state detected stalls on CPUs/tasks: { 2} (detected by 0, t=60002 jiffies)
[  158.233031] sending NMI to all CPUs:

[  158.233031] NMI backtrace for cpu 0
[  158.233031] CPU 0 
[  158.233031] Call Trace:
[  158.233031]  [<ffffffff8102018f>] arch_trigger_all_cpu_backtrace+0x4f/0x90
[  158.233031]  [<ffffffff810ca429>] print_other_cpu_stall+0x159/0x1c0
[  158.233031]  [<ffffffff810cb5e1>] __rcu_pending+0x31/0x180
[  158.233031]  [<ffffffff810cbb4a>] rcu_check_callbacks+0x11a/0x190
[  158.233031]  [<ffffffff8106505f>] update_process_times+0x3f/0x80
[  158.233031]  [<ffffffff8108772b>] tick_sched_timer+0x5b/0xc0
[  158.233031]  [<ffffffff8107a2ce>] __run_hrtimer+0x6e/0x240
[  158.233031]  [<ffffffff8107acf5>] hrtimer_interrupt+0xe5/0x200
[  158.233031]  [<ffffffff8101efb3>] smp_apic_timer_interrupt+0x63/0xa0
[  158.233031]  [<ffffffff815a7e5e>] apic_timer_interrupt+0x6e/0x80
[  158.233031]  [<ffffffff8108d30e>] smp_call_function_many+0x1fe/0x2a0
[  158.233031]  [<ffffffff8108d3e3>] smp_call_function+0x33/0x60
[  158.233031]  [<ffffffff8108d443>] on_each_cpu+0x33/0xa0
[  158.233031]  [<ffffffff81189e95>] __blkdev_put+0x185/0x1f0
[  158.233031]  [<ffffffff8115570a>] __fput+0xaa/0x200
[  158.233031]  [<ffffffff81151f3f>] filp_close+0x5f/0x90
[  158.233031]  [<ffffffff8115201d>] sys_close+0xad/0x120
[  158.233031]  [<ffffffff815a7312>] system_call_fastpath+0x16/0x1b

[  158.233291] CPU 3 and CPU 1
[  158.233347] Call Trace:
[  158.233352]  [<ffffffff8101eb68>] lapic_next_event+0x18/0x20
[  158.233356]  [<ffffffff81087288>] tick_dev_program_event+0x38/0x100
[  158.233360]  [<ffffffff8107ad2d>] hrtimer_interrupt+0x11d/0x200
[  158.233363]  [<ffffffff8101efb3>] smp_apic_timer_interrupt+0x63/0xa0
[  158.233366]  [<ffffffff815a7e5e>] apic_timer_interrupt+0x6e/0x80
[  158.233371]  [<ffffffff81029aa2>] native_safe_halt+0x2/0x10
[  158.233374]  [<ffffffff8100a67d>] default_idle+0x4d/0x2a0
[  158.233378]  [<ffffffff810011a6>] cpu_idle+0x86/0xd0

[  137.645911] CPU 2 
[  137.645911] Call Trace:
[  137.645911]  [<ffffffff8159d766>] wait_for_common+0x26/0x150
[  137.645911]  [<ffffffffa01674e2>] tsdd_worker_thread+0x72/0x1b0 [tsdd]
[  137.645911]  [<ffffffff81075eee>] kthread+0x7e/0x90
[  137.645911]  [<ffffffff815a94f4>] kernel_thread_helper+0x4/0x10` 
```

...最终系统挂起。

我隐约明白这里似乎发生了什么。(tsdd) 工作线程在 CPU 2 上运行，等待 wait_for_completion()。在 CPU0 上有一个关闭系统调用。它似乎在等待所有其他 CPU 的响应。它得到除 CPU2 之外的所有响应。它等待的时间太长（BUG：软锁定 - CPU#0 卡住了 22 秒！）并且有一个定时器中断。

现在这个中断被广播到所有 CPU。wait_for_completion() 函数使 CPU2 上的线程等待直到 completion_done。即使发生中断，它也不会唤醒线程。当在这种情况下出现定时器中断时，中断被发送到所有 CPU，包括 CPU2，我们的线程在 wait_for_completion() 处卡住。它将无法为中断提供服务，系统最终会挂起。

这个观察是正确的，还是有更多的事情发生？

下面是一个简短的伪代码：

```
static struct request *sch_req = NULL;  //global
static struct complete *comp = NULL;    // initialized in module_init

void transfer_req(req_queue) {
    req = blk_fetch_request(req_queue);
    served = 0;
    while (!served) {
        if (completion_done(comp))
            continue;
        sch_req = req;
        sch_queue = req_queue;
        complete(comp);
        served = 1;
    }
}

void worker_thread() {
    while (!kthread_should_stop()) {
        if (wait_for_completion(comp))
            continue;
        while (sch_req) {
            perform_IO(sch_req);
            sch_req = blk_fetch_req(sch_queue);
        }
        init_completion(comp);
    }
} 
```

有人可以帮忙弄清楚这里出了什么问题吗？我也想了解如何解决这个问题。我什至尝试使用 wait_for_completion_interruptible，但这似乎并不能解决问题。

谢谢

PS - 很抱歉发了这么长的帖子（无法附加日志文件）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-23T09:59:01.303

看起来 CPU0 卡在等待 CSD 锁定。您是否检查了 CPU 之间缺少的 IPI 中断？

# facebook - 使用 facebook->getUser() 和 FB.getUserID() 登录 Facebook

> ID：15456106
> 
> 赞同：1
> 
> 时间：2013-03-16T23:53:03.613
> 
> 标签：facebook, facebook-javascript-sdk, facebook-php-sdk

对于我的网站，我使用 Facebook 登录。使用该`$facebook->getUser()`功能，我可以将用户从登录页面（主页）重定向到您登录时看到的第一页。

结果`$facebook->getUser()`是 0 或用户 ID。该值似乎存储在域 Cookie 中（*不是会话 Cookie，因此在完全关闭并重新打开浏览器时不会删除它*）。这是使用完整的，因为我的页面不必与 Facebook 连接就可以知道用户的 ID。

然而，用户可以删除它的所有 Cookie，从而让`$facebook->getUser()`函数返回 0，即使用户已经接受了应用程序（可以在[https://www.facebook.com/settings?tab=applications](https://www.facebook.com/settings?tab=applications)中找到）

我还尝试使用以下内容：

```
$accessToken = $this->facebook->getAccessToken();
$facebook->api('/me?access_token=' . $accessToken, 'GET'); 
```

然而，这一直给我错误`An active access token must be used to query information about the current user`。从用户的`$this->facebook->getAccessToken()`应用程序返回 AccessToken，所以这无济于事:(

现在我的页面不知道用户已经与 facebook 连接，所以它打开*login-page*。这里`//connect.facebook.net/en_US/all.js`已加载，我可以提出`FB.getUserID()`请求。

**现在问题和奇怪的部分：**

当`window.fbAsyncInit`函数完成并异步加载 SDK时

```
 (function(d){
 var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = '//connect.facebook.net/en_US/all.js';
 d.getElementsByTagName('head')[0].appendChild(js); }(document)); 
```

我运行`FB.getUserID()`. 这将返回 Nothing。但是大约 100-700 毫秒后，它确实返回了 fb-id（如果我再次请求它）。所以**Javascript 以某种方式从 facebook 获取了我的 fb-id**而没有使用我的域 cookie

当我使用 Chrome 中的 Inspector 并打开 Network 时，我可以看到，*在所有内容都应该加载和完成之后*，页面`xd_arbiter.php?version=19 (static.ak.facebook.com/connect)`正在被请求和加载。同样重要的是`oauth?client_id=***&response_type=*** (www.facebook.com/dialog)`

看来这个 javascript 请求**可以**从 Facebook 获取 fb-id。

我希望能够使用 PHP 来做到这一点，因此用户不必看到登录页面大约 1 或 2 秒。

我希望我解释得足够好，如果没有，请要求澄清。我非常想解决这个问题！=)

# php - CakePHP 的“积分”系统

> ID：15456108
> 
> 赞同：1
> 
> 时间：2013-03-16T23:53:19.267
> 
> 标签：php, cakephp, cakephp-2.3

我正在使用 CakePHP 构建一个自定义社交网络包。我们希望有一个用户根据事件赚取积分的系统。上传一张照片？给你10分。评论一个？5分。等等。这些点可以被缓存来做一些事情，比如获得对用户可能需要支付现金的某些内容的高级访问权限。

此外，我希望显示一条消息，与 Session Flash 消息分开。我还希望站点管理员能够根据事件配置积分和消息。通过这种方式，他们可以在周末/周期间为访问/登录或照片发布等内容进行促销，然后在促销完成后将号码放回原处。

是否有可以帮助我解决此问题的组件或行为？如果没有，是否有一个基本的想法可以用来实现这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:45:01.897

我认为 Cake 可以在没有插件的情况下处理这个问题。我认为您需要将积分附加到用户提交的每个单独项目（例如照片、评论等）。因此，在每个模型中，我都会添加一个点值列。

对于管理员来说，这有点困难，因为链接所有内容的最佳方式是用户 HABTM 照片、评论等。这意味着您必须先加载用户才能调整/编辑点。除非您期望有成千上万的用户，否则这将起作用。然后，它可能会变得不堪重负，尽管它仍然可以正常工作。

全局点开/关开关，或针对特定模型（如照片）的开关，可以在另一个模型中处理，例如 Point。在这里您可以设置两列资源和点数。因此，例如，照片，10；评论，5...关闭开关可以将其中一个或多个设置为 0。CakePHP 文档 ( [http://book.cakephp.org/2.0/en/ ) 上的“保存您的数据”页面中很好地涵盖了这一切模型/保存你的数据.html](http://book.cakephp.org/2.0/en/models/saving-your-data.html)）。再次，希望这会有所帮助。

# php - 在特定日期之间打开和关闭页面

> ID：15456112
> 
> 赞同：0
> 
> 时间：2013-03-16T23:54:01.520
> 
> 标签：php, mysql, variables, days

我用谷歌搜索了它，但我没有找到那种类型的代码。我想要一个 php 代码，该代码将读取一个值，该值是批准访问页面的天数。

例如，如果今天是页面的第一次打开，并且从下一次打开的天数的值为 20，那么，从今天开始，我们将添加 20 天，然后页面将再次打开。

我更好的例子是这个，我们有一个招聘，招聘会开放 2 天，然后，这两天将在 20 天内关闭，然后会再次开放（一遍又一遍）。但我想定义这两个变量，招聘开放时间和招聘之间的时间。

另一个更简单的功能是，如果我定义了手动招聘，它将打开，当我关闭它时，招聘将从我关闭之日起 20 天开始计算。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T15:59:08.800

我不知道任何链接，但你的代码可以是这样的。请检查链接，功能不言自明。

```
$lastRecDay = "2013-01-11"; // this will be coming from ur db

// create a date object
$date = new DateTime($lastRecDay);
//add 20 days to it
$date->add(new DateInterval('P10D')); // ur date is 20 from last day

//its 20 days+ since the posting
if( $date->format('U') <= strtotime('now'))
{
 // your code re-open goes here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T16:08:13.070

好的，听起来您需要监视以下变量

```
Open date
Display days
Interval days
End date 
```

然后你这样做

```
create a page
enter the first open date
enter the days to be displayed
enter the days between closing and re-opening (interval)
enter the end date 
```

然后计算它是否要显示

```
if (today < enddate ) {
  if (today >= opendate) and (today <= opendate + displaydays)
    show
  else if (today > opendate + displaydays)
    opendate = today + interval
} 
```

现在的问题是如何存储数据？我想这在数据库中是最简单的，但您也可以在文件中执行此操作。

当我知道您的存储类型时，将扩展说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T13:37:50.583

在 php 中，您可以使用[date_add](http://www.php.net/manual/en/function.date-add.php)添加日期。在 mysql 中也有[date_add](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)。我猜这应该可以解决你的问题。

# java - Spring-Webapps：共享资源和分离的开发/Maven模块？

> ID：15456114
> 
> 赞同：3
> 
> 时间：2013-03-16T23:54:17.683
> 
> 标签：java, spring, maven, web-applications, resources

我有两个 WAR，每个都使用 Hibernate-Search+Lucene。据我了解，如果单独加载到 tomcat 等中，该设置将产生两个单独的 Hibernate 和 Lucene 实例。

这两个 WAR 由两个独立的 Maven 模块生成。我想保持这种分离。

如何在生产中合并单独的实例？

我考虑过使用 maven-shade-plugin 来合并 WAR。有没有更好的办法，即。更自动/更标准的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T17:55:41.680

我个人尝试过阴影、叠加和货物超级战争策略来合并两场战争。对于这个要求，我个人最喜欢的是 Cargo uberwar。它不仅允许基本的覆盖功能，还可以通过您可能喜欢使用的附加功能进行增强。控制来自不同战争的文件的合并策略就是这样一个例子。您可能希望至少合并 web.xml。[您可以在http://cargo.codehaus.org/Merging+WAR+files](http://cargo.codehaus.org/Merging+WAR+files)参考更多示例

设置它似乎需要额外的工作，但配置选项是值得的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T10:20:14.693

查看[Maven WAR 覆盖](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)。定义两个单独的 WAR 文件的原因是什么？一般的想法是使用 Maven Overlays 为不同的环境提供 Base WAR（共享资源？）和两个定制的 WAR（差异）。

# list - 从 Prolog 中的列表中删除重复值

> ID：15456117
> 
> 赞同：2
> 
> 时间：2013-03-16T23:54:27.777
> 
> 标签：list, prolog

这是我没有找到解决方案的重复值的情况。

假设我们有以下列表：

```
List = [
    (A, B),
    (A, C),
    (B, A),
    (B, C),
    (C, A),
    (C, B)
]. 
```

重复元素将是在其包中具有完全相同值的元素 - 顺序无关紧要。

因此，删除重复项后，列表将如下所示：

```
List = [
    (A, B),
    (A, C),
    (B, C),
]. 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T12:55:41.450

编写一个谓词`same/2`来识别两个元素何时相同，而与顺序无关。

编写一个谓词`member_same/2`（如`member/2`，但用 代替等式`same/2`）检查元素是否是列表的成员，而不考虑顺序。

然后编写一个谓词来删除重复项，使用`member_same/2`.

顺便说一句，你需要用小写写常量，大写是变量。这可能会导致很多混乱，因为不同的变量可以通过统一变得相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:33:57.157

这是一种直接的方式（但这并没有真正充分利用内置谓词）：

```
% an item is sorted when the two terms are in standard order of terms
%   note that you use @< and @> when you are comparing things that aren't numbers
sortitem((A, B), Item) :-
    (A @< B,
    Item = (A, B));
    (A @> B,
    Item = (B, A)).

% a list of items is sorted when each of the individual item's terms are sorted (but we
%   don't care if the items themselves are in order)
sortlistitems([], []).
sortlistitems([H|T], List) :-
    sortitem(H, HSorted),
    sortlistitems(T, TSorted),
    List = [HSorted|TSorted].

% sorting with sort/2 removes duplicates and puts the items in order
removeduplicateitems(X, Y) :-
    sortlistitems(X, XSorted),
    sort(XSorted, Y). 
```

测试：

```
?- removeduplicateitems([(a, b), (a, c), (b, a), (b, c),(c, a),(c, b)], X).
X = [ (a, b), (a, c), (b, c)] 
```

# java - 试图理解一些java概念

> ID：15456123
> 
> 赞同：1
> 
> 时间：2013-03-16T23:55:14.680
> 
> 标签：java, oop

这可能是一个愚蠢的问题，但我试图理解它。我有 2 个类：一个 Person 类和一个 Account 类。在 Account 类中，我有 3 种方法来设置帐户余额、从该余额中提取并返回该余额。如果我为新人员和新帐户创建了一个新对象，我该如何将它们联系在一起？一起，我的意思是当我尝试获取帐户余额时，我怎么知道我是为特定的人而不是任何人的余额获取它？（假设我有多个帐户和人员对象）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T23:58:46.113

`Account`您可以通过将（将其设为`Array`of `Account`s）对象放入对象中来将它们连接在一起`Person`。然后使用以下命令访问相应的帐户`Person`：

```
class Person
{
   String name;
   String id;
   ...
   List<Account> ownedAccounts = new ArrayList<Account>();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T00:01:01.977

您可以在 Person 类中添加字段，例如：

```
ArrayList<Account> accounts; 
```

或者您可以在 Account 类中添加一些字段（如果只有一个人可以是所有者，否则您还需要一些列表或集合）：

```
Person person; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T00:00:27.117

对我来说有意义的方法是在 Person 类中有一个帐户对象引用。

```
class Person { Account account; } 
```

然后你可以在 person 类中添加一个 checkAccount 方法。

```
void checkBalance(){ return account.getBalance(); } 
```

然后无论你有一个 Person 对象，你都可以调用

```
person.checkBalance(); 
```

要确保该帐户是那个人的，您应该在 Person 对象的构造函数中传递 Account 对象。

```
Person(Account account){ this.account = account } 
```

或者你可以有一个setter方法。如果系统中的每个人都必须有一个帐户，那么在构造函数中传递它是一个更好的主意。

# javascript - 正则表达式匹配任何前面没有另一个字符串的字符串

> ID：15456127
> 
> 赞同：1
> 
> 时间：2013-03-16T23:56:15.337
> 
> 标签：javascript, regex

我很讨厌正则表达式，我一直在努力解决这个问题。问题是我有一个字符串，我想匹配**任何**前面没有“^”的“+”或“-”。

示例字符串：

```
100x^-3+2x-10 
```

上面的字符串将在数学上格式化或读取为“x 的 100 次方 -3 次方，加上 x 的两倍，减去 10”。

我想匹配“2x”之前的“+”和“10”之前的“-”，而**不是**“100x^”之后的“-”。我希望它不会那么混乱。我尝试了以下注册，但没有运气：

```
[^\^][\+|\-] 
```

显然我在某处遗漏了一个大细节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:05:10.273

您可以使用通过反转字符串来模拟向后看的旧技巧，然后匹配`/[\+\-](?!=\^)/`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:21:10.397

它在 chrome 控制台中运行正常，无论如何您可以尝试使用 : `"100x^-3+2x-10".match(/[^\^$]([\-|\+])/ig)`，我建议您在 Google Chrome 的控制台中测试您的正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T00:41:31.447

如果您需要按`+`or分割`-`：

```
"100x^-3+2x-10".replace(/([^^])[-+]/g,'$1@').split('@')
Output: ["100x^-3", "2x", "10"] 
```

我用作`@`临时字符（但您可以使用一组唯一的字符）来标记没有前缀的符号，`^`然后由所选临时字符安全分割。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T00:52:15.557

试一试：

```
/(?<!\^)[+-]/ 
```

# c - 每次结构调用使用一次结构的函数指针

> ID：15456129
> 
> 赞同：4
> 
> 时间：2013-03-16T23:56:22.600
> 
> 标签：c, syntax

我有一个包含多个函数指针的结构。通用接口在头文件中创建。

**头文件**

```
typedef struct
{
    void (*Start)(void);
    void (*ByteWrite)(uint8_t *pBuffer);        // Modifies I2C buffer
    uint8_t (*ByteRead)(uint8_t *pBuffer);
    void (*ArrayWrite)(uint8_t *pBuffer);
    uint8_t (*ArrayRead)(uint8_t *pBuffer);
    bool (*Busy)(void);
} sI2C_t;

extern const sI2C_t I2C0;
extern const sI2C_t I2C1;
extern const sI2C_t I2C2; 
```

然后在 C 文件中实现每个函数指针以满足结构接口。

**C 文件**

```
static void I2C0_Start(void) { ... }
static void I2C0_ByteWrite(*uint8_t) { ... }
static uint8_t I2C0_ByteRead(*uint8_t) { ... }
static void I2C0_ArrayWrite(*uint8_t) { ... }
static uint8_t I2C_ArrayRead(*uint8_t) { ... }
static bool I2C_Busy(void) { ... }

const sI2C I2C0 =
{
    I2C0_Start,
    I2C0_ByteWrite,
    I2C0_ByteRead,
    I2C0_ArrayWrite,
    I2C0_ArrayRead,
    I2C0_Busy
};

// Code-block repeated for I2C1, I2C2, etc. (REDUNDANT!) 
```

这使得访问特定于 I2C 接口的功能变得相对容易：

```
bool status;

I2C0.Start();
status = I2C1.Busy();
... 
```

*虽然 I2C0、I2C1 和 I2C2 等的函数指针基本相同，但我必须为每个*新的结构接口单独写出它们。由于这是多余的，有没有办法让我只实现一次这些函数指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T14:59:54.513

标准解决方案是将结构指针作为第一个参数传递给函数。即代替：

```
I2C0.Start(); 
```

你写：

```
I2C0.Start(&I2C0); 
```

然后，您可以在结构中添加一些额外的字段来识别它是哪一个（例如，如果您为每个 I2C 总线都有固定的硬件地址，您可能在结构的额外字段中拥有硬件地址）。

这是执行与 C++ 类等效的常规 C 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T09:07:17.933

你可以写一个构造函数。例子：

```
typedef struct{
     int    a;
     char   b;
}example;

void constructor (example *pointer_to_struct, int a_value, char b_value){
    pointer_to_struct->a = a_value;
    pointer_to_struct->b = b_value;   /*remember: if you have strings don't have any 
                                     assignments, since a string (like any other array) is a pointer to 
                                     its first element*/
}

int main (void){

    example ex_struct;
    constructor(&ex_struct, 10, 'C');

    return 0;
} 
```

编辑：您还可以编写一个函数，为您选择的类型的每个结构进行相同的分配。例子：

```
void constructor(structure *p){
     p->a = 10;
     p->b = 'C';
} 
```

# ios - 在 AVPlayer 的请求中添加自定义头字段

> ID：15456130
> 
> 赞同：26
> 
> 时间：2013-03-16T23:56:32.120
> 
> 标签：ios, avfoundation, avplayer

使用 AVPlayer 时是否可以将带有 http 请求的标头发送到音频文件？我需要能够在服务器接收到标头时检查标头的内容，以限制对所请求文件的访问。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2014-05-17T15:23:39.760

您可以使用`AVURLAssetHTTPHeaderFieldsKey`' `AVURLAsset`s init 选项来修改请求标头。

例如：

```
NSMutableDictionary * headers = [NSMutableDictionary dictionary];
[headers setObject:@"Your UA" forKey:@"User-Agent"];
AVURLAsset * asset = [AVURLAsset URLAssetWithURL:URL options:@{@"AVURLAssetHTTPHeaderFieldsKey" : headers}];
AVPlayerItem * item = [AVPlayerItem playerItemWithAsset:asset];
self.player = [[AVPlayer alloc] initWithPlayerItem:item]; 
```

注意：我在 WebKit 的源代码中找到了这个密钥，但这是一个**私有**选项密钥，所以如果你使用它，你的应用程序可能会被 AppStore 拒绝。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-01-07T03:10:21.433

在 Swift 中回答，`AVURLAssetHTTPHeaderFieldsKey`选项将像一个魅力。

```
 let headers: [String: String] = [
    "custome_header": "custome value"
 ]
 let asset = AVURLAsset(url: URL, options: ["AVURLAssetHTTPHeaderFieldsKey": headers])
 let playerItem = AVPlayerItem(asset: asset)
 player = AVPlayer(playerItem: item) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-16T23:59:30.950

您需要通过通用 HTTP 连接机制自己请求数据，例如`NSURLConnection`. 如果`NSHTTPURLResponse`的标头通过了您的测试，那么您应该将其保存到`NSCachesDirectory`并将该资源的 URL 传递给`AVPlayer`类似这样：

```
NSData *data = //your downloaded data.
NSString *filePath = //generate random path under NSCachesDirectory
[data writeToFile:filePath atomically:YES];

AVPlayer *player = [AVPlayer playerWithURL:[NSURL fileURLWithPath:filePath]];
//... 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-01-19T22:23:33.173

我花了数周时间为 HLS 视频流寻找正式的方法。对于正在寻找一种适用于播放列表和块请求的请求和响应的方法的任何人，我能够找到有效的唯一方法是通过反向代理传递播放请求，使用它可以拦截请求，添加headers，将其发送到真实服务器，然后从响应中提取headers，然后将其返回给AVPlayer。

我在这里做了一个简单的示例项目（有很多评论和文档）： [https ://github.com/kevinjameshunt/AVPlayer-HTTP-Headers-Example](https://github.com/kevinjameshunt/AVPlayer-HTTP-Headers-Example)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-16T02:11:54.537

考虑使用`AVURLAsset`. 因为`AVURLAsset`您可以设置一个 resourceLoader 委托。在委托方法中，您可以手动发出请求并指定必要的标头。

**这种方法的好处是您可以完全控制数据加载。**

您必须使用自定义 url 方案才能使此解决方案正常工作（http 和 https 不会触发委托方法！）：

```
-(void) play {
  NSURL * url = [URL URLWithString:@"mycustomscheme://tungsten.aaplimg.com/VOD/bipbop_adv_fmp4_example/master.m3u8"];
  AVURLAsset * asset = [AVURLAsset URLAssetWithURL: options:nil];
  [asset.resourceLoader setDelegate:self queue:dispatch_queue_create("TGLiveStreamController loader", nil)];
  AVPlayerItem * playerItem = [AVPlayerItem playerItemWithAsset:asset];
  // Use player item ...
  ...
}

#pragma mark - AVAssetResourceLoaderDelegate

- (BOOL)resourceLoader:(AVAssetResourceLoader *)resourceLoader shouldWaitForLoadingOfRequestedResource:(AVAssetResourceLoadingRequest *)loadingRequest {
  dispatch_async(resourceLoader.delegateQueue, ^{
    NSURL * url = [URL URLWithString:@"https://tungsten.aaplimg.com/VOD/bipbop_adv_fmp4_example/master.m3u8"];
    NSMutableURLRequest *request = [loadingRequest.request mutableCopy];
    request.URL = url;

    // Add header
    [request setValue:@"Foo" forHTTPHeaderField:@"Bar"];

    NSURLResponse *response = nil;
    NSError *firstError = nil;

    // Issue request
    NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&firstError];

    [loadingRequest.dataRequest respondWithData:data];
    if (firstError) {
      [loadingRequest finishLoadingWithError:firstError];
    } else {
      [loadingRequest finishLoading];
    }
  });
  return YES;
} 
```

完整的代码示例可在[https://developer.apple.com/library/content/samplecode/sc1791/Introduction/Intro.html获得](https://developer.apple.com/library/content/samplecode/sc1791/Introduction/Intro.html)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-03-27T16:41:49.287

完整的代码看起来像这样

```
 #pragma Mark Sound Stuff

- (void)playSound:(NSString *)filePath
{
    AVPlayerItem *playerItem = [AVPlayerItem playerItemWithURL:[NSURL fileURLWithPath:filePath]];
    [playerItem addObserver:self forKeyPath:@"status" options:0 context:0];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(itemDidFinishPlaying) name:AVPlayerItemDidPlayToEndTimeNotification object:playerItem];
    self.audioPlayer = [[AVPlayer alloc] initWithPlayerItem:playerItem];
    [self.audioPlayer play];
}

- (void)initSoundPrelisten
{
    //NSLog(@"begin: %s", __FUNCTION__);
    self.activityIndicator.hidden = NO;
    [self.activityIndicator startAnimating];

    // verification delegate : register
    dataProtocol = [[StoreConnection alloc] init];
    [dataProtocol setDelegate:self];
    [dataProtocol requestDataFromServer:[NSString stringWithFormat:@"sound/%@/audio/sample", [self.sound objectForKey:@"globalId"]]];
}

- (void)dataSuccessful:(BOOL)success successData:(NSMutableData *)data;
{
    NSLog(@"%s", __FUNCTION__);
    if (success) {
        //NSLog(@"sound data: %@", data);
        NSString *cacheDirectory = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) objectAtIndex:0];
        NSString *filePath = [cacheDirectory stringByAppendingPathComponent:@"sample.mp3"];
        //NSLog(@"filePath: %@", filePath);
        [data writeToFile:filePath atomically:YES];
        [self playSound:filePath];

    } else
    {
        UIAlertView* alertView = [[UIAlertView alloc] initWithTitle:@"Store Error" message:[NSString stringWithFormat:@"An Error occured while trying to download sound. Please try again"] delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        alertView.tag = 1;
        [alertView show];
    }
} 
```

# javascript - Javascript 获取 URL 并发布到 iFrame 未验证

> ID：15456134
> 
> 赞同：0
> 
> 时间：2013-03-16T23:57:04.190
> 
> 标签：javascript, iframe, getelementbyid

此脚本在 jsFiddle 中运行，但不在浏览器上运行，并且不在 jsLint 上验证。

作为一个单独的目标，我想将相同的 URL 发布到 n 个 iFrame。但那是另一天，除非你想加入那个！

```
function handleClick() {
    var url = document.getElementById('url_textbox').value;
    document.getElementById('myForm').action = url;
    return true;
}

document.getElementById('myForm').addEventListener('submit', handleClick, false); 
```

[http://jsfiddle.net/xtpD5/19/](http://jsfiddle.net/xtpD5/19/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:05:47.280

它在 jsfiddle 中工作的原因是因为您`onLoad`设置了选项，这将在您的代码运行之前等待页面加载。`myForm`除非已经创建，否则您将无法获取具有 id 的元素。这可以通过将 js 放在元素下或通过事件侦听器等待文档加载来完成。

```
document.addEventListener('DOMContentLoaded', function(){
    document.getElementById('myForm').addEventListener('submit', handleClick, false);
}, false); 
```

[http://jsfiddle.net/xtpD5/20/](http://jsfiddle.net/xtpD5/20/)

# c# - 绑定到库中的图像（使用绝对路径）

> ID：15456135
> 
> 赞同：0
> 
> 时间：2013-03-16T23:57:06.993
> 
> 标签：c#, xaml, windows-8, windows-store-apps

我正在编写一个可以访问音乐库的音乐播放器。我想支持存储在轨道旁边的封面图像，例如：

*   专辑文件夹/
    *   轨道1
    *   轨道2
    *   **封面.jpg**

我有这些封面图像的绝对路径存储并转换为`Uri`我的视图模型上的对象。我尝试使用将这些绑定到`Image`XAML 中的 s，`UriSource`但图像保持空白。我还尝试`Source`使用 Uris 中的转换器绑定到`BitmapImage`类似的结果。在这两种情况下，我都没有遇到任何异常或绑定错误。

我知道我可以自己预加载图像并`BitmapImage`从s 创建`StorageFile`s 但我会重新*创建*已经到位的缓存系统。你对为什么会发生这种情况有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T08:34:56.263

我认为 Windows Store 应用程序中没有用于访问本地路径的 Uri 协议，AFAIK 它们仅适用[于 web、应用程序包和应用程序状态中的资源](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh965322%28v=win.10%29.aspx)。

可能您能做的最好的事情就是`BitmapImage`根据本地路径在视图模型中创建。像这样的东西应该工作：

```
var file = await StorageFile.GetFileFromPathAsync(filepath);
var stream = await file.OpenReadAsync();
var bitmap = new BitmapImage();
await bitmap.SetSourceAsync(stream); 
```

# jquery - 如何使用 css 和 jquery 创建一个 facebook 外观相似的画廊？

> ID：15456139
> 
> 赞同：-1
> 
> 时间：2013-03-16T23:58:14.683
> 
> 标签：jquery, html, css

我想在我的网站上添加一个限制宽度的照片库（高度无关紧要）。我尝试了很多类型的画廊，但所有这些都取决于照片的宽度或高度。然后我想“为什么不使用像 facebook 一样的模式？”，但我的问题是我不知道如何。我不需要像 facebook 这样复杂的画廊，但我需要自动调整大小的可点击照片（在相册中显示照片的小缩略图），当你点击它们以扩大到正常大小时，带有左右箭头。你能帮我实现我的目标吗？如果有不清楚的地方，请在评论部分问我，我的英语说得不太好。

PS：我所有的网站都是基于 html、jquery 和 css。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:24:57.980

您可以使用下面的 CSS 属性来重新缩放图像，尽管如上所述，这不会对您的加载时间有任何好处，如果您愿意深入研究 PHP，服务器端脚本将是一个更可取的选择。如果没有，请随意创建一个具有设置宽度和高度的 div 以及以下属性和背景图像，这应该可以工作。缺点是您可能无法在不使用 onClick/JavaScript 的情况下链接 div。

```
background-size: 100%; 
```

至于 jQuery，您可以使用[http://fancybox.net](http://fancybox.net)灯箱插件让您的用户单击“缩略图”，查看全尺寸图像并使用箭头键在图像之间切换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:09:32.967

最好的解决方案是有一个服务器端调整大小脚本，将您的图像缩放到预定义的约束（例如缩略图、预览和全尺寸）。有很多方法可以做到这一点，例如 PHP 的[http://www.reconn.us/image_thumbnail.html](http://www.reconn.us/image_thumbnail.html)。

更简单的方法是仅使用 CSS 样式属性让浏览器调整图像大小。这样做的缺点是服务器将始终发送大图像，无论您的用户是否想以全尺寸查看它们，但只需要您在 img 标签中设置宽度和高度。

# return - 正确使用 while (scanf(...)==0)

> ID：15456140
> 
> 赞同：0
> 
> 时间：2013-03-16T23:58:35.337
> 
> 标签：return, scanf

我有一个关于使用无效返回的 scanf 的问题。这是我正在测试的代码片段：

```
printf("Please enter a number\n");
while (scanf("%d",&number)==0)
{
    printf("Try again.\n");
    scanf("%d",&number);
} 
```

我的推理表明，如果使用了无效类型，我的第二个 scanf 应该再次询问并测试新输入的值。但是，情况并非如此，再试一次消息永远不会停止打印，因此我必须手动终止它。我不确定为什么会这样。如果可能的话，我不想在 while 循环之前使用 scanf，尽管我知道这是一种可能的解决方法。对于此事，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T00:00:07.740

`scanf`不返回错误代码。它返回成功执行的转换次数。

至于无限循环，它不会消耗无法转换的输入。所以它反复尝试将相同的字符串匹配为数字。尝试使用`fgets`丢弃有问题的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T22:37:34.597

`scanf()`可能会返回一个`EOF`以指示输入失败。

“如果在第一次转换（如果有）完成之前发生输入失败，则 scanf 函数返回宏 EOF 的值。否则，scanf 函数返回分配的输入项的数量，该数量可能少于提供的数量，甚至零，在早期匹配失败的情况下。” C11 7.21.6.4

使用`scanf("%d", ...`after a failed`scanf("%d", ...`只会导致无限循环，因为每个`scanf()`都试图消耗一个非数字、无空格和失败。为了解决这个问题，必须消耗有问题的数据。

```
printf("Please enter a number\n");
int number;
int Count;
while ((Count = scanf("%d",&number)) != 1) {
  if (Count < 0) {
    exit(1); // No more input possible
  }
  // Some char is preventing scanf() from reading an int
  scanf("%*c");  // Get it and throw away
  printf("Try again.\n");
}
printf("number = %d\n", number); 
```

# ios - 以编程方式向 UINavigationBar 添加提示

> ID：15456143
> 
> 赞同：8
> 
> 时间：2013-03-16T23:58:57.277
> 
> 标签：ios, uinavigationbar, prompt

如何以编程方式使我的 UINavigationBar（没有 UINavigationController）有一个提示 who's text value equals `webTitle`。

我试过以下没有运气：

```
self.navigationItem.prompt = webTitle; 
```

我能够创建提示的唯一方法是将以下设置应用于 IB 中的 NavigationBar。

![是的](../Images/050fc66c029bcf5d651e6c8aa9424b48.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-17T00:21:57.037

我假设您的 UINavigationBar 属于具有 webTitle 变量的任何内容。假设 UINavigationBar 作为一个名为 navigationBar 的属性存在，那么您可以使用它

```
self.navigationBar.topItem.prompt = webTitle; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-10-12T07:13:01.723

正确的方法是

```
self.navigationItem.prompt = @"Hello"; 
```

# python - 我如何知道哪个客户端正在向我的服务器传输数据？

> ID：15456144
> 
> 赞同：0
> 
> 时间：2013-03-16T23:59:08.830
> 
> 标签：python, sockets

我已经挖掘了一段时间，我已经有了很好的理解，没有什么能完全达到我想要做的事情：

我需要一个可以连接多个客户端的服务器。每隔一段时间，客户端就会向服务器查询一组要处理的新数字（本质上是分布式计算），然后服务器将其发送回查询的客户端。

我如何知道哪个客户端查询了服务器，以便我可以回复它？

我对 Python 还很陌生，select() 函数本身有点令人困惑。我能够接受新连接并获得输入，但服务器似乎不知道哪个客户端正在与它交谈（或者我的调试文本可能不正确，它确实知道？？）。

无论如何，这是服务器的代码：

```
while running:
    #select returns 3 subsets of the input containing sockets that have stuff to be read, empty buffer for writing, or an error
    readers, writers, error = select.select(input, output, errors)
    for s in readers:
        if s == serversocket:
            #readable server socket is ready for connection
            connection, client_addr = s.accept()
            print >> sys.stderr, 'new connection from', client_addr
            connection.setblocking(0)
            #clients.append([client_addr, performance])
            input.append(connection)
            output.append(connection)
        else:
            #readable socket, not ready for new connection
            data = s.recv(1024)
            print >> sys.stderr, "readable socket, not ready for new connection"
            if data:
                #the socket actually has data (put Compute process data into list)
                print >> sys.stderr, "Data received"
                substring = data[0:data.find("sss")];
                print >> sys.stderr, 'received %s from %s' % (substring, client_addr)
                if substring == "-get":
                    print >> sys.stderr, 'received -get command'
                    determinerange()
                    print >> sys.stderr, 'sending range of %d to %d', currentlow, currenthigh
                    temp = currentlow+"\0"
                    connection.send(currentlow)
                    temp = currenthigh+"\0"
                    connection.send(currenthigh)
                elif substring == "-k":
                    print >> sys.stderr, 'received -k, stopping' 
```

本质上，它接收某种命令，然后转身发送它需要的数据。如果您想知道，该服务器必须与我也在编写的 C 程序通信，该程序实际上进行计算。这就是为什么我要附加换行符“\0”字符。如果它从任何客户端接收到 -k，它需要停止每个客户端并退出。

注意：我只能使用标准的 python 库。我无法得到任何能让事情变得更容易的额外东西:)

提前感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:07:02.660

您不需要知道哪个客户。套接字是所有意图和目的的客户端。只需通过您收到请求的同一个套接字发送响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T00:37:06.367

尝试替换行：

```
 connection.send(currentlow)
                ...
                connection.send(currenthigh) 
```

经过：

```
 s.send(currentlow)
                ...
                s.send(currenthigh) 
```

这会将消息发送到您从中收到一些数据的当前客户端，而不是存储在变量连接中的客户端。

# git - Azure - 从 Bitbucket 部署

> ID：15456152
> 
> 赞同：6
> 
> 时间：2013-03-16T23:59:46.130
> 
> 标签：git, deployment, azure

我在 Windows Azure 上托管了一个网站，几个月前我将其设置为在我推送到 Bitbucket 上的特定分支时自动部署 - 按照以下说明：

[http://www.windowsazure.com/en-us/develop/net/common-tasks/publishing-with-git/#header-3](http://www.windowsazure.com/en-us/develop/net/common-tasks/publishing-with-git/#header-3)

上次我对网站进行任何更改时（2012 年 11 月 24 日），这一切正常。我刚刚推送了另一个更改，但尚未部署。再次返回设置，看起来该功能已从 Azure 仪表板中删除。我不再在快速浏览部分看到“设置 Git 发布”选项。

我已经用谷歌搜索，看看是否可以找到有关此功能被删除的任何参考，但我没有运气。有谁知道为什么突然我不能再从我的 Bitbucket 帐户进行部署，或者 Azure 控制面板中根本没有该功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T07:16:52.457

您可能已经丢失了 Azure 和 Bitbucket 之间的提交后挂钩。我发现这种情况有时也会发生在我身上。如果您在 Bitbucket 存储库设置中查看“服务”页面，则应该有一个到 Azure 的 POST 挂钩。如果钩子在那里，我会删除它，然后清除 Azure 站点中的部署文件夹以重置它。

如果您通过 FTP 进入您的站点并清除部署文件夹（会有一堆名为 guid 的文件夹代表已发生的部署），然后返回并刷新仪表板页面，您应该会看到设置 Git 的选项发布再次出现。

# java - Java中SortedList的插入和删除方法是如何工作的

> ID：15456153
> 
> 赞同：0
> 
> 时间：2013-03-16T23:59:55.703
> 
> 标签：java, sortedlist

这更多是因为我缺乏理解 SortedList 类的能力。我理解的 ListNode：它是一个由两件事组成的节点：一个可比较的对象和一个 ListNode 对象，它本身具有相同的两件事。

我不明白下面的 SortedList 类中的插入和删除方法是如何工作的。理解起来非常复杂。在 SortedList 类中，如果 head 为 null，则指向 curr。curr 不应该为空吗？那么while循环不应该执行，但实际上当我使用println测试执行时它确实执行了。

ListNode 类的代码：

```
public class ListNode {

    private Comparable data;
    private ListNode next;

    public ListNode() {
        data = null;
        next = null;
    }

    public ListNode(Comparable x) {
        data = x;
        next = null;
    }

    public ListNode(Comparable x, ListNode nextListNode) {
        data = x;
        next = nextListNode;
    }

    public Comparable getData() {
        return data;
    }

    public ListNode getNext() {
        return next;
    }

    public void setData(Comparable x) {
        data = x;
    }

    public void setNext(ListNode nextListNode) {
        next = nextListNode;
    }

} 
```

排序列表的代码：

```
public class SortedList {

    private ListNode head;

    public SortedList() {
        head = null;
    }

    public void insert(Comparable x) {
        ListNode curr = head, prev = null;
        while (curr != null && x.compareTo(curr.getData()) > 0) {
            prev = curr;
            curr = curr.getNext();
        }
        if (prev == null) {
            head = new ListNode(x, curr);
        } else {
            prev.setNext(new ListNode(x, curr));
        }
    }

    public boolean delete(Comparable x) {
        if (head == null) {
            return false;
        }
        ListNode curr = head, prev = null;
        while (curr != null && x.compareTo(curr.getData()) > 0) {
            prev = curr;
            curr = curr.getNext();
        }
        if (curr == null || x.compareTo(curr.getData()) != 0) {
            return false;
        }
        if (prev == null) {
            head = curr.getNext();
        } else {
            prev.setNext(curr.getNext());
        }
        return true;
    }

    public void output() {
        for (ListNode curr = head; curr != null; curr = curr.getNext()) {
            System.out.println(curr.getData());
        }
    }

} 
```

TestSortedList 的代码：

```
public class TestSortedList {

    public static void main(String[] args) {
        SortedList list = new SortedList();
        list.insert(5);
        list.insert(1);
        list.insert(10);
        list.insert(3);
        list.insert(7);
        list.output();
        System.out.println(list.delete(5));
        System.out.println(list.delete(5));
        System.out.println(list.delete(1));
        System.out.println(list.delete(10));
        System.out.println(list.delete(11));
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:35:41.917

`curr`是`null`第一次调用的时间`insert`。所以`while`这次被忽略了。

但是当`prev == null`评估为真时，如果块被执行，本质上是执行这一行：

```
head = new ListNode(x, curr); 
```

这样，`head`没有更多的剩余`null`，任何进一步的调用都`insert`可能导致`while`循环被执行。循环是否`while`会被执行取决于这个表达式：

```
x.compareTo(curr.getData()) > 0 
```

If `true`,`while`被执行，否则不执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T00:20:49.940

在第一条语句中，您的 while 循环具有：

```
while(curr != null && x.compareTo(curr.getData()) >0 ) 
```

当您调用 x.compareTo(curr.getData()) 时，您将 5 与 null 进行比较，返回 1。大于 0，因此一半的要求为真，但它仍然跳过 while 循环并继续执行

```
 if (prev == null) {
        head = new ListNode(x, curr); 
```

这个动作给 head 一个值，它不再是 null。所以当你做第二次插入时，你做

```
ListNode curr = head; 
```

这次 curr 不为空，允许它进入循环

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T00:38:53.760

您需要分解（例如）该`insert`方法的功能。

*   新节点将（通常）插入两个节点*之间*......除非您最终插入列表的开头和结尾。

*   局部变量初始化设置了一些东西，以便我们开始查看循环的开头。该`prev`变量将指向插入点*之前的节点。*该`curr`变量将指向插入点*之后的节点。*

*   `while`循环找到插入点。它遍历列表节点，直到找到一个大于或等于的节点`x`。插入点*在*该节点之前。如果列表为空（即为`head`）`null`，则插入点是列表的开头。当它完成时（包括它从不运行的情况），`prev`并且`curr`将具有最终部分所需的值......

*   `prev`while 循环之后的代码进行插入，在节点和节点之间插入新`curr`节点。如果`prev`是`null`，它必须以不同的方式处理事情。

* * *

所以回答你的问题：

> 但是哪个代码使 curr 不为空呢？

没有代码可以做到这一点。它不需要不为空。

在您实际进行插入的那一点，`curr`是插入点之后的节点。如果您在列表末尾插入（或插入空列表），则插入点之后没有节点，并且`curr`将（并且应该）是`null`.

* * *

插入单链表有点棘手，但要记住的关键是任何算法都需要在要插入新节点的位置*之前找到并更新节点。*删除也是如此。

# python - python dict.update 与下标添加单个键/值对

> ID：15456158
> 
> 赞同：58
> 
> 时间：2013-03-17T00:00:33.510
> 
> 标签：python, dictionary

每个学期我至少有一个 Python 学生`dict.update()`用来添加一个键/值对，即：

```
mydict.update({'newkey':'newvalue'}) 
```

代替

```
mydict['newkey'] = 'newvalue' 
```

我不教这种方法，也不知道他们在哪里找到这样的例子，但我告诉他们不要这样做，因为它效率较低（可能会创建一个新的 2 元素字典）并且因为它是非标准的。

老实说，我可以理解使用可见方法而不是这种语法的愿望——它可能感觉与其他方法调用更一致。但我认为这看起来像是一种新手方法。

在这一点上，有人可以提供任何智慧吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-03-17T00:09:35.437

基准测试表明您对其性能影响的怀疑似乎是正确的：

```
$ python -m timeit -s 'd = {"key": "value"}' 'd["key"] = "value"'
10000000 loops, best of 3: 0.0741 usec per loop
$ python -m timeit -s 'd = {"key": "value"}' 'd.update(key="value")'
1000000 loops, best of 3: 0.294 usec per loop
$ python -m timeit -s 'd = {"key": "value"}' 'd.update({"key": "value"})'
1000000 loops, best of 3: 0.461 usec per loop 
```

也就是说，它在我的机器上慢了大约六倍。但是，如果您需要最高性能，Python 已经不是您会使用的语言，所以我只建议使用在这种情况下最易读的语言。对于很多事情来说，这将是`[]`一种方式，尽管`update`在这样的情况下可能更具可读性：

```
configuration.update(
    timeout=60,
    host='example.com',
) 
```

…或类似的东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-17T00:06:01.107

直接更新密钥的速度是原来的三倍，但是 YMMV：

```
$ python -m timeit 'd={"k":1}; d.update({"k":2})'
1000000 loops, best of 3: 0.669 usec per loop

$ python -m timeit 'd={"k":1}; d["k"] = 2'
1000000 loops, best of 3: 0.212 usec per loop 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-17T00:08:27.570

有些人认为 []= 在面向对象语言或任何其他语言中不是有效的句法元素。我记得几十年前我在 APL 语言开发工作时听到过这个论点。该语法是 Fortran 的保留...

我个人并不赞同这种观点，并且对索引分配非常满意。但是有些人会声称真正的方法调用更好。当然，拥有多个解决方案总是好的。

编辑：这里真正的问题是可读性，而不是性能，索引作业一直存在，因为许多人发现作业更容易阅读，即使理论上不太正确。

# algorithm - 最大 K 个子数组总和

> ID：15456164
> 
> 赞同：3
> 
> 时间：2013-03-17T00:01:26.020
> 
> 标签：algorithm, sum, dynamic-programming, max, arrays

我在处理这个问题的记忆和自下而上的方法算法时遇到了麻烦：

假设您有一个元素数组，`xi`例如`-10000 < xi < 10000`,for all `0 < i < N`。尝试找到 T 个元素的最大和，T < N 使得它们排列在不同的子数组中。我们不对每个子数组中的第一个元素求和，我们必须返回子数组的数量 K 为出色地。

一个例子应该解释：

`T=4, array = 3 9 1 1 7 => (3 9) and (1 7) have maximum sum 16= 9 + 7 ,K = 2`

`T=4, array = 3 9 6 3 7 => (3 9 6 3) have maximum sum 18 = 9 + 6 + 3 , K = 1`

*T = 9, array = 14 11 18 1 1 16 12 18 0 0 11 18 9 5 14 => 连续子数组是 (14 11 18) (1 16 12 18) (11 18) K=3 和 max_sum =11 + 18 + 16 + 12 + 18 + 18 = 93 ** **对于 T=15 数组 = 6 19 -29 15 9 -4 5 27 3 12 -10 5 -2 27 10 -2 11 23 -4 5 => 连续子数组是 (6 19) (-29 15 9) (5 27 3 12) (-2 27 10) (-2 11 23)，其中 K =5 和 max_sum= 19 + 15 + 9 + 27 + 3 + 12 +27 + 10 + 11 + 23=156

这是我到目前为止所做的：

`let f[i][j][0] denotes the maximal sum for the first i slots and using j slots, and the i-th slot is not used.`

`let f[i][j][1] denotes the maximal gain for the first i slots and using j slots , and the i-th slot is used.`

显然，`f[i][j][k]`可以确定`f[i+1][j][k]`或`f[i+1][j+1][k]`

细节：

```
 f[i+1][j+1][1]=max(f[i+1][j+1][1],f[i][j][0],f[i][j][1]+G[i+1]);
    f[i+1][j][0]=max(f[i+1][j][0],f[i][j][0],f[i][j][1]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:23:19.807

这是 Haskell 中的一个版本。'partitions' 函数由 Daniel Fischer 编写，它以所有可能的方式对列表（或数组）进行分区。其余代码测试长度大于 1 的元素的分区，其组合长度与 T 匹配，并返回总和最大的分区（按要求求和，没有第一个数字）。

```
import Data.List (maximumBy)
import Data.Ord (comparing)

partitions [] = [[]]
partitions (x:xs) = [[x]:p | p <- partitions xs]
                 ++ [(x:ys):yss | (ys:yss) <- partitions xs]

findMax t xs = 
  let toTest = filter (\z -> (sum $ map length z) == t) 
               $ map (\x -> filter (\y -> length y > 1) x) 
               $ partitions xs
      result = maximumBy (comparing snd) 
               (zip toTest (map (\x -> sum $ map (sum . drop 1) x) toTest))
  in putStrLn( 
       show result 
       ++ " K = " 
       ++ show (length $ fst result))

OUTPUT:
*Main> findMax 4 [3,9,1,1,7]
([[3,9],[1,7]],16) K = 2

*Main> findMax 4 [3,9,6,3,7]
([[3,9,6,3]],18) K = 1

*Main> findMax 9 [14,11,18,1,1,16,12,18,0,0,11,18,9,5,14]
([[14,11,18],[1,16,12,18],[11,18]],93) K = 3 
```

# python - python周期性循环成语？

> ID：15456166
> 
> 赞同：4
> 
> 时间：2013-03-17T00:01:41.043
> 
> 标签：python, python-3.x

我有一个工作单元，我希望每 N 秒发生一次。如果我使用简单的

```
minute = 60
while True:
    doSomeWork()
    time.sleep(minute) 
```

根据需要多长时间`doSomeWork()`，实际循环周期将是一分钟加上该时间。如果 doSomeWork() 所花费的时间不是确定性的，那么工作的周期就更不可预测了。

我想做的是这样的

```
minute = 60
start = time.process_time() #? i can imagine using this, but maybe there's something better?
while True:
    doSomeWork()
    start += minute
    sleep_until(start) #? this is the function I'm in search of 
```

（我正在使用 python 3.3）

**更新：**

在 Linux/OSX 上，我可以使用信号中的计时器来做我正在寻找的事情：

```
import signal
import datetime

def tick(_, __):
    # doSomeWork()
    print(datetime.datetime.now())

signal.setitimer(signal.ITIMER_REAL, 60, 60)
signal.signal(signal.SIGALRM, tick)

while True:
    signal.pause() 
```

看起来为 python3.4 开发的郁金香的东西也会让这很容易做到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T00:04:56.403

`sleep_until(timestamp)`基本上是`time.sleep(timestamp - time.time())`。

你的代码实际上很好（确保你不会通过消极的时间去睡觉仍然是一个好主意）：

```
import time

minute = 60
next_time = time.time()
while True:
    doSomeWork()
    next_time += minute
    sleep_time = next_time - time.time()
    if sleep_time > 0:
        time.sleep(sleep_time) 
```

我个人会制作一个 60 秒间隔的时间戳生成器并使用它：

```
import time
import itertools

minute = 60

for next_time in itertools.count(time.time() + minute, minute):
    doSomeWork()
    sleep_time = next_time - time.time()
    if sleep_time > 0:
        time.sleep(sleep_time) 
```

# php - php-include 之后没有显示任何内容

> ID：15456173
> 
> 赞同：0
> 
> 时间：2013-03-17T00:03:10.697
> 
> 标签：php, html, mysql

我试图在另一个文件中包含一个 php 文件（作为第一件事），因为我需要变量，它们是 MySQL 语句的结果。这是包含的文件：

索引.php：

```
 <?php 
    error_reporting(E_ALL); //No errors are shown
    require($_SERVER['DOCUMENT_ROOT']."php/db/acp_settings_db_conn.php");
    echo $_SERVER['DOCUMENT_ROOT']; //doesn't work
    ?> /*  * some html code, which isn't shown either  */ 
```

这是包含的文件：

```
<?php
//Get configuration values (static) from file
require_once($_SERVER['DOCUMENT_ROOT']."acp_settings_db_conf.php");
//Create new object out of connection to db
$db = @new mysqli(MYSQL_HOST, MYSQL_USER, MYSQL_PASS, MYSQL_DB);
//If there aren't any errors
if(mysqli_connect_errno() == 0){
    //Write query, in this case get every row from table
    $query = 'SELECT * FROM `meta`';
    //If you could prepare query
    if($meta_settings = $db->prepare( $query )){
        //Execute query
        $meta_settings->execute();          
        //Bind results to custom variables
        $meta_settings->bind_result($html_language, $site_author, $site_keywords);  
        //Fetch result
        $meta_settings->fetch();
    } else { //If you couldn't prepare query
        echo "There is a problem with the query";
    }

} else { //If you couldn't connect to DB at all
    die("No connection possible: " . mysqli_connect_error());
}
//Close connection
$db->close();
?> 
```

包含的文件工作得很好（用回声检查），现在包含也工作了（如果我在包含的文件中有回显的东西，它会在 index.php 上弹出）。但是在包含之后，什么都没有显示。所以没有 php 代码在工作，也没有显示任何 html。我尝试了一个包含'file.php'，但这也不起作用。

因此，由于我在此度过了一个晚上，如果有人可以帮助我，我会很高兴。这些是我在 PHP 中的第一步，所以要温柔；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:09:20.953

尝试添加 DIRECTORY_SEPARATOR。

```
require($_SERVER['DOCUMENT_ROOT'] . DIRECTORY_SEPARATOR . "php/db/acp_settings_db_conn.php"); 
```

# jsf - 使用 JBoss 设置 JSF 时出现 StackOverflowError

> ID：15456174
> 
> 赞同：0
> 
> 时间：2013-03-17T00:03:14.443
> 
> 标签：jsf, jboss, jboss5.x

我尝试让 JSF 与 JBoss (5.1) 一起运行，但我有两个问题。要么我得到一个在 faces-config.xml 中配置的 FaceletViewHandler 的类未找到异常，要么我得到一个无限数量的 StackOverflowError。

错误：

```
00:48:30,767 ERROR [[Faces Servlet]] Servlet.service() for servlet Faces Servlet threw exception
java.lang.StackOverflowError
....
at org.apache.catalina.core.ApplicationHttpRequest.setAttribute(ApplicationHttpRequest.java:279)
... 
```

我认为这与我的 web.xml 配置或 faces-config.xml 有关

web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
    <display-name>test1</display-name>
    <context-param>
        <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
        <param-value>server</param-value>
    </context-param>
    <context-param>
        <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
        <param-value>.xhtml</param-value>
    </context-param>
    <listener>
        <listener-class>com.sun.faces.config.ConfigureListener</listener-class>
    </listener>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>
</web-app> 
```

*我找到了一个“解决方案”，它说 url 模式应该与默认后缀不同 - 它没有帮助*

faces-config.xml：

```
<?xml version='1.0' encoding='UTF-8'?>
<faces-config version="1.2" 
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_1_2.xsd">
  <application>
        <view-handler>com.sun.facelets.FaceletViewHandler</view-handler>
    </application>
</faces-config> 
```

在 POM.XML

```
....
    <dependency>
      <groupId>com.sun.facelets</groupId>
      <artifactId>jsf-facelets</artifactId>
      <version>1.1.15</version>
    </dependency>
.... 
```

怎么了？

问候 D3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T18:50:06.793

StackOverflowError 告诉我们线程在堆栈上没有足够的可用内存。也许您应该使用 -Xss JVM 选项（例如 -Xss256k 甚至更多）增加可用于线程的堆栈。

您应该在 run.conf.bat 或 run.conf.sh 中设置它，具体取决于您的操作系统。

您还可以尝试通过将 javax.faces.STATE_SAVING_METHOD 从“服务器”设置为“客户端”来节省服务器资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T10:19:35.613

我找到了解决方案-至少是一种解决方法。我从JDK7改回JDK6，现在一切正常。

我认为需要重新设置项目并非常仔细地检查所有包含库的版本。

# d3.js - d3 和 Leaflet 之间的 GeoJSON 映射差异

> ID：15456176
> 
> 赞同：5
> 
> 时间：2013-03-17T00:03:30.337
> 
> 标签：d3.js, leaflet, geojson

我的目标是使用 d3 为给定 GeoJSON 特征集合中的每个特征生成 svg 路径。

当我使用传单映射路径时，所有功能看起来都很完美。

```
d3.json("ct_counties.geo.json", function(data) {
    var leaflet_paths = leaflet_map.addLayer(new L.GeoJSON(data));
}); 
```

![两张地图](../Images/3c645c7c41483cf70fb76d51f666452d.png)

但是当我使用 d3 映射路径时，某些功能看起来是错误的。

```
d3.json("ct_counties.geo.json", function(collection) {
    var bounds = d3.geo.bounds(collection);

    var path = d3.geo.path().projection(project);

    var feature = g.selectAll("path")
        .data(collection.features)
      .enter().append("path")
        .attr('class','county');

    d3_map.on("viewreset", reset);

    reset();

    function project(x) {
      var point = d3_map.latLngToLayerPoint(new L.LatLng(x[1], x[0]));
      return [point.x, point.y];
    }

    function reset() {
      var bottomLeft = project(bounds[0]); 
      var topRight = project(bounds[1]);
      svg.attr("width", topRight[0] - bottomLeft[0])
        .attr("height", bottomLeft[1] - topRight[1])
        .style("margin-left", bottomLeft[0] + "px")
        .style("margin-top", topRight[1] + "px");
      g.attr("transform", "translate(" + -bottomLeft[0] + "," + -topRight[1] + ")");
      feature.attr("d", path);
    }
}); 
```

[在此处](http://s2t2.github.com/freezing-bear/)查看地图差异。

并参考[这里](https://github.com/s2t2/freezing-bear/blob/master/index.html)的完整代码。

既然两张图都使用同一个特征集合，为什么d3版本会出错呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-17T11:43:54.187

D3没有错，数据不正确，Leaflet比较宽松。

以利奇菲尔德（左上县）为例：

```
{
    "type" : "Feature",
    "properties" : {
        "kind" : "county",
        "name" : "Litchfield",
        "state" : "CT"
    },
    "geometry" : {
        "type" : "MultiPolygon",
        "coordinates" : [ [ [ [ -73.0535, 42.0390 ], [ -73.0097, 42.0390 ],
                [ -73.0316, 41.9678 ], [ -72.8892, 41.9733 ],
                [ -72.9385, 41.8966 ], [ -72.9495, 41.8090 ],
                [ -73.0152, 41.7981 ], [ -72.9823, 41.6392 ],
                [ -73.1631, 41.5571 ], [ -73.1576, 41.5133 ],
                [ -73.3219, 41.5078 ], [ -73.3109, 41.4694 ],
                [ -73.3876, 41.5133 ], [ -73.4424, 41.4914 ],
                [ -73.4862, 41.6447 ], [ -73.5191, 41.6666 ],
                [ -73.4862, 42.0500 ] ] ] ]
    }
} 
```

多面体不是闭合的，它的结束不等于开始。我绘制了坐标，将第一个坐标标记为红色，最后一个坐标标记为绿色： ![多面体中的点](../Images/709bf54aef11a20623dc2c595ae0693d.png)

如您所见，最后一个坐标被 d3 丢弃。

GeoJSON[规范](http://www.geojson.org/geojson-spec.html#linestring)说

> LinearRing 是具有 4 个或更多位置的封闭 LineString。第一个和最后一个位置是等价的（它们代表等价点）。

所以 d3 有一个点（没有双关语），应该通过在末尾添加起始坐标来关闭 MultiPolygon：

```
...[ -73.4862, 42.0500 ], [ -73.0535, 42.0390 ] ] ] ] 
```

# c# - 有JS代码，但需要从C#调用

> ID：15456178
> 
> 赞同：-2
> 
> 时间：2013-03-17T00:03:45.033
> 
> 标签：c#, javascript, wcf

我有一个大的 .js 文件，其中包含一个函数和一个方法。我对 JS 很熟悉。我有一个 WCF web 方法，我想调用这个 js 方法... JS 文件中的示例是这样调用它：

> ```
> var wmm = new WorldMagneticModel();
> 
> then
> 
> var dec = wmm.declination(0.0, 59.0, -2.0, 2010.5); 
> ```

我在 js 文件中的函数中看到了方法调用：

```
WorldMagneticModel.prototype.declination = function(altitudeKm, latitudeDegrees, longitudeDegrees, yearFloat) 
```

我希望此方法可用于我的 c# Web 服务。有什么办法吗？也许我需要制作一个 ASP.net 页面，嵌入 js，然后调用它？

希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:30:42.487

如果你想在服务器端运行它，你可以使用[Jint](http://jint.codeplex.com/)：

```
JintEngine engine = new JintEngine();
// source should be a string containing the contents of your JavaScript file
engine.Run(source);
engine.SetParameter("altitudeKm", altitudeKm);
engine.SetParameter("latitudeDegrees", latitudeDegrees);
engine.SetParameter("longitudeDegrees", "longitudeDegrees");
engine.SetParameter("yearFloat", yearFloat);
var result = engine.Run(@"
    var wmm = new WorldMagneticModel();
    return wmm.declination(altitudeKm, latitudeDegrees, longitudeDegrees, yearFloat);
");
return result; 
```

# unix - 替代慢 grep

> ID：15456180
> 
> 赞同：0
> 
> 时间：2013-03-17T00:03:51.873
> 
> 标签：unix, command-line, grep

目前我有一个系统日志（在这种情况下是 Growl.app），我想不时查看它。我使用 grep 过滤掉我不想看到的行。

```
cat /Users/Daniel/Library/Logs/Growl.log | grep -vE 'registered|Display frame|Reserving|Used rects|Beginning a pass|Successfully reserved|Adjusted display frame|---|User went idle|User returned|positionDisplay|primaryDirection|Bowtie:|secondaryDirection' | tail -20 > /Users/Daniel/Library/Logs/Growl-log.txt
sleep 2
qlmanage -p /Users/Daniel/Library/Logs/Growl-log.txt 
```

我不确定是否有更好的方法来过滤信息，但因为它是我的脚本需要相当多的时间来处理该命令。我不妨添加我的硬件绝对不会阻止它。需要注意的另一件事是“qlmanage”部分是 OS X 特定的命令，它在“快速查看”窗口中显示文本文件的内容。显示请求时是瞬时的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:27:12.240

您要求系统读取一个非常大的、可能持续增长的文件，根据大量搜索删除一堆记录（每次交替：|z|c|V ..etc）。每次你要求它运行时，它都必须通过更多的记录。

日志有时间戳吗？结合时间戳（甚至更好，tail）、grep，您可以每天或每小时为您运行一个作业，在一个小得多的文件中包含您想要的内容。

基本上，您无法在几秒钟内完成您所要求的所有操作，读取 100 的 MB。让我们从 tail 开始，它通过定位文件指针而不是读取整个文件来工作。快点。

```
tail -20000 /Users/Daniel/Library/Logs/Growl.log | 
grep -vE 'registered|Display frame|Reserving|Used rects|Beginning a pass|Successfully reserved|Adjusted display frame|---|User went idle|User returned|positionDisplay|primaryDirection|Bowtie:|secondaryDirection' |
> /Users/Daniel/Library/Logs/Growl-log.txt
qlmanage -p /Users/Daniel/Library/Logs/Growl-log.txt 
```

调整 20000 以获得合理数量的通过过滤器的样本。换句话说`prefilter`，通过删除您无论如何都会投放的早期记录来保存文件。

另一个加速是做一个积极的搜索 - grep 你想要什么，而不是你不想要什么。

恭喜你。你也获得了UUOC奖。试试谷歌先生这个词`UUOC`（与猫有关）。每个人都在了解之前获得了奖项

# visual-c++ - MCI 加载视频文件

> ID：15456181
> 
> 赞同：0
> 
> 时间：2013-03-17T00:03:55.737
> 
> 标签：visual-c++, media-player, mci

我正在尝试在我的 Visual c++ 应用程序中加载然后播放带有 mci 的视频文件，但 mciSendString() 方法一直失败并返回错误代码。错误代码是 259，意思是“MCIERR_UNRECOGNIZED_KEYWORD”。命令和格式对我来说看起来不错，当我通过它进行调试时，文件名会正确放置在命令字符串中。我不确定是什么原因造成的。

```
bool Player::Load(String^ fileName)
{
DWORD dwReturn = 0;
CString myStr(fileName);
CString strCommand;
strCommand.Format(L"Open %s type avivideo alias AVIFile", myStr);

dwReturn = mciSendString(strCommand, NULL, 0, NULL);

if (dwReturn)
    return false; // An error has occurred while trying to open the video file

return true; 
```

}

# java - 另一个数组中的数组有什么缺点？

> ID：15456188
> 
> 赞同：0
> 
> 时间：2013-03-17T00:05:08.667
> 
> 标签：java, arrays, multidimensional-array

假设我有这行代码：

```
 Object [] b = {3,new int[]{12,34,34},new int[][]{{1,2},{2,3}}}; 
```

我的问题是：

*   为什么我没有看到程序员使用这样的东西它有什么问题，并且 java 有另一种更好的方法来实现它吗？

*   如何获取所有值，包括（数组和矩阵）？

*   内存如何将位置提供给数组内的 Matrix ？

    如果你给我一个真实的例子，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:06:30.443

该片段（就像它最初的样子）是（是）非法的，因为整数数组只能包含*整数*，而不是整数数组。

如果您声明为*对象*`b`数组，则代码是合法的。您不会倾向于在程序中看到这样的代码，因为在容器中混合不同类型的对象很少有用（通常您需要特定类型对象的集合）并且具有潜在危险（您不能使用编译器来保证您不会不小心将一些意外放入数组中）。

 ***如何获取所有值？**

您可以使用使用反射或`instanceof`运算符的递归方法来检查当前元素是否为数组。

**内存如何将位置提供给数组内的 Matrix ？**

Java 没有矩阵，只有包含指向其他数组的指针的数组。*

# asp.net - 简单 - LinqToTwitter 对象和属性

> ID：15456190
> 
> 赞同：0
> 
> 时间：2013-03-17T00:05:22.130
> 
> 标签：asp.net, linq-to-twitter

我第一次尝试使用 LinqToTwitter，但我对它的对象和属性有疑问。

如果有人有指向对象列表及其属性的链接，那将是完美的。

目前，我正在尝试使用[THIS](http://linqtotwitter.codeplex.com/SourceControl/changeset/view/ffbabcf9f7d3#ReadMe.txt)作为指南。这是我找到的最接近的。我正在查看“LinkToTwitterAG”部分。不确定 AG 代表什么，但这给出了一个对象列表。

我的最终目标是在 ListView 中显示用户的用户名和他们的状态列表。我当前的数据绑定列表项代码是

' /> ' />

Eval(" ") 中的文本代表我希望显示的“Object.Property”。它默认为“LinqToTwitter”命名空间。因此，按照我上面链接的代码，LinqToTwitter.Contributor.ScreenName 应该是有效的，但是在调试期间我收到一个错误，说 LinqToTwitter.Contributor 无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:30:05.823

LINQ to Twitter 有一个[制作 API 调用文档](http://linqtotwitter.codeplex.com/wikipage?title=Making%20API%20Calls)页面，其中包含所有可用的命令和查询及其相关参数。每个 API 还具有指向它返回的实体类型的链接。API 文档的另一个功能是在每个页面底部提供指向相应 Twitter API 文档的链接。您还可以检查[LINQ to Twitter 实体](http://linqtotwitter.codeplex.com/wikipage?title=LINQ%20to%20Twitter%20Entities)页面以了解这些对象及其属性。

除了[通用文档](http://linqtotwitter.codeplex.com/documentation)之外，可[下载的源代码](http://linqtotwitter.codeplex.com/SourceControl/changeset/view/ffbabcf9f7d3#ReadMe.txt)还包括每个 API 调用的示例，以及如何使用各种参数的大量示例。还有一个[示例](http://linqtotwitter.codeplex.com/wikipage?title=LINQ%20to%20Twitter%20Samples)页面，您可以在其中找到更多分解为 LINQ to Twitter 支持的各种技术的演示。

# c++ - 替换 C++ 中表达式的内容 [std::regex]

> ID：15456191
> 
> 赞同：1
> 
> 时间：2013-03-17T00:05:40.710
> 
> 标签：c++, regex, string, replace, semantics

假设我们有字符串`ONE|(TWO|(THREE|FOUR))`......
知道 std::regex**不**支持递归，我们如何将这个字符串分解为字符串的 std::vector，其中（按顺序）包含：

*   `THREE|FOUR`
*   `TWO|{0}`
*   `ONE|{1}`

以上述方式转换 this 的目的是创建一个可遍历的表达式列表，该列表应在语义上表示嵌套的 if/then 语句。如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T13:42:05.647

使用正则表达式库进行词法分析是一种可怕的方式来处理任何不平凡的事情。当您找到匹配项时，如果不进行一些后期处理，您将不会知道*匹配的内容。*如果您不想使用第三方库，那么您需要认真问自己是否要为初学者编写自己的词法分析器生成器。如果您想这样做，我很乐意为您提供建议。

一旦你有可靠的词法分析工作，你会发现下一部分要容易得多。然后，您可以编写一个临时解析器或继续编写您自己的解析器生成器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T01:52:14.267

由于您首先想要最内部的内容，因此您可以利用惰性/不贪婪的 RegEx 行为并将所有内容匹配到 a `)`with`(.*?)\)`或除圆括号之外的所有内容 with `\([^\)\(]+`。

伪代码：

```
while ( regex_match(string, regex) ) {
    add matches to vector
    replace matches in string with vector index in curly brackets
} 
```

`((?:\(|^)[^\)\(]+(?:\)|$))`
正则表达式示例：正则表达式演示：[http](http://regex101.com/r/pJ4pO7) : //regex101.com/r/pJ4pO7

# macos - 缓存打包的 NSDocument 文件格式设计

> ID：15456196
> 
> 赞同：0
> 
> 时间：2013-03-17T00:05:58.587
> 
> 标签：macos, cocoa, package, sync, nsdocument

我正在设计一种基于打包的 NSDocument 文件格式。该文档将包含许多目录和文件，因此我想保存一个缓存，或者作为文档的一部分，或者在应用程序的 Caches 目录中。

缓存将是一个简单的 plist 数组。

我想设计这个，以便可以通过 Dropbox 或 iCloud 同步文档。所以我遇到了一个难题……缓存失效。

如果我将缓存存储在文档包中，如果文档同时在两台机器上编辑，其中一台可能会覆盖另一台的缓存，或者它们可能需要解决冲突。

如果我将缓存存储在外部缓存目录中，可能基于文档名称或文件标识符命名，我需要一些方法来检测如果文档在其他地方更新（通过同步甚至只是从电子邮件复制的较新版本）它是陈旧的）。

外部缓存也有其他问题，例如我考虑在文档中存储 UUID 并将其用作缓存文件名，但如果文档重复，缓存将被两个文档使用，这显然是错误的被编辑。

在我看来，最安全的地方是在文档包中，但随后又回到了可能的冲突。

我还想知道如何检测变化。一个过于复杂的想法是每次保存时将一个以 UUID 命名的文件写入文档中的文件夹，然后如果那里的文件数量发生变化，则重建缓存。（更简单的方法是文档中的更改计数，但如果两台机器同时增加计数并保存，这可能会导致冲突，请记住可能存在同步延迟。）

在我看来，安全同步文档包并不是一个不常见的问题，所以我希望有人可以提供一些最佳实践建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:02:39.503

使用 Dropbox，您会遇到无法自动更改文档包的问题。也就是说，如果保存您的文档涉及更改 N 个文件，然后再次保存涉及更改 M 个不同的文件，Dropbox 将按照它想要的任何顺序同步这些 N+M 个更改的文件，您无法判断一个文档级别的保存在哪里结束，而下一个开始，或者您当前是否看到完整的保存或一些中间值，其中您有一些更新的文件但还没有看到其他文件。

iCloud 知道文档包，但至少现在，您偶尔会看到虚假的冲突或“进入云端”的更改，并且似乎迷失了方向，再也不会回来了。调试这类情况非常非常困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-02T15:45:57.347

不要将缓存存储在文档包中。您应该将其存储在 Caches (NSCachesDirectory) 目录中。

要安全地将缓存与文档关联，您可以创建基于文档的文件系统路径的缓存文件名。例如，通过创建作为路径哈希的后缀。这意味着如果文档被移动（在您的应用程序之外），则必须重新创建缓存 - 但这似乎是一个合理的权衡。

Xcode 将项目相关文件缓存在一个目录`DerivedData/<project name>-<identifier>`中。如果您查看该目录，您会发现一个包含 Xcode 项目路径的 info.plist 文件 - Xcode 可能使用它来验证缓存是否属于该项目。奇怪的是，有人对 Xcode 用来创建标识符的函数进行了逆向工程，并将其发布在此博客上：[https](https://pewpewthespells.com/blog/xcode_deriveddata_hashes.html) ://pewpewthespells.com/blog/xcode_deriveddata_hashes.html 。

# xaml - Windows Phone - XamlParseException

> ID：15456201
> 
> 赞同：1
> 
> 时间：2013-03-17T00:06:30.460
> 
> 标签：xaml, windows-phone-8, windows-phone, silverlight-toolkit

我在导航到我的页面时收到 XamlParseExeption。问题似乎出在工具包 TiltEffect 或 TransitionService 上：

```
System.Windows.Markup.XamlParseException
  HResult=-2146233087
  Message=Unknown parser error: Scanner 2147500037\. [Line: 16 Position: 38]
  Source=System.Windows
  LineNumber=16
  LinePosition=38
  StackTrace:
       at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
       at ContactChooser.ContactChooserPage.InitializeComponent()
       at ContactChooser.ContactChooserPage..ctor()
  InnerException: 
```

最后一行是第 16 行：

```
<phone:PhoneApplicationPage
    x:Class="ContactChooser.ContactChooserPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    mc:Ignorable="d"
    shell:SystemTray.IsVisible="True"
    toolkit:TiltEffect.IsTiltEnabled="True"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T20:02:44.560

我发现了这个问题。我的解决方案中有两个项目：使用 TiltEffect 的主项目和用于测试主项目的示例项目。问题的解决方案是我需要在两个项目上添加对 Toolkit 的引用，而不仅仅是在使用该组件的项目上。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-17T19:37:10.887

我认为你不应该在整个页面上使用倾斜效果，而只是在你想要启用倾斜的控件上。

# c# - TDD 是否需要单元测试？

> ID：15456203
> 
> 赞同：0
> 
> 时间：2013-03-17T00:06:54.453
> 
> 标签：c#, java, php, unit-testing, tdd

测试驱动开发是否需要单元测试？我经常发现没有单元测试就没有 TDD。我无法通过 Wiki 等受人尊敬的来源或我可以访问的书籍来确认它。

来自维基百科：

> 测试驱动开发 (TDD) 是一个依赖于重复非常短的开发周期的软件开发过程：首先，开发人员编写一个（最初失败的）自动化测试用例，定义所需的改进或新功能（...）

如果不需要单元测试，是否意味着创建集成测试足以遵循 TDD？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T00:11:15.260

如果集成测试有意义并提供有用（和快速）的反馈，那么可以肯定。这不是关于测试范式的纯度，而是关于快速反馈循环和正在编写的代码的验证。只要你有它，你就有了 TDD。

附带说明一下，在这种情况下，我不会将 Wikipedia 称为受人尊敬的资源。参考资料的来源，当然。但是，如果您对 TDD 有任何疑问，我怀疑没有比[Kent Beck](https://rads.stackoverflow.com/amzn/click/com/0321146530)关于该主题的书更受尊重的资源了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-17T01:34:15.353

在开发 TDD 时，据说最好的测试是原子的和隔离的。这意味着他们正在测试一些非常具体的东西，而不依赖于您项目中的其他东西。UnitTest 正是用于此目的，所以我想没有单元测试就没有 TDD。

使用 TDD 进行开发的想法是让您自己和团队确信您的所有代码仍在按预期工作。为了实现这一点，您将需要一个集成服务器，每次集成所有内容时都必须运行测试。如果您使用框架进行单元测试，这很容易实现。

我真的很推荐这本书，它很短，很容易阅读，并且真的向你展示了方法：

[测试驱动：面向 Java 开发人员的实用 TDD 和验收 TDD](https://rads.stackoverflow.com/amzn/click/com/1932394850)

# wordpress - 在 WordPress 中为 Loop 和 Post/single.php 使用不同的帖子标题

> ID：15456206
> 
> 赞同：0
> 
> 时间：2013-03-17T00:07:26.557
> 
> 标签：wordpress

我正在使用 WooCommerce for WordPress 和产品的自定义帖子类型。

我希望商店页面/循环上显示的产品标题与单个产品页面上的 h1 标题标签不同。

循环中的标题是一个有限的空间来适应而不跳到新行......我可以缩短它以适应，但在产品页面本身我需要放置一个“更完整”的标题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T09:48:37.077

为什么不使用 CSS 属性来隐藏溢出的标题文本，请查看[http://www.w3schools.com/cssref/pr_pos_overflow.asp](http://www.w3schools.com/cssref/pr_pos_overflow.asp)和[http://www.w3schools.com/cssref/css3_pr_text-overflow.asp](http://www.w3schools.com/cssref/css3_pr_text-overflow.asp)

您可以设置标题标签的固定高度并添加`overflow:hidden;`，这样它就不会显示进入新行的文本。`text-overflow:ellipsis;`添加一些魅力。

更具体地说，将以下 CSS 属性添加到商店页面上包含您的标题的标签。

```
overflow: hidden;
text-overflow: ellipsis;
white-space: nowrap; 
```

# android - Facebook分享隐藏phonegap插件中的消息

> ID：15456207
> 
> 赞同：2
> 
> 时间：2013-03-17T00:07:43.283
> 
> 标签：android, facebook, cordova, mobile, facebook-social-plugins

我使用此插件在我的 Android 移动应用程序上共享任何文本 [https://github.com/phonegap/phonegap-plugins/tree/master/Android/Share](https://github.com/phonegap/phonegap-plugins/tree/master/Android/Share)

一切都很好，期待一件事

当我写一些文字我想分享时，插件会打开一个分享程序列表，我可以选择任何一个分享我之前写的文字，但是如果我选择facebook分享，它会删除我写的文字，并向用户显示一个空的文本区域，并忽略我调用插件的文本

有什么建议么？？？

谢谢，穆罕默德Elrashidy

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-09T09:56:56.287

发布 phonegap 3.0 后，他们已从 phonegap(github) 中删除所有插件，因此您必须将其升级到最新版本。

[您可以在这里](http://www.excellentwebworld.com/simple-way-to-integrate-sharethis-plugin-with-phonegap-3-0/)找到易于使用和安装的共享插件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T02:45:04.447

讨厌用另一个答案来回答，但您似乎无法共享文本和链接。或者，根据这个：

[https://stackoverflow.com/a/13505365/227313](https://stackoverflow.com/a/13505365/227313)

# clojure - java static int 混淆大小写行为

> ID：15456211
> 
> 赞同：5
> 
> 时间：2013-03-17T00:08:38.070
> 
> 标签：clojure

我很困惑......[这个静态值](http://docs.oracle.com/javase/6/docs/api/constant-values.html#java.awt.image.BufferedImage.TYPE_3BYTE_BGR)等于5

```
user> java.awt.image.BufferedImage/TYPE_3BYTE_BGR
5 
```

一个case语句应该像这样工作

```
user> (case 5
        5 "yes"
        "huh?")
"yes" 
```

但为什么它会这样工作？为什么不匹配？

```
user> (case java.awt.image.BufferedImage/TYPE_3BYTE_BGR
            java.awt.image.BufferedImage/TYPE_3BYTE_BGR "yes"
            "huh?")
"huh?" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T00:13:17.293

不计算表达式中的`test-constant`s 。`case`所以你的陈述是测试数字是否`5`与符号相同`java.awt.image.BufferedImage/TYPE_3BYTE_BGR`。由于它们不是，因此它属于默认子句。

# ios - 在屏幕上滚动和返回时如何保留 UITableViewCell 的选定状态

> ID：15456219
> 
> 赞同：0
> 
> 时间：2013-03-17T00:10:01.033
> 
> 标签：ios, uitableview

我在 UITableView 中有自定义 UITableViewCell 单元格。当用户选择了一个单元格并且该单元格被滚动出屏幕，然后又滚动回到屏幕中时，选定的单元格是空白的。

我知道在重复使用单元格时我需要设置单元格中的所有值，但我无法弄清楚这一点。

Iamge 1 代表用户选择单元格：

![选择单元格时的表格](../Images/52d43da0a01f2505a72cbb94182b9954.png)

图 2 表示单元格在屏幕上滚动并返回屏幕时 ![当单元格滚动离开屏幕并返回屏幕时的表格](../Images/ed257c6c7cae6bc3c5c916a20bc08af3.png)

（忽略图像模糊的事实，只是保护我的客户数据）

*注意：我希望能够选择表格，不建议取消高亮单元格的能力。我实际上希望在将选定的单元格滚动回屏幕时能够看到蓝色单元格。*

任何帮助将不胜感激。

编辑：添加一些代码：

```
// Define a property to keep track of the cell that was selected last using the NSIndexPath
@property (nonatomic, strong) NSIndexPath *lastSelectedIndexPath;

///////

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Keeps track of the lastest selected entry
    self.lastSelectedIndexPath = indexPath;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    IPCSearchResultTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell" forIndexPath:indexPath];
    [self configureCell:cell atIndexPath:indexPath];

    return cell;
}

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{
    // Cast the cell to the custom cell
    IPCSearchResultTableViewCell *searchResultCell = (IPCSearchResultTableViewCell *)cell;

    // RepositoryIndex is a coredata object with information 
    MyCoreDataEntity *entity = [self.fetchedResultsController objectAtIndexPath:indexPath];
    searchResultCell.label1.text = entity.attribute1;
    searchResultCell.label2.text = entity.attribute2;
    searchResultCell.label3.text = entity.attribute3;
    searchResultCell.label4.text = entity.attribute4;
} 
```

***注意：上面的代码现在似乎可以工作了。我不再遇到这个问题，也不知道为什么***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T10:37:10.027

您是否尝试过维护（选定单元格的）索引路径数组

如果 indexPath 在数组中，则在 cellForRowAtIndexPath 方法中设置 [cell setSelected:] 方法。

# c# - Windows Store C#：System.UnauthorizedAccessException 写入图像文件

> ID：15456222
> 
> 赞同：0
> 
> 时间：2013-03-17T00:10:20.533
> 
> 标签：c#, windows-8, microsoft-metro, windows-store

我目前正在创建一个 Windows 商店应用程序 (C#)，它定期（每 3 秒）从 URL 中提取图像并将其显示在页面上。图像已成功下载到临时应用程序存储一次，但第二次出现访问被拒绝 (UnauthorizedAccessException)。

这很可能是因为我的应用程序在尝试用新图像覆盖它时将该文件用作位图的源（因此它仍然处于打开状态）。

是否有避免并发问题的解决方法？

```
public async void GetLocalImageAsync(string internetUri, string uniqueName)
   {
       //Set up the web request and pass credentials.
       HttpWebRequest request = (HttpWebRequest)WebRequest.Create(internetUri);
      request.Credentials = new NetworkCredential("james", "jam3s");
        //get response
          using (var response = await request.GetResponseAsync())
          {
              using (var stream = response.GetResponseStream())
              {
                  var desiredName = string.Format(uniqueName);
                  //create the file.
                  var file = await ApplicationData.Current.TemporaryFolder.CreateFileAsync(desiredName, CreationCollisionOption.ReplaceExisting);

                  using (var filestream = await file.OpenStreamForWriteAsync())
                  {
                      await stream.CopyToAsync(filestream);

                      //update the bitmap image with the file we just downloaded.
                      BitmapImage c1src = new BitmapImage(new Uri("ms-appdata:///temp/camera1imgsrc.png"));
                      camera1img.Source = c1src;

                  }
              }
          }

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T04:45:17.680

尝试使用 ReaderWriterLockSlim 类处理文件。 [http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T05:45:05.253

您可以使用不同的名称存储每个下载的文件（例如，通过在根文件名中添加时间戳或序号）。下载后，您可以将源设置为这个新下载的文件，然后删除之前的文件。

# java - 简单的 Web 服务：将端点名称、服务名称等放在一起

> ID：15456223
> 
> 赞同：0
> 
> 时间：2013-03-17T00:10:22.000
> 
> 标签：java, web-services, cxf

我正在尝试 Apache 最简单的“Hello World”网络服务（[http://cxf.apache.org/docs/a-simple-jax-ws-service.html](http://cxf.apache.org/docs/a-simple-jax-ws-service.html)）；我特意对其进行了一些修改，以了解更多关于如何做事的信息，而不是仅仅复制他们的所有代码。

我的服务实现指定了它在包“hw”中实现的接口：

```
@WebService(endpointInterface = "hw.HelloWorld", serviceName = "HelloWorld") 
```

“发布”Web服务的程序（我收集的意思是作为它的服务器运行）在它自己的（非常正确的）包中具有实现：

```
HelloWorldImpl implementor = new hwimpl.HelloworldImpl();
Endpoint.publish("http://localhost:9000/helloworld", implementor); 
```

然后休眠 5 分钟，在此期间，指示要放入浏览器的 URL 显示 WSDL。这么多的作品。

```
http://localhost:9000/helloWorld?wsdl 
```

我的客户有：

```
private static final QName SERVICE_NAME 
    = new QName("http://server.hw.demo/", "HelloWorld");
private static final QName PORT_NAME 
    = new QName("http://server.hw.demo/", "HelloWorldPort");

// the following in a method, of course
String endpointAddress = "http://localhost:9000/helloWorld";
service.addPort(PORT_NAME, SOAPBinding.SOAP11HTTP_BINDING, endpointAddress);
HelloWorld hw = service.getPort(HelloWorld.class);
System.out.println(hw.sayHi("Albert")); 
```

我不知道 SERVICE_NAME 和 PORT_NAME 与我的服务有何关系。“server.hw.demo”字符串来自示例，与我的代码中的包或似乎用于命名空间的“反转”包不对应；他们应该吗？它们对应什么？我的代码中没有任何内容，除了这里，它使用“server.hw.demo”；那个字符串应该是什么？

我的实现和我的接口在不同的类中是否重要？

我的客户不工作，我把它作为一个问题发布，但它很长，没有人回复它。我正在努力理解这部分；在我看来，这最有可能是罪魁祸首。如果我知道如何删除另一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T07:37:03.547

[![目标命名空间](../Images/465372cd253ad17b7c1289d03e63c5fd.png)](https://i.stack.imgur.com/D57t1.png)
[（来源：[javatips.net](http://javatips.net/static/images/cxf-rest-soap.png)）]

上面的截图你可以看到 Target 命名空间`http://student.com`，这是因为我们创建的包是`com.student`. 目标命名空间必须与java包的顺序相反，也需要`http://`在包之前附加

参考**我的博客**：

[http://javatips.net/blog/2012/04/expose-cxf-service-with-rest-and-soap](http://javatips.net/blog/2012/04/expose-cxf-service-with-rest-and-soap)

# java - 单例解决方案

> ID：15456229
> 
> 赞同：1
> 
> 时间：2013-03-17T00:11:55.463
> 
> 标签：java, methods, static, singleton

在[这个](http://www.ibm.com/developerworks/java/library/j-dcl/index.html#6)博客中：

> 清单 10 中的代码不使用同步，并确保在调用静态 getInstance() 方法之前不会创建 Singleton 对象。

上面的引用是不是假的？由于静态对象是在类的早期初始化的，那么在调用静态方法之前如何不创建对象`getInstance()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T00:19:21.953

问题中引用的代码本质上是这样的：

```
class Singleton {
  private static Singleton instance = new Singleton();

  public static Singleton getInstance() {
    return instance;
  }
} 
```

这*是*线程安全的，因为实例不是延迟初始化的，而是在加载类时实例化一次。

类加载器强制执行自己的同步以保证类初始化是线程安全的。

# javascript - 三、不同材质（颜色）的LinePieces？

> ID：15456235
> 
> 赞同：1
> 
> 时间：2013-03-17T00:12:48.970
> 
> 标签：javascript, graph, three.js, visualization

我试图使用 three.js 绘制一个边数超过 10k 的密集图。

LinePieces 用于获得更好的性能，但我不知道如何为每个边缘（线）指定不同的颜色，因为只能使用一种“材质”来创建 Line 对象。

这是一些代码：

```
function drawEdges() {
    edgeGeometry = new THREE.Geometry();
    edgeMaterial = new THREE.LineBasicMaterial({ opacity: 0.1 });
        foreach source-target node pair:
            edgeGeometry.vertices.push(new THREE.Vector3(source.x, source.y));
            edgeGeometry.vertices.push(new THREE.Vector3(target.x, target.y));
    }
    var edges = new THREE.Line(edgeGeometry, edgeMaterial, THREE.LinePieces);
    scene.add(edges);
} 
```

我的问题是：如果使用 THREE.LinePieces，是否可以使用不同的材料？任何提示表示赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:44:24.797

如果你正在使用`WebGLRenderer`，你可以。

在您的几何图形中，您需要指定`geometry.colors`的数组`THREE.Color()`，其长度等于顶点数。

然后你像这样指定你的材料和网格：

```
var material = new THREE.LineBasicMaterial( {
    color: 0xffffff,
    vertexColors: THREE.VertexColors
} );

var mesh = new THREE.Line( geometry, material, THREE.LinePieces ); 
```

示例： http: [//mrdoob.github.com/three.js/examples/webgl_lines_colors.html](http://mrdoob.github.com/three.js/examples/webgl_lines_colors.html)

三.js r.57

# vector - CUDA：向量加法和向量大小

> ID：15456238
> 
> 赞同：1
> 
> 时间：2013-03-17T00:13:57.677
> 
> 标签：vector, cuda

我测量了执行内核在两个向量之间进行加法时的带宽：

```
__global__ void add(float *a, float *b, float *c, int n)
{
    int tid = blockIdx.x*blockDim.x + threadIdx.x;

    while (tid < n)
    {
        c[tid] = a[tid] + b [tid];
        tid += blockDim.x * gridDim.x;
    }
} 
```

我首先启动内核一次，以便将其加载到设备上，然后，我测量内核执行的 10 次迭代。

当我的向量长度为​​ 1000000 比 1000 时，带宽要好得多。

为什么 ？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T00:46:26.473

GPU 具有非常高的内存带宽（好）*和*非常高的内存延迟（坏）。一个内存请求需要几百个周期才能得到满足，但可能有许多正在进行的请求是流水线的。

如果您只添加 1000 个元素，那么您真正测量的是内存延迟。

有了更大的向量，就会有足够多的线程块，当一个线程块停在内存上时，GPU 可以切换到另一个线程块，其内存请求已完成。有了它们，您就可以测量带宽。

# hover - 在 li:hover 上更改 li 元素的背景，使用 css 背景图像

> ID：15456239
> 
> 赞同：1
> 
> 时间：2013-03-17T00:13:58.683
> 
> 标签：hover, html-lists

我有一堆 li 元素，背景图像在正常状态下工作正常。当您将鼠标悬停在该特定图像上时，我将悬停类添加到它们在 y 轴上移动大约 25px 左右的任何图像的那一刻。我尝试在悬停状态中设置“背景位置：0 0”以及边距等，但都没有奏效。我还尝试更改元素，因此它使用“a:hover”代替，但这也不起作用。

我究竟做错了什么？我怎样才能得到这个，所以悬停位置在同一个地方？

**我的代码：**

```
<div class="contentBottom">
<ul class="featuredIn">
<li class="featured1"><a href="mylink1.html"></a></li>
<li class="featured2"><a href="mylink2.html"></a></li>
<li class="featured3"><a href="mylink3.html"></a></li>
</ul>
</div>

li.featured1 {
    background: url(featured_in/1.png) no-repeat;
    text-indent:-9999px;
    width: 83px;    
    height: 43px;
}

li.featured1:hover {
    background: url(featured_in/1_hover.png) no-repeat;
}

li.featured2 {
    background: url(featured_in/2.png) no-repeat;
    width: 203px;   
    height: 42px;
    text-indent:-9999px;
}

li.featured2:hover {
    background: url(featured_in/2_hover.png) no-repeat;
}

li.featured3 {
    background: url(featured_in/3.png) no-repeat;
    width: 143px;
    height: 21px;
    text-indent:-9999px;
}

li.featured3:hover {
    background: url(featured_in/3_hover.png) no-repeat;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T14:39:32.787

您是否尝试像这样将图像添加到背景元素。

```
background-image: url(featured_in/3.png) no-repeat; 
```

您也可以尝试像这样将 '' 添加到 url 元素中。

```
background: url('featured_in/3.png') no-repeat; 
```

我希望这有帮助：）

# c++ - 将 C 转换为 C++：typdef 生成错误

> ID：15456240
> 
> 赞同：3
> 
> 时间：2013-03-17T00:14:03.950
> 
> 标签：c++, c, typedef

我需要将 .c 文件转换为 .cpp 文件，我遇到了这个声明：

```
 typedef void handler_t(int);

 handler_t *Signal(int signum, handler_t *handler); 
```

我在头文件中包含了这两行代码，并在 .cpp 文件中添加了实际的函数声明函数。

```
 handler_t *Signal(int signum, handler_t *handler){ ...... } 
```

当我这样做时，我收到错误：“handler_t 没有命名类型”。我以前从未在 C 或 C++ 中使用过 typdef，所以有人可以向我解释为什么我会收到错误吗？

* * *

我的课程要求：

```
 #ifndef A_H
 #define A_H

 class A
 {
     public:
       A();
       virtual ~A();

       typedef void handler_t(int);
       handler_t* Signal(int signum, handler_t *handler);

     protected:
     private:
 };

   #endif // A_H 
```

/////////////

```
 #include "A.h"

   A::A()
   {
   }

   A::~A()
   {
   }

   handler_t* A::Signal(int signum, handler_t *handler) {

     ...........

    } 
```

错误：

```
 |694|error: ‘handler_t’ does not name a type| 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:24:51.243

尝试将其更改为：

```
typedef void (*handler_t)(int); 
```

和：

```
handler_t Signal(int signum, handler_t handler); 
```

作为参考，看看[`signal()`](http://man7.org/linux/man-pages/man2/signal.2.html)它是这样的：

```
#include <signal.h>

typedef void (*sighandler_t)(int);

sighandler_t signal(int signum, sighandler_t handler); 
```

实际上，查看您的新代码，我认为您必须这样做：

```
A::handler_t* A::Signal(int signum, A::handler_t *handler) 
```

我认为您的新错误“未定义对 main 的引用”与所提出的问题无关。有关一些想法，请参见[这篇文章](https://stackoverflow.com/questions/7225076/strange-compiler-error-undefined-reference-to-main)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:57:14.170

```
handler_t* A::Signal(int signum, handler_t *handler) { 
```

问题是第一次提及`handler_t`需要用`A::`. 像这样：

```
A::handler_t* A::Signal(int signum, handler_t *handler) { 
```

当类中定义的类型被用作成员函数的返回类型时，情况总是如此。当你声明你在类定义中的函数时，嵌套的 typedef 是已知的。如果你在类定义中定义函数也是一样的。但是一旦你跳出类定义，你就必须告诉编译器在哪里`handler_t`定义。但是第二次提及`handler_t`是可以的，因为此时编译器知道它正在编译 的成员函数`A`，并且它知道`A`.

# javascript - 调用字符串时出错：indexOf

> ID：15456241
> 
> 赞同：2
> 
> 时间：2013-03-17T00:14:05.110
> 
> 标签：javascript, indexof

该行`var ndx = url.indexOf( parameter );`导致代码返回而不显示以下任一警报。显示 url 的警报是正确的。

```
function setFrameSrc() {
    var url = document.location;
    if (null == url) {
        alert('Javascript Error: Null Object - document.location');
        return;
    }
    alert('URL = ' + url);

    var parameter = '?image=';
    var ndx = url.indexOf(parameter);
    if (ndx < 0) {
        alert('Parameter not found = ' + parameter);
        return;
    }
    alert('Index of ' + parameter + ' = ' + ndx);

    var frame = document.getElementById('pframe');
    if (null == frame) {
        alert('Javascript Error: Null Object - frame');
        return;
    }
    frame.src = url.substring(ndx);
} 
```

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T00:15:21.007

`document.location`，尽管它的外观，不是一个字符串。你想要`document.location.href`。

更好的是，您可以使用`document.location.search`，其中仅包括包括和之后的部分`?`（并且不包括`#`您不考虑的和之后）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:19:05.480

### 改变：

`var url = document.location;`

### 致（以下之一）：

1.  `var url = document.location + '';`
    注意：您还需要将`null`比较更改为空白字符串 ( `''`)

2.  `(url+'').indexOf`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T00:26:34.313

它为我工作：

```
function test(){
var url = location.href;
if ( null == url ) {
    alert( 'Javascript Error: Null Object - document.location' );
return;
}
alert( 'URL = ' + url );

var parameter = '?image=';
var ndx = url.toLowerCase().indexOf( parameter );
alert(ndx);
if ( ndx < 0 ) {
    alert( 'Parameter not found = ' + parameter );
    return;
}
alert( 'Index of ' + parameter + ' = ' + ndx );
}

test(); 
```

> 更改：**document.location**为**location.href**

# c# - 运行时错误：LINQ to Entities 无法识别“User.IsInRole()”上的方法

> ID：15456242
> 
> 赞同：1
> 
> 时间：2013-03-17T00:14:08.507
> 
> 标签：c#, asp.net, asp.net-mvc, entity-framework, asp.net-mvc-4

这是一个 Asp.net Mvc 4 Web 应用程序。它一直有效，直到我添加`|| User.IsInRole("Admin")`. 为什么工作`User.IsInRole`时不能在 lambda 表达式中`User.Identity.Name`？

```
 private IQueryable<Item> Items
    {
        get
        {
            return _db.Items.Where(d => (d.CreatedBy == User.Identity.Name || User.IsInRole("Admin")));
        }
    }

    public ActionResult Index()
    {
        var items = Items.Include(d => d.Address);
        return View(items.ToList());
    } 
```

错误是在 引发的`items.ToList()`。

> LINQ to Entities 无法识别“Boolean IsInRole(System.String)”方法，并且该方法无法转换为存储表达式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T00:23:00.740

您收到错误是因为`User.IsInRole()`您无法将其合并到数据库查询中。

尝试这样的事情：

```
 if(User.IsInRole("admin"))
    return _db.Items;
 else 
 {
    string name = User.Identity.Name;
    return _db.Items.Where(d => d.CreatedBy.Equals(name)));
 } 
```

如果没有测试，我不能 100% 确定，但 Linq to Entities 也可能反对合并`User.Identity.Name`到表达式中。通过检索它的值并单独传递它，它将被视为一个常量。

您不能`User.Identity`在同一个表达式中结合对内存中事物（如 ）的测试和对实体字段（实际上是数据库列）的测试。Linq to Entities 将尝试将所有表达式下推到数据库中，如果不能，将反对。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T00:18:29.740

这不是 linq 的有效方法。您应该记住，传递给链接的所有方法都应转换为 SQL 表达式。您不能从 .net 或 linq 中的程序集调用函数

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-17T00:20:02.377

我会单独为管理员进行查询。

```
private IQueryable<Item> Items
    {
        get
        {
            var items = _db.Items;
            if (User.IsInRole("Admin"))
            {
                 return items;
            }
            return items.Where(d => d.CreatedBy == User.Identity.Name);
        }
    } 
```

Entity Framework 正在尝试将其转换为它无法做到的 SQL 表达式。

# wpf - WPF应用程序中图像和WindowsCodecsExt.dll的性能展示

> ID：15456245
> 
> 赞同：1
> 
> 时间：2013-03-17T00:14:32.693
> 
> 标签：wpf, image, performance, icc

我发现所有初始化 PNG 图像和使用颜色配置文件都需要大量时间（c# WPF 应用程序）。例如，一个带有 3 个图像的窗口加载了 3 秒！我通过探查器运行了代码，发现了以下内容。调用 [DllImport ("WindowsCodecsExt.dll", EntryPoint = "IWICColorTransform_Initialize_Proxy")] 需要将近 1 秒！

任何想法如何解决这一问题？

VS 2012 Express 重新安装。没有帮助。重新安装视频驱动程序没有帮助。视窗 7 专业版 64 位

![在此处输入图像描述](../Images/45cbb1ef83c659d190cf0eb62e80e2ba.png)

# youtube-api - 按日期获取最受欢迎的 youtube

> ID：15456248
> 
> 赞同：0
> 
> 时间：2013-03-17T00:14:51.847
> 
> 标签：youtube-api

我正在使用 youtube 最流行的 api Json 格式，并且我知道 api 仅提供带有 today 或 all_time 选项的时间。我可以指定前一天或其他日期的日期吗？

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:50:30.313

那是不可能的。标准 Feed 仅针对特定时间段预先生成，而不是针对任意日期范围。

# css - 使用身体缩放时如何使图像不缩放

> ID：15456251
> 
> 赞同：0
> 
> 时间：2013-03-17T00:15:01.293
> 
> 标签：css, image, safari, zooming

我有一个有趣的问题。我有一台笔记本电脑，分辨率使我难以阅读文本。我发现在 Safari 中放置一个 css 文件可以使文本永久变大，但是我遇到了一个问题

```
 Body {zoom: 110%} 
```

我的图像也在缩放，并且总是看起来失真。

有没有办法只缩放文本而不影响图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:27:13.737

或者，在 Safari 中，`Preferences > Advanced Tab > Universal Access`您可以设置最小字体大小。![在此处输入图像描述](../Images/83a1f9efa7081254c71a7560e7e79fff.png)

# openssl - 必须选择哪个 OpenSSL 环境：开发 | 运行时 | 根据？有什么不同？

> ID：15456263
> 
> 赞同：0
> 
> 时间：2013-03-17T00:16:40.233
> 
> 标签：openssl, cygwin, ruby-2.0

我正在尝试在 Cygwin 下的 Windows 上使用[ruby ​​-build 安装](https://github.com/sstephenson/ruby-build)**Ruby-2.0.0-rc2 。**我收到 BUILD FAILED 错误，因为Cygwin 中没有预安装**OpenSSL lib。**

 **```
BUILD FAILED

Inspect or clean up the working tree at /tmp/ruby-build.20130317003705.5576
Results logged to /tmp/ruby-build.20130317003705.5576.log

Last 10 log lines:
installing default gems:      /usr/local/ruby-2.0.0-rc2/lib/ruby/gems/2.0.0 (build_info, cache, doc, gems, specific ations)
                              bigdecimal 1.1.0
                              io-console 0.4.1
                              json 1.7.5
                              minitest 4.3.2
                              psych 2.0.0
                              rake 0.9.6
                              rdoc 4.0.0.rc.2.1
                              test-unit 2.0.0.0
The Ruby openssl extension was not compiled. Missing the OpenSSL lib? 
```

我检查了它`setup.exe`，并且有几种**OpenSSL**环境变体。必须选择哪一个？

我已经`libopenssl100 The OpenSSL runtime environment`预先安装了，但这并没有让我免于 BUILD FAILED。所以现在还剩下两个可以安装：

```
openssl The OpenSSL base environment
openssl-devel The OpenSSL development environment 
```

选择哪一个？这是什么意思`development`？它正在开发过程中或正在开发中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:23:50.460

只有这一个：

```
1.0.1e-2 openssl-devel The OpenSSL development environment 
```

所有其他人都是徒劳的。**

# hadoop - 在 hadoop 中创建的映射器数量

> ID：15456267
> 
> 赞同：1
> 
> 时间：2013-03-17T00:17:17.743
> 
> 标签：hadoop, mapreduce

要计算作业跟踪器将创建的映射器数量很容易理解。它基本上是 hdfs 文件的大小除以拆分大小。因此，如果 hdfs 文件的大小为 640MB，分割为 64MB，则作业跟踪器将创建 10 个映射器。但有时创建的映射器数量超出了您的预期。作业完成后，我会查看屏幕上的打印件以了解创建的映射器数量。

我的问题如下：是否有可能通过查看不同的日志来理解为什么创建了更多的映射器？

**注意**：我有一个 map reduce 作业，并且在不同时间执行相同的作业时会报告不同的映射器。尽管创建的额外映射器并不大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T03:53:43.397

我在阅读作业跟踪器生成的日志后发现，当已经分配的映射器需要很长时间才能完成时，会创建额外的映射器，而这些映射器只不过是落后者。

Hadoop 在分配这样一个任务时，它会执行以下操作：attempt_200707121733_0002_m_000005_1

这意味着作业跟踪器现在正尝试在第 5 个地图任务上为作业 2 分配第一次任务尝试。任务尝试从 0 开始。

# c++ - 从外部应用程序 MFC 中获取像素

> ID：15456270
> 
> 赞同：0
> 
> 时间：2013-03-17T00:18:05.010
> 
> 标签：c++, getpixel

颜色是 #B38300 但它返回给我 #074092 我正在尝试获取 3D 应用程序的像素颜色。

```
::SetForegroundWindow(tempHWND);
Sleep(2000);
HDC hDC = ::GetDC(tempHWND);
COLORREF rgb = ::GetPixel(hDC,50,60);
int redValue = GetRValue(rgb);
int greenValue = GetGValue(rgb);
int blueValue = GetBValue(rgb); 
```

我怎样才能得到准确的颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T17:58:34.260

```
HDC hDC = CreateDC(L"DISPLAY",0,0,0); 
```

我正在使用该代码并且它有效！

# iphone - 如何在xcode中对表格项目进行排序

> ID：15456271
> 
> 赞同：0
> 
> 时间：2013-03-17T00:18:09.933
> 
> 标签：iphone, xcode, sorting

我是 xcode 的新手，我一直在积极搜索在线教程来做一些类似 jquery sortable [link here](http://jqueryui.com/sortable/)的事情。我的表格项目的唯一区别是在一行中，但是我必须能够像**item1|item3|item2|item4**一样重新排列它们。而且我还需要知道数组的最终排序结果，以便我可以使用它来搜索数据库。任何人都知道如何在 xcode 中做到这一点？如果您能提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:43:47.967

您可以使用 tableView 并重新排序它的单元格：

```
#pragma mark Row reordering
// Determine whether a given row is eligible for reordering or not.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
     return YES;
}
// Process the row move. This means updating the data model to correct the item indices.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath
        toIndexPath:(NSIndexPath *)toIndexPath
{
     NSString *item = [arry objectAtIndex:fromIndexPath.row];
    [arry removeObject:item];
    [arry insertObject:item atIndex:toIndexPath.row];
} 
```

但这用于每行一个项目。

[http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/ManageReorderRow/ManageReorderRow.html](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/ManageReorderRow/ManageReorderRow.html)

# c++ - 返回父类的 C++11 unique_ptrs 的函数指针

> ID：15456274
> 
> 赞同：2
> 
> 时间：2013-03-17T00:19:05.373
> 
> 标签：c++, c++11, function-pointers, unique-ptr

我正在尝试为返回`unique_ptr`实例的函数创建函数指针。每个函数都应该返回一个尽可能具体类型的值，以便对许多调用者普遍有用（在我的真实代码中，函数被命名为构造函数，并且在每个对象的公共标头中）。然而，在这个特定的用途中，我只关心每个类实现的通用接口。

我遇到了一个问题，我无法将返回的函数分配给返回`unique_ptr<Subclass>`的函数指针`unique_ptr<Superclass>`。

我把我的例子归结为这个片段：

```
#include <iostream>
#include <memory>

struct Foo {
  virtual void foo() = 0;
};

struct Bar : public Foo {
  void foo() {};
};

std::unique_ptr<Foo>
foo_creator()
{
  return nullptr;
}

std::unique_ptr<Bar>
bar_creator()
{
  return nullptr;
}

typedef std::unique_ptr<Foo>(*creator_fn)();

int
main(int argc, char *argv[])
{
  std::unique_ptr<Foo> f;

  f = foo_creator();
  f = bar_creator();

  creator_fn foo_fn = foo_creator;
  creator_fn bar_fn = bar_creator; // Fails

  return 0;
} 
```

我从 clang ( `Apple LLVM version 4.2 (clang-425.0.24) (based on LLVM 3.2svn)`) 得到的编译错误是：

```
cannot initialize a variable of type 'creator_fn'
(aka 'std::unique_ptr<Foo> (*)()') with an lvalue
of type 'std::unique_ptr<Bar> ()':

different return type
('unique_ptr<struct Foo>' vs 'unique_ptr<struct Bar>') 
```

我也愿意被告知实现目标的更好方法。:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:52:23.960

编译此代码所需的功能称为类型参数的协方差。查看有关该主题的[Wikipedia 文章](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)。

为此，作为 to 的子类型的事实`Bar`必须`Foo`暗示这`unique_ptr<struct Bar>`将是 to 的子类型`unique_ptr<struct Foo>`。

一些语言有这个属性，但 C++ 没有，这使得模板和继承很难很好地结合在一起。在 Java 中，你会这样写：

```
UniquePtr<? extends Foo> f;
f = fooCreator();
f = barCreator(); 
```

Where`UniquePtr<? extends Foo> f`声明了一个在其类型参数中协变的变量。

我想你必须找到一个以某种方式解决这个问题的设计。[这篇文章](https://stackoverflow.com/questions/4908392/how-to-implement-template-class-covariance-in-c)似乎包含一个类似的问题，可能会给出一些建议。

**编辑**：我误读了这个问题，并认为编译错误在错误的行上，所以上面的答案有点误导。我仍然认为缺乏差异是问题所在，但这一行出现了错误：`bar_fn = bar_creator; // Fails`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T13:40:57.110

这是我用来解决我的特定问题的修改设计。我使用新的 C++11 模板`using`声明来标记将返回的特定类型。当我调用该函数时，我`unique_ptr`可以毫无问题地利用 s 向上转换的能力。

```
template <class T>
using creator_fn = std::unique_ptr<T>(*)();

int
main(int argc, char *argv[])
{
  std::unique_ptr<Foo> f;

  f = foo_creator();
  f = bar_creator();

  creator_fn<Foo> foo_fn = foo_creator;
  creator_fn<Bar> bar_fn = bar_creator;

  f = foo_fn();
  f = bar_fn();

  return 0;
} 
```

# c++ - 以 std::function 作为值的 Multimap

> ID：15456276
> 
> 赞同：2
> 
> 时间：2013-03-17T00:19:17.417
> 
> 标签：c++, c++11

我有一个`std::multimap`where 值的类型`std::function`。由于没有比较`std::function`- 看到[这个](https://stackoverflow.com/questions/3629835/why-is-stdfunction-not-equality-comparable)- 似乎没有办法从这个多图中删除特定元素。例如，如果您想从例如 a`std::list`或中按值删除元素，我想也是如此`std::vector`。

我的用例是一个函数，它接受一个回调参数（`std::function`）。发生特定事件时应调用回调。但是，在其他情况下，被调用者希望在回调触发之前“取消注册”回调。

不过，最初我只是将其包装`std::function`在一个结构中并在我的地图中插入指向该结构的指针。然而，这并不可行，因为接口用户不应该将回调包装在结构中并存储指针值。

我目前最好的想法是在注册回调时返回一个 id - 如果被调用者希望稍后可以选择取消回调，则必须存储该 id。

对我的泡菜有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T11:43:48.573

如果呼叫者应该保留某种令牌（`id`在您的情况下），为什么不将其包装`std::function`在 a 中`std::shared_ptr`并让呼叫者提供/保留它而不是一些虚构的 ID？然后将 直接`std::multimap`存储`std::shared_ptr<std::function<...>>`为其值而不是`std::function`.

这样，您以后可以轻松地将其删除，并且不会复制`std::function`自身，这也可能是一项[成本高昂的操作](https://stackoverflow.com/questions/5057382/what-is-the-performance-overhead-of-stdfunction)。当调用者使用`std::make_shared<std::function<...>>(...)`它时，它可能是一个真正的替代恕我直言。

# .htaccess - htaccess url 重写 - 隐藏 URL 上的文件扩展名

> ID：15456277
> 
> 赞同：1
> 
> 时间：2013-03-17T00:19:21.237
> 
> 标签：.htaccess, rewrite, friendly-url

# 目前

### 如果我添加这样的href，它已经可以工作了

`<a href="central-cliente">Click here to go to the client center</a>`

### 但是我的大多数链接都是这样的，它在 URL 中显示 clientarea.php - 应该覆盖它并成为中心客户端，如 .htaccess 中设置的那样

`<a href="clientarea.php">Click here to go to the client center</a>`

## 问题

我希望客户即使点击不友好的 url（.php、.html 等）也能看到友好的 url

# .htaccess

```
Options +FollowSymlinks
RewriteEngine On
Options -MultiViews
RewriteBase /painel/

RewriteRule ^central-cliente$ ./clientarea.php [L,NC]
RewriteRule ^registro$ ./register.php [L,NC]
RewriteRule ^entrar$ ./clientarea.php [L,NC]
RewriteRule ^sair$ ./logout.php [L,NC]
RewriteRule ^whois-dominio$ ./domainchecker.php [L,NC]
RewriteRule ^pagina-inicial$ ./index.php [L,NC]
RewriteRule ^sua-conta$ ./clientarea.php [L,NC]
RewriteRule ^base-conhecimento$ ./knowledgebase.php [L,NC]
RewriteRule ^tickets-suporte$ ./submitticket.php [L,NC]
RewriteRule ^status-servidor$ ./serverstatus.php [L,NC]
RewriteRule ^recuperar-senha$ ./pwreset.php [L,NC]
RewriteRule ^status-servidor$ ./serverstatus.php [L,NC]
RewriteRule ^tickets-suporte-geral$ ./submitticket.php?step=2&deptid=1 [L,NC]
RewriteRule ^central-cliente$ ./clientportal.php [L,NC]
RewriteRule ^meus-dados$ ./clientarea.php?action=details [L,NC]
RewriteRule ^meus-servicos$ ./clientarea.php?action=products [L,NC]
RewriteRule ^meus-dominios$ ./clientarea.php?action=domains [L,NC]
RewriteRule ^meus-orcamentos$ ./clientarea.php?action=quotes [L,NC]
RewriteRule ^minhas-faturas$ ./clientarea.php?action=invoices [L,NC]
RewriteRule ^meus-tickets$ ./supporttickets.php [L,NC]
RewriteRule ^afiliados$ ./affiliates.php [L,NC]
RewriteRule ^meus-emails$ ./clientarea.php?action=emails [L,NC]
RewriteRule ^sair$ ./logout.php [L,NC]
RewriteRule ^enviar-ticket$ ./submitticket.php?step=2&deptid=1 [L,NC]
RewriteRule ^download$ ./downloads.php [L,NC]
RewriteRule ^carrinho$ ./cart.php [L,NC]
RewriteRule ^extras$ ./cart.php?gid=addons [L,NC]
RewriteRule ^renovar-dominio$ ./cart.php?gid=renewals [L,NC]
RewriteRule ^registrar-dominio$ ./cart.php?a=add&domain=register [L,NC]
RewriteRule ^pagamentos-multiplos$ ./clientarea.php?action=masspay&all=true [L,NC]
RewriteRule ^adicionar-credito$ ./clientarea.php?action=addfunds [L,NC]
RewriteRule ^cartao-credito$ ./clientarea.php?action=creditcard [L,NC]
RewriteRule ^base-de-conhecimento$ ./knowledgebase.php [L,NC]
RewriteRule ^downloads$ ./downloads.php [L,NC]
RewriteRule ^status-da-rede$ ./serverstatus.php [L,NC]
RewriteRule ^sub-contas$ ./clientarea.php?action=contacts [L,NC]
RewriteRule ^emails-enviados$ ./clientarea.php?action=emails [L,NC]
RewriteRule ^mudar-senha$ ./clientarea.php?action=changepw [L,NC]
RewriteRule ^afiliados$ ./affiliates.php [L,NC]
RewriteRule ^suporte$ ./submitticket.php?step=2&deptid=1 [L,NC]
RewriteRule ^transferencia-dominio$ ./cart.php?a=add&domain=transfer [L,NC] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:58:25.633

不幸的是，您的映射没有统一的模式。您必须拥有高于所有其他规则的第一个规则，以防止无休止的重定向循环

```
# prevent endless loop    
RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L] 
```

然后为简单的URL一一添加反向映射

```
RewriteRule ^clientarea.php$ central-cliente [R,L] 
```

或有条件，如果您有查询字符串

```
RewriteRule ^clientarea.php?action=details$ meus-dados [R,L] 
```

将*不起作用*，因为`?action=details`它不是 URL 路径的一部分。你必须有一个[`RewriteCond`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)with`%{QUERY_STRING}`为此

```
RewriteCond %{QUERY_STRING} action=details
RewriteRule ^clientarea.php$  meus-dados? [R,L] 
```

`?`末尾的问号会抑制替换 URL 中的查询字符串。

也许，您至少可以将 a [`RewriteMap`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritemap)with用于简单的一对一重定向，并在简单的文本文件中维护映射列表。但这与在您的 .htaccess[`txt`](http://httpd.apache.org/docs/current/rewrite/rewritemap.html#txt)中拥有一长串 s 并没有太大区别。`RewriteRule`

# c# - 为什么.NET 不能正确转换时间？

> ID：15456285
> 
> 赞同：8
> 
> 时间：2013-03-17T00:20:23.653
> 
> 标签：c#, .net, timezone, dst

在 2013 年，英国将在 3 月 31 日之前开始夏令时。

尽管如此，`TimeZoneInfo.ConvertTimeToUtc`当我尝试将给定时间转换为 UTC 时间时，仍会减去一小时。

为什么是这样？我是否需要告诉这个方法夏令时无效？

```
var now = new DateTime(DateTime.Now.Ticks, DateTimeKind.Unspecified);
var convertedTime = TimeZoneInfo.ConvertTimeToUtc(now, TimeZoneInfo.FindSystemTimeZoneById("W. Europe Standard time"));
Console.WriteLine(convertedTime); // subtracts one hour, even though England time and GMT should be equal 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T01:33:18.903

您只是使用了错误的时区。英格兰位于“GMT 标准时间”区域。

“西欧标准时间”区域适用于欧洲大陆、阿姆斯特丹、柏林、伯尔尼、罗马、斯德哥尔摩、维也纳，UTC+01:00。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T00:30:38.510

[注意：此答案假定运行代码的计算机位于 GMT 时区]

这是因为根据 .Net，“西欧标准时间”与 UTC 的时区不同（*即使它应该是*）。**这很奇怪，似乎是 .Net 库中的一个错误。**

因此，您无意中告诉它将时间转换为 UTC 并将其传递给 UTC（即 GMT 时间），但随后告诉它时间为“西欧标准时间”，比 UTC 早一个小时.

所以自然而然地，所得到的时间在一小时内就不同了。

一步步：

```
var now = new DateTime(DateTime.Now.Ticks, DateTimeKind.Unspecified); 
```

这将设置`now`为 UTC 时间。

```
var convertedTime = TimeZoneInfo.ConvertTimeToUtc(now, TimeZoneInfo.FindSystemTimeZoneById("W. Europe Standard time") 
```

这将转换`now`为 UTC，假设它`now`是“西欧标准时间”，即 UTC+1。但事实并非如此！因此结果不正确。

**[编辑回应以下评论]**

请注意，`"W. Europe Standard time"` *应该*是 UTC，但不是出于某种原因。当你这样做时：

```
TimeZoneInfo.FindSystemTimeZoneById("W. Europe Standard time") 
```

它返回 UTC+1 而不是（显然）正确的 UTC。它甚至将名称更改为`"W. Europe Daylight Time"`. 似乎这可能是一个奇怪的错误？

**[二次编辑]**

查看[Microsoft 时区索引值](http://msdn.microsoft.com/en-us/library/ms912391%28v=winembedded.11%29.aspx)（[以及此处](http://support.microsoft.com/kb/973627)）。（*请注意*，这些链接实际上都不适用于 Windows 7，但它们包含相同的定义。）

它有一个“W. Europe Standard Time”条目，其中明确指出`(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-06-10T16:49:32.823

那么我们有两个是西欧时间，西欧夏季/日光时间不是吗？可能是通过输入西欧标准时间，您会自动匹配最接近的时间，即夏季或日光 - 无论标准是否被列为时区。

顺便说一句，英国夏令时与西欧夏令时/夏令时相同。格林威治同时与西欧时间匹配 - 相同时区，但 BST 在历史上更早开始，在 2002 年与欧盟规则匹配之前。实际上，相同的系统不同的名称。

# php - POST OBJECTs 使用 AJAX 到 PHP

> ID：15456286
> 
> 赞同：0
> 
> 时间：2013-03-17T00:20:31.973
> 
> 标签：php, jquery, ajax

我有以下代码，但我无法访问使用 ajax 传递的对象的内容。我错过了什么？

```
$(".submit").click(function(){ 
  var fruits = {"fruits" : ["apples","banana","oranges"]};
  var cars = {"cars" : ["BMW", "Honda", "Toyota"]};
  var my_Obj = fruits + cars;
  mydata = JSON.stringify(my_Obj); 
  $("#mydata").val(mydata);
  $.ajax({
    url: "add.php",
    type: "POST",
    data: {
      name: $('#name').val(),
      Address: $('#Address').val(),
  my_obj : $mydata
    }, 
    datatype: "json",
    success: function (status) {
      if (status.success == false) {
        alert("Failure!");
      } else  {
        alert("Success!");
      }
    }   
  });
}); 

  <form id="json" method="post" action="add.php">
    <input type="text" name="name" id="name" value="">
    <input type="text" name="address" id="Address" value="">
    <input type="text" name="mydata" id="mydata" hidden>
    <input type="submit" name="submit" id="submit" class="submit" value="send">
  </form> 
```

添加.php

```
$new_post['id'] = $_POST['id']; 
$new_post['name'] = $_POST['name'];
$new_post['address'] = $_POST['address']; 
$new_post['my_obj'] = $_POST['mydata'];
print_r ($new_post); 
```

[my_obj] 显示 [object Object] [object Object]。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:26:18.313

我看到了一些错误的地方：

1、表单可以通过点击回车提交，所以我会使用一个`.submit()`方法而不是'submit.click()'：

```
$('form').submit(function(){
}); 
```

2，表格将提交，除非你`return false`在你的`.submit()`方法

```
$('form').submit(function(){
    // all of your code
    return false;
}); 
```

3、在`add.php`您需要返回的`json`信息：

```
echo json_encode($new_post); 
```

`status`4 、你没有设置`add.php`

```
$new_post['status'] = true; // or false depending on what your trying to do 
```

希望这会给你一个开始。

* ***注意：**这不考虑您发送到的变量`add.php`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:27:31.447

您不能通过表单提交发送原始对象，您需要先将它们展平为文本。这是通过序列化完成的，最简单的方法是通过 JSON，因为它在客户端和大多数服务器语言上都可以理解。

在您的情况下，将 AJAX 调用中的 my_obj 部分替换为： my_obj: JSON.stringify(my data)

# ruby-on-rails - 建立模型协会列表

> ID：15456287
> 
> 赞同：0
> 
> 时间：2013-03-17T00:20:31.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我正在构建一个应用程序，允许舞者创建“圆形”或舞蹈动作列表。我有一个移动模型和一个回合模型。我想让用户选择他们可用的动作并将它们添加到一轮中。我不太确定这些模型之间需要什么关联。现在移动模型belongs_to :round 和集合模型has_many :moves。

我不一定了解如何将动作添加到一轮中。如在第 1 轮中，包含 move1、move2、move3。我很困惑，因为在这种情况下，移动本身的 round_id 似乎没有意义，因为用户在创建回合时向回合添加移动，而不是在创建移动时。

基本上这个想法是，我需要能够创建一个新列表并向其添加相关的移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:02:21.770

您需要一个额外的表格来跟踪与回合相对应的所有移动；

```
class Move < ActiveRecord::Base
     has_many :roundmoves
     has_many :rounds, :through => :roundmoves
end

class Round < ActiveRecord::Base
     has_many :roundmoves
     has_many :moves, :through => :roundmoves
end

class RoundMove < ActiveRecord::Base
     belongs_to :round
     belongs_to :move
end 
```

查看指南以获取一个很好的示例：http: [//guides.rubyonrails.org/association_basics.html#the-has_many-through-association](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)

# ruby-on-rails-3 - 将关联序列化为 ID 数组

> ID：15456292
> 
> 赞同：1
> 
> 时间：2013-03-17T00:21:02.237
> 
> 标签：ruby-on-rails-3, activemodel, active-model-serializers

我正在尝试将模型的关联序列化为关联模型的 ID（int）数组。我目前在 serializable_hash 中使用 :include 选项，如下所示：

```
:include => {:associated => {:only => [:id]} 
```

至尊输出json像：

```
{"id":13, ...,"associated":[{"id":15,"associated":[]},{"id":14,"associated":[]}]} 
```

不知道为什么关联的对象有一个“关联”键；但这不是很重要；我想要的是获得如下输出：

```
{"id":13, "associated":[15,14]} 
```

我应该怎么做才能得到这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T09:52:47.333

如果您只需要`associated`模型 ID，您可以尝试在父模型中创建一个方法，例如：

```
class ParentModel < ActiveRecord::Base
  # ...

  def associated_ids
    associated.pluck(:id)
  end
end 
```

然后在`serializable_hash`or`to_json`方法中，我会这样做：

```
parent_model_instance.includes(:associated).serializable_hash(methods: [:associated_ids]) 
```

哪个应该产生这个：

```
{ "id": 13, "associated_ids": [15,14] } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-24T09:06:31.593

也许你可以在你的序列化器中这样做：

```
 class SomeSerializer < ActiveModel::Serializer
   embed :ids
   has_many :associateds
 end 
```

# android - 使用微调器设置文本不适用于我列表中的一项，如何解决？

> ID：15456295
> 
> 赞同：0
> 
> 时间：2013-03-17T00:21:12.150
> 
> 标签：android

我对下面的代码有问题，我有一个带有三个诗人名称的旋转器，当挑选一位诗人时，它设置了第二个旋转器的内容，以及当从第二个旋转器中选择一首诗时，该诗是设置文本视图内容的到这首诗。This works for every single one except the Judgment of Paris poem which when chose does nothing, can anyone see why?

这是复制并粘贴的字符串的名称

```
string name="judgement" 
```

代码：

```
 // defining variables
  Spinner PoetSpinner, PoemSpinner;
  String Poets[] = { "", "Robert Burns", "James Beattie",
"Duncan MacGregor Crerar" };
String Poems1[] = { "", "Tam O Shanter", "Auld Lang Syne" };
String Poems2[] = { "", "Judgement Of Paris", "The Minstrel" };
String Poems3[] = { "", "A Poem Commemorating Robbie Burns",
"My Bonnie Rowan Tree" };

TextView selectedPoem; 

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

// set to fullscreen mode
requestWindowFeature(Window.FEATURE_NO_TITLE);
getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
  WindowManager.LayoutParams.FLAG_FULLSCREEN);
// set content view
setContentView(R.layout.poet);

initialize(); // call this method
}

public void initialize() {

// initializing items that are in the class
PoetSpinner = (Spinner) findViewById(R.id.spPoet);
PoemSpinner = (Spinner) findViewById(R.id.spPoem);
// Hide the second spinner
PoemSpinner.setVisibility(View.GONE);
selectedPoem = (TextView) findViewById(R.id.tvSelectedPoem);
// setting up array adapters
//
// for each spinner
  ArrayAdapter<CharSequence> adapter = ArrayAdapter
  .createFromResource(this, R.array.poet_arrays,
  android.R.layout.simple_spinner_item);
  // Specify the layout to use when the list of choices appears
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
// Apply the adapter to the spinner
PoetSpinner.setAdapter(adapter);
PoetSpinner.setOnItemSelectedListener(this);

PoemSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {

   public void onItemSelected(AdapterView<?> parent, View view,
    int position, long id) {
    Object poem = parent.getItemAtPosition(position);
    if("Tam O Shanter".equals(poem.toString())){
         selectedPoem.setText(getString(R.string.tamO));
    }
    if("Auld Lang Syne".equals(poem.toString())){
     selectedPoem.setText(getString(R.string.auld));
   }
    if("Judgement Of Paris".equals(poem.toString())){
     selectedPoem.setText(getString(R.string.judgement));
   }
    if("The Minstrel".equals(poem.toString())){
     selectedPoem.setText(getString(R.string.minstrel));
   }
    if("A Poem Commemorating Robbie Burns".equals(poem.toString())){
     selectedPoem.setText(getString(R.string.rob));
   }
    if("My Bonnie Rowan Tree".equals(poem.toString())){
     selectedPoem.setText(getString(R.string.row));
   }

  }

  public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub

  }
});
}

 public void onItemSelected(AdapterView<?> parent, View view, int pos,
long id) {
ArrayAdapter<CharSequence> adapter = null;
switch (pos) {
  case 1:
  adapter = ArrayAdapter.createFromResource(this,
    R.array.poem_arrays1, android.R.layout.simple_spinner_item);
  break;
  case 2:
  adapter = ArrayAdapter.createFromResource(this,
    R.array.poem_arrays2, android.R.layout.simple_spinner_item);
  break;
  case 3:
  adapter = ArrayAdapter.createFromResource(this,
    R.array.poem_arrays3, android.R.layout.simple_spinner_item);
  break;
  default:
  // Hide the poem spinner
  PoemSpinner.setVisibility(View.GONE);
  break;
}

if (adapter != null) {
  // Set the poem spinners content and show the spinner
  adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
  PoemSpinner.setAdapter(adapter);
  PoemSpinner.setVisibility(View.VISIBLE);
} 
```

XML 文件

```
 <string name="tamO">
But pleasures are like poppies spread, 
You seize the flower, its bloom is shed; 
Or like the snow falls in the river, 
A moment white--then melts for ever; 
Or like the borealis race, 
That flit ere you can point their place; 
Or like the rainbow\'s lovely form 
Evanishing amid the storm.-- 
Nae man can tether time or tide; 
The hour approaches Tam maun ride; 
That hour, o\' night\'s black arch the key-stane, 
That dreary hour he mounts his beast in; 
And sic a night he taks the road in 
As ne\'er poor sinner was abroad in.
</string>
<string name="auld">
For auld lang syne, my dear, 
For auld lang syne. 
We\'ll tak a cup o\' kindness yet, 
For auld lang syne. 

And surely ye\'ll be your pint stowp! 
And surely I\'ll be mine! 
And we\'ll tak a cup o\'kindness yet, 
For auld lang syne. 

We twa hae run about the braes, 
And pou\'d the gowans fine; 
But we\'ve wander\'d mony a weary fit, 
Sin\' auld lang syne. 
</string>
<string name="judgement">
Up the broad cliffs, that tower\'d immense to heaven,
Green wav\'d the lofty pines, on every side;
Save where, fair-opening to the beam of even,
A dale sloped gradual to the valley wide.

Echoed the vale with many a chearful note;
The various lowe of herds resounding long,
The shrilling pipe, the mellow horn remote,
And social clamours of the festive throng.

For now, low-hovering o\'er the western main, 
Where amber clouds begirt his dazzling throne,
The sun with ruddier verdure deck\'d the plain;
And lakes, and streams, and spires triumphal shone;
</string>
<string name="minstrel">
    Of chance or change O let not man complain,
Else shall he never never cease to wail:
For, from th\' imperial dome, to where the swain
Rears the lone cottage in the silent dale,
All feel th\' assault of fortune\'s fickle gale;
Art, empire, earth itself, to change are doom\'d;
Earthquakes have raised to heaven the humble vale,
And gulphs the mountain\'s mighty mass entomb\'d,
And where th\' Atlantick rolls wide continents have bloom\'d.

But sure to foreign climes we need not range,
Nor search the antient records of our race,
To learn the dire effects of time and change,
Which in ourselves, alas, we daily trace.
Yet at the darken\'d eye, the wither\'d face,
Or hoary hair, I never will repine:
But spare, O Time, whate\'er of mental grace,
Of candour, love, or sympathy divine,
Whate\'er of fancy\'s ray, or friendship\'s flame is mine.
</string>  
<string name="rob">
He touched our country\’s ancient harp
With truest patriotic fire;
Forth thrilling came soul-stirring strains,
Man\’s nobler actions to inspire.
The cottar\’s fireside, \‘neath his spell,
Becomes at once a hallowed shrine;
His  hymn to Mary swells the heart,
And fills the eye his Auld Lang Syne.

Not to his native land alone
His genius and his fame belong,
In other climes is treasured dear
His matchless legacy of song.
His melodies have echoing gone
To continents and isles afar;
 They  cheer and gladden hearts alike
\‘Neath Southern Cross and Polar Star.

</string>

<string name="row">
Thrice welcome sweet green spray
Culled from my Rowan Tree,  
By loved ones far away,
In Bonnie Amulree.

 In Boyhood\’s days thy root
Was planted by my hand;
Just ere I left my dear,
My Scottish fatherland.

Thou but a sapling then,
Though now a sheltering tree,
While warblers in thy boughs,
Sing sweetest melodies.
</string>

<string-array name="film_arrays">
    <item>Please Select...</item>
    <item>Sean Connery</item>
    <item>Billy Connolly</item>
    <item>James McAvoy</item>
    <item>Karen Gillan</item>
    <item>Kelly Macdonald</item>
    <item>Ashley Jensen</item>
</string-array>

<string-array name="poet_arrays">
    <item>Please Select...</item>
    <item>Robert Burns</item>
    <item>James Beattie</item>
    <item>Duncan MacGregor Crerar</item>
</string-array>

    <string-array name="poem_arrays1">
    <item>Please Select...</item>
    <item>Tam O Shanter</item>
    <item>Auld Lang Syne</item>
</string-array> 
    <string-array name="poem_arrays2">
    <item>Please Select...</item>
    <item>Judgment Of Paris</item>
    <item>The Minstrel</item>
</string-array>
    <string-array name="poem_arrays3">
    <item>Please Select a...</item>
    <item>A Poem Commemorating Robbie Burns</item>
    <item>My Bonnie Rowan Tree</item>
</string-array> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T01:30:32.290

你在比较

巴黎审判 (poem_arrays2) 到

巴黎审判（代码）。

这两个字符串显然是不同的。

顺便说一句，我真的会考虑在 xml 文件中使用数据库而不是硬编码字符串。数据库将为您提供一种防止此类错误发生的设计。它也更加通用和可扩展。如果您有更多诗人和/或诗歌，只需将它们添加到您的表格中，而无需更改任何代码。或者，您可以使用反映实体层次结构的 xml 文件，如下所示：

```
<poet name="Robert Burns">
    <poem name="Tam O Shanter">
        But pleasures are like poppies spread, 
        [...] 
    </poem>
    <poem name="Auld Lang Syne">
        For auld lang syne, my dear,
        [...] 
    </poem>
</poet> 
```

# ios - 使用 NSString 为标签设置颜色

> ID：15456299
> 
> 赞同：3
> 
> 时间：2013-03-17T00:21:47.993
> 
> 标签：ios, objective-c, nsstring, selector, uicolor

我想创建一个方法并使用字符串值“redColor”来设置标签的 UIColor。tableColorName 是 NSString "redColor"，我尝试应用选择器来创建 UIColor 并将其应用到我的 textLabel。谢谢

```
-(void) changeLabelColor
{
    SEL labelColor = NSSelectorFromString([NSString stringWithFormat:[@"%@", tableColorName]]);

    UIColor *color = [[UIColor class] performSelector:labelColor];
    self.textLabel.textColor = color;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-17T00:31:32.830

使用此方法

```
-(UIColor *)giveColorfromStringColor:(NSString *)colorname
{
    SEL labelColor = NSSelectorFromString(colorname);
    UIColor *color = [UIColor performSelector:labelColor];
    return color;
} 
```

调用为

```
[view setBackgroundColor:[self giveColorfromStringColor:@"redColor"]]; 
```

方法名称`colorname`作为输入并给出相应的 UIColor

因此，在您的情况下，电话将是

```
self.textLabel.textColor = [self giveColorfromStringColor:@"redColor"]; 
```

# tastypie - 外键的 POST 和 PUT 中的 Tastypie 错误：* 之后的 add() 参数必须是一个序列

> ID：15456302
> 
> 赞同：3
> 
> 时间：2013-03-17T00:22:17.527
> 
> 标签：tastypie

**我在尝试使用 POST 和 PUT 运行 CURL 时收到以下错误消息： {"error_message": "add() argument after * must be a sequence, not Task"**

1）*这是我正在尝试的命令：*

```
$ curl --dump-header - -H "Content-Type:application/json" -X POST --data '{"tex
t":"create project plan","creator":"/user/user/2/"}' http://127.0.0.1:8000/task/
task/ 
```

2）*这些是我的模型资源：（任务和用户是具有FK关系的两个模型）*

```
class UserResource(ModelResource):
    tasks=fields.OneToManyField('challenge.api.TaskResource','tasks')
    class Meta:
        allowed_methods = ['get','delete','post']
        authorization= Authorization()
        queryset = User.objects.select_related().all()        
        include_resource_uri = False        
        filtering = {
            'user_id': ALL
        }    
class TaskResource(ModelResource):
    creator=fields.ForeignKey('task.api.UserResource','creator',related_name='tasks')
    class Meta:
        allowed_methods = ['get','post','put']
        authorization= Authorization()
        queryset=Task.objects.select_related().all()
        include_resource_uri = False
        fields = ['text']
        excludes = ['id']                
        filtering = {
            'creator': ALL_WITH_RELATIONS
        } 
```

有没有人遇到过这个问题？有什么解决办法？任何帮助是极大的赞赏。在过去的三天里一直在尝试这个，但没有运气。Tastypie 文档不是那么好。

# c++ - 嵌套命名空间没有看到使用“使用指令”嵌套在另一个命名空间中的类

> ID：15456303
> 
> 赞同：2
> 
> 时间：2013-03-17T00:22:20.123
> 
> 标签：c++, visual-studio-2010, namespaces

命名空间 'w' 没有看到通过使用“使用命名空间 x::y::z;”嵌套在命名空间 x::y::z 中的类 'z' 声明。我正在使用 Visual Studio 2010。出了什么问题？

```
//...
namespace x
{
    namespace y
    {
        namespace z
        {
            class z
            {
            public:
                z(){};
            };
        }
    }
}
using namespace x::y::z; // normal declaration
namespace x
{
 namespace y
 {
  namespace w
  {
   class w
   {
    z object; // Here is the problem. Type 'z' is underlined in visual studio!
              // When I did like this:
              // x::y::z::z object;
              // everything is compiling properly
   };
  }
 }
}
int main()
{
    z object;       // no problem - I declared namespace above
    x::y::z::z object2; // also no problem
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:17:25.323

这是因为 `z`命名空间和`z`类之间的名称冲突。将类名更改`c`为例如，一切都会像[这里](http://codepad.org/rpGiVJCQ)一样正常工作。

顺便说一句，尽量避免*using-directive*，因为它有时会让人头疼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T00:34:02.930

不是因为你已经`class w`在`x::y::w`命名空间和命名空间中的类 z 中了`x::y::z`吗？

即使您说`using namespace x::y::z`，当您开始声明新空间时，我认为没有考虑到这一点-意味着名称空间`w`无法看到`z`

但是，您可以做的是利用和`x::y`共享的事实。你看不到CLASS，但你可以看到NAMESPACE，因为它在里面（也在里面）。所以你可以去：`w``z``z``z``y``w`

```
class w {
    z::z object;
} 
```

我测试的小例子是：

```
#include <iostream>
namespace x {
    namespace y {
        namespace z {
            class z {
            public:
                z() { cout << "x::y::z::z" << endl; }
            }
        }
    }
}
namespace x {
    namespace y {
        namespace w {
            class w {
                z::z object;
            public:
                w() { cout << "x::y::w::w" << endl; }
            }
        }
    }
}
int main(int argc, char* argv[]) {
    x::y::w::w object;
    return 0;
} 
```

这个的输出是：

```
x::y::z::z
x::y::w::w 
```

# jquery - 无法在 spring mvc 表单中使用 ajax

> ID：15456307
> 
> 赞同：2
> 
> 时间：2013-03-17T00:23:06.783
> 
> 标签：jquery, ajax, json, spring-mvc

我正在尝试在 spring mvc 中以表单形式实现基于 ajax 的帖子。

这是我的代码：

```
<form:form method="POST" commandName="emailDomain">
    <form:textarea path="emailText" rows="5" id="emailList"
        placeholder="Write emails to submit us, saperated by ';'"
        style="width: 100%" />

<form:select items="${categoryMap}" path="categoryId" id="categoryList"
    onchange="showEmails()" />

    <br />
    <p align="center">
        <button type="button" value="Submit" id="submitEmails">Submit emails</button>
    </p>
    <p align="center" class="text-info">${var}</p>
</form:form> 
```

我的ajax代码是：

```
<script type="text/javascript"
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script>

     <script type="text/javascript">
     function showEmails() {

            var categoryId = $('#categoryList').val();
    var emailText = $('#emailList').val();

    $.ajax({
        type : "POST",
        url : "http://localhost:8081/chatbooster/forms/email.html?cat=1",
                data : "categoryId=" + categoryId + "&emailText=" + emailText,
        success : function(response) {

        },
        error:function (xhRequest, ErrorText, thrownError) {
            alert('Error: '  + '  ' + thrownError);
        }
    });
} 
```

问题是单击按钮后，它显示错误作为警报，但没有任何解释。之后它会跳转到显示 json 响应的页面。如果我根本不使用弹簧形式标签，该代码将起作用。它不会显示任何错误，也不会显示 json 响应，但同样，我将无法从数据库中填充选择下拉列表。

我的控制器是：

```
@Controller
  @RequestMapping(value = "/email.html")
  public class EmailController{

    @RequestMapping(method = RequestMethod.GET)
      public String showForm(Model model,
          @RequestParam(value = "cat", required = true) String category,
          HttpServletRequest request, HttpServletResponse response) {
        clearSession(request, response);

        return "email";
      }

    @RequestMapping(value = "/submitemails", method = RequestMethod.GET)
      public @ResponseBody
      String submitAndRefreshEmails() {
        System.out.println("check");

        return "email";
      }

    @RequestMapping(method = RequestMethod.POST)
      public @ResponseBody
      EmailJsonResponse addEmail(@Valid EmailDomain emailDomain,
          BindingResult result,
          @RequestParam(value = "cat", required = true) String category,
          HttpServletRequest request, HttpServletResponse response)
      throws Exception {

        //return emailjsonresponse object, a simple object carrying few ints and strings

      }

    @ModelAttribute("categoryMap")
      public Map<Long, String> populateCategoryList(
          @RequestParam(value = "cat", required = true) String category)
      throws Exception {

        // populating drop down 

      }

  } 
```

我已经阅读了很多关于此的讨论，但我不知道如何使它成为这样的情况？任何人都可以在这里帮助我吗？我指的是这个例子[http://www.javacodegeeks.com/2012/02/spring-mvc-and-jquery-for-ajax-form.html](http://www.javacodegeeks.com/2012/02/spring-mvc-and-jquery-for-ajax-form.html)

**编辑1：**

我什至尝试过这个新的：

```
<script type="text/javascript">
  $(document).ready(function() {
      $('#submitEmails').onclick(function() {
          $.getJSON('http://localhost:8081/chatbooster/forms/submitemails.html?cat=1',
                {
                    categoryId : $('#categoryList').val(),
                    emailText : $('#emailList').val(),
                    ajax : 'true'
                }, 
                function(data) {
                    alert('data found');
                }
          );
      });
  }); 
```

但我仍然被显示为 json 响应。我无法理解为什么会这样？我试过这个[http://rockhoppertech.com/blog/spring-mvc-3-cascading-selects-using-jquery/](http://rockhoppertech.com/blog/spring-mvc-3-cascading-selects-using-jquery/)。当我不使用弹簧表单组件时，我能够实现 ajax。但这会给我从数据库中填充下拉元素带来麻烦。我缺少一些东西。有什么想法吗？

**编辑 2**

现在我明白了这个问题的原因是什么。正是我提交的表单最终导致我收到 json 响应。我需要做的是从按钮调用jquery函数，使按钮类型的提交按钮而不是提交类型。单击该按钮将调用与控制器的 GET 请求类型相关的方法。但为此，我需要在单击提交按钮时调用 submitAndRefreshEmails 方法。谁能告诉我该怎么做？当控制器中有许多此类方法时，如何调用 GET 类型的特定方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T23:24:32.600

由于您正在进行 AJAX 调用，因此您希望在不（重新）加载 HTML 页面的情况下返回一段信息（您的 JSON 数据）。因此使用`@ResponseBody`.

如果 AJAX 调用绑定到表单提交，它将触发页面加载（我似乎找不到解释这一点的好来源）。因此，您将需要停止默认行为。

```
$form.bind('submit', function(e) {
    $.post('epdReviewSaveChanges.json', mData, function(response) {
            //do stuff...
    }

    e.preventDefault();
    return false;
}); 
```

上面的一点解释，取自[这里](http://css-tricks.com/return-false-and-prevent-default/)。

`e.preventDefault()`该代码的一部分阻止浏览器执行默认操作。 `return false;`更进一步，它还可以防止该事件传播（或“冒泡”）DOM。

我怀疑您最初遇到的问题与如何使用 AJAX 调用/Spring 有关。我不是在谈论任何可能需要额外/不同解决方案的跨域问题。

**问题2**关于映射到控制器内的特定方法，您可以使用`value`来区分不同的调用。前任：

```
@RequestMapping(value="/Upload.html",method = RequestMethod.POST) 
```

# php - iPhone 上的 Smotri 视频？

> ID：15456314
> 
> 赞同：-1
> 
> 时间：2013-03-17T00:24:13.940
> 
> 标签：php, jquery, html, video

如果你们认为可以在嵌入中使用来自 Smotri.com 的视频并使其适用于您网站上的 iphone。因为如果您访问 smotri 网址，它将在 iphone 上运行。

我曾尝试将漏洞网站包装在 iframe 中，但它会将我移动到 smotri.com，而不是在 iframe 中显示它。

有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:29:01.180

iPhone 甚至支持 Flash 吗？

无论如何，您不需要做IFrame，只需像这样嵌入flash部分。

```
<embed type="application/x-shockwave-flash" src="http://pics.smotri.com/player.swf?b6e93d762830bd9aa5c8d1e4e668be97" width="640" height="360" id="video93707" name="video93707" bgcolor="#FFFFFF" quality="high" wmode="opaque" allowfullscreen="true" allowscriptaccess="always" base="http://pics.smotri.com" flashvars="file=v23756861434&amp;autoStart=true&amp;logo=false&amp;auth=0&amp;str_lang=rus&amp;settings=http://pics.smotri.com/cskins/blue/skin_ng.xml&amp;xmldatasource=http://pics.smotri.com/cskins/blue/skin_ng.xml&amp;context=%7B%22c_id%22%3A2375686%2C%22c_uid%22%3A9061678%2C%22c_rubric%22%3A%221%22%2C%22c_doubtful%22%3A0%2C%22c_tags%22%3A%5B%5D%2C%22c_mod%22%3A%5B-1%5D%2C%22u_id%22%3A%22g_14cbe120eaa2eb7c92025929eedf1494_a871%22%2C%22u_ip%22%3A%2283.99.236.218%22%2C%22u_auth%22%3A0%2C%22p_pr_id%22%3A13%2C%22c_section%22%3A%5B%2215%22%2C%2214%22%5D%7D"> 
```

小提琴：http: [//jsfiddle.net/kWm7g/](http://jsfiddle.net/kWm7g/)

# r - 在 RCurl 中创建 C 级文件句柄，用于写入下载的文件

> ID：15456317
> 
> 赞同：8
> 
> 时间：2013-03-17T00:24:25.687
> 
> 标签：r, curl, rcurl

在 RCurl 中，定义了一个函数和一个类`CFILE`来处理 C 级文件句柄。从手册：

> 目的是能够将这些作为选项传递给 libcurl，以便它可以读取或写入文件。我们也可以使用 R 连接来执行此操作，并指定操作这些连接的回调函数。但是对于大文件，使用 C 级 FILE 句柄可能会明显更快。

没有与下载相关的示例，所以我尝试了：

```
library(RCurl)
u = "http://cran.r-project.org/web/packages/RCurl/RCurl.pdf"
f = CFILE("RCurl.pdf", mode="wb")
ret= getURL(u,  write = getNativeSymbolInfo("R_curl_write_binary_data")$address,
                file  = f@ref) 
```

我还尝试将`file`选项替换为`writedata = f@ref`. 文件已下载，但已损坏。为参数编写自定义回调`write`仅适用于非二进制数据。

在 RCurl 中将二进制文件直接下载到磁盘（而不将其加载到内存中）的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-17T16:43:13.330

我想你要使用`writedata`并记得关闭文件

```
library(RCurl)
filename <- tempfile()
f <- CFILE(filename, "wb")
url <- "http://cran.fhcrc.org/Rlogo.jpg"
curlPerform(url = url, writedata = f@ref)
close(f) 
```

对于更详细的写作，我不确定这是否是最好的方式，但 Linux 告诉我，从

```
man curl_easy_setopt 
```

有一个 curl 选项 CURL_WRITEFUNCTION 它是一个指向带有原型的 C 函数的指针

```
size_t function(void *ptr, size_t  size, size_t nmemb, void *stream); 
```

在 ?curlPerform 末尾的 R 中有一个调用 C 函数作为“writefunction”选项的示例。所以我创建了一个文件 curl_writer.c

```
#include <stdio.h>

size_t
writer(void *buffer, size_t size, size_t nmemb, void *stream)
{
    fprintf(stderr, "<writer> size = %d, nmemb = %d\n",
            (int) size, (int) nmemb);
    return size * nmemb;
} 
```

编译它

```
R CMD SHLIB curl_writer.c 
```

在 Linux 上生成一个文件 curl_writer.so，然后在 R

```
dyn.load("curl_writer.so")
writer <- getNativeSymbolInfo("writer", PACKAGE="curl_writer")$address
curlPerform(URL=url, writefunction=writer) 
```

并上 stderr

```
<writer> size = 1, nmemb = 2653
<writer> size = 1, nmemb = 520
OK 
```

这两个想法可以整合，即使用任意函数写入任意文件，通过修改C函数使用我们传入的FILE *，如

```
#include <stdio.h>

size_t
writer(void *buffer, size_t size, size_t nmemb, void *stream)
{
    FILE *fout = (FILE *) stream;
    fprintf(fout, "<writer> size = %d, nmemb = %d\n",
            (int) size, (int) nmemb);
    fflush(fout);
    return size * nmemb;
} 
```

然后在编译后返回 R

```
dyn.load("curl_writer.so")
writer <- getNativeSymbolInfo("writer", PACKAGE="curl_writer")$address
f <- CFILE(filename <- tempfile(), "wb")
curlPerform(URL=url, writedata=f@ref, writefunction=writer)
close(f) 
```

`getURL`也可以在这里使用，前提是`writedata=f@ref, write=writer`；我认为原始问题中的问题`R_curl_write_binary_data`实际上是一个内部函数，写入由 RCurl 管理的缓冲区，而不是像`CFILE`. 同样，指定`writedata`without `write`（从源代码看来 getURL 是 writefunction 的别名）将指向文件的指针发送到期望指向其他指针的函数；对于 getURL，需要提供 writedata 和 write。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T20:07:53.543

我也在解决这个问题，但还没有答案。

但是，我确实发现了这个：

[http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTWRITEDATA](http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTWRITEDATA)

你在 Windows 下使用 R 吗？我是。

writedata 函数的此文档表明，在 Windows 上，您*必须*将 writefunction 与 writedata 一起使用。

在这里阅读：[http](http://www.omegahat.org/RCurl/RCurlJSS.pdf) ://www.omegahat.org/RCurl/RCurlJSS.pdf 我发现 RCurl 期望 writefunction 是一个 R 函数，所以我们可以自己在 Windows 上实现它。它会比使用 C 函数写入数据要慢，但我敢打赌，网络链接的速度将是瓶颈。

```
getURI(url="sftp://hostname/home/me/onegeebee", curl=con, write=function(x) writeChar(x, f, eos=NULL))
Error in curlPerform(curl = curl, .opts = opts, .encoding = .encoding) : embedded nul in string: ' <`á\017_\021 
```

（这是在服务器上创建一个 1GB 的文件以测试传输速度之后）

I haven't yet found an answer that doesn't choke on NUL bytes in the data. It seems that somewhere in the bowels of the RCurl package when it's passing data up into R to execute the writefunction you supply, it tries to convert the data into a character string. It must not do that if you use a C function. Notably using the recommended R_curl_write_binary_data callback along with CFILE kills rsession.exe on win32 every time for me.

# docx - 在 docx 文件中创建超链接的允许方法是什么？

> ID：15456324
> 
> 赞同：4
> 
> 时间：2013-03-17T00:25:21.210
> 
> 标签：docx

我目前正在开发一个库，该库将 docx 文件作为输入并使用它来构建 html 页面，由于 docx 的文档模糊且缺乏，我必须严重依赖示例输出来决定如何处理某些事情。其中之一是超链接。

据我目前所见，docx 至少有两种超链接方式：

*   锚 -`<w:hyperlink w:anchor="_Toc000000000" history="1"></w:hyperlink>`

    这似乎是做 toc-links 之类的最喜欢的方式。

*   ID -`<w:hyperlink w:id="rId7" history="1"></w:hyperlink>`

    这似乎是为超链接指定 url 的唯一方法（在`.xml.rels`文件中定义了 id）

到目前为止一切顺利，我的问题是我遇到了文件，它们简单地指定了“超链接”的 rStyle（在 textrun 对象上）值，然后似乎相信这将使文本充当指向指定标题的超链接文本运行。

例如，一个文档可以包含以下内容：

```
<w:p>
  <w:pPr>
    <w:pStyle w:val="Heading1"/>
  </w:pPr>
  <w:r>
    <w:t>Introduction</w:t>
  </w:r>
</w:p> 
```

然后再往下走：

```
<w:p>
  <w:r>
    <w:t>This is a hyperlink to </w:t>
  </w:r>
  <w:r>
    <w:rPr>
      <w:rStyle w:val="Hyperlink"/>
    </w:rPr>
    <w:t>Introduction</w:t>
  </w:r>
  <w:r>
    <w:t>.</w:t>
  </w:r>
</w:p> 
```

所以我的问题是，这些“超链接”（`w:p`而不是`w:hyperlink`）实际上是否有效，或者只是我所拥有的文件的作者做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:44:49.903

当您说 docx 格式模糊且缺乏文档时，您是否查看过规范？[http://www.ecma-international.org/publications/standards/Ecma-376.htm](http://www.ecma-international.org/publications/standards/Ecma-376.htm)（虽然我确实发现它们在关键点上含糊不清。）

我知道至少有两种创建链接的方法。w:hyperlink 就是其中之一。

该`w:hyperlink`元素要么在内部链接，要么在外部链接，并且或多或少地按照您发现的方式工作。

在外部超链接的情况下，它将有一个关系 id，以及该文档的关系中的一个条目，该条目标记为具有 uri 的外部。规范说如果超链接是外部的，锚属性应该被忽略，但在实践中，我发现Word会在这里粘贴外部url的锚部分。例如，将在没有关系的`http://example.com/page#myAnchor`情况下存储 uri ，并且属性将具有“myAnchor”而没有“#”。您可能需要同时检查两者。`#myAnchor``anchor``hyperlink`

对于内部超链接，锚点应该与元素的`name`属性相 匹配`w:bookmarkStart`，或者是一个特殊的值，如“_GoBack”或“_top”。

第二种情况是链接的图像，不幸的是，这要复杂得多。将有一个`w:drawing`用于图像的`docPr`元素，该`hlinkClick`元素将具有与目标的关系 id。此时规范似乎有点不清楚，但看看 Word 做了什么，看起来如果关系是内部的，它将是一个书签名称（带有 '#' 前缀），如果是外部的，一个 uri。

# java - Unix环境下如何计算CPU和IO时间

> ID：15456335
> 
> 赞同：0
> 
> 时间：2013-03-17T00:26:49.040
> 
> 标签：java, rest, unix, io, cpu-time

我有一个简单`Multithreaded program`的方法，它正在调用一个`External API`并从该 API 获取响应。我正在使用`RestTemplate`.

**问题陈述：-**

我试图找出

`What is the estimated CPU and IO time for these calls?`

我在 Ubuntu 工作。

下面是我的程序-

```
public class RestLnPTest {

    private final static Logger LOG = Logger.getLogger(NokiaLnPTest.class.getName());
    private static int noOfThreads = 10;

    public static void main(String[] args) {

        ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

        try {

            for (int i = 0; i < 100 * noOfThreads; i++) {
                service.submit(new ThreadTask());
            }

            service.shutdown();
            service.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS);

        } catch (InterruptedException e) {

        } catch (Exception e) {

        } finally {
            logHistogramInfo();
        }
    }

    private static void logHistogramInfo() {

     System.out.println(ThreadTask.lookupHistogram);

    }
}

class ThreadTask implements Runnable {

    public static ConcurrentHashMap<Long, AtomicLong> lookupHistogram = new ConcurrentHashMap<Long, AtomicLong>();
    private static final String URL = "SOME_URL";

    @Override
    public void run() {

        RestTemplate restTemplate = new RestTemplate();

        long start = System.nanoTime();

        String result = restTemplate.getForObject(URL, String.class);

        long end = System.nanoTime() - start;

        final AtomicLong before = lookupHistogram.putIfAbsent(end / 1000000, new AtomicLong(1L));

        if (before != null) {
            before.incrementAndGet();
        }
    }
} 
```

我在 Ubuntu 的命令行中运行上述程序 -

`java - jar REST.jar`

谁能一步一步告诉我如何在 Unix 环境中解决这些调用`CPU`？`IO time`我只需要粗略估计这些电话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:55:48.497

如果“外部调用”是外部应用程序的执行（例如 via `exec()`），您可以（理论上）通过将应用程序包装在其中`time`或使用`ac`进程记帐内容来获取一些统计信息。

但是，您似乎想找出服务用于处理单个请求的资源。除了让服务本身来衡量和报告它之外，没有办法获得这些信息。

您可以从外部（即从客户端）捕获的唯一内容是每个请求的经过时间。

# c++ - 模板替换在调试构建中失败，但在优化构建中工作？

> ID：15456337
> 
> 赞同：3
> 
> 时间：2013-03-17T00:26:58.720
> 
> 标签：c++, c++11, linker, compiler-optimization, template-specialization

我遇到了一个奇怪的问题，其中编译的代码`-Ox`编译得很好，但是编译的代码`-g`在链接上失败，并出现以下错误：

```
Undefined symbols for architecture x86_64:
  "stupid<dummy>::t", referenced from:
      stupid<dummy>::operator()(int, int) const in main.o 
```

重现此问题的代码：

```
struct dummy { void operator()(const int a, const int b) const {} ; };

template <typename  T>
struct stupid {
 constexpr static T t = T(); // create a new one;

 stupid() {};
 void operator()(int a, int b) const { t(a, b); }
};

int main()
{
 const stupid<dummy> a;
 a( 1, 2 );
} 
```

似乎当代码被优化时，函数被内联并且不要求外部函数调用，但是当代码没有被优化时，函数被调用但不存在？（我不确定为什么它不存在......）。这发生在 g++ 4.7 和 4.8 以及 clang 3.2 中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:37:28.940

您可以通过添加来解决此问题

```
template<typename T> constexpr const T stupid<T>::t; 
```

的定义之后`stupid`。

这是因为调用非静态成员函数 `t`需要将地址`t`作为`this`指针使用。获取对象的地址使其需要运行时实例，这需要上述定义。

# playframework - 当我在 lib 目录中包含自定义 jar 时出错 - 播放框架 2.0

> ID：15456344
> 
> 赞同：1
> 
> 时间：2013-03-17T00:27:41.280
> 
> 标签：playframework, playframework-2.0, akka, apache-commons-io

当我在 lib 目录中包含我的一组非托管 jar 时，我在任何 POST 请求中都会收到此错误。如果我删除 lib 目录，一切正常。如果它在那里，我会收到这个错误。有什么想法吗？

```
play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NoSuchMethodError: org.apache.commons.io.IOUtils.closeQuietly(Ljava/io/Closeable;)V]]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [play_2.9.1.jar:2.0.4]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [play_2.9.1.jar:2.0.4]
at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2]
at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.4]
at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.2]
at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.jar:2.0.2]
Caused by: java.lang.NoSuchMethodError: org.apache.commons.io.IOUtils.closeQuietly(Ljava/io/Closeable;)V
at org.apache.commons.io.FileUtils.doCopyFile(FileUtils.java:1150) ~[commons-io-2.4.jar:2.4]
at org.apache.commons.io.FileUtils.copyFile(FileUtils.java:1091) ~[commons-io-2.4.jar:2.4]
at org.apache.commons.io.FileUtils.copyFile(FileUtils.java:1038) ~[commons-io-2.4.jar:2.4]
at controllers.IAcontroller.submit(IAcontroller.java:161) ~[classes/:na]
at Routes$$anonfun$routes$1$$anonfun$apply$13$$anonfun$apply$14.apply(routes_routing.scala:132) ~[classes/:na]
at Routes$$anonfun$routes$1$$anonfun$apply$13$$anonfun$apply$14.apply(routes_routing.scala:132) ~[classes/:na] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T12:05:26.163

AFAIK，Play 2.0.4`commons-io:commons-io:2.0.1`通过 selenium 包含本身由 fluentlenium 带来的。而且我怀疑您`commons-io`在`lib`文件夹中导入了不同版本的 。

您可以`dependencies`在 Play 控制台上使用以下命令进行检查：

```
[my_project] $ dependencies
...
| commons-io:commons-io:2.0.1 | org.seleniumhq.selenium:selenium-firefox-driver:2.16.1 | As commons-io.jar |
...
[my_project] $ 
```

因此，要么从你的 lib 目录中删除 Play 的依赖项（如果你不使用 fluentlenium）。

要从中删除传递依赖项`fluentlenium`，请编辑您`Build.scala`的：

```
val appDependencies = Seq(
     ...
     ("org.fluentlenium" % "fluentlenium-festassert" % "0.5.6" % "test") .exclude("commons-io", "commons-io")
    ) 
```

# performance - Neo4j Cypher 在无向图中发现路径缓慢

> ID：15456345
> 
> 赞同：2
> 
> 时间：2013-03-17T00:27:46.430
> 
> 标签：performance, neo4j, cypher

在具有 165k 节点和 266k 关系的图中，我想运行以下 Cypher 查询：

```
START n=node:NodeIds('id:firstId'), t=node:NodeIds('id:secondId')   
MATCH (n)-[:RELATIONSHIP_TYPE*1..3]-(t)   
RETURN count(*) 
```

其中`firstId`和`secondId`是 NodeIds Lucene 索引的有效条目。

从 Neo4j 控制台执行查询大约需要 4 秒，我想了解它为什么这么慢以及如何使它更快。

从此索引查找大约需要 40 毫秒（即只返回两个节点的查询需要这么多），所以这不是问题。

我从 Neo4j.bat 开始使用默认设置在 Windows 8 机器上运行 Neo4j。我不认为硬件可能是一个问题，因为查询只会导致短暂的 10% CPU 峰值和几乎不可见的磁盘使用峰值。

顺便说一句，第一个节点的度数为 40，第二个为 2，结果为 1。

任何帮助，将不胜感激。

**编辑1，内存配置：**

我从 Neo4j.bat 开始使用 OOTB 配置运行 Neo4j，并使用以下有关内存的默认值（如果我没记错的话，这些是唯一与内存相关的配置）：

```
wrapper.java.initmemory=16
wrapper.java.maxmemory=64

neostore.nodestore.db.mapped_memory=25M
neostore.relationshipstore.db.mapped_memory=50M
neostore.propertystore.db.mapped_memory=90M
neostore.propertystore.db.strings.mapped_memory=130M
neostore.propertystore.db.arrays.mapped_memory=130M 
```

在黑暗中拍摄一个我将这些值提高到以下值：

```
wrapper.java.initmemory=128
wrapper.java.maxmemory=1024

neostore.nodestore.db.mapped_memory=225M
neostore.relationshipstore.db.mapped_memory=250M
neostore.propertystore.db.mapped_memory=290M
neostore.propertystore.db.strings.mapped_memory=330M
neostore.propertystore.db.arrays.mapped_memory=330M 
```

这确实增加了 Neo4j 的内存使用量（我的意思是运行 Neo4j 的 java.exe 实例的内存使用量）而没有很好地提高性能（查询花费的时间大致相同，偶尔可能增加 2-300 毫秒）。有 GB 的 RAM 可用，因此没有硬件限制。

**编辑 2，分析器数据：** 为相关查询运行分析器会产生以下结果：

```
neo4j-sh (0)$ profile START n=node:NodeIds('id:4000'), t=node:NodeIds('id:64599') MATCH path = (n)-[:ASSOCIATIVY_CONNECTION*1..3]-(t) RETURN count(*);
==> +----------+
==> | count(*) |
==> +----------+
==> | 1        |
==> +----------+
==> 1 row
==> 0 ms
==> 
==> ColumnFilter(symKeys=["  INTERNAL_AGGREGATE-939275295"], returnItemNames=["count(*)"], _rows=1, _db_hits=0)
==> EagerAggregation(keys=[], aggregates=["(  INTERNAL_AGGREGATE-939275295,CountStar)"], _rows=1, _db_hits=0)
==>   ExtractPath(name="path", patterns=["  UNNAMED3=n-[:ASSOCIATIVY_CONNECTION*1..3]-t"], _rows=1, _db_hits=0)
==>     PatternMatch(g="(n)-['  UNNAMED3']-(t)", _rows=1, _db_hits=0)
==>       Nodes(name="t", _rows=1, _db_hits=1)
==>         Nodes(name="n", _rows=1, _db_hits=1)
==>           ParameterPipe(_rows=1, _db_hits=0) 
```

它说 0ms 但我不知道这应该是什么意思：结果在几秒钟后返回，并且在数据浏览器的控制台中执行的相同查询大约需要 3.5 秒（这是它显示的）并且大致相同的数量通过 RESTful 端点获取的时间。

**编辑3，真实数据集：** 理论已经够了:-)，这是我真正在谈论的数据集：http: [//associativy.com/Media/Default/Associativy/Wiki.zip](http://associativy.com/Media/Default/Associativy/Wiki.zip)这是一个生成的图表通过使用从维基百科转储文件创建的维基百科文章之间的链接。这仅仅是个开始。

我试图运行的真正查询实际上是以下查询，返回构建两个节点之间路径的节点：

```
START n=node:NodeIds('id:4000'), t=node:NodeIds('id:64599')   MATCH path = (n)-[:ASSOCIATIVY_CONNECTION*1..3]-(t)   RETURN nodes(path) AS Nodes 
```

我展示了 count 查询，因为我想要显示症状的最简单查询。

**编辑4：**

我专门针对路径返回查询[打开了另一个问题。](https://stackoverflow.com/questions/15549573/optimize-neo4j-cypher-path-finding-with-limited-paths-in-an-undirected-graph)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T23:36:32.073

我同意韦斯的观点，这应该会立即返回。

您升级配置是有道理的，这是在 2 个不同的配置文件中，对吧？

当您在 Windows 上运行时，MMIO 位于 Java 堆内，所以我会将其设置为：

wrapper.java.initmemory=4096 wrapper.java.maxmemory=4096

返回的路径有多长？在您的领域中指定方向是否有意义？

您能否运行以下命令（使其适应返回的路径长度）

```
START n=node:NodeIds('id:4000'), 
      t=node:NodeIds('id:64599') 
MATCH path = (n)-[:ASSOCIATIVY_CONNECTION]-(a)
             (a)-[:ASSOCIATIVY_CONNECTION]-(b)-[:ASSOCIATIVY_CONNECTION]-(t) 
RETURN count(*), count(distinct a), count(a), count(distinct b), count(b); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T01:45:25.583

您正在运行 1.9 里程碑版本吗？1.9 中的双向匹配器可能会比 1.8.x 做得更好。

# php - 从数组中删除项目

> ID：15456352
> 
> 赞同：0
> 
> 时间：2013-03-17T00:29:19.740
> 
> 标签：php, arrays, array-unset

我有一个格式如下的数组：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [LASTNAME] => Name
            [FIRSTNAME] => Name
    )
    [1] => Array
        (
            [id] => 2
            [LASTNAME] => Name
            [FIRSTNAME] => Name
    ) 
```

等等。我希望从数组的每个部分中删除姓氏和其他项目。

我尝试了以下代码，但无济于事。

```
foreach($s as $key => $object) {

    foreach($object as $key=>$value) {

            if ($key == "LASTNAME") {
                unset( $s['LASTNAME'] );
                }
            }
        } 
```

关于我做错了什么的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:34:39.410

尝试这个：

```
foreach ($s as &$object) {
    unset($object['LASTNAME']);
} 
```

您的问题是您正在对副本进行操作，`&`将为您提供参考，正如我的示例中所示，您不必遍历数组来检查里面是否有特定的键，只需删除它 -`unset`不会上升如果它不存在则错误。

* * *

即使在您的示例中，您也尝试从中删除`'LASTNAME'`而`$s`不是从其子项中删除，但是无论如何，请尝试我的答案，它应该对您有用；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:34:30.577

您正在从错误的数组中恢复。

为每个循环存储当前密钥将有助于：

```
foreach($s as $key1 => $object) {
    foreach($object as $key2=>$value) {
        if ($key2 == "LASTNAME") {
            unset( $s[$key1][$key2] );
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T00:37:03.837

```
<?php 
$array = Array(
    0 => Array(
            'id' => 1,
            'LASTNAME' => 'Name',
            'FIRSTNAME' => 'Name'
    ),
    1 => Array(
            'id' => 2,
            'LASTNAME' => 'Name',
            'FIRSTNAME' => 'Name'
    )
);

foreach($array as $key=>$value){
    unset($array[$key]['LASTNAME']);
}

echo '<pre>',print_r($array),'</pre>';
?> 
```

# java - 通过单击其他 JFrame 中的按钮刷新 JFrame 中的 JTable

> ID：15456356
> 
> 赞同：1
> 
> 时间：2013-03-17T00:29:25.797
> 
> 标签：java, swing, netbeans, jtable, jframe

我们有这个 Java 101 类，我们使用的是 Netbeans 7.2.1。截至目前，我们正在从数据库（MySql）添加数据。我有这个问题：

我两 (2) `JFrame`- `mainFrame`(1), `addForm`(2)

在`mainFrame`I use table to view my data ( `LastName`, `FirstName`) 和 (add) 按钮中，我得到了 (refresh) 按钮，每次更改表格时我都会单击它来刷新表格。在第二帧 ( `addForm`) 中，我得到了文本字段 (for `lastname`, `firstname`) 和 ( `save`) 按钮。

## 设想

从`mainFrame`我单击 ( `add`) 按钮，然后`addForm`出现。我向 ( `LastName`, `FirstName`) 字段提供数据并单击`Save`按钮以保存数据。之后，我需要返回`mainFrame`单击`refresh`按钮以查看新添加到表中的数据。

## 问题

保存数据后有没有办法自动刷新我`JTable`的数据？

因为当我单击已保存时，它不会出现在表格中，我总是单击`refresh`以`mainFrame`查看它。`JFrame`仅使用一个（从 youtube 教程学分到上传者）时，我可以自动看到它。

希望有时间教我。我已经通过互联网搜索但未能掌握答案。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T00:32:05.923

这个问题在这个网站上被问了很多，解决方案几乎总是一样的：

如果您需要让用户处理主窗口所依赖的输入，当您需要模态对话框时，不要使用第二个 JFrame。使用模态 JDialog 或 JOptionPane 来显示您的依赖窗口。当你这样做时，来自主窗口的程序流程将被中断，直到对话框被完全处理完，这样主程序很容易检测到用户何时完成了以依赖窗口为程序的操作当依赖窗口模型对话框显示后，流程将立即恢复。然后，您可以查询相关窗口显示的字段，并使用包含的信息来更新您的 JTable 模型。

请注意，另一个选项是将第二个视图显示为主窗口上的新视图，使用 CardLayout 交换视图。

另一方面，如果主窗口不完全依赖于处理第二个窗口的用户，则考虑将其显示为非模态对话框或通过 CardLayout 或 JTabbedPane 显示为单独的视图。

例如：

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;

import javax.swing.*;
import javax.swing.table.DefaultTableModel;

public class DialogEg {

   private static void createAndShowGui() {
      MainWin mainPanel = new MainWin();

      JFrame frame = new JFrame("DialogEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

class MainWin extends JPanel {
   private String[] COL_NAMES = { "Last Name", "First Name" };
   private DefaultTableModel model = new DefaultTableModel(COL_NAMES, 0);
   private JTextField lastNameField = new JTextField(15);
   private JTextField firstNameField = new JTextField(15);

   public MainWin() {
      final JPanel dataPanel = new JPanel();
      dataPanel.add(new JLabel("Last Name:"));
      dataPanel.add(lastNameField);
      dataPanel.add(Box.createHorizontalStrut(15));
      dataPanel.add(new JLabel("First Name:"));
      dataPanel.add(firstNameField);

      JPanel btnPanel = new JPanel();
      btnPanel.add(new JButton(new AbstractAction("Add Name") {

         @Override
         public void actionPerformed(ActionEvent arg0) {
            lastNameField.setText("");
            firstNameField.setText("");
            int result = JOptionPane.showConfirmDialog(MainWin.this, dataPanel,
                  "Enter Name", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE);
            if (result == JOptionPane.OK_OPTION) {
               String lastName = lastNameField.getText();
               String firstName = firstNameField.getText();
               Object[] dataRow = new String[] { lastName, firstName };
               model.addRow(dataRow);
            }
         }
      }));

      setLayout(new BorderLayout());
      add(new JScrollPane(new JTable(model)), BorderLayout.CENTER);
      add(btnPanel, BorderLayout.SOUTH);

   }
} 
```

# mysql - SQL：选择二进制值

> ID：15456363
> 
> 赞同：0
> 
> 时间：2013-03-17T00:31:56.450
> 
> 标签：mysql, binary

我有：

```
$token  = sha1(uniqid(mt_rand(), true)); 
```

然后我将使用`unhex('$token')`. 我如何选择这个值？

我试过了：

```
SELECT token FROM `name` WHERE `id` = 1 LIMIT 1 
```

如果我在其中回显它，它将显示为`0b7GÞ÷:‹xcÅ•½JAjdäáæ`而不是类似 `5dc012f007b7c4db7b9e076138fdd92fa1039530`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:35:44.987

我认为您不需要将其与 一起存储`UNHEX`，但您可以`SELECT HEX(token)`取回原始值。

# php - 请求facebook权限不起作用

> ID：15456369
> 
> 赞同：0
> 
> 时间：2013-03-17T00:33:35.343
> 
> 标签：php, facebook-graph-api

我有一个小的 facebook 脚本，它应该获得 user_about_me、publish_actions、publish_stream 权限。我在我的应用程序中设置了这些权限

![](../Images/63ae834a138ddce14ad3a6839d110a5c.png)

我的代码如下所示：

```
<?php
  require_once("src/facebook.php");

  $config = array();
  $config['appId'] = 'xxx';
  $config['secret'] = 'xxx';

  $facebook = new Facebook($config);

//2\. retrieving user
$user = $facebook->getUser();

//3\. requesting 'me' to API
$me = null;
if ($user) {
  try {
    $me = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
  }
}

//4\. login or logout
if ($me) {
    $logoutUrl = $facebook->getLogoutUrl();
} else {
    $loginUrl = $facebook->getLoginUrl();
}

?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>php-sdk</title>
  </head>
  <body>
    <?php if ($me): ?>
    <?php echo "Welcome, ".$me['first_name']. ".<br />"; ?>
    <a href="<?php echo $logoutUrl; ?>">
      Logout
    </a>
    <?php else: ?>
      <a href="<?php echo $loginUrl; ?>">
        Login
      </a>
    <?php endif ?>
  </body>
</html> 
```

但是当我通过 facebook 登录时，它只请求基本信息而不是发布权限。

![在此处输入图像描述](../Images/85fba695028534727a7d33fc33120633.png) 怎么了？

# c# - “着色”整个窗口，或使窗口看起来不活动的替代方法

> ID：15456372
> 
> 赞同：0
> 
> 时间：2013-03-17T00:33:57.673
> 
> 标签：c#, winforms

我有一个`winforms` `C#`打开多个对话框的应用程序。为了适应应用程序的风格，我删除了每个窗口的默认标题栏并创建了自己的标题栏（带有控制按钮和拖动移动功能）。

现在面临的问题是，如果没有标题栏，当手动将它们分开时，用户无法分辨哪个窗口是“活动”窗口（因此它们不会重叠）。

在任何 Windows 应用程序（使用标题栏）中，当您尝试从对话框导航回主程序时（不关闭对话框） - 它不会让您这样做。对话框的边框闪烁，您会听到 Windows 错误声音。某种等效的视觉反馈会很棒，而无需使用默认标题栏 - 并且将整个窗口着色为更暗似乎可以很好地解决问题。

类似这样的伪代码，可以在打开对话框时很好地着色父窗口：

```
// tint window now
window.ShowDialog();
// un-tint window 
```

我试图放置一个面板，覆盖所有颜色设置为“透明”的面板（目的是稍后控制面板的不透明度），但透明度似乎不起作用。实现这一目标的任何其他想法？或者有没有人有更好的建议来实现相同水平的视觉反馈？

**摘要**：有没有办法给整个窗口着色，或者用颜色覆盖它？如果没有，任何人都可以建议一种使窗口显示为“非活动”的替代方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:55:59.317

我建议您在要禁用的表单中创建一个方法：

```
void DisableForm()
{
    //some fancy color
    this.BackColor = System.Drawing.Color.Khaki;

    //and disable all controls owned by form, just to be sure
    foreach (var s in this.Controls)
    {
        ((Control)s).Enabled = false;
    }
} 
```

以及支持这些形式的功能。

编辑。您也可以将控件的可见性属性设置为 false

# symfony - 使用树枝重新定义最初在父视图中包含的视图中定义的块

> ID：15456373
> 
> 赞同：1
> 
> 时间：2013-03-17T00:34:02.923
> 
> 标签：symfony, include, block, twig, extends

我有一个包含定义块 Z 的视图​​ B 的视图 A。我可以有一个扩展 A 并重新定义块 Z 的视图​​ C 吗？

不用说，如果我将 B 粘贴到 A 中（不使用包含），它就可以工作。

举一个实际的例子：

A是项目的基础。B 是包含菜单的项目的标题。C 是项目的任何页面。

我为 B 中菜单的每个项目定义了一个 {% block active %}{% endblock %}，我想通过 C 中的 {% block active %} class="active" {% endblock %} 重新定义以应用某些当前活动菜单项的样式。

如果这不是要走的路，哪个是最好的解决方法/解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T04:32:00.887

不幸的是，这是不可能的，或者不会那么容易。

为什么不从控制器将变量绑定到模板并通过包含将其传递给导航？

```
{% include MyAwesomeBundle:Modules:nav.html.twig with {activeItem: activeItem, activeItemClassName: activeItemClassName} %} 
```

您想要的替代品

```
{# in base layout template #}
{% block nav %}
    {% include MyAwesomeBundle:Modules:nav.html.twig %}
{% endblock %}

{# in page template #}
{% extends base-layout.html.twig %}

{% block nav %}
    {% include MyAwesomeBundle:Modules:nav_for_news.html.twig %} {# nav_for_news.html.twig extends nav.html.twig #}
{% endblock %} 
```

这是你能从你想要的东西中得到的最接近的东西

查看有用的[parent() 树枝函数。](http://twig.sensiolabs.org/doc/functions/parent.html)

# android - 启动 Android DeskClock ScreensaverActivity

> ID：15456380
> 
> 赞同：3
> 
> 时间：2013-03-17T00:34:44.077
> 
> 标签：android, android-intent

有没有办法直接启动这个应用程序？

DeskClock 应用程序（来自源代码）通过以下方式启动：

```
case R.id.menu_item_night_mode:
                    startActivity(new Intent(DeskClock.this, ScreensaverActivity.class)); 
```

我试过了，但没有运气：

```
Intent intent = new Intent();
        intent.setComponent(new ComponentName("com.google.android.deskclock", "com.android.deskclock.ScreensaverActivity"));
        getActivity().startActivity(intent); 
```

有什么建议么？

# javascript - JavaScript：生成新窗口（window.open）

> ID：15456384
> 
> 赞同：0
> 
> 时间：2013-03-17T00:36:24.453
> 
> 标签：javascript

我需要使用函数生成一个新窗口。对我来说一切都很好，但在我的任何浏览器中都不起作用。我不知道为什么它不起作用。请帮助我使它工作。

```
<script>
var newWin();
function openWin() {
    var features = "toolbar=yes,locationbar=1,directories=1,statusbar=1,menubar=1,scrollbar=1,resizable=yes,titlebar=1";
    newWin = window.open("", "newWin", features);
    var topDoc = "<html><head><title>Dynamic window and document</title></head>";
    var endDoc = "</body></html>";

    newWin.document.write(topDoc, "<body>");
    newWin.document.write("<h1>Dynamic created Window and Document</h1>");
    newWin.document.write("<p><a href='javascript: opener.focus();'>Click here to put the other window on top</a></p>");

    newWin.document.write("<p><a href='javascript: AAAAAA'>Click here to close the other window</a></p>");
    newWin.document.write("<p><input type='button' onclick='self.print();' value='Send the content of this window to a printer'></p>");

    newWin.document.write("<p><input type='button' onclick='BBBBBB' value='Close this window'></p>");

    newWin.document.write(endDoc);

    newWin.document.close();
}

</script>

<p><a href="javascript: openWin();">Click to open a new window</a></p>

    <p><a href="#" onclick="newWin.focus();">Click to put the new window on top</a></p>

    <p><a href="#" onclick="newWin.close();">Click to close the new window</a></p> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:18:30.867

```
<p><a href="javascript:{ openWin();}">Click to open a new window</a></p>

    <p><a href="#" onclick="javascript:{newWin.focus();}">Click to put the new window on top</a></p>

    <p><a href="#" onclick="javascript:{newWin.close();}">Click to close the new window</a></p> 
```

和改变

```
var newWin(); 
```

至`var newWin;`

# java - 抽象一个测试类

> ID：15456385
> 
> 赞同：0
> 
> 时间：2013-03-17T00:36:39.237
> 
> 标签：java, unit-testing, mockito, abstraction, powermock

我现在有一些使用 PowerMock 和 Mockito 来“模拟对象”的测试。问题是，所有这些测试一遍又一遍地创建相同的模拟。是否有可能有一个抽象类，我的测试从中派生预先模拟这些对象？

例子 ：

```
public abstract class AbstractTest {
    public void initialize() {
        PowerMockito.mockStatic(StaticMock.class);
        when(StaticMock.doSomething()).thenReturn(true);
    }
}

@RunWith(PowerMockRunner.class)
@PrepareForTest(StaticMock.class) // BanManager.class contains static methods
public class Test extends AbstractTest {

    @SuppressWarnings("serial")
    @Test
    public void testWithPerms() {
        initialize();
        SomeObject obj = new SomeObject();
        obj.doSomething();
        PowerMockito.verifyStatic();
        Static.verifyIsCalled();
    }
} 
```

我怎么能做类似上述实际工作的事情？这给了我不一致的堆栈图帧

**编辑：**谢谢你的回答。我的问题实际上是由于我使用了与 java 7 不兼容的 PowerMock 版本。不过，您的指示会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T07:32:34.893

当然这是可能的。如果您将@Before 注释放在基类中的方法上，它将在任何子类中的每个测试开始时运行。或者，您可以将其放在所有测试中使用的某种工厂类中。

# python - 从 Mac OSX 10.8 中删除预装的 python

> ID：15456386
> 
> 赞同：11
> 
> 时间：2013-03-17T00:36:46.930
> 
> 标签：python, macos, macports

我想迁移到 python 3.0，因此在我的 mac 上删除默认的 python 2.7 (2.6,2.5...) 安装。包括所有已安装的软件包，$PATH，...

python.org oder MacPorts 安装程序的 python 安装程序是否提供卸载程序，或者有没有办法手动执行此操作？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-17T00:45:23.577

这是一个非常*可怕*的想法，你永远不应该那样做。您可能会破坏期望在默认位置找到默认 Python 的各种软件的依赖关系和要求。

安装您选择的 Python 3（MacPorts、Python.org 等）。更新您的本地 $PATH 变量以使用该 Python / PythonPath。

如果您不相信我的意见，以下是 Python.org 官方文档所说的：

[http://docs.python.org/2/using/mac.html](http://docs.python.org/2/using/mac.html)

> Apple 提供的 Python 版本分别安装在 /System/Library/Frameworks/Python.framework 和 /usr/bin/python 中。您永远不应修改或删除这些内容，因为它们受 Apple 控制并被 Apple 或第三方软件使用。请记住，如果您选择从 python.org 安装更新的 Python 版本，您的计算机上将有两个不同但功能正常的 Python 安装，因此您的路径和用法与您想要做的一致是很重要的。

# c# - 如何跨不同类发布和订阅事件

> ID：15456387
> 
> 赞同：5
> 
> 时间：2013-03-17T00:36:55.503
> 
> 标签：c#, events, delegates

**目标：**当 udp 或 tcp 使用其 send 方法时更改表单上的图像

**问题：**我不知道如何正确设置事件、事件处理程序和委托

**发送接口**

```
interface ISendData
{
  void Send();
} 
```

**Tcp 连接类**

```
//Need some type of delegate??

public class TCPconnection : ISendData
{
   void Send()
   {
     //how invoke/fire a send Event?
   }
} 
```

**UDP 连接类**

```
//Need some type of delegate??

public class UDPConnection : ISendData
{
   void Send()
   {
     //how invoke/fire a send event?
   }
} 
```

**“应该”订阅查看触发事件的 winform**

```
public class myForm
{
   private DataWatcher datawatcher = new DataWatcher();
   private Image statusIndicator = null;

   public myform()
   {
     initComponents();

     datawatcher.DataSendActive += new DataWatcherSendHandler(DataSending);
     datawatcher.DataSendInactive += new DataWatcherSendHandler(NoDataSending);
   }

   public void DataSending(object sender, DataWatcherArgs e)
   {
      statusIndicator = Properties.resources.greenLight;
   }

   public void NoDataSending(object sender, DataWatcherArgs e)
   {
      statusIndicator = Properties.resources.redLight;
   }

} 
```

**事件/事件处理程序？？但我真的不知道我在这里做什么来完成这项工作**

```
 public delegate void EventHandler(object sender, EventArgs e);

    class DataWatcher
    {
        public event EventHandler DataSendActive;
        public event EventHandler DataSendInactive;

        protected virtual void onDataSendActive(System.EventArgs e)
        {
            if (DataSendActive != null)
            {
                DataSendActive(this, e);
            }
        }
        protected virtual void onDataSendInactive(System.EventArgs e)
        {
            if (DataSendInactive != null)
            {
                DataSendInactive(this, e);
            }
        }
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:27:55.863

这是一个简单的示例，说明如何实现发送和不发送的事件并订阅它

```
public class Connection
{
    //Set up an event
    public event EventHandler DataSending;
    public event EventHandler DataNotSending

    //This method will trigger the event for sending
    private void OnDataSending()
    {
        if (DataSending!= null) { DataSending(this, EventArgs.Empty); }
    }

    //this method will trigger the event for finished sending
    private void OnDataNotSending()
    {
        if (DataNotSending!= null) { DataNotSending(this, EventArgs.Empty); }
    }

    //This method performs your send logic
    public void Send()
    {
         //Call your method that tells the event to be raised
         OnDataSending();
         //Then put your send code
         OnDataNotSending(); //we're done!

    }
} 
```

这是您在消费程序中使用它的方式

```
public class myForm
{
     //This method is the one that sets up the 
     //instance and subscribes to the event
     public myForm()
     {
         Connection con = new Connection();

         con.DataSending += new EventHandler(con_DataSending);
         con.DataNotSending += new EventHander(con_DataNotSending);

     }

     void con_DataSending(object sender, EventArgs e)
     {
         //Put your subscription logic here.
         //Whatever you want to do in response to a send
     }

     void con_DataNotSending(object sender, EventArgs e)
     {
         //Put your subscription logic here.
         //Respond to it not sending
     }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-17T01:51:44.033

有许多约定用于执行此操作。这是我的小实现。

```
public enum ActivityState
{
    Sending,
    Receiving,
    Idle
}

public interface IDataTransferManager
{
    // This event will fire when the activity state changes.
    // note that Action<T> is introduced in .NET 3.5
    // if you're using .NET 2.0, you can use a delegate.
    event Action<ActivityState> DataActivityStateChange;

    void Send(byte[] data);
    //byte[] Receive(); 
    // ... more methods ... //

} 
```

现在 TcpConnection 类将实现这一点。

```
public class TcpConnection : IDataTransferManager
{
    public event Action<ActivityState> DataActivityStateChange;

    public void Send(byte[] data)
    {
        // we're sending data. fire the change event
        FireDataActivityStateChange(ActivityState.Sending);

        //TODO: send the data

        // we're done sending. Fire the change event
        FireDataActivityStateChange(ActivityState.Idle);
    }

    private void FireDataActivityStateChange(ActivityState state)
    {
        // helper method, so I don't have to check the event 
        // to avoid null reference exceptions.
        if (DataActivityStateChange != null)
            DataActivityStateChange(state);
    }

} 
```

这是您的表单的设置。

```
class MyForm // :Form
{
    IDataTransferManager dataManager;

    public MyForm()
    {   // here, usually an instance will be passed in, 
        // so there's only one instance throughout the application.
        // let's new up an instance for explanation purposes.
        dataManager = new TcpConnection();

        dataManager.DataActivityStateChange += (state) => 
        {
            // NOTE: if you don't like inline, 
            // you can point this labda to a method.

            switch (state)
            {
                case ActivityState.Sending:
                    // change the image to the spinning toilet ball
                    break;
                case ActivityState.Receiving:
                    // change the image to the spinning toilet ball, but reverse :P
                    break;
                case ActivityState.Idle:
                    // hide it ?
                    break;
            }
        };
    }
} 
```

希望这可以帮助。

# php - 如果字段不为空，如何显示一次带有标题的表格，然后显示多个数据库字段内容？

> ID：15456389
> 
> 赞同：0
> 
> 时间：2013-03-17T00:37:02.730
> 
> 标签：php, mysql, html-table

我想得到：

**报价：**
报价 1
报价来源 1

报价 2
报价来源 2

我目前得到：

**报价：**
报价 1
报价来源 1

**报价：**
报价 2
报价来源 2

对我有用的最终代码：

```
 echo ("<table border='1'>");

$header_printed = false;

while($row = mysql_fetch_array($rs)) {
if ($row['quote']) {
    if ($header_printed === false) {
        echo "   

            <tr>
                <th>Quotes:</th>
            </tr>";
        $header_printed = true;
    }

    echo "
        <tr>
            <td>".$row['quote']."</td>
            <td>".$row['quote_source']."</td>
        </tr>";
}

}

echo ("</table>"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:40:40.387

```
echo "<table border='1'><tr><th>Quotes:</th></tr>";
while($row = mysql_fetch_array($rs)) {
    if ($row['quote']) {
        echo "<tr><td>".$row['quote']."</td><td>".$row['quote_source']."</td></tr>";
    }
}
echo "</table>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:41:45.437

将标头置于循环之外：

```
$header_printed = false;

while($row = mysql_fetch_array($rs)) {
    if ($row['quote']) {
        if ($header_printed === false) {
            echo "   
                <table border='1'>
                <tr>
                    <th>Quotes:</th>
                </tr>";
            $header_printed = true;
        }

        echo "
            <tr>
                <td>".$row['quote']."</td>
                <td>".$row['quote_source']."</td>
            </tr>";
    }

} 
```

# php - NSDebugDescription = "JSON 文本没有以数组或对象开头，并且允许未设置片段的选项。";

> ID：15456396
> 
> 赞同：24
> 
> 时间：2013-03-17T00:37:29.083
> 
> 标签：php, ios, afnetworking

我`AFJSONRequestOperation`用来请求服务器并解析返回的 JSON 响应，但是在解析时，我收到了这个错误：

```
NSDebugDescription = "JSON text did not start with array or object and option to allow fragments not set."; 
```

我检查了 API，它返回 JSON 数据：

```
header('Content-type: text/json');
$arr[] = array("Message" => "update succeeded");
echo '{"Result":'.json_encode($arr).'}'; 
```

知道如何解决吗？

**编辑**

我尝试从浏览器调用 API 并将请求包含在 url 中，因此我得到了有效的 JSON 响应：

```
{"Result":[{"Message":"update succeeded"}]} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-16T10:56:24.943

首先，`json_encode`整个对象，而不是分解成碎片。

其次，除非 $arr 包含多个元素（从上面的示例中不清楚），否则它应该被初始化为：

`$arr = array("Message" => "update succeeded");`

我仍然不确定这里还有什么问题。您应该回显您的应用程序正在接收什么，这应该表明问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-18T13:38:34.587

检查您是否在 API 的基本 URL 之前添加了 /api/

http:// someurl / yourBasrUrl /api/apiName

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-26T10:31:37.923

要做出有效的 json 响应，您的代码应如下所示：

```
$response = array(
    "Result" => array(
        "Message" => "update succeeded"
    )
)

echo json_encode($response); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-03T21:33:10.223

如果您需要读取片段 json，您可以使用`.allowFragments`如下选项：

```
JSONSerialization.jsonObject(with: someData, options: .allowFragments) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-03T06:03:41.183

请试试这个：

```
let manager = AFHTTPSessionManager(baseURL: NSURL("Base URL"))
manager.requestSerializer = AFJSONRequestSerializer()
manager.responseSerializer = AFJSONResponseSerializer()

 let params = [
    "foo": "bar"
]

manager.POST("API url", parameters: params, 

success: {
    (task: NSURLSessionDataTask!, responseObject: AnyObject!) in
        print("success") 
}, 

failure: {
    (task: NSURLSessionDataTask!, error: NSError!) in
        print("error")
}) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-29T13:35:42.040

请使用可接受的内容类型。在您的网络服务中，这应该只是纯文本。

这是我的快速代码并已修复：

```
 let manager = AFHTTPRequestOperationManager()

    manager.requestSerializer=AFJSONRequestSerializer()
    manager.responseSerializer = AFHTTPResponseSerializer();

    manager.GET(

        baseURL + (webServiceType as String) + secureParam,
        parameters:[:],

        success:
        { (operation: AFHTTPRequestOperation!,
            responseObject: AnyObject!) in
            completion(obj: responseObject)
        },
        failure:
        { (operation: AFHTTPRequestOperation!,
            error: NSError!) in
            completion(obj: nil)
    }) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-03T19:10:25.437

首先，您的 API 返回不正确的`Content-Type`. JSON 数据的正确内容类型是`application/json`. 这在使用第三方库时可能会发生冲突。

其次，您不应该“手动”生成 json 字符串。总共 API 应该修改为面对：

```
header('Content-type: application/json');
$arr[] = array("Message" => "update succeeded");
echo json_encode(array('Result' => $arr)); 
```

最后一击并非最不重要。还有一件可能的事情：您的 api PHP 脚本的开头可能有 BOM 字符。这些是空格，因此您可能在浏览器中看不到它们。请[确保您的 PHP 文件在没有 BOM 的情况下进行编码](https://www.google.com/search?q=windows+file+without+BOM)。

# php - while循环中的javascript函数

> ID：15456400
> 
> 赞同：0
> 
> 时间：2013-03-17T00:38:18.407
> 
> 标签：php, javascript, while-loop

我有一些来自数据库的数据通过 while 循环发布：

```
$dati = $link->query($sql);
    print '<table>';

        while ($dato = $dati->fetch_object()) {

            print '<tr>';
            print '<td id="cellaId">';
            $Id = $dato->Id;
            print $Id;
            print '</td>';

            print '<td>';
            print $dato->Data;
            print '</td>';

            ...some other stuff...

            print '<td>';
            print '<input type = "checkbox" name = "visto" id = "visto" onclick = "refreshData()">';
            print '</td>';

            print '<td>';
            print '<input type = "checkbox" name = "elaborato" id = "elaborato" onclick = "refreshData()">';
            print '</td>';

            print '</tr>';
        }
        print '</table>';
        $dati->close(); 
```

现在这两个“复选框”调用一个函数：

```
function refreshData() {

var vistovalue = document.getElementById("visto").checked ? '1' : '0'
var elaboratovalue = document.getElementById("elaborato").checked ? '1' : '0'
var idvalue = document.getElementById("cellaId").innerHTML

alert(idvalue);

[and then I do an ajax]
} 
```

问题是我得到的 idvalue 总是第一个从 while 循环中出来，而不是在我单击复选框的同一行上。

我怎样才能获得正确的价值？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:45:57.010

在这里快速浏览一下...最好保持您的 ID 唯一。在你的while循环中创建一个计数器，并设置`id="cellaId"+counter`

然后你可以通过`onClick="refreshData("+count+")"`

让我知道它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:46:05.510

一个 html 页面上只能有一个唯一 ID。

您可以做的是添加一个计数器或`$dato->Id`ID，以便它是唯一的并且您可以识别它。然后，您可以使用该 ID 作为参数调用您的函数。

例子：

```
print '<input type="checkbox" name="visto[' . $dato->Id . ']"
        id="visto' . $dato->Id . '" onclick="refreshData(' . $dato->Id . ')">'; 
```

和：

```
function refreshData(Id) {
  var elID = 'visto' + Id;
  // etc. 
```

你的`name`属性也有同样的问题，所以你可以在我的例子中做类似的事情（我使用一个数组，以便在发布表单时你会得到一个数组）。

# .htaccess - 使用 .htaccess 重定向插件域（和所有 url）

> ID：15456411
> 
> 赞同：1
> 
> 时间：2013-03-17T00:40:58.653
> 
> 标签：.htaccess, redirect, add-on

好的，我读了很多书，也玩过，但我无法解决这个 .htaccess 问题。

我的主托管帐户有一个插件域。我已经设法让根插件域使用以下 .htaccess 代码转到特定文件：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www.)?addondomain.org$
RewriteRule ^(/)?$ /new-index.php [L] 
```

这一切都很好；但是，如果有人尝试通过根以外的任何其他 URL 访问插件域，并且该页面不存在，则会弹出 404。所以，如果我去 addondomain/car.php 会显示 404。

我希望插件域的所有 404 错误 - 并且仅适用于插件域 - 也显示 new-index.php 文件。

ErrorDocument 404 /new-index.php 命令不是一个选项，因为它会影响主域和插件域。

换句话说：我希望插件域的任何 URL 都指向 /new-index.php。

想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:41:22.053

如果要匹配所有 URL 路径，则必须使用匹配所有内容的正则表达式。使用`.*`或`^`例如

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/new-index\.php$
RewriteCond %{HTTP_HOST} ^(www.)?addondomain.org$
RewriteRule ^ /new-index.php [L] 
```

# mysql - 通过表中的不同记录查找路径

> ID：15456412
> 
> 赞同：1
> 
> 时间：2013-03-17T00:41:09.303
> 
> 标签：mysql, sql

我有一个 MySQL 表，其中包含以下字段

*   ID
*   来自ID
*   到ID

示例数据：

```
ID      fromID      toID
-------------------------
24610   12512       76122
76122   24610       34671
90127   35167       12523
34671   76122       1512 
```

最后，我想要从24610到34671的完整路径。这可以用纯SQL吗？

我会在我的代码中使用它，并在收到后搜索每条记录`toID`，这并不是真正的高性能。

# java - 我想将 Facebook 帖子从公共页面拉到 Java 应用程序

> ID：15456415
> 
> 赞同：2
> 
> 时间：2013-03-17T00:42:27.997
> 
> 标签：java, facebook, jsoup

我正在用 Java 创建一个应用程序，它将从公共网站获取所有信息并将其加载到应用程序中，供人们使用 jsoup 阅读。我在 Facebook 上尝试了同样的功能，但它的工作方式不一样。有没有人知道我应该怎么做？

谢谢，卡兰德

```
public String[] scrapeEvents(String... args) throws Exception {
    Document doc = Jsoup.connect("http://www.facebook.com/cedarstreettimes?fref=ts").get();
    Elements elements = doc.select("div._wk");
    String s = elements.toString();

    return s;
} 
```

编辑：我找到了这个信息链接，但是我对如何操作它来让我只获得特定用户在他们的墙上发布的内容有点困惑。[http://developers.facebook.com/docs/getting-started/graphapi/](http://developers.facebook.com/docs/getting-started/graphapi/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T18:49:59.310

我查看了该页面的来源——导致解析失败的是所有真实内容都包含在注释中，如下所示：

```
<code class="hidden_elem" id="u_0_42"><!-- <div class="fbTimelineSection ...> --></code> 
```

页面上有 JS 将这些数据提升到真实的 DOM 中，但是由于 jsoup 不执行 JS，它仍然作为注释。因此，在提取内容之前，我们需要模拟该 JS 并“取消隐藏”这些元素。这是一个帮助您入门的示例：

```
String url = "https://www.facebook.com/cedarstreettimes?fref=ts";
String ua = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.33 (KHTML, like Gecko) Chrome/27.0.1438.7 Safari/537.33";
Document doc = Jsoup.connect(url).userAgent(ua).timeout(10*1000).get();

// move the hidden commented out html into the DOM proper:
Elements hiddenElements = doc.select("code.hidden_elem");
for (Element hidden: hiddenElements) {
    for (Node child: hidden.childNodesCopy()) {
        if (child instanceof Comment) {
            hidden.append(((Comment) child).getData()); // comment data parsed as html
        }
    }
}

Elements articles = doc.select("div[role=article]");
for (Element article: articles) {
    if (article.select("span.userContent").size() > 0) {
        String text = article.select("span.userContent").text();
        String imgUrl = article.select("div.photo img").attr("abs:src");
        System.out.println(String.format("%s\n%s\n\n", text,imgUrl));
    }
} 
```

该示例提取了文章文本和与之关联的任何照片。

（使用 FB API 可能比这种方法更好；我想展示如何模拟一点点 JS 以使抓取正常工作。）

# html - HTML表格中的rowspan和colspan问题

> ID：15456424
> 
> 赞同：2
> 
> 时间：2013-03-17T00:44:14.257
> 
> 标签：html, html-table

我正在尝试使用 rowspan 和 colspan 使用 HTML 中的表格创建此布局，但单元格的大小未显示我的预期，单元格“X”的 rowspan 和 colspan 的值为“2”，但表格的创建方式如下它在哪里 2x1。

这是我的代码

```
<html>
<head>
</head>
<body>
    <table border="3" cellspacing="5" cellpadding="3">
        <tbody>
            <tr>
                <td rowspan="2">1</td>
                <td>2</td>
                <td rowspan="2" colspan="2">X</td>
            </tr>

            <tr>    
                <td>3</td>      
            </tr>

            <tr>
                <td rowspan="1" colspan="4">4</td>  
            </tr>

            <tr>
                <td colspan="3">5</td>
                <td>6</td>  
            </tr>

        </tbody>
    </table>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:56:50.053

这工作正常。最容易查看是否添加了所有四个单元格都占据一列的行：

```
<tr>
    <td>7</td>
    <td>8</td>
    <td>9</td>
    <td>10</td>
</tr> 
```

[http://jsfiddle.net/ExplosionPIlls/HfHBU/](http://jsfiddle.net/ExplosionPIlls/HfHBU/)

您面临的视觉问题是由于没有第三列单元格来创建任何宽度。整个第三列是由`colspan`X、4 和 5 上的 s 创建的，因此它看起来没有（或非常小的）宽度，如果没有宽度规则，单元格将不会扩展。

# jquery - 如何使用 jQuery 返回隐藏输入的值？

> ID：15456425
> 
> 赞同：0
> 
> 时间：2013-03-17T00:44:14.390
> 
> 标签：jquery

我正在尝试获取隐藏输入的值。

我目前的隐藏看起来像这样

```
<input type="hidden" name="extend_1" id="extend_1" value="16:00:00"> 
```

所以我尝试在 $('time') 更改时获取该值

所以我的页面中有这段代码，但该值始终未定义！我正在使用 jQuery 1.9

```
$('time').change( function(){
        var this_id = "extend_" + $(this).val();
//if i alert this_id i not get "extend_1" howeven max_time is always returning undefined where it should display "16:00:00"
        var max_time = $( this_id ).val();
        console.log( max_time )
}); 
```

有人可以告诉我有什么问题吗？为什么 max_time 总是未定义？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T00:46:41.800

您错过了 jQuery 字符串中的哈希值。应该是`"#extend_" + $(this).val()`。

# javascript - Browserify v2 的全局要求

> ID：15456426
> 
> 赞同：16
> 
> 时间：2013-03-17T00:44:19.197
> 
> 标签：javascript, module, browserify

我想使用 Browserify 来捆绑我的文件，但是我需要将我的 Browserify 中的一个模块捆绑`bundle.js`在 HTML 页面本身上。目前这是不可能的，因为`require`页面上没有定义函数。

看来browserify`require`定义的函数在`bundle.js`IIFE 内部，所以我不能使用它。有没有可能把这个扔掉来代替 global `require`？

```
<script src="bundle.js"></script>
<script>
  // Require the `app` module inside of `bundle.js`
  var app = require('app');
  app.start();
</script> 
```

我需要这样做，因为我的`app.start`函数需要一些 JSON 传递给它，它只能由服务器端模板呈现。

注意我正在使用 Browserify v2。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-17T05:10:24.610

您可以使用`-r`为您指定的文件[公开全局函数：`require()`](https://github.com/substack/node-browserify#external-requires)

x.js：

```
module.exports = function (n) { return n * 111 } 
```

安慰

```
$ browserify -r ./x.js > bundle.js 
```

然后在你的html中：

```
<script src="bundle.js"></script>
<script>
    var x = require('./x.js');
    console.log(x(3))
</script> 
```

将打印`333`。

在您的情况下，只需`browserify -r app`公开`require('app')`外部环境即可。

# android - 如果未连接到 Internet，请在启动 Android 应用程序时要求用户启动 WiFi 或 3G

> ID：15456428
> 
> 赞同：3
> 
> 时间：2013-03-17T00:44:50.683
> 
> 标签：android, wifi, 3g

我正在使用一个使用 WebView 访问一些在线页面的 android 应用程序。我想加入一个选项，如果用户没有连接到互联网，应用程序将提示打开 WiFi 或 3G。

实现这种用户便利性观点的最佳方式是什么？

代码如下：

```
package com.url.appname;

import android.net.Uri;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.Window;
import android.webkit.ValueCallback;
import android.webkit.WebView;
import android.webkit.WebChromeClient;
import android.webkit.WebViewClient;
import android.widget.Toast;

public class MainActivity extends Activity {

 private WebView wv;  

 private ValueCallback<Uri> mUploadMessage;  
 private final static int FILECHOOSER_RESULTCODE=1;

 @Override  
 protected void onActivityResult(int requestCode, int resultCode,  
                                    Intent intent) {  
  if(requestCode==FILECHOOSER_RESULTCODE)  
  {  
   if (null == mUploadMessage) return;  
            Uri result = intent == null || resultCode != RESULT_OK ? null  
                    : intent.getData();  
            mUploadMessage.onReceiveValue(result);  
            mUploadMessage = null;        
  }  
 }  

 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    wv = new WebView(this);
//    wv = (WebView) findViewById(R.id.webview);
    wv.loadUrl("http://www.url.com");

    // Let's display the progress in the activity title bar, like the
    // browser app does.
    getWindow().requestFeature(Window.FEATURE_PROGRESS);

    wv.getSettings().setJavaScriptEnabled(true);

    final Activity activity = this;

    wv.setWebViewClient(new WebViewClient(){    

       public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
             Toast.makeText(activity, "Oh no! " + description, Toast.LENGTH_SHORT).show();
           }
         });

    wv.setWebChromeClient(new WebChromeClient()  {  

           public void onProgressChanged(WebView view, int progress) {
                 // Activities and WebViews measure progress with different scales.
                 // The progress meter will automatically disappear when we reach 100%
                 activity.setProgress(progress * 100);
               }

        // For Android 3.0+
        public void openFileChooser( ValueCallback<Uri> uploadMsg, String acceptType ) {  
            mUploadMessage = uploadMsg;  
            Intent i = new Intent(Intent.ACTION_GET_CONTENT);  
            i.addCategory(Intent.CATEGORY_OPENABLE);  
            i.setType("image/*");  
            MainActivity.this.startActivityForResult( Intent.createChooser( i, "File Chooser" ), MainActivity.FILECHOOSER_RESULTCODE ); 
            }

        // For Android < 3.0
        public void openFileChooser( ValueCallback<Uri> uploadMsg ) {
            openFileChooser( uploadMsg, "" );
            }

        // For Android > 4.1
        public void openFileChooser(ValueCallback<Uri> uploadMsg, String acceptType, String capture){
            openFileChooser( uploadMsg, "" );
            }

                                });
      setContentView(wv);      

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

}e 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-17T01:12:39.557

创建一个`AlertDialog`如果没有网络连接来告诉用户并提示他们。

使用此代码作为示例...

```
protected void createNetErrorDialog() {

    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("You need a network connection to use this application. Please turn on mobile network or Wi-Fi in Settings.")
        .setTitle("Unable to connect")
        .setCancelable(false)
        .setPositiveButton("Settings",
        new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
                Intent i = new Intent(Settings.ACTION_WIRELESS_SETTINGS);
                startActivity(i);
            }
        }
    )
    .setNegativeButton("Cancel",
        new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
                MyActivity.this.finish();
            }
        }
    );
    AlertDialog alert = builder.create();
    alert.show();
} 
```

创建`Intent`with`Settings.ACTION_WIRELESS_SETTINGS`作为操作将启动网络设置的内置活动。

# php - 在循环中如何检查“mkdir”是否执行然后停止循环？

> ID：15456430
> 
> 赞同：1
> 
> 时间：2013-03-17T00:45:19.630
> 
> 标签：php

下面的代码我尝试检查有多少文件夹`dir`并按升序创建一个新文件夹，例如
：如果`1` `2`在`dir`-> 它将创建一个名为`3`;
湾。如果`1` `5`在`dir` -> 我希望它可以创建一个名为的文件夹`2`

但现在在 b。它会使 -> `2` `3`。所以我想知道如何检查是否`mkdir`执行然后停止循环`for`？
还是有更好的主意？

```
// count folder
$folder = 0;
$dir = new RecursiveDirectoryIterator('./img/product/tmp/', FilesystemIterator::SKIP_DOTS);
$it  = new RecursiveIteratorIterator($dir, RecursiveIteratorIterator::SELF_FIRST);
$it->setMaxDepth(0);
foreach($it as $fileinfo){
    if($fileinfo->isDir()){
        $folder++;
    }
}
// create folder
$new_dir = './img/product/tmp/';
for($i = 0; $i <= $folder; $i++){
    if(!is_dir($new_dir.$i)){// limit tmp_id  is the !exist
        mkdir($new_dir.$i);
        $tmp_id = $i;
        // check if mkdir then stop loop ?
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:49:06.807

`mkdir`成功返回`true`，否则返回`false`：

```
if (mkdir($new_dir.$1)) {
  // directory created, do your thing here
  break;
}
else {
  // failed to create directory
} 
```

据我所知，您只想在成功创建文件夹后跳出循环，因此`else`在您的情况下您可能根本不需要该块

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T20:29:21.270

我可能会这样做：

```
 mkdir $my_folder
    if [ $? -ne 0 ] ;then
            echo "Error creating $my_folder
    else
            echo "Yey, $my_folder
            break;
    fi 
```

请注意，我不明白您为什么要摆脱除了可以满足的 while 循环之外的任何内容。

# twitter - Twitter api 1.1 按日期获取趋势

> ID：15456432
> 
> 赞同：0
> 
> 时间：2013-03-17T00:45:40.180
> 
> 标签：twitter

Twitter api 1.1 趋势站仅在今天获得趋势。我可以选择一个特定的日期吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T00:56:45.480

不，API 不允许这样做。

您必须在记录的第三方中获得支持

[http://twend.it/](http://twend.it/)是历史趋势的良好来源

# android - 计费 API v3 IabHelper NullPointerException

> ID：15456434
> 
> 赞同：53
> 
> 时间：2013-03-17T00:45:50.783
> 
> 标签：android, in-app-billing

**编辑 4/15：**在 IabHelper 中捕获空指针似乎已经停止了这个问题。我不再看到抛出异常，我将接受这个作为答案。

* * *

**编辑 4/04：**深入一点。有用于处理 queryPurchases 方法的 RemoteExceptions 和 JSONExceptions 的 try catch 块，但没有 NullPointerException 处理。我要尝试的是包括 NullPointer 异常处理，因此 IabHelper 在尝试查询 SkuDetails 时看起来像这样：

```
 catch (NullPointerException e) {
        throw new IabException(IABHELPER_UNKNOWN_ERROR, "NullPointer while refreshing inventory.", e);
    } 
```

我刚刚提交了一个错误：

[https://code.google.com/p/marketbilling/issues/detail?id=114](https://code.google.com/p/marketbilling/issues/detail?id=114)

* * *

**编辑 3/25：** 嗯，仍然收到这个崩溃......现在它发生在尝试从 IabHelper 摘录的以下第 3 行获取上下文时：

```
int queryPurchases(Inventory inv, String itemType) throws JSONException, RemoteException {
    logDebug("Querying owned items, item type: " + itemType);
    logDebug("Package name: " + mContext.getPackageName()); 
```

这令人沮丧，因为在我的清单中，我总是使用我的应用程序的完整路径名作为“名称”。

示例“com.myappname.blah.ClassName”

我也尝试将 MyClass.this、getApplicationContext() 传递给 mHelper。然而，它们都从野外设备随机产生相同的 NullPointer 结果。我还在清单中尝试了 name=".MyClass" 。这是它目前的样子：

```
mHelper = new IabHelper(MyClass.this, myKey); 
```

* * *

**编辑**3/18/13：我仍然收到异常，即使在 3/17 部署了新的 IabHelper 版本。

我开始在这里看到一个模式，崩溃都是在执行 mContext.getPackageName() 时尝试获取上下文时发生的。我很好奇为什么这在我所有的测试设备上都有效，而且我无法重现这个崩溃，而且似乎只在少数设备上。

这是新的崩溃：

```
java.lang.NullPointerException
    at com.myapp.util.IabHelper.queryPurchases(SourceFile:836)
    at com.myapp.util.IabHelper.queryInventory(SourceFile:558)
    at com.myapp.util.IabHelper.queryInventory(SourceFile:522)
    at com.myapp.util.IabHelper$2.run(SourceFile:617)
    at java.lang.Thread.run(Thread.java:1019) 
```

由 IabHelper 引起...

```
line 836: logDebug("Package name: " + mContext.getPackageName()); 
```

* * *

**2013 年 3 月 17 日编辑**：我看到过去几个月发布了许多错误修复，我将尝试此处提供的最新代码，看看是否能解决问题：

[https://code.google.com/p/marketbilling/source/browse/v3/src/com/example/android/trivialdrivesample/util](https://code.google.com/p/marketbilling/source/browse/v3/src/com/example/android/trivialdrivesample/util)

* * *

在我的一个应用程序中，我使用了计费 API 和其中包含的样板代码。

我正在使用截至 2013 年 3 月 16 日通过 SDK 管理器提供的最新版本的计费 API。

在我的活动中，我使用以下内容查询库存：

```
final List<String> skuList = new ArrayList<String>();
skuList.add("sku1");
skuList.add("sku2");
skuList.add("sku3");
if (skuList != null) {
    if (skuList.size() > 0) {
        try {
            mHelper.queryInventoryAsync(true, skuList, mGotInventoryListener);
        } catch (Exception e) { 
            ACRA.getErrorReporter().handleException(e);
        }
    }
} 
```

我从以下设备的 IabHelper 类中收到了多个 NullPointerException 报告。我无法重现该问题，也找不到有关这些崩溃的任何信息，这就是我发布此问题的原因。

我在计费 API 的“面向开发人员”部分（包括在 onQueryInventoryFinished 中）对 null 和 try/catch 块进行了无数其他检查，所以我知道这个异常不是从“我的代码”中抛出的（因为我没有捕获崩溃来自我的任何应用程序的类），而是从 IabHelper 本身内部抛出。除了这个推荐的修复之外，我没有修改 IabHelper：[https ://stackoverflow.com/a/14737699](https://stackoverflow.com/a/14737699)

**崩溃 #1 Galaxy Nexus**

```
java.lang.NullPointerException
    at com.myapp.util.IabHelper.querySkuDetails(SourceFile:802)
    at com.myapp.util.IabHelper.queryInventory(SourceFile:471)
    at com.myapp.util.IabHelper$2.run(SourceFile:521)
    at java.lang.Thread.run(Thread.java:856) 
```

由 IabHelper 引起...

```
line 802: Bundle skuDetails = mService.getSkuDetails(3, mContext.getPackageName(), ITEM_TYPE_INAPP, querySkus); 
```

**崩溃 #2 三星 GT-S5570L**

```
java.lang.NullPointerException
    at com.myapp.util.IabHelper.queryPurchases(SourceFile:735)
    at com.myapp.util.IabHelper.queryInventory(SourceFile:465)
    at com.myapp.util.IabHelper$2.run(SourceFile:521)
    at java.lang.Thread.run(Thread.java:1019) 
```

由 IabHelper 引起...

```
line 735: Bundle ownedItems = mService.getPurchases(3, mContext.getPackageName(), ITEM_TYPE_INAPP, continueToken); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-19T01:28:23.833

**编辑 4/15：**在 IabHelper 中捕获空指针似乎已经停止了这个问题。我不再看到抛出异常，我将接受这个作为答案。

* * *

**编辑 4/04：**深入一点。有用于处理 queryPurchases 方法的 RemoteExceptions 和 JSONExceptions 的 try catch 块，但没有 NullPointerException 处理。我要尝试的是包括 NullPointer 异常处理，因此 IabHelper 在尝试查询 SkuDetails 时看起来像这样：

```
 catch (NullPointerException e) {
        throw new IabException(IABHELPER_UNKNOWN_ERROR, "NullPointer while refreshing inventory.", e);
    } 
```

我刚刚提交了一个错误：

[https://code.google.com/p/marketbilling/issues/detail?id=114](https://code.google.com/p/marketbilling/issues/detail?id=114)

* * *

改变

```
 if (querySkuDetails) {
            r = querySkuDetails(ITEM_TYPE_INAPP, inv, moreItemSkus);
            if (r != BILLING_RESPONSE_RESULT_OK) {
                throw new IabException(r, "Error refreshing inventory (querying prices of items).");
            }
        } 
```

到

```
 if (querySkuDetails) {
            try {
                r = querySkuDetails(ITEM_TYPE_INAPP, inv, moreItemSkus);
                if (r != BILLING_RESPONSE_RESULT_OK) {
                    throw new IabException(r, "Error refreshing inventory (querying prices of items).");
                }
            } catch (NullPointerException e) {
                throw new IabException(IABHELPER_UNKNOWN_ERROR, "NPE while refreshing inventory.", e);
            }
        } 
```

改变

```
 if (querySkuDetails) {
                r = querySkuDetails(ITEM_TYPE_SUBS, inv, moreSubsSkus);
                if (r != BILLING_RESPONSE_RESULT_OK) {
                    throw new IabException(r, "Error refreshing inventory (querying prices of subscriptions).");
                }
            } 
```

到

```
 if (querySkuDetails) {
                try {
                    r = querySkuDetails(ITEM_TYPE_SUBS, inv, moreSubsSkus);
                    if (r != BILLING_RESPONSE_RESULT_OK) {
                        throw new IabException(r, "Error refreshing inventory (querying prices of subscriptions).");
                    }
                } catch (NullPointerException e) {
                    throw new IabException(IABHELPER_UNKNOWN_ERROR, "NPE while refreshing inventory.", e);
                }
            } 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-08-04T07:24:14.567

您可能正在使用异步操作。如果您使用 ...async 方法，当前的 IabHelper 是不安全的。问题是，在任何时候运行异步操作的时候，都可以在主线程上调用 dispose。在这种情况下，您将获得 NullPointerExceptions 和 IllegalStateExceptions。

这是修复它的补丁：

```
Index: src/com/evotegra/aCoDriver/iabUtil/IabHelper.java
===================================================================
--- src/com/evotegra/aCoDriver/iabUtil/IabHelper.java   (revision 1162)
+++ src/com/evotegra/aCoDriver/iabUtil/IabHelper.java   (working copy)
@@ -86,7 +86,10 @@

     // Is an asynchronous operation in progress?
     // (only one at a time can be in progress)
-    boolean mAsyncInProgress = false;
+    volatile boolean mAsyncInProgress = false;
+    
+    // is set to true if dispose is called while a thread is running. Allows graceful shutdown
+    volatile boolean mDisposeRequested = false;

     // (for logging/debugging)
     // if mAsyncInProgress == true, what asynchronous operation is in progress?
@@ -285,6 +288,12 @@
      * disposed of, it can't be used again.
      */
     public void dispose() {
+       // do not dispose while an async Thread is running. Will cause all kinds of exceptions.
+       // In this case dispose must be called from thread after setting mAsyncInProgress to true
+       if (mAsyncInProgress) {
+           mDisposeRequested = true;
+           return;
+       }
         logDebug("Disposing.");
         mSetupDone = false;
         if (mServiceConn != null) {
@@ -827,6 +836,7 @@
         logDebug("Ending async operation: " + mAsyncOperation);
         mAsyncOperation = "";
         mAsyncInProgress = false;
+        if (mDisposeRequested) IabHelper.this.dispose();
     } 
```

或者在这里下载补丁。 [http://code.google.com/p/marketbilling/issues/detail?id=139&thanks=139&ts=1375614409](http://code.google.com/p/marketbilling/issues/detail?id=139&thanks=139&ts=1375614409)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-02T11:34:16.817

稍微修改`queryPurchases`方法的开头，如下所示：

```
int queryPurchases(Inventory inv, String itemType) throws JSONException, RemoteException {
        // Query purchases
        //logDebug("Querying owned items, item type: " + itemType);
       //logDebug("Package name: " + mContext.getPackageName());
       boolean verificationFailed = false;
       String continueToken = null;

        do {
//            logDebug("Calling getPurchases with continuation token: " + continueToken);
            if(mDisposed || mService==null) return IABHELPER_UNKNOWN_ERROR;
            Bundle ownedItems = mService.getPurchases(3, mContext.getPackageName(),
                    itemType, continueToken); 
```

感谢 [sebastie](https://code.google.com/p/marketbilling/issues/detail?id=114#c1)指出造成这种情况的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-13T11:14:17.413

[tmanthey](https://stackoverflow.com/users/837119) [补丁](http://code.google.com/p/marketbilling/issues/detail?id=139&thanks=139&ts=1375614409)还需要

```
mDisposeRequested = false; 
```

处置发生后

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-03-18T19:05:52.040

如果您在模拟器上遇到此错误，这可能是一件非常简单的事情，发生在一半以上的情况下。

检查您使用的是 Google API SDK 而不是常规的 SDK！！！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-10-11T19:09:48.463

IabHelper 已过时，已被 BillingClient 取代。见[https://developer.android.com/google/play/billing/billing_library.html](https://developer.android.com/google/play/billing/billing_library.html)

# image - 了解 Retina 设备 CSS 媒体查询

> ID：15456436
> 
> 赞同：3
> 
> 时间：2013-03-17T00:46:01.597
> 
> 标签：image, css, media, media-queries, retina-display

我正在研究一个 WordPress 主题，并试图将启用视网膜的 CSS 查询合并到我的 CSS 文件中。

我想澄清一下，在更改所有背景图像之前，我已经正确设置了媒体查询。

1.  我将所有背景图像的大小翻了一番，并使用“@2x”命名约定对它们进行了前缀。例如`icon-user@2x.png`。
2.  我在我的代码中添加了一个 jQuery 函数来用 .css 的 CSS 类交换图像`hires`。
3.  在我的 CSS 文档中，我有一个用于背景图像的普通 CSS 类。

**普通 CSS 查询**

> ```
> .side-nav .arrow {
>   background: url(../images/arrow-nav.png) no-repeat top left;
>   width: 5px;
>   height: 8px;
>   display: inline-block;
>   margin-left: 10px
> } 
> ```

这是我为启用视网膜的设备更改 .side-nav .arrow 类的正确方法吗？在声明背景大小时，我是否保持原始较小图像的大小？

```
/* All Retina Ready devices larger than 1.5 pixel ratio */
@media only screen and (-moz-min-device-pixel-ratio: 1.5),
only screen and (-o-min-device-pixel-ratio: 3/2),
only screen and (-webkit-min-device-pixel-ratio: 1.5),
only screen and (min-device-pixel-ratio: 1.5) {

    .side-nav .arrow { 
        background-image:url(../images/arrow-nav@2x.png); 
        -webkit-background-size:5px 8px;
        -moz-background-size:5px 8px;
        -o-background-size:5px 8px;
        background-size:5px 8px 
    }
} 
```

**jQuery 代码**

```
$(function () {

    if (window.devicePixelRatio == 2) {

          var images = $("img.hires");

          /* loop through the images and make them hi-res */
          for(var i = 0; i < images.length; i++) {

            /* create new image name */
            var imageType = images[i].src.substr(-4);
            var imageName = images[i].src.substr(0, images[i].src.length - 4);
            imageName += "@2x" + imageType;

            /* rename image */
            images[i].src = imageName; 
          }
     }

}); 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T11:01:53.253

只要有某种形式的缩放发生，比如当你声明

`<meta name="viewport" content="width=...">`（适用于安卓/ios/黑莓/WP8）

或者

`@ms-viewport {width: ... ;}`（对于非 WP8 IE10）

或者......即使您没有声明任何内容，大多数移动设备默认情况下都会自动缩放，使得视口宽度=980px

那么无论物理 DPI/PPI 之间的差异如何，您使用 'px' 声明的所有 CSS 尺寸都将以其视口的相同比例存在

这意味着当媒体查询与高分辨率设备匹配时，除了背景图像的 URL 之外，您不必更改样式类的任何内容：

```
@media only screen and (-moz-min-device-pixel-ratio: 1.5),
only screen and (-o-min-device-pixel-ratio: 3/2),
only screen and (-webkit-min-device-pixel-ratio: 1.5),
only screen and (min-device-pixel-ratio: 1.5),
only screen and (min-resolution: 144dpi) {
    .side-nav .arrow { 
         background-image:url(../images/arrow-nav@2x.png);
     }
} 
```

# notifications - 使用 Firebase 实时推送通知

> ID：15456440
> 
> 赞同：13
> 
> 时间：2013-03-17T00:46:35.870
> 
> 标签：notifications, push-notification, firebase

我最近注册使用 Firebase，但我似乎不知道如何向特定用户推送通知。

对于我的使用，我想你可以把它想象成 Facebook。每当用户做某事时，比如发布一篇有趣的文章供他们的朋友阅读，我希望用户的所有朋友都能收到该事件的通知。那么，使用 Firebase，如何才能只通知他们的朋友而不是所有人呢？我的数据库存储连接。

也许有一种方法可以让每个用户成为 Firebase 数据库中的一个节点，并且每次发送通知时，用户都会不断检查他的节点，如果出现问题，将其拉取然后删除。

Firebase 上的示例似乎有点基本。我希望有一个特定于用户的推送通知示例。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-05-23T01:37:02.923

现在 Firebase 支持推送通知。Google 将 GCM 更名为[Firebase Cloud Messaging](https://firebase.google.com/docs/cloud-messaging/)，现在它提供了这种跨平台服务。Firebase 还提供[通知](https://firebase.google.com/docs/notifications/)。

这些是这两种服务之间的区别：

Firebase 云消息传递通过其客户端 SDK 以及 HTTP 和 XMPP 服务器协议提供一整套消息传递功能。对于具有更复杂消息传递要求的部署，FCM 是正确的选择。

Firebase Notifications 是基于 Firebase 云消息传递的轻量级、无服务器消息传递解决方案。借助用户友好的图形控制台和降低的编码要求，Firebase 通知让用户可以轻松发送消息以重新吸引和留住用户、促进应用增长并支持营销活动。如果你想要更详细的比较。读[这个](https://firebase.google.com/support/faq/#messaging-difference)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:53:17.507

这里有一个很好的解释如何向特定用户发送通知： [How to send an alert message to a special online user with firebase](https://stackoverflow.com/questions/14975904/how-to-send-an-alert-message-to-a-special-online-user-with-firebase)

基本上你需要让每个用户观察一个唯一的路径，然后将数据更新写入适当的路径。

# php - PHP 注意：试图获取非对象的属性

> ID：15456444
> 
> 赞同：1
> 
> 时间：2013-03-17T00:47:06.647
> 
> 标签：php, mysql, mysqli, prepare

几天来，我一直在尝试修复我的 PHP 代码的这一部分，但似乎没有任何效果。

我基本上是一个超级新手。几乎上周我决定尝试使用 PHP 从头开始​​制作博客。这要求我学习PHP。因此，通过遵循教程和阅读 w3schools 之类的网站，我慢慢地学习了适用的 PHP。

无论如何，这是我正在处理的代码的一部分：

```
$query = $db->prepare("SELECT post_id, title, body, date_posted, category
                       FROM posts INNER JOIN categories ON
                       categories.category_id=posts.category_id ORDER BY
                       post_id desc limit $start, $per_page");
$query->execute();
$query->bind_result($post_id, $title, $body, $date_posted, $category);

$author = $db->prepare("SELECT username FROM posts INNER JOIN user ON
                            user.user_id=posts.user_id");
print_r( $author->error );
$author->execute();
$author->bind_result($username); 
```

让我解释。我有 3 个数据库表：帖子、类别和用户。大多数帖子信息都在“帖子”中，包括 category_id 和 user_id，但不是类别和用户的实际名称。我从另外两张桌子上得到这些。$db 使用 mysqli。

上面代码的 $query 部分工作得很好。$author prepare 行是我遇到问题的地方。我根据有效的 $query prepare 行编写了该行。

但是当我运行代码时，我得到“注意：试图获取非对象的属性”。这会导致 $author->execute() 不工作并产生错误：“致命错误：调用非对象上的成员函数 execute()。”

再说一次，由于我是一个超级新手，我认为修复非常简单，可能与我对 PHP 的无知有关。有没有人有任何想法或建议？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T00:58:30.577

错误是说 $author 是非对象。

如果`$author = $db->prepare()`执行得当，它将返回一个`mysqli_stmt`对象。相反，它可能会返回`false`

您可以通过以下方式确认：

```
echo($author); // Should be false
echo($db->error); // A string representation of your error. 
```

**为后代编辑：**

一个更好的做法，prepare() 语句的容错实现可能如下所示，如下[所述](https://stackoverflow.com/questions/15447133/mysqli-update-throwing-call-to-a-member-function-bind-param-error/15447204#15447204)：

```
$stmt = $mysqli->prepare($query) or trigger_error($mysqli->error); 
```

你应该在这里查看文档： [http ://www.php.net/manual/en/mysqli.prepare.php](http://www.php.net/manual/en/mysqli.prepare.php)

此外，如果您是 PHP 新手，我会推荐 PDO 库而不是 mysqli，一旦您开始获取结果，它们会更容易使用。

# php - 非常奇怪的 PHP Echo 错误

> ID：15456446
> 
> 赞同：0
> 
> 时间：2013-03-17T00:47:26.350
> 
> 标签：php, echo, netflix

我正在尝试回显通过 Netflix API 生成的 URL。URL 保存在变量 $movieid 中，当 'echo $movieid;' 输入它可以工作。我需要从 PHP 和 Netflix 提供的 JavaScript 中获取价值，这就是我遇到问题的地方。

假设我有 titleID = 7474747 。当我键入以下代码时：

```
$movieid = "http://api.netflix.com/catalog/movie/".$titleID;
echo $movieid; 
```

我得到以下输出：

```
[http]://api.netflix.com/catalog/movie/7474747 
```

但是当使用以下代码时：

```
<div id="myMovieLocation">
  <?php echo "<img src=\"$img\" />"; ?>
  <script src="[http]://jsapi.netflix.com/us/api/js/api.js">
  {
   "title_id" : "<?php print $movieid; ?>",
   "button_type" : ["PLAY_BUTTON", "ADD_BUTTON"],
   "show_logo" : "true",
   "x" : "40",
   "y" : "20",
   "dom_id" : "myMovieLocation",
   "application_id" : "<?php echo $apiKey; ?>"
   }
   </script> 
```

对于 $movieid，我没有得到相同的输出。快速查看源始终显示原始 URL，没有附加数字，如下所示：

```
"title_id" : "[http]://api.netflix.com/catalog/movie/", 
```

其他一切都很好，除了那个。我尝试过回显、打印、不同的变量名，但似乎没有任何效果。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T00:54:52.777

只需更改自己的代码，`str_replace("[http]", "http://", $movie_id);`.

如果你放，你会得到什么`var_dump($movie_id);`？分享结果....

尝试这个：

`"title_id" : \"<?php print $movieid; ?>\",`

如果您收到`NULL`或什么也没收到，返回变量的结果有问题`$movie_id`吗？

尝试转换为字符串，我认为您收到 INT 所以它无法解析示例：

`echo (string) $movie_id;`

或用于`strval()`确保您将整数转换为字符串：

`echo strval($movie_id);`

由于错误：`Output from "title_id" : \"<?php print $movieid; ?>\" is: "title_id" : \"api.netflix.com/catalog/movie\",`

放入 PHP 代码`"`：

```
"title_id" : <?php print 'http://"'.$movieid.'"/'.$title_id; ?>, 
```

或者以另一种方式，使用 PHP 解析`json_encode`：

```
<div id="myMovieLocation">
  <?php echo "<img src=\"$img\" />"; ?>
  <script src="[http]://jsapi.netflix.com/us/api/js/api.js">
  {
    <?php

    $movie_id_result = (string)$movieid;

    $a = array
    ("title_id" => "http://api.netflix.com/catalog/movie/".$movie_id_result,
     "button_type" => "[\"PLAY_BUTTON\", \"ADD_BUTTON\"]",
     "show_logo" => "true",
     "x" => "40",
     "y" => "20",
     "dom_id" => "myMovieLocation",
     "application_id" => $apiKey
    );

    echo json_encode($a, JSON_UNESCAPED_SLASHES);
    ?>
  }
  </script> 
```

返回 PHP 结果时请注意：

`titleID = 7474747`其中`7474747`可以是整数 (INT)。当您转换为 JSON 时，请确保它是使用字符串`strval()`或在变量之前简单添加`(string)`。结果是整数可能会使 json 解析器感到困惑。

**用于 PHP 的 Neflix API**

如果这还没有解决，请使用 PHP API for netflix 从[源代码](http://developer.netflix.com/page/resources/sample_php)作为示例 PHP。

# javascript - 是否有金字塔模板表单数据通过sqlalchemy到数据库的不变形教程？

> ID：15456453
> 
> 赞同：0
> 
> 时间：2013-03-17T00:49:17.723
> 
> 标签：javascript, json, postgresql, sqlalchemy, pyramid

我正在开发一个在树莓派上运行的开源离线金字塔应用程序，所以我想让一切尽可能简单和高效。该应用程序正在使用 sqlalchemy 愉快地与我的 postgresql 数据库通信。我不想通过使用 Deform 或其他小部件或添加身份验证或使用会话 cookie（如 Pyramid Doc 示例中）使事情复杂化。我使用 twitter 引导程序的模板（变色龙）包含一个表单（片段）：

```
<form action="." method="post">
    <a class="btn" href="#" id="actionbtn" onclick="camCapture()">Capture</a>
    <p><input type="text" class="input-small' id="projfld" value="Project Name">
    <p><label class="control-label" for "select01">Brightness</label>
             <div class="btn-group' data-toggle="buttons-radio" id="bright">
                  <button type="button" class="btn btn-small" id="btnoff">Off</button>  
              <button type="button" class="btn btn-small" id="btn10">10%</button>   
              <button type="button" class="btn btn-small" id="btn50">50%</button>   
              <button type="button" class="btn btn-small" id="btnfu">Full</button>  
         </div>
    <p><label class="checkbox"><input type="checkbox" id="auto">Auto</label>
</form> 
```

表单中还有其他按钮和字段，但这就是多样性。当用户单击模板中的 javascript 操作时：

```
function camCapture()

    {
    jQuery.ajax({
           url: '/camcapture',
           dataType:"json",
           type: 'POST',
           data: "test",
       });
    } 
```

正在触发views.py中的函数（下面的修剪代码）并使用sqlalchemy将系统数据添加到postgresql数据库中。

```
 @view_config(renderer="json", name="camcapture")
    def camcapture_view(self):
        #
        # stuff happens
        # 
    now = datetime.datetime.utcnow()
    outfile = ("/home/brian/cam/%s" % now.strftime("CAM_%Y%m%d%H%M%S") + ".jpg")
    cam_event = Event('fileprefix',now,'CAM',outfile,'memo field content','project')
    DBSession.add(cam_event)  # data, Event arguments above, are written to database
        #
        # other stuff happens
        #
    return [] 
```

用户只需返回原始页面（无需重定向），因为他们可能会更改一个或多个字段中的数据并再次提交表单。

我认为这是一个常见的应用程序，但我找不到帮助像我这样的新开发人员的示例或教程。也许它太简单了，我错过了重要的基本信息？我的数据库架构是，我相信在 models.py 中适当定义：

```
from sqlalchemy import *
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import (
    scoped_session,
    sessionmaker,
    )
from zope.sqlalchemy import ZopeTransactionExtension

engine = create_engine('postgresql://scan:scan@localhost:5432/scan', echo=True) # Establishes SQLAlchemy link to postgresql db
DBSession = scoped_session(sessionmaker(extension=ZopeTransactionExtension()))

class ORMClass(object): # Allows grabs of database values as variables in python
    @classmethod
    def query(class_):
        return DBSession.query(class_)

    @classmethod
    def get(class_, record):
        return Session.query(class_).get(record)

Base = declarative_base(cls=ORMClass)

class Event(Base):        #Schema description which allows automated table generation if it doesn't already exist
    __tablename__ = 'event'
    record = Column(Integer, Sequence('event_record_seq'), primary_key=True, nullable=False)
    fileprefix = Column(String)
    date = Column(DateTime, nullable=False)
    eventtype = Column(String(3))
    filename = Column(String)
    memo = Column(String)
    project = Column(String)
    extend_existing = True

    def __init__(self, fileprefix, date, eventtype, filename, memo, project):  #constructor for new event records
        self.fileprefix = fileprefix
        self.date = date
        self.eventtype = eventtype
        self.filename = filename
        self.memo = memo
        self.project = project

    def __repr__(self):
        return "<Event('%s','%s','%s','%s','%s','%s')>" % (self.fileprefix, self.date, self.eventtype, self.filename, self.memo, self.project)

Base.metadata.create_all(engine) 
```

谢谢你。是的，@Sergey，我在访问 JSON 字典中的值时遇到问题。在发布我的查询之前，我已经完成了该教程。在我尝试模拟它时，我使用 stringify 来构造 JSON 主体。我正在获取表单信息并将值设置为变量。

jsondata= JSON.stringify({"var1name" : $(#projfld").val(), "var2name" 等等。

在我的帖子上-> 数据：jsondata。

在教程中，他们打印元组。我正在尝试将每一对设置为在代码中使用的变量，但找不到执行此操作的语法。我想做类似的事情

var1 = request.json_body(index(0))、var2 = request.json_body(index(1)) 等等。

在上面的简化版本中，我将字符串“test”作为 JSON 数据发送。然后我可以在我的 Python 代码中将一个字符串设置为该字符串，但是如何解析 JSON 正文的各个部分？variablez = request.json_body 是等效的教程示例。由于元组包含名称和值对，我认为变量可能已经在正文中声明，我可以在我的代码中使用它们并将一些值发送到我的数据库。

我不使用简单提交按钮的原因是表单上有几个按钮（提到），每个按钮都会从表单中获取不同的信息，并在服务器端激活不同的代码以立即执行硬件操作（在这种情况下发送串行命令）。您是否试图建议在字段中按 enter 将自动提交表单？不是真的，至少不是在我正在使用的系统上（我可以在这个离线应用程序中控制它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T19:45:48.580

目前尚不清楚您遇到的确切问题是什么，但我认为您不知道如何访问客户端在 POST 请求正文中发送的 JSON dict 中的值，对吧？

答案是[request.json_body](http://docs.pylonsproject.org/projects/pyramid/en/latest/narr/webob.html#request)。这是 Pyramid 文档中的简短教程： [处理 JSON 编码的请求正文](http://docs.pylonsproject.org/projects/pyramid/en/latest/narr/webob.html#dealing-with-a-json-encoded-request-body)。[该方法](https://github.com/Pylons/pyramid/blob/master/pyramid/request.py)只是一个薄包装`return json.loads(request.body)`

如果您在客户端发送一个 Javascript 对象（正如您似乎正在使用的那样`var jsondata = JSON.stringify({var1name: $(#projfld").val(), var2name:...});`），在 Python 端您将获得一个 dict. 没有自动为任何变量分配值，它只是一个普通的普通字典：

```
data = request.json_body 
event.fileprefix = data['fileprefix']
event.eventtype = data['eventtype'] 
```

等等。

（另一个不相关的建议：与 Pyramid 教程建议的相反，您不需要那种难看`__init__`的方法，SQLAlchemy 为您的模型生成一个默认构造函数，它的作用完全相同。只需删除它）

# lua - 更改对象中表的值会更改所有对象的值。我如何让它只为特定对象更改它？

> ID：15456456
> 
> 赞同：2
> 
> 时间：2013-03-17T00:50:09.000
> 
> 标签：lua

我对 Lua 中的对象不太了解，所以请耐心等待。
示例代码：

```
Colors = {  
        primary = "BF2626",   
        primaryGradient = {"CC2929", "B32424"}
        }

function Colors:new(o)
  o = o or {}
  setmetatable(o, self)
  self.__index = self
  return o
end

function Colors:setPrimaryGradient()
  self.primaryGradient[1] ="Changed"
end

function Colors:setPrimary()
  self.primary ="00FF00"
end

a =Colors:new()
b =Colors:new()

b:setPrimaryGradient()
b:setPrimary()

print(a.primaryGradient[1])
print(b.primaryGradient[1])
print(a.primary)
print(b.primary) 
```

输出：

```
Changed
Changed
BF2626
00FF00 
```

我究竟做错了什么？
为什么变量*primary*为每个对象保留其值但表没有？
谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:12:37.977

您的`new`函数为空表设置了一个元表。该元表具有函数*和*内部数据。它还设置了一个`__index`元方法。这很重要。

您的`setPrimaryGradient`方法`self`作为隐式参数。在这种情况下，`self`是在 中创建的新表`new`。你的问题在这里：

`self.primaryGradient[1]`不是一个单一的构造。这是*两个独立的操作*。让我们写出 Lua 是如何使用它的：`self["primaryGradient"][1]`. 看到问题了吗？

第一部分，`self["primaryGradient"]`将检查`self`表并获取它的`primaryGradient`成员。问题是因为`self`有一个`__index`元方法，并且没有直接的`primaryGradient`成员`self`，所以它会`__index`直接使用元方法。所以它将`primaryGradient` *从 metatable*中获取。*共享*的元表。

然后该`[1]`部分将在元表的成员上执行，并且一个值将存储在元表的第一个元素`primaryGradient` *中*。

`setPrimary`没有出现同样问题的原因很简单。`self.primary`是一种操作。因为它是一个表访问后跟一个赋值操作，所以 Lua 不会使用元`__index`方法。它将改为使用元`__newindex`方法。由于您没有为`self`' 的元表定义一个，它将使用默认逻辑：在其中创建一个新成员`self`并设置其值。

`setPrimaryGradient`不使用的原因`__newindex`是因为它确实使用了。只是不是为了访问`self`. 它用于`__newindex`访问`self["primaryGradient"]`；只有*最后一个*表访问得到`__newindex`调用。

如果你想用一些可以修改的默认值来初始化你的类型，你需要*复制*这些值。有时你不能只引用全局的。好吧，你可以，但是设置起来会很痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T06:40:10.600

问题可以通过这种方式轻松解决：

```
Colors = {  
        primary = "BF2626",   
        primaryGradient = {"CC2929", "B32424"}
        }
Colors.primaryGradient.__index = Colors.primaryGradient

function Colors:new(o)
  o = o or {primaryGradient = setmetatable({}, self.primaryGradient)}
  setmetatable(o, self)
  self.__index = self
  return o
end 
```

# xml - 使用图像解析 XML 的 xcode

> ID：15456457
> 
> 赞同：-2
> 
> 时间：2013-03-17T00:50:18.070
> 
> 标签：xml, xcode, image, parsing

我对 xml 解析器进行编码以读取 Internet 上的图像，但是当我在 xcode 上编译文件时遇到问题，他说：“线程 1：SIGABRT

这是代码：

查看 Controller.h ：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController<NSXMLParserDelegate> {
    IBOutlet UIImageView *imgView;
    NSMutableArray *photos;
}

@end 
```

视图控制器.m：

```
#import "ViewController.h"

@implementation ViewController

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    photos = [[NSMutableArray alloc] init];

    NSXMLParser *photoParser = [[[NSXMLParser alloc] initWithContentsOfURL: [NSURL     URLWithString:@"http://davylebeaugoss.free.fr/Sans%20titre.xml"]] autorelease];

    [photoParser setDelegate:self];
    [photoParser parse];

    NSURL *imageURL = [NSURL URLWithString:[photos objectAtIndex:0]];
    NSData *imageData = [NSData dataWithContentsOfURL:imageURL];
    UIImage *image = [UIImage imageWithData:imageData];
    [imgView setImage:image];
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:    (NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary     *)attributeDict
{
    if ( [elementName isEqualToString:@"photo"])
    {
    [photos addObject:[attributeDict objectForKey:@"url"]];
}

}
@end 
```

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:10:57.143

`NSURL *imageURL = [NSURL URLWithString:[photos objectAtIndex:0]];`是你的问题。

是异步的`[photoParser parse];`，这意味着调用时它不完整`objectAtIndex:0`。

在引用数组之前，您需要等到解析完成。方法

`- (void)parserDidEndDocument:(NSXMLParser *)parser`

解析完成后会调用。拨打电话以在`photo`此处引用该数组。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    photos = [[NSMutableArray alloc] init];

    NSXMLParser *photoParser = [[[NSXMLParser alloc] initWithContentsOfURL: [NSURL     URLWithString:@"http://davylebeaugoss.free.fr/Sans%20titre.xml"]] autorelease];

    [photoParser setDelegate:self];
    [photoParser parse];

}

- (void)parserDidEndDocument:(NSXMLParser *)parser {

     NSURL *imageURL = [NSURL URLWithString:[photos objectAtIndex:0]];
     NSData *imageData = [NSData dataWithContentsOfURL:imageURL];
     UIImage *image = [UIImage imageWithData:imageData];
     [imgView setImage:image];
} 
```

# ios - 使用嵌入式 UITextField 滚动 UITableView

> ID：15456460
> 
> 赞同：-1
> 
> 时间：2013-03-17T00:51:44.923
> 
> 标签：ios, objective-c, uikit

我有一个带有自定义 UITableViewCell 的 UITableView。该单元格有一个用于用户数据输入的 UITextField。

我注意到如果用户在文本视图上启动触摸，tableview 将不会滚动。

我正在努力寻找一种方法来允许用户触摸文本字段以启用编辑但仍滚动表格视图。本质上，我需要文本视图来响应点击而不是拖动，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:56:12.373

我没有尝试这种方式，但我有一个想法：

1.  我们确实禁用了单元格上的文本字段。
2.  当使用选择单元格（tableview 中的行）时，我们将成为FirstResponder 的文本字段
3.  用户从文本字段返回后，我们会再次禁用文本字段。

# windows - 如何找到一条线并在其下方添加线

> ID：15456466
> 
> 赞同：-2
> 
> 时间：2013-03-17T00:53:06.357
> 
> 标签：windows, batch-file, cmd

我想在`HTML`文件中找到一行也包含`<`和`=`标志。在文本文件中找到该行后，我想在其下方添加行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:01:41.853

更换零件：

```
@echo off &setlocal
set "text=<!--test-->"
set "text=%text:-->=--></test>%"
setlocal enabledelayedexpansion
echo !text!
endlocal 
```

输出：

```
<!--test--></test> 
```

请从您的 HTML 文件中显示更多信息。

# php - 如何从 URL 获取所有可能的目录组合

> ID：15456470
> 
> 赞同：0
> 
> 时间：2013-03-17T00:54:29.603
> 
> 标签：php, algorithm, sorting

我无法找出一种算法来检测 url 列表中重复出现的目录模式，任何人都可以为此建议一种方法吗？我很确定这将需要一个递归调用，但我无法决定如何为每种可能的模式保存记录。

**注意**：这是在 PHP 中。

以免说您有一些网址：

```
1\. http://www.goodfood.com/recipes/special_occasion/desserts/pie/chocolate-pie.html
2\. http://www.goodfood.com/recipes/special_occasion/desserts/pie/cherry-pie.html
3\. http://www.goodfood.com/recipes/special_occasion/apps/chex-mix.html
4\. http://www.goodfood.com/recipes/special_occasion/soup/tomato.html
5\. http://www.goodfood.com/special/special_occasion/soup/beef-stew.html
6\. http://www.goodfood.com/special/special_occasion/soup/vegetable.html 
```

我想找到一种方法来确定多个 url 具有的所有可能的目录模式。所以结果看起来像这样：

```
'recipes/special_occasion' is found in urls 1, 2, 3 and 4.
'recipes/special_occasion/desserts' is found in urls 1, and 2.
'recipes/special_occasion/desserts/pie' is found in urls 1, and 2.
'special_occasion/desserts/pie' is found in urls 1, and 2.
'desserts/pie' is found in urls 1, and 2.
'special_occasion/desserts' is found in urls 1, and 2.
'special_occasion/desserts/pie' is found in urls 1, and 2.
'special/special_occasion' is found in urls 5, and 6.
'special/special_occasion/soup' is found in urls 5, and 6.
'special_occasion/soup' is found in urls 5, and 6. 
```

我的想法是遍历每个 url 并提取所有可能的新模式并将其存储在一个数组中。到目前为止，我有： $commonDomains = array();

```
 foreach($query AS $row) {

         $urlPath = parse_url($row['href'], PHP_URL_PATH);
         echo "$urlPath<br/>";

         $urlChunks = explode('/', $urlPath);
         //var_dump($urlChunks);

         foreach($urlChunks AS $domain) {
             if(strlen($domain) > 0) {
                $thisDomain = $domain.'/';
                $commonDomains[$thisDomain][] = $row['id'];
             }
         }
         var_dump($commonDomains);
     } 
```

有没有人遇到过这个？它向我尖叫模式，但我无法在网上找到答案。我想到的一切都很快变得非常复杂。请帮忙，谢谢。

* * *

我有一个我正在研究的例子：http: [//phpfiddle.org/main/code/kn4-zyh](http://phpfiddle.org/main/code/kn4-zyh)

这是我到目前为止的结果

```
/recipes/special_occasion/desserts/pie/grandmas-chocolate-pie.html
array(5) { [0]=> string(7) "recipes" [1]=> string(16) "special_occasion" [2]=> string(8) "desserts" [3]=> string(3) "pie" [4]=> string(27) "grandmas-chocolate-pie.html" } 

0 : 4 : recipes/special_occasion/desserts/pie/grandmas-chocolate-pie.html
0 : 3 : recipes/special_occasion/desserts/pie
0 : 2 : recipes/special_occasion/desserts
0 : 1 : recipes/special_occasion

1 : 4 : special_occasion/desserts/pie/grandmas-chocolate-pie.html
2 : 4 : desserts/pie/grandmas-chocolate-pie.html
3 : 4 : pie/grandmas-chocolate-pie.html

0 : 4 : recipes/special_occasion/desserts/pie/grandmas-chocolate-pie.html
1 : 3 : special_occasion/desserts/pie

**Im missing:
2 : 3 : special_occasion/desserts
1 : 2 : recipes/special_occasion 
```

**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:58:45.453

搜索一个目录的示例：

```
$links = array(
    'http://www.goodfood.com/recipes/special_occasion/desserts/pie/chocolate-pie.html',
    'http://www.goodfood.com/recipes/special_occasion/desserts/pie/cherry-pie.html',
    'http://www.goodfood.com/recipes/special_occasion/apps/chex-mix.html',
    'http://www.goodfood.com/recipes/special_occasion/soup/tomato.html',
    'http://www.goodfood.com/special/special_occasion/soup/beef-stew.html',
    'http://www.goodfood.com/special/special_occasion/soup/vegetable.html',
);

$dirs = array();
foreach ($links as $key => $link) {
    $urlPath = parse_url($link, PHP_URL_PATH);
    $arrayUrlPath = explode('/', $urlPath);
    $dirs[$key] = array();
    $counter = 0;
    foreach ($arrayUrlPath as $dir) {
        if (empty($dir) || in_array(substr($dir, -5), array('.html'))) {
            continue;
        }
        $dirs[$key][$counter++] = $dir;
    }
}

$searchDirs = $dirs;

foreach ($searchDirs as $key => $dir) {
    foreach ($dir as $name) {
        echo 'dir: ' . $name . ', found in: ' . search($name, $key, $dirs) . "\n";
    }
}

function search($name, $excludeKey, $dirs)
{
    $return = array();
    foreach ($dirs as $key => $dir) {
        if ($key === $excludeKey) {
            continue;
        }
        if (in_array($name, $dir)) {
            $return[] = (int)$key + 1;
        }
    }
    return join(', ', $return);
} 
```

如果要搜索更长的字符串重建`search`功能，请添加`explode`for`$name`和比较 for `$key`，如果 dir is `aaa/bbb/ccc`，则检查`index 0`is 'aaa' 并且 on `index 1`is`bbb`和 on `index 2`is `ccc`，除非移动指针`index+1`并再次检查。

我希望我有所帮助。

# python - multiprocessing.Process subprocess.Popen 完成了吗？

> ID：15456471
> 
> 赞同：1
> 
> 时间：2013-03-17T00:54:52.060
> 
> 标签：python, process, multiprocessing, maya

我有一个启动命令行应用程序的服务器。他们接收本地文件路径，加载文件，导出某些内容，然后关闭。

它正在工作，但我希望能够跟踪哪些任务处于活动状态以及哪些任务已完成。

所以有了这一行： p = mp.Process(target=subprocess.Popen(mayapy + ' -u ' + job.pyFile), group=None)

我试过'is_alive'，它总是返回False。

子进程关闭，我看到它在任务管理器中关闭，但进程和 pid 似乎仍然可以查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:14:16.917

您对 mp.Process 的使用是错误的。`target`应该是一个函数，而不是 的返回值`subprocess.Popen(...)`。

无论如何，如果您定义：

```
proc = subprocess.Popen(mayapy + ' -u ' + job.pyFile) 
```

然后`proc.poll()`将在进程运行时，并且在进程终止时`None`将等于返回值（不是）。`None`

* * *

例如，（输出在评论中）

```
import subprocess
import shlex
import time
PIPE = subprocess.PIPE

proc = subprocess.Popen(shlex.split('ls -lR /'), stdout=PIPE)
time.sleep(1)
print(proc.poll())
# None

proc.terminate()
time.sleep(1)
print(proc.poll())
# -15 
```

# python - 字典操作顺序

> ID：15456475
> 
> 赞同：1
> 
> 时间：2013-03-17T00:55:09.237
> 
> 标签：python, dictionary

我正在使用一个可变的数据结构，并注意到做`d[mods_mutable()] = mods_mutable()]`的行为与

```
key = mods_mutable()
d[key] = mods_mutable() 
```

很容易猜到发生了什么。快速访问一个临时文件和一个小测试确认：

```
x = 0
def f():
    global x
    x += 1
    return x

d = dict()
d[f()] = f()
print d 
```

运行它，我们得到`{2: 1}`. 显然，密钥的值是第二次评估哪种有意义（如果我们得到一个异常或这样的获取值，那么创建密钥的意义何在？）。

这种行为是否记录在案？我在官方文档上找不到任何东西，谷歌搜索也没有解决我的问题。无论实施和版本如何，我们都能保证这个顺序吗？还有更多这样的陷阱需要注意吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T00:57:53.883

> Python 从左到右计算表达式。请注意，*在评估分配时，右侧在左侧之前评估*。

见[5.14。评估顺序](http://docs.python.org/2/reference/expressions.html#evaluation-order)

# javascript - 如何使用字符串查找和更新对象

> ID：15456478
> 
> 赞同：0
> 
> 时间：2013-03-17T00:55:58.990
> 
> 标签：javascript, json

在 javascript 中，我正在加载一个 json 对象，并尝试更新其中的值。html 中的元素具有与其路径相匹配的 id，例如，其中的“values.one”元素：

> {"values":{"one":"val1","two":"val2"},"OtherStuff":"whatever"}

将与此元素有关：

```
<input id="values_one" type="text">val1</div> 
```

当这个元素失去焦点时，我想获取“#values_one”的值（使用 jQuery）并设置使用我的 json 对象中的任何值。我已经想出了如何从现有的 json 对象中获取值（请参阅下面的可怕代码），但我最终只得到了值，因此设置它不会影响 json 对象。关于如何做到这一点的任何建议（假设我不知道失去焦点的元素是“values_one”、“values_two”还是可能映射到 json 对象的任何其他元素）？

这是我目前拥有的代码（不起作用），但很高兴将其废弃以获取实际有效的代码：

> ```
> var saveEdit = function() {
>   var data = getJson();
>   pathElements = $(this).attr('id').split('_'); 
>   length = pathElements.length;
>   var path = data[pathElements[0]];
>   index = 1;
>   while (index < length) {
>       path = path[pathElements[index]];
>       length -= 1;
>   }
>   path = $(this).text(); //resets "path", but not data.values.one
>   $(this).unbind();
> } 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:01:11.277

循环比长度短一个，以便获得包含与最后一个标识符匹配的属性的元素：

```
var path = data;
for (index = 0; index < length - 1; index++) {
  path = path[pathElements[index]];
}
path[pathElements[length - 1]] = $(this).text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T01:05:58.213

Firstly, there's no such thing as a "JSON Object". Yes, I'm being pedantic, but you should either have a "JSON String", or a "Javascript Object".

It looks like you're trying to modify a *JSON string* via events, instead of just having the object itself available to reference and modify. Why bother keeping it in a string? When you're ready to export the data (perhaps saving to a db), then just `stringify();` the object and be on your way.

Take a look at the following jsFiddle for a working implementation that you can build off of: [http://jsfiddle.net/julianlam/WRZPF/](http://jsfiddle.net/julianlam/WRZPF/)

# mysql - MySQL 按 IN 顺序排列

> ID：15456481
> 
> 赞同：4
> 
> 时间：2013-03-17T00:56:18.083
> 
> 标签：mysql, sql-order-by

我有简单的查询：

```
SELECT data FROM table WHERE id IN (5, 2, 8, 1, 10) 
```

问题是，我如何选择我的数据并像在我的 IN 中一样对其进行排序。

顺序必须是 5、2、8、1、10。

问题是我没有订单的钥匙。IN 数据来自其他查询 (1)，但我需要安全订购。

有什么解决办法吗？

(1)

```
SELECT login 
FROM posts 
    LEFT JOIN users ON posts.post_id=users.id 
WHERE posts.post_n IN (
    2280219,2372244, 2345146, 2374106, 2375952, 2375320, 2371611, 2360673, 2339976, 2331440, 2279494, 2329266, 2271919, 1672114, 2301856
) 
```

**感谢您的帮助，解决方案有效，但速度很慢，也许以后会找到更好的东西，无论如何都感谢**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:32:01.147

```
SELECT data FROM table
  WHERE id IN (5, 2, 8, 1, 10)
  ORDER BY FIELD (id, 5, 2, 8, 1, 10) 
```

[http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_field](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_field)

与使用 CASE 或一些 ID=x, ID=y ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T01:06:34.907

你可以使用一个`CASE`语句

```
SELECT data 
FROM table WHERE id IN (5, 2, 8, 1, 10)
ORDER BY CASE WHEN id = 5 THEN 1 WHEN id = 2 THEN 2 WHEN id = 8 THEN 3 WHEN id = 1 THEN 4 WHEN id = 10 THEN 5 END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T01:03:24.470

我认为按任意列表排序的唯一方法是与`ORDER BY`该列表中的每个项目进行比较。这很丑陋，但它会起作用。您最好对您正在选择的任何代码进行排序。

```
SELECT data FROM t1 WHERE id IN (5, 2, 8, 1, 10)
ORDER BY id = 10, id = 1, id = 8, id = 2, id = 5 
```

顺序是相反的，否则您将不得不添加`DESC`到每个条件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-17T01:55:22.673

[http://sqlfiddle.com/#!2/40b299/6](http://sqlfiddle.com/#!2/40b299/6)

我认为这就是您正在寻找的 :D 适应您自己的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T01:20:38.763

要在 MySql 中动态执行此操作，我建议执行以下操作：

1.  创建一个临时表或表变量（不确定 MySql 是否有这些），包含两列：

> ```
> OrderID mediumint not null auto_increment
> InValue mediumint -(or whatever type it is) 
> ```

1.  按顺序插入IN子句的值，会按插入顺序生成ID

2.  `JOIN`在此临时表上的查询中添加一个

3.  将您的订购方式更改为

> ```
> order by TempTable.OrderID 
> ```

1.  删除临时表（同样，在存储过程中的 SQL 中，这是自动的，不确定 MySql 所以在此提及以进行全面披露）

这有效地避免了您在表中没有键来订购的问题......您创建了一个。应该管用。

# objective-c - CAEmitterCell 粒子位置

> ID：15456483
> 
> 赞同：3
> 
> 时间：2013-03-17T00:56:44.213
> 
> 标签：objective-c, xcode, caemittercell

我有一个使用 uiview 粒子发射器的降雪动画。由于大量的研究，我能够以各种方式为雪设置动画，包括更改粒子的图像内容。有一个圆形区域，我想在其中更改粒子的雪图像，然后在粒子离开该区域时将图像改回来。（灯光下的雪花）

我正在考虑编写一个公式来根据粒子在动画循环中的位置切换内容图像，但我无法获得粒子的 x、y。是否有可能获得单个粒子的位置？

或者也许是粒子碰撞检测？

# jquery-ui - 使用 jQuery Slider 插件中的 onstatechange: 函数将滑块绑定到选择元素（如 jQueryUI Demo 中所示）

> ID：15456486
> 
> 赞同：0
> 
> 时间：2013-03-17T00:57:03.607
> 
> 标签：jquery-ui, bind, uislider, html-select

我正在尝试修改[jQuery UI 演示](http://jqueryui.com/slider/#hotelrooms)中给出的函数，以将滑块绑定到现有的选择元素，以便与[jQuery Slider Plugin](http://egorkhmelev.github.com/jslider/)一起使用。该函数应允许用户将值更改为滑块或选择元素，并自动更新另一个元素。

我已经修改了插件的函数，以便在 Select 元素的值更改时更新 Slider，但我不知道如何修改该函数，以便在 Slider 的值更改时更新 Select 元素。

**更新 -**插件文档有一个“onstatechange function()”，当滑块改变状态时触发，但我不确定如何修改代码以满足我的需要。给出的示例代码是：`onstatechange: function( value ){console.dir( this ); }`，使用 onStateChange: 函数的小提琴发布在这里：http: [//jsfiddle.net/v3gUg/18](http://jsfiddle.net/v3gUg/18)

*HTML & JS*

```
<select name="SliderSelect" id="SliderSelect">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
</select>
<div class="layout">      
    <div class="layout-slider">
      <input id="Slider" type="slider" name="area"  value="3"/>
    </div>
    <script type="text/javascript" charset="utf-8">
    $(function () {
        var select = $("#SliderSelect");
        jQuery("#Slider").slider({ 
            from: 1, 
            to: 5, 
            scale: ['Dislike','','','', 'Love'], 
            limits: false, 
            step: 1, 
            dimension: '',
            skin: "classic"
        }); 
        $("#SliderSelect").change(function () {
            jQuery("#Slider").slider("value", this.selectedIndex + 1);
        });
    });
    </script>
</div> 
```

*jQuery UI Demo中使用的函数*

```
$(function () {
    var select = $("#minbeds");
    var slider = $("<div id='slider'></div>").insertAfter(select).slider({
        min: 1,
        max: 6,
        range: "min",
        value: select[0].selectedIndex + 1,
        slide: function (event, ui) {
            select[0].selectedIndex = ui.value - 1;
        }
    });
    $("#minbeds").change(function () {
        slider.slider("value", this.selectedIndex + 1);
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:07:02.560

您是否尝试指定一个函数来响应滑块的变化作为`change`属性？

```
jQuery("#Slider").slider({ 
        from: 1, 
        to: 5, 
        scale: ['Dislike','','','', 'Love'], 
        limits: false, 
        step: 1, 
        dimension: '',
        skin: "classic"
        // add this
        change: function( event, ui ) {  
             //... add your response code here}
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-04T07:48:39.447

您可以使用 onstatechange 代替回调。效果是您的函数在滑块移动时被触发，它不会等待鼠标向上事件

```
 jQuery("#Slider").slider({
                from: 0, 
                to: max_slider_val, 
                step: 1, 
                smooth: true, 
                round: 0, 
                dimension: "&nbsp;", 
                skin: "plastic", 
                onstatechange: function( myvalue ){ 
                  console.log(myvalue);
                  } }); 
```

# php - “未处理的异常：从空值创建默认对象”

> ID：15456489
> 
> 赞同：0
> 
> 时间：2013-03-17T00:57:14.400
> 
> 标签：php, relationship, laravel, eloquent, laravel-3

我正在尝试显示一段代码，同时显示您可以对这些片段进行的注释（我称之为片段代码）。但我无法查看发表每条评论的用户的用户名。我希望在打电话时有每个用户，`with(array('user', 'comments', 'comments.user'))`但我只是得到一个未处理的异常。

```
//Models
class Code extends Eloquent 
{
    public function user() {
        return $this->belongs_to('User');
    }

    public function comments() {
        return $this->has_many('Comment');
    }
}

class Comment extends Eloquent
{
    public function user() {
        $this->belongs_to('User');
    }

    public function code() {
        $this->belongs_to('Code');
    }
}

class User extends Eloquent 
{
    public function codes() {
        return $this->has_many('Code');
    }

    public function comments() {
        return $this->has_many('Comment');
    }
}
//Controller
    public function get_show($id)
    {
        //$code = Code::with(array('user', 'comments'))->where_slug($id)->first();
        //$comments = Comment::with(array('user'))->where_code_id($id)->get();
        $code = Code::with(array('user', 'comments', 'comments.user'))->where_slug($id)->first();
        dd($code);
        //return View::make('code.show')->with(array('code' => $code));
    }   

//View
    <h2>{{ $code->title }}</h2>
    @include('code.controls')
    <p>Syntax: {{ $code->syntax}} </p>
    <p><pre class="prettyprint linenums"><code class="language-{{ $code->syntax }}">{{ $code->content }}</code></pre></p>
    @foreach($code->comments as $comment)
        <div class="comment">
        <p><a href="">#{{ $comment->id }}</a></p>
        {{ User::find($comment->user_id)->first()->name }}
        <p>{{ $comment->body }}</p>
        </div>
    @endforeach

//Message when trying to view
Unhandled Exception
Message:

Creating default object from empty value

Location:

/home/victor/Projects/check-my-code/laravel/database/eloquent/query.php on line 167

Stack Trace:

#0 /home/victor/Projects/check-my-code/laravel/laravel.php(40): Laravel\Error::native(2, 'Creating defaul...', '/home/victor/Pr...', 167)
#1 /home/victor/Projects/check-my-code/laravel/database/eloquent/query.php(167): Laravel\{closure}(2, 'Creating defaul...', '/home/victor/Pr...', 167, Array)
#2 /home/victor/Projects/check-my-code/laravel/database/eloquent/query.php(140): Laravel\Database\Eloquent\Query->load(Array, 'user', NULL)
#3 /home/victor/Projects/check-my-code/laravel/database/eloquent/query.php(74): Laravel\Database\Eloquent\Query->hydrate(Object(Comment), Array)
#4 /home/victor/Projects/check-my-code/laravel/database/eloquent/query.php(186): Laravel\Database\Eloquent\Query->get()
#5 /home/victor/Projects/check-my-code/laravel/database/eloquent/query.php(140): Laravel\Database\Eloquent\Query->load(Array, 'comments', NULL)
#6 /home/victor/Projects/check-my-code/laravel/database/eloquent/query.php(74): Laravel\Database\Eloquent\Query->hydrate(Object(Code), Array)
#7 /home/victor/Projects/check-my-code/application/controllers/codes.php(31): Laravel\Database\Eloquent\Query->get()
#8 [internal function]: Codes_Controller->get_show('testar-snippets')
#9 /home/victor/Projects/check-my-code/laravel/routing/controller.php(325): call_user_func_array(Array, Array)
#10 /home/victor/Projects/check-my-code/laravel/routing/controller.php(285): Laravel\Routing\Controller->response('show', Array)
#11 /home/victor/Projects/check-my-code/laravel/routing/controller.php(165): Laravel\Routing\Controller->execute('show', Array)
#12 /home/victor/Projects/check-my-code/laravel/routing/route.php(153): Laravel\Routing\Controller::call('codes@show', Array)
#13 /home/victor/Projects/check-my-code/laravel/routing/route.php(124): Laravel\Routing\Route->response()
#14 /home/victor/Projects/check-my-code/laravel/laravel.php(125): Laravel\Routing\Route->call()
#15 /home/victor/Projects/check-my-code/public/index.php(34): require('/home/victor/Pr...')
#16 {main} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T14:57:24.420

类 Comment 中的方法缺少返回语句。

```
class Comment extends Eloquent
{
    public function user() {
        $this->belongs_to('User');
    }

    public function code() {
        $this->belongs_to('Code');
    }
} 
```

**应该**

```
class Comment extends Eloquent
{
    public function user() {
        return $this->belongs_to('User');
    }

    public function code() {
        return $this->belongs_to('Code');
    }
} 
```

从 Laravel 论坛上的一个帖子获得帮助：[http ://forums.laravel.io/viewtopic.php?id=6266](http://forums.laravel.io/viewtopic.php?id=6266)

# android - SharedPreferences 和 PreferenceFragment

> ID：15456496
> 
> 赞同：5
> 
> 时间：2013-03-17T00:58:45.197
> 
> 标签：android, sharedpreferences

我已经在 ANdroid 开发者网站上完成了 PreferenceFragments 和 SharedPreferences 的示例，但是我现在遇到了一个问题。我希望能够从不同的活动访问我的“设置”屏幕中的首选项，但我不知道我的首选项片段生成的首选项文件的名称是什么。有谁知道为 PreferenceFragment 指定首选项文件名？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-17T01:03:39.523

首选项应保存到默认文件。

要访问，请使用[`PreferenceManager#getDefaultSharedPreferences()`](https://developer.android.com/reference/android/preference/PreferenceManager.html#getDefaultSharedPreferences%28android.content.Context%29)

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences (context); 
```

`context`是任何有效的上下文，包括活动。

从文档中[`PreferenceFragment`](http://developer.android.com/reference/android/preference/PreferenceFragment.html)：

> 要检索此片段中的首选项层次结构将使用的 SharedPreferences 实例，请使用与此片段相同的包中的上下文调用 getDefaultSharedPreferences(android.content.Context)。

# c# - 使用工作线程将项目出队

> ID：15456499
> 
> 赞同：0
> 
> 时间：2013-03-17T00:59:16.173
> 
> 标签：c#, multithreading, queue, .net-4.5

我一直在试图弄清楚如何解决我的需求，但是对于我的生活，我就是想不出一个解决方案。

我有一个项目数据库，将它们存储为一种队列。（数据库已经实现，其他进程将向此队列添加项目。）

这些项目需要大量的工作/时间来“处理”，所以我需要能够： 不断地从数据库中取出项目。对于每个项目，运行一个新线程并处理该项目，然后返回真/假，它已成功处理。（这将用于将其重新添加到数据库队列中）

但是仅在当前活动线程数（每个正在处理的项目一个）小于最大线程数参数时才执行此操作。

一旦达到最大线程数，我需要停止从数据库中取出项目，直到当前线程数小于最大线程数。此时它需要继续使项目出队。

感觉这应该是我能想出的东西，但它只是没有来找我。

澄清一下：我只需要实现线程。数据库已经实现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T12:28:34.003

一种非常简单的方法是使用`Semaphore`. 您有一个线程可以使项目出列并创建线程来处理它们。例如：

```
const int MaxThreads = 4;
Semaphore sem = new Semaphore(MaxThreads, MaxThreads);
while (Queue.HasItems())
{
    sem.WaitOne();
    var item = Queue.Dequeue();
    Threadpool.QueueUserWorkItem(ProcessItem, item); // see below
}
// When the queue is empty, you have to wait for all processing
// threads to complete.
// If you can acquire the semaphore MaxThreads times, all workers are done
int count = 0;
while (count < MaxThreads)
{
    sem.WaitOne();
    ++count;
}

// the code to process an item
void ProcessItem(object item)
{
    // cast the item to whatever type you need,
    // and process it.
    // when done processing, release the semaphore
    sem.Release();
} 
```

上述技术效果很好。它易于编码，易于理解且非常有效。

一项更改是您可能更愿意使用`Task`API `Threadpool.QueueUserWorkItem`。`Task`使您可以更好地控制异步处理，包括取消。我`QueueUserWorkItem`在我的例子中使用了，因为我更熟悉它。我会`Task`在生产程序中使用。

尽管这确实使用了 N+1 个线程（其中 N 是您要同时处理的项目数），但那个额外的线程通常不会做任何事情。它运行的唯一时间是在将工作分配给工作线程时。否则，它会在信号量上进行非忙碌等待。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:22:11.423

你只是不知道从哪里开始？

考虑一个具有最大线程数的线程池。[http://msdn.microsoft.com/en-us/library/y5htx827.aspx](http://msdn.microsoft.com/en-us/library/y5htx827.aspx)

考虑立即增加最大线程数并监控数据库。[http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)很方便。

请记住，您不能保证您的流程会安全结束……崩溃会发生。考虑记录处理状态。

请记住，您的 select 和 remove-from-queue 操作应该是原子的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T11:28:52.587

好的，所以解决方案的架构将取决于一件事：每个队列项目的处理时间是否根据项目的数据而变化？

如果没有，那么您可以在处理线程之间进行循环。这将相当容易实现。

如果处理时间确实有所不同，那么您将需要具有更多“下一个可用”感觉的东西，这样无论哪个线程恰好是空闲的，都会首先获得处理数据项的工作。

解决了这个问题后，您将通常围绕如何在队列读取器和处理线程之间进行同步。“下一个可用”和“循环”之间的区别在于您如何进行同步。

我对 C# 并不太熟悉，但我听说过一种叫做后台工作者的野兽。这可能是实现这一目标的一种可接受的方式。

对于循环，只需为每个队列项启动一个后台工作程序，将工作人员的引用存储在一个数组中。例如，将自己限制在 16 个正在进行的后台工作人员。这个想法是，在开始 16 之后，您将在开始 17 之前等待第一个完成，依此类推。我相信后台工作人员实际上作为线程池上的作业运行，因此这将自动将任何时候实际运行的线程数限制为适合底层硬件的数量。要等待后台工作人员，请参阅[this](https://stackoverflow.com/questions/123661/how-to-wait-for-a-backgroundworker-to-cancel)。等待后台工作人员完成后，您将处理其结果并启动另一个。

对于下一个可用的方法，它并没有太大的不同。而不是等待第一个完成，您将使用 WaitAny() 等待任何工作人员完成。您处理任何一个完成的返回，然后启动另一个并返回到 WaitAny()。

这两种方法的一般理念是始终保持多个线程处于沸腾状态。下一个可用方法的一个特点是您发出结果的顺序不一定与输入项的顺序相同。如果这很重要，那么使用比 CPU 内核更多的后台工作程序的循环方法将相当有效（线程池将刚刚开始调试但还没有运行工作程序）。然而，延迟会随着处理时间而变化。

BTW 16 是根据您认为运行该软件的 PC 上的内核数量选择的任意数字。更多的核心，更大的数量。

当然，在看似不安和不断变化的 .NET 世界中，现在可能有更好的方法来做到这一点。

祝你好运！

# objective-c - 使用带有自定义按钮的主详细信息应用程序的 segue。

> ID：15456500
> 
> 赞同：0
> 
> 时间：2013-03-17T00:59:25.430
> 
> 标签：objective-c, ios6, uistoryboardsegue, xcode-storyboard

所以，我有一个主细节应用程序。到目前为止，在启动​​时创建了一个对象并将其添加到主列表中，详细视图也可以正常工作。

我想做的是让用户通过按下按钮将对象添加到主列表。不过，我不需要新的视图，我想为此部分使用标准的详细视图。

当用户点击“添加”按钮时，应该创建一个新对象，然后进入该对象的详细视图。我想，“嘿，为什么不使用标准的 segue 呢？” 所以我在 MasterView 中添加了一个**Bar Button Item 。**

这是我来自 MasterViewController.m 的代码：

```
-(IBAction)addNewItem:(UIStoryboardSegue *)segue{

    if([[segue identifier] isEqualToString:@"showDetail"]){

        CoolItem *newItem;
        NSDate *today = [NSDate date];
        newItem = [[CoolItem alloc]initWithDate:today];

        [self.dataController addCoolItemWithItem:newItem];
        DetailViewController *detailViewController = [segue destinationViewController];

        detailViewController.coolItem = newItem;

    }
} 
```

“showDetail”是主从模板附带的标准segue的标识符。

结果：没有！该方法不会在按钮点击时调用。

我已确保我的按钮已连接到此方法（但它确实在文档大纲中显示为展开转场）。

关于出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T08:01:57.723

我不确定出了什么问题，但我能够使用以下代码实现所需的功能：

```
-(void)viewDidload {
      ...
      self.navigationItem.rightBarButtonItem = 
     [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd                                                                                                     
                            target:self
                            action:@selector(Add:)];    
}

-(IBAction)Add:(id)sender 
{
    // Create the new item and set it as active
    ...

    [self performSegueWithIdentifier: @"SegueName" sender:self];
} 
```

希望这可以帮助亚龙

# android - Android，没有 XML

> ID：15456501
> 
> 赞同：1
> 
> 时间：2013-03-17T00:59:32.120
> 
> 标签：android, xml, security

我是一个初学者并正在构建 android 应用程序，我想知道，我是否必须使用 XML 来构建一个成功的 android 应用程序？

它如何影响用户使用应用程序的方式？如果没有 XML，安全性会降低吗？尤其是在应用程序需要登录凭据的情况下？

除了使用 XML 之外，我无法在网上找到任何关于构建 android 应用程序的其他方法的示例。

对不起，如果我的问题感觉很愚蠢，但我真的很感激回复。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T01:14:11.553

> 我必须使用 XML 来构建成功的 android 应用程序吗？

不，您可以使用 Java 制作整个布局，并使其看起来完全相同（除了一些只能通过 XML 应用的主题选项）。

但是，如果您有主屏幕小部件，则必须有一些 XML 文件（如 AndroidManifest.xml）和小部件 XML。

> 它如何影响用户使用应用程序的方式？

在 99% 的情况下，他们不会注意到。

> 没有 XML，安全性会降低吗？

这个问题没有意义。

> 特别是如果应用程序需要登录凭据？

同样，这没有任何意义。

您如何构建 UI 与安全性无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:15:38.177

> 我必须使用 XML 来构建成功的 android 应用程序吗？

好吧，你需要 XML 来创建一个原生 Android 应用程序*，*因为你需要一个 Android Manifest，它恰好是一个 XML 文件。使用字符串资源而不是在整个应用程序中使用硬编码字符串也是一种很好的做法。但我敢肯定你问天气你需要用 XML 构建你的布局，还是不对？在这种情况下，您不必使用 XML，但我建议您使用，因为动态构建整个布局可能比在 XML 中构建它要困难得多（我个人认为）。但这当然是可能的。

> 它如何影响用户使用应用程序的方式？

如果一切都做对了，那么 XML 构建布局可以与动态构建布局相同。（使用 java 构建布局甚至比使用 XML 有一些 API 优势）

> 没有 XML，安全性会降低吗？

不。

# jquery - 用于选择的 jQuery 正则表达式选择器

> ID：15456502
> 
> 赞同：0
> 
> 时间：2013-03-17T00:59:41.127
> 
> 标签：jquery, regex, selector

我尝试使用这样的一些：`$('input[class=^(copy-photo|copy-attachment)]:last')`但不起作用。任何想法，如何通过简单的正则表达式输入与类`copy-photo`或选择`copy-attachment`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:21:25.040

您真的不应该根据类属性字符串中类项的位置进行选择。jQuery 没有原生的正则表达式选择器，所以你将不得不以艰难的方式去做。

```
$('input[class^=copy-photo],input^=[copy-attachment]').last() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T01:04:13.920

几乎，您必须将 =^ 切换为 ^=

# java - 在 SWF 中运行 Java 游戏？

> ID：15456503
> 
> 赞同：-1
> 
> 时间：2013-03-17T00:59:46.243
> 
> 标签：java, browser, flash, game-development

因此，我希望用 Java 编写游戏，但能够将其发布在在线视频游戏网站上。由于某些原因，大多数游戏网站不支持使用`.jar`文件，所以我很遗憾不能直接发布。但是，我已经看到了一种有效的方法，但我需要解释它是什么以及如何去做。一些 Java 游戏看起来像是放在一个独立的网站上，然后一个 SWF 加载页面，就像浏览器一样。例如，尽管实际游戏是用 Java 编写的，但[Kongregate 上的 Runescape](http://www.kongregate.com/games/Runescape_Jagex/runescape)似乎是这样运行的。

这是一种已知的方法吗？有谁知道如何做到这一点？拜托，我真的很喜欢用 Java 编写的游戏，而不是 ActionScript。我无法想象从`SWF`类似于浏览器的方式运行 Java 有那么难。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:13:55.133

Runescape 使用自己的[Java 网页版开始](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-136112.html)玩游戏。当您第一次玩 Runescape 时，Jagex 使用 Java web start 将 Java 代码加载到您的计算机上，从而加载游戏的其余部分。这就是每次玩游戏时更新检查所做的。

您可以编写 Java 应用程序，以便它使用 Java Web 启动。您必须在网页上提供一个 URL，以便用户的浏览器可以将您的代码下载到他们的计算机上。

您的另一个选择是编写一个[Java 小程序](http://docs.oracle.com/javase/tutorial/deployment/applet/index.html)。小程序从网页运行。该网页具有用于启动小程序的小程序 HTML。

# regex - 使用 RegExp 选择范围

> ID：15456505
> 
> 赞同：1
> 
> 时间：2013-03-17T01:01:03.320
> 
> 标签：regex, syntax, vbscript

我将用示例代码解释我所追求的。我的功能`GetDox`看起来很接近，但它仍然不完整。这是一个测试代码。

```
'test begin...
'<dox>
'  <member type="Public Sub" name="Increment" return="void">
'    <param type="Integer" name="nBase" out="true" />
'    <param type="Integer" name="nStep" out="false" />
'    <purpose>
'      purpose here...
'    </purpose>
'  </member>
'  <member ... />
'</dox>
'other comments here...
Public Sub Increment(nBase, nStep) 'some example content
    nBase = nBase + nStep
End Sub
'<Unwonted_Item />

Dim source  'reading the same file just for simplification
With CreateObject("Scripting.FileSystemObject")
    With .OpenTextFile(WScript.ScriptFullName, 1, False)
        source = .ReadAll
    End With
End With
result = GetDox(source)
WScript.Echo result  'display our result

Function GetDox(sCode)  'unfinished function
    Dim regEx, Match, Matches, mVal, sEnd
    sEnd = "</dox>" & vbNewLine
    Set regEx = New RegExp
    regEx.Pattern = "('<dox>\n|'\s*<.*)" 'my ugly pattern
    regEx.IgnoreCase = True
    regEx.Global = True
    Set Matches = regEx.Execute(sCode)
    For Each Match In Matches
        mVal = Match.Value
        mVal = Replace(mVal, vbCr, vbNewLine)
        mVal = Right(mVal, Len(mVal) - 1)
        GetDox = GetDox & mVal
        If mVal = sEnd Then Exit For
    Next
End Function 
```

这就是我得到的：

```
<dox>
  <member type="Public Sub" name="Increment" return="void">
    <param type="Integer" name="nBase" out="true" />
    <param type="Integer" name="nStep" out="false" />
    <purpose>
    </purpose>
  </member>
  <member ... />
</dox> 
```

这就是我需要的：

```
<dox>
  <member type="Public Sub" name="Increment" return="void">
    <param type="Integer" name="nBase" out="true" />
    <param type="Integer" name="nStep" out="false" />
    <purpose>
      purpose here...
    </purpose>
  </member>
  <member ... />
</dox> 
```

缺少“这里的目的......”这一行，我知道整个`RegExp.Pattern`语法很弱。我只想选择`<dox>`以包含所有内容开头和结尾的整个内容`</dox>`，但我坚持使用模式语法。

**PS** 有了如此出色的帮助（感谢所有人），这是我现在的工作职能：

```
Function GetDox(sCode)
    GetDox = vbNullString
    With New RegExp
        .Pattern    = "<dox>[\s\S]*?</dox>"
        .IgnoreCase = True
        .Global     = False
        With .Execute(sCode)
            If .Count = 0 Then Exit Function
            GetDox  = .Item(0).Value
        End With
        .Pattern    = "^'"
        .Global     = True
        .Multiline  = True
        GetDox = .Replace(GetDox, "")
    End With
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T10:53:52.633

我首先删除前导单引号：

```
regEx.Pattern = "^'"
regEx.Global  = True
sCode = regEx.Replace(sCode, "") 
```

然后提取 XML 文本：

```
regEx.Pattern = "<dox>[\s\S]*?</dox>"
regEx.Global  = False
regEx.IgnoreCase = True
Set m = regEx.Execute(sCode)
If m.Count > 0 Then GetDox = m(0).Value 
```

之后，您应该将 XML 读入[DOM 树](http://msdn.microsoft.com/en-us/library/ms756987)以进行进一步处理：

```
Set xml = CreateObject("Msxml2.DOMDocument.6.0")
xml.async = False
xml.loadXML result 
```

如果您的 XML 在单独的文件中，您应该直接从文件中加载 XML 并使用[XPath](http://saxon.sourceforge.net/saxon7.2/expressions.html)表达式提取节点，正如@FrankSchmitt 在他的评论中所建议的那样。

```
Set xml = CreateObject("Msxml2.DOMDocument.6.0")
xml.async = False
xml.load "C:\path\to\your.xml"

Set nodes = xml.selectNodes("//dox") 
```

XML 不是面向行的，也不应该像这样解析。如果处理不当，事情很可能会以有趣的方式出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T04:31:37.337

要修复您的代码，您可以使用这个正则表达式：`('<dox>\n|'\s*[\S \t]*)` [demo](http://regex101.com/r/aE4mE1)

另一种方法是先获取您需要的所有内容，`<dox>[\s\S]+?<\/dox>`然后对其应用替换：
搜索：`^'`并替换为空

或者，清除前导空格：
Search: `^'\s*`and replace with nothing [demo](http://regex101.com/r/cY8rI7)

# node.js - 向我的 Jade 模板添加页脚时超出了最大调用堆栈大小

> ID：15456513
> 
> 赞同：1
> 
> 时间：2013-03-17T01:03:04.720
> 
> 标签：node.js, express, pug

好的，这有点奇怪，但情况就是这样。

我正在玩 Express 和 Jade 诱人系统。

我有一个相当简单的`layout.jade`文件：

```
doctype 5
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
    h1 Nav goes here!
  body
    block content 
```

和一个`home.jade`文件：

扩展布局

```
block content
  h1= title
  p Welcome to #{title} 
```

上述组合工作正常。

但是，我想添加一个页脚，所以我创建了一个`foot.jade`文件：

```
extends layout

block foot
  h1= me 
```

并添加`include foot`到我的`layout.jade`文件中。

现在，如果我尝试访问我的应用程序的主页，我会收到一个`Maximum call stack size exceeded`错误：/

我的 app.js 文件是：

```
/**
 * Module dependencies.
 */

var express = require('express')
  , home = require('./routes/home')
  , http = require('http')
  , path = require('path');

var app = express();

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('your secret here'));
  app.use(express.session());
  app.use(app.router);
  app.use(require('stylus').middleware(__dirname + '/public'));
  app.use(express.static(path.join(__dirname, 'public')));
});

app.configure('development', function(){
  app.use(express.errorHandler());
});

app.get('/', function(req, res) {
  res.render('home', {title: 'Ninja Store'});
});

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T06:36:22.990

`foot.jade`使用`extends layout`, 加载`layout.jade`, 包含`foot.jade`, 使用`extends layout`, 加载`layout.jade`, ...

换句话说：`extends layout`从`foot.jade`;)中删除

# php - 将 MySQL 表的元素与 PHP 结合起来

> ID：15456514
> 
> 赞同：0
> 
> 时间：2013-03-17T01:03:12.750
> 
> 标签：php, mysql, arrays

我有一项艰巨的任务是显示各个地方的小时数。我想结合时间从一个晚上开始到第二天早上结束的实例。任何人都知道我如何能够修改下面的脚本以使其正常工作？

应尽可能合并具有相同 place_id 的所有结果，time_group_id 对此没有任何意义。如果时间在 11:59 结束，那么我想假设它一直持续到第二天早上。

**我当前的表格输出如下：**

周一至周四：晚上 11:00 至晚上 11:59

周二至周五：凌晨 12:00 至凌晨 2:00

**我希望它看起来像这样：**

周一至周四：晚上 11:00 至凌晨 2:00

**我有一个如下所示的 MySQL 表：**

![在此处输入图像描述](../Images/4a6432dc48f9225ce8d2fbb5e56abf66.png)

**我的 PHP 脚本：**

```
<?php

//connect

$day_times = array();
$days_map = array(
  'monday'     => 'Mon',
  'tuesday'    => 'Tue',
  'wednesday'  => 'Wed',
  'thursday'   => 'Thu',
  'friday'     => 'Fri',
  'saturday'   => 'Sat',
  'sunday'     => 'Sun'
);

$query = mysql_query("SELECT distinct day, time_group_id, start_time, end_time FROM times 
WHERE place_id = '80' ORDER BY id ASC");

while ($row=mysql_fetch_assoc($query)) {
    $start_time = stripslashes($row['start_time']);
    $end_time = stripslashes($row['end_time']);

    $start_time = strtotime("$start_time");
    $end_time = strtotime("$end_time");

    $day = strtolower($row['day']);

    $day_times[$row['time_group_id']]['times'][] = $start_time;
    $day_times[$row['time_group_id']]['times'][] = $end_time;
    $day_times[$row['time_group_id']]['days'][]  = $day;
}

foreach ($day_times as $timegroup) {
    $first_day = array_shift($timegroup['days']);
    $last_day = array_pop($timegroup['days']);
    $times = $timegroup['times'];

    echo $days_map[$first_day] . ' - ' . $days_map[$last_day] . ': ';
    echo date('g:ia', min($times));
    echo ' to ';
    echo date('g:ia', max($times));     
    echo '<br />';
}  

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:10:55.877

您可能想考虑简单地为“结束”日添加另一列以缓解您的生活。这甚至提供了在一个数据集中从 mo 01:00 到 mo 00:55 的可能性

（并且 mysql_* 已弃用。使用 pdo）

# ruby-on-rails - heroku 上的私人酒吧

> ID：15456528
> 
> 赞同：5
> 
> 时间：2013-03-17T01:04:44.957
> 
> 标签：ruby-on-rails, heroku, chat, faye, private-pub

我正在使用 rails 3.2.12 和一个名为[private pub的伟大 gem 开发一个聊天应用程序，您可以](https://github.com/ryanb/private_pub)[在这里](http://railscasts.com/episodes/316-private-pub)找到一个截屏视频。它建立在[faye](https://github.com/jamesotron/faye-rails)之上，使您可以通过推送消息轻松建立实时聊天。

现在，在 heroku 上部署它实际上并不像私人 pub 那样简单。显然，您必须为 faye 频道设置另一个应用程序，然后从您的另一个应用程序订阅该频道。

这一切都非常令人困惑。私人酒吧和 faye 在他们的文档中都没有关于在 heroku 上部署的任何内容。我找到了这两个链接：

*   [Heroku 上的私人酒吧 | 导轨 3](https://stackoverflow.com/questions/15273991/private-pub-on-heroku-rails-3)
*   [http://webprogramming29.wordpress.com/2013/02/15/setup-privatepub-or-faye-on-heroku/](http://webprogramming29.wordpress.com/2013/02/15/setup-privatepub-or-faye-on-heroku/)

但是，我并不真正了解它们，因为它们从更高级的水平开始。

你们有没有人在 heroku 上部署过私人 pub/faye 应用程序，并且可以提供分步指南？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T14:31:25.267

您可以在 github [https://github.com/Hareramrai/batkaro](https://github.com/Hareramrai/batkaro)查看我的示例聊天。您还可以在 github [https://github.com/Hareramrai/fayeserver](https://github.com/Hareramrai/fayeserver)查看 private_pub 服务器代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-22T00:38:50.443

如果有人正在寻找更新的答案，我刚刚发布了一个可以在 Rails 应用程序中实现实时行为的 gem：

[https://github.com/dhacke/entangled](https://github.com/dchacke/entangled)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-22T16:31:57.710

听起来，从您链接的文章中，您需要运行两个 Web 进程。一个用于普通 Web 服务器，一个用于 Faye 服务器。

拥有两个 Heroku 应用程序可能比尝试让每个应用程序在同一个应用程序中运行更容易。

# node.js - Node.js 更新 mongodb 数组中的元素

> ID：15456530
> 
> 赞同：0
> 
> 时间：2013-03-17T01:05:17.587
> 
> 标签：node.js, mongodb

我有以下猫鼬模式和模型：

```
//GameBoards
var gameBoardSchema = mongoose.Schema({
  mCurrentPlayer: Number,
  mCurrentPlayerName: String,
  mStarted: Boolean,
  mSwitching: Boolean,
  mFinished: Boolean,
  mPlayers: [{mPlayerId: String, mUsername: String, mHand: [{mValue: Number, mSuit:     String}], mFaceDown: [{mValue: Number, mSuit: String}], mFaceUp: [{mValue: Number, mSuit: String}], mPosition: Number, mSwitching: Boolean}],
  mDeck: [{mValue: Number, mSuit: String}],
  mPile: [{mValue: Number, mSuit: String}],
  mStartedAt: {type: Date},
  mLastUpdate: {type: Date},
  mChanceTaken: Boolean,
  mRoundLenght: Number,
  mNumberOfPlayers: Number,
  mLocked: Boolean
});
var GameBoard = mongoose.model('gameBoard', gameBoardSchema); 
```

我的数据库中已经有一个包含四个玩家的游戏板。现在我正在尝试使用以下命令更新数据库中的特定播放器：

```
GameBoard.update({_id: game._id, "mPlayers.mUsername": updatedPlayer.mUsername}, {$set: {"mPlayers.$": updatedPlayer}}).exec(); 
```

但这似乎不起作用，但我没有收到错误=/。我试图用相同的参数进行查找，这就像一个魅力。有人可以指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T18:28:46.000

我尝试了一些不同的东西，看起来猫鼬不喜欢 $. 当我在做“mPlayers.1”时，它就像一个魅力:)

# spring - AnnotationException 没有为超类上具有@Id 的实体指定标识符

> ID：15456531
> 
> 赞同：2
> 
> 时间：2013-03-17T01:05:18.280
> 
> 标签：spring, hibernate

我正在开始一个新项目，这是我第一次使用 Hibernate 4 并在没有 hibernate 模板的情况下使用 Spring 3。

这是我的两个实体类：（这似乎发生在所有实体类上）

```
/**
 * Tweener to connect multiple dictionary entries in various ways
 * @author thom
 */
@Entity
@Table( name = "CROSS_REF",
        uniqueConstraints=    @UniqueConstraint(columnNames = {"FROM_ENTRY_UUID", "TO_ENTRY_UUID", "XREF_TYPE"})
)
public class CrossReference     extends Pojo 
                                 implements Comparable<CrossReference>{
    /**
     * Cross reference types
     * @author thom
     */
    public enum XrefType{
        /**
         * Another way to spell this word
         */
        alternateSpelling,
        /**
         * Word you get by adding or removing a letter
         */
        hook,
        /**
         * Root word with additional endings
         */
        variation
    }

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "FROM_ENTRY_UUID", referencedColumnName = "UUID", nullable=false)
    private DictionaryEntry     fromEntry;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "TO_ENTRY_UUID", referencedColumnName = "UUID", nullable=false)
    private DictionaryEntry     toEntry;

    @Column(name = "XREF_TYPE", nullable = false)
    private XrefType            xrefType;
... 
```

它是超级类：

```
/**
 * Base class for all POJO objects
 * @author Heavyweight software
 */
public class Pojo {
  public static final long      EMPTYUUID   = -1;

  /**
   * Convert a calendar into a formatted timestamp useful for display
   * @param date the calendar being strung
   * @return a standardized time stamp version of a calendar
   */
  @Transient
  public static String getTimestamp(Calendar date) {
    if(date==null){
      return "";
    }

    DateFormat formatter = DateFormat.getDateTimeInstance();
    String str = formatter.format(date.getTime());
    return str;
  }

  @Id
  @GeneratedValue(strategy=GenerationType.AUTO)
  @Column(name = "UUID", nullable = false, unique = true)
  protected Long uuid = EMPTYUUID; 
```

这是我的错误：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'testSessionFactory' defined in URL [file:/home/thom/workspace/LexDataAccess/bin/config/test-dao-spring.xml]: Invocation of init method failed; nested exception is org.hibernate.AnnotationException: No identifier specified for entity: com.heavyweight.lexaholic.model.lexicon.CrossReference
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1486)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at com.heavyweight.lexaholic.dao.hibernate.HibernateTestSchema.initBeanFactory(HibernateTestSchema.java:42)
    at com.heavyweight.lexaholic.dao.hibernate.HibernateTestSchema.getBeanFactory(HibernateTestSchema.java:50)
    at com.heavyweight.lexaholic.dao.hibernate.HibernateTestSchema.getDictionaryEntryDAO(HibernateTestSchema.java:74)
    at com.heavyweight.lexaholic.dao.hibernate.lexicon.DictionaryEntryHibernateDAOTest.setUp(DictionaryEntryHibernateDAOTest.java:31)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
    at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hibernate.AnnotationException: No identifier specified for entity: com.heavyweight.lexaholic.model.lexicon.CrossReference
    at org.hibernate.cfg.InheritanceState.determineDefaultAccessType(InheritanceState.java:277)
    at org.hibernate.cfg.InheritanceState.getElementsToProcess(InheritanceState.java:224)
    at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:664)
    at org.hibernate.cfg.Configuration$MetadataSourceQueue.processAnnotatedClassesQueue(Configuration.java:3448)
    at org.hibernate.cfg.Configuration$MetadataSourceQueue.processMetadata(Configuration.java:3402)
    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1330)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1729)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1780)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:242)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:372)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:357)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    ... 34 more 
```

我所做的所有研究都表明此错误是由缺少@Id 引起的，但是，正如您所看到的，我有它。是基类和 Hibernate 4 的问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T01:14:07.993

我觉得你应该补充`@MappedSuperclass`。`Pojo`

# javascript - 如何防止函数复制，创建调用函数数组的构造函数

> ID：15456532
> 
> 赞同：0
> 
> 时间：2013-03-17T01:05:31.143
> 
> 标签：javascript

目前，我已经定义了一个构造函数，它将使用私有变量 funcs 创建一个对象。

extend 方法会将新函数添加到 funcs 数组中。

resolve 函数将调用 funcs 数组中的所有函数：

```
var extendableFunc = function() {

   var funcs = [];

   this.resolve = function () {
      for(var i=0; i<funcs.length; i+=1) {
         funcs[i]();

      }
   };

   this.extend = function(newFn) {
      funcs.push(newFn);
   }

};

var exampleExt = new extendableFunc();

exampleExt.extend(function() {

   alert("hello!");
});

exampleExt.resolve(); 
```

要将相同的函数添加到多个 extendableFunc 对象的 funcs 数组中，我可以编写如下函数：

```
var extendMultiple = function(exts, func) {
   for(var i=0; i<exts.length; i+=1) {
      exts[i].extend(func);
   } 
} 
```

但是，我相信这将创建我要添加到每个 funcs 数组的函数的新副本。

如果我要向调用数组添加一个函数，我希望只有一个函数——并且数组中只有对它的引用。

如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:16:49.040

函数是一种 javascript 对象，通过引用传递或分配 - 将函数引用放入数组不会复制函数。

# mysql - 此 SQL 是否被视为 JOIN？

> ID：15456537
> 
> 赞同：2
> 
> 时间：2013-03-17T01:06:36.830
> 
> 标签：mysql

我正在使用 MySQl 根据“模块”表中的类别 ID 从 1 个表中提取类别名称。

我的以下 SQL 可以很好地满足我的需要，但我想知道这是否被认为是`JOIN`？

既然它不调用 a `JOIN`?

```
SELECT  `mo_category_fk` ,  `mo_name_vc` ,  `mc_name_vc`
FROM x_modcats mc, x_modules m
WHERE mc.mc_id_pk = m.mo_category_fk
AND m.mo_folder_vc =  :module 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:09:00.927

是 - 在 MySQL 中，隐式和显式连接具有相同的执行计划。您可以使用 来验证这一点`EXPLAIN`。但这是来自另一个线程的示例：

```
mysql> explain select * from table1 a inner join table2 b on a.pid = b.pid;
+----+-------------+-------+------+---------------+------+---------+--------------+------+-------+
| id | select_type | table | type | possible_keys | key  | key_len | ref          | rows | Extra |
+----+-------------+-------+------+---------------+------+---------+--------------+------+-------+
|  1 | SIMPLE      | b     | ALL  | PRIMARY       | NULL | NULL    | NULL         |  986 |       |
|  1 | SIMPLE      | a     | ref  | pid           | pid  | 4       | schema.b.pid |   70 |       |
+----+-------------+-------+------+---------------+------+---------+--------------+------+-------+
2 rows in set (0.02 sec)

mysql> explain select * from table1 a, table2 b where a.pid = b.pid;
+----+-------------+-------+------+---------------+------+---------+--------------+------+-------+
| id | select_type | table | type | possible_keys | key  | key_len | ref          | rows | Extra |
+----+-------------+-------+------+---------------+------+---------+--------------+------+-------+
|  1 | SIMPLE      | b     | ALL  | PRIMARY       | NULL | NULL    | NULL         |  986 |       |
|  1 | SIMPLE      | a     | ref  | pid           | pid  | 4       | schema.b.pid |   70 |       |
+----+-------------+-------+------+---------------+------+---------+--------------+------+-------+
2 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:08:54.117

是的，你正在加入。根据[文档](http://dev.mysql.com/doc/refman/5.0/en/join.html)，`,`可以用作`JOIN`关键字 .. 的替代品，除非您不能使用非常有用的`ON`子句。但是，您有一个连接`WHERE`子句中的表的条件。在我看来，将其作为`FROM`条款的一部分更有意义：

```
SELECT mo_category_fk, mo_name_vc, mc_name_vc
FROM x_modcats mc 
JOIN x_modules m ON (mc.mc_id_pk = m.mo_category_fk)
WHERE m.mo_folder_vc = :module 
```

# python-2.7 - Python 中的 errno 2 - 没有这样的文件或目录

> ID：15456542
> 
> 赞同：0
> 
> 时间：2013-03-17T01:08:00.190
> 
> 标签：python-2.7

我正在尝试使用以下代码从我的数据目录中的每个文件计算最大值：

```
from os import listdir 

def max_files(dir):
    l = listdir(dir)
    for n in l:
        list_num(n)

def list_num(file):
    f = open(file)
    lines = f.readlines()   
    v=[]
    for n in lines:
        for s in n.split():
            v.append(float(s))  
            mx = v[0]  
            maxi=[] 
            for i in v:
                if i > mx:
                    mx = i
                    maxi.append(mx)
            continue
       continue
    return maxi 
```

打印最大文件（路径）

我还检查了我的路径，它是完全正确的。错误是：

```
f = open(file)
IOError: [Errno 2] No such file or directory: 'bvp.txt' 
```

bvp.txt 是我数据目录中的第一个文件！我对 Python 或编程不是很有经验，所以遇到了一些麻烦，实际上我现在开始在学院使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:11:20.660

在使用返回目录中文件列表的函数的返回值时，您遇到了一个常见的困惑。

`listdir`只是返回该目录中的文件列表。它不会返回这些文件的*路径*，只是返回文件名。因此，除非您正在操作的目录是当前目录，否则这是行不通的；您正在尝试打开当前目录中的每个文件。

每当使用 的结果时`listdir`，如果您不打算将工作目录更改为该目录，则需要在打开文件之前将目录名称添加回文件中。因此，将文件的完整路径传递给，`list_num`而不仅仅是文件名：

```
list_num(dir + '/' + n) 
```

# php - Twig 使用什么设计模式来实现加载器？

> ID：15456547
> 
> 赞同：2
> 
> 时间：2013-03-17T01:09:26.590
> 
> 标签：php, design-patterns, abstract-class, twig

我正在研究设计模式，尤其是工厂和抽象工厂模式。我研究了 Fabien Potencier 的 Twig，并`Twig_Loader_Filesystem`根据我的另一种情况调整了他为课程编写代码的方式。

这是他开始上课的方式：

```
class Twig_Loader_Filesystem
    implements Twig_LoaderInterface, Twig_ExistsLoaderInterface 
```

我想知道 Fabien 这样做的方式`Twig_Loader_Filesystem`是否被视为抽象工厂模式或只是一种简单的抽象设计模式？因为我可以看出使用接口暗示抽象，但我*认为*这不是工厂类。

也许他在其他地方使用了工厂方法？这里使用什么设计模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:55:48.203

在实际实现中可能涉及其他模式（工厂也是），但您在这里写的是策略模式。

[http://en.wikipedia.org/wiki/Strategy_pattern](http://en.wikipedia.org/wiki/Strategy_pattern)

[http://sourcemaking.com/design_patterns/strategy](http://sourcemaking.com/design_patterns/strategy)

策略模式是基本抽象的一个例子，其中可互换的类实现了一个通用接口并封装了不同的算法，而客户端类不必关心或意识到它们。

# android - 注销输入通道失败

> ID：15456548
> 
> 赞同：2
> 
> 时间：2013-03-17T01:09:34.370
> 
> 标签：android, runtimeexception

在我的一个市场应用程序中，我不时看到一些来自野外的报告，并且无法确定它们被抛出的原因。我没有做任何我认为在我的应用程序中不寻常的事情。有没有人有任何想法？

```
java.lang.RuntimeException: Failed to unregister input channel.  status=-22
    at android.view.InputQueue.nativeUnregisterInputChannel(Native Method)
    at android.view.InputQueue.unregisterInputChannel(InputQueue.java:119)
    at android.view.ViewRootImpl.dispatchDetachedFromWindow(ViewRootImpl.java:2471)
    at android.view.ViewRootImpl.doDie(ViewRootImpl.java:4030)
    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2790)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4517)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
    at dalvik.system.NativeStart.main(Native Method) 
```

我看到很多“无法*注册*输入通道”的点击，但没有看到*unregister*，因此这个问题的原因。

我尝试搜索，但只从 AOSP 树中找到了这个作为异常来源：

```
from: aosp-frameworks-base / core / jni / android_view_InputQueue.cpp

static void android_view_InputQueue_nativeUnregisterInputChannel(JNIEnv* env, jclass clazz,
        jobject inputChannelObj) {
    status_t status = gNativeInputQueue.unregisterInputChannel(env, inputChannelObj);

    if (status) {
        String8 message;
        message.appendFormat("Failed to unregister input channel.  status=%d", status); <-- POSSIBLY THROWING THIS EXCEPTION
        jniThrowRuntimeException(env, message.string());
    }
} 
```

# javascript - 在 Chrome 中将“新数字”分配给原型字段打印为 {}

> ID：15456550
> 
> 赞同：2
> 
> 时间：2013-03-17T01:09:58.370
> 
> 标签：javascript, google-chrome, console.log

我正在尝试遵循 JavaScript 示例。

```
function A() {};

A.prototype.x = new Number(10);

var a = new A();

console.log(a.x); 
```

在 Firefox 中，其打印值为 10，但在 Chrome 或 Node.js 中，其打印值为 {}。

但是当像下面这样更改第二行时，它也会在 chrome 中打印 10

```
A.prototype.x = 10; 
```

有人可以解释一下为什么 new Number(10) 不能在 chrome 中工作的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:13:45.523

`new Number(...)`创建一个装箱的 Number 实例，它与数字原语不同。
Chrome 的控制台将其显示为一个对象。

如果你写`console.log(new Number(10))`，你会看到相同的输出。

如果您更改代码以使用原语 ( `A.prototype.x = 10`)，它将显示`10`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:14:08.667

这是因为您正在制作一个 Number 包装器对象而不是一个原始对象，这是 Chrome 选择的表示形式。*（控制台表示并不总是相同的。没有标准。）*

实际数字`10`存储在名为 的内部属性中`[[PrimitiveValue]]`，因此不会直接公开。

要获取它`[[PrimitiveValue]]`，您可以使用该`.valueOf()`方法。

```
console.log(a.x.valueOf()); // 10 
```

* * *

> **[15.7.2.1 新数字（[值]）](http://es5.github.com/#x15.7.2)**
> 
> 新构造对象的`[[Prototype]]`内部属性设置为原始 Number 原型对象，即`Number.prototype`(15.7.3.1) 的初始值。
> 
> 新构造对象的`[[Class]]`内部属性设置为`"Number"`。
> 
> **如果提供了值，则新构造对象的`[[PrimitiveValue]]`内部属性设置为`ToNumber(value)`，否则设置为`+0`。**
> 
> 新构造对象的`[[Extensible]]`内部属性设置为`true`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T01:13:47.357

因为 Number 是一个对象。`console.log(a.x.valueOf());`或`console.log(a.x.toString());`将工作。

# python - “在字符串格式化期间并非所有参数都转换” Python Django

> ID：15456551
> 
> 赞同：5
> 
> 时间：2013-03-17T01:10:09.360
> 
> 标签：python, django

我在 Windows Vista 上使用 Python 2.7 在 Django 1.5 中编程。我正在尝试创建用户配置文件。但是，当我访问 localhost:8000/admin/home/userprofile 时，我得到了 1146，“Table 'demo.home_userprofile' 不存在错误。现在我有`models.py`：

```
from django.db import models
from django.contrib.auth.models import User
# Create your models here.

class userProfile(models.Model):

    def url(self, filename):
        ruta = "MultimediaData/Users/$s/%s"%(self.user.username, filename)
        return ruta

    user = models.OneToOneField(User)
    photo = models.ImageField(upload_to = url)
    telefono = models.CharField(max_length = 30)

    def __unicode__(self):
        return self.user.username 
```

Django页面指向`not all arguments converted during string formatting`我的错误。这是一个允许用户上传图片和电话号码的页面。似乎是什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T01:11:25.327

改变：

```
ruta = "MultimediaData/Users/$s/%s"%(self.user.username, filename) 
```

至：

```
ruta = "MultimediaData/Users/%s/%s"%(self.user.username, filename)
#                            ^ Notice the sign change 
```

您似乎使用了 a`$`而不是 a `%`，这就是问题所在。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-17T01:35:42.220

为了使其与 Python 2 或 3 兼容...

```
ruta = "MultimediaData/Users/{0}/{1}".format(self.user.username, filename) 
```

# ios - Objective C NSStream 连接总是被拒绝

> ID：15456552
> 
> 赞同：1
> 
> 时间：2013-03-17T01:10:19.517
> 
> 标签：ios, objective-c, cocoa, tcp, nsstream

我正在尝试在 Cocoa 和 cocoa touch 中设置一些 NSInput/Output 流。我正在尝试通过 Wifi 在我的 Mac 和我的 iPod 之间建立连接。不过，无论如何，我总是会收到**连接被拒绝**的错误。我对每个设备的地址进行了硬编码（因为这只是一个测试）。我基本上按照Apple的文档无济于事。我已经坚持了好几天了。任何帮助将不胜感激！

**Mac 端的代码。**

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    CFReadStreamRef tempRead;
    CFWriteStreamRef tempWrite;

    NSHost *theHost = [NSHost hostWithAddress:@"10.0.1.2"];

    CFStreamCreatePairWithSocketToHost(NULL, (__bridge CFStringRef)([theHost address]), 80, &tempRead, &tempWrite);

    myInput = (__bridge NSInputStream *)(tempRead);
    myOutput = (__bridge NSOutputStream *)(tempWrite);

    [myOutput setDelegate:(id<NSStreamDelegate>) self];
    [myInput setDelegate:(id<NSStreamDelegate>) self];

    [myOutput setProperty: NSStreamSocketSecurityLevelNone forKey: NSStreamSocketSecurityLevelKey];
    [myInput setProperty: NSStreamSocketSecurityLevelNone forKey: NSStreamSocketSecurityLevelKey];

    [myOutput scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [myInput scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

    [myOutput open];
    [myInput open];
}
- (void)stream:(NSStream *)theStream handleEvent:(NSStreamEvent)streamEvent
{
    NSLog(@"StreamEvent: %lu", streamEvent);
    if(theStream == myOutput)
    {
        if(streamEvent == NSStreamEventHasSpaceAvailable)
        {
            NSString *myString = @"Hello";

            uint8_t *string1 = (unsigned char *) [myString UTF8String];

            NSInteger written;

            written = [myOutput write: (const uint8_t *) string1 maxLength: strlen((const char *)string1)];
            return;
            }
        }

        if(theStream == myInput)
        {
            NSLog(@"Reading event: %li", streamEvent);
            return;
        }

        NSError *theError = [myOutput streamError];

    NSLog(@"BasicError: %@", [theError localizedDescription]);
}
-(void)dealloc
{
    [myOutput close];
} 
```

**苹果手机**

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions: (NSDictionary *)launchOptions
{
    CFReadStreamRef tempRead;
    CFWriteStreamRef tempWrite;

    NSHost *theHost = [NSHost hostWithAddress:@"10.0.1.2"];

    [NSStream getStreamsToHost: theHost port:80 inputStream:&inpStream outputStream:&outpStream];

    NSLog(@"Input and output: %@, %@", tempRead, tempWrite);

    myInput = (__bridge NSInputStream *)(tempRead);
    myOutput = (__bridge NSOutputStream *)(tempWrite);

    [myOutput setDelegate:(id<NSStreamDelegate>) self];
    [myInput setDelegate:(id<NSStreamDelegate>) self];

    //If they intercept my voice, woop dee doo, nobody cares!
    [myInput setProperty: NSStreamSocketSecurityLevelNone forKey: NSStreamSocketSecurityLevelKey];

    [myInput scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

    [myInput open];

    NSLog(@"DidFinnishLaunchingStatus: %u", [myInput streamStatus]);

    return YES;
}

- (void)stream:(NSStream *)theStream handleEvent:(NSStreamEvent)streamEvent
{
    NSLog(@"TheEvent: %u", streamEvent);

    if(streamEvent == NSStreamEventHasBytesAvailable)
    {
        NSLog(@"Reading");

        uint8_t * read1 = NULL;

        unsigned int outputBytes = 0;

        outputBytes = [myInput read: read1 maxLength:1024];

        NSLog(@"outputBytes: %i", outputBytes);
        if(outputBytes)
        {
            NSLog(@"read1: %s", read1);
        }
        return;
    }
}
-(void)dealloc
{
    //Cleanup is tidyness.
    [myInput close];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T19:34:07.950

好吧，显然我认为您不能以这种方式连接两个设备。其中一个必须是服务器。目前我正在使用 SocketKit

[https://github.com/unixpickle/SocketKit](https://github.com/unixpickle/SocketKit)

但我相信更好的解决方案是 Cocoa ASyncSocket。（这是我接下来要尝试的）

# ios - 如何在 iOS 中设置动画线程？

> ID：15456555
> 
> 赞同：1
> 
> 时间：2013-03-17T01:11:03.217
> 
> 标签：ios, multithreading, animation, nsthread, runloop

我有一个`drawView`线程安全的函数，可以在短时间内绘制游戏动画。我有函数`startAnimating`和`stopAnimating`. 我希望后台线程以`drawView`固定速率调用，但仅在启用动画期间调用。

在`startAnimating`我打算调用视图`performSelectorInBackground:withObject:`来让线程运行。

我对如何进行线程通信和初始化绘图线程有点困惑：具体来说，设置一个运行循环来接收显示链接消息，然后在最后通知线程它应该退出并在何时干净地退出运行`stopAnimating`循环从主线程调用。我想确保它`drawView`永远不会被调用 after `stopAnimating`，并且绘图线程不会在绘图操作中间突然取消。我在网上看到了很多对这类问题的非常糟糕的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T08:34:10.133

好的，在整个晚上阅读了 Apple 页面后，我终于用这段代码解决了这个问题：

```
// object members
NSThread *m_animationthread;
BOOL m_animationthreadrunning;

- (void)startAnimating
{
    //called from UI thread
    DEBUG_LOG(@"creating animation thread");
    m_animationthread = [[NSThread alloc] initWithTarget:self selector:@selector(animationThread:) object:nil];
    [m_animationthread start];
}

- (void)stopAnimating
{
    // called from UI thread
    DEBUG_LOG(@"quitting animationthread");
    [self performSelector:@selector(quitAnimationThread) onThread:m_animationthread withObject:nil waitUntilDone:NO];

    // wait until thread actually exits
    while(![m_animationthread isFinished])
        [NSThread sleepForTimeInterval:0.01];
    DEBUG_LOG(@"thread exited");

    [m_animationthread release];
    m_animationthread = nil;
}

- (void)animationThread:(id)object
{
    @autoreleasepool
    {
        DEBUG_LOG(@"animation thread started");
        m_animationthreadrunning = YES;

        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];

        CADisplayLink *displaylink = [CADisplayLink displayLinkWithTarget:self selector:@selector(displayLinkAction:)];
        [displaylink setFrameInterval:3];

        [displaylink addToRunLoop:runLoop forMode:NSDefaultRunLoopMode];

        while(m_animationthreadrunning)
        {
            [runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]];
            DEBUG_LOG(@"runloop gap");
        }

        [displaylink removeFromRunLoop:runLoop forMode:NSDefaultRunLoopMode];

        DEBUG_LOG(@"animation thread quit");
    }
}

- (void)quitAnimationThread
{
    DEBUG_LOG(@"quitanimationthread called");
    m_animationthreadrunning = NO;
}

- (void)displayLinkAction:(CADisplayLink *)sender
{
    DEBUG_LOG(@"display link called");
    //[self drawView];
} 
```

我使用该行`[self performSelector:@selector(quitAnimationThread) onThread:m_animationthread withObject:nil waitUntilDone:NO]`而不是简单地设置`m_animationthreadrunning = NO`的`stopAnimating`原因是因为运行循环可能不会及时返回，但调用选择器会强制它返回。

# ruby - heroku克隆后如何让rails应用程序在本地工作？

> ID：15456559
> 
> 赞同：0
> 
> 时间：2013-03-17T01:11:55.967
> 
> 标签：ruby, ruby-on-rails-3, heroku

我的本地代码搞砸了，所以我想从 heroku 下载版本并开始使用它。我跑了这个下载

```
heroku git:clone -a myapp 
```

然后我安装了水龙头

```
gem install taps 
```

然后我跑了

```
heroku db:pull 
```

这就是所需要的吗？只是想确保我不会搞砸任何事情，并且以后可以使用 git push heroku master 轻松重新部署。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:17:36.453

我没有尝试直接从 Heroku 中提取代码，但我不确定您为什么需要这样做，因为“git push heroku master”只是将代码的 master 分支从 Git 存储库推送到 Heroku。除非您将“脏”代码推送到 Git，否则您应该能够在本地删除坏代码并执行“git pull”以直接从 Git 存储库中获取好代码。

# database - 如何编写一个返回 SPARQL 最大值的查询？

> ID：15456562
> 
> 赞同：1
> 
> 时间：2013-03-17T01:12:13.343
> 
> 标签：database, sparql, semantic-web

我想在 SPARQL 中进行查询，以查找每个州拥有大多数本科生的州和大学。

我试过这个：

```
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dbpr: <http://dbpedia.org/resource/>
PREFIX dbpo: <http://dbpedia.org/ontology/>
PREFIX dbpprop: <http://dbpedia.org/property/>
PREFIX dbpedia: <http://dbpedia.org/resource/>
SELECT ?University ?State (MAX(?nu) AS ?size)
    WHERE{
        ?University dbpo:numberOfUndergraduateStudents ?nu.
        ?University a dbpo:University.
        ?University dbpo:state ?State.
        {
        SELECT ?State
            WHERE{
                ?State a dbpo:PopulatedPlace.
                ?State a dbpo:AdministrativeRegion.
                ?State dbpo:country dbpedia:United_States.
                ?State dbpo:capital ?Capital.
                FILTER(bound(?Capital))
            }
        }
    } 
```

但是，它没有返回我的预期输出。它从一个州返回不止一所学校。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T19:09:32.353

您不需要内部 SELECT（它可以放在外部块中）。

```
FILTER(bound(?Capital)) 
```

-- ?资本必须绑定。

那你需要

```
GROUP BY ?State 
```

将其放入内部 SELECT 并使用外部 SELECT 查找具有该大小状态的实际大学（-ies）。

您的查询目前在技术上是非法的：

```
SELECT ?University ?State (MAX(?nu) AS ?size) 
```

没有 GROUP BY 是错误的。您只能选择 GROUP BY 变量和聚合

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T16:53:18.407

正如 AndyS 所说：这里做事的顺序是

1.  找出每个州本科生人数的最大值，
2.  查找拥有该数量本科生的大学。

第一步进入子查询，第二步进入外部查询。然后你得到这个：

```
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dbpr: <http://dbpedia.org/resource/>
PREFIX dbpo: <http://dbpedia.org/ontology/>
PREFIX dbpprop: <http://dbpedia.org/property/>
PREFIX dbpedia: <http://dbpedia.org/resource/>
SELECT ?University ?State ?size
WHERE{
    ?University dbpo:numberOfUndergraduateStudents ?size.
    ?University a dbpo:University.
    ?University dbpo:state ?State.
    {
    SELECT ?State (MAX(?nu) as ?size)
        WHERE{
            ?State a dbpo:PopulatedPlace.
            ?State a dbpo:AdministrativeRegion.
            ?State dbpo:country dbpedia:United_States.
            ?State dbpo:capital ?Capital.
            ?University dbpo:numberOfUndergraduateStudents ?nu.
            ?University a dbpo:University.
            ?University dbpo:state ?State.
            FILTER(bound(?Capital))
        }
        GROUP BY ?State
    }
} 
```

# python - Scrapy Python Craigslist Scraper

> ID：15456577
> 
> 赞同：4
> 
> 时间：2013-03-17T01:14:33.533
> 
> 标签：python, scrapy, scraper, craigslist

我正在尝试使用**Scrapy**抓取 Craigslist 的分类信息以提取待售商品。

我能够提取**日期、帖子标题和帖子网址，**但无法提取**价格**。

由于某种原因，当前代码提取**了所有**价格，但是当我在价格跨度查找之前删除**//时，价格字段返回为空。**

有人可以查看下面的代码并帮助我吗？

```
from scrapy.spider import BaseSpider
    from scrapy.selector import HtmlXPathSelector
    from craigslist_sample.items import CraigslistSampleItem

    class MySpider(BaseSpider):
        name = "craig"
        allowed_domains = ["craigslist.org"]
        start_urls = ["http://longisland.craigslist.org/search/sss?sort=date&query=raptor%20660&srchType=T"]

def parse(self, response):
    hxs = HtmlXPathSelector(response)
    titles = hxs.select("//p")
    items = []
    for titles in titles:
        item = CraigslistSampleItem()
        item['date'] = titles.select('span[@class="itemdate"]/text()').extract()
        item ["title"] = titles.select("a/text()").extract()
        item ["link"] = titles.select("a/@href").extract()
        item ['price'] = titles.select('//span[@class="itempp"]/text()').extract()
        items.append(item)
    return items 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:34:04.623

`itempp`似乎在另一个元素内，`itempnr`. 如果您要更改`//span[@class="itempp"]/text()`为`span[@class="itempnr"]/span[@class="itempp"]/text()`.

# c++ - 如何确定是否使用 '->' 与 '.'

> ID：15456580
> 
> 赞同：1
> 
> 时间：2013-03-17T01:15:28.683
> 
> 标签：c++, windows, direct2d

我正在关注一个 D2D 示例，其中出现了以下代码：

```
 if(!(D2D1_WINDOW_STATE_OCCLUDED & m_renderTarget->CheckWindowState()))
    {
        m_renderTarget->BeginDraw();

        Draw();

        if(m_renderTarget->EndDraw() == D2DERR_RECREATE_TARGET)
        {
            m_renderTarget.Reset();
            Invalidate();
        }
    } 
```

我注意到 m_renderTarget 使用了 -> （我忘记了它叫什么），后来又使用了点运算符。出于某种原因，我认为 use 只能使用一个或另一个，具体取决于它是引用类型还是值类型。显然我想错了，但找不到有关何时使用每个运算符的任何信息（或者更确切地说，每个运算符的目的。）

任何澄清将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T01:26:03.647

> 我认为 use 只能使用一个或另一个，这取决于它是引用类型还是值类型

通常，是的。

两者都用于代码中的同一对象这一事实表明它是“智能指针”，即具有重载的对象类型`operator->`，允许它像指针一样工作。

```
 m_renderTarget->BeginDraw(); 
```

这使用`operator->`来访问它指向的对象的成员。`BeginDraw`是指向对象的成员函数，而不是`m_renderTarget`.

```
 m_renderTarget.Reset(); 
```

这访问了它自己的一个成员`m_renderTarget`，而不是它指向的对象。通常，`reset()`成员用空指针替换指向的对象。

所以在第一种情况下，`->`语法对它指向的对象做一些事情，而在第二种情况下，`.`语法对对象本身做一些事情。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-17T01:18:28.073

箭头运算符所做的是尊重一个指针（指向一个对象），然后使用 ' 。' 剩余表达式上的运算符。

它与

```
 (*m_renderTarget).BeginDraw(); 
```

箭头运算符用于避免与此混淆

```
 *(m_renderTarget.BeginDraw()); 
```

这当然可能是灾难性的，并可能导致程序崩溃。

这在这里用一个很好的例子[来解释](http://codingmash.com/c/the-arrow-operator-in-c/)

# c - 将大小前缀（u8、u16 等）添加到 C 变量名称的任何程序或脚本

> ID：15456582
> 
> 赞同：0
> 
> 时间：2013-03-17T01:15:40.703
> 
> 标签：c

作为一名嵌入式软件工程师，我需要在变量名称中添加大小前缀（u8、u16 等）。有没有人创建或知道会自动执行此操作的程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:43:19.360

不要那样做。永远不要*考虑*这样做。

您`uint16`今天的工作很可能会`uint32`在几年内提高下一个架构的效率。那么“有用的前缀”只会令人困惑。如果您需要此类信息，请在需要时获取[doxygen](http://www.doxygen.nl/)之类的信息或向您的 IDE 询问变量的类型。不要用（大多数时候）不相关的细节浪费程序员的（我们都知道*非常*有限！）大脑带宽。

另请查看 Linux [CodingStyle](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/tree/Documentation/CodingStyle)以了解有关此问题的更多想法。

# php - file_get_html()，返回 -> 带有另一种编码的纯文本

> ID：15456583
> 
> 赞同：0
> 
> 时间：2013-03-17T01:15:50.470
> 
> 标签：php, mysql

好的，所以，我在标签之间获取一些文本，然后使用 file_get_html，现在，文本以不同的编码返回，这就是我所做的：

```
$name = $dom->find('h1');
$name = $name[0]->plaintext; 
$name = html_entity_decode($name);
$name = utf8_decode($name); 
```

html_entity_decode 确实删除了大部分垃圾，但我仍然收到诸如“-”之类的标志到它原来的'-'值？有什么快速解决办法吗？

我对编码不是很了解，任何帮助都非常感谢

# c - 如何初始化一个枚举？

> ID：15456585
> 
> 赞同：3
> 
> 时间：2013-03-17T01:16:06.520
> 
> 标签：c, function, enums

```
typedef enum
{
    HEARTS = 0, 
    SPADES, 
    DIAMONDS, 
    CLUBS
}Suits; //here HEARTS = 0, SPADES = 1, DIAMONDS = 2, and CLUBS = 3  

int main()
{
    Suits hand;
    play(hand);
    return 0;
}

void play(Suits hand)
{
    printf("Testing.\n");
} 
```

当我编译类似的东西时，编译器给了我错误：函数'play'的隐式声明和警告：'menu'可能在这个函数中未初始化使用。我该如何解决这些问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T01:30:53.600

当编译器遇到*播放*调用时，它还不知道该函数，因为它在下面声明。因此发出警告。只需将声明移到*main之前*

```
typedef enum{HEARTS = 0, SPADES, DIAMONDS, CLUBS}Suits; //here HEARTS = 0, SPADES = 1, DIAMONDS = 2, and CLUBS = 3  

void play(Suits hand)
{
  printf("Testing.\n");
}

int main()
{
  Suits hand;
  play(hand);
  return 0;
} 
```

要删除第二个警告，您声明

```
Suits hand; 
```

但是*hand*尚未初始化，因此编译器会警告您提供给函数*play*的值未初始化。

*只需为hand*设置一个值：

```
Suits hand = SPADES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T01:27:13.400

正如您在上面声明的那样，`Suits`定义了一个只能包含 HEARTS、SPADES、DIAMONDS、CLUBS 之一的类型。因此，当您声明`hand`为`Suit`类型时，它可以采用您在枚举中定义的值。

尝试定义`hand`为卡片类型：

```
hand = SPADES; 
```

然后调用 play(hand)。

把它想象成声明一个`int`.

```
int x; 
```

`x`是整数类型，并且必须包含此类型定义的值。如果你调用一个函数

```
someFunc (x); 
```

如果不初始化`x`，您将获得未定义的行为。

编辑：另外，把你的`play`函数的定义放在上面`main`（在枚举定义之后）。要么，要么你需要在上面声明你的函数`main`：

```
void play(Suits hand); 
```

否则，`main`不知道“玩”指的是什么，因为定义在它之后。

# android - Android 解压文件 EOFException

> ID：15456588
> 
> 赞同：1
> 
> 时间：2013-03-17T01:16:38.240
> 
> 标签：android, android-asynctask

我收到以下错误：

```
03-17 02:10:13.272: W/System.err(26433): java.io.EOFException
03-17 02:10:13.282: W/System.err(26433):    at     libcore.io.Streams.readFully(Streams.java:83)
03-17 02:10:13.282: W/System.err(26433):    at     java.util.zip.ZipInputStream.getNextEntry(ZipInputStream.java:231) 
```

我在后台线程上运行下载设置了写入外部存储的权限。我的代码是：

```
ZipInputStream zis = null;
try
{
    zis = new ZipInputStream(archive);
    ZipEntry zeCurrent;
    while ((zeCurrent = zis.getNextEntry()) != null)
    {
       [...]
    }
} 
```

循环被调用 0 次，因为在它进入循环之前调用了这个 eo​​f。那里发生了什么事？

我使用restlet进行json通信。我的下载代码：

```
ClientResource cres = new ClientResource(myURL);
cres.setRequestEntityBuffering(true);
Representation response = request.post(new JacksonRepresentation<MyRequest>(MediaType.APPLICATION_JSON, request));

unzip(response.getStream(), downloadPath); 
```

因此，MyRequest 是代表 json 的我的对象，downloadPath 存在。

# if-statement - 何时使用 XOR，何时使用 IFF？

> ID：15456592
> 
> 赞同：0
> 
> 时间：2013-03-17T01:17:26.480
> 
> 标签：if-statement, xor, rule, declarative, paradigms

由于 ((NOT A) XOR B) 和 A→B ("iff....then") (~A→~B) 在逻辑上是相同的（例如，除非发生身份验证，否则无法登录）这是否有任何实际用途或只是一个逻辑重言式，程序员可以任意决定在哪里使用 XOR 以及在哪里使用 if...then？

一个示例重写是 payment→delivery ("iff payment() == 'complete' then delivery()") 重写为 ((NOT payment()) XOR delivery())

编辑：真值表

A: 付款 B: 交货

```
AB A' (A→B) (A' XOR B) (A' OR B)
TTFTTT
TFFFFF

```

失败在哪里

```
AB A' (A→B) (A' XOR B) (A' OR B)
TFFFFF

```

并且 A 为假的情况只是一个假 B，以下所有内容仅意味着 B 为假（因为不是 A）。

```
AB A' (A→B) (A' XOR B) (A' OR B)
FTTT       _            _
飞腾

```

或者`goal → score ^ ¬goal→¬score`说存在确定性，没有其他方法（如果你不进球，你就不能得分）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:48:52.177

A→B 等价于 (A' OR B)。这些在逻辑上是相同的，可以互换使用。

为 A→B 和 (A' XOR B) 构建真值表，您会发现它们在逻辑上并不等价。

编辑：这是真值表

EDIT2：用（B iff A）更新了真值表，是的，在逻辑上等同于（A' XOR B）并且可以互换使用。

```
AB A' (A→B) (A' XOR B) (A' OR B) (B 当且仅当 A)
TTTTTT
TFFFFFF
FTTT       F            TF
FFTTTTT

```

# spring - 我可以编写两个单独的 pojo 类，一个用于验证，另一个用于休眠映射

> ID：15456594
> 
> 赞同：0
> 
> 时间：2013-03-17T01:17:38.250
> 
> 标签：spring, hibernate, jakarta-ee, design-patterns, spring-mvc

如果是，如何映射它们。我正在使用 jsr bean 验证和休眠映射注释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T03:53:51.103

您不必通过将两个类映射到一个表来执行此操作。您可以将映射到表的一个类 A 定义为 PO（持久对象），并将另一个类 B 定义为将视图、控制器和服务层之间的值传输为 DTO/VO（数据传输对象/值对象）以进行验证或数据传输。使用***BeanUtils***在 PO 和 DTO 之间复制属性。

# c - 如何找出 *char 字符串是否以“.abc”结尾

> ID：15456596
> 
> 赞同：2
> 
> 时间：2013-03-17T00:40:18.490
> 
> 标签：c

我已经将一些东西传递给了这些变量：

```
char *filename;
int filename_len; 
```

如何检查是否`filename`以“.abc”结尾？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-17T01:16:48.400

```
if (filename_len >= 4 && strcmp(filename + filename_len - 4, ".abc") == 0) {
  // match
} 
```

# ios - 加载新视图后仍然听到旧视图的声音

> ID：15456598
> 
> 赞同：0
> 
> 时间：2013-03-17T01:17:53.760
> 
> 标签：ios, uiview, avplayer

我遇到了一个问题：我成功地从一个视图转换到下一个视图 - 从包含静态图像的视图到包含视频（使用 avPlayer 的 mov 或 mp4 等）的视图，反之亦然或任何其他类型的序列.

但是，当我从包含视频的视图过渡到包含图像的视图时，加载图像后我仍然听到视频的声音。奇怪的。最有趣的是，当我从视频过渡到视频时，它不会发生......有什么想法吗？

请检查我用来转换视图的代码（具有溶解效果）：

```
- (void) replaceView: (UIView *) theCurrentView withView: (UIView *) theReplacementView
{

    theReplacementView.alpha = 0.0;
    [self.view addSubview: theReplacementView];

    [UIView animateWithDuration: 1.5
                     animations:^{
                         theCurrentView.alpha = 0.0;
                         theReplacementView.alpha = 1.0;
                     }
                     completion:^(BOOL finished) {
                         [theCurrentView removeFromSuperview];
                     }];

    self.currentView = theReplacementView;
    [self.view addSubview:theReplacementView];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T11:41:11.213

尝试在 viewWillDisappear 方法中显式停止视频播放。

# c - “*=”在 C 编程中究竟是什么意思？

> ID：15456599
> 
> 赞同：0
> 
> 时间：2013-03-17T01:18:09.597
> 
> 标签：c, bitwise-operators

我一直在查看一些与 C 非常相似的 RobotC 代码（而且我没有足够的声誉来制作新的 RobotC 标签），并且遇到了 *= 运算符。我已经用谷歌搜索了很多，但我所能得到的只是它是 C 中的按位运算符。似乎没有人确切地说明它的作用，但是如果你们能提供帮助，我将不胜感激。

```
rot *= 5; 
```

这是我找到它的代码。该功能所做的只是将机器人重新定向为始终面向北方。

```
//Turns back to North
void TurnStraight(int cdegree) //cdegree is the sensor value read by the compass sensor
{
  int rot = cdegree % 360;
  int mot = 1;
  //stop when the NXT facing North
  if (cdegree == 0){
     return;
  }
  //reset the encoders value to avoid overflaow
   clear_motor_encoders();

   if (cdegree > 180 && cdegree < 360){
      rot = 360 - rot;
      mot = 0;
   }

   rot *= 5;  // ratio between the circumference of the tire to the circumference of the     rotation circle around itself
   switch (mot){
     case 1:
     moveTo(rot/2,1);
     break;
     case 0:
     moveTo(rot/2,-1);
     break;
     case -1:
     moveTo(rot,1);
     break;
   }
}

void clear_motor_encoders()
{
   nMotorEncoder[motorA] = 0;
}

void moveTo(int rot, int direction)
{
   nSyncedMotors = synchAC;
   nSyncedTurnRatio = -100;
   nMotorEncoderTarget[motorA] = rot;
   motor[motorA] = direction * 50;
   while (nMotorRunState[motorA] != runStateIdle) ;
   motor[motorA] = 0;

} 
```

这当然不是我的代码，我只是想知道它是如何工作的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T01:19:47.377

它相当于：

```
rot = rot * 5; 
```

它是称为“复合赋值”运算符的运算符家族的一部分。您可以在此处查看它们的完整列表：[复合赋值运算符（维基百科）](http://en.wikipedia.org/wiki/Operators_in_C_and_C++#Compound_assignment_operators)

请注意，这`*=`不是按位运算符，因为`*`不是。但是一些复合运算符是按位的 - 例如，`&=`运算符是按位的，因为`&`is。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:20:15.457

与大多数编程语言一样，这是`var = var * 5`.

所以其他例子`var += 3`等于一个陈述`var = var + 3`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-17T01:20:24.600

这是乘法赋值运算符。意思是一样的

```
rot = rot * 5; 
```

这不是位运算符，尽管有相同类型的位运算符：

*   `&=`- 并分配，
*   `|=`- 或分配，
*   `^=`- 异或分配。

该系列的其他运算符包括`+=`、`-=`、`/=`和`%=`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-17T01:25:10.233

如果你看懂代码

```
rot += 5; 
```

你应该明白

```
rot *= 5; 
```

不是将 5 添加到 rot，而是将其乘以 5。

# grails - 无法避免在 Grails 中具有多对多关系的 n+1 选择

> ID：15456600
> 
> 赞同：3
> 
> 时间：2013-03-17T01:18:12.527
> 
> 标签：grails, grails-orm, grails-2.0

我正在使用 Grails 创建一个玩具问答网站，以学习该平台。我有两个域，帖子和标签，它们之间有多对多的关系。我想打印带有标签的帖子列表。

我不能使用延迟获取，因为我会遇到 N+1 选择问题

我也不能使用急切获取，因为它使用左连接，我无法正确分页结果。

因此，我决定使用以下代码手动获取标签：

```
 static def getList(params) {

        ArrayList questions = Question.list(params)

        def questionMap = [:]
        questions.each {
            questionMap.put(it.id, it)
        }

        if(questions.size()>0) {
            Tag.executeQuery('SELECT q.id, t FROM Tag t JOIN t.questions q \
                                WHERE q.id in ( :list ) ', [ list:questions.collect{ it.id } ] ).each { questionMap.get(it[0]).tags.add(it[1]) }
        }

        return questions
} 
```

但是，当我在视图中打印标签时：

```
<g:each in="${questions}" var="question">
   ${question.title} 
   <g:each in="${question.tags}" var="tag">
      ${tag?.text}
   </g:each>
</g:each> 
```

无论如何都会为每个问题执行一个查询！这里推荐的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T02:50:24.533

您的代码的问题是您没有对`Tag`查询结果做任何事情。此外，为多对多关系设置连接类是一种更好的方法。例如，如果您看到 Spring Security Core 插件，您有`User`、`Role`和一个名为`UserRole`. [这](https://github.com/grails-plugins/grails-spring-security-core/blob/master/grails-app/domain/test/TestUserRole.groovy)是示例类。

所以我给你的建议是：

```
class Tag {
...
}

class Question{
...
}

class QuestionTag implements Serializable {
  Tag tag
  Question question
  static mapping = {
    id composite: ['tag','question']
    ...
  }
  //need to override equals and hashCode
} 
```

要存储标签的结果，您可以为您的类添加一个临时字段：

class Question { def tags static transients = ['tags'] //移除hasMany. }

您现在可以执行您的`HQL`，在问题列表中查找问题实例并设置`tags`属性。而且由于您使用的是不返回单个类的 HQL，因此结果不会映射为`Tag`对象，因此访问方式略有不同。

> 当查询选择单个字段或计算值时，HQL 查询可以返回域类实例或指定数据的数组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T05:30:40.653

你是说

> “我也不能使用 Eager fetching，因为它使用左连接，我无法正确分页结果。”

您可以使用 session.createFilter 对关联进行分页。

这个例子（版权 Burt Beckwith）来自Burt Beckwith 的“Chapter 5, Hibernate, session.createFilter”[一书中的 Programming Grails](http://shop.oreilly.com/product/0636920024750.do)

```
// example from Burt Beckwith's book "Programming Grails", (c) Burt Beckwith
class Branch {
    String name
    List visits
    static hasMany = [visits: Visit]

    List<Visit> getVisitsByPage(int pageSize, int pageNumber) {
        Branch.withSession { session ->
            session.createFilter(visits, '')
                    .setMaxResults(pageSize)
                    .setFirstResult(pageSize * pageNumber)
                    .list()
        }
    }
} 
```

我推荐买[这本书](http://shop.oreilly.com/product/0636920024750.do)

# java - 尝试测量插入在数据库中花费的时间

> ID：15456601
> 
> 赞同：0
> 
> 时间：2013-03-17T01:18:23.440
> 
> 标签：java, concurrenthashmap, sortedset, nanotime

我有一个`Multithreaded program`将插入到我的一个表中，并且我正在运行的程序是这样的-

> java -jar CannedTest.jar 100 10000

意思是：

*   线程数是`100`
*   任务数是`10000`

所以每个线程都会插入`10000 records`到我的表中。所以这意味着`total count (100 * 10000)`表中应该是`1,000,000`在程序完成执行之后。

作为我们的 LnP 测试的一部分，我正在尝试测量插入到我的表中的时间。我将所有这些数字存储在`ConcurrentHashMap`插入数据库所需的时间中，如下所示。

```
long start = System.nanoTime();

callableStatement[pos].executeUpdate(); // flush the records.

long end = System.nanoTime() - start;

final AtomicLong before = insertHistogram.putIfAbsent(end / 1000000L, new AtomicLong(1L));
if (before != null) {
    before.incrementAndGet();
} 
```

当所有线程完成执行所有任务时，我尝试通过对其进行`ConcurrentHashMap insertHistogram` 排序来打印出数字，我得到如下结果 -`Key``Milliseconds`

```
Milliseconds           Number
0                      2335
1                      62488
2                      60286
3                      54967
4                      52374
5                      93034
6                      123083
7                      179355
8                      118686
9                      87126
10                     42305
..                      ..
..                      ..
..                      .. 
```

而且，同样，`ConcurrentHashMap insertHistogram`我尝试制作如下所示的直方图。

```
17:46:06,112  INFO LoadTest:195 - Insert Histogram List:
17:46:06,112  INFO LoadTest:212 - 64823 came back between 1 and 2 ms
17:46:06,112  INFO LoadTest:212 - 115253 came back between 3 and 4 ms
17:46:06,112  INFO LoadTest:212 - 447846 came back between 5 and 8 ms
17:46:06,112  INFO LoadTest:212 - 330533 came back between 9 and 16 ms
17:46:06,112  INFO LoadTest:212 - 29188 came back between 17 and 32 ms
17:46:06,112  INFO LoadTest:212 - 6548 came back between 33 and 64 ms
17:46:06,112  INFO LoadTest:212 - 3821 came back between 65 and 128 ms
17:46:06,113  INFO LoadTest:212 - 1988 came back greater than 128 ms 
```

注意：- 我试图在其中插入记录的数据库，它`Memory Only`目前处于模式。

**问题陈述：-**

看看我上面的结果中的这个数字，它通过在键上排序打印出来 -

`0 2335`

我不确定它怎么可能`2335 calls`被插入`0 milliseconds`？而且我`System.nanotime`在测量刀片时也在使用。

以下是将打印出上述日志的代码 -

```
private static void logHistogramInfo() {

    int[] definition = { 0, 2, 4, 8, 16, 32, 64, 128 };
    long[] buckets = new long[definition.length];

    System.out.println("Milliseconds           Number");
    SortedSet<Long> keys = new TreeSet<Long>(Task.insertHistogram.keySet());
    for (long key : keys) { 
       AtomicLong value = Task.insertHistogram.get(key);
       System.out.println(key+ "                      " + value);
    }

    LOG.info("Insert Histogram List: ");
    for (Long time : Task.insertHistogram.keySet()) {
        for (int i = definition.length - 1; i >= 0; i--) {
            if (time >= definition[i]) {
                buckets[i] += Task.insertHistogram.get(time).get();
                break;
            }
        }
    }
    for (int i = 0; i < definition.length; i++) {
        String period = "";
        if (i == definition.length - 1) {
            period = "greater than " + definition[i] + " ms";
        } else {
            period = "between " + (definition[i] + 1) + " and " + definition[i + 1] + " ms";
        }
        LOG.info(buckets[i] + " came back " + period);
    }

} 
```

我不确定为什么`0`当我尝试通过在键上排序直接从 Map 打印值时显示毫秒。

但是`0 milliseconds`当我尝试将直方图制作成相同的`logHistogramInfo method`.

我在上述方法的计算过程中做错了什么吗？

# c++ - 二叉搜索树类 - 标识符“ItemType”未定义

> ID：15456606
> 
> 赞同：0
> 
> 时间：2013-03-17T01:19:03.470
> 
> 标签：c++, templates

我从我的数据结构教科书中复制了这段代码：

```
#pragma once // remove intellisense error

//  Created by Frank M. Carrano and Tim Henry.
//  Copyright (c) 2013 __Pearson Education__. All rights reserved.

// Listing 16-4.

/** Link-based implementation of the ADT binary search tree.
 @file BinarySearchTree.h */

#ifndef _BINARY_SEARCH_TREE
#define _BINARY_SEARCH_TREE

#include "BinaryTreeInterface.h"
#include "BinaryNode.h"
#include "BinaryNodeTree.h"
#include "NotFoundException.h"
#include "PrecondViolatedExcep.h"

template<class ItemType>
class BinarySearchTree : public BinaryNodeTree<ItemType>
{
private:
   BinaryNode<ItemType>* rootPtr;

protected:
   //------------------------------------------------------------
   // Protected Utility Methods Section:
   // Recursive helper methods for the public methods.
   //------------------------------------------------------------
   // Recursively finds where the given node should be placed and
   // inserts it in a leaf at that point.
   BinaryNode<ItemType>* insertInorder(BinaryNode<ItemType>* subTreePtr,
                                       BinaryNode<ItemType>* newNode);

   // Removes the given target value from the tree while maintaining a
   // binary search tree.
   BinaryNode<ItemType>* removeValue(BinaryNode<ItemType>* subTreePtr,
                                     const ItemType target,
                                     bool& success);

   // Removes a given node from a tree while maintaining a
   // binary search tree.
   BinaryNode<ItemType>* removeNode(BinaryNode<ItemType>* nodePtr);

   // Removes the leftmost node in the left subtree of the node
   // pointed to by nodePtr.
   // Sets inorderSuccessor to the value in this node.
   // Returns a pointer to the revised subtree.
   BinaryNode<ItemType>* removeLeftmostNode(BinaryNode<ItemType>* subTreePtr,
                                            ItemType& inorderSuccessor);

   // Returns a pointer to the node containing the given value,
   // or nullptr if not found.
   BinaryNode<ItemType>* findNode(BinaryNode<ItemType>* treePtr,
                                  const ItemType& target) const;

public:
   //------------------------------------------------------------
   // Constructor and Destructor Section.
   //------------------------------------------------------------
   BinarySearchTree();
   BinarySearchTree(const ItemType& rootItem);
   BinarySearchTree(const BinarySearchTree<ItemType>& tree);
   virtual ~BinarySearchTree();

   //------------------------------------------------------------
   // Public Methods Section.
   //------------------------------------------------------------
   bool isEmpty() const;
   int getHeight() const;
   int getNumberOfNodes() const;
   ItemType getRootData() const throw(PrecondViolatedExcep);
   void setRootData(const ItemType& newData) const
   throw(PrecondViolatedExcep);
   bool add(const ItemType& newEntry);
   bool remove(const ItemType& anEntry);
   void clear();
   ItemType getEntry(const ItemType& anEntry) const
   throw(NotFoundException);
   bool contains(const ItemType& anEntry) const;

   //------------------------------------------------------------
   // Public Traversals Section.
   //------------------------------------------------------------
   void preorderTraverse(void visit(ItemType&)) const;
   void inorderTraverse(void visit(ItemType&)) const;
   void postorderTraverse(void visit(ItemType&)) const;

   //------------------------------------------------------------
   // Overloaded Operator Section.
   //------------------------------------------------------------
   BinarySearchTree<ItemType>& operator=(const BinarySearchTree<ItemType>& rightHandSide);   
}; // end BinarySearchTree

#endif 
```

我收到了这个错误：在类的受保护部分中首次使用包括和超出它`identifier "ItemType" is undefined`的所有用途。`ItemType`私有部分的这一行没有错误：

```
BinaryNode<ItemType>* rootPtr; 
```

此外，它不喜欢 when`const`在成员函数上使用，给出错误“在非成员函数上不允许使用类型限定符。这里有什么问题？

标题：

```
#pragma once // removes intellisense error

//  Created by Frank M. Carrano and Tim Henry.
//  Copyright (c) 2013 __Pearson Education__. All rights reserved.

/** Listing 15-1.
 @file BinaryTreeInterface.h */

#ifndef _BINARY_TREE_INTERFACE
#define _BINARY_TREE_INTERFACE

template<class ItemType>
class BinaryTreeInterface
{
public:
   /** Tests whether this binary tree is empty.
    @return True if the binary tree is empty, or false if not. */
   virtual bool isEmpty() const = 0;

   /** Gets the height of this binary tree.
    @return The height of the binary tree. */
   virtual int getHeight() const = 0;

   /** Gets the number of nodes in this binary tree.
    @return The number of nodes in the binary tree. */
   virtual int getNumberOfNodes() const = 0;

   /** Gets the data that is in the root of this binary tree.
    @pre  The binary tree is not empty.
    @post  The root’s data has been returned, and the binary tree is unchanged.
    @return  The data in the root of the binary tree. */
   virtual ItemType getRootData() const = 0;

   /** Replaces the data item in the root of this binary tree
       with the given data, if the tree is not empty. However, if
       the tree is empty, inserts a new root node containing the
       given data into the tree.
    @pre  None.
    @post  The data in the root of the binary tree is as given.
    @param newData  The data for the root. */
   virtual void setRootData(const ItemType& newData) = 0;

   /** Adds a new node containing the given data to this binary tree.
    @param newData  The data for the new node.
    @post  The binary tree contains a new node.
    @return  True if the addition is successful, or false not. */
   virtual bool add(const ItemType& newData) = 0;

   /** Removes the node containing the given data item from this binary tree.
    @param data  The data value to remove from the binary tree.
    @return  True if the removal is successful, or false not. */
   virtual bool remove(const ItemType& data) = 0;

   /** Removes all nodes from this binary tree. */
   virtual void clear() = 0;

   /** Gets a specific entry in this binary tree.
    @post  The desired entry has been returned, and the binary tree
       is unchanged. If no such entry was found, an exception is thrown.
    @param anEntry  The entry to locate.
    @return  The entry in the binary tree that matches the given entry.
    @throw  NotFoundException if the given entry is not in the tree. */
   virtual ItemType getEntry(const ItemType& anEntry) const
                    throw(NotFoundException) = 0;

   /** Tests whether a given entry occurs in this binary tree.
    @post  The binary search tree is unchanged.
    @param anEntry  The entry to find.
    @return  True if the entry occurs in the tree, or false if not. */
   virtual bool contains(const ItemType& anEntry) const = 0;

   /** Traverses this binary tree in preorder (inorder, postorder) and
       calls the function visit once for each node.
    @param visit A client-defined function that performs an operation on
       or with the data in each visited node. */
   virtual void preorderTraverse(void visit(ItemType&)) const = 0;
   virtual void inorderTraverse(void visit(ItemType&)) const = 0;
   virtual void postorderTraverse(void visit(ItemType&)) const = 0;
}; // end BinaryTreeInterface
#endif 
```

-

```
#pragma once // removes intellisense error

//  Created by Frank M. Carrano and Tim Henry.
//  Copyright (c) 2013 __Pearson Education__. All rights reserved.

/** A class of nodes for a link-based binary tree.
 Listing 16-2.
 @file BinaryNode.h */

#ifndef _BINARY_NODE
#define _BINARY_NODE

template<class ItemType>
class BinaryNode
{   
private:
   ItemType              item;           // Data portion
   BinaryNode<ItemType>* leftChildPtr;   // Pointer to left child
   BinaryNode<ItemType>* rightChildPtr;  // Pointer to right child

public:
   BinaryNode();
   BinaryNode(const ItemType& anItem);
   BinaryNode(const ItemType& anItem,
              BinaryNode<ItemType>* leftPtr,
              BinaryNode<ItemType>* rightPtr);

   void setItem(const ItemType& anItem);
   ItemType getItem() const;

   bool isLeaf() const;

   BinaryNode<ItemType>* getLeftChildPtr() const;
   BinaryNode<ItemType>* getRightChildPtr() const;

   void setLeftChildPtr(BinaryNode<ItemType>* leftPtr);
   void setRightChildPtr(BinaryNode<ItemType>* rightPtr);            
}; // end BinaryNode

#endif 
```

-

```
#pragma once // removes intellisense error

//  Created by Frank M. Carrano and Tim Henry.
//  Copyright (c) 2013 __Pearson Education__. All rights reserved.

/** ADT binary tree: Link-based implementation.
 Listing 16-3.
 @file BinaryNodeTree.h */

#ifndef _BINARY_NODE_TREE
#define _BINARY_NODE_TREE

#include <iostream>

#include "BinaryTreeInterface.h"
#include "BinaryNode.h"
#include "PrecondViolatedExcep.h"
#include "NotFoundException.h"

template<class ItemType>
class BinaryNodeTree : public BinaryTreeInterface<ItemType>
{
private:
   BinaryNode<ItemType>* rootPtr;

protected:
   //------------------------------------------------------------
   // Protected Utility Methods Section:
   // Recursive helper methods for the public methods.
   //------------------------------------------------------------

   int getHeightHelper(BinaryNode<ItemType>* subTreePtr) const;
   int getNumberOfNodesHelper(BinaryNode<ItemType>* subTreePtr) const;

   // Recursively deletes all nodes from the tree.
   void destroyTree(BinaryNode<ItemType>* subTreePtr);

   // Recursively adds a new node to the tree in a left/right fashion to
   // keep the tree balanced.
   BinaryNode<ItemType>* balancedAdd(BinaryNode<ItemType>* subTreePtr,
                                     BinaryNode<ItemType>* newNodePtr);

   // Removes the target value from the tree by calling moveValuesUpTree
   // to overwrite value with value from child.
   BinaryNode<ItemType>* removeValue(BinaryNode<ItemType>* subTreePtr,
                                     const ItemType target, bool& success);

   // Copies values up the tree to overwrite value in current node until
   // a leaf is reached; the leaf is then removed, since its value is
   // stored in the parent.
   BinaryNode<ItemType>* moveValuesUpTree(BinaryNode<ItemType>* subTreePtr);

   // Recursively searches for target value in the tree by using a
   // preorder traversal.
   BinaryNode<ItemType>* findNode(BinaryNode<ItemType>* treePtr,
                                  const ItemType& target,
                                  bool& success) const;

   // Copies the tree rooted at treePtr and returns a pointer to
   // the copy.
   BinaryNode<ItemType>* copyTree(const BinaryNode<ItemType>* treePtr) const;

   // Recursive traversal helper methods:
   void preorder(void visit(ItemType&), BinaryNode<ItemType>* treePtr) const;
   void inorder(void visit(ItemType&), BinaryNode<ItemType>* treePtr) const;
   void postorder(void visit(ItemType&), BinaryNode<ItemType>* treePtr) const;

public:
   //------------------------------------------------------------
   // Constructor and Destructor Section.
   //------------------------------------------------------------
   BinaryNodeTree();
   BinaryNodeTree(const ItemType& rootItem);
   BinaryNodeTree(const ItemType& rootItem,
                  const BinaryNodeTree<ItemType>* leftTreePtr,
                  const BinaryNodeTree<ItemType>* rightTreePtr);
   BinaryNodeTree(const BinaryNodeTree<ItemType>& tree);
   virtual ~BinaryNodeTree();

   //------------------------------------------------------------
   // Public BinaryTreeInterface Methods Section.
   //------------------------------------------------------------
   bool isEmpty() const;
   int getHeight() const;
   int getNumberOfNodes() const;
   ItemType getRootData() const throw(PrecondViolatedExcep);
   void setRootData(const ItemType& newData);
   bool add(const ItemType& newData); // Adds a node
   bool remove(const ItemType& data); // Removes a node
   void clear();
   ItemType getEntry(const ItemType& anEntry) const throw(NotFoundException);
   bool contains(const ItemType& anEntry) const;

   //------------------------------------------------------------
   // Public Traversals Section.
   //------------------------------------------------------------
   void preorderTraverse(void visit(ItemType&)) const;
   void inorderTraverse(void visit(ItemType&)) const;
   void postorderTraverse(void visit(ItemType&)) const;

   //------------------------------------------------------------
   // Overloaded Operator Section.
   //------------------------------------------------------------
   BinaryNodeTree& operator=(const BinaryNodeTree& rightHandSide);
}; // end BinaryNodeTree

//  Created by Frank M. Carrano and Tim Henry.
//  Copyright (c) 2013 __Pearson Education__. All rights reserved.

// PARITALLY COMPLETE.

/** @file BinaryTree.cpp */

//////////////////////////////////////////////////////////////
//      Protected Utility Methods Section
//////////////////////////////////////////////////////////////

template<class ItemType>
int BinaryNodeTree<ItemType>::getHeightHelper(BinaryNode<ItemType>* subTreePtr) const
{
   if (subTreePtr == nullptr)
      return 0;
   else
      return 1 + max(getHeightHelper(subTreePtr->getLeftChildPtr()), 
                     getHeightHelper(subTreePtr->getRightChildPtr()));
}  // end getHeightHelper

template<class ItemType>
BinaryNode<ItemType>* BinaryNodeTree<ItemType>::balancedAdd(BinaryNode<ItemType>* subTreePtr,
                                                            BinaryNode<ItemType>* newNodePtr)
{
   if (subTreePtr == nullptr)
      return newNodePtr;
   else
   {
      BinaryNode<ItemType>* leftPtr = subTreePtr->getLeftChildPtr();
      BinaryNode<ItemType>* rightPtr = subTreePtr->getRightChildPtr();

      if (getHeightHelper(leftPtr) > getHeightHelper(rightPtr))
      {
         rightPtr = balancedAdd(rightPtr , newNodePtr);
         subTreePtr->setRightChildPtr(rightPtr );
      }
      else
      {
         leftPtr = balancedAdd(leftPtr, newNodePtr);
         subTreePtr->setLeftChildPtr(leftPtr);
      }  // end if

      return subTreePtr;
   }  // end if
}  // end balancedAdd

template<class ItemType>
BinaryNode<ItemType>* BinaryNodeTree<ItemType>::copyTree(const BinaryNode<ItemType>* treePtr) const
{
   BinaryNode<ItemType>* newTreePtr = nullptr;

   // Copy tree nodes during a preorder traversal
   if (treePtr != nullptr)
   {
      // Copy node
       newTreePtr = new BinaryNode<ItemType>(treePtr->getItem(), nullptr, nullptr);
       newTreePtr->setLeftChildPtr(copyTree(treePtr->getLeftChildPtr()));
      newTreePtr->setRightChildPtr(copyTree(treePtr->getRightChildPtr()));
   }  // end if

   return newTreePtr;
}  // end copyTree

template<class ItemType>
void BinaryNodeTree<ItemType>::destroyTree(BinaryNode<ItemType>* subTreePtr)
{
   if (subTreePtr != nullptr)
   {
      destroyTree(subTreePtr->getLeftChildPtr());
      destroyTree(subTreePtr->getRightChildPtr());
      delete subTreePtr;
   }  // end if
}  // end destroyTree

//////////////////////////////////////////////////////////////
//      Protected Tree Traversal Sub-Section
//////////////////////////////////////////////////////////////

template<class ItemType>
void BinaryNodeTree<ItemType>::inorder(void visit(ItemType&), BinaryNode<ItemType>* treePtr) const
{
   if (treePtr != nullptr)
   {
      inorder(visit, treePtr->getLeftChildPtr());
      ItemType theItem = treePtr->getItem();
      visit(theItem);
      inorder(visit, treePtr->getRightChildPtr());
   }  // end if
}  // end inorder

//////////////////////////////////////////////////////////////
//      PUBLIC METHODS BEGIN HERE
//////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////
//      Constructor and Destructor Section
//////////////////////////////////////////////////////////////

template<class ItemType>
BinaryNodeTree<ItemType>::BinaryNodeTree() : rootPtr(nullptr)
{
}  // end default constructor

template<class ItemType>
BinaryNodeTree<ItemType>::BinaryNodeTree(const ItemType& rootItem)
{
   rootPtr = new BinaryNode<ItemType>(rootItem, nullptr, nullptr);
}  // end constructor

template<class ItemType>
BinaryNodeTree<ItemType>::BinaryNodeTree(const ItemType& rootItem,
                                         const BinaryNodeTree<ItemType>* leftTreePtr,
                                         const BinaryNodeTree<ItemType>* rightTreePtr)
{
    rootPtr = new BinaryNode<ItemType>(rootItem, copyTree(leftTreePtr->rootPtr), 
                                                 copyTree(rightTreePtr->rootPtr));
}  // end constructor

template<class ItemType>
BinaryNodeTree<ItemType>::BinaryNodeTree(const BinaryNodeTree<ItemType>& treePtr)
{
   rootPtr = copyTree(treePtr.rootPtr);
}  // end copy constructor

template<class ItemType>
BinaryNodeTree<ItemType>::~BinaryNodeTree()
{
   destroyTree(rootPtr);
}  // end destructor

//////////////////////////////////////////////////////////////
//      Public BinaryTreeInterface Methods Section
//////////////////////////////////////////////////////////////

template<class ItemType>
bool BinaryNodeTree<ItemType>::add(const ItemType& newData)
{
   BinaryNode<ItemType>* newNodePtr = new BinaryNode<ItemType>(newData);
   rootPtr = balancedAdd(rootPtr, newNodePtr);
   return true;
}  // end add

}  // end contains

//////////////////////////////////////////////////////////////
//      Public Traversals Section
//////////////////////////////////////////////////////////////

template<class ItemType>
void BinaryNodeTree<ItemType>::inorderTraverse(void visit(ItemType&)) const
{
   inorder(visit, rootPtr);
}  // end inorderTraverse

#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:57:12.703

你有一个无关紧要`}`的结尾`BinaryTreeNode.h`。

另外，我建议您摆脱所有异常规范（所有看起来像`throw(type)`函数末尾的东西）。它们在 C++11 中被弃用，因为它们没有用。

# php - php是通过引用访问的数组元素吗？

> ID：15456609
> 
> 赞同：0
> 
> 时间：2013-03-17T01:19:25.753
> 
> 标签：php, arrays, pass-by-reference

问题的标题可能难以解释，以下是可能有帮助的代码

```
$containers = array(); // array of arrays
for ($index = 0; $index < 4; $index++) {
  $containers[] = array(); // each element of the array is an array
}

foreach ($objects as $object) {
  $index = computeIndex($object); // compute the index into the $containers
  $container = $containers[$index]; // get the subarray object
  $container[] = $object; // append $object to the end of the subarray
  $containers[$index] = $container; // <--- question: is this needed?
} 
```

所以正如问题所示，我还需要将子数组重新分配回数组吗？如果它是数组中元素的引用，那么我认为我不需要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:24:34.067

是的，需要最后一行；数组元素存储为值而不是引用。但是，PHP 将允许您使用以下命令创建引用[`&`](http://php.net/manual/en/language.references.php)：

```
$container = &$containers[$index];
$container[] = $object; 
```

您也可以为自己省点麻烦，只需执行以下操作：

```
$containers[$index][] = $object; 
```

# jquery - 如何获取 url 并添加为输入值

> ID：15456616
> 
> 赞同：0
> 
> 时间：2013-03-17T01:20:13.840
> 
> 标签：jquery, url

我试图找出一种方法来获取当前 url 并将其添加到输入字段。

我目前正在使用它，但它对我不起作用：

```
<script>
   $(document).ready(function(){
   $('input').val(window.location.hash);
   });
</script> 
```

我正在使用 jQuery 1.8 版

我实际上只是想获取根域和第一个子目录。因此，例如，如果此功能所在的域是 domain.com/sub/sub/sub 我希望它只获取 domain.com/sub

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:23:15.543

这样您就可以访问诸如 domain.com/something/index.html#hash 之类的 url 的哈希值

window.location 是您要查找的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T01:28:41.190

您可以使用`location.href`URL 并使用[`regular expression`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp) [`match`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)

```
var re = /:\/\/(.+?\/.+?)\//;
var parts = location.href.match(re);
$('input').val(parts[1]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T01:29:24.093

假设`window.location`是：（`http://stackoverflow.com/questions/15456616/how-to-get-url-and-add-as-an-input-value`实际上是这个页面），并且你想要第一个子目录（在这种情况下`questions`）：

```
 // on this page: 'http://'
var protocol = window.location.protocol + '//',
    // on this page: 'stackoverflow.com'
    domain = window.location.hostname,
    // on this page: 'questions'
    directory = window.location.pathname.substring(1).split('/').shift(),
    // 'http://stackoverflow.com/questions'
    url = protocol + domain + '/' + directory;
$('input').val(url); 
```

参考：

*   [`Array.shift()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/shift).
*   [`String.split()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split).
*   [`String.substring()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring).
*   [`window.location`](https://developer.mozilla.org/en-US/docs/DOM/window.location).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T01:30:06.613

我会使用`window.location.href`or `window.location`：

你可以在这里看到它工作正常：http: [//jsfiddle.net/hJKkY/1/](http://jsfiddle.net/hJKkY/1/)

```
 $(document).ready(function(){
   $('input').val(window.location.href);
   }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T01:25:41.010

[http://jsfiddle.net/39Sha/1](http://jsfiddle.net/39Sha/1)

```
$(document).ready(function () {
    $('input').val(window.location);
}); 
```

# fortran - FORTRAN 读取（）问题

> ID：15456625
> 
> 赞同：0
> 
> 时间：2013-03-17T01:21:48.913
> 
> 标签：fortran, readline, gfortran

嘿，所以我正在尝试学习 Fortran 基础知识，以便可以将它用于基础物理项目。我无法正确获取输入。我的代码是：

```
program main
  write(*, *) "Enter n:"
  read(*, *) n
  print *, "Number is ", n
end program main 
```

这很简单。除了当我编译并运行它时，在我输入看起来像这样的输入之前什么都不会发生

```
gfortran num.f90 -o num
./num
(nothing happens until I type) 3
Enter n:
Number is:    3 
```

我的内存分配有问题吗？或者它可能是我的编译器？老实说，我不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T07:06:40.737

你的程序很好，在我的机器上它会`Enter n:`在读取变量之前打印出来。如果您在输入值（并按 Enter）之前没有看到该消息，则可能与您使用的命令窗口的缓冲有关。为了检查这一点，你可以打开一个 xterminal（`xterm`在你的命令窗口中输入），然后在那里运行程序。

# matlab - 如何在 Matlab 中简单地连接具有不同字段的两个结构？

> ID：15456627
> 
> 赞同：2
> 
> 时间：2013-03-17T01:22:21.790
> 
> 标签：matlab, struct

有没有简单的方法来组合以下两种结构，而不使用 for 循环或 CELLFUN？

```
struct1 = 

    a: {43x1 cell}

struct2 = 

    b: [43x1 double]
    c: {43x1 cell} 
```

我想有这样的组合结构：

```
struct3 = 

    a: {43x1 cell}
    b: [43x1 double]
    c: {43x1 cell} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-17T12:11:30.083

[我通过 Matlab 中的另一个结构使用 update struct](https://stackoverflow.com/questions/15245167/update-struct-via-another-struct-in-matlab)中的建议得到了我想要的，如下所示：

```
names = [fieldnames(struct1); fieldnames(struct2)];
struct3 = cell2struct([struct2cell(struct1); struct2cell(struct2)], names, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T06:04:54.323

考虑[这篇文章和 Mathworks 的相关 MATLAB Exchange 脚本](http://www.mathworks.com/support/solutions/en/data/1-172VF/index.html?product=SL&solution=1-172VF)：

> **主题**：
> 
> 如何连接或合并两个结构？问题描述：
> 
> 我想将两个结构合并为一个包含两个原始结构的所有字段的新结构。如何在 MATLAB 中做到这一点？
> 
> **解决方案**：
> 
> MATLAB 中没有可用于连接结构的直接功能。
> 
> 附件 mergeStructs.m 显示了许多可用于在 MATLAB 中合并结构的方法。
> 
> 您还可以使用 MATLAB Central User Community 上的在线提交内容。一种这样的提交是：
> 
> [http://www.mathworks.com/matlabcentral/fileexchange/7842](http://www.mathworks.com/matlabcentral/fileexchange/7842)
> 
> 请注意，MathWorks 不保证或担保这些提交的使用或内容。任何问题、问题或投诉都应直接联系特约作者。

# ios - 调用drawRect在CALayer之上绘制？

> ID：15456631
> 
> 赞同：0
> 
> 时间：2013-03-17T01:23:03.510
> 
> 标签：ios, cocoa-touch, calayer

我目前有一个视图，它的 CALayer 作为 AVCapturePreviewLayer，从 iphone 的相机输出视频。我想调用 drawRect 并在此视频输出之上进行绘制，例如在屏幕上绘制一条简单的线，并在背景中使用当前的摄像机捕获。问题是 drawRect 中的所有内容都出现在 AVCapturePreviewLayer 后面而不是前面。有没有办法实现这个功能？最好不使用多个视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:06:56.097

向视图层添加子层：

```
[view.layer addSublayer:...]; 
```

然后在子图层上画出你想要的。

# ruby-on-rails - rails 检查完成 date_select 和 time_select 参数

> ID：15456635
> 
> 赞同：0
> 
> 时间：2013-03-17T01:23:24.840
> 
> 标签：ruby-on-rails

我有一个更新表单，我希望用户在其中更新日期。日期应该总是比数据库中当前的日期更新，所以我希望我的脚本在用户点击提交按钮后验证它。我已经走到了这一步：

```
<%= simple_form_for(calendar, :html => { :method => :put, :name => 'extend_link' }) do |f| %>

<p>Select the new date (must be newer than the current date): <%= f.date_select :end_at %> at <%= f.time_select :end_at, { :ignore_date => true } %></p>

<% end %> 
```

标准更新放在我的控制器中，更新日历模型

```
 def update
    @calendar = current_user.calendar.find(params[:id])

      respond_to do |format|
        if @calendar.update_attributes(params[:calendar])
          format.html { redirect_to calendar_path, notice: 'The end date was extended.' }
          format.json { head :no_content }
        end
      end

  end 
```

我在表单呈现后检查了源以了解日期和时间选择的工作原理，并且经过大量研究后，很明显日期在“合并”到我的模型和 end_at 之前被分成不同的部分柱子

```
calendar[end_at(3i)]
calendar[end_at(2i)]
.... 
```

但由于某种原因，提交表单后我无法访问完整的 params[:end_at]。但是，它必须是可访问的，否则模型怎么会被更新成一个整体呢？我疯了。

这很容易：

```
if params[:end_at] < @calendar.end_at
 puts "The new ending date is not after the current ending date."
else
 @calendar.update_attributes(params[:calendar])
end 
```

为什么它不起作用以及如何解决我的问题？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:16:15.877

您*可以*在控制器中执行此操作，但听起来这是一个模型验证，所以我把它放在那里。使用[ActiveModel::Dirty](http://api.rubyonrails.org/classes/ActiveModel/Dirty.html)的魔力来查找之前和之后的属性，可能是这样的：

```
class Calendar < ActiveRecord::base

  validate :date_moved_to_future

  private

  def date_moved_to_future
     self.errors.add(:end_at, "must be after the current end at") if self.end_at_changed? && self.end_at_was < self.end_at
  end
end 
```

# python - str.replace 问题

> ID：15456639
> 
> 赞同：1
> 
> 时间：2013-03-17T01:24:16.627
> 
> 标签：python, string

我正在尝试使以下代码正常工作，它应该从用户输入的文本字符串中删除元音。

```
def isVowel(text):
    if text in ("a", "e", "i", "o", "u", "A", "E", "I", "O", "U"):
        return True

def withoutVowels(text):
    for char in text:
        if(isVowel == True):
            text = text.replace(char, "")
    return text 
```

isVowel 函数工作正常，但是当我使用它时它似乎无法正确评估，这是为什么呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-17T01:26:13.510

```
if (isVowel == True): 
```

应该

```
if isVowel(char): 
```

`isVowel`是一个函数对象。`isVowel == True`永远是假的。

* * *

[请注意，您也可以使用str.translate](http://docs.python.org/2/library/string.html#string.translate)更快、更简单地执行此操作。

```
In [90]: 'Abracadabra'.translate(None, 'aeiouAEIOU')
Out[90]: 'brcdbr' 
```

或者，（正如 EOL 指出的那样）使用正则表达式：

```
In [93]: import re
In [95]: re.sub(r'(?i)[aeiou]', '', 'Abracadabra')
Out[95]: 'brcdbr' 
```

但是，`str.translate`在这种情况下更快：

```
In [94]: %timeit 'Abracadabra'.translate(None, 'aeiouAEIOU')
1000000 loops, best of 3: 316 ns per loop
In [96]: %timeit re.sub(r'(?i)[aeiou]', '', 'Abracadabra')
100000 loops, best of 3: 2.26 us per loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T06:06:45.690

您可以在一行中完成此操作，因为 Python 很棒：

```
def withoutVowels(text):
    return "".join(c for c in text if c not in "aeiouAEIOU") 
```

# java - 使用参数在android中发送json发布日期

> ID：15456642
> 
> 赞同：0
> 
> 时间：2013-03-17T01:24:48.333
> 
> 标签：java, android, post

我正在尝试使用 Android 发出 POST 请求，但没有成功。我认为问题在于如何设置 resquisição 和 Header 的参数。以下是我提出请求的方法...

```
public void testPostDate() {

    HttpClient client = new DefaultHttpClient();
    HttpConnectionParams.setConnectionTimeout(client.getParams(), 10000);
    HttpResponse response;

    Gson gson = new Gson();
    CrimePOST.Crime crime = new CrimePOST().new Crime(10, "São Paulo",
            "descrição", 10.00, 30.00);

    CrimePOST crimePost = new CrimePOST();
    crimePost.setCrime(crime);

    List<NameValuePair> params = new LinkedList<NameValuePair>();

    params.add(new BasicNameValuePair("token",
            "0V1AYFK12SeCZHYgXbNMew==$tRqPNplipDwtbD0vxWv6GPJIT6Yk5abwca3IJa6JhMs="));

    String json = gson.toJson(crimePost);

    String paramString = URLEncodedUtils.format(params, Utils.ENCODE);

    try {
        HttpPost post = new HttpPost(
                "http://safe-sea-4024.herokuapp.com/crimes/mobilecreate"
                        + "?" + paramString);

        post.setHeader("Content-Type", "application/json");

        StringEntity entitty = new StringEntity(json);
        entitty.setContentType(new BasicHeader(HTTP.CONTENT_TYPE,
                "application/json"));

        post.setEntity(entitty);
        response = client.execute(post);

        /* Checking response */
        if (response != null) {
            InputStream in = response.getEntity().getContent();
            String a = toString(in);
            System.out.println(a);
        }

    } catch (Exception e) {
        e.printStackTrace();
    }

} 
```

此方法负责将 inputStream 转换为 String

```
 private String toString(InputStream is) throws IOException {

    byte[] bytes = new byte[1024];
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    int lidos;
    while ((lidos = is.read(bytes)) > 0) {
        baos.write(bytes, 0, lidos);
    }
    return new String(baos.toByteArray());
} 
```

真的我正确地传递了标题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:31:58.050

您必须在 AsyncTask 中执行此操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T04:18:50.073

我在回来的时候写了这个教程。它确实通过 HTTP Post 将 json 数据发送到 url。看看这个。原帖可以在这里找到：[http ://androidhappenings.blogspot.com/2013/03/android-app-development-201-1st.html](http://androidhappenings.blogspot.com/2013/03/android-app-development-201-1st.html)

```
 import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.util.Timer;
import java.util.TimerTask;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;

public class MainActivity extends Activity implements LocationListener{
private TextView textView =null;
LocationManager locationManager=null;
Location location=null;
protected String url;
protected JSONObject jsonData=null;
private EditText urlText=null;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    locationManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    final boolean gpsEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
    if(gpsEnabled!=true) {
        Toast.makeText(getApplicationContext(), "GPS Disbled! Please Enable to Proceed!", Toast.LENGTH_SHORT).show();
        startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));
    } 

    textView = (TextView)findViewById(R.id.textView);
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 1, this);
    urlText = (EditText)findViewById(R.id.urlTextbox);
    Button submitButton = (Button)findViewById(R.id.submitUrl);

    submitButton.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            if (urlText.getText()!=null) {
            url=urlText.getText().toString();
            System.out.println(url);//for testing only, not required
            Toast.makeText(getApplicationContext(), "Url Submitted, Sending data to Web Service at url: " + url, Toast.LENGTH_SHORT).show();
        }
        }
    });

}

@Override
public void onLocationChanged(final Location location) {
    this.location=location;
     final Handler handler = new Handler();
      Timer ourtimer = new Timer();
      TimerTask timerTask = new TimerTask() {
          int cnt=1;    
          public void run() {
                      handler.post(new Runnable() {
                              public void run() {

                                Double latitude = location.getLatitude();
                                Double longitude = location.getLongitude();
                                Double altitude = location.getAltitude();
                                Float accuracy = location.getAccuracy();
                                textView.setText("Latitude: " + latitude + "\n" + "Longitude: " + longitude+ "\n" + "Altitude: " + altitude + "\n" + "Accuracy: " + accuracy + "meters"+"\n" + "Location Counter: " + cnt);
                            try {
                                jsonData = new JSONObject();
                                jsonData.put("Latitude", latitude);
                                jsonData.put("Longitude", longitude);
                                jsonData.put("Altitude", altitude);
                                jsonData.put("Accuracy", accuracy);

                                System.out.println(jsonData.toString());//not required, for testing only
                                if(url!=null) {
                                new HttpPostHandler().execute();
                                }
                            } catch (JSONException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }

                                cnt++;
                              }

                     });
              }};
          ourtimer.schedule(timerTask, 0, 120000);

}

@Override
public void onProviderDisabled(String provider) {

}

@Override
public void onProviderEnabled(String provider) {

}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {

}

public class HttpPostHandler extends AsyncTask<Void,Void,Void> {

@Override
protected Void doInBackground(Void... arg0) {

     HttpClient httpClient = new DefaultHttpClient();
     HttpPost httpPost = new HttpPost(url);
     StringEntity dataEntity = null;
    try {
        dataEntity = new StringEntity(jsonData.toString());
    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
     httpPost.setEntity(dataEntity);
     httpPost.setHeader("Content-Type", "application/json");
    try {
        httpClient.execute(httpPost);
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();

    }
    return null;

}

@Override
protected void onPostExecute(Void result) {
    // TODO Auto-generated method stub
    super.onPostExecute(result);
    try {
        this.finalize();
    } catch (Throwable e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

}

} 
```

# c# - 用单引号代替双引号

> ID：15456645
> 
> 赞同：13
> 
> 时间：2013-03-17T01:25:06.723
> 
> 标签：c#, replace

我在 c# 中有以下字符串：

```
string ptFirstName = tboxFirstName.Text; 
```

`ptFirstName`返回：`"John"`

我希望将其转换为`'John'`

我尝试了以下多种变体，但我永远无法用单引号替换双引号：

```
ptFirstName.Replace("\"", "'"); 
```

有人可以启发我吗？

我的目标是将其写入 XML 文件：

```
writer.WriteAttributeString("first",ptFirstName);   // where ptFirstName is 'John' in single quotes. 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-17T01:27:04.150

原因

```
ptFirstName.Replace("\"", "'"); 
```

行不通的是那`string`是不可变的。你需要使用

```
ptFirstName = ptFirstName.Replace("\"", "'"); 
```

反而。这是[关于 ideone 的演示](http://ideone.com/LbGQWe)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:30:14.333

我猜你没有`"John"`在文本框中输入，但是`John`当你设置断点并在 Visual Studio 中查看变量时，你会看到字符串周围的引号？

如果是这样，那么请意识到引号不是字符串的一部分，而只是向您表明该值是一个字符串。它们由调试器添加。如果你要这样做：

```
Console.WriteLine(ptFirstName); 
```

你不会看到引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T10:57:48.763

writer.QuoteChar = '\'';

有关详细信息，请参阅[http://msdn.microsoft.com/en-ca/library/system.xml.xmltextwriter.quotechar.aspx](http://msdn.microsoft.com/en-ca/library/system.xml.xmltextwriter.quotechar.aspx)。

# cocoa-touch - CorePlot setGridLinesRange 仅适用于 majorGridLine

> ID：15456654
> 
> 赞同：0
> 
> 时间：2013-03-17T01:26:53.340
> 
> 标签：cocoa-touch, core-plot

我已经将我的 majorGridLines 设置为：

```
[x setGridLinesRange:[CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(1.0f)
                                                       length:CPTDecimalFromFloat(201.0f)]]; 
```

现在我正试图弄清楚如何只为专业而不是为未成年人设置它。
有没有办法只影响专业？
因为我试图得到这样的网格：

```
 Y
   ^
4  |   |   |   |   |   |
3  |   |   |   |   |   |
2  |   |   |   |   |   |
1  |   |   |   |   |   |
0  | |   |   |   |   |
   ----------------------> X
   0   1   2   3   4   5 
```

谢谢你的帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T11:12:34.830

不，但您可以制作第二个 x 轴，仅绘制次要网格线。每个轴可以有不同的值`gridLinesRange`。

# ruby-on-rails - 设计令牌加密

> ID：15456660
> 
> 赞同：1
> 
> 时间：2013-03-17T01:27:56.367
> 
> 标签：ruby-on-rails, devise

我正在使用带有 Token Authenticatable 模块的设计。如果我查看存储在数据库中的数据，我会发现即使密码已加密，访问令牌也未加密。

这不是一个主要的安全问题吗，因为如果黑客掌握了数据库信息，他们将拥有原始的、功能齐全的访问令牌，类似于存储未散列的密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T16:45:07.993

安全性和便利性通常是相反的。**它不太安全，但有一些方法可以缓解这种情况**（当然会降低便利性）。您可以经常使令牌过期（使用`expire_auth_token_on_timeout`或定期重置所有令牌。

如果您的数据库受到损害，您将遇到更大的问题！密码通常由用户在服务之间共享，因此到目前为止，泄露的密码比泄露的 auth_token 更糟糕。

*为什么它们不加密？*

密码存储在用户的脑海中，生成 auth_tokens，它们必须存储在某个地方（客户端），以便提交并与加密的 auth_token 进行比较。每次用户使用其“正常”凭据登录时，都必须生成一个新令牌。

性能也可能是一个问题。BCrypt 很慢，对每个请求进行这种比较可能会出现问题。

* * *

*我在文档中或其中一位开发人员中找不到“官方”答案，因此提供的答案是基于我的经验和意见。*

# c# - 当我最大化我的应用程序时控制大小

> ID：15456661
> 
> 赞同：-1
> 
> 时间：2013-03-17T01:28:38.097
> 
> 标签：c#, wpf, user-interface

*   我正在为我的应用程序使用 C# WPF，并且我正在努力通过 UI 中的控件使我的应用程序变得简单（不拥挤）。
*   当我使用默认大小的窗口开始我的项目时，它看起来很漂亮，控件和面板周围有一个很好的空间，让眼睛舒服。
*   当我最大化我的应用程序以适应屏幕尺寸时，问题就开始了。控件和面板伸展得如此之大，变得如此之大以适应屏幕。
*   我尝试使用**最小宽度**和**最大宽度**属性，但是当我最大化时，我发现应用程序位于中心。在大小上，我在它周围明确而宽阔的空白空间。
*   我尝试使用标准尺寸**1024x768**，但遇到了同样的问题。应该用更多控件填充的空白空间。
*   如何使我的应用程序适合任何屏幕而不会出现那么多空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:33:47.253

你可以把很多包裹在一个`ViewBox`

例子：

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="WpfApplication13.MainWindow"
        Title="MainWindow" x:Name="UI" Width="459" Height="293"  >
    <Viewbox Stretch="Uniform">
        <Grid Width="1024" Height="768" >
            <All your content .....
        </Grid>
    </Viewbox>
</Window> 
```

# php - AWS S3 - 计划的文件清理 - 不同的方法

> ID：15456666
> 
> 赞同：4
> 
> 时间：2013-03-17T01:29:28.643
> 
> 标签：php, amazon-web-services, amazon-s3, cron

我正在为用户向 AWS S3 写入文件，一段时间后我想删除一些图像。（例如：如果文件有这个名称并且比 48 小时更早）

一种方法是让 PHP cron 作业从 EC2 运行以在需要时进行清理。

还有其他方法可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T03:22:13.150

是的，前提是您要过期的文件有一个共同的前缀（而不仅仅是它们名称中的某个字符串）。您可以为 S3 存储桶设置生命周期策略，并指定具有特定前缀的所有文件应在设定的时间长度内过期。S3 将为您删除所有匹配的文件。

前缀可以是空字符串，以使存储桶中的所有文件都过期。有效期必须是天数，我认为这不是非常精确。如果您说两天后到期，它们不会比这更早到期，但可能会持续超过 48 小时。

# ruby - Jekyll 没有列出帖子

> ID：15456670
> 
> 赞同：0
> 
> 时间：2013-03-17T01:30:16.327
> 
> 标签：ruby, jekyll

我似乎无法在 Jekyll 中获得一些非常基本的 ruby​​。我有一个超简单的循环来从 /_posts 内部获取我的帖子：

```
 <ul>
        {% for post in site.posts %}
            <li>
            <a href="{{ post.url }}">
                {{ post.title }}
            </a>
            </li>
        {% endfor %}
</ul> 
```

_posts 中的帖子被称为

```
2013-03-16-how-i-do.md
2012-01-01-hello-world.md 
```

在 _config.yml 中，我设置了`permalink: pretty`.

奇怪的是，它似乎根本没有遍历那个循环——如果我在循环内添加一些文本，甚至在 li 之前，它根本不会显示。

我目前正在使用 ruby​​-2.0.0-p0 — 是否有任何可能导致此问题的语法更改？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T13:05:08.687

首先，你打电话`{{ content }}`是为了让 Jekyll 知道在哪里运行查询？

如果你是那么这就是我如何称呼我的帖子

```
{% for post in site.posts limit: 10 %}  

  <a href="{{post.url}}">{{ post.title }}   

  {{ post.date | date:"%B %d, %Y" }}

 {% endfor %} 
```

# python - 如何创建脚本以访问电子邮件并在浏览器中显示

> ID：15456671
> 
> 赞同：0
> 
> 时间：2013-03-17T01:30:39.973
> 
> 标签：python, email, email-verification

我正在尝试创建一个 Python 脚本，允许我使用我的密码和用户名登录我的电子邮件，然后打开一个使用该信息登录的浏览器，这样我就不需要输入我的信息。到目前为止，这就是我所拥有的：

```
os.system("start chrome.exe http://www.yahoomail.com") 
```

这允许我启动 chrome 到那个显然只是打开它并且不会自动让我登录的 url。所以我想知道我怎样才能让它打开浏览器并自动登录我的电子邮件？
感谢回答的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:44:51.543

看看[Selenium](https://pypi.python.org/pypi/selenium)，这正是你要找的。作为一个选项，您可以使用一些无头兄弟，`PhantomJS`或者您可以使用`PyQt4 (Webkit)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T01:59:11.837

[urllib2](http://docs.python.org/2/library/urllib2.html)库似乎能够处理登录（有时还需要像[cookielib](http://docs.python.org/2/library/cookielib.html)这样的 cookie 管理器的帮助。）问题是每个电子邮件服务都会有所不同，您必须深入研究源代码该页面（在 Firefox 和 Google Chrome 等多种浏览器中为 Ctrl+U）来查找它用于各种变量的名称。这个问题的答案应该为如何解决[这个问题提供一个好主意。](https://stackoverflow.com/questions/13925983/login-to-website-using-urllib2-python-2-7)

# sql - SQL如何显示某个日期之前的数据

> ID：15456676
> 
> 赞同：10
> 
> 时间：2013-03-17T01:32:26.130
> 
> 标签：sql, date

我有几张桌子。一个是显示工人代码、名字和姓氏 的**工人表。****显示工人代码、工作开始日期**、结束日期和工作区域代码的工作日期。 **主管**有工人编号、名字、姓氏和工作区号。 **工作区域**有工作区域代码名称和主管。

我正在尝试做的是在 10/09/10 日期之前显示工作代码由于我是新手，因此在创建数据库之前，我试图先将所有这些都写下来并进行理论分析。

这听起来对吗？我不太确定日期的事情。

```
select worker
From Job Dates
where job start < '10/09/10' 
```

理论上这听起来对我来说是正确的，但它是否需要以某种方式告诉查询它是一个日期戳？

如果工人在 2010 年 10 月 9 日之前开始工作，我想找到工人的姓氏和他们的主管的姓氏？我猜这将是一个JOIN？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-17T01:36:45.007

你在正确的轨道上。在不知道数据库架构的情况下，您的最终查询将如下所示：

```
select w.surname, s.surname
From worker w INNER JOIN JobDatesTable jdt on w.id = jdt.id
              INNER JOIN SuperVisor s on w.id = s.id
where jdt.jobstart < '20101009' 
```

# php - 将图像转换为 pdfs 服务器端

> ID：15456677
> 
> 赞同：0
> 
> 时间：2013-03-17T01:32:29.607
> 
> 标签：php, pdf, pdf-generation, type-conversion

我目前正在开展一个项目，涉及将表单结果转换为可下载的 PDF，这很简单。但是，最近有人要求我添加附件功能。我正在使用 dompdf 将表单结果转换为 PDF，但是有没有办法将附件（可以是 jpg、png、doc/x 或 pdf）单独转换为 PDF 文件，然后将附件文件附加到 dompdf输出？

我可以处理实施；有没有免费的图书馆可以支持这样的东西？我找到了[FPDF](http://www.fpdf.org/)，它支持图像，但不支持 Word 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:42:57.533

首先，你需要为你需要的每一种转换找到一个库（你提到了 jpg、png 和 doc/x，但你没有说这就是全部。）

对于常见的办公格式，您可以启动 OpenOffice 或 LibreOffice 的无头（意味着它可以在没有图形显示的服务器上运行）实例。然后你可以通过各种编程语言与它进行交互，或者你可以使用现成的命令行工具，例如[pyodconverter](https://github.com/mirkonasato/pyodconverter)，要求它在各种文件格式之间进行转换。这是将 doc 和 docx 文件转换为 pdf 的最佳方式，顺便说一下，不用花钱购买 Microsoft 软件。

至于“附加附件”，我认为您的意思是将一堆PDF文件连接在一起，您可以使用免费工具[pdftk](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)。

# c++ - 快速排序错误：变量周围的堆栈已损坏？

> ID：15456682
> 
> 赞同：1
> 
> 时间：2013-03-17T01:33:55.367
> 
> 标签：c++, quicksort, corruption

我正在为类实现快速排序功能。我们必须按照她在课堂上用她的伪代码教我们的方式来做，否则我们不会得到学分。

我收到一个*运行时错误*，显示“***变量 'quickArray' 周围的堆栈已损坏***”

我玩了调试器，但仍然无法弄清楚问题所在。我认为这与我的 Partition() 函数有关，但我不确定。任何人都可以帮忙吗？Iv 在下面发布了 main()、QuickSort() 和 Partition() 函数。

```
int main()
{

int quickArray[10] = { 5 ,99, 32, 4, 1, 12, 15 , 8, 13, 55};
int P = quickArray[0];
int R =quickArray[9];

QuickSort(quickArray,P,R);
return 0;

} 
```

..................................................... …………………………………………………………………………………………………………………………………………

```
void QuickSort(int ar2[],int P, int R)
{
int Q;

if( P < R )
{
    Q =  Partition(ar2,P,R);
    QuickSort(ar2,P,Q-1);
    QuickSort(ar2,Q+1,R);
}

} 
```

..................................................... .........................................................

```
int Partition(int ar2[],int P, int R)
{
int x = ar2[R];
int i = P-1;
int temp;

for(int j = P; j <= R-1; j++)
{
    if( ar2[j] < x  )
    {
        i = i +1;
        temp = ar2[i];
        ar2[i] = ar2[j];
        ar2[j] = temp;
    }

    temp = ar2[R];
    ar2[R] = ar2[i+1];
    ar2[i+1] = temp;
}

return (i+1);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:39:31.807

您将错误的索引传递给 QuickSort 函数：

```
int P = quickArray[0];
int R =quickArray[9]; 
```

P 和 R 是数组索引，在这种情况下应该是 0 和 9，但是，你将第一个元素和最后一个元素作为索引传递给 QuickSort，55 (quickArray[9]) 超出了 quickArray 的索引范围，所以你得到了错误。

顺便说一句：最好使用描述性变量名称，P 和 R 在这种情况下不能很好地表达它们的含义。您可以使用 left、right 和 pivot 来分别替换 R、R 和 Q，如快速排序算法中所述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:42:16.340

您传递的是数组的实际元素而不是索引，调试它的一种快速方法是`cout`在顶部，`QuickSort`如下所示：

```
void QuickSort(int ar2[],int P, int R)
{
   std::cout << "P: " << P << " R: " << R << std::endl ;
   ... 
```

以及通话`cout`后`Partition`：

```
 Q =  Partition(ar2,P,R);

  std::cout << "QS: Q= " << Q << std::endl ; 
```

`QuickSort`解决方法是这样调用`main`：

```
 QuickSort(quickArray,0,9); 
```

从长远来看，花一些时间使用调试器将帮助您更快地发现这些错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T01:41:53.210

这

```
int P = quickArray[0];
int R = quickArray[9];

QuickSort(quickArray,P,R); 
```

应该是这样的：

```
int arrStartIndex = 0;
int arrEndIndex   = 9;

QuickSort(quickArray, arrStartIndex , arrEndIndex); 
```

正如其他人所指出的，您的代码应该使用更具描述性的名称。

# c - unsigned short 与 unsigned int - 有时它们是相同的范围？

> ID：15456687
> 
> 赞同：12
> 
> 时间：2013-03-17T01:35:00.743
> 
> 标签：c, types, int, short

`unsigned short`和有什么区别`unsigned int`？我发现那`unsigned short`是`0-65,535`和`unsigned int`是`0-65,535`或`0-4,294,967,295`。我不太了解其中的区别。如何知道架构中数据类型的大小？如果例如`c = (unsigned short) d;`when`c`是 an`unsigned short`并且 d 是 an `unsigned int`; 那什么意识？的前 16 位`d`分配给`c`?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T01:39:12.803

`short`您真的在问和之间有什么区别`int`。答案是`short`可能更窄，但也可能与 相同宽度`int`。这几乎就是我们所知道的一切，与平台无关。很多平台都有 32-bit`int`和 16-bit `short`，但不是全部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T01:42:32.187

这是解释 C 数据类型历史的有用链接：

[http://en.wikipedia.org/wiki/C_data_types](http://en.wikipedia.org/wiki/C_data_types)

因此，您的数据类型的大小取决于平台，但如果您的 int 长度为 32 位，那么它将能够表示 2^32 个不同数字之一（如果无符号，则为 0 - 4,294,967,295）。同样，如果您的 short 长度为 16 位，则它可以表示 2^16 个不同数字之一（如果无符号，则为 0 - 65,535）。

此链接为您提供 Visual Studio 2005 的实现详细信息，其中 int 大小为 32 位（4 个字节），short 大小为 16 位（2 个字节）：

[http://msdn.microsoft.com/en-us/library/s3f49ktz(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/s3f49ktz(v=vs.80).aspx)

您的确切实现将取决于您的编译器。

至于问题的最后一部分，是的，如果您尝试将大于 short 最大值的 int 转换为 short ，那么您最终会得到一个不同的值（可能是前 16 位，但您应该进行测试以确保） .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T01:57:15.957

我们不能说变量类型名称（short、int、long、double 等）必须指向所有微处理器架构或编程语言中的特定位长度。它主要取决于微处理器的体系结构，当然还有编程语言的定义。一般来说，有符号/无符号短应该（我希望）有符号/无符号整数的一半位大小。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-17T01:47:55.140

首先，您必须了解 unsigned int 和 short 是什么。

一切都被分解成碎片。

short 是 16 位，每个位是 1 或 0。为简单起见，我将使用 4 位进行演示

```
1000 - Unsigned = 8 
1000 - Signed = -8 
1111 - Unsigned = 15 which is equal to 2^(# of bits) -1
1111 - Signed = -1 
```

请注意，对于无符号数，数字的范围更大，我们可以使 1111 = 15。

但是对于有符号数，最大可能性是 0111 = 7。

现在一个 short 有 16 位，给它

```
signed range of  −32,768 to 32,767  [−(2^15) to 2^15 − 1]
Unsigned range: 0 to 65,53  = 2^16 -1 
```

一个 Int 有 32 位，给出一个范围

```
Signed:−2,147,483,648 to 2,147,483,647 = −(2^31) to 2^31 − 1
Unsigned:  0 to 4,294,967,295 = 2^16 -1 
```

# c++ - 将光照世界空间坐标转换为眼睛空间坐标

> ID：15456688
> 
> 赞同：2
> 
> 时间：2013-03-17T01:35:07.887
> 
> 标签：c++, glsl

我正在尝试在场景中为聚光灯建模，以介绍图形类。作业指定我必须在modernGL 中做所有事情，因此我不能使用遗留的任何东西。

我一直在阅读 OpenGL 4.0 Shading Language Cookbook 以寻求帮助，但我不知道如何获取我的灯光的眼空间坐标。我知道我希望灯光在世界空间中的位置和方向，并且我尝试通过以下方式将它们转换为眼睛空间。

```
//mv = inverse(mv);
vec3 light = vec3(vec4(0.0, 15.0, 0.0, 1.0) * mv);
vec3 direction = vec3(vec4(0.0, -1.0, 0.0, 1.0) * mv); 
```

其中 mv 是我的模型视图矩阵由

```
glm::mat4 modelview_matrix = glm::lookAt(glm::vec3(window.camera.x, window.camera.y, window.camera.z), glm::vec3(0.0f, 0.0f, 0.0f), glm::vec3(0.0f, 1.0f, 0.0f)); 
```

没有任何变换。如您所见，我试图乘以模型视图和模型视图的倒数来获得眼睛空间。我很肯定这些都没有起作用，因为当我移动到对象的另一侧时，我的对象上的镜面高光随之而来。（即，如果我正在看物体的另一侧，我不应该看到高光。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T01:52:51.333

我相当肯定你想要：

```
vec3 light = vec3(mv * vec4(0.0, 15.0, 0.0, 1.0));
vec3 direction = vec3(mv * vec4(0.0, -1.0, 0.0, 0.0));
                                             // ^ Note the 0 in the w coordinate 
```

你*没有*反转你的`mv`矩阵。是的，乘法的顺序确实很重要。将 a 留`0`在`w`坐标中的原因是您不希望方向矢量被平移，而只是缩放或旋转。

# windows-7 - 在 Windows 7 上安装 Python 27 时出现问题 - 无法将 Python 添加到 PYTHON PATH

> ID：15456689
> 
> 赞同：2
> 
> 时间：2013-03-17T01:35:23.980
> 
> 标签：windows-7, python-2.7, installation

我使用二进制文件（第一个链接）在我的 Windows 7 计算机上安装了[Python 2.7.3 。](http://www.python.org/download/)安装后，IDLE 工作，但没有其他识别 Python。例如，在命令提示符下键入 python 会返回消息“'Python 不被识别为内部或外部命令、可运行程序或浴文件”。

在[这篇文章之后](https://stackoverflow.com/questions/3701646/how-to-add-to-the-pythonpath-in-windows-7)，我确保 python 2.7 在 PYTHONPATH 环境变量中。然而，这并没有帮助。

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T10:35:52.757

`PYTHONPATH`Python 本身使用系统变量来查找已安装包的目录。

`PATH`操作系统（尤其是 Windows）使用系统变量来查找可以打开某些文件（如`*.py`脚本）的可执行文件。

因此，您需要将带有 python.exe 的目录（例如`C:\Python27`）添加到`PATH`系统（或用户）变量而不是`PYTHONPATH`. 它可以按照您在同一工具窗口中找到的链接中描述的相同方式完成。

例如在我的机器上`PATH`系统变量设置为`C:\Python27;C:\MinGW\bin;...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-11T14:29:19.850

就像 Vladimir 评论的那样，要[在 windows 中设置 python](http://www.anthonydebarros.com/2011/10/15/setting-up-python-in-windows-7/)，您需要将 python.exe 所在的目录（例如`C:\Python27`）添加到**PATH**

您可以通过查看 echo 的输出来**确认python 是否在您的环境变量中**`%path%`

请记住，使用控制面板编辑 PATH 变量后，您必须**打开一个新终端**，因为该设置不会在现有终端中更新。

另一种可能性是您向 PATH 变量添加了错误的路径。验证它。

底线是，如果你的 python.exe 的目录真的在 PATH 中，那么运行 python 真的可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-09T03:31:07.933

以下是您的步骤：

右键单击**计算机**并选择**属性**。

在对话框中，选择**高级系统设置**。

在下一个对话框中，选择**Environment Variables**。在**用户变量**部分，编辑`PATH`语句以包含以下内容：

```
C:\Python27;C:\Python27\Lib\site-packages\;C:\Python27\Scripts\; 
```

Now, you can open a command prompt (`Start Menu|Accessorie`s or `Start Menu|Run|cmd`) and type:

```
C:\> python 
```

That will load the Python interpreter!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-01T10:38:04.977

You can install for single user rather than choosing the option of "Install for all users". I was facing the same issue, but when I tried installing just for myself, I was able to install successfully.

# ajax - jQuery ajax加载方法卡在加载中

> ID：15456694
> 
> 赞同：-2
> 
> 时间：2013-03-17T01:36:07.167
> 
> 标签：ajax, jquery

我搜索了整个网站，但找不到任何对我有帮助的东西，所以这里是：

我有这个 html 文件，当您单击 Get extern 时，它应该将 extern.html 中的内容放入名为 content 的 div 中，但是当您单击链接时，它会显示加载，仅此而已。

![在此处输入图像描述](../Images/51f1d58bc8b1951bb2389920f3eb0b2c.png)

test.html 文件

```
<script type="text/javascript" src="jquery-1.9.1.js"></script>
<script type="text/javascript"><!--
$(document).ready(function() {
  // select all the links with class="lnk", when one of them is clicked, get its "href" value
  // adds a "loading..." notification, load the content from that URL and
  // place only the paragraph which is in the #cnt into the tag with id="content"
  $('a.lnk').click(function() {
    var url = $(this).attr('href');
    $('#content').html('<h4>Loading...</h4>').load(url+ ' #cnt p');
    return false;
  });
});
--></script>
</head>
<body>
<h1>Web page test.html</h1>
<a href="extern.html" title="Get extern" class="lnk">Get extern</a>
<div id="content">Initial content in test.html</div> 
```

extern.html 文件

```
<h2>Content in extern.html</h2>
<div id="cnt"><p>Some text content in extern.html</p></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:44:58.693

我的猜测是您尝试加载外部网页，但它被浏览器中的同源策略阻止。如果没有，有一个快速的方法来调试它。

1) 我最喜欢的是使用 Chrome 开发者面板（按 F12 打开）。转到网络选项卡并尝试通过您的 jQuery 加载外部页面。然后您可以观察网络活动，看看是否出现任何错误。

2) 用户 $.ajax 而不是 $.load。有关更多选项，请参见此处：[$.ajax 实用程序中的 JQuery 错误选项](https://stackoverflow.com/questions/95600/jquery-error-option-in-ajax-utility)

如果问题确实是相同的域策略，请查看 jQuery 的 JSONP 功能。一个例子在这里：[http ://www.jquery4u.com/json/jsonp-examples/](http://www.jquery4u.com/json/jsonp-examples/)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T01:51:55.517

通常，当脚本未成功执行或发生某些逻辑/语法错误时，会出现此**“正在加载” 。**我假设你用 firebug 验证了你的脚本，我建议你用**$.noConfllict();** 如果您的页面有多个脚本块和库相互冲突。

# jquery - jQuery UI 嵌套可排序列表

> ID：15456696
> 
> 赞同：8
> 
> 时间：2013-03-17T01:36:52.900
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jquery-ui-draggable, jquery-ui-droppable

我正在编写一个脚本来轻松地使用 jQuery UI 对嵌套列表进行排序。它工作得很好，但是有一个我无法删除的小“错误”。

使用 jsfiddle ( [http://jsfiddle.net/fewTp/](http://jsfiddle.net/fewTp/) ) 和下面的说明来看看发生了什么:)

如果您将子点拖得更深一层（将“submenu2”向右拖一点并将其放下，因此它更深一层），然后再次尝试将其拖回，则会发生“错误”。如您所见，在您将“submenu2”稍微向左拖动的那一刻，“submenu1”会向下跳。

如果您不喜欢 jsfiddle，这是我为您准备的代码：

HTML：

```
 <ul>
    <li>
        <span><p>menu 1</p>
            <ul>
                <li>
                    <span><p>submenu 1</p>
                        <ul></ul>
                    </span> 
                </li>
                <li>
                    <span><p>submenu 2</p>
                        <ul></ul>
                    </span> 
                </li>
            </ul>
        </span>
    </li>
    <li>
        <span><p>menu 2</p>
            <ul>
                <li>
                    <span><p>submenu 1</p>
                        <ul></ul>
                    </span> 
                </li>
                <li>
                    <span><p>submenu 2</p>
                        <ul></ul>
                    </span> 
                </li>
            </ul>
        </span>
    </li>
</ul> 
```

CSS：

```
 * {
    font-family: Arial;
}
span {
    cursor: move;
    display: inline-block;
    margin: 0 10px 10px 10px;
   /* margin-bottom: -62px;*/
}
p {
    margin: 0;
    border-radius: 5px;
    border: 1px solid #793D00;
    padding: 10px;
    height: 20px;
    width: 180px;
}
.highlighter {
    text-align: center;
    cursor: move;
    border-radius: 5px;
    width: 200px;
    height: 40px;
    display: inline-block;
    margin: 0px 10px 14px 10px;
    padding: 0;
    border: 1px dashed #000;
    background:#FFFF91;
}
ul {
    float: left;
    list-style-type: none;
}
li {
    position: relative;
    /*z-index: 6;*/
}
ul li {
    float: left;
    display: block;
    padding: 0 40px;
}
li ul {
    float: none;
    margin: 0;
}
ul li ul li {
    float: none;
    margin: 0;
    padding: 0px;
}
li ul.ui-sortable {
    min-height: 60px;
    /*border: 1px solid #f00;*/
    position: relative;
    /*z-index: 5;*/
    margin-top: 10px;
    margin-left: 40px;
    padding: 10px 0 0 0;
}
.ui-sortable-helper {
    padding: 0;
    margin: 0 10px 10px 10px;
}
ul.no-child {
    margin-bottom: -73px;   
} 
```

JavaScript：

```
 $('ul').disableSelection().sortable({
    connectWith: "ul",
    tolerance: "pointer",
    cursorAt: {
        left: 40,
        top: 20
    },
    cursor: "move",
    opacity: 0.5,
    placeholder: "highlighter",
    helper: "clone",
    revert: 200,
    start: function(e, ui) { 
        if(ui.item.parent().hasClass("children-1")){
            ui.item.parent("ul").removeClass("child").addClass("no-child");
        }
    },
    stop: function(e, ui) { 
        mkUl();
    }
});

function mkUl(){ 
    $("ul").each(function(){
        $(this).removeAttr("class");

        var ulLevel = $(this).parents('ul').length+1;
        $(this).addClass("ui-sortable no-child level_"+ulLevel);
        var childC = $(this).children("li").size(); 
        $(this).has("li").removeClass("no-child").addClass("child children-"+childC);

        $(this).children("li:first").addClass("first");
        $(this).children("li:last").addClass("last");
    }); 
}

$(document).ready(function(){
    mkUl();
}); 
```

# c# - 自动化已经打开的 Word 文档 -> 另存为

> ID：15456698
> 
> 赞同：0
> 
> 时间：2013-03-17T01:37:12.590
> 
> 标签：c#, filemaker, word-automation

是否可以对已在 Word 中打开的文档自动执行另存为过程？我在 FileMaker 数据库和 Word 文档之间使用 OLE 链接。文档被触发从 FileMaker 中打开，但现在我需要编写一个小片段 (C#) 来自动执行另存为过程并关闭 Word。这是可能的还是必须由自动化脚本打开自动化正在使用的文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T05:09:59.313

是的，但这取决于您要达到的目标。

我对 Word 的 normal.dot 文件做了类似的事情，在每个打开的 Word 文档（学生下载工作文件）上自动运行一个宏，这样他们就“被迫”将他们的工作保存到他们正确的工作文件夹中。否则，默认值始终是 Window 的临时文件夹。正如您所了解的，如果您不另存为并处理文档，您会将所有工作保存在文件的临时副本上，当您注销时，整个文件都会丢失！

如果这与您所追求的相似，请执行以下操作：

[1] 打开 Word 作为一个空文档（即：打开 Word 应用程序而没有实际的 Word 文件） [2] 按 ALT-F11 打开 Visual Basic for App (VBA) [3] 展开 NORMAL 文件夹（它可能叫什么否则），但我们需要将此宏保存到默认的 DOT 文件中。[4] 双击“ThisDocument” [5] 应该会打开一个文档宏窗口 [6] 粘贴以下代码：

```
Private Sub Document_Open()
  MsgBox "Make sure you do a FILE -> SAVE-AS before starting your work!", vbCritical + vbOKOnly, "WARNING!"
End Sub 
```

[7] 关闭 Word 并确保更新 NORMAL.DOT 文件

下次您打开 Word 文档时，系统会自动要求您确保在继续之前保存您的工作。

当然，在您的情况下，当您退出 word 文档时，您需要一个类似的宏来启动，以确保它是另存为。

在那种情况下，使用这样的东西......

```
ActiveDocument.SAVEAS FileName:= _
    "<YOUR NETWORK OR FOLDER>myfile.docx", FileFormat:= _
    wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
    :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
    :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
    SaveAsAOCELetter:=False 
```

并将其放在 Document_Close() 或 AutoClose() 事件中。我会让你决定哪一个是合适的。

# javascript - 如何修改正则表达式以解析 YouTube URL 中的参数

> ID：15456699
> 
> 赞同：1
> 
> 时间：2013-03-17T01:37:34.417
> 
> 标签：javascript, regex, parsing, url, youtube

我有这个正则表达式：

```
/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/; 
```

它将从 YouTube URL 解析视频 ID，例如

> [http://www.youtube.com/watch?v=6ciG_6Y3rD0&feature=youtu.be&t=6m40s](http://www.youtube.com/watch?v=6ciG_6Y3rD0&feature=youtu.be&t=6m40s)

或者

> [http://youtu.be/6ciG_6Y3rD0?t=6m40s](http://youtu.be/6ciG_6Y3rD0?t=6m40s)

我想修改它，以便它也解析**t**参数。

有什么想法吗？

谢谢，豪伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T02:39:57.717

捕获 YouTube 视频 ID（以及时间搜索参数（`t`如果存在））

正则表达式：

```
^(?:https?\:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v\=))([\w-]{10,12})(?:[\&\?\#].*?)*?(?:[\&\?\#]t=([\dhm]+s))?$ 
```

演示在这里： http: [//fiddle.re/w1nn6](http://fiddle.re/w1nn6)

PS：您会注意到我改进了您原来的 RegEx 以安全地验证 YouTube 链接

# javascript - 如何确定尚未在页面上显示的 div 的高度

> ID：15456701
> 
> 赞同：0
> 
> 时间：2013-03-17T01:38:09.517
> 
> 标签：javascript, layout, twitter-bootstrap

我正在使用 twitter 模式显示的 div 中使用 twitter bootstrap v2.2.2 API 的选项卡功能（同样，引导程序的 v2.2.2）。问题是，当我这样做时，模式对话框会随着选项卡的变化而改变形状和大小。

我一直在尝试通过询问这些选项卡窗格并将外部 div 设置为窗格遇到的最大大小和宽度来设置包装选项卡窗格的 div 的大小。问题是，无论我做什么，我似乎总是无法确定这些窗格的大小（我假设是因为它们尚未显示？）。

我的布局（大致）...

```
<div id="ClientEditPanel" class="modal hide" role="dialog">

  <div class="modal-header">
    <h3>Client details</h3>
  </div>

  <div class="modal-body form-horizontal">

    <ul class="nav nav-tabs">
      <li><a class="active" data-toggle="tab" href="#ClientEditPanel_Tab_Personal">Personal</a></li>
      <li><a href="#ClientEditPanel_Tab_Profile" data-toggle="tab">Profile</a></li>
      <li><a href="#ClientEditPanel_Tab_Other" data-toggle="tab">Other</a></li>
    </ul>

    <div id="ClientEditPanel_Tabs" class="tab-content">
      <div id="ClientEditPanel_Tab_Personal" class="tab-pane active">
        ...
      </div>
      <div id="ClientEditPanel_Tab_Profile" class="tab-pane">
        ...
      </div>
      <div id="ClientEditPanel_Tab_Other" class="tab-pane">
        ...
      </div>
    </div>

  </div>

  <div class="modal-footer form-actions">
    <input type="submit" class="btn btn-primary" />
  </div>

</div> 
```

以下 CSS 进一步支持了这一点...

```
.tab-content {
  overflow: auto;
}

.tab-content > .tab-pane, {
  display: none;
}

.tab-content > .active, {
  display: block;
} 
```

我正在尝试按如下方式获取窗格...

```
$.each($(".tab-pane"), function () {
  ...
}); 
```

*从理论上讲*，它应该就像将父 div 的宽度设置为最宽子的宽度并将父 div 的高度设置为最高子的高度一样简单。我想测量 ClientEditPanel_Tab_Personal、ClientEditPanel_Tab_Profile 和 ClientEditPanel_Tab_Other 并在 ClientEditPanel_Tabs 上设置最大值。

通过调试，我可以确认我的选择器带回了正确的元素“this”清楚地代表了我第一次通过迭代器时的第一个选项卡。不过，在确定了这一点后，我询问的 div 的任何属性始终为 null 或零。我已经尝试过“this”的以下属性......

*   客户身高
*   客户端宽度
*   滚动高度
*   滚动宽度
*   内部高度
*   内宽
*   外高
*   外宽
*   样式.高度
*   样式.pixelHeight
*   偏移高度

可能还有一些我没有列出的。

有没有人有任何进一步的想法可以实现我正在寻找的东西。我确信它可以完成，因为我知道 JQuery.dialog 可以自动调整对话框的大小（包括与 JQuery.tabs 组合时），但是我现在使用 twitter 引导程序太远了，无法更改。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:54:55.820

在元素以 HTML 呈现之前，不会设置元素的高度和宽度属性。您可以将容器推离页面，渲染内容，进行一些调整，然后将内容移回屏幕。根据我的个人经验，我只会渲染输出，然后在准备好文档（jQuery）时对页面进行调整。这应该发生得非常快，只要元素的数量相当少，我就没有注意到任何不利影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:10:44.933

You can't read dimensions unless it is in DOM. As @Kalpers suggested, render it outside viewport (e.g. append to `<body>` and have `position:absolute; top: -9999px` or append anywhere else but add `visibility:hidden`, then get element dimensions.

# python - Google API 和 Python 的复杂 Excel 问题

> ID：15456709
> 
> 赞同：0
> 
> 时间：2013-03-17T01:39:58.693
> 
> 标签：python, excel, google-drive-api

所以我知道如何从 Google Drive 以 .csv 格式下载 Excel 文件。但是，由于 .csv 文件不支持多张工作表，我在 for 循环中开发了一个系统，以将“&grid=tab_number”添加到文件下载 url，以便我可以将每张工作表下载为自己的 .csv 文件。我遇到的问题是找出 Google Drive 上的 excel 工作簿中有多少张工作表，所以我知道设置 for 循环的次数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:45:51.217

最后只是用 xlrd 下载并使用它。感谢您的链接罗布。

# python-2.7 - Python 27 - BeautifulSoup 和表格

> ID：15456711
> 
> 赞同：1
> 
> 时间：2013-03-17T01:40:20.260
> 
> 标签：python-2.7, web-scraping, beautifulsoup, html-table

我有这个来源：

```
<tr id="bitstampUSD">
<td class="arrow" change="up" latest_trade="1363480722">
  <span class="down">▼&lt;/span>
</td>

<td class="symbol">
    <nobr>
    <a href="/markets/bitstampUSD.html">bitstampUSD</a>
    </nobr>
    <span class="sub">USD (SEPA converted)</span>
</td>
<td>46.74
    <span class="sub">41 min ago</span>
</td>
<td class="minichart break">
  <span volume="**whole heaps of number here that I want**"
  print="**more numbers I want**"
  avg="**more numbers I want**"
  class="marketsparkline"></span>
</td>
<td>**36.39**

  <span class="sub change">**10.35 28.46%**</span>

</td>
<td>**141,043.10**
    <span class="sub">**5,132,052.22 USD**</span>
</td>
<td>**25.25**
    <span class="sub">**46.58** (24h)</span>
</td>
<td>**49.17**
    <span class="sub">47 (24h)</span>
</td>
<td class="break">**46.7**</td>
<td>**46.74**</td>
<td class="break">**46.78**

  <span class="sub change">-0.04 -0.09%</span>

</td>
<td>**819.54**
    <span class="sub">**38,340.96** USD</span>
</td>
      </tr> 
```

所以我想以粗体显示数据。（嗯，它应该是粗体，我猜代码标签阻止了这种情况的发生。两个星号内的数据。

我设法弄清楚如何获取我在这里没有包含的代码中的位，因为它在类中。但是在这里，有些是课外的，所以我不知道如何抓住它。

[如果您想要http://bitcoincharts.com/markets/](http://bitcoincharts.com/markets/)，查看整个源代码可能会有所帮助。 它的布局与我以前见过的其他表格代码不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T14:28:17.933

好吧，这比你要求的多一点，但应该让你开始：

```
soup = BeautifulSoup(f)
for td in soup.find_all('td', class_='minichart break'):
    avg = td.span['avg']
    print_ = td.span['print']
    volume = td.span['volume']
    print avg, print_, volume

for td in soup.find_all('td'):
    print 'TD', td.text.split() 
```

在你的例子中，我得到：

```
**more numbers I want** **more numbers I want** **whole heaps of number here that I want**                                                                                                                                                                                         
[u'\u25bc']                                                                                                                                                                                                                                                                        
[u'bitstampUSD', u'USD', u'(SEPA', u'converted)']                                                                                                                                                                                                                                  
[u'46.74', u'41', u'min', u'ago']                                                                                                                                                                                                                                                  
[]                                                                                                                                                                                                                                                                                 
[u'**36.39**', u'**10.35', u'28.46%**']                                                                                                                                                                                                                                            
[u'**141,043.10**', u'**5,132,052.22', u'USD**']                                                                                                                                                                                                                                   
[u'**25.25**', u'**46.58**', u'(24h)']                                                                                                                                                                                                                                             
[u'**49.17**', u'47', u'(24h)']                                                                                                                                                                                                                                                    
[u'**46.7**']                                                                                                                                                                                                                                                                      
[u'**46.74**']                                                                                                                                                                                                                                                                     
[u'**46.78**', u'-0.04', u'-0.09%']                                                                                                                                                                                                                                                
[u'**819.54**', u'**38,340.96**', u'USD'] 
```

# html - 如何使元素适合填充窗口的右侧？

> ID：15456712
> 
> 赞同：2
> 
> 时间：2013-03-17T01:40:37.563
> 
> 标签：html, css

我有以下html页面：

```
<body>
  <div id="div1"></div>
  <div id="div2"></div>
</body> 
```

CSS是这样的：

```
#div1{
  width: 160px;
  height: 160px;
  top: 0;
  left 0;
  position: absolute;
}

#div2{
  width: auto;
  height: 160px;
  top 0;
  left: 160px;
  position: absolute;
} 
```

`div2`在调整窗口大小时，如何进行拉伸以填充窗口的右侧部分。这意味着 的宽度`div1`将始终为**160px**，但 的宽度`div2`将适合窗口的其余部分。`auto`如果`div2`.

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:46:41.200

添加`right:0`到您的`#div2`样式中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T01:50:05.833

元素`position: absolute`在文档流之外，因此不能“换行”在`width`.

使用`float`和`margin`：

```
#div1{
  width: 160px;
  height: 160px;
  float: left;
}

#div2{
  margin-left: 160px;
  height: 160px;
} 
```

演示：http: [//jsfiddle.net/6nFDS/](http://jsfiddle.net/6nFDS/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T01:45:53.650

好吧，我不太确定这是否是您想要的，但您可以使用`width: 100%;`：

```
width: 100%; 
```

[**演示**](http://jsfiddle.net/NcdqM/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T01:49:03.627

你可以在这里找到完整的 CSS 布局教程：http: [//learnlayout.com/](http://learnlayout.com/)

您可以使用 ：

```
 display:inline-block 
```

# ruby-on-rails - 从 Rails 2.3.5 升级到 3.2 时：ActionController::Base:Class (NoMethodError) 的未定义方法 `protected_instance_variables=`

> ID：15456713
> 
> 赞同：0
> 
> 时间：2013-03-17T01:40:52.690
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我一直在按照一些指南将一个相当重的系统从 Rails 2.3.5 升级到 Rails 3.2.17。虽然升级到 Rails 后我遇到的大多数问题都是关于升级 ActiveRecord 调用，或者安装或升级 Gem，但当我运行“ **bundle exec rails s** ”来启动服务器时，我完全被以下堆栈跟踪所困扰：

```
$ bundle exec rails s
=> Booting Thin
=> Rails 3.2.12 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/actionpack-3.2.12/lib/action_controller/metal/compatibility.rb:22:in `block in <module:Compatibility>': undefined method `protected_instance_variables=' for ActionController::Base:Class (NoMethodError)
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/concern.rb:119:in `class_eval'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/concern.rb:119:in `append_features'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/actionpack-3.2.12/lib/action_controller/base.rb:231:in `include'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/actionpack-3.2.12/lib/action_controller/base.rb:231:in `<class:Base>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/actionpack-3.2.12/lib/action_controller/base.rb:171:in `<module:ActionController>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/actionpack-3.2.12/lib/action_controller/base.rb:3:in `<top (required)>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/airbrake-3.1.8/lib/airbrake/railtie.rb:48:in `block in <class:Railtie>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/lazy_load_hooks.rb:34:in `call'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/lazy_load_hooks.rb:34:in `execute_hook'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/lazy_load_hooks.rb:43:in `block in run_load_hooks'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/lazy_load_hooks.rb:42:in `each'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/lazy_load_hooks.rb:42:in `run_load_hooks'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/application/finisher.rb:59:in `block in <module:Finisher>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/initializable.rb:30:in `instance_exec'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/initializable.rb:30:in `run'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/initializable.rb:55:in `block in run_initializers'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/initializable.rb:54:in `each'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/initializable.rb:54:in `run_initializers'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/application.rb:136:in `initialize!'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/railtie/configurable.rb:30:in `method_missing'
  from /Users/vdp/Sites/DDQ/config/environment.rb:5:in `<top (required)>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/dependencies.rb:251:in `require'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/dependencies.rb:251:in `block in require'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/dependencies.rb:236:in `load_dependency'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/activesupport-3.2.12/lib/active_support/dependencies.rb:251:in `require'
  from /Users/vdp/Sites/DDQ/config.ru:3:in `block in <main>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize'
  from /Users/vdp/Sites/DDQ/config.ru:in `new'
  from /Users/vdp/Sites/DDQ/config.ru:in `<main>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/builder.rb:40:in `eval'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/builder.rb:40:in `parse_file'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/server.rb:200:in `app'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/commands/server.rb:46:in `app'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/server.rb:304:in `wrapped_app'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/rack-1.4.5/lib/rack/server.rb:254:in `start'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/commands/server.rb:70:in `start'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/commands.rb:55:in `block in <top (required)>'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/commands.rb:50:in `tap'
  from /Users/vdp/.rvm/gems/ruby-1.9.3-p392@DDQ/gems/railties-3.2.12/lib/rails/commands.rb:50:in `<top (required)>'
  from script/rails:6:in `require'
  from script/rails:6:in `<main>' 
```

由于我真的不确定是什么导致了错误，我不确定我应该提供哪些其他输出。任何帮助将不胜感激。[编辑：我已按要求附上了 config.ru 和 environment.rb]。

配置.ru：

```
# This file is used by Rack-based servers to start the application.

require ::File.expand_path('../config/environment',  __FILE__)
run DDQ::Application 
```

环境.rb

```
# Load the rails application
require File.expand_path('../application', __FILE__)

# Initialize the rails application
DDQ::Application.initialize! 
```

应用程序.rb：

```
require File.expand_path('../boot', __FILE__)

require 'rails/all'

if defined?(Bundler)
  Bundler.require(*Rails.groups(:assets => %w(development test)))
end

module DDQ
  class Application < Rails::Application

    config.encoding = "utf-8"
    config.filter_parameters += [:password]
    config.active_support.escape_html_entities_in_json = true
    config.active_record.whitelist_attributes = true
    config.assets.enabled = false
    config.assets.version = '1.0'
    %w(middleware sweepers).each do |dir|
      config.autoload_paths << Rails.root.join('app', dir)
    end

    secret_file = Rails.root.join("secret")
    if File.exist?(secret_file)
      secret = File.read(secret_file)
    else
      secret = ActiveSupport::SecureRandom.hex(64)
      File.open(secret_file, 'w') { |f| f.write(secret) }
    end
    config.action_controller.session = {
      :key => '_instant_DDQ_session2',
      :secret      => secret
    }

    ENV['INLINEDIR']="/tmp/ruby.#{ENV['USER']}" unless ENV['OS'] =~ /Windows/

    GIGYA_CONFIG = YAML.load_file(Rails.root.join('config','gigya.yml'))[Rails.env.to_s]

    if defined?(PhusionPassenger)
      PhusionPassenger.on_event(:starting_worker_process) do |forked|
        Rails.cache.clear if forked
      end
    end

  end
end 
```

宝石文件：

```
source 'https://rubygems.org'
gem 'rails', '3.2.12'
gem 'mysql2'

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'
gem 'activemerchant'
gem 'rdiscount'
gem 'calendar_helper'
gem 'devise'
gem 'geokit-rails3'
gem 'will_paginate'
gem 'uuid'
gem 'airbrake'
gem 'paperclip'
gem 'fast_xs'
gem 'thin'
gem 'posix-spawn'

group :test do
  gem 'test-unit'
  gem 'cucumber-rails'
  gem 'capybara'
  gem 'rspec'
  gem 'rspec-rails'
  gem 'database_cleaner'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T07:22:37.353

尝试更新您的宝石

```
bundle update 
```

# c++ - 使用 Cygwin GCC 在 Windows 上编译 tesseract

> ID：15456714
> 
> 赞同：2
> 
> 时间：2013-03-17T01:41:10.907
> 
> 标签：c++, tesseract

使用 Cygwin GCC 在 Windows 上编译 tesseract 源时出现以下错误：

> -MT“training/commontraining.d”-o“training/commontraining.o”“../training/commontraining.cpp”../training/commontraining.cpp:17:30：致命错误：**base/init_google.h**：没有这样的文件或目录

请帮我找出哪个库提供了`init_google.h`头文件。

# ios - 从另一个类重新加载核心数据表视图

> ID：15456717
> 
> 赞同：2
> 
> 时间：2013-03-17T01:41:38.563
> 
> 标签：ios, objective-c, xcode, uitableview, core-data

我正在尝试刷新使用视图控制器（视图控制器 1）上的核心数据的表视图上的数据。用于将值保存到核心数据中的保存按钮 (UIButton) 位于不同的视图控制器 (View Controller 2) 上。

它们同时在 iPad 上的同一屏幕上，但通过使用容器视图具有单独的类（头文件和主文件）。当我单击视图控制器 1 上的保存按钮时，它不会刷新视图控制器 2 上的表视图。

但是，我知道这不是将数据保存到 Core Data 的方式，因为当我刷新应用程序时，新单元格会像预期的那样在表格视图中弹出。我尝试了以下方法来尝试让表格视图刷新但没有运气：

```
// ViewController1.m (Save Button)

- (IBAction)saveMethod {

    //Core Data Save Method Goes Here (Irrelevant)

    [self.managedObjectContext save:nil];

    //ViewController2 has the table view
    ViewController2 *trackingView = [[ViewController2 alloc] init];

    trackingView.managedObjectContext = self.managedObjectContext;
    [trackingView setupFetchedResultsController];
    [trackingView.view setNeedsDisplay];
    [trackingView.table reloadData];
} 
```

我似乎无法弄清楚如何告诉这个表视图从不同的视图控制器刷新自己。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T02:13:33.757

您不需要像现在这样重新创建视图控制器。

当`NSManagedObjectContext`完成保存操作时，它会发布一个通知。您可以让任何对象注册来接收这些通知。如果重新设置的委托`fetchedResultsController`不是一个选项，请考虑这一点（即已经设置为委托，并且继续充当委托`ViewController1`是有意义的）。`ViewController1`

`ViewController2`将需要对处理数据的托管对象上下文的引用，因此您需要创建一个属性并适当地设置它（`@property NSManagedObjectContext *moc`）。

然后，`viewDidLoad`它可以[注册通知](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html)：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(handleNotification:)
                                             name:NSManagedObjectContextDidSaveNotification
                                           object:self.moc]; 
```

`ViewController2`必须定义一个方法`handleNotification:`：

```
-(void)handleNotification:(NSNotification*)notification {
    if ( [notification.name isEqual:NSManagedObjectContextDidSaveNotification] && [notification.object isEqual:self.moc] ) {
        [self.tableView reloadData];
    }
} 
```

关于这种方法的几点说明：

1.  当您查看控制器已被关闭时，请确保调用`[[NSNotificationCenter defaultCenter] removeObserver:self]`. 通知中心保留观察员（我发现了一次困难的方法）。
2.  Always include the managed object context when registering for notifications, you don't want be responding to every save notification.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:02:20.607

`ViewController2`当您的目标是您已经必须刷新的实例时，您可能不想创建一个新实例。事实上，你的问题是在`ViewController2`，而不是在这里。

确保`ViewController2`设置为其获取结果控制器的委托，然后从获取结果控制器委托回调中更新您的表视图。并确保两个视图控制器都在查看相同的托管对象上下文。

# c# - Socket 发送方法... 一种方法可以发送大量数据吗？

> ID：15456719
> 
> 赞同：1
> 
> 时间：2013-03-17T01:41:58.153
> 
> 标签：c#, performance, networking, data-loss

我只是想知道这样做是否会导致任何问题，例如数据丢失或带宽变慢。我可能正在发送 256KB 的数据，我想知道是否应该将其拆分为更小的块并单独发送，或者我是否可以一次完成所有操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T01:47:41.463

通常，在应用程序级别，您不必担心这一点。低级软件和网络硬件将比您根据网络设置、链接速度、协议帧/数据包大小等将数据分成适当大小的块做得更好。

如果有的话，试图将您的数据拆分成更小的块，并且弄错了，将迫使网络层生成*更多更*小的块，并通过额外的标头和开销浪费带宽。

如果您的应用程序对性能非常非常敏感，那么您可以采取一些措施来缓解它，但它们是非常不成熟的优化——如果您确实遇到这些问题，请处理这些问题。

# java - Spring MVC 页面 HTTP 状态 400 和不正确的 URL

> ID：15456724
> 
> 赞同：1
> 
> 时间：2013-03-17T01:43:09.997
> 
> 标签：java, spring, spring-mvc, url-routing

我在使用该应用程序时遇到了一些问题。我有一个注册表单，它从控制器发布到另一个页面，此页面显示来自注册表单的查询结果。在结果页面上，我选择了一条记录，它会将我的数据返回到注册页面。用户应该能够在返回记录后更新记录或再次执行查询。

我遇到的问题是，当用户在注册表单上执行查询时，他们会发布到结果页面，结果页面会显示，但 url 不会改变。注册 url 是`http://localhost:8084/crimeTrack/citizen_registration.htm` 通过单击查询按钮发布到结果页面时，当在结果页面（有几条记录）上单击/选择一条记录时，该 url 仍然`http://localhost:8084/crimeTrack/citizen_registration.htm` 是用户被发布回具有所选记录的注册页面和它显示给用户现在再次执行更新或查询，网址是`http://localhost:8084/crimeTrack/getCitizen/1985121244.htm` ，用户现在在注册页面上。

如果我再次单击查询/更新，我会收到**HTTP 400 错误**并且 url 正在读取`http://localhost:8084/crimeTrack/getCitizen/citizen_registration.htm/` ，这不是控制器中的有效 URL 映射。我认为 url 应该 `http://localhost:8084/crimeTrack/citizen_registration.htm`是请求注册页面的时候。我不确定结果页面中的 POST 何时将用户带回注册页面是 url 应该是 `http://localhost:8084/crimeTrack/getCitizen/1985121244.htm` 附加号码是公民号码。下面是我的代码，我不确定我是否正确地执行了这些调用，我想解释我得到的结果以及遇到的问题的解决方案；

页面使用**jquery**提交：

这是注册页面的示例，所有其他页面都遵循相同的模式

**脚本**

```
function submitPage(){   

    document.getElementById("citizenRegistration").action="citizen_registration.htm";
    //document.getElementById("citizenRegistration").target="_self";    
    document.getElementById("citizenRegistration").method = "POST";
    document.getElementById("citizenRegistration").submit();

} 
```

**公民注册.jsp**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html lang="en">

    <head>  

    <title>Citizen Registration</title>

</head> 
    <body>              
            <div id="tab1" class="divGroup">
                <form:form id="citizenRegistration" name ="citizenRegistration" commandName="citizens">
                    ........................
                        <div class="buttons">   
                            <ol>
                                <li><input class="button" id="save" type="submit" name= "user_request" value="Save"/>
                                    <input class="button" id="update" type="submit" name= "user_request" value="Update"/>
                                    <input class="button" id="query" type="submit" name= "user_request" value="Query"/>
                                </li>       

                </form:form>
            </div>          
    </body>
</html> 
```

**公民列表.jsp**

```
<!DOCTYPE html>
<html lang="en">

<head>

   <script type="text/javascript">

   function submitPage(socialSecurityNumber){    

        document.getElementById("citizenList").action="getCitizen/1985121244.htm";//harded coded for testing
        //document.getElementById("citizenList").target="_self";    
        document.getElementById("citizenList").method = "POST";
        document.getElementById("citizenList").submit();

    }

 function GetCitizenTypeDescription(citizenTypeId){                 
        $.ajax({
        type:'GET',
        url:'getCitizenTypeDescription.htm',
        data:{citizenTypeId:citizenTypeId},
        dataType: 'text',       

        success: function (data) {      
        $('.citizenTypeId').each(function(i){               
                if($(this).val() === citizenTypeId){
                    //finds parent div
                    var parent = $(this).parent();
                    //search for child element wit class name citizenTypeDesc
                    var thisCitizenTypeDesc = parent.children('.citizenTypeDesc');                  
                    thisCitizenTypeDesc.text(data);
                }  
        });
    }

    });

}    
    <title>Citizen Search Results</title>

</head>
<body>
<form:form id="citizenList" name ="citizenList">
<div id ="content">
<c:forEach items="${citizens}" var="citizen">
<div id="table">    
    <div>
        <p><canvas class="canvas" height="240" width="320"></canvas>
    </div>
        <label class="citizenTypeDesc"></label></br>

        <a class="socialSecurityNumber" href="${citizen.socialSecurityNumber}">${citizen.fName}  ${citizen.lName}</a> 
        <input type="hidden" id="photo" value="${citizen.photo}" class="photos"/>
        <input type="hidden" id="socialSecurityNumber" value="${citizen.socialSecurityNumber}" />
        <input type="hidden" class="citizenTypeId" value="${citizen.citizenTypeId}"/>

</div>
</c:forEach>
</div>
</form:form>
</body>
</html> 
```

**CitizenRegistrationController.java**

```
@Controller
public class CitizenRegistrationController {

    private final Logger logger = Logger.getLogger(getClass()); 

    @Autowired
    private CitizenTypeManager citizenTypeManager;
    ............

    Map<String, Object> myCitizenType    = new HashMap<String, Object>();
    .......

    @InitBinder("citizens") 
    protected void initBinder(WebDataBinder binder){        

        //removes white spaces 
        binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));

        //formats date 
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");

        //By passing true this will convert empty strings to null
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));
        dateFormat.setLenient(false);

      //binder.setValidator(new OfficerRegistrationValidation());
      binder.setValidator(citizenRegistrationValidation);

      binder.registerCustomEditor(Integer.class,new CustomIntEditor());

    }

    @RequestMapping(value="citizen_registration.htm", method = RequestMethod.GET)
    public ModelAndView loadPage(@ModelAttribute Citizens citizen, 
                                 BindingResult result,
                                 ModelMap m,
                                 Model model,
                                 HttpServletRequest request,
                                 HttpServletResponse response) throws Exception {

        try{
             logger.debug("In Http method for CitizenRegistrationController");       

             myCitizenType.put("citizenTypeList",       this.citizenTypeManager.getCitizenType());
             myGender.put("genderList",                 this.genderManager.getGenderList());             
             ......

            return new ModelAndView("citizen_registration");

        }catch(Exception e){

            logger.error("Exception in CitizenRegistrationController - ModelAndView loadPage "+e);
            request.setAttribute("error",e.getMessage());
            return new ModelAndView("error_page");  

        }   

    }

    @RequestMapping(value="citizen_registration.htm", method = RequestMethod.POST)
    public ModelAndView handleRequest(@Valid @ModelAttribute Citizens citizen, 
                                        BindingResult result,
                                        ModelMap m,
                                        Model model,
                                        @RequestParam(value="user_request") String user_request) throws Exception {

        try{
             logger.debug("In Http method for CitizenRegistrationController - Punishment Registration");
             logger.debug("User Request Is " + user_request);

                 if(result.hasErrors()){

                     logger.debug("Has Errors");
                    return new ModelAndView("citizen_registration");
                 }else{

                     //check if its a save of an update

                     if(user_request.equals("Save")){

                         citizenManager.RegisterCitizen(citizen);   
                         model.addAttribute("icon","ui-icon ui-icon-circle-check");
                         model.addAttribute("results","Record Was Saved");
                         return new ModelAndView("citizen_registration");

                     }else if (user_request.equals("Query")){
                         logger.debug("about to preform query");
                         //citizenManager.getListOfCitizens(citizen);
                         if(citizenManager.getListOfCitizens(citizen).isEmpty()){

                             model.addAttribute("icon","ui-icon ui-icon-circle-close");
                             model.addAttribute("results","Notice: Query Caused No Records To Be Retrived!");                            

                         }else{
                             model.addAttribute("citizens",citizenManager.getListOfCitizens(citizen));
                             return new ModelAndView("citizenList"); 

                         }                      

                     }else if (user_request.equals("Update")){
                         logger.info("About to do update");

                         citizenManager.UpdateCitizen(citizen);

                         return new ModelAndView("citizen_registration");                        
                     }                  
                 }

                     logger.debug("Has No Errors");     

            return new ModelAndView("citizen_registration");

        }catch(Exception e){

            logger.error("Exception in CitizenRegistrationController - ModelAndView loadPage "+e);
            //request.setAttribute("error",e.getMessage());

             return new ModelAndView("citizen_registration");

        }

    }

         @RequestMapping(value="getCitizen/{socialSecurityNumber}.htm", method = RequestMethod.POST)
         public ModelAndView getCitizen(@PathVariable Integer socialSecurityNumber,@ModelAttribute Citizens citizen, 
                                        BindingResult result,ModelMap m,Model model,HttpServletRequest request,  
                                        HttpServletResponse response) {

             try {
                 model.addAttribute("citizens",citizenManager.getCitizen(socialSecurityNumber));
                 //model.addAttribute("citizens",citizenManager.getCitizen(socialSecurityNumber));
            } catch (Exception e) {

                logger.error("Exception in CitizenRegistrationController - ModelAndView getCitizen "+e);
            }

            return new ModelAndView("citizen_registration");     

         }

     @RequestMapping(value="getCitizenTypeDescription.htm", method=RequestMethod.GET)
     public @ResponseBody String citizenTypeDescription(@RequestParam Integer citizenTypeId)throws Exception{

        String data = "No Data Found";

         try{

            data = citizenTypeManager.getCitizenTypeDescription(citizenTypeId);

         }catch(Exception e){
             data = e.getMessage();          
             logger.error("Exception In getCitizenTypeDescription.htm error : " + e);
         }

         return data;    

     }   
//setter methods    
    /**
     * @param citizenTypeManager the citizenTypeManager to set
     */
    public void setCitizenTypeManager(CitizenTypeManager citizenTypeManager) {
        this.citizenTypeManager = citizenTypeManager;
    }
    ................................

} 
```

**编辑**

当用户单击查询时，我尝试 `return new ModelAndView("redirect:/citizenList.htm");`在控制器中使用，但是我得到了`404 Not Found - http://localhost:8084/crimeTrack/citizenList.htm"`

**小服务程序.xml**

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mvc="http://www.springframework.org/schema/mvc"

       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-3.0.xsd
                           http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
                           http://www.springframework.org/schema/beans/spring-context-3.0.xsd">

<!-- __________________________________________________________________________________________________ -->    

     <!-- Supports annotations and allows the use of @Controller, @Required, @RequestMapping -->
    <context:annotation-config/>    

    <context:component-scan base-package="com.crimetrack.business"/>
    <context:component-scan base-package="com.crimetrack.jdbc"/>
    <context:component-scan base-package="com.crimetrack.service"/>
    <context:component-scan base-package="com.crimetrack.web" />

    <mvc:annotation-driven />  

    <mvc:resources mapping="/resources/**" location="/public-resources/"/>

 <!-- __________________________________________________________________________________________________ -->    

    <!-- Forwards requests to the "/" resource to the "login" view -->  
    <mvc:view-controller path="/login" view-name="login"/>

    <!-- Forwards requests to the "/" resource to the "officer_registration" view -->  
    <mvc:view-controller path="/officer_registration" view-name="officer_registration"/>

    <!-- Forwards requests to the "/" resource to the "citizenList" view -->  
    <mvc:view-controller path="/citizenList" view-name="citizenList"/>

    <!-- Forwards requests to the "/" resource to the "citizen_registration" view --> 
    <mvc:view-controller path="/citizen_registration" view-name="citizen_registration"/>

<!-- __________________________________________________________________________________________________ -->    

    <!--  <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/> --> 

    <!--  Is used to process method level annotations -->
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>    
<!-- __________________________________________________________________________________________________ -->    

    <!-- <bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>  --> 

     <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
            <property name="basename" value="messages"/>
     </bean>

     <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean" />
<!-- __________________________________________________________________________________________________ --> 

      <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"></property>
        <property name="prefix" value="/WEB-INF/jsp/"></property>
        <property name="suffix" value=".jsp"></property>        
      </bean>

</beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:56:47.983

问题是当你说`action="citizen_registration.htm"`.

将其更改为

```
document.getElementById("citizenRegistration").action="/crimeTrack/citizen_registration.htm"; 
```

或者

```
document.getElementById("citizenRegistration").action="../citizen_registration.htm"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T17:19:44.740

1）将输入类型更改为按钮而不是提交，并添加一个 onclick 事件，该事件将调用您的 submitPage 函数，传递要调用的操作

```
<input class="button" id="save" type="button" name="user_request" value="Save"     onclick="submitPage('citizen_registration.htm');"/>
<input class="button" id="update" type="button" name="user_request" value="Update" onclick="submitPage('citizen_registration.htm');"/>
<input class="button" id="query" type="button" name="user_request" value="Query" onclick="submitPage('citizen_list.htm');"/> 
```

2）更改您的 submitPage 功能以根据单击的按钮设置操作

```
function submitPage(action){   
    document.getElementById("citizenRegistration").action = action;
    document.getElementById("citizenRegistration").method = "POST";
    document.getElementById("citizenRegistration").submit();
} 
```

3) 有 2 个控制器方法，一个映射到保存/更新，另一个映射到列表

```
@RequestMapping(value="citizen_list.htm", method = RequestMethod.POST)
public ModelAndView getCitizenList(@Valid @ModelAttribute Citizens citizen, BindingResult result, ModelMap m, Model model, @RequestParam(value="user_request") String user_request) throws Exception {

   try{
        logger.debug("about to preform query");
        //citizenManager.getListOfCitizens(citizen);
        if(citizenManager.getListOfCitizens(citizen).isEmpty()){
             model.addAttribute("icon","ui-icon ui-icon-circle-close");
             model.addAttribute("results","Notice: Query Caused No Records To Be Retrived!");                            
        }else{
             model.addAttribute("citizens",citizenManager.getListOfCitizens(citizen));
             return new ModelAndView("citizenList"); 
        } 
    }catch(Exception e){
        logger.error("Exception in CitizenRegistrationController - ModelAndView loadPage "+e);
        //request.setAttribute("error",e.getMessage());
         return new ModelAndView("citizen_registration");
    }
}

@RequestMapping(value="citizen_registration.htm", method = RequestMethod.POST)
public ModelAndView handleRequest(@Valid @ModelAttribute Citizens citizen,  BindingResult result, ModelMap m, Model model, @RequestParam(value="user_request") String user_request) throws Exception {

    try{
         logger.debug("In Http method for CitizenRegistrationController - Punishment Registration");
         logger.debug("User Request Is " + user_request);

         if(result.hasErrors()){
            logger.debug("Has Errors");
            return new ModelAndView("citizen_registration");
         }else{
             //check if its a save of an update
             if(user_request.equals("Save")){
                 citizenManager.RegisterCitizen(citizen);   
                 model.addAttribute("icon","ui-icon ui-icon-circle-check");
                 model.addAttribute("results","Record Was Saved");
                 return new ModelAndView("citizen_registration");
             } else if (user_request.equals("Update")){
                 logger.info("About to do update");
                 citizenManager.UpdateCitizen(citizen);
                 return new ModelAndView("citizen_registration");                        
             }                  
         }

        logger.debug("Has No Errors");     
        return new ModelAndView("citizen_registration");

    }catch(Exception e){
        logger.error("Exception in CitizenRegistrationController - ModelAndView loadPage "+e);
        //request.setAttribute("error",e.getMessage());
         return new ModelAndView("citizen_registration");
    }
} 
```

# c# - 像 Jabbr 这样的内容提供者

> ID：15456725
> 
> 赞同：3
> 
> 时间：2013-03-17T01:43:17.903
> 
> 标签：c#, javascript, jquery, asp.net-mvc

基本想法是，如果我将您管的网址添加到我的聊天中，它将从 youtube 获取内容并在聊天窗口本身上显示视频。

我怎样才能获得像[Jabbr](https://jabbr.net/)甚至像 gmail 或 Facebook 这样的内容提供者。是否有已知的 JS 库或标准函数来完成此任务？我查看了 Jabbr 代码，它已在服务器端完成，并且无法进行页面刷新。

我正在寻找任何可以帮助我入门的资源。我希望在我的聊天中添加不同的内容提供商，如 Youtube.com、twitter 等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T22:35:55.090

我也没有找到任何预制库来执行此操作。但是自己动手也不错。自动注入 YouTube 视频的 jQuery 代码可能如下所示：

```
urls = text.match(/http:\/\/www.youtube.com\/watch\?.*v\=([^\?\&]+)/);

if (urls) {
    $("#chatbox").prepend('<div class="entry"><iframe title="YouTube video player" class="youtube-player" type="text/html" width="320" height="240" src="http://www.youtube.com/embed/' + urls[1] + '" frameborder="0" allowFullScreen></iframe></div>');
    return;
} 
```

查看演示效果的示例小提琴：[示例](http://jsfiddle.net/pDgTj/13/)。作为另一个示例，它还匹配纯链接。为了扩展这个概念，你只需要弄清楚你想要匹配什么类型的输入（例如我的例子中的正则表达式），以及你需要注入什么代码（例如 YouTube 嵌入 iframe）。

您应该小心谨慎地测试您的表达式和注入，以免您允许用户注入恶意代码。

# java - 用于 Jquery 数据表的 java 包装器的设计模式

> ID：15456726
> 
> 赞同：0
> 
> 时间：2013-03-17T01:43:23.243
> 
> 标签：java, jquery, datatables, design-patterns

我发现 Jquery 数据表插件对于简单的只读应用程序非常有用，我希望在这些应用程序中为用户提供非常大的数据集（数百万行使用服务器端处理）的分页、排序和搜索。

我有一个重用此代码的系统，但我最终一遍又一遍地做同样的事情。我想写一个非常通用的api，我基本上只需要配置检索表中使用的数据所需的sql。我正在寻找一个好的设计模式/方法来做到这一点。我看过这样的文章[http://www.codeproject.com/Articles/359750/jQuery-DataTables-in-Java-Web-Applications](http://www.codeproject.com/Articles/359750/jQuery-DataTables-in-Java-Web-Applications)并且完全了解服务器端处理的工作原理（已经在 java 和asp.net 多次）。对于有人回答，您可能需要深入了解服务器端处理在 java 中的工作方式，但这里有一些尝试这样做的问题：

*   我通常运行三个单独的查询。不带搜索子句的计数，包含子句的计数，实​​际数据的查询。我还没有找到一种有效的方法来一次完成所有 3 项操作，这样做需要从 db 返回大量额外数据（即一遍又一遍地计数）。api需要支持基于这三个不同查询和复杂查询的行为。我通常将行号（）放在索引上，以便在大数据时分页相对较快。

*where 子句动态变化（用户可以搜索可变数量的行）。

*order by 子句出于同样的原因而更改。

*   总体而言，每个案例通常都非常特定于我们需要的数据。有没有一种抽象的好方法，以便在我想使用插件服务器端时可以做最少的工作。

因此，大多数项目中的步骤如下： *提取插件发送到服务器的参数（很多时候我自己的被添加，主要是日期范围） *构建未过滤的计数查询（这很少是动态的）。*构建过滤计数查询（动态） *构建数据查询 *构建表的模型对象并将其作为json返回。

使用可变数量的参数设置准备好的语句时会出现很多问题。以一般方式（比如仅基于列名）动态生成 sql 似乎不太可能。我想知道是否其他人为此创建了一些他们正在使用的东西，或者听起来是否有特定的模式适用。我刚刚想到创建一个可重用的过滤器可能对 java 有帮助。任何建议将不胜感激。随意成为语言不可知论者，因为架构是我想要弄清楚的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T09:23:07.427

我们有基本搜索条件，其中与 DataTables 相关的所有请求参数都映射到类属性（字段）和自定义搜索条件类，该类扩展基本并包含特定于业务逻辑字段的 sutom 搜索。同样在服务器端，我们有将自定义搜索条件作为参数并对数据库进行查询的存储库类。

如果您熟悉 C#，您可以查看[自定义绑定代码](https://github.com/tssoft/TsSoft.Web/blob/master/TsSoft.Web/Mvc/DataTablesNet/DataTableModelBinder.cs)和[使用示例](https://github.com/tssoft/TsSoft.WebSamples/blob/master/TsSoft.WebSamples/TsSoft.WebSamples/Controllers/WebController.cs)。

您也可以在 Java 代码中进行此类自定义绑定。

# r - R中的堆积柱形图

> ID：15456731
> 
> 赞同：4
> 
> 时间：2013-03-17T01:44:08.787
> 
> 标签：r, plot, ggplot2, bar-chart, data-visualization

我想知道（如果可能的话）如何在**R**中绘制这样的图。

![示例图](../Images/28e24b331463247580d4db80b676767f.png)

*例如 30 人（x 轴），工作将近 300-400 小时（y 轴），每个人在 6 个特定活动中分配的时间以彩色显示*。

示例数据：

```
| People | Act 1 | Act 2 | Act 3 | Act 4 | Act 5 | Act 6 |
|Person 1|   18  |   20  |   32  |   75  |   64  |   18  |
|Person 1|   40  |   25  |   02  |   04  |   17  |   20  |
|Person 2|   58  |   45  |   32  |   75  |   64  |   18  |
|Person 3|   10  |   15  |   11  |   28  |   15  |   92  |
|Person 1|   11  |   11  |   02  |   05  |   04  |   08  | 
```

我正在使用这段代码：

```
plot(table(data$worker),col=unique(data$worker)) 
```

（这段代码给了我每个条不同的颜色）

但我找不到根据我上面提到的标准为每个条着色的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T02:02:07.217

您需要一个堆积柱形图，它在 y 轴上显示每人工作时间的绝对值（总计），每种活动类型。

首先，像这样组织您的数据集：

```
person hours.worked activity
1      18           1
1      20           2
...
3      11           3
3      28           4
...
1      4            5
1      8            6 
```

然后，执行以下操作：

```
#reproducible example (same as OP's data)
df = structure(list(person = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L),
                    hours.worked = c(18L, 20L, 32L, 75L, 64L,18L, 40L, 25L, 2L, 4L, 17L, 20L, 58L, 45L, 32L, 75L, 64L, 18L, 10L, 15L, 11L, 28L, 15L, 92L, 11L, 11L, 2L, 5L, 4L, 8L),
                    activity = c(1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L)),
                   .Names = c("person", "hours.worked", "activity"), 
               class = "data.frame",
               row.names = c(NA, -30L))

df$person = factor(df$person,levels=c(1,2,3)) #control person order in x axis (left to right)
df$activity = factor(df$activity,levels=c(6,5,4,3,2,1)) #control order of stacks within column (top to base)

library(ggplot2)

ggplot(data=df, aes(x=person,y=hours.worked,fill=activity)) +
  geom_col(position="stack") +
  scale_fill_manual(breaks = c(1,2,3,4,5,6), #control order of legend keys (top to bottom)
                    values = c("#F564E3","#619CFF","#00BFC4","#00BA38","#B79F00","#F8766D")) #control fill of legend keys and columns stacks (surprisingly, this will honor the order of factor levels instead of order of 'breaks') 
```

[![在此处输入图像描述](../Images/93426b85a688cfbdecca6395bdaa4177.png)](https://i.stack.imgur.com/KUsfR.jpg)

# caching - 更好的缓存结果模式

> ID：15456732
> 
> 赞同：3
> 
> 时间：2013-03-17T01:44:44.113
> 
> 标签：caching, haskell, refactoring

我现在多次运行类似的模式，这种模式很容易出错（错别字可以跳过一些缓存）并且对我来说看起来不太好。有没有更好的方法来写这样的东西？

```
sum_with_cache' result cache ((p1,p2,p3,p4):partitions) = let
        (cache_p1, sol1) = count_noncrossing' cache p1
        (cache_p2, sol2) = count_noncrossing' cache_p1 p2
        (cache_p3, sol3) = count_noncrossing' cache_p2 p3
        (cache_p4, sol4) = count_noncrossing' cache_p3 p4
    in sum_with_cache' (result+(sol1*sol2*sol3*sol4)) cache_p4 partitions 
```

那么基本上可以更新缓存的N个操作？

我也可以写类似的东西：

```
process_with_cache' res cache _ [] = (cache, res)
process_with_cache' res cache f (x:xs) =
    let (new_cache, r) = f cache x
    in process_with_cache' (r:res) new_cache f xs
process_with_cache = process_with_cache' [] 
```

但这看起来也不是很干净。有没有更好的方法来编写这段代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T03:24:06.423

另一个类似的模式是当您请求一系列命名随机数时：

```
let (x, rng') = random rng''
    (y, rng)  = random rng'
in (x^2 + y^2, rng) 
```

这正是使用 state monad 的正确方法：

```
import Control.Monad.State 
```

对于所有类型的随机数生成器，`(RandomGen g) => g`都有一个状态 monad `State g`，它隐式地线程化状态：

```
do x <- state random
   y <- state random
   return (x^2 + y^2) 
```

该`state`函数只接受一个类型的函数`s -> (a, s)`并将其转换为类型的计算`State s a`，在这种情况下：

```
state :: (RandomGen g) => (g -> (a, g)) -> State g a 
```

您可以`State`使用`runState`或运行计算：`evalState``execState`

```
runState (liftA2 (\x y -> x^2 + y^2) (state random) (state random))
         (mkStdGen 0) 
```

# validation - PHP 站点代码验证和不同时验证

> ID：15456736
> 
> 赞同：0
> 
> 时间：2013-03-17T01:45:06.533
> 
> 标签：validation, head, php-include

我正在尝试验证网站[http://www.athometechsolutions.net/index.php](http://www.athometechsolutions.net/index.php)，但遇到了麻烦。

当我在 W3 验证服务中键入 URL 时，我收到以下错误：

```
Error Line 12, Column 1: character data is not allowed here

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

You have used character data somewhere it is not permitted to appear. Mistakes that can cause this error include:
    putting text directly in the body of the document without wrapping it in a container element (such as a <p>aragraph</p>), or
    forgetting to quote an attribute value (where characters such as "%" and "/" are common, but cannot appear without surrounding quotes), or
    using XHTML-style self-closing tags (such as <meta ... />) in HTML 4.01 or earlier. To fix, remove the extra slash ('/') character. For more information about the reasons for this, see Empty elements in SGML, HTML, XML, and XHTML. 
```

但是，我看不出代码有什么问题。而且，更令人费解的是，当我将“查看源”代码复制并粘贴到 W3 验证服务中时，它通过了。

我真的很想让它自己传递，我不知道为什么它不会。

在我看来，这与文档头部的第一个 php 包含有关，因为当我将部分移出包含并进入常规标题时，错误消息的位置会发生变化。但是，在我看来，它应该加载得很好（来自[PHP - 将 <head></head> 数据作为包含](https://stackoverflow.com/questions/1390696/php-is-it-dumb-to-load-head-head-data-as-an-include)和其他文档加载是否愚蠢）。

所以，我问，我怎样才能让它通过 URL 进行验证？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:55:41.887

在 Notepad++ 的 HEX 编辑器视图中查看页面的源代码会发现在验证器提到的元元素之前有一个字节顺序标记。

由于大多数编辑器不显示字节顺序标记，因此很难发现。

> 而且，更令人费解的是，当我将“查看源”代码复制并粘贴到 W3 验证服务中时，它通过了。

由于字节顺序标记仅在文档的开头才有意义，因此您的编辑器（或链中的其他组件）很可能会在您将其复制并粘贴到验证器时静默删除它。

# javascript - 无法从 Ajax 调用中获得“错误响应”

> ID：15456737
> 
> 赞同：0
> 
> 时间：2013-03-17T01:45:07.037
> 
> 标签：javascript, ajax

我正在尝试使用 Ajax 来告诉我我的服务器是否已启动。我用一个 Ajax 调用创建了一个简单的页面。当服务器启动时，它会返回 xmlhttp.responseText。如果服务器关闭，它应该说“服务器关闭”......但是当我加载页面时，然后关闭 Apache，它仍然说服务器已经启动。还有其他方法我应该这样做吗？

```
<!DOCTYPE html>
<html>
<head>
<script>
var xmlhttp;
var url = "http://192.168.0.5/ajax_info.txt";
function loadXMLDoc(url,cfunc)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=cfunc;
xmlhttp.open("GET",url,true);
xmlhttp.send();
}
function myFunction()
{
loadXMLDoc(url,function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("myDiv").innerHTML = xmlhttp.responseText;
    }
  else
    {
    document.getElementById("myDiv").innerHTML = "Server Down!";
    }
  });
}
</script>
</head>
<body>

<div id="myDiv"><h2>Let AJAX change this text</h2></div>
<button type="button" onclick="myFunction()">Change Content</button>

</body>
</html> 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T01:48:13.957

您的页面可能已缓存，请在 url 中使用缓存破坏器。例如

```
xmlhttp.open("GET",url+'?_dc='+(new Date()).getTime(),true); 
```

# ruby-on-rails - konacha 在 config.after_initialized 执行后初始化

> ID：15456738
> 
> 赞同：2
> 
> 时间：2013-03-17T01:45:17.330
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2, konacha

我正在尝试用 konacha 创建一个 Rails 应用程序。

```
$ ruby --version
ruby 1.9.3p0 (2011-10-30 revision 33570) [i686-linux] 
```

*   导轨 (3.2.11)
*   康纳查 (2.5.1)

问题是 konacha 无法运行测试，尽管它可以找到它们。

我探索了代码，发现它的初始化程序，名为`konacha.environment`，是在每个`config.after_initialize`块之后执行的。

正常情况下，konacha 的测试目录应该添加到`config.assets.paths`in 中`konacha.environment`，然后在 in`config.after_initialize`中`Sprockets::Bootstrap`运行来做关于`assets.paths`. 但在我的环境中，顺序是相反的，这意味着 Sprocket 在 konacha 更新资产路径之前加载它们。

我进一步探索了初始化程序，发现初始化程序的顺序在`tsort`. 但在那之后，顺序被颠倒了。我将调试表达式嵌入到代码中并输出执行顺序。

嵌入式调试表达式：

```
def run_initializers(group=:default, *args)
  return if instance_variable_defined?(:@ran)
  initializers.each do |i|
    puts "before tsort: [[#{i.after.inspect}]]->  [[#{i.name.inspect}]]  ->[[#{i.before.inspect}]]"
  end.tsort.each do |i|
    puts "after tsort: [[#{i.after.inspect}]]->  [[#{i.name.inspect}]]  ->[[#{i.before.inspect}]]"
  end.each do |initializer|
    initializer.run(*args) if initializer.belongs_to?(group)
  end
  @ran = true
end 
```

输出：

```
...
before tsort: [[:append_assets_path]]->  [[:prepend_helpers_path]]  ->[[nil]]
before tsort: [[:prepend_helpers_path]]->  [[:load_config_initializers]]  ->[[nil]]
before tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
before tsort: [[nil]]->  [["konacha.environment"]]  ->[[nil]]
before tsort: [[nil]]->  [[:set_load_path]]  ->[[:bootstrap_hook]]
before tsort: [[:set_load_path]]->  [[:set_autoload_paths]]  ->[[:bootstrap_hook]]
before tsort: [[:set_autoload_paths]]->  [[:add_routing_paths]]  ->[[nil]]
...
before tsort: [[:add_to_prepare_blocks]]->  [[:run_prepare_callbacks]]  ->[[nil]]
before tsort: [[:run_prepare_callbacks]]->  [[:eager_load!]]  ->[[nil]]
before tsort: [[:eager_load!]]->  [[:finisher_hook]]  ->[[nil]]
before tsort: [[:finisher_hook]]->  [[:set_routes_reloader_hook]]  ->[[nil]]
before tsort: [[:set_routes_reloader_hook]]->  [[:set_clear_dependencies_hook]]  ->[[nil]]
before tsort: [[:set_clear_dependencies_hook]]->  [[:disable_dependency_loading]]  ->[[nil]]
...

...
after tsort: [[:define_main_app_helper]]->  [[:add_to_prepare_blocks]]  ->[[nil]]
after tsort: [[:add_to_prepare_blocks]]->  [[:run_prepare_callbacks]]  ->[[nil]]
after tsort: [[:run_prepare_callbacks]]->  [[:eager_load!]]  ->[[nil]]
after tsort: [[:eager_load!]]->  [[:finisher_hook]]  ->[[nil]]
after tsort: [[:finisher_hook]]->  [[:set_routes_reloader_hook]]  ->[[nil]]
after tsort: [[:set_routes_reloader_hook]]->  [["append marketable routes"]]  ->[[nil]]
after tsort: [[:set_routes_reloader_hook]]->  [["add marketable route parts to reserved words"]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[nil]]->  [["konacha.environment"]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[nil]]->  [["static assets"]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[nil]]->  [["register refinerycms_town_story_articles plugin"]]  ->[[nil]]
after tsort: [[:load_config_initializers]]->  [[:engines_blank_point]]  ->[[nil]]
after tsort: [[:set_routes_reloader_hook]]->  [[:set_clear_dependencies_hook]]  ->[[nil]]
after tsort: [[:set_clear_dependencies_hook]]->  [[:disable_dependency_loading]]  ->[[nil]] 
```

整个输出都在[Gist](https://gist.github.com/harai/5179132)上。

请注意，这`config.after_initialize`是在名为 的初始化程序中调用的`:finisher_hook`。

我还找到了解决此问题的方法。只需定义以下空初始化程序，一切正常：

```
initializer "dummy", after: 'konacha.environment', before: :finisher_hook do |app|
end 
```

但我想知道谁应对这个问题负责。这是 konacha 的问题，Rails 的问题，还是我的误解或什么？

# java - 具有弱键和身份哈希的 ConcurrentHashMap？

> ID：15456742
> 
> 赞同：20
> 
> 时间：2013-03-17T01:45:47.190
> 
> 标签：java, concurrency, weak-references, concurrenthashmap

如何`ConcurrentHashMap`在 Java 中获得弱密钥和身份哈希？我认为 Google Guava Collections 可以提供这样的东西，但我可以从标准库中获取它吗？我还有什么其他选择？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-17T02:05:32.423

> 我认为 Google Guava Collections 可以提供这样的东西，但我可以从标准库中获取它吗？

对此的简短回答是否定的。Java SE 没有实现这种特定的组合。

*   `java.util.concurrent.ConcurrentHashMap`您可以使用键实例化 a `WeakReference`，并做一些额外的工作来实现删除损坏引用的映射条目，但这不会给您提供身份哈希语义。

*   `java.util.IdentityHashMap`您可以用键实例化 a `WeakReference`，并做一些额外的工作来实现删除损坏引用的映射条目，但这不会给您并发行为。

*   使用 a`java.util.WeakHashMap`不会给你并发或身份哈希。

*   您可以（理论上）将关键类包装在覆盖自然`equals`和`hashcode`方法的东西中。但这很可能是不可用的。

*   我不认为通过覆盖`ConcurrentHashMap`或中的方法来做到这一点是不可能的`IdentityHashMap`。

* * *

也许唯一可行的选择是将关键类和方法*更改*为基于身份的。但这不适用于“内置”键类型（尤其是键类型）或在应用程序的其他部分需要基于值的等值/哈希码的情况。`equals``hashcode``final`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-06T23:52:28.837

Google Guava 实现似乎是最简单的方法。人们可以使用 初始化所需的地图，`new MapMaker().weakKeys().makeMap()`并像使用 一样使用`java.util.concurrent.ConcurrentHashMap`。有关详细信息，请参阅[apidoc](https://guava.dev/releases/snapshot/api/docs/com/google/common/collect/MapMaker)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-11-11T08:27:25.923

如果你的应用在 spring 框架下（版本是 gt 3.2），你可以考虑使用`org.springframework.util.ConcurrentReferenceHashMap`. 下面是它的描述：

> 对键和值都使用软或弱引用的 ConcurrentHashMap。此类可以用作 Collections.synchronizedMap(new WeakHashMap>()) 的替代品，以便在并发访问时支持更好的性能。此实现遵循与 ConcurrentHashMap 相同的设计约束，但支持空值和空键。
> 
> 注意：引用的使用意味着不能保证放置到地图中的项目随后将可用。垃圾收集器可能随时丢弃引用，因此可能会出现未知线程正在默默地删除条目。
> 
> 如果未明确指定，此实现将使用软条目引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-24T01:38:23.900

搜索 ConcurrentWeakIdentityHashMap，你会得到很多例子。我自己写了一个实现，因为我认为 org/ehcache/core/internal/util/ConcurrentWeakIdentityHashMap$WeakReference 的 hashCode 太糟糕了。

[ehcache3 示例](https://github.com/ehcache/ehcache3/blob/606c5dcba355f5ed1abb002d455ef05b5899f48e/core/src/main/java/org/ehcache/core/collections/ConcurrentWeakIdentityHashMap.java)

[我写的例子](https://github.com/spring-projects/spring-loaded/blob/be39be1624c50b83741c0add3213ff02d23c6fd5/springloaded/src/main/java/org/springsource/loaded/support/ConcurrentWeakIdentityHashMap.java)

[Pull Rquest 修复 ehcache3 ConcurrentWeakIdentityHashMap Key hashCode](https://github.com/ehcache/ehcache3/pull/1071)

# ios - 使用 dylib 中的头文件进行编译

> ID：15456744
> 
> 赞同：3
> 
> 时间：2013-03-17T01:46:02.663
> 
> 标签：ios, c, header, jailbreak, dylib

我正在尝试制作一个库并想将头文件复制到dylib，但是当我输入时`libAC.h`，`libAC_FILES`我在编译时收到此错误

```
 *** No rule to make target `obj/libAC.h.f3cc93fd.o', needed by `obj/libAC.dylib.ba964c90.unsigned'.  Stop. 
```

我希望当我创建一个不同的应用程序时，我可以执行`#include <libAC.h>`并使用该库中的方法，但我找不到任何关于如何执行此操作的示例。顺便说一句，这是针对越狱设备的。我正在使用`library`theos中的模板`make package install`，如果有帮助，我会使用它来制作库并将其安装到我的手机上。 **我想要做的是为我的 dylib 安装头文件`/usr/include`**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T05:15:51.697

标头不应该捆绑到库二进制文件中。dylib 是一个只有二进制的共享库。

dylib 与*框架*（它是一个库及其头文件的捆绑包**）**不同- 我想这就是你的困惑所在。

为了允许您包含使用库函数所需的头文件，您需要将它们放入编译器的 header-search-path 中。您当然也可以将该路径扩展到包含您的标题的任何文件夹。

由于您似乎使用了一些打包脚本，请检查该脚本的文档（或简单地分析它）。

最后一点，不要使用尖括号（<、>）来分隔自定义标题包含。只有系统头文件应该得到那些。请改用标准引号 (")。

# ruby-on-rails - 通过 has_many 将类别分配给产品：通过

> ID：15456745
> 
> 赞同：1
> 
> 时间：2013-03-17T01:46:09.480
> 
> 标签：ruby-on-rails

允许用户将类别分配给他/他创建的产品的最佳方式是什么？现在，我通过中间分类模型连接了产品和类别模型。

**产品.rb**

```
class Product < ActiveRecord::Base
  attr_accessible :description, :name

  has_many :categorizations
  has_many :categories, :through => :categorizations
end 
```

**类别.rb**

```
class Category < ActiveRecord::Base
  attr_accessible :name

  has_many :categorizations
  has_many :products, :through => :categorizations
end 
```

**分类.rb**

```
class Categorization < ActiveRecord::Base
  attr_accessible :category_id, :product_id  # Should I leave these accessible?

  belongs_to :product
  belongs_to :category
end 
```

我最终试图让它在终端中工作：

```
> product = Product.create(name: "Product A", description: "Product A description")
> Category.create(name: "Cat A")
> product.categories
> []
> product.categories = "Cat A" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:49:49.480

您正在创建一个名称为“Cat A”的类别，但随后您将字符串“Cat A”分配给 product.categories

尝试这个：

```
product.categories.create(:name => "Cat A") 
```

# wcf - WCF4服务主机无文件激活配置错误

> ID：15456746
> 
> 赞同：1
> 
> 时间：2013-03-17T01:46:24.760
> 
> 标签：wcf, configuration

嗨，伙计们真的很感激能解决这个问题，这让我很生气。

使用 VS2010 SP1 + .Net 4.0 + IIS 7.5 Express。

一个旨在托管 WCF 服务的简单 Web 项目会无缘无故地引发配置异常。Host 是一个使用无文件激活的空 Web 应用程序。

基本上如下：

```
namespace MyWCFServices
{
public class HelloWorldService: IHelloWorldService
    {

        public string GetMessage(string name)
        {
            return string.Format("Hello world from {0}!", name);
        }
    }

 [ServiceContract]
    public interface IHelloWorldService
    {
        [OperationContract]
        string GetMessage(string name);
    }
} 
```

网页配置

```
<?xml version="1.0"?>
<configuration>
    <system.web>
        <compilation debug="true" targetFramework="4.0" />
    </system.web>
    <system.serviceModel>
      <serviceHostingEnvironment >
        <serviceActivations>
          <add relativeAddress="HelloWorldService.svc" 
               service="MyWCFServices.HelloWorldService"/>       
        </serviceActivations>     
      </serviceHostingEnvironment>     
      <behaviors>
        <serviceBehaviors>
          <behavior>
            <serviceMetadata httpGetEnabled="true"/>         
          </behavior>       
        </serviceBehaviors>     
      </behaviors>   
    </system.serviceModel>  
</configuration> 
```

例外：

“/”应用程序中的服务器错误。

配置错误

说明：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

解析器错误消息：无法识别的元素。

源错误：

```
Line 3:      <system.web>
Line 4:          <compilation debug="true" targetFramework="4.0" />
Line 5:      </system.web>
Line 6:      <system.serviceModel>
Line 7:        <serviceHostingEnvironment > 
```

- -编辑：

IIS 论坛上的同样问题：[http ://forums.iis.net/t/1180211.aspx/1](http://forums.iis.net/t/1180211.aspx/1)

答案很差：“也许 iis-express 不支持无文件激活”。

谁能提供更好的答案？

干杯，Amax

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T03:54:33.380

奇怪的。我只是复制了你的 xml 并粘贴到我的项目中，它工作得很好。也许您的文件中有隐藏字符？？？？尝试将其剪切并粘贴到记事本中，然后将其从记事本复制回新的 web.config 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T16:35:26.000

我有这个错误信息：

> 说明：处理服务此请求所需的配置文件期间发生错误。
> 
> 解析器错误消息：无法识别的元素。

我的解决方案是将我的网站设置为 IIS 应用程序，并将应用程序池设置为具有集成托管管道模式的 4.0 框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T14:43:51.397

瑞克看起来你的怀疑是正确的。

我从头开始重新输入配置文件并解决了问题。

在这种情况下，IIS 应该产生一个描述性错误，只看到“无法识别的元素”会产生误导。

# mysql - sql查询按类型计算多行分组

> ID：15456748
> 
> 赞同：-3
> 
> 时间：2013-03-17T01:47:19.190
> 
> 标签：mysql, sql, database

也许是一个不平凡的查询，我正在使用此表[http://sqlfiddle.com/#!2/d0423](http://sqlfiddle.com/#!2/d0423)并尝试使用 mysql 5.6 输出下表

```
[type][type_cnt][f_cnt_type0][f_cnt_type1][f_cnt_type2][time_00][time_00-15][time_15-30]
10        2         1             1           0           1          1          0
20        3         1             1           1           1          2          0
30        3         2             1           0           0          1          1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T04:28:54.493

```
CREATE TABLE bugs (
     type varchar(2),
     flag varchar(1), 
     mins varchar(2)
 );

INSERT INTO bugs(type, flag, mins) values
('10','0','0'),
('10','1','5'),
('20','0','0'),
('20','1','5'),
('20','2','10'),
('30','0','10'),
('30','0','20'),
('30','1','40');

select 
  type, 
  count(type) as type_cnt,
  SUM(CASE WHEN flag='0' THEN 1 ELSE 0 END) as f_cnt_type0,
  SUM(CASE WHEN flag='1' THEN 1 ELSE 0 END) as f_cnt_type1,
  SUM(CASE WHEN flag='2' THEN 1 ELSE 0 END) as f_cnt_type2,
  SUM(CASE WHEN CAST(mins AS UNSIGNED) = 0 THEN 1 ELSE 0 END) as time_00,
  SUM(CASE WHEN CAST(mins AS UNSIGNED) > 0 and CAST(mins AS UNSIGNED) <= 15 THEN 1 ELSE 0 END) as time_00_15,
  SUM(CASE WHEN CAST(mins AS UNSIGNED) > 15 and CAST(mins AS UNSIGNED) <= 30 THEN 1 ELSE 0 END) as time_15_30       
from bugs
group by type 
```

SQL：[sqlfiddle](http://sqlfiddle.com/#!2/d0423/20/0)

# javascript - 如何使用 eventListener 为导航菜单、多个列表项创建 javascript 悬停效果？

> ID：15456752
> 
> 赞同：-2
> 
> 时间：2013-03-17T01:47:58.500
> 
> 标签：javascript, for-loop, hover, addeventlistener

我想在一个循环中使用 2 个 addEventListeners 在导航菜单中添加和删除悬停类。

这是 CSS 和 HTML： .hovering { background-color: yellow; }

```
<ul>
    <li><a href="index.html" id="homeId">One</a></li>
    <li><a href="businesspage.html" id="businessId">Two</a></li>
    <li><a href="newspage.html" id="newsId">Three</a></li>  
</ul> 
```

这是可以工作但不使用循环的 JavaScript：

```
/* Script 1 start */
// First item
var homePg = document.getElementById("homeId"); // The homeID is in the <a> element
var homeHover = {
    addHoverClass: function() {
        homePg.setAttribute("class", "hovering");
    },
    removeHoverClass: function() {
        homePg.removeAttribute("class");
    }
} //End homeHover object
// Activate focus event on menu 
homePg.addEventListener("mouseover", homeHover.addHoverClass, false);
homePg.addEventListener("mouseout", homeHover.removeHoverClass, false);

// Second item

var businessPg = document.getElementById("businessId");
var businessHover = {
    addHoverClass: function() {
        businessPg.setAttribute("class", "hovering");
    },
    removeHoverClass: function() {
        businessPg.removeAttribute("class");
    }

} //End hovMenu object
// Activate focus event on menu 
businessPg.addEventListener("mouseover", businessHover.addHoverClass, false);
businessPg.addEventListener("mouseout", businessHover.removeHoverClass, false);

//Third item

    var newsPg = document.getElementById("newsId");
    var newsHover = {
        addHoverClass: function() {
            newsPg.setAttribute("class", "hovering");
        },
        removeHoverClass: function() {
            newsPg.removeAttribute("class");
        }

    } //End hovMenu object
    // Activate focus event on menu 
    newsPg.addEventListener("mouseover", newsHover.addHoverClass, false);
    newsPg.addEventListener("mouseout", newsHover.removeHoverClass, false);

 /* End Script 1 */ 
```

当我使用脚本 2 时，只有最后一项正确悬停。任何帮助表示赞赏。谢谢

```
 /* Script 2 start */
var gbotNav = [ "homePg", "businessPg", "newsPg" ];
var gbotId = [ "homeId", "businessId", "newsId" ];
var gbotHov = [ "homeHover", "businessHover", "newsHover"];
var count = gbotNav.length;

for (var i = 0; i < count; i = i + 1) {
var myGbotNav = gbotNav[i];
var myGbotHov = gbotHov[i];
var myGbotId = gbotId[i];

var myGbotNav = document.getElementById( myGbotId );
var myGbotHov = {
        addHoverClass: function() {
            myGbotNav.setAttribute("class", "hovering");
        },
        removeHoverClass: function() {
            myGbotNav.removeAttribute("class");
        }
    } //End gbotHov object
// Activate focus event on menu 
myGbotNav.addEventListener("mouseover", myGbotHov.addHoverClass, false);
myGbotNav.addEventListener("mouseout", myGbotHov.removeHoverClass, false);

} /* End for loop */
/* End Script 2 */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T00:22:43.560

您是否尝试过使用 CSS :hover 伪类？

[http://www.w3schools.com/cssref/sel_hover.asp](http://www.w3schools.com/cssref/sel_hover.asp)

# unix - 对标准输入标准输出标准错误感到困惑？

> ID：15456755
> 
> 赞同：0
> 
> 时间：2013-03-17T01:48:42.443
> 
> 标签：unix, stdin, stderr

所以我理解命令的含义，例如`1>&2`or`2>&1`但我的问题是我们为什么要使用这样的命令？将标准输出重定向到标准错误或从标准错误重定向到标准输出？

同样对于 `$[$1 $sign $2]`命令（用于简单计算器），是`$sign`Unix 中的默认命令吗？这是什么意思？括号外的 $ 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:34:27.733

一个价格的两个问题。最好将其作为两个问题提出，因为它们几乎完全不相关。

### I/O 重定向

*   你为什么要使用`1>&2`？

    一个标准的原因是 shell 脚本报告错误`stderr`而不是`stdout`. 例如：

    ```
    if [ ! -f "$file" ]
    then
        echo "$0: no such file - $file" >&2
        exit 1
    fi 
    ```

*   你为什么要使用`2>&1`？

    您想要捕获命令的所有输出。例如，您可能要运行一个需要很长时间的`find`命令，因此您可以编写：

    ```
    find $HOME -name '*perq*' -print > log.file 2>&1 & 
    ```

    来自的所有数据和错误消息都会`find`发送到`log.file`您稍后可以在命令完成时学习的地方。

### （`[`测试）命令

你问一下`$[$1 $sign $2]`。

这有很多问题，很难连贯地回答。关于计算器的问题表明可能`$1`应该是一个数字（让我们使用 13）并且`$2`也是（让我们使用 9），并且`$sign`可能是`+`or `-`。

*   `$[`通常不定义为变量，因此 shell 将尝试`$[13`在 PATH 上查找命令并且（通常）会失败。

    如果你写了`[ $1 $sign $2 ]`，那我们就更好了。有一个命令`[`（也称为`test`）。它通常是内置的 shell，但最初是一个单独的可执行文件（您通常会发现即使在现代系统上也有`/usr/bin/test`(or `/bin/test`) 和`/usr/bin/[`(or `/bin/[`) 可执行文件。请注意，与所有命令一样，名称 ( `[`) 与它的参数是空格。该`[`命令要求最后一个参数是`]`。现在表达式可能是：

    ```
    [ 13 + 9 ]
    [ 13 - 9 ] 
    ```

    但是，该`test`命令会反对；它不支持算术。它确实支持字符串比较`=`和`!=`；`-eq`它支持与、`-ne`、`-lt`、`-le`或`-gt`进行数字比较`-ge`。

如果要进行算术运算，可以使用`expr`命令或内置替代方法之一：

```
x=$(($1 $sign $2)) 
```

这会将 22 或 4（取决于 的值`$sign`）分配给变量`x`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T02:59:27.127

重定向答案：

在 unix 中，数据/文本文件在内部与称为文件处理程序（整数值）的东西相关联，这有助于操作系统在处理过程中区分和识别文件。unix 中的一切都被认为是一个文件，甚至是输入和输出设备。

标准输入是键盘，标准输出是标准输出，即监视器，它也用作标准错误文件流，所有这些都是默认情况下，因此这些都作为文件关联，因此分配给它们的数字 ....0 ,1 和 2。

因此，当您使用类似 2>&1 的内容时，您基本上是在告诉操作系统将 stderr(2) 数据放入 stdout(1) 数据流

$ 符号的答案：这里的美元符号是一种访问变量值的方法。

例如当你有一个像下面这样的变量::

```
Nitin@Kaizen > a=5 
Nitin@Kaizen > echo a --> will just print a 
Nitin@Kaizen > echo $a --> will print 5 
```

注意： $a 与 ${a} 或 $[a] 相同，它们访问变量的值....

$[$1 $sign $2] :: 你发出声明

```
Nitin@Kaizen > a=5
Nitin@Kaizen > b=3
Nitin@Kaizen > sign=+
Nitin@Kaizen > echo `expr $[ $a $sign $b ]`
    8   --- output is same as 5 + 3 , the value of a + b 
```

回答你为什么感到困惑：

您需要稍加努力才能完全重新阅读一本书。这些是非常基础的，因此通过一些编程和学习变得清晰。

任何涵盖文件系统（UFS）章节和一些脚本编写的优秀unix基础书籍都可以！

希望这可以帮助。

# bash - sed 追加行 - 我如何获得新行？

> ID：15456758
> 
> 赞同：1
> 
> 时间：2013-03-17T01:49:00.320
> 
> 标签：bash, sed

我已经花了几个小时在这个上，但无法破解它。我在 OSX 上使用 sed 。

这是代码：

```
sed -i.bak "s/^\(\$dokuwiki_hash.*\)$/\1\n    '"$date"'   => '"$hash"',/" install.php 
```

我得到的错误输出是（见第一行）：

```
$dokuwiki_hash = array(n    '2013-03-17'   => '7b62b75245f57f122d3e0f8ed7989623',
    '2005-09-22'   => 'e33223e957b0b0a130d0520db08f8fb7',
    '2006-03-05'   => '51295727f79ab9af309a2fd9e0b61acc',                                                                                                       
    '2006-03-09'   => '51295727f79ab9af309a2fd9e0b61acc',
    '2006-11-06'   => 'b3a8af76845977c2000d85d6990dd72b',
    '2007-05-24'   => 'd80f2740c84c4a6a791fd3c7a353536f',
    '2007-06-26'   => 'b3ca19c7a654823144119980be73cd77',
    '2008-05-04'   => '1e5c42eac3219d9e21927c39e3240aad',
    '2009-02-14'   => 'ec8c04210732a14fdfce0f7f6eead865',
    '2009-12-25'   => '993c4b2b385643efe5abf8e7010e11f4',
    '2010-11-07'   => '7921d48195f4db21b8ead6d9bea801b8',
    '2011-05-25'   => '4241865472edb6fa14a1227721008072',
    '2011-11-10'   => 'b46ff19a7587966ac4df61cbab1b8b31',
    '2012-01-25'   => '72c083c73608fc43c586901fd5dabb74',
    '2012-09-10'   => 'eb0b3fc90056fbc12bac6f49f7764df3',
    '2013-04-06'   => '7b62b75245f57f122d3e0f8ed7989623',
); 
```

它应该在一个新的行上，如下所示：

```
$dokuwiki_hash = array(
    '2013-03-17'   => '7b62b75245f57f122d3e0f8ed7989623',
    '2005-09-22'   => 'e33223e957b0b0a130d0520db08f8fb7',
    '2006-03-05'   => '51295727f79ab9af309a2fd9e0b61acc',                                                                                                       
    '2006-03-09'   => '51295727f79ab9af309a2fd9e0b61acc',
    '2006-11-06'   => 'b3a8af76845977c2000d85d6990dd72b',
    '2007-05-24'   => 'd80f2740c84c4a6a791fd3c7a353536f',
    '2007-06-26'   => 'b3ca19c7a654823144119980be73cd77',
    '2008-05-04'   => '1e5c42eac3219d9e21927c39e3240aad',
    '2009-02-14'   => 'ec8c04210732a14fdfce0f7f6eead865',
    '2009-12-25'   => '993c4b2b385643efe5abf8e7010e11f4',
    '2010-11-07'   => '7921d48195f4db21b8ead6d9bea801b8',
    '2011-05-25'   => '4241865472edb6fa14a1227721008072',
    '2011-11-10'   => 'b46ff19a7587966ac4df61cbab1b8b31',
    '2012-01-25'   => '72c083c73608fc43c586901fd5dabb74',
    '2012-09-10'   => 'eb0b3fc90056fbc12bac6f49f7764df3',
    '2013-04-06'   => '7b62b75245f57f122d3e0f8ed7989623',
); 
```

任何帮助将不胜感激 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T10:55:50.323

`\n`不支持在常规替换命令的替换部分中作为换行符`sed`（仅在 中`GNU sed`）。

例如，在模式前添加换行符，而不是

```
sed 's/pattern/\n&/' file 
```

利用

```
sed 's/pattern/\
&' file 
```

`\`应该是该行的最后一个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T01:54:30.037

不要使用替代品，`sed`有一个非常好的附加命令，可以在当前行之后添加一行，而无需摆弄换行符或存储正则表达式结果：

```
pax> echo '$dokuwiki_hash = array(
    '"'"'2013-03-17'"'"'   => '"'"'7b62b75245f57f122d3e0f8ed7989623'"'"'
);' | sed '/^\$dokuwiki_hash = /a\    blah '"'"'blah'"'"' blah'
$dokuwiki_hash = array(
    blah 'blah' blah
    '2013-03-17'   => '7b62b75245f57f122d3e0f8ed7989623'
); 
```

带引号的诡计是允许您在命令中放置文字单引号。

或者，您可以在外部使用双引号，您只需要注意 shell 不会解释您的美元变量：

```
pax> echo "\$dokuwiki_hash = array(
    '2013-03-17'   => '7b62b75245f57f122d3e0f8ed7989623'
);" | sed "/^\$dokuwiki_hash = /a\    blah 'blah' blah"

$dokuwiki_hash = array(
    blah 'blah' blah
    '2013-03-17'   => '7b62b75245f57f122d3e0f8ed7989623'
); 
```

还有一个相反的插入命令`i`用于在当前行*之前*插入，但在这种情况下它是您想要的附加。

* * *

而且，如果您在混合引用类型时遇到问题（可能是由于`bash`OSX 下的较旧版本），您可以将`sed`命令放入文件并使用`sed -f`来运行它们：

```
pax> cat qq.sed

/^$dokuwiki_hash = /a\    blah 'blah' blah

pax> echo '$dokuwiki_hash = array(
    '"'"'2013-03-17'"'"'   => '"'"'7b62b75245f57f122d3e0f8ed7989623'"'"'
);' | sed -f qq.sed

$dokuwiki_hash = array(
    blah 'blah' blah
    '2013-03-17'   => '7b62b75245f57f122d3e0f8ed7989623'
); 
```

这绕过了 shell 和`sed`. 如果这*仍然*不起作用，请参阅[此链接](https://sagebionetworks.jira.com/wiki/plugins/servlet/mobile#content/view/21758014)，它建议安装 GNU sed。

# html - 网页显示与代码相同

> ID：15456759
> 
> 赞同：0
> 
> 时间：2013-03-17T01:49:01.930
> 
> 标签：html

我对 Javascript 和 HTML 非常陌生，但我想知道是否有一种方法可以使您的网页以与您的代码相同的方式显示。比如你有这样的事情：

```
<html>
<body>
<input type="button" value="Text">
<b>Hello world               Hello<b>
</body>
</html> 
```

是否可以输入某种代码以使其像在网页上一样显示。当我尝试它时，世界和你好之间没有那么多空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T01:50:53.933

把它放在一个前置标签中

```
<pre>hello           hello</pre> 
```

pre标签保持间距

# mysql - 在 mysql 更新中跳过锁定的行以避免锁定超时

> ID：15456761
> 
> 赞同：0
> 
> 时间：2013-03-17T01:49:21.510
> 
> 标签：mysql, ruby-on-rails, locking, innodb

我的问题类似于： [忽略 MySQL 查询中的锁定行，](https://stackoverflow.com/questions/4109414/ignoring-locked-row-in-a-mysql-query) 除了我已经实现了一个接近于接受答案中建议的逻辑。我的问题是如何最初设置进程ID。所有服务器都运行类似的查询（代码在 ruby​​ on rails 中，但生成的 mysql 查询是）：

```
UPDATE (some_table) SET process_id=(some process_id) WHERE (some condition on row_1) AND process_id is null  ORDER BY (row_1) LIMIT 100 
```

现在发生的情况是所有进程都尝试更新相同的行，它们被锁定并且它们超时等待锁定。我希望服务器忽略被锁定的行（因为在锁定被释放后 process_id 将不再为空，所以这里没有必要锁定）。我可以尝试随机化要更新的一批记录，但问题是我想根据上面的查询中的 row_1 优先考虑更新。所以我的问题是，mysql中有没有办法检查记录是否被锁定并忽略它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T17:02:48.867

不，没有办法忽略已经锁定的行。您最好的选择是确保在任何延长的时间段内都不会锁定任何行。这将确保任何锁定冲突的持续时间都非常短。这通常意味着通过将行锁定在事务中（使用`FOR UPDATE`）并更新行以将其标记为“锁定”来对行进行“建议”锁定。

例如，首先您想在不锁定任何内容的情况下找到候选行：

```
SELECT id FROM t WHERE lock_expires IS NULL AND lock_holder IS NULL <some other conditions>; 
```

*现在只*锁定你想要的行，非常快：

```
START TRANSACTION;
SELECT * FROM t WHERE id = <id> AND lock_expires IS NULL AND lock_holder IS NULL;
UPDATE t SET lock_expires = <some time>, lock_holder = <me> WHERE id = <id>;
COMMIT; 
```

（技术说明：如果您打算锁定多行，请始终按特定顺序锁定它们。按主键升序是一个不错的选择。乱序或随机锁定将使您的程序因竞争进程而陷入死锁.)

现在，您可以在`lock_expires`不阻塞任何其他进程的情况下（小于 ）处理您的行（它们不会在非锁定选择期间匹配该行，因此将始终忽略它）。处理完该行后，您可以通过`UPDATE`或`DELETE`它`id`，也不会阻塞任何东西。

# android - SurfaceView如何实现item touch

> ID：15456765
> 
> 赞同：3
> 
> 时间：2013-03-17T01:50:02.540
> 
> 标签：android, surfaceview, android-view, touch-event

我正在开发一个具有 SurfaceView、SurfaceHolder、Canvas 等标准模式的 android 游戏。在这个游戏中，我将在画布上绘制多个位图，我想知道它们是否被触摸过。我知道我可以覆盖 SurfaceView 的 onTouchEvent() 并且可以线性地遍历我的所有项目以确定触摸坐标是否包含我的位图之一的区域，但我想知道我是否可以让自己更轻松。

这是我的问题：我是否可以拥有处理从 android.View 继承的在屏幕上绘制位图的类，将它们附加到我的 SurfaceView 并在它们上注册点击侦听器，这样我就不必自己完成确定点击的过程？如果我自己将视图（位图）绘制到画布上，点击监听器会准确吗？

此外，我是否会因为让我的所有位图 android 视图陷入困境而让 android 视图层次结构陷入困境并使 android 做我不想做的工作而遭受性能损失？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-14T12:09:02.143

如果您想将普通的 android 视图附加到 SurfaceView，那么使用 SurfaceView 有什么意义！你会得到一个 SurfaceView，这样你就可以自己在表面上绘图，而不是让 android 视图系统为你做这件事。所以“你”必须自己跟踪你的触摸。

您可以参考纯基于 OpenGL 的 AOSP Gallery2 代码，并将其设计用于处理触摸。

# c# - 异步 FTP 调用永无止境

> ID：15456771
> 
> 赞同：2
> 
> 时间：2013-03-17T01:51:03.143
> 
> 标签：c#, async-await, c#-5.0

我试图在给定的一组 ips 上找到所有接受匿名连接的 ftp 服务器。

基本上，我得到了我想要检查的 IP，然后在每个 IP 上尝试一个 ListDirectory。如果我没有例外，则 ftp 存在并且可以访问。

我正在使用异步方法来验证 IP，这使事情变得更快。但是，我需要等到所有异步调用都返回。为此，我在我拥有的异步调用数量上保留了一个计数器，**问题是这个计数器永远不会变为 0。**

我的代码如下所示：

迭代IP：

```
static int waitingOn;
public static IEnumerable<Uri> GetFtps()
{
    var result = new LinkedList<Uri>();
    waitingOn = 0;

    IPNetwork ipn = IPNetwork.Parse("192.168.72.0/21");
    IPAddressCollection ips = IPNetwork.ListIPAddress(ipn);

    foreach( var ip in ips )
    {
        VerifyFtpAsync(ip, result);
    }

    while (waitingOn > 0)
    {
        Console.WriteLine(waitingOn);
        System.Threading.Thread.Sleep(1000);
    }

    return result;
} 
```

并验证每个 IP：

```
public async static void VerifyFtpAsync( IPAddress ip, LinkedList<Uri> ftps )
{
    ++waitingOn;
    try
    {
        Uri serverUri = new Uri("ftp://" + ip);
        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(serverUri);
        request.Method = WebRequestMethods.Ftp.ListDirectoryDetails;
        request.Timeout = 10000;
        request.Credentials = new NetworkCredential("anonymous", "roim@search.com");

        FtpWebResponse response = (FtpWebResponse) await request.GetResponseAsync();

        // If we got this far, YAY!
        ftps.AddLast(serverUri);
    }
    catch (WebException)
    {
    }
    --waitingOn;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T03:10:21.640

`async void`首先，除非您正在编写事件处理程序，否则您不应该使用。

`async`接下来，如果您的方法可以并行运行（例如，如果此代码在控制台应用程序中运行），您确实需要保护变量和集合免受多线程访问。在您的情况下，听起来您可能想要使用`Task.WhenAll`而不是手动计数器，并删除共享集合。

```
public async static Task<Uri> VerifyFtpAsync(IPAddress ip)
{
  try
  {
    ...
    return serverUri;
  }
  catch (WebException)
  {
    return null;
  }
}

...

var ipTasks = ips.Select(ip => VerifyFtpAsync(ip));
var allResults = await Task.WhenAll(ipTasks);
var result = allResults.Where(url => url != null).ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-09-15T13:40:58.103

代替

```
FtpWebResponse response = (FtpWebResponse) await request.GetResponseAsync(); 
```

带同步码

```
FtpWebResponse response = (FtpWebResponse) request.GetResponse(); 
```

`FtpWebRequest.GetResponseAsync`没有针对特定的 FTP 被覆盖，并且来自基`WebRequest`类，它似乎无法处理这个权利。

# asp.net-mvc - MVC 如何设置值元数据

> ID：15456787
> 
> 赞同：1
> 
> 时间：2013-03-17T01:54:51.627
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework

我正在测试一个表单，它有很多字段。我想设置字段的值，所以我不必继续重新输入它。有没有办法在类元数据区域中设置它，我也将它设置为必需类型。

```
[MetadataType(typeof(myMetaData))]
public partial class myClass
{

    [Required]
    [Display(Name = "Zip")]
    public string Zip { get; set; }

    [Required]
    [Display(Name = "State")]
    public string State { get; set; }

    [Required]
    [Display(Name = "City")]
    public string City { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T05:34:22.380

为此使用**[DefaultValue](http://msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx)**属性。

```
[Required]
[Display(Name = "City")]
[DefaultValue("London")]
public string City { get; set; } 
```

这将解决您的担忧。

# android - Eclipse - .apk 抛出

> ID：15456792
> 
> 赞同：1
> 
> 时间：2013-03-17T01:56:02.450
> 
> 标签：android, manifest

有一个包含 2 个活动的简单应用程序。适用于 USB / SYNC，但是当我将其导出以获取 .apk 文件时，Mainfest.xml 会抛出对 2nd 的任何引用。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.easy"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".Splash" android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".StartingPoint" android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.easy.STARTINGPOINT" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
</application>

 </manifest> 
```

第一个活动 (.Splash) 在编译期间被删除。我的第一个项目遇到了这个问题，所以我从一个非常简单的项目重新开始，看看它是一个持续的问题还是我的第一个项目。似乎是一个持续存在的问题。

# php - SQL查询用户之间的privatemsgs GROUP BY ERROR

> ID：15456796
> 
> 赞同：0
> 
> 时间：2013-03-17T01:56:50.797
> 
> 标签：php, mysql, sql, database

我已经构建了以下查询：

```
（选择
    privatemsgs.id,
    privatemsgs.useradn,
    privatemsgs.useraid,
    privatemsgs.title,
    privatemsgs.created,
    privatemsgs.timee，
    privatemsgs.isread,
    u.photo AS creatorphoto,
    privatemsgs.relatedto
来自私人信息
左连接
    用户 AS u ON(privatemsgs.useraid = u.id)
WHERE userbid='5'
    AND relatedto=0 和 bdel=1)
联合所有
（选择
    privatemsgs.id,
    privatemsgs.useradn,
    privatemsgs.useraid,
    privatemsgs.title,
    privatemsgs.created,
    privatemsgs.timee，
    privatemsgs.isread,
    u.photo AS creatorphoto,
    rel.relatedto
FROM privatemsgs AS rel
    加入 privatemsgs ON(rel.relatedto = privatemsgs.id)
    左连接
    用户 AS u ON(rel.useraid = u.id)
WHERE rel.userbid='5')
按 ID 分组
ORDER BY timee DESC

```

此查询从表中选择所有 Privatemsgs，并像邮件一样执行，例如：

如果我向用户 b 发送了一条消息，并且用户 b 回复了我。我想在每个用户的收件箱和发件箱中显示消息。

对标记为“相关”主味精 id 的私人味精的评论。

查询有效，但在显示中复制了 msg（多次显示相同的 msg）我尝试执行“GROUP BY id”以修复它，但出现错误：

```
#1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在“GROUP BY id ORDER BY timee DESC”附近使用正确的语法

```

谢谢你！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:11:16.453

首先，根据 PM 77 的评论，联合而不是联合将解决您的重复问题。您根本不需要 group by 子句。

其次，您可能有逻辑错误。您的联合查询的顶部有这个：

```
FROM privatemsgs 
LEFT JOIN
users AS u ON(privatemsgs.useraid = u.id)
WHERE userbid='5'
AND relatedto=0 and bdel=1) 
```

如果 where 子句中的任何字段位于 users 表中，则您的左连接已成为内连接。要将其保留为左连接，您必须将所有过滤器放入连接中，如下所示：

```
FROM privatemsgs 
LEFT JOIN
users AS u ON privatemsgs.useraid = u.id
AND userbid='5'
AND relatedto=0 and bdel=1) 
```

# jquery - jQuery 折叠/展开部分

> ID：15456797
> 
> 赞同：0
> 
> 时间：2013-03-17T01:57:05.503
> 
> 标签：jquery, jquery-animate, slidetoggle

***编辑：***更新的代码

如果您访问此站点： [http ://dream-portal.net](http://dream-portal.net)

你会看到这张图片：

![展开和折叠部分](../Images/e0acacab5a96ab096ff776f3a64b602f.png)

我无法让这段代码工作......

```
global $context, $options;
echo '
<script type="text/javascript"><!-- // --><![CDATA[
var oTd;
function collapse_expand(which)
{
    var type = which.substr(2);
    var type_lower = type.toLowerCase();
    switch (type)
    {
        case "Left":
            oTd = $(".tablecol_0").eq(3);
            break;
        case "Right":
            oTd = $(".tablecol_2").eq(0);
            break;
        case "Top":
            oTd = $(".tablecol_0").eq(1);
            break;
        default:
            oTd = NULL;
            break;
    }

    if (!oTd)
        return;

    oTd.slideToggle("slow", "linear", function(){
        var oNum = !$(this).is(":visible") ? 1 : 0;
        var colExp = oNum == 1 ? "Expand" : "Collapse";
        $("#" + type_lower + "side").text(colExp + " " + type);';
        if ($context['user']['is_guest'])
            echo '
                document.cookie = which + "Collapse=" + oNum;';
        else
            echo '
                smf_setThemeOption(which + "Collapse", oNum, null, "' . $context['session_id'] . '");';
        echo '
    });
}';

$show = array(
    'left' => $context['user']['is_guest'] ? empty($_COOKIE["dpLeftCollapse"]) : empty($options["dpLeftCollapse"]),
    'right' => $context['user']['is_guest'] ? empty($_COOKIE["dpRightCollapse"]) : empty($options["dpRightCollapse"]),
    'top' => $context['user']['is_guest'] ? empty($_COOKIE["dpTopCollapse"]) : empty($options["dpTopCollapse"])
);

if (!$show['left'] || !$show['right'] || !$show['top'])
{
    echo '
    function SBVars()
    {
        $(document).ready(function(){';

            if (!$show['left'])
            echo '
                $(".tablecol_0").eq(3).hide();
                $("#leftside").text("Expand Left");';
            if (!$show['right'])
            echo '
                $(".tablecol_2").eq(0).hide();
                $("#rightside").text("Expand Right");';
            if (!$show['top'])
            echo '
                $(".tablecol_0").eq(1).hide();
                $("#topside").text("Expand Top");';
        echo '
        });
    }

    if (!document.addEventListener("DOMContentLoaded", SBVars, false))
        addLoadEvent(SBVars);';
}
echo '

// ]]></script> 

<div style="width: 100%;"><div id="rightside" class="button_submit" style="float: right;" onclick="javascript:collapse_expand(\'dpRight\');">Collapse Right</div><div id="leftside" class="button_submit" style="float: left;" onclick="javascript:collapse_expand(\'dpLeft\');">Collapse Left</div><div id="topside" class="button_submit" style="text-align: center; width: 100px; margin: 0 auto;" onclick="javascript:collapse_expand(\'dpTop\');">Collapse Top</div><div style="clear: both;"></div></div>'; 
```

它是用 php 编写的，但是 jQuery 代码应该可以工作，我就是不明白为什么？我看不到任何控制台错误。我只是希望它以动画效果展开/折叠部分......这可能吗？当然，如果页面刷新，我正在为访客使用 cookie 将其设置为保持折叠状态。

您是否认为我必须在 slideToggle 函数中使用某种步骤才能获得流畅的动画？如果是这样，怎么做？真的需要一些帮助，请。

# xml - 如何在 xml 文件中查找/替换多个字符串？

> ID：15456798
> 
> 赞同：2
> 
> 时间：2013-03-17T01:57:08.470
> 
> 标签：xml, excel, notepad++, replace

我有大约 600 个不同的文本字符串需要在 XML 文件中替换（我使用的是 notepad++，但如果这样可以完成任务，我也可以使用其他程序）。文本更改列在单独的 Excel 文件中。有没有一种方法可以运行脚本或命令来一次性查找/替换所有字符串，而不必单独执行每个字符串？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T02:14:33.140

您可以使用一些简单的 VBA 从 Excel s/s 中完成这项工作。通过传入查找替换范围来调用下面的 Sub，例如从 Excel VBA 即时窗口（使用 Alt+F11 访问 VBA 编辑器，然后查看 -> 即时）：

```
ReplaceXML Range("A1:B600") 
```

假设 A1:B600 包含 600 个查找替换字符串。

在模块中定义以下内容后**（**在 VBA 编辑器中插入 -> 模块 (Alt+F11) ）：

```
Option Explicit ' Use this !

Public Sub ReplaceXML(rFindReplaceRange as Range) ' Pass in the find-replace range

    Dim sBuf As String
    Dim sTemp As String
    Dim iFileNum As Integer
    Dim sFileName As String
    Dim i as Long

    ' Edit as needed
    sFileName = "C:\filepath\filename.xml"

    iFileNum = FreeFile
    Open sFileName For Input As iFileNum

    Do Until EOF(iFileNum)
        Line Input #iFileNum, sBuf
        sTemp = sTemp & sBuf & vbCrLf
    Loop

    Close iFileNum

    ' Loop over the replacements
    For i = 1 To rFindReplaceRange.Rows.Count
        If rFindReplaceRange.Cells(i, 1) <> "" Then
            sTemp = Replace(sTemp, rFindReplaceRange.Cells(i, 1), rFindReplaceRange(i, 2))
        End If
    Next i

    ' Save file

    iFileNum = FreeFile

    ' Alter sFileName first to save to a different file e.g.
    sFileName = "C:\newfilepath\newfilename.xml"
    Open sFileName For Output As iFileNum

    Print #iFileNum, sTemp

    Close iFileNum

End Sub 
```

# regex - Django自定义模板过滤器以突出显示文本块中的列

> ID：15456802
> 
> 赞同：1
> 
> 时间：2013-03-17T01:57:27.983
> 
> 标签：regex, django-templates

我正在使用 {{ my_list | 在 HTML 模板中呈现列表 join:"<\br>"}} ，它显示为...

```
$GPGGA,062511,2816.8178,S,15322.3185,E,6,04,2.6,72.6,M,37.5,M,,*68
$GPGGA,062512,2816.8177,S,15322.3184,E,1,04,2.6,72.6,M,37.5,M,,*62
$GPGGA,062513,2816.8176,S,15322.3181,E,1,04,2.6,72.6,M,37.5,M,,*67
$GPGGA,062514,2816.8176,S,15322.3180,E,1,03,2.6,72.6,M,37.5,M,,*66
$GPGGA,062515,2816.8176,S,15322.3180,E,6,03,2.6,72.6,M,37.5,M,,*60 
```

我正在尝试使用正则表达式在第 4 个和第 5 个逗号处插入 CSS，以便突出显示此列中的文本，但是我无法弄清楚执行此操作的表达式。实现这一点的其他方法也值得赞赏。

其他信息：

1) 每行以'\n'结尾。虽然这可以被删除并且 HTML 显示没有改变，但如果需要，我将它留给正则表达式使用。2) 在这个例子中，字符串并不总是有一个很好的标题，比如'$GPGGA'，尽管如果正则表达式需要，我可以添加一个来帮助标识行的开头。3) 列可能不是本例中所示的统一字符数。

我正在处理的过滤器如下

```
@register.filter(is_safe=True)
def highight_start(text):
    return re.sub('regex to find 4th comma in each line', ",<span class='my_highlight'>", text, flags=re.MULTILINE)

@register.filter(is_safe=True)
def highight_end(text):
    return re.sub('regex to find 5th comma in each line', "</span>,", text, flags=re.MULTILINE) 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T04:12:42.793

您可以通过*将*`<span>`第 5 个值替换为包含在标签 中的值本身来实现这一点。

正则表达式：`^((?:[\w\d\.\$]+,){4})([\d\.]+)`
替换：`\1<span class='my_highlight'>\2</span>`

在这里解释演示：[http ://regex101.com/r/cX5iA0](http://regex101.com/r/cX5iA0)

注意：我假设第 5 个值是数字和点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T18:53:27.597

感谢@ka，他让我在这个解决方案上步入正轨。我的工作过滤器使用：

```
expression = '^((?:[^,]+,){4})([^,]+)'
replace = r'\g<1><span class="my_highlight">\g<2></span>'

#[^,] also allows matching of hidden HTML tags in the text
#To get the groups to insert back into the text and not be overwritten, they need to be referenced as indicated in 'replace'. 
```

# winforms - Visual c++，ShowFocusCues 的正确合成器

> ID：15456803
> 
> 赞同：0
> 
> 时间：2013-03-17T01:57:32.763
> 
> 标签：winforms, visual-c++, clr

我想将 ' `ShowFocusCues`' 设置为 false

[http://msdn.microsoft.com/en-US/library/system.windows.forms.control.showfocuscues(v=vs.80).aspx](http://msdn.microsoft.com/en-US/library/system.windows.forms.control.showfocuscues(v=vs.80).aspx)

```
protected public:
virtual property bool ShowFocusCues {
    bool get ();
} 
```

[如何在 C# 中设置/更改/删除按钮上的焦点样式？](https://stackoverflow.com/questions/148729/how-to-set-change-remove-focus-style-on-a-button-in-c)

我试过了：

```
virtual property bool ShowFocusCues {
bool get ();
}

bool ShowFocusCues() override
{
    get
    {
        return false;
    }
} 
```

但两者都是错误的并抱怨“得到”我想阻止焦点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T13:28:52.740

你有没有尝试过这样的事情。

```
protected override bool ShowFocusCues { get { return false; } } 
```

这必须包含在控件类的代码中，该控件类必须隐藏焦点矩形以不被绘制

# python - 将十六进制字符串格式化为 MAC 字符串

> ID：15456804
> 
> 赞同：1
> 
> 时间：2013-03-17T01:57:34.117
> 
> 标签：python

如何使用简洁的语句将十六进制字符串 ('003de70fc98a') 格式化为 MAC 字符串 ('00:3d:e7:0f:c9:8a')？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T02:06:15.583

您可以使用正则表达式：

```
>>> re.sub(r'(?<=..)(..)', r':\1', '003de70fc98a')
'00:3d:e7:0f:c9:8a' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-17T02:01:53.027

```
In [104]: hexstr = '003de70fc98a'

In [105]: ':'.join([hexstr[i:i+2] for i in range(0, len(hexstr), 2)])
Out[105]: '00:3d:e7:0f:c9:8a' 
```

或者，

```
In [108]: ':'.join(map(''.join, zip(*[iter(hexstr)]*2)))
Out[108]: '00:3d:e7:0f:c9:8a' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T02:05:21.513

试试这个：

```
s = '003de70fc98a'
':'.join(s[i]+s[i+1] for i in range(0, len(s), 2))
=> '00:3d:e7:0f:c9:8a' 
```

# neo4j - neo4j 清理构建失败

> ID：15456806
> 
> 赞同：0
> 
> 时间：2013-03-17T01:57:52.243
> 
> 标签：neo4j

我试图从[https://github.com/neo4j/community.git构建 Neo4j](https://github.com/neo4j/community.git)

我正在构建`Maven 3.05`和`java 1.7.0_17`

运行命令： `mvn clean install -Dlicense.skip=true -DminimalBuild`

```
[ERROR] Failed to execute goal org.neo4j.build.plugins:licensing-maven-plugin:1.7.5:check (list-all-licenses) on project neo4j-kernel: Generated file differs from the existing file.
[ERROR] Generated: E:\neo4j\clone\gitBuild\community\kernel\target\neo4j-kernel-1.9-SNAPSHOT-NOTICE.txt
[ERROR] Existing: E:\neo4j\clone\gitBuild\community\kernel\target\..\NOTICE.txt
[ERROR] -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.neo4j.build.plugins:licensing-maven-plugin:1.7.5:check (list-all-licenses) on project neo4j-kernel: Generated file differs from the existing file.
Generated: E:\neo4j\clone\gitBuild\community\kernel\target\neo4j-kernel-1.9-SNAPSHOT-NOTICE.txt
Existing: E:\neo4j\clone\gitBuild\community\kernel\target\..\NOTICE.txt
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.apache.maven.plugin.MojoExecutionException: Generated file differs from the existing file.
Generated: E:\neo4j\clone\gitBuild\community\kernel\target\neo4j-kernel-1.9-SNAPSHOT-NOTICE.txt
Existing: E:\neo4j\clone\gitBuild\community\kernel\target\..\NOTICE.txt
    at org.linuxstuff.mojo.licensing.CheckMojo.generatedAndExistingDiffer(CheckMojo.java:198)
    at org.linuxstuff.mojo.licensing.CheckMojo.compareToExistingFile(CheckMojo.java:163)
    at org.linuxstuff.mojo.licensing.CheckMojo.execute(CheckMojo.java:138)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    ... 19 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T11:16:05.503

我正在使用 PowerShell 和用于 W8 的香草 Github 客户端进行构建。一旦你可以运行 maven（调整系统路径等），你应该做

```
mvn install "-Dlicensing.skip" 
```

由于行尾窗口增加了检查。

那样有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T04:27:48.947

请做：

```
cd community/licensecheck-config
mvn clean install there 
```

然后构建项目的其余部分？

# android - 将异步任务添加到 JSON 崩溃活动

> ID：15456807
> 
> 赞同：0
> 
> 时间：2013-03-17T01:58:07.303
> 
> 标签：android, json, asynchronous, android-activity, task

我想知道如何将 AsyncTask （成功）添加到以下代码中。我已经实现了 AsyncTask （据我所知 - 使用我在网上找到的信息）但是它一直在崩溃，我不确定为什么......非常感谢任何帮助！

爪哇：

```
import org.json.JSONException;
import org.json.JSONObject;

import com.nfc.linked.DatabaseHandler;
import com.nfc.linked.UserFunctions;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class RegisterActivity extends Activity {
Button btnRegister;
Button btnLinkToLogin;
EditText inputFullName;
EditText inputEmail;
EditText inputPassword;
TextView registerErrorMsg;

// JSON Response node names
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_ERROR_MSG = "error_msg";
private static String KEY_UID = "uid";
private static String KEY_NAME = "name";
private static String KEY_EMAIL = "email";
private static String KEY_CREATED_AT = "created_at";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.register);

    private class RegisterActivity extends AsyncTask<string, jsonobject="" string,=""> {
        @Override
        protected JSONObject doInBackground(linkingmanager.comze.com) {

        }
    // Importing all assets like buttons, text fields
    inputFullName = (EditText) findViewById(R.id.registerName);
    inputEmail = (EditText) findViewById(R.id.registerEmail);
    inputPassword = (EditText) findViewById(R.id.registerPassword);
    btnRegister = (Button) findViewById(R.id.btnRegister);
    btnLinkToLogin = (Button) findViewById(R.id.btnLinkToLoginScreen);
    registerErrorMsg = (TextView) findViewById(R.id.register_error);

    // Register Button Click event
    btnRegister.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            String name = inputFullName.getText().toString();
            String email = inputEmail.getText().toString();
            String password = inputPassword.getText().toString();
            UserFunctions userFunction = new UserFunctions();
            JSONObject json = userFunction.registerUser(name, email, password);

            // check for login response
            try {
                if (json.getString(KEY_SUCCESS) != null) {
                    registerErrorMsg.setText("");
                    String res = json.getString(KEY_SUCCESS);
                    if(Integer.parseInt(res) == 1){
                        // user successfully registred
                        // Store user details in SQLite Database
                        DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                        JSONObject json_user = json.getJSONObject("user");

                        // Clear all previous data in database
                        userFunction.logoutUser(getApplicationContext());
                        db.addUser(json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json.getString(KEY_UID), json_user.getString(KEY_CREATED_AT));
                        // Launch Dashboard Screen
                        Intent dashboard = new Intent(getApplicationContext(), DashboardActivity.class);
                        // Close all views before launching Dashboard
                        dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                        startActivity(dashboard);
                        // Close Registration Screen
                        finish();
                    }else{
                        // Error in registration
                        registerErrorMsg.setText("Error occured in registration");
                    }
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    });

    // Link to Login Screen
    btnLinkToLogin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            Intent i = new Intent(getApplicationContext(),
                    LoginActivity.class);
            startActivity(i);
            // Close Registration View
            finish();
        }
    });
} 
```

日志猫：

```
03-16 21:55:23.746: D/AndroidRuntime(483): Shutting down VM
03-16 21:55:23.746: W/dalvikvm(483): threadid=1: thread exiting with uncaught exception (group=0x41604930)
03-16 21:55:23.746: E/AndroidRuntime(483): FATAL EXCEPTION: main
03-16 21:55:23.746: E/AndroidRuntime(483): java.lang.Error: Unresolved compilation problems: 
03-16 21:55:23.746: E/AndroidRuntime(483):  Syntax error, insert "}" to complete ClassBody
03-16 21:55:23.746: E/AndroidRuntime(483):  Syntax error on token(s), misplaced construct(s)
03-16 21:55:23.746: E/AndroidRuntime(483):  The nested type RegisterActivity cannot hide an enclosing type
03-16 21:55:23.746: E/AndroidRuntime(483):  Illegal modifier for the local class RegisterActivity; only abstract or final is permitted
03-16 21:55:23.746: E/AndroidRuntime(483):  Syntax error on token(s), misplaced construct(s)
03-16 21:55:23.746: E/AndroidRuntime(483):  Syntax error on token """", { expected
03-16 21:55:23.746: E/AndroidRuntime(483):  Syntax error on token "=", delete this token
03-16 21:55:23.746: E/AndroidRuntime(483):  Syntax error on tokens, delete these tokens
03-16 21:55:23.746: E/AndroidRuntime(483):  The method doInBackground() of type RegisterActivity must override or implement a supertype method
03-16 21:55:23.746: E/AndroidRuntime(483):  at com.nfc.linked.RegisterActivity.<init>(RegisterActivity.java:34)
03-16 21:55:23.746: E/AndroidRuntime(483):  at java.lang.Class.newInstanceImpl(Native Method)
03-16 21:55:23.746: E/AndroidRuntime(483):  at java.lang.Class.newInstance(Class.java:1319)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.os.Looper.loop(Looper.java:137)
03-16 21:55:23.746: E/AndroidRuntime(483):  at android.app.ActivityThread.main(ActivityThread.java:5039)
03-16 21:55:23.746: E/AndroidRuntime(483):  at java.lang.reflect.Method.invokeNative(Native Method)
03-16 21:55:23.746: E/AndroidRuntime(483):  at java.lang.reflect.Method.invoke(Method.java:511)
03-16 21:55:23.746: E/AndroidRuntime(483):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-16 21:55:23.746: E/AndroidRuntime(483):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-16 21:55:23.746: E/AndroidRuntime(483):  at dalvik.system.NativeStart.main(Native Method)
03-16 21:55:26.296: I/Process(483): Sending signal. PID: 483 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:58:32.590

很抱歉直言不讳。您对 Java 语法有基本的误解，当然对线程也有误解。有人可能会自行重新格式化您的代码以“工作”，但我认为您将被困在 Painville 很长一段时间而没有碰到书。

“doInBackground”方法中实际上没有代码。此外，该论点无效。我会继续，但说真的，在尝试 Android 代码之前，您需要基本的 Java 编码技能。与任何平台相同（首先需要基本的编码技能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T03:52:02.230

拿出`RegisterActivity`来`onCreate()`。

有关更多信息，您可以参考[本指南。](http://www.9android.net/how-to-parsing-android-json/)

# sql - T-SQL如何从重复值中选择表中的最小值、最大值和第一行

> ID：15456812
> 
> 赞同：0
> 
> 时间：2013-03-17T01:58:40.060
> 
> 标签：sql, sql-server, tsql, duplicates

> ```
>  DateTime        --  Unit  --  Client  --- Qty
> 03/02/2013 08:00:01  --   3     --   1      ---   1
> 03/02/2013 08:00:02  --   3     --   2      ---   1
> 03/02/2013 08:00:03  --   3     --   3      ---   2
> 03/02/2013 08:00:04  --   3     --   3      ---   2
> 03/02/2013 08:00:05  --   3     --   3      ---   5
> 03/02/2013 08:00:06  --   3     --   3      ---   4
> 03/02/2013 08:00:07  --   3     --   4      ---   6
> 03/02/2013 08:00:08  --   3     --   4      ---   67
> 03/02/2013 08:00:09  --   3     --   4      ---   76
> 03/02/2013 08:00:10  --   3     --   4      ---   76 
> ```

而且我要 ：

> ```
>  DateTime        --  Unit  --  Client  --- Qty
> 03/02/2013 08:00:01  --   3     --   1      ---   1
> 03/02/2013 08:00:02  --   3     --   2      ---   1
> 03/02/2013 08:00:03  --   3     --   3      ---   2
> 03/02/2013 08:00:05  --   3     --   3      ---   5
> 03/02/2013 08:00:07  --   3     --   4      ---   6
> 03/02/2013 08:00:09  --   3     --   4      ---   76 
> ```

过滤的标准是从表中获取最小和最大“数量”，当在同一“单位”和“客户”列中存在重复的“数量”值时，只获取第一个值。

我是按照T-SQL做的，但是当“Unit”和“client”列相同时，检索的是最后一个“Qty”值，我需要第一个。

```
 --1
CREATE TABLE Transact
    (DateTime   DateTime,
     Unit       INT NULL,
     Client     INT NULL,
     Qty        INT NULL
    )

INSERT INTO Transact (Datetime,Unit,Client,Qty)
    Values ( '03/02/2013 08:00:01',3,1,1)
    Values ( '03/02/2013 08:00:02',3,2,1)
    Values ( '03/02/2013 08:00:03',3,3,2)
    Values ( '03/02/2013 08:00:04',3,3,2)
    Values ( '03/02/2013 08:00:05',3,3,5)
    Values ( '03/02/2013 08:00:06',3,3,4)
    Values ( '03/02/2013 08:00:07',3,4,6)
    Values ( '03/02/2013 08:00:08',3,4,67)
    Values ( '03/02/2013 08:00:09',3,4,76)
    Values ( '03/02/2013 08:00:10',3,4,76)

DECLARE @Total TABLE
    (DateTime   DateTime,
     Unit       INT NULL,
     Client     INT NULL,
     Qty        INT NULL
    )
DECLARE @Uniques TABLE
    (DateTime   DateTime,
     Unit       INT NULL,
     Client     INT NULL,
     Qty        INT NULL
    )
DECLARE @Mini TABLE
    (DateTime   DateTime,
     Unit       INT NULL,
     Client     INT NULL,
     Qty        INT NULL
    )
DECLARE @Maxi TABLE
    (DateTime   DateTime,
     Unit       INT NULL,
     Client     INT NULL,
     Qty        INT NULL
    )
--2

INSERT INTO @Total SELECT * FROM Transact

INSERT INTO @Mini SELECT  MIN(Datetime) Datetime,Unit,Client,MIN(Qty) FROM @Total GROUP BY Unit,Client 
INSERT INTO @Maxi SELECT  MAX(Datetime) Datetime,Unit,Client,MAX(Qty) FROM @Total GROUP BY Unit,Client

--3

INSERT INTO @Uniques SELECT * FROM @Mini UNION SELECT * FROM @Maxi

SELECT * FROM @Uniques 
```

提前致谢。

巴勃罗·杰罗尼莫。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T02:21:03.323

试试这个：

```
WITH MinCTE
AS
(
  SELECT *,
    ROW_NUMBER() OVER(Unit, PARTITION BY Client
                      ORDER BY Qty, DateTime ) AS RN
  FROM Transact
), MaxCTE
AS
(
  SELECT *,
    ROW_NUMBER() OVER(PARTITION BY Unit, Client
                      ORDER BY Qty DESC, DateTime) AS RN
  FROM Transact
)
SELECT DateTime, Unit, Client, Qty FROM MinCTE WhERE RN = 1
UNION  
SELECT DateTime, Unit, Client, Qty FROM MaxCTE WhERE RN = 1; 
```

*   [**SQL Fiddle 演示**](http://sqlfiddle.com/#!3/6b810/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T06:17:08.170

以下是您可以尝试的方法：

```
SELECT DISTINCT MIN(DateTime), MIN(Qty), Unit, Client FROM Transact
GROUP BY Unit, Client
UNION
SELECT DISTINCT MAX(DateTime), MAX(Qty), Unit, Client FROM Transact
GROUP BY Unit, Client 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T02:40:50.543

首先将具有 min 和 max Qty 的记录选择到单个表中，然后为这些记录选择 min DateTime。

```
SELECT MIN(DateTime), [Transact].Unit, [Transact].Client, [Transact].Qty 
FROM (
    SELECT DISTINCT Unit, Client, MIN(Qty) as Qty
    FROM [Transact]
    GROUP BY Unit, Client
    UNION
    SELECT Unit, Client, MAX(Qty)
    FROM [Transact]
    GROUP BY Unit, Client
    ) as MinMax
JOIN [Transact] ON [Transact].Unit = MinMax.Unit AND [Transact].Client = MinMax.Client AND [Transact].Qty = MinMax.Qty
GROUP BY [Transact].Unit, [Transact].Client, [Transact].Qty 
```

我使用了一个子查询，但如果您愿意，不难将其更改为内存表。

# jquery - 如何扩展包含一半文本和一半图像/照片库的 div？

> ID：15456816
> 
> 赞同：-1
> 
> 时间：2013-03-17T01:59:27.967
> 
> 标签：jquery, html, css

我正在尝试创建一个看起来像“阅读更多”的 div，我成功创建了它，但是当我尝试使主 div（带有阅读更多按钮）成为一半文本和一半图像/照片库时，我遇到了一些问题（就像一篇文章，左边是文字，右边是图片）[http://jsfiddle.net/nN3Uz/1/](http://jsfiddle.net/nN3Uz/1/)。我应该对此代码进行什么更改以支持我的期望？

html

```
<p id="title">Math</p>
<div class="expander" id="aspect">
                <div id="paragraf">
                Paragraph 2: Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est 
                laborum. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est Excepteur sint occaecat 
                cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est Excepteur sint occaecat cupidatat non proident, sunt in c
                ulpa qui officia deserunt mollit anim id est 
                </div>
        </div> 
```

css

```
#title {
 border:1px solid #800000;
 width:1000px;
 background:#800000;
 color:#fff;
 margin-left:0px;
 font-size: 30px;
 }

#aspect {
width:1000px;
border: 1px solid #800000;
background:#fff;
box-shadow: 5px 5px 5px #494949;
padding-left:10px;
}

#paragraf {
margin-right:10px;
width:1000px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:42:37.610

我尝试使用`<div>`但无法让它工作。如果你愿意，你可以用桌子来做。 [http://jsfiddle.net/5cvtD/](http://jsfiddle.net/5cvtD/)

# php - 如何使用数据映射器模式真正分离分层数据的关注点

> ID：15456817
> 
> 赞同：2
> 
> 时间：2013-03-17T01:59:31.703
> 
> 标签：php, zend-framework2, datamapper

我对[Data Mapper 模式](http://martinfowler.com/eaaCatalog/dataMapper.html)很陌生。我想我错过了一些东西，因为对我来说，它对于比最基本的例子更复杂的所有事情都失败了。

假设我有一个由页面组成的简单网站：

```
class Page {
    private $id     = null;
    private $parent = null;
    private $title  = null;
    private $body   = null;

    public function setId($id)              { $this->id     = (int) $id; }
    public function setParent(Page $parent) { $this->parent = $parent;   }
    public function setTitle($title)        { $this->title  = $title;    }
    public function setBody($body)          { $this->body   = $body;     }

    public function getId()     { return $this->id;     }
    public function getParent() { return $this->parent; }
    public function getTitle()  { return $this->title;  }
    public function getBody()   { return $this->body;   }
} 
```

现在我想实例化树深处的**第 7 页：**

*   第 1 页
    *   第2页
        *   第 3 页
            *   第 4 页
                *   第 5 页
                    *   第 6 页
                        *   第 7 页

使用数据映射器模式，我将使用以下映射器类：

```
class PageMapper {
    public function fetch($id) {
        //...
        $data = $db->fetchRow("SELECT * FROM `pages` WHERE `id` = ?", $id);
        $page = new Page();
        $page->setId($data['id']);
        $page->setTitle($data['title']);
        $page->setBody($data['body']);
        if ($data['parent_id'] !== null) {
            $page->setParent(
                $this->fetch($data['parent_id']);
            );
        }
    }

    public function save(Page $page) {
        //...
    }
 } 
```

问题很明显：**我必须一直实例化所有父页面，直到根页面。**

现在想象一个 Page 需要知道它的子节点。这意味着，如果我想实例化根 Page，我将不得不加载**整个 tree**。

一种解决方案可能是仅按需加载父/子，但这意味着域对象必须了解映射器才能从中提取数据......并且分离将消失。

域模型（**Page**类的实例）应该对 Data Mapper 层（分离）一无所知，但仍然能够执行这些任务（检索父/子）。

在这些情况下是否可以实现关注点分离？如果是，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T10:01:59.703

看看 Doctrine，一个实现数据映射器模式的 orm 框架：

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#one-to-many-self-reference](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#one-to-many-self-referencing)

您的方法的问题不是整个树（子）的实例化，而是它将使用的查询数量。

查看教义方法，您将有一个 children 属性，该属性通过一个查询立即加载。

我也绝不会建议为 orm 实施自制的解决方案。

一个可能的解决方案是使用闭包：

```
class Page {
//...
    public function setParents(Closure $pages)
    {
        $this->parents = $pages;
    } 
}

class PagesMapper {

public function fetch() {
//fetch the page ...
$parents = function($parent) use($id, $db) {
        parents = $db->query(/* select parent... */);
        $pages = array();
        foreach($parents as $parent) {
            $page = new Page(); 
            $page->id = $parent->id;
            //...
            $pages[] = $page;
        }
        return $pages;
    };
    $page->setParents($parents);
    return $page;
}
} 
```

所以页面域将不知道持久层。

# vb.net - CodeDom 黑盒

> ID：15456819
> 
> 赞同：0
> 
> 时间：2013-03-17T02:00:06.140
> 
> 标签：vb.net, vb.net-2010

VB.Net 代码。我想隐藏用编译代码打开的黑匣子......如何？

每当我编译它时，它都会打开一个 cmd shell...

```
 Public Shared Function CompileVBCode(sourceFile As String, exeFile As String) As Boolean
    Dim vbprovider As VBCodeProvider = New VBCodeProvider()
    Dim cp As New CompilerParameters()
    cp.ReferencedAssemblies.Add("System.dll")
    cp.GenerateInMemory = False
    cp.GenerateExecutable = True
    cp.OutputAssembly = exeFile
    Dim cr As CompilerResults = vbprovider.CompileAssemblyFromSource(cp, sourceFile) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T14:45:46.153

```
cp.CompilerOptions += "/t:winexe" 
```

# android - 在 Setting.apk 中显示静态图像作为标题

> ID：15456820
> 
> 赞同：1
> 
> 时间：2013-03-17T02:00:24.150
> 
> 标签：android, imageview

我想简单地在 Settings 顶层添加一个新的 header-style 行。不是图标，就像部分文本左侧的其他条目一样，而是屏幕宽度的图像。这将在其他地方实现，但现在，我只想能够显示图像

这似乎并不容易做到，而且我还没有在任何地方找到如此简单的事情的完整指南。

为此，我将需要 XML 编辑和匹配的 java 对应项。

这是我当前的 Java 部分：

```
 setImageDrawable(R.id.logo); 
```

这是我的 XML 方面：

```
<ImageView
        android:id="@+id/logo"
        android:src="@drawable/romlogo"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scaleType="fitXY" /> 
```

我的图像目前在 中`/res/drawable-xhdpi/`，并且被命名为`"romlogo.png" (461 x 113)`

当它坐下时，它甚至没有编译。不知道我是否错过了一个`import`或什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-09T18:46:55.377

您必须将 a 解析`Drawable`为该`setImageDrawable(...)`方法。但是，XML 代码看起来不错。不要以编程方式设置图像，它已经在属性中说明`android:src="@drawable/romlogo"`。如果您想使用代码设置它，请使用以下内容：

```
// fetch the imageview and afterwards set the drawable
// here consider the difference between R.id and R.drawable
ImageView iv = (ImageView) findViewById(R.id.logo);
iv.setImageDrawable(R.drawable.romlogo); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-17T12:02:03.857

```
<RelativeLayout
android:id="@+id/header"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_alignParentTop="true"
android:background="#000"
android:gravity="center" >
<ImageView
android:layout_width="match_parent"
android:layout_height="200dp"
android:paddingTop="0.1dp"
android:paddingLeft="0.1dp"
android:paddingRight="0,1dp"
android:scaleType="fitXY"
android:id="@+id/iv"
android:src="@drawable/organic"
android:layout_weight="30"/>
</RelativeLayout> 
```

这将是相应输出的 XML 代码。[图像作为标题和屏幕宽度](http://i.stack.imgur.com/2jzsi.png)

# android - 来自 ArrayList 的持久数据

> ID：15456822
> 
> 赞同：0
> 
> 时间：2013-03-17T02:00:46.773
> 
> 标签：android, arraylist, fileinputstream, fileoutputstream

今天几乎一整天，我一直在试图解决这个问题，但我似乎无法正确解决。我了解如何使用文件输出/输入流。但是，由于 ArrayList 不是“int”，我不能只通过它来传递我的 ArrayList。我收集到“序列化”将我的 ArrayList 转换为字节，然后可以通过 File-Output/Input-Stream 对其进行操作。我不知道它是如何工作的。我从其他人那里窃取了“对象输入/输出流”代码，他们的目标似乎与我相同，但它对我不起作用。我查看了 Android Dev Docs 中的序列化，但无法弄清楚它是如何工作的。

有人可以请吗？

A）用更简单的术语解释序列化如何工作和/或如何执行它？

&

B）解释为什么下面的代码不起作用（例如，在我添加所有 Object(in/out)putStream 之前，我的代码会动态实时填充 Listview，现在当按钮是推，也不会加载任何东西，也不会抛出任何错误）。

还

C）有没有更简单的方法来存储这个 ArrayList 以便它是持久数据。

```
package com.example.thepicker;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.ArrayList;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;

public class Settings extends Activity implements OnClickListener{

    EditText getit;
    ImageButton giveit;
    ListView thelist;
    ArrayList<String> items;
    ArrayAdapter<String> list;
    Intent pass;
    FileOutputStream persistout;
    FileInputStream persistin;
    ObjectOutputStream osistout;
    ObjectInputStream osistin;

    @SuppressWarnings("unchecked")
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.settings);

        items = new ArrayList<String>();
        list = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1,items);
        pass = new Intent(this,Main.class);
        getit = (EditText) findViewById(R.id.getit);
        giveit = (ImageButton) findViewById(R.id.giveit);
        thelist = (ListView) findViewById(R.id.thelist);

        try {
                persistin = openFileInput("FILENAME");
                osistin = new ObjectInputStream(persistin);
                items = (ArrayList<String>) osistin.readObject();
                osistin.close();
                persistin.close();
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            }

        thelist.setAdapter(list);
        list.notifyDataSetChanged();
        giveit.setOnClickListener(this);
    }

    @Override
    public void onPause() {
        super.onPause();

        pass.putExtra("total", items);  
        this.startActivity(pass);

        try {
            persistout = openFileOutput("FILENAME", Context.MODE_PRIVATE);
            osistout = new ObjectOutputStream(persistout);
            osistout.writeObject(items);
            osistout.close();
            persistout.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

}

    @Override
    public void onClick(View v) {
    items.add(getit.getText().toString());
    list.notifyDataSetChanged();
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:42:02.300

A）序列化不是你的问题。据我所知，你做得“正确”。我强烈建议使用 sqlite 而不是序列化，但那是因为我是一个 db 疯子。

B）您正在创建一个顶部列表

项目 = 新的 ArrayList();

然后使用该列表创建适配器。它是一个变量引用。然后，您在创建适配器后反序列化您的列表。适配器引用了您创建的另一个列表。您的项目 VARIABLE 现在完全指向不同的列表。反序列化后执行适配器初始化，它应该可以工作。

C）不确定“更容易”，但 sqlite 是“更好”。

但是，您的设计存在重大的系统性问题。您在主线程中执行各种 I/O，这是一个禁忌。您正在阅读 onCreate，但保存在 onPause 中，这应该可以工作，但不平衡（onCreate 的 yang 是 onDestroy。onResume 与 onPause 一起使用）。不是说它不起作用，而是它很奇怪。

保持您的 List var local 也感觉很奇怪，但是查看 Android 代码，只要您不重新定义它（就像您现在一样），您列表中的引用应该是相同的。

# vim - 如何在 Vim 中剪切光标下的单词？

> ID：15456823
> 
> 赞同：10
> 
> 时间：2013-03-17T02:01:23.827
> 
> 标签：vim

我通常想剪切光标下的单词并将其粘贴到其他地方，是否有任何现有的命令可以做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-17T02:07:18.607

类型`diw`

这意味着在word中删除。

相关命令：

*   复印：`yiw`
*   切割：`ciw`

# libpng - Capybara-webkit QtGui 需要 29.0.0 或更高版本

> ID：15456829
> 
> 赞同：1
> 
> 时间：2013-03-17T02:03:08.533
> 
> 标签：libpng, dyld, capybara-webkit, qtgui

嗨，我正在尝试对 capybara-webkit 进行一些基本的处理。当我尝试包含 Capybara::DSL 时，出现以下错误

> dyld：库未加载：/usr/local/lib/libpng15.15.dylib
> 引用自：/usr/local/lib/QtGui.framework/Versions/4/QtGui
> 原因：库版本不兼容：QtGui 需要版本 29.0.0 或稍后，但 libpng15.15.dylib 提供版本 21.0.0 /Users/brian/.rvm/gems/ruby-1.9.3-p374@rails3211/gems/capybara-webkit-0.14.2/lib/capybara/webkit/connection .rb:95:in `initialize': 无法分配请求的地址 - connect(2) (Errno::EADDRNOTAVAIL)

任何人都可以帮忙吗？使困惑。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:36:40.123

看起来这是一个旧版本的 imagemagick 问题。下载最新版本解决了。

# c - 编写一个函数来检查关系语句是真还是假

> ID：15456830
> 
> 赞同：0
> 
> 时间：2013-03-17T02:03:12.247
> 
> 标签：c, function, logic, rational-number

这是函数（我希望逻辑相当明显）。

设 x 为“<”或“>”运算符之一，a 和 b 为术语。

```
int rationalCheck(x, a, b){

    if ( x == '<' && a < b && b < a ){
        printf( "a is less than b\n" );
    }

    if ( x != '>' && a > b && b > a ){
        printf( " a is greater than b\n" );
    }

    return 0;
} 
```

该函数的输入将是

```
(4 < 4) > (3 > 3) 
```

这将评估为

```
(4 < 4) > (3 > 3) is false 
```

或者输入到函数中的是

```
(4 < 6) > (2 > 1) 
```

这将评估为

```
(4 < 6) > (2 > 1) is true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:37:37.500

您不能将运算符/操作传递给 C 中的函数。我建议考虑使用 Haskell。

或者，您*可以*将操作传递给*宏*，因此可以将其实现为宏，因此宏的定义`assert`类似于：

```
#include <stdio.h>

#define assert(cond) if (!(cond) && printf("Assertion failed: " # cond " at " __FILE__ ":%d\n", __LINE__) != 0) abort()

int main(void) {
    assert(1 > 1);
} 
```

也许你想要类似的东西：

```
#include <stdio.h>

#define rational_check(cond) printf(# cond " is %s\n", (cond) == 0 ? "false" : "true")

int main(void) {
    rational_check((4 > 4) > (3 > 3));
    rational_check((4 < 6) > (2 > 1)); // (4 < 6) > (2 > 1) is 1 > 1, by the way... false
} 
```

但是，我不能确定这是否适合您的需求。函数指针不能从rational_check 派生，也不能用于表示运行时形成的表达式的字符串；您需要为任何需要这些的用例编写翻译器......否则，这应该是合适的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-17T02:46:15.130

这对我有用。我想多了。

```
int rationalCheck(x, a, b){

if ( x == '<')
{
    if (a >= b)
    {
        return 99;
    }

    if (b <= a) {
        return 99;
    }
}

if (x == '>')
{
    if (a <= b)
    {
        return 99;

    }
    if (b >= a)
    {
        return 99;
    }

}

return 1;
} 
```

感谢大家的意见。

# ruby-on-rails-3 - 与 has_and_belongs_to_many 关联很难相处。不确定如何将对象添加到其“belongs_to”表的指定实例

> ID：15456834
> 
> 赞同：0
> 
> 时间：2013-03-17T02:04:01.020
> 
> 标签：ruby-on-rails-3, database-design, associations, model-associations, has-and-belongs-to-many

我正在构建一个应用程序，用户可以在其中创建一个组，然后邀请其他用户加入他的组。一个用户可以加入许多组，一个组将包含许多用户。**我对如何将指定用户添加到指定组感到困惑。**例如，我有一个 ID 为 2 的用户对象。**如何获取此用户对象并将其添加到指定组？**我可以使用 User.first.groups.create 创建一个组，但我无法反其道而行之。

例如，我尝试： Group.first.create(user_id: 1) 将用户 1 添加到组 1。Rails 不喜欢这样。

我有以下数据库设计：

```
class User < ActiveRecord::Base
  attr_accessible :name, :provider, :uid
  has_and_belongs_to_many :groups
end

class Group < ActiveRecord::Base
  attr_accessible :name, :share_link
  has_and_belongs_to_many :users
end 
```

我还使用以下迁移创建了一个连接表：

```
class GroupsUsers < ActiveRecord::Migration
  def up
    create_table :groups_users, :id => false do |t|
      t.integer :group_id
      t.integer :user_id
    end
  end

  def down
    drop_table :groups_users
  end
end 
```

提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T02:18:08.230

```
user = User.find(2) # this is user object you say you have already
group.users << user
group.save 
```

`group`是您要添加到的特定组（在您的快速示例中，它是`Group.first`.

# eclipse - 什么是编码 NASM 的好 IDE？

> ID：15456836
> 
> 赞同：8
> 
> 时间：2013-03-17T02:04:27.847
> 
> 标签：eclipse, ide, nasm

我一直在网上进行研究，以找到一个在 NASM 中编程的好 IDE。我发现唯一一直提到的是[RadASM](http://radasm.cherrytree.at/download/?did=40)，但是它没有包含有关如何设置它的文档，而且最重要的是它充满了病毒/特洛伊木马（根据诺顿）。

有谁知道与 NASM 配合良好的可靠、最好是免费的 IDE？

我正在寻找对 NASM 做同样的事情，就像 NetBeans 或 Eclipse 对 Java 做的一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T02:39:58.390

我有一些指向 IDE 的[链接](http://www.dreamincode.net/forums/topic/285068-assembler-getting-started/)

RadASM v2 和 v3 都来自作者的源代码库站点，并且没有病毒

**更新**
因为上面页面上的链接被破坏了，我在[这里](https://github.com/mrfearless/RadASM2)添加了 git 信息。

# nutch - 使用 Nutch 显示指向域或页面的链接

> ID：15456837
> 
> 赞同：-1
> 
> 时间：2013-03-17T02:04:28.407
> 
> 标签：nutch, web-crawler

我在 ubuntu 上使用 nutch 和 solr。我想使用 php 来查询数据库或其他方法，以从索引页面返回一组链接，这些链接指向任何特定的 url 或域。请指出我正确的方向。

我使用本教程设置蜘蛛[http://nlp.solutions.asia/?p=180](http://nlp.solutions.asia/?p=180)

我还想指出，首选是 php 语言选项或通过 php curl 或命令行界面与 nutch 或 sorl 应用程序的 api 接口。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T04:44:40.173

我注意到在数据库内部存储了链接，因此在解析每一行的链接后，执行以下查询将获得到 creativecommons.org 域的索引入站链接：

SELECT * FROM pages WHERE inlinks LIKE '%creativecommons.org%'

# list - 如何在打印列表中的最后一个值之前添加一个字符串？

> ID：15456839
> 
> 赞同：-1
> 
> 时间：2013-03-17T02:04:50.207
> 
> 标签：list, python-2.7

我是 python (2.7.3) 的新手，我正在尝试使用列表。假设我有一个定义为的列表：

```
my_list = ['name1', 'name2', 'name3'] 
```

我可以打印它：

```
print 'the names in your list are: ' + ', '.join(my_list) + '.' 
```

哪个会打印：

```
the names in your list are: name1, name2, name3. 
```

我如何打印：

`the names in your list are: name1, name2 and name3.`

谢谢你。

**更新：**

我正在尝试下面建议的逻辑，但以下是抛出错误：

```
my_list = ['name1', 'name2', 'name3']

if len(my_list) > 1:
    # keep the last value as is
    my_list[-1] = my_list[-1]
    # change the second last value to be appended with 'and '
    my_list[-2] = my_list[-2] + 'and '
    # make all values until the second last value (exclusive) be appended with a comma
    my_list[0:-3] = my_list[0:-3] + ', '

print 'The names in your list are:' .join(my_list) + '.' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T02:21:48.593

试试这个：

```
my_list = ['name1', 'name2', 'name3']
print 'The names in your list are: %s, %s and %s.' % (my_list[0], my_list[1], my_list[2]) 
```

结果是：

```
The names in your list are: name1, name2, and name3. 
```

`%s`是[`string formatting`](http://docs.python.org/2/library/stdtypes.html#string-formatting-operations)。_

* * *

如果长度`my_list`未知：

```
my_list = ['name1', 'name2', 'name3']
if len(my_list) > 1: # If it was one, then the print statement would come out odd
    my_list[-1] = 'and ' + my_list[-1]
print 'The names in your list are:', ', '.join(my_list[:-1]), my_list[-1] + '.' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T12:25:19.313

我的两分钱：

```
def comma_and(a_list):
    return ' and '.join([', '.join(a_list[:-1]), a_list[-1]] if len(a_list) > 1 else a_list) 
```

似乎在所有情况下都有效：

```
>>> comma_and(["11", "22", "33", "44"])
'11, 22, 33 and 44'
>>> comma_and(["11", "22", "33"])
'11, 22 and 33'
>>> comma_and(["11", "22"])
'11 and 22'
>>> comma_and(["11"])
'11'
>>> comma_and([])
'' 
```

# jquery - jQuery 使用包含 onclick 事件的 .parents() 函数选择“A”标签

> ID：15456841
> 
> 赞同：0
> 
> 时间：2013-03-17T02:05:06.253
> 
> 标签：jquery

即使我找到了我的问题的问题，我也无法找到解决方案。

好吧，我有一个“添加到购物车”按钮，它可以采用两种形式的代码，如下所示：

```
CODE 1:
<div class="cart">
    <a class="button" onclick="addToCart('710'); _gaq.push(['_trackEvent', 'Category Page', 'Add to Cart', 'Large Dual Fitting Pluto Metal Lighting Pendant Shades - Green']);">
        <span>Add to Basket</span>
    </a>
</div> 
```

和

```
CODE 2:
<div class="cart">
    <a class="button" onclick="addToCart('710');">
        <span>Add to Basket</span>
    </a>
</div> 
```

我有一个单独的 common.js 文件，其中定义了函数 addToCart()。我遇到的特定代码是这样的：

```
if (json['success']) {  
    html = '<div class="popup-cart-info"><div class="popup-close"><a alt="Close &amp; Continue" onclick="closeCart();" title="Close &amp; Continue" ><img src="catalog/view/javascript/jquery/fancybox/fancy_close.png"></a></div>';
    MainImg = $('a[onclick="addToCart(\'' + product_id + '\');"]').parents().find('.image a img');
    AltImg = $('a[onclick="addToCart(\'' + product_id + '\');"]').parent().parent().parent().find('.left .image a img');
    if(MainImg.length) {
        html += '<div class="cart-box-img"><img style="width:150px;" src="' + MainImg.attr('src') + '" /></div>';
    } else if(AltImg.length) {
        html += '<div class="cart-box-img"><img style="width:150px;" src="' + AltImg.attr('src') + '" /></div>';
    } else {
        html += '<div class="cart-box-img"><img style="width:130px;" src="image/no_image1.jpg" title="Image Unavailable" alt="Image Unavailable" /></div>';
    }
    html += '<div class="cart-box-succ-det">' + json['success'] + '</div>';
} 
```

分配 MainImg 的位似乎适用于 CODE2，但不适用于 CODE1。两者之间的唯一区别是 _gaq.push() 函数。如果我在 Firefox 中使用 FireBug 并删除 _gaq.push() 函数，它似乎运行良好。我要做的就是传递已添加到购物车的产品的图像源。但是当它旁边还有一个功能时，它就不起作用了。

我的问题是，即使在 onclick 事件中定义了两个函数，我如何使用 parents() 函数选择标签。

[您可以在http://bit.ly/YEW2f2](http://bit.ly/YEW2f2)看到我想要实现的目标。该图像是为“新品”而不是“特色产品”获得的。

任何帮助深表感谢。感谢您的关注。问候， 卡西克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:08:59.130

you can try this: [http://api.jquery.com/attribute-starts-with-selector/](http://api.jquery.com/attribute-starts-with-selector/) instead of [onclick=...]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:10:59.833

The selector

```
a[onclick="addToCart('170');] 
```

does of course not match

```
<a class="button" onclick="addToCart('710'); _gaq.push(['_trackEvent', 'Cat ... 
```

because the onclick attribute does not contain the *exact* text `a[onclick="addToCart('170');]`, but more than that.

To select an attribute when the content *begins* with a specified text, use the comparison "operator" `^=` instead of `=`.

# c# - 通过索引获取列表项

> ID：15456845
> 
> 赞同：408
> 
> 时间：2013-03-17T02:05:56.050
> 
> 标签：c#, list

我最近开始使用从 Java 迁移过来的 c#。我似乎无法找到如何按索引获取列表项。在java中获取列表的第一项将是：

```
list1.get(0); 
```

c#中的等价物是什么？

* * *

## 回答 #1

> 赞同：458
> 
> 时间：2013-03-17T02:06:41.527

```
list1[0]; 
```

假设列表的类型定义了一个索引器。

* * *

## 回答 #2

> 赞同：277
> 
> 时间：2013-11-18T13:06:57.973

您可以使用列表中的 ElementAt 扩展方法。

例如：

```
// Get the first item from the list

using System.Linq;

var myList = new List<string>{ "Yes", "No", "Maybe"};
var firstItem = myList.ElementAt(0);

// Do something with firstItem 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-02-27T19:53:29.017

Visual Basic、C# 和 C++ 都具有无需使用名称即可访问 Item 属性的语法。相反，包含 List 的变量被用作数组：

```
List[index] 
```

例如，参见[List.Item[Int32] Property](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.list-1.item)。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2015-08-27T01:06:36.397

老问题，但我看到这个线程最近很活跃，所以我会继续投入我的两分钱：

和米奇说的差不多。假设索引正确，您可以继续使用方括号表示法，就好像您正在访问数组一样。但是，除了使用数字索引之外，如果您的成员具有特定名称，您通常可以通过键入以下内容来进行同时搜索/访问：

```
var temp = list1["DesiredMember"]; 
```

你知道的越多，对吧？

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2020-02-27T11:07:00.627

.NET[`List`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.list-1)数据结构是[`Array`](https://docs.microsoft.com/en-US/dotnet/api/system.array)一个“可变外壳”。

因此，您可以使用索引来访问它的元素，例如：

```
var firstElement = myList[0];
var secondElement = myList[1]; 
```

从**C# 8.0**开始，您可以使用[`Index`](https://docs.microsoft.com/en-us/dotnet/api/system.index)和[`Range`](https://docs.microsoft.com/en-us/dotnet/api/system.range)类来访问元素。它们提供从序列末尾的访问或仅访问序列的特定部分：

```
var lastElement = myList[^1]; // Using Index
var fiveElements = myList[2..7]; // Using Range, note that 7 is exclusive 
```

您可以将索引和范围组合在一起：

```
var elementsFromThirdToEnd = myList[2..^0]; // Index and Range together 
```

您也可以使用 LINQ`ElementAt`方法，但对于 99% 的情况，这实际上是没有必要的，只是性能缓慢的解决方案。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2020-03-18T08:21:17.403

您可以使用索引来访问列表元素

```
List<string> list1 = new List<string>();
list1[0] //for getting the first element of the list 
```

# garbage-collection - 生成的 C 中的高效 GC 写屏障

> ID：15456846
> 
> 赞同：2
> 
> 时间：2013-03-17T02:05:57.740
> 
> 标签：garbage-collection, code-generation

我正在设计一个预先编译 CIL 字节码的系统。为了保持它*相对*简单并使其非常可移植，系统将发出 C 源代码（但是排除了 OOP 等所有更高级别的结构）而不是机器代码。目的是目标平台的标准 C 编译器将用于该代码以获得最终产品。

最初我打算使用一种非常简单的 GC 方法，例如 stop-the-world。然而，虽然应用程序不需要出色的性能，但它确实需要不错的性能，因此最终可能需要更改 GC。

我正在考虑最终需要某种写入障碍的更复杂的 GC。我已经研究过 SATB 和卡片标记方法，但我还没有准备好实际计划一个好的 GC。我只是不想让这个东西发出 C 源代码，只是后来发现一个有效的 GC 写入障碍需要内联汇编，这在很大程度上违背了发出 C 的目的。

所以，我的问题是，典型的写障碍可以在 C 代码中有效地实现吗？我们可以假设 C 编译器有一个不错的优化器。生成的“源代码”将完全难以辨认，这也是一个假设，因此清晰度并不重要。

我猜想——以更加膨胀的源文件为代价——它可能可以合理地完成，但我会感谢在 GC 设计和/或编译器内部更有经验的人的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T02:11:31.993

I am assuming you want a precise generational moving or copying GC.

You could have a write barrier in C; as an example, both Ocaml and [MELT](http://gcc-melt.org/) runtimes have generational GC with a write barrier. And [qish](http://starynkevitch.net/Basile/qishintro.html) is a generational copying GC with a write barrier, working with C.

^((BTW, MELT is a domain specific language to extend GCC, and it is compiled to C, exactly like you want to do))

A more significant issue is how do you keep local pointers (and how the GC knows about them), that is the precise aspect of your GC. You may want to pack them in some local structure.... But then it could happen that the C compiler (e.g. GCC) is optimizing a bit less.

You might look into the source code of recent versions of [MONO](http://mono-project.com/), they have a generational copying GC. Look also inside [Chicken Scheme](http://www.call-cc.org/) (also generating C code).

Notice that your *C* code generator will have to be changed to fit inside some (or yours) particular GC implementation (because each GC has slightly different invariants and expectations). Take also care of [tail recursion](http://en.wikipedia.org/wiki/Tail_recursion) (some *C* compilers, notably recent GCC, may optimize them in limited cases).

In Qish, MELT or Ocaml the write barrier (on the C side) is implemented by some macro (or inline functions) called for each touched pointer. Details are implementation specific. Your C code generator will have to take care of them.

Be careful that multi-threaded GC are difficult to design, and that debugging GC, even simple ones, takes a lot of time and is difficult.

# c++ - 捕捉 QTableWidgetItem 检查状态变化

> ID：15456856
> 
> 赞同：6
> 
> 时间：2013-03-17T02:07:37.673
> 
> 标签：c++, qt, qt4

我有一个 QTableWidget，上面有一些 QTableWidgetsItems。有些项目使用复选框。我使用以下代码添加了复选框：

```
QTableWidgetsItem->setCheckState(Qt::Checked); 
```

我现在想在此复选框状态更改时调用一些函数。以信号为例。

实现这一目标的最简单方法可能是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T08:38:57.500

最简单的方法是在包含 QTableWidget 的类中使用插槽捕获 QTableWidget 的信号。虽然这似乎`QTableWidget::itemActivated`是我们最好的选择，但不确定是否在`Qt::CheckState`等于时发出`Qt::Checked`。此外，即使这是真的，该信号也不会为您提供处理项目取消选中的功能，您的应用程序可能需要这样做。

所以，这是我提出的解决方案。使用包含 QTableWidget 的类中定义的槽捕获`QTableWidget::itemPressed`和信号。`QTableWidget::itemClicked`由于 itemPressed 应该在释放鼠标按钮之前调用，并且 itemClicked 应该在释放鼠标按钮之后调用，所以 QTableWidgetItem 的 Qt::CheckState 应该只设置在这两个信号发射之间。因此，您可以准确地确定 QTableWidgetItem 的 checkState 何时以低内存开销发生变化。

以下是这些插槽的示例：

```
void tableItemPressed(QTableWidgetItem * item)
{
    // member variable used to keep track of the check state for a 
    // table widget item currently being pressed
    m_pressedItemState = item->checkState();
}

void tableItemClicked(QTableWidgetItem * item)
{
    // if check box has been clicked
    if (m_pressedItemState != item->checkState())
    {
        // perform check logic here
    }
} 
```

信号/插槽将按如下方式连接：

```
connect(m_tableWidget,SIGNAL(itemPressed(QTableWidgetItem *)),this,SLOT(tableItemPressed(QTableWidgetItem *)));
connect(m_tableWidget,SIGNAL(itemClicked(QTableWidgetItem *)),this,SLOT(tableItemClicked(QTableWidgetItem *))); 
```

您与表格小部件相关联的`m_tableWidget`位置在哪里。`QTableWidget *`

# android - 加载 xml 布局时程序崩溃

> ID：15456858
> 
> 赞同：0
> 
> 时间：2013-03-17T02:08:01.687
> 
> 标签：android

当用户点击 EditText 时，我加载了一个布局 xml，如下所示。但是程序在执行 setContentView(descriptionView); 时总是崩溃；问题是什么？

```
EditText DescEditTxt = (EditText) addView.findViewById(R.id.descriptionEdit);
    if(DescEditTxt != null)
    {
        DescEditTxt.setOnFocusChangeListener(new View.OnFocusChangeListener() {
            @Override
            public void onFocusChange(View v, boolean hasFocus) {

                final View descriptionView = getLayoutInflater().inflate(R.layout.description, null);
                setContentView(descriptionView);
            }
       });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:53:48.900

没有看到任何东西，我猜你不能在同一个活动上多次调用“setContentView”。做一个谷歌搜索。你会发现这是一个普遍的印象。

另外，请阅读：

[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/view/Window.java#Window.setContentView%28android.view.View %29](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/view/Window.java#Window.setContentView%28android.view.View%29)

“请注意，调用此函数会“锁定”窗口的各种特征，从现在开始，这些特征无法更改......”

正如那人所说，你需要一个新计划，斯坦。

# python - Python中根据索引获取字符

> ID：15456859
> 
> 赞同：0
> 
> 时间：2013-03-17T02:08:03.663
> 
> 标签：python, string, indexing

我对python相当陌生，想知道如何根据索引号在字符串中获取字符？

假设我有字符串“hello”和索引号 3。我如何让它返回那个位置的字符，似乎有一些我似乎无法找到的内置方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T02:10:42.447

You just need to index the string, just like you do with a list.

```
>>> 'hello'[3]
l 
```

Note that Python indices (like most other languages) are zero based, so the first element is index 0, the second is index 1, etc.

For example:

```
>>> 'hello'[0]
h
>>> 'hello'[1]
e 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T02:14:10.517

its just straight forward.

```
str[any subscript]. //e.g. str[0], str[0][0] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T03:03:52.917

检查[这个页面](http://docs.python.org/2/tutorial/introduction.html#strings)...

你需要的是：

> 字符串可以下标（索引）；就像在 C 中一样，字符串的第一个字符的下标（索引）为 0。
> 没有单独的字符类型；一个字符只是一个大小为 1 的字符串。
> 就像在 Icon 中一样，子字符串可以用切片表示法指定：两个索引用冒号分隔。

**示例**：

```
>>> word[4]
'A'
>>> word[0:2]
'He'
>>> word[2:4]
'lp' 
```

* * *

对于您的情况，请尝试以下操作：

```
>>> s = 'hello'
>>> s[3]
'l' 
```

# python - 如何将 python 格式字符串与列表中的元素匹配？

> ID：15456860
> 
> 赞同：2
> 
> 时间：2013-03-17T02:08:08.153
> 
> 标签：python, design-patterns, format, match

我使用 Python，并且有一个不同文件类型的文件名列表。文本文件可能如下所示：

```
01.txt
02.txt
03.txt
... 
```

让我们假设文本文件都以这种方式编号。现在我想获取数字从 1 到 25 的所有文本文件。所以我想`%02i.txt`通过 GUI 提供一个格式字符串，以识别所有匹配的文件名。

到目前为止，我的解决方案是嵌套`for`循环。外循环遍历整个列表，内循环对每个文件从 1 计数到 25：

```
fmt = '%02i.txt'
for f in files:
    for i in range(1, 25+1):
        if f == fmt % i:
            # do stuff 
```

这个嵌套循环看起来不是很漂亮，复杂度是*O(n²)*。因此，在很长的列表上可能需要一段时间。**有没有更聪明/pythonic的方式来做到这一点？**

嗯，是的，我可以使用像 一样的正则表达式`^\d{2}\.txt$`，但是格式字符串`%`更容易输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T02:13:02.423

You can use a set:

```
fmt = '%02i.txt'
targets = {fmt % i for i in range(1, 25+1)} 
```

then

```
for f in files:
    if f in targets:
        # do stuff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:54:59.813

一种更 Pythonic 的方式来遍历文件是通过使用[`glob`](http://docs.python.org/2/library/glob.html)模块。

```
>>> import glob
>>> for f in glob.iglob('[0-9][0-9].txt'):
        print f

01.txt
02.txt
03.txt 
```

# java - 排序散列地图 Map

> ID：15456861
> 
> 赞同：0
> 
> 时间：2013-03-17T02:08:11.430
> 
> 标签：java, android, hashmap

我正在尝试排序并获取 VALUE 的前 3 个最大值（？）

```
Map<String,?> points = map 
```

尝试使用`Map<String, String>`，它工作正常，但在这种情况下，我需要`Map<String, ?>`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:44:30.400

值的类型将需要实现`Comparable`。

如果地图的大小不是太大，你可以尝试这样的事情：

```
private <T extends Comparable> SortedSet<T> sortValues(final Map<?, T> m)
    {
    final SortedSet<T> result = new TreeSet<>();
    result.addAll(m.values());
    return result;
    } 
```

我没有对此进行测试，但我认为我的所有类型声明都是正确的。然后只取排序集中的第一个或最后一个元素。我相信您可以选择提供自己`Comparator`的集合来选择如何订购对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:49:15.567

首先，您无法对非`Comparable`对象进行排序，因此您需要一个带有`Comparable`值的映射，而不是`?`. 但是，有了它，您可以执行以下操作：

```
public static <T extends Comparable<? super T>> List<T> sortValues(Map<?, T> map) {
    List<T> buffer = new ArrayList<T>(map.values());
    Collections.sort(buffer);
    return(buffer);
} 
```

然后你可以用 的返回值做任何你想做的事情`sortValues`，比如选择其中的前三个对象。

# mysql - Mysql复制错误

> ID：15456862
> 
> 赞同：1
> 
> 时间：2013-03-17T02:08:17.657
> 
> 标签：mysql

检查状态时，我在 mysql 中收到错误

```
mysql>SHOW MYSQL STATUS\G;

Last_SQL_Error: Error 'Incorrect key file for table './aaa_bbb/abcd_xxyyzz.MYI';
try to repair it' on query. Default database: 'aaa_bbb'.
Query: 'UPDATE abcd_xxyyzz SET abcd_xxyyzz = 12345678912, abcd_xxyyzz = 'posting.php?mode=reply&f=23&t=156&confirm_key=4DGHJNBFTH', abcd_xxyyzz_id = 11 WHERE abcd_xxyyzz_id='2dfggrehtrhfdfvsdasdsas2fsd1fdf45' 
```

有人可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T22:05:55.517

我们可以通过修复表来解决此问题。在 mysql 命令提示符下：

```
mysql -u username -p password
mysql> use aaa_bbb;
mysql> repair table abcd_xxyyzz;
mysql> slave stop;
mysql> slave start; 
```

# ruby-on-rails - 将 Rails 闪烁通知设置为在一周中的某一天出现

> ID：15456863
> 
> 赞同：0
> 
> 时间：2013-03-17T02:08:35.587
> 
> 标签：ruby-on-rails, ruby

如果是星期一，如何让特定的 Flash 通知始终出现在 Ruby on Rails 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:16:37.063

```
def ApplicationController < ActionController::Base
  before_filter :show_message_if_today_is_monday

  # rest of your ApplicationController code

private

  def show_message_if_today_is_monday
    flash[:notice] = "Your message here" if Time.now.monday?
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:15:32.053

您的数据库中可能有一个与日期时间多态的通知模型。在这个模型中，你可以有四个字段，

```
source_type: date, time and/or date & time
source_trigger: value of the source type
notification_message: message that you want to display
notification_styling: css styling 
```

在您的应用程序控制器中，您可以调用一个辅助方法，该方法可以确定通知模型中的记录是否应该出现。这样，如果您需要显示周二消息、下午 12:00 消息或某个日期和时间的消息，您就可以使用它。

在您的应用程序布局中，您可以调用此通知实例变量来显示消息通知。

# asp.net-mvc-4 - Adam Freeman 的 Pro ASP.NET 4 书籍和实体框架数据库迁移遇到困难

> ID：15456864
> 
> 赞同：0
> 
> 时间：2013-03-17T02:08:36.423
> 
> 标签：asp.net-mvc-4

我正在阅读这本书和 Sports Store 示例，并且通常发现它充满了很棒的、信息丰富的内容。

但是在第 10 章（清单 10-14）中，我们介绍了向产品类添加一些验证属性的简单操作，这会破坏应用程序，因为 VS 说支持 EFDbContext 上下文的模型已经改变（我们只添加了验证属性），并建议我们启用 Code First 迁移来更新数据库。

这本书在没有解决问题的情况下向前推进。我发现我无法启用迁移，因为我得到了这个：

```
PM> enable-migrations -enableautomaticmigrations
No context type was found in the assembly 'SportsStore.WebUI'. 
```

这本书没有勘误表，我不确定如何在不进行自动迁移的情况下让 EF 满意。

有没有人在书中遇到过这个问题，或者知道在没有启用迁移的情况下更改我的上下文支持模型后如何继续前进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:44:44.680

请记住，您将默认项目设置为 WebUI，当您打开包管理器控制台时，它会设置为没有数据库上下文的默认项目 (WebUI)，它位于您的域项目中，您需要做的是更改从 WebUI 到域的默认项目，不是在您的解决方案设置上，而是在您的包管理器控制台上。这是一个SS： ![在此处输入图像描述](../Images/5ec601cebad9c4ce1c633712aec3bd86.png)

![安慰](../Images/5ec601cebad9c4ce1c633712aec3bd86.png)

# bison - DOM Parser Using Flex and Bison

> ID：15456868
> 
> 赞同：0
> 
> 时间：2013-03-17T02:09:17.770
> 
> 标签：bison, flex-lexer

I am working on a project to create a DOM parser. At the initial stage I am simply trying to figure out how many tags are there in the given file. Let's say I have an XML file whose content is somewhat like this : `<abc>`this is test file`</abc>` , for this I only want to parse the two tags `<abc>` and `</abc>`. For this happen I am using Flex and Bison to write a grammar so that whenever this grammar occurs I execute my code. This is my Bison code :

```
%{
    #include <stdio.h>
    #include <conio.h>
    int yylex();
    int yyparse();
    FILE *yyin;
    int yylineno;
    void yyerror(const char*);
%}

%token START_TAG END_TAG 

%%
tag:
    sTag
    | eTag
    ;
sTag:
    START_TAG {printf("start tag encountered");}
    ;
eTag:
    END_TAG
    ;
%%
int main(){
    FILE *myFile;
    myFile = fopen("G:\\MCA-2\\project\\09-03-2013\\demo.txt","r");
    if(!myFile){
        printf("error opening file");
    }
    yyin = myFile;
    do{
        yyparse();
    } while(!feof(yyin));
    fclose(myFile);
    return 0;
} 
```

And this is my Flex code :

```
%{
    #include "xml.tab.h"
    #define YY_DECL extern "C" int yylex()
%}

%option noyywrap
%option yylineno
alpha [a-zA-Z]
digit [0-9]
%%
[ \t] {}
[ \n] {}
{alpha}({alpha}|{digit})* return START_TAG;
%% 
```

When I am trying to compile this I am getting an error like this :

lex.yy.c : 529:1: error: expected identifier or '(' before string constant.

Can anyone tell me what is the mistake I am making?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-24T13:06:58.593

（评论中回答的问题；请参阅：[没有答案的问题，但问题已在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

@rici 提供了答案。由于 flex 正在为 gcc 编译器生成 C 代码，因此完全*摆脱了该`#define YY_DECL`行，因为默认声明会很好。每次更改 flex 文件时不要忘记运行 flex 以重新生成 lex.yy.c。该声明`extern "C"...`仅在 C++ 中有效，在 C 中无效，通常`file.c`会编译为 C。*

# ms-access - 如何在 Microsoft Access 中格式化数字字段？

> ID：15456871
> 
> 赞同：0
> 
> 时间：2013-03-17T02:09:55.740
> 
> 标签：ms-access, formatting

我希望数字字段始终显示为 3 位数字。根据需要用 0 向左填充。

示例：3 显示为 003，24 显示为 024，依此类推。假设最大数量为 999。

我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:14:30.477

```
Function Lpad (Value as String, PadCharacter as String, PaddedLength as Integer)
    Lpad = string(PaddedLength - Len(Value), PadCharacter) & Value
End Function 
```

[参考](http://support.microsoft.com/kb/210573)。

```
Lpad("3", "0", 3) 
```

# javascript - 通过 javascript 从网站获取动态内容

> ID：15456872
> 
> 赞同：-1
> 
> 时间：2013-03-17T02:09:59.460
> 
> 标签：javascript, parsing, dynamic, xmlhttprequest, web-scraping

我正在创建一个 firefox 插件并使用 javascript。我正在使用 XMLHttpRequest 从远程网站获取动态内容并将其存储到文件中以供稍后解析。但在 responseText 我没有收到任何动态内容。在存储我得到的信息后，只有没有动态内容的 html 页面。

代码：

```
var res="";

var req = new XMLHttpRequest();

req.onload = function(){

res=this.responseText;
}   

req.open("GET","www.ebay.com", true);

req.send(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:54:17.137

您只能在自己的域下获取远程内容。这是一个安全问题。您可以使用`JSONP`，但对于 ebay，我不知道是否有任何可用的 json 内容。有关更多信息，请查看： http: [//www.devproconnections.com/article/aspnet2/ajax-cross-domain-142169](http://www.devproconnections.com/article/aspnet2/ajax-cross-domain-142169)

如果您使用带有 Chrome 扩展程序或 Firefox 插件的 Javascript，那么您必须在清单文件中设置权限才能访问您想要的那些网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T03:07:31.207

[由于同源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)无法完成，因此您只能请求源域内的内容。

以下是一些可能对您有帮助的链接：
[Getting CORS Working](http://remysharp.com/2011/04/21/getting-cors-working/)
[Cross-domain Ajax with Cross-Origin Resource Sharing](http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/)

* * *

编辑：
由于您要从网站获取的内容是由 生成的`Ajax`，因此无法获取动态内容。网站上的`dynamic content`呈现是在浏览器加载 html 页面之后，因此可以触发 Javascript 事件以`dynamic content`通过`Ajax`。您**可以**获取 html 页面，但您没有获取 Javascript 文件。因此，*无法*获得动态内容。

*对不起，我的英语不好*

# android - Handling onNewIntent in Fragment

> ID：15456873
> 
> 赞同：18
> 
> 时间：2013-03-17T02:10:38.727
> 
> 标签：android, android-intent, android-fragments

I am writing an application that uses NFC to read some data stored on it. My application uses Fragments and Fragment don't come with onNewIntent() method. Since, the data I am reading is done with my separate class which handles NFC related operation, the only thing I need to do is update the TextView inside the Fragment. However this implementation can also be used to pass new Intent to the Fragment.

Here is my current implementation which makes use of an interface. I am calling the listener after new Intent is received and NFC related checks succeeds. This is the FragmentActivity which hosts Fragment.

```
public class Main extends FragmentActivity implements
    ActionBar.OnNavigationListener {

private Bundle myBalanceBundle;
private NFC nfcObj;
private NewBalanceListener newBlanceListener;

@Override
public void onNewIntent(Intent intent) {
    setIntent(intent);
}

@Override
protected void onResume() {
    getNFCState();
    super.onResume();
}

private void getNFCState() {
    //Other NFC related codes
    else if (nfc_state == NFC.NFC_STATE_ENABLED){
        readNFCTag();
    }
}

private void readNFCTag() {
    //Other NFC related codes
    if (getIntent().getAction().equals(NfcAdapter.ACTION_TECH_DISCOVERED)) {
        nfcObj.setTag((Tag) getIntent().getParcelableExtra(
                NfcAdapter.EXTRA_TAG));
        nfcObj.readQuickBalance();

        transitQuickReadFragment(nfcObj.getCurrentBalance());
    }
}

private void transitQuickReadFragment(String balance) {
    // Creates a balance bundle and calls to select MyBalance Fragment if it
    // is not visible. Calls listener is it is already visible.
    if (actionBar.getSelectedNavigationIndex() != 1) {
        if (myBalanceBundle == null)
            myBalanceBundle = new Bundle();

        myBalanceBundle.putString(Keys.BALANCE.toString(), balance);

        actionBar.setSelectedNavigationItem(1);
    } else {
        newBlanceListener.onNewBalanceRead(balance);
    }
}

@Override
public boolean onNavigationItemSelected(int position, long id) {
    // Other fragment related codes
    fragment = new MyBalance();
    fragment.setArguments(myBalanceBundle);
    newBlanceListener = (NewBalanceListener) fragment;
    // Other fragment related codes
}

// Interface callbacks. You can pass new Intent here if your application
// requires it.
public interface NewBalanceListener {
    public void onNewBalanceRead(String newBalance);

}
} 
```

This is MyBalance Fragment which has TextView that needs to be updated whenever NFC is read:

```
public class MyBalance extends Fragment implements NewBalanceListener {

private TextView mybalance_value;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    //Other onCreateView related code

    Bundle bundle = this.getArguments();
    if (bundle != null)
        mybalance_value.setText(bundle.getString(Keys.BALANCE.toString(),
                "0.00"));
    else
        mybalance_value.setText("0.00");

    //Other onCreateView related code
}

@Override
public void onNewBalanceRead(String newBalance) {
    mybalance_value.setText(newBalance);
}
} 
```

This code works perfectly like expected for my application but, I want to know if there is better way to handle new Intent from Fragments?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-10-19T18:39:39.987

这是一个老问题，但让我回答一下，以防有人碰到它。

首先，您的代码中有一个错误：

您不能按照自己的方式注册`Fragments`为听众`Activity`。原因是`Activity`and`Fragments`可以被系统销毁并在以后从保存的状态重新创建（请参阅有关重新创建[Activity 的](https://developer.android.com/training/basics/activity-lifecycle/recreating.html)文档）。发生这种情况时，将创建the`Activity`和 the 的新实例，但将 设置为侦听器的代码将不会运行，因此永远不会被调用。这是 Android 应用程序中非常常见的错误。`Fragment``Fragment``onNewBalanceRead()`

为了传达来自`Activity`to的事件，`Fragment`我看到至少有两种可能的方法：

**基于接口：**

Fragments 之间有[一种官方推荐的通信方式](https://developer.android.com/training/basics/fragments/communicating.html)。这种方法类似于您现在所做的，因为它使用由`Fragment`or实现的回调接口`Activity`，但它的缺点是紧密耦合和大量丑陋的代码。

**基于事件总线：**

更好的方法（恕我直言）是利用事件总线-“主组件”（`Activity`在您的情况下）将“更新”事件发布到事件总线，而“从属组件”（`Fragment`在您的情况下）将自身注册到事件总线`onStart()`（取消注册in `onStop()`) 以接收这些事件。这是一种更简洁的方法，不会在通信组件之间添加任何耦合。

我所有的项目都使用[Green Robot 的 EventBus](https://github.com/greenrobot/EventBus)，我不能高度推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-23T15:17:27.157

至少有一种选择：来自[Activity.onNewIntent 文档](https://developer.android.com/reference/android/app/Activity.html#onNewIntent(android.content.Intent))：

> 在接收到新意图之前，活动将始终暂停，因此您可以指望在此方法之后调用 onResume()。
> 
> 请注意，getIntent() 仍然返回原始 Intent。您可以使用 setIntent(Intent) 将其更新为这个新的 Intent。

[FragmentActivity.onNewIntent 文档](https://developer.android.com/reference/android/support/v4/app/FragmentActivity.html#onNewIntent(android.content.Intent))有所不同，但我不认为它与上述陈述相矛盾。我还假设[Fragment.onResume](https://developer.android.com/reference/android/app/Fragment.html#onResume())将在[FragmentActivity.onResume](https://developer.android.com/reference/android/support/v4/app/FragmentActivity.html#onResume())之后调用，尽管文档对我来说似乎有点挑剔，尽管我的测试证实了这个假设。基于此，我像这样更新了活动中的 Intent（Kotlin 中的示例）

```
override fun onNewIntent(intent: Intent?) {
    setIntent(intent)
    super.onNewIntent(intent)
} 
```

在 Fragment.onResume 我可以像这样处理新意图

```
override fun onResume() {
    super.onResume()
    doStuff(activity.intent)
} 
```

这样，活动就不需要知道它拥有哪些片段。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-10-27T09:42:19.500

不，没有更好的办法。片段可以比活动更长寿，并且根本不一定与它们绑定，因此提供新的意图是没有意义的。

顺便说一句，您的代码中有一些错误:)

```
if (actionBar.getSelectedNavigationIndex() != 1) { 
```

魔术数字很糟糕！使用常数。

```
 if (myBalanceBundle == null)
        myBalanceBundle = new Bundle();

    myBalanceBundle.putString(Keys.BALANCE.toString(), balance);
    actionBar.setSelectedNavigationItem(1); 
```

我们已经知道navigationitem设置为1

```
} else {
    newBlanceListener.onNewBalanceRead(balance); 
```

添加空检查。用户可能从未选择过导航项。

# ios - How to adjust the view objects in a view in ios?

> ID：15456879
> 
> 赞同：0
> 
> 时间：2013-03-17T02:12:03.820
> 
> 标签：ios

I'm new to ios app development. In a sample login page there are many view objects in a view.When i try to edit the textfields at the bottom of the screen, the keyboard is appeared and it is over the view object that i need to edit.So, the view object is covered with keyboard itself. How to view all the view objects at the bottom of the screen properly even if keyboard is appeared.? Thanks in Advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:21:52.170

添加滚动视图，在其上显示您的控件，添加键盘通知，调整滚动内容。

一个很好的文件可以[在这里找到](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-keeping-content-from-underneath-the-keyboard/)

```
 - (void)viewDidLoad
{
    @try
    {
        [super viewDidLoad];

        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(keyboardWasShown:)
                                                     name:UIKeyboardDidShowNotification
                                                   object:nil];

        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(keyboardWillHide:)
                                                     name:UIKeyboardWillHideNotification
                                                   object:nil];

    }
    @catch (NSException *exception)
    {
        NSLog(@"%s\n exception: Name- %@ Reason->%@", __PRETTY_FUNCTION__,[exception name],[exception reason]);
    }

}
- (void)keyboardWasShown:(NSNotification *)notification
{

    @try
    {
        // Step 1: Get the size of the keyboard.
        CGSize keyboardSizePotriat = [[[notification userInfo] objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue].size;

        CGSize keyboardSize = {keyboardSizePotriat.height,keyboardSizePotriat.width};

        // Step 2: Adjust the bottom content inset of your scroll view by the keyboard height.
        UIEdgeInsets contentInsets = UIEdgeInsetsMake(0.0, 0.0, keyboardSize.height, 0.0);
        self.theScrollView.contentInset = contentInsets;
        self.theScrollView.scrollIndicatorInsets = contentInsets;

        CGPoint scrollPoint = CGPointMake(0.0, self.txtMRN.frame.origin.y - (keyboardSize.height - 45));

        [self.theScrollView setContentOffset:scrollPoint animated:YES];

    }
    @catch (NSException *exception)
    {
        NSLog(@"%s\n exception: Name- %@ Reason->%@", __PRETTY_FUNCTION__,[exception name],[exception reason]);
    }

}

- (void) keyboardWillHide:(NSNotification *)notification
{
    @try
    {
        UIEdgeInsets contentInsets = UIEdgeInsetsZero;
        self.theScrollView.contentInset = contentInsets;
        self.theScrollView.scrollIndicatorInsets = contentInsets;

    }
    @catch (NSException *exception)
    {
        NSLog(@"%s\n exception: Name- %@ Reason->%@", __PRETTY_FUNCTION__,[exception name],[exception reason]);
    } 
} 
```

# opengl-es - Writing to gl_FragColor causes glUseProgram to throw GL_INVALID_OPERATION

> ID：15456880
> 
> 赞同：0
> 
> 时间：2013-03-17T02:12:37.750
> 
> 标签：opengl-es, glsl, glsles

I'm trying to write a blur filter in GLSL ES 2.0 and I'm getting an Error with the line assigning gl_FragColor. I've not been able to figure out why

```
#extension GL_OES_EGL_image_external : require
precision mediump float;
varying vec2 textureCoordinate;
uniform samplerExternalOES s_texture;
void main() {
  float gaus[25] = float[25](0.01739, 0.03478, 0.04347, 0.03478, 0.01739,
                             0.03478, 0.07282, 0.10434, 0.07282, 0.03478,
                             0.04347, 0.10434, 0.13043, 0.10434, 0.04347,
                             0.03478, 0.07282, 0.10434, 0.07282, 0.03478,
                             0.01739, 0.03478, 0.04347, 0.03478, 0.01739);
  float offset[5] = float[5](-2.0, -1.0, 0.0, 1.0, 2.0);
  vec4 outSum = vec4(0.0);
  int rowi = 0;
  for(int i = 0; i < 5; i++){
    vec4 inSum = vec4(0.0);
    for(int j = 0; j < 5; j++){
      inSum += texture2D(s_texture, textureCoordinate + vec2(offset[i], offset[j]))*gaus[j*5+i];
    }
    outSum += inSum*gaus[rowi+i];
    rowi += 3;
  }
  gl_FragColor = outSum;
} 
```

The assignment of `gl_FragColor` causes calls to `glUseProgram` to error with `GL_INVALID_OPERATION`. I've tried this without it and it compiles and operates without the error. I'm hoping someone can point me in a direction i haven't looked yet at least because I can't see any reason this isn't working.

EDIT: I solved this. As best I can tell the GLSL-ES on android doesn't allow indexing arrays with non-constant variables. GLSE-ES 2.0 specification page 97 10.25 states it's not directly supported by all implementations and on page 109 it states that loop indices can be considered constant-expressions but not must. I rolled out my loop and it's linking fine now.

Thank you everyone who responded, I was able to narrow this down thanks to your insight.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T05:54:42.143

如果删除这些行会发生什么？

```
uniform float gaus[25];
uniform float offset[5]; 
```

gaus 和 offset 不是统一的。在 main() 中为它们分配了常量值。而且我认为您不应该声明与制服同名的变量。

我记得读过在编译着色器时，编译器非常擅长从着色器中剥离不必要的代码。当你离开线路时

```
gl_FragColor = outSum; 
```

或分配

```
texture2D(s_texture, textureCoordinate) 
```

对于gl_FragColor，gaus和offset不用于计算gl_FragColor的最终值，所以有可能它们被剥离掉，变量命名冲突不会发生。当你将outSum赋值给gl_FragColor时，使用gaus和offset来计算outSum，所以它们没有被剥离，会发生命名冲突，导致错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T08:26:32.017

`glUseProgram`只能在以下情况下抛出`GL_INVALID_OPERATION`：

1.  该程序不是有效的程序对象。
2.  该程序的最后一个链接操作不成功。

显然，您对该变量的写入导致了您未检测到的着色器编译或链接错误。所以开始捕捉你的编译器/链接器错误，而不是忽略它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-24T19:39:26.210

这更像是对尼科尔答案的延伸。

我遇到了同样的问题，结果发现程序的链接失败了。不幸的是`glGetError`after`glLinkProgram`没有返回错误，我最终没有抓住它。我添加了以下内容，帮助我在链接后记录错误，并且非常有用。

```
GLint logLength;
glGetProgramiv( program_id, GL_INFO_LOG_LENGTH, &logLength );
if ( logLength > 0 )
{
    char* log = new char[ logLength + 1 ];
    log[ logLength ] = '\0';
    glGetProgramInfoLog( program_id, logLength, &logLength, log );
    Dbg_Printf( "OpenGL Program Link Log:\n%s\n", log );
    delete[] log;
} 
```

顺便说一句，在我的情况下，我超出了顶点着色器中支持的属性数量。

# python - how ineffecient is it using Popen with pipes vs mysql module in python?

> ID：15456881
> 
> 赞同：1
> 
> 时间：2013-03-17T02:12:44.537
> 
> 标签：python

i am doing a data migration and i am doing the code below in several places. it was migrated some what from some bash stuff so it works, but wondering if it's more efficient to be using the mysql module, thanks.

```
 p1 = Popen(["echo", query], stdout=PIPE, close_fds=True)

    p2 = Popen(["mysql", "--host=host", "--port=3999",
        "-u", "user", "--password=foo", "--protocol=TCP"],
        stdin=p1.stdout, stdout=PIPE, close_fds=True)

    p1.stdout.close() 
```

`

```
p1 = Popen(["echo", "show columns from %s" % (table)], stdout=PIPE,
        close_fds=True)

p2 = Popen(["mysql", "--host=host", "--port=3999",
    "-u", "user", "--password=foo", "--protocol=TCP"],
    stdin=p1.stdout, stdout=PIPE, close_fds=True)

p3 = Popen(["awk", "{print $1}"], stdin=p2.stdout, stdout=PIPE,
        close_fds=True) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T03:13:56.230

这取决于你想要做什么。如果您不需要在 Python 中处理结果，那么实际上使用 subprocess 可能会更快。

![在此处输入图像描述](../Images/0cb4d7741c4692197ac485d5c2956f79.png)

在此图上，y 轴以秒为单位，x 轴表示所选数据的行数。

请注意，比较并不完全公平： `using_subprocess`返回一个字符串，而`using_mysqldb`返回一个元组列表。Python 创建这些 Python 对象所花费的额外时间肯定至少部分解释了速度上的差异。

* * *

没有令人信服的理由在 Python 中使用`subprocess`. 你最好只写一个shell脚本。

如果您需要使用 Python 来处理返回的**字符串，那么您可以使用**[sh 模块](http://pypi.python.org/pypi/sh/)`mysql`使代码更具可读性，而不是.`subprocess`

* * *

```
import config
import subprocess
import shlex
import timeit
import MySQLdb
import collections
import matplotlib.pyplot as plt

Popen = subprocess.Popen
PIPE = subprocess.PIPE
sql = 'select * from table limit {n}'

def using_subprocess(n):
    p1 = Popen(
        shlex.split(
            'echo {s}'.format(s=sql.format(n=n))), stdout=PIPE, close_fds=True)

    p2 = Popen(
        shlex.split(
            'mysql --host={h} -u {u} --password={p} --database={d}'.format(
                h=config.HOST,
                u=config.USER,
                p=config.PASS,
                d=config.MYDB
                )),
        stdin=p1.stdout, stdout=PIPE, close_fds=True)

    p1.stdout.close()
    out, err = p2.communicate()
    return out

def using_mysqldb(n):
    connection = MySQLdb.connect(
        host = config.HOST, user = config.USER,
        passwd = config.PASS, db = config.MYDB)
    cursor = connection.cursor()

    cursor.execute(sql.format(n=n))
    rows = cursor.fetchall()
    return rows

times = collections.defaultdict(list)
ns = [10**i for i in range(5)]
for n in ns:
    times['using_mysqldb'].append(
        timeit.timeit('m.using_mysqldb({n})'.format(n=n),
                      'import __main__ as m',
                      number = 10))
    times['using_subprocess'].append(
        timeit.timeit('m.using_subprocess({n})'.format(n=n),
                      'import __main__ as m',
                      number = 10))

for name, time in times.iteritems():
    plt.plot(ns, time, label=name)
    # print('{n}: {t}'.format(n=name, t=time))
plt.legend(loc='best')
plt.show() 
```

# jquery - How to remove a class with click function after it has been added with jquery

> ID：15456883
> 
> 赞同：0
> 
> 时间：2013-03-17T02:13:07.973
> 
> 标签：jquery

I am new to jquery but I have been learning a lot lately. I am trying to add a class to a div with a click handler and then remove it when it is selected. Not sure if this is the best method as I am having trouble with it. Maybe toggleClass would be a better solution?

Here is the html:

```
 <nav>
        <div class="container">
            <a class="toggleMenu" href="#">Menu</a>
                <ul class="nav">
                    <li><a href="index.html">Barnes</a></li>

                    <li><a href="craig.html">Craig</a></li>

                    <li><a href="bennie-donna.html">Bennie & Donna</a></li>

                    <li><a href="peggy.html">Peggy</a></li>

                    <li><a href="tina.html">Tina</a></li>

                    <li><a href="bennie.html">Bennie</a></li>

                    <li><a href="debbie.html">Debbie</a></li>

                    <li><a href="david.html">David</a></li>

                </ul> 
        </div>  
    </nav> 

<div class="photos-wrap">
        <div class="photos">
            <img src="images/bennie/image1.jpg" alt="pic"/>
            <img src="images/bennie/image2.jpg" alt="pic"/>
            <img src="images/bennie/image3.jpg" alt="pic"/>
            <img src="images/bennie/image4.jpg" alt="pic"/>
            <img src="images/bennie/image5.jpg" alt="pic"/>
            <img src="images/bennie/image6.jpg" alt="pic"/>
            <img src="images/bennie/image7.jpg" alt="pic"/>
            <img src="images/bennie/image8.jpg" alt="pic"/>
            <img src="images/bennie/image9.jpg" alt="pic"/>
            <img src="images/bennie/image10.jpg" alt="pic"/>
        </div>
    </div> 
```

Here is the minimal css:

```
.photos-wrap {
    position:absolute;
    top:400px;
}

.photos {
    margin:0 auto;
    width:60%;
    padding-bottom: 300px;
}

.photos img {
    position: relative;
    margin:-20px;
}

.toggleMenu {
    display:  none;
    background: #175E4C;
    text-decoration: none;
    padding: 10px 15px;
    color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
    border: rgba(0, 0, 0, 0.8);

     -webkit-border-radius: 5px;
     -moz-border-radius: 5px;
     border-radius: 5px;

     background-image: linear-gradient(bottom, #175E4C 45%, #7BB5A5 100%);
    background-image: -o-linear-gradient(bottom, #175E4C 45%, #7BB5A5 100%);
    background-image: -moz-linear-gradient(bottom, #175E4C 45%, #7BB5A5 100%);
    background-image: -webkit-linear-gradient(bottom, #175E4C 45%, #7BB5A5 100%);
    background-image: -ms-linear-gradient(bottom, #175E4C 45%, #7BB5A5 100%);

    background-image: -webkit-gradient(
    linear,
    left bottom,
    left top,
    color-stop(0.45, #175E4C),
    color-stop(1, #7BB5A5)
);
}

.drop-down {
    margin-top:280px;

And lastly the jquery:

$('.toggleMenu').click(function(){
    $('.photos-wrap').addClass('drop-down');

    }); 
```

This enables me to add the class 'drop-down' to the .photos div by clicking on the .toggleMenu. I want to remove the 'drop-down' class when the .toggleMenu is clicked again.

Anyone know how to accomplish this? Need help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:17:58.397

试一试：

```
 $('.toggleMenu').click(function(){
        $('.photos-wrap').toggleClass('drop-down');
    }); 
```

有趣的是，您在帖子中提到了这一点。你应该听自己的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:18:09.350

您可以尝试`toggleClass()`：

```
$('.container').on('click', '.toggleMenu', function(){
   $('.photos').toggleClass('drop-down');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T02:18:28.713

在您的点击处理程序中，只需使用`toggleClass()`而不是`addClass()`

[看](http://api.jquery.com/toggleClass/)

# java - How to change the specific text color in a same cell of excel sheet using apache poi?

> ID：15456884
> 
> 赞同：10
> 
> 时间：2013-03-17T02:13:11.833
> 
> 标签：java, excel, apache-poi

Does anyone know how to change the color of the particular text of a cell in excel. I am using apache poi and I could find out to change the text color of entire cell. But I want only a particular text.

Eg: Cell A1 has Hello World I want "Hello" to be in blue and "World" to be in green. How do I do this?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-17T03:02:08.777

The key is using the [HSSFRichTextString](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFRichTextString.html) object to set the value of the cell. This object has an [applyFont](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFRichTextString.html#applyFont%28int,%20int,%20org.apache.poi.ss.usermodel.Font%29) method which accepts a startingIndex, endingIndex and a Font. Thus, you can create fonts having the colors you want, then apply them to parts of the cell value using applyFont().

Here is some example code I cobbled together (completely untested):

```
// Set up a rudimentary worksheet with a cell in it
HSSFWorkbook wb = new HSSFWorkbook();
HSSFSheet sheet = wb.createSheet(“sheet1”);
HSSFRow row = sheet.createRow(0);
HSSFCell cell = row.createCell(0);

// Set up fonts
HSSFFont blueFont = workbook.createFont();
blueFont.setColor(HSSFColor.BLUE.index);

HSSFFont greenFont = workbook.createFont();
greenFont.setColor(HSSFColor.GREEN.index);

// create a cell style and assign the first font to it
HSSFCellStyle style = workbook.createCellStyle();
style.setFont(blueFont);

// assign the style to the cell
cell.setCellStyle(style);

// override the parts of the text that you want to
// color differently by applying a different font.
HSSFRichTextString richString = new HSSFRichTextString("Hello, World!");
richString.applyFont(6, 13, greenFont);
cell.setCellValue(richString); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T09:51:01.290

首先创建一个风格

```
//////////////////////Excel Header Style/////////////////////////   
        HSSFCellStyle headerlabelcs = wb.createCellStyle();
        headerlabelcs.setFillForegroundColor(HSSFColor.PALE_BLUE.index);
        headerlabelcs.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);
        headerlabelcs.setBorderLeft((short)1);
        headerlabelcs.setBorderRight((short)1);

        HSSFFont headerlabelfont = wb.createFont();
        headerlabelfont.setFontHeightInPoints((short)12);
        headerlabelfont.setFontName("Calibri");
        headerlabelfont.setColor(HSSFColor.BLACK.index);
        headerlabelfont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);
        headerlabelcs.setFont(headerlabelfont); 
                //////////////////////Excel Header Style///////////////////////// 
```

add 然后这一行将添加到您的代码中

```
sheet.getRow(rowIndex).getCell(0).setCellStyle(headerlabelcs); 
```

# php - 如何区分 SELECT 查询中的大写或小写单词

> ID：15456885
> 
> 赞同：2
> 
> 时间：2013-03-17T02:13:21.160
> 
> 标签：php, mysql, select

基本上我觉得问题很简单。但找不到任何解决方法。

在登录表单中，我使用 php 查询我的数据库，该数据库通过从数据库表中选择具有这 2 个值的任何行来检查传递的用户名和密码。

问题似乎是当我登录前。

> 用户：mm
> 
> 通过：oo

这样可行。这是正确的，因为它们在 db 表上。

但现在如果我使用

> 用户：MM
> 
> 通过：oo

还能用吗？？这不应该。因为我的数据库只有“mm”而不是“MM”的用户。我需要它来区分大写和小写，因为在其他行中我混合了大写和小写字母

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T02:14:19.570

您必须将列的排序规则/编码从“不区分大小写”编码更改为区分大小写的编码，例如`utf8_general_cs`或`latin1_general_cs`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T03:30:44.747

您需要使用区分大小写的编码

> 从[**10.1.2 开始。MySQL 中的字符集和排序规则**](http://dev.mysql.com/doc/refman/5.6/en/charset-mysql.html)
> 
> 排序规则名称有一个约定：它们以与之关联的字符集的名称开头，通常包含语言名称，并以 _ci（不区分大小写）、_cs（区分大小写）或 _bin（二进制）。

所以使用区分大小写，例如`utf8_general_cs`或`latin1_general_cs`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T03:40:30.007

您可以使用查询更新表：

```
ALTER TABLE `your_table`  CHARSET=latin1 COLLATE=latin1_general_cs; 
```

在它说`latin1_general_cs`的地方，`cs`指定它是区分大小写的。如果您以后希望它不区分大小写，则可以使用以下查询：

```
ALTER TABLE `your_table`  CHARSET=latin1 COLLATE=latin1_general_ci; 
```

指定`ci`它不区分大小写。

# c++ - 带括号和不带括号的 C++ 类初始化

> ID：15456887
> 
> 赞同：8
> 
> 时间：2013-03-17T02:13:37.633
> 
> 标签：c++, initialization

以下2个两次初始化有什么区别？

```
class Pod {
public:
    int a, b;
};

Pod *p1 = new Pod;
Pod *p2 = new Pod(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-17T02:16:51.270

在第一种情况下，对象未初始化，而在第二种情况下，对象保证为*value-initialized*，在这种情况下，类型为 POD 意味着*零初始化*

# erlang - 我可以使用模块池来决定负载平衡吗？

> ID：15456897
> 
> 赞同：3
> 
> 时间：2013-03-17T02:16:05.633
> 
> 标签：erlang

我正在寻找一种自动方式来进行负载平衡，这个模块吸引了我。

正如手册所说，

> pool 可用于运行一组 Erlang 节点作为计算处理器池。它被组织为一个主节点和一组从节点，并包括以下功能：
> 
> *   从节点定期向主节点发送有关其当前负载的报告。
> *   可以向主节点发送查询以确定哪个节点的负载最小。
> 
> BIF 统计信息（run_queue）用于估计未来的负载。它返回 Erlang 运行时系统中准备运行进程的队列长度。

从节点发送定期报告的频率和负载是多少？

这是进行负载平衡的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T16:19:05.380

报告[每 2 秒](https://github.com/erlang/otp/blob/maint/lib/stdlib/src/pool.erl#l218)发送一次，并使用从中收集的信息`statistics(run_queue)`来确定负载最小的节点。`run_queue`返回当前节点调度器的队列大小。

当您调用时，`pool:get_node/0`您将获得等待在其调度程序上执行的任务数量最少的节点。请记住，节点按排序顺序保存，因此调用`pool:get_node/0`不会直接查询节点，而是依赖可能长达 2 秒的信息。

如果您需要一个负载平衡的节点池，`pool`效果很好。

以下是 pool.erl 来源的更多信息：

```
%% Supplies a computational pool of processors.
%% The chief user interface function here is get_node()
%% Which returns the name of the nodes in the pool
%% with the least load !!!!
%% This function is callable from any node including the master
%% That is part of the pool
%% nodes are scheduled on a per usgae basis and per load basis,
%% Whenever we use a node, we put at the end of the queue, and whenever
%% a node report a change in load, we insert it accordingly 
```

# java - ArrayList 相等 JUnit 测试

> ID：15456910
> 
> 赞同：26
> 
> 时间：2013-03-17T02:18:37.917
> 
> 标签：java, junit

我想使用`assertArrayEquals(ArrayList<Token>, ArrayList<Token>)`这些参数（即标记的arrayList）。但是 Java 告诉我我需要创建这样一个方法。有没有办法测试 Junit 中任何类型的两个数组列表的相等性？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-17T02:59:02.010

> 我想使用`assertArrayEquals(ArrayList<Token>, ArrayList<Token>)`这些参数（即标记的arrayList）。但是 Java 告诉我我需要创建这样一个方法。

它告诉您需要创建该方法，因为 JUnit 库中没有这样的方法。JUnit 库中没有这样的方法，因为*它*`assertArrayEquals`用于比较*数组*，并且`ArrayList`不是数组——它是一个.*`List`*

 *> 有没有办法测试 Junit 中任何类型的两个数组列表的相等性？

`ArrayLists`您可以使用 来检查两个（实际上是任何两个`List`对象）的相等性[`equals`](http://docs.oracle.com/javase/6/docs/api/java/util/AbstractList.html#equals%28java.lang.Object%29)，因此您应该能够使用 JUnit 的`assertEquals`方法并且它会正常工作。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-09-18T12:41:58.020

您可能想要使用的是`void org.junit.Assert.assertArrayEquals(Object[] expecteds, Object[] actuals)`. 您只需要使用`toArray()`方法将 List 转换为数组，如下所示：

```
ArrayList<Token> list1 = buildListOne(); // retrieve or build list
ArrayList<Token> list2 = buildListTwo(); // retrieve or build other list with same items

assertArrayEquals(list1.toArray(), list2.toArray()); 
```

不要忘记导入这个断言。

```
import static org.junit.Assert.assertArrayEquals; 
```

但这种方法仅在两个列表中的项目具有相同顺序时才有效。如果无法保证顺序，则需要使用`Collections.sort()`方法对列表进行排序，但您的对象需要`java.util.Comparable`使用一种方法实现接口`int compareTo(T o)`。

PS：另一种可能的解决方案是使用 assertEquals 并将您的列表包装到 Set 中，如下所示：

```
assertEquals(new HashSet<Token>(list1), new HashSet<Token>(list2)); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-11-18T19:42:59.723

想象一下`myArraylist`是一个包​​含内容的数组列表`"one", "two", "three"`

这工作正常：

```
 List<String> categories = asList("one", "two", "three");
 assertTrue(myArraylist.equals(categories)); 
```

不要忘记导入：`import static java.util.Arrays.asList;`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-17T04:15:21.120

尝试

```
Assert.assertEquals(Object expected, Object actual); 
```

它适用于 Collections

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-08-15T16:54:17.710

您可以覆盖元素类型的“equals”或“hashcode”方法，例如：ArralyList、ArrayList -（原始数据类型或自定义数据元素），您可以覆盖该方法，并比较该方法中的所有数据并返回 true/相应地为假。

然后，您可以直接将 assertEquals(arraylist1 , arraylist2) 用于您的 junit 测试。

下面是示例对象类

```
public class Customer {
String name;
int age;

@Override
public boolean equals(Object obj) {
    if(this == obj)
        return true;

    // it checks if the argument is of the type Customer by comparing the classes
    // of the passed argument and this object.
    // if(!(obj instanceof Customer)) return false; ---> avoid.
    if(obj == null || obj.getClass()!= this.getClass())
        return false;

    // type casting of the argument.
    Customer customer = (Customer) obj;
    if(customer.getName().equals(this.name) &&
            (customer.getAge() == this.age))
        return true;

    return false;
}
public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
}

public int getAge() {
    return age;
}

public void setAge(int age) {
    this.age = age;
} 
```

}

下面是 Junit 测试的示例类：

```
public class CustomerTest {

@Test
public void testCustomerMatch() {

    ArrayList<Customer> expectedCustomerListOutput; // add your data in this list
    ArrayList<Customer> actualCustomerListOutput;// add your data in this list

    //used the overridden equal method of trade objects
    assertEquals(expectedTradeOutput, actualTradeMatchList);
} 
```

}

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-17T02:22:47.737

如果您使用一些现成的 junit 框架，例如 unitils 等，它们具有诸如 assertReflectionEquals 之类的方法（类似于其他框架），您可以在其中使用任何两个对象反射。如果您不使用任何第三方 junit 框架，您可以编写自己的类似通用方法。*

# java - 为什么'import mmap'在jython中抛出ImportError

> ID：15456911
> 
> 赞同：0
> 
> 时间：2013-03-17T02:18:57.197
> 
> 标签：java, python, jython

我是 python 和 jython 的新手。我在 python 中有一个导入**mmap**的脚本，它工作正常，没有任何问题。我需要从 java 类调用该脚本中的一个函数，该函数在执行时会引发以下异常。

```
Exception in thread "main" 
Traceback (most recent call last):
    File "<string>", line 1, in <module>
ImportError: No module named mmap 
```

我在 jython 中执行了相同的脚本，这给了我以下错误。

```
C:\jython2.5.3>jython.bat d:\Python\AddConfToFile.py
Traceback (most recent call last):
  File "d:\Python\AddConfToFile.py", line 9, in <module>
    import mmap
ImportError: No module named mmap 
```

我无法通过 Google 找到任何建议。我在这里错过了什么吗，请帮我解决这个问题。

提前致谢

阿迪提扬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:38:49.620

该`mmap`模块在 Jython 下不可用。您将需要找到替代方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:57:17.180

这只是因为 Jython 仍然不支持 mmap。正如[官方网站的常见问题解答中所述](http://www.jython.org/faq3.html "官网常见问题解答")，在下面的段落中：

> 我们不支持并且可能不支持的模块包括 bsddb3、curses、dbm、gdbm、ioctl、***mmap***、pty、Tkinter 和 win32reg。其中一些可能很容易实现，例如将 curses 模块映射到 CHARVA，但由于资源有限，不太可能进行。（欢迎投稿！）

# iphone - 当我尝试创建一个新单元格时，UITableview 上的所有单元格都会发生变化

> ID：15456912
> 
> 赞同：0
> 
> 时间：2013-03-17T02:18:58.103
> 
> 标签：iphone, ios, objective-c, uitableview

我正在尝试创建一个 iOS 应用程序，其中我必须有一个 UITableView ，每次我按下一个新的输入按钮时，当我按下该按钮时，都会出现一个新单元格。我的问题是，每次我按下按钮时，不仅创建的单元格显示当前时间，而且它上面的单元格显示不同的时间，重新加载并显示当前时间。为了更好地解释它，如果我在 8:05、9:01 和 9:10 按下按钮，我希望 UITableView 显示：

```
-8:05
-9:01
-9:10 
```

相反，它显示：

```
-9:10
-9:10
-9:10. 
```

我该怎么办？？谢谢

这是我的代码（ newEntry 是按钮，brain 是一个对象，我有方法获取当前时间）

```
@implementation MarcaPontoViewController{

    NSMutableArray *_entryArray;
@synthesize brain=_brain;

- (void)viewDidLoad
{
    [super viewDidLoad];
    _brain = [[Brain alloc] init];
    _entryArray = [[NSMutableArray alloc] init];

    //[self updateTime];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
    return 1;
    }

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [_entryArray count];
}

- (UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *CellIdentifier= @"myCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = [_entryArray lastObject];
           }

    return cell;
}

- (IBAction)newEntry:(id)sender {

    [_entryArray addObject:[self.brain currentTime]];

    [_timeTable reloadData];

}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:21:48.830

您的问题在这一行：

```
 cell.textLabel.text = [_entryArray lastObject]; 
```

您需要使用：

```
cell.textLabel.text = [_entryArray objectAtIndex:indexPath.row]; 
```

或者，

```
cell.textLabel.text = _entryArray[indexPath.row]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T02:40:17.253

该行`cell.textLabel.text = [_entryArray lastObject]`只会返回数组中的最后一个对象，这就是为什么您会看到相同的时间重复。将其更改为：

```
// in cellForRowAtIndexPath:
cell.textLabel.text = [_entryArray objectAtIndex:indexPath.row]; 
```

这应该可以解决根本问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T02:42:08.780

[_entryArray lastObject] 总是给出最后返回的对象。

采用

```
cell.textLabel.text = [_entryArray objectAtIndex: indexPath.row]; 
```

# c++ - 以下情况应该如何控制对多个队列的多线程访问？

> ID：15456915
> 
> 赞同：2
> 
> 时间：2013-03-17T02:19:45.877
> 
> 标签：c++, posix, mutex, semaphore, condition-variable

我正在使用 C++ 开发一个多线程项目，该项目将数据发送到一系列网络连接。这是一些伪代码，说明了正在发生的事情：

```
class NetworkManager
{
    Thread    writer;      // responsible for writing data in queues to the network
    Queue[]   outqueue;    // holds data until the network is ready to receive it
    Network[] nets;        // sockets or whatever
    Mutex[]   outlock;     // protects access to members of outqueue
    Mutex     managerlock; // protects access to all queues
    Condition notifier;    // blocks the write thread when there is no data
} 
```

实际上它比这要复杂得多，但我已经删除了很多不必要的细节。一个重要的细节是网络是有速率限制的，程序独立于发送数据排队的能力是设计的一个特点（程序不应该等待处理新数据，因为它阻塞了网络写入）。

这里简要描述了程序如何与这个类进行交互。请注意，`QueueWriteToNetwork`并且`DoAdministrativeStuff`在我的实现中，由相同的外部线程管理。

```
QueueWriteToNetwork(network, data) // responsibility of external thread
    Let i = the index of the network to send to
    Lock(outlock[i])
    outqueue[i].Add(data)
    Unlock(outlock[i])
    Signal(notifier)

DoAdministrativeStuff(network, more) // responsibility of external thread
    Lock(managerlock)
    more.Process() // might do any of the following:
                   // connect or disconnect networks
                   // add or remove networks from list
                   // immediate write data to network, bypassing rate limiting
                   // other things that I forgot
    Unlock(managerlock)

WriterThreadMain() // responsibility of internal write thread
    Lock(managerlock)
    Loop forever:
        Check for data in every queue (locking and unlocking each queue)
        If all queues have no data to write:
            Wait(notifier, managerlock)
            continue
        If outqueue[i] has data ready to write
            Lock(outlock[i])
            Send data from outqueue[i]
            outqueue[i].Pop()
            Unlock(outqueue[i]) 
```

正如您可能看到的那样，这种方法存在一些问题（例如，如果写入排队到网络并`QueueWriteToNetwork`检查`WriterThreadMain`队列是否为空，则调用`Signal(notifier)`可能会被丢弃，并且写入队列即使有数据准备好也可以保持等待）。

我需要以这样一种方式来表达这一点，以便以下内容成为可能：

*   将数据添加到写入队列不会阻塞，或者仅在相当短的时间内阻塞（具体来说，它不会在正在进行的网络写入期间阻塞）
*   该`DoAdministrativeStuff`函数必须有能力确保写入线程在安全状态下被阻塞（即不访问任何队列、队列锁或网络）

我已经探索了使用信号量来跟踪写入队列中的项目数的可能性。这将解决我之前提到的丢失更新问题。

最后，我的目标是 Linux（使用 Posix 库来提供类型`pthread_t`、`pthread_mutex_t`、`pthread_cond_t`和`sem_t`），我不关心与 Windows 的兼容性。另外，请不要推荐Boost。将任何 Boost 标头拉入我的代码会使编译时间过长。

# html - 如果悬停另一个元素，则悬停元素

> ID：15456917
> 
> 赞同：3
> 
> 时间：2013-03-17T02:20:33.137
> 
> 标签：html, css

我环顾四周，但找不到正确的答案......如何将一个元素设置为悬停，假设另一个元素悬停？

假设“选择器”悬停，它将悬停，框 1+2 等...

[http://jsfiddle.net/wgJRQ/](http://jsfiddle.net/wgJRQ/)

```
<div id="table">
<div id="row">
    <div id="selector">selector 1</div>
    <div id="selector2">selector 2</div>
</div>
<br />
<div id="row">
    <div id="box1">box 1</div>
    <div id="box2">box 2</div>
</div>
<div id="row">
    <div id="box3">box 3</div>
    <div id="box4">box 4</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:42:06.430

尝试类似的东西

```
#box1:hover, #box1:hover~#box2 {
    display: table-cell;
    background-color:#FFFFFF;
    border:2px solid #666666;
    text-align: center;
    vertical-align: middle;
} 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/wgJRQ/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T03:05:58.447

jQuery：

```
$('#table > div:first > div')
    .hover(function() {
        $('#table').children('div')
            .eq($(this).index() + 1)
            .children('div')
            .toggleClass('active');
        return false;
    }); 
```

[http://jsfiddle.net/samliew/pyY5u/](http://jsfiddle.net/samliew/pyY5u/)

您可能希望优化悬停状态并将其减少为单个声明，如下所示：

```
#table > div:nth-child(n+1) > div {
    border:2px solid #FFFFFF;
    display: table-cell;
    text-align: center;
    vertical-align: middle;
    width: 100px;
}
#table > div:nth-child(n+1) > div:hover,
#table > div:nth-child(n+1) > div.active {
    background-color:#FFFFFF;
    border:2px solid #666666;
}
#box1, #box2 {
    background-color:#E07586;
}
#box3, #box4 {
    background-color:#837C71;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T10:13:38.407

使用 CSS，您只能在“目标”元素位于被悬停的元素内时执行此操作。

在您的情况下，您应该将布局更改为按列而不是按行排列，以便在选择器 1***内***有框 1 和框 2。这样，当您将鼠标悬停在其选择器上时，您可以更改框 1 的外观：`.selector:hover .box1 {...}`

如果你不能做到这一点，那么你将不得不使用 Javascript。

请记住，您不能`:hover`使用 Javascript 触发，您必须在鼠标进入选择器时向框添加一个类，并在退出选择器时删除该类。

# java - 无法打印出最小零钱算法中使用的面额

> ID：15456919
> 
> 赞同：1
> 
> 时间：2013-03-17T02:20:59.050
> 
> 标签：java, dynamic, recursion, dynamic-programming, coin-change

所以我写了一个递归算法来解决一个问题，即找出一组特定面额的“硬币”的最少数量，以达到给定的总和。该算法似乎有效，但因为它是递归的，并且在选择一个或另一个之前计算每个可能的选项，我很难想出一种方法来打印出所使用的面额。所以基本上我可以计算出可能使用的最少硬币数量，但不能计算它们是*哪些*硬币。这是我用来驱动它的代码和小主要方法。任何简化算法本身的建议也将受到欢迎。

```
public class DynamicCoinChange {

    public static void main(String[] args) {
        int[] denoms = {1, 6, 10, 25};
        int numCoins = dynamicCoinChange(denoms, 18, 3);
        System.out.println(numCoins);
    }

    public static int dynamicCoinChange(int[] denoms, int amt, int start) {
        if (amt == 0 || start < 0) {
            return 0;
        } else if (amt == 1) {
            return 1;
        } else if (denoms[start] > amt || 
                dynamicCoinChange(denoms, amt, start-1) < 
                (1 + dynamicCoinChange(denoms, amt-denoms[start], start)) &&
                !(dynamicCoinChange(denoms, amt, start-1) == 0)) {
            return dynamicCoinChange(denoms, amt, start-1);
        } else {
            return 1 + dynamicCoinChange(denoms,amt-denoms[start], start);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:11:39.903

最小变化问题不需要递归编程。它可以以更简单的迭代方式进行编程。

```
int[] denoms = { 1, 6, 10, 25 };
int amt = 18;
double[] min = new double[ amt + 1 ];

for( int i = 1; i < min.length; i++ ) { // We're keeping min[ 0 ] as 0/
    min[ i ] = Double.POSITIVE_INFINITY;
}

for( int i = 1; i <= amt; i++ ) {

   for( int j = 0; j <= N - 1; j++ ) {

       if( denoms[ j ] <= i && min[ i - denoms[ j ] ] + 1 < min[ i ] )
           min[ i ] = min[ i - denoms[ j ] ] + 1;

   }
} 
```

在这里，您的解决方案将在条目 min[amt] 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T03:12:19.130

我们需要知道两条信息：

*   when a coin is chosen for the optimal solution
*   选择哪个硬币作为最佳解决方案

根据您的算法，我们知道每当您返回时，我们都会选择一枚硬币`1`。我们也知道在选择的硬币指数为 时选择的硬币`start`。因此，我们有信息可以解决这个问题。

由于性能在这里不是问题，我们将简单地传递一个硬币参数，该参数在选择硬币时填充。

```
public static int dynamicCoinChange(int[] denoms, int amt, int start, ArrayList<Integer> coins) {
    if (amt == 0 || start < 0) {
        return 0;
    } else if (amt == 1) {
        coins.add(1);
        return 1;
    } else if (denoms[start] > amt 
            // Note that these calls are not guaranteed to be in our solution
            // Thus, we make a copy to prevent the calls from modifying our solution
            || dynamicCoinChange(denoms, amt, start-1, new ArrayList<Integer>(coins)) < 
                (1 + dynamicCoinChange(denoms, amt-denoms[start], start, new ArrayList<Integer>(coins))) 
            && !(dynamicCoinChange(denoms, amt, start-1, new ArrayList<Integer>(coins)) == 0)) {
        return dynamicCoinChange(denoms, amt, start-1, coins);
    } else {
        coins.add(denoms[start]);
        return 1 + dynamicCoinChange(denoms,amt-denoms[start], start, coins);
    }
} 
```

由于这需要我们更改方法签名，因此我们还必须修改我们的驱动程序：

```
public static void main(String[] args) {
    int[] denoms = {1, 6, 10, 25};
    ArrayList<Integer> coins = new ArrayList<Integer>();
    int numCoins = dynamicCoinChange(denoms, 7, 3, coins);
    for (Integer coin : coins)
        System.out.println(coin);
    System.out.println(numCoins);
} 
```

在递归调用结束时，`coins`应包含按时间顺序选择的硬币列表。

# python - 删除标点符号

> ID：15456931
> 
> 赞同：0
> 
> 时间：2013-03-17T02:23:07.370
> 
> 标签：python, punctuation

我需要绑定标点符号功能，以便在打印文件中的文本时不使用标点符号。取一行：`"How are you today?"`

到目前为止，打印：

```
"how
are
you
today?" 
```

但我想像这样打印它：

```
how
are
you
today 
```

我的代码如下所示：

```
from scanner import *
import sys
import string

def processFile(filename):
    s = Scanner(filename)
    token = s.readtoken()
    array = []
    while token != "":
        newToken = ""
        for i in range(0,len(token),1):
            newchar = RawChar(token[i])
            newToken = newToken + newchar
        array.append(newToken)
        token = s.readtoken()
    s.close()
    return array

def eachLine(tokens):
    for i in range(0,len(tokens),1):
        pun(tokens[i])
        print(tokens[i])
    return

def pun(string):
    punctuation = ["`","~","!","@","#","$","%","^","&","*","(",")","_","-","+","=","{","[","}","]","|",":",";","\"","'","<",",",">",".","?","/"]
    for i in string:
        newString = ""
        if i not in string:
            newString = newString + i
    return newString

def RawChar(char):
    if char == "A":
        char = "a"
    elif char == "B":
        char = "b"
    elif char == "C":
        char = "c"
    elif char == "D":
        char = "d"
    elif char == "E":
        char = "e"
    elif char == "F":
        char = "f"
    elif char == "G":
        char = "g"
    elif char == "H":
        char = "h"
    elif char == "I":
        char = "i"
    elif char == "J":
        char = "j"
    elif char == "K":
        char = "k"
    elif char == "L":
        char = "l"
    elif char == "M":
        char = "m"
    elif char == "N":
        char = "n"
    elif char == "O":
        char = "o"
    elif char == "P":
        char = "p"
    elif char == "Q":
        char = "q"
    elif char == "R":
        char = "r"
    elif char == "S":
        char = "s"
    elif char == "T":
        char = "t"
    elif char == "U":
        char = "u"
    elif char == "V":
        char = "v"
    elif char == "W":
        char = "w"
    elif char == "X":
        char = "x"
    elif char == "Y":
        char = "y"
    elif char == "Z":
        char = "z"
    return char

def main():
    newForm = processFile(sys.argv[1])
    eachLine(newForm)

main() 
```

有什么建议放在哪里`def pun(string)`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-17T02:47:23.680

要从字符串中删除标点符号，请使用`str.translate`：

```
In [124]: import string

In [126]: string.punctuation
Out[126]: '!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~'

In [127]: '"How are you today?"'.translate(None, string.punctuation)
Out[127]: 'How are you today' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T02:48:20.950

[您可以使用此 stackoverflow 文章](https://stackoverflow.com/questions/3939361/remove-specific-characters-from-a-string-in-python)中显示的技术显着改进标点符号剥离。然后使用 s.lower() 将字符串 s 小写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-22T06:57:58.787

```
import string
s = '"Right now!" she shouted, and hands fluttered in the air - amid a few cheers - for about two minutes.'
x = "".join([c for c in s if or c not in string.punctuation]) 
```

# php - 在 Silex 上使用 Swiftmailer 的内部服务器错误

> ID：15456935
> 
> 赞同：0
> 
> 时间：2013-03-17T02:38:48.217
> 
> 标签：php, swiftmailer, silex

我正在做一个 Silex 项目，我正在尝试使用 Swiftmailer 提供程序发送电子邮件，但总是收到内部服务器错误（500）。

注册：

```
$app->register(new Silex\Provider\SwiftmailerServiceProvider(), array(
        'swiftmailer.options' => array(
            'host' => 'smtp.gmail.com',
            'port' => '465',
            'username' => 'my_email',
            'password' => 'my_password')

    )); 
```

如果我调用邮件程序 $app['mailer'] 会引发内部服务器错误。

如果我尝试使用文档示例，则会收到内部服务器错误：

```
 $app->post('/feedback', function () use ($app) {
    $request = $app['request'];

    $message = \Swift_Message::newInstance()
        ->setSubject('[YourSite] Feedback')
        ->setFrom(array('noreply@yoursite.com'))
        ->setTo(array('feedback@yoursite.com'))
        ->setBody($request->get('message'));

    $app['mailer']->send($message);

    return new Response('Thank you for your feedback!', 201);
}); 
```

我不知道是什么问题，我与其他提供商没有任何问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:34:28.070

在您的“swiftmailer.options”数组中添加以下条目会有所帮助吗？默认情况下，Gmail 在端口 465 上使用 ssl。

```
'encryption' => 'ssl',
'auth_mode' => 'login', 
```

[**更新**] 如果你在代码中定义了命名空间，需要在 Silex\Provider 前面加上 '\'。

```
$this->register(new Silex\Provider\SwiftmailerServiceProvider(), array( 
```

至

```
$this->register(new \Silex\Provider\SwiftmailerServiceProvider(), array( 
```

# knockout.js - ApplyBindings 两次，验证

> ID：15456937
> 
> 赞同：1
> 
> 时间：2013-03-17T02:39:06.483
> 
> 标签：knockout.js, knockout-validation

我有一个网格，其中包含多个业务对象。让我们称他们为产品。当您单击该项目时，我会进行 AJAX 调用并获取数据并创建一个绑定到模式“窗口”（使用引导程序）的 Knockout viewModel。用户可以更改产品，例如他们可以将名称更改为其他名称，他们可以点击取消或保存。当用户点击保存/取消时，他们将被带回网格，然后可以单击另一个产品，从而弹出带有新产品的模式（另一个 AJAX 调用以获取数据等）。

好吧，我再次调用了 KO.applyBindings(viewModel)。我想这可能是个坏主意。我注意到的是，如果用户没有输入名称（这是必需的），我会收到两条验证消息，上面写着“需要名称”。所以这告诉我必须绑定两个事件（或某事或其他）。所以我做了几次谷歌搜索，我发现了几篇使用 ko.cleanNode(node) 的文章，如果你要调用 applyBindings 两次。那并没有解决我的问题。我正在使用 knockout.validation.js 并且我还扩展了我的 name 属性，如下所示：

```
vm.Name.extend({
        required: { message: 'Name is required.' },
        minLength: 1
    }); 
```

无论如何要清除扩展或 unApplyBindings 吗？还是我只是用错了KO？我真的很喜欢它，但要让它做你想做的事情需要一些时间（这就是他们付钱给我的原因）。如果需要，我也许可以让 Fiddle 来证明这一点..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-11T16:36:52.297

我知道这是一个老问题，但我遇到了同样的问题。我从 github 站点上的一个示例开始，该示例定义了一个用于显示验证错误的自定义模板。当我把它拿出来时，什么都没有改变，我的异常消失了。

我删除了：

```
<script id="customMessageTemplate" type="text/html"><!--
    --><em class="customMessage" data-bind="validationMessage: field"></em>
</script>
---
<div class="row" data-bind="validationOptions: { messageTemplate: 'customMessageTemplate' }"> 
```

希望这对其他人有帮助。

# bash - 命令行中的 if 语句

> ID：15456939
> 
> 赞同：0
> 
> 时间：2013-03-17T02:39:31.230
> 
> 标签：bash, shell

`$output`我正在尝试创建一个 shell 脚本，事实是，如果变量已填充，我想更改输出。我正在考虑使用`if`命令内部的变量检查变量，但我不知道它是否是正确的语法。这是一个例子（当然这不起作用）：

> ls -丽莎 | awk '$5 == own' own="$owner" | 排序 -k$column -n if [ $output ]; 然后打印 > out.txt fi

我不知道它是否会以这种方式工作以及是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:59:39.643

内置的 exec 可以更改正在运行的 shell 脚本的其余部分的默认标准输出。所以，在这种情况下，你会这样做：

```
if [ -n "$output" ]; then
    exec >out.txt
fi
ls -lisa | awk '$5 == own' own="$owner" | sort -k$column 
```

我不完全确定你想用 awk 部分做什么，所以这只是你问题的逐字记录。

另一种选择是将要重定向的脚本部分放入函数中，然后以两种方式之一调用该函数，重定向输出。例子：

```
do_work() {
    ls -lisa | awk '$5 == own' own="$owner" | sort -k$column
}
if [ -n "$output" ]; then
    do_work >out.txt
else
    do_work
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T05:57:32.523

您可以使用 shell 的“使用默认值”选项（`${variable:-default}`，以 /dev/stdout 作为默认值）来执行此操作：

```
ls -lisa | awk '$5 == own' own="$owner" | sort -k$column -n > "${output:-/dev/stdout}" 
```

# ruby-on-rails - postgresql 9.1 - Rails 3 - 无法安装 pg gem

> ID：15456940
> 
> 赞同：0
> 
> 时间：2013-03-17T02:39:33.930
> 
> 标签：ruby-on-rails, ruby, postgresql, heroku

我正在开发一个 Rails 应用程序以在 Mac OS X 上推送到 Heroku，当我尝试运行“gem install pg”时，出现以下错误。

```
Building native extensions.  This could take a while...
ERROR:  Error installing pg:
    ERROR: Failed to build gem native extension.

        /usr/local/rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
checking for pg_config... yes
Using config values from /usr/bin/pg_config
checking for libpq-fe.h... yes
checking for libpq/libpq-fs.h... yes
checking for pg_config_manual.h... yes
checking for PQconnectdb() in -lpq... yes
checking for PQconnectionUsedPassword()... yes
checking for PQisthreadsafe()... yes
checking for PQprepare()... yes
checking for PQexecParams()... yes
checking for PQescapeString()... yes
checking for PQescapeStringConn()... yes
checking for PQescapeLiteral()... yes
checking for PQescapeIdentifier()... yes
checking for PQgetCancel()... yes
checking for lo_create()... yes
checking for pg_encoding_to_char()... yes
checking for pg_char_to_encoding()... yes
checking for PQsetClientEncoding()... yes
checking for PQlibVersion()... yes
checking for PQping()... yes
checking for rb_encdb_alias()... yes
checking for rb_enc_alias()... no
checking for PGRES_COPY_BOTH in libpq-fe.h... no
checking for PGRES_SINGLE_TUPLE in libpq-fe.h... no
checking for struct pgNotify.extra in libpq-fe.h... yes
checking for unistd.h... yes
checking for ruby/st.h... yes
creating extconf.h
creating Makefile

make
compiling pg.c
pg.c: In function ‘Init_pg_ext’:
pg.c:384: error: ‘PQPING_OK’ undeclared (first use in this function)
pg.c:384: error: (Each undeclared identifier is reported only once
pg.c:384: error: for each function it appears in.)
pg.c:386: error: ‘PQPING_REJECT’ undeclared (first use in this function)
pg.c:388: error: ‘PQPING_NO_RESPONSE’ undeclared (first use in this function)
pg.c:390: error: ‘PQPING_NO_ATTEMPT’ undeclared (first use in this function)
make: *** [pg.o] Error 1

Gem files will remain installed in /usr/local/rvm/gems/ruby-1.9.3-p194/gems/pg-0.14.1 for inspection.
Results logged to /usr/local/rvm/gems/ruby-1.9.3-p194/gems/pg-0.14.1/ext/gem_make.out 
```

我已经使用他们网站上的 Mac OS X 安装程序安装了 Postgres。

任何有关如何解决此问题的帮助都会非常有用！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T06:28:47.040

如果您使用 Brew 安装 Postgres，则不会出现此问题。

# python - Python SMTP.starttls 参数

> ID：15456941
> 
> 赞同：3
> 
> 时间：2013-03-17T02:39:41.293
> 
> 标签：python, smtplib

我是 python 新手。我已经对 python 的鸭子类型进行了一些研究，但我陷入了以下情况。

当我查看 Python 标准库时，我发现 API 仅指定参数的名称，这似乎暗示了要传递的内容，但类型。这让我依赖直觉。因此，当我将错误的对象传递给函数时，这听起来像是在玩试错游戏。

例如，在 python 标准库 smtplib 中，我想使用这个函数：

`SMTP.starttls([keyfile[, certfile]])`

但我不知道我应该将什么类型的对象传递给 keyfile 或 certfile 参数？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T03:03:28.030

这可能只是对 Python 和文档不熟悉，而不是鸭子打字问题。

在您的特定示例中，您必须稍微遵循文档。

在`SMTP.starttls()`方法中，[它说](http://docs.python.org/2/library/smtplib.html#smtplib.SMTP.starttls)：

> 如果提供了 keyfile 和 certfile，则将它们传递给套接字模块的[ssl() 函数](http://docs.python.org/2/library/ssl.html#module-ssl)。

如果您点击该链接，您将看到：

> keyfile 和 certfile 参数指定可选文件，其中包含用于标识连接的本地端的证书。有关证书如何存储在 certfile 中的更多信息，请参阅[证书的讨论。](http://docs.python.org/2/library/ssl.html#ssl-certificates)

**编辑：** and`keyfile`参数`certfile`似乎是文件名（字符串）。如果您随后点击指向[证书](http://docs.python.org/2/library/ssl.html#ssl-certificates)的链接，您会看到文件应该是 PEM 格式。

感谢 JF Sebastian 的提示。

# css - 如何在使标题占据浏览器窗口的整个宽度的同时使页面居中？

> ID：15456945
> 
> 赞同：-2
> 
> 时间：2013-03-17T02:40:09.330
> 
> 标签：css, header, width, center

我在网上看到了大量关于将内容集中在页面上是多么“简单”的演示。我想出了如何让我的标题占据浏览器窗口的整个宽度但是每当我尝试将我的内容居中时，我的所有浏览器都会扩展页面的宽度，所以我最终有一个水平滚动条。另一个问题是我的标题与浏览器的其余部分颜色不同，所以当我对正文进行更改时，有时它会更改标题的宽度，这样颜色就不会填满窗口。这个网站是我努力实现的一个很好的例子[http://carlodiego.businesscatalyst.com/](http://carlodiego.businesscatalyst.com/)

我也希望我的标题有溢出：无；这样如果有人让浏览器窗口变小，标题就会开始消失。我已经为此工作了几个小时，无论我做什么其他事情都会中断。下面是我的代码。对不起，但它很长。

```
<body>
<header>
    <div id="wrapper">
        <div id="fixed">
            <div id="menu-container">
                <ul id="navigationMenu">
                    <li><a href="#" class="normalMenu">Home</a></li>
                    <li><a href="#" class="normalMenu">About</a></li>
                    <li><a href="#" class="normalMenu">Work</a></li>
                    <li><a href="#" class="normalMenu">Contact Me</a></li>
                </ul>
            </div>
            <div id="title">
            <h1>Alex</h1>
            <h1 id="last">Chaparro</h1>
            </div>
        </div>

</header>

        <div id="background">

        <div id="front-end">
           <h1>Front-End <br> Developer</h1>
        </div>
        <div id=content>

            <h1 class="heading">About</h1>
            <p>content</p>

            <h2>Currently Using</h2>
            <p>More Content...</p>

            <h2>Currently Following</h2>
            <p>Chris Mills | David Sawyer Mcfarland | Phil Thompson </p>

            <h1 class="heading">Work</h1>

        </div>
      </div>
</div>
</body>

body {
    margin: 0;
    padding:0;
    border: 0;
    font-size: 100%;
    line-height: 1.5;
    font-family: 'optimusprincepssemiboldRg';
    background: #fafafa;

    background-color: #eeeeee;
    }

article, aside, audio, canvas, datalist, details, figcaption, figure, footer, header, hgroup, menu, nav, section, video {
    display: block;
}

#title {
    font-family: 'optimusprincepssemiboldRg';
    color: black;
}

#last {
    font-size: 400%;
    line-height: 0;
    margin-top: 40px;
}

#menu-container {
    position: absolute;
    margin-left: 420px;
    white-space: nowrap; /* stops text from wrapping */
    overflow: hidden;
}

#background {
    background-color: #eeeeee;
    position: absolute;
    height: 100%;
    margin-top: 20px;
    margin-left: 20%;
    margin-right: 20%;
}

#front-end {
    margin-top: 100px;
    font-size: 200%;
    width: 100%;
    text-align: center;
}

.heading {
    font-size: 300%;
}

#fixed {
    position: relative;
    height: 200px;
}

header {
    width: 100%;
    overflow: hidden; /*This stops the color from going away*/
    background-color: #cee3ee;
}

#wrapper {
    margin-left: 20%;
    margin-right: 20%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T03:49:46.167

你想要一个`header`和`main`div。并使它们`absolute`定位。并`margin:0px auto;`用于居中主要。

像这样[http://jsfiddle.net/WAR4r/](http://jsfiddle.net/WAR4r/)

# network-programming - 如何选择端口号？

> ID：15456948
> 
> 赞同：0
> 
> 时间：2013-03-17T02:40:19.900
> 
> 标签：network-programming, zeromq

我正在编写一个程序，它使用 ZeroMQ 与同一台机器上的其他正在运行的程序进行通信。我想在运行时选择一个端口号以避免发生冲突的可能性。这是我为完成此操作而编写的一段代码示例。

```
#!/usr/bin/perl -Tw

use strict;
use warnings;

my %in_use;
{
    local $ENV{PATH} = '/bin:/usr/bin';

    %in_use = map { $_ => 1 } split /\n/, qx(
        netstat -aunt          |\
        awk '{print \$4}'      |\
        grep :                 |\
        awk -F: '{print \$NF}'
    );
}

my ($port) = grep { not $in_use{$_} } 50_000 .. 59_999;

print "$port is available\n"; 
```

程序是：

1.  调用 netstat -aunt

2.  解析结果

3.  选择固定范围内的第一个端口，该端口未出现在 netstat 列表中。

是否有更适合完成此任务的系统实用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:17:51.847

首先，从您的代码看来，您正试图在 70000 和 79999 之间选择一个端口。您知道端口号最多只能达到 65535，对吧？:-)

你当然可以这样做，即使这种方法存在一些问题。第一个问题是`netstat`不同操作系统之间的输出不同，因此很难移植。第二个问题是您仍然需要将代码包装在一个循环中，该循环再次尝试查找新端口号，以防无法绑定到所选端口号，因为在确定端口空闲之间存在竞争条件并实际绑定到它。

如果您使用的库允许您将端口号指定为 0 并允许您`getsockname()`在绑定后调用套接字，那么您应该这样做。使用 0 使系统选择任何空闲端口号，`getsockname()`您可以找出它选择了哪个端口。

`netstat`如果做不到这一点，实际上不打扰调用并尝试在循环中查找不同的端口号实际上可能会更有效。如果成功，请从循环中中断。如果失败，将端口号加 1，返回并重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T09:19:36.617

```
context = zmq.Context()
socket = context.socket(zmq.ROUTER)    
port_selected = socket.bind_to_random_port('tcp://*', min_port=6001, max_port=6004, max_tries=100) 
```

# r - 选择矩阵列（对应行）作为 Nx1（对应 1xD）矩阵，而不是向量

> ID：15456950
> 
> 赞同：1
> 
> 时间：2013-03-17T02:40:48.843
> 
> 标签：r

让`X`成为一个矩阵`N`。`D`选择大小`n`为 by的子矩阵会`d`返回这些维度的矩阵，**除非**其中至少有一个`n`和`d`等于 1，在这种情况下，我们会得到一个向量。有趣的是，即使`n`和之一`d`为 0，而另一个**不是**1，R 仍会返回正确维度的矩阵。

现在，如果我们确定，那么无论是否（这里和）`n!=1`，执行都会返回一个正确维度的矩阵。如果我们确定这一点，那么我们可以使用. 但是如果两者都可以为 1，那么这两种方法都行不通，因为我们可能会不小心将一行变成一列，反之亦然。`cbind(X[row.subset,col.subset])``d==1``n=length(row.subset)``d=length(col.subset)``d!=1``rbind(...)``n``d`

据我所知，始终获得正确尺寸矩阵的一种方法是调用`matrix(X[row.subset,col.subset],nrow=n,ncol=d)`. 但是，感觉这不应该是正确的方法，而且我不确定没有性能损失。有没有更“原生”的解决方案？

这是一个工作示例：

```
N <- 6
D <- 3
X <- matrix(rnorm(N*D),ncol=D)

dim(X[1:2,1:2]) #returns 2 2
dim(X[1:2,1]) #returns NULL, this is a vector

dim(cbind(X[1:2,1])) #returns 2 1
dim(cbind(X[1,1:2])) #returns 2 1, but we'd like it to be 1 2

dim(rbind(X[1,1:2])) #returns 1 2
dim(rbind(X[1:2,1])) #returns 1 2, but we'd like it to be 2 1

row.subset <- 1:4
col.subset <- 2
#I _think_ this is always correct, but it's verbose:
matrix(X[row.subset,col.subset],nrow=length(row.subset),ncol=length(col.subset)) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T03:11:59.300

如果您不想将矩阵子集简化为向量，请告诉`[`不要删除维度：

```
> dim(X[1:2,1, drop=FALSE])
[1] 2 1
> dim(X[1,1:2, drop=FALSE])
[1] 1 2 
```

详情请参阅`?"["`。

# connection - 使用httpclient通过ip发送请求很慢

> ID：15456953
> 
> 赞同：0
> 
> 时间：2013-03-17T02:41:12.400
> 
> 标签：connection, ip, hosts

现在，我提出一个奇怪的问题。我用 httpclient 发送 http 请求。在请求中，当我使用域名时，如dynamic.12306.cn，或者我使用ip地址并将ip信息放在windows/system32/driver/ext/hosts`122.227.2.27 dynamic.12306.cn`中，请求很快返回。但是，如果我只使用 ip 并且不将任何信息放入主机，它会非常慢。

以上两个，我将在下面显示示例：

案例一、速度快。请求 url 是[https://dynamic.12306.cn/otsweb/main.jsp](https://dynamic.12306.cn/otsweb/main.jsp) 或者请求 url 是`https://122.227.2.27/otsweb/main.jsp`并放入`122.227.2.27 dynamic.12306.cn`hosts，

案例2.速度慢。请求网址是`https://122.227.2.27/otsweb/main.jsp`不要将任何信息放入主机中。

我打开httpclient的debug模式，发现使用case 2的方法，连接服务器很慢。

日志：

> 2013/03/17 10:19:10:665 CST [DEBUG] BasicClientConnectionManager - 获取路由 {s}-> 的连接`https://122.227.2.27`
> 
> 2013/03/17 10:19:11:234 CST [调试] DefaultClientConnectionOperator - 连接到`122.227.2.27:443`
> 
> 2013/03/17 10:19:20:796 CST [调试] RequestAddCookies - CookieSpec 选择：最佳匹配

连接服务器将花费几秒钟。

但是如果我使用案例1的方法。日志：

> 2013/03/17 10:30:13:876 CST [DEBUG] BasicClientConnectionManager - 获取路由 {s} 的连接 -> [https://dynamic.12306.cn](https://dynamic.12306.cn)
> 
> 2013/03/17 10:30:14:403 CST [调试] DefaultClientConnectionOperator - 连接到 dynamic.12306.cn:443
> 
> 2013/03/17 10:30:14:499 CST [DEBUG] RequestAddCookies - CookieSpec selected: best-match

连接服务器速度很快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-12T00:24:07.267

当您发出请求时，请尝试收听 DNS 查询。我遇到了同样的问题，原来托管网站在 ip 之后附加了一个主机名。

# php - 日期、时间、DSL 和时区信息处理

> ID：15456961
> 
> 赞同：1
> 
> 时间：2013-03-17T02:43:07.933
> 
> 标签：php, datetime, php-internals

时区和夏令时信息可能会更改，恕不另行通知。 [一项简单的立法](http://en.wikipedia.org/wiki/History_of_time_in_the_United_States)可能会改变某个区域的 DSL 并使日期时间信息对全球某个区域无用，从而突然影响依赖于服务器或客户端本地时间的代码。而且，时区无论如何只能大致反映实际的[日落/日出时间。](http://www.worldtimezone.com/)

有几个 PHP 用户空间库会受到这种不可预测的“时间”定义的影响，包括`DateTime`、`date`等。在用户空间之外，可能存在依赖于时区转换的内部代码。

PHP 的库如何解释不断变化的日期、时间和时区定义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T03:33:03.803

PHP 在内部使用 tz 数据库，也称为 zoneinfo 数据库、IANA 时区数据库或 Olson 数据库。（虽然当然可以从另一个数据库为其提供时区数据。）

更多信息可以在这里找到：[http](http://en.wikipedia.org/wiki/Tz_database) ://en.wikipedia.org/wiki/Tz_database和这里​​：[http ://www.iana.org/time-zones](http://www.iana.org/time-zones)

# python - 在 Django Admin 中更改密码

> ID：15456964
> 
> 赞同：16
> 
> 时间：2013-03-17T02:43:34.880
> 
> 标签：python, django, django-admin, django-1.5

我最近在 Django 项目文档中创建了 admin.py：

`https://docs.djangoproject.com/en/dev/topics/auth/customizing/#django.contrib.auth.models.AbstractBaseUser`

但我真的错过了允许管理员更改用户密码的功能。怎么可能添加这个功能？我刚刚复制并粘贴了上面链接中的代码。

```
from django import forms
from django.contrib import admin
from django.contrib.auth.models import Group
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.forms import ReadOnlyPasswordHashField

from customauth.models import MyUser

class UserCreationForm(forms.ModelForm):
    """A form for creating new users. Includes all the required
    fields, plus a repeated password."""
    password1 = forms.CharField(label='Password', widget=forms.PasswordInput)
    password2 = forms.CharField(label='Password confirmation', widget=forms.PasswordInput)

    class Meta:
        model = MyUser
        fields = ('email', 'date_of_birth')

    def clean_password2(self):
        # Check that the two password entries match
        password1 = self.cleaned_data.get("password1")
        password2 = self.cleaned_data.get("password2")
        if password1 and password2 and password1 != password2:
            raise forms.ValidationError("Passwords don't match")
        return password2

    def save(self, commit=True):
        # Save the provided password in hashed format
        user = super(UserCreationForm, self).save(commit=False)
        user.set_password(self.cleaned_data["password1"])
        if commit:
            user.save()
        return user

class UserChangeForm(forms.ModelForm):
    """A form for updating users. Includes all the fields on
    the user, but replaces the password field with admin's
    password hash display field.
    """
    password = ReadOnlyPasswordHashField()

    class Meta:
        model = MyUser

    def clean_password(self):
        # Regardless of what the user provides, return the initial value.
        # This is done here, rather than on the field, because the
        # field does not have access to the initial value
        return self.initial["password"]

class MyUserAdmin(UserAdmin):
    # The forms to add and change user instances
    form = UserChangeForm
    add_form = UserCreationForm

    # The fields to be used in displaying the User model.
    # These override the definitions on the base UserAdmin
    # that reference specific fields on auth.User.
    list_display = ('email', 'date_of_birth', 'is_admin')
    list_filter = ('is_admin',)
    fieldsets = (
        (None, {'fields': ('email', 'password')}),
        ('Personal info', {'fields': ('date_of_birth',)}),
        ('Permissions', {'fields': ('is_admin',)}),
        ('Important dates', {'fields': ('last_login',)}),
    )
    add_fieldsets = (
        (None, {
            'classes': ('wide',),
            'fields': ('email', 'date_of_birth', 'password1', 'password2')}
        ),
    )
    search_fields = ('email',)
    ordering = ('email',)
    filter_horizontal = ()

# Now register the new UserAdmin...
admin.site.register(MyUser, MyUserAdmin)
# ... and, since we're not using Django's builtin permissions,
# unregister the Group model from admin.
admin.site.unregister(Group) 
```

**[更新 - 添加信息]** 我更改了以下信息，但我仍然在只读字段中看到密码（加密）。如何添加链接以更改密码？

```
fieldsets = (
    ('Permissions', {'fields': ('is_active', 'is_admin','password')}),
)
add_fieldsets = (
    (None, {
        'classes': ('wide',),
        'fields': ('email', 'password')}
    ),
) 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-03-26T06:01:08.710

把它放在你的 UserChangeForm 中：

```
password = ReadOnlyPasswordHashField(label=("Password"),
        help_text=("Raw passwords are not stored, so there is no way to see "
                    "this user's password, but you can change the password "
                    "using <a href=\"../password/\">this form</a>.")) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-02-03T06:40:00.880

```
password = ReadOnlyPasswordHashField(label= ("Password"),
        help_text= ("Raw passwords are not stored, so there is no way to see "
                    "this user's password, but you can change the password "
                    "using <a href=\"../password/\">this form</a>.")) 
```

href 有变化，对于以前版本的 django，您可以使用

`<a href=\"/password/\">this form</a>`.

对于 django 1.9+ `<a href=\"../password/\">this form</a>`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-08-28T05:25:24.483

我将此方法添加到我的`UserAdmin`课程中：

```
def save_model(self, request, obj, form, change):
    # Override this to set the password to the value in the field if it's
    # changed.
    if obj.pk:
        orig_obj = models.User.objects.get(pk=obj.pk)
        if obj.password != orig_obj.password:
            obj.set_password(obj.password)
    else:
        obj.set_password(obj.password)
    obj.save() 
```

您可以正常显示密码字段，但管理员只会看到散列密码。如果他们改变了它，那么新值就会被散列并保存。

这会在您每次通过管理员保存用户时添加一个查询。这通常应该不是问题，因为大多数系统没有管理员集中编辑用户。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-10-27T15:18:24.143

你也可以这样做，这样你只需要覆盖字段密码，一旦你保存它，它就会为它创建哈希：

```
class UserModelAdmin(admin.ModelAdmin):

    """
        User for overriding the normal user admin panel, and add the extra fields added to the user
        """

def save_model(self, request, obj, form, change):
    user_database = User.objects.get(pk=obj.pk)
    # Check firs the case in which the password is not encoded, then check in the case that the password is encode
    if not (check_password(form.data['password'], user_database.password) or user_database.password == form.data['password']):
        obj.password = make_password(obj.password)
    else:
        obj.password = user_database.password
    super().save_model(request, obj, form, change) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T08:30:33.223

```
('Permissions', {'fields': ('is_active', 'is_superuser',)}), 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-13T08:50:41.590

对于 django 版本独立的解决方案，您可以使用类似以下内容`reverse`的 url `UserChangeForm.__init__`：

```
from django.core.urlresolvers import reverse

class UserChangeForm(forms.ModelForm):
    password = ReadOnlyPasswordHashField()
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.fields['password'].help_text = (
            "Raw passwords are not stored, so there is no way to see "
            "this user's password, but you can <a href=\"%s\"> "
            "<strong>Change the Password</strong> using this form</a>."
        ) % reverse_lazy('admin:auth_user_password_change', args=[self.instance.id]) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-07T14:13:32.820

`UserAdmin`您还可以考虑以这种方式扩展：

```
from django.contrib import admin
from myapp.models import CustomUser
from django.contrib.auth.admin import UserAdmin

class CustomUserAdmin(UserAdmin):
    list_display = []
admin.site.register(CustomUser, CustomUserAdmin) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-22T11:52:03.067

只需删除表单中输入的密码：

```
class MyUserChangeForm(forms.ModelForm):
# password = forms.CharField(label='Password', required=True, widget=forms.PasswordInput)

# password = ReadOnlyPasswordHashField()

class Meta:
    model = CustomUser
    fields = '__all__'

def save(self, commit=True):
    user = super().save(commit=False)
    user.set_password(self.cleaned_data["password"])
    if commit:
        user.save()
    return user 
```

[django 3.2.8](https://i.stack.imgur.com/8llh3.png)

# php - 在网页上录制、保存和播放保存的声音文件

> ID：15456965
> 
> 赞同：0
> 
> 时间：2013-03-17T02:43:50.793
> 
> 标签：php, javascript, jquery, audio, web

我计划创建一个页面，该页面可以从您的计算机麦克风录制声音并将声音文件保存到服务器/主机（应该是？）。从同一页面，您可以同时播放服务器上保存的所有声音文件（更好的选择是文件在不同的时间开始：+/- 3 秒）。

示例：A、B、C 都记录了他们在不同日子的拍手情况。D刚刚访问了这个页面，想知道现在所有声音文件的当前状态是什么，所以他点击了播放按钮，页面播放了A、B和C的拍手声。D认为他想加入，所以他也要记录他的拍手。

到目前为止，我已经找到了一些可以执行类似任务的 jQuery 库（最近的：http: [//www.sajithmr.me/jrecorder/](http://www.sajithmr.me/jrecorder/)），但是没有一个可以播放所有以前录制的声音文件。

有没有办法让它发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:50:13.887

我建议使用来自 Matt Diamond [https://github.com/mattdiamond/Recorderjs的 Recorder.js](https://github.com/mattdiamond/Recorderjs)

# multithreading - 在没有 CPU 过载的情况下更新 TListView 中的每个线程的计时器

> ID：15456969
> 
> 赞同：2
> 
> 时间：2013-03-17T02:46:29.310
> 
> 标签：multithreading, delphi, delphi-2007

**德尔福使用：** 2007

大家好，

我有一个`ViewStyle`设置为`vsReport`. 当我点击一个按钮时，我会启动大约 50 个线程。每个线程都有一个`TListItem`组件。每个`TListItem`都有`SubItem`一个计时器。它从 250 开始，一直下降到 0。用户可以在 TListView 中看到每个计时器递减。

我写了以下代码：

```
procedure TThreadWorker.DeleteTickets;
begin
 ListItem.Delete;
end;

procedure TThreadWorker.UpdateTimer;
begin
 ListItem.SubItems[1] := IntToStr(Timer);
end;

procedure TThreadWorker.TimerCounter;
begin
 Timer := 300;
 repeat
  Sleep(1000);
  Dec(Timer);
  Synchronize(UpdateTimer);
 until (Timer = 0);
 Synchronize(DeleteTickets);
end; 
```

而且......它的工作原理！但事情是这样的：所有这些同步似乎都不必要地使 CPU 过载。显然，当我启动更多线程（100、200 或 300）或使用较弱的计算机时，这是一个更大的问题。起初，我不确定是同步。但如果我停用它们，CPU 就不会再过载了。

坦率地说，这不是*什么*大问题。但是，我觉得递减计时器不应该导致任何形式的 CPU 过载：我的代码可能不正确。我尝试减少调用`UpdateTimer`频率，虽然它减轻了 CPU 过载，但最终并没有解决它。此外，我希望用户看到计时器每秒更新*一次*。计时器还需要尽可能精确。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T13:42:13.110

我想你已经把车放在马前面了。让所有线程同步到主线程，每个线程都有自己的计时器和消息队列，这会给系统带来沉重的负担。更重要的是，很多时候您不希望通过运行消息循环来增加线程的负担。

在我看来，更好的方法是在主线程中放置一个计时器。当它滴答作响时，让它从它需要报告的每个线程或任务中检索进度。您需要序列化对该进度的访问，但这并不昂贵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T05:05:33.187

我认为线程对 CPU 来说比你想象的要贵。据我记得，CPU 有开销来交换每个线程进出缓存。随着 CPU 换出 50 个不同的线程，我对它的超载并不感到惊讶

一种解决方案可能是扩展 TTimer 组件，然后动态创建其中的 50 个而不是 50 个线程。TTimer 使用 windows api 而不是线程。（下面的代码未经测试，但至少应该给你的想法）

```
TMyTimer = class(TTimer)
begin
  public
    Timer: integer;
    ListItem: TListItem;
end;
...
procedure ButtonClick(Sender: TObject)
begin
  for i := 0 to 50 do
  begin
     ltimer = TMyTimer.Create;
     ltimer.Timer := 300;
     ltimer.ListItem := TListItem.Create;
     //initialize list item here
     ltimer.OnTimer := DecTimer;
  end;
end;

procedure DecTimer(Sender: TObject)
begin
  dec(TMytimer(Sender).Timer);
  TMyTimer(Sender).ListItem.SubItem[1] := StrToInt(TMytimer(Sender).Timer)
end; 
```

如果所有线程都同时启动，请尝试使用一个线程控制最多 25 个计时器。即对于 50 个计时器，您只有两个线程。然后计时器事件将循环遍历它的 25 个计数器并递减它们。您仍然需要为此使用同步。

这个问题的答案可能很有趣： [线程有多贵？](https://stackoverflow.com/questions/4429214/how-expensive-are-threads)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T13:20:10.597

这是使用`TThread.Queue`and a`TSimpleEvent`代替 a 来计时计数器的示例`Sleep()`。

```
Type
  TThreadWorker = Class(TThread)
  private
    FTimer : Integer;
    FListItem : TListItem;
    procedure Execute; override;
    procedure UpdateTimer;
    procedure DeleteTicket;
  public
    constructor Create( aListItem : TListItem);
  End;

constructor TThreadWorker.Create(aListItem : TListItem);
begin
  Inherited Create(false);
  FListItem := aListItem;
  Self.FreeOnTerminate := true;
end;

procedure TThreadWorker.Execute;
var
  anEvent : TSimpleEvent;
begin
  anEvent := TSimpleEvent.Create(nil,true,false,'');
  try
    FTimer := 300;
    repeat
      anEvent.WaitFor(1000);
      Queue(UpdateTimer);
      Dec(FTimer);
    until (FTimer = 0);
    Self.Synchronize( DeleteTicket); // <-- Do not Queue this !
  finally
    anEvent.Free;
  end;
end;

procedure TThreadWorker.UpdateTimer;
begin
  FListItem.SubItems[1] := IntToStr(FTimer);
end;

procedure TThreadWorker.DeleteTicket;
begin
  FListItem.Delete;
end; 
```

请注意，`DeleteTicket`必须同步。执行完成后线程终止，队列中的任何内容都将悬空。

# ruby-on-rails - 在 vim 中查找方法的所有用途

> ID：15456971
> 
> 赞同：8
> 
> 时间：2013-03-17T02:46:40.623
> 
> 标签：ruby-on-rails, vim

有没有办法在 vim 中找到方法的所有用途？我使用 vim 作为带有 rails.vim 的 Rails 的 IDE。ctags 有助于从用法跳转到方法定义，但不能反过来 AFAIK。我希望能够在任何地方（控制器、视图等）找到使用过的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-17T04:34:04.893

在 Vim 中没有任何完美的解决方案，但你可以使用[`cscope`](http://cscope.sourceforge.net/)and `grep`or来接近`ack`。

`cscope`将帮助您找到对符号的所有引用。它是为 C 和类 C 语言而设计的，但它在匹配 Ruby 代码中的符号方面也做得不错。它不会一直正确地获取上下文。

这是一个[vim cscope 教程](http://cscope.sourceforge.net/cscope_vim_tutorial.html)和[一篇关于 Ruby/Vim/cscope](http://www.cuberick.com/2008/11/navigating-larger-ruby-codebases-with.html)的博客文章，以及[另一篇博客文章](http://stolowski.blogspot.com/2011/07/finding-your-way-in-vim.html)，这两篇文章都包含有关在 Vim 中导航 Ruby/Rails 代码的其他提示。

使用`grep`或`ack`从 Vim 与 quickfix 集成是另一种查找符号的好方法。他们没有范围/上下文的概念，但通常一个简单的搜索就足够了。仅使用内置`:grep`命令，您可以执行以下操作：

```
:grep some_method app/controllers
:cwindow 
```

并在 quickfix 窗口中获取搜索结果，这将允许您快速导航到匹配的文件和行号。

一个更好的选择是[ack.vim](https://github.com/mileszs/ack.vim)插件，它将[ack](http://betterthangrep.com/)与 Vim 集成并利用了 quickfix 窗口。

如果您还没有使用插件来导航 CTAGS，我推荐[Tagbar](http://majutsushi.github.com/tagbar/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-10T00:20:54.900

我写了一个宝石来做到这一点：[https ://rubygems.org/gems/starscope](https://rubygems.org/gems/starscope)

它正确解析 ruby​​ 代码并导出为 ctags 和 cscope 文件格式。

# objective-c - NSObject 类现在是 Objective-C 运行时库的一部分吗（而不是作为 Foundation 组件）？

> ID：15456974
> 
> 赞同：5
> 
> 时间：2013-03-17T02:47:10.063
> 
> 标签：objective-c, cocoa, foundation, nsobject, objective-c-runtime

查看[Mac OS X 10.8 版本的 Objective-C 运行时库源代码](http://opensource.apple.com/source/objc4/objc4-532.2/runtime/)，我注意到它有一个[NSObject.mm](http://opensource.apple.com/source/objc4/objc4-532.2/runtime/NSObject.mm)文件。顾名思义，它有`NSObject`类实现，以及内置的自动释放池和保留计数实现。

但是，Mountain Lion 之前的 ObjC 运行时库版本没有实现`NSObject`该类（它们没有`NSObject.mm`文件，例如，您可以在[Mac OS X 10.7 的 Objective-C 运行时库源代码](http://opensource.apple.com/source/objc4/objc4-493.9/runtime/)中看到）。

那么这是否真的意味着`NSObject`该类现在是 Objective-C 运行时库的一部分，而不是作为 Foundation 库组件？如果是，为什么？子类化时是否避免与整个 Foundation 库（与`-framework Foundation`）链接`NSObject`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-17T08:44:51.077

您可以使用 nm(1) 工具查看任何特定库的组成部分。

如果你在 libobjc 上运行它，你会发现 NSObject 实际上是由 libobjc 提供的：

```
% nm /usr/lib/libobjc.dylib | grep -F NSObject
⋮
0000000000021688 t +[NSObject _isDeallocating]
0000000000021674 t +[NSObject _tryRetain]
0000000000021780 t +[NSObject allocWithZone:]
000000000002176e t +[NSObject alloc]
0000000000021699 t +[NSObject allowsWeakReference]
0000000000021712 t +[NSObject autorelease]
0000000000020fa6 t +[NSObject class]
000000000002115a t +[NSObject conformsToProtocol:]
00000000000217ea t +[NSObject copyWithZone:]
00000000000217e6 t +[NSObject copy]
000000000002178d t +[NSObject dealloc]
⋮ 
```

（“t”表示该符号由该库提供；“u”表示该符号未定义，表示该库使用它但它必须来自其他地方。）

这不是他们第一次移动 NSObject 的实现。在 Lion 中，您可以在 CoreFoundation.framework 中找到它。

我不知道他们为什么把它搬来搬去。无论如何，这是一个实现细节；*官方*上，[NSObject 仍然是 Foundation 的一部分](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-17T03:36:37.020

~~NSObject 一直是，现在仍然是一个 Foundation 类。只有在运行时的这个迭代中，它的实现才开源（不要问我为什么，大果实以神秘的方式工作）。您最初不链接整个基础的假设是有缺陷的，考虑到 NSObject 深深植根于 Objective-C 的 C 方面和运行时库，它们是隐式链接的，而 Foundation 提供了许多也交互的类的根与事物的 C 端和运行时。将 Foundation 视为 C 和 ObjC 之间的桥梁，而不是要链接的额外框架。~~

正如 Peter 所说，NSObject 仍然是正式的基础类，但是，它最近被移入运行时库，以允许 libDispatch/libXPC 人员更多地关注 ObjC 方面（因为他们确实在这些库中使用 ObjC 类型） ，而不是每次需要向各自的框架添加一些东西时都必须修补 Core Foundation。

（通过@Catfish_Man）

# c# - 您将如何构建这个 RavenDB 文档的模型？

> ID：15456978
> 
> 赞同：1
> 
> 时间：2013-03-17T02:48:14.377
> 
> 标签：c#, model, ravendb

我有一个 RavenDB 文档的以下结构

```
{
    "RpcTechDataCollectionModel": {
        "Weekend": "March 16 - 17, 2013",
        "ServiceTitle": "Some Title",
        "Notes": "",
        "WeekendServices": [{
            "ServiceTime": "",
            "SiteName": "Bowridge",
            "SoundOperator": "Rob",
            "WorshipLeader": "Daryl",
            "Notes": "",
            "Songs": [{
                "SongName": "Foo",
                "MinSpl": "86",
                "MaxSpl": "92",
                "Note": ""
            }, {
                "SongName": "Bar",
                "MinSpl": "89",
                "MaxSpl": "96",
                "Note": ""
            }]
        }, {
            "ServiceTime": "",
            "SiteName": "Bearspaw",
            "SoundOperator": "Peter",
            "WorshipLeader": "Tim",
            "Notes": "",
            "Songs": [{
                "SongName": "Das",
                "MinSpl": "86",
                "MaxSpl": "91",
                "Note": ""
            }, {
                "SongName": "Bar",
                "MinSpl": "87",
                "MaxSpl": "99",
                "Note": ""
            }]
        }]
    }
} 
```

现在我正在尝试为此建立一个模型，但我想知道构建它的最佳方法是什么。注意，没有子对象`WeekendService`或`Song`将在父对象之外使用`RpcTechCollectionModel`

**选项**一是

```
namespace MyProject.Models {
    using System.Collections.Generic;
    public class RpcTechDataCollectionModel{
        RpcTechDataCollectionModel(){
            this.WeekendServices = new List<WeekendService>();
        }
        public string Weekend { get; set; }
        public string ServiceTitle { get; set; }
        public string Notes { get; set; }
        public List<WeekendService> WeekendServices { get; set; }
        public class WeekendService{
            WeekendService(){
                this.SongRecords = new List<SongRecord>();
            }
            public DateTime ServiceTime { get; set; }
            public string SiteName { get; set; }
            public string SoundOperator { get; set; }
            public string WorshipLeader { get; set; }
            public string Notes { get; set; }
            public List<Song> Songs { get; set; }
            public class Song {
                public string SongName { get; set; }
                public double MinSpl { get; set; }
                public double MaxMax { get; set; }
                public string Note { get; set; }
            }
        }
    }
} 
```

我更喜欢这个，因为它既漂亮又干净，而且易于理解。问题在于它在技术上违反了“[每个文件一个类](https://stackoverflow.com/questions/2434990/one-class-per-file-rule-in-net)”规则

**选项二**

```
public class RpcTechDataCollectionModel{
    RpcTechDataCollectionModel(){
        this.WeekendServices = new List<WeekendService>();
    }
    public string Weekend { get; set; }
    public string ServiceTitle { get; set; }
    public string Notes { get; set; }
    public List<WeekendService> WeekendServices { get; set; }
} 
```

```
public class WeekendService{
        WeekendService(){
            this.SongRecords = new List<SongRecord>();
        }
        public DateTime ServiceTime { get; set; }
        public string SiteName { get; set; }
        public string SoundOperator { get; set; }
        public string WorshipLeader { get; set; }
        public string Notes { get; set; }
        public List<Song> Songs { get; set; }

} 
```

```
public class Song {
    public string SongName { get; set; }
    public double MinSpl { get; set; }
    public double MaxMax { get; set; }
    public string Note { get; set; }
} 
```

这并不违反该规则，但似乎有点痛苦。

以一种或另一种方式做这件事的利弊是什么，一种被认为是“正确/首选”的方式，还是在这种情况下它更“让你的船浮起来”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T04:42:39.880

嵌套类通常用于隐藏实现细节，从而防止消费者滥用它们。由于这些类只是定义数据契约，似乎没有什么可隐藏的。即使你想阻止任何人修改它们（这对你拥有所有权的数据合约来说是有意义的），最好将它们密封起来。

我会将它们放在不同的文件中，并可能分组在文件夹中。

# javascript - 将初始数据加载到主干应用程序的最佳实践？

> ID：15456985
> 
> 赞同：5
> 
> 时间：2013-03-17T02:50:38.957
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我从 Backbone 文档中了解到，通过将模型数据嵌入在初始页面加载时呈现的脚本标签中，将模型数据引导到应用程序中是最佳实践。

我意识到这样做是为了避免向服务器发送额外的请求，这将加快页面加载速度。

但...

它真的有那么大的不同吗？我目前在页面加载时调用 fetch 六个模型和集合，并且一切似乎加载得非常快。

使用这种建议的引导数据方法还有其他原因吗？如果没有，对我来说，这似乎是为了获得微不足道的收益而付出的额外努力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T04:45:23.497

也许只有你作为用户（你没有指定环境）在你的开发机器上很快，但是当你有更多的用户时，这些请求可以开始加起来。在这种情况下，如果您可以引导一些数据，那么好处会变得更加明显。尝试使用 chrome 检查器的网络监控窗格来获取有关两种方法之间差异的更多详细信息。

# c# - 如何优雅地摆脱 AbandonedMutexException？

> ID：15456986
> 
> 赞同：19
> 
> 时间：2013-03-17T02:50:50.370
> 
> 标签：c#, asp.net, mutex, abandonedmutexexception

我使用以下代码在多个正在运行的进程之间同步对共享资源的互斥访问。

互斥锁是这样创建的：

```
Mutex mtx = new Mutex(false, "MyNamedMutexName"); 
```

然后我用这个方法进入互斥部分：

```
public bool enterMutuallyExclusiveSection()
{
    //RETURN: 'true' if entered OK, 
    //         can continue with mutually exclusive section
    bool bRes;

    try
    {
        bRes = mtx.WaitOne();
    }
    catch (AbandonedMutexException)
    {
        //Abandoned mutex, how to handle it?

        //bRes = ?
    }
    catch
    {
        //Some other error
        bRes = false;
    }

    return bRes;
} 
```

这个代码离开它：

```
public bool leaveMutuallyExclusiveSection()
{
    //RETURN: = 'true' if no error
    bool bRes = true;

    try
    {
        mtx.ReleaseMutex();
    }
    catch
    {
        //Failed
        bRes = false;
    }

    return bRes;
} 
```

但是发生的情况是，如果正在运行的进程之一崩溃，或者如果它从任务管理器中终止，互斥锁可能会返回`AbandonedMutexException`异常。所以我的问题是，摆脱它的优雅方式是什么？

这似乎工作正常：

```
 catch (AbandonedMutexException)
    {
        //Abandoned mutex
        mtx.ReleaseMutex();
        bRes = mtx.WaitOne();    
    } 
```

但是在这种情况下我可以进入互斥部分吗？

有人可以澄清吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-17T04:37:58.753

根据 MSDN，[AbandonedMutexException](http://msdn.microsoft.com/en-us/library/system.threading.abandonedmutexexception.aspx)是：

> 当一个线程获取另一个线程通过退出而不释放它而放弃的 Mutex 对象时引发的异常。

这意味着抛出此异常的线程是[Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)的新所有者（否则像您正在做的那样调用[Mutex.ReleaseMutex 方法](http://msdn.microsoft.com/en-us/library/system.threading.mutex.releasemutex.aspx)会触发[ApplicationException](http://msdn.microsoft.com/en-us/library/system.applicationexception.aspx)），并且如果您可以确保受保护的数据结构的完整性互斥体，您可以简单地忽略异常并继续正常执行您的应用程序。

然而，大多数时候 AbandonedMutexException 被引发，受互斥锁保护的数据结构的完整性无法得到保证，这就是为什么在 .NET 框架的 2.0 版中引入了这个异常：

> 废弃的互斥锁表示严重的编程错误。当线程退出而不释放互斥体时，受互斥体保护的数据结构可能不会处于一致状态。在 .NET Framework 2.0 版之前，此类问题很难发现，因为如果由于放弃互斥体而导致等待完成，则不会引发异常。

# c++ - OpenCL：在 dll 中找不到 clRetainDevice

> ID：15456987
> 
> 赞同：2
> 
> 时间：2013-03-17T02:51:05.650
> 
> 标签：c++, opencl, gpu, amd-processor

使用 AMD C++ 绑定和 SDK（最新的）运行一个 OpenCL 程序，该程序获得一个平台、一个 GPU，然后编译 4 个内核，在启动时会出现上述错误。它在我的电脑上运行良好，它的 GPU 只支持最高 1.1，但其他电脑似乎有上述错误。这是编译中的问题（如，我必须定义一些宏），缺少驱动程序，C++ 绑定还是其他问题？我没有在我自己的代码中显式调用 clRetainDevice——它是某处绑定的一部分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T14:59:14.650

当您将 C++ 绑定头文件与 OpenCL 1.2 头文件一起使用时，就会发生这种情况。例如，当您在 NVIDIA 平台（仅限 OpenCL 1.1）上运行使用 AMD SDK (OpenCL 1.2) 编译的应用程序时。

作为快速而肮脏的工作，您只需编辑 AMD SDK cl.h 标头和 undef "CL_VERSION_1_2" 预处理器符号。如果您对 1.2 功能不感兴趣，它应该可以解决您的问题。

# python - 为 CouchDB 设置 Python ViewServer

> ID：15456989
> 
> 赞同：2
> 
> 时间：2013-03-17T02:51:17.307
> 
> 标签：python, macos, couchdb

我正在努力跟上 CouchDB 的速度。作为一个相对较新的 Python 用户，我正在尝试设置一个视图服务器，以便我可以将 python 函数传递给 couchdb.design.ViewDefinitions 函数。据我了解，ViewDefinitions 采用 javascript 代码来执行 map/reduce 函数。

这是我很难理解的——我很清楚这可能是一个基本问题。根据维基（[http://wiki.apache.org/couchdb/View_server](http://wiki.apache.org/couchdb/View_server)）：

要将查询服务器注册到 CouchDB，请在 local.ini 中为每个服务器添加一行。基本语法是：'[query_servers] python=/usr/bin/couchpy'

如何访问 local.ini 文件？我是 10.6.8 Mac 用户。谢谢！

更新：谢谢Kxepal。看来我能够在 Python 中创建蒲团的设计/视图。或者，我认为可以按如下方式创建 python 视图服务器： curl -X PUT http://[localhost]/_config/query_servers/python '"/path/to/couchpy"'

但是，我仍然无法执行 python 脚本。在 Couch 上运行视图会导致以下结果：“错误：访问视图时发生错误无响应”

如果有人能指出正确的方向，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-22T00:23:13.743

我遇到了同样的“错误：访问视图时发生错误无响应”问题，结果证明是我的 python 代码中的一个错误。具体来说，在 javascript 实现中，我有类似的东西：

```
function (doc) {    
    emit(doc.somefield, doc);
} 
```

我已将其转换为：

```
def map(doc):
    yield doc.somefield, doc 
```

但是，这给了我您描述的“无响应”错误。

将其更改为以下解决了该问题。

```
def map(doc):
        yield doc['somefield'], doc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T06:41:50.940

我不知道 OSX 是否保留 CouchDB 配置文件，但您始终可以通过[Futon](http://docs.couchdb.org/en/latest/intro.html#using-futon)设置 Python 查询服务器。在侧边栏上单击配置，然后单击页面底部的“添加部分”，并使用与您计划写入 local.ini 相同的数据填充字段。作为奖励，您不需要重新启动 CouchDB - 通过 HTTP API 进行的配置更改会立即应用，但请确保您指定了正确的值。

# c++ - 实现一个队列类，分段错误？

> ID：15456990
> 
> 赞同：2
> 
> 时间：2013-03-17T02:52:27.800
> 
> 标签：c++, segmentation-fault, undefined-behavior

我正在尝试实现一个队列类（使用节点结构和队列类）。我遇到了*分段错误*，我的眼睛让我失望了，我似乎找不到它。我的`pushBack`行不通，我很确定我的`popFront`可能行不通。我只是希望有人能够在正确的方向上给我一个很好的推动！

另外，如果你还没有弄清楚。我显然对*C++*很陌生。

```
#include <iostream>
using namespace std;

struct Node {
    int data;
    Node* link;
};

class Queue {
public:
    Queue(); 
    ~Queue(); 
    void pushBack(int d);
    bool popFront(); 
    bool isEmpty(); 
    void displayQueue();
private:
    Node* back;
    Node* front;
};

Queue::Queue() {
    back = NULL;
    front = NULL;
}

Queue::~Queue() {
    while (!isEmpty()) {
        popFront();
    }
}

void Queue::pushBack(int d) {
    Node* temp;

    if (temp == NULL) {
        return;
    } else {
            temp->link = NULL;

            if (back == NULL) {
                  back = temp;
                  front = temp;
            } else {
                  front->link = temp;
              front = temp;
            }
      }
}

bool Queue::popFront() {
    if (front == NULL) {
        return false;
    } else {
        Node* removeNode;
        removeNode = front;

        if (back == front) {
            back = NULL;
            front = NULL;
        } else {
            Node* previousFront = back;
            while (previousFront->link != front) {
                previousFront = previousFront->link;
            }

            front = previousFront;
            front->link = NULL;
        }

        delete removeNode;
        return true;
    }
}

bool Queue::isEmpty() {
    return (back == NULL);    
}

void Queue::displayQueue() {
    if (isEmpty()) {
        cout << "Queue is empty!" << endl;
    } else {
        Node *current;

        current = back;

        cout << endl << "-- BACK --  ";

        while (current != NULL) {
        cout << current->data << "  ";
            current = current->link;
        }

        cout << "-- FRONT --" << endl << endl;
    }
}

int main(){
    Queue q;
    q.displayQueue();
    q.pushBack(20);
    q.pushBack(30);
    q.displayQueue();
    q.pushBack(40);
    q.pushBack(12);
    q.displayQueue();
    q.popFront();
    q.displayQueue();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:55:23.617

至少有一个主要问题，在`pushBack`您使用`temp`时没有初始化它：

```
 void Queue::pushBack(int d) 
 {
   Node* temp;

    if (temp == NULL) {
        ^^^^ 
```

在打开警告的情况下编译会在这里帮助你，使用`-Wall`标志`gcc`会给你以下警告：

```
warning: 'temp' is used uninitialized in this function [-Wuninitialized]
 if (temp == NULL) {
 ^ 
```

像这样使用一个未初始化的自动变量是[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)，这意味着您的程序的行为是不可预测的。另请参阅[C++ 标准是否在 C++1y 中使用不确定值和未定义行为发生了变化？](https://stackoverflow.com/q/23415661/1708801)以供参考。

您可能打算做的是这样的事情：

```
 Node* temp = new Node();

   temp->data = d ; 
```

虽然设置一个`constructor`for`Node`会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T03:01:30.200

你不能像这样设置一个变量：`temp->link = NULL;`

# c# - 如何在不创建多个线程的情况下发出并发请求？

> ID：15456991
> 
> 赞同：4
> 
> 时间：2013-03-17T02:52:31.220
> 
> 标签：c#

有人可以展示如何在不创建多个线程的情况下发出并发请求吗？例如，我想要一个发出 100 个 Web 请求的程序，并且我不希望任何时候有超过 8 个并发请求。我不想为 8 个并发请求创建 8 个线程。当一个线程发出异步请求时，同一个线程可用于发出下一个请求，依此类推。很抱歉，但我无法解决这个问题，并希望看到最好的解决方案。如果不清楚，我正在谈论的请求是异步的。我希望看到一个不使用任何锁并使用内置类来完成工作的解决方案。

这是我想出的一些代码，但它没有做它应该做的事情。

```
Task.Run(async () =>
                        {
                            var outstandingRequests = 0;
                            var requestCount = 0;
                            var tasks = new List<Task>(concurrentRequests);
                            while (requestCount < maxRequests)
                            {
                                if (outstandingRequests < concurrentRequests)
                                {
                                    tasks.Add(svc.GetDataAsync());  // a method that makes an async request
                                    Interlocked.Increment(ref outstandingRequests);
                                }
                                else
                                {
                                    var t = await Task.WhenAny(tasks);                                                                       
                                    Interlocked.Decrement(ref outstandingRequests);
                                    Interlocked.Increment(ref requestCount);
                                }
                            }
                            await Task.WhenAll(tasks);
                        }).Wait(); 
```

输出：

```
[] 1 Sending Request...Received Response 490,835.00 bytes in 15.6 sec
[] 2 Sending Request...
[] 3 Sending Request...
[] 4 Sending Request...
[] 5 Sending Request...
[] 6 Sending Request...
[] 7 Sending Request...
[] 8 Sending Request...
[] 9 Sending Request... 
```

我设置`concurrentRequests`为 5，所以上面的代码中有一些错误，因为它并行发出 8 个请求。最初它只并行发出 5 个请求，但一旦一个请求完成，它就又触发了 4 个请求（应该只触发一个）。

不得不修复一些错误，但现在一切都解决了：

```
Task.Run(async () =>
                        {
                            var outstandingRequests = 0;
                            var requestCount = 0;
                            // adding and removing from a List<> at the same time is not thread-safe,
                            // so have to use a SynchronizedCollection<>
                            var tasks = new SynchronizedCollection<Task>();
                            while (requestCount < maxRequests)
                            {
                                if (outstandingRequests < concurrentRequests)
                                {
                                    tasks.Add(svc.GetDataAsync(uri)); // this will be your method that makes async web call and returns a Task to signal completion of async call
                                    Interlocked.Increment(ref outstandingRequests);
                                    Interlocked.Increment(ref requestCount);
                                }
                                else
                                {                                    
                                    **tasks.Remove(await Task.WhenAny(tasks));**
                                    Interlocked.Decrement(ref outstandingRequests);                                    
                                }
                            }
                            await Task.WhenAll(tasks);
                        }).Wait(); 
```

如果有更好的方法，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T02:56:42.983

看起来您正在尝试重新发明线程池。不要那样做 - 只需使用现有功能： http: [//msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)
或者您可以使用请求方法的异步版本 - 它们基于线程游泳池也。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T16:08:31.070

~~这个怎么样：~~

 ~~```
Parallel.Invoke (new ParallelOptions { MaxDegreeOfParallelism = 8 },
    svcs.Select (svc => svc.GetDataAsync ()).ToArray ()) ; 
```~~ 

~~[这里](http://msdn.microsoft.com/en-us/library/ee789351.aspx)有一个有限并发任务计划程序的示例 Microsoft 实现。请参阅 SO 问题[System.Threading.Tasks - Limit the number of concurrent Tasks](https://stackoverflow.com/questions/2898609/system-threading-tasks-limit-the-number-of-concurrent-tasks)和[.Net TPL: Limited Concurrency Level Task scheduler with task priority？](https://stackoverflow.com/questions/9315937/net-tpl-limited-concurrency-level-task-scheduler-with-task-priority).~~

# ruby-on-rails - Rails如何在接受_nested_attributes_for时拒绝_if

> ID：15456993
> 
> 赞同：0
> 
> 时间：2013-03-17T02:53:19.440
> 
> 标签：ruby-on-rails

在我的位置模型中，我有以下内容..

```
has_many :location_polls 
```

在 LocationPoll 模型中，我有以下内容。

```
has_many :poll_locations 
```

现在回到位置模型，我想拒绝位置轮询，以防没有轮询位置。我怎样才能做到这一点？我尝试了以下，它没有工作..

```
accepts_nested_attributes_for :location_polls, :reject_if => lambda { |a| a[:poll_locations].empty? } 
```

如果我缺少帮助您回答问题的信息，我深表歉意。我不想把这个问题弄得乱七八糟。如果需要更多信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T21:26:25.863

如果您希望忽略任何空白`:location_polls`，您可以使用`:all_blank`它将创建一个 proc，该过程将拒绝所有属性为空白的记录，不包括任何 _destroy 值：

```
accepts_nested_attributes_for :location_polls, :reject_if => :all_blank 
```

# node.js - Mongoose 返回字段顺序不一致

> ID：15456994
> 
> 赞同：1
> 
> 时间：2013-03-17T02:53:27.190
> 
> 标签：node.js, mongodb, mongoose

我有一个非常简单的猫鼬查询，可以正确返回，但字段显示顺序不一致。请注意，有时它会列出 _id 然后是用户名，有时它会列出用户名然后是 _id。有任何解决这个问题的方法吗？

```
exports.list = function(req, res){
    return db.userModel.find({}, 'username', function (err, users) {
         if(!err) {
             return res.json(users);
         } else {
            console.log(err);
            return res.send(400);
        }
    });
 } 
```

输出

```
[
  {
    "username": "admin",
    "_id": "5145293a420135521c000001"
  },
  {
    "username": "bob",
    "_id": "5145293b420135521c000002"
  },
  {
    "_id": "5145293b420135521c000003",
    "username": "example"
  }
] 
```

# objective-c - 在每个页面中创建一个带有 UITableView 的 UIPageViewController

> ID：15456996
> 
> 赞同：1
> 
> 时间：2013-03-17T02:53:52.730
> 
> 标签：objective-c, xcode, uitableview, uipageviewcontroller

我已经阅读有关堆栈溢出的内容已经有一段时间了，但这是我的第一篇文章，只是因为这是我第一次遇到其他人似乎还没有解决的问题！

好吧，言归正传。将 UITableViews 放在 UIPageView 中应该是一件简单的事情，但我遇到了困难。我有一个 ViewController 和 contentViewController。我正在使用 .xibs 而不是故事板。contentViewController.xib 是一个表视图，而 ViewController.xib 是一个视图。我只专注于 iPhone。UITableView 连接到名为 theTableView 的 dataSource、delegate 和引用 Outlet。

该项目构建，但是当我运行它时，我收到以下错误消息：

```
 2013-03-17 16:14:23.026 pageApp[775:c07] *** Assertion failure in -[UITableView layoutSublayersOfLayer:], /SourceCache/UIKit_Sim/UIKit-2380.17/UIView.m:5776
    2013-03-17 16:14:23.028 pageApp[775:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Auto Layout still required after executing -layoutSubviews. UITableView's implementation of -layoutSubviews needs to call super.'
    *** First throw call stack:
    (0x1c93012 0x10d0e7e 0x1c92e78 0xb66665 0x6539f 0x10e46b0 0x228ffc0 0x228433c 0x228feaf 0x1042bd 0x4cb56 0x4b66f 0x4b589 0x4a7e4 0x4a61e 0x4b3d9 0x4e2d2 0xf899c 0x45574 0x4576f 0x45905 0x4e917 0x20eb 0x12157 0x12747 0x1394b 0x24cb5 0x25beb 0x17698 0x1beedf9 0x1beead0 0x1c08bf5 0x1c08962 0x1c39bb6 0x1c38f44 0x1c38e1b 0x1317a 0x14ffc 0x1d2d 0x1c55)
    libc++abi.dylib: terminate called throwing an exception 
```

这在 ViewController.m 中的 -(void)viewDidLoad{} 之后崩溃，我还没有学会如何修复自动布局/ layoutSubview 错误。还有人知道怎么做吗？

我在 ios 开发方面的经验有限，所以我确信我只是在正确的位置没有正确的部分。我使用[http://www.techotopia.com/index.php/An_Example_iOS_5_iPhone_UIPageViewController_Application](http://www.techotopia.com/index.php/An_Example_iOS_5_iPhone_UIPageViewController_Application)来做到这一点。

我的代码如下：

视图控制器.h

```
 #import <UIKit/UIKit.h>
    #import "contentViewController.h"

    @interface ViewController : UIViewController
    <UIPageViewControllerDataSource>
    {
        UIPageViewController *pageController;
        NSArray *pageContent;
    }
    @property (strong, nonatomic) UIPageViewController *pageController;
    @property (strong, nonatomic) NSArray *pageContent;
    @end 
```

视图控制器.m

```
 #import "ViewController.h"

    @interface ViewController ()

    @end

    @implementation ViewController
    @synthesize pageController, pageContent;

    - (contentViewController *)viewControllerAtIndex:(NSUInteger)index
    {
        // Return the data view controller for the given index.
        if (([self.pageContent count] == 0) || (index >= [self.pageContent count])) {
            return nil;
        }

        // Create a new view controller and pass suitable data.
        contentViewController *dataViewController =[[contentViewController alloc]initWithNibName:@"contentViewController"bundle:nil];
        dataViewController.dataObject =[self.pageContent objectAtIndex:index];
        return dataViewController;
    }

    - (NSUInteger)indexOfViewController:(contentViewController *)viewController
    {
        return [self.pageContent indexOfObject:viewController.dataObject];
    }

    - (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController
    {
        NSUInteger index = [self indexOfViewController:(contentViewController *)viewController];
        if ((index == 0) || (index == NSNotFound)) {
            return nil;
        }

        index--;
        return [self viewControllerAtIndex:index];
    }        

    - (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController
    {
        NSUInteger index = [self indexOfViewController:(contentViewController *)viewController];
        if (index == NSNotFound) {
            return nil;
        }

        index++;
        if (index == [self.pageContent count]) {
            return nil;
        }
        return [self viewControllerAtIndex:index];
    }

    - (void) createContentPages
    {
        NSMutableArray *pageStrings = [[NSMutableArray alloc] init];
        for (int i = 1; i < 4; i++)
        {        
            NSString *contentString = [[NSString alloc]initWithFormat:@"Chapter %d \nThis is the page %d of content displayed using UIPageViewController in iOS 5.", i, i];
            [pageStrings addObject:contentString];
        }
        pageContent = [[NSArray alloc] initWithArray:pageStrings];
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        [self createContentPages];

        self.pageController = [[UIPageViewController alloc]initWithTransitionStyle:UIPageViewControllerTransitionStyleScroll navigationOrientation:UIPageViewControllerNavigationOrientationHorizontal options:nil];

        pageController.dataSource = self;
        [[pageController view] setFrame:[[self view] bounds]];

        contentViewController *initialViewController = [self viewControllerAtIndex:0];
        NSArray *viewControllers = [NSArray arrayWithObject:initialViewController];

        [pageController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:nil];

        [self addChildViewController:pageController];
        [[self view] addSubview:[pageController view]];
        [pageController didMoveToParentViewController:self];
    }

    - (void)didReceiveMemoryWarning
    {
        [super didReceiveMemoryWarning];
        // Dispose of any resources that can be recreated.
    }

    @end 
```

内容视图控制器.h

```
 #import <UIKit/UIKit.h>

    @interface contentViewController : UIViewController
    @property (strong, nonatomic) IBOutlet UITableView *theTableView;
    @property (strong, nonatomic) id dataObject;
    @property (strong, nonatomic) NSArray *pageContent;
    @end 
```

内容视图控制器.m

```
 #import "contentViewController.h"

    @interface contentViewController ()

    @end

    @implementation contentViewController
    @synthesize theTableView, dataObject, pageContent;

    - (void)viewWillAppear:(BOOL)animated
    {
        [super viewWillAppear:animated];
    }
    - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
    {
        self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
        if (self) {
            // Custom initialization
        }
        return self;
    }

    - (void) createContentPages
    {
        NSMutableArray *pageStrings = [[NSMutableArray alloc] init];
        for (int i = 1; i < 4; i++)
        {
            NSString *contentString = [[NSString alloc]initWithFormat:@"Chapter %d \nThis is the page %d of content displayed using UIPageViewController in iOS 5.", i, i];
            [pageStrings addObject:contentString];
        }
        pageContent = [[NSArray alloc] initWithArray:pageStrings];
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        [self createContentPages];
    }

    - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection (NSInteger)section
    {
        return 4;
    }

    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath (NSIndexPath *)indexPath
    {
        static NSString *simpleTableIdentifier = @"SimpleTableItem";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
        }

        cell.textLabel.text = [pageContent objectAtIndex:indexPath.row];
        return cell;
    }

    - (void)didReceiveMemoryWarning
    {
        [super didReceiveMemoryWarning];
        // Dispose of any resources that can be recreated.
    }

    @end 
```

因此，如果有人能理顺我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:05:12.107

我能够解决自己的问题，但似乎我有点搞混了。

rdelmar 的评论让我走上了正确的道路，但我将委托和数据源连接到了错误的对象。我必须将它们连接到 File's Owner 才能使其工作。

此外，似乎没有必要使用 TableView，当我删除时，我的代码突然按预期工作。

如果这对答案还不够清楚，请告诉我如何更具体。谢谢！

# c++11 - 最终并覆盖 Geany 中的 C+11 说明符着色

> ID：15456998
> 
> 赞同：3
> 
> 时间：2013-03-17T02:54:15.467
> 
> 标签：c++11, syntax-highlighting, final, color-scheme, geany

我使用 Geany 1.22 进行开发，但在 C++11 关键字的着色方面遇到了问题。

这是我的 .cpp 配置文件：`filetypes.cpp`

```
# For complete documentation of this file, please see Geany's main documentation
[styling]
# foreground;background;bold;italic
default=default
comment=comment
commentline=comment
commentdoc=commentdoc
number=number
word=keyword
word2=keyword2
string=string
character=character
uuid=extra
preprocessor=preprocessor
operator=operator
identifier=default
stringeol=stringeol
# @"verbatim"
verbatim=extra
# (/regex/)
regex=extra
commentlinedoc=commentdoc
commentdockeyword=commentdoc
commentdockeyworderror=commentdoc
globalclass=type

[keywords]
# all items must be in one line
primary=and and_eq asm auto bitand bitor bool break case catch char class compl const const_cast continue default delete do double dynamic_cast else enum explicit export extern false float for friend goto if inline int long mutable namespace new not not_eq operator or or_eq private protected public register reinterpret_cast return short signed sizeof static static_cast struct switch template this throw true try typedef typeid typename union unsigned using virtual void volatile wchar_t while xor xor_eq static_assert decltype
secondary=
# these are some doxygen keywords (incomplete)
docComment=attention author brief bug class code date def enum example exception file fn namespace note param remarks return see since struct throw todo typedef var version warning union

[lexer_properties]
styling.within.preprocessor=1
preprocessor.symbol.$(file.patterns.cpp)=#
preprocessor.start.$(file.patterns.cpp)=if ifdef ifndef
preprocessor.middle.$(file.patterns.cpp)=else elif
preprocessor.end.$(file.patterns.cpp)=endif

[settings]
lexer_filetype=C

# default extension used when saving files
extension=cpp

# the following characters are these which a "word" can contains, see documentation
#wordchars=_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789

# if only single comment char is supported like # in this file, leave comment_close blank
comment_open=//
comment_close=
# this is an alternative way, so multiline comments are used
#comment_open=/*
#comment_close=*/

# set to false if a comment character/string should start at column 0 of a line, true uses any
# indentation of the line, e.g. setting to true causes the following on pressing CTRL+d
    #command_example();
# setting to false would generate this
#   command_example();
# This setting works only for single line comments
comment_use_indent=true

# context action command (please see Geany's main documentation for details)
context_action_cmd=

[build_settings]
# %f will be replaced by the complete filename
# %e will be replaced by the filename without extension
# (use only one of it at one time)
compiler=g++ -Wall -c "%f"
linker=g++ -Wall -o "%e" "%f"
run_cmd="./%e" 
```

如果我写：

```
class MyClass
{
}; 
```

定义一个新类，然后将 的颜色`MyClass`设置为 的颜色`globalclass`（与 关联的颜色`type`）

但是当我用 C++11 编写时：

```
class MyClass final
{
}; 
```

然后`final`（而不是`MyClass`）设置为 的颜色`globalclass`。如果我添加`final`到主要关键字列表中，则将其设置`word`为好的颜色，但`MyClass`仍不被解释为`globalclass`.

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T09:49:24.920

问题似乎是在 C++11 中，`final`并且`override`（我怀疑你会在那里遇到同样的问题）实际上不是关键字。它们是仅在特定上下文中获得特殊含义的标识符。这意味着您实际上不能在任何时候“仅仅”为这些标识符赋予颜色，您需要了解它们的上下文。

然而幸运的是，在 Geany 1.23 中已经为您完成了对 C++11 的所有支持。不幸的是，Geany 1.23 也没有做到 100% 正确。也就是说，如果有人写，`int final = 123;`那么 final 将被着色为关键字（而它实际上不是关键字）。所以他们实际上做的是：**他们添加了 final 作为主要关键字，这并不完全正确，但它 - 有点 - 工作。**

[所以我给你的建议是要么从这个链接](http://www.geany.org/Download/Releases)下载最新版本的 Geany，要么试试下面的配置文件：（来自 Geany 1.23）

```
# For complete documentation of this file, please see Geany's main documentation
[styling=C]

[keywords]
# all items must be in one line
primary=alignas alignof and and_eq asm auto bitand bitor bool break case catch char char16_t char32_t class compl const const_cast constexpr continue decltype default delete do double dynamic_cast else enum explicit export extern false final float for friend goto if inline int int8_t int16_t int32_t int64_t long mutable namespace new noexcept not not_eq nullptr operator or or_eq override private protected ptrdiff_t public register reinterpret_cast return short signed sizeof size_t static static_assert static_cast struct switch template this thread_local throw true try typedef typeid typename union unsigned using virtual void volatile wchar_t while xor xor_eq
secondary=
# these are the Doxygen keywords
docComment=a addindex addtogroup anchor arg attention author authors b brief bug c callergraph callgraph category cite class code cond copybrief copydetails copydoc copyright date def defgroup deprecated details dir dontinclude dot dotfile e else elseif em endcode endcond enddot endhtmlonly endif endinternal endlatexonly endlink endmanonly endmsc endrtfonly endverbatim endxmlonly enum example exception extends file fn headerfile hideinitializer htmlinclude htmlonly if ifnot image implements include includelineno ingroup interface internal invariant latexonly li line link mainpage manonly memberof msc mscfile n name namespace nosubgrouping note overload p package page par paragraph param post pre private privatesection property protected protectedsection protocol public publicsection ref related relatedalso relates relatesalso remark remarks result return returns retval rtfonly sa section see short showinitializer since skip skipline snippet struct subpage subsection subsubsection tableofcontents test throw throws todo tparam typedef union until var verbatim verbinclude version warning weakgroup xmlonly xrefitem

[lexer_properties]
styling.within.preprocessor=1
lexer.cpp.track.preprocessor=0
preprocessor.symbol.$(file.patterns.cpp)=#
preprocessor.start.$(file.patterns.cpp)=if ifdef ifndef
preprocessor.middle.$(file.patterns.cpp)=else elif
preprocessor.end.$(file.patterns.cpp)=endif

[settings]
lexer_filetype=C

# default extension used when saving files
extension=cpp

# the following characters are these which a "word" can contains, see documentation
#wordchars=_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789

# single comments, like # in this file
comment_single=//
# multiline comments
comment_open=/*
comment_close=*/

# set to false if a comment character/string should start at column 0 of a line, true uses any
# indentation of the line, e.g. setting to true causes the following on pressing CTRL+d
    #command_example();
# setting to false would generate this
#   command_example();
# This setting works only for single line comments
comment_use_indent=true

# context action command (please see Geany's main documentation for details)
context_action_cmd=

[indentation]
#width=4
# 0 is spaces, 1 is tabs, 2 is tab & spaces
#type=1

[build_settings]
# %f will be replaced by the complete filename
# %e will be replaced by the filename without extension
# (use only one of it at one time)
compiler=g++ -Wall -c "%f"
linker=g++ -Wall -o "%e" "%f"
run_cmd="./%e" 
```

但是，我不知何故怀疑上述内容是否会在不更新到 Geany 的下一个版本的情况下工作，因为您说仅添加“final”作为主要关键字对您不起作用。

另一方面，如果您仍想手动执行此操作，请查看[有关词法分析器属性的手册。](http://www.geany.org/manual/current/index.html#lexer-properties-section)

我希望这有帮助。

# c - 嵌入式：大多数 CRT 启动代码不使用 memcpy/memset - 为什么？

> ID：15456999
> 
> 赞同：18
> 
> 时间：2013-03-17T02:54:16.323
> 
> 标签：c, assembly, embedded

**背景：**
我正在研究 ARM 目标，更具体地说是 ST 的 Cortex-M4F 微控制器。在这样的平台（通常是微控制器）上工作时，显然没有操作系统；为了获得一个有效的 C/C++“环境”（此外，在变量初始化方面符合标准），必须有某种启动代码在重置时运行，在显式调用`main`. 正如我所暗示的，此类启动代码必须初始化已初始化的全局和静态变量（例如`int foo = 42;`在全局范围内）并将其他全局变量（例如在全局范围内）清零`int bar;`。然后，如有必要，将调用全局“ctors”。

在微控制器上，这仅仅意味着启动代码必须为每个初始化的全局（全部在“.data”部分中）将数据从闪存复制到 ram，并清除其他（全部在“.bss”中）。因为我使用 GCC，所以我必须提供这样的启动代码，我很高兴地分析了几个启动代码（及其相关的链接器脚本！）捆绑了我在 Internet 上找到的大量示例，所有示例都使用我正在开发的同一个演示板.

**问题：**
如前所述，我见过许多启动代码，它们以不同的方式初始化全局变量，其中一些在空间和时间方面比其他的更有效。但它们都有一些奇怪的共同点：它们*没有*使用`memset`nor `memcpy`，而是使用手写循环来完成这项工作。由于在可能的情况下使用标准函数对我来说似乎很自然（简单的“DRY 原则”），我尝试了以下方法来代替最初的手写循环：

```
/* Initialize .data section */
ldr r0, DATA_LOAD
ldr r1, DATA_START
ldr r2, DATA_SIZE
bl  memcpy       /* memcpy(DATA_LOAD, DATA_START, DATA_SIZE); */

/* Initialize .bss section */
ldr r0, BSS_START
mov r1, #0
ldr r2, BSS_SIZE
bl  memset       /* memset(BSS_START, 0, BSS_SIZE); */ 
```

...而且效果很好。节省的空间可以忽略不计，但现在显然很简单。

所以，我想了想，在这种情况下我认为没有理由做手写循环：

*   `memcpy`并且`memset`很可能无论如何都链接到可执行文件中，因为程序员会直接使用它，或者通过另一个库间接使用它；
*   它更小；
*   速度不是启动代码的一个非常重要的因素，但它可能更快；
*   几乎不可能弄错。

知道为什么不依赖`memcpy`和`memset`启动代码吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-17T03:14:11.003

我怀疑启动代码不想对`memcpy`libc 中的实现等做出假设。例如，实现`memcpy`可能使用 libc 初始化代码设置的全局变量来报告哪些 cpu 扩展可用，以便在支持此类操作的机器上提供优化的 SIMD 复制。在早期的“crt”启动代码运行时，这样一个全局的存储可能完全未初始化（包含随机垃圾），在这种情况下调用`memcpy`. 即使使调用*对您*有用，这也是实现的结果（或者甚至可能是 UB 的不可预测的结果......）使其工作；这可能不是 crt 代码想要依赖的东西。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-17T08:38:00.187

标准库是否链接完全由应用程序开发者决定（`--nostdlib`例如可以使用），但需要启动代码，因此不能做任何假设。

此外，启动代码的目的是建立一个可以运行C代码的环境；在此之前，任何可能合理假设完整运行时环境的库代码都不会正确运行，这绝不是给定的。对于有问题的函数，在许多情况下这可能不是问题，但您无法知道这一点。

启动代码至少要建立一个堆栈并初始化静态数据，在 C++ 中它额外调用全局静态对象的构造函数。标准库可能会合理地假设这些已经建立，因此在此*之前*使用标准库可能会导致错误行为。

最后，您应该清楚 C 语言和 C 标准库是不同的实体。语言必须能够独立存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T07:57:07.527

我认为这可能与“关于 memcy/memset 的内部状态的假设”没有任何关系，它们不太可能使用任何全局资源（尽管我认为它们确实存在一些奇怪的情况）。

微控制器上的所有启动代码通常都以这种方式编写“内联汇编程序”，这仅仅是因为它在代码的早期阶段运行，此时可能还没有堆栈，并且可能尚未执行 MMU 设置。因此，初始化代码不想冒险将任何东西放在堆栈上，就这么简单。函数调用把东西放在堆栈上。

因此，虽然这恰好是静态存储复制的初始化代码，但您也可能在其他此类初始化代码中找到相同的内联汇编程序。例如，您可能会在复制之前的某个地方找到一些用汇编器编写的基本寄存器设置代码，并且您还会在附近的某个地方找到汇编器中的 MMU 设置。