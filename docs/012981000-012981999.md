# StackOverflow 问答 12981000-12981999

# c++ - C++11 中一个好的 std::string 跨平台 UTF8 替代方案？

> ID：12981005
> 
> 赞同：2
> 
> 时间：2012-10-19T19:18:54.953
> 
> 标签：c++, string, wstring

我正在尝试`std::string`在游戏中找到一个很好的替代品。`wstring`在 Android 中无法正常工作。到目前为止，我只使用`ushort[]`范围`0-65535`（每个字符 2 个字节），它似乎适用于 11 种语言作为位图字体，但向前推进我希望获得更好的实现。

`u8"xxxyyy"`VC++ 编译器尚不支持文字符号，我还有哪些其他选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:25:46.803

阻力最小的路径可能是直接将 UTF-8 放入`std::string`对象中。对于不在 ASCII 范围内的任何内容，您将不得不使用手动编码的反斜杠转义来编写 UTF-8 文字，并且您将无法使用`locale`，但根据我的经验`locale`，无论如何都是无用的。我个人不能保证它的有用性，而且它非常庞大，但你*可能会*发现[ICU](http://site.icu-project.org/)图书馆有适合这种策略的例程。

# nhibernate - 相同的 LuceneNet 搜索查询在不同的服务器上返回不同的结果

> ID：12981008
> 
> 赞同：1
> 
> 时间：2012-10-19T19:18:57.420
> 
> 标签：nhibernate, lucene.net

我正在使用两台服务器，一台 Windows 2008 R2 Enterprise 和一台 Windows 2008 R2 Standard。

与构建 Lucene 索引和查询相关的所有内容都是相同的，但是在 2008 R2 Enterprise 框中搜索结果不正确。所有的程序集都是相同的版本，关于代码库的一切都是相同的。

我很困惑为什么会发生这种情况。任何人都可以对此有所了解吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T14:55:38.357

当您在 Lucene 中遇到类似的问题，并且您确定输入数据相同时，通常是因为您没有使用相同的分析器进行索引和搜索。

仔细检查您的休眠配置，以确保您在两台服务器上以相同的方式索引和搜索数据。

# c# - 是否有更优雅的形式将 NULL 分配给 InsertCommand 的 NVarChar？

> ID：12981012
> 
> 赞同：4
> 
> 时间：2012-10-19T19:19:13.800
> 
> 标签：c#, sql-server, sql-insert, sqldataadapter

这段代码非常适合我：

```
if (someStr == null)
  da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).Value = DBNull.Value;
else
  da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).Value = someStr; 
```

但我的直觉告诉我，它可能有一个单行版本。就像是：

```
 da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).Value = someStr==null ? DBNull.Value : someStr ; 
```

但是我刚刚在上面发布的单行代码当然会失败，因为`DBNull.Value`它没有转换为字符串。

有没有办法完成我如此渴望的一个班轮？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:27:24.040

您可以将 someStr 强制转换为对象

例如：

```
da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).Value = someStr==null ? DBNull.Value : (object)someStr; 
```

或者您可以按照 Oded 和 Servy 的建议进行操作并使用扩展方法。虽然它可能会添加几行代码，但它会让您避免重复代码。

正如 Servy 指出的那样，戴上它`object`可能会导致混乱。出于这个原因，我会戴上它`SqlParameter`

```
public static void SetValue(this SqlParameter parameter, object value)
{
    parameter.Value = value == null ? DBNull.Value : value;
} 
```

然后像这样使用它

```
da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).SetValue(someStr); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T19:21:02.293

创建一个函数或扩展方法来进行测试并根据需要进行分配。传入`someStr`和参数名称。

然后，您将能够在一行中设置参数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T19:23:58.747

您可以使用以下扩展方法（如果您愿意，也可以将其设为非扩展方法）

```
public static object ConvertNull(this object obj)
{
    return obj ?? DBNull.Value;
} 
```

然后你可以这样做：

```
da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).Value = someStr.ConvertNull() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-19T19:34:23.977

```
da.InsertCommand.Parameters.Add("@SOMESTR", SqlDbType.NVarChar).Value = ((object)someStr) ?? DBNull.Value; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T19:36:39.177

编写一个用于插入的存储过程，将参数的默认值设置为 null，将该存储过程用于插入命令，然后不要只将该参数传递给该 sproc..

# c# - mvc 3 中的 resx 本地化

> ID：12981016
> 
> 赞同：2
> 
> 时间：2012-10-19T19:19:34.493
> 
> 标签：c#, asp.net-mvc-3, localization

我在 App_GlobalResources 中有三个资源文件供查看：

```
ConditionsLabels.en.resx
ConditionsLabels.ua.resx
ConditionsLabels.ru.resx 
```

但我无法获得任何价值。我指定了自定义命名空间 (ViewRes)，但在视图中自动完成建议唯一的变体`@ViewRes.ConditionsLabels_ua`。（这是类）

我该如何使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:25:00.237

不要`App_GlobalResources`用于 MVC 项目。相反，将您的 .resx 文件放在标准文件夹中（例如，“资源”或其他）。接下来，在 Visual Studio 中选择 .resx 文件并更改以下属性：

```
Custom Tool: PublicResXFileCodeGenerator
Custom Tool Namespace: Resources 
```

现在您应该可以正常使用`Resources.MyResource.String1`等访问您的资源了。

# c - 当已经以“r+”模式打开时，在 C 中清除/截断文件

> ID：12981018
> 
> 赞同：6
> 
> 时间：2012-10-19T19:19:41.007
> 
> 标签：c, fopen, truncate, c89

我的代码目前看起来像这样（这些步骤分为多个功能）：

```
/* open file */
FILE *file = fopen(filename, "r+");

if(!file) {

  /* read the file */

  /* modify the data */

  /* truncate file (how does this work?)*/

  /* write new data into file */

  /* close file */
  fclose(file);
} 
```

我知道我可以使用 in 模式打开文件`"w"`，但在这种情况下我不想这样做。我知道/中有一个函数`ftruncate`，但我不想使用这些函数，我的代码应该是高度可移植的（在 Windows 上也是如此）。`unistd.h``sys/types.h`

是否有可能在不关闭/重新打开文件的情况下清除文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T20:01:42.037

使用标准 C，唯一的方法是每次需要截断时以“w+”模式重新打开文件。你可以用`freopen()`这个。"w+" 将继续允许从中读取，因此无需在 "r+" 模式下再次关闭并重新打开。“w+”的语义是：

> 开放阅读和写作。如果文件不存在，则创建该文件，否则将其截断。流位于文件的开头。

（取自 fopen(3) 手册页。）

使用时可以将 NULL 指针作为文件名参数传递`freopen()`：

```
my_file = freopen(NULL, "w+", my_file); 
```

如果您根本不需要从文件中读取，那么“w”模式也可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T19:48:10.223

你可以写一个这样的函数：（伪代码）

```
if(this is linux box) 
use truncate()
else if (this is windows box)
use _chsize_s() 
```

这是满足您要求的最直接的解决方案。

请参阅：msdn.microsoft.com 上的 man truncate 和 _chsize_s

并包含必要的头文件。

# design-patterns - GoF中有什么模式吗？

> ID：12981021
> 
> 赞同：9
> 
> 时间：2012-10-19T19:20:09.973
> 
> 标签：design-patterns

我目前正在学习设计模式考试（明天将举行......）。在“测试考试”之一中，我发现了以下问题：

> Jim Coplien 在特邀演讲中表示，GoF 书中甚至没有一种设计模式。您对此有何看法？

因为我没有参加这个特别的讲座（那是上学期；）我不知道他的意思。我没有证据表明 Jim Coplien 说过，但我认为这无关紧要。

**你认为他对这句话的意思是什么？**

（我不确定这个问题是否适合这个论坛，但是，我想问一下。）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-07-09T22:10:05.713

# 模式：概念植根于亚历山大的作品

GoF 声称从克里斯托弗·亚历山大 (Christopher Alexander) 那里获得了图案灵感（正如他们在书的开头所说的那样），他在更广泛的设计领域推广了这个术语。对亚历山大来说，模式：永远是模式语言的一个元素；有助于加深人的感情；并且本质上总是几何的。至少有一些 GoF 模式在其中至少一个点上失败了，并且有几个在所有三个点上都失败了。尽管“模式”是一个中性的英语单词，但 GoF 作品的文化和历史根源，加上他们对亚历山大灵感的援引，使其受制于其祖先的基本标准，因而显得缺乏。即使他们知道并表示他们知道，他们与亚历山大有些分歧，但他们仍然选择使用他精心设计、研究和推广的术语，我要他们对此负责。（也就是说，他们都是重要的熟人；我与几年前失去的 John Vlissides 关系密切，并与 Richard Helm 和 Eric Gamma 就这背后的更深层次问题进行了很好的对话。我与 Ralph 的讨论不太有趣因为他们停留在工程级别。）

## 历史根源

言语意味着事情。GoF（或整个软件社区）在写这本书时并没有很好地理解亚历山大对“模式”一词的理解，但他们建立在对时间的粗俗看法的基础上，这基于三个来源： 1\. Erich Gamma博士论文；2\. Ralph Johnson 的框架工作，以及 3\. C++ idioms book（你可以在 GoF book 的第 6.3 节对其来源的解释中找到这个）。（哦，Knuth 也有影响。）我继续向作者提出质疑，但人们喜欢它，他们喜欢人们喜欢它，所以势头继续。

几年后（2004 年 12 月 2 日），一位 GoF 会写信给我，描述他“啊哈”的经历，最终理解了亚历山大试图传达的内容。这与 GoF 书的内容有很大不同：

> 终于通过漫长曲折的路线摸索了“生成模式”和零碎的增长……主要是通过软件的一些有趣的通用属性（无标度和小世界）
> 
> 有时我有点慢...但最终到达那里...

# GoF 模式解决了偶然的问题，而不是本质的复杂性问题

不幸的是，人们发现它们有用是对现代编程语言的一种控诉。这些语言没有适当的结构来表达 Alexander 认为是模式特征的破坏对称性，这是复杂设计所固有的（秩序的本质，第 187 页：“ *……一般来说，一个大的对称性简化的新古典主义类型很少对事物的生命做出贡献，因为在世界上任何复杂的整体中，几乎总是有复杂的、不对称的力量在起作用——位置、背景和功能的问题——需要打破对称性*” ；同上，第 63-4 页：“*自然也创造了美丽的结构，这些结构是通过重复应用结构保持转换来控制的。在这方面，我认为有必要说一下我所说的结构保持变换与物理学中所谓的“对称破缺”密切相关。*”）。Java 在这方面特别糟糕，但它的祖先 Smalltalk 也是如此。C++ 有丰富的特性来描述局部对称性破坏，但大多数人并不真正知道如何使用它们。Richard Gabriel - 他也与 Alexander 密切合作，并且拥有像 CLOS 和 Scheme 这样的语言值得称赞的人 — 说他根本不理解 GoF 模式，因为设计合理的语言（如 CLOS 或 Scheme）不需要它们。我基本上属于同一个阵营。

## 设计运动

这背后有很多设计理论可以追溯到设计运动（Thackara（“现代主义之后的设计”，1989 年）、Naur、Alexander、Cross（“设计方法论的发展”，1984 年）和 1980 年代的其他作者）。鉴于当时设计运动工作的明显发现，程序员对这些文献知之甚少，而 CS 思维有多么错误，这总是让我感到惊讶。我们这些在 1993 年创立模式学科（The Hillside Group 的最初 7 个）的人都熟悉这些文献的主要主题。PLoP 会议演变出大量从这些基础彻底演变而来的文献，更关注神秘的知识，而不是亚历山大寻求的“无名质量”。

## 成语的起源

我为 C++ 程序员介绍习语的原因是为了让他们在语言遇到障碍时进行面向对象的编程。现在，我们有了更强大的方法，例如 DCI，大大减少了对成语的需求。模式仍然适用于域级别——这符合 Alexander 的愿景。已经编写了一些很好的模式语言；例如，Hanmer（容错软件的模式，2007 年）；由 Eloranta 等人撰写。（设计分布式控制系统，2014 年），以及 Alexander 自己指出的组织模式符合必要的标准（Coplien 和 Harrison，2004 年）。

# 战斗失败，但工作仍在继续

Alexander 和我（以及 Richard Gabriel——阅读了他的“软件模式”——以及其他人）对这个在被 GoF 重新定义之前在设计中已经确立的术语的早期重定向感到失望。是的，因为他们称它们为设计模式，它们就是设计模式——在任何关于四人组的设计模式书的讨论中。在更广泛的设计理论和架构方案中，它们不是：它们只是成语。正如作者自己所说，他们就是这样开始的。

正在努力恢复 Alexander 对软件社区的愿景。ScrumPLoP® 社区 ( [http://scrummplop.org](http://scrumplop.org) ) 非常重视所有亚历山大式的模式基础。亚历山大的一位老同事 Greg Bryant 曾经为 CES 做 IT 方面的工作，他联系了我，告诉我他的工作是为了让 Alexander 的愿景重新回到软件中，我们即将交换票据。我敢肯定迪克·加布里埃尔总是有一些想法，尽管他和我已经有一段时间没有聊天了。与此同时，我继续与亚历山大的同事中野博直接合作，他将亚历山大的想法（他直接用*永恒的道德经表达）*) 直接进入他们在日本文化中的相似之处。这比试图将其硬塞进西方文化要好得多。这可能解释了我在理解我的主张时的一些挫败感——尽管这不是从事知识业务的专业人士的借口。

# 对抱怨者的劝告

当然，所有这些基础都是发表的辩证法和研究的问题，任何愿意花时间研究它的人都可以使用。它不像这里那样随意，可以很快被驳回。我花了 20 年的时间——而且我可以直接接触到资源。我可以理解普通程序员很难深入研究这些东西，但我建议在放弃一个经过充分研究的职位之前做更多的研究，然后再做功课。这是 StackOverflow 的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T06:46:25.543

根据 GoF 自己的定义，它充满了设计模式。因此通过推断，Coplien 对设计模式有不同的定义，或者 Coplien 误解或歪曲了 GoF 的定义，或者他认为 GoF 的定义与 GoF 模式不匹配。

该问题邀请您描述两个定义之间的差异，并就您更喜欢哪个定义提供您的意见。可能您的合理意见，就像在学术界一样，您提出意见的理由（方法）比意见本身重要得多。

# java - Java继承和泛型，如何声明适用于“多种类型”继承的函数？

> ID：12981022
> 
> 赞同：3
> 
> 时间：2012-10-19T19:20:19.130
> 
> 标签：java, generics, inheritance

对于我想做的事情，我找不到一个好的问题/标题。我对泛型不是很熟悉，所以我在理解它们的工作原理时遇到了一些问题。

假设我有一个`Map<k,v>`将键映射到值的类。

```
class Map<K,V>{
    public V get(K key){
        //...
    }

    public void set(K key, V v){
        //...
    }
 } 
```

然后，我创建了两个子类：

```
class SuperMap<K,V> extends Map<K,V>{ /* ... */ }
class HyperMap<K,V> extends Map<K,V>{ /* ... */ } 
```

我想要的是创建一个可以采用任何映射并打印每个键和值的字符串表示的函数。所以我可以：

```
SuperMap<Unicorn, Horse> unicornsMap = ....;
HyperMap<Pegasus, Horse> pegasusMap = ....;

printMap(unicornsMap);
printMap(pegasusMap); 
```

`printMap`那么，函数签名应该是什么？

我试过：`void printMap(Map<Object, Horse>)`但它不起作用：

> MainClass 类型中的方法`printMap(Map<Object,Horse>)`不适用于参数 ( `HyperMap<Pegasus,Horse>`)
> 
> MainClass 类型中的方法`printMap(Map<Object,String>)`不适用于参数 ( `SuperMap<Unicorn,Horse>`)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:26:32.873

```
printMap(Map<?, Horse>) 
```

或者，交替

```
<K> printMap(Map<K, Horse>) 
```

# c# - 试图检测按键

> ID：12981024
> 
> 赞同：4
> 
> 时间：2012-10-19T19:20:22.533
> 
> 标签：c#, keypress

我制作了一种检测何时按下键的方法，但它不起作用！这是我的代码

```
void KeyDetect(object sender, KeyEventArgs e)
{ 
    if (e.KeyCode == Keys.W && firstload == true)
    {
        MessageBox.Show("Good, now move to that box over to your left");
        firstload = false;
    }
} 
```

我也尝试制作一个keyeventhandler，但是它说“无法分配给键检测，因为它是一个方法组”

```
public Gwindow()
{
    this.KeyDetect += new KeyEventHandler(KeyDetect);
    InitializeComponent();    
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T19:25:38.907

像这样使用按键事件：

```
private void Form1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyCode == Keys.F1 && e.Alt)
    {
        //do something
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-20T16:31:46.497

1）转到表单的属性

2) 查找“Misc”部分并确保“KeyPreview”设置为“True”

3) 转到表单的事件

4）查找“Key”部分并双击“KeyDown”以生成处理按键事件的函数

这是一些示例代码：

```
 private void Form1_KeyDown(object sender, KeyEventArgs e)
    {
        Console.WriteLine("You pressed " + e.KeyCode);
        if (e.KeyCode == Keys.D0 || e.KeyCode == Keys.NumPad0)
        {
            //Do Something if the 0 key is pressed (includes Num Pad 0)
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:22:43.143

您正在寻找`this.KeyPress`. 请参阅[如何处理 MSDN 上的按键事件](http://msdn.microsoft.com/en-us/library/ms171538%28v=vs.80%29.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T19:26:01.157

尝试使用该`KeyDown`事件。

只`KeyDown`在[MSDN中看到](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-09-21T18:30:24.163

做就是了

```
if (Input.GetKeyDown("/* KEYCODE HERE */"))
{
    /* CODE HERE */
} 
```

# excel - VBA 运行时错误 -214724809 (80070057)

> ID：12981033
> 
> 赞同：1
> 
> 时间：2012-10-19T19:20:48.080
> 
> 标签：excel, vba

我想根据另一个用户的选择填写一个下拉列表。我正在尝试通过在选择第一个组合框（cbo_park）后即时添加项目来根据另一个字段的选择来更新字段的内容。

我有四个下拉列表：

第一个下拉**cbo_park**有以下选项：

```
Central
East
West 
```

我有第二个名为**lookupRoom**的工作簿，其中包含下表：

```
roomCode    park
A.0.01      Central 
A.2.01      Central 
A.3.01      Central 
HE.0.10     East
HE.0.21     East
HE.0.22     East
KG.1.07     West
KG.1.09     West
KG.1.10     West 
```

当用户在第一个下拉列表**cbo_park**下选择中央公园选项时，我只希望中央公园中的房间显示在下拉列表**cbo_prefRoom1**、**cbo_prefRoom2**和**cbo_prefRoom3**中。我将如何实现这一目标？

请在下面找到我到目前为止的尝试。我一直收到一条错误消息：`Me.cbo_prefRoom1.RemoveItem 0`。

```
Private Sub cbo_park_Change()

Dim lLoop As Long, rgLoop As Range

    For lLoop = 1 To Me.cbo_park.ListCount

        Me.cbo_prefRoom1.RemoveItem 0

    Next lLoop

    Sheets("lookupRoom").[a1].CurrentRegion.AutoFilter
    Sheets("lookupRoom").[a1].CurrentRegion.AutoFilter Field:=3, Criteria1:=Left(Me.cbo_park.Value, 2)

    For Each rgLoop In Sheets("lookupRoom").[a1].CurrentRegion.Offset(1).SpecialCells(xlCellTypeVisible).Columns(1).Cells
        If Len(rgLoop) > 0 Then
            Me.cbo_prefRoom1.AddItem rgLoop
        End If
    Next rgLoop

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:48:33.343

以下是我实现这一目标的解决方案。

我重写了仅包含在一个`For`循环中的所有内容，并将其设置为更新两个组合框。

```
Private Sub cbo_park_Change()

    Dim lLoop As Long
    '- clear the two comboboxes we are about to update
    Me.cbo_prefRoom1.Clear
    Me.cbo_prefRoom3.Clear

    '- loop through the worksheet and test each row
    For lLoop = 1 To Sheets("lookupRoom").Range("A" & Sheets("lookupRoom").Rows.Count).End(xlUp).Row
        '- if the row's column C matches the combobox then add the corresponding values to other combos
        If Sheets("lookupRoo"m).Range("C" & lLoop).Value = Me.cbo_park.Value Then
            Me.cbo_prefRoom1.AddItem Sheets("lookupRoom").Range("B" & lLoop).Value
            Me.cbo_prefRoom2.AddItem Sheets("lookupRoom").Range("B" & lLoop).Value
        End If
    Next lLoop

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:38:22.973

目前尚不清楚您要达到的目标。如果要清除组合框中的所有条目，请使用此

```
Do While Me.combo.ListCount > 0
    Me.combo.RemoveItem(0)
Loop 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-21T03:34:34.087

以下是如何在不使用 VBA 且不使用组合框的情况下实现它。Excel 单元格具有类似于组合框的数据验证功能。由于它是电子表格的一部分，您不必担心大小和定位。

`A2`在 中使用标签“Park”`B2`作为输入单元格。将 B2 作为您的活动单元格，转到数据 -> 验证；选择`List`允许，然后输入`Central,East,West`源。试试看，看看你是否喜欢你的新下拉菜单。

现在是房间的“诡计”。

1.  输入. `="LookupRoom!A"&MATCH(B2,lookupRoom!B1:B10,0)&":A"&MATCH(B2,lookupRoom!B1:B10,1)`_`C2`
2.  再次转到`B3`我们的数据验证，但这次`=INDIRECT($C$2)`输入源输入。

尝试一下。现在您有一个响应您的公园选择的下拉菜单。

# windows - 在 Azure VM（或 EC2）中的 Windows 变体上进行产品安装/执行测试？

> ID：12981034
> 
> 赞同：2
> 
> 时间：2012-10-19T19:21:00.427
> 
> 标签：windows, testing, azure, amazon-ec2, virtual-machine

**的背景**

今天我在反思痛苦的安装/操作系统测试。当我们接近 Windows 软件的新版本时，我们必须验证：

1.  它安装没有问题
2.  它运行，给定合理的依赖关系
3.  我们对“更新”机器上可用内容的假设是正确的
4.  在一系列架构上（32/64 位等）
5.  在一系列操作系统版本（Windows XP、Windows Vista、7、8 等）上

我们可悲（但通常且具有成本效益）的方法是在现场旋转一些旧盒子。我们要么尝试将操作系统安装到 VM 系统中，要么被迫擦除盒子并进行本机安装，只是为了获得应用程序的“干净”安装。根据功能方法，恢复快照可能可用也可能不可用。

**理念**

我意识到 Windows Azure 使得这些天来启动虚拟机和“为所用的付费”变得非常容易。这似乎主要集中在网络托管上（Windows Server 2008 和 Windows Server 8 是“VM OS 选择”对话框中唯一可用的 Windows 变体）。有关概述，请参阅[此页面。](https://www.windowsazure.com/en-us/manage/windows/tutorials/virtual-machine-from-gallery/)

*但是，如果我可以启动其他类型的 Windows 操作系统映像纯粹用于测试呢？*

我订阅了 MSDN，并且可以访问我们应该支持的一组操作系统。我不能以某种方式推动这些并拥有可快照的按需测试主机吗？

**问题**

1.  现在使用 Windows Azure 是否可行？（我现在可以为 Server 2008 和 Server 8 执行此操作，看起来……我可以对其他操作系统映像执行此操作吗？）
2.  如果是这样，怎么做？（我可以以某种方式将 .vhd 上传到存储设备以使其显示在“我的图像”部分吗？）
3.  如果没有，有没有好的选择？（我觉得您可以使用 Amazon EC2 来做到这一点？我是不是找错了树？完全使用 VM 软件在现场尝试这样做会更好吗？）

在最好的情况下，我想要一组受支持的 Windows 操作系统的“新鲜”（最近修补过的）映像，我可以按需启动，为我使用的内容付费，然后再次关闭。这存在吗？

感谢您的时间和考虑...

PS不完全确定这是否应该在这里或服务器故障...请告知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:04:37.823

> 1.这在 Windows Azure 上现在可行吗？（我现在可以为 Server 2008 和 Server 8 执行此操作，看起来……我可以对其他操作系统映像执行此操作吗？）

Windows Server 是 2012，而不是 8。但无论如何。所以不行。目前支持的 Windows 系列操作系统有： * Windows Server 2008 SP2 x64, * Windows Server 2008 R2, * Windows Server 2012 请注意，它们都只是 64 位版本！坦率地说，我认为永远不会支持 Windows 客户端操作系统（如 XP、7、8）

> 2.如果有，怎么做？（我可以以某种方式将 .vhd 上传到存储设备以使其显示在“我的图像”部分吗？）

不，所以没办法。

> 3.如果没有，有什么好的选择吗？（我觉得您可以使用 Amazon EC2 来做到这一点？我是不是找错了树？完全使用 VM 软件在现场尝试这样做会更好吗？）

无法完全回答这个问题，但[快速搜索](http://aws.amazon.com/windows/)表明目前在 Amazon EC2 中您可以运行：

> 运行 Microsoft Windows Server® 的 Amazon EC2（在 2003 R2、2008 或 2008 R2 版本中可用）

到目前为止，Windows 操作系统。

总结：只有**Server** Windows OS 可以在 Azure 和 Amazon 中运行。

提示：您不能在 Azure 或 Amazon 的 Windows 服务器上安装 Hyper-V（您不能虚拟化已经虚拟化的内容）。

# reporting-services - 带有经典 ASP 的 SQL 服务器报告服务

> ID：12981035
> 
> 赞同：0
> 
> 时间：2012-10-19T19:21:00.647
> 
> 标签：reporting-services, asp-classic

**我在Classic Asp**中有一个应用程序，我需要使用**SQL Server Reporting Services**。将生成报告的页面有一些过滤器，我必须使用它。

我已经制作了**存储过程**和 SSRS 解决方案。我只想知道如何在经典 ASP 中调用报告。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T19:26:04.077

经过一番研究，我找到了我的解决方案。我在输入按钮中使用了onClick事件，调用了一个函数。见下面的代码：

“函数报告（）{

```
 var vexp_expediente = document.getElementById('txtexp_num_exp').value;
        var vpro_obs = document.getElementById('txtpro_obs').value;
        var vsit_id = document.getElementById('sit_id').value;
        var vpro_numero = document.getElementById('txtpro_numero').value;
        var vexp_requisitante = document.getElementById('txtexp_requisitante').value;
        var vexp_num_req = document.getElementById('txtexp_num_req').value;
        var vlic_id = document.getElementById('lic_id').value;
        var vare_id = document.getElementById('cboare_id').value;

        window.open("http://Report-Server/ReportServer?%2fSCPC%2fRel_Processos_Compra&exp_num_exp=" + vexp_expediente + "&pro_obs=" + vpro_obs + "&sit_id=" + vsit_id + "&pro_numero=" + vpro_numero + "&exp_requisitante=" + vexp_requisitante + "&exp_num_req=" + vexp_num_req + "&lic_id=" + vlic_id + "&are_id=" + vare_id + "&rs%3aCommand=Render&rs:ClearSession=true&rs%3aFormat=excel&rc%3aToolbar=False&rc%3aJavaScript=False&rc%3aLinkTarget=_top&rc%3aArea=Params");
    }

</script>" 
```

谢谢你试图提供帮助。

# java - java.sql.Date 月差

> ID：12981039
> 
> 赞同：2
> 
> 时间：2012-10-19T19:21:20.773
> 
> 标签：java

我有两个 java.sql.Date 对象，我需要计算两者之间的月数。这应该考虑月份的百分比。例如 10/1/2012 到 11/15/2012 应该返回 1.5 个月。是否有可用的图书馆可以为我做到这一点？有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:26:18.783

这类似于另一个计算两个日期之间天数的问题。使用天数，您可以除以每月的平均天数，以表示已经过去了多少个月。Joda Time 之类的东西可以提供这些信息。

回复： http: [//joda-time.sourceforge.net/](http://joda-time.sourceforge.net/) 回复：[Java 中两个日期之间的天数差异？](https://stackoverflow.com/questions/3299972/difference-in-days-between-two-dates-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:24:04.470

我会转换为 java.util.Date 然后进行计算

像这样的东西：

```
private final static double AVERAGE_MILLIS_PER_MONTH = 365.24 * 24 * 60 * 60 * 1000 / 12;

public static double monthsBetween(Date d1, Date d2) {
    return (d2.getTime() - d1.getTime()) / AVERAGE_MILLIS_PER_MONTH; 
} 
```

# php - 如果 被选中，再次运行查询

> ID：12981040
> 
> 赞同：0
> 
> 时间：2012-10-19T19:21:29.420
> 
> 标签：php, jquery, mysql

我有一个名为 Category 的下拉列表，这些选项由一个 PHP 脚本填充，该脚本在 MySQL 表中查询类别名称。

在它旁边，我有一个名为 Subcategory 的下拉列表，这些选项也由一个 PHP 脚本填充，该脚本在 MySQL 表中查询子类别名称。

我想根据从“类别”下拉列表中选择的类别重新运行子类别查询以更改“子类别”下拉列表的值。

而且我不希望页面刷新，所以我认为 jquery 可能在这里有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:31:52.527

一般来说，您不应该使用 jQuery（或任何其他框架），除非您已经在页面上下载它。当您的浏览器正在下载脚本和库（其中，jQuery 可能是最大的）时，您的页面的其余部分无法执行。我不知道为什么，但它不会下载图像，加载 iframe，什么都没有。

你可以做一个[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29)请求来下载新内容。请小心，因为这意味着您实际上是在编写一个可以访问数据库的 Web 服务，因此请确保验证服务器和 javascript 中的输入，并为删除/删除操作开发某种安全性。

这是 Ajax 的[原生 javascript 教程](http://www.w3schools.com/ajax/ajax_intro.asp)，但如果您对 AJAX 非常感兴趣，可以[使用它](http://api.jquery.com/jQuery.ajax/)。

基本目标是这样的：

1.  编写一个网页，将查询的新参数作为参数，然后
2.  用 AJAX 调用它，然后
3.  使用返回的信息重新填充您的下拉菜单。

在让 jQuery 为您完成这一切之前，我恳请您确保您了解本机代码中的 AJAX。即使你最终选择使用 jQuery 框架，它也会在调试、升级和重用这段代码时为你提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:27:06.613

像这样的东西？

```
$(document).ready(function(){
    var select = $("#select-element");
    select.change(function(){
        $.ajax({
            type : 'POST',
            url: "url-of-your-php-script",
            data: {
                'data-name' : 'data-to-send'               
            }
            success : function(returned){
               // Append variable  results to select..
            }                
        });            
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:30:59.137

1.  是的，您的权利必须专门使用 Jquery $.ajax() 或 $.post() 函数。
2.  子类别下拉列表应在更改事件上监听父类别。在 Jquery 中，您可以使用。

    $('#parent').change(function(){

    ```
     var parent = $(this).val();
           // Remove current subcategory options
           $('#child').children().remove();
           // AJAX POST
           $.ajax({

             type:'POST',

        data: 'parent='+parent,

        url: 'process.php',

        success: function(data){

                    // Fill the subcategory with new options using jquery each method 

                 }
               });

        }); 
    ```

# java - 生成 2^30 的随机数

> ID：12981042
> 
> 赞同：5
> 
> 时间：2012-10-19T19:21:34.523
> 
> 标签：java, c++, c

我想生成`2^30`0 到 2^10 范围内的随机数。我听说这个`rand()`函数不适合这么多数字。有没有其他方法可以生成几乎相等的分布？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T21:10:49.440

C++`<random>`库是一个很好的选择，有很多 PRNG 引擎和发行版可供选择。

```
#include <random>
#include <cstdint>
#include <iostream>

int main() {
    std::random_device r;
    std::seed_seq seed{r(), r(), r(), r(), r(), r(), r(), r()};
    std::mt19937_64 eng(seed);
    std::uniform_int_distribution<> dist(0, 1<<10);

    for (std::uint32_t i = 0; i< (1<<30); ++i) {
        int value = dist(eng);
        std::cout << value << ' ';
    }
} 
```

此外，random_device 本身就是一个引擎，根据实现，它可以提供对非确定性或加密 RNG 的访问：

```
std::random_device eng;
std::cout << dist(eng) << '\n'; 
```

例如，在 libc++ 中它默认使用 /dev/urandom，在 OS X 上它使用 Yarrow 加密 RNG 算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:40:57.813

在 Java 中，您可以使用 Random 在 2^48 个值之后重复。

```
Random rand = new Random();

for(int i = 0; i < (1<<30); i++) {
    int n = rand.nextInt(1 << 10);

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T23:32:20.693

> g_random_int() 返回在 [0..2^32-1] 范围内均匀分布的随机 guint32。

```
#include <glib.h>

int
main(void)
{
     g_print("%d\n", g_random_int());
   return 0;
} 
```

使用 gcc：

```
gcc -o rand rand.c `pkg-config --cflags --libs glib-2.0` 
```

编辑：

直接从 /dev/random 读取（不太便携），像往常一样编译：

```
#include <stdio.h>
#include <sys/types.h>
#include <fcntl.h>
#include <unistd.h>

int
main(void)
{
    int             fd;
    unsigned int    number;

    fd = open("/dev/random", O_RDONLY);

    read(fd, &number, sizeof(number));

    printf("%u\n", number);
    close(fd);
  return 0;
} 
```

PS：检查错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-20T05:46:21.643

这是一个旧的 Usenet 帖子，其中包含许多有趣的 RNG - 所有这些都非常容易实现。

[http://www.cse.yorku.ca/~oz/marsaglia-rng.html](http://www.cse.yorku.ca/%7Eoz/marsaglia-rng.html)

它们可能与 Mersenne twister 不太匹配，但我已经很好地利用了其中的几个，它们肯定优于一些默认的 rand() 实现。它们通过了随机性的 DIEHARD 测试，其中包含的最大周期生成器的周期 > 2^7700 并且只需要几行即可实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T19:33:29.217

Mark A. Overton于 2011 年 5 月 24 日在[Dr. Dobbs](http://drdobbs.com/tools/229625477)上发表了一篇关于相当简单但高质量的 RNG 的好文章

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T21:20:59.473

增加随机性和周期的简单方法：

```
public class Random2 {

    private static int LEN = 64;
    private final int[] buf = new int[LEN];
    private Random r;
    private final int maxInt = 1 << 10;

    public Random2() {
        r = new Random();
        for (int i = 0; i < LEN; i++)
            buf[i] = r.nextInt(maxInt);
    }

    public int nextInt() {
        int i = r.nextInt(LEN);
        int x = buf[i];
        buf[i] = r.nextInt(maxInt);
        return x;
    }

} 
```

# android - OpenGL 渲染到纹理 - 黑屏

> ID：12981043
> 
> 赞同：3
> 
> 时间：2012-10-19T19:21:35.843
> 
> 标签：android, opengl-es-2.0, framebuffer

我正在渲染到帧缓冲区，然后我想将其用作纹理。

我可以使用将帧缓冲区保存到文件中，`glReadPixels`因此我确信我渲染正常。

我可以绑定到固定纹理并渲染它。

但是我无法绑定到帧缓冲区来代替固定纹理进行渲染。

```
 //setup:
 private void setupRenderToTexture() {
    fb = new int[numberOfBuffers];
    depthRb = new int[numberOfBuffers];
    renderTex = new int[numberOfBuffers];
    texBuffer = new IntBuffer[numberOfBuffers];

    // generate
    GLES20.glGenFramebuffers(fb.length, fb, 0);
    GLES20.glGenRenderbuffers(depthRb.length, depthRb, 0);
    GLES20.glGenTextures(renderTex.length, renderTex, 0);

    GLErrorHandler.checkGlError("glGenFramebuffers");

    for (int i = 0; i < fb.length; i++) {
        GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, fb[i]);

        // generate color texture
        GLState.Instance.bindTexture(0, renderTex[i]);

        // parameters
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
        // GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE);
                GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_REPEAT);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
        // GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);
                GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_REPEAT);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
                GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
                GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_LINEAR);

        // create it
        // create an empty intbuffer first?
        int[] fileData = new int[width * height];
        texBuffer[i] = IntBuffer.wrap(fileData);
        GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGBA, width,
                height, 0, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE,
                texBuffer[i]);

        GLES20.glFramebufferTexture2D(GLES20.GL_FRAMEBUFFER, GLES20.GL_COLOR_ATTACHMENT0, GLES20.GL_TEXTURE_2D,
                renderTex[i], 0);

        // create render buffer and bind 16-bit depth buffer
        GLES20.glBindRenderbuffer(GLES20.GL_RENDERBUFFER, depthRb[i]);
        GLES20.glRenderbufferStorage(GLES20.GL_RENDERBUFFER,
                GLES20.GL_DEPTH_COMPONENT16, width, height);
        GLErrorHandler.checkGlError("glRenderbufferStorage or above");
    }

    GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, 0);
} 
```

使用帧缓冲区：

```
GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, fb[0]); 
```

保存帧缓冲区（用于测试）：

```
GLES20.glReadPixels(sourceX, sourceY, width, height, GL10.GL_RGBA,  
GL10.GL_UNSIGNED_BYTE, ib); 
```

然后渲染到屏幕：

```
GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, 0);
GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, fb[0]);
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture); //some simple texture works but:
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, renderTex[0]); //frame buffer texture does not work 
```

如果我绑定到，我得到的只是黑屏`renderTex[0]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T18:54:10.890

您误用了 FBO。您必须附加一个空纹理，以便它可以渲染到其中。看到这个[页面](http://www.songho.ca/opengl/gl_fbo.html)

# c++ - 避免 /usr/include/boost

> ID：12981044
> 
> 赞同：1
> 
> 时间：2012-10-19T19:21:41.200
> 
> 标签：c++, include-path

在带有相当旧版本的 boost in 的旧版本 rhel 上运行`/usr/include/boost`。安装了更现代的 boost 版本并添加了适当的`-I`选项，`g++`以便它几乎总是进入 boost 标头的新目录。问题是很多代码库是多年前为旧版本的 boost 编写的，并且包含在更现代的 boost 中不存在的标头。在这种情况下，`cpp`愉快地包含来自`/usr/include/boost`. 避免这种情况的最佳方法是什么？我宁愿不改变`#include <boost/file.hpp>`明确地指向一个不同的地方，除非我必须这样做，并且如果我只知道它们是什么，我非常乐意清理依赖于已灭绝标头的代码。这可能是一个持续存在的问题，因为一些从事该项目的程序员可能习惯性地包含已灭绝的标头，因此仅检查一次是不够的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:47:39.007

与其尝试更改代码查找包含的位置，或者更改生成文件以包含其他目录，不如更改其内容`/usr/include/boost`以使其指向新内容？

这是我要尝试做的事情：

1.  重命名`/usr/include/boost`为别的东西，也许`/usr/include/boost-old`
2.  创建一个指向`/usr/include/boost`->的符号链接`/usr/boost/include/boost-old`
3.  您现在可以通过编译您的应用程序来测试此配置。它应该包括旧的 Boost 库。
4.  将新的 Boost 库安装到新目录，比如`/usr/include/boost-new`
5.  将 suymbolic 链接更改为指向新库`/usr/include/boost`->`/usr/include/boost-new`

# c# - 签入前运行单元测试

> ID：12981046
> 
> 赞同：12
> 
> 时间：2012-10-19T19:21:44.593
> 
> 标签：c#, visual-studio, unit-testing, tdd, bdd

使用 Visual Studio 和 TFS，最好使用 Specflow 或标准单元测试。

我希望开发人员在签入之前将所有单元测试作为策略运行。如果单元测试中断，那么 vS 应该阻止他们签入，就像在合并冲突中运行时一样。

我知道有后期构建脚本可以做到这一点，但如果单元测试中断，我宁愿它根本不会进入源代码控制。另外，等待完整构建的转身相当缓慢。然后是关于谁打破谁的东西的争吵。

所以不，我希望在签入之前在本地通过单元测试。我该怎么做？是的，他们可以按一下按钮，但我喜欢让他们比这更“激励”一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T11:13:07.703

听起来您所追求的是**TFS Gated Check-in**。这可以确保代码构建、合并以及测试在提交签入之前成功运行。你可以在这里读更多关于它的内容：

> [门控值机简介](http://blogs.msdn.com/b/patcarna/archive/2009/06/29/an-introduction-to-gated-check-in.aspx)

值得注意的是，它的过程比 CI 构建慢得多，因此根据您的开发人员进行的签入次数，您最好查看启用“失败时创建工作项”并设置项目警报的 CI 构建通知开发人员他们破坏了构建。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T19:25:38.750

[TeamCity Visual Studio 插件支持预先测试的](http://www.jetbrains.com/teamcity/features/delayed_commit.html)提交。但是，我不能代表 TFS。

# java - 休眠到 MSSQL 服务器连接被拒绝：连接

> ID：12981051
> 
> 赞同：0
> 
> 时间：2012-10-19T19:21:53.497
> 
> 标签：java, sql-server, hibernate

我试图运行一个使用休眠访问 MSSQL 服务器的 Java 桌面应用程序，但是在尝试连接时，它会引发异常，我真的不知道该怎么办，这是我的配置文件

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
      "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
      "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<!-- Generated by MyEclipse Hibernate Tools.                   -->
<hibernate-configuration>

<session-factory>
<property name="connection.username"></property>
<property name="connection.password"></property>
<property name="connection.url">
    jdbc:jtds:sqlserver://localhost/databasename;useNTLMv2=true
</property>

<property name="dialect">
    ba.fit.utilities.FDialect_SqlServer
</property>
<property name="myeclipse.connection.profile">nova 3</property>

<property name="connection.driver_class">
    net.sourceforge.jtds.jdbc.Driver
</property>

<!-- JDBC connection pool (use the built-in) -->
<property name="connection.pool_size">1</property>

<!-- Opcije printanja SQL koda u konzolnom prozoru-->
<property name="show_sql">true</property>
<property name="format_sql">false</property>
<property name="use_sql_comments">false</property>

<!--vrijednost "update" kreira tabele ako nepostoje, ali ih nece mijenjati ako ima potrebe-->
<property name="hibernate.hbm2ddl.auto">update</property>

<!-- Enable Hibernate's automatic session context management -->
<property name="current_session_context_class">thread</property>

<!-- Disable the second-level cache -->
<property name="cache.provider_class">
    org.hibernate.cache.NoCacheProvider
</property>

<!-- mapirane klase koje trebaju biti "persistence" -->
<!-- 

-->
<mapping class="ba.fit.Tomo_seminar.model.Administrator" />
<mapping class="ba.fit.Tomo_seminar.model.BiografijaPosloprimca" />
<mapping class="ba.fit.Tomo_seminar.model.BiografijaPoslodavca" />
<mapping class="ba.fit.Tomo_seminar.model.Drzava" />
<mapping class="ba.fit.Tomo_seminar.model.Grad" />
<mapping class="ba.fit.Tomo_seminar.model.Kategorija" />
<mapping class="ba.fit.Tomo_seminar.model.KategorijaBiografija" />
<mapping class="ba.fit.Tomo_seminar.model.OcjenePoslodavca" />
<mapping class="ba.fit.Tomo_seminar.model.OcjenePosloprimca" />
<mapping class="ba.fit.Tomo_seminar.model.Poslodavac" />
<mapping class="ba.fit.Tomo_seminar.model.Posloprimaoc" />
<mapping class="ba.fit.Tomo_seminar.model.Projekt" />
<mapping class="ba.fit.Tomo_seminar.model.ProjektKategorija" />
<mapping class="ba.fit.Tomo_seminar.model.Racun" />
<mapping class="ba.fit.Tomo_seminar.model.StatusTuzbe" />
<mapping class="ba.fit.Tomo_seminar.model.StrucnaSprema" />
<mapping class="ba.fit.Tomo_seminar.model.Tuzba" />
<mapping class="ba.fit.Tomo_seminar.model.Uplatnica" />
<mapping class="ba.fit.Tomo_seminar.model.ZahtjevZaRadNaProjektu" />
<mapping class="ba.fit.Tomo_seminar.model.RadnoVrijeme" />

</session-factory>

</hibernate-configuration> 
```

但我得到了这个例外

```
20:52:43,562  WARN SettingsFactory:109 - Could not obtain connection metadata
java.sql.SQLException: Network error IOException: Connection refused: connect
at net.sourceforge.jtds.jdbc.ConnectionJDBC2.<init>(ConnectionJDBC2.java:410)
at net.sourceforge.jtds.jdbc.ConnectionJDBC3.<init>(ConnectionJDBC3.java:50)
at net.sourceforge.jtds.jdbc.Driver.connect(Driver.java:184)
at java.sql.DriverManager.getConnection(Unknown Source)
at java.sql.DriverManager.getConnection(Unknown Source)
at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)
at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:76)
at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:1933)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1216)
at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)
at ba.fit.utilities.HibernateUtil.<clinit>(HibernateUtil.java:24)
at ba.fit.Tomo_seminar.persistence.PosloprimaocDAO.pronadji(PosloprimaocDAO.java:17)
at ba.fit.Tomo_seminar.services.servLogin.LoginPosloprimaoc(servLogin.java:31)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin.do_btnLogin_widgetSelected(FrmLogin.java:142)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin$1.widgetSelected(FrmLogin.java:92)
at org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin.main(FrmLogin.java:44)
Caused by: java.net.ConnectException: Connection refused: connect
at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)
at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
at java.net.PlainSocketImpl.connect(Unknown Source)
at java.net.SocksSocketImpl.connect(Unknown Source)
at java.net.Socket.connect(Unknown Source)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at net.sourceforge.jtds.jdbc.SharedSocket.createSocketForJDBC3(SharedSocket.java:307)
at net.sourceforge.jtds.jdbc.SharedSocket.<init>(SharedSocket.java:257)
at net.sourceforge.jtds.jdbc.ConnectionJDBC2.<init>(ConnectionJDBC2.java:311)
... 20 more
20:52:46,015 ERROR SchemaUpdate:134 - could not get database metadata
java.sql.SQLException: Network error IOException: Connection refused: connect
at net.sourceforge.jtds.jdbc.ConnectionJDBC2.<init>(ConnectionJDBC2.java:410)
at net.sourceforge.jtds.jdbc.ConnectionJDBC3.<init>(ConnectionJDBC3.java:50)
at net.sourceforge.jtds.jdbc.Driver.connect(Driver.java:184)
at java.sql.DriverManager.getConnection(Unknown Source)
at java.sql.DriverManager.getConnection(Unknown Source)
at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)
at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:27)
at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)
at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:314)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1218)
at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)
at ba.fit.utilities.HibernateUtil.<clinit>(HibernateUtil.java:24)
at ba.fit.Tomo_seminar.persistence.PosloprimaocDAO.pronadji(PosloprimaocDAO.java:17)
at ba.fit.Tomo_seminar.services.servLogin.LoginPosloprimaoc(servLogin.java:31)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin.do_btnLogin_widgetSelected(FrmLogin.java:142)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin$1.widgetSelected(FrmLogin.java:92)
at org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin.main(FrmLogin.java:44)
Caused by: java.net.ConnectException: Connection refused: connect
at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)
at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
at java.net.PlainSocketImpl.connect(Unknown Source)
at java.net.SocksSocketImpl.connect(Unknown Source)
at java.net.Socket.connect(Unknown Source)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at net.sourceforge.jtds.jdbc.SharedSocket.createSocketForJDBC3(SharedSocket.java:307)
at net.sourceforge.jtds.jdbc.SharedSocket.<init>(SharedSocket.java:257)
at net.sourceforge.jtds.jdbc.ConnectionJDBC2.<init>(ConnectionJDBC2.java:311)
... 21 more
20:52:46,015 ERROR SchemaUpdate:165 - could not complete schema update
java.sql.SQLException: Network error IOException: Connection refused: connect
at net.sourceforge.jtds.jdbc.ConnectionJDBC2.<init>(ConnectionJDBC2.java:410)
at net.sourceforge.jtds.jdbc.ConnectionJDBC3.<init>(ConnectionJDBC3.java:50)
at net.sourceforge.jtds.jdbc.Driver.connect(Driver.java:184)
at java.sql.DriverManager.getConnection(Unknown Source)
at java.sql.DriverManager.getConnection(Unknown Source)
at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)
at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:27)
at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)
at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:314)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1218)
at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)
at ba.fit.utilities.HibernateUtil.<clinit>(HibernateUtil.java:24)
at ba.fit.Tomo_seminar.persistence.PosloprimaocDAO.pronadji(PosloprimaocDAO.java:17)
at ba.fit.Tomo_seminar.services.servLogin.LoginPosloprimaoc(servLogin.java:31)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin.do_btnLogin_widgetSelected(FrmLogin.java:142)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin$1.widgetSelected(FrmLogin.java:92)
at org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at ba.fit.imeprojekta.ui.gui.v1.FrmLogin.main(FrmLogin.java:44)
Caused by: java.net.ConnectException: Connection refused: connect
at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)
at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
at java.net.PlainSocketImpl.connect(Unknown Source)
at java.net.SocksSocketImpl.connect(Unknown Source)
at java.net.Socket.connect(Unknown Source)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at net.sourceforge.jtds.jdbc.SharedSocket.createSocketForJDBC3(SharedSocket.java:307)
at net.sourceforge.jtds.jdbc.SharedSocket.<init>(SharedSocket.java:257)
at net.sourceforge.jtds.jdbc.ConnectionJDBC2.<init>(ConnectionJDBC2.java:311)
... 21 more
20:52:47,328  WARN JDBCExceptionReporter:71 - SQL Error: 0, SQLState: 08S01
20:52:47,328 ERROR JDBCExceptionReporter:72 - Network error IOException: Connection refused: connect 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:49:22.583

似乎 connection.url 有问题。正确的网址是

```
 <property name="hibernate.connection.driver_class">com.microsoft.sqlserver.jdbc.SQLServerDriver</property>

    <property    name="hibernate.connection.url">jdbc:sqlserver://machine:1433;databaseName=databaseName;</property> 
```

# ruby - jruby 多线程 const_missing

> ID：12981052
> 
> 赞同：1
> 
> 时间：2012-10-19T19:21:53.990
> 
> 标签：ruby, multithreading, jruby

我正在尝试在 JRuby 循环中并行处理（使用 peach），但在平稳运行大约 30 秒后因 const_missing 错误而崩溃：

```
lib/ruby/gems/1.8/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:452:in `load_missing_constant'
lib/ruby/gems/1.8/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:106:in `const_missing_with_dependencies'
lib/ruby/gems/1.8/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:118:in `const_missing'
lib/ruby/gems/1.8/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:463:in `load_missing_constant'
lib/ruby/gems/1.8/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:122:in `const_missing' 
```

我正在使用 jrub 1.5.2：

```
C:\projects\sami\build>jruby -v
jruby 1.5.2 (ruby 1.8.7 patchlevel 249) (2010-08-20 1c5e29d) (Java HotSpot(TM) 64-Bit Server VM 1.6.0_11) [amd64-java] 
```

我已经设置了我的环境以启用多线程：

```
config.cache_classes = true
config.threadsafe!
config.dependency_loading = true if $rails_rake_task 
```

我还可以做些什么！？

TIA

# javascript - jquery灯箱技术

> ID：12981055
> 
> 赞同：-5
> 
> 时间：2012-10-19T19:22:18.097
> 
> 标签：javascript, jquery, css

Lightbox 使用某种 javascript/jquery 来检查用户何时单击图像外部以及何时关闭灯箱。

有人可以为我命名那个 Javascript/jQuery 函数吗？

**我不要求代码！，只是为了名字！**

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:23:48.813

许多模态库所做的是创建完整窗口大小的覆盖，透明或不可见，并检测对该元素的点击。这是对“内容窗口”元素的补充。它只是检测点击，然后调用您的关闭例程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:26:21.103

有许多。这是一个列出十个的网站 - 我希望大多数（如果不是全部）显示您的特定要求。

[http://line25.com/articles/rounding-up-the-top-10-jquery-lightbox-scripts](http://line25.com/articles/rounding-up-the-top-10-jquery-lightbox-scripts)

# git - 壁球变基后，如何使 git 分支历史记录与 master 匹配？

> ID：12981059
> 
> 赞同：3
> 
> 时间：2012-10-19T19:22:36.697
> 
> 标签：git, rebase, squash

假设我有以下树结构：

```
A-B-C-D
    |\E-F (branch one)
     \G-H (branch two)

Master history: A-B-C-D
Branch one history: A-B-C-E-F
Branch two history: A-B-C-G-H 
```

我想压缩提交 B，所以各自的历史应该如下所示：

```
A-C-D
A-C-E-F
A-C-G-H 
```

我发现，在我 squash master 之后，当我结帐分支一或两个时，当我运行 git log 时，它们仍然显示旧的历史记录。分支时git会复制树吗？我是否需要单独重新设置每个分支？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:24:14.497

是的，您需要单独重新设置每个分支。删除提交 B 后，您得到

```
Master history: A-C'-D'
Branch one history: A-B-C-E-F
Branch two history: A-B-C-G-H 
```

其中 C' 和 D' 与 C 和 D 类似，除了 B 从历史记录中删除。分支一和二不受主变基的影响。结果的另一种观点是：

```
A-C'-D'
|\B-C-E-F (branch one)
 \B-C-G-H (branch two) 
```

现在，A，而不是 C，是所有分支中最近的共同祖先。

# asp.net - 使用 javascript 动态加载 asp.net 控件

> ID：12981061
> 
> 赞同：0
> 
> 时间：2012-10-19T19:22:43.017
> 
> 标签：asp.net, ajax, json, html, c#-4.0

我正在开发一系列 ASP.NET 控件，允许动态创建站点，其中布局从 class.cs 文件生成，然后控件被加载到更新面板中的占位符中。

我希望实现的是使用 ajax 之类的东西来用 javascript 构建屏幕。

你们能不能指出我正确的方向，我的谷歌今天没有帮助。

我想使用ajax，json之类的东西

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:26:27.447

Javascript 是一种客户端脚本语言，不能用于触发加载服务器端控件。不过，您可以使用 ASP.NET 等元素，这些元素必须`runat=server`触发服务器端代码。

通过 AJAX？没有页面重新加载是不可能的。

# vba - 嵌套for循环错误VBA

> ID：12981062
> 
> 赞同：0
> 
> 时间：2012-10-19T19:22:46.503
> 
> 标签：vba, loops, for-loop, nested

我做了一个嵌套的 For 循环，如图所示：

```
For i = 1 To 14
Set curCell_a = Worksheets("Sheet1").Cells(i, 6)    

If curCell_a.Value = 100 Then
Set curCell_b = curCell_a.Offset(3, -1)
cRow = curCell_b.Row     

For j = cRow To 15
Set curCell_c = Worksheets("Sheet1").Cells(cRow, 5)
While curCell_c.Font.Bold = False
MsgBox (curCell_c.Value)
End

Next j    
End If    
Next i 
```

然而我不断收到错误`Compile error: Next without For`

我很确定我`Next j, End If, and Next i`按逻辑顺序排列...有人可以帮助我吗？太感谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:31:29.030

我认为问题在于`End`声明：它应该是`Wend`（While-End）。

```
For i = 1 To 14

    Set curCell_a = Worksheets("Sheet1").Cells(i, 6)

    If curCell_a.Value = 100 Then

        Set curCell_b = curCell_a.Offset(3, -1)
        cRow = curCell_b.Row

        For j = cRow To 15
            Set curCell_c = Worksheets("Sheet1").Cells(cRow, 5)
            While curCell_c.Font.Bold = False
                MsgBox (curCell_c.Value)
            Wend
        Next j

    End If

Next i 
```

请参阅[http://office.microsoft.com/en-us/excel-help/HV080557576.aspx](http://office.microsoft.com/en-us/excel-help/HV080557576.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:34:56.503

while 块需要以 Wend 结束，而不是 End。编译器没有看到该块的结尾。

# java - 使用扫描仪或字符串方法在字符串中进行多次搜索（java）

> ID：12981067
> 
> 赞同：1
> 
> 时间：2012-10-19T19:23:21.347
> 
> 标签：java, string, extract, java.util.scanner

我需要从如下所示的字符串中提取几个整数：

22:43:12:45

我需要提取 22、43、12 和 45 作为单独的整数。我需要使用字符串方法或扫描仪方法来读取直到：并提取 22。然后在第一个：和第二个：之间读取给我 43，依此类推。

我可以提取到第一个：没问题，但我知道之后该怎么做。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:26:36.227

```
String[] parts = str.split(":");
int[] numbers = new int[parts.length]; 
```

遍历此 String 数组以获取整数数组：

```
int index = 0;
for(String part : parts)
    numbers[index++] = Integer.parseInt(part); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:46:48.070

您只能使用[`indexOf`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#indexOf%28int,%20int%29)和[`substring`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#substring%28int,%20int%29)方法[`String`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)：

```
String text = "22:43:12:45";
int start = 0;
int colon;
while (start < text.length()) {
    colon = text.indexOf(':', start);
    if (colon < 0) {
        colon = text.length();
    }

    // You can store the returned value somewhere, in a list for example
    Integer.parseInt(text.substring(start, colon)));

    start = colon + 1;
}; 
```

* * *

使用 Scanner 更简单：

```
String text = "22:43:12:45";
Scanner scanner = new Scanner(text);
scanner.useDelimiter(":");
while (scanner.hasNext()) {
    // Store the returned value somewhere to use it
    scanner.nextInt();
} 
```

但是，[`String.split`是最短的解决方案](https://stackoverflow.com/a/12981114/572834)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:25:39.013

做一个像这样的[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)

```
(\d\d):(\d\d):(\d\d):(\d\d) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:43:05.990

你应该看看 String.split 方法。给定一个正则表达式，此方法会根据它拆分字符串。在您的情况下，正则表达式是“：”

```
String s ="22:43:12:45";
int i =0;
for (String s1 : s.split(":")) {  // For each string in the resulting split array 
     i = Integer.parseInt(s1);
     System.out.println(i);
} 
```

拆分返回一个字符串数组，其中您的字符串是分开的。因此，在这种情况下，生成的字符串数组将在第 0 个位置具有“22”，在第一个位置具有“43”，依此类推。要将这些转换为整数，您可以使用 parseInt 方法，该方法接受一个字符串并给出等效的 int。

# android - android，未知主机异常

> ID：12981069
> 
> 赞同：0
> 
> 时间：2012-10-19T19:23:40.080
> 
> 标签：android, web-services, dns, host

> **可能重复：**
> [如何解决 UnknownHostException](https://stackoverflow.com/questions/12903644/how-to-solve-unknownhostexception)

尝试`Unknown Host`在模拟器上查询服务器时出现异常。我已经为此工作了一周，所以：

*   我在清单中有 Internet 权限。
*   模拟器可以上网，我可以去谷歌导航。
*   防火墙关闭。
*   我在机器的主机和模拟器的主机中都设置了服务器和 IP 名称。
*   我试图打开和关闭模拟器上的 Wi-Fi。
*   我试图重新启动模拟器。
*   我试图删除 AVD 并创建一个新的。不工作。
*   重新启动计算机也不执行任何操作。
*   返回 JSON 数据的 Web 服务的 USL 在 Web 浏览器中有效，但在模拟器中无效。
*   我尝试创建一个新项目，只是为了证明从服务器读取 JSON 并得到相同的错误。

有什么建议吗？

这是代码：

```
public class OrderRequestParser{

public static final String url = "http://srvsapqas.mejiarcala.com:8000/sap(bD1lcyZjPTYwMA==)/bc/bsp/sap/zsilm_not/consultarbuzon.htm?FILTRO=USUARIO&PATRON=CESTEVEZ#";
    private HttpClient httpClient;
    private HttpGet del;

public List<OrderRequest> listOrderRequest()
    {

try {

            del = new HttpGet(urlSevicioCarlo);
            httpClient = new DefaultHttpClient();
            del.setHeader("content-type", "application/json");

            HttpResponse resp = httpClient.execute(del);
            String respStr = EntityUtils.toString(resp.getEntity());

            Log.e("d", respStr)
}
... 
```

# android - android - Http 请求从 ASHX 返回空 JSONArray

> ID：12981072
> 
> 赞同：2
> 
> 时间：2012-10-19T19:23:42.627
> 
> 标签：android, http

服务器中的 ashx 发送此响应：

```
[
    {
        "Dominio": "123",
        "CoTransporte": 1,
        "Descripcion": "Suzuki Fun Negro 5 Puertas",
        "Anio": "2005",
        "Titular": "Jorge Gonzalez",
        "CoDocumento": 96,
        "Documento": "31541344",
        "Domicilio": "Av. Santa Fe 2564",
        "Localidad": "Capital Federal",
        "Seguro": "Mapfre Aconcagua",
        "Poliza": "678542134",
        "Propio": false
    },
    {
        "Dominio": "UJE666",
        "CoTransporte": 1,
        "Descripcion": "Renault Fuego Marron 3 Puertasq",
        "Anio": "1986",
        "Titular": "Mauro Almendros",
        "CoDocumento": 96,
        "Documento": "31541344",
        "Domicilio": "Av. Santa Fe 2564",
        "Localidad": "Capital Federal",
        "Seguro": "Mapfre Aconcagua",
        "Poliza": "678542134",
        "Propio": false
    }
] 
```

这是我处理响应的android代码：

```
// Create a new HttpClient and Post Header
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(this.GetVehiculosHandlerURL());
            String json  = "";

            try {
                // Add your data
                //httppost.addHeader("Content-type", "application/x-www-form-urlencoded");

                List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);

                nameValuePairs.add(new BasicNameValuePair("dominio", dominio));
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                // Execute HTTP Post Request
                HttpResponse response = httpclient.execute(httppost);
                HttpEntity ent = response.getEntity();
                if (ent != null)
                {
                    InputStream instream  = ent.getContent();
                    String result = convertStreamToString(instream);
                    JSONArray j = new JSONArray(result);
                    System.out.println(j.length());
                    instream.close();

                } 
```

当我尝试获取数组长度时，该值为零。请有人帮我找出我的错误。提前致谢！

# java - 如何在 NetBeans 中链接项目并添加到 SVN？

> ID：12981073
> 
> 赞同：0
> 
> 时间：2012-10-19T19:23:45.023
> 
> 标签：java, svn, netbeans

我必须将 NetBeans 用于 Java Web 项目。

我有 3 个项目，1 个是主要项目，其他只是小组件。我将两个小的添加到主要的（添加罐子或其他东西......），效果很好。主项目已添加到 SVN 存储库，但我想在提交主项目时一次提交所有 3 个项目。我曾经在 Eclipse 中看到过一个解决方案，但不记得了。目前，当我提交时，只有主项目提交给 SVN。我可以单独添加另外两个，但我不想一个一个地提交所有组件。有人知道我如何将这两个项目包含到主要项目中，以便将其作为一个整体提交给 svn 存储库吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:39:25.707

您可以选择多个项目，右键单击它们并按`Team > Commit...`，提交窗口将让您提交所有选定的项目

# javascript - 需要从我的网站上删除图片/链接

> ID：12981076
> 
> 赞同：2
> 
> 时间：2012-10-19T19:24:01.070
> 
> 标签：javascript, image, hyperlink, web-hosting

我的任务是更新网站。该网站由 dexone 托管，他们很友善（讽刺）在我所有页面的底部放置一个广告，链接回他们的销售和服务页面。我无法编辑链接和图像（它使用 cm4all 作为内容管理器），并且当网站发布时，他们正在向页脚添加一些代码以显示他们的图像/链接。图片/链接代码是：

```
<a style="float:right;" href="http://www.dexone.com/solutions/websites" target="_blank"><img src="http://cm4allfooters.websiteexperts.com/dex/dex.jpg" alt="Dex  website Solutions" title="Dex Website Solutions" height="39" width="180"></a> 
```

我想知道是否使用 javascript 这可以被“删除”。CSS 可能，但我没有看到对 img 以外的任何内容的引用，如果我将 img 更改为隐藏，它会删除网站上的所有图像，而不仅仅是这个图像。任何想法或建议将不胜感激。在旁注中，我不是一个 java 人，我主要在 php 中工作，所以如果你想给我一个例子，它需要完整，否则我肯定会把它搞砸。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:29:52.837

不适用于“Java”，但这可能适用于您的 CSS：

```
a[href*='//www.dexone.com'] { display: none; } 
```

是的！强烈建议您在实施此解决方案之前遵循 Mike Cs 的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:39:25.817

这里是如何通过直接的 javascript 来做到这一点：

```
var elems = document.getElementsByTagName('a');
for (var i=0; i<elems.length; ++i) {
    if (elems[i].href == "http://www.dexone.com/solutions/websites") {
        elems[i].parentNode.removeChild(elems[i]);
    }
} 
```

并使用 jQuery：

```
$('a').each(function() {
    if (this.href == "http://www.dexone.com/solutions/websites") {
        $(this).remove();
    }
}); 
```

# c++ - 声明移动构造函数但私有时使用复制构造函数

> ID：12981079
> 
> 赞同：2
> 
> 时间：2012-10-19T19:24:08.940
> 
> 标签：c++, compiler-construction, constructor

假设一个给定的类`A`是用一个公共复制构造函数和一个私有移动构造函数定义的。如果一个函数`f`返回一个类型为的对象`A`，并`f`用于初始化一个类型为变量的局部实例`A`，那么默认情况下（因为返回的值为 a `rvalue`），编译器将尝试使用移动构造函数。我相信一旦编译器检测到移动构造函数是私有的，期望编译器使用复制构造函数是明智的，但是令我惊讶的是，我收到了一个编译器错误，指出移动构造函数是私有的。鉴于以下代码，我的问题如下：

```
 #include<iostream>

 using namespace std;

 class A
 {

    friend A f();

 public:
    A(const A&) { cout << "copy\n"; }

 private:
    A() {}
    A(A&&) { cout << "move\n"; }
 };

 A f()
 {
    A a;
    return a;
 }

 int main()
 {
    A a = f();
 } 
```

如何更改代码（不更改 A 或 f）以便可以使用复制构造函数初始化 main 中的变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:27:57.190

首先执行重载决议，以选择要调用的函数。

访问检查作为后续步骤执行，检查所选函数/构造函数是否可以调用。

这是故意完成的，因此不调用私有函数（因为它*是*私有的）。在这种情况下，让编译器选择另一个函数来调用不会有成效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:30:25.677

我会改变课程，因为它不明智。

或者从类派生或包装它。

如果你只想快速破解，你可以做

```
template< class Type >
Type& tempref( Type&& t ) { return t; } 
```

然后做

```
A a = tempref( f() ) 
```

免责声明：编译器未触及代码。

# file-io - 如何将网络摄像头中的图片保存到 C 盘上的文件中

> ID：12981082
> 
> 赞同：1
> 
> 时间：2012-10-19T19:24:16.243
> 
> 标签：file-io, asynchronous, vb6, ip-camera

我的应用程序非常简单且切中要害。当我单击一个按钮时，它将转到特定摄像机的指定 IP 地址，并从 iexplore 中的 IP 地址流式传输视频，或者根据用户选择流式或静态模式保存当前在摄像机上的任何图像。

我遇到的问题是以静止模式进入相机并将文件保存到我的 C:// 驱动器中的文件夹/文件中。

*静态模式和流模式之间的唯一区别是，当我只想要静态图像时，我将“/image”附加到 IP 地址的末尾。如果我单独打开 IP 地址，它将流式传输视频（工作正常）。

以下代码显示了我到目前为止所拥有的内容，即在流和静止模式下打开 IP 地址，如图所示。

我正在使用 ShellEx 模块。

```
 Private Sub DS_Stream_Click()   // Cam 1 video stream
 ShellEx "http://999.999.999.100", vbNormalFocus
 End Sub

 Private Sub OS_Stream_Click() // Cam 2 video stream
 ShellEx "http://999.999.999.101", vbNormalFocus
 End Sub

 Private Sub Update_Btn_Click(idx As Integer) // Cam 1 still pic
 ShellEx "http://999.999.999.100/image", vbNormalFocus
 End Sub

 Private Sub ExecLink(Url As String, style As VbAppWinStyle)
 ShellEx "iexplore.exe "
 End Sub 
```

那么我怎样才能去'Cam 1 Still pic'IP地址并将该图像保存到我的C驱动器的某个地方（就像一个文件夹，这样我就可以在需要时返回并查看所有静止图像）？

然后我计划在我的表单上的图片框中打开该图像（因此它可以适当地缩小并保持清晰度）。显示的图像将是保存到 C 盘上我的文件夹中的最新图片。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-05T06:39:34.050

也许您需要使用 api 代码从链接下载，例如 az a urldownload 或 inet 控件和其他方式，也许您需要使用 activex 控件通过 ip 或不使用 ip 从网络摄像头拍照，并且在 win7 或更高版本中您需要访问权限创建文件（以管理员身份运行）

# connection-string - app.config的连接字符串和c#连接字符串有什么区别

> ID：12981084
> 
> 赞同：0
> 
> 时间：2012-10-19T19:24:26.337
> 
> 标签：connection-string, app-config

c#和app.config文件中以下两行代码有什么区别吗？

C# 连接字符串声明。

```
string conn = "/server = test/ DB = test_dev/ env = dev" 
```

和

app.config 声明

```
<connectionStrings>
    <add name="Test" connectionString="Data Source=.;Initial Catalog=test_dev;" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

如何将 c# 连接字符串声明为 app.config 文件中的格式，以便我可以从 app.config 文件中读取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:30:51.640

硬编码连接字符串和从 app.config 文件中提取一个连接字符串并没有真正的区别。

使用 app.config 的优点是您可以在应用程序的多个位置使用相同的连接字符串，然后如果您需要更改它（出于测试目的或其他任何实际用途），您只需在一个位置更改它这很好地包含在配置文件中。

如评论中所述，要直接从您的 app.config 中读取连接字符串，您可以使用以下命令：

```
string connectionString = System.Configuration.ConfigurationManager.ConnectionStrings["Test"]; 
```

尽管有许多不同的方法可以访问连接字符串（DataSet 等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:32:59.417

要在 C# 代码中读取 connectionString 值，您可以访问`System.Configuration.ConnectionStringSettingsCollection`

```
System.Configuration.ConfigurationManager.ConnectionStrings 
```

`<connectionStrings></connectionStrings>`将返回节中定义的所有连接字符串的集合

您可以使用按名称访问连接字符串

```
string conn = 
   System.Configuration.ConfigurationManager.ConnectionStrings["Test"]; 
```

# php - 如何控制主干项目的 PHP、标头等版本的缓存？

> ID：12981088
> 
> 赞同：8
> 
> 时间：2012-10-19T19:24:34.667
> 
> 标签：php, html, caching, backbone.js, backbone-boilerplate

因此，我们每周发布我们的项目，我们遇到了客户拥有某些文件的旧版本的问题。

该堆栈是带有骨干样板的 requirejs 和带有 PHP 后端的 Apache2 服务器的骨干。

我们有加载的 index html 文件、使用 AJAX 加载的模板 HTML 文件，然后是所有的 js 文件。

这个问题似乎与[https://stackoverflow.com/questions/12103341/backbone-boilerplate-disable-caching](https://stackoverflow.com/questions/12103341/backbone-boilerplate-disable-caching)有关，但我在那里没有看到一个好的答案。

我听说缓存控制标头和 mod expires 以及 PHP 的 mod 标头可能会有所帮助，但我不知道如何将它们放在一起。

本质上，我们要做的是确保在向产品服务器发布新代码时，所有内容都至少没有缓存一次。然后在那之后，提高加载速度的正常缓存将是理想的。

至少，我想了解如何完全防止这些东西被缓存。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:48:54.993

就缓存而言，我发现很难控制用户客户端的浏览器。我过去使用的一个技巧是在我的 JS 文件 URL 中附加一个随机数。像

```
<script src="https://www.mydomain.com/myjsfile.js?123456789"></script> 
```

或者

```
<script src="https://www.mydomain.com/myjsfile.js?releaseID=123456789"></script> 
```

这会导致客户端将其完全视为一个新文件。您可以为每个版本分配一个随机数，这应该会导致用户的浏览器再次提取新的 JS 文件。同样适用于 CSS。

我希望这有帮助。祝你好运。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T12:54:36.507

客户端的文件缓存由两个值定义：`<head>`被调用的 html 文件的 - 部分中的元信息和 HTTP-Header。

在 HTML 文件中，您可以给出两个[元标记](http://www.i18nguy.com/markup/metatags.html#cache-control) `cache-control`，并`expires`通过给出一个简单的 php 命令来定义每周到期日期：

```
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="PRIVATE">
<?php
    $daysDelta = 7-date("w");
    $expiration = date(DATE_RFC1123, mktime(0, 0, 0, date("m"), 
        date("d")+$daysDelta+1, date("Y")));
?>
<META HTTP-EQUIV="EXPIRES" CONTENT="<?= $expiration ?>"> 
```

这将在星期一早上杀死缓存。另一种方法是通过[HTTP-Header](http://php.net/manual/en/function.header.php)进行缓存设置：

```
<?php
    header("Cache-Control: private");
    header("Expires: <?= $expiration ?>");
?> 
```

使用这两种方法，您将在一周内进行缓存，但在周末之后，客户端将使其缓存无效并重新提取数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-26T06:01:58.210

要从页面中删除缓存，您需要在页面顶部包含以下内容：-

```
$this->output->set_header("Expires: Tue, 01 Jan 2000 00:00:00 GMT"); 
$this->output->set_header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT"); 
$this->output->set_header("Cache-Control: no-store, no-cache, must-revalidate, max-age=0"); 
$this->output->set_header("Cache-Control: post-check=0, pre-check=0", false); 
$this->output->set_header("Pragma: no-cache"); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-26T14:54:45.660

使用**requirejs**，有一个名为[urlargs](http://requirejs.org/docs/api.html#config-urlArgs)的参数，它为您的所有 requirejs 请求添加一个参数，并可用于强制缓存更新。页面上的示例使用时间戳，但您可能正在寻找构建版本。

但是，您应该使用 r.js 来构建脚本的生产版本（它编译并缩小所有使用 require 加载的文件并生成单个库）。这将减少加载时间并为您省去很多烦恼。你会让他们只链接这个库，并在文件名本身中包含构建版本（类似于骨干网.app.1.0.23456.js）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T11:45:31.993

将随机数附加到 uri 会破坏客户端缓存。
相反，追加文件的最后修改时间。

`<script src="myjsfile.<?=filemtime('myjsfile.js')?>.js"></script>`

处理需要和 .htaccess 规则，例如

`RewriteRule ([^/]*)\.[0-9]*\.css$ $1.css [L,NC]`

此外，为 .htaccess 提供长期缓存指令

```
<IfModule mod_expires.c>
  ExpiresActive on
  ExpiresByType text/css                  "access plus 1 year"
  ExpiresByType application/javascript    "access plus 1 year"
</IfModule> 
```

# iphone - 在 iOS OpenGL 应用程序中，使用 ivar 代替属性会显着提高性能吗？

> ID：12981095
> 
> 赞同：0
> 
> 时间：2012-10-19T19:25:18.310
> 
> 标签：iphone, ios, opengl-es, properties, ivar

我正在开发一个 iPhone OpenGL 应用程序。我的问题是：使用 ivar 代替属性会显着提高性能吗？

我知道有很多关于 ivar 与属性的讨论；但我的问题是针对 OpenGL ES 的。使用属性 getter 会占用一些 CPU 时间，这通常可以忽略。在 OpenGL ES 中怎么样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:28:11.750

> 我正在开发一个 iPhone OpenGL 应用程序。我的问题是：使用 ivar 代替属性会显着提高性能吗？

国际海事组织，一点也不。在 OpenGL ES 中访问变量与使用其他框架时一样：可以忽略不计。此外，在 OpenGL 中，性能限制来自管道的管理和读取一些状态变量，例如，因此您可以安全地使用属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:40:46.770

像 sergio 一样，我认为属性不会有足够的开销来影响性能。

我的一点建议是不要试图预测性能瓶颈。编写最好的系统，然后在完成足够的项目后花时间进行系统测试以进行性能优化。使用性能测试工具找出实际瓶颈在哪里。

[过早的优化是万恶之](http://en.wikipedia.org/wiki/Program_optimization#When_to_optimize)源 – Knuth

# drupal - Drupal 的 Akamai 模块中的 SSL 超时

> ID：12981101
> 
> 赞同：0
> 
> 时间：2012-10-19T19:25:47.490
> 
> 标签：drupal, soap, akamai

我有一个客户使用 Drupal Akamai 模块来管理他们网站的缓存。当删除某个内容类型时，客户端报告偶尔会发生以下一组错误，但是，我怀疑它不限于特定的内容类型。

`warning: SoapClient::__doRequest: SSL: connection timeout in /path/to/akamai/akamai.class.inc on line 85`

`warning: SoapClient::__doRequest: SSL: Failed to enable crypto in /path/to/akamai/akamai.class.inc on line 85`

`warning: SoapClient::__doRequest: SSL: connect() failed: Unspecified error in /path/to/akamai/akamai.class.inc on line 85`

引用的行是对 SoapClient 的 wsdl 中定义的方法的调用

`$response = $ccuapi->purgeRequest($name, $pwd, $network, $opt, $uris);`

我已经到处搜索了为什么会发生这种情况。虽然我已经学到了很多东西来寻找这个，但我不是肥皂专家。非常感谢任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T12:48:34.960

可能的问题可能是您正在使用的代理连接。您的系统无法建立与 akamai 服务器的连接以调用 akamai 服务调用。我也遇到了同样的问题，但是在添加代理后它得到了解决。尝试使用 java 添加这些属性。

```
 System.setProperty("https.proxyHost", "your proxt ip ");
 System.setProperty("https.proxyPort", "proxy port number"); 
```

或者下载名为“gte_global_root.der”的证书并添加到您的安全密钥库

# visual-studio-2010 - 如何在 Windows7 中设置特定程序管理员访问非管理员用户

> ID：12981102
> 
> 赞同：0
> 
> 时间：2012-10-19T19:25:58.657
> 
> 标签：visual-studio-2010, security, windows-7, uac

我的公司有开发人员团队，我`UAC`在所有机器上都安装了 windows7，现在 Dotnetnuke 编译模板需要管理员访问权限才能创建，因为它们与 IIS 链接，所以每次他们想要处理 DNN 模块时，他们都会调用我输入凭据，如果他们错误地关闭了 VS，他们又是我的凭据，有没有办法在标准用户帐户上仅使用管理员运行特定应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T09:37:03.947

不，这是不可能的。
如果您的用户不在管理员组中，那就更复杂了。在这种情况下，管理员访问令牌不会从他们的安全令牌中剥离，他们一开始就没有它。

要启动提升的进程，如果用户不是管理员组的成员，则必须提供管理员权限。如果是，则会显示一个简单的确认。

# asp.net - Visual Web Developer 使用密码访问数据库

> ID：12981111
> 
> 赞同：1
> 
> 时间：2012-10-19T19:26:22.577
> 
> 标签：asp.net, ms-access, vwdexpress

我正在使用 Visual Web Developer Express 2010。它在带有 ASP.NET 4 的 Server 2003 上运行。

当我添加我的 GridView 并选择我的数据源（这是一个受密码保护的 MDB 文件）时，它连接得很好。它确实在整个过程中两次要求我输入密码。我输入它并执行测试查询选项，一切似乎都很好。

但是，一旦我在浏览器中测试该页面，我就会收到一个粗鲁的错误页面，说明：`[OleDbException (0x80040e4d): Not a valid password.]`

我猜我在设置数据源时输入的密码没有被保存。如何输入密码以便表单保留？Web.config 或代码？我已经用 VWD Express 仔细寻找这个。

# java - 在Java中，是否可以使用某种while循环（或任何东西）来确定输入提示的数量？

> ID：12981115
> 
> 赞同：2
> 
> 时间：2012-10-19T19:26:36.680
> 
> 标签：java, loops, input, while-loop

```
public static void main (String [] args)
{
    // declare variables, capture input

    String input, name = JOptionPane.showInputDialog("Please " +
                          "enter your first and last name.");
    double testScore1, testScore2, testScore3, average;

    // capture input, cast, and validate input

    input = JOptionPane.showInputDialog("What is the score " +
                                        "of your first test?");
    testScore1 = Double.parseDouble(input);

    while (testScore1 < 1 || testScore1 > 100)
    {
        input = JOptionPane.showInputDialog("This test score is not " +
                "between 1 and 100\. \nPlease enter a test score in " +
                "this range:");

        testScore1 = Double.parseDouble(input); 
    }

    input = JOptionPane.showInputDialog("What is the score " +
                                        "of your second test?");
    testScore2 = Double.parseDouble(input);

    while (testScore2 < 1 || testScore2 > 100)
    {
        input = JOptionPane.showInputDialog("This test score is not " +
                "between 1 and 100\. \nPlease enter a test score in " +
                "this range:");

        testScore2 = Double.parseDouble(input); 
    }

    input = JOptionPane.showInputDialog("What is the score " +
                                        "of your third test?");
    testScore3 = Double.parseDouble(input);

    while (testScore3 < 1 || testScore3 > 100)
    {
        input = JOptionPane.showInputDialog("This test score is not " +
                "between 1 and 100\. \nPlease enter a test score in " +
                "this range:");

        testScore3 = Double.parseDouble(input);
    }

    // calculate average and display output

    average = (testScore1 + testScore2 + testScore3)/3; 

    JOptionPane.showMessageDialog(null, name + ", your average score is: " + average);

} 
```

首先，我是一个初学者程序员。我的术语和行话相当缺乏，所以请耐心等待。

我正在编写一个程序来捕获 3 个测试分数，然后使用 while 循环验证它们（必须在 1-100 范围内）。然后平均测试分数，输出显示平均值。很简单的东西。

如果可能的话，我想找到一种方法来捕获测试分数的数量，然后从那里捕获每个实际分数。例如，程序询问“平均计算了多少个测试？”，然后取该数字并使其与程序提示“请输入测试分数（1）：”或类似内容的次数相同. 因此，为了更清楚起见，如果用户输入 4 作为测试次数，那么输入分数的提示将显示 4 次。

我觉得上面的代码是多余的，因为每个分数都使用了一个 while 循环，并且因为该程序仅适用于 3 个分数而受到限制。非常感谢任何帮助，并随时批评代码中的任何其他内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:29:54.027

是的你可以。

你需要的是一个*嵌套循环*。在伪代码中：

```
while(condition)
{
   int numberOfInput = getInput() ; //get the input from the user

   for(int i =0 ; i < numberOfInput; i++) //iterate for the amount of prompts required
     prompt() ; //get input

}

function prompt
      while (testScore1 < 1 || testScore1 > 100)
      {
        input = JOptionPane.showInputDialog("This test score is not " +
                "between 1 and 100\. \nPlease enter a test score in " +
                "this range:");

        testScore1 = Double.parseDouble(input); 
      } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:51:17.120

简短的回答：**是的，**这是可能的。
**选项 1：**最初询问用户他们计划输入多少分数，并将其存储在 int 变量中。
例如：

```
  Ask user how many scores to enter.
       Check the response, and store it in an int variable.
       Create a double variable to add the scores (initialize it to 0.0)

       Use a for loop, asking for the score;
       Evaluate the score to ensure it's a valid number
         If it's not a valid number, prompt the user again (this is still within 
          the same iteration, not a different iteration)
         If it's a valid number, add it to the total scores variable
       Once loop is exhausted, just divide the two variables (since the total 
         scores is a double, your answer will automatically be a double)
       Display the answer. 

```

**选项 2：**使用哨兵循环（用户必须输入一个字母——通常是“Q”或“N”——或其他东西才能退出循环）

```
  Create an int variable to store total loops (initialize to 0).
       Create a double variable to add the scores (initialize it to 0.0)

       Use a for loop, asking for the score;
       Check if the value is the quit character
        If it is not
          Evaluate the score to ensure it's a valid number
            If it's not a valid number, prompt the user again (this is still within 
            the same iteration, not a different iteration)
          If it's a valid number, add it to the total scores variable and increment 
          the total loops variable by 1.
        If it is
         just divide the two variables (since the total 
         scores is a double, your answer will automatically be a double)
       Display the answer. 

```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:14:18.167

在[http://korada-sanath.blogspot.in/p/discussion-on-tech-topics.html](http://korada-sanath.blogspot.in/p/discussion-on-tech-topics.html)中，有一个伪代码说明了基本 Java 编程技能的类似问题。在循环部分中，您可以简单地添加检查用户输入的分数是否在 1-100 范围内。如果没有，您可以将循环变量减少“1”，以便用户可以再次输入他的分数......

如需进一步说明，请在上述链接中的代码循环部分添加以下代码。

而不是直接将用户输入的值分配给您的 testScores 数组，您可以使用一个临时变量，然后可以分配用户输入的分数是否在范围内。

```
Double temp = Double.parseDouble(br.readLine());
if(temp > 1 && temp < 100) {

    testScores[loopVar] = temp;

} else {

    loopVar--;
} 
```

# ruby-on-rails - 设计：从用户模型中获取和设置语言环境

> ID：12981119
> 
> 赞同：2
> 
> 时间：2012-10-19T19:26:49.303
> 
> 标签：ruby-on-rails, devise, rails-admin

我为 User 表中的每个用户设置了语言环境。我按照这些[说明](https://stackoverflow.com/questions/4292165/setting-locale-on-a-per-user-basis-when-using-devise-and-rails-3)在用户登录后获取语言环境。它一直工作到用户重新加载浏览器，然后标准语言环境（en）再次变为活动状态。如何在会话中保留 user.locale 的值？我正在使用 Rails_Admin，这意味着虽然我有一个用户模型，但我没有用户模型的控制器。

```
 # ApplicationController
 def after_sign_in_path_for(resource_or_scope)
  if resource_or_scope.is_a?(User) && resource_or_scope.locale !=  I18n.locale
    I18n.locale = resource_or_scope.locale
  end
  super
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T20:07:42.917

虽然将它放在会话中是一个有效的答案，但您可以使用该`current_user`方法获取用户的语言环境（并使您的会话保持清洁）

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  before_filter :set_locale # get locale directly from the user model

  def set_locale
    I18n.locale = user_signed_in? ? current_user.locale.to_sym : I18n.default_locale
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T20:01:56.437

每次用户调用操作时，管理将其保存在会话中并从会话中检索它（ApplicationController 中的 before_filter）：

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  before_filter :set_locale # get locale from session when user reloads the page

  # get locale of user
  def after_sign_in_path_for(resource_or_scope)
    if resource_or_scope.is_a?(User) && resource_or_scope.locale.to_sym !=  I18n.locale
      I18n.locale = resource_or_scope.locale.to_sym # no strings accepted
      session[:locale] = I18n.locale      
    end        
    super
  end

  def set_locale
    I18n.locale = session[:locale]
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-17T19:24:12.890

我在我的用户模型中添加了一个名为 user_locale 的字符串列，然后向应用程序控制器添加了代码。允许将 storage、default 和 locale 用作参数。

移民：

```
class AddLocaleToUser < ActiveRecord::Migration
 def change
   add_column :users, :user_locale, :string
 end
end 
```

application_controller.rb：

```
before_action :set_locale

private 

def set_locale
 valid_locales=['en','es']

 if !params[:locale].nil? && valid_locales.include?(params[:locale]) 
   I18n.locale=params[:locale]
   current_user.update_attribute(:user_locale,I18n.locale) if user_signed_in?
 elsif user_signed_in? && valid_locales.include?(current_user.user_locale)
   I18n.locale=current_user.user_locale
 else
  I18n.locale=I18n.default_locale
 end
end 
```

# c# - 请帮忙修改这个正则表达式

> ID：12981120
> 
> 赞同：1
> 
> 时间：2012-10-19T19:27:00.563
> 
> 标签：c#, .net, regex

> **可能重复：**
> [正则表达式匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

我正在尝试搜索以下 HTML 字符串以获取这些产品的成本：

```
<div id=menu>
  <p>A hamburger without cheese costs $5.</p>
  <p>A cheeseburger with one patty costs $6.</p>
</div> 
```

我能够使用以下表达式成功获取每件商品的价格：

```
string hamburger = "<p>A hamburger[^\\$]+\\$(?<price>.*?).</p>";
string cheeseburger = "<p>A cheeseburger[^\\$]+\\$(?<price>.*?).</p>"

    public string GetProductPrice(string expression)
    {
        expression = Regex.Unescape(expression);
        Regex regex = new Regex(expression);
        MatchCollection mc = regex.Matches(MENU_DIV_STRING);

        if (mc.Count > 0 && mc[0].Groups.Count == 2)
            return mc[0].Groups[1].ToString();
        else
            return "--";
    } 
```

但是，当给出这个时，我被抛出了一个循环：

```
<div id=menu>
  <p>A hamburger without cheese costs $5.</p>
  <p>A cheeseburger with one patty costs $6.</p>
  <p>A cheeseburger (SPECIAL: add an additional patty for $1 each) costs $6.</p>
</div> 
```

“以 1 美元添加第二个肉饼”中出现的第二个美元符号让我陷入了一个循环。我已经研究并尝试了很多事情，比如使用模式，在这一点上我完全搞糊涂了。

是否有一个正则表达式可以找出一个芝士汉堡的成本是否有特殊的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:28:57.643

**不不不..**

正则表达式不是解析 HTML 文件的好选择。

HTML 并不严格，其格式也不规则。

使用[htmlagilitypack](http://html-agility-pack.net/?z=codeplex)

正则表达式用于**正**则表达式而不是**不规则**表达式

您可以使用此代码像这样检索它

```
HtmlDocument doc = new HtmlDocument();
doc.Load(yourStream);

var itemList = doc.DocumentNode.SelectSingleNode("//div[@id='menu']")
                  .Elements("p")
                  .Select(p => p.InnerText)
                  .ToList();

foreach(var item in itemList)
{
Match m= Regex.Match(item,@"(?<name>[Aa]?\s*.*?)\s.*?(?<price>\$\d+).*");
    if(m.Success==true)
     {
            m.Groups["name"].Value;
            m.Groups["price"].Value;
     }
} 
```

正则表达式将是

`(?<name>[Aa]?\s*.*?)\s.*?(?<price>\$\d+).*`

Group1 捕获名称

Group2 捕获价格

# c - libssh2 会话清理没有阻塞？

> ID：12981125
> 
> 赞同：0
> 
> 时间：2012-10-19T19:27:15.523
> 
> 标签：c, libssh

我的应用程序使用 libssh2 通过 SSH 进行通信，并且通常工作正常。我遇到的一个问题是远程主机意外死机——在这种情况下，远程主机是一个嵌入式设备，随时可能断电，所以这种情况并不少见。

发生这种情况时，我的应用程序检测到远程计算机已停止响应 ping，并像这样断开 SSH 连接的本地端：

```
void SSHSession :: CleanupSession()
{
   if (_uploadFileChannel)
   {
      libssh2_channel_free(_uploadFileChannel);
      _uploadFileChannel = NULL;
   }

   if (_sendCommandsChannel)
   {
      libssh2_channel_free(_sendCommandsChannel);
      _sendCommandsChannel = NULL;
   }

   if (_session)
   {
      libssh2_session_disconnect(_session, "bye bye");
      libssh2_session_free(_session);
      _session = NULL;
   }
} 
```

非常简单，但问题是 libssh2_channel_free() 调用可能会阻塞很长时间，以等待远程端响应“我现在要走了”消息，因为它已关闭电源，所以它永远不会这样做......但与此同时，我的应用程序被冻结（在清理例程中被阻止），这不好。

有什么办法（除了破解 libssh2）可以避免这种情况吗？我只想拆除本地 SSH 数据结构，并且在拆除过程中从不阻塞。（我想我可以简单地泄漏 SSH 会话内存，或者将其委托给不同的线程，但这些看起来像丑陋的黑客而不是正确的解决方案）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T04:27:15.653

Set to non-blocking mode and take the control of reading data from the socket to your hand by setting callback function to read data from the soket using libssh2_session_callback_set with LIBSSH2_CALLBACK_RECV for cbtype

[void *libssh2_session_callback_set(LIBSSH2_SESSION *session, int cbtype, void *callback);](http://www.libssh2.org/libssh2_session_callback_set.html)

If you can't read data from the socket due to error ENOTCONN that means remote end has closed the socket or connection failed, then return -ENOTCONN in your callback function

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:35:18.463

我没有使用 libssh2 的经验，但也许我们可以通过使用`libssh2_session_disconnect_ex`和不同的断开原因从 libssh2 中获得不同的行为：`SSH_DISCONNECT_CONNECTION_LOST`.

`libssh2_session_disconnect`相当于使用`libssh2_session_disconnect_ex`with the reason `SSH_DISCONNECT_BY_APPLICATION`。如果 libssh2 知道连接丢失，也许它不会尝试与对方交谈。

[http://libssh2.sourceforge.net/doc/#libssh2sessiondisconnectex](http://libssh2.sourceforge.net/doc/#libssh2sessiondisconnectex)

[http://libssh2.sourceforge.net/doc/#sshdisconnectcodes](http://libssh2.sourceforge.net/doc/#sshdisconnectcodes)

# objective-c - 沿二次曲线为视图的中心点设置动画

> ID：12981127
> 
> 赞同：2
> 
> 时间：2012-10-19T19:27:21.487
> 
> 标签：objective-c, ios, cocoa-touch, animation, uiview

我有一个将用户事件存储在历史记录中的应用程序。事件被添加到一个控制器上，并显示在不同选项卡内的控制器中。

我想添加一个视觉确认，当用户点击“保存按钮”时，事件已被记录。我正在考虑对界面元素进行动画处理，以向负责向用户显示记录的选项卡栏控制器移动。

![动画曲线](../Images/da9fcd76a8835bad6a71b88f175c4add.png)

为此，我正在考虑为我的一个界面元素的中心点设置动画。我知道如何为中心点设置动画，但它是以直线方式进行的。**如何以更“弯曲”的方式为中心点设置动画？**有没有办法做到这一点？

```
CGPoint center = self.ratingReticle.center;

[UIView animateWithDuration:0.6 delay:0 options:UIViewAnimationCurveEaseIn animations:^{
    //move the element offscreen
     self.ratingReticle.center = CGPointMake(260,500);

} completion:^(BOOL finished) {
    //hide the interace element once it is offscreen
    self.ratingReticle.alpha = 0;
    //restore the position of the interface element
    self.ratingReticle.center = center;

    [ UIView animateWithDuration:0.4 animations:^{
        //fade the element back at the original position
        self.ratingReticle.alpha = 1;
    } completion:^(BOOL finished) {

    }];

}]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:35:14.260

您可以使用 Core Animation 沿贝塞尔曲线移动对象，使用`CAKeyFrameAnimation`.

```
-(void)animate
{
  CAKeyframeAnimation *posAnim = [CAKeyframeAnimation animationWithKeyPath:@"position"];
  posAnim.path = [self bezierPath];
  [image.layer addAnimation:posAnim forKey:@"posAnim"];
} 
```

where`bezierPath`返回`CGPathRef`适合您情况的 a 。

# css - CSS 设计和图像

> ID：12981132
> 
> 赞同：0
> 
> 时间：2012-10-19T19:27:35.377
> 
> 标签：css, image, background

我在下面有这个链接：

[http://www.noupe.com/](http://www.noupe.com/)

如果你看左上角的花朵，这种风格会被大量使用。这是使用类似的东西完成的

```
<div> upper flower part image </div>
<div> lower flower part image</div> 
```

还是使用 z-index？

特别是在代码读取的位置`<div id="header" > </div>`这显示了花的底部，上面的某个地方显示了花的上部

图像是否被切片以产生这种效果？

有什么简单的例子可以突出这种效果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:30:50.217

看源头。他们使用非语义类，例如`decor-1`绝对位于站点其余部分的背景图像。

```
#main .decor-1 {
background: url(image) no-repeat;
width: 584px;
height: 211px;
position: absolute;
left: -97px;
top: -123px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:32:51.273

是的，图像被分割成多个部分，然后设置为容器上的背景图像......

你可以在这里看到其中一个切片...

[http://www.noupe.com/wp-content/themes/noupe/images/decor-1.png](http://www.noupe.com/wp-content/themes/noupe/images/decor-1.png)

这是用于实现这一目标的 CSS...

```
#main .decor-1 {
background: url(http://www.noupe.com/wp-content/themes/noupe/images/decor-1.png) no-repeat;
width: 584px;
height: 211px;
position: absolute;
left: -97px;
top: -123px;
} 
```

# python - gi.repository 窗口

> ID：12981137
> 
> 赞同：17
> 
> 时间：2012-10-19T19:27:58.927
> 
> 标签：python, windows, gtk, pygobject

我正在开发一个必须在 windows 和 linux 上 100% 兼容的应用程序。在linux上我没有问题，但在windows上我想出了这个消息：from gi.repository import Gtk ImportError: No module named gi

我安装了 pygobject、pygtkallinone、gtk .. 我错过了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-01-06T11:15:45.900

Havok 的大部分答案都是正确的，除了文档最近有了很大的改进，有一个教程：

*   [http://python-gtk-3-tutorial.readthedocs.org/en/latest/](http://python-gtk-3-tutorial.readthedocs.org/en/latest/)

包括用于离线阅读的 PDF 版本：

*   [http://media.readthedocs.org/pdf/python-gtk-3-tutorial/latest/python-gtk-3-tutorial.pdf](http://media.readthedocs.org/pdf/python-gtk-3-tutorial/latest/python-gtk-3-tutorial.pdf)

以及完整的 API 参考手册，不仅包括 Gtk，还包括许多其他可用于自省的库：

*   [http://lazka.github.io/pgi-docs/](http://lazka.github.io/pgi-docs/)

在 windows 上支持很好，在创建所有 windows 可执行文件和库方面付出了很多努力，pygi-aio 的最新版本是 3.10.6：

*   [http://sourceforge.net/projects/pygobjectwin32/files/?source=navbar](http://sourceforge.net/projects/pygobjectwin32/files/?source=navbar)

我还在 Gnome wiki 上发布了关于如何使用 pygobject 自省在 win32 上构建的说明，这并不难，我还上传了一个实际有效的 setup.py：

*   [https://wiki.gnome.org/action/show/Projects/PyGObject?action=show&redirect=PyGObject#Building_on_Win32_with_cx_freeze](https://wiki.gnome.org/action/show/Projects/PyGObject?action=show&redirect=PyGObject#Building_on_Win32_with_cx_freeze)

所以答案是，不要使用 PyGTK

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-20T08:13:36.717

`gi.repository`模块被称为**PyGObject**并且适用于 Gtk+3 并且还不能用于 Windows（有实验，但还没有准备好 AFAIK）。[https://live.gnome.org/PyGObject](https://live.gnome.org/PyGObject)

`gtk`模块称为**PyGtk**，用于 Gtk+2，在 Windows 平台（特别是 2.24）上非常成熟。[http://www.pygtk.org/](http://www.pygtk.org/)

有什么不同？

*   PyGObject 有一些稀少的 Windows 支持。PyGtk 对这个操作系统有很好的支持。
*   PyGObject 是所谓的动态绑定，而 PyGtk 是静态绑定。
*   PyGObject 是新的和未来的，PyGtk 是过去的，成熟的，总有一天会被弃用的。
*   PyGObject 文档和示例非常有限，PyGtk 一个非常非常完整：http: [//developer.gnome.org/pygtk/stable/](http://developer.gnome.org/pygtk/stable/)
*   它们不兼容，你不能同时使用它们，你需要选择一个。
*   PyGObject 正在积极开发中，不会为 PyGtk 引入新功能。
*   如果您使用 Glade，最新版本将用于 PyGObject（例如 3.12.1）。如果你想使用 Glade for PyGtk 安装 3.8.0 版本。

如果您选择使用 PyGtk，则可以很好地支持冻结应用程序。您可以在此处查看我的应用程序的文档和支持文件：http: [//sourceforge.net/p/nestededitor/code/247/tree/trunk/dist/windows/](http://sourceforge.net/p/nestededitor/code/247/tree/trunk/dist/windows/)

希望能帮助到你。

**编辑：**

两年来，很多事情都发生了变化。请参阅 giamt 答案。

# eclipse - Eclipse 的插件日志文件在哪里？

> ID：12981138
> 
> 赞同：4
> 
> 时间：2012-10-19T19:28:02.373
> 
> 标签：eclipse, eclipse-plugin

我有一个失败的 Eclipse 插件。我基于另一个插件开发/增强了它。当我将此插件部署为更新站点并将其安装到另一个 Eclipse 实例中时，它最初可以工作（显示视图）。但是当我尝试交互和使用视图时，它的功能被破坏了（当我单击给定按钮时它没有做任何事情）。我在屏幕上看不到任何错误，并且 Eclipse 错误日志视图中没有显示任何内容。

我想知道默认情况下在哪里/是否有任何错误日志文件？如果它有任何自定义记录器，这些记录器会发送到哪里？我正在使用 Eclipse 3.7（靛蓝）。

如果我想找出这个异常的原因，我必须实现我自己的自定义日志文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T17:08:08.737

好吧，错误日志文件将在您的“eclipse 工作区”\.metadata\.log 中，但这只是 Eclipse 错误日志视图中显示的文件。

如果您使用的插件有某种额外的日志记录（我对此表示怀疑），那么它的逻辑位置将是“eclipse workspace”\.metadata\.plugins\{plugin.name}”，尽管这取决于应用程序..

如果您的应用程序在调试时工作，但在部署时不工作，则可能是某种部署问题。Eclipse 对获取新版本的 jar 可能非常挑剔。确保在安装之前更新清单版本或删除工作空间。可能发生的另一件事是您缺少所需的插件或插件片段，或者指定的最低版本不正确。

您不必*实现*日志记录。您可以使用 eclipse 将调试器附加到已部署的应用程序，然后像往常一样调试应用程序。虽然，如果您打算出售您的应用程序，日志记录总是一个好主意 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-27T08:14:51.430

转到 eclipse 安装目录，在 .metadata 文件夹内会有一个没有名称的日志文件。那将是插件日志

# c - 代码块编译错误

> ID：12981140
> 
> 赞同：1
> 
> 时间：2012-10-19T19:28:07.443
> 
> 标签：c, error-handling, codeblocks

每当我第二次尝试构建和运行程序时，屏幕上都会出现此错误：

> 无法打开输出文件 C:\Users\Username\Documents\filename.exe 权限被拒绝

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:12:57.703

您要么 1\. 没有权限写入目录（不太可能），要么 2\. 您的可执行文件仍在内存中。点击 CTRL+ALT+DEL 选择`Windows Task Manager`并查找+结束您的可执行文件“filename.exe”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:18:44.947

这意味着`The directory your code is in doesn't have write permission`。但是尝试将您的代码移动到一些允许写入的目录中。顺便说一句，在我的 Windows 中，有时会出现此问题。然后，当我重新启动代码块时，它就会消失 - 我并不是说这是一个解决方案。

# ajax - 使用非原始 Java 对象时，来自 Struts Ajax 调用的 OutOfMemory 异常

> ID：12981142
> 
> 赞同：1
> 
> 时间：2012-10-19T19:28:13.607
> 
> 标签：ajax, jquery, struts2, enums

我对 Struts 2.2.3.1 操作进行了一个相对简单的 Ajax 调用，该操作返回一个简单的 Java POJO。一旦我们向那个 POJO 添加一个简单的 Enum 并执行操作，我们就会在服务器的日志中收到一堆这样的消息：

```
[10/19/12 14:55:07:124 EDT] 00000047 BeanAdapter   I com.opensymphony.xwork2.util.logging.commons.CommonsLogger info Class com.ibm.ws.ejbcontainer.jitdeploy.JIT_StubPluginImpl has no readable properties,  trying to adapt JIT_StubClassPlugin with StringAdapter...
[10/19/12 14:55:07:124 EDT] 00000047 BeanAdapter   I com.opensymphony.xwork2.util.logging.commons.CommonsLogger info Class com.ibm.ws.ejbcontainer.jitdeploy.JIT_StubPluginImpl has no readable properties,  trying to adapt JIT_StubClassPlugin with StringAdapter...
[10/19/12 14:55:07:139 EDT] 00000047 BeanAdapter   I com.opensymphony.xwork2.util.logging.commons.CommonsLogger info Class com.ibm.ws.ejbcontainer.jitdeploy.JIT_StubPluginImpl has no readable properties,  trying to adapt JIT_StubClassPlugin with StringAdapter...
[10/19/12 14:55:07:139 EDT] 00000047 BeanAdapter   I com.opensymphony.xwork2.util.logging.commons.CommonsLogger info Class com.ibm.ws.ejbcontainer.jitdeploy.JIT_StubPluginImpl has no readable properties,  trying to adapt JIT_StubClassPlugin with StringAdapter... 
```

然后终于看到 OutOfMemory Exception。

用于 Ajax 调用的 Out Struts XML 类似于：

```
 <action name="ajaxRetrieveThing" class="x.y.z.action.Thing" method="ajaxRetrieveThing">
        <result type="xslt">
            <param name="exposedValue">actionResponse</param>
        </result>
    </action> 
```

我们的 ActionResponse 类的相关部分是：

```
public class ActionResponse {
    // a bunch of primitive types and associated getters and setters skipped

    private List<Object> results = new ArrayList<Object>();
    public List<?> getResults() {
        return results;
    }

    public void addResult(Object o) {
        results.add(o);
    }
    public void setResultList(List results) {
        this.results = results;
    }
} 
```

在我们的操作中，我们在结果列表中添加了一个事物。Thing 是一个 POJO，其中包含原始字段和我们的 ThingEnum。

我们的枚举看起来像这样：

```
public enum ThingEnum {
    VALUE_1( "1" ), VALUE_2( "2" ); // etc

    String description;
    private ThingEnum( String description ) {
        this.description = description;
    }

    public String getDescription() {
        return description;
    }   
} 
```

该操作将起作用，并且在我们添加 ThingEnum 之前，我们可以将数据获取到我们的 JavaScript。我认为这是因为 Struts 在尝试将 ThingEnum 转换为 XML 时遇到了问题。我们在使用其他类型的对象（例如 Hibernate 实体）时也遇到过类似的问题，我们只需将字符串和我们需要的其他原语存储在结果对象中就可以解决这些问题。

解决此问题的正确方法是什么？我想避免在传递回 JS 之前手动将 Enum 转换为字符串，这是我们当前的解决方案 - 我们基本上在 Result 对象中有一个 thingDescription 字符串，而不是 ThingEnum 字段。

# c++ - C++ Const_Cast 是否引入新变量？

> ID：12981147
> 
> 赞同：1
> 
> 时间：2012-10-19T19:28:46.690
> 
> 标签：c++, const-cast

```
#include <iostream>

using namespace std;

int main() {
        const int a = 2;
        const int *p = &a;
        int *p2 = const_cast<int*>(p);
        *p2=5;
        char *p3 = (char *)&a;
        cout << "p2 is" << *p2 << endl;
        cout << "p2 address " << p2 << endl;
        cout << "a is " << a << endl;
        cout << "a address " << &a << endl;

        return 0;
} 
```

大家好！

根据输出，*p2 和 a 的值不同，*p2 为 5，a 为 2。

但是，p2 和 &a 是相同的。我很困惑...

你能帮我理解这是在哪里吗？

非常感谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:30:56.923

未定义的行为意味着任何事情都可能发生。包括这个。

### 5.2.11 常量转换 [expr.const.cast]

> 7) [注意：根据对象的类型，通过指针、左值或指向数据成员的指针的写操作由`const_cast`丢弃 const 限定符^(73)可能产生未定义的行为 (7.1.6.1)。——尾注]

根本原因可能是编译器在查看`a`is`const`后优化`cout << "a is " << a << endl;`为简单的`cout << "a is " << 2 << endl;`.

例如，**即使在 debug build**中，我也得到：

```
 cout << "a is " << a << endl;
00CE1581  mov         esi,esp  
00CE1583  mov         eax,dword ptr [__imp_std::endl (0CFD30Ch)]  
00CE1588  push        eax  
00CE1589  mov         edi,esp  
//...
00CE158B  push        2 
//...
00CE158D  push        offset string "a is " (0CE7840h)  
00CE1592  mov         ecx,dword ptr [__imp_std::cout (0CFD308h)]  
00CE1598  push        ecx  
00CE1599  call        std::operator<<<std::char_traits<char> > (0CE1159h)  
00CE159E  add         esp,8  
00CE15A1  mov         ecx,eax  
00CE15A3  call        dword ptr [__imp_std::basic_ostream<char,std::char_traits<char> >::operator<< (0CFD304h)]  
00CE15A9  cmp         edi,esp  
00CE15AB  call        @ILT+415(__RTC_CheckEsp) (0CE11A4h)  
00CE15B0  mov         ecx,eax  
00CE15B2  call        dword ptr [__imp_std::basic_ostream<char,std::char_traits<char> >::operator<< (0CFD300h)]  
00CE15B8  cmp         esi,esp  
00CE15BA  call        @ILT+415(__RTC_CheckEsp) (0CE11A4h) 
```

我强调了重要的部分 -`2`直接推送到 的参数堆栈上`operator<<`，而不是`a`被读取的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:37:26.557

这是你误入歧途的地方：

```
int main() {
        const int a = 2;
        const int *p = &a;
        int *p2 = const_cast<int*>(p);
        *p2=5; 
```

在此处的最后一行，您为变量 thu 分配了一个指针，该指针指向*实际上是 const*的东西。也就是说，`a`是`const`。 `p2`指向`a`. `a`即使`p2`不调用未定义行为，您也无法更改 的值。

# security - 登录身份验证后将 SSL 重定向到非 SSL

> ID：12981148
> 
> 赞同：1
> 
> 时间：2012-10-19T19:28:51.043
> 
> 标签：security, cakephp, ssl, cakephp-2.0

我有一个 Cakephp 2+ 站点，它需要某些操作来要求 SSL 连接（即登录、密码重置等），但我不要求整个站点是安全的。在实现这一点时，我发现在 SSL 和非 SSL 页面之间移动时没有保存会话。我在堆栈[https://stackoverflow.com/a/12068099/1353839](https://stackoverflow.com/a/12068099/1353839)上发现了这个问题，它为我解决了这个问题，但我想知道代价是什么。

上述问题的答案需要在 lib/Cake/Model/Datasource/ 中注释掉一行，如下所示：

```
if (!isset($sessionConfig['ini']['session.cookie_secure']) && env('HTTPS')){
   // $sessionConfig['ini']['session.cookie_secure'] = 1; // <-- Commented Out
} 
```

这样做有什么安全后果吗？另外，有没有办法在不影响蛋糕核心文件的情况下做到这一点，因为这通常是不受欢迎的？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:36:14.070

您将通过 SSL 对用户进行身份验证，以便[MITM](http://en.wikipedia.org/wiki/Man-in-the-middle_attack)无法拦截身份验证，但之后您想让会话 cookie 通过纯文本 HTTP 发送，以便 MITM 有机会将其提取并为自己使用？

鉴于此，使用 SSL 有什么意义呢？

（是的，我知道您的会话 cookie 已过期，因此获取其中一个不如获取实际凭据好，但这在安全方面听起来仍然是一个糟糕的主意。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T22:11:05.900

首先，修改核心文件是个坏主意，您应该在[配置](http://book.cakephp.org/2.0/en/development/sessions.html#session-configuration)中设置“session.cookie_secure” 。

会话的目的是将关键信息存储在服务器上，并通过会话密钥将该信息与客户端相关联。会话密钥通常存储在 cookie 中，并随每个请求一起发送到服务器。使用安全 cookie 可防止会话密钥被传输到非 SSL 页面；这就是您看不到会话数据的原因。

关闭安全 cookie 允许将会话密钥发送到非 SSL 页面，但是，它以纯文本形式发送，因此您很容易受到[会话劫持](http://en.wikipedia.org/wiki/Session_hijacking)的影响。根据您的工作，这可能是也可能不是什么大问题。无论如何，通过使用 SSL 进行登录、密码重置等...您将保护用户实际输入的信息（即用户名、密码等...）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T21:05:04.763

不要修改核心文件。您可以在 app/Config/core.php 中指定所需的配置。阅读会话配置语句上方的注释，其中提到了如何指定所需的 ini 设置。

# ios - 带有 Django 的 iOS 应用程序

> ID：12981150
> 
> 赞同：18
> 
> 时间：2012-10-19T19:28:53.747
> 
> 标签：ios, django, restkit, tastypie

所以我们目前有一个使用 Django 创建的网站。现在，我们想创建一个使用相同后端的原生 iOS 应用程序，因此我们不必重新编写整个代码。据我了解，有两种替代路线：

1）直接调用Django URLs，然后调用一个函数。在该函数中，创建一个带有编码 JSON 数据的 HTTPResponse 并将其发回。

2) 使用 Tastypie 之类的东西从 Django 服务器创建一个 REST 服务。但是，除了直接对对象进行 GET 调用之外，我看不出我们如何在 TastyPie 的 Django 模型中调用自定义函数。我们甚至可以这样做吗？

令我惊讶的是，没有太多关于使用现有后端（如 Django 或 RoR）从 iOS 使用 Web 服务的信息。例如，我知道 instagram 使用 Django，但它们如何从 iOS 与服务器进行通信？！

非常感谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T19:37:43.553

我目前正在开发一个适用于 iPhone 的 iOS 应用程序，后端使用 Django / Tastypie。我们同时执行 1 和 2。资源通过 Tastypie 以 REST 样式（经过身份验证）提供，任何自定义函数调用（例如，创建新用户）都由各个 REST 端点的 views.py 处理，该端点返回 JSON。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-20T19:00:32.953

如果可以的话，你应该尝试使用一种通用的方法来做某事，而不是重新发明轮子。鉴于此，REST 是分布式系统的标准软件架构风格，当您使用实体/对象时它工作得非常好。

如果您有与实体交互的 API，建议使用 REST 接口。在 python 上，你有[Tastypie](https://django-tastypie.readthedocs.org/en/latest/)或更新的[Django Rest Framework](http://www.django-rest-framework.org/)，几乎可以完成所有工作。正如您在 2) 中提出的那样

如果您有一个与服务交互的 API，例如登录，那么您应该构建一个 RPC 服务，基本上是一个具有远程访问功能的功能，如您在 1) 中解释的那样。

通常，您需要在强大的应用程序上使用这两种方法。是的，有可能做到这一点。我同意@sampson-chen，我们也在做同样的事情。我们有一个带有tastepie 的REST 接口，其他方法是通过自定义RPC 服务完成的。

在我们的案例中，性能仍然不错，但主要取决于您在服务中调用的方法，例如数据库查询。你有很多方法可以提高速度，例如使用 Celery 来排队繁重的工作。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-15T22:58:26.720

REST API 虽然非常有用，但将您限制为对资源执行的 GET、POST、PUT、DELETE 操作。这会使表达其他操作类型变得困难，例如发送电子邮件。我发现有几种方法可以在 django/tastypie 中处理这个问题：

1.  对现有资源发出 PUT/PATCH 请求，设置一个标志，让您的后端知道触发操作。检测是否设置了标志可以在 post_save 信号处理程序中完成（使用 django-model-utils FieldTracker 查看字段是否从 False 更改为 True）；这也有助于确保您的应用程序逻辑在 REST API 之外也能正常工作（例如通过管理站点、celery 任务、基于 HTML 的视图或 Python shell 进行的更改）。

2.  创建一个非 ORM 资源（例如 /api/v1/email/）并覆盖 post_list() 方法，在那里调用您的函数。

3.  如其他地方所述，创建一个从属资源 (/api/v1/myresource/send/)。

# sql - SQL中的错误（SELECT和LEFT Join）如何给第一个表id？

> ID：12981152
> 
> 赞同：3
> 
> 时间：2012-10-19T19:29:00.860
> 
> 标签：sql, select, left-join

我有 sql 选择：

```
SELECT * 
FROM `fclients` AS F 
LEFT JOIN `fclients_sequens` AS FS ON F.category = FS.category 
ORDER by FS.num 
```

我得到结果：

[![结果选择sql](../Images/3ac358220051ddbed14d6dc68ed9482e.png)](https://i.stack.imgur.com/pkcrw.jpg)

然后，对于`id`第一个表中的给定，我进行 sql 查询：

```
SELECT *, fclients.id as fclientsID 
FROM `fclients` AS F 
LEFT JOIN `fclients_sequens` AS FS ON F.category = FS.category 
ORDER by FS.num 
```

我得到一个错误：

> *#1054 -“字段列表”中的未知列“fclients.id”*

请告诉我如何给id拳头列（id = 37）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T19:30:29.690

引用列 ID 时需要使用别名 F

```
SELECT *, F.id... 
```

# excel - Excel检查同一行中的任何2个值是否等于其他任何值

> ID：12981154
> 
> 赞同：2
> 
> 时间：2012-10-19T19:29:06.180
> 
> 标签：excel, excel-formula

我有一个有 6 列和数万行的数据。我需要计算给定行与不同行的 B 和 E 列共享 B 和 E 列数据的次数。

例如，
`COUNTIF(AND(B[X]=B[Y],E[X]=B[Y]))`

```
    ABCDEF
1 6725 555-371-7295 0:00:12 已于 2012 年 10 月 8 日回答 8:57 出站
2 6725 555-371-7295 0:00:31 已于 2012 年 10 月 8 日回答 8:57 出站
3 6714 555-558-2100 0:00:13 2012 年 10 月 8 日 8:59 出站答复
4 6714 555-558-2100 0:00:25 已于 2012 年 10 月 8 日回答 9:08 出站
5 6725 555-842-2600 0:00:04 已于 2012 年 10 月 8 日回答 9:08 出站

```

其中 X 和 Y 是行号

上面的代码显然不是真正的 Excel 代码，它只是应该理解我想要做的事情。请注意，B1=B2 AND E1 = E2 这就是我要计算的。B3 = B4 但 E3 <> E4 所以我不想计算它。

这意味着， COUNTIFS(B:B,B1,E:E,E1) 将不起作用，因为我真正需要的是`COUNTIFS(B1:B5,ANY B1:B5,El:E5, ANY El:E5)`我希望我提出的问题有点清楚。

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:45:39.000

假设您的数据从第 1 行开始，您可以将其用作您的第一个公式：

`=COUNTIFS(B:B,B1,E:E,E1)-1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:46:12.910

如果您使用的是 Excel 2007 或更高版本，则可以使用 t `COUNTIFS`，它允许多个条件

```
=COUNTIFS(B:B,B1,E:E,B1) 
```

如果使用 Excel 2003，请使用

```
=SUMPRODUCT(($A$1:$A$1000=A1)*($B$1:$B$1000=A1)) 
```

作为数组公式 ( `Ctrl`+ `Shift`+ `Enter`)

调整范围`A1:A1000`并`B:B1000`适应。

# php - HTTPS 重定向到 HTTP

> ID：12981157
> 
> 赞同：2
> 
> 时间：2012-10-19T19:29:21.557
> 
> 标签：php, ssl, https

这里有一个关于 HTTPS 重定向到 HTTP 的线程： [当我访问 HTTPS 时，站点不断重定向到 HTTP，没有明显的原因](https://stackoverflow.com/questions/12388272/site-keeps-redirecting-to-http-when-i-visit-https-for-no-apparent-reason)

我刚开始在我设计的几个网站上遇到同样的问题，没有任何改变导致这种重定向。现在店面无法安全工作。

我在这里不知所措，并尝试了所有方法，从强制 SSL 仅获取更多错误消息，如下所示：“页面未正确重定向，firefox 检测到服务器正在以某种方式重定向此地址的请求永远不会完成。这个问题有时可能是由禁用或拒绝接受 cookie 引起的。”

我确实上传了一个 test.html 文件并且能够使用 https 调用它，所以这不是证书问题。

这可能是Apache问题吗？有人有同样的问题和解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:41:30.423

如果您启用 SSL，那么您可以在 .htaccess 中将任何 url 从 http 重定向到 https

```
RewriteEngine on

# if https on then turn off
RewriteCond %{HTTPS} on
RewriteRule (.*) http://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# if https off then turn on
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

请记住，这将重定向每个 https 页面。我不确定您想要哪个，所以只需将不正确的注释掉即可：）

*   不要在其中粘贴两组代码，否则您将关闭您的网站

# android - 将适配器从 Activity 发送到 ListActivity

> ID：12981159
> 
> 赞同：0
> 
> 时间：2012-10-19T19:29:31.203
> 
> 标签：android, adapter

我不知道我目前的方法是否正确......我有两个类，一个扩展了 Activity，另一个扩展了 ListActivity。现在，当我按下 Activity 类布局中的按钮时，我想对 ListActivity 中的列表进行排序。有哪些可能的方法.. 目前我正在尝试将一个适配器从 Activity 类发送到 ListActivity 但它让我失望了。所以还有其他想法。期待很快的答案......提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:32:49.790

我看到的两个选项。

1）将排序按钮放在ListActivity的布局中，这样它就在同一个Activity中。

2）当他们在活动 1 中按下排序按钮时，将排序方法放入您启动 ListActivity 的 Intent 中，作为额外的。在您的 ListActivity 中阅读额外内容并进行相应排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:39:48.157

创建一个按钮或扩展布局，然后将其添加为标题，例如

```
 Button sort = new Button(this);
    sort.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            //....
        }
    });
    ListView lv;
    getListView().addHeaderView(sort)

    setListAdapter(...) 
```

# java - 多线程环境下需要 ArrayList 的防呆同步

> ID：12981168
> 
> 赞同：8
> 
> 时间：2012-10-19T19:30:05.957
> 
> 标签：java, multithreading, arraylist

我已经在这工作了一个星期了，我正在研究如何正确同步 ArrayList。

简而言之，我的主要问题是我有一个“主”ArrayList 对象。不同的线程可能会进入并从此列表中添加/设置/删除。我需要确保当一个线程遍历 ArrayList 时，另一个线程不会改变它。

现在我已经阅读了许多关于“最佳”处理方式的文章：

*   使用 collections.synchronizedlist
*   使用 CopyOnWriteArrayList
*   将 synchronized() 块与 collections.synchronizedlist 结合使用
*   使用 Vector（很多人反对）

在每次迭代中使用同步块，添加/设置/删除块似乎是我想要的，但人们说有很多开销。

于是我开始玩 CopyOnWriteArrayList（我对我的主 ArrayList 所做的读取比写入更多）。这很适合阅读，但是很多论坛帖子忽略了提及的是不能从迭代器本身添加、设置或删除元素。例如（一个基本版本，但想象它在多线程环境中）：

```
public static void main(String[] args) {

    class TestObject{
        private String s = "";
        public TestObject(String s){
            this.s = s;
        }

        public void setTheString(String s){
            this.s = s;
        }

        public String getTheString(){
            return s;
        }
    }

    CopyOnWriteArrayList<TestObject> list = new CopyOnWriteArrayList<TestObject>();
    list.add(new TestObject("A"));
    list.add(new TestObject("B"));
    list.add(new TestObject("C"));
    list.add(new TestObject("D"));
    list.add(new TestObject("E"));

    ListIterator<TestObject> litr = list.listIterator();

    while(litr.hasNext()){
      TestObject test = litr.next();
      if(test.getTheString().equals("B")){
         litr.set(new TestObject("TEST"));
      }
    }
} 
```

行“litr.set(new TestObject("TEST"));” 会抛出一个

```
java.lang.UnsupportedOperationException 
```

并查看 Java 文档，有一行描述了这种行为：

“不支持迭代器本身的元素更改操作（删除、设置和添加）。这些方法抛出 UnsupportedOperationException。”

因此，您被迫使用以下方法修改该列表

```
list.set(litr.previousIndex(), new TestObject("TEST")); 
```

现在从技术上讲，这不应该存在同步问题吗？如果另一个线程同时进入，并且说，从“列表”中删除所有元素，迭代器将看不到这一点，它会将“列表”设置为给定索引并抛出异常，因为元素那个时候已经不存在了。如果您不能通过迭代器本身添加元素，我只是不明白 CopyOnWriteArrayList 的意义。

我错过了使用 CopyOnWriteArrayList 的重点吗？

我是否包装了每个最终必须在同步块中添加/设置/删除元素的迭代器？

这必须是多线程的常见问题。我原以为有人会制作一个可以毫无顾虑地处理所有这些的课程......

提前感谢您查看此内容！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T22:26:57.673

正如您自己发现的那样，当有人处理数据时，**尤其是**`CopyOnWriteArrayList`在遍历列表时，无法**进行完全安全的更改。**因为：每当您处理数据时，没有**上下文**可以确保在其他人更改列表数据之前执行访问列表的完整语句块。

 ****因此，您**必须**为执行整个数据访问块的所有访问操作（也用于读取！）提供任何上下文（如同步）。例如：

```
ArrayList<String> list = getList();
synchronized (list) {
    int index = list.indexOf("test");
    // if the whole block would not be synchronized,
    // the index could be invalid after an external change
    list.remove(index);
} 
```

或者对于迭代器：

```
synchronized (list) {
    for (String s : list) {
        System.out.println(s);
    }
} 
```

但是现在这种类型的同步出现了一个大问题：它很慢并且不允许多读访问。
因此，为数据访问构建自己的上下文会很有用。我将使用 ReentrantReadWriteLock 来允许多个读取访问并提高性能。
我对这个话题很感兴趣，我会为 ArrayList 做一个这样的上下文，并在我完成后附在此处。

2012 年 10 月 20 日 | 18:30 - 编辑：我使用 ReentrantReadWriteLock 为安全的 ArrayList 创建了自己的访问上下文。
首先，我将插入整个 SecureArrayList 类（大多数第一个操作只是覆盖和保护），然后我插入我的 Tester 类并解释用法。
我只是用一个线程测试了访问，而不是同时测试了很多，但我很确定它有效！如果没有，请告诉我。

安全数组列表：

```
package mydatastore.collections.concurrent;

import java.util.ArrayList;
import java.util.Collection;
import java.util.ConcurrentModificationException;
import java.util.Iterator;
import java.util.List;
import java.util.ListIterator;
import java.util.NoSuchElementException;
import java.util.concurrent.locks.ReentrantReadWriteLock;
import java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock;
import java.util.concurrent.locks.ReentrantReadWriteLock.WriteLock;

/**
 * @date 19.10.2012
 * @author Thomas Jahoda
 *
 * uses ReentrantReadWriteLock
 */
public class SecureArrayList<E> extends ArrayList<E> {

    protected final ReentrantReadWriteLock rwLock;
    protected final ReadLock readLock;
    protected final WriteLock writeLock;

    public SecureArrayList() {
        super();
        this.rwLock = new ReentrantReadWriteLock();
        readLock = rwLock.readLock();
        writeLock = rwLock.writeLock();
    }

    // write operations
    @Override
    public boolean add(E e) {
        try {
            writeLock.lock();
            return super.add(e);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public void add(int index, E element) {
        try {
            writeLock.lock();
            super.add(index, element);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public boolean addAll(Collection<? extends E> c) {
        try {
            writeLock.lock();
            return super.addAll(c);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public boolean addAll(int index, Collection<? extends E> c) {
        try {
            writeLock.lock();
            return super.addAll(index, c);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public boolean remove(Object o) {
        try {
            writeLock.lock();
            return super.remove(o);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public E remove(int index) {
        try {
            writeLock.lock();
            return super.remove(index);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public boolean removeAll(Collection<?> c) {
        try {
            writeLock.lock();
            return super.removeAll(c);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    protected void removeRange(int fromIndex, int toIndex) {
        try {
            writeLock.lock();
            super.removeRange(fromIndex, toIndex);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public E set(int index, E element) {
        try {
            writeLock.lock();
            return super.set(index, element);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public void clear() {
        try {
            writeLock.lock();
            super.clear();
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public boolean retainAll(Collection<?> c) {
        try {
            writeLock.lock();
            return super.retainAll(c);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public void ensureCapacity(int minCapacity) {
        try {
            writeLock.lock();
            super.ensureCapacity(minCapacity);
        } finally {
            writeLock.unlock();
        }
    }

    @Override
    public void trimToSize() {
        try {
            writeLock.lock();
            super.trimToSize();
        } finally {
            writeLock.unlock();
        }
    }

    //// now the read operations
    @Override
    public E get(int index) {
        try {
            readLock.lock();
            return super.get(index);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public boolean contains(Object o) {
        try {
            readLock.lock();
            return super.contains(o);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public boolean containsAll(Collection<?> c) {
        try {
            readLock.lock();
            return super.containsAll(c);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public Object clone() {
        try {
            readLock.lock();
            return super.clone();
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public boolean equals(Object o) {
        try {
            readLock.lock();
            return super.equals(o);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public int hashCode() {
        try {
            readLock.lock();
            return super.hashCode();
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public int indexOf(Object o) {
        try {
            readLock.lock();
            return super.indexOf(o);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public Object[] toArray() {
        try {
            readLock.lock();
            return super.toArray();
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public boolean isEmpty() { // not sure if have to override because the size is temporarly stored in every case...
        // it could happen that the size is accessed when it just gets assigned a new value, 
        // and the thread is switched after assigning 16 bits or smth... i dunno
        try {
            readLock.lock();
            return super.isEmpty();
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public int size() {
        try {
            readLock.lock();
            return super.size();
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public int lastIndexOf(Object o) {
        try {
            readLock.lock();
            return super.lastIndexOf(o);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public List<E> subList(int fromIndex, int toIndex) {
        try {
            readLock.lock();
            return super.subList(fromIndex, toIndex);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public <T> T[] toArray(T[] a) {
        try {
            readLock.lock();
            return super.toArray(a);
        } finally {
            readLock.unlock();
        }
    }

    @Override
    public String toString() {
        try {
            readLock.lock();
            return super.toString();
        } finally {
            readLock.unlock();
        }
    }

    ////// iterators
    @Override
    public Iterator<E> iterator() {
        return new SecureArrayListIterator();
    }

    @Override
    public ListIterator<E> listIterator() {
        return new SecureArrayListListIterator(0);
    }

    @Override
    public ListIterator<E> listIterator(int index) {
        return new SecureArrayListListIterator(index);
    }
    // deligated lock mechanisms

    public void lockRead() {
        readLock.lock();
    }

    public void unlockRead() {
        readLock.unlock();
    }

    public void lockWrite() {
        writeLock.lock();
    }

    public void unlockWrite() {
        writeLock.unlock();
    }

    // getters
    public ReadLock getReadLock() {
        return readLock;
    }

    /**
     * The writeLock also has access to reading, so when holding write, the
     * thread can also obtain the readLock. But while holding the readLock and
     * attempting to lock write, it will result in a deadlock.
     *
     * @return
     */
    public WriteLock getWriteLock() {
        return writeLock;
    }

    protected class SecureArrayListIterator implements Iterator<E> {

        int cursor;       // index of next element to return
        int lastRet = -1; // index of last element returned; -1 if no such

        @Override
        public boolean hasNext() {
            return cursor != size();
        }

        @Override
        public E next() {
            //  checkForComodification();
            int i = cursor;
            if (i >= SecureArrayList.super.size()) {
                throw new NoSuchElementException();
            }
            cursor = i + 1;
            lastRet = i;
            return SecureArrayList.super.get(lastRet);
        }

        @Override
        public void remove() {
            if (!writeLock.isHeldByCurrentThread()) {
                throw new IllegalMonitorStateException("when the iteration uses write operations,"
                        + "the complete iteration loop must hold a monitor for the writeLock");
            }
            if (lastRet < 0) {
                throw new IllegalStateException("No element iterated over");
            }
            try {
                SecureArrayList.super.remove(lastRet);
                cursor = lastRet;
                lastRet = -1;
            } catch (IndexOutOfBoundsException ex) {
                throw new ConcurrentModificationException(); // impossibru, except for bugged child classes
            }
        }
        //  protected final void checkForComodification() {
        //      if (modCount != expectedModCount) {
        //          throw new IllegalMonitorStateException("The complete iteration must hold the read or write lock!");
        //      }
        //  }
    }

    /**
     * An optimized version of AbstractList.ListItr
     */
    protected class SecureArrayListListIterator extends SecureArrayListIterator implements ListIterator<E> {

        protected SecureArrayListListIterator(int index) {
            super();
            cursor = index;
        }

        @Override
        public boolean hasPrevious() {
            return cursor != 0;
        }

        @Override
        public int nextIndex() {
            return cursor;
        }

        @Override
        public int previousIndex() {
            return cursor - 1;
        }

        @Override
        public E previous() {
            //  checkForComodification();
            int i = cursor - 1;
            if (i < 0) {
                throw new NoSuchElementException("No element iterated over");
            }
            cursor = i;
            lastRet = i;
            return SecureArrayList.super.get(lastRet);
        }

        @Override
        public void set(E e) {
            if (!writeLock.isHeldByCurrentThread()) {
                throw new IllegalMonitorStateException("when the iteration uses write operations,"
                        + "the complete iteration loop must hold a monitor for the writeLock");
            }
            if (lastRet < 0) {
                throw new IllegalStateException("No element iterated over");
            }
            //  try {
            SecureArrayList.super.set(lastRet, e);
            //  } catch (IndexOutOfBoundsException ex) {
            //      throw new ConcurrentModificationException(); // impossibru, except for bugged child classes
            //          EDIT: or any failed direct editing while iterating over the list
            //  }
        }

        @Override
        public void add(E e) {
            if (!writeLock.isHeldByCurrentThread()) {
                throw new IllegalMonitorStateException("when the iteration uses write operations,"
                        + "the complete iteration loop must hold a monitor for the writeLock");
            }
            //  try {
            int i = cursor;
            SecureArrayList.super.add(i, e);
            cursor = i + 1;
            lastRet = -1;
            //  } catch (IndexOutOfBoundsException ex) {
            //      throw new ConcurrentModificationException(); // impossibru, except for bugged child classes
            //          // EDIT: or any failed direct editing while iterating over the list
            //  }
        }
    }
} 
```

SecureArrayList_Test：

```
package mydatastore.collections.concurrent;

import java.util.Iterator;
import java.util.ListIterator;

/**
 * @date 19.10.2012
 * @author Thomas Jahoda
 */
public class SecureArrayList_Test {

    private static SecureArrayList<String> statList = new SecureArrayList<>();

    public static void main(String[] args) {
        accessExamples();
//        mechanismTest_1();
//        mechanismTest_2();
    }

    private static void accessExamples() {
        final SecureArrayList<String> list = getList();
        //
        try {
            list.lockWrite();
            //
            list.add("banana");
            list.add("test");
        } finally {
            list.unlockWrite();
        }
        ////// independent single statement reading or writing access
        String val = list.get(0);
        //// ---

        ////// reading only block (just some senseless unoptimized 'whatever' example)
        int lastIndex = -1;
        try {
            list.lockRead();
            //
            String search = "test";
            if (list.contains(search)) {
                lastIndex = list.lastIndexOf(search);
            }
            // !!! MIND !!!
            // inserting writing operations here results in a DEADLOCK!!!
            // ... which is just really, really awkward...
        } finally {
            list.unlockRead();
        }
        //// ---

        ////// writing block (can also contain reading operations!!)
        try {
            list.lockWrite();
            //
            int index = list.indexOf("test");
            if (index != -1) {
                String newVal = "banana";
                list.add(index + 1, newVal);
            }
        } finally {
            list.unlockWrite();
        }
        //// ---

        ////// iteration for reading only
        System.out.println("First output: ");
        try {
            list.lockRead();
            //
            for (Iterator<String> it = list.iterator(); it.hasNext();) {
                String string = it.next();
                System.out.println(string);
                // !!! MIND !!!
                // inserting writing operations called directly on the list will result in a deadlock!
                // inserting writing operations called on the iterator will result in an IllegalMonitorStateException!
            }
        } finally {
            list.unlockRead();
        }
        System.out.println("------");
        //// ---

        ////// iteration for writing and reading
        try {
            list.lockWrite();
            //
            boolean firstAdd = true;
            for (ListIterator<String> it = list.listIterator(); it.hasNext();) {
                int index = it.nextIndex();
                String string = it.next();
                switch (string) {
                    case "banana":
                        it.remove();
                        break;
                    case "test":
                        if (firstAdd) {
                            it.add("whatever");
                            firstAdd = false;
                        }
                        break;
                }
                if (index == 2) {
                    list.set(index - 1, "pretty senseless data and operations but just to show "
                            + "what's possible");
                }
                // !!! MIND !!!
                // Only I implemented the iterators to enable direct list editing,
                // other implementations normally throw a ConcurrentModificationException
            }
        } finally {
            list.unlockWrite();
        }
        //// ---

        System.out.println("Complete last output: ");
        try {
            list.lockRead();
            //
            for (String string : list) {
                System.out.println(string);
            }
        } finally {
            list.unlockRead();
        }
        System.out.println("------");

        ////// getting the last element
        String lastElement = null;
        try {
            list.lockRead();
            int size = list.size();
            lastElement = list.get(size - 1);
        } finally {
            list.unlockRead();
        }
        System.out.println("Last element: " + lastElement);
        //// ---
    }

    private static void mechanismTest_1() { // fus, roh
        SecureArrayList<String> list = getList();
        try {
            System.out.print("fus, ");
            list.lockRead();
            System.out.print("roh, ");
            list.lockWrite();
            System.out.println("dah!"); // never happens cos of deadlock
        } finally {
            // also never happens
            System.out.println("dah?");
            list.unlockRead();
            list.unlockWrite();
        }
    }

    private static void mechanismTest_2() { // fus, roh, dah!
        SecureArrayList<String> list = getList();
        try {
            System.out.print("fus, ");
            list.lockWrite();
            System.out.print("roh, ");
            list.lockRead();
            System.out.println("dah!");
        } finally {
            list.unlockRead();
            list.unlockWrite();
        }
        // successful execution
    }

    private static SecureArrayList<String> getList() {
        return statList;
    }
} 
```

编辑：我添加了几个测试用例来演示线程中的功能。上面的课程完美运行，我现在在我的主项目（Liam）中使用它：

```
private static void threadedWriteLock(){
    final ThreadSafeArrayList<String> list = getList();

    Thread threadOne;
    Thread threadTwo;
    final long lStartMS = System.currentTimeMillis();

    list.add("String 1");
    list.add("String 2");

    System.out.println("******* basic write lock test *******");

    threadOne = new Thread(new Runnable(){
        public void run(){
            try {
                list.lockWrite();

                try {
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            } finally {
                list.unlockWrite();
            }
        }
    });

    threadTwo = new Thread(new Runnable(){
        public void run(){
            //give threadOne time to lock (just in case)
            try {
                Thread.sleep(5);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            System.out.println("Expect a wait....");

            //if this "add" line is commented out, even the iterator read will be locked. 
            //So its not only locking on the add, but also the read which is correct.
            list.add("String 3"); 

            for (ListIterator<String> it = list.listIterator(); it.hasNext();) {
                 System.out.println("String at index " + it.nextIndex() + ": " + it.next());
            }

            System.out.println("ThreadTwo completed in " + (System.currentTimeMillis() - lStartMS) + "ms");

        }
    });

    threadOne.start();
    threadTwo.start();
}

private static void threadedReadLock(){
    final ThreadSafeArrayList<String> list = getList();

    Thread threadOne;
    Thread threadTwo;
    final long lStartMS = System.currentTimeMillis();

    list.add("String 1");
    list.add("String 2");

    System.out.println("******* basic read lock test *******");

    threadOne = new Thread(new Runnable(){
        public void run(){
            try {
                list.lockRead();

                try {
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            } finally {
                list.unlockRead();
            }
        }
    });

    threadTwo = new Thread(new Runnable(){
        public void run(){
            //give threadOne time to lock (just in case)
            try {
                Thread.sleep(5);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            System.out.println("Expect a wait if adding, but not reading....");

            //if this "add" line is commented out, the read will continue without holding up the thread
            list.add("String 3"); 

            for (ListIterator<String> it = list.listIterator(); it.hasNext();) {
                 System.out.println("String at index " + it.nextIndex() + ": " + it.next());
            }

            System.out.println("ThreadTwo completed in " + (System.currentTimeMillis() - lStartMS) + "ms");

        }
    });

    threadOne.start();
    threadTwo.start();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:45:28.907

另一种方法是保护对列表的所有访问，但使用 ReadWriteLock 而不是同步块。

这允许以安全的方式同时读取，并且可以在多读少写的情况下大大提高性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T20:14:50.033

使用 CopyOnWriteArrayList，仅在写操作上同步

```
CopyOnWriteArrayList<TestObject> list = ...

final Object writeLock = new Object();

void writeOpA()
{
    synchronized(writeLock)
    {
        read/write list
    }
}
void writeOpB()
{
    synchronized(writeLock)
    {
        read/write list
    }
} 
```

因此，没有两个写会话会相互重叠。

读取不需要锁定。但是读取会话可能会看到一个变化的列表。如果我们希望读取会话查看列表的快照，请使用`iterator()`或通过 拍摄快照`toArray()`。

* * *

如果你自己做copy-on-write可能会更好

```
volatile Foo data = new Foo(); // ArrayList in your case

final Object writeLock = new Object();

void writeOpA()
{
    synchronized(writeLock)
    {
        Foo clone = data.clone();
        // read/write clone
        data = clone;
    }
}
void writeOpB()
{
    // similar...
}

void readSession()
{
    Foo snapshot = data;
    // read snapshot
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:37:38.287

如果您在迭代*期间*进行修改，是的，您必须使用选项 3。其他人都不会真正按照您的意愿行事。

更具体地说：给定您想要做的事情，您*必须*在迭代期间锁定整个列表，因为您可能会在中间修改它，这会破坏同时在列表上工作的任何其他迭代器。这意味着选项 3，因为 Java 语言不能只具有“同步迭代器”——迭代器本身只能同步对`hasNext()`or的单个调用`next()`，但它不能在迭代的整个长度内同步。****

# javascript - 如何维护服务器端验证和客户端验证

> ID：12981169
> 
> 赞同：0
> 
> 时间：2012-10-19T19:30:07.087
> 
> 标签：javascript, jquery, asp.net, ajax, validation

当我们在 ASP.NET 中有一些控件时，当然最好同时使用客户端和服务器端验证。客户端用于可用性目的，服务器端用于安全目的。

但是，这很容易变得非常难看。当然，如果您的验证是长度检查或正则表达式，则很容易维护。但是，假设您的验证更高级 - 该怎么办？

一种方法是在服务器代码和 Javascript 中实现完全相同的功能。另一种方法是两者都调用具有相同逻辑的 web 服务，但是您的 AJAX 调用必须是同步的，这通常是不好的做法。

**所以，我的问题是，执行服务器端和**客户端验证的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:45:29.480

您的 ajax 调用不必同步进行验证；它只需要快速：

*   例如，当用户关闭某个字段时，将对服务进行 ajax 调用，并且该字段旁边会显示一个微调器，表明服务器正在验证数据。
*   如果服务返回成功，则微调器将替换为绿色复选标记。
*   如果服务返回失败，一个红色的 X，可能带有解释性文本。
*   当用户最终单击提交时，服务器上会进行相同的验证（同步或不同步）。

另一种选择（除了@user133811 使用 JS 的两个地方）是找到一个交叉编译器，它将您选择的语言编译成 JavaScript。但是，这些可能可用也可能不可用。

我通常发现在客户端上进行复杂的验证是不必要且不可取的。是的，让我知道一个字段是必需的，或者是否存在用户名（通过 ajax），或者简单的东西，但如果这是一个复杂的抵押申请或其他东西，我希望我必须在发现我需要包括之前提交如果我宣布我的宠物金鱼为共同签署人（或其他什么，你明白了），我的 W2。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T20:20:21.307

服务器和客户端的相同代码意味着您的服务器需要使用 JS。节点可能是您可能使用的东西。

# sql - SQL 错误：ORA-00933：SQL 命令未正确结束 行错误：3 列：35

> ID：12981173
> 
> 赞同：1
> 
> 时间：2012-10-19T19:30:26.290
> 
> 标签：sql, oracle

我正在创建一个创建 TABLE 的脚本，但我必须执行的最后一个命令有问题：

> ```
> SELECT Studenci.Nazwisko,
>    Trunc(Months_Between(Sysdate,Studenci.RokUrodzenia)/12) Wiek FROM
>    Studenci.RokUrodzenia to_date('1980','YYYY') 
> ```

这是我的脚本；我究竟做错了什么？

> ```
>  CREATE TABLE Studenci(
>        NrIndeksu NUMBER(3) PRIMARY KEY,
>        Nazwisko VARCHAR2(16),
>        RokUrodzenia NUMBER(4),
>        Kierunek VARCHAR2(12)
>     );
> 
>     CREATE TABLE Wykladowcy(
>        IdWykladowcy NUMBER(4) PRIMARY KEY,
>        Nazwisko VARCHAR2(16),
>        Stopien VARCHAR2(6),
>        Stanowisko VARCHAR(8)
>     );
> 
>     CREATE TABLE Kursy(
>        IdKursu NUMBER(1) PRIMARY KEY,
>        Nazwa VARCHAR2(18),
>        IdWykladowcy NUMBER(4) REFERENCES Wykladowcy
>     );
> 
>     CREATE TABLE Rejstracje(
>        NrIndeksu NUMBER(3) REFERENCES Studenci , 
>        IdKursu NUMBER(1)  REFERENCES Kursy ,
>        Data DATE
>     );
> 
>     CREATE UNIQUE INDEX Ind_Kursy_naz ON Kursy(Nazwa);
>     CREATE INDEX Ind_Studenci_naz ON Studenci(Nazwisko);
>     CREATE INDEX Ind_Wykladowcy_naz ON Wykladowcy(Nazwisko);
> 
>     INSERT INTO Wykladowcy VALUES (1010,'Kowalski Jan', 'Dr', 'Adiunkt');
>     INSERT INTO Wykladowcy VALUES (1011,'Jakubowski Emil','Dr hab','Docent');
>     INSERT INTO Wykladowcy VALUES (1012,'Gazda Mirosław','Dr','Profesor');
> 
>     INSERT INTO Kursy VALUES (1,'Bazy danych',1010);
>     INSERT INTO Kursy VALUES (2,'Systemy operacyjne',1012);
>     INSERT INTO Kursy VALUES (3,'Multimedia',1011);
>     INSERT INTO Kursy VALUES (4,'Sieci komputerowe',null);
> 
>     INSERT INTO Studenci VALUES (101,'Kuczyńska Ewa',1980,'Bazy danych');
>     INSERT INTO Studenci VALUES (102,'Lubicz Robert',1985,'Multimedia');
>     INSERT INTO Studenci VALUES (103,'Krajewski Bogdan',1988,'Bazy danych');
>     INSERT INTO Studenci VALUES (104,'Lityńska Anna',1987,'Multimedia');
>     INSERT INTO Studenci VALUES (105,'Marzec Marcin',1982,'Multimedia');
>     INSERT INTO Studenci VALUES (106,'Cichaocki Rafał',1989,'Bazy danych');
> 
>     INSERT INTO Rejstracje VALUES (101,1,NULL);
>     INSERT INTO Rejstracje VALUES (102,3,NULL);
>     INSERT INTO Rejstracje VALUES (104,3,NULL);
>     INSERT INTO Rejstracje VALUES (106,1,NULL);
>     INSERT INTO Rejstracje VALUES (104,2,NULL);
>     INSERT INTO Rejstracje VALUES (101,4,NULL);
>     INSERT INTO Rejstracje VALUES (103,1,NULL);
>     INSERT INTO Rejstracje VALUES (103,1,NULL);
>     INSERT INTO Rejstracje VALUES (105,1,NULL);
> 
>     UPDATE Rejstracje SET Rejstracje.IdKursu=Rejstracje.IdKursu*3
>     WHERE Rejstracje.NrIndeksu=105;
>     COMMIT UPDATE
> 
>     INSERT INTO Rejstracje(Data)
>     VALUES (Sysdate);
> 
>     SELECT *FROM Kursy
>     WHERE Kursy.IdWykladowcy IS NULL;
> 
>     SELECT *FROM Rejstracje
>     WHERE Rejstracje.NrIndeksu=101;
> 
>     SELECT Kursy.Nazwa 
>     FROM Kursy
>     ORDER BY Nazwa ASC;
> 
>     SELECT Studenci.Nazwisko,
>     Trunc(Months_Between(Sysdate,Studenci.RokUrodzenia)/12) Wiek
>     FROM Studenci.RokUrodzenia to_date('1980','YYYY') 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:54:26.290

从错误消息来看，它似乎缺少`;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:55:55.323

这个 SQL：

```
SELECT Studenci.Nazwisko,
       Trunc(Months_Between(Sysdate,Studenci.RokUrodzenia)/12) Wiek
  FROM Studenci.RokUrodzenia to_date('1980','YYYY'); 
```

无效，因为`to_date()`呼叫不能那样去那里。

您可能正在寻找类似的东西：

```
SELECT Studenci.Nazwisko,
       Trunc(Months_Between(Sysdate,Studenci.RokUrodzenia)/12) Wiek
  FROM Studenci
 WHERE RokUrodzenia = 1980; 
```

鉴于这`RokUrodenzia`是一个 NUMBER(4) 列而不是 DATE 列。您可能仍需要做一些工作才能使 MONTHS_BETWEEN() 调用正常工作，因为 RokUrodenzia 不是 DATE（正如我所说）并且 MONTHS_BETWEEN 可能需要一个日期。您必须研究如何解决该问题；你可以在那里合法地使用 TO_DATE() 。

# jpa-2.0 - 在 JPA 中，为什么 CriteriaBuilder 让我在不相关的类型之间构建不健全的谓词？

> ID：12981175
> 
> 赞同：2
> 
> 时间：2012-10-19T19:30:33.077
> 
> 标签：jpa-2.0, eclipselink, hibernate-criteria, querydsl

我很好奇为什么使用`CriteriaBuilder`JPA 2 类可以创建这样的查询。假设我有一个名为as 属性`User`的持久类。为什么我可以写这个？`String``name`

```
CriteriaBuilder builder = mgr.getCriteriaBuilder();

CriteriaQuery<User> crit = builder.createQuery(User.class);
Root<User> user = crit.from(User.class);                     // 1
crit.select(user)
    .where(builder.equal(user.get(User_.name), 2.5));        // 2 
```

首先，在标记 1：为什么我必须`User.class`再次指出？我的 CriteriaQuery 不应该知道我对用户感兴趣吗？可能在这里注入另一个类不会破坏类型安全吗？

其次，在标记 2：该`name`属性是 a `String`。为什么我可以编译这样的废话，将 a`String`与 double 进行比较？换句话说，为什么被调用`equal`方法的签名是这样的：

```
public Predicate equal(Expression<?> x, Object y) 
```

而不是如下可能更安全的版本？

```
public <T> Predicate equal(Expression<T> x, T y) 
```

[像Querydsl](http://www.querydsl.com)这样的其他查询框架会为这个问题提供更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-09T16:16:43.060

特定于 JPA，您还可以使用不需要编译时模型生成的[对象查询](http://www.objectquery.org)或[鱼雷查询](http://www.torpedoquery.org)（但这是专门针对 HQL）。无论如何[QueryDsl](http://www.querydsl.com/)是第一个实现类型安全查询的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-20T07:02:51.477

我相信 JPA 2 Criteria API 的类型安全方面是在规范过程的后期添加的。这就是为什么感觉不一致。

Querydsl 比 JPA 2 Criteria API 更简洁，也更安全。Querydsl 使用流利的构建器而不是工厂类来创建谓词，因此可以在此处找到等效方法[http://www.querydsl.com/static/querydsl/2.8.0/apidocs/com/mysema/query/types/expr /SimpleExpression.html#eq%28T%29](http://www.querydsl.com/static/querydsl/2.8.0/apidocs/com/mysema/query/types/expr/SimpleExpression.html#eq%28T%29)

我是Querydsl的维护者，所以这个答案是有偏见的。

# mysql - Mysql查询琐事

> ID：12981178
> 
> 赞同：3
> 
> 时间：2012-10-19T19:30:39.777
> 
> 标签：mysql, sql, database

更新：请假设，我的版本号 xxxx 中正好有 4 个元素

```
Table xyz (id int, os varchar, version varchar)

id      os       version
1       mac      1.0.0.4
2       android  1.0.1.2
3       mac      1.0.0.14
4       mac      1.0.0.07 
```

我想找到每个操作系统的最大版本号。

```
select max(version), os from xyz group by os 
```

但是在上面的数据示例中，它返回 1.0.0.4 作为 mac 的最高版本，而不是返回 1.0.0.14。有什么办法可以解决上面的查询吗？我知道版本是 varchar :( 如果没有可能的解决方案，那么我可以将数据类型更改为其他，但这仍然不能解决问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T21:14:11.053

如果版本中的 4 部分都是数字且不大于 255，则可以使用该**[`INET_ATON()`](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_inet-aton)**功能，反之亦然`INET_NTOA()`：

```
SELECT INET_NTOA(MAX(INET_ATON(version))), os 
FROM xyz 
GROUP BY os ; 
```

在**[SQL-Fiddle中测试](http://sqlfiddle.com/#!2/aaab3/1)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:57:34.147

当您尝试获取最大值时，Mysql 对此字段使用文本排序：
SELECT version FROM test ORDER BY VERSION;
1.0.0.14
1.0.0.4
1.0.07
1.0.1.2.4

但即使您尝试将其转换为整数，您也会得到
SELECT version FROM test ORDER BY CAST( `VERSION`AS SIGNED);
1
1
1
1

这确实是有道理的。你想让 MySQL 怎么猜，你想要什么？MySQL应该用来存储数据，你应该自己格式化。

一个好的解决方案是使用几个字段作为版本：
id int、os varchar、**versionMajor int、versionMinor int、versionMoreMinor int、versionEvenMoreMinor int**

您应该能够根据需要对它们进行排序和格式化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T20:55:27.693

它很丑陋，但它正在完成这项工作：

```
select t1.os,t1.version from xyz t1 where (t1.os,
       ((cast(SUBSTRING_INDEX(t1.version, '.', 1) as unsigned)+1)*1000
       +(cast(SUBSTRING_INDEX(SUBSTRING_INDEX(t1.version, '.', -3), '.', 1) as unsigned)+1)*100
       +(cast(SUBSTRING_INDEX(SUBSTRING_INDEX(t1.version, '.', -2), '.', 1) as unsigned)+1)*10
       +(cast(SUBSTRING_INDEX(t1.version, '.', -1) as unsigned))+1))
  =(select t2.os,
   max((cast(SUBSTRING_INDEX(t2.version, '.', 1) as unsigned)+1)*1000
      +(cast(SUBSTRING_INDEX(SUBSTRING_INDEX(t2.version, '.', -3), '.', 1) as unsigned)+1)*100
      +(cast(SUBSTRING_INDEX(SUBSTRING_INDEX(t2.version, '.', -2), '.', 1) as unsigned)+1)*10
      +(cast(SUBSTRING_INDEX(t2.version, '.', -1) as unsigned))+1) 
from xyz t2 where t2.os=t1.os); 
```

[sqlfiddle](http://www.sqlfiddle.com/#!2/d012b/64)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T21:32:53.687

您在这里真正想做的是使用一个`SPLIT`函数，但这在 MySQL 中不可用。但是，您可以编写一个用户定义的函数来做同样的事情，或者将这个函数代码重构到一个视图中。

```
CREATE FUNCTION SPLIT_STR(
  x VARCHAR(255),
  delim VARCHAR(12),
  pos INT
)
RETURNS VARCHAR(255)
RETURN REPLACE(SUBSTRING(SUBSTRING_INDEX(x, delim, pos),
       LENGTH(SUBSTRING_INDEX(x, delim, pos -1)) + 1),
       delim, ''); 
```

[来源](http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/)。

此外，您可能想考虑一下，之所以如此痛苦，是因为您实际上违反了第一范式。您指定形式的版本号实际上是四个不同的值：主要版本、次要版本、修订（或维护）和构建。您的表结构应使用相同的格式：

`Table xyz (id int not null, os varchar not null, version_major int not null, version_minor int not null, version_revision int null, version_build int null)`

然后，您只需使用一个`ORDER BY`子句对数据进行排序。您可以使用计算字段或视图来显示格式化的版本号。

现在，我知道您为什么选择使用单个字段了。版本号不一致，许多版本号不包括修订或构建值，其他包括字母等。但是，根据我的经验，您可以将其更改`int`为 a`varchar`并涵盖 90% 的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T19:36:28.173

您可以尝试将字符串转换为整数并获取 MAX()

```
SELECT MAX( CONVERT( REPLACE( `version`, '.', '' ), UNSIGNED ) ) from xyz 
```

**更新**

还有另一种结束检测的方法，但它不适用于次要版本，也许您会调整这个繁重的查询以使其适合您

```
SELECT `version`,
    CONVERT(
        CONCAT_WS( '.',
            REPLACE( SUBSTRING( `version`, 1, ( CHAR_LENGTH( `version` ) - LOCATE( '.', REVERSE( `version` ) ) ) ), '.', '' ),
            SUBSTRING( `version`, 1 + LOCATE( '.', REVERSE( `version` ) ) * -1  )
        ),
        DECIMAL ( 10, 3 )
    )
    FROM `xyz` 
```

抱歉，代码改进了

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T21:09:46.117

感谢@ntvf 的想法。这将做我正在寻找的。

```
select a.os, xyz.version from xyz, 
  (SELECT os, MAX( CONVERT(REPLACE(`version`,'.',''),UNSIGNED)) as version from xyz group by os) a 
where 
   a.os=xyz.os and 
   CONVERT(REPLACE( xyz.version, '.', '' ), UNSIGNED) = a.version 
```

# sql-server-2008 - SQL Server：存储过程保存错误

> ID：12981182
> 
> 赞同：3
> 
> 时间：2012-10-19T19:30:54.800
> 
> 标签：sql-server-2008, stored-procedures, syntax-error, ssms-2012

我正在使用 SQL Server 2008 和 SSMS 2012。我有一个引用不存在的表的存储过程。编辑器在有问题的表格上显示红色下划线，表示有问题。

但是，当我执行查询时，我收到了消息

> 命令成功完成。

这非常烦人。我还从另一台机器连接到引擎，它遇到了同样的问题，这意味着它在服务器上，而不是 ssms。数据库上是否有某种设置可以确定数据库是否检查存储过程的语法？请帮忙！

**澄清：** 我知道语法是错误的。问题是 SSMS 允许我执行 CREATE 或 ALTER 语句而不会出错，即使它引用了不存在的表。我希望它失败。通常它会，但由于某种原因它突然停止给出错误。我希望它给我错误。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:49:07.077

您的语法很好，并且在您创建存储过程时进行了检查。但是，在编译存储过程之前不会检查表的存在，并且在执行存储过程时会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:41:54.287

发生的事情是管理工作室中的 IDE 没有刷新模式模型。由于 SSMS 的本地实例不知道该表存在，它会在表名下抛出一个红线；当您实际运行存储过程/查询时，发送到数据库的代码会正确评估并运行。

要刷新 SSMS 本地数据，请尝试按`Ctrl-Shift-R`，如此处所述[。](https://stackoverflow.com/questions/2201151/sql-management-studio-wont-recognize-a-table-exists-after-scripted-create)

**编辑：**

您可能想查看[延迟名称解析](http://msdn.microsoft.com/en-us/library/ms190686%28v=sql.105%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-10T11:16:37.277

`CREATE`或时您不会收到错误消息`ALTER`，但您可以在之后使用脚本检查您的 SP 是否缺少依赖项。

请在此处查看我对相关问题的回答（我只是发布一个链接以避免重复）：

[我正在寻找一种可靠的方法来验证 T-SQL 存储过程。有人有吗？](https://stackoverflow.com/questions/2784866/im-looking-for-a-reliable-way-to-verify-t-sql-stored-procedures-anybody-got-on/27399350#27399350)

# ruby - 每次我运行 chef-client 时，它都会下载 JDK，这需要 5 分钟。如何跳过？

> ID：12981186
> 
> 赞同：0
> 
> 时间：2012-10-19T19:31:01.860
> 
> 标签：ruby, chef-infra

即使我在一个盒子上运行 chef-client，它也会等待大约 5 分钟来下载 JDK，即使它之前已经完成了。有什么办法可以解决这个问题吗？

```
[Mon, 22 Oct 2012 13:17:46 -0500] INFO: Processing remote_file[/var/chef/cache/jdk-1.6-u30-linux-amd64.rpm] action create_if_missing (sun_java::default line 18)
[Mon, 22 Oct 2012 13:17:48 -0500] INFO: Processing package[jdk-1.6-u30-linux-amd64.rpm] action install (sun_java::default line 25)
[Mon, 22 Oct 2012 13:21:07 -0500] INFO: package[jdk-1.6-u30-linux-amd64.rpm] installed version 1.6.0_30-fcs
[Mon, 22 Oct 2012 13:21:07 -0500] INFO: package[jdk-1.6-u30-linux-amd64.rpm] sending run action to bash[update-alternatives java] (immediate)
[Mon, 22 Oct 2012 13:21:07 -0500] INFO: Processing bash[update-alternatives java] action run (sun_java::default line 40) 
```

配方如下：

```
urlVersion = "1."+node["sun_java"]["version"].sub(/[u]/, "-u")
node.default["sun_java"]["rpm_url"] = "http://***/#{urlVersion}/jdk-#{urlVersion}-linux-#{node["sun_java"]["arch"]}.rpm"

#Check that we are using the .rpm file because of the recent change
if File.extname(File.basename(node["sun_java"]["rpm_url"]))!=".rpm"
  raise "You must use the jdk*.rpm file to install the Sun JDK. You can get it from the jdk*-rpm.bin file by running the command './jdk*-rpm.bin -x'"
end

javaRPM = File.basename(node["sun_java"]["rpm_url"])

remote_file "#{Chef::Config[:file_cache_path]}/#{javaRPM}" do
  action :create_if_missing
  source node["sun_java"]["rpm_url"]
  mode "0755"
  backup false
end

package javaRPM do
  action :install
  source "#{Chef::Config[:file_cache_path]}/#{javaRPM}"
  options "--nogpgcheck" # sun/oracle doesn't sign their RPMs o_O
  notifies :run, "bash[update-alternatives java]", :immediately
end

javaHomeFolder = "/usr/java/jdk1.#{node["sun_java"]["version"].sub(/[u]/, ".0_")}"
jdkFolder = "#{javaHomeFolder}/bin"
slaveString = ""

node["sun_java"]["update_slaves"].each do |java_bin|
  slaveString = slaveString + "--slave \"/usr/bin/#{java_bin}\" \"#{java_bin}\" \"#{jdkFolder}/#{java_bin}\" "
end

bash "update-alternatives java" do
  action :nothing
  code <<-EOH
    update-alternatives --install "/usr/bin/java" "java" "#{jdkFolder}/java" 1 #{slaveString}
    update-alternatives --set java #{jdkFolder}/java
  EOH
end

#Remove old environment then notify new environment to be created
ruby_block "delete_environement" do
        block do
            editBashrc = Chef::Util::FileEdit.new("/etc/profile")
                editBashrc.search_file_delete_line(/^.*#JAVA_HOME environment settings.*$/)
                editBashrc.search_file_delete_line(/^.*#Auto-generated by Chef Cookbook sun_java.*$/)
                editBashrc.search_file_delete_line(/^.*export JAVA_HOME=.*$/)
                editBashrc.write_file 
        end
        action :create
end

#create environment of root user
execute "create_environment" do
  user "root"
  command "echo -e '#JAVA_HOME environment settings\n#Auto-generated by Chef Cookbook sun_java\nexport JAVA_HOME=#{javaHomeFolder}' >> /etc/profile"
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T09:12:56.523

不是下载需要 5 分钟。似乎 rpm 每次都重新安装软件包（输出缩短并注释）：

```
[Mon, 22 Oct 2012 13:17:46 -0500] Processing remote_file # Download the file
[Mon, 22 Oct 2012 13:17:48 -0500] Processing package # Install the file 2 secs later
[Mon, 22 Oct 2012 13:21:07 -0500] package installed # 3+ minutes later 
```

我不知道`rpm`，但 Debian 的包管理默认会跳过已安装的包。

所以我想你的选择是：

1.  将 chef 配置为更详细。这样，您可以使用所有选项跟踪调用，并查看是否通过从 shell 运行相同的命令来重新产生行为。
2.  查明`rpm`其行为是否与 Debian 相同`dpkg`（见上文）。如果没有，告诉它跳过已经安装的包。
3.  检查软件包版本。如果您的包版本在每次运行时都相同，请转到 (1)。如果不是，请查看是否可以`rpm`跳过类似版本。
4.  不要使用`package`资源，而是手动安装包（仅在所有其他选项都失败时使用）。例如，您可以使用该[`execute`资源](http://wiki.opscode.com/display/chef/Resources#Resources-Execute)并创建一个指示文件，告诉 Chef 您已经安装了该软件包。

选项 #4 的伪代码：

```
execute "install Java by hand" do
  command "rpm install <pkg> && touch /home/user/java_installed"
  creates "/home/user/java_installed"
end 
```

# javascript - JQuery Datatables - 空表列标题被压扁

> ID：12981187
> 
> 赞同：3
> 
> 时间：2012-10-19T19:31:03.677
> 
> 标签：javascript, jquery, datatable

我有一个包含两个数据表的页面。其中一个在页面加载时填充了数据，另一个是空的（但是是骨架，即它有标题和空`<tbody>`标签）。第二个表取决于第一个表中的行的选择。一切正常，两个表都按应有的方式加载和显示数据，但第二个表为空时除外。

当它为空时，标题如下所示：

![在此处输入图像描述](../Images/227db4d8bac1f5abfde9f18d5d88b70f.png)

这些标题为每个标题设置了 sWidth，当有要显示的数据时，它们是正确的宽度，并且一切正常。到目前为止，我还无法让它们在表中没有数据的情况下表现出来。

任何帮助将不胜感激。

# 编辑

我已经尝试打开和关闭 bAutoWidth（在 aoColumns 属性中删除和添加显式列宽。

我还尝试给`<th>`元素一个显式宽度`<th width="50px">`，并尝试在 上设置一个`<th>`具有显式宽度的类。此外，我尝试将 th 中的文本包装在 a 中`<span>`并设置宽度，然后设置具有宽度的样式。没有任何效果。事实上，`<span>`通过将标题行几乎折叠到 0，情况变得更糟。

此外，还设置了 table-layout:fixed。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:37:22.803

在黑暗中拍摄。你有没有尝试过：

```
table {
    table-layout: fixed;
} 
```

?

# c++ - 为什么不同结构大小的输出是一样的？

> ID：12981189
> 
> 赞同：0
> 
> 时间：2012-10-19T19:31:07.130
> 
> 标签：c++

> **可能重复：**
> [结构填充](https://stackoverflow.com/questions/5804541/struct-padding)

程序如下：

```
#include <iostream>

using namespace std;

struct node1 {
    int id;
    char name[4];
};

struct node2 {
    int id;
    char name[3];
};

int
main(int argc, char* argv[])
{
    cout << sizeof(struct node1) << endl;
    cout << sizeof(struct node2) << endl;
    return 0;
} 
```

并且编译器是`g++ (GCC) 4.6.3`. 输出是：

```
8
8 
```

我真的不明白为什么会这样。为什么输出`sizeof(struct node2)`不是7？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:34:07.990

这是因为结构在边界处对齐。通常为 4 个字节（尽管可以更改） - 这意味着结构中的每个元素至少为 4 个字节，如果任何元素的大小小于 4 个字节，则在最后添加填充。

因此两者都是 8 个字节。

```
size of int = 4
size of char = 1 
size of char array of 3 elements = 3

total size = 7, padding added (because of boundary) = +1 byte

for second structure:

sizeof int = 4
sizeof char = 1
sizeof char array of 4 elements = 4

total size = 8\. no padding required. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:36:39.093

```
because of Packing and byte alignment<br/> 
```

一般的答案是编译器可以自由地在成员之间添加填充以用于对齐目的。或者我们可以这样说，您可能有一个编译器将所有内容对齐到 8 个字节。

# c# - 如何使静态变量线程安全

> ID：12981190
> 
> 赞同：9
> 
> 时间：2012-10-19T19:31:11.717
> 
> 标签：c#, multithreading

我有这个静态类，它包含一个静态变量（一个简单的 int）。我已经在线程`lock()`的`Run()`方法中实现了一个，所以没有其他线程可以同时访问这个类，但是变量仍然很疯狂，显示重复，非常高的值等等。

这是课程：

```
public static class ExplorationManager
{
    public static int Counter = 0;

    public static void ExplorerMaker(List<int[]> validPaths, List<string> myParents, string[,] myExplorationMap, List<int[]> myPositions)
    {
        foreach (var thread in validPaths.Select
        (path => new Explorer(myParents, path, myExplorationMap, myPositions)).
        Select(explorer => new Thread(explorer.Explore)))
            {
                thread.Name = "Thread of " + Counter + " generation";
                Counter++; 
                thread.Start();
    }
} 
```

}

有没有办法让这个变量“更多”线程安全？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-19T19:46:28.620

为了提高这种类型的安全性，您至少需要解决两个问题。

第一个是制作`Counter` `private`。在当前的形式中，该变量是 100% 公开的，它可以被应用程序中的任何代码改变。今天它可能是安全的，但没有什么可以保护你明天不犯错误。如果您仍然希望其他代码能够读取该属性，请使用访问器

```
private static int m_counter;
public static int Counter {
  get { return m_counter; }
} 
```

第二个问题是`++`在线程之间共享的位置上的操作不是安全的。它扩展为以下代码

```
Counter = Counter + 1; 
```

这实际上是在做什么

1.  负载计数器
2.  加载 1
3.  添加
4.  专卖店柜台

几乎可以随时中断线程。如果一个线程在步骤 1、2 或 3 被中断，而另一个线程完全执行该序列，那么您最终将添加/存储过时的值。这就是`++`不安全的原因。在线程之间增加共享值的安全方法是使用`Interlocked.Increment`. 它正是为此目的而设计的

```
Interlocked.Increment(ref m_counter); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-10-19T19:37:51.767

使用[互锁](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)类：

```
Interlocked.Increment(ref Counter); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-19T19:34:22.590

您需要使用`lock`静态变量的所有读/写操作。就像是：

```
public static readonly object CounterLock = new object();

...
lock ( CounterLock )
{
    Counter++;
}
... 
```

关键是*所有*读/写都*必须受到*锁的保护——仅仅保护一个地方是不够的，因为当其他地方的锁生效时，执行读或写的线程仍然可能会做出改变。

锁保护代码区域，而不是变量，这就是为什么在访问共享变量的任何地方都需要锁的原因。

请注意，您不能锁定`Counter`变量 - 您需要引用类型的实例作为锁定，而不是值类型。这就是我用作`object`锁类型的原因（另一个答案也是如此）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-19T19:35:17.723

这样的事情应该可以解决问题：

```
public static class ExplorationManager
{
    public static int Counter = 0;
    private static object _lock = new object();

    public static void ExplorerMaker(List<int[]> validPaths, List<string> myParents, string[,] myExplorationMap, List<int[]> myPositions)
    {
        foreach (var thread in validPaths.Select
        (path => new Explorer(myParents, path, myExplorationMap, myPositions)).
        Select(explorer => new Thread(explorer.Explore)))
            {
                thread.Name = "Thread of " + Counter + " generation";
                lock(_lock)
                {
                    Counter++; 
                    thread.Start();
                }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-19T19:41:09.793

[Interlocked.Increment](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)是另一个线程安全的选项。如果您只需要计数器，使用起来非常简单。

```
var newCounter = Interlocked.Increment(ref Counter)
thread.Name = "Thread of " + (newCounter-1) + " generation"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-19T19:34:57.920

您可以尝试使用静态构造函数来初始化静态变量。最好提供一个单独的`locking`对象，这样您就可以很好地控制锁的粒度。

# javascript - 如何根据jQuery对话框中的选择在父窗口中设置控件

> ID：12981191
> 
> 赞同：0
> 
> 时间：2012-10-19T19:31:11.733
> 
> 标签：javascript, jquery

我正在使用 jquery 对话框中启动一个 aspx 页面

```
var url = "SomePage.aspx";
            $("#divPop").load(url).dialog({
                position: '50px',
                modal: true,
                closeText: '',
                bgiframe: true,
                height: 'auto',
                width: '1000',
                open: function (event, ui) {

                },
                close: function (event, ui) {

                }
            }).dialog("open"); 
```

在弹出的 aspx 中选择 < 我在 jqgrid 中选择一行。

关闭对话框时，我希望能够使用对话框中的选择设置调用页面中文本框的值。不同的页面可以使用对话框启动相同的 aspx，我希望能够为不同页面中具有不同 id 的文本框设置值

# python - Python 和 QuickBooks 数据库

> ID：12981195
> 
> 赞同：9
> 
> 时间：2012-10-19T19:31:29.893
> 
> 标签：python, quickbooks, iif

我想使用 Python 从*Intuit QuickBooks Enterprise Solutions - Manufacturing and Wholesale Edition 12.0*数据库中提取所有产品信息。

我指的 QB 安装在 Intranet 服务器上，我只需要在内部访问它（相同的网络 ID）。

我只需要有人指出我正确的方向，或者举一个通过 Python 从 QB 数据库中提取产品信息的示例。我已经搜索并阅读了几个小时关于尝试将 Python 与 QuickBooks 一起使用的人的信息，但是有很多 QB 术语对我来说都是希腊语，例如，我应该使用 IDS 吗？QB XML 呢？COM 接口方法看起来很可怕。

我想，最简单的选择是将 QB 产品数据库/列表导出为 IIF，然后筛选/利用该导出。这不是必须经常做的事情，因此易用性/简单性优先于速度。

如果有人有任何从 QB 数据库读取/写入数据的敏锐方法，请告诉我！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T20:13:42.473

好吧，*没有*简单的答案。

Intuit 正在将所有内容（包括数据）转移到他们的云系统中。

“正确”答案使用[SDK](https://developer.intuit.com/us#QuickBooksDesktopSDK)。SDK 是做所有事情的“官方”方式。但它本身不支持 Python。

中间解决方案：[将 SDK + Web 连接器与 Python 结合使用](http://marketplace.intuit.com/webconnector/)。

现在，回到你的问题：[一个非常好的指针](http://blog.bflarsen.com/?p=132)

但请注意，随着 Intuit 迁移到云端并锁定订阅模式，SDK 将越来越少地受到支持。

# c - 使用系统调用 fork() execvp() wait() pipe() 实现多管道 - 它根本不起作用

> ID：12981199
> 
> 赞同：5
> 
> 时间：2012-10-19T19:31:41.590
> 
> 标签：c, shell, fork, pipe, waitpid

我需要实现我的外壳来处理多个管道命令。例如，我需要能够处理这个：`ls | grep -i cs340 | sort | uniq | cut -c 5`. 我假设问题是我没有将上一个命令的输出传递给下一个命令的输入。当我执行我的代码时，它没有给我任何输出。我正在使用这个伪代码：

```
for cmd in cmds
    if there is a next cmd
        pipe(new_fds)
    fork
    if child
        if there is a previous cmd
            dup2(old_fds[0], 0)
            close(old_fds[0])
            close(old_fds[1])
        if there is a next cmd
            close(new_fds[0])
            dup2(new_fds[1], 1)
            close(new_fds[1])
        exec cmd || die
    else
        if there is a previous cmd
            close(old_fds[0])
            close(old_fds[1])
        if there is a next cmd
            old_fds = new_fds
if there are multiple cmds
    close(old_fds[0])
    close(old_fds[1]) 
```

这是处理多个管道的函数的源代码。

```
void execute_multiple_commands(struct command ** commands_to_exec,
        int num_commands_p)
{
    pid_t status;
    int i, err;
    int new_fd[2], old_fd[2];
    pid_t pid, cpid;

    // creating child process
    if ( (cpid = fork()) == -1)
    {
        fprintf(stderr, "Could not create child process, exiting...");
        exit(1);
    }

    if (cpid == 0) // in the child process we run multiple pipe handling
    {
        for (i = 0; i < num_commands_p; i++) // for each cmd in cmds
        {
            if (i+1 < num_commands_p) // if there is next cmd
                pipe(new_fd);

            if ( (pid = fork()) == -1)
            {
                fprintf(stderr, "Could not create child process, exiting...");
                exit(1);
            }

            if (pid == 0) // if child
            {
                if (i != 0) // if there is a previous command
                {
                    dup2(old_fd[0], 0); // setting up old_pipe to input into the child
                    close(old_fd[0]);
                    close(old_fd[1]);

                }
                if (i+1 < num_commands_p) // if there is a next cmd
                {
                    close(new_fd[0]); // setting up new_pipe to get output from child
                    dup2(new_fd[1], 1);
                    close(new_fd[1]);

                    err = execvp(commands_to_exec[i]->args[0], commands_to_exec[i]->args);
                    status = err;
                    exit(err);
                }
            }
            else
            {
                waitpid(pid, &status, 0);
                if (status == -1)
                    exit(1);

                if (i != 0) // if there a previous command
                {
                    close(old_fd[0]);
                    close(old_fd[1]);
                }
                if (i+1 < num_commands_p) // if there a next cmd
                {
                    old_fd[0] = new_fd[0];
                    old_fd[1] = new_fd[1];
                }
                exit(0);
            } // end if
        } // end for

        if (i) // if there a multiple commands
        {
            close(old_fd[0]);
            close(old_fd[1]);
        }
    }
    else // in the parent process we are waiting for child to handle multiple pipes
        waitpid(cpid, &status, 0);
} 
```

功能`execvp()`采用结构数组。我检查了我所有的解析部分，它工作正常。这是`execute_multiple_commands()`我遇到问题的功能。

这是结构的代码：

```
// name: command
// desc: holds one command (meaning that it can be
//        more than one token in that command)
//        "ls -la" will be an example of one command
//       holds num of tokens in command array
struct command
{
    char ** args;
    int num_args;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:44:06.237

我建议一个新的策略，R2：

```
function do(commands)
    if commands is of size 1
        exec commands[0] || die
    split commands into c1 (first command) c2 (the rest of them)
    open
    if fork 
        close input end of pipe
        dup output of pipe to stdin
        do (c2) || die
    close output end of pipe
    dup input of pipe to stdout
    exec c1 || die 
```

使用递归函数，尤其是在维护列表时，将帮助您简化逻辑。您不必担心这里的堆栈深度，因为您的整个地址空间无论如何都会被覆盖。

在其他新闻中，来自[手册页](http://linux.die.net/man/2/dup2)：

> 从这些系统调用之一成功返回后，新旧文件描述符可以互换使用。它们引用相同的打开文件描述（参见 open(2)），因此共享文件偏移量和文件状态标志；例如，如果在其中一个描述符上使用 lseek(2) 修改了文件偏移量，则另一个描述符的偏移量也会改变。

当您说要关闭管道的两端时，这意味着什么？你真的要关闭它——它和你的程序打算使用的标准输入/输出。

--> 稍后编辑 <--

正如 Jonathan Leffler 指出的那样，上述信息是正确的。我已经通过以下程序确认了这一点：

```
#include <unistd.h>

int main(){
    dup2(0, 7);
    write(7, "Hey, 1\n", 7);
    close(0);
    write(7, "Hey, 2\n", 7);
    close(7);
    write(7, "Hey, 3\n", 7);
} 
```

这导致以下输出：

```
$ gcc dup2Test.c && ./a.out
Hey, 1
Hey, 2 
```

谢谢，乔纳森！

# iphone - 阻止 UIScrollView 的子视图调整大小？

> ID：12981201
> 
> 赞同：3
> 
> 时间：2012-10-19T19:31:53.607
> 
> 标签：iphone, ios, cocoa, uiscrollview

我有一个`UIScrollView`, 返回的视图的几个级别的子视图`viewForZoomingInScrollView`。在缩放期间，我希望其中一些子视图调整大小，而其他子视图不调整大小。无论我尝试什么，所有子视图都会调整大小。在我不想调整大小的子视图的超级视图上，我设置了 autoResizesSubviews = NO，并且还尝试了`contentMode = UIViewContentModeCenter`. 我还尝试将`autoresizingMask`所有涉及的视图设置为`UIViewAutoresizingNone`. 有什么想法吗？我无法重构子视图的层次结构。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-19T19:47:42.883

UIScrollView 的缩放视图的子视图通过更改它们的变换而不是通过更改它们的边界等来“调整大小”。解决问题的一个简单方法是捕捉缩放视图上设置的变换，将其反转，并将其应用于子视图，取消滚动视图应用的缩放变换。

在返回的视图中`viewForZoomingInScrollView`，覆盖 -setTransform:，并遍历所有有问题的子视图并应用逆变换：

```
- (void)setTransform:(CGAffineTransform)transform 
{
    [super setTransform:transform];

    CGAffineTransform invertedTransform = CGAffineTransformInvert(transform);
    for (UIView *view in subviewsNotToBeResized) 
    {
        [view setTransform:invertedTransform];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-05T07:37:59.213

Swift 4.2 版本的 Andrew Madsen 的出色回答：

```
/* maintains subview size during zoom */
class NonResizingView: UIView {
    override var transform: CGAffineTransform {
        get {return super.transform}
        set {
            super.transform = newValue
            for v in subviews {
                v.transform = self.transform.inverted()
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:53:36.567

`UIScrollView`缩放是通过变换完成的，它将忽略您的内容模式和自动调整大小的蒙版。一种可能的解决方案是将您不想调整大小的内容放入滚动视图的同级视图而不是子视图中。另一种方法是尝试使用`UIView`动画实时反转变换（参见 Andrew Madsen 的回答）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-27T15:16:33.630

这避免了子类化`UIView`，并且似乎也可以正常工作。`containerView`是返回的视图`viewForZoomingInScrollView`：

```
func scrollViewDidZoom(_ scrollView: UIScrollView) {
    containerView.subviews.forEach({
        if <test if this subview should be immune from resizing> {
            $0.transform = containerView.transform.inverted()
        }
    })
} 
```

# algorithm - 无法制作/配置困难功能

> ID：12981210
> 
> 赞同：-2
> 
> 时间：2012-10-19T19:32:54.207
> 
> 标签：algorithm, delphi, delphi-7, sudoku

![数独 ex1](../Images/60110589e7f97f817703ac7a6f0f957e.png)

在解决数独问题时，我可以从单元格 D[1,2] 和 D[2,2] 中删除可能的数字 (1) 和 (2)。因为 (8) 和 (9) 仅在那些单元格中是可能的，所以这些单元格是 (8 和 9) 或 (9 和 8)。这意味着数字 (1) 和 (2) 位于 D 块的第 3 行。这就是为什么我可以从单元格 A[3,3] 中消除数字 (1) 的可能性。

在过去的 40 小时内，我一直在配置一个功能来执行此操作，但无法管理。有没有人可以制作功能来检测这种类型的智力问题（消除一些可能性，因为其他一些 n 计数的可能性只能存在于 n 个单元格中，在我们的例子中，2 个数字 8 和 9 可以存在于 2 个单元格 D [ 1,2] 和 D[2,2])。

请不要告诉我数独的其他功能；我已经完成了它们，我无法编程的唯一算法就是这个。顺便说一句，您可以使用 r[i] （包含行号 i 的可能性的字符串）， c[i] 用于列，b[i] 用于块（例如： b[4] （在此图像块 A ) = 1,2,3,4,5,6,7 因为已经定义了 8 和 9)。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T21:25:10.347

我真的没有看到问题，你基本上已经回答了你的问题。一般来说，您应该执行以下操作：

第 1 步：遍历一个块的所有 9 个单元格，并检查 (1) 是否仅包含在两个单元格中。

第 2 步：如果没有，请尝试下一个号码。如果是，则遍历所有 9 个单元格并检查 (2) 是否也在这两个单元格中，但不在其余 7 个单元格中。

第 3 步：如果没有，请检查下一个数字。如果是，请删除两个单元格的其他可能性，除了您找到的两个数字，您基本上就完成了。

第 4 步：如果找不到 (1) 匹配的数字（或在第 2 步的“非”部分选择的任何更大的数字），请从第 1 步重新开始，但尝试下一个数字，除非您已经是 8 ，然后你就可以停下来了。

最后，您可以为 3 个单元格中的 3 个数字、4 个数字动态扩展相同的模式......

# java - 无法让 Android WebView 的 postUrl 与端口一起使用

> ID：12981214
> 
> 赞同：0
> 
> 时间：2012-10-19T19:33:06.053
> 
> 标签：java, android, webview, android-webview

在我添加端口之前，我的 WebView 运行良好。此时我看不到任何类型的错误，并且在我的 HTTP 流量中什么也看不到。

```
private Context vContext;
private String vPackageName;
private String vPlacementID;

static private double TRACK_VERSION = 1.0;
static private String TRACK_HOST = "foobar.com:8007";
static private String TRACK_HANDLER = "/event";

public void reportAppOpen(Context context, String placementID) {
    Log.d("FOO", "Tracking");
    if (context == null) {
        return;
    }
    vContext = context;
    vPackageName = vContext.getPackageName();
    vPlacementID = placementID;

    WebView webview = new WebView(context);
    webview.setVisibility(WebView.GONE);
    webview.setWebViewClient(new WebViewClient() {
        @Override
        public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
                Log.d("FOO", "error code:" + errorCode);
                super.onReceivedError(view, errorCode, description, failingUrl);
        }
     });
    webview.getSettings().setJavaScriptEnabled(true);

    List<NameValuePair> params = trackingParams();
    String paramString = URLEncodedUtils.format(params, "utf-8");
    String url = "http://" + TRACK_HOST + TRACK_HANDLER;
    webview.postUrl(url, EncodingUtils.getBytes(paramString, "base64"));

    Log.d("FOO", "Loading URL");        
} 
```

我知道我的代码中还有其他一些奇怪的东西，但现在我只想专注于`postUrl`开始工作。

编辑：在 logcat 我发现这不确定它是否相关。

```
10-19 13:44:21.560: D/SntpClient(59): request time failed: java.net.SocketException: Address family not supported by protocol 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:37:48.297

请尝试使用 WebChromeClient 并覆盖以下方法：

```
 @Override
public void onConsoleMessage(String message, int lineNumber, String sourceID) {
    // TODO Auto-generated method stub
    Log.v("ChromeClient", "invoked: onConsoleMessage() - " + sourceID + ":"
            + lineNumber + " - " + message);
    super.onConsoleMessage(message, lineNumber, sourceID);
}

@Override
public boolean onConsoleMessage(ConsoleMessage cm) {
    Log.v("ChromeClient", cm.message() + " -- From line "
            + cm.lineNumber() + " of "
            + cm.sourceId() );
    return true;
} 
```

调试问题..

# security - 如何通过 Capistrano 限制用户仅访问部署？（部署工作流程问题）

> ID：12981217
> 
> 赞同：1
> 
> 时间：2012-10-19T19:33:25.920
> 
> 标签：security, deployment, ssh, capistrano

我寻找使用 capistrano 进行部署的良好实践。

我想先简要描述一下我过去是如何进行部署的。

capistrano 本地安装在开发人员的计算机上。我使用 capistrano 选项部署思想网关`:gateway`。首先，我认为使用`:gateway`选项我只需要与网关主机建立 ssh 连接，但事实证明我需要与我想要部署到的所有主机的ssh 连接（*公钥）。*

我想找到一种方便且安全的方式来部署应用程序。

例如，当新开发人员开始工作时，将他的 *public_key* 仅放在网关服务器上而不是放在所有应用程序服务器上会更方便。另一方面，我不希望他与服务器有任何连接，特别是*ssh*到网关，仅仅因为他是开发人员，他只需要进行部署。

如果您知道使用 capistrano 进行部署的良好做法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:38:07.627

为网关机器和其他服务器机器上的每个开发人员创建特殊用户帐户。您必须使用您的操作系统和 ssh 为您提供的功能来完成这项工作。使开发人员帐户无法通过 shell 登录到网关等。

我无法为您提供所有详细信息，但我想我可能已经为您指明了正确的方向。[您可以在服务器故障](http://serverfault.com)上询问有关如何允许用户登录并仅在服务器上执行某些任务的详细信息。

题外话/意见：最好让您信任的开发人员进行部署。如果您不信任开发人员，最好不要让他做重要的事情，例如部署到生产服务器。

# c# - 如何判断数据库中的记录是否被两个任务修改

> ID：12981223
> 
> 赞同：2
> 
> 时间：2012-10-19T19:33:39.247
> 
> 标签：c#, sql, sql-server-2000, .net-1.1

不确定这是否属于`SO`他们的其他网站之一，如果我应该移动它，请告诉我。

**这是我正在使用的：**
它是一个非常古老的电子商务系统，它有一个产品表。此产品表每晚通过 Windows 任务计划程序更新两个文件。一个文件包含产品信息（名称、描述、颜色、制造商等），另一个文件包含价格、可用库存、仓库位置等信息。解析这些文件和更新数据库中的产品的过程需要几个小时。我无法控制这两个文件。

我需要一种方法来确定这两个文件是否都更新了数据库中的产品。我只能向具有来自这两个文件的信息的用户显示产品。如果产品仅更新了一个，则认为其不完整，无法显示。

截至目前，我正在考虑添加一个触发器以添加/更新到 count+1 并在每次两个任务中的任何一个修改记录/产品时保存到一个新列。然后进行另一项任务以检查该列是否等于 2 并执行显示或隐藏所需的操作。但我希望那里可能有一些其他的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:41:06.860

使用带有每个文件的最后更新时间戳的两列。仅显示在过去 X (24?) 小时内具有两个时间戳的记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:46:30.403

这个怎么样，有另一列位类型（布尔）。我们称之为“IsValid”。对于一个*干净*的记录（您知道由两者更新的记录），该值将`true`. 每当发生更新时，您都会*翻转*该位（应用`NOT`运算符），您可以通过触发器轻松完成。因此，当有两个更新（每个文件一个）时，净值`true`再次变为。读取该记录的应用程序部分将查看“IsValid”标志以确定该记录是否可行。

**注意** 这仅在每个文件仅在每次更新中更新记录零次或一次时才有效。因为如果文件 1 两次更新同一记录而文件 2 什么都不做，那么该标志会错误地将记录报告为有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T22:05:12.073

为了不必担心遗留流程的完整回归测试，我会选择使用触发器将 Product 表上的更新记录到第二个表。

触发器可以通过检查更新的列来确定正在运行的进程。然后我会创建一个简单的查询来返回所有已被两个进程更新的产品。

```
/* Test tables */
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Product')
  DROP TABLE Product

IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'ProductChangeLog')
  DROP TABLE ProductChangeLog
GO

CREATE TABLE Product (
  ProductID INT NOT NULL PRIMARY KEY, 
  ProductName VARCHAR(50) NOT NULL,
  ProductDescription VARCHAR(100) NOT NULL,
  ProductPrice MONEY NOT NULL,
  ProductAvailQty INT NOT NULL
) 

CREATE TABLE ProductChangeLog (
  ChangeLogID INT NOT NULL IDENTITY(1,1), 
  ProductID INT NOT NULL,
  ChangeTime DATETIME NOT NULL,
  ChangeType VARCHAR(50) NOT NULL,
) 
GO 

CREATE TRIGGER tr_Product ON Product 
FOR UPDATE
AS

  INSERT ProductChangeLog (ProductID, ChangeTime, ChangeType) 
  SELECT 
    ProductID,
    GETDATE(),
    -- Log the process which was run depending on columns modified
    CASE WHEN UPDATE(ProductName) OR UPDATE(ProductDescription)
         THEN 'Process1'
         WHEN UPDATE(ProductPrice) OR UPDATE(ProductAvailQty)
         THEN 'Process2'
         ELSE 'Neither'
    END 
  FROM inserted
GO 

INSERT Product 
SELECT 1, 'Blue V-Neck', 'Sweater', 25.00, 100 UNION ALL 
SELECT 2, 'Green V-Neck', 'Sweater', 30.00, 200 UNION ALL
SELECT 3, 'Black crew', 'T-Shirt', 10.00, 45

/* Change two products in first process */
UPDATE Product 
SET ProductDescription = 'Men''s Sweater' 
WHERE ProductDescription = 'Sweater'

/* Change three products in second process */
UPDATE Product
SET ProductPrice = ProductPrice + 10

/* See all changes */
SELECT * 
FROM ProductChangeLog 

DECLARE @today DATETIME
SET @today = DATEADD(DAY, 0, DATEDIFF(DAY, 0, GETDATE())) 

/* See all products changed today by both processes */
SELECT * 
FROM Product p 
WHERE EXISTS (
  SELECT * 
  FROM ProductChangeLog 
  WHERE ChangeType = 'Process1'
    AND ChangeTime > @today 
    AND ProductID = p.ProductID 
) 
AND EXISTS ( 
  SELECT * 
  FROM ProductChangeLog 
  WHERE ChangeType = 'Process2'
    AND ChangeTime > @today 
    AND ProductID = p.ProductID 
) 
```

*在 SQL Server 2005 中测试

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:44:32.663

假设您有一个表，它有一个名为 Id_Record 的主键。

如果您只想显示（或不显示）此表的最新更新：使用 Id_Record、Dt_Timestamp_File1、Dt_Timestamp_File2 创建一个单独的表，并为每个文件更新触发一个时间戳。然后定义 2 个时间戳（或您想要的任何其他规则）之间的可接受差异。

那么您可以通过以下方式检索您的记录：

```
SELECT Id_Record, Ds_Record_Name, Nr_Record_Price, Nr_Record_In_Stock FROM Stock WHERE Id_Record IN (SELECT Id_Record FROM Stock_Update WHERE Dt_Timestamp_File1 > Dt_Timestamp_File2 - 3600000 AND Dt_Timestamp_File1 < Dt_Timestamp_File2 + 3600000) 
```

假设您使用的是 UnixTime（总是更容易比较 unixtime 中的时间 [从 70 年 1 月 1 日开始的毫秒数]），并且您的最大时差是一小时。

# jquery - 除非它已经存在，否则如何使用 jQuery 附加元素？

> ID：12981228
> 
> 赞同：3
> 
> 时间：2012-10-19T19:34:03.747
> 
> 标签：jquery

`span`如果选择框中没有设置选项，我有这个 jQuery 函数，它会在标签上附加一个标记为“可选”的标签。

```
function setLabel() {
    var label=$('label[for=person_address]');
    if ($('select#person_organisation_id').val().length != 0) {
      label.append(' <span>— optional</span>');     
    } else {
  label.children().remove();            
  } 
} 
```

现在，每次我选择一个新选项时，这都会为标签添加一个新的跨度。如何检查跨度是否已经存在，如果没有跨度，则仅添加跨度？

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T19:36:04.437

尝试以下操作：

```
label.not(":has(span)").append(" <span>— optional</span>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:38:19.430

如果标签中有多个跨度，请使用以下代码

```
function setLabel() {
    var label=$('label[for=person_address]');
    if ($('select#person_organisation_id').val().length != 0) {
        if(label.find(".optional").length == 0){
               label.append(' <span class="optional">— optional</span>'); 
        }    
    } else {
  label.children().remove();            
  } 
} 
```

# database - 为什么在数据库复制中从机读取速度比主机快

> ID：12981230
> 
> 赞同：6
> 
> 时间：2012-10-19T19:34:11.060
> 
> 标签：database, replication, database-replication

在主/从数据库复制中，所有写入都转到主机。所有读取都转到从机。主机将数据复制到从机。当 master 复制数据到 slave 时，slave 机器必须进行写入，这将锁定该行。从从机读取速度更快，但为什么呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T19:27:40.633

从站*应该*快*很多*，因为：

*   它所做的数据写入量与master相同
*   对从属设备的写入绕过所有语法和权限检查（所有这些工作 - 而且很多 - 由主设备在处理查询时完成 - 只有数据*更改*被发送到从属设备）
*   除了您作为测试执行的内容之外，它没有其他读取
*   复制是为尽可能快的同步速度而设计的优化过程，因此如果主服务器出现故障，从服务器尽可能保持最新。这意味着通过设计它必须在从站上造成尽可能少的工作

这一切都意味着从站的负载*远*低于主站。

实际上，将读取重定向到从属设备是一种已知的性能修改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T21:56:15.453

师傅很忙

*   它并行写入数据（这很明显）
*   它会导致磁盘 I/O 写入二进制日志，将已完成 SQL 的集合序列化到其二进制日志中
*   它通过将完成的 SQL 从其二进制日志传递到从站的 I/O 线程（通过`SHOW PROCESSLIST;`用户名在主站上可见`system user`）来管理复制。连接到主站的从站越多，这可能会稍微减慢速度。

奴隶不那么忙，因为它......

*   为 MySQL 复制序列化 I/O
    *   通过 IO 线程从 Master 收集 SQL
    *   将 IO 线程中的 SQL 记录到其最新的中继日志中
    *   SQL 线程从中继日志中读取下一个可用的 SQL
*   通过 SQL 线程一次处理一个 SQL 命令/一个事务
*   如果[**Slave 拥有所有 MyISAM 并且 Master 拥有所有 InnoDB**](https://dba.stackexchange.com/a/22425/877)，则在 Slave 上写入具有外键约束的表将不必执行任何引用完整性检查。从站上不必发生[**MVCC**](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)。

将奴隶和主人置于同一公平竞争环境的唯一例外是

*   如果从站启用了二进制日志记录。如果从站只是从站，则不需要，但如果从站也是主站，则需要
*   如果多个 SQL 语句作为单个 InnoDB 事务处理。
*   如果硬件不同
    *   Master 拥有更快的磁盘、更多的内核、更多的 RAM
    *   从站是一个商品服务器

# ruby-on-rails-3 - 在 Rails 中使用 RMagick 显示缩略图

> ID：12981232
> 
> 赞同：0
> 
> 时间：2012-10-19T19:34:15.207
> 
> 标签：ruby-on-rails-3, rmagick

我刚刚安装了 RMagick，并试图在我的网页上显示我扔给它的任何图像的缩略图。但是教程中的代码会打开一个新窗口以显示我的图像。这就是我所拥有的。

```
require 'RMagick'

class StaticPagesController < ApplicationController
  include Magick

  def home
    @cat = ImageList.new("app/assets/images/me.jpg")
  end
end 
```

和观点：

```
<%= @cat.display %> 
```

我希望图像显示在页面上，而不是弹出一个显示图像的新窗口，并显示在页面上：

`#<Magick::ImageList:0x007f564804bb18>`

**更新**

我需要在显示之前调整图像大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:10:48.593

从[display](http://www.imagemagick.org/RMagick/doc/ilist.html#display)的文档中：

> 将图像列表中的图像显示到任何 X Window 屏幕。默认情况下显示到本地屏幕。您可以通过将名称分配给可选参数块中的 server_name 属性来指定不同的屏幕。

这不是在 HTML 页面中使用的正确方法。如果您已经保存了图像，则无需将其重新加载到`ImageList`. 您可以在视图中显示它：

```
<%= image_tag "me.jpg" %> 
```

应该做的伎俩。

# hadoop - 当文件格式为自定义格式时，Hadoop MultipleOutputs 不会写入多个文件

> ID：12981233
> 
> 赞同：2
> 
> 时间：2012-10-19T19:34:18.497
> 
> 标签：hadoop, mapreduce

我正在尝试使用 MultipleOutputs api（Hadoop 版本 1.0.3）从 cassandra 读取并将减速器输出写入多个输出文件。在我的例子中，文件格式是扩展 FileOutputFormat 的自定义输出格式。[我以与MultipleOutputs api](http://hadoop.apache.org/docs/r1.0.3/api/index.html)中所示类似的方式配置了我的工作。但是，当我运行该作业时，我只得到一个名为 part-r-0000 的输出文件，它是文本输出格式。如果`job.setOutputFormatClass()`未设置，默认情况下它认为 TextOutputFormat 是格式。此外，它只允许初始化两个格式类之一。它完全忽略了我在`MulitpleOutputs.addNamedOutput(job, "format1", MyCustomFileFormat1.class, Text.class, Text.class) and MulitpleOutputs.addNamedOutput(job, "format2", MyCustomFileFormat2.class, Text.class, Text.class)`. 是其他人面临类似的问题还是我做错了什么？

我还尝试编写一个非常简单的 MR 程序，它从文本文件中读取并以 2 种格式 TextOutputFormat 和 SequenceFileOutputFormat 写入输出，如 MultipleOutputs api 所示。但是，那里也没有运气。我只得到 1 个文本输出格式的输出文件。

有人可以帮我弄这个吗 ？

```
Job job = new Job(getConf(), "cfdefGen");
job.setJarByClass(CfdefGeneration.class);

//read input from cassandra column family
ConfigHelper.setInputColumnFamily(job.getConfiguration(), KEYSPACE, COLUMN_FAMILY);
job.setInputFormatClass(ColumnFamilyInputFormat.class);
job.getConfiguration().set("cassandra.consistencylevel.read", "QUORUM");

//thrift input job configurations
ConfigHelper.setInputRpcPort(job.getConfiguration(), "9160");
ConfigHelper.setInputInitialAddress(job.getConfiguration(), HOST);
ConfigHelper.setInputPartitioner(job.getConfiguration(), "RandomPartitioner");

SlicePredicate predicate = new SlicePredicate().setColumn_names(Arrays.asList(ByteBufferUtil.bytes("classification")));
//ConfigHelper.setRangeBatchSize(job.getConfiguration(), 2048);
ConfigHelper.setInputSlicePredicate(job.getConfiguration(), predicate);

//specification for mapper
job.setMapperClass(MyMapper.class);
job.setMapOutputKeyClass(Text.class);
job.setMapOutputValueClass(Text.class);

//specifications for reducer (writing to files)
job.setReducerClass(ReducerToFileSystem.class);
job.setOutputKeyClass(Text.class);
job.setOutputValueClass(Text.class);
//job.setOutputFormatClass(MyCdbWriter1.class);
job.setNumReduceTasks(1);

//set output path for storing output files
Path filePath = new Path(OUTPUT_DIR);
FileSystem hdfs = FileSystem.get(getConf());
if(hdfs.exists(filePath)){
    hdfs.delete(filePath, true);
}
MyCdbWriter1.setOutputPath(job, new Path(OUTPUT_DIR));

MultipleOutputs.addNamedOutput(job, "cdb1', MyCdbWriter1.class, Text.class, Text.class);
MultipleOutputs.addNamedOutput(job, "cdb2", MyCdbWriter2.class, Text.class, Text.class);

boolean success = job.waitForCompletion(true);
return success ? 0:1;

public static class ReducerToFileSystem extends Reducer<Text, Text, Text, Text>
{
    private MultipleOutputs<Text, Text> mos;

    public void setup(Context context){
        mos = new MultipleOutputs<Text, Text>(context);
    }

    //public void reduce(Text key, Text value, Context context) 
    //throws IOException, InterruptedException (This was the mistake, changed the signature and it worked fine)
    public void reduce(Text key, Iterable<Text> values, Context context)
    throws IOException, InterruptedException
    {
        //context.write(key, value);
        mos.write("cdb1", key, value, OUTPUT_DIR+"/"+"cdb1");
        mos.write("cdb2", key, value, OUTPUT_DIR+"/"+"cdb2");
        context.progress();
    }

    public void cleanup(Context context) throws IOException, InterruptedException {
        mos.close();
    }
}

public class MyCdbWriter1<K, V> extends FileOutputFormat<K, V> 
{
    @Override
    public RecordWriter<K, V> getRecordWriter(TaskAttemptContext job) throws IOException, InterruptedException 
    {
    }

    public static void setOutputPath(Job job, Path outputDir) {
        job.getConfiguration().set("mapred.output.dir", outputDir.toString());
    }

    protected static class CdbDataRecord<K, V> extends RecordWriter<K, V>
    {
        @override
        write()
        close()
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T21:43:23.580

调试后我发现我的reduce方法从未被调用过。我发现我的函数定义与 API 的定义不匹配，将其`public void reduce(Text key, Text value, Context context)`从`public void reduce(Text key, Iterable<Text> values, Context context)`. 我不知道为什么 reduce 方法没有 @Override 标记，它可以防止我的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-21T09:31:05.047

我也遇到了一个类似的问题 - 我的结果是我在 Map 过程中过滤了我的所有记录，所以没有任何东西被传递给 Reduce。在 reduce 任务中使用未命名的多个输出，这仍然会导致一个`_SUCCESS`文件和一个空`part-r-00000`文件。

# eclipse - 如何从 Eclipse / Flash Builder 中的命令行运行 build Release

> ID：12981234
> 
> 赞同：2
> 
> 时间：2012-10-19T19:34:19.560
> 
> 标签：eclipse, flash-builder

有没有办法从 Flash Builder (Eclipse) 中的命令行运行导出发布版本？

**更多上下文**
Flash Builder 具有调试、运行和构建发布命令或配置（不确定它们的名称）。我想将 Flash Builder 放在服务器上并从命令行调用构建发布配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:45:00.180

服务器上不需要 Flash Builder。您可以使用安装在服务器上的 Flex SDK、Java 和 Apache ANT 来完成。如果它是 Windows 服务器，您可以将其设置为像这样运行：

创建一个 ANT 脚本以从存储库进行更新，然后构建 Flash 应用程序。

创建一个 .bat 文件以运行 ANT 构建（实际上只是文件夹中的一个文本文件 'build.bat'，其中 build.xml 只是说 'ant'）。

设置一个计划任务以在您希望的任何时间间隔运行 build.bat，或者，如果您在同一台服务器上拥有 SVN，您可以设置一个提交后挂钩来运行该计划任务，这样当一个人提交到 repo 时，构建脚本将运行并且可以在开发服务器上查看新版本。

我有一个 ANT 脚本，如果构建无法让每个人都知道是谁破坏了构建，它也会向所有开发人员发送电子邮件，这样他们就可以处理它。如果您给我回消息，我很乐意为您发布一个带有我的 ANT 脚本文件的 zip，您可以使用示例。

编辑：我已将文件发布到 GitHub 以防其他人需要它们。[https://github.com/royaldigit/ant-flash-build](https://github.com/royaldigit/ant-flash-build)

# jquery - .load 容器的高度被内容管理忽略

> ID：12981239
> 
> 赞同：0
> 
> 时间：2012-10-19T19:34:36.523
> 
> 标签：jquery, content-management-system, load, teamsite

我正在使用 jquery .load 将内容加载到 div 中。发生的情况是页面的其余部分如何忽略内容的高度。我正在加载它

```
jQuery(document).ready(function ($) {
$('#loader_container').load('brigham_overview.aspx');
}); 
```

这是页面[http://www.brighamandwomens.org/Patients_Visitors/pcs/rehabilitationservices/mock/overview.aspx](http://www.brighamandwomens.org/Patients_Visitors/pcs/rehabilitationservices/mock/overview.aspx)

您可以看到它是如何溢出底部的，而电子邮件链接则位于“看一看”磁贴的顶部，它应该位于最底部。

我想知道是否有办法让 .load 发生，然后在加载后以某种方式使用脚本为“loader_container”分配加载内容中包装器 div 的高度？

那或者有没有办法在加载正文的其余部分之前以某种方式运行脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:51:57.363

这看起来是您的 CSS 而不是您的 .load() 函数的问题。我注意到里面的所有容器`#totalContainer`都是绝对定位的。这就是为什么它没有正确计算高度的原因。

如果可能，其他一些建议是将您的图像设置为背景图像。看起来你只是在绝对定位所有东西并将它们放在彼此之上。这似乎并不理想或语义......

以这部分为例...

```
<div id="news_backing" class="blue" style="width: 314px; height: 165px; position: absolute; z-index: 2; background-color: rgb(239, 245, 248); background-position: initial initial; background-repeat: initial initial; ">
</div>
<img id="news_icon" src="http://www.klossal.com/brigham/what_we're_upto_icon.png" style="width: 118px; height: 46px; top: 55px; left: 30px; position: absolute; z-index: 3; ">
<p id="news_header_txt" class="news_txt" style="width: 110px; top: 55px; left: 180px; position: absolute; z-index: 3; font-size: 20px; color: rgb(14, 134, 161); font-family: Arial, light, sans-serif; "> 
What We're Up To
</p> 
```

您可以将图像设置为背景图像，并且`<p></p>`标签应位于 div 内。不是绝对位于它的顶部。

我真的不知道这会有多大帮助，但在我看来，这不是您的`.load()`要求造成的。它是您的 CSS 和 HTML 结构。

...

如果可以避免的话，最后一个友好的建议是不要使用内联样式。从长远来看，这将使事情变得容易得多。

# c++ - c++0x 原子和线程的 GCC 标志

> ID：12981240
> 
> 赞同：-1
> 
> 时间：2012-10-19T19:34:39.517
> 
> 标签：c++, c++11, pthreads, atomic-swap

我试图编译这个 C++ 原子和线程的基本示例，尽管当我编译 main.cpp 文件时 gcc 抛出了一些 std lib 错误——这似乎与我的代码无关。

主文件

```
#include <thread>
#include <atomic>
#include <stdio.h>
#include "randomdelay.h"

using namespace std;

atomic<int> flag;
int sharedValue = 0;

RandomDelay randomDelay1(1, 60101);
RandomDelay randomDelay2(2, 65535);

void IncrementSharedValue10000000Times(RandomDelay& randomDelay)
{
    int count = 0;
    while (count < 10000000)
    {
        randomDelay.doBusyWork();
        int expected = 0;
        if (flag.compare_exchange_strong(expected, 1, memory_order_relaxed))
        {
            // Lock was successful
            sharedValue++;
            flag.store(0, memory_order_relaxed);
            count++;
        }
    }
}

void Thread2Func()
{
    IncrementSharedValue10000000Times(randomDelay2);
}

int main(int argc, char* argv[])
{
    printf("is_lock_free: %s\n", flag.is_lock_free() ? "true" : "false");

    for (;;) {
        sharedValue = 0;
        thread thread2(Thread2Func);
        IncrementSharedValue10000000Times(randomDelay1);
        thread2.join();
        printf("sharedValue=%d\n", sharedValue);
    }

    return 0;
} 
```

我正在使用的完整代码：[https ://github.com/preshing/AcquireRelease](https://github.com/preshing/AcquireRelease)

这是 gcc 错误消息：

```
[lewis@localhost preshing-AcquireRelease-1422872]$ g++ -std=c++0x -pthread main.cpp
/tmp/cc95LElq.o: In function `IncrementSharedValue10000000Times(RandomDelay&)':
main.cpp:(.text+0xdd): undefined reference to `RandomDelay::doBusyWork()'
/tmp/cc95LElq.o: In function `__static_initialization_and_destruction_0(int, int)':
main.cpp:(.text+0x23d): undefined reference to `RandomDelay::RandomDelay(int, int)'
main.cpp:(.text+0x251): undefined reference to `RandomDelay::RandomDelay(int, int)'
collect2: error: ld returned 1 exit status 
```

这是我使用的命令：`g++ -std=c++0x -pthread main.cpp`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:43:21.587

该类`RandomDelay`似乎在`randomdelay.cpp`. 您必须编译此文件并将其与`main.cpp`. 例如：

```
$ g++ -std=c++0x -pthread -o program_name main.cpp randomdelay.cpp 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:43:31.273

您需要添加包含您的定义的 cpp 文件`RandomDelay`.. 即类似`g++ -std=c++0x -pthread main.cpp randomdelay.cpp`

# python - 分析 Python Web 应用程序

> ID：12981241
> 
> 赞同：3
> 
> 时间：2012-10-19T19:34:53.013
> 
> 标签：python, profiling, pyramid

我在 python 中使用 Pyramid 编写了一个 Web 应用程序，但我正在努力寻找合适的分析器。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:26:45.077

如果您使用的是金字塔 1.2a1 或更好的版本，您可以尝试使用[pyramid_debugtoolbar](https://github.com/Pylons/pyramid_debugtoolbar)。[边裁](http://pypi.python.org/pypi/linesman)似乎也是一个不错的选择。

# actionscript-3 - 如何使用 Adob e Flash CS6 运行涉及 away3d 的代码？

> ID：12981242
> 
> 赞同：1
> 
> 时间：2012-10-19T19:34:53.703
> 
> 标签：actionscript-3, flash, 3d, away3d, flash-cs6

我最近下载了 Flash CS6 并想用它设置一个 3d 引擎。

我下载了 Away3d，但现在我无法设置它，因为我是新手。

这是我要运行的代码 - 取自该网站 - [http://www.adobe.com/devnet/flashplayer/articles/creating-games-away3d.html](http://www.adobe.com/devnet/flashplayer/articles/creating-games-away3d.html)

```
_view = new View3D();
_view.backgroundColor = 0x666666; 
_view.antiAlias = 4; 
this.addChild(_view); 
this.addEventListener(Event.ENTER_FRAME, onEnterFrame); 
```

我在 Adob​​e Flash CS6 中添加了 away3d src 文件夹。但是当我运行这段代码时，我看到一个空白屏幕。

我想我忘记了如何导入它，或者可能将它放在一个类或其他东西中。有人可以解释这个程序吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T11:11:32.607

好的：

下载 away3d gold 或 alpha：设置一个如下图所示的文件夹。

![在此处输入图像描述](../Images/9d7c7065a0f0c822b74ddd19fc76b4fe.png) 打开并转到 bin 文件夹，您将找到“away3d.swc”文件，将此文件复制到文件夹 SWC_libs。

使您的所有文件看起来与图片相同，这更容易。创建一个名为“My_PROJECT”的项目。现在进入高级动作脚本设置：![在此处输入图像描述](../Images/4240c81861895c3947a880ac1a7205c8.png)

在库路径中单击添加按钮或浏览选项现在选择您之前放置该 swc 文件的路径...//My_3d_Projects/SWC_libs/away3d.swc：

# actionscript-3 - AS3 / Flex 中的数据绑定性能

> ID：12981244
> 
> 赞同：0
> 
> 时间：2012-10-19T19:34:56.247
> 
> 标签：actionscript-3, apache-flex, data-binding

不同的装订方式有哪些不同的性能水平？

*   `ChangeWatcher.watch`
*   `addEventListener`
*   `BindingUtils.bindProperty`
*   `MXML {}`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:51:56.367

Flex 的数据绑定非常繁重，因为它使用魔术字符串事件系统，除了它添加的其他性能废话之外，它还添加了许多额外的代码。如果您要手动寻找性能绑定。不过，这是关于您的确切问题的非常深入的报告：[http ://www.slideshare.net/michael.labriola/diving-in-the-flex-data-binding-waters-presentation](http://www.slideshare.net/michael.labriola/diving-in-the-flex-data-binding-waters-presentation)

# c++ - 在 mmap 内存中有效分配动态数组

> ID：12981246
> 
> 赞同：3
> 
> 时间：2012-10-19T19:35:03.713
> 
> 标签：c++, memory-management, malloc

我有一个非常大（在运行时固定，大约 10 - 3000 万）的数组。每个数组包含 0 到 128 个元素，每个元素为 6 个字节。

我需要将所有数组存储在 mmap 内存中（所以我不能使用 malloc），并且数组需要能够动态增长（最多 128 个元素，并且数组永远不会缩小）。

我实现了一种简单的方法，即使用一个 int 数组来表示 mmap 内存中每个 6 字节块的状态。偏移量处的 0xffffffff 值表示 mmap 内存中的相应偏移量是空闲的，任何其他值都是数组的 id（在我当前的实现中对块进行碎片整理需要它，没有就不能移动块知道他们的数组的 id 来更新其他数据结构）。在分配时，当数组超出其分配时，它会简单地迭代，直到找到足够的空闲块，并在相应的偏移量处插入。

这就是分配数组和 mmap 内存的样子，有点：

```
| 0xffffffff | 0xfffffff |    1234    |    1234    | 0xffffffff | ...
-----------------------------------------------------------------
|    free    |   free    |array1234[0]|array1234[1]|    free    | ... 
```

这种方法虽然具有`offset of furthest used block in mmap'ed memory x 4`（4 字节 ber int）的内存开销。

对于这种特定情况，有什么更好的方法？

我对此的理想要求是：

*   内存开销（任何分配表 + 未使用空间）<= 每个元素 1.5 位 + 每个数组 4*6 字节
*   O(1) 数组的分配和增长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:54:29.570

[Boost.Interprocess](http://www.boost.org/doc/libs/1_51_0/doc/html/interprocess.html)似乎有一个[托管内存映射文件](http://www.boost.org/doc/libs/1_51_0/doc/html/interprocess/managed_memory_segments.html)的简洁实现，其规定类似于 malloc/free 但用于映射文件（即您有一个适当大的内存映射文件的句柄，您可以要求库子- 为某些东西（例如数组）分配文件的未使用部分）。从文档中：

> Boost.Interprocess 提供了一些基本类来创建共享内存对象和文件映射，并将这些可映射类映射到进程的地址空间。
> 
> 然而，管理这些内存段对于非平凡的任务来说并不容易。映射区域是固定长度的内存缓冲区，动态创建和销毁任何类型的对象需要大量工作，因为它需要编写内存管理算法来分配该段的部分。很多时候，我们还希望将名称与在共享内存中创建的对象关联起来，以便所有进程都可以使用该名称找到对象。
> 
> Boost.Interprocess 提供 4 个托管内存段类：
> 
> *   管理共享内存映射区域（basic_managed_shared_memory 类）。
> *   管理内存映射文件（basic_managed_mapped_file）。
> *   管理一个堆分配的（operator new）内存缓冲区（basic_managed_heap_memory 类）。
> *   管理用户提供的固定大小缓冲区（basic_managed_external_buffer 类）。
> 
> 托管内存段最重要的服务是：
> 
> *   动态分配部分内存段。
> *   在内存段中构造 C++ 对象。这些对象可以是匿名的，或者我们可以为它们关联一个名称。
> *   搜索命名对象的能力。
> *   许多特性的定制：内存分配算法、索引类型或字符类型。
> *   原子构造和破坏，因此如果段在两个进程之间共享，则不可能创建两个具有相同名称的对象，从而简化了同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T05:17:44.110

你能负担得起多少个映射区域？如果 128 没问题，那么我会创建 128 个区域，这些区域对应于您的数组的所有可能大小。理想情况下，每个区域都有一个免费条目的链接列表。在这种情况下，您将获得每个区域的固定大小的记录。并且将数组从 N 增长到 N + 1 是将数据从 area[N] 移动到最后的 area[N + 1] 的操作（如果 N + 1 的空条目的链表为空）或在如果没有空槽。对于 area[N]，删除的插槽被添加到其空闲条目列表中

更新：链表可以嵌入到主要结构中。因此不需要额外的分配，每个可能的记录（从大小 1 到 128）中的第一个字段 (int) 可以是下一个空闲条目的索引。对于分配的条目，它总是无效的（0xffffffff），但如果一个条目是空闲的，那么这个索引就成为相应链接链的成员。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-20T23:20:11.837

我设计并最终采用了一种几乎符合我要求的内存分配算法，O(1) 摊销，很少的碎片和很少的开销。随时发表评论，我会在有机会时详细说明。

# android - 如何通过 HttpClient 接收 JSON 对象？

> ID：12981251
> 
> 赞同：0
> 
> 时间：2012-10-19T19:35:21.310
> 
> 标签：android, json, jakarta-ee, request, httpclient

我在 android 中使用 HttpClient 发送 post 请求：

```
 HttpClient client = new DefaultHttpClient();

    HttpPost request = new HttpPost(hostNameCollection);

    StringEntity se = new StringEntity(jsonObj.toString());

    request.setHeader("Accept", "application/json");
    request.setHeader("Content-type", "application/json");

    request.setEntity(se);
    HttpResponse response = client.execute(request);

    Log.v("HttpLogClient.logJSONObject", "wyslano JSON"); 
```

而且我不知道如何在我的 Java EE servlet 上接收 JSON 对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:40:32.023

您需要阅读响应正文，然后解析为 JSON，

```
String result = EntityUtils.toString(response.getEntity());
JSONObject jo = new JSONObject(result); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:44:48.223

通过获取主体上的流对象然后读取它来读取 http 帖子（服务器端）的主体。

一旦你读过它，将字节转换为字符，这将是 json，你可以使用它来构建一个 json 对象，比如使用“jackson”库的 jsonNode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:08:51.303

如果您使用的是普通 servlet，则 json 流位于 HttpServletRequest 的主体中：request.getReader() 或 request.getInputStream();

为了使事情更容易，您可以使用为您处理数据绑定的库。看看 Genson [http://code.google.com/p/genson/](http://code.google.com/p/genson/)。

```
YouClass object = new Genson().deserialize(request.getReader(), YourClass.class);
// or to a plain map
Map<String, Object> map = genson.deserialize(request.getReader(), Map.class); 
```

# php - 没有 AJAX 的后台 php 文件处理

> ID：12981256
> 
> 赞同：0
> 
> 时间：2012-10-19T19:35:47.067
> 
> 标签：php, ajax, background-process

**使用文件编译器会对第一次**主页点击造成一些压力，直到编译 css 文件，从而欺骗访问者认为网站速度很慢，

我已经成功地将函数路由到 ajax 女巫工作得很好，但我不能放手，因为它绑定到 js 并且很想用 php 做到这一点

**ajax mootools**

```
new Request({
url: linktofile... and basic responses 
```

什么都不做，只是访问 php 文件，上面写着

```
// sitename.com/?view=custom
file_get_contents('OF_THE_website_but_different_view'); 
```

那么我将如何从 php 尝试执行此操作`exec()`，无法开始工作（WAMP 本地） **CURL**，就像我`file_get_contents()`在主页中做的一样，并再次减慢一切，试图查看如何`proc_open()`工作，但我无法弄清楚

因此，如果有人可以让我使用任何 php 函数作为 ajax 的后备并`file_get_contents()`在后端调用我的文件而不会减慢主页速度。

**请不要建议 SHELL 、 CRON 或任何其他语言，但 PHP**

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T01:50:01.480

基金真棒参考

[PHP 后台进程仍然影响页面加载](https://stackoverflow.com/questions/4071042/php-background-process-still-affecting-page-load)

[http://php.net/features.connection-handling#71172](http://php.net/features.connection-handling#71172)

```
header("Connection: close");
ob_start();
phpinfo();// or my page buffer previously saved in variable
$size=ob_get_length();
header("Content-Length: $size");
ob_end_flush();
flush();
file_get_contents('OF_THE_website_but_different_view'); 
```

像魅力一样工作

# mongodb - 当类的计数返回 0 时，文档如何声称它是持久的？

> ID：12981258
> 
> 赞同：1
> 
> 时间：2012-10-19T19:35:57.980
> 
> 标签：mongodb, mongoid

一个文件怎么能索赔`foo.persisted? == true`，什么时候`foo.class.count == 0`？
更重要的是，我怎样才能让文档真正持久化？

更新：从控制器调用`Mongo::Foo.create()`确实会增加计数。这是意料之中的。从单独的模块/类中调用`create`, or `new`and**不会**增加计数。`save`

 **更新：我尝试更改`new`/`save`调用`create`

更新：我也试过`@foo_class.with(collection: "mongo_foos").create`

```
[42] pry(#<FoosController>)> foo.class
=> Mongo::Foo
[43] pry(#<FoosController>)> foo.persisted?
=> true
[44] pry(#<FoosController>)> Mongo::Foo.count
=> 0
[47] pry(#<FoosController>)> foo.id
=> "5081a1a786ddc8e035000021"
[48] pry(#<FoosController>)> foo
=> #<Mongo::Foo _id: 5081a1a786ddc8e035000021, _type: nil, foo_daddy_id: nil, old_foo_daddy_id: 219, member_id: "F008AR", unix_time: nil, date_time: 2012-10-19 13:50:54 UTC, submitted: nil, json: nil> 
```

以下是文档类的定义方式：

```
module Mongo
  class Foo
    include Mongoid::Document

    field :foo_daddy_id
    field :old_foo_daddy_id, type: Integer
    field :member_id,  type: String
    field :unix_time,  type: Integer
    field :date_time,  type: DateTime
    field :submitted,  type: Integer
    field :json,       type: Hash

    belongs_to :foo_daddy, class_name: "Mongo::FooDaddy"
    embeds_many :foo_dumplings, class_name: "Mongo::FooDumpling"

  end
end 
```

该文档正在创建`foo.new(params); foo.save`：

```
module FooThingy
  module Foo
    class Create < ::FooThingy::Base

      def initialize(options)
        # Sets instance variables used below
      end

      def execute!
        @foo = @foo_class.new({
          date_time: DateTime.strptime(@params["submitted_timestamp"], "%m-%d-%Y %H:%M:%S"),
          member_id: (@params[:member_id].present? ? @params[:member_id] : nil),
          old_foo_daddy_id: @params[:old_foo_daddy_id]
        })

        embed_foo_dumplings

        if @foo.save
          return FooThingy::Result.new(success: true, data: { foo: @foo })
        else
          return FooThingy::Result.new(success: false, data: { foo: @foo })
        end
      end

      private
      def embed_foo_dumplings
        # Embeds foo_dumplings
      end

    end
  end
end 
```

这是我调用该模块来创建文档的地方：

```
class FoosController < ApplicationController
  def create
    foo_creator = FooThingy::Foo::Create.new(params: params, foo_class: Mongo::Foo)
    foo = foo_creator.execute!
    foo = foo.data[:foo]
    binding.pry
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T22:36:34.230

我认为这个问题并没有看起来那么有趣。我已经修改了 my`config/mongoid.yml`以指定一个新数据库，并且一切都按预期运行。问题可能是由于 32 位 MongoDB 安装的限制。**

# asp.net-mvc - 如果为同一个模型属性调用两次，为什么 TextBoxFor 不包含验证元素？

> ID：12981259
> 
> 赞同：0
> 
> 时间：2012-10-19T19:36:02.190
> 
> 标签：asp.net-mvc, asp.net-mvc-4

简单的问题......这是一些剃须刀代码的示例：

```
@Html.TextBoxFor(c => c.RevisedEstimate)
@Html.TextBoxFor(c => c.RevisedEstimate) 
```

这是它的渲染方式：

```
<input data-val="true" data-val-number="The field Revised Estimate must be a number." id="RevisedEstimate" name="RevisedEstimate" type="text" value="0" />
<input id="RevisedEstimate" name="RevisedEstimate" type="text" value="0" /> 
```

你问的明显问题是，“你为什么这样做？”。Razor 视图实际上是构建在 KendoUI 网格中使用的客户端详细信息行模板。有两个相似的网格，我们使用相同的视图模型服务器端。实际上，我们确实为模板提供了 id 元素，因此每行中的每个字段最终都有一个唯一的 id。

为什么第二个输入元素没有 data-val 和 data-val-number 元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:41:17.100

知道 JS 在后台做什么，我突然想到这样做是为了防止冲突。JS 会查找具有 data- 属性的元素以及其他函数来进行验证，因此如果有多个实例，它可能会选择错误的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T21:23:18.167

因为我们正在生成用于客户端模板的 HTML，所以我们所做的只是创建一个变量来保存由帮助程序生成的 HTML，然后在视图中呈现该代码。

就像是：

```
@{
   var revisedEstimateInput = Html.TextBoxFor(c => c.RevisedEstimate)
} 
```

然后在视图中：

```
@(revisedEstimateInput) 
```

...根据需要在尽可能多的地方。这样，验证和其他元数据属性就在我们的客户端模板中，并且所有 kenodUI 验证都正常工作。

# android - Android SherlockFragmentActivity - 选项卡

> ID：12981264
> 
> 赞同：0
> 
> 时间：2012-10-19T19:36:29.190
> 
> 标签：android

我使用 SherlockFragmentActivity 并且我有：

```
public class TestActivity extends SherlockFragmentActivity {

    private static enum Tab {
        Test1("test1", TestOneFragment.class),
        Test2("test2", TestTwoFragment.class),
        private final String title;
        private final Class<? extends Fragment> clazz;

        private Tab(String title, Class<? extends Fragment> clazz) {
            this.title = title;
            this.clazz = clazz;
        }

        private String getTitle() {
            return title;
        }

        private Class<? extends Fragment> getFragmentClass() {
            return clazz;
        }
    } 
```

它工作正常，因为我在同一个“包”中有 Test1 和 Test2。

如何添加外部“包”类？当我导入 com.bla.blaa.BlaActivity; 我这样使用：

```
 private static enum Tab {
        Blabla("Blabla", BlaActivity.class),
        Test1("test1", TestOneFragment.class),
        Test2("test2", TestTwoFragment.class); 
```

我有错误：

```
The constructor TestActivity.Tab(String, Class<BlaActivity>) is 
     undefined 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:43:31.977

您不能传递给不扩展片段的 SherlockFragmentActivity 构造函数类。您似乎正在尝试将活动（BlaActivity.class）传递给 Tab。SherlockFragmentActivity 使用片段。您可以使用意图从其中一个选项卡启动其他应用程序：

```
Intent launchIntent = getPackageManager().getLaunchIntentForPackage("com.package.address");
startActivity(launchIntent); 
```

# xml - 在 Notepad++ 中验证所有打开的文档中的 XML

> ID：12981265
> 
> 赞同：1
> 
> 时间：2012-10-19T19:36:31.757
> 
> 标签：xml, xsd, notepad++, xml-validation

我正在使用 notepad++ 中的 xml-tools 插件使用 .xsd 模式文件对 .xml 文件运行验证。

但我有数百个文件要验证，而且可能还有数百个。

我真的很喜欢 Notepad++ 如何处理“在所有文档中查找所有内容”，并且想知道是否有办法在记事本中执行 run-plugin-function-in-all-opened-documents。

或者，如果有另一种更好的大规模验证 .xml 的方法可以解决问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T21:29:21.940

有命令行工具，可根据您的环境通过批处理/shell 脚本使用。[这](http://xmlvs.sourceforge.net/)是在 perl 中实现的，应该可以，[这里](http://www.ltg.ed.ac.uk/~ht/xsv-status.html)是 Win32 安装程序的链接。

# c++ - 在枚举上使用的正确演员表是什么？

> ID：12981268
> 
> 赞同：2
> 
> 时间：2012-10-19T19:36:36.837
> 
> 标签：c++, enums, type-conversion

如果我没记错的话，C-Style 转换只不过是一组有序的转换`static_cast, dynamic_cast, reinterpret_cast, static_cast...`，请考虑：

```
enum NUMBERS
{
    NUMBER_ONE,
    NUMBER_TWO
};

void Do( NUMBERS a )
{
}

int _tmain(int argc, _TCHAR* argv[])
{   

    unsigned int a = 1;
    Do( a ); //C2664
    return 0;
} 
```

C风格的转换会做

```
Do( (NUMBERS)a ); 
```

我想知道的是，正确的非 C 样式转换是什么，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T19:40:23.213

正确的方法是：

```
static_cast<NUMBERS>(a) 
```

因为：

> 8) 整数、浮点或枚举类型可以转换为任何枚举类型（如果转换为枚举的基础类型的表达式的值不是目标枚举值之一，则结果未指定）

来源：[http ://en.cppreference.com/w/cpp/language/static_cast](http://en.cppreference.com/w/cpp/language/static_cast)

`dynamic_cast`使用 RTTI 进行运行时检查，因此它仅适用于具有至少一个虚拟方法的类。

`reinterprest_cast`旨在告诉编译器将特定的内存块视为某种不同的类型，而无需任何实际的运行时转换。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T19:37:51.457

```
static_cast<NUMBERS>(a) 
```

因为 static_cast 的规范包括：

> 整数或枚举类型的值可以显式转换为枚举类型。如果原始值在枚举值 (7.2) 的范围内，则该值不变。否则，结果值是未指定的（并且可能不在该范围内）。浮点类型的值也可以转换为枚举类型。结果值与将原始值转换为枚举的基础类型（4.9）相同，然后再转换为枚举类型。

static_cast 通常用于获取一种类型的值并将该值表示为另一种类型。大约有两页的规范涵盖了所有细节，但是如果您理解了这个基本概念，那么您可能会知道何时要使用 static_cast。例如，如果要将整数值从一种整数类型转换为另一种整数类型，或者如果要将浮点值转换为整数值。

dynamic_cast 用于处理动态类型，它主要只对多态、用户定义的类型有用。例如，如果引用的对象实际上是 Derived，则将 Base * 转换为 Derived *。

reinterpret_cast 通常用于在一种类型中获取值的表示，并在另一种类型中获取具有相同表示的值；即，类型双关语（尽管很多类型双关语在 C++ 中实际上是不合法的）。例如，如果您想以 char 数组的形式访问整数的存储。

const_cast 用于在类型的任何级别添加和删除 cv 限定符（const 和 volatile）。例如，`int const * volatile **i; const_cast<int volatile ** const *>(i);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:39:45.070

`static_cast<>`是要走的路：

[这就是为什么](http://msdn.microsoft.com/en-us/library/c36yw7x9(v=vs.80).aspx)

# ruby-on-rails - 将参数传递到 redirect_to(@post)

> ID：12981273
> 
> 赞同：0
> 
> 时间：2012-10-19T19:36:43.967
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

从我的 Rails 控制器，以`create`我想做的方法

```
redirect_to @post(:notice => "Post successful', :status => "Success!") 
```

`show.html.erb`并通过使用`<%= notice %>`和访问参数`<%= status %>`

但它不起作用。我该如何解决？

`routes.rb`文件：

```
Archive::Application.routes.draw do
  resources :posts
  root :to => "Posts#new"
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T23:06:01.227

它可能不起作用的原因是您正在覆盖作为响应的一部分返回的*HTTP 状态代码*。此状态代码通过设置`:status`redirect_to 语法设置，浏览器使用它来确定它的特定操作。您可以在此处阅读有关不同状态代码的更多信息[W3C HTTP 状态代码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)。

长话短说，为了成功进行重定向，您需要有一个`3XX`代码供浏览器查看 HTTP 响应中的位置标头，并加载那里指定的 URL。如果您希望重定向正常工作，可以使用以下语法。

```
redirect_to @post, :notice => "Post successful" 
```

如果由于某种原因你想手动设置它，你可以这样做：

```
redirect_to @post, :notice => "Post successful", :status => 301 
```

您还可以使用一些符号来代替数字状态代码，您可以在[Rails 文档中了解 redirect_to](http://api.rubyonrails.org/classes/ActionController/Redirecting.html)的相关信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:53:59.683

您是否尝试过使用：

```
redirect_to post_path , :notice => "Post successful", :status => "Success!" 
```

# java - Java转换集 > 列出 >

> ID：12981274
> 
> 赞同：2
> 
> 时间：2012-10-19T19:36:47.347
> 
> 标签：java, list, collections, set

在 Java 中，我无法从 a 转换`Set<Set<String>>`为 a `List<List<String>>`，然后用`Set<Set<String>>`

这是我的代码：

```
Set<Set<String>> treeComps = compExtractor.transform(forest); // fine
List<List<String>> components = new List<List<String>>();     // does not work
components.addAll(treeComps);                                 // does not work 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:41:04.940

您无法实例化 List 接口的实例，您需要使用 ArrayList 之类的实现之一。然后您可以在 treeComps 中迭代外部集合，为每个内部集合创建一个新的 ArrayList，在此 ArrayList 上调用 addAll，然后将该列表添加到组件中。

```
List<List<String>> components = new ArrayList<List<String>>();
for( Set<String> s : treeComps )
{
  List<String> inner = new ArrayList<String>();
  inner.addAll( s );
  components.add( inner );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:37:29.950

我认为唯一的方法是迭代外部集。获取内部集合和用户`new ArrayList<String>(innerSet)`

将上述结果列表添加到外部列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:42:00.107

像这样的东西...

```
Set<Set<String>> treeComps = compExtractor.transform(forest);
List<List<String>> lists = new ArrayList<List<String>>();
for (Set<String> singleSet : treeComps) {
    List<String> singleList = new ArrayList<String>();
    singleList.addAll(singleSet);
    lists.add(singleList);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:41:59.403

```
List<List<String>> components = new Vector<List<String>>();
List<String> n;
for( Set<String> s : trerComps ) {
   n = new Vector<String>();
   n.addAll( s );
   components.add( n);
} 
```

# ruby-on-rails - Ruby：给定日期查找下一个第二个或第四个星期二

> ID：12981276
> 
> 赞同：6
> 
> 时间：2012-10-19T19:36:59.187
> 
> 标签：ruby-on-rails, ruby, date

我似乎无法找到一种优雅的方式来做到这一点......

给定一个日期，我如何才能找到日历月的第二个或第四个星期二的下一个星期二？

例如：

给定`2012-10-19`然后返回`2012-10-23`

或者

给定`2012-10-31`然后返回`2012-11-13`

```
 October               November        
Su Mo Tu We Th Fr Sa    Su Mo Tu We Th Fr Sa  
    1  2  3  4  5  6                 1  2  3  
 7  8  9 10 11 12 13     4  5  6  7  8  9 10 
14 15 16 17 18 19 20    11 12 13 14 15 16 17  
21 22 23 24 25 26 27    18 19 20 21 22 23 24 
28 29 30 31             25 26 27 28 29 30 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T23:53:19.417

**如果您只想查看最终结果的样子，请滚动到底部。**

使用我最近在 ruby​​ 1.9.3 中完成的一些日期处理工作的代码片段。

## 一些升级`DateTime`：

```
require 'date'

class DateTime

  ALL_DAYS = [ 'sunday', 'monday', 'tuesday',
               'wednesday', 'thursday', 'friday', 'saturday' ]

  def next_week
    self + (7 - self.wday)
  end

  def next_wday (n)
    n > self.wday ? self + (n - self.wday) : self.next_week.next_day(n)
  end

  def nth_wday (n, i)
    current = self.next_wday(n)
    while (i > 0)
      current = current.next_wday(n)
      i = i - 1
    end
    current
  end

  def first_of_month
    self - self.mday + 1
  end

  def last_of_month
    self.first_of_month.next_month - 1
  end

end 
```

## `method_missing`技巧：

我还用一些缺少方法的技巧来补充课程，以将调用映射`next_tuesday`到`next_wday(2) and`nth_tuesday(2) `to`nth_wday(2, 2)`，这使得下一个片段更容易上手。

```
class DateTime

  # ...

  def method_missing (sym, *args, &block)
    day = sym.to_s.gsub(/^(next|nth)_(?<day>[a-zA-Z]+)$/i, '\k<day>')
    dindex = ALL_DAYS.include?(day) ? ALL_DAYS.index(day.downcase) : nil
    if (sym =~ /^next_[a-zA-Z]+$/i) && dindex
      self.send(:next_wday, dindex)
    elsif (sym =~ /^nth_[a-zA-Z]+$/i) && dindex
      self.send(:nth_wday, dindex, args[0])
    else
      super(sym, *args, &block)
    end
  end

  def respond_to? (sym)
    day = sym.to_s.gsub(/^(next|nth)_(?<day>[a-zA-Z]+)$/i, '\k<day>')
    (((sym =~ /^next_[a-zA-Z]+$/i) || (sym =~ /^nth_[a-zA-Z]+$/i)) && ALL_DAYS.include?(day)) || super(sym)
  end

end 
```

## 例子：

给定一个日期：

```
today = DateTime.now
second_tuesday = (today.first_of_month - 1).nth_tuesday(2)
fourth_tuesday = (today.first_of_month - 1).nth_tuesday(4)

if today == second_tuesday
  puts "Today is the second tuesday of this month!"
elsif today == fourth_tuesday
  puts "Today is the fourth tuesday of this month!"
else
  puts "Today is not interesting."
end 
```

您还可以编辑`method_missing`以处理诸如 , 等调用`:second_tuesday_of_this_month`。`:fourth_tuesday_of_this_month`如果我决定在以后编写代码，我将在此处发布代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:56:39.853

看看[Chronic](http://rubygems.org/gems/chronic)或[Tickle](http://rubygems.org/gems/tickle)，它们都是解析复杂时间和日期的宝石。Tickle 尤其会解析重复出现的时间（我认为它也使用了 Chronic）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:56:10.467

看看这个宝石，你也许能找出答案

[https://github.com/mojombo/chronic/](https://github.com/mojombo/chronic/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T21:06:28.290

由于您已经使用 Rails，因此不需要包含，但这在纯 Ruby 中也适用，以供参考。

```
require 'rubygems'
require 'active_support/core_ext'

d = DateTime.parse('2012-10-19')
result = nil
valid_weeks = [d.beginning_of_month.cweek + 1, d.beginning_of_month.cweek + 3]
if valid_weeks.include?(d.next_week(:tuesday).cweek)
  result = d.next_week(:tuesday)
else
  result = d.next_week.next_week(:tuesday)
end

puts result 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T21:15:53.253

如果您需要扩展到更有趣的逻辑，我认为您可能应该使用库，但是如果您所描述的就是您所需要的，那么下面的代码应该会有所帮助

```
SECONDS_PER_DAY = 60 * 60 * 24
def find_tuesday_datenight(now)
  tuesdays = [*-31..62].map { |i| now + (SECONDS_PER_DAY * i) }
    .select { |d| d.tuesday? }
    .group_by { |d| d.month }
  [tuesdays[now.month][1], tuesdays[now.month][-2], tuesdays[(now.month + 1) % 12][1]]
    .find {|d| d.yday > now.yday }
end 
```

循环上个月和下个月，抓住星期二，按月分组，取当月的第 2 和第 2 个最后一个星期二（如果你真的想要第 4 个星期二，只需将 -2 更改为 3）和第 2 个星期二下个月，然后选择提供的日期之后的第一个。

这是一些测试，每月 4 个星期二，每月 5 个星期二，随机，以及您的示例：

```
[[2013, 5, 1], [2013, 12, 1], [2012, 10, 1], [2012, 10, 19], [2012, 10, 31]].each do |t|
  puts "#{t} => #{find_tuesday_datenight(Time.new *t)}"
end 
```

产生

```
[2013, 5, 1] => 2013-05-14 00:00:00 +0800
[2013, 12, 1] => 2013-12-10 00:00:00 +0800
[2012, 10, 1] => 2012-10-09 00:00:00 +0800
[2012, 10, 19] => 2012-10-23 00:00:00 +0800
[2012, 10, 31] => 2012-11-13 00:00:00 +0800 
```

我相信它可以被简化，我很想听听一些建议:)（太晚了，甚至懒得弄清楚有效日期的实际范围应该是多少，即小于-31..62）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T22:45:37.553

所以这里的代码将解决一个月中给定一周的工作日（你所要求的很少加糖）。如果您在 rails 框架内运行，则应该没有问题。否则，请确保您安装了 active_support gem。方法名称很愚蠢，所以请随意更改它:)

用法：`get_next_day_of_week(some_date, :friday, 1)`

```
require 'rubygems'
require 'active_support/core_ext'

def get_next_day_of_week(date, day_name, count)
  next_date = date + (-date.days_to_week_start(day_name.to_sym) % 7)
  while (next_date.mday / 7) != count - 1 do
    next_date = next_date + 7
  end
  next_date
end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-03T23:07:17.530

我使用以下来计算微软的补丁星期二日期。它改编自一些 C# 代码。

```
require 'date'

#find nth iteration of given day (day specified in 'weekday' variable)
findnthday = 2
#Ruby wday number (days are numbered 0-7 beginning with Sunday)
weekday = 2

today = Time.now
todayM = today.month
todayY = today.year
StrtMonth = DateTime.new(todayY,todayM ,1)

while StrtMonth.wday != weekday do

    StrtMonth = StrtMonth + 1;
end

PatchTuesday = StrtMonth + (7 * (findnthday - 1)) 
```

# jquery - 仅显示 jquery 中的所有段落

> ID：12981277
> 
> 赞同：0
> 
> 时间：2012-10-19T19:37:00.593
> 
> 标签：jquery

我正在尝试学习 jquery，所以我正在尝试编写一个脚本来隐藏页面上的大部分内容，（目前）只留下段落。

```
(function() {
  var all = $("*");
  all.hide();

  var paragraphs = $("p");
  paragraphs.show();
 })(); 
```

那是我现在拥有的代码，但它不起作用。它隐藏了所有内容，但之后不显示段落。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:38:36.617

这是一个开始的解决方案：

```
$("body :not(p)").hide(); 
```

将其阅读为：在`<body>`元素中*找到*所有*不是* `<p>`的元素。

我怀疑您的标记非常简单，嵌套元素最少，例如

```
<html>
<head></head>
<body>
    <h1>Heading</h1>
    <p>Paragraph 1</p>
    <div>Text block</div>
    <p>Paragraph 2</p>
</body>
</html> 
```

否则，如其他答案（和评论）所述，您应该考虑您的`<p>`元素是否确实有非`<p>`父母。在这种情况下，嵌套段落可能仍然不可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:39:33.963

您不能显示隐藏父母的孩子。你试图做的事情是行不通的。您必须确保`<p>`标签的祖先都是可见的，一直到`<body>`和`<html>`。

作为一种解决方法，您可以将所有`<p>`标签从它们的父母身上分离出来，隐藏身体内留下的所有东西，然后`<p>`直接重新附加到身体上。就恢复其原始状态而言，此时您的 dom 将被不可逆转地破坏。

```
var paragraphs = $('p').detach();

$('body *').hide();

$('body').append(paragraphs); 
```

我想不出任何实际用途。您可能需要重新考虑您正在尝试做什么并更改您的标记以适应您的新知识。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:38:55.130

隐藏所有内容也会隐藏每个 的所有父元素`<p>`，包括`<html>`和`<body>`。`<p>`如果元素要可见，您需要确保它们可见。

相反，显示段落及其父母：

```
$('*').hide();
$('p').parents().andSelf().show(); 
```

或者，仅隐藏不包含段落的元素：

```
$(':not(:has(p), p)').hide(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T19:40:20.980

```
$('body :not(p)').hide();
$('body p').appendTo('body'); 
```

隐藏除段落之外的所有内容，然后将段落移动为正文的直接子级。

请注意，“appendTo”和其他方法实际上*并不*克隆元素，如果它们已经存在于 DOM 中，则只是移动它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T19:38:52.893

问题是即使段落是可见的`body`，包裹它们的仍然是隐藏的..所以即使你让它们可见你也不会看到这些段落..因为**作为主体的父级也被**隐藏了..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T19:39:11.073

我的猜测是`*`通配符包括`<body>`. 尝试：

```
$("body *").hide();
$("p").show().parents().show(); 
```

正如 MarcB 在评论中指出的那样，你也需要`.show()`所有的`<p>`父母（这就是这样`.parents().show()`做的）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-19T19:40:09.177

如果 P 的父项被隐藏，则不会显示 P。

```
(function() {
  var all = $("body *").not("p");
  all.hide();
 })(); 
```

如果要显示所有 p 但隐藏其他 p，可以将所有 p 附加到 body 为：

```
(function() {
  var all = $("body *").not("p");
  all.hide();
   $("p").appendTo('body');
 })(); 
```

# hbase - 新的 HBase 安装速度很慢

> ID：12981281
> 
> 赞同：0
> 
> 时间：2012-10-19T19:37:10.217
> 
> 标签：hbase, apache-zookeeper

我刚刚在 iMac 上安装了 HBase 0.94.2，运行 Sun Java 7 和 Mac OS 10.8.2。

我确实有一个开发 Hadoop 实例，但是现在我在独立模式下运行 HBase。

不幸的是，许多基本操作的执行时间超过 30 秒：

```
magoo:bin mattpainter$ ./hbase shell
HBase Shell; enter 'help<RETURN>' for list of supported commands.
Type "exit<RETURN>" to leave the HBase Shell
Version 0.94.2, r1395367, Sun Oct  7 19:11:01 UTC 2012

hbase(main):002:0> list 'table'
TABLE                                                                                                                                                                       
2012-10-20 08:26:38.903 java[41217:1703] Unable to load realm info from SCDynamicStore
0 row(s) in 33.6460 seconds

hbase(main):003:0> 
```

查看日志，我们看到：

```
12/10/20 08:24:58 INFO zookeeper.ClientCnxn: Client session timed out, have not heard from server in 26667ms for sessionid 0x13a7a7744270005, closing socket connection and attempting reconnect
12/10/20 08:24:58 WARN zookeeper.RecoverableZooKeeper: Possibly transient ZooKeeper exception: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase/master
12/10/20 08:24:58 INFO util.RetryCounter: Sleeping 2000ms before retry #1...
12/10/20 08:24:59 INFO zookeeper.ClientCnxn: Opening socket connection to server /fe80:0:0:0:0:0:0:1%1:2181
12/10/20 08:25:04 INFO client.ZooKeeperSaslClient: Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
12/10/20 08:25:04 INFO zookeeper.ClientCnxn: Socket connection established to fe80:0:0:0:0:0:0:1%1/fe80:0:0:0:0:0:0:1%1:2181, initiating session
12/10/20 08:25:04 INFO zookeeper.ClientCnxn: Session establishment complete on server fe80:0:0:0:0:0:0:1%1/fe80:0:0:0:0:0:0:1%1:2181, sessionid = 0x13a7a7744270005, negotiated timeout = 40000 
```

有什么问题会导致零配置的开箱即用安装（除了设置`JAVA_HOME`in `hbase-env.sh`）会表现出这种行为？

非常感谢，马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:47:10.663

是的，[ZOOKEEPER-1477](https://issues.apache.org/jira/browse/ZOOKEEPER-1477)确实是罪魁祸首。

我从 JDK1.7.0_04 升级到 JDK1.7.0_09，并相应地修改了我的`base-env.sh`，现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:42:12.387

似乎您的 JVM 默认使用 IPv6 流量。尝试将 -Djava.net.preferIPv4Stack=true 添加到您的 HBASE_OPTS envvar（仅在 hbase-env.sh 中的 JAVA_HOME 下面几行），然后重新启动 HBase。

还有其他强制 IPv4 的方法（编辑 sysctl.conf）

# msbuild - MSBuild（通过 Microsoft.Build 命名空间）可以从内存中加载项目吗？

> ID：12981283
> 
> 赞同：0
> 
> 时间：2012-10-19T19:37:19.140
> 
> 标签：msbuild, msbuild-4.0

我正在开发一项服务，该服务将从存储库下载 .NET 解决方案并构建它（与持续集成构建服务不同）。我想知道的是，通过`Microsoft.Build`命名空间类以编程方式使用 MSBuild，我可以将解决方案和项目加载到内存中并构建它，**而无需**先将它们保存到磁盘中的临时文件夹中吗？

我仍在学习 MSBuild 并尝试一些东西，但我认为 Stack Overflow 上的某个人已经尝试过这个并且有一些见识。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T22:44:28.503

我不能说这是否是一个好主意，但有可能做到。

[ProjectInstance](http://msdn.microsoft.com/en-us/library/dd234656.aspx)有一个接受[ProjectRootElement](http://msdn.microsoft.com/en-us/library/microsoft.build.construction.projectrootelement.aspx)的构造函数，可以通过[Create(XmlReader) 方法](http://msdn.microsoft.com/en-us/library/dd394613.aspx)构造它。您可能知道，XmlReader 可以附加到各种流，包括 MemoryStream。

下面是这样的事情：

```
var xmlReader = XmlTextReader.Create([your existing memory stream]);
var project = ProjectRootElement.Create(xmlReader);

var buildParams = new BuildParameters();
var buildData = new BuildRequestData(new ProjectInstance(project),
    new string[] { "Build", "Your Other Target Here" });

var buildResult = BuildManager.DefaultBuildManager.Build(buildParams, buildData); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T16:44:37.667

在研究了 MSBuild 和所有相关组件之后，似乎有必要在文件系统上设置整个项目，然后才能构建它。不幸的是，我正在尝试做的事情无法使用提供的工具集完成。

# java - 使用自己的外部库部署 GWT 应用程序

> ID：12981287
> 
> 赞同：2
> 
> 时间：2012-10-19T19:37:26.660
> 
> 标签：java, eclipse, gwt

我有一个 GWT 项目 [com.bob.gwt]，它使用我自己的另一个库 [com.bob.domain]，它在客户端和服务器中都使用。域项目通过 com.bob.gwt 中的 gwt.xml 项目公开。

当服务器运行时，它表明来自 com.bob.domain 的一些服务器类在 web 应用程序中找不到，但在类路径中找到并添加。WAR 目录没有来自 com.bob.domain 的 .java 或 .class 文件。

com.bob.domain 作为库添加到 Java Bulid Path Window 的 Projects 选项卡中，并且还在 Eclipse 的 Order 和 Export 选项卡上进行了检查。我是否必须将 com.bob.domain 设置为 jar 并将该 jar 导入 com.bob.gwt？我可以只在我的 gwt 项目中包含域源，这样我就可以一次调试，而不必手动构建一个 jar，并且我的 WAR 文件夹中的所有内容都准备好进行部署了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T13:48:47.300

在开发过程中，可以方便地使用Eclipse的项目引用机制，而不是每次都重新构建“domain.jar”。在这种情况下，忽略 GWT 的警告是安全的。

当您在 Eclipse 之外执行“真正的构建”（我强烈推荐）时，您通常不能使用 Eclipse 的项目参考^(（除非您使用[Ant4Eclipse](http://www.ant4eclipse.org/node/6)）)，因此您需要告诉 GWT编译器（gwtc）和服务器端编译器（javac），在哪里可以找到他们需要的一切，包括域项目的文件。

然后，为了部署，您需要将“domain.jar”放入您的战争的“WEB-INF/lib”中。

# c# - 如何分析 ASP.NET MVC 应用程序中请求的性能？

> ID：12981298
> 
> 赞同：8
> 
> 时间：2012-10-19T19:38:01.057
> 
> 标签：c#, asp.net-mvc, performance, iis-7, httpmodule

我想捕获 ASP.NET MVC 应用程序中请求的命中时间、处理时间、内存消耗和响应时间。

有什么方法或工具可以执行此操作吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-19T19:40:44.337

检查由 stackoverflow 团队开发的**miniprofiler**

[http://code.google.com/p/mvc-mini-profiler/](http://code.google.com/p/mvc-mini-profiler/)

这有助于您进行一些分析。有一个 nuget pacakge 可用，您可以使用它来将其添加到您的项目中。

Scott 写了一篇[关于](http://www.hanselman.com/blog/NuGetPackageOfTheWeek9ASPNETMiniProfilerFromStackExchangeRocksYourWorld.aspx)如何使用它的文章。

您也可以查看**[Glimpse](http://getglimpse.com/)。**

有一些商业产品可以像 telerik [just trace](http://www.telerik.com/products/memory-performance-profiler.aspx)那样进行内存和性能分析。您可以下载他们的试用版并使用它

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T22:26:51.077

您可以创建自己的小型性能测试监视器。这是 Steven Sanderson 的书 Pro Asp.Net MVC 2 Framework 的第 670 页：

```
public class PerformanceMonitorModule : IHttpModule
{
    public void Dispose() { /* Nothing to do */ }
    public void Init(HttpApplication context)
    {
        context.PreRequestHandlerExecute += delegate(object sender, EventArgs e)
        {
            HttpContext requestContext = ((HttpApplication)sender).Context;
            Stopwatch timer = new Stopwatch();
            requestContext.Items["Timer"] = timer;
            timer.Start();
        };
        context.PostRequestHandlerExecute += delegate(object sender, EventArgs e)
        {
            HttpContext requestContext = ((HttpApplication)sender).Context;
            Stopwatch timer = (Stopwatch)requestContext.Items["Timer"];
            timer.Stop();

            if (requestContext.Response.ContentType == "text/html")
            {
                double seconds = (double)timer.ElapsedTicks / Stopwatch.Frequency;
                string result =
                string.Format("{0:F4} sec ({1:F0} req/sec)", seconds, 1 / seconds);
                requestContext.Response.Write("<hr/>Time taken: " + result);
            }
        };
    }
} 
```

然后添加到您的 web.config：

```
<add name="PerfModule" type="Namespace.PerformanceMonitorModule, AssemblyName"/> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T19:46:08.797

不是免费的，但它真的很好：

[http://www.jetbrains.com/profiler/](http://www.jetbrains.com/profiler/)

dotTrace 是用于 .NET 应用程序的一系列性能和内存分析器。

我们的最新版本 dotTrace 5.2 Performance 可帮助 .NET 开发人员快速找到性能瓶颈并优化他们的应用程序。

# r - 如何通过循环响应变量（在列中）在 R 中创建汇总表和图形

> ID：12981299
> 
> 赞同：2
> 
> 时间：2012-10-19T19:38:04.880
> 
> 标签：r, loops, ggplot2

我有一个包含多个响应变量和三种处理的数据集。治疗 2 嵌套在治疗 1 中，治疗 3 嵌套在治疗 2 中。为了简单起见，我只显示了三个响应变量。我想运行这个超过 22 个响应变量，其中 3 个显示在演示表中。

我的目标：

1.  可视化响应变量如何根据治疗组合变化。我创建了一个脚本来对一个响应变量执行此操作。我正在复制粘贴此代码以运行其他列，这对我来说是一种非常粗暴的方法。这导致了我的第二个目标。
2.  自动化或修改以下脚本，以便它可以自动循环遍历列并生成所需的表格和图形。

演示数据： [demo.table](http://pastebin.com/sR2MvBBA)

这是我的脚本：

```
library(doBy)
length2 <- function (x, na.rm=FALSE) {
    if (na.rm) sum(!is.na(x))
    else       length(x)
}
 attach (demo)
cdataNA <- summaryBy(tyr ~ spp + wat + ins, data=demo, FUN=c(length2,mean,sd), na.rm=TRUE)
# Rename column change.length to just N
names(cdataNA)[names(cdataNA)=="tyr.length2"] <- "N"
# Calculate standard error of the mean
cdataNA$tyr.SE <- cdataNA$tyr.sd / sqrt(cdataNA$N)
cdataNA
# Now create a barplot using ggplot2
library(ggplot2)
a <- ggplot(cdataNA, aes(x = wat, y = tyr.mean, fill = ins))
b <- a + geom_bar(stat = "identity", position = "dodge") + facet_grid (~ spp)
# Now put errorbars.
c <- b + geom_errorbar(aes(ymin=tyr.mean-tyr.SE, ymax=tyr.mean+tyr.SE), 
                  width=.2,                    # Width of the error bars
                  position=position_dodge(.9)) + 
xlab ("wat") + 
ylab ("tyr (PA/PA std)")
c

## esc
library(doBy)
length2 <- function (x, na.rm=FALSE) {
    if (na.rm) sum(!is.na(x))
    else       length(x)
}
cdataNA1 <- summaryBy(esc ~ spp + wat + ins, data=demo, FUN=c(length2,mean,sd), na.rm=TRUE)
# Rename column change.length to just N
names(cdataNA1)[names(cdataNA1)=="esc.length2"] <- "N"
# Calculate standard error of the mean
cdataNA1$esc.SE <- cdataNA1$esc.sd / sqrt(cdataNA1$N)
cdataNA1
# Now create a barplot using ggplot2
library(ggplot2)
a1 <- ggplot(cdataNA1, aes(x = wat, y = esc.mean, fill = ins))
b1 <- a1 + geom_bar(stat = "identity", position = "dodge") + facet_grid (~ spp)
# Now put errorbars.
c1 <- b1 + geom_errorbar(aes(ymin=esc.mean-esc.SE, ymax=esc.mean+esc.SE), 
                  width=.2,                    # Width of the error bars
                  position=position_dodge(.9)) + 
xlab ("wat") + 
ylab ("esc (PA/PA std)")
c1 
```

tyr 的结果表：

```
 spp  wat ins N tyr.mean      tyr.sd      tyr.SE
1  Bl High  No 4 0.305325 0.034102041 0.017051020
2  Bl High Yes 5 0.186140 0.045165894 0.020198802
3  Bl  Low  No 5 0.310540 0.061810096 0.027642315
4  Bl  Low Yes 5 0.202840 0.029034944 0.012984822
5 Man High  No 4 0.122725 0.075867005 0.037933503
6 Man High Yes 5 0.081800 0.013463469 0.006021046
7 Man  Low  No 5 0.079880 0.009569587 0.004279650
8 Man  Low Yes 4 0.083550 0.018431947 0.009215973 
```

esc 的结果图：esc 的 [演示图](http://imageshack.us/photo/my-images/827/escdemo.png/)

所以整个事情都有效，但仍然需要大量的体力劳动，这会阻碍工作流程。实现自动化会很棒。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T02:20:03.233

您可以只用两行来组织数据：

```
melt.dta <- melt(dta, id.vars = c("spp", "wat", "ins"), measure.vars = "tyr")
cast(melt.dta, spp + wat + ins ~ ., 
     function (x) c("N" = sum(!is.na(x)), 
                    "mean" = mean(x, na.rm = TRUE),                   
                    "sd" = sd(x, na.rm = TRUE),
                    "se" = sd(x, na.rm = TRUE)/sqrt(sum(!is.na(x))))) 
```

它返回：

```
 spp  wat ins N   mean      sd      se
1  Bl High  No 4 0.3053 0.03410 0.01705
2  Bl High Yes 5 0.1861 0.04517 0.02020
3  Bl  Low  No 5 0.3105 0.06181 0.02764
4  Bl  Low Yes 5 0.2028 0.02903 0.01298
5 Man High  No 4 0.1227 0.07587 0.03793
6 Man High Yes 5 0.0818 0.01346 0.00602
7 Man  Low  No 5 0.0799 0.00957 0.00428
8 Man  Low Yes 4 0.0835 0.01843 0.00922 
```

# arrays - Delphi - BinToHex 和 HexToBin : 反转

> ID：12981308
> 
> 赞同：3
> 
> 时间：2012-10-19T19:38:57.140
> 
> 标签：arrays, delphi, hex, byte, delphi-xe2

我有一个字节数组，我希望将其转换为十六进制字符串，然后再转换回字节数组。

我正在使用以下内容转换为十六进制字符串：

```
function bintoHex(const bin: array of byte): String;
const HexSymbols = '0123456789ABCDEF';
var i: integer;
begin
  SetLength(Result, 2*Length(bin));
  for i :=  0 to Length(bin)-1 do begin
    Result[1 + 2*i + 0] := HexSymbols[1 + bin[i] shr 4];
    Result[1 + 2*i + 1] := HexSymbols[1 + bin[i] and $0F];
  end;
end; 
```

我不确定如何正确地将其转换回字节数组。我正在拍摄类似以下内容：

```
Type TDCArray = Array of Byte;

function xHexToBin(const HexStr: String): TDCArray;
const HexSymbols = '0123456789ABCDEF';
var i: integer;
begin
  SetLength(Result, ???); //Need to now get half of the length, unsure how to go about that
  for i :=  0 to Length(HexStr)-1 do begin
    //Here convert back into an array somehow...
    //Result[i] := ???
  end;
end; 
```

我该怎么做呢？

另外，我正在使用 Delphi XE2。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-19T20:43:41.607

为什么不直接使用[`BinToHex`](http://docwiki.embarcadero.com/Libraries/XE2/en/System.Classes.BinToHex)和[`HexToBin`](http://docwiki.embarcadero.com/Libraries/XE2/en/System.Classes.HexToBin)RTL 函数呢？

```
{$APPTYPE CONSOLE}

uses
  System.Classes,
  System.SysUtils;

var
  LArray : array[1..6] of Byte = (10, 11, 12, 13, 14, 15);
  LText: string;
  I : integer;
begin
  try
    SetLength(LText, Length(LArray)*2);
    BinToHex(@LArray, PChar(LText), SizeOf(LArray));
    //show the hex string
    Writeln(LText);

    //fill the array with 0 
    FillChar(LArray, SizeOf(LArray), #0);

    //get the values from the hex string
    HexToBin(PChar(LText), @LArray, Length(LArray));

    //show the array values
    for i := 1 to Length(LArray) do
      Write(LArray[i]);
    Readln;
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
end. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T19:58:42.520

2 个十六进制字符代表 1 个字节

我之前写的代码是伪代码，我想让你明白这个想法。但是如果你需要一些代码来粘贴这里是实际的实现：

```
program project1;

uses SysUtils,classes;

type
  TByteArray = array of byte;
function StrToArray(const Hexstr: String): TByteArray ;
var
i: Integer;
begin
SetLength(Result, Length(Hexstr) div 2);
for i:=0 to (Length(Hexstr) div 2 - 1) do
        Result[i]:= StrToInt('$' + Copy(Hexstr, (i * 2) + 1, 2));
end;

var
   arr : TByteArray;
   i : Integer;
begin
  arr := StrToArray('0A0B0C0D');
  for i:=0 to High(arr) do
          WriteLn(arr[i]);
  Readln;
end. 
```

顺便说一句，编码与剪切和粘贴无关；）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T20:12:36.480

如果你想自己做：

```
function xHexToBin(const HexStr: String): TBytes;
const HexSymbols = '0123456789ABCDEF';
var i, J: integer;
    B: Byte;
begin
  SetLength(Result, (Length(HexStr) + 1) shr 1);
  B:= 0;
  i :=  0;
  while I < Length(HexStr) do begin
    J:= 0;
    while J < Length(HexSymbols) do begin
      if HexStr[I + 1] = HexSymbols[J + 1] then Break;
      Inc(J);
    end;
    if J = Length(HexSymbols) then ; // error
    if Odd(I) then
      Result[I shr 1]:= B shl 4 + J
    else
      B:= J;
    Inc(I);
  end;
  if Odd(I) then Result[I shr 1]:= B;
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-06T10:59:13.037

```
unit Unit1;

{$mode objfpc}{$H+}

interface

uses
  SysUtils, Forms, StdCtrls, ExtCtrls, Classes;

type

  { TTextToHex_HexToBin }

  TTextToHex_HexToBin = class(TForm)
    Button1: TButton;
    Edit1: TEdit;
    Edit2: TEdit;
    CheckTime: TImage;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Memo1: TMemo;
    procedure Button1Click(Sender: TObject);
    procedure CheckTimeClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  end;

var
  TextToHex_HexToBin: TTextToHex_HexToBin;

implementation

{$R *.lfm}

{ TTextToHex_HexToBin }

//hex to binary

function HextoBinary(const AHexStr: string):string;
var
  i, j: Integer;
const
  HexParts: array[0..$F] of string =
    (
    {0} '0000',{1} '0001',{2} '0010',{3} '0011',{4} '0100',{5} '0101',{6} '0110',{7} '0111',
    {8} '1000',{9} '1001',{A} '1010',{B} '1011',{C} '1100',{D} '1101',{E} '1110',{F} '1111'
     );

begin
SetLength(Result, 4 * AHexStr.Length);
  j := 1;
  for i := 1 to AHexStr.Length do
  begin
    case AHexStr[i] of
      '0'..'9':
        Move(HexParts[Ord(AHexStr[i]) - Ord('0')][1], Result[j], sizeof(char) * 4);
      'A'..'F':
        Move(HexParts[$A + Ord(AHexStr[i]) - Ord('A')][1], Result[j], sizeof(char) * 4);
      'a'..'f':
        Move(HexParts[$A + Ord(AHexStr[i]) - Ord('a')][1], Result[j], sizeof(char) * 4);
    else
      raise EConvertError.CreateFmt('Invalid hexadecimal string "%s".', [AHexStr]);
    end;
    Inc(j, 4);
  end;
end;

procedure TTextToHex_HexToBin.Button1Click(Sender: TObject);

var
  TB: TBytes;
  WS: WideString;
  S:  string;
  i:  Integer;

begin
  WS := Trim(Edit1.Caption);
  TB := WideBytesOf(WS);

  // WideString to Hexadecimal
  S := '';
  for i := Low(TB) to High(TB) do
    S := S + IntToHex(TB[i], -1);
  Edit2.Caption :=Trim(S);

  // Hex to Binary

    Memo1.Caption:= HextoBinary(Trim(S));
end;

procedure TTextToHex_HexToBin.CheckTimeClick(Sender: TObject);
begin

end;

procedure TTextToHex_HexToBin.FormCreate(Sender: TObject);
begin

end;

end. 
```

【结果如下图】

# variables - 按钮变量更改不起作用

> ID：12981315
> 
> 赞同：0
> 
> 时间：2012-10-19T19:39:39.393
> 
> 标签：variables, button, arduino

我用 Arduino 编程了几天，但遇到了一个烦人的问题。我的电路包含三个连接到引脚 2、3、4 的 LED 和一个连接到引脚 8 的按钮。我想要做的是通过按下按钮来交替点亮 LED。我正在使用一个变量来计算哪个 LED 在某个点点亮并在达到值 4 时重置。硬件部分工作正常，因为我已经单独测试过它（LED 和按钮示例程序的自动交替Arduino IDE），所以我的代码必须有一些东西。究竟是什么？

```
void setup(){
  pinMode(2, OUTPUT);
  pinMode(3, OUTPUT);
  pinMode(4, OUTPUT);
  pinMode(8, INPUT);

}

void loop(){
  int buton= digitalRead(8);
  int led = 1;

  if(led == 1){
    digitalWrite(2, HIGH);
    digitalWrite(3, LOW);
    digitalWrite(4, LOW);
  }
  if(led == 2){
    digitalWrite(2, LOW);
    digitalWrite(3, HIGH);
    digitalWrite(4, LOW);
  }
  if(led == 3){
    digitalWrite(2, LOW);
    digitalWrite(3, LOW);
    digitalWrite(4, HIGH);
  }  
  if(buton == HIGH){
    led++;
    if(led == 4) led = 1;
  }

} 
```

我知道它没有输入最后一个 if （按钮输入值的那个），因为我放置了一个 Serial.println() 来查看变量 led 的值和一个常量字符串，但它没有显示。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T07:36:02.930

Smilledge 在评论中是正确的，在循环的每次迭代中，led 变量都被重置为 1。我不知道你可以在两个函数（设置和循环）之外有变量声明，所以我只是将变量设为全局。

# android - 从服务器正确读取文本

> ID：12981320
> 
> 赞同：0
> 
> 时间：2012-10-19T19:40:06.567
> 
> 标签：android, text, flexbuilder, mobile-application

我已将我的脚本更新为下面提到的内容，但我仍然收到相同的语法错误......有什么建议吗？

```
<fx:Script>
<![CDATA[
    try {
        URL url = new URL("http://www.rwolfc.com/App/TRY.txt"){;
        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
        String str;
        while ((str = in.readLine()) != null) {
        }
        in.close();
    } catch (MalformedURLException e) {
    } catch (IOException e) {
    }
]]>

    </fx:Script> 
```

但是当我使用它时，我在 flex 中得到以下错误：

```
1071: Syntax error: expected a definition keyword (such as function) after attribute String, not str.
1073: Syntax error: expecting a catch or finally clause.
1084: Syntax error: expecting rightbrace before leftbrace. 
```

帮助！！？？！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:43:11.167

在以下行中，您没有将结果分配给变量

```
URL = new URL("http://www.rwolfc.com/App/TRY.txt"); 
```

它应该是

```
URL url = new URL("http://www.rwolfc.com/App/TRY.txt"); 
```

# android - 同时在多个模拟器上启动 Android 应用

> ID：12981324
> 
> 赞同：3
> 
> 时间：2012-10-19T19:40:14.697
> 
> 标签：android, testing, emulation

众所周知，Android 分辨率比较碎片化。

我（像许多其他人一样）没有所有屏幕分辨率或操作系统版本来测试我的应用程序。

模拟器为分辨率和操作系统问题提供了解决方案，但是在每个模拟器上运行我的应用程序（即使它们已经在运行）只是为了查看一个布局变得相当乏味和烦人。

所以，我的问题是；有什么方法可以在我选择的每个模拟器上运行我的应用程序，而不是单独执行它们？

目前，我正在使用一个名为 Manymo 的解决方案，它可以让我更快地启动模拟器，但我理想的解决方案是启动 1 个应用程序，并设置能够在多个模拟器上同时启动它的设置。

经过多次搜索，我很惊讶地看到，尽管人们询问是否要运行多个，但我似乎找不到任何愿意同时在多个实例中启动应用程序的人。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:45:52.540

一旦你的模拟器运行起来，我相信在*运行配置*控件中，你可以选择*在所有兼容设备/AVD 上启动*，然后从下拉列表中选择*活动 AVD 。*我相信这应该在您运行的所有模拟器上启动您的应用程序。但是，除非您在 RAM 中游泳，否则可能会对您的系统造成很大负担。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:47:42.677

我不确定这是否正是您想要的，但您甚至不需要启动模拟器来检查布局的外观。Eclipse 中的 ADT 插件允许您检查布局在不同版本和设备上的外观，而无需每次都启动每个模拟器。

图形布局，允许您选择设备、方向和 android OS 版本。

# php - PHP SQLite3Result::fetchArray 重新执行查询

> ID：12981332
> 
> 赞同：1
> 
> 时间：2012-10-19T19:40:33.213
> 
> 标签：php, sqlite

我在 PHP 中的 REGEXP 关键字上附加了一个函数，我发现 SQLite3Result::fetchArray 重新执行了查询！多么低效！

```
function _sqliteRegexp($pattern, $string)
{
    echo $pattern . ' - ' . $string . '<br/>';
    return preg_match('/' . $pattern . '/', $string);
}

$handle = new SQLite3($filename);
$handle->createFunction('regexp', '_sqliteRegexp', 2);

// (1)
$result = $handle->query("SELECT * FROM pages WHERE '" . $request_uri . "' REGEXP request LIMIT 1;");

// (2)
$result->fetchArray(); 
```

给予，例如：

```
(1)
\/ - /admin/settings/1
\/sqlite - /admin/settings/1
\/admin - /admin/settings/1
\/admin\/logout - /admin/settings/1
\/admin\/settings(\/[0-9]+)? - /admin/settings/1

(2)
\/ - /admin/settings/1
\/sqlite - /admin/settings/1
\/admin - /admin/settings/1
\/admin\/logout - /admin/settings/1
\/admin\/settings(\/[0-9]+)? - /admin/settings/1 
```

(1) 和 (2) 都以相同的方式回显模式和字符串。我高度怀疑查询被重新执行，这将是非常多余的。这是一个错误还是只是我仓促得出结论？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:22:28.847

查看[源代码](http://git.php.net/?p=php-src.git;a=blob;f=ext/sqlite3/sqlite3.c;hb=HEAD)显示`query`获取第一行只是为了确定结果是否为空。第一次调用`fetchArray`将再次执行查询。（效率如此之高。或副作用。）

如果您对不超过一排感兴趣，请[`querySingle`](http://php.net/manual/en/sqlite3.querysingle.php)改用。

回答你的问题：这按设计工作。这种设计是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T23:23:32.277

检查 Havalite 上的方法“sqlite_regExp”：[http ://www.havalite.com/?p=98](http://www.havalite.com/?p=98)

也适用于 LIMIT：

```
if($rows = sqlite_regExp("SELECT * FROM myTable WHERE preg_match('/sql(lite)*/ui', myRow) LIMIT 1")){
    foreach($rows as $row) echo $row[0];
} 
```

# c# - 如何使用 C# 将 *.fig 文件（来自 Matlab）转换为位图

> ID：12981333
> 
> 赞同：1
> 
> 时间：2012-10-19T19:40:32.907
> 
> 标签：c#, matlab, file-conversion

我`*.fig`在使用 C# 将文件（来自 Matlab）转换为位图（或我可以在 pictureBox 中使用的任何类型）时遇到问题。

我需要以某种方式读取此文件，然后将其显示在图片框中。

我尝试了几种方法，例如：

```
Image img = Image.FromFile(fileName);
Bitmap bmp1 = new Bitmap(img.Width, img.Height); 
```

但是我在第一步中抛出了“内存不足”异常。

你有什么想法怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:10:13.990

我有一个提议：

在您的窗体上放置一个面板，而不是图片框。然后，使用 System.Diagnostics.Process 启动 matlab 查看器（对此需要依赖，抱歉）。现在，您可以使用此处的说明获取查看器主窗口的窗口句柄：

[如何从进程ID获取主窗口句柄？](https://stackoverflow.com/questions/1888863/how-to-get-main-window-handle-from-process-id)

接下来，将其父级更改为 Windows 窗体中的面板。

[http://support.microsoft.com/kb/89563](http://support.microsoft.com/kb/89563)

我以前使用过这个技巧，它需要一些调整，但是您可以捕获另一个进程的主窗口并将其设置为表单上的子控件。如果你能找到一种不那么凌乱的方法，那就太好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:46:39.073

当图像文件的格式不正确时，也会发生内存不足异常。 [http://msdn.microsoft.com/en-us/library/stf701f5.aspx](http://msdn.microsoft.com/en-us/library/stf701f5.aspx)

您可能需要使用一些工具将 .fig 文件更改为图像格式。我不确定 Matlab 如何保存 .fig 文件，因此您需要对文件的实际存储方式进行一些研究，或者找到一些第三方软件将您的文件更新为可行的格式。

# jquery - 悬停在图像上，更改另一个图像 - 使用多个第一张图像

> ID：12981334
> 
> 赞同：1
> 
> 时间：2012-10-19T19:40:38.037
> 
> 标签：jquery, hover, jquery-hover

我正在尝试创建一个产品选择表，将鼠标悬停在颜色阴影上会更改主要产品图片（以匹配颜色。）

我在现有脚本中遇到的问题是，我无法让设置适用于仅影响一个目标图像的多个第一张图像。

```
/* Teaser image swap function */
    $('img.swap').hover(function () {
        this.src = '/images/signup_big_hover.png';
    }, function () {
        this.src = '/images/signup_big.png';
    }); 
```

我找到了这个脚本，但不确定如何将其转换为接受多个图像。

[我拥有的当前 HTML 的JS Fiddle](http://jsfiddle.net/Uc9ch/)。当表格中的一张图片悬停在上面时，下面的图片应该会相应地改变。

如果您想更好地了解我正在尝试创建的内容，可以[在此处](http://www.rubytuesdaycreative.co.uk/testsite/snood.html)访问实时站点。

我热衷的一个部分是不要将图像包含在链接中，因为这会在单击时导致令人讨厌的页面跳转（并且它们与表单一起工作，因此无法真正更改。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:46:23.557

我实际上有一个更简单的解决方案：

对于您想要换出的每个图像，只需将它们提供给它们`data-hover`，瞧 :)

```
<img src="normalLocation.jpg" data-hover="newLocation.jpg" /> 
```

JS：

```
// this code will do the rest for you
$('img[data-hover]').hover(function () {
    $(this).attr('tmp', $(this).attr('src')).attr('src', $(this).attr('data-hover')).attr('data-hover', $(this).attr('tmp')).removeAttr('tmp');

}).each(function () {
    $('<img />').attr('src', $(this).attr('data-hover'));
}); 
```

# c# - 负载均衡器后面的 WIF 应用程序实例

> ID：12981335
> 
> 赞同：2
> 
> 时间：2012-10-19T19:40:41.937
> 
> 标签：c#, asp.net, rsa, wif, adfs

我在负载均衡器后面有许多 WIF 应用程序实例，它们使用来自 STS 的声明。我使用了使用 aspnet_regiis.exe 生成的 RSA 密钥容器，并根据此[链接](http://social.technet.microsoft.com/wiki/contents/articles/1898.aspx#Q1)添加了事件处理程序，以使用 RSA 加密来拥有共享私钥而不是默认的 DPAPI 加密。我收到“签名无效。数据可能已被篡改”错误。

任何指针都会有所帮助。

编辑：添加身份模型部分

```
 <microsoft.identityModel>
        <service>
            <audienceUris>
                <add value="https://mysite.com" />
            </audienceUris>
            <federatedAuthentication>
                <wsFederation passiveRedirectEnabled="false" https://mysts.com/sts" realm="https://mysite.com requireHttps="false" />
                <cookieHandler requireSsl="false" />
            </federatedAuthentication>
            <applicationService>
                <claimTypeRequired>
                    <claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name" optional="false" />
                    <claimType type="http://schemas.microsoft.com/ws/2008/06/identity/claims/role" optional="false" />
                </claimTypeRequired>
            </applicationService>
            <issuerNameRegistry type="Microsoft.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
                <trustedIssuers>
                    <add thumbprint="40A1D2622BFBDAC80A38858AD8001E094547369B" name="CN=IdentityTKStsCert" />
                </trustedIssuers>
            </issuerNameRegistry> 
        </service>
    </microsoft.identityModel>

void OnServiceConfigurationCreated(object sender, ServiceConfigurationCreatedEventArgs e)
{
    CspParameters cp = new CspParameters();
    cp.KeyContainerName = "MyRsaKey";
    RSACryptoServiceProvider rcsp = new RSACryptoServiceProvider(cp);
    List<CookieTransform> sessionTransforms =
        new List<CookieTransform>(new CookieTransform[] {
        new DeflateCookieTransform(),
        new RsaEncryptionCookieTransform(rcsp),
        new RsaSignatureCookieTransform(rcsp) });
    SessionSecurityTokenHandler sessionHandler = new SessionSecurityTokenHandler(sessionTransforms.AsReadOnly());
    e.ServiceConfiguration.SecurityTokenHandlers.AddOrReplace(sessionHandler);
} 
```

# php - PHP exec 失败，状态 = 3

> ID：12981343
> 
> 赞同：0
> 
> 时间：2012-10-19T19:41:06.880
> 
> 标签：php

我有以下代码片段：

```
$app = '"' . getcwd() . "\\prog.exe" . '"';
exec("$app param1 param2", $output, $status); 
```

它在 EasyPHP-12.1 上本地运行良好，但是当我将它上传到部署服务器时，它以 $status==3 失败。我试着像这样省略路径：

```
exec("prog.exe param1 param2", $output, $status) 
```

同样，它在本地运行良好，但在服务器上失败。

你能想到我做错了什么吗？

# java - 无法从 NetBeans 或 Eclipse 中的 wsdl 生成代理类

> ID：12981345
> 
> 赞同：1
> 
> 时间：2012-10-19T19:41:12.087
> 
> 标签：java, eclipse, netbeans, netsuite

我在使用 NetBeans 7.2 为 NetSuite 生成代理类时遇到问题。

WSDL 的位置是[https://webservices.netsuite.com/wsdl/v2012_2_0/netsuite.wsdl](https://webservices.netsuite.com/wsdl/v2012_2_0/netsuite.wsdl)

添加引用该 WSDL 的新 Web 服务客户端时，我得到以下输出：

```
ant -f "\\\\network.local\\usersfolders\\roberth\\My Documents\\NetBeansProjects\\JavaApplication2" wsimport-client-netsuite
init:
wsimport-init:
Created dir: \\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2\build\generated-sources\jax-ws
wsimport-client-netsuite:
Created dir: \\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2\build\generated\jax-wsCache\netsuite
command line: wsimport -d "\\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2\build\generated\jax-wsCache\netsuite" -extension -Xnocompile -Xendorsed -keep -s "\\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2\build\generated\jax-wsCache\netsuite" -catalog "\\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2" -verbose "\\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2\xml-resources\web-service-references\netsuite\wsdl" -wsdllocation https://webservices.netsuite.com/wsdl/v2012_2_0/netsuite.wsdl
Missing WSDL_URI

Usage: wsimport [options] <WSDL_URI>
where [options] include:
  -b <path>                 specify jaxws/jaxb binding files or additional schemas
                            (Each <path> must have its own -b)

Examples:
  wsimport stock.wsdl -b stock.xml -b stock.xjb
  wsimport -d generated http://example.org/stock?wsdl

\\network.local\usersfolders\roberth\My Documents\NetBeansProjects\JavaApplication2\nbproject\jaxws-build.xml:22: wsimport failed
BUILD FAILED (total time: 0 seconds) 
```

我习惯于 C# 和导入服务参考（阅读我对 Java 中的 ANT 和 Web 服务的经验为零），并且不确定如何继续。谁能指出我正确的方向？

- 编辑 -

经过几次尝试，我能够在 Eclipse 中生成代理类，但是我发现有些类没有生成。进一步的研究发现，原因是我需要能够生成未引用的类型。NetSuite 文档说要在 ant 任务中添加以下内容：

或者作为替代添加 -w -a 到以下命令：`java –cp <classpath> org.apache.axis.wsdl.WSDL2Java <url>`

但是我通过命令尝试了选项 2`wsdl2java.bat -ss -sd -ap -uri https://webservices.netsuite.com/wsdl/v2012_2_0/netsuite.wsdl`并得到：

`Exception in thread "main" org.apache.axis2.wsdl.codegen.CodeGenerationException : org.apache.axis2.wsdl.codegen.CodeGenerationException: java.lang.RuntimeExcept ion: Element QName is null for ExceededRequestSizeFault! at org.apache.axis2.wsdl.codegen.CodeGenerationEngine.generate(CodeGener ationEngine.java:293)`

例外仍在继续，如果需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T12:33:56.407

我已经能够克服这个错误，但是如果我无法解决，可能会出现一个不同的错误，它可能会作为一个新问题发布。无论如何，为了解决这个问题，我必须执行以下操作：

*   安装最新的 Java 6 SDK，
*   将我的 AXIS_HOME 和 JAVA_HOME 环境变量设置为指向轴 1.4 和 Java 6 安装
*   重启
*   将 NetSuite 提供的 Ant Build.xml 和 NetSuite.preferences 文件复制到我的新项目中。
*   将 timeout="120000" 添加到
*   将 NetSuite.preferences 部分中的 wsdl.url 变量指向要构建的 WSDL 的位置。
*   构建蚂蚁项目。
*   注释掉位于 platform.common -> TransactionSearchRowBasic 和 TransactionSearchBasic 中的多参数构造函数（那些将错误抛出到许多参数的构造函数）
*   将生成的类复制到所需的路径结构。

希望这可以帮助任何尝试使用 NetSuite 测试 Java 的人......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T15:04:07.440

罗伯特，问题实际上是不同的。

如果您检查 WSDL 中的“getDataCenterUrls”操作：

```
 <operation name="getDataCenterUrls">
        <input name="getDataCenterUrlsRequest" message="tns:getDataCenterUrlsRequest"/>
        <output name="getDataCenterUrlsResponse" message="tns:getDataCenterUrlsResponse"/>
        <fault name="ExceededRequestSizeFault" message="tns:ExceededRequestSizeFault"/>
        <fault name="UnexpectedErrorFault" message="tns:UnexpectedErrorFault"/>
    </operation> 
```

这定义了 ExceededRequestSizeFault 但这没有在 getDataCenterUrls 的绑定部分中指定：

```
 <operation name="getDataCenterUrls">
        <soap:operation soapAction="getDataCenterUrls"/>
        <input name="getDataCenterUrlsRequest">
            <soap:header message="tns:headers" part="passport" use="literal"/>
            <soap:header message="tns:headers" part="applicationInfo" use="literal"/>
            <soap:header message="tns:headers" part="partnerInfo" use="literal"/>
            <soap:header message="tns:headers" part="preferences" use="literal"/>
            <soap:body use="literal"/>
        </input>
        <output name="getDataCenterUrlsResponse">
            <soap:header message="tns:headers" part="documentInfo" use="literal"/>
            <soap:body use="literal"/>
        </output>
        <fault name="UnexpectedErrorFault">
            <soap:fault name="UnexpectedErrorFault" use="literal"/>
        </fault>
    </operation> 
```

所以只需通过在 bindings 部分中添加 getDataCenterUrls 操作来修补 WSDL

# windows-8 - 如何在 Windows 商店应用程序中更改我的设置弹出窗口的背景颜色？

> ID：12981347
> 
> 赞同：1
> 
> 时间：2012-10-19T19:41:16.393
> 
> 标签：windows-8, winjs

我正在使用 HTML5/JS 构建我的应用程序，但由于某种原因 CSS 没有应用。我仍然看到默认颜色。按 windows+I 时我可以不覆盖它吗？

这是供参考的CSS：

```
.win-settingsflyout {
    background-color: #fff;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T03:27:15.097

您可以创建一个类来应用颜色。

```
<style>
.colors{background-color: lightblue;}
</style> 
```

然后将此类添加到您的 div 标签中。`<div class='win-content colors'></div>`

希望它会工作！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T21:02:33.350

你不能，你总是会得到你的开始屏幕的颜色

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T20:14:20.193

在我的“关于”弹出窗口的示例应用程序中。是背景是红色的。

```
<div class="win-content" style="background: red;"> 
```

完整代码：

```
<!doctype HTML>
<html>
    <head>
        <title>About</title>
        <script src="//Microsoft.WinJS.1.0/js/base.js" type="text/javascript"></script>
        <script src="//Microsoft.WinJS.1.0/js/ui.js" type="text/javascript"></script>
        <script type="text/javascript">WinJS.UI.processAll();</script>
        <script src="/js/about.js"></script>
        <link href="/css/about.css" rel="stylesheet" />
    </head>
    <body>
        <!-- BEGINSETTINGSFLYOUT -->
        <div class="apback" data-win-control="WinJS.UI.SettingsFlyout" aria-label="App Settings Flyout" data-win-options="{settingsCommandId:'about',width:'narrow'}">
            <!-- Use either 'win-ui-light' or 'win-ui-dark' depending on the contrast between the header title and background color -->
            <div class="win-ui-dark win-header" style="background-color: #333333"> <!-- Background color reflects app's personality -->
                <button type="button" onclick="WinJS.UI.SettingsFlyout.show()" class="win-backbutton"></button>
                <div class="win-label"><span data-win-res="{textContent: 'info'}"></span></div>
                <img src="../images/smalllogo.png" style="position: absolute; right: 40px;"/>
            </div>
        <div class="win-content" style="background: red;">
                <div class="win-settings-section">
                    <label>Test App</label>
                    <label>users</label>           

                 </div>
            </div>
        </div>
        <!-- ENDSETTINGSFLYOUT -->
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-20T20:52:28.973

您可以使用此 CSS 代码“推送”设置弹出背景颜色的更改：

```
.win-settingsflyout {
    background-color: #fff !important; background: #fff !important;
} 
```

# language-agnostic - 代码行也是文本行吗？

> ID：12981348
> 
> 赞同：0
> 
> 时间：2012-10-19T19:41:26.520
> 
> 标签：language-agnostic, lines-of-code

我知道这可能是一个愚蠢的问题，我对它们很困惑，因为我知道这个例子有 1 行代码和 2 行文本。

```
1\. System.out.print("-----------
2\. ----------------------------"}; 
```

我是对还是错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:03:24.827

对于 java，我通常将代码行定义为非文本分号和右括号的数量。

# c++ - 如何在 Windows 上限制进程的 CPU 使用率？

> ID：12981350
> 
> 赞同：4
> 
> 时间：2012-10-19T19:41:32.027
> 
> 标签：c++, window, cpu-usage

我需要将应用程序的 CPU 使用率控制在一定限度内。我的应用程序将在 Win XP、Vista、Win7 和 Windows 8 上运行。

我尝试实现获取当前进程的 CPU 使用率并使用 Sleep() 方法。（我使用了 API GetProcessTimes 和 GetSystemTimes）

伪代码：

```
 for(;;)
    {
         //Get the current process's CPU Usage
         int cpuUsage  = CalculateCPUUsage();
         if(cpuUsage > 50)
             Sleep(10)
         else
        {
           //Project implementation code
        }    
    } 
```

**问题：**

我可以编写一个应用程序来监控进程的 CPU 使用率，并且每当 CPU 达到允许的限制时，停止进程并继续它。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T04:41:57.303

如果你只是想给进程一个较低的优先级以便对其他线程更好，你可以使用 SetThreadPriority 设置它的优先级，例如：

```
SetThreadPriority(GetCurrentThread(), THREAD_PRIORITY_BELOW_NORMAL); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T04:23:27.500

您可以通过将感兴趣的进程添加到 Job 对象并限制 Job 对象来限制进程或任何其他进程的 CPU 使用率。

可以为 Job 对象配置的资源限制之一是 CPU 使用率：

*   [`JOBOBJECT_BASIC_LIMIT_INFORMATION`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684147.aspx)自 Windows XP 和 2003 起可用
*   [`JOBOBJECT_CPU_RATE_CONTROL_INFORMATION`](http://msdn.microsoft.com/en-us/library/windows/desktop/hh448384.aspx)Windows 8 和 Server 2012 中的新功能。

如果您必须使用 Windows 8 之前的方法，请注意以下注意事项：

> 要在超过此限制时注册通知而不终止进程，请将 SetInformationJobObject 函数与 JobObjectNotificationLimitInformation 信息类一起使用

# php - Codeigniter AND OR AND

> ID：12981351
> 
> 赞同：2
> 
> 时间：2012-10-19T19:41:38.547
> 
> 标签：php, mysql, codeigniter

可以这样做：（条件1 AND condition2）OR（condition3 AND condition4）在codigniter中？

我尝试：

```
$this->db->where(condition1 - condition2);
$this->db->or_where(condition3 - condition4); 
```

但这是： (condition1 AND condition2) OR (condition3 OR condition4)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:45:54.993

把它写在你的地方

```
$this->db->where("(condition1 AND condition2) OR (condition3 AND condition4)"); 
```

这仍然会转义数据，您不必使用 or_where 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-30T11:12:37.623

是的，有可能，为方便起见，将您想要使用的任何条件放入一个变量中

```
$where ="(condition 1 AND condition2) OR (condition3 AND condition4)";
$this->db->where($where); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T10:18:50.687

```
$first="(COND1 AND COND2)";
$second= "(COND3 AND COND4)";

$query=$this->db->where($first)->or_where($second)->get(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T07:24:48.867

你试过这样 ::::: 吗？

```
$this->db->where(COND1);
$this->db->where(COND2);
$this->db->or_where(COND3); 
$this->db->where(COND4); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T23:15:51.690

只需像这样使用普通查询：

```
$query="SELECT *
FROM table1 INNER JOIN table2 on table1.col=table2.col
WHERE (table1.whatever=? AND table1.hello=?) OR (table2.foo=? AND table2.pizza=?)
LIMIT 1";
$params=array();
$params[]='whatever';
$params[]='world';
$params[]='bar';
$params[]='cheese';

$result=$this->db->query($query,$params);
$result=$result->result_array();
print_r($result); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-24T17:35:20.930

如果您使用的是 PHP5，那么以下代码将解决您的问题。

```
$this->db->select("*")
->where("condition_1 && condition_2")
->or_where("condition_3 && condition_4"); 
```

或者使用下面的代码也可以。

```
$this->db->where("condition_1 ");
$this->db->where("condition_2");
$this->db->or_where("condition_3 "); 
$this->db->where("condition_4 "); 
```

# jquery - 切换到其包含的 div 后无法在文本区域内输入？

> ID：12981353
> 
> 赞同：0
> 
> 时间：2012-10-19T19:41:40.977
> 
> 标签：jquery

切换到包含 div 的 (id="center") 后，无法在 textarea 中输入内容？

这是代码...

```
 <div id="north">North</div>
 <div id="west">West</div>
 <div id="center"><textarea></textarea></div> 
```

脚本

```
$(document).ready(function() {
    var divs = ["north", "west", "center"];
    var startIndex = 0;
    $(document).keydown(function(e) {
        if (e.which == 9) {
            $("div").css("border", "");
            $("#" + divs[startIndex]).css("border", "4px solid gray");
            startIndex++;
            if (startIndex === divs.length) {
                startIndex = 0;
            }
        }
        return false;
    });
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:06:30.533

您在每次按键时都返回 false - 这会阻止您在 textarea 中输入

```
$(document).keydown(function(e) {
    if (e.which == 9) {
        $("div").css("border", "");
        $("#" + divs[startIndex]).css("border", "4px solid gray");
        startIndex++;
        if (startIndex === divs.length) {
            startIndex = 0;
        }
    }
    return false; // <--
}); 
```

如果要阻止默认选项卡行为，则应将其移动到`if (e.which == 9)`语句中

```
$(document).keydown(function(e) {
    if (e.which == 9) {
        $("div").css("border", "");
        $("#" + divs[startIndex]).css("border", "4px solid gray");
        startIndex++;
        if (startIndex === divs.length) {
            startIndex = 0;
        }
        return false; // <-- Move it here to prevent tab default behavior
    }        
}); 
```

或者，如果您不需要阻止 keydown 上的任何默认行为，则可以完全删除它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:51:08.070

您可以使用该`.preventDefault()`方法停止默认事件。

```
$(document).ready(function() {
    var divs = ["north", "west", "center"];
    var startIndex = 0;
    $(document).keydown(function(e) {
        if (e.which == 9) {
            e.preventDefault()
            $("div").css("border", "");
            $("#" + divs[startIndex]).css("border", "4px solid gray");
            startIndex++;
            if (startIndex === divs.length) {
                startIndex = 0;
            }
        }

    });
}); 
```

# php - 获取导致错误 500 的 cookie

> ID：12981354
> 
> 赞同：3
> 
> 时间：2012-10-19T19:41:51.733
> 
> 标签：php, google-chrome, cookies

我非常沮丧，因为我无法让它发挥作用。我已经尝试了几种不同的方法，并且从我读过的所有示例和代码中，这应该可以工作，但事实并非如此。

```
2012-10-19 19:24:04.533 192.168.1.62 "-" "WEBMATRIX" "-" 192.168.1.62 POST /Actions/NewTicket.php - 500 0 6149 688 45 -11640 "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4" "QCUserID=1" "http://192.168.1.62:53896/NewTicketPage.html" "-" "192.168.1.62:53896" 0 
```

WebMatrix/Actions/login.php <- 这行得通。我可以在 Chrome 的 cookie 中看到它。看起来它在日志错误中。

```
<?php 
//set vars
require_once(__DIR__ . "/GlobalCookies.php");

GC_ClearCookie("QCUserID");
$user = $_POST['username'];
$pass = $_POST['password'];

require_once(__DIR__ . "/db.php");

$query = sprintf("SELECT * FROM users WHERE UserInitials='%s' AND UserPassword='%s'", mysql_real_escape_string($user),mysql_real_escape_string($pass));
$result = mysql_query($query);
$rows = mysql_num_rows($result);

if($rows!=0)
{
    $row = mysql_fetch_row($result);
    GC_SetCookie("QCUserID", $row[0]);
    header("refresh:0;url=../DashboardPage.php");
}
else
{
    echo("User Not Found, redirecting to login page in 3 seconds");
    header("refresh:3;url=../index.php");
}

?> 
```

WebMatrix/Actions/GlobalCookies.php <- 奇怪的是它没有得到文件末尾的 ?> 。我没有查找如何做一个函数文件，我只是从 Mantisbt 复制了一些。但如果我有它并尝试在 login.php 中使用它，它会引发错误 500

```
<?php
function GC_GetCookie( $p_var_name, $p_default = null )
{
    if( isset( $_COOKIE[$p_var_name] ) )
    {
        $t_result = gpc_strip_slashes( $_COOKIE[$p_var_name] );
    }
    else if( func_num_args() > 1 )
    {
        //check for a default passed in (allowing null)
        $t_result = $p_default;
    }
    else
    {
        error_parameters( $p_var_name );
        trigger_error( ERROR_GPC_VAR_NOT_FOUND, ERROR );
    }

    return $t_result;
}
function GC_SetCookie($p_name, $p_value, $p_httponly = true)
{
    return setcookie( $p_name, $p_value, 36000, "/");
}
function GC_ClearCookie($p_name)
{
    return setcookie( $p_name, '', -1, "/" );
} 
```

WebMatrix/Actions/NewTicket.php <- 这失败了

```
<?php
error_reporting(-1);

require_once(__DIR__ . "/db.php");
require_once(__DIR__ . "/GlobalCookies.php");

$serial = $_POST['serialNumber'];
$model = $_POST['modelNumber'];
$company = $_POST['companyName'];
$special = $_POST['specialNote'];
$userID = GC_GetCookie("QCUserID",1); //Error 500 here
echo($userID."<br>");
?> 
```

这似乎是一件很简单的事情，但我已经尝试了几天......我在 Google 上的搜索结果一无所获。感谢您抽出宝贵时间....对于咯咯笑，我在另一台计算机上的 IE 中尝试过它，它的工作原理....奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:25:08.840

要设置您的 cookie，请尝试更改：

```
setcookie( $p_name, $p_value, 36000, "/"); 
```

到：

```
setcookie( $p_name, $p_value, time() + 36000, "/"); 
```

原因是过期参数是一个 Unix 时间戳，因此您必须将当前时间添加到您希望它过期的秒数。

您是否仅出于识别用户是否登录的目的使用此 cookie？如果是这样，作为其他用户登录所需要做的就是创建一个具有适当名称的 cookie，并在这种情况下选择一个随机用户 ID。

# c# - 传递逗号分隔数据的 Web 服务

> ID：12981361
> 
> 赞同：9
> 
> 时间：2012-10-19T19:42:18.380
> 
> 标签：c#, web-services, csv

我们即将开始 GPS 跟踪开发，使用 C# 和 Web 服务与硬件单元上的第三方 java'ish 接收器进行通信。

我们有处理车辆 GPS 单元到云交换的合同。我们需要将云集成到消费者集成中，以实现我们软件当前的实时跟踪视图部分。

我的任务是创建一种使用 Web 服务将数据中继到我们的应用程序的方法。最初，数据将由少数基本元素组成；lat、long、vehicleid 等。鉴于 GPS“实时”查看的性质，这需要尽可能快且带宽消耗小。

有人建议我使用一个简单地传递逗号分隔数据的 Web 服务。我一直找不到沿着这些方向的任何东西。

我对任何建议持开放态度，因为我是 C# 新手，因为我们的应用程序目前在 VB 中。这些是到目前为止给我的要求：

1.  快速地！
2.  低带宽消耗
3.  可通过以下技术消耗；ASP.NET、IOS、VB 和 VB.NET

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T19:48:39.573

JSON 将是一个不错的选择。它相对高效并且使用 WCF REST 或 MVC Web API 很容易实现。很多人还不足以记住逗号分隔文件的糟糕过去，但我会提醒你不要使用这种格式，主要是因为它既不标准化也不被主流组件支持。

CSV 乍一看似乎是一种简单的格式，因为它有一个非常简单的规范：只需用逗号分隔所有内容。但魔鬼在细节中，例如引用的字符串以及逗号和引号的转义。也许 CSV 的主要问题是人为因素问题：许多开发人员认为他们已经了解格式，因此他们倾向于以不同的方式做出转义和引用的决定。虽有[标准](https://www.rfc-editor.org/rfc/rfc4180)，但一般不遵守。[在 Wikipedia 上](http://en.wikipedia.org/wiki/Comma-separated_values)有一个关于缺乏标准化问题以及其他一些具体问题的有趣讨论。

JSON 是一种标准化格式，几乎没有解释空间（[日期表示有一些回旋余地](https://stackoverflow.com/questions/2652792/why-am-i-getting-same-values-of-different-json-date-values)）。如果您保持 JSON 属性名称简短，则可以实现与您在 CSV 文件中看到的接近的在线效率（如果您要向管理层展示，最好模拟 JSON vs . 带有实际开销数字的 CSV 有效负载）。您可以合理地确定，当客户端与您的服务通信时，他们将使用众所周知且经过良好测试的 JSON 解析器。最后，如果您的客户端平台需求中存在 IOS，那么期望在某些时候添加 HTML5 并不是没有道理的，而 JSON 自然是 HTML5 的一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:53:13.873

我认为[ASP .NET Web API](http://www.asp.net/web-api)是您最好的选择。

**1) 快！**：是的，但更多地取决于您的域逻辑性能。

**2）低带宽消耗：** 使用JSON有默认响应类型。

**3) 以下技术消耗品；ASP.NET、IOS、VB 和 VB.NET：** 又是 JSON。在所有上述技术中都很容易使用（为此目的有很多库）

如果您选择此选项，请查看[Apigee Web API Design 电子书](http://apigee.com/about/api-best-practices/all/ebook)。这是一个非常好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:55:19.383

听起来你想让它尽可能接近实时。我会考虑一种基于 WebSocket 的方法，以消除预定轮询的延迟。.NET 和 IOS 都支持 WebSocket，但我不知道经典的 VB。

# codeigniter - 在控制器之间传递用户 ID

> ID：12981363
> 
> 赞同：1
> 
> 时间：2012-10-19T19:42:37.483
> 
> 标签：codeigniter

专家们，

在codeigniter应用程序的控制器之间传递用户ID（用于查询用户信息的用户的系统内部ID）的推荐方法是什么？

我正在考虑以下选项： 1\. 使用 CI 会话 ID 在数据库中查询每个控制器中的用户 ID。这样我就不必将用户 ID 放在会话中，这是一个安全问题。但是这个选项意味着在每个控制器中都有一个额外的数据库查询 2\. 将用户 ID 直接存储在会话中，这样我就可以随时查询用户信息。

你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:58:19.167

根据我对 MVC 的理解，您通常不应该在两个控制器之间直接交谈。但是在这种情况下，我会使用会话。就安全性而言，codeigniter 有很多扩展来处理身份验证，例如[TankAuth](http://konyukhov.com/soft/tank_auth/)和[WolfAuth](http://codeigniter.com/forums/viewthread/180732/)，如果您担心的话，您可能会考虑其他许多扩展。但是在这种情况下，我会说使用会话来存储用户 ID 是非常好的，只要您不存储敏感数据。

您可以在此处阅读 CodeIgniter 会话：http: [//ellislab.com/codeigniter/user_guide/libraries/sessions.html](http://ellislab.com/codeigniter/user_guide/libraries/sessions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T04:10:01.150

有一个很棒的身份验证库 Ion Auth。一探究竟

[http://benedmunds.com/ion_auth/](http://benedmunds.com/ion_auth/)

# iphone - Facebook iOS SDK 3.1 - 发送私人消息

> ID：12981364
> 
> 赞同：0
> 
> 时间：2012-10-19T19:42:39.200
> 
> 标签：iphone, objective-c, ios, facebook-graph-api

我在我的 iphone 应用程序中使用 Facebook SDK v 3.1，我想让用户选择向另一个 Facebook 用户发送私人消息，在 Facebook 文档中找不到任何东西，也没有找到任何完整的在这里回答，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T10:21:57.770

从 Facebook iOS SDK 3.1 开始，这是不可能的。

# javascript - 有没有办法在 javascript 中反序列化 php 序列化字符串？

> ID：12981366
> 
> 赞同：0
> 
> 时间：2012-10-19T19:42:48.653
> 
> 标签：javascript

好吧，我得到了这个序列化的 PHP 字符串：`a:1:{s:10:"max_photos";i:10;}`有没有办法用 JavaScript 来反序列化它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:47:24.797

您可以使用[php.js](http://kvz.github.com/phpjs/)库，或者简单地复制相关部分，尽管您可能应该使用 Pekka 提到的 json_encode()。

# objective-c - 为什么 NSDateFormatter 将 NSString 日期值转换为 GMT？

> ID：12981369
> 
> 赞同：0
> 
> 时间：2012-10-19T19:43:07.967
> 
> 标签：objective-c, nsstring, nsdate, nsdateformatter

> **可能重复：**
> [NSDate / NSDateFormatter 在 iPhone iOS 4.3 上返回 GMT](https://stackoverflow.com/questions/7199807/nsdate-nsdateformatter-returning-gmt-on-iphone-ios-4-3)

执行以下代码时

```
NSString *inputDateString=@"2012-10-19 19:37:54";
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
NSDate *test=[formatter dateFromString:inputDateString]; 
```

“test”的值是 2012-10-19 23:37:54 +0000 而不是与 inputDateString 等效的日期值。为什么将日期转换为 GMT？

编辑：如何获取输入字符串日期并将其转换为等效的 NSDate 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:46:39.017

`NSDate`不存储时区，也不关心它们。`NSDate`仅存储自给定参考日期（2001 年 1 月 1 日）以来经过的时间。当您`NSDateFormatter`这样使用时，它将假定日期的时区在将字符串转换为日期对象时与用户当前的时区匹配，但是，当您使用`NSLog`检查日期时，它没有任何时区信息。但请记住，日期仍然正确且等于输入值。

# android - 在 openstreetmap 中检索 maxspeed 标记

> ID：12981372
> 
> 赞同：2
> 
> 时间：2012-10-19T19:43:12.943
> 
> 标签：android, openstreetmap

我想创建一个 android 应用程序，如果我超过速度限制，它会警告我，我想在 openstreetmaps 中使用 maxspeed 标签，但是当我使用 API 获取数据时，我找不到 speedmax 标签，但它就在那里当我在站点中查找该位置时。有没有其他方法可以检索每条道路的最大速度限制以在我的应用程序中使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-12T16:16:33.660

您正在搜索 maxspeed=* 标签[http://wiki.openstreetmap.org/wiki/Key:maxspeed](http://wiki.openstreetmap.org/wiki/Key:maxspeed)（在右侧边栏上查询 taginfo）

此外，您的任务有不同的解决方案：

1.  向现有地图创建者询问帮助/数据（在 OSM Wiki 中查找“地图”）
2.  [为Overpass API](http://wiki.openstreetmap.org/wiki/Overpass_API)创建查询可能对 Overpass Turbo 有帮助
3.  使用渗透和适当的过滤器表达式自行过滤 OSM Planet 提取物

请记住，处理 OSM 数据可能很困难，例如速度单位取决于国家/地区，与未标记道路的默认值相同。

PS它被称为OpenStreetMap（没有-s）；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-19T10:31:58.277

[http://www.overpass-api.de/api/xapi](http://www.overpass-api.de/api/xapi)？*[最大速度=* ][bbox=31.454403,30.082119,31.454266,30.082093]

只需在同一条道路上使用两个点（LAN/LAT）即可获取道路详细信息

# android - 带有 CursorLoader 和 SimpleCursorAdapter 的 ListView 不显示数据

> ID：12981373
> 
> 赞同：2
> 
> 时间：2012-10-19T19:43:16.033
> 
> 标签：android

我正在尝试使用 CursorLoader 使用来自查询的数据填充 ListView。我是 CursorLoaders 的新手，我正在使用从开始 Android 4 应用程序开发中窃取的代码。如您所见，我正在从 Intent 获取数据。Intent 中的数据就是我想要的；我已经在调试器中验证了这一点。但是，当我查询我的数据库时，ListView 中没有显示任何内容。任何人都可以帮忙吗？

```
public class MyList extends ListActivity implements LoaderManager.LoaderCallbacks<Cursor> {

private static final String TABLE_BASEPATH = "tbl";
private static final String AUTHORITY = "SQLData";
public static final Uri MY_URI = Uri.parse("content://" + AUTHORITY + "/" + TABLE_BASEPATH);    

@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Intent myData = getIntent();
    Bundle info = myData.getExtras();

    if (info != null){
        Cursor c;
        String[] dataColumns = { "mycolumn" };
        String selection = "level = '" + info.getString("Level") + "'";

        if (android.os.Build.VERSION.SDK_INT < 11)
            c = managedQuery(MY_URI, dataColumns, selection, null, "ORDER BY mycolumn");
        else
        {
            CursorLoader cursorloader = new CursorLoader(this, MY_URI, dataColumns, selection, null, "ORDER BY mycolumn");
            c = cursorloader.loadInBackground();
        }

        int[] viewIDs = { R.id.mylist1 };
        SimpleCursorAdapter adapter;

        if (android.os.Build.VERSION.SDK_INT < 11)
            adapter = new SimpleCursorAdapter(this, R.layout.mylist, c, dataColumns, viewIDs);
        else
            adapter = new SimpleCursorAdapter(this, R.layout.mylist, c, dataColumns, viewIDs, CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);

        this.setListAdapter(adapter);
    }
}

public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    return new CursorLoader(this, MY_URI,
            PROJECTION, null, null, null);  
}

public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {
    switch (loader.getId()) {
      case LOADER_ID:
        mAdapter.swapCursor(cursor);
        break;
    }

}

public void onLoaderReset(Loader<Cursor> loader) {
    mAdapter.swapCursor(null);

} 
```

我使用的是光标还是 CursorLoader 都没有关系。如果我的版本 < 11（光标），我没有数据；如果它 > 11 (CursorLoader) 我仍然没有得到任何数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T08:21:32.900

使用 ContentProvider 时，您需要在投影中放入 id 列，否则它们“将不起作用”。我认为您正在做的 > api 级别 11...

```
String[] dataColumns = { "mycolumn" }; 
```

上面的代码应该包含 id 字段。如果 id 字段是“_id”（如 Sams 回答）：

```
String[] dataColumns = { "mycolumn", "_id" }; 
```

# playframework - PlayFramework securesocial 和 Lighttpd 错误

> ID：12981374
> 
> 赞同：1
> 
> 时间：2012-10-19T19:43:16.990
> 
> 标签：playframework, playframework-2.0, lighttpd, securesocial

我正在使用带有 PlayFramework2 的 SecureSocial 模块。我还使用 lighttpd 作为代理来为 Play Framework 启用 SSL。这就是问题。当我使用 Google OAuth2 登录时，Play Framework 向 google 发送了一个重定向 URL：

[http://devportal.sample.com:8443/authenticate/google](http://devportal.sample.com:8443/authenticate/google)

因为我现在对我需要的所有通信强制使用 SSL：

[https://devportal.sample.com:8443/authenticate/google](https://devportal.sample.com:8443/authenticate/google)

这是来自 Google 的重定向错误：

错误：redirect_uri_mismatch 请求中的重定向 URI：[http](http://devportal.sample.com:8443/authenticate/google) ://devportal.sample.com:8443/authenticate/google与注册的重定向 URI 不匹配

有任何想法吗？

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:01:15.917

我添加了一个拉取请求，我认为它可以解决你玩游戏时出现的问题！使用 SecureSocial 的应用程序位于 HTTP 反向代理之后。正在为我工​​作，我目前正在使用 Apache。

[https://github.com/jaliss/securesocial/pull/88](https://github.com/jaliss/securesocial/pull/88)

# xcode - 设备上的 Cocos2d 2.x ARC 问题

> ID：12981379
> 
> 赞同：1
> 
> 时间：2012-10-19T19:43:32.130
> 
> 标签：xcode, cocos2d-iphone, automatic-ref-counting, linker-errors, mach-o

我正在开发一款带有 ARC 的 cocos2d 的游戏。游戏在模拟器中构建和运行良好，但是当我为设备构建时，我`Apple Mac-O Linker Errors`说我缺少 libcocos2d.a 等库。

```
clang: error: no such file or directory: '/Users/aleksandartrpeski/Library/Developer/Xcode/DerivedData/jellyfish-fsomqwhqasishxcfzhgvccrdvzpt/Build/Products/Debug-iphoneos/libcocos2d.a'
clang: error: no such file or directory: '/Users/aleksandartrpeski/Library/Developer/Xcode/DerivedData/jellyfish-fsomqwhqasishxcfzhgvccrdvzpt/Build/Products/Debug-iphoneos/libCocosDenshion.a'
clang: error: no such file or directory: '/Users/aleksandartrpeski/Library/Developer/Xcode/DerivedData/jellyfish-fsomqwhqasishxcfzhgvccrdvzpt/Build/Products/Debug-iphoneos/libkazmath.a'
clang: error: no such file or directory: '/Users/aleksandartrpeski/Library/Developer/Xcode/DerivedData/jellyfish-fsomqwhqasishxcfzhgvccrdvzpt/Build/Products/Debug-iphoneos/liblibpng.a' 
```

当我转到文件丢失的文件夹时，我只看到 jellyfish.app。

我在这类问题上没有太多经验，我不清楚为什么会这样，我检查了如何从 TinyTimGames 和 LearnCocos2D 启动项目，仍然不清楚我做错了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-21T16:12:10.730

我已经解决了这个问题，XCode 以某种方式忽略了二进制文件的构建，因为它们是针对另一个架构的，通过将 cocos2d 目标的构建设置设置为`Build For Active Architectures Only`，`NO`问题消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:57:22.053

听起来您必须将这些库添加到 Link Binary With Libraries 构建阶段。

有关详细信息，请参阅我[的关于为 Cocos2D 项目启用 ARC 的教程](http://www.learn-cocos2d.com/2012/04/enabling-arc-cocos2d-project-howto-stepbystep-tutorialguide/)。

奇怪的是，它适用于模拟器，因为它使用的是相同的目标。我不排除设备不兼容，您必须至少拥有运行 iOS 4.0 或更高版本的第三代 (iPhone 3GS) 设备。

# xml - 合并两个xml文件并删除重复元素

> ID：12981381
> 
> 赞同：0
> 
> 时间：2012-10-19T19:43:41.603
> 
> 标签：xml, xslt

我想连接两个 xml 文件，同时使用 xsl 删除具有重复名称的条目（即使值不同）。请参阅示例文件。非常感谢你的帮助。

文件1.xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<archive>
  <entry>
    <name>xxx</name>
    <value>123</value>
  </entry>
  <entry>
    <name>yyy</name>
    <value>456</value>
  </entry>
  <entry>
    <name>zzz</name>
    <value>789</value>
  </entry>
</archive> 
```

文件2.xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<archive>
  <entry>
    <name>xxx</name>
    <value>2468</value>
  </entry>
  <entry>
    <name>ttt</name>
    <value>13579</value>
  </entry>
</archive> 
```

生成的文件应如下所示：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<archive>
  <entry>
    <name>xxx</name>
    <value>123</value>
  </entry>
  <entry>
    <name>yyy</name>
    <value>456</value>
  </entry>
  <entry>
    <name>zzz</name>
    <value>789</value>
  </entry>
  <entry>
    <name>ttt</name>
    <value>13579</value>
  </entry>
</archive> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:16:39.243

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pDoc1" select="document('file:///c:/temp/delete/file1.xml')"/>
 <xsl:param name="pDoc2" select="document('file:///c:/temp/delete/file2.xml')"/>

 <xsl:template match="/">
  <xsl:apply-templates select="$pDoc1/*"/>
 </xsl:template>

 <xsl:template match="/*">
  <archive>
   <xsl:copy-of select="node()"/>
   <xsl:copy-of select="$pDoc2/*/entry[not(name = current()/*/name)]"/>
  </archive>
 </xsl:template>
</xsl:stylesheet> 
```

当应用于任何 XML 文档（未使用）并具有包含此内容的文件（如提供）时：

c:\temp\delete\file1.xml

```
<archive>
  <entry>
    <name>xxx</name>
    <value>123</value>
  </entry>
  <entry>
    <name>yyy</name>
    <value>456</value>
  </entry>
  <entry>
    <name>zzz</name>
    <value>789</value>
  </entry>
</archive> 
```

c:\temp\delete\file2.xml

```
<archive>
  <entry>
    <name>xxx</name>
    <value>2468</value>
  </entry>
  <entry>
    <name>ttt</name>
    <value>13579</value>
  </entry>
</archive> 
```

**产生想要的正确结果**：

```
<archive>
   <entry>
      <name>xxx</name>
      <value>123</value>
   </entry>
   <entry>
      <name>yyy</name>
      <value>456</value>
   </entry>
   <entry>
      <name>zzz</name>
      <value>789</value>
   </entry>
   <entry>
      <name>ttt</name>
      <value>13579</value>
   </entry>
</archive> 
```

# python - Python numpy 数组奇怪的返回

> ID：12981383
> 
> 赞同：0
> 
> 时间：2012-10-19T19:43:49.003
> 
> 标签：python, arrays, numpy

我对python比较陌生。我有一个具有 3 个维度的 numpy 数组。我知道我们只能使用`:`.

当我从一个小值开始时，它似乎工作得很好，但在某一时刻，它返回的东西与矩阵不同。

我想获得数组的平均值。因此，例如，给定一个数组`c`，我会这样做`numpy.mean(c[0:200][0:200][0:200])`。这工作得很好。但是增加起点（即`c[200:][200:][200:]`）不起作用并返回`nan`。因此，打印结果解释了 nan 值。但我不明白为什么会`c[200:][200:][200:]`返回这种答案。

这里有两个例子：

```
In [68]: c.shape
Out[68]: (448, 433, 446)

In [63]: c[100:][100:][100:]
Out[63]: 
array([[[ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        ..., 
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],

       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        ..., 
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],

       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        ..., 
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],

       ..., 
       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        ..., 
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],

       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        ..., 
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],

       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        ..., 
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.],
        [ 0.,  0.,  0., ...,  0.,  0.,  0.]]])

In [67]: c[200:][200:][200:]
Out[67]: array([], shape=(0, 433, 446), dtype=float64) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T19:47:35.377

您对数组的索引不正确。在多个维度上建立索引的方法是`array[x, y, z]`，不是`array[x][y][z]`。所以你想做`c[200:, 200:, 200:]`。

当您在括号中使用单个索引时，它会索引到第一个维度。因此，当您这样做时`c[200:][200:][200:]`，您每次都尝试沿第一个维度获取数组的前 200 个元素。但是那个维度的长度不到 600 个元素，所以当你这样做 3 次时，就没有什么可得到的了。

# javascript - 在 Express 中包含库或外部样式表

> ID：12981387
> 
> 赞同：0
> 
> 时间：2012-10-19T19:44:13.753
> 
> 标签：javascript, html, node.js, express

我正在节点服务器上使用 express 框架构建一个待办事项应用程序...我有一个 index.ejs 文件作为我的应用程序的起点，当我尝试包含jquery 文件为

```
<script src="jquery.min.js" type="text/javascript"></script> 
```

我的应用程序无法加载它，当我在我的 chrome 中看到它寻找的网络时

```
https://localhost:3000/jquery.min.js
```

我如何加载文件？

PS：我习惯于通过**cloud.google.com**加载脚本，方法是将 url 放在 src 标签中，但我希望我的应用程序通过这种方法加载得更快

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:05:26.160

您应该为静态文件创建一个 ./public 文件夹。

将此行添加到您的 app.js 的所有路线上方：

```
 app.use(express.static(path.join(__dirname, 'public'))); 
```

然后在 index.ejs 中使用它：

```
<script src="/jquery.min.js"></script> 
```

# actionscript-3 - As3 字体嵌入

> ID：12981388
> 
> 赞同：6
> 
> 时间：2012-10-19T19:44:14.727
> 
> 标签：actionscript-3, fonts, flash, embedding

我已经看到很多与 Flash 中的字体嵌入相关的问题，但我似乎无法找到我的问题的答案。

我从字体 swf 加载字体并在高级别注册它们，以便它们可以在子 swf 中使用。问题是子 swf 也可能嵌入这些字体，但没有明确地嵌入，这意味着它们只是嵌入，因为子 swf 中有使用字体的某些字符的字段。这意味着子项中的文本字段使用不完整的嵌入字体，而不是在父项或任何级别的祖父项中注册的嵌入完整集。这也意味着可能成为这个孩子的孩子的 swfs 不会获得完整的字体。

我的问题：有什么方法可以在编译时告诉 flash 在任何情况下都不要将字体嵌入到 swf 中？如果没有，是否有从编译的 swf 中删除嵌入字体的工具？

到目前为止，这是我考虑过/注意到的一些事情：

*   似乎每个 Font 类都与一个 ApplicationDomain 相关联。（确认这一点会有所帮助）
*   在文本字段上使用设备字体不会导致嵌入任何字体。（但对我来说不是一个选项，因为我需要这些字段在运行时从父 swf 嵌入字体。）
*   我找不到注销字体或简单地告诉加载的子 swf 使用父字体的方法，这对于应用到加载的子 swf 很有用。
*   可以将子项加载到不同的上下文中，这将允许字体的父定义覆盖子定义。（或者会有两个定义，如果有，哪个优先？）
*   从子库中加载资源并将它们添加到舞台将获得字体的父定义。（这是有道理的，因为资产是在子域之外创建的）
*   一个可能的解决方案可能是不向文本字段添加任何字符以编译 swf，但这也不是一个真正的选项，因为我需要使用任何字体的静态文本。

我已经开始对我脑海中可能不正确的问题进行定义，因此，如有必要，请退后几步，让我对问题有不同的看法。到目前为止，我上面提出的问题似乎是正确的问题，如果有解决方案，我所有的问题都会消失。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:11:58.127

原来这是我的 Flash Professional 版本的一个错误。我进行了更新，现在可以使用运行时共享字体。我可能会将共享字体指向字体的错误 url，然后字体将来自父应用程序域，因为它们没有编译到子 swfs 中。我现在使用的是 Flash Professional CS5.5 11.5.1。我使用的是 CS5.5 11.5.0。

[http://forums.adobe.com/message/3926344](http://forums.adobe.com/message/3926344)

感谢 Adob​​e 浪费我的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:07:53.147

如果我的理解是正确的，那么您是否想删除/注销所有作为已加载但嵌入另一个 swf 的特定字体版本不完整的字体？

嵌入的每个字体都会创建一个类，通过 Loader 类加载的每个 swf 默认情况下都加载到其自己的应用程序域中，以防止命名空间冲突，但您可以使用 »loader 强制加载器将所有内容加载到当前应用程序域中Loader 的 load() 方法的 context« 参数。因此，您可以尝试强制在同一命名空间中相互覆盖类，但是您无法控制要丢弃的类，这意味着您无法检查哪种字体具有更多字形。（也许它只是抛出错误而不是覆盖并且根本不运行，我对此不太确定）。

另一方面，您应该质疑字体实际上是如何嵌入到孩子的 swf 文件中的。除了将字体嵌入为：

在 *.fla 文件中作为»库符号«，或者在 flashbuilder 或 flex 的代码中，如下所示： `[Embed(source="c:/windows/fonts/verdana.ttf", fontFamily="Verdana", embedAsCFF="false")]`,

或这个：

```
@font-face {
    src: url("../assets/MyriadWebPro.ttf");
    fontFamily: myFontFamily;
    advancedAntiAliasing: true;
} 
```

在 mxml 文件中。所以（这就是我猜的）生成的类的结果名称取决于开发人员给出的»font-family«属性（甚至更多设置），这意味着即使相同的字体嵌入了类的两倍 -名称可能因设置而异。

也没有`Font.unregisterFont()`方法，所以如何管理这仍然是一个好问题，以防万一你可能会以某种方式找到相同的 Font 类（也许 RegExp 成为一个友好的助手）。

我认为要正确解决此问题，您需要在编译时进行控制，使用基于 xml 的 *.xfl 项目文件可能会有所帮助，但即使引用的字体文件可以具有不同的名称。

好问题，祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:13:23.943

我在使用 Flash 字体时遇到了很多问题。在不同浏览器以不同方式呈现的 html 上，这仍然是一个问题。

无论如何，对于 flash，我构建了这个对我有很大帮助的工具包。检查如何自定义字体。如果您执行这些步骤，我很确定问题将得到解决。

[https://github.com/tbwa/AS3-Toolkit/tree/master/src/com/utils/text](https://github.com/tbwa/AS3-Toolkit/tree/master/src/com/utils/text)

# php - CentOS Server 如何保持 PHP Socket Server 运行？

> ID：12981390
> 
> 赞同：0
> 
> 时间：2012-10-19T19:44:16.803
> 
> 标签：php

我已经尝试了 nohup php socket.php & 并且服务器确实启动并在 ssh 窗口关闭后保持启动。但是当我稍后回来时，它不再运行了。我怎样才能保持这个运行？

# c# - 片段文件损坏

> ID：12981393
> 
> 赞同：0
> 
> 时间：2012-10-19T19:44:29.420
> 
> 标签：c#, visual-studio-2008

当试图覆盖基类方法时，我现在收到一个错误，因为代码片段管理器不知道如何处理它。

![在此处输入图像描述](../Images/323cadff0373cb6fc297e6877b4f84aa.png)

我在网上查看了[这个 msdn 链接](http://social.msdn.microsoft.com/Forums/en-US/csharpide/thread/1d2ebf54-c0fd-4502-a257-ed96243119ea/)，它建议检查`Method Override Stub`xml 文件是否已损坏。

我已经确定文件：`C:\Program Files\Microsoft Visual Studio 9.0\VC#\Snippets\1033\Refactoring\MethodOverrideStub.snippet`确实已损坏。

**我在哪里可以买到新的？**

我可能必须重新安装 VS，但如果有另一种方式 - 即，有人可以在[github:gist](https://gist.github.com/)或此处发布他们的 xml 文件副本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:07:11.567

您应该运行安装程序并选择“修复”选项。

我建议这样做，因为您可能有更多损坏的文件。

# javascript - 使用 jquery 从 Telerik ddl 中选择一个值

> ID：12981394
> 
> 赞同：-1
> 
> 时间：2012-10-19T19:44:30.637
> 
> 标签：javascript, jquery, asp.net-mvc, telerik

有没有办法使用 jquery 从telerik ddl 中选择一个值？

这是我的 Telerik DDL：

```
 <%= Html.Telerik().DropDownList().Name("Quarter")
           .Items(items => {
            items.Add().Text("").Value("");
            items.Add().Text("Quarter1").Value("Quarter1");
            items.Add().Text("Quarter2").Value("Quarter2");
            items.Add().Text("Quarter3").Value("Quarter3");
            items.Add().Text("Quarter4").Value("Quarter4");
                })%> 
```

我正在尝试以下方式，但它没有填充列表：

```
$("#Quarter").val("Quarter2"); 
```

选择值后为 Telerik DDL 呈现的 HTML：

```
<div tabIndex="0" class="t-widget t-dropdown t-header" id="Quarter" style="width: 104px;" jQuery15103337264984743067="21" value="Quarter2">
  <div class="t-dropdown-wrap t-state-default">
    <span class="t-input">
      Text - Quarter 2
    <span class="t-select">
      <span class="t-icon t-arrow-down">
  <input name="Quarter" id="Quarter" style="display: none;" type="text"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:54:43.090

[http://www.telerik.com/help/aspnet/combobox/combo_client_model.html](http://www.telerik.com/help/aspnet/combobox/combo_client_model.html)

我认为问题在于 Telerik 甚至没有可以使用的隐藏项`<select>`（这`.val()`就是您通常选择值的方式），因此您必须使用他们的（咳嗽）愚蠢的方法来做到这一点。我绝对讨厌将任何后端 .NET 代码放在前端 JS 中

看起来像 Telerik 你必须做类似的事情：

**FindItemByValue**：返回第一个 RadComboBoxItem 对象，其 Value 属性等于传递的参数。

```
// Also it doesn't look like your giving your DDL an ID
var combo = <%=RadComboBox1.ClientID %>; // ClientID being whatever your ID is

combo.FindItemByValue("Quarter2");
// or
combo.SetValue("Quarter2"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T12:48:57.193

试试这个：

```
var value = $('#Quarter').data('tDropDownList').value(); 
```

# ruby-on-rails - “显示”操作的不可预测的路由错误

> ID：12981398
> 
> 赞同：0
> 
> 时间：2012-10-19T19:44:37.953
> 
> 标签：ruby-on-rails, ruby-on-rails-3

> **可能重复：**
> [最近的项目 - 路由错误](https://stackoverflow.com/questions/12982083/recent-item-routing-error)

我在我的 rails 应用程序中遇到了一个非常奇怪的行为。基本上，用户可以上传照片（使用carrierwave，基本的脚手架生成的表格）。这些照片的模型称为`user_photo`。这是我的路由文件：

**路由.rb**

```
Myapp::Application.routes.draw do
  #...

  match 'profiles/:profile_id/photos' => 'user_photos#index_profile', :as => :profile_user_photos
  match 'user_photos/vote/:id'   => 'user_photos#vote',       :as => :user_photo_vote
  resources :user_photos do
    resources :comments
  end

  #...
end 
```

现在，当我尝试使用以下 URL 模式访问用户上传的一些照片时：

```
http://localhost:3000/user_photos/31 (this is just an example) 
```

我收到此错误：

> 没有路线匹配 {:action=>"show", :controller=>"user_photos", :id=>nil}

奇怪的是，一些 user_photos 工作，这是完全不可预测的！我不确定是什么可能导致了这个错误，所以我只发布了我的路由文件（因为这是我想到的第一件事）。如果您有任何想法或需要更多信息来了解正在发生的事情，请告诉我。提前致谢。

* * *

### 编辑：

好吧，其实是可以预见的。只有最后上传的 user_photo 不起作用，当我将上传下一张时，上一张不起作用的开始起作用。有任何想法吗？

此线程在此处继续：[最近的项目 - 路由错误](https://stackoverflow.com/questions/12982083/recent-item-routing-error)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:53:52.817

试用：

```
Myapp::Application.routes.draw do
  #...

  match 'profiles/:profile_id/photos' => 'user_photos#index_profile', :as => :profile_user_photos
  resources :user_photos do
    get :vote, :on => :member
    resources :comments
  end

  #...
end 
```

该线路`get :vote, :on => :member`将生成`/user_photos/:id/vote`您可以调用的路线`like_user_photo_path(any_user_photo)`

# c# - Application.Restart 不好吗？

> ID：12981402
> 
> 赞同：13
> 
> 时间：2012-10-19T19:44:52.473
> 
> 标签：c#, .net, vb.net, winforms

我有一个 .Net windows 窗体应用程序，其中在 Main_Load 事件中初始化了很多变量，我有一种情况，我希望重新查询我的数据库并将所有变量设置为 null 并重新初始化（基本上是 100% 的形式从一开始就重新加载），但是我以这样的方式（我的错）编写了我的 Main-Load ，这并不容易做到......

我知道我可以通过简单的调用得到我*想要*`Application.Restart`的东西，而且效果*很好*，但我不确定这是好的编程实践还是被认为真的很糟糕。

`Application.Restart`在这种情况下使用可能会遇到任何问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T20:02:20.170

对调试不友好，但它并没有什么真正的问题。这与终止应用程序并重新启动它完全相同。

您可以通过简单地创建主窗体的新实例并关闭旧实例来避免它。但是，这确实需要您阻止程序退出。代码[在这里](https://stackoverflow.com/questions/10769193/c-sharp-working-with-mutliple-forms/10769349#10769349)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:47:33.193

不是方法不行；相反，很多时候程序员忘记了他们在他们的代码中添加了一些东西来阻止应用程序自动关闭或启动。

请关注此[主题](https://stackoverflow.com/questions/95098/why-is-application-restart-not-reliable)

你也可以用

```
 System.Diagnostics.Process.Start(Application.ExecutablePath);
 Application.Exit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:27:30.193

要直接回答标题中的问题，是的，重新启动应用程序以重新初始化变量是不好的做法。

在某些情况下，重新启动应用程序很有用（例如自我更新），但`ReInitialize()`在我看来，重新启动以模仿方法是不好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-19T16:15:42.590

我有这个问题。

当用户注销时，我真的需要重新启动一个大型 Winforms 应用程序，以确保清除所有缓存的（我的）数据。

**通过将Application.restart()**添加到**Application Shutdown Event**解决了我的问题。

这适用于 VS 环境和运行 EXE 时

如果您想查找该事件，请选择您的主要项目属性，然后从应用程序（侧选项卡）中选择底部的查看应用程序事件。

我的猜测是这行得通，因为它在关闭过程中已经很晚了。希望这对某人有所帮助，更重要的是，它继续有效。

# vb.net - 使用函数 EndsWith() 选择案例

> ID：12981405
> 
> 赞同：0
> 
> 时间：2012-10-19T19:45:08.377
> 
> 标签：vb.net, select-case

下面的代码有效，但我不禁想到有更好的方法来做到这一点。有没有人在将函数与 Select 语句结合使用方面有经验。
我希望工作的代码将是类似的东西......

```
Select Case File.EndsWith()
Case "example 1", Case "example2" 
```

此代码有效：

```
Select Case File.EndsWith(File)
    Case tFile.EndsWith("FileA.doc")
        sbExisting.AppendLine(Report.sbStart.ToString)
        sbExisting.AppendLine(Report.sbHeaders.ToString)
        sbExisting.AppendLine(Report.sbItems.ToString)
        sbExisting.AppendLine(Report.sbSubreport.ToString)
        sbExisting.AppendLine(Report.sbEnd.ToString)
        sbExisting.AppendLine(Report.sbCol.ToString)
    Case tFile.EndsWith("FileB.doc")
        'Slave
        sbExisting.AppendLine(Report.sbStart.ToString)
        sbExisting.AppendLine(Report.sbItems.ToString)
        sbExisting.AppendLine(Report.sbHeaders.ToString)
        sbExisting.AppendLine(Report.sbCol.ToString)
        sbExisting.AppendLine(Report.sbEnd.ToString)
End Select 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:48:58.137

`.EndsWith()`返回真或假。这就是你所拥有的。

如果您确实想使用`Select`它，那么惯用的方式是

```
Select Case True
    Case tFile.EndsWith("MSMaster.tmp")
        ...
    Case tFile.EndsWith("MSSlave.tmp")
        ...
End Select 
```

在同一行上有多个选择不会有太大区别：

```
Select Case True
    Case tFile.EndsWith("example 1"), tFile.EndsWith("example 2")
        ...
    Case tFile.EndsWith("example 3"), tFile.EndsWith("example 4")
        ...
End Select 
```

如果您已经在数组/列表/集合中有一个选项列表，您也可以使用

```
Dim choices1 = New String() {"example 1", "example 2"}
Dim choices2 = New String() {"example 3", "example 4"}

Select Case True
    Case choices1.Any(Function(s) tFile.EndsWith(s))
        ...
    Case choices2.Any(Function(s) tFile.EndsWith(s))
        ...
End Select 
```

或者，如果您愿意，也可以执行相同的内联：

```
Select Case True
    Case (New String() {"example 1", "example 2"}).Any(Function(s) tFile.EndsWith(s))
        ...
    Case (New String() {"example 3", "example 4"}).Any(Function(s) tFile.EndsWith(s))
        ...
End Select 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:49:16.353

两种情况之间的唯一区别是`sbSubreport`项目的附加。这是唯一需要特殊检查的项目，可以像下面这样完成

```
Dim master = tFile.EndsWith("MSMaster.tmp")
Dim slave = tFile.EndsWith("MSSlave.tmp")
If master OrElse slave Then
    sbExisting.AppendLine(Report.sbStart.ToString)
    sbExisting.AppendLine(Report.sbHeaders.ToString)
    sbExisting.AppendLine(Report.sbItems.ToString)
    If master Then
        sbExisting.AppendLine(Report.sbSubreport.ToString)
    End If
    sbExisting.AppendLine(Report.sbEnd.ToString)
    sbExisting.AppendLine(Report.sbCol.ToString)
End If 
```

# sql - 在 access 2007 中实现替换变量

> ID：12981408
> 
> 赞同：1
> 
> 时间：2012-10-19T19:45:14.083
> 
> 标签：sql, database, ms-access-2007

有没有办法我可以在 access 2007 中使用替换变量，我编写了一个查询，返回其中包含单词 okeu 的行，但我想使用替换变量，以便我可以检索我想要的任何单词，如果我想要的单词是不在那里我想弹出一条消息说它`word not there` 更容易在 oracle sqlplus 中执行但我如何将它应用到使用 sql 查询的访问中？任何想法，提前谢谢

这是我在访问中创建的 sql

```
SELECT MENU.NAME_REC, MENU.C_REC, AUTO.C_GROUP
FROM MENU, AUTO
WHERE (((MENU.NAME_REC)="okeu")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:16:36.190

你可以，它被称为[参数查询](http://office.microsoft.com/en-us/access-help/using-parameters-with-queries-and-reports-HA001117077.aspx)。有不同的方法来实现这一点 - 有时您可能只想提示输入搜索词（如本文中的示例所示）。其他时候，特别是如果您正在构建一个表单以从最终用户那里收集信息，您会希望让参数引用表单上的控件，而不是在调用查询时提示输入值。在不知道您的确切实施目标的情况下，很难推荐适合您情况的最佳策略，但这至少可以帮助您入门。

# asp.net - 如何将旧密码迁移到 SimpleMembership

> ID：12981411
> 
> 赞同：1
> 
> 时间：2012-10-19T19:45:32.443
> 
> 标签：asp.net, asp.net-mvc, simplemembership

我有一个在 MVC4 中重建的遗留系统。我了解如何将 SimpleMembership 连接到我的“用户”表，但我不确定如何将现有密码导入到 pages_Membership 表中（特别是关于密码编码）。

如何将旧密码迁移到新的 SimpleMembership '方式'？如果可能的话，我想通过 SQL 代码来完成这一切。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:45:41.533

这就是我要做的：

我将在我的“用户”表中添加一个“临时密码”列。在通过标准成员查找 ( ) 登录失败时`WebSecurity.Login()`，我将在“用户”表上执行额外的查找，以将“用户名”和“临时密码”与输入的凭据匹配。如果我在那里找到匹配项，那么我将使用 WebSecurity 方法来创建适当的成员记录，包括角色。创建成功后，我将删除临时密码。

# svn - 为什么 svn authz 默认需要读权限？

> ID：12981417
> 
> 赞同：2
> 
> 时间：2012-10-19T19:45:52.730
> 
> 标签：svn, mod-dav-svn, authz

我需要为用户授予对一个存储库的读/写访问权限。

为什么这不起作用？

```
[groups]
dev = dvolosnykh,sam

[/ukk]
ukk = rw

[/]
@dev = rw 
```

我为什么要添加这个？

```
[/]
@dev = rw
* = r # read access for everyone. Why? 
```

我正在使用 dav_svn、apache2、Linux Ubuntu 服务器 11.04

我的 dav_svn.conf：

```
<Location /svn>

  DAV svn

  SVNParentPath /var/svn
  SVNListParentPath On

  AuthType Basic
  AuthName "Subversion Repository"
  AuthUserFile /etc/apache2/dav_svn.passwd
  AuthzSVNAccessFile /etc/apache2/dav_svn.authz

  Require valid-user

</Location> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T07:23:17.333

默认情况下，没有人可以访问存储库。这意味着您可能希望至少向存储库根目录中的所有用户授予读取权限。您可以使用星号变量 (*) 来执行此操作，这表示“所有用户”：

```
[/]
* = r 
```

这是一个常见的设置；请注意，节名称中没有提到存储库名称。这使得所有存储库对所有用户都可读。一旦所有用户都具有对存储库的读取权限，您就可以向特定用户授予对特定存储库中特定子目录的显式 rw 权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:19:18.260

您应该在下面这样配置：

```
[<repo_name>:<path-in-repo>] 
```

例子 ：

```
[osirisProject:/] 
```

`@grp_W = rw`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-22T20:49:25.570

检查 conf/svnserve.conf 的行

```
# anon-access = read
# auth-access = write 
```

这些是匿名用户和经过身份验证的用户的默认设置，但您可以取消注释并将它们更改为读取、写入或无。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T20:39:20.893

好吧，您可以（并且确实必须）拥有完全有效的 dav_svn.authz 文件

```
[groups]
dev = dvolosnykh,sam

[/ukk]
@dev = rw

[/]
* = 
```

重读authz-file格式^ section-name为路径，access操作数左边为object（用户或组），右边为access-type，空为NONE

# java - Android http post高级请求与主机上的正文

> ID：12981419
> 
> 赞同：1
> 
> 时间：2012-10-19T19:45:55.223
> 
> 标签：java, android, http-post

我想从主机上的虚拟 android 设备发出 HTTP 发布请求。下面你会看到一张关于我如何使用旧 WebFetch 工具发布的图片。

1.  我不知道使用什么 URL 来调用主机？

2.  我不知道我的正文字符串如何用作输入？

![在此处输入图像描述](../Images/021ee1f4fed903403667ba4d7b7310f0.png)

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:57:52.307

如果要连接到运行 Android 模拟器的计算机，请使用 IP 地址 10.0.2.2。[你可以在这里](http://developer.android.com/tools/devices/emulator.html#networkaddresses)阅读更多关于它的信息。

另请查看以下问题中接受的答案，以了解如何将 json 作为发布数据发送：

[如何使用 HTTPClient 以 JSON 格式发送 POST 请求？](https://stackoverflow.com/questions/6218143/android-post-json-using-http)

您可以使用以下代码发出 HTTP 获取请求：

```
try {
        HttpClient client = new DefaultHttpClient();  
        String getURL = "http://10.0.2.2:port/your_path_with_parameter";
        HttpGet get = new HttpGet(getURL);
        HttpResponse responseGet = client.execute(get);  
        HttpEntity resEntityGet = responseGet.getEntity();  
        if (resEntityGet != null) {  
                    //do something with the response
                    Log.i("GET RESPONSE",EntityUtils.toString(resEntityGet));
                }
} catch (Exception e) {
    e.printStackTrace();
} 
```

# d3.js - 根据缩放级别操作地图以隐藏和显示元素

> ID：12981426
> 
> 赞同：1
> 
> 时间：2012-10-19T19:46:13.770
> 
> 标签：d3.js

免责声明：我是绝对的 d3.js n00b。我开始精通 JavaScript，但是 d3.js 让我有点头疼。

我有一个我想做的项目，与[The Art of Asking](http://www.theartofasking.com)非常相似。我有很多数据要显示 - 我必须深入到一些国家的议会/国会区级别，而不仅仅是省或州 - 并且尝试加载所有 SVG 元素会杀死一些低端计算机一直在测试项目。如果我不爆炸任何计算机，我宁愿它。（实际上，我很确定不爆炸计算机是我的项目的要求。）

为了解决这个问题，我认为像 The Art of Asking 这样的隐藏/显示机制是阻力最小的路径，但是虽然我可以弄清楚如何隐藏一个元素，但我不知道如何在它之后显示它被隐藏了。我认为创建一个像可折叠树一样的地图与我想做的类似，但我也可能完全走错了方向。

# mocking - Dart 模拟 HTML 库

> ID：12981429
> 
> 赞同：4
> 
> 时间：2012-10-19T19:46:24.080
> 
> 标签：mocking, dart

我有一个 Dart 类，我想对其进行单元测试，并且我想模拟对 dart:html 库的调用，以确保我的类的行为符合预期。我已经查看了[Mocking with Dart](http://www.dartlang.org/articles/mocking-with-dart/)的文章，但它没有提到如何模拟 HTML 库。有人有建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T11:14:18.673

这并不容易实现，因为**dart:html**库不是无头的（即它需要浏览器）。我通常会尝试遵循 MVP 设计模式，以确保与 DOM 交互的代码仅在我的视图类中，并且所有业务逻辑都在演示器中。这样我就可以对演示者进行单元测试，而无需访问 DOM API。下面是一个小例子。

```
// view interface has no reference to dart:html
abstract class View {
   hello();
}

// view impl uses dart:html but hands of all logic to the presenter
class ViewImpl implements View {
   View(this._presenter) {
      var link = new Element.html("<a href="">a link</a>");
      link.on.click.add(_presenter.onClick());
      body.nodes.add(link);
   }

   hello() {
      body.nodes.add(new Element.html("<p>Hello from presenter</p>");
   }

   Presenter _presenter;
}

// presenter acts on the View interface and can therefor be tested with a mock.
class Presenter {
  Presenter(this._view);

  onClick() => _view.hello();

  View _view;
} 
```

# database - DynamoDB NoSQL 中的属性地址数据库设计

> ID：12981432
> 
> 赞同：2
> 
> 时间：2012-10-19T19:46:34.050
> 
> 标签：database, nosql

我们拥有数 TB 的地址数据，并且正在研究将其存储在 DynamoDB NoSQL 数据库中的可能性。总的来说，我已经阅读了大量有关 DynamoDB 和 NoSQL 的文章，但是我来自多年的 MS SQL 并且正在为一些 NoSQL 概念而苦苦挣扎。

在这一点上我最大的问题是如何设置表结构，以便我可以适应查询数据的各种不同方式。例如，在常规 SQL 中，我希望有一些查询，例如：

WHERE Address LIKE '%maple st%' AND ZipCode = 12345

WHERE Address LIKE '%poplar ln%' AND City = 'Los Angeles' AND St​​ate = 'CA'

WHERE OwnerName LIKE '%smith%' AND CountyFIPS = '00239'

这些只是例子。实际查询可以是这些不同字段的任意组合。

我不清楚我的索引应该是什么样子或表（或表）应该如何构造。谁能让我开始了解它是如何工作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T15:26:43.597

帖子比较老了，但我会尽量给你一个答案（也许对以后遇到类似问题的人有帮助）。

DynamoDB 并不是真的要以您描述的方式使用。它的优势在于快速（实际上是快速）查找键/值对。以 IP 地址为例，如果您想真正快速地查找与 IP 地址相关的信息，您可以轻松地将 HashKey 设置为带有 IP 地址的字符串并使用它来进行查找。

当您想在 dynamoDb 中进行查询（或扫描）时，事情开始变得复杂，您可以在此处阅读它们：[DynamDB 中的查询和扫描](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/QueryAndScan.html)

要点是，当不在 HaskKey 或 HaskKey+RangeKey 组合（范围键基本上是复合键）上执行时，扫描/查询非常昂贵。

换句话说，我不确定 DynamoDb 是否是正确的选择。对于吸烟快速搜索功能，我会考虑使用类似[Lucene](http://lucene.apache.org/core/)的东西。如果您明智地配置索引，您会惊讶于它的运行速度。

希望这可以帮助。

编辑：似乎亚马逊现在增加了对二级索引的支持： [见这里](http://aws.typepad.com/aws/2013/04/local-secondary-indexes-for-amazon-dynamodb.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-21T01:07:54.473

> DynamoDB 旨在以作者描述的问题的方式使用，请参阅此[链接](https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/bp-sort-keys.html)，其中 AWS 文档描述了创建这样的二级索引

```
[country]#[region]#[state]#[county]#[city]#[neighborhood] 
```

根据您要查找的内容，分区键也可能是这样的。

在 DynamoDB 中，您在创建表之前创建连接。这意味着您必须考虑您打算搜索数据、创建索引以及使用它们查询数据的所有方式。

AWS 创建了[AWS noSQL WorkBench](https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/workbench.html)来帮助团队做到这一点。在撰写本文时，该应用程序中存在一些 UI 错误；有关错误的更多信息，请参阅[链接](https://stackoverflow.com/questions/62768971/dynamodb-nosql-workbench-test-table-not-visible/67578311#67578311)。

为了查看您提到的一些查询，我将分享一些您可以创建索引来创建该查询的可能性。

> **注意：** noSQL 在某些情况下意味着非规范化数据，但不一定。

应该如何塑造键是有限制的，以便 dynamoDB 可以对实际服务器进行分区以进行扩展；有关详细信息，请参阅[分区键](https://aws.amazon.com/blogs/database/choosing-the-right-dynamodb-partition-key/)。

dynamoDB 的魔力是一个经过深思熟虑的模型，它还可以在创建表并在生产中使用后处理新查询。网上有很多帖子和视频解释了如何做到这一点。

这是一个与 Rick Houlihan 的[链接](https://www.youtube.com/watch?v=Xn12QSNa4RE&t=1293s)。Rick Houlihan 是 DynamoDB 的主要设计师，所以去那里寻求福音。

要进行您尝试的查询，可以创建多个键，主要是初始分区键和辅助键。Rick 建议让它们像 PK 和 SK 一样通用。

然后尝试用大量唯一性来塑造 PK，例如邮政编码 PK：“12345”的分区键可能包含大量数据，可能超过任何分区键限制的 10GB 配额。

> 示例 1：WHERE Address LIKE '%maple st%' AND ZipCode = 12345

例如 1，我们可以形成一个 PK 的分区键：“12345:maple” 然后调用“12345:maple”的 PK 将检索所有具有该邮政编码以及枫树街道的数据。会有许多不同的 PK，而这正是 dynamoDB 擅长的：水平扩展。

> 示例 2：WHERE Address LIKE '%poplar ln%' AND City = 'Los Angeles' AND St​​ate = 'CA'

在示例 2 中，我们可以使用二级索引添加另一种更具体的方式，例如 PK: "12345:poplar" SK: "losangeles:ca:other:info:that:helps"

> 示例 3：WHERE OwnerName LIKE '%smith%' AND CountyFIPS = '00239'

例如 3，我们没有街道名称。我们需要知道街道名称来查询数据，但我们可能在搜索中没有它。这是一个人需要完全理解他们的基本查询模式并塑造 PK 在查询时很容易知道的地方，同时仍然非常独特，这样我们就不会超出分区限制。拥有街道名称可能不是最佳选择，这完全取决于需要什么查询。

In this last example, it may be more appropriate to add some global secondary indices, which just means making new primary key and secondary keys that map to data attribute (column) like CountyFIPS.

# java - 集群 java 独立应用程序

> ID：12981433
> 
> 赞同：2
> 
> 时间：2012-10-19T19:46:34.440
> 
> 标签：java, parallel-processing

我正在开发一个读取大文件（500 Mo）、反序列化这些文件（protobuf 消息 - Google api）并将其插入到 oracle 11 DB 的 java 独立应用程序。

要说的重要一点是数据库中有一个主表，还有几个小表（可以与字典进行比较）。对于所有词典，我都有一个 Google 缓存（Guava）。主表没有缓存。在主表中只有插入，没有更新，没有删除。

目前，该应用程序运行在单个 JVM 上。（可能，我可以添加多线程。）

我想让它在几个JVM上工作。我的问题是知道该怎么做才能获得更高的性能并使其正常工作。我发现了两个问题：如果集群应用程序允许我同时读取多个文件，如何更快地插入主表，以及如何更新缓存？

有人对此有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:53:38.253

> 如何更快地插入主表

大奖！您必须确定瓶颈，并且很可能是读取文件或数据库。文件很简单，只需将它们拆分并放在不同的机器上。当然，在同一台机器上运行多个 JVM 无济于事，因为它们都会竞争 I/O。因此，您必须拆分文件并将它们与 JVM 一起分发到多台机器上。

我认为反序列化 protobuf 不是瓶颈，它需要一些 CPU，但不需要那么多。

最后你有一个数据库。单个单线程 JVM 可能可以充分利用数据库，但值得一试。首先让你的应用程序多线程，看看它是否有帮助。

> 如何更新缓存？

再次中奖。您还必须分发/集群您的缓存。Guava 缓存是不够的，你需要更复杂的东西，比如 RMI 集群 EhCache、Terracotta 或 Hazelcast。基本上，它们提供缓存 API，但会通知集群的其他成员缓存已更改并需要失效。

BTW 500 MiB 真的没有那么多，处理需要多长时间？同样，您必须剖析以找出使您放慢速度的原因。

# c# - 抽象类和虚方法：不能访问某些变量

> ID：12981437
> 
> 赞同：2
> 
> 时间：2012-10-19T19:46:40.803
> 
> 标签：c#

我正在使用抽象类和虚拟方法。目前我有一个由按钮单击和两个多行文本框组成的窗口窗体，我在其中显示结果。基类有一个默认构造函数和一个接受基类所需的所有必要数据的构造函数。有两个类`Trees`，`Tomatoes`它们有一个默认构造函数和一个传递所有数据的构造函数。我能够在 textBox1 中显示item`name`和.`number in stock``price`

但是，我无法调用和显示`Trees`名为的高度变量以及名为`tree_height`and 的每个平台变量的大小和`Tomatoes`西红柿。它给了我错误不包含这些变量的定义。我该如何解决？`tomatoes_perplat``tomatoes_size`

**代码**

```
namespace plant_shop
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        public abstract class Plants
        {
            public string the_name;
            public double num_stock;
            public double price_peritem;
            public double total_item_value;

            public Plants(string new_name, int new_stock, double new_price)
            {
                the_name = new_name;
                num_stock = new_stock;
                price_peritem = new_price;
            }

            public override string ToString()
            {
                return "";
            }

            public virtual double Get_Value()
            {
                double s = 0;
                return s;
            }

        }

        public class Trees : Plants
        {
            double tree_height;
            public Trees(string new_name, int new_stock, double new_price, double new_height)
                : base(new_name, new_stock, new_price)
            {
                tree_height = new_height;
                total_item_value = num_stock * price_peritem;
            }

            public override string ToString()
            {
                string s = "Tree" + "     " + num_stock + "      " +  the_name + "     " + price_peritem + "    " + tree_height ;
                return s;
            }

            public override double Get_Value()
            {
                total_item_value = num_stock * price_peritem;
                return total_item_value;
            }

        }

        public class Tomatoes : Plants
        {

            string sizeoftomato;
            int tomatoesinpat;

            public Tomatoes(string new_name, int new_stock, double new_price, int tomatoes_perplat, string tomatoes_size)
                : base(new_name, new_stock, new_price)
            {
                tomatoesinpat = tomatoes_perplat;
                sizeoftomato = tomatoes_size;  
                total_item_value = num_stock * price_peritem; 
            }

            public override string ToString()
            {
                string s = "Tomatoes" + "     " + num_stock + "      " + the_name + "     " + price_peritem;
                return s;
            }

            public override double Get_Value()
            {

                total_item_value = num_stock * price_peritem;
                return total_item_value;
            }
        }

        public void Report()
        {

             Trees trees1 = new Trees("Oak", 3, 14.40, 2);
             const string format = "{0,-26} {1,-25} {2,-25} {3,-25}";
             string trees1_result = String.Format(format, "Tree", trees1.the_name, trees1.num_stock, trees1.price_peritem, trees1.tree_height); //not showing `tree_height`            
             textBox1.AppendText(trees1_result + Environment.NewLine);
             textBox2.AppendText(trees1.Get_Value() + Environment.NewLine);            

             Tomatoes tomatoes1 = new Tomatoes("Big Boy", 30, 10, 12, "Large");
             const string format2 = "{0,-26} {1,-25} {2,-25} {3,-25}";
             string tomatoes1_result = String.Format(format2, "Tomatoe", tomatoes1.the_name, tomatoes1.num_stock, tomatoes1.price_peritem, tomatoes1.tomatoes_perplat, tomatoes1.tomatoes_size); //not showing `tomatoes_perplat` or `tomatoes_size`
             textBox1.AppendText(tomatoes1_result + Environment.NewLine);
             textBox2.AppendText(tomatoes1.Get_Value() + Environment.NewLine);

        }

        private void button1_Click(object sender, EventArgs e)
        {
            Report();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:53:38.160

好的，现在我已经编译了一些代码，它更清晰了......

您无法访问`trees1.tree_height`，因为它在`Trees`类中是私有的，并且您正在尝试从`Form1`类中的方法访问它。

您无法`tomatos_perplat`从该方法访问，因为类中没有这样的变量`Tomatoes`- 有`tomatoesinpat`，但这也是私有的。

同上`tomatoes_size`- 该字段被称为`sizeoftomato`，并且是私有的。

将您的字段保密是一个*好*主意 - 我不建议将它们公开。相反，您应该公开[*属性*](http://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx)以公开类之间的数据。您可以使用[自动实现的属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)作为实现非常简单的属性的简单方法。

不过，我*强烈*建议您在您的组织中工作：

*   不要对所有东西都使用嵌套类；它们偶尔会很方便，但通常最好有单独的顶级课程

*   阅读[.NET 命名约定](http://msdn.microsoft.com/en-us/library/vstudio/ms229045.aspx)并遵循它们

*   想想你的方法试图达到什么目的——像你的`Get_Value`方法这样的东西目前毫无意义

*   我会*敦促*您尝试使用控制台应用程序。它们不像 GUI 那样“令人兴奋”，但*更*容易理解和试验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:52:04.097

您在类中定义没有指定[访问修饰符的](http://msdn.microsoft.com/en-us/library/wxh6fsc7%28v=vs.71%29.aspx)[字段](http://msdn.microsoft.com/en-us/library/ms173118%28v=vs.80%29.aspx)。默认情况下，这些字段将是私有的。

您应该使用[公共属性](http://msdn.microsoft.com/en-us/library/aa288470%28v=vs.71%29.aspx)来公开这些字段。您还应该考虑[自动实现的属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:53:34.870

这将解决它：

```
public string sizeoftomato;             
public int tomatoesinpat; 
```

默认情况下，这些字段是*私有的。*

请注意，字段通常不适合您正在做的事情。你真的想要属性：

```
public string SizeOfTomato { get; set; }
public int TomatoesInPlant { get; set; } 
```

# sql - Oracle 数组“包含”函数

> ID：12981441
> 
> 赞同：0
> 
> 时间：2012-10-19T19:47:11.727
> 
> 标签：sql, arrays, oracle

我想将主键列表存储到同一张表中的其他记录。然后我希望能够执行类似于以下内容的选择：

`SELECT * FROM mytable WHERE myarraycol CONTAINS '123'`

我已经看到 Oracle 有一个[数组数据类型](http://psoug.org/definition/ARRAY.htm)。但是，看起来 EXISTS 函数仅验证元素是否存在于指定索引处。有没有办法验证给定变量是否在单个 SQL 查询中的数组数据类型列中？

作为使用数组数据类型的替代方法，我尝试将 PK 存储为逗号分隔的字符串，例如“123,324,543,23432”。然后我的查询看起来像：

`SELECT * FROM mytable WHERE mystringcol LIKE '%123%'`

如果我想要其中包含 PK '123' 的所有记录。这个问题（以及许多其他问题）是，如果另一个记录的值是“432,9912399,432”，则该记录将显示，因为“9912399”中的“123”。

我可以使用“LIKE”和字符串解决此问题的一种方法是让我的 where 子句为：

`WHERE mystringcol LIKE '%,123,% OR mystringcol LIKE '%123, OR mystringcol LIKE '%,123`

测试“123”是否在整个字符串的中间、开头或结尾，但这开始变得丑陋，我宁愿不这样做。

以前有没有人做过这样的事情并且可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:19:53.500

从理论上讲，Oracle 具有用于收集的 MEMBER OF 功能，但对于第 3 范式，您的想法看起来很奇怪。

```
SQL> CREATE OR REPLACE PROCEDURE member_of_example AS
  2    TYPE nestedTableType IS TABLE OF VARCHAR2(10);
  3    myTable1 nestedTableType;
  4    result BOOLEAN;
  5  BEGIN
  6    myTable1 := nestedTableType('F', 'G', 'S');
  7    result := 'George' MEMBER OF myTable1;
  8    IF result THEN
  9      DBMS_OUTPUT.PUT_LINE('''George'' is a member');
 10    END IF;
 11  END member_of_example;
 12  / 
```

从逗号分隔的内容中获取 plsql 表的函数示例：

```
CREATE OR REPLACE function Str2NmbTbl(p_str varchar2) return number_table is
l_col number_table := number_table();
l_pos number;
l_cnt number := 1;
l_num number;
begin     
    l_pos := instr(p_str, '[', l_cnt);
    while l_pos > 0 loop       
        l_num := to_number(substr(p_str, l_pos + 1, instr(p_str, ']', 1, l_cnt) - l_pos - 1));
        l_col.extend;

        l_col(l_cnt) := l_num;
        l_cnt := l_cnt + 1;
        l_pos := instr(p_str, '[', l_pos + 1);
    end loop;  

    return l_col;
end;
/

with s as
(select 1 id, '[11412][21][3131][3333]'    str from dual union all
 select 2 id, '[64376][553]'               str from dual union all
 select 3 id, '[5943][74621][19][3333][0]' str from dual union all
 select 4 id, '[21593][22321][43][094]'    str from dual --union all
)
select id, Str2NmbTbl(str) collctn
from s; 
```

# java - 为不同的 appWidgets 获取不同的 sharedpreferences

> ID：12981442
> 
> 赞同：0
> 
> 时间：2012-10-19T19:47:11.850
> 
> 标签：java, android, configuration, android-widget, sharedpreferences

> **可能重复：**
> [添加几个具有不同配置的 appWidget？](https://stackoverflow.com/questions/12962524/add-several-appwidgets-with-different-configuration)

我有一个小部件，它显示一个简单的文本视图，可以在配置活动中作为编辑文本字段进行编辑。我正在尝试使用不同的文本配置 fx 将几个小部件添加到主屏幕。一个小部件显示：“买一盏灯..”，另一个小部件显示：“我爱培根”。

我的问题是小部件一直显示相同的文本，如果我编辑一个小部件，另一个小部件也会发生变化。我正在使用 sharedpreferences 来保存输入的数据以供以后重新配置。（我没有使用 PreferenceActivity）

我已经为此苦苦挣扎了几个小时，任何帮助将不胜感激。

为什么这不起作用：

```
SharedPreferences sp;
EditText info;
String note;
int appWidgetId;

private void loadPrefs(){
        sp = context.getSharedPreferences("widget" + String.valueOf(appWidgetId)
              , Context.MODE_PRIVATE);
        note = sp.getString("Note", "");

        info.setText(note);

    }

    private void savePrefs(String key, String value){
        sp = context.getSharedPreferences("widget" + String.valueOf(appWidgetId)
                  , Context.MODE_PRIVATE);
        SharedPreferences.Editor editor = sp.edit();
        editor.clear();
        editor.putString("Note", info.getText().toString());
        editor.commit();   

    } 
```

然后我有一个确认按钮来结束配置，它调用 savePrefs 方法

```
public void onClick(View v) {
        // TODO Auto-generated method stub

        savePrefs("Note", info.getText().toString()); 
```

完整代码配置活动代码：

```
import java.io.File;
import android.app.Activity;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.text.Spannable;
import android.text.style.StyleSpan;
import android.util.TypedValue;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RemoteViews;
import android.widget.Spinner;
import android.widget.ToggleButton;

public class WidgetConfig extends Activity implements OnClickListener, OnItemSelectedListener {

    AppWidgetManager awm;
    int awID;
    Context context;
    EditText info;
    Button b;
    String note;
    int styleStart = -1, cursorLoc = 0;
    int appWidgetId;
    SharedPreferences sp;
    Spinner spinner;
    String[] paths = { "10", "20", "30" };
    File path = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.widgetconfig);

        context = WidgetConfig.this;
        info = (EditText)findViewById(R.id.etwidgetconfig);

            ...

        b = (Button)findViewById(R.id.bwidgetconfig);
        loadPrefs();
        b.setOnClickListener(this);

        //Getting Info about the widget that launched this activity
        Intent i = getIntent();
        Bundle extras = i.getExtras();
        if (extras != null){
            awID = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,
            AppWidgetManager.INVALID_APPWIDGET_ID );
        }

        awm = AppWidgetManager.getInstance(context);

    }

        ...

    private void loadPrefs(){
        sp = context.getSharedPreferences("widget" + String.valueOf(appWidgetId)
              , Context.MODE_PRIVATE);
        note = sp.getString("Note", "");

        info.setText(note);

    }

    private void savePrefs(String key, String value){
        sp = context.getSharedPreferences("widget" + String.valueOf(appWidgetId)
                  , Context.MODE_PRIVATE);
        SharedPreferences.Editor editor = sp.edit();
        editor.clear();
        editor.putString("Note", info.getText().toString());
        editor.commit();   

    }

    public void onClick(View v) {
        // TODO Auto-generated method stub

        savePrefs("Note", info.getText().toString());

        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget);
        views.setTextViewText(R.id.tvConfigInput, info.getText());

        ComponentName thisWidget = new ComponentName(this, Widget.class);
        AppWidgetManager manager = AppWidgetManager.getInstance(this);
        manager.updateAppWidget(thisWidget, views);

        Intent in = new Intent(context, WidgetConfig.class);
        PendingIntent pi = PendingIntent.getActivity(context, 0, in, PendingIntent.FLAG_UPDATE_CURRENT);

        views.setOnClickPendingIntent(R.id.B_EditAgain, pi);

        awm.updateAppWidget(awID, views);

        Intent result = new Intent();
        result.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, awID);
        setResult(RESULT_OK, result);
        finish();

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:44:14.680

哦很酷，所以只需将 appWidgetId 设置为 awID。或者更简单，将 awID 传递给您调用 sharedPreferences 的方法。那应该解决它。

# xml - XSD 验证失败时的自定义错误消息

> ID：12981444
> 
> 赞同：6
> 
> 时间：2012-10-19T19:47:18.000
> 
> 标签：xml, xsd

我正在使用 xsd 验证 xml 文件，并且我想向用户返回有意义的消息。有什么方法可以在 xsd 中构建自定义消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T23:53:32.927

答案“否”和“是”（或“是的，但是......”）都适用于此，具体取决于您想要什么；不幸的是，出于所有实际目的，答案是“不”。

XSD 规范没有指定或约束 API 或用户界面，因此没有标准的方法来指定，在 XSD 模式文档中，如果违反特定约束，向用户提供什么消息。模式处理器允许您以某种方式控制错误消息是完全合法的，并且包含 xs:appinfo 元素部分是为了使类似的事情变得可行。但我不知道有任何模式验证器实际上确实提供了这种设施（我很高兴了解任何这样做的工具）。

一种可能的解决方法：XSD 确实建议验证器使用特定的错误代码，因此如果您的验证器为验证结果提供 API，您可能能够识别引发的错误并使用错误代码和位置信息为您生成合适的错误消息用户。如果您的处理器产生您可以解析的书面输出，情况也是如此。

获得漂亮的用户可指定错误消息的最简单方法是使用 Schematron，它确实规定处理器使用模式作者指定的错误消息，并且可以根据问题进行自定义。（我希望在某个地方有一些处理国际化的问题，但我不知道任何细节。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-28T15:14:18.620

使用[Schematron](http://www.schematron.com/)，它使用一组规则（每个规则都有一个自定义错误消息）来验证文档。所有这些错误消息都出现在验证报告中，称为 SVRL，以及输入文档中的相应错误位置 (XPath)。

# jquery - 在 click() 列表项上，显示具有相同 ID 的 div

> ID：12981445
> 
> 赞同：-1
> 
> 时间：2012-10-19T19:47:21.623
> 
> 标签：jquery

我有一个包含列表项的菜单，其 ID 与 div 相关联，每个包含与列表项相关的内容。我试图在单击特定列表项时显示内容。我意识到`this`指的是`#agency ul li`，但我似乎无法理解如何引用内容 div。

HTML

```
<ul id="agency">
            <li>Select an Agency</li>
            <ul>
                <li id="agriculture">Department of Agriculture</li>
                <li id="commerce">Department of Commerce</li>
                <li id="defense">Department of Defense</li>
                <li id="energy">Department of Energy</li>
                <li id="health">Department of Health and Human Services</li>
                <li id="homeland">Department of Homeland Security</li>
                <li id="interior">Department of the Interior</li>
                <li id="transportation">Department of Transportation</li>
                <li id="veterans">Department of Veteran Affairs</li>
                <li id="epa">Environmental Protection Agency</li>
                <li id="aeronautics">Nat'l Aeronautics and Space Admin</li>
            </ul>
        </ul>

    <div id="agency-wrap">
        <div id="agriculture">
            <ul>
                <li><a href="http://www.ars.usda.gov/partnering">USDA Agricultural Research Service</a></li>
                <li><a href="http://www.ars.usda.gov/business/docs.htm?docid=763&page=3">USDA ARS Tech Transfer Coordinators</a></li>
                <li><a href="http://www.fs.fed.us">USDA Forest Service</a></li>
            </ul>
        </div>
        <div id="commerce">
            <ul>
                <li><a href="http://www.nist.gov/tpo/">DOC Nat'l Institue of Standards and Tech</a></li>
                <li><a href="http://www.noaa.gov">DOC Nat'l Ocean and Atmosph Admin</a></li>
                <li><a href="http://www.its.bldrdoc.gov/">DOC Institue for Telecom Sciences</a></li>
                <li><a href="http://www.nist.gov/mep/">DOC Manufacturing Extension Program</a></li>
            </ul>
        </div>
        <div id="defense">
            <ul>
                <li><a href="http://www.acq.osd.mil/ott/techtransit">DOD Secretary of Defense</a></li>
                <li><a href="http://www.arl.army.mil/main/Main/default.cfm?Action=6">DOD Army Research Lab</a></li>
                <li><a href="http://www.onr.navy.mil/en/Sciecne-Technology/Directtorates/Transition/Technology-Transfer-T2aspx">DOD Office Naval Research</a></li>
                <li><a href="http://www.wpafb.af.mil/library/factsheets/factsheet.asp?id=6026">DOD Air Force Research Lab</a></li>
                <li><a href="http://www.mda.mil/business/tech_apps.html">DOD Missle Defense Agency</a></li>
                <li><a href="http://www.jfcom.mil/about/industry.htm">DOD Joint Forces</a></li>
                <li><a href="http://www.defenseinnovationmarketplace.mil/index.html">DOD Defense Innovation Marketplace</a></li>
            </ul>
        </div>
        <div id="energy">
            <ul>
                <li><a href="http://technologytransfer.energy.gov">DOE Tech Transfer Office</a></li>
            </ul>
        </div>
        <div id="health">
            <ul>
                <li><a href="http://www.ott.nih.gov/">DHHS National Institutes of HealthNIH </a></li>
                <li><a href="http://www.cdc.gov/od/ads/techtran/tech.htm">DHHS Centers for Disease Control</a></li>
                <li><a href="http://www.fda.gov/ScienceResearch/CollaborativeOpportunities/default.htm">DHHS Food and Drug Administration</a></li>
            </ul>
        </div>​ 
```

JS

```
$(function() {
    $('#agency-wrap > div').addClass('agency-hide');

    $('#agency ul li').click(function() {
        $("#" + $(this).attr('id')).fadeIn('slow').siblings().hide();
    });
});​ 
```

CSS

```
.agency-hide {
    display: none;
}        
#agency {
    width: 300px;
}​ 
```

我还没有设计 CSS 样式，功能完成后会处理它

[http://jsfiddle.net/yD4D5/](http://jsfiddle.net/yD4D5/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:50:42.347

您不应该对同一文档中的两个元素使用相同的 id。

将每个对应`div`的id 保存为`data``li`

`<li data-id="agriculture">Department of Agriculture</li>`

在js中

```
 $('#agency ul li').click(function() {
        $("#" + $(this).data("id")).fadeIn('slow').siblings().hide();
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:54:56.193

当您使用 id 访问元素时，选择器引擎假定只有 1 个单一 ID，因为这应该是唯一的。这就是您看到这种行为的原因。

尝试用 class 替换 id 并将选择器更改为此

```
$("." + $(this).data("id")).fadeIn('slow').siblings().hide(); 
```

它应该工作正常..

[检查小提琴](http://jsfiddle.net/sushanth009/yD4D5/2/)

**JS**

```
$(function() {
    $('#agency-wrap > div').addClass('agency-hide');

    $('#agency ul li').click(function() {
        $("." + $(this).attr('id')).fadeIn('slow').siblings().hide();
    });
});​ 
```

**HTML**

```
<ul id="agency">
            <li>Select an Agency</li>
            <ul>
                <li id="agriculture">Department of Agriculture</li>
                <li id="commerce">Department of Commerce</li>
                <li id="defense">Department of Defense</li>
                <li id="energy">Department of Energy</li>
                <li id="health">Department of Health and Human Services</li>
                <li id="homeland">Department of Homeland Security</li>
                <li id="interior">Department of the Interior</li>
                <li id="transportation">Department of Transportation</li>
                <li id="veterans">Department of Veteran Affairs</li>
                <li id="epa">Environmental Protection Agency</li>
                <li id="aeronautics">Nat'l Aeronautics and Space Admin</li>
            </ul>
        </ul>

    <div id="agency-wrap">
        <div class="agriculture">
            <ul>
                <li><a href="http://www.ars.usda.gov/partnering">USDA Agricultural Research Service</a></li>
                <li><a href="http://www.ars.usda.gov/business/docs.htm?docid=763&page=3">USDA ARS Tech Transfer Coordinators</a></li>
                <li><a href="http://www.fs.fed.us">USDA Forest Service</a></li>
            </ul>
        </div>
        <div class="commerce">
            <ul>
                <li><a href="http://www.nist.gov/tpo/">DOC Nat'l Institue of Standards and Tech</a></li>
                <li><a href="http://www.noaa.gov">DOC Nat'l Ocean and Atmosph Admin</a></li>
                <li><a href="http://www.its.bldrdoc.gov/">DOC Institue for Telecom Sciences</a></li>
                <li><a href="http://www.nist.gov/mep/">DOC Manufacturing Extension Program</a></li>
            </ul>
        </div>
        <div class="defense">
            <ul>
                <li><a href="http://www.acq.osd.mil/ott/techtransit">DOD Secretary of Defense</a></li>
                <li><a href="http://www.arl.army.mil/main/Main/default.cfm?Action=6">DOD Army Research Lab</a></li>
                <li><a href="http://www.onr.navy.mil/en/Sciecne-Technology/Directtorates/Transition/Technology-Transfer-T2aspx">DOD Office Naval Research</a></li>
                <li><a href="http://www.wpafb.af.mil/library/factsheets/factsheet.asp?id=6026">DOD Air Force Research Lab</a></li>
                <li><a href="http://www.mda.mil/business/tech_apps.html">DOD Missle Defense Agency</a></li>
                <li><a href="http://www.jfcom.mil/about/industry.htm">DOD Joint Forces</a></li>
                <li><a href="http://www.defenseinnovationmarketplace.mil/index.html">DOD Defense Innovation Marketplace</a></li>
            </ul>
        </div>
        <div class="energy">
            <ul>
                <li><a href="http://technologytransfer.energy.gov">DOE Tech Transfer Office</a></li>
            </ul>
        </div>
        <div class="health">
            <ul>
                <li><a href="http://www.ott.nih.gov/">DHHS National Institutes of HealthNIH </a></li>
                <li><a href="http://www.cdc.gov/od/ads/techtran/tech.htm">DHHS Centers for Disease Control</a></li>
                <li><a href="http://www.fda.gov/ScienceResearch/CollaborativeOpportunities/default.htm">DHHS Food and Drug Administration</a></li>
            </ul>
        </div>​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:51:10.023

您必须为 div 指定不同的 ID。顾名思义，ID 必须是唯一的。这就是为什么您无法访问 div 的原因，因为它的 ID 不是唯一的。

# iphone - 使用 NSMutableArrays 创建 NSDictionary 的内存管理

> ID：12981447
> 
> 赞同：2
> 
> 时间：2012-10-19T19:47:29.360
> 
> 标签：iphone, objective-c, cocoa-touch, ios5, memory-management

在使用可变数组创建字典时，我在理解内存管理时遇到了问题。我正在使用 ios6 SDK 和部署目标 5.1。

在“Group”类的实现中，“namesAndEmails”方法构建了一个数组“emails”，其中包含带有电子邮件的 Person 对象的电子邮件地址。如果 Person 对象没有电子邮件，则将 Person 名称添加到另一个数组“namesWithNoEmail”。数组在字典中返回。

```
#import "Group.h"
@implementation Group 

-(NSDictionary*) namesAndEmails {
    NSMutableArray  *emails = [[NSMutableArray alloc] initWithCapacity:0] ;
    NSMutableArray  *namesWithNoEmail = [[NSMutableArray alloc] initWithCapacity:0];
    NSString *email;
    NSString *name;
    for (Person *p in allPersons) {
        email = p.email;
        name = p.name;
        if ([email length]==0) {
            [namesWithNoEmail addObject:name];
        } else {
            [emails addObject:email];
        }
    }
    NSArray *keys = [NSArray arrayWithObjects:@"emails",@"names", nil];
    NSArray *objects = [NSArray arrayWithObjects:emails, namesWithNoEmail, nil];
    //[emails release];
    //[namesWithNoEmail release];

     return [NSDictionary dictionaryWithObjects:objects forKeys:keys];
} 
```

在代码中的其他地方，我希望向一组人发送电子邮件，因此我调用 emailGroup 方法，该方法通过在组中调用“namesAndEmails”来获取字典。

```
-(void) emailGroup:(Group*) g {

    NSDictionary *emailInfo = [g namesAndEmails];
    guestsWithNoEmail = [emailInfo objectForKey:@"names"];
    guestEmails = [emailInfo objectForKey:@"emails"];

   int nGuestsWithNoEmail = [guestsWithNoEmail count];

   if (nGuestsWithNoEmail > 0) {
      UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:@"No emails" message:@"" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil] autorelease];
      [alert show];
   }

    // some more code here

    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
    picker.mailComposeDelegate = self;
    [picker setSubject:subject];
    [picker setMessageBody:@"" isHTML:NO];
    [picker setToRecipients:guestEmails];
    [[self delegate ] presentModalViewController:picker animated:YES];
    [picker release];
} 
```

据我了解，“namesAndEmails”中的 [NSDictionary dictionaryWithObjects:objects forKeys:keys] 返回一个自动发布的字典。但是，如果我释放“emails”和“namesWithNoEmail”数组，为什么我的代码会崩溃？我认为字典在添加数组后将拥有数组的所有权，因此在方法中释放数组是安全的。我想这是不正确的，但为什么呢？

这样做是一种更干净的方式吗？感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T19:38:17.507

我的第一个建议是使用“产品->分析”功能。如果您在某处泄漏或过度释放，它可能会给您确切的事件链。

其次，我看不到您的方法`nameAndEmails`和`emailGroup:`. 因为我看不到连接，所以我不能告诉你自动释放是否导致了问题。

当主运行循环循环时，自动释放的对象被释放。所以很有可能你`NSDictionary`被释放了。您可以通过在调试器中将内存位置设置为“监视”到每次运行循环时在控制台行中打印某些内容（我假设您在主运行循环中，所以请纠正我）来测试这一点如果那不是真的）。

您可以做的其他事情来跟踪问题是在仪器或`NSZombieEnable=YES`配置中使用“僵尸”

# tfs - 如何从层次结构中删除 DataMember

> ID：12981450
> 
> 赞同：0
> 
> 时间：2012-10-19T19:47:37.020
> 
> 标签：tfs, mdx

在我的维度层次结构中，我想删除“系统生成的”DataMember。层次结构树组成如下：

*   一个
    *   **一个**
    *   AA
        *   **AA**
        *   AAA
    *   AB

其中**A**和**AA**是破坏层次结构的 DataMember。

我希望有这样的真正层次结构：

*   一个
    *   AA
        *   AAA
    *   AB

在层次维度中过滤掉系统生成的 DataMember 的 MDX 技术是什么？

更具体地说，我正在研究 TFS OLAP，工作项树维度。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-28T12:30:19.690

答案有点晚了，但由于我找不到快速的解决方案，我想出了以下内容：

```
Filter(
    Descendants([Dimension].[Hierarchy].[Level 02].Allmembers),
    NOT [Dimension].[Hierarchy].CurrentMember.Parent.DataMember IS [Dimension].[Hierarchy].CurrentMember.DataMember
) 
```

*注意：我在原始 MDX 语句中动态使用关卡。根据需要替换后代函数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-19T13:01:35.870

```
FILTER (
    DESCENDANTS( [Work Item Tree].[Work Item Tree Hierarchy].[Work Item Tree].ALLMEMBERS ),
    NOT [Work Item Tree].[Work Item Tree Hierarchy].CURRENTMEMBER.IS_DATAMEMBER
) 
```

# java - 使用 tomcat 绑定到 LDAP 以进行身份 验证？

> ID：12981454
> 
> 赞同：1
> 
> 时间：2012-10-19T19:47:48.033
> 
> 标签：java, tomcat, ldap

我有一个使用 JNDI 目录领域绑定到 LDAP 服务器进行身份验证的 tomcat 服务器，这工作正常。

但是，我想从 LDAP 服务器中提取更多信息（例如，姓名、电话号码、电子邮件等），并且想知道最好的方法是什么？所以，我看到有两种可能性：

1）有没有办法搭载这个已经配置的领域？如果是这样，怎么做？

2) 还是我必须建立一个单独的 LDAP 连接？如果是这样，我可以只使用 tomcat 中已经存在的 LDAP 库和例程吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:55:44.720

我怀疑任何容器都会允许您访问 LDAP 连接。在某些容器中提供了使用 LDAP 搜索查询（比如检索组）检索 LDAP 本身内的条目的规定，但容器通常不设计为与开发人员共享连接。

您可以像 Oscar 建议的那样使用 JNDI 或许多[其他 API](http://directory.apache.org/api/java-api.html)。自己使用连接，因为规范没有说明与您共享连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:50:55.740

如果您需要绑定到 LDAP 服务器以检索信息，请使用纯[JNDI](http://docs.oracle.com/javase/jndi/tutorial/)，它是用于访问目录并对其执行 CRUD 操作的标准 API，它甚至可以在 Tomcat 之外工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T08:34:12.733

JNDI 不应该用于新代码。JNDI 很少推荐它：

*   JNDI 有相当多的软件缺陷
*   JNDI 不支持全部的 LDAP 标准（并且使某些标准 LDAP 功能无法使用）
*   可用的例子很可怕
*   它使用断开的参数设置机制
*   它使用不推荐使用的配置。

[UnboundID LDAP SDK](https://www.unboundid.com/products/ldap-sdk/)支持连接和 LDAP 操作的合理结构。

### 也可以看看

*   [LDAP：编程实践](http://www.ldapguru.info/ldap/ldap-programming-practices.html)
*   [LDAP：搜索](http://www.ldapguru.info/ldap/ldap-search-best-practices.html)

# c++ - SIGRTMAX 的 Valgrind 和 sigaction

> ID：12981455
> 
> 赞同：1
> 
> 时间：2012-10-19T19:47:49.327
> 
> 标签：c++, signals, valgrind

我打电话`sigaction`来安装一个处理程序`SIGRTMAX`，这通常很好。但是，如果我使用 valgrind 分析可执行文件，这将失败。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T09:59:24.863

它失败是因为 valgrind 保留了一个信号，即编号最高的一个，供其内部使用（调度程序使用它来中断在系统调用中被阻塞的线程），因此它拒绝客户端程序安装处理程序的任何尝试。信号或以其他方式操纵它。

# sql - Oracle：将日期与列表中最早的日期相关联而不重用

> ID：12981456
> 
> 赞同：3
> 
> 时间：2012-10-19T19:47:58.023
> 
> 标签：sql, oracle, oracle10g

我正在尝试将请求与随后的*最早响应相匹配。*不幸的是，UI 不会强制执行一个请求对一个响应。

要求：

```
ENC_ID  CONTACT EVENT_TIME
13991333    1   08/13/2012 22:00:36
13991333    1   08/13/2012 22:25:21
13991333    1   08/13/2012 22:26:14
13991333    1   08/13/2012 22:36:42
13991333    2   08/13/2012 22:29:40 
```

回应：

```
ENC_ID  CONTACT EVENT_TIME
13991333    1   08/13/2012 22:25:40
13991333    1   08/13/2012 22:29:31
13991333    1   08/13/2012 22:30:47
13991333    1   08/13/2012 22:31:35
13991333    1   08/13/2012 22:31:49
13991333    2   08/13/2012 22:31:14 
```

期望：

```
ENC_ID  CONTACT REQ_EVENT_TIME  RES_EVENT_TIME
13991333    1   08/13/2012 22:00:36 08/13/2012 22:25:40
13991333    1   08/13/2012 22:25:21 08/13/2012 22:29:31
13991333    1   08/13/2012 22:26:14 08/13/2012 22:30:47
13991333    1   08/13/2012 22:36:42 
13991333    2   08/13/2012 22:29:40 08/13/2012 22:31:14 
```

规则：

*   如果响应与请求相关联，则它**不能**与另一个相关联。
*   请求没有响应是可以接受的，但反过来不行

我的查询创建了笛卡尔积：

```
SELECT  RQ.ENC_ID, RQ.CONTACT, RQ.EVENT_TIME REQ_EVENT_TIME,
        RS.EVENT_TIME RES_EVENT_TIME
FROM    RQ
LEFT OUTER JOIN RS ON RQ.ENC_ID=RS.ENC_ID
  AND RQ.CONTACT=RS.CONTACT
  AND RS.EVENT_TIME>RQ.EVENT_TIME 
```

我一直在试验 LEAD() 函数，但无法让它按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T05:58:22.510

```
with t1(ENC_ID, CONTACT, EVENT_TIME) as(
  select 13991333,    1,   '08/13/2012 22:00:36' from dual union all
  select 13991333,    1,   '08/13/2012 22:25:21' from dual union all
  select 13991333,    1,   '08/13/2012 22:26:14' from dual union all
  select 13991333,    1,   '08/13/2012 22:36:42' from dual union all
  select 13991333,    2,   '08/13/2012 22:29:40' from dual
),
t2(ENC_ID,CONTACT,EVENT_TIME) as(
  select 13991333,    1,   '08/13/2012 22:25:40' from dual union all
  select 13991333,    1,   '08/13/2012 22:29:31' from dual union all
  select 13991333,    1,   '08/13/2012 22:30:47' from dual union all
  select 13991333,    1,   '08/13/2012 22:31:35' from dual union all
  select 13991333,    1,   '08/13/2012 22:31:49' from dual union all
  select 13991333,    2,   '08/13/2012 22:31:14' from dual
)
select enc_id
     , contact
     , req
     , min(res) resp
  from (select q.enc_id
             , q.contact
             , q.req
             , case  
                 when resp > req then nth_value(q.resp, q.gid) over(partition by q.enc_id, q.contact, gid order by q.req, q.gid)
               end res
         from (select t1.enc_id
                    , t1.contact
                    , t1.event_time req
                    , dense_rank() over (partition by t1.enc_id, t1.contact order by t1.event_time) gid
                    , t2.event_time resp
                 from t1
                 left outer join t2
                   on (t1.enc_id = t2.enc_id   and
                       t1.contact = t2.contact)
                order by 1,2,3,5
               ) q
         )
group by enc_id
       , contact
       ,  req
order by enc_id
       , contact
       ,  req 
```

结果：

```
 ENC_ID    CONTACT     REQ                 RESP
---------- ----------  ------------------- -------------------
  13991333          1  08/13/2012 22:00:36 08/13/2012 22:25:40
  13991333          1  08/13/2012 22:25:21 08/13/2012 22:29:31
  13991333          1  08/13/2012 22:26:14 08/13/2012 22:30:47
  13991333          1  08/13/2012 22:36:42 
  13991333          2  08/13/2012 22:29:40 08/13/2012 22:31:14 
```

我们在这里所做的是使用`dense_rank`分析函数索引请求组：

```
select t1.enc_id
     , t1.contact
     , to_date(t1.event_time, 'mm/dd/yyyy hh24:mi:ss') req
     , dense_rank() over (partition by t1.enc_id, t1.contact order by to_date(t1.event_time, 'mm/dd/yyyy hh24:mi:ss')) gid
     , to_date(t2.event_time, 'mm/dd/yyyy hh24:mi:ss') resp
  From t1
  left outer join t2
    on (t1.enc_id = t2.enc_id   and
        t1.contact = t2.contact)
 order by 1,2,3,5 
```

结果：

```
 ENC_ID    CONTACT REQ                        GID RESP
---------- ---------- ------------------- ---------- -------------------
  13991333          1 08/13/2012 22:00:36          1 08/13/2012 22:25:40
  13991333          1 08/13/2012 22:00:36          1 08/13/2012 22:29:31
  13991333          1 08/13/2012 22:00:36          1 08/13/2012 22:30:47
  13991333          1 08/13/2012 22:00:36          1 08/13/2012 22:31:35
  13991333          1 08/13/2012 22:00:36          1 08/13/2012 22:31:49
  13991333          1 08/13/2012 22:25:21          2 08/13/2012 22:25:40
  13991333          1 08/13/2012 22:25:21          2 08/13/2012 22:29:31
  13991333          1 08/13/2012 22:25:21          2 08/13/2012 22:30:47
  13991333          1 08/13/2012 22:25:21          2 08/13/2012 22:31:35
  13991333          1 08/13/2012 22:25:21          2 08/13/2012 22:31:49
  13991333          1 08/13/2012 22:26:14          3 08/13/2012 22:25:40
  13991333          1 08/13/2012 22:26:14          3 08/13/2012 22:29:31
  13991333          1 08/13/2012 22:26:14          3 08/13/2012 22:30:47
  13991333          1 08/13/2012 22:26:14          3 08/13/2012 22:31:35
  13991333          1 08/13/2012 22:26:14          3 08/13/2012 22:31:49
  13991333          1 08/13/2012 22:36:42          4 08/13/2012 22:25:40
  13991333          1 08/13/2012 22:36:42          4 08/13/2012 22:29:31
  13991333          1 08/13/2012 22:36:42          4 08/13/2012 22:30:47
  13991333          1 08/13/2012 22:36:42          4 08/13/2012 22:31:35
  13991333          1 08/13/2012 22:36:42          4 08/13/2012 22:31:49
  13991333          2 08/13/2012 22:29:40          1 08/13/2012 22:31:14 
```

然后根据请求组的索引选择第n个响应值。因此，对于第一组请求，它将是组中响应时间的第一个值，对于第二组请求，它将是组中响应时间的第二个值，依此类推。

* * *

**更新**（模拟 10g 的 nth_value 分析函数的行为）

```
SQL> with t1(ENC_ID, CONTACT, EVENT_TIME) as(
  2    select 13991333,    1,   '08/13/2012 22:00:36' from dual union all
  3    select 13991333,    1,   '08/13/2012 22:25:21' from dual union all
  4    select 13991333,    1,   '08/13/2012 22:26:14' from dual union all
  5    select 13991333,    1,   '08/13/2012 22:36:42' from dual union all
  6    select 13991333,    2,   '08/13/2012 22:29:40' from dual
  7  ),
  8  t2(ENC_ID,CONTACT,EVENT_TIME) as(
  9    select 13991333,    1,   '08/13/2012 22:25:40' from dual union all
 10    select 13991333,    1,   '08/13/2012 22:29:31' from dual union all
 11    select 13991333,    1,   '08/13/2012 22:30:47' from dual union all
 12    select 13991333,    1,   '08/13/2012 22:31:35' from dual union all
 13    select 13991333,    1,   '08/13/2012 22:31:49' from dual union all
 14    select 13991333,    2,   '08/13/2012 22:31:14' from dual
 15  ),
 16  t3 as
 17  (
 18  select z.*
 19       , row_number() over (partition by enc_id, contact, req order by req) rn
 20    from (
 21    select t1.enc_id
 22         , t1.contact
 23         , t1.event_time req
 24         , dense_rank() over (partition by t1.enc_id, t1.contact order by t1.event_time) gid
 25         , t2.event_time resp
 26      from t1
 27      left outer join t2
 28        on (t1.enc_id = t2.enc_id   and
 29            t1.contact = t2.contact)
 30      order by 1,2,3,5
 31    ) z
 32  )
 33  select enc_id , contact, req, min(resp) resp
 34    from (
 35           select q.enc_id
 36                , q.contact
 37                , q.req
 38                , case
 39                    when min(case rn when gid then resp end) over(partition by enc_id, contact, req order by req) > req
 40                    then min(case rn when gid then resp end) over(partition by enc_id, contact, req order by req)
 41                 end resp
 42            from t3 q
 43         )
 44  group by enc_id
 45         , contact
 46         , req
 47  order by enc_id
 48         , contact
 49         , req
 50  ;

Result:

    ENC_ID    CONTACT REQ                 RESP
---------- ---------- ------------------- -------------------
  13991333          1 08/13/2012 22:00:36 08/13/2012 22:25:40
  13991333          1 08/13/2012 22:25:21 08/13/2012 22:29:31
  13991333          1 08/13/2012 22:26:14 08/13/2012 22:30:47
  13991333          1 08/13/2012 22:36:42 
  13991333          2 08/13/2012 22:29:40 08/13/2012 22:31:14 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:13:23.503

你非常接近......试试这个：

```
SELECT  RQ.ENC_ID, RQ.CONTACT, RQ.EVENT_TIME REQ_EVENT_TIME,
        min(RS.EVENT_TIME) RES_EVENT_TIME
FROM    RQ
LEFT OUTER JOIN RS ON RQ.ENC_ID=RS.ENC_ID
  AND RQ.CONTACT=RS.CONTACT
  AND RS.EVENT_TIME>RQ.EVENT_TIME
GROUP BY RQ.ENC_ID, RQ.CONTACT, RQ.EVENT_TIME
ORDER BY 1,2,3,4 
```

# perl - 用perl重命名文件，文件被删除

> ID：12981461
> 
> 赞同：0
> 
> 时间：2012-10-19T19:48:30.727
> 
> 标签：perl, rename

我的代码如下所示：

```
#!/usr/bin/perl -w
use strict;
use warnings;

my $i = 1;
my @old_names = glob "/root/pics/*.jpg";
my $new_name = "picture$i";

foreach my $old_name (@old_names) {
    rename($old_name, $new_name) or 
        die "Couldn't rename $old_name to $new_name: $!\n";
} continue { $i++ } 
```

当我执行脚本时它会删除图片，我做错了什么？

编辑：

这对我有用。

```
#!/usr/bin/perl -w
use strict;
use warnings;

my $i = 1;
my @old_names = glob "/root/pics/*.jpg";

foreach my $old_name (@old_names) {

    my $new_name = "picture$i" . ".jpg";

    rename($old_name, "/root/pics/$new_name") or die "Couldn't rename $old_name to $new_name: $!\n";

} continue { $i++ } 
```

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:50:43.620

这一行：

```
my $new_name = "picture$i"; 
```

在你的循环之外。因此它不会得到更新。因此，所有文件都被重命名为相同的名称，从而有效地删除了它们。

解决方案是将赋值移动到循环内，**或者**一起跳过变量并执行

```
rename($old_name, "picture$i") ... 
```

出于打高尔夫球的目的，您还可以考虑

```
rename($old_name, "picture" . $i++) ... 
```

您可能也有兴趣查看[File::Copy](http://search.cpan.org/perldoc?File%3a%3aCopy)，它是一个核心模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:52:37.170

`$new_name`您已经在循环之外初始化了一次。即使你更新了`$i`，你也没有更新`$new_name`。因此，每个文件都被重命名为`picture1`（在当前目录中），并且除了最后一个文件之外的所有文件都将丢失。

`$new_name`在循环内更新：

```
foreach my $old_name (@old_names)
{
    $new_name = "picture$i";
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:53:47.023

尝试：

```
#!/usr/bin/perl -w
use strict;
use warnings;

my $i = 1;
my @old_names = glob "/root/pics/*.jpg";
my $new_name = "picture$i";

foreach my $old_name (@old_names)
{
    $new_name = "picture$i";
    rename($old_name, $new_name) or die "Could not rename $old_name to $new_name: $!\n";
    $i++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:57:20.967

也许你可以在 shell 中做（`perl`在后台使用）：

```
rename 's/(.*).jpg/picture1_\1/' *.jpg 
```

# android - 安卓纸牌游戏服务器

> ID：12981469
> 
> 赞同：0
> 
> 时间：2012-10-19T19:49:00.990
> 
> 标签：android, vb.net, azure, client-server

我制作了一个 Android 纸牌游戏，用户与 AI 进行游戏。现在我想把它变成在线游戏，这样玩家就可以和其他玩家对战了。是否可以在 Windows Azure 中托管游戏服务器（用 vb.net 编写）？

服务器正在使用 TCP 连接，它会向客户端发送一条简单的消息（例如，“K Spades”），但我还想要一个包含玩家姓名、分数等的数据库。

该游戏目前拥有约 2 万名玩家。服务器需要什么硬件/带宽？
如果无法在 Azure 上部署服务器，我应该使用什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:00:30.680

简短的回答是“这取决于”。20K玩家产生了多少流量？现在仅基于 2 名玩家玩 1 场游戏需要多少存储空间？单个游戏需要多少处理能力？（再加上潜在的玩家和游戏数量）。查看[定价计算器](https://www.windowsazure.com/en-us/pricing/calculator/?scenario=full)。

此外，请查看[Auto Scaling](https://www.windowsazure.com/en-us/develop/net/how-to-guides/autoscaling/)，您的资源将根据运行时获得的流量动态扩展和缩减（这意味着您不必提前预留实例）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:42:06.230

20k 用户应该意味着您每天在线的用户数不超过 2k。
您的游戏用户应该使用更少的流量，例如网站用户。

对于一个网站来说，每天有 2k 用户是一个有趣的数字，所以我猜你甚至可以在手机上运行服务器 :)

# css - css3的第二个孩子 依此类推以获得 margin-left:20px

> ID：12981470
> 
> 赞同：1
> 
> 时间：2012-10-19T19:49:05.797
> 
> 标签：css

我正在尝试创建一个导航菜单，我希望我的第一个`<li>`与它上面的容器完美对齐，但我需要在第一个右侧有一些间距，`<li>`所以我正在尝试执行以下操作：

```
nav .innercontainer ul li:nth-of-type(2n+1){ /*only happen after the first <li>*/
    margin-left:20px;
} 
```

感谢这些伪选择元素令人困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:56:21.730

最简单的方法是使用`+`选择器：

```
ul > li + li{
    /* all li elements except the first */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:52:43.120

nav .innercontainer ul li{ margin-left:20px;

}

nav .innercontainer ul li:first{ margin-left:0;

}

如果我做对了，这样就很简单

# c# - 将 Guid 转换为字符串的表达式

> ID：12981472
> 
> 赞同：0
> 
> 时间：2012-10-19T19:49:11.260
> 
> 标签：c#, mapping, expression

我需要将一个对象的所有公共属性复制到另一个类型的另一个对象。Jon Skeet 创建的库[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)包含 PropertyCopy 类，它非常适合我需要的东西，除了一件事。我在源对象中有一个属性需要转换为目标对象中的另一种类型（Guid => 字符串）。

来自 PropertyCopy 的部分代码：

```
if (!targetProperty.PropertyType.IsAssignableFrom(sourceProperty.PropertyType))
{
    //My specific case
    if (sourceProperty.PropertyType == typeof(Guid) && targetProperty.PropertyType == typeof(string))
    {
        //Expression.Bind(targetProperty, [--Convert Guid to string expression??--]);
    }
    else
    {
        throw new ArgumentException("...");
    }                              
} 
```

那么是否可以创建一个表达式来将源属性的转换绑定到目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:06:36.460

我认为

```
Expression.Bind(targetProperty, (Expression<Func<Guid,string>>) (v=>v.ToString())); 
```

会工作...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:28:36.757

下面的代码在将 Guid 绑定到目标属性之前将其转换为字符串：

```
if (sourceProperty.PropertyType == typeof(Guid) && targetProperty.PropertyType == typeof(string))
{
    Expression callExpr = Expression.Call(Expression.Property(sourceParameter, sourceProperty), typeof(Guid).GetMethod("ToString", new Type[] { }));
    bindings.Add(Expression.Bind(targetProperty, callExpr));
} 
```

# c# - 桌面应用程序无法连接到数据库，但 Web 应用程序可以

> ID：12981474
> 
> 赞同：1
> 
> 时间：2012-10-19T19:49:20.507
> 
> 标签：c#, database, desktop-application, sql-server-2012

我编写了一个 C# 桌面（winforms）应用程序，它本质上是我编写的 Web 应用程序的克隆。Web 应用程序能够很好地与数据库来回通信。但是，当我安装桌面应用程序时，出现以下错误：

*与 SQL Server 建立连接时发生与网络相关或特定于实例的错误*

我在桌面应用程序中使用与在 Web 应用程序中使用的完全相同的连接字符串，如下所示：

```
"Data Source=tcp:s08.winhost.com;Initial Catalog=THEDATABASE;
            User ID=USERNAME;Password=******;Integrated Security=False;" 
```

我无法使用 SQL Server 配置管理器，因为我的数据库托管在 Winhost.com 上。但是，他们已经向我明确表示，正确的端口已打开，命名管道已打开，并且 SQL 浏览器已正确配置。如果有人遇到过类似的问题，请告诉我您为解决此问题所做的工作。我还在下面包含了整个错误。

谢谢

`************** Exception Text **************`
`System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.) ---> System.ComponentModel.Win32Exception (0x80004005): A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:03:25.727

删除 TCP 协议名称和端口号并尝试使用完整的托管网站地址..类似这样

```
 Data Source=www.winhost.com;Initial Catalog=THEDATABASE;
             User ID=USERNAME;Password=**;Integrated Security=False; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T01:26:41.037

最终我发现问题出在代理服务器上。该应用程序正在被设置了代理服务器的公司使用，并且由于此端口 1433 被阻止。我最终通过创建网络服务解决了这个问题。

# orm - 多行的 GenericForeignKey 过滤问题

> ID：12981480
> 
> 赞同：0
> 
> 时间：2012-10-19T19:50:13.653
> 
> 标签：orm, django-models

我有一个包含以下内容的表格：

```
content_type = models.ForeignKey(ContentType, null=True, default=None)
object_id = models.PositiveIntegerField(null=True, default=None)
content_object = generic.GenericForeignKey('content_type', 'object_id') 
```

我希望能够在`content_type`is`Null`或如果`content_type`不是的情况下进行过滤`Null`，我希望它检查`active`特定对象中的字段并确保它是“Y”。我该如何进行比较？

我检查了许多网站，包括以下内容：

[http://ui.co.id/blog/generic-field-filtering-in-django](http://ui.co.id/blog/generic-field-filtering-in-django)

**编辑**

我对此的唯一解决方案是`for loop`在过滤器语句之后循环遍历并消除任何没有正确`active`字段的对象。这效率低下……有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T22:20:14.743

在这种情况下，您可能会执行以下操作：

# 情况1：

```
result = []
result += Model.objects.filter(content_type__isnull=True) 
```

# 案例2：

```
active_object_ids = ObjectClass.objects.filter(active='Y').values_list('id', flat=True)
result += Model.objects.filter(object_id__in = active_object_ids) 
```

唯一的缺点是在情况 2 中，您可能必须收集 GFK 链接的所有对象的所有 ID。此外，因为每当您保存 content_object 时，content_type 都会与它一起保存，因此您无需在第二种情况下测试 content_type。

# sql - 如何将 .txt 文件导入我的 SQL 表？

> ID：12981481
> 
> 赞同：0
> 
> 时间：2012-10-19T19:50:22.633
> 
> 标签：sql, import

我在 SQL 中创建了一些表，例如：

```
CREATE TABLE Courses(
    CourseNo INTEGER CHECK(100<=CourseNo AND CourseNo<=999) PRIMARY KEY,
    Title VARCHAR(100) NOT NULL,
) 
```

我必须创建这个表的一个实例，这意味着我必须将一些数据从 .txt 文件导入到上面显示的表中。我怎样才能做到这一点？SQL软件中是否有一个按钮可以帮助我实现这个目标？还是我必须使用“INSERT”之类的代码将文件导入我的表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:07:55.817

如果您使用 MySQL，则必须使用逗号分隔每个字段并在每条记录的末尾使用回车符（行尾）来格式化文件。那么您必须将您的 TXT 文件保存为 CSV（将 txt 替换为 csv）。

打开 phpmyadmin，选择您的数据库，选择您的表并单击导入。选择文件并将格式从 SQL 更改为 CSV

# .net - Firefox 没有正确读取 IIS 虚拟路径

> ID：12981484
> 
> 赞同：1
> 
> 时间：2012-10-19T19:50:51.657
> 
> 标签：.net, asp.net-mvc-3, firefox, iis

在我们当前的项目中，我们设置了两个虚拟路径，一个用于图像，一个用于文件上传。虚拟路径从单独的服务器中提取图像和文件。我目前正在处理跨浏览器兼容性问题，Firefox 读取虚拟路径的方式似乎与所有其他浏览器不同。似乎它没有正确呈现 URL。它们在 Chrome、Safari 和 IE 7/8/9 中运行良好。

当前使用 IIS 7

**最后结果：**

在这种情况下，用户可以看到他们上传的所有公开 PDF 的列表。然后，用户可以单击其中一个文件名，PDF 将在新选项卡/窗口中打开。

在 IE、Chrome 和 Safari 中，路径如下所示（正确）：

`http://localhost:1798/disclosures/bf1bb8bf-ef34-4c93-a4c3-540bab158644.pdf`

然而，在 Firefox 中它看起来像这样：

`http://localhost:1798/Disclosure\disclosures\bf1bb8bf-ef34-4c93-a4c3-540bab158644.pdf`

这是当前页面的 URL：

`http://localhost:1798/Disclosure/Disclosures?lenderProductID=19&lenderID=64`

为什么它看起来像是在尝试将当前 URL 与虚拟路径结合起来？当我单击其中一个 PDF 链接时，它会打开一个新选项卡/窗口，但会将我重新路由回索引页面。

我不是最好的 IIS，所以任何帮助将不胜感激！先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:57:00.990

您确定 URL 正确呈现吗？

我的直觉告诉我，IE、Chrome 和 Safari 正在将反斜杠转换为正斜杠。FireFox 没有这样做，这就是它在 FireFox 中似乎被破坏的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T22:39:25.800

感谢大家的所有投入。在图像/文件路径中查看 web.config 后，我注意到一个愚蠢的错误，结果证明这是我的问题的根源。

在 web.config 中，我在字符串中有反斜杠而不是正斜杠。我猜 Chrome、IE 和 Safari 正确地转换了它们，但 Firefox 在这方面更严格一些。

这是我在 中找到的两个文件路径`<appSettings>`：

```
<add key="ImagePath" value="\images\" />
<add key="DisclosurePath" value="\disclosures\" /> 
```

但是，它们应该如下所示：

```
<add key="ImagePath" value="/images/" />
<add key="DisclosurePath" value="/disclosures/" /> 
```

谢谢大家！现在我可以停止敲打我的头并戴上我的笨蛋帽了！:-)

# c# - C# 的 3D 图形框架

> ID：12981486
> 
> 赞同：-2
> 
> 时间：2012-10-19T19:50:56.873
> 
> 标签：c#, directx, managed-directx

我有一个用于可视化地图数据的应用程序。直到今天，我一直在使用标准 Forms.Graphics 在我的 Windows 应用程序中绘制 2D 线条和其他图元。

我今天发现托管 C# DirectX 已被弃用。如果我想在我的应用程序中使用 2D/3D，作为 C# 开发人员，我有什么选择吗？（这不是游戏，所以我不会迁移到 C++）。我不需要任何先进的东西。我所需要的只是能够在 2D 和 3D 中绘制线条和面，并在 2D 和 3D 中用鼠标选择对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:00:20.290

也许试试 OpenGL？

一些图书馆：

[http://dotnet.mvps.org/dotnet/faqs/?id=opengl&lang=en](http://dotnet.mvps.org/dotnet/faqs/?id=opengl&lang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:09:11.867

您可以移动到[WPF 网格](http://www.codeproject.com/Articles/24727/WPF-3D-Part-1-of-n)以在 3D 中绘制基本形状。

或者，您可以迁移到[XNA](http://msdn.microsoft.com/en-us/library/bb197293%28v=xnagamestudio.31%29.aspx)并使用此游戏框架进行 3D。

您还可以在 WPF 中使用 XNA。

Forms 最适合与 MVP 模式一起使用，我个人认为 MVVM 更胜一筹。MVVM 与 WPF 配合得很好，所以如果你有选择的话，你应该迁移。

我看不到 DirectX 很快就会消失。有些开发人员希望更直接地控制图形，但我目前不认为这会影响 C# 中托管图形的存在。

# c# - Task.WaitAll 在 ASP.NET 中挂起多个等待任务

> ID：12981490
> 
> 赞同：27
> 
> 时间：2012-10-19T19:51:11.730
> 
> 标签：c#, asp.net, task-parallel-library, async-await

下面是我遇到问题的代码的简化版本。当我在控制台应用程序中运行它时，它按预期工作。所有查询都并行运行，并`Task.WaitAll()`在全部完成后返回。

但是，当此代码在 Web 应用程序中运行时，请求就会挂起。当我附加一个调试器并全部中断时，它表明执行是 wait on `Task.WaitAll()`。第一个任务已经完成，但其他任务从未完成。

我不知道为什么它在 ASP.NET 中运行时挂起，但在控制台应用程序中运行良好。

```
public Foo[] DoWork(int[] values)
{
    int count = values.Length;
    Task[] tasks = new Task[count];

    for (int i = 0; i < count; i++)
    {
        tasks[i] = GetFooAsync(values[i]);
    }

    try
    {
        Task.WaitAll(tasks);
    }
    catch (AggregateException)
    {
        // Handle exceptions
    }

    return ...
}

public async Task<Foo> GetFooAsync(int value)
{
    Foo foo = null;

    Func<Foo, Task> executeCommand = async (command) =>
    {
        foo = new Foo();

        using (SqlDataReader reader = await command.ExecuteReaderAsync())
        {
            ReadFoo(reader, foo);
        }
    };

    await QueryAsync(executeCommand, value);

    return foo;
}

public async Task QueryAsync(Func<SqlCommand, Task> executeCommand, int value)
{
    using (SqlConnection connection = new SqlConnection(...))
    {
        connection.Open();

        using (SqlCommand command = connection.CreateCommand())
        {
            // Set up query...

            await executeCommand(command);

            // Log results...

            return;
        }
    }           
} 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-10-19T19:57:32.557

而不是`Task.WaitAll`您需要使用`await Task.WhenAll`.

在 ASP.NET 中，您有一个实际的同步上下文。这意味着在所有`await`调用之后，您将被封送回该上下文以执行延续（有效地序列化这些延续）。在控制台应用程序中没有同步上下文，因此所有的延续都只是发送到线程池。通过`Task.WaitAll`在请求的上下文中使用，您将阻止它，这会阻止它被用于处理所有其他任务的延续。

另请注意，ASP 应用程序中异步/等待的主要好处之一是*不会*阻塞您用于处理请求的线程池线程。如果你使用 a`Task.WaitAll`你就违背了这个目的。

进行此更改的副作用是，通过从阻塞操作转移到等待操作，异常会以不同的方式传播。而不是抛出`AggregateException`它会抛出一个潜在的异常。

# css - 如何根据控件宽度编写 CSS？

> ID：12981495
> 
> 赞同：2
> 
> 时间：2012-10-19T19:51:23.160
> 
> 标签：css, html

我有一个要求，我需要根据控制当前宽度编写 CSS。

示例：假设我有`DIV`，如果我将这个 div 放在侧面菜单栏中（比如说，`menu width="300px;"`），我想设置字体大小 8px，如果我把这个 DIV 放在主要内容区域（比如说，`menu width="700px;"`），我想设置字体大小`15px`。

如何使用 CSS 实现这个场景？

我知道，我们可以用媒体查询来写这样的东西，但媒体查询是基于视口宽度，而不是父容器宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:55:00.967

利用 CSS 的 C̲ascading 部分：

```
.menuBar .myDiv
{
    font-size: 8px;
}
.mainContent .myDiv
{
    font-size: 15px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:57:07.953

```
.side-menu div{ 
 font-size:8px;}
.main-content div{ font-size:15px;} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-19T19:55:16.553

仅当您已经知道要应用样式的 div 的宽度时：

```
input[width="50px"]
{
    font-size: 20px;
} 
```

**当您没有其他选择时**特别有用。但最好根据类和 id 来设置它们的样式。

# .net - 查找并关闭 WPF 窗口的所有子窗口

> ID：12981497
> 
> 赞同：3
> 
> 时间：2012-10-19T19:51:36.973
> 
> 标签：.net, wpf, vb.net, winforms

好的，所以我有一个 WPF 应用程序，其中有一个 WinForms 项目。我的主要项目是 WPF 之一。我的问题是如何找到作为 WPF 主窗口的孩子的所有寡妇？这些 Windows 可以是 WinForm 或 WPF，所以我需要一种方法来确定孩子要成功关闭所述表单及其所有潜在孩子的类型。

预先感谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T20:24:15.173

我不得不猜测一下，但我认为您的 WinForms 表单实际上并不是 WPF MainWindow 的子级。我不明白他们怎么可能。

因此，它们可能只是您应用程序中的其他非主窗口，而不是适当的子窗口。

这意味着您有 2 个系列可供查看：

*   赢表格：`System.Windows.Forms.Application.OpenForms`
*   WPF：`System.Windows.Application.Current.Windows`

或者也许`MainWindow.OwnedWindows`对于 WPF 方面。

# mysql - 负载均衡级联 JDBCTap for MySQL

> ID：12981500
> 
> 赞同：0
> 
> 时间：2012-10-19T19:51:46.193
> 
> 标签：mysql, hadoop, connection-pooling, elastic-map-reduce, cascading

我正在考虑编写一个级联应用程序，向 MYSQL 数据库发出 SELECT 语句，其中每个查询可以返回数百万行。

每个数据库存在于 N 个 slave 和一个 master 上，如下所示：http: [//dev.mysql.com/doc/refman/5.0/en/replication-solutions-scaleout.html#figure_replication-scaleout](http://dev.mysql.com/doc/refman/5.0/en/replication-solutions-scaleout.html#figure_replication-scaleout)

在 JDBCTap 中，我看到我们只能传递一个主机名：这意味着我所有的映射器都会尝试连接到一个从属设备（而其他 (N-1) 个从属设备处于空闲状态）。

假设从属服务器前面没有负载均衡器，我可以使用一个 JAVA 包/模块/代理（或者更好的是自定义的 JDBCTap 实现）来将映射器的连接分散到 N 个从属服务器上吗？

此处详细介绍了使用硬件代理的示例脚本：http: [//blog.netoearth.com/html/201006/building-a-mysql-load-balancing-proxy-with-trafficscript.htm](http://blog.netoearth.com/html/201006/building-a-mysql-load-balancing-proxy-with-trafficscript.htm)

如果这样的事情不存在，我将不得不使用以下算法创建我自己的 JDBCTap（将映射器的连接分散到 N 个从属设备上）：

1.  在外部数据库上保留 N 个从属的列表（任何支持并发写入/更新的东西）
2.  有一个已连接到每个从站的映射器计数器
3.  每次映射器需要连接到从站时，它都会查询该数据库以找出负载最少的从站（连接到它的映射器的最小计数）。碰撞时随机平局。

这听起来是个好主意吗？我上面提到的“很好地支持并发写入/更新”的外部数据库可能是什么？（Cassandra、VoltDB 等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T17:29:51.177

JDBC 通常不支持并行性，因此对于大规模负载来说是一个瓶颈。

在那种主/备架构中，如何通过 MySQL 备份从备机中提取数据到 TSV，然后将它们并行加载到 HDFS 中？

# javascript - 如何为 ExtJS 4 应用程序创建预加载器

> ID：12981505
> 
> 赞同：3
> 
> 时间：2012-10-19T19:52:04.190
> 
> 标签：javascript, extjs, extjs4, preloader

我想在我的应用程序中添加预加载器屏幕以用于两个目的：

1.  向用户显示有关应用程序初始化或整体加载的一些进展
2.  将来在加载时显示重要通知或新功能推出消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T20:34:03.570

感谢@Sha 分享链接。

我还找到了有关如何使用预加载器 [http://www.sencha.com/forum/showthread.php?230118-Splash-Screen的详细示例](http://www.sencha.com/forum/showthread.php?230118-Splash-Screen)

[http://blog.newbridgegreen.com/extjs-4-splash-screen/](http://blog.newbridgegreen.com/extjs-4-splash-screen/)

# java - 语法错误，插入“}”完成ClassBody MainActivity.java

> ID：12981507
> 
> 赞同：-3
> 
> 时间：2012-10-19T19:52:11.510
> 
> 标签：java

我刚刚开始编写 android 应用程序，我正在关注 android 开发者网站上的教程，但我遇到了语法错误。因为我才刚刚开始开发，所以我不知道如何解决这个问题。

```
package com.example.my.first.app;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;

public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

/** Called when the user clicks the Send button */
public void sendMessage(View view) {
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:52:52.150

错误本身的说法。`}`在课堂结束时添加。

```
public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

/** Called when the user clicks the Send button */
public void sendMessage(View view) {
}
}  <--- Missing 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:53:22.050

你只是`}`在课程结束时错过了一个。（课程`MainActivity`未关闭）

# c++ - Qmake给我错误

> ID：12981511
> 
> 赞同：0
> 
> 时间：2012-10-19T19:52:36.117
> 
> 标签：c++, qt, short, qstring

我正在尝试使用以下方法将 a`string`转换为`short`int：

```
short tempS = QString("%1").arg(arguement); 
```

其中参数是一个`QString`。但是我收到了错误：

> 交叉初始化`short int tempS`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:57:31.003

在 QString 类（[doc](http://qt-project.org/doc/qt-4.8/qstring.html#toShort) ）中有一个方法 toShort( ) ：

```
short tempS = arguement.toShort(); 
```

如文档中所示，可以指定两个参数：对布尔值的引用以检查转换是否成功，如果您想要除 10 以外的任何值，则为基数。

# c++ - 什么是 C++ 的 SystemEvents.SessionEnded 事件的等价物？

> ID：12981515
> 
> 赞同：2
> 
> 时间：2012-10-19T19:52:48.127
> 
> 标签：c++, events, session

我在非托管 WinAPIs 环境中使用 C++ 进行编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:54:35.067

您正在寻找`WM_ENDSESSION`windows 消息

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa376889(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376889(v=vs.85).aspx)

```
LRESULT MyWindowProc(HWND hwind, UINT msg, WPARAM wParam, LPARAM lParam) {
  switch (msg) {
    case WM_ENDSESSION: 
      // Session ended.  Just like SystemEvents.SessionEnded
      ...
      break;
    ...
  }
} 
```

# jquery - Jquery Modal Popup 使用 ASP.Net MVC3 在单击时打开两次

> ID：12981524
> 
> 赞同：0
> 
> 时间：2012-10-19T19:53:39.143
> 
> 标签：jquery, asp.net-mvc-3, events, jquery-events

我在我的 MVC3 应用程序中使用 Modal Popup，它工作正常，但单击链接会打开两次。

模态弹出是从我的主控制器的“索引”视图触发的。我`PopUp.cshtml`在我的模态弹出窗口中调用一个视图。相应视图的相关`ActionMethod`“弹出”位于我的“主页”控制器中。

这是代码：

**layout.cshtml 页面上的 Jquery 代码，**

```
<script type="text/javascript">
    $.ajaxSetup({ cache: false });

    $(document).ready(function () {
        $(".openPopup").live("click", function (e) {
            e.preventDefault();

            $("<div></div><p>")
                    .attr("id", $(this).attr("data-dialog-id"))
                    .appendTo("body")
                    .dialog({
                        autoOpen: true,
                        title: $(this).attr("data-dialog-title"),
                        modal: true,
                        height: 250,
                        width: 900,
                        left: 0,
                        buttons: { "Close": function () { $(this).dialog("close"); } }
                    })
                    .load(this.href);
        });

        $(".close").live("click", function (e) {
            e.preventDefault();
            $(this).dialog("close");
        });
    });
    </script> 
```

**'PopUp.cshtml' 中的 cshtml 代码**

```
@{
    ViewBag.Title = "PopUp";
    Layout = null;
}

<h2>PopUp</h2>

<p>
Hello this is a Modal Pop-Up
</p> 
```

**在 Home Controller 的 Index 视图中调用模态弹出代码，**

```
<p>
   @Html.ActionLink("Click here to open modal popup", "Popup", "Home",null, new { @class = "openPopup", data_dialog_id = "popuplDialog", data_dialog_title = "PopUp" })
</p> 
```

模态弹出窗口打开两次我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T23:07:31.247

尝试这个。它检查是否已经存在一个对话框，而不是创建一个。

还要确保你没有在多个地方绑定你的点击事件（也检查内部/外部元素）

```
<script type="text/javascript">
    $(function(){
        $(document).on("click",".openPopup",function (e) {
            var url = this.href;
            var dialog = $("#dialog");
            if ($("#dialog").length == 0) {
                dialog = $('<div id="dialog" style="display:hidden"></div>').appendTo('body');
            }
            dialog.load(
                url,
                {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
                function (responseText, textStatus, XMLHttpRequest) {
                    dialog.dialog({                       
                        close: function (event, ui) {                            
                            dialog.remove();
                        },
                        modal: true,
                        width: 460, resizable: false
                    });
                }
            );           
            return false;           
        });
    });
</script> 
```

# windows-phone-7 - 如何立即处理来自 WP7 麦克风的音频？

> ID：12981525
> 
> 赞同：0
> 
> 时间：2012-10-19T19:53:44.067
> 
> 标签：windows-phone-7, audio, microphone

我正在寻找立即处理来自麦克风的音频的方法（添加一些效果等）。我在 WP7 中检查了麦克风的 API，但没有找到解决方法（我只能在之后的部分中做到这一点）

有人可以建议我在声音响起后立即访问音频的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:39:21.103

无论如何，您都需要通过标准麦克风例程对其进行处理，因此即使您计划实现“随用随用”的声音转换器，您仍然需要访问缓冲区、执行修改然后重播。详情[在这里](http://msdn.microsoft.com/en-us/library/windowsphone/develop/gg442302%28v=vs.92%29.aspx)。

# java - 如何使 requestscope 可用于 jsf 中的多个请求？

> ID：12981533
> 
> 赞同：0
> 
> 时间：2012-10-19T19:54:18.900
> 
> 标签：java, jsp, jsf

在我的 JSF 应用程序中，一些值设置为 requestScope，一些值设置在 sessionScope 中。例如，如果您正在预订，则 DTO 保存在 sessionScope 中，以便在下一页和之后成功提交预订后可用。因此，用户可以将预订保存为下一页中的模板，并在以后使用该模板。保存模板后，用户将被重定向到主页。这些预订值保存在 sessionscope 中，但其他一些值仅在 requestScope 中设置的成功提交页面中需要。因此 requestScope 在加载此页面时完成了所需的工作。然后我遇到了一个问题，如果用户使用已经可以保存为模板的名称，则在签入支持 bean 的数据库后，页面应该返回到带有错误消息的同一页面，而不是转发到主页。由于预订值保存在 sessionScope 中，所以这不是问题。但是保存在 requestScope 中的其他值会丢失，并且我在 jsp 页面中得到 nullPointerException。有什么方法可以在不使用 sessionScope 作为其他值的情况下完成我的任务。我认为的一种方法是在 jsp 中使用 postrender 函数在 backing bean 中再次设置这些 requestscope 值。但我不确定请求值是否可用于后期渲染。有人可以帮我吗？我认为的一种方法是在 jsp 中使用 postrender 函数在 backing bean 中再次设置这些 requestscope 值。但我不确定请求值是否可用于后期渲染。有人可以帮我吗？我认为的一种方法是在 jsp 中使用 postrender 函数在 backing bean 中再次设置这些 requestscope 值。但我不确定请求值是否可用于后期渲染。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:32:13.787

即使问题中缺少此信息，我仍假设您仍在使用旧版 JSF 1.x 并且无法[迁移](https://stackoverflow.com/questions/4441713/migrating-from-jsf-1-2-to-jsf-2-0)到提供新[视图范围](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)的 JSF 2.x ，否则您不会问这个问题。IBM 标签的出现也暗示了一些关于一些遗留怪物的东西。

获取JSF 1.2 的[Tomahawk](http://myfaces.apache.org/tomahawk-project/tomahawk12/index.html)[`<t:saveState>`](http://myfaces.apache.org/tomahawk-project/tomahawk12/tagdoc/t_saveState.html)并通过视图中的任何位置引用您的请求范围 bean 。

```
<t:saveState value="#{managedBeanName}" /> 
```

就这样。这在幕后与新的 JSF 2.0 视图范围所做的完全一样。因此，通过这种方式，您的`#{managedBeanName}`实例实际上变成了一个视图范围的 bean。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:33:55.103

如果您在 JSF 2 中，则可以使用 @ViewScoped 注释使您的 bean 在用户处于同一视图中时处于活动状态。

如果您使用的是 JSF 1.2，则必须使用为您处理此问题的第三方库。我只知道两种选择：

*   从 Tomahawk 库中，您可以使用该[`<t:stavestate>`](http://myfaces.apache.org/tomahawk-project/tomahawk12/tagdoc/t_saveState.html)组件。

*   从 RichFaces 3.3.x 开始，您可以[`<a4j:keepAlive>`](http://livedemo.exadel.com/richfaces-demo/richfaces/keepAlive.jsf?c=keepAlive&tab=usage)在类中使用组件或作为注释。我已经使用过这个，它有很大的帮助。我给你举个例子。

在 faces-config.xml 文件中具有 RequestScope 配置的托管 bean。

```
@KeepAlive
public class Bean {
    private String name;
    //constructor...
    //getters and setters...
} 
```

您的 JSP/Facelets 页面：

```
<h:form>
    <h:outputText value="Write your name" />
    <h:inputText value="#{bean.name}" />
    <br />
    <a4j:commandButton value="Say hello!" reRender="hello" />
</h:form>
<!-- Since this is outside the form, the #{bean.name} value won't be send to the server -->
<h:outputText value="#{'Hello ' + bean.name}" id="hello" /> 
```

# upnp - Upnp 根设备与嵌入式设备

> ID：12981535
> 
> 赞同：3
> 
> 时间：2012-10-19T19:54:32.643
> 
> 标签：upnp

我目前正在将 UPnP 支持添加到应用程序中。它将充当媒体服务器、控制点和媒体渲染器。我的问题是媒体服务器和媒体渲染器应该实现为 2 个独立的设备还是一个带有 1 个嵌入式设备的根设备？

如果是后者，那么哪个是根设备？根设备和嵌入式设备的 UUID 是否相同，或者每个根/嵌入式设备是唯一的？

理想情况下，我只想宣传一种可以做所有事情的设备，但我不确定是否允许这样做。我查看了网络上的一些设备，但没有一个设备中嵌入了设备，这让我想知道是否有一个单一的设备规范可以做所有事情？
感谢这里的任何方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T22:27:29.160

[下面的任何引用都是来自[http://upnp.org/resources/upnpresources.zip](http://upnp.org/resources/upnpresources.zip)的捆绑包中的文档]

您不能将媒体服务器和渲染器组合成一个 UPnP 设备。UPnP-av-MediaRenderer-v3-Device-20101231.pdf & UPnP-av-MediaServer-v4-Device-20101231.pdf 为服务器和渲染器定义特定的设备类型（请参阅每个文档的第 3 节），因此您需要单独的 UPnP设备。

但是，我认为您可以在另一个中嵌入一个（任一）设备。上述每个文档的第 2.2 节（设备模型）都说渲染器和服务器设备分别可以是根设备或嵌入式设备。

如果你决定使用嵌入式设备，我相信每个设备都应该有自己的 UUID。我找不到明确的参考资料，但它似乎强烈暗示在 v1.1 架构文档的第 2.3 节（设备描述）中。这也是我在我维护的 UPnP 堆栈中所做的，我没有发现这会导致任何问题。

综上所述，如果您希望其他程序将您的服务器或渲染器用作标准 UPnP 设备，而与您的组合服务器 + 渲染器 + 控制点无关，那么您只需要担心这些。如果您不关心第三方使用服务器或渲染器，您可以自由地为您的产品做任何事情。因此，您可以方便地实施尽可能多或少的 UPnP 规范。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-15T13:06:34.680

您可以宣传 2 个不同的设备（MediaServer 和 MediaRenderer），每个设备都有自己的设备描述 XML 文件 URL。每个设备都有自己的 UUID。

其他 UPnP 设备对不同的设备和服务感兴趣。DLNA 电视将搜索 MedServer 设备。ControlPoint 将搜索 MediaServer 和 MediaRenderer 设备。

ControlPoint 不会将自己宣传为设备或提供服务，因此没有设备描述 XML 文件或服务 XML 文件。

使用嵌入式 UPnP 设备似乎没有被广泛使用，因此可能与其他 UPnP 控制点实现不兼容。

# internet-explorer-9 - 解释 IE9 ltime & htime localStorage 时间戳

> ID：12981540
> 
> 赞同：3
> 
> 时间：2012-10-19T19:54:51.437
> 
> 标签：internet-explorer-9, local-storage, timestamp, computer-forensics

以下是来自 IE9 localStorage 文件的一些示例 XML：

```
<root>
  <item name="1264474612:page_insights:latestversion" 
  value="6"
  ltime="1024039440" 
  htime="30244985" />
</root> 
```

我试图弄清楚如何解释这些类型的记录，包括 ltime 和 htime 值。我从研究中发现它与 IE9 localStorage 和来自`%userprofile%\AppData\Local\Microsoft\Internet Explorer\DOMStore\`.

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T06:06:11.270

`ltime`和`htime`是 64 位时间值的一部分，其中一个是较低的，另一个是较高的 32 位值。

两种最常用的 64 位时间格式是 64 位版本的 Unix ( *POSIX* ) 时间和 Windows *FILETIME*（仅限 64 位）。

*   *POSIX*时间是自 1970 年 1 月 1 日以来 UTC 的秒数。
*   Windows *FILETIME*是自 UTC 时间 1601 年 1 月 1 日以来的纳秒数。

同时使用`ltime`和`htime`，要获得 64 位值，必须先将每个值转换为十六进制。

```
ltime = 1024039440 (decimal) = 0x3d099a10 (hexadecimal)
htime =   30244985 (decimal) = 0x01cd8079 (hexadecimal)

value = (htime x 0x100000000) + ltime
      = (0x01cd8079 x 0x100000000) + 0x3d099a10
      = 0x01cd807900000000 + 0x3d099a10
      = 0x01cd80793d099a10 (hexadecimal)
      = 129901222467050000 (decimal) 
```

如果上述结果使用*FILETIME*和*POSIX*格式计算，则*FILETIME*时间为`2012-08-22, 08:17:26.705`，而*POSIX*时间为`4116407840-06-22, 09:53:20`。因此，更有可能将*FILETIME*格式用于时间戳，因为*POSIX*时间将超过当前年份（2012 年）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-20T10:06:45.867

如果您正在寻找一个程序来为您解码这些值，请查看[DCode](https://www.digital-detective.net/digital-forensic-software/free-tools/)。

[![代码](../Images/bcd4d2e226d117c803461d2917b623d9.png)](https://i.stack.imgur.com/WXlZH.png)
[（来源：[digital-detective.co.uk](http://www.digital-detective.co.uk/images/screenshots/Dcode.png)）]

您将选择值`Windows: Cookie Date (Lo Value, Hi Value)`，然后输入数字，如`1024039440,30244985`。

使用 UTC 作为时区，这些值被解释为：`Wed, 22 August 2012 15:17:26 UTC`

# asp.net - 将 SQL 数据重新绑定到下拉列表，但保留 aspx 页面中的硬编码选项

> ID：12981549
> 
> 赞同：0
> 
> 时间：2012-10-19T19:55:26.737
> 
> 标签：asp.net, webforms, .net-4.5

我的 aspx 页面中有一个带有 3 个硬编码选项的 DropDownList，其中还包含来自后面代码的 SQL 服务器的数据（AppendDataBoundItems="true"）。我想做的是始终保留这 3 个硬编码选项，但是当部分或整个页面重新加载时，从数据库中提取的任何新 SQL 数据都将覆盖现有的 SQL 数据绑定信息，但保留 3 个硬编码选项不变。

ASPX 页面代码：

```
<asp:DropDownList ID="ddlParentLocation" runat="server">
        <asp:ListItem Value="" Text="Select Parent Location" />
        <asp:ListItem Value="" Text="None" />
        <asp:ListItem Value="" Text="Unknown" />
    </asp:DropDownList> 
```

代码隐藏：

```
protected void ddlMediaList_SelectedIndexChanged(object sender, EventArgs e)
{
    //Load existing locations for SelectedID
    ddlParentLocation.DataSource = SQLHelper.GetDataByQuery("SELECT LocationID, LocationName FROM dbo.vwLocations WHERE SectionID = '" + ddlMediaList.SelectedValue.ToString() + "'");
    ddlParentLocation.DataValueField = "LocationID";
    ddlParentLocation.DataTextField = "LocationName";
    ddlParentLocation.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T11:28:05.897

您所要做的就是在绑定之前记住这些列表项。你可以这样做：

```
 List<ListItem> itemList = new List<ListItem>(ddl1.Items.Count);
            foreach (ListItem item in ddl1.Items)
            {
                itemList.Add(item);
            } 
```

然后在绑定后你可以像这样添加它们：

```
 foreach (ListItem item in itemList)
            {
                ddl1.Items.Add(item);
            } 
```

如果您希望它们位于列表顶部，则可以使用 Insert 而不是 Add。

# python - 使用 beautifulsoup从标签中获取字符串

> ID：12981551
> 
> 赞同：2
> 
> 时间：2012-10-19T19:55:30.120
> 
> 标签：python, python-2.7, beautifulsoup

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:57:18.527

直接循环遍历`findAll`结果：

```
for elem in res.findAll('a'):
    print elem 
```

该`.find()`方法只返回它找到的第一个元素`res`，它不会从您找到的最后一个命中继续搜索。因此，在每次循环运行时，它都会找到相同的元素。

如果要限制结果的数量，请使用切片表示法：

```
for elem in res.findAll('a')[:3]:
    print elem 
```

# javascript - 如何在ie9或ie8中通过javascript读取本地图片文件？

> ID：12981552
> 
> 赞同：1
> 
> 时间：2012-10-19T19:55:34.923
> 
> 标签：javascript, internet-explorer, file-io

我想通过 ie9 或 ie8 中的 java-script 读取本地文件图片。那可能吗？

我只想阅读对象并将其显示在我发现 ie8 和 ie9 部分支持

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAI
AAAFSDNYfAAAAaklEQVR42u3XQQrAIAwAQeP%2F%2F6wf8CJBJTK9lnQ7FpHGaOurt1
I34nfH9pMMZAZ8BwMGEvvh%2BBsJCAgICLwIOA8EBAQEBAQEBAQEBK79H5RfIQAAAAA
AAAAAAAAAAAAAAAAAAAAAAID%2FABMSqAfj%2FsLmvAAAAABJRU5ErkJggg%3D%3D"> 
```

我想读取二进制文件并将其转换为上面的表单字符串。这样我就可以显示本地图片。

我只想支持ie8和ie9。我已经完成了ff部分，客户要支持ie8和ie9

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-27T23:49:32.657

是的，你可以（就像我几乎不知道的一些奇怪的人会说的那样）... 是的，你可以通过 ActiveX使用**FSO/OpenTextFile使用 Internet Explorer 在 Javascript 中读取和写入二进制文件。**事实上，我什至写了一个 Javascript “ *Fichier* ”（我是法国人）类，它允许 Internet Explorer 以各种模式打开本地文件，包括直接访问模式，提供 Seek(position)、Read(numberOfBytes)、Write(string)和按需保存更改。

例如，它还可以将整个文件加载到字符串中并将其转换为 Base-64：这允许直接从本地磁盘加载图像文件，而不是让它们被某些 Web 服务器上传并随后下载回客户端: 认为从西伦敦到伦敦中心，你必须先从西伦敦到格拉斯哥，然后再从格拉斯哥回到伦敦中心，这真的很奇怪吗？

关键是**您只需要知道一个小秘密**，否则您将无法将所有字节写入磁盘，也无法将加载的文件转换为 Base-64。考虑到以下两点，我只想告诉你这个秘密：

. 首先，您必须逐字节读取文件，而不是 n>1 的 readAll() 或 read(n)。这样，您可以防止浏览器在某些情况下关联多个字节。因此，您将在内部创建一个带有“objectFile.Read(1)”的循环。

. 其次，这是秘密：在 ASCII+ 表的 256 个字符中（扩展至第 8 位），其中 27 个具有异常行为，这是阻止您操作二进制文件的唯一因素：这 27 个字符位于范围内2个“段落”，即从128到159（80h到9Fh）的32个字节，其中5个除外：129,141,143,144,157：这5个行为正常。但是对于 32 范围内的其他 27 个字节，一旦从磁盘中读取它们，它们就会被更改为 16 位值：例如，欧元符号应该是 UTF- 中的字符 128 (80h) 8，它确实是写入文件中的值。但是在浏览器的内存中，一旦你从磁盘中读取了 80h 字节，它就变成了一个 16 位的值：8364(20ACh)。

要理解这一点，请尝试以下代码，假设您可以在“D:\”目录上写入，否则将代码更改为指定另一个目录，您的浏览器有权在该目录上写入。

```
<script type="text/javascript'>
    fso = new ActiveXObject("Scripting.FileSystemObject");
    oFich = fso.OpenTextFile("d:\\foo.txt", 2, true);
    var c1 = String.fromCharCode(65); // 65 is the ASCII code for "A"
    oFich.write(c1);
    oFich.close();
</script> 
```

执行该代码后，您会在磁盘上找到一个“foo.txt”文件：在您的文本板中打开它，您会看到一个完美的“A”。

现在，在上面 Javascript 代码的第 3 行，您可以将值“65”替换为任何其他值，例如“66”将“B”写入 foo.txt 文件，“97”将写入“a”， “55”会写成“7”等等……但是现在，用值“128”试试吧：它变得不愉快，因为你被浏览器侮辱了！像这样：

```
 "Incorrect argument or procedure call" 
```

好吧，您想要的只是将“€”符号写入您的文件中。为什么你不能这样做？因为值 128 不能通过 FSO 写入。上面提到的其他 26 个值也是如此。顺便说一句，不要断定是第 8 位导致该故障，因为 128 是前 8 位数字：如果您将 128 替换为 160 到 255 之间的任何数字，也设置了第 7 位，您'将能够看到它运行良好。

所以，现在试试这个：

```
fso = new ActiveXObject("Scripting.FileSystemObject");
oFich = fso.OpenTextFile("d:\\foo.txt", 2, true);
var c1 = String.fromCharCode(8364); // 8364  (unicode for "€" symbol ?)
oFich.write(c1);
oFich.close(); 
```

您会满意地注意到执行后没有更多的错误消息。然后，输入你的“foo.txt”，你会看到一个漂亮的“€”符号。但令您惊讶的是，如果您将该文件加载到十六进制“转储程序”工具中，您会看到代码不是“AC 20”（8364）而是“80”（128）！

知道了这一点，您现在可以将任何字节字符串转换为 Base-64 或将任何字节字符串写入文件，只要您知道要将“128”字节写入磁盘，除了替换它之外别无他法通过 8364 (20ACh)。顺便说一句，如果你真的想写 8364(20ACh) 没问题：但这意味着你的文件是 16 位值的组合，而不是简单的字节范围。因此，您只需编写结合该数字的两个字节，首先写入低字节：

```
 oFich.write(String.fromCharCode(172)); // 172 = ACh
      oFich.write(String.fromCharCode(32));  //  32 = 20h 
```

就您仅操作文本而言，您无事可做：“€”在浏览器的内存和磁盘上的写入方式不同，但它仍然是“€”，因此它是透明的。但是如果你加载字节 128 作为它的数值，那么你会遇到问题，因为你会得到 8364 而不是从文件中读取的每 128 个：这就是为什么很多人在尝试编码时失败的原因Javascript 中的 base-64。

事实上，当你希望它们取数值时，你只需要过滤这 27 个厄运字符。这就是为什么我编写了以下两个函数，我在我的“ *Fichier* ”类的某些部分使用它们，在需要它们的地方，以及在我的 Base-64 算法中，当我直接从客户端磁盘加载图像文件时，或者当我必须将字节作为数字而不是字符来操作时：

这两个函数抵消了它们 Javascript 模型的部分“*变态”：*

```
 `String.fromCharcode() and String.charCodeAt()` 
```

因为他们只是简单地封装了他们的模型，所以我给了他们经典的 Basic 名称：“asc”和“chr”，因此它们既易于理解又易于记忆。他们来了：

```
function asc(c) //(string)->integer
{   // Objet : Renvoie le code ASCII du 1er caractère de la chaine "c"
    var i = c.charCodeAt(0);
    if (i < 256)
        return i;       // caractères ordinaires
    // (plage 128-159 excepté les 5 caractères 129,141,143,144,157, qui fonctionnent normalement)
    switch (i) {
        case 8364:      // "€" 
            return 128
        case 8218:
            return 130
        case 402:
            return 131
        case 8222:
            return 132
        case 8230:
            return 133
        case 8224:
            return 134
        case 8225:
            return 135
        case 710:
            return 136
        case 8240:
            return 137
        case 352:
            return 138
        case 8249:
            return 139
        case 338:
            return 140
        case 381:
            return 142
        case 8216:
            return 145
        case 8217:
            return 146
        case 8220:
            return 147
        case 8221:
            return 148
        case 8226:
            return 149
        case 8211:
            return 150
        case 8212:
            return 151
        case 732:
            return 152
        case 8482:
            return 153
        case 353:
            return 154
        case 8250:
            return 155
        case 339:
            return 156
        case 382:
            return 158
        case 376:
            return 159
        default:
            return -1       // provoquera une erreur, le cas ne devant pas se présenter
    }
}
function chr(octet) //->(integer)->string
{   // Objet  : renvoie le caractère d'un nombre 8 bits
    // Entrée : "octet" est un nombre 8 bits non signé (entre 0 et 255)
    // Sortie : le caractère correspondant est renvoyé, les codes échappés sont rattrapés par un switch
    if (octet < 128) || (octet > 159))
        return String.fromCharCode(octet);     // caractères ordinaires, traités par String.fromCharCode
    switch (octet) {
        case 128:
            return "€"
        case 129:
            return String.fromCharCode(129);
        case 130:
            return "‚"
        case 131:
            return "ƒ"
        case 132:
            return "„"
        case 133:
            return "…"
        case 134:
            return "†"
        case 135:
            return "‡"
        case 136:
            return "ˆ"
        case 137:
            return "‰"
        case 138:
            return "Š"
        case 139:
            return "‹"
        case 140:
            return "Œ"
        case 141:
            return String.fromCharCode(141);
        case 142:
            return "Ž"
        case 143:
            return String.fromCharCode(143);
        case 144:
            return String.fromCharCode(144);
        case 145:
            return "‘"
        case 146:
            return "’"
        case 147:
            return "“"
        case 148:
            return "”"
        case 149:
            return "•"
        case 150:
            return "–"
        case 151:
            return "—"
        case 152:
            return "˜"
        case 153:
            return "™"
        case 154:
            return "š"
        case 155:
            return "›"
        case 156:
            return "œ"
        case 157:
            return String.fromCharCode(157);
        case 158:
            return "ž"
        case 159:
            return "Ÿ"
        default:
            return String.fromCharCode(octet);         // unicode 16 bits
    }
} 
```

现在，您可以使用 ActiveX 在您允许 IE 访问文件的磁盘的每个区域上使用 Internet Explorer 二进制读取和写入任何类型的文件。

正如伟大而怀念的法国幽默家 Pierre Desproges 曾经说过的那样：“ *Etonnant，非？* ”

BB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:05:05.477

出于安全原因，JavaScript 没有此功能。

因为我们访问本地文件系统。因此出于安全原因，我们无法在 JavaScript 中看到文件夹结构或上传的文件路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-17T19:33:45.100

扩展 David 的评论 - MS 承诺支持 IE10 的 FileAPI 标准。浏览器包的其余部分在 HTML5 上遥遥领先。

对于 IE8-9，您可能必须使用 ActiveX 或 Flash 的 SWFObject 之类的插件

# iphone - Why my Ajax request doesn't work in Safari on IOS?

> ID：12981561
> 
> 赞同：1
> 
> 时间：2012-10-19T19:56:15.183
> 
> 标签：iphone, ajax, jquery

I have an ajax jsonp request done with JQuery that is done in the $(document).ready. It works perfectly fine in all browsers and even in Chrome on IOS but it doesn't always work in Safari on IOS. Sometimes, the code never return to success nor complete.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:56:15.183

I ran into this today and spent a lot of time to fix it. Finally, what solved the issue was to move the javascript code at the end of the page instead of in the document.ready. This seem to be a bug with Safari.

I thought I'd share in case anyone else runs into this!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-22T02:54:53.777

Try to turn off "Private" browsing in Safari.

# php - 监控页面刷新选项

> ID：12981567
> 
> 赞同：0
> 
> 时间：2012-10-19T19:56:44.927
> 
> 标签：php, javascript, pixel, page-refresh, browser-refresh

这更像是一个开放式问题，而不是我实际发布代码，但这就是我正在做的事情：

我有几个动作可以让用户在我们的网站上获得奖励积分。我创建了几个像素跟踪器，它们使用 javascript document.write 在页面加载时触发，图像传递必要的变量，我的 PHP 程序使用数据库工作，并使用 header 函数返回 GIF 图像。这一切都很好，我对此非常满意，但我需要找到一种解决方案来阻止用户简单地刷新他们获得积分的页面并继续收集。我曾尝试使用有效的 PHP cookie，但说我在网站上的其他地方导航，例如在不同的产品上写了 2 条评论，它没有给我第二次评论的分数。我尝试在javascript中检测刷新以阻止图像触发，但似乎没有代码正常工作，有人有任何想法或见解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:02:46.337

您应该创建一个记录奖励积分的表格，以及当该代码处理它并添加新积分时，它首先检查那里。

因此，每次奖励积分时，请将其存储在日志中：John Smith 1 point on a review id #20029

然后当他刷新时，检查日志： John Smith 是否为这条评论 id #20029 获得了积分？是的。

```
Yes { do nothing }
No { Add a point } 
```

...你明白了——为此使用一个 sql 表。

# esri - ArcGIS Server 的替代品

> ID：12981575
> 
> 赞同：5
> 
> 时间：2012-10-19T19:57:18.947
> 
> 标签：esri, arcgis-server

我一直在用 ESRI 的 JSAPI 开发一些网络地图。目前我在 SQL Server 中存储以下层：

> 1,000,000 点
> 
> 30,000 个多边形
> 
> 1,000 多边形

这些需要彼此叠加显示。我还需要能够进行一些高级查询和特征识别。

到目前为止，我已经构建了一些工具，但我很好奇是否有更好的选择。我看过`CartoDB`，但目前它不支持多层。您似乎可以使用 CartoDB 和 Google Maps API，但我觉得这增加了额外的复杂性。我读过一些关于传单、mapbox、opengeo 等的内容。

那么归结为 SQL Server/ArcGIS Server/ESRI JSAPI 的一个不错的替代方案是什么？

谢谢，埃文

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T21:43:23.853

等效的开源堆栈是 PostGIS/PostgreSQL + GeoServer + OpenLayers。将数据存储在数据库中，通过 GeoServer 渲染，与 OpenLayers 交互。如果您正在构建更复杂的内置应用程序，请使用 GeoExt/ExtJS 构建界面。

正如评论者所说，您可以通过构建简单的空间 SQL 查询并将它们传递到后端，直接从空间数据库中提供大量查询。不过，对于渲染 1M 点，您可能最终需要渲染引擎。将 GeoServer SQL 图层视为动态呈现复杂查询图层的潜在路径。

我提到的组件可以单独下载（postgis.org、geoserver.org、openlayers.org）或作为集成块通过 OpenGeo 套件（opengeo.org）下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T15:08:48.443

您可能想看看[MapDotNet](http://www.mapdotnet.com)，特别是如果您打算将数据保存在 SQL Server 中。我对他们没有任何直接的经验，但从我所阅读和听到的内容来看，这听起来像是一个很好的产品。他们也有一个名为 touchgeo 的 HTML5/JS API/解决方案。

正如上面提到的@stakx，您可能想查看[MapServer](http://mapserver.org/index.html)。

# objective-c - 如何从代码中访问已经存在的 UIPickerView

> ID：12981579
> 
> 赞同：0
> 
> 时间：2012-10-19T19:57:19.853
> 
> 标签：objective-c, ios, uiviewcontroller, uipickerview

我的故事板中有这个 PickerView 已经存在的 UIPickerView，隐藏设置为 YES，我想让这个选择器在按下按钮时可见，但我对如何执行此操作一无所知。

我已经尝试通过它的标识来获取这个 ViewController，但是我无法在 xcode 上找到这个属性，我什至不确定 UIPickerView 有一个标识符......

这是按下按钮后应执行的操作中的代码。

```
-(IBAction)actionButtonPressed:(id)sender{
    isFeelingPicker = FALSE;
    isActivityPicker = TRUE;

    UIPickerView* picker;

    picker = [self.storyboard instantiateViewControllerWithIdentifier:@"Picker"];

    [picker setHidden:NO];

} 
```

顺便说一句，我对IOS真的很陌生，所以那里应该有很多错误x_x

编辑：

Picker 的 numberOfRowsInComponent

```
-(NSInteger) pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:        (NSInteger)component{
    if(isActivityPicker){
        return activities_.count;
    }
    else if(isFeelingPicker){
        return feelings_.count;
    }
    else{
        return 0;
    }
} 
```

# plone - Plone and Dexterity - 如何将我的一种内容类型的表单添加到我的页面？

> ID：12981581
> 
> 赞同：0
> 
> 时间：2012-10-19T19:57:20.497
> 
> 标签：plone, dexterity, contenttypes

所以我有一个与游戏有关的网页。我希望用户能够将有关他们自己的游戏的信息添加到该网站。我有一个名为“添加游戏”的标签。当用户单击此选项卡时，我希望出现一个表单，他们可以填写该表单以添加有关其游戏的信息。我正在使用敏捷。当我以“管理员”身份登录时，我可以进入“站点设置”，然后进入“敏捷内容类型”，然后将新类型或新字段添加到现有类型。现在我添加了一个名为“游戏”的类型，我希望我作为管理员使用的表单也可供“添加游戏”选项卡下的任何用户使用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T20:59:49.163

1.  添加一个文件夹式敏捷内容类型“游戏”并在您的门户中添加一个“游戏”实例。这应该是用户生成游戏的容器。在这里，他们获得了将内容添加为匿名的权限。
2.  转到ZMI并添加一个cmf动作“添加游戏”（http://localhost:8080/plone/portal_actions/portal_tabs/manage_main）
3.  动作的url应该是：string:${globals_view/navigationRootUrl}/games/++add++game（“添加游戏”链接的链接地址）（http://localhost:8080/plone/portal_actions/ portal_tabs/add%20a%20game/manage_propertiesForm)

现在，您可以作为管理员在“游戏”文件夹中创建游戏。以匿名用户身份创建游戏的权限在工作流程中进行了调整。

1.  复制portal_workflows（http://localhost:8080/plone/portal_workflow/manage_main）中的“单态工作流”
2.  在新创建的工作流的“权限”选项卡中，您可以添加托管权限“添加门户内容”。
3.  在“状态”选项卡中，您可以找到工作流的唯一状态“已发布”。点击它。在“权限”选项卡中，您可以将“添加门户内容”授予匿名。
4.  转到portal_workflow (http://localhost:8080/plone/portal_workflow/manage_selectWorkflows) 并将新的工作流分配给新的文件夹内容类型“游戏”。

现在匿名者能够在游戏中创建游戏。但是匿名者看不到他们的游戏。但是您可以选择或/和调整内容类型“游戏”的工作流程，以将“查看”权限分配给每个人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T10:48:09.823

登录后添加游戏的权限可以通过绿色编辑栏“游戏”文件夹的共享选项卡设置（auth.Users点击“添加”权限），无需触摸工作流程。

要在主菜单中添加“添加游戏”选项卡，请按照 pabo 的建议进行操作。

# sql-server-2008-r2 - 我无法从 Visual Studio 2010 连接到 SQL Server 2008 R2

> ID：12981583
> 
> 赞同：0
> 
> 时间：2012-10-19T19:53:14.050
> 
> 标签：sql-server-2008-r2, visual-studio-2010

我在 Win 7 32 位上安装了 SQL Server 2008 R2。它正确安装并创建了一个数据库。我打开 Visual Studio 2010 并编写了一个连接到 SQL Server 的代码。

```
cn = new SqlConnection();
cn.ConnectionString = "Data Source=(local); Initial Catalog=XXX_amlak; User ID=sa; password=XXX";
cn.Open(); 
```

但我得到这个错误。

> *SQLException was unhandled*
> *建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）*

Visual Studio 已自动安装 SQL Server Express。

# javascript - 如何获取具有固定或绝对位置的块级元素以确定边缘是否从页面上脱落并进行调整？

> ID：12981590
> 
> 赞同：1
> 
> 时间：2012-10-19T19:57:43.990
> 
> 标签：javascript, jquery, html, css, dom

好的，我正在尝试向现有页面添加一个元素，该元素将显示在一个按钮上方/下方，该按钮将打开/关闭它。这个元素触发器被添加到我正在添加它的页面的几个组件中。在大多数情况下，当它在触发元素下方打开时显示元素是可以的。然而。肯定有少数情况下，当切换打开时元素会下降到页面视图下方，假设用户没有一直向下滚动以补偿元素打开（他们为什么会这样）所以为了便于使用对于我的用户，我希望这个元素在它掉出查看窗格的情况下而不是在上面打开的触发器下方打开（UI 必须更改以补偿一点，以及触发器以图形方式连接到打开的框漂亮的流体外观，无论如何，那部分是无关紧要的，那是一种视觉魔法。它确定打开时元素是否在端口之外，如果是，则使其加载到触发器上方。

现在要避免显而易见的事情。“你做了什么”。好吧，没什么。使元素在下面对齐很容易我以前做过，我倾向于获取触发器位置，然后根据它的底部对齐元素以根据触发器位置进行匹配。所以，只是试图解决如何处理的问题，如果它超出端口甚至几个像素使其加载到触发器之上。我将如何补偿这样的事情是关键问题，是否有我可以遵循的特定技术，或者如果你愿意的话，我应该在这样做时考虑什么“魔法”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:20:52.317

使用 jQuery，您可以将处理程序附加到[`.scroll()`](http://api.jquery.com/scroll/)文档的。

通过该事件，您始终可以了解访问者正在查看的内容以及访问[`event`](http://api.jquery.com/category/events/event-object/)属性`.pageX`和`.pageY`

现在你知道了你点击元素的位置[`.offset()`](http://api.jquery.com/offset/)和它的[高度](http://api.jquery.com/?ns0=1&s=height&go=)。

您还可以获得窗口对象和要显示的元素的[高度](http://api.jquery.com/?ns0=1&s=height&go=)。

那么这只是一个计算问题..

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:05:08.427

我解决这个问题的方法是：

1.  为触发器和扩展/折叠元素添加一个容器，`overflow:visible;`并将容器设置为`position:relative;`
2.  下一个（显然）将扩展元素设置为`position:absolute`
3.  根据触发元素相对于屏幕的位置，设置扩展元素的 left 和 top 属性，将其定位在触发器的上方或下方。

# c - 需要帮助在我的简单 shell 程序中处理“CTRL-C”信号

> ID：12981594
> 
> 赞同：1
> 
> 时间：2012-10-19T19:57:52.853
> 
> 标签：c, shell

我在处理“CTRL-C”信号时遇到了一些问题，我需要的是 handle_SIGINT 只输出一次，然后返回到设置函数中的读取，但我不知道该怎么做这个。我被告知要在 length=read 调用周围添加一个循环，因为 read 是一个阻塞调用。我只是对如何处理这些信号感到困惑。无论如何，我当前的输出是：

```
COMMAND->test
COMMAND->test2
COMMAND->test3
COMMAND->test4
COMMAND->^CFound your CTRL-C
Found your CTRL-C
COMMAND->Found your CTRL-C
COMMAND->Found your CTRL-C
COMMAND->error reading the command: Interrupted system call
^Z
Suspended

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <signal.h>

#define MAX_LINE 80 /* 80 chars per line, per command, should be enough. */

void handle_SIGINT()
{
  printf("Found your CTRL-C\n");
}

void setup(char inputBuffer[], char *args[],int *background)
{
    int length, /* # of characters in the command line */
         i,      /* loop index for accessing inputBuffer array */
         start,  /* index where beginning of next command parameter is */
        ct;     /* index of where to place the next parameter into args[] */

     ct = 0;

     /* read what the user enters on the command line */
     length = read(STDIN_FILENO, inputBuffer, MAX_LINE);  

     start = -1;
     if (length == 0)
        exit(0);            /* ^d was entered, end of user command stream */
     if (length < 0){
        perror("error reading the command");
    exit(-1);           /* terminate with error code of -1 */
    }

     /* examine every character in the inputBuffer */
     for (i = 0; i < length; i++) { 
        switch (inputBuffer[i]){
        case ' ':
        case '\t' :               /* argument separators */
            if(start != -1){
                args[ct] = &inputBuffer[start];    /* set up pointer */
                ct++;
            }
            inputBuffer[i] = '\0'; /* add a null char; make a C string */
            start = -1;
            break;

        case '\n':                 /* should be the final char examined */
            if (start != -1){
                args[ct] = &inputBuffer[start];     
                ct++;
            }
            inputBuffer[i] = '\0';
            args[ct] = NULL; /* no more arguments to this command */
            break;

        case '&':
            *background = 1;
            inputBuffer[i] = '\0';
            break;

        default :             /* some other character */
            if (start == -1)
                start = i;
    } 
    }    
    args[ct] = NULL; /* just in case the input line was > 80 */
} 

int main(void)
{
    char inputBuffer[MAX_LINE]; /* buffer to hold the command entered */
    int background;             /* equals 1 if a command is followed by '&' */
    char *args[MAX_LINE/2+1];/* command line (of 80) has max of 40 arguments */

    struct sigaction handler;
    handler.sa_handler = handle_SIGINT;
    sigaction(SIGINT, &handler, NULL);

    while (1){            /* Program terminates normally inside setup */
        background = 0;
    printf("COMMAND->");
        fflush(0);
        setup(inputBuffer, args, &background);       /* get next command */

        int pid;

    pid = fork(); /* for a child process */

    if (pid < 0) { /* check if error occurred with child process */
      fprintf(stderr, "Fork Failed");
      return 1;
    } else if (pid == 0) { /* child process */
      execvp(args[0], args);
    } else {
      if (background == 0){ /* check if the parent should wait */
        //wait(args);
        waitpid(pid, NULL, 0);
      }
    }

    /* the steps are:
      (1) fork a child process using fork()
      (2) the child process will invoke execvp()
      (3) if background == 0, the parent will wait, 
        otherwise returns to the setup() function. */
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:09:18.493

当 read() 返回 -1 时，检查`errno`- 如果是则`EINTR`返回以再次执行读取。 `EINTR`表示阻塞系统调用（在我们的例子中是 read()）被信号中断了，所以你可以安全地返回执行再读一个

```
 EINTR  The call was interrupted by a signal before any data was read; see signal(7). 
```

另一方面，在许多情况下按下 CTRL+C 表示用户想要终止程序，因此退出程序是预期的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:11:50.333

告诉您的程序在打印消息后忽略 handle_SIGINT 中的 SIGINT 信号。

```
void handle_SIGINT()
{
  printf("Found your CTRL-C\n");
  signal(SIGINT, SIG_IGN);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:47:22.083

这就是您应该使用以下方式编写的`sigaction()`：

```
struct sigaction new_handler,old_handler;

new_handler.sa_handler=handle_SIGINT;
sigemptyset(&new_handler.sa_mask);
new_handler.sa_flags=0;

sigaction(SIGINT,NULL, &old_handler);
if(old_handler.sa_handler != SIG_IGN)
   sigaction(SIGINT, &new_handler,NULL); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T23:07:05.547

作为建议，请尝试使您的程序尽可能可移植，我的意思是，在我看来，您可以使用 ANSI C 编写大量程序。

考虑使用 fgets() 而不是 read() 并且不要从不依赖行为，即使该行为有据可查，如 bimda 指出的那样。

```
void setup(char inputBuffer[], char *args[],int *background)
{
    char *ret; 
    int length; /* # of characters in the command line */
    int i;      /* loop index for accessing inputBuffer array */
    int start=-1;  /* index where beginning of next command parameter is */
    int ct=0;     /* index of where to place the next parameter into args[] */

     /* read what the user enters on the command line */
     ret = fgets(inputBuffer, MAX_LINE, stdin);  

     if(!ret)
        exit(0);            /* ^d was entered, end of user command stream */

    /* examine every character in the inputBuffer */
    for (i = 0; inputBuffer[i]; i++) {
            ...
    }
    ...
} 
```

和抄送部分作为patater说：

```
void handle_SIGINT()
{
    printf("Found your CTRL-C\n");
    signal(SIGINT, SIG_IGN);
} 
```

~$ 人信号

也许这不是你需要的，但这只是我的拙见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-28T14:21:34.530

正如上面其他人所说，我只是添加了一个while循环：

```
while((length = read(STDIN_FILENO, inputBuffer, MAX_LINE) == -1); 
```

# javascript - location.search 不适合我，因为它应该

> ID：12981595
> 
> 赞同：2
> 
> 时间：2012-10-19T19:57:56.403
> 
> 标签：javascript

当我输出 window.location.search 时，它会显示如下结果：

?x=0.8690746387001127 或任何其他数字

但实际上它应该是这样的

?filename=tryjsref_loc_search

谁能解释它为什么这样做？

这是我的示例代码

//页面网址： [http ://w3schools.com/jsref/tryit.asp?filename=tryjsref_loc_host](http://w3schools.com/jsref/tryit.asp?filename=tryjsref_loc_host)

```
<!DOCTYPE html>
<html>
<body>

<script>

document.write(window.location.search)

</script>

</body>
</html> 
```

代码输出

?x = 0.8690746387001127

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:03:46.653

首先，[w3schools 不是一个值得学习的好网站](http://w3fools.com/)。我会推荐[jqFundamentals](http://jqfundamentals.com/chapter/javascript-basics)代替（“javascript基础”部分）

话虽如此，它[`window.location.search`](https://developer.mozilla.org/en-US/docs/DOM/window.location)为您提供了窗口的当前查询字符串。在 w3school 的“Try It”站点的情况下，这似乎是一种`Math.rand()`通常用作[cachebuster](http://manikandanc.blogspot.com/2005/11/cache-busting-with-javascript.html)技术的方法。

如果您在单击“提交”按钮时正在运行 fiddler（或任何其他网络流量监视器），您将看到完整的 URL 为`http://w3schools.com/jsref/tryit_view.asp?x=0.42147885356098413`.

MDN 是 javascript 文档的重要来源，他们的条目[`window.location.search`](https://developer.mozilla.org/en-US/docs/DOM/window.location)说：

> 搜索 | 跟在 ? 后面的 URL 部分 符号，包括 ? 象征。| ?q=devmo

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T21:06:15.230

我假设您对 HTML 和 HTTP 不是很满意，并且您正在学习，因此没有调查页面的源代码以了解发生了什么。

这完全没问题。

这是该页面源代码的简化版本：

```
<form id="tryitform" name="tryitform"
      action="tryit_view.asp" method="post"
      target="view"
      onsubmit="validateForm();">

    Source Code: <input type="button" value="Submit Code &raquo;"
                        onclick="submitTryit()">

    Result: <textarea id="pre_code">
        <!-- Your source code goes here -->
    </textarea>

    <input type="hidden" id="code" name="code" />
    <input type="hidden" id="bt"   name="bt"   />

    <iframe id="viewIFRAME" name="view"
            src="tryit_view.asp?filename=tryjsref_loc_host">
    </iframe>

</form>

<script type="text/javascript">

// This Script is called when you press the "Submit Code" button
function submitTryit()
{
    // I'll omit the code, but what it does is this:

    // 1\. Take the text (your code) in the 'pre_code' textarea
    // and substitute '=' with 'w3equalsign'
    // and 'script' with 'w3scrw3ipttag'.

    // 2\. Put the modified text in the 'code' hidden input field

    // 3\. Change the form's action to "tryit_view.asp?x=" + a random number

    // 4\. Call validateForm(), which basically
    // only checks if the code doesn't exceed 5000 characters

    // 5\. Submit form
}

window.onload = function(){ submitTryit() }
// Call submitTryit() when the page first loads
// so the view is filled also when you first arrive.

</script> 
```

这里要理解的关键思想是，您编写的代码以`action`属性设置为“tryit_view.asp?x=”+ 一个随机数的形式进行，并且该`target`属性设置为“view”。表单上的这个`target`属性意味着表单提交的结果应该出现在[iframe](https://developer.mozilla.org/en-US/docs/HTML/Element/iframe)上，该 iframe的属性`name`设置为“view”。

所以你看，问题是你的代码实际上并没有在你在浏览器上看到的页面上运行。它实际上是通过 POST 发送到服务器的。
然后服务器响应一个不同的页面来填充 iframe 的内容。

iframe 基本上是嵌套在主页内的“矩形迷你浏览器”，它有一个不同的 URL，与主页的 URL 无关，也不会出现在地址栏上。此 URL 是表单操作的 URL。

现在大概服务器响应 POST 所做的只是在恢复上面那些奇怪的文本替换之后，使用您提交的代码创建一个 HTML 页面。
所以你的代码最终会在 iframe 中运行。

因此，当您编写`window.location`or时`location`，您的代码最终将实际访问 iframe 的位置，而不是主页的位置。

您可以像这样访问父页面的位置：

```
// 'parent', same as 'window.parent', refers to
// the frame which is the parent of the frame where
// this code is being run (the iframe named 'view').
document.write( parent.location.search ); 
```

或者像这样：

```
// "top" is the frame at the top of the frame hierarchy
document.write( top.location.search ); 
```

祝你学习顺利！

# iphone - IOS：如何在uiview上创建破坏效果动画

> ID：12981596
> 
> 赞同：3
> 
> 时间：2012-10-19T19:57:55.277
> 
> 标签：iphone, ios, animation, quartz-graphics, effect

我想创建一个效果来在拉伸后破坏视图。

它可以是像气球一样的流行音乐，爆炸，分裂成碎片，类似的东西，甚至只是简单地分成两半，然后我会淡出碎片。但是我在石英中没有发现任何类似的东西，或者对如何做到这一点有很多想法。

每个视图都彼此不同，但如果没有其他方法，我想我会创建一个可以单独动画的几个片段的背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:28:39.273

AFAIK 这种事情没有内置功能，但以下内容可能会为您指明正确的方向。我没有时间详细说明，但我觉得您可能会从一些通用指南中受益，至少在其他人可以提供示例代码或不同方法之前。

听起来您想实现一个简单的粒子生成器，将视图渲染为图像，然后将该图像输入生成器以创建粒子，然后根据所需效果为它们设置动画。

可能有现有的第三方库可以做到这一点（在实现类似的东西之前我会四处搜索），否则你可以采取一些方法，我只是给出基本的想法：

生成器获取图像并制作一些粒子形状的子图像（如碎片）。您需要一种算法来计算形状和大小，然后您可以在图像上使用 CAShapeLayer 蒙版或实际渲染较小的图像（如果使用一个图像对象作为带有掩码的多个 CALayers/UIImageViews 的源经过优化，仅将其需要的像素复制到屏幕上，而实际上并不复制数据，那么这可能是您的最佳选择。您可以通过四处搜索或作为最后的写作手段来确定该行为代码）。

一旦您拥有了视图/图层的集合，您可以使用另一种算法来计算给定效果的新尺寸/位置/旋转，并且只需使用标准动画 api 来移动由算法提供的集合的内容。同样，实施将取决于您可能需要进行的潜在优化。直接使用 CALayer 会比 UIImageViews 的集合有更好的性能。

# android - Android - 使用两个版本的 apk 时如何处理用户更新

> ID：12981598
> 
> 赞同：2
> 
> 时间：2012-10-19T19:58:01.270
> 
> 标签：android, apk

我目前在我的清单中有这个设置：

```
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="16"/> 
```

它适用于所有用户。但是现在我需要启用需要 minSdkVersion="8" 的谷歌云消息传递，所以我正在考虑只为小于 8 的版本制作一个版本，并将应用程序的其余部分针对版本 8 及更高版本。

有 2 个 apk 就够了吗，其中一个有

```
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="16"/> 
```

和另一个apk

```
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="16"/> 
```

这基本上就是我需要做的吗？或者还有什么需要配置的吗？我假设针对旧版本的版本应该将 android:targetSdkVersion="16" 更改为 7？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:25:26.920

来自 GCM 文档：

```
GCM requires Android 2.2 or later, so if your application cannot work without GCM, 
add the following line, where xx is the latest target SDK version:
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="xx"/> 
```

这意味着您可以添加一个 minSdkVersion 爱人而不是 8，GCM 将无法在这些设备上运行。当然，您需要检查代码中的 SDK 版本并跳过与 GCM 相关的所有内容。在这种情况下，不需要有 2 个不同的 APK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:01:52.563

我会将较低的目标更改为 7，但我不确定这是否真的有必要。

您还需要确保 SDK 8+ 的 APK 的 versionCode 高于另一个的 versionCode。

最后，您必须在控制台上的 APK 文件部分处于高级模式。

# grails - Grails：我可以将 GSP 存储在应用程序之外吗？

> ID：12981606
> 
> 赞同：2
> 
> 时间：2012-10-19T19:58:22.337
> 
> 标签：grails, path, render, gsp

我正在使用 grails 制作 CMS。我希望用户能够在线动态编辑他们的 GSP。为了他们修改后的 GSP 的安全，我想将它保存在服务器上的其他位置，而不是 WAR 结构中。

如何从其他位置加载或引用 GSP？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T21:42:12.877

我不确切知道，但也许，这个配置属性会帮助你：

```
grails.gsp.enable.reload = true
grails.gsp.view.dir = /path/to/your/gsps // default 'WEB-INF/grails-app/views ' 
```

# python - Panda3D和Python，只渲染一帧等问题

> ID：12981607
> 
> 赞同：1
> 
> 时间：2012-10-19T19:58:34.250
> 
> 标签：python, 3d, rendering, panda3d

我想在我的个人项目中使用 Panda3D，但是在阅读了文档和一些示例源代码之后，我仍然有几个问题：

*   如何仅渲染一帧并将其保存在文件中？事实上，我需要渲染 2 个不同的图像：一个对象，以及一个包含多个对象的场景，包括前一个对象，但每个对象只有一个帧，并且它们都需要保存为图像文件。

*   该应用程序将使用 Python 编码，并且需要非常可扩展（可供数千名用户使用）。Panda3D 适合这里吗？（关于我的 Python 程序，它几乎是一个恒定的复杂性，所以这里没有问题，3D 模型将是低多边形的，每个场景大约 5 到 20 个）。

*   我需要计算每个物体到相机的透视投影。是否可以直接访问顶点和面（位置、参数等）？

*   我可以重新着色我的 3D 对象吗？我需要为整个对象设置一个简单的颜色，但每个对象设置不同的颜色。是否可以？

另请注意，我是图形和游戏开发领域的新手，但我了解一些 3D 建模和 3D 理论，以及计算机成像理论。

谢谢你读我。

PS：我目前的主要替代方案是使用 Soya3D 或 PySoy，但它们似乎并没有得到非常积极的开发和优化，所以虽然它们的内存占用都较小，但我不知道它们是否真的会比Panda3D，因为它们不是很优化......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T21:51:56.580

*   您可以使用 截取场景的屏幕截图`self.win.saveScreenshot(Filename)`。例子：

    ```
    from panda3d.core import Filename

    file_name = Filename('whatever.png')) 
    self.win.saveScreenshot(file_name) 
    ```

*   我自己从未使用过 Panda3D Networking API，但它应该在客户端做得很好。拥有数千名用户的服务器端的性能可能没有那么好，但您可以使用其他更适合重型网络的技术（如 C 或 NodeJS）对服务器软件进行编码。

*   是的，您可以访问和修改顶点并将它们分组为面。默认顶点数据允许您设置顶点位置、法线、颜色和纹理坐标，但如果需要，您可以设置自己的自定义顶点格式。看一下手册：[Panda3D 手册：创建和填充 GeomVertexData](https://www.panda3d.org/manual/index.php/Creating_and_filling_a_GeomVertexData)

*   是的，可以使用设置对象颜色`object.setColor(r,g,b,a)`。更多信息：[Panda3D 手册：着色和重新着色](http://www.panda3d.org/manual/index.php/Tinting_and_Recoloring)

希望能帮助到你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T13:32:18.087

*   您可以使用启用了 setOneShot 的缓冲区，使其仅呈现单个帧。您可以通过将“window-type”PRC 变量设置为“none”来启动不带窗口的 Panda3D，然后自己打开一个屏幕外缓冲区。（注意：没有主机窗口的屏幕外缓冲区可能不被普遍支持。）如果您将“窗口类型”设置为“屏幕外”，`base.win`实际上将是一个缓冲区（这可能比必须设置自己的要容易一些），之后，您可以调用`base.graphicsEngine.render_frame()`以渲染单个帧，同时避免任务管理器的开销。由于双缓冲，您必须调用它两次。
*   是的。迪士尼将 Panda3D 用于他们的一些 MMORPG。我必须补充一点，Panda 的高级网络接口的文档记录很差。
*   您可以使用 计算从对象到相机`nodepath.get_transform(base.cam)`的转换，这是一个 TransformState 对象，您可以选择使用 将其转换为矩阵`ts.get_mat()`。这速度惊人的快，因为 Panda 为转换维护了一个组合缓存，因此不必多次发生这种情况。`lens.get_projection_mat()`您可以使用或逆使用获取投影矩阵（从视图空间到剪辑空间）`lens.get_projection_mat_inv()`。您还可以使用 Geom 接口访问单个顶点数据，这在 Panda3D 手册中有详细描述。
*   您可以使用`set_color`更改对象的基本颜色（替换任何顶点颜色），或者您可以使用`set_color_scale`着色对象，即。应用与现有颜色相乘的颜色。如果您使用灯光并希望为漫反射、镜面反射和环境组件使用不同的颜色，您也可以应用材质对象。

# xmpp - 管理 ejabberd、mod_roster_odbc 或其他选项的名册？mod_roster_odbc 无处可寻？

> ID：12981613
> 
> 赞同：0
> 
> 时间：2012-10-19T19:59:08.150
> 
> 标签：xmpp, ejabberd

尝试使用 rest 模块从 webapp 管理 ejabberd 的花名册。

它指出为 ejabberd 管理名册的所有地方，mod_roster_odbc 都是要走的路。但是我在网上的任何地方都找不到这个模块！

这 mod_roster_odbc 还是要走的路吗？
在哪里下载？它不在 ejabberd 模块 repo 中！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T12:25:52.577

使用 mod_roster_odbc，您可以使用外部数据库（如 mysql mssql）存储和管理您的花名册...
ejabberd 默认使用 mnesia 数据库，因此 mod_roster 将您的花名册存储在 mnesia 中，因此如果您想使用 mod_roster_odbc，您可以搜索“将 ejabberd 与本机 mysql 一起使用”。

# d - 我应该确保我的代码同时使用 DMD 和 GDC 编译吗？

> ID：12981614
> 
> 赞同：3
> 
> 时间：2012-10-19T19:59:12.320
> 
> 标签：d, dmd, gdc

我猜想部分等价的问题：使用 DMD 编译的代码是否应该在所有情况下使用 GDC 自动编译？

我问是因为我在从 ubuntu 10.4（看似循环依赖，叹气）存储库安装现代版本的 GDC 时遇到问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T20:20:51.883

> 我应该确保我的代码同时使用 DMD 和 GDC 编译吗？

取决于您是否计划在这两个编译器上编译代码。如果您只打算使用 DMD 进行编译，则无需确保您的代码在 GDC 上编译。也就是说，编写可跨编译器移植的代码通常是一个好主意，以防万一有一天您确实需要使用 GDC。

> 使用 DMD 编译的代码是否应该在所有情况下使用 GDC 自动编译？

大多数情况下，但编译器之间存在并且总是会有小的差异。

GDC 和 DMD（和 LDC）都共享相同的编译器前端，因此在大多数情况下，它们的功能是等效的。当您开始接触较低级别的东西时，通常会出现差异，例如内联汇编程序、SIMD 内在函数。

# android - 创建内部多人游戏名称提示

> ID：12981616
> 
> 赞同：0
> 
> 时间：2012-10-19T19:59:21.207
> 
> 标签：android, flash, actionscript

所以我现在很迷茫..谷歌在这方面没有多大帮助..

我正在创建一个 Android 应用程序/游戏..

我正在使用 Flash CS6 和 Actionscript 3.0

我正在尝试做的是创建一个提示，询问将有多少玩家玩，然后让他们在选择玩家数量后输入他们的名字..

之后，每次游戏更改帧时，我都需要在屏幕顶部依次显示名称。

此外，更改帧的按钮会生成随机帧。（已经有生成随机帧码）

我正在尝试做的完美示例是 Google Play 应用商店中名为“喝酒游戏”的游戏

多人提示正是我所需要的..

请在这里帮助我，或者至少指出我正确的方向。你们已经在这里帮助了我很多。提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T00:27:30.683

您肯定会需要一些用户界面组件。您可以探索许多第三方选项，也可以从 Flash IDE 的组件菜单中获取它们。您可能想要[`NumericStepper`](http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa5.html)捕获玩家的数量，并根据用户在步进器中输入的值，使用一些[`TextInput`](http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa5.html)组件来捕获玩家的姓名。

您的玩家列表应该存储在一个[`Array`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html)您需要在每一帧上循环的地方，`TextField`为每个元素创建并添加到舞台 a 中。从您的问题来看，这并不是 100% 清楚，但听起来每个玩家姓名的显示之间可能需要延迟。如果是这种情况，您将需要探索 ActionScript 3.0[`Timer`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Timer.html)类。

# c# - System.ComponentModel.DataAnnotations.Schema 未找到

> ID：12981617
> 
> 赞同：11
> 
> 时间：2012-10-19T19:59:26.120
> 
> 标签：c#, .net, asp.net-mvc-4, data-annotations

我在 Visual Studio 2012 中遇到了涉及 System.ComponentModel.DataAnnotations.Schema 命名空间的问题。它告诉我无法解析 ForeignKeyAttribute，过去的解决方案是添加下面注释掉的 using 语句。VS2012 无法像 VS2010 那样解析 Schema 命名空间。最近的 .Net 版本有什么变化会导致这个问题吗？如果是这样，我该如何解决它们？

```
 `using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel.DataAnnotations;
// using System.ComponentModel.DataAnnotations.Schema;

namespace Data
{
    public class AffiliateUser
    {
        [Key, ForeignKey("User")]
        public int UserId { get; set; }

            [StringLength(50)]
            public string AffiliateUserKey { get; set; }

            public Guid ApiKey { get; set; }
            public string PasswordHash { get; set; }
            public bool IsDeleted { get; set; }
        }
}` 

            回答 #1

赞同：18

时间：2012-10-19T20:03:40.733

您确定您的目标是 .NET 4.5 Framework。[ForeignKeyAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.foreignkeyattribute.aspx)仅在 .NET 4.5 中可用

            回答 #2

赞同：5

时间：2013-08-15T19:19:35.960

我重新安装了实体框架，它可以工作了！

            回答 #3

赞同：4

时间：2012-10-19T20:04:49.387

您的代码和`System.ComponentModel.DataAnnotations.Schema`命名空间是正确的。

所以检查你的参考资料。这个应该在`Assembly System.ComponentModel.DataAnnotations.dll, v4.0.0.0`

您是否从 Fx 4 升级了项目？  

您可以使用 NuGet 修复版本。

            回答 #4

赞同：0

时间：2014-04-03T20:36:54.627

您可以在项目的参考部分中找到该程序集。单击框架选项卡并搜索程序集。这是来自 Microsoft .Net 框架的默认程序集。  

            回答 #5

赞同：-3

时间：2014-06-26T07:15:52.633

删除已经添加的引用**System.ComponentModel.DataAnnotations**并再次包含它。

如果还是不行，完全卸载实体框架，然后通过nuget manager重新安装。

```

# php - 帮助正确的 php 语法

> ID：12981626
> 
> 赞同：0
> 
> 时间：2012-10-19T19:58:03.467
> 
> 标签：php, function, wordpress

我正在研究一些 php 函数，但我对 php 语法感到困惑。这是功能。

它是否正确？在 function_exists 检查中使用 add_filter

```
如果（！function_exists（'disable_password_reset'））：
  功能 disable_password_reset() {
    返回假；
  }
  add_filter ('allow_password_reset', 'disable_password_reset');
万一;

```

或者这个是正确的，在function_exists检查之外使用add_filter

```
如果（！function_exists（'disable_password_reset'））：
  功能 disable_password_reset() {
    返回假；
  }
万一;
add_filter ('allow_password_reset', 'disable_password_reset');

```

如果这很重要，我正在研究 Wordpress。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:03:16.963

你想要做的是：

*   检查函数是否`disable_password_reset()`存在，如果不存在，则创建它。
*   挂钩`disable_password_reset()`到 Wordpress 过滤器。

如果你这样做：

```
if ( ! function_exists( 'disable_password_reset' ) ) :
  function disable_password_reset() {
    return false;
  }
  add_filter ( 'allow_password_reset', 'disable_password_reset' );
endif; 
```

then如果已经存在`add_filter ( 'allow_password_reset', 'disable_password_reset' );`则*不会*执行。`disable_password_reset()`如果您不希望这样，那么您应该`add_filter()`在块外调用`if`，如第二个示例中所示。

# c# - 在读取单元格内容之前以编程方式将工作表的格式设置为文本

> ID：12981632
> 
> 赞同：1
> 
> 时间：2012-10-19T20:00:41.917
> 
> 标签：c#, excel, openxml

我需要阅读 excel 表的内容，写入并允许编辑和重新导入。我遇到的问题是，当用户在工作表的单元格中输入数字时，这些数字在背面被视为 SharedString 表上的索引，这是我不需要的效果。我想做的是在继续阅读之前强制将工作表中的单元格格式化为文本。我相信这样，我确信我的数字将被视为字符串。请问我该怎么做？

我会很感激使用 OPENXML 库来解决这个问题的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:07:11.660

确定您从 Excel 中检索的内容是字符串的唯一方法是调用 Range.Text（它将根据当前格式返回显示的文本），只能使用单个单元格检索。

但是，如果您想制作文本格式，则只需调用：

```
Cells.NumberFormat = "@" 
```

作为我上面所说的更多细节......更改格式不会改变单元格的 .Value 。值通常是字符串、日期或双精度值，具体取决于它们的数字格式和内容。

* * *

**编辑**
由于您的最后评论，我为您做了一些额外的研究。但是，这没有经过我的测试。如果这对您没有帮助，我建议更新您的问题，以显示您为帮助获得社区更多响应所做的努力。

您应该能够利用[此答案](https://stackoverflow.com/a/7900397/1316573)中列出的步骤（如果对您有帮助，请务必投赞成票）。

唯一的变化，您应该能够跳过创建[NumberingFormat](http://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.numberingformat.aspx)。当您看到代码时： `cellFormat.NumberFormatId = nf2decimal.NumberFormatId;`而不是 nf2decimal... 只需使用 49。所以... `cellFormat.NumberFormatId = 49;`49 应该对应于 @ 的预定义数字格式，[根据此来源](http://social.msdn.microsoft.com/Forums/en-US/oxmlsdk/thread/e27aaf16-b900-4654-8210-83c5774a179c/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:04:56.177

像这样在 VBA 中：

```
Cells.Select
Selection.NumberFormat = "@" 
```

# c# - 使用 GUID 进行单元测试

> ID：12981633
> 
> 赞同：4
> 
> 时间：2012-10-19T20:00:42.647
> 
> 标签：c#, .net, unit-testing, guid

是否可以使用手动定义的值创建 GUIDS？

我需要提前知道 GUID 的值来做一些单元测试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T20:02:33.717

```
var guid = new Guid("62FA647C-AD54-4BCC-A860-E5A2664B019D"); 
```

假设您使用的是 .Net

如果您查看[MSDN 文档](http://msdn.microsoft.com/en-us/library/96ff78dc.aspx)，您将看到可能的 GUID 的所有不同类型的字符串表示形式的完整列表。

# html - 图像在悬停时看起来褪色

> ID：12981640
> 
> 赞同：2
> 
> 时间：2012-10-19T20:01:32.210
> 
> 标签：html, css

我有两张图片，当您将鼠标悬停时，另一张图片应该显示出来，并且显示得更亮。

出于某种原因，当您将鼠标悬停在图像上时，图像（在 .top-1-1 中）看起来更加褪色。

如何解决这个问题？

HTML

```
 <div class="top-1-1"><a href="experiences.aspx">
       <img src="images/myexperience.png" width="111" height="23" alt="My Experience" /></a>
  </div> 
```

CSS

```
.top-1-1 {
    float: left;
    width: 111px;
    height: 23px;
    margin: 10px 0px 0px 10px;
    padding: 0;
    background :url("../images/myexperience-on.png") no-repeat;

}

.top-1-1 a, .nav a:link, .nav a:visited {
  display:block;
  width: 111px;
  height: 23px; 
}

.top-1-1 a:hover img {
  visibility:hidden;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:19:50.867

I had a similar problem once in IE with a png image. Is it with all browsers? If so, it might be as Ennui said with transparency in the image. Maybe turn it into a jpeg if transparency isn't a requirement. Also, is javascript a possibility? Then you can get rid of some of that CSS.

```
<div class="top-1-1"><a href="experiences.aspx">

<img onmouseover="this.src='images/myexperience-on.png'" onmouseout="this.src='images/myexperience.png'" src="images/myexperience.png" width="111" height="23" alt="My Experience" /></a>

</div> 
```

also, with the above, Where is the beginning of the 'a' tag? I only see the end.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:06:56.703

我认为这是因为您在 CSS 中有一个`img`with属性。`background`尝试使用一些 Javascript 而不是 CSS。

你可以看看这个因为它可以为你提供比我的答案更多的答案[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:13:57.657

最可能的原因是悬停状态图像 (myexperience-on.png) 具有一定的透明度。尝试向 css 添加背景颜色：

```
background: #FFF url("../images/myexperience-on.png") no-repeat; 
```

或者

```
background: #000 url("../images/myexperience-on.png") no-repeat; 
```

或者您可以编辑图像并将其转换为 jpg（无透明度）或在其后面添加具有纯色背景颜色的图层以确保。

如果不是这样，那么我不确定问题是什么，它可能与您网站上影响相关元素的某些 javascript 或其他 CSS 有关。你有网站的链接吗？

不过，这是一种非常奇怪的翻转方式 - 为什么不将 A 标签设为块级元素并将其背景设置为默认图像并将悬停设置为 :hover psuedoclass？

# c# - 用 JavaScript 编写的 Cookie 未在代码隐藏中读取

> ID：12981642
> 
> 赞同：6
> 
> 时间：2012-10-19T20:01:38.427
> 
> 标签：c#, javascript, jquery, asp.net, cookies

`Response.Cookies["alertsCookie"]`给了我一块空白饼干。

我制作了两个 cookie，因为我不知道如何在路径中读取 cookie，所以我决定将它们写入两个位置（页面路径和 /）

代码隐藏：

```
HttpCookie seenAlertsCookie = Response.Cookies["alertsCookie"]; 
```

JavaScript (jQuery):

```
var cookie = $.cookie("alertsCookie");
alert(cookie);
if (cookie == null) {
    $.cookie('alertsCookie', alertGuid, { expires: 7300, path: '/' });
    $.cookie('alertsCookie', alertGuid, 7300);

}
else {
    var cookieVal = cookie + '|';
    cookieVal = cookieVal + alertGuid;
    $.cookie('alertsCookie', cookieVal, { expires: 7300, path: '/' });
    $.cookie('alertsCookie', cookieVal, 7300);
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-19T20:04:17.077

查看`Request`而不是`Response`.

```
HttpCookie seenAlertsCookie = Request.Cookies["alertsCookie"]; 
```

`Response.Cookies`用于在浏览器上设置 cookie，`Request.Cookies`用于读取来自浏览器的 cookie。

# image - Grails：从应用程序外部提供静态内容

> ID：12981643
> 
> 赞同：3
> 
> 时间：2012-10-19T20:01:39.230
> 
> 标签：image, grails, upload, static

我正在开发一个 CMS，我希望用户能够上传他们自己的图像、CSS 文件等。为了资源的安全，我不想将上传的文件存储在应用程序结构/部署的 WAR 中。

从非 grails 位置的控制器提供 grails 内容的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T16:13:36.703

After much research and questioning, I decided to package the static resources (such as images) in the database. The advantages of this are:

1.  You don't need to package your images within your application (where a redeploy could cause you to lose them all)
2.  You don't need to store your images in another location on the server, away from your application.
3.  You don't need to work with a 3rd party service such as Amazon S3.
4.  Writing a simple controller to serve files from the database is relatively simple.

The disadvantages are:

1.  You cannot access/manipulate the files on the filesystem.
2.  The database grows and can become very slow.
3.  You need to make a database call every time someone requests an image.

I decided to go with the solution, even though there are these disadvantages. This is how I dealt with them:

1.  This isn't a problem as it's a 100% online system.
2.  My images are small and there aren't many of them, so this isn't a problem.
3.  Made use of a efficient and easy caching mechanisms. See below:

I'm using Smart Browser Caching by making use of etags ([documentation](http://en.wikipedia.org/wiki/HTTP_ETag)) and using EHCache ([documentation](http://ehcache.org)) to cache the images server side. As soon as a new image is uploaded, the e-tag is changed, and the cache is cleared, forcing the browser to download a fresh copy.

So far, the loss of performance from the MySQL database has been un-noticable, and performance is lightning fast.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T07:59:45.757

通过适当的工具提供静态内容是正确的方法，所有的 Web 服务器都提供了实现这一点的可能性。如果您想在 Grails 应用程序中实现对这些内容的管理，请在 Config.groovy 中配置静态内容的目的地，仅此而已。

不要通过控制器实现从文件系统加载内容，你是在重新发明轮子；-) 而且 Web 服务器的性能要高得多；-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T17:34:44.380

我将添加一个指向远程文件系统文件夹的上下文别名，正如 cdavis226 在他的帖子中所解释的那样：

[http://web.archive.org/web/20190906142211/http://grails.1312388.n4.nabble.com/How-to-configure-context-xml-aliases-for-Tomcat-7-td4632149.html](http://web.archive.org/web/20190906142211/http://grails.1312388.n4.nabble.com/How-to-configure-context-xml-aliases-for-Tomcat-7-td4632149.html)

如果您使用的是 Grails 默认 Tomcat 服务器，则此解决方案有效。

# android - 对服务器的唯一调用是 UnknownHostException

> ID：12981657
> 
> 赞同：-1
> 
> 时间：2012-10-19T20:02:50.513
> 
> 标签：android, web-services, android-emulator

```
try {
    InetAddress i = InetAddress.getByName("http://www.google.com");
    Log.e("InetAddress", "InetAddress");
} catch (UnknownHostException e1) {
    e1.printStackTrace();
} 
```

它给出了一个`unknownHostException`. 这是应用程序对服务器所做的唯一事情。为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:05:11.920

您是否为设备设置了使用互联网的权限？

[我需要什么权限才能从 android 应用程序访问 Internet？](https://stackoverflow.com/questions/2378607/what-permission-do-i-need-to-access-internet-from-an-android-application)

# ssas - SSAS 2012 使用维度值过滤其他维度表

> ID：12981667
> 
> 赞同：2
> 
> 时间：2012-10-19T20:03:38.190
> 
> 标签：ssas, dimension

我有一个客户表和其他几个包含客户 ID 的维度表。

我想要的是由顶级客户选择过滤的维度表。

所以如果我有：

**客户**
ID | 姓名

**维度**
A ID | 客户 ID | 值 1
ID | 客户 ID | 价值2

**维度**
B ID | 客户 ID | 值 3
ID | 客户 ID | 价值4

**事实**
ID | 维度BId | FactValue1 ...
ID | 维度BId | 事实价值2 ...

..是否可以将 CustomerId 过滤并通过维度值向下渗透到事实表？

或者，我是否总是需要在维度使用中将客户与事实相关联？我可以看到如何通过 DimensionA 将 Customer 与 Fact 关联起来，但我只能将它与一个中间表关联，而不是两个或更多。

或者，我是否也需要在 Fact 表中实际包含 CustomerId？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T10:40:31.443

这一切都取决于您用于 DataWarehouse 的模式。

我认为**星型模式**是您拥有的最佳选择。

如果你使用它，你需要在事实表中有一个 customer_id 并通过维度使用来链接它们。DimensionA 和 DimensionB 也是如此（即 Fact 表需要有对应的 id 对应于维度 A 和维度 B）。

如果您以这种方法执行此操作，则无需在维度 A 或维度 B 上都有客户 ID。链接将通过 Fact 表实现。

否则考虑一下：你真的需要二维吗？由于这两个维度几乎相同，如果您在数据源表中添加一个名为 Type 的新字段，其中类型将是 A 和 B，并将类型添加到您的层次结构中，会不会更好？这将解决很多问题并使您的架构更加一致！！！

这是来自 Ralph Kimball [Kimball's_Site_Link](http://www.kimballgroup.com/2000/04/10/design-tip-6-showing-the-correlation-between-dimensions/)网站的链接，它以比我更好的方式解释了什么是什么。您会发现最后一段内容非常丰富！

# java - 在 OS/X 上用 Java 打开文件

> ID：12981669
> 
> 赞同：1
> 
> 时间：2012-10-19T20:03:41.510
> 
> 标签：java, eclipse, file-io

下面的代码片段会导致此错误：

> ```
> Exception in thread "main" java.lang.Error: Unresolved compilation problem: 
> Unhandled exception type FileNotFoundException 
> ```

```
String path = "/Users/jfaig/Documents/workspace/my_array/";
BufferedReader in = new BufferedReader(new FileReader(path + "Matrix.txt")); 
```

该路径是有效的，因为我可以看到使用以下代码列出的文件：

```
File dir = new File(path);
String[] chld = dir.list();
if(chld == null){
    System.out.println("Specified directory does not exist or is not a directory.");
    System.exit(0);
} else {
    for(int i = 0; i < chld.length; i++){
        String fileName = chld[i];
        System.out.println(fileName);
    }
} 
```

我查看了许多关于 Java 中 OS/X 路径的文章，但没有一篇能解决我的问题。我将在 Windows PC 上尝试一下，看看问题是否特定于 OS/X 和/或我安装的 Eclipse。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T20:06:42.170

FileNotFoundException 是检查异常，需要处理。它与文件或路径无关。

[http://www.hostitwise.com/java/java_io.html](http://www.hostitwise.com/java/java_io.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T20:12:16.020

**它不是抱怨您的文件**，而是要求您在找不到文件时进行处理。

如果您不希望对此场景进行任何处理，请使用`throws FileNotFoundException`例如 for`main`方法更新您的方法签名，您可以编写如下：

```
 public static void main(String[] args) throws FileNotFoundExcetion { 
```

如果要处理异常，或者将上面的代码包装在一个`try{}catch(FileNotFoundException fnfe){}`块中，如下所示：

```
try{
   File dir = new File(path);
   String[] chld = dir.list();
   if(chld == null){
   System.out.println("Specified directory does not exist or is not a directory.");
    System.exit(0);
   } else {
    for(int i = 0; i < chld.length; i++){
      String fileName = chld[i];
      System.out.println(fileName);
    }
   }   
  }catch(FileNotFoundException fnfe){  
    //log error
    /System.out.println("File not found");
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:11:02.040

`java.lang.Error: Unresolved compilation problem:`表示*真正的*错误在 的输出期间列出`javac`，但它在这里为您重复。`Unhandled exception type FileNotFoundException`— Java 中的异常必须被显式捕获或重新抛出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T20:18:50.543

让 Java 用路径做文件分隔符，并使用带两个参数的 File 构造函数。

```
 File path = new File("/Users/jfaig/Documents/workspace/my_array");
 File file = new File(path, "Matrix.txt");
 System.out.println("file exists=" + file.exists()); // debug
 BufferedReader in = new BufferedReader(new FileReader(file)); 
```

如前所述，您需要捕获或让方法抛出 IOException。

# iphone - 如何禁用 Tapklibrary 中的单元格？

> ID：12981672
> 
> 赞同：1
> 
> 时间：2012-10-19T20:03:55.770
> 
> 标签：iphone, xcode, tapku

我想知道是否有办法禁用日历中的天数，而不是选择。我使用 tapkulibrary 显示日历，还添加了一些标记。现在我正在尝试禁用那些未标记的单元格，因此无法选择它们。

那可能吗？

# java - 复制 LinearLayout 视图

> ID：12981674
> 
> 赞同：1
> 
> 时间：2012-10-19T20:04:09.663
> 
> 标签：java, android, layout, mobile

我正在尝试复制然后编辑在 XML 文件中定义的布局视图。

```
//Create layout  
LinearLayout layout = new LinearLayout(this);

//Add views
layout = (LinearLayout)findViewById(R.id.layout1);
//layout.addView(textView);

setContentView(layout); 
```

这似乎应该可以工作，但是每次我运行它时，应用程序都会在我调用 line 时崩溃 `setContentView(layout);`。我已经仔细检查了身份证，他们很好，他们都是`LinearLayouts`。知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:12:21.803

`findViewById`很简单，您之前无法调用，`setContentView`因为没有设置可以在其中查找视图的布局！可能会发生的事情是`findViewById`return `null`，然后您尝试将内容设置为`layout`（为空），从而出现错误。

`setContentView`首先使用您的布局资源 ID 或实际视图调用，然后`LinearLayout`使用`findViewById`.

# php - 如何以任何顺序使用 PHP 函数或方法参数？

> ID：12981679
> 
> 赞同：6
> 
> 时间：2012-10-19T20:04:43.363
> 
> 标签：php, symfony, method-parameters

假设我用这样的方法定义类：

```
class Test {
    public function doStuff($a, $b, $c) {
    // -- Do stuff --
    }
} 
```

是否可以使用此方法，但参数顺序不同，如下所示：

```
$test = new Test();
$test->doStuff($b, $c, $a); 
```

它们将具有相同的名称，但顺序不同。

我看到 Symfony2 可以使用它的调度程序来做到这一点，你可以按照你想要的任何顺序使用参数。链接：[Symfony2 控制器可以做到](http://symfony.com/doc/2.0/book/controller.html#route-parameters-as-controller-arguments)

问题是，如何使这项工作？Symfony2 如何调用适当的动作控制器，然后它可以按您喜欢的任何顺序接受参数？

编辑：我不能使用数组，而且我知道 php 不使用命名参数。但不知何故 Symfony2 设法做到了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T20:16:35.157

我认为您误解了 Symfony 在说什么。您不能以任何顺序将参数传递给控制器​​操作，它必须按特定顺序。然而，他们所做的是动态的，正在确定您的路由参数在函数定义中的顺序。

例如我们定义一个路由：

```
pattern:      /hello/{first_name}/{last_name}
defaults:     { _controller: AcmeHelloBundle:Hello:index, color: green } 
```

在路由中，参数被命名为`first_name`、`last_name`和`color`。

他们的意思是，您对操作中的参数使用什么顺序并不重要。

以下每一项都是等效的：

```
public function indexAction($first_name, $last_name, $color) {...}
public function indexAction($color, $last_name, $first_name) {...}
public function indexAction($last_name, $color, $first_name) {...} 
```

由于您的参数与路由中的参数命名相同，Symfony会根据您的定义确定*参数的正确顺序。*

如果您要手动调用以下操作：

```
public function indexAction($first_name, $last_name, $color) 
```

那么参数仍然*必须*`$first_name, $last_name, $color`按 as而不是以任何其他顺序传入。使用不同的顺序只会将错误的值与参数相关联。Symfony 只是不关心您定义函数的顺序，因为它决定了顺序，因为您的路由参数必须与您的方法参数命名相同。

希望这能消除混乱。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T21:55:13.730

Sable Foste 的想法启发了我。

您可以使用另一个参数来指定顺序，然后使用[变量变量](http://php.net/manual/en/language.variables.variable.php)：

```
function test($order, $_a, $_b, $_c){
  $order = explode(';', $order);
  ${$order[0]} = $_a;
  ${$order[1]} = $_b;
  ${$order[2]} = $_c;

  echo "a = $a; b = $b; c = $c<br>";
}

test('a;b;c', 'a', 'b', 'c');
test('b;a;c', 'b', 'a', 'c'); 
```

但是说真的，为什么不能使用数组呢？这是最好的方法。

* * *

**更新**：我写了这个。我一定是真的很无聊。

现在我觉得很脏。

```
class FuncCaller{

    var $func;
    var $order_wanted;
    var $num_args_wanted;

    function FuncCaller( $func, $order ){
        $this->func = $func;
        if( is_set($order) ){
            // First version: receives string declaring parameters
            // We flip the order_wanted array so it maps name => index
            $this->order_wanted = array_flip( explode(';', $order) );  
            $this->num_args_wanted = count($this->order_wanted);
        } else {
            // Second version: we can do better, using reflection
            $func_reflection = new ReflectionFunction($this->func);
            $params = $func_reflection->getParameters();

            $this->num_args_wanted = func_reflection->getNumberOfParameters();
            $this->order_wanted = [];

            foreach( $params as $idx => $param_reflection ){
                $this->order_wanted[ $param_reflection->getName() ] = $idx;
            }
        }
    }

    function call(){
        if( func_num_args() <= 1 ){
            // Call without arguments
            return $this->func();
        }
        else if( func_num_args() == $this->num_args_wanted ){
            // order argument not present. Assume order is same as func signature
            $args = func_get_args();
            return call_user_func_array( $this->func, $args );
        }
        else {
            // @TODO: verify correct arguments were given
            $args_given = func_get_args();
            $order_given = explode( ';', array_shift($args_given) );
            $order_given = array_flip( $order_given );  // Map name to index
            $args_for_call = array();
            foreach( $this->order_wanted as $param_name => $idx ){
                $idx_given = $order_given[$param_name];
                $val = $args_given[ $idx_given ];
                $args_for_call[$idx] = $val;
            }
            return call_user_func_array( $this->func, $args_for_call );
        }
    }

    // This should allow calling the FuncCaller object as a function,        
    // but it wasn't working for me for some reason
    function __invoke(){
        $args = func_get_args();
        return call_user_func( $this->call, $args );
    }
}

// Let's create a function for testing:
function test( $first, $second, $third ){
    $first  = var_export($first , TRUE);
    $second = var_export($second, TRUE);
    $third  = var_export($third , TRUE);
    echo "Called test( $first, $second, $third );<br>";
}

// Now we test the first version: order of arguments is specified
$caller = new FuncCaller( test, '1st;2nd;3rd' );
$caller->call(1, 2, 3);
$caller->call('3rd;1st;2nd', 'c', 'a', 'b');
$caller->call('2nd;3rd;1st', 'Two', 'Three', 'One');
$caller->call('3rd;2nd;1st', 'Go!', 'Get Set...', 'Get Ready...');

echo "<br>";

// Now we test the second version: order of arguments is acquired by reflection
// Note we you won't be able to rename arguments this way, as we did above
$reflection_caller = new FuncCaller( test ); 
$reflection_caller->call(1, 2, 3);
$reflection_caller->call('third;first;second', 'c', 'a', 'b');
$reflection_caller->call('second;third;first', 'Two', 'Three', 'One');
$reflection_caller->call('third;second;first', 'Go!', 'Get Set...', 'Get Ready...'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T20:09:32.960

不，但是您可以重载具有不同顺序的方法。或者你可以尝试通过反射或智能猜测参数来做到这一点。我怀疑你能想出一个适用于所有功能的优雅解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-20T12:56:04.773

我感觉他们使用反射来检查控制器动作函数的声明；然后他们以正确的顺序使用参数进行函数调用。

看看[http://www.php.net/manual/en/class.reflectionparameter.php](http://www.php.net/manual/en/class.reflectionparameter.php)。它有一个 getName 和 getPosition。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-19T20:23:54.693

为什么不添加第四个变量 $d，它定义了函数的传入顺序。

```
class Test {
    public function doStuff($d, $a, $b, $c) {
      $v=explode(',', $d);
      foreach($v as $key => $value){
        switch ($value){
           case 'a':
             $aa = $v[a];
             break;
           case 'b':
             $bb = $v[b];
             break;
           case 'a':
             $cc = $v[c];
             break;
          }
         echo "a is $aa, b is $bb, c is $cc"; //output  
      }

// -- Do stuff --
}
}
$d= "b,c,a"; // the order of the variables
$test = new Test();
$test->doStuff($d, $b, $c, $a); 
```

# c++ - 尝试将队列打印为数组

> ID：12981681
> 
> 赞同：1
> 
> 时间：2012-10-19T20:04:46.520
> 
> 标签：c++, data-structures, queue

我正在尝试将队列的内容打印为数组。我有代码工作和编译。问题是当我多次调用该函数时，打印函数没有调用并且数组没有再次打印。我需要多次打印数组并且它不打印。

打印功能的代码是：

```
template <class Type>
 void queueType<Type>::debugArray() 
 {
   for(queueFront; queueFront<count; queueFront++){
    cout << "[" << queueFront<< "] ," << list[queueFront] << " ";
   }

 } //end debugQueue 
```

main.cpp 代码为：

```
#include <iostream>
#include "queueAsArray.h"

using namespace std;

int main()
{
    queueType<int> q1;
    queueType<int> q2;
    queueType<int> q3;
    int x = 5;

    for(int i= 0; i<10; i++) {
        q1.addQueue(i);
    }

    cout << "q1 after being filled up with 10 items" << endl;

    q1.printQueueInfo();

    cout << "Queue contents from front to rear\n\n" << endl;

    q1.debugArray();
    q1.deleteQueue();
    q1.deleteQueue();
    q1.deleteQueue();

    for(int i= 0; i<=20; i){
        i+=5;
        q1.addQueue(i);
    }

    q1.debugArray();
    return 0;
} 
```

**函数调用不会再次打印是有原因的**吗？如果您需要整个类和实现文件，我可以提供。奇怪的是，如果我创建类的第二个实例`q2`，然后为 构建一个数组`q2`，该`debugQueue`函数会打印该队列。然后我调用重载赋值运算符并 do `q2=q1`，然后`debugQueue`再次调用它并打印队列的内容。所以我很困惑为什么它会打印第二个队列两次，而不是第一个队列。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:08:14.817

看起来你的问题是你正在改变`queueType`实例作为打印的一部分。

```
template <class Type>
void queueType<Type>::debugArray() 
{
  for(queueFront; queueFront<count; queueFront++){
    cout<<"[" << queueFront<<"] ,"<< list[queueFront]<<" ";}
} 
```

在这里，您将获取成员`queueFront`并将其向前变异，直到您到达队列的末尾。这是改变字段`queueFront`而不是指向同一位置的本地。尝试使用本地，它将解决您的问题

```
for(auto current = queueFront; current < count; current++){
  cout<<"[" << current<<"] ,"<< list[current]<<" ";}
} 
```

注意：我使用`auto`了 type 因为我不知道`queueFront`. 我认为是`list<int>::iterator`但不确定。您可以`auto`用正确的类型替换或保持原样，让编译器推断类型`current`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:12:04.130

我认为这只是`queueFront`当你打电话时你正在永久改变`debugArray()`。您可能应该只创建一个临时的... 不管它是什么，并确保`queueFront`是`const`，因为队列的前面不应该改变（如果这就是它所指的）。

# sql - 如果数据流中的某些文件不存在，如何成功运行数据流任务

> ID：12981683
> 
> 赞同：1
> 
> 时间：2012-10-19T20:04:54.393
> 
> 标签：sql, sql-server, excel, ssis

我有一个导入 excel 文件的数据流任务。我不能使用 for each 循环来遍历 excel 文件，因为每个 excel 文件的元数据完全不同。

因此，在数据流任务中，我有 10 个单独的源文件，并使用联合组件将它们组合起来，然后将其导入 SQL。

我现在面临的问题是有时我正在导入的某些 excel 文件可能不存在，所以当我的包运行时它会因为文件不存在而失败。那么我有什么方法可以创建一个检查，允许包运行跳过不存在的源文件并运行其余的源文件？

我正在使用 SSIS 2005。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T20:08:00.927

建议：如果文件不存在，则先创建。

在某处有每个源文件的空版本，并在您的控制流中（在数据流之前）检查文件是否存在，如果不存在，请将空白文件复制到真实文件的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:08:12.497

本文解释了如何`check if file exists`在 SSIS 中执行一种机制：

[http://www.bidn.com/blogs/DevinKnight/ssis/76/does-file-exist-check-in-ssis](http://www.bidn.com/blogs/DevinKnight/ssis/76/does-file-exist-check-in-ssis)

# php - Kohana 3.2 将查询变量传递给索引页面

> ID：12981690
> 
> 赞同：0
> 
> 时间：2012-10-19T20:05:18.800
> 
> 标签：php, http, redirect, kohana

我正在尝试做这样的事情：

```
$this->request->redirect("/?message=".HTML::entities($message)); 
```

然而，这导致我的索引控制器死在我身上（即 500 内部服务器错误，没有堆栈跟踪）。这是不可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T00:18:16.630

没有堆栈跟踪，而 Kohana 中的 500 错误表示一些低级错误（PHP 或 Web 服务器错误）。它可能是对象属性或方法可见性问题或其他东西。

否则 Kohana 会为您生成异常解释（何时在部分`errors => true`中设置）。`bootstrap.php``Kohana::init()`

检查您的服务器错误日志文件中的最后一个错误。你会在那里找到解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T12:15:41.743

```
public function action_index()
{
    $to = arr::get($_GET,'to' , 'world');
    $this->response->body('hello, '.urldecode($to).'!');
}

public function action_jump() {
    $to = urlencode('Tony Stark');
    $this->request->redirect('/?to=' . $to);
} 
```

# android - 无法 getWritableDatabase() - 有时

> ID：12981691
> 
> 赞同：2
> 
> 时间：2012-10-19T20:05:20.703
> 
> 标签：android, database, sqlite

我经常从用户那里收到有关此错误的报告。

**无法获取可写数据库。**

```
try {
        //dbOpenHelper is a standard SQLiteOpenHelper
        dbOpenHelper.getWritableDatabase();             
} catch (Exception e) {
        //unable to connect to database.
        return;
} 
```

这只是偶尔发生。会是什么呢？任何修复或解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T20:11:17.743

尝试 getReadableDatabase() 而不是 getWritableDatabase()

```
try {
        //dbOpenHelper is a standard SQLiteOpenHelper
        dbOpenHelper.getReadableDatabase();           
} catch (Exception e) {
        //unable to connect to database.
        return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:17:05.753

没什么可做的，需要查看您的 LogCat 以进一步提供帮助。你要关闭你的`dbOpenHelper`吗？

这是一个简单的例子：

```
public DatabaseControl open() throws SQLiteException {
    dbHelper = new DatabaseHelper(context);
    database = dbHelper.getWritableDatabase();
    return this;
}

public void close() {
    dbHelper.close();
} 
```

* * *

**编辑 1** - 同样，这是我最好的猜测，因为无法获得 LogCat。*（最后，在您的开发设备上运行此应用程序并尝试复制然后获取完整的 LogCat 输出可能符合您的最大利益）*

在我看来，拥有数据库的 Activity 正在被正确地访问和处理`close()`，但在某些情况下，用户可能没有通过该 Activity 运行，而是按下后退按钮，`onBackPressed()`可能应该有一个 DB`close()`调用？

换句话说，为了排除故障，我会`@Override`使用 Acitivity 生命周期方法：`onPause()`、`onResume()`、`onStart()`、`onStop()`，`onDestroy()`以及`onBackPressed()`简单地添加数据库`close()`并测试您的应用程序。如果你这样做，我会认为，任何返回的生命周期，例如`onStart()`或`onResume()`应该包含数据库`getWritableDatabase()`

根据文档（见下文），`Unable to getWritableDatabase`除非数据库未正确关闭，否则确实无法获取。还要确保如果您更改 SQlite 代码/结构中的任何内容，您需要更新 DB 版本号。

> **公共 SQLiteDatabase getWritableDatabase ()**
> 
> > 创建和/或打开将用于读取和写入的数据库。第一次调用时，将打开数据库并调用 onCreate(SQLiteDatabase)、onUpgrade(SQLiteDatabase, int, int) 和/或 onOpen(SQLiteDatabase)。
> > 
> > 一旦打开成功，数据库就会被缓存，所以每次需要写入数据库时​​都可以调用该方法。（确保在不再需要数据库时调用 close()。）权限错误或磁盘已满等错误可能会导致此方法失败，但如果问题得到解决，以后的尝试可能会成功。

* * *

**编辑 2**

我应该在第一次展示我是如何调用`open()`and`close()`方法的。对于那个很抱歉。除非您正在检索或发布到它，否则您不需要`DatabaseHelper`打开它，因此在处理后立即关闭它，直到您下次需要它。`Cursor`等也一样

下面是我如何查询数据库，打开所有内容，检索信息，处理信息，然后立即关闭所有内容。见下文：

```
DatabaseControl control = new DatabaseControl(this);

try {
    database = (new DatabaseHelper(this)).getWritableDatabase();
    DatabaseControl control = new DatabaseControl(DbTestDisplay.this);
    control.open();
    control.fetchAllItems();
    Cursor c = database.query(GlobalDBVars.TABLE_NAME, null, null, null, null, null, null, null);
    c.moveToFirst();

    int initialCount = c.getCount();
    Log.i("cursor", "Initial Count = " + initialCount);

    List<Integer> x = new ArrayList<Integer>();
    if (initialCount > 0) {
        for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {

            /* Process everything here */

        } /* End for loop */ 
    } /* End if statement */
    control.close();
    c.close();
    database.close();
} catch (SQLException sqe) {
    Log.e("fetchAllItems", "FAILED: " + sqe.getMessage() + " allData = ");
} 
```

# c# - 动态对象的并行性能

> ID：12981692
> 
> 赞同：1
> 
> 时间：2012-10-19T20:05:24.287
> 
> 标签：c#, task-parallel-library, dynamic-language-runtime

以下代码在大约 2.5 秒内运行：

```
static void Main(string[] args)
{
    var service = new Service();
    Parallel.For(0, 100, i => {
        dynamic user = new ExpandoObject();
        user.data = new ExpandoObject();
        user.data.id = i;
        user.data.name = "User Name";
        var parsed = service.Parse(user);
    });
}

public class Service
{
    public User Parse(dynamic dynamicUser)
    {
        if (dynamicUser.data != null)
        {
            return new User
            {
                Id = dynamicUser.data.id,
                Name = dynamicUser.data.name
            };
        }
        return null;
    }
}

public class User
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

但是，如果我将 Parallel.For() 循环更改为简单的 For 循环，它将在大约 200 毫秒内运行：

```
for (var i = 0; i < 100; i++) 
```

**所以我的问题是，为什么并行运行会慢得多？**

我的理论是，在解析每个线程执行一次的动态对象时会有一些开销。在简单循环中，DLR 第一次做它的事情，然后不需要为每个后续调用做。

但同时，DLR 的开销发生在每次调用中。

这是一个正确的假设，还是我离谱？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:23:09.607

我怀疑你被你的诊断误导了。特别是，如果运行一个循环*100*次需要 2.5 秒，那真的非常非常慢。这是在调试器下吗？

这是我的盒子上的代码编译结果`/o+`，然后在控制台中运行。请注意，我在每个测试中运行 1,000,000 次循环迭代。

```
Void ExecuteParallel(): 00:00:00.7311773
Void ExecuteSerial(): 00:00:02.0514120
Void ExecuteParallel(): 00:00:00.6897816
Void ExecuteSerial(): 00:00:02.0389325
Void ExecuteParallel(): 00:00:00.6754025
Void ExecuteSerial(): 00:00:02.0653801
Void ExecuteParallel(): 00:00:00.7136330
Void ExecuteSerial(): 00:00:02.0477593
Void ExecuteParallel(): 00:00:00.6742260
Void ExecuteSerial(): 00:00:02.0476146 
```

它的并行速度*不如*四核 i7 所期望的快，但我怀疑这是由于 Servy 提到的上下文切换等 - 也可能是 DLR 中的执行缓存争用。不过，它比串联运行要快。

自己尝试代码，看看你在你的盒子上得到了什么——但*不是*在调试器下。

代码：

```
using System;
using System.Diagnostics;
using System.Dynamic;
using System.Threading.Tasks;

class Test
{
    const int Iterations = 1000000;

    static void Main(string[] args)
    {
        for (int i = 0; i < 5; i++)
        {
            RunTest(ExecuteParallel);
            RunTest(ExecuteSerial);
        }

    }

    static void RunTest(Action action)
    {
        var sw = Stopwatch.StartNew();
        action();
        sw.Stop();
        Console.WriteLine("{0}: {1}", action.Method, sw.Elapsed);
    }

    static void ExecuteParallel()
    {
        var service = new Service();
        Parallel.For(0, Iterations, i => {
            dynamic user = new ExpandoObject();
            user.data = new ExpandoObject();
            user.data.id = i;
            user.data.name = "User Name";
            var parsed = service.Parse(user);
        });
    }

    static void ExecuteSerial()
    {
        var service = new Service();
        for (int i = 0; i < Iterations; i++)
        {
            dynamic user = new ExpandoObject();
            user.data = new ExpandoObject();
            user.data.id = i;
            user.data.name = "User Name";
            var parsed = service.Parse(user);
        }
    }
}

public class Service
{
    public User Parse(dynamic dynamicUser)
    {
        if (dynamicUser.data != null)
        {
            return new User
            {
                Id = dynamicUser.data.id,
                Name = dynamicUser.data.name
            };
        }
        return null;
    }
}

public class User
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:19:51.000

在这里，您正在执行的任务非常简单，花费的时间非常少，而且数量也足够少，以至于创建线程、分解任务、调度它们、处理上下文切换、内存屏障等等的开销其中，与您正在做的生产性工作量相比，这一点非常重要。如果你做的工作需要更长的时间，那么并行化的开销相比之下就会少得多。

# jquery - jquery 产品生成器

> ID：12981694
> 
> 赞同：-1
> 
> 时间：2012-10-19T20:05:35.770
> 
> 标签：jquery

我试图弄清楚如何使用 jQuery 构建这个界面。我最初是在 Flash 中完成的。[http://www.allprocustomtrailers.com/](http://www.allprocustomtrailers.com/)

它允许客户根据自己的需要定制预告片，然后进入另一个页面查看列表，而不是通过电子邮件将其发送给销售人员。在过去的两天里，我一直在网上搜索几个小时，以了解如何开始。如果已经有一个可以在 HTML5 中构建的基础，我不想重新发明轮子。我的 jQuery 技能充其量只是中级，所以这是我的大项目，可以将我推入深渊。我只是不想淹死。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:23:43.897

这也可以在不使用 JQuery 的情况下轻松完成。

要在 Javascript/HTML/CSS 中重新创建此应用程序，您可能会严重依赖[`"OnClick"`elements 的属性](http://reference.sitepoint.com/html/event-attributes/onclick)。这将允许您在单击给定元素（可能样式为按钮）时执行一段 Javascript 代码。JQuery 确实有一种[将动作绑定到单击事件](http://api.jquery.com/click/)的方法，但是对于 JQuery 相对较新的人（以及我个人更喜欢的方法）是`OnClick`属性。

`OnClick`这是我认为可以帮助您重新创建应用程序的功能的基本实现。

```
<!doctype html>
<html>
  <head>
    <script>
      function update_form(selection){
        document.getElementById("preview").src = selection + ".jpg";
        document.getElementById("formdata").value = selection;
      }
    </script>
  </head>
  <body>
    <span OnClick="update_form('option1');">Click here for Option 1.</span><br />
    <span OnClick="update_form('option2');">Click here for Option 2.</span><br />
    <img src="blank.jpg" id="preview" /><br />
    <form action="submit.php" action="post">
      <input type="text" name="selectionvalue" id="formdata"><br />
      <input type="submit" value="submit">
    </form>
  </body>
</html> 
```

我希望这有助于为您指明正确的方向。

# python - 如何在散点图中画线

> ID：12981696
> 
> 赞同：8
> 
> 时间：2012-10-19T20:05:53.277
> 
> 标签：python, numpy, matplotlib, plot, scipy

我不敢相信这会如此复杂，但我现在尝试并搜索了一段时间。

我只想用一些图形特征来分析我的散点图。对于初学者，我想简单地添加一行。

所以，我有几个 (4) 点，我想在上面添加一条线，就像在这个情节中一样（来源：[http](http://en.wikipedia.org/wiki/File:ROC_space-2.png) ://en.wikipedia.org/wiki/File:ROC_space-2.png ）

![在此处输入图像描述](../Images/4a0eb7dd292c2b42c033c34526739956.png)

现在，这行不通。坦率地说，matplotlib 的文档-示例-图库组合和内容是一个糟糕的信息来源。

我的代码基于图库中的一个简单散点图：

```
# definitions for the axes
left, width = 0.1, 0.85 #0.65
bottom, height = 0.1, 0.85 #0.65
bottom_h = left_h = left+width+0.02

rect_scatter = [left, bottom, width, height]

# start with a rectangular Figure
fig = plt.figure(1, figsize=(8,8))
axScatter = plt.axes(rect_scatter)

# the scatter plot:
p1 = axScatter.scatter(x[0], y[0], c='blue', s = 70)
p2 = axScatter.scatter(x[1], y[1], c='green', s = 70)
p3 = axScatter.scatter(x[2], y[2], c='red', s = 70)
p4 = axScatter.scatter(x[3], y[3], c='yellow', s = 70)
p5 = axScatter.plot([1,2,3], "r--")

plt.legend([p1, p2, p3, p4, p5], [names[0], names[1], names[2], names[3], "Random guess"], loc = 2)

# now determine nice limits by hand:
binwidth = 0.25
xymax = np.max( [np.max(np.fabs(x)), np.max(np.fabs(y))] )
lim = ( int(xymax/binwidth) + 1) * binwidth

axScatter.set_xlim( (-lim, lim) )
axScatter.set_ylim( (-lim, lim) )

xText = axScatter.set_xlabel('FPR / Specificity')
yText = axScatter.set_ylabel('TPR / Sensitivity')

bins = np.arange(-lim, lim + binwidth, binwidth)
plt.show() 
```

一切正常，除了 p5 是一条线。

现在这应该如何工作？这里有什么好的做法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-19T22:52:08.190

`plot`采用 y 值并使用 x 作为索引数组`0..N-1`或 x 和 y 值，如[文档](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot)中所述。所以你可以使用

```
p5 = axScatter.plot((0, 1), "r--") 
```

在您的代码中绘制线条。

但是，您要求的是“良好做法”。以下代码（希望）显示了一些“良好实践”和 matplotlib 的一些功能，以创建您在问题中提到的情节。

```
import numpy as np
import matplotlib.pyplot as plt 

# create some data
xy = np.random.rand(4, 2)
xy_line = (0, 1)

# set up figure and ax
fig, ax = plt.subplots(figsize=(8,8))

# create the scatter plots
ax.scatter(xy[:, 0], xy[:, 1], c='blue')
for point, name in zip(xy, 'ABCD'):
    ax.annotate(name, xy=point, xytext=(0, -10), textcoords='offset points',
                color='blue', ha='center', va='center')
ax.scatter([0], [1], c='black', s=60)
ax.annotate('Perfect Classification', xy=(0, 1), xytext=(0.1, 0.9),
            arrowprops=dict(arrowstyle='->'))

# create the line
ax.plot(xy_line, 'r--', label='Random guess')
ax.annotate('Better', xy=(0.3, 0.3), xytext=(0.2, 0.4),
            arrowprops=dict(arrowstyle='<-'), ha='center', va='center')
ax.annotate('Worse', xy=(0.3, 0.3), xytext=(0.4, 0.2),
            arrowprops=dict(arrowstyle='<-'), ha='center', va='center')
# add labels, legend and make it nicer
ax.set_xlabel('FPR or (1 - specificity)')
ax.set_ylabel('TPR or sensitivity')
ax.set_title('ROC Space')
ax.set_xlim(0, 1)
ax.set_ylim(0, 1)
ax.legend()
plt.tight_layout()
plt.savefig('scatter_line.png', dpi=80) 
```

![scatter_with_line.png](../Images/6a327499787dd0d349ab4ffab625d90b.png)

顺便说一句：我认为 matplotlibs 文档现在非常有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T21:17:20.593

p5 行应该是：

```
p5 = axScatter.plot([1,2,3],[1,2,3], "r--") 
```

参数 1 是 x 值的列表，参数 2 是 y 值的列表

如果你只想要一条直线，你只需要为线的末端提供值。

# android - Galaxy S/Samsung Vibrant 上的 OpenGL 1.1 问题

> ID：12981698
> 
> 赞同：1
> 
> 时间：2012-10-19T20:06:14.740
> 
> 标签：android, opengl-es, opengl-es-1.1

我正在尝试使用 OpenGL 1.1 一次在三星 Vibrant/Galaxy S 上显示两个 OpenGL 表面视图。该设备拒绝同时显示两者，但不会引发任何错误。在我测试过的所有其他设备上，这都有效。

这可能是Android 2.1的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T21:30:45.207

将设备升级到 Android 2.2 已修复问题。不知道为什么，也许更新也修复了一个错误？

# python - Python：如果任意元素在任意列表中，则返回布尔值

> ID：12981705
> 
> 赞同：3
> 
> 时间：2012-10-19T20:06:55.803
> 
> 标签：python, list, boolean, element, match

菜鸟想知道如何改进他的代码。

```
a, b, c = string.split(enteredDate, "/")

m31s = [1, 3, 5, 7, 8, 10, 12]
m30s = [4, 6, 9, 11]

for x in range(len(m31s)):
    x = int(m31s[x])
    if x != int(a) and b != 31:
         print "Invalid date."
for x in range(len(m30s)):
    et cetera... 
```

如果不清楚，我正在测试输入的日期以查看它是否有效。这只是该计划的一部分。**主要问题是**：测试元素是否与列表中的任何元素匹配的最佳方法是什么？

我的方法有效......但是，我怀疑有更好的方法来做到这一点。我在标题中说布尔值，因为我设想如下：

```
if secretCode(m31s, int(a)) == True: 
```

可能是白日梦。只是好奇。

感谢任何花时间提供帮助的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T20:08:46.363

您可以使用语法`if elem in list`。例如：

```
>>> if 1 in [1,2,3,4,5]:
...     print 'found 1'
... 
found 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T20:19:48.480

你应该使用 python[`datetime`](http://docs.python.org/library/datetime.html)库。

```
try:
    datetime.datetime.strptime(enteredDate, "%m/%d/%Y")
except:
    print 'Invalid date' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T20:18:54.407

我建议：

*   代替

    ```
     a, b, c = string.split(enteredDate, "/") 
    ```

    和

    ```
     a, b, c = enteredDate.split("/") 
    ```

    没关系，但第一个版本需要导入`string`模块，第二个不需要。

*   替换`int(m31s[x])`为`m31s[x]`（你知道那些`int`已经是了，那为什么还要额外`int( ... )`呢？
*   如果`secretCode( ... )`返回 true 或 false 你可以简单地写`if secretCode( ... ):`，不需要比较`== True`。
*   而不是调用`int(a)`，`int(b)`或者`int(c)`您可以简单地编写`a, b, c = map(int, enteredDate.split("\"))`并在以后忘记`int( ... )`它们，因为您知道它们是 int 。此外，如果这些*不是*int ，您将立即获得异常，而无需在代码中进行不必要的进展。

# java - GAE 应用程序开发：返回哈希图时出现 NullPointerException

> ID：12981712
> 
> 赞同：1
> 
> 时间：2012-10-19T20:07:20.490
> 
> 标签：java, google-app-engine, map

基本上，用户提交选定的年份，然后 servlet 返回相应的年度报告。然后用户可以修改相应的信息。然后servlet保存修改后的信息。

假设用户寻找的螺柱总是存在于 em 中。问题是：如果用户之前没有存储年报信息，并且用户提交了一年，即2009年，那么一切运行正常。用户修改信息，GPAInfoServlet 将存储修改的信息。

但是，在完成上述操作后，即用户之前存储了一份年报信息，用户（即我）在提交所选年份的过程中收到 ERROR **NullPointerException**

```
at tcndata.Stud.jdoGetannualReport(Stud.java)
at tcndata.Stud.getAnnualReport(Stud.java:33)
at servlet.YearSelectedServlet.doPost(YearSelectedServlet.java:35) 
```

选择年份：

```
public class YearSelectedServlet extends HttpServlet {
public void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {
    int yearselected = Integer.parseInt(req
            .getParameterValues("yearselected")[0]);
    long studid = Long.parseLong(req.getSession().getAttribute("studID")
            .toString());

    EntityManager em;
    em = EMF.get().createEntityManager();

    Stud stud = em.find(Stud.class, studid);

    if (stud != null) {
        Map<Integer, AnnualReport> annualreport;
        if (stud.getAnnualReport() == null)
            annualreport = new HashMap<Integer, AnnualReport>();
        else
            annualreport = stud.getAnnualReport();

        if (annualreport.containsKey(yearselected)) {
            AnnualReport thatyear = stud.getAnnualReport()
                    .get(yearselected);
            req.getSession().setAttribute("thatyear", thatyear);
            req.getSession().setAttribute("annualReport", thatyear);
        }
    } else {
        req.getSession().setAttribute("Error", "alumni not found");
        resp.sendRedirect("Error.jsp");
    }
    req.getSession().setAttribute("yearselected",
            req.getParameterValues("yearselected")[0]);
    req.getSession().setAttribute("SearchTag", "GPAInfo");
    resp.sendRedirect("Search.jsp");

} 
```

}

保存修改信息：

```
public class GPAInfoServlet extends HttpServlet {
public void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {

    AnnualReport thatyear = new AnnualReport();

    thatyear.setAttendSchool(AttendSchool.valueOf(req
            .getParameterValues("AttendSchool")[0]));
    .....

    int yearselected = Integer.parseInt(req.getSession()
            .getAttribute("yearselected").toString());
    long studid = Long.parseLong(req.getSession().getAttribute("studID")
            .toString());

    EntityManager em;
    em = EMF.get().createEntityManager();
    Stud stud = em.find(Stud.class, studid);

    if (stud != null) {
        Map<Integer, AnnualReport> annualreport;
        if (stud.getAnnualReport() == null)
            annualreport = new HashMap<Integer, AnnualReport>();
        else
            annualreport = stud.getAnnualReport();

        annualreport.put(yearselected, thatyear);

        try {
            stud.setAnnualReport(annualreport);
            em.merge(stud);
        } finally {
            em.close();
        }

    } else {
        req.getSession().setAttribute("Error", "alumni not found");
        resp.sendRedirect("Error.jsp");
    }

    req.getSession().setAttribute("SearchTag", "GPAInfo");
    resp.sendRedirect("/Search.jsp");

} 
```

}

螺柱类：

```
@Entity( name = "Stud")
public class Stud{
    @Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long studID;

private Map<Integer,AnnualReport>annualReport = new HashMap<Integer,AnnualReport>();

public Map<Integer, AnnualReport> getAnnualReport() {
    return annualReport;
}

public void setAnnualReport(Map<Integer, AnnualReport> annualReport) {
    this.annualReport = annualReport;
} 
```

**我不知道会发生什么。

我已经在年度报告中@Embeddable：

```
@Embeddable 
```

公共类年报{

```
@Basic
private AttendSchool attendSchool;
private String attendSchoolNote;

...... 
```

}

如果 (stud.getAnnualReport() == null) **如何在 ** 中获取**NullPointerException**

```
if (stud != null) {
        Map<Integer, AnnualReport> annualreport;
        if (stud.getAnnualReport() == null)
            annualreport = new HashMap<Integer, AnnualReport>();
        else
            annualreport = stud.getAnnualReport();

        ....
    } else {
        ....
    } 
```

**空指针异常**？

需要帮助……我快死了……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T04:00:08.920

您确定那条线`annualreport = stud.getAnnualReport();`是您获得 NPE 的地方吗？

因为下面几行代码，如果`stud.getAnnualReport()`是，肯定会产生 NPE `null`：

```
AnnualReport thatyear = stud.getAnnualReport()
                .get(yearselected); 
```

# c# - jQuery AutoComplete 文本未通过使用 MVC3 创建视图保存到数据库

> ID：12981715
> 
> 赞同：2
> 
> 时间：2012-10-19T20:07:40.397
> 
> 标签：c#, jquery, asp.net-mvc-3

这是我的第一篇文章，所以请各位小伙伴们放轻松。我正在尝试实现一个利用 jquery 自动完成的创建表单。创建表单允许用户通过提交按钮输入将保存到我的数据库中的数据。这是我的代码：

控制器

```
 // GET: /Inspection1/Create
    public ActionResult Create()
    {
        InspectionInfo model = new InspectionInfo
        {
            Submitted = DateTime.Now,
            Contact = new Contact()
        };

        ViewBag.CountyName = new SelectList(db.Counties, "CountyName", "CountyName");

        return View(model);
    }

    //
    // POST: /Inspection1/Create

    [HttpPost]
    public ActionResult Create(InspectionInfo inspectioninfo)
    {
            if (ModelState.IsValid)
        {
            db.InspectionInfos.Add(inspectioninfo);
            db.SaveChanges();
            return RedirectToAction("Index");
        }

        return View(inspectioninfo);
    }

    // this allows for autocompletion behavior
    public ActionResult QuickSearchContact(string term)
    {
        var contacts = db.Contacts
                        .Where(r => r.ContactName.Contains(term))
                        .Take(10)
                        .Select(r => new { label = r.ContactName });
        return Json(contacts, JsonRequestBehavior.AllowGet);

    } 
```

楷模

```
 public class InspectionInfo
  {
    [Key]
    public int InspectionId { get; set; }

    [DataType(DataType.Date)]
    public virtual DateTime Submitted { get; set; }
    [DataType(DataType.MultilineText)]
    [MaxLength(1000)]
    public string Comments { get; set; }

    [Required]
    public Contact Contact { get; set; }

 public class Contact
 {
    [Key]
    public string ContactName { get; set; } 
```

看法：

```
<div class="editor-label">
        @Html.LabelFor(model => model.Contact)
    </div>
    <div class="editor-field">
        <input type ="text" name ="q" data-autocomplete=  
       "@Url.Action("QuickSearchContact", "Inspection")"/> 
        @Html.ValidationMessageFor(model => model.Contact.ContactName)
    </div> 
```

JS

```
$(document).ready(function () {

  $(":input[data-autocomplete]").each(function () {

  $(this).autocomplete({ source: $(this).attr("data-autocomplete")});
  }); 
```

自动完成功能似乎工作正常。它将根据我的需要从数据库中提取列数据。但是，在用户保存表单后，在自动完成文本框中输入的任何数据都会在数据库中显示为 NULL。在这里的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:16:34.363

为了使模型绑定起作用，通常输入名称必须与模型的属性名称匹配。令人惊讶的是，您已将输入命名为“q”

```
<input type ="text" name ="q" data-autocomplete="..."/> 
```

只需根据您的型号重命名即可

```
<input type ="text" name="Contact.ContactName" data-autocomplete="..."/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:17:56.253

您没有上面的代码，但是，而不是使用

```
 <input type ="text" name ="q" data-autocomplete=          "@Url.Action("QuickSearchContact", "Inspection")"/> 
```

使用：@EditorFor(x = x.NameOfTextBox)

然后将输入按钮包裹在 using 标记中

```
@using (Html.BeginForm("Create", "NameOfController", FormMethod.Post){

 //all your model stuff goes here

} 
```

或使用和 actionlink 而不是：

```
@Html.ActionLink("Submit", "Create", "NameOfController", Model) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:19:44.500

提供的信息没有说明，但很可能自动完成部分没有写在视图的表单元素中：

```
 @using (Html.BeginForm()) 
    {
        <p>
            ...
        </p>
     } 
```

在 MVC 中，表单定义在括号 { .... } 中，如上。

# objective-c - 如何仅对 UIView 中某个子类的 NSObject 执行操作？

> ID：12981716
> 
> 赞同：0
> 
> 时间：2012-10-19T20:07:40.967
> 
> 标签：objective-c, uiview, subview

我有一个 UIView，其中包含 UILabels、UISliders、UITextboxes 等。我只想对滑块执行操作。这是怎么做到的？目前，我有

```
int count = 0;
for (UIView *subview in [myView subviews])
{
  if ([subview isKindOfClass:[UISlider class]]);
  {
    [subview removeFromSuperview];
    NSLog(@"Class for object removed is %@",[subview class]);
    count ++;
  }
  //else{do nothing - subview isn't a slider, so I don't care about it}
}
NSLog(@"count = %d",count); 
```

当我运行这段代码时，一切都会受到影响（滑块，以及标签、文本框和其他一切）。根据我从阅读其他帖子中收集到的信息，使用带有数组的 isKindOfClass 有点小故障，但我认为这只是在尝试做`isKindOfClass:[NSArray class]`. 还是我错了？`isKindOfClass`如果不允许在循环内进行这种嵌套`for`，如何仅对视图中的某些项目执行操作？

编辑：为此的一个实现添加了整个代码。计数已关闭，NSLog 告诉我一大堆 UILabel 正在被删除。运行后，我的视图完全清空了所有内容。

编辑 2：`;`在 if 语句的末尾添加，就像我在实际代码中一样。我在我的代码中删除了它，现在我得到了我预期的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T16:24:28.400

也许您应该尝试使用**isMemberOfClass**而不是 isKindOfClass。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:51:14.710

原来我有一个错字。在我的 if 语句的`;`末尾基本上使它就像我根本没有`if`在那里一样，这就是为什么一切都从我的视野中删除的原因。删除`;`使我的问题中的代码按预期工作。

# mef - 如何构建在运行时设置标签的 MEF？

> ID：12981718
> 
> 赞同：1
> 
> 时间：2012-10-19T20:07:44.807
> 
> 标签：mef

我有一个带有标签的 Windows 窗体。我想根据目录中的程序集在运行时设置标签值。我不确定哪个代码在哪里：

`UI Form has a label.`

`2 class libraries that implement an interface.`

`Should I have another class that does the MEF composition work and do I need to call that in the constructor of the UI Form.`

如果我需要在表单构造函数中调用它并且我有很多表单，这是否意味着我必须以非常形式调用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T16:16:58.260

我`MEF`第一次在我正在开发的 WPF 应用程序中使用你上面描述的是我如何管理我的`MEF`模块。

以下是我所做的总结：

*   `MEF`为合成创建一个单独的类。我命名为 mine `Modules`。这个类应该做所有的`MEF`作文。您可以在创建对象时进行组合，也可以为其创建方法。( `Modules.DoComposition()`)
*   `Modules`我在主 UI 窗口的构造函数中创建了此类的一个实例。合成将在这个时候完成。（如果您使用 MVVM 设计模式，请在 ViewModel 中创建。）
*   `Modules`我在需要访问它的任何其他表单的构造函数中传递对我的对象的引用。这样，所有表单都可以访问您的`Modules`对象，而无需再次进行组合。

# jersey - 如何在 Adob e CQ 中部署和访问 Jersey REST OSGi 包？

> ID：12981719
> 
> 赞同：4
> 
> 时间：2012-10-19T20:07:49.890
> 
> 标签：jersey, osgi, aem, sling

我有一个使用 Jersey 并提供 RESTful 资源的 OSGi 包（在 Felix 下运行）。这一切正常，我可以通过浏览器调用服务并返回 JSON 响应。

现在，我想做的是*将*同一个包部署到 Adob​​e CQ 中，并通过 CQ 访问资源（即 /mycq/services/my-service）。

有关如何将现有 OSGi 捆绑包部署到 CQ 以及更具体地“访问”捆绑包中的 Jersey REST 资源的任何指示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:22:34.803

[Maven Sling 插件](http://sling.apache.org/site/sling.html)允许您将OSGi 包部署到本地或远程运行的 CQ 实例。

来源：[部署 OSGi 包](http://www.cqblueprints.com/xwiki/bin/view/Blue+Prints/Building+and+Deploying+OSGi+Bundles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T07:38:34.943

Apache Stanbol 在 OSGi 环境中使用 Jersey，该环境与 CQ5 所基于的 Apache Sling 非常相似。看看泽西岛是如何在那里集成的可能会有所帮助。

[https://issues.apache.org/jira/browse/SLING-2192](https://issues.apache.org/jira/browse/SLING-2192)也有一些可能有帮助的实验代码。

请注意，Sling 希望接管整个 URI 空间，尤其是访问控制所需的空间，因此可能需要一些桥接代码。

# php - 如何从 PHP 中的数组中删除所有重复值？

> ID：12981722
> 
> 赞同：0
> 
> 时间：2012-10-19T20:07:56.803
> 
> 标签：php, arrays, duplicates

我只想检查重复的值 [id]，并删除此“字段”[id] 重复的所有键。

示例：如果我有数字 1,2,1。我希望结果是 2，而不是 1,2。重复的标准仅通过检查 [id] 而不是任何其他“字段”来确定。

**原始数组：**

```
Array
(
    [0] => Array
        (
            [name] => John
            [id] => 123
            [color] => red
        )

    [1] => Array
        (
            [name] => Paul
            [id] => 958
            [color] => red
        )

    [2] => Array
        (
            [name] => Jennifer
            [id] => 123
            [color] => yellow
        )
) 
```

**我想要的结果：**

```
Array
(
    [0] => Array
        (
            [name] => Paul
            [id] => 958
            [color] => red
        )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:20:54.050

我同意上述所有人的观点，您应该向我们提供有关您尝试过的更多信息，但我喜欢编写高尔夫代码，所以这是一个完全不可读的解决方案：

```
$new_array = array_filter($array, function($item) use (&$array){
    return count(array_filter($array, function($node) use (&$item){
        return $node['id'] == $item['id'];
    })) < 2;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:17:54.310

这应该很容易通过几个简单的循环来完成：

```
set_time_limit(0); // Disable time limit to allow enough time to process a large dataset

// $items contains your data

$id_counts = array();
foreach ($items as $item) {
    if (array_key_exists($item['id'], $id_counts)) {
        $id_counts[$item['id']]++;
    } else {
        $id_counts[$item['id']] = 1;
    }
}

for ($i = count($items); $i >= 0; $i--) {
    if ($id_counts[$items[$i]['id']] > 1) {
        array_splice($items, $i, 1);
    }
} 
```

结果：

```
Array
(
    [0] => Array
        (
            [name] => Paul
            [id] => 958
            [color] => red
        )
) 
```

虽然有更简洁的方法可以做到这一点，但这种方法的一个优点是您只需为 id 列表和重复 id 列表创建新数组，并且`array_splice`从原始数组中删除重复项，因此内存使用量保持在最低限度。

编辑：修复了一个错误，这意味着它有时会留下一个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:14:37.793

```
function PickUniques(array $items){
    // Quick way out
    if(empty($items)) return array();
    $counters = array();
    // Count occurences
    foreach($items as $item){
        $item['id'] = intval($item['id']);
        if(!isset($counters[$item['id']])){
            $counters[$item['id']] = 0;
        }
        $counters[$item['id']]++;
    }
    // Pop multiples occurence ones
    foreach($counters as $id => $occurences){
        if($occurences > 1){
            unset($counters[$id]);
        }
    }
    // Keep only those that occur once (in $counters)
    $valids = array();
    foreach($items as $item){
        if(!isset($items[$item['id']])) continue;
        $valids[$item['id']] = $item;
    }
    return $valids;
} 
```

试试这个:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T20:18:48.277

这是一个非常基本的答案方法，我相信有更好的答案，但是我可能会从我在纸上的方式开始。

我查看第一个索引，检查它的值。然后，如果值与我最初记录的值相同，我会检查所有其他索引，并记下它们的索引。一旦我浏览了列表，如果我有多个具有该特定值的索引，我将它们全部删除（从最高索引开始，以免在删除时影响其他索引）。

对所有其他索引执行此操作，直到到达列表末尾。

它很冗长，但会确保它删除所有具有重复项的值。并且只留下那些原本没有重复的。

# c++ - 包括不工作的警卫

> ID：12981725
> 
> 赞同：13
> 
> 时间：2012-10-19T20:08:12.883
> 
> 标签：c++, include, compiler-errors

我已经定义了一个 util.h 文件，其中包含我想在其他几个不同文件中使用的函数。这个头文件有一个包含保护，但是当我在两个不同的文件中使用它时，我得到一个`multiple definition of...`错误。我究竟做错了什么？

我读过[这个](https://stackoverflow.com/questions/8108072/c-include-guards-do-not-seem-to-be-working#answer-8108125)，但这与变量声明/定义有关。 [这个](https://stackoverflow.com/questions/1787822/why-arent-include-guards-or-pragma-once-working#answer-1787830)答案似乎更相关，但我不清楚如何解决这个问题。

```
// util.h
// include lots of standard headers
#include ...

#ifndef UTIL_H
#define UTIL_H

using namespace std;
// multiple definition of `randarr(int, int, int)`
int* randarr(int size, int min, int max) {
    int *ret = new int[size];
    for (int i=0; i<size; i++)
            ret[i] = (int) (((double) rand() / RAND_MAX) * max) + min;
    return ret;
}
// no error
template<typename T> void printarr(T* v, int begin, int end) {
    for (int i=begin; i<end; i++)
    cout << v[i] << " ";
    cout << endl;
}
// multiple definition of `is_prime(int)`
bool is_prime(int n) {
    if (n == 2 || n == 3 || n == 5) return true;
    if (n <= 1 || (n&1) == 0) return false;

    for (int i = 3; i*i <= n; i += 2)
            if (n % i == 0) return false;

    return true;
}
#endif 
```

* * *

```
// example.cpp
#include ...// lots of standard includes
#include "util.h"
void f() {
    randarr(...);
    printarr(...);
    is_prime(...);
    ...
} 
```

* * *

```
// Main.cpp
#include "util.h"
int main() {

} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-19T20:11:52.180

包含守卫不是错误的原因；您违反了[*单一定义规则*](https://en.wikipedia.org/wiki/One_Definition_Rule)。由于*util.h*包含在 2 个源文件中，预处理每个源文件后创建的翻译单元将包含每个函数的定义，从而导致多定义错误。

要摆脱错误，请标记功能`inline`

```
inline int* randarr(int size, int min, int max) {
  // ...
}

template<typename T> 
inline void printarr(T* v, int begin, int end) {
  // ...
}

inline bool is_prime(int n) {
  // ...
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-19T20:11:51.370

您收到的是*链接器*错误，而不是编译器错误。`randarr()`您已经在文件中实现了该函数，这意味着编译器会在每个和中`util.h`看到一个副本。当链接器将这些链接在一起时，它会抱怨，因为您不允许对同一函数有多个定义。`randarr()``example.cpp``Main.cpp`

你有两个选择：

*   在头文件`randarr()`中声明`inline`
*   将定义移动`randarr()`到`util.cpp`文件中

对`is_prime()`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T20:13:03.080

您在头文件中[定义了函数。](https://en.cppreference.com/w/cpp/language/definition)这意味着，这些函数的代码都包含在`example.cpp`和 中`Main.cpp`。这也意味着代码将被生成两次。这就是“多重定义”错误的原因。

当您定义函数`randarr()`并且`is_prime()`仅在单独`util.cpp`的 中定义一次时，错误将消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T20:11:48.547

您的标头应仅包含函数的原型。原型向其他文件描述您的功能，但不要实现它。唯一的例外是模板，因为每个模板特化都是在编译时构建的。

如果你在你的头文件中实现你的函数，在链接器时，你会发现多次函数内容，这就是你面临错误的原因。

将 和 的实现移至`randarr`另一个`is_prime`文件，并将您的 util.h 转换为：

```
#ifndef UTIL_H
#define UTIL_H

using namespace std;
int* randarr(int size, int min, int max);
template<typename T> void printarr(T* v, int begin, int end) {
    for (int i=begin; i<end; i++)
    cout << v[i] << " ";
    cout << endl;
}
bool is_prime(int n);
#endif 
```

# jquery-ui - 可调整大小的自动完成

> ID：12981742
> 
> 赞同：5
> 
> 时间：2012-10-19T20:09:39.937
> 
> 标签：jquery-ui

我一直在尝试创建一个可调整大小的自动完成功能（我什至不确定这是否可能！）。我已经尝试了很多从谷歌那里得到想法的事情，但一直没能完成。我创建了一个可调整大小的菜单的代码，但它没有与文本框的底部对齐，当我第二次搜索时，调整大小选项消失了。有没有办法修复它，或者可以通过任何其他方式实现此功能？

```
 <head runat="server">
    <title></title>
    <link href="~/css/1.8/jquery-ui.css" rel="stylesheet" type="text/css" />
    <script src="~/script/jquery/1.5/jquery.min.js"></script>
    <script src="~/script/jqueryui/1.8/jquery-ui.min.js"></script>

    <style>
        .ui-resizable-se
        {
            bottom: 0px;
        }
        .ui-autocomplete
        {
            background: silver;
            overflow-y: hidden; /* prevent horizontal scrollbar */
            overflow-x: hidden;
        }
    </style>
    <script>
        $(function () {
            var availableTags = [
            "ActionScript",
            "AppleScript",
            "Asp",
            "BASIC",
            "C",
            "C++",
            "Clojure",
            "COBOL",
            "ColdFusion",
            "Erlang",
            "Fortran",
            "Groovy",
            "Haskell",
            "Java",
            "JavaScript",
            "Lisp",
            "Perl",
            "PHP",
            "Python",
            "Ruby",
            "Scala",
            "Scheme"
        ];
            $("#tags").autocomplete({
                source: availableTags,
                open: function (event, ui) {
                    $('ul.ui-autocomplete').resizable();
                }
            });
        });

        $(function () {
            $("#ul.ui-autocomplete").resizable({
                handles: "se"
            });
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div class="ui-widget">
        <label for="tags">
            Tags:
        </label>
        <input id="tags">

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-13T15:05:31.837

它适用于不同版本的 jquery 和 jquery ui（调整自动完成下拉菜单）。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script> 
```

[JSFiddle](http://jsfiddle.net/gU5Tb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T14:05:43.167

这是一个有效的小提琴：

[http://jsfiddle.net/gU5Tb/3/](http://jsfiddle.net/gU5Tb/3/)

您的 jQuery 和 jQuery UI 版本已弃用。

```
<html>
   <head runat="server">
    <title></title>
    <link href="~/css/1.8/jquery-ui.css" rel="stylesheet" type="text/css" />
    <script src="~/script/jquery/1.9.1/jquery.min.js"></script>
    <script src="~/script/jqueryui/1.9.2/jquery-ui.min.js"></script>

    <style>
        .ui-resizable-se
        {
            bottom: 0px;
        }
        .ui-autocomplete
        {
            background: silver;
            overflow-y: hidden; /* prevent horizontal scrollbar */
            overflow-x: hidden;
        }
    </style>
    <script>
        $(function () {
            var availableTags = [
            "ActionScript",
            "AppleScript",
            "Asp",
            "BASIC",
            "C",
            "C++",
            "Clojure",
            "COBOL",
            "ColdFusion",
            "Erlang",
            "Fortran",
            "Groovy",
            "Haskell",
            "Java",
            "JavaScript",
            "Lisp",
            "Perl",
            "PHP",
            "Python",
            "Ruby",
            "Scala",
            "Scheme"
        ];
            $("#tags").autocomplete({
                source: availableTags,
                open: function (event, ui) {
                    $('ul.ui-autocomplete').resizable();
                }
            });
        });

        $(function () {
            $("#ul.ui-autocomplete").resizable({
                handles: "se"
            });
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div class="ui-widget">
        <label for="tags">
            Tags:
        </label>
        <input id="tags">

    </div>
    </form>
</body>
</html> 
```

# html - 使用css水平间隔我的复选框？

> ID：12981746
> 
> 赞同：2
> 
> 时间：2012-10-19T20:10:01.887
> 
> 标签：html, css, checkbox, margin, padding

我有一个复选框列表，我想在一条水平线上隔开。

```
<div class="timesheet-daily-entry-fields-container">
        <input id="TimesheetMondayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
        <input id="TimesheetTuesdayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
        <input id="TimesheetWednesdayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
        <input id="TimesheetThursdayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
        <input id="TimesheetFridayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
        <input id="TimesheetSaturdayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
        <input id="TimesheetSundayCheckbox" class="timesheet-daily-checkbox" type="checkbox"/>
 </div> 
```

它们显示在行上，但我想将它们隔开更多。

```
.timesheet-daily-checkbox {
    margin: 10px;
    padding: 10px;
    display:inline-block;
    overflow:hidden
} 
```

我宁愿不围绕每个输入创建一个 div，有没有更简单的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T20:14:13.303

增加左右边距

```
margin: 10px 20px; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:16:31.323

您可以在包含元素的类和输入标签上定义 CSS 类，如下所示：

```
.timesheet-daily-entry-fields-container input {
    margin: 10px;
    padding: 10px;
    display:inline-block;
    overflow:hidden
} 
```

这将使您不必为每个输入元素添加一个类。要使它们间隔更多，请增加边距。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:13:33.837

好吧，您甚至还没有标签。你试过吗？标签和一些空间会产生奇迹。

# java - TitleAreaDialog - 更改 setTitle("abc") 的字体

> ID：12981748
> 
> 赞同：2
> 
> 时间：2012-10-19T20:10:18.293
> 
> 标签：java, fonts, swt, jface, titleareadialog

我正在课堂上扩展 TitleAreaDialog。

标题区域中标题的默认字体看起来不是很好。
是否可以更改标题的字体？
我不需要更改代码中其他任何地方的字体，只需更改标题文本即可。

我尝试过使用 FontRegistry 以及 StyledText。

但我不知道如何将新字体分配给 setTitle()。

```
FontRegistry fontRegistry = JFaceResources.getFontRegistry();
FontData mainFont = new FontData("Garamond", 18, SWT.NORMAL);
fontRegistry.put("mainFont", new FontData[]{mainFont});
?.setText("Title Text");
?.setFont(fontRegistry.get("mainFont"));  
setTitle(?); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T10:02:50.680

我真的不认为这是可能的。您设置的`title` `String`via`setTitle(String)`显示在`private`字段中`titleLabel`。`Label`子类化时不能访问它`TitleAreaDialog`。因此，您不能将 a`Font`应用于它。

* * *

`MyTitleAreaDialog extends TrayDialog`因此，我能想到的唯一可能性是根据原始代码创建自己的代码`TitleAreaDialog`并将您设置在`Font`那里。您可以在 SWT.jar 中或在线找到源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-02T15:29:46.227

这是一个老问题的答案，但它可能对某人有所帮助。您可以通过更改 JFaceResources 字体注册表中的字体来实现。

```
static 
{
    JFaceResources.getFontRegistry().put(JFaceResources.BANNER_FONT, yourFont.getFontData());
}; 
```

我已将此代码添加到静态块中，因此它只执行一次。

# jquery - 如何使用 JSON 数据来提供两个不同的视图？

> ID：12981749
> 
> 赞同：0
> 
> 时间：2012-10-19T20:10:22.477
> 
> 标签：jquery, ruby-on-rails, ajax, ruby-on-rails-3

我有具有两个使用相同数据的视口的 rails 应用程序。我可以像这样获取 JSON 格式的数据：

```
$.read(
    '/en/search/fetch_companies',
    { current_location_lat: 72, current_location_lng: 10, bounding_box: 10 },
    function (response) {
        for (var i = 0; i < response.length; i++) {
            var markerPosition = new google.maps.LatLng(response[i].latitude, response[i].longitude);
            var marker = new google.maps.Marker({
                position:markerPosition,
                map:map,
                title:"AJAX!"
                });
        }
    }
); 
```

上面的代码在谷歌地图上创建标记。第二个视口是一个简单的表格。

```
 <% @companies.each do |company| %>
    <tr>
      <td>
        <address>
          <strong><%= company.name %></strong><br>
          <%= company.address %>
          <br>
          <%= company.city %>,<%= company.province %>
          <br>
          <%= company.postalcode %>
        </address>
      </td>
      <td>
        <%= link_to book_appointment_path(:choose_service, :company_id => company.id), :class => "btn btn-info btn-center-col" do %>
          <i class="icon-time icon-white"></i> Book Appointment
        <% end %>
      </td>
    </tr>
  <% end %> 
```

现在我一直在发送两个请求来获取 JSON 数据。一个用于表格视图，一个用于地图。这对我来说是不能接受的。Map 和 Table 需要同时提供相同的数据，但由于 Rails 在服务器上解析，我无法用 JSON 数据填充表。

有谁知道一些可以很好地与 Rails、Ajax 和分页配合使用的表格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T18:44:38.630

[一个足够好的答案](https://stackoverflow.com/questions/13040088/does-anyone-know-a-js-lib-for-dynamic-tables-with-pagination)。考虑到这个问题的参数，我认为这是最干净的解决方案。

基本上，我创建了一个 RESTful 服务，允许我搜索某些内容，并使用 Backbone 库来显示我的结果。我需要比一个简单的 Rails 组件更多的工作，因为你需要做 JS 但要正确支持 AJAX，这是要走的路。

# jquery - 使用选择器检索当前 td 的属性“名称”

> ID：12981753
> 
> 赞同：1
> 
> 时间：2012-10-19T20:10:38.780
> 
> 标签：jquery

我有一个包含三列的表格，现在我可以使用此选择器选择表格的第三列

```
$('td:eq(2)') 
```

现在我有我的单元格的内容是

```
<span class="ui-icon ui-icon-trash" id="deleteRow" name="dbConnectionUrl"></span> 
```

如何检索属性名称的内容。我用 attr 函数试过了，但它不起作用

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T20:11:52.393

记住`<span>`ID：

```
$("#deleteRow").attr("name");
// or
$("#deleteRow").prop("name"); 
```

但是，请注意页面上具有相同 ID 的多个元素，因为**ID 应该是唯一的**。

分别对于您的单元格，选择器可能如下所示：

```
$("td:eq(2) span").attr("name"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:11:53.790

我假设您想要跨度标签的名称..因为它有一个 ID，您可以直接通过

```
$('#deleteRow')[0].name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:11:55.813

您是否尝试过 jquerys .attr('name') 方法？ [http://api.jquery.com/attr/](http://api.jquery.com/attr/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T20:14:37.547

只需稍微更改您的选择器：

`​$('table td:eq(2) #deleteRow')​​​​​​​​​​​​​​​.attr('name')`

这将为您提供 name 属性的值。

小提琴：http: [//jsfiddle.net/gromer/w3pQq/](http://jsfiddle.net/gromer/w3pQq/)

# java - 来自 HttpServletResponse 的 Spring MVC 相对重定向

> ID：12981754
> 
> 赞同：5
> 
> 时间：2012-10-19T20:10:46.937
> 
> 标签：java, spring, spring-mvc

鉴于这种相对重定向到另一个控制器的方法：

```
@Controller
@RequestMapping("/someController")
public class MyController {
    @RequestMapping("/redirme")
    public String processForm(ModelMap model) {            
        return "redirect:/someController/somePage";
    }
} 
```

鉴于我在拦截器中，如何模拟相同的*相对重定向？*

```
public class MyInterceptor extends HandlerInterceptorAdapter {
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception
    {
        response.sendRedirect("/someController/somePage");
        return false;
    }
} 
```

现在有了拦截器，当我真的想在 application.com/deployment/someController/somePage 时，我将在 application.com/someController/somePage 结束。当然必须有一个“弹簧”解决方案吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-19T20:54:58.083

将我的评论转换为答案 -

尝试使用`response.sendRedirect(request.getContextPath() + uri);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:36:27.777

在参考了[重定向文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-redirecting)，查看了 UrlBasedViewResolver 的源代码和 gotuskar 的评论之后，我觉得很傻，因为不知道这会起作用并有解决方案：

```
public class MyInterceptor extends HandlerInterceptorAdapter {
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception
    {
        StringBuilder targetUrl = new StringBuilder();
        if (this.redirectURL.startsWith("/")) {
            // Do not apply context path to relative URLs.
            targetUrl.append(request.getContextPath());
        }
        targetUrl.append(this.redirectURL);

        if(logger.isDebugEnabled()) {
            logger.debug("Redirecting to: " + targetUrl.toString());
        }

        response.sendRedirect(targetUrl.toString());
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-09T21:23:50.500

正如对最近的问题[Context path with url-pattern redirect in spring](https://stackoverflow.com/questions/27843540/context-path-with-url-pattern-redirect-in-spring)的回答所推荐的那样，您可以使用`ServletUriComponentsBuilder`

# xpath - XPath：获取包含奥巴马但不包含罗姆尼的文本

> ID：12981758
> 
> 赞同：0
> 
> 时间：2012-10-19T20:10:54.910
> 
> 标签：xpath

我对 XPath 很陌生，所以请耐心等待。我有一个 XPath 表达式

`'.//*[contains(.,"Obama")]/text()'`

这让我得到了包含“奥巴马”的文本。但是，我一直无法弄清楚如何添加

`and [not(contains(., "Romney"))]`到表达式而不会出现语法错误。它是如何完成的？帮助很大！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:33:25.310

**使用**：

```
.//*[contains(.,"Obama") and not(contains(.,"Romney"))]/text() 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
     <xsl:copy-of select=
     './/*[contains(.,"Obama") and not(contains(.,"Romney"))]/text()'/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<election>
 <choice>Maybe  Obama</choice>
 <choice>Maybe Romney</choice>
</election> 
```

**计算 XPath 表达式并将所选节点复制到输出：**

```
Maybe  Obama 
```

**请注意**：

```
SomeExpression[x][y] 
```

并不总是等同于：

```
SomeExpression[x and y] 
```

因此，建议使用后者——而不是前者，正如@ChrisGerken 的回答中所指定的那样。

**这是一个具体的例子**：

**让我们拥有这个 XML 文档**：

```
<nums>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>10</num>
</nums> 
```

**以及这两个 XPath 表达式**：

```
/*/*[. mod 3 = 0 and position() = 3] 
```

**和**

```
/*/*[. mod 3 = 0][position() = 3] 
```

**第一个表达式选择**：

```
<num>03</num> 
```

**但是，第二个表达式选择**：

```
<num>09</num> 
```

**这是一个完整的基于 XSLT 的验证：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
     <xsl:copy-of select=
     "/*/*[. mod 3 = 0 and position() = 3]"/>
     ================
     <xsl:copy-of select=
     "/*/*[. mod 3 = 0][position() = 3]"/>

 </xsl:template>
</xsl:stylesheet> 
```

**当对上述 XML 文档应用此转换时，会计算两个 XPath 表达式，并将这些计算的结果复制到输出中：**

```
<num>03</num>
================
<num>09</num> 
```

**说明**：

`position()`是 *context-sensitive` 函数，通常在第 k 个和第 m 个谓词中使用时会产生不同的结果，其中 k != m

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:17:13.170

尝试这个：

```
'.//*[contains(.,"Obama")][not(contains(.,"Romney"))]/text()' 
```

您可以一个接一个地放置任意数量的谓词：

```
[a][b][c] 
```

# sql - 如何用外键更新表

> ID：12981768
> 
> 赞同：2
> 
> 时间：2012-10-19T20:11:24.237
> 
> 标签：sql, sql-server, tsql, foreign-keys

实际上我有两个数据库，一个用于暂存，一个用于生产。一个表，例如称为`Class(class_id,descr,faculty_id)`和`faculty_id`对另一个表的引用称为`Faculty(faculty_id, name,comment)`.

我的故事是，我在暂存数据库、Faculty 表上做了很多更新，在不更改 Class 表的情况下更改了很多教师评论和名称。我想将临时教员表复制到生产。我原来的方法是从 staging 生成脚本并删除数据表，在生产中的 Faculty 并运行脚本，以便将 staging 数据表 Faculty 复制到生产。但是我发现我无法删除 Faculty 表，因为外键。但是我不想写几百条更新语句，也不能删除生产中的Class数据，如果我想将Faculty表复制到生产中怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:42:36.243

暂时删除`class`and`faculty`和do之间的关系，然后再建立关系。。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T23:12:05.673

让我们假设 staging Faculty 中的所有代理键与生产中的代理键相同。

1.  将 Faculty 表复制到 Production 作为 Faculty_Staging
2.  更改班级表并删除对教师的外键引用
3.  将学院重命名为 Faculty_backup
4.  将 Faculty_Staging 重命名为 Faculty
5.  更改类表并恢复外键约束

如果尝试重建外键引用失败，则您的临时教员表中的代理键存在问题。

1.  将学院重命名为 Faculty_Staging
2.  将 Faculty_Backup 重命名为 Faculty
3.  更改类表并恢复外键约束。

需要考虑的事项：

1.  Faculty 和 Faculty_Staging 中的代理键是否完全匹配？
2.  Faculty 和 Faculty_Staging 中的备用键是否完全匹配？
3.  您是否无意中删除了 Faculty staging 中的任何生产行？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:13:15.797

尝试这个：

备份包含外键的类表。

截断类表。

对教师进行更新。

最后恢复你的班级表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-20T05:19:30.063

您知道您可以使用 SQL 生成 SQL 脚本吗？（这仅适用于faculty 在staging 和production 中具有相同faculty_id 的情况）

这将生成插入新学院的脚本：

```
SELECT 'INSERT INTO production.Faculty (faculty_id, name, comment) 
        SELECT TOP 1 '+LTRIM(faculty_id)+','''+name+''','''+comment+'''
          FROM production.Faculty
         WHERE NOT EXISTS (SELECT 1 FROM production.Faculty WHERE faculty_id = '+LTRIM(faculty_id)+');' AS runMeOnProduction
  FROM staging.Faculty 
```

这将生成脚本来更新现有学院：

```
SELECT 'UPDATE production.Faculty SET name = '''+name+''', comment = '''+comment+'''
         WHERE faculty_id = '+LTRIM(faculty_id)+';' AS runMeOnProduction
  FROM staging.Faculty 
```

如果您的姓名或评论字段中有引号，您可能希望将上述 SQL 语句中的姓名和评论替换为：

```
REPLACE(name,'''','''''')
REPLACE(comment,'''','''''') 
```

这不是最好的方法，特别是如果您在两种环境中的两个表上都获得插入和更新。但是，如果教职员工的数据仅在分期方面有所增长，那么这项工作就可以了。

此外，一些查询软件在您运行这些 SQL 语句时会显示一个 blob 或一些十六进制，因为它认为字符串太长无法显示，如果您复制粘贴它，它可能仍然正确。否则尝试另一个 SQL 查询工具。我将 DBVisualiser 用于这种事情并且它有效。我不是为任何特定的数据库查询工具做广告，只是我必须经常查询 mySQL 和 MSSQL，所以我发现自己从一个应用程序跳到另一个应用程序以完成工作。

如果在两种环境中都有数据输入，您应该考虑使用适当的数据比较工具：[http](http://en.wikipedia.org/wiki/Comparison_of_database_tools) ://en.wikipedia.org/wiki/Comparison_of_database_tools 一旦您开始使用这些，您的问题可能会有所不同。

这可能是古怪的想法，但我之前发现它很方便......

# c# - WPF 动画警告：6：无法执行操作

> ID：12981771
> 
> 赞同：3
> 
> 时间：2012-10-19T20:11:42.757
> 
> 标签：c#, wpf, xaml

我在 VIsual Studio 输出面板中的 WPF 应用程序警告中观察到以下文本：

> WPF 动画警告：6：无法执行操作，因为指定的情节提要从未应用于此对象以进行交互式控制。Action='Stop'; Storyboard='System.Windows.Media.Animation.Storyboard'; *Storyboard.HashCode='65981734'* ; Storyboard.Type='System.Windows.Media.Animation.Storyboard'; TargetElement='System.Windows.Controls.ContentPresenter'; TargetElement.HashCode='49882372'; TargetElement.Type='System.Windows.Controls.ContentPresenter'

如何将 HashCode “反转”到某些 xaml 元素？如何找到该动画的附加位置？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T23:34:17.243

您可以使用以下代码找到您的 StoryBoard：

```
private string GetStoryBoardNameByHashCode(int hashCode)
{
    foreach (DictionaryEntry resource in Resources)
    {
        if (resource.Value is Storyboard)
        {
            if (resource.GetHashCode() == hashCode)
                return ((Storyboard) resource.Value).Name;
        }
    }
    return String.Empty;
} 
```

像这样执行方法：

```
 string storyBoardName = GetStoryBoardNameByHashCode(65981734); 
```

这应该能够获取带有 HashCode 的 StoryBoard-Name（或者，如果您想获取指定的 StoryBoard，您也可以返回它）。请注意，ResourceDictionary 位于此处的窗口范围（本地）上。因此，如果 StoryBoard 都位于应用程序 (App.xaml) 的 ResourceDictionary 中，则将“资源”更改为：

```
Application.Current.Resources 
```

可能有另一种方法可以获取 WPF 应用程序的所有资源，而不仅仅是本地或应用程序范围的资源，但尚未对此进行研究。希望这段代码能让你找到你的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-12T16:09:53.343

其实我也遇到了和你一样的问题。

我发现动画的`Begin()`方法在调用它的方法之前没有`Stop()`被调用。因此，运行时会发出无法调用停止操作的警告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-11T17:49:27.460

我的问题是我的 EventName 中有一个尾随空格。

```
<interactivity:EventTrigger EventName="SelectionChanged "> 
```

变成

```
<interactivity:EventTrigger EventName="SelectionChanged"> 
```

# jquery-ui - Jquery UI Datepicker禁用错误的日子

> ID：12981789
> 
> 赞同：1
> 
> 时间：2012-10-19T20:12:25.817
> 
> 标签：jquery-ui, datepicker

我遇到了问题，必须禁用的日子被转移到第二天。这个想法是在我们的对象中不存在`booking`或值小于 1 的那一天应该在日历上被禁用。

这是我的脚本的简化版本和[jsfiddle](http://jsfiddle.net/YhbLG/3/)上的演示：

```
var bookings = {
    "2012-09-01": 24,
    "2012-09-03": 31,
    "2012-09-05": 27,
    "2012-09-06": 9, 
    "2012-09-07": 18, 
    "2012-09-08": 0, 
    "2012-09-10": 20, 
    "2012-09-12": 19, 
    "2012-09-13": 0, 
    "2012-09-14": 9, 
    "2012-09-15": 24, 
    "2012-09-17": 19, 
    "2012-09-19": 28, 
    "2012-09-20": 15, 
    "2012-09-21": 12, 
    "2012-09-22": 25, 
    "2012-09-24": 19, 
    "2012-09-26": 0, 
    "2012-09-27": 0, 
    "2012-09-28": 0, 
    "2012-09-29": 0
};

function MyEvent(date)
{
    bookings = bookings || {};
    this.date = date.toISOString().substr(0, 10);
    this.display = (typeof bookings[this.date] == 'number' && bookings[this.date] > 0);
    return this;
}

MyEvent.prototype.toArray = function () { 
    return [this.display, null, null]; 
};

$(function ()
{
    $('#eventCalendar').datepicker({
            dateFormat:    "yy-mm-dd",
            firstDay:      1,
            defaultDate:   "2012-09-24",
            beforeShowDay: function (date)
            {
                return new MyEvent(date).toArray();
            }
        }
    );
}); 
```

有人可以建议我做错了什么还是一个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T10:56:52.157

这是一个小小的挣扎，但不是一个错误。使用有问题：

```
date.toISOString() 
```

该操作可以返回与从插件传递的原始日期不同的日期（例如第二天），因为该函数忽略时区偏移

> [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toISOString](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toISOString)

所以你的情况不会很好。

这是一个没有使用该功能的工作小提琴：http: [//jsfiddle.net/nBejK/2/](http://jsfiddle.net/nBejK/2/)

# android - Android - 使用 webview 配置应用程序以在下载打开 PDF 时自动启动 PDF 阅读器

> ID：12981790
> 
> 赞同：0
> 
> 时间：2012-10-19T20:12:26.823
> 
> 标签：android, pdf, webview, android-webview

一个应用程序正在使用 webview 来显示一个站点，就好像它是一个应用程序一样。我想让该应用程序在下载 PDF 时打开阅读器。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T00:02:27.083

如果您使用的是 Webview，那么您可以处理 PDF 的一种方法是绑定一个对象，该对象扩展[`WebViewClient`](http://developer.android.com/reference/android/webkit/WebViewClient.html)为您`WebView`使用`setWebViewClientMethod`. 扩展`WebViewClient`将需要覆盖该[`onLoadResource`](http://developer.android.com/reference/android/webkit/WebViewClient.html#onLoadResource%28android.webkit.WebView,%20java.lang.String%29)方法的对象。

然后在此方法中检查您的 URL 是否有 pdf 扩展名，或 URL 的其他一些指示 PDF 的属性，并使用 PDF URL 触发新的查看意图。这应该可以在适当的应用程序中打开 PDF。如果你想有一个更偏执的后备，你可以使用谷歌的 PDF 渲染器，方法是在你的 URL 前面加上`http://docs.google.com/viewer?url=`URL 编码要打开的原始 URL，例如[http://research.google.com/archive/bigtable-osdi06.pdf](http://research.google.com/archive/bigtable-osdi06.pdf)变为[http://docs.google.com/viewer?url=http%3A%2F%2Fresearch.google.com%2Farchive%2Fbigtable-osdi06.pdf](http://docs.google.com/viewer?url=http%3A%2F%2Fresearch.google.com%2Farchive%2Fbigtable-osdi06.pdf)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T21:23:46.037

检查响应的内容类型，然后在适当的时候显示 PDF 内容。你看过这个帖子吗？[如何在 Android 中渲染 PDF](https://stackoverflow.com/questions/2883355/how-to-render-pdf-in-android/)它概述了打开 PDF 的几种方法

# r - 带日期的 R 数据框

> ID：12981793
> 
> 赞同：1
> 
> 时间：2012-10-19T20:12:37.293
> 
> 标签：r, dataframe, quantmod

我有以下形式的数据框

```
 SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted
2007-01-03   142.25   142.86  140.57    141.37   94807600       125.38
2007-01-04   141.23   142.05  140.61    141.67   69620600       125.65
2007-01-05   141.33   141.40  140.38    140.54   76645300       124.64
2007-01-08   140.82   141.41  140.25    141.19   71655000       125.22
2007-01-09   141.31   141.60  140.40    141.07   75680100       125.11
2007-01-10   140.58   141.57  140.30    141.54   72428000       125.53 
```

但是该命令`index(DATA.FRAME)`返回整数而不是日期。我应该使用什么函数来获取日期列表而不是整数？

编辑：

dput(DATA.FRAME) 的输出是

```
structure(list(SPY.Open = c(142.25, 141.23, 141.33, 140.82, 141.31, 
140.58), SPY.High = c(142.86, 142.05, 141.4, 141.41, 141.6, 141.57
), SPY.Low = c(140.57, 140.61, 140.38, 140.25, 140.4, 140.3), 
    SPY.Close = c(141.37, 141.67, 140.54, 141.19, 141.07, 141.54
    ), SPY.Volume = c(94807600, 69620600, 76645300, 71655000, 
    75680100, 72428000), SPY.Adjusted = c(125.38, 125.65, 124.64, 
    125.22, 125.11, 125.53)), .Names = c("SPY.Open", "SPY.High", 
"SPY.Low", "SPY.Close", "SPY.Volume", "SPY.Adjusted"), row.names = c("2007-01-03", 
"2007-01-04", "2007-01-05", "2007-01-08", "2007-01-09", "2007-01-10"
), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:19:37.373

```
rownames(DATA.FRAME) #results in character vector
#[1] "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-08" "2007-01-09" "2007-01-10"

as.Date(rownames(DATA.FRAME)) #convert to date 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T20:19:38.153

我不熟悉`index`R 中的命令。看起来日期存储为`rownames`您的数据框。

我会尝试：

```
as.Date(rownames(DataFrameName)) 
```

或者，您可以在 R 中将整数转换为日期。我完全忘记了如何，但基本上您只需要一个对话因素（比如 15344 = 2007 年 10 月 9 日或其他东西） - 它应该在`?as.Date`或`?as.POSIXct`

# wordpress - 迫切需要 WordPress 迁移方面的帮助

> ID：12981794
> 
> 赞同：1
> 
> 时间：2012-10-19T20:12:43.113
> 
> 标签：wordpress, migration

我已经在 StackExchange 的 WordPress 部分和 WordPress 支持论坛上发帖，但没有成功，我正面临来自客户的压力，要求他们启动并运行他们的网站。

我尝试将我的 WP 站点迁移到不同的服务器和域名，但没有成功。这些是我按照说明和指南采取的步骤。

1.  从旧域下载了我的 WP 站点的根文件夹
2.  从旧域导出我的数据库
3.  在新域创建新数据库
4.  在新域中导入新数据库
5.  wp-config 中更改的数据库名称、用户名、密码和主机
6.  将 Search Replace DB v.2.1.0 放置在根文件夹中
7.  将 WP 文件夹上传到新服务器

我得到的只是一个空白屏幕。

我现在想做的是询问是否有任何方法可以在新服务器上执行全新的 WordPress 安装，只需复制并粘贴所需的文件并从我希望迁移的站点导入我的数据库。

我真的很感激任何帮助，因为我遇到了一个我自己无法克服的绊脚石。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T00:27:24.530

几周前我也遇到了这个问题，发现问题是通过在移动文件之前更改 URL 来解决的。插件通常是迁移时问题的根源，因此仔细迁移这些插件很重要（最好在移动时关闭）。

此外，空白屏幕可能意味着您在 php.ini 中关闭了错误报告。确保它已打开，它应该会告诉你哪里出错了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T23:07:59.853

如果这很重要，您可能有某种预算？[WPTwin](http://wptwin.com/)是一款不错的产品，但如果您正在寻找稳健的迁移交易，您可以购买我推荐的[Backup Buddy 。](http://ithemes.com/purchase/backupbuddy/)

大约 3 周前，我们不得不将大型多站点（当时超过 200 个站点，现在超过 1,500 个）移动到新服务器。我们使用了 Backup Buddy，它可以无缝运行！

我们还使用它来设置我们的 wordpress 软件的“白标”版本，因此基本上是克隆它，并将其移动到新域名下的新服务器上。

它非常强大并且完美无瑕！我们曾经只有一个问题，那就是只有一次它没有在某些子域中继承页面模板。除此之外，男孩我评价它 98%，这是一个很棒的插件，虽然有点贵，但值得！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T03:31:06.783

将站点从本地开发环境迁移到实时环境时，我使用以下过程。

1 - MySQL 转储本地数据库
2 - 在文本编辑器中打开 sql 文件。使用实时 url 对 dev url 更新进行查找和替换；例如[http://site.loc](http://site.loc) -> [http://livesite.com](http://livesite.com)
3 - 创建新的 live db，上传新的 SQL
4 - 上传 dev wordpress 安装的克隆
5 - 更新 live wp-config 以反映新的数据库名称、密码等
6 - 检查文件和目录的权限
7 - 确保 .htaccess 就位
8 - 打开实时站点

这个过程对我来说永远不会失败。

# colors - 更改咆哮消息颜色

> ID：12981795
> 
> 赞同：1
> 
> 时间：2012-10-19T20:12:49.463
> 
> 标签：colors, primefaces, growl

我的应用程序中的所有页面都有一个通用的 CSS，称为`growl.css`...

我有

```
.ui-growl{
      position: fixed;
      top: 50%;
      left: 50%;
      margin-top: -50px;
      margin-left: -100px;    
      } 
```

如何更改咆哮消息的背景颜色。插入颜色并`background-color`没有改变任何东西。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:24:35.843

```
.ui-growl-item-container { background-image: url('./imgs/background.jpg'); } 
```

这是设置图像，尝试使用颜色或背景颜色

# java - 在 Android 中使用 Java Mail API 发送大图像（>500 KB）时出错

> ID：12981802
> 
> 赞同：3
> 
> 时间：2012-10-19T20:13:27.780
> 
> 标签：java, android, service, jakarta-mail, android-context

我正在构建一个 Android 应用程序，我想通过它立即邮寄从设备相机拍摄的照片。我希望这在后台完成，所以我使用了 JAVA Mail API，并且我正在启动一个服务来邮寄图像。

到目前为止，我的代码在图像 < 50 KB 的情况下工作正常，但是当我尝试邮寄图像 >= 500 KB 时它会抛出奇怪的错误。现在我正在为文件和用户名、密码使用硬编码值。

## 我的后台服务代码：-

```
public class BgMailer extends Service{

private ArrayList<String>Recievers ;
private String msg,sub;
public void onCreate() {
    // TODO Auto-generated method stub
    //Toast.makeText(getApplicationContext(), "service created",5000).show();

    super.onCreate();

}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {

    //Toast.makeText(this, DataHolder., duration)
    //sendMail();
      Notification note = new Notification( 0, null, System.currentTimeMillis() );
        note.flags |= Notification.FLAG_NO_CLEAR;
        startForeground( 42, note );

    Recievers = intent.getStringArrayListExtra("recievers");
    sub = intent.getStringExtra("sub");
    msg = intent.getStringExtra("msg");

    sendMail(Recievers, sub, msg);
//  stopForeground(true);

    this.stopSelf();
    return super.onStartCommand(intent, flags, startId);

}

@Override
public void onDestroy() {
    // TODO Auto-generated method stub
    //Toast.makeText(getApplicationContext(), "service destroyed",5000).show();
    super.onDestroy();
}

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

public  void sendMail(ArrayList<String>recvr,String sub,String msg){
     Mail m = new Mail("r4jiv007@gmail.com", "<password>");

     String [] address = new String[recvr.size()];
        address = recvr.toArray(address);
        m.set_to(address);
        m.set_from("r4jiv007@gmail.com");
        m.set_subject(sub);
        m.setBody(msg);

        try {
             m.addAttachment("/sdcard/1.jpg");
           //m.addAttachment("/sdcard/1.txt");
     //     m.addAttachment("/sdcard/bday.jpg");
          if(m.send()) {
            Toast.makeText(getApplicationContext(), "Email was sent successfully.", Toast.LENGTH_LONG).show();
          } else {
            Toast.makeText(getApplicationContext(), "Email was not sent.", Toast.LENGTH_LONG).show();
          }
        } catch(Exception e) {
          Log.e("MailApp", "Could not send email", e);
        } 
}

} 
```

* * *

LogCat 中的错误值：-

```
10-20 01:34:13.690: W/ActivityManager(134): Timeout executing service: 
ServiceRecord{40ae01d0 my.com.cnm/.BgMailer}
10-20 01:34:13.800: I/Process(134): Sending signal. PID: 1845 SIG: 3
10-20 01:34:13.800: I/dalvikvm(1845): threadid=4: reacting to signal 3
10-20 01:34:13.820: I/dalvikvm(1845): Wrote stack traces to '/data/anr/traces.txt'
10-20 01:34:13.830: I/Process(134): Sending signal. PID: 134 SIG: 3
10-20 01:34:13.830: I/dalvikvm(134): threadid=4: reacting to signal 3
10-20 01:34:13.870: I/dalvikvm(134): Wrote stack traces to '/data/anr/traces.txt'
10-20 01:34:13.870: I/Process(134): Sending signal. PID: 235 SIG: 3
10-20 01:34:13.870: I/dalvikvm(235): threadid=4: reacting to signal 3
10-20 01:34:13.880: I/dalvikvm(235): Wrote stack traces to '/data/anr/traces.txt'
10-20 01:34:13.880: I/Process(134): Sending signal. PID: 239 SIG: 3
10-20 01:34:13.880: I/dalvikvm(239): threadid=4: reacting to signal 3
10-20 01:34:13.900: I/dalvikvm(239): Wrote stack traces to '/data/anr/traces.txt'
10-20 01:34:13.900: I/Process(134): Sending signal. PID: 208 SIG: 3
10-20 01:34:13.900: I/dalvikvm(208): threadid=4: reacting to signal 3
10-20 01:34:13.900: I/dalvikvm(208): Wrote stack traces to '/data/anr/traces.txt'
10-20 01:34:14.481: D/dalvikvm(134): GC_CONCURRENT freed 1427K, 32% free 9016K/13191K, external 607K/1119K, paused 8ms+16ms
10-20 01:34:14.821: D/dalvikvm(134): GC_EXPLICIT freed 379K, 32% free 9072K/13191K, external 607K/1119K, paused 171ms
10-20 01:34:15.432: I/Process(134): Sending signal. PID: 1657 SIG: 3
10-20 01:34:15.432: I/dalvikvm(1657): threadid=4: reacting to signal 3
10-20 01:34:15.432: I/dalvikvm(1657): Wrote stack traces to '/data/anr/traces.txt'
10-20 01:34:15.442: E/ActivityManager(134): ANR in my.com.cnm:Bgmailer time=4035592
10-20 01:34:15.442: E/ActivityManager(134): Reason: Executing service my.com.cnm/.BgMailer
10-20 01:34:15.442: E/ActivityManager(134): Load: 3.78 / 3.97 / 3.79
10-20 01:34:15.442: E/ActivityManager(134): CPU usage from 13492ms to 0ms ago with 99% awake:
10-20 01:34:15.442: E/ActivityManager(134):   1.4% 230/com.htc.android.htcime: 1.3% user + 0% kernel / faults: 746 minor 3 major
10-20 01:34:15.442: E/ActivityManager(134):   4% 1845/my.com.cnm:Bgmailer: 3.7% user + 0.3% kernel / faults: 63 minor
10-20 01:34:15.442: E/ActivityManager(134):   2.2% 239/android.process.acore: 2.1% user + 0% kernel / faults: 12 minor
10-20 01:34:15.442: E/ActivityManager(134):   1.5% 272/dhd_dpc: 0% user + 1.5% kernel
10-20 01:34:15.442: E/ActivityManager(134):   1.2% 134/system_server: 0.7% user + 0.5% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0.8% 81/akmd: 0% user + 0.8% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0.6% 1657/my.com.cnm: 0.3% user + 0.2% kernel / faults: 4 minor
10-20 01:34:15.442: E/ActivityManager(134):   0.5% 424/com.android.htccontacts: 0.5% user + 0% kernel / faults: 54 minor
10-20 01:34:15.442: E/ActivityManager(134):   0.1% 208/com.android.systemui: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 271/dhd_watchdog: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 5/events/0: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 14/kondemand/0: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 64/kgsl-3d0/0: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 83/adbd: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 291/wpa_supplicant: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 552/com.ebuddy.android.xms: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0% 753/com.google.android.apps.maps:NetworkLocationService: 0% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   0.1% 848/com.google.android.apps.maps:LocationFriendService: 0% user + 0% kernel + 0%         iowait
10-20 01:34:15.442: E/ActivityManager(134): 19% TOTAL: 16% user + 2.3% kernel + 0.3% iowait + 0.1% softirq
10-20 01:34:15.442: E/ActivityManager(134): CPU usage from 1133ms to 1688ms later:
10-20 01:34:15.442: E/ActivityManager(134):   8.9% 134/system_server: 0% user + 8.9% kernel
10-20 01:34:15.442: E/ActivityManager(134):     5.3% 157/ActivityManager: 0% user + 5.3% kernel
10-20 01:34:15.442: E/ActivityManager(134):     1.7% 140/SurfaceFlinger: 1.7% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   1.7% 81/akmd: 1.7% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):     3.5% 1722/akmd: 3.5% user + 0% kernel
10-20 01:34:15.442: E/ActivityManager(134):   1.2% 1657/my.com.cnm: 1.2% user + 0% kernel / faults: 2 minor
10-20 01:34:15.442: E/ActivityManager(134): 14% TOTAL: 5.3% user + 8.9% kernel
10-20 01:34:15.452: I/Process(134): Sending signal. PID: 1845 SIG: 9
10-20 01:34:15.452: I/ActivityManager(134): Skipping background ANR: my.com.cnm:Bgmailer time=4035592
10-20 01:34:15.462: I/ActivityManager(134): Process my.com.cnm:Bgmailer (pid 1845) has died. 
```

这里有什么与优先级或服务相关的吗，我什至尝试将我的服务作为前台应用程序运行，但没有用..而且我无法弄清楚如何解决这个问题。我将不胜感激任何帮助！

谢谢 ：）

很好，感谢您针对此问题提出的建议，我刚刚创建了一个线程并通过它邮寄了图像，并且成功了..但是我想在邮寄过程成功完成时举杯祝酒，但出现以下错误：-

```
 E/MailApp(2131): Could not send email
java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
at android.os.Handler.<init>(Handler.java:121)
at android.widget.Toast.<init>(Toast.java:68)
at android.widget.Toast.makeText(Toast.java:231)
at my.com.cnm.BgMailer.sendMail(BgMailer.java:86)
at my.com.cnm.BgMailer$1.run(BgMailer.java:47)
at java.lang.Thread.run(Thread.java:1027) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:19:03.217

由于服务也在进程主线程中运行，您可能会尝试在服务中创建单独的线程来发送电子邮件。

以下来自[官方文档](http://developer.android.com/reference/android/app/Service.html)：

请注意，服务与其他应用程序对象一样，在其托管进程的主线程中运行。这意味着，如果您的服务要执行任何 CPU 密集型（例如 MP3 播放）或阻塞（例如网络）操作，它应该生成自己的线程来完成这项工作。

查看以下帖子中接受的答案，以显示来自后台线程的 Toast：

[Android：如何从远程服务中运行的线程显示敬酒？](https://stackoverflow.com/questions/6134013/android-how-can-i-show-a-toast-from-a-thread-running-in-a-remote-service)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:17:44.270

看起来你得到了一个，`ANR`因为它需要很长时间，也许如果你把发送代码放在一个，`AsyncTask`所以它在后台线程上运行，它不会被检测为一个`ANR`.

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# php - 使用雷鸟打开的电子邮件不会触发我打开的电子邮件功能

> ID：12981807
> 
> 赞同：0
> 
> 时间：2012-10-19T20:13:49.437
> 
> 标签：php, email, thunderbird

我正在使用附加到电子邮件的图像来触发打开的电子邮件功能。它在所有电子邮件帐户中都可以正常工作，但是在使用 Thunderbird 打开时不起作用，或者在使用 Outlook 时也不起作用（尚未尝试过）。难道是雷鸟故意阻止这种事情发生？由于没有创建此类功能的完整证据，我将如何解决这个问题？

电子邮件将包含此图像： `http://site/admin/tracking.php?uid=2&amp;msgid=0&amp;sched=2`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T17:04:27.800

默认情况下，Thunderbird 和其他电子邮件客户端会自动禁用图像，直到用户单击“显示远程内容”，不幸的是，无法绕过这种行为；但是，您可以要求订阅者将您添加到他们的通讯录中，以便您的电子邮件中的图像已经打开。这实际上是您对图像阻塞唯一可以做的事情。

# c# - 自定义数据注释不显示错误消息

> ID：12981814
> 
> 赞同：0
> 
> 时间：2012-10-19T20:14:45.777
> 
> 标签：c#, xaml, mvvm, data-annotations

我正在制作自定义数据注释并且正在做一些测试，但我无法弄清楚为什么它不显示我的错误消息。

**个人信息.cs**

```
[CustomValidation(typeof(AWValidation), "ValidateName")]
public String GivenName { get; set; } 
```

**AWValidation.cs**

```
 public static ValidationResult ValidateName(String name)
    {
        // Perform validation logic here and set isValid to true or false.

        if (name != null)
        {
            return ValidationResult.Success;
        }
        else
        {
            return new ValidationResult(
                "The name for this customer does not match the required criteria.");
        }
    } 
```

只有当用户单击保存按钮时，它才会输入 ValidationResult ValidateName(String name)，虽然它不显示 ValidationResult，但它会显示其默认的错误消息。

我想要的是当用户退出或失去 GivenName 文本框的焦点以显示我的自定义数据注释时。

我的同事告诉我这可能是因为它正在验证服务器端 GivenName，我需要让它验证客户端？虽然不明白为什么

```
[Required(ErrorMessage="This is a required value")]
public String GivenName { get; set; } 
```

当我失去 GivenName 文本框的焦点/标签时显示。

任何投入将不胜感激！谢谢，杰森 :)（PS 我正在使用 MVVM）

# sql-server - select 语句中的 select 语句是什么意思？

> ID：12981816
> 
> 赞同：0
> 
> 时间：2012-10-19T20:15:00.837
> 
> 标签：sql-server, sql-server-2008, tsql

Transact SQL 语句中的`Select`语句`from`是什么意思？

我的意思是这样的

```
 .. from ( 
    select .. 
 ) 
```

另外，我需要知道该语句是否对性能不利。您能否提供一个链接，指向 Transact SQL 中有关此主题的官方文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:15:59.507

我想你在谈论`subquery`. 子查询用于返回将在主查询中使用的数据，作为进一步限制要检索的数据的条件。

请参考此链接：- [http://www.tutorialspoint.com/sql/sql-sub-queries.htm](http://www.tutorialspoint.com/sql/sql-sub-queries.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T20:20:32.053

请参阅[MSDN 上有关 Subquery Fundamentals 的此链接](http://msdn.microsoft.com/en-us/library/ms189575%28v=sql.105%29.aspx)。

子查询可以很好，但要注意它们没有被索引。如果查询的外部部分必须连接到子查询的结果，性能可能会受到影响。请注意，查询优化器也可能为您的查询选择不同的执行顺序，因此即使您“从”子查询“开始”，优化器也可能在其他地方开始查询并加入您的子查询。

[相关子查询](http://msdn.microsoft.com/en-us/library/ms187638.aspx)（Joe Stefanelli 在上面的评论中首先在这里链接）是另一个性能问题。每当您有一个必须为外部查询的结果重复运行的查询时，性能都会受到影响。

请参阅[有关公用表表达式 (CTE) 的链接](http://msdn.microsoft.com/en-us/library/ms190766.aspx)。CTE 可能是编写查询的更好方法。子查询的其他替代方案包括[@table variables](http://msdn.microsoft.com/en-us/library/ms188927.aspx)和[#temporary tables](http://msdn.microsoft.com/en-us/library/ms174979.aspx)。

子查询最常见的用途之一是更新表时。`UPDATE`语句的 SET 列表中不能有聚合函数。您必须在子查询中计算聚合，然后加入主查询以更新表。例如：

```
-- A table of state and the total sales per state
declare @States table
(
    ID varchar(2) primary key,
    totalSales decimal(10,2)
)

-- Individual sales per state
declare @Sales table
(
    salesKey int identity(1,1) primary key,
    stateID varchar(2),
    sales decimal(10,2)
)

-- Generate test data with no sales totalled
insert into @States (ID, totalSales)
select 'CA', 0
union select 'NY', 0

-- Test sales
insert into @Sales (stateID, sales)
select 'CA', 5000
union select 'NY', 5500

-- This query will cause an error: 
-- Msg 157, Level 15, State 1, Line 13
-- An aggregate may not appear in the set list of an UPDATE statement.
update @States
set totalSales = SUM(sales)
from @States
inner join @Sales on stateID = ID

-- This query will succeed, because the subquery performs the aggregate
update @States
set totalSales = sumOfSales
from
(
    select stateID, SUM(sales) as sumOfSales
    from @Sales
    group by stateID
) salesSubQuery
inner join @States on ID = stateID

select * from @States 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:18:08.543

通过快速搜索，您会找到很多关于此的信息。例如，请参阅 MSDN 中的[子查询基础](http://msdn.microsoft.com/en-us/library/ms189575.aspx)

> 子查询是嵌套在 SELECT、INSERT、UPDATE 或 DELETE 语句或另一个子查询内的查询。子查询可以在任何允许使用表达式的地方使用。

# css - CSS背景图像未加载

> ID：12981817
> 
> 赞同：-7
> 
> 时间：2012-10-19T20:15:22.227
> 
> 标签：css, background, loading

我的问题是为什么我的背景图片没有加载到我的网站上（在我的 CSS 文件中）？我已将它们设置为 !important，这不起作用。我也在本地尝试了图像，但仍然无法正常工作。如果图像当前托管在不同的 URL 上，会不会有问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:26:40.990

您正在链接到`http://www.runescape.com/`域上的图像并且它们以 响应`404 Not Found`，即使如果您直接浏览这些图像确实存在（即它们以 响应`200 OK`）。这意味着他们[禁用了盗链](http://techgyo.com/index.php/disable-hotlinkingprevent-sites-stealing-bandwidth-htaccess-trick/)。

您正在尝试使用其他资源，但无论如何，这就是为什么在您的域使用时无法加载图像的原因，因为它们不允许这样做。

解决方案：使用您自己的图像，放置在您可以控制的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:25:23.520

肯定没有足够的信息来很好地回答......但如果你在谈论你的#Background 元素，这可能是一个路径问题。确保您的路径设置正确。

```
#Background{
 background: url(background_simple.jpg) no-repeat center 65px black;
 width: 100%;
 min-width: 1000px;
 left: 0;
 top: 0;
} 
```

例如，如果您的 CSS 在 /resources/ 目录中，而您的图像在 /images/ 目录中，那么您使用的内容将不起作用。你需要类似的东西：

```
background: url(../images/background_simple.jpg) no-repeat center 65px black; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:17:23.697

1.  如果您试图使用别人的图像，也许他们不允许热链接。
2.  如果您的图像存储在本地或您自己的服务器中，请验证路径或 url 可能是错误的。

# javascript - PhantomJS QUnitTeamCityDriver QUnit 测试运行

> ID：12981822
> 
> 赞同：4
> 
> 时间：2012-10-19T20:16:17.650
> 
> 标签：javascript, unit-testing, qunit, phantomjs

我想在 TeamCity 中对 JavaScript 使用单元测试。

我正在使用 QUnit，并且我看到一些建议使用 phantomjs 和 QUnitTeamCityDriver 的地方。我只是无法让它工作......

我在这方面没有很多经验，似乎甚至无法让 phantomjs 在命令行中运行单元测试。

我从字面上复制了 QUnitTeamCityDriver 中的示例：simple_test.html

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>QUnit Example</title>
  <link rel="stylesheet" href="test_tools/qunit-1.10.0.css">
  <script type="text/javascript" src="resources/jquery-1.8.1.js"></script>
  <script type="text/javascript" src="test_tools/qunit-1.10.0.js"></script>
  <script type="text/javascript" src="qunit_teamcity_driver/QUnitTeamCityDriver.js"></script> 
  <script type="text/javascript" src="tests.js"></script> 
</head>
<body>
  <div id="qunit"></div>
  <h1 id="qunit-header">QUnit example</h1>
  <h2 id="qunit-banner"></h2>
  <div id="qunit-testrunner-toolbar"></div>
  <h2 id="qunit-userAgent"></h2>
  <ol id="qunit-tests"></ol>
  <div id="qunit-fixture">test markup, will be hidden</div>   
</body>
</html> 
```

如果我尝试使用 simple_test.html，tests.js 有一些简单的测试是否有效。

当然，html 中的其他引用文件位于相应的文件夹中。

phantomjs.exe、tests.js 和 simple_test.html 位于我调用的目录的根目录中。

TeamCity 构建的方向是：

```
Add a "Command Line" Build Step to your build in TeamCity which executes Tests.htm via PhantomJS
Command executable: C:\PhamtomJS\phantomjs.exe
Command parameters: \Scripts\QUnitTeamCityDriver.phantom.js Tests.htm 
```

（这不起作用，所以我想在将命令行放入 TeamCity 之前先在实际命令行上进行测试）

我尝试过的一些事情：

```
phantomjs.exe tests.js
phantomjs.exe tests.js simple_test.html
phantomjs.exe simple_test.html
phantomjs.exe test_tools\qunit-1.10.0.js tests.js simple_test.html
phantomjs.exe qunit_teamcity_driver/QUnitTeamCityDriver.phantom.js simple_test.html 
```

结果：解析错误或找不到变量：测试

请有人指出我正确的方向，给我一个例子，告诉我我做错了什么？非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T21:27:14.873

如果您的技术堆栈是匹配的，我已经成功使用[Chutzpah](http://chutzpah.codeplex.com/)。

除其他外，它通过处理 kabaros 描述的对 phantomjs 的调用以及提供 TeamCity 和 Visual Studio 集成来为您完成繁重的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T20:55:48.193

简短的回答是，您需要运行：

```
phantomjs.exe script-runner.js simple_test.html 
```

长答案：

您将需要一个 javascript 文件来调用您的测试，我写了很多变体，但我发现最好的一个是 QUnitTeamCityDriver [https://github.com/redbadger/QUnitTeamCityDriver](https://github.com/redbadger/QUnitTeamCityDriver)。即使我不与 TeamCity 合作，我也使用了一些小改动。

这是文件的内容，可能有一些更改（我在最近的一个项目中使用过它），但你应该在 github 上找到原始文件（称之为 script-runner.js 并放在与 phantom 相同的文件夹中.exe 为方便起见）：

```
function waitFor(testFx, onReady, timeOutMillis) {
    var maxtimeOutMillis = timeOutMillis ? timeOutMillis : 3001, //< Default Max Timout is 3s
        start = new Date().getTime(),
        condition = false,
        interval = setInterval(function () {
            if ((new Date().getTime() - start < maxtimeOutMillis) && !condition) {
                // If not time-out yet and condition not yet fulfilled
                condition = (typeof (testFx) === "string" ? eval(testFx) : testFx()); //< defensive code
            } else {
                if (!condition) {
                    // If condition still not fulfilled (timeout but condition is 'false')
                    console.log("'waitFor()' timeout");
                    phantom.exit(1);
                } else {
                    // Condition fulfilled (timeout and/or condition is 'true')
                    typeof (onReady) === "string" ? eval(onReady) : onReady(); //< Do what it's supposed to do once the condition is fulfilled
                    clearInterval(interval); //< Stop this interval
                }
            }
        }, 100); //< repeat check every 250ms
};

var page = new WebPage();

// Route "console.log()" calls from within the Page context to the main Phantom context (i.e. current "this")
page.onConsoleMessage = function (msg) {
    console.log(msg);
};

page.open(phantom.args[0], function (status) {

    if (status !== "success") {
        console.log("Unable to access network");
        phantom.exit(1);
    } else {
        waitFor(function () {
            return page.evaluate(function () {
                var el = document.getElementById('qunit-testresult');
                if (el && el.innerText.match('completed')) {
                    return true;
                }
                return false;
            });
        }, function () {
            phantom.exit();
        }, 10000);
    }
}); 
```

这基本上会打开你的 html 页面并解析它。这对我来说是一个令人困惑的部分，phantomjs 最终是一个浏览器，你应该将这个脚本传递给它，最终将打开一个 HTML 页面而不是 Javascript 文件。所以你像这样调用phantomjs：

```
phantomjs.exe script-runner.js [path to file containing tests] 
```

所以在你的情况下，它将是：

```
phantomjs.exe script-runner.js simple_test.html 
```

难题的最后一点是，在包含测试的 html 页面中，您应该添加对 javascript 文件的引用，即引用中名为 QUnitTeamCityDriver.js 的文件。这将连接到 qUnit 事件并将它们引导到幻象，以决定什么是通过的测试，什么是失败的测试。文件的内容（同样你可以在 github 的项目页面上找到更好的最新版本）：

```
/*
Reference this file in the html files of the QUnit tests
Based on the work on this team city driver: https://github.com/redbadger/QUnitTeamCityDriver/
*/
if (navigator.userAgent.indexOf("PhantomJS") !== -1) {
    String.prototype.format = function () {
        var args = arguments;
        return this.replace(/{(\d+)}/g, function (match, number) {
            return typeof args[number] != 'undefined'
      ? args[number]
      : '{' + number + '}';
        });
    };

    var suiteName = "QUnit Tests";
    var currentTestName = "";
    var hasBegun = false;

    qunitBegin = function () {
        console.log("[testSuiteStarted name='{0}']".format(suiteName));
    };

    /* QUnit.testStart({ name }) */
    QUnit.testStart = function (args) {
        if (!hasBegun) {
            qunitBegin();
            hasBegun = true;
        }
        currentTestName = args.name;
    };

    QUnit.moduleStart = function (args) {
        console.log("Module started: {0}".format(args.name));
    };

    /* QUnit.log({ result, actual, expected, message }) */
    QUnit.log = function (args) {

        var currentAssertion = "{0} > {1}".format(currentTestName, args.message);

        //console.log("[testStarted name='{0}']".format(currentAssertion));

        if (!args.result) {
            console.log("**[testFailed] type='comparisonFailure' name='{0}' details='expected={1}, actual={2}' expected='{1}' actual='{2}'".format(currentAssertion, args.expected, args.actual));
        }

        console.log("[testFinished] name='{0}'".format(currentAssertion));
    };

    /* QUnit.done({ failed, passed, total, runtime }) */
    QUnit.done = function (args) {
        console.log("[testSuiteFinished name='{0}']".format(suiteName));
    };
} 
```

这基本上与 QUnit 定义的回调挂钩，并将消息发送到由 phantomjs 显示的控制台。QUnit 回调文档可在此处找到：http: [//api.qunitjs.com/category/callbacks/](http://api.qunitjs.com/category/callbacks/)

至于与 TeamCity 挂钩，它可能只是构建步骤定义中的一个设置，用于检查输出中的某个字符串（例如，输出中存在“[testFailed]”表示失败），我已经完成了CruiseControl 并围绕它创建了一个 Nunit 包装器。最后，同样的概念适用，您只需解析 phatomjs 输出以检查是否存在 [testFailed] 或任何指示失败的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T17:46:50.983

除了上面提供的建议外，我建议使用 qunit 提供的新 phantomjs qunit runner：

[https://github.com/jquery/qunit/tree/master/addons/phantomjs](https://github.com/jquery/qunit/tree/master/addons/phantomjs)

如果您有错误的异步测试，请查看我的拉取请求：

[https://github.com/jquery/qunit/pull/415](https://github.com/jquery/qunit/pull/415)

# objective-c - NSWindow 调整大小

> ID：12981823
> 
> 赞同：1
> 
> 时间：2012-10-19T20:16:29.403
> 
> 标签：objective-c, macos, cocoa, resize, nswindow

您好，我想知道是否有人知道您阻止用户为 Cocoa / Mac OS X 应用程序调整窗口大小的方法或方式。

如果这是不可能的，您将如何统一调整窗口大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:19:57.767

Set the min and max sizes to the desired size.

```
CGSize fixedSize = myWindow.frame.size;
[myWindow setMinSize:fixedSize];
[myWindow setMaxSize:fixedSize]; 
```

# bash - 期待与 bash 阅读

> ID：12981831
> 
> 赞同：1
> 
> 时间：2012-10-19T20:16:48.310
> 
> 标签：bash, expect

我试图用来与脚本`expect`交谈`bash`，但我错过了一些东西。我的脚本是：

```
#!/bin/bash
echo -n "foo? "
read
echo $REPLY 
```

我的`expect`脚本是：

```
#!/usr/bin/expect
spawn ./script.sh
expect "foo? "
send "bar\r\n" 
```

但是`bar`当我运行`expect`脚本时我从来没有看到。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:23:58.620

愚蠢的我，我需要添加`interact`到我的`expect`脚本中，以便它可以完成与脚本的“交互”：

```
#!/usr/bin/expect
spawn ./script.sh
expect "foo? "
send "bar\r\n"
interact 
```

问完这个问题两分钟后，我在[这里](http://www.thegeekstuff.com/2010/10/expect-examples/)找到了答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:24:19.960

我不太熟悉`expect`语法，但你值得一试`autoexpect`：

```
autoexpect ./script.sh 
```

它将运行`script.sh`，在您完成运行后，将`script.exp`在当前目录中创建一个期望脚本。

之后，如果您需要调整其中的某些内容，则可以对其进行编辑。

# c - 颠倒循环双端队列 C 的顺序

> ID：12981833
> 
> 赞同：1
> 
> 时间：2012-10-19T20:16:50.927
> 
> 标签：c, linked-list, deque

好的，所以我正在执行一项任务，您必须在 C 中构建一个循环双端队列。我已经实现了所有功能，并且正在测试它们。在“反向”功能之前，一切都很好。

我认为这很容易，您创建一个新链接，将其连接到 Sentinel 的位置。杀死旧哨兵，然后将双端队列的哨兵设置为新链接。

但是，当我运行它时，我得到一个 malloc 错误，并且由于我是 C 新手，我不确定如何调试。

- - - - 错误 - - - -

## prog(10346) malloc: ***对象 0x7faf13c03920 的错误：未分配被释放的指针 在 malloc_error_break 中设置断点以进行调试

代码

```
#include <stdio.h>
#include <stdlib.h>
#include <assert.h>
#include <float.h>
#include "cirListDeque.h"

/* Double Link Struture */
struct DLink {
    TYPE value;/* value of the link */
    struct DLink *next;/* pointer to the next link */
    struct DLink *prev;/* pointer to the previous link */
};

# define TYPE_SENTINEL_VALUE DBL_MAX 

/* ************************************************************************
 Deque ADT based on Circularly-Doubly-Linked List WITH Sentinel
 ************************************************************************ */

struct cirListDeque {
    int size;/* number of links in the deque */
    struct DLink *Sentinel; /* pointer to the sentinel */
};
/* internal functions prototypes */
struct DLink* _createLink (TYPE val);
void _addLinkAfter(struct cirListDeque *q, struct DLink *lnk, struct DLink *newLnk);
void _removeLink(struct cirListDeque *q, struct DLink *lnk);

/* ************************************************************************
    Deque Functions
************************************************************************ */

/* Initialize deque.

    param:  q       pointer to the deque
    pre:    q is not null
    post:   q->backSentinel is allocated and q->size equals zero
*/
void _initCirListDeque (struct cirListDeque *q) 
{
    struct DLink* lnk = (struct DLink*)malloc(sizeof(struct DLink));
    assert(lnk != 0);   //sentinel made
    q->Sentinel = lnk;
    q->Sentinel->next = q->Sentinel->prev = q->Sentinel;
    q->size = 0;
}

/*
 create a new circular list deque
 */
struct cirListDeque *createCirListDeque()
{
    struct cirListDeque* newCL = malloc(sizeof(struct cirListDeque));
    _initCirListDeque(newCL);
    return(newCL);
}

/* Create a link for a value.

    param:  val     the value to create a link for
    pre:    none
    post:   a link to store the value
*/
struct DLink * _createLink (TYPE val)
{
    struct DLink* lnk = (struct DLink*) malloc(sizeof(struct DLink));
    lnk->value = val;
    return(lnk);

}

/* Adds a link after another link

    param:  q       pointer to the deque
    param:  lnk     pointer to the existing link in the deque
    param:  newLnk  pointer to the new link to add after the existing link
    pre:    q is not null
    pre:    lnk and newLnk are not null
    post:   the new link is added into the deque after the existing link
*/
void _addLinkAfter(struct cirListDeque *q, struct DLink *lnk, struct DLink *newLnk)
{
    lnk->next->prev = newLnk;       //right connects to new
    newLnk->next = lnk->next;       //new connect to right
    newLnk->prev = lnk;             //new connect to left
    lnk->next = newLnk;             //left connect to new
    q->size++;
}

/* Adds a link to the back of the deque

    param:  q       pointer to the deque
    param:  val     value for the link to be added
    pre:    q is not null
    post:   a link storing val is added to the back of the deque
*/
void addBackCirListDeque (struct cirListDeque *q, TYPE val) 
{
    struct DLink* lnk = _createLink(val);
    _addLinkAfter(q, q->Sentinel->prev, lnk);
}

/* Adds a link to the front of the deque

    param:  q       pointer to the deque
    param:  val     value for the link to be added
    pre:    q is not null
    post:   a link storing val is added to the front of the deque
*/
void addFrontCirListDeque(struct cirListDeque *q, TYPE val)
{
    struct DLink* lnk = _createLink(val);
    _addLinkAfter(q, q->Sentinel, lnk);
}

/* Get the value of the front of the deque

    param:  q       pointer to the deque
    pre:    q is not null and q is not empty
    post:   none
    ret:    value of the front of the deque
*/
TYPE frontCirListDeque(struct cirListDeque *q) 
{
    return q->Sentinel->next->value;
}

/* Get the value of the back of the deque

    param:  q       pointer to the deque
    pre:    q is not null and q is not empty
    post:   none
    ret:    value of the back of the deque
*/
TYPE backCirListDeque(struct cirListDeque *q)
{
    return q->Sentinel->prev->value;
}

/* Remove a link from the deque

    param:  q       pointer to the deque
    param:  lnk     pointer to the link to be removed
    pre:    q is not null and q is not empty
    post:   the link is removed from the deque
*/
void _removeLink(struct cirListDeque *q, struct DLink *lnk)
{
    //assert(!isEmptyList(lst));
    lnk->next->prev = lnk->prev;    //connect right link to left link
    lnk->prev->next = lnk->next;    //connect left link to right link
    q->size--;
    free(lnk);
}

/* Remove the front of the deque

    param:  q       pointer to the deque
    pre:    q is not null and q is not empty
    post:   the front is removed from the deque
*/
void removeFrontCirListDeque (struct cirListDeque *q) {
    _removeLink(q, q->Sentinel->next);
}

/* Remove the back of the deque

    param:  q       pointer to the deque
    pre:    q is not null and q is not empty
    post:   the back is removed from the deque
*/
void removeBackCirListDeque(struct cirListDeque *q)
{
    _removeLink(q, q->Sentinel->prev);
}

/* De-allocate all links of the deque

    param:  q       pointer to the deque
    pre:    none
    post:   All links (including backSentinel) are de-allocated
*/
void freeCirListDeque(struct cirListDeque *q)
{
    while (q->size > 0){
        removeFrontCirListDeque(q);
    }
    free(q->Sentinel);
}

/* Check whether the deque is empty

    param:  q       pointer to the deque
    pre:    q is not null
    ret:    1 if the deque is empty. Otherwise, 0.
*/
int isEmptyCirListDeque(struct cirListDeque *q) {
    return q->size == 0;
}

/* Print the links in the deque from front to back

    param:  q       pointer to the deque
    pre:    q is not null and q is not empty
    post:   the links in the deque are printed from front to back
*/
void printCirListDeque(struct cirListDeque *q)
{
    struct DLink *current;
    int x = 0;
    assert(!isEmptyCirListDeque(q));

    current = q->Sentinel->next;
    while(current != q->Sentinel){
        printf("value: %f\t", current->value);
        current = current->next;
        x++;
        if (x >= 6){
            printf("\n");
            x = 0;
        }
    }
}

/* Reverse the deque

    param:  q       pointer to the deque
    pre:    q is not null and q is not empty
    post:   the deque is reversed
*/
void reverseCirListDeque(struct cirListDeque *q)
{
    //struct DLink *temp = _createNewLink(0); //try this allocat then assign then move
    struct DLink *newSent = (struct DLink*) malloc(sizeof(struct DLink));
        newSent->next = q->Sentinel->prev;
        newSent->prev = q->Sentinel->next;
        q->Sentinel->next->prev = newSent;
        q->Sentinel->prev->next = newSent;
        free(q->Sentinel);
        q->Sentinel = newSent;

/* A different approach that didn't work.
        temp->next = q->Sentinel->prev;
            q->Sentinel->prev = q->Sentinel->next;
            q->Sentinel->next = temp->next;
            free(temp);*/
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:23:56.030

对于调试 C 程序，**gdb**是最好的。学习如何使用它会对你有很多好处。该文档位于[http://sourceware.org/gdb/current/onlinedocs/gdb/](http://sourceware.org/gdb/current/onlinedocs/gdb/)

如果您真的想要一个 GUI 前端（并且“gdb -tui”是不可接受的），请尝试**ddd**或**insight**。

调试器将帮助您在程序运行时继续前进，并使您能够在每一步检查您的数据结构，以便您可以在第一次损坏时找到我们的数据结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:38:29.957

我的调试方法是添加 printfs。例如，在 malloc 调用后`_initCirListDeque`添加：

```
fprintf(stderr, "dbg malloc sentinel %p\n", (void *)lnk); 
```

在 malloc in 之后添加类似的行`reverseCirListDeque`。

然后在调用 free in 和 之前添加类似的`_removeLink`printf`freeCirListDeque`行`reverseCirListDeque`。

当您运行代码时，您应该在标准错误中看到指针地址被 malloc 和释放。您应该能够查看未能释放的值是否已被释放（我的猜测是这就是正在发生的事情）。

这个词的目的`dbg`是使搜索这些调试 printfs 并在找到错误后将其删除变得容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T22:04:55.190

我在这里回答我自己的问题，但感谢海报，调试技巧使这个答案成为可能。

我的逻辑有缺陷。

我认为如果你颠倒哨兵的方向，你可以颠倒循环列表的顺序。但是，即使您将所有四个链接更改为前哨，周围的链接 prev 和 next 字段也会指向错误的方向。

为了解决这个问题，我使用以下代码创建了一个新的双端队列：

```
 void reverseCirListDeque(struct cirListDeque *q)
{
    struct cirListDeque* newQ = createCirListDeque();
    while(!isEmptyCirListDeque(q)){
        addBackCirListDeque(newQ, backCirListDeque(q));
        removeBackCirListDeque(q);
    }
    q->Sentinel = newQ->Sentinel;
    q->size = newQ->size;
    free(newQ);
} 
```

# c# - 如何使用 OpenXml 或 EPPlus 将图片嵌入到评论中？

> ID：12981835
> 
> 赞同：1
> 
> 时间：2012-10-19T20:16:55.823
> 
> 标签：c#, openxml, openxml-sdk, epplus

我对 OpenXML 很陌生，发现 EPPlus 项目非常有用，但是我需要将评论的背景图像设置为图片。我可以在 Excel 中执行此操作，但是，我没有看到任何为此公开的接口。

以前有没有人在 OpenXML 中这样做过？或者可以为我指出一个好的起点？

谢谢，非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T13:29:05.797

我相信 EPPlus 只允许您设置背景颜色，但不能设置图片。在 OpenXML 中，注释样式（包括背景图像）存储在 VML 文件中。

如果您使用 Open XML SDK，那么它就是 Worksheet 类下的 LegacyDrawing。您必须从 LegacyDrawing 类中获取 ID，然后检索 VmlDrawingPart 类并操作内容。您还必须使用 VmlDrawingPart 的 ImageParts。工作起来有点乱，其实...

为方便起见，您可能需要考虑[SpreadsheetLight](http://spreadsheetlight.com/)。以下是如何进行评论：

```
SLDocument sl = new SLDocument();

SLComment comm = sl.CreateComment();
comm.SetText("There's a picture background.");
comm.Fill.SetPictureFill("julia.png", 0, 0, 0, 0, 0);
sl.InsertComment(2, 2, comm);

sl.SaveAs("CommentBackground.xlsx"); 
```

这将在评论框背景上完全拉伸图片。

免责声明：我写了 SpreadsheetLight。

# vb.net - VB.NET 中的内联 LINQ 注释

> ID：12981843
> 
> 赞同：5
> 
> 时间：2012-10-19T20:17:40.247
> 
> 标签：vb.net, linq

有没有办法在 VB.NET 的 LINQ 中插入内联代码注释？

请参阅下面的第 2 行作为需要内联注释的示例

```
Dim Jobs = (From X In DB.Jobs_Select(SearchStr, RequiresFilter)
    Where X.JobStatusID < 2   -- **** INSERT INLINE COMMENT HERE  ****
    Order By
        X.JobPriorityID Descending,
        If(X.TargetDate, Date.MaxValue),
        X.NeedsLit Descending,
        X.HasOldArtRequests Descending,
        X.HasOldLicRequests Descending
    ) 
```

这在 SQL 代码中是微不足道的，坦率地说，在 SP 变得复杂时非常有用。如果能够在 LINQ to SQL 中执行相同的跨开发人员通信，那就太好了。

# 更新

这是给你的测试条件。

```
 Dim L As New List(Of KeyValuePair(Of Integer, Integer))

 Dim a = (From X In L
            Where X.Key > 5 'test comment
            Order By X.Value) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T20:27:29.927

好的，伙计们，这是官方的答案——在 VB 中是不可能的。[证明](http://connect.microsoft.com/VisualStudio/feedback/details/659633/inline-comments-for-vb-net)。

> 在 VB 中，您不能将内联注释添加到多行 LINQ 语句中，这真的很烦人！

更多信息：

> 坏消息是，这不会是微不足道的实施。当前的 VB 解析器对单行和注释的限制太低了。它需要完全重写 VB 解析器。
> 
> 好消息是我们已经着手进行这样的重写（代号为“Roslyn”——已经有几篇文章和讨论过）。这还有很长的路要走，我们不会在这个阶段就什么/什么时候做出承诺。
> 
> -- Lucian Wischik，VB 语言 PM

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-07T23:58:23.943

VB.NET 14 引入了内联注释（[链接](https://msdn.microsoft.com/en-us/library/we86c8x2.aspx)）的能力。

> 您可以在隐式续行后、初始化表达式内部以及 LINQ 表达式术语之间添加注释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:21:33.430

如果

```
Where X.JobStatusID < 2   ' **** INSERT INLINE COMMENT HERE  **** 
```

不起作用，那么这是不可能的。

# php - PHP preg_replace 反斜杠

> ID：12981848
> 
> 赞同：0
> 
> 时间：2012-10-19T20:18:00.027
> 
> 标签：php, regex

我的字符串中有双反斜杠“\”，需要转换为单反斜杠“\”。我尝试了几种组合，当我使用 echo 或更多反斜杠意外添加到字符串时，最终整个字符串消失了。这个正则表达式让我发疯了……哈哈……

我在其他失败的尝试中尝试了这个：

```
$pattern = '[\\]';
$replacement = '/\/';

?>
<td width="100%">&nbsp;<?php echo preg_replace($pattern, $replacement,$q[$i]);?></td> 
```

如果这是一个愚蠢的问题，我深表歉意，我感谢任何指示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T20:21:10.387

使用`stripslashes()`- 它完全符合您的要求。

```
<td width="100%">&nbsp;<?php echo stripslashes($q[$i]);?></td> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-09T01:55:32.970

使用 preg_replace 将双反斜杠转换为单反斜杠：

```
preg_replace('/\\\\{2}/', '\\', $str) 
```

*   就像 CodeAngry 说的那样，第一个参数中的`\`in 需要转义两次，一次 for `string`，一次 for 。`regex`
*   在第二个参数中，它只为`string`.

说得通？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T20:22:38.340

改用带斜杠。此外，在您的正则表达式中，您正在搜索单个反斜杠并且您的替换不正确。`\\{2}`应该搜索双反斜杠并`\`用单引号替换它们，尽管我还没有测试过。

只是为了进一步解释，该模式`[\\]`匹配由单个反斜杠组成的集合中的任何字符。在 php 中，您还应该用正斜杠分隔正则表达式：`/[\\]/`

您的替换 (没有分隔符)`\`不是匹配单个反斜杠的正则表达式。匹配单个反斜杠的正则表达式是`\\`. 注意转义。这就是说，替换术语需要是一个字符串，而不是一个正则表达式（反向引用除外）。

编辑：Sven 在下面声称 stripslashes 删除了所有反斜杠。这根本不是真的，我将在下面解释原因。

如果一个字符串包含 2 个反斜杠，第一个将被视为转义反斜杠并将被删除。这可以在[http://www.phpfiddle.org/main/code/3yn-2ut](http://www.phpfiddle.org/main/code/3yn-2ut)看到。任何反斜杠本身都保留的事实与 stripslashes 删除所有反斜杠的说法相矛盾。

澄清一下，这个字符串声明是无效的：`$x = "\";`，因为反斜杠转义了第二个引号。此字符串`"\\"`包含**一个**反斜杠。在取消引用此字符串的过程中，此反斜杠将被删除。该`"\\\\"`字符串包含**两个**反斜杠。取消引用时，第一个将被视为转义反斜杠，并将被删除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-21T19:15:30.743

Never use a regular expression if the string you are looking for is constant, as is the case with "Every instance of double backslash".

Use `str_replace()` for this task. It is a very easy function that replaces every occurance of a string with another.

In your case: `str_replace('\\\\', '\\', $var)`.

The double backslash actually translates into four backslashed, because inside any quotes (single or double), a single backslash is the start of an escape sequence for the following character. If you want one literal backslash, you have to write two of them. You want two backslashes, you have to write four of them.

I do not like the suggestion of `stripslashes()`. This will of course "decode" your double backslash into one single backslash. But it will also remove all single backslashes in the whole string. If there were none - fine, otherwise things will fail now.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T20:24:06.453

```
$pattern = '[\\]'; // wrong
$pattern = '[\\\\]'; // right 
```

将 \ 转义为 \\ 并将 \\ 转义为 \\\\ 因为 \\] 表示转义]。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-10-19T20:32:05.007

使用 htmlentities 函数将斜杠转换为 html 实体，然后使用 str_replace 或 preg_match 将它们更改为新实体

# php - 需要基本 MailChimp API 帮助

> ID：12981851
> 
> 赞同：3
> 
> 时间：2012-10-19T20:18:30.373
> 
> 标签：php, api, mailchimp

我正在寻找一些帮助来弄清楚为什么这个基本脚本不适合我。我正在尝试使用[MailChimp API](http://apidocs.mailchimp.com/api/1.3/)让自定义表单将新订阅者添加到列表中。该脚本没有返回任何内容。

我知道我正确使用了 API，因为当我直接在浏览器中键入 url 时，该对象在 MailChimp 中被订阅，这让我觉得 curl 设置不正确。请问有什么想法吗？

```
<?php
$apikey = 'xxx';
$listID = 'yyy';

$email = htmlspecialchars(stripslashes(trim($_POST['EMAIL'])));
$fname = htmlspecialchars(stripslashes(trim($_POST['FNAME'])));
$lname = htmlspecialchars(stripslashes(trim($_POST['LNAME'])));

        if (!empty($_POST['EMAIL_UPDATES'])) {
            $url = sprintf('http://us6.api.mailchimp.com/1.3/?method=listSubscribe&apikey=%s&id=%s&email_address=%s&merge_vars[OPTINIP]=%s&merge_vars[FNAME]=%s&merge_vars[LNAME]=%s&merge_vars[ZIP]=%s&output=json', $apikey, $listID, $email, $_SERVER['REMOTE_ADDR'], $fname, $lname);
            $ch = curl_init($url);
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
            $data = curl_exec($ch);
            curl_close($ch);
            $arr = json_decode($data, true);
            if ($arr == 1) {
                echo 'Check your e-mail and confirm your subscription.';
            } else {
                switch ($arr['code']) {
                    case 214:
                    echo 'You are already subscribed.';
                    break;
                    // check the MailChimp API for more options
                    default:
                    echo 'Unknown error.';
                    break;          
                }
            }
        }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T05:33:08.410

看起来我只是遇到了一些愚蠢的语法错误，并且混淆了 GET 和 POST。现在修好了。如果有人感兴趣，这里是将自定义“更新配置文件”表单与多个 MailChimp 列表（本例中为 2 个列表）同步的代码。如果有人有使代码更高效的建议，那也很好。

```
<?php
$apikey = 'xxx';
$listID1 = 'yyy';
$listID2 = 'zzz';

$email = htmlspecialchars(stripslashes(trim($_POST['EMAIL'])));
$fname = htmlspecialchars(stripslashes(trim($_POST['FNAME'])));
$lname = htmlspecialchars(stripslashes(trim($_POST['LNAME'])));

        $mh = curl_multi_init();

        if ($_POST['EMAILUPDATES'] == 'Yes') {
            $url1 = 'http://us6.api.mailchimp.com/1.3/?method=listSubscribe&apikey='.$apikey.'&id='.$listID1.'&email_address='.$email.'&merge_vars[OPTINIP]='.$_SERVER['REMOTE_ADDR'].'&merge_vars[FNAME]='.$fname.'&merge_vars[LNAME]='.$lname.'&update_existing=true';
            $ch1 = curl_init($url1);
            curl_setopt($ch1, CURLOPT_RETURNTRANSFER, 1);
            curl_multi_add_handle($mh,$ch1);

        }
        else if ($_POST['EMAILUPDATES'] == 'No') {
            $url3 = 'http://us6.api.mailchimp.com/1.3/?method=listUnsubscribe&apikey='.$apikey.'&id='.$listID1.'&email_address='.$email;
            $ch3 = curl_init($url3);
            curl_setopt($ch3, CURLOPT_RETURNTRANSFER, 1);
            curl_multi_add_handle($mh,$ch3);
        }
        if ($_POST['BLOGUPDATES'] == 'Yes') {
            $url2 = 'http://us6.api.mailchimp.com/1.3/?method=listSubscribe&apikey='.$apikey.'&id='.$listID2.'&email_address='.$email.'&merge_vars[OPTINIP]='.$_SERVER['REMOTE_ADDR'].'&merge_vars[FNAME]='.$fname.'&merge_vars[LNAME]='.$lname.'&update_existing=true';
            $ch2 = curl_init($url2);
            curl_setopt($ch2, CURLOPT_RETURNTRANSFER, 1);
            curl_multi_add_handle($mh,$ch2);
        }
        else if ($_POST['BLOGUPDATES'] == 'No') {
            $url4 = 'http://us6.api.mailchimp.com/1.3/?method=listUnsubscribe&apikey='.$apikey.'&id='.$listID2.'&email_address='.$email;
            $ch4 = curl_init($url4);
            curl_setopt($ch4, CURLOPT_RETURNTRANSFER, 1);
            curl_multi_add_handle($mh,$ch4);
        }

        $active = null;
        //execute the handles
        do {
            $mrc = curl_multi_exec($mh, $active);
        } while ($mrc == CURLM_CALL_MULTI_PERFORM);

        while ($active && $mrc == CURLM_OK) {
            if (curl_multi_select($mh) != -1) {
                do {
                    $mrc = curl_multi_exec($mh, $active);
                } while ($mrc == CURLM_CALL_MULTI_PERFORM);
            }
        }
        if ($_POST['EMAILUPDATES'] == 'Yes') {
        curl_multi_remove_handle($mh, $ch1);
        }
        else if ($_POST['EMAILUPDATES'] == 'No') {
        curl_multi_remove_handle($mh, $ch3);
        }
        if ($_POST['BLOGUPDATES'] == 'Yes') {
        curl_multi_remove_handle($mh, $ch2);
        }
        else if ($_POST['BLOGUPDATES'] == 'No') {
        curl_multi_remove_handle($mh, $ch4);
        }
        curl_multi_close($mh);
?> 
```

# jquery - 位置 Div 与身体的关系 - 在父 Div 之外

> ID：12981861
> 
> 赞同：0
> 
> 时间：2012-10-19T20:19:11.613
> 
> 标签：jquery, html, popup, onclick, parent-child

我在弹出 div 时遇到问题。我希望能够相对于主体定位弹出窗口，以便它们不居中。我遇到的问题是它们嵌套在导航 div 中，我只能相对于它定位它们，因为它必须绝对定位，因为我希望它出现在屏幕的中心。

所以我的两个问题是：

*   不能相对于身体定位 Div。
*   当 div 出现时，它们会将导航项推到不合适的位置。

解决方案：

*   找到一种方法让 div 忽略它的当前父 div 并将其自身定位到与 body div 相关的位置。

您可以在下面的 jsFiddle 中找到我的代码，并提前感谢您的帮助。

[http://jsfiddle.net/Uj3R7/5/](http://jsfiddle.net/Uj3R7/5/)

## HTML

```
<div id="menu">

    <div id="name"><a href="" title="">name</a></div>

    <ul id="nav">

        <li><a class="pop-up-link" href="#" title="about">about</a>&nbsp; | &nbsp;
            <div class='about'><a href='#' title="close" class='close'><img src='img/close.png' alt='close' height="20" width="20" /></a>
                <p>content</p>
            </div>
        </li>

        <li><a class="pop-up-link" href="#" title="press">press</a>&nbsp; | &nbsp;
            <div class='press'><a href='#' title="close" class='close'><img src='img/close.png' alt='close' height="20" width="20" /></a>
                <p>content</p>
            </div>
        </li>

        <li><a class="pop-up-link" href="#" title="diary">contact</a>&nbsp; | &nbsp;
            <div class='contact'><a href='#' title="close" class='close'><img src='img/close.png' alt='close' height="20" width="20" /></a>
                <p>content</p>
            </div>
        </li>

        <li><a class="pop-up-link" href="#" title="contact">diary</a>
            <div class='diary'><a href='#' title="close" class='close'><img src='img/close.png' alt='close' height="20" width="20" /></a>
                <p>content</p>

            </div>
        </li>

    </ul>
</div>​ 
```

## CSS

```
body {
    position: relative;
    width: 100%;
    height: 100%;
}

#menu {
    position:fixed;
    overflow: visible;
    width: 400px;
    height: 200px;
    left: 50%;
    top: 50%;
    margin-left: -200px;
    margin-top: -100px;
    text-align: center;
}

#name {
    font-size: 26px;
    line-height: 50px;
    vertical-align: middle;
    border-bottom: 1px solid #000;
}

#nav li{
    font-size: 14px;
    width: 300px;
    line-height: 25px;
    vertical-align: middle;
    display: inline;
}

.close { 
    float: right; 
    position: relative; 
    z-index: 99999; 
    margin: 3px 6px 0; 
}

.about { 
    position: relative; 
    padding: 5px; 
    background: #F7E39A; 
    display:none; 
    width:500px; 
    margin: 0 auto; 
    min-height: 200px; }

.press { 
    position: relative; 
    float: right; 
    top: -200px; 
    right: 500px; 
    padding: 5px; 
    background: #DEA1B7; 
    display:none; 
    width:250px; 
    min-height: 200px; 
}

.contact { 
    position: relative; 
    padding: 5px; 
    background: #6666FA; 
    display:none; 
    width:500px; 
    margin: 0 auto; 
    min-height: 200px; 
}

.diary { 
    position: relative; 
    float: left; 
    top: 0px; 
    padding: 5px; 
    background: none; 
    border: #291DFA 1px solid; 
    display:none; 
    width:100px; 
    min-height: 200px; 
}​ 
```

## jQuery

```
$(function() {

    var height = $(document).height();
    var width = $(document).width();
    var spanHeight = $('.popup').height();
    var spanWidth = 500;

    $('.pop-up-link').click(function() { 

        $(this).next() 
        .css({ "top" :  height/2 - spanHeight/2 }) // Centre Pop Up
        .css({ "left" : width/2 - spanWidth/2 })    
        .fadeIn(500);
    });

    $(".close").click(function () {
        $('.pop-up-link').next().fadeOut(500);
    });
});​ 
```

## 解决方案

我重新编写了代码以允许弹出窗口成为主体标签的子级，以便我可以相对于主体定位它们。我正在使用 SimpleModels 并使用百分比定位 div。

```
jQuery(function ($) {
    $('#menu .about').click(function (e) {
        $('#about-content').modal({position: ["20%","65%"]});
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:45:54.520

为了解决这个任务，我们将关注[CSS 属性 "position"](http://www.w3schools.com/css/css_positioning.asp)。但是，由于我们无法看到您示例中存在的所有 CSS，因此可能存在继承问题。

要相对于父元素的右上角定位多个子元素，必须满足一些条件。

*   父元素的“位置”值不等于“静态”。
*   每个子元素必须具有“绝对”的“位置”值。
*   每个子元素都应该有一个“top”和“left”值（正或负），它描述了它与父元素内标准定位的偏移量。

由于我们试图定位的 <div> 在 <body> 中的深度适中，我不确定我们是否应该尝试定位，因为更改它们之间元素的 CSS 会极大地移动我们的定位。

我个人的建议是将您要在 <body> 中定位的 <div> 重新定位到 DOM 上，以便它们是 <body> 的直接子级。然后，将 <body> 的“位置”设置为可能的“相对”（可能没有必要，因为它是显示的根元素），然后我们可以使用 style="position:absolute; top 定位我们的 <div>： NN; left:NN;"，其中 NN 是某个整数值。这将满足您相对于 <body> 的定位目标。

PS 如果您想相对于页面上的其他位置（例如，中心）进行定位，只需在其中创建一个居中的 1x1 <div> 并设置 style="position:relative;"，然后将定位的元素放置在该位置中。

我认为您会发现 css 定位在您的网页设计工作中是一项巨大的资产，尤其是与诸如[z-index](http://www.w3schools.com/cssref/pr_pos_z-index.asp)之类的样式结合使用时。我希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:33:32.170

我认为这里的问题是如何使用定位。

绝对定位的元素不再是布局流程的一部分。它们在自己的宇宙中作为“层”存在，使用 z-index 堆叠。

相对定位的元素是布局的一部分——因此移动它们可以改变流程。

`position:absolute`- 这会相对于已设置的第一个**父**`position:relative`元素定位元素。如果没有设置父级，则位置将从`BODY`. 把它想象成设置原点——第一个相对定位的父节点成为原点。

如果你想定位一个通用对话框，你通常希望它是 BODY 标签的子标签（如果你想相对于浏览器窗口定位它），或者让它作为你的外部包装的子标签布局（将其定位到布局，例如当您的设计位于屏幕中央时）。

您通常希望避免`position:relative`出于此问题的目的使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:28:54.510

我想这就是你想要的。

[http://jsfiddle.net/LtsJ4/5/](http://jsfiddle.net/LtsJ4/5/)

这些是我所做的更改

*   在所有四个 div 上制作`position`样式元素`absolute`
*   在您的 javascript 代码中更改`document`为`'body'`
*   添加`"px"`到您的 CSS 调用中。

# c# - get的优势 stored procedure architecture in .NET 4+? I am migrating an existing .NET 2.0, SQL Server codebase to a .NET 4.0, SQL Server 2008 environment. The design pattern is that all app calls to the database go th 问问题 问问题 2012-10-19T20:19:22.003 271 次 This question shows research effort; it is useful and clear 3 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I am migrating an existing .NET 2.0, SQL Server codebase to a .NET 4.0, SQL Server 2008 environment. The design pattern is that all app calls to the database go through a stored procedure. So there's a get[object name] stored procedure that needs to be created or altered for most select statements. So the disadvantages of this architecture to me are already evident: inconvenience. What are the advantages of this highly enforced stored procedure design? (now in .NET 4.0 as opposed to using an ORM). AndroidL sending data to my chat server, getting truncated I'm trying to make a simple chat server. It works fine on the iphone, but not all the chats are going through on the android. My idear was to use the http protocol so I can use the standard sfkd on the iphone and android to talk to my server I'm using the URLConnection connection class on the android. When I was tacing the code on my server, I noticed that I was getting the length of the post data sent in the header. I'm not setting any length value on the URLConnection class. I figured since I was not setting the size in the header that is why its not working. I could not find any info about this. code that reads in haeder on my server I have my server code and android code below, public int ReadHeader() { // read in one line int PageId=0; // try{ request = new StringBuffer(1000); System.out.println("get connection reading in header \r"); //InputStream in = new BufferedInputStream( connection.getInputStream() ); StopFlag=false; String out; // the first line shouls have the page out=ReadLine(); int p; p=out.lastIndexOf("stop"); if (p!=-1) PageId=1; p=out.lastIndexOf("enter"); if (p!=-1) PageId=2; p=out.lastIndexOf("add"); if (p!=-1) PageId=3; p=out.lastIndexOf("exit"); if (p!=-1) PageId=4; p=out.lastIndexOf("update"); if (p!=-1) PageId=5; int MessageSize=0; do{ out=ReadLine(); // check for content size // GET SIZR OF DATA SENT if (out.contains("Length")) { System.out.println("found length \r"); int pes=out.indexOf(' '); String Length=out.substring(pes+1); System.out.println("found size"); System.out.println(Length); //MessageSize=(int)Length; MessageSize= Integer.parseInt( Length) ; //MessageSize=36; } } while(out!="finish header" && out!=""); System.out.println("finsih header \r"); ClientMessage=ReadSize(MessageSize); /* } catch(IOException ec) { System.out.println(ec.getMessage()); } */ return PageId; } // CODE ON ANDROID String data = URLEncoder.encode("username", "UTF-8") + "=" + URLEncoder.encode( cGlobals.UserName, "UTF-8"); data += "&" + URLEncoder.encode("comment", "UTF-8") + "=" + URLEncoder.encode( s, "UTF-8"); cGlobals.Message=""; // THIS IS NOT TKING IN ANY INFO ABOUT THE LENGTH OF data URLConnection conn = url.openConnection(); // set timeouts to 5 seconds // conn.setConnectTimeout(1000*5); // conn.setReadTimeout(5*1000); conn.setDoOutput(true); OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream()); wr.write(data); wr.flush(); wr.close(); c#asp.netsql-server-2008stored-procedures 4 3 回答 3 This answer is useful 6 实际上——与流行的看法相反——性能不再是存储过程的优势之一——不再是。正确编写的带有参数的“内联”SQL 查询同样快，由 SQL Server“编译”一次（在首次使用之前），并且与任何存储过程一样长时间地保留在 SQL Server 的过程缓存中。 但是存储过程确实有优势——我想提两个主要的： 保护用户免受基础表的影响。这也意味着：它是您安全系统中的另一层。您的数据库用户不需要访问这些表 - 因此他们也无法通过 Excel 或 Access 或其他一些工具访问这些表来对这些表造成任何影响。仅此一项就可以带来巨大的好处。 第二点是有一层存储过程可以给你的DBA一个优化的地方。作为开发人员，您只调用存储过程 - DBA 可以调整它们，微调它们，使它们运行得更快。只要参数列表和返回结果集保持不变 - 作为前端开发人员，您甚至不会注意到（至少不会以负面的方式！） 于 2012-10-19T20:31:07.147 回答 This answer is useful 3 我对对象的 INSERT/UPDATE/DELETE 采用存储过程的方法，并在应用程序代码中执行 SELECT。优点： 业务逻辑和数据清晰分离 数据安全性更好，因为它是在数据库层控制的。 在业务逻辑中执行 SELECT 是一种折衷方案，如果他们获得数据库登录凭据，任何人都可以读取表数据，但他们无法修改它（假设您正确设置对象级别权限（表只读）），但我不必为 where 条件的每个变体编写一个存储过程。 当您编写自己的数据适配器与 ORM 时，更容易自定义数据操作 ORM 很好，但是 ORM 通常有很多开销，我喜欢我的应用程序为它们运行的 机器创建尽可能少的工作的方法。另外，我确切地知道发生了什么，并且幕后发生的“魔术”更少 缺点： 如果您不使用 ORM，您可以生成大量代码，这意味着需要维护更多。 可以公平地说，编写自己的数据适配器是在重新发明轮子。更多的控制总是要付出代价的 于 2012-10-19T20:42:52.463 回答 This answer is useful -3 存储过程最大的好处是——执行时间。如果你有“繁重”的 SQL 查询，你应该使用 SP。 于 2012-10-19T20:26:02.227 回答 Related 2 python - input() + TypeError: 'dict' 对象不可调用 2 magento - Magento 订单数据存储在哪里？ 1 git - 在git中的分支内创建分支 1 qt-creator - 通过 WLAN 从 Qt Creator 连接到 CODA 调试代理 3 imagemagick - TYPO3 受限用户图像调整 1 macos - 在 NSView 中拖放 3 ajax - 根据 http 接受标头提供内容 - 缓存问题？ 1 mysql - 用新备份替换以前的数据库备份 1 sql - SELECT DISTINCT INTO 语法错误 interbase sql 1 css - id-selector 中带有冒号的所有情况的 CSS Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：12981863
> 
> 赞同：3
> 
> 时间：
> 
> 标签：c#, asp.net, sql-server-2008, stored-procedures

I am migrating an existing .NET 2.0, SQL Server codebase to a .NET 4.0, SQL Server 2008 environment.

The design pattern is that all app calls to the database go through a stored procedure. So there's a `get[object name]` stored procedure that needs to be created or altered for most select statements.

So the disadvantages of this architecture to me are already evident: inconvenience.

What are the advantages of this highly enforced stored procedure design? (now in .NET 4.0 as opposed to using an ORM).

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T20:31:07.147

实际上——与流行的看法相反——性能不再是存储过程的优势之一——不再是。正确编写的带有参数的“内联”SQL 查询同样快，由 SQL Server“编译”一次（在首次使用之前），并且与任何存储过程一样长时间地保留在 SQL Server 的过程缓存中。

但是存储过程确实有优势——我想提两个主要的：

1.  保护用户免受基础表的影响。这也意味着：它是您安全系统中的另一层。您的数据库用户**不需要**访问这些表 - 因此他们也无法通过 Excel 或 Access 或其他一些工具访问这些表来对这些表造成任何影响。仅此一项就可以带来**巨大**的好处。

2.  第二点是有一层存储过程可以给你的DBA一个优化的地方。作为开发人员，您只调用存储过程 - DBA 可以调整它们，微调它们，使它们运行得更快。只要参数列表和返回结果集保持不变 - 作为前端开发人员，您甚至不会注意到（至少不会以负面的方式！）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T20:42:52.463

我对对象的 INSERT/UPDATE/DELETE 采用存储过程的方法，并在应用程序代码中执行 SELECT。优点：

*   业务逻辑和数据清晰分离
*   数据安全性更好，因为它是在数据库层控制的。
*   在业务逻辑中执行 SELECT 是一种折衷方案，如果他们获得数据库登录凭据，任何人都可以读取表数据，但他们无法修改它（假设您正确设置对象级别权限（表只读）），但我不必为 where 条件的每个变体编写一个存储过程。
*   当您编写自己的数据适配器与 ORM 时，更容易自定义数据操作
*   ORM 很好，但是 ORM 通常有很多开销，我喜欢我的应用程序为它们运行的​​机器创建尽可能少的工作的方法。另外，我确切地知道发生了什么，并且幕后发生的“魔术”更少

缺点：

*   如果您不使用 ORM，您可以生成大量代码，这意味着需要维护更多。
*   可以公平地说，编写自己的数据适配器是在重新发明轮子。更多的控制总是要付出代价的

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-10-19T20:26:02.227

存储过程最大的好处是——执行时间。如果你有“繁重”的 SQL 查询，你应该使用 SP。

# android - AndroidL 向我的聊天服务器发送数据，被截断

> ID：12981866
> 
> 赞同：1
> 
> 时间：2012-10-19T20:19:36.617
> 
> 标签：android, android-5.0-lollipop

我正在尝试制作一个简单的聊天服务器。它在 iphone 上运行良好，但并非所有聊天都在 android 上进行。

我的想法是使用 http 协议，这样我就可以使用 iphone 和 android 上的标准 sfkd 与我的服务器通信

我在 android 上使用 URLConnection 连接类。当我在我的服务器上跟踪代码时，我注意到我正在获取标题中发送的帖子数据的长度。我没有在 URLConnection 类上设置任何长度值。我想，因为我没有在标题中设置大小，所以它不起作用。我找不到有关此的任何信息。

在我的服务器上读取 haeder 的代码

我在下面有我的服务器代码和 android 代码，

```
public int ReadHeader()
     {
        // read in one line
         int PageId=0;

    //   try{
            request = new StringBuffer(1000);
            System.out.println("get connection reading in header \r");
            //InputStream in = new BufferedInputStream( connection.getInputStream() );
            StopFlag=false;

            String out;
            // the first line shouls have the page
            out=ReadLine();

            int p;
            p=out.lastIndexOf("stop");
            if (p!=-1)
                PageId=1;
            p=out.lastIndexOf("enter");
            if (p!=-1)
                PageId=2;
            p=out.lastIndexOf("add");
            if (p!=-1)
                PageId=3;
            p=out.lastIndexOf("exit");
            if (p!=-1)
                PageId=4;
            p=out.lastIndexOf("update");
            if (p!=-1)
                PageId=5;

            int MessageSize=0;
            do{
                out=ReadLine();

                // check for content size
                // GET SIZR OF DATA SENT

                if (out.contains("Length"))
                {
                    System.out.println("found length \r");
                    int pes=out.indexOf(' ');
                    String Length=out.substring(pes+1);
                    System.out.println("found size");
                    System.out.println(Length); 
                    //MessageSize=(int)Length;
                    MessageSize= Integer.parseInt( Length) ;
                                      //MessageSize=36;     
                }
            } while(out!="finish header" && out!="");

            System.out.println("finsih header \r"); 
            ClientMessage=ReadSize(MessageSize); 
            /*
         } catch(IOException ec)
            {
                System.out.println(ec.getMessage());    
            }
        */
       return PageId;
     }

// CODE ON ANDROID 
           String data = URLEncoder.encode("username", "UTF-8") + "=" + URLEncoder.encode( cGlobals.UserName, "UTF-8"); data += "&" + URLEncoder.encode("comment", "UTF-8") + "=" + URLEncoder.encode( s, "UTF-8");
                           cGlobals.Message=""; // THIS IS NOT TKING IN ANY INFO ABOUT THE LENGTH OF data                           URLConnection conn = url.openConnection();
                           // set timeouts to 5 seconds
           //              conn.setConnectTimeout(1000*5);
           //              conn.setReadTimeout(5*1000);
                           conn.setDoOutput(true);

                           OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());

                      wr.write(data);
                       wr.flush();
                       wr.close(); 
```

# c++ - Error when declaring QStringList

> ID：12981868
> 
> 赞同：3
> 
> 时间：2012-10-19T20:19:39.640
> 
> 标签：c++, qt, qstring

I have a public function:

```
void determineAction(QStringList tempL); // in header file

void CompArch::determineAction(QStringList tempL)
{

}

//in cpp file 
```

I get the error:

```
CompArch.cpp:127:6: error: ‘tempL’ has incomplete type
/usr/include/qt4/QtCore/qstring.h:77:7: error: forward declaration of ‘struct QStringList’ 
```

any ideas why this might be.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T20:20:39.233

add `#include <QStringList>` to the top of your .cpp file. Incomplete type means that your class (QStringList) has already been named before, using [foward declaration](http://en.wikipedia.org/wiki/Forward_declaration), but the content of it has not been declared.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:23:08.213

不完整类型意味着编译器已经将 QStringList 视为类，但没有看到 QStringList 类头的主体。看起来您必须包含一个包含 QStringList 的类标题主体的标题。

# xcode - Edit button for tableview

> ID：12981872
> 
> 赞同：0
> 
> 时间：2012-10-19T20:19:49.513
> 
> 标签：xcode, arrays, button, tableview, edit

Can anyone offer assistance with adding a delete button to a tableview in xcode? I can create the button but cannot get it to delete anything in the table. I'm using the default code that comes with the Master Detail Application but have changed the content of the table using an NSObject.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T21:48:50.723

这应该是编辑按钮的默认行为。

`self.navigationItem.leftBarButtonItem = self.editButtonItem;`

这将允许您在按下列表后单击并删除列表中的任何项目。

除非我误解了您如何使用表格项目列表。

# android - How does android deal with playing video given its memory constraints?

> ID：12981884
> 
> 赞同：1
> 
> 时间：2012-10-19T20:20:39.230
> 
> 标签：android, memory, video, sd-card

I'm curious if someone can point me to (or just describe) how, given that an Android application has an extremely limited memory space to play with (I think it's around 20 megs), a video player can load and play videos that are an order of magnitude or more larger in size. Is the app loading the video in some sort of chunks?

I ask because I have an app that has some video assets embedded and the app has grown to be about 80 megs and is just a total monster for compiling and debugging (without the assets the app would only be about 2 megs), and I was thinking that I should just remove the assets and have them download on the side and sit on the sdcard, rather than within the apk, but I'm worried that loading them and playing them at run time will bust through the app's memory allotment, and was hoping someone can shed some light on what my options are.

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:10:17.007

他们以可管理的块缓冲视频，是的。即使您的视频大小为 GB，您也不会使用标准视频播放 API 撞到内存墙。您可以使用标准调用`setVideoURI`或`setVideoPath`指向文件，它将从那里处理它。如果`MediaPlayer`您不使用`VideoView`

不过，在 apk 之外下载视频仍然是个好主意。如果我必须为每次增量升级下载一个新的 80MB 文件，我可能会直接卸载。如果您不想自己托管它们，请查看补充 apk 选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:25:33.317

您可以将游戏带入可以绕过此限制的本机层。看看我写的博客[http://jnispot.blogspot.com/2012/10/jnindk-arrays-bitmaps-and-games-oh-my.html](http://jnispot.blogspot.com/2012/10/jnindk-arrays-bitmaps-and-games-oh-my.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:23:00.443

我不知道这是否是视频应用程序所做的，但您实际上可以通过在本机代码中使用 malloc 语句将内存增加到超出正常限制。这绕过了大约 20 MB 的正常最大值。

我只将它用于在处理大型加密文件（甚至大约 10MB 文件）时 AES 加密需要相当多内存的 android 设备上进行加密。

# python - lambda 中的条件

> ID：12981889
> 
> 赞同：1
> 
> 时间：2012-10-19T20:21:19.433
> 
> 标签：python, lambda

我尝试使用 map 调用的 lambda 函数初始化一个数组，令我惊讶的是，`IF-ELSE`它在 lambda 内部无效。

```
a = map( (lambda x: if (len(aDict[x])==m): return aDict[x] else: return false),
         aDict.keys()) 
```

这是我得到的错误

```
File "objects.py", line 63
a = map( (lambda x: if (len(aDict[x])==m): return aDict[x] else: return false),
                     ^
SyntaxError: invalid syntax 
```

这不起作用的原因是什么？

* * *

编辑：

现在我发现了有趣的替代表达

```
>>> False and 'one' or 'two'
'two'
>>> True and 'one' or 'two'
'one' 
```

非常有趣...这是单行表达式，这就是它工作的原因

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T20:22:37.377

您不能在 lambda 中使用该语法，也不能显式返回。试试这个：

```
lambda x, m: aDict[x] if (len(aDict[x])==m) else False 
```

Lambda 函数隐式返回通过评估其中的代码产生的值。不过，代码必须可以表示为单个复合表达式（也称为单行）。

# mysql - 使用 xml 缓存/读取数据而不是从 MySQL 数据库读取数据是个好主意吗？

> ID：12981893
> 
> 赞同：0
> 
> 时间：2012-10-19T20:21:32.080
> 
> 标签：mysql, xml, performance, caching

我运行自己的博客系统已经有一段时间了，我注意到对于大多数页面，每次访问页面时都需要执行几个（5-10）个相同的数据库查询。

现在我正在考虑将数据缓存到 xml 文件中。这是我这样做的计划：

--- 发布/编辑博客时，将数据插入/更新到 MySQL 数据库，并生成 xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
    <id>32</id>
    <title>caching data with xml</title>
    <date>2012-10-01</date>
    <content><![CDATA[<p>blah...blah...blah...</p>]]></content>
</data> 
```

--- 当页面被访问时，首先检查文件是否存在（以防万一），然后解析 xml 文件和格式/输出数据。

```
if(file_exists("path/to/blog/32.xml")) {
    $data = simplexml_load_file("path/to/blog/32.xml");
    echo '<h2'>.$data->title.'</h2>';
    echo '<p'>.$data->date.'</p>';
    echo $data->content;
}
else {
    mysql_query(...);
} 
```

通过这样做，MySQL 可以做更少的工作，但我不太确定这是否会在以后引起任何问题，例如 100 或 300 个访问者同时访问同一个页面。PHP可以处理吗？我用这种方法做对了吗？

提前感谢您提供任何信息和提示。

顺便说一句，我还没有考虑使用这些模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:38:53.380

一般来说，如果可能的话，谈论缓存总是个好主意，我想你的 xml 解决方案不会引起太多的性能问题。但是您可以考虑改用[Memcache](http://www.php.net/manual/en/memcache.examples-overview.php)（这可能更方便）。

如果您出于某种原因不想使用 Memcache 而是使用 XML 缓存，并且您不确定它是否会损害或提高性能，您可以简单地对 SQL 查询和缓存解决方案进行基准测试，然后进行比较。

然而，在我看来，这听起来像是过早的优化。您的博客真的同时获得 300 名访问者还是一些虚构的案例？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T08:19:07.600

[明天](http://wiki.gigaspaces.com/wiki/display/RN/GigaSpaces+XAP+9.1.X+Release+Notes)应该发布的[XAP](http://www.gigaspaces.com/xap-high-scalability-high-availability) 9.1 就包含了这个功能。

我们意识到需要缓存 XML 数据并使用 XPath 对其进行查询，因此我们添加了一个新的原生 XML API。

[免责声明我在 GigaSpaces 工作]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:36:22.890

我相信memcached可以自动做这样的事情，我会尝试重用已经存在的东西而不是重新发明轮子..

# javascript - 将在另一个文本框下方添加文本框的按钮？

> ID：12981901
> 
> 赞同：-6
> 
> 时间：2012-10-19T20:22:18.277
> 
> 标签：javascript, html

我的表单代码

```
<form>
<table>
 <tr>
   <td>Artist/s:</td>
   <td><input type="text" name="artists"><input type="button" value="add"></td>
 </tr>
</table>
</form> 
```

如何通过单击添加按钮在我的第一个文本框下方或之后添加另一个文本框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:25:11.227

[jsfiddle](http://jsfiddle.net/ereWW/)

```
<script>
window.onload = function(){
    var btn = document.getElementById('btnId');
    btn.onclick = function(){
        var txt = document.createElement("textarea"); 
        btn.parentNode.insertBefore(txt, btn);
    };
};
</script> 
```

# php - 适用于 PHP 的 AWS Elastic Beanstalk 通过 CLI 上传 ZIP 应用程序

> ID：12981904
> 
> 赞同：4
> 
> 时间：2012-10-19T20:22:28.747
> 
> 标签：php, amazon-web-services, amazon-elastic-beanstalk

我想知道是否可以通过 CLI 将我的整个应用程序的 zip 文件上传到 Elastic Beanstalk？目前我正在使用 git aws.push，但问题是我的应用程序具有我需要在部署后安装的供应商依赖项。如果我可以直接从 CLI 上传一个 zip，我可以让我的 jenkins 构建服务器安装所有供应商，压缩整个应用程序然后上传到 EBS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T05:22:13.553

您已将此标记为“Elastic Beanstalk”，因此我假设您正在尝试将您的应用程序推送到 S3，而不是 EBS。应用程序版本存储在 S3 存储桶中，然后 Beanstalk 部署脚本将 .zip 从存储桶下载到 EBS 卷，将其提取到 中`/tmp`，然后将代码复制到`/var/www/html`. 您实际上从未将任何内容直接上传到 EBS 卷（嗯，我的意思是，您不应该）。

如果您的依赖项是 PHP 库，只需将它们包含在您的应用程序源包中。但是，如果您的依赖项包括安装在其他位置的文件`/var/www/html`（如 Apache 模块或其他二进制文件），那么不，您不能（轻松）在部署期间使用 Elastic Beanstalk 和 PHP 执行此操作。您必须通过 SSH 进入，安装您的依赖项，“刻录”实例的自定义 AMI，然后在您的 Beanstalk 环境配置中指定该自定义 AMI。

这有点难看，因为您现在有责任维护此自定义 AMI，而使用 Amazon 提供的库存图像意味着您可以依靠它们定期发布带有安全修复程序的新版本等。请记住，尽管AWS 产品开发团队以惊人的速度行动。就在几周前，Beanstalk 团队[引入了类似 Puppet 的配置脚本](http://aws.amazon.com/about-aws/whats-new/2012/10/02/introducing-aws-elastic-beanstalk-configuration-files/)来进行配置。这可能正是您所需要的，但不幸的是它只支持 Java 和 Python 环境。不过，我希望他们很快就会发布 PHP 支持，所以请密切关注。

# ruby-on-rails - Rails 项目中的公用文件夹权限

> ID：12981912
> 
> 赞同：3
> 
> 时间：2012-10-19T20:22:54.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在我的 Rails 项目中，我注意到当我将一些文件放入我的`public`文件夹时，例如`.html, .pdf, .jpg`，它们可以通过浏览器打开。但是当我放置其他文件时，例如`.txt`没有文件类型的文件，权限被拒绝。

```
Forbidden

You don't have permission to access /blog/public/test.txt on this server. 
```

这个权限在哪里控制？

实际上，有趣的是`robots.txt`，Rails 项目设置时自动生成的文件**可以**访问！但是`test.txt`，我创建的，无法访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T05:59:03.017

我猜这是资产管道，它只允许 html、css 和 js 文件......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T11:41:01.073

尝试重新启动服务器，看看它是否有效。它通常像微风一样在 rails 3 中工作，但您可能使用的是旧版本的 rails。

# java - 通过引用传递和递归

> ID：12981916
> 
> 赞同：5
> 
> 时间：2012-10-19T20:23:23.440
> 
> 标签：java, methods, parameters, parameter-passing

我有以下递归函数原型：

```
public void calcSim(Type<String> fort, Integer metric)
   Integer metric = 0;
   calcSim(fort, metric);
   System.out.println("metric: " + metric);
} 
```

我想打印指标的值，如上所示。但是，它始终为零。现在，当我在函数末尾打印时，我确实得到了一个有效的数字。

1.  如何通过引用传递或获得 C++ 中的等效功能
2.  关于参数传递，我能做些什么？（按价值，按参考等...）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T20:27:36.997

Java中没有通过引用传递这样的东西，对不起:(

您的选择是为方法提供返回值，或者使用可变包装器并随时设置值。使用 AtmoicInteger 因为它在 JDK 中，所以自己制作一个不担心线程安全的程序当然会稍微快一些。

```
AtomicInteger metric = new AtomicInteger(0);
calcSim(fort, metric);
System.out.println("metric: " + metric.get()); 
```

然后在 calcSim 中设置它`metric.set(int i);`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T20:26:27.273

要获得通过引用传递的行为，您可以创建一个包装类，并在该类中设置值，例如：

```
class MyWrapper {
    int value;
} 
```

然后您可以将 a 传递`MyWrapper`给您的方法并更改值，例如：

```
public void calcSim(Type<String> fort, MyWrapper metric)
   metric.value++;
   System.out.println("metric: " + metric.value);
   calcSim(fort, metric);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T20:24:27.357

`Integer`是包装类。包装类是不可变的。所以，你所期望的不能用`Integer`类型来实现。

您可以围绕原语创建可变包装类并更新对象以实现您想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T20:25:39.840

**两个大问题：**

1.  您也在`metric`方法中使用相同的名称重新定义。程序如何打印任何东西。它应该在编译时抱怨。

2.  **没有明确的退出标准。**你程序（方法）停止了吗？

我想你想要一些东西（伪代码，因为我不知道你在做什么）：

```
 public void calcSim(Type<String> fort, Integer metric)
   if(condtion){
     //print or return
   }else{
      //modify fort or metric so that it exits
      calcSim(fort, metric); //call this with modified value
      System.out.println("metric: " + metric.value);
   }
 } 
```

# sql - 配置 TFS - 高级向导

> ID：12981918
> 
> 赞同：0
> 
> 时间：2012-10-19T20:23:41.230
> 
> 标签：sql, tfs

也许以前有人问过这个问题，但我在这方面找不到很多，所以我会很感激一些帮助。

我们的架构如下： 域上的 Win 7 桌面与 VS 2010。MS Sql server R2 在 Win Server 2008 R2 Ent 上；Win 2003 上的 SharePoint 2007；Win 2008 R2 Ent 上的 SharePoint 2010；Visual Sourcesafe 在另一个单独的 Win Server 2008 R2 Ent 服务器上。在这台服务器上，我刚刚安装了 TFS 并正在运行高级配置向导。

由于我是 TFS 新手，所以我选择的所有选项都是基于直觉和常识，但 Reporting Services 和 SharePoint 不起作用。在我添加我的 sql 服务器名称（并且我已经尝试过 IP 地址和 dns 名称）之后使用报告服务，报告服务器 URL 和报告管理器 URL 都不会被填充。（注意：我需要报告服务做什么？）

所以我选择不使用报告服务，正如我所说，我不知道它有什么好处。

接下来，在 SharePoint 配置中，我想使用安装在单独服务器上的现有 SharePoint 场。测试站点和管理 URL 将引发错误：“无法访问以下站点。......要么......未安装 Team Foundation Server Extensions，要么防火墙......”

我怀疑它不是防火墙，所以是 TFS 扩展。搜索该主题似乎也指向了 TFS 的配置，所以我完全不知所措。

有任何想法吗？

谢谢，

Risho /从智能手机发布，因为雇主屏蔽了这个网站 /

编辑：我正在查看这篇文章[http://msdn.microsoft.com/library/dd631915.aspx](http://msdn.microsoft.com/library/dd631915.aspx "为 SharePoint 产品配置 Team Foundation Server 扩展")但我没有分步解决方案中列出的选项。TFS 管理控制台有这个：顶部撕裂 - 服务器名称，下面是应用程序撕裂，然后是代理服务器，构建配置和日志。扩展应用程序撕裂显示团队项目集合、SharePoint Web 应用程序、报告和实验室管理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:15:06.557

[您必须在要连接到 TFS 的每台 SharePoint 计算机](http://msdn.microsoft.com/en-us/library/ee462861%28v=vs.100%29.aspx#TFSExtensions)上配置 SharePoint 扩展。在任何一台 SharePoint 机器上安装 TFS（或两者，如果您打算同时使用这两种机器）。在配置向导中，您应该可以选择配置 SharePoint 扩展。完成后，您应该能够在应用程序层计算机上的高级向导中重新运行就绪检查。

# iphone - 有什么方法可以在不获取白色背景的情况下更新 UIWebView？

> ID：12981920
> 
> 赞同：3
> 
> 时间：2012-10-19T20:23:53.660
> 
> 标签：iphone, ios, uiwebview

我有一个`UIWebView`并且我想不时更新它的内容。但是当我更新一个内容时，我在加载数据时得到了白色背景（数据包括 html，里面有很少的**JavaScript**）。有什么办法可以毫不拖延地做到吗？

我想到了下一个解决方案：我有 2 个 webView（webView 和 backgroundWebView）。当我需要更新 webView 时，我只需向 backgroundWebView 发出请求，等待数据加载并用 backgrounWebView 的内容替换 webView。但我没有找到任何解决方案如何替换它的内容

有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T12:58:52.883

尝试这个...

最初在**viewWillAppear**中使**UIWebView**隐藏，然后使用 webview 委托方法作为**webViewDidFinishLoad**。在这个 webview 委托方法中，让你的**UIWebView**可见。

**例如**

```
-(void)viewWillAppear:(BOOL)animated
{
  webView.hidden=YES;
}

-(void)webViewDidFinishLoad:(UIWebView *)webView
{
  webView.hidden=NO;
} 
```

您还可以在**UIWebView**后面使用带有任何颜色的 UIView 或**UIImageView**。所以当你的**UIWebview**正在加载时，它会隐藏起来，你会在**UIView**或**UIImageview后面看到它**

 ******* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T21:17:15.247

您可以将 dummy`UIView`作为占位符并放入与 相同大小的`UIWebView`内部，并在需要时使用/替换。`UIView``UIView``UIWebView``removeFromSuperview``addSubView`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T13:06:49.373

我认为你在正确的轨道上拥有 2 个 UIWebViews，但不要尝试将背景视图的 HTML 内容传递给前景视图，你应该等待第二个 webview 完成加载，然后将其移动到顶部第一个 Web 视图与`bringToFront:`.******

# playorm - 如何在本地 maven 存储库中安装 playORM？

> ID：12981930
> 
> 赞同：0
> 
> 时间：2012-10-19T20:24:20.770
> 
> 标签：playorm

我克隆了最后一个官方存储库版本并尝试运行：./build publish

在我的 ubuntu 中。但是，我得到了以下错误。我有一个 maven 项目，我需要向 playORM 添加一个依赖项，但我不知道该怎么做。

```
checkstyle:
     [echo] MAX CHECKSTYLE ERRORS ALLOWED=0
[checkstyle] Running Checkstyle 4.1 on 276 files

all:

publish:
[ivy:publish] :: delivering :: alvazan#orm;working@mvalle-POS-EIH61CE :: 20121019172025 :: integration :: Fri Oct 19 17:20:25 BRT 2012
[ivy:publish]   delivering ivy file to /tmp/playorm/input/libinclude/ivy.xml
[ivy:publish] :: publishing :: alvazan#orm

BUILD FAILED
/tmp/playorm/bldfiles/build.xml:55: impossible to publish artifacts for alvazan#orm;working@mvalle-POS-EIH61CE: java.lang.IllegalArgumentException: unknown resolver local
    at org.apache.ivy.core.publish.PublishEngine.publish(PublishEngine.java:168)
    at org.apache.ivy.Ivy.publish(Ivy.java:611)
    at org.apache.ivy.ant.IvyPublish.doExecute(IvyPublish.java:311)
    at org.apache.ivy.ant.IvyTask.execute(IvyTask.java:277)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:392)
    at org.apache.tools.ant.Target.performTasks(Target.java:413)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.Main.runBuild(Main.java:811)
    at org.apache.tools.ant.Main.startAnt(Main.java:217)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)

Total time: 1 minute 49 seconds 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:18:41.377

您不应该运行发布目标。创建它是为了让我们可以发布到开源 nexus 存储库，这样每个人都可以依赖正式发布的版本。

也就是说，您是否还希望能够发布到本地存储库。我们可能会创建一个新的通用目标，您必须为主机、路径、用户名、密码、版本等提供参数，尽管我们的意图是用户只依赖于全局 maven 存储库中发布的版本。

# grails - Grails - 控制器和与后端的紧密耦合

> ID：12981934
> 
> 赞同：0
> 
> 时间：2012-10-19T20:24:49.170
> 
> 标签：grails

当您在 grails 中生成控制器时，控制器直接调用域层上的方法 - 我很不明白这一点，我的每一点都在告诉我这是一种错误，因为您将后端与前端紧密耦合。我认为这属于服务层。

由于在服务层中为域对象上定义的所有方法创建一组等效的方法会非常难看，因此我创建了它`AbstractService`以将所有（缺失的）方法调用从服务层委托给域层：

```
abstract class AbstractService {
    def entityType

    /**
     * By default, this method takes the name of the service that extends this
     * class, removes the suffix 'Service' and tries to create the Class object
     * from the resulting name. Override at will.
     */
    protected Class getEntityType() {
        if (!entityType) {
            try {
                entityType = Class.forName(this.class.name[0..-8], false, Thread.currentThread().contextClassLoader)
            } catch (ClassNotFoundException e) {
                throw new ClassNotFoundException("Class ${this.class.name[0..-8]} could not be found. Please "
                                + "override AbstractService#getEntityType() for ${this.class}.")
            }
        }
        entityType
    }

    def methodMissing(String name, args) {
        try {
            if (getEntityType()?.metaClass?.getStaticMetaMethod(name)) {
                getEntityType().invokeMethod(name, args)
            } else if (args?.last()?.metaClass?.getMetaMethod(name)) {
                args.last().invokeMethod(name, args.take(args.size() - 1))
            } else {
                throw new MissingMethodException(name, this.class, args)
            }
        } catch (MissingMethodException e) {
            throw new MissingMethodException(name, this.class, args)
        }
    }
} 
```

然后我只是扩展此服务，例如：

```
class UserService extends AbstractService {
} 
```

然后我的控制器可以看起来像这样：

```
class UserController {
    def userService

    def create() {
        userService.save(new User(params))
    }

    def list() {
        userService.list(params)
    }

    // et cetera...
} 
```

你不觉得这样更好吗？多亏了依赖注入，我可以重写整个业务层，而无需更改控制器中的代码——这就是我们使用依赖注入的原因，不是吗？

感谢您的回答，我想听到尽可能多的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T21:01:10.230

该模型在 Java Web 应用程序和所有应用程序中非常常用。Rails（以及遵循它的 Grails）社区只是试图打破这里的范式，让它变得更简单。我的意思是，如果这个实体可以简单地完成这项工作，你为什么要委托一个服务类来操纵一个实体？如果实体做这项工作是自然的，那么不要让其他人来做。这样，您就可以避免[贫血模型](http://martinfowler.com/bliki/AnemicDomainModel.html)，因为您的对象不仅是数据持有者，而且他们还知道如何运营自己的业务。

话虽如此，有时您最好使用服务类对您的实体进行操作。例如，如果它同时涉及不同类型的实体等等......所以，当它不是“自然的”（并且你必须强制使其工作）时，实体本身来处理操作，那么服务类就是要走的路。[这篇](http://blog.carbonfive.com/2012/01/10/does-my-rails-app-need-a-service-layer/)基于 Rails 的文章给出了一些关于使用服务类的技巧。

而且您并没有将控制器与模型紧密耦合（您说的是后端和前端，但我想这就是您的意思）。控制器最终将需要使用模型，无论是实体本身还是操作它的服务类（也是模型）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T18:08:37.813

脚手架控制器代码并不能真正代表理想的应用程序架构。请记住，生成的脚手架代码只是生成应用程序的 CRUD 部分的起点。

您是对的，一般来说，您不想将大部分 GORM 查询放在控制器中，因为控制器应该用于与前端交互。您当然可以将查询/业务逻辑放入服务中，也可以将查询直接放入域类中。这就是 Grails 服务支持声明式事务处理的原因。

# tsql - 单步执行 2 个临时表与表比较

> ID：12981945
> 
> 赞同：0
> 
> 时间：2012-10-19T20:25:41.737
> 
> 标签：tsql, select, sql-like

我有一个 SP，它应该将从一个函数生成的 2 个临时表与另一个表进行比较。我的问题是，它不是逐步遍历每个临时表，而是同时遍历两个临时表。我不确定如何编写代码来一次遍历每个表以获得所需的结果。

```
 DROP PROCEDURE uspJudgments;
GO
CREATE PROCEDURE uspJudgments 
@fullName varchar(100), @fullName1 varchar(100)
AS
BEGIN

SELECT *
INTO #tmpFullname
FROM dbo.DelimitedSplit8K(@fullName, ',')

SELECT *
INTO #tmpFullname1
FROM dbo.DelimitedSplit8K(@fullName1, ',')

SELECT *
FROM #tmpFullName

SELECT *
FROM #tmpFullName1

DECLARE @MaxRownum int
SET @MaxRownum = (SELECT MAX(ItemNumber) FROM #tmpFullname)

DECLARE @Iter int
SET @Iter = (SELECT MIN(ItemNumber) FROM #tmpFullname)

DECLARE @MaxRownum1 int
SET @MaxRownum1 = (SELECT MAX(ItemNumber) FROM #tmpFullname1)

DECLARE @Iter1 int
SET @Iter1 = (SELECT MIN(ItemNumber) FROM #tmpFullname1)

DECLARE @Name varchar(25)
DECLARE @Name1 varchar(25)

WHILE @Iter <= @MaxRownum AND @iter1 <= @Maxrownum1

BEGIN

    SET @Name = (SELECT Item FROM #tmpFullname WHERE ItemNumber = @Iter)   
    SET @Name1 = (SELECT Item FROM #tmpFullname1 WHERE ItemNumber = @Iter1)   
    SELECT *
    --INTO #tmpDefSelect
    FROM defendants_ALL 
    WHERE combined_name LIKE '%' + @Name + '%' AND combined_name LIKE '%' + @Name1 + '%';

    SET @Iter = @Iter + 1
    SET @Iter1 = @Iter1 + 1
END

END

DROP TABLE #tmpFullname
DROP TABLE #tmpFullname1

EXEC uspJudgments @fullName = 'grein,smit', @fullName1 = 'joh,jon,j.' 
```

我需要得到 grein 的所有结果——joh、jon、j。和 smit, joh, jon, j。

目前，上述代码仅返回 grein joh AND smit, jon.. 在我们的数据库中，第一个组合没有返回任何结果，而 jonathon smith 和 jon smith 则返回 38 个结果。如何正确遍历每个临时表以获得所需的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T02:33:41.473

您只能得到这两种组合`grein joh`，并且`smith jon`由于您迭代`@Iter`和的方式`@iter1`。您同时增加它们两个。你需要一个像这样的嵌套循环：

```
declare @start_val integer = @iter1

while @Iter <= MaxRownum
begin

  set @iter1 = @start_val

  while @iter1 <= @Maxrownum1
  begin

    set @Name = ...
    set @Name1 = ...

    ...

    set @iter1 = @iter1 + 1
  end

  set @Iter = @Iter + 1
end 
```

但我认为你甚至不需要`WHILE`循环：

```
select d.*
from   defendants_ALL, #tmpFullname t1, #tmpFullname1 t2
where  d.combined_name = t1.Item + ' ' + t2.Item 
```

或者（如果您仍然需要使用`LIKE`）：

```
select d.*
from   defendants_ALL, #tmpFullname t1, #tmpFullname1 t2
where  d.combined_name like '%' + t1.Item + '%'
  and  d.combined_name like '%' + t2.Item + '%' 
```

（所有 SQL 都未经测试...）

# php - 使用 .htaccess 重定向 URL

> ID：12981947
> 
> 赞同：1
> 
> 时间：2012-10-19T20:25:47.200
> 
> 标签：php, html, wordpress, .htaccess

我有一个 WordPress 网站，一些链接检查器插件以相同的方式报告所有断开的链接。看看：

```
http://www.esmedicare.com/category/blog/page/2/locations.html ( parent page: http://www.esmedicare.com/category/blog/page/2/ )
http://www.esmedicare.com/hello-world/locations.html ( parent page: http://www.esmedicare.com/hello-world/ )
http://www.esmedicare.com/neonatal-care-2/locations.html ( parent page: http://www.esmedicare.com/neonatal-care-2/ )
http://www.esmedicare.com/dental-center/locations.html ( parent page: http://www.esmedicare.com/dental-center/ 
```

我只想将所有这些页面重定向到括号中显示的父页面，但我不知道该怎么做。

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:32:57.913

尝试在文档根目录的 htaccess 文件中添加这些规则，在任何 wordpress 规则之上：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)/locations.html$ /$1/ [L,R=301] 
```

# php - 防止在 PHP 中重复执行代码

> ID：12981950
> 
> 赞同：0
> 
> 时间：2012-10-19T20:26:05.793
> 
> 标签：php, redirect, post, shopping-cart

我有一个这样的商店：

1.  ^(用户在第一)页将东西添加到他的购物车
2.  用户提交购物车（*POST*），所有发布数据都存储在会话中。
3.  用户在^(第二)页填写表格，再次点击提交（第二个*POST*）
4.  用户进入“谢谢”页面（第 3^次），该页面获取所有会话数据，并以*POST*形式发送数据并将其发送出去。

问题是，简单的刷新会导致每封电子邮件发送一个空表。我怎样才能防止这种情况？我可以在执行邮件功能后以某种方式重定向吗？所以感谢页面在刷新时没有做任何事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:34:40.787

您可以像这样调用[PHP`header()`函数](http://php.net/header)：

```
header('Location: thankyou.php');
exit; 
```

用户将被重定向到感谢页面，并且在那里重新加载不会再次执行您的代码。

# iphone - 使用 Storyboard 对视图控制器进行自定义初始化

> ID：12981953
> 
> 赞同：2
> 
> 时间：2012-10-19T20:26:20.960
> 
> 标签：iphone, uiviewcontroller, storyboard, uitableview

我是故事板的新手，我在自定义初始化方面遇到了问题。

在使用情节提要之前，我曾经这样做是从具有自定义初始化的表中推送视图控制器：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    //Creating Dummy Hotel
    HotelItem *hotel = [[HotelItem alloc] init];

    HotelDetailViewController *controller = [HotelDetailViewController controllerWithHotel:hotel];
    controller.hidesBottomBarWhenPushed = YES;
    [self.navigationController pushViewController:controller animated:YES];

    [hotel release];
} 
```

现在有了故事板，我使用的是 prepareForSegue 而不是 didSelectRowAtIndexPath 变成了这样：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{

    //Creating Dummy Hotel
    HotelItem *hotel = [[HotelItem alloc] init];
    hotel.name = @"Hotelucho";

    // Make sure we're referring to the correct segue
    if ([[segue identifier] isEqualToString:@"ShowSelectedHotel"]) {

        HotelDetailViewController *controller = [segue destinationViewController];

    }
} 
```

我知道我可以更改我的私有变量“hotel”并在 [segue destinationViewController] 之后设置属性，但我发现调用我的自定义 init 方法更有用。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T23:39:14.563

如果您在初始化后需要执行大量代码，则可能需要为其创建一个单独的方法，然后在`initWithCoder:`and中调用该方法`initWithFrame:`。

Check this answer for more info: [Objective C - Custom view and implementing init method?](https://stackoverflow.com/questions/7226239/objective-c-custom-view-and-implementing-init-method)

# java - Java ServerSocket 连接限制？

> ID：12981957
> 
> 赞同：13
> 
> 时间：2012-10-19T20:26:35.407
> 
> 标签：java, sockets, connection, serversocket

我正在使用套接字运行一些测试，并且遇到了一些奇怪的行为：服务器套接字将在第 50 个客户端套接字连接到它之后拒绝连接，即使该客户端套接字在下一个打开之前关闭，即使延迟是在连接之间添加。

以下程序是我的实验代码，它在当前状态下不会抛出异常并正常终止。但是，如果数组大小`Socket[] clients`增加到超过 50，则在第 50 个连接之后尝试连接的任何客户端套接字都会被服务器套接字拒绝。

问题：**为什么服务器套接字拒绝套接字连接的计数为 50？**

```
public static void main(String[] args) {
    try (ServerSocket server = new ServerSocket(2123)) {
        Socket[] clients = new Socket[50];
        for (int i = 0; i < clients.length; i++) {
            clients[i] = new Socket("localhost", 2123);
            System.out.printf("Client %2d: " + clients[i] + "%n", i);
            clients[i].close();
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

我已经运行了测试，其中另外 50 个套接字连接到另一个本地服务器，并且打开和关闭 100 个套接字没有发生问题，所以我推断它的服务器套接字拒绝连接，而不是打开客户端套接字的一些限制，但是我一直无法发现为什么服务器套接字限制为 50 个连接，即使它们没有同时连接。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-19T20:30:55.287

这一切都在[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/net/ServerSocket.html#ServerSocket(int))中：

> 传入连接指示（连接请求）的最大队列长度设置为 50。如果在队列已满时连接指示到达，则拒绝连接。

显然你`ServerSocket`从不接受任何连接，只是听。您必须调用`accept()`并开始处理连接或增加*积压队列*大小：

```
new ServerSocket(port, 100) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T20:30:28.300

50 是默认值`backlog`

[http://docs.oracle.com/javase/1.4.2/docs/api/java/net/ServerSocket.html#ServerSocket%28int%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/ServerSocket.html#ServerSocket%28int%29)

> 传入连接指示（连接请求）的最大队列长度设置为 50。如果在队列已满时连接指示到达，则拒绝连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T20:57:00.927

根据@TomaszNurkiewicz 的回答，这是一个有效的示例：

```
import java.net.*;
import java.util.concurrent.atomic.AtomicBoolean;

public class SockTest{
public static void main(String[] args) {
    final AtomicBoolean shouldRun = new AtomicBoolean(true);
    try  {
        final ServerSocket server = new ServerSocket(2123);
        Thread serverThread = new Thread(){
           public void run() {
              try {
                 while(shouldRun.get()) {
                 Socket s = server.accept();
                 s.close();
             Thread.sleep(1);
                }
              } catch(Exception ex) {
                ex.printStackTrace();
              }
           }
        };
        serverThread.start();
        Socket[] clients = new Socket[150];
        for (int i = 0; i < clients.length; i++) {
            clients[i] = new Socket("localhost", 2123);
            System.out.printf("Client %2d: " + clients[i] + "%n", i);
            clients[i].close();
        }
        shouldRun.set(false);
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
       shouldRun.set(false);
    }

  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-25T12:23:36.110

你可能会看两件事

1.  服务器不接受连接。
2.  服务器无法同时满足过多的连接。这可能是由于积压增加（超过 50 个）引起的。尝试在再次连接到服务器之前以毫秒为单位给出一些时间间隔。就像增加连接一样。我通过在运行测试负载时给出一些时间间隔来解决它。

# events - 防止在 getter/setter 中执行绑定

> ID：12981960
> 
> 赞同：0
> 
> 时间：2012-10-19T20:26:42.240
> 
> 标签：events, ember.js

在我的 Ember 控制器中，每当配置更改时，我都会使用延迟加载来获取额外的数据。因此，我想延迟绑定的执行，直到加载所有依赖的数据。我认为返回一个 false 值作为 setter 结果将阻止绑定执行，但绑定仍然执行。如何延迟绑定执行直到加载完成？

```
App.ConfigController = Ember.ArrayController.extend({
   currentConfiguration: null,

   configuration: function(key, value){
     if(arguments.length === 1){
         return this.get('currentConfiguration');
     }
     var self = this;
     // load additional data 
        this.loadData(id, function(data){
                            self.set('currentConfiguration', value);
                            return value;
                           })
     }
     return false;
   }.property('currentConfiguration'),

    loadData: function(id, resultHandler, faultHandler){
       var self = this;
       var uri = 'http://foo.com/+id;

       $.getJSON(uri)
        .success(function(data, status, jqXHR){
            resultHandler(data);
        })
        .error(faultHandler);
    },

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T03:45:10.167

无法按照您的意愿阻止绑定执行。我处理这个问题的方法是拥有两个独立的属性；设置一个，并观察它以更新第二个，并绑定到第二个。像这样的东西：

```
App.ConfigController = Ember.ArrayController.extend({
  configuration: null, // <- set this property
  configurationDidChange: function(){
    var self = this;
    // load additional data 
    this.loadData(id, function(data){
                        self.set('configurationData', value);
                       });
  }.observes('configuration'),
  configurationData: null <- bind to this property

  loadData: function(id, resultHandler, faultHandler){
    // ... as you have it 
  }
}); 
```

# php - 建立评分系统：数据库结构涉及user_id？

> ID：12981969
> 
> 赞同：0
> 
> 时间：2012-10-19T20:27:38.437
> 
> 标签：php, mysql, insert

**描述：**

我正在建立一个评级系统`mysql/php`。我对如何设置数据库感到困惑。

这是我的文章设置：

**文章表：**

```
id | user_id | title | body | date_posted 
```

这是我假设的评分表：

**评分表：**

```
id | article_id | score | ? user_id ? 
```

**问题：**

我不知道我是否应该把它`user_id`放在评级表中。我的计划是使用这样的查询：

```
 SELECT ... WHERE user_id = 1 AND article_id = 10 
```

但我知道它是冗余数据，因为它存储了`user_id`两次。我应该在桌子上找出 a`JOIN`还是结构好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:34:24.927

我认为这种方法没有任何问题。被存储两次的用户 id 并不是特别相关，因为一个与评级条目有关，而另一个与文章所有者有关。

这种方式的好处是您可以通过使 article_id 和 user_id 唯一并使用 replace into 来管理评分来防止为每个用户记录多个分数。

这取决于这个评级系统是否需要智能以防止游戏等，有很多事情需要详细说明。用户群有多大等等。

我敢打赌，对于任何普通人来说，即使是相对大规模的系统，这种设置也不会有害。

...半无关的：

仅供参考，根据此分数的重要性和游戏方面，您可以使用 STDDEV() 来获取平均因素，以考虑分数列上的标准偏差......

```
SELECT STDDEV(`score`) FROM `rating` WHERE `article_id` = {article_id} 
```

假设你关心的是人们是否联合起来写一篇特定的文章，以便在没有正当理由的情况下将其击落或赞扬它，那么这将排除异常值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T20:34:29.510

这取决于。我假设这些文章对个人用户来说是独一无二的？在这种情况下，我可以将 user_id 保留在您的评级表中，然后将您的查询更改为：

```
SELECT ... WHERE article_id = 10 
```

或者

```
SELECT ... WHERE user_id = 1 
```

取决于您要提取的信息。

您不是“存储 user_id 两次”，而是使用 user_id 将文章链接到与另一个表中的用户关联的唯一数据。您正在采取正确的方法，除了在您的查询中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:31:42.080

你不应该，由于第三范式，你需要保持独立性。

“第三范式 (3NF) 是用于数据库规范化的范式。3NF 最初由 EF Codd 在 1971 年定义。[1] Codd 的定义指出，当且仅当以下两个条件都成立时，表才处于 3NF 中：

*   关系 R (table) 是第二范式 (2NF)
*   R 的每个非主属性都非传递地依赖（即直接依赖）R 的每个超键。”

来源：[http ://en.wikipedia.org/wiki/Third_normal_form](http://en.wikipedia.org/wiki/Third_normal_form)

第一范式：[http ://en.wikipedia.org/wiki/First_normal_form](http://en.wikipedia.org/wiki/First_normal_form)

第二范式：[http ://en.wikipedia.org/wiki/Second_normal_form](http://en.wikipedia.org/wiki/Second_normal_form)

你应该看看标准化和 E/R 模型，它会对你有很大帮助。

维基百科中的规范化：[http ://en.wikipedia.org/wiki/Database_normalization](http://en.wikipedia.org/wiki/Database_normalization)

# javascript - 从括号内获取整数

> ID：12981970
> 
> 赞同：1
> 
> 时间：2012-10-19T20:27:39.027
> 
> 标签：javascript, regex

我有一个字符串，我试图在其中获取整数。字符串看起来像：

> `"(2) This is a string"`

我需要抓住它`2`。但它可以是任何数字，所以我尝试了：

```
 var str = "(2) this is a string";
 var patt = /\(\d\)/;

 var num = str.match(patt); 
```

这不会返回正确的答案。我应该对 进行拆分`()`还是有更好的正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T20:30:24.253

```
var str = "(2) this is a string";
var patt = /\((\d)\)/;

var num = str.match(patt)[1]; 
```

2 件事。当您想从匹配的字符串中捕获一个段时，您`()`需要注意这一点。所以我只是把它包`\d`在括号里来捕捉它。

其次，为了访问捕获的段，您必须深入到返回的数组中。该`match`方法将返回一个数组，其中第一项是整个匹配的字符串，第二项是任何匹配的捕获组。因此用于`[1]`获取第一个捕获组（数组中的第二项）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:30:55.837

```
var str = "(2) this is a string";
var patt = /\((\d+)\)/;
alert(str.match(patt)[1]); 
```

这行得通！

*为什么有效。*因为在 (()) 混乱中还有一个捕获，它填充了匹配数组中的 [1] 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:34:06.780

用这个。不管多少括号

```
var str = "(2) this is a string";
var patt = /\(\d\)/;

var num = str.match(patt)[0].replace("(", "").replace(")","") 
```

这应该工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T20:38:25.953

```
 var str = "(2) this is a string";
var a =  /\([\d]*\)/g.exec(str)[0];
 var num =  a.substring(1, a.length-1); 
```

# ocaml - 二叉树广度优先搜索

> ID：12981971
> 
> 赞同：6
> 
> 时间：2012-10-19T20:27:39.490
> 
> 标签：ocaml, binary-tree

我正在使用 OCaml。我有类型：

```
type 'a bt = Empty | Node of 'a * 'a bt * 'a bt;; 
```

我也有示例 BST：

```
let tree = Node(1,Node(2,Node(4,Empty,Empty),Empty),Node(3,Node(5,Empty,Node(6,Empty,Empty)),Empty)); 
```

我需要编写函数：`breadthBT : 'a bt -> 'a list`这将是广度优先搜索遍历。对于上面的示例树，它应该返回`[1; 2; 3; 4; 5; 6]`

这个函数怎么写？我只能编写以下使用**DST**的函数：

```
let rec breadthBT tree =
if tree=Empty then []
else let Node(w,l,r)=tree in (w::breadthBT l)@breadthBT r;; 
```

上面的函数返回（例如树）[1; 2；4；3；5个；6]。但我不能编写使用**BFS**的函数。你可以帮帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T22:27:08.390

它不是一个可编译的解决方案。只是一个提示。您应该从顶级根节点迭代到深层节点。让我们的函数接收答案的累加器和节点列表（您的'a bt 值）作为第二个参数。您可以通过获取三元组的第一个元素来映射此列表，然后收到下一部分答案。您还需要评估下一级树。每个节点最多有两个后代。您可以映射您的列表并申请`_a_function_`接收后代列表。这将是您树的下一个级别。而不是——递归。

A 不会指定这个`_a_function_`。尝试在google中研究什么是concatMap。

快乐黑客！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T09:56:07.563

想象一下，你把鼻子贴在树上。是否可以以广度优先的方式遍历树而不在记事本中添加书签位置？不，因为订单可以让你从一个分支跳到另一个不相关的分支。因此，您需要一个带有“要访问的剩余位置”的记事本。您从记事本中选择下一个剩余位置并盲目地跳到它。由于您从记事本中删除了访问过的位置，因此您处于尚未访问过的节点。并且由于您不访问中间节点就无法爬上树，因此您还没有访问您上方的两个节点。但是你抵制了直接爬树枝的本能——哎呀，这就是*广度*第一个订单。您不想忘记这两个未访问的节点，因此您想将它们放入笔记本中。你把它们放在哪里，笔记本前面还是后面？当然，在背面，否则您会立即选择其中一个，这就是我们想要避免的。瞧：您的记事本是一个 FIFO 节点队列，您将其作为累加器保留（即传递），但也消耗以选择要访问的子树。

# javascript - 卸载提示复选框

> ID：12981976
> 
> 赞同：1
> 
> 时间：2012-10-19T20:27:46.400
> 
> 标签：javascript, css, checkbox, prompt

我正在我的网站上工作，我正在尝试以这种独特的方式在我的页面上保存统计信息。我想知道是否可以为我的页面创建一个卸载提示，例如当我离开我的页面时，提示弹出并为您提供复选框和文本框等选择，完成后它将所有信息发送到文本文件中？有任何想法吗？提前致谢。

* * *

PS：让我再添加一条信息，我不想要任何已经制作的附加组件，就像它是一个商业网站，我想找出例如为什么一个人离开页面，如果你明白我的意义？

# java - 如何将 HSM 加密与 JAVA 集成？

> ID：12981977
> 
> 赞同：14
> 
> 时间：2012-10-19T20:28:00.037
> 
> 标签：java, security, encryption, hsm

如何将硬件安全模块加密与 Java 应用程序集成？我正在寻找代码示例以连接到 HSM、生成密钥（非对称、对称）、加密和解密数据（非对称、对称）并存储密钥。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-19T20:31:09.583

在 JAVA 中，您可以只使用 JCE/JCA。向您的提供者询问实施，您将需要一些 jar 文件，并且您已准备好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-02T09:52:19.203

所有 HSM 都应支持通用 API 接口，例如 PKCS11、JCE 或 MSCAPI。对于 Java 集成，他们还将提供 JCE CSP 提供程序。只需配置提供程序，您就可以正常使用 Keystore/KeyGenerator。

# c# - 创建 HiddenFor IEnumerable 在视图中

> ID：12981979
> 
> 赞同：14
> 
> 时间：2012-10-19T20:28:18.227
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq, entity

我有一个 IEnumerable 属性

```
public IEnumerable<string> ChangesOthersResult { get; set; } 
```

我需要从 ChangesOthersResult 收集所有值并从视图发布回控制器。如何循环遍历 Ienumerable 并创建将绑定回控制器中的 ViewModel 的隐藏字段？

```
foreach(var item in Model.ChangesOthersResult)
   {
       @Html.HiddenFor(x => x.ChangesOthersResult);
   } 
```

给我原始 SQL 语句作为文本。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-10-22T10:06:24.887

我把它变成了一个扩展方法，所以 for 循环不会丑化你的视图代码：

```
public static class HiddenExtensions
{
    public static MvcHtmlString HiddenForEnumerable<TModel, TProperty>(this HtmlHelper<TModel> helper,
        Expression<Func<TModel, IEnumerable<TProperty>>> expression)

    {
        var sb = new StringBuilder();

        var membername = expression.GetMemberName();
        var model = helper.ViewData.Model;
        var list = expression.Compile()(model);

        for (var i = 0; i < list.Count(); i++)
        {
            sb.Append(helper.Hidden(string.Format("{0}[{1}]", membername, i), list.ElementAt(i)));
        }

        return new MvcHtmlString(sb.ToString());
    }
} 
```

GetMemberName 是另一种扩展方法：

```
 public static string GetMemberName<TModel, T>(this Expression<Func<TModel, T>> input)
    {
        if (input == null)
            return null;

        if (input.Body.NodeType != ExpressionType.MemberAccess)
            return null;

        var memberExp = input.Body as MemberExpression;
        return memberExp != null ? memberExp.Member.Name : null;
    } 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-10-19T20:49:03.803

将 ChangesOthersResult 转换为数组并使用 for 循环输出如下内容：

```
for (int i = 0; i < Model.ChangesOthersResult.Length; i++ )    
{
   @Html.Hidden("ChangesOthersResult[" + i + "]", Model.ChangesOthersResult[i])
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-02-05T16:23:14.947

扩展了 @GitteTitter 的自定义对象列表解决方案：

```
@Html.HiddenForEnumerable(x => x.ValueTypes)    
@Html.HiddenForEnumerable(x => x.ViewModels, h=>h.Id, h=>h.Name)
@Html.HiddenForEnumerable(x => x.ViewModels, allPublicProps: true) 
```

资源：

```
/// <summary>
/// Returns hiddens for every IEnumerable item, with it's selected properties, if any memberPropsExpression provided.
/// </summary>
public static MvcHtmlString HiddenForEnumerable<TModel, TModelProperty>(this HtmlHelper<TModel> helper,
    Expression<Func<TModel, IEnumerable<TModelProperty>>> expression, params Expression<Func<TModelProperty, object>>[] memberPropsExpressions)
{
    var sb = new StringBuilder();

    var membername = expression.GetMemberName();
    var model = helper.ViewData.Model;
    var list = expression.Compile()(model);

    var memPropsInfo = memberPropsExpressions.Select(x => new
    {
        MemberPropName = x.GetMemberName(),
        ListItemPropGetter = x.Compile()
    }).ToList();

    for (var i = 0; i < list.Count(); i++)
    {
        var listItem = list.ElementAt(i);
        if (memPropsInfo.Any())
        {
            foreach (var q in memPropsInfo)
            {
                sb.Append(helper.Hidden(string.Format("{0}[{1}].{2}", membername, i, q.MemberPropName), q.ListItemPropGetter(listItem)));
            }
        }
        else
        {
            sb.Append(helper.Hidden(string.Format("{0}[{1}]", membername, i), listItem));
        }
    }

    return new MvcHtmlString(sb.ToString());
}

/// <summary>
/// Returns hiddens for every IEnumerable item, with it's all public writable properties, if allPublicProps set to true.
/// </summary>
public static MvcHtmlString HiddenForEnumerable<TModel, TModelProperty>(this HtmlHelper<TModel> helper,
   Expression<Func<TModel, IEnumerable<TModelProperty>>> expression, bool allPublicProps)
{
    if (!allPublicProps)
        return HiddenForEnumerable(helper, expression);

    var sb = new StringBuilder();

    var membername = expression.GetMemberName();
    var model = helper.ViewData.Model;
    var list = expression.Compile()(model);

    var type = typeof(TModelProperty);
    var memPropsInfo = type.GetProperties(BindingFlags.Public | BindingFlags.Instance)
        .Where(x => x.GetSetMethod(false) != null && x.GetGetMethod(false) != null)
        .Select(x => new
        {
            MemberPropName = x.Name,
            ListItemPropGetter = (Func<TModelProperty, object>)(p => x.GetValue(p, null))
        }).ToList();

    if (memPropsInfo.Count == 0)
        return HiddenForEnumerable(helper, expression);

    for (var i = 0; i < list.Count(); i++)
    {
        var listItem = list.ElementAt(i);
        foreach (var q in memPropsInfo)
        {
            sb.Append(helper.Hidden(string.Format("{0}[{1}].{2}", membername, i, q.MemberPropName), q.ListItemPropGetter(listItem)));
        }
    }

    return new MvcHtmlString(sb.ToString());
}

public static string GetMemberName<TModel, T>(this Expression<Func<TModel, T>> input)
{
    if (input == null)
        return null;

    MemberExpression memberExp = null;

    if (input.Body.NodeType == ExpressionType.MemberAccess)
        memberExp = input.Body as MemberExpression;
    else if (input.Body.NodeType == ExpressionType.Convert)
        memberExp = ((UnaryExpression)input.Body).Operand as MemberExpression;

    return memberExp != null ? memberExp.Member.Name : null;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-11-11T05:30:47.837

递归方法怎么样？

```
public static MvcHtmlString HiddenForEnumerable<TModel, TModelProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, IEnumerable<TModelProperty>>> expression, string prefix = null)
{
    var sb = new StringBuilder();

    var membername = expression.GetMemberName();
    var model = htmlHelper.ViewData.Model;
    var list = expression.Compile()(model);

    var type = typeof(TModelProperty);
    var memPropertyInfo = type.GetProperties(BindingFlags.Public | BindingFlags.Instance)
        .Where(x => x.GetSetMethod(false) != null && x.GetGetMethod(false) != null)
        .Select(x => new
        {
            Type = x.PropertyType,
            x.Name,
            Get = (Func<TModelProperty, object>)(p => x.GetValue(p, null))
        }).ToList();

    for (var i = 0; i < list.Count(); i++)
    {
        var listItem = list.ElementAt(i);
        if (memPropertyInfo.Any())
        {
            foreach (var m in memPropertyInfo)
            {
                var inputName = $"{prefix ?? ""}{membername}[{i}].{m.Name}";
                var inputValue = m.Get(listItem);
                var genericArguments = m.Type.GetGenericArguments();

                if (genericArguments.Any() && IsEnumerableType(m.Type))
                {
                    var delegateType = typeof(Func<,>).MakeGenericType(typeof(TModel), m.Type);
                    var bodyExpression = Expression.Constant(inputValue, m.Type);
                    var paramExpression = Expression.Parameter(typeof(TModel), "model");
                    var expressionTree = Expression.Lambda(delegateType, bodyExpression, new[] { paramExpression });
                    var hiddenForEnumerableInfo = typeof(HtmlHelpers).GetMethod("HiddenForEnumerable");
                    var hiddenForEnumerable = hiddenForEnumerableInfo.MakeGenericMethod(typeof(TModel), genericArguments[0]);
                    object[] args = { htmlHelper, expressionTree, inputName };

                    sb.Append(hiddenForEnumerable.Invoke(null, args));
                }
                else
                {
                    sb.Append(htmlHelper.Hidden(inputName, inputValue));
                }
            }
        }
        else
        {
            sb.Append(htmlHelper.Hidden($"{membername}[{i}]", listItem));
        }
    }

    return new MvcHtmlString(sb.ToString());
}

private static string GetMemberName<TModel, T>(this Expression<Func<TModel, T>> input)
{
    if (input == null)
        return null;

    MemberExpression memberExp = null;

    if (input.Body.NodeType == ExpressionType.MemberAccess)
        memberExp = input.Body as MemberExpression;
    else if (input.Body.NodeType == ExpressionType.Convert)
        memberExp = ((UnaryExpression)input.Body).Operand as MemberExpression;

    return memberExp?.Member.Name;
}

private static bool IsEnumerableType(Type type)
{
    return (type.GetInterface("IEnumerable") != null);
} 
```

例子：

```
public class Model
{
    IEnumerable<Order> Orders { get; set; }
}

public class Order
{
    public int OrderId { get; set; }
    IEnumerable<Item> Items { get; set; }
}

public class Item
{
    public int ItemId { get; set; }
    public string Name { get; set; }
} 
```

用法：

```
@Html.HiddenForEnumerable(model => model.Orders) 
```

输出：

```
<input id="Orders_0__OrderId" name="Orders[0].OrderId" type="hidden" value="1001">
<input id="Orders_0__Items_0__ItemId" name="Orders[0].Items[0].ItemId" type="hidden" value="201">
<input id="Orders_0__Items_0__Name" name="Orders[0].Items[0].Name" type="hidden" value="Something1">
<input id="Orders_0__Items_1__ItemId" name="Orders[0].Items[1].ItemId" type="hidden" value="202">
<input id="Orders_0__Items_1__Name" name="Orders[0].Items[1].Name" type="hidden" value="Something2">
<input id="Orders_1__OrderId" name="Orders[1].OrderId" type="hidden" value="1002">
<input id="Orders_1__Items_0__ItemId" name="Orders[1].Items[0].ItemId" type="hidden" value="205">
<input id="Orders_1__Items_0__Name" name="Orders[1].Items[0].Name" type="hidden" value="Something5"> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-12T16:48:13.997

不能使用 .ForEach()，因为 @Html.HiddenFor(x => x.ChangesOthersResult) 将创建相同的元素 ID，模型在回发时将无法识别。

```
for (int i = 0; i < Model.ChangesOthersResult.Count(); i++ )    
{
    @Html.HiddenFor(x => x.ChangesOthersResult[I]);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-19T20:48:47.610

在模型的构造函数中，新建 IEnumerable ChagesOthersResult

```
public Model ()
{
  ChangesOthersResult = new List<string>();
} 
```

然后在视图中，使用for循环

```
for(int i = 0; i < Model.ChangesOthersResult.Count; i++)
{
  @Html.HiddenFor(x => x.ChangesOthersResult[i])
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-21T10:42:26.150

aspnetcore 也一样

```
using Microsoft.AspNetCore.Html;
using Microsoft.AspNetCore.Mvc.Rendering;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using System.Reflection;
using System.Text;

namespace Proj.Helpers
{
    public static class HtmlHelpers
    {
        public static IHtmlContent HiddenForEnumerable<TModel, TModelProperty>(this IHtmlHelper<TModel> helper,
    Expression<Func<TModel, IEnumerable<TModelProperty>>> expression, params Expression<Func<TModelProperty, object>>[] memberPropsExpressions)
        {
            var hcb = new HtmlContentBuilder();

            var membername = expression.GetMemberName();
            var model = helper.ViewData.Model;
            var list = expression.Compile()(model);

            var memPropsInfo = memberPropsExpressions.Select(x => new
            {
                MemberPropName = x.GetMemberName(),
                ListItemPropGetter = x.Compile()
            }).ToList();

            for (var i = 0; i < list.Count(); i++)
            {
                var listItem = list.ElementAt(i);
                if (memPropsInfo.Any())
                {
                    foreach (var q in memPropsInfo)
                    {
                        hcb.AppendHtml(helper.Hidden(string.Format("{0}[{1}].{2}", membername, i, q.MemberPropName), q.ListItemPropGetter(listItem)));
                    }
                }
                else
                {
                    hcb.AppendHtml(helper.Hidden(string.Format("{0}[{1}]", membername, i), listItem));
                }
            }

            return hcb;
        }

        /// <summary>
        /// Returns hiddens for every IEnumerable item, with it's all public writable properties, if allPublicProps set to true.
        /// </summary>
        public static IHtmlContent HiddenForEnumerable<TModel, TModelProperty>(this IHtmlHelper<TModel> helper,
           Expression<Func<TModel, IEnumerable<TModelProperty>>> expression, bool allPublicProps)
        {
            if (!allPublicProps)
                return HiddenForEnumerable(helper, expression);

            var hcb = new HtmlContentBuilder();

            var membername = expression.GetMemberName();
            var model = helper.ViewData.Model;
            var list = expression.Compile()(model);

            var type = typeof(TModelProperty);
            var memPropsInfo = type.GetProperties(BindingFlags.Public | BindingFlags.Instance)
                .Where(x => x.GetSetMethod(false) != null && x.GetGetMethod(false) != null)
                .Select(x => new
                {
                    MemberPropName = x.Name,
                    ListItemPropGetter = (Func<TModelProperty, object>)(p => x.GetValue(p, null))
                }).ToList();

            if (memPropsInfo.Count == 0)
                return HiddenForEnumerable(helper, expression);

            for (var i = 0; i < list.Count(); i++)
            {
                var listItem = list.ElementAt(i);
                foreach (var q in memPropsInfo)
                {
                    hcb.AppendHtml(helper.Hidden(string.Format("{0}[{1}].{2}", membername, i, q.MemberPropName), q.ListItemPropGetter(listItem)));
                }
            }

            return hcb;
        }

        public static string GetMemberName<TModel, T>(this Expression<Func<TModel, T>> input)
        {
            if (input == null)
                return null;

            MemberExpression memberExp = null;

            if (input.Body.NodeType == ExpressionType.MemberAccess)
                memberExp = input.Body as MemberExpression;
            else if (input.Body.NodeType == ExpressionType.Convert)
                memberExp = ((UnaryExpression)input.Body).Operand as MemberExpression;

            return memberExp != null ? memberExp.Member.Name : null;
        }
    }
} 
```

# django - django 重定向未按预期工作

> ID：12981980
> 
> 赞同：1
> 
> 时间：2012-10-19T20:28:21.910
> 
> 标签：django

我有一个显示表单或“谢谢”页面的视图（如果表单提交成功）。我正在使用带有我测试过的 url 的重定向来显示感谢页面。

```
def form8(request):
    form = UserInfoForm(request.POST or None)
    if form.is_valid():
        form.save()
        return redirect('/sjwork/thanks')
    return render(request, 'form8.html', {'form': form}) 
```

但是，当表单成功提交时，django 给出错误：

```
ViewDoesNotExist at /sjwork/form8
Could not import views. Error was: No module named views 
```

如前所述，我可以直接访问 localhost:8000/sjwork/thanks，它会显示感谢页面。根据文档，我可以使用这样的硬编码网址。我也尝试了替代方案（给出视图，使用像[http://google.com](http://google.com)这样的完整网址） - 没有任何效果。我必须在这里遗漏一些基本的东西。如果有人能解释这里发生了什么，将不胜感激。谢谢。

应用程序 'sjwork' 在其 urls.py 中有以下内容：

```
url(r'^$', 'views.home', name='home'),
url(r'^thanks$', 'sjwork.views.thanks'),
url(r'^form8$', 'sjwork.views.form8', name='form8'), 
```

而项目 urls.py 包含：

```
url(r'^sjwork/', include('formtest.sjwork.urls')), 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T21:19:13.703

看起来错误与此模式有关。

```
url(r'^$', 'views.home', name='home'), 
```

尝试删除它，然后重试。另外，您能否在问题中包含您的导入语句。

# python - pexpect 发送光标移动

> ID：12981982
> 
> 赞同：3
> 
> 时间：2012-10-19T20:28:30.680
> 
> 标签：python, pexpect

如何使用 pexpect 发送光标移动，如上、下、左、右键。下面的示例是自动化 elinks，它使用 up/down 键来选择页面上的不同链接。

```
from pexpect import spawn
child = spawn('elinks http://python.org')
#what goes here to send down key
child.interact() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T20:57:48.650

下面的脚本包含所有四个光标移动的代码，以及一个如何在 pexpect 中使用它的示例。要发现任何输入文本的确切字符串序列，您可以使用下面的 get_keys.py 脚本。

```
KEY_UP = '\x1b[A'
KEY_DOWN = '\x1b[B'
KEY_RIGHT = '\x1b[C'
KEY_LEFT = '\x1b[D'
child.sendline(KEY_DOWN * 5)  #send five key downs 
```

**get_keys.py**

```
import curses
screen = curses.initscr()

screen.addstr("Press any set of keys then press enter\n") 
keys = ''
while True:
   event = screen.getkey()
   if event == "\n":
       break
   keys += event

curses.endwin()
print repr(keys) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T20:42:49.290

像这样对 up(^[[A) 或 down(^[[B) 使用转义序列怎么样。

```
child.send("\033[A")  # up
child.send("\033[B")  # down 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-09T02:38:38.430

试试这个发送 '\033\117\102' 作为向下键

# sencha-touch-2 - Preventing navigationview Back Button

> ID：12981985
> 
> 赞同：3
> 
> 时间：2012-10-19T20:28:47.337
> 
> 标签：sencha-touch-2, back-button, navigationbar

Is there any way to prevent the default back button behavior in the navigation bar of a navigationview?

I'm trying to use Sencha Touch 2 history and linking abilities with routers, but that requires me to essentially intercept all button taps so that I can update the url.

The back button in a navigation bar creates all kinds of nightmares as far as thats concerned, and I can supply code if someone thinks they have an alternate solution, but preventing the default back button behavior seems best (so as to play nice with browser back button)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T03:29:33.430

如果您想处理后退按钮，您可以使用在导航视图的后退按钮被点击时触发[**`back event`**](http://docs.sencha.com/touch/2-0/#!/api/Ext.navigation.View-event-back)的哪个按钮。有关如何操作，请参阅[我之前的回答。](https://stackoverflow.com/questions/12761503/hiding-a-button-on-pushed-view-and-showing-it-when-back-to-list-view/12766396#12766396)`navigation view`

如果您想完全隐藏后退按钮，只需使用：

```
Ext.select('.x-button-back').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T06:00:52.260

试试这个 Ext.getCmp('navigationview's id').getNavigatorBar().hide()

# c# - Concatenating IEnumerable > values into string using Linq

> ID：12981986
> 
> 赞同：6
> 
> 时间：2012-10-19T20:28:49.490
> 
> 标签：c#, linq, concatenation

Given `IEnumerable<KeyValuePair<string,string>>`, I'm trying to use linq to concatenate the values into one string.

My Attempt:

```
string path = attributes.Aggregate((current, next) => "@" + current.Key + "=" + current.Value + " and @" + next.Key + "=" + next.Value); 
```

This produces the error:

> Cannot convert expression type '`string`' to return type '`KeyValuePair<string,string>`'

Is there a more effiecient way to do this in linq?

The full method...

```
public IEnumerable<XmlNode> GetNodes(IEnumerable<KeyValuePair<string,string>> attributes) {
    StateInfoXmlDocument stateInfoXmlDocument = new StateInfoXmlDocument();
    string path = attributes.Aggregate((current, next) => "@" + current.Key + "=" + current.Value + " and @" + next.Key + "=" + next.Value);
    string schoolTypeXmlPath = string.Format(SCHOOL_TYPE_XML_PATH, path);

    return stateInfoXmlDocument.SelectNodes(schoolTypeXmlPath).Cast<XmlNode>().Distinct();
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-19T20:33:07.133

这是你要找的吗？

```
var strings = attributes.Select(kvp => string.Format("@{0}={1}", kvp.Key, kvp.Value));
string path = string.Join(" and ", strings); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T20:33:41.350

```
string s = String.Join("@",attributes.Select(kv=>kv.Key+"="+kv.Value)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:33:44.440

如果你想使用聚合来创建一个字符串，如果你使用非种子版本，则需要使用聚合的种子重载，那么调用中的所有类型都必须相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-23T11:55:43.820

```
string templ = "{0}={1}";
string _authStr = String.Join("&", formParams.Select(kv => String.Format(templ, kv.Key, kv.Value)); 
```

# objective-c - NSButton not responding to performSelector:

> ID：12981988
> 
> 赞同：1
> 
> 时间：2012-10-19T20:28:51.977
> 
> 标签：objective-c, cocoa, nsbutton

So I have a button that is attached to an action called writeToFile:

The action opens an NSPanel and allows the user to enter the name of the file they want to write to their desktop.

The problem I am having is I can't update the user and let them know that the write was successful before the NSPanel closes.

So I put a label or NSTextField because I am talking about a mac app inside the NSPanel and the NSTextField updates and tells the user that the write was a success.

I change the button title that is attached to the action writeToFile: to "close" and I am trying to change the method the button actually calls by using performSelector:

However, I keep getting an "Unrecognized selector"

Here is some code, any and all help is greatly appreciated:

```
- (void) closePanel {
       [theSheet close];
}

- (IBAction) writeToFile: (id)sender
{

    if ([_nameOfFile.stringValue length] > 0) {

        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDesktopDirectory, NSUserDomainMask, YES);
        NSString *path = [[paths objectAtIndex:0]stringByAppendingPathComponent:_nameOfFile.stringValue];
        NSString *string = _inputTextView.string;
        BOOL OK = [string writeToFile:path
                       atomically:YES
                         encoding:NSUTF8StringEncoding
                            error:NULL];

        if (OK) {

            _statusField.stringValue = @"File written to desktop";
            _writeButton.title = @"close";
            [_writeButton performSelector:@selector(closePanel)];

        } else {

            _statusField.stringValue = @"Sorry, something went wrong :(";

        }

    } else {

        _statusField.stringValue = @"Please name the file first!";

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:31:24.190

那是因为`_writeButton`没有实现`-closePanel`. 你的课有。将其更改为：

```
[ self closePanel ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T09:36:58.550

你设置代理了吗？

```
[_writeButton setTarget:self];
[_writeButton setAction:@selector(writeToFile:)]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T20:37:11.170

换行：

```
[_writeButton performSelector:@selector(closePanel)]; 
```

为了：

```
[_writeButton addTarget:self action:@selector(closePanel)forControlEvents:UIControlEventTouchUpInside]; 
```

# python - 如何在 Django 中调试失败的测试？

> ID：12981990
> 
> 赞同：22
> 
> 时间：2012-10-19T20:29:07.630
> 
> 标签：python, django, unit-testing, testing

如何调试我的测试？例如，我 POST 创建一个条目并期望它验证并返回特定页面。它可以在浏览器和 shell 中工作，但测试是唯一失败的东西（讽刺的是！）。我想打印对控制台或其他东西的响应，以便我可以阅读错误或你有什么。但我只能看到我`print`在视图中的东西。

不确定是否有必要，但这里有问题的测试代码来自`tests.py`：

```
 resp = self.client.post('/meal/invite/', 
        {'summary': 'Test munch', 'when': now(), 'max_diners': '1', 'description': 'Munchies'}, follow=True)
    self.assertEqual(resp.status_code, 200)
    self.assertContains(resp, 'Test munch', 1)
    self.assertContains(resp, 'You are hosting this meal', 1) 
```

最后的断言是错误的。如果我将其更改为显示“必填字段”错误的原始表单页面中存在的值，它就会通过。我只是看不到我错过了什么。

我还有其他一些测试正在运行，但我只是不知道如何调试它。

它是如何完成的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-19T20:35:22.943

您可以插入`pdb`并检查所有内容。

如果您正在使用，`nose`我相信您必须使用`-s`

```
 -s, --nocapture       Don't capture stdout (any stdout output will be
                        printed immediately) [NOSE_NOCAPTURE] 
```

这就是让您无法立即看到输出的原因。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-14T03:27:47.930

在 pdb 下运行测试：

```
python -m pdb manage.py test yourapp 
```

我同意 Alasdair 的观点，打印 response.content（以及一般的打印内容）是一个很大的帮助。输出与正常的测试运行程序输出混淆，一旦发现问题并修复它就应该删除，但它可以帮助你缩小问题范围。

此外，如果代码在浏览器和 shell 中有效，但在单元测试中无效，请记住单元测试会创建一个新的（空的）数据库。确保您的设置放入测试所需的任何数据。

（根据帕特里克的建议更新了代码部分，感谢帕特里克）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-20T12:30:37.223

最简单的做法是`print response.content`在断言之前添加。输出可能有点压倒性，但通常足以让您发现问题。

如果这不能解决问题，文档中列出了许多可以提供帮助的功能。添加一些打印语句，看看你得到了什么。这里有一些建议，但不要局限于这些，文档中有更多工具。

[https://docs.djangoproject.com/en/dev/topics/testing/](https://docs.djangoproject.com/en/dev/topics/testing/)

首先，您需要检查页面是否确实按照您的预期重定向。尝试使用`redirect_chain`或`assertRedirects`。

我怀疑您的帖子数据由于某种原因无效。您可以从响应上下文中获取表单。

```
form = response.context['form']
print form.is_valid()
print form.errors 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-19T10:47:18.097

如果您使用的是 vscode，您可以在 root/vscode/launch.json 文件中创建一个新配置，如下所示：

```
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Django RUN",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/manage.py",
            "args": [
                "runserver",
                "--noreload",
                "--nothreading"
            ],
            "django": true
        },
        {
            "name": "Django TEST",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/manage.py",
            "args": [
                "test",
                "<your-app-name>",
            ],
            "django": true
        }
    ]
} 
```

这允许您在测试中放置断点并使用 vscode 进行调试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-08T19:29:44.640

在 pycharm 中，您可以使用 TestCase 库在 tests.py 中进行测试，然后突出显示该测试，然后 rt 单击以获取在调试模式下运行 tests.tests 的选项。非常方便，并将单元测试放在我的常规开发周期中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-18T17:09:12.080

可以将 Eclipse IDE 与 Pydev 一起使用，创建一个 Debug 配置，其中 Arguments 是测试命令。就像是：

```
test  users.tests.selenium_tests.UsersTestCase.test_user_creation --keepdb --settings=project.settings.test_settings 
```

[![在此处输入图像描述](../Images/8820de23c793c60cd08e24fd8cee3220.png)](https://i.stack.imgur.com/yrfbK.png)

然后，使用带有断点和逐步工作流、变量、表达式等的 Pydev 调试器。

文档在这里（[http://www.pydev.org/manual_adv_debugger.html](http://www.pydev.org/manual_adv_debugger.html)），但不涉及 Django。

# jquery - 可定制的用户界面网站示例

> ID：12981992
> 
> 赞同：0
> 
> 时间：2012-10-19T20:29:14.193
> 
> 标签：jquery, html, css, widget, customization

我正在寻找允许用户自定义小部件（调整大小、移动小部件、选择不同的布局等）的网站示例

一个很好的例子是[netvibes.com](http://www.netvibes.com)：

转到 netvibes.com > 开始 > 点击 Go basic（您不必提供信息）> 并输入您喜欢的任何主题（例如魔兽世界） - 需要一分钟然后仪表板加载，您可以了解如何与页面底部的不同小部件进行交互。

我正在建立一个需要这样的功能主义者的网站，我主要是想看看已经存在的例子以获得灵感。

我知道我所问的问题没有正确或错误的答案，所以我想我会将正确答案授予给出最佳和最相关链接的人。

谢谢

显然，我在这里发帖之前已经搜索了谷歌，这就是我找到 netvibes 的方式。我想知道是否有人知道类似或更好的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:36:32.767

尝试在这样的网站上搜索：

[http://www.siteslike.com/similar/netvibes.com](http://www.siteslike.com/similar/netvibes.com)

[http://www.similarsites.com/site/netvibes.com](http://www.similarsites.com/site/netvibes.com)

[http://www.similarsitesearch.com/alternatives-to/netvibes.com](http://www.similarsitesearch.com/alternatives-to/netvibes.com)

# sql - SQL更新组中具有最小值的列

> ID：12981994
> 
> 赞同：2
> 
> 时间：2012-10-19T20:29:16.487
> 
> 标签：sql, oracle

我正在尝试使用 DESC 组中的最小值更新 MD_ID 列。
例如，我希望 DESC=Language 的所有行都将 MD_ID=21 设为 min(21, 163, 287)=21。为简化起见，它始终是与 SOURCE=1 关联的 MD_ID。

数据如下所示：

```
MD_ID|SOURCE|DESC           |MSG |SEGMNT|FIELD
  21 |1     |Language       |A11 |PID   |33
 163 |2     |Language       |A11 |PID   |33
 287 |3     |Language       |A11 |PID   |33
  22 |1     |Sex            |B22 |MSH   |8
 145 |2     |Sex            |B22 |MSH   |8
 171 |3     |Sex            |B22 |MSH   |8
  23 |1     |Marital Status |C33 |NK1   |16
 145 |2     |Marital Status |C33 |NK1   |16
 289 |3     |Marital Status |C33 |NK1   |1
  24 |1     |Religion       |D44 |GT1   |7
 167 |2     |Religion       |D44 |GT1   |7
 292 |3     |Religion       |D44 |GT1   |7 
```

* * *

我需要它看起来像这样：

```
MD_ID|SOURCE|DESC           |MSG |SEGMNT|FIELD
  21 |1     |Language       |A11 |PID   |33
  21 |2     |Language       |A11 |PID   |33
  21 |3     |Language       |A11 |PID   |33
  22 |1     |Sex            |B22 |MSH   |8
  22 |2     |Sex            |B22 |MSH   |8
  22 |3     |Sex            |B22 |MSH   |8
  23 |1     |Marital Status |C33 |NK1   |16
  23 |2     |Marital Status |C33 |NK1   |16
  23 |3     |Marital Status |C33 |NK1   |1
  24 |1     |Religion       |D44 |GT1   |7
  24 |2     |Religion       |D44 |GT1   |7
  24 |3     |Religion       |D44 |GT1   |7 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T20:38:31.507

```
UPDATE YourTable t
    SET MD_ID = (SELECT MD_ID
                     FROM YourTable t2
                     WHERE t2.DESC = t.DESC
                         AND t2.SOURCE = 1) 
```