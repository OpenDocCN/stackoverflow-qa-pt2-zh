# StackOverflow 问答 15430000-15430999

# mysql - 在nodejs中解析字符串

> ID：15430000
> 
> 赞同：2
> 
> 时间：2013-03-15T10:30:24.280
> 
> 标签：mysql, node.js

我正在`uploading images`使用`nodejs`

我`query`的就像：

```
var user = req.body;
var imgurl=projectDir +"/uploads/"+req.files.displayImage.name;
var sql= "INSERT INTO users values('','"+user.name+"','"+user.email+"','"+user.user+"','"+user.pass+"','"+imgurl+"',now())"; 
```

一切正常，除非它插入`imgurl`它不`parse`它，

我`project directory`也是`D:\node` 我得到它`projectDir =D:\node`

但它会`insert`像`database`：

```
D:
ode/uploads/canvas.png 
```

我知道它转换`\n`为`new line`,

那么，我`question`是如何防止这种情况的，我该怎么办`both single and double quotes` `insertion`？

**谢谢。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T11:08:52.340

`\`使用as 这样`\\n`或`\"` `\'`etc来逃避它们。

[这是一个回答您查询的相关问题](https://stackoverflow.com/questions/7744912/making-a-javascript-string-sql-friendly)。方法：

```
function mysql_real_escape_string (str) {
    return str.replace(/[\0\x08\x09\x1a\n\r"'\\\%]/g, function (char) {
        switch (char) {
            case "\0":
                return "\\0";
            case "\x08":
                return "\\b";
            case "\x09":
                return "\\t";
            case "\x1a":
                return "\\z";
            case "\n":
                return "\\n";
            case "\r":
                return "\\r";
            case "\"":
            case "'":
            case "\\":
            case "%":
                return "\\"+char; // prepends a backslash to backslash, percent,
                                  // and double/single quotes
        }
    });
} 
```

您可以将该`mysql_real_escape_string()`函数存储为一个单独的模块，并在使用前将其 require，或者直接将其插入将使用它的 .js 文件中。您可以使用它，如下所示：

```
var sql= "INSERT INTO users values('','"+user.name+"','"+user.email+"','"+user.user+"','"+user.pass+"','"+mysql_real_escape_string(imgurl)+"',now())"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-20T05:04:15.487

您应该考虑使用“？”来准备您的查询。语法（[https://github.com/felixge/node-mysql#preparing-queries](https://github.com/felixge/node-mysql#preparing-queries)）。

```
var sql= "INSERT INTO users SET ?";
// Connection attained as listed above.
connection.query( sql, { name:user.name, email:user.email, user:user.user, pass:user.pass, image:imgurl, timestamp:now()}, function(err, result){
   // check result if err is undefined.
}); 
```

使用此模式，node-mysql 将为您完成所有转义和安全检查。

希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:18:38.850

呃，转义查询字符串中的所有反斜杠和引号。始终使用`connection.escape`

```
var mysql      = require('mysql');
var connection = mysql.createConnection(...);
var userId = 'some user provided value';
var sql    = 'SELECT * FROM users WHERE id = ' + connection.escape(userId);
connection.query(sql, function(err, results) {
  // ...
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-23T12:13:58.737

```
var mysql      = require('mysql');
var connection = mysql.createConnection({
 host     : 'localhost',
 user     : 'root',
 password : '',
 database : '*****'
});

connection.connect(function(err){
 if(!err) {
  console.log("Database is connected");
 } else {
  console.log("Error while connecting with database");
 }
});

var message  = req.body.message;
var user_id  = req.body.user_id;
var sql = "INSERT INTO users(user_id, message) VALUES ('"+user_id+"', "+connection.escape(message)+")";
connection.query(sql, function(err, result) { }); 
```

# java - 面向对象和基于对象的语言之间的核心区别

> ID：15430004
> 
> 赞同：35
> 
> 时间：2013-03-15T10:30:38.673
> 
> 标签：java, javascript, oop, object

我想知道两者的核心区别是什么

**面向对象和基于对象的语言**

我读过很多帖子，他们都在说两件事

1.  面向对象的语言支持 OOP 的所有特性，而基于对象的语言不支持 OOP 的所有特性，如多态性和继承。

2.  他们给出了 javascript 作为基于对象和 java 作为面向对象的示例

喜欢stackoverflow的这篇文章

[面向对象和基于对象的语言之间的区别](https://stackoverflow.com/questions/6954293/difference-between-object-oriented-and-object-based-language)

但我想知道这两个概念之间的核心区别是什么，无论任何语言。

得到了答案

终于拿到东西了

谢谢`Matías Fidemraizer`

答案不依赖于任何语言，不依赖于任何功能，我正在寻找的核心区别是

*本身包含对象的语言称为基于对象的语言，遵循面向对象概念的语言称为面向对象语言*

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-15T10:50:23.750

JavaScript 是一种面向原型的语言。

它可以从构造函数构建实际对象，并且几乎具有任何对象可能具有的任何功能：

*   构造函数。
*   方法（即 JavaScript 中的函数）。
*   属性（从 ECMA-Script 5 开始，“getters/setters”）。
*   实例。

在 JavaScript 中，任何对象都有*原型*，包括*函数*。原型本身是将*对象成员*添加到整个对象的任何新创建实例的基本方法。

```
var constructor = function() { };
constructor.prototype.text = "hello world";

alert(new constructor().text); // This alerts hello world 
```

为什么 JavaScript 不是面向对象的编程*（脚本）语言*？因为它没有符合面向对象编程定义要求的特性：

*   **多态性**：*没有*。您可以更改原型成员的行为，但这只是重用标识符。您无法访问*伪派生对象*中成员的先前实现。
*   **继承**：*一点也不*。也许原型链可以与继承相媲美，但 JavaScript（ECMA-Script 5.x 或更早版本）不像其他基于 OOP 的语言（即 Java、C#、Ruby、Python、VisualBasic.NET、... ）。
*   **封装**。是的，当然，但是没有办法创建实际的私有或内部对象成员。

可能我忘了提一些其他的细节，但老实说，我相信这是一个很好的总结。

### 更新和总结

*核心区别在于面向对象的编程语言具有面向对象范式必须具备的特征，才能被视为面向对象的编程语言。**因此，就目前而言，JavaScript 并不是一种真正的面向对象编程语言，因为它缺乏真正的多态性和继承性***。

## 更新：ES2015 及更高版本是否改变了这种情况？

从美学上讲是的，ES2015 及更高版本有一个重大改进，让我们考虑不完全但更接近面向对象的编程：调用*超类的*语法糖。

例如：

```
class A {
     doStuff() {
         console.log("hello world");
     }
}

class B extends A {
     doStuff() {
         super.doStuff();
         console.log("...and goodbye!");
     }
} 
```

这就是*多态性*。更专业的类可以覆盖其基类，以完全改变函数行为或执行基类已经在做的事情，向函数添加新代码。

顺便说一句，ES2015 及更高版本仍然缺乏真正的封装：**访问修饰符 like`private`或`public`here 在哪里？** *无处*。

而且，归根结底，ES2015 及更高版本实现了基于类的 OOP，但它仍然是 ECMAScript 5.x 之上的语法糖层......上面的代码仍然适用于引擎盖下的原型，并且工作方式相同就好像你会在 ECMAScript 5.x 中编写代码一样：

```
function A() {
}

A.prototype.doStuff = function() {
    console.log("hello world");
};

function B() {
}

B.prototype = Object.create(A.prototype);
B.prototype.doStuff = function() {
    A.prototype.doStuff.call(this);
    console.log("...and goodbye!");
}; 
```

希望我需要再次更新这个答案，因为 ES2020 已经提出了访问修饰符，我们将能够考虑将 JavaScript 视为另一种完全支持面向对象编程的语言！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-07-12T22:44:01.557

**基于对象的**语言基本上包括任何提供轻松创建和使用对象的内置能力的语言。有一个主要标准：

*   **封装。**对象具有附加到它们的 API，通常以这样一种方式，您可以通过*告诉对象要做什么而*不是在其上运行某些函数来使用对象。

    大多数基于对象的语言根据“类”定义对象，这些基本上是对象的蓝图。该类列出了对象的内部结构并定义了 API。

    不过，这不是唯一的方法。例如，在 JavaScript 中，对象并没有真正的“类”。任何对象都可以拥有它想要的任何属性。由于函数是 JavaScript 中的一等值，因此可以将它们设置为对象的属性，并用作对象的 API。

就基于对象但非面向对象的语言而言，一个很好的例子是 Visual Basic（不是 .net 的东西；我说的是 VB6 和 VBA）。类存在，但不能相互继承。

**面向对象的**语言是基于对象的语言，它使事情更进一步。它们内置了对 OOP 的另外两个支柱的支持：

*   **遗产。**对象必须具有成为（并被视为）某个其他对象的特化的能力。这意味着，例如，能够将“狗”定义为“可以吠叫和捡树枝的动物”。

    在现代语言中，它通常采用一个对象的*类从另一个对象的**类*继承的形式。不过，这不是必需的；与某些人试图告诉您的相反，OOP 的定义根本不需要类。

**   **多态性。**  代码必须能够使用一个对象，而无需知道或关心它究竟是什么类型。

    大多数语言（尤其是静态类型的语言）根据类和继承来定义多态性。如果您有一个从 A 继承的 B 类，则需要引用 A 的代码通常可以采用 B，但不能采用与 A 无关的某些 C 类。Java 也有`interface`关键字，它可以让您定义一个类必须实现的一组行为。任何其类显式的对象`implements X`，从而实现接口 X 上定义的函数，都可以作为类型 X 的实例。

     其他语言，比如 JavaScript，可以让你传递任何你喜欢的对象。只要对象呈现正确的界面，它到底是什么类型的对象并不重要。这被称为“鸭子类型”，它几乎是最纯粹的多态形式。* 

 ** * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-12T18:32:09.987

仅使用对象并不意味着您正在执行 OOP，即使使用完全 OO 语言，如果您不实现 OO 技术，它也只是基于对象的编程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-09T10:00:44.633

为了成为真正的面向对象语言，编程语言必须符合 4 个主要元素。它们是：抽象、封装、模块化和层次结构。

但是，如果支持第一个存在元素，我们可以调用基于语言对象。一旦编程语言支持对象的概念，它就本质上支持前三个元素，因为它们是对象的固有特征。

JavaScript 作为一种语言不能说是面向对象而是基于对象的语言，因为它不支持层次结构（尤其是继承）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-24T03:49:18.203

> OOP 和 OBP 是遵循不同原则的编程语言类型。

**OOP**：遵循多态、继承和封装（PIE）。

*   **示例**：Java、.Net 等。OOP 与 OBP 相比是新的

**OBP**：遵循多态性和封装。

*   **示例**：Ada、Visual Basic (VB) 和 Fortran 90。OBP 已过时

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-01T19:42:22.260

粗略...

*   面向对象：支持封装、继承、多态
*   基于对象：支持封装

[维基百科 - 基于对象的语言](https://en.wikipedia.org/wiki/Object-based_language)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2015-10-12T09:38:11.130

面向对象的编程语言遵循属于 OOP 的所有概念。

基于对象的编程语言具有 ibuilt 对象，因此无需创建对象，并且它还遵循 OOP 概念，除了继承，

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2016-05-05T10:24:35.343

面向对象语言

```
Object-orientd language supports all the features of OOPs

Object-orientd language does not has in-built object

Object-orientd languages are C++, C#, Java etc 
```

基于对象的语言

```
Object-based language doesn't support all the features of OOPs like Polymorphism and Inheritance

Object-based language has in-built object like JavaScript has window object.

Object-based languages are JavaScript, VB etc. 
```

希望，这将澄清你的疑问。*

# jquery - wordpress 中的简单 Jquery 自定义帖子类型存档幻灯片切换

> ID：15430008
> 
> 赞同：0
> 
> 时间：2013-03-15T10:30:44.820
> 
> 标签：jquery, wordpress, custom-post-type

我目前有一个自定义帖子存档，显示一个月（ul）内的所有帖子（li）。我希望拥有它，这样当用户在二月点击时，该幻灯片的所有帖子都会进入或淡入。我还希望已经显示当前月份的帖子。任何建议或指向教程的链接都会很棒，因为我的 jquery 非常基础。

谢谢您的帮助

```
<script>
            jQuery (document).ready(function() {
            jQuery ('.list-slide').hide();
            jQuery ('.list-slide-btn').click(function() {
                jQuery ('.list-slide').slideToggle(1500).delay(1500);
            }); 
        });
</script>
<div  class="album-list width50 float-left">
                    <?php       
                    $counter = 0;
                    $ref_month = '';
                    $monthly = new WP_Query(array(
                        'post_type' => 'albums',
                        'posts_per_page' => -1,
                        ));
                    if( $monthly->have_posts() ) : while( $monthly->have_posts() ) : $monthly->the_post();
                        if( get_the_date('mY') != $ref_month ) { 
                            if( $ref_month ) echo "\n".'</ul>';
                            echo "\n".'<h5 class="list-slide-btn">'.get_the_date('F Y').'</h5>';
                            echo "\n".'<ul class="list-slide">';
                            $ref_month = get_the_date('mY');
                            $counter = 0;
                        }

                    if( $counter++ < 31 ) echo "\n".'   <li><a href='.get_permalink($post->ID).'>'.get_the_date('D jS').' &#58;<br/>'.get_the_title($post->ID).'</a></li>';

                    endwhile; 
                    echo "\n".'</ul>';
                    endif; 
                    ?>
</div> 
```

# mysql - mysql更改列中的所有值

> ID：15430009
> 
> 赞同：30
> 
> 时间：2013-03-15T10:30:46.257
> 
> 标签：mysql, sql

我想更改表格列“Quellendatum”中的所有值。

当行值为 2005-06-20 时，应将其替换为 2012-06-20。当 row-value 为 NULL 或空时，它应该保持不变。

目前我通过选择行手动修改：

```
UPDATE  `outgoing2`.`tbl_hochschule` 
SET  `Quellendatum` =  '2012-06-20' 
WHERE  `tbl_hochschule`.`id` =1; 
```

有没有办法自动化这个任务？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-15T10:36:03.837

怎么样：

```
UPDATE outgoing2.tbl_hochschule 
SET Quellendatum = '2012-06-20' 
WHERE Quellendatum = '2005-06-20' 
AND !isnull( Quellendatum ); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-11-17T16:15:45.240

在 MySql 中，您可以执行以下操作：

```
UPDATE TABLENAME    
SET IDCOLUMN=VALUE    
WHERE IDCOLUMN=VALUE    
AND !isnull (IDCOLUMN) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-15T10:34:48.223

它应该是 ：

```
UPDATE tablename 
SET Quellendatum = '2012-06-20' 
WHERE Quellendatum = '2005-06-20' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T10:40:20.830

```
UPDATE outgoing2.tbl_hochschule 
SET Quellendatum = '2012-06-20' 
WHERE Quellendatum <> '' AND Quellendatum <> NULL; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-06T18:40:47.060

如果**Quellendatum = "2005-06-20"**那么它不能为 NULL，所以我看不到使用 '`AND !isnull (Quellendatum)`

我对吗？

# sql - SQL where x 或 y 但不是两者

> ID：15430012
> 
> 赞同：5
> 
> 时间：2013-03-15T10:30:54.007
> 
> 标签：sql, db2

我有一张桌子，列出了供应牛肉鸡肉的餐厅，与此类似：

```
Res   Meat
res1  chicken
res1  chicken
res1  beef
res2  chicken
res2  chicken
res3  beef 
```

我正在尝试编写一个查询，返回哪些餐厅只提供鸡肉或牛肉，而不是两者都提供，而不消除结果中的重复项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:45:43.557

试试这个：

```
CREATE TABLE rest 
    (
     id int auto_increment primary key, 
     Res varchar(20),
     Meat varchar(20) 
    );

INSERT INTO rest
(Res,Meat)
VALUES
('res1','chicken'),
('res1', 'chicken'),
('res1', 'beef'),
("res2", 'chicken'),
("res2", 'chicken'),
( 'res3', 'beef' )

select Res from 
  (select distinct Res,Meat from rest ) test
group by Res
having count(1) = 1 
```

[SQLFiddle 上的示例](http://sqlfiddle.com/#!2/82518/3/0)，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:34:48.753

试试这个方法：

```
create table tab
(
   Res   varchar(10), 
   Meat varchar(10)
)

insert into tab ( Res, Meat ) values ( 'res1', 'chicken' )
insert into tab ( Res, Meat ) values ( 'res1', 'chicken' )
insert into tab ( Res, Meat ) values ( 'res1', 'beef' )    
insert into tab ( Res, Meat ) values ( 'res2', 'chicken' )
insert into tab ( Res, Meat ) values ( 'res2', 'chicken' )    
insert into tab ( Res, Meat ) values ( 'res3', 'beef' )

select Res
from (
select distinct Res,Meat
from tab ) T
group by Res
having count(1) = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:52:29.490

您可以使用 except 运算符

```
select * from table
where meat = 'chicken' or meat = 'Beer'

except

select * from table
where meat = 'chicken' and meat = 'Beer' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T10:52:58.563

尝试：

```
select Res 
from rest
group by Res
having count(distinct Meat) = 1 
```

# string - R字符串拆分函数（strsplit）中的非字符参数

> ID：15430016
> 
> 赞同：33
> 
> 时间：2013-03-15T10:31:04.147
> 
> 标签：string, r, for-loop, strsplit

这有效

```
x <- "0.466:1.187:2.216:1.196"
y <- as.numeric(unlist(strsplit(x, ":"))) 
```

所有的值`blat$LRwAvg`看起来像`X`上面，但这不起作用

```
for (i in 1:50){
  y <- as.numeric(unlist(strsplit(blat$LRwAvg[i], "\\:")))
  blat$meanLRwAvg[i]=mean(y)
} 
```

因为：

> strsplit(blat$LRwAvg[i], "\:") 中的错误：非字符参数

我有一个、两个或空反斜杠都没关系。

我的问题是什么？（一般来说，我的意思是在这项特殊任务中，技术上）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-15T11:07:13.430

正如 agstudy`blat$LRwAvg <- as.character(blat$LRwAvg)`在循环修复之前暗示的那样

```
blat$meanLRwAvg <- blat$gtFrqAvg #or some other variable in data frame with equal length
blat$LRwAvg <- as.character(blat$LRwAvg)
for (i in 1:50){
  y <- as.numeric(unlist(strsplit(blat$LRwAvg[i], "\\:")))
  blat$meanLRwAvg[i]=mean(y)
} 
```

# twitter-bootstrap - Bootstrap - Affix & scrollspy - 在滚动不工作时激活

> ID：15430020
> 
> 赞同：1
> 
> 时间：2013-03-15T10:31:14.210
> 
> 标签：twitter-bootstrap

我有以下[jsfiddle](http://goo.gl/IlXur)

我无法得到：

*   navspy 正常工作
*   单击菜单项也应将其标记为活动
*   列表中的最后一个元素在没有明显原因的情况下被选中。

我坚持这一点。有人愿意告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T13:38:49.437

您需要将 'scrollspy' 添加到 body 标记中才能激活菜单项。

```
<body data-spy="scroll" data-target=".navspy"> 
```

[http://jsfiddle.net/skelly/yPgUu/253/](http://jsfiddle.net/skelly/yPgUu/253/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T18:13:02.457

接受@Skelly 的繁重工作，这里有一个变体：http: [//jsfiddle.net/panchroma/TcyBY/](http://jsfiddle.net/panchroma/TcyBY/)

我已将 scrollspy 调用从 body 标记移到单独的 js

```
$('body').scrollspy({ target: '.sidebar-nav' }); 
```

Bootstrap 网站上有关 scrollspy 的文档可能更清楚。这是一个可能有助于解释一些问题的链接：http: [//mtjhax.wordpress.com/2013/02/11/twitter-bootstraps-scrollspy-plugin-needs-better-docs/](http://mtjhax.wordpress.com/2013/02/11/twitter-bootstraps-scrollspy-plugin-needs-better-docs/)

希望这可以帮助！

# c - 编写AT命令嵌入式linux

> ID：15430023
> 
> 赞同：2
> 
> 时间：2013-03-15T10:31:16.083
> 
> 标签：c, linux, embedded, embedded-linux, gsm

我在将 AT 命令写入 GSM 模块时遇到问题。当我使用 minicom -b 115200 -D /dev/ttySP0 --term=vt100 时它完美无缺，但我不知道如何在 C 代码中做同样的事情。我没有收到任何错误，但模块对命令没有反应。有谁知道可能出了什么问题？

```
#include <sys/types.h>                                                  
#include <sys/stat.h>                                                      
#include <fcntl.h>                                                       
#include <termios.h>                                                    
#include <stdio.h>    
#define BAUDRATE B115200
#define COM1 "/dev/ttySP0"
static int fd;
static struct termios oldtio,newtio;

//==============================================================
int tty_read(char *buf,int nbytes)
{
  int temp;
temp = read(fd,buf,nbytes);
printf("Read string: %s\n", buf);
return temp;
}
//==============================================================
int tty_end()
{
    tcsetattr(fd,TCSANOW,&oldtio);
    close(fd);
}

//==============================================================
int tty_writecmd(char *buf,int nbytes)
{
int i;
for(i=0; i<nbytes; i++) {
write(fd,&buf[i],1);
usleep(100);
}
write(fd,"\n",1); //Tried \0 \r aswell
usleep(300000);
return tcdrain(fd);
}

//==============================================================
int baud = B115200;
int tty_init()
{
fd = open(COM1, O_RDWR );
if (fd <0) {
      perror(COM1);
      exit(1);
    }
    tcgetattr(fd,&oldtio);
bzero(&newtio, sizeof(newtio)); 
newtio.c_cflag = baud | CRTSCTS | CS8 | CLOCAL | CREAD ;

newtio.c_iflag = IGNPAR | ICRNL; 
newtio.c_oflag = 0; 
newtio.c_lflag = ICANON;
 newtio.c_cc[VINTR]    = 0;     
 newtio.c_cc[VQUIT]    = 0;     
 newtio.c_cc[VERASE]   = 0;     
 newtio.c_cc[VKILL]    = 0;    
 newtio.c_cc[VEOF]     = 4;     
 newtio.c_cc[VTIME]    = 0;
 newtio.c_cc[VMIN]     = 1;
 newtio.c_cc[VSWTC]    = 0;     
 newtio.c_cc[VSTART]   = 0;     
 newtio.c_cc[VSTOP]    = 0;
 newtio.c_cc[VSUSP]    = 0; 
 newtio.c_cc[VEOL]     = 0;
 newtio.c_cc[VREPRINT] = 0; 
 newtio.c_cc[VDISCARD] = 0;
 newtio.c_cc[VWERASE]  = 0;
 newtio.c_cc[VLNEXT]   = 0;
 newtio.c_cc[VEOL2]    = 0; 
  tcflush(fd, TCIFLUSH);
tcsetattr(fd,TCSANOW,&newtio);
return 0;
}

int main(int argc, char *argv[])
{
  char recv[10];
  char command[] = "AT+CSQ";
  tty_init();
  printf("Write: %d\n", tty_writecmd(command, sizeof(command)));
  usleep(40000);
  printf("Read: %d\n", tty_read(recv ,sizeof(recv)));
  tty_end();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T02:00:24.260

你应该做的第一件事是运行

> stty -F /dev/ttySP0

在 minicom 运行和您的程序运行时执行此操作。检查一切并进行比较。有很多事情可能会导致您出现问题。

一旦你有了这些匹配，你想确保你发送的数据会出去。

> 猫/proc/tty/驱动程序/串行

比较发送数据之前和之后的 tx 值，以确保它正在输出。

如果是，那么您可以检查 rx 值。如果您没有得到响应，您可能需要一台示波器来检查线路上的数据。如果你不能这样做，那么三重检查波特率和流量控制。

# hadoop - 通过R将本地文件夹复制到hdfs

> ID：15430026
> 
> 赞同：2
> 
> 时间：2013-03-15T10:31:20.213
> 
> 标签：hadoop, hdfs, rhadoop

我正在尝试将文件夹从本地文件系统导出到 hdfs 。我正在通过 R 运行代码。我怎么能做到呢？

希望提出建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T21:01:50.240

您应该使用该`system`命令轻松地做到这一点：

```
system("hadoop fs -put /path/to/file /path/in/hdfs") 
```

您还可以使用[rhdfs](https://github.com/RevolutionAnalytics/rhdfs)项目，特别是功能`hdfs.write`或`hdfs.copy`应该做同样的事情。

# cuda - CUDA：写入共享内存会大大增加内核时间执行

> ID：15430027
> 
> 赞同：0
> 
> 时间：2013-03-15T10:31:20.693
> 
> 标签：cuda

我正在尝试在 CUDA 的帮助下减少 65536 个元素数组（计算其中元素的总和）。内核如下所示（请暂时忽略 *dev_distanceFloats 和索引参数）

```
__global__ void kernel_calcSum(float *d, float *dev_distanceFloats, int index) {
  int tid = threadIdx.x;
  float mySum = 0;
  for (int e = 0; e < 256; e++) {
    mySum += d[tid + e];
  }
} 
```

ant 它作为一个具有 256 个线程的块启动：

```
kernel_calcSum <<<1,  256 >>>(dev_spFloats1, dev_distanceFloats, index); 
```

到目前为止，一切顺利，256 个线程中的每一个都从全局内存中获取 256 个元素，并在局部变量 mySum 中计算它的总和。内核执行时间约为 45 毫秒。下一步是在块中的这 256 个线程之间引入共享内存（以计算 mySum 的总和），因此内核变为如下：

```
__global__ void kernel_calcSum(float *d, float *dev_distanceFloats, int index) {
  __shared__ float sdata[256];
  int tid = threadIdx.x;
  float mySum = 0;
  for (int e = 0; e < 256; e++) {
    mySum += d[tid + e];
  }
  sdata[tid] = mySum;
} 
```

我刚刚添加了对共享内存的写入，但执行时间从 45 毫秒增加到 258 毫秒（我在 NVidia Visual Profiler 5.0.0 的帮助下对此进行了检查）。我意识到在写入 sdata 变量时每个线程有 8 个存储库冲突（我在 GTX670 上，它具有 32 个存储库的能力 3.0）。作为一个实验——我尝试在启动内核时将线程数减少到 32 个——但时间仍然是 258 毫秒。

问题 1：为什么在我的情况下写入共享内存需要这么长时间？问题 2：是否有任何工具可以详细显示“执行计划”（内存访问时间、冲突等）？

感谢您的建议。

**更新：** 使用内核 - 我将 sdata 设置为每个线程的某个常量：

```
__global__ void kernel_calcSum(float *d, float *dev_distanceFloats, int index) {
  __shared__ float sdata[256];
  int tid = threadIdx.x;
  float mySum = 0;
  for (int e = 0; e < 256; e++) {
    mySum += d[tid + e];
  }
  sdata[tid] = 111;
} 
```

时间回到 48 毫秒。所以，改变 sdata[tid] = mySum; 到 sdata[tid] = 111; 做了这个。

这个编译器优化（可能只是删除了这一行？）还是出于某种原因从本地内存（寄存器？）复制到共享需要很长时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:06:10.543

您的两个内核都不做任何事情，因为它们不会将结果写入内核完成后仍可访问的内存。

在第一种情况下，编译器足够聪明地注意到这一点并优化整个计算。在涉及共享内存的第二种情况下，编译器不会注意到这一点，因为通过共享内存的信息流将更难跟踪。因此，它留下了计算。

传入一个指向全局内存的指针（就像你已经做的那样）并通过这个指针写出结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:37:11.897

共享内存不适合这个。你需要的是warp原子操作，在warp中总结，然后在warp之间传达中间结果。有示例代码演示了这种与 CUDA 一起发布的内容。

总结元素是大规模并行化无济于事的任务之一，实际上 GPU 可以被 CPU 超越。

# ms-access - 如何在VB中获取上个月的开始和结束

> ID：15430035
> 
> 赞同：13
> 
> 时间：2013-03-15T10:31:40.827
> 
> 标签：ms-access, vba

我试图创建一些 VB 代码来获取上个月的开始和结束。我能够到当前月份，这只是：

```
Month(DateValue(Now)) 
```

这将返回 3。从那里我可以带走 1 给我 2 意思是二月。这很好，但是当我在一月份我重复这个并且它给我零时 - 我的代码将失败。有谁知道如何获得前几个月的开始和结束日期？

谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-15T10:44:50.023

上个月的第一天始终为 1，要获取上个月的最后一天，请将 0 与 DateSerial 一起使用：

```
''Today is 20/03/2013 in dd/mm/yyyy
DateSerial(Year(Date),Month(Date),0) = 28/02/2013 
DateSerial(Year(Date),1,0) = 31/12/2012 
```

你可以像这样从上面得到第一天：

```
LastDay = DateSerial(Year(Date),Month(Date),0)
FirstDay = LastDay-Day(LastDay)+1 
```

另请参阅：[如何在 VBScript 中计算每月的最后一个工作日](https://stackoverflow.com/questions/302597/how-to-caculate-last-business-day-of-month-in-vbscript/302652#302652)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-02-07T01:09:29.393

第一天和最后一天我有类似的公式

每月第一天

```
FirstDay = DateSerial(Year(Date),Month(Date),1) 
```

下个月的零日是该月的最后一天

```
LastDay = DateSerial(Year(Date),Month(Date)+ 1,0) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-15T11:01:40.260

```
firstDay = DateSerial(Year(DateAdd("m", -1, Now)), Month(DateAdd("m", -1, Now)), 1)
lastDay = DateAdd("d", -1, DateSerial(Year(Now), Month(Now), 1)) 
```

这是另一种方法，但我认为 Remou 的版本看起来更干净。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-09T10:05:18.967

试试这个

```
First_Day_Of_Previous_Month = New Date(Today.Year, Today.Month, 1).AddMonths(-1)

Last_Day_Of_Previous_Month = New Date(Today.Year, Today.Month, 1).AddDays(-1) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-08T15:29:43.207

这在我的主子中对我来说很可靠。

```
Dim defDate1 As Date, defDate2 As Date

'** Set default date range to previous month
defDate1 = CDate(Month(Now) & "/1/" & Year(Now))
defDate1 = DateAdd("m", -1, defDate1)
defDate2 = DateAdd("d", -1, DateAdd("m", 1, defDate1)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T10:41:27.783

试试这个以数字形式获取月份：

```
Month(DateAdd("m", -3, Now)) 
```

它会给你`12`十二月的。

因此，在您的情况下，您将`Month(DateAdd("m", -1, Now))`过去只减去一个月。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-29T21:04:27.803

只是在@Fionnuala 所说的内容中添加一些内容，可以使用以下功能。这些甚至适用于闰年。

```
'If you pass #2016/20/01# you get #2016/31/01#
Public Function GetLastDate(tempDate As Date) As Date
    GetLastDate = DateSerial(Year(tempDate), Month(tempDate) + 1, 0)
End Function

'If you pass #2016/20/01# you get 31
Public Function GetLastDay(tempDate As Date) As Integer
    GetLastDay = Day(DateSerial(Year(tempDate), Month(tempDate) + 1, 0))
End Function 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-29T15:19:14.830

```
Public Shared Function GetFOMPrev(ByVal tdate As Date) As Date
    Return tdate.AddDays(-(tdate.Day - 1))
End Function

Public Shared Function GetEOMPrev(ByVal tdate As Date) As Date
    Return tdate.AddDays(-tdate.Day)
End Function 
```

用法：

```
'Get End of Month of Previous Month - Pass today's date
EOM = GetEOMPrev(Date.Today)

'Get First of Month of Previous Month - Pass date just calculated
FOM = GetFOMPrev(EOM) 
```

# javascript - 使用jquery在文本框上设置焦点时的IE-10光标位置

> ID：15430038
> 
> 赞同：1
> 
> 时间：2013-03-15T10:31:44.553
> 
> 标签：javascript, jquery, internet-explorer-10

当在文本框上设置焦点时，我在 IE -10(window -7 SP-1) 中遇到问题。我的光标位置在文本框中的开头。如何设置文本框值的位置结束。

[DEMO](http://jsfiddle.net/hcYTT/230/) 我正在尝试解决这个问题的 j-query 代码——

```
var input = $("#txt1"); // textbox Id

var len = input.val().length;

input[0].focus();

input[0].setSelectionRange(len, len); 
```

[尝试使用 JQUERY 代码](http://jsfiddle.net/9Du7T/)

WITH JQUERY 问题已解决，但为什么光标设置从 IE-10（window -7 SP-1）开始？

以及任何其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:40:18.747

这似乎是浏览器的一个实现选择。我在 HTML 规范中找不到任何地方，它说当文本输入获得焦点时光标应该定位在哪里。如果你用鼠标给输入焦点，光标在IE10、Firefox和Chrome中的点击位置，但没有点击事件，浏览器似乎在做自己的事情——例如Chrome，似乎选择了整个输入的内容。

# sharepoint - sharepoint 中的 spweb 和 spcontext 有什么区别？

> ID：15430040
> 
> 赞同：0
> 
> 时间：2013-03-15T10:31:46.317
> 
> 标签：sharepoint, web-parts

当我们需要使用 webcontext 时 spweb 和 spcontext 有什么区别 请任何人都可以回答我。

```
spweb web =spcontext.current.web; 
```

和

```
using(spsite site= new spsite(""))
{
using(spweb web=site.openweb(""))
{
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:45:47.487

简单来说

```
using(spsite site= new spsite(""))
    {
    using(spweb web=site.openweb(""))
    {
    }
    } 
```

上面的和上面的差不多

```
spweb web =spcontext.current.web; 
```

但是，您需要证明 URL 以获取您的站点对象的顶部代码片段，并使用

```
using(){
} 
```

您将自动处理对象站点和 Web 对象。

这

```
spweb web =spcontext.current.web; 
```

获取代码正在运行的当前 Web 的上下文。重要的是不要释放此对象。

这完全取决于您的代码是否在您需要 Web 或站点对象的站点的上下文中运行。

# jsf-2 - 是否可以从共享资源访问 JSF 2 非共享资源

> ID：15430042
> 
> 赞同：0
> 
> 时间：2013-03-15T10:31:48.373
> 
> 标签：jsf-2

是否可以从打包为 JAR 文件并放置在 WEB-INF/lib 文件夹中的共享资源中访问非共享资源（Web 应用程序资源 XHTML / CSS）。

例如。应用
--views
---layout
----template.xhtml

--WEB-INF
----lib
------jar1
--- ----META-INF
----------资源
------------视图 --------------index.xhtml

在上面的结构中index.xhtml可以复用template.xhtml吗？我想拥有特定于应用程序的模板，而不是从共享模板中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T20:37:45.980

@Partlov，

正如我之前提到的，已经通过提供从应用程序上下文而不是从当前文件夹开始的相对路径来解决。

在 facelet 标记声明中使用`template=/views/layout/template.xhtml`而不是`template=layout/template.xhtml`in`WEB-INF/lib/jar1/Index.xhtml`

@BalusC，感谢您的留言。我同意你的评论。

# java - 获取整数中设置位的位置

> ID：15430050
> 
> 赞同：4
> 
> 时间：2013-03-15T10:31:56.117
> 
> 标签：java, bit-manipulation

我正在使用以下技巧来遍历 int 的位集：

```
 while (b != 0)
    {
        c = b & (0 - b);
        //Do something...
        b = b ^ c;
    } 
```

以数字 4128（二进制 0001000000100000）为例，因为 c 的值是 32 和 4096，所以可以正常工作。

但是，我想要的不是实际值，而是这些值的位置，它们是 5 和 12。

是否有额外的代码行可以插入到返回位置的循环中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T12:51:41.623

您可以使用`Integer.numberOfTrailingZeros`来获取位索引，如下所示：

```
while (b != 0)
{
    c = b & (0 - b);
    int index = Integer.numberOfTrailingZeros(c);
    //Do something...
    b = b ^ c;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:57:21.440

不是一个有效的答案，但要尊重你正在使用的技巧。我把它改成了`b &= (b - 1)`.

```
int bitCount(int b) {
    int bits = 0;
    while (b != 0) {
        int nextb = b & (b - 1); // Remove the rightmost bit 1

        int power2ofBitIx = b ^ nextb; // Get the lost bit   10..0
        int bitIx = bitCount(power2ofBitIx - 1); // And count 1..1
        // Do something with bitIx

        b = nextb;
        ++bits;
    }
    return bits;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:38:40.213

阅读 Jerry Coffin 的[回答](https://stackoverflow.com/questions/3142867/finding-bit-positions-in-an-unsigned-32-bit-integer)。

您可以使用掩码获取 int 的设置位的位置并对每个位进行 AND 运算：

```
int c = 4128;
int two_32 = pow(2, 32);
for (int mask = 1, iter = 1; mask < two_32; mask <<= 1, iter++)
    if (c & mask)
        printf("Flag: %d set\n", iter); 
```

这应该打印：

```
Flag: 0 set 
Flag: 5 set 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-16T22:57:57.033

如果你要制作一个位棋盘游戏，你不应该需要位的位置，而是值。

我以前从未见过你的 while 循环，很好。我个人喜欢这个：

```
int tst = 255;

for(int looper = tst, i = Integer.highestOneBit(looper); looper != 0; looper &= ~i, i = Integer.highestOneBit(looper))
{
    System.out.println(i);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-15T12:26:20.717

公共布尔isBitSet（int位置）{

```
 int value = Integer.parseInt("0000000000000000000000000000000", 2);
    BigInteger b = new BigInteger(String.valueOf(value));
    b = b.setBit(4);
    return b.testBit(4); 
```

}

# c# - 用C#下载excel文件

> ID：15430051
> 
> 赞同：1
> 
> 时间：2013-03-15T10:32:00.437
> 
> 标签：c#, asp.net, excel, interop

我编写了一个 excel 互操作代码来生成 excel 工作表报告。生成报告并保存在一个文件夹中。在此之后，我想下载同一个文件，并且我在同一个应用程序中编写了一个代码进行下载。文件格式为 .xlsx。下载时出现以下错误。

```
Cannot open the file, file fotmat may be different or file may be corrected. 
```

但是如果我直接去驱动器，我可以打开同一个文件。

**下载代码**：

```
private void DownloadFile(string getpathfromappconfig, string FileName)
{
    string path = @getpathfromappconfig + "\\" + FileName + ".xlsx";
    System.IO.FileInfo file = new System.IO.FileInfo(path);
    string Outgoingfile = FileName + ".xlsx"; 
    if (file.Exists)
    { 
        Response.Clear();
        Response.AddHeader("Content-Disposition", "attachment; filename=" + Outgoingfile);
        Response.AddHeader("Content-Length", file.Length.ToString());
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        Response.WriteFile(file.FullName);

    }
    else
    {
        Response.Write("This file does not exist.");
    }

} 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:37:40.443

您可以尝试使用此代码

```
Response.ContentType = "application/vnd.ms-excel" 
```

替换这个

```
Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"; 
```

或者您可以尝试使用此代码

```
 Excel.Application xlApp ;
            Excel.Workbook xlWorkBook ;
            Excel.Worksheet xlWorkSheet ;
            object misValue = System.Reflection.Missing.Value;

            xlApp = new Excel.ApplicationClass();
            xlWorkBook = xlApp.Workbooks.Open("YourFile.xls", 0, true, 5, "", "", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
            xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);

            //your treatment ...

            xlWorkBook.Close(true, misValue, misValue);
            xlApp.Quit();

            //Clean your objects 
```

# java - java.lang.reflect.Field 实例在单个类加载器中是唯一的吗？

> ID：15430055
> 
> 赞同：1
> 
> 时间：2013-03-15T10:32:07.780
> 
> 标签：java, synchronization, classloader

我在 Field 对象中同步了一些 java 代码。看起来像：

```
Field f = SomeClass.class.getDeclaredField("field1");
synchronized(f) {
  ....
} 
```

java可以确保每次我通过反射获得一个Field对象，它总是同一个实例吗？所以我可以在上面同步代码块。我知道 Class 可以，但不确定 Field。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:38:03.700

这个简单的例子表明它不是同一个实例（它打印错误）。你为什么要在一个`Field`对象上同步呢？我想你意识到它不等同于锁定基础变量。

您应该解释*为什么*要这样做，因为肯定有更好的选择。

```
class Test {

    int i;

    public static void main(String[] args) throws Exception {
        Class c = Test.class;
        Field f1 = c.getDeclaredField("i");
        Field f2 = c.getDeclaredField("i");
        System.out.println(f1 == f2); //prints false
    }
} 
```

# c++ - Qt Creator 没有 Qt 应用程序的选项

> ID：15430058
> 
> 赞同：4
> 
> 时间：2013-03-15T10:32:19.183
> 
> 标签：c++, qt, qt-creator, qmake

我已经安装了基于 Qt 4.8.3（32 位）的 Qt Creator v2.6.2。当我开始新项目时，我找不到“Qt C++ 应用程序”选项卡。

它只显示库、其他项目、非 Qt 项目和导入项目

我在这里想念什么？

谢谢b4

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T06:24:45.913

转到**Tools -> Options -> Build & Run > Qt Versions**选项卡并检查您安装的 Qt 版本是否被识别。如果列表为空，则意味着：由于某种原因，Qt Creator 已停止检测您的 Qt 库。

**要解决此问题，请在该对话框“工具 -> 选项 -> 构建和运行 > Qt 版本**”中按“添加”按钮并找到已安装的“qmake.exe”文件。它应该在您安装 Qt 库的 bin 目录中（例如 C > Qt > 4.8.4 > bin > qmake.exe ）。如果仍然无法识别，您应该寻找最简单的方法，例如安装“qt SDK”来处理所有事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:31:44.080

您可能还没有配置 Qt 构建工具。您必须安装 Qt Creator、Qt 库、MinGW 编译器（对于 Qt 4 -- MinGW 4.4）。

在 Tools -> Options -> Build & Run 中，您必须指定所有路径（对于 MinGW 编译器，用于`qmake`并创建工具链以将 MinGW 编译器与具体`qmake`）。因此，您将拥有构建 Qt 项目的有效工具链。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:56:10.450

尝试在创建者选项中设置 qt 安装。它是工具 -> 选项 -> 构建和运行 -> Qt 版本，如果没有绑定安装，则添加一个。我不确定这是否有帮助，但值得一试。

您也可以手动创建项目并将其导入创建者。

创建一个 main.cpp 文件，其内容如下

```
#include <QApplication>
#include <QWidget>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    QWidget w;
    w.show();
    return a.exec();
} 
```

并创建一个 .pro 文件，其内容：

```
QT       += core gui

TARGET = Test

SOURCES += main.cpp 
```

之后尝试将您的 .pro 文件导入创建者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T13:49:38.980

我找到了答案。原来我指向的 qmake.exe 在文件夹中

```
C:\Qt\4.8.4\qmake\qmake.exe 
```

这是错误的，路径应该是

```
C:\Qt\4.8.4\bin\qmake.exe 
```

现在“Qt C++ 应用程序”已显示在选项卡上

感谢所有的帮助 b4

# mvvm - 在 Prism EventAggregator 中发布没有 PayLoad 的事件？

> ID：15430059
> 
> 赞同：12
> 
> 时间：2013-03-15T10:32:24.547
> 
> 标签：mvvm, prism, silverlight-5.0

为什么我们不能在没有任何 PayLoad 的情况下发布事件。

```
 _eventAggregator.GetEvent<SelectFolderEvent>().Publish(new SelectFolderEventCriteria() { }); 
```

现在，我不需要在这里传递任何有效负载。但是 EventAggregator 实现要求我有一个空类来做到这一点。

事件：

```
 public class SelectFolderEvent : CompositePresentationEvent<SelectFolderEventCriteria>
  {
  } 
```

有效载荷：

```
 public class SelectFolderEventCriteria
  {
  } 
```

为什么 Prism 没有提供一种仅使用 Event 并像这样发布它的方法

```
 _eventAggregator.GetEvent<SelectFolderEvent>().Publish(); 
```

是设计使然，我不明白吗？请解释。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T11:35:13.200

好问题，我看不出没有有效负载不发布事件的理由。在某些情况下，已引发事件的事实就是您需要和想要处理的所有信息。

有两种选择：由于它是开源的，因此您可以获取 Prism 源并提取不带有效负载的 CompositePresentation 事件。

我不会那样做，但将 Prism 作为第 3 方库处理并保持原样。为 3rd 方库编写[Facade](http://en.wikipedia.org/wiki/Facade_pattern)以使其适合您的项目是一种很好的做法，在本例中为`CompositePresentationEvent`. 这可能看起来像这样：

```
public class EmptyPresentationEvent : EventBase
{
    /// <summary>
    /// Event which facade is for
    /// </summary>
    private readonly CompositePresentationEvent<object> _innerEvent;

    /// <summary>
    /// Dictionary which maps parameterless actions to wrapped 
    /// actions which take the ignored parameter 
    /// </summary>
    private readonly Dictionary<Action, Action<object>> _subscriberActions;

    public EmptyPresentationEvent()
    {
        _innerEvent = new CompositePresentationEvent<object>();
        _subscriberActions = new Dictionary<Action, Action<object>>();
    }

    public void Publish()
    {
        _innerEvent.Publish(null);
    }

    public void Subscribe(Action action)
    {
        Action<object> wrappedAction = o => action();
        _subscriberActions.Add(action, wrappedAction);
        _innerEvent.Subscribe(wrappedAction);
    }

    public void Unsubscribe(Action action)
    {
        if (!_subscriberActions.ContainsKey(action)) return;
        var wrappedActionToUnsubscribe = _subscriberActions[action];
        _innerEvent.Unsubscribe(wrappedActionToUnsubscribe);
        _subscriberActions.Remove(action);
    }
} 
```

如果有什么不清楚的，请询问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-10T16:28:51.170

只是为了更新自从提出/回答了这个问题以来的情况，从 Prism 6.2 开始，Prism PubSubEvents 现在支持空有效负载。

如果您使用的是旧版本，此博客将展示如何创建一个“Empty”类来清楚地表明有效负载的意图：[https ://blog.davidpadbury.com/2010/01/01/empty-type-parameters /](https://blog.davidpadbury.com/2010/01/01/empty-type-parameters/)

# sql - 从单个列中选择多个值

> ID：15430065
> 
> 赞同：0
> 
> 时间：2013-03-15T10:32:37.727
> 
> 标签：sql

如果现在一整天都在做这个查询，我似乎无法理解它。如果你能指出我正确的方向或告诉我我想寻找什么功能，那将意味着很多。我试过在 SQL 中查看 Pivot、Case、Union 和 Group by 函数，但没有运气……但它看起来很简单

我正在从多个表中进行选择。其中一个表包含一行，其中包含我需要在选择中返回的多个值。

SQL：

```
(SELECT        ONYAK_SIGMAPRO_Issues.IssueId, 
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Work Ticket], 
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Customer Name],
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Job Description],
                           ONYAK_SIGMAPRO_ProjectCategories.CategoryName AS [Printer], 
                           ONYAK_SIGMAPRO_Issues.IssueTitle AS [Task Description], 
                ONYAK_SIGMAPRO_Issues.Progress, 
                           ONYAK_SIGMAPRO_ProjectStatus.StatusName AS [Status], 
                           ONYAK_SIGMAPRO_ProjectPriorities.PriorityName AS [Priority], 
                ONYAK_SIGMAPRO_Issues.DateDue
FROM            (ONYAK_SIGMAPRO_Issues INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCustomFieldValues ON ONYAK_SIGMAPRO_Issues.IssueId = ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCustomFields ON 
                         ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId AND 
                         ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCustomFields.ProjectId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectStatus ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectStatus.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssueStatusId = ONYAK_SIGMAPRO_ProjectStatus.StatusId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectPriorities ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectPriorities.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssuePriorityId = ONYAK_SIGMAPRO_ProjectPriorities.PriorityId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCategories ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCategories.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssueCategoryId = ONYAK_SIGMAPRO_ProjectCategories.CategoryId
                                         ) 
WHERE        ONYAK_SIGMAPRO_Issues.ProjectId = 2
AND ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId = 1

UNION all

SELECT        ONYAK_SIGMAPRO_Issues.IssueId, 
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Work Ticket], 
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Customer Name],
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Job Description],
                           ONYAK_SIGMAPRO_ProjectCategories.CategoryName AS [Printer], 
                           ONYAK_SIGMAPRO_Issues.IssueTitle AS [Task Description], 
                ONYAK_SIGMAPRO_Issues.Progress, 
                           ONYAK_SIGMAPRO_ProjectStatus.StatusName AS [Status], 
                           ONYAK_SIGMAPRO_ProjectPriorities.PriorityName AS [Priority], 
                ONYAK_SIGMAPRO_Issues.DateDue
FROM            ONYAK_SIGMAPRO_Issues INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCustomFieldValues ON ONYAK_SIGMAPRO_Issues.IssueId = ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCustomFields ON 
                         ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId AND 
                         ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCustomFields.ProjectId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectStatus ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectStatus.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssueStatusId = ONYAK_SIGMAPRO_ProjectStatus.StatusId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectPriorities ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectPriorities.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssuePriorityId = ONYAK_SIGMAPRO_ProjectPriorities.PriorityId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCategories ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCategories.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssueCategoryId = ONYAK_SIGMAPRO_ProjectCategories.CategoryId
WHERE        ONYAK_SIGMAPRO_Issues.ProjectId = 2
AND ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId = 4

UNION all

SELECT        ONYAK_SIGMAPRO_Issues.IssueId, 
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Work Ticket], 
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Customer Name],
                           ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue AS [Job Description],
                           ONYAK_SIGMAPRO_ProjectCategories.CategoryName AS [Printer], 
                           ONYAK_SIGMAPRO_Issues.IssueTitle AS [Task Description], 
                ONYAK_SIGMAPRO_Issues.Progress, 
                           ONYAK_SIGMAPRO_ProjectStatus.StatusName AS [Status], 
                           ONYAK_SIGMAPRO_ProjectPriorities.PriorityName AS [Priority], 
                ONYAK_SIGMAPRO_Issues.DateDue
FROM            ONYAK_SIGMAPRO_Issues INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCustomFieldValues ON ONYAK_SIGMAPRO_Issues.IssueId = ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCustomFields ON 
                         ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId AND 
                         ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCustomFields.ProjectId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectStatus ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectStatus.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssueStatusId = ONYAK_SIGMAPRO_ProjectStatus.StatusId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectPriorities ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectPriorities.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssuePriorityId = ONYAK_SIGMAPRO_ProjectPriorities.PriorityId INNER JOIN
                         ONYAK_SIGMAPRO_ProjectCategories ON ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCategories.ProjectId AND 
                         ONYAK_SIGMAPRO_Issues.IssueCategoryId = ONYAK_SIGMAPRO_ProjectCategories.CategoryId
WHERE        ONYAK_SIGMAPRO_Issues.ProjectId = 2
AND ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId = 9)
ORDER BY ONYAK_SIGMAPRO_Issues.IssueId 
```

结果：

```
IssueId工作单 客户姓名 职位描述打印机任务描述 进度状态 优先级 DateDue
1070 8828 8828 8828 海德堡宣传册 0 艺术作品 高 00:00.0
1070 小册子 小册子 海德堡小册子 0 艺术作品 高 00:00.0
1070 Liberty Life 自由生活 Liberty Life 海德堡宣传册 0 艺术作品 高 00:00.0
1082 Liberty Life 自由生活 Liberty Life 海德堡（宣传册 0 艺术作品 高 00:00.0
1082 小册子 小册子 小册子 海德堡 (brochures 0 Art Work High 00:00.0
1082 8294 8294 8294 海德堡（宣传册 0 艺术作品 高 00:00.0
1086 8295 8295 8295 海德堡（宣传册 0 艺术作品 高 00:00.0
1086 稳定增长手册 稳定增长手册 稳定增长手册 海德堡（手册 0 Art Work High 00:00.0
1086 Liberty Life 自由生活 Liberty Life 海德堡（宣传册 0 艺术作品 高 00:00.0
1090 Liberty Life Liberty Life 自由生活 Kamori（VAS 卡 0 艺术品高 00:00.0
1090 VAS 卡 VAS 卡 VAS 卡 Kamori (VAS Card 0 Art Work High 00:00.0
1090 8296 8296 8296 Kamori (VAS Card 0 Art Work High 00:00.0
1104 8300 8300 8300 海德堡 菜单文本 0 艺术作品 高 00:00.0
1104 菜单文本 菜单文本 菜单文本 海德堡 菜单文本 0 艺术作品 高 00:00.0
1104 南非航空公司 南非航空公司 南非航空公司 海德堡 菜单文本 0 艺术作品 高 00:00.0

```

粗体栏给我带来了麻烦。

我希望选择返回以下内容：

```
IssueId 工作单 客户姓名 职位描述 打印机任务描述 进度状态 优先级 DateDue
1070 8828 自由生活手册 海德堡手册 0 艺术作品 高 00:00.0
1082 8294 8294 小册子 Heidelberg (brochures 0 Art Work High 00:00.0
1086 8295 Liberty Life 海德堡自由生活 (宣传册 0 艺术作品 高 00:00.0
1090 8296 Liberty Life VAS 卡 Kamori (VAS Card 0 Art Work High 00:00.0
1104 8300 南非航空公司菜单文本海德堡菜单文本 0 艺术作品高 00:00.0

```

我可以使用什么功能或选择类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:04:19.453

我仍在努力，但我要说的第一件事在这里有用的是你不需要在这种情况下继续使用 UNION ALL （除非我错过了什么）......只需使用一个 SELECT 查询（不unions) 并将 WHERE 子句更改为如下所示：

```
WHERE ONYAK_SIGMAPRO_Issues.ProjectId = 2
AND ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId IN (1,4,9) 
```

先尝试一下，看看你会得到什么......然后告诉我们

**编辑**

根据您在给定链接上发布的屏幕截图（这使问题更容易看到），我可以看到您需要使用`DISTINCT`关键字。基本上：SELECT DISTINCT 等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T11:15:24.290

@Matt 简单地使用 DISTINCT 返回与以前相同的结果。这是因为我在选择中从与“IssueId”不同的表中选择“CustomFieldId”列 3 次。但是当我在选择中使用子查询时，我得到了我想要的结果。

```
SELECT DISTINCT(ONYAK_SIGMAPRO_Issues.IssueId), 
    (SELECT ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue
    FROM ONYAK_SIGMAPRO_ProjectCustomFieldValues INNER JOIN
        ONYAK_SIGMAPRO_Issues ON ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId = ONYAK_SIGMAPRO_Issues.IssueId INNER JOIN
        ONYAK_SIGMAPRO_ProjectCustomFields ON 
        ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId
            WHERE (ONYAK_SIGMAPRO_Issues.ProjectId = 2) AND (ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId = 1) AND ONYAK_SIGMAPRO_Issues.IssueId = 1070)  AS [Work Ticket], 
    (SELECT ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue
    FROM ONYAK_SIGMAPRO_ProjectCustomFieldValues INNER JOIN
        ONYAK_SIGMAPRO_Issues ON ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId = ONYAK_SIGMAPRO_Issues.IssueId INNER JOIN
        ONYAK_SIGMAPRO_ProjectCustomFields ON 
        ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId
            WHERE (ONYAK_SIGMAPRO_Issues.ProjectId = 2) AND (ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId = 4) AND ONYAK_SIGMAPRO_Issues.IssueId = 1070) AS [Customer Name],
    (SELECT ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldValue
    FROM ONYAK_SIGMAPRO_ProjectCustomFieldValues INNER JOIN
        ONYAK_SIGMAPRO_Issues ON ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId = ONYAK_SIGMAPRO_Issues.IssueId INNER JOIN
        ONYAK_SIGMAPRO_ProjectCustomFields ON 
        ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId
            WHERE (ONYAK_SIGMAPRO_Issues.ProjectId = 2) AND (ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId = 9) AND ONYAK_SIGMAPRO_Issues.IssueId = 1070) AS [Job Description],
    ONYAK_SIGMAPRO_ProjectCategories.CategoryName AS [Printer], 
    ONYAK_SIGMAPRO_Issues.IssueTitle AS [Task Description], 
    ONYAK_SIGMAPRO_Issues.Progress, 
    ONYAK_SIGMAPRO_ProjectStatus.StatusName AS [Status], 
    ONYAK_SIGMAPRO_ProjectPriorities.PriorityName AS [Priority], 
    ONYAK_SIGMAPRO_Issues.DateDue
        FROM ONYAK_SIGMAPRO_Issues INNER JOIN
        ONYAK_SIGMAPRO_ProjectCustomFieldValues ON 
        ONYAK_SIGMAPRO_Issues.IssueId = ONYAK_SIGMAPRO_ProjectCustomFieldValues.IssueId INNER JOIN
        ONYAK_SIGMAPRO_ProjectCustomFields ON 
        ONYAK_SIGMAPRO_ProjectCustomFieldValues.CustomFieldId = ONYAK_SIGMAPRO_ProjectCustomFields.CustomFieldId AND 
        ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCustomFields.ProjectId INNER JOIN
        ONYAK_SIGMAPRO_ProjectStatus ON 
        ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectStatus.ProjectId AND 
        ONYAK_SIGMAPRO_Issues.IssueStatusId = ONYAK_SIGMAPRO_ProjectStatus.StatusId INNER JOIN
        ONYAK_SIGMAPRO_ProjectPriorities ON 
        ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectPriorities.ProjectId AND 
        ONYAK_SIGMAPRO_Issues.IssuePriorityId = ONYAK_SIGMAPRO_ProjectPriorities.PriorityId INNER JOIN
        ONYAK_SIGMAPRO_ProjectCategories ON 
        ONYAK_SIGMAPRO_Issues.ProjectId = ONYAK_SIGMAPRO_ProjectCategories.ProjectId AND 
        ONYAK_SIGMAPRO_Issues.IssueCategoryId = ONYAK_SIGMAPRO_ProjectCategories.CategoryId  
            WHERE ONYAK_SIGMAPRO_Issues.ProjectId = 2
            AND ONYAK_SIGMAPRO_Issues.IssueId = 1070 
```

我如何需要显示所有数据而不仅仅是一个 ID。

我确实通过将“CustomFieldId”选择到 3 个不同的临时表中解决了这个问题，然后最后选择我合并所有表......这正是我想要的:)

# wpf - WPF listview virtualization with columns

> ID：15430068
> 
> 赞同：0
> 
> 时间：2013-03-15T10:32:51.513
> 
> 标签：wpf, listview, gridview, virtualization, recycle

I am trying to create a listview (5'000 items +) that has a smooth scrolling. I found a solution in the inet, that "virtualizationmode=Recycling" could do the trick.

Well I totally am lost, since I used a gridview in my old app. Now to virtualize the list I can not use gridview anymore, as I read in another post.

How can I bring that to work? I want to bind the items using an observalcollection and I need a Header.

Here is my old listview with gridview:

```
<ListView x:Name="ListView_Main" Grid.Column="4" Grid.RowSpan="18" BorderBrush="#FFE87E00" Foreground="#FFE87E00" Background="Transparent" VirtualizingStackPanel.IsVirtualizing="true"  VirtualizingStackPanel.VirtualizationMode="Recycling">
                <ListView.View>
                    <GridView x:Name="GridView_ListHeader" AllowsColumnReorder="False">
                        <!--CheckBox-->
                        <GridViewColumn x:Name="GridViewColumn_Check" Width="25" Header=""><GridViewColumn.CellTemplate><DataTemplate><StackPanel>
                            <!---Tag = Index-->
                            <CheckBox IsChecked="{Binding Checked}" Tag="{Binding Index}"/></StackPanel></DataTemplate></GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <!--CheckImage-->
                        <GridViewColumn x:Name="GridViewColumn_CheckFake" Width="25" Header=""><GridViewColumn.CellTemplate><DataTemplate><StackPanel>
                                        <Grid Height="17" Width="17" VerticalAlignment="Center" HorizontalAlignment="center">
                                            <Canvas Background="{Binding Color}" Margin="3" Cursor="Hand" Tag="{Binding Index}" MouseLeftButtonDown="Canvas_ListIcon_MouseLeftButtonDown" MouseEnter="Canvas_ListIcon_MouseEnter" MouseLeave="Canvas_ListIcon_MouseLeave"><Canvas.OpacityMask>
                                                    <ImageBrush Stretch="UniformToFill" ImageSource="{Binding ImageCheckbox}" RenderOptions.BitmapScalingMode="NearestNeighbor" RenderOptions.EdgeMode="Aliased"/></Canvas.OpacityMask></Canvas></Grid></StackPanel></DataTemplate></GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <!--Source-->
                        <GridViewColumn x:Name="GridViewColumn_Icon"  Header="" Width="25"><GridViewColumn.CellTemplate><DataTemplate><StackPanel>
                                        <Grid Height="17" Width="17" VerticalAlignment="Center" HorizontalAlignment="center">
                                            <Canvas Background="{Binding Color}" Tag="{Binding Index}" Margin="3" MouseEnter="Canvas_SourceIcon_MouseEnter" MouseLeave="Canvas_SourceIcon_MouseLeave"><Canvas.OpacityMask>
                                                    <ImageBrush ImageSource="{Binding ImageSource}" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="NearestNeighbor" RenderOptions.EdgeMode="Aliased"/></Canvas.OpacityMask></Canvas></Grid></StackPanel></DataTemplate> </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <!--Pos-->
                        <GridViewColumn DisplayMemberBinding="{Binding Position}" x:Name="GridViewColumn_Pos" Width="50" Header="Pos"/>
                            <!--Entry-->
                        <GridViewColumn DisplayMemberBinding="{Binding Id}" x:Name="GridViewColumn_Entry" Width="200" Header="Eingabe"/>
                        <!--Sap-->
                        <GridViewColumn DisplayMemberBinding="{Binding SaperionNr}" x:Name="GridViewColumn_Sap" Width="100" Header="Saperion"/>
                        <!--Sup-->
                        <GridViewColumn DisplayMemberBinding="{Binding SupisNr}" x:Name="GridViewColumn_Sup" Width="100" Header="Navision"/>
                        <!--Path-->
                        <GridViewColumn DisplayMemberBinding="{Binding Path}" x:Name="GridViewColumn_Path" Width="150" Header="Pfad"/>
                        <!--Format-->
                        <GridViewColumn DisplayMemberBinding="{Binding Format}"  x:Name="GridViewColumn_Format" Width="50" Header="Format"/>
                        <!--Page-->
                        <GridViewColumn DisplayMemberBinding="{Binding Page}" x:Name="GridViewColumn_Page" Width="40" Header="Blatt"/>
                        <!--Stat-->
                        <GridViewColumn DisplayMemberBinding="{Binding Status}" x:Name="GridViewColumn_Stat" Width="175" Header="Status"/>
                    </GridView>
                </ListView.View>
            </ListView> 
```

Thank you in advance!!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:23:49.897

Listviews should by default have virtualization on. There are however case that nullifies their effect. I would by set a maxheight and ensure that ScrollViewer.VerticalScrollBarVisibility="Visible" is set.

# c - 通过 SSE/AVX 使用 OpenMP 减少

> ID：15430069
> 
> 赞同：6
> 
> 时间：2013-03-15T10:32:55.570
> 
> 标签：c, openmp, sse, avx

我想使用 OpenMP 和 SIMD 对数组进行缩减。我读到 OpenMP 的减少相当于：

```
inline float sum_scalar_openmp2(const float a[], const size_t N) {
    float sum = 0.0f;
    #pragma omp parallel
    {
        float sum_private = 0.0f;
        #pragma omp parallel for nowait
        for(int i=0; i<N; i++) {
            sum_private += a[i];
        }
        #pragma omp atomic
        sum += sum_private;
    }
    return sum;
} 
```

我从以下链接得到了这个想法：http: [//bisqwit.iki.fi/story/howto/openmp/#ReductionClause](http://bisqwit.iki.fi/story/howto/openmp/#ReductionClause) 但是原子也不支持复杂的运算符。我所做的是将 atomic 替换为 critical 并使用 OpenMP 和 SSE 实现缩减，如下所示：

```
#define ROUND_DOWN(x, s) ((x) & ~((s)-1))
inline float sum_vector4_openmp(const float a[], const size_t N) {
    __m128 sum4 = _mm_set1_ps(0.0f);
    #pragma omp parallel 
    {
        __m128 sum4_private = _mm_set1_ps(0.0f);
        #pragma omp for nowait
        for(int i=0; i < ROUND_DOWN(N, 4); i+=4) {
            __m128 a4 = _mm_load_ps(a + i);
            sum4_private = _mm_add_ps(a4, sum4_private);
        }
        #pragma omp critical
        sum4 = _mm_add_ps(sum4_private, sum4);
    }
    __m128 t1 = _mm_hadd_ps(sum4,sum4);
    __m128 t2 = _mm_hadd_ps(t1,t1);
    float sum = _mm_cvtss_f32(t2);  
    for(int i = ROUND_DOWN(N, 4); i < N; i++) {
        sum += a[i];
    }
    return sum;
} 
```

然而，这个功能并没有我希望的那么好。我正在使用 Visual Studio 2012 Express。我知道我可以通过展开 SSE 加载/添加几次来稍微提高性能，但这仍然低于我的预期。

通过运行等于线程数的数组切片，我获得了更好的性能：

```
inline float sum_slice(const float a[], const size_t N) {
    int nthreads = 4;
    const int offset = ROUND_DOWN(N/nthreads, nthreads);
    float suma[8] = {0};
    #pragma omp parallel for num_threads(nthreads) 
    for(int i=0; i<nthreads; i++) {
        suma[i] = sum_vector4(&a[i*offset], offset);
    }
    float sum = 0.0f;
    for(int i=0; i<nthreads; i++) {
        sum += suma[i]; 
    }
    for(int i=nthreads*offset; i < N; i++) {
        sum += a[i];
    }
    return sum;    
}

inline float sum_vector4(const float a[], const size_t N) {
    __m128 sum4 = _mm_set1_ps(0.0f);
    int i = 0;
    for(; i < ROUND_DOWN(N, 4); i+=4) {
        __m128 a4 = _mm_load_ps(a + i);
        sum4 = _mm_add_ps(sum4, a4);
    }
    __m128 t1 = _mm_hadd_ps(sum4,sum4);
    __m128 t2 = _mm_hadd_ps(t1,t1);
    float sum = _mm_cvtss_f32(t2);
    for(; i < N; i++) {
        sum += a[i];
    }
    return sum; 
```

}

有人知道是否有更好的方法来减少 OpenMP 中更复杂的运算符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T04:51:20.757

我想您的问题的答案是否定的。我认为在 OpenMP 中使用更复杂的运算符进行归约没有更好的方法。

假设数组是 16 位对齐的，openmp 线程的数量是 4，可以预期 OpenMP + SIMD 的性能增益是 12 倍 - 16 倍。实际上，它可能不会产生足够的性能增益，因为

1.  创建 openmp 线程会产生开销。
2.  该代码正在为 1 次加载操作执行 1 次加法操作。因此，CPU 没有进行足够的计算。因此，看起来 CPU 大部分时间都花在加载数据上，这是一种内存带宽限制。

# sql-update - 收到 IPN Paypal 后如何更新 status_payment？

> ID：15430070
> 
> 赞同：0
> 
> 时间：2013-03-15T10:32:56.020
> 
> 标签：sql-update, paypal-ipn

我知道更新 status_payment 订单已“完成”。代码执行以下操作

```
mysql_query("SELECT * FROM Transactions WHERE invoiceID=$_POST['invoice']"); 
```

在收到 IPN Paypal 之前。我应该为字段 invoiceID 存储什么值？？？

# android - 如何在Android中将二进制字符串转换为图像？

> ID：15430072
> 
> 赞同：0
> 
> 时间：2013-03-15T10:32:58.733
> 
> 标签：android, binary, inputstream, bitmapfactory

我正在使用 .net Web 服务 ksoap，我得到二进制字符串作为响应。我想将此字符串转换为图像并希望在 ImageView 中显示此图像。我正在从服务器获取图像/文档/pdf。

我的代码：

```
SoapObject DocumentRequest = new SoapObject(NAMESPACE, GET_DOCUMENT_METHOD);

        DocumentRequest.addProperty("DocumentID", ID);
        Log.i("DocumentID", ID);

        SoapSerializationEnvelope Envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        Envelope.dotNet = true;
        Envelope.setOutputSoapObject(DocumentRequest);
        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
        androidHttpTransport.debug = true;

        androidHttpTransport.call(SOAP_ACTION_GETDOCUMENT, Envelope);

        SoapPrimitive DocumentResponse = (SoapPrimitive)Envelope.getResponse();
        Log.i("DocumentResponse", DocumentResponse.toString()); 
```

我应该使用什么来显示任何类型的文件 image/doc/pdf。如何将此二进制字符串转换为正确的格式以及如何下载它？？？我感到很困惑。

//位图是个好主意吗？

这段代码在日志中以二进制形式给我响应。我想将其转换为 Image/doc 文件/pdf 文件并希望将其下载到本地 sd 卡中。

```
POST /**********Mobile/**********.asmx HTTP/1.1
Host: 192.168.1.5
Content-Type: text/xml; charset=utf-8
Content-Length: length
SOAPAction: "http://tempuri.org/GetDocument"

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     
xmlns:xsd="http://www.w3.org/2001/XMLSchema"    
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
 <GetDocument xmlns="http://tempuri.org/">
   <DocumentID>string</DocumentID>
 </GetDocument>
</soap:Body>
</soap:Envelope>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    
xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
 <soap:Body>
   <GetDocumentResponse xmlns="http://tempuri.org/">
     <GetDocumentResult>string</GetDocumentResult>
   </GetDocumentResponse>
 </soap:Body>
</soap:Envelope> 
```

请建议谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:44:21.110

理想情况下，您可以让 API 给您一个指向文档/图像的链接，然后您可以下载它。

在响应中包含二进制数据不仅会使您的代码复杂，而且还会使您解析。

**更新：** 将二进制字符串转换为文件，就像读取数据并将其写入文件一样简单。

我建议，不要在我的回复的第一部分使用这种方法。

# meteor - Meteor ad hoc 记录集

> ID：15430079
> 
> 赞同：1
> 
> 时间：2013-03-15T10:33:18.577
> 
> 标签：meteor

我正在编写一个应用程序，该应用程序涉及创建同一集合的多个子集，并[按照此示例在不同的记录集下发布它们。](https://stackoverflow.com/questions/12632452/publishing-subscribing-multiple-subsets-of-the-same-server-collection)

使用这个原则，我正在创建临时记录集。发布代码位于每个模板调用的方法中：

```
//Template
Template.item._item = function() {
    Meteor.call('publishMethod', foo);
    Meteor.subscribe('name-'+foo);
    return someFunction(foo);
}

//Method
Meteor.methods({ 
    'publishMethod' = function(foo) { 
        Meteor.publish('name-'+foo, function() { someFunction(foo); });
     });
});

//Common area
someFunction = function(foo) {
    return Collection.find({'foobar' : foo});
} 
```

在此示例中， someFunction() 位于客户端和服务器之间的公共区域。someFunction() 返回基于 foo 的集合的子集。

我对上述方法有一些疑问：

*   当使用相同的 foo 值调用方法时，Meteor 会打印“忽略名为 'name-foo' 的重复发布”。有什么方法可以检查记录集是否存在？
*   有人担心这些记录集将继续发布，而不是释放内存。这些记录集只是客户端吗？或者他们会在服务器上积累吗？

这是我发现在同一个大型数据集上处理多个复杂查询的最佳方法，并且允许每个请求和页面发送特定字段。但是，我愿意接受建议。

提前致谢。

# c++ - 这个 C++ 表达式如何解释为调用？

> ID：15430080
> 
> 赞同：0
> 
> 时间：2013-03-15T10:33:21.253
> 
> 标签：c++

在“Inside the C++ Object Model”中，作者给出了以下可能存在歧义的代码示例，需要解析器提前解决：

> ...如果 C++ 要抛弃 C 声明语法，则不需要先行来确定以下是 pf 的调用而不是其定义：
> 
> ```
> // don’t know if declaration or invocation 
> // until see the integer constant 1024 
> int ( *pf )( 1024 ); 
> ```

他暗示这被解释为函数的调用`pf`。我看不出声明`pf`可以使它成为有效的调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:36:44.577

`int ( *pf )( int);`- 这是声明

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T10:47:52.423

`int*`这是使用值 1024 初始化被调用的丑陋声明`pf`。但是，如果没有显式强制转换，这种转换是无效的：

```
int ( *pf )((int*)1024); 
```

所以问题中给出的行相当于：

```
int* pf = 1024; 
```

要了解原因，请考虑`int ((((*pf))));`与 相同`int* pf;`。您可以在声明符周围放置任意数量的括号。

> 在具有表单的声明`T D`中，包含的 declarator-id 的类型与声明中包含的*declarator* *-id*的类型相同 括号不会改变嵌入式*declarator-id*的类型，但它们可以改变复杂的绑定声明者。`D`
> `( D1 )`
>  **`T D1`**

 ***我看不出有任何理由将其视为函数调用。特别是考虑到它以`int`. 我可以看到它如何可能是函数指针的声明，直到它看到整数文字。例如，如果它是这样的：

```
int ( *pf )(int); 
```

这将是一个`pf`指向函数的类型指针的声明，该函数返回`int`并采用一个类型的参数`int`。***

# javascript - Javascript：切换加载 InnerHTML

> ID：15430084
> 
> 赞同：1
> 
> 时间：2013-03-15T10:33:34.440
> 
> 标签：javascript

```
<script>
    function toggle_table() {
        visibility = document.getElementById("table").style.visibility;
        document.getElementById("table").style.visibility = (visibility == 'visible') ? 'hidden' : 'visible';
        document.getElementById("toggle_table").innerHTML = (visibility == 'visible') ? 'Open' : 'Close';
    }
</script>

<form method='POST'>
    <a id='toggle_table' href='#' onClick='toggle_table()'>Open</a> WIJZIGEN PROCES
    <table id='table' style='visibility: hidden'>
    </table>
</form> 
```

这很好用。虽然我不想让它不可见，但我不想渲染 innerHTML（所以它在不可见时不会占用它的空间）。与此[问题](https://stackoverflow.com/questions/9694346/toggle-innerhtml)类似，尽管我无法使用 JQuery（要求）。这是用纯 JavaScript 以一种相当简单的方式，而不需要将整个 HTML 内容放在 Javascript 中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:36:52.290

使用`display`：

```
document.getElementById("table").style.display = (display == 'none') ? '' : 'none'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:36:55.343

使用`display:table`and`display:none`代替`visibility:hidden/visible`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:37:40.043

您可以尝试使用`display`属性

```
function toggle_table() {
    display = document.getElementById("table").style.display;
    document.getElementById("table").style.display= (display != 'none') ? 'none' : 'table';
    document.getElementById("toggle_table").innerHTML = (display== 'table') ? 'Open' : 'Close';
} 
```

# java - java - 如何在java中的AES加密中将加密数组的大小调整为16

> ID：15430085
> 
> 赞同：0
> 
> 时间：2013-03-15T10:33:35.140
> 
> 标签：java, aes, encryption

> 我想在 mycode 之后编写一个字节数组，它工作正常，但给出一个长大小的输出 newByteArray 我希望输出数组的大小应该是 16 是否可能

```
 byte [] keyForEncription= new byte[16];
        byte [] keyForDecription= new byte[16];
        long  FixedKey= 81985526925837671L;
        long  VariableKey=744818830;
            for (int i1 = 0; i1 < 8; i1++)
        {

            keyForEncription[i1] = (byte)(FixedKey >> (8 * i1));
            keyForEncription[i1 + 8] = (byte)(VariableKey >> (8 * i1));
        }

    byte[] data = new byte[255];

    data[0]= 2;
    data[1]= 0;
    data[2]= 0;
    data[3]= 0;
    data[4]= 0;
    data[5]= 6;
    data[6]= 6;
    data[7]= 81;
    data[8]= 124;
    data[9]= 123;
    data[10]= 123;
    data[11]= 12;
    data[12]= 3;
    data[13]= 27;
    data[15]= 12;
    data[16]= 0;
    data[17]= 0;
    data[18]= 0;
    data[19]= 0;

    System.out.println("Original byte Array : " +Arrays.toString(data));

    SecretKeySpec skeySpec = new SecretKeySpec(keyForEncription, "AES");
   Cipher cipher1 = Cipher.getInstance("AES/ECB/NoPadding");
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec);
    byte[] newByteArray = new byte[data.length];
    newByteArray = cipher.doFinal(byteArray);
    System.out.println("Encrypted Array : " +Arrays.toString(newByteArray)); 
```

> 这是输出加密数组： [110, -118, -119, -88, 73, -118, 57, 15, -52, -78, 100, 104, 102, -42, -102, -45, - 50, -116, -47, -53, 103, -40, -61, 62, 42, 15, -124, 98, -28, -77, 94, 78, -50, -116, -47, - 53、103、-40、-61、62、42、15、-124、98、-28、-77、94、78、-50、-116、-47、-53、103、-40、-61 , 62, 42, 15, -124, 98, -28, -77, 94, 78, -50, -116, -47, -53, 103, -40, -61, 62, 42, 15, -124 , 98, -28, -77, 94, 78, -50, -116, -47, -53, 103, -40, -61, 62, 42, 15, -124, 98, -28, -77, 94, 78]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:47:00.830

以下代码在这里可以正常工作：

```
 byte[] key = new byte[16];
    SecretKeySpec skeySpec = new SecretKeySpec(key, "AES");
    Cipher cipher = Cipher.getInstance("AES/ECB/NoPadding");
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec);

    byte[] data = "hello world.....".getBytes();
    byte[] encrypted = cipher.doFinal(data);
    System.out.println("Encrypted Array : " + Arrays.toString(encrypted)); 
```

但它不起作用`"hello world".getBytes()`，因为输入大小不是 16 的倍数：

```
Exception in thread "main" javax.crypto.IllegalBlockSizeException: Input length not multiple of 16 bytes
    at com.sun.crypto.provider.CipherCore.finalNoPadding(CipherCore.java:854)
    at com.sun.crypto.provider.CipherCore.doFinal(CipherCore.java:828)
    at com.sun.crypto.provider.CipherCore.doFinal(CipherCore.java:676)
    at com.sun.crypto.provider.AESCipher.engineDoFinal(AESCipher.java:313)
    at javax.crypto.Cipher.doFinal(Cipher.java:2086)
    at com.foo.bar.CryptoTest.main(CryptoTest.java:20)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

但这是意料之中的，因为没有使用填充。如果这是您得到的异常（而不是您的问题所说的“无效密钥”），那么请修复输入数据的长度。否则，将准确且完整的错误堆栈跟踪粘贴到您的问题中。

# android - 片段部分替换

> ID：15430086
> 
> 赞同：0
> 
> 时间：2013-03-15T10:33:38.237
> 
> 标签：android, fragment

我有 2 个片段，它们各自的布局。当有人打开应用程序片段 1 时，应该会出现。fragment1 有一个按钮。当用户单击该按钮时，fragment1 应该部分向右滑动，即 80%，并且在那个地方应该出现第二个片段。片段 1 的 20% 仍应可见。当用户再次单击该按钮时，片段 2 应该完全向左滑动，并且片段 1 现在必须完全可见。请告诉我我该怎么做。

提前致谢。

# ios - 无法在新开发机器上创建具有 nil 模型的 NSPersistentStoreCoordinator

> ID：15430087
> 
> 赞同：0
> 
> 时间：2013-03-15T10:33:38.850
> 
> 标签：ios, xcode, nspersistentstore

我刚刚设置了一台使用 Xcode 进行开发的新机器，当我打开、构建和运行现有的核心数据项目（它仍然在我的旧机器上完美运行）时，我收到“无法使用 nil 模型创建 NSPersistentStoreCoordinator “ 错误。

我已经阅读了有关此错误的无数关于 stackoverflow 的问题，感谢他们，我对 iOS 如何处理数据库对象模型有了更好的理解，据我所知，没有什么明显的问题。

我正在为我的托管对象模型使用标准初始化方法，即...

```
NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"project" withExtension:@"momd"];
_managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL]; 
```

...在我的旧机器上返回一个不错的 NSManagedObjectModel，但在我的新机器上返回 nil。

正在编译的包确实包含一个 project.momd 文件夹，该文件夹又包含一个 project.mom 文件，它与我的旧机器上的编译输出完全相同，但一个运行而一个不运行！非常令人沮丧！

我唯一能想到的是 Xcode 中有一些配置选项我没有在新机器上正确设置，但任何帮助或建议将不胜感激！

*** 更新 ***

我的新机器上的包在 Project.momd 中包含一个 project.mom。在我的旧机器上，Project.mom 在 Project.momd 内部，我猜模型名称是区分大小写的，所以我只需要破译为什么 xcode 以小写形式编译 mom...

在包中手动将 project.mom 重命名为 Project.mom 确实可以解决问题，尽管在重新编译项目之前是暂时的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T14:27:27.010

打开您的 xcdatamodeld “文件夹”（使用 Finder 中的“显示包内容”）查看 xcdatamodel 文件是否具有相同的大小写。理论上，`xcdatamodeld`被编译为`momd`和。`xcdatamodel``mom`

请注意，iOS 文件系统区分大小写，而 OSX 不区分大小写（至少默认情况下），因此这可能就是您在不同机器上得到不同结果的原因。

# python - 如何使用 Python 在 lxml etree 上最好地迭代（广度优先）

> ID：15430090
> 
> 赞同：3
> 
> 时间：2013-03-15T10:33:45.627
> 
> 标签：python, xml, lxml

我正试图围绕 lxml （这是新的）以及如何使用它来做我想做的事情。我有一个格式正确且有效的 XML 文件

```
<root>
  <a>
    <b>Text</b>
    <c>More text</c>
  </a>
  <!-- some comment -->
  <a>
    <d id="10" />
  </a>
</root> 
```

像这样的东西。现在我想以广度优先访问孩子们，我能想到的最好的办法是这样的：

```
for e in xml.getroot()[0].itersiblings() :
    print(e.tag, e.attrib) 
```

然后从那里拿走。但是，这给了我包括评论在内的*所有*元素

```
a {}
<built-in function Comment> {}
a {} 
```

如何跳过评论？有没有更好的方法来迭代节点的直接子节点？

一般来说，解析 XML 树与使用事件驱动的拉式解析的建议是什么`iterparse()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T14:46:46.587

这适用于您的情况

```
for child in doc.getroot().iterchildren("*"):
    print(child.tag, child.attrib) 
```

# asp.net-mvc - 动态设置 app.config 文件连接字符串

> ID：15430091
> 
> 赞同：2
> 
> 时间：2013-03-15T10:33:53.507
> 
> 标签：asp.net-mvc, web-config, connection-string, app-config

我有一个包含以下内容的 Web 应用程序：

1.  一个 MVC Web 项目（带有一个包含连接字符串的 web.config 文件 - 但其中没有数据库访问代码）

2.  一个使用 LINQ-SQL 类的数据访问项目（它是一个类库，这个项目的 dll 将被放入上面的 MVC 项目中并访问其中的数据）。

我需要的是我的 MVC 项目的 web.config 文件中有一个连接字符串。我必须在类库中编写一个函数，以便根据 MVC webcofig 文件中的连接字符串修改 app.config、settings.settings 和 dbml 文件中的连接字符串。并且数据应该根据这个连接从数据库中获取..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T12:24:48.277

覆盖 DataContext 的构造函数，如下所示。

```
public partial class MyDataContext : System.Data.Linq.DataContext
{
    //This constructor make sure that the connection string is used from the web.config file.
    public MyDataContext()
        : base(ConfigurationManager.ConnectionStrings["SqlConnectionString"].ConnectionString, mappingSource)
    {
        OnCreated();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T12:15:50.460

您可以将类库中 DBML 文件的连接字符串设置为“无”，对于执行 DB 操作的类库中的类可以使用从其构造函数设置的连接字符串。

例如：

```
public class DBOperations
    {
        string conn;
        public DBOperations(string connectionString)
        {
            conn = connectionString;
        }

        //Use this connection string in Your functions
    } 
```

这个连接字符串可以从Web应用程序中设置。它可以作为相应数据访问层类的构造函数传递。

# c# - 根据路由配置，Url 生成没有给出预期的结果

> ID：15430093
> 
> 赞同：0
> 
> 时间：2013-03-15T10:33:55.360
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4

我正在使用`ASP.NET MVC 4`.

我有一个名为 的控制器和两个名为and的`Server`操作方法。我有以下路线配置：`Search``Component`

```
routes.MapRoute("Component",
     "{controller}/{serverId}/{action}",
     new { controller = "Server", action = "Component" },
     new { serverId = @"\d+" }); 
```

我正在寻找类似于以下内容的网址：

```
/Server/12345/Component 
```

我的搜索操作方法：

```
return RedirectToAction("Component", new { serverId = 12345 }); 
```

我的组件操作方法：

```
public ActionResult Component(int serverId)
{
     return View();
} 
```

生成的网址是：

```
/Server/12345/ 
```

这是错误的，它遗漏了“组件”。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:37:08.620

```
 new { controller = "Server", action = "Component" }, 
```

因为您将默认操作设置为“组件”，我认为链接生成足够聪明，可以将其关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:37:26.577

您将 Component 定义为 Default-Action，那么为什么要附加它呢？如果您希望它在您的路线中，则将其从默认值中删除并将其添加到您的 RedirectToAction 调用中。

# linq - 两个表中的 Linq 减法总和（值）

> ID：15430097
> 
> 赞同：0
> 
> 时间：2013-03-15T10:34:05.837
> 
> 标签：linq, asp.net-mvc-4

我有两个 db.Table1 和 db.Table2 列名为 IdUser,Value 我想我应该有一些加入，但我错过了逻辑

这只是一个逻辑它不是一个代码怎么能做这样的事情：

```
var total = Sum(db.Table1(Sum(Value))-db.Table2(Sum(Value))
.Where(db.Table1.IdUser=db.Table2.IdUser) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:46:22.747

加入表格和组

```
 var total = from table1record in Table1
        join table2record in Table2 on table1Record.IdUser equals table2Record.IdUser
        group new { table1record,table2record } by table1record.IdUser into groupedRecords
        select groupedRecords.Sum(x=>x.Table1Value) -   groupedRecords.Sum(x=>x.Table2Value); 
```

# jboss - Dozer Mapper 的静态使用

> ID：15430103
> 
> 赞同：1
> 
> 时间：2013-03-15T10:34:20.400
> 
> 标签：jboss, mapping, dozer, stateless-session-bean

只是想知道这样的静态推土机映射器是否会导致并发错误：

```
public static Mapper mapper = new DozerBeanMapper();
public static MyDTO toDTO(MyEntity e) {
    MyDTO dto = mapper.map(e, MyDTO.class);
    return dto;
} 
```

或者我应该总是使用这个代码：

```
public static MyDTO toDTO(MyEntity e) {
    Mapper mapper = new DozerBeanMapper();
    MyDTO dto = mapper.map(e, MyDTO.class);
    return dto;
} 
```

该方法用于 JBoss 服务器的 @Stateless 会话 bean，可以同时访问。事实是我真的不知道 Dozer 是否使用库中的静态变量或实例变量来决定我是否可以/应该使用静态 Mapper 或在每次调用时创建一个新实例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T16:31:34.167

推土机实例可以是静态的。如果您为每个请求创建新实例，性能会更差，因为每次都会初始化大量缓存。由于自定义转换器中的错误或内部推土机问题，可能会遇到并发错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-21T09:33:41.047

从[文档](http://dozer.sourceforge.net/documentation/gettingstarted.html)中，DozerMapper 实例应该构建为单例。DozerBeanMapper 是线程安全的，因此您可以不顾风险地使用多个线程。

确保您也可以使用`DozerBeanMapperSingletonWrapper.getInstance();`这将为您处理单例部分。

我认为将映射器用作公共静态字段并不是一个好主意。

你也可以使用[Selma](http://xebia-france.github.io/selma/)来处理你的映射。这是一个基于 Annotation 处理器的新库，可在编译时生成映射代码。有了它，您的代码将如下所示：

```
// Configure the mapping
@Mapper
public interface DtoMapper {

    MyDTO toDTO(MyEntity e);
}

// Retrieve the mapper 
public static DtoMapper mapper = Selma.getMapper(DtoMapper.class);

// and some where in the code use
mapper.toDto(entity); 
```

# python - 如何创建具有多个点的类方法？

> ID：15430104
> 
> 赞同：1
> 
> 时间：2013-03-15T10:34:20.837
> 
> 标签：python, python-2.7, mocking, xml-rpc

在 python 中，我想创建一个带有多个点的（类）方法，以便对`xmlrpc`方法进行测试，这些方法可以有很多点的方法名称。当我尝试以下操作时：

```
class Foo(object):
    def method.with.many.dots(self):
        return 42 
```

我的语法无效。我还尝试使用更复杂的想法，例如

```
class Foo(object):
    def __getattr__(self, attr):
        print attr 
```

对于带有点的方法名称，这也不适用于开箱即用。任何想法如何创建一个简单的模拟对象，我可以用它做类似的事情

```
mock.some.test.with.many.dots() 
```

以简单的方式在 python 代码中，无需启动`xmlrpc`服务器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T10:37:29.483

```
class Foo(object):
    def __init__(self):
        self._attr_path = []

    def __getattr__(self, attr):
        self._attr_path.append(attr)
        return self

    def __call__(self, *args, **kw):
        print ".".join(self._attr_path)
        print args, kw
        del self._attr_path[:]

f = Foo()
f.a.b.c(1,2,3) 
```

这个输出：

```
a.b.c
(1, 2, 3) {} 
```

要解决@Daira Hopwood 的问题：

```
class Bar(object):
    def __init__(self, foo, attr):
        self.foo = foo
        self._attr_path = [attr]

    def __getattr__(self, attr):
        self._attr_path.append(attr)
        return self

    def __call__(self, *args, **kw):
        print self
        print args, kw

    def __str__(self):
        return ".".join(self._attr_path)

class Foo(object):

    def __getattr__(self, attr):
        return Bar(self, attr)

f = Foo()
f.a.b.c(1,2,3) 
```

再次解决@Daira Hopwood 的问题：

```
class Foo(object):

    def __init__(self, parent=None, name=""):
        self.parent = parent
        self.name = name

    def __getattr__(self, attr):
        return Foo(parent=self, name=attr)

    def __call__(self, *args, **kw):
        print self
        print args, kw    

    def __str__(self):
        nodes = []
        node = self
        while node.parent:
            nodes.append(node)
            node = node.parent
        return ".".join(node.name for node in nodes[::-1])

f = Foo()
x = f.a.b
y = f.a.c
x()
y()

g = f.a
f.b
g.b.c() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-20T21:52:40.753

该解决方案将起作用

输入：

```
import mock
MO = mock.Mock()
MO.some.test.wyth.many.dots.return_value = 42
MO.some.test.wyth.many.dots() 
```

输出：

```
42 
```

注意，“with”是关键字。

每个带点的“后代”都是一个独立的（模拟）对象。

# iphone - 当用户在屏幕上移动手指时，轴上的动画/旋转/平移视图

> ID：15430107
> 
> 赞同：1
> 
> 时间：2013-03-15T10:34:24.867
> 
> 标签：iphone, ios, objective-c, core-animation

我正在开发需要 3D 动画的动画应用程序，作为普通动画，我们可以通过核心动画/石英核心来完成，但我需要带有锚点动画的 3D。

任何人都可以建议我吗？所以我可以抓住解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:37:17.300

更改视图层的锚点必然会影响位置。这是针对此问题的出色解释。

[更改我的 CALayer 的锚点会移动视图](https://stackoverflow.com/questions/1968017/changing-my-calayers-anchorpoint-moves-the-view)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T13:11:52.993

```
-(void) ColorMonochrome 
```

{ CIImage *result = [CIImage imageWithCGImage:[imageEdit.image CGImage]]; CIFilter *filter = [CIFilter filterWithName:@"CIColorMonochrome"];// 1 NSLog(@"%@",[CIFilter filterNamesInCategory:kCICategoryTileEffect]); [过滤器设置默认值]; // 2 [filter setValue:result forKey:@"inputImage"]; [filter setValue:[NSNumber numberWithFloat:1.0] forKey:@"inputIntensity"]; [filter setValue:[CIColor colorWithCGColor:[[UIColor greenColor] CGColor]] forKey:@"inputColor"]; 结果 = [过滤器 valueForKey:kCIOutputImageKey]; CIContext *context = [CIContext contextWithOptions:nil]; CGImageRef resultRef = [context createCGImage:result fromRect:[result extent]]; UIImage *resultimage = [UIImage imageWithCGImage:resultRef]; CGImageRelease(resultRef); imageEdit.image = 结果图像；}

# json - 以 JSON 格式存储记录数组

> ID：15430110
> 
> 赞同：2
> 
> 时间：2013-03-15T10:34:31.667
> 
> 标签：json, delphi, delphi-xe3, superobject

如何通过 SuperObject 库将记录数组存储在 JSON 中。例如..

```
type
  TData = record
    str: string;
    int: Integer;
    bool: Boolean;
    flt: Double;
  end;

var
DataArray: Array[0..100] of TData; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-15T11:10:19.667

只需使用超级对象编组`TSuperRTTIContext`

```
program Project1;

{$APPTYPE CONSOLE}
{$R *.res}

uses
  superobject,
  System.SysUtils;

type
  TData = record
    str : string;
    int : Integer;
    bool : Boolean;
    flt : Double;
  end;

  TDataArray = Array [0 .. 100] of TData;

procedure Test;
var
  DataArray : TDataArray;
  so :        ISuperObject;
  ctx :       TSuperRttiContext;
begin
  ctx := TSuperRttiContext.Create;
  try
    so := ctx.AsJson<TDataArray>( DataArray );
  finally
    ctx.Free;
  end;
  Writeln( so.AsJson );
end;

begin
  try
    Test;
  except
    on E : Exception do
      Writeln( E.ClassName, ': ', E.Message );
  end;

  ReadLn;

end. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T10:45:16.040

先把它变成一个字符串。

```
Your array:
//Array[0] := 'Apple';
//Array[1] := 'Orange';
//Array[2] := 'Banana';
myArrayAsStr := '"MyArray": [{ "1": "' + Array[0] +'", "2": "' + Array[1] +'"}'; 
```

然后你可以把它变成 JSON`SO(myArrayAsStr)` 你总是可以在不同的过程中将你的数组生成为字符串，但我认为这就是这样做的方法。

我会继续检查是否有更简单的方法；）

编辑：SuperObject 还具有以下功能： `function SA(const Args: array of const): ISuperObject; overload;` 您将能够再次将其转换为字符串并将其添加到总 JSON 字符串中。

# php - Codeigniter HMVC：运行来自不同模块名称的具有相同名称的控制器时出错

> ID：15430117
> 
> 赞同：-1
> 
> 时间：2013-03-15T10:34:46.933
> 
> 标签：php, codeigniter, codeigniter-2, hmvc

我正在使用带有 HMVC 的 Codeigniter 2.1.3 ( [https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc/overview](https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc/overview) )

我尝试在视图中运行两个模块，如下所示

```
<?php 
echo Modules::run('contact/mosite/contactform');  
echo Modules::run('social/mosite/facebook');  
?> 
```

第一个模块运行良好，但第二个模块运行失败。

如果我只运行第二个模块，它将正常工作。

我认为问题出在**控制器名称**上，两个控制器的名称相同。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:56:09.250

好吧，如果这是因为同名（我不确定），那么我认为您可以使用`namespace`并且要做到这一点，您可以使用此补丁[来](http://ellislab.com/forums/viewthread/212661/)允许`namespacing`. `CodeIgniter`我没有使用/测试它，但它工作正常，正如其他人声称的那样。

**重要提示：**此补丁替换了核心`Codeigniter.php`文件，因此请注意这一点。

# android - 简单静态库的内存不足异常

> ID：15430121
> 
> 赞同：1
> 
> 时间：2013-03-15T10:34:53.547
> 
> 标签：android, gridview, imageview, android-gallery

我正在使用一个简单的静态图片库，我在其中加载了至少 28 张图片，每张图片的大小都低于 150kb。

我在这里注意到两个问题：

1) 慢速滚动 2) 当我参加此活动两次 3 次时出现内存不足异常。

任何人指导我这里的问题是什么以及如何解决它？

任何帮助，将不胜感激

**原木猫：**

```
03-15 15:32:55.899: E/AndroidRuntime(14662): java.lang.OutOfMemoryError: bitmap size exceeds VM budget
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:563)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:439)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:697)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.content.res.Resources.loadDrawable(Resources.java:1709)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.content.res.Resources.getDrawable(Resources.java:581)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.ImageView.resolveUri(ImageView.java:501)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.ImageView.setImageResource(ImageView.java:280)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at com.tackfu.Art$ImageAdapter.getView(Art.java:84)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.AbsListView.obtainView(AbsListView.java:1515)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.GridView.makeAndAddView(GridView.java:1269)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.GridView.makeRow(GridView.java:315)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.GridView.fillDown(GridView.java:268)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.GridView.fillGap(GridView.java:235)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.AbsListView.trackMotionScroll(AbsListView.java:4063)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.widget.AbsListView.onTouchEvent(AbsListView.java:2471)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.View.dispatchTouchEvent(View.java:3885)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:903)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1750)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1135)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.app.Activity.dispatchTouchEvent(Activity.java:2096)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1734)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2216)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1887)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.os.Looper.loop(Looper.java:130)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at android.app.ActivityThread.main(ActivityThread.java:3687)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at java.lang.reflect.Method.invokeNative(Native Method)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at java.lang.reflect.Method.invoke(Method.java:507)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
03-15 15:32:55.899: E/AndroidRuntime(14662):    at dalvik.system.NativeStart.main(Native Method) 
```

**活动代码：**

```
 @Override
        public void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);
            setContentView(R.layout.art);

 GridView gridview = (GridView) findViewById(R.id.gridv
 gridview.setAdapter(new ImageAdapter(this));

}

 public class ImageAdapter extends BaseAdapter {
            private Context mContext;

            public ImageAdapter(Context c) {
                mContext = c;
            }

            public int getCount() {
                return mThumbIds.length;
            }

            public Object getItem(int position) {
                return null;
            }

            public long getItemId(int position) {
                return 0;
            }

            // create a new ImageView for each item referenced by the Adapter
            public View getView(int position, View convertView, ViewGroup parent) {
                ImageView imageView;
                if (convertView == null) {  // if it's not recycled, initialize some attributes
                    imageView = new ImageView(mContext);
                    imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
                    imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
                    imageView.setPadding(8, 8, 8, 8);
                } else {
                    imageView = (ImageView) convertView;
                }

                imageView.setImageResource(mThumbIds[position]);
                return imageView;
            }

            // references to our images
            private Integer[] mThumbIds = {
                    R.drawable.i1, R.drawable.i2,
                    R.drawable.i3, R.drawable.i4,
                    R.drawable.i5, R.drawable.i6,
                    R.drawable.i7, R.drawable.i8,
                    R.drawable.i9, R.drawable.i10,
                    R.drawable.i11, R.drawable.i12,
                    R.drawable.i13,R.drawable.i14,
                    R.drawable.i15,R.drawable.i16,
                    R.drawable.i17,R.drawable.i18,
                    R.drawable.i19,R.drawable.i20,
                    R.drawable.i21, R.drawable.i22,
                    R.drawable.i23, R.drawable.i24,
                    R.drawable.i26, R.drawable.i28,
                    R.drawable.i29, R.drawable.i30
            };
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:46:03.863

28 张 150KB 大小的图像大约是 ~4MB RAM。加上应用程序数据，它不适合小堆。您可以将[大堆设置为 manifest](http://developer.android.com/guide/topics/manifest/application-element.html#largeHeap)：

```
android:largeHeap="true" 
```

但是这种方法看起来是一种解决方法，因为您有无限的内存并且图像数量的增加可能会再次导致此错误。您还应该使用延迟加载或根据设备屏幕大小调整图像大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:49:54.017

不使用时回收位图。使用**视图支架**以获得更好的性能。 [http://www.youtube.com/watch?v=wDBM6wVEO70](http://www.youtube.com/watch?v=wDBM6wVEO70)。我建议你看看链接。无论适用于 listview 也适用于 gridview 和视频讨论它。该视频还对视图支架进行了讨论，这正是您应该使用的以避免内存泄漏。

[在http://android-developers.blogspot.de/2009/01/avoiding-memory-leaks.html](http://android-developers.blogspot.de/2009/01/avoiding-memory-leaks.html)也有关于避免内存泄漏的讨论。

[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)。请参阅**将按比例缩小的版本加载到内存中的部分**

使用 MAT Analyzer 检查内存泄漏。[http://www.youtube.com/watch?v=_CruQY55HOk](http://www.youtube.com/watch?v=_CruQY55HOk)。

[考虑http://developer.android.com/training/articles/perf-tips.html](http://developer.android.com/training/articles/perf-tips.html)上的一些提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:08:23.167

滚动慢的原因很简单。每次创建视图时，您都会在 UI 线程中加载图像。您应该将加载委托给另一个低优先级的线程。如果您愿意，您可以在 UI 线程中加载缩略图以快速显示某些内容，然后在后台加载全分辨率。

请记住，Android 有很多巧妙的技巧可以让您的应用程序变得更好，但您必须明智地使用它们。例如，Android 在所谓的绘图缓存中缓存静态视图，但在 ImgaeViews 的情况下，它是没有意义的，因为它需要额外的内存并且什么也没有。使用硬件加速 UI 会使用更多内存，因为每个视图缓存都是在二次幂纹理上绘制的。这意味着 100x35px 按钮将占用 128x64x4 字节的额外内存。Android 也会尝试使用某种抗锯齿，例如线性纹理采样器 - 这很好，但会占用大量 CPU 时间，您可能希望将其关闭。

通过 setImageResource 加载图像几乎没有控制权。您可能希望自己加载图像，以便更精确地控制加载和卸载。您还可以稍微缓存图像。LRU 缓存是用于此类用途的一个很好的示例：http: [//developer.android.com/reference/android/util/LruCache.html](http://developer.android.com/reference/android/util/LruCache.html)。您可以加载当前图像并在左侧预加载一张，在右侧预加载一张。当用户返回上一个图像时，您会将其保存在内存中。

此外，如果您希望使用蛮力，您可以使用 NativeBuffer 缓存您的图像：[http](http://code.google.com/p/native-buffer/) ://code.google.com/p/native-buffer/ 。它会迫使你重新设计你的画廊，但它可以加速大量图像应用程序。

# actionscript-3 - 内存快用完了，分离as3代码能解决吗

> ID：15430126
> 
> 赞同：0
> 
> 时间：2013-03-15T10:35:14.123
> 
> 标签：actionscript-3, flash

到目前为止，我一直在一个大的 as3 文件中做所有事情，但现在我似乎很快就遇到了内存问题，即使我一直在删除所有侦听器并清除所有容器......会分离代码在不同的 as3 文件中帮助我防止我的闪存变慢？

可能是个愚蠢的问题，但我不想开始重新安排代码的所有工作，尽管在这一点上它不是太大的工作。除了也许我必须弄清楚一些事情并重新做它们，因为当它们位于不同的文件中时它可能无法工作，但是......

无论如何，提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:38:36.637

内存的增加与处理单个文件无关，因此如果不重构代码，拆分为不同的文件/类将无法解决问题。

如果，如您所说，此时工作还不算大，我认为您应该认真考虑使用适当的 OOP 结构重构您的代码。将帮助您调试您的应用程序，帮助您完成它并在将来维护它

# mongodb - 如何从 mongodb 分片中删除块

> ID：15430127
> 
> 赞同：0
> 
> 时间：2013-03-15T10:35:15.097
> 
> 标签：mongodb, sharding, chunks

我有一个集合，其中分片键是 UUID（十六进制字符串）。集合是巨大的：8.12 亿个文档，大约 9600 个块在 2 个分片上。出于某种原因，我最初存储的文档不是 UUID，而是在分片键字段中具有整数。后来我完全删除了它们，现在我所有的文档都被 UUID 分片了。但我现在面临块分布的问题。虽然我有整数而不是 UUID 的文档，但平衡器为这些文档创建了大约 2700 个块，并将它们全部放在一个分片上。当我删除所有这些文档时，块并没有被删除，它们保持为空并且它们将永远是空的，因为我现在只使用 UUID。由于平衡器根据每个分片的块数而不是文档数或大小来分配块，因此我的一个分片占用的磁盘空间是另一个分片的 3 倍：

```
--- Sharding Status ---
db.click chunks:
    set1    4863
    set2    4784    // 2717 of them are empty

set1> db.click.count()
191488373

set2> db.click.count()
621237120 
```

可悲的是 mongodb 不提供手动删除或合并块的命令。我的主要问题是，这项工作是否可以摆脱空块：

1.  停止平衡器。连接到每个配置服务器，从`config.chunks`空块的范围中删除，并将`minKey`切片固定在第一个非空块的开头。启动平衡器。似乎有风险，但据我所知，`config.chunks`它是唯一存储块信息的地方。

2.  停止平衡器。启动一个新的 mongod 实例并将其连接为第三个分片。手动将所有空块移动到这个新分片，然后永远关闭它。启动平衡器。不确定，但只要我不再在分片键中使用整数值，所有查询都应该运行良好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T21:18:20.747

有些人可能会读到这个并认为空块正在占用空间。情况并非如此——块本身不占用空间——它们是分片键的逻辑范围。

但是，跨分片的块平衡基于块的数量，而不是每个块的大小。

您可能想为这张票添加您的声音：[https ://jira.mongodb.org/browse/SERVER-2487](https://jira.mongodb.org/browse/SERVER-2487)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-26T21:08:55.037

由于 mongodb 平衡器仅平衡分片之间的块数，因此集合中的空块过多会导致分片按块数平衡，但每个分片的数据大小严重不平衡（例如，如 db.myCollection.getShardDistribution() 所示） .

您需要识别空块，并将它们合并为具有数据的块。这将消除空块。现在所有这些都记录在 Mongodb 文档中（至少 3.2 及更高版本，甚至可能在此之前）。

# android - 自定义 Android 首选项背景

> ID：15430130
> 
> 赞同：2
> 
> 时间：2013-03-15T10:35:27.763
> 
> 标签：android, background, customization, preferenceactivity

我目前正在尝试为首选项屏幕设置自定义背景。我创建了`PreferenceActivity`

```
public class SettingsActivity extends PreferenceActivity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.preferences);
    PreferenceManager.setDefaultValues(this, R.xml.preferences, false);
}
} 
```

这是我的偏好布局

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" 
    >
    <CheckBoxPreference 
        android:key="pref_Autoplay"
        android:title="@string/pref_Autoplay"
        android:summary="@string/pref_Autoplay_summ"
        android:defaultValue="false"/>
    <ListPreference 
        android:entryValues="@array/pref_Voice_values" 
        android:entries="@array/pref_Voice_entries" 
        android:key="pref_Voice" 
        android:summary="Choose male or female reader" 
        android:title="Readers voice" 
        android:defaultValue="female"/>

</PreferenceScreen> 
```

当我在这里阅读以更改背景时，我需要创建自己的风格主题。这里是：

```
<style name="PrefsTheme" parent="@android:style/Theme.Black.NoTitleBar">
        <item name="android:windowBackground">@drawable/prefs_bg</item>
        <item name="android:textColor">@color/prefs_bg</item>
        <item name="android:listViewStyle">@style/listViewPrefs</item>
    </style>

    <style name="listViewPrefs" parent="@android:style/Widget.ListView">
        <item name="android:background">@color/prefs_bg</item>
        <item name="android:cacheColorHint">@color/prefs_bg</item>
        <item name="android:textColor">@color/prefs_bg</item>
    </style> 
```

我只需要为首选项列表设置一些图像背景。我的形象是`@drawable/prefs_bg`。当我设置`windowBackground`为图像和`background`某种颜色时，首选项列表背景使用颜色而不是图片。但是，当我将背景设置为首`@drawable/prefs_bg`选项列表背景时，我的图片和单选按钮对话框出现在我的`ListPreference`项目中也使用图像背景。

请帮忙，如何在不影响某些首选项项目的单选按钮对话框背景的情况下为首选项列表设置图像背景？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T14:15:35.427

好的。我找到了如何解决我的问题。是我的错。设置偏好背景只需要

```
<item name="android:windowBackground">@drawable/prefs_bg</item> 
```

这个是不必要的：

```
<item name="android:background">@color/prefs_bg</item>
<item name="android:cacheColorHint">@color/prefs_bg</item> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-30T07:59:14.777

要添加动态性质，这也将起作用。将此添加到 PreferenceActivity。我们也可以用同样的方法设置背景颜色。

```
@Override
protected void onPostCreate(Bundle savedInstanceState) {
    super.onPostCreate(savedInstanceState);
    setupActionBar();
    setupSimplePreferencesScreen();

    if (Build.VERSION.SDK_INT >= 16)
        this.getListView().setBackground(getResources().getDrawable(...);
} 
```

# php - php如何显示所有数组项，包括空值项

> ID：15430132
> 
> 赞同：0
> 
> 时间：2013-03-15T10:35:36.700
> 
> 标签：php, arrays, foreach, null

我尝试使用 var_dump（或 echo）列出所有 $_POST 数组项，但不显示空值项。如果我使用 var_dump($_POST) null 不会出现，但如果我使用 var_dump($_Post["nullitem"]) null 出现：

```
<html>
    <head>
    </head>
    <body>
        <?php
        if  ($_POST["submit"]){
            var_dump($_POST);           
            foreach ($_POST as $key => $value) {
                echo $key."=>";
                echo $value;
                echo "     -     ";
            }
            echo "<br>";
            echo "ck_1 "; var_dump($_POST["ck_1"]);
            echo "ck_2 "; var_dump($_POST["ck_2"]);
            echo "ck_3 "; var_dump($_POST["ck_3"]);     
        }
?>
    <form action='test.php' method='post'  name='form_example' id='test'>
        <label for='ck_1'>
        <input type='checkbox' value=1 id='ck_1' name='ck_1'  />
        1 </label>
        <label for='ck_2'>
        <input type='checkbox' value=1 id='ck_2' name='ck_2'  checked='checked'   />
        2 </label>
        <label for='ck_3'>
        <input type='checkbox' value=1 id='ck_3' name='ck_3'  />
        3 </label>
        <input type='submit' name='submit' value='Submit'  />
    </form>
    </body>
</html> 
```

只有 ck_2 被选中，所以这个例子将输出：

数组'ck_2' => 字符串'1'（长度=1）'提交'=> 字符串'提交'（长度=6）

ck_2=>1 - 提交=>提交 -

ck_1 null ck_2 string '1' (length=1) ck_3 null

如何在 foreach 循环中包含所有 $_POST 值（我不知道 $_POST 数组中有多少键或名称）感谢您的帮助问候

**对不起。** 未选中的复选框未设置，因此**不是 $_POST 数组的成员**并且不会出现获取未选中复选框的值的方法是设置一个具有相同名称和 id 以及未选中值（如 0）的隐藏字段，因此在发布时返回未检查隐藏值的时间：

```
<input type="hidden" name="cx1" value="0" />
<input type="checkbox" name="cx1" value="1" /> 
```

谢谢米宰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:41:51.393

尝试这个

```
<html>
  <head>
  </head>
  <body>
    <?php
    if  ($_POST["submit"]){
       echo "<pre>";            
       print_r(array_filter($_POST["ck_1"]));
       echo "</pre>";
    }
   ?>
  <form action='test.php' method='post'  name='form_example' id='test'>
    <label for='ck_1'>
    <input type='checkbox' value=1 id='ck_1' name='ck_1[]'  />
    1 </label>
    <label for='ck_2'>
    <input type='checkbox' value=1 id='ck_2' name='ck_2[]'  checked='checked'   />
    2 </label>
    <label for='ck_3'>
    <input type='checkbox' value=1 id='ck_3' name='ck_3[]'  />
    3 </label>
    <input type='submit' name='submit' value='Submit'  />
  </form>
 </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:43:04.597

我认为您在 foreach 中包含了 $_POST 数组的所有值。问题是，如果您不选中复选框， $_POST 数组将不包含它的键或值。

我相信复选框只有一个值可能，并且仅在您“签入”复选框时显示。否则 $_POST 没有填充密钥。为什么当您使用指定的键名（未设置的复选框的名称）直接查询 $_POST 时会看到 NULL，该键在 $_POST 数组中不存在并返回返回 NULL 的内容。

如果您出于某种不明原因需要列出所有可供用户签入的复选框，您可以添加

```
<input type='hidden' name='cbNames[]' value='ck_1'/>
<input type='hidden' name='cbNames[]' value='ck_2'/>
<input type='hidden' name='cbNames[]' value='ck_3'/> 
```

对于您网站上的每个复选框，然后列出 $_POST['cbNames'] 数组并在 $_POST 中查询：

```
foreach ($_POST['cbNames'] as $cbName)
    print $_POST[$cbName]; 
```

# assembly - 如何反转一个字节

> ID：15430135
> 
> 赞同：6
> 
> 时间：2013-03-15T10:35:46.387
> 
> 标签：assembly, byte, reverse, avr, atmega

我正在处理一个项目，碰巧我必须颠倒一个字节的顺序。我目前正在使用 AVR Studio Mega32 微控制器。

例如：

```
0000 0001 becomes 1000 0000
0001 0110 becomes 0110 1000
1101 1001 becomes 1001 1011 
```

首先，我有这个：

```
ldi r20,0b00010110 
```

反转字节以使 r20 变为 01101000 的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T11:11:02.420

这是一个片段——它是为 GNU 工具链（avr-gcc、binutils、avr-libc 等）编写的——但它应该很容易适应：

```
static inline __attribute__ ((always_inline))
uint8_t avr_reverse_byte (uint8_t x)
{
    x = ((x & 0x55) << 1) | ((x & 0xaa) >> 1);
    x = ((x & 0x33) << 2) | ((x & 0xcc) >> 2);

    /* x = ((x & 0x0f) << 4) | ((x & 0xf0) >> 4); */

    __asm__ ("swap %0" : "=r" (x) : "0" (x)); /* swap nibbles. */

    return x;
} 
```

`swap`因此，除了用指令实现的最终高低半字节交换外，对“C”代码没有太大的改进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T09:33:53.563

Another easy way is to use the carry flag:

Repeat 8x:

```
lsl r20 ; shift one bit into the carry flag
ror r0  ; rotate carry flag into result 
```

(Input in `r20`, output in `r0`, content of `r20` destroyed; registers may be changed freely.)

This uses 16 instructions @ 2 bytes, 1 cycle each = 32 bytes of program memory and 16 cycles to reverse one byte when completely 'unrolled'. Wrapped in a loop, the code size can be reduced but execution time will increase.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T15:50:01.870

我现在无法提供 AVR 代码。但一般位反转技术如下：

```
abcd efgh   p
badc fehg   p = ((p and 0AAh) shr 1) or ((p shl 1) and 0AAh)
dcba hgfe   p = ((p and 033h) shr 2) or ((p shl 2) and 033h)
hgfe dcba   p = ((p and 00Fh) shr 4) or ((p shl 4) and 0F0h) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-30T10:08:13.587

字节的两半的 4 位（16 个条目）查找表看起来是一个很好的折衷方案（正如@Aki 在评论中指出的那样）。

AVR 指令每条是 2 个字节，因此 16 字节的表占用的空间与 8 条指令相同。（事实证明，速度或大小不值得，除非您可以将数组对齐 256 个字节以使索引比 gcc 便宜得多。）

可以使用每个字节的高半部分和低半部分来打包 LUT。但这将花费更多的索引（在屏蔽之前使用索引的第 4 位上的分支以有条件地交换）而不是节省表大小（8 字节 = 4 条指令）。

* * *

让我们比较一下 AVR GCC 的作用。在编译 Brett 的代码时，gcc4.6 有令人惊讶的可怕的错过优化（实际上是提升到`int`而不是充分利用将结果截断为 uint8_t）。具有讽刺意味的是，它*确实*使用 SWAP 指令优化`x<<4 | x>>4`为旋转。（AVR 没有多计数旋转指令，并且正常旋转是通过进位旋转。移位仅适用于每条指令一个计数。）

```
#include <stdint.h>

uint8_t reverse_byte_alu (uint8_t x)
{
    uint8_t xeven = x & 0x55,  xodd = x & 0xaa;
    x = (xeven << 1) | (xodd >> 1);  // swap adjacent bit pairs

    xeven = x & 0x33,  xodd = x & 0xcc;
    x = (xeven << 2) | (xodd >> 2);  // swap adjacent 2-bit chunks

    x = ((x << 4) | (x >> 4));  // 4-bit rotate is recognized as SWAP
    return x;
} 
```

**[`gcc4.6 -O3`使用(Godbolt compiler explorer)编译成这个 asm](https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAKxAEZSAbAQwDtRkBSAJgCFufSAZ1QBXYskwgA5NwDMeFsgYisAag6yAwoIL4WBAHQIN2DgAYAguYsiFBABwB9AquKYAbpmKDMjgEYAngS%2BTMqqELb6Ti4AHgCU1hwA7HyWqumqkQ7OqjEemCzqsgAiuepcAGyqZjEArLWk6TEY6EWlMeVVNUxMGqkWGWUapRB5noUampOqtHHqSZrhzeitJiYzCbI86QD0O6qCAO5MAA6qTOhUTBL6qn6EqidMeN6JaRljBW1DldUxsrJGrkWt8OtwujFkJwttZBmCSkt8hMtNMuHNkotRiC1rJsKo0X1dvsjqdzpdrgUXFwALT3FzIBAiFgAa0EbwGH2%2BUHhUy0qgALOiFksiqZcQK4pttqo9gLaQ9iKgCExgqo8IJXJg0MAWHgAF6YVpMDUAZQA6hYAAqwjJuAhiQoxPqJJLFdmORwqgjEPB%2BETBD1QUJ4HWGiC0CqSuYy/YAWyYzMwGoUWBiCmAqgZmFOXmsOhVeGQmdQLB0mTs0U1nm8vl1fj8DEwHFqPAjzdKw3m/UGgzMQN7floZmHjTMfjMQ771UHk9INp70%2BHQ9Hg4nU7HE%2BX09oO77857G6XK8n9EXQ9PY939H3A6XF9XO5Xm/vO53N4yyTdMMs1iylbc1Y%2BP4QS1r6Da%2BAAMgAqgAKuEf45PEXb7ghLgIHg3wAV4QF1uBzY8E6uImPy7bOu86ToVyECUZM0yCvMmI0UR4qClKRKqOaVpqqWwQXKoqAAGYcRa1q8BYABypQCSQqhUCIZZMAc6ECQQKEVjkDCoJh%2BQ1o4uGNvhYK/BE6kEHENRmAJpHfhy6R2g6qg0cKmlkVYrrsh5XDyEJZjWLKwBQqosbqj4rSoCcBB4MFeoFiWGrxomqgEOhGp%2BBcv6mec7jEI4WG6YEAYkCG8GZfELrdpynbcp0fz1OiKJ8rMDHhKMNXdEw9VinisyuXCVFGRCAL1byixos11Xgn8UKdesBI2fuOwAFRDAiE2/BZAnDXRQqYq1k01AJZgzSxbGLTs7KDB6xqxh64TcFwJJnNwtS%2BVwXCqCA5RcMMxD3Uscyffdr3vaMkqEktBzHGc%2BlJgYqhnRdtqYPaxCOq5n6JF5BT4FZP6WLKj3lNsrD4BlUQ5IICDEPyJnk7EQrbPZqO5Di2AkVs8zFFIcSMNItRSKQLDSGYAuoNIUy8PwByiOImDlLItACwQwvczzzIgC9Bi0LUsi1PY9iVLUtCyPyFQRrzUj8gLsZ0COQtSCLpBi1IAuCCAfbKw73OkHAsBIGgsYnHgjZkBQEAB0HIcgEw2XAKb/KkAJwfBN4lB%2BCrpD3CwTDEAE0iK6QAexpSADyLAMHnXukFg8ZsI2Gf4G4yCRZ4btV5geTIP6khSAXdiYAw%2BdKz6Nu997zBsCg/D8Iwvpu5APPhZFcXSNSkKqNSJeyBvZqhAwrsyxIdA84PUj84LGfOxYABqABKqgBUW/IGBUBj8uEuCEDJcinpoqCB8HLw8smoSz4LwJWKtJSkAQNmLAxBKBqxAPyAAnAYew8cdxJBNvYCotQE6nytqQG2s57aO2dq7d2pBPYiygafLgAtSGi2kBAr2UDAJ4BLEgoAA%3D%3D%3D)**。我没有看到任何错过的优化。

```
reverse_byte_alu:
    mov r25,r24
    andi r25,lo8(85)
    lsl r25
    andi r24,lo8(-86)
    lsr r24
    or r25,r24              # swap of adjacent bits done

    mov r24,r25
    andi r24,lo8(51)
    lsl r24
    lsl r24                 # << 2
    andi r25,lo8(-52)
    lsr r25
    lsr r25                 # >> 2
    or r24,r25              # swap pairs of bits done

    swap r24                # swap nibbles
    ret 
```

16 条指令，每条 2 字节，全部为 1 周期。（除外`ret`） [https://www.microchip.com/webdoc/avrassembler/avrassembler.wb_instruction_list.html](https://www.microchip.com/webdoc/avrassembler/avrassembler.wb_instruction_list.html)

所以这比@JimmyB 的答案*略好，后者需要 16 条单周期指令，**不*包括`ret`. （但它可以卷成一个小循环）。

* * *

数组索引在 AVR 中并不便宜。寻址模式的唯一选择是后递增或前递减，没有立即位移。所以必须将 16 位数组地址添加到 4 位半字节值。如果您的数组位于低 256 字节的地址空间中，这可能会更便宜。或者，如果您的数组是 256 字节对齐的，您可以只设置指针寄存器的高字节并将查找值放在低字节中。（gcc 错过了这个优化）。

告诉 gcc 将数组对齐在 16 字节边界上会使地址计算更便宜，但总指令数为 18，其中一些是多周期指令。

```
__attribute__((aligned(16)))  // makes indexing cheaper
static const uint8_t reverse_nibble[16] = {
        0,      0b1000, 0b0100, 0b1100,
        0b0010, 0b1010, 0b0110, 0b1110,
        0b0001, 0b1001, 0b0101, 0b1101,
        0b0011, 0b1011, 0b0111, 0b1111
        };

uint8_t reverse_byte_nibble_LUT (uint8_t x) {
    uint8_t hi = reverse_nibble[x>>4];
    hi = ((hi << 4) | (hi >> 4));  // SWAP instead of SWAP+AND for just a shift
    uint8_t lo = reverse_nibble[x & 0x0f];
    return hi | lo;
} 
```

编译成 17 条指令，[LD 是 2 周期指令，在非递增/递减寻址模式下访问 FLASH 时](https://www.microchip.com/webdoc/avrassembler/avrassembler.wb_LD.html)。（当不访问闪存或内部 SRAM 时，在某些 CPU 上为 1 个周期）。

```
 # gcc4.6 output, not optimal
    mov r26,r24
    swap r26
    andi r26,lo8(15)
    ldi r27,lo8(0)
    subi r26,lo8(-(reverse_nibble))   # AVR doesn't have add-immediate byte, only sub
    sbci r27,hi8(-(reverse_nibble))   # X register = (x>>4) - (-LUT_base)
    ld r25,X
    swap r25
    mov r30,r24
    ldi r31,lo8(0)
    andi r30,lo8(15)
    andi r31,hi8(15)                 # missed opt, this is a double-redundant 0 & 0
    subi r30,lo8(-(reverse_nibble))
    sbci r31,hi8(-(reverse_nibble))
    ld r24,Z
    or r24,r25
    ret 
```

`ldi r27, 0`/`sbci r27`可能是一个错过的优化。使用 16 字节对齐的表，我们无法进入高字节。我认为我们可以这样做：

```
 # generate r30 = x&0x0f
    subi r30,lo8(-(reverse_nibble))   # ORI would work, too.  no-op with 256-byte aligned table
    ldi  r31,hi8(reverse_nibble)      # reuse this for hi and lo 
```

因此，这可能会以更好的索引在速度上领先，但总大小（代码 + 表）肯定看起来更糟。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-01T18:30:55.890

通过一些调整，可以从评论中的代码片段（我的）获得额外的性能。

当我们确保 LUT 与 16 字节边界对齐时，我们可以通过异或生成地址。我们也可以通过索引对表进行异或，允许`x`就地修改参数。我已经注释掉了 GCC 生成的不必要的指令。

```
__attribute__((aligned(16)))  // makes indexing cheaper
static const uint8_t reverse_nibble_xor[16] = {
        0 ^ 0,  1 ^ 0b1000, 2 ^ 0b0100, 3 ^ 0b1100,
        4 ^ 0b0010, 5 ^ 0b1010, 6 ^ 0b0110, 7 ^ 0b1110,
        8 ^ 0b0001, 9 ^ 0b1001, 10 ^ 0b0101, 11 ^ 0b1101,
        12 ^ 0b0011, 13 ^ 0b1011, 14 ^ 0b0111, 15 ^ 0b1111
        };

uint8_t reverse_ams(uint8_t x)
{
    uint8_t *p = (uint8_t *)((uint16_t)reverse_nibble_xor ^ (x & 15));
    x ^= p[0];
    x = ((x << 4) | (x >> 4));
    uint8_t *q = (uint8_t *)((uint16_t)reverse_nibble_xor ^ (x & 15));
    x ^= q[0];
    return x;
}

reverse_ams:
        ldi r18,lo8(reverse_nibble)
//      ldi r19,hi8(reverse_nibble)
        ldi r31,hi8(reverse_nibble)  // use r31 directly instead of r19
        mov r30,r24
//        ldi r31,lo8(0)
        andi r30,lo8(15)
//        andi r31,hi8(15)
        eor r30,r18
//        eor r31,r19
        ld r25,Z
        eor r25,r24
        swap r25
        mov r30,r25
//        ldi r31,lo8(0)
        andi r30,lo8(15)
//        andi r31,hi8(15)
        eor r30,r18
//        eor r31,r19
        ld r24,Z
        eor r24,r25
        ret 
```

# wcf - 如何将大尺寸画布图像从 Silverlight 发送到 WCF 服务

> ID：15430145
> 
> 赞同：0
> 
> 时间：2013-03-15T10:36:11.160
> 
> 标签：wcf, silverlight, wcf-ria-services, silverlight-5.0

我有一个大尺寸字节 [] 使用以下代码从 silverlight Canvas 形成

```
var img = new WriteableBitmap(cnvControlHolder, null);
        var outStream = new MemoryStream();
        EncodeJpeg(img, outStream); 
```

现在我想将它发送到 WCF 服务以从这个字节数组中形成图像并将其保存为服务器端的图像，以便我可以在 SSRS 中使用它。我的问题是由于 byte[] 很大，我得到了 WCF 服务中找不到的经典方法。

我在几个链接中读到 WCF 流是一种选择，但在网上找不到任何示例。我的服务方法是这样的：

```
public bool Upload(Stream image)
    {
        FileStream fileStream = null;
        BinaryWriter writer = null;
        var filePath = HttpContext.Current.Server.MapPath(".") + @"\" +
                           ConfigurationManager.AppSettings["PictureUploadDirectory"] + @"\Diagram.jpeg";// +image.ImageName;
            if (image!=null)
            {
                //return ByteArrayToFile(filePath, image.Imagestream);
                fileStream = File.Open(filePath, FileMode.Create);
                writer = new BinaryWriter(fileStream);
                writer.Write("Diagram.jpeg");
            }
            return false;
        }

and client call is this :

var img = new WriteableBitmap(canvas1, null);
var outStream = new MemoryStream();
EncodeJpeg(img, outStream); //custom library to compress into jpeg
var client = new Service1Client();
client.UploadCompleted += new EventHandler<UploadCompletedEventArgs>(client_UploadCompleted);
client.UploadAsync(outStream.ToArray()); 
```

有人可以建议一些样本或任何其他解决方案来解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:54:32.143

我最近在 Silverlight 中实现了一个非常相似的解决方案。解决方案包括：

*   将大字节 [] 分成 n 个大小的块，可以通过 Web 服务调用发送
*   对服务进行 Web 调用，注册 n 个块的文件上传请求，并从服务请求 guid。
*   对服务进行 n 次 Web 调用并上传每个块，提供块的 guid 和序号（块可能不按顺序到达）。
*   一旦服务器接收到所有 n 个块，它就会组合这些块并将数据写入文件。

我希望这可以帮助您入门。

# javascript - 为什么 window.onhashchange 在 IE7 兼容模式下工作？

> ID：15430146
> 
> 赞同：3
> 
> 时间：2013-03-15T10:36:16.283
> 
> 标签：javascript, internet-explorer, hash

不明白为什么这段代码在 IE7 中有效？

```
$(window).bind('hashchange', function(){...}) 
```

此代码应该失败，因为 IE7 不支持 window.onhashchange 事件。

它是否有效，因为我在浏览器模式 IE7 中使用 IE9。这段代码应该在 IE7 中工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:43:03.007

今天早上的一篇有趣的读物是关于使用 ie 浏览器模式进行跨浏览器测试的危险！

[http://blog.typekit.com/2013/03/14/the-dangers-of-cross-browser-testing-with-ie9s-browser-modes/](http://blog.typekit.com/2013/03/14/the-dangers-of-cross-browser-testing-with-ie9s-browser-modes/)

使用浏览器模式并不是真实 IE 版本的真实反映

# php - 解析或内爆数组中的简单文本

> ID：15430154
> 
> 赞同：0
> 
> 时间：2013-03-15T10:36:50.330
> 
> 标签：php, arrays, parsing

我有一个简单的数组：

```
array(price => "1737 EUR - 3447 EUR") 
```

我需要这样的结果：

> $价格1 = 1737
> 
> $价格 = 3447

我知道这是一个非常简单的问题，但我不知道选择哪个功能以及如何做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T10:39:35.690

试试这个 ：

```
<?php
 $arr   = array("price" => "1737 EUR - 3447 EUR");
 preg_match('/(?P<price1>\d+)\s*EUR\s*-\s*(?P<price>\d+)\s*EUR/',$arr["price"],$matches);
 echo "<pre>";
 print_r($matches);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:42:54.500

或者如果您不想使用正则表达式，请尝试此操作；

```
$priceArray=array(price => "1737 EUR - 3447 EUR");
$spiltPrices=explode(' - ',$priceArray['price']);
echo $price1=$spiltPrices[0];
echo $price=$spiltPrices[1]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:43:17.110

不太漂亮，但我会做这样的事情：

```
//the initial array
$price = array("price" => "1737 EUR - 3447 EUR");

$prices = explode("-",$price["price"]);
foreach($prices as &$price) $price = (int) $price;
print_r($prices); //Array ( [0] => 1737 [1] => 3447 ) 
```

# autocomplete - AutoCompleteExtender 在 DotNetNuke 中不起作用

> ID：15430157
> 
> 赞同：0
> 
> 时间：2013-03-15T10:37:04.087
> 
> 标签：autocomplete, ajaxcontroltoolkit, dotnetnuke

我正在使用 DNN 6.0 和 VS2008 AjaxControl Tool kit 3.5

我正在尝试将 ASP.NET AutoCompleteExtender 添加到 DNN 中我的一个模块的文本框中。

据我所知 AutoCompleteExtender 只能通过网络服务工作。

我添加了一个 web 服务，但我无法让 AutoCompleteExtender 工作，我没有收到任何错误，但 web 服务从未被调用，我错过了什么或如何让 ASP.NET AutoCompleteExtender 工作？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:15:22.130

就我而言，这是以下问题：

**错误消息：**只能从脚本调用类定义中具有 [ScriptService] 属性的 Web 服务。

尝试将 [ScriptService] 作为 Web 服务类的定义。例子：

```
[WebService(Namespace = "http://dnndev/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
[ScriptService]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
// [System.Web.Script.Services.ScriptService]
public class BusinessDataProvider : System.Web.Services.WebService
{

    [WebMethod]
    [ScriptMethod]        
    public string[] GetSpecificListOfContributors(string prefixText, int count)
    {
        return ContributorController.GetSpecificListOfContributors(prefixText, count);
    }
} 
```

我希望这个对你有帮助。

最好的，

# php - 如何在 php 中检查图像大小时减少内存使用量

> ID：15430160
> 
> 赞同：0
> 
> 时间：2013-03-15T10:37:09.133
> 
> 标签：php, performance, file-upload

假设我不想允许上传大于 2MB 的图像，我检查图像大小如下

```
If($_FILES["image"]["size"] > 2100000) {
// .........
} 
```

和

```
getimagesize($_FILES["image"]["tmp_name"] 
```

假设用户尝试上传一个大约 300 MB 的非常大的图像，这将导致很大的内存使用和干扰。

我该如何控制这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:47:25.340

```
ini_set('post_max_size', '2M');
ini_set('upload_max_filesize', '2M'); 
```

这是为了更改运行时允许的上传大小。

或者您可以更改 php.ini 中的配置（请记住重新启动 Web 服务），这将为您的所有脚本设置服务器级别的限制，并且不能像您评论中所说的那样轻易绕过

# mysql - 休眠更新数据库方案 - 不同步？

> ID：15430176
> 
> 赞同：1
> 
> 时间：2013-03-15T10:37:40.317
> 
> 标签：mysql, hibernate

我们正在使用休眠将我们的实体映射到数据库。

昨天我们遇到了一个DataTruncationException，因为一个comment-field 没有被标注一个长度。

我们更改了实体并重新部署了应用程序。根据文档，Hibernate 没有改变列。*因此，我们手动*将数据库表从 varchar(255) 更改为 longtext。

现在，entities 属性带有注释，`@Column(length = 5000)`并且数据库列的格式为 longtext。

**DataTruncationException 仍然每次都出现**

我们决定导出所有数据，让 hibernate 创建一个新的数据库，然后再次插入数据。这终于奏效了，问题已经解决了。

但我们注意到，hibernate 忽略了 hibernate_sequence->nextval 条目并从 id 1 重新开始。（Hibernate 在 hibernate_sequence 表中创建了第二行，包含 1）

删除该值并设置所需的 id 后，一切似乎都很好。

但这提出了两个问题：

1.  为什么休眠不能识别修改后的表现在与实体匹配？

2.  为什么hibernate在第一次运行时会忽略next_val，然后重新开始？

# sql - 选择和插入（复制具有部分唯一值的行）

> ID：15430177
> 
> 赞同：1
> 
> 时间：2013-03-15T10:37:41.180
> 
> 标签：sql, sql-server-2008, select, insert, unique

我想将表中的行复制到同一个表中，但更改唯一值（所以我不会得到唯一值的重复）。使用 MS SQL Server 2008

表格示例

```
ID                      NAME            POS TYPE    DATA
XXXXXXXXXXXXXXX_TTTT    Something Hefty 0   01DAT   2008-09-29
XXXXXXXXXXXXXXX_WWWW    Something Hefty 2   01RAT   Random txt
ZZZZZZZZZZZZZZZ_YYYY    Something Else  1   01DAF   Random value 
```

所有列都没有任何键，所有列都是 Varchar 数据类型。

现在我想做的是选择这些行并插入它们（就像复制粘贴一样），但我想保留 _YYYY、_TTTT 和 _WWWW（它们是替换的，并且对于每个 X 或 Z ID 都是唯一的——这意味着_TTTT 可以与 _YYYY 相同，因为 X 和 Z 不同）在 ID 列中，但使新的 XXXXXXXXXXXXXXX 和 ZZZZZZZZZZZZZZZ 成为 ID 的一部分。另外我想更改名称，因为它必须是唯一的 XXXXXXXXXXXXX ID 或 ZZZZZZZZZZZZZZZ ID。（X ID 有一个名称，Z ID 有另一个名称。）

这是我尝试使用的语句（它不完整，因为我无法完全弄清楚）

```
insert into Table_name(ID,NAME,POS,TYPE,DATA) 
select 'XXXXXXXXXXXXXXX'+substring(ID,15,5), NAME+'(Copy)',POS,TYPE,DATA 
from Table_name where NAME='Old name' or NAME='Old name 2' 
```

“旧名称”和“旧名称 2”部分是为了能够选择我要复制的名称（大多数时候超过 5 个）。

所以我需要的帮助是为每个名称创建新的唯一 XXXXXXXXXXXXXXX 和 ZZZZZZZZZZZZZZZ ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:27:05.913

我不确定我是否理解正确，但您可能需要的是`UPDATE`：

```
UPDATE  table_name
SET     ID = REPLACE(ID, '_', '')
        , NAME = NAME + ' ' + REPLACE(ID, '_', '') 
```

如果您可以更改该表设计，那么您真的应该这样做，例如`INT`为 ID 创建类型列、添加主键约束等。

# xsd - 两种模式是否等效？

> ID：15430181
> 
> 赞同：1
> 
> 时间：2013-03-15T10:37:45.787
> 
> 标签：xsd, xml-validation, xsd-validation

1.

```
<xsd:element name="tuple">
<xsd:complexType>
    <xsd:sequence>
        <xsd:any minOccurs="0" maxOccurs="unbounded" namespace="##any" processContents="skip" />
    </xsd:sequence>
</xsd:complexType> 
```

2.

```
<xsd:element name="tuple"/> 
```

以上两种模式是否等效？

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:36:25.243

不！他们不一样！

**在第一个模式中：**元素`<tuple>`下可以有 0 个或多个元素，具有/具有任何名称，这是因为您添加了带有元素定义的`<any>`标签，`minOccurs="0"`并且由于您在它下`maxOccurs="Unbounded"`指定了它不会打扰它的子元素。`complexType``tuple`
`processContents="skip"``<any>`

例子：

```
<tuple>
  <foo>data</foo>
  <bar foobarattribute="foobardata">data</bar>
</tuple> 
```

如您所见，虽然XSD 中没有定义 and 及其属性，但它允许此 XML 为`foo`有效`bar`。**但它不允许属性在**`foobarattribute` **`<tuple>`**

 **> 编辑：

**第二种模式：** 与声明类型相同`anyType`

```
<xsd:element name="tuple" type="xs:anyType"/> 
```

这意味着它允许元组下的任何元素和任何属性。示例 XML 如下所示：

```
<tuple foo="bar">
   <foobar attrb="value">data</foobar>
</tuple> 
```

您可以观察到，与第一个示例 XML 不同，它也具有 under 属性`<tuple>`。

两个示例 XSD 代码之间的另一个重要区别是：在第一个代码中，您将 processContents 指定为“skip”：因此 XML 处理器不会尝试验证来自指定名称空间的任何元素。

在第二个代码中，对于 anyType，processContents 将是“宽松的”：因此 XML 处理器尝试获取所需名称空间的模式并验证元素。

希望能帮助到你..**

# svg - 将文本放入框的纯 SVG 方式

> ID：15430189
> 
> 赞同：74
> 
> 时间：2013-03-15T10:38:05.213
> 
> 标签：svg

盒子大小已知。文本字符串长度未知。在不破坏其纵横比的情况下使文本适合框。

![在此处输入图像描述](../Images/9190269a2f3fc296f7082c73e19e2ae7.png)

经过一晚上的谷歌搜索和阅读 SVG 规范，我很确定如果没有 JavaScript，这是不可能的。我能得到的最接近的是使用`textLength`and `lengthAdjust`text 属性，但这只会沿一个轴拉伸文本。

```
<svg width="436" height="180"
    style="border:solid 6px"
    xmlns="http://www.w3.org/2000/svg">
    <text y="50%" textLength="436" lengthAdjust="spacingAndGlyphs">UGLY TEXT</text>
</svg> 
```

![在此处输入图像描述](../Images/85baab81e696c0b2d8ef93b733af4e1e.png)

我知道[SVG Scaling Text 以适应容器](https://stackoverflow.com/questions/2938779/svg-scaling-text-to-fit-container)并将[文本放入框中](https://stackoverflow.com/questions/5933857/fitting-text-into-the-box)

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-03-22T16:18:08.133

我没有找到不用Javascript直接做的方法，但是我找到了一个非常简单的JS解决方案，没有for循环，也没有修改字体大小并且适合所有尺寸，也就是说，文本会增长到极限最短的一边。

基本上，我使用该`transform`属性，计算所需大小和当前大小之间的正确比例。

这是代码：

```
<?xml version="1.0" encoding="UTF-8" ?>
<svg version="1.2" viewBox="0 0 1000 1000" width="1000" height="1000" xmlns="http://www.w3.org/2000/svg" >
 <text id="t1" y="50" >MY UGLY TEXT</text>
 <script type="application/ecmascript"> 

    var width=500, height=500;

    var textNode = document.getElementById("t1");
    var bb = textNode.getBBox();
    var widthTransform = width / bb.width;
    var heightTransform = height / bb.height;
    var value = widthTransform < heightTransform ? widthTransform : heightTransform;
    textNode.setAttribute("transform", "matrix("+value+", 0, 0, "+value+", 0,0)");

 </script>
</svg>
```

在前面的示例中，文本会一直增长到`width == 500`，但如果我使用大小为`width = 500`and的框`height = 30`，那么文本会一直增长到`height == 30`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-19T11:27:53.487

首先：刚刚看到答案并不能完全满足您的需求 - 它可能仍然是一种选择，所以我们开始吧：

您正确地观察到 svg 不直接支持自动换行。但是，您可能会受益`foreignObject`于作为 xhtml 片段包装器的元素，其中可以使用自动换行。

看看这个独立的演示（~~在线提供[）](http://stack.collapsar.bplaced.net/data/so/svg/so.15430189.svg)~~：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- SO: http://stackoverflow.com/questions/15430189/pure-svg-way-to-fit-text-to-a-box  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg"
   xmlns:xhtml="http://www.w3.org/1999/xhtml"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   version="1.1"
   width="20cm" height="20cm"
   viewBox="0 0 500 500"
   preserveAspectRatio="xMinYMin"
   style="background-color:white; border: solid 1px black;"
>
  <title>simulated wrapping in svg</title>
  <desc>A foreignObject container</desc>

   <!-- Text-Elemente -->
   <foreignObject
      x="100" y="100" width="200" height="150"
      transform="translate(0,0)"
   >
      <xhtml:div style="display: table; height: 150px; overflow: hidden;">
         <xhtml:div style="display: table-cell; vertical-align: middle;">
            <xhtml:div style="color:black; text-align:center;">Demo test that is supposed to be word-wrapped somewhere along the line to show that it is indeed possible to simulate ordinary text containers in svg.</xhtml:div>
         </xhtml:div>
      </xhtml:div>
   </foreignObject>

  <rect x="100" y="100" width="200" height="150" fill="transparent" stroke="red" stroke-width="3"/>
</svg>
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-06-04T21:48:26.017

我已经开发了@Roberto 答案，但我们不是转换（缩放）textNode，而是简单地：

*   给它`font-size`的 `1em`开始
*   计算比例基于`getBBox`
*   设置`font-size`到那个比例

（您也可以使用`1px`等）

这是执行此操作的 React HOC：

```
import React from 'react';
import TextBox from './TextBox';

const AutoFitTextBox = TextBoxComponent =>
  class extends React.Component {
    constructor(props) {
      super(props);
      this.svgTextNode = React.createRef();
      this.state = { scale: 1 };
    }

    componentDidMount() {
      const { width, height } = this.props;
      const textBBox = this.getTextBBox();
      const widthScale = width / textBBox.width;
      const heightScale = height / textBBox.height;
      const scale = Math.min(widthScale, heightScale);

      this.setState({ scale });
    }

    getTextBBox() {
      const svgTextNode = this.svgTextNode.current;
      return svgTextNode.getBBox();
    }

    render() {
      const { scale } = this.state;
      return (
        <TextBoxComponent
          forwardRef={this.svgTextNode}
          fontSize={`${scale}em`}
          {...this.props}
        />
      );
    }
  };

export default AutoFitTextBox(TextBox); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-28T06:26:10.993

我认为它不是您想要做的解决方案，但您可以使用`textLength` 百分比`="100%"`来表示全宽。

```
<svg width="436" height="180"
    style="border:solid 6px"
    xmlns="http://www.w3.org/2000/svg">
    <text x="0%" y="50%" textLength="100%">blabla</text>
</svg> 
```

您还可以添加`textanchor="middle"`和更改`x`位置以使您的文本完美居中

这不会改变字体大小，你会有奇怪的空间字母间距......

[JSFIDDLE 演示](https://jsfiddle.net/kurokumosan/fz067vac/)

# mod-rewrite - mod rewrite - 多个变量

> ID：15430191
> 
> 赞同：0
> 
> 时间：2013-03-15T10:38:21.210
> 
> 标签：mod-rewrite

抱歉，如果这是一个基本解决方案，但 mod rewrite 仍然给我 gip。

我有一个当前的 mod 重写规则，可以将 slug 转换为可用的变量，如下所示：

```
RewriteRule ^/c/([a-z0-9_\-]+)/?.*$ /content.asp?slug=$1 [L] 
```

我需要添加第二个可选变量。只有蛞蝓很重要，第二个变量可能存在也可能不存在。

> www.domain.com/this-is-the-slug/

和

> www.domain.com/this-is-the-slug/optional-variable/

两者都应该工作。我试过：

```
RewriteRule ^/c/([a-z0-9_\-]+)/([a-z0-9_\-]+)/?.*$ /content.asp?slug=$1&scotland=$2 [L] 
```

但是现在每个页面（没有可选变量）只是重定向到根。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:48:50.713

我解决了。

我需要两个规则：

```
RewriteRule ^/c/([a-z0-9_\-]+)/([a-z0-9_\-]+)/?.*$ /content.asp?slug=$1&scotland=$2 [L]
RewriteRule ^/c/([a-z0-9_\-]+)/?.*$ /content.asp?slug=$1 [L] 
```

# java - REST API 输入的 Bean 验证和 API 版本控制

> ID：15430192
> 
> 赞同：2
> 
> 时间：2013-03-15T10:38:30.617
> 
> 标签：java, api, rest, bean-validation

我有一个像这样的豆子：

```
 @Data
  public static class ClassUnderTest {
    @NotNull
    private String field1;

    @NotNull
    @Since(2.0)
    private String field2;

    @NotNull
    @Until(3.0)
    private String field3;
  } 
```

`@Since`并且`@Until`是 Gson 注释，允许避免序列化/反序列化我的 REST API 上的某些字段，对于某些 API 版本。

我对此 API 的输入有效负载执行 bean 验证以引发约束违规。基于 Gson 注释（而不是组！），我希望能够不针对每个版本提出相同的违规行为。

* * *

有没有办法从 a`ConstraintViolation<T>`获取产生违规的`Member`（like `Method`/ `Field`），以便我检查它是否被某些东西注释？

有没有办法使用 Bean Validation 处理验证版本控制？

我唯一的解决方案似乎是从路径（`getPropertyPath`）中检索该成员，但这似乎并不容易......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T18:18:20.007

您可以通过从违规中检索属性名称`getPropertyPath()`。也就是说，将您的约束分配给与版本相对应的组可能是更好的方法。请注意，验证组也可以扩展现有组，这可能有助于在较新版本中添加的模型约束。

# windows-phone-7 - 在带有外部 URL 的 Windows Phone 7 上使用 PhoneGap/Cordova

> ID：15430196
> 
> 赞同：1
> 
> 时间：2013-03-15T10:38:37.967
> 
> 标签：windows-phone-7, cordova, plugins

我需要我的 Windows 7 Phonegap/Cordova 应用程序在启动时加载外部页面，而不是本地页面。

我确实找到了适用于 iOS 和 android 的解决方案，但我真的找不到适用于 windows phone 7 的可靠解决方案。

关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T12:46:02.667

**例如，通过CordovaView**控件（在 MainPage.xaml 上）的**StartPageUri**属性设置它

 **```
<my:CordovaView HorizontalAlignment="Stretch" 
                   StartPageUri = "http://mydomain/mypage.html"
                   Margin="0,0,0,0"  
                   Name="PGView" 
                   VerticalAlignment="Stretch" /> 
```**

# jquery - 检查 div 是否包含具有特定 href 值的锚点

> ID：15430201
> 
> 赞同：1
> 
> 时间：2013-03-15T10:38:46.150
> 
> 标签：jquery

再会

我想检查我的页面中是否有包含以下 url 的特定链接：

```
http://mysite.com/category/products 
```

我正在使用以下内容，但我认为它不正确（因为它不起作用）

```
if $('#breadcrumbs a.category').attr('href') == "http://mysite.com/category/products";
    alert('It is here!'); 
```

HTML 结构如下所示：

```
<div id="breadcrumbs">
<a class="category" href="">generated by php</a>
<a class="category" href="">generated by php</a>
<a class="category">generated by php</a>
</div> 
```

顶部链接将位于此层次结构中的某个位置...

谢谢你！

更新：[页面](http://asksomeone.co.za/face-master-1-4)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T10:41:20.240

您可以使用属性选择器：

```
if ($('#breadcrumbs .category[href="http://mysite.com/category/products"]').length > 0) {
    alert("It's here");
} 
```

文档：

[http://api.jquery.com/attribute-equals-selector/](http://api.jquery.com/attribute-equals-selector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:40:43.263

`attr`方法只返回第一个被选中元素的值，可以使用`filter`方法或`attr`选择器。

```
$(function() {
    var len = $('#breadcrumbs a.category').filter(function(){
         return this.href === 'http://mysite.com/category/products';
    }).length;

    if (len) {
        alert('It is here!');
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T10:46:09.307

尝试更短：

```
($('[href="http://mysite.com/category/products"]').length > 0) ? alert('Yes there are') : alert('oops'); 
```

### [在这个小提琴中试用](http://jsfiddle.net/Ces64/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T10:41:05.793

```
$('#breadcrumbs').click(function(){

 $(this).children('a').each(function(){
    if($(this).attr('href')=="your url")
        .....
 });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T10:44:27.953

```
$(document).ready(function() {
   if($('#breadcrumbs a.category').attr('href') == "http://mysite.com/category/products")
   {
       alert('It is here!');
   }    
}); 
```

# google-maps - 从 Google maps api v2 更改为 v3

> ID：15430204
> 
> 赞同：1
> 
> 时间：2013-03-15T10:38:48.933
> 
> 标签：google-maps, google-maps-api-3, google-geocoding-api

我已经使用谷歌地理编码 v3 大约 6 个月了，但它突然停止工作（我收到 610 错误）。它仅在上周左右停止。

然后我遇到了这个（见页面顶部的粉红色框！）：[https ://developers.google.com/maps/documentation/geocoding/v2/](https://developers.google.com/maps/documentation/geocoding/v2/)

我已经阅读了所有文档，但不知道从哪里开始！

我希望这是一个小小的改变，因为它需要很长时间才能做到这一点，有人可以帮忙吗？

[在此处查看完整网站][1]

* * *

更新：

```
require("database.php");
// Opens a connection to a MySQL server
$con = mysql_connect("localhost", $username, $password);

if (!$con)
{
    die('Could not connect: ' . mysql_error());
}

mysql_select_db("teamwork_poh", $con);

    $company = get_the_title();
    $address = get_field('address_line_1');
    $city = get_field('town_/_city');
    $post_code = get_field('post_code');
    $link = get_permalink();
    $type = get_field('kind_of_organisation');

    $sql = sprintf("select count('x') as cnt from markers where `name` = '%s'", mysql_real_escape_string($company));
    $row_dup = mysql_fetch_assoc(mysql_query($sql,$con));
    if ($row_dup['cnt'] == 0) {
        mysql_query("INSERT INTO markers (`name`, `address`, `lat`, `lng`, `type`, `link`) VALUES ('".$company."', '".$address.", ".$city.", ".$post_code."', '0.0', '0.0', '".$type."', '".$link."')");
    }
wp_reset_query();

require("database.php");

define("MAPS_HOST", "maps.googleapis.com");
define("KEY", "(my key)");

// Opens a connection to a MySQL server
$connection = mysql_connect("localhost", $username, $password);
if (!$connection) {
  die("Not connected : " . mysql_error());
}

// Set the active MySQL database
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
  die("Can\'t use db : " . mysql_error());
}

$query = "SELECT * FROM markers WHERE 1";
$result = mysql_query($query);
if (!$result) {
  die("Invalid query: " . mysql_error());
}

//Initialize delay in geocode speed

$delay=0;
$base_url = "http://" . MAPS_HOST . "/maps/api/geocode/json?address=";

while ($row = @mysql_fetch_assoc($result)) {
    if (!($row['lat'] * 1)) {
        $geocode_pending = true;

    while ($geocode_pending){

    $address = $row["address"];
    $id = $row["id"];

    $request_url = $base_url . "" . urlencode($address) ."&sensor=false";

    sleep(0.1);

$json = file_get_contents($request_url);
$json_decoded = json_decode($json);

$status = $json_decoded->status;

 if (strcmp($json_decoded->status, "OK") == 0) {

$geocode_pending = false;

      $lat = $json_decoded->results[0]->geometry->location->lat;
      $lng = $json_decoded->results[0]->geometry->location->lng;

// echo 'here';

      $query = sprintf("UPDATE markers " .
             " SET lat = '%s', lng = '%s' " .
             " WHERE id = '%s' LIMIT 1;",
             mysql_real_escape_string($lat),
             mysql_real_escape_string($lng),
             mysql_real_escape_string($id));
      $update_result = mysql_query($query);

      echo $id;

      if (!$update_result) {
        die("Invalid query: " . mysql_error());
      }
    }

   else {
 // failure to geocode
      $geocode_pending = false;
      echo "Address " . $address . " failed to geocode. ";
      echo "Received status " . $status . "\n";
    }

  //  usleep($delay);

    }
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T14:45:53.827

当您将坐标存储在数据库中时，最好在插入新记录时进行地理编码。IE

```
require("dbinfo.php");//Your database parameters
//Connect to database
$dbh = new PDO("mysql:host=$host;dbname=$database", $username, $password);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
try {
    //Prepare query
    $name = "%".$company."%";//Wildcard for PDO paramerter
    $countSql = "SELECT COUNT(*) FROM markers WHERE `name` LIKE ?"; 
    $countStmt = $dbh->prepare($countSql);
    // Assign parameter
    $countStmt->bindParam(1,$name);
    //Execute query
    $countStmt->execute();  
    // check the row count  
    if ($countStmt->fetchColumn() == 0) { #1 EDIT changed >0 to ==0
        echo "No row matched the query."; //EDIT  From Row
        $q =$address.','.$city.','.$post_code.',UK'; 
        echo "\n";
        $base_url = "http://maps.googleapis.com/maps/api/geocode/xml?address=";
        $request_url = $base_url.urlencode($q)."&sensor=false";
        $xml = simplexml_load_file($request_url) or die("url not loading");
        if($xml->status=="OK"){#2
            // Successful geocode
            $lat = $xml->result->geometry->location->lat;
            $lng = $xml->result->geometry->location->lng; 
            $insertSql ="INSERT INTO markers (`name`, `address`, `lat`, `lng`, `type`, `link`) VALUES (?,?,?,?,?,?)";
            $insertStmt = $dbh->prepare($insertSql);
            // Assign parameter
            $insertStmt->bindParam(1,$company);
            $insertStmt->bindParam(2,$address); 
            $insertStmt->bindParam(3,$lat);
            $insertStmt->bindParam(4,$lng);
            $insertStmt->bindParam(5,$type);
            $insertStmt->bindParam(6,$link);
            //Execute query
            $insertStmt->execute();
        } #2
        else{
            "No rows inserted."; 
        }#2
    } #1
    else {#1
    echo "Rows matched the query."; //EDIT From No row
    } #1 
}// End try 

catch(PDOException $e) {
    echo "I'm sorry I'm afraid you can't do that.". $e->getMessage() ;// Remove or modify after testing 
    file_put_contents('PDOErrors.txt',date('[Y-m-d H:i:s]').", myFile.php, ". $e->getMessage()."\r\n", FILE_APPEND);  
 } 
```

我已将您的代码转换为 PDO，因为建议停止使用[**mysql_**](http://www.php.net/manual/en/intro.mysql.php)函数，因为这些函数已被弃用。

我已经让您实现如何处理不返回坐标的地理编码。您还可以检查和处理以下状态码

OVER_QUERY_LIMIT

零结果

请求被拒绝

非法请求

状态码实现见[pastebin](http://pastebin.com/NVyC8xSA)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T21:32:25.583

根据我们之前的评论，只需进行一些更改即可让您重新站起来。

这些是，更改 v3 地理编码的地址

```
define("MAPS_HOST", "maps.googleapis.com");
$base_url = "http://" . MAPS_HOST . "/maps/api/geocode/xml?";
$request_url = $base_url . "address=" . urlencode($address) . "&sensor=false"; 
```

其次更改返回的 xml 文件中的路径以设置 lat/long

```
$coordinates = $xml->Response->Placemark->Point->coordinates;
$coordinatesSplit = split(",", $coordinates);
// Format: Longitude, Latitude, Altitude
$lat = $coordinatesSplit[1];
$lng = $coordinatesSplit[0]; 
```

可以完全替换为

```
$lat = $xml->result->geometry->location->lat;
$lng = $xml->result->geometry->location->lng; 
```

* * *

下一篇关于阻止它超过地理编码限制的文章。您需要做的是在运行地理编码之前设置一个简单的检查。

```
while ($row = @mysql_fetch_assoc($result)) {
    if (!($row['lat'] * 1)) {// add this line
        $geocode_pending = true;
            while ($geocode_pending){
                //do geocoding stuff
            }
        }
    }// add this close
} 
```

# sql - LINQ 外键中断查询

> ID：15430207
> 
> 赞同：0
> 
> 时间：2013-03-15T10:38:54.913
> 
> 标签：sql, sql-server, linq, sql-server-2008, foreign-keys

下面的 LINQ 查询 (personDevices) 没有任何问题。但是，当我将“123”替换为通过外键直接访问值时：

```
t3.deviceTypeA.mobile_number 
```

...查询返回 0 个结果。最终我想做一个如下的选择语句：

```
number = 
t3.type == "phone" ? t3.deviceTypeA.mobile_number:
t3.type == "computer" ? t3.deviceTypeB.computer_number :
t3.type == "legacy" ? t3.deviceTypeC.legacy_number :
"nodata" 
```

这解释了为什么我需要外键，但我已经简化了问题的查询。

```
var personDevices = from t1 in db.people
join t2 in db.peopleDevices on t1.person_id equals t2.person_id
join t3 in db.deviceRegistrations on t2.registration_id equals t3.registration_id

select new {
  t1.person_id,
  t1.name,
  t3.type,
  t3.generated_code,
  t3.hardware_id,
  devicetypeA_number = "123"
}; 
```

由于各种原因，我在外键上禁用了参照完整性并删除了数据检查。使用 SQL Server 2008 并在 C# .NET 4 下运行查询。

为什么访问外键表中的数据会导致查询没有返回结果，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T14:11:51.140

我永远无法解决这个问题。相反，我更改了数据库结构，以便可以通过 device_type 字段在一个表中引用所有 3 种设备类型，并为两种不同类型的参考编号重新使用一列。

是的，设计没有完全标准化，但要简单得多。

我还最终使用了内联查询，因为我倾向于从 LINQ 获得的结果与我的期望不符，所以由于时间限制，我放弃了，选择了简单的选项，而不是乱七八糟。

# regex - 在 Notepad++ 中使用正则表达式进行迭代？

> ID：15430208
> 
> 赞同：0
> 
> 时间：2013-03-15T10:38:55.440
> 
> 标签：regex, notepad++, loops

我有一个这样的文本文件：

```
(A) foo
(B) bar
(B) eggs
x spam 
```

(A)、(B)等是优先标签。它们被更改，之后对文件进行排序，以使带有 prio (A) 的行位于顶部。我想知道是否有一个单行正则表达式搜索和替换，它将只替换第一个标签（A），第一个（B）等等，用 CR/LF [标签]，所以文件看起来像这样：

```
(A) foo

(B) bar
(B) eggs

x spam 
```

制作执行此操作的脚本很容易。但是，在 Notepad++ 中可作为宏调用的正则表达式将是完美的。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:47:18.433

这样的事情应该这样做：

代替

```
(\([^)]*\))(.*\r\n)(?!\1) 
```

和

```
\1\2\r\n 
```

**解释：**

`[^)]*`表示零个或多个非`)`.
`\([^)]*\)`- 只是在括号中得到一些东西（你需要逃避`(`和`)`with `\`）。
将它包围`()`存储在第一组中（用于`\1`获取它）。
`.*\r\n`- 后面跟新行的任何内容。
将其包围`()`存储在第二组中（用于`\2`获取它）。
`(?!\1)`- 负前瞻，相同的标签不应该出现在下一行。

# php - 使用 HTML/PHP 创建了一个插入论坛，但在添加一定数量的内容时出现错误

> ID：15430209
> 
> 赞同：0
> 
> 时间：2013-03-15T10:38:59.793
> 
> 标签：php, html, mysql

我对此很陌生，这是我决定加倍努力的大学项目的一部分。

我创建了一个 HTML 表单来将行插入到 MYSQL 数据库的表中。当输入有限数量的字符时，表单工作正常，但是当我尝试超过一定数量时，我得到一个错误。我对所有列都使用了 VARCHAR，它们的限制远远高于我试图插入的文本。

这是我的代码

```
<html>
 <body>
   <h1>Add new entries to Home and News page here</h1>

    <form action="insert.php" method="post">
        <br>Date: <input type="date" name="date"></br>
        <br>Title: <input type="text" name="title"></br>
        <br>Body:<input type="text" name="body" </br>
        <br>Media: <input type="text" name="media"></br>
        <br>ID: <input type="text" name="id"</br>
        <input type="submit">
   </form>

 </body>
</html> 
```

和 PHP

```
<?php
   $con=mysqli_connect("***","****","****","*****");  
    // Check connection
   if (mysqli_connect_errno()) {
        echo "Failed to connect to MySQL: " . mysqli_connect_error();
   }

   $sql = "INSERT INTO news (date, title, body, media, id)
           VALUES
           ('$_POST[date]','$_POST[title]','$_POST[body]','$_POST[media]','$_POST[id]')";

   if (!mysqli_query($con,$sql)) {
        die('Error ' . mysqli_error());
   }

    echo "1 record added";

   mysqli_close($con);
?> 
```

正确方向的一点将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:49:38.163

您收到的错误是什么？请注意您的错误捕获可能不正确，请尝试：

```
die ('Error: '.mysqli_error ($con)); 
```

我注意到您没有逃避（确保安全）用户发送的数据。因此，例如，如果我将“标题”设置为：

```
This is my title, '; SQL INJECTION; ' 
```

我会破坏你的代码：

```
INSERT INTO news (date, title, body, media, id)
VALUES
('date','This is my title, '; SQL INJECTION; '','body','media','id')"; 
```

您可以使用任何“转义”（确保安全）您输入查询的值的方法来解决此问题。实际上有一百种方法可以做到这一点，如果你被要求使用 mysqi_*() 函数，你可以这样做：

```
$date = mysqli_real_escape_string ($con, $_POST['date']);
$title = mysqli_real_escape_string ($con, $_POST['title']);
$body = mysqli_real_escape_string ($con, $_POST['body']);
$media = mysqli_real_escape_string ($con, $_POST['media']);
$id = mysqli_real_escape_string ($con, $_POST['id']);

$sql = "INSERT INTO news (date, title, body, media, id)
       VALUES
       ('$date','$title','$body','$media','$id')"; 
```

**因此，对正在发生的事情进行解释：（** XKCD[关于这个主题有一个很好的笑话。](http://xkcd.com/327/)）

如果没有 mysqli_real_escape_string，您将使用用户通过表单发布的任何内容构建 SQL 查询 ($sql)。这一切都很好而且很花哨，只要它们最终不会改变您的 SQL 语句。

因此，如果他们插入单引号：'，SQL 将最终无效，因为例如“VALUES ('$title')”可能会变成“VALUES ('An Adventure's Dream')”，请注意 MySQL 将如何查看“冒险”作为价值，而“梦想”作为一些破碎的东西结束？

通过包含“mysqli_real_escape_string()”，任何错误符号（如单引号）都会被*转义*，这对于 MySQL 意味着在其前面添加一个“\”。这告诉 MySQL 忽略该符号 - 并将其视为数据，而不是 SQL 命令。

为了便于调试 - 我建议放置：

```
 print "<pre>$sql</pre>"; 
```

就在你创建 $sql 之后。这样您就可以准确地看到发送到 MySQL 的内容。

（我个人更喜欢使用 PHP 的 PDO 库——如果你对这个主题感兴趣，值得一读。它有一些很酷的功能来转义东西 :)）

真的希望你喜欢学习你的学位！

仅供参考： VARCHAR(255) 应该默默地将您的数据切成 255 个字符长，而不会引发错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:43:15.220

那是因为在 mysql 中您填写了例如您的正文包含 varchar(255)，这意味着新闻正文只能包含 255 个字符，这也包括空格。

如果您希望能够填写更多字符，只需将数字 varchar(5000) 例如更大

# javascript - 如何在重新渲染的区域重新执行脚本？

> ID：15430210
> 
> 赞同：0
> 
> 时间：2013-03-15T10:39:00.137
> 
> 标签：javascript, richfaces, ajax4jsf

我使用richfaces / ajax4jsf 部分重新渲染页面的区域，这是一个精简的示例：

```
<a4j:commandButton value="..." reRender="infoBlock" action="#{...}"/>
<h:panelGrid id="infoBlock">
  <h:outputText value="..."/>
  <f:verbatim>
    <script type="text/javascript">
      console.log('test')
    </script>
  </f:verbatim>
</h:panelGrid> 
```

我的问题是，`console.log('test')`重新渲染 infoBlock 时脚本不会重新执行。

顺便说一句，我知道我可以删除脚本标签并`oncomplete="console.log('test')"`在上面的示例中使用。但是，在实际应用程序中，由我使用的组件渲染的脚本更加复杂，因此更改它可能非常棘手。

所以我的问题是：如何在重新渲染的区域重新执行脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T04:47:32.323

您提供的代码示例完全符合您的要求。每次单击按钮时，`test`文本都会写入控制台。这是 RichFaces 中的开箱即用行为 - 重新渲染区域中的脚本被重新评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:51:06.013

脚本应该是静态的，它们操作的数据应该是动态的，所以不要尝试这样做。相反，当重新渲染区域时，执行一些回调，对一些更改的动态数据进行操作。你已经有了一个机制：`oncomplete="rerendered('infoBlock')"`.

然后，您将在某处拥有静态代码来读取动态数据并对其进行处理 - 静态代码不应嵌入页面上的脚本元素中：

```
function rerendered(regionName) {
   //Do something depending on regionName
} 
```

至于为什么它不能按原样工作，我们需要去一个“更低”的层次。

给定的脚本元素对象有一个标志，它告诉内容是否已经被执行，当一个脚本元素被插入到主 DOM 树时，它只有在标志是 时才会执行`false`。

使用`.innerHTML`或这样的时候，html里面的脚本元素根本不执行。

似乎上述任何一种机制都在使用中。

# iphone - 仪器未显示负责任的图书馆

> ID：15430211
> 
> 赞同：-2
> 
> 时间：2013-03-15T10:39:03.083
> 
> 标签：iphone, ios, profiling, instruments, xcode-instruments

我正在运行仪器来分析我的应用程序中的内存泄漏，

但它没有显示任何负责任何分配的库： ![在此处输入图像描述](../Images/67394ebcf981fabcf674055e459254c0.png)

它既没有在堆栈跟踪中显示任何方法/变量，也只是显示了这一点： ![在此处输入图像描述](../Images/364cfa231eee1ab847fd82c14a3408bd.png)

有什么我缺少的设置吗？它以前显示过，最近才停止显示这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T19:05:09.573

这是我目前如何配置的几个屏幕截图。也许这些会有所帮助。我要做的第一件事是检查以确保在当前方案中，您将“配置文件”构建配置设置为调试，如下面的第一张图片所示。

另外，您是否尝试过右键单击“负责任的图书馆”标题以删除复选标记并像我上一个屏幕截图一样重新添加它，给它一个虚拟的打击？我会继续寻找，看看我是否能找到其他更有帮助的东西。

![在此处输入图像描述](../Images/a15dbf3b3e9eb2ef9d07501a77b65852.png)

![截图 1](../Images/bcec2fc6c7d03034a196871d3970603b.png)

![在此处输入图像描述](../Images/9b60ca14c858937a0d794c15b7fac880.png)

![在此处输入图像描述](../Images/ab08303842c4207a80743e9e51297a94.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-02T22:48:13.480

关闭仪器。确保 Spotlight 索引您的构建工件。您可以通过从命令行运行 mdimport 手动执行此操作。重新打开仪器。

显然，请确保您的派生数据位置等不在 Spotlight 的黑名单中。这由系统偏好设置控制。

Instruments 的很多工作都依赖于 Spotlight。

# jquery-mobile - jquery mobile data-native-menu 与 data-history 属性

> ID：15430212
> 
> 赞同：2
> 
> 时间：2013-03-15T10:39:04.450
> 
> 标签：jquery-mobile

```
<div data-role="fieldcontain">
    <select data-mini="true" data-inline="false" data-history="false" data-native-menu="false" data-theme="d" data-overlay-theme="b" name="elArr[]">
        <option value="" data-placeholder="true">test</option>
        <option value="1">1</option>
    </select>
</div> 
```

嗨，我喜欢同时使用 data-native-menu 和 data-histroy 属性。数据历史属性不起作用。打开本机菜单时，它会将 hash ui-state=dialog 添加到位置栏。

# php - 如何通过 URL 直接访问文件来防止下载？

> ID：15430213
> 
> 赞同：3
> 
> 时间：2013-03-15T10:39:16.273
> 
> 标签：php, url, hotlinking

我正在制作一个在线流媒体网站，用户可以在其中收听音频或视频文件。目前我正在使用以下代码在音频标签中调用 mp3 文件。

```
<a href="www.domain.com/path-to-audio/file.mp3">Play</a> 
```

在我的网站中，用户可以流式传输歌曲但无法下载。下载是付费的。上面的代码是流式传输音频文件最糟糕的事情，因为当用户将上面的链接复制并粘贴到他的浏览器上时，歌曲将被下载。

如何在没有 URL 下载选项的情况下安全地流式传输文件（用户无法复制歌曲 url 并下载它）。

我正在使用 CodeIgniter（PHP 框架），那么如何限制用户直接下载文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:41:36.380

您可以使用 some`.htaccess`将所有下载请求定向到您的`PHP`脚本，而不是调用真实文件。然后您的脚本可以验证用户是否已登录，然后它才会发出下载响应。否则，即使有人获得了 url，它也不会为他们工作，因为请求会发送到您的 PHP 脚本并且文件本身不会自动提供

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:47:29.907

看看这个[创建临时 URL](http://www.rackspace.com/blog/rackspace-cloud-files-how-to-create-temporary-urls/)。您也可以为您的域做类似的事情。

# facebook - 用户点击 Facebook 分享链接并返回您的网站后，文章在模式窗口中打开

> ID：15430218
> 
> 赞同：-1
> 
> 时间：2013-03-15T10:39:36.520
> 
> 标签：facebook, joomla, joomla1.5

我想我需要你的帮助...在我的网站上，我通过单击每篇文章中存在的“阅读更多”链接，在模态窗口中打开了所有文章。

此外，每篇文章都有一个按钮，可以在 Facebook 上分享这篇文章。

但是，当将在 facebook 上看到我的文章的用户，单击此链接阅读文章时，它会回到我的页面，但文章（逻辑）没有在模态窗口中打开！！！

有什么办法，在我网站的用户“返回”中，按下facebook的链接后，在模态窗口中自动打开这篇文章？或者，如果上述问题无法完成，是否有任何方法可以自定义我发送到 facebook 的链接，在按下 facebook 的链接后将其设置为用户对我网站的“返回”，以显示文章在介绍视图中而不是在全视图中？

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T14:58:53.757

我在我的网站中使用模态窗口，并使用以下 HTML 代码在弹出窗口中打开一篇文章：

```
<a class="modal" rel="{handler: 'iframe', size: {x: 680, y: 370}}" href="yourarticleid=759&tmpl=component&task=preview">Open a link in modal</a> 
```

上面的方法使用了创建模态窗口的native函数并调用了你需要显示的文章。但是，由于 Facebook 格式化了所有发布的链接，我认为您无法包含触发模式窗口的关键代码（如下）。

```
class="modal" rel="{handler: 'iframe', size: {x: 680, y: 370}}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T15:25:06.087

这是一种解决方案，换句话说，一个想法，在用户单击 facebook 共享链接然后返回您的站点后，使您的文章在模态窗口中打开。

就我而言，我这样做了...

要在我的站点中打开模态窗口，我正在使用来自**nonumber.nl**的扩展模态化器。`&ml=1`此扩展在文章网址的末尾添加了类似的内容。来自 facebook 的链接最后不包含这个`&ml=1`。所以...

**1.**首先，在我的文章内容中，我应该包括模态的行为。

**2.**然后，我应该让我的代码检查 url末尾是否有这个**&ml=1 。**

**3.**之后，我应该决定我的代码在这两种情况下会做什么。所以，如果**&ml=1已经存在，我什么也不想做，如果 &ml=** **1**不存在，我想在模式窗口中打开 facebook 的 url 。我还希望每次关闭模态窗口以加载**index.php**，否则用户将在前端视图中看到我的文章。

这是所有这些的代码：

```
<?php JHTML::_('behavior.modal'); 

      $url= 'http://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];
  if (strstr($url, "&ml=1")){/* Do nothing */} 
else {?> <a class="modal" id="modalWindowLink" href="<?php echo $url ?>"></a>
         <script>
         window.addEvent('domready', function(){
         window.addEvent('load', function(){ SqueezeBox.fromElement($('modalWindowLink')); });
     });

         SqueezeBox.addEvent('onClose', function(){ window.location = 'index.php'; });
         </script>
     }
     <?php } ?> 
```

如果您有更好的想法，或者如果您看到可以通过其他方式更好地工作的东西，请告诉我！！！

# heroku - Heroku 应用程序扩展 web dyno 的关键指标是什么

> ID：15430223
> 
> 赞同：1
> 
> 时间：2013-03-15T10:39:46.587
> 
> 标签：heroku, newrelic

我在 Heroku 上使用 New Relic 标准和 Rails 3 来构建一个网站。但不确定当满足某些标准时，我应该关注 New Relic 上显示的哪些指标来扩大网络动态？

比如说，指标 A 达到 X 水平，我应该添加一个 Dyno 来放下它。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:34:25.913

主要是你想查看你的日志和heroku [路由器]上的队列属性 - 如果这开始上升（并且重要的是保持不变）那么你有太多的请求正在排队并且不能足够快地处理.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:24:26.993

如果您在 New Relic 仪表板中看到较长的队列等待时间并且没有其他好的解释（即响应时间的高度可变性、使用瘦 Web 服务器而不是 Unicorn 等），这通常是一个很好的指示请求是在队列中等待由测功机处理。

# google-maps - 谷歌地图标记未显示整个 xml

> ID：15430224
> 
> 赞同：1
> 
> 时间：2013-03-15T10:39:52.527
> 
> 标签：google-maps, google-maps-markers

我在我的网站上使用谷歌地图 API。地图从 xml 中获取数据，然后使用经度和纬度在各个位置上显示标记。但是，我在 xml 中有 500 多个条目，但地图并未显示所有条目。谁能帮帮我。我需要地图上整个 xml 的标记。地图显示在“ [http://saleon.com.pk/](http://saleon.com.pk/) ”上，地图使用的 xml 文件是“ [http://saleon.com.pk/test/generate.php](http://saleon.com.pk/test/generate.php) ”。对于谷歌地图，我的代码是这样的：

```
 <script type="text/javascript">
  var infowindow;
  var map;
  function initialize(str,category,city,minprice,maxprice,flag) {

var myLatlng = new google.maps.LatLng(30.55538, 73.13690);
    var myOptions = {
      zoom: 5,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    downloadUrl("<?php echo WEB_PATH;?>test/generate.php", function(data){
      var markers = data.documentElement.getElementsByTagName("marker");
      for (var i = 0; i < markers.length; i++) {
        var latlng = new google.maps.LatLng(parseFloat(markers[i].getAttribute("lat")),
                                    parseFloat(markers[i].getAttribute("lng")));
        var marker = createMarker(markers[i].getAttribute("name1"),markers[i].getAttribute("name2"), markers[i].getAttribute("img"), markers[i].getAttribute("description"), markers[i].getAttribute("id"), latlng);
       }
     });

    function createMarker(name1,name2, img, description, id, latlng) {
    var marker = new google.maps.Marker({position: latlng, map: map});
    google.maps.event.addListener(marker, "click", function() {
      if (infowindow) infowindow.close();
      infowindow = new google.maps.InfoWindow({content: '<div style="float:left;"><img src="<?php echo WEB_PATH;?>'+img+'" width="75px" height="75px" /></div><div style="float:left; margin-left:10px; font:Arial;"><div style="font-weight:bold;">'+name1+'<br/>'+name2+'</div><div style="width:200px;">'+description+'</div><div><a href="<?php echo WEB_PATH;?>index.php?page=item&id='+id+'">View Product</a></div></div>'});
      infowindow.open(map, marker);
    });
    return marker;
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:01:25.567

您在 xml 文件中为这么多标记定义了相同的纬度和经度。例如 lat="33.718151" lng="73.060547" 出现在 52 个条目中。您的标记将被覆盖，因为它们位于同一位置。对于在同一位置有多个标记的情况，您可以在距离实际点的半径范围内稍微偏移标记（例如 0.001 度）。这也应该产生一个很好的视觉效果。

# boost - 带有 QtConcurrent::Exception 和 boost::exception 的异常

> ID：15430227
> 
> 赞同：1
> 
> 时间：2013-03-15T10:39:59.930
> 
> 标签：boost, exception-handling, qt4

我想使用基异常类派生自的异常层次结构，`boost::exception`以便我可以获得该类必须提供的良好且有用的诊断信息，**以便** `QtConcurrent::Exception`我可以跨线程抛出异常。

因此，我的基本异常类如下所示：

```
class MyException : public QtConcurrent::Exception, public boost::exception
{
public:
    MyException() { };
    virtual ~MyException() throw() { }

    // required by QtConcurrent::Exception to be implemented
    virtual void raise() const { throw *this; }
    virtual MyException* clone() const { return new MyException(*this); }
}; 
```

Per`QtConcurrent::Exception`的文档，`raise()`并且`clone()`必须在派生自`QtConcurrent::Exception`. 因此，我的其余代码可能类似于：

```
void foo()
{
    BOOST_THROW_EXCEPTION(MyException());
}

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    try
    {
        foo();
    }
    catch (const MyException& me)
    {
        std::cerr << boost::diagnostic_information(me);
    }

    return 0;
} 
```

但是，使用`BOOST_THROW_EXCEPTION()`宏会导致以下编译错误：

> 错误 C2555：“boost::exception_detail::clone_impl::clone”：覆盖虚函数返回类型不同，并且与“MyException::clone”不协变

我不完全确定这个错误告诉我什么（我敢肯定，我的错，不是错误！）。

如果我改为使用`throw MyException();`代码编译就好了。正如我上面提到的，我想使用`BOOST_THROW_EXCEPTION()`以便在我的异常中获取诊断信息。

我知道一个可能的解决方法可能是另一个派生自`QtConcurrent::Exception`具有 boost::exception 成员的类，本质上是实际错误的容器。但如果可能的话，我想继续让这个`MyException`类继承自`QtConcurrent::Exception`boost::exception 和 boost::exception。

有人可以提供一些关于错误在说什么的见解吗？有什么办法可以完成我想要的吗？

# android - Eclipse+CDT 用于 Ubuntu 12.10 上的 Android NDK

> ID：15430229
> 
> 赞同：-2
> 
> 时间：2013-03-15T10:40:05.810
> 
> 标签：android, linux

有人尝试在 Ubuntu 12.10 64 位上使用 Eclipse+CDT 进行 Android NDK 开发吗？我在 Ubuntu 10 上做了，一切正常，但现在我开始在一台新机器上，我想知道在 Ubuntu 12.10 上是否也能正常工作。在互联网上，我没有找到任何说我可以和任何说我不能的东西。我试过了，它比相同硬件上的 10.04 慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:28:38.010

我正在研究这个配置，它工作得很好。

# php - 通过 json_decode 解码 JSON 输入时出错

> ID：15430236
> 
> 赞同：0
> 
> 时间：2013-03-15T10:40:39.987
> 
> 标签：php, json, implode

我正在编写我的第一个 Web 服务，但我遇到了与 JSON 数据传递相关的问题。我的 Web 服务分为两个文件：**controller.php**包含服务处理程序，以及**service.php**包含应请求提供的类和方法。

这是来自 controller.php 的*获取*片段：

```
 public function atender() {
        // pre-procesamos la petición
        if (!empty($_POST)) {
            if (!empty($_POST["class"]) && !empty($_POST["action"]) && !empty($_POST["function"])) {
                $clase = ucwords($_POST["class"]);
                $metodo = "{$_POST["action"]}{$this->obtenerMetodo($_POST["function"])}";
                $id = (!empty($_POST["datos"]) ? stripslashes($_POST["datos"]) : null); 
```

我可以在 GET 和 POST 模式下处理请求（我将 GET 用于不需要身份验证的方法，例如**getCategories**、**getCategoryById**、**getProducts**和**getProductById**。这些是获取寿司餐厅菜肴类别和菜肴的方法。）

对于任何 GET 请求，一切都按预期进行。当我处理 POST 请求时，我的问题就来了。我需要以 JSON 格式获取所有 URL 参数，因为这是为 iOS 应用程序提供服务，而 JSON 是我们处理传入/传出数据的方式。

这是来自 service.php 的*处理*片段：

```
 public function putUser($datos) {
        if (!empty($datos)) {
            $usuario = json_decode($datos);
            $this->log .= implode("/", $usuario) . "\r\n"; 
```

在这种情况下，**$datos**是来自请求的 JSON 编码数据。它在 controller.php （上面的代码）中作为**$id接收。**因为这是我的第一个 Web 服务，所以我很可能在这里做了一些非常糟糕的事情，但我有点失明。

我尝试了服务处理代码的不同变体。使用 json_decode($datos, true) 也不起作用。我明白了

> 'Unexpected token <' 作为响应，并以原始形式（使用 Google Chrome 的高级 REST 客户端）显示：''Warning: implode() [ `<a href='function.implode'>function.implode</a>`]: Invalid arguments pass in /home/refine/public_html/sushigo/palma /service.php 在第 344 行'。

我知道 SOAP 通常是编写此类自定义代码的更好替代方案，但现在，我需要坚持使用此代码并为我的下一个项目实现更好的替代方案。你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:58:45.633

基本上，错误消息说它不是一个有效的 JSON - 而且这样的错误消息通常是正确的。

您的错误出现在发送/接收代码中。可能您以一种形式发送 JSON 并尝试以其他方式访问它。由于我无法查看电话发送的请求，我猜想：

*   您将数据作为 application/json 发送并尝试以 url 编码形式接收它。如果您不了解其中的区别，那么这就是您的问题。
*   您在 JSON 数据上使用了带斜杠，这是错误的。除非你打开了magic_quotes，这也是错误的（即：magic_quotes 和stripslashes 都必须去）。

# c++ - 使用 OpenMP 优化双线性插值

> ID：15430243
> 
> 赞同：1
> 
> 时间：2013-03-15T10:40:56.617
> 
> 标签：c++, opencv, parallel-processing, openmp, hpc

我正在研究 ARM，我正在尝试优化对图像的下采样，我使用了 OpenCV cv::resize 并且它对于 1280*960 到 400*300 的速度慢约 3ms，我正在尝试使用 OpenMP 来加速它，但是在将并行用于声明时，图像已被扭曲。我知道这与线程之间的私有变量和共享数据有关，但我找不到问题。

```
void  resizeBilinearGray(uint8_t *pixels, uint8_t *temp, int w, int h, int w2, int h2) {

    int A, B, C, D, x, y, index, gray ;
    float x_ratio = ((float)(w-1))/w2 ;
    float y_ratio = ((float)(h-1))/h2 ;
    float x_diff, y_diff;
    int offset = 0 ;

#pragma omp parallel for
    for (int i=0;i<h2;i++) {
        for (int j=0;j<w2;j++) {
            x = (int)(x_ratio * j) ;
            y = (int)(y_ratio * i) ;
            x_diff = (x_ratio * j) - x ;
            y_diff = (y_ratio * i) - y ;
            index = y*w+x ;

            // range is 0 to 255 thus bitwise AND with 0xff
            A = pixels[index] & 0xff ;
            B = pixels[index+1] & 0xff ;
            C = pixels[index+w] & 0xff ;
            D = pixels[index+w+1] & 0xff ;

            // Y = A(1-w)(1-h) + B(w)(1-h) + C(h)(1-w) + Dwh
            gray = (int)(
                        A*(1-x_diff)*(1-y_diff) +  B*(x_diff)*(1-y_diff) +
                        C*(y_diff)*(1-x_diff)   +  D*(x_diff*y_diff)
                        ) ;

            temp[offset++] = gray ;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:26:13.313

我认为你的问题是`offset`变量。由于许多线程可以同时工作，所以你永远不知道哪个线程会先更新偏移量。这就是生成的图像失真的原因。

更好的策略是迭代生成的图像像素。对于每个结果像素，您可以找到源图像像素的坐标，执行插值并写入结果。这样，您可以确定每个线程都在不同的像素上工作，并且在正确的像素上工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T08:15:29.760

为什么不尝试用 temp[i*w2 + j] 替换 temp[offset++]？

您的偏移量有多个问题。一方面，它有一个竞争条件。但更糟糕的是，OpenMP 为每个线程分配了非常不同的 i 和 j 值，因此它们正在读取内存的非相邻部分。这就是您的图像失真的原因。

除了 OpenMP，您还可以尝试其他几种方法来加速您的代码。我不了解 ARM，但在 Intel 上，您可以通过 SSE 大大加快速度。此外，您可以尝试固定浮点数。我在双线性插值中发现了两者的加速。fastcpp.blogspot.no/2011/06/bilinear-pixel-interpolation-using-sse.html

# java - 为什么要以初始容量启动 ArrayList？

> ID：15430247
> 
> 赞同：157
> 
> 时间：2013-03-15T10:41:06.127
> 
> 标签：java, data-structures, arraylist, capacity

通常的构造函数`ArrayList`是：

```
ArrayList<?> list = new ArrayList<>(); 
```

但是还有一个重载的构造函数，它的初始容量带有一个参数：

```
ArrayList<?> list = new ArrayList<>(20); 
```

`ArrayList`当我们可以随心所欲地附加到它时，为什么创建一个具有初始容量的有用？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2013-03-15T10:41:57.250

如果您事先知道 的大小将`ArrayList`是多少，则指定初始容量会更有效。如果你不这样做，随着列表的增长，内部数组将不得不重复重新分配。

最终列表越大，通过避免重新分配节省的时间就越多。

也就是说，即使没有预先分配，`n`在 an 的后面插入元素`ArrayList`也可以保证花费总`O(n)`时间。换句话说，附加一个元素是一个摊销的常数时间操作。这是通过让每个重新分配以指数方式增加数组的大小来实现的，通常是`1.5`. 使用这种方法，操作的总数[可以显示为`O(n)`](http://www.wolframalpha.com/input/?i=sum%281.5%2a%2ak%29%20for%20k=1,log%281.5,n%29)。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-03-15T10:47:03.330

因为`ArrayList`是一个[动态调整大小的数组](http://en.wikipedia.org/wiki/Dynamic_array)数据结构，这意味着它被实现为一个具有初始（默认）固定大小的数组。当它被填满时，数组将被扩展为一个双倍大小的数组。此操作成本高昂，因此您希望尽可能少。

因此，如果您知道上限是 20 个项目，那么创建初始长度为 20 的数组比使用默认值（例如 15）更好，然后将其调整为`15*2 = 30`仅使用 20，同时浪费循环进行扩展。

PS - 正如 AmitG 所说，扩展因子是特定于实现的（在这种情况下`(oldCapacity * 3)/2 + 1`）

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-03-15T10:44:05.860

Arraylist 的默认大小为**10**。

```
/**
 * Constructs an empty list with an initial capacity of ten.
 */
public ArrayList() {
    this(10);
} 
```

因此，如果您要添加 100 条或更多记录，您可以看到内存重新分配的开销。

```
ArrayList<?> list = new ArrayList<>();    
// same as  new ArrayList<>(10); 
```

因此，如果您对将存储在 Arraylist 中的元素数量有任何想法，最好创建具有​​该大小的 Arraylist，而不是从 10 开始然后继续增加它。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-03-16T05:44:04.843

实际上，我在 2 个月前就该主题写了[一篇博文。](http://www.growingwiththeweb.com/2013/01/manipulating-size-of-list.html)这篇文章是针对 C# 的，`List<T>`但 Java 的`ArrayList`实现非常相似。由于`ArrayList`是使用动态数组实现的，因此它会按需增加大小。所以容量构造函数的原因是为了优化目的。

当这些调整大小操作之一发生时，ArrayList 将数组的内容复制到一个新数组中，该数组的容量是旧数组的两倍。此操作在*O(n)*时间内运行。

## 例子

这是一个如何`ArrayList`增加大小的示例：

```
10
16
25
38
58
... 17 resizes ...
198578
297868
446803
670205
1005308 
```

所以列表以容量 开始`10`，当添加第 11 项时，它会增加`50% + 1`to `16`。第 17 项`ArrayList`再次增加到`25`以此类推。现在考虑我们正在创建一个列表的示例，其中所需容量已被称为`1000000`. 创建`ArrayList`没有大小构造函数的将调用通常`ArrayList.add` `1000000`需要*O(1)*或调整大小需要 O *(n)*的时间。

> 1000000 + 16 + 25 + ... + 670205 + 1005308 = **4015851 次操作**

使用构造函数进行比较，然后调用`ArrayList.add`保证在*O(1)*中运行。

> 1000000 + 1000000 = **2000000 次操作**

## Java 与 C#

Java 如上所述，从 开始`10`并增加每次调整大小`50% + 1`。C# 从开始`4`并以更积极的方式增加，每次调整大小都会翻倍。上面 C#的`1000000`添加示例使用`3097084`操作。

## 参考

*   [我在 C# 的 List<T> 上的博文](http://www.growingwiththeweb.com/2013/01/manipulating-size-of-list.html)
*   [Java 的 ArrayList 源代码](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/ArrayList.java)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-03-15T10:42:43.160

将 ArrayList 的初始大小设置为 ，例如`ArrayList<>(100)`，可以减少重新分配内部存储器的次数。

**例子：**

```
ArrayList example = new ArrayList<Integer>(3);
example.add(1); // size() == 1
example.add(2); // size() == 2, 
example.add(2); // size() == 3, example has been 'filled'
example.add(3); // size() == 4, example has been 'expanded' so that the fourth element can be added. 
```

正如您在上面的示例中看到的 -`ArrayList`如果需要，可以扩展 an。这并没有向您显示 Arraylist 的大小通常会翻倍（尽管请注意，新大小取决于您的实现）。以下引自[Oracle](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)：

> “每个 ArrayList 实例都有一个容量。容量是用于存储列表中元素的数组的大小。它始终至少与列表大小一样大。随着元素被添加到 ArrayList，它的容量会自动增长。除了添加一个元素具有恒定的摊销时间成本这一事实之外，没有具体说明增长政策的细节。”

显然，如果你不知道你将持有什么样的范围，设置大小可能不是一个好主意 - 但是，如果你确实有一个特定的范围，设置一个初始容量将提高内存效率.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-15T10:45:51.457

ArrayList 可以包含许多值，并且在进行大量初始插入时，您可以告诉 ArrayList 在开始时分配更大的存储空间，以免在尝试为下一项分配更多空间时浪费 CPU 周期。因此，在开始时分配一些空间更有效。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-03-15T12:09:46.930

这是为了避免为每个对象重新分配可能的努力。

```
int newCapacity = (oldCapacity * 3)/2 + 1; 
```

内部`new Object[]`创建。当您在 arraylist 中添加元素时，
JVM 需要努力创建 。`new Object[]`如果您没有上述代码（您认为的任何算法）进行重新分配，那么每次调用`arraylist.add()`then时`new Object[]`都必须创建，这是没有意义的，我们正在浪费时间将每个要添加的对象的大小增加 1。所以最好`Object[]`用下面的公式来增加大小。
（JSL 使用下面给出的预测公式来动态增长 arraylist，而不是每次增长 1。因为增长需要 JVM 的努力）

```
int newCapacity = (oldCapacity * 3)/2 + 1; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-03-15T10:44:14.300

我认为每个 ArrayList 的初始容量值为“10”。所以无论如何，如果您创建一个 ArrayList 而不在构造函数中设置容量，它将使用默认值创建。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-03-15T10:46:23.040

我会说它是一种优化。没有初始容量的 ArrayList 将有大约 10 个空行，并且会在您进行添加时扩展。

要获得一个包含您需要调用[trimToSize()的项目数量的列表](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/ArrayList.html#trimToSize%28%29)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-13T07:31:39.347

根据我的经验`ArrayList`，提供初始容量是避免重新分配成本的好方法。但它有一个警告。上面提到的所有建议都说，只有在知道元素数量的粗略估计时才应该提供初始容量。但是当我们试图在不知道任何想法的情况下给出初始容量时，保留和未使用的内存量将是一种浪费，因为一旦列表填充到所需数量的元素，它可能永远不需要。我的意思是，我们可以在分配容量时一开始就务实，然后找到一种聪明的方法来了解运行时所需的最小容量。ArrayList 提供了一个名为`ensureCapacity(int minCapacity)`. 但后来，人们找到了一个聪明的方法......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-04T13:56:17.973

我已经测试了有和没有 initialCapacity 的 ArrayList，我得到了令人惊讶的结果
当我将 LOOP_NUMBER 设置为 100,000 或更少时，结果是设置 initialCapacity 是有效的。

```
list1Sttop-list1Start = 14
list2Sttop-list2Start = 10 
```

但是当我将 LOOP_NUMBER 设置为 1,000,000 时，结果变为：

```
list1Stop-list1Start = 40
list2Stop-list2Start = 66 
```

最后，我无法弄清楚它是如何工作的？！
示例代码：

```
 public static final int LOOP_NUMBER = 100000;

public static void main(String[] args) {

    long list1Start = System.currentTimeMillis();
    List<Integer> list1 = new ArrayList();
    for (int i = 0; i < LOOP_NUMBER; i++) {
        list1.add(i);
    }
    long list1Stop = System.currentTimeMillis();
    System.out.println("list1Stop-list1Start = " + String.valueOf(list1Stop - list1Start));

    long list2Start = System.currentTimeMillis();
    List<Integer> list2 = new ArrayList(LOOP_NUMBER);
    for (int i = 0; i < LOOP_NUMBER; i++) {
        list2.add(i);
    }
    long list2Stop = System.currentTimeMillis();
    System.out.println("list2Stop-list2Start = " + String.valueOf(list2Stop - list2Start));
} 
```

我在 windows8.1 和 jdk1.7.0_80 上测试过

# javascript - 替代使用 eval？

> ID：15430253
> 
> 赞同：0
> 
> 时间：2013-03-15T10:41:31.927
> 
> 标签：javascript

我目前正在编写一个 API，它允许用户通过 loadModules() 函数加载模块（以提供一种插件功能）：

完整代码：

```
var LC = (function(){

    var alertModule = {

        alertName: function(name) {
            alert(name);
        },

        alertDate: function() {
            alert(new Date().toUTCString());
        }

    }

    var logModule = {

        logName: function(name) {
            console.log(name);
        },

        logDate: function() {
            console.log(new Date().toUTCString());
        }

    }

    return {

        loadModules: function(moduleList) {

            for(var i=0, l=moduleList.length; i<l; i++) {

                try {
                    this[moduleList[i]] = eval(moduleList[i]);
                } catch(e) {
                    throw("Module does not exist");
                }

            }

        }

    }

})();

LC.loadModules(['alertModules', 'logModule']); 
```

下面的代码会将 alertModule 和 logModule 对象添加到 LC 对象。

```
LC.loadModules(['alertModule', 'logModule']); 
```

在 loadModules 方法中，我循环遍历数组并使用以下代码将对象添加到 LC：

```
this[moduleList[i]] = eval(moduleList[i]); 
```

这工作正常，我相当确定它是安全的（如果模块不存在，则会引发错误），但是有没有更优雅的方式来做到这一点？我能想到的唯一另一种方法是将模块本身放在一个对象中，这样我就可以更容易地引用它们。欢迎任何其他想法/想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:52:45.110

试试这个：http: [//jsfiddle.net/PUgM7/2/](http://jsfiddle.net/PUgM7/2/)

除了引用这些“私有”变量之外，`eval()`您还可以拥有一个模块哈希。

```
var modules = {
  alertModule: { .. },
  logModule: { ... },
} 
```

您可以对此进行扩展并添加额外的功能，例如使用另一种公共方法动态注册模块，例如`addModule`.

```
return {
  addModule: function(name, newModule) {
    modules[name] = newModule;
  },
  loadModules: function() { ... } 
} 
```

# php - 使用 Apache/MySQL/PHP 创建 ODBC 数据源

> ID：15430258
> 
> 赞同：0
> 
> 时间：2013-03-15T10:41:52.270
> 
> 标签：php, mysql, apache, odbc

我有一个使用 mysql/php 的系统构建。目前，用户可以通过下载使用 PHP 和 mysql 查询构建的 csv 来获取统计信息。一位用户询问他们是否可以改为使用 ODBC 获取数据。我可以找到很多关于使用 PHP 连接到 ODBC 数据源但不是用于创建自己的数据源的信息。任何帮助将不胜感激！

谢谢

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T06:27:52.950

我可能有点晚了，但是由于您的系统位于某种 LAMP 堆栈上，您是否考虑过仅使用 MySQL 作为直接 ODBC 数据源？您可以使用视图表做很多事情，并且您可能会对在数据库级别可以完成的事情感到惊讶。

解决此问题的另一种方法是在 PHP 中创建某种导入/导出机制，该机制利用适合特定 ODBC 集成需求的特殊 MySQL 表。例如，您可能让第三方运输应用程序通过 ODBC 将跟踪号和一些标识符写入这些导入表之一。然后在某个时候，一个 PHP 例程可以获取未处理的记录并做任何事情。

遵循简单代码胜于聪明代码的指导方针，然后为这样的场景构建自定义 ODBC 解决方案可能只会让您感到额外的痛苦而几乎没有回报。尽管如此，[这个其他相关的 Stack Overflow 问题](https://stackoverflow.com/questions/335008/creating-a-custom-odbc-driver)可能会提供一些方向。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:48:45.337

您已将问题标记为有点奇怪。

说用户希望数据表现出色？您将为 mysql 安装 odbc-drivers 并在 excel 中使用外部数据源。

注意：如果您运行 32 位 odbc (32bit-office)，x64-systems 将在

```
c:\windir\syswow64\odbcad32.exe 
```

# java - 在jna中返回和访问结构对象的数组

> ID：15430260
> 
> 赞同：2
> 
> 时间：2013-03-15T10:42:02.327
> 
> 标签：java, c, jna

我有一个包含 C 中一些 char 指针的结构：

```
struct inputsheet
{
    char* TestCaseID[MAX_TEST_CASES];
    char*  Description[MAX_TEST_CASES];
}; 
```

我有一个返回结构对象数组的函数：

```
struct inputsheet* getapi(char *docname); 
```

现在我想在 Java 中使用它。如何处理这个结构对象数组？我能够处理单个对象，但不能处理数组。

对于单个对象，我在 C 中的代码在这里：

```
public class str3 extends com.sun.jna.Structure implements com.sun.jna.Structure.ByReference {  
   public Pointer a1;
   public Pointer b2;
   public Pointer c3[]=new Pointer[10];
} 
```

访问它：

```
str2 s2=CLibrary.INSTANCE.parseid(xmlFile1);
for(Pointer p1:s2.testCaseID) {
    if(p1!=null)
    {
        System.out.println(p1.getString(0));
    }
} 
```

**编辑**

```
\\c code
struct str3{
char *a;
char *b;
char *ab[10];
}

\\jna implementation

package parser;
import com.sun.jna.Pointer;
public class str3 extends com.sun.jna.Structure implements     com.sun.jna.Structure.ByReference{ 
public Pointer a1;
public Pointer b2;
public Pointer c3[]=new Pointer[10];
}

\\calling it
import com.sun.jna.Native;
import com.sun.jna.Pointer;
 class ab{
    interface CLibrary extends Library{
    CLibrary INSTANCE = (CLibrary) Native.loadLibrary("chardll",
    CLibrary.class);
    str3 getStruct();
    }

public static void main(String[] args) {
    int size = 5;
    str3 a=CLibrary.INSTANCE.getStruct();
    str3[] ab=(str3[])a.toArray(size);
    System.out.println(ab[0].a1.getString(0));          
    }
} 
```

它将垃圾值作为输出，我必须更新我的代码以获得正确的输出..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:45:03.350

从[javadoc](http://jna.java.net/javadoc/index.html)：

> **返回结构数组**
> 
> 将该方法声明为返回适当类型的结构，然后调用`Structure.toArray(int)`以转换为适当大小的已初始化结构的数组。请注意，您的 `Structure`类必须有一个无参数的构造函数，并且如果适用，您有责任以适合被调用函数的任何方式释放返回的内存。
> 
> ```
> // Original C code
> struct Display* get_displays(int* pcount);
> void free_displays(struct Display* displays);
> 
> // Equivalent JNA mapping
> Display get_displays(IntByReference pcount);
> void free_displays(Display[] displays);
> ...
> IntByReference pcount = new IntByReference();
> Display d = lib.get_displays(pcount);
> Display[] displays = (Display[])d.toArray(pcount.getValue());
> ...
> lib.free_displays(displays); 
> ```

**编辑**

名义上，您的结构将如下所示（基于您的本机定义）：

```
class inputsheet extends Structure {
    public Pointer[] TestCaseID = new Pointer[MAX_TEST_CASES];
    public Pointer[] Description = new Pointer[MAX_TEST_CASES];
}

public inputsheet getapi(String docname);

int size = ...; // whatever you do to figure out the size of your returned array 
inputsheet sheet = INSTANCE.getapi("some-doc");
inputsheet[] sheets = (inputsheet[])sheet.toArray(size); 
```

如果调用者不需要写入`inputsheet`字段，则应使用`String`而不是`Pointer`.

# arrays - Bash 从前一个元素填充空数组元素

> ID：15430270
> 
> 赞同：0
> 
> 时间：2013-03-15T10:42:36.320
> 
> 标签：arrays, bash, join, null

是否有一种简单（即非循环）的方法可以在 bash 中获取一个数组并用之前的元素值填充任何空元素。

用例是获取一组异步时间序列数据点，并将它们与时间外连接作为公共列。然后对于每个数据列，找到任何空值并用该系列中前一个数据点的值填充该点。

于是两个系列

```
T1,1.234  
T2,2.345  
T3,3.456  
T6,6.789  

T1,1.111  
T2,2.222  
T5,5.555  
T7,7.777 
```

将加入生产

```
T1,1.234,1.111  
T2,2.345,2.222  
T3,3.456,2.222  
T5,3.456,5.555  
T6,6.789,5.555  
T7,6.789,7.777 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T08:10:07.607

如果您将`for`上面评论中的循环体更改为

```
{ if (!x[i]) x[i] = x[i-1]; print x[i] } 
```

，它也适用于连续的空值。

如果 AWK 脚本对于您的用例来说太慢了，并且既然您提到了 R，为什么不使用 R？

# android - 使 Android 的“使用权限”成为可选

> ID：15430272
> 
> 赞同：5
> 
> 时间：2013-03-15T10:42:46.010
> 
> 标签：android, gps, user-permissions

我有这些：

```
 <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />  
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
  <uses-feature android:name="android.hardware.location.gps" android:required="false" /> 
```

我可以自己检查 GPS：

```
locationManager = (LocationManager) 
    context.getSystemService(Context.LOCATION_SERVICE);

fSupportsGPS = (locationManager.getAllProviders().
    contains(LocationManager.GPS_PROVIDER)); 
```

但我还是有些疑惑。我希望我的应用程序在没有 wifi/gps/网络可用的设备上运行。我使用 GPS 的唯一原因是在 Google 地图上显示用户位置。（与应用程序的其他部分相比，这是一个微小的功能，所以我不想对它有任何要求。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T11:17:11.313

这[`<uses-feature ...>`](http://developer.android.com/guide/topics/manifest/uses-feature-element.html#testing)告诉 Android 应用程序*必须*需要该功能并且没有它就无法运行，因此 Android 不允许用户安装该应用程序（事实上，它甚至不会出现在 Play 商店/市场中。

要让没有这些功能的用户安装您的应用，您只需添加`android:required="false"`相应功能的选项即可。您已经使用此 XML 在清单中完成了：

```
<uses-feature android:name="android.hardware.camera" android:required="false"/> 
```

* * *

要检测用户是否具有该功能（因为现在不是强制性的），您可以使用 Android API。您已经使用此 Java 代码完成了这项工作：

```
locationManager = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE);   
  fSupportsGPS = (locationManager.getAllProviders().contains(LocationManager.GPS_PROVIDER)); 
```

* * *

现在，您不能做的一件事是让使用 Android 1.6 及更早版本的用户安装应用程序，即使这些功能被标记为可选。这是因为 Android 版本无法识别[此答案](https://stackoverflow.com/a/6475431/1292652)`android:required`中解释的功能。

* * *

要记住的另一件事是，某些`<uses-permission ...>`标签会触发一些隐含的权限要求。

为了解决这个问题，引用[文档](http://developer.android.com/guide/topics/manifest/uses-feature-element.html#testing)：

> 如果您不希望 Google Play 基于特定的隐含功能进行过滤，您可以禁用该行为。为此，请在元素中显式声明该功能并包含 android:required="false" 属性。例如，要禁用从 CAMERA 权限派生的过滤，您将声明该功能，如下所示。

```
<uses-feature android:name="android.hardware.camera" android:required="false" /> 
```

根据[this page](http://developer.android.com/guide/topics/manifest/uses-feature-element.html)，这`<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />`意味着网络的要求。要禁用它，请将其添加到您的清单中：

```
<uses-feature android:name="android.hardware.location.network" android:required="false" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T10:49:25.100

那`android:required="false"/>`应该可以解决问题。我有一个 Nexus7，它只有一个前置摄像头，Android 不认为它是摄像头。并且由于对相机的要求，它没有出现在 Play 商店中我的应用程序支持的设备列表中。

添加 required=false 如

```
<uses-feature android:name="android.hardware.camera" android:required="false"/> 
```

让它出现。

# c# - WPFToolkit：类型引用找不到公共类型

> ID：15430284
> 
> 赞同：2
> 
> 时间：2013-03-15T10:43:12.693
> 
> 标签：c#, c#-4.0, wpftoolkit

自从转移到一台新 PC 上，我一直无法在其上运行项目，特别是问题出在 WPFToolkit 中的一些控件上。

在我之前的设置中，我下载了 WPFToolkit 并解除了对 DLL 的阻止，并且它们可以正常工作（在出现[一些问题](https://stackoverflow.com/questions/10188373/extended-wpf-toolkit-using-the-richtextboxformatbar)之后）。但是，这一次我通过 NuGet 下载了它们，并且它们存储在 packages/Extended.Wpf.Toolkit.1.9.0/lib 目录中的位置*并没有被阻止。*

但是，我现在收到如下错误：

```
The name "AutoCompleteBox" does not exist in the namespace "http://schemas.xceed.com/wpf/xaml/toolkit". 
```

或者

```
The type reference cannot find a public type named 'AutoCompleteBox'. 
```

我在 XAML 中引用文件：

```
xmlns:controls="http://schemas.xceed.com/wpf/xaml/toolkit" 
```

从我对这个问题所做的所有研究来看，这似乎是正确的方法，并且当我在我以前的机器上时它有效。

有什么明显的我做错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T13:06:19.413

`AutoCompleteBox`是“原始” [WPF Toolkit](http://wpf.codeplex.com/)的一个组件，它也可以在[NuGet](http://nuget.org/packages/wpftoolkit)上以简单的名称*WPF Toolkit*获得。

[Extended WPF Toolkit Community Edition](http://wpftoolkit.codeplex.com/)是由 Xceed 开发的完全不同的控件库。原始*WPF 工具包*中的控件**不**包含在*扩展的 WPF 工具包*中。

在您的项目中，只需删除对*Extended WPF Toolkit*的 NuGet 引用，而是添加对*WPF Toolkit*的引用。

要访问`AutoCompleteBox`XAML 文件中的 ，请添加以下命名空间引用：

```
 xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Input.Toolkit" 
```

# c - 在 C 中使用字符串数组来解析文本文件

> ID：15430285
> 
> 赞同：0
> 
> 时间：2013-03-15T10:43:13.983
> 
> 标签：c, string, matrix

我想从 N 个文本文件中读取（具有相似的结构：几行，每行具有相同的少量单词）并将读取的单词存储在字符串矩阵中，这样每个 (row, col)立场我一句话。

文件的一个简单（两行，每行三个字）样本如下：

```
line1word1 line1word2 line1word3
line2word1 line2word2 line2word3 
```

单词的分隔符是空格。

我尝试过这段代码：

```
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_STRING_LENGTH 1000
#define MAX_TOKS 100
#define DELIMITERS " "

// line parsing utility
int parseString(char* line, char*** argv) {

  char* buffer;
  int argc;

  buffer = (char*) malloc(strlen(line) * sizeof(char));
  strcpy(buffer,line);
  (*argv) = (char**) malloc(MAX_TOKS * sizeof(char**));

  argc = 0;  
  (*argv)[argc++] = strtok(buffer, DELIMITERS);
  while ((((*argv)[argc] = strtok(NULL, DELIMITERS)) != NULL) &&
     (argc < MAX_TOKS)) ++argc;
  return argc; 
}

int main() {

  char S[MAX_STRING_LENGTH];
  char **A;

  int  n,i,j,l;

  FILE *f;
  char file[50];

  char ***matrix;
  matrix = malloc(MAX_TOKS * sizeof(char**));

 //memory allocation for matrix
 for (i = 0; i < MAX_TOKS; i++)
     {
       matrix[i] = malloc(MAX_TOKS * sizeof(char *));
       for (j = 0; j < MAX_TOKS; j++)
           {
           matrix[i][j] = malloc(MAX_TOKS * sizeof(char));
           }
     }

  int NFILE = 10; // number of files to be read

  for(i=0;i<NFILE;i++) 
    {  
    sprintf(file,"file%d.txt",i); 
    f = fopen(file,"r");

    l=0; // line-in-file index
    while(fgets(S,sizeof(S),f)!=NULL) {
          n = parseString(S,&A);
          for(j=0;j<n;j++) {
            matrix[i][l]=A[j];
            printf("%s\t%s\n",matrix[i][l],A[j]); 
            } 
        l++;
        } 
 fclose(f); 
    }

free(matrix);
free(A);    
return(0);  
} 
```

我无法解决的问题是，在检查数组之间的对应关系时（为了确保我正确存储单个单词）使用

```
printf("%s\t%s\n",matrix[i][l],A[j]); 
```

我发现每行的最后一个单词（并且只有最后一个单词），无论文件编号如何，都没有存储在`matrix`. 也就是说，`line1word1`and `line1words`of`file0`正确存储在`matrix[0][0][0]`and`matrix[0][0][1]`中，但是字段`matrix[0][0][2]`中没有`line1word3`，即使`A[2]`有！

我在做什么错？有什么建议吗？

非常感谢提前，干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:26:28.633

这看起来不对：`buffer = (char*) malloc(strlen(line) * sizeof(char));`

首先，不需要在 C 中强制转换 malloc。如果您的代码在没有强制转换的情况下无法编译，可能有两个原因：

1.  malloc 没有原型。显然这会导致问题，因为没有原型意味着函数返回默认类型：`int`，否则会发生错误。这可能会导致您的程序行为不端。为了避免这种情况，`#include <stdlib.h>`.
2.  您正在使用 C++ 编译器。停止。使用 C++ 编程（停止使用 malloc）或使用 C 编译器。如果要在 C++ 项目中使用此项目，请使用 C 编译器编译 C 代码并在 C++ 编译器中链接到它。

其次，sizeof(char) 始终为 1。无需乘以它。

第三，字符串是以第一个 '\0' 结尾的字符序列。这意味着一个字符串总是至少占用 1 个字符，即使它是一个空字符串。返回什么`strlen("")`？是什么`sizeof("")`？您需要添加 1 为 '\0': 腾出空间`buffer = malloc(strlen(line) + 1);`。

这看起来有点错误：`(*argv) = (char**) malloc(MAX_TOKS * sizeof(char**));`

malloc 返回一个指向对象的指针。`*argv`是 a `char **`，这意味着它指向 a `char *`。但是，在这种情况下 malloc 返回一个指向`char **`对象的指针。表示不需要相同。为避免与此相关的可移植性问题，请遵循此模式`variable = malloc(n * sizeof *variable);`......在这种情况下，`*argv = malloc(MAX_TOKS * **argv);`

随着它的进行，它变得更加坚韧。忘记你认为你知道的关于你的代码的一切；假装你将在 24 个月后回到这个状态。你会怎么想？

```
argc = 0;  
(*argv)[argc++] = strtok(buffer, DELIMITERS);
while ((((*argv)[argc] = strtok(NULL, DELIMITERS)) != NULL) &&
   (argc < MAX_TOKS)) ++argc; 
```

实际上这里也有一个不一样的。假设`argc == MAX_TOKS`，您的循环将尝试分配给`(*argv)[MAX_TOKS]`. 这个循环是我认为您的问题所在，解决方案是更清楚地表达您的意图，而不是试图将尽可能多的代码塞进一行。你会如何重写这个？在这种情况下，我会这样做：

```
char *arg;
size_t argc = 0;
do {
    arg = strtok(buffer, DELIMITERS);
    buffer = NULL;

    (*argv)[argc] = arg;
    argc++;
} while (argc < MAX_TOKS && arg != NULL); 
```

问题是当 strtok 返回 NULL 时，您的解析循环不会增加。因此，您的函数返回最后一项的位置。假设您有两个标记，您的解析函数将返回 1。您的显示循环显示最多但不包括此位置的项目：`for(j=0;j<n;j++)`。您可以使用建议的改进，或更改您的循环：`for (j = 0; j <= n; j++)`. 无论哪种方式，您都需要逐个修复这些问题。

出于好奇，你在看哪本书？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:56:10.397

`char ***matrix`没有声明一个三维数组。您的矩阵需要类似于`char *matrix[a][b]`保存字符串指针的二维数组。为了计算数组中的地址，编译器需要知道除一个之外的所有维度。如果你仔细想想，你可能会明白为什么......

如果你有两个数组：

```
1 2 3        1  2  3  4  5  6  7
4 5 6        8  9 10 11 12 13 14
7 8 9       15 16 17 18 19 20 21 
```

**你可以**看到这`item[1][1]`不是同一个项目。无论数组中的维度如何，元素通常在内存中按顺序排列，每一行都在前一个（或可能的列，我想取决于语言）之后。如果你有一个指针数组，实际内容可能在其他地方，但点会这样排列。因此，在我上面的示例中，您必须向编译器提供列数，以便它可以找到成员（*行*数可以是可变的。）在三维数组中，您必须提供前*两个*维度，以便编译器可以计算项目偏移量。

 ****我希望这会有所帮助。

编辑：您*可以*通过创建自己的函数来处理所有数组项访问，从而获得真正的动态数组维度。该函数需要知道动态维度和项目索引，以便它可以计算适当的地址。****

# c - 无法调试我的快速排序程序

> ID：15430288
> 
> 赞同：2
> 
> 时间：2013-03-15T10:43:18.213
> 
> 标签：c, sorting

```
#include <stdio.h>

int Partition (int * A, int p, int r)
{
    printf("PARTITION\n");
    int x=0;
    x=A[r];
    int i=p-1, j=r+1;
    int temp;
    int k=0;
    while(1)
    {
        printf("\tLOOP\n");
        do
        {
            j=j-1;
        } while(A[j]>x) ;

        do
        {
            i=i+1;
        } while(A[i]<x);

        if (i<j)
        {
            temp=A[i];
            A[i]=A[j];
            A[j]=temp;
        }
        else
        {
            printf ("ARRAY: ");
            for (k=p; k<=r; k++)
                printf ("%d,",A[k]);
            printf ("\nRETURNING : %d \n", j);

            return j;
        }

    }
}
void QuickSort(int * A, int p, int r)
{
    int q;
    if (p<r)
    {
        q = Partition (A,p,r);
        QuickSort(A,p,q);
        QuickSort(A,q+1,r);
    }

}

int main()
{
    int A[9] = {9,2,4,1,7,8,3,5,6};
    int i;
    QuickSort(A,0,8);
    for (i=0;i<=8;i++)
    {
        printf("%d ", A[i]);
    }
    return 0;
} 
```

在 GDB 上一个小时后，我把这个程序的问题缩小到了：

我的数组有从 0-9 的索引。它首先被划分为 0-5 和 6-9。然后 0-5 部分被划分为 0-2 和 3-5 然后 0-2 部分被划分为 0-0 和 1-2 现在 0-0 部分由于`if (p<r)`条件而被跳过，但程序调用 Partition (A,1,2) 为另一部分。现在这是程序卡住的地方，它一次又一次地调用 Partition (A,1,2)，因为它一直返回 '2' 作为枢轴索引。

为什么会这样？我无法理解程序逻辑上哪里出错了，我遵循了互联网上各个地方给出的确切伪代码。

编辑：我能够通过使用`if (i<=j)`而不是`if (i<j)`in来解决问题`Partition`。它迫使`j`再次递减，但这只是因为我很幸运选择`do while`了而不是`while`. 我仍然不明白为什么直接实现 Quicksort 伪代码不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:15:13.027

您在代码中犯了很多错误。

*   `QuickSort(A,p,q);`是`QuickSort(A,p,q-1)`；

*   `int i=p-1, j=r+1;`没有必要。

*   您的`partition()`, 将需要一个额外的变量来保存枢轴。

*   `while(A[i]<x) ;`应该是`while(A[i] <= x[piv] && i<r )`；

*   在您的程序中，您错过了一个算法步骤，其中枢轴处的数组变量与您的最后一个数组变量交换，没有这个关键步骤，就不会发生排序。

这是您的程序，并进行了更正

```
#include <stdio.h>

int Partition (int  *A, int p, int r)
{
    printf("PARTITION\n");
    int i=p, j=r ,piv=p ;
    int temp;

    while(i<j)
    {
        printf("\tLOOP\n");

       while(A[i] <= A[piv] && i<r)
           i++;

       while(A[j]>A[piv]) 
           j--;

            if (i<j)
            {
                temp=A[i];
                A[i]=A[j];
                A[j]=temp;
            }
    }

/*Crucial step that you happen to miss*/
         temp=A[piv];
         A[piv]=A[j];
         A[j]=temp;

return j;
}

void QuickSort(int *A, int p, int r)
{
    int q;
    if (p<r)
    {
        q = Partition (A,p,r);
        QuickSort(A,p,q-1);
        QuickSort(A,q+1,r);
    }
}

int main()
{
    int A[9] = {9,2,4,1,7,8,3,5,6};
    int i;
    QuickSort(A,0,8);
    for (i=0;i<=8;i++)
    {
        printf("%d ", A[i]);
    }
    return 0;
} 
```

# c# - 创建一个简单的列表框

> ID：15430295
> 
> 赞同：0
> 
> 时间：2013-03-15T10:43:42.133
> 
> 标签：c#, listbox, windows-phone

我是 Windows Phone 开发的新手，我想创建一个简单的 ListBox。

我有一个包含 10 个名称的数组，我想在列表框中显示。

```
string[] names = new string[10] {"Matt", "Joanne", "Robert", .........}; 
```

现在我想使用这个 Array 动态地提供 listBox 并显示它。 ![在此处输入图像描述](../Images/0d14799e2fbb7dd1339386ca5db6eda1.png)

有人可以帮我举个例子来说明如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:16:48.350

我不熟悉 Windows Phone 开发，但在 winforms 中它会是`listbox.Items.AddRange(names);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T15:19:21.727

您必须将数组设置为 ListBox 的 ItemSource：

```
listBox.ItemSource = names; 
```

# android - 无论如何，是否可以在没有 root 权限的情况下将关键事件注入其他应用程序？

> ID：15430300
> 
> 赞同：1
> 
> 时间：2013-03-15T10:43:58.990
> 
> 标签：android

我试图找到一种将 keyEvent 注入其他应用程序的方法。但是，解决方案通常涉及 root 权限或获取系统签名。

无论如何在没有root设备的情况下将输入事件注入其他应用程序？我认为，平台密钥通常由创建 ROM 的设备提供商持有。所以这也不是一个有效的方法。

我知道它可以关闭，例如“Button savior non root”。

有没有人有这方面的经验？

# erlang - 为什么 spawn/3 (MFA) 在 Erlang 中不起作用？

> ID：15430303
> 
> 赞同：0
> 
> 时间：2013-03-15T10:44:06.377
> 
> 标签：erlang, spawn

这是 Erlang 中的一个简单服务器。我正在尝试使用 spawn/3 生成，但我必须使用 spawn/1 才能使其正常工作。

```
-module(server_by_name).
-export([start/0]).

start() ->
    {ok, Listen} = gen_tcp:listen(1234, [binary, {packet, 0}, {reuseaddr, true}, {active, true}]),
    io:format("Server running."),
    % --> Why doesn't this work in place of the line below? --> spawn(server_by_name, connect, [Listen]).
    spawn(fun() -> connect(Listen) end).

connect(Listen) ->
    {ok, Socket} = gen_tcp:accept(Listen),
    spawn(fun() -> connect(Listen) end),
    io:format("Connection accepted on ~p Pid ~p~n", [Socket, self()]),
    receive
        {tcp, Socket, Bin} ->
            Request = parse_request(Bin),
            io:format("File requested: ~p~n", [Request]),
            LoadHtml = file:read_file(Request),
            case LoadHtml of
                {ok, Reply} ->
                    Header = "HTTP/1.1 200 OK \r\n Content-Type:HTML\r\n\r\n",
                    ConnectCheck = gen_tcp:send(Socket, Header ++ Reply),
                    io:format("Connection?? ~p~n", [ConnectCheck]);
                {error, Reason} ->
                    io:format("Error in loading html file: ~n~p~n", [Reason]);
            end;
        {tcp_closed, Socket} ->
            io:format("Server socket closed~n")
    after 5000 ->
        io:format("Client unresponsive~n")
    end.

parse_request(Bin) when is_binary(Bin)->
    parse_request(binary_to_list(Bin));

parse_request("GET /" ++ RestStr) ->
    get_request([], RestStr);

parse_request([_H|T]) ->
    parse_request(T).

get_request(Request, [32|_RestStr]) ->
    lists:reverse(Request);

get_request(Request, [H|RestStr]) ->
    get_request([H|Request], RestStr);

get_request(Request, []) ->
    io:format("Unexpected result in server_by_name:get_request()"),
    list:reverse(Request). 
```

我已经包含了所有代码，因此您可以复制/粘贴它并在需要时自己尝试。您只需要有一个可以在同一目录中提供的文件并按名称请求它。显然，它没有安全预防措施等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:46:34.420

`spawn/3`需要导出函数。您的解决方案是完全合理的，但您也可以导出`connect/1`：

```
-export([connect/1]).  %% do not use, exported for spawn 
```

# android - 为 Micro Max Funbook(480*800) 7 选项卡创建自定义 AVD(Emulator)

> ID：15430308
> 
> 赞同：0
> 
> 时间：2013-03-15T10:44:20.197
> 
> 标签：android, avd

我如何使用自定义 AVD，例如我想检查 Micro Max funbook (480*800) 7 英寸中的应用程序。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:48:27.003

您可以使用 AVD 管理器执行此操作。

您只需要选择**Devices Definitions**选项卡，然后选择**New Devices...**按钮。在那里你输入规格： ![步骤1](../Images/4c2df5aebeec837a08d70fabefd8883b.png)

第二步是创建一个您已经知道的新 VM。 ![第2步](../Images/9d2aec49dbc50e60e64975d6c72f3374.png)

# freepascal - 使用 lazarus 将 UTF8 转换为 ASCII

> ID：15430315
> 
> 赞同：1
> 
> 时间：2013-03-15T10:44:35.517
> 
> 标签：freepascal, lazarus, utf8-decode

我正在从文本文件中读取一些字符串，问题是这些字符串是 UTF8 并且包含我希望删除的字符，例如：Ă

对我来说，一个不容易的解决方案是替换每次出现的非法字符，但是因为我很懒，所以我想要一个更简单的解决方案

到目前为止，我试过这个：

```
 line := Utf8ToAnsi(line); 
```

其中 line 是我的 UTF8 编码字符串...我尝试将 line 声明为 UTF8String ...

在这个问题上是否有可行的解决方案？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-03T02:30:56.033

> 对我来说，一个不容易的解决方案是替换每次出现的非法字符，但是因为我很懒，所以我想要一个更简单的解决方案

我做了一个函数，将每个变音符号替换为类似的字符，例如：Á > A、Ç > C、ã > a 等。你可以使用这个解决方案。请查看此链接：[https](https://github.com/silvioprog/rutils/blob/master/src/rutils.pas#L1589) ://github.com/silvioprog/rutils/blob/master/src/rutils.pas#L1589 。

高温高压

# php - php $_COOKIE 只获取会话 cookie？

> ID：15430319
> 
> 赞同：0
> 
> 时间：2013-03-15T10:44:54.453
> 
> 标签：php, session, cookies

`print_r($_COOKIE)`返回一个仅包含会话 cookie 及其值的数组，即

```
Array ( [PHPSESSID] => 0cfbom6llfl3ho93n7bljnns14 ) 
```

但是，我确实设置了其他 cookie。我检查了浏览器，它们确实存在。我做了这样的设置：

```
setcookie("cookie_name",$myvar,
time() + (20 * 365 * 24 * 60 * 60),
"/", "mydomain.com",
true, true
); 
```

浏览器显示 cookie name as`cookie_name`和 value 作为 value ，`$myvar`所以显然 cookie 的设置没有问题。

在浏览器上并排查看两个 cookie 唯一的区别是会话 cookie 的域是`mydomain.com`while`cookie_name`的域是`.mydomain.com`. 那是问题吗？如果是这样，我该如何解决？

编辑：点不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:55:10.090

只需检查此页面，访问[http://www.php.net/manual/en/reserved.variables.cookies.php](http://www.php.net/manual/en/reserved.variables.cookies.php)

第一个注释指出为什么它不起作用，只有当浏览器发回请求时（例如正常的页面访问）

您可以使用 Chrome 检查器检查浏览器请求的 http 头。

我为我糟糕的英语感到抱歉

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:11:21.643

问题是我设置`seucre`为`true`并且我的网络主机没有提供 HTTPS，因此即使在服务器端也无法访问 cookie。傻我。

# html - 如何在父 div 旁边有一个固定的 div？

> ID：15430320
> 
> 赞同：0
> 
> 时间：2013-03-15T10:44:56.877
> 
> 标签：html, css

我正在尝试使用父 div 旁边的按钮获取 div。像这样：

```
____________
|relative  |
|          |
|          |
|          |_______
|          | fixed |
|          |_______|
|          |
|          |
|__________| 
```

固定 div 必须在滚动期间固定，但始终在父级旁边，而不是在其父级下方或上方。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:21:13.343

你的主要问题是元素`position: fixed`总是相对于身体。它的行为与带有 的元素不同`position: absolute`，后者相对于带有`position: relative`声明的父元素。

所以主要问题是，如果你设置`left`为固定元素，它会粘在 body 元素的左边缘，即使它的父元素是相对定位的。**但是**你可以使用一个技巧，跳过`left`固定元素的声明。

```
.main {
    /*just for visualisation*/
    width: 300px;
    height: 1500px;
    background: #ccc;
}
.main, .fake-wrapper {
    float: left;
}
.fixed {
    position: fixed;
    top: 50%;
}
```

```
<div class="main">
<!-- your content -->
</div>
<div class="fake-wrapper">
    <div class="fixed">
        <a href="/">click!</a>
    </div>
</div>
```

这是一个[JSFiddle 示例](http://jsfiddle.net/GFAyJ/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T10:48:04.457

用于`position:fixed`第二个 div

HTML

```
<div class="main">
    zx
</div>
<div class="fix">
    <button>Click</button>
</div> 
```

CSS

```
html, body{
    height:100%;
    margin:0
}
.main{
    height:100%;
    width:50%;
    background:grey;
}
.fix{
     position:fixed;
     top:50%;
     border:red solid 2px;
     background:yellow;
     left:50%
} 
```

**[演示](http://jsfiddle.net/jAg7M/1/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:46:44.380

你正在寻找`position: absolute`，而不是固定的——如果你的父母有类`parent`并且按钮有类`button`，你需要的类似于（假设按钮的固定宽度为 100px）：

```
.parent { position: relative; }
.button { position: absolute; top: 45%; right: -100px; } 
```

这是一个示例小提琴（添加了一些宽度/高度来演示，这些应该来自您的内容）[http://jsfiddle.net/WpnP4/](http://jsfiddle.net/WpnP4/)

**编辑：**刚刚意识到问题不是 100% 清楚——我假设你希望按钮位于特定元素旁边并随屏幕滚动。如果`position:fixed`您希望按钮元素在屏幕中保持固定，请使用此选项。

# php - 在从 gdrive 返回文件的函数上实现计数器

> ID：15430321
> 
> 赞同：0
> 
> 时间：2013-03-15T10:44:57.797
> 
> 标签：php, javascript, jquery, html

我想实现一个跟踪文件下载次数的计数器。该函数从谷歌驱动器中检索文件，并使用 for 循环将其打印到屏幕上。请帮助提供一个在哪里实现计数器以跟踪计数的逻辑。

功能如下：

```
function makeRequest() {
      var request = gapi.client.drive.files.list();
    request.execute(function(resp) {          
        for (i=0; i<resp.items.length; i++) {
            var titulo = resp.items[i].title;
            var fechaUpd = resp.items[i].modifiedDate;
            var userUpd = resp.items[i].lastModifyingUserName;
            var userEmbed = resp.items[i].embedLink;
            var userAltLink = resp.items[i].alternateLink;
            var download = resp.items[i].webContentLink;
            var hold="Download";
            var flag=0;

           <!-- var fileInfo = document.createElement('li');
          <!--  fileInfo.appendChild(document.createTextNode('TITLE: ' + titulo + ' - LAST MODIF: ' + fechaUpd + ' - BY: ' + userUpd +'  url:  ' + hold.link(download)));                
           <!-- document.getElementById('content').appendChild(fileInfo);

            document.write(titulo + "&nbsp;");
            document.write(hold.link(download) + "<br>");
            <!--flag=1;
            }

            <!--if(flag!=1){
            <!--document.write("not found!");
            <!--}
    });  ;    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:58:20.057

我不确定我是否理解您想要跟踪的内容。如果您希望单个用户能够查看该用户下载文件的次数，则可以在 javascript 中实现并将信息存储在 cookie 中。

另一方面，如果您想查看某个文件已被任何用户下载了多少次，则必须使用 PHP 或任何可用的语言在服务器端实现它。

这里的关键问题是您是否可以/想要在服务器端或客户端实现这些功能。要在客户端执行此操作，您使用 javascript，要在服务器端执行此操作，您可以使用 PHP。

# php - 显示两次 html

> ID：15430322
> 
> 赞同：0
> 
> 时间：2013-03-15T10:45:07.373
> 
> 标签：php, html, handler, stack-trace

所以我正在为我的网站进行错误处理。我希望能够通过使用激活错误处理程序

> include_once("errorhandler.php");

到目前为止它工作得很好，如果发生错误，它会显示错误，但是我面临另一个问题。我制作了一个名为“test.php”的 php 文件，如下所示：

```
<?php
include("errorhandler.php");
?>

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
    </head>
    <body>
        <h1>My awesome page :D</h1>
        <?php
            mysql_connect("test","test");
            opendir("test");
        ?>
    </body>
</html> 
```

现在的问题是，错误被显示，但标题也被显示，因为它在脚本崩溃并启动错误处理程序之前执行该部分。

它使页面看起来像这样： ![错误图片](../Images/6dfcc1824e5408423ae0bcc0ea864b63.png)

基本上，我需要错误处理程序在写入 Html 之前清除所有内容。

我试过使用`<script> document.write('');</script>`

在我的错误处理方法的开始，没有运气。

所以现在我被困住了，关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:48:23.850

把死（）；在包含之后，将停止页面的其余部分运行，或者将 if 包装在您的异常周围，以便`if (exception) { //do include } else { //show normal code }`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:50:58.487

您可以尝试将您的 html 放入函数中：

```
public function render() {
    $this->ht_content = '<html> Your html </html>';
    return $this->ht_content;
} 
```

然后在您的错误处理程序中，您可以这样说：

```
if($errors) {
    // Error stuff here
} else {
    $ht = new html();
    $ht->render();
} 
```

你可以把它做得像你想要的那样大和漂亮:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:52:32.130

在错误处理程序的开始使用`ob_clean();` ，所以当它发生时它会清理页面！

# javascript - FabricJS - 文本不起作用

> ID：15430324
> 
> 赞同：0
> 
> 时间：2013-03-15T10:45:10.640
> 
> 标签：javascript, html, fabricjs

我已经开始使用 FabricJS，不幸的是我无法显示文本。这是我的代码：

```
var canvas = new fabric.Canvas('mainCanvas');
var str = new fabric.Text('Hello World', {
            fontSize: 30,
            fontFamily: 'Arial',
            top: 50,
            left: 50,
            fill: 'black',
        });

canvas.add(str); 
```

其他形状确实出现了，但文字没有显示......我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:09:57.047

我想通了，它没有用，因为我使用的是 0.8.32 版本而不是 0.9.15。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-24T03:39:28.920

如果你真的想要，最好使用 Itext 或 Textbox，只需替换`.text`为`.Itext`

# c# - 字符串未被识别为有效的 DateTime 错误

> ID：15430331
> 
> 赞同：0
> 
> 时间：2013-03-15T10:45:14.960
> 
> 标签：c#, asp.net

```
DataTable dt1 = new DataTable();
            dt1.Columns.Add("studid",typeof(int));
            dt1.Columns.Add("rollno", typeof(int));
            dt1.Columns.Add("date", typeof(DateTime));
            dt1.Columns.Add("starttime", typeof(string));
            dt1.Columns.Add("class", typeof(string));
            dt1.Columns.Add("section", typeof(string));
            dt1.Columns.Add("subject", typeof(string));

            for (int i = 0; i < dt.Rows.Count; i++)
            {               
                dt1.Rows.Add(Convert.ToInt32(dt.Rows[i]["id"]), Convert.ToInt32(dt.Rows[i]["rollno"]), Convert.ToDateTime(txtdate.Text),time.SelectedItem.ToString(), drpclass.SelectedItem.ToString(), drpsection.ToString(), drpsubject.SelectedItem.ToString());
            } 
```

即使 DataTable 列的数据类型是字符串，`"String was not recognized as a valid DateTime"`我也会收到错误消息。`time.SelectedItem.ToString()`我应用了断点，`09:30:00`这是我得到的值`time.SelectedItem.ToString()`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:16:00.443

您的输入“09:30:00”仅提及时间，而相应列的数据类型是 DateTime，其中输入包括日、月和年。

（假设它是一个下拉列表）因此，为了获取字符串中的时间，请执行以下操作：

```
string mytime=  DateTime.Parse(DropDownlist.SelectedItem.Text.ToString()).ToShortTimeString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:49:49.653

该错误消息似乎表明将`string`值转换为`Datetime`.

这种转换发生的唯一地方是

```
Convert.ToDateTime(txtdate.Text) 
```

线。您能否仔细检查 的值`txtdate`并确保它是有效日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:48:43.153

你在这个领域有什么价值`txtdate.Text`可能会导致问题。

你正在这样做

```
 Convert.ToDateTime(txtdate.Text) 
```

因此，如果 TextBox 包含除日期格式以外的其他值。那么它会抛出一个错误。

# java - 如何使用eclipse打包jar文件而不包含依赖jar库？

> ID：15430333
> 
> 赞同：2
> 
> 时间：2013-03-15T10:45:23.270
> 
> 标签：java, eclipse, jar, package

我想使用 Eclipse IDE 打包 jar 文件而不包含依赖 jar 库。我使用这些步骤进行打包，但结果 jar 文件始终包含 jar 库。我做了一些步骤

![步骤1](../Images/ec2615d58590fe83d5c3c74e70322f2e.png) ![第2步](../Images/7fc91104f89a9bd6e88e337646f11e90.png) ![第 3 步](../Images/b5463426fda5623f48caf54fda539d31.png) ![第4步](../Images/6a3243fae0aaf5bcfdbf075d3fd8026d.png)

我要打包的 jar 文件是 jar 库不可运行的 jar 文件

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:23:02.340

在 Eclipse 中，当您创建 jar 文件时，选择名为“JAR 文件”而不是“可运行 JAR”的选项。单击下一步时，您将获得在创建 jar 文件时需要包含的项目列表，每个项目前面都有一个复选框。只是不要选择您不想导出的项目（在您的情况下依赖库）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T12:49:45.600

我会使用蚂蚁任务...

```
<zip destfile="${backupJar}" update="true" basedir="${basedir}/../../"
        includes="**/*.xml*, **/*.java"
        compress="true"/> 
```

请记住，jar 实际上是具有不同扩展名的 zip 文件。

看

[http://ant.apache.org/manual/Tasks/zip.html](http://ant.apache.org/manual/Tasks/zip.html)

编辑：您特别询问如何忽略依赖项。这是通过使用 zip 任务的 excludes 属性来实现的，例如：

```
 <zip destfile="${backupJar}" update="true" basedir="${remotedir}/../"
        excludes="**/lib/testonly.zip, 
              **/lib/ms*.jar, 
          **/*.tmp" 
        includes="exported/**/*.*, exported/jf123/**/*.*" compress="true"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T10:46:56.987

在导出下，单击 Jar 文件而不是 Runnable Jar 文件

# android - 被软件按钮隐藏的安卓选项菜单

> ID：15430336
> 
> 赞同：1
> 
> 时间：2013-03-15T10:45:35.633
> 
> 标签：android, menu, xamarin.android

我对配备软件按钮的平板电脑上的选项菜单有疑问。在我的智能手机（带有物理按钮）上，一切看起来都是正确的：[智能手机屏幕截图](http://postimage.org/image/nlmis4qg3/)

但在平板电脑上的选项菜单被软件按钮栏部分隐藏： [平板电脑截图](http://postimage.org/image/uh6rb8kwz/)

我查看了其他应用程序，它们只是在软件按钮上方显示菜单......我不知道我做错了什么？谷歌搜索没有给我任何有用的提示，也许这里有人会知道如何避免这种行为？应用程序是用 Monodroid 编写的，但我真的不认为它有任何重要性。在 Android 模拟器上也存在这个问题。

# entity-framework - 如何将 PgSqlType 与 devart 实体开发人员一起使用

> ID：15430342
> 
> 赞同：0
> 
> 时间：2013-03-15T10:45:56.157
> 
> 标签：entity-framework, postgresql, orm, point, devart

我想将 postgres 类型映射`point`到`Devart.Data.PostgreSql.PqSqlPoint`结构。我找到了一个表（[devart PgSqlTypes](http://www.devart.com/dotconnect/postgresql/docs/Devart.Data.PostgreSql~Devart.Data.PostgreSql.PgSqlType.html)），其中说明`point`：“可能表示为 PgSqlPoint 类或 Srting”。

但是在 devart 的实体开发人员中，我只能为生成的实体的各自属性选择 Dot.Net 标准类型，如`String`、`Byte`、`Int16`、等`Int32`，`Boolean`并且没有找到选择`Devart.Data.PostgreSql.PqSqlPoint`作为类型的方法。

这是否可能以某种方式实现，或者我总是必须自己在我的财产吸气剂的代码中进行转换？

非常感谢您的帮助。

ps 我们使用实体框架作为 ORM 框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T15:39:22.653

1.  实体框架仅支持原始类型：http: [//msdn.microsoft.com/en-us/library/ee382832.aspx](http://msdn.microsoft.com/en-us/library/ee382832.aspx)。从实体框架的角度来看，PqSqlPoint 不是原始类型。作为一种解决方法，将数据库中的点列映射到模型的 CSDL 和 SSDL 部分中的字符串属性。此外，您可以在部分类中创建 PqSqlPoint 属性（它将字符串转换为 PqSqlPoint）：http: [//www.devart.com/dotconnect/postgresql/docs/?Devart.Data.PostgreSql~Devart.Data.PostgreSql。 PgSqlPoint~Parse.html](http://www.devart.com/dotconnect/postgresql/docs/?Devart.Data.PostgreSql~Devart.Data.PostgreSql.PgSqlPoint~Parse.html)。但它将是只读的。

2.  我们将在实体框架实现中支持 PostGIS。您对此功能感兴趣吗？如果是，我们可以在发布前向您发送我们的内部构建，以便在最终版本中考虑您的意见和建议。

# c# - WPF ScrollViewer 端

> ID：15430343
> 
> 赞同：2
> 
> 时间：2013-03-15T10:45:57.123
> 
> 标签：c#, wpf, xaml, scrollview

我有`Expander`一个嵌套`ScrollViewer`如下所示：

代码（*简化版*）

```
<Expander.Content>
    <ScrollViewer VerticalScrollBarVisibility="Auto" >
        <StackPanel Orientation="Vertical">
            <TextBox FontSize="16"
                    BorderThickness="0"
                    IsReadOnly="True"
                    Background="Transparent"
                    Foreground="MidnightBlue"
                    TextWrapping="Wrap"
                    Text="{Binding LoggingMessage, Mode=OneWay}">
                </TextBox>
            /StackPanel>
         </ScrollViewer>
    </Expander.Content>
</Expander> 
```

我需要更改 ScrollViewer 的一侧，使其显示在左侧。

什么是最简单的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T10:51:44.877

您可以自定义滚动查看器的模板以更改滚动条的位置（除其他外）。模板自定义的 MSDN 示例实际上是展示如何将垂直滚动条向左移动。

[http://msdn.microsoft.com/en-gb/library/aa970847(v=vs.85).aspx](http://msdn.microsoft.com/en-gb/library/aa970847(v=vs.85).aspx)

为了方便起见，这里是代码：

```
<Style x:Key="LeftScrollViewer" TargetType="{x:Type ScrollViewer}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <ScrollContentPresenter Grid.Column="1"/>

                    <ScrollBar Name="PART_VerticalScrollBar"
                        Value="{TemplateBinding VerticalOffset}"
                        Maximum="{TemplateBinding ScrollableHeight}"
                        ViewportSize="{TemplateBinding ViewportHeight}"
                        Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                    <ScrollBar Name="PART_HorizontalScrollBar"
                        Orientation="Horizontal"
                        Grid.Row="1"
                        Grid.Column="1"
                        Value="{TemplateBinding HorizontalOffset}"
                        Maximum="{TemplateBinding ScrollableWidth}"
                        ViewportSize="{TemplateBinding ViewportWidth}"
                        Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>

                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-28T15:57:38.770

滚动条位置由 FlowDirection 属性定义。

有关更多详细信息，请参阅[https://stackoverflow.com/a/22717596/2075605](https://stackoverflow.com/a/22717596/2075605)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-26T19:58:44.597

上面的代码是从右向左改变。但是，您需要从左到右。使用与上面相同的代码，但将滚动内容演示者更改为：

```
<ScrollContentPresenter x:Name="PART_ScrollContentPresenter" Grid.Column="0" Grid.Row="0"/> 
```

$

我测试了它，它对我有用

# javascript - 如何停止元素在位置固定的情况下移动

> ID：15430344
> 
> 赞同：0
> 
> 时间：2013-03-15T10:45:58.997
> 
> 标签：javascript, jquery, css, css-position

有没有机会阻止`postion: fixed;`CSS 中的元素移动？

我知道我不能用 CSS 做到这一点，也许有任何选项可以通过 JS 解决这个问题？

我尝试通过像这样滚动来删除一些值，但是......

```
$(window).scroll(function()
{   var main_menu = $('.main_menu');
    var current_position = $(this).scrollTop();
    if($(window).scrollTop() == $(document).height() - $(window).height())
    {
        main_menu.css('top','0'-current_position+'px');
    }
}); 
```

HTML：

```
<section class="content_block">
    <section id="logo_main"></section>
    <div class="main_menu">

    </div>
</section> 
```

部分`content block`有`overflow: hidden`，并且菜单比父块宽一点。所以我用它`position fixed`来停止拉伸主要部分......

有谁知道如何做到这一点？

# sbt - 如何将 pom xml 转换为 sbt 依赖项？

> ID：15430346
> 
> 赞同：19
> 
> 时间：2013-03-15T10:46:07.667
> 
> 标签：sbt, pom.xml

我有一些项目将所有**依赖**项都存储在**pom.xml**文件中。

如何从内部检索依赖项，以便可以轻松地将它们放置到使用 sbt 的项目中？

复制粘贴所有这些只是耗时..

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-15T10:46:07.667

这个从命令行运行的 scala 脚本负责将 pom.xml 文件转换为打印在屏幕上的 sbt 依赖项。然后您只需为每个 pom.xml 文件复制粘贴一次。

注意： pom.xml 必须与脚本位于同一文件夹中。然后从命令行执行：`scala scriptname.scala`

```
import scala.xml._

(XML.load("pom.xml") \\ "dependencies") \ "dependency" foreach ((dependency: Node) => {
val groupId = (dependency \ "groupId").text
val artifactId = (dependency \ "artifactId").text
val version = (dependency \ "version").text
val scope = (dependency \ "scope").text
val classifier = (dependency \ "classifier").text
val artifactValName: String = artifactId.replaceAll("[-\\.]", "_")

print("val %s = \"%s\" %% \"%s\" %% \"%s\"".format(artifactValName, groupId, artifactId, version))
scope match {
  case "" => print("\n")
  case _ => print(" %% \"%s\"\n".format(scope))
}
None
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-11-24T21:35:27.640

我已经增强了 George Pligor 的答案（并修复了一些错误），因此`build.sbt`创建了一个完整的文件，其中包含来自`pom.xml`. 要将 Maven 转换`pom.xml`为`build.sbt`：

1.  将此代码放入名为`PomToSbt.scala`next 的文件中`pom.xml`
2.  类型`scala PomToSbt.scala > build.sbt`
3.  来自的依赖项`pom.xml`将被提取并放入一个完整的`build.sbt`文件中。

这是代码：

```
import scala.xml._

val lines = (XML.load("pom.xml") \\ "dependencies") \ "dependency" map { dependency => 
  val groupId = (dependency \ "groupId").text
  val artifactId = (dependency \ "artifactId").text
  val version = (dependency \ "version").text
  val scope = (dependency \ "scope").text
  val classifier = (dependency \ "classifier").text
  val artifactValName: String = artifactId.replaceAll("[-\\.]", "_")

  val scope2 = scope match {
    case "" => ""
    case _ => s""" % "$scope""""
  }

  s"""  "$groupId" %% "$artifactId" % "$version"$scope2"""
}

val buildSbt = io.Source.fromURL("https://raw.githubusercontent.com/mslinn/sbtTemplate/master/build.sbt").mkString
val libText = "libraryDependencies ++= Seq("
val buildSbt2 = buildSbt.replace(libText, libText + lines.mkString("\n", ",\n", ""))
println(buildSbt2) 
```

[我做了一个要点](https://gist.github.com/mslinn/21684f1e5da630dfd734)；如果需要任何更新，我会在那里进行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-02T20:45:55.430

迈克，这是至少适用于 Scala 11 的代码：

```
import scala.xml._

//build.sbt file
val lines = (XML.load("pom.xml") \\ "dependencies") \ "dependency" map { dependency =>
  val groupId = (dependency \ "groupId").text
  val artifactId = (dependency \ "artifactId").text
  val version = (dependency \ "version").text
  val scope = (dependency \ "scope").text
  val classifier = (dependency \ "classifier").text
  val artifactValName: String = artifactId.replaceAll("[-\\.]", "_")

  val scope2 = scope match {
    case "" => ""
    case _ => s""" % "$scope""""
  }

  s"""  "$groupId" %% "$artifactId" % "$version"$scope2"""
}

val buildSbt: String = io.Source.fromURL("https://raw.githubusercontent.com/mslinn/sbtTemplate/master/build.sbt").mkString

val libText = "libraryDependencies ++= Seq\\("
val buildSbt2 = buildSbt.replaceFirst(libText, libText + lines.mkString("\n", ",\n", ""))
println(buildSbt2) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-21T21:16:37.837

此[博客条目](http://blog.wandledi.org/post/27780639582/if-only-i-knew-better-using-pom-xml-in-sbt)解释了一种可能的方法。有一条评论指向处理更复杂情况的插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-23T06:41:46.567

```
import scala.xml._
// To convert a Maven pom.xml to build.sbt:
// 1) Place this code into a file called PomToSbt.scala next to pom.xml
// 2) Type scala PomtoSbt.scala > build.sbt
// The dependencies from pom.xml will be extracted and place into a complete build.sbt file
// Because most pom.xml files only refernence non-Scala dependencies, I did not use %%
val lines = (XML.load("pom.xml") \\ "dependencies") \ "dependency" map { dependency => 
  val groupId = (dependency \ "groupId").text
  val artifactId = (dependency \ "artifactId").text
  val version = (dependency \ "version").text
  val scope = (dependency \ "scope").text
  val classifier = (dependency \ "classifier").text
  val artifactValName: String = artifactId.replaceAll("[-\\.]", "_")

  val scope2 = scope match {
    case "" => ""
    case _ => s""" % "$scope""""
  }

  s"""  "$groupId" %  "$artifactId" % "$version"$scope2"""
}

val buildSbt = io.Source.fromURL("https://raw.githubusercontent.com/mslinn/sbtTemplate/master/build.sbt").mkString
val libText = "libraryDependencies ++= Seq("
val buildSbt2 = buildSbt.replace(libText, libText + lines.mkString("\n", ",\n", ""))
println(buildSbt2) 
```

# android - 是否可以使用 stagefright 创建多个 OMXCodec 实例

> ID：15430350
> 
> 赞同：1
> 
> 时间：2013-03-15T10:46:10.790
> 
> 标签：android, stagefright, openmax

我想`libstagefright.so`在安卓手机中使用媒体操作。我已经探索了[此](http://vec.io/posts/use-android-hardware-decoder-with-omxcodec-in-ndk) 页面中给出的示例。我一直在尝试实施相同的方法。在为多个实例测试此实现时 `OMXCodec`，它的输出缓冲区相互冲突。

我在eclipse中开发了一个android项目并`libstagefright`在JNI下链接。我添加了两个类`CustomDataSource`（派生`MediaSource`）和`CustomOmxDecoder`. `CustomDataSource`类实现了所有的虚方法`MediaSource`。在`CustomOmxDecoder`课堂上，我调用`OMXCodec::Create`方法。然后我创建了两个具有单独实例的线程`CustomOmxDecoder`。使用这个实例，我调用了一个方法`ProcessNextFrame`，在该方法中我调用了 main`videoDecoder->read()`方法。这就是我的设置。

现在，当我使用上述设置运行应用程序时。`OMXCodec`解码两个源的帧，但是当我在表面上渲染它时，会显示冲突的输出。似乎两个源的解码缓冲区都以某种方式在内部进行了网格化。我正在同时创建两个 h264 解码器。这里有什么问题？会不会有关系`MediaBufferGroup`？调用 call 后，我在's中获取`CustomDataSource`缓冲区并释放缓冲区。`CustomOmxDecoder``ProcessNextFrame``videoDecoder->read()`

任何建议都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T05:34:17.053

我已经测试并解决了我的问题，怀疑 OMXCodec 的多个实例是可能的。问题出在我的代码中。在修复时，我可以看到 OMXCodec 的多个实例运行稳定流畅。所以，是的，OMXCodec 的多个实例是可能的。

谢谢你们。

# c# - 如何在 C# 中使用 OLEDB 将字典写入 excel 文件

> ID：15430351
> 
> 赞同：0
> 
> 时间：2013-03-15T10:46:15.310
> 
> 标签：c#, excel, oledb

我必须将字典（键、值对）写入 excel 文件。我试过使用`Interop.Excel`并写过这样的：

```
try
{
    string file =@”D:\Someexcel.xls”
    Interop.Excel.Application excelApp = new Interop.Excel.Application();
    excelApp.Visible = true;
    Interop.Excel.Workbook wb = excelApp.Workbooks.Open(file, Type.Missing, Type.Missing,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
        Type.Missing, Type.Missing);
    Interop.Excel.Worksheet ws = wb.ActiveSheet as Interop.Excel.Worksheet;
    Interop.Excel.Range rng = ws.get_Range("A1", Type.Missing);

    //Write Key, Value as header
    ws.Cells[1, 1] = "Key";
    ws.Cells[1, 2] = “Value”;

    int row = 2; // Initialize for keys.
    foreach (string key in dict.Keys)
    {
        int column = 1; // Initialize for values in key.
        ws.Cells[row, column] = key;
        column++;
        ws.Cells[row, column] = dict[key];
        row++;
    }

    if (ws != null)
        Marshal.ReleaseComObject(ws);
    if (wb != null)
        Marshal.ReleaseComObject(wb);
    if (excelApp != null)
        Marshal.ReleaseComObject(excelApp);
    DialogResult result = MessageBox.Show(string.Format("Excel file created , you can find the file @" + file));
    if (result == DialogResult.OK)
        this.Close();
}
catch (Exception err)
{
    string msg;
    msg = "Error:";
    msg = string.Concat(msg, err.Message);
    msg = string.Concat(msg, "Line:");
    msg = string.Concat(msg, err.Source);
    MessageBox.Show(msg);
} 
```

但是，这段代码似乎更频繁地中断，而不是说服务器位置上的 excel 文件已损坏。所以，我想试试OLEDB。我是 OLEDB 的新手。在互联网上到处搜索，但没有关于如何编写字典的信息。你能帮我用`Insert`命令吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:16:25.363

检查此示例以写入 excel。
[http://www.codeproject.com/Articles/8500/Reading-and-Writing-Excel-using-OLEDB](http://www.codeproject.com/Articles/8500/Reading-and-Writing-Excel-using-OLEDB)
OLEDB 类似于您的 ADO.NET，`SqlDataAdapter`您可以在其中指定 INSERT 和 UPDATE 命令并使用 a`DataTable`来插入或更新。对于字典，您可以执行类似的操作，将 Key、Value 作为您的 DataColumns 并将条目添加为行。
Havent 已检查，但您也可以将 OledbCommand 作为 INSERT 和 UPDATE 执行并作为非查询执行。希望这可以帮助。

# jsf-2 - 使用视图处理程序进行内部化显示空白页

> ID：15430352
> 
> 赞同：0
> 
> 时间：2013-03-15T10:46:16.927
> 
> 标签：jsf-2, primefaces

```
public class LocaleViewHandler extends ViewHandler{

    private final ViewHandler base;

    public LocaleViewHandler(ViewHandler base){
        super();
        this.base = base;
    }
    @Override
    public Locale calculateLocale(FacesContext context) {
          Locale locale;
        HttpSession session = (HttpSession) context.getExternalContext()
          .getSession(false);
      if (session != null) {
          //Return the locale saved by the managed bean earlier
          locale = (Locale) session.getAttribute("locale");
          if (locale == null) {
              locale= new Locale("en");

           }
          return locale;
      }
     return base.calculateLocale(context);

    }

    @Override
    public String calculateRenderKitId(FacesContext arg0) {
        // TODO Auto-generated method stub
        return base.calculateRenderKitId(arg0);
    }

    @Override
    public UIViewRoot createView(FacesContext arg0, String arg1) {
        // TODO Auto-generated method stub
        return base.createView(arg0, arg1);
    }

    @Override
    public String getActionURL(FacesContext arg0, String arg1) {
        // TODO Auto-generated method stub
        return base.getActionURL(arg0, arg1);
    }

    @Override
    public String getResourceURL(FacesContext arg0, String arg1) {
        // TODO Auto-generated method stub
        return base.getResourceURL(arg0, arg1);
    }

    @Override
    public void renderView(FacesContext arg0, UIViewRoot arg1)
            throws IOException, FacesException {
        // TODO Auto-generated method stub
        base.renderView(arg0, arg1);
    }

    @Override
    public UIViewRoot restoreView(FacesContext arg0, String arg1) {
        // TODO Auto-generated method stub
        return base.restoreView(arg0, arg1);
    }

    @Override
    public void writeState(FacesContext arg0) throws IOException {
        // TODO Auto-generated method stub
        base.writeState(arg0);
    }

    public ViewHandler getBase() {
        return base;
    }

} 
```

我正在尝试内部化示例，我编写了如上所示的视图处理程序。我有两种语言环境英语和法语。但是在编写了这个处理程序之后。控制台上没有错误，但它显示空白页。可以做些什么来查看视图..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T13:04:45.457

您应该扩展[`ViewHandlerWrapper`](http://download.oracle.com/javaee/6/api/javax/faces/application/ViewHandlerWrapper.html)而不是编写自己的`ViewHandler`.

```
public class LocaleViewHandler extends ViewHandlerWrapper {

    private ViewHandler wrapped;

    public LocaleViewHandler(ViewHandler wrapped) {
        this.wrapped = wrapped;
    }

    @Override
    public ViewHandler getWrapped() {
        return wrapped;
    }

    @Override
    public Locale calculateLocale(FacesContext context) {
        // Do your thing here.
    }

} 
```

* * *

**与具体问题无关**，这并不完全是正确的方法。你应该只使用

```
<f:view locale="#{localeBean.locale}"> 
```

反而。另请参阅[JSF 中的本地化，如何记住每个会话而不是每个请求/视图选择的语言环境](https://stackoverflow.com/questions/4830588/jsf-locale-is-set-per-request-not-for-session/4830669#4830669)。

# javascript - 基于每 2 个图像行的容器高度

> ID：15430353
> 
> 赞同：1
> 
> 时间：2013-03-15T10:46:16.813
> 
> 标签：javascript, jquery, html, css, ajax

我在这个[网站上工作](http://testweb.ivanhugo.com/portraitlist)

我正在使用此脚本调整垂直图像的大小：

```
function Gallery(selector) {
  this.add_module = function (type, image) {

    var portrait_text = image.next('.portrait_text');

    var container = $('<div />', {
      'class': 'gallery_container'
    }).append(image).append(portrait_text);

    if (type == 'horizontal') {
      var h_ar = image.attr('height') / image.attr('width');
      var c_width = selector.width();
      var c_height = selector.width() * h_ar
      container.css({
        'width': c_width,
        'height': c_height
      })
    }
    if (type == 'vertical') {
      var c_width = v_width;
      var c_height = v_height
      container.css({
        'width': Math.floor(v_width),
        'height': v_height
      })
    }
    container.css({
      'float': 'left',
    })
    container.find('img').attr({
      'width': '100%',
      'height': '100%'
    })
    container.attr('ar', c_height / c_width)
    container.appendTo(selector);

    //container.children('img').fitToBox();
  }

  this.resized = function () {
    //console.log(sel)
    $('.gallery_container').each(function () {
      if ($(this).attr('ar') >= 1) { // vertical
        $(this).css({
          'width': sel.width() / 2,
          'height': sel.width() / 2 * $(this).attr('ar')
        })
      } else { // horizontal
        $(this).css({
          'width': sel.width(),
          'height': sel.width() * $(this).attr('ar')
        })
      }
    })
  }
  var _this = this;
  var gutter = 0;
  // start vars for counting on vertical images
  var v_counter = 0;
  var w_pxls = 0;
  var h_pxls = 0;
  var v_ar;
  // iterates through images looking for verticals
  selector.children('img').each(function () {
    if (parseInt($(this).attr('width')) < parseInt($(this).attr('height'))) {
      v_counter++;
      h_pxls += $(this).attr('height');
      w_pxls += $(this).attr('width');
      v_ar = $(this).attr('height') / $(this).attr('width')
    }
  })
  // calculates average ar for vertical images (anything outside from aspect ratio will be croped)
  var h_avrg = Math.floor(h_pxls / v_counter);
  var w_avrg = Math.floor(w_pxls / v_counter);
  var v_width = Math.floor((selector.width()) / 2);
  var v_height = v_width * v_ar;
  var sel = selector;
  selector.children('img').each(function () {
    if (parseInt($(this).attr('width')) > parseInt($(this).attr('height'))) {
      _this.add_module('horizontal', $(this));
    } else {
      _this.add_module('vertical', $(this));
    }
  })
  $(window).bind('resize', _this.resized);
}

var gallery = new Gallery($('#gallery_images_inner')); 
```

[http://jsfiddle.net/mZ2Ks/](http://jsfiddle.net/mZ2Ks/)

我遇到的问题是脚本使所有容器的高度相同（取决于我认为页面上的最后一个图像），因此例如第一个图像以不好的方式调整大小。如果您查看示例，**所有 2 个图像行的高度均为 613 像素。**

有什么办法可以控制**每两个图像容器**根据其图像计算它自己的高度，现在看起来它**计算最后一个图像调整高度并将其应用于所有其他容器**

**应用 height: auto 而不是 100% 将不起作用，因为它不会使图像适合垂直容器的高度。**

如何修复脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:50:09.237

是的，有一个简单的方法。但首先：你的画廊脚本计算里面所有图像的平均纵横比。没有简单的方法可以改变这种行为。

但是你可以做这个简单的解决方法：把两张图片放在他们自己的画廊里！

```
var gallery1 = new Gallery($('#gallery_images_inner1'));
var gallery2 = new Gallery($('#gallery_images_inner2'));
var gallery3 = new Gallery($('#gallery_images_inner3')); 
```

请参阅[http://jsfiddle.net/mZ2Ks/2/](http://jsfiddle.net/mZ2Ks/2/) - 我不得不稍微清理一下您的 html 代码 - 您从（我假设）firebug 复制了“受 JavaScript 影响的”html 代码，但您应该复制纯 html直接来自源代码（Firefox 中的 CTRL + U）。

# ruby-on-rails - Rails 3 CSS3字体未加载

> ID：15430354
> 
> 赞同：1
> 
> 时间：2013-03-15T10:46:18.463
> 
> 标签：ruby-on-rails, ruby-on-rails-3

应用程序.css：

```
@font-face {
  font-family: "Futura-Light";
  src: url("/assets/Futura-Light.ttf") format("truetype"); /* For IE */
  src: local("Futura-Light"), url("/assets/Futura-Light.ttf") format("truetype"); /* For non-IE */
  font-weight: normal;
  font-style: normal;
}

* {margin:0px;padding:0px;}
#wrap {width:730px;position:relative;font-family:"Futura-Light";} 
```

我已将此添加到 application.rb：

```
config.assets.paths << "#{Rails.root}/app/assets/fonts" 
```

我可以在访问时下载字体：`http://localhost:3000/assets/Futura-Light.ttf`

为什么没有加载字体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:26:45.823

省略 /assets/ 是您的网址。Rails 会为你添加这个，因为在开发和生产中这些路径可能不同。

```
 src: url("Futura-Light.ttf") format("truetype"); /* For IE */
  src: local("Futura-Light"), url("Futura-Light.ttf") format("truetype"); /* For non-IE */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:40:52.090

使用如下所示的**asset_path**来编写字体文件的路径很好。

`src: url(<%= asset_path 'Futura-Light.ttf' %>) format('truetype'); /* For IE */ src: local("Futura-Light"), url(<%= asset_path 'Futura-Light.ttf' %>) format('truetype'); /* For non-IE */`

# android - Eclipse 在保存时运行 android 应用程序

> ID：15430358
> 
> 赞同：1
> 
> 时间：2013-03-15T10:46:25.457
> 
> 标签：android, eclipse, ant, adt

我将有很多 UI 工作要做，其中一些在 Eclipse 中的“图形布局”窗格无法帮助我的代码中。可能我必须大量部署代码才能使所有内容在视觉上完美对齐。

我想调整 eclipse 以便在我每次保存时触发设备上的自动运行。

我希望我的工作流程是 - 修改代码 - 保存 - 看向设备以查看差异。

请告诉我这可以做到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:07:12.977

Eclipse 有一个 Builder 系统，[检查这个](https://stackoverflow.com/questions/3360596/eclipse-auto-build-after-save/3360636#3360636).

我创建了一个新的 Builder 程序，并创建了一个小的 .bat 文件来安装我的 apk 。还检查了“构建选项”启动背景和“自动构建期间”。

我被调用的脚本如下所示；

```
adb install -r c:\dev\myapp.apk
adb shell am start -n com.company.exampleapp/com.company.exampleapp.ExampleApp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:53:38.760

也许您可以通过自定义 Builder 来实现这一点。右键单击您的项目 -> `Preferences`-> `Builders`-> `New`-> `Program`。尝试运行运行配置或编写启动部署的脚本并在此处使用它。是否可以通过 Maven 部署到设备？那么这对于您自己的构建器来说将是一个更好的选择（选择`New`-> `Maven Build`）。

# c# - 使用 xml 元素创建 kml 文件

> ID：15430363
> 
> 赞同：2
> 
> 时间：2013-03-15T10:46:43.583
> 
> 标签：c#, xml, kml

我想在 C# 中创建一个 kml 文件。现在我有两个问题：

1.  在 xml 文件中添加 kml 元素以便在我的 kml 文件中包含以下行的 synatx 是什么？

    ```
    <kml xmlns="http://www.opengis.net/kml/2.2"> 
    ```

2.  我有一个点数组，我想形成一个线串。我想如何在 xml 中为 kml 文件填充坐标元素？以下是我的代码。

**代码**：

```
public void MakeKmlFile(string line)
{
    CoordinateCollection coordinates = new CoordinateCollection();

    char[] delimiterLine = { '|' };
    char[] delimiterPoint = { ',' };
    string[] route = line.Split(delimiterLine);

    foreach (string point in route)
    {
        string[] route_point = line.Split(delimiterPoint);
        double lat = double.Parse(route_point[1]);
        double lon = double.Parse(route_point[0]);
        coordinates.Add(new Vector(lat, lon));
    }

    XmlTextWriter writer = new XmlTextWriter("route.xml", System.Text.Encoding.UTF8);
    writer.Formatting = Formatting.Indented;
    writer.WriteStartElement("Document");
    writer.WriteStartElement("Folder");
    writer.WriteStartElement("name");
    writer.WriteString("route");
    writer.WriteEndElement();
    writer.WriteStartElement("Placemark");
    writer.WriteStartElement("Style");
    writer.WriteStartElement("LineStyle");
    writer.WriteStartElement("color");
    writer.WriteString("ff0000ff");
    writer.WriteEndElement();
    writer.WriteEndElement();
    writer.WriteStartElement("PolyStyle");
    writer.WriteStartElement("fill");
    writer.WriteString("2");
    writer.WriteEndElement();
    writer.WriteEndElement();
    writer.WriteEndElement();
    writer.WriteStartElement("LineString");
    writer.WriteStartElement("coordinates"); 
```

这是我得到的结果：

```
<?xml version="1.0" encoding="utf-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <Name>Points.kml</Name>
    <Placemark />
    <Placemark />
    <Placemark />
    <Placemark />
    <Placemark />
  </Document> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:56:13.767

您可以像创建普通 XML 文档一样创建 KML 文档

```
 XmlDocument xDoc = new XmlDocument();
    XmlDeclaration xDec = xDoc.CreateXmlDeclaration("1.0", "utf-8", null);

    XmlElement rootNode = xDoc.CreateElement("kml");
    rootNode.SetAttribute("xmlns", @"http://www.opengis.net/kml/2.2");
    xDoc.InsertBefore(xDec, xDoc.DocumentElement);
    xDoc.AppendChild(rootNode);
    XmlElement docNode = xDoc.CreateElement("Document");
    rootNode.AppendChild(docNode);

    XmlElement nameNodeMain = xDoc.CreateElement("Name");
    XmlText nameTextMain = xDoc.CreateTextNode("Points.kml");
    docNode.AppendChild(nameNodeMain);
    nameNodeMain.AppendChild(nameTextMain); 
```

这为您的文档设置了基本结构，然后您需要做的就是添加每个地标（最好通过循环完成）

```
 char[] delimiterLine = { '|' };
    char[] delimiterPoint = { ',' };
    string[] places = line.Split(delimiterLine);
    for (int i = 0; i < places.length; i++)
        {
            string[] placeMark = places[i].split(delimiterPoint);
            XmlElement placeNode = xDoc.CreateElement("Placemark");
            docNode.AppendChild(placeNode);

            XmlElement nameNode = xDoc.CreateElement("Name");
            XmlText nameText = xDoc.CreateTextNode(placeMark[0]);
            placeNode.AppendChild(nameNode);
            nameNode.AppendChild(nameText);

            XmlElement descNode = xDoc.CreateElement("Description");
            XmlText descText = xDoc.CreateTextNode(placeMark[1]);
            placeNode.AppendChild(descNode);
            descNode.AppendChild(descText);

            XmlElement pointNode = xDoc.CreateElement("Point");
            placeNode.AppendChild(pointNode);

            XmlElement coordNode = xDoc.CreateElement("coordinates");
            XmlText coordText = xDoc.CreateTextNode(string.Format("{0},{1}", placeMark[2], placeMark[3]));
            pointNode.AppendChild(coordNode);
            coordNode.AppendChild(coordText);
        }
        return xDoc; 
```

我以前没有在 KML 中使用过 LineStrings，但我怀疑这样做的代码将遵循以下内容：

```
 XmlDocument xDoc = new XmlDocument();
    XmlDeclaration xDec = xDoc.CreateXmlDeclaration("1.0", "utf-8", null);

    XmlElement rootNode = xDoc.CreateElement("kml");
    rootNode.SetAttribute("xmlns", @"http://www.opengis.net/kml/2.2");
    xDoc.InsertBefore(xDec, xDoc.DocumentElement);
    xDoc.AppendChild(rootNode);
    XmlElement docNode = xDoc.CreateElement("Document");
    rootNode.AppendChild(docNode);

    XmlElement nameNodeMain = xDoc.CreateElement("Name");
    XmlText nameTextMain = xDoc.CreateTextNode("Points.kml");
    docNode.AppendChild(nameNodeMain);
    nameNodeMain.AppendChild(nameTextMain);

XmlElement placeNode = xDoc.CreateElement("Placemark");
docNode.AppendChild(placeNode);

XmlElement nameNode = xDoc.CreateElement("Name");
XmlText nameText = xDoc.CreateTextNode("Test line");
placeNode.AppendChild(nameNode);
nameNode.AppendChild(nameText);

XmlElement lineStringNode = xDoc.CreateElement("LineString");
placeNode.AppendChild(lineStringNode);

XmlElement coordNode = xDoc.CreateElement("coordinates");

char[] delimiterLine = { '|' };
    char[] delimiterPoint = { ',' };
    string[] places = line.Split(delimiterLine);
    for (int i = 0; i < places.length; i++)
    {
    string[] placeMark = places[i].split(delimiterPoint);

    XmlText coordText = xDoc.CreateTextNode(string.Format("{0},{1}", placeMark[0], placeMark[1]));
    pointNode.AppendChild(coordNode);
   }

coordNode.AppendChild(coordText);

xDoc.Save("./KML/"); 
```

它基本上涉及移动我以前的代码并为 KML 文件中所需的每个主要元素创建一个 XmlElement，然后在将它们拆分为行字符串后遍历坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T18:57:46.757

最直接的解决方案是标记路线（线串）并将坐标附加到字符串缓冲区中，然后作为值输出。无需创建 CoordinateCollection 和单独的 Vector 对象。

注意：为了成为有效的 KML，您必须先输出经度值，然后输出用逗号 (,) 分隔的纬度，在 lon-lat 值之间没有空格，并且空格必须可选地使用高度值分隔每个 lon-lat 对。

[*这是使用System.Xml.XmlTextWriter*](http://msdn.microsoft.com/en-us/library/w703ce6s%28v=vs.71%29.aspx)类的 C# 解决方案：

```
 XmlTextWriter writer = new XmlTextWriter(...);
    writer.WriteStartElement("kml", "http://www.opengis.net/kml/2.2");
    ...
    writer.WriteStartElement("LineString");
    StringBuilder sb = new StringBuilder();
    foreach (string point in route)
    {
        string[] route_point = point.Split(delimiterPoint);
        if (route_point.Length >= 2)
        {
          double lon = double.Parse(route_point[0]);
          double lat = double.Parse(route_point[1]);
          sb.Append(' ').Append(lon).Append(',').Append(lat);
          // coordinates.Add(new Vector(lat, lon));
        }
    }
    writer.WriteStartElement("coordinates");
    writer.WriteValue(sb.ToString());
    writer.WriteEndElement(); // end coordinates
    writer.WriteEndElement(); // end LineString
    writer.WriteEndElement(); // end Placemark
    ...
    writer.Close(); 
```

# web-services - 为什么我要使用 JBoss AS7 在两个不同的地址发布 Web 服务？

> ID：15430365
> 
> 赞同：1
> 
> 时间：2013-03-15T10:46:44.413
> 
> 标签：web-services, jboss, cxf, jboss7.x, jbossws

作为了解 JAX-WS 和 CXF 的练习，我决定实现一个计算 BMI 的小型服务。它基于[本教程](http://www.mastertheboss.com/jboss-web-services/jboss-cxf-web-services)。

我会假设只使用我在 xml 端点定义中指定的地址，但实际上 jboss 也使它在其他地方可用。

我得到相同的服务，两者都可用

```
http://localhost:8080/BMI/BmiCalculatorService 
```

并且在

```
http://localhost:8080/BMI/services/cxfBmi. 
```

任何人都可以帮忙吗？

这是我的 web.xml：

```
<web-app>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>WEB-INF/beans.xml</param-value>
</context-param>

<listener>
    <listener-class>
        org.springframework.web.context.ContextLoaderListener
    </listener-class>
</listener>

<servlet>
    <servlet-name>CXFServlet</servlet-name>
    <display-name>CXF Servlet</display-name>
    <servlet-class>
        org.apache.cxf.transport.servlet.CXFServlet
    </servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>CXFServlet</servlet-name>
    <url-pattern>/services/*</url-pattern>
</servlet-mapping>
</web-app> 
```

这是我的 beans.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:jaxws="http://cxf.apache.org/jaxws"
xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd">

<import resource="classpath:META-INF/cxf/cxf.xml" />
<import resource="classpath:META-INF/cxf/cxf-extension-soap.xml"/>
<import resource="classpath:META-INF/cxf/cxf-servlet.xml" />    

<jaxws:endpoint id="calcBMI"
                implementor="com.company.bmi.services.BMICalculatorImpl"
                address="/cxfBmi"/>

</beans> 
```

接口定义：

```
package com.company.bmi.services;

import javax.jws.WebParam;
import javax.jws.WebService;

@WebService
public interface BMICalculator {

public double computeBMI(@WebParam(name="weight") double weight, @WebParam(name="height") double height) ;

} 
```

以及服务的实现：

```
package com.company.bmi.services;

import javax.jws.WebService;

@WebService(endpointInterface="com.company.bmi.services.BMICalculator", serviceName="BmiCalculatorService") 
public class BMICalculatorImpl implements BMICalculator {

    @Override
    public double computeBMI(double weight, double height) {
        return weight / (height * height);
    }

} 
```

在 Jboss 的日志中，我看到我提到的第一个 URL 确实是设置为服务的发布地址的那个。然后它变成我在 xml 文件中指定的那个。问题是第一个地址仍然有效，我认为这是不正确的。

但是后来在日志中服务器也抱怨找不到服务的观察者，所以我想知道这是否是导致不良结果的原因？

这是日志示例：

```
10:29:39,326 INFO  [org.jboss.wsf.stack.cxf.metadata.MetadataBuilder] (MSC service thread 1-5) Add Service
id=com.company.bmi.services.BMICalculatorImpl
address=http://localhost:8080/BMI/BmiCalculatorService
implementor=com.company.bmi.services.BMICalculatorImpl
invoker=org.jboss.wsf.stack.cxf.JBossWSInvoker
serviceName={http://services.bmi.company.com/}BmiCalculatorService
portName={http://services.bmi.company.com/}BMICalculatorImplPort
wsdlLocation=null
mtomEnabled=false
10:29:39,441 INFO  [org.apache.cxf.service.factory.ReflectionServiceFactoryBean] (MSC service thread 1-5) Creating Service {http://services.bmi.company.com/}BmiCalculatorService from class com.company.bmi.services.BMICalculator
10:29:39,748 INFO  [org.apache.cxf.endpoint.ServerImpl] (MSC service thread 1-5) Setting the server's publish address to be http://localhost:8080/BMI/BmiCalculatorService
10:29:39,832 INFO  [org.jboss.wsf.stack.cxf.deployment.WSDLFilePublisher] (MSC service thread 1-5) WSDL published to: file:/zimory/jboss/switchyard-as7-0.5/standalone/data/wsdl/BMICalculator-0.0.1-SNAPSHOT.war/BmiCalculatorService.wsdl
10:29:39,836 INFO  [org.jboss.as.webservices] (MSC service thread 1-2) JBAS015539: Starting service jboss.ws.port-component-link
10:29:39,844 INFO  [org.jboss.as.webservices] (MSC service thread 1-4) JBAS015539: Starting service jboss.ws.endpoint."BMICalculator-0.0.1-SNAPSHOT.war"."com.company.bmi.services.BMICalculatorImpl"
10:29:39,847 INFO  [org.jboss.ws.common.management.DefaultEndpointRegistry] (MSC service thread 1-4) register: jboss.ws:context=BMI,endpoint=com.company.bmi.services.BMICalculatorImpl
10:29:39,849 INFO  [org.jboss.weld.deployer] (MSC service thread 1-7) JBAS016008: Starting weld service for deployment BMICalculator-0.0.1-SNAPSHOT.war
10:29:40,077 INFO  [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/BMI]] (MSC service thread 1-5) Initializing Spring root WebApplicationContext
10:29:40,078 INFO  [org.springframework.web.context.ContextLoader] (MSC service thread 1-5) Root WebApplicationContext: initialization started
10:29:40,091 INFO  [org.springframework.web.context.support.XmlWebApplicationContext] (MSC service thread 1-5) Refreshing Root WebApplicationContext: startup date [Fri Mar 15      10:29:40 CET 2013]; root of context hierarchy
10:29:40,111 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-5) Loading XML bean definitions from ServletContext resource [/WEB-INF/beans.xml]
10:29:40,138 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-5) Loading XML bean definitions from class path resource [META-INF/cxf/cxf.xml]
10:29:40,152 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-5) Loading XML bean definitions from class path resource [META-INF/cxf/cxf-extension-soap.xml]
10:29:40,162 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-5) Loading XML bean definitions from class path resource [META-INF/cxf/cxf-servlet.xml]
10:29:40,415 INFO  [org.springframework.beans.factory.support.DefaultListableBeanFactory] (MSC service thread 1-5) Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@7cbdc6a3: defining beans [cxf,org.apache.cxf.bus.spring.BusWiringBeanFactoryPostProcessor,org.apache.cxf.bus.spring.Jsr250BeanPostProcessor,org.apache.cxf.bus.spring.BusExtensionPostProcessor,org.apache.cxf.binding.soap.SoapBindingFactory,org.apache.cxf.binding.soap.SoapTransportFactory,org.apache.cxf.binding.soap.customEditorConfigurer,calcBMI]; root of factory hierarchy
10:29:40,498 INFO  [org.apache.cxf.service.factory.ReflectionServiceFactoryBean] (MSC service thread 1-5) Creating Service {http://services.bmi.company.com/}BmiCalculatorService from class com.company.bmi.services.BMICalculator
10:29:40,724 INFO  [org.apache.cxf.endpoint.ServerImpl] (MSC service thread 1-5) Setting the server's publish address to be /cxfBmi
10:29:40,730 INFO  [org.springframework.web.context.ContextLoader] (MSC service thread 1-5) Root WebApplicationContext: initialization completed in 652 ms
10:29:40,763 INFO  [org.jboss.web] (MSC service thread 1-5) JBAS018210: Registering web context: /BMI
10:29:40,874 INFO  [org.jboss.as.server] (management-handler-thread - 2) JBAS018559: Deployed "BMICalculator-0.0.1-SNAPSHOT.war" [2013-03-15 10:29:40,895] Artifact BMICalculator:war: Artifact is deployed successfully
10:39:07,639 WARNING [org.apache.cxf.transport.servlet.ServletController] (http--127.0.0.1-8080-2) Can't find the the request for http://localhost:8080/BMI/services/cfxBmi/BmiCalculatorService's Observer 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T13:03:14.213

地址`http://localhost:8080/BMI/services/*`由显式创建`CXFServlet`。

While`http://localhost:8080/BMI/BmiCalculatorService`是`org.jboss.wsf.stack.cxf.metadata.MetadataBuilder`通过隐式注释扫描创建的。

请参阅[如何在 JBoss AS 7 中禁用扫描 @WebService 注释？](https://stackoverflow.com/questions/13022968/how-to-disable-scanning-webservice-annotations-in-jboss-as-7)为治愈。

# .net - Azure 现在为 TimeZoneInfo.Local.Id 而不是“UTC”返回“协调世界时”的无效值？为什么？

> ID：15430368
> 
> 赞同：15
> 
> 时间：2013-03-15T10:46:47.597
> 
> 标签：.net, azure, timezone

从 3 月 7 日开始，东南亚地区的 Azure 服务器似乎应用了一个补丁，该补丁改变了 TimeZoneInfo 在 .NET 中的行为。

将我的本地机器设置为“（UTC）协调世界时”，然后运行以下代码会产生“UTC”：

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(TimeZoneInfo.Local.Id);
            Console.ReadLine();
        }
    }
} 
```

远程访问我们的一个 Azure 实例并运行相同的应用程序会产生以下结果：

“协调世界时”

根据[.NET 文档](http://msdn.microsoft.com/en-us/library/vstudio/system.timezoneinfo.id(v=vs.100).aspx)，这是应该由 StandardName 属性返回的值，而不是 Id 属性。我们将此值传递给 TimeZoneInfo.FindSystemTimeZoneById()，但它失败了，因为“协调世界时”不是有效的 Id（“UTC”是）。这个时区是仅有的 3 个 StandardName 属性与 Id 属性不匹配的时区之一。

在 3 月 7 日之前，Azure 实例始终返回正确的“UTC”值。我们暂时将“UTC”硬编码为权宜之计。

有谁知道为什么会变成这种方式，以及处理这种情况的正确长期解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T13:34:19.360

目前，Windows Azure 中的时区是太平洋标准时间 (PST)。它们已迁移到协调世界时 (UTC)。对于依赖本地时间的应用程序来说，这可能是一个重大变化。

**我们为什么这样做呢？**

Windows Azure 是一项全球服务。为确保应用程序无论其物理位置如何都以相同的方式运行，Windows Azure 在所有地区具有一致的时区非常重要。鉴于全球客户群，UTC 是自然的选择，并且 UTC 不受夏令时（以及相关的错误风险）的影响。

**对您有什么潜在影响？**

如果您在 Windows Azure 中运行的应用程序依赖于本地时间，那么您将受到迁移到 UTC 的影响。以下是一些潜在问题的示例：

如果使用本地时间戳，事件日志中可能会出现间隙。依赖于本地时间戳的用户界面可能会显示不同的结果。转换后，您的应用程序存储的本地时间戳可能会有不同的解释。许多应用程序已经设计为仅依赖于 UTC 时间。这些应用程序应该不受影响。

如果您希望他们将其改回或者如果您有任何其他问题，您可以在以下博客链接上与他们讨论::

[Windows Azure 博客](http://blogs.msdn.com/windowsazure)

# c - 有人可以在以下示例中解释 C 预处理器的行为吗？

> ID：15430369
> 
> 赞同：1
> 
> 时间：2013-03-15T10:46:48.697
> 
> 标签：c, macros, c99, c-preprocessor

我正在实现一个 C 宏预处理器（C99）......

我对以下行为感到惊讶....

例1：

```
#define PASTE(x) X_##x
#define 扩展（x）粘贴（x）
#define TABSIZE 1024
#define BUFSIZE TABSIZE

粘贴（BUFSIZE）
扩展（BUFSIZE）

```

扩展为：

```
X_BUFFSIZE
X_1024

```

例 2：

```
#define EXPAND(s) TO_STRING(s)
#define TO_STRING(s) #s
#定义四个 4

TO_STRING（四）
展开（四）

```

扩展为：

```
“四”
“4”

```

我已经通过了 C 的“免费”标准，但我找不到以下内容......

1.  实际上预处理器执行了多少遍？
2.  它是否先替换一个宏然后再替换另一个等等
3.  或者它是否存储并替换它们，因为它们`#define`是一一遇到的？
4.  是先包含文件还是先进行宏扩展？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:50:16.280

对于初学者，您应该阅读[此页面。](http://gcc.gnu.org/onlinedocs/cppinternals/Macro-Expansion.html)它包含宝石，例如：

> C 标准规定，在将任何参数替换为其可能扩展的参数之后，将扫描替换列表以查找嵌套宏。此外，如果替换列表中未扩展的任何标识符在此扫描期间未扩展，则将来不再有资格进行扩展，如果它们未扩展的原因是相关宏已禁用。

我认为可以从中推断出没有固定的传递次数：每次发生宏扩展（生成“替换列表”）时，都会扫描新创建的文本以进行进一步的扩展。这是一个递归过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T12:32:51.190

> 实际上预处理器执行了多少遍？

1.  `# PARAMETER`它通过该参数的字符串化替换所有出现的
2.  它加入了所有中间的`##`令牌
3.  它用参数的值替换所有剩余的参数
4.  它递归地扩展出现其他宏的替换文本。（宏本身在这些递归调用中被阻塞。）

> 它是先替换一个宏然后再替换另一个等等，还是在遇到#defines时存储并替换它们？

它按照在程序文本中遇到宏的顺序或在上述递归替换期间替换宏。

> 是先包含文件还是先进行宏扩展？

首先，如果 an 的参数`#include`不包含在`<>`or中包含的内容中，则它会被扩展`""`。那一定会导致确切地说某物在里面`<>`或里面`""`

# android - 在画廊视图上加载 HTML5 内容似乎很慢

> ID：15430372
> 
> 赞同：0
> 
> 时间：2013-03-15T10:46:59.730
> 
> 标签：android, performance, android-widget

我正在开发一个在线杂志应用程序。它从服务器下载 50 到 100 个 html5 文件并将其存储在 sd 卡上，并将这些 html5 文件显示为杂志页面。我已经使用画廊小部件来加载 html 页面，它按我的要求工作。

但是一些问题，如在画廊中加载 html 似乎很慢，并且在滑动页面时页面移动如此缓慢仍然存在。我的代码如下

```
 public View getView(int position, View convertview, ViewGroup parent) {

    try{
    vi = convertview;
    final int loctn = position;

    if (convertview == null)
        vi = inflater.inflate(R.layout.contentsadapter, null);
        WebView webview=(WebView)vi.findViewById(R.id.webView1);

        webview.getSettings().setJavaScriptEnabled(true);

        webview.loadUrl(pages.get(loctn));

        webview.setWebViewClient(new WebViewClient() {

            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                view.loadUrl(url);
                return true;
            }

            @Override
            public boolean shouldOverrideKeyEvent(WebView view, KeyEvent event) {
                if ((event.getKeyCode() == KeyEvent.KEYCODE_BACK)
                        && view.canGoBack()) {
                    view.goBack();
                    return true;
                }

                return super.shouldOverrideKeyEvent(view, event);
            }

            public void onReceivedError(WebView view, int errorCode,
                    String description, String failingUrl) {

                /*Intent intent = new Intent(Femi9Activity.this,
                        SplashScreen.class);
                intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                Femi9Activity.this.startActivity(intent);*/
            }
        });
webview.getSettings().setDomStorageEnabled(true);

    // Set cache size to 8 mb by default. should be more than enough
    webview.getSettings().setAppCacheMaxSize(1024 * 1024 * 8);

    webview.getSettings().setAllowFileAccess(true);
    webview.getSettings().setAppCacheEnabled(true);

    webview.setOnTouchListener(new OnTouchListener(){

        public boolean onTouch(View v, MotionEvent event) {
            gallery.onTouchEvent(event);
            return false;
        }

    });
        }catch(Exception e){

          }finally{

                }
    return vi;
            }

          } 
```

所以问题是

1.  如何提高 HTML 加载速度。
2.  我可以在当前页面上加载上一页和下一页 html
3.  有没有更好的方法来做到这一点而不使用画廊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T06:55:41.183

您可以使用`ViewPager`而不是`Gallery`.

# wpf - 从 ViewModel 绑定图像

> ID：15430374
> 
> 赞同：1
> 
> 时间：2013-03-15T10:47:02.287
> 
> 标签：wpf, image, mvvm

我正在使用 XamDataTree，我需要节点图标为每种类型的节点提供不同的图像。我试过[在 Infragistics 上问这个问题](https://www.infragistics.com/my-account/support-case/CAS-110340-F4X0S8)，但我们彼此不理解 :(

而且这个问题真的与他们的控制无关，它是关于如何获取存储在模型中的图像来显示。是的，这违反了 MVVM 的原则，但这是显示图像的唯一可行方式。

注意：我有一个解决方法，使用标签指定节点内容并在其中放置一个水平堆栈面板，其中包含图像和节点文本。但这很糟糕，我希望 XamDataGrid 对象显示图像。

这里展示了 28 种不同的图像，其中一些是动态创建的。所以我不想制作大量不同的模板，通过文件路径加载图像，然后使用不同的模板。

XamDataTree，我还尝试使用元素名称或指定绑定[！](https://stackoverflow.com/questions/12970304/bind-image-in-datatemplate-to-system-drawing-image). 我正在尝试直接从模型或通过 DataTemplate 加载图像：

```
<ig:XamDataTree
    ScrollViewer.CanContentScroll="True"
    ItemsSource="{Binding Model}"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch"
    NodeLineVisibility="Visible"
    >
    <ig:XamDataTree.Resources>
        <DataTemplate x:Key="nodeImage" >
            <Image Source="{Binding Path=NodeImage}" />
        </DataTemplate>
    </ig:XamDataTree.Resources>
    <ig:XamDataTree.GlobalNodeLayouts>
        <ig:NodeLayout
            ExpandedIconTemplate="{StaticResource nodeImage}"
            CollapsedIconTemplate="{Binding NodeImage}"
            Key="Children"
            DisplayMemberPath="Name"
            TargetTypeName="Model"
            >
        </ig:NodeLayout>
    </ig:XamDataTree.GlobalNodeLayouts>
</ig:XamDataTree> 
```

我使用的模型，图像源值在别处设置：

```
public class Model
{
    /// <summary>
    /// Image representing the type of node this is.
    /// </summary>
    public ImageSource NodeImage
    {
        get
        {
            return this.nodeImage;
        }
        set
        {
            this.nodeImage = value;
            this.OnPropertyChanged("NodeImage");
        }
    }

    /// <summary>
    /// Controls will bind their attributes to this event handler.
    /// </summary>
    public event PropertyChangedEventHandler PropertyChanged;

    /// <summary>
    /// Fire an event alerting listners a property changed.
    /// </summary>
    /// <param name="name">Name of the property that changed.</param>
    public void OnPropertyChanged(string name)
    {
        // Check whether a control is listening.
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(name));
        }
    }
} 
```

编辑：我尝试将图像直接从文件加载到 BitmapImage 中，然后将它们存储在模型中，但不起作用。当使用更高的调试级别消息传递时，它会在输出中发布数据绑定找不到对应属性的消息。所以问题很可能出在我的数据绑定中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:19:07.393

另一种解决方案是为您的属性 NodeImage 使用转换器和 Stream 类型。

**转换器：**

```
public class StreamToImageConverter : IValueConverter {
  public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture) {
        var imageStream = value as System.IO.Stream;
        if (imageStream != null)) {
            System.Windows.Media.Imaging.BitmapImage image = new System.Windows.Media.Imaging.BitmapImage();
            image.SetSource(imageStream );
            return image;
        }
        else {
           return null;
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture) {
        throw new NotImplementedException();
    }
} 
```

**财产：**

```
private Stream _imageStream;
public Stream NodeImage
{
    get
    {
        return _imageStream;
    }
    set
    {
        _imageStream= value;
        this.OnPropertyChanged("NodeImage");
    }
} 
```

**XAML：**

```
<Grid>
   <Grid.Resources>
     <local:StreamToImageConverter x:Name="imageConverter"/>
   </Grid.Resources>
   <Image Source="{Binding Path=NodeImage, Converter={StaticResource imageConverter}" />
 </Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:48:21.907

更改您的属性`NodeImage`以键入`string`并返回图像的路径。其余部分由 Image 和将路径转换为 ​​ImageSource 的转换器类完成。

```
private string _imagePath;
public string NodeImage
{
    get
    {
        return _imagePath;
    }
    set
    {
        _imagePath = value;
        this.OnPropertyChanged("NodeImage");
    }
} 
```

# c++ - GoogleTest - 在一个夹具中有多个 setUp()

> ID：15430378
> 
> 赞同：3
> 
> 时间：2013-03-15T10:47:05.963
> 
> 标签：c++, unit-testing, testing, googletest

我正在对 C++ 代码进行单元测试，并且在庞大的数据集上运行复杂的算法。我想在第一个简单的不现实数据集上运行测试，并在类似现实的数据集上运行测试。所以，我希望我的灯具看起来像这样：

```
class AppsToBeTested : public ::testing::Test 
{
public:
   AppsToBeTested():member(NULL)
   {

   }

   setUp1()
   {

   }

   setUp2()
   {

   }

   tearDown()
   {

   }
protected:
   helperCreateDataset1() ;
   helperCreateDataset2() ;

}; 
```

使用`setUp2()`并`setUp2()`调用两个不同的辅助方法，`helperCreateDataset1()`并`helperCreateDataset2()`分别调用。在这个版本的代码中，我没有覆盖`setUp()`方法，而只是使用两个助手`setUp1()`，`setUp2()`我必须在测试用例中显式调用它们。

有两个 setUp() 初始化的合适方法是什么？遗产？模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T12:50:56.507

[此处](https://code.google.com/p/googletest/wiki/V1_6_Primer#Basic_Concepts)的`gtest`文档暗示了此响应：一个夹具用于多个测试用例的一个测试环境。共享相同夹具的所有测试用例具有相同的 . 如果需要多个设置（例如，测试一个类的测试用例的两种设置），则应使用多个夹具（例如，两个夹具，以及引用第一个或第二个的测试用例）。`setUp()`

简而言之，我觉得 ONE FIXTURE == ONE SETUP，并使用尽可能多的夹具来测试你的代码的一个类/一部分，就像你需要的不同设置一样。

这个答案足够公平吗？

你有什么意见 ？

# javascript - 动态计算 css translate 属性值

> ID：15430379
> 
> 赞同：1
> 
> 时间：2013-03-15T10:47:06.343
> 
> 标签：javascript, css, transform, scale

我正在尝试缩放（X）子 div 元素以适应窗口调整大小的父 div。我通过将父宽度和子宽度相除来计算缩放比例，并且效果很好。

但是对齐是不正确的。最初，我将我的子 div 边距设置为距父 div 50 px。它没有保持在规模上。

这是 HTML/css 代码

```
#wrap {
    margin-left:50px;
    width:300px;
    height:300px
}
#parentDiv {
    width:500px
        height:300px;
}

    <body>
        <div id="parentDiv">
        <div id="wrap">           
            <img id="image" width="300px" src="http://placekitten.com/640/480" />
        </div>
        </div>      
    </body> 
```

这是调整大小的js代码

```
 window.onresize = function() {
    scaleDiv();
  };

scaleDiv = function() {
    parentWidth = $('#parentDiv').width();
    scale = (parentWidth) / $('#wrap').width();
    new_width = $('#wrap').width() *     scale;
    $('#wrap').css('-webkit-transform', ' scaleX(' + scale + ')');
} 
```

经过一番谷歌搜索，我开始知道我可以使用`translateX`属性来保持原始对齐。但我对如何计算翻译值感到震惊。

```
 $('#wrap').css('-webkit-transform', 'translateX(20%)' + ' scaleX(' + scale + ')'); 
```

我在翻译道具上放了 20% 的随机值，它不合适。有人可以帮助我如何计算这个价值属性。

这是[jsfiddle 测试链接](http://jsfiddle.net/4r8WZ/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T11:34:19.913

您需要指定变换原点；默认情况下，这设置为 50% 和 0%，但您可以使用如下`transform-origin`属性覆盖它：

```
#wrap {
    -webkit-transform-origin:0 0;
    -moz-transform-origin:0 0;
    -ms-transform-origin:0 0;
    transform-origin:0 0;
} 
```

# ruby-on-rails - 三列有序列表

> ID：15430380
> 
> 赞同：2
> 
> 时间：2013-03-15T10:47:07.623
> 
> 标签：ruby-on-rails, ruby, arrays

我有一个类别列表，我想在按名称排序的 3 列中显示。我正在使用`ul`和`li`使用 css

```
li {
  float: left;
  width: 33%;
} 
```

所以我可以遍历每个类别。这工作正常，除了一个问题，订购。我想要按字母顺序但按列排序的列表。为了演示，如果我有 7 个类别，A 到 G，它目前看起来像

```
A  |  B  |  C
D  |  E  |  F
G  | 
```

我希望它看起来像

```
A  |  D  |  G  
B  |  E  |
C  |  F  | 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:50:38.680

有两种方法可以解决这个问题。两者都涉及将您的列表分为 3 个组，可以使用这些组来实现，`in_groups_of`但您需要传递应该属于该组的元素数量

```
@categories = ('A'..'G').to_a

total_per_column = (@categories.size / 3.0).ceil
@categories = @categories.in_groups_of(3, false) 
```

您需要通过`false`，这样它就不会尝试填充缺失的元素，即最后一组将仅包含“G”

接下来是两个选项：

1.  使用`ul`向左浮动的3

    ```
    <% @categories.each do |categories| %>
      <ul>
       <% categories.each do |category| %>
         <li><%= category %></li>
       <% end %>
      </ul>
    <% end %> 
    ```

2.  或使用如下的某种逻辑

    ```
    <ul>
      <% total_per_column.times do |index| %>
        <% @categories.each do |categories| %>
          <% if category = categories[index] %>
            <li><%= category %></li>
          <% end %>
        <% end %>
      <% end %>
    </ul> 
    ```

我个人更喜欢第一个，因为它更简单。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:12:14.113

```
xs = %w(a b c d e f g)
xs.in_groups(3).transpose
#=> [["a", "d", "g"], ["b", "e", nil], ["c", "f", nil]] 
```

现在行元素放置得很好，绘制表格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:53:25.563

```
@array = [A..Z]  
$i = 0
$j = 0 
    while $i < $array.count  do
     <ul>
       while $j < 3
      <li>
        puts @array[$i]
      </li>
        $j +=1
       end
       $i +=1
     </ul>
    end 
```

使用嵌套 while 循环的概念。

# php - PHP 正则表达式将捕获组变量与数字结合起来

> ID：15430382
> 
> 赞同：2
> 
> 时间：2013-03-15T10:47:09.400
> 
> 标签：php, regex, variables, capturing-group

例如，我想替换： `margin:0px;`这`margin:0;`
是我想出的正则表达式：`$data = preg_replace('/([^\d])0px/', '$1 0', $data);`

`$1`在本例中将代表`:`。

现在我如何`$1`与一个数字组合而不用 php 将其解释为另一个捕获组变量并且不使用我上面所做的空格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:00:49.260

你想做这样的事情吗？

```
<?php

function replace_px($val, $new_val, $str) {
  return $new_str = str_replace($val . "px", $new_val, $str);
}

$str = "margin:0px;";
echo replace_px(0, 0, $str);

?> 
```

// 输出

```
margin:0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T10:53:05.330

您可以使用`'${1}0'`. 有关更多信息，请参阅[有关字符串的 PHP 文档](http://php.net/manual/en/language.types.string.php)。

该[`preg_replace`文档](http://php.net/manual/en/function.preg-replace.php)也讨论了这一点。

顺便说一句，您可以改用这个正则表达式（在 5.2.4 及更高版本中）：

```
$data = preg_replace('/\D0\Kpx/', '', $data); 
```

`\D`匹配任何不是数字的东西，相当于`[^\d]`.

`\K`要求匹配它之前的所有内容，但将其排除在匹配本身之外。因此，您不必存储模式的第一部分并将其包含在替换中。

[这是关于转义序列的文档](http://www.php.net/manual/en/regexp.reference.escape.php)。

# java - 如何以编程方式更改 SVG 文本？

> ID：15430386
> 
> 赞同：0
> 
> 时间：2013-03-15T10:47:13.023
> 
> 标签：java, java-me, svg

看起来没有类似于 JavaScript 的

```
svgDocument.createTextNode("my text content"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:53:07.517

SVG 只是一种 XML，因此您可以使用任何一种 XML APIS 来操作它（也许从 DOM 开始）

# php - 我的 Facebook 应用程序中缺少 Open Graph 下的“故事”菜单选项

> ID：15430390
> 
> 赞同：2
> 
> 时间：2013-03-15T10:47:20.270
> 
> 标签：php, facebook-graph-api

我想在我的 facebook 应用程序上创建自定义故事，我正在阅读下面的教程。

[https://developers.facebook.com/docs/opengraph/creating-custom-stories/](https://developers.facebook.com/docs/opengraph/creating-custom-stories/)

但在我的 facebook 应用程序中，Open Graph 下没有“Stories”选项。请看这张图片：

[http://www.screencast.com/t/eHGL9Mn65](http://www.screencast.com/t/eHGL9Mn65)

如何在我的 Facebook 应用程序中使用“故事”选项

# c++ - 重构后的 EXC_BAD_ACCESS 问题

> ID：15430393
> 
> 赞同：0
> 
> 时间：2013-03-15T10:47:36.547
> 
> 标签：c++, marmalade

以下代码在 Marmalade 模拟器中工作（我在 OSX 上使用 x-code）

```
bool PictureDictionary::OnTableSelect(CTable* table, int tab){
    //if something is selected, look up the item, and display it
    //also change the search to the selected item
    if(-1 < tab){

        // if a term is selected, set the search text field to the term
        CString term = m_SearchResults.GetString(tab);

        if(m_currentWord != (char*)term.Get()){
            m_currentWord = (char *)term.Get();
            m_searchTextField->SetAttribute("text", term);

            char* normalizedTerm = (char *)term.Get();
            char* imagePath;
            sprintf(imagePath,"images/%s.jpg", normalizedTerm);

            if(m_ImageAttached){
                m_Image->SetAttribute("image", (const char*)imagePath);
            } else {
                m_Image = CreateImage(CAttributes()
                                      .Set("name",    "picture")
                                      .Set("x1",      "0")
                                      .Set("x2", "0")
                                      .Set("y1",      "50%")
                                      .Set("image", (const char*)imagePath)
                                      );
                m_SearchView->AddChild(m_Image);
                m_ImageAttached = true;
            }
        }
    }
    return true;
} 
```

当我运行模拟器并从表中选择一个项目时，图像会出现，并且当我选择不同的项目时会发生变化。当我去重构时，我得到一个 EXC_BAD_ACCESS (code=1…..) 错误

```
bool PictureDictionary::OnTableSelect(CTable* table, int tab){
    //if something is selected, look up the item, and display it
    //also change the search to the selected item
    if(-1 < tab){

        // if a term is selected, set the search text field to the term
        CString term = m_SearchResults.GetString(tab);

        if(m_currentWord != (char*)term.Get()){
            m_currentWord = (char *)term.Get();
            m_searchTextField->SetAttribute("text", term);        

            char* normalizedTerm = (char *)term.Get();
            char* imagePath;
            sprintf(imagePath,"images/%s.jpg", normalizedTerm);

            UpdatePictureView(imagePath);
        }
    }
    return true;
}

void PictureDictionary::UpdatePictureView(char* imagePath){
    if(m_ImageAttached){
        m_Image->SetAttribute("image", (const char*)imagePath);
    } else {
        m_Image = CreateImage(CAttributes()
                              .Set("name",    "picture")
                              .Set("x1",      "0")
                              .Set("x2", "0")
                              .Set("y1",      "50%")
                              .Set("image", (const char*)imagePath)
                              );
        m_SearchView->AddChild(m_Image);
        m_ImageAttached = true;
    }
} 
```

关于如何在不出现这些问题的情况下清理代码的任何建议？

**编辑关于未初始化变量的 RE 评论**： m_ImageAttached 在构造函数中被初始化为 false，除非我做错了什么。此外，更改条件以检查 m_Image!=NULL 是否也会引发相同的错误。

主.cpp：

```
PictureDictionary pictDict(myApp, &dictionary); 
```

图片字典的构造函数：

```
PictureDictionary::PictureDictionary(CAppPtr app,Dictionary::Dictionary* dictionary){
    m_App = app;
    m_Dictionary = dictionary;
    m_currentWord = "";
    m_ImageAttached = false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T16:38:44.667

`imagePath`是一个统一的指针，在两个片段中。任何取消引用的尝试都是未定义的行为。它似乎在第一个片段中*起作用。*使用数组或填充 a`std::string`代替：

```
std::string imagePath(std::string("images/") + normalizedTerm + ".jpg"); 
```

如果`std::string::c_str()`需要访问底层`const char*`，则使用。

# linux - 如果第一行包含一些文本，如何删除一行中的三行？(AWK)

> ID：15430398
> 
> 赞同：1
> 
> 时间：2013-03-15T10:47:56.863
> 
> 标签：linux, awk, row

我有一个这样的txt文件：

```
# RIR1
ABABABABABABABABAA
ABABABABABABABABBA
# WR
ABABABABABABABABAB
BABABBABABABABABAA
# BR2
ABABABABABABABBABA
ABBABABABABABABABA
# SL
AAABABABABABABBABA
AAABBABABABABABABA 
```

我想删除所有用于 SL 和 WR 的数据（例如）。所以我将只有：

```
# RIR1
ABABABABABABABABAA
ABABABABABABABABBA
# BR2
ABABABABABABABBABA
ABBABABABABABABABA 
```

我知道如何删除一行开始或包含某些内容，但不知道如何处理一行中的 3 行。

这是我用来删除包含某些内容的行的方法：

```
awk ' $2 !~ /SL/ && $2 !~ /WR/ ' test.txt > test_new.txt 
```

我想知道是否有办法将所有三行一起删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:56:34.460

使用打印标志的纯`awk`解决方案（受[**dogbane**](https://stackoverflow.com/users/7412/dogbane)启发）：

```
$ awk '/^#/{p=1}/^# (SL|WR)/,/^#/{p=0}p' file
# RIR1
ABABABABABABABABAA
ABABABABABABABABBA
# BR2
ABABABABABABABBABA
ABBABABABABABABABA 
```

解释：

`/^#/ {p=1}`如果该行以`#`设置打印标志`p`开始`1`

`/^# (SL|WR)/,/^#/{p=0}`如果该行在开始范围内`# SL`或`# WR`直到下一行开始`#`，则将打印标志设置为`0`

`p`如果打印标志不为零，则运行默认块，`{print}`否则`0`不打印任何内容。

顺序在这里很重要，首先打印标志在每个新记录处打开，并且仅对记录和`SL`关闭`WR`。

* * *

使用`record seperators`：

您可以通过设置变量来重新定义 a`record`的含义。默认情况下，每条记录由换行符分隔，但对于您的示例 with 可以用作记录分隔符，并且仅打印第一个字段不是或的记录：`awk``RS``#``WR``SL`

```
$ awk '$1 != "SL" && $1 != "WR"' RS=# ORS=# file
# RIR1
ABABABABABABABABAA
ABABABABABABABABBA
# BR2
ABABABABABABABBABA
ABBABABABABABABABA
# 
```

这种方法的一个小问题是最后一个记录分隔符。一个简单的解决方法是将管道传输到`sed '$d'`：

```
$ awk '$1 != "SL" && $1 != "WR"' RS=# ORS=# file | sed '$d'
# RIR1
ABABABABABABABABAA
ABABABABABABABABBA
# BR2
ABABABABABABABBABA
ABBABABABABABABABA 
```

注意：变量`ORS`是我们需要设置的输出记录分隔符，以便`#`在输出中显示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T11:22:47.417

使用`sed`：

要删除`# WR`：

```
sed -e '/^# WR/,/^#/ {/^# WR/d;/^#/!d}' file 
```

要同时删除`# WR`和`# SL`块：

```
$ sed -e '/^# WR/,/^#/ {/^# WR/d;/^#/!d}' -e '/^# SL/,/^#/ {/^# SL/d;/^#/!d}' file

# RIR1
ABABABABABABABABAA
ABABABABABABABABBA
# BR2
ABABABABABABABBABA
ABBABABABABABABABA 
```

或者，按照 sudo_O 的建议：

```
sed -r '/^# (WR|SL)/,/^#/ {/^# (WR|SL)/d;/^#/!d}' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:00:10.130

预处理文件：

```
awk '/#/{print x}1' file | awk '$2!="SL" && $2 !="WR"' RS= 
```

# c# - 如何在保持水平对齐的同时在文本块上使用 ScaleX 和 RenderTransform？

> ID：15430399
> 
> 赞同：0
> 
> 时间：2013-03-15T10:48:00.377
> 
> 标签：c#, wpf, xaml

我正在尝试创建一个弹出窗口，该弹出窗口基于用户输入的某些数据将生成将打印出来的某些内容的预览。

其中一个选项是将文本拉伸到其通常宽度的两倍，因此我使用了文本块的 ScaleTransform 选项。这行得通，但是我在对齐方面遇到了一些问题，当我将水平对齐设置为左时，拉伸的文本会显示一半的文本被截断。居中对齐基本没问题，但文本不是完全居中。

有什么方法可以让这个文本在保持对齐的同时拉伸？

```
<ListBox.ItemTemplate>
  <DataTemplate>
      <TextBlock Text="{Binding CouponLine}" 
                 FontWeight="{Binding FontWeight}"
                 HorizontalAlignment="{Binding Alignment}"
                 FontSize="{Binding FontSize}"
                 RenderTransformOrigin="0.5,0.5">
             <TextBlock.RenderTransform>
                     <ScaleTransform ScaleX="{Binding ScaleX}" ScaleY="1" CenterX=".5"/>
              </TextBlock.RenderTransform>
       </TextBlock>
   </DataTemplate>
</ListBox.ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:58:59.377

尝试 TextAlignment="Center" 而不是 Horizo​​ntalAlignment

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:57:40.623

RenderTransform 似乎忽略了包含它的元素的边界，而使用 LayoutTransform 会将转换后的文本保持在其父元素的边界内。

```
<TextBlock.LayoutTransform>
   <ScaleTransform ScaleX="{Binding ScaleX}" ScaleY="1" CenterX=".5"/>
</TextBlock.LayoutTransform> 
```

# android - 使用内容提供者查询获取特定号码的所有对话短信

> ID：15430404
> 
> 赞同：0
> 
> 时间：2013-03-15T10:48:21.383
> 
> 标签：android, sms, android-contentprovider

我正在创建一个显示所有收件箱短信的应用程序。在短信列表中，有一个按钮可以阅读该号码与我的所有对话。

它是通过获取意图对象并将该对象与像此函数这样的记录地址查询进行比较来完成的..`

```
public void readConversation() {
    try {

        StringBuilder smsBuilder = new StringBuilder();
        cur = getContentResolver().query(Uri.parse(SMS_URI_ALL), null,
                null, null, "date ASC");
        int smsEntriesCount = cur.getCount();

        Log.d("smsEntriesCount", "" + smsEntriesCount);

        if (cur.moveToFirst()) {
            do {

                data = new HashMap<String, String>();

                String smsAdress = cur.getString(
                        cur.getColumnIndexOrThrow("address")).toString();
                String smsbody = cur.getString(
                        cur.getColumnIndexOrThrow("body")).toString();
                String smsid = cur.getString(
                        cur.getColumnIndexOrThrow("_id")).toString();
                String smsdate = cur.getString(
                        cur.getColumnIndexOrThrow("date")).toString();
                String smstype = cur.getString(
                        cur.getColumnIndexOrThrow("type")).toString();
                String smsStatus = cur.getString(
                        cur.getColumnIndexOrThrow("status")).toString();
                String smsReadUnread = cur.getString(
                        cur.getColumnIndexOrThrow("read")).toString();

                String contactnamelist = getContactDisplayNameByNumber(smsAdress);

                if (smsAdress.equalsIgnoreCase(straddress.trim())) {
                    data.put("_id", smsid);
                    data.put("address", contactnamelist);
                    data.put("body", smsbody);
                    data.put("date", smsdate);
                    data.put("type", smstype);
                    data.put("status", smsStatus);
                    data.put("ReadUnread", smsReadUnread);
                    NumberList123.add(data);

                    Log.d("Conversation id", smsid);
                    Log.d("Conversation Address", smsAdress);
                    Log.d("Conversation body", smsbody);
                    Log.d("Conversation date", smsdate);
                    Log.d("Conversation type", smstype);
                    Log.d("Conversation status", smsStatus);
                    Log.d("Conversation Read(1)-Unread(0)", smsReadUnread);

                }
            } while (cur.moveToNext());

        }
        convolistnumber = new application();
        convolistnumber.setListConvo(NumberList123);

        Log.d(Tag, " Arraylist size " + NumberList123.size());
        Log.d(Tag, "Convo List" + convolistnumber.getConvoList().size());

        if (!cur.isClosed()) {
            cur.close();
            cur = null;

        } else {
            smsBuilder.append("no result!");
        } 

    } catch (SQLiteException ex) {
        ex.printStackTrace();
    }
} 
```

`

通过使用此功能，我得到了该号码的所有对话，即“straddress”来自按钮单击的主要活动，但它得到了更多时间，因为我将所有短信地址搜索到 straddress 号码，这需要很多时间......所以如果有任何解决方案我在查询中检查了那个数字，这意味着这个函数运行得很快......

我也在尝试检查光标中的地址，但结果只发送了收件人的短信，我想要所有发送和收件箱短信，这意味着对话..

提前致谢..

# ruby-on-rails - 在 Mac 上安装 Ruby on Rails 失败

> ID：15430408
> 
> 赞同：1
> 
> 时间：2013-03-15T10:48:26.843
> 
> 标签：ruby-on-rails, macos, installation, rvm

我第一次尝试在我的 Mac 上安装 Ruby on rails。

我在终端窗口上运行了以下命令 -

```
rvm install 2.0.0 
```

但我不断收到这个错误。

```
Error running './configure --prefix=/Users/tusharmathur/.rvm/rubies/ruby-2.0.0-p0 --with-opt-dir=/usr/local/opt/libyaml:/usr/local/opt/readline:/usr/local/opt/libxml2:/usr/local/opt/libxslt:/usr/local/opt/libksba:/usr/local/opt/openssl:/usr/local/opt/sqlite --disable-install-doc --without-tcl --without-tk --enable-shared',
please read /Users/tusharmathur/.rvm/log/ruby-2.0.0-p0/configure.log
There has been an error while running configure. Halting the installation. 
```

我也看到了configure.log，这是信息-

```
[2013-03-15 01:11:06] ./configure
configure: WARNING: unrecognized options: --without-tcl, --without-tk
checking build system type... i386-apple-darwin12.2.1
checking host system type... i386-apple-darwin12.2.1
checking target system type... i386-apple-darwin12.2.1
checking whether the C compiler works... no
configure: error: in `/Users/tusharmathur/.rvm/src/ruby-2.0.0-p0':
configure: error: C compiler cannot create executables
See `config.log' for more details 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T11:48:35.333

以下是一些如何为 XCode 安装命令行工具的截图（您可以从 Mac AppStore 安装 XCode）：

1.  [http://d.pr/i/YJJp](http://d.pr/i/YJJp)
2.  [http://d.pr/i/ntLu](http://d.pr/i/ntLu)
3.  [http://d.pr/i/cOFv](http://d.pr/i/cOFv)

安装命令行工具后，您的机器上将拥有一个 C/C++ 编译器。

# c# - 如何从反射中的 ParameterInfo[] 获取实际值

> ID：15430410
> 
> 赞同：2
> 
> 时间：2013-03-15T10:48:29.457
> 
> 标签：c#, .net, reflection, attributes

实际上，我几乎没有什么问题可以更容易理解我要问的问题，我必须先展示我的代码。

```
public static void Main(string[] args)
{
    CustomClass customClass = new CustomClass();
    customClass.SomeMethod("asdas", true, 30.5);

}

public class CustomClass
{
    [MyAttribute]
    public Boolean SomeMethod(String a, Boolean b, Double c)
    {
        return true;
    }
}

public class MyAttribute : Attribute
{
    public MyAttribute()
    {
        SomeIntercepter.InterceptEverything();
    }
    public void DoSomethingBeforeMethodexecutes()
    {
      ....
    }
    public void DoSomethingAfterMethodExecutes()
    {
      ....
    }
}

public class SomeIntercepter
{
    public static void InterceptEverything()
    {
        StackTrace stackTrace = new StackTrace();
        var method = stackTrace.GetFrame(2).GetMethod();
        var parameters = method.GetParameters();
        if (parameters.Length > 3)
            return;

        String cacheKey = method.Name;

        for (int i = 0; i < parameters.Length; i++)
        {
            //HOW TO GET THE PARAMETER DATA ASSIGNED
            cacheKey += "_" + parameters[i];
        }
    }
} 
```

所以我尝试做什么。我尝试在它调用的每个方法上拦截方法，并根据标记为的方法的传入数据做一些事情`[MyAttribute]`。所以我通过 StackTrace 访问该方法并尝试使用 GetParameters 获取所有传入数据。这是我的问题：1）如何对`SomeMethod`InterceptEverything() 中的所有传入数据进行对象 [] 2）如何对`MyAttribute`运行前标记的方法和`MyAttribute`运行方法`DoSomethingBeforeMethodexecutes()` 说 3）如何对 `MyAttribute`运行后说带有`MyAttribute`运行方法的标记方法`DoSomethingAfterMethodexecutes()`

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:50:26.937

您无法*通过*. `ParameterInfo`该设施不存在。

另外：属性不*执行*。除非您使用 postsharp 之类的东西，否则它们只是*information*。要让它们*执行*，您必须显式编写反射代码来执行此操作。

# c# - 查询字符串错误

> ID：15430413
> 
> 赞同：2
> 
> 时间：2013-03-15T10:48:32.943
> 
> 标签：c#, request.querystring

为什么这段代码会抛出一个`NullReferenceException`？

**例外：**

`System.NullReferenceException: Object reference not set to an instance of an object.`

**代码：**

```
if ((string.IsNullOrEmpty(Request.QueryString["Sno"].ToString())) 
   && (string.IsNullOrEmpty(Request.QueryString["Name"].ToString())))
{
    lblBookedBy.Text = "";
    lblSno.Text = "";
}
else
{
    lblBookedBy.Text = Request.QueryString["Name"].ToString();
    lblSno.Text = Request.QueryString["Sno"].ToString();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:05:12.877

我建议执行以下操作。

```
if (Request.QueryString["Sno"] == null || Request.QueryString["Name"] == null)
{
    lblBookedBy.Text = "";
    lblSno.Text = "";
}
else
{
    lblBookedBy.Text = Request.QueryString["Name"].ToString();
    lblSno.Text = Request.QueryString["Sno"].ToString();
} 
```

你很可能`NullReference`在`if`声明中得到一个。这样你肯定不会遇到这种情况，最坏的情况是如果两个变量都被实例化，但一个或多个包含一个空字符串，它会简单地设置`Text`为`empty`.

或者，如果您使用`Convert.ToString`尽可能多的其他建议，您可以通过跳过`if`语句来简化代码。

```
lblBookedBy.Text = Convert.ToString(Request.QueryString["Name"]);
lblSno.Text = Convert.ToString(Request.QueryString["Sno"]); 
```

在最坏的情况下，其中之一将是`Null`，并将导致其中一个 TextBoxes 显示结果，而另一个是空的。

此外，假设`Request.QueryString`支持它，您可以使用[TryGetValue](http://msdn.microsoft.com/en-us/library/bb347013.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:01:01.147

在空检查中删除 .ToString() ，因为当查询字符串参数不可用时，您正在尝试将空变量类型转换为字符串...。

```
if ((string.IsNullOrEmpty(Convert.ToString(Request.QueryString["Sno"]))) && (string.IsNullOrEmpty(Covert.ToString(Request.QueryString["Name"])))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T10:50:32.723

您正在尝试转换`Request.QueryString["Sno"]`为字符串，而它的值是`null`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T10:51:19.240

这很可能是因为集合查询字符串中没有键“Sno”或“Name”，这会在尝试对其调用 .ToString() 时导致异常。

在调用 .ToString() 之前检查 Request.QueryString["Sno"] 或 Request.QueryString["Name"] 是否为空

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-15T10:51:47.347

如果`Request.QueryString["Sno"]`或`Request.QueryString["Name"]`不返回任何对象而不是调用 ToString 将引发异常

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-15T10:51:37.637

使用[Convert.ToString()](http://msdn.microsoft.com/en-us/library/system.convert.tostring.aspx)而不是`.ToString()`避免空引用异常：

```
if (string.IsNullOrEmpty(Convert.ToString(Request.QueryString["Sno"])) && string.IsNullOrEmpty(Covert.ToString(Request.QueryString["Name"])))
{
    lblBookedBy.Text = "";
    lblSno.Text = "";
}
else
{
    lblBookedBy.Text =Convert.ToString(Request.QueryString["Name"]);
    lblSno.Text =Convert.ToString(Request.QueryString["Sno"]);
} 
```

# bash - 在带有符号的目录上执行 bash for 循环

> ID：15430414
> 
> 赞同：0
> 
> 时间：2013-03-15T10:48:37.077
> 
> 标签：bash, shell, for-loop

我正在尝试在包含空格、逗号和括号的文件夹上创建一个 for 循环。例如： `Italy - Rimini (Feb 09, 2013)`

首先，它会扫描父文件夹 /albums 中的子文件夹，如上例所示。然后它对那些子文件夹中的文件执行 curl 操作。如果子文件夹不包含空格、逗号或其他符号，则可以正常工作。

```
for dir in `ls /albums`;
do
    for file in /albums/$dir/*
    do
            curl http://upload.com/up.php -F uploadfile[]=@"$file" > out.txt
            php process.php 
    done
    php match.php
done 
```

但是如果有这样的符号，似乎 curl 位被卡住了 - 它找不到 $file （可能是因为 $dir 不正确）。

我可以替换子目录中的所有符号或删除它们或将文件夹重命名为 001、002，它可以完美运行。但在诉诸于此之前，我想知道是否可以使用 bash 技巧来解决它，同时保持子文件夹名称不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:58:45.303

熟悉shell的*分词概念。*然后意识到使用`ls`获取带有空格的文件列表是自找麻烦。相反，使用 shell globbing 然后引用扩展：

```
cd /albums
for dir in *; do
   for file in /albums/"$dir"/*; do
     echo  x"$dir"x"$file"x
   done
   php match.php
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:01:20.273

对于文件名中的空格问题，您必须将 IFS 更改为

```
IFS='
' 
```

它告诉 shell，只有换行符是文件分隔符。默认情况下，IFS 设置为制表符、空格和换行符。

因此，只需将其放在循环开始之前，它将适用于包含空格的文件名。

当然，在你的变量名周围加上引号。

# html - 如何嵌入或转换 PDF 以支持在具有离线支持的移动浏览器上阅读？

> ID：15430417
> 
> 赞同：2
> 
> 时间：2013-03-15T10:48:46.443
> 
> 标签：html, pdf, web-applications, mobile

在您投反对票之前，请阅读完整的帖子。这是一个合法的问题，对于女巫，我已经用谷歌搜索并找到了一些答案，但都没有得到足够的答案，因此我来到社区寻求建议。

该要求要求能够在**移动**浏览器中读取 pdf 格式的目录。还需要离线阅读文件，因此这会扼杀一些选项，例如 google pdf 查看器。

所以面对这个要求，我还没有找到嵌入 pdf 文件的简单方法，因此转换为 HTML5 或图像是我正在考虑的路线。

在 HTML5 转换方面，我找到了 Flexpaper、crocodoc、Prizm、serverPDF 等，但几乎都需要用户在线阅读文件。是否只有客户端可以读取和显示 PDF 文件？还是中间浏览器/js 友好格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-01T21:47:08.933

如果你优化这个项目，也许它会起作用

[js和html pdf查看器](https://github.com/mozilla/pdf.js/)

# tcp - 如何确定原始数据包中IP头和TCP头的起始字节

> ID：15430423
> 
> 赞同：1
> 
> 时间：2013-03-15T10:48:58.590
> 
> 标签：tcp, udp, ip, libpcap

我想使用 libpcap 来捕获数据包，但是由于以太网标头或 802.11 标头的长度可能会有所不同，IP 标头的长度也可能会有所不同，我如何确定 IP 标头和 TCP 标头的起始字节（指针），如何区分一个数据包是纯IP数据包、TCP数据包还是UDP数据包？是否有任何 API 或方法可以做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T02:08:13.973

当您使用 libpcap 时，您可以通过直接查看 pcap 文件头（对于离线捕获）`pcap_file_header.linktype`或（对于实时和离线捕获）从调用`pcap_datalink()`. 大多数时候会这样`LINKTYPE_ETHERNET`。为确保数据包是 IPv4，您可以转换为以太网标头并检查以确保 ethertype 为`ETHERTYPE_IP`（确保将其包装在`ntohs()`.然而，更高层协议并假设您正在使用`pcap_dispatch()`，您可以按照以下方式编写回调：（libnet 库对于其广泛的可移植数据包结构仍然有用）：

```
#include <libnet.h>
#include <pcap.h>

void
process_packet(u_char *user, const struct pcap_pkthdr *header, const u_char *packet)
{
    struct libnet_ipv4_hdr *ip;
    struct libnet_udp_hdr  *tcp;
    uint16_t ip_hl, udp_hl, header_cruft;

    ip     = (struct libnet_ipv4_hdr *)(packet + LIBNET_ETH_H);
    ip_hl  = ip->ip_hl << 2;

    switch (ip->ip_p)
    {
        case IPPROTO_UDP:
            udp    = (struct libnet_udp_hdr *)(packet + LIBNET_ETH_H + ip_hl);
            udp_hl = tcp->th_off << 2;
            header_cruft = LIBNET_ETH_H + ip_hl + tcp_hl;
            break;
        case IPPROTO_TCP:
            /** you get the idea */
            break;
        default:
            break;
    } 
```

# android - 如何在 achartengine 的时间序列图中标记/注释某些区域

> ID：15430424
> 
> 赞同：1
> 
> 时间：2013-03-15T10:49:01.283
> 
> 标签：android, time-series, achartengine

我想根据我得到的值在 achartengine 的时间序列图中标记一些区域。

当前情况：我正在从数据库中读取数据并在那里运行一个查询，该查询为我提供了一些数据：（float valueX、float valueY、float valueZ、长时间戳、字符串注释）。一切正常，图表绘制正确。但是我想在读取注释时以某种方式标记值。

以下是我正在尝试做的两种可能性：

[变体 1](http://s14.directupload.net/images/130315/4jfjfs6o.png)

[变体 2](http://s14.directupload.net/images/130315/o8szfprt.png)

在 achartengine 中是否可以这样做或类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T18:06:02.180

有一个类似这样的未解决问题：[http ://code.google.com/p/achartengine/issues/detail?id=177](http://code.google.com/p/achartengine/issues/detail?id=177)

但是，您可以添加一系列新数据，其中包含一些定义垂直线甚至一些条的值，以突出显示区域。

# android - 尝试使用通用图像加载器库android添加动态视图以查看翻转器时出现空指针异常

> ID：15430426
> 
> 赞同：-1
> 
> 时间：2013-03-15T10:49:05.370
> 
> 标签：android, viewflipper, universal-image-loader

我正在尝试使用动态图像视图创建一个 viewflipper，图像视图的 src 来自 sd 卡路径。我想使用通用图像加载器库加载图像。将图像绑定到图像视图时出现空指针异常。

下面是我的代码

```
 private class someTask extends AsyncTask<Void, Void, Void> {

@Override
    protected Void doInBackground(Void... params) {

        getPages();
            return null;

    }

    @Override
    protected void onPostExecute(Void result) {
        setPageLocations();
        dismissProgress();
    }
}

 private void getPages()
{

     while(mCursor.moveToNext()){
         String pageLocation = get images from database;
                gallery_grid_Images[i] = pageLocation;

         i++;
     }
}

private void setPageLocations(){

    for (int i=0;i<gallery_grid_Images.length;i++){
        /* Bitmap bitmap = BitmapFactory.decodeFile(gallery_grid_Images[i]);
          BitmapDrawable bd = new BitmapDrawable(bitmap);
            ImageView imageView = new ImageView(getApplicationContext());
           imageView.setImageDrawable(bd);*/
   imageLoader.displayImage(gallery_grid_Images[i], imageView,options);

          viewFlipper.addView(imageView);
    }
} 
```

任何帮助将不胜感激。指向使用通用图像加载器的 viewflipper 示例的链接也将有所帮助。

谢谢。

PS：它适用于注释代码。但由于有很多图像，我不想遇到内存不足错误。

下面是堆栈跟踪

```
03-17 02:37:16.852: E/AndroidRuntime(476): FATAL EXCEPTION: main
03-17 02:37:16.852: E/AndroidRuntime(476): java.lang.NullPointerException
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.nostra13.universalimageloader.core.ImageLoader.getImageSizeScaleTo(ImageLoader.java:453)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.nostra13.universalimageloader.core.ImageLoader.displayImage(ImageLoader.java:214)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.nostra13.universalimageloader.core.ImageLoader.displayImage(ImageLoader.java:153)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.sofi.magz.networkusage.MagzineReader.setPageLocations(MagzineReader.java:177)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.sofi.magz.networkusage.MagzineReader.access$1(MagzineReader.java:167)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.sofi.magz.networkusage.MagzineReader$SetMagzineReaderTask.onPostExecute(MagzineReader.java:119)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.sofi.magz.networkusage.MagzineReader$SetMagzineReaderTask.onPostExecute(MagzineReader.java:1)
03-17 02:37:16.852: E/AndroidRuntime(476):  at android.os.AsyncTask.finish(AsyncTask.java:417)
03-17 02:37:16.852: E/AndroidRuntime(476):  at android.os.AsyncTask.access$300(AsyncTask.java:127)
03-17 02:37:16.852: E/AndroidRuntime(476):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
03-17 02:37:16.852: E/AndroidRuntime(476):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-17 02:37:16.852: E/AndroidRuntime(476):  at android.os.Looper.loop(Looper.java:130)
03-17 02:37:16.852: E/AndroidRuntime(476):  at android.app.ActivityThread.main(ActivityThread.java:3683)
03-17 02:37:16.852: E/AndroidRuntime(476):  at java.lang.reflect.Method.invokeNative(Native Method)
03-17 02:37:16.852: E/AndroidRuntime(476):  at java.lang.reflect.Method.invoke(Method.java:507)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-17 02:37:16.852: E/AndroidRuntime(476):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-17 02:37:16.852: E/AndroidRuntime(476):  at dalvik.system.NativeStart.main(Native Method) 
```

在 167 调用 setpagelocation。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T21:25:24.717

我通过在调用通用图像加载器的 displayImage 之前添加视图解决了上述错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T08:41:47.787

设置它的LayoutParams，</p>

...

imageView.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));

imageLoader.displayImage(gallery_grid_Images[i], imageView,options); viewFlipper.addView(imageView);

...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-18T08:09:28.393

在调用通用图像加载器的 displayImage 之前添加视图

# database - 如何在sqlplus中打开已经创建的数据库

> ID：15430428
> 
> 赞同：1
> 
> 时间：2013-03-15T10:49:18.043
> 
> 标签：database, oracle, sqlplus

在 SQL*plus 中，我无法打开已在我的计算机中创建的数据库....

它显示“数据库尚未打开”的错误，我想知道在什么命令中适合打开数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T10:39:03.270

我假设您遇到错误，例如`ORA-01219: database not open: queries allowed on fixed tables/views only`. 在这种情况下，解决方法是连接为`SYS`并执行`ALTER DATABASE OPEN`：

```
C:\Users\Luke>sqlplus / as sysdba

SQL*Plus: Release 11.2.0.2.0 Production on Sun Mar 17 10:31:40 2013

Copyright (c) 1982, 2010, Oracle.  All rights reserved.

Connected to:
Oracle Database 11g Express Edition Release 11.2.0.2.0 - Production

SQL> select count(*) from user_tables;
select count(*) from user_tables
                     *
ERROR at line 1:
ORA-01219: database not open: queries allowed on fixed tables/views only

SQL> alter database open;

Database altered.

SQL> select count(*) from user_tables;

  COUNT(*)
----------
       935 
```

如果`ORA-01507: database not mounted`运行时出现错误，请先`ALTER DATABASE OPEN`运行。`ALTER DATABASE MOUNT``ALTER DATABASE OPEN`

数据库未打开和/或未安装可能是有原因的。也许它无法打开？在这种情况下，`ALTER DATABASE OPEN`很可能会导致 以外的错误`ORA-01507`。如果是这样，[https:](https://dba.stackexchange.com/) //dba.stackexchange.com/ 上的人们应该能够为您提供帮助。

# ruby - Ruby on rails 嵌入游戏

> ID：15430429
> 
> 赞同：1
> 
> 时间：2013-03-15T10:49:19.947
> 
> 标签：ruby, ruby-on-rails-3, html, iframe, embed

我正在使用 rails 3.2.12 版本。我想在我的静态网页 (game.html.erb) 中嵌入 HTML5 游戏。我对 iframe 标记的 src 会是什么感到困惑？

我在用

```
<pre> 
iframe src="index.html" height="460" width="500"
</pre> 
```

在 **game.html.erb**页面中

但发生错误

```
NO ROUTE MATCHES GET "/static_pages/index.html" 
```

我已将游戏文件**index.html放在与****game.html.erb**相同的文件夹中。

什么是问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T15:24:56.810

If the html is static then just move the html file into the '/public' folder of your rails app and change the src for the iframe to be "/index.html"

If you don't want to put it into the public folder, you'll need to either add an action to the controller that your game.html.erb is rendered from or create a separate controller for the static html.

Based on what your question states though, I would put it into the public folder as it is just static html and wouldn't require a controller.

The problem with the setup you have is that your index.html file is just a static file, where the view folder that contains game.html.erb relates to a controller and is rendered from an action in the controller. Static files don't get rendered from that folder. The public folder contains static files and folders that you want on the root of your site (except for javascript, images and css which go in the asset pipeline).

# android - setItemChecked() 不工作

> ID：15430434
> 
> 赞同：1
> 
> 时间：2013-03-15T10:49:39.427
> 
> 标签：android

```
 String[] mListContent={"Sunday", "Monday", "Tuesday", "Wedneday", "Thursday", "Friday", "Saturday"};
  setListAdapter( new AlarmDaysAdapter(this, android.R.layout.simple_list_item_checked, mListContent));
  ListView listView = getListView();
  listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);      
  for(ii=0; ii<values.size(); ii++)
  {
      listView.setItemChecked(values.get(ii),true);
      Log.i(" values: " + values.get(ii)," ");
  } 
```

我想在显示`Listview`. Log.i 打印出完美的值，`values.get(ii)`即默认情况下我想要检查的位置。我怎样才能实现它？

# vim - 如何用 vim-rails 覆盖 gf

> ID：15430440
> 
> 赞同：2
> 
> 时间：2013-03-15T10:49:49.357
> 
> 标签：vim

我编写了一个 Vimscript 函数 - `CoffeeScriptIncludeExpr`- 当分配给 时`includeexpr`，允许我`gf`在光标位于类名上时打开 CoffeeScript 文件。

但是，这在 Rails 项目中不起作用。我的 vimrc 包含以下内容

```
autocmd User Rails.javascript.coffee* set includeexpr=CoffeeScriptIncludeExpr()
autocmd User Rails.javascript.coffee* set path=app/assets/javascripts/** 
```

我曾希望会产生预期的效果。

如果我`gf`在光标上键入 CoffeeScript 文件`FooBar`，vim 会打印一条错误消息，说明`Can't find file 'foo_bar.rb' in path`. 令人费解的是，输入`set includexpr?`显示它已设置为`CoffeeScriptIncludeExpr`. 同样对于`set path?`。但是错误消息表明 vim-rails 正在运行该节目。

我需要做什么才能`gf`使用我的 CoffeeScript 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:46:12.647

看起来*vim-rails*覆盖了`gf`命令；找出来`:verbose nmap gf`。

要撤消此操作，请使用以下命令删除映射：

```
:autocmd User Rails.javascript.coffee* nunmap <buffer> gf 
```

# django - Django 确实分配但不存储主键值

> ID：15430444
> 
> 赞同：0
> 
> 时间：2013-03-15T10:50:03.923
> 
> 标签：django, model, sqlite

我有一个简单的 django 模型

```
class Directory(models.Model):

  id = models.AutoField(primary_key=True)
  path = models.TextField(unique=True)

  def __unicode__(self):
    return self.path

  class Meta:
    db_table = u'directories' 
```

但是，将 Directory 实例保存到数据库中似乎存在一些问题

```
>>> from cygapp.models import Directory
>>> d = Directory()
>>> d.path = '/usr'
>>> d.id
>>> d.save()
>>> d.id
4
>>> d
<Directory: /usr> 
```

虽然正确分配了 ID 字段（下一个自由值），但它没有存储在数据库中

```
sqlite> select * from directories;
1|/bin
2|/system/lib
3|/system/bin
|/usr 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:04:40.873

您为保存记录所做的一切都是正确的，并且应该分配一个自动 ID。

删除您的自定义 id 字段`id = models.AutoField(primary_key=True)`，因为 Django 会自动为您执行此操作。然后删除您的“目录”表并运行`python manage.py syncdb`. 这将确保您的模型上有正确的 id 字段。

# ios - 在 Ipad 上绘图

> ID：15430445
> 
> 赞同：0
> 
> 时间：2013-03-15T10:50:13.230
> 
> 标签：ios, drawing

实际上，我们正在开发一个应用程序，它显示服务器的远程桌面，它从 Ipad 接收鼠标点并执行注释/绘图。同样的绘图也在 Ipad 上进行，这样用户就可以毫无延迟地获得适当的绘图体验。但是 Ipad 中的图纸与服务器上的图纸不同步。tkanzakic 我们使用相同的逻辑来检索接触点。这在我们执行慢速注释时效果很好，但是当执行注释的速度增加时，所有的接触点都没有被捕获，因此无法显示平滑的注释

我们正在开发 monotouch 中的应用程序。

# sql - 查找两组记录之间的差异

> ID：15430451
> 
> 赞同：5
> 
> 时间：2013-03-15T10:50:25.093
> 
> 标签：sql

我在 sql server 上有一组数据，例如：

```
ID ID_Invoice Article Quantity Status
1  10         carrot  10       null
2  10         carrot  5        C
3  10         onion   8        null
4  10         onion   4        C
5  11         tomato  20       null
6  11         tomato  18       C
7  11         onion   2        null
8  11         onion   1        C 
```

这意味着客户订购了 10 个胡萝卜和 8 个洋葱（在一张发票上），但实际上只收到了 5 个胡萝卜和 4 个洋葱。如果 status 为 null 则为原始数量，如果 status 为 C 则为更正数量

我需要生成一个像

```
ID ID_Invoice Article Quantity 
1  10         carrot  -5       
2  10         onion   -4
3  11         tomato  -2
4  11         onion   -1 
```

它显示了每张发票上的订购数量和实际数量之间的差异。我不知道如何开始。任何帮助深表感谢:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T11:05:54.307

带有简单[CASE](http://msdn.microsoft.com/en-us/library/ms181765.aspx)表达式的选项，没有过多的 JOIN

```
SELECT ID_Invoice, Article, 
       SUM(CASE WHEN Status IS NULL 
  THEN -1 * Quantity ELSE Quantity END) AS Quantity
FROM dbo.test38
GROUP BY ID_Invoice, Article 
```

结果：

```
ID_Invoice Article Quantity 
10  carrot  -5
10  onion   -4
11  onion   -1
11  tomato  -2 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/a538f/1)上的演示[](http://sqlfiddle.com/#!3/a538f/1)

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T10:57:39.793

您没有指定您使用的是哪个 RDBMS，但我的回答是符合 ANSI-SQL 标准的 :) 适用于所有有效的 RDBMS。

```
SELECT
yt1.ID_Invoice, 
yt1.Article,
yt2.Quantity - yt1.Quantity AS Quantity
FROM
yourTable yt1
INNER JOIN yourTable yt2 ON yt1.ID_Invoice = yt2.ID_Invoice 
                            AND yt1.Article = yt2.Article 
                            AND yt2.Status = 'C'
WHERE
yt1.Status IS NULL 
```

这个答案是假设，**总是**有一条状态为 NULL 的记录和相应的状态为“C”的行。如果不是这种情况，您必须像这样调整它：

```
SELECT
yt1.ID_Invoice, 
yt1.Article,
CASE WHEN yt2.Quantity IS NULL THEN yt1.Quantity ELSE yt2.Quantity - yt1.Quantity END AS Quantity
FROM
yourTable yt1
LEFT JOIN yourTable yt2 ON yt1.ID_Invoice = yt2.ID_Invoice 
                            AND yt1.Article = yt2.Article 
                            AND yt2.Status = 'C'
WHERE
yt1.Status IS NULL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T11:02:40.240

最少的资源密集型：

```
SELECT id_invoice
, article
, org_quantity
, new_quantity
, new_quantity - org_quantity diff
FROM (SELECT id_invoice
      , article
      , max(CASE WHEN status IS NULL THEN quantity else null END) org_quantity
      , max(CASE WHEN status = 'C' THEN quantity else null END) new_quantity
      FROM   orders
      GROUP BY id_invoice
      , article) 
```

看到它在这里工作：[http ://sqlfiddle.com/#!4/f96adf/14](http://sqlfiddle.com/#!4/f96adf/14)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T10:56:14.637

因此，首先您必须通过进行 2 个查询将实际订单与订单分开，然后您必须将订单与实际订单分开.. 像这样

```
select 
   Recived.ID, 
   Recived.ID_Invoice,
   Recived.Article,
   Recived.Quantity - Ordered.Quantity as Quantity
from
   (select * from dataTable where Status is null) as Ordered
   left join (select * from  dataTable where Status = 'C')  as Recived on (Ordered.ID_Invoice = Recived.ID_Invoice and Ordered.Article = Recived.Article ) 
```

笔记！如果每篇文章都有一个 id 用于“左连接”而不是比较 varchars，你会更好。

**这是一个小提琴示例：** [http ://sqlfiddle.com/#!2/16666/1](http://sqlfiddle.com/#!2/16666/1)**

# jquery - jquery ui自动完成输入元素需要在鼠标悬停并聚焦时显示所有值

> ID：15430454
> 
> 赞同：-5
> 
> 时间：2013-03-15T10:50:32.990
> 
> 标签：jquery

演示： http: [//jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/) 我在我的站点中实现了上述功能，客户要求是，当鼠标悬停并专注于输入元素时，输入元素将显示所有值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:15:34.107

您必须设置`minLength: 0`自动完成的初始化，然后`focus`在调用`search`自动​​完成插件的输入字段上创建一个侦听器:)。

魔术代码:)

```
$("#tags").autocomplete({
    source: availableTags,
    minLength: 0
});

$("#tags").focus(function() {
    $("#tags").autocomplete( "search", "" ); 
}); 
```

您可以将`focus`侦听器更改为您想要的任何事件（并且 jQuery 支持）。[查看JQuery API](http://api.jquery.com/category/events/)的事件部分。search 方法的第二个参数指定搜索字符串。如果它为空，自动完成会显示整个列表。[JQuery UI Autocomplete API](http://api.jqueryui.com/autocomplete/#method-search)也完美地记录了这一点。

我用一个例子创建了一个[JSFiddle](http://jsfiddle.net/7dQXS/)。

# php - ldap 使用 ldap_search 获取 objectguid (php ldap)

> ID：15430456
> 
> 赞同：0
> 
> 时间：2013-03-15T10:50:41.890
> 
> 标签：php, ldap, guid

我有一个应用程序搜索我们的 ldap 并将一些属性保存在缓存中。获取邮件显示名称 sn 等属性没有问题，但我没有得到 objectguid。也许它只是一个显示错误过程，对象 id 是 oktett 或二进制格式。但是我不知道我是否只能显示 objectguid 或者 ldap 是否没有给我 objectguid。

我的代码是

```
 $filter="(&(!(pager=))(!(pager=NO_MA)))";
  $justthese = array("ou", "sn", "givenname", "mail", "pager","objectGUID");            
  $sr=ldap_search($ad, $basedn, $filter, $justthese);            
  $info = ldap_get_entries($ad, $sr); 
```

我尝试了不同的过滤器，如果没有这些过滤器，我在 $myarray[$number][objectguid][0] 中总是得到相同的值。它始终为 NULL。在我得到输出但使用 ldap_first_entry 后尝试了几次。但我想像所有其他价值一样获得价值！我已经尝试使用 bin2hex() 和 unpack("H*hex,$guid") <- 尝试了不同的方法来转换 guid，但我得到了相同的值（NULL）。顺便说一句，我像这样构建我的数组：

```
 for ($i=0; $i<count($info); $i++) 
  {
      $myarray['ldap'][$i]["name"]      = utf8_decode($info[$i]["givenname"][0]);
      $myarray['ldap'][$i]["sname"]             = utf8_decode($info[$i]["sn"][0]);
      $myarray['ldap'][$i]["mail"]           = $info[$i]["mail"][0];
      $myarray['ldap'][$i]["pnr"]            = $info[$i]["pager"][0];

      $myarray['ldap'][$i]["guid"]           = $info[$i]["objectGUID"][0];
   } 
```

有人想解决我的问题吗？或者知道将完整广告（带有过滤器和 OBJECTGUID）读入数组的更好方法？

谢谢你，如果你回答...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-21T10:24:04.093

尝试这个

`$myarray['ldap'][$i]["guid"] = mssql_guid_string($info[$i]["objectGUID"][0]);`

更多信息在[http://www.php.net/manual/en/function.mssql-guid-string.php](http://www.php.net/manual/en/function.mssql-guid-string.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-23T10:37:17.503

ObjectGUID 必须为小写，如“objectguid”

```
$objectguid = bin2hex($entries['objectguid'][0]);
echo "Object Guid: ". $objectguid; 
```

结果：

```
Object Guid: 362b6d25af3c9a42a23235e2c6c5e380 
```

# ruby-on-rails-3 - 如果线程安全，Rails 3.2.11 资产预编译将失败！启用

> ID：15430457
> 
> 赞同：1
> 
> 时间：2013-03-15T10:50:52.947
> 
> 标签：ruby-on-rails-3, thread-safety, assets, eager-loading, precompile

我在 Rails 3.2.11 和 ruby​​ 1.9.3.125

如果线程安全，我的应用程序在开发和生产中运行良好！离开

使用线程安全！启用我在预编译期间遇到错误，在我的资产 assetssolutions.js.erb（这是应用程序的主 js 文件）中，我使用 Workorder 类，如下一行 if ($('#workorder_worktype').val() =='<%= 工单::REPAIR %>')

使用线程安全！在预编译时找不到该类，我进行了一些研究，我认为这可能与如果线程安全，则 Rails 关闭急切加载有关！开启

如何包含 Workorder 类以使预编译工作？

错误如下：

c:/rails3/ruby/bin/ruby.exe c:/rails3/Ruby/bin/rake assets:precompile:all RAILS_ ENV=production RAILS_GROUPS=assets rake 中止！未初始化的常量 #::Workorder (在 C:/rails3/applications/assetsolutions/app/assets/javascripts/preloaded/ass etsolution.js.erb) C:/rails3/applications/assetsolutions/app/assets/javascripts/preloaded/assetsolu tion.js.erb:763:in `evaluate_source' 任务：TOP => assets:precompile:primary（通过使用 --trace 运行任务查看完整跟踪）rake 中止！命令失败，状态为 (1)：[c:/rails3/ruby/bin/ruby.exe c:/rails3/Ruby...]

任务：TOP => assets:precompile（通过使用 --trace 运行任务查看完整跟踪）

Tnx法比奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T00:30:33.183

我刚刚在 Rails 3.2.13 应用程序上遇到了同样的问题，我通过添加`config.eager_load = true`到我的`config/environments/production.rb`文件中解决了这个问题。这也解决了我在 rake 不加载模型时遇到的急切加载问题。

# c# - 自动页码

> ID：15430458
> 
> 赞同：2
> 
> 时间：2013-03-15T10:50:58.047
> 
> 标签：c#, ms-word

我有一个程序可以打开一个word文档并用数据填充它。在页脚中有一些数据，但我也希望页脚中的页数在创建新页面后更新。我知道这可以通过域代码，但我不知道如何以 C# 的形式输入字段代码。

我想使用类似的东西：

```
Phone: 00000000 mail: somemail@mail  Page {PAGE} of {NUMPAGE}. 
```

**页脚代码**：

```
Microsoft.Office.Interop.Word.Range footer = section.Footers[Microsoft.Office.Interop.Word.WdHeaderFooterIndex.wdHeaderFooterPrimary].Range;
footer.Text = ad.contactinfo(path, gud); 
```

有没有办法将域代码放入文档中，或者有其他解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T09:16:13.030

解决了：D

```
doc.ActiveWindow.ActivePane.View.SeekView = Microsoft.Office.Interop.Word.WdSeekView.wdSeekCurrentPageFooter;
Object oMissing = System.Reflection.Missing.Value;
doc.ActiveWindow.Selection.TypeText("some text \t Page ");
Object TotalPages = Microsoft.Office.Interop.Word.WdFieldType.wdFieldNumPages;
Object CurrentPage = Microsoft.Office.Interop.Word.WdFieldType.wdFieldPage;
doc.ActiveWindow.Selection.Fields.Add(doc.ActiveWindow.Selection.Range, ref CurrentPage, ref oMissing, ref oMissing);
doc.ActiveWindow.Selection.TypeText(" of ");
doc.ActiveWindow.Selection.Fields.Add(doc.ActiveWindow.Selection.Range, ref TotalPages, ref oMissing, ref oMissing); 
```

想要少一点代码，但它可以工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:03:33.243

一种选择是在 word 中创建宏，在 C# 中您可以执行宏。在我看来，这似乎是最简单的方法，因为您可以创建任意数量的宏。当它工作时，您只需费心制作宏，而不必编辑您的代码。查看此页面以获取有关其工作原理的更多信息：[如何使用 Visual C# .NET 中的自动化创建 Excel 宏](http://support.microsoft.com/kb/303872)。虽然是Excel的文章，但原理应该是一样的。

# javascript - 在 tab 键选择自动完成单词后文本框检测 enter 键

> ID：15430460
> 
> 赞同：0
> 
> 时间：2013-03-15T10:51:02.720
> 
> 标签：javascript, asp.net, textbox, keycode, autocompleteextender

我有一个附加了 AutoCompleteExtender 的 asp:TextBox。这是我的代码

```
txtSearch.Attributes.Add("OnKeyPress", "ProcessKeyPressed()")

function ProcessKeyPressed()
  { 
    if(event.keyCode == 13)
      {
        Search()
      }
  } 
```

当用户输入一个单词并按 Enter 键时，会调用函数 Search()。但是，当用户按 Tab 键选择自动完成建议之一时，未检测到 Enter 键...我可以解决的任何想法这个？

非常感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:03:08.877

您可以添加此代码

```
if(event.keyCode == 13 && e.keyCode == 9) //9 For Tab
{
   ....
} 
```

链接：http : [//www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)

# javascript - 使用 Flatiron 的 Resourceful & Restful 进行身份验证和授权

> ID：15430463
> 
> 赞同：5
> 
> 时间：2013-03-15T10:51:07.013
> 
> 标签：javascript, node.js, flatiron.js

我想在[Flatiron](http://flatironjs.org/)堆栈中实现身份验证和授权（使用 Flatiron、Resourceful 和 Restful）。在尝试更改资源时，我想要求用户具有必要的权限。在 Restful 自述文件中，有一条[关于授权的说明](https://github.com/flatiron/restful#resource-security)：

> 有几种方法可以为访问用 restful 公开的资源方法提供安全性和授权。推荐的授权模式是使用资源丰富的 for`before` 和`after`hooks 能力。在这些钩子中，您可以添加额外的业务逻辑来限制对资源方法的访问。
> 
> 不建议**将**授权逻辑放置在路由层中，因为在理想情况下，路由器将是资源的反射接口。理论上，路由器本身的安全性应该是无关紧要的，因为资源可能有多个反射接口，它们都需要相同的业务逻辑。
> 
> **TL;博士; 为了安全和授权，你应该使用足智多谋的 `before`和`after`钩子。**

所以授权可以通过 Resourceful 的 hooking 系统来处理。

我的实际问题是每个 HTTP 请求开始时的身份验证过程。

假设我有一个资源`Post`，一个`User`和一个资源`Session`。REST API 是使用 Restful 定义的。我对这个问题的主要关注是确保用户在创建帖子时有会话。其他方法，如`save`，`update`或其他资源，如创建用户，应该类似地工作。

文件`app.js`：

```
var flatiron = require('flatiron');
var app = flatiron.app;

app.resources = require('./resources.js');

app.use(flatiron.plugins.http);
app.use(restful);
app.start(8080, function(){
  console.log('http server started on port 8080');
}); 
```

文件`resources.js`：

```
var resourceful = require('resourceful');

var resources = exports;

resources.User = resourceful.define('user', function() {
  this.restful = true;
  this.string('name');
  this.string('password');
});

resources.Session = resourceful.define('session', function() {
  // note: this is not restful
  this.use('memory');
  this.string('session_id');
});

resources.Post = resourceful.define('post', function() {
  this.restful = true;
  this.use('memory');
  this.string('title');
  this.string('content');
});

resources.Post.before('create', function authorization(post, callback) {
  // What should happen here?
  // How do I ensure, a user has a session id?

  callback();
}); 
```

还有一个[可运行的代码版本](http://runnable.com/UUvAOjW8r6IwAAuN)（感谢@generalhenry）。

所以假设一个用户试图创建一个帖子，已经被赋予了一个会话 id，这个会话 ID 是随着他通过 cookie 标头发出的每个请求而发送的。如何在 before 钩子（即`authorization`回调）中访问该 cookie？

该示例可以从 开始，`node app.js`HTTP 请求可以使用`curl`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T20:02:44.840

请记住，这些指南适用于授权过程。如果您需要使用 sessionId，您可以通过任何一种方式访问​​它：`req.sessionID`, `req.cookies["connect.sid"]`.

通过这种方式检查请求，您将确保每个用户都有有效的会话 ID。

```
app.use(flatiron.plugins.http, {
  before: [
    connect.favicon(),
    connect.cookieParser('catpsy speeds'),
    function(req, res) {
      if (req.originalUrl === undefined) {
        req.originalUrl = req.url;
      }
      res.emit('next');
    },
    connect.session({secret : 'secter'}),
    function(req, res) {
      console.log('Authenticating...');
      console.dir(req.session);
      //any other validation logic
      if (req.url !== '/login' && typeof req.session.user == 'undefined') {
        res.redirect('/login');
      } else {
        res.emit('next');
      }
    }
  ]
}); 
```

这是使用这种方法的[项目示例。](https://github.com/maiah/flatiron-auth/blob/master/app.js)

# ios - #pragma mark 未列出第一个组名

> ID：15430469
> 
> 赞同：21
> 
> 时间：2013-03-15T10:51:22.130
> 
> 标签：ios, xcode, xcode4, pragma

我`#pragma mark`用于将我的方法分组到某些类别下。但问题是`Xcode 4`我的第一类没有显示。

我的代码如下所示：

```
@interface MyClass : NSObject

#pragma mark -
#pragma mark Category 1

//Some method declaration

#pragma mark -
#pragma mark Category 2

//Some method declaration

#pragma mark -
#pragma mark Category 3

//Some method declaration
@end 
```

但是当我检查它时，`Xcode`它只显示类别 2 和类别 3。类别 1 没有列在那里，请检查图像 ![杂注问题](../Images/2f5b6c27739591b6a828978e89f22b88.png)

我的代码中是否有任何问题或者它是一个错误`XCode`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-15T10:55:18.743

是的，这是一个错误。

**但是您可以通过在您的interface .h 文件/**以及**implementation / .m 文件**中添加 {} 来覆盖此错误以满足您的要求 ：

```
@implementation AppDelegate
{}

#pragma mark -
#pragma mark Category 1

-(void)awakeFromNib{

} 
```

此外，无需使用两个#pragma，您可以将它们合并为一个：

```
#pragma mark - Category 1 
```

![在此处输入图像描述](../Images/2e2ba581ce82d801b98eb1b60875af65.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-10T19:39:34.010

另一个干净的方法：只需添加一个简单的`;`.

```
@implementation AppDelegate;

#pragma mark - Category 1 
```

# azure - Azure 上的 Quartz.net 找不到时区 ID“协调世界时”

> ID：15430472
> 
> 赞同：2
> 
> 时间：2013-03-15T10:51:39.747
> 
> 标签：azure, timezone, utc, quartz.net, azure-worker-roles

我在 Azure 工作者角色（托管在西欧地区）上使用 Quartz.Net，由于某种原因，我的调度程序无法正常工作并抛出此错误：

> 扫描下一个要触发的触发器时出错。无法获取下一个触发器：无法检索触发器：在本地计算机上找不到时区 ID“协调世界时”。

当托管在我的 azure 网站应用程序中时，具有相同配置的相同调度程序正在工作。任何的想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T15:43:13.140

实际上，我继续将**“UTC”**的键/值导出为模板，并使用满足 Quartz 的名称**“协调世界时”**对其进行编辑，但仍保留原始键。然后我只是将此命令添加到我的deployment.cmd：

```
regedit /s addtutctz.reg 
```

现在，我确信，即使我的实例被重新配置或云服务重新创建，注册表项也会自动合并。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T10:47:56.493

好的，这不是最好的解决方案，但我所做的是在 Azure 上创建新的虚拟机，远程登录到 VM，部署我的工作人员并更改 UTC 的注册表项。我基本上将密钥从“UTC”更改为“协调世界时”，这解决了我的问题。现在 Quartz.Net 运行正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T01:38:06.933

我有同样的问题。我通过在特定时区创建触发器来修复它：

```
 private static ITrigger BuildTriggerForEveryDayAtSpecifiedTime(int hour, int minutes)
    {
        var timeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById("GMT Standard Time");

        return TriggerBuilder
                        .Create()
                        .WithIdentity(string.Format("Triggers every Day at {0}:{1}", hour, minutes), "MyJobs")
                        .StartNow()
                        .WithCronSchedule(string.Format("0 {0} {1} ? * *", minutes, hour), csb => csb.InTimeZone(timeZoneInfo))
                        .Build();
    } 
```

# facebook - 分享或取消后如何重定向 Facebook 分享者？

> ID：15430475
> 
> 赞同：0
> 
> 时间：2013-03-15T10:51:44.700
> 
> 标签：facebook, facebook-graph-api, facebook-sharer

我正在使用 FB graph api 获取我的应用页面的帖子并将它们显示在 ios app webview 中。我有一个分享按钮，它使用 facebook sharer.php 分享帖子。

现在，我的问题是共享或取消后，用户被发送到 facebook 页面而不是我的网页。我尝试了应该解决此问题的 FB 对话源，但是，FB 对话源不允许共享托管在 FBCDN 服务器中的图片。

```
 <?php
   $shareurl="http://www.facebook.com/dialog/feed?app_id=".$appid."&link=".urlencode($link)."&picture=".urlencode($pictureUrl)."&name=".urlencode($name)."&caption=".urlencode($caption)."&description=".urlencode($description)."&message=".urlencode($message)."&redirect_uri=".$redirectUri; 
 ?>
   <a href="<?php echo $shareurl; ?>" title="Share this post on Facebook" target="_blank">Share</a> 
```

自动，我所有的应用程序页面照片都上传到 FBCDN( [http://photos-b.ak.fbcdn.net/hphotos-ak-ash4/444_420079768083032_1721580062_s.jpg](http://photos-b.ak.fbcdn.net/hphotos-ak-ash4/444_420079768083032_1721580062_s.jpg) ) 所以，我不能使用 FB 对话框提要。

我在 Stackoverflow 中检查了许多类似的问题，这些问题建议了对话提要。有没有办法重定向sharer.php？

# c# - 微风，需要采取的行动和 SaveChanges？

> ID：15430479
> 
> 赞同：0
> 
> 时间：2013-03-15T10:52:05.137
> 
> 标签：c#, asp.net, asp.net-web-api, breeze

我对 Breeze-package 进行了简短的了解.. 它似乎很有希望.. 但我没有得到的是.. 微风js框架（客户端）需要哪些操作才能正常工作？.. 因为在示例中，有两个操作我不确定他们在做什么..或者他们是否有一些如何配置客户端框架..

这两个操作是：元数据和 SaveChanges ..我确实了解它们的作用...但正如我所提到的..首先..它们是 Breeze-clientside-framework 运行所必需的吗？..我可以更改名称吗例如 SaveChanges？和 2:ndly .. SaveChanges 是如何工作的？.. 它只是“获取”你扔给它的任何对象/实体..然后对 server-entity-models 进行检查，如果有任何匹配，那么它保存数据？..它是否也在更新和/或创建实体？..

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T18:49:45.013

Breeze 使用服务器端**元数据**操作返回有关它将管理的对象形状的元数据。同样的元数据也可以直接在客户端定义，并且可以告诉 Breeze 不要尝试从服务器获取元数据（请参阅 DataService.hasServerMetadata）属性。默认情况下，如果没有设置，例如，如果微风还没有关于服务的元数据，那么它将在第一次“查询”该服务之前自动尝试从服务器获取元数据。微风 zip 中的 NoDb 示例显示了跳过此步骤并直接在微风客户端上提供元数据的一个很好的示例。

仅当您希望通过客户端“SaveChanges”调用将数据从微风客户端持久化回服务器时，才需要服务器端**SaveChanges操作。**上面提到的 NoDb 示例也显示了一个例子。

开箱即用，微风为实体框架支持的模型提供了元数据和 SaveChanges 的服务器端实现，但您也可以提供自己的版本。我们还在努力为其他流行的后端（Raven、Mongo 等）生成其他开箱即用的实现。

# php - 带有“where”的 Cassandra (CQL) 选择语句不起作用

> ID：15430481
> 
> 赞同：6
> 
> 时间：2013-03-15T10:52:15.463
> 
> 标签：php, cassandra, cql, phpcassa

我最近几天在使用 Cassandra。我为此使用 PHPCassa 库。

当我尝试使用以下代码时，它无法正常工作。

```
 require_once('phpcassa/connection.php');
 require_once "phpcassa/columnfamily.php";

 // Create new ConnectionPool like you normally would
 $pool = new ConnectionPool("newtest");

 // Retrieve a raw connection from the ConnectionPool
 $raw = $pool->get();

 $rows = $raw->client->execute_cql_query("SELECT * FROM User WHERE KEY='phpqa'", cassandra_Compression::NONE);

 echo "<pre>";
 print_r($rows);
 echo "<pre>";

// Return the connection to the pool so it may be used by other callers. Otherwise,
// the connection will be unavailable for use.
$pool->return_connection($raw);
unset($raw); 
```

它什么也没返回，我也尝试过以下查询

```
$rows = $raw->client->execute_cql_query("SELECT * FROM User WHERE age='32'", cassandra_Compression::NONE);
$rows = $raw->client->execute_cql_query("SELECT * FROM User WHERE name='jack'", cassandra_Compression::NONE); 
```

但是当我尝试

```
 $rows = $raw->client->execute_cql_query("SELECT * FROM User", cassandra_Compression::NONE); 
```

它给出了正确的答案，显示了所有的行。请告诉我，如何正确使用“WHERE”。

键空间详细信息

```
Strategy Class:     org.apache.cassandra.locator.SimpleStrategy
Strategy Options:   None
Replication Factor: 1

Ring

   Start Token: 6064078270600954295
   End Token: 6064078270600954295
   Endpoints: 127.0.0.1 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T11:54:02.283

在 cassandra 中，您不能像往常一样只查询“表”。您需要为可能要查询的每一列设置二级索引。

假设我们有一张桌子：

```
 key      | User |   Age 
----------+----------------
 phpqa    | Jack |   20 
```

可以直接在key上查询：

```
SELECT * FROM User WHERE key='phpqa'; 
```

但是要执行其他 WHERE 查询，您需要对希望在 WHERE 子句中可用的列有一个二级索引。

你可以做些什么来让你的查询以你想要的方式灵活：

1.  [二级索引](https://github.com/thobbs/phpcassa/issues/44)如上所述。
2.  使用复合列作为键。如果您只有 2-3 列要查询，这是一个好主意，但请仔细阅读[这篇文章](http://www.datastax.com/dev/blog/introduction-to-composite-columns-part-1)，详细介绍如何以及何时使用复合键，这里是如何在[phpcassa](http://itsallabtamil.blogspot.co.uk/2012/03/cassandra-phpcassa-composite-types.html)中实现它的链接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T12:04:28.523

添加“姓名”和“年龄”作为二级索引：

```
CREATE INDEX name_key on User( name );  
CREATE INDEX age_key on User( age ); 
```

然后你应该能够使用你的`select`陈述。

[在这里](http://www.datastax.com/docs/0.8/dml/using_cql)阅读更多。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-15T11:00:31.627

您正在使用保留字作为列名：

[http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

```
$raw->client->execute_cql_query("SELECT * FROM User WHERE KEY='phpqa'", 
cassandra_Compression::NONE) 
```

# c# - 是否有验证用户输入的最佳实践方法？

> ID：15430488
> 
> 赞同：10
> 
> 时间：2013-03-15T10:52:37.373
> 
> 标签：c#, winforms, validation, input

是否有**验证用户输入**的最佳实践方法？

**实际问题：**

用户在窗口中给出某些输入。当他完成这些输入后，他可以单击“创建”。现在，应该显示一条弹出消息，其中包含所有无效输入。如果没有无效输入，则继续。

我可以在 Form 类中轻松做到这一点。但我记得一些验证设置属性中输入的最佳实践方法。问题是如果我以这种方式验证，我已经创建了该类的实例（否则，无法设置属性；））。这不应该发生，除非输入有效，否则不能创建类的实例。

我打算创建一个 ErrorMessages 类，其中包含一个可以放置所有 errorMessages 的列表。每次给出无效输入时，都会将一条新消息添加到 errorMessages 列表中。因此，如果用户单击“创建”按钮，则会显示列表中的所有消息。这是处理事情的好方法吗？

那么有没有最佳实践方法？任何提供这种解决方案的设计模式？

**编辑：**这是学校的任务。所以有不合逻辑的要求。单击“创建”时，我必须显示所有无效输入。我想在 Form 类之外做到这一点。（因此即使没有 GUI，验证也可以工作，此时我什至还没有创建 GUI）。首先确保我的功能正常工作;)。我想保持我的代码干净、抽象和 OOP。那么我应该如何显示我的错误信息呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T10:56:22.957

> 我打算创建一个 ErrorMessages 类，其中包含一个可以放置所有 errorMessages 的列表。每次给出无效输入时，都会将一条新消息添加到 errorMessages 列表中。因此，如果用户单击“创建”按钮，则会显示列表中的所有消息。这是处理事情的好方法吗？

主观上，我认为最好提供用户输入的值无效的*即时反馈。*这样，他们可以立即返回并修复它。

我想说的是，考虑一下。你提出的方法最终会给他们一个巨大的问题列表，这不是很用户友好。此外，他们将如何记住所有这些问题以便能够一次又一次地修复它们？（提示：他们不是。）

相反，我建议使用[`ErrorProvider`该类](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)在适当的控件旁边显示任何错误。[我在这里](https://stackoverflow.com/questions/5819532/how-do-i-validate-characters-a-user-types-into-a-winforms-textbox/5819681#5819681)和[这里](https://stackoverflow.com/a/4144269/366904)的回答中更多地谈到了这种方法。

当然，您仍然需要确保在最终提交时（单击 OK/Submit 按钮）所有输入都是有效的，但这只是检查是否存在任何错误的简单案例。

> 我可以在 Form 类中轻松做到这一点。但我记得一些验证设置属性中输入的最佳实践方法。

是的，这里的想法是*封装*。Form 类应该只知道表单的东西。不应该要求知道哪种输入对所有不同的控件都有效/无效。

相反，这个验证逻辑应该放在其他地方，例如存储数据的类中。该类将公开公共属性以获取和设置数据，并且在 setter 方法内部，它将验证数据。

这意味着您的 Form 所要做的就是在您的数据类上调用一个 setter 方法。表单不需要知道如何验证数据，甚至不需要知道数据的含义，因为数据类处理所有这些。

> 这不应该发生，除非输入有效，否则不能创建类的实例。

如果确实如此，您将需要为类提供一个*构造函数*，该构造函数接受它需要的所有数据作为参数。然后构造函数的主体将验证指定的数据并在其中任何一个无效时抛出异常。该异常将阻止创建类，确保不存在包含无效数据的类的实例。

这样的类可能根本没有 setter 方法——只有 getter。

然而，这在 C# 世界中是一种不寻常的要求（尽管它在 C++ 中可能很常见）。通常，将验证代码放在 setter 中就可以了。

> 我的财产有一些私人二传手。所以它们只能在我的数据类的构造函数中设置。现在的问题是，这似乎使我的验证并不容易

为什么这会改变什么？您仍然在私有 setter 内部处理验证。如果验证失败，则抛出异常。因为构造函数不处理异常，它继续从该方法冒泡到试图实例化对象的代码。如果该代码想要处理异常（例如，向用户显示错误消息），它可以这样做。

当然，在输入无效的情况下抛出异常不一定是“最佳实践”。原因是通常应该为意外情况保留异常，并且用户搞砸并向您提供无效数据是可以预料的。然而：

1.  这是您在构造函数内部进行数据验证的唯一选项，因为构造函数不能返回值。
2.  在 UI 代码中，异常处理的成本基本上可以忽略不计，因为现代计算机处理异常的速度比用户感知屏幕变化的速度要快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T11:28:42.753

这是一个简单的要求，但有时会引起争议。这是我如何处理验证的“当前”方法。我还没有使用过这种方法，这只是一个概念。这种方法需要进一步发展

一、创建自定义验证属性

```
public class ValidationAttribute : Attribute{
  public type RuleType{get;set;}
  public string Rule{get;set;}
  public string[] RuleValue{get;set;}
} 
```

二、创建自定义错误处理程序/消息

```
public class ValidationResult{
  public bool IsSuccess{get;set;};
  public string[] ErrorMessages{get;set;};
} 
```

然后创建一个验证器

```
public class RuleValidator{
  public ValidationResult Validate(object o){
    ValidationResult result = new ValidationResult();
    List<string> validationErrors = new List<string>();
    PropertyInfo[] properties = o.GetType().GetProperties();
    foreach(PropertyInfo prop in properties){
      // validate here
      // if error occur{
        validationErrors.Add(string.Format("ErrorMessage at {0}", prop.Name));
      //}
    }

    result.ErrorMessages = validationErrors.ToArray();
  }
} 
```

要使用它，您可以这样做：

```
public class Person{
  [ValidationAttribute(typeof(string), "Required", "true")]
  public string Name{get;set;}

  [ValidationAttribute(typeof(int), "Min", "1")]
  public int Age{get;set;}
} 
```

调用验证器

```
public void ValidatePerson(Person person){
  RuleValidator validator = new RuleValidator();
  ValidationResult result = validator.Validate(person);
  // generate the error message here, use result.ErrorMessages as source
} 
```

有什么好处：

1.  您可以在任何应用程序平台（Winforms、Asp.Net、WCF 等）中使用
2.  您可以在属性级别设置规则
3.  它可以进行自动验证
4.  这种方法可以与 DependencyInjection 和自定义验证器一起使用，以分离验证逻辑

缺点：

1.  很难创建验证器
2.  如果处理不当，验证者的数量可能会变得非常大
3.  由于使用反射而导致性能不佳

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T10:54:27.607

请参阅`ErrorProvider`课程（[此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)的文档）。它提供了一组标准的可视指示器，可以附加到大多数标准 WinForms 控件上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T11:55:32.333

有几种可能的方法：

*   使用“即时”验证。

当用户输入值时，会在输入 ( `TextChanged`) 期间对其进行检查并立即进行验证。创建一个新类的实例，调用属性/方法应该接受`string`和返回什么`bool`（或在属性的情况下抛出`Exception`），on `false`- 绘制特殊错误条件（文本框旁边的红色标签，闪烁的东西，`ErrorProvider`或者你能做什么应该告诉用户“错了！”）。

我喜欢使用这个，但有点不同，通常我只检查`Type`然后尝试直接在表单中解析它。如果表单使用`string`'s 操作并且所有格式和验证都发生在类中（属性设置器），则可以抽象更多。或者您可以为表单提供附加信息（通过使用查询方法或属性），以便它可以进行即时验证，而无需实例化类或使用 setter。例如，`double factor`可以在表单（甚至控件）中标识属性以执行“double.Parse `and you can have attribute`DefaultValue `which can be used to display to the user value in the different way when it's different from default (like it is done by`PropertyGrid”）。

*   使用正常验证。

当用户完成输入时，验证（通过尝试设置值并捕获异常），如果错误 - 用户不能“离开”或“前进”，直到他按下 ESC（取消更改）或更正他的输入以通过验证。

这个我不喜欢。持有用户的想法惹恼了我（和用户 ofc）。也很难实现交叉检查（比如如果你有`Min`和`Max`值，那么用户将被推动首先增加“正确”一个，否则失效将失败）。

*   使用“ok”验证。

这只是意味着让用户输入所有内容，并且仅在他单击“确定”按钮时进行验证。

我认为结合“确定”按钮和交互式即时验证对用户来说是最好的。因为用户知道他通过输入在哪里犯了错误，但仍然可以自由浏览，并且只有在单击“确定”按钮后才会从验证中获得“耳光”（在这一步你可以简单地向他展示他犯的第一个错误，没有必要全部展示）。

错误消息可以由 setter 以老式方式提供，也可以`LastError`作为`Exception`.

# jquery - 调整具有固定大小比例的 div

> ID：15430494
> 
> 赞同：0
> 
> 时间：2013-03-15T10:52:45.147
> 
> 标签：jquery, css, html, resize

我在 jquery 中制作了一个宽度为 100% 且高度为 width*.1 的 div

[http://jsfiddle.net/2drYk/](http://jsfiddle.net/2drYk/)

```
<figure class="container">
</figure>

$('.container').height($(this).width()*.1);

* 
{
margin:0; 
padding:0; 
border:0
}

.container
{
    width:100%;
    background:black;

} 
```

如何从这里扩大点击高度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T10:57:49.430

```
$('.container').height($(this).width()*0.1);

$('.container').on('click',function(){
    $(this).animate({height: ($(this).width()*0.1 + $(this).height())});
}); 
```

在这里演示[JSFIDDLE](http://jsfiddle.net/2drYk/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:43:57.830

```
.container
{
    width:100%;
    background:black;
    transition:all 500ms;
    -webkit-transition:all 500ms;
    -o-transition:all 500ms;
}

.container.newheight{height:500px}

$('.container').on('click',function(){
   $(this).toggleClass('newheight');
}); 
```

# themes - 默认主题 ID 值列表

> ID：15430495
> 
> 赞同：1
> 
> 时间：2013-03-15T10:52:54.693
> 
> 标签：themes, xpages

我想使用主题更改一些默认参数。例如折叠/展开图像。我当然可以更改每个分类列的主题 ID，但最好将这些值设置为主题中的默认值。

我发现了一篇关于默认主题列表的帖子，但是这个链接当然已经失效了。有没有其他方法可以找出 xpage 组件的默认主题 ID？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:42:55.420

以下是核心控件的主题 ID 列表：http: [//xpageswiki.com/web/youatnotes/wiki-xpages.nsf/dx/Work_with_themes#themeID+values+for+core+controls](http://xpageswiki.com/web/youatnotes/wiki-xpages.nsf/dx/Work_with_themes#themeID+values+for+core+controls)

您可以使用以下代码片段来查找控件的主题 ID：

```
getComponent("dynamicViewPanel1").getStyleKitFamily() 
```

# java - Java：将毫秒转换为 HH:MM:SS

> ID：15430504
> 
> 赞同：5
> 
> 时间：2013-03-15T10:53:05.373
> 
> 标签：java, time

我有一个以毫秒为单位的值，我想将其转换为 HH::MM:SS.fff 这只是为了持续时间。

我知道有一种基本的方法：

```
String.format("%d min, %d sec", 
    TimeUnit.MILLISECONDS.toMinutes(millis),
    TimeUnit.MILLISECONDS.toSeconds(millis) - 
    TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS.toMinutes(millis))
); 
```

但是有没有更好的方法来做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T10:55:00.273

这个数学可以解决问题：

```
int sec  = (int)(millis/ 1000) % 60 ;
int min  = (int)((millis/ (1000*60)) % 60);
int hr   = (int)((millis/ (1000*60*60)) % 24); 
```

如果你只想要分和秒，那么：

```
int sec  = (int)(millis/ 1000) % 60 ;
int min  = (int)((millis/ (1000) / 60); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T10:59:21.980

听起来您想要`Duration`或`Period`来自[Joda Time](http://joda-time.sf.net)。例如：

```
import org.joda.time.*;

public class Test {
    public static void main(String[] args) throws Exception {
        long millis = 12345678L; // Just an example
        PeriodType minutesEtc = PeriodType.time().withHoursRemoved();
        Period period = new Period(millis, minutesEtc);
        String text = String.format("%d min, %d sec",
                                    period.getMinutes(),
                                    period.getSeconds());
        System.out.println(text);
    }
} 
```

（虽然你当然可以用手算术，但我个人会尽量保持它`Period`。）

# spring-mvc - 如何在春季处理通用异常

> ID：15430507
> 
> 赞同：0
> 
> 时间：2013-03-15T10:53:12.163
> 
> 标签：spring-mvc, exception-handling, error-handling

我正在从事一个有几个课程的春季项目。现在该项目中的代码不符合标准，因此在任何类中都没有定义 try catch 块。我的 web.xml 中有以下映射

```
<error-page>
    <exception-code>404</exception-type>
    <location>/error.do</location>
</error-page> 
```

/error.do 被映射到一个控制器，从那里它转发到一个通用的错误视图。现在，是否有可能获得我的异常的堆栈跟踪。我唯一的要求是在该错误处理程序中获取异常详细信息，例如 - 异常起源如类名、方法名和异常消息，我认为这些信息将在堆栈跟踪中可用。知道如何处理这个问题陈述吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T13:14:32.867

是的，你可以做到 Spring 提供了[@ExceptionHandler](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/bind/annotation/ExceptionHandler.html)注释。所以在你的控制器中写一个方法为：

```
@ExceptionHandler(YourException.class)
public ModelAndView handleYourException(YourException ex, HttpServletRequest request) {
    mav = new ModelAndView();
    mav.addObject("exception", exception);
    mav.setViewName("YourException Page");
    return mav;
} 
```

希望你明白我的意思。

# java - MySQL 集群 & JBOSS

> ID：15430509
> 
> 赞同：0
> 
> 时间：2013-03-15T10:53:15.197
> 
> 标签：java, mysql, database, jboss, database-cluster

我需要在两台不同的机器（即不同的 IP）上为 MySQL 集群配置 JBOSS。

db 的主动-主动配置需要 -

1.  两个数据库同时更新

2.  负载均衡

3.  故障转移处理 - 在第一个数据库发生故障的情况下切换到另一个数据库

如何配置 mysql-ds.xml 文件来实现所有这些？它会单独解决我的问题还是需要进行任何其他配置更改？

到目前为止，我已经尝试了以下但没有太大成功 -

**代码示例 1 -**

```
<local-tx-datasource>
            <jndi-name>/abc</jndi-name>
            <connection-url>jdbc:mysql:loadbalance://ip1:portno1,ip2:portno2/dbname?loadBalanceBlacklistTimeout=5000</connection-url> 
            <driver-class>com.mysql.jdbc.Driver</driver-class>
            <user-name>def</user-name>
            <password>defpassword</password>
            <exception-sorter-class-name>path to exception sorter class</exception-sorter-class-name>
    </local-tx-datasource> 
```

**代码示例 2 -**

```
<local-tx-datasource>
        <jndi-name>/abc</jndi-name>
        <connection-url>jdbc:mysql:loadbalance://ip1:portno1,ip2:portno2/dbname?loadBalanceBlacklistTimeout=5000</connection-url> 
        <url-delimiter>|</url-delimiter>
            <autoReconnect>true</autoReconnect>
            <failOverReadOnly>false</failOverReadOnly>
            <maxReconnects>0</maxReconnects>
            <initialTimeout>15</initialTimeout>
            <idle-timeout-minutes>0</idle-timeout-minutes>
            <connection-property name="readOnly">false</connection-property>
            <min-pool-size>5</min-pool-size>
            <max-pool-size>20</max-pool-size>

        <driver-class>com.mysql.jdbc.Driver</driver-class>
        <user-name>def</user-name>
        <password>defpassword</password>
        <exception-sorter-class-name>path to exception sorter class</exception-sorter-class-name>
</local-tx-datasource> 
```

还需要什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T07:36:31.483

您只能通过使用 mysql-ds.xml 数据源文件配置来实现这一点。你需要做的是跟随。

**注意：**您必须使用 mysql-connector-java-5.1.13-bin.jar 及更高版本作为数据库驱动程序。早期版本有一些错误（[http://bugs.mysql.com/bug.php?id=31053](http://bugs.mysql.com/bug.php?id=31053)）会给你带来很多问题，所以要避免它们。我正在为 mysql-ds.xml 文件提供一个片段。

```
<local-tx-datasource>
    <jndi-name>DATA_SOURCE_NAME</jndi-name>
    <connection-url>jdbc:mysql:loadbalance://IP1:port1,IP2:port2</connection-url>
    <user-name>username</user-name>
    <password>password</password>
    <driver-class>org.gjt.mm.mysql.Driver</driver-class>
    <check-valid-connection-sql>select count(*) from your_table_name</check-valid-connection-sql>
</local-tx-datasource> 
```

# c# - 更新的 MS Access DB 无法正常工作

> ID：15430517
> 
> 赞同：1
> 
> 时间：2013-03-15T10:53:41.527
> 
> 标签：c#, ms-access, textbox, listbox, updates

我创建了一个程序，该程序将数据从 ms-access 加载到列表框，并创建了一些操作，例如添加、更新和删除项目..我正确插入和删除了项目。但我不知道我应该怎么做才能使此更新正常工作，因为单击按钮时更新查询不会启动（数据库中未更新的项目），只是为了让你知道我得到了 messagebox.show在此代码下方按应有的方式工作。

```
 OleDbCommand cmd = new OleDbCommand("UPDATE Item SET ITEM = @ITEM, ITEM_DESC = @ITEM_DESC, PRICE = @PRICE, QUANTITY = @QUANTITY WHERE ID = @ID", GetConnection());
            cmd.Parameters.AddWithValue("@ID", Convert.ToInt32(txtItemID.Text));
            cmd.Parameters.AddWithValue("@ITEM", txtItemName.Text);
            cmd.Parameters.AddWithValue("@ITEM_DESC", txtItemDesc.Text);
            cmd.Parameters.AddWithValue("@PRICE", Convert.ToDouble(txtItemPrice2.Text));
            cmd.Parameters.AddWithValue("@QUANTITY", Convert.ToInt32(txtItemQuantity.Value));
            cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T10:59:03.547

您的参数顺序错误，据我所知，它们必须与查询的顺序相同。除了作为程序员的提示外，这些名称完全无关紧要，它们并没有真正意义上的使用。这意味着使用了错误的 ID 值。

```
OleDbCommand cmd = new OleDbCommand("UPDATE Item SET ITEM = @ITEM,  
          ITEM_DESC = @ITEM_DESC, PRICE = @PRICE, QUANTITY = @QUANTITY 
          WHERE ID = @ID", GetConnection());
cmd.Parameters.AddWithValue("@ITEM", txtItemName.Text);
cmd.Parameters.AddWithValue("@ITEM_DESC", txtItemDesc.Text);
cmd.Parameters.AddWithValue("@PRICE", Convert.ToDouble(txtItemPrice2.Text));
cmd.Parameters.AddWithValue("@QUANTITY", Convert.ToInt32(txtItemQuantity.Value));
cmd.Parameters.AddWithValue("@ID", Convert.ToInt32(txtItemID.Text));
cmd.ExecuteNonQuery(); 
```

# java - 使用 `apache-commons`、`guava` 或其他一些流行的库在 Java 中将 Iterator 转换为可变列表的方法

> ID：15430523
> 
> 赞同：4
> 
> 时间：2013-03-15T10:54:02.617
> 
> 标签：java, guava, apache-commons

有没有`magicMethod`这样的工作：

```
List<E> resultList = magicMethod((Iterator<E>)inputIterator); 
```

注意：`resultList`应该是可变的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T10:57:59.257

您可以使用[Lists#newArrayList(Iterator)](https://google.github.io/guava/releases/snapshot-jre/api/docs/com/google/common/collect/Lists.html#newArrayList-java.util.Iterator-)。

# visual-studio-2012 - 在解决方案资源管理器中选择项目时，Visual Studio 2012 很慢

> ID：15430528
> 
> 赞同：4
> 
> 时间：2013-03-15T10:54:12.353
> 
> 标签：visual-studio-2012

安装“Visual Studio 2012 **Update1** ”后，添加了一些新按钮，但不幸的是，解决方案资源管理器变得异常缓慢。其上的所有鼠标事件（单击、右键单击、双击、在工具栏或任何项目上）都需要 5-10 秒才能得到答案。

*卸载 update1 后速度恢复正常*（=立即）。

也许一个可能的原因是添加的新按钮之一，也许是“在代码图上显示”。不幸的是，我找不到自定义（从）解决方案资源管理器工具栏中删除按钮的方法；没有安装“在代码图上显示”扩展。我不知道如何进一步调查。

由于至少有一个人遇到了同样的问题（[这里](https://stackoverflow.com/questions/15387146/visual-studio-2012-is-slow-when-selecting-item-in-the-solution-explorer)），也许有人对如何进一步调查有解决方案或想法。

谢谢斯特凡诺

使用：Microsoft Visual Studio Ultimate 2012 版本 11.0.51106.01 更新 1

* * *

更新：
微软发布了 Visual Studio 2012 **Update 2**；
现在，安装了 Update 2，一切都恢复了“正常速度”，
所以这个问题可以被认为是关闭/过时的。:-)

# sql - 没有字符串文字的有效 Oracle 选择语句中单词“AS”的最大比率是多少？

> ID：15430530
> 
> 赞同：2
> 
> 时间：2013-03-15T10:54:18.630
> 
> 标签：sql, oracle

这个问题只是为了好玩。

```
-- Prepare scheme
CREATE USER "AS" IDENTIFIED BY 123;
ALTER USER "AS" DEFAULT TABLESPACE "USERS" QUOTA 5M ON "USERS";
CREATE TABLE "AS"."AS" ("AS" INT);

-- Now we are ready to have fun
select "AS"."AS" AS "AS" from "AS"."AS" "AS";  -- Rate = 7/9 ~ 78% 
```

你能打破这个纪录吗？不允许使用
类似的字符串文字。`'AS'`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T14:35:51.960

`REF`如果我们做类型，我们可以做很多事情：

```
SQL> create or replace type "AS" as object (id number, "As" ref "AS") ;
  2  /

Type created.

SQL> CREATE TABLE "as" OF "AS";

Table created.

SQL> select ("As")."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  2         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  3         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  4         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  5         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  6         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  7         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  8         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
  9         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 10         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 11         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 12         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 13         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 14         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 15         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 16         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 17         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 18         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 19         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 20         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 21         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 22         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 23         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 24         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 25         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 26         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 27         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 28         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"
 29         ."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As"."As" "AS"
 30      from "as" "AS";

no rows selected 
```

等等..无聊地打了这么多As。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T11:25:45.620

很难击败这样的 AS 密度，但我将使用 Cast()、公共表表达式、分区表和闪回查询来代替数量......

```
with "as" AS (
  select cast("AS"."AS" AS integer) AS "AS"
  from  "AS"."AS" partition ("AS") "AS" AS of scn 1234567)
select "as"."as"
from   "as" 
```

可能也可以在那里打一个 dblink 但不确定语法是否有效......

```
with "as" AS (
  select cast("AS"."AS" AS integer) AS "AS"
  from  "AS"."AS"@"AS" partition ("AS") "AS" AS of scn 1234567)
select "as"."as"
from   "as" 
```

# jquery - 回调函数不会等到第一个函数完成。我该如何解决/解决这个问题？

> ID：15430532
> 
> 赞同：2
> 
> 时间：2013-03-15T10:54:23.160
> 
> 标签：jquery, callback, show-hide

我有一个“幻灯片”……之类的。我正在尝试让一个 div 淡出，然后另一个 div 淡入。

问题是，可见 div 在新 div 出现之前并没有完全消失。这会导致两个 div 同时出现的尴尬闪光。

注意：我不能使用绝对定位堆叠 div，因为我希望包装器（父）div 随内容一起扩展。当我通过绝对定位将 div 从“流”中取出时，我似乎无法实现这一点。

JSfiddle：在[这里。](http://jsfiddle.net/a7mCL/1/)

这是html：

```
<a href="#" class="red">RED</a> 
<a href="#" class="blue">BLUE</a> 
<a href="#" class="green">GREEN</a> 
<a href="#" class="yellow">YELLOW</a>
<div id="red"></div>
<div id="blue"></div>
<div id="green"></div>
<div id="yellow"></div> 
```

...CSS...

```
#red, #blue, #green, #yellow{display:none; width:200px; height:200px;}
#red{background:red;}
#blue{background:blue;}
#green{background:green;}
#yellow{background:yellow;} 
```

...和 ​​JQuery。

```
$('a.red').click(function() {
  $("#blue, #green, #yellow").hide('fade', function() {
      $("#red").show('fade');
  });
});

$('a.blue').click(function() {
  $("#red, #green, #yellow").hide('fade', function() {
      $("#blue").show('fade');
  });
});

$('a.green').click(function() {
  $("#red, #blue, #yellow").hide('fade', function() {
      $("#green").show('fade');
  });
});

$('a.yellow').click(function() {
  $("#red, #blue, #green").hide('fade', function() {
      $("#yellow").show('fade');
  });
}); 
```

我一直在摆弄这个！任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T12:05:31.453

问题是它`.hide()`正在为所有匹配的元素运行，然后即使匹配的元素不可见也运行回调。通过使用该`.filter()`方法，您可以确保 `.hide()' 方法以及回调只被触发一次。这意味着代码会变得庞大，因为您需要在什么都没有显示的情况下捕捉到这种情况，但它确实工作得很好。

这方面的一个例子是

```
$('a.red').click(function () {
    var elements = $("#blue, #green, #yellow").filter(":visible");
    if (elements[0]) {
        elements.fadeOut(function () {
            $("#red").fadeIn();
        });
    } else {
        $("#red").fadeIn();
    }
}); 
```

你可以在这个[JSFiddle中看到这完全有效](http://jsfiddle.net/PeteUh/a7mCL/62/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:39:07.517

问题似乎是对于已经不可见的元素，“隐藏”动画需要零时间。依次为*序列中的每个元素*触发完整回调，而不仅仅是在动画结束时触发一次。因此，任何不可见元素的动画都会立即完成并立即触发完成回调。为了解决这个问题，我调整了元素的 jQuery 选择器，以便只有实际可见的元素才能获得动画效果：

```
 $('a.red').click(function () {
       toggleVisibility("#blue, #green, #yellow", "#red");
   });

   function toggleVisibility(elementsToHide, elementsToShow) {
       var elements = $(elementsToHide).filter(':visible');
       if (elements.length) {
           // Hide visible elements first if there are any
           elements.fadeOut(function () {
               $(elementsToShow).fadeIn();
           });
       } else {
           // ...otherwise just show specified element directly
           $(elementsToShow).fadeIn();
       }
   } 
```

所以现在回调只触发一次。

干杯，亚历克斯

编辑：如果所有元素最初都是不可见的，则不起作用；我相应地更改了代码。此外，新的片段更干燥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:07:20.743

一种可能的解决方案是使用将新 div 的出现延迟一小段时间，让其他动画首先完成。

```
.delay() 
```

[http://api.jquery.com/delay/](http://api.jquery.com/delay/)

例如：

```
$('a.red').click(function () {
   $("#blue, #green, #yellow").hide('fade', function () {

       $("#red").delay(500).show('fade');
   });
}); 
```

举了一个简单的例子，大部分时间都很好用，但每隔一段时间它们就会同时显示一段时间。只需要调整:) [http://jsfiddle.net/a7mCL/15/](http://jsfiddle.net/a7mCL/15/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T10:59:19.957

使用`.stop()`它将停止在 DOM 上制作动画。

> 描述：停止匹配元素上当前正在运行的动画。

`[**`STOP`**](http://api.jquery.com/stop/)`

# r - 如何从文本文件计算移动平均值？

> ID：15430535
> 
> 赞同：0
> 
> 时间：2013-03-15T10:54:26.780
> 
> 标签：r, dataframe, zoo, lapply, moving-average

我有一个文本文件。我想做一些如下所示的计算（移动平均）并写出结果。该文本文件包含 15 列和 601 行。

```
columns <- paste0("X", 1:13)
ref <- read.table("D:\\DAS_asc.txt", sep="",header=TRUE)
library(zoo)
mean <- lapply(columns, function(column) { 
              rollapply(ref[[column]], 5, FUN = mean,na.rm=TRUE, fill=NA) }) 
```

当我刚刚输入“mean”查看结果时，我发现计算不正确（我手动进行了检查！）。我认为这可能是 moveave 函数本身，但我检查并运行良好：

```
s=c(1,5,2,4)
rollapply(s, 2, FUN = mean,na.rm=TRUE, fill=NA)
[1] 3.0 3.5 3.0  NA
rollapply(s, 3, FUN = mean,na.rm=TRUE, fill=NA)
[1]       NA 2.666667 3.666667       NA 
```

我想知道当我们对文本文件执行此操作时出了什么问题？

文件的前两行：

```
"0" "1" "2" "3" "4" "5" "6" "7" "8" "9" "10" "11" "12" "13" "14"
"2" 0.0493461075417879 0.0262911450465596 0.0426611743228151 0.0954854469641096 0.0933782886825547 0.218212200747129 0.285405481705908 0.226218243796976 0.146648210899044 0.115716572518044 0.0675501818197432 0.069120070466305 0.281314574594234 0.364434947521643 0.0124844383491671 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:11:56.653

如果您想要列的移动平均值，我看不出您的代码有问题。如果您的意思是跨 13 列的行的移动平均值，请`apply`改为在您的 ref data.frame 上使用...

```
movAvg <- t( apply( ref[,columns] , 1 , fun = function(x){ rollapply(x , width = 5, FUN = mean, na.rm=TRUE, fill=NA) } ) ) 
```

您应该返回一个数组，其中的每一列是指定列的每一行 ref 的移动平均值。我用来`t()`将其转回行。

# 差异的虚拟示例

```
w <- 1:5
x <- 1:5
y <- 1:5
z <- 1:5
df <- data.frame( w ,x , y , z )
df
#     w x y z
#   1 1 1 1 1
#   2 2 2 2 2
#   3 3 3 3 3
#   4 4 4 4 4
#   5 5 5 5 5

cols <- c( "w" , "x" , "y" , "z" )
# Rolling average across columns using list of specified columns
laply( cols , function(x){  rollapply( df[[x]] , FUN = mean , width = 2 , na.rm=TRUE, fill=NA ) })
#          1   2   3   4  5
#   [1,] 1.5 2.5 3.5 4.5 NA
#   [2,] 1.5 2.5 3.5 4.5 NA
#   [3,] 1.5 2.5 3.5 4.5 NA
#   [4,] 1.5 2.5 3.5 4.5 NA 

# Which is the same as...
t( apply( df[ , cols] , 2, function(x){ rollapply( x , width = 2, FUN = mean, na.rm=TRUE, fill=NA) } ) )
#     [,1] [,2] [,3] [,4] [,5]
#   w  1.5  2.5  3.5  4.5   NA
#   x  1.5  2.5  3.5  4.5   NA
#   y  1.5  2.5  3.5  4.5   NA
#   z  1.5  2.5  3.5  4.5   NA

# Rolling average across rows...
t( apply( df[,cols] , 1 , FUN = function(x){ rollapply( x , FUN = mean , width = 2 , na.rm=TRUE, fill=NA  ) } ) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:12:04.033

尝试这个：

```
columns <- paste0("X", 1:13)
ref <- read.table("D:\\DAS_asc.txt", sep="",header=TRUE)
library(zoo)

movingaverages<-lapply( ref[,columns], function(column) { 
    rollapply(column, 5, FUN =  mean,na.rm=TRUE, fill=NA) } )

#OR
movingaverages<-apply( ref[,columns], 2, function(column) { 
    rollapply(column, 5, FUN =  mean,na.rm=TRUE, fill=NA) } )

# substract from old values:
ref[,columns]<-ref[,columns]-movingaverages

# note, movingaverages is not a data.frame
# you can convert it to such like this:

data.frame(movingaverages) 
```

编辑：OP 想从旧值中减去结果。

# python - python：打开文件的情况

> ID：15430536
> 
> 赞同：0
> 
> 时间：2013-03-15T10:54:27.403
> 
> 标签：python

代码 ：

```
f = open('workfile', 'r')   Line #1
if f != None :              Line #2
     print f.read()         Line #3 
```

目录中不存在工作文件，因此可以理解 python 创建一个。（尽管在 python 文档中他们没有提到它）。好的

但是当我使用相同的代码将文件名从“工作文件”更改为“名称”时

```
 f = open('names', 'r')   Line #1 
```

**它显示 IOError : No such file or directory。**

为什么不创建另一个“名称”文件？就像在“工作文件”的情况下一样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:55:48.797

您正在尝试使用`r`参数打开文件进行读取。

要让 python 尝试创建文件，您需要指定写入命令`w`，例如：

```
 f = open('names', 'w') 
```

或者，如果要附加到已创建的文件，请使用以下`a`命令：

```
 f = open('names', 'a') 
```

或读写（将创建一个文件）：

```
 f = open('names', 'r+') 
```

如果您有疑问，[python 文档](http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)也非常适合阅读。

# c - 在不同的机器上运行 UDP 客户端和服务器

> ID：15430540
> 
> 赞同：1
> 
> 时间：2013-03-15T10:54:31.927
> 
> 标签：c, sockets, networking, udp

在同一台计算机上运行时，我有一个 UDP 客户端和一个运行良好的服务器。（这里对于客户端，我已将**127.0.0.1**作为 UDP 客户端上的目标 IP）。

但是，当在不同的机器上运行并用我的 server.c 所在机器的 ip 替换**127.0.0.1**时，程序不起作用。问题是我没有收到任何错误消息。

下面是服务器和客户端的代码。请告诉我要执行的任何修改以在不同的机器上运行相同的内容（我使用的是 LINUX 操作系统）。

注意：我的机器**serverIP**（存在 server.c 的机器）：**10.60.5.945**， **clientIP：10.60.5.950**

服务器.c：

```
#include<sys/types.h>
#include<sys/socket.h>
#include<netinet/in.h>
#include<sys/stat.h>
#include<unistd.h>
#include<stdlib.h>
#include<stdio.h>
#include<fcntl.h>
int main()
{
    int cont,create_socket,new_socket,addrlen,fd;
    int bufsize = 1024; 
    int nameLen=0;
    int client_address_size=0;
    char *buffer = malloc(10);
    char fname[256];
    struct sockaddr_in address,client;

    if ((create_socket = socket(AF_INET,SOCK_DGRAM,0)) > 0)
    printf("The socket was created\n");

    address.sin_family = AF_INET;
    address.sin_addr.s_addr = INADDR_ANY;

    address.sin_port = htons(15000);

    if (bind(create_socket,(struct sockaddr *)&address,sizeof(address))== 0)
        printf("Binding Socket\n");

    nameLen=sizeof(address);

    if (getsockname(create_socket,(struct sockaddr *)&address,&nameLen)<0)
    {
        printf("\n\ngetsockname() error\n");
        exit(3);
    }

    printf("Port assigned is %d\n", ntohs(address.sin_port));

    client_address_size=sizeof(client);

    if(recvfrom(create_socket,fname, 255,0,(struct sockaddr *) &client,&client_address_size)<0)
    {
        printf("\n\nrecvfrom() failed\n");
        exit(4);
    }

    printf("A request for filename %s Received..\n", fname);

    if ((fd=open(fname, O_RDONLY))<0)
    {
        perror("File Open Failed");
        exit(0);
    }

    while((cont=read(fd, buffer, 10))>0) 
    {
        sleep(1);
        sendto(create_socket,buffer,cont,0,(struct sockaddr *) &client,client_address_size);
        printf("\n\nPacket sent\n");
    }

    sendto(create_socket,"*",1,0,(struct sockaddr *) &client,client_address_size);

    printf("Request Completed\n");
    return close(create_socket);
} 
```

客户端.c：

```
#include<sys/socket.h>
#include<sys/types.h>
#include<netinet/in.h>
#include<unistd.h>
#include<stdlib.h>
#include<stdio.h>

int main()
{
    int create_socket,cont,res;
    char *arg="127.0.0.1";

    int bufsize = 1024;
    int server_address_size=0;
    char *buffer = malloc(10);
    char fname[256];
    struct sockaddr_in address;
    int serv_addr_size = sizeof(address);

    if ((create_socket = socket(AF_INET,SOCK_DGRAM,0)) > 0)
        printf("The Socket was created\n");

    address.sin_family = AF_INET;
    address.sin_port = htons(15000);
    address.sin_addr.s_addr=inet_addr(arg);

    if (connect(create_socket,(struct sockaddr *) &address,sizeof(address)) == 0)
        printf("The connection was accepted with the server %s...\n",arg);

    printf("Enter The Filename to Request : ");
    scanf("%s",fname);
    res=sendto(create_socket, fname, sizeof(fname), 0,(struct sockaddr *) &address,sizeof(address));
    if(res<0)
    {
        printf("\n\nSendto falied...\n");
        exit(0);
    }
    printf("Request Accepted... Receiving File...\n\n");

    server_address_size=sizeof(address);

    printf("The contents of file are...\n\n");

    while((cont=recvfrom(create_socket, buffer, 10, 0,(struct sockaddr *) &address,&serv_addr_size))>0) 
    {
        if(buffer[cont-1]=='*')
           break;
        write(1, buffer, cont);

    }

    printf("\nEOF\n");
    return close(create_socket);
} 
```

以上是在同一系统上运行时运行良好的代码。请告诉我在不同机器上运行上述代码需要做的修改。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:18:07.343

您是否尝试更改`char *arg="127.0.0.1";`为服务器 IP 地址？您的问题中提到的 IP 地址`10.60.5.945`不是有效的 IP。

更好的是从 argv[1] 获取 IP（甚至是您解析的主机名）。

附言。您可以通过键入以下命令查看 Linux 机器的有效 IPv4 地址：*ip -4 al scope global*

# jquery - HtmlService createTemplateFromFile：如何在 JQuery 对话框上显示模板

> ID：15430543
> 
> 赞同：0
> 
> 时间：2013-03-15T10:54:42.837
> 
> 标签：jquery, google-apps-script

我解释我的问题。我有一个从命令生成 html 页面的 GoogleAppsScript

`return HtmlService.createTemplateFromFile('page_id').evaluate();`

其中 page_id 是脚本中的 HTML 页面。

在外部，我想使用 ColorBox 在 jQuery 对话框中显示结果：

```
$(document).ready(function(){
    $(".class").colorbox({iframe:true, width:"80%", height:"80%"});
}); 
```

在php页面中，我有`<a href="url" class="class">click</a>`

`url`Google Apps Script Web Application 的 depoly 的 url 在哪里。Google Apps 脚本工作正常，但使用 HtmlService 创建的 HTML 页面未在对话框中正确显示。

这是从 HtmlService 创建的页面：

```
<html>
 <body>
  <? var path = "url_to_redirect" ?>
  <p>Document created! <a href="<?= path ?>">Click to view the document</a>

 </body>
</html> 
```

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T14:28:59.497

有一个[“问题”应该解释你需要知道的一切](https://code.google.com/p/google-apps-script-issues/issues/detail?id=852)。基本上，这是一个安全问题。Google 不希望将 Apps 脚本加载到 iframe 中（除非您在 Google 协作平台上，在这种情况下，这完全没问题）。

您也可以使用[JSONP 将 Apps 脚本数据加载](https://stackoverflow.com/questions/14914955/how-to-call-google-apps-script-from-web-page/14915184#14915184)到您的站点中。

# function - 如何在 MVC 4 中从视图中调用控制器函数

> ID：15430546
> 
> 赞同：-1
> 
> 时间：2013-03-15T10:54:48.133
> 
> 标签：function, asp.net-mvc-4, controller

当用户单击菜单项时，我需要执行一个函数，以在数据库表中填充一些数据。

控制器中的功能示例：

```
 public void PopulateDatabase()
        {
            Populate();
        } 
```

如何从视图中调用此函数？

编辑：

我创建了一个 ActionResult 方法，该方法返回一个 View 以通知用户数据库已成功更新，如下所示

```
 public ActionResult PopulateDatabase()
    {
        Populate();
        return View("Populate");
    } 
```

我从视图中调用它

```
<a href="@Url.Action("PopulateDatabase", "ControllerName")" class="populate">Populate Database</a> 
```

我测试并工作。有没有更好的解决方案来实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:05:38.580

`@Url.Action`你可以在你的视图中尝试这样

```
<ul>
    <li>
         <a href="@Url.Action("PopulateDatabase","ControllerNameHere")">MenuItem</a>
    <li>
</ul> 
```

# javascript - 使用 javascript 发送 GET 信息

> ID：15430547
> 
> 赞同：1
> 
> 时间：2013-03-15T10:54:50.007
> 
> 标签：javascript, iridium

您好我正在尝试在 iRidium 移动环境（**不是**Web 浏览器）中通过 JavaScript 将 GET 信息发送到 PHP 站点。由于我的开发环境的限制，我不能使用 JQuery。

这就是我到目前为止所拥有的：

```
function AjaxRequest(url,method){
  var req = createXMLHTTPObject();
  req.onreadystatechange= function(){
        if(req.readyState != 4) return;
        if(req.status != 200) return;
        alert(req.responseText);
  }
  req.open(method,url,true);
  req.send(null);
} 
```

我得到错误：

> 脚本异常：ReferenceError: createXMLHTTPObject

我可能错过了一些图书馆，但我不知道在哪里可以找到它或替代品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-03T19:24:01.383

在 Iridium Mobile 中访问内容数据的一种可能方法是使用自己的驱动程序并配置 IP、端口、协议等。之后，您可以直接在 Javascript 应用程序中接收数据。

查看更多详细信息： [http://dev.iridiummobile.net/AV_%26_Custom_Systems/en#AV_Custom_Systems_(Client)](http://dev.iridiummobile.net/AV_%26_Custom_Systems/en#AV_Custom_Systems_(Client))

# ruby - 在 RSpec 测试期间抑制控制台输出

> ID：15430551
> 
> 赞同：51
> 
> 时间：2013-03-15T10:55:06.690
> 
> 标签：ruby, rspec

我正在测试在控制台上放置一些消息的类（带有放置、p 警告等）。我只是想知道在 RSpec 测试期间是否有任何抑制此输出的能力？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-03-15T12:48:42.687

`puts`我通过重定向`$stout`到文本文件来抑制我的类中的输出。这样，如果我出于任何原因需要查看输出，它就在那里，但它不会混淆我的测试结果。

```
#spec_helper.rb
RSpec.configure do |config|
  config.before(:all, &:silence_output)
  config.after(:all,  &:enable_output)
end

public
# Redirects stderr and stout to /dev/null.txt
def silence_output
  # Store the original stderr and stdout in order to restore them later
  @original_stderr = $stderr
  @original_stdout = $stdout

  # Redirect stderr and stdout
  $stderr = File.new(File.join(File.dirname(__FILE__), 'dev', 'null.txt'), 'w')
  $stdout = File.new(File.join(File.dirname(__FILE__), 'dev', 'null.txt'), 'w')
end

# Replace stderr and stdout so anything else is output correctly
def enable_output
  $stderr = @original_stderr
  $stdout = @original_stdout
  @original_stderr = nil
  @original_stdout = nil
end 
```

**编辑：**

针对@MyronMarston 的评论，将方法直接插入块中`before`并`after`作为块可能会更聪明。

```
#spec_helper.rb
RSpec.configure do |config|
  original_stderr = $stderr
  original_stdout = $stdout
  config.before(:all) do 
    # Redirect stderr and stdout
    $stderr = File.new(File.join(File.dirname(__FILE__), 'dev', 'null.txt'), 'w')
    $stdout = File.new(File.join(File.dirname(__FILE__), 'dev', 'null.txt'), 'w')
  end
  config.after(:all) do 
    $stderr = original_stderr
    $stdout = original_stdout
  end
end 
```

它看起来更干净一些，并且使方法远离`main`. 另外，请注意，如果您使用的是 Ruby 2.0，则可以`__dir__`使用`File.dirname(__FILE__)`.

**编辑2**

还应该提到的是，您可以`/dev/null`使用`File::NULL`Ruby v 1.9.3 中引入的方式转发到真正的操作系统。(jruby 1.7)

然后代码片段将如下所示：

```
#spec_helper.rb
RSpec.configure do |config|
  original_stderr = $stderr
  original_stdout = $stdout
  config.before(:all) do
    # Redirect stderr and stdout
    $stderr = File.open(File::NULL, "w")
    $stdout = File.open(File::NULL, "w")
  end
  config.after(:all) do
    $stderr = original_stderr
    $stdout = original_stdout
  end
end 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-03-15T11:02:09.193

尝试在前块中生成输出的存根方法，例如

```
before do
  IO.any_instance.stub(:puts) # globally
  YourClass.any_instance.stub(:puts) # or for just one class
end 
```

这是明确的，所以你不会错过任何你不想错过的东西。如果您不关心任何输出并且上述方法不起作用，您始终可以存根 IO 对象本身：

```
before do
  $stdout.stub(:write) # and/or $stderr if needed
end 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-07-31T11:13:38.773

Rspec3.0 版本将是 => 在 spec_helper.rb

```
RSpec.configure do |c|
  c.before { allow($stdout).to receive(:puts) }
end 
```

它将充当`before(:each)`

但是 :each 是默认的，所以不需要显式地写

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-04-14T22:27:05.320

**用 rspec-core (~> 3.4.0) 测试**

在描述块中你可以做

```
# spec_helper.rb
def suppress_log_output
  allow(STDOUT).to receive(:puts) # this disables puts
  logger = double('Logger').as_null_object
  allow(Logger).to receive(:new).and_return(logger)
end

# some_class_spec.rb
RSpec.describe SomeClass do
  before do
    suppress_log_output
  end
end 
```

这样，您就可以为特定测试切换日志输出。请注意，这**不会**抑制 rspec 警告或来自 rspec 的消息。

另一种禁用来自 gem 的警告的方法：

添加`config.warnings = false`到 spec_helper

如果您只想抑制某些记录器方法，就像`error, info, or warn`您可以做的那样

`allow_any_instance_of(Logger).to receive(:warn).and_return(nil)`

禁用来自 rspec gem 的警告

`allow(RSpec::Support).to receive(:warning_notifier).and_return(nil)`

但通常不鼓励这样做，因为它是为了让你知道你在测试中做了一些有味道的事情。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-04-29T12:41:30.277

如果要抑制单个测试的输出，有一种更简洁的方法：

> ```
> it "should do something with printing" do
>   silence_stream(STDOUT) do
>     foo.print.should be_true
>   end
> end 
> ```

如果您的测试打印错误，您可能需要更改`STDOUT`为。`STDERR`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-11-02T00:48:39.820

在一次性情况下更新了 Rails 5 的答案：

```
before do
  RSpec::Mocks.with_temporary_scope do
    allow(STDOUT).to receive(:puts)
  end
end 
```

如果你经常这样做，你可以把它变成 spec_helper 中的一个方法。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-08-17T17:57:38.317

在尝试了所有这些示例之后，我最终使用了这种**不会使 binding.pry 静音或静音的变体**

```
# frozen_string_literal: true

RSpec.configure do |config|
  config.before(:each) do
    allow($stdout).to receive(:puts)
    allow($stdout).to receive(:write)
  end
end 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-17T09:15:28.623

注入默认为 STDOUT 的 IO 对象会很有用。如果您愿意，这也使得在输出上断言更容易。

例如

```
def my_method(arg, io: STDOUT)
  io.puts "hello"
  arg.reverse
end 
```

然后在你的测试中：

```
# Suppress it.

my_method("hi", io: StringIO.new)

# Assert on it.

io = StringIO.new
my_method("hi", io: io)

output = io.tap(&:rewind).read
expect(output).to include("hello") 
```

# scala - Request.session.get(String) 返回 Option[String] 我如何使用它？

> ID：15430552
> 
> 赞同：0
> 
> 时间：2013-03-15T10:55:09.153
> 
> 标签：scala, pattern-matching, session-variables

我想在模式匹配中使用会话值，但由于我的 request.get("profileType") 返回 Option[String] 我不能像在我的代码中那样在模式匹配中使用它。这是我的代码片段。

```
def editorProfile = Action { implicit request =>
request.session.get("profileType").toString() match {
  case "editor" => {
      request.session.get("userEmail").map {
        userEmail => Ok(html.profile.editorProfile("my profile"))
      }.getOrElse {
        Unauthorized(html.error("Not logged in"))
      }
  }
 }
} 
```

这是错误：

```
[MatchError: Some(editor) (of class java.lang.String)] 
```

我的问题是。如何在我的模式匹配中使用 session.get 中的 Some(editor)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:59:40.777

你打电话`toString`并`Option[String]`得到`"Some(editor)"`。相反，您必须对此进行匹配：

```
request.session.get("profileType") match {
  case Some("editor") => { /* your code */}
  case _ => /* something else */ 
} 
```

请注意，我添加了 default case `_ =>`。如果没有它，您可以获得`MatchError`如果`session`不包含“profileType”属性或属性有另一个值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T12:01:39.457

您可能应该尝试使用 for 理解，因为当您添加更多类似类型的检查时，它可能会更容易扩展。

```
val email = for {
  profileType <- request.session.get("profileType") if profileType == "editor"
  userEmail <- request.session.get("userEmail")
} yield userEmail

// email is of type Option[String] now, so we do the matching accordingly

email match {
  case m: Some => Ok(html.profile.editorProfile("my profile"))
  case None => Unauthorized(html.error("Not logged in or not an editor."))
} 
```

当然，您可以以更简洁的方式编写所有内容，但作为初学者，更明确并没有什么坏处。

**添加：**

如果您想稍后使用邮件地址，您可以将其更改为：

```
email match {
  case Some(address) => Ok(html.profile.editorProfileWithEmail("my profile", address))
  case None => Unauthorized(html.error("Not logged in or not an editor."))
} 
```

# python - 安装 pymongo 时无法导入 pymongo 并且在其他一些脚本中运行良好

> ID：15430561
> 
> 赞同：0
> 
> 时间：2013-03-15T10:55:25.333
> 
> 标签：python, mongodb, pymongo

在我的 ubuntu 12.04 机器上，我有几个其他脚本（使用 pymongo）在屏幕上运行良好。但是后来我尝试运行另一个脚本或者只是在 python 控制台中导入 pymongo 我得到了这个：

```
> >>> from pymongo import Connection 
> Traceback (most recent call last):   File "<stdin>", line 1, in <module>   File
> "/usr/local/lib/python2.7/dist-packages/pymongo/__init__.py", line 60,
> in <module>
>     from pymongo.connection import Connection   File "/usr/local/lib/python2.7/dist-packages/pymongo/connection.py", line
> 39, in <module>
>     from pymongo.mongo_client import MongoClient   File "/usr/local/lib/python2.7/dist-packages/pymongo/mongo_client.py", line
> 44, in <module>
>     from bson.py3compat import b   File "/usr/local/lib/python2.7/dist-packages/bson/__init__.py", line 27, in
> <module>
>     from bson.dbref import DBRef   File "/usr/local/lib/python2.7/dist-packages/bson/dbref.py", line 17, in
> <module>
>     from copy import deepcopy   File "copy.py", line 2, in <module>
>     connection = pymongo.Connection('localhost', 27017) AttributeError: 'module' object has no attribute 'Connection'
> >>> 
```

由于未知原因，导入已安装的模块失败。

虽然已经运行的脚本继续运行良好，但我无法启动任何使用 pymongo 的新脚本。

我在这里完全迷失了，不知道该怎么做（并且无法谷歌搜索任何有用的东西）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:51:28.690

哦，原来我已经在文件夹中创建了文件 copy.py，其中包含 pymongo 使用的脚本，而不是原始的 python 库。

我整个早上都在为此苦苦挣扎，但在这里问一个问题会有所帮助。

# c - 字符串比较 C - strcmp()

> ID：15430562
> 
> 赞同：1
> 
> 时间：2013-03-15T10:55:28.457
> 
> 标签：c, string, comparison

我正在尝试比较两个字符串，但我没有做到这一点。为什么？

```
#include <stdio.h>
#include <string.h>

int main(){
    float a = 1231.23123;
    char b[32];
    sprintf(b, "%f", a);
    printf("%s\n", b);
    char c[32] = "1231.23123";
    if (strcmp(c, b) == 0){
        printf("SUCCES\n");
    }
    else{
        printf("DIFFER\n");
    }
    return 0;
} 
```

结果：

```
1231.231201
DIFFER 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T11:03:39.783

这两个字符串明显不同，因此`strcmp()`工作正常。

问题是`1231.23123`不能表示为`float`. 实际上，*可以*表示为 a的最接近的数字`float`是`1231.231201171875`，这就是您所看到的（四舍五入`sprintf()`到小数点后六位）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T11:09:42.550

如果您想在字符串中比较一组数字，请使用`sprintf`-中的精度说明符`%.5f`，正如其他人指出的那样，您选择的数字不能用 a 表示`float`，但可以用 a 表示`double`。IE

```
double a = 1231.23123;
char b[32];
sprintf(b, "%.5f",a); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-15T10:59:44.653

这是因为浮点数的精度不能支持这么多位数。所以 b 不是“1231.23123”。在我的测试中，它是“1231.231201”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-15T11:06:11.253

您在这里比较这两个字符串：

```
1231.23123
1231.231201 
```

它们确实不同，因此`strcmp`返回非零值。

这里的实际问题是，当您这样做时`float a = 1231.23123;`，您要存储的数字`a`不能表示为 a ，在这种情况下可以表示为 a的`float`最接近的数字。看看[OMG 小马！！！](https://msmvps.com/blogs/jon_skeet/archive/2009/11/02/omg-ponies-aka-humanity-epic-fail.aspx)[（又名人类：史诗般的失败）](https://msmvps.com/blogs/jon_skeet/archive/2009/11/02/omg-ponies-aka-humanity-epic-fail.aspx)；）`float``1231.231201171875`

* * *

为了解决您的问题，我将从使用`double`而不是`float`获得更精确的准确性开始。然后，您可以在将此数字打印到字符串中时指定精度 ( `%.5lf`)，以确保该数字像您需要的那样四舍五入：

```
double d = 1231.23123;
char str[32];
sprintf(str, "%.5lf", d);
// strcmp(str, "1231.23123") would return 0 here 
```

# magento - Magento - 从 ActionController 更改主题

> ID：15430567
> 
> 赞同：0
> 
> 时间：2013-03-15T10:55:51.950
> 
> 标签：magento

是否可以在 ActionController 的操作中更改完整的主题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T20:32:58.730

理论上是的，因为在控制器中调用了 Loadlayout。

如果需要，您可以使用删除块参考[以编程方式从布局中删除块](https://stackoverflow.com/questions/14275333/programatically-remove-block-from-layout)，也可以使用创建块添加块..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:25:00.487

是的，可能在布局渲染之前。

但最好通过会话 + 重定向和默认设置

`$mageRunCode`带有商店代码。 `Mage::run($mageRunCode, $mageRunType);` 在 index.php 的末尾

# android - 在 android 中翻译时平滑的图像

> ID：15430568
> 
> 赞同：1
> 
> 时间：2013-03-15T10:55:54.763
> 
> 标签：android

我正在尝试将图像从一个位置转换到另一个位置，同时用户拖动该图像，图像在移动，但移动不准确，只是在跳跃，请帮助我，因为我是 android 新手。下面是我的 XML 文件，后面是 java 代码。谢谢..

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal" >       

 <ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"        
    android:layout_marginLeft="230dp"
    android:layout_marginTop="100dp"
    android:layout_marginRight="400dp"
    android:layout_marginBottom="100dp"
    android:background="#000000"        
    android:src="@drawable/desert" />

 <ImageView
    android:id="@+id/imageView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/imageView1"
    android:layout_alignTop="@+id/imageView1"
    android:layout_alignRight="@+id/imageView1"
    android:layout_alignBottom="@+id/imageView1"            
    android:layout_margin="10dp"
    android:layout_toRightOf="@+id/imageView1"
    android:src="@drawable/logo" />

<ListView
    android:id="@android:id/list"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="800dp" >
</ListView>   

</RelativeLayout> 
```

Java 文件

```
public class Display extends ListActivity implements OnTouchListener
{
ArrayList<String> listimages;
ListView images;    
ImageView imgback,imgfront; 

@Override
protected void onCreate(Bundle savedInstanceState)
{       
    super.onCreate(savedInstanceState);
    setContentView(R.layout.display);
    images=(ListView) findViewById(android.R.id.list);
    listimages=new ArrayList<String>();
    listimages.add("/Pictures/Chrysanthemum.jpg");
    listimages.add("/Pictures/Koala.jpg");
    setListAdapter(new listAdapter(getApplicationContext(), listimages));

    imgback=(ImageView) findViewById(R.id.imageView1);
    imgfront=(ImageView) findViewById(R.id.imageView2);
    //imgback.setImageBitmap("From Camera");    

    //Matrix mat=new Matrix();

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) 
{       
    super.onListItemClick(l, v, position, id);      
Toast.makeText(getApplicationContext(), "Image:    "+String.valueOf(position)+" 

    Clicked", Toast.LENGTH_LONG).show();
    if(position==0)
    {           
    imgfront.setImageBitmap(getbitmap("/sdcard/Pictures    

             /Koala.jpg"));         
        imgfront.setOnTouchListener(this);
    }
    else if(position==1)
    {
        imgfront.setImageBitmap(getbitmap("/sdcard/Pictures

             /Chrysanthemum.jpg"));
    }
}

public Bitmap getbitmap(String path)
{
    Bitmap bitmap=BitmapFactory.decodeFile(path);       
    return bitmap;
}

@Override
public boolean onTouch(View arg0, MotionEvent arg1) 
{
    Toast.makeText(getApplicationContext(), "Touch Event Occured",   

     Toast.LENGTH_LONG).show();
    Toast.makeText(getApplicationContext(), "x value: 

    "+String.valueOf(arg1.getX())+" Y value: "+String.valueOf(arg1.getY()),  

      Toast.LENGTH_LONG).show();        

    imgfront.setTranslationX(arg1.getX());
    imgfront.setTranslationY(arg1.getY());  

    return true;
}   

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T14:38:03.780

利用

```
imgfront.setTranslationX((arg1.getRawX() - imgfront.getWidth())/2); 
imgfront.setTranslationY((arg1.getRawY() - imgfront.getHeight())/2); 
```

# android - 谷歌分析不显示任何数据

> ID：15430569
> 
> 赞同：0
> 
> 时间：2013-03-15T10:55:58.110
> 
> 标签：android, google-analytics

我正在检查一个示例 google 分析 Android 应用程序，但我的 google 分析帐户中没有显示任何数据。这是我的代码：

```
public class ClickTrackerActivity extends Activity {

  GoogleAnalyticsTracker tracker; 

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Start your statistics tracking
    tracker = GoogleAnalyticsTracker.getInstance();     
    tracker.startNewSession("UA-39298495-1", 30, this);  

    setContentView(R.layout.main);
    tracker.trackPageView("/ClickTracker-Main-Screen");  
  }

  @Override
  protected void onDestroy() {
    super.onDestroy();
    tracker.stopSession();
  }

  public void onClickHighButton(View v) {
    // High button clicked.
    Toast.makeText(ClickTrackerActivity.this, "Chose the High Road", Toast.LENGTH_SHORT).show();
    tracker.trackEvent("Clicks", "Button", "High Road", 0); 
    tracker.dispatch();
  }

  public void onClickLowButton(View v) {
    // Low button clicked.
    Toast.makeText(ClickTrackerActivity.this, "Chose the Low Road", Toast.LENGTH_SHORT).show();
    tracker.trackEvent("Clicks", "Button", "Low Road", 0); 
  }
} 
```

这可能是什么原因？显示数据需要一些时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:10:39.383

您不会看到实时更新。看看[这个](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1009219)。您会发现 google 分析，就像您的 google play 开发者控制台每天大约在同一时间更新一次一样。

# java - 如何关闭来自不同类的按钮的动作事件框架？

> ID：15430573
> 
> 赞同：0
> 
> 时间：2013-03-15T10:56:07.623
> 
> 标签：java, swing, awt, frame

我在 1 个具有组件的类上设计了一个**控制框架**`jbutton`，我对这些组件的操作事件进行了编码，差异差异框架被初始化。

每一帧都有一个类。现在，当我`jbutton`从控制框架按下第二个时，必须关闭`frame`（当我从控制框架第一次按下时它已经打开`jbutton`）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:00:19.863

只需跟踪框架实例作为主类中的实例变量。然后在单击关闭按钮时关闭该实例。

```
public void open(ActionEvent e) {
    frame = new  something.. // your frame
}

public void close(ActionEvent e) {
    frame.dispose();
} 
```

注意：JFrame 框架是全局变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:17:48.820

把它写在你的按钮点击 linsener

```
 yourFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

# javascript - 通过脚本自动登录网站

> ID：15430575
> 
> 赞同：0
> 
> 时间：2013-03-15T10:56:09.340
> 
> 标签：javascript, autologin

我有一个批处理文件，其中包含用户名和密码，可以在第 16.5 行第 16.5 个单词是用户名，第 7 个单词是密码。

**启动 VPNGUI -c -user 1000 -pwd 123456**

我需要一个关于 JavaScript 的帮助，它应该打开网站的主页，读取批处理文件以收集用户名和密码，在主页上自动填写用户名和密码并使用发送密钥登录。我尝试过使用 vbscript，下面是我的代码，但我需要在 Java 中使用它，它应该允许用户通过单击自动登录到网站。

**VBScript：-**

```
Dim username
Dim password
Const ForReading = 1

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objTextFile = objFSO.OpenTextFile("C:\Autoconnect\connect.bat", ForReading)

For i = 1 to 15
    objTextFile.ReadLine
Next

strLine = objTextFile.ReadLine
segments = Split(strLine," ")
username = segments(5)
pwd = Split(strLine," ")
password= pwd(7)

objTextFile.Close

set WshShell = WScript.CreateObject("WScript.Shell")
call WshShell.Run("https://mywebsite.com", 1, false) 'This will open your default browser

WScript.Sleep 5000
WshShell.SendKeys username 
WScript.Sleep 1000
WshShell.SendKeys "{TAB}"
WScript.Sleep 1000
WshShell.SendKeys password
WshShell.SendKeys "{TAB}"
WScript.Sleep 1000
WshShell.SendKeys "{TAB}"
WScript.Sleep 1000
WshShell.SendKeys "{ENTER}"
WScript.Quit() 
```

谁能建议我如何使用 Java Script 实现这一目标。

萨米。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:00:28.740

如果您希望在一个网站上使用 JavaScript 以便一键登录到另一个网站，那是不可能的，因为您无法跨域提交表单。

# python - 在 Python 子进程中查找返回 1

> ID：15430586
> 
> 赞同：1
> 
> 时间：2013-03-15T10:56:35.940
> 
> 标签：python, find

我需要使用以下 GNU`find`命令搜索目录的内容：

> 查找*路径*-type f -name *file1* -o -name *file2* -o -name *file3*

当我在我的 Linux shell 中执行此命令时，该`find`命令返回退出代码 0。当我在子进程调用中执行相同的命令时，该`find`命令返回退出代码 1：

```
import subprocess  
import shlex  
findcmd = "/depot/findutils/bin/find /remote/scratch/results -type f -name 'QUEUED' -o -name 'run.pid' -o -name 'PID'"
try:
    output = subprocess.check_output(shlex.split(findcmd))
except subprocess.CalledProcessError, cpe:
    print cpe.output
    raise cpe 
```

输出：

```
Traceback (most recent call last):
  File "./getaverages.py", line 63, in <module>
    raise cpe
subprocess.CalledProcessError: Command '['/depot/findutils/bin/find', '/remote/scratch/results', '-type', 'f', '-name', 'QUEUED', '-o', '-name', 'run.pid', '-o', '-name', 'PID']' returned non-zero exit status 1 
```

奇怪的是，`CalledProcessError`对象输出属性与我在 Linux shell 中运行时得到的输出完全相同`find`（返回的输出大约有 15K 行）。我也尝试设置*bufsize=-1*但这没有帮助。

有什么建议可以理解这种行为吗？

我使用的是 Python 2.7.2，`find`版本是 4.2.20。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:30:46.087

尽管您发现了问题，但对于您试图实现的如此简单的事情，我不会*shell-out*，`os.walk`而是使用：

```
import os, os.path
search = 'file1 file2 file3'.split()
for root, dirs, files in os.walk('/path'):
  for f in filter(lambda x: x in search, files):
    # do something here
    fn = os.path.join(root, f)
    print 'FOUND', fn 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:07:26.840

如果您使用[plumbum](http://plumbum.readthedocs.org/en/latest/)，任务将非常简单：

```
from plumbum.cmd import find
cmd = find['/remote/scratch/results']['-type', 'f']['-name','QUEUED']['-o']['-name', 'run.pid']['-o']['-name', 'PID']
cmd() # run it 
```

你不必担心逃跑，我猜这是你麻烦的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:14:06.083

似乎在 15K 输出的中间，我错过了以下几行：

```
/depot/findutils/bin/find: /remote/scratch/results/tmp.na.8Em5fZ: No such file or directory
/depot/findutils/bin/find: /remote/scratch/results/tmp.na.k6iHJA: No such file or directory
/depot/findutils/bin/find: /remote/scratch/results/tmp.na.ZPe2TC: No such file or directory 
```

事实证明，我正在搜索的*路径*包含模拟结果，并且会定期删除超过 3 天的文件。似乎在执行删除时发生删除`find`是问题的根本原因。

# java - 通过签名比较 SSL 证书：是否足够？

> ID：15430589
> 
> 赞同：5
> 
> 时间：2013-03-15T10:56:54.017
> 
> 标签：java, android, ssl-certificate

我正在研究的系统架构需要比较两个 SSL/TLS（通常是 X.509）证书。也就是说，我需要验证两个证书是否相同。

我不在乎它们是否过期或自签名，我只是想确保它们没有以任何方式被更改。

执行此类操作的最正确方法是什么？比较这些证书的两个签名（两个字节 []）是否就足够了，或者这个操作是否容易出现我迄今为止没有考虑过的漏洞？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:10:30.647

我认为比较这两个签名是不够的，除非您的代码直接从某个实例获取证书，以确保签名也已针对证书本身进行了*检查。*所以在很多情况下，我会说：*不*。

我相信最灵活、最正确的方法是分别检查两个证书（正文与签名）的完整性，然后直接比较证书中需要相同的所有信息。（我这样说是因为我不确定您需要*完全*身份）。

但是，如果您的目标确实是检查服务器发送的证书的真实性，那么在您的代码中拥有整个证书的副本并不一定是明智的；在这种情况下，您可以验证服务器的证书，然后根据存储在您的应用程序中的安全哈希检查其正文。

# java - 在 JAVA 中使用集合

> ID：15430590
> 
> 赞同：0
> 
> 时间：2013-03-15T10:56:58.930
> 
> 标签：java, collections

有两个班

***头等舱是***

```
 import java.io.BufferedReader;
 import java.io.File;
 import java.io.FileReader;
 import java.util.ArrayList;

 import java.util.Collections;

public class Hieracrhy  
{

    ArrayList<Tutor> Tutor_person=new ArrayList<Tutor>();
    public static void main(String[] args) 
    {
        Hieracrhy obj=new Hieracrhy();
        obj.start();
    }

    public void start()
    {
        getDetails();
        System.out.println(Tutor_person);
    }

    //Function to read the songs from the file
    void getDetails()
    {
        try 
        {
            File file=new File("SongsList.txt");//Represents a file
            FileReader fileReader=new FileReader(file);//FileReader connects to a text file
            BufferedReader reader=new BufferedReader(fileReader);//For Efficient reading of file

            // We use String variable to hold each line when the line is read one-by-one
            String line=null;

            //Read a line of the string and assign it to a string if it is not null just  doo the func
            while((line=reader.readLine())!= null)
            {
                addDetails(line);
            }
        } 
        catch (Exception e) 
        {
            e.printStackTrace();
        }
    }
    void addDetails(String lineToParse)
    {
        String[] tokens=lineToParse.split("/");
        Tutor nextPerson=new Tutor(tokens[0]);
        Tutor_person.add(nextPerson);
    }
} 
```

***现在还有另一堂课***

```
import java.util.ArrayList;

public class Tutor 

{

    int Tutor_id;
    String Tutor_name;
    String Tutor_place;
    int Tutor_age;

    public void Set_Things_for_Tutor(int Tutor_id,String Tutor_name,String Tutor_place,int Tutor_age)
    {
        this.Tutor_id=Tutor_id;
        this.Tutor_name=Tutor_name;
        this.Tutor_place=Tutor_place;
        this.Tutor_age=Tutor_age;

    }

    public int getuserid()
    {
        return Tutor_id;
    }
    public String getname()
    {
        return Tutor_name;
    }
    public String getdesignation()
    {
        return Tutor_place;
    }
    public int getage()
    {
        return Tutor_age;
    }
} 
```

现在在文本文件中有输入

```
11/devrath/hassan/22 
```

但是当我运行完整的设置时，我得到了错误

> 构造函数导师（字符串）未定义

这个错误的原因是什么.....有人可以帮我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T10:58:27.890

> 构造函数导师（字符串）未定义

错误说明了一切。您的**Tutor 类**中没有接受字符串作为参数的构造函数。

```
public Tutor {
//instance vars

public Tutor(String s){
//assign s to appropriate member variable
}

} 
```

顺便说一句，Tutor 课程的设计似乎很糟糕。你在你的构造函数中初始化你的实例成员（他们打算这样做）。您当前正在一个方法中初始化 Tutor 状态。我建议你在构造函数中初始化它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T11:02:12.623

由于您没有使用“String”参数定义任何构造函数，JVM 无法找到它。

定义构造函数如下：

```
public Tutor(String name)
{
     //Do required initialization here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T11:30:33.437

您调用的代码有一个参数构造函数，而被调用的代码（Tutor）类没有一个参数构造函数。

添加构造函数

```
public Tutor (String str)
{
     //do your initialization here about 'str' variable.
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T11:05:27.423

您的`Tutor`类没有接受 String 作为其参数的构造函数。如果你想在你的`Tutor`类中传递一个字符串，那么将它添加到你的代码中

```
public class Tutor{
  //Other member variables
  public Tutor(String yourString){
     //Do some initializations
  }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-15T11:08:29.593

当您创建一个类的实例时，将调用构造函数

```
MyClass obj = new MyClass(); 
```

this 调用默认构造函数

```
public MyClass(){} 
```

但是由于您没有创建任何参数化构造函数，因此 JVM 本身会为您创建它

但是如果你想将一些参数传递给构造函数

```
MyClass obj = new MyClass(someInteger,someString); 
```

在这种情况下，JVM 不会创建任何默认构造函数，因为您已经创建了参数化构造函数

```
public MyCLass(int someInteger,String someString){} 
```

在您的情况下，您没有创建任何构造函数，因此 JVM 仅创建默认构造函数

```
public MyClass(){} 
```

所以你所拥有的只是一个非参数化的构造函数，但你试图访问的是一个参数化的构造函数

所以你所要做的就是在你正在创建其对象的类中创建一个参数化的构造函数......

在你的情况下

```
public Tutor(String string) {
    System.out.println("add the code to initialize the class parameters here");
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-15T10:59:16.880

好吧，我认为您必须在班级中重命名`Set_Things_for_Tutor`为。并删除字符串。`Tutor``Tutor``void`

# javascript - 简单的酒店预订表格总计算

> ID：15430593
> 
> 赞同：1
> 
> 时间：2013-03-15T10:57:04.403
> 
> 标签：javascript, forms

我想知道是否有人可以帮助我...不幸的是，我没有任何 Javascript 知识并且发现它有点难以理解。

我正在处理酒店预订表格，这就是我需要做的。可以选择酒店以及需要多少晚的选项。

还有一个总计字段。这就是我卡住的地方。有人可以帮助我编写脚本或如何让 Total 字段显示酒店选择的夜晚时间公式的总数吗？

这也需要是一个值，该值将与其他值一起发布到 php 表单，该表单又向我发送包含这些值的电子邮件。

这是我制作的表格的链接：[https ://www.alpinemalta.net/libyabuild2013/bookNow.html](https://www.alpinemalta.net/libyabuild2013/bookNow.html)

感谢任何可以帮助我的人，请原谅我在这方面缺乏知识。

问候

克里斯·布朗（马耳他）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:19:44.390

看着你的表格，

1）我认为总夜数的下拉列表是多余的（总夜数从到达和离开日期就很清楚了）

2) 日期（为了在 JavaScript 中更简单地使用它）使用数值而不是：'11/05/2013(A)' 等。

```
<select name="ArrivalDate" size="1" id="ArrivalDate">
<option>Please select</option>
<option value="1368399600">13-05-2013</option>
<option value="1368486000">14-05-2013</option>
...
</select> 
```

3）我没有注意到每晚的价格？也许酒店列表也可能包含一些 ID（例如 h1a、h1b、h2a、h3a、h3b、h3c ......）而不是文本选项描述（酒店和房间）

```
<select name="hotel_choice" id="hotel5">
<option value="nothing" selected="selected">None Selected</option>
<option value='nothing'>.</option>
<option value="h1a">Corinthia Single Room</option>
<option value="h1b">Corinthia Double Room</option>
<option value='nothing'>.</option>
...
</select> 
```

如果您这样做，那么 JavaScript 可能不会那么复杂（假设您进行了这些更改并且不介意在页面源中显示每家酒店的价格）：

```
<script type='text/javascript'>
var prices={nothing:0,h1a:357,h1b:280.50,h2a:380}; //here are your hotel prices

function calculate() {
    var days = Math.round( ( 
            document.getElementById('datedepart').value - 
            document.getElementById('ArrivalDate').value 
        ) / 86400 ); //timestamp is in seconds
    document.getElementById('total_cost').value = 
        days * 
        prices[ document.getElementById('hotel5').value ];
}
</script> 
```

请注意，代码中没有任何细节，它基于这样的假设，即日期更改为它们的代表整数值（例如由 php 函数 time() 返回），也有可能我犯了一个错误在元素的 ID 名称中

然后剩下的就是连接“calculate();” javascript函数到所有控件的**onchange**事件，你就完成了。

```
<select name="hotel_choice" id="hotel5"  onchange='calculate();'>
...
</select> 
```

和

```
<select name="ArrivalDate" size="1" id="ArrivalDate" onchange='calculate();'>
...
</select> 
```

在出发日期选择器中也是如此。

编辑：

您可以在日期选择器中使用日期，但您必须使用以下方式将该字符串解析为数字客户端：

```
var dt=Date.parse(document.getElementById('ArrivalDate').value); 
```

但请务必检查此函数支持的日期格式，并注意它返回自 1970 年以来的**毫秒**数，因此您必须除以 86400000 而不是 86400

**编辑 - 检查日期已填写**

```
function calculate() {
var dd=document.getElementById('datedepart');
var da=document.getElementById('ArrivalDate');
var total=document.getElementById('total_cost');
var hotel=document.getElementById('hotel5');

//no hotel room selected or not depart date set or not arrival date set
//or departing before arrival (nonsense) - set total to ZERO and exit the function

if ( !(dd.value*1) || !(da.value*1) || da.value>dd.value ) {
    total.value='0';//you can set it to 'not allowed' also if you wish (instead of '0')
    return;
}

var days = Math.round( ( 
        dd.value - 
        da.value 
    ) / 86400 ); //timestamp is in seconds
var cost = days * prices[ hotel.value ];
if (isNaN(cost))
    cost = 0; //or set to "invalid input" - but this line should not be needed at this point
total.value = cost;
} 
```

# python - 垂直滚动在 Eclipse/PyDev 中不起作用

> ID：15430595
> 
> 赞同：10
> 
> 时间：2013-03-15T10:57:14.800
> 
> 标签：python, eclipse, pydev

我今天更新到最新版本的 PyDev（2.7.2），一切顺利，我重新启动了 Eclipse，然后 PyDev 编辑器中的垂直滚动停止工作。滚动条正在移动，但文本没有滚动。水平滚动虽然有效。这只发生在 python 文件中。当我打开文本文件或其他类型的文件（不是 .py）时，滚动效果很好。有谁知道为什么会发生这种情况以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2015-10-28T06:36:00.943

`Ubuntu 15.10`更新到（Eclipse 4.5.1 和 PyDev 4.4.0）后，滚动对我不起作用。

设置后解决：`Preferences --> PyDev --> Editor --> Overview Ruler Minimap --> Show vertical scrollbar`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-15T12:35:37.190

同样的事情发生在我身上。现在我卸载了最新版本并重新安装了 PyDev `2.7.1.2012100913`。这是在 Eclipse 上完成的。`Help->Install New Software->What is already installed?`这里你必须卸载 PyDev。然后您必须返回`Help->Install New Software`在组合框中选择 PyDev`Work with`并取消选中该`Show only the latest versions of available software`选项。现在您可以安装任何带有工作垂直滚动的旧版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-15T12:28:48.380

**更新**：已经发布了一个新版本 (2.7.3) 来解决这个问题。尝试更新到那个。

这也发生在我身上，看起来像是最新版本中的一个错误。[这是错误报告。](https://sourceforge.net/tracker/?func=detail&aid=3608122&group_id=85796&atid=577329)

我决定[恢复到以前的版本](https://stackoverflow.com/questions/3855814/how-to-revert-a-software-update-in-eclipse)，直到这个问题得到解决。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-13T13:10:13.810

您是否尝试在滚动页面时按住 CTRL ？这个对我有用 ！

我的环境是 Eclipse Mars R2 + PyDev 5.1.2 + Ubuntu 16.04 + Python 2.7

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T16:32:29.960

我今天遇到了同样的问题。看起来这已在 PyDev 版本 2.7.3.2013031601 中得到修复。尝试将您的软件更新到此版本，看看是否可行。它对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T12:48:11.487

OS X 上的同样问题，我将其添加到错误报告中；希望这很快得到解决。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-15T12:31:02.170

你在运行什么操作系统？不是一些第三方java实现导致问题吗？我遇到过 Eclipse 在 Unix 上表现奇怪的问题几次。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-16T12:38:15.937

我也遇到了同样的情况，但现在在 2.7.3 版本中，该错误似乎已得到修复。我已经更新了 PyDev，到目前为止它运行良好。在[发行说明](http://pydev.org/)中，您可以看到它说：

> 2.7.3 修复了关于滚动条的主要回归。

所以我希望这能修复这个主要错误！干杯。

# c++ - 需要帮助阅读/解析 TCP 网络代码 C++

> ID：15430598
> 
> 赞同：0
> 
> 时间：2013-03-15T10:57:25.183
> 
> 标签：c++, networking

我有一个跟踪身体运动的应用程序，它也可以像服务器一样通过 TCP 发送身体跟踪数据。我的客户端连接到服务器并获取数据。

在将数据发送到客户端之前，会发生以下情况：

```
MTBF v10 = bodyPose2MTBF_v10(pose, m_startup, m_stream_position, 1);
ss << v10.get();
m_body_tracking_server->send(ss); 
```

其中姿势包含所有信息，例如作为矢量的头部位置、腿、肩位置等。SS 是一个新的字符串流，并且使用 v10.get() 流以字符串形式填充姿势。在 send 方法中，stringstream(ss) 被发送到客户端。

在我的客户中，我得到了字符串流。我还将它转换回 mtbf。问题是，代码不是我的，所以我不明白。当姿势转换为 mtbf 时，会发生以下情况：

```
data.addFlag(0);
data << torso.x() << torso.y() << torso.z();
sensorConfig |= MTBFData_0_4::RightArmPosition;
data.addFlag(1);
.
.
. 
```

我知道它正在添加一个“标志”，以便我可以识别例如躯干，然后是躯干的 xy 和 z 坐标。但添加标志方法如下所示：

```
addFlag(unsigned char n)
{
m_flag |= (1i64 << n);
m_buf.replace(7+8, 8, reinterpret_cast<char*>(&m_flag), 8);
return *this;
} 
```

这个方法具体是做什么的？？转移一些东西并重新解释字符......我真的需要帮助来理解这一点！谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:35:30.683

addFlag 旨在在 m_flag 成员（某种 64 位整数）中累积标志。每次调用都会使用最新的 m_flag 值更新 m_buf 中的一个固定的 8 字节字段。

m_flag 能够累积多个标志，每个标志都通过对 addFlag 的单独调用添加。

请记住，m_flags 中的标志会累积，一直持续到其他成员函数清除它为止。

每个标志值都与 64 位整数值中的单个位相关联。这种程序通常在某处定义一个可能的标志值列表，或者使用一堆#define 行或作为枚举。查找 0 到 63 之间的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T12:13:34.890

如果没有看到更多代码，很难确定，但是......

`m_flag |= (1i64 << n);`... m_flag 可能是一个无符号的 64 位 int，这是将 m_flag 的第 n^位与 1 进行或运算。

`m_buf.replace(7+8, 8, reinterpret_cast<char*>(&m_flag), 8);`...现在标志已被修改，它将缓冲区中的当前标志值替换为新的标志值。

# multithreading - UI中的多线程

> ID：15430602
> 
> 赞同：0
> 
> 时间：2013-03-15T10:57:37.463
> 
> 标签：multithreading, winforms, z-order

我有一个winform，用户通过单击按钮启动一个进程，并在另一个线程上运行的另一个winform上显示正在运行的进程信息。按钮点击中的代码如下：

```
 private void btn_Click(object sender, EventArgs e)
    {
       Thread th=new Thread(ShowInfoForm);
       th.Start();
       //Code for process execution
       EditInfoForm();
       th.Join();
       this.BringToFront();           
    }

private void ShowInfoForm()
    {
        infoForm = new InfoForm();
        infoForm.showBox("Process Started", infoForm.MsgLevel.INFO,ButtonOK.DISABLED);
    }
private void EditInfoForm()
    {
        infoForm.Invoke((MethodInvoker)(() => infoForm.EditBox("Process Completed", infoForm.MsgLevel.INFO,ButtonOK.ENABLED));
    } 
```

`bringToFront`除了主线程上的调用外，一切正常。单击“确定”按钮退出信息表单后，主表单按 z 顺序返回。我该如何解决这个问题？

PS 我知道最好的做法是将 UI 保持在同一个线程中并在后台线程上运行进程，但这是大量代码，我无法对其进行编辑。

# python - 将数组转换为 json 对象

> ID：15430604
> 
> 赞同：0
> 
> 时间：2013-03-15T10:57:40.177
> 
> 标签：python

我有一个像这样的二维数组：

```
main_array -> [object,object,object,....] 

each object -> [ var_some_string,parent_id,some_random_int] -> fixed length 
```

我需要将此数组转换为这样的`json`对象..

```
{ var_some_string: { var_some_string : { var_some_string: -1}}} 
```

parent_id 是 main_array 对象位置，它是当前对象的父对象

我希望这个问题是可以理解的。

```
main_array = [ 
               ["some_string0",-1,1], 
               ["some_string1",-1,1] , 
               ["some_string2",-1,1] ,
               ["some_string3",0,-1],
               ["some_string4",0,-1],
               ["some_string5",0,-1],
               ["some_string6",1,-1],
               ["some_string7",1,-1],
               ["some_string8",2,-1],
               ["some_string9",5,-1],
               ["some_string10",7,-1],
               ["some_string11",9,-1],
             ] 
```

`json`对象是这个

```
main_json = { 
              'some_string0' : { 
                                 'some_string3' : -1000,
                                 'some_string4' : -1000,
                                 'some_string5' : {
                                           'some_string9' : {
                                                          'some_string11' : -1000
                                                             },
                                                  },
                               },
              'some_string1' : { 
                                 'some_string6' : -1000,
                                 'some_string7' : {
                                              'some_string10' : -1000,
                                                  }
                               } 
              'some_string2' : {
                                 'some_string8' : -1000
                               }
              } 
```

我正在思考如何解决这个问题......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:21:39.007

```
def replace_empty_dict_with(d, value):
    for k, v in d.iteritems():
        if len(v) == 0:
            d[k] = value
        else:
            replace_empty_dict_with(v, value)

d = {}
w = {}
for node, pid, _ in main_array:
    if pid == -1:
        w[node] = d[node] = {}
    else:
        parent = main_array[pid][0]
        w[node] = w[parent][node] = {}

replace_empty_dict_with(d, -1)
import pprint
pprint.pprint(d) 
```

输出：

```
{'some_string0': {'some_string3': -1,
                  'some_string4': -1,
                  'some_string5': {'some_string9': {'some_string11': -1}}},
 'some_string1': {'some_string6': -1, 'some_string7': {'some_string10': -1}},
 'some_string2': {'some_string8': -1}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T12:48:15.087

我对这项任务的理解有点不同。我认为 some_random_int 应该成为最终字典中的值（不一定是-1）。

```
 main_json = {}
 id_to_dict_reference = {
      -1: main_json
 }
 id_to_container = {}
 id_to_key_name = {}

 for id, (var_some_string, parent_id, some_random_int) in enumerate(main_array):
      id_to_key_name[id] = var_some_string
      dict_reference = id_to_dict_reference[parent_id]

      if dict_reference is None:
           parent_container = id_to_container[parent_id]
           key_name = id_to_key_name[parent_id]
           if not isinstance(parent_container[key_name], dict):
                parent_container[key_name] = {}
           parent_container[key_name][var_some_string] = some_random_int
           id_to_dict_reference[id] = None
           id_to_container[id] = parent_container[key_name]
           id_to_dict_reference[parent_id] = parent_container[key_name]
      else:
           dict_reference[var_some_string] = some_random_int
           id_to_container[id] = dict_reference
           id_to_dict_reference[id] = None

 print main_json 
```

输出：

```
 {'some_string0': {'some_string3': -1,
                   'some_string4': -1,
                   'some_string5': {'some_string9': {'some_string11': -1}}},
  'some_string1': {'some_string6': -1, 'some_string7': {'some_string10': -1}},
  'some_string2': {'some_string8': -1}} 
```

# xcode - 如何在 Xcode 中显示变量的内容？

> ID：15430605
> 
> 赞同：1
> 
> 时间：2013-03-15T10:57:40.487
> 
> 标签：xcode, debugging

在许多情况下，当我将鼠标移到变量上时，xCode 不会显示变量的内容。

是否有其他方式来显示内容？

例如简单的字节，字节数组，......有没有办法以某种方式指定输出格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T12:42:21.657

现在，通过 lldb 调试器改进了变量格式，您可以在其中为自己的类型指定格式。阅读有关如何指定这些的[文档](http://lldb.llvm.org/varformats.html)`~/.lldbinit`，然后将它们放入 python 脚本并添加以下行：

```
command script import path/to/my/formatters.py 
```

有关 LLDB 数据格式化程序的更多信息，请参阅：

*   [http://lldb.llvm.org/python-reference.html](http://lldb.llvm.org/python-reference.html)
*   [http://llvm.org/svn/llvm-project/lldb/trunk/examples/synthetic/](http://llvm.org/svn/llvm-project/lldb/trunk/examples/synthetic/) - 有 STL 格式化程序的示例
*   查看捆绑的脚本`Xcode.app/Contents/SharedFrameworks/LLDB.framework/Resources/Python/lldb/formatters`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:03:38.073

有时，当将鼠标悬停在变量上时，Xcode 不会显示内容。为了获取您可以`po (variable name )`在控制台中编写的值。 [一旦检查这个](http://www.iosdevnotes.com/2011/02/debugging-objective-c-objects-in-gdb-using-po/)

# javascript - 前端javascript开发/测试和生产的工作流程/工具？

> ID：15430610
> 
> 赞同：1
> 
> 时间：2013-03-15T10:57:58.973
> 
> 标签：javascript, development-environment

Web 前端 javascript 应用程序在生产中几乎没有“暴露”，即声明为全局 var 或附加到`window`.

*   所有代码最小化并附加到一个（或几个）js文件；
*   几乎没有“暴露”，即声明为全局 var 或附加到`window`.

但是，在开发过程中，如果代码是可读的、拆分为多个文件，并且可以从控制台访问原型和相关实例，那么生活会更轻松。

更清楚地说（撇开最小化，这很容易通过许多不同的工具获得），在生产中我会有类似的东西：

```
(function() {
  var Greeter = function() {
  };

  Greeter.prototype.msg = function() {
    return 'Hello, world!';
  };

  Greeter.prototype.greet = function() {
    console.log(this.msg());
  };

  new Greeter().greet();
}()); 
```

这样，我的代码将在不暴露任何东西的情况下完成它的工作：Greeter 对象及其实例都不能被其他代码访问。

（当然，这只是实现这一目标的众多方法之一，但这不是问题的重点）。

但是，调试此代码很困难，并且不可能进行单元测试。

为了允许调试和测试，我通常会将 Greeter 及其实例附加到`window`对象或其他对象上。

所以，在开发过程中，我会使用类似的东西：

```
(function() {
  var Greeter = function() {
  };

  Greeter.prototype.msg = function() {
    return 'Hello, world!';
  };

  Greeter.prototype.greet = function() {
    console.log(this.msg());
  };

  window.Greeter = Greeter;
  window.greeter = new Greeter();

  window.greeter.greet();
}()); 
```

这样我就可以对 Greeter 进行单元测试，还可以从浏览器的控制台询问它以检查它的状态。

是否有一个工具，或一组工具，或一些不同的方式来组织我的代码，以便可以从开发版本传递到生产版本（这也将被最小化）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:58:50.550

没有可以安装的单个软件包或可执行文件可以让您 100% 顺利完成任务。您需要结合编辑器、命令行工具和浏览器来创建有效的 Web 应用程序/javascript 开发环境。

> 3.18.13：添加了 Sublime Web Inspector 的链接。在 Sublime Text 中调试 Javascript！[http://sokolovstas.github.com/SublimeWebInspector/](http://sokolovstas.github.com/SublimeWebInspector/)

## 编辑

要寻找的东西：插件系统、系统突出显示、linting、自动完成。如果你现在使用支持插件的编辑器，最好的办法是坚持使用它并设置 linting 和语法高亮。如果您正在寻找一些建议，以下所有这些都是可靠的选择。

*   Sublime Text 2（免费试用）
*   Textmate（商业，30 天试用）
*   VIM（免费）
*   Webstorm（商业，30天试用）

## 工作流程工具：

我建议从高级工具集开始，例如 Yeoman 或 lineman。他们有些固执己见，但提供了完整的工作流程，可以让您快速完成工作。一旦您习惯了使用它，您就可以窥视并根据您的需要挑选和定制它。

*   Yeoman：提供脚手架、包管理、开发服务器、连接和缩小并将运行规范

*   Lineman：开发服务器，连接和缩小，运行规范

*   Grunt：更低级别（由 Yeoman 和 Lineman 使用）。类似于 ruby​​ 的耙子

*   VCS：不容忽视，一个好的基于命令行的 VCS 是必不可少的。我推荐 Git，再次使用你熟悉的东西开始。

## 浏览器：

浏览器中的开发工具将为您提供控制台和调试工具。花一些时间研究并真正了解如何使用浏览器中提供的开发工具。他们非常强大。

*   Webkit 浏览器（Chrome 或 Safari）：内置开发者工具（命令选项 J）。

*   火狐+萤火虫

*   浏览器测试：强烈推荐使用 browserstack 进行跨浏览器测试。

# ruby-on-rails - 获取 [1, 1] 的错误未定义方法“空白”：rails 3.2 项目中的数组

> ID：15430614
> 
> 赞同：0
> 
> 时间：2013-03-15T10:58:07.470
> 
> 标签：ruby-on-rails, ruby

嗨，我正在实施一个项目。在这个 Loan_fines 表中引用了两个表，即书籍和类别。

我收到以下错误：-

```
NoMethodError in LoanFinesController#create

undefined method `blank' for [1, 1]:Array

app/models/loan_fine.rb:32:in `book_or_category'
app/controllers/loan_fines_controller.rb:46:in `block in create'
app/controllers/loan_fines_controller.rb:45:in `create' 
```

我的贷款罚款表如下：-

```
 id integer NOT NULL DEFAULT nextval('loans_fines_id_seq'::regclass),
  category_id integer,
  book_id integer,
  loan_duration integer,
  fine_amount numeric(8,2) DEFAULT 0.0,
  fine_duration integer,
  deleted integer NOT NULL DEFAULT 0,
  CONSTRAINT loans_fines_pkey PRIMARY KEY (id) 
```

这张表是我学长给的，不知道是什么意思，`nextval('loans_fines_id_seq'::regclass)`为什么用

我的创建贷款罚款控制器如下：-

```
 def create
    @loan_fine = LoanFine.new(params[:loan_fine])

    respond_to do |format|
      if @loan_fine.save
        format.html { redirect_to @loan_fine, notice: 'Loan fine was successfully created.' }
        format.json { render json: @loan_fine, status: :created, location: @loan_fine }
      else
        format.html { render action: "new" }
        format.json { render json: @loan_fine.errors, status: :unprocessable_entity }
      end
    end
  end 
```

我的贷款罚款模型如下：-

```
class LoanFine < ActiveRecord::Base

    attr_accessible :book_id, :category_id, :loan_duration, :fine_amount, :fine_duration

    # ------- ASSOCIATIONS -----------

    belongs_to :book

    belongs_to :category

    # ------ VALIDATIONS ------

    validate :book_or_category

  private

    def book_or_category
        if [self.book_id, self.category_id].compact.blank.size == 0
            errors[:base] << ("Please choose either book or category.")
        end
    end

end 
```

我被困在这个我不知道如何实现这个。谁能帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:09:25.770

您的错误在此文件中

```
app/models/loan_fine.rb 
```

特别是堆栈跟踪中指定的第 32 行

```
app/models/loan_fine.rb:32:in `book_or_category' 
```

但是根据错误，您正在调用`blank`而不是`blank?`. 因此，解决方案是更改`blank`为`blank?`您的 loan_fine 模型的第 32 行。

更新：根据您的代码，您想查看`book_id`或`category_id`是否存在。你有两个选择

1.  `if self.book_id.blank? && self.category_id.blank?`
2.  `if [self.book_id, self.category_id].reject(&:blank?).size == 0`

# java - 使用 javax 和 pdfbox 的静默打印机应用程序

> ID：15430619
> 
> 赞同：1
> 
> 时间：2013-03-15T10:58:27.953
> 
> 标签：java, pdf, printing

我正在编写一个静音打印机应用程序。我有一些问题要完成我的申请。

```
 printRequestAttributeSet.add(printerTray);
    printRequestAttributeSet.add(Sides.ONE_SIDED);

    PdfReader pdfReader = new PdfReader();
    PDDocument document = pdfReader.loadPdf(pdfPath);

    job.setPageable(document);
    int firstno = 0;
    int LastNo = 0;
    String pageRange[] = style.split("-");
    firstno = Integer.parseInt(pageRange[0]);
    if (pageRange[1].equals("Last")) {
        LastNo = document.getNumberOfPages();
    } else {
        LastNo = Integer.parseInt(pageRange[1]);
    }

    printRequestAttributeSet.add(new PageRanges(firstno, LastNo));

    job.printDialog(printRequestAttributeSet);

    job.print();
    // PrintJobWatcher pjDone = new PrintJobWatcher (job);

    document.close(); 
```

这段代码运行良好，没有任何问题。但我想`job.printDialog(printRequestAttributeSet);`从我的代码中删除，因为它总是需要用户输入。[有些人在http://www.java2s.com/Code/JavaAPI](http://www.java2s.com/Code/JavaAPI)上给了我一些例子。但我不知道如何设置`printRequestAttributeSet`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T22:56:53.740

从[PrinterJob](http://docs.oracle.com/javase/6/docs/api/java/awt/print/PrinterJob.html)的 Java 标准文档中，您可以找到`PrinterJob#print(PrintRequestAttributeSet)`它的诀窍。所以打电话

> job.print(printRequestAttributeSet);

# css - 溢出滚动不滚动？

> ID：15430621
> 
> 赞同：3
> 
> 时间：2013-03-15T10:58:28.357
> 
> 标签：css, scroll, overflow

不确定嵌套 DIV 是否存在阻止滚动的问题，或者我错过了代码本身的某些内容。无论如何，似乎无法让 .txtpodscroll 类的 div 真正滚动。栏看起来很好只是不会滚动？下面是我应用于 DIV 的 CSS 规则

```
.txtpodscroll {
font-family: Tahoma, Geneva, sans-serif;
font-size: 13px;
line-height: 20px;
width: 360px;
margin-top: 10px;
margin-right: auto;
margin-bottom: 10px;
margin-left: auto;
height: 300px;
overflow-y: auto;
overflow-x: hidden;
position: fixed; 
```

}

```
 <div class="holder-northeastphotobooth">
              <div class="imgpod"><img src="alt-img/nephotobooth-logo.png" width="370" height="89"></div>
              <div class="txtpodscroll">Photo booths are one of the most sought-after wedding reception additions, and we’ve got one of the best ready to bring to your big day.   We will deliver our professional booth to your venue, assemble it, and man it for the duration to make sure your guests have a great time taking lots of memorable pictures. Afterwards, we’ll dismantle and clear away the booth.   We can be as formal or as crazy as you like and will tailor it to suit your needs. You can select a range of fun green screen backgrounds for guests to choose from, allow uploading to Facebook, add multiple pictures to each print, take videos, and we can even bring along a box full of fun props for your guests to wear.   Hire our booth and you’ll get unlimited pictures and prints on the night, plus we’ll give you a USB stick with all of the pictures on to take away and for a limited time we’ll even supply a 2nd set of prints in a lovely photo album for you to take home and treasure. </div>
            </div> 
```

另外，这是一个链接到它的生活而不是工作。

[http://www.yourwedding.com/yourweddingwow/index-northeastphotobooth.html](http://www.yourwedding.com/yourweddingwow/index-northeastphotobooth.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:04:45.413

这是因为书的内阴影在滚动条的上方，所以你不能点击它，但是你仍然可以看到它，因为阴影是透明的PNG...更改此行：

**标准变量.css（第 83 行）**

```
.holder-northeastphotobooth {
    float: left;
    font-family: Arial,Helvetica,sans-serif;
    height: 470px;
    margin: 0;
    padding: 15px;
    position: relative;  /* added */
    width: 370px;
    z-index: 1;   /* added */
} 
```

确保同时**删除**背景属性，这样阴影将显示在页面**“下方”**，而不是在页面上方。在萤火虫上试试看，它很容易修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:02:47.967

您有一个 div，其中包含`.wowbook-gutter-shadow`您放置在滚动条顶部的类，这就是它不滚动的原因

如果您提供`.txtpodscroll`以下样式：`z-index:2`它应该可以解决您的问题

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-15T11:03:51.267

为了防止滚动，您应该使用“百分比”。

```
.txtpodscroll {
font-family: Tahoma, Geneva, sans-serif;
font-size: 13px;
line-height: 20px;
width: 360%;
margin-top: 10px;
margin-right: auto;
margin-bottom: 10px;
margin-left: auto;
height: 300px;
overflow-y: auto;
overflow-x: hidden;
position: fixed;
} 
```

如果滚动是水平的。

```
width: 360%; 
```

希望这可以帮助。

# html - UTF-8 URL 百分比编码（希伯来语）适用于除 IE 之外的所有浏览器

> ID：15430622
> 
> 赞同：1
> 
> 时间：2013-03-15T10:58:33.157
> 
> 标签：html, internet-explorer, utf-8, hebrew, percent-encoding

我有一个这样的 html.file，本地文件的希伯来文名称如下：אב.html

它的百分比编码链接适用于所有浏览器，但不适用于 IE。似乎 IE 不是将其转换为 UTF-8，而是转换为 ISO。

```
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/></head>
<body>
<p>
UTF-8 file name in URL
File name is in hebrew 
<P>
&#1488;&#1489.html
<P>
Percent encoded does not work in IE / works in all other browsers:
<P>
%D7%90%D7%91.html
<P>
<a href="%D7%90%D7%91.html">&#1488;&#1489;
</a>
<P>
Ampersand encoded works in all browsers
<P>
'& #1488'; & #1489 ; ' .html 
<P>
<a href="&#1488;&#1489;.html">&#1488;&#1489;
</a>
</body></html> 
```

# angularjs - Angular 的自动初始化似乎不起作用

> ID：15430626
> 
> 赞同：1
> 
> 时间：2013-03-15T10:58:48.403
> 
> 标签：angularjs

我正在关注 Angular.js 的自动初始化（基于他们的[示例](http://docs.angularjs.org/guide/bootstrap)）我制作了一个基本的 html 文件，其中包含以下内容：

```
<!doctype html>
<html ng-app="optionalModuleName">
  <body>
    I can add: {{ 1+2 }}.
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.min.js"></script>
   </body>
</html> 
```

不幸的是，这似乎不适用于我的浏览器。如果我添加以下脚本（[手动初始化](http://docs.angularjs.org/guide/bootstrap)），它可以工作。

```
<script>
  angular.element(document).ready(function() {
  angular.bootstrap(document);
});
</script> 
```

我想知道为什么自动初始化不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:01:01.230

您似乎没有`optionalModuleName`定义:-)

# sql-server-2008 - 如何将集合分配给 SSIS 任务属性

> ID：15430627
> 
> 赞同：1
> 
> 时间：2013-03-15T10:58:49.873
> 
> 标签：sql-server-2008, ssis, expression

我在 SSIS 包上有一个“*传输 SQL Server 对象*”任务，我想将表的集合存储在包变量中，然后使用*Expression*`ObjectsToCopy.TablesList`将此变量分配给任务的属性。

 *显然这应该可以，我可以创建一个变量并通过表达式将其分配给任务属性。我的问题是将一组表保存在变量中的正确变量类型和语法是什么？

我一直在测试，但找不到正确的语法（带有字符串变量）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T12:27:28.080

几天前，我在完全相同的问题上花了几个小时。据我通过广泛的谷歌搜索得知，没有办法以任务可以理解的方式分配表列表。我最终对任务编辑器中提供的列表中的表格进行了硬编码。一点都不理想。

如果做不到这一点，就有[滚动你自己的任务](http://blogs.msdn.com/b/mattm/archive/2007/04/18/roll-your-own-transfer-sql-server-objects-task.aspx "滚动你自己的任务")方法。*

# sql - 在某些条件下同时显示重复值和非重复值

> ID：15430629
> 
> 赞同：0
> 
> 时间：2013-03-15T10:58:53.687
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2008-r2

**我有一个通过多个条件执行的查询，结果如下：**

### 代码 - 名称 - Code2

```
a     abc     a.1
a     abc     a.2
a     abc     a.3
a     abc     a.4

b     bad     b.1
b     bad     b.2
b     bad     b.3 
```

我需要将结果显示为

### 代码 - 名称 - Code2

```
a      abc      a.1
                a.2
                a.3
                a.4

b      bad      b.1
                b.2
                b.3 
```

可以使用 T-SQL 吗？
我正在使用 SQL Server 2008-R2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:03:41.640

您可以将 CTE 与`ROW_NUMBER`：

```
WITH CTE AS
(
   SELECT Code, Name, Code2,
      RN = ROW_NUMBER() OVER (PARTITION BY Code, Name ORDER BY Code2)
   FROM dbo.TableName
   WHERE ....
)
SELECT 
    CASE WHEN RN > 1 THEN '' ELSE Code END AS Code, 
    CASE WHEN RN > 1 THEN '' ELSE Name END AS Name, 
    Code2
FROM CTE 
```

编辑[**演示**](http://www.sqlfiddle.com/#!3/3a925/2/0)（感谢 bluefeet 提供数据）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:03:52.387

您可以使用`row_number()`来获得结果：

```
select 
  case when rn = 1 then code else '' end code,
  case when rn = 1 then name else '' end name,
  code2
from
(
  select code, name, code2,
    row_number() over(partition by code, name order by code2) rn
  from table3
) src 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/3a925/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:06:42.680

您可以纯粹在 SQL 中使用`row_number()`排名来执行此操作：

```
with val_ranks as (
   select code,name,code2,
       row_number() over (partition by code order by code2) as rown
       from foo
)
select case when rown=1 then code else '' end as code,
       case when rown=1 then name else '' end as name,
       code2
   from val_ranks
   order by code2; 
```

[SQLFiddle 示例](http://www.sqlfiddle.com/#!3/4c386/2)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T11:08:25.270

尝试这个 ：-

```
With cte(Col1,col2,col3) as
(
 Select 'a','abc','a.1'
 union all
 Select 'a',    'abc','a.2'
 union all
 Select 'a',    'abc','a.3'
 union all
 Select 'a',    'abc','a.4'
 union all
 Select 'b',    'bad','b.1'
 union all
 Select 'b',    'bad','b.2'
 union all
 Select 'b',    'bad','b.3'
 ),
 cte1 as
(Select * ,  
 row_number() over ( partition by col1,col2 order by (select 0)) as rn 
 from cte
)
 Select case when rn=1 then col1 else null end,
 case when rn=1 then col2 else null end,
 col3
 from cte1
 order by col3 
```

# android - Facebook三星S3权限画面

> ID：15430630
> 
> 赞同：1
> 
> 时间：2013-03-15T10:58:58.207
> 
> 标签：android, facebook

按照本教程，我在我的应用程序中集成了 Facebook SDK 3.0：- [https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/#enablesso](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/#enablesso)

我已将 Facebook 登录集成到我的应用程序中，一切正常，但是当用户尝试第一次在三星 S3、Android OS - 4.1.2 上登录我的应用程序时，我得到了这个权限屏幕。我在互联网上看了很多，但没有文档说这个屏幕是默认出现的。这个权限屏幕只是第一次。下次登录用户会出现此屏幕，但如果新用户再次登录同一部手机，则会出现此权限屏幕。

我还在三星 Grand 手机上安装了相同的版本，操作系统版本 - 4.1，是否与此操作系统版本有关，我没有在任何其他操作系统版本 4.0 或更低版本的手机上看到此屏幕。

请帮助我解决如何解决此问题或告诉用户这是因为最新的操作系统版本。

![在此处输入图像描述](../Images/5944c30d07aed83694d4a380c18a0c8b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:06:35.833

这不是任何与 facebook 本身相关的操作系统的问题，尝试在farmville 等浏览器上安装任何 facebook 应用程序，您也会在那里看到这个屏幕。

在 facebook 上注册您的应用程序时，您必须指定请求的权限。并且客户必须授予他们访问 Facebook 功能的权限。

是的，这仅在您使用的每个 Facebook 帐户中首次出现。就像在 android 中安装应用程序之前一样，它会要求所有权限。

不需要记录，很明显

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T22:12:26.513

刚碰到这个问题。然后我进行了搜索并找到了此页面。出于某种原因，在 Galaxy s3 上安装 facebook 会导致 facebook 自动尝试安装 Galaxy s3 facebook 应用程序。

他们将其设置为在您第一次登录时弹出，因此它看起来像是 facebook 安装的一部分，而实际上它几乎是在强迫您安装您可能不想要的 facebook 应用程序。

我必须点击两次“取消”才能让我在不添加他们的应用程序的情况下真正登录 Facebook。

# ios - UIInterfaceOrientation 是 Landscape 但 UIView 仍处于 Portrait 模式

> ID：15430636
> 
> 赞同：2
> 
> 时间：2013-03-15T10:59:09.000
> 
> 标签：ios, avcapturesession

我正在使用最新的 SDK 开发一个 iOS 应用程序。

我正在开发一个仅支持 LandscapeRight 方向的相机应用程序。

在 Main`ViewController`我添加了一个`UIView`for `AVCaptureVideoPreviewLayer`。换句话说， main`ViewController`我有主视图和另一个视图，称为`videoPreviewView`，for `AVCaptureVideoPreviewLayer`。

我设置了`AVCaptureVideoPreviewLayer`方法`viewWillAppear:`：

```
- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [self setUpVideo];
}

- (void)setUpVideo
{
    NSLog(@"Set up video");
    if (DataExchanger.cameraManager != nil)
    {
        UIView *view = [self videoPreviewView];
        CALayer *viewLayer = [view layer];
        [viewLayer setMasksToBounds:YES];

        AVCaptureVideoPreviewLayer *newCaptureVideoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:DataExchanger.cameraManager.captureSession];
        CGRect bounds = [view bounds];
        NSLog(@"BOUNDS: %@", NSStringFromCGRect(bounds));

        [newCaptureVideoPreviewLayer setFrame:bounds];
        [newCaptureVideoPreviewLayer setVideoGravity:AVLayerVideoGravityResizeAspectFill];

        [viewLayer insertSublayer:newCaptureVideoPreviewLayer below:[[viewLayer sublayers] objectAtIndex:0]];
    }
} 
```

我得到这个日志：

```
BOUNDS: {{0, 0}, {320, 480}} 
```

但是`UIInterfaceOrientation`，`UIInterfaceOrientationLandscapeRight`在那个方向上，我会得到这些值：

```
BOUNDS: {{0, 0}, {480, 320}} 
```

另一个问题是我看到**视频旋转了 -90 度**。

我找到了这个[stackoverflow question](https://stackoverflow.com/questions/12663913/ios-calayer-orientation-avcapturevideopreviewlayer-doesnt-rotate)，但`- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation`方法从未被触发。

**发生了什么？我该如何解决这个问题？**

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-15T12:24:41.290

1.  默认的 AVCaptureVideoPreviewLayer 对象方向是横向的！
2.  AVCaptureVideoPreviewLayer 的方向不会随着设备的方向而改变。您必须手动更改它。
3.  要手动更改，需要调用预览层的连接并旋转：

iOS6：

```
 AVCaptureConnection *previewLayerConnection=self.newCaptureVideoPreviewLayer.connection;
 if ([previewLayerConnection isVideoOrientationSupported])
   [previewLayerConnection setVideoOrientation:AVCaptureVideoOrientationLandscapeRight]; 
```

< iOS6:

```
if ([self.newCaptureVideoPreviewLayer isOrientationSupported])   
[self.newCaptureVideoPreviewLayer setOrientation:AVCaptureVideoOrientationLandscapeRight]; 
```

# javascript - 为什么 mousemove 事件会削弱 Chrome 中的数字输入？

> ID：15430640
> 
> 赞同：1
> 
> 时间：2013-03-15T10:59:17.337
> 
> 标签：javascript, html, google-chrome

在 Chrome v.25 中，我使用此代码来避免在拖动 HTML 元素时出现文本光标：

```
document.addEventListener("mousemove",function(e) { e.returnValue = false; }); 
```

每个`<input type="number"/>`都是残废的（见[jsfiddle](http://jsfiddle.net/uP7TH/1)）

我已经设法通过仅在拖动时设置错误的 returnValue 来避免这种情况。但是这里到底发生了什么？它是错误还是某些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:02:11.863

如果我正确理解您的意思，您可以使用 CSS 实现此目的...

```
.no-select {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

只需将其添加到您不想选择的元素中即可。

这看起来确实是一个字符串问题，因为我不会将按下数字输入称为 mousemove 事件，但无论如何，问题都存在。CSS 可能是一个更优雅的解决方案。

在这里检查小提琴：

[http://jsfiddle.net/uP7TH/3/](http://jsfiddle.net/uP7TH/3/)

# asp.net-mvc - Durandal 运行 js 函数和缓存的初始问题

> ID：15430643
> 
> 赞同：0
> 
> 时间：2013-03-15T10:59:20.883
> 
> 标签：asp.net-mvc, durandal

我正在玩用于 ASP.Net MVC 的 Durandal Starter Kit。相处得很好，但我现在有两个问题：

1.  shell 视图加载后如何运行函数。我需要在 shell.html 中找到 dom 元素的高度，但在 ViewModel 激活方法中不起作用，因为视图尚未加载，所以我得到一个空值。我似乎也无法将脚本放入 shell 视图本身。
2.  每次我更改布局、css 值、一些文本、任何东西时，我都必须删除我的缓存以供应用程序更新，是否有一些全局值这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:11:04.487

对于 1：您可以使用 viewAttached 方法。

在这里可以看到生命周期： [http ://durandaljs.com/documentation/Hooking-Lifecycle-Callbacks/](http://durandaljs.com/documentation/Hooking-Lifecycle-Callbacks/)

对于 2：如果使用 chrome，开发者工具可以选择禁用缓存。我认为其他浏览器也会有类似的东西。

# c# - 基本身份验证和 WCF

> ID：15430645
> 
> 赞同：2
> 
> 时间：2013-03-15T10:59:28.057
> 
> 标签：c#, wcf, security

我正在尝试学习 WCF，但我真的不明白我必须做什么。我有一个包含用户名和密码的数据库，用户在使用该服务之前应该进行身份验证。

目前，用户名和密码是硬编码的：

```
class UsernameAuthentication : UserNamePasswordValidator
{
    /// <summary>
    /// When overridden in a derived class, validates the specified username and password.
    /// </summary>
    /// <param name="userName">The username to validate.</param><param name="password">The password to validate.</param>
    public override void Validate(string userName, string password)
    {
        var ok = (userName == "test") && (password == "test");
        if (ok == false)
            throw new AuthenticationException("username and password does not match");
    }
} 
```

我的服务很简单：

```
public class Service1 : IService1
{
    public int Add(int a, int b)
    {
        return a + b;
    }

    public int Subtract(int a, int b)
    {
        return a - b;
    }
} 
```

我的问题是：我必须在 web.config 文件中进行哪些更改才能使其正常工作？我看过一些教程，但并不真正了解所需的更改..

另外，我正在尝试做的事情 - 在用户访问服务之前对其进行身份验证，这是正确的做法吗？

谢谢

编辑：我的配置文件：

```
<?xml version="1.0"?>
<configuration>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5"/>
  </system.web>
  <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="Binding1">
          <security mode="Message">
            <message clientCredentialType="UserName" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceCredentials>
            <userNameAuthentication userNamePasswordValidationMode="Custom" customUserNamePasswordValidatorType="WcfService1.UsernameAuthentication, service1" />
          </serviceCredentials>
          <!-- To avoid disclosing metadata information, set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <protocolMapping>
        <add binding="basicHttpsBinding" scheme="https" />
    </protocolMapping>    
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <!--
        To browse web app root directory during debugging, set the value below to true.
        Set to false before deployment to avoid disclosing web app folder information.
      -->
    <directoryBrowse enabled="true"/>
  </system.webServer>
</configuration> 
```

错误：无法激活 service1.svc。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:17:16.527

您必须在 web.config 中指定您将使用用户名/密码凭据并使用自定义密码验证器。

您的服务绑定应该设置了一种安全类型（`Transport`或者`Message`，最适合您的类型），并且对于该类型的安全，您必须设置要使用的凭据（用户名和密码）。

```
<system.serviceModel> 
  <bindings>
  <wsHttpBinding>
      <binding name="Binding1" ...>
        <security mode="Message">
          <message clientCredentialType="UserName" />
        </security>
      </binding>        
    </wsHttpBinding>
  </bindings>
</system.serviceModel> 
```

其中`...`意味着许多其他特定于您的服务的设置。

考虑到只有某些类型的绑定和安全模式支持这种类型的凭据，但 MSDN 拥有您可能需要的所有信息。

**如果您不将凭据设置为用户名和密码，则不会以这种方式对用户进行身份验证。**

要告诉服务使用您的密码验证器，您需要添加如下内容：

```
<behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehavior">
            <serviceCredentials>
              <userNameAuthentication userNamePasswordValidationMode="Custom" customUserNamePasswordValidatorType="Microsoft.ServiceModel.Samples.CalculatorService.CustomUserNameValidator, service" />
            </serviceCredentials>
         .....
         </serviceBehaviors>
</behaviors> 
```

`Microsoft.ServiceModel.Samples.CalculatorService`您拥有自定义验证器的命名空间在哪里，`CustomUserNameValidator`是自定义验证器（`UserNamePasswordValidator`在您的情况下），并且`service`是服务的名称。

否则，该服务将需要一个默认验证器，例如 ASP.NET Membership Provider。

服务凭证必须放在您的服务行为中。

另外，不要忘记将行为链接到服务定义。

```
<services>
  <service behaviorConfiguration="ServiceBehavior" name="ServiceName">
    <endpoint address="" binding="basicHttpBinding" bindingConfiguration="Binding1" contract="ContractName" />
     ....
  </service>
</services> 
```

**注意**：web.config 中还有很多我没有展示的设置。元素的名称仅具有方向性。这只是为了使用户名凭据起作用。

你可以查看 MSDN，因为他们有很多很棒的教程，比如这个[http://msdn.microsoft.com/en-us/library/aa702565.aspx](http://msdn.microsoft.com/en-us/library/aa702565.aspx)，[http://msdn.microsoft.com/en-us/图书馆/aa354513.aspx](http://msdn.microsoft.com/en-us/library/aa354513.aspx)。

是的，事实上，如果您以正确的方式配置它，它将在授予客户端运行服务方法的权限之前对客户端（用户、客户端服务）进行身份验证。

# matlab - 用于检查矩阵相等性的 Matlab 函数，无序

> ID：15430663
> 
> 赞同：2
> 
> 时间：2013-03-15T11:00:24.987
> 
> 标签：matlab, matrix

我想知道是否有一个 matlab 函数可以检查两个矩阵是否具有相同的元素，这些元素不一定是有序的。

示例：A = [1,2,3] 和 B = [3,2,1]

函数 isequal(A,B) 返回 0，但我想要的是返回 1 的函数或代码。我知道我可以遍历矩阵，但我想知道是否有更快的方法来做到这一点。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:05:47.830

一种简单的向量方法可能是

```
isequal(sort(A), sort(B)) 
```

对于矩阵使用

```
isequal(sort(A(:)), sort(B(:))) 
```

但是，对于大型矩阵，排序可能会很慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T13:48:24.613

## 集与多集

这取决于您是否要将相同数量的多次出现视为单个项目（多集方法）或不（集合方法）：

是否相同（集合方法）或不同（多集合方法）`[1, 2, 3]`？`[1, 2, 3, 3]`

## 设置方法

正如 reverse_engineer 所建议的：

```
f_xor = @(x, y) isempty(setxor(x, y)) 
```

H. Muster 方法的一组变体：

```
 f_sortu = @(x, y) isequal(sort(unique(x(:))), sort(unique(y(:)))) 
```

## 多集方法

正如 H.Muster 所建议的：

```
f_sort = @(x, y) isequal(sort(x(:)), sort(y(:))) 
```

## 计时

这里是各个变体的时间。

```
>> A = rand(1, 1000);
>> B = A; B(end) = B(end) - 1;  % Make vectors almost equal
>> N = 10000;
>> tic; for i = 1 : N; f_sort(A, B); end; toc/N

ans =

   1.6892e-04

>> tic; for i = 1 : N; f_sortu(A, B); end; toc/N

ans =

   3.5647e-04

>> tic; for i = 1 : N; f_xor(A, B); end; toc/N

ans =

   5.4098e-04 
```

设置方法较慢，因为它们需要删除重复项。有趣的是，`setxor`它比使用`sort`+慢`unique`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T13:27:04.127

最有效的方法是检查 的空虚`setxor`：

```
isempty(setxor(set1,set2)) 
```

不确定这是否比`sort`选项更快......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-15T11:14:01.500

尝试

```
setdiff(A,B) 
```

这几乎与您所寻求的相反。

# c++ - 未解析的友元函数外部符号

> ID：15430665
> 
> 赞同：1
> 
> 时间：2013-03-15T11:00:30.380
> 
> 标签：c++, dll, linker, unresolved-external

首先是我的代码布局：

啊

```
class STORAGE_CLASS_DECLARATOR A : public PureVirtual
{
   some member functions, all working;
   void someFunctionCallingOperator<<();
   friend std::ostream& operator << (std::ostream &, A *);
} 
```

A.cpp

```
std::ostream& operator << (std::ostream & out, A * a){...}
void A::someFunctionCallingOperator<<(){...} 
```

其中 Storage_xxx_declarators 是 declspec 的宏。我已经尝试过使用和不使用声明符的朋友功能都无济于事。

我在 operator<< 函数上得到一个未解析的外部符号。

据我了解，这可能是由于：

1.  该函数没有正文，这显然是不正确的，因为该文件肯定会针对正在工作的其他函数进行解析。
2.  符号未正确导出。同样，我不知道这是如何发生的，在实际场景中，此处 A 的 operator<< 实际上为另一个 B 类调用了 operator<<，并且该函数也显示了相同的错误。因此，A 的定义必须在某个时候被解析。

我意识到链接是一个单独的阶段，而且我一定是在做一些非常简单的错误，但我已经凝视了一段时间，无法从理论上解释为什么会发生这种情况，所以我转向 SO 寻求帮助

谢谢你，AK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T13:40:07.763

根据您的评论，我假设您的设置是这样的：

啊

```
namespace NN {

class STORAGE_CLASS_DECLARATOR A : public PureVirtual
{
   some member functions, all working;
   void someFunctionCallingOperator<<();
   friend std::ostream& operator << (std::ostream &, A *);
}

} 
```

A.cpp：

```
using namespace NN;

std::ostream& operator << (std::ostream & out, A * a){...}
void A::someFunctionCallingOperator<<(){...} 
```

这是一个非常常见的设置，但我不鼓励任何人使用它，因为它会导致您现在遇到的问题。让我们看看发生了什么`A.cpp`：

解析 的定义时`A::someFunctionCallingOperator`，全局命名空间中没有`A`，所以`using`考虑了 -ed 命名空间，并`A`解析为`NN::A`.

但是，在解析 的定义时`operator<<`，根本没有任何迹象表明应该将运算符放入 namespace `NN`。所以这很高兴地定义*在*`operator<<`全局命名空间中，这与. 后来在使用inside的时候，（已经在 in 中声明过）是通过参数依赖查找找到的，所以就使用了。最后，链接器正确地抱怨它从未被定义过。*`NN::operator<<``A.h``<<``someFunctionCallingOperator``NN::operator<<``A.h`*

 *解决这个问题的正确方法是停止`using namespace NN`并`A.cpp`正确地将内容包含在命名空间中，就像在头文件中所做的那样：

```
namespace NN {

std::ostream& operator << (std::ostream & out, A * a){...}
void A::someFunctionCallingOperator<<(){...}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:08:53.567

*简短回答：*确保运算符的返回类型和参数在定义和实现中都是相同的。

*稍微长一点的答案：*

看来您已经省略了运算符的返回类型。您的朋友函数定义包括您的宏，但实现标识`ostream&`. 如果`ostream&`未包含在您的宏中，这可能会导致未解决的外部符号错误。

您还省略了实现中的参数，如果您尝试将运算符与参数一起使用，这也会导致未解决的外部符号错误（这对于 来说是正常的`<<`）。编译器将寻找`<<`具有单个参数（和`ostream&`返回类型）的实现，但只会找到具有`operator<<`空参数列表的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-06T17:43:57.097

我通过将方法放在同一个命名空间中解决了这个问题*

# ios - iOS：蓝牙监听器

> ID：15430669
> 
> 赞同：0
> 
> 时间：2013-03-15T11:00:36.027
> 
> 标签：ios, bluetooth

我想通过蓝牙连接收听从蓝牙计步器和胰岛素泵推送到我的 iPhone 应用程序的数据。是否可以监听从另一个蓝牙设备接收到我们的 iPhone 应用程序的数据？如果可能，请告知如何做到这一点？

谢谢你。

# asp.net - 避免在文本框自动回发后在 asp.net 中单击两次按钮

> ID：15430673
> 
> 赞同：1
> 
> 时间：2013-03-15T11:00:51.147
> 
> 标签：asp.net, button, autopostback

在我的一个 asp.net 项目中，我有两个 asp 文本框，它们应该在服务器上运行并更新一些值（在 aspx.vb 中会发生一些计算）。还有一个输入（html 按钮）类型的提交按钮，单击它会调用 javascript（位于 .aspx 页面中）。

```
<asp:TextBox ID="TextBox1" runat="server" AutoPostBack=true   Width="38px"></asp:TextBox>

<asp:TextBox ID="TextBox2" runat="server" AutoPostBack=true   Width="33px"></asp:TextBox>

  <input type="button" id="22" value="Draw graph" OnClick="surface.plot1();"   />
  &nbsp;<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox> 
```

现在的问题是，如果我在其中输入一些值`TextBox1`并`TextBox2`直接单击该按钮`surface.plot1();`，则第一次不会调用该按钮。所以我需要再次单击该按钮才能被`surface.plot1();`解雇。我知道这是因为我在 TextBox2 中输入了值，然后直接单击按钮，所以 AutoPostBack 在第一次单击按钮时完成，当第二次单击按钮时，实际函数被调用？那么如何避免这种情况以便在第一次单击按钮本身时 `surface.plot1();`被调用？或者有没有其他方法可以实现这一目标？（但是 TextBox2 自动回发应该可以工作，否则一切都会出错）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:32:41.190

如果您可以在 surface.plot1() 之前的任何时间进行这些计算，那么您可以将按钮更改为服务器端并单击它，在 Click 函数中进行计算，一旦完成计算，调用 javascript函数surface.plot1() 从您的代码后面解释[here](https://stackoverflow.com/questions/5731224/calling-javascript-function-from-codebehind)。请记住从您的文本框中删除 AutoPostBack="true"。

# jquery - jQuery slideToggle 和 CSS 边框半径属性在 IE10 中显示异常

> ID：15430675
> 
> 赞同：1
> 
> 时间：2013-03-15T11:00:57.403
> 
> 标签：jquery, slidetoggle, internet-explorer-10, css

我正在使用 MVC4，在我的页面中我拿了 4 个 div 和所有 div。我有 JSFiddle URL 来检查我的确切问题。

[jsfiddle](http://jsfiddle.net/gaur1982/9FmdP/)

请仅在 IE10 中运行此程序，因为在 IE10 或任何其他浏览器中运行正常。

```
jQuery(document).ready(function () {
        jQuery(".HomeContent").hide();
        jQuery(".HomeDivHeading").click(function () {
            jQuery(this).next(".HomeContent").slideToggle(250);
        });
    }); 
```

在 IE10 中，当我向下滑动任何 din 时，它会显示如下 ![在此处输入图像描述](../Images/e4d8fc4bc8981bb0e32bd01be1c5bcde.png)

我想解决这个问题，当我向下滑动 div 时，它看起来像有线，一段时间后它显示自动更正。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T14:21:19.247

这是一种奇怪的浏览器行为。我已经找到了亲爱的解决方案；

```
.HomeDivHeading {
    background-color: #BBC0C4;
    border-radius: 10px 10px 0 0;
    display: inline-block; /* changed from block to inline-block*/
    font-size: 18px;
    font-weight: bold;
    padding: 6px 0;
    text-align: center;
    width: 100%;
    cursor: pointer;
} 
```

# osgi - 将 vaadin 7 插件/小部件集部署到 Glassfish 服务器上启用 OSGI 的应用程序中

> ID：15430676
> 
> 赞同：0
> 
> 时间：2013-03-15T11:00:58.953
> 
> 标签：osgi, vaadin

我正在尝试从过去 7 天开始将 vaadin 日历插件添加到启用 OSGI 的应用程序中。有人可以告诉我步骤或指导我实现这一目标吗？是否有任何类型的 OSGI 兼容 vaadin 插件可以像普通 jar 一样添加？

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:24:15.287

我在 Vaadin 7 和 OSGi 上使用了一些 vaadin 插件。

为此，我创建了一个自定义小部件集作为 Vaadin Web 应用程序的片段包。这个小部件集是所有需要的插件的客户端。稍后，您将需要对 Addon 服务器部分进行 OSGi-fy，并将其作为任何普通捆绑包。我使用 BND 工具（命令行）来做到这一点。

# ruby - 如何通过 AWS::SDK 将迁移部署到 Opswork 服务器

> ID：15430679
> 
> 赞同：3
> 
> 时间：2013-03-15T11:01:10.770
> 
> 标签：ruby, deployment, amazon-web-services

我有一个使用 aws-sdk gem 在我们的 Opswork 服务器上创建部署的 RubyScript。

```
client.create_deployment({
  stack_id: "xxx",
  app_id: "xxx",
  instance_ids: ["xxx"],
  command: {
    name: "deploy"
  },
  comment: "ci deployment"
 }) 
```

但我无法弄清楚，迁移数据库的正确论点是什么。

我尝试过这样的事情但没有成功。

```
command: {
  name: "deploy",
  args: {
    "migrate" => ["true"]
  }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-28T20:19:09.023

文件夹中的脚本`deploy`将在适当的时间运行。因此，如果您想在部署后进行迁移，请将命令添加到您的`after_deploy.rb`文件中。

# .net-4.5 - .Net 4.5 自定义声明未重新创建

> ID：15430684
> 
> 赞同：0
> 
> 时间：2013-03-15T11:01:29.127
> 
> 标签：.net-4.5, wif, claims-based-identity, asp.net-4.5

我已经搜索过这个主题，只是越来越困惑。

我们有一个表单身份验证 Web 应用程序。我更改了旧的 FormsAuthentication.SetCookie 语句，改为创建一个包含 FormsIdentity 的 GenericPrincipal，然后我添加了几个自定义声明，然后我使用 SessionAuthenticationModule 编写了一个 sessionsecuritytokentocookie。我对 FederatedAuthentication 有点困惑 - 我正在使用 FederatedAuthentication.SessionAuthenticationModule 来编写令牌，但我认为这与在我的情况下仅使用 Modules("SessionAuthenticationModule") 相同吗？

无论如何，身份验证工作正常，但我的自定义声明没有被重新创建。我没有使用会员提供者或角色提供者——这有关系吗？

我已阅读有关 SessionAuthenticationModules、ClaimsAuthenticationManagers、ClaimsTransformationModules 的信息，但我不再确定应该使用哪些或如何使用？目前我只是在旧登录代码所在的位置添加我的声明（我没有时间重写整个登录过程），我希望在每个请求时自动重新创建这些声明。

我需要做什么 - 显然我不想每次都去数据库重建它们 - 我认为它们被存储在 cookie 中并自动重新创建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T17:56:29.527

您的方法很好 - 您创建一个包含所有您需要的声明的 ClaimsPrincipal 并写出会话 cookie。无需声明身份验证管理器。

可能的陷阱：

*   确保在创建 ClaimsIdentity 时设置身份验证类型 - 否则客户端将无法通过身份验证
*   默认情况下，会话 cookie 需要 SSL（浏览器不会通过纯文本重新发送 cookie）。这可以更改，但不推荐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T13:42:04.077

您需要自定义 ClaimsAuthenticationManager，它将被调用一次并添加声明。不要忘记在您的应用程序中注册这个自定义类：

```
public override ClaimsPrincipal Authenticate(string resourceName, ClaimsPrincipal incomingPrincipal)
    {
        //works only with one default identity
        //In contra to a a default implementation modify incomingPrincipal by adding claims) 
        if (incomingPrincipal != null && incomingPrincipal.Identity.IsAuthenticated == true)
        {
            ClaimsIdentity claimsIdentity = incomingPrincipal.Identity as ClaimsIdentity;
            if (claimsIdentity != null)
            {
                IEnumerable<Claim> claims = new Claim[] { };
                claims = claims.Concat(CreateIdsClaims(incomingPrincipal.Identity.Name));
                claims = claims.Concat<Claim>(CreateRoleClaims(GetRolesByName(incomingPrincipal.Identity.Name)));
                claimsIdentity.AddClaims(claims);
            }

            return incomingPrincipal;
        }

        return null;
    } 
```

# vb.net - Vb.net 添加年份然后转到该月的最后一天

> ID：15430686
> 
> 赞同：0
> 
> 时间：2013-03-15T11:01:38.340
> 
> 标签：vb.net

我正在使用**DateAdd**函数将年份添加到我现有的日期，但我想转到该特定月份的最后一个日期。

我正在使用这段代码：

```
 Dim wr As Integer = Val(txtWar_per.Text)
    Dim ins_dt As Date = dtpInstall.Value
    Dim war_till As Date = DateAdd(DateInterval.Year, wr, dtpInstall.Value)
    dtpWar_till.Value = war_till 
```

输出：

```
dtpinstall.value= 12/1/2012

txtWar_per.text=  2

dtpWar_till.value=12/1/2014 
```

但我希望**dtpWar_till.value** 为：

```
31/1/2014 
```

请尽早解决我的问题。非常非常非常紧急。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:07:06.047

将日期减去 1 得到该月的第一天，加上一年和一个月，然后在上个月的最后一天减去另一天：

```
Dim war_till As Date = ins_dt.AddDays(1 - ins.dt.Day).AddMonths(13).AddDays(-1) 
```

减去天数两次确保它适用于具有不同天数的月份，例如从 2013-01-30 将您带到 2014-01-31 而不是 2014-03-01。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:30:16.120

更多代码，但更直观：

```
Dim year As Integer = ins_dt.Year + wr
Dim month As Integer = ins_dt.Month
dtpWar_till.Value = New DateTime(year, month, DateTime.DaysInMonth(year, month)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:08:00.873

尝试：

```
Dim war_till As Date = DateAdd(DateInterval.Day,-1,DateAdd(DateInterval.Month,2,DateAdd(DateInterval.Year, wr, dtpInstall.Value))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T14:52:44.063

使用闰年进行测试

```
 Dim tstDate1 As Date = #2/28/2011#
    Dim tstDate2 As Date = #2/29/2012#

    For numYears As Integer = 1 To 5
        'add years and set date to the first day of the month
        Dim newD As Date = New Date(tstDate1.Year + numYears, tstDate1.Month, 1)
        'then add days in month-1 to date
        newD = newD.AddDays(Date.DaysInMonth(newD.Year, newD.Month) - 1)
        'show it
        Debug.WriteLine(newD)

        newD = New Date(tstDate2.Year + numYears, tstDate2.Month, 1)
        newD = newD.AddDays(Date.DaysInMonth(newD.Year, newD.Month) - 1)
        Debug.WriteLine(newD)
    Next 
```

# java - SSLSocket 也适用于不安全的 http？

> ID：15430688
> 
> 赞同：3
> 
> 时间：2013-03-15T11:01:44.573
> 
> 标签：java, ssl, https, certificate, jsse

我可以将 SSLServerSocket 类用于 http 和 https 会话并侦听**一个**端口（通过自动检测客户端带有 http 或 https）吗？还是必须打开**两个**端口并使用 SSLServerSocket for https 和 ServerSocket for http？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:53:36.253

您正在尝试做的事情称为*端口统一*。例如，它[在 Grizzly](http://jfarcand.wordpress.com/2006/11/07/one-tcp-port-to-rule-them-all/)中实现。

您不能真正使用 an`SSLServerSocket`直接监听 HTTP 和 HTTPS 流量，因为它会在读取时直接开始握手，但是您可以使用 plain `ServerSocket`，接受 plain `Socket`，尝试检测何时获得 TLS 客户端 hello 或HTTP 请求通过读取前几个字节，然后[将其转换为`SSLSocket`](https://stackoverflow.com/a/6564086/372643).

我不能说我已经尝试过`Socket`s，但是您需要一些东西来提前阅读 TLS Client Hello 并在必要时将其推回，[可能使用 a `PushBackInputStream`，如 EJP 所建议的那样](https://stackoverflow.com/a/11986016/372643)。

（据我所知，Grizzly 使用`SSLEngine`而不是`SSLSocket`为此。）

请注意，使用端口统一是非常不寻常的。我不确定提前阅读的开销是多少。使用多个端口通常不是问题（此外 HTTP 和 HTTPS 具有不同的默认端口，因此您必须至少在两个 URL 之一中指定端口）。

# android - 如何修复 INSTALL_FAILED_CPU_ABI_INCOMPATIBLE 错误？

> ID：15430691
> 
> 赞同：0
> 
> 时间：2013-03-15T11:01:54.317
> 
> 标签：android

我不确定它究竟为什么会导致问题，但是[Datamax Printer SDK](http://www.datamax-oneil.com/do/com/en-us/home/service-support/technical-resources&p=78BF687A-B903-0951-A5DC4C57D04BACE2#SM1) jar 导致 apk 无法在 x86 手机上安装，并出现错误`INSTALL_FAILED_CPU_ABI_INCOMPATIBLE`。

关于此错误还有其他问题，但大多数建议都与使用 NDK 编译的二进制文件有关。

那么，鉴于这不是 NDK 二进制文件的问题，除了向制造商发出错误以进行更新之外，我还能做些什么吗？

# php - NGINX 图像调整大小控制器

> ID：15430692
> 
> 赞同：0
> 
> 时间：2013-03-15T11:01:56.690
> 
> 标签：php, image, nginx

我在使用旧的基于 PHP 的 CMS 配置 nginx 时遇到问题。

PHP 创建这样的 URL。 [http://mysite.com/img/s/58x45/upload/images/gallery/foto/032013/directory/06.jpg](http://mysite.com/img/s/58x45/upload/images/gallery/foto/032013/directory/06.jpg)

其中 img 是控制器，s 是动作，58x45 是尺寸（要裁剪）。

upload/images/gallery/foto/032013/directory/06.jpg 是图片的路径。路径会根据上传文件的目录而改变。

NGINX 正在尝试直接访问图像并给我 404。

我想让控制器/动作处理它。（裁剪/保存/提供图像）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:24:52.247

您可以通过在 nginx 的 server 块中使用 rewrite 来实现：

```
rewrite   ^/img/s/(\d)+x(\d)+/(.)*$ /imageController/imageController.php?width=$1&height=$2&path=$3 last; 
```

这会将其重定向到`/imageController/imageController.php`作为变量传入的宽度、高度和路径的文件。

# mysql - 无法转储远程数据库

> ID：15430697
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:14.610
> 
> 标签：mysql, ruby-on-rails, database, rake

我在 database.yml 文件中有这个数据库配置

```
development:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: oma_development
  pool: 5
  username: root
  password:
  host: localhost

test:
  # same as in development section

production:
  # same as in development section

development_blacklist:
  adapter: mysql2
  encoding: utf8
  database: webstuff
  username: login
  password: password
  host: remote-database.com

test_blacklist:
  adapter: mysql2
  encoding: utf8
  database: webstuff
  username: megas
  password:
  host: /var/run/mysqld/mysqld.sock 
```

我想执行 rake 任务：

```
namespace :db do
  namespace :schema do
    desc 'Dump blacklist database schema'
    task :dump => [:environment, :load_config] do
      filename = "#{Rails.root}/db/blacklist_schema.rb"
      File.open(filename, 'w:utf-8') do |file|
        ActiveRecord::Base.establish_connection("development_blacklist")
        ActiveRecord::SchemaDumper.dump(ActiveRecord::Base.connection, file)
      end
    end
  end
end 
```

通过调用此命令：

```
rake db:schema:dump 
```

我有错误：

```
rake aborted!
Access denied for user 'root'@'localhost' (using password: NO) 
```

所以看起来 rake 任务正在尝试从`development`部分连接到数据库。

我不明白为什么 rake 任务试图连接到`development`数据库，而 rake 任务应该连接到`development_blacklist`数据库。

如何设置 rake 任务以仅连接到`development_blacklist`数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:33:02.677

您可以显式设置环境，例如：

```
$ RAILS_ENV=production rake db:schema:dump 
```

# asp.net - VS以兼容模式启动IE

> ID：15430698
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:22.823
> 
> 标签：asp.net, internet-explorer, debugging, visual-studio-2012

Visual Studio 2012 总是以兼容模式启动 IE。是否可以从 VS 运行 ie10？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T18:01:06.580

您必须单击地址栏中的兼容性图标才能关闭该模式。在调试工具中关闭它不会保存设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T20:03:52.770

我可以在 IE
Goto Internet Options>Advanced>Browsing 中看到一个设置，有一个设置，`Automatically recover from page layout errors with Compatibility`
如果选中，可能会导致 IE 在兼容模式下启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-25T15:08:49.483

不，这是不可能的。[在http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2723548-open-links-in-an-actual-browser](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2723548-open-links-in-an-actual-browser)向开发人员报告的错误请添加您的投票！

另外值得注意的是，内部VS浏览器实际上使用的是IE7兼容渲染引擎，而不是机器安装的IE。

请参阅 Microsoft Connect：[https ://connect.microsoft.com/VisualStudio/feedback/details/591116/visual-web-developer-internal-browser-browser-standard](https://connect.microsoft.com/VisualStudio/feedback/details/591116/visual-web-developer-internal-browser-browser-standard)

# python-2.7 - PasteWSGI 服务器未正确接受 POST 数据。

> ID：15430699
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:22.717
> 
> 标签：python-2.7, paster

我有一个正在运行的 PasteWSGI 服务器。

这是示例 curl 请求，

```
curl -vX POST http://127.0.0.1:5000/save_topology --data '{"topo" : {"A": "asdasdasd"}, "house_id" : "2"}' 
```

服务器端代码片段是，

```
 def save_topology(self):
    from plotwatt.topology import save

    print request.POST

    topo = request.params.get('topo')
    house_id = request.params.get('house_id')

    return 'OK' 
```

日志，

```
MultiDict([(u'{"topo" : {"A": "asdasdasd"}, "house_id" : "2"}', u'')]) 
```

我的问题是如何访问传递的 json，因为它在服务器中？

服务器详情：

```
Server: PasteWSGIServer/0.5 Python/2.7.3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:31:09.197

我正在回答我自己的问题。我需要按原样通过网络发送 json 数据。我做过这样的事情，

```
data = json.loads(urllib.unquote_plus(request.body.strip('='))) 
```

request.body 包含实际数据。

您可能想通过 API 参考[http://docs.webob.org/en/latest/modules/webob.html#request](http://docs.webob.org/en/latest/modules/webob.html#request)

# ios - 使用 Autolayout 设置 UIButton titleEdgeInsets 和 imageEdgeInsets 很慢

> ID：15430700
> 
> 赞同：15
> 
> 时间：2013-03-15T11:02:23.420
> 
> 标签：ios, objective-c, uibutton, uikit, autolayout

我有几个按钮的视图，大小不一。它们都有一个标题和一个图像。我想让图像在顶部，标题在底部，居中。这适用于以下代码：

```
- (void)centerAlignImageAndTextForButton:(UIButton*)button
{
    CGFloat spacing = 5;
    CGSize imageSize = button.imageView.frame.size;
    button.titleEdgeInsets = UIEdgeInsetsMake(0, -imageSize.width, -(imageSize.height + spacing), 0);
    CGSize titleSize = button.titleLabel.frame.size;
    button.imageEdgeInsets = UIEdgeInsetsMake(-(titleSize.height + spacing), 0, 0, -titleSize.width);
} 
```

但是，我注意到在进入这个视图之前有一点停顿。Instruments 中的 Time Profiler 显示，在 viewDidLoad 中花费的 99% 时间是由调用我的按钮方法引起的：

```
283.0ms  -[XViewController viewDidLoad]
282.0ms    -[XViewController centerAlignImageAndTextForButton:]
141.0ms      -[UIButton imageView]
 98.0ms        -[UIView(Hierarchy) layoutBelowIfNeeded]
141.0ms      -[UIButton titleLabel]
103.0ms        -[UIView(Hierarchy) layoutBelowIfNeeded] 
```

各种布局相关的东西被称为 inside `[UIView(Hierarchy) layoutBelowIfNeeded]`， like`[UIView(AdditionalLayoutSupport) recursiveLayoutEngineDidChange]`或`[NSLayoutConstraint addToEngine]`。

我知道可以在 Interface Builder 中设置这些插图，但这不仅是一项繁琐的工作（需要“猜测”文本的宽度）；该应用程序也将被本地化，因此适用于一种语言的插图不会适用于文本大小不同的另一种语言（我对故事板和 .strings 文件使用基本本地化，而不是为每种语言复制整个故事板）。所以对我来说，似乎以编程方式设置插图是要走的路，但它导致的滞后并不是真正可以接受的。

有什么想法可以解决吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T13:38:37.470

将所有`centerAlignImageAndTextForButton`调用从移动`viewDidLoad`到`viewDidLayoutSubviews`将加载时间从之前的 283 毫秒减少到 18 毫秒（1 毫秒`viewDidLoad`和 17 毫秒`viewDidLayoutSubviews`）。

但是，我有点困惑，为什么从`viewDidLoad`...设置这些插图如此昂贵

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-26T08:48:54.663

在自定义子类中对`titleLabel`from的缓慢调用也有类似的问题。由于按钮的大量和/或非平凡的生命周期，将代码移动到视图控制器是不可取的。将代码移动到没有帮助。最终我将代码移到并解决了问题。`awakeFromNib``UIButton``layoutSubviews``didMoveToSuperview`

```
- (void)didMoveToSuperview
{
    [super didMoveToSuperview];
    self.titleLabel.lineBreakMode = NSLineBreakByWordWrapping;
    self.titleLabel.numberOfLines = 2;
    self.titleLabel.textAlignment = NSTextAlignmentCenter;
} 
```

# c# - 使用嵌套类型参数作为顶级类型参数

> ID：15430701
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:27.663
> 
> 标签：c#, generics

以下泛型类型包含`A`两次类型参数：

```
class Something<B<A>, A> 
```

我想知道是否可以只写`class Something<B<A>>`因为`A`已经通过`B<A>`.

我认为这是不可能的，但也许我忽略了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:39:44.423

正式回答这个问题：编译器不能以这种方式推断类型。

# matlab - MATLAB - 在 for 循环中创建可用作矩阵行标签的更改行标题

> ID：15430705
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:32.193
> 
> 标签：matlab, matrix

我正在尝试从 for 循环中的矩阵创建一个表。

我遇到的问题是为每次循环进行时添加新行的行创建一个标签。该代码适用于第一个循环，并且 RLABEL 为第二个循环更新自身，但是当我来打印矩阵时，它说没有足够的行标签。

我只是想知道 MATLAB 是否有一种方法可以读取 RLABEL 中有 2 个行标签，而不必每次都手动输入它们？

以下是我的代码的副本

```
d = 2;           
kij = [1,2];       
uMatrix = zeros(1:2);    
for j=1:d        
     RLABEL(j,:) = ['Row','',int2str(j)]   %Creates Row string that updates itself each loop
     Px = rand                          
     var = (5/12)*d*sum(kij)             
     lam = 1/sqrt(var)                  
     u(j) = ((log(1-Px))/-lam)+kij(1,j)    
     uMatrix(j,1) = j;  
     uMatrix(j,2) = u(j)
     printmat(uMatrix,'Results',RLABEL,'SECTION u' )    
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:15:55.940

行标签需要以空格分隔的单个字符串中。此外，请注意，带有的行`printmat`应该放在循环之外：

```
d = 2;
kij = [1,2];
uMatrix = zeros(1:2);

RLABEL=[];
for j=1:d

    RLABEL= [RLABEL 'Row','',int2str(j) ' '];   %Creates Row string that updates itself each loop

    Px = rand
    var = (5/12)*d*sum(kij)
    lam = 1/sqrt(var)
    u(j) = ((log(1-Px))/-lam)+kij(1,j)

    uMatrix(j,1) = j;

    uMatrix(j,2) = u(j)
end

printmat(uMatrix,'Results',RLABEL,'SECTION u' ) 
```

这导致

```
Results = 
                   SECTION            u
         Row1      1.00000      3.21609
         Row2      2.00000      2.22374 
```

# c# - 自定义 Json.NET 浮点格式

> ID：15430707
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:47.787
> 
> 标签：c#, json, serialization, formatting

我正在使用[Json.NET](http://james.newtonking.com/pages/json-net.aspx)进行对象序列化。我有很多浮点值，所以我的 Json 字符串非常大。我不需要高精度，所以我想知道您是否可以设置自定义浮点格式。例如四舍五入到小数点后两位。

```
3.14159265359 => 3.14 
```

我唯一想到的是`DateFormatHandling`使用`JsonSerializerSettings`. 但没有花车。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:09:55.830

是的，您可以，您需要编写自己的自定义类型转换器。有关自定义转换器的示例，请参见此处：

[如何在 JSON.NET 中实现自定义 JsonConverter 以反序列化基类对象列表？](https://stackoverflow.com/questions/8030538/how-to-implement-custom-jsonconverter-in-json-net-to-deserialize-a-list-of-base)

当您写出您的浮点值时，您只需要对其进行调整以进行四舍五入。

# firefox - SVG：矩形的左行在 Firefox 中不显示

> ID：15430709
> 
> 赞同：0
> 
> 时间：2013-03-15T11:02:58.960
> 
> 标签：firefox, svg

我对 SVG 和 Firefox 有一个小问题。

我的例子：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <head>
   </head>
   <body>
      <div style="margin: auto; position: relative; width: 1264px;">
         <div style="width: 1264px; top: 1px; position: absolute; overflow: hidden; left: 0px; height: 1300px;">
            <div style="left: 0px; position: absolute; top: 0px;">
               <div style="position:absolute;left:0px;top:0px;">
                  <div>
                     <svg:svg style="position: absolute; left: 435px; top: 520px;" width="80" height="60">
                        <svg:g id="rect1103" x="435" y="520" width="80" height="60">
                           <svg:rect x="0" y="0" width="80" height="60" style="fill: white; stroke: black; stroke-width: 1;"/>
                        </svg:g>
                     </svg:svg>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </body>
</html> 
```

在 Firefox 19.0.2 中不显示左行。使用铬，它工作得很好......

这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:30:09.277

您将`<rect>`元素的宽度输入错误，因为 wdith 似乎在更正后显示 OK 就我所见。

如果错字不是您的问题，那么这个问题是您正在显示一条 1px 宽的线，但剪掉了一半（矩形在 0,0 处，所以 1/2 的笔划在矩形内，一半的笔划是外部和笔画的外部部分被剪掉）。

可能的解决方案。

*   将矩形移动到 x="0.5" y="0.5" 并将宽度/高度减少 1，以便整个笔划可见。
*   增加笔触宽度，使矩形内的更多笔触可见。

不，是否显示 1/2 个像素的笔划都不是错误。

# search - sed 在两个特定字符之间打印文本

> ID：15430710
> 
> 赞同：0
> 
> 时间：2013-03-15T11:03:01.110
> 
> 标签：search, sed, character

我有一些播放列表文件的行，并且只想提取文件名并为每一行打印出来：

```
<location>file:///mnt/c3/jtvtes/ww/adw.avi</location>
<location>file:///mnt/c2/clown.mp4</location>
<location>file:///mnt/c2/jtv/video/ww/god.mp3</location> 
```

从这些行我只需要：

```
adw.avi
clown.mp4
god.mp3 
```

所以我尝试提取“/”和“<”字符之间的文本：

```
sed -r 's/^(.*)pat1(.*)pat2(.*)$/\2/g' 
```

修改为：

```
sed -r 's/^(.*)/(.*)<(.*)$/\2/g' 
```

但这不起作用，有人对此有想法/解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:07:00.013

单程：

```
sed -r 's|.*/(.*)</.*|\1|' file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T11:07:14.713

当我想**提取**东西时，`grep`首先出现。

试试这一行：

```
grep -Po "(?<=/)[^/]*(?=<)" file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T21:38:20.177

当它是 XML 时，先做那一点，以避免错误：

```
lxprintf -e location "%s\n" . yourfilename | awk -F '{print $NF}' 
```

这样可以保证您逐行获取文本内容。lxprintf 是来自[http://www.ltg.ed.ac.uk/software/ltxml2](http://www.ltg.ed.ac.uk/software/ltxml2)的 LTxml2 工具包的一部分。然后 awk 会为您提供最后一个以斜线分隔的标记。

如果您需要将其嵌入到常规实用程序不太容易访问或接受的生产工作流程中，请使用 XSLT2：

```
<xsl:template match="location">
  <xsl:value-of select="tokenize(.,'/')[position()=last()]"/>
  <xsl:text>&#xa;</xsl:text>
</xsl:template> 
```

# java - 玩！框架 2.1 - 调度异步任务 (Java)

> ID：15430712
> 
> 赞同：1
> 
> 时间：2013-03-15T11:03:06.217
> 
> 标签：java, akka, playframework-2.1

我刚刚更新了 Play！框架到 2.1 版和 scala 到 2.10 版...

现在我的游戏！应用程序坏了。似乎 Akka API 发生了变化。我找不到现在使用的 Akka 版本，但我认为这是最后一个版本......

我刚刚阅读了迁移指南：[http](http://doc.akka.io/docs/akka/2.1.0/project/migration-guide-2.0.x-2.1.x.html) ://doc.akka.io/docs/akka/2.1.0/project/migration-guide-2.0.x-2.1.x.html 。

我已经相应地更新了我的代码：

```
Akka.system().scheduler().scheduleOnce(
    new FiniteDuration(10, TimeUnit.SECONDS), 
    new MyRunnableJob(), 
    Akka.system().dispatcher()); 
```

但是出现如下错误：

错误：找不到合适的方法`scheduleOnce(akka.util.FiniteDuration,Runnable,ExecutionContext)`

然而，我们在 API 文档中找到了它：

[http://doc.akka.io/api/akka/2.1.1/index.html#akka.actor.Scheduler](http://doc.akka.io/api/akka/2.1.1/index.html#akka.actor.Scheduler)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:02:26.113

Akka 版本应该是 2.1.x，你应该尝试发送一个`scala.concurrent.duration.FiniteDuration`.

似乎您在路径上有一些旧的 akka 罐子，因为`akka.util.FiniteDuration`它们不再存在。

# jquery - 如何在输入令牌（jquery）中发布另一个属性而不是 id

> ID：15430713
> 
> 赞同：0
> 
> 时间：2013-03-15T11:03:08.677
> 
> 标签：jquery, ruby-on-rails

我需要一些关于 Jquery Token 输入的帮助

[http://loopj.com/jquery-tokeninput/](http://loopj.com/jquery-tokeninput/)

基本上我有一个 name 属性，我想发布而不是 ID ，如果数据库中不存在新标签，我还希望用户能够输入新标签。

这意味着将发布的标签的值是逗号分隔的名称字符串，用户可以添加一个新的。

```
$(function() {
  $("#tags").tokenInput("/tags/?filter=1", {
    crossDomain: false,
    preventDuplicates: true,
    prePopulate: $("#tags").data("pre"),
    allowCreation : true,
    queryParam: "term"
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T11:31:09.773

我已经解决了一个问题，即使用此 url github.com/Mean-CJ/jquery-tokeninput/commit/... 中给出的内容添加新标签

```
//$(this).val(""); //Adding these two lines 
 newToken = {'id':$(this).val(),'name':$(this).val()};
 add_token(newToken); 
```

在case KEY.COMMA的else部分：在js文件中

# java - 将 LinkedHashMap 转换为复杂对象

> ID：15430715
> 
> 赞同：84
> 
> 时间：2013-03-15T11:03:12.830
> 
> 标签：java, casting, jackson, linkedhashmap

我有一个应用程序，它使用 Jackson 将一些数据存储在 DynamoDB 中，以将我的复杂对象编组为 JSON。

例如，我正在编组的对象可能如下所示：

```
private String aString;
private List<SomeObject> someObjectList; 
```

SomeObject 可能看起来像这样：

```
private int anInteger;
private SomeOtherObject; 
```

SomeOtherObject 可能如下所示：

```
private long aLong;
private float aFloat; 
```

这很好，对象可以毫无问题地编组并作为 JSON 字符串存储在数据库中。

当需要从 DynamoDB 中检索数据时，Jackson 会自动检索 JSON 并将其转换回来......除了“someObjectList”返回为 a `List<LinkedHashMap>`not as a `List<SomeObject>`！这是杰克逊的标准行为，这不是一个错误。

所以现在这导致了一个问题。我的代码库认为它处理的是 a`List<SomeObject>`但现实是它处理的是 a `List<LinkedHashMap>`！我的问题是如何让我的 LinkedHashMap 回到“SomeObject”中。显然这是一个手动过程，但我的意思是我什至无法提取这些值。

如果我这样做：

```
for (LinkedHashMap lhm : someObjectList) {
    // Convert the values back
} 
```

我收到一个编译错误，告诉我 someObjectList 的类型是“SomeObject”而不是 LinkedHashMap。

如果我这样做：

```
for (SomeObject lhm : someObjectList) {
    // Convert the values back
} 
```

我收到一个运行时错误，告诉我无法将 LinkedHashMap 强制转换为“SomeObject”。

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2013-03-16T18:42:12.503

您可以`ObjectMapper.convertValue()`按值使用，甚至可以对整个列表使用。但是您需要知道要转换为的类型：

```
POJO pojo = mapper.convertValue(singleObject, POJO.class);
// or:
List<POJO> pojos = mapper.convertValue(listOfObjects, new TypeReference<List<POJO>>() { }); 
```

这在功能上与您所做的相同：

```
byte[] json = mapper.writeValueAsBytes(singleObject);
POJO pojo = mapper.readValue(json, POJO.class); 
```

但避免将数据实际序列化为 JSON，而是使用内存中的事件序列作为中间步骤。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-07-16T20:41:19.573

我有类似的问题，我们有包含值列表的 GenericResponse 对象

```
 ResponseEntity<ResponseDTO> responseEntity = restTemplate.exchange(
                redisMatchedDriverUrl,
                HttpMethod.POST,
                requestEntity,
                ResponseDTO.class
        ); 
```

objectMapper 的使用有助于将 LinkedHashMap 转换为相应的 DTO 对象

```
 ObjectMapper mapper = new ObjectMapper();

 List<DriverLocationDTO> driverlocationsList = mapper.convertValue(responseDTO.getData(), new TypeReference<List<DriverLocationDTO>>() { }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-20T09:15:10.460

这个问题有一个很好的解决方案：

```
import com.fasterxml.jackson.databind.ObjectMapper;

ObjectMapper objectMapper = new ObjectMapper();

***DTO premierDriverInfoDTO = objectMapper.convertValue(jsonString, ***DTO.class); 

Map<String, String> map = objectMapper.convertValue(jsonString, Map.class); 
```

为什么会出现这个问题？我猜你在将字符串转换为对象时没有指定具体的类型，对象是一个泛型类型的类，比如User<T>。

也许还有另一种解决方法，使用 Gson 而不是 ObjectMapper。（或参见此处[使用 GSON 反序列化通用类型](https://stackoverflow.com/questions/18397342/deserializing-generic-types-with-gson)）

```
Gson gson = new GsonBuilder().create();

Type type = new TypeToken<BaseResponseDTO<List<PaymentSummaryDTO>>>(){}.getType();

BaseResponseDTO<List<PaymentSummaryDTO>> results = gson.fromJson(jsonString, type);

BigDecimal revenue = results.getResult().get(0).getRevenue(); 
```

# php - 如何重定向到不同的 URL

> ID：15430717
> 
> 赞同：4
> 
> 时间：2013-03-15T11:03:18.777
> 
> 标签：php, .htaccess

我的网站网址是`www.testing.com`，还有另一个网站`www.testing.com/newsite`。

我希望所有点击`www.testing.com/newsite`的人都被重定向到`www.newsite.com`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T11:05:29.360

所以只需在索引页面添加以下行。

```
header("Location: http://www.testing.com", false, 301);
exit; 
```

或者将其写入每个页面中包含的通用文件中。

确保`http://`在标题位置，否则它将寻找目录。

并放在`exit;`最后，这样其他代码就不会执行。

因为发送标头不会终止脚本执行。

--EDIT-- 它应该是 301 让它永远持续下去

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T11:07:08.860

如果您有一个目录`/newsite`，则在该目录中放置一个`.htaccess`：

```
RewriteEngine On
RewriteRule ^.*$ http://www.newsite.com/ [R=301,L] 
```

**但是**，如果您将其定向`newsite.com`到`/newsite`目录中，那么您需要[Sankalp Mishra](https://stackoverflow.com/a/15430790/2119863)在他的回答中所写的内容。（但使用*newsite*而不是*testing*）

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^newsite$ http://www.newsite.com/ [R=301,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:06:13.587

像这样写标题：

```
 header("Location: http://www.testing.com"); 
```

[在http://www.testing.com/newsite](http://www.testing.com/newsite)的主页上

有关[标题的更多信息](http://php.net/manual/en/function.header.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T11:07:16.990

在 htaccess 中使用它

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^newsite.*$ http://www.testing.com/ [R=301,L] 
```

# php - 如何在 Zend Framework 2 中不使用锚标记和表单将值从视图传递到控制器

> ID：15430720
> 
> 赞同：1
> 
> 时间：2013-03-15T11:03:36.123
> 
> 标签：php, zend-framework2

在我的页面中使用了会话，但预期的输出不会出现在我身上。我正在使用 ZendSkeletonApplication 和 ZfcUser

在视图/done.phtml

$sessionContainer = new \Zend\Session\Container('myNameSpace');

$checking="知道了";

$sessionContainer->myVar = $checking;

在 Controller/UserController.php 中

公共函数 doneAction()

```
{
    $result=$this->getRequest()->getPost();
    $sessionContainer = new \Zend\Session\Container('myNameSpace');
    $confirmation=$sessionContainer->myVar;
    print_r($confirmation); 
    return new ViewModel();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T08:56:43.673

据我所知，您不能从视图脚本向控制器发送信息，因为视图是在调用所有控制器-> 操作之后呈现的。

我的建议是不要在您的视图脚本中执行任何逻辑，特别是如果它会改变控制器的执行。这意味着您可以将此逻辑放置在控制器本身中。

带有会话的示例将不起作用，因为如上所述，视图脚本在控制器之后执行，因此如果您从视图脚本在会话中设置某些内容，控制器将不会“知道”它。

希望这可以帮助

# javascript - jQuery 加载更多按钮

> ID：15430724
> 
> 赞同：2
> 
> 时间：2013-03-15T11:03:50.727
> 
> 标签：javascript, jquery, load

我有一些很棒的代码，可以很好地与 Wordpress 配合使用。它基本上向自定义循环添加了一个加载更多按钮，单击时会在下面添加下一批帖子。

我遇到的问题是这行代码取自以下代码段：`error: function() { jQuery('button.load-more').attr('disabled', 'disabled').text('No More Posts') } // Disable the button and change its contents when there are no more posts`

基本上，当没有更多帖子时，按钮不会按照指示被禁用。有人可以帮我解决吗？这是完整的JS：

```
var page = 1;

loadMore = function () {
    page++ //Increments the page number in the request
    $.ajax({
        url: './page/' + page,
        beforeSend: function () {
            $('#wait').show().parent().find('button.load-more').hide();
        },
        complete: function () {
            $('#wait').hide().parent().find('button.load-more').show();
        },
        success: function (data) {
            var $data = $(data).find('article');
            // Replace div#the-posts with the name of your post container
            jQuery('#posts .inner').append($data);
        },
        error: function () {
            jQuery('button.load-more').attr('disabled', 'disabled').text('No More Posts')
        } // Disable the button and change its contents when there arew no more posts

    }); // End Ajax
}; // End loadMore

jQuery('button.load-more').on('click', loadMore); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T12:10:18.210

仅当服务器返回某种错误状态代码时才调用错误函数，这似乎不会发生。

我的猜测是您需要检查响应。以下可以工作：

```
 success: function (data) {
        var $data = $(data).find('article');
        if ($data.length > 0) {  
          // Replace div#the-posts with the name of your post container
          jQuery('#posts .inner').append($data);
        }
        else {
          jQuery('button.load-more').attr('disabled', 'disabled').text('No More Posts');
        }
    }, 
```

但这只是一个猜测，因为我不知道响应的样子。

# 3d - Wavefront OBJ 中人脸元素的排序

> ID：15430727
> 
> 赞同：0
> 
> 时间：2013-03-15T11:03:55.740
> 
> 标签：3d, wavefront

我想了解 OBJ 文件的结构。

面部元素是否有特定的顺序？各种消息来源暗示它通常以允许更直接渲染的顺序保存，但没有明确的答案。该规范似乎也没有提及它。这是否意味着顺序是任意的并且由解析器来处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:57:52.937

我不知道 OBJ 文件格式中有任何这样的“提示”。

我可以根据经验告诉你，它们*通常*是按顶点索引递增的顺序排列的，这对内存访问局部性很有好处，但同样，并不要求一定是这种情况。

# codeigniter - 在 codeigniter 中从类 CI_Controller 加载不同的语言

> ID：15430734
> 
> 赞同：3
> 
> 时间：2013-03-15T11:04:21.373
> 
> 标签：codeigniter

我正在开发多语言网站。我在 CI_Controller 类文件中编写了以下代码，这样我就不必将语言加载到每个控制器文件中。

```
$this->lang->load('english'); 
```

问题是当我必须更改其他语言时，例如：让我们说西班牙语。

```
$this->lang->load('spanish'); 
```

当我从菜单选项中选择语言 > 英语/西班牙语时，如何在这两种语言之间加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T04:41:14.257

**检查和加载**

将此代码放在控制器中`constructor`

```
 $this->load->library('session');
 $lang= $this->session->userdata('language');

if($lang != ''){
    switch($lang){
        case    'en'    :   
            $this->lang->load('english', 'english');
            break;
        case    'sp'    :   
            $this->lang->load('spanish', 'spanish');
            break;
    }
} 
```

**设置语言**

将此代码放置在您设置`lang`

```
$this->session->set_userdata('language', '<set english or spanish>') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-24T02:07:30.530

如果您在 codeigniter 中安装了任何应用程序，或者您正在制作 1 并且您想添加一些语言包，只需按照以下步骤操作：
1：在文件夹 application/language/arabic 中添加语言文件（我在 codeigniter 内置的股票管理器中添加阿拉伯语语言)
2: 转到 application/modules/settings/views/setting.php 中名为 setting.php 的文件，在这里你找到数组

```
<?php /*

 $lang = array (
  'english' => 'English',

  'arabic' => 'Arabic',  // i add this here

  'spanish' => 'Español' 
```

现在保存并运行应用程序，它工作正常

# asp.net - 如何将控制权从 $.post 函数传递给控制器 ？

> ID：15430735
> 
> 赞同：0
> 
> 时间：2013-03-15T11:04:29.577
> 
> 标签：asp.net, asp.net-mvc

我正在开发一个 MVC 应用程序，但下面的代码有一些问题：

```
function create(box) {
       var box = dhtmlx.modalbox({
       title: "New PDF Document",
       text: "<div id='form_in_box'><div>Create a new PDF Documnet<hr /><label>Page Count:   <select name='pagecount'><option>1</option><option>2</option></select><label>Page Size:   <select><option>Letter</option><option>A4</option></select></label><span class='dhtmlx_button'><input type='button' value='Create' style='width: 86px' onclick='create_file(this)'></span><span class='dhtmlx_button'><input type='button' value='Cancel' onclick='close_file(this)' style='width:80px;'></span></label></div>",
       width: "300px"
       });  

function create_file(box) {
      $.post("/FileUpload/CreatePDFile.aspx"); 
```

每当用户单击创建按钮时，应该会出现“创建 PDF”页面。上面的代码适用于取消按钮，但不适用于创建按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:25:18.977

jQuery`post`函数将表单发布到传入的 URL（*通过 AJAX*），但不会将浏览器重定向到新文件。**你说'应该出现**“创建 PDF”页面'。

该`post`功能不会显示新页面。

如果您必须将表单数据发送回 createPDFile.aspx 文件，您应该将输入字段包装在表单中。将表单操作设置为 /FileUpload/CreatePDFile.aspx 页面，并`$("#formname").submit()`在 create_file 函数中提交表单（通过函数）。

请参阅： [jQuery.post()](http://api.jquery.com/jQuery.post/)，[jQuery.submit()](http://api.jquery.com/submit/)

# java - 从间接 URL 下载文件

> ID：15430736
> 
> 赞同：-8
> 
> 时间：2013-03-15T11:04:31.583
> 
> 标签：java, download

我正在开发一个从给定 URL 下载文件的 Java 程序。它非常适合直接链接，例如：

```
http://cdn.muvee.com/downloads/muveeRevealX_10.5.0.23245_2760.exe?AWSAccessKeyId=1026JPYBE0QTTK67WVG2&Expires=1363299511&Signature=ROKk0Jav1Jw5HGU4fcBs6ADhPqI%3D&Extension=.exe 
```

但不适用于间接链接，例如：

```
http://www.youtube.com/watch?v=8BvmqPymyfY&list=PL6EE0CD02910E57B8 
```

Youtube 链接程序的输出是：-

```
Fri Mar 15 16:30:48 IST 2013
Content-Type = text/html; charset=utf-8
Content-Disposition = null
Content-Length = -1
fileName = watch?v=8BvmqPymyfY&list=PL6EE0CD02910E57B8
java.io.FileNotFoundException: E:\watch?v=8BvmqPymyfY&list=PL6EE0CD02910E57B8 (The filename, directory name, or volume label syntax is incorrect)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:212)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:104)
    at HttpDownloadUtility.downloadFile(HttpDownloadUtility.java:62)
    at HttpDownloader.main(HttpDownloader.java:14) 
```

HttpDownloadUtility.java 的代码：

```
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;

public class HttpDownloadUtility {

    private static final int BUFFER_SIZE = 4096;

    public static void downloadFile(String fileURL, String saveDir)
            throws IOException {
        URL url = new URL(fileURL);
        HttpURLConnection httpConn = (HttpURLConnection) url.openConnection();
        int responseCode = httpConn.getResponseCode();
        httpConn.connect();
        // always check HTTP response code first
        if (responseCode == HttpURLConnection.HTTP_OK) {
            String fileName = "";
            String disposition = httpConn.getHeaderField("Content-Disposition");
            String contentType = httpConn.getContentType();
            int contentLength = httpConn.getContentLength();

            if (disposition != null) {
                // extracts file name from header field
                int index = disposition.indexOf("filename=");
                if (index > 0) {
                    fileName = disposition.substring(index + 10,
                            disposition.length() - 1);
                }
            } else {
                // extracts file name from URL
                fileName = fileURL.substring(fileURL.lastIndexOf("/") + 1,
                        fileURL.length());
            }

            System.out.println("Content-Type = " + contentType);
            System.out.println("Content-Disposition = " + disposition);
            System.out.println("Content-Length = " + contentLength);
            System.out.println("fileName = " + fileName);

            // opens input stream from the HTTP connection
            InputStream inputStream = httpConn.getInputStream();
            String saveFilePath = saveDir + File.separator + fileName;

            // opens an output stream to save into file
            FileOutputStream outputStream = new FileOutputStream(saveFilePath);

            int bytesRead = -1;
            byte[] buffer = new byte[BUFFER_SIZE];
            while ((bytesRead = inputStream.read(buffer)) != -1) {
                outputStream.write(buffer, 0, bytesRead);
            }

            outputStream.close();
            inputStream.close();

            System.out.println("File downloaded");
        } else {
            System.out.println("No file to download. Server replied HTTP code: " + responseCode);
        }
        httpConn.disconnect();
    }
} 
```

主文件：HttpDownload.java：

```
import java.io.IOException;
import java.util.Date;

public class HttpDownloader {

    public static void main(String[] args) {
        String fileURL = "http://www.youtube.com/watch?v=8BvmqPymyfY&list=PL6EE0CD02910E57B8";
        String saveDir = "E:/";
        try {
            System.out.println(new Date().toString());

            HttpDownloadUtility.downloadFile(fileURL, saveDir);
            System.out.println(new Date().toString());
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:10:24.083

您不能简单地下载 youtube 中的文件。当您查看您使用的 URL 时，您可以看到它所使用的 url 以文件扩展名结尾，即它们是直接链接，该 url 直接指向文件。如果您必须从间接链接（例如 youtube）下载它，您必须先获取内容，然后才能保存它。据我所知，在 youtube 中，Flash 播放器直接获取视频流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-05T15:49:51.697

我遇到了同样的问题，所以问题是，您需要将扩展​​名添加到视频中，因为：

```
downloadFile(String fileURL, String saveDir) 
```

我将其覆盖为

```
downloadFile(String fileURL, String saveDir, String name) 
```

然后在

```
// extracts file name from header field
                ......
                int index = disposition.indexOf("filename=");
                if (index > 0) {
                    fileName = disposition.substring(index + 10,
                            disposition.length() - 1); 
```

替换为

```
String fileName =name+".mp4"; 
```

但它仅适用于特定服务器，我已经从 .com 服务器下载，但 youtube.com 或 *.in 无法正常工作

试试这样

# operating-system - 如何在 Eclipse IDE 上执行示例 rtems 程序？

> ID：15430738
> 
> 赞同：0
> 
> 时间：2013-03-15T11:04:35.867
> 
> 标签：operating-system, real-time, rtos, real-time-systems, rtems

我在 Eclipse 平台上安装了 rtems、mingw、msys、grmon 并在环境变量中指定了路径。我尝试执行给定的示例 rtems 程序，但它显示一个错误 * 启动 rtems 遇到问题 * 错误说明进程无法运行程序和“C:\workspace\rtems\debug\rtems”：启动失败。还有一个问题是：rtems 会生成一个可执行文件吗？还告诉我在windows xp平台上安装和运行rtems程序的过程？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T01:20:44.070

RTEMS仿真环境：[http](http://www.rtems.org/wiki/index.php/RTEMS_on_Virtualbox) ://www.rtems.org/wiki/index.php/RTEMS_on_Virtualbox 。这个站点是设置 RTEMS 开发环境的一个很好的起点。

很快，从[https://www.virtualbox.org/安装 virtualbox 程序，从](https://www.virtualbox.org/)[http://www.rtems.org/wiki/index.php/RTEMS_on_Virtualbox](http://www.rtems.org/wiki/index.php/RTEMS_on_Virtualbox)下载镜像并从 virtualbox 启动这个镜像，RTEMS 开发环境将是已安装此映像，包括编辑器、编译器、模拟器等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-16T16:07:36.633

首先，我建议为 Eclipse 安装 RTEMS 插件

[https://devel.rtems.org/wiki/Developer/Eclipse/Plugin](https://devel.rtems.org/wiki/Developer/Eclipse/Plugin)

第二：您需要知道目标以向编译器提供正确的 -qspec。提供给编译器的选项取决于您使用的 RTEMS 包。

第三：Eclipse 会生成一个 .EXE 文件，GRMON 和 GDB 都可以使用。您还可以使用 Eclipse 调试器，它将使用 GDB 连接到 GRMON。

请记住将初始断点设置为“Init”而不是 main，并使用“-gdb”调用 GRMON 并且不使用“-ni”选项。

# c++ - 使用模板c ++对某个类中的方法的未定义引用

> ID：15430739
> 
> 赞同：0
> 
> 时间：2013-03-15T11:04:36.083
> 
> 标签：c++, templates, makefile, undefined-reference

我有一个名为 SomeClass 的类，带有一个模板

某类.hpp

```
template<typename T>
SomeClass 
{    
public:    
   SomeClass(T& it, int a): t(it), b(a) {
      CallMethod();    
}

static void PrintSomething() {
    std::cout << "static method in SomeClass" <<std::endl;
}

private:
T& t;
int b;
void CallMethod();
} 
```

方法在 someclass.cpp 中定义

```
void SomeClass<T>::Callmethod() {
   t.SomeMethod();
} 
```

现在，在 main.cpp 中，我有，

```
T t;
t.SomeMethod(); //no error
SomeClass<T>::PrintSomething(); //call only this static method, it works

SomeClass<T> SomeClass(t, 2); //error 
```

错误是对构造函数内部调用的所有方法的未定义引用。以及对析构函数的未定义引用。这仅当我实例化一个对象时。没问题我从类中调用静态方法。我已经在 Make 中包含了目标文件。

我的生成文件。

```
OBJECTS = \
    src/main.o \
    Src/someclass.o \

sys: $(OBJECTS)
    $(CXX) $(CXXFLAGS) -o sys $(OBJECTS) $(LIB) 
```

有什么明显的错误吗？帮助表示赞赏。

# c++ - 我的解决方案有什么问题？

> ID：15430744
> 
> 赞同：0
> 
> 时间：2013-03-15T11:04:51.643
> 
> 标签：c++, operator-overloading, assignment-operator

*这是从我的母语翻译过来的。* 你有一堂课：

```
class Boo : public SuperBoo {
  Foo* fFoo1;
  Foo* fFoo2;
} 
```

其中 Foo - 单态类和 Boo 拥有指针 fFoo1、fFoo2。
Boo 的重载分配运算符。

我的解决方案是：

```
class Foo
{
public:
    Foo()
    {}
};

class SuperBoo
{
public:
    virtual ~SuperBoo()
    {}
};

class Boo : public SuperBoo
{
public:
    Boo(const int f1_id, const int f2_id)
    {
        f1 = new Foo(f1_id);
        f2 = new Foo(f2_id);
    }
    ~Boo()
    {
        delete f1;
        delete f2;
    }
    /* C++11 only
    Boo(Boo&& other)
    {
        std::swap(*this, other);
    }
    */
    Boo(const Boo& other)
    {
        f1 = new Foo(*(other.f1));
        f2 = new Foo(*(other.f2));
    }
    Boo& operator=(Boo other)
    {
        std::swap(f1, other.f1);
        std::swap(f2, other.f2);
        return *this;
    }
private:
    Foo* f1;
    Foo* f2;
}; 
```

但雇主不喜欢它。这里有什么问题？感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:24:01.907

构造函数可以重写为：

```
Boo(const int f1_id, const int f2_id)
{
    std::unique_ptr<Foo> pf1 = new Foo(f1_id);
    f2 = new Foo(f2_id);

    f1 = pf1.release();
} 
```

这样如果 f2 构造函数抛出，f1 就不会被泄露。

顺便说一句，复制构造函数应该遵循相同的规则。

# kendo-ui - 具有函数的派生成员时，Kendo UI Databound 对象未更新

> ID：15430748
> 
> 赞同：1
> 
> 时间：2013-03-15T11:05:25.723
> 
> 标签：kendo-ui

我有一个 observable，它有两个派生成员，这两个派生成员又使用一个函数来操作主数据中的值。简单的函数，做一些字符串操作。

首次加载并绑定到 DOM 片段时，一切正常，但如果我随后更新值，派生值不会改变。

```
//mvvm
window.userdata = kendo.observable({
    user: null,
    miniavatar: function () { return getAvatarUriWithRadius(this.get('user.AvatarPublicId'), 36); },
});

//first bind which works
$.post('Account/GetUser', {}, function(response) {
    window.userdata.set('user', response.Data);

    //bind the notifications and overduetasks
    kendo.bind($('#top'), window.userdata.user);

});

//DOM
<div id="top">
    <div id="latesthig" class="floatright">
        <div data-bind="attr:{class:latesthigclass}"></div>
    </div>
    <div class="button floatright"><a id="search" href="#"></a></div>

    <span class="button" id="addnote" title="add note"><span></span></span>
    <span data-bind="text:miniavatar"></span>

    <div id="messages"></div>

</div> 
```

值的后续更改不会更改来自 miniavatar 派生成员的文本

```
window.userdata.set('user.AvatarPublicId', value); 
```

有什么想法吗？某个地方的愚蠢错误？TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:42:51.730

您正在绑定到可观察对象的`User`子属性，而不是可观察对象本身。

更改绑定代码以绑定到可观察对象：

```
kendo.bind($('#top'), window.userdata); 
```

# html - 使我的移动 html 全屏

> ID：15430751
> 
> 赞同：0
> 
> 时间：2013-03-15T11:05:31.597
> 
> 标签：html, css, mobile, webview

所以我想在 webview (Android) 中显示[这个](http://www.moma-soft.es/avalanche/forecast/)网站，它工作正常，但我不知道为什么它没有全屏显示。我认为css一定有问题，但我找不到它。这是我在手机中看到的截图。我希望背景占据整个屏幕。这可能吗？

![在此处输入图像描述](../Images/907db6aae522e6044b5f7dbabef01d9e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:10:32.723

您的“default.css”中有一个填充。删除第 704 行。

```
@media all and (max-width: 960px){
    .center{
        width:auto;
    }
    ...
} 
```

如果你想要一个全屏表格，你需要`position: absolute`在`height: 100%`我们的`.tablatop`.

```
.tablatop { //remember to put this style rule in your respective @media-query!!!
    position: absolute;
    height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:11:21.357

div（在媒体查询中）有填充（`padding: 0 10px;`），这就是它占用空间的原因，删除它

```
@media (max-width: 960px)
.center {
padding: 0; 
width: auto;
} 
```

检查屏幕截图

![在此处输入图像描述](../Images/5e1eb5afc753361405f86e2b0eb260b8.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T11:11:38.467

不确定webview，但试试这个：

```
body,html{
    width:100%;
    height:100%;
    padding:0px;
    margin:0px;
    /*optional but incase it still doesn't work.*/
    min-width:100%;
    min-height:100%;
    /*further optional still incase elements case overflows*/
    max-width:100%;
    max-height:100;
    overflow:scroll;/*or hidden*/ 
```

要进一步定位此设备，请使用如下媒体查询：

```
@media only screen and(max-device-width:(deviceWidthHere))and(max-device-height:(deviceHeightHere)){
    /*CSS here*/
    /*second 'and' clause is not necessarily necessary. lol*/
} 
```

# c# - 更新面板无法正常工作

> ID：15430752
> 
> 赞同：1
> 
> 时间：2013-03-15T11:05:34.180
> 
> 标签：c#, asp.net, updatepanel

我有一个只读`TextBox`和一个编辑按钮。当我单击该按钮时，`textbox`应该是可读的并且应该出现“保存”按钮。这发生得很完美，但整个页面一直在重新加载。我用过`UpdatePanel`但什么也没发生。有人可以帮我解决我的问题吗？提前致谢。

**ASPX**：

```
 <asp:ScriptManager ID="ScriptManager1" runat="server">
            </asp:ScriptManager>
            <asp:UpdatePanel ID="UpdatePanel1" runat="server" updatemode="Conditional">
            <Triggers>
            <asp:AsyncPostBackTrigger controlid="edit" eventname="Click" />
            </Triggers>
            <ContentTemplate>

                   <asp:TextBox ID="q" runat="server" ReadOnly style="width:90%" 
                       BackColor="#CCCCCC" BorderStyle="None" Rows="5" TextMode="MultiLine"></asp:TextBox>
                   <asp:Button ID="edit" class="button3"  style="float:right"  
                       runat="server" Text="Edit" onclick="editqellim_Click"  />
                    <asp:Button ID="save"  class="button3"  style="float:right" runat="server" 
                       Text="Save" onclick="Button1_Click" Visible="False" />
                 </ContentTemplate>
                </asp:UpdatePanel> 
```

**后面的代码**：

```
protected void editqellim_Click(object sender, EventArgs e)
    {
        q.ReadOnly = false;
        q.BackColor = Color.White;
        save.Visible = true;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T15:01:36.637

我敢打赌，页面上有一个糟糕的 javascript 错误，它破坏了 Microsoft 用于 UpdatePanel 的 javascript。如果您在显示开发人员控制台的情况下加载页面，您是否会在加载时立即收到任何 javascript 错误？也许会杀死页面上的javascript？或者当您单击按钮时出现任何 javascript 错误？

如果是这样，我敢打赌，该错误正在杀死 AJAX 的东西，将按钮保留为常规提交按钮，它像没有 UpdatePanel 一样提交表单。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T11:14:20.757

更改`UpdateMode="Conditional"`为`UpdateMode="Always"`

# wpf - 从 xaml 填充集合属性而无需指定属性元素

> ID：15430753
> 
> 赞同：0
> 
> 时间：2013-03-15T11:05:34.490
> 
> 标签：wpf, xaml, datatemplateselector

我有一个标记扩展

```
public class DataTemplates : Dictionary<object, DataTemplate>{}

[MarkupExtensionReturnType(typeof(DataTemplateSelector))]
[ContentProperty("DataTemplatesDictionary")]
public class TemplateSelectorExtension : MarkupExtension
{
  //...
  public DataTemplates DataTemplatesDictionary { get; set; }

  public override object ProvideValue(IServiceProvider serviceProvider)
  {
    if (DataTemplatesDictionary == null) throw new ArgumentException();
    // some logic
  }
} 
```

在 xaml 中使用它

```
<TabControl.ItemTemplateSelector>
  <GUI:TemplateSelector>
    <GUI:DataTemplates> <!-- How do I avoid this element???-->

      <DataTemplate ....>
      </DataTemplate>
      <DataTemplate ....>
      </DataTemplate>

    </GUI:DataTemplates>
  </GUI:TemplateSelector>
</TabControl.ItemTemplateSelector> 
```

问题是：是否可以避免“GUI：DataTemplates”元素编写一些 TypeConverter 或其他方式？

谢谢！

**更新：**我找到了[MSDN 文章](http://msdn.microsoft.com/en-us/library/vstudio/ms753379%28v=vs.90%29.aspx#Collection_Properties)，它指出我的示例应该在没有“GUI：DataTemplates”的情况下工作得很好，但它没有:(互联网上的许多文章也一样。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T16:08:02.713

问题是您使用的 Dictionary 会让您陷入两个相互冲突的要求之间。`<GUI:DataTemplates>`您删除了代码的一些关键部分，所以我只是猜测还有什么，但是使用分解语法`x:Key`(字典中的键。

回退到 ContentProperty 用法虽然您仍然需要为每个字典项分配一个键，但 XAML 不允许您`x:Key`在字典之外声明并且无法识别 MarkupExtension 使用的隐含项。您也不能完全关闭 DataTemplate 键，因为 Dictionary 没有键。在这种情况下，您可以使用`DataType`属性，但由于每种类型只能有一个属性，因此您最好不要使用选择器，而是将它们放在 TabControl 的资源中，并让隐式类型自动处理模板。

如果您可以切换到使用普通集合而不是字典并根据索引或类似的东西进行选择，您将能够去除额外的元素，但考虑到您尝试删除的 XAML 数量最少，我只想忍受它。

# javascript - 克隆元素的子元素和文本

> ID：15430754
> 
> 赞同：2
> 
> 时间：2013-03-15T11:05:35.193
> 
> 标签：javascript, jquery, html, dom

最好的情况是我遇到了以下情况，我需要克隆一个元素的内容以及所有附加的事件，这只有我不能用它克隆文本，就像这个[小提琴](http://jsfiddle.net/EaterOfCode/QPMjH/1/)中所示：

HTML：

```
<div class="source">Say bye bye, little text!
    <span class="stay">I'm gonna clone!</span>
More text
</div>

<div class="destination">

</div>

<button>Clone!</button> 
```

JS：

```
$('button').click(function(){
    $('.source').children().clone(true,true).appendTo($('.destination'));
}); 
```

我怎样才能让它工作？文本也被克隆而不克隆目标中的父容器或更改 html 输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:07:35.753

```
$('.source').clone(true,true).appendTo($('.destination')); 
```

您目前正在克隆一个子节点，它是`<span>`

upd：或者您可以将对象的 html 附加到另一个对象：

```
$('.destination').append($('.source').html()); 
```

**upd2**：由于您克隆的是用户输入，并且您有某种包含整个输入的字符串，因此您将其附加到 .source 为：

```
$(".source").append('<span id="some_id">' + user_input + '</span>'); 
```

并克隆它：

```
$(".source").find("#some_id").clone(true,true).appendTo($('.destination')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:10:46.873

你现在只克隆孩子。我建议你用 span 包装内容。检查这个更新的小提琴：http: [//jsfiddle.net/QPMjH/3/](http://jsfiddle.net/QPMjH/3/)

```
$('button').click(function(){
    var $clonedSource = $('.source').clone(true);
    $clonedSource.wrapInner('<span>');
    $clonedSource.children().clone(true,true).appendTo($('.destination'));
}); 
```

或仅在一行中：

```
$('button').click(function(){
    $('.source').clone(true).wrapInner('<span>').children().clone(true,true).appendTo($('.destination'));
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T11:42:44.157

如果`.source`是父类，那么试试这个。

```
$('.destination').append(
    $('.source').clone( true )
).find('.source').contents().unwrap(); 
```

# mesh - 柏拉图式（阿基米德）实体的 3d 点到面的映射

> ID：15430757
> 
> 赞同：0
> 
> 时间：2013-03-15T11:05:43.123
> 
> 标签：mesh, surface, cgal, voxel

我想计算得到的柏拉图（或者可能是阿基米德）实体的表面网格，并为每个面应用置换贴图。网格应显示位移图的精细细节，并且是水密和多方面的（用于 3D 打印）。

[![](../Images/5287f3ffae909329b6c44d9ad65f35e4.png)](https://i.stack.imgur.com/P5DEM.jpg)

为此，我考虑过使用 CGAL 隐式函数 3d 曲面网格划分器。然后，我会将每个体素点映射到相应的面部，应用从体素空间到面部的坐标系变换，并查找面部的高度场。我知道如何为每个面构建变换矩阵，所以我想到了以下算法来测试实体中是否包含体素：

1.  找到离点A最近的人脸
    *   对于给定的点 A，通过迭代所有顶点并比较与 A 的距离，找到柏拉图式（阿基米德）实体的 3 个最近顶点
    *   根据顶点数组中最小的索引对3个顶点进行排序
    *   从顶点索引中构建一个整数（字典索引）： (v[0] *n* n+v[1]*n+v[3]*1) 其中 n 是顶点的数量
    *   迭代一个元组数组（字典索引，人脸）并找到具有相同字典索引的人脸
2.  每个面都有一个预先计算的变换矩阵和一个高度场。应用变换矩阵并查找高度场以了解 A 是在实体内部还是外部

我想存在更好的解决方案，尤其是寻找合适的面孔？另一种方法可能是不使用表面网格器，而是从面中构建表面：获取每个面的位移图并将变换矩阵应用于它以构建实体，但是我需要简化每个面网格并将它们合并不知何故，结果是水密和多方面的（如果置换贴图具有某些值，则面应该支持孔），所以我认为具有隐式函数的基于体素的方法是最通用的工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T11:33:19.310

基于体素的方法并不成功：对于许多伪像，对于低分辨率。最后我创建了 2d 高度图，对它们应用简化算法，然后将它们投影到实体的面上，最后通过自定义算法将面网格合并为一个网格。

# templates - Django：找不到模板文件。/ 应用程序没有模板文件可以工作吗？

> ID：15430760
> 
> 赞同：0
> 
> 时间：2013-03-15T11:05:55.600
> 
> 标签：templates, python-2.7, shared-hosting, django-1.4

昨天我试图在我的 django 应用程序中编辑一个模板，并注意到模板文件甚至没有被使用（不再）。即使我将其删除，该应用程序仍将继续工作，并且我在文件中所做的更改也不会在线显示。我在我的服务器上找不到任何其他模板文件，那么是 Django 以某种方式导入它还是将它复制/保存到其他地方？

该应用程序托管在共享主机上，使用 Python2.7、Django 1.4.5 和 FCGI。

我的 settings.py 看起来像这样：

```
# Hosts/domain names that are valid for this site; required if DEBUG is False
# See https://docs.djangoproject.com/en/1.4/ref/settings/#allowed-hosts
ALLOWED_HOSTS = ['*']

#FORCE_SCRIPT_NAME = '/polls'

# Local time zone for this installation. Choices can be found here:
# http://en.wikipedia.org/wiki/List_of_tz_zones_by_name
# although not all choices may be available on all operating systems.
# In a Windows environment this must be set to your system time zone.
TIME_ZONE = 'Europe/Berlin'

# Language code for this installation. All choices can be found here:
# http://www.i18nguy.com/unicode/language-identifiers.html
LANGUAGE_CODE = 'de-de'

SITE_ID = 1

# If you set this to False, Django will make some optimizations so as not
# to load the internationalization machinery.
USE_I18N = True

# If you set this to False, Django will not format dates, numbers and
# calendars according to the current locale.
USE_L10N = True

# If you set this to False, Django will not use timezone-aware datetimes.
USE_TZ = True

# Absolute filesystem path to the directory that will hold user-uploaded files.
# Example: "/home/media/media.lawrence.com/media/"
MEDIA_ROOT = ''

# URL that handles the media served from MEDIA_ROOT. Make sure to use a
# trailing slash.
# Examples: "http://media.lawrence.com/media/", "http://example.com/media/"
MEDIA_URL = ''

# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
STATIC_ROOT = 'http://ulli.cepheus.uberspace.de/static/'

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = 'http://ulli.cepheus.uberspace.de/static/'

# Additional locations of static files
STATICFILES_DIRS = (
    "/var/www/virtual/ulli/html/static",
    # Put strings here, like "/home/html/static" or "C:/www/django/static".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
)

# List of finder classes that know how to find static files in
# various locations.
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
#    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

# List of callables that know how to import templates from various sources.
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
#     'django.template.loaders.eggs.Loader',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
)

ROOT_URLCONF = 'mysite.urls'

# Python dotted path to the WSGI application used by Django's runserver.
WSGI_APPLICATION = 'mysite.wsgi.application'

TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    "/template",
    "/template/polls",
    "/var/www/virtual/ulli/html/template/polls",
    "http://ulli.cepheus.uberspace.de/template",
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
    'polls',
)

# A sample logging configuration. The only tangible logging
# performed by this configuration is to send an email to
# the site admins on every HTTP 500 error when DEBUG=False.
# See http://docs.djangoproject.com/en/dev/topics/logging for
# more details on how to customize your logging configuration.
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'filters': {
        'require_debug_false': {
            '()': 'django.utils.log.RequireDebugFalse'
        }
    },
    'handlers': {
        'mail_admins': {
            'level': 'ERROR',
            'filters': ['require_debug_false'],
            'class': 'django.utils.log.AdminEmailHandler'
        }
    },
    'loggers': {
        'django.request': {
            'handlers': ['mail_admins'],
            'level': 'ERROR',
            'propagate': True,
        },
    }
} 
```

谢谢您的帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T21:16:49.463

只是猜测，但模板[可能已缓存](https://docs.djangoproject.com/en/dev/ref/templates/api/#django.template.loaders.cached.Loader)。

虽然，我在您的设置中没有看到这个缓存的加载程序。无论如何可能值得尝试重新启动？

# sql - 在sql中连接多行

> ID：15430761
> 
> 赞同：-2
> 
> 时间：2013-03-15T11:05:55.890
> 
> 标签：sql, sql-server, sql-server-2008

我有一张这样的桌子

```
id    data
1     note1
1     note2
3     note6
3     note8 
```

当我从该表中选择数据时，我想将数据列值连接起来，例如

```
select data 
from table 
where id = 1 --(this query is just for demonstration ) 
```

需要给出类似的输出

```
note1+note2 
```

有什么办法可以做到这一点？

注意：我曾尝试使用 COALESCE（我从 Vishal 获得），但它也无法正常工作。这就是我的实际查询现在的样子

```
 declare @var1 varchar(200)

SELECT     dbo.kt_missingdataview.Varenummer, dbo.kt_missingdataview.Varenavn, dbo.kt_missingdataview.Producentvarenummer,
                          (SELECT     dbo.ETEXT.TXT1
                            WHERE      (dbo.ETEXT.ID = 1)) AS shortdesc,
                            (SELECT @var1 = COALESCE(@var1 + '+', '') +  dbo.ETEXT.TXT1 from dbo.ETEXT 
Select @var1),
                          (SELECT     dbo.ETEXT.TXT1
                            WHERE      (dbo.ETEXT.ID = 2)) AS longdesc, dbo.ETEXT.REFKEY, dbo.ETEXT.ID
FROM         dbo.kt_missingdataview INNER JOIN
                      dbo.ETEXT ON dbo.kt_missingdataview.Varenummer = dbo.ETEXT.REFKEY
WHERE     (dbo.ETEXT.ELANGUAGE = 0) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:13:21.703

对于 SQL Server，您可以使用[COALESCE](http://msdn.microsoft.com/en-IN/library/ms190349.aspx)

```
declare @var1 varchar(200)
SELECT @var1 = COALESCE(@var1 + '+', '') +  data from the_table where id = 1
Select @var1 
```

输出：`note1+note2`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:09:50.783

您没有指定 DBMS，所以我假设 Postgres：

```
select id, string_agg(data, '+')
from the_table
group by id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T11:14:07.957

在 MySQL 中，使用[GROUP_CONCAT 函数](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)。

```
SELECT id, group_concat(data)
FROM TABLENAME 
WHERE ID=1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T11:21:54.700

在 SQL Server 中，您可以使用`FOR XML PATH`来获取结果：

```
select distinct t1.id,
  STUFF((SELECT distinct '+ ' + t2.data
         from yourtable t2
         where t1.id = t2.id
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,2,'') data
from yourtable t1; 
```

# html - 小数字体大小html5画布？

> ID：15430763
> 
> 赞同：10
> 
> 时间：2013-03-15T11:06:03.803
> 
> 标签：html, animation, canvas, fonts, scale

我对不同浏览器如何在 HTML5 Canvas 上呈现字体大小有疑问。特别是在字体大小不是整数的情况下。例如“8.5px Arial”、“2.23em Arial”等。

对于 canvas.font= FontSize + "px Arial"; 其中 FontSize 是 (8.1, 8.2, 8.3, ...) 我希望得到线性结果，但是唯一始终存档的浏览器是 IE ！（ 我知道 ）。Firefox 四舍五入低于 11.2 像素，但超出此范围是线性的。Chrome 和 Safari 仅将字体缩放为整数值。

舍入规则似乎设置为像素并向下舍入到 0.5 以下最接近的整数

我的画布应用程序正在执行一些程序化动画转换（缩放和翻译）为了提高效率而尝试避免画布转换，尽管我怀疑它会解决问题，但我也没有通过仅使用 CSS3 设置 html 文本大小来测试这一点（即Canvas.font 应该基于规范）

浏览器在 pt、px、em 和 % 字体大小之间的行为至少是一致的。[编辑：除了 Safari 不呈现 % 大小]

[顺便说一句：所有字体一旦放大一点就会看起来有点粗体。当我们从 17.4px 到 17.5px .. BAMB 时，Safari 会拿走那个蛋糕！]

我在下面附上了一些示例图片，但我真的很想了解如何让所有浏览器更像 IE（我从来没想过我会这么说） - 这是一个错误还是渲染字体的标准？

这是我的测试代码，可以为 PX 字体大小的情况复制。

```
<!DOCTYPE html><html><head><script>
function display() {
    var canvas = document.getElementById('test');
    // For EM and % cases....
    //canvas.style.font="5px Arial";
    canvas.height = 1000;
    var context = canvas.getContext('2d');
    var minSize = 10;
    var lineHeight = 100;
    for(var a=minSize; a< 20; a+=0.1)
    {
        var font_size =  Math.round(a*10000)/10000;
        context.font = a + "px Arial";
        context.fillText("A: EXAMPLE TEXT > " +  font_size, 20, (font_size-minSize)*lineHeight);
    }
}
</script></head><body onload="display()"><canvas id="test"></canvas></body></html> 
```

像素比例 ![像素尺度](../Images/d0c37024d033c3683ef1ac830d731f35.png) 点比例 ![点量表](../Images/05a8cd9b04bd575d08f943c0fea62a36.png) em 比例 - 1em = 5px Arial ![时间尺度](../Images/64d30e7830f2d4bcd0e99cfcaed61991.png) 百分比比例 - 100% = 5px Arial ![百分制](../Images/cfc2c746d1b53ed89f0aefa3dec6f24b.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T11:09:51.027

我以为你们应该为我做我的工作；）无论如何，这就是我解决问题的方法，尽管它有点小技巧，并且仍然有一些我将描述的问题。

回顾一下（因为问题可能不清楚）我试图将字体大小乘以一些浮点数来放大和缩小文本。但这会导致结果不稳定，因为大多数将字体大小四舍五入到最接近的整数值。

比如说。

```
var zoom = 1.02;
var font_size = 12;
context.font = (font_size * zoom) + "px Arial"; // 12.24px 
```

zoom = 1.04 (12.48px) 将呈现与上述代码相同的效果，而 zoom = 1.06 (12.75px) 将四舍五入为 13px。

这导致值之间的字体大小发生非常不希望的跳跃，而画布上的所有其他元素都正确缩放。

由于所有浏览器都呈现给定的文本字符串（例如“EXAMPLE TEXT”）并且长度略有不同，因此问题变得更加复杂。

## 解决方案

在初始化期间以标准字体大小 (zoom=1) 渲染文本并测量行长，将此值称为 iniLineLength

在场景渲染期间，我使用隐藏的画布将文本渲染到然后使用 drawImage 到主画布，宽度为乘数。

```
tmpContext.font = (font_size * zoom) + "px Arial";
tmpContext.fillText(MyLineOfText,0, 0); 
var s = (iniLineLength * zoom) / tmpContext.measureText(MyLineOfText) ;
mainContext.drawImage(tmpCanvas,x, y, pw * s, ph); 
```

根据行长与预期行长的距离，在主画布上拉伸或收缩生成的文本行。

在理想世界中，s 总是等于 1，因为预期的线长度总是与实际的线长度相同。预期的行长是我们的示例行长 iniLineLength 乘以与我们在此渲染过程中的字体大小相同的缩放因子。

我对这一切的奖励是它具有使浏览器行为的所有差异正常化的效果......几乎。

## 问题

即使行长标准化，行中每个字符的确切位置也不相同。给出下图中的效果。

![在此处输入图像描述](../Images/4eb4b0810498d964f0ef8c53d306db82.png)

然而，这已经是我所拥有的巨大改进。

此外，您还需要将 tmpCanvas 剪辑到 mainCanvas，否则您的浏览器将在尝试创建和复制百万像素的文本时停止运行，只是为了让一个字符全屏显示。

考虑到这一点，您还可以根据需要设置您的 tmp 画布宽度和高度，以适应您要渲染的实际文本行，这将节省内存、时间等。

# matlab - Matlab中的偏度维度

> ID：15430765
> 
> 赞同：1
> 
> 时间：2013-03-15T11:06:11.037
> 
> 标签：matlab, filter

有人可以帮我解决这个问题。

```
grayImage=dicomread('028tm.R.dcm');
sx=32;
sy=32;
theta=[0 pi/4 2*pi/4 3*pi/4 4*pi/4 5*pi/4 6*pi/4 7*pi/4];

gamma=1;
psi=0;
sigma=6; % ????12
lambda=[5 6 7 8 9 7];

# Creating 40 Gabor Filters
G = cell(5,8);
for i = 1:5
  for j = 1:8
    G{i,j}=zeros(65,65);
  end
end
for i = 1:5
  for j = 1:8
    f=1/lambda(i);      

    [T,gabout] = gaborfilter1(grayImage,sx,sy,f,theta(j));
    u{i,j}=mean2(gabout);
    del{i,j}=std2(gabout);  
    skew{i,j} =skewness(gabout);
    sk=[skew{:,:}];
    std=[u{:,:}];
    mn=[del{:,:}];
    disp(sk)             
  end
end 
```

这是我将展示我的工作区。

```
mn <1x40 double>
sk<1x10280 double>
std<1x40 double> 
```

为什么sk（偏度的值）是`1X10280`两倍？？？？？？它应该`1x40`像标准差和平均值。如何使 sk(skewness) 成为`1x40`？

希望可以有人帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:35:30.337

您的问题是对整个图像进行操作，但`mean2`对图像的*列*进行操作。您应该定义一个新功能`std2``skewness`

 *```
function sk = skewness2(X)
    sk = skewness(X(:));
end 
```

并用它代替`skewness`.*

# .net - .NET 4.0 中的 for 或 Parallel.For

> ID：15430771
> 
> 赞同：0
> 
> 时间：2013-03-15T11:06:25.987
> 
> 标签：.net, .net-4.0, parallel-processing

有人可以建议某人应该在哪里使用**for**循环而不是**Parallel.For** in 。**NET 4.0 框架**？

我在特定的长算法上使用 for 和 Parallel.For 进行了小型 PoC，结果非常支持 Parallel.For，即使在单核环境中也是如此。

我们可以简单地忽略.NET 4.0 Framework 中的**for循环吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:11:46.780

这里有*很多*因素需要考虑：

*   循环内的代码是为支持并发访问而*编写的吗？*它是线程安全的吗？如果不是：那是个大问题
*   如果所有线程最终都需要立即对单个资源（例如 UI）进行定向/同步访问，那么并发性就没有任何好处
*   这台机器上还发生了什么？如果这是一个 Web 服务器，最好***不要***让一个请求劫持大量内核
*   但相反，如果这是一个客户端应用程序，那么肯定：使用大量内核*并*尽快释放 UI 线程
*   工作 CPU 是否受限？IO绑定？什么？并行访问单个磁盘主轴会使事情变得更糟，而不是更好
*   线程有开销；并发性*增加*了完成的总工作量——目的是减少*经过*的时间
*   它是在本地完成的，还是在不同的服务器上完成的？如果是这样，其他服务器的线程模型是什么？

在大多数情况下，`for`/`foreach`很好。

# wordpress - 表单没有响应

> ID：15430772
> 
> 赞同：0
> 
> 时间：2013-03-15T11:06:27.267
> 
> 标签：wordpress, forms, twitter-bootstrap

我使用表单管理器在 wordpress 的 Twitter 的 Bootstrap 主题中为我的网站制作表单。我的问题是我用这个制作的每一个表格，当我在页面上显示它时它没有响应我应该怎么做才能让它响应？

这是我在页面上显示表单的方式：

```
<div id="myCarousel" class="carousel slide img-rounded">
<div class="carousel-inner">
<div class="active item"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/GRAAVAA01.jpg" /></div>
<div class="item"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/GRAAVAA02.jpg" /></div>
<div class="item"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/GRAAVAA03.jpg" /></div>
<div class="item"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/GRAAVAA04.jpg" /></div>
<div class="item"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/GRAAVAA05.jpg" /></div>
<div class="item"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/GRAAVAA06.jpg" /></div>
</div>
<a class="carousel-control left" href="#myCarousel" data-slide="prev">‹&lt;/a>
<a class="carousel-control right" href="#myCarousel" data-slide="next">›&lt;/a>
</div>
<ul class="thumbnails">
    <li class="span3"><a href="#"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/stoneOfMonth.png" /></a></li>
    <li class="span3"><a href="#"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/newArrivals.png" /></a></li>
    <li class="span3"><a href="http://graavaa.com/wp/downloads/"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/download.png" /></a></li>
    <li class="span3"><a href="http://graavaa.com/wp/contact-us/"><img src="http://graavaa.com/wp/wp-content/uploads/2013/03/locateUs.png" /></a><br/>
<div class="hidden-phone">[form form-1]</div>
</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:21:12.813

我会使用“Contact Form 7”插件，然后您需要像这样设置表单样式（液体响应表单）

```
<div class="container">
<div class="row">
    <div class="span12">
        <div class="row-fluid">
            <ul>
                <li>[form shortcode 1 class:span12]</li>
                <li>[form shortcode 2 class:span12]</li>
                <li>[form shortcode 3 class:span12]</li>
                <li>[form shortcode 4 class:span12]</li>
            </ul>
        </div>
    </div>
</div> 
```

您需要为表单字段提供一个 span12 类，并且整个表单需要在一个具有“row-fluid”类的 div 内

如果您只想在移动设备上隐藏表单，那么您拥有的代码是正确的！仔细检查您是否拥有所有响应式 JS/CSS 引导文件，还要在移动设备而不是桌面上对其进行测试。

# android - 我的标签更改为屏幕旋转的第一个标签

> ID：15430773
> 
> 赞同：0
> 
> 时间：2013-03-15T11:06:29.360
> 
> 标签：android, rotation, tabactivity, screen-rotation

我正在创建一个 android 应用程序，其中有一个 tabActivity。

下面给出了我的选项卡活动的 on create 方法。

```
protected void onCreate(Bundle savedInstanceState)
{
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);      
    setContentView(R.layout.logged);
    getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.title_background);
    mytab=(TabHost)findViewById(android.R.id.tabhost);
    Log.e("id",mytab.getId()+"");
    mytab.setup();  
    setupTab( "AAAA","AAAA.class",tabImages[2]);
    setupTab( "BBBB","BBBB.class",tabImages[1]);
    setupTab("CCCC","CCCC.class",tabImages[0]);
    setupTab("DDDD","DDDD.class",tabImages[3]);
    setupTab("EEEE","EEEE.class",tabImages[4]);
} 
```

通过搜索一些问题，我得到了一些添加`onSaveInstanceState(Bundle savedInstanceState)` and的想法`onRestoreInstanceState(Bundle savedInstanceState)`。这两个函数的代码如下。

```
@Override
protected void onSaveInstanceState(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onSaveInstanceState(savedInstanceState);
    savedInstanceState.putInt("tab_id",current_tab);
    Log.e("tab",""+savedInstanceState.getInt("tab_id"));
}
@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onRestoreInstanceState(savedInstanceState);
    mytab.setCurrentTab(savedInstanceState.getInt("tab_id"));
    Log.e("tab",""+savedInstanceState.getInt("tab_id"));
} 
```

但它不显示当前选项卡。它显示了我的默认选项卡 tab(0) .. 你能帮帮我吗？我的代码中还有什么要添加的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:09:11.307

尝试移动

```
mytab.setCurrentTab(savedInstanceState.getInt("tab_id")); 
```

进入**onCreate()**方法

```
protected void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState); 
   // intialising and setup TabHost
   if (savedInstanceState != null) {
      mytab.setCurrentTab(savedInstanceState.getInt("tab_id"));
   }
} 
```

现在它应该可以工作了。

# c++ - 从 C/C++ 使用 SSL 访问 MySql

> ID：15430774
> 
> 赞同：5
> 
> 时间：2013-03-15T11:06:34.273
> 
> 标签：c++, mysql, c, ssl

我已经将 MySql 配置为使用 SSL，它在 PHP 中运行良好。但是当我尝试使用 C/C++ 程序连接到数据库时，它不起作用。

## 变量：

```
host = "localhost"
psw = "pass"
db = "database" 
```

## 没有 SSL：

```
usr = "userNOSSL"
conn = mysql_init(NULL);
mysql_real_connect(conn, host, usr, psw, db, 0, NULL, 0); 
```

这个效果很好。我可以通过以下方式轻松检索数据：

```
query = "SELECT x FROM y"

mysql_query(conn, query);

result = mysql_store_result(conn);

num_fields = mysql_num_fields(result);

while ((row = mysql_fetch_row(result)))
{
    for(i = 0; i < num_fields; i++)
    {
        printf("%s ", row[i] ? row[i] : "NULL");
    }
    printf("\n");
}

mysql_free_result(result); 
```

## 使用 SSL（CLIENT_SSL 标签）：

```
usr = "userSSL"
conn = mysql_init(NULL);
mysql_real_connect(conn, host, usr, psw, db, 0, NULL, CLIENT_SSL); 
```

**错误**

> 错误：我的“MYSQL *conn;” 对象没有获得像“没有 ssl”这样的参数。所以，它发生了一个异常：

```
A first chance of exception at 0x0f18c274 in test_Class.exe : 0xC0000005: 
Acces violation when reading on location 0x00000048.
An unhandled exception at 0x0f18c274 in test_Class.exe : 0xC0000005: 
Acces violation when reading on location 0x00000048. 
```

在这一行：

```
num_fields = mysql_num_fields(result); 
```

如果我这样做，同样的错误：

```
mysql_ssl_set(.SOMEOPTIONTHERE.)
mysql_real_connect(conn, host, usr, psw, db, 0, NULL, 0); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:29:50.233

我的猜测是您的本地主机没有正确设置来处理 SSL。试试这个：[http ://www.chriscalender.com/?tag=ssluserlocalhost](http://www.chriscalender.com/?tag=ssluserlocalhost)

# c++ - C++ 消息多次打印

> ID：15430776
> 
> 赞同：1
> 
> 时间：2013-03-15T11:06:39.863
> 
> 标签：c++, console

我正在学习 C++，但我有一个我无法弄清楚的问题。当我输入 X 个字符时，当前的字符数将导致“失败”消息显示 X 次。

截屏，

![在此处输入图像描述](../Images/ca4b6129dc7777ff89ff64eebf351ae6.png)

这是我的代码，

```
#include <iostream>
#include <stdlib.h>
#include <string>
#include <time.h>
#include <ctype.h>

using namespace std;

int generateNumber()
{

    int randomNumber;

    srand(time(0));
    randomNumber = rand() % 100 + 1;

    return randomNumber;

}

int main()
{

    // Predefine vars
    int lifes = 5;
    int attempts = 0;
    int randomNumber = generateNumber();
    int gameStarted = 0;
    int gussedNumber;
    int score = 0;
    string username;

    cout << "--------------------------------" << endl;
    cout << "------- GUESS THE NUMBER -------" << endl;
    cout << "---------- VERSION 1.0 ---------" << endl;
    cout << "--------------------------------" << endl << endl;

    while(gameStarted == 0)
    {
        cout << "Enter your username before we get started" << endl;
        cin >> username;
        gameStarted = 1;
        system("cls");
    }

    if(gameStarted == 1)
    {

        cout << "Welcome, " << username << "!" << endl;
        cout << "Guess a number between 1 - 100" << endl << endl;

        while(attempts <= lifes)
        {

            // If you dont have any more lifes left
            if(lifes == 0)
            {

                system("CLS");
                cout << "Game Over" << endl;
                cout << "Lets try again." << endl;
                cout << "Guess a number between 1 - 100" << endl << endl;
                lifes = 5;
                randomNumber = generateNumber();

            } else {

                cin >> gussedNumber;

                if(cin)
                {

                    if(gussedNumber == randomNumber)
                    {

                        // Correct Number
                        system("CLS");
                        cout << "ConGratz Bro, you hit the correct number!" << endl;
                        cout << "Lets try again. You now have 5 lifes left." << endl;
                        lifes = 5;
                        score = score + 1;

                        // Generate a new random number
                        randomNumber = generateNumber();

                    } else {

                        // Wrong Number
                        lifes = lifes - 1;
                        cout << "Wrong Number." << endl;
                        cout << "Number of lifes left: " << lifes << endl << endl;

                    }
                } else {
                    cin.clear();
                    cin.ignore();
                    cout << "That was not a number!" << endl;
                }
            }
        }
    }

    cout << randomNumber << endl;
    return 0;
} 
```

只是我在学习时正在做的一个简单程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:15:07.840

```
cin.ignore(); 
```

你只忽略一个字符。您需要忽略整行：

```
cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

（您需要包括`limits`for [`std::numeric_limits`](http://en.cppreference.com/w/cpp/types/numeric_limits)）。另请参阅[`std::basic_istream::ignore`](http://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_istream/ignore&oldid=45659)，这正是解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T13:10:38.393

我删除了所有不相关的代码并得到了这个：

```
#include <iostream>

int main()
{
    for(int attempts=0; attempts < 10; ++attempts) {
        int guessedNumber;
        cin >> guessedNumber;
        if(cin) {
        } else {
            cin.clear();
            cin.ignore();
            cout << "That was not a number!" << endl;
        }
    }
    return 0;
} 
```

# jquery - 根据 XML 文件中的元素创建新的 div 标签

> ID：15430777
> 
> 赞同：0
> 
> 时间：2013-03-15T11:06:40.347
> 
> 标签：jquery, xml, ajax

我创建了一个便签功能，它将（很快）让我将数据写入文本字段并将其保存在 xml 文件中。

现在我在一个 xml 文件中有一些信息，我想在注释中输出，

问题是我希望每个元素都在不同的音符中。现在它将整个 xml 文件读入一个注释。

这是xml文件

```
<?xml version="1.0"?>
<notes>
  <note>
    <text>Hello, Yes this is dog!</text>
  </note>
<note>
    <text>Hello,this is cat!</text>
  </note>
</notes> 
```

/*这应该在两个音符上*/

这是我的 Jquery 和 Ajax 函数

```
function corporateData() {
        var note = '<div class="note">';
        note += '<div class ="note-drag">' + '</div>';
        note += '<textarea>' + '</textarea>';
        note += '<div class="note-close">' + '</div>';

        $("#wrapper").append(note);

    $.ajax({
        url: "write.xml",
        dataType: "xml",
        success: function(data) {

            $(data).find("note").each(function() {
                var info = $(this).find("text").text();
                $("textarea").append(info);
            });
        },
        error: function() {
            $("textarea").children().remove();
            $("textarea").append("<li>Error</li>");
        }
    });
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:13:17.063

尝试：

```
function corporateData() {

    $.ajax({
        url : "write.xml",
        dataType : "xml",
        success : function (data) {

            $(data).find("note").each(function () {
                var info = $(this).find("text").text();

                var note = '<div class="note">';
                note += '<div class ="note-drag">' + '</div>';
                note += '<textarea>' + '</textarea>';
                note += '<div class="note-close">' + '</div>';

                $(note).find("textarea").text(info);

                $("#wrapper").append(note);
            });
        },
        error : function () {
            $("textarea").children().remove();
            $("textarea").append("<li>Error</li>");
        }
    });
} 
```

# vb.net - 在VB Net中每秒更新文本块的文本

> ID：15430783
> 
> 赞同：0
> 
> 时间：2013-03-15T11:06:53.137
> 
> 标签：vb.net, audio, timer, irrklang

我有一个 Sub，它在我创建新窗口时处理。它使用 Irrklang 库加载和播放 mp3 文件。但是如何更新播放位置。我听说我可以使用计时器，但是如何在 sub 中使用它？

```
Private Sub  MainWindow_Loaded(sender As Object, e As RoutedEventArgs)

    Dim Music = MyiSoundengine.Play2D("Music/001.mp3")

    I Want to update this in every sec!
    Dim Music_Playposition = Music.Playpostion

    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:25:34.693

您不能在方法/子中使用计时器。计时器工作的唯一方法是定期引发*事件*；在计时器的情况下，它被称为“滴答”事件，每次计时器“滴答”时都会引发。

您可能已经知道什么是事件——您的`MainWindow_Loaded`方法正在处理一个`Loaded`事件，即`MainWindow`类的事件。

因此，您需要做的是向您的应用程序添加一个计时器，处理其 Tick 事件，并在该事件处理程序中使用当前位置更新您的文本框。

例如：

```
Public Class MainWindow

    Private WithEvents timer As New System.Windows.Threading.DispatcherTimer()

    Public Sub New()
        ' Initialize the timer.
        timer.Interval = new TimeSpan(0, 0, 1);  ' "tick" every 1 second

        ' other code that goes in the constructor
        ' ...
    End Sub

    Private Sub timer_Tick(sender As Object, e As EventArgs) Handles timer.Tick
        ' TODO: Add code to update textbox with current position
    End Sub

    Private Sub MainWindow_Loaded(sender As Object, e As RoutedEventArgs)
        ' Start the timer first.
        timer.Start()

        ' Then start playing your music.
        MyiSoundengine.Play2D("Music/001.mp3")
    End Sub

    ' any other code that you need inside of your MainWindow class
    ' ...

End Class 
```

请注意在`WithEvents`计时器对象的类级声明中使用关键字。`Handles`这使得仅使用事件处理程序上的语句来处理其事件变得容易。否则，您必须`AddHandler`在构造函数内部使用将事件处理程序方法连接到所需事件。

# ios - 从 OpenSSL 和 BouncyCastle 派生的 ECDH 共享密钥并不总是相同，尽管两者的常量和域参数相同

> ID：15430784
> 
> 赞同：8
> 
> 时间：2013-03-15T11:06:55.910
> 
> 标签：ios, openssl, bouncycastle, elliptic-curve

我正在尝试在 iOS 应用程序和 java servlet 之间实现 AES 加密。Java servlet 使用 BouncyCastle 库，而 iOS 应用程序使用 OpenSSL。虽然我在双方都使用了相同的公钥/私钥对和域参数，但 OpenSSL 生成的共享密钥有时与 BouncyCastle 在服务器端生成的不同。

程序如下；

1.  在服务器中生成的具有指定域参数的公钥/私钥对（例如`server_public_key`, `server_private_key`）
2.  `server_public_key``EC_POINT`以X 和 Y的形式嵌入 iOS 应用程序中
3.  在运行时，iOS 应用程序会生成自己的公钥/私钥对（比如 `client_key_curve`哪个是`EC_KEY`），并且
4.  然后根据 server_public_key 和 client_key_curve加载`server_public_key`并计算共享密钥 ( )，并且`key_agreement`
5.  然后`client_public_key`（从 中提取`client_key_curve`）以及使用派生的共享秘密（`key_agreement`）对称加密的加密消息发送到服务器
6.  `client_public_key`在服务器端，再次使用与客户端相同的服务器 ECDH 参数计算共享密钥 ，并且
7.  然后使用计算的加密消息解密`key_agreement`

但是解密的消息并不总是与客户端发送的消息相同。

由于我还开发了一个使用相同程序但使用 BouncyCastle 进行加密的 Android 应用程序，因此我怀疑使用 OpenSSL 实现代码的正确性，因此此处显示代码以供其他人帮助解决问题。我为计算共享秘密而实施的内容如下

```
- (void)calculateSharedSecret
{
    BN_CTX* bn_ctx;

    EC_KEY*     client_key_curve = NULL;
    EC_KEY*     server_key_curve = NULL;
    EC_GROUP*   client_key_group = NULL;
    EC_GROUP*   server_key_group = NULL;
    EC_POINT*   client_publicKey = NULL;
    EC_POINT*   server_publicKey = NULL;
    BIGNUM*     client_privatKey = NULL;

    BIGNUM* client_publicK_x = NULL;
    BIGNUM* client_publicK_y = NULL;
    BIGNUM* server_publicK_x = NULL;
    BIGNUM* server_publicK_y = NULL;

    NSException *p = [NSException exceptionWithName:@"" reason:@"" userInfo:nil];

    bn_ctx = BN_CTX_new();
    BN_CTX_start(bn_ctx);

    client_publicK_x = BN_CTX_get(bn_ctx);
    client_publicK_y = BN_CTX_get(bn_ctx);
    client_privatKey = BN_CTX_get(bn_ctx);
    server_publicK_x = BN_CTX_get(bn_ctx);
    server_publicK_y = BN_CTX_get(bn_ctx);

    // client

    if ((client_key_curve = EC_KEY_new_by_curve_name(NID_X9_62_prime256v1)) == NULL)
        @throw p;

    if ((client_key_group = (EC_GROUP *)EC_KEY_get0_group(client_key_curve)) == NULL)
        @throw p;

    if (EC_KEY_generate_key(client_key_curve) != 1)
        @throw p;

    if ((client_publicKey = (EC_POINT *)EC_KEY_get0_public_key(client_key_curve)) == NULL)
        @throw p;

    if (EC_KEY_check_key(client_key_curve) != 1)
        @throw p;

    client_privatKey = (BIGNUM *)EC_KEY_get0_private_key(client_key_curve);

    char *client_public_key = EC_POINT_point2hex(client_key_group, client_publicKey, POINT_CONVERSION_COMPRESSED, bn_ctx);
    char *client_privat_key = BN_bn2hex(client_privatKey);

    _clientPublicKey = [NSString stringWithCString:client_public_key encoding:NSUTF8StringEncoding];

    // server

    NSArray* lines = [self loadServerPublicKeyXY];

    NSString *public_str_x = [lines objectAtIndex:0];
    NSString *public_str_y = [lines objectAtIndex:1];

    BN_dec2bn(&server_publicK_x, [public_str_x UTF8String]);
    BN_dec2bn(&server_publicK_y, [public_str_y UTF8String]);

    if ((server_key_curve = EC_KEY_new_by_curve_name(NID_X9_62_prime256v1)) == NULL)
        @throw p;

    if ((server_key_group = (EC_GROUP *)EC_KEY_get0_group(server_key_curve)) == NULL)
        @throw p;

    if (EC_KEY_generate_key(server_key_curve) != 1)
        @throw p;

    if ((server_publicKey = EC_POINT_new(server_key_group)) == NULL)
        @throw p;

    if (EC_POINT_set_affine_coordinates_GFp(server_key_group, server_publicKey, server_publicK_x, server_publicK_y, bn_ctx) != 1)
        @throw p;

    if (EC_KEY_check_key(server_key_curve) != 1)
        @throw p;

    unsigned char *key_agreement = NULL;
    key_agreement = (unsigned char *)OPENSSL_malloc(SHA_DIGEST_LENGTH);
    if (ECDH_compute_key(key_agreement, SHA_DIGEST_LENGTH, server_publicKey, client_key_curve, KDF1_SHA1) == 0)
        @throw p;
    _symmetricKey = [NSData dataWithBytes:key_agreement length:16];
} 
```

和

```
void *KDF1_SHA1(const void *input, size_t inlen, void *output, size_t *outlen)
{
    if (*outlen < SHA_DIGEST_LENGTH)
        return NULL;
    else
        *outlen = SHA_DIGEST_LENGTH;
    return SHA1(input, inlen, output);
} 
```

`_clientPublicKey`并`_symmetricKey`在类级别声明

两侧使用相同的曲线（名为 prime256v1 或 secp256r1），但结果并不总是相同。

**编辑 1**：作为对@PeterDettman 的回应，我发布了服务器端代码以进行更多说明

```
public byte[] generateAESSymmetricKey(byte[] client_public_key_hex) throws InvalidRequest{
    try {
        // ECDH Private Key as well as other prime256v1 params was generated by Java "keytool" and stored in a JKS file
        KeyStore keyStore = ...;
        PrivateKey privateKey = (PrivateKey) keyStore.getKey("keyAlias", "keyStorePassword".toCharArray());
        ECPrivateKeyParameters ecdhPrivateKeyParameters = (ECPrivateKeyParameters) (PrivateKeyFactory.createKey(privateKey.getEncoded()));

        ECCurve ecCurve = ecdhPrivateKeyParameters.getParameters().getCurve();
        ECDomainParameters ecDomainParameters = ecdhPrivateKeyParameters.getParameters();
        ECPublicKeyParameters client_public_key = new ECPublicKeyParameters(ecCurve.decodePoint(client_public_key_hex), ecDomainParameters);

        BasicAgreement agree = new ECDHBasicAgreement();
        agree.init(ecdhPrivateKeyParameters);
        byte[] keyAgreement = agree.calculateAgreement(client_public_key).toByteArray();

        SHA1Digest sha1Digest = new SHA1Digest();
        sha1Digest.update(keyAgreement, 0, keyAgreement.length);
        byte hashKeyAgreement[] = new byte[sha1Digest.getDigestSize()];
        sha1Digest.doFinal(hashKeyAgreement, 0);

        byte[] server_calculatd_symmetric_key = new byte[16];
        System.arraycopy(hashKeyAgreement, 0, server_calculatd_symmetric_key, 0, server_calculatd_symmetric_key.length);
        return server_calculatd_symmetric_key;
    } catch (Throwable ignored) {
        return null;
    }
} 
```

在哪里`client_public_key_hex`将`client_public_key`其转换为字节数组。预期的结果是始终`server_calculatd_symmetric_key`等于`symmetricKey`。但它们并不总是相同的。

**编辑 2**：作为对@PeterDettman 回答的反馈，我做了一些更改以反映他的建议，尽管不平等率降低了，但在所有情况下，双方生成的密钥协议（共享秘密）并不相同。

可以使用以下数据重现其中一种不等式情况

*   公钥： **02E05C058C3DF6E8D63791660D9C5EA98B5A0822AB93339B0B8815322131119C4C**
*   私钥： **062E8AC930BD6009CF929E51B37432498075D21C335BD00086BF68CE09933ACA**
*   OpenSSL 生成的共享密钥：**51d027264f8540e5d0fde70000000000**
*   BouncyCastle 生成的共享密钥： **51d027264f8540e5d0fde700e5db0fab**

那么在实现的代码或过程中是否有任何错误？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-09T08:43:49.490

服务器代码有问题，ECDH协议值转换为字节的方式：

```
byte[] keyAgreement = agree.calculateAgreement(client_public_key).toByteArray(); 
```

试试这个：

```
BigInteger agreementValue = agree.calculateAgreement(client_public_key);
byte[] keyAgreement = BigIntegers.asUnsignedByteArray(agree.getFieldSize(), agreementValue); 
```

这将确保一个固定大小的字节数组作为输出，这是将 EC 字段元素转换为八位字节字符串的要求（搜索“字段元素到八位字节字符串转换原语”以获取更多详细信息）。

我建议您忽略 SHA1 密钥派生部分，直到您可以让 Java keyAgreement 字节数组与您的 KDF1_SHA1 函数的输入完全匹配。

# android - Android 回到上一个 Activity

> ID：15430787
> 
> 赞同：6
> 
> 时间：2013-03-15T11:07:05.163
> 
> 标签：android, android-intent, android-activity

我有两个活动，`MainActivity`和`NextActivity`。从`MainActivity`I can go to`NextActivity`然后使用`Intent`to go back to `MainActivity`。但是随后`OnCreate`会调用其他东西，就像一切都重新初始化一样。我想回到我进入之前的状态`NextActivity`。

我意识到，如果我使用手机上的物理后退按钮，就可以实现这一点。

那么如何像返回按钮一样返回到一个活动呢？

PS。我测试`finish()`但没有帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-15T11:10:09.820

你可以只打电话`onBackPressed()`而不是使用`Intent`回到`MainActivity`..

例如：

```
public void onClick() {
    onBackPressed();
} 
```

注意：`finish()`应该完全按照您的意愿行事..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T11:24:11.030

假设您有两个活动 A 和 B。您从 A 导航到 B。A 转到 background 。

B 被放在后面的堆栈上，B 获得焦点。当您单击后退按钮时，活动 B 会从后退堆栈中弹出。恢复活动 A。

注意：可以同时在后台执行多个任务。但是，如果用户同时运行多个后台任务，系统可能会开始销毁后台活动以恢复内存，从而导致活动状态丢失。请参阅以下有关活动状态的部分。

[http://developer.android.com/training/basics/activity-lifecycle/starting.html](http://developer.android.com/training/basics/activity-lifecycle/starting.html)。活动一旦被销毁，必须重新创建。当屏幕方向改变时，Activity 被破坏并重新创建。

[http://developer.android.com/training/basics/activity-lifecycle/starting.html](http://developer.android.com/training/basics/activity-lifecycle/starting.html)。

[http://developer.android.com/guide/components/tasks-and-back-stack.html](http://developer.android.com/guide/components/tasks-and-back-stack.html)。你应该看看后栈是如何工作的。

在您的情况下，完成应该适合您（通过按后退按钮）。

注意：系统在调用 onPause() 和 onStop() 之后在所有情况下调用 onDestroy()，但以下情况除外：当您从 onCreate() 方法中调用 finish() 时。

假设你有第三个活动 C 并且你想去 Activity A 。

```
 @Override
 public boolean onKeyDown(int keyCode, KeyEvent event) {
if (keyCode == KeyEvent.KEYCODE_BACK) {
    onBackPressed();

}

return super.onKeyDown(keyCode, event);
}

 public void onBackPressed() {
Intent myIntent = new Intent(ActivityC.this, MainActivity.class);
myIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);// clear back stack
startActivity(myIntent);
finish();
return;
} 
```

# c# - Mono C# 在一台 Linux 机器上运行良好，但在另一台机器上却不行！也许与证书有关？

> ID：15430804
> 
> 赞同：1
> 
> 时间：2013-03-15T11:07:44.777
> 
> 标签：c#, mono, certificate, servicepointmanager

我有一些调用肥皂服务的代码。
它在我的第一台 linux 机器上运行良好。
但是，当我在另一台机器上运行它时，出现以下错误。
谷歌似乎表明它可能来自证书，尽管我不确定这一点，因为我正在通过`ServicePointManager.ServerCertificateValidationCallback = Validator;` Where `Validator`is a function that return true 覆盖证书方法。

有任何想法吗？

```
Unhandled Exception: System.Net.WebException: Error getting response stream (ReadDone1): ReceiveFailure ---> System.IO.IOException: EndRead failure ---> System.Net.Sockets.SocketException: Connection reset by peer
  at System.Net.Sockets.Socket.EndReceive (IAsyncResult result) [0x00000] in <filename unknown>:0 
  at System.Net.Sockets.NetworkStream.EndRead (IAsyncResult ar) [0x00000] in <filename unknown>:0 
  --- End of inner exception stack trace ---
  at System.Net.Sockets.NetworkStream.EndRead (IAsyncResult ar) [0x00000] in <filename unknown>:0 
  at Mono.Security.Protocol.Tls.SslStreamBase.InternalReadCallback (IAsyncResult result) [0x00000] in <filename unknown>:0 
  --- End of inner exception stack trace ---
  at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult) [0x00000] in <filename unknown>:0 
  at System.Net.HttpWebRequest.GetResponse () [0x00000] in <filename unknown>:0 
  at CRMOnlineSOAPRequests.CRMHelper.GetSOAPResponse (System.String url, System.String soapEnvelope) [0x00000] in <filename unknown>:0 
  at CRMOnlineSOAPRequests.CRMHelper.createEntity (System.String[] keyValuesOneDimensionalArray) [0x00000] in <filename unknown>:0 
  at CRMCreateEntity.Program.Main (System.String[] keyValuesOneDimensionalArray) [0x00000] in <filename unknown>:0 
[ERROR] FATAL UNHANDLED EXCEPTION: System.Net.WebException: Error getting response stream (ReadDone1): ReceiveFailure ---> System.IO.IOException: EndRead failure ---> System.Net.Sockets.SocketException: Connection reset by peer
  at System.Net.Sockets.Socket.EndReceive (IAsyncResult result) [0x00000] in <filename unknown>:0 
  at System.Net.Sockets.NetworkStream.EndRead (IAsyncResult ar) [0x00000] in <filename unknown>:0 
  --- End of inner exception stack trace ---
  at System.Net.Sockets.NetworkStream.EndRead (IAsyncResult ar) [0x00000] in <filename unknown>:0 
  at Mono.Security.Protocol.Tls.SslStreamBase.InternalReadCallback (IAsyncResult result) [0x00000] in <filename unknown>:0 
  --- End of inner exception stack trace ---
  at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult) [0x00000] in <filename unknown>:0 
  at System.Net.HttpWebRequest.GetResponse () [0x00000] in <filename unknown>:0 
  at CRMOnlineSOAPRequests.CRMHelper.GetSOAPResponse (System.String url, System.String soapEnvelope) [0x00000] in <filename unknown>:0 
  at CRMOnlineSOAPRequests.CRMHelper.createEntity (System.String[] keyValuesOneDimensionalArray) [0x00000] in <filename unknown>:0 
  at CRMCreateEntity.Program.Main (System.String[] keyValuesOneDimensionalArray) [0x00000] in <filename unknown>:0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:21:29.837

我们公司的证书有问题，另一家公司希望我们使用在线生成的证书，而不是“官方”证书。我们不想将该证书包含在我们的受信任列表中，因为其他公司也可能使用它。因此，我们使用以下代码临时接受所有证书，然后我们重置证书处理：

```
System.Net.ServicePointManager.ServerCertificateValidationCallback = (sender, certificate, chain, sslPolicyErrors) =>
{
    //Whatever the certificate, accept it.
    return true;
};

//Do your request

//Reset handling to normal.
System.Net.ServicePointManager.ServerCertificateValidationCallback = null; 
```

请注意，这是在 .NET 中而不是单声道中，所以我不确定它是否会起作用。

# windows - bat文件中设置的cygwin环境变量

> ID：15430807
> 
> 赞同：3
> 
> 时间：2013-03-15T11:07:55.990
> 
> 标签：windows, shell, batch-file, cygwin, environment

我需要设置几个在 cygwin shell 中应该可用的环境变量。

我尝试`"c:/Program Files (x86)/Microsoft Visual Studio 10.0/VC/bin/amd64"/vcvars64.bat`在 ~/.bashrc 中运行。脚本似乎可以运行，但它不会更新环境变量。

如何导出 bat 文件中设置的变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:01:28.180

取决于你想要做什么。如果您想在 Cygwin 中访问这些工具，您可以编辑`.bash_profile`并更新您的工具`PATH=`以匹配`vcvars64.bat`已有的工具。这就是我访问这些工具的方式。

您也可以`vcvars64.bat`在启动 Cygwin 之前运行，方法是编辑您的`{cygwin dir}/Cygwin.bat`（假设您是通过此文件启动 Cygwin！）在启动 bash 之前运行它。这样就可以设置 DOS 环境，并且 Cygwin 会选择它。

# regex - 如何删除以相同单词开头的第二行连续行？

> ID：15430810
> 
> 赞同：14
> 
> 时间：2013-03-15T11:08:10.517
> 
> 标签：regex, perl, bash, sed, awk

我有一个文本文件，其中包含以“TITLE”和“DATA”开头的交换行，但有时会有以“TITLE”开头的重复行：

> TITLE 一些
> DATA 一些数据
> TITLE 一些其他
> DATA 一些其他数据
> TITLE 一些更多
> TITLE 额外信息
> DATA 一些更多数据

我希望能够检测到以 'TITLE' 开头的重复行，并只保留每对这样的第一行。
我发现捕获这些的正则表达式`^TITLE.*\n^TITLE.*\n`现在我想将其合并到一个单行 ///`perl`命令`bash`中`sed`，`awk`该命令将删除第二行并输出文件的其余部分，但我无法弄清楚.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T11:14:53.013

Perl 解决方案：

```
perl -ne 'print unless $t and /^TITLE/; $t = /^TITLE/' 
```

`$t`它会记住前一行是否是变量中的 TITLE 。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-15T11:31:02.020

这是使用 GNU sed 的一种方法：

```
sed -r 'N; /(TITLE)[^\n]*\n\1/ s/\n.*//; P; D' infile 
```

*   `N`将第二行放入模式空间。
*   匹配测试是否两行都以`TITLE`.
*   如果是这样，则删除第二行。
*   `P; D`打印并删除模式空间中的第一行。

输出：

```
TITLE something
DATA some data
TITLE something else
DATA some other data
TITLE some more
DATA some more data 
```

### 编辑 - 处理任意数量的重复

正如*Nikina Reklawyks*在评论中所指出的，上述解决方案仅适用于以 开头的两个连续行`TITLE`，为了处理任意数量的重复，可以添加一个简单的循环，如下所示：

```
sed -r ':a; N; /(TITLE)[^\n]*\n\1/ s/\n.*//; ta; P; D' infile 
```

该`ta`语句在成功时使 sed 跳转到`:a`标签`s///`。

另一种方法是使用`uniq`from 的命令`coreutils`，这不是很灵活，但在这种情况下效果很好：

```
uniq -w5 infile 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-15T11:12:51.547

单程：

```
awk '$1!=p{print;p=$1}' file 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-15T11:36:55.853

在我看来，您的记录包含两个字段，即 TITLE 和 DATA，如果您缺少第二个字段，您想删除该记录。但这不是你在问题中问的。因此，这是执行您要求的一种方法：

```
awk '/^TITLE/&&!t{t=$0} /^DATA/&&t{print t;print;t=""}' inputfile 
```

这里的想法是，当我们看到一个变量并且还没有一个标题集时，我们将它设置为一个 TITLE，然后只在我们看到一个 DATA 时打印它。如果我正确阅读了您的问题，这适用于您提供的输入数据。输出是：

```
TITLE something
DATA some data
TITLE something else
DATA some other data
TITLE some more
DATA some more data 
```

如您所见，数据集中的最后一个 TITLE 行已被删除。

这是在 awk 中执行此操作的另一种方法...

```
awk '/^TITLE/&&t{next} t=0; /^TITLE/{t=1} 1' inputfile 
```

`t`在这一个中，如果已设置，第一个表达式会跳过标题。第二个表达式 unsets `t`。第三个表达式为标题设置 if，最后一个表达式 ( `1`) 打印该行。当然，如果我们跳过第一个表达式中的行，最后三个表达式就不会运行。它生成与上面相同的输出，并且不费心查看`/^DATA/`.

最后，这是代码最少但逻辑最奇怪的一个：

```
awk '/^DATA/ || !t; {t=/^TITLE/}' inputfile 
```

它打印所有数据行，或任何`t`未设置的行，然后有效地设置`t`为布尔值，影响下一行的评估。如果您在 csh 或 tcsh 中执行此操作，请注意感叹号，在这些 shell 中可能需要转义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-15T11:12:34.783

试试这个单行：

```
 awk '/^TITLE/&&f{next;} {if ($0~/^TITLE/)f=1;else f=0}1' file 
```

输出：

```
TITLE something
DATA some data
TITLE something else
DATA some other data
TITLE some more
DATA some more data 
```

# ios - 在 iOS 中合并 2 个 pdf 文件

> ID：15430812
> 
> 赞同：5
> 
> 时间：2013-03-15T11:08:21.133
> 
> 标签：ios, objective-c, pdf, cgpdf

我正在尝试在 iOS 中合并两个 PDF 文件。我正在逐页合并。如果文件很大，则需要很长时间。有什么办法，我们可以合并这两个文件，而不是逐页合并？

如果你愿意，我可以发布我的代码。

我的代码类似于[SO 上的代码](https://stackoverflow.com/questions/5610521/merging-pdf-files-in-cocoa)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-15T11:18:48.213

试试这个代码..它添加了第一个 pdf 文件，然后在其中添加了第二个 pdf 文件以制作单个 pdf。

```
NSString *cacheDir = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject];

// File paths
NSString *pdfPath1 = [[NSBundle mainBundle] pathForResource:@"pdf1" ofType:@"pdf"];
NSString *pdfPath2 = [cacheDir stringByAppendingPathComponent:@"temp.pdf"];
NSString *pdfPathOutput = [cacheDir stringByAppendingPathComponent:@"out.pdf"];

// File URLs - bridge casting for ARC
CFURLRef pdfURL1 = (__bridge_retained CFURLRef)[[NSURL alloc] initFileURLWithPath:(NSString *)pdfPath1];//(CFURLRef) NSURL
CFURLRef pdfURL2 = (__bridge_retained CFURLRef)[[NSURL alloc] initFileURLWithPath:(NSString *)pdfPath2];//(CFURLRef)
CFURLRef pdfURLOutput =(__bridge_retained CFURLRef) [[NSURL alloc] initFileURLWithPath:(NSString *)pdfPathOutput];//(CFURLRef)

// File references
CGPDFDocumentRef pdfRef1 = CGPDFDocumentCreateWithURL((CFURLRef) pdfURL1);
CGPDFDocumentRef pdfRef2 = CGPDFDocumentCreateWithURL((CFURLRef) pdfURL2);

// Number of pages
NSInteger numberOfPages1 = CGPDFDocumentGetNumberOfPages(pdfRef1);
NSInteger numberOfPages2 = CGPDFDocumentGetNumberOfPages(pdfRef2);

// Create the output context
CGContextRef writeContext = CGPDFContextCreateWithURL(pdfURLOutput, NULL, NULL);

// Loop variables
CGPDFPageRef page;
CGRect mediaBox;

// Read the first PDF and generate the output pages
NSLog(@"GENERATING PAGES FROM PDF 1 (%i)...", numberOfPages1);
for (int i=1; i<=numberOfPages1; i++) {
    page = CGPDFDocumentGetPage(pdfRef1, i);
    mediaBox = CGPDFPageGetBoxRect(page, kCGPDFMediaBox);
    CGContextBeginPage(writeContext, &mediaBox);
    CGContextDrawPDFPage(writeContext, page);
    CGContextEndPage(writeContext);
}

// Read the second PDF and generate the output pages
NSLog(@"GENERATING PAGES FROM PDF 2 (%i)...", numberOfPages2);
for (int i=1; i<=numberOfPages2; i++) {
    page = CGPDFDocumentGetPage(pdfRef2, i);
    mediaBox = CGPDFPageGetBoxRect(page, kCGPDFMediaBox);
    CGContextBeginPage(writeContext, &mediaBox);
    CGContextDrawPDFPage(writeContext, page);
    CGContextEndPage(writeContext);      
}
NSLog(@"DONE!");

// Finalize the output file
CGPDFContextClose(writeContext);

// Release from memory
CFRelease(pdfURL1);
CFRelease(pdfURL2);
CFRelease(pdfURLOutput);
CGPDFDocumentRelease(pdfRef1);
CGPDFDocumentRelease(pdfRef2);
CGContextRelease(writeContext); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-15T11:20:39.993

将此方法用于任意数量的 pdf，这可能对您有所帮助

```
+ (NSString *)joinPDF:(NSArray *)listOfPath{

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *layOutPath=[NSString stringWithFormat:@"%@/mergepdf/pdf",[paths objectAtIndex:0]];
    if(![[NSFileManager defaultManager] fileExistsAtPath:layOutPath]){
        [[NSFileManager defaultManager] createDirectoryAtPath:layOutPath withIntermediateDirectories:YES attributes:nil error:nil];        
    } 
    // File paths
    NSString *fileName = @"ALL.pdf";
    NSString *pdfPathOutput = [layOutPath stringByAppendingPathComponent:fileName];
    CFURLRef pdfURLOutput = (__bridge CFURLRef)[NSURL fileURLWithPath:pdfPathOutput];
    NSInteger numberOfPages = 0;
    // Create the output context
    CGContextRef writeContext = CGPDFContextCreateWithURL(pdfURLOutput, NULL, NULL);

    for (NSString *source in listOfPath) {
//        CFURLRef pdfURL = (__bridge CFURLRef)[NSURL fileURLWithPath:source];

       CFURLRef pdfURL =  CFURLCreateFromFileSystemRepresentation(NULL, [source UTF8String],[source length], NO);

        //file ref
        CGPDFDocumentRef pdfRef = CGPDFDocumentCreateWithURL(pdfURL);
        numberOfPages = CGPDFDocumentGetNumberOfPages(pdfRef);

        // Loop variables
        CGPDFPageRef page;
        CGRect mediaBox;

        // Read the first PDF and generate the output pages
        DLog(@"GENERATING PAGES FROM PDF 1 (%@)...", source);
        for (int i=1; i<=numberOfPages; i++) {
            page = CGPDFDocumentGetPage(pdfRef, i);
            mediaBox = CGPDFPageGetBoxRect(page, kCGPDFMediaBox);
            CGContextBeginPage(writeContext, &mediaBox);
            CGContextDrawPDFPage(writeContext, page);
            CGContextEndPage(writeContext);
        }

        CGPDFDocumentRelease(pdfRef);
        CFRelease(pdfURL);
    }
  // CFRelease(pdfURLOutput);
//    
//    // Finalize the output file
   CGPDFContextClose(writeContext);
    CGContextRelease(writeContext);

    return pdfPathOutput;
} 
```

# php - mysqli准备好的语句绑定结果和循环

> ID：15430814
> 
> 赞同：0
> 
> 时间：2013-03-15T11:08:23.137
> 
> 标签：php, mysqli

我有这段代码是为了在数据库中搜索：

```
$key = '%'.$_GET['key'].'%';
$result= $db->prepare("SELECT * FROM information WHERE stuId LIKE ? 
                                            OR stuName LIKE ? LIMIT ?,10");
$result->bind_param('ssi',$key,$key,$startpage);
$result->execute();
$result->bind_result($stuId,$stuName,$date,$stuSex,$stuAdd);
while($result->fetch()) {
    $stuDoB= $date->format('d/m/Y');
    echo "<tr>
              <td class='col1'>
                  <div>$stuId</div>
              </td>
              <td>
                  <div><a href='editStudent.php?stuId=$stuId'>" . htmlspecialchars($stuName) . "</a></div>
              </td>
              <td class='col3'>
                 <div>$stuDoB</div>
              </td>
              <td class='col4'>
                 <div>$stuSex</div>
              </td>
              <td class='col5'>
                 <div>" . htmlspecialchars($stuAdd) . "</div>
              </td>
            </tr>";
} 
```

我试图学习准备好的语句，所以我从正常方式更改为上面的代码你能告诉我：

*   我是否必须在循环内`$result->fetch()`或仅`bind_result()`在循环外绑定 1 次？
*   我的代码有问题吗？它总是给出带有任何 $key 和致命错误的空行结果： `Fatal error: Call to a member function format() on a non-object in D:\xampp\htdocs\baiTapLon\showPage.php on line 30`

第 30 行是`$stuDoB= $date->format('d/m/Y');`

请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:14:27.453

*   我必须在 $result->fetch() 内绑定_result 还是在循环外只绑定 1 次 bind_result() ？

**您必须`bind_result`在循环外使用一次**

*   我的代码有问题吗？它总是给出带有任何 $key 和致命错误的空行结果：“致命错误：在第 30 行对 D:\xampp\htdocs\baiTapLon\showPage.php 中的非对象调用成员函数 format()”

**您不能对任何变量**使用格式，像这样使用它

```
$date1 = new DateTime($date);
$stuDoB= $date1->format('d/m/Y'); 
```

# java - Jackson 无法序列化 null Double

> ID：15430818
> 
> 赞同：2
> 
> 时间：2013-03-15T11:08:27.177
> 
> 标签：java, json, jackson

我正在尝试将一个对象序列化为一个数组，而杰克逊未能使用 NPE 这样做。

我期待响应中出现类似 [1, null, 10] 的内容，但不明白 Jackson 为什么会抛出 NPE 而不是序列化 null 值。

```
@JsonFormat(shape = JsonFormat.Shape.ARRAY)
public static class PointTO {
    private long x;
    private Double y;
    private int volume;

    public PointTO(long x, Double y, int volume) {
        this.x = x;
        this.y = y;
        this.volume = volume;
    }

    public long getX() {
        return x;
    }

    public Double getY() {
        return y;
    }

    public int getVolume() {
        return volume;
    }
} 
```

这是堆栈跟踪：

```
com.fasterxml.jackson.databind.JsonMappingException: (was java.lang.NullPointerException) (through reference chain: de.bnext.web.model.DisplayOrderBookResponseTO["curves"]-&gt;java.util.ArrayList[0]-&gt;de.bnext.web.model.CurveTO["points"]-&gt;java.util.ArrayList[15]-&gt;de.bnext.web.model.PointTO["y"])
    com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:232)
    com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:197)
    com.fasterxml.jackson.databind.ser.std.StdSerializer.wrapAndThrow(StdSerializer.java:183)
    com.fasterxml.jackson.databind.ser.impl.BeanAsArraySerializer.serializeAsArray(BeanAsArraySerializer.java:192)
    com.fasterxml.jackson.databind.ser.impl.BeanAsArraySerializer.serialize(BeanAsArraySerializer.java:147)
    com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:94)
    com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:21)
    com.fasterxml.jackson.databind.ser.std.AsArraySerializerBase.serialize(AsArraySerializerBase.java:180)
    com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:544)
    com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:551)
    com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:143)
    com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:94)
    com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:21)
    com.fasterxml.jackson.databind.ser.std.AsArraySerializerBase.serialize(AsArraySerializerBase.java:180)
    com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:544)
    com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:551)
    com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:143)
    com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:120)
    com.fasterxml.jackson.databind.ObjectMapper.writeValue(ObjectMapper.java:1728)
    org.springframework.http.converter.json.MappingJackson2HttpMessageConverter.writeInternal(MappingJackson2HttpMessageConverter.java:194)
    org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:179)
    org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:148)
    org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:90)
    org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.handleReturnValue(RequestResponseBodyMethodProcessor.java:189)
    org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:69)
    org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:122)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:745)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:686)
    org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:925)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:856)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:920)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:827)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:801)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:368)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:169)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T18:45:00.927

听起来像一个错误。您可以在以下位置报告此问题：

[https://github.com/FasterXML/jackson-databind/issues](https://github.com/FasterXML/jackson-databind/issues)

以及您使用的是哪个 Jackson 版本等信息？

如错误消息所示，似乎属性“y”处理失败：我猜这是因为它是一个包装器对象，并且代码的某些部分假定它可以自动拆箱成`double`值。因此需要在适当的位置添加检查。

# silverlight - sldata 在 Silverlight API 3.0 中不起作用

> ID：15430821
> 
> 赞同：0
> 
> 时间：2013-03-15T11:08:33.073
> 
> 标签：silverlight, arcgis-server

我已安装 arcgis 服务器 Silverlight API 3.0，我想在我的地图工具栏中进行标识

这是我的代码的一部分

```
<slData:DataGrid x:Name="DataGrid"  HeadersVisibility="None" Background="White">
        <slData:DataGrid.Columns>
  <slData:DataGridTextColumn Binding="{Binding Path=Key}"   FontWeight="Bold"/>
  <slData:DataGridTextColumn Binding="{Binding Path=Value}"/>
        </slData:DataGrid.Columns>
</slData:DataGrid> 
```

但是dosnt工作并且发生错误“未找到类型sldata：datagrid。非常确定您没有丢失程序集引用并且所有引用程序集都已构建”

我尝试添加所有 esri 程序集，但我的问题没有解决

有谁知道如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T14:16:23.710

添加对 System.Windows.Controls.Data.dll 的引用

还要确保在您的 xmlns 映射中定义了 sldata。

顺便说一句，这与 esri 程序集完全无关，因为这都是微软东西的一部分。

# asp.net-mvc - 由于部分视图而重复 KendoUI Datepicker 控件

> ID：15430823
> 
> 赞同：0
> 
> 时间：2013-03-15T11:08:44.337
> 
> 标签：asp.net-mvc, kendo-ui

我正在使用 ASP MVC 局部视图在我的页面中创建两个相同的局部视图

```
<div class="row-fluid">
    <div class="span6">
        @{Html.RenderPartial("PVReportingModule");}
    </div>
    <div class="span6">
        @{Html.RenderPartial("PVReportingModule");}
    </div>
</div> 
```

我的 PVReportingModule 部分视图中需要一个 KendoUI Datepicker，我该如何创建和命名它？下面是我的 PVReportingModule 部分视图中的代码

```
@Html.Kendo().DatePicker().Name("xXxX") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:22:11.330

您可以将 id 作为参数传递：

```
<div class="row-fluid">
    <div class="span6">
        @{Html.RenderPartial("PVReportingModule", new ViewDataDictionary { { "datePickerId", "picker1" } });}
    </div>
    <div class="span6">
        @{Html.RenderPartial("PVReportingModule", new ViewDataDictionary { { "datePickerId", "picker2" } });}
    </div>
</div> 
```

然后在部分里面使用这个参数：

```
@Html.Kendo().DatePicker().Name(ViewBag.datePickerId) 
```

# sql - 提高性能 SQL

> ID：15430824
> 
> 赞同：0
> 
> 时间：2013-03-15T11:08:49.373
> 
> 标签：sql, db2

在同一内部查询多次运行的情况下，有什么方法可以自定义以下 SQL 以提高性能？

```
DELETE FROM interactionrel 
WHERE  ( from_interact_id IN(SELECT interaction_id 
                             FROM   interaction 
                             WHERE  instance_pk = ?) ) 
        OR ( to_interact_id IN(SELECT interaction_id 
                               FROM   interaction 
                               WHERE  instance_pk = ?) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T21:14:51.110

你可以试试这个——尽管你需要对优化器运行它：

```
DELETE FROM interactionrel a
WHERE EXISTS (SELECT * 
              FROM interaction b
              WHERE b.instance_pl = ?
                    AND (b.interaction_id = a.from_interact_id
                         OR b.interaction_id = a.to_interact_id)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:18:33.390

```
DELETE il 
FROM   interactionrel il, 
       interaction 
WHERE  ( interaction.interaction_id = il.from_interact_id 
          OR interaction.interaction_id = il.to_interact_id ) 
       AND interaction.instance_pk = ? 
```

# python - 如何在python中查找特定类的包

> ID：15430826
> 
> 赞同：0
> 
> 时间：2013-03-15T11:08:50.027
> 
> 标签：python, flask

我是 python 新手，我一遍又一遍地遇到同样的老问题。如何找出我打算使用哪些包来为 python 导入东西？我在论坛中看到一些出色的代码可以解决特定问题，但该代码段不包含您需要的包。一个快速的谷歌会出现更多的片段，但仍然不是包，所以我不能使用那个解决方案。

我最近在这个领域遇到的问题是处理一个 BadRequestKeyError 异常，以使用烧瓶网络框架。我使用 eclipse 调试器发现了异常类型，所以我做了以下事情：

```
try:   
    # Some code 
exception BadRequestKeyError as keyError:   
    # Handling Code 
```

现在我在那个异常上遇到了导入错误，所以我尝试查看 flask.exceptions，因为直接导入 x 不起作用（所以我需要 from yz import x）。我什么也找不到。我尝试在网上查找并没有找到我需要的包的参考。是否有某种方式或资源，每个 Python 程序员都知道我不知道？我错过了什么还是这是一个常见问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:26:25.457

您可以使用一些代码搜索引擎来查找它，例如：

[http://code.ohloh.net/search?s=BadRequestKeyError%20&browser=Default](http://code.ohloh.net/search?s=BadRequestKeyError%20&browser=Default)

# objective-c - 为什么这次没有崩溃？

> ID：15430830
> 
> 赞同：0
> 
> 时间：2013-03-15T11:08:57.097
> 
> 标签：objective-c, xcode

所以，我有这个代码：

```
int randomNumber;
int max = 16;
int swap;
int table[16];

srand(time(NULL));
for (int i = 0; i < 16; ++i)
    table[i] = i + 1;

for (int i = 0; i < 16; ++i) {
    randomNumber = rand() % max;
    swap = table[max];
    table[max] = tablica_losowa[losuj];
    table[losuj] = swap;
    --max;
} 
```

显然，问题应该是在 max == 16 并且我尝试访问 table[max] 时首先通过第二个 for 循环，但它编译并运行良好。

这是一个 iPad（最新的软件）应用程序，用 Objective-C、XCode 4.6、Apple LLVM Compiler 4.2 编写。

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:11:27.353

访问由其他人拥有的内存位置并不能保证崩溃，它只能保证你正在做你不应该做的事情。会发生什么取决于内存位置是什么以及它是如何使用的。

编译器根本没有做任何事情来导致这里出现问题。Objective C 基于 C ......它在某些方面更紧凑，但 C 会让你*尝试*做很多事情，无论多么无效，只要语法正确。在您的情况下，写入 table[16]*可能*是写入不重要的内存位置。它可能正在写入`swap`，然后被覆盖。检查组件以确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:33:52.253

问题是C（和Objective-C）没有对“未定义的行为”提供任何保证。数组越界访问`table[16]`就是这种未定义的行为（参见 C11 标准 6.5.6）。

在未定义行为的情况下，这种“不保证”走得很远。然后你的程序可以自由地做任何事情。它可以从网络摄像头拍摄一张照片并将其发布到 Facebook 上，向您的老板发送一封令人反感的电子邮件，然后开始格式化您的硬盘驱动器。虽然不太可能，但就语言所说的而言，这种行为是完全有效的。

因此，忽略错误并继续执行程序显然也很好。

# sql - 避免 SQL 中的 for 循环

> ID：15430834
> 
> 赞同：0
> 
> 时间：2013-03-15T11:09:08.377
> 
> 标签：sql

我有一张桌子，我需要自己加入并找到丢失的物品，但我被卡住了。也许这只是一个经验不足的问题，但我似乎只能用循环来完成我想要的。

基本上该表如下：

```
 packageID     Server
      1           baseline
      2           baseline
      3           baseline
      1           server1
      3           server1
      2           server2
      3           server2 
```

我希望完成的是找出每台服务器缺少哪些包。我可以在服务器的基础上得到这个，如下所示：

```
 SELECT base.*, ISNULL(dp.server,'server1') as Server
    FROM (SELECT DISTINCT packageID FROM DB1
          WHERE server = 'baseline') base
    LEFT OUTER JOIN 
         (SELECT packageID, server FROM DB1
          WHERE server = 'server1') dp
   WHERE dp.server IS NULL 
```

这在单个服务器的基础上为我提供了我想要的东西。

```
 packageID     Server
       2          server1 
```

我将如何完成获取基线中缺少特定服务器的每个包的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:31:55.667

假设一个带有服务器列表的视图，并将其视为伪 SQL，因为我无法对其进行测试，我认为这样的事情应该可以工作......

```
SELECT base.packageID, servers.server, 
             (SELECT count(*) 
                FROM base AS b1
               WHERE b1.packageId = base.packageId
                 AND b1.server    = servers.server) deployed
  FROM base, servers
 WHERE base.server = 'baseline'
   AND deployed = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:56:37.633

试试这个脚本，

```
 DECLARE @DB1 TABLE
(
    PackageID INT
    ,Server VARCHAR(50)
)

INSERT INTO @DB1 VALUES(1,'baseline')
INSERT INTO @DB1 VALUES(2,'baseline')
INSERT INTO @DB1 VALUES(3,'baseline')
INSERT INTO @DB1 VALUES(1,'server1')
INSERT INTO @DB1 VALUES(3,'server1')
INSERT INTO @DB1 VALUES(2,'server2')
INSERT INTO @DB1 VALUES(3,'server2')

;WITH CTE_Package AS
(
    SELECT DISTINCT PackageID 
        , ROW_NUMBER() OVER(order by PackageID) AS ID
    FROM @DB1
)
,CTE_Servers AS
(
    SELECT DISTINCT Server 
        , ROW_NUMBER() OVER(order by PackageID) AS ID
    FROM @DB1
)
,CTE_Server_Packages AS
(
    SELECT DISTINCT P.PackageId, S.Server   
    FROM CTE_Servers S
    CROSS JOIN CTE_Package P    
)
SELECT Server, PackageID
FROM 
(
    SELECT SP.Server, SP.PackageID , D.PackageID [ActualPackage], D.Server [ActualServer]
    FROM CTE_Server_Packages SP
    LEFT JOIN @DB1 D
            ON D.PackageID = SP.PackageID
            AND D.Server = SP.Server
) AS TEMP
WHERE TEMP.ActualServer IS NULL 
```

# eclipse - 如何在 Eclipse 中调试 R 代码

> ID：15430835
> 
> 赞同：4
> 
> 时间：2013-03-15T11:09:08.953
> 
> 标签：eclipse, r, debugging, breakpoints

在过去的几年里，我一直在编写很多 R 代码，但实际上我从来没有找到如何调试 R 代码（我使用的是 Eclipse），而且这非常令人沮丧和耗时。不知道现在可以吗？（断点等。）似乎由于某种原因它不可用。

能否请您指出任何教程，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-14T13:25:21.217

这个eclipse插件对调试R代码很有帮助：

[http://www.walware.de/goto/statet](http://www.walware.de/goto/statet)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T13:25:59.443

不在 Eclipse 中，但 R 有一个很好的调试器包。

```
install.packages("debug")
library(debug)
f = function(x){ print("hello"); return(x+1);}
mtrace(f,T)
f(1) # this will open a debug window
mtrace(f,F) # to stop the function from being debugged (or traced) 
```

# c++ - 将小部件插入 QGridLayout 的问题

> ID：15430837
> 
> 赞同：1
> 
> 时间：2013-03-15T11:09:11.970
> 
> 标签：c++, qt, qgridlayout

我试图创建一个具有以下布局的小部件：

![在此处输入图像描述](../Images/58fe79dff4170cc0795c78361acd2973.png)

我尝试了几种方法，在我的第一个方法中，我使用了 QVBoxLayout 来添加使用 QGridLayout 的不同小部件（所以我会以我想要的方式获得水平调整大小）。

```
//pseudo code, just to show what I tried... 
myHeaderWidget::myHeaderWidget() {
    QGridLayout* layout = new QGridLayout;

    layout->addWidget(new QCheckBox(), 0, 0, 1, -1, Qt::AlignRight | Qt::AlignTop);
    setLayout(layout);
}

oneOfMyOtherWidgets::oneOfMyOtherWidgets() {
    QGridLayout* layout = new QGridLayout;

    layout->addWidget(new QCheckBox(), 0, 0, 1, 1, Qt::AlignLeft | Qt::AlignTop);
    layout->addWidget(new QPushButton(), 0, 1, 1, -1, Qt::AlignLeft | Qt::AlignTop);

    setLayout(layout);
}

mydialog::mydialog() {
    QVBoxLayout* layout = new QVBoxLayout;
    setLayout(layout);

    layout->addWidget(new myHeaderWidget, 0, Qt::AlignRight);
    //here was the third widget containing Descr1 and Description2, as
    //drawn in image above
    layout->addWidget(new oneOfMyOtherWidgets, 0, Qt::AlignLeft);
} 
```

第二种方法是使用 QGridWidget 作为 mydialog 的布局**，**我的第三种方法是将所有这些项目添加到 mydialog 的同一个 QGridWidget**中**。

所有这些结果都是相同的，对我来说很奇怪，行为：在任何时候我创建这些对话框并调用 show()，都可能发生以下情况之一：

1.  所有项目都以我想要的方式绘制。
2.  显示了左侧的复选框，但右侧的按钮覆盖了复选框的描述
3.  左边的复选框是正确的，但我找不到按钮。
4.  按钮占据了所有空间，您根本看不到任何复选框。

有人可以给我一个提示，我做错了什么，或者告诉我一种方法来创建我在图像中绘制的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T09:02:41.397

自己找到的：

```
setColumnStretch(0,1); 
```

失踪。添加的小部件占据了单元格中的整个空间，但单元格从未增长。

# jquery - 将表格单元格文本转换为数组

> ID：15430841
> 
> 赞同：0
> 
> 时间：2013-03-15T11:09:27.437
> 
> 标签：jquery

```
<tr>
    <td>a</td>
    <td>b</td>
</tr> 
```

我知道我可以手动创建一个数组并遍历每个 td 并将它们推送到数组中。

但是有没有办法制作一个带有文本的数组的 jquery 单行代码？

期望的结果：

```
['a', 'b'] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T11:11:07.987

您可以使用[.map](http://api.jquery.com/map/)和[.get](http://api.jquery.com/get/)来解决这个问题，如下所示。

```
var values = $('td').map(function(index, item){
    return $(item).text()
}).get()

console.log(values) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/ZAeYW/)

# ios - 核心数据在 performBlock 中保存子上下文：删除撤消堆栈

> ID：15430843
> 
> 赞同：0
> 
> 时间：2013-03-15T11:09:31.230
> 
> 标签：ios, objective-c, core-data, nsundomanager, uimanageddocument

我正在制作一个绘图应用程序。每次点击都会创建一些核心数据实体。用户可以点击撤消按钮，这些点击一次被撤消。这工作正常。

运行某些自动化任务时会出现问题。我有一个按钮，可以在子上下文中创建一堆核心数据实体（自己绘制一些东西），然后保存上下文，以便更改反映在主上下文中。

问题是无论用户点击任务按钮多少次，所有更改都被分组到一个单独的撤消步骤中。

说清楚：他做了5个任务，然后点击一次撤消，他又回到了开头。但我希望他能够一次撤消每一项任务。

我正在使用 UIManagedDocument ，它是核心数据堆栈。所以它有 2 个上下文，一个写入磁盘，一个子用于一般用途，然后我创建后者的一个子用于后台操作。

这是我的代码：

```
NSManagedObjectContext* childContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
childContext.parentContext = self.document.managedObjectContext;
childContext.undoManager = self.document.undoManager;
[childContext performBlock:^{

    //a lot of things happen here, that generate many entities

    [childContext save:nil];

    [self.document.managedObjectContext performBlock:^{

        //completion stuff, update UI...

    }];
}]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T21:42:24.793

一个想法是将您希望可撤消的每个代码块包含在其自己的块中（具有相同的子上下文）。也许开始把它分成两块，看看它是否有效。

再想一想，我认为每次保存都不是真正的保存，而只是将更改推送到父上下文。所以我的猜测是父上下文将每个孩子注册为一个可撤消的事件。也许您可以尝试更频繁地保存，然后看看这些块是否可以撤消。

# c++ - 类成员是否保证在内存中是连续的？

> ID：15430848
> 
> 赞同：8
> 
> 时间：2013-03-15T11:09:54.367
> 
> 标签：c++

我有一个包含许多函数指针的类，我希望在构造对象时将它们全部初始化为 NULL。为此，我计划在从第一个指针到最后一个指针的内存位置上使用 memset，但是，我不确定这是否能 100% 工作。

是否保证如果这些函数指针在类中连续声明，它们的内存位置也将是连续的。我假设填充不会影响我正在尝试做的事情，因为任何填充字节也只会设置为 NULL 。

示例类实现

```
class C
{
private:
    void (*func1)();
    void (*func2)();
    void (*func3)();
    void (*func4)();
}; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T11:13:46.877

保证它们按照声明的顺序以递增的地址出现。对于没有干预访问说明符的数据成员而言，这通常是正确的，因此如果类中有其他数据成员，那么它们可以干预的唯一方法就是那里有访问说明符。

我认为修改填充字节不能保证安全。我认为不能保证实现不会在数据成员之间放置“重要的东西”，尽管我不能立即想到实现*想要*放在那里的任何东西。为设计奇特的精确标记 GC 输入信息？用于测试缓冲区溢出的可识别值？

不能保证所有位为零表示空函数指针。

您可以使用以下方法处理全位零表示的问题：

```
std::fill(&func1, &func4 + 1, (void(*)(void))0); 
```

但这仍然会留下填充问题。保证数组中没有填充，但（按照标准）在类中没有。您的实现使用的 ABI 可能会在必要的程度上指定结构布局，以确保上述类的布局与 4 个函数指针的数组相同。

另一种方法是执行以下操作：

```
struct function_pointers {
    void (*func1)();
    void (*func2)();
    void (*func3)();
    void (*func4)();
};

class C : private function_pointers
{
public:
    C() : function_pointers() {}
}; 
```

初始化程序`function_pointers()`规定（因为它没有用户声明的构造函数）的成员`function_pointers`是零初始化的，即使`C`它本身的实例只是默认初始化的。`function_pointers`可以是数据成员而不是基类，如果您更喜欢输入更多内容来访问`func1`等。

请注意，`C`现在在 C++03 中是非 POD。在 C++11`C`中，在此更改之后仍然是标准布局，但如果在 中定义了任何数据成员，则不会是标准布局`C`，并且它不是一个平凡的类。因此，如果您依赖 POD/标准/琐碎性，请不要这样做。而是保留`C`原样的定义并使用聚合初始化 ( `C c = {0};`) 将 C 的实例初始化为零。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T11:13:04.103

先做这个。

```
class C
{
public:
    C() : func1(nullptr), func2(nullptr), func3(nullptr), func4(nullptr)
    { };
private:
    void (*func1)();
    void (*func2)();
    void (*func3)();
    void (*func4)();
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T11:12:28.950

*除非你真的知道你在做什么，否则*永远不要在 C++ 中这样做。*这很容易出错，并且您的代码的未来维护者（甚至可能是您！）可能不会认识到所有存在的缺陷，并且事情可能会出现可怕的错误。实现此目的的 C++ 方法是编写一个构造函数，该构造函数正确初始化函数指针`nullptr`（如果您使用 C++11）或`0`.*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T11:32:26.717

永远不要在非平凡的对象上使用 memset，尤其是那些多态的对象（具有虚函数或从具有虚方法的基类派生等）。如果你这样做，你会炸毁指向**vtable的****vptr**！灾难！

 ****vptr** & **vtable**用于实现多态行为，因此尊重那些隐藏的类成员。

当我们谈论位和字节时应该使用 memset，而不是谈论对象时。

尊重非平凡的对象，对 memset 说不 :)***

# jquery - jquery包装相邻元素组

> ID：15430851
> 
> 赞同：6
> 
> 时间：2013-03-15T11:09:56.467
> 
> 标签：jquery, css, dom

我有一个允许用户在页面上插入内容块的 cms。用户可以使用不同类型的内容块，它们可以按任何顺序插入。示例高级 dom 结构可能如下所示：

```
<p>Some rich text</p>

<div class="box">...</div>
<div class="box">...</div>
<div class="box">...</div>

<h3>Some  more rich text</h3>
<p>Lorem ipsum</p>

<div class="box">...</div>
<div class="box">...</div> 
```

我想要做的是将任何相邻的“盒子”div 包装在一个包装“容器”div 中。因此，在上面的示例中，将插入两个“容器”div，因为有两组盒子 div，结果是：

```
<p>Some rich text</p>

<div class="container">
    <div class="box">...</div>
    <div class="box">...</div>
    <div class="box">...</div>
</div>

<h3>Some  more rich text</h3>
<p>Lorem ipsum</p>

<div class="container">
    <div class="box">...</div>
    <div class="box">...</div>
</div> 
```

我不认为有一个聪明的方法可以用 css 选择器来做，所以有人知道用 jQuery 做这个吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-01-05T19:55:03.977

您可以使用

1.  [`.nextUntil`](https://api.jquery.com/nextUntil/), 得到所有的下一个`.box`。
2.  [`.andSelf`](https://api.jquery.com/andself/)将当前元素添加到集合中
3.  [`.wrapAll`](http://api.jquery.com/wrapall/)将每个集合包装到不同的`.container`

```
$('.box').not('.box+.box').each(function(){
  $(this).nextUntil(':not(.box)').addBack().wrapAll('<div class="container" />');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>Some rich text</p>

<div class="box">...</div>
<div class="box">...</div>
<div class="box">...</div>

<h3>Some  more rich text</h3>
<p>Lorem ipsum</p>

<div class="box">...</div>
<div class="box">...</div>
```

[http://jsbin.com/gonino/edit?html,js](http://jsbin.com/gonino/edit?html,js)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T11:37:35.247

好吧，您可以像我刚刚编写的这个[JSFiddle 示例那样进行操作。](http://jsfiddle.net/7NCDf/)

这基本上循环遍历每个`.box`将其添加到数组并确定下一个元素是否也具有`.box`该类：

```
var collection = [];
$('.box').each(function() {
    var nextBox = $(this).next().hasClass('box');
    ...
    collection.push($(this));
}) 
```

如果下一个元素*没有*类，它会创建包含分隔符，在数组中的第一个元素被定位`.box`之前将其放在页面上，然后用于将所有分隔符移动到其中：`.box``collection``appendTo``.box`

```
 if(!nextBox)
    {
        var container = $('<div class="collection"></div>');
        container.insertBefore(collection[0]);
        for(i=0;i<collection.length;i++)
        {
            collection[i].appendTo(container);
        }
        collection = [];
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T11:47:46.093

小提琴在这里：http: [//jsfiddle.net/jdelight/XutA6/5/](http://jsfiddle.net/jdelight/XutA6/5/) 这是一个使用css的可能解决方案，它可以让您使用单一背景颜色和边框来设置块的样式。HTML 将是这样的：

```
 <div class="block">this is block 1</div>
    <div class="block">this is block 2</div>
    <div class="block">this is block 3</div>
    <div class="block">this is block 4</div>
    <div class="block">this is block 5</div> 
```

CSS 将是：

```
 /* style all blocks with the required background colour and border */
        .block {
            background: #eee;
            color: #000;
            border: 1px solid red;
            border-bottom: 0;
            padding: 20px;
            width: 400px;
            border-radius: 20px;
            /* remove the rounded corners from he bottom left/right */
            border-bottom-left-radius:0;
            border-bottom-right-radius:0;
            position: relative;
        }
        /* style all adjacent blocks and remove the radius - so the top block has a radius and the others don't */
        .block + .block {
            border-radius: 0;
            border-top: 0;
        }

        /* create a cheeky block with content after which sits below all blocks */
        /* so it's hidden from all the blocks above it apart from the very bottom one (see bottom: -10px) */
        /* then style the rounded corners on that one */
        .block::after {
            content:'.';
            display: block;
            background: red;
            height: 10px;
            position: absolute;
            border-bottom: 1px solid red;
            border-left:  1px solid red;
            border-right:  1px solid red;
            bottom: -10px;
            width: 440px;
            background: #eee;
            left:-1px;
            border-bottom-left-radius:10px;
            border-bottom-right-radius:10px;
        } 
```

# java - 如何在 SD 卡上创建文件夹“beam”（“/sdcard/beam”）

> ID：15430858
> 
> 赞同：0
> 
> 时间：2013-03-15T11:10:14.083
> 
> 标签：java, android, directory

我需要在 SD 卡上创建一个文件夹“BEAM”，但它告诉我无法创建该文件夹。

我使用了这段代码：

```
 File mediaDir = new File("/sdcard/beam");
        / / Create a folder if not exists
        if (!mediaDir.exists()) {
            mediaDir.mkdir(); // this code return false
        } 
```

文件夹“梁”是否受到保护？

我也有这个Android权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:12:18.770

试试下面的代码。不要使用像**'sdcard'**或**'mnt/sdcard'这样的核心字符串**

```
File f = new File(android.os.Environment.getExternalStorageDirectory(),File.separator+"beam/");
f.mkdirs(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:12:55.563

它并不总是在同一个位置，请尝试使用

> Environment.getExternalStorageState() 返回内部 SD 挂载点的路径，如“/mnt/sdcard”

例如，我的手机位置是 /storage/sdcard0/

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:14:03.387

参考下面的代码

```
 if (android.os.Environment.getExternalStorageState().equals(
                 android.os.Environment.MEDIA_MOUNTED)) {

                 File f = new File(
                         Environment.getExternalStorageDirectory() + File.separator + "beam");
                 f.mkdirs();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T11:15:03.780

您是否尝试过使用“adb shell”创建文件夹，然后使用“mkdir /sdcard/beam”？它应该可以正常工作。如果不是，您应该了解一下，出了什么问题。另外，不要对 sdcard 文件夹进行硬编码。看：

[在 /sdcard 中创建目录失败](https://stackoverflow.com/questions/3853472/creating-a-directory-in-sdcard-fails)

[Android mkdir 没有创建文件夹](https://stackoverflow.com/questions/5958600/android-mkdir-not-making-folder)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T11:26:40.350

您的代码是正确的，只是您缺少一个`/`后束字，添加它并像下面的代码一样重试，

```
File mediaDir = new File("/sdcard/beam/");  // / is added after beam
// Create a folder if not exists
if (!mediaDir.exists()) 
{
     mediaDir.mkdir(); // this code return false
} 
```

# .net - 在 Windows 应用程序中没有 MS Office 的 Excel 导入失败

> ID：15430861
> 
> 赞同：0
> 
> 时间：2013-03-15T11:10:27.463
> 
> 标签：.net, excel, ms-office, windows-forms-designer

我有一个在 Visual Studio 上运行的 .net Windows 应用程序，我正在上传一个 Excel 工作表并处理一些数据。我刚买了一个全新的笔记本，上面只安装了 MS word ***（编辑：MS word 和 MS Excel）***查看器（还没有安装 MS Office）。当我尝试上传 excel 表并期望数据显示时，它并没有这样做。

原因是没有在机器上安装 MS Office 吗？但是，该应用程序引用了 Interop.Excel dll。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T12:13:00.970

至少您需要安装 Excel Viewer。根据您正在做的事情，您可能需要一个实际的 Excel 安装。

# javascript - 未从服务器加载外部 javascript

> ID：15430866
> 
> 赞同：0
> 
> 时间：2013-03-15T11:10:41.090
> 
> 标签：javascript

我做了一个测试函数“sayHello()”，它会提醒你好。如果我打开 .html 文件的本地版本，它将完美运行并提醒你好。但是，当我上传此 iPage 服务器时，它将无法正常工作。无论我做什么，我都无法从外部 js 文件中运行函数。现在，如果我在页面（.html 或 .php）中编写了 javascript，它将按预期执行而不会出现问题。但不是来自外部文件。

我的问题是，外部 js 函数如何在本地而不是远程执行？

.html 文件

```
 <head>
<title></title>
<script src="test.js"></script>
<script>sayHello();</script>
 </head> 
```

js函数

```
 function sayHello(){
      alert("hello");
 } 
```

# linux - bash：xargs 传递变量

> ID：15430877
> 
> 赞同：12
> 
> 时间：2013-03-15T11:11:09.667
> 
> 标签：linux, bash, variables, xargs

如何将全局脚本变量传递给 xargs 的命令？我试过这样：

```
TEST=hallo2
echo "hallo" | xargs sh -c 'echo passed=$1 test=$TEST' sh 
```

输出：

```
passed=hallo test= 
```

我知道我可以使用`{}`令牌，但我需要这样做！

我正在使用`bash`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T11:20:16.530

`$TEST`从引号中取出变量：

```
 TEST=hallo2
 echo "hallo" | xargs sh -c 'echo passed=$1 test='$TEST sh 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-15T13:54:32.400

作为@chepner 建议的答案添加。

`export`变量`TEST`：

```
export TEST=hallo2
echo "hallo" | xargs sh -c 'echo passed=$1 test="$TEST"' sh 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2013-04-19T22:33:54.307

使用 GNU Parallel，您可以避免一些引用：

```
TEST=hallo2
echo "hallo" | parallel echo passed={} test=$TEST 
```

GNU Parallel 作为大多数发行版的包存在，建议使用普通包管理器进行安装。但是如果您的系统没有软件包，安装 GNU Parallel 仍然需要 10 秒。

观看介绍视频以了解更多信息：[https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

# iphone - 录制声音并在iphone中同时播放相同的声音

> ID：15430878
> 
> 赞同：2
> 
> 时间：2013-03-15T11:11:09.697
> 
> 标签：iphone, ios, avaudioplayer, avaudiorecorder, avaudiosession

我想同时通过我的应用程序录制声音并播放相同的声音。

录下了声音：-

```
 NSString *soundFilePath = [docsDir
                               stringByAppendingPathComponent:@"sound.caf"];
    NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];    
    NSDictionary *recordSettings = [NSDictionary
                                    dictionaryWithObjectsAndKeys:
                                    [NSNumber numberWithInt:AVAudioQualityMin],
                                    AVEncoderAudioQualityKey,
                                    [NSNumber numberWithInt:16],
                                    AVEncoderBitRateKey,
                                    [NSNumber numberWithInt: 2],
                                    AVNumberOfChannelsKey,
                                    [NSNumber numberWithFloat:44100.0],
                                    AVSampleRateKey,
                                    nil];

    NSError *error = nil;

    audioRecorder = [[AVAudioRecorder alloc]
                     initWithURL:soundFileURL
                     settings:recordSettings
                     error:&error];

    if (error)
    {
        NSLog(@"error: %@", [error localizedDescription]);
    } else {
        [audioRecorder prepareToRecord];
        [audioRecorder record];
    }

-(void)StopRecord{
[audioRecorder stop];
 NSString *soundFilePath = [docsDir stringByAppendingPathComponent:@"sound.caf"];

    NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];  
    AVAudioPlayer *newPlayer =
    [[AVAudioPlayer alloc] initWithContentsOfURL:soundFileURL error: nil];    
    if([soundFileURL isFileURL]){
        printf("isFileURL\n");
    }   
    [newPlayer prepareToPlay];
    [newPlayer setDelegate: self];
       [newPlayer play];

} 
```

现在通过这个..我录制声音，当我单击某种方法时，录制停止并开始播放..我该怎么办..它在我开始录制的同时播放声音..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T12:33:38.287

我通过使用 SC_listner 得到了解决方案。

```
[[SCListener sharedListener] listen];   

   if ([SCListener sharedListener] != nil)
    {
        Float32 percentage = [[SCListener sharedListener] peakPower];
        } 
```

通过这样做..我可以检测到实时的音高

# c# - 我可以在 Windows 窗体中托管的浏览器控件中检测 jscript window.close 事件吗？

> ID：15430879
> 
> 赞同：0
> 
> 时间：2013-03-15T11:11:16.253
> 
> 标签：c#, javascript

我的客户要求在用户登录时显示“启动画面”。目前，我的客户端使用实例化**System.Windows.Forms.WebBrowser**类的 Windows 应用程序来托管网页，但由于各种原因，这是不合适的。

我的客户要求我创建一个无 chrome 模式的 Windows 窗体，该窗体将包含一个浏览器控件，该控件将托管该网页。此页面由一条消息和两个按钮组成：“是”（导航到另一个 URL）和“否”（关闭浏览器）。

在当前（不令人满意的）化身中，“否”按钮调用一个 javascript 函数，其中包括

```
window.close(); 
```

目前这工作正常，但显然如果（在新版本中）网页托管在 Windows 窗体内的浏览器控件中，则 window.close 不会自动冒泡到 Windows 窗体。

那么，Windows 窗体有没有办法“检测”浏览器控件中发生的 window.close 事件？

我希望上述是清楚的。

非常感谢

爱德华

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T14:23:01.487

感谢大家。

通过一些额外的挖掘 Sudhakar B 的答案有效。我不得不添加

```
 [System.Runtime.InteropServices.ComVisibleAttribute(true)] 
```

来装饰班级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:19:39.840

而不是调用 window.close 从 javascript 调用您的外部 C# 函数，像这样

```
window.external.CloseWindow 
```

并将您的对象设置为脚本

```
webBrowser1.ObjectForScripting = this; 
```

你的 C# 类应该有 CloseWindow 函数

或覆盖 window.close 之类的

```
window.close=function() { window.external.CloseWindow(); } 
```

# autohotkey - 具有两个 xy 位置的 AHK 像素监视器

> ID：15430884
> 
> 赞同：0
> 
> 时间：2013-03-15T11:11:22.583
> 
> 标签：autohotkey

我正在使用 AutoHotKey 程序，并且我有一个脚本可以监视某个像素及其颜色，如果它发生变化，它会做一些事情使颜色变回原样。因此，假设它正在查看像素 100、100，并且颜色为 0xFFFFFF，如果颜色更改为 0xFFFFFF 以外的任何颜色，则脚本将按下数字 5 键，然后返回 0xFFFFFF。这非常有效，现在我在这里的目的是帮助获取一个脚本来监控两个 x、y 位置和两种单独的颜色，并使用两个不同的键将所述颜色更改回被监控的颜色。该脚本主要用于玩在线电脑游戏，如 Ragnarok Online 或 WoW。

这是监控 ONE x,y 和 ONE 颜色的代码

```
#Persistent 
CoordMode, Pixel, Relative 

X := 100
Y := 100
SetColor := 0xC48559

SetTimer, WatchLife, 100
Return

WatchLife: 
Pixelgetcolor, Color, %X%, %Y%
if (Color = SetColor)
    Return 
    Else 
  Send, 5
  Sleep 20
Return 
```

这个脚本会监视血条，当它低于某个区域时，它会自动按数字 5 键来使用血药来恢复血条。这对游戏玩家有很大帮助，因此他们不必过多关注自己的生命值，而更多地专注于攻击玩家或怪物。

现在我需要一种方法让一个脚本执行两次，AutoHotKey 程序不允许重复某些行，因此您不能在一个脚本中复制粘贴两次，是的，您可以通过更改来使用此脚本两次x，y 和颜色代码，但是一次运行多个脚本可能会与其他脚本混淆，我已经看到这种情况发生并且在我使用另一个脚本运行此脚本时发生过几次。

我试过这段代码；

```
#Persistent 
CoordMode, Pixel, Relative 

X := 100
Y := 100
SetColor := 0xC48559

X := 100
Y := 80
SetColor := 0xF0DED7

SetTimer, WatchLife, 100
Return

WatchLife: 
Pixelgetcolor, 0xC48559, 100, 100
if (Color = SetColor)
   Return 
Else 
   Send, 5
   Sleep 20
Pixelgetcolor, 0xF0DED7, 100, 80
if (Color = SetColor)
   Return 
Else 
   Send, 6
   Sleep 20
Return 
```

我认为这会起作用，但是当像素中的颜色存在时，它只会将 HP 和 MP 的治疗项目的键发送到垃圾邮件中。我在 AutoHotKey 的主网站和论坛上进行了搜索，但我没有看到任何关于拥有此脚本的信息。

请帮忙，这个脚本可以帮助任何玩类似于 WoW 或 Ragnarok Online 的在线电脑游戏的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:58:36.897

这个怎么样。我修改了第一个脚本，以便可以在我的环境中对其进行测试。

您生成了大量发送指令，因为您没有定义 PixelGetColor 应存储的变量，因此 If 语句始终为 false。您在第一个 If 之后也有一个返回，因此仅当第一个 If 为假时才执行第二个 If（这是您的脚本中的情况，但不应该如此）。

```
Persistent 
CoordMode, Pixel, Relative 

X1 := 200
Y1 := 200
SetColor1 := 0x999999

X2 := 200
Y2 := 1000
SetColor2 := 0xFFFFFF

SetTimer, WatchLife, 500
Return

WatchLife:
    Pixelgetcolor, Color, %X1%, %Y1%
    if (Color <> SetColor1)
        SoundBeep, 500, 200
    Pixelgetcolor, Color, %X2%, %Y2%
    if (Color <> SetColor2)
        SoundBeep, 1000, 200
Return 
```

如果您想在发送击键后等待，那么您应该在 If 语句中包含等待，就像这样。

```
Persistent 
CoordMode, Pixel, Relative 

X1 := 100
Y1 := 100
SetColor1 := 0xC48559

X2 := 100
Y2 := 80
SetColor2 := 0xF0DED7

SetTimer, WatchLife, 500
Return

WatchLife:
    Pixelgetcolor, Color, %X1%, %Y1%
    if (Color <> SetColor1)
    {
        Send, 5
        Sleep, 20
    }
    Pixelgetcolor, Color, %X2%, %Y2%
    if (Color <> SetColor2)
    {
        Send, 6
        Sleep, 20
    }
Return 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T14:14:24.850

你可以先试试这个。打开记事本（白色背景）并最小化所有其他应用程序（仅桌面）。移动记事本窗口，使空白区域位于两个鼠标位置中的任何一个之上、两个鼠标位置之上或两个鼠标位置之一之上。您可以使用`Ctrl`+退出`q`，因为您不能真正使用鼠标退出 AHK。

根据具体情况，您不会听到哔声，只有一声哔声（高或低）或两声哔声（高和低）。鼠标将指向像素所在的位置。

```
#Persistent 
CoordMode, Pixel, Screen
CoordMode, Mouse, Screen 

X1 := 100
Y1 := 100
SetColor1 := 0xFFFFFF

X2 := 600
Y2 := 100
SetColor2 := 0xFFFFFF

SetTimer, WatchLife, 6000
Return

WatchLife:
    MouseMove, %X1%, %Y1%
    Pixelgetcolor, Color, %X1%, %Y1%
    TrayTip,, %Color%
    if (Color <> SetColor1)
    {
        SoundBeep, 500, 200
    }
    Sleep, 1000
    MouseMove, %X2%, %Y2%
    Pixelgetcolor, Color, %X2%, %Y2%
    TrayTip,, %Color%
    if (Color <> SetColor2)
    {
        SoundBeep, 1000, 200
    }
Return

^q::
ExitApp 
```

# java - 搜索字符串并获取第二个匹配项

> ID：15430887
> 
> 赞同：0
> 
> 时间：2013-03-15T11:11:44.307
> 
> 标签：java, string, groovy

我上周开始学习 Groovy，但遇到了一些代码问题。我想做的事：

我有一个很大的名称列表和一个用户输入，例如“Hi Bob I am Sue”，它以字符串形式给出。我想获取这个字符串，查看名称列表，如果该字符串包含一个问候语和两个名称，则获取第二个名称并将其打印在如下输出中：“Hi Sue, nice to meet you”。上面例子中给出的名字“Bob”总是一样的，所以在我的代码中我把它放到了一个单独的字符串中，但是后面的名字可以是任何名字（其实也可以是不在名单，但我不知道如何解决这个问题，所以这是另一回事）。

到目前为止我得到的并不多：

```
String fixedname=new String('bob')
def name=["bob","sue","peter","dr spock"] 
def greeting=["hi","hello"] 
String input= new String ('Hi bob i am sue') 

if(input.contains(fixedname) || input.contains(greeting)) 
```

“然后查看名称列表并打印固定名称之后的名称。” 我不知道如何将引号之间的句子放入正确的代码中。有人可以帮忙或给我一个提示吗？

非常感谢提前和亲切的问候，凯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T03:25:07.890

您可能会考虑使用正则表达式。这是使用您的示例进行的快速概念介绍。

```
def matcher= ('Hi bob i am dr spock'.toUpperCase() =~ /HI BOB I AM (SUE|PETER|DR SPOCK|BOB)/)
assert matcher[0][1]== 'DR SPOCK'
println("Hi ${matcher[0][1]}, nice to meet you") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:46:27.220

你的意思是这样的？

```
String fixedname = 'Bob'
List names = [ 'Bob', 'Sue', 'Peter', 'Dr Spock' ] 
List greeting = [ 'Hi', 'Hello' ] 

String input = 'Hi Bob I am Sue'

             // if the input string contains one of the greetings
def others = greeting.find { input.contains( it ) } ?
               // Split the string and return all names apart from the first one
               input.tokenize().findAll { it in names }.drop( 1 ) :
               // Otherwise others = null
               null

assert others == [ 'Sue' ] 
```

尽管我怀疑您尝试做的事情并非微不足道，但您可能会更好地研究某种自然语言处理库

# regex - 是否可以在字符串的特定索引之间匹配正则表达式

> ID：15430890
> 
> 赞同：1
> 
> 时间：2013-03-15T11:11:48.287
> 
> 标签：regex

例如，如果我有一个电话号码，并且我想查看最后两位数字中的任何一个是否包含 7。我可以纯粹使用正则表达式来做到这一点，还是必须先将字符串分开？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:18:50.007

您可以使用正则表达式：

```
7\d?$ 
```

这将在末尾或倒数第二个位置匹配 7。或者，更准确地说，它匹配字符串末尾的 7，可选地后跟另一个数字，该数字转换为最后两个位置之一的 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:47:16.067

您可以使用环视来匹配字符串的任意索引，我们将使用环视`(?<=)`来检查我们是否`start of string` 在左侧跟随了固定数量的字符。并向前看`(?=)`以检查我们是否在右侧有固定数量的字符，然后是`end of string`.

从字符串开始的索引：

```
(?<=^.{N})REGEX 
```

您`REGEX`将从第 N 个（从零开始）索引匹配，因此如果您想检查左边的第三个字符是否`x`在以下字符串中，`12x45`那么您将使用`(?<=^.{2})x`where `x`is 正则表达式来检查字符是否为`x`.

使用前瞻你可以从头开始做同样的事情：

```
REGEX(?=.{N}$) 
```

因此，要检查最后 2 位数字中的任何一个是否为 7，您的正则表达式将是`7\d?(?=.{0}$)`（这相当于 Joey 提出的。但正如您所看到的，这适用于所有索引（并不是说您应该使用它而不是更简单的索引，它只是一个更通用的正则表达式）。

如果您想检查左侧第三个（从零开始）字符`x`是否是`x(?=.{2}$)`.

您还可以将两者结合起来检查索引之间，例如，您想检查两端第 3 位之间的所有内容是否是任意数量的`x`'，`12xxxxxx21`那么您有以下内容：

```
(?<=^.{2})x*(?=.{2}$) 
```

**注意：**
如果您只想要一个匹配/不匹配的正则表达式，那么您可以不使用环视，但是您将匹配整行而不是仅匹配您在`REGEX`.

例如：

`(?<=^.{2})x*(?=.{2}$)`将匹配`xxxxxx`上面的示例，其中 as`^.{2}x*.{2}$`将匹配字符串，但它将匹配整个事物 ( `12xxxxxx21`) 而不是`xxxxxx`.

# validation - struts2 验证框架只是将错误消息打印到控制台，而不是重定向到输入 jsp

> ID：15430891
> 
> 赞同：1
> 
> 时间：2013-03-15T11:11:49.493
> 
> 标签：validation, struts2

我正在使用 struts2 验证框架，我只想验证 TestAction 类中的 test() 方法，这是我的代码和配置：

```
@Namespace(value = "/")
@Result(name="input", location="test_input.jsp")
public class TestAction
{
private String  name;

public String getName()
{
    return name;
}

public void setName(String name)
{
    this.name = name;
}

@Action(value = "test", results = { @Result(name = "success", location = "test.jsp")})
public String test() throws Exception
{
    return "success";
}

@Action(value = "show", results = { @Result(name = "success", location = "test_input.jsp")})
public String show() throws Exception
{
    return "success";
}
} 
```

test_input.jsp：

```
 <body>
<s:fielderror></s:fielderror>
<s:form action="test.do" theme="xhtml">
    <s:textfield name="name" label="name"></s:textfield>
    <s:submit value="submit"></s:submit>
</s:form>
</body> 
```

测试.jsp：

```
<body>
success
<s:debug></s:debug>
</body> 
```

TestAction-test-validation.xml：

```
<validators>
<field name="name">
    <field-validator type="requiredstring">
        <message>name is required.</message>
    </field-validator>
</field>
</validators> 
```

TestAction.class 和 TestAction-test-validation.xml 在同一个包中。

struts.xml：

```
<struts>

<constant name="struts.enable.DynamicMethodInvocation" value="true" />
<constant name="struts.devMode" value="true" />
<constant name="struts.ui.theme" value="simple" />
<constant name="struts.ognl.allowStaticMethodAccess" value="true" />

<constant name="struts.action.extension" value="do" />
<constant name="struts.objectFactory" value="spring" />
<constant name="struts.convention.result.path" value="/" />

<include file="struts-default.xml"></include>

<package name="default" namespace="/" extends="struts-default">
    <default-interceptor-ref name="defaultStack"></default-interceptor-ref>
    <global-results>
        <result name="error">error.jsp</result>
    </global-results>

    <global-exception-mappings>
        <exception-mapping exception="java.lang.Exception"
            result="error" />
    </global-exception-mappings>

</package>
</struts> 
```

网页.xml：

```
<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>*.do</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>INCLUDE</dispatcher>
</filter-mapping> 
```

我开始通过浏览器访问show.do，出现一个输入和按钮，我没有在输入中输入任何内容，直接点击按钮，页面进入test.do并在页面中显示'success'，我看在“调试”内容中，其中没有任何错误消息。但奇怪的是：[ERROR] name:name 的验证错误是必需的。上面的信息打印在eclipse控制台（我在eclipse中启动tomcat）错误信息意思是TestAction-test-validation.xml必须由struts2执行，但是为什么它没有重定向到test_input.jsp？我已经定义了一个输入结果。

我的配置有问题还是缺少其他配置？

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T15:23:34.580

尝试`ActionSupport`从您的操作扩展。

```
public class TestAction extends ActionSupport { 
```

包含它总是一个好主意，通常没有理由*不在*项目的每个动作中扩展它。

PS：这样你可以返回`SUCCESS`而不是`"success"`等

# c# - 在列表框中循环

> ID：15430899
> 
> 赞同：-3
> 
> 时间：2013-03-15T11:12:07.837
> 
> 标签：c#, mysql, winforms

我想循环我的列表框，以便它显示一个名称，然后在它旁边显示一个分数。

有没有办法做到这一点？

```
 MySqlConnection myConn = new MySqlConnection(connStr);

 DataTable dTable = new DataTable();

 string squery = "SELECT * FROM highscore";
 MySqlDataAdapter dAdapter = new MySqlDataAdapter(squery, myConn);

 dAdapter.Fill(dTable);
 dAdapter.Dispose();

 lstNames.DataSource = dTable;
 lstNames.DisplayMember = "Name";
 lstNames.ValueMember = "Name"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:14:51.503

您可以从查询中获取格式化/连接的结果，而不是循环并在列表框中添加项目，例如：

对于 MySQL，您需要使用[CONCAT](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat)方法进行连接。

```
SELECT CONCAT(`Name` + ' ' + `Score`) AS `NAMESCORE`, * from highscore; 
```

接着：

```
lstNames.DisplayMember = "NAMESCORE";
lstNames.ValueMember = "NAMESCORE"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:14:02.030

尝试这个

```
for (int i = 0; i < lstFields.Items.Count; i++)
        {
            var item = lstNames.Items[i] ;
            // Do with current item now
        } 
```

# javascript - 如何在 Jquery 周历主题“解析 JSON”中编码 json 对象

> ID：15430909
> 
> 赞同：0
> 
> 时间：2013-03-15T11:12:44.060
> 
> 标签：javascript, jquery, ruby-on-rails, json

我在我的项目中使用周历（[https://github.com/themouette/jquery-week-calendar/wiki](https://github.com/themouette/jquery-week-calendar/wiki)）并且语言是 ruby​​ on rails 但我的 ruby​​ 代码中的 JSON 对象存在问题，该对象将 JSON 数据返回到 weekcalendar .js 文件。如何将 JSON 对象的 JSON 编码为 2d 数组到 JSON 数组格式？

请参阅此代码：

```
data : function(start_at,end_at,callback) { 
    $.post('/events', { 

     },
        function(result){ \\this function is a receive JSON object from ruby
        console.log(data); 
        getEventData(result)
     },'json');        
  } 
```

这是 console.log(data) 的 JSON 对象：

```
[Object { created_at="2013-03-12T11:08:34Z",  end_at="2013-03-12T00:00:00Z",  event_description="wqe",more...}, Object { created_at="2013-03-12T11:08:41Z",  end_at="2013-03-12T00:00:00Z",  event_description="wqe",  more...}, Object { created_at="2013-03-12T11:10:26Z",  end_at="2013-03-13T00:00:00Z",  event_description="ewr",  more...}, Object { created_at="2013-03-12T11:15:39Z",  id=4,  updated_at="2013-03-12T11:15:39Z"}, Object { created_at="2013-03-12T11:16:45Z",  id=5,  updated_at="2013-03-12T11:16:45Z"}, Object { created_at="2013-03-12T11:17:21Z",  id=6,  updated_at="2013-03-12T11:17:21Z"}, Object { created_at="2013-03-13T05:13:39Z",  id=7,  updated_at="2013-03-13T05:13:39Z"}, Object { created_at="2013-03-14T08:11:50Z",  id=8, ...}] 
```

好的，我有 JSON 对象，现在函数 getEventData(data)，我做 jQuery.parseJSON(data); 用于编码 JSON 对象但没有结果。

请看这个：

```
function getEventData(data) {
      var eventData = jQuery.parseJSON(data);
      console.log(eventData);
      /*return {
         events:[
            {
               "id":eventData.id,
               "start": eventData.start,
               "end": eventData.end,
               "title": eventData.name,

            }
         ]
      };*/ 
```

结果 console.log(eventData); 是一个空值。

现在好了。如何将 JSON 对象的 JSON 编码为 2d 数组到 JSON 数组格式以返回有效。感谢您的每一个想法，并为我的英语能力感到抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:00:00.353

您的第一个功能也有错误。你调用 console.log(data) 然后你用一个可变的结果调用你的函数。

我相信您不需要在其上使用 jQuery.parseJSON，因为它已经是一个对象。这是文档中关于 parseJSON 的说明：

```
Description: Takes a well-formed JSON string and returns the resulting JavaScript object. 
```

您的数据已经是一个已解析的 json（对象），因此您可以直接使用 json 格式而无需对其进行解析。

所以你的代码是：

```
data : function(start_at,end_at,callback) { 
  $.post('/events', { 

  },
    function(data){ \\this function is a receive JSON object from ruby
    console.log(data); 
    getEventData(data)
  },'json');        
}

function getEventData(data) {
  var events = new Array();
  $.each( data, function( key, value ) {
    events.push({
           "id":value.id,
           "start": value.start,
           "end": value.end,
           "title": value.name,

        });
  });
  return events;
} 
```

# javascript - 使用 jQuery-mobile 转换以不同方式加载页面

> ID：15430912
> 
> 赞同：1
> 
> 时间：2013-03-15T11:12:54.640
> 
> 标签：javascript, android, jquery, html, jquery-mobile

我有一个网站在直接加载时可以正常工作（通过调用其 URL），但是，当我通过滑块转换进入该网站时：

```
<li><a href="html/mySite.html" data-transition="slide">mySite</a></li> 
```

似乎它不会加载刚刚在 head 中声明为的 .js 文件：

```
<script type="text/javascript" src="../../myJS.js"></script> 
```

我是 jQuery mobile、jQuery、HTML5 和 JS 的新手。那么......有人可以向我解释一下关于页面加载的 URL 调用和 jQuery 移动转换之间的区别是什么？

（顺便说一句。我正在使用它来开发 Android 应用程序）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T11:27:39.053

在多个**`HTML`**文件的情况下，**`HEAD`**仅在第一个**`HTML`**文件中加载。在其他文件中，仅**`BODY`**加载内容。这是因为**`AJAX`**用于将其他页面加载到**`DOM`**. 因为原始内容中已经有**`HEAD`**内容，所以**`DOM`**只会从其他页面加载正文。

**`AJAX`**如果您完全打开加载，或者如果您在第一个文件中初始化所有 js 文件，则可以防止这种情况**`HTML`**。

如果您想了解更多信息，请查看我的其他**[答案](http://www.gajotres.net/how-jquery-mobile-page-handling-affects-javascript-executions/)**以及其他几种解决方案，或者在**[这里](https://stackoverflow.com/questions/15800121/why-i-have-to-put-all-the-script-to-index-html-in-jquery-mobile/15806954#15806954)**找到它。

## 示例 1：正确的方式

**HTML 1：**

```
<!DOCTYPE html>
<html>
<head>
    <title>jQM Complex Demo</title>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script> 
    <script>
              $(document).on('pagebeforeshow', '#index', function(){       
                        alert('Page One');
                });

                $(document).on('pagebeforeshow', '#second', function(){       
                        alert('Page Two');                  
                });         
    </script>      
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>   
</head>
<body>
    <div data-role="page" id="index">
        <div data-theme="a" data-role="header">
            <h3>
                First Page
            </h3>
            <a href="second.html" class="ui-btn-right">Next</a>
        </div>

        <div data-role="content">

        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div>    
</body>
</html> 
```

**HTML 2：**

```
 <div data-role="page" id="second">
        <div data-theme="a" data-role="header">
            <h3>
                Second Page
            </h3>
            <a href="index.html" class="ui-btn-left">Back</a>
        </div>

        <div data-role="content">

        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div> 
```

## 示例 2：不正确的方式

**HTML 1：**

```
<!DOCTYPE html>
<html>
<head>
    <title>jQM Complex Demo</title>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script> 
    <script>
              $(document).on('pagebeforeshow', '#index', function(){       
                        alert('Page One');
                });     
    </script>      
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>   
</head>
<body>
    <div data-role="page" id="index">
        <div data-theme="a" data-role="header">
            <h3>
                First Page
            </h3>
            <a href="second.html" class="ui-btn-right">Next</a>
        </div>

        <div data-role="content">

        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div>    
</body>
</html> 
```

**HTML 2：**

```
<!DOCTYPE html>
<html>
<head>
    <title>jQM Complex Demo</title>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script> 
        <script>
                $(document).on('pagebeforeshow', '#second', function(){       
                        alert('Page Two');                  
                }); 
        </script>         
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>   
</head>
<body>    
    <div data-role="page" id="second">
        <div data-theme="a" data-role="header">
            <h3>
                Second Page
            </h3>
            <a href="index.html" class="ui-btn-left">Back</a>
        </div>

        <div data-role="content">

        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div>    
</body>
</html> 
```

# linux - 如何将参数从 makefile 传递到 Linux 内核模块源代码

> ID：15430921
> 
> 赞同：11
> 
> 时间：2013-03-15T11:13:25.757
> 
> 标签：linux, gcc, module, makefile, kernel

我有源代码：

```
#include <linux/module.h>   
#include <linux/kernel.h>   

int init_module(void)
{
    printk(KERN_INFO "Hello world %i\n", BUILD_NUMBER);
    return 0;
}

void cleanup_module(void)
{
    printk(KERN_INFO "Goodbye world 1.\n");
} 
```

和一个makefile：

```
obj-m += hello-1.o

BUILD_NUMBER := 42

# How to pass BUILD_NUMBER to hello-1.c ???

all:
    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean 
```

现在如何将 BUILD_NUMBER 参数从 makefile 传递到源代码？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T11:24:07.150

由于 Linux 构建系统使用内核提供的 Makefile，因此无法合理更改。我建议将您的版本号直接放入源代码而不是 Makefile。

有一种可能的想法。您可以定义一个`CPPFLAGS`环境变量。它应该由内核 Makefile 传递给 C 编译器命令行。如果您将此 CPPFLAGS 变量定义为`-DVERSION=42`，也许您可​​以`VERSION`在源文件中使用此宏。

```
all:
    CPPFLAGS="-DVERSION=42" make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules 
```

请注意，它`CPPFLAGS`代表“C PreProcessor FLAGS”。它与 C++ 无关。

经过测试。这不起作用。不过有一个解决办法。内核 Makefile 允许（并使用）KCPPFLAGS 环境变量的定义，该变量将被添加到内核 Makefile 中定义自己的 CPPFLAGS。

你必须使用：

```
all:
    KCPPFLAGS="-DVERSION=42" make -C /lib/modules/$(shell uname -r)/build M=$(PWD) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-15T11:08:53.087

在命令行中，根据内核的[D​​ocumentation/kbuild/makefiles.txt](https://www.kernel.org/doc/Documentation/kbuild/makefiles.txt)向 gcc 传递参数的正确方法是设置`CFLAGS_MODULE`.

例如，要在当前目录中构建模块`BUILD_NUMBER=42`：

```
make CFLAGS_MODULE=-DBUILD_NUMBER=42 M="$PWD" modules 
```

如果要提供多个`-D`，请使用单引号：

```
make CFLAGS_MODULE='-DBUILD_NUMBER=42 -DSOME_OTHER_MACRO' M="$PWD" modules 
```

注意：这不仅限于设置宏，例如您可以使用`CFLAGS_MODULE=-O0`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:22:54.877

尝试添加：

```
-DBUILD_NUMBER=$(BUILD_NUMBER) 
```

给你的编译器参数。这应该与在代码中`BUILD_NUMBER`使用 a定义具有相同的效果。`#define`

# javascript - 自动提交 HTML 表单

> ID：15430924
> 
> 赞同：0
> 
> 时间：2013-03-15T11:13:45.157
> 
> 标签：javascript, html, facebook, forms, submit

我有一个 Javascript 函数，它获取两个变量。然后我让 JS 生成一行 HTML，这是一个填充了这两个变量的表单。我已经设置了发布到服务器的方法，并且表单被隐藏了。我想知道如何让它自动提交，因为我真的不想使用提交按钮。

```
var x=document.getElementById("demo");
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    document.geo.submit()
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
function showPosition(position)
  {
  x.innerHTML=
  "<form action='' name='geo' method='post'> Longitude: <input type='int' name='longitude' value='"+ position.coords.longitude +"'> Latitude: <input type='int' name='latitude' value='"+ position.coords.latitude +"'> </form>  ";
} 
```

非常感谢-乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:48:27.103

使用 DOM 而不是内部 HTML 构建表单。然后将其附加到文档并调用其`submit`方法。

```
var form = document.createElement('form');
    form.action = location;
    form.method = 'POST';
var long = document.createElement('input');
    long.name = "longitude";
    long.value = position.coords.longitude;
var lat = document.createElement('input');
    lat.name = "latitude";
    lat.value = position.coords.latitude;
form.appendChild(long);
form.appendChild(lat);
x.appendChild(form);
form.submit(); 
```

# gcc - cygwin 不能将 .a 文件与 main 链接

> ID：15430934
> 
> 赞同：0
> 
> 时间：2013-03-15T11:14:09.973
> 
> 标签：gcc, compilation, linker, cygwin

我正在用 c 做一个简单的库，我编写了我的代码并且它正在编译。我从我的库中创建了一个存档文件 .a。

为了测试，我用 main 创建了一个测试文件。测试文件正在编译，但是每当我尝试引用我创建的 .a 静态库时，它都会出现此错误：

```
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -llibllist
collect2: ld returned 1 exit status 
```

我认为这意味着它无法按预期找到它。我正在将 cygwin 与 gcc 和 ld 一起使用。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T14:51:17.877

该`-l`开关隐式地为传递给它的名称添加`lib`前缀和后缀，因此如果您的库被调用，您应该使用. 您还需要确保该库位于库搜索路径中。另请参阅开关。或者您可以只传递完整的库名称而不切换到 gcc。`.a``libllist.a``-lllist``-L``-l`

# c - 使用 C 中的 messageBox() 函数显示整数？

> ID：15430935
> 
> 赞同：0
> 
> 时间：2013-03-15T11:14:12.733
> 
> 标签：c, winapi

直到现在我一直在使用 messageBox() 显示字符串。如何使用此函数显示整数？我尝试了这样的事情，但没有奏效：

```
int message=1;
MessageBox(NULL,
           (LPCSTR)message,
           "Display",
            MB_ICONINFORMATION); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T11:16:37.597

您需要将其`int`放入字符串中。在 C 中，您可以使用[`sprintf()`](http://en.cppreference.com/w/c/io/fprintf)：

```
char buffer[32];
sprintf(buffer, "%d", message); 
MessageBox(NULL, buffer, "Display", MB_ICONINFORMATION); 
```

在 C++ 中，有几个选项（请参阅[将 int 附加到 std::string](https://stackoverflow.com/questions/10516196/append-an-int-to-a-stdstring/10516313#10516313)以获取建议）用于将 a 存储`int`在 a中，`std::string`然后`std::string::c_str()`在调用`MessageBox()`.

# jakarta-ee - 登录系统在更改 URL 时跳过 Servlet 身份验证

> ID：15430943
> 
> 赞同：0
> 
> 时间：2013-03-15T11:14:39.153
> 
> 标签：jakarta-ee, authentication, servlets

我开始探索 Servlets 和 JSP 的世界，并成功创建了登录系统。但它的实现并不像我想象的那么完美。

塞纳里奥：

1> 用户在 index.jsp 中输入用户名和密码。

2> 将请求发送到Servlet（login.login.java）

3> servlet 连接到数据库并检查用户是否有效。（使用 LoginBean.java 、 LoginDB.java 和 GetConnection.java 即一个 bean 类、 Database QueryClass 和 DB connection Class resp）

4> 如果用户被验证，

5> 用户被重定向到 home.jsp

别的

Error.jsp（这只是 index.jsp 的副本，添加了一些消息）

问题：

1> 如果我只是在浏览器中打开 index.jsp 并将 URL 更改为 home.jsp，我可以绕过 servlet。

2> 如果我尝试使用 MD5 将密码存储在 mysql 中，即 PASSWORD('mypass') 我没有通过身份验证。

这是我的 doPOST 方法

```
 @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String user = request.getParameter("user");
        String pass = request.getParameter("pass");
        LoginBean bean = new LoginBean();
        bean.SetUser(user);
        bean.SetPass(pass);
        bean = LoginDB.check_login(bean);
        if (bean.isValid()) {
            HttpSession session = request.getSession(true);
            session.setAttribute("currentSessionUser", user);
            response.sendRedirect("home.jsp");
        } else {
            response.sendRedirect("Error.jsp");
        }
    } 
```

 ``I tired to Modify my Home.jsp and check for a valid session before loading the page. Using the Following`` 

```
 ```
<% 
   if(!session.isNew())
   {
      response.sendRedirect("index.jsp");
   }
%> 
``` 这修复了 URL 嗅探，但它阻止了有效用户被重定向到 home.jsp

**更新：**

正如 JB Nizet 所建议的那样，我正在尝试对此实施过滤器。但正如我所说，我是一名学习者，所以我不太确定如何实现这一目标：

我必须在我的 doFilter 方法中做什么？

我将 ServletRequest 对象转换为 HttpRequest 对象

使用

HttpServletRequest req = (HttpServletRequest) 请求；

现在使用这个 req 对象，我用户如何实际单击 sumbit 按钮或直接更改 URL 以绕过 Servlet？

对不起，这一定是非常初级的，但我现在已经为此思考了好几个小时。请帮帮我

问候

Genocide_Hoax

            回答 #1

赞同：1

时间：2013-03-15T12:02:51.283

不要使用`Session.isNew()`. 会话处理和身份验证是两个不同的东西。未经身份验证的用户可以（并且将会）拥有一个非新会话。

您应该使用 servlet 过滤器，它将拦截发送到您的应用程序的*每个请求。*此过滤器应检查请求的 URL 是否需要身份验证。如果是这样，并且当前用户未通过身份验证，则应重定向到登录页面。

一旦通过身份验证，您应该将用户身份存储在会话中。这将允许区分经过身份验证的会话和未经身份验证的会话。这也是允许在应用程序中检索当前用户的原因。

当然，请确保不要在需要身份验证的 URL 集中包含登录 URL。

过滤器比在每个页面中检查身份验证更加安全和干净。它使事情集中化，避免一次又一次地重复相同的代码，并且没有忘记在某些页面中添加所需检查的风险。

另外，请尊重 Java 命名约定。Java 中的方法以小写字母开头。

```

# json - 读取复杂的 JSON 字符串

> ID：15430952
> 
> 赞同：0
> 
> 时间：2013-03-15T11:15:16.973
> 
> 标签：json

我有一个像这样的复杂 JSON 字符串。

```
 "rectangle": 
    "{\n  \
    "minX\": 0.0,\n  \
    "minY\": 0.0,\n  \
    "maxX\": 2460.0,\n  \
    "maxY\": 3008.0\n}",
  "graphSpace": 
    "[
       [{\
        "rectangle\":
            \"{\\n  \\\
            "minX\\\": 0.0,\\n  \\\
            "minY\\\": 0.0,\\n  \\\
            "maxX\\\": 0.0,\\n  \\\
            "maxY\\\": 0.0\\n}\",\ 
```

这并不完整。但是如何阅读这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-09-03T08:23:50.500

您的“json 字符串”不是字符串。它是 json 数据（如 json 文件中所示）。

此 json 数据的所有值都是“字符串化 json”。json 数据的第二部分，under`graphSpace`是双字符串化的。首先让我们了解您拥有什么，然后我们会将其读入 Java。

格式化后，我们拥有的内容更加清晰：

```
"rectangle": 
    "{\n  
      \"minX\": 0.0,\n  
      \"minY\": 0.0,\n  
      \"maxX\": 2460.0,\n  
      \"maxY\": 3008.0\n}",
"graphSpace": 
  "[[{
     \"rectangle\":
        \"{\\n  
        \\\"minX\\\": 0.0,\\n  
        \\\"minY\\\": 0.0,\\n  
        \\\"maxX\\\": 0.0,\\n  
        \\\"maxY\\\": 0.0\\n}\",
 \ 
```

最后一个逗号和反斜杠是您未显示的一些连续 JSON 的一部分。graphSpace 的 json 字符串值在您的示例中不完整，并且没有右双引号。（最后一行代码中的 \" 只是字符串的一部分，并用反斜杠“转义”。

`\`\ 是在字符串中写入单个反斜杠的方法。`"`\" 是在字符串中写入双引号的方法。

```
string s1 = "the following double quote \" is not the end of the string.";
string s2 = "while the double quote after the next period does close the string."; 
```

所以`rectangle`保存了一个json字符串，它本身可以解析成一个js对象。

也包含一个 json 字符串，但是这个 json 字符串在解析为 js 对象时将`graphSpace`包含一个对象数组`rectangle`（其中包含一个矩形对象），并且这个矩形对象 AFTER PARSED 包含一个 json 字符串。

我再说一遍。解析完`graphSpace`json 后，该`rectangle`对象将保存一个 json 字符串，没有多余的双引号，因此您将拥有一个带有以下内容的 javascript 对象

```
myobj.graphSpace = 
  [[{
     rectangle:
        "{\n  
          \"minX\": 0.0,\n  
          \"minY\": 0.0,\n  
          \"maxX\": 0.0,\n  
          \"maxY\": 0.0\n}\"
// and I presume the rest of the missing code
         }", // etc. etc. 
```

在您的代码中的某个地方，也可能会解析 json 字符串。所以你会写：（例如使用谷歌GSon）

```
Gson gson = new Gson();
JsonReader reader = new JsonReader(new FileReader(filename));
Rectangle rect1 = gson.fromJson(reader, RECTANGLE_TYPE); // see link below for further details
GraphSpace graphSpace = gson.fromJson(reader, GRAPHSPACE_TYPE);

// at this stage you have parsed in all the json file. 
// but you may wish to continue and parse the stringified value of the graphSpace.rectangle so: 
string rectString = graphSpace[0][0].rectangle;
Rectangle graphRect = gson.fromJson(rectString, RECTANGLE_TYPE);
// or use a `for` loop to loop through the rectangle strings in graphSpace... 
```

在 Java 中，有一种读取 JSON 的内置方法，并且有许多很好的库可以这样做。

看

*   [如何在 Java 中解析 JSON](https://stackoverflow.com/questions/2591098/how-to-parse-json-in-java)
*   [如何使用 GSON 解析 JSON 文件](https://stackoverflow.com/questions/29965764/how-to-parse-json-file-with-gson)

# sql - 发出构建“结果缓存”而不返回结果的 SQL 请求

> ID：15430953
> 
> 赞同：0
> 
> 时间：2013-03-15T11:15:23.500
> 
> 标签：sql, performance, postgresql, caching

我有一个无状态的网络服务器，需要 2 组用户输入来进行计算：

第 1 页：获取输入 A
第 2 页：获取输入 B
第 3 页：从用户输入 A 和 B 计算的结果

碰巧我的应用程序中的瓶颈是与用户输入 A 相关的查找。

作为加速技巧，我在 A 上发出“第 3 页”稍后会执行的 SQL 请求，同时等待用户输入 B，这样当用户单击“第 2 页”上的提交时，“数据 A”的查找结果已缓存（为不耐烦的用户节省 2-5 秒）。

### 我的问题

是否可以通过服务器执行查询并将其缓存而不返回任何内容的方式进行我的 SQL 查找，因为我只需要它在缓存中以使最终请求快 2-5 秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T11:27:46.403

PostgreSQL 没有结果缓存，所以你不能预热它。

它*确实*有一个磁盘缓存。要预热它，您可以只运行`SELECT`丢弃结果的语句。使用 PL/PgSQL`PERFORM`语句、无意义的聚合等。搜索“postgresql pre-warm cache”可能会提供信息。

您可能还想查看*物化视图*。PostgreSQL 还不支持物化视图，但您可以使用触发器和脚本来模拟它们。正在进行补丁以添加正在进行的物化视图支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:31:29.413

如果结果不大，最好将用户状态保存在服务器端会话中。

* * *

更新：

这是数据库存储会话适合的情况之一（多个 Web 服务器与单个数据库服务器）。

保存结果：

```
insert into temp_result (session_id, a, b)
select %(session_id)s, a, b
from t 
```

检索它：

```
select a, b
from t
where session_id = %(session_id)s 
```

当会话过期或超时后删除它。

# java - eclipse中的相 对文件名路径冲突

> ID：15430956
> 
> 赞同：0
> 
> 时间：2013-03-15T11:15:28.930
> 
> 标签：java, jakarta-ee, relative-path, absolute-path

在我的应用程序中，我正在读取 WebContent/META-INF 文件夹中的 XML 文件（比如 ABC.xml），并使用 DOM 解析器对其进行解析，如下所示

```
File xmlFile = new File("WebContent//META-INF//ABC.xml");
parser.parse(new InputSource(new FileReader(xmlFile.getAbsolutePath()))); 
```

它的显示文件未找到异常，当我打印 xmlFile.getAbsolutePath() 它的显示

```
D:\Softwares\SDE_7\eclipse\WebContent\META-INF\ABC.xml 
```

这是我的 Eclipse 设置所在的位置

所以我尝试在简单的java程序中使用相同的逻辑并打印显示正确路径（项目文件夹结构）的绝对路径并且程序运行良好

```
D:\GME_WorkSpace\Practice_1\WebContent\META-INF\sample.xml 
```

为什么会出现这种冲突？我该如何纠正它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:21:01.080

如果您在谈论 WebContent，听起来您已经编写了一个 Servlet。

在这种情况下，您应该使用 ServletContext 来查找您的文件。

getServletContext().getRealPath(...) 将获取 Servlet 中相对文件名的完整操作系统路径。

可以从任何继承自 HttpServlet 的类调用 getServletContext()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:21:08.800

```
ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
URL url = classLoader.getResource("WebContent//META-INF//ABC.xml");
File file = new File(url.toURI()); 
```

# php - android app和cakephp之间的连接

> ID：15430957
> 
> 赞同：0
> 
> 时间：2013-03-15T11:15:31.250
> 
> 标签：php, android, cakephp

嗨，我正在为一个 Android 应用程序在 cakephp 中创建一个 Web 服务。我收到请求并且正在发送响应，但响应在客户端不可见。我的代码如下所示。是否有其他方法可以发送响应。

```
public function AndroidApp() {

    if (isset($_POST["myHttpData"])) {

       $coupon = trim($_POST["myHttpData"]);

        $couponId = $this->Code->find('all', array(
            'conditions' => array(
                'Code.coupon_code' => $coupon,
                'Code.status' => 'Used'
            ),
            'fields' => array('Code.id')));

        $studentAssessmentId = $this->StudentAssessment->find('all', array(
            'conditions' => array(
                'StudentAssessment.code_id' => $couponId[0]['Code']['id'],
                'StudentAssessment.status' => 'Complete'
            ),
            'fields' => array('StudentAssessment.id')));

        $scores = $this->AssessmentScore->find('all', array(
            'conditions' => array(
                'AssessmentScore.student_assessment_id' => $studentAssessmentId[0]['StudentAssessment']['id']
            ),
            'fields' => array('AssessmentScore.score')));

        $json = array();
        $assessment_data = array();

        //debug($scores);
        $i = 0;
        foreach ($scores as $score) {
            $assessment_data[$i] = array("score" => $score['AssessmentScore']['score']);
            $i+=1;
        }

        header('Content-type: application/json');

        $json['success'] = $assessment_data;

        $android = json_encode($json);
    } else {
        $json['error'] = "Sorry, no score is available for this coupon code!";
        $android = json_encode($json);
    }
    echo $android; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:17:55.390

## 代码异味，非 cakephp 标准

首先，正如其他人在评论中提到的，您没有使用 CakePHP 请求/响应对象。因此，您将事情过于复杂化。请参阅此处的文档； [http://book.cakephp.org/2.0/en/controllers/request-response.html](http://book.cakephp.org/2.0/en/controllers/request-response.html) [http://book.cakephp.org/2.0/en/controllers/request-response.html#dealing-with-content-types](http://book.cakephp.org/2.0/en/controllers/request-response.html#dealing-with-content-types)

和

[http://book.cakephp.org/2.0/en/views/json-and-xml-views.html](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html)

如果您将 'score'替换为显示字段，则重新格式化查询结果的`$scores`循环可能是多余的。请参阅此处的文档[http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#find-list](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#find-list)`find('all')``find('list')`

## 错误

您的代码中似乎也存在一些错误；

*   `$_POST["myHttpData"]`仅在存在时才发送内容类型标头。
*   您只检查是否`$_POST["myHttpData"]`存在*，*而不是检查它是否实际包含任何数据（空）
*   您*没有*检查各种查询是否返回结果。如果查询没有返回任何内容，这将导致您的代码出错！例如，您**假设**存在`$couponId[0]['Code']['id']`（但如果未找到优惠券代码，则不会存在）

## 可能的答案

除了这些问题之外，问题的最可能原因是您没有禁用“自动渲染”。因此，CakePHP 也会在您输出 JSON 后呈现视图，从而导致格式错误的 JSON 响应。

```
public function AndroidApp() {
     $this->autoRender = false;

     // rest of your code here

} 
```

# mysql - 多表删除语法错误

> ID：15430958
> 
> 赞同：0
> 
> 时间：2013-03-15T11:15:32.430
> 
> 标签：mysql, sql

当我运行这个：

```
DELETE FROM folders AS fo
LEFT OUTER JOIN files AS fi 
ON fo.folderId = fi.folderId
WHERE fi.folderId IS NULL AND (fo.folderId IN (63,1000)) 
```

...我收到语法错误：

> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“AS fo LEFT OUTER JOIN files AS fi ON fo.folderId = fi.folderId WHERE fi.fold”附近使用正确的语法

该代码基于`SELECT`返回预期行的查询。错误信息的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:22:21.617

```
DELETE
  FROM folders fo
 WHERE NOT EXISTS (SELECT 1
                     FROM files fi
                    WHERE fi.folderId = fo.folderId)
   AND fo.folderId IN (63, 1000) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:31:02.563

它“不起作用”并不奇怪。当我运行您的代码时，出现语法错误：

> SQL 错误 (1064)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“AS fo LEFT OUTER JOIN files AS fi ON fo.folderId = fi.folderId WHERE fi.fold”附近使用正确的语法

正确的[语法](http://dev.mysql.com/doc/refman/5.5/en/delete.html)是：

```
DELETE fo -- Note I've added table name
FROM folders AS fo
LEFT OUTER JOIN files AS fi 
ON fo.folderId = fi.folderId
WHERE fi.folderId IS NULL AND (fo.folderId IN (63,1000)); 
```

# java - Spring MVC @RequestParam 值未按预期从 URI 中提取

> ID：15430967
> 
> 赞同：8
> 
> 时间：2013-03-15T11:15:49.957
> 
> 标签：java, spring, spring-mvc

我想知道spring如何拆分http请求的每个参数。例如，我有这个方法定义：

```
@RequestMapping(value = "/search.do", method = RequestMethod.GET)
public String searchGet(ModelMap model,
    @RequestParam(value = "memberId", required = false) Integer memberId,
    @RequestParam(value = "member", required = false) String member) {...} 
```

我使用这个网址：

```
/search.do?member=T&O= 
```

我得到成员 = T 而不是成员 =T&O=

请求参数仅限于 memberId 和 member。我可以配置弹簧来解决这个问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T13:27:52.320

URL 中的某些字符具有特殊含义。如果它们应该是值的一部分，则需要对其进行转义。

如果您的值为 T&O= 则需要将其更改为 T%26O%3D

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T11:17:50.087

`&`用于分隔请求参数。
URL 包含以下格式的请求参数名称和值

> `http://host_port_and_url?name1=value1&name2=value2&so_on`

在你的情况下

```
/search.do?member=T&O= 
```

名称 -> 值
成员 -> T
O -> （无值 - 空白）
所以你得到正确的值

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-15T11:18:03.690

查看您的控制器代码，您的 URL 应该是

```
/search.do?memberId=T&member= 
```

然后请求参数名称将被正确映射。

如果您希望使用问题中提到的相同 URL，请将控制器代码更改为：

```
public String searchGet(ModelMap model,
@RequestParam(value = "O", required = false) Integer memberId,
@RequestParam(value = "member", required = false) String member) {...} 
```

# html - 301 重定向目标 URL 上不带斜线

> ID：15430968
> 
> 赞同：2
> 
> 时间：2013-03-15T11:15:53.860
> 
> 标签：html, .htaccess, redirect, seo

我重新启动了一个网站，现在我需要 301 重定向来保持我的页面排名:)

我的旧网站是这样的：

www.domain.com/start/ 或 www.domain.com/start

新网站如下所示：

www.domain.com/home.html

我的重写规则如下所示：

```
RewriteEngine On
RewriteRule ^start/ /home.html  [R=301,L]
RewriteRule ^start /home.html [R=301,L] 
```

没有斜线，它重定向到 home.html 很好，但是使用 start/ 它重定向到 home.html/ 并进入 404 .. 我阅读了多种解决方案，但没有一个对我有用，所以你是我最后的希望，我有点着急，这就是我在这里问的原因。

提前谢谢你，菲利普

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T14:43:27.967

使用单个重写规则。带有一个由 . 表示的可选斜杠`\/?`。通过 a 终止重写规则，`$`以便 /start/foo 也不匹配。

```
RewriteEngine On
RewriteRule ^start\/?$ /home.html  [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:35:41.443

尝试在第二行添加反斜杠

```
RewriteRule ^start\/ /home.html  [R=301,L] 
```

祝你好运！

# javascript - cgscenegraph 中的多点触控支持

> ID：15430974
> 
> 赞同：0
> 
> 时间：2013-03-15T11:16:03.323
> 
> 标签：javascript, html, canvas

在我遇到的所有画布库中，我发现 cgscenegraph 是一个非常新的库。我一直在使用 kineticjs 和 paperjs。我想为我当前的项目尝试 cgscenegraph。cgscenegraph 是否支持多点触控？是否有关于相同的演示。在网站上找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:50:03.430

是的，它受支持：[在这里检查](https://github.com/GwennaelBuchet/cgSceneGraph/blob/master/api/v1.4.2/files/src_utils_util.global.js.html)

```
var touch = event;
&#x2F;&#x2F;if multi-touch, get all the positions
if (event.targetTouches) { &#x2F;&#x2F; or changedTouches
var touchPoints = (typeof event.targetTouches !== &#x27;undefined&#x27;) ? event.targetTouches : [event];
for (var i = 0; i &lt; touchPoints.length; i++) {
touch = touchPoints[i];

positions.push(new CGSGPosition((touch.pageX - offsetX) &#x2F; cgsgDisplayRatio.x,
(touch.pageY - offsetY) &#x2F; cgsgDisplayRatio.y));
}
} 
```

# mysql - EF5：无法创建，因为无法确定主键列。使用 AddForeignKey fluent API 完全指定外键

> ID：15430981
> 
> 赞同：7
> 
> 时间：2013-03-15T11:16:24.903
> 
> 标签：mysql, entity-framework, asp.net-mvc-4, asp.net-mvc-3, foreign-keys

我们正在使用实体框架 5.0。和数据库 MySQL。当我们尝试迁移时会出现异常。

> 无法创建，因为无法确定主键列。使用 AddForeignKey fluent API 来完全指定外键。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-04-17T17:44:23.637

正如这里解释的[http://www.ozkary.com/2015/02/the-foreign-key-on-table-with-columns.html](http://www.ozkary.com/2015/02/the-foreign-key-on-table-with-columns.html)，将 FK 放入不属于的表时可能会遇到问题你的数据库上下文

所以而不是做

```
CreateTable(
    "dbo.App",
    c => new
    {
        Id = c.Int(nullable: false, identity: true),
        Name = c.String(nullable: false, maxLength: 150),
        RoleId = c.String()
    })
    .PrimaryKey(t => t.Id)
    .ForeignKey("dbo.MyRoles", t => t.RoleId)
    .Index(t => t.RoleId); 
```

你应该做：

```
CreateTable(
    "dbo.App",
    c => new
    {
        Id = c.Int(nullable: false, identity: true),
        Name = c.String(nullable: false, maxLength: 150),
        RoleId = c.String()
    })
    .PrimaryKey(t => t.Id)
    .Index(t => t.RoleId);

AddForeignKey("dbo.App", "RoleId", "dbo.Roles","Id"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:21:38.323

实体框架要求在主表中的整个主键和从属表中的相应列（外键）之间建立关系。

检查所有表是否包含 PRIMARY KEY COLUMN

# c# - AutoFac DbContext 问题 - 在创建模型时无法使用

> ID：15430988
> 
> 赞同：3
> 
> 时间：2013-03-15T11:16:36.853
> 
> 标签：c#, dependency-injection, inversion-of-control, servicestack, autofac

我在开始使用 AutoFac 和 IoC 时遇到了一些问题。我们有一个工作应用程序，但是，我从头开始使用这个应用程序，看不出两者之间的差异在哪里。

我正在使用一个简单的 AJAX 页面对此进行测试，该页面通过 ServiceStack API 调用服务层。当使用 MockRepositories 时，它工作得很好，所以我知道事情的那一面是有效的。

但是，当我用使用实体框架的模拟替换模拟时，尽管所有注册似乎都正确且有效，但我收到错误“在创建模型时无法使用上下文”。

我在下面包含了我的代码：

```
public class SomeObject
{
    public int Id { get; set; }
}

public class IoCExampleContext : DbContext, IIoCExampleContext
{

    public IDbSet<SomeObject> SomeObjects { get; set; }

    static IoCExampleContext()
    {
        Database.SetInitializer(new IoCExampleDatabaseInitilizer());
    }

    public IoCExampleContext(string connectionStringName)
        : base(connectionStringName)
    {
        Configuration.ProxyCreationEnabled = false;
    }

    public IoCExampleContext()
        : this("name=IoCExample")
    {}

    public string ConnectionString
    {
        get { return Database.Connection.ConnectionString; }
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
        BuildModels(modelBuilder);
    }

    private void BuildModels(DbModelBuilder builder)
    {
        var typeToUse = typeof(SomeObjectModelBuilder);
        var namespaceToUse = typeToUse.Namespace;

        var toReg = Assembly
                        .GetAssembly(typeToUse)
                        .GetTypes()
                        .Where(type => type.Namespace != null && type.Namespace.StartsWith(namespaceToUse))
                        .Where(type => type.BaseType.IsGenericType && type.BaseType.GetGenericTypeDefinition() == typeof(EntityTypeConfiguration<>));

        foreach (object configurationInstance in toReg.Select(Activator.CreateInstance))
        {
            builder.Configurations.Add((dynamic)configurationInstance);
        }
    }
}

public class IoCExampleDatabaseInitilizer : CreateDatabaseIfNotExists<IoCExampleContext>
{
    protected override void Seed(IoCExampleContext context)
    {
    }
}

public interface IRepository<TEntity> where TEntity : class
{
    IQueryable<TEntity> GetQuery();
    IEnumerable<TEntity> GetAll();
    IEnumerable<TEntity> Where(Expression<Func<TEntity, bool>> predicate);

    // ...Various "standard" CRUD calls
}

public class GenericRepository<TEntity> : IRepository<TEntity> where TEntity : class
{
    protected DbContext _context;
    private readonly DbSet<TEntity> _dbSet;

    public GenericRepository(DbContext context)
    {
        _context = context;
        _dbSet = _context.Set<TEntity>();
    }

    public IQueryable<TEntity> GetQuery()
    {
        return _dbSet;
    }

    public IEnumerable<TEntity> GetAll()
    {
        return GetQuery().AsEnumerable();
    }

    public IEnumerable<TEntity> Where(Expression<Func<TEntity, bool>> predicate)
    {
        return GetQuery().Where(predicate);
    }

    // ...Various "standard" CRUD calls

    public void Dispose()
    {
        OnDispose(true);
    }

    protected void OnDispose(bool disposing)
    {
        if (disposing)
        {
            if (_context != null)
            {
                _context.Dispose();
                _context = null;
            }
        }
    }
}

public class DependencyBootstrapper
{
    private ContainerBuilder _builder;

    public IContainer Start()
    {
        _builder = new ContainerBuilder();
        _builder.RegisterFilterProvider();
        RegisterControllers();
        return _builder.Build();
    }

    private void RegisterControllers()
    {
        RegisterAssembly(Assembly.GetExecutingAssembly());
        _builder.RegisterModelBinderProvider();

        RegisterPerLifetimeConnections();
        RegisterRepositories();
        RegisterServices();
    }

    private void RegisterAssembly(Assembly assembly)
    {
        _builder.RegisterModelBinders(assembly);
        _builder.RegisterControllers(assembly);
    }

    private void RegisterRepositories()
    {
        _builder.RegisterGeneric(typeof(GenericRepository<>)).As(typeof(IRepository<>)); 
        _builder.RegisterType<GenericRepository<SomeObject>>().As<IRepository<SomeObject>>();
        //... More registrations
    }

    private void RegisterServices()
    {
        _builder.RegisterType<SomeObjectService>().As<ISomeObjectService>();
        //... More registrations
    }

    private void RegisterPerLifetimeConnections()
    {
        const string connectionStringName = "IoCExample";
        _builder.RegisterType<IoCExampleContext>()
            .As<DbContext>()
            .WithParameter("connectionStringName", connectionStringName)
            .InstancePerLifetimeScope();

        _builder.Register(c => new HttpContextWrapper(HttpContext.Current))
            .As<HttpContextBase>();
    }
} 
```

我不知道它是否相关，但由于我们无法访问 global.asax 方法，因此我们通过它调用引导程序`PreApplicationStartMethod.OnPreApplicationStart`（据我所知，它与 Application_Start 几乎相同）。

有点令人担忧的是，当我在连接字符串上启用多个活动结果集时，它可以工作——这表明我错误地注册了 DbContext 并且它跨越了多个上下文。

谁能发现我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T21:22:09.083

连接字符串是问题所在。确保您已在 web/app.comfig 中正确设置它。

# entity-framework - Code First（DbContext 模型）与 EDMX 文件相比有优势吗？

> ID：15430998
> 
> 赞同：3
> 
> 时间：2013-03-15T11:17:00.770
> 
> 标签：entity-framework, entity-framework-5

我们小组有一个管理所有数据库的 DBA。我们开始使用 Code First，它运行良好。现在我们建议我们应该使用数据库优先方法，但据我所知，这需要我们在图表中进行映射，我们不能使用 Fluent API。

我们对 POCO 类的想法很满意，所以我们最好继续使用 Code First 还是使用 EDMX 文件和传统工作方式有特别的优势（除了使用存储过程）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T11:23:41.557

主要优点是灵活性，避免代码生成并获得对幕后制作方式的更多控制。

当您在代码中定义映射时，您在映射策略、调整和配置方面拥有更多权力。

总而言之：您的域不会是数据库驱动的：您拥有自己的域模型，而需要适应它的是数据库。对我来说，这就是一个严肃的领域应该如何使用严肃的 OR/M。OR/M 使构建真正的面向对象领域成为可能，同时它们处理与一个非常不同的世界（关系模型）进行互操作的痛苦。

如果您真的想拥有一个独立于平台的中性域模型，那么 Code-First 是您的最佳选择。

也许我有偏见，但我的观点是严肃的、大中型或伟大的项目应该从 Code-First 开始并进行。如果您的域不是那么复杂，代码生成和 EDMX 范式以及这种糖就可以工作。一旦变得复杂，您就需要制定自己的数据和域策略。

# ios - iOS设置特定索引的图像

> ID：15430999
> 
> 赞同：0
> 
> 时间：2013-03-15T11:17:01.143
> 
> 标签：ios, uiscrollview, indexing, thumbnails

我想在单击缩略图时在滚动视图中的特定图像上显示图像。根据缩略图的选择，我想显示图像。我只是在使用 ScrollView，那我该如何解决呢？我的collectionview代码是，

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier=@"Cell";
    customcell *cell=[collectionView dequeueReusableCellWithReuseIdentifier:CellIdentifier forIndexPath:indexPath];
    [[cell nyimage]setImage:[UIImage imageNamed:[temparr objectAtIndex:indexPath.section * 1 + indexPath.row]]];
    return cell;

}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"showDetail"]) 
    {
        NSIndexPath *selectedIndexPath = [[self.gallerycollection indexPathsForSelectedItems] objectAtIndex:0];

        NSString *imageNameToLoad = [NSString stringWithFormat:@"%d", selectedIndexPath.row];
        NSString *pathToImage = [[NSBundle mainBundle] pathForResource:imageNameToLoad ofType:@"jpg"];
        UIImage *image = [[UIImage alloc] initWithContentsOfFile:pathToImage];
        GalleryImageScrollViewController *gallerydetailViewController = [segue destinationViewController];
        gallerydetailViewController.FullScreenImageScroller=image;
    }
} 
```

滚动视图是，

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSMutableArray *mutablearray = [NSMutableArray array];
    data=[MyDatabase new];
    slideImages=[data OpenMyDatabase:@"SELECT pic_name_big FROM interior":@"pic_name_big"];
    [mutablearray addObjectsFromArray:slideImages];
    temparr = [[NSMutableArray alloc]init];
    temparr=[NSMutableArray arrayWithArray:mutablearray];
    [self putImageViewsInScrollView:[temparr count]];
    self.FullScreenImageScroller.delegate=self;

}

-(void) putImageViewsInScrollView:(int)numberOfImageViews
{
   for(int i=0 ;i<numberOfImageViews; i++)
    {
        fullScreenImageView=[[UIImageView alloc]initWithImage:[UIImage imageNamed:[temparr objectAtIndex:i]]];
        fullScreenImageView.frame = CGRectMake((WIDTH_OF_IMAGE * i)  , 0, WIDTH_OF_IMAGE, HEIGHT_OF_IMAGE);
        [self.FullScreenImageScroller addSubview:fullScreenImageView];
    }
    [self.FullScreenImageScroller setContentSize:CGSizeMake(WIDTH_OF_SCROLL_PAGE * ([temparr count]), HEIGHT_OF_IMAGE)];
    [self.FullScreenImageScroller setContentOffset:CGPointMake(0, 0)];
    [self.FullScreenImageScroller scrollRectToVisible:CGRectMake(WIDTH_OF_IMAGE,0,WIDTH_OF_IMAGE,HEIGHT_OF_IMAGE) animated:NO];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:50:41.100

如果我正确理解您的代码，如果您根据缩略图的索引更改滚动视图的偏移量，它应该可以工作：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
        {
            if ([[segue identifier] isEqualToString:@"showDetail"]) 
            {
                NSIndexPath *selectedIndexPath = [[self.gallerycollection indexPathsForSelectedItems] objectAtIndex:0];

                NSString *imageNameToLoad = [NSString stringWithFormat:@"%d", selectedIndexPath.row];
                NSString *pathToImage = [[NSBundle mainBundle] pathForResource:imageNameToLoad ofType:@"jpg"];
                UIImage *image = [[UIImage alloc] initWithContentsOfFile:pathToImage];
                GalleryImageScrollViewController *gallerydetailViewController = [segue destinationViewController];

                //set offset of scroll view
                gallerydetailViewController.FullScreenImageScroller setContentOffset:CGPointMake(WIDTH_OF_IMAGE*selectedIndexPath.row, 0);
            }
        } 
```