# StackOverflow 问答 13765000-13765999

# javascript - 如何使 $(document).on('touchstart') 功能在 ipad 上工作？

> ID：13765004
> 
> 赞同：0
> 
> 时间：2012-12-07T14:25:37.160
> 
> 标签：javascript, jquery

我只是在单击特定按钮时切换类，当用户单击外部文档时，我想删除该类。如果我将事件更改为在桌面上单击和测试，但在 iPad 上似乎没有任何反应，这可以正常工作。任何人都可以就如何使这项工作提供任何建议吗？

```
$shoppingIcon.on('click', function(e) {
        var $this = $(this);
        $this.prev($productInfo).toggleClass('active');
    });

    $(document).on('touchstart', function() {
        $productInfo.removeClass('active');
    });​ 
```

# android - Android.mk 如何使用通配符包含所有 .cpp 文件？

> ID：13765005
> 
> 赞同：1
> 
> 时间：2012-12-07T14:25:40.433
> 
> 标签：android, eclipse, makefile, cocos2d-x

这是我的目录结构...

```
> Classes [dir]
> ---subdir1
> ------ some .cpp and .h files
> ---subdir2
> ------ some .cpp and .h files
> ---more .cpp and .h files
> ---Android.mk 
```

这是 Android.mk 的代码

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := game_logic_static

LOCAL_MODULE_FILENAME := libgame_logic

LOCAL_SRC_FILES := AppDelegate.cpp \
                   HelloWorldScene.cpp

LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)

LOCAL_STATIC_LIBRARIES := png_static_prebuilt
LOCAL_STATIC_LIBRARIES += xml2_static_prebuilt
LOCAL_STATIC_LIBRARIES += jpeg_static_prebuilt
LOCAL_WHOLE_STATIC_LIBRARIES += cocos2dx_static

LOCAL_SHARED_LIBRARIES := cocosdenshion_shared

include $(BUILD_STATIC_LIBRARY)

$(call import-module,cocos2dx/platform/third_party/android/modules/libpng)
$(call import-module,cocos2dx/platform/third_party/android/modules/libxml2)
$(call import-module,cocos2dx/platform/third_party/android/modules/libjpeg) 
```

任何人都可以为 Android.mk 发布正确的代码（如果可能的话完整），以便所有 .cpp 都将在 Class 目录中编译？谢谢！

注意：尝试使用 Eclipse 开发 cocos2d-x Android 更多注意事项：我已经尝试过这些无济于事：

> [Android.mk 文件 - 包括不同文件夹和子文件夹中的所有源文件](https://stackoverflow.com/questions/9970082/android-mk-file-including-all-source-files-in-different-folders-and-subfolders) [如何在子目录中编写带有源文件的 android.mk 文件？](https://stackoverflow.com/questions/9971390/how-to-write-android-mk-file-with-source-files-in-subdirectories) [Android.mk，包含所有 cpp 文件](https://stackoverflow.com/questions/8980284/android-mk-include-all-cpp-files)

# ios - UICollectionViewCell 翻转并在点击时增长

> ID：13765006
> 
> 赞同：10
> 
> 时间：2012-12-07T14:25:43.737
> 
> 标签：ios, uicollectionview

如何实现 UICollectionViewCell 翻转并增长以在点击时显示模态视图的动画？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-09T02:01:33.477

这是我在另一个项目中使用的，它运行良好：

```
- (BOOL)collectionView:(UICollectionView *)collectionView shouldSelectItemAtIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewCell *cell = [collectionView cellForItemAtIndexPath:indexPath];
    if (cell.selected) {
        [collectionView deselectItemAtIndexPath:indexPath animated:YES];
        [UIView transitionWithView:cell
                          duration:0.2
                           options:UIViewAnimationOptionTransitionFlipFromLeft
                        animations:^{
                            [cell setFrame:self.selectedCellDefaultFrame];
                            cell.transform = self.selectedCellDefaultTransform;
                        }
                        completion:^(BOOL finished) {
                            self.selectedCellDefaultFrame = CGRectZero;
                            [collectionView reloadItemsAtIndexPaths:@[indexPath]];
                        }];
        return NO;
    }
    else {
        return YES;
    }
}
- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewCell *cell = [collectionView cellForItemAtIndexPath:indexPath];
    [cell.superview bringSubviewToFront:cell];
    self.selectedCellDefaultFrame = cell.frame;
    self.selectedCellDefaultTransform = cell.transform;
    [UIView transitionWithView:cell
                      duration:0.2
                       options:UIViewAnimationOptionTransitionFlipFromRight
                    animations:^{
                        [cell setFrame:collectionView.bounds];
                        cell.transform = CGAffineTransformMakeRotation(0.0);
                    }
                    completion:^(BOOL finished) {}];
} 
```

这里有不同的东西：

*   `bringSubviewToFront:`消息调用用于防止单元格在其他单元格后面进行动画处理
*   我们使用控制器中声明的两个属性：`selectedCellDefaultFrame`和`selectedCellDefaultTransform`保存单元格的默认状态并在取消选择时重新初始化它
*   取消选择时，我们调用 的`reloadItemsAtIndexPaths:`方法`UICollectionView`来确保位置的重置完全完成

如果您对此有任何问题，请告诉我。

祝你好运，

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-16T20:34:39.650

我没有尝试过成长动画，但我想我可以帮助 UICollectionViewCell 翻转动画。

尝试：

```
UICollectionViewCell* cell = [collectionView cellForItemAtIndexPath:indexPath];

[UIView animateWithDuration:1.0
                      delay:0
                    options:(UIViewAnimationOptionAllowUserInteraction)
                 animations:^
                {
                     NSLog(@"starting animation");

                    [UIView transitionFromView:cell.contentView
                                        toView:newView
                                      duration:.5
                                       options:UIViewAnimationOptionTransitionFlipFromRight
                                    completion:nil];
                }
                 completion:^(BOOL finished)
                {
                     NSLog(@"animation end");
                }
 ]; 
```

希望有帮助！

# python - python，将函数转换为类和对象

> ID：13765007
> 
> 赞同：-2
> 
> 时间：2012-12-07T14:25:43.917
> 
> 标签：python

下面有很多代码，但您不必真正阅读任何代码，您只需要知道函数存在以及函数名称即可。我将首先描述我的问题。

我创建了一个完全基于函数和一些全局变量的程序程序，如下所示。我想将程序更改为面向对象的程序，但我遇到了麻烦，因为我以前从未做过这样的事情。

需要遵循的程序是： - 函数`attack()`需要放入名为attacker.py 的文件中 - 函数`defence()`、、`updateVars()`和`smartDefender()`需要放入文件defender.py -`main()`函数和其余代码（大多数代码）将被放置在一个名为 manager.py 的文件中，该文件将成为主文件，并将所有内容放在一起。-我必须使用课程。

我尝试了一系列不同的事情，包括将函数的名称更改为`__init__`，然后导入并尝试在 manager.py 中使用它们。我还尝试保持函数名称相同，只是将函数放在类中并将攻击者.py 和防御者.py 导入 manager.py 但似乎没有任何工作......任何和所有帮助将不胜感激。

虽然我认为你并不需要对程序的功能进行描述，但如果你真的需要，我可以做一个简短的描述，或者你可以[在这里查看。](http://pages.cpsc.ucalgary.ca/~tamj/231/assignments/assignment5/index.htm)

任何和所有的帮助将不胜感激。

```
import random

HIGH= 3
MED= 2
LOW= 1

def attack(attackList):

    x= random.uniform(0,1)
    for attackLevel,probability in attackList:
        if x<probability:
            break
        x=x-probability
    return attackLevel

def defence(attackLevel,defendList):

    x= random.uniform(0,1)
    for defendLevel,probability in defendList:
        if x<probability:
            break
        x=x-probability
    return defendLevel

def updateVars(attackLevel,defendLevel,block,hit,run):

    if attackLevel==1:
        printAttackLevel='Low'
    if attackLevel==2:
        printAttackLevel='Medium'
    if attackLevel==3:
        printAttackLevel='High'
    if defendLevel==1:
        printDefendLevel='Low'
    if defendLevel==2:
        printDefendLevel='Medium'
    if defendLevel==3:
        printDefendLevel='High'

    if attackLevel==defendLevel:
        block=block+1
        hit=hit
        run=run+1
    else:
        block=block
        hit=hit+1
        run=run+1

    return block,hit,run,printAttackLevel,printDefendLevel

def smartDefender(defendLevel,attackLevel,smartList):

    for i in smartList:
        if (i==(i+1)==(i+2)):
            defendLevel= attackLevel
            return defendLevel
        else:
            return

def main():

    DEFAULT_PROBABILITY= 0.33
    run=0
    hit=0
    block=0
    smartList=[]

    rounds= int(input("\nPlease enter the number of rounds between 1 and 100:"))
    if rounds<=0 or rounds>100:
        print("\n")
        print("Invalid range. The number of rounds has been set to 10 by DEFAULT_PROBABILITY.")
        rounds=10

    lowAttackProb= float(input("\nPercentage of attacks aimed low(0-100):"))/100
    medAttackProb= float(input("Percentage of attacks aimed medium(0-100):"))/100
    highAttackProb= float(input("Percentage of attacks aimed high(0-100):"))/100
    if lowAttackProb+medAttackProb+highAttackProb !=1.00:
        print("\n")
        print("Invalid entry. The sum of the pecentages must equal 100%. The probability of each level has been set to 33.0% by DEFAULT_PROBABILITY.")
        lowAttackProb=DEFAULT_PROBABILITY
        medAttackProb=DEFAULT_PROBABILITY
        highAttackProb=DEFAULT_PROBABILITY

    print('\nLet The Fighting Begin')
    print('-'*22)

    while  run < rounds:

        lowDefProb= DEFAULT_PROBABILITY
        medDefProb= DEFAULT_PROBABILITY
        highDefProb= DEFAULT_PROBABILITY

        attackList= [(LOW,lowAttackProb),(MED,medAttackProb),(HIGH,highAttackProb)]
        attackLevel= attack(attackList)
        smartList.append(attackLevel)
        defendList=[(LOW,lowDefProb),(MED,medDefProb),(HIGH,highDefProb)]
        defendLevel=defence(attackLevel,defendList)
        block,hit,run,printAttackLevel,printDefendLevel= updateVars(attackLevel,defendLevel,block,hit,run)
        if run>(rounds/2):
            defendLevel=smartDefender(defendLevel,attackLevel,smartList)
            #implement smart mode

        print('%s%2s%s%3s%s%5s%s%3s'% ('\nRound',run,':\t','Attacker:',printAttackLevel,'\t','Defender:',printDefendLevel))

    print("%2s%2d%s%s%2d"% ('\nTotal Hits:',hit,'\t','Total Blocks:',block))
    print('Attacker Proportions:','','','Low:','','',lowAttackProb*100,'%','','','Medium:','','',medAttackProb*100,'%','','','High:','','',highAttackProb*100,'%')
    print('Defender Proportions:','','','Low:','','',lowDefProb*100,'%','','','Medium:','','',medDefProb*100,'%','','','High:','','',highDefProb*100,'%')
    print("\nThank you for using this program, Goodbye!")

main() 
```

我的问题是，我怎样才能很容易（不一定有效地）将这些过程程序转换为使用类和多个文件的面向对象的程序。

我认为问题区域将包括调用函数的位置`main()`，如果这有助于解决问题的话..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:18:48.803

以防万一……我只是以这个基于类的脚本为例。

```
class Car():

    def __init__(self, mileage=0, mpg=10, tank_capacity=5):
        self.mileage = mileage
        self.mpg = mpg
        self.tank_capacity=tank_capacity
        self.tank_level = 0                

    def drive(self, miles):
        gallons_burned = float(miles) / self.mpg
        if self.tank_level < gallons_burned:
            miles_driven = float(self.tank_level) * self.mpg
            self.tank_level = 0
            self.mileage += miles_driven
            print "You ran out of gas after %s miles." % miles_driven
            return
        self.tank_level -= gallons_burned
        self.mileage += miles
        print "You made it to your destination after %s miles." % miles

    def pump_gas(self, gallons):
        self.tank_level += gallons
        if self.tank_level > self.tank_capacity:
            self.tank_level = self.tank_capacity
        print "You now have %s gallons in your tank" % self.tank_level

    def status(self):
        print "Mileage:", self.mileage
        print "Tank level: %s gallons" % self.tank_level

if __name__ == "__main__":
    my_car = Car(mileage=100, mpg=30, tank_capacity=3)
    my_car.pump_gas(4)
    my_car.status()
    my_car.drive(50)
    my_car.status()
    my_car.drive(60)
    my_car.status()

"""
You now have 3 gallons in your tank
Mileage: 100
Tank level: 3 gallons
You made it to your destination after 50 miles.
Mileage: 150
Tank level: 1.33333333333 gallons
You ran out of gas after 40.0 miles.
Mileage: 190.0
Tank level: 0 gallons
""" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:27:41.953

我现在没有足够的时间，但我在这里放了部分代码，应该对你有帮助，稍后我会添加更多

```
import random

class Attacker(object):
    def __init__(self, power):
    """In this method you can assign
        variables or perform actions which
        you want to perform on object create"""

        #for example on object create we want
        #to set strenght of attacker
        #so this variable will live and
        #availiable for object whole it's
        #life
        self.power = power

    def attack(self):
    """So attacker must can attack
        for example this method just
        return random int multiple on self.power 
        later we compare value of from defender's
        defend method and decide who is
        winner of round"""

        return random.randint(100) * self.power 
```

# php - 对于使用 PHP 的简单应用程序，Websocket 优于 AJAX

> ID：13765008
> 
> 赞同：7
> 
> 时间：2012-12-07T14:25:47.833
> 
> 标签：php, jquery, ajax, websocket

我已经在 PHP 中使用了一些 AJAX 来处理提交表单之类的事情，而且我最近开始研究 websockets。我按照[本教程](http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/)了解基础知识。据我所知，websockets 保持连接打开，而 AJAX 打开和关闭请求。

我的问题是，如果您只是提交表单或像 auto_complete 之类的简单任务（无论如何都有一个 jQuery 插件），websockets 是否比 AJAX 提供任何优势？也许本教程不是最好的，但似乎要让 websockets 工作（至少使用 PHP）涉及更多的代码，而不仅仅是一个简单的 AJAX 调用（或使用捆绑它的 jQuery）。我在几个地方读到它会更快一些，但如果我正在处理一些没有收到大量请求的东西，它真的会有所作为吗？如果我错了，请纠正我，但并非所有浏览器都支持 websocket，对吧？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-07T14:33:31.047

Websocket 有两个优点。

1.  它们的开销要少得多，从而带来更好的网络性能

2.  它们允许服务器发送客户端未明确请求的数据。

第二个是最重要的优势。

在 AJAX 中，服务器发送的所有内容都必须是对客户端先前请求的响应，并且每个请求只能回答一次。但是在许多应用程序中，尤其是多用户应用程序中，事件发生在服务器上，这些事件必须立即推送到客户端。在 AJAX 中有一些解决方法，比如延迟对请求的回答，直到有东西要报告（长轮询），但这些都很脏。这就是为什么有 Websockets 的原因。使用 websocket 连接，服务器可以在需要时随时向客户端发送消息，而无需等待来自客户端的请求。

但不幸的是，WebSockets 也有缺点：

1.  Web 开发框架还没有很好地支持它们（还没有！）
2.  并非所有网络浏览器都支持它（[但大多数桌面浏览器已经](http://caniuse.com/websockets)支持）
3.  许多代理和反向代理无法中继 websocket 流量（还！）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-07T14:54:01.580

实际上，AJAX 和 websockets 是两个不同的类别。AJAX 是一种概念，一种技术。使用 AJAX，您可以执行（作为首字母缩略词的意思）异步请求，因此浏览器不需要重新加载/刷新整个页面。这对不同的事情都有好处，例如检查表单输入。Websockets 是一种协议，技术上与 http 完全一样，除非连接不会在传输后关闭。这对于网络服务器可能需要联系客户端（http 不能这样做）的事情很有用，例如推送服务（聊天或邮件客户端，即使用户不刷新，您也希望更新用户界面页面或游戏）。它消除了 http 开销，因为整个事情只需要在开始时完成一次。

因此，它们用于不同的目的，即使它们重叠。对于您的自动完成，我认为它不会对性能产生真正的影响。它甚至是一个动作/反应的事情，所以用户输入或提交（不管）什么会导致一个请求并且服务器响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T14:36:58.580

Websockets 是一项强大的技术，当然可以满足您提到的有限用例，但可能存在与旧浏览器和网络中介的兼容性问题。事实上，有些人甚至建议在不支持 Websocket 的情况下使用 HTTP 回退。

除非您有需要 websocket 的要求，例如全双工双向通信，否则您最好使用现有的基于 AJAX 的解决方案。

如果您需要将通知推送到您的用户界面，Websockets 可能是一个好主意，但如果您确实在寻找表单提交和自动完成，那么这些问题已经使用 Ajax 解决了。

# javascript - JavaScript 文档在函数调用后不会改变

> ID：13765009
> 
> 赞同：0
> 
> 时间：2012-12-07T14:25:50.667
> 
> 标签：javascript, html, document

我正在尝试使用 JavaScript 构建一个简单的 HTML5 音乐播放器。我用这段代码构建了一个播放器：

```
<audio controls="controls">
    <source id="song" src="horse.ogg" type="audio/ogg">
</audio> 
```

我已经构建了几个`<a>`调用函数 changeSong(n);

```
function changeSong(n) {
    document.getElementById("song").src = "song" + n + ".mp3";
} 
```

当我单击`<a>`' 时，文档没有任何反应，并且它不起作用..

的`<a>`：

```
<a href="#1" onclick="changeSong(1)">Play song 1 </a></br>
<a href="#2" onclick="changeSong(2)">Play song 2 </a> 
```

怎么做才能让它发挥作用？////

我尝试只运行不带函数的 JavaScript，它可以工作。但是当它从作为函数调用时它不会......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:28:10.367

### 改变：

```
<a href="#2" onclick="playSong(2)">Play song 2 </a> 
```

### 和：

```
<a href="#2" onclick="changeSong(2)">Play song 2 </a> 
```

那是错字吗？

* * *

### 实际上，它适用于`console`：

```
document.getElementById("song");
<source id=​"song" src=​"horse.ogg" type=​"audio/​ogg">​
document.getElementById("song").src;
"chrome://newtab/horse.ogg"
document.getElementById("song").src = 'Hi.ogg';
"Hi.ogg"
document.getElementById("song").src;
"chrome://newtab/Hi.ogg" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:29:50.460

You miss the name of the method in the call. This works:

```
<a href="#1" onclick="changeSong(1)">Play song 1 </a></br>
<a href="#2" onclick="changeSong(2)">Play song 2 </a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:30:35.590

what is your goal ? Do not tell me that you are trying to call the

```
changeSong(1) 
```

on the "Play song 1" click.

just by reading your code I can say that change

```
<a href="#2" onclick="playSong(2)">Play song 2 </a> 
```

by

```
<a href="#2" onclick="changeSong(2)">Play song 2 </a> 
```

Or I'm missing something :/

Can you add some debug code into the

```
changeSong(n){
    document.getElementById("song").src="song"+n+".mp3";
} 
```

an tell us if something is appening :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T14:31:32.207

我不熟悉 HTML5 ，但我可以找到两个错误。

1.  你打电话给 playSong 而不是 changeSong

2.  您应该声明 changeSong 是一个函数：

    ```
    function changeSong(n){
        document.getElementById("song").src = "song" + n + ".mp3";
    } 
    ```

# svg - d3中的多行svg文本轴刻度

> ID：13765012
> 
> 赞同：10
> 
> 时间：2012-12-07T14:25:57.777
> 
> 标签：svg, d3.js

我正在尝试渲染一个简单的条形图，其中每个条形都有一个标签，作为 x 轴上的轴刻度。较长的标签相互重叠。由于 svg 文本元素不支持自动换行，我一直在寻找替代解决方案。

更改进入标签的类别文本以包含正确的 <tspan> 元素不起作用，因为文本未设置为 innerHtml ，而只是元素的原始文本。我还考虑过对标签进行后处理以删除文本并将其替换为 tspan，但我还没有找到一种优雅的方法来做到这一点。

不幸的是，我不能使用 foreignObject，因为我需要 IE9 支持，但无论如何，许多相同的标记替换问题都适用于该解决方案。

过去有没有人很好地解决了这个问题或有任何建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-27T16:46:37.390

您可以按照Mike Bostock 的[示例手动进行包装：](http://bl.ocks.org/mbostock/7555321)

```
function wrap(text, width) {
  text.each(function() {
    var text = d3.select(this),
        words = text.text().split(/\s+/).reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr("y"),
        dy = parseFloat(text.attr("dy")),
        tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
    while (word = words.pop()) {
      line.push(word);
      tspan.text(line.join(" "));
      if (tspan.node().getComputedTextLength() > width) {
        line.pop();
        tspan.text(line.join(" "));
        line = [word];
        tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
      }
    }
  });
}

vis.selectAll(".tick text")
  .call(wrap, 100); 
```

# loops - 运行 VBA 代码以根据特定条件删除行时出现类型不匹配错误

> ID：13765013
> 
> 赞同：1
> 
> 时间：2012-12-07T14:26:02.710
> 
> 标签：loops, if-statement, excel, type-mismatch, vba

我正在尝试根据某些特定条件删除 Excel 工作表中的某些行。在某些时候，它会给出以下类型不匹配错误：

![ss](../Images/5f7af8385c17394208a3946500f26d09.png)

据我从部分创建的工作表中了解到，错误发生在 DO 循环内

```
Or Len(Cells(r, 1)) = 5 _
Or Int(Right(Cells(r, 1), 4)) > 4000 _
Or Cells(r, 3) = 0 
```

部分。我应该怎么做才能纠正错误？此外，如果您能推荐我改进代码以加快运行速度，我将不胜感激。完整代码如下：

```
Sub delrows()

Dim r, RowCount As Long
r = 2

ActiveSheet.Columns(1).Select
RowCount = UsedRange.Rows.Count
userresponse = MsgBox("You have " & RowCount & " rows", vbOKOnly, "Info")

Rows(RowCount).Delete Shift:=xlUp

' Trim spaces

Columns("A:A").Select
Selection.Replace What:=" ", Replacement:="", LookAt:=xlPart, _
    SearchOrder:=xlByRows, MatchCase:=False, searchFormat:=False, _
    ReplaceFormat:=False

' Delete surplus columns

Range("L:T,V:AA,AE:AG,AR:AR,AU:AU,AZ:AZ").Select
    Selection.Delete Shift:=xlToLeft

' Delete surplus rows

Do
    If Left(Cells(r, 1), 1) = "D" _
       Or Left(Cells(r, 1), 1) = "H" _
       Or Left(Cells(r, 1), 1) = "I" _
       Or Left(Cells(r, 1), 2) = "MD" _
       Or Left(Cells(r, 1), 2) = "ND" _
       Or Left(Cells(r, 1), 3) = "MSF" _
       Or Left(Cells(r, 1), 5) = "MSGZZ" _
       Or Len(Cells(r, 1)) = 5 _
       Or Int(Right(Cells(r, 1), 4)) > 4000 _
       Or Cells(r, 3) = 0 Then
     Rows(r).Delete Shift:=xlUp
    Else: r = r + 1
    End If
Loop Until (r = RowCount)

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T14:31:54.810

该条件`Or Int(Right(Cells(r, 1), 4))`是一个问题，因为它假定它正在评估的单元格内容部分是一个数字。

如果结果不是数字，则该`Int()`函数将抛出您所看到的类型不匹配错误。

`Int()`如果在应用函数之前先测试它是否实际上是一个数字会更好。您可以使用该`IsNumeric()`功能来执行此操作。

# jquery - Paypal API Phonegap - Recurring payments with Phonegap IOS HTML5 App

> ID：13765020
> 
> 赞同：0
> 
> 时间：2012-12-07T14:26:16.557
> 
> 标签：jquery, cordova, paypal

I'm trying to implement a shop into a IOS HTML5 Phonegap app which runs off a .aspx CMS (via xml feeds).

I need to implement client payments - both individual one off payments and recurring payments for repeat services

I have used Paypal in the past to do something similar with individual payments - (simply using their provided form and altering the description and cost fields accordingly in the CMS) - but I cant seem to get it working via Phonegap as i just receive whitelist errors and it wont trigger the form.

I have looked through the Paypal API docs and it isn't really clear whether this should work in a HTML5 app - does anyone have any experience with implementing recurring payments for Phonegap? I also wondered whether it was possible to get flags / emails when a recurring payment is cancelled so we can react to this server side?

Any other suggestions for suitable payment API's also welcome.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:38:48.500

市面上有很多定期计费解决方案，大多数都带有 JSON 或 XML API，您可以轻松使用：

**充电 >** [http://chargify.com/](http://chargify.com/)

**递归 >** [http://recurly.com/](http://recurly.com/)

**急速 >** [http://spreedly.com/](http://spreedly.com/)

仅举几例...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T06:30:12.830

PayPal 或任何其他网络服务都可以在 PhoneGap 中正常工作。我在 Titanium Appcelerator、jQuery Mobile 和 Sencha 中大量使用了它。

您可以使用 NVP、XML 或 JSON 直接访问 PayPal 的 API，或者我通常会构建自己的 PHP Web 服务，这样我也可以处理自己的数据库更新、第三方 Web 服务调用、电子邮件通知、社交网络更新，等等，所有这些都来自这些服务，并从移动应用程序本身简化一切。

# sql - 如何在我部署的 SSIS 包中启用日志记录？

> ID：13765024
> 
> 赞同：1
> 
> 时间：2012-12-07T14:26:34.867
> 
> 标签：sql, sql-server-2005, logging, ssis

我已经创建了一个 SSIS 包并将其部署到 SQL Server (2005)。我没有在我的部署包中启用任何日志记录。我已经配置了一个作业来运行这个包。我现在无法修改包。

我可以做些什么来为包或 SQL 代理作业中的某些东西提供某种日志记录以提供一些日志记录**？**

**SQL 代理作业历史**不会被保留，所以这不是一个选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T15:18:39.780

如何将您的作业步骤类型从集成服务更改为操作系统命令。从那里，您将从命令行调用[dtexec](http://msdn.microsoft.com/en-us/library/ms162810%28v=sql.90%29.aspx)并将输出重定向到文件。逻辑近似

```
dtexec.exe /sql "\OptionalFolder\PackageName" /Server MyServer /reporting V > PackageName.log 
```

您可能还对 dtexec 的 ConsoleLog 参数感兴趣。请注意，这将在每次运行包时覆盖文件。如果您想在一个文件中多次运行，请使用`>>`而不是单个重定向。

## 编辑

你目前的工作可能是这样定义的。右键单击作业并将作业编写为创建到新的查询编辑器窗口。找到所在的部分`@subsystem=N'SSIS'`

```
USE [msdb]
GO

DECLARE @ReturnCode INT
SELECT @ReturnCode = 0

DECLARE @jobId BINARY(16)
EXEC @ReturnCode =  msdb.dbo.sp_add_job @job_name=N'MyJob', 
        @enabled=0, 
        @notify_level_eventlog=0, 
        @notify_level_email=0, 
        @notify_level_netsend=0, 
        @notify_level_page=0, 
        @delete_level=0, 
        @description=N'No description available.', 
        @category_name=N'[Uncategorized (Local)]', @job_id = @jobId OUTPUT

-- This is approximates your existing job step of type (assuming defaults)
-- SQL Server Integration Services Package
EXEC @ReturnCode = msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N'Run SSIS Package', 
        @step_id=1, 
        @cmdexec_success_code=0, 
        @on_success_action=1, 
        @on_success_step_id=0, 
        @on_fail_action=2, 
        @on_fail_step_id=0, 
        @retry_attempts=0, 
        @retry_interval=0, 
        @os_run_priority=0, @subsystem=N'SSIS', 
        @command=N'/SQL "\OptionalFolder\PackageName" /SERVER MyServer /MAXCONCURRENT " -1 " /CHECKPOINTING OFF /REPORTING E', 
        @database_name=N'master', 
        @flags=0

EXEC @ReturnCode = msdb.dbo.sp_update_job @job_id = @jobId, @start_step_id = 1
EXEC @ReturnCode = msdb.dbo.sp_add_jobserver @job_id = @jobId, @server_name = N'(local)' 
```

真正要做的就是为您的 SQL Server 版本调用正确的 dtexec（32 位或 64 位）可执行文件（如果您有并行安装）。您*也许*可以手动编辑命令行并重定向输出。我从未尝试过，但理论上它应该可以工作。

![在此处输入图像描述](../Images/b2eb8d911284b4c95729a2d6ff26fa20.png)

如果没有，那么我所知道*的*工作是从作业步骤显式调用可执行文件。上面的步骤将被替换为

```
EXEC msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N'Run SSIS from OS type', 
    @step_id=1, 
    @cmdexec_success_code=0, 
    @on_success_action=3, 
    @on_fail_action=2, 
    @retry_attempts=0, 
    @retry_interval=0, 
    @os_run_priority=0, @subsystem=N'CmdExec', 
    @command=N'"C:\Program Files\Microsoft SQL Server\90\DTS\Binn\DTExec.exe" /sql "\OptionalFolder\PackageName" /Server MyServer /reporting V > PackageName.log', 
    @database_name=N'master', 
    @flags=0 
```

## 编辑 2

我不知道，重定向`>`似乎在操作系统子步骤中引发了错误。考虑到作业步骤也需要能够捕获输出流，这可能是有道理的。无论如何，方法仍然是相同的，将输出重定向到一个文件——我们将简单地更新机制。

# 批量方法

创建一个 .bat 文件或一对。我打电话给我的`RunPackage.bat`并将`RunPackage32.bat`它们放入一个名为 C:\ssis 的文件夹中。它们的内容是

```
"C:\Program Files\Microsoft SQL Server\90\DTS\Binn\DTExec.exe" /sql "\%1" /Server MyServer /reporting V > C:\ssis\%1.log 
```

和

```
"C:\Program Files (x86)\Microsoft SQL Server\90\DTS\Binn\DTExec.exe" /sql "\%1" /Server MyServer /reporting V > C:\ssis\%1.log 
```

作业步骤仍然是一种操作系统，但实际命令变为

```
@command=N'C:\ssis\RunPackage.bat Package' 
```

SQL 代理或操作系统步骤的代理需要对您记录详细信息的任何位置进行读写访问。

# php - MySQL 使用日期时间完整性检查将行插入数据库

> ID：13765026
> 
> 赞同：0
> 
> 时间：2012-12-07T14:26:46.497
> 
> 标签：php, mysql, frameworks

我正在制作一个会议室预订系统，其中在开始和结束日期内不应该有任何时间，因此理论上验证应该在一个开始和结束日期时间范围内检查没有日期/时间。

我有两个表，我可以将开始日期和结束日期都插入其中，所以我目前唯一感兴趣的列是这些

会议室
|------------------------------------------------|
|- 预订时间-|-预订结束-|

我了解健全性检查背后的原理以及我可以在 psudocode 中进行的检查。这是我到目前为止得到的代码->

```
p4a_db::singleton()->query("INSERT INTO meetingrooms(location_id, bookingtime, bookingend, merono_id)
                WHERE bookingtime < " . $date . " AND bookingend > " . $date . "
                OR
                bookingdate < " . $date . " AND bookingend > " . $dateend . "
                VALUES(?,?,?,?)",
                array($location, $date, $dateend, $merono)); 
```

我不想将数据直接插入到语句中，但在我明白如何做到这一点之前，我被卡住了，所以问题是，

**如何在插入数据之前**执行完整性检查，以免在预定时间内获得日期。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:36:41.623

**编辑：**

我一直在想我的答案，我意识到旧的解决方案不适用于你的情况，因为你需要时间跨度，比较开始日期和结束日期是没有用的。

我的处理方式是：

1.  将日期保存为 int，使用 24 小时制（早上 7:40 是 740，晚上 9:50 是 2150）
2.  检查存储的日期，其中：( `Start<NewStart<End`)
3.  检查存储的日期，其中：( `Start<NewEnd<End`)
4.  处理多个房间时，只需将房间号+时间存储为int。这样你仍然可以使用 2 和 3 中的方法。

2 和 3 可以在 sql 查询中完成，请查看[此](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html)链接。

**旧答案（检查重复）**

这是在插入文本之前如何检查重复项（在本例中为电子邮件）的示例：

```
 $emailexist = $mysqli->prepare("select email from users where email = ?");
    $emailexist->bind_param('s', $email);
    $emailexist->execute();
    $emailexist->store_result();
    if ($emailexist->num_rows > 0) {
        $emailexist->close();
        $mysqli->close();
        return true;
    }
    else {
        $emailexist->close();
        $mysqli->close();
        return false;
    } 
```

它检查是否有包含该字符串的行。如果是这样（如果行数大于 0），则返回 true（这意味着日期已经存在）。

您可以将其调整为您的代码。

但是，您也可以只将列设置为 UNIQUE。然后在尝试插入时出现错误。它更容易，并且您不会遇到并发连接的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T09:21:47.343

经过长时间的深入搜索，我现在得到了这个方法的一个工作示例，以及一种防止 sql 注入的方法，这是代码；

```
if ($this->BookingValue == 1)
    {
        $sql = "SELECT COUNT(*) as num FROM meeting_room_bookings
                WHERE
                (
                (? < start_at AND ? > start_at)
                OR
                (? > start_at AND ? < end_at)
                )
                AND
                meeting_room_id = ?";

        $result = p4a_db::singleton()->fetchRow($sql, array($date, $date, $date, $dateend, $merono));

        if ( 0 == $result["num"] )
        {

         p4a_db::singleton()->query("INSERT INTO meeting_room_bookings (start_at, end_at, meeting_room_id)
                    VALUES
                    (?,?,?)", array($date, $dateend, $merono));

            return true;
        }       
        else
        {
         return false; 
```

关于这段代码没有太多解释，但就差异而言，（不包括与表的列名更改）现在在设置值之前准备好查询，然后可以在`if`语句中使用它，从而允许进行验证以过滤不同日期之间的结果。

`AND`除此之外，我还添加了验证，以通过将会议室 ID 限制为单个值的语句将其他会议室的日期包含在语句中。

虽然现在，这将导致一个单独的问题是来自该语句的另一个抛出的错误，但我知道插入是正确的，但是这个准备好的语句中的某些东西会导致错误：

`SQLSTATE[HY093]: Invalid parameter number: number of bound variables does not match number of tokens File: Pdo.php, Line: 234`

虽然现在我正在研究从准备好的语句中抛出的错误，并且会在有修复时更新此答案，但感谢您的帮助。

# actionscript-3 - Is there a solid definition for error 2007 in ActionScript?

> ID：13765027
> 
> 赞同：1
> 
> 时间：2012-12-07T14:26:47.920
> 
> 标签：actionscript-3, air

Adobe's runtIme error documentation doesn't specify error code 2007 yet it gets raised here and there from time to time for different reasons. The commonality among them seems to be when an API is specifically rejecting a parameter due to it being null. This is opposed to trying to access a null reference. My guess is that this is similar to an InvalidArgumentException in Java, but nothing I come across confirms that.

Anyone with knowledge at this depth?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:54:46.520

**ActionScript 错误 #2007**：参数文本必须为非空。

您可能正在尝试将**null**分配给 TextField的**text 属性**：

```
var txtField:TextField = new TextField();

txtField.text = null; 
```

[此错误是由TextField的](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#text)**set text**函数引发的，该函数需要一个字符串。

# java - 在 Opera 浏览器中允许不受信任的 SSL 证书。硒测试（Java）

> ID：13765030
> 
> 赞同：1
> 
> 时间：2012-12-07T14:27:04.493
> 
> 标签：java, testing, selenium, ssl-certificate, opera

如何允许 Selenium WebDriver 在**Opera 浏览器**上接受不受信任的证书？ ![Opera 安全问题](../Images/e36d316d2026cee83899b5ea67513522.png)

我尝试使用此代码。没有阳性结果

```
DesiredCapabilities capabilities = new DesiredCapabilities();
capabilities.setCapability(CapabilityType.ACCEPT_SSL_CERTS, true);
WebDriver driver = new OperaDriver(capabilities); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:42:53.000

为您的 Opera 浏览器创建自定义配置文件，然后设置功能

```
DesiredCapabilities capabilities = DesiredCapabilities.opera();
capabilities.setCapability("opera.profile", new OperaProfile("/path/to/existing/profile"));
capabilities.setCapability(CapabilityType.ACCEPT_SSL_CERTS, true);
WebDriver driver = new OperaDriver(capabilities); 
```

# javascript - 使用 JavaScript 抓取/窃听 AJAX 数据？

> ID：13765031
> 
> 赞同：16
> 
> 时间：2012-12-07T14:27:07.843
> 
> 标签：javascript, ajax, google-chrome-extension, hook, scrape

是否可以使用 JavaScript 抓取正在使用 AJAX 实时更新的网页的所有更改？我希望每秒使用 AJAX 抓取更新数据的网站，我想获取所有更改。这是一个拍卖网站，只要用户出价，就会有几个对象发生变化。出价时会发生以下变化：

当前出价 当前最高出价者 拍卖计时器已加回时间

我希望使用基于 JavaScript 的 Chrome 扩展来获取这些数据。是否有 JavaScript 的 AJAX 侦听器可以完成此操作？工具包？我需要一些方向。JavaScript可以做到这一点吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-07T18:20:05.870

*我将展示两种解决问题的方法。无论您选择哪种方法，都不要忘记阅读我的答案底部！*

**首先，我提出了一个仅在页面使用 jQuery 时才有效**的简单方法。第二种方法看起来稍微复杂一些，但也适用于没有 jQuery 的页面。

以下示例展示了如何实现基于方法（例如 POST/GET）、URL 以及读取 (POST) 数据和响应主体的过滤器。

## 在 jQuery 中使用全局 ajax 事件

有关 jQuery 方法的更多信息可以在[`.ajaxSuccess`](http://api.jquery.com/ajaxSuccess/). 用法：

```
jQuery.ajaxSuccess(function(event, xhr, ajaxOptions) {
    /* Method        */ ajaxOptions.type
    /* URL           */ ajaxOptions.url
    /* Response body */ xhr.responseText
    /* Request body  */ ajaxOptions.data
}); 
```

## 纯 JavaScript 方式

当网站不使用 jQuery 处理其 AJAX 请求时，您必须修改内置`XMLHttpRequest`方法。这需要更多代码...：

```
(function() {
    var XHR = XMLHttpRequest.prototype;
    // Remember references to original methods
    var open = XHR.open;
    var send = XHR.send;

    // Overwrite native methods
    // Collect data: 
    XHR.open = function(method, url) {
        this._method = method;
        this._url = url;
        return open.apply(this, arguments);
    };

    // Implement "ajaxSuccess" functionality
    XHR.send = function(postData) {
        this.addEventListener('load', function() {
            /* Method        */ this._method
            /* URL           */ this._url
            /* Response body */ this.responseText
            /* Request body  */ postData
        });
        return send.apply(this, arguments);
    };
})(); 
```

## 让它在 Chrome 扩展程序中工作

前面显示的代码必须在页面的上下文中运行（在您的情况下，是拍卖页面）。出于这个原因，必须使用**注入（！）脚本的**[内容](https://developer.chrome.com/extensions/content_scripts.html)脚本。使用它并不难，我参考这个答案以获得详细的解释和使用示例：[Building a Chrome Extension - Inject code in a page using a Content script](https://stackoverflow.com/a/9517879/938089?building-a-chrome-extension-inject-code-in-a-page-using-a-content-script)。

 **## 通用方法

[`chrome.webRequest`](https://developer.chrome.com/extensions/webRequest.html)您可以使用API读取请求正文、请求标头和响应标头。标题也可以修改。然而，它（还）不能读取，更不用说修改请求的响应正文了。如果您想要此功能，请给[https://code.google.com/p/chromium/issues/detail?id=104058 加注](https://code.google.com/p/chromium/issues/detail?id=104058)星标。**

# android - 等一下 - 安卓

> ID：13765034
> 
> 赞同：2
> 
> 时间：2012-12-07T14:27:11.217
> 
> 标签：android, wait

我希望我的程序在我的情况下等待 10 秒，但它不起作用我尝试使用`Thread.sleep(10000);`但它不是 10 秒

```
while (true) {
    for (int i = 0; i < 2; i++) {
        for (int j = 0; j < 5; j++) {
            if (matrixVacancy[i][j] == 1) {
                completeParking(i, j, R.color.vaga_ocupada);
            } else {
                completeParking(i, j, R.color.cor_chao);
            }
        }
    }
    try {
        Thread.sleep(10000);
    } catch (InterruptedException ex) {
    }

    int a, b, c, d, e, f, g, h, i;

    a = (int) (Math.random() * 2); // indice i
    b = (int) (Math.random() * 5); // indice j
    c = (int) (Math.random() * 2); // tem ou nao carro

    d = (int) (Math.random() * 2); // indice i
    e = (int) (Math.random() * 5); // indice j
    f = (int) (Math.random() * 2); // tem ou nao carro

    g = (int) (Math.random() * 2); // indice i
    h = (int) (Math.random() * 5); // indice j
    i = (int) (Math.random() * 2); // tem ou nao carro

    matrixVacancy[a][b] = c;
    matrixVacancy[d][e] = f;
    matrixVacancy[g][h] = i;
} 
```

我该怎么做？让我等 10 秒？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-07T14:34:28.100

取决于你试图睡觉的线程。您也可以将您的方法放在一个单独的线程中并在那里执行您的方法。这样你的应用程序就不会挂起/休眠

```
private class TimeoutOperation extends AsyncTask<String, Void, Void>{

    @Override
    protected Void doInBackground(String... params) {

        try {
            Log.i(TAG, "Going to sleep");
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPostExecute(Void result) {
        Log.i(TAG, "This is executed after 10 seconds and runs on the main thread");
        //Update your layout here
        super.onPostExecute(result);
    }
} 
```

要运行此操作，请使用

```
new TimeoutOperation().execute(""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:39:17.610

改变：

```
 catch (InterruptedException ex) {
    } 
```

至：

```
 catch (InterruptedException ex) {
        ex.printStackTrace();
    } 
```

检查 logcat 以确保睡眠没有被中断。

此外，在调用 Thread.sleep 之前和之后放置一些 Log 语句，打印出经过的时间。

Logcat 是你的朋友。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:30:47.657

First I'd break point to see if your sleep is even called. Second I'd print the exception when your catching the InterruptException. Your sleep is correct so there's no reason it shouldn't be working so either someone is interrupting you or your not even getting to the sleep function.

# class - Matlab类函数 - 获取返回值

> ID：13765037
> 
> 赞同：2
> 
> 时间：2012-12-07T14:27:22.263
> 
> 标签：class, matlab, methods

在我的项目中，我使用两个类——行和三角形。类行在其函数中创建三角形类对象：

```
classdef row < handle

% some parameters here

methods

% constructor and some other functions here

function [T1 T2] = createFoR(obj, hT, Alpha, Beta, DeltaAlpha, DeltaBeta)
         % creating P1 matrix (irrelevant, its 100% correct)
         T1 = triangle(P1);
         % creating P2 matrix (irrelevant, its 100% correct)
         T2 = triangle(P2);
end

end 
```

当我像这样调用这个行类函数时：

```
[T1 T2] = Row1.createFoR(T(1,1), Alpha, Beta, DeltaAlpha, DeltaBeta); 
```

或像这样：

```
[T(2,1) T2] = Row1.createFoR(T(1,1), Alpha, Beta, DeltaAlpha, DeltaBeta); 
```

一切正常。但是当我尝试将两个返回的三角形对象分配给这样的数组单元格时：

```
[T(2,1) T(2,2)] = Row1.createFoR(T(1,1), Alpha, Beta, DeltaAlpha, DeltaBeta); 
```

我收到此错误：

```
Error using triangle (line 10)
Not enough input arguments.

Error in test (line 20)
[T(2,1) T(2,2)] = Row1.createFoR(T(1,1), Alpha, Beta, DeltaAlpha, DeltaBeta); 
```

我可以请你解释一下我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:38:21.653

~~看起来 T 是一个对象，其中 T(double,double) 是一个函数/构造函数。所以在你指出的情况下~~

```
[T(2,1) T(2,2)] = Row1.createFoR(T(1,1), Alpha, Beta, DeltaAlpha, DeltaBeta); 
```

~~您实际上调用了 T(double, double) 三次，其中错误专门发生在 T(2,2) 中（其中代码 100% 正确？）。~~

**从评论更新**

奇怪的是三角形线 10 中的输入参数错误。问题可能出在 P1、P2 中吗？

您也可以尝试以下方法 - 但它的猜测没有我可以运行/重现问题的东西（错误在未列出的代码中？）

```
[T1 T2] = Row1.createFoR(T(1,1), Alpha, Beta, DeltaAlpha, DeltaBeta);
T(2,1:2) = [T1, T2]; 
```

**回答：**

另一个想法是，当 T(2,2) 被填满时，它试图在没有参数的情况下构造 T(1,2)？

# internationalization - wxWidgets：命名 .po/.mo 文件的首选方式：en/app.mo 还是 en.mo？

> ID：13765038
> 
> 赞同：0
> 
> 时间：2012-12-07T14:27:23.620
> 
> 标签：internationalization, wxwidgets, gettext

我的应用程序将使用 wxWidgets 编写，但问题可能与`gettext`一般使用有关。

对于名为 的应用程序`app`，一些消息来源建议我创建`<lang>/`子目录，`app.po`在其中创建带有翻译的文件，并将其转换为子目录中的分布式`app.mo`文件。

另一种方法是创建`app.pot`（即通过 来自源的模板`xgettext`），并将`msginit`其`msgmerge`用于`<lang>.po`语言。

对于第一种方法，`.mo`可以将更多文件放在`<lang>/`子目录中。还`wxLocale::AddCatalog()`获取*域名*（域自然可以是`app`,`wxstd`等）。另一方面，`<lang>.po`文件名本身就是描述性的——无论它位于何处。

这两种方法的优缺点是什么？是否有任何文字说明要选择的路径？

感谢您的时间和经验，

彼得

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T11:50:28.297

Unix 约定`app.mo`用于二进制目录，请参阅目录的内容`/usr/share/locale`。然而，有时`lang.po`用于源代码，就像在 wxWidgets 本身中所做的那样（参见它的`locale`子目录），但它们仍然使用依赖于应用程序的名称安装到特定于语言的子目录中。

# html - 使用 CSSSelector 从下拉列表中选择第一个选项

> ID：13765039
> 
> 赞同：0
> 
> 时间：2012-12-07T14:27:25.337
> 
> 标签：html, css, css-selectors

下面是选择 html 代码，我正在寻找第一个选项`15`

```
<select>
<option value="15" selected="selected">15</option>
<option value="25">25</option>
<option value="50">50</option>
<option value="100">100</option>
</select> 
```

我在下面试过这个，我得到了所有的选择`15,25,50,100`

```
div#topPager.gridHeader div.pagerItemContainer select.pagesize option 
```

如果我使用这样的第 n 个类型，那么我得到了第一个选择。

```
div#topPager.gridHeader div.pagerItemContainer select.pagesize option:nth-of-type(1) 
```

有没有其他方法可以代替使用`nth-of-type`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:29:03.130

更重要和准确：

```
#yourSpecificSelectors option[value="15"] {} 
```

这称为属性选择器，在这种情况下，它与`option`with匹配`value="15"`。

[http://www.w3.org/TR/CSS2/selector.html#attribute-selectors](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)

# android - Android 图像共享到 ImageShack 站点

> ID：13765043
> 
> 赞同：1
> 
> 时间：2012-12-07T14:27:44.050
> 
> 标签：android, imageshack

我正在开发一个安卓应用程序。在这个应用程序中，需要使用他们的 api 将图像上传到 imageShack 站点。

**这里的“sourceFileUri”是来自设备sdcard的图像文件路径。它显示Outh或dev Key无效。**. 请任何人都可以帮助我找出错误。进阶谢谢。

```
private void goForUpload(final String sourceFileUri)
{
    if (!SharedPreferencesHelper.isOnline(con))
    {
        return;
    }

    pDialog = ProgressDialog.show(this, "Please wait...", "Loading...",false, false);

    final Thread d = new Thread(new Runnable() 
    {
        @Override
        public void run() {

            String upLoadServerUri = " http://www.imageshack.us/upload_api.php";

            String fileName = sourceFileUri;

            HttpURLConnection conn = null;
            DataOutputStream dos = null;
            String lineEnd = "\r\n";
            String twoHyphens = "--";
            String boundary = "*****";
            int bytesRead, bytesAvailable, bufferSize;
            byte[] buffer;
            int maxBufferSize = 1 * 1024 * 1024;
            File sourceFile = new File(sourceFileUri);

            Log.w("file name are...", "" + sourceFile);
            if (!sourceFile.isFile()) {
                Log.e("uploadFile", "Source File Does not exist");
            }

            try { // open a URL connection to the Servlet
                FileInputStream fileInputStream = new FileInputStream(sourceFile);
                URL url = new URL(upLoadServerUri);
                conn = (HttpURLConnection) url.openConnection(); // Open a
                                                                    // HTTP
                                                                    // connection
                                                                    // to
                                                                    // the
                                                                    // URL
                conn.setDoInput(true); // Allow Inputs
                conn.setDoOutput(true); // Allow Outputs
                conn.setUseCaches(false); // Don't use a Cached Copy
                conn.setRequestMethod("POST");
                conn.setRequestProperty("Connection", "Keep-Alive");
                //conn.setRequestProperty("ENCTYPE", "multipart/form-data");
                conn.setRequestProperty("Content-Type","multipart/form-data;boundary=" + boundary);
                conn.setRequestProperty("uploaded_file", fileName);

                dos = new DataOutputStream(conn.getOutputStream());
                dos.writeBytes(twoHyphens + boundary + lineEnd);
                // ///////////////////////////////////////////////////////////////////

                //for image
                dos.writeBytes("Content-Disposition: form-data; name=\"fileupload\";filename=\""+ fileName + "\"" + lineEnd);
                dos.writeBytes(lineEnd);
                dos.writeBytes(twoHyphens + boundary + lineEnd);

                dos.writeBytes("Content-Disposition: form-data; name=\"key\""+ lineEnd);
                dos.writeBytes(lineEnd);
                dos.writeBytes("289DGHSTbbfb01094c0017d23e96fe1edecda161");
                dos.writeBytes(lineEnd);
                dos.writeBytes(twoHyphens + boundary + lineEnd);

                bytesAvailable = fileInputStream.available(); 

                bufferSize = Math.min(bytesAvailable, maxBufferSize);
                buffer = new byte[bufferSize];

                // read file and write it into form...
                bytesRead = fileInputStream.read(buffer, 0, bufferSize);

                while (bytesRead > 0) 
                {
                    dos.write(buffer, 0, bufferSize);
                    bytesAvailable = fileInputStream.available();
                    bufferSize = Math.min(bytesAvailable, maxBufferSize);
                    bytesRead = fileInputStream.read(buffer, 0, bufferSize);
                }

                // send multipart form data necesssary after file data...
                dos.writeBytes(lineEnd);
                dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

                // Responses from the server (code and message)
                serverResponseCode = conn.getResponseCode();
                String serverResponseMessage = conn.getResponseMessage();
                InputStream servere = conn.getInputStream();
                String uyy = HttpRequest.GetText(servere);

                System.out.print(uyy);

                Log.w("uyy", "" + uyy);

                Log.i("uploadFile", "HTTP Response is : "+ serverResponseMessage + ": " + serverResponseCode);

                if (serverResponseCode == 200) 
                {
                    runOnUiThread(new Runnable()
                    {
                        public void run()
                        {
                            Toast.makeText(MainActivity.this,"File Upload Complete.",Toast.LENGTH_SHORT).show();
                        }
                    });
                }

                // close the streams //
                fileInputStream.close();
                dos.flush();
                dos.close();

                // Log.w("url", ""+url);

                // final String url =
                // "http://www.imageshack.us/upload_api.php?fileupload=http://www.libpng.org/pub/png/img_png/pnglogo-blk.jpg&url="+fos+"&optsize=100x100&rembar=yes&key=DHKNPRWYb185051e16c4545d8f26828d6fd3886c";

                // final String url =
                // "https://api.mobypicture.com/2.0/upload.json";//key=Az7IN9Qaxu3eZeK5/media=http://www.libpng.org/pub/png/img_png/pnglogo-blk.jpg/message=wasir";
                //
                // final String result = HttpRequest.GetText(HttpRequest
                // .getInputStreamForGetRequest(url));
                //
                // try {
                // if (parser.connect(con, result)) {
                // Log.d("What is result :", result);
                // }
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            /*
             * update the GUI
             */

            runOnUiThread(new Runnable() {

                @Override
                public void run() {

                    if (pDialog != null) {
                        pDialog.cancel();
                    }
                }

            });

        }
    });

    d.start();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T15:18:55.357

第一个问题是您拥有表单数据部分的顺序：

```
 dos.writeBytes("Content-Disposition: form-data; name=\"key\""+ lineEnd);
            dos.writeBytes(lineEnd);
            dos.writeBytes("xxxxxxxxxxxxxxxxxx");
            dos.writeBytes(lineEnd);
            dos.writeBytes(twoHyphens + boundary + lineEnd);

            //for image
            dos.writeBytes("Content-Disposition: form-data; name=\"fileupload\";filename=\""+ fileName + "\"" + lineEnd);
                dos.writeBytes("Content-Type: image/jpeg" + lineEnd);
                dos.writeBytes("Content-Transfer-Encoding: binary" + lineEnd);
            dos.writeBytes(lineEnd);
            //dos.writeBytes(twoHyphens + boundary + lineEnd); 
```

第二个问题（当我尝试时）是图像类型无效，所以我添加了如上所示的内容类型。在写入文件内容之前，您不需要边界。

# javascript - javascript和firefox函数的定义

> ID：13765044
> 
> 赞同：0
> 
> 时间：2012-12-07T14:27:47.740
> 
> 标签：javascript, function, firefox

我有这个代码：

```
function a() {
    if(prodotto.approvatoIngredienti==true) {
        disegnaIconaIngredienti();

        function disegnaIconaIngredienti() {
            //
        }
    } 
```

我在另一个函数中定义了一个函数。使用chrome和ie我没有问题，但是firefox给了我这个错误：

```
 --
 [15:26:41.279] disegnaIconaIngredienti is not defined @      http://127.0.0.1:8080/Tesi/javascript/InserimentoProdotti.js:1718 
```

有人可以解释我为什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:29:14.380

你还没有`if`在第二行结束你的陈述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:30:45.200

您的代码在 Firefox 中等效于

```
var disegnaIconaIngredienti;
if (prodotto.approvatoIngredienti==true){
   disegnaIconaIngredienti();
   disegnaIconaIngredienti = function(){
      //
   }
} 
```

因此，当您调用它时，该变量没有值。

Chrome 和 Internet Explorer 提升了整个函数声明，而不仅仅是变量声明。

ECMAScript 不允许在非功能块（如您的`if`）中定义函数。浏览器允许它，但方式不同。

这个[相关问题](https://stackoverflow.com/questions/5758042/which-js-function-declaration-syntax-is-correct-according-to-the-standard)在主题中更深入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T14:31:02.940

这是因为 Firefox 有一些叫做函数语句的东西。它们不同于典型的声明，并且可以合法地在一个块中发生。

正如您在声明中发现的那样，函数本身没有提升，因此需要在使用之前对其进行定义。

请注意，在典型的 ECMAScript 中，在语句中包含这种风格的函数是*无效*`if`的，尽管某些浏览器允许这样做。严格模式绝对禁止它。

要在 中创建完全有效的函数`if`，它必须是作为表达式一部分的函数，例如赋值。

```
function a(){
    if(prodotto.approvatoIngredienti == true) {

                   // legal function in a block
         var disegnaIconaIngredienti = function() {
            //
         };
         disegnaIconaIngredienti();
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T14:30:58.707

你忘了关闭 if 大括号

```
function a(){
if(prodotto.approvatoIngredienti==true){
    disegnaIconaIngredienti();
}

function disegnaIconaIngredienti() {
     //
     }
 } 
```

在进一步考虑您的关闭 if 和 @dystroy 的帖子后，我倾向于同意他的观点并说 Firefox 不允许使用

他的部分帖子要回答：

> ECMAScript 不允许在非功能块中定义函数（比如你的 if）。浏览器允许它，但方式不同。

就像您的情况一样，Firefox 不允许在条件块中使用它。

# ssis - 如何验证来自平面文件的数据？

> ID：13765050
> 
> 赞同：0
> 
> 时间：2012-12-07T14:28:12.050
> 
> 标签：ssis

我使用脚本组件来验证超过 50 列的数据。但这需要更多时间。任何机构都可以在 ssis 中没有第三方工具的情况下为此验证提供解决方案。

例如 ：

我在以下几点验证了 dob 列

1.  日期格式是否正确。这是我期望的格式（mm/dd/yyyy）。
2.  DOB 不等于空。
3.  DOB 值不大于 (12/31/9999)。
4.  DOB 值也检查是否是日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:48:29.087

如果您对 excel 文件中的字段有疑问，可以将数据导入临时表，创建所有字段为 varchar 的表，然后将文件中的数据插入其中，加载数据后，您可以使用sql验证或者用ssis组件来验证数据，你应该测试哪个更快。

**编辑 1：** 在此之后，您可以创建函数来验证每个字段，例如：

```
CREATE Function [dbo].[Validate_Field](
    @Code [varchar](2),
    @Code2 [varchar](2)
)
Returns VarChar(50) AS
BEGIN
    Declare @return Varchar(50)   
    SET @Salida = ''    
    IF @Code = '29' RETURN 'Something 1'    
    IF @Code2 = '21' RETURN 'Something 2'   
    ELSE RETURN 'Missing'   
    Return (@return)
END

SELECT [dbo].[Validate_Field](Field1, Field2)
FROM Staging_Table 
```

我希望这有帮助。

# xmpp - 获取发布者的离线消息

> ID：13765054
> 
> 赞同：0
> 
> 时间：2012-12-07T14:28:28.550
> 
> 标签：xmpp, publish-subscribe, openfire

我已经`XEP-0060`使用 pubsub 实现`openfire`了，我能够在现有节点上发布消息，并且我有其他订阅者可以获得这些发布的消息。

现在的问题是，我无法接收旧消息，我的意思是，如果订阅者处于离线状态并且当他们重新在线时，那么我如何才能获得发布者长期以来发布的旧消息。

我的发布者发布的节点配置如下

```
<iq from="pubsub.example.com" type="result" id="meta1" to="lime@example.com/localhost">
<query xmlns="http://jabber.org/protocol/disco#info" node="mynode/loc">
<identity category="pubsub" type="leaf"/>
<feature var="http://jabber.org/protocol/pubsub"/>
<feature var="http://jabber.org/protocol/disco#info"/>
<x xmlns="jabber:x:data" type="result">
<field type="hidden" var="FORM_TYPE">
<value>http://jabber.org/protocol/pubsub#meta-data</value>
</field>
<field type="text-single" label="Short name for the node" var="pubsub#title">
<value/>
</field>
<field type="text-single" label="Description of the node" var="pubsub#description">
<value/>
</field>
<field type="boolean" label="Allow subscriptions to node" var="pubsub#subscribe">
<value>1</value>
</field>
<field type="boolean" label="New subscriptions require configuration" var="pubsub#subscription_required">
<value>0</value>
</field>
<field type="boolean" label="Deliver payloads with event notifications" var="pubsub#deliver_payloads">
<value>1</value>
</field>
<field type="boolean" label="Notify subscribers when the node configuration changes" var="pubsub#notify_config">
<value>1</value>
</field>
<field type="boolean" label="Notify subscribers when the node is deleted" var="pubsub#notify_delete">
<value>1</value>
</field>
<field type="boolean" label="Notify subscribers when items are removed from the node" var="pubsub#notify_retract">
<value>1</value>
</field>
<field type="boolean" label="Only deliver notifications to available users" var="pubsub#presence_based_delivery">
<value>0</value>
</field>
<field type="text-single" label="Type of payload data to be provided at this node" var="pubsub#type">
<value/>
</field>
<field type="text-single" label="Message body XSLT" var="pubsub#body_xslt">
<value/>
</field>
<field type="text-single" label="Payload XSLT" var="pubsub#dataform_xslt">
<value/>
</field>
<field type="list-single" label="Specify who may subscribe and retrieve items" var="pubsub#access_model">
<option>
<value>authorize</value>
</option>
<option>
<value>open</value>
</option>
<option>
<value>presence</value>
</option>
<option>
<value>roster</value>
</option>
<option>
<value>whitelist</value>
</option>
<value>open</value>
</field>
<field type="list-single" label="Publisher model" var="pubsub#publish_model">
<option>
<value>publishers</value>
</option>
<option>
<value>subscribers</value>
</option>
<option>
<value>open</value>
</option>
<value>open</value>
</field>
<field type="list-multi" label="Roster groups allowed to subscribe" var="pubsub#roster_groups_allowed"/>
<field type="jid-multi" label="People to contact with questions" var="pubsub#contact"/>
<field type="text-single" label="Default language" var="pubsub#language">
<value>English</value>
</field>
<field type="jid-multi" label="Node owners" var="pubsub#owner">
<value>mypublisher@example.com</value>
</field>
<field type="jid-multi" label="Node publishers" var="pubsub#publisher"/>
<field type="list-single" label="Select entity that should receive replies to items" var="pubsub#itemreply">
<value>owner</value>
</field>
<field type="jid-multi" label="Multi-user chat room to which replies should be sent" var="pubsub#replyroom"/>
<field type="jid-multi" label="Users to which replies should be sent" var="pubsub#replyto"/>
<field type="boolean" label="Send items to new subscribers" var="pubsub#send_item_subscribe">
<value>1</value>
</field>
<field type="boolean" label="Persist items to storage" var="pubsub#persist_items">
<value>1</value>
</field>
<field type="text-single" label="Max number of items to persist" var="pubsub#max_items">
<value>5</value>
</field>
<field type="text-single" label="Max payload size in bytes" var="pubsub#max_payload_size">
<value>5120</value>
</field>
</x>
</query>
</iq> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:11:24.440

是的，我明白了，当订阅者使用以下节上线时，他/她可以检索旧的已发布项目

`subid`在这种情况下是必须的

```
<iq type='get'
    from='subscriber@example.com'
    to='pubsub.example.com'
    id='items1'>
  <pubsub xmlns='http://jabber.org/protocol/pubsub'>
    <items node='mynode'
subid="8839399494949"/>
  </pubsub>
</iq> 
```

# javascript - 在中更改为 name 属性

> ID：13765059
> 
> 赞同：1
> 
> 时间：2012-12-07T14:28:50.227
> 
> 标签：javascript, jquery

我想更改元素中的名称属性`<input>`，我在这里有几个名称`string[0][]`，现在我想在单击链接后在它们中添加更改 ‍‍<code>0 并替换`1`全部`0`。Jquery怎么样？

**演示：http:** [//jsfiddle.net/2hXk5/](http://jsfiddle.net/2hXk5/)

我尝试但不适合我：

```
<div class="ch">
    <p>
        <input type="checkbox" name="cDA[0][]">
        <input type="checkbox" name="cDA[0][]">
        <input type="checkbox" name="cDA[0][]">
        <input type="checkbox" name="cDA[0][]">
    </p>
    <p>
        <input type="checkbox" name="cFE[0][]">
        <input type="checkbox" name="cFE[0][]">
        <input type="checkbox" name="cFE[0][]">
        <input type="checkbox" name="cFE[0][]">
    </p>
    <p>
        <input type="checkbox" name="cYG[0][]">
        <input type="checkbox" name="cYG[0][]">
        <input type="checkbox" name="cYG[0][]">
        <input type="checkbox" name="cYG[0][]">
    </p>
    <a href="" class="adding">Add</a>
</div>
​

$('a.adding').live('click change', function (e) {
    e.preventDefault();
    $clone = $(this).closest('.ch').clone().insertAfter('.ch');
    $clone.find('input[type="checkbox"]:contains("0")').prop('1');
})​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:32:15.820

如果我理解正确，您想使用[`.attr()`](http://api.jquery.com/attr)回调函数：

```
$('input[type="checkbox"]').attr('name',function(i,str) {
    return str.replace('0','1');
}); 
```

更新：这是一个完整的版本，它会做你似乎真正想要的一切。它用于`str.match(/\d+/)`提取`name`属性中的第一个数字字符串，将其转换为整数，然后使用下一个整数替换它`str.replace`。请注意，该`insertAfter`部分已更新，因此仅在 LAST 之后插入`div.ch`：

```
$(document).on('click change', 'a.adding', function(e) {
    e.preventDefault();
    $div = $(this).closest('.ch');
    $clone = $div.clone().insertAfter($div);
    $clone.find('input[type="checkbox"]').attr('name', function(i, str) {
        var int = parseInt(str.match(/\d+/)[0],10);
        return str.replace(int, (int+1));
    });
});​ 
```

[http://jsfiddle.net/mblase75/3SGNw/](http://jsfiddle.net/mblase75/3SGNw/)

# java - 通过 IIOP 协议使用 Spring bean

> ID：13765060
> 
> 赞同：1
> 
> 时间：2012-12-07T14:28:49.993
> 
> 标签：java, spring, ejb

*是否可以通过 IIOP 协议使用 Spring Beans（将部署在 WebSphere 上）？*

我想创建可供同一应用程序服务器中的其他应用程序使用的 Spring Bean。所以最简单的方法是为此目的创建 EJB（EJB 可以在 IIOP 上使用），但我想用 Spring 来做。

# javascript - 更新客户端 Javascript 游戏视口

> ID：13765069
> 
> 赞同：3
> 
> 时间：2012-12-07T14:29:33.877
> 
> 标签：javascript, node.js, web-applications

我正在编写一个 3 x 3 视口的 javascript 网页游戏，类似于[Urban Dead](http://www.urbandead.com/screenshot.html)使用的。“世界地图”存储为 100 x 100 2D 数组服务器端（nodejs），每对坐标定义一个“房间”。因此，3 x 3 视口显示了 9 个房间的名称和内容。

用户的位置作为坐标存储在服务器端。例如`Bob = { x : 2, y : 3 }`。所以 Bob 的 x 坐标是`Bob.x`。客户端（浏览器）可以检索它并计算出其他 8 个房间的坐标，并向服务器询问这些房间的内容。然后将它们显示在视口中。这应该看起来像[Urban Dead](http://www.urbandead.com/screenshot.html)中的视口（左上角）。

**问题**

我应该如何考虑使视口“刷新”或更新？我正在考虑这样做...

**1)**当玩家从坐标 (2,3) 移动到 (1,3) 时。客户端再次向服务器询问 9 个房间的内容并重新绘制/显示所有内容。

**2）**当其中一个房间的内容发生变化时，服务器（nodejs）运行一个客户端函数，告诉它向服务器询问 9 个房间的内容并重新绘制/显示所有内容。

作为编程新手，我想知道这种实现是否过于幼稚或效率低下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:34:34.667

我不会担心过于幼稚或低效的解决方案。困难的部分是使游戏具有可玩性和乐趣-稍后进行优化。

查看示例，要传输的数据量看起来并不是很大。您应该能够获取完整的 9 个房间集进行更新。

您是在间隔（轮询）从服务器中提取数据，还是以某种方式将更改从服务器推送到客户端？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T14:44:18.183

问题是您是否关心通知 AFK，以及有关隔壁房间的信息有多重要。

如果您认为更新房间后策略会发生变化？在这种情况下，每次更新完成时都会更新。

如果玩家不在乎，则在传递到下一个房间时完成更改。

一种中间方式的解决方案是根据游戏每 10 秒或 30 秒请求一次“增量”更新（只是已修改的元素）。在这种情况下，我们的中央时钟可能会很有趣（多个玩家将同时更新），这创造了一个回合式的游戏玩法。

作为一个RPG玩家（纸质RPG）我会认为第三种是不错的方式。您甚至可以混合解决方案：当前房间的短时间更新和基于感知的时间（金光闪闪和聋子只会在重大事件时更新外部房间）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T14:44:48.583

前一个选项将是最好的 imo，纯粹是因为随着地图的扩展，您可以更轻松地设置触发区域，从而使您的客户端加载地图的特定区域。您甚至可以只加载他们可以看到或可以访问的房间。

这也会有好处，例如，如果您有多个字符。想象一下，您的主要角色在一个位置，而次要角色在其他位置。客户端最好知道他们在哪里，了解每个角色可以看到什么，并且只从服务器请求这些信息。这是一个比让服务器不断地向正在收听的人广播所有房间信息的解决方案更具可扩展性。

关于房间内容的变化，这可以被标记为从服务器到所有客户端的事件——但纯粹基于房间坐标和最少的数据。如果此事件涵盖客户端当前可以看到的房间之一，则该客户端可能会发生对房间信息的请求。因此，这在一定程度上涉及您的选项二，但不应过多广播。

打个比方，这更类似于让客户/用户在他们想要的时候只从网站请求他们想要的资源，并可能注册接收有关他们感兴趣的内容的邮件警报。而不是让用户注册 RSS 提要并在网站发生任何变化时收到通知。前者更优化，可以通过特定方式进行控制，后者更好，如果您的用户有兴趣浏览网站的全部内容*（这在游戏中通常不是这种情况 - 除非您设计的机器人必须作弊）*。

总的来说，在通过实施这两种方法的一部分进行讨论之后会很有用。但如果这是一个选择，第一个会给你更多的控制权。

# xml - XSL variable Xpath expression for boolean of two child elements in one select

> ID：13765071
> 
> 赞同：0
> 
> 时间：2012-12-07T14:29:42.607
> 
> 标签：xml, xslt, xml-parsing, xslt-2.0, saxon

What would be the exact XPath expression to set a variable this is in a for each of another element. So far I have variable below but I also need to know the amount is greater than 0 to stop further processing can I do this in one select?

XSL so far

```
<xsl:variable name="UM" select="LossPayment/Coverage[contains('UM',CoverageCd)]"/>
<xsl:if test="$UM">
         ....          
</xsl:if> 
```

XML

```
 <Parent>
    <LossPayment>
       <Coverage>
           <CoverageCd>TL</CoverageCd>
       </Coverage>
       <LossPaymentAmt>
               <Amt>000009500</Amt>
       </LossPaymentAmt>
    </LossPayment>
    <LossPayment>
       <Coverage>
            <CoverageCd>UM</CoverageCd>
        </Coverage>
        <LossPaymentAmt>
             <Amt>1</Amt>
       </LossPaymentAmt>
    </LossPayment>
  </Parent> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:18:50.067

这应该有效。

```
<xsl:if test="/Parent/LossPayment[Coverage/CoverageCd='UM' and LossPaymentAmt/Amt &gt; 0]">
   <!-- do whatever you want -->
</xsl:if> 
```

# java - How to use Tiles2 with Struts 1

> ID：13765077
> 
> 赞同：5
> 
> 时间：2012-12-07T14:29:58.207
> 
> 标签：java, tiles, struts-1, tiles2

Is it possible to use Tiles2 with Struts 1?

I've followed the instruction available at the migration guide [http://tiles.apache.org/migration/index.html](http://tiles.apache.org/migration/index.html)

But when I try to access my actions, I get this error:

```
org.apache.tiles.template.NoSuchAttributeException: Attribute 'body' not found. 
```

I have in struts-config.xml:

```
<controller processorClass="org.apache.struts.tiles.TilesRequestProcessor"
    maxFileSize="10M" tempDir="/tmp" />

<plug-in className="org.apache.struts.tiles.TilesPlugin">
    <set-property property="definitions-config" value="/WEB-INF/tiles-defs.xml" />
</plug-in> 
```

And tiles-defs.xml

```
 <definition name="mainTemplate" template="/common/templates/mainTemplate.jsp" />
    <definition name="index" extends="mainTemplate">
        <put-attribute name="body" type="string" value="/views/index/index.jsp"  />
    </definition> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T19:11:08.497

在您的**struts-config.xml中进行以下更改**

```
<controller processorClass=”org.apache.struts.tiles2.TilesRequestProcessor”/>
<plug-in className=”org.apache.struts.tiles2.TilesPlugin” > 
```

[在此处](http://svn.apache.org/repos/asf/struts/struts1/trunk/tiles2/)查找 Tiles2 插件的源代码。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-18T10:26:08.307

是的，它可以与 struts 一起使用 1.[检查他们的网站](http://struts.apache.org/1.x/index.html)。

将属性放入 mainTemplate 的切片文件中，例如：

```
<definition name="mainTemplate" path="/common/templates/mainTemplate.jsp">
    <put name="title"  value="Tiles Example" />
    <put name="header" value="/header.jsp" />
    <put name="menu"   value="/menu.jsp" />
    <put name="body"   value="/body.jsp" />
    <put name="footer" value="/footer.jsp" />
</definition> 
```

如果这不起作用，请尝试更改您的`struts-config.xml`喜欢：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts-config PUBLIC 
"-//Apache Software Foundation//DTD Struts Configuration 1.3//EN" 
"http://jakarta.apache.org/struts/dtds/struts-config_1_3.dtd">

<struts-config>

    <action-mappings>

        <action
            path="/User"
            type="org.apache.struts.actions.ForwardAction"
            parameter="/pages/user/user-form.jsp"/>

    </action-mappings>

    <plug-in className="org.apache.struts.tiles.TilesPlugin" >
        <set-property property="definitions-config"
        value="/WEB-INF/tiles-defs.xml"/>
    </plug-in>

</struts-config> 
```

# rest - RESTful API design and load select options

> ID：13765078
> 
> 赞同：3
> 
> 时间：2012-12-07T14:30:00.097
> 
> 标签：rest, asp.net-web-api

Let's have a form, where I have a couple of selects. I need to fill them with options provided from server.

But a RESTful API should only have methods for

*   Get
*   Post
*   Put
*   Delete

There's no place for retrieving some other data. I guess I should create these 4 method for each select options, but that seems to me like a overkill.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:34:57.977

您的表单数据列表可以相互正交，但您的表单显然必须将它们放在业务上下文中。您将 GET 或 PUT 或 POST 或 DELETE 的对象将是您的业务对象，它仅具有每个选择的属性。您可以单独获取填充您的选择的列表。

只有当您希望通过 REST 提供这些服务而不是直接维护它们（使用 SQL）时，您才能为每个列表使用 4 种方法。否则，只有 GET 就足够了。

# r - 使用 ggplot 中的 facet_wrap 将标题放在绘图的顶部和左侧

> ID：13765084
> 
> 赞同：2
> 
> 时间：2012-12-07T14:30:23.887
> 
> 标签：r, ggplot2

![在此处输入图像描述](../Images/addbfd866d8f26eed3a3f9a6920c2c84.png)df

```
Date       Team    Country   Score
1/1/2012   TeamA   Germany  10
1/2/2012   TeamA   Germany  25
1/3/2012   TeamA   Germany  50
1/1/2012   TeamB   France  10
1/2/2012   TeamB   France  70
1/3/2012   TeamB   France  50 
```

我想创建带有 ggplot 的 facet wrap graph 以具有标题，并将国家/地区放在每个图的左侧，如图所示。这对ggplot可行吗？

```
ggplot(df,aes(Date, Score, group=Team, colour=Team))+ 
        geom_point(size=0.5) + 
        geom_smooth(method="lm", se=T, size=1) + 
        facet_wrap(~Team, scale="free") 
```

## ![在此处输入图像描述](../Images/d4695fbb46376ef99ae3de5c4c5c7874.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:27:24.343

我定义

```
dat.text
   Team Country x  y
3 TeamA Germany 3 30
4 TeamB  France 3 15 
```

使用 geom_text

```
 p + geom_text(aes(x, y, label=Country, group=NULL),data=dat.text,
               angle =90,family = "mono",size=12)
    + theme(legend.position = "none") 
```

![在此处输入图像描述](../Images/916c48c1069c1707dd47e8ca2de13053.png)

想法：我使用一个包含三条信息的新数据框并将其提供给 geom_text。

ggplot 完成剩下的工作。

*   坐标 (x,y)
*   多面变量级别：团队
*   要提供的标签：国家

    要将文本放在 plot 的右侧，我选择

    ```
     dat.text$x  <- tail(originalData$Date,1) 
    ```

# c - 使用 curl_easy_setopt 时的内存泄漏

> ID：13765087
> 
> 赞同：0
> 
> 时间：2012-12-07T14:30:33.937
> 
> 标签：c, libcurl

我有以下代码：

```
CURL *curl;

void http_init()
{
    curl = curl_easy_init();
    if (!curl) return -1;
}

void http_send_message(char *msg_out, char **msg_in)
{
    CURLcode res;

    curl_easy_setopt(curl, CURLOPT_URL, "http://192.168.1.133:8080/tawtaw");
    curl_easy_setopt(curl, CURLOPT_USERNAME, "tawtaw");
    curl_easy_setopt(curl, CURLOPT_PASSWORD, "tawtaw");
    curl_easy_setopt(curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC|CURLAUTH_DIGEST);
        .
        .
        .
   curl_easy_reset(curl); 
}

void http_exit()
{
    curl_easy_cleanup(curl); 
}

int main()
{
   char *msgin=NULL;
   http_init();
   http_send_message("message number 1", &msg_in);
   free(msgin);msgin=NULL;
   http_send_message("message number 2", &msg_in);
   free(msgin);msgin=NULL;
   http_exit();
} 
```

如果我打电话

```
curl_easy_setopt(curl, CURLOPT_URL, "http://192.168.1.133:8080/tawtaw"); 
```

进而

```
curl_easy_reset(curl) 
```

进而

```
curl_easy_setopt(curl, CURLOPT_URL, "http://192.168.1.133:8080/tawtaw"); 
```

再一次，第一次分配的内存是由第二次调用还是由第二次调用`curl_easy_setopt`释放的？`curl_easy_reset(curl)``curl_easy_setopt`

还是内存没有释放，有内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:36:38.260

> 第一次分配的内存是否被第二次调用`curl_easy_setopt()`释放？`curl_easy_reset(curl)``curl_easy_setopt()`

事情是这样的：

1.  这是一个实现细节。

2.  从前面的事实来看，它不/应该不重要。任何一个都是正确的，在这两种情况下都可以进行适当的内存管理。

# caching - 如何在 ZF2 中处理缓存

> ID：13765088
> 
> 赞同：6
> 
> 时间：2012-12-07T14:30:33.967
> 
> 标签：caching, zend-framework2

我刚刚开始全神贯注于缓存。我有一个简单的 indexAction() 可以获取所有给定的数据集。我的做法是：

*   检查现有键'controllername-index-index'
*   如果存在：返回键的值
*   如果**不**存在，请执行正常操作并添加密钥

键中的值应该是将生成并填充我的数据的 ViewModel。

这是我到目前为止所做的：

```
<?php
public function indexAction()
{
    $sl = $this->getServiceLocator();
//  $cache = $sl->get('cache');
//  $key = 'kennzahlen-index-index';
//
//  if ($cache->hasItem($key)) {
//      return $cache->getItem($key);
//  }

    $viewModel = new ViewModel();
    $viewModel->setTemplate('kennzahlen/index/index');
    $entityService = $sl->get('kennzahlen_referenzwert_service');
    $viewModel->setVariable('entities', $entityService->findAll());

//  $cache->setItem($key, $viewModel);

    return $viewModel;
} 
```

出于测试目的，缓存部分被注释掉了，但基本上这就是我所做的一切。缓存配置/服务如下所示：

```
<?php
'cache' => function () {
    return \Zend\Cache\StorageFactory::factory(array(
        'adapter' => array(
            'name' => 'filesystem',
            'options' => array(
                'cache_dir' => __DIR__ . '/../../data/cache',
                'ttl' => 100
            ),
        ),
        'plugins' => array(
            array(
                'name' => 'serializer',
                'options' => array(

                )
            )
        )
    ));
}, 
```

序列化和缓存工作得很好，但我对丢失的结果感到惊讶。根据 ZendDevelopersToolbar 告诉我的内容，没有缓存的时间范围在 1.8s 到 2.5s 之间。取消注释（启用）缓存部分并没有真正改善我页面的加载时间。

所以我的问题是：这种方法完全错误吗？是否有不同的、更快速的部件可以通过一些巧妙的配置技巧来保存？

我觉得 2 秒的页面加载时间肯定太慢了。考虑到大量数据，1s 对我来说是最大值，但肯定不会超过这个：S

所有帮助/提示/建议将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-08T15:45:31.330

一种选择是缓存页面的完整输出，例如基于路由匹配。您需要在路由和调度之间侦听已找到匹配的路由，然后采取相应的行动：

```
namespace MyModule;

use Zend\Mvc\MvcEvent;

class Module
{
    public function onBootstrap(MvcEvent $e)
    {
        // A list of routes to be cached
        $routes = array('foo/bar', 'foo/baz');

        $app = $e->getApplication();
        $em  = $app->getEventManager();
        $sm  = $app->getServiceManager();

        $em->attach(MvcEvent::EVENT_ROUTE, function($e) use ($sm) {
            $route = $e->getRouteMatch()->getMatchedRouteName();
            $cache = $sm->get('cache-service');
            $key   = 'route-cache-' . $route;

            if ($cache->hasItem($key)) {
                // Handle response
                $content  = $cache->getItem($key);

                $response = $e->getResponse();
                $response->setContent($content);

                return $response;
            }
        }, -1000); // Low, then routing has happened

        $em->attach(MvcEvent::EVENT_RENDER, function($e) use ($sm, $routes) {
            $route = $e->getRouteMatch()->getMatchedRouteName();
            if (!in_array($route, $routes)) {
                return;
            }

            $response = $e->getResponse();
            $content  = $response->getContent();

            $cache = $sm->get('cache-service');
            $key   = 'route-cache-' . $route;
            $cache->setItem($key, $content);
        }, -1000); // Late, then rendering has happened
    }
} 
```

第二个侦听器检查渲染事件。如果发生这种情况，响应的结果将被缓存。

这个系统（可能不是 100% 复制/粘贴，而是概念）之所以有效，是因为如果您`Response`在路由或调度事件期间返回 a，应用程序将短路应用程序流程并停止进一步触发侦听器。然后它将按原样提供此响应。

Bear in mind it will be the complete page (including layout). If you don't want that (only the controller), move the logic to the controller. The first event (now route) will be dispatch of the controller. Listen to that early, so the normal execution of the action will be omitted. To cache the result, check the render event for the view layer to listen to.

/update: I wrote a small module to use this DRY in your app: [SlmCache](https://github.com/juriansluiman/SlmCache)

# ajax - jquery ajax loading div not working in IE & Chrome

> ID：13765096
> 
> 赞同：4
> 
> 时间：2012-12-07T14:30:51.750
> 
> 标签：ajax, jquery, loading

This has been asked many many times. But none of the solutions are working for me in IE and Chrome.

I basically want to show a loading image while ajax call is being made.

Following is what I'm trying.

```
function ws(){
    showL();
    var res=$.ajax({url:'webservice.asp?service=LoadingTestSRV',async:false,cache:false}).responseText;
    $('#dv').html(res);
    hideL();
    $('#complete').html('Done');
}
function showL()
{
    $('#loading').show();
}
function hideL()
{
    $('#loading').hide();
} 
```

Following is the HTML

```
<table cellspacing="1" cellpadding="1" border="1">
  <tr><td>
        <input type="button" value="ckick" id="btn" onClick="ws();">
        <input type="button" value="clear" onClick="$('#dv,#complete').html('');">
    </td><td>
        <div id="dv"></div>
    </td></tr><tr>
    <td>Here<div id="loading" style="display:none" >Loading.................</div></td>
    <td>final<div id="complete"></div></td></tr>
</table> 
```

After above js, I tried

*   ajaxStart and ajaxStop
*   $.ajaxSetup
*   $.ajax({...}).done(hideL)

**All the js codes I tried are working in Firefox but none of them are working in IE and Chrome.** In Firefox, the code works as expected. Loading div gets shown, ajax is called, loading div gets hidden. This is exactly what I'm expecting. In IE & Chrome, loading div doesn't show up. Maybe It's getting shown and hidden very fast after or before ajax call.

Please let me know what can be done to make the code work in IE & Chrome.

There has to be some workaround as I've seen other sites show loading div. Or maybe I'm doing something stupid.

Once the code is working in all browsers. I want to make a generic function (like a jQuery plugin) to show a loading div when ajax is being called.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T14:50:23.483

试试这个：这将确保在 ajax 调用完成后隐藏你的 DIV

```
 function ws() {
        showL();
         var res ="";
        $.ajax({
            url: 'webservice.asp?service=LoadingTestSRV',
            async: true,
            cache: false,
            success: function(data) {
                res=data;
                $('#dv').html(res);
                hideL();
                $('#complete').html('Done');

            }
        });

    }

    function showL() {
        $('#loading').show();
    }

    function hideL() {
        $('#loading').hide();
    }​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T15:07:55.633

这种形式以前对我有用：（我放慢了，所以如果它快的话你可以看到它）

```
$('#loading').ajaxStart(function() {
    $(this).show("slow");
}).ajaxComplete(function() {
    $(this).hide("slow");
}); 
```

这里的测试示例：

[http://jsfiddle.net/MarkSchultheiss/xgFkw/](http://jsfiddle.net/MarkSchultheiss/xgFkw/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-19T12:46:29.193

你的ajax调用有问题。删除`async:false`from ajax 调用，它甚至可以在 IE8/9 和 Chrome 中工作。对于其他迷失的灵魂，请进行上述更改，然后重试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T15:04:27.847

我是这样做的，如果有帮助的话试试。。

```
 $.ajax({
        beforeSend: function () {
            $('#loadingDiv').show();
            $('#accordion').hide()
        },
        complete: function () {
            $('#loadingDiv').hide();
            $('#accordion').show();
        },
        type: "GET",
        url: 
        data: shallowEncodedData,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function ( 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-03T09:14:52.213

很简单，只需在 ajax 函数中添加 async=true 即可。它将在 chrome 中工作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-10T10:08:48.013

我在 Chrome 中解决此问题的方法是在 AJAX 调用上使用一毫秒的超时。

例如

```
$("#mySpinningLoader").show();

var t = setTimeout(function () {
    $.ajax({
        url: rootPath + controllerNAction,
        async: false,
        type: "POST",
        data: JSON.stringify(lightweightObject),
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function (data, textStatus, jqXHR) {
            $("#mySpinningLoader").hide();
        }
    });
}, 1); 
```

# asp.net - 如何检查按钮是否在页面加载中单击

> ID：13765103
> 
> 赞同：0
> 
> 时间：2012-12-07T14:31:14.560
> 
> 标签：asp.net, vb.net, events, button

我有一个按钮，我不想在我的页面加载中导致这个 if 命令。

```
If Page.IsPostBack Then
        ViewState(2) = TreeView1.SelectedNode.ValuePath
        ViewState(5) = TextBox1.Text
       ''Where I would like to put another if command or whatever else is possible to check if the buttong was clicked''
        If ViewState(2) = ViewState(1) And ViewState(5) = ViewState(4) Then
            nodecount = ViewState(3)
            nodecount = nodecount + 1
            ViewState(3) = nodecount
            If nodecount > 0 Then
                MsgBox("Please select another option or different number of data points")

            End If

        Else
            nodecount = 0
            ViewState(3) = nodecount
        End If
    End If 
```

我尝试设置一个公共属性以更改是否单击按钮但 page.ispostback 被首先调用然后子调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:38:25.900

我不确定我是否完全理解你的问题。如果您尝试运行代码块，为什么不在 btnSomeButton.Click 事件中执行，为什么在 Page_Load 事件中执行。

# xslt - 将前同级中的变量与当前节点进行比较

> ID：13765104
> 
> 赞同：1
> 
> 时间：2012-12-07T14:31:24.343
> 
> 标签：xslt

我有以下模板：

```
<xsl:template match="footnote">
    <xsl:variable name = "string">
        <xsl:value-of select="."/>
    </xsl:variable>
    <xsl:variable name = "bool">
        <xsl:if test="$string = preceding-sibling::node()/$string">
            <xsl:text>false</xsl:test>
        </xsl:if>
    </xsl:variable>
    <xsl:if test="$bool != 'false'">
        <!-- DO STUFF -->
    </xsl:if>
</xsl:template> 
```

我正在尝试检查当前节点的 $string 变量并将其与所有先前的脚注节点进行检查，以查看它们是否具有相同的 $string 变量。如果它与前面的任何兄弟姐妹都不匹配，那么它应该做一些事情，否则它什么也不做。

使用我拥有的代码，即使尚未创建脚注节点，测试 "$string = previous-sibling::node()/$string" 也始终评估为 true。

谁能帮我吗？我很难创建表达式来与所有先前兄弟姐妹中的变量进行比较。

**编辑：**示例 XML：

```
<xml>
<footnote>Footnote 1</footnote>
<footnote>Footnote 2</footnote>
<footnote>Footnote 1</footnote>
<footnote>Footnote 1</footnote>
<footnore>Footnote 3</footenote>
</xml> 
```

我正在尝试将其转换为：

```
<xml>
<footnote>Footnote 1</footnote>
<footnote>Footnote 2</footnote>
<footnote>Footnore 3</footnore>
</xml 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T14:47:46.067

出色地。发布您的输出 XML 使其更加清晰！你去解决方案：

示例 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<root>
  <footnote>Matching</footnote>
  <footnote>Example1</footnote>
  <footnote>Matching</footnote>
  <footnote>Example2</footnote>
  <footnote>Example3</footnote>
</root> 
```

和 XSL：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>
  <xsl:template match="footnote[.=preceding-sibling::footnote/.]"/>
</xsl:stylesheet> 
```

结果：

```
<?xml version="1.0" encoding="utf-8"?>
<xml>
  <footnote>Matching</footnote>
  <footnote>Example1</footnote>
  <footnote>Example2</footnote>
  <footnote>Example3</footnote>
</xml> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:54:20.693

假设您想检查当前脚注的值`text()`与前一个脚注`text()'s`的唯一性，那么您只需检查`preceding-sibling::node()'s text()`：

```
<xsl:if test="$string = preceding-sibling::node()/text()"> 
```

例如

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0"
                >
    <xsl:output omit-xml-declaration="yes" method="xml" version="1.0" indent="yes" />

    <xsl:template match="/xml">
        <xml>
            <xsl:apply-templates select="footnote" />
        </xml>
    </xsl:template>

    <xsl:template match="footnote">
        <xsl:variable name = "string">
            <xsl:value-of select="./text()"/>
        </xsl:variable>
        <xsl:variable name = "bool">
            <xsl:if test="$string = preceding-sibling::node()/text()">
                <xsl:text>false</xsl:text>
            </xsl:if>
        </xsl:variable>
        <xsl:if test="$bool != 'false'">
            <xsl:copy-of select="."></xsl:copy-of>
        </xsl:if>
    </xsl:template>

</xsl:stylesheet> 
```

将输入：

```
<xml>
    <footnote>
        someVal
    </footnote>
    <footnote>
        anotherVal
    </footnote>
    <footnote>
        anotherVal
    </footnote>
    <footnote>
        newVal
    </footnote>
</xml> 
```

进入：

```
<xml>
  <footnote>
        someVal
    </footnote>
  <footnote>
        anotherVal
    </footnote>
  <footnote>
        newVal
    </footnote>
</xml> 
```

如果您的意图是识别元素中的组，您还应该查看 Muenchian 分组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T14:54:38.030

你可以使用

```
<xsl:template match="footnote[not(. = preceding-sibling::footnote)]"> 
```

创建仅针对给定脚注字符串的第一个实例触发的模板。`. = preceding-sibling::footnote`如果此节点的字符串值与其前面的*任何*兄弟节点的字符串值相同，则为真，如果与*所有*`not(....)`兄弟节点不同，则为真。

 *但是对于大型文档，这将是相当低效的（脚注元素数量的二次方）。最好使用`<xsl:for-each-group>`(XSLT 2.0) 或 Muenchian Grouping (XSLT 1.0)`footnote`按字符串值对元素进行分组，并从每个组中提取第一个元素。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:key name="fn" match="footnote" use="." />

  <!-- Ignore all but the first footnote for a given value -->
  <xsl:template match="footnote[generate-id() != generate-id(key('fn', .)[1])]" />

  <!-- copy everything else verbatim -->
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T22:49:34.710

在 XSLT 2.0 中，您有一个 distinct-values 函数：

```
<xsl:for-each select="distinct-values(footnote)">
    <footnote><xsl:value-of select="."/></footnote>
</xsl:for-each> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T15:05:25.763

```
<xsl:template match="footnote">

    <xsl:variable name = "string">
      <xsl:value-of select="./text()"/>
    </xsl:variable>
    <xsl:variable name = "bool">
      <xsl:if test="$string != preceding-sibling::node()/text()">
        <xsl:text>false</xsl:text>
    </xsl:if>
    </xsl:variable>
    <xsl:if test="$bool != 'false'">
        true
    </xsl:if>
  <xsl:if test="$bool = 'false'">
    false
  </xsl:if>
  </xsl:template> 
```*

# vb.net - 如何知道和区分 tcp Connection 发送的数据？

> ID：13765109
> 
> 赞同：0
> 
> 时间：2012-12-07T14:31:35.180
> 
> 标签：vb.net

大家好，我正在制作一个客户端-服务器软件，这是我想问的第一个问题：如何区分 tcp Connection 发送的数据？

好吧，我的观点是：-我们可以确定 tcpconnection 发送的数据。例如，我们的表单中有 3 个列表视图，第一个列表视图的点用于客户的*生物*数据。第二个listview的点是for *从客户端获取的值 n 第三个listview的点是for*从客户端获取的图片*

在这种情况下，我们有 3 个必须处理的要点。事实上，我们的系统中只有 1 个连接。

好吧，我很困惑..如何确定我们收到的数据是针对第一个列表视图还是第二个列表视图或第三个列表视图？记住，第三个listview的数据是我们从tcpconnection收到的**一张图片**

我们如何在系统中使用 1 个连接来做到这一点？我是否必须建立 3 个连接才能控制第三个列表视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:58:14.913

使用套接字通信，客户端和服务器必须使用相同的约定协议，以便它们能够相互理解。已经创建了许多标准协议，因此对于大多数任务，创建自己的协议是不必要的。但是，如果必须，您始终可以定义自己的协议。您的协议的性质显然完全取决于您的特定需求，因此不可能告诉您协议应该是什么。但是，一般来说，您的协议必须定义的第一件事是如何知道每条完整消息的开始和结束位置。这通常通过用分隔符分隔每条消息来完成（例如，换行符、EOF、null）。正如弗朗索瓦建议的那样，您也可以在每条消息的开头指定消息的长度。在每条消息中，

一个简单的实现可能是将每条消息作为 JSON 或 XML 文档发送。这样做可以很容易地定义和修改消息的格式。

但是，除非您确实需要，否则我建议使用 .NET 提供的内置通信框架之一。对于简单的任务，通常一个简单的 asmx Web 服务就足够了。对于更复杂的任务，WCF 通常是一个不错的选择。asmx Web 服务通过 TCP/IP 通过 HTTP 使用 SOAP。WCF 使用 SOAP，但较低级别的连接是可配置的，因此它不必使用 TCP/IP，但它可以很容易地做到这一点。

# iphone - 用iphone（cocoa touch）查询sql server

> ID：13765112
> 
> 赞同：1
> 
> 时间：2012-12-07T14:31:56.990
> 
> 标签：iphone, sql-server, cocoa-touch

我正在尝试使用 iphone 应用程序连接到 sql server 2000。
我检查了stackoverflow问题，但它们很旧，我找不到合适的解决方案。
我知道我可以建立一个网络服务来做到这一点，但我想避免这种情况，我将它作为最后的手段。
如果有办法（我无法发现的任何 sdk）连接到 SQL 服务器（以存储和检索数据），您是否有任何线索？

# javascript - 输出消失 Javascript 简单的 innerHTML

> ID：13765116
> 
> 赞同：7
> 
> 时间：2012-12-07T14:32:06.137
> 
> 标签：javascript, innerhtml, output

我是 javascript 的新手，在每件简单的事情上我都会遇到一些问题，但这对我来说似乎无法解决。我用谷歌搜索并没有类似的东西。

在我将数据输入文本框并将其存储到变量中后，我在段落中打印出变量。问题是我打印出来的输出在不到一秒的时间内消失了。代码似乎很正常，可能是什么？当你不放 getch(); 时，它看起来像 c 提前致谢。

```
<form>Unesite broj koji ce se ispisat kasnije.<br>
<input type="text" id="userInput">
<input type="submit" name="unos" value="Unesi i ispisi" onclick="unesi()"><br><br>

</form> 
    <br><br>
<p>Unjeli ste <b id="ispis"></b></p>
<script>
function unesi(){
var userInput = document.getElementById('userInput').value;
document.getElementById('ispis').innerHTML = userInput;
}   

</script> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T14:37:07.337

该`<form>`标签没有指定`action`属性，因此当您单击提交按钮时，浏览器会将表单提交到当前 URL - 这看起来很像页面正在刷新。

如果你想`unesi`在用户点击提交时运行该函数并阻止 HTML 表单提交，你需要稍微改变一下：

```
<input type="submit" name="unos" value="Unesi i ispisi"
      onclick="unesi(); return false;"> 
```

`return false`阻止表单提交自身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T14:36:41.247

因为表单提交并刷新页面。取消表单请求。

```
<input type="submit" name="unos" value="Unesi i ispisi" onclick="return unesi()"> 
```

和功能

```
function unesi(){
    var userInput = document.getElementById('userInput').value;
    document.getElementById('ispis').innerHTML = userInput;
    return false;
} 
```

更好的选择是在表单级别进行

```
<form action="#" method="get" onsubmit="return unesi()"> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T14:40:25.610

而不是取消表单提交，另一种选择是更改

```
<input type="submit" name="unos" value="Unesi i ispisi" onclick="unesi()"> 
```

到

```
<input type="button" name="unos" value="Unesi i ispisi" onclick="unesi()"> 
```

这将使表单在按下按钮时根本不会尝试提交。

# regex - 在 .htaccess 中操作 reg 表达式变量

> ID：13765119
> 
> 赞同：0
> 
> 时间：2012-12-07T14:32:08.510
> 
> 标签：regex, .htaccess, mod-rewrite, redirect, joomla

我想重定向客户端

`http://mydomaine/cat?start=x`

至

`http://mydomaine/cat/page-(x divide by 15)`

例如从`http://mydomaine/cat?start=30`

至

`http://mydomaine/cat/page-2`

有什么办法可以用.htaccess 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:10:58.337

谢谢大家，所以这是对我有用的解决方案：

```
if (preg_match("/(.*)\?limitstart=[0-9]+/", JRequest::getURI(), $matches)) {
    header('Status: 301 Moved Permanently', false, 301);
    header("Location: ".$matches[1]);
    exit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:51:35.110

不确定您是否可以在 .htacces 文件中执行此操作。

但是，如果您在 Joomla 下（来自您问题的标签），您可以创建一个**系统插件**，让您操作 url。

这是来自 joomla.org 文档的[文档](http://docs.joomla.org/Creating_a_System_Plugin_to_augment_JRouter)

我认为这个技巧只适用于 joomla 2.5。

# r - 如何检查r中列表元素的存在

> ID：13765121
> 
> 赞同：3
> 
> 时间：2012-12-07T14:32:15.153
> 
> 标签：r, matrix

如何检查列表元素是否存在。这是一个列表列表，例如我想检查第三个元素 l1[[3]] 是否存在。我试过 is.null(l1[["3"]]) 但它返回 false 无论它是否存在，如果我使用 is.null(l1[[3]]) 它会给出下标的错误的绑定，以防它不存在但不是 TRUE。我该怎么办

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T14:51:49.400

**tl;dr：** 如果要检查元素是否`n`存在，即使检查列表末尾或空列表，请使用：

```
length(mylist) >= n   # TRUE indicates exists. FALSE indicates DNE 
```

对于嵌套列表，请确保检查正确的列表。例如：

```
 length(outerlist[[innerlist]]) >= n 
```

* * *

R 中列表中的 NULL 与其他语言中使用的 NULL 有一些不同。例如，如果我们将列表中的元素替换为 NULL，则所有后续元素都将被移动，并且列表的长度会少一。

```
# SAMPLE DATA
mylist <- as.list(LETTERS[1:5])

    [[1]]
    [1] "A"

    [[2]]
    [1] "B"

    [[3]]
    [1] "C"

    [[4]]
    [1] "D"

    [[5]]
    [1] "E" 
```

在元素 3 和 6 中测试 NULL。不是我们正在寻找的信息。

```
is.null(mylist[[3]])
# FALSE

is.null(mylist[[6]])
# Error in mylist[[6]] : subscript out of bounds 
```

相反，我们检查列表的长度：

```
length(mylist) >= 3  # TRUE
length(mylist) >= 5  # TRUE
length(mylist) >= 6  # FALSE 
```

删除第三个元素。请注意，“空槽”**没有**保留。（即元素 4，变为元素 3，等等。）

```
mylist[[3]] <- NULL

  [[1]]
  [1] "A"

  [[2]]
  [1] "B"

  [[3]]
  [1] "D"

  [[4]]
  [1] "E"

length(mylist) >= 3  # TRUE
length(mylist) >= 5  # FALSE
length(mylist) >= 6  # FALSE 
```

### 空列表的长度为 0

```
emptyList <- list()
length(emptyList)  # 0

nestedList <- list( letters=list("A", "B", "C"), empty=list(), words=list("Hello", "World"))

length(nestedList)
  # [1] 3
lapply(nestedList, length)
  # $letters
  # [1] 3
  #
  # $empty
  # [1] 0
  #
  # $words
  # [1] 2 
```

* * *

请注意，您**可以将**NULL 合并到列表中。这是适用于 NULL 测试的时候。例如：

```
myListWithNull <- list("A", "B", NULL, "D")

is.null(myListWithNull[[3]])
  # TRUE

length(myListWithNull) >= 3
  # TRUE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-12T16:30:50.147

一旦条件为假，if 中的语句评估就会停止，您可以使用以下方法可靠地检查元素是否为空：

```
if(length(l1)<n || is.null(l1[[n]]){ # TRUE only if not NULL
} 
```

或者，您可以使用命名列表

```
is.null(l1[["a"]]) 
```

行为独立于列表的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-26T02:09:25.347

正如我在[此处](https://stackoverflow.com/a/50538644/8785542)发布的那样，可以检查元素本身的长度以检查 NULL 值，而不是检查整个列表的长度。据我所知，除 NULL 之外的所有值的长度都大于 0。

```
x <- list(4, -1, NULL, NA, Inf, -Inf, NaN, T, x = 0, y = "", z = c(1,2,3))
lapply(x, function(el) print(length(el)))
[1] 1
[1] 1
[1] 0
[1] 1
[1] 1
[1] 1
[1] 1
[1] 1
[1] 1
[1] 1
[1] 3 
```

因此，我们可以创建一个简单的函数，可以同时使用命名索引和编号索引：

```
element.exists <- function(var, element)
{
  tryCatch({
    if(length(var[[element]]) > -1)
      return(T)
  }, error = function(e) {
    return(F)
  })
} 
```

如果该元素不存在，则会导致 tryCatch 块捕获的越界条件。

# android - Android 模拟器向 logcat 发送垃圾邮件，内容为“Service com.android.exchange.ExchangeService has leaked ServiceConnection ... that original bound here

> ID：13765122
> 
> 赞同：45
> 
> 时间：2012-12-07T14:32:22.950
> 
> 标签：android, logcat

我正在开发一个非常简单的 Android 应用程序。我制作了一个启动画面、主菜单和一个带有单选按钮和一个按钮的页面（根据选中的单选按钮播放声音）。该应用程序工作正常（不会崩溃），但我一直在 logcat 中遇到所有这些错误（我使用模拟器运行应用程序）。那会是什么？我该如何解决？我应该担心吗？当有人询问时，我会另外发布代码，因为我不知道问题可能出在哪里，而且我不想无缘无故地将所有 .java 和 xml 文件发布到垃圾邮件中。

logcat 中的错误：

```
 12-07 14:24:28.301: E/ActivityThread(587): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d0c8d8 that was originally bound here
12-07 14:24:28.301: E/ActivityThread(587): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d0c8d8 that was originally bound here
12-07 14:24:28.301: E/ActivityThread(587):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-07 14:24:28.301: E/ActivityThread(587):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-07 14:24:28.301: E/ActivityThread(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-07 14:24:28.301: E/ActivityThread(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-07 14:24:28.301: E/ActivityThread(587):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.emailcommon.service.AccountServiceProxy.getDeviceId(AccountServiceProxy.java:116)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.exchange.ExchangeService.getDeviceId(ExchangeService.java:1249)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1856)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-07 14:24:28.301: E/ActivityThread(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-07 14:24:28.301: E/ActivityThread(587):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-07 14:24:28.301: E/ActivityThread(587):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-07 14:24:28.301: E/ActivityThread(587):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-07 14:24:28.301: E/ActivityThread(587):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-07 14:24:28.301: E/ActivityThread(587):  at java.lang.Thread.run(Thread.java:856)
12-07 14:24:28.312: E/StrictMode(587): null
12-07 14:24:28.312: E/StrictMode(587): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d0c8d8 that was originally bound here
12-07 14:24:28.312: E/StrictMode(587):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-07 14:24:28.312: E/StrictMode(587):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-07 14:24:28.312: E/StrictMode(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-07 14:24:28.312: E/StrictMode(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-07 14:24:28.312: E/StrictMode(587):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.emailcommon.service.AccountServiceProxy.getDeviceId(AccountServiceProxy.java:116)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.exchange.ExchangeService.getDeviceId(ExchangeService.java:1249)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1856)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-07 14:24:28.312: E/StrictMode(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-07 14:24:28.312: E/StrictMode(587):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-07 14:24:28.312: E/StrictMode(587):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-07 14:24:28.312: E/StrictMode(587):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-07 14:24:28.312: E/StrictMode(587):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-07 14:24:28.312: E/StrictMode(587):  at java.lang.Thread.run(Thread.java:856)
12-07 14:24:28.312: W/ActivityManager(273): Unbind failed: could not find connection for android.os.BinderProxy@40f409d8
12-07 14:24:28.322: E/ActivityThread(587): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d5ed58 that was originally bound here
12-07 14:24:28.322: E/ActivityThread(587): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d5ed58 that was originally bound here
12-07 14:24:28.322: E/ActivityThread(587):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-07 14:24:28.322: E/ActivityThread(587):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-07 14:24:28.322: E/ActivityThread(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-07 14:24:28.322: E/ActivityThread(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-07 14:24:28.322: E/ActivityThread(587):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-07 14:24:28.322: E/ActivityThread(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-07 14:24:28.322: E/ActivityThread(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-07 14:24:28.322: E/ActivityThread(587):  at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
12-07 14:24:28.322: E/ActivityThread(587):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
12-07 14:24:28.322: E/ActivityThread(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-07 14:24:28.322: E/ActivityThread(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-07 14:24:28.322: E/ActivityThread(587):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-07 14:24:28.322: E/ActivityThread(587):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-07 14:24:28.322: E/ActivityThread(587):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-07 14:24:28.322: E/ActivityThread(587):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-07 14:24:28.322: E/ActivityThread(587):  at java.lang.Thread.run(Thread.java:856)
12-07 14:24:28.341: E/StrictMode(587): null
12-07 14:24:28.341: E/StrictMode(587): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d5ed58 that was originally bound here
12-07 14:24:28.341: E/StrictMode(587):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-07 14:24:28.341: E/StrictMode(587):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-07 14:24:28.341: E/StrictMode(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-07 14:24:28.341: E/StrictMode(587):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-07 14:24:28.341: E/StrictMode(587):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-07 14:24:28.341: E/StrictMode(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-07 14:24:28.341: E/StrictMode(587):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-07 14:24:28.341: E/StrictMode(587):  at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
12-07 14:24:28.341: E/StrictMode(587):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
12-07 14:24:28.341: E/StrictMode(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-07 14:24:28.341: E/StrictMode(587):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-07 14:24:28.341: E/StrictMode(587):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-07 14:24:28.341: E/StrictMode(587):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-07 14:24:28.341: E/StrictMode(587):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-07 14:24:28.341: E/StrictMode(587):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-07 14:24:28.341: E/StrictMode(587):  at java.lang.Thread.run(Thread.java:856) 
```

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-01-29T20:57:04.387

一个更简单的解决方法是在设置下的模拟设备中禁用“交换服务”：应用程序：全部

（您可能需要滑动才能看到“全部”选项卡）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-07T22:21:11.903

在我删除这个当前的模拟器设备之前，没有任何帮助。之后，我设置了一个全新的虚拟设备。我的新模拟器设备没有所有这些错误。这解决了我的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-06T21:46:51.930

在围绕这个错误搜索 60 分钟后，我发现我只是有一个无限循环，导致这个交换服务垃圾邮件直到应用程序关闭。把这个留在这里，以防其他人想太多

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-16T12:32:23.303

就我而言，有效的是**关闭**防火墙（我使用 Windows 8 机器和最新的 Android SDK，4.2）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-30T04:41:25.043

这可能是模拟器中的误导性错误消息。

我很困惑，直到我连接了一个实际的设备，它在同一点崩溃，而是抱怨缺少使用权限。添加使用权限解决了这个问题。

这不会是所有用户的问题根源，但可能是某些用户的问题。

# php - Magento：重新索引后所有产品突然缺货

> ID：13765123
> 
> 赞同：4
> 
> 时间：2012-12-07T14:32:26.697
> 
> 标签：php, magento

我有一个 Magento 网站，其中包含大约 500 种产品，在过去的一年中，我曾几次看到它们突然莫名其妙地缺货。我相信这发生在我们重新索引了一些索引（从 shell）之后。

我运行了一个完整的重新索引程序，股票恢复正常。

但是该站点仍有一段“停机时间”，这是不可取的。

谁能解释为什么会发生这种情况，以及我能做些什么来避免它？此外，理想情况下，我应该多久重新索引一次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:22:06.960

我们每天凌晨 3 点使用 cronjob 在 shell 文件夹中使用 indexer.php 重新建立索引，而不会更改数据库。如果我们要更改项目/类别。等我们将在所有更改完成后重新索引。

# python - 如何在python的扩展类中使用dbus导出方法，继承方法？

> ID：13765124
> 
> 赞同：0
> 
> 时间：2012-12-07T14:32:27.370
> 
> 标签：python, ubuntu, pygtk, dbus

我有一个顶级类和扩展顶级类的类，但是子类的几乎所有方法都来自顶级类（使用继承，没有重新实现），所以我没有子类中的方法，我怎么能为每个子类使用 dbus 导出它们（每个子类的名称作为 dbus 路径的一部分）？

我将显示一个示例代码以进行澄清，我的类结构是：

```
Window (main class)
  |--WindowOne (child class)
  |--WindowTwo
  |--WindowThree 
```

我的 dbus 接口是`com.example.MyInterface`，我想使用 : 访问每个子类`com.example.MyInterface.WindowOne`，并且对于每个子类，我想访问方法，包括从主类继承的方法，例如`com.example.MyInterface.WindowOne.show`和`com.example.MyInterface.WindowOne.destroy`。

在这段代码中，我用'Window'类扩展了子类'WindowOne'，'Window'中的方法`show()`和`destroy()`'WindowOne'没有重新实现，但是在这段代码中我把方法放在了`show()`解释问题的地方，我让代码工作的方式是这样的，我在子类中重新声明了该方法`show()`，但这似乎很糟糕。

最大的问题可能是：有一些方法可以使用装饰器：`@dbus.service.method('com.example.MyInterface.WindowOne')`对于类（在这种情况下是子类）？

测试源代码：

```
# interface imports
from gi.repository import Gtk

# dbus imports  
import dbus
import dbus.service
from dbus.mainloop.glib import DBusGMainLoop

# Main window class
class Window(dbus.service.Object):
    def __init__(self, gladeFilePath, name):
        # ... inicialization
        self.name = name
        self.busName = dbus.service.BusName('com.example.MyInterface.', bus=dbus.SessionBus())
        dbus.service.Object.__init__(self, self.busName, '/com/example/MyInterface/' + self.name)

    def show(self):
        self.window.show_all()

    def destroy(self):
        Gtk.main_quit()

# Child window class
class WindowOne(Window):
    def __init__(self, gladeFilePath):
        Window.__init__(self, gladeFilePath, "WindowOne")

    @dbus.service.method('com.example.MyInterface.WindowOne')
    def show(self):
        self.window.show_all()

if __name__ == "__main__":
    DBusGMainLoop(set_as_default=True)

    gladeFilePath = "/etc/interface.glade"
    windowOne = WindowOne(gladeFilePath)

    Gtk.main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T13:05:20.587

经过一些实验，我意识到了一些我以前在文档中没有找到的重要内容：**导出方法的路径不需要与导出对象的路径相同！**澄清：如果方法没有在子类（`WindowOne`）中重新实现，我不需要在子类中使用导出它`@dbus.service.method('com.example.MyInterface.WindowOne')`，例如，我只需在主类中导出方法（`Window`）使用：`@dbus.service.method('com.example.MyInterface.Window')`

所以我只需要在导出顶级类的方法时使用一个固定的路径`Window`，见下面的固定代码。

```
# interface imports
from gi.repository import Gtk

# dbus imports  
import dbus
import dbus.service
from dbus.mainloop.glib import DBusGMainLoop

# Main window class
class Window(dbus.service.Object):
    def __init__(self, gladeFilePath, name):
        # ... inicialization
        self.name = name
        self.busName = dbus.service.BusName('com.example.MyInterface.', bus=dbus.SessionBus())
        dbus.service.Object.__init__(self, self.busName, '/com/example/MyInterface/' + self.name)

    @dbus.service.method('com.example.MyInterface.Window')
    def show(self):
        self.window.show_all()

    @dbus.service.method('com.example.MyInterface.Window')
    def destroy(self):
        Gtk.main_quit()

    @dbus.service.method('com.example.MyInterface.Window')
    def update(self, data):
        # top class 'update' method

# Child window class
class WindowOne(Window):
    def __init__(self, gladeFilePath):
        Window.__init__(self, gladeFilePath, "WindowOne")

    @dbus.service.method('com.example.MyInterface.WindowOne')
    def update(self, data):
        # reimplementation of top class 'update' method

if __name__ == "__main__":
    DBusGMainLoop(set_as_default=True)

    gladeFilePath = "/etc/interface.glade"
    windowOne = WindowOne(gladeFilePath)

    Gtk.main() 
```

在调用总线方法的代码中，我只是使用如下：

```
bus = dbus.SessionBus()
dbusWindowOne = bus.get_object('com.example.MyInterface', '/com/example/MyInterface/WindowOne')
showWindowOne = dbusWindowOne.get_dbus_method('show', 'com.example.MyInterface.Window')
updateWindowOne = dbusWindowOne.get_dbus_method('update', 'com.example.MyInterface.WindowOne') 
```

该方法`show`在顶级类中调用，但在作为子类`Window`的对象中执行。`WindowOne`

并且该方法`update`在子类中被调用`WindowOne`，因为它正在重新实现顶级类方法。

# java - WebDriver + TestNG - 如何处理测试结果

> ID：13765125
> 
> 赞同：4
> 
> 时间：2012-12-07T14:32:28.787
> 
> 标签：java, selenium, webdriver, testng, selenium-webdriver

我对 WebDriver 和 TestNG 框架很陌生。我从一个对电子商务网站进行回归测试的项目开始。我完成了登录和注册等。但是有一点我不太明白。

例如，我有一个搜索产品的简单代码。

```
driver.get(url + "/k/k.aspx");
driver.findElement(By.id("q")).clear();
driver.findElement(By.id("q")).sendKeys("xxxx"); //TODO: Make this dynamic
driver.findElement(By.cssSelector("input.submit")).click(); 
```

现在我想检查页面上是否表示 xxxx。这可以通过

```
webdriver.findElement(By.cssSelector("BODY")).getText().matches("^[\\s\\S]*xxxxxx[\\s\\S]*$") 
```

我将它存储在一个布尔值中并检查它的真假。

现在问题来了，基于这个布尔值我想说测试结果是成功还是失败。我怎样才能做到这一点？什么会触发 testNG 测试失败？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T14:45:26.837

TestNG 或任何其他测试工具根据断言决定测试的成功或失败。

```
Assert.assertEquals(actualVal, expectedVal); 
```

因此，如果**actualVal**和**expectedVal**相同，则测试将通过，否则将失败。

同样，如果您使用任何 IDE（如 Eclipse），您会发现其他断言选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T14:55:42.710

如果您想根据对该文本值的验证来停止测试执行，那么您可以使用 Asserts。但是，如果您想将测试结果记录为失败并继续，您应该尝试使用软断言，它将验证记录为通过或失败并继续测试。最新的 Testng 可以处理这个问题 - [Cedric 博客上的信息](http://beust.com/weblog/2012/07/29/reinventing-assertions/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:38:30.513

在 if 条件失败的地方编写此代码

```
throw new RuntimeException("XXXX not found: "); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T10:17:13.557

你可以使用 throw 异常，每个调用这个方法的方法也应该在方法名称之后抛出 Excetion 或者你可以使用 try catch。样本：

```
protected Boolean AssertIsCorrectURL(String exedctedURL) throws Exception {

String errMsg = String.format("Actual URL page: '%s'. Expected URL page: '%s'",
this.driver.getCurrentUrl(), exedctedURL);
throw new Exception(errMsg);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-13T03:36:27.423

你可以这样做。

布尔结果 = webdriver.findElement(By.cssSelector("BODY")).getText().matches("^[\s\S] *xxxxxx[\s\S]* $") Assert.assertTrue(result);

# android - DialogFragment 相对于 AlertDialog 的优势

> ID：13765127
> 
> 赞同：71
> 
> 时间：2012-12-07T14:32:35.340
> 
> 标签：android, android-alertdialog, android-dialogfragment, dialogfragment

在开发 Android 应用程序时，我读到建议使用`DialogFragment`而不是直接使用 an`AlertDialog`来显示警报和确认。

例如，这是在 DialogFragment 的文档中完成的：http: [//developer.android.com/reference/android/app/DialogFragment.html](http://developer.android.com/reference/android/app/DialogFragment.html)

人们还说他们更喜欢这里： [Android DialogFragment vs Dialog](https://stackoverflow.com/questions/7977392/android-dialogfragment-vs-dialog)

我想知道这种方法的优点，因为代码变得更加复杂。

谢谢

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2016-02-04T23:07:09.500

这很简单。
DialogFragment 是一个片段。那么片段可以为您提供什么，而其他对象却不能呢？
这是生命周期回调。
因此使用 DialogFragment，它可以非常强大，并使您的代码更加简洁。
如果您在 Activity 被销毁时没有关闭对话框，您是否见过窗口泄漏？所以为了防止这种情况，你有没有试过在 onPause() 被调用时关闭对话框？因此，要做到这一点，您是否曾经必须将该对话框引用到类级别对象？
使用 DialogFragment，这一切都得到了处理。
你会得到所有的生命周期回调。
然后你可以为对话框提供更多的智能，让它自己做一些聪明的工作，而不是 Activity 告诉它做什么。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-12-07T14:49:04.057

## **在 Dialog 上使用 DialogFragment：**

* * *

*   **自 API 级别 13 引入以来**：

    Activity 中的[showDialog](http://developer.android.com/reference/android/app/Activity.html#showDialog%28int,%20android.os.Bundle%29)方法已*弃用*。不建议在代码的其他地方调用对话框，因为您必须自己管理对话框（例如方向更改）。不使用 showDialog 会导致偶尔的异常，对话框没有链接到任何 Activity。

    关于 showDialog 的注意事项：

    > 对话框的引用：活动提供了一种工具来管理对话框的创建、保存和恢复。请参见 onCreateDialog(int)、onPrepareDialog(int, Dialog)、showDialog(int) 和dismissDialog(int)。如果使用这些方法，getOwnerActivity() 将返回管理此对话框的 Activity。

*   **DialogFragment 和 AlertDialog 的区别**

    阅读您的问题时想到的一件事。他们有那么大的不同吗？DialogFragment与[Dialog](http://developer.android.com/reference/android/app/DialogFragment.html)非常相似，只是包装在一个片段中。来自有关 DialogFragment 的 Android 参考：

    > DialogFragment 是一个显示对话窗口的片段，浮动在其活动窗口的顶部。该片段包含一个 Dialog 对象，它会根据片段的状态适当地显示该对象。对话框的控制（决定何时显示、隐藏、关闭它）应该通过[这里](http://developer.android.com/reference/android/app/DialogFragment.html)的 API 来完成，而不是直接调用对话框。

*   **其他注意事项**

    *   由于具有不同屏幕尺寸的设备的多样性，片段是 Android 框架中的自然演变。
    *   DialogFragments 和 Fragments 在支持库中可用，这使得该类可用于所有当前使用的 Android 版本。

# c# - 如何解决 Microsoft 报表查看器中的数据源错误？

> ID：13765129
> 
> 赞同：0
> 
> 时间：2012-12-07T14:32:34.453
> 
> 标签：c#, sql, windows, rdlc

我在我的 Windows 项目中有报告页面。其中包括*microsoftReportViewer*。在该页面中，有两个组合框。第一个组合框中的项目是：

1.  公司详情
2.  奇蒂控股
3.  贷款详情。

对应选择combobox1中的这个项目，combobox中的项目会改变。我需要根据2个combbox中的这个值报告。

我的代码就像

```
if (cbReprt.Text == "FirmDetails")
        {

            if (cbGeneral.Text == "AllFirmDetails")
            {
                reportViewer1.RefreshReport();
                SqlConnection con = new SqlConnection("Data Source=202.88.231.102;Initial Catalog=dbs_Merchant;Persist Security Info=True;User ID=sa;Password=abc123*");
                con.Open();
                allfirmdetails ds = new allfirmdetails();
                string str = "Select * from View_2";
                SqlCommand cmd = new SqlCommand(str, con);
                SqlDataAdapter da = new SqlDataAdapter(cmd);
                da.Fill(ds);
                DataTable dt = new DataTable();
                da.Fill(dt);
                reportViewer1.ProcessingMode = Microsoft.Reporting.WinForms.ProcessingMode.Local;
                reportViewer1.LocalReport.ReportPath = "F:\\MerchantAssociation\\MerchantAssociation\\Report7.rdlc";
                reportViewer1.LocalReport.DataSources.Clear();
                reportViewer1.LocalReport.DataSources.Add(new Microsoft.Reporting.WinForms.ReportDataSource("allfirmdetails_View_2", dt));
                reportViewer1.RefreshReport();
            }

            else
            {
                reportViewer1.RefreshReport();
                SqlConnection con = new SqlConnection("Data Source=202.88.231.102;Initial Catalog=dbs_Merchant;Persist Security Info=True;User ID=sa;Password=abc123*");
                con.Open();
                allfirmdetails ds1 = new allfirmdetails();
                string str1 = "Select * from View_2 where FirmName='" + cbGeneral.Text + "'";
                SqlCommand cmd1 = new SqlCommand(str1, con);
                SqlDataAdapter da1 = new SqlDataAdapter(cmd1);
                da1.Fill(ds1);
                DataTable dt1 = new DataTable();
                da1.Fill(dt1);
                reportViewer1.ProcessingMode = Microsoft.Reporting.WinForms.ProcessingMode.Local;
                reportViewer1.LocalReport.ReportPath = "F:\\MerchantAssociation\\MerchantAssociation\\firmwise.rdlc";
                reportViewer1.LocalReport.DataSources.Clear();
                reportViewer1.LocalReport.DataSources.Add(new Microsoft.Reporting.WinForms.ReportDataSource("allfirmdetails_View_2", dt1));
                reportViewer1.RefreshReport();

            }
        }
        else if (cbReprt.Text == "ChittyDetails")
        {
            if (cbGeneral.Text == "AllChittyDetails")
            {
                reportViewer1.RefreshReport();
                SqlConnection con = new SqlConnection("Data Source=202.88.231.102;Initial Catalog=dbs_Merchant;Persist Security Info=True;User ID=sa;Password=abc123*");
                con.Open();
                ChittyDetails ds2 = new ChittyDetails();
                string str2 = "Select * from View_1";
                SqlCommand cmd2 = new SqlCommand(str2, con);
                SqlDataAdapter da2 = new SqlDataAdapter(cmd2);
                da2.Fill(ds2);
                DataTable dt2 = new DataTable();
                da2.Fill(dt2);
                reportViewer1.ProcessingMode = Microsoft.Reporting.WinForms.ProcessingMode.Local;
                reportViewer1.LocalReport.ReportPath = "F:\\MerchantAssociation\\MerchantAssociation\\allchitty.rdlc";
                reportViewer1.LocalReport.DataSources.Clear();
                reportViewer1.LocalReport.DataSources.Add(new Microsoft.Reporting.WinForms.ReportDataSource("ChittyDetails_View_1", dt2));
                reportViewer1.RefreshReport();
            } 
```

首先，我选择 chittyholding 详细信息。然后我拿到了报告。然后我选择 chitty details report，我得到了类似的错误 `**An error occured during local report processing .A data sourcr instance has not been supplied for the data source "ChittyHolding_View_7"**`。如果我关闭并再次运行该项目，那么该坚定详细信息选择将起作用。但另一个将不起作用。这意味着只有一个选择我才能获得报告。为什么？请解决这个错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:29:05.140

尝试调用`reportViewer1.Reset();`而不是`reportViewer1.Refresh();`在每个条件的开头

# jquery-ui - CakePhP jquery 调试模态对话框数据流

> ID：13765130
> 
> 赞同：0
> 
> 时间：2012-12-07T14:32:36.217
> 
> 标签：jquery-ui, modal-dialog, cakephp-2.1

我有一个相当大的应用程序，有时用户创建了相当复杂的数据（在通往数据库的路上，数据被改变了很多）。问题是，每当我需要更改代码时，我都会卡住好几个小时才能找到问题。

**我的应用程序中的操作：**

1.  用户打开 jquery 模式对话框
2.  模态对话框中有一个表单
3.  用户提醒数据并保存

**关于应用：**

1.  该应用程序包含一个带有表格和几个按钮的站点
2.  这些按钮中的每一个都会打开一个不同的模式对话框
3.  每个表单提交都是通过 ajax -> cakephps this->js->submit 处理的

我是如何编写代码的：

1.  对于每个模态对话框，我创建了一个[元素](http://book.cakephp.org/2.0/en/views.html#elements)
2.  单击按钮后，我将元素作为[jquery 模式对话框打开](http://jqueryui.com/dialog/#modal-form)
3.  许多这些模式通过例如“单击/双击等”事件获取信息。

**我的问题：**

每次我更改 $this->Js->submit 调用的 cakephp 代码时，我都想把枪对准我的脸并扣动扳机。

我不知道如何在这些函数中调试变量的任何简单方法（cakephps 调试不显示任何 ofc -> 那些 ajax/php 函数的视图不在主站点中）

不知道firebug是否有任何调试php的功能，但我不知道。

唯一对我有用的是注释掉代码行并在这样的成功中发出警报，有时可能会达到值，但感觉不对。

当我使用如此现代的编程语言并试图猜测错误可能在哪里时，习惯于用 c++/java 编写代码并使用断点打印或调试让我感到沮丧。

**大多数错误：**

主要是空指针或检查 !isset 正在访问的索引，但由于我不知道从模态打印这些错误的方法，所以对索引的检查对我有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T09:49:22.503

使用[FirePHP](http://www.firephp.org/)是对 firebug 的极大增强。效果很好。

# sql - 规范化逻辑层次结构的度量之和

> ID：13765131
> 
> 赞同：3
> 
> 时间：2012-12-07T14:32:41.770
> 
> 标签：sql, recursion, teradata

假设有一个下表Table1，描述了父子关系和度量：

```
Parent | Child | Metric (of a child)
------------------------------------
name0 | name1 | a  
name0 | name2 | b  
name1 | name3 | c  
name2 | name4 | d  
name2 | name5 | e  
name3 | name6 | f 
```

特点：
1）孩子总是只有1个父母；
2）Parent可以有多个children（name2有name4和name5作为children）；
3）这个“层次结构”中的级别数和任何给定父级的子级数是任意的，并且不相互依赖；

我需要 SQL 请求，该请求将返回结果集，其中包含每个名称及其 **所有后代的度量总和，直至底层加上自身**，因此对于此示例表，结果将是（仔细查看**name1**）：

```
Name | Metric
------------------
name1 | a + c + f  
name2 | b + d + e  
name3 | c + f  
name4 | d  
name5 | e  
name6 | f 
```

（name0 无关紧要，可以排除）。

它应该是 ANSI 或 Teradata SQL。

我得到了一个递归查询，它可以返回给定名称的所有后代的 SUM（度量）：

```
WITH RECURSIVE temp_table (Child, metric) AS
(  
   SELECT root.Child, root.metric  
   FROM table1 root  
   WHERE root.Child = 'name1'  
   UNION ALL  
   SELECT indirect.Child, indirect.metric  
   FROM temp_table direct, table1 indirect  
   WHERE direct.Child = indirect.Parent
)  
SELECT SUM(metric) FROM temp_table; 
```

有没有办法把这个查询变成一个以 name 作为参数并返回这个总和的函数，所以它可以这样调用？

```
SELECT Sum_Of_Descendants (Child) FROM Table1; 
```

任何关于如何从不同角度解决此问题的建议也将不胜感激，因为即使上述方式是可实施的，它的性能也会很差 - 读取指标会有很多迭代（值 f 将被读取 3本例中的次数）。理想情况下，查询应该只读取每个名称的度量一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T22:15:25.993

**编辑：**此答案适用于支持公用表表达式的 SQL Server 2005 及更高版本。`teradata`我第一次回答问题时没有注意标签。希望这个答案仍然相关，因为语法似乎几乎相同。

这可以在 SQL Server 中通过将每个级别的层次结构扩展为

```
with recursive temp_table (RootValue, Child, Metric)
as 
(select
    root.Child, root.Child, root.Metric
from table1 root
union all
select
    direct.RootValue, indirect.Child, indirect.Metric
from temp_table direct join table1 indirect on indirect.Parent = direct.Child
)
select
    RootValue, SUM(Metric)
from temp_table
group by RootValue; 
```

（公用表表达式）CTE 定义除了 Child 和 Metric 之外还有一个 RootValue 列。CTE 递归地关联给定 RootValue 的 Child & Metric 值。

鉴于此 CTE，所需的输出只是对 RootValue 列进行聚合的问题。

# javascript - 通过正则表达式仅检查整数值

> ID：13765134
> 
> 赞同：1
> 
> 时间：2012-12-07T14:33:01.423
> 
> 标签：javascript, regex

我的代码：

我尝试了以下代码

```
<SCRIPT type="text/javascript"> 

var num = "10";
var expRegex = /^\d+$/;

if(expRegex.test(num)) 
{
   alert('Integer');
}
else
{
   alert('Not an Integer');
}

</SCRIPT> 
```

我得到的结果为`Integer`。实际上我`num`用双引号声明了变量。显然它被认为是一个`string`. 实际上我需要得到结果为`Not an Integer`. 如何更改，`RegEx`以便我可以获得预期的结果。

在这种情况下，它的结果应该是`Not an Integer`。但我越来越像`Integer`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T14:35:38.057

```
if(typeof num === "number" &&
   Math.floor(num) === num)
    alert('Integer');
else
    alert('Not an Integer'); 
```

正则表达式可用于处理字符串。因此，如果您尝试使用字符串以外的其他内容，则该字符串要么被转换，要么您会收到错误。而你的返回 true，因为显然字符串只包含数字字符（这就是你要检查的）。

请改用`typeof`运算符。但是 JavaScript 没有专门的`int`和类型`float`。所以你必须自己做整数检查。如果`floor`不改变值，那么你有一个整数。

还有一个警告。`Infinity`是 a`number`并且调用`Math.floor()`它会`Infinity`再次导致，所以你会得到一个误报。你可以这样改变：

```
if(typeof num === "number" &&
   isFinite(num) &&
   Math.floor(num) === num)
    ... 
```

看到您的正则表达式，您可能只想接受正整数：

```
if(typeof num === "number" &&
   isFinite(num) &&
   Math.floor(Math.abs(num)) === num)
    ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:46:20.857

RegExp 用于字符串。您可以检查，`typeof num == 'number'`但您需要对浮点数等执行多次检查。您还可以使用一个小的按位运算符来检查整数：

```
function isInt(num) {
    num = Math.abs(num); // if you want to allow negative (thx buettner)
    return num >>> 0 == num;
}

isInt(10.1) // false
isInt("10") // false
isInt(10)   // true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:39:05.027

我认为使用 isNaN() 更容易。

```
if(!isNaN(num))
{
    alert('Integer !');
}
else
{
    alert('Not an Integer !');
} 
```

莱昂

# android - 在 Android NumberPicker 上更改布局

> ID：13765138
> 
> 赞同：0
> 
> 时间：2012-12-07T14:33:18.227
> 
> 标签：android, android-layout, android-widget

有没有办法改变Android上两条水平线的颜色`NumberPicker`？

![](../Images/bc0ce738f18de7bc699f3856ed11841b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:55:57.627

也许这会让你开始：

[http://devmobapps.blogspot.com/2011/09/numberpicker-use-and-customization-of.html](http://devmobapps.blogspot.com/2011/09/numberpicker-use-and-customization-of.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-21T16:11:43.703

# 解决方案 1

如果您只关心更改 NumberPicker 的颜色，[这里](https://stackoverflow.com/questions/24233556/changing-numberpicker-divider-color)是一个非常简单的解决方案，它使用以下内容。

```
private void setDividerColor(NumberPicker picker, int color) {

    java.lang.reflect.Field[] pickerFields = NumberPicker.class.getDeclaredFields();
    for (java.lang.reflect.Field pf : pickerFields) {
        if (pf.getName().equals("mSelectionDivider")) {
            pf.setAccessible(true);
            try {
                ColorDrawable colorDrawable = new ColorDrawable(color);
                pf.set(picker, colorDrawable);
            } catch (IllegalArgumentException e) {
                e.printStackTrace();
            } catch (Resources.NotFoundException e) {
                e.printStackTrace();
            }
            catch (IllegalAccessException e) {
                e.printStackTrace();
            }
            break;
        }
    }
} 
```

然后像这样调用函数

```
setDividerColor(mNumberPicker, Color.GREEN); 
```

# 解决方案 2

虽然第一个解决方案很简单，但它是有限的。我建议使用[这个](https://github.com/StephenVinouze/MaterialNumberPicker)提供 MaterialNumberPickers 的存储库，它允许更大的自定义。有关于如何在 repo 的自述文件中添加 Gradle 依赖项的说明，因此我不会在此处包含它们，但随后可以将 MaterialNumberPickers 添加到 xml 中，如下所示。

```
<com.github.stephenvinouze.materialnumberpickercore.MaterialNumberPicker
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:mnpMaxValue="50"
    app:mnpMinValue="1"
    app:mnpEditable="false"
    app:mnpFontname="Hand.ttf"
    app:mnpSeparatorColor="@color/colorAccent"
    app:mnpTextColor="@color/colorPrimary"
    app:mnpTextSize="16sp"
    app:mnpTextStyle="bold"
    app:mnpValue="10"
    app:mnpWrapped="false" /> 
```

此外，MaterialNumberPicker 扩展了 NumberPicker，因此在 xml 中进行此更改不需要对 .java 文件进行任何后端更改。

# javascript - 如何监视使用 Jasmine 扩展外部库的 Marionette 视图

> ID：13765143
> 
> 赞同：0
> 
> 时间：2012-12-07T14:33:37.523
> 
> 标签：javascript, testing, bdd, jasmine, marionette

我有一个观点，他扩展了一个外部库（我们称之为 ExtLib），它也基于骨干木偶。基本上，这个库是共享行为的通用视图的包装器（例如，DetailsView、FormView 等）。所以，假设我有这样的事情：

```
MyApp.module('Views', function(Views, App, Backbone, Marionette, $, _) {

    Views.MyDetailsView = Marionette.ExtLib.DetailsView.extend({
        options: {
            fields: [
                // ...
            ],
            myFunction: function() {
                // ...
            }
        }
    });    
}); 
```

在我的 Jasmine 测试中，我调用了一个创建 MyDetailsView 实例的控制器方法。

```
it('does what it should', function() {
    // ...

    controller.showDetails();

    // my expectations
}); 
```

实际上，控制器中的方法只是创建视图并将其渲染（到布局的区域中）。

```
showDetails: function(story) {
    var container = new App.Layouts.DetailsLayout();
    var myDetailsView = new App.Views.MyDetailsView({
        model: story
    });

    container.details.show(storyDetailsView);
} 
```

最后，这是我得到的错误：

```
TypeError: Cannot read property 'length' of undefined
at eval (eval at <anonymous> (http://localhost:8080/myapp/js/lib/underscore/underscore-min.js?_debugResources=y&n=1354890505115:30:350), <anonymous>:17:35)
at c (http://localhost:8080/myapp/js/lib/underscore/underscore-min.js?_debugResources=y&n=1354890505115:30:430)
at Object.Backbone.Marionette.Renderer.render (http://localhost:8080/myapp/js/backbone-app/conf/renderer.js?_debugResources=y&n=1354890505115:9:17)
at r.ItemView.r.View.extend.render (http://localhost:8080/myapp/js/lib/backbone/backbone.marionette.min.js?_debugResources=y&n=1354890505115:13:4719)
at  Backbone.Marionette.ExtLib.ExtLib.DetailsView.Backbone.Marionette.View.extend.renderFieldView (http://localhost:8080/myapp/js/lib/backbone.marionette.extlib.min.js?_debugResources=y&n=1354890505115:395:14)
// etc... 
```

我认为问题在于 jasmine 不知道 ExtLib。如何监视该 renderFieldView 以避免错误？

预先感谢，一如既往。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:12:55.657

> 我认为问题在于 jasmine 不知道 ExtLib。

我无法从堆栈跟踪中判断您的诊断是否正确；但要验证这一点，您可以在 Jasmine 跑步者上查看源代码，并查看 ExtLib 是否包含在跑步者的页面中。

如果*不*包括 ExtLib，则修复取决于您运行 Jasmine 的方式。如果您使用 Jasmine gem 并且您有一个 jasmine.yml 文件，您需要编辑 jasmine.yml 以包含 ExtLib。如果您有一个“简单”的配置，并且您正在手动维护 Jasmine 包含的 Javascript 文件，那么您需要添加一行以将 ExtLib 包含在运行程序的源文件中。

# r - 如何在R中创建矩阵列表

> ID：13765144
> 
> 赞同：17
> 
> 时间：2012-12-07T14:33:39.753
> 
> 标签：r, list, matrix

我想创建一个二维矩阵列表

```
> x
     [,1] [,2]
[1,]    1    6
[2,]    2    7
[3,]    3    8
[4,]    4    9
[5,]    5   10

> y
     [,1] [,2]
[1,]  301  306
[2,]  302  307
[3,]  303  308
[4,]  304  309
[5,]  305  310

> MATS<-c(x,y)

> MATS[1]
[1] 1 
```

我希望能够引用 MATS[1]，就好像它在哪里 x...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-07T14:42:23.823

尝试

```
x <- matrix(1:10, ncol=2)
y <- x+300

MATS <- list(x, y) # use 'list' instead of 'c' to create a list of matrices
MATS
[[1]]
     [,1] [,2]
[1,]    1    6
[2,]    2    7
[3,]    3    8
[4,]    4    9
[5,]    5   10

[[2]]
     [,1] [,2]
[1,]  301  306
[2,]  302  307
[3,]  303  308
[4,]  304  309
[5,]  305  310 
```

在这里您必须像引用`MATS[[1]]`一样`x`

如果您想将新矩阵附加到现有列表中，请尝试

```
z <- x+500
MATS[[3]] <- z  # appeding a new matrix to the existing list
MATS

[[1]]
     [,1] [,2]
[1,]    1    6
[2,]    2    7
[3,]    3    8
[4,]    4    9
[5,]    5   10

[[2]]
     [,1] [,2]
[1,]  301  306
[2,]  302  307
[3,]  303  308
[4,]  304  309
[5,]  305  310

[[3]]
     [,1] [,2]
[1,]  501  506
[2,]  502  507
[3,]  503  508
[4,]  504  509
[5,]  505  510 
```

这种方法的一个缺点是你必须知道你必须在列表中添加新矩阵的位置，如果你不知道它或者你不想要这种方法，那么这里有一个技巧：

```
unlist(list(MATS, list(z)), recursive=FALSE) # will give u the same list :D 
```

# visual-studio - 将 ASP.NET 项目从 TFS 移动到 GITHUB。打开项目说它绑定到 tfs 服务器上的源代码控制：

> ID：13765146
> 
> 赞同：0
> 
> 时间：2012-12-07T14:33:47.710
> 
> 标签：visual-studio, git, tfs, github, visual-studio-2012

我使用 git-tfs 将我的项目从 tfs 移动到 github，现在当我打开项目时，它会给出一条消息，说明它处于 TFS 服务器版本控制之下。

消息说

```
Team Foundation Server Version Control

The solution you are opening is bound to source control on the following Team 
Foundation Server: http://tfs:8080/tfs/defaultcollection.  
Would you like to contact this server to try to enable source control integration. 
```

我真的很想自己删除它，打开项目的任何其他人都不会收到此消息。

tfs 和 github 中的代码仍然是相同的，如果这样可以更轻松地重做提取 -> 推送到 github 过程。或者更好的是，我可以尝试修改一些文件或在 UI 中进行更改吗？

我看到一个建议转到文件 -> 源代码控制 -> 高级 -> 更改源代码控制，但所有内容都列为当前未连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:03:26.570

清除此问题的硬而快速的方法是删除解决方案文件中的 TFS 绑定。

在文本编辑器（记事本、notepad++ 等）中打开解决方案文件并查找 GlobalSection entitled `GlobalSection(TeamFoundationVersionControl)`。

删除这整个部分 - 即从`GlobalSection(TeamFoundationVersionControl)`下一次第一次出现的所有内容`EndGlobalSection`- 并保存解决方案文件。

一旦它被传播（即提交到 GitHub 并且每个人都取消了更改），您和任何其他打开解决方案的人都不应再看到 TFS 消息。

# c# - 创建 WintRT XAML 控件：带有在鼠标悬停时向上滑动的文本面板的图像

> ID：13765147
> 
> 赞同：0
> 
> 时间：2012-12-07T14:33:49.897
> 
> 标签：c#, windows-8, winrt-xaml

我需要创建一个小的 xaml 控件（用于 Windows 8 应用程序/WintRT） 这个控件是一个简单的按钮，它围绕一个图像，在图像底部有一个文本块。当用户将鼠标移到按钮上时，文本块应该被隐藏并向上滑动，如下图所示：

[![样本图片](../Images/a1c74782d4cce0efd87c79c7b163e364.png)](https://i.stack.imgur.com/pjIvt.jpg)
[（来源：[skynet.be](http://users.skynet.be/fc471815/xaml-control.jpg)）]

我有按钮、图像和文本块，但我不知道如何隐藏文本块并在鼠标悬停时向上滑动。

有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:44:00.990

将按钮的 ControlTemplate 替换为图像和文本块。使用 VisualStateManager 和悬停状态为 TextBlock 设置动画。

这可能会有所帮助： [XAML 中的简单悬停效果？](https://stackoverflow.com/questions/11160715/simple-hover-effect-in-xaml)

# android - 为什么 Marquee 在小部件中不起作用？

> ID：13765150
> 
> 赞同：4
> 
> 时间：2012-12-07T14:33:58.087
> 
> 标签：android, string, android-widget, textview, marquee

我是 android 的菜鸟，我正在尝试创建一个小部件，它使用 textview marquee 以自动收报机方式显示推文。当我在 xml 中设置文本时，选取框在小部件中正确滚动。但是，当我尝试以编程方式设置文本时，选取框不会滚动。文本已设置，但它只是不滚动。这种行为令人费解，因为我使用[这个](https://stackoverflow.com/questions/7868748/is-it-possible-for-textview-marquee-in-a-widget-that-extends-appwidgetprovider)SO 问题作为我的指导。任何帮助是极大的赞赏。

我的布局

```
<TextView
        android:id="@+id/ticker"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:duplicateParentState="true"
        android:ellipsize="marquee"
        android:fadingEdge="horizontal"
        android:focusable="true"
        android:focusableInTouchMode="true"
        android:lines="1"
        android:marqueeRepeatLimit="marquee_forever"
        android:scrollHorizontally="true"
        android:text="Simple application that shows how to use marquee, with a long text for Twitter Feed" > //<--this text scrolls fine

        <requestFocus
            android:duplicateParentState="true"
            android:focusable="true"
            android:focusableInTouchMode="true" />
    </TextView> 
```

我的代码

```
public static void updateAppWidget(Context context, AppWidgetManager appWidgetManager, int appWidgetId) {
    //String currentTime =  df.format(new Date());
    String spotgold = String.valueOf(MyActivity.widgetlivespotgold);
    String spotsilver =  String.valueOf(MyActivity.widgetlivespotsilver);
    StringBuilder tickertweets=new StringBuilder();
    for (int i = 0; i < MyActivity.twittername.size(); i++) {
        tickertweets.append(MyActivity.twittername.get(i) + ":" + " " + MyActivityActivity.twittertweet.get(i) + " ");
    }

    RemoteViews updateViews = new RemoteViews(context.getPackageName(), R.layout.widget1);

    updateViews.setTextViewText(R.id.goldspot, spotgold);
    updateViews.setTextViewText(R.id.silverspot, spotsilver);
    updateViews.setTextViewText(R.id.ticker, tickertweets.toString()); //Text is set, but doesn't scroll    
    appWidgetManager.updateAppWidget(appWidgetId, updateViews);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:16:26.340

我想这是以下问题：

该方法`setText(CharSequence)`正在重置 MarqueeRepeatLimit。Method`setText(CharSequence)`是`RemotableViewMethod`，这意味着您不能从 RemoteView 访问它。`setMarqueeRepeatLimit()`没有这个特殊的注释。我看不出，如何设置文本并将选取框状态保持在 RemoteView 中。也许`SetText`TextView 的方法对你有一点帮助

```
private void setText(CharSequence text, BufferType type,
                     boolean notifyBefore, int oldlen) {
    if (text == null) {
        text = "";
    }

    if (!mUserSetTextScaleX) mTextPaint.setTextScaleX(1.0f);

    if (text instanceof Spanned &&
        ((Spanned) text).getSpanStart(TextUtils.TruncateAt.MARQUEE) >= 0) {
        setHorizontalFadingEdgeEnabled(true);
        setEllipsize(TextUtils.TruncateAt.MARQUEE);
    }

    int n = mFilters.length;
    for (int i = 0; i < n; i++) {
        CharSequence out = mFilters[i].filter(text, 0, text.length(),
                                              EMPTY_SPANNED, 0, 0);
        if (out != null) {
            text = out;
        }
    }

    if (notifyBefore) {
        if (mText != null) {
            oldlen = mText.length();
            sendBeforeTextChanged(mText, 0, oldlen, text.length());
        } else {
            sendBeforeTextChanged("", 0, 0, text.length());
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T16:21:19.767

确保在您的 XML 中使用`android:singleLine="true"`和`android:scrollHorizontally="false"`（或完全删除它）。这应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-01T17:44:21.447

这可能对你有用

在您的布局中：

```
<TextView
android:id="@+id/TextView03"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:marqueeRepeatLimit="marquee_forever"
android:text=""/> 
```

在您的代码中：

```
TextView textView = (TextView)findViewById(R.id.TextView03);
textView.setText(";lkjdf;alkdsfjoiawejrokajdsl;fkadmnsflkamndvklahoreiuaweifjakldsmflkhfgoueyhtoaijpkjdflkahndsofuhyoeia");
textView.setHorizontallyScrolling(true);
textView.setEllipsize(TextUtils.TruncateAt.MARQUEE);
textView.setSingleLine();
textView.setSelected(true); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T09:31:11.950

尝试这个。在设置文本之前设置选取框跨度。

```
SpannableString buffer = new SpannableString(tickertweets.toString());
buffer.setSpan(TextUtils.TruncateAt.MARQUEE,0, (tickertweets.length() -1) ,Spannable.SPAN_INCLUSIVE_INCLUSIVE);
updateViews.setTextViewText(R.id.ticker, buffer); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-21T16:39:42.400

您可以使用此代码在 textView 中滚动文本：

```
textView.setEllipsize(TextUtils.TruncateAt.MARQUEE);
        textView.setSingleLine();
        textView.setMarqueeRepeatLimit(10);
        textView.setFocusable(true);
        textView.setHorizontallyScrolling(true);
        textView.setFocusableInTouchMode(true);
        textView.requestFocus(); 
```

# haskell - 为什么 X 库报告错误的字符串长度值？

> ID：13765154
> 
> 赞同：1
> 
> 时间：2012-12-07T14:34:08.647
> 
> 标签：haskell, x11, xlib, xorg

我试图获取字符串的宽度，使用`XTextWidth()`函数，但由于某种原因，返回的值总是大于字符串的实际显示长度。在以下示例中，打印出的值为`196`，而如果我测量屏幕上的宽度，则它在`168`像素附近（以下是可编译和可运行的示例）：

```
import Control.Concurrent
import qualified Graphics.X11.Xlib as X
import qualified Graphics.X11.Xlib.Types as Xt
import qualified Graphics.X11.Types as Xt

main = do
  display <- X.openDisplay ""
  let dflt = X.defaultScreen display
      border = X.blackPixel display dflt
      background = X.whitePixel display dflt
  rootw <- X.rootWindow display dflt
  win <- X.createSimpleWindow display rootw 0 0 500 300 1 border background
  X.mapWindow display win
  X.moveWindow display win 0 0

  updateScreen display win

updateScreen display win = do
  gc <- X.createGC display win
  bgcolor <- initColor display "white"
  fgcolor <- initColor display "black"
  X.setBackground display gc bgcolor
  X.setForeground display gc fgcolor

  font <- X.loadQueryFont display "-misc-fixed-*-*-*-*-14-*-*-*-*-*-*"
  let str = "Some reasonably long string."
      len = X.textWidth font str
  putStrLn $ show len
  X.drawImageString display win gc 0 50 str

  X.freeFont display font
  X.freeGC display gc
  threadDelay 100000
  updateScreen display win

initColor :: X.Display -> String -> IO X.Pixel
initColor dpy color = do
  let colormap = X.defaultColormap dpy (X.defaultScreen dpy)
  (apros,_) <- X.allocNamedColor dpy colormap color
  return $ X.color_pixel apros 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:56:11.950

您没有使用所选字体显示。试试这个：

```
X.setFont display gc $ X.fontFromFontStruct font 
```

# ssas - SSAS 每日计算汇总到任何维度

> ID：13765155
> 
> 赞同：2
> 
> 时间：2012-12-07T14:34:08.900
> 
> 标签：ssas, mdx, cube

我试图在我的 Cube 或 MDX 语句中创建每日计算，该语句将每天进行计算并汇总到任何维度。我已经能够成功地取回这些值，但是性能并不是我认为的那样。

我的事实表将有 4 个维度，其中 1 是每日日期（时间）。我有一个公式，在这个事实表中使用了 4 个其他度量，这些度量需要每天计算，然后在时间维度上进行几何链接。

下面的 MDX 语句效果很好，并产生了正确的值，但速度很慢。我尝试过使用 exp(sum(log+1))-1 和 multiply 似乎表现更好但不够好。此解决方案是否有另一种方法，或者我的 MDX 语句有问题？

我尝试为 [Calendar_Date] 和 [Dim_Y].[Y ID] 定义聚合，但它似乎没有使用这些聚合。

```
WITH
   MEMBER Measures.MyCustomCalc AS (
   (
      Measures.x -Measures.y
    ) -
    (
      Measures.z - Measures.j
    )
)
/
Measures.x

MEMBER Measures.LinkedCalc AS ASSP.MULTIPLY(
   [Dim_Date].[Calendar Date].Members,
   Measures.MyCustomCalc + 1
) - 1
SELECT
Measures.LinkedCalc ON Columns,
[Dim_Y].[Y ID].Members ON Rows
FROM
[My DB] 
```

上面的查询需要 7 秒才能运行，记录数如下：

度量：98,160 条记录 Dim_Date：5,479 条记录 Dim_Y：42 条记录

我们假设通过定义一个聚合，我们将执行的计算量仅为 42 * 天数，在本例中最多为 5479 条记录。

任何帮助或建议将不胜感激！

# iphone - 如何以编程方式设置导航栏的位置

> ID：13765156
> 
> 赞同：0
> 
> 时间：2012-12-07T14:34:14.873
> 
> 标签：iphone, ios, uinavigationbar

如何以编程方式设置导航栏的位置？Autolay 已被关闭，因为它会导致其他 IOS 出现问题。干杯，伙计们。

[我的布局]

```
View Controller
   View
     Toolbar
     WebView
     Navigation Bar
      Nav Item
   First Responder
   Exit 
```

导航栏当前出现在屏幕底部，而不是我想要的顶部。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:43:51.097

尝试这个

`[self.navigationController.navigationBar setFrame:CGRectMake(x,y,width,height)];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T09:59:59.450

如果您使用的是 Interface Builder，您只需将导航栏拖到您想要的位置

# mobile - dojo 选择小部件的移动替代品

> ID：13765157
> 
> 赞同：3
> 
> 时间：2012-12-07T14:34:18.443
> 
> 标签：mobile, dojo, dojox.mobile

我正在使用 dojo mobile 开发一个移动应用程序。我需要类似于 dijit.form.Select 的功能但是我无法找到相同的移动设备。

如果这样的小部件没有现成的可用，有什么方法可以使用 dojo 移动模块实现所需的功能。

# jquery - jQuery AJAX 拉取后更新 URL

> ID：13765160
> 
> 赞同：2
> 
> 时间：2012-12-07T14:34:31.813
> 
> 标签：jquery, html, ajax, url

我有一个名为 index.html 的网页，它通过 jQuery load() 方法连接到其他页面（portfolio.php、friendzone.php 等）。

示例：我的菜单有以下代码：

```
<a href="./" class="button"><div id="homepageBtn"></div></a>
<a onclick="showPage('progressi')" class="button"><div id="progressiBtn"></div></a>
<a onclick="showPage('interessi')" class="button"><div id="interessiBtn"></div></a>
<a onclick="showPage('friendzone')" class="button"><div id="friendzoneBtn"></div></a>
<a onclick="showPage('contact')" class="button"><div id="emailBtn"></div></a> 
```

当我单击不是主页选项的内容时，将调用 showPage() 函数：

```
function showPage(page) {
    $("#post-title").fadeOut (200, function() {
        $("#post-title").html(page); // Edit the page title in the div
        Cufon.refresh(); // I use Cufon plugin, so I reload it
    }).fadeIn(500);

    $("#post-content").fadeOut (200, function() {
        $("#post-content").load(page + ".php", function() { // If I pass for example "contact", it loads me the page contact.php in the "post-content" div
            $('a.boxed').colorbox({rel: 'Galleria'}); // I use colorbox jQuery plugin, so I reload it here
            $('a.iframe').colorbox({iframe: true, width: "80%", height: "80%"}); // Same here

        });
    }).fadeIn(500);
} 
```

一切都完美无缺，除了一件事：

当我在我的 div 中加载另一个页面内容时，URL 不会改变。我认为这对于 Google 爬虫和想要通过单击浏览器的后退按钮或共享指向我网站特定页面的链接来进入上一页的用户来说是非常糟糕的。

有什么方法可以根据我在 div 中加载的内容实现不同的 URL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:39:04.683

您可以在不更改实际页面 url 的情况下修改浏览器 url，但我认为这不会影响爬虫。您将需要为机器人生成站点地图。设置一个谷歌网站管理员帐户并在那里提交您的站点地图。

[使用新 URL 更新地址栏而不使用哈希或重新加载页面](https://stackoverflow.com/questions/3338642/updating-address-bar-with-new-url-without-hash-or-reloading-the-page)

```
window.history.pushState("object or string", "Title", "/new-url"); 
```

为什么不使用 get 变量创建一个重定向到主页的 share.php？例如，在每个页面上都有一个链接到 index.php?page=friendzone 的“分享”按钮

当有人加载共享链接时，它将包含类似这样的内容。将它放在您的`<head>`标签中。

```
<? 
//Include this right before your end </head>.
if(isset($_GET['page']))
{
    ?>
    <script>
    $(function() {
        showPage('<? echo htmlentities($_GET['page']); ?>');
    });
    </script>
    <?
}
?> 
```

在您的 showPage 中，您可以执行以下操作：

```
if ( history.pushState ) history.pushState( {}, page, "/?page="+page ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T08:31:34.020

试试下面的代码它的工作。

```
 $.ajax
         ({
           type: "POST",
            url: 'Services/MyService.asmx/returnString2',
       dataType: "json",
           data: JSON.stringify({ fname: "yan" , lname: "key" }),
    contentType: "application/json; charset=utf-8",
          error: function (jqXHR, textStatus, errorThrown)   //what to do if fails
                 {
                   window.history.pushState("object or string", "Title", "/new-url");
                 },
        success: function (data)           //what to do if succedded
                 {
                   window.history.pushState("object or string", "Title", "/new-url");
                 } 
```

});

# c - C支持基础类吗？

> ID：13765162
> 
> 赞同：-1
> 
> 时间：2012-12-07T14:34:33.037
> 
> 标签：c, class

> **可能重复：**
> [你能用 C 编写面向对象的代码吗？](https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c)

C 是否支持没有多态性、继承等的简单类？

我只需要定义类和方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T14:37:14.253

C 本身没有类概念。

但是，可以实现类似的东西：

```
struct stuff {
    void (*do_it)(void);
    void (*close)(void);
};

struct stuff new(void) {
    struct stuff ret;
    ret.do_it = ...;
    ret.close = ...;
    return ret;
}

int main() {
    struct stuff s = new();
    s.do_it();
    s.close();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T14:35:52.163

您可以使用结构并在其中存储函数指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T14:36:03.973

C不是面向对象的。所以不行。但它支持[结构](http://en.wikipedia.org/wiki/Struct_%28C_programming_language%29)

# wpf - 如何（全局）禁用 FocusVisualStyleKey

> ID：13765167
> 
> 赞同：1
> 
> 时间：2012-12-07T14:34:52.653
> 
> 标签：wpf, styles, focus, focusvisualstyle

我想（全局）禁用 FocusVisualStyleKey。

我正在寻找一种可能性，即我没有在以下代码中添加任何元素：

```
<Style TargetType="ToggleButton">
    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
</Style> 
```

所以我读了这篇[文章](http://msdn.microsoft.com/en-us/library/bb613567.aspx)，找到了这个解决方案：

**应用程序.xaml**

```
<Application x:Class="WpfApplication7.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <Style x:Key="{x:Static SystemParameters.FocusVisualStyleKey}">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle StrokeThickness="0" SnapsToDevicePixels="true" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Application.Resources>
</Application> 
```

**主窗口.xaml**

```
<Window x:Class="WpfApplication7.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
    </Window.Resources>
    <Grid>
        <Button Content="Button" HorizontalAlignment="Left" Margin="98,230,0,0" VerticalAlignment="Top" Width="75"/>
        <Button Content="Button" HorizontalAlignment="Left" Margin="217,230,0,0" VerticalAlignment="Top" Width="75"/>
        <Button Content="Button" HorizontalAlignment="Left" Margin="368,230,0,0" VerticalAlignment="Top" Width="75"/>
        <ComboBox HorizontalAlignment="Left" Margin="40,40,0,0" VerticalAlignment="Top" Width="150" Height="40"/>
        <ComboBox HorizontalAlignment="Left" Margin="317,40,0,0" VerticalAlignment="Top" Width="150" Height="40"/>
    </Grid>
</Window> 
```

但它不起作用......有人有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T06:05:11.990

是的，有一种方法可以做到这一点，但你不会喜欢它。首先制作另一个 xaml 字典。在其中为您使用的 Aero 或 w/e 主题中的每个控件定义一个样式，然后将 BasedOn 属性设置为隐式键。

例子

```
<Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}"> 
```

然后为 FocusVisualStyle 创建一个设置器

```
<Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
</Style> 
```

注意：您必须为每个控件执行此操作。

接下来将您的新主题字典合并到 Window.Resources

```
<Window.Resources>
    <ResourceDictionary Source="[your dictionary]"/>
</Window.Resources> 
```

# vb.net - 如何正确使用 GetRowCount 方法和多个运行时生成的 datagridview 控件？

> ID：13765169
> 
> 赞同：0
> 
> 时间：2012-12-07T14:34:58.240
> 
> 标签：vb.net, datagridview, datagridviewrow

我有多个运行时生成的 datagridview 控件，我希望能够查看用户是否在特定的 datagridview 中选择了多行。由于某种原因，以下的结果始终为零。当我 F9 停止程序时，我可以看到这个 datagridview 行的选定值是 false。任何想法如何解决这一问题？

我的代码如下：

```
strDGVName = "dgvCheckpoint" & intTimeModificationSender

For Each tbp As TabPage In frmTimingP2P.tabctrlTimingTable.Controls
    For Each dgv In tbp.Controls
        If dgv.Name = strDGVName Then
            intSelectedRowCount = dgv.Rows.GetRowCount(DataGridViewElementStates.Selected)
        End If
    Next
Next 
```

谢谢

我现在尝试了以下方法：

```
For Each tbp As TabPage In frmTimingP2P.tabctrlTimingTable.Controls
    For Each ctrl As Control In tbp.Controls
        Dim dgv As DataGridView = TryCast(ctrl, DataGridView)
        If Not dgv Is Nothing Then
            If dgv.Name = strDGVName Then
                intSelectedRowCount = dgv.SelectedRows.Count
            End If
        End If
    Next
Next 
```

也：

```
Dim c As Collections.Generic.IEnumerable(Of DataGridView)
For p = 0 To frmTimingP2P.tabctrlTimingTable.TabCount - 1
    c = frmTimingP2P.tabctrlTimingTable.TabPages(p).Controls.OfType(Of DataGridView)()
    If c(0).Name = strDGVName Then p = frmTimingP2P.tabctrlTimingTable.TabCount
    End If
Next
intSelectedRowCount = c(0).SelectedRows.Count 
```

但它仍然返回零行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:57:27.127

这应该是您正在寻找的：

```
dgv.SelectedRows.Count 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:28:48.813

好的，所以解决方案如下：

两个都：

```
For Each tbp As TabPage In frmTimingP2P.tabctrlTimingTable.Controls
    For Each ctrl As Control In tbp.Controls
        Dim dgv As DataGridView = TryCast(ctrl, DataGridView)
        If Not dgv Is Nothing Then
            If dgv.Name = strDGVName Then
                intSelectedRowCount = dgv.SelectedRows.Count
            End If
        End If
    Next
Next 
```

和：

```
Dim c As Collections.Generic.IEnumerable(Of DataGridView)
For p = 0 To frmTimingP2P.tabctrlTimingTable.TabCount - 1
    c = frmTimingP2P.tabctrlTimingTable.TabPages(p).Controls.OfType(Of DataGridView)()
    If c(0).Name = strDGVName Then p = frmTimingP2P.tabctrlTimingTable.TabCount
Next
intSelectedRowCount = c(0).SelectedRows.Count 
```

Work as they should. The problem was that in my runtime generated DataGridView controls, I did not set the SelectionMode Method to FullRowSelect, and I was selecting individual cells, which do not count as "Rows".

Thanks for your help!

# sql - Sybase ASE 15 中左连接和 *= 的区别

> ID：13765173
> 
> 赞同：4
> 
> 时间：2012-12-07T14:35:15.793
> 
> 标签：sql, left-join, sap-ase

我需要帮助来理解这件事，下面的 2 个查询有什么区别，我只知道它们不会返回相同的结果。

**查询一：**

```
SELECT a.col1, b.c1
  FROM A a
  LEFT JOIN B b
    ON a.col1 = b.c1
 WHERE b.status = 'Y' 
```

**查询 2：**

```
SELECT a.col1, b.c1
  FROM A a, B b
 WHERE a.col1 *= b.c1
   AND b.status = 'Y' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T15:09:59.537

第一个查询：

```
SELECT
       a.col1, b.c1 
FROM 
       a LEFT JOIN b ON a.col1 = b.c1 
WHERE
       b.status = 'Y' ; 
```

等价于内连接，因为`b.status`列（从左外连接的右侧开始）在`WHERE`部分中使用：

```
SELECT
       a.col1, b.c1 
FROM 
       a INNER JOIN b ON a.col1 = b.c1 
WHERE
       b.status = 'Y' ; 
```

* * *

第二个查询（可能）执行为：

```
SELECT
       a.col1, b.c1 
FROM 
       a LEFT JOIN b ON a.col1 = b.c1 
                    AND b.status = 'Y' ; 
```

这可能会给出不同的结果，因为它是（逻辑上）不同的查询。

这就是你永远不应该使用这种旧语法的原因之一。有时它是模棱两可的，例如当有多个条件或多个外部连接时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T18:42:29.480

我知道 Sybase 和 SQL Server 密切相关。`*=`已从 SQL Server 中删除，但即使早在 SQL Server 2000 中，它也无法正常工作，有时解释为左连接，有时解释为交叉连接。由于 Sybase 和 SQL Server 来自同一个基础产品，我怀疑这也是您的问题以及结果不同的原因。不要将隐式连接用于外连接，因为它不能可靠地给出正确答案。

这是 SQL Server 2000 联机丛书中讨论此问题的直接引述：

> 在 Microsoft® SQL Server™ 2000 的早期版本中，左外连接和右外连接条件是在使用 and运算符的`WHERE`子句中指定的。在某些情况下，这种语法会导致不明确的查询，可以用多种方式解释。子句中指定了符合 SQL-92 的外部连接，不会导致这种歧义。`*=``=*``FROM`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T18:17:28.190

抱歉有点晚了，但我找到了解决方案：在旧语法`*=`中，条件`b.Status = 'Y'`将在左连接 on 子句中，所以在第一个查询中必须得到相同的结果，我只是将`b.Status = 'Y'`“on”子句移到.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T14:57:40.453

这些查询看起来相同。你说他们不返回相同的结果。你有一个例子吗？

新旧连接符号的不同之处在于，您是否将连接位置移到了哪里

```
Select
  a.col1, 
  b.c1
From
  A
    Left Join
  B 
    On a.col1 = b.c1 And b.Status = 'Y'; 
```

这是不同的，不能用旧的表示法这么容易地表示（至少不是在 Oracle 中，没有直接的 Sybase 经验）

[示例](http://sqlfiddle.com/#!4/0e7fd/4)（尽管 Oracle 使用`(+)`而不是`*=`）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-16T17:08:57.763

当涉及超过 2 个包含许多 where 子句的表时，我试图找到旧查询到新查询的转换，但在网上的任何地方都找不到它，因此在此处发布我的解决方案。如果您遵循以下技巧，结果将完全匹配：

在以下查询的情况下：

```
 select a.*
    from A a, B b, C c
    where a.server_id=0
    and a.name = 'John'
    and a.country_id*=b.value_cd
    and b.table_nm = 'Employee'
    and b.Attribute_nm ='A_nm'
    and a.state_id*= c.value_cd
    and c.table_nm = 'Company' 
```

除了第一个表（即表 A）之外的所有 where 条件都可以进入连接中的 on 子句，但是第一个表的 Where 条件应保留在 Where 子句中，如下面的查询：

```
 select a.*
    from A a
    left join B b on a.country_id = b.value_cd 
       and b.table_nm = 'Employee' 
       and b.Attribute_nm ='A_nm'
    left join C c on a.state_id = c.value_cd 
       and c.table_nm = 'Company' 
    where a.server_id=0
       and a.name = 'John' 
```

# safari-extension - visibleContentsAsDataURL 的奇怪行为

> ID：13765174
> 
> 赞同：0
> 
> 时间：2012-12-07T14:35:18.263
> 
> 标签：safari-extension

为了拍摄页面快照，我使用了 Safari 扩展 API（基于[Snapper Safari 扩展](http://blog.starplace.org/snapper-simple-snapping-safari-extension)）中的 visibleContentsAsDataURL() 方法。

奇怪的是，该方法只获取页面顶部的快照。

我正在使用事件机制来滚动页面并拍摄几个快照，然后将它们组合起来。生成的图像反复出现在页面顶部...

有人知道这个问题吗？对 visibleContentsAsDataURL() 有任何限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-23T08:56:23.510

偶然我想出了这个问题的解决方案：

```
var dataUrl = safari.application.activeBrowserWindow.activeTab.visibleContentsAsDataURL();
if(dataUrl){
    callback(dataUrl);
} else {
    safari.application.activeBrowserWindow.activeTab.visibleContentsAsDataURL(callback);
} 
```

不要问为什么以及如何，但它确实有效。Safari 或扩展文档中的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T01:03:38.980

这是 Safari 中的一个已知错误。我和其他人一样已经提交了一个问题，但他们还没有解决它。您应该向 Apple 提出问题以提高优先级。

# c# - 如何在 Facebook C# SDK 6.0.10 中使用 FacebookOAuthResult() 方法

> ID：13765175
> 
> 赞同：0
> 
> 时间：2012-12-07T14:35:22.080
> 
> 标签：c#, url, c#-4.0, facebook-c#-sdk

朋友们，我有一些问题。我第一次使用 Facebook C# SDK 6.0.10.0，我这样做是为了将我的桌面应用程序与 facebook 连接起来。我使用了以下代码...

```
public partial class FacebookLogin : Form
{
    Uri login_url;
    String redirect_url;
    private FacebookOAuthResult fbAOuthResult;

    public FacebookLogin()
    {
        InitializeComponent();
        fbAOuthResult = new FacebookOAuthResult();
        login_url = new Uri("https://www.facebook.com/dialog/oauth?client_id=" + ConfigurationManager.AppSettings["AppID"] + "&redirect_uri=https://www.facebook.com/connect/login_success.html&scope=user_photos,friends_photos,publish_stream&display=popup&response_type=token");
        webBrowserFB.Navigate(login_url);
    }        

    void webBrowserFB_Navigated(object sender, System.Windows.Forms.WebBrowserNavigatedEventArgs e)
    {
        if(fbAOuthResult.IsSuccess)
        {
            this.DialogResult = DialogResult.OK;
            redirect_url = webBrowserFB.Url.OriginalString;
            MessageBox.Show(redirect_url);
            this.Close();
        }
    }
} 
```

当我从[Facebook 文档](http://developers.facebook.com/docs/howtos/login/login-for-desktop/)中阅读有关如何连接桌面应用程序的相同内容时。但我收到以下错误...

**'Facebook.FacebookOAuthResult.FacebookOAuthResult()' 由于其保护级别而无法访问**

请帮助我，如果我在任何地方遗漏了什么或者我的方法不好，你可以纠正我，指引我正确的道路，因为我还是一名大学生，请为我提供更好的代码，如果可能的话..：-）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T15:44:55.407

Ramhound 先生和所有朋友，我没有使用 FacebookOAuthResult() 方法。这很简单，而且也很有效。我不明白你们为什么不在线提供一个简单的方法来完成任务......这是我使用的代码......

```
 public FacebookLogin()
    {
        try
        {
            InitializeComponent();
            login_url = new Uri("https://www.facebook.com/dialog/oauth?client_id=" +
            ConfigurationManager.AppSettings["AppID"] +
            "&redirect_uri=https://www.facebook.com/connect/login_success.html" +
            "&scope=user_photos,friends_photos,user_groups,friends_groups,read_friendlists,publish_stream" +
            "&display=popup" +
            "&response_type=token");
            webBrowserFB.Navigate(login_url);
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    } 
```

请记住在参数内将显示样式保持为“弹出”，当您通过 Web 浏览器控件导航时，它将为您提供提示样式的登录显示...您可以根据需要添加更多权限甚至更多参数以及每个细节你会从[这里](https://developers.facebook.com/docs/concepts/login/)得到它。只需彻底检查...现在如果登录成功，如何捕捉响应...？请看下面的代码...

```
 void webBrowserFB_Navigated(object sender, System.Windows.Forms.WebBrowserNavigatedEventArgs e)
    {
        try
        {
            if (webBrowserFB.Url.OriginalString.StartsWith("https://www.facebook.com/connect/login_success.html"))
            {
                redirect_url = webBrowserFB.Url.OriginalString;                    
                this.DialogResult = System.Windows.Forms.DialogResult.Yes;
                this.Close();
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    } 
```

现在您可以在代码中操作上面的 redirect_url 变量来操作它并获取您的访问令牌并开始使用 Facebook C# SDK 更好地完成您的工作......

我将很快将我的应用程序作为免费软件在线上传，并将为您提供与此代码的工作示例相同的链接。

如果你们对此代码有任何疑问，可以在这里或我经常访问的[Facebook 页面上问我。](https://www.facebook.com/pages/Benis-Tech-Porch/367305999998357?ref=hl)

请我提出好的建议以及任何改进或比这更好的代码......

> 注意：这里的 webBrowserFB 是我给我的网络浏览器控件起的名字

# jquery - 如何制作qtip2分步指南，重新打开工具提示？

> ID：13765181
> 
> 赞同：4
> 
> 时间：2012-12-07T14:35:45.367
> 
> 标签：jquery, tooltip, qtip2

我正在试验[这里](http://craigsworks.com/projects/qtip2/demos/#steps)的代码，它显示了 qtip2 的分步指南。

我试着这样做：

*   加载页面，查看工具提示
*   然后关闭工具提示
*   关闭它们后，我希望有一个可单击的链接，该链接将从头开始再次显示工具提示，而无需重新加载页面。

我尝试了一些东西让 jquery 再次执行，但喜欢

```
$("#reshow").click(function() { $(this).show(); }); 
```

但我尝试的任何方法似乎都不起作用。

我在这里设置了一个 jsfiddle 示例：http: [//jsfiddle.net/wpZ86/1/](http://jsfiddle.net/wpZ86/1/)

（如果您知道任何更简单的方法来使用工具提示进行分步指南，请写出来）

预先感谢您的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:01:16.677

您需要做的就是使用 api 再次显示工具提示

```
$('#qtip-step').qtip('api').show(); 
```

这是一个[更新的演示](http://jsfiddle.net/Mottie/wpZ86/2/)，上面的代码被添加到“设置下一个/上一个链接”点击代码中。

编辑：哦，确保在隐藏时不要破坏工具提示。

```
hide: function(event, api) { /* api.destroy(); */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:04:14.623

我发现这个解决方案很简单：http: [//jsfiddle.net/ignaciocorreia/PEYCX/1/](http://jsfiddle.net/ignaciocorreia/PEYCX/1/)

```
$('#qtip-step').qtip('api').show(); 
```

# playframework - Ajax 表单提交 Play Framework 2.0

> ID：13765183
> 
> 赞同：3
> 
> 时间：2012-12-07T14:35:49.850
> 
> 标签：playframework, playframework-2.0

我刚刚开始使用 Play 2.0 框架。我想知道进行基于 ajax 的表单提交的最佳方法是什么。目前我的页面包含一个表单和一个列表，其中应该出现（表单的）新条目。我想通过 ajax 提交以及列表更新。

但我的第一个问题是如何通过 ajax 提交表单并使用表单绑定和控制器的验证。那可能吗？这样做的正确方法是什么？

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-21T21:13:19.707

恕我直言，您可以使用 play 的 JavaScript 路由功能、js 验证（例如 jquery 验证器插件）和服务器端验证。首先声明将用作域对象的案例类

```
case class SimpleUser( name: String, email: String ) 
```

然后创建具有形式和功能的控制器：

```
object Users extends Controller{
    //validation 1 goes here
    val userForm = Form(
        mapping(
            "name" -> text,
            "email" -> email
        )(SimpleUser.apply)(SimpleUser.unapply)
    )

    def save = Action { implicit request =>
        userForm.bindFromRequest().fold(
            formWithErrors => {
                BadRequest( "uuuups" ) 
            },
            user => {
                //validation 2 goes here
                Ok( "ok" )
            }
        )
    }
} 
```

一旦你有了这个，你添加条目到路由文件

```
POST    /users/save controllers.Users.save
GET     /jsroutes   controllers.Application.javascriptRoutes 
```

并在应用程序控制器中

```
def javascriptRoutes = Action { implicit request =>
    import routes.javascript._
    Ok(
        Routes.javascriptRouter("jsRoutes")(
            Users.save
    ) ).as("text/javascript")
} 
```

现在是 JavaScript 部分

```
(...)
save: function(){
    jsRoutes.controllers.Users.save().ajax( {
        data: jQuery( 'form' ).serialize(),
        success: function( data ){
            //refresh users' list
        },
        error: function( data ){
            console.log( data.responseText );
        }
    });
} 
```

这只是一个简单的例子（我没有编译它），但显示了这个想法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T14:45:43.873

最快的方法是 jQuery。只需要[序列化](http://api.jquery.com/serialize/)您的表单并使用常见的[jQuery.ajax](http://api.jquery.com/jQuery.ajax/)发送即可。作为响应，您的方法应该发送一个包含 ie 的 JSON 数据。新项目和其他东西，如自定义状态等。

# android-intent - 电子邮件 Intent 未将 Exchange Mail (Outlook) 显示为选项

> ID：13765184
> 
> 赞同：2
> 
> 时间：2012-12-07T14:35:50.410
> 
> 标签：android-intent

当我单击一个按钮时，我使用以下代码来启动一封电子邮件并用来自数据库查询的数据填充它。

问题是，在单击按钮时弹出的“发送邮件...”对话框中，它仅提供以下选项：

```
* Evernote - create note
* Gmail
* Skype 
```

我需要通过我的工作 Microsoft Exchange 服务器（我的主要电子邮件客户端）发送此信息，但不提供此功能（但是，当我单击其他应用程序中的 Web 超链接或类似按钮时，它会提供）：

```
private void sendEmail(String recipient, String subject, String message) { 
    try { 
        final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
        emailIntent.setType("plain/text"); 
        if (recipient != null)  emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{recipient}); 
        if (subject != null)    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject); 
        if (message != null)    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, message); 

        startActivity(Intent.createChooser(emailIntent, "Send mail...")); 

    } catch (ActivityNotFoundException e) { 
        // cannot send email for some reason 
    } 
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T16:50:46.630

好的，所以我在这篇文章中找到了答案：[如何通过 Intents 打开电子邮件程序（但只有一个电子邮件程序）](https://stackoverflow.com/questions/3312438/how-to-open-email-program-via-intents-but-only-an-email-program)

*更改 MIME 类型就是答案，这就是我在我的应用程序中所做的以更改相同的行为。我用了 intent.setType("message/rfc822");*

像梦一样工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-02T07:36:29.403

When the screen pops up and you have the option to choose the application you need to send data, at that time select "Set Default Action". So, next time you use your app to send the email it will open the default application you selected

# java - processing.org 中的舍入浮点数

> ID：13765189
> 
> 赞同：0
> 
> 时间：2012-12-07T14:36:08.270
> 
> 标签：java, floating-point, processing

有没有办法在处理过程中将浮点数四舍五入到最接近的小数位？

例如

```
float x = 1.0000001
float y = 1.1000000001

float a = x + y
round(a)

a = 2.10 
```

`round()`处理四舍五入到最接近的整数的标准，但我需要有小数位。我找不到可以满足我要求的功能。我有一些小数点数超过一百位的浮点数，所以如果可能的话，我需要将它们修剪掉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T07:11:41.743

这是一个更以处理为中心的函数：

```
float fixDec(float n, int d) {
  return Float.parseFloat(String.format("%." + d + "f", n));
} 
```

并对其进行测试：

```
float x = 1.0000001;
float y = 1.1000000001;
x = fixDec(x, 2);
y = fixDec(y, 2);
float a = x + y;
round(a); 
```

这可能不是最有效的算法，但它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:09:08.490

我不熟悉处理。但是，在给定整数舍入函数的情况下，舍入到固定小数位数的常用方法是：

```
a = round(a * PowerOf10) * InversePowerOf10 
```

因此，对于小数点后的一位数，您可以使用：

```
a = round(a * 10) * .1 
```

有一些注意事项和评论：

*   这在二进制浮点中不起作用。这是不可能的，因为像 .1 这样的数字不能用二进制浮点数精确表示。如果可能足够接近，取决于您的需要以及您是否采取适当的措施。
*   十进制浮点可能很好，但十进制浮点很少见。如果处理实现了十进制浮点，你可能已经准备好了。
*   我对这两种运算都使用了乘法，因为乘法通常比除法快。但是，在某些情况下最好使用除法：`a = round(a * PowerOf10) / PowerOf10`. （值得注意的是，在二进制浮点中，这避免了计算 PowerOf10 的倒数时的额外舍入误差。）
*   如果处理提供了扩展精度的二进制浮点，即使结果不准确，结果也可能足够接近您的目的。
*   如果要格式化数字以进行显示而不是进一步计算，请寻找字符串格式化函数而不是数字舍入函数。即使在二进制浮点中，也可以将字符串中的数字转换为十进制数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T03:08:35.570

> 浮点数并不精确，因此避免添加较小的值（例如 0.0001）可能不会因为舍入误差而始终递增。如果要以小间隔递增值，请使用 int，并在使用前除以 float 值。

[http://processing.org/reference/float.html](http://processing.org/reference/float.html)

```
int i = 10001000;
int j = 11000001;

float a = round((i + j)/pow(10,5));

a /= 100;

println(a); 
```

2.1

# c++ - 有没有办法增加 QString？

> ID：13765191
> 
> 赞同：1
> 
> 时间：2012-12-07T14:36:37.267
> 
> 标签：c++, qt, qstring

有没有办法在 C++ 中增加 QString - 比如：
`QString str("a");`
`str++;`
`qDebug()<<a; //Here i want letter "b"`

**编辑：**是的，基本上我想增加一个字母，但增加更长的字符串会很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T14:45:52.570

你不能真正增加一个字符串，因为你首先必须定义它是如何工作的。例如，值将环绕在哪里。

你可以增加字符，但即使这样也只适用于有意义的字符序列：

`str[0].unicode()++;`

编辑：反应 OP 评论

如果您只想在场景之间切换，这是您要使用的代码：

```
enum Scenarios { ScenarioOne, ScenarioTwo, ScenarioThree, ScenariosCount };

Scenarios var = ScenarioOne;
var++; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T14:55:12.663

您不能递增或递减 QString，因为没有为该类定义 ++ 和 -- 运算符，并且对于递增字符串可能意味着什么没有明确的概念（虽然您可能很清楚，但不清楚足以使其成为标准 Qt 库的一部分）。

你可以做的是创建一个 QString 的子类，然后实现 operator++() 和 operator--()。使用这样的子类，您将保留标准 QString 的所有功能，同时让它的行为与您希望的递增和递减完全一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:38:46.473

您可以使用每个字符的[ascii](http://www.asciitable.com/)值并将它们连接到字符串

# xml - 从节点 XML、XSLT 创建表

> ID：13765194
> 
> 赞同：0
> 
> 时间：2012-12-07T14:36:38.083
> 
> 标签：xml, xslt, xmltable

我正在从 XML 文件中获取数据并使用 XSLT 对其进行转换。我有一个要从中创建表的节点。

```
<?xml version="1.0" encoding="utf-8"?>

<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:variable name="file" select="document('file.xml')"/>

<xsl:template match="/">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
    </head>
    <body>
        <table>
           <xsl:value-of select="$file/Workbook/Worksheet/Table"/>
        </table>
    </body>
</html> 
```

```
//output: id firstname lastname 8 Jonas Berg 15 Adam Jones ... 
```

我希望表格看起来像：

```
id    firstname    lastname
8     Jonas        Berg  
... 
```

我可以这样做吗？

表中的 XML 示例：

```
 <Row>
<Cell ss:Index="2"><Data ss:Type="String">id</Data></Cell>
<Cell ss:StyleID="s62"><Data ss:Type="String">firstname</Data></Cell>
<Cell><Data ss:Type="String">lastname</Data></Cell>
 </Row>
   <Row>
    <Cell ss:Index="2"><Data ss:Type="Number">8</Data></Cell>
    <Cell ss:StyleID="s62"><Data ss:Type="String">Jonas</Data></Cell>
    <Cell><Data ss:Type="String">Berg</Data></Cell>
   </Row> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:48:17.750

这很简单。唯一的挑战是正确使用 XML 名称空间。

```
<xsl:stylesheet 
  version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns="http://www.w3.org/1999/xhtml"
>
  <xsl:output 
    type="xml"
    doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN"
    doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
  />

  <xml:strip-space elements="*" />

  <xsl:template match="/">
    <head>
      <title></title>
    </head>
    <body>
      <table>
        <xsl:apply-templates />
      </table>
    </body>
  </xsl:template>

  <xsl:template match="Row">
    <tr><xsl:apply-templates /></tr>
  </xsl:template>

  <xsl:template match="Cell">
    <td><xsl:apply-templates /></td>
  </xsl:template>

  <xsl:template match="Data">
    <xsl:value-of select="." />
  </xsl:template>

</xsl:stylesheet> 
```

笔记

*   XHTML 名称空间必须声明为 XSLT 中的默认名称空间，否则结果文档将不是 XHTML。
*   必须声明 Excel 的电子表格命名空间 - 我使用了与 Excel 相同的前缀 - `ss`。
*   `doctype-public`and`doctype-system`属性为 XHTML 创建正确的文档类型声明。
*   剩下的就是翻译`<Row>`to`<tr>`和 `<Cell>`to `<td>`，这很容易使用两个简单的模板。
*   您可以编写其他更专业的模板，例如`<xsl:template match="Data[@ss:Type='Number']">`以不同格式输出某些数据类型。

# iphone - AdMob SDK 在内部处理网址

> ID：13765197
> 
> 赞同：0
> 
> 时间：2012-12-07T14:36:43.980
> 
> 标签：iphone, ios, admob

我已将 AdMob SDK 集成到我的应用程序中，并且我正在使用 Google DFP 创建横幅。

我们制作了一些应该与内部视图相关联的广告。我已经实现了 handleOpenURL 方法，因为过去我们使用了另一个广告系统。

添加自定义 HTML 代码，在其中添加指向自定义 URL 的链接（例如 tab://MyView），然后单击我的应用程序中的广告，没有成功。

是否有可能在 AdMob 网址操作被重定向之前捕获它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T00:44:52.707

AdMob 为 DFP 提供了一项名为“[应用事件](https://developers.google.com/mobile-ads-sdk/docs/dfp/fundamentals#ios_app-events)”的功能，您的 HTML 广告素材可以触发 SDK 将侦听的事件 - 然后您可以实施

```
(void)adView:(DFPBannerView *)banner
    didReceiveAppEvent:(NSString *)name
              withInfo:(NSString *)info 
```

并做出相应的反应。

要触发该事件，您需要在点击广告时`admob.events.dispatchEvent`从[AdMob API for Ads调用。](http://media.admob.com/api/v1/docs/)

# algorithm - 有人可以向我解释旋转卡尺吗？

> ID：13765200
> 
> 赞同：11
> 
> 时间：2012-12-07T14:37:03.490
> 
> 标签：algorithm, geometry, bounding-box

我正在努力计算一组点的最小封闭矩形（任意对齐）。

我能够使用格雷厄姆算法计算凸包。

我被困的地方是下一步。我考虑过使用旋转卡尺方法，但我似乎无法找到对该算法的充分解释。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T14:40:17.780

如果你有凸包，那么一个基本的算法很容易。您只需通过凸包的每个边缘并旋转您的点，使边缘沿着主轴，比如说 X 轴。然后你会找到这些点的轴对齐边界框。选择最小的边界框。

通过获取每个维度的最小值和最大值，可以找到一个轴对齐的边界框。

如果您将边界框旋转相反的量，它将包围您的原始点。

为了提高效率，请注意唯一可以影响边界框的点位于凸包上。

为了使其真正有效，请注意，在任何时候，凸包周围只有四个点与边界框接触（严格来说这不是真的，但暂时忽略它）。如果您将点旋转到刚好足以使下一条边与边界框对齐，则其中三个点是相同的，其中一个点将替换为凸包周围的下一个点。这使您可以创建一个算法，该算法在凸包上的点数上是线性的。

现在有两条边平行或垂直的特殊情况。这将导致超过四个点在任何时候接触边界框，但实际上并不重要。如果您可以选择接下来使用两条平行边中的哪一条，您可以任意选择一条。

# nservicebus - 安装 NServiceBus 基础设施

> ID：13765202
> 
> 赞同：1
> 
> 时间：2012-12-07T14:37:08.700
> 
> 标签：nservicebus

我目前正在试用 NServiceBus，它在我的系统上运行良好。现在我想将它安装在我们的一台内部服务器上，以记录从头开始设置 nservicebus 需要做什么。我目前的策略是调用`NServiceBus.Host /installInfrastructure`似乎有效的方法，它报告安装了 RavenDB 和 Msmq 以及 DTC。但是，当我尝试运行我的示例应用程序（作为管理员）时，我得到了一个异常：

```
2012-12-07 15:13:43,599 [1] FATAL NServiceBus.Hosting.GenericHost [(null)] <(null)> - System.InvalidOperationException: There is a problem with the input queue: FormatName:DIRECT=OS:dev\private$\els.bus.els.service. See the enclosed exception for details. ---> System.Messaging.MessageQueueException: The queue does not exist or you do not have sufficient permissions to perform the operation.
   at System.Messaging.MessageQueue.MQCacheableInfo.get_Transactional()
   at System.Messaging.MessageQueue.get_Transactional()
   at NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.QueueIsTransactional()
   --- End of inner exception stack trace ---
   at NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.QueueIsTransactional()
   at NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.Init(Address address, Boolean transactional)
   at NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.NServiceBus.Unicast.Transport.ITransport.Start(Address address)
   at NServiceBus.Unicast.UnicastBus.NServiceBus.IStartableBus.Start(Action startupAction)
   at NServiceBus.Hosting.GenericHost.Start() 
```

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T07:41:30.083

In addition to installing the infrastructure, you need to invoke the /install flag to get your queues created (which requires admin privileges).

# ruby-on-rails - 遍历数组并比较每个类别的值并返回得分最高的一个

> ID：13765209
> 
> 赞同：1
> 
> 时间：2012-12-07T14:37:50.280
> 
> 标签：ruby-on-rails

我正在我的网络上制作一个测试应用程序，用户可以在其中看到一个检查列表，标记所有适用的内容并根据他选择的内容获得结果。

每个问题都有一个类别和一个值，并且 id 喜欢获取得分最高的类别（将每个类别的所有值相加并返回最高的）

我已经取得了一些成功，通过下面的代码，我将所有回答的问题分数加在一起，而不考虑每个问题属于哪个类别

```
 @test_session.answered_questions.each do |a|
        if a.answer == 1
          @theResult.score = @theResult.score + a.q_value
        end    
        @theResult.save!
      end 
```

问题是复选框，所以如果`answer == 1`复选框被标记

问题是类别的数量是动态的..

我有一个想法，我可以循环`@test_session.answered_questions.category.each`将类别值添加到一些变量中，并在计算所有类别分数时进行比较，但是我将有动态数量的变量进行比较

我觉得我应该为此使用一些地图功能

**更新**

这是我设置问题类别属性的方法

```
<%= nested_form_for @personal_test do |f| %>

  <div class="field">
    <%= f.label "Name" %>
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label "Description" %>
    <%= f.text_area :description %>
  </div>

  <div class="field">
<%= f.fields_for :questions do |ff| %>
  <%= ff.label "Question" %>
  <%= ff.text_field :question_text %>

  <%= ff.label "Question value" %>
  <%= ff.number_field :value %>

  <%= ff.select :category, options_for_select(Category.all.collect {|p| [ p.name, p.id ] }, :selected => ff.object.category), :prompt => 'Category' %>
  <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:30:33.960

我想你会想做这样的事情。我在代码中添加注释以尝试解释它。

```
#loop through all categories...
@test_session.answered_questions.category.each do |c|
   sum = 0
   #loop through every questions in current category
   c.answered_questions.each do |a|
      if a.answer == 1
         sum += a.q_value
      end
   end
   #keep track of the highest score and category as we go along...
   #we can forget about the rest
   if @theResult.score.nil? or sum > @theResult.score
      @theResult.score = sum
      @theResult.category = c
   end 
end

#theResult now holds the category with the highest score

@theResult.save! 
```

# php - 我的注册 PHP 脚本不工作

> ID：13765210
> 
> 赞同：1
> 
> 时间：2012-12-07T14:37:54.510
> 
> 标签：php, html, login

我的 register.php 一切正常，当您尝试注册时，它说一切正常，但我的数据库中没有任何内容。难道我做错了什么？

```
<?php
echo "<h1>Register:</h1>";  
$submit = $_POST['submit'];  
//form data  $fullname = strip_tags($_POST['fullname']);  
$username = strip_tags($_POST['username']);  
$password = strip_tags($_POST['password']);  
$repeatpassword = strip_tags($_POST['repeatpassword']);  
if ($submit)  {  
    // check for existance  
    if ($fullname && $username && $password && $repeatpassword)  {  
    if ($password == $repeatpassword)  {
        //check char length of username and fullname  
        if (strlen($username > 25) || strlen($fullname) > 25)  {  
            echo "Length of username or fullname is too long! Max 25 characters for each!";  
        }  else  {
            //check password length  
            if (strlen($password) > 25 || strlen($password) < 6)  {  
                echo "Password must be between 6 and 25 characters";  
            }  else  {  
                //register the user!  
                //encrypt password  
                $password = ($password);  
                $repeatpassword = ($repeatpassword);  
                //open database  
                $connect = mysql_connect("localhost","user","password") 
                    or die ("Couldn't Connect!");  
                mysql_select_db("user_phplogin"); 
                //select database  
                $queryreg = mysql_query("  
                    INSERT INTO `user_phplogin`.`users` (`id`, `fullname`, `username`, `password`) VALUES  (NULL,'$fullname','$username','$password')  "); 
                die("You have been registered! <a href='login.html'> Return to login page</a>");  
                echo "Success!!";  
            }  
        }  
    }  else 
        echo "Your passwords do not match!";  
}  else  
    echo "Please fill in <b>all</b> fields!";  
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:00:17.230

我要指出的第一个问题是您正在使用过时的`mysql_xx()`功能。您应该切换到`mysqli_xx()`函数或 PDO 库。仅凭这一点并不能解决问题，但指出这一点很重要。

下一个：数据卫生。你正在用`strip_tags()`函数清理你的数据。这将阻止您的用户发布 HTML 代码，但不足以使您的查询免受 SQL 注入攻击和其他问题的影响。您需要转义数据以使其在 SQL 字符串中安全使用。使用您现有的代码，您需要使用它`mysql_real_escape_string()`来执行此操作。如果您遵循我的建议并切换到一组不同的 SQL 函数，您将使用`mysqli_real_escape_string()`或`PDO::quote()`。有关如何使用这些函数的更多信息，请参阅相关的 PHP 手册页。这是非常重要的修复。

第三点：错误处理。请参阅代码的相关部分：

```
$queryreg = mysql_query("
                INSERT INTO `user_phplogin`.`users` (`id`, `fullname`, `username`, `password`) VALUES  (NULL,'$fullname','$username','$password')  ");
die("You have been registered! <a href='login.html'> Return to login page</a>");
echo "Success!!"; 
```

在此代码中，您正在调用查询函数，但无论查询函数返回什么，总是报告“您已注册”消息。查询函数可能会失败并抛出错误，这几乎可以肯定是正在发生的事情，但是您没有做任何事情来检查该错误是什么。

PHP 提供了错误处理函数来帮助您解决这个问题。您需要检查是否`$queryreg`已填充，如果没有，请报告一条解释错误的消息。例如：

```
if(!$queryreg) {
    die("Something went horribly wrong. SQL error message: ".mysql_error());
} 
```

`mysql_error()`or（mysqli 或 PDO 库中的等效函数）的输出将是查询失败时 MySQL 输出的确切错误消息。这应该足以帮助您调试问题，因此对测试很有用。但是，当您的代码在生产中时，您可能不应该向用户打印这样的消息，因为 (a) 它很混乱，并且 (b) 它通过告诉黑客您的查询和数据结构给黑客提供了不必要的帮助。一般来说，最好记录这样的错误，以便您可以阅读它们，但向用户报告更通用的错误消息。

我希望这可以帮助您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:59:58.437

为什么要加id？在您的表中是“自动增量”id 列？

```
$queryreg = mysql_query("INSERT INTO `users` (`fullname`, `username`, `password`) VALUES  ('$fullname','$username','$password')  "); 
```

你没有执行

```
echo "Success"; 
```

因为您之前使用 die() 并且脚本将在那里终止

# git - 在 linux 服务器与 github 上运行 git

> ID：13765215
> 
> 赞同：1
> 
> 时间：2012-12-07T14:38:22.653
> 
> 标签：git, github

我正在考虑使用 git 进行源代码管理。我对是否应该使用 git 设置 ubuntu 服务器还是只使用 github 有点困惑？使用 github 真的有什么好处吗？另外，如果生产服务器没有安装 git，你将如何将代码从 git（或 github）部署到生产服务器？我是否必须在 php 中编写某种部署脚本（使用 ftp 函数）或使用 shell 脚本？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T14:43:22.300

Git 根本不需要服务器来运行。您可以将其安装在本地计算机上，创建存储库并开始使用它。

远程 git 安装（您可以在您自己的远程服务器上或 github.com 免费提供）只需要创建您的 git 存储库的远程副本（如果您要从多个位置进行编程，或者如果您想与世界分享您的源代码历史）

github 的优势——公共 repos 是免费的，它有适用于 Windows 和 Mac 的 GUI 客户端（不了解 Linux）。

将代码部署到生产服务器是完全不同的事情——它与 git 无关。无需在生产服务器上安装 git。

# c# - 填充 2D 矩形

> ID：13765216
> 
> 赞同：2
> 
> 时间：2012-12-07T14:38:24.817
> 
> 标签：c#, xna, 2d, draw

我是 XNA 的新手，现在我正在使用以下代码绘制一个矩形：

```
// Calculate particle intensity
intense = (int)((float)part.Life / PARTICLES_MAX_LIFE);
// Generate pen for the particle
pen = new Pen(Color.FromArgb(intense * m_Color.R , intense * m_Color.G, intense * m_Color.B));
// Draw particle
g.DrawRectangle(pen, part.Position.X, part.Position.Y, 
    Math.Max(1,8 * part.Life / PARTICLES_MAX_LIFE),
    Math.Max(1,8 * part.Life / PARTICLES_MAX_LIFE));
pen.Dispose(); 
```

我在网上找到的所有用颜色填充矩形的方法似乎都不适用于我绘制矩形的方式。我怎样才能用颜色填充它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-07T15:08:30.877

您的代码似乎最有可能是为 GDI 而不是 XNA 编写的，因此它无法正常工作。

但是，XNA 包含一个非常有用的[`Rectangle`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.rectangle.aspx)结构。

这意味着您可以“拉伸”图像以填充矩形，因此创建一个`Texture2D`1x1 像素的新图像，并在绘制时拉伸尺寸以增加尺寸..（或者您可以加载一个）

```
Texture2D texture = new Texture2D(graphics, 1, 1, false, SurfaceFormat.Color);
texture.SetData<Color>(new Color[] { Color.White });
return texture; 
```

您可以将此小纹理与[`Rectangle`基于重载](http://msdn.microsoft.com/en-us/library/ff433986.aspx)的方法结合使用`SpriteBatch`

```
spriteBatch.Draw(texture, new Rectangle(X, Y, Width, Height), Color.White); 
```

根据自己的喜好更改`Width`、`Height`、 位置和颜色。

# android - android在后台接近警报中工作

> ID：13765220
> 
> 赞同：1
> 
> 时间：2012-12-07T14:38:28.920
> 
> 标签：android, multithreading, background, alarm, onpause

我正在学习使用 android 开发并尝试它，我想制作一个“接近警报”。当我接近某个点时，我需要敲响警报。

首先我做了一个循环来计算点和我们位置之间的距离，当它小于一个距离时，响警报。

没关系，但是...从逻辑上讲，当您发出警报时，您可以播放其他应用程序，所以我的发生了什么？

我需要使用 onPaused() 方法吗？也许创建一个线程？我迷失在这一刻，有人知道该怎么做吗？o 给我一些建议？

谢谢 =)

这是我的代码......现在使用 asyncTask，显然不起作用，一些帮助？

公共类 RunActivity 扩展 MapActivity {

```
private MapView map;
private MapController mapControl;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_run);

    this.map = (MapView)findViewById(R.id.map);
    this.map.setBuiltInZoomControls(true);       

    this.mapControl = map.getController();

    GeoPoint centro = new GeoPoint((int)(40.463667 * 1E6), (int)(-3.749220 * 1E6));
    this.mapControl.setCenter(centro);
    this.mapControl.setZoom(10);

    List<Overlay> capas = this.map.getOverlays();
    MyLocationOverlay mOverlayLocation = new MyLocationOverlay(this, this.map);

    mOverlayLocation.enableMyLocation();
    mOverlayLocation.enableCompass();

    capas.add(mOverlayLocation);

    this.map.postInvalidate();

    MiTareaAsincrona Ejemplo = new MiTareaAsincrona();
    Ejemplo.execute(RunActivity.this);
}

@Override
protected boolean isRouteDisplayed() {
    return false;
}

class MiTareaAsincrona extends AsyncTask<Context, Double, Boolean> {

    private boolean finish = false;
    private double target_lat;
    private double target_lon;

    protected void onPreExecute() {

        Bundle Datos = getIntent().getBundleExtra("Datos");
        this.target_lat = Datos.getInt("LATITUD");
        this.target_lon = Datos.getInt("LONGITUD");

    }

    protected Boolean doInBackground(Context... context) {      

        LocationManager manager = (LocationManager)context[0].getSystemService(Context.LOCATION_SERVICE);
        LocationListener listener = new LocationListener() {

            double actual_lat;
            double actual_lon;
            Bundle Datos = getIntent().getBundleExtra("Datos");

            public void onStatusChanged(String provider, int status, Bundle extras) {
                // TODO Auto-generated method stub

            }

            public void onProviderEnabled(String provider) {
                // TODO Auto-generated method stub

            }

            public void onProviderDisabled(String provider) {
                // TODO Auto-generated method stub

            }

            public void onLocationChanged(Location location) {
                actual_lat = location.getLatitude()*1E6;
                actual_lon = location.getLongitude()*1E6;

                if (distance(actual_lat, actual_lon, target_lat, target_lon) < Datos.getInt("DISTANCIA")) {
                    finish = true;
                }

            }
        };

        manager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, listener);
        return finish;
    }

    protected void onProgressUpdate() { }

    protected void onPostExecute(Boolean result) {
        if (finish) {
            Log.v("OJU", "MIARMA");
        }
    }

    /*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
    /*::  This function converts decimal degrees to radians             :*/
    /*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
    private double distance(double lat1, double lon1, double lat2, double lon2) {
      double theta = lon1 - lon2;
      double dist = Math.sin(deg2rad(lat1)) * Math.sin(deg2rad(lat2)) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.cos(deg2rad(theta));
      dist = Math.acos(dist);
      dist = rad2deg(dist);
      dist = dist * 60 * 1.1515 * 1.609344 * 1000; // en metros

      return (dist);
    }

    /*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
    /*::  This function converts decimal degrees to radians             :*/
    /*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
    private double deg2rad(double deg) {
      return (deg * Math.PI / 180.0);
    }

    /*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
    /*::  This function converts radians to decimal degrees             :*/
    /*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
    private double rad2deg(double rad) {
      return (rad * 180.0 / Math.PI);
    }       

} 
```

}

# php - htaccess 重写后的“意外令牌'>'”第 1 行（中断 css 和图像）

> ID：13765224
> 
> 赞同：6
> 
> 时间：2012-12-07T14:38:39.940
> 
> 标签：php, .htaccess, content-management-system, multilingual, kirby

基本上，我一直致力于修复损坏的链接。旧链接可能指向`http://www.example.com/work/funkystuff`，我将它们重定向到`http://www.example.com/en/work/funkystuff`。

以下是这种可怕疾病的症状：

1.  图像、Css 和 Javascript 中断。控制台告诉我`Resource interpreted as Stylesheet but transferred with MIME type text/html: "http://localhost/en/".`每种类型的“”。

2.  我在文件的第一行（我的 doctype 所在的位置`Uncaught SyntaxError: Unexpected token <`）上收到关于“”的奇怪错误。`index.php`这让我认为它甚至没有将我的 .php 文档解释为 .php 文档......

根据我从 Google 会话中收集到的信息，这不应该发生。我的链接是绝对的（由 php 回显），并且我有 RewriteCond 仅重定向不存在的文件和目录（第 4 行和第 5 行）。

所以，是的，这就是我的 .htaccess 的样子。

```
# enable awesome urls. i.e.: 
# http://example.com/about-us/team
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# make sure to set the RewriteBase correctly
# if you are running the site in a subfolder.
# Otherwise links will break.
# 
# If your homepage is http://example.com/mysite
# Set the RewriteBase to:
# 
# RewriteBase /mysite
# 
RewriteBase /

# Redirect key areas of the site before localisation.
RewriteRule ^work/(.*)$ /en/work/$1 [NC,R=301,L]
RewriteRule ^news/(.*)$ /en/news/$1 [NC,R=301,L]
RewriteRule ^about/(.*)$ /en/about/$1 [NC,R=301,L]
RewriteRule ^careers/(.*)$ /en/careers/$1 [NC,R=301,L]
RewriteRule ^contact/(.*)$ /en/contact/$1 [NC,R=301,L]
RewriteRule ^update-twitter/(.*)$ /en/update-twitter/$1 [NC,R=301,L]

# redirect everything to index.php
RewriteRule ^(.*) index.php [L] 
```

我希望有人知道这可能是什么，因为我很困惑。

**编辑**：我觉得我应该添加更多信息。

我们正在使用一个名为 Kirby 的 CMS，现在开始转向该网站的多语言版本。通过自动检测浏览器语言并将用户从域重定向到域/语言，Kirby 可以为我们简单地做到这一点。

问题是我们使用重定向使事情复杂化。URL 的语言部分不是真正的子目录，而是一个名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:04:48.430

要修复 css MIME 类型，请将以下行添加到您的 htaccess 文件中：

```
AddType text/css .css 
```

这假定样式表文件名以 .css 结尾。如果没有，请更改它。

# asp.net-mvc-3 - 使用 ajaxSubmit 上传文件的 jquery 对话框在验证失败后未发布（IE 缓存问题？）

> ID：13765229
> 
> 赞同：1
> 
> 时间：2012-12-07T14:38:51.127
> 
> 标签：asp.net-mvc-3, jquery, jquery-dialog

这只发生在 IE 中。Chrome 和 Firefox 运行良好。我正在使用 ASP.NET MVC 3 和 jQuery。

我有一个带有文件上传表单的 jQuery 对话框，所以我使用 ajaxSubmit 将表单提交到服务器。我没有使用任何客户端验证，但我在我的模型上使用服务器端验证。

我在 Visual Studio 中以调试模式运行代码，并在此控制器操作的 POST 处理程序上设置了一个断点。我打开对话框并以我知道无效的方式填写表格。当我单击保存时，我首先得到警报（'save'），然后得到警报（'beforeSubmit'），然后我的 ajaxSubmit 运行并命中“服务器”上的断点。验证失败并返回带有可见红色验证消息的新表单。在那里的某个地方我得到了警报（'成功'）和警报（'完成'）。一切都很好。然后我将表单上的数据修复为有效并再次单击“保存”。

这次我得到警报（'保存'），就是这样。没有其他的。没有其他警报，没有断点，什么都没有。Fiddler 甚至没有注册 POST。同样，这只发生在 IE 中。Chrome 和 Firefox 运行良好。

请帮忙。

```
function save() {
    alert('save');
    $('#household-member-form').ajaxSubmit({
        url: '/Wizard/HouseholdMember',
        target: '#dialog-household-income',
        type: 'POST',
        cache: false,
        success: function () {
            alert('success');
        },
        error: function () {
            alert('error');
        },
        beforeSubmit: function () {
            alert('beforeSubmit');
        },
        complete: function () {
            alert('complete');
        },
        async: false
    });
} 
```

编辑：我的控制器动作中也有这个：

HttpContext.Response.Cache.SetNoStore(); HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);

编辑2：另外，任何关于我如何重新措辞这个问题以获得更好的回应的反馈将不胜感激。

# functional-programming - Erlang 列表与元组比较

> ID：13765230
> 
> 赞同：3
> 
> 时间：2012-12-07T14:38:56.477
> 
> 标签：functional-programming, erlang

假设有一个 erlang 列表列表：

请注意，列表的大小是固定的。在这种情况下 3。

```
A = [[1,2,3],[4,5,6],[1,8,3],[1,9,3]] 
```

我正在尝试编写将删除所有形式为的元素的函数`[1,_,3]`。所以我的预期输出将是以下形式：`[[4,5,6]]`

我可以考虑的一种解决方案是列表：`dropwhile()`可以使用的函数。

我在构造谓词函数时遇到问题。将每个元素转换为元组然后进行比较是否更容易？如果是这样，我没有适当的方法可以省略中间元素。

你能帮我找到解决方案吗？任何其他有效的方法也将受到高度赞赏。

提前致谢！

编辑：问题扩展：

假设两个 erlang 列表列表：

A = [[1,2,3], [2,3,4], [4,5,6]]

B = [[1,4,3], [4,7,6], [7,8,9], [4,9,7], ]

输出 F(A,B) = [[7,8,9], [4,9,7]]

F 被定义为一个函数，它从列表 B 中删除与列表 A 中第一个和第三个位置的任何一个元素匹配的所有元素。

在这种情况下，列表 B 中与 [1, _ ,3] 或 [2, _ , 4] 或 [4 , _ , 6] 匹配的所有元素都将从列表中删除以给出结果列表。

我正在努力写 F。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-07T15:52:21.013

您的过滤器功能需要一些帮助：

```
lists:filter(fun([1, _, 3]) -> false; (_) -> true end,
             [[1,2,3],[4,5,6],[1,8,3],[1,9,3]]). 
```

您需要函数头中的匹配来完成这项工作。

* * *

至于有多个过滤器，您可以使用一张有趣的地图（未测试）：

```
composed_filter(Tests, Input) ->
  lists:filter(fun(X) -> lists:all([F(X) || F <- Tests]) end,
               Input). 
```

* * *

要使用多个过滤器，您可以执行以下操作：

```
filter(fun([1,_,3]) -> true;
          ([5,_,7]) -> true;
          ([9,_,13]) -> true;
          (_) -> false end, Input)
% or
composed_filter([fun([1,_,3]) -> true; (_) -> false end,
                 fun([5,_,7]) -> true; (_) -> false end,
                 fun([9,_,13]) -> true; (_) -> false end],
                Input) 
```

尽管除非您需要*可编程的动态*可组合性，否则您可能应该只使用第一个。另一种方法是使用函数而不是专门的composer_filter来运行组合。这是 Haskell 人群会喜欢的更加组合器风格的方法。请注意，上述功能略有不同。第一个具有`orelse`语义，而后者具有`andalso`语义。也就是说，在第一种情况下，如果一个或多个模式匹配，您将获得元素，而在后一种情况下，只有当*所有*模式/乐趣都匹配时，您才会获得结果。你可以`lists:any/2`用来获得一个`composed_any_filter`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T14:57:10.213

`dropWhile`只能返回列表的前缀，所以它不起作用。改为使用`filter`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T05:32:33.820

我设法为扩展问题提出了解决方案：

给定 A 和 B 作为问题：

```
F(A,B) ->
    lists:filter(fun(X) -> predicate(X,B) end, A).

predicate(X, B) ->
    Xr = lists:delete(lists:nth(2,X),X),
    Br = lists:map(lists:delete(lists:nth(2,Y),Y),B),
    lists:member(Xr, Br). 
```

这个列表库太酷了.. :)

# php - 如何在 mysql 中加入两个表并使用 php 显示它？

> ID：13765237
> 
> 赞同：1
> 
> 时间：2012-12-07T14:39:33.133
> 
> 标签：php, mysql

我有两张桌子。结构是：

```
mysql> desc working;
+-------------+-------------+------+-----+---------+-------+
| Field       | Type        | Null | Key | Default | Extra |
+-------------+-------------+------+-----+---------+-------+
| worker_id   | varchar(12) | YES  |     | NULL    |       | 
| worker_duty | varchar(30) | YES  |     | NULL    |       | 
| salary      | varchar(8)  | YES  |     | NULL    |       | 
+-------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> desc users;
+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| user_id     | varchar(12)  | YES  |     | NULL    |       | 
| user_name   | varchar(21)  | YES  |     | NULL    |       | 
| discription | varchar(200) | YES  |     | NULL    |       | 
+-------------+--------------+------+-----+---------+-------+
3 rows in set (0.00 sec) 
```

我想使用`worker_id`and加入这两个表并`user_id`使用 PHP 获取它。

我用 ：

```
SELECT * from users t1
WHERE user_id="293274"
AND SELECT worker_duty ,worker_id from working t2
             WHERE t1.user_id= t2.worker_id 
```

但是这段代码不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:42:59.203

内部联接

```
select u.user_id, u.user_name, u.discription, w.worker_duty
from users u
inner join working w on w.worker_id = u.user_id
where u.user_id = "293274"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:43:10.500

也许像这样？

```
 'SELECT u.user_id, u.user_name, u.discription, w.worker_duty FROM users as u
 JOIN working as w ON u.user_id=w.worker_id
 WHERE w.user_id="293274" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:44:29.900

`SELECT users.user_id, users.user_name, user.discription, working.working_duty FROM user JOIN working ON user.user_id = working.worker_id WHERE user.user_id="293274"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T14:44:42.207

使用联接如下：

```
 SELECT t1.*,  t2.worker_duty , t2.worker_id  
     from users t1 JOIN working t2
          ON t1.user_id= t2.worker_id 
     WHERE t1.user_id="293274" 
```

# slickgrid - 跳格时光滑的网格跳过列

> ID：13765239
> 
> 赞同：3
> 
> 时间：2012-12-07T14:39:35.040
> 
> 标签：slickgrid

有没有一种方法可以防止用户在使用光滑网格时通过特定列切换？

我希望标签跳转到只读列，其中两边的其他列都有编辑器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-25T08:06:48.047

在列的选项中使用属性“可聚焦”。[文档](https://github.com/mleibman/SlickGrid/wiki/Column-Options)说：

> 当设置为 false 时，单击此列中的单元格不会选择该单元格的行。在选项卡导航期间也将跳过此列中的单元格。

列定义将如下所示：

```
var columns = [
  { id: "EditableCulumn", name: "Editable", field: "Name", editor: Slick.Editors.Text }
, { id: "ReadOnlyColumn", name: "ReadOnly", field: "ID", focusable: false }
] 
```

# wpf - WPF 减速性能

> ID：13765241
> 
> 赞同：0
> 
> 时间：2012-12-07T14:39:57.860
> 
> 标签：wpf, performance, optimization, slowdown

它是在 VS2010 中开发的应用程序，其理念是针对 Postgres 数据库的 WPF Web 浏览器的 3 层理念。代码级别 (VB.NET) 遵循 Microsoft 建议的代码优化最佳实践。

这是一个高“流量”的应用，因为它允许许多调用“转录员”的用户对大量数据进行连续的数据处理。

也就是说，是一个允许多个用户 (n) 连续“攻击”一定数量的数据的应用程序，使用 IE9 他们（或使用 Firefox 与允许 XBAP 可视化的补充）。

许多用户报告说，该应用程序最初在性能和流动性方面表现良好，但在半小时（Windows XP Professional）和一个半小时近两个小时（Windows 7）后，应用程序开始降低响应速度，迫使用户关闭浏览器，有时会重新启动。

这些团队在 SO（Windows 7 和 Windows XP Professional）方面各不相同，有些团队配备 2 或 3 GB 内存以及从 Pentium 到 Intel Core i3 的各种处理器。

现在，问题

如何在如此多样化的舞台上提高应用程序性能？

为什么应用程序启动良好并逐渐开始下降，性能机会因错误而崩溃？

是否有任何免费或付费软件可以帮助我确定应用程序可能崩溃的某些点？

在此先感谢大家的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:46:42.870

听起来你可能有内存泄漏。我们使用来自 SciTech 的分析器，它非常好。

[.NET 内存分析器](http://memprofiler.com/)

# character-encoding - 需要帮助确定文本的编码

> ID：13765242
> 
> 赞同：0
> 
> 时间：2012-12-07T14:39:57.760
> 
> 标签：character-encoding

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:32:22.440

So the original string has first been encoded as utf8, then interpreted in iso-8859-1 and then the result again encoded as utf-8\. Solution given in java. Assumes you have the raw byte access, otherwise more code is required to get them.

```
//The underlying bytes are these, based on the characters being displayed in windows-1251

byte[] rawBytes = {(byte)0xc3,(byte)0x90,(byte)0xc2,(byte)0x9f,(byte)0xc3,(byte)0x90,(byte)0xc2,
                    (byte)0xbe,(byte)0xc3,(byte)0x90,(byte)0xc2,(byte)0xbb,(byte)0xc3,(byte)0x90,
                    (byte)0xc2,(byte)0xbd,(byte)0xc3,(byte)0x91,(byte)0xc2,(byte)0x8b,(byte)0xc3,
                    (byte)0x90,(byte)0xc2,(byte)0xb9,(byte)0x20,(byte)0xc3,(byte)0x90,(byte)0xc2,
                    (byte)0xba,(byte)0xc3,(byte)0x90,(byte)0xc2,(byte)0xb0,(byte)0xc3,(byte)0x90,
                    (byte)0xc2,(byte)0xb4,(byte)0xc3,(byte)0x91,(byte)0xc2,(byte)0x80};

//alternatively this will work just as well:
//Charset windows1251 = Charset.forName("Windows-1251");
//byte[] rawBytes = windows1251.encode("ГђВџГђВѕГђВ»ГђВЅГ‘В‹ГђВ№ ГђВєГђВ°ГђВґГ‘ВЂ").array();

Charset utf8 = Charset.forName("utf-8");
String asUTF8 = utf8.decode(ByteBuffer.wrap(rawBytes)).toString();

//Intermediate step required to convert the intermediate string
//to byte[] again. Iso-8859-1 is used because it maps 256 first 
//unicode points exactly to byte values of 0-255

Charset iso88591 = Charset.forName( "ISO-8859-1");
byte[] bytes = iso88591.encode(asUTF8).array();

String finalResult = utf8.decode( ByteBuffer.wrap(bytes)).toString();
System.out.println(finalResult);
//Полный кадр 
```

# class - Windows CE6下使用CImage加载JPG、BMP、GIF和PNG？

> ID：13765243
> 
> 赞同：0
> 
> 时间：2012-12-07T14:39:58.767
> 
> 标签：class, bitmap, load, windows-ce, jpeg

我正在尝试在 Windows CE6 下使用 CImage 加载 JPG 图像。我在网上搜索过，但大多数都使用如下所述的功能（但该功能本身对 CE 用户禁用）：

```
CImage myImage;

myImage.Load(_T("C:\Image.jpg"));// Not available in windows CE 
```

因为在**atlimage.h**：

```
#ifndef _WIN32_WCE

inline HRESULT CImage::Load( IStream* pStream ) throw()
{
    if( !InitGDIPlus() )
    {
        return( E_FAIL );
    }

    Gdiplus::Bitmap bmSrc( pStream );
    if( bmSrc.GetLastStatus() != Gdiplus::Ok )
    {
        return( E_FAIL );
    }

    return( CreateFromGdiplusBitmap( bmSrc ) );
}

inline HRESULT CImage::Load( LPCTSTR pszFileName ) throw()
{
    if( !InitGDIPlus() )
    {
        return( E_FAIL );
    }

    Gdiplus::Bitmap bmSrc( (CT2W)pszFileName );
    if( bmSrc.GetLastStatus() != Gdiplus::Ok )
    {
        return( E_FAIL );
    }

    return( CreateFromGdiplusBitmap( bmSrc ) );
} 
```

是否有任何其他替代方法可以使用 CImage 或其他任何方式加载 jpg/bmp/gif/png 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-03T22:48:34.470

尽管这是一个旧帖子，但我最近也在寻找这个，所以我想我会更新它。

Windows Ce 6 支持 IImagingFactory。使用起来很痛苦，但它可以工作，你可以从磁盘或内存中加载 png 或位图。

[CE 5.0 的 Microsoft 文档](https://msdn.microsoft.com/en-us/library/aa452202.aspx)

[微软博客示例](https://blogs.msdn.microsoft.com/mikehall/2008/10/23/ce6-using-imaging-apis-to-loaddisplay-images/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T15:51:18.173

`CImage::Load`在 Windows CE 中的 MFC 下绝对[支持。](http://msdn.microsoft.com/en-US/library/tf4bytf8%28v=vs.80%29.aspx)

您能否澄清“对 CE 用户禁用”是什么意思？

Windows CE 中没有“C”驱动器，因此您的示例代码将无法工作，但没有理由这样的事情不应该：

```
CImage myImage;
myImage.Load(_T("\\My Device\\Image.jpg")); 
```

# bash - 从标准输入读取后如何等待？

> ID：13765245
> 
> 赞同：1
> 
> 时间：2012-12-07T14:40:10.407
> 
> 标签：bash

如果我做类似的事情 `cat myfile | myreader`

cat 将尽可能快地将*myfile*内容逐行发送到标准输出。

**我想逐行发送文件内容，但在每行之后“休眠”一段时间。**

你们有谁知道如何做到这一点？

我知道可以在*myreader*中等待，但这不是问题。修改程序读取标准输入并不总是可能的，或者在我的情况下它是不可取的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:46:54.210

你可以这样做：

```
$ cat myfile|while read line; do echo $line; sleep 1; done|./myreader 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:25:54.920

这可以通过以下方式完成：

```
while read line
do
    echo "$line"
done <<< myfile | ./myreader 
```

但是，你为什么要这样呢？闻起来像你想使用[`script`](http://unixhelp.ed.ac.uk/CGI/man-cgi?script)或类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:52:42.693

你可以让 awk 在行之间插入一个暂停：

```
cat myfile | awk '{print $0;system("sleep 2")}' | myreader 
```

或者更好（避免UUOC）：

```
awk '{print $0;system("sleep 2")}' myfile | myreader 
```

# sql - SQL Count() 和 GROUP BY

> ID：13765255
> 
> 赞同：0
> 
> 时间：2012-12-07T14:40:42.653
> 
> 标签：sql

我对（简单）SQL 查询有疑问。

背景是，每个`Book`都有一个（或多个）定义`BookLanguages`

该查询返回 9 本书，这是可以的。

```
SELECT b.BookID
FROM Book b
JOIN BookLanguages bls ON b.BookID = bls.BookID
WHERE b.IsActive= 1 
       AND
        bls.BookLanguageID = 25
GROUP BY b.BookID 
```

但是，我必须有符合该标准的总书数（用于分页目的）。

如果我只是运行该查询

```
SELECT COUNT(b.BookID)
FROM Book b
JOIN BookLanguages bls ON b.BookID = bls.BookID
WHERE b.IsActive= 1 
       AND
        bls.BookLanguageID = 25
GROUP BY b.BookID 
```

我得到 9 行，值为 1（这是语言计数，因为当我删除`AND bls.BookLanguageID = 25`条件时，我得到 9 行，值为 1 或 2 - 因为有些书定义了 2 种语言）

所以，关键是 - 如何只获得`9`数字而不是 9 行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:45:40.627

删除组

```
Select
  Count(*)
From
  Book b
    Inner Join
  BookLanguages bls 
    On b.BookID = bls.BookID
Where
  b.IsActive= 1 And
  bls.BookLanguageID = 25 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:42:28.053

尝试使用`DISTINCT`和否`GROUP BY`：

```
SELECT COUNT(DISTINCT b.BookID)
FROM Book b
JOIN BookLanguages bls ON b.BookID = bls.BookID
WHERE b.IsActive= 1 
       AND
        bls.BookLanguageID = 25 
```

GROUPing BY Id 为 Id 的每个值返回一行，因此在您的情况下为 9 行。

# spring-mvc - 为什么我看不到 同时使用视图作为范围？

> ID：13765258
> 
> 赞同：0
> 
> 时间：2012-12-07T14:40:58.083
> 
> 标签：spring-mvc, primefaces, scope

伙计们，当我使用视图作为范围时。我无法预览`<p:graphicImage>`。但是如果我使用会话作为范围，我可以查看`<p:graphicImage>`. 为什么 ？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T11:41:36.393

浏览器在另一个连接中获取图像，因此视图范围的 bean 将被多次实例化。图像的 url 也会不同，因此图像不会显示在浏览器中。

将`p:graphicImage`与任何其他范围 IIRC 一起使用。关于这个主题还有很多其他问题，比如这个：[如何在 p:dataTable 中使用 p:graphicImage 和 StreamedContent？](https://stackoverflow.com/questions/8304967/how-to-use-pgraphicimage-with-streamedcontent-within-pdatatable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T08:08:31.897

我使用内联图像来解决这个问题（如果您实时生成图像，这是理想的选择，但如果它们是预先存在的，则这是一个糟糕的选择）。

有关更多信息，请参阅[其他问题](https://stackoverflow.com/questions/4838464/convert-byte-to-base64-string-for-data-uri)。

# java - apache FTPClient在上传时删除FTP上的文件

> ID：13765262
> 
> 赞同：2
> 
> 时间：2012-12-07T14:41:12.623
> 
> 标签：java, apache, ftp

FTPClient (org.apache.commons.net.ftp.FTPClient) 在 FTP 仍在上传时，当另一个客户端使用（删除/移动）文件时挂起。这是我如何上传文件的代码：

```
 ftpClient = getFTPConnection();
    BufferedInputStream buffIn = new BufferedInputStream(inputStream);
    byte[] buffer = new byte[8192];
    OutputStream os = ftpClient.storeFileStream(filename);
    int readCount = 0;
    while ((readCount = buffIn.read(buffer)) > 0) {
        os.write(buffer, 0, readCount);
    }

    os.close();
    buffIn.close();
    inputStream.close();

    ftpClient.completePendingCommand(); //!stuck here!
    ftpClient.rename(filename, "uploadRename.txt");
    ftpClient.logout();
    ftpClient.disconnect(); 
```

当文件在上传时被删除时， os.write 完成它的工作（没关系。）但是在调用 completePendingCommand() 之后程序卡住了。如果我理解这一点，必须完成 ftpClient.completePendingCommand() 才能发出第二个命令，删除它不是解决方案。任何人都知道为什么 ftpClient 挂起？如果 completePendingCommand 没有从 ftp 得到他想要的东西，我只是期待一个错误消息或超时。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T13:42:47.670

我试图重现您的情况，但是当我在上传过程中尝试修改文件时，服务器回复 450 代码并且不允许删除文件。

顺便说一句，由于 Commons-net API 文档有点生硬，您可以在调用之前尝试调用该`ftp.getReplyCode()`方法以找出究竟发生了什么`completePendingCommand()`。

然后，您可以匹配[此表](http://commons.apache.org/proper/commons-net/apidocs/constant-values.html)中的回复代码，并决定如何“切换”回复代码。

# javascript - 如何通过 DOM 设置带有 !important 标志的 CSS 属性？

> ID：13765266
> 
> 赞同：7
> 
> 时间：2012-12-07T14:41:32.000
> 
> 标签：javascript, css, dom

因此，在我的样式表中，我有一个匹配`myElement`使用`!important`标志的规则中的属性。

然后，在脚本中，我需要调整`myElement`. 我正在使用的代码什么都不做：

```
var myElement = document.getElementById('myElement');
myElement.style.property = 'newValue'; 
```

这让我陷入了一个循环，因为虽然我的页面上没有明显发生任何事情，但该元素甚至在 Chrome 的元素检查器中的 element.style 下显示了新的属性值。所以我花了一段时间才弄明白，但后来我突然想到我还必须把`!important`标志放在`newValue`设置中。 **有谁知道如何以编程方式做到这一点？**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-07T14:47:37.700

干得好：

```
myElement.style.setProperty( 'property', 'newValue', 'important' ); 
```

**现场演示：http:** [//jsfiddle.net/mJHEf/](http://jsfiddle.net/mJHEf/)

# objective-c - 使用 TFHpple/hpple (IOS) 从 HTML 页面解析部分

> ID：13765268
> 
> 赞同：0
> 
> 时间：2012-12-07T14:41:42.727
> 
> 标签：objective-c, ios, xml-parsing, html-parsing, hpple

我正在加载整个 HTML 页面，并希望获取特定标签之间的所有内容。为此，我正在做：

```
articleXpathQueryString = @"//article/div[@class='entry breadtext']";
articleNodes = [articleParser searchWithXPathQuery:articleXpathQueryString];
item.content = [self recursiveHTMLIterator:articleNodes content:@""]; 
```

然后我有一个递归函数，它试图总结所有子节点的内容以及它们的 HTML 标签：

```
-(NSString*) recursiveHTMLIterator:(NSArray*)elementArray content:(NSString*)content {
for(TFHppleElement *element in elementArray) {
    if(![element hasChildren]) {
        //The element has no children
    } else {
        //The element has children
        NSString *tmpStr = [[element firstChild] content];

        if(tmpStr != nil) {
            NSString *css = [element tagName];
            content = [content stringByAppendingString:[self createOpenTag:css]];
            content = [content stringByAppendingString:tmpStr];
            content = [content stringByAppendingString:[self createCloseTag:css]];
        }

        NSString *missingStr = [[element firstTextChild] content];
        if(![missingStr isEqualToString:tmpStr]) {
            if(missingStr != nil) {
                NSString *css= [element tagName];
                content = [content stringByAppendingString:[self createOpenTag:css]];
                content = [content stringByAppendingString:missingStr];
                content = [content stringByAppendingString:[self createCloseTag:css]];
            }
        }

        content = [self recursiveHTMLIterator:element.children content:content];
    }
}
return content;
} 
```

但是，即使结果在某种程度上令人满意，它也不会获取 img 标签，并且当 HTML 具有以下格式时会有点混乱：

```
<p>
<strong>-</strong>
This text is not parsed because it skips it after it acquires <strong>-</strong>, this is why I have the second if-statement which catches up "missing strings", but they are inserted in the wrong order
</p> 
```

所以我的问题是，我应该继续尝试让递归方法正确解析，还是有更简单的方法来获取所需的 HTML（然后我在 web 视图中使用）。我正在寻找的是所有内容

```
<article> THIS </article>. 
```

换句话说，我想用 TFHpple 做这样的事情（尽管代码不起作用）：

```
articleXpathQueryString = @"//article/div[@class='entry breadtext']";
articleNodes = [articleParser searchWithXPathQuery:articleXpathQueryString];
item.content = [articleParser allContentAsString];    //I simply want everything in articleParser in a string format 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:19:10.103

好的，我终于想通了......如果有人像我一样愚蠢，我希望这会有所帮助：

所需要做的就是将 URL 加载到 webview 中，然后简单地执行一个简单的 javascript 查询，如下所示（在 webViewDidFinishLoad 中）：

```
NSString *bread_text = [webView stringByEvaluatingJavaScriptFromString:@"document.getElementsByClassName('entry breadtext')[0].innerHTML"]; 
```

获取知名课程中的所有内容。现在我需要弄清楚如何在不首先显示 webview 的情况下加载它，但这似乎比遍历 XML 结构容易得多:)

# python - 使用 lxml.etree 作为 ET 从 api 响应中获取文本

> ID：13765269
> 
> 赞同：1
> 
> 时间：2012-12-07T14:41:46.890
> 
> 标签：python, lxml

需要从亚马逊回复中获取文本。我认为我遇到的麻烦是找到属性的正确路径，或者至少告诉 lxml 如何找到它们。理想情况下，我想要每个项目所需属性的列表或字典。我在 stackoverflow 上找到了一个线程[如何使用 lxml 来获取 XML 文档的特定部分？](https://stackoverflow.com/questions/4456421/how-to-use-lxml-to-grab-specific-parts-of-an-xml-document/4468564#4468564)我没有开始工作，得到“NameError：name 'item' is not defined”。我尝试将“item = {}”移出循环，结果为空字典和无。此外，当我打印 t 时，我得到“Element { [http://webservices.amazon.com/AWSECommerceService/2011-08-01](http://webservices.amazon.com/AWSECommerceService/2011-08-01) }ItemSearchResponse at 0x1032a30”，而不是 ElementTree 对象，不确定这是问题的一部分。

所以我的问题是，我如何让这个工作，当我这样做时，我如何遍历“项目”中的所有“项目”，以便我获得所有返回产品的所需属性？（或者列表字典可能是最好的解决方案）。这是我正在查看的示例 xml 响应的链接[https://www.box.com/s/qt2kr0h4nrig68u9w07j](https://www.box.com/s/qt2kr0h4nrig68u9w07j)，如果有帮助，我可以提供整个响应的链接。下面是得到错误的python代码，实际上只是上面提到的线程的副本。由于正在使用模块，我“仅限于”使用 lxml 进行解析。

更新：链接到原始（和完整的）xml。[https://www.box.com/s/2yb1ge6rxvmzshw4pj3f](https://www.box.com/s/2yb1ge6rxvmzshw4pj3f)

```
 import bottlenose
    from lxml import etree
    import lxml.etree as ET
    from pprint import pprint as pp

    t = ET.fromstring(response)
    AMAZON_NS = "{http://webservices.amazon.com/AWSECommerceService/2011-08-01}"
    TAGPOS = len(AMAZON_NS) # Find all ItemAttributes elements.
    for ia in t.iter(AMAZON_NS+'ItemAttributes'):
        item = {}
    # Iterate over all the children of the ItemAttributes node
        for elem in ia:
            # remove namespace stuff from key, remove extraneous whitepace from value
            item[elem.tag[TAGPOS:]] = elem.text.strip()
    print pp(item) 
```

# c++ - 除以 2 和字节操作 C++

> ID：13765273
> 
> 赞同：0
> 
> 时间：2012-12-07T14:42:04.933
> 
> 标签：c++, bit, division, cpu-registers

我知道将数字除以 2 的最佳方法是向左移动一位。如果我除以 2 的倍数（例如 8）我该怎么办，我是否移动了 3 位，这是我的问题：

1.  如何在 C++ 中进行此类操作，位移动？
2.  如果我想交换它们的值，如何访问 int 的高字节和 int 的低字节？

我知道这些操作可以在汇编级别完成，因为我们正在处理寄存器，我只是不知道我们是否可以在 C++ 中访问这些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:47:50.177

访问整数的高/低字节并交换它们*至少*可以通过两种方式完成。`>>`和的组合`|`，或与`union`.

例如：

```
short swapped = (original<<8)|(original>>8); 
```

将为您提供交换的 2 字节整数的两个字节。如果您有一个更大的整数（例如 4 个字节），则需要更多的屏蔽和移位，如果所有字节都需要以某种特别洗牌的顺序。

使用右移 ( ) 优化除以 2 的倍数`>>`是非优化。您应该编写可读的代码，清楚地了解其意图。编译器将轻松执行此类微优化。

# html - 使用ajax填充html li

> ID：13765274
> 
> 赞同：0
> 
> 时间：2012-12-07T14:42:05.290
> 
> 标签：html, ajax

我目前有一个应部分由 AJAX 调用填充的项目列表。是）我有的：

```
<li>Hello, username</li> 
```

AJAX 调用从数据库中提取用户名。`li`那么，既然标签中的任何内容都是纯文本，那么如何附加拉取的信息以将其显示在“Hello”旁边？

阿贾克斯：

```
ajax({
    type: "GET"
    url: '../info
    success: function (data){
        if (data != ''){
            var user = info.username;
       }
    } 
}) 
```

如何将变量 user 放入列表项标签中？你能做类似的事情吗

```
<li>Hello, "$user"</li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:51:06.530

如果您可以将您的项目格式化为`<li>Hello, <span id = "username">username</span>`，它将使您的生活更轻松。

然后你可以做这样的事情：

```
if (data != ''){
  var user = info.username;
  $('#username').html(user);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:52:25.610

你的 AJAX 请求真的返回一个 JavaScript 对象吗？我怀疑它实际上返回 JSON，所以你需要对其进行解码：

```
$.ajax({
    type: "GET",
    url: '../info',
    success: function(data) {
        if(data != '')
        {
            var info = $.parseJSON(data),
                user = info.username;
            $('li').text('Hello, '+user);
        }
    } 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:02:36.297

首先，放置一个具有用户名占位符的容器可能更容易，

```
<li>Hello, <span id="username">username</span></li> 
```

然后，如果您期望 ajax 请求将返回 json 格式的响应，则必须设置`dataType`选项以对其进行解析。

```
ajax({
    type: "GET"
    url: '../info',
    dataType: 'json',
    success: function(data) {
        if(data) {
            $("#username").text(data.username);
        }
    } 
}); 
```

如果用户名直接作为文本返回：

```
success: function(data) {
    if(data != '') {
        $("#username").text(data);
    }
} 
```

# c++ - C++ 谷歌协议缓冲区。RPC怎么做？

> ID：13765275
> 
> 赞同：4
> 
> 时间：2012-12-07T14:42:11.687
> 
> 标签：c++, rpc

我已经按照 3 个关于 google RPC 的教程尝试了 3 个不同的来源。而且总是同样的问题。我无法让它工作。我现在非常接近，我正在使用[protoserv](http://code.google.com/p/protoserv/)。我现在遇到的问题是在他们的教程中说：

```
int main(int argc, char* argv[]) {
   EchoServiceImpl echo_service;
   RpcManager rpcman;
   ... 
```

我找不到如何访问 RpcManager 以及它的位置。我对 protobuf 和 protoserv 目录进行了 grep 操作，但无济于事。.java 包中只有 RpcManager。也许它只是一个不支持的版本，即使它有 C++ 中的示例。

任何帮助将不胜感激。即使是一个稳定/简单的 C++ protobuf 实现的链接也会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-17T16:58:32.857

对于这个问题，我的回答会很晚，但它对于理解/实现 Protobuf RPC 系统很有用。

有关如何构建处理原始请求和响应的 HTTP 服务器，请查看[pbrpc](https://github.com/madwyn/pbrpc)。

有关如何处理请求和产生响应（构建 RPC 系统），请查看[libpbrpc](https://github.com/madwyn/libpbrpc)。

每个项目只包含几个源文件，它们不会花很长时间阅读。

# c++ - 静态常量 std::vector

> ID：13765278
> 
> 赞同：3
> 
> 时间：2012-12-07T14:42:19.683
> 
> 标签：c++, static, constants, private-members

我正在用 Qt 编写一个图像查看器。我正在尝试在头文件中执行以下操作：

```
class ImageModel
{

private:
    const static std::vector<int> mZoomLevels;

} 
```

在源文件中：

```
int zooms[] = {1,2,3,4,5,6,7,8,9,10};
const std::vector<int> mZoomLevels(zooms.begin(),zooms.end()); 
```

但是我收到以下错误：

> 在非类类型“int [10]”的缩放中请求成员“开始” 在非类类型“int [10]”的缩放中请求成员“结束”

有谁知道如何初始化这个静态常量私有成员？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T14:44:21.067

普通数组没有成员函数。我相信你正在寻找这个：

```
int zooms[] = {1,2,3,4,5,6,7,8,9,10};
const std::vector ImageModel::mZoomLevels(zooms, zooms + 10); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T14:44:28.647

数组没有`begin`和`end`成员。您可以使用数组名称`begin`和数组名称加上长度作为结尾：

```
const std::vector mZoomLevels(zooms, zooms+10); 
```

在 C++11 中，您可以使用[`std::begin`](http://en.cppreference.com/w/cpp/iterator/begin)and [`std::end`](http://en.cppreference.com/w/cpp/iterator/end)，如下所示：

```
const std::vector mZoomLevels(std::begin(zooms), std::end(zooms)); 
```

在这两种情况下，最好将`zooms`数组文件声明为静态或将其隐藏在命名空间中，以确保其名称不会“污染”全局命名空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T14:45:56.103

zooms 是一个 C 风格的数组，没有成员和方法，也就是说`zooms.begin`，`zooms.end`没有任何意义。如果您使用与 C++11 兼容的编译器，请`std::begin(zooms)`尝试`std::end(zooms)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T14:48:23.633

普通 C++ 数组不能有成员。但是，您正在寻找静态分派，并且可以通过参数类型进行重载解析。所以 C++11 提供了`std::begin`非`std::end`成员函数。（这已经提到过。）

习惯如下调用非成员函数的最佳实践（这对您编写通用模板代码很有帮助）：

```
using std::begin;
using std::end;

const std::vector mZoomLevels(begin(zooms), end(zooms)); 
```

无论容器是什么类型，这都能正常工作，并且如果有一些自定义类类型`zooms`，它将利用 ADL（依赖于参数的查找，有时称为 Koenig 查找）来查找相同命名空间中的实现。`begin``end``zooms`

顺便说一句，`std::begin`由`std::end`C++11 提供，但您可以轻松地为早期版本编写自己的代码：

```
template <typename T, size_t N>
T* begin( T (&a)[N] ) { return a; }

template <typename T, size_t N>
T* end( T (&a)[N] ) { return a + N; } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T15:00:56.563

根据您是否可以访问 C++11，我将在此处采用不同的方法。

在 C++03 中，我会使用一个普通数组（因为它是 const），甚至可能不在类中，而是在实现文件中的私有命名空间中（因为它是私有的，假设只有一个翻译单元具有的成员的定义`ImageModel`。

```
// cpp
namespace {
   static int gZoomLevels[] = { 1, 2, ... };
} 
```

如果您真的想继续使用该`std::vector<int>`方法，我将在定义成员的翻译单元中创建一个辅助函数并使用它来创建`std::vector`，而无需创建具有静态持续时间的不同变量：

```
namespace {
   static std::vector<int> chooseANameForInitializer() {
       int data[] = { 1, 2, 3 };
       return std::vector<int>( data, data + (sizeof data/sizeof *data) );
   }
}
const std::vector<int> ImageModel::mZoomLevels = chooseANameForInitializer(); 
```

在 C++11 中我会`std::array<int,...>`改用，因为这样可以避免动态分配和额外间接的成本。当然，这不是一个很大的收获，但是`std::vector<int>`当您不需要它提供的任何功能时，没有任何意义。

```
class ImageModel
{
private:
    static const std::array<int,10> mZoomLevels;  
};
// cpp:
const std::array<int,10> ImageModel::mZoomLevels = { 1, 2, 3, 4, 5, 6, 7, 8, 9 }; 
```

同样，如果您坚持使用`std::vector<int>`then 您可以使用*list-initialization*

```
const std::vector<int> ImageModel::mZoomLevels{ 1, 2, 3, 4, 5, 6, 7, 8, 9 }; 
```

# objective-c - 如何设置地图的初始缩放级别？

> ID：13765282
> 
> 赞同：0
> 
> 时间：2012-12-07T14:42:29.413
> 
> 标签：objective-c, rubymotion

我正在使用 Rubymotion 构建一个 iOS 应用程序。在这个应用程序中，我得到了一个地图视图。我可以很好地显示这个，但我想为注释区域设置一个初始缩放级别，而不是一个完全缩小的视图。我怎样才能做到这一点？

这是我的代码：

```
map = MKMapView.alloc.initWithFrame(CGRectMake(10, 10, (hash[:width]-20), (hash[:height]-20)))
    map.mapType = MKMapTypeStandard
    map.delegate = self
    map.showsUserLocation = true
    map.setCenterCoordinate(location, animated:true)
    map.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:30:45.167

您可以使用结构的`longitudeDelta`和`latitudeDelta`字段`MKCoordinateSpan`：

```
MKCoordinateSpan span; span.latitudeDelta = .001;
span.longitudeDelta = .001;
//the .001 here represents the actual height and width delta
MKCoordinateRegion region;
region.center = newLocation.coordinate; region.span = span;
[mapView setRegion:region animated:TRUE]; 
```

当然，您可以将跨度存储为例如默认缩放级别。

这是文档所说的：

"**地图显示的区域由 region 属性定义，它是一个 MKCoordinateRegion 类型的结构。MKCoordinateRegion 结构包含一个名为 center 的成员（类型为 CLLocationCoordinate2D）和另一个名为 span 的成员（类型为 MKCoordinateSpan）。MKCoordinateSpan 结构反过来又包含两个成员：latitudeDelta 和 longitudeDelta（都是 CLLocationDegrees 类型，它是双精度型）两个成员都定义了要为地图显示的距离量*：

➤ *latitudeDelta — 一个纬度大约是 111 公里（69 英里）*。

➤ *longitudeDelta — 1 度经度在赤道处跨越大约 111 公里（69 英里）的距离，但在两极缩小到 0 公里。在放大和缩小地图时检查这两个结构的值——它们是地图缩放级别的表示。*"

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:54:24.660

如果要相对于用户的位置进行缩放，请尝试以下操作：

```
MKUserLocation *userLocation = map.userLocation;
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance (userLocation.location.coordinate, 50, 50);
[map setRegion:region animated:NO]; 
```

# html - 使用 HTML mailto 向多个接收者发送邮件

> ID：13765286
> 
> 赞同：58
> 
> 时间：2012-12-07T14:42:38.943
> 
> 标签：html

> **可能重复：**
> [使用 html Mailto 向多个收件人发送电子邮件：不起作用](https://stackoverflow.com/questions/9278363/emailing-to-multiple-recipients-with-html-mailto-not-working)

我想用 1 个 HTML 链接向多个 (100) 接收者发送邮件...

```
<a href="mailto:first@mail.com; second@mail.com; third@mail.com">Send</a> 
```

这个链接失效了。当我按下链接时它什么也不做。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-12-07T14:45:52.810

> “没有通过 HTML 将多个收件人分配给单个 mailto: 链接的安全方法。有安全的非 HTML 方法从一个 mailto: 链接分配多个收件人。”

[http://www.sightspecific.com/~mosh/www_faq/multrec.html](https://web.archive.org/web/20151116223616/http://www.sightspecific.com/~mosh/WWW_FAQ/multrec.html)

为了快速解决您的问题，请将您更改`;`为逗号`,`并消除电子邮件地址之间的空格

```
<a href='mailto:person1@domain.com,person2@domain.com'>Email Us</a> 
```

# file-io - Excel 2010 VBA。需要一个对话框来定位文本文件名但不打开

> ID：13765295
> 
> 赞同：0
> 
> 时间：2012-12-07T14:42:54.747
> 
> 标签：file-io, excel-2010

我正在寻找一种方法来使用 Excel 2010 VBA 中的 Windows 对话框，以便用户可以浏览文本文件。

一旦找到，选择将返回文件名，以便它可以用于将文件作为字符串读入内存。

我不想将它直接读入工作簿，因为我需要使用 mid$ 等处理文件并将每个字符依次放入工作表单元格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:10:12.640

试试这个：

```
With Application.FileDialog(msoFileDialogFilePicker)
    .Filters.Add "Text files", "*.txt"
    .Show

    For Each Filename In .SelectedItems
        MsgBox Filename
    Next
End With 
```

# asp.net-mvc-4 - 解决 Bind 中的单例 ().ToMethod

> ID：13765301
> 
> 赞同：5
> 
> 时间：2012-12-07T14:43:15.540
> 
> 标签：asp.net-mvc-4, ninject

什么是此代码的 Ninject 3 等效项：

```
Bind<ISession>().ToMethod(ctx => ctx.Kernel.Get<INHibernateSessionFactoryBuilder>()
            .GetSessionFactory()
            .OpenSession())
            .Using<OnePerRequestBehavior>(); 
```

我知道我可以使用`InRequestScope`，`Using<OnePerRequestBehavior>`但如何替换`ctx.Kernel.Get<INHibernateSessionFactoryBuilder>`？（`INHibernateSessionFactoryBuilder`是单例）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:48:15.043

好的，只是为了澄清 - 因为这是在模块中，您仍然可以访问`ctx.Kernel.Get<T>`，但您也需要将 a 添加`using Ninject;`到模块中，因为`Kernel.Get<T>`它作为扩展方法公开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:23:10.333

好的，这是对我有用的最终代码：

```
using Infrastructure.Data;
using NHibernate;
using Ninject;
using Ninject.Modules;
using Ninject.Web.Common;

namespace Infrastructure.DependencyResolution
{
    public class SessionModule : NinjectModule
    {
        public override void Load()
        {
            Bind<INHibernateSessionFactoryBuilder>().To<NHibernateSessionFactoryBuilder>().InSingletonScope();

            Bind<ISession>().ToMethod(ctx => ctx.Kernel.Get<INHibernateSessionFactoryBuilder>()
                .GetSessionFactory()
                .OpenSession())
                .InRequestScope();      
        }
    }
} 
```

使用这个加载了 Ninject 引导程序的模块，我可以在 NHibernate 会话中使用存储库，而无需在 Web 项目中引用 NH...

# java - 删除重复的 JFrame

> ID：13765302
> 
> 赞同：1
> 
> 时间：2012-12-07T14:43:19.427
> 
> 标签：java, swing, user-interface, jframe, multiple-instances

我有一个 JFrame，上面有一个 JButton。单击 JButton 时，它将创建一个新框架，因此有两个可见框架。我想要的是，当我再次单击 JButton 时，而不是创建一个新的 JFrame 它只是将旧框架带到前面。

如何检查是否只会创建一个新框架？还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:50:17.283

> 那么我该如何进行检查，以便框架已经打开，没有重复，或者还有其他方法吗？

*   创建两个[JFrame](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)或一堆`JFrame`s 不是好主意，这是通往麻烦的道路

*   请参阅[Oracles 教程 How to Use CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)，[本论坛上的一些问答](https://stackoverflow.com/questions/tagged/java+swing+cardlayout)

*   在您需要另一个弹出窗口的情况下（真实和重要的原因），然后使用[JDialog 或 JOptionPane](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)，[JDialog with `setModal()`/ `ModalityTypes`and with parent to`JFrame`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JDialog.html#JDialog%28java.awt.Dialog,%20boolean%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:16:51.360

最简单的方法是获取按钮或按钮的父级来跟踪是否已创建新框架。最好的方法是保留对框架的引用。

例如。

```
public class MyGUI {

    private JFrame primaryFrame;
    private JFrame secondFrame;
    private JButton someButton;

    public void setupAndDisplay() {
        // initialise the button
        someButton = new JButton("some button");
        someButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                someButtonAction();
            }
        });

        // initialise primary JFrame
        primaryFrame = new JFrame("first frame");
        primaryFrame.add(someButton);
        primaryFrame.setVisible(true);
    }

    // Like most swing stuff this method is not thread safe, as it expects to 
    // only be called on the EventDispatchThread.
    private void someButtonAction() {
        if (secondFrame == null) { // no frame created yet, so create a new one
            secondFrame = new JFrame("second frame");
            secondFrame.setVisible(true);
        } else { // already have a frame, so bring it to the front
            secondFrame.toFront(); 
        }
    }
} 
```

这可能不是做事的最佳方式。如果您尝试做一些非常简单的事情，比如对话窗口，那么 API 很可能有更简单的方法来帮助您。因此，在选择这条道路之前，您应该探索您的选择并考虑您需要做什么。

注意。我没有测试过这段代码，它只是为了说明目的，向您展示如何设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:51:40.847

```
boolean hasWindow = false;

if(hasWindow){
// show existing window
hasWindow = true;
} else {
// create a new window
hasWindow = true;
} 
```

沿着这些思路。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-07T14:45:07.317

您将可见设置为 false 仅此而已

# api - Node.js 代理能够更改响应标头并注入额外的请求数据

> ID：13765304
> 
> 赞同：6
> 
> 时间：2012-12-07T14:43:30.490
> 
> 标签：api, node.js, node-http-proxy

我正在编写一个 node.js 代理服务器，为不同域上的 API 提供请求。

我想使用[node-http-proxy](https://github.com/nodejitsu/node-http-proxy)并且我已经找到[了修改响应标头的方法](https://stackoverflow.com/questions/12755865/rewrite-response-headers-with-node-http-proxy)。

但是有没有办法根据条件修改请求数据（即添加 API 密钥）并考虑到可能有不同的方法 request - `GET`, `POST`, `UPDATE`, `DELETE`？

或者，也许我搞乱了[node-http-proxy](https://github.com/nodejitsu/node-http-proxy)的目的，而有什么更适合我的目的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:53:15.923

一种使其变得非常简单的方法是使用中间件。

```
var http = require('http'),
    httpProxy = require('http-proxy');

var apiKeyMiddleware = function (apiKey) {
  return function (request, response, next) {
    // Here you check something about the request. Silly example:
    if (request.headers['content-type'] === 'application/x-www-form-urlencoded') {
        // and now you can add things to the headers, querystring, etc.
        request.headers.apiKey = apiKey;
    }
    next();
  };
};

// use 'abc123' for API key middleware
// listen on port 8000
// forward the requests to 192.168.0.12 on port 3000
httpProxy.createServer(apiKeyMiddleware('abc123'), 3000, '192.168.0.12').listen(8000); 
```

有关更多详细信息以及有关该方法的一些注意事项，请参阅[Node-HTTP-Proxy、Middlewares 和 You 。](http://blog.nodejitsu.com/http-proxy-middlewares)

# c# - WPF Datagrid 绑定错误，列标题中带有点

> ID：13765308
> 
> 赞同：3
> 
> 时间：2012-12-07T14:43:45.693
> 
> 标签：c#, wpf, data-binding

我有一个 .Net 数据表，用作 WPF 数据网格的源。我遇到的问题是数据表中的某些列标题包含点。将数据表绑定到数据网格时，会显示包含点的列，但不包含数据。

在网上阅读后，我发现这些点是数据绑定引擎中使用的一种特殊符号，并且混淆了数据网格与表的绑定。

我尝试手动创建数据网格列+绑定并添加方括号来否定点。这工作正常，但是当我对列进行排序时会中断。[本文](https://stackoverflow.com/questions/6868088/dot-in-binding-path-in-wpf-causes-issue) 提到挂钩到排序事件以删除排序事件上的 []。关于如何实现这一点并没有太多细节，我所做的尝试似乎并没有消除错误。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:28:46.670

`Binding`正如您所发现的那样，除了WPF之外的任何其他内容的点表示法都是有问题的。我建议修改您的标题以使用点表示法对列名进行别名：

```
Col.A should be Col_A
Col.B should be Col_B
etc... 
```

如果标头来自直接 SQL 查询，则以相同方式为 sql 列名设置别名。

沿着使用点符号的道路前进，只会继续导致一个骇人听闻的修复来解决以前的“修复”。只需修改您的命名约定，所有这些都可以轻松解决。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-05T06:44:01.327

[Magnus Montin](https://social.msdn.microsoft.com/profile/magnus%20(mm8)/?ws=usercard-mini)[在 Microsot WPF 论坛](https://social.msdn.microsoft.com/Forums/vstudio/en-US/f5f752f6-f08d-4d46-9e1e-78a4496eaf12/why-does-not-datagrid-show-values-if-there-are-a-point-or-in-header-of-column?forum=wpf&prof=required)上解决了这个问题：

> `AutoGeneratedColumns`在现实世界的场景中很少有用。但您也可以处理该`AutoGeneratingColumn`事件：

```
<DataGrid Name="dataGrid" AutoGenerateColumns="True" AutoGeneratingColumn="dataGrid_AutoGeneratingColumn" />

 private void dataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
 {
    e.Column = new DataGridTextColumn() { Header = e.PropertyName, Binding = new Binding("[" + e.PropertyName + "]") };
 } 
```

> 反正这种视图相关的代码肯定是属于视图的。视图模型不知道也不关心 DataGrid 控件由于某种原因无法显示实际数据的事实。这必须并且应该在视图中修复。

*它就像一个魅力！我的示例开始起作用：*

**XAML：**

```
<DataGrid ColumnWidth="35" ItemsSource="{Binding EmployeeDataTable, 
    IsAsync=True}" VirtualizingStackPanel.IsVirtualizing="true" 
    EnableRowVirtualization="True" EnableColumnVirtualization="True"
    MaxWidth="2560" MaxHeight="1600"  
    VirtualizingStackPanel.VirtualizationMode="Recycling" 
    VirtualizingPanel.IsVirtualizingWhenGrouping="True"/> 
```

**后面的代码：**

```
private void DataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
   e.Column = new DataGridTextColumn() { 
       Header = e.PropertyName, 
       SortMemberPath = e.PropertyName, //To allow for sorting on a column 
       Binding = new Binding("[" + e.PropertyName + "]") 
   };
} 
```

**视图模型**：

```
private DataTable employeeDataTable;

public DataTable EmployeeDataTable
{
   get { return employeeDataTable; }
   set
   {
      employeeDataTable = value;
      OnPropertyChanged("EmployeeDataTable");
   }
}

private void PopulateDataTable()
{
    var _ds = new DataSet("Test");
    employeeDataTable = new DataTable();
    employeeDataTable = _ds.Tables.Add("DT");
    for (int i = 0; i < 800; i++)
    {
       if(i%2==0)
           employeeDataTable.Columns.Add(i.ToString() + ".");
       else
           employeeDataTable.Columns.Add(i.ToString() + "/");
    }
    for (int i = 0; i < 2; i++)
    {
       var theRow = employeeDataTable.NewRow();
       for (int j = 0; j < 800; j++)
       {
          if (j % 2 == 0)
          {
            //theRow[j] = j.ToString();
            theRow[j] = "a";
          }
          else
            theRow[j] = CreateDoubleValue(j).ToString();
     }
    employeeDataTable.Rows.Add(theRow);
    }
} 
```

# windows - 通过任务计划程序在 Windows Server 2008 上运行批处理 exe 时如何关闭命令提示符？

> ID：13765310
> 
> 赞同：0
> 
> 时间：2012-12-07T14:43:54.793
> 
> 标签：windows, batch-file, command, scheduled-tasks, windows-server-2008-r2

我想知道在使用 Windows 任务调度程序运行控制台批处理应用程序（exe）时是否可以停止显示出现的命令。可以不显示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:03:46.883

您可以使用 VBScript 来运行隐藏的批处理文件

```
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run("yourbatchfile.bat"), 0, True 
```

将其另存为`.vbs`并从计划任务而不是批处理文件运行它。

# list - 如果 list 只有偶数且 foldr 则返回 true

> ID：13765311
> 
> 赞同：1
> 
> 时间：2012-12-07T14:43:56.810
> 
> 标签：list, haskell

我想要一个函数来检查列表是否只包含偶数；如果是，它应该返回`True`，否则 - `False`。

我想使用的函数是`map`// `filter`，`foldr`可能没有`length`.

这是我的尝试：

```
ListOfeven :: [Integral] -> Bool
ListOfeven xs = 
  | foldr (+) True filter odd xs < 0 = True
  | otherwise = False 
```

我很确定有一种更清洁的方法..不是吗？:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T14:46:20.670

最简单的方法是使用[`all`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3aall)Prelude 中的函数：

```
evenList = all even 
```

如果您坚持只使用[`map`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3amap),[`filter`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3afilter)和[`foldr`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3afoldr)：

```
evenList = foldr (&&) True . map even 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T14:57:06.873

```
myfunc = foldr (\a b -> even a && b) True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:38:01.583

Frerich 的解决方案效果很好，但只需轻轻一点即可优化：

```
evenList :: [Integer] -> Bool
evenList = foldr ((&&) . even) True 
```

这只会在列表中运行一次。这里的函数组合有点奇怪，但在检查它的类型时会变得更加清晰：

```
(&&) . even :: Integral a => a -> Bool -> Bool 
```

的结果`even`，它接受一个参数，然后绑定到`&&`运算符的第一个参数，在此以前缀表示法使用。

# matlab - Matlab imnoise Poisson什么都不做？

> ID：13765312
> 
> 赞同：2
> 
> 时间：2012-12-07T14:43:59.020
> 
> 标签：matlab, image-processing, noise

基本上我有：

```
sourceImage = im2double(imread(srcPath));

noiseImage = imnoise(sourceImage,'poisson'); 
```

问题是 sourceImage 和 noiseImage 看起来都差不多。

确实，如果我这样做

```
norm(sourceImage - noiseImage) 
```

我明白`1.4810e-05`了（这似乎差异太小）

我做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:07:04.453

我相信有两种方法可以处理您的问题，基于对`imnoise`泊松分布的描述（我将其称为`p`）：

1）将描述的图像保持`srcPath`在整数域中

2）手动放大和缩小图像，请参阅[http://www.mathworks.com/matlabcentral/newsreader/view_thread/242444](http://www.mathworks.com/matlabcentral/newsreader/view_thread/242444)

案例 1) 的原因是它`p`不缩放整数值。但是，当使用双打时，`p`假设它们按 1e12 缩放，但您的情况并非如此。打个比方，这就像在 [0, 1] 范围内截断双精度，并期望得到不同于 0 或 1 的整数。

# actionscript-3 - as3奇怪的堆栈溢出发生

> ID：13765314
> 
> 赞同：2
> 
> 时间：2012-12-07T14:44:11.740
> 
> 标签：actionscript-3, scope, stack-overflow, runtime-error

以下*运行时*错误：

> 输出太长，但这是主要思想：
> 
> “ > 范围外错误”
> 
> " > [File_fla::MainTimeline~[O] Object[A] Object[A] *[A] *[A]] {} ()"
> 
> 对每个 abc 字节码重复上一行：pushscope、减法、乘法和 convert_d 等。
> 
> “ > VerifyError：错误 #1023：发生堆栈溢出。”

对于此代码：

```
import flash.geom.Point;
function d(p1:Object, p2:Object):Number
{
   var dx:Number = p2.x - p1.x;
   var dy:Number = p2.y - p1.y;
   // problem here as adding this line solves it -> (dx *= 1;)
   dy *= dy;
   dy += dx;
   return dy;
}
var pt1:Point = new Point(0, 0);
var pt2:Point = new Point(1, 0);
d(pt1, pt2); 
```

我对解决错误不感兴趣，
但知道它为什么会发生：*来自知识渊博的用户的解释。*

**推测：**我猜它可能与流水线中的数据危害有关（在它准备好之前使用 dy ），因为添加上面的注释行可以解决它。

编辑：这张图片显示了一个轻微的代码变体和一个调试模式 swf 的反编译（由 Daniel 在评论中指出）
http://imageshack.us/a/img853/4057/stackoverflowdecompile.jpg

如果问题的根源定位正确，问题就变成**了为什么连续'dup'调用的函数进入无限循环导致堆栈溢出？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:57:22.177

你到底想达到什么目的？ `dy *= dy;`看起来您正在尝试平方 dy ( `dy = dy*dy;`)。

如果您正在编写平方距离函数，这部分看起来很奇怪：`dy += dx;`. 我会这样写：

```
function d(p1:Point, p2:Point):Number
{
   var dx:Number = p2.x - p1.x;
   var dy:Number = p2.y - p1.y;
   return dx*dx+dy*dy;
} 
```

我还没有测试过它是否比使用[Point 的 distance()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Point.html#distance%28%29)方法更快

有点离题，记住`Object`有点慢，你不应该在你的情况下使用它。Bellow是一个非常基本的测试：

```
import flash.utils.*;
import flash.geom.Point;

function d(p1:Point, p2:Point):Number
{
    var dx:Number = p2.x - p1.x;
    var dy:Number = p2.y - p1.y;
    return dx*dx+dy*dy;
}
function d2(p1:Point, p2:Point):Number
{
    var d:Point = p2.subtract(p1);
    return d.x*d.x+d.y*d.y;
}

var p1:Point = new Point();
var p2:Point = new Point(1,0);
var runs:int = 1000000;

var now:int = getTimer();
for(var i:int = 0; i < runs; i++){
   d(p1,p2);    
}
trace(getTimer() - now + " ms");//99ms distanceSquared using typed objects (untyped is~160ms)

now = getTimer();
for(i = 0; i < runs; i++){
   d2(p1,p2);   
}
trace(getTimer() - now + " ms");//689ms distanceSquared using subract and getters - slow

now = getTimer();
for(i = 0; i < runs; i++){
   Point.distance(p1,p2);   
}
trace(getTimer() - now + " ms");//468ms native static method 
```

# javascript - 使用 express.js 打开 HTML 文件

> ID：13765315
> 
> 赞同：4
> 
> 时间：2012-12-07T14:44:11.923
> 
> 标签：javascript, node.js, express

```
var express = require("express");
var fs = require('fs');
var sys = require('sys');

var app = express();
    app.use(express.logger());

app.get('/', function(req, res){
    fs.readFile('/views/index.html');
});

app.listen(8080);
console.log('Express server started'); 
```

我不想使用模板引擎翡翠。如何打开位于我的视图文件夹中的简单 index.html 页面。服务器正在启动，但似乎我无法加载 index.html 页面。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T15:06:56.447

使用 express 3.0.0rc3，以下工作：

```
app.set('views', __dirname + '/views');
app.engine('html', require('ejs').renderFile); 
```

或者

```
app.set("view options", {layout: false});
app.use(express.static(__dirname + '/public')); 
```

所以你的最终代码看起来像这样。

```
var express = require("express");
var fs = require('fs');
var sys = require('sys');

var app = express();
    app.use(express.logger());
    app.set("view options", {layout: false});
    app.use(express.static(__dirname + '/views'));

app.get('/', function(req, res){
    res.render('/views/index.html');
});

app.listen(8080);
console.log('Express server started'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-21T19:37:23.143

您现在可以使用 res.sendfile('index.html')，而不是使用 res.send()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-17T03:29:06.467

```
let express=require('express');
let app=express();

app.get( '/', (req,res)=>{
res.sendFile(__ dirname + "/my.txt");

})
app.listen(4000); 
```

尝试这个。它会正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-02T05:04:40.087

使用 express v4.7.1 并且不使用模板引擎翡翠，这工作正常。

在最新版本中，sendfile() 已更改为 sendFile()。

对于文件路径，服务器会尝试从根目录中查找文件的路径，因此必须指定整个路径或使用“_dirname”，否则总是会遇到文件未找到错误。

```
var express = require("express");
var path = require('path');
var app = express();

app.get('/', function (req, res) {
    res.sendFile(path.join(__dirname + '/views/index.html'))

});

app.listen(8080);
console.log('Express server started'); 
```

希望能帮助到你。快乐编码:)

# .htaccess - 如何使用 htaccess 始终重定向到具有多个域的 https://www.example.com？

> ID：13765317
> 
> 赞同：1
> 
> 时间：2012-12-07T14:44:13.510
> 
> 标签：.htaccess, mod-rewrite, https, multiple-domains

我的`.htaccess`文件中有下一个代码：

```
<IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteBase /

   RewriteCond %{HTTPS} off
   RewriteRule (.*) https://www.example.com%{REQUEST_URI} [R=301,NC,L]

   RewriteCond %{HTTP_HOST} !^(www|subdomain) [NC]
   RewriteRule ^(.*)$ https://www.example.com/$1 [L,R=301]
</IfModule> 
```

使用此代码，以下 URL 将所有人重定向到`https://www.example.com`.

*   `http://example.es`
*   `http://www.example.es`
*   `https://example.es`

但是下一个没有重定向：

```
https://www.mydomain.es 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-11T19:12:12.823

解决了

```
RewriteEngine On

RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L]
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:08:30.910

您在底部第 3 行的条件是：仅将请求重定向到不以`www`或`subdomain`... 开头的主机名，因此`https://www.mydomain.es`不重定向 - 第一个规则未应用（HTTPS 已打开），第二个规则未应用，因为主机名`www.mydomain.es`确实以`www`..开头.

不是很确定，但我想你希望条件是这样的：

```
RewriteCond %{HTTP_HOST} !=www.mydomain.com [NC] 
```

您也可以考虑合并这两个规则（但我不确定您的问题是否显示了您的所有要求）：

```
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP_HOST} !=www.mydomain.com [NC]
RewriteRule .* https://www.mydomain.com%{REQUEST_URI} [L,QSA,R=301] 
```

# list - 来自 (a -> [b]) -> [a -> b] 的 Haskell 函数

> ID：13765324
> 
> 赞同：7
> 
> 时间：2012-12-07T14:44:32.620
> 
> 标签：list, function, haskell

我有这样的`seperateFuncs`功能

```
seperateFuncs :: [a -> b] -> (a -> [b])
seperateFuncs xs = \x -> map ($ x) xs 
```

我想知道是否存在相反的情况，即是否有功能

```
joinFuncs :: (a -> [b]) -> [a -> b] 
```

我认为不是（主要是因为列表不是固定长度的），但也许我会被证明是错误的。那么问题是有一些数据类型`f`具有函数 :: (a -> fb) -> f (a -> b) 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T17:45:10.313

您可以非常干净地概括`seperateFuncs`为`Applicative`（或）：`Monad`

```
seperateFuncs :: (Applicative f) => f (a -> b) -> (a -> f b)
seperateFuncs f x = f <*> pure x 
```

用无点风格写，你有`seperateFuncs = ((. pure) . (<*>))`，所以你基本上想要`unap . (. extract)`，如果你用无点风格写，给出以下定义：

```
joinFuncs :: (Unapplicative f) => (a -> f b) -> f (a -> b)
joinFuncs f = unap f (\ g -> f (extract g)) 
```

这里我定义`Unapplictaive`为：

```
class Functor f => Unapplicactive f where
    extract  :: f a -> a
    unap     :: (f a -> f b) -> f (a -> b) 
```

要获得[leftaroundabout 给出的定义](https://stackoverflow.com/a/13766031/824425)，您可以给出以下实例：

```
instance Unapplicative [] where
    extract = head
    unap f = [\a -> f [a] !! i | i <- [0..]]

instance Unapplicative ((->) c) where
    extract f = f undefined
    unap f = \x y -> f (const y) x 
```

我认为很难`f :: (f a -> f b) -> f (a -> b)`为任何`f`不像`(->)`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T15:26:45.537

首先，你可以暴力破解这个功能：

```
joinFuncs f = [\x -> f x !! i | i<-[0..]] 
```

但这显然很麻烦 - 结果列表始终是无限的，但仅使用 succeds if评估第`i`th 个元素。`x``length(f x) > i`

给出一个“真正”的解决方案

> 那么问题是有一些`f`具有功能的数据类型`:: (a -> f b) -> f (a -> b)`吗？

考虑`(->)c`。这样，您的签名读取`(a -> (c->b)) -> (c->(a->b))`或等效地`(a -> c -> b) -> c -> a -> b`，事实证明，只是`flip`.

当然，这有点微不足道，因为`seperateFuncs`这种类型具有相同的签名......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T18:10:37.590

**“是否有一些数据类型 f 具有函数 :: (a -> fb) -> f (a -> b)？”**

[事实上，在Traversable](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Traversable.html)类型类中还有这个函数的更通用版本，它处理可交换函子：

```
class (Functor t, Foldable t) => Traversable t where

  ... 

  sequenceA :: Applicative f => t (f b) -> f (t b) 
```

这与您的职能有什么关系？从您的类型开始，通过一种类型替换，我们恢复`sequenceA`：

1.  `(a -> f b) -> f (a -> b)` ==> `let t = (->) a`
2.  `t (f b) -> f (t b)`

但是，这种类型具有`t`必须是 Traversable 的约束——并且没有用于 的 Traversable 实例`(->) a`，这意味着通常无法使用函数完成此操作。尽管请注意“其他方向” -`f (a -> b) -> (a -> f b)`适用于所有功能和所有 Applicatives `f`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-07T19:29:11.710

我最近不得不考虑很多与您的问题非常相似的问题。这是我发现的概括。

首先，这样做很简单（Tinctorius 指出）：

```
f2m :: Functor f => f (a -> b) -> a -> f b
f2m f a = fmap ($a) f 
```

但一般来说不可能做到这一点：

```
m2a :: Monad m => (a -> m b) -> m (a -> b) 
```

有人在#haskell irc 频道中向我解释了这一点，一种有见地的理解方式是，如果存在一个函数，那么和`m2a`之间就没有区别。为什么？好吧，我不是 100% 遵循它，但它是这样的：是带有一个参数的非常常见的一元动作类型，而也是非常常见的类型，因为不知道正确的名称，我会调用“适用的应用程序”。可以做不能做的事情的事实与不存在的事实联系在一起。`Applicative``Monad``Monad m => a -> m b``Applicative f => f (a -> b)``Monad``Applicative``m2a`

所以现在，适用于您的问题：

```
joinFuncs :: (a -> [b]) -> [a -> b] 
```

我怀疑同样的“Monad /= Applicative”论点（再次强调，我不完全理解）应该适用于此。我们知道`Monad []`实例可以做实例不能做的事情`Applicative []`。如果您可以`joinFuncs`使用指定类型编写 a ，那么与参数`[a -> b]`相比，结果在某种意义上必须“丢失信息” `a -> [b]`，因为否则`Applicative []`与`Monad []`. （并且“丢失”信息是指任何具有`joinFuncs`' 类型的函数都不能有逆，因此可以保证消除某些函数对之间的区别`f, g :: a -> [b]`。极端情况是`joinFuncs = undefined`。）

我确实发现我需要类似于`m2a` 所以我发现的特殊情况是可以这样做：

```
import Data.Map (Map)
import qualified Data.Map as Map

-- | Enumerate a monadic action within the domain enumerated by the 
-- argument list.
boundedM2a :: Monad m => (a -> m b) -> [a] -> m [(a,b)]
boundedM2a f = mapM f'
    where f' a = do b <- f a
                    return (a, b)

-- | The variant that makes a 'Map' is rather useful.
boundedM2a' :: (Monad m, Ord a) => (a -> m b) -> [a] -> m (Map a b)
boundedM2a' f = liftM Map.fromList . boundedM2a f 
```

请注意，除了我们枚举`a`s 的要求之外，一个有趣的观察是，要做到这一点，我们必须在某种意义上“实现”结果；把它从一个函数/动作变成某种列表、地图或表格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-26T01:31:46.383

问题“我可以使用类型签名的函数`joinFuncs :: (a -> [b]) -> [a -> b]`是不完整的，并且没有说明您希望此函数满足哪些法律。没有法律，您可以通过定义`joinFuncs _ = []`（总是返回一个空列表）来解决这个问题。这个平凡的函数满足所需的类型签名但很可能没用。

要求`joinFuncs`有用的一种方法是强加非退化法则，`separateFuncs . joinFuncs == id`. 然后可以证明不可能实现`joinFuncs`这种类型签名。

这种类型签名的一个更一般的情况是一些函子`(a -> f b) -> f (a -> b)`在哪里。`f`我称这样的函子为“刚性的”。看到这个问题[函子的这个属性比单子强吗？](https://stackoverflow.com/questions/39649497/is-this-property-of-a-functor-stronger-than-a-monad) 更多细节。

所有刚性函子都`R`满足类型`R ()`只有一个不同值的性质，即它等价于`()`。这让我们立即看到`List`函子不是刚性的，因为`List ()`不等价于`()`.

刚性函子最简单的重要示例是`type R a = (a -> p) -> a`where`p`是一个固定类型。`R`以这种方式定义的函子实际上是一个刚性 monad。

# json - “无法在 Google 图表中调用 null 的方法‘Kc’”

> ID：13765326
> 
> 赞同：2
> 
> 时间：2012-12-07T14:44:37.003
> 
> 标签：json

我该如何修复这个错误：

```
Cannot call method 'Kc' of null in Google graph 
```

JSON：

```
{
    "cols": [{
        "label": "name",
        "type": "string"
    }, {
        "label": "id",
        "type": "int"
    }, {
        "label": "quiz_id",
        "type": "int"
    }, {
        "label": "score",
        "type": "int"
    }],
    "rows": [{
        "c": [{
            "v": "kumar"
        }, {
            "v": "40"
        }, {
            "v": "46"
        }, {
            "v": "46"
        }]
    }, {
        "c": [{
            "v": "kumar"
        }, {
            "v": "36"
        }, {
            "v": "46"
        }, {
            "v": "46"
        }]
    }, {
        "c": [{
            "v": "kumar"
        }, {
            "v": "35"
        }, {
            "v": "46"
        }, {
            "v": "46"
        }]
    }, {
        "c": [{
            "v": "kumar"
        }, {
            "v": "10"
        }, {
            "v": "46"
        }, {
            "v": "46"
        }]
    }]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:19:47.413

类型应该是数字而不是 int。

# c# - 为什么我不能在这个 lambda 表达式中使用 OrderBy()？

> ID：13765332
> 
> 赞同：1
> 
> 时间：2012-12-07T14:44:54.477
> 
> 标签：c#, linq, entity-framework, lambda

如何订购以下产品？orderBy 无法识别 x.Name。

```
var xRefsNames = db.CrossRefs.Where(x => pgNos.Contains(x.PG))
.Select(x => x.Name)
.Distinct()
.OrderBy(x=>x.Name); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-07T14:46:21.463

您的选择正在投影一个不同的对象，可能是一个基于名称的字符串。您只想按`x`.

```
var xRefsNames = db.CrossRefs.Where(x => pgNos.Contains(x.PG))
.Select(x => x.Name)
.Distinct()
.OrderBy(x=>x); 
```

# javascript - 将 CSS 附加到头部？

> ID：13765333
> 
> 赞同：0
> 
> 时间：2012-12-07T14:44:55.210
> 
> 标签：javascript, jquery, html, css, class

我想用 jQuery 在 head 标签中添加一些 css 类（而不是像[Jquery add css to head](https://stackoverflow.com/questions/12093509/jquery-add-css-to-head)这样的 css 文件）

我的css类是这样的：

```
#control1 { width:60px; height:55px; background:url(../images/logo1.png) no-repeat; float:left; }
#control1.selected {background:url(../images/logo1_aktiv.png) no-repeat;} 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:49:12.653

您可以使用 将其附加到头部`appendTo()`，然后选择`"head"`

```
$("<style type='text/css'> .boldYellow{color:yellow; font-weight:bold;} </style>").appendTo("head"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:52:58.310

这是您需要做的，将您的样式附加到 head 标签

```
var yourClasses="#control1 { width:60px; height:55px; background:url(../images/logo1.png) no-repeat; float:left; }
#control1.selected {background:url(../images/logo1_aktiv.png) no-repeat;}";

$("document").ready(function(){
    $("head").append("<style type='text/css'>"+yourClasses+"</style>");
}); 
```

# c# - 使用 ASPxGridView 将所选行的单元格的值传递给查询字符串

> ID：13765335
> 
> 赞同：1
> 
> 时间：2012-12-07T14:45:02.703
> 
> 标签：c#, asp.net, devexpress, query-string

我有 2 页，第一页中有一个 ASPxGridview 和一个按钮，第二页有一个 formview，gridview 的列是

```
ID
Name 
```

我进行了选择，以便只能选择一行。当用户选择一行，然后单击按钮时，我希望将该行的 ID 作为查询字符串传递给另一个页面，并在连接到 formsview 的 sqldatasource 的 where 子句中使用它。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T15:05:48.010

请按照以下步骤满足您的要求：（**这是可行的方法，如果您觉得好用的话）**

1.  将自定义按钮添加到 asxpgridview

示例代码：

```
<dx:GridViewCommandColumn VisibleIndex="0" ButtonType="Image" Width="6%" Caption="Action"
    CellStyle-HorizontalAlign="Center" CellStyle-VerticalAlign="Top">
<CustomButtons>
            <dx:GridViewCommandColumnCustomButton  ID="Select" Text="Select">
                    <Image Url="~/images/Select.png" ToolTip="Redirect ">
                                    </Image>                                                                               </dx:GridViewCommandColumnCustomButton>                                              
        </CustomButtons> 
```

2 定义自定义按钮单击aspxgridview的客户端

示例代码：

```
<ClientSideEvents CustomButtonClick="function(s, e) { OnCustomButtonClick(s, e); }" /> 
```

3.在 javascript 中使用以下将 id 传递到另一个页面

示例代码：

```
function OnCustomButtonClick(s, e) {
            switch (e.buttonID) {           
                case "Select":
                    var Url = "NewPageURL.aspx?ID=" + s.GetRowKey(e.visibleIndex) + "";                 
                    window.open(Url, '', '');
                    break
            }

        } 
```

4.不要忘记在 aspxgridview 定义中将 ID 指定为您的 keyfieldname。

如果有任何问题，请随时在这里发帖。

谢谢 ：）

# makefile - Makefile 无法识别目标定义

> ID：13765336
> 
> 赞同：1
> 
> 时间：2012-12-07T14:45:03.747
> 
> 标签：makefile

我正在使用 Dialogic DivaSDK 进行一个项目，以便能够分析电话呼叫。由于 DivaSDK 通过 JNI 支持 Java，我想尝试一下示例。不幸的是：整个 Java 文档不如 C# 完整。所以这似乎就像在浑水里钓鱼一样。在我的第一步中，我想查看示例（[Link to DivaSDK with Sample Files](http://downloads.eicon.com/p/dsapi/linux/11/112-710/download.htm)）文件并尝试一下。每个示例都有一个必须运行的生成文件。手册中唯一涉及我的问题的部分听起来像这样：

> 有关如何编译和链接您的应用程序的详细信息，请查看随 Diva SDK 提供的任何示例。在每个示例子目录中，您都会找到一个 makefile，它描述了该应用程序的编译和链接过程。makefile 的评估需要一些 shell 脚本和 makefile 语法的知识，这超出了本文档的范围。

我现在的问题是给定的 makefile 没有按预期的方式工作。我收到**错误“No Targets”**由于我对 makefile 了解不多，因此我无法弄清楚该文件有什么问题。

```
#-------------------------------------------------------------------------------
#
#  makefile to geenrate the Diva SDK Java sample "SimpleApp".  This makefile 
#  generate the class files for teh framework and the sample and creates 
#  a SimpleApp.jar that can be executed via jav -jar SimpleApp
#  
#  The makefile assumes that the java development enmvironment is installed and 
#  the java tools are accessable from the command prompt.
#
#-------------------------------------------------------------------------------

FRAMEWORK_PATH=..\..\Framework
FRAMEWORK=$(FRAMEWORK_PATH)\DivaAPI.java $(FRAMEWORK_PATH)\DivaCallBase.java

BIN_DIR=.\bin
SRC_DIR=.\src

TRAGET=SimpleApp

#edited with hint from @Aaron Digulla
all : $(BIN_DIR)\$(TRAGET).jar

SRC=$(SRC_DIR)\SimpleApp.java \
    $(SRC_DIR)\AppCall.java

$(BIN_DIR)\$(TRAGET).jar: $(SRC)
@echo #-----------------------------------------------
@echo # Generate class files
@echo #-----------------------------------------------
javac -d $(BIN_DIR) -sourcepath $(FRAMEWORK_PATH) $(FRAMEWORK) $(SRC)
@echo #-----------------------------------------------
@echo # Generate jar files and clean class and manifest
@echo #-----------------------------------------------
copy $(SRC_DIR)\manifest.txt $(BIN_DIR)
cd $(BIN_DIR)
jar -cvfm $(TRAGET).jar manifest.txt *.class > nul
del *.class
del manifest.txt
cd ..
@echo #-----------------------------------------------
@echo # $(BIN_DIR)\$(TARGET).jar successfully created
@echo #----------------------------------------------- 
```

看来，目标定义是错误的，但我不知道是哪种方式。任何提示将不胜感激。

**编辑1：**在@Aaron Digulla 的提示下，它工作得更好一点。至少目标被识别。但是现在有一个错误告诉我，没有创建 jar 的规则。

**编辑2：**嗯......似乎文件路径是错误的。如果我用普通斜杠（“/”）替换一些反斜杠（“\”），编译就会开始。它停在复制虽然......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:49:22.660

`all`该错误意味着Makefile中没有目标，并且`make`懦弱地拒绝继续。

我的猜测是这个 Makefile 应该是从另一个 Makefile 调用的。

将此行添加到 Makefile：

```
all : $(BIN_DIR)\$(TRAGET).jar 
```

它应该可以工作。如果错误仍然存​​在，请确保您使用 GNU make 或尝试`make all`

# ruby-on-rails-3 - Mongodb Long Query数据没有被插入

> ID：13765337
> 
> 赞同：0
> 
> 时间：2012-12-07T14:45:05.493
> 
> 标签：ruby-on-rails-3, mongodb, ruby-on-rails-3.2, mongoid, mongohq

我们在插入查询时遇到了一个非常奇怪的问题，它在本地 mongodb 上运行良好，但在 MongoHQ 上却导致了问题。

当插入查询中的数据有点长时，Rails、Mongo Id 查询、MongoHq 返回 true 但实际上不会插入数据，在以下情况下会记录以下查询。

失败案例：

```
Dev-Stats['gm_metrics'].insert([
    {"_id"=>BSON::ObjectId('50c01eccb4e36b0002000003'), "metric_name"=>2, "count"=>1, "parameters"=>[{"param"=>"user_id",  "value"=>"4f0be09cc8c1950001000001"}, {"param"=>"created_at", "value"=>"2012-12-06 04:27:56 +0000"}, {"param"=>"game_id", "value"=>"4e8d712aa510cb0001000002"}],  "updated_at"=>2012-12-06 04:27:56 UTC, "created_at"=>2012-12-06 04:27:56 UTC}
]) 
```

我们的 Rails Query 从中生成上述 mongodb 查询

```
GmMetric.with(:safe=>false).create({:metric_name=>2, :count=>1,:parameters => [{"param"=>"user_id", "value"=>"4f0be09cc8c1950001000001"},{"param"=>"created_at", :value=>"#{Time.now}"},{"param"=>"game_id", :value1=>"4e8d712aa510cb0001000002"}]})

Dev-Stats['gm_metrics'].insert([{"_id"=>BSON::ObjectId('50c01eccb4e36b0002000003'), "metric_name"=>2, "count"=>1, "parameters"=>[{"param"=>"user_id", "value"=>"123456"}, {"param"=>"created_at", "value"=>"2012-12-06 04:27:56 +0000"}, {"param"=>"game_id", "value"=>"123456"},{"param"=>"game_id", "value"=>"123456"}], "updated_at"=>2012-12-06 04:28:56 UTC, "created_at"=>2012-12-06 04:28:56 UTC}]) 
```

成功案例

```
Dev-Stats['gm_metrics'].insert([{"_id"=>BSON::ObjectId('50c01eccb4e36b0002000003'), "metric_name"=>2, "count"=>1, "parameters"=>[{"param"=>"user_id", "value"=>"4f0be09cc8c1950001000001"}, {"param"=>"created_at", "value"=>"2012-12-06 04:27:56 +0000"}, {"param"=>"game_id", "value"=>"123456"}], "updated_at"=>2012-12-06 04:28:56 UTC, "created_at"=>2012-12-06 04:28:56 UTC}])

Dev-Stats['gm_metrics'].insert([{"_id"=>BSON::ObjectId('50c01eccb4e36b0002000003'), "metric_name"=>2, "count"=>1, "parameters"=>[{"param"=>"user_id", "value"=>"4f0be09cc8c1950001000001"}, {"param"=>"created_at", "value"=>"4f0be09cc8c1950001000001"}], "updated_at"=>2012-12-06 04:28:56 UTC, "created_at"=>2012-12-06 04:28:56 UTC}]) 
```

对于上述情况，它确认当查询长度很长时它不会被插入到数据库中，但是当我们尝试用更少的参数和短值插入时，我们总是会成功。请指导我们如何修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T13:06:34.087

尝试使用 safe:true 选项插入（我对 ruby​​ 的了解不多，但它会给你足够的洞察力）为什么它会失败。

# objective-c - 带有声音文件的动画 iOS

> ID：13765341
> 
> 赞同：1
> 
> 时间：2012-12-07T14:45:19.847
> 
> 标签：objective-c, ios, animation, uiviewcontroller

我有一些动画需要在非常特定的时间出现在屏幕上，这些动画存储在 SQLite 数据库中。我打算做的是使用 nstimer 来保持时间并在达到特定时间时弹出动画。

我正在考虑使用 NSTimer 来计算声音文件和动画的持续时间，然后在达到某些点时弹出屏幕动画。问题是设置的时间是这样的 55.715000 秒，所以非常准确，这些需要与将与动画一起播放的音轨同步。

首先这是否可能，其次我如何比较这些特定的时间，我似乎面临的问题是代码运行不够快，时间跳跃超过 0.001 秒。

我不了解 openGLES 或 Cocos2d，学习这些在时间尺度上是不可行的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-15T21:19:17.620

如果您的视觉效果需要与音频完全同步（例如，动画必须出现在节拍上的音乐应用程序），那么您需要使用以下方法。它适用于非常旧的 iPhone 硬件，并且在运行时基本上不会出错。

1.  预渲染视觉效果的每个“帧”，以便将每个“帧”存储为全屏图像。这可以在桌面上完成，或者您可以在手机上运行渲染逻辑，然后将输出作为像素捕获到文件中。

2.  将每一帧保存为像素数组后，通过 iOS 上的标准 AVAudioPlayer API 播放音频。此 API 负责音频播放并报告您将用来确定要显示哪个视频帧的时间。

3.  播放音频后，获取“时间”并将其除以视频帧率，以确定要显示的 N 个图像数组中的哪个图像。获取图像数据并将其包装在 CGImageRef/UIImage 中，这将以最佳方式将图像数据传输到屏幕上。

如果您想查看此方法的有效源代码，请查看[AVSync](http://www.modejong.com/AVAnimator/examples.html#AVSync)。此示例代码显示了我在应用商店中名为 iPractice 的应用中使用的实现。它非常快，即使在旧 iPhone 3G 上也能以 30FPS 运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:32:48.203

无论您的计时有多准确，您都不会让设备的显示频率超过大约 60Hz（每帧 16.7 毫秒）。在我看来，您至少有两个选择：

1）使用[`CADisplayLink`](http://developer.apple.com/library/ios/#documentation/QuartzCore/Reference/CADisplayLink_ClassRef/Reference/Reference.html)回调检查音频的播放进度，并在每个动画及时触发。

显示链接计时器的创建方式与常规类似`NSTimers`：

```
-(void)viewDidLoad
{
    // ...
    self.displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(scheduleAnimations:)];
    [self.displayLink addToRunLoop:[NSRunLoop mainRunLoop] forMode:NSDefaultRunLoopMode];
}

- (void)scheduleAnimations:(CADisplayLink *)displayLink
{
    // get playback time from player object
    // iterate queue of timings
    //     if the timestamp of a timing is equal to or less than the playback time
    //         create its animation for immediate execution
    //         remove it from the queue
} 
```

2）创建动画集合，将它们各自的`beginTime`属性设置为适当的触发时间（或者，如果使用隐式或基于块的动画，则使用`delay`参数）。

```
[CATransaction begin];
// iterate collection of timings
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"key"];
    animation.startTime = /* time to trigger animation */
    animation.removedOnCompletion = NO;
    [layer addAnimation:animation forKey:nil];
[CATransaction commit]; 
```

# android - 我保存了我的任务，但我无法使用共享首选项检索所有任务？

> ID：13765342
> 
> 赞同：0
> 
> 时间：2012-12-07T14:45:21.170
> 
> 标签：android, task, sharedpreferences, store

我保存了更多任务，但是在检索任务时会一一显示。我需要显示所有任务。这是我存储任务的代码。

```
public static int i=0;

task_ok.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {

        String prefs_name = null;
        SharedPreferences remind = getApplicationContext().getSharedPreferences(prefs_name,0);     
        SharedPreferences.Editor taskedit=remind.edit();   
        taskedit.putString("taskname"+i, edit_task.getText().toString().trim());
        taskedit.putString("taskdate"+i, edit_date.getText().toString().trim());
        taskedit.putString("tasktime"+i, edit_time.getText().toString().trim());
        taskedit.apply();

        i++;

        Toast.makeText(getApplicationContext(), "Task added", Toast.LENGTH_SHORT).show();

        Intent ret_view=new Intent(Add.this,TaskActivity.class);
        startActivity(ret_view);
    }
}); 
```

这是检索的代码..

```
public static int i=0;
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_view);

    TextView tv=(TextView)findViewById(R.id.textView2);
    String prefs_name = null;
    SharedPreferences remind= getApplicationContext().getSharedPreferences(prefs_name,0);

    remind.getAll();
    String viewtask=remind.getString("taskname"+i, "");
    String viewdate=remind.getString("taskdate"+i, "");
    String viewtime=remind.getString("tasktime"+i, "");    
    tv.setText(new StringBuilder().append(viewtask).append(" ").append(viewdate).append(" ").append(viewtime));
    i++; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:14:32.257

像这样试试

```
String taskname = ("taskname"+i);
String taskdate = ("taskdate"+i);
String tasktime = ("tasktime"+i);
taskedit.putString(taskname, edit_task.getText().toString().trim());
taskedit.putString(taskdate, edit_date.getText().toString().trim());
taskedit.putString(tasktime, edit_time.getText().toString().trim()); 
```

检索

```
 String taskname = ("taskname"+i);
    String taskdate = ("taskdate"+i);
    String tasktime = ("tasktime"+i);
    String viewtask=remind.getString(taskname, "");
    String viewdate=remind.getString(taskdate, "");
    String viewtime=remind.getString(tasktime, ""); 
```

当您从 sharePreference 中检索数据时，执行完全相同的操作。该代码对我有用。希望这对你也有帮助 干杯

# php - Magento 在自定义页面上按属性显示产品

> ID：13765343
> 
> 赞同：2
> 
> 时间：2012-12-07T14:45:23.480
> 
> 标签：php, magento, e-commerce

我希望有一个带有标题和文本的自定义 CMS 页面，然后在其下方列出具有特定自定义属性的产品，例如颜色仅在特定页面上显示黑色产品。

这可能吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:25:23.553

我可以建议使用我的扩展程序吗？

在[MagentoConnect](http://www.magentocommerce.com/magento-connect/custom-listings-7646.html)或[GitHub 上可用](https://github.com/openstream/CustomListing)。

本文中的更多信息：[Magento 扩展以按特定属性列出畅销书、特价商品、所有产品或产品](http://www.openstream.ch/developer-blog/magento-extension-to-list-bestsellers-specials-all-products-or-products-by-specific-attribute/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T09:25:20.230

我在我的文章中描述了一个关于这个问题的小方法：

[http://www.atwix.com/magento/products-list-cms/](http://www.atwix.com/magento/products-list-cms/)

# nlp - 斯坦福命名实体识别器中的多术语命名实体

> ID：13765349
> 
> 赞同：19
> 
> 时间：2012-12-07T14:45:42.677
> 
> 标签：nlp, stanford-nlp, named-entity-recognition

我正在使用斯坦福命名实体识别器[http://nlp.stanford.edu/software/CRF-NER.shtml](http://nlp.stanford.edu/software/CRF-NER.shtml)，它工作正常。这是

```
 List<List<CoreLabel>> out = classifier.classify(text);
    for (List<CoreLabel> sentence : out) {
        for (CoreLabel word : sentence) {
            if (!StringUtils.equals(word.get(AnswerAnnotation.class), "O")) {
                namedEntities.add(word.word().trim());           
            }
        }
    } 
```

然而，我发现的问题是识别姓名和姓氏。如果识别器遇到“Joe Smith”，它会分别返回“Joe”和“Smith”。我真的很希望将“乔·史密斯”作为一个术语返回。

这可以通过识别器通过配置来实现吗？直到现在我还没有在 javadoc 中找到任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-08T20:24:25.517

这是因为您的内部 for 循环正在迭代各个标记（单词）并分别添加它们。您需要更改内容以立即添加全名。

一种方法是用常规 for 循环替换内部 for 循环，其中内部有一个 while 循环，该循环采用同一类的相邻非 O 事物并将它们添加为单个实体。*

另一种方法是使用 CRFClassifier 方法调用：

```
List<Triple<String,Integer,Integer>> classifyToCharacterOffsets(String sentences) 
```

这将为您提供整个实体，您可以通过`substring`在原始输入上使用来提取字符串形式。

*我们分发的模型使用简单的原始 IO 标签方案，其中事物被标记为 PERSON 或 LOCATION，而适当的做法是简单地将具有相同标签的相邻标记合并。许多 NER 系统使用更复杂的标签，例如 IOB 标签，其中 B-PERS 等代码指示人员实体的起始位置。CRFClassifier 类和特征工厂支持此类标签，但它们并未用于我们当前分发的模型中（截至 2012 年）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-28T11:29:16.183

classifyToCharacterOffsets 方法的对应物是（AFAIK）您无法访问实体的标签。

正如 Christopher 所提出的，这里是一个组装“相邻的非 O 事物”的循环示例。此示例还计算出现次数。

```
public HashMap<String, HashMap<String, Integer>> extractEntities(String text){

    HashMap<String, HashMap<String, Integer>> entities =
            new HashMap<String, HashMap<String, Integer>>();

    for (List<CoreLabel> lcl : classifier.classify(text)) {

        Iterator<CoreLabel> iterator = lcl.iterator();

        if (!iterator.hasNext())
            continue;

        CoreLabel cl = iterator.next();

        while (iterator.hasNext()) {
            String answer =
                    cl.getString(CoreAnnotations.AnswerAnnotation.class);

            if (answer.equals("O")) {
                cl = iterator.next();
                continue;
            }

            if (!entities.containsKey(answer))
                entities.put(answer, new HashMap<String, Integer>());

            String value = cl.getString(CoreAnnotations.ValueAnnotation.class);

            while (iterator.hasNext()) {
                cl = iterator.next();
                if (answer.equals(
                        cl.getString(CoreAnnotations.AnswerAnnotation.class)))
                    value = value + " " +
                           cl.getString(CoreAnnotations.ValueAnnotation.class);
                else {
                    if (!entities.get(answer).containsKey(value))
                        entities.get(answer).put(value, 0);

                    entities.get(answer).put(value,
                            entities.get(answer).get(value) + 1);

                    break;
                }
            }

            if (!iterator.hasNext())
                break;
        }
    }

    return entities;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-04T18:01:42.020

我也遇到了同样的问题，所以我也查了一下。Christopher Manning 提出的方法是有效的，但微妙的一点是要知道如何决定哪种分离器是合适的。可以说只允许一个空格，例如“John Zorn”>> 一个实体。但是，我可能会找到“J.Zorn”的形式，所以我也应该允许某些标点符号。但是“杰克、詹姆斯和乔”呢？我可能会得到 2 个实体而不是 3 个（“Jack James”和“Joe”）。

通过深入研究斯坦福 NER 课程，我实际上找到了这个想法的正确实现。他们使用它以单个`String`对象的形式导出实体。例如，在方法`PlainTextDocumentReaderAndWriter.printAnswersTokenizedInlineXML`中，我们有：

```
 private void printAnswersInlineXML(List<IN> doc, PrintWriter out) {
    final String background = flags.backgroundSymbol;
    String prevTag = background;
    for (Iterator<IN> wordIter = doc.iterator(); wordIter.hasNext();) {
      IN wi = wordIter.next();
      String tag = StringUtils.getNotNullString(wi.get(AnswerAnnotation.class));

      String before = StringUtils.getNotNullString(wi.get(BeforeAnnotation.class));

      String current = StringUtils.getNotNullString(wi.get(CoreAnnotations.OriginalTextAnnotation.class));
      if (!tag.equals(prevTag)) {
        if (!prevTag.equals(background) && !tag.equals(background)) {
          out.print("</");
          out.print(prevTag);
          out.print('>');
          out.print(before);
          out.print('<');
          out.print(tag);
          out.print('>');
        } else if (!prevTag.equals(background)) {
          out.print("</");
          out.print(prevTag);
          out.print('>');
          out.print(before);
        } else if (!tag.equals(background)) {
          out.print(before);
          out.print('<');
          out.print(tag);
          out.print('>');
        }
      } else {
        out.print(before);
      }
      out.print(current);
      String afterWS = StringUtils.getNotNullString(wi.get(AfterAnnotation.class));

      if (!tag.equals(background) && !wordIter.hasNext()) {
        out.print("</");
        out.print(tag);
        out.print('>');
        prevTag = background;
      } else {
        prevTag = tag;
      }
      out.print(afterWS);
    }
  } 
```

如前所述，他们遍历每个单词，检查它是否具有与前一个相同的类（答案）。为此，他们利用被认为不是实体的事实表达式使用所谓的`backgroundSymbol`（“O”类）进行标记。他们还使用 property `BeforeAnnotation`，它表示将当前单词与前一个单词分开的字符串。最后一点可以解决我最初提出的关于选择合适分隔符的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-29T15:46:24.637

上述代码：

```
<List> result = classifier.classifyToCharacterOffsets(text);

for (Triple<String, Integer, Integer> triple : result)
{
    System.out.println(triple.first + " : " + text.substring(triple.second, triple.third));
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-27T04:57:16.927

```
List<List<CoreLabel>> out = classifier.classify(text);
for (List<CoreLabel> sentence : out) {
    String s = "";
    String prevLabel = null;
    for (CoreLabel word : sentence) {
      if(prevLabel == null  || prevLabel.equals(word.get(CoreAnnotations.AnswerAnnotation.class)) ) {
         s = s + " " + word;
         prevLabel = word.get(CoreAnnotations.AnswerAnnotation.class);
      }
      else {
        if(!prevLabel.equals("O"))
           System.out.println(s.trim() + '/' + prevLabel + ' ');
        s = " " + word;
        prevLabel = word.get(CoreAnnotations.AnswerAnnotation.class);
      }
    }
    if(!prevLabel.equals("O"))
        System.out.println(s + '/' + prevLabel + ' ');
} 
```

我只是写了一个小逻辑，它工作正常。如果它们相邻，我所做的是将具有相同标签的单词分组。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-29T13:39:09.163

使用已经提供给您的分类器。我相信这就是您正在寻找的：

```
 private static String combineNERSequence(String text) {

    String serializedClassifier = "edu/stanford/nlp/models/ner/english.all.3class.distsim.crf.ser.gz";      
    AbstractSequenceClassifier<CoreLabel> classifier = null;
    try {
        classifier = CRFClassifier
                .getClassifier(serializedClassifier);
    } catch (ClassCastException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    System.out.println(classifier.classifyWithInlineXML(text));

    //  FOR TSV FORMAT  //
    //System.out.print(classifier.classifyToString(text, "tsv", false));

    return classifier.classifyWithInlineXML(text);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-29T04:37:36.420

Here is my full code, I use Stanford core NLP and write algorithm to concatenate Multi Term names.

```
import edu.stanford.nlp.ling.CoreAnnotations;
import edu.stanford.nlp.ling.CoreLabel;
import edu.stanford.nlp.pipeline.Annotation;
import edu.stanford.nlp.pipeline.StanfordCoreNLP;
import edu.stanford.nlp.util.CoreMap;
import org.apache.log4j.Logger;

import java.util.ArrayList;
import java.util.List;
import java.util.Properties;

/**
 * Created by Chanuka on 8/28/14 AD.
 */
public class FindNameEntityTypeExecutor {

private static Logger logger = Logger.getLogger(FindNameEntityTypeExecutor.class);

private StanfordCoreNLP pipeline;

public FindNameEntityTypeExecutor() {
    logger.info("Initializing Annotator pipeline ...");

    Properties props = new Properties();

    props.setProperty("annotators", "tokenize, ssplit, pos, lemma, ner");

    pipeline = new StanfordCoreNLP(props);

    logger.info("Annotator pipeline initialized");
}

List<String> findNameEntityType(String text, String entity) {
    logger.info("Finding entity type matches in the " + text + " for entity type, " + entity);

    // create an empty Annotation just with the given text
    Annotation document = new Annotation(text);

    // run all Annotators on this text
    pipeline.annotate(document);
    List<CoreMap> sentences = document.get(CoreAnnotations.SentencesAnnotation.class);
    List<String> matches = new ArrayList<String>();

    for (CoreMap sentence : sentences) {

        int previousCount = 0;
        int count = 0;
        // traversing the words in the current sentence
        // a CoreLabel is a CoreMap with additional token-specific methods

        for (CoreLabel token : sentence.get(CoreAnnotations.TokensAnnotation.class)) {
            String word = token.get(CoreAnnotations.TextAnnotation.class);

            int previousWordIndex;
            if (entity.equals(token.get(CoreAnnotations.NamedEntityTagAnnotation.class))) {
                count++;
                if (previousCount != 0 && (previousCount + 1) == count) {
                    previousWordIndex = matches.size() - 1;
                    String previousWord = matches.get(previousWordIndex);
                    matches.remove(previousWordIndex);
                    previousWord = previousWord.concat(" " + word);
                    matches.add(previousWordIndex, previousWord);

                } else {
                    matches.add(word);
                }
                previousCount = count;
            }
            else
            {
                count=0;
                previousCount=0;
            }

        }

    }
    return matches;
}
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-24T15:28:35.990

另一种处理多词实体的方法。如果它们具有相同的注释并且连续出现，则此代码将多个标记组合在一起。

*限制：*
如果同一个token有两个不同的注解，最后一个会被保存。

```
private Document getEntities(String fullText) {

    Document entitiesList = new Document();
    NERClassifierCombiner nerCombClassifier = loadNERClassifiers();

    if (nerCombClassifier != null) {

        List<List<CoreLabel>> results = nerCombClassifier.classify(fullText);

        for (List<CoreLabel> coreLabels : results) {

            String prevLabel = null;
            String prevToken = null;

            for (CoreLabel coreLabel : coreLabels) {

                String word = coreLabel.word();
                String annotation = coreLabel.get(CoreAnnotations.AnswerAnnotation.class);

                if (!"O".equals(annotation)) {

                    if (prevLabel == null) {
                        prevLabel = annotation;
                        prevToken = word;
                    } else {

                        if (prevLabel.equals(annotation)) {
                            prevToken += " " + word;
                        } else {
                            prevLabel = annotation;
                            prevToken = word;
                        }
                    }
                } else {

                    if (prevLabel != null) {
                        entitiesList.put(prevToken, prevLabel);
                        prevLabel = null;
                    }
                }
            }
        }
    }

    return entitiesList;
} 
```

*进口：*

```
Document: org.bson.Document;
NERClassifierCombiner: edu.stanford.nlp.ie.NERClassifierCombiner; 
```

# c++ - 如何从加载的 DLL/共享库的主程序中的特定类/成员位置获取数据？[Windows/Linux]

> ID：13765362
> 
> 赞同：1
> 
> 时间：2012-12-07T14:45:59.860
> 
> 标签：c++, linux, windows, function-pointers

我正在尝试从 DLL 调用位于程序中的函数。

该程序是封闭源代码，但结构是已知的。

我需要调用一个名为“GetPlayerPosition”的函数，如下所示：

```
// native GetPlayerPos(playerid, &Float:x, &Float:y, &Float:z)
static cell AMX_NATIVE_CALL n_GetPlayerPos(AMX *amx, cell *params)
{
    CHECK_PARAMS(4);

    CPlayer* pPlayer = pNetGame->GetPlayerPool()->GetAt((BYTE)params[1]);

    if (pPlayer)
    {
        cell* cptr;
        amx_GetAddr(amx, params[2], &cptr);
        *cptr = amx_ftoc(pPlayer->m_vecPos.X);
        amx_GetAddr(amx, params[3], &cptr);
        *cptr = amx_ftoc(pPlayer->m_vecPos.Y);
        amx_GetAddr(amx, params[4], &cptr);
        *cptr = amx_ftoc(pPlayer->m_vecPos.Z);

        return 1;
    } else {
        return 0;
    }
} 
```

我想从我的 DLL/SO 调用这部分：

`pNetGame->GetPlayerPool()->GetAt((BYTE)<my own input data here>);`

我知道结构/类是这样的：

```
typedef struct _VECTOR {
    float X,Y,Z;
} VECTOR, *PVECTOR;

CNetGame    *pNetGame   = NULL;

class CNetGame
{
private:
    CPlayerPool                 *m_pPlayerPool;
public:
    CNetGame();
    ~CNetGame();
    CPlayerPool * GetPlayerPool() { return m_pPlayerPool; };
};

void CNetGame::Init(BOOL bFirst = false)
{
    // Setup player pool
    if(!m_pPlayerPool) {
        m_pPlayerPool = new CPlayerPool();
    } else {
        m_pPlayerPool->ResetPlayerScoresAndMoney();
    }
}

class CPlayerPool
{
private:

    BOOL    m_bPlayerSlotState[MAX_PLAYERS];
    CPlayer *m_pPlayers[MAX_PLAYERS];

public:

    CPlayerPool();
    ~CPlayerPool();

    BOOL New(BYTE bytePlayerID, PCHAR szPlayerName);
    BOOL Delete(BYTE bytePlayerID, BYTE byteReason);

    // Retrieve a player
    CPlayer* GetAt(BYTE bytePlayerID) {
        if (bytePlayerID >= MAX_PLAYERS) { return NULL; }
        return m_pPlayers[bytePlayerID];
    };
};

class CPlayer
{
private:
    BYTE                    m_bytePlayerID;

public:

    CPlayer();
    ~CPlayer() {};

    VECTOR  m_vecPos;

}; 
```

那么我将如何`pNetGame->GetPlayerPool()->GetAt((BYTE)<my own input data here>);`使用这个设置调用呢？

# iphone - 如何将 Photoshop 的级别调整映射到 Core Image 滤镜？

> ID：13765365
> 
> 赞同：7
> 
> 时间：2012-12-07T14:46:10.080
> 
> 标签：iphone, ios, photoshop, core-image

我将几个 Photoshop 元素映射到 CIFilter，我唯一遇到的问题是这个级别调整：

![](../Images/5d39648ac82492bc4f8f522269d1d006.png)

![当前版本的 Photoshop 的屏幕截图](../Images/1820b0b184e0eb83d114e08c2826850a.png)

哪个 CI 过滤器（或过滤器组合）可以让我在第一个示例中使用上面的 16、1.73、239 和 39/245，或者在第二个示例中使用 31、1.25、255 30/255。我相信这是一种阴影/黑白电平调整。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-14T03:38:47.713

通过调整此页面中的公式：http: [//http.developer.nvidia.com/GPUGems/gpugems_ch22.html](http://http.developer.nvidia.com/GPUGems/gpugems_ch22.html)，我相信您可以使用和的组合`CIColorMatrix`来做到这一点。`CIGammaAdjust``CIColorMatrix`

让我们分别称输入电平和`inBlack`，以及输出电平和。请注意，Photoshop 颜色介于 0 和 255 之间，而 CI 颜色介于 0 和 1 之间，因此您需要将 Photoshop 值（除了！）除以 255，然后再将它们放入以下公式。`inGamma``inWhite``outBlack``outWhite``inGamma`

输入映射是`pixel = (inPixel-inBlack)/(inWhite-inBlack)`，这意味着您的第一个矩阵将是

```
red = [1/(inWhite-inBlack) 0 0 0]
green = [0 1/(inWhite-inBlack) 0 0]
blue = [0 0 1/(inWhite-inBlack) 0]
alpha = [0 0 0 1]
bias = [-inBlack/(inWhite-inBlack), -inBlack/(inWhite-inBlack),-inBlack/(inWhite-inBlack), 0] 
```

然后你使用`CIGammaAdjust`和`inGamma`数字应用伽马校正（我在计算时必须使用倒数`1/inGamma`，也试试吧！）。

最后输出映射是 pixel = `gammaCorrectedPixel * (outWhite - outBlack) + outBlack`，给你最终的矩阵

```
red = [(outWhite - outBlack) 0 0 0]
green = [0 (outWhite - outBlack) 0 0]
blue = [0 0 (outWhite - outBlack) 0]
alpha = [0 0 0 1]
bias = [outBlack outBlack outBlack 0] 
```

我实际上并没有使用 CoreImage 尝试过，但计算结果很好！

# android - 包含的 *.jar 中的 *.so 库涉及 UnsatisfiedLinkError

> ID：13765371
> 
> 赞同：1
> 
> 时间：2012-12-07T14:46:24.310
> 
> 标签：android, jar, android-ndk, shared-libraries

我用本机共享库（**libnativeext.so**）编写了 android 应用程序。

在应用程序的 java 类中，我使用 System.loadLibrary("nativeext")加载**libnativeext.so 。**一切都很好。本机代码编译，**libnativeext.so**放在**/libs/armeabi/**文件夹中。所以最终的 first.apk 文件包含**/lib/armeabi/libnativeext.so**，安装在设备上并且一切正常。

然后我在**javaext.jar**中导出项目。

此时**javaext.jar**在**/libs/armeabi/**中包含**libnativeext.so**。

 **在新项目（second-proj）中，我包含**javaext.jar**并在 java 构建路径中添加**javaext.jar的路径。**项目构建时仅对**javaext.jar**中的本机库**发出警告**。我在 Eclipse 首选项中禁用警告。

 **但是在设备上我得到了：java.lang.UnsatisfiedLinkError: Couldn't load nativeext: findLibrary returned null

奇怪，因为 second.apk 里面有**/libs/armeabi/libnativeext.so**。我去电话并弄清楚电话**/data/data/myapp/lib/**上的文件夹是空的！当然System.loadLibrary 找不到**libnativeext.so**。

我为自己找到了解决方案，但它看起来很丑，我想找到更好的方法。

我在现有的 **second-proj/libs/**文件夹**armeabi 中创建**并将 libnativeext.so 放入其中。

第二个项目：
/libs/armeabi/libnativeext.so
/libs/javaext.jar

当我构建项目时，我会查看 second.apk：

/lib/armeabi/libnativeext.so <---**新的**
/libs/armeabi/libnativeext.so

这个版本在手机上完美运行。

所以我假设，在安装过程中来自 /libs/armeabi/ 的库被忽略了，只有来自 /lib/armeabi/ 的库被安装在手机上。

所以问题是：如何强制 apk bulder 将 *.so 从 *.jar 复制到正确的 *.apk 文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T07:19:01.620

如果无法将 *.so 库从包含的 *.jar 打包到最终的 *.apk 中，我会为自己解决这个问题。

我编写了 LibraryLoader，它：

1.  尝试使用 System.loadLibrary() 加载库。

2.  如果失败，则在应用程序存储中加载搜索库，如果找到则使用 System.load() 加载它。

3.  如果在应用程序存储中没有找到库，它会找到 .apk 文件，在那里进行搜索，如果加载器找到库 - 将其复制到应用程序存储，然后使用 System.load() 加载它。

在这里发布代码 - 可能对某人有帮助。

```
 import java.io.BufferedOutputStream;
    import java.io.File;
    import java.io.FileOutputStream;
    import java.io.IOException;
    import java.io.InputStream;
    import java.io.OutputStream;
    import java.util.Enumeration;
    import java.util.zip.ZipEntry;
    import java.util.zip.ZipFile;

    import android.content.Context;
    import android.util.Log;

    public class SharedLibraryLoader
    {
        private static Context context;
        private static String libDir = "lib";
        private static String shortLibName;
        private static String fullLibName;

        static public boolean loadLibrary(String libName, Context ctx)
        {
    context = ctx;
    shortLibName = libName;
    fullLibName = "lib" + libName + ".so";

    try
    {
        Log.d("SharedLibraryLoader", "Trying to load library");
        System.loadLibrary(shortLibName);
        Log.d("SharedLibraryLoader", "Library was loaded from default location");
        return true;
    }
    catch(UnsatisfiedLinkError e)
    {
        Log.d("SharedLibraryLoader","Lib wasn't found at default location. Trying to find in application private storage");
        String path = null;
        path = findInAppStorage(fullLibName);
        if(path != null)
        {
            Log.d("SharedLibraryLoader","Lib was found in application private storage. Loading lib...");
            System.load(path);
            return true;
        }
        else
        {
            Log.d("SharedLibraryLoader","Lib was not found in application private storage. Trying to find in apk...");
            path = findInApkAndCopyToAppStorage(fullLibName);

            if(path != null)
            {
                Log.d("SharedLibraryLoader","Lib was found in apk and copied to application private storage. Loading lib...");
                System.load(path);
                return true;
            }
            else
            {
                Log.d("SharedLibraryLoader", "FAILED TO LOAD LIBRARY");
                return false;
            }
        }
    }
        }

        static private String findInAppStorage(String libName)
        {

    Log.d("SharedLibraryLoader","enter findInAppStorage()");
    String basePath = context.getApplicationInfo().dataDir;
    File dataDir = new File(basePath);

    String[] listFiles;
    String  lib = null;
    listFiles = dataDir.list();

    for(int i=0; i < listFiles.length; i++)
    {
        lib = findInStorage(basePath + "/" +listFiles[i], libName);

        if(lib != null)
        {
            return lib;
        }
            }

    Log.d("SharedLibraryLoader", "Lib wasn't found.");
    return null;
        }

        static private String findInStorage(String path, String nameOfLib)
        {
    File file = new File(path);
    if(file.isDirectory())
    {
        Log.d("SharedLibraryLoader","Strorage__dir: " + path + "/");
        String[]    list = file.list();
        String      target = null; 
        for(int i = 0; i < list.length; i++)
        {
            target = findInStorage(path + "/" + list[i], nameOfLib);
            if(target != null)
            {
                return target;
            }
        }
    }
    else
    {
        Log.d("SharedLibraryLoader","Strorage_file: " + path);
        if(path.contains(nameOfLib))
        {
            Log.d("SharedLibraryLoader","Lib was found in: " + path);
            return path;
        }
    }
    return null;
        }

        static private String findInApkAndCopyToAppStorage(String libName)
        {
            Log.d("SharedLibraryLoader", "Enter findInApkAndCopyToStorage()");

            // ---------------- ZIP - find path to .so  inside .apk ------------------
    String apkPath = context.getPackageResourcePath();
    Log.d("SharedLibraryLoader", String.format("Path to Package resource is: %s", apkPath));

    try
    {
        ZipFile zf = new ZipFile(apkPath);

        Enumeration<ZipEntry> zipFiles = (Enumeration<ZipEntry>) zf.entries();
        ZipEntry    soZipEntry = null;
        ZipEntry    tempZipEntry;
        String      tmpString;
        for ( ; zipFiles.hasMoreElements();)
        {
            tempZipEntry = zipFiles.nextElement(); 
            tmpString = tempZipEntry.getName();

            if(tmpString.contains(libName))
            {
                Log.d("SharedLibraryLoader", "Library " + fullLibName + " was found in: " + tmpString);
                soZipEntry = tempZipEntry;
            }
        }

        //----------now copy library---------------
        Log.d("SharedLibraryLoader", "soZipEntry = " + soZipEntry.toString());

        if(soZipEntry != null)
        {
            InputStream soInputStream = zf.getInputStream(soZipEntry);

            File fileDir;
            File soFile;
            OutputStream outStream;
            fileDir = context.getApplicationContext().getDir(libDir, Context.MODE_PRIVATE); // but "app_lib" was created!
            String fullSoFilePath = fileDir.getAbsolutePath() + "/" + libName;
            Log.d("SharedLibraryLoader", "New libpath is "+ fullSoFilePath);
            soFile = new File(fullSoFilePath);

            Log.d("SharedLibraryLoader", "Is file already exists? - " + soFile.exists());

            outStream = new BufferedOutputStream(new FileOutputStream(soFile));

            Log.d("SharedLibraryLoader", "Start copying library...");
            byte[] byteArray = new byte[256];
            int copiedBytes = 0;

            while((copiedBytes = soInputStream.read(byteArray)) != -1)
            {
                outStream.write(byteArray, 0, copiedBytes);
            }

            Log.d("SharedLibraryLoader", "Finish copying library");
            outStream.close();

            soInputStream.close();
            return fullSoFilePath;
        }
        else
        {
            Log.d("SharedLibraryLoader", "Library not Found in APK");
            return null;
        }
    }
    catch (IOException e)
    {
        e.printStackTrace();
        return null;
    }
        }
            } 
```****

# visual-studio-2012 - VS2012中“从源代码管理中排除”发生了什么

> ID：13765372
> 
> 赞同：15
> 
> 时间：2012-12-07T14:46:28.760
> 
> 标签：visual-studio-2012

我想从 TFS 2012 源代码管理中排除代码文件夹中的一些文件。

在 VS2012 之前，这是通过“源代码管理资源管理器”右键菜单中的“从源代码管理中排除”命令完成的。但是在VS2012中我找不到它。

有人知道它在哪里吗？

（顺便说一下，我正在使用“本地”工作区。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-16T14:32:34.517

当您在“团队资源管理器”窗格中单击“检测到的更改”时，将打开“促进候选更改”窗口。此窗口允许您在检测到的更改中进行选择并将它们提升为源代码控制项。

在此**“Promote Candidate Changes”**窗口中，您选择一个文件（或使用 Shift 多选文件），右键单击它并弹出一个上下文菜单，其中包含**“忽略此本地项目”**选项。如果单击它，所选文件将从源代码管理中排除。

Visual Studio 将一个名为“.tfignore”的文件添加到源代码管理映射根目录，其中包含要被源代码管理忽略的所有文件的名称。（以前的 TFS 版本没有生成此文件，但它们都是服务器工作区。由于这是一个“本地”工作区，因此需要将要忽略的文件名保留在工作区中）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-14T14:14:49.997

我有真正的解决方案。

在“团队资源管理器”窗格中，在“待更改”选项卡中，右键单击源代码管理中不需要的**新文件，然后单击“撤消”。**

它会将文件留在项目中，并将其从 TFS 中排除。在项目窗口中，文件的名称左侧永远不会有“锁定”图标。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-09-26T08:14:22.620

这是最简单的解决方案：

**1\. 在解决方案资源管理器中选择文件**

**2\. 转到文件 -> 源代码管理 -> 高级**

![排除路径](../Images/d21d010e3bb496c10a957ee1c41065df.png)

就在这里

![这里是排除](../Images/ed2e5c9add0ec627d1a90df13a5a56ce.png)

请记住：如果您在解决方案资源管理器中右键单击文件，您只会找到“最重要的选项”而不是全部:)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-03-28T14:05:24.580

在 VS2013 中，这又回来了，但已移至文件菜单：-

*   在解决方案资源管理器中选择文件
*   文件 > 源代码管理 > 高级 > 从源代码管理中排除 xxx.xxx

我知道这有点偏离主题，但认为它可能对某人有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-18T13:12:48.550

我有 Visual Studio 2017 Enterprise，并且在 File->Source Control 下不存在排除选项。我对这个问题的解决方案是打开源代码管理资源管理器，然后删除我想要排除的项目。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-07T23:06:39.657

它位于[**Pending Changes**](http://msdn.microsoft.com/en-us/library/ms181407.aspx#include_exclude)窗格中，分为**Excluded Changes**和**Included Changes**部分。它允许过滤和排除或提升部分之间的项目。

！![排除的更改](../Images/02ac579a637d5f571ec5c2113a8c4bd8.png)

# c++ - 运行的线程数多于内核数时，CUDA 性能会提高

> ID：13765374
> 
> 赞同：5
> 
> 时间：2012-12-07T14:46:42.220
> 
> 标签：c++, cuda, opencl

为什么每个块运行超过 32 个线程时性能会提高？

我的显卡有 480 个 CUDA 核心 (15 MS * 32 SP)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T23:15:45.837

每个 SM 有 1-4 个 warp 调度器（Tesla = 1，Fermi = 2，Kepler = 4）。每个warp调度器负责执行分配给SM的warp子集。每个 warp 调度程序维护一个合格的 warp 列表。如果扭曲可以在下一个周期发出指令，则它是合格的。如果 warp 因数据依赖而停止，等待获取和指令，或者下一条指令的执行单元忙，则 warp 不符合条件。在每个周期中，每个 warp 调度程序将从符合条件的 warp 列表中选择一个 warp 并发出 1 或 2 条指令。

每个 SM 的活动 warp 越多，每个 warp 调度程序必须在每个周期中选择的 warp 数量就越大。在大多数情况下，当每个 SM 有足够的活动 warp 以使每个循环调度程序有 1 个合格的 warp 时，可以实现最佳性能。超过此点的占用率不会提高性能，并且可能会降低性能。

主动扭曲的典型目标是 SM 最大扭曲的 50-66%。发射配置支持的扭曲与最大扭曲的比率称为理论占用率。每个周期的活动经线与每个周期的最大经线的运行时比率是已达到的占用率。对于 GTX480（CC 2.0 设备），设计内核时的一个良好起点是 50-66% 的理论占用率。CC 2.0 SM 最多可以有 48 个经线。50% 的占用率意味着每个 SM 有 24 条经线或 768 条线。

Nsight Visual Studio 版中的 CUDA Profiling Activity 可以显示理论占用率、实现的占用率、每个 SM 的活动经线、每个 SM 的合格经线和停顿原因。

CUDA Visual Profiler、nvprof 和命令行分析器可以显示理论占用率、活动扭曲和实现的占用率。

注意：CUDA 核心数只能用于比较类似架构的卡、计算理论 FLOPS 以及可能比较架构之间的差异。设计算法时不要使用计数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T16:45:37.020

欢迎来到堆栈溢出。原因是 CUDA 内核是流水线的。在 Fermi 上，管道大约有 20 个时钟长。这意味着要使 GPU 饱和，每个内核可能需要多达 20 个线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T03:00:39.713

主要原因是 CUDA 的内存延迟隐藏模型。大多数现代 CPU 使用缓存来隐藏主内存的延迟。这导致很大比例的芯片资源被用于缓存。大多数台式机和服务器处理器在芯片上都有几兆字节的缓存，这实际上占了芯片空间的大部分。为了封装更多具有相同能耗和散热特性的内核，基于 CUDA 的芯片将其芯片空间投入到大量 CUDA 内核（大多数只是浮点 ALU）上。因为缓存非常少，而是依靠让更多线程准备好运行，而其他线程正在等待内存访问返回以隐藏延迟。这使内核在一些线程等待内存访问时可以高效地工作。

CUDA 还具有零成本线程切换，以帮助这种内存延迟隐藏方案。由于需要将要切换的线程的所有寄存器值存储到堆栈上，然后为该线程加载所有寄存器值，因此普通 CPU 从执行一个线程切换到下一个线程会产生很大的开销正在切换到。CUDA SM 只有成吨的寄存器，所以每个线程都有自己的一组物理寄存器分配给它通过线程的生命周期。由于不需要存储和加载寄存器值，每个 SM 可以在一个时钟周期从一个 warp 执行线程，并在下一个时钟周期从另一个 warp 执行线程。

# java - 使用项目自己的 .java 文件作为资源文件

> ID：13765384
> 
> 赞同：5
> 
> 时间：2012-12-07T14:47:17.633
> 
> 标签：java, eclipse, resources

我用 Java 制作了一个小程序，用 gui 显示它的 .java 源代码。它不使用 FileChooser 来执行此操作。我正在借助以下语句阅读 .java 源

```
String resName = "/dev/classes/"+name+".java"
Scanner s = new Scanner(FilePrinter.class.getResourceAsStream(resName)); 
```

.java 文件的名称在哪里`name`，即如果文件是`MyProg.java`then `name==Myprog`。当然我的程序在`dev.classes`包里面

问题是，当我将项目导出到 JAR 并包含源文件时，这是可行的，因为源文件位于`/dev/classes/`目录中。

但是，我还没有发现一种方法可以让我的程序在**Eclipse**中或从命令行运行而不给我例外。

当然，当有人试图添加这些源文件以自动用作资源文件时，该过程会失败。

从 Eclipse 和 JAR 运行时，我可以以某种方式使用相同的代码吗？这一定是一件非常微不足道的事情，但因为我不是 Java 专家，所以我看不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:50:50.410

我找到了怎么做。实际上，您必须使用 Ant 或 Maven。但是，这可以在 Eclipse 中完成，如下所示：

在 Eclipse Project Properties>Java Build Path 中，您可以在底部的 Default Output 文件夹中选择：`<your_project_name>/src`.

这会导致类文件与 .java 文件在同一目录中编译，并最终执行我想要的操作。

感谢@AndrewThompson 建议尝试这个

# java - Maven：为什么 ${basedir} 被禁止 ?

> ID：13765385
> 
> 赞同：1
> 
> 时间：2012-12-07T14:47:23.640
> 
> 标签：java, maven, maven-3, pom.xml

**为什么`${basedir}`不允许进入`<targetPath>`？**

当我在 pom.xml 中添加 ${basedir}

```
<resource>
  <targetPath>${basedir}/target</targetPath>
</resource> 
```

maven-eclipse-plugin[失败](http://jira.codehaus.org/browse/MECLIPSE-269)：

```
$ mvn eclipse:eclipse
[ERROR] Cant canonicalize system path: {0} 
```

# matlab - 忽略循环中的警告并继续

> ID：13765392
> 
> 赞同：3
> 
> 时间：2012-12-07T14:47:55.710
> 
> 标签：matlab, solver

我有三个向量 A、B 和 C。对于这些向量中的每个值，我想求解方程 C^x = A^x + B^x。不幸的是，这是一个我发现只能迭代求解的方程，所以我尝试使用 MATLAB 的“求解”函数来为每种情况找到一个解决方案。我的代码如下：

```
exponents = zeros(100,1);

syms x

A = rand(100,1);
B = rand(100,1);
C = rand(100,1);

for i = 1:100

exponents(i) = eval(solve(C(i)^x == A(i)^x + B(i)^x));

end 
```

但是，有时无法获得解决方案，这会导致错误消息“警告：找不到显式解决方案”。我对此没意见，但如果我遇到一个不可解的方程，我想简单地保持该迭代的“指数（i）”不变并进入下一个迭代，而不是让我的代码突然停止。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:51:15.670

如果将导致偶尔错误的语句放在 try/catch 语句中，则错误不会导致执行停止。例如，您可以尝试：

```
for i = 1:100
  try
    exponents(i) = eval(solve(C(i)^x == A(i)^x + B(i)^x));
  catch
    exponents(i) = NaN; 
  end;
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:49:14.567

MATLAB 中没有直接的方法来捕获警告（至少有记录的方法）。一点都不优雅，如果不丑，你可以试试轮询[`lastwarn`](http://www.mathworks.com/help/matlab/ref/lastwarn.html).

```
...
exponents(i) = eval(solve(C(i)^x == A(i)^x + B(i)^x));
[~, msgid] = lastwarn;
if strcmp(msgid, YOURWARNINGID)
    continue;
end 
```

[这里](https://stackoverflow.com/questions/3701673/how-can-i-continue-with-a-loop-when-an-error-occurs-in-matlab)有一个类似的帖子，除了海报出现错误。

# asp.net-mvc - 为什么模型绑定比过滤器更早发生

> ID：13765393
> 
> 赞同：10
> 
> 时间：2012-12-07T14:48:15.817
> 
> 标签：asp.net-mvc, authorization, model-binding, action-filter

在阅读了 Simon 的这篇出色的博客[文章之后](http://www.simple-talk.com/content/article.aspx?article=1358)，我开始知道模型绑定发生在过滤器执行之前（甚至在授权过滤器之前）。如果请求未获得授权，则应尽早拒绝它，在这种情况下，我更喜欢在模型绑定过程之前运行授权过滤器。此外，通过这种方式，我们可以节省时间，避免扫描请求、创建模型实例和执行验证。

有什么理由我根本不明白为什么 MVC 请求处理管道的设计方式是模型绑定应该在过滤器之前发生？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T18:57:10.900

在 asp.net mvc3 中，授权过滤器在模型绑定之前执行，而不是之后（参见下面的代码）。

模型绑定发生在过滤器之前，因为 ActionExecutingContext（IActionFilter.OnActionExecuting 的参数）包含操作的参数。也许他们应该延迟加载这些参数。

以下代码来自 System.Web.Mvc.ControllerActionInvoker。

```
public virtual bool InvokeAction(ControllerContext controllerContext, string actionName) 
{
    // code removed for brevity
    try 
    {
        // Notice the authorization filters are invoked before model binding
        AuthorizationContext authContext = InvokeAuthorizationFilters(controllerContext, filterInfo.AuthorizationFilters, actionDescriptor);
        if (authContext.Result != null) {
            // the auth filter signaled that we should let it short-circuit the request
            InvokeActionResult(controllerContext, authContext.Result);
        }
        else {
            if (controllerContext.Controller.ValidateRequest) {
                ValidateRequest(controllerContext);
            }
            // GetParameterValues does the model binding
            IDictionary<string, object> parameters = GetParameterValues(controllerContext, actionDescriptor);
            ActionExecutedContext postActionContext = InvokeActionMethodWithFilters(controllerContext, filterInfo.ActionFilters, actionDescriptor, parameters);
            InvokeActionResultWithFilters(controllerContext, filterInfo.ResultFilters, postActionContext.Result);
        }
    }
    // code removed for brevity
} 
```

# javascript - 如何在不同的屏幕尺寸上居中导航栏

> ID：13765401
> 
> 赞同：-1
> 
> 时间：2012-12-07T14:48:27.527
> 
> 标签：javascript, html, css

我正在建立一个页面。此页面将有一个自定义导航栏。

导航栏尺寸 - 宽度：800 像素高度：100 像素。
机身bgcolor：灰色；导航栏 bgcolor：蓝色。

由于导航栏将是 800px 宽并且是蓝色的，我希望导航栏保持在页面的中心，但在大屏幕的左右边缘继续拉伸蓝色。

有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T14:50:15.297

这样就可以了，诀窍是margin-auto left and right

```
.outer
    {
      background-color:Gray;
    }

    .inner
    {
     width:800px;
     height:100px;
    background-color:blue; 
    margin:0 auto 0 auto;
    }

      <div id="outer">
        <div id="inner">blah</div>
      </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:45:03.380

不确定您是否得到了您正在寻找的答案，但为了清楚起见，您可以将导航元素嵌套并居中在一个具有 100% 宽度和类似样式的包装元素中，如下所示。

```
<div id="navWrap">
    <ul id="nav">
        <li>...</li>
    </ul>
</div>

<style type="text/css">
#navWrap {
    width:100%;
    background:blue;
}
#nav {
    width:800px;
    height:100px;
    margin:0 auto;
    background:blue;
}
body {
    background:grey;
}
</style> 
```

# sql - SQL 将数据插入一个全新的列失败

> ID：13765402
> 
> 赞同：0
> 
> 时间：2012-12-07T14:48:32.167
> 
> 标签：sql, sql-server-2008-r2, ssms

我正在使用如下脚本，但它一直在抱怨 Invalid column name 'NewColumnA' 。是否需要动态 sql 来完成此操作，还是有更简单的解决方案？

```
ALTER TABLE TableA ADD NewColumnA VARBINARY(300)

UPDATE TableA
SET 
    NewColumnA=b.OldColumnB,
FROM 
    TableA a, TableB b
WHERE a.myID=b.myID 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:50:32.187

您需要在;之后添加`Go`(which `Signals the end of a batch of Transact-SQL statements`)`ALTER TABLE`

```
ALTER TABLE TableA ADD NewColumnA VARBINARY(300)
GO
--rest of the query
UPDATE TableA
SET 
    NewColumnA=b.OldColumnB,
FROM 
    TableA a, TableB b
WHERE a.myID=b.myID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T14:49:53.207

尝试使用[`GO`](http://msdn.microsoft.com/en-us/library/ms188037.aspx)：

```
ALTER TABLE TableA ADD NewColumnA VARBINARY(300)

GO

UPDATE TableA
SET 
    NewColumnA=b.OldColumnB,
FROM 
    TableA a, TableB b
WHERE a.myID=b.myID 
```

# java - 使用 JNDI 将 Bean 插入 JBoss

> ID：13765415
> 
> 赞同：0
> 
> 时间：2012-12-07T14:49:16.060
> 
> 标签：java, spring, jboss, ejb, jndi

我想知道如何使用 JNDI 将对象（如果我需要 EJB）插入 JBoss（5.0）？

我的 Spring **applicationContext.xml**中有以下 bean 定义：

```
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<tx:annotation-driven transaction-manager="transactionManager" />

<context:annotation-config/>

<bean id="myServiceFacade" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="MyServiceFacadeBean/remote"/>
    <property name="cache" value="true"/>
    <property name="lookupOnStartup" value="true"/>
    <property name="jndiEnvironment">
        <props>
            <prop key="java.naming.factory.initial">org.jnp.interfaces.NamingContextFactory
            </prop>
            <prop key="java.naming.provider.url">localhost:1099</prop>
            <prop key="java.naming.factory.url.pkgs">org.jboss.naming:org.jnp.interfaces
            </prop>
        </props>
    </property>
    <property name="proxyInterface" value="my.company.service.facade.MyServiceFacade"/>
</bean> 
```

当我尝试运行 JBoss 时，我得到：

```
Caused by: javax.naming.NameNotFoundException: MyServiceFacadeBean/remote
at org.jboss.ha.jndi.HAJNDI.lookupRemotely(HAJNDI.java:264)
at org.jboss.ha.jndi.HAJNDI.lookup(HAJNDI.java:205)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.jboss.ha.framework.interfaces.HARMIClient.invoke(HARMIClient.java:318)
at $Proxy165.lookup(Unknown Source) 
```

也许应该采取一些额外的步骤来使用 JBoss/JNDI 注册对象？

请注意，我已经尝试将 ejb 特定文件放入 JBoss（jboss.xml、ejb-jar.xml），但这并没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T12:26:14.570

你如何在你的数据源中循环远程？但我确信你不能从你的 MyServiceFacadeBean 中得到它。

在 applicationContext.xml 中：

```
<property name="jndiName" value="remote"/> 
```

在循环往复的同时，

```
Context ctx = new InitialContext();
DataSource ds = (DataSource)ctx.lookup("java:comp/env/remote");
DataSource ds = (DataSource)envCtx.lookup("remote"); 
```

或者您可以进行一个中间步骤，这样您就不必为您检索的每个资源指定“java:comp/env”：

```
Context ctx = new InitialContext();
Context envCtx = (Context)ctx.lookup("java:comp/remote");
DataSource ds = (DataSource)envCtx.lookup("remote"); 
```

希望能帮助到你。

# facebook - 带有 OR 语句的 Facebook Graph API 搜索

> ID：13765416
> 
> 赞同：1
> 
> 时间：2012-12-07T14:49:16.310
> 
> 标签：facebook, facebook-graph-api

我正在开发一个使用 facebook Grap API 进行搜索的应用程序。我们经常使用 OR 查询来查询 facebook（使用 | [Facebook "OR" 查询和图形 API](https://stackoverflow.com/questions/3655077/facebook-or-queries-with-the-graph-api)）。但它似乎刚刚停止工作。有谁知道是否仍然可以使用 Graph API 搜索方法执行 OR 查询，如果可以，该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:00:21.833

我有同样的问题。我做了一些“谷歌搜索”并发现了这一点：[https ://developers.facebook.com/bugs/120122231487168?browse=search_50d089ba103283049766070](https://developers.facebook.com/bugs/120122231487168?browse=search_50d089ba103283049766070)

似乎是管道“|” 不再支持。正如他们所说，“这是设计使然”。

# entity-framework - EF DBContext Add 方法的底层发生了什么？

> ID：13765418
> 
> 赞同：7
> 
> 时间：2012-12-07T14:49:22.150
> 
> 标签：entity-framework

我试图向我的 DBContext 添加（）大约 18000 个对象。花了大约5分钟。使用 SaveChanges() 保存这些数据需要更长的时间。我切换到创建一个普通列表并将我的对象添加到其中，之后我使用 SqlBulkCopy 来保存数据。这花了大约 5 秒钟。

Add 方法是做什么的，导致它需要这么长时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:09:37.167

所以发生的情况是，在每次添加调用时，DetectChanges 都会在上下文中执行。这会枚举整个对象图，因此您跟踪的项目越多，每次添加所需的时间就越长。您也可以围绕此进行大量调整以加快速度（我的家用虚拟机插入速度约为 1k/s）。

在不调整 EF 添加性能的情况下有效地是 O(n^2)

我在下面的文章中详细介绍了这一点：

[EntityFramework 性能和 AutoDetectChanges](http://blog.staticvoid.co.nz/2012/05/entityframework-performance-and.html)

有关调整后 EF 执行速度的更多信息，请查看此处：

[实体框架比较性能](http://blog.staticvoid.co.nz/2012/03/entity-framework-comparative.html)

# windows - 使用 Visual Studio 2010 中的发布向导将 Windows 服务发布到应用程序服务器

> ID：13765419
> 
> 赞同：2
> 
> 时间：2012-12-07T14:49:22.560
> 
> 标签：windows, windows-services, publishing

我想做的就是我的问题的标题所说的。我不想将它发布到网站上。我需要将它发布到许多 Windows 服务所在的应用服务器。

我在网上查找的每个主题都有我需要发布到网站的地方。

有人可以告诉我如何做到这一点吗？通过简单地将其发布到具有概述的步骤或实际上很容易解释这一点的可能链接的应用程序服务器？

# asp.net - ORA-01036: SELECT 中参数上的非法变量名称/编号错误

> ID：13765439
> 
> 赞同：0
> 
> 时间：2012-12-07T14:50:38.433
> 
> 标签：asp.net, oracle, gridview, ora-01036

我正在尝试在 GridView 中填充一系列下拉列表。在 RowDataBound 事件中，我根据 gridviewrow 中的其他信息调用以获取用于填充行中下拉列表的项目。我在以下代码中收到“ORA-01036：参数上的非法变量名称/编号错误”。

```
Dim rowTemp As GridViewRow = ddlItemDesc.Parent.Parent

Dim lblYear As Label = rowTemp.FindControl("lblSchoolYear")
Dim strYear As String = lblYear.Text.Trim()

Dim strSelect As String = "SELECT FOO.BAR.PRODUCT_CODE || ' :: ' || FOO.BAR.PRODUCT_DESC AS txt, FOO.BAR.PRODUCT_KEY AS val, :currentYear AS CURRENT_YEAR FROM FOO.BAR WHERE (FOO.BAR.PRODUCT_KEY=:itemKey)"

Dim daTemp As New OracleDataAdapter(strSelect, oConn)   
daTemp.SelectCommand.Parameters.Add("currentYear", CDate(strYear))
daTemp.SelectCommand.Parameters.Add("itemKey", strItemVal(0))
Dim dtProd As New DataTable
daTemp.Fill(dtProd) 
```

如果我从 SELECT 语句中删除 ":currentYear AS CURRENT_YEAR"，它运行良好。我在另一个 SELECT 中从其他表的连接中使用相同的语句，没有问题。

strYear 来自 gridviewrow 中的标签，我检查了它是否有数据并且它对 CDate 有效（我也尝试将它简单地作为具有相同结果的字符串）。StrItemVal(0) 来自另一个下拉列表（使用 :currentYear 成功填充的下拉列表）。仅当该下拉列表中有一个被选中的值时，才会调用此代码。

# javascript - Jquery - 首次使用后初始化选择框

> ID：13765442
> 
> 赞同：0
> 
> 时间：2012-12-07T14:50:51.690
> 
> 标签：javascript, jquery, ajax, jquery-chosen

1.  页面加载了一个隐藏的选择框。
2.  我点击一个按钮
3.  我将元素附加到此选择框，移动它并使其可见
4.  `Chosen`我在上面应用插件

这是由这个函数完成的

```
function moveHiddenSelect(idOffline, type, idMedia, mediaName){
    var $selToReplace  = $("#"+type+"_"+idOffline);
    var $selOriginal   = $("#originalSelect");
    $selToReplace.replaceWith($selOriginal);

    $.getScript('/lib/chosen/chosen.jquery.min.js', function(){
        $selOriginal.chosen(); //load plugin script and apply it on the select box
    });

    $selOriginal.css("width", "220px");
    $selOriginal.css("visibility", "visible");
} 
```

当我单击一次按钮时没问题，但是当我再次单击按钮时（第 2 步）没有任何反应..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T11:42:20.907

selected() 应该被调用一次，只是为了创建。更新每个下拉列表的值后，您可以使用： $(DropdoenElement).trigger("liszt:updated");

```
function moveHiddenSelect(idOffline, type, idMedia, mediaName){
    var $selToReplace  = $("#"+type+"_"+idOffline);
    var $selOriginal   = $("#originalSelect");
    $selToReplace.replaceWith($selOriginal);

    selOriginal.chosen(); // Init the plugin

    $.getScript('/lib/chosen/chosen.jquery.min.js', function(){
       //load plugin script and apply it on the select box
       selOriginal.trigger("liszt:updated")
    });

    $selOriginal.css("width", "220px");
    $selOriginal.css("visibility", "visible");
} 
```

希望能帮助到你！

# visual-studio - ＃包括 缺少 Visual Studio 2012

> ID：13765447
> 
> 赞同：18
> 
> 时间：2012-12-07T14:51:02.787
> 
> 标签：visual-studio, visual-studio-2012

您好我最近安装了 Visual Studio 2012 并转换了我的一个使用头文件的项目：

```
#include <mapi.h>
#include <mapix.h>
#include <mapiutil.h> 
```

我看到新的包含目录位于`C:\Program Files (x86)\Windows Kits\8.0\Include\um`但它只有 mapi.h 头文件而不是其他两个头文件，并且我收到错误无法打开文件。

有人有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-07T15:00:18.773

它不是 Windows SDK 的一部分，可以[单独下载](http://www.microsoft.com/en-us/download/details.aspx?id=12905)。

# node.js - 了解 node.js 导出/包含

> ID：13765450
> 
> 赞同：0
> 
> 时间：2012-12-07T14:51:03.660
> 
> 标签：node.js

我很难理解如何导出文件，然后将其包含在 node.js 的其他位置。

假设我正在开发一款游戏，并且我想要定义一个或多个对象的变量，例如一个 var 敌人：

```
var enemy = {
  health: 100,
  strengh: 87
}; 
```

我将它保存在一个文件 vars.js 中。

如何从项目中需要它们的任何地方导入这些变量？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:55:28.717

你可以从 vars.js 导出

```
module.exports = {
  health: 100,
  strengh: 87
}; 
```

或者

```
var enemy = {
  health: 100,
  strengh: 87
};

module.exports = enemy; 
```

并使用 require 导入：

```
var enemy = require('./path/to/vars'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:56:30.280

在 file.js 中：

```
module.exports = {
  health: 100,
  strengh: 87
} 
```

在其他文件中：

```
var enemy = require('./file'); // (or whatever the relative path to your file is 
```

[更多信息在这里。](http://nodejs.org/api/modules.html#modules_modules)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:54:12.350

您需要导出它们。

所以`Enemy.js`：

```
var enemy = {
  health: 100,
  strengh: 87
};

exports.health = enemy.health;
exports.strength = enemy.strength; 
```

并在`otherjsfile.js`：

```
var Enemy = require('Enemy.js');

//and then you can do 

console.log(Enemy.health); ///etc 
```

* * *

### 侧点：

如果“敌人”信息定期更改并且您想获得最新的值，您可以这样做：

```
 Object.defineProperty(exports, "health", {
    get: function() {
      return enemy.health;
    }
  }); //instead of `exports.health = enemy.health;`

  Object.defineProperty(exports, "strengh", {
    get: function() {
      return enemy.strengh;
    }
  }); //instead of `exports.strength = enemy.strength;` 
```

# android - 双击放大 Google Map API - Android

> ID：13765451
> 
> 赞同：0
> 
> 时间：2012-12-07T14:51:03.707
> 
> 标签：android, google-maps

我正在使用以下代码显示 MAP（Google API）我希望它在用户 DOUBLE 单击地图上的任何位置时进行缩放。我怎样才能实现它？

```
public class TourMapActivity extends MapActivity {

@Override
protected void onCreate(Bundle arg0) {

    super.onCreate(arg0);

    setContentView(R.layout.tour_map);
    mMapView = (MapView)findViewById(R.id.MapView);
    mMapView.setBuiltInZoomControls(true);
    mMapView.getZoomButtonsController().setVisible(true);

}

@Override
protected boolean isRouteDisplayed() {

    return true;
}

class CustomOverlay extends ItemizedOverlay<CustomItem> {

    protected ArrayList<CustomItem> mOverlays = new ArrayList<CustomItem>();
    public OnTapListenerIndex mOnTapListenerIndex = null;
    private Context mContext;

    public CustomOverlay(Drawable defaultMarker) {
        super(boundCenterBottom(defaultMarker));
    }

    public CustomOverlay(Drawable defaultMarker, Context context)
    {
        super(boundCenterBottom(defaultMarker));
        mContext = context;
    }

    @Override
    protected CustomItem createItem(int i) {
        return mOverlays.get(i);
    }

    @Override
    public int size() {
        return mOverlays.size();
    }

    public void addOverlay(CustomItem overlay) {
        mOverlays.add(overlay);
        populate();
    }

    public void addOverlay(CustomItem overlay, Drawable marker) {
        overlay.setMarker(boundCenterBottom(marker));
        addOverlay(overlay);
    }

    @Override
    public void draw(android.graphics.Canvas canvas, MapView mapView, boolean shadow) {
        super.draw(canvas, mapView, false);
    }

}

public interface OnTapListenerIndex {

    public void onTapEvent(int index, OverlayItem overlayItem);
} 
```

}

当用户双击地图上的任何位置时，我希望它可以缩放。我怎样才能实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:05:37.227

看看这个：[https](https://stackoverflow.com/a/12646465/1885518) ://stackoverflow.com/a/12646465/1885518或[http://nocivus.posterous.com/double-clicktap-detection-on-a](http://nocivus.posterous.com/double-clicktap-detection-on-a)

简而言之，覆盖`onInterceptTouchEvent()`

```
@Override
public boolean onInterceptTouchEvent(MotionEvent ev) {

    if (ev.getAction() == MotionEvent.ACTION_DOWN) {

        long thisTime = System.currentTimeMillis();
        if (thisTime - lastTouchTime < 250) {

            // Double tap
            this.getController().zoomInFixing((int) ev.getX(), (int) ev.getY());
            lastTouchTime = -1;

        } else {
            lastTouchTime = thisTime;
        }
   }
} 
```

# php - 显示单个 Pod 时出现问题

> ID：13765453
> 
> 赞同：2
> 
> 时间：2012-12-07T14:51:07.203
> 
> 标签：php, wordpress, podscms

我是 Pods CMS 和 Wordpress 的新手。我正在运行 pods CMS (2.0) 和 wordpress (3.4.1)。我正在玩 pod，但无法查看单个 pod 页面。

我已经创建了几个像团队等的 pod。我无法运行查看单个页面的 pod。

调试时，Apache 日志中出现 404 错误。似乎存在 .htaccess 问题。这是我的 .htaccess

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /wordpress/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /wordpress/index.php [L]
</IfModule>
# END WordPress 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:08:01.520

不确定，因为我不知道豆荚，但不`RewriteBase /wordpress/`应该`RewriteBase /`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-16T16:50:06.550

Pods 特别容易出现 404，但通常这是一个简单的修复。只需访问永久链接页面。从理论上讲，只需访问该页面就足以修复它，但我喜欢将永久链接切换到其他内容；保存，然后按原样放回永久链接。

通常这足以解决问题。

附带说明一下，您可能不想使用“Pods 页面”，而是使用 Pods 模板，然后这些模板可以显示您的自定义帖子的内容。但是让我们知道你是怎么过的！

# c - 计算具有 sin/cos LUT 的 tan

> ID：13765457
> 
> 赞同：0
> 
> 时间：2012-12-07T14:51:18.277
> 
> 标签：c, optimization

```
#define PARTPERDEGREE 1
double mysinlut[PARTPERDEGREE * 90 + 1];
double mycoslut[PARTPERDEGREE * 90 + 1];
void MySinCosCreate()
{
    int i;
    double angle, angleinc;

    // Each degree also divided into 10 parts
    angleinc = (M_PI / 180) / PARTPERDEGREE;
    for (i = 0, angle = 0.0; i <= (PARTPERDEGREE * 90 + 1); ++i, angle += angleinc)
    {
        mysinlut[i] = sin(angle);
    }

    angleinc = (M_PI / 180) / PARTPERDEGREE;
    for (i = 0, angle = 0.0; i <= (PARTPERDEGREE * 90 + 1); ++i, angle += angleinc)
    {
        mycoslut[i] = cos(angle);
    }
}

double MySin(double rad)
{
    int ix;
    int sign = 1;
    double angleinc = (M_PI / 180) / PARTPERDEGREE;

    if(rad > (M_PI / 2))
        rad = M_PI / 2 - (rad - M_PI / 2);

    if(rad < -(M_PI / 2))
        rad = -M_PI / 2 - (rad + M_PI / 2);

    if(rad < 0)
    {
        sign = -1;
        rad *= -1;
    }

    ix = (rad * 180) / M_PI * PARTPERDEGREE;
    double h = rad - ix*angleinc;
    return sign*(mysinlut[ix] + h*mycoslut[ix]);
}

double MyCos(double rad)
{
    int ix;
    int sign = 1;
    double angleinc = (M_PI / 180) / PARTPERDEGREE;

    if(rad > M_PI / 2)
    {
        rad = M_PI / 2 - (rad - M_PI / 2);
        sign = -1;
    }
    else if(rad < -(M_PI / 2))
    {
        rad = M_PI / 2 + (rad + M_PI / 2);
        sign = -1;
    }
    else if(rad > -M_PI / 2 && rad < M_PI / 2)
    {   
        rad = abs(rad);
        sign = 1;
    }

    ix = (rad * 180) / M_PI * PARTPERDEGREE;

    double h = rad - ix*angleinc;
    return sign*(mycoslut[ix] - h*mysinlut[ix]);
}

double MyTan(double rad)
{
    return MySin(rad) / MyCos(rad);
} 
```

事实证明，使用除法计算比原始函数`tan`更昂贵。`tan`

有没有什么方法可以在`tan`没有除法运算的情况下使用 sin/cos 查找表值来计算，因为除法在我的 MCU 上很昂贵。

使用 tan/sin 或 tan/cos 使用 LUT 并提取结果是否更好，`tan`就像现在对 sin/cos 所做的那样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T10:47:51.867

特别是在微控制器中，除法 y/x 通常可以通过 log & exp 表或迭代乘法进行优化，直到分母 1 +- eps = 1 +- x^(2^n) 为零。

```
y/X = y / (1-x) 
    = (1+x)y / (1+x)(1-x)
    = (1+x)(1+x^2)y / (1-x^2)(1+x^2)
    = (1+x)(1+x^2)(1+x^4)y / (1-x^4)(1+x^4) 
```

# java - Java 接口和内存分配

> ID：13765458
> 
> 赞同：4
> 
> 时间：2012-12-07T14:51:19.357
> 
> 标签：java, memory-management, interface, object-reference

考虑：

```
public SomeClass implements SomeInterface{...}

SomeClass obj = new SomeClass();

SomeInterface x = obj; 
```

我试图将第 3 行与我对内存管理的基本理解联系起来。我知道由“obj”表示的内存位置只包含一个指向 SomeClass 内存位置的指针。假设我使用的是 64 位 JVM，那么最多为“obj”指针分配 64 位。当 JRE 实现 x 时，在内存中创建了什么？它只是一个指向 SomeClass 的 64 位指针吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:53:52.633

无论您如何声明它，每个对象引用都占用相同数量的内存。

两个不同的引用也是如此`x`，`obj`它们恰好指向同一件事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T14:57:06.203

在简单的句子中，引用在 Java 中使用相同的内存，但是声明。

[用于内存分配的堆栈和堆，](http://www.javatutorialhub.com/java-stack-heap.html)这将帮助您详细了解它是如何实现的

![在此处输入图像描述](../Images/fdbe75afeaaad07876fbde26398450c9.png) 作品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T14:56:59.447

没有实际的内存开销，此时的`SomeInterface`声明只是一个语言结构，键入`x`以供编译器稍后检查。

# spring - Spring Hibernate - Dao Return By Id

> ID：13765459
> 
> 赞同：0
> 
> 时间：2012-12-07T14:51:30.463
> 
> 标签：spring, hibernate, dao

我使用 Spring & Hibernate，我想在我的 DAO 中获得一个带有他 ID 的产品。

```
@Repository
@Transactional
public class ProductDaoImpl implements ProductDao {

protected final Log logger = LogFactory.getLog(getClass()); 

@Autowired 
private SessionFactory sessionFactory;

public List<Product> getProductList() {

    return sessionFactory.getCurrentSession().createQuery("from Product p order by p.productName asc").list();
}  

public Product getProductById(int productId) {

    String hql = "from Product p where p.productId = :id";
    Query query = sessionFactory.getCurrentSession().createQuery(hql);
    query.setInteger("id", productId);

    return null;
    }
} 
```

例如，当我想获取所有产品时，我返回它们的列表（调用函数 getProductList() ），但现在我想调用 getProductById 但我不知道如何返回“产品”类型的东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:55:10.933

在您的 getProductById(int productId) 方法中：

```
return (Product) query.uniqueResult(); 
```

# regex - 以下正则表达式匹配什么？

> ID：13765463
> 
> 赞同：-1
> 
> 时间：2012-12-07T14:51:46.563
> 
> 标签：regex

我正在尝试使用 IIS URL 重写将用户带到 WWW 域而不是非 WWW。我遇到了一篇文章，它使用以下正则表达式来匹配域名：

```
^[^\.]+\.[^\.]+$ 
```

我无法弄清楚这个正则表达式匹配什么样的域。这是完整的代码：

```
<rule name="www redirect" enabled="true" stopProcessing="true">
  <match url="." />
  <conditions>
    <add input="{HTTP_HOST}" **pattern="^[^\.]+\.[^\.]+$"** />
    <add input="{HTTPS}" pattern="off" />
  </conditions>
  <action type="Redirect" url="http://www.{HTTP_HOST}/{R:0}" />
</rule>
<rule name="www redirect https" enabled="true" stopProcessing="true">
  <match url="." />
  <conditions>
    <add input="{HTTP_HOST}" **pattern="^[^\.]+\.[^\.]+$"** />
     <add input="{HTTPS}" pattern="on" />
    </conditions>
   <action type="Redirect" url="https://www.{HTTP_HOST}/{R:0}" />
</rule> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:53:26.577

```
^     # anchor the pattern to the beginning of the string
[^\.] # negated character class: matches any character except periods
+     # one or more of those characters
\.    # matches a literal period
[^\.] # negated character class: matches any character except periods
+     # one or more of those characters
$     # anchor the pattern to the end of the string 
```

锚点对于确保域周围没有任何不允许的内容很重要。

正如 Tim Pietzker 所提到的，句点不需要在字符类中转义。

要回答您的问题，最基本的方法是：这匹配什么？任何恰好包含 one 的字符串，`.`它既不是第一个也不是最后一个字符。

# playframework - 运行多个服务器时的定期作业

> ID：13765466
> 
> 赞同：6
> 
> 时间：2012-12-07T14:51:53.613
> 
> 标签：playframework

我打算使用 Play 部署一个应用程序，并且以前从未使用过他们的“工作”。我的部署足够大，需要不同的 Play 服务器负载平衡，但我的计算量不足以需要 hadoop/storm/others。

我的问题是，如何在 Play 中处理这种情况？如果我在 Play 中设置每分钟运行的作业，我不希望每台服务器同时执行完全相同的操作。

我只能找到[这个答案](https://groups.google.com/forum/?fromgroups#!topic/play-framework/K5qWQ7xz0Eo)，但我不喜欢这些选项中的任何一个。

那么，是否有任何工具或最佳实践来协调工作，还是我必须从头开始做某事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:52:28.033

您可以使用此处描述的数据库标志： Pere Villega 的[Playframework 并发作业管理](https://stackoverflow.com/questions/8402552/playframework-concurrent-jobs-management)用于两个作业。

但我认为 Google Groups 上的 Guillaume Bort 使用 Memcache 的解决方案是最好的。Play 2 似乎有一个模块：[https ://github.com/mumoshu/play2-memcached](https://github.com/mumoshu/play2-memcached)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T06:52:58.277

您可以使用数据库中的表来存储 jobLock 但您必须在单独的事务中检查/更新此锁（为此您必须使用 JPA.newEntityManager）

我的 JobLock 类使用 LockMode 枚举

```
package enums;

public enum LockMode {
    FREE, ACQUIRED;
} 
```

这是 JobLock 类

```
package models;

import java.util.Date;
import java.util.List;

import javax.persistence.Entity;
import javax.persistence.EntityManager;
import javax.persistence.EnumType;
import javax.persistence.Enumerated;
import javax.persistence.Version;

import play.Logger;
import play.Play;
import play.data.validation.Required;
import play.db.jpa.JPA;
import play.db.jpa.Model;
import utils.Parser;
import enums.LockMode;
import exceptions.ServiceException;

/**
 * Technical class that allows to manage a lock in the database thus we can
 * synchronize multiple instances that thus cannot run the same job at the same
 * time
 * 
 * @author sebastien
 */
@Entity
public class JobLock extends Model {

    private static final Long MAX_ACQUISITION_DELAY = Parser.parseLong(Play.configuration.getProperty(
            "job.lock.acquisitiondelay", "10000"));

    @Required
    public String jobName;

    public Date acquisitionDate;

    @Required
    @Enumerated(EnumType.STRING)
    public LockMode lockMode;

    @Version
    public int version;

    // STATIC METHODS
    // ~~~~~~~~~~~~~~~

    /**
     * Acquire the lock for the type of job identified by the name parameter.
     * Acquisition of the lock is done on a separate transaction thus is
     * transaction is as small as possible and other instances will see the lock
     * acquisition sooner.
     * <p>
     * If we do not do that, the other instances will be blocked until the
     * instance that acquired the lock have finished is businees transaction
     * which could be long on a job.
     * </p>
     * 
     * @param name
     *            the name that identifies a job category, usually it is the job
     *            simple class name
     * @return the lock object if the acquisition is successfull, null otherwise
     */
    public static JobLock acquireLock(String name) {
        EntityManager em = JPA.newEntityManager();
        try {
            em.getTransaction().begin();
            List<JobLock> locks = em.createQuery("from JobLock where jobName=:name", JobLock.class)
                    .setParameter("name", name).setMaxResults(1).getResultList();
            JobLock lock = locks != null && !locks.isEmpty() ? locks.get(0) : null;
            if (lock == null) {
                lock = new JobLock();
                lock.jobName = name;
                lock.acquisitionDate = new Date();
                lock.lockMode = LockMode.ACQUIRED;
                em.persist(lock);
            } else {
                if (LockMode.ACQUIRED.equals(lock.lockMode)) {
                    if ((System.currentTimeMillis() - lock.acquisitionDate.getTime()) > MAX_ACQUISITION_DELAY) {
                        throw new ServiceException(String.format(
                                "Lock is held for too much time : there is a problem with job %s", name));
                    }
                    return null;
                }
                lock.lockMode = LockMode.ACQUIRED;
                lock.acquisitionDate = new Date();
                lock.willBeSaved = true;
            }
            em.flush();
            em.getTransaction().commit();
            return lock;
        } catch (Exception e) {
            // Do not log exception here because it is normal to have exception
            // in case of multi-node installation, this is the way to avoid
            // multiple job execution
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            // Maybe we have to inverse the test and to define which exception
            // is not problematic : exception that denotes concurrency in the
            // database are normal
            if (e instanceof ServiceException) {
                throw (ServiceException) e;
            } else {
                return null;
            }
        } finally {
            if (em.isOpen()) {
                em.close();
            }
        }
    }

    /**
     * Release the lock on the database thus another instance can take it. This
     * action change the {@link #lockMode} and set {@link #acquisitionDate} to
     * null. This is done in a separate transaction that can have visibility on
     * what happens on the database during the time of the business transaction
     * 
     * @param lock
     *            the lock to release
     * @return true if we managed to relase the lock and false otherwise
     */
    public static boolean releaseLock(JobLock lock) {
        EntityManager em = JPA.newEntityManager();

        if (lock == null || LockMode.FREE.equals(lock.lockMode)) {
            return false;
        }

        try {
            em.getTransaction().begin();
            lock = em.find(JobLock.class, lock.id);
            lock.lockMode = LockMode.FREE;
            lock.acquisitionDate = null;
            lock.willBeSaved = true;
            em.persist(lock);
            em.flush();
            em.getTransaction().commit();
            return true;
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            Logger.error(e, "Error during commit of lock release");
            return false;
        } finally {
            if (em.isOpen()) {
                em.close();
            }
        }
    }
} 
```

这是我使用这个锁的 LockAwareJob

```
package jobs;

import models.JobLock;
import notifiers.ExceptionMails;
import play.Logger;
import play.jobs.Job;

public abstract class LockAwareJob<V> extends Job<V> {

    @Override
    public final void doJob() throws Exception {
        String name = this.getClass().getSimpleName();
        try {
            JobLock lock = JobLock.acquireLock(name);
            if (lock != null) {
                Logger.info("Starting %s", name);
                try {
                    doJobWithLock(lock);
                } finally {
                    if (!JobLock.releaseLock(lock)) {
                        Logger.error("Lock acquired but cannot be released for %s", name);
                    }
                    Logger.info("End of %s", name);
                }
            } else {
                Logger.info("Another node is running %s : nothing to do", name);
            }
        } catch (Exception ex) {
            ExceptionMails.exception(ex, String.format("Error while executing job %s", name));
            throw ex;
        }
    }

    @Override
    public final V doJobWithResult() throws Exception {
        String name = this.getClass().getSimpleName();
        try {
            JobLock lock = JobLock.acquireLock(name);
            if (lock != null) {
                Logger.info("Starting %s", name);
                try {
                    return resultWithLock(lock);
                } finally {
                    if (!JobLock.releaseLock(lock)) {
                        Logger.error("Lock acquired but cannot be released for %s", name);
                    }
                    Logger.info("End of %s", name);
                }
            } else {
                Logger.info("Another node is running %s : nothing to do", name);
                return resultWithoutLock();
            }
        } catch (Exception ex) {
            ExceptionMails.exception(ex, String.format("Error while executing job %s", name));
            throw ex;
        }
    }

    public void doJobWithLock(JobLock lock) throws Exception {
    }

    public V resultWithLock(JobLock lock) throws Exception {
        doJobWithLock(lock);
        return null;
    }

    public V resultWithoutLock() throws Exception {
        return null;
    }
} 
```

在我的 log4j.properties 中，我添加了一个特殊行，以避免每次实例未能获取作业锁时出错

```
log4j.logger.org.hibernate.event.def.AbstractFlushingEventListener=FATAL 
```

使用此解决方案，您还可以使用 JobLock id 来存储与此作业相关的参数（例如上次运行日期）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T07:39:23.260

为了简单起见，我个人会使用一个实例运行作业。或者，如果您想要更好地控制执行和更好的并发、并行处理，您可以考虑使用 Akka 而不是 Jobs。

# c# - 找不到命名空间

> ID：13765467
> 
> 赞同：1
> 
> 时间：2012-12-07T14:52:02.580
> 
> 标签：c#, asp.net, visual-studio-express

我知道这里有多个与同一问题相关的问题，但建议的解决方案似乎都不适合我。话虽如此，我是一个 ASP.NET 菜鸟，所以可能缺少一些明显的东西。

完成[数据访问层教程后，](http://www.asp.net/web-forms/tutorials/data-access/introduction/creating-a-data-access-layer-cs)我尝试使用名为 的数据库创建一个小项目`ASPNETDB.MDF`，布局如下：

![在此处输入图像描述](../Images/9d1c7dfc889dd48def6544ca7c30b05b.png)

我创建了一个名为 myDataSet 的数据集，它位于 App_Code 文件夹中。然后我创建了一个表适配器：

![在此处输入图像描述](../Images/c1aa4bd58d3d15c94889668787db9d2d.png)

按照教程，我知道我应该包括以下行：

```
using myDataSetTableAdapters; 
```

这会导致“找不到命名空间”错误。

我已经尝试将数据集移出 app_code 文件夹，在属性中添加前缀以及此处的问题和答案中的一些其他建议，但到目前为止没有任何效果。

有人有想法么？

-编辑-

按照以下答案中的建议将行更改为使用 Login.App_Code.myDataSetTableAdapters ，现在给了我一个奇怪的错误；类型名称 App_Code 不存在于类型 'System.Web.UI.WebControls.Login' 也许这与问题有关？

-编辑2-

由于站点被命名引起的冲突`Login`，我将其更改为`myLogin`但现在有`namespace myLogin could not be found.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:05:41.330

`myDataSetTableAdapters`应该是包含您的表适配器的命名空间的名称。

# c# - 在安装期间更改服务配置

> ID：13765472
> 
> 赞同：0
> 
> 时间：2012-12-07T14:52:41.317
> 
> 标签：c#, service, installation

我正在集思广益，我必须提出一个新的项目想法，并且我想到了一件我以前从未遇到过的事情，似乎也找不到与我的问题完全相关的任何信息（我可能是错的毫无疑问，链接我的信息需要 30 秒）。

所以，假设我有一个处理一些通信的服务，例如一些 TCP/IP 侦听器/客户端。现在这些将需要 IP/主机名、端口等变量，但作为服务没有 GUI，安装后无法输入这些详细信息，所以我假设可以在安装过程中更新配置？

我以前见过这样做，例如，在 MySQL 服务器服务安装中。它充当一个 GUI，您可以从中输入详细信息，例如您的端口号首选项以及哪些不是服务中使用的，所以我的问题是：如何做到这一点？

编辑：毫无疑问，配置将存储在 XML 文件中，所以我想我真的会在安装过程中查看读/写。

# asp.net - 未获得要在网格视图中显示的 SQL 查询的正确结果

> ID：13765476
> 
> 赞同：0
> 
> 时间：2012-12-07T14:52:46.097
> 
> 标签：asp.net, sql, sql-server, vb.net, vb.net-2010

我有一个查询，它只检索不匹配或不包含字段中可用关键字的`Description`字段记录。所以匹配的不应该出现在 GridView 中，而只有不匹配的。我试图在 GridView 中显示 SQL 查询的结果，但是我得到了匹配的结果，这不是我的要求。`Table 1``Keywords``Table 2`

我尝试在 SQL Server 中运行 SQL 查询，它工作得非常好。即使在我的网络应用程序中它也可以正常工作，但前提是我在`Like`语句之后明确指定关键字。但我希望它跨越所有`Keywords`的`Table2`. 这是我的代码。

```
conn.Open()
For Each row As GridViewRow In Me.GridView1.Rows

    For i As Integer = 0 To GridView2.Rows.Count - 1
        Dim Records1 As String = GridView2.Rows(i).Cells(0).Text
        Dim cmd = New SqlCommand("Select DISTINCT Description From DB.dbo.Table1 " +
                                 "WHERE NOT EXISTS (Select * From [DB].dbo.Table2 WHERE " + 
                                 "Table1.Description LIKE '%' +TABLE2.Keywords + '%')", conn)

        DA.SelectCommand = cmd
        DA.Fill(dt)
        GridView3.DataSource = dt
        GridView3.DataBind()
        cmd.ExecuteNonQuery()
        cmd.Dispose()
        DA.Dispose()
        dt.Clear()
        dt.Dispose()
    Next
Next 
```

`GridView1`有 Table1 的数据 ( `The Description`) `GridView2`有 Table2 的数据 ( `The Keywords`) `GridView3`有查询的结果

但是，如前所述，我仍然得到匹配的。查询的格式是否有问题，是否缺少某些内容或格式不正确？任何建议或想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:56:41.727

那不应该是：

```
WHERE Table1.Description LIKE @Grid)"

cmd.Parameters.AddWithValue("@Grid", "%" + GridView2.Rows(i).Cells(0).Text.ToString() + "%") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:58:09.793

更好的解决方案是在存储过程中执行此操作并传递 @Grid 参数。恕我直言

但是，要具体回答您的问题，这应该有效

```
For i As Integer = 0 To GridView2.Rows.Count - 1
    Dim Records1 As String = GridView2.Rows(i).Cells(0).Text
    Dim cmd = New SqlCommand("Select DISTINCT Description From DB.dbo.Table1 " +
                             "WHERE NOT EXISTS (Select * From [DB].dbo.Table2 WHERE " + 
                             "Table1.Description LIKE "
                             "'%" + GridView2.Rows(i).Cells(0).Text.ToString() + "%')", conn)
    DA.SelectCommand = cmd
    DA.Fill(dt)
    GridView3.DataSource = dt
    GridView3.DataBind()
    cmd.ExecuteNonQuery()
    cmd.Dispose()
    DA.Dispose()
    dt.Clear()
    dt.Dispose()
Next 
```

# objective-c - 如何修复 SBJsonParser 实现文件中的内存泄漏？

> ID：13765481
> 
> 赞同：1
> 
> 时间：2012-12-07T14:53:12.957
> 
> 标签：objective-c, ios, json, memory-leaks, sbjson

在我的应用程序中使用 Instruments ->Leaks 时，我发现最大的内存泄漏在 SBJson Parser 实现文件中：

```
@implementation SBJsonStreamWriterAccumulator
@synthesize data;
- (id)init {
self = [super init];
if (self) {
    data = [[NSMutableData alloc] initWithCapacity:8096u]; //HERE IS 100% LEAK
}
return self;
}
#pragma mark SBJsonStreamWriterDelegate
- (void)writer:(SBJsonStreamWriter *)writer appendBytes:(const void *)bytes length:              (NSUInteger)length {
[data appendBytes:bytes length:length];
 }
 @end 
```

1.如何正确解决这个问题而不使解析器崩溃？

2.为什么在使用SBJson时会出现内存泄漏的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T14:58:23.857

您可能正在将 SBJson 3.1 用于未使用 ARC 的项目。
在 ARC - 这很好。
如果您的项目是非 arc，请使用非 ARC 版本的 SBJson 3.0。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-12T14:53:27.950

1.  Read the SBJson documentation [https://github.com/stig/json-framework/blob/master/NEWS.md](https://github.com/stig/json-framework/blob/master/NEWS.md)
2.  Because people don't bother reading documentation.

There's an open bug to add a pragma to make the files NOT COMPILE unless ARC is used. I just haven't had time to fix it yet. See: [https://github.com/stig/json-framework/issues/151](https://github.com/stig/json-framework/issues/151)

(Disclaimer: I am the SBJson author.)

# jquery - jQuery：根据单选按钮选择更改可选择的下拉选项

> ID：13765483
> 
> 赞同：1
> 
> 时间：2012-12-07T14:53:16.450
> 
> 标签：jquery

我有一个 php web 表单，当用户选择一个单选按钮时，我希望下拉列表中只有某些选项可用。例如，如果我从我的广播组中选择**House**，我只希望用户在下拉列表中看到**House1**、**House2**和**House 3**选项。

这可能使用jquery吗？如果是这样，我将如何编码？

**jsFiddle在这里：http:** [//jsfiddle.net/justmelat/kkk7J/](http://jsfiddle.net/justmelat/kkk7J/)

**html在这里：**

```
<form method="post">
    <fieldset id="Group1" name="Group1">
    <legend>Group box</legend>
    <input id="Radio1" name="Radio1" type="radio" value="House" />House<br />
    <input id="Radio1" name="Radio1" type="radio" value="Condo" />Condo<br />
<input id="Radio1" name="Radio1" type="radio" value="Boat" />Boat<br />
    </fieldset><br/><br/>

    <fieldset id="Group2" name="Group2">
    <legend>Group Options</legend>
    <select id="Select1" name="Select1">
    <option value="HO-House 1">House 1</option>
    <option value="HO-House 2">House 2</option>
    <option value="HO-House 3">House 3</option>
    <option value="CO-Condo 1">Condo 1</option>
    <option value="CO-Condo 2">Condo 2</option>
    <option value="CO-Condo 3">Condo 3</option>
    <option value="BO-Boat 1">Boat 1</option>
    <option value="BO-Boat 2">Boat 2</option>
    <option value="BO-Boat 3">Boat 3</option>

    </select></fieldset></form> 
```

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:12:04.073

它可能看起来像这样：

```
$(function(){

    var select = $('#Select1'),
        options = select.find('option');

    $('[type="radio"]').click(function(){
        var visibleItems = options.filter('[value*="' + $(this).val()  + '"]').show();
        options.not(visibleItems).hide();

        if(visibleItems.length > 0)
        {
            select.val(visibleItems.eq(0).val());
        }
    });
});​ 
```

演示：http: [//jsfiddle.net/kkk7J/2/](http://jsfiddle.net/kkk7J/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T15:18:40.940

最简单的方法是将 css 类分配给选择选项并显示/隐藏它们。

演示：http: [//jsfiddle.net/9Tbpq/](http://jsfiddle.net/9Tbpq/)

```
<form method="post">
    <fieldset id="Group1" name="Group1">
        <legend>Group box</legend>
        <input id="Radio1" name="Radio1" type="radio" value="House" />House<br />
        <input id="Radio1" name="Radio1" type="radio" value="Condo" />Condo<br />
        <input id="Radio1" name="Radio1" type="radio" value="Boat" />Boat<br />
    </fieldset>
    <br/><br/>

    <fieldset id="Group2" name="Group2">
        <legend>Group Options</legend>
        <select id="Select1" name="Select1">
            <option>Select</option>
            <option value="HO-House 1">House 1</option>
            <option value="HO-House 2">House 2</option>
            <option value="HO-House 3">House 3</option>
            <option value="CO-Condo 1">Condo 1</option>
            <option value="CO-Condo 2">Condo 2</option>
            <option value="CO-Condo 3">Condo 3</option>
            <option value="BO-Boat 1">Boat 1</option>
            <option value="BO-Boat 2">Boat 2</option>
            <option value="BO-Boat 3">Boat 3</option>
        </select>
    </fieldset>
</form>​ 
```

.

```
<script>
jQuery(function($) {
    $('input:radio').change(function(){
        var val = $('input:radio:checked').val();
        console.log(val)
        $('#Select1').val(0)
        $('option[value]').hide();
        $('option[value*="-' + val + '"]').show();
    });
});​
</script> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T15:24:20.723

您有两个带有`id`“Radio1”的元素。你可能应该改变它。

代码在这里：http: [//jsfiddle.net/kkk7J/5/](http://jsfiddle.net/kkk7J/5/)

```
//record of temporarily removed  options
var oldoptions = [];

$("[type=radio]").on('click', function () {
   //add all filtered options back
   $("#Select1").append(oldoptions);

   //Remove any option whose text does not contain the text of the selected
   //radio button
   oldoptions = $("#Select1 option:not(:contains(" + $(this).val() + "))").detach();
});​ 
```

分离元素是必要的，因为并非所有浏览器都支持隐藏`<option>`。此外，至少某些浏览器会保留当前选择的选项，即使它被隐藏。这些都可以通过分离轻松解决。

# xml - 使用批处理在特定单词后插入文本

> ID：13765484
> 
> 赞同：0
> 
> 时间：2012-12-07T14:53:19.977
> 
> 标签：xml, text, batch-file, append

我有一系列 XML 文件，我需要在其中添加几行文本，但是附加文本的位置非常重要，否则 XML 文件将不再工作。

`<Tools>`幸运的是，需要在每个 XML 文件中只出现一次的文本之后插入新文本。

如何使用 Windows 批处理，找到文本`<Tools>`并在之后直接插入附加文本？（为了论证的缘故，假设要添加的文本是`<HELLO WORLD>`）

亲切的问候

编辑：

我刚刚意识到我需要替换所有`<Tools>`实例`<Tools> <HELLO WORLD>`

我怎样才能做到这一点？

编辑2：

以下是运行良好但不带引号的vbs

有没有办法用另一个文件的文本内容替换文本

```
 Const ForReading = 1
Const ForWriting = 2

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile("C:\Text.txt", ForReading)

strText = objFile.ReadAll
objFile.Close
strNewText = Replace(strText, "CH1", "*901*")

Set objFile = objFSO.OpenTextFile("C:\Text.txt", ForWriting)
objFile.WriteLine strNewText
objFile.Close 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:55:37.373

引起问题的报价在哪里发挥作用？

有没有办法用另一个文件的文本内容替换文本？你的意思是用另一个文件中的片段替换某些片段吗？

下面将在源文件中找到字符串并输出带有插入的新文件。

```
:: Hide Command and Isolate Scope with Command Extensions
@echo off
setlocal EnableExtensions DisableDelayedExpansion

:: See the following for help
rem echo /?
rem setlocal /?
rem for /?
rem type /?
rem find /?
rem del /?

:: Setup
set "xIn=Test.xml"
set "xOut=Output.xml"
set "xTerm=<Tools>"
set "xInsert=^<HELLO WORLD^>"

:: Validate
if not defined xIn goto End
if not defined xOut goto End

:: Place on Seperate Line Method
if defined xOut if exist "%xOut%" del /f /q "%xOut%" > nul
for /f "usebackq tokens=*" %%a in (`type %xIn%`) do (
    echo.%%a >> %xOut%
    for /f "usebackq tokens=*" %%x in (`echo."%%a" ^| find "%xTerm%"`) do (
        echo.%xInsert% >> %xOut%
    )
)

:: Setup
set "xOut=Output2.xml"

:: Validate
if not defined xOut goto End

:: Place on the Same Line Method
if defined xOut if exist "%xOut%" del /f /q "%xOut%" > nul
for /f "usebackq tokens=*" %%a in (`type %xIn%`) do (
    for /f "usebackq tokens=*" %%x in (`echo."%%a" ^| find /v "%xTerm%"`) do (
        echo.%%a >> %xOut%
    )
    for /f "usebackq tokens=*" %%x in (`echo."%%a" ^| find "%xTerm%"`) do (
        echo.%%a %xInsert% >> %xOut%
    )
)

:End
endlocal 
```

**编辑：**这是上述脚本的修改版本，它将用文件内容替换包含搜索词的行。它应该可以很好地处理报价。请参阅脚本中的 call 命令以了解如何使用它。

```
:: Hide Command
@echo off

set "xResult="
call :ReplaceWith xResult "Source.xml" "<Tools>" "Input.xml" "Output.xml"
echo.%xResult%

goto End

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:ReplaceWith <xReturn> <Source File> <Search Term> <Input File> <Output File>
:: Replace a line in the source file containing the search term with the entire
:: contents of the input file and save the changes to the output file.
:::: Note: Only supports single line search terms.
:: Returns the number of lines replaced.  -1 for error.

:: Hide Commands, Isolate Scope, and Set Abilities
@echo off
setlocal EnableExtensions DisableDelayedExpansion

:: Setup
set "xResult=-1"
set "xSource=%~2"
set "xTerm=%~3"
set "xInput=%~4"
set "xOut=%~5"

:: Validate
if not defined xSource goto EndReplaceWith
if not exist "%xSource%" goto EndReplaceWith
if not defined xTerm goto EndReplaceWith
if not defined xInput goto EndReplaceWith
if not exist "%xInput%" goto EndReplaceWith
set "xResult=0"

:: Search
type nul > %xOut%
for /f "usebackq tokens=* delims=" %%a in (`type "%xSource%"`) do (
    for /f "usebackq tokens=*" %%x in (`echo."%%a" ^| find /v "%xTerm%"`) do (
        echo.%%a>> %xOut%
    )
    for /f "usebackq tokens=*" %%x in (`echo."%%a" ^| find "%xTerm%"`) do (
        type "%xInput%" >> %xOut%
        echo.>> %xOut%
        set /a "xResult+=1"
    )
)
:EndReplaceWith
endlocal & if not "%~1"=="" set "%~1=%xResult%"
goto :eof
:: by David Ruhmann

:End
endlocal 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T14:36:26.837

使用或构造 XSLT 并应用它来保持 XML 有效不是更安全吗？如果你愿意探索这个选项，我会推荐使用像[AltovaXML](http://www.altova.com/altovaxml.html)（免费社区版）这样的命令行 xslt 处理器来在你的批处理文件中使用。
许多 IDE/代码编辑器，例如 Visual Studio/Notepad++/Emacs/Eclipse/...，也有应用甚至调试 XSLT 的方法（有时集成，有时使用插件或附加组件），这在编写转换时可能很方便。

# python - 如何使用 Python 从 .zip 中解压缩特定文件夹

> ID：13765486
> 
> 赞同：22
> 
> 时间：2012-12-07T14:53:27.203
> 
> 标签：python

我正在寻找从 Python 中的 .zip 解压缩特定文件夹：

例如`archive.zip`包含文件夹`foo`，`bar`我想解压缩`foo`到特定位置，保留它的文件夹结构。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-07T15:01:25.423

检查[`zipfile`](http://docs.python.org/3/library/zipfile)模块。

对于您的情况：

```
import zipfile

archive = zipfile.ZipFile('archive.zip')

for file in archive.namelist():
    if file.startswith('foo/'):
        archive.extract(file, 'destination_path') 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-02-01T12:31:21.180

使用 zipfile 库非常非常慢。这是更好的方法：

```
os.system('unzip -P your-password path/to/file.zip') 
```

# sql - SQLite。获取绑定到不同列的值

> ID：13765487
> 
> 赞同：3
> 
> 时间：2012-12-07T14:53:31.447
> 
> 标签：sql

对于每个喜欢学生 B 的学生 A 并且两人不是朋友，找出他们是否有共同的朋友 C（谁能介绍他们！）

我有桌子

```
 Friend (ID1, ID2) 

 Likes(ID1, ID2) 
```

我需要从没有朋友的 Likes 中选择一对 id。

我已经做到了

```
 SELECT L.id1 id1, L.id2 id2
 FROM likes L
 LEFT JOIN friend F ON (L.id1 = F.id1 and L.id2 = F.id2)
 WHERE F.id1 IS NULL 
```

如何找到共同的好友ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:30:20.623

我们需要找到满足以下条件的所有元组：

1.  甲喜欢乙
2.  A 和 C 是朋友
3.  B和C是朋友
4.  A 与 B 不是朋友，B 与 A 不是朋友

完成此操作的查询将是这样的：

```
SELECT L.ID1 as Liker, L.ID2 as Liked, F1.ID2 as MutualFriend
FROM Likes L, Friend F1, Friend F2 
WHERE F1.ID2 = F2.ID2
AND F1.ID1 = L.ID1
AND F2.ID1 = L.ID2
AND NOT EXISTS(
    SELECT * FROM FRIEND F3
    WHERE (F3.ID1 = L.ID1 AND F3.ID2 = L.ID2)
    OR (F3.ID1 = L.ID2 AND F3.ID2 = L.ID1)); 
```

PS 我只在 sqlite3 中测试过，所以在另一个 DBMS 中可能会有轻微的语法错误，但我不这么认为。此外，我的答案返回的答案比共同的朋友 ID 更易读。

希望有帮助，

# android - 应用程序强制关闭 java.lang.NoClassDefFoundError: android/os/AsyncTask

> ID：13765495
> 
> 赞同：1
> 
> 时间：2012-12-07T14:54:04.127
> 
> 标签：android, webview, android-asynctask

我们最近在我们的应用程序中引入了 OAuth 登录。这意味着使用 a`WebView`对用户进行身份验证，然后使用 a`AsyncTask`进行必要的`REST`调用。

不幸的是，在引入这种登录方法后，我们收到了应用程序强制关闭的报告。这似乎与`AsyncTask`登录后执行的其他 s 有关，但不幸的是堆栈跟踪并没有告诉我们太多：

```
java.lang.IllegalStateException: Could not execute method of the activity
at android.view.View$1.onClick(View.java:3100)
at android.view.View.performClick(View.java:3627)
at android.view.View$PerformClick.run(View.java:14329)
at android.os.Handler.handleCallback(Handler.java:605)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4511)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.reflect.InvocationTargetException
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at android.view.View$1.onClick(View.java:3095)
... 11 more
Caused by: java.lang.NoClassDefFoundError: android/os/AsyncTask
at com.foo.bar.TransmissionActivity.transmit(TransmissionActivity.java:44)
... 14 more 
```

我们设法通过使用 RoboAsyncTask（来自 RoboGuice）而不是来自 Android SDK 来修复上述错误`AsyncTask`，但我们还有其他使用`WebView`s. `WebView`显然`AsyncTask`在其调用堆栈中的某处使用，并且与上面显示的错误（`Caused by: java.lang.NoClassDefFoundError: android/os/AsyncTask`）类似的错误已开始显示在我们的错误日志中。

该错误发生在不同的设备和不同的 Android 版本上，没有明显的模式。我们试图自己重现错误，但没有任何运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T07:40:33.370

这可能是构建设置的问题。（已知 src/gen 的构建顺序会导致一些问题，被称为 lib 的兼容库的 libs 文件夹在新的 sdk 版本上对我造成了一些问题）。

看看它是否创建了一个新项目（在 eclipse 中，因为那是 100% android 官方的）。添加一个 webview 和一个 asynctask，然后用你的项目对项目进行比较。忽略 src/gen/res。希望您会发现 src/gen 的构建顺序错误或类似的东西。

~ 安德斯

# matlab - 在 matlab 中编写 Private Dicom 数据而不修改字典

> ID：13765510
> 
> 赞同：5
> 
> 时间：2012-12-07T14:54:41.597
> 
> 标签：matlab, dicom

我正在读取 matlab 中的 dicom 文件并修改其中的一些数据并尝试将其保存到另一个文件中，但是在这样做的同时，私有 dicom 数据要么根本不写入（当“WritePrivate”设置为 0 时）或者它是写成一个 UINT8 数组，变得难以理解和无用。我什至尝试将我从原始 dicom 文件中获取的数据复制到新结构并写入新的 dicom 文件，但即使私有数据在新结构中保持良好，它在新 dicom 文件中也不会保持不变。有没有办法在不更改 matlab dicom 字典的情况下复制到新的 dicom 文件时保持这些私有数据的完整性？

我提供了以下代码来显示我正在尝试做的事情。

```
X=dicomread('Bad011_4CH_01.dcm');
metadata = dicominfo('Bad011_4CH_01.dcm');
metadata.PatientName.FamilyName='LastName';
metadata.PatientName.GivenName='FirstName';
birthday=metadata.PatientBirthDate;
year=birthday(1,1:4);
newyear=strcat(year,'0101');
metadata.PatientBirthDate=newyear;
names=fieldnames(metadata);

h=metadata;

dicomwrite(X,'example.dcm',h,'CreateMode','copy');

newh=dicominfo('example.dcm'); 
```

这里 newh 中的数据不包含任何私有数据。如果我将代码更改为以下

```
dicomwrite(X,'example.dcm',h,'CreateMode','copy','WritePrivate',1); 
```

在这种情况下，私有数据被完全更改为一些 UIN8 数组并且无用。我的任务的理想解决方案是在不更改 matlab dicom 字典的情况下将私有数据保留在新创建的 dicom 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:38:20.757

您是否尝试过类似的方法：

```
dicomwrite(uint16(image), fileName, 'ObjectType', 'MR Image Storage', ...
    'WritePrivate', true, header); 
```

其中“header”是由名称-值对组成的结构，其格式与您从 MATLAB 的 dicominfo 函数获得的标头数据相同？我在 MATLAB 中创建图像的一般方法是避免使用 CreateMode 'copy'，而是通过显式复制有意义的属性来构建我自己的 DICOM 标头，并为应该具有新值的属性生成我自己的值。

要编写私有标签，您可以执行以下操作：

```
header.Private_0045_10xx_Creator = 'MY_PRIVATE_BLOCK';
header.Private_0045_1001 = int32(65535); 
```

如果您随后使用 dicomwrite 将其写出并在 using 中读回`hdr = dicominfo('mynewimg');`，您会看到它确实将值写入为 32 位整数，尽管不幸的是，if 总是将数据作为 uint8 的向量*读*入价值观。

```
>> hdr.Private_0045_1001

ans =

  255
  255
    0
    0 
```

只要您知道预期的类型，您就应该能够在阅读标题后将数据类型转换回所需的类型。例如：

```
>> typecast(hdr.Private_0045_1001, 'int32')

ans =

   65535 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-09T13:51:44.093

我知道我迟到了大约 8 年，但你有没有试过

```
dicomwrite(..., 'VR', 'explicit') 
```

?

它为我解决了“读取为 uint8”的问题。

编辑：

实际上，您似乎需要使用该标签的 VR 指定一个 dicom 字典。如果你把它和'VR'、'explicit'结合起来，那么读取dicom的程序就不需要字典文件了。

# ruby-on-rails - an_instance_of Mail::Message 未返回 true

> ID：13765512
> 
> 赞同：1
> 
> 时间：2012-12-07T14:54:55.830
> 
> 标签：ruby-on-rails, ruby, rspec

根据[这些关于 Rspec 匹配器的文档](http://rspec.rubyforge.org/rspec/1.1.9/classes/Spec/Matchers.html)，调用`an_instance_of`是另一种调用方式`instance_of?(Class)`。当我在控制台中测试时，这工作正常，但在我的规范中它失败了。

**在控制台中：**

```
m = Mail.new
=> #<Mail::Message:70144097437100, Multipart: false, Headers: >
m.instance_of?(Mail::Message)
=> true 
```

**失败：**

```
1) IncomingEmailsController should deliver the email with lead info
     Failure/Error: post :create, to: "me@example.com", text: "Content", html: "HTML Content", from: "email@example.com", subject: "Jimmy Bean"
       <UserMailer (class)> received :forward_email with unexpected arguments
         expected: (#<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007feff35fd148 @klass=Mail::Message>)
              got: (#<Mail::Message:70334278571020, Multipart: true, Headers: <From: email@example.com>, <To: me@example.com>, <Subject: Jimmy Bean>, <Content-Type: multipart/alternative; boundary=--==_mimepart_50c1ffa9e2ba2_2e1e3ff7f8c35ad49574>>, nil) 
```

**incoming_emails_controller_spec.rb**

```
describe IncomingEmailsController do

  it "should deliver the email with lead info" do
    # expect
    UserMailer.should_receive(:forward_email).with(an_instance_of(Mail::Message))
    # when
    post :create, to: "me@example.com", text: "Content", html: "HTML Content", from: "email@example.com", subject: "Jimmy Bean"
  end

end 
```

**传入电子邮件控制器.rb**

```
def create
    # create a Mail object from the params sent by Sendgrid
    prepare_email(params) #returns @email (instance of Mail::Message)
    UserMailer.forward_email(@email).deliver
end

private

def prepare_email(params)
    email = Mail.new
    email.to = params["to"]
    email.from = params["from"]
    email.subject = params["subject"]

    text_part = Mail::Part.new
    text_part.body = params["text"]

    html_part = Mail::Part.new
    html_part.content_type = 'text/html; charset=UTF-8'
    html_part.body = params["html"]

    email.text_part = text_part
    email.html_part = html_part
    @email = email
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-27T15:40:51.337

看起来这已经解决了：[https](https://github.com/rspec/rspec-mocks/issues/202) ://github.com/rspec/rspec-mocks/issues/202 。

# java - Java SQL 语句既没有给出错误也没有给出结果集

> ID：13765513
> 
> 赞同：0
> 
> 时间：2012-12-07T14:55:03.007
> 
> 标签：java, sql, database, resultset

我的程序中有以下 SQL 语句：

```
"SELECT ANTAL_KALD,BESVARET_25_SEK,((BESVARET_25_SEK/nullif(ANTAL_KALD,0))*100) as answer_percent,TIDSPUNKT,QUEUE "
                +"FROM KS_DRIFT.PERO_NKM_KØ_OVERSIGT WHERE TIDSPUNKT BETWEEN '"+start.getYear()+"-"+start.getMonthOfYear()+"-"+start.getDayOfMonth()+
                "' AND '"+end.getYear()+"-"+end.getMonthOfYear()+"-"+end.getDayOfMonth()+
                "'"; 
```

这没有给我任何结果集

测试`System.out.println(rs.next())`是`false`

但是，当我在我的数据库中写入以下内容时：

```
select QUEUE,
ANTAL_KALD,
BESVARET_25_SEK,
((BESVARET_25_SEK/nullif(ANTAL_KALD,0))*100) as answer_percent,
TIDSPUNKT
from KS_DRIFT.PERO_NKM_KØ_OVERSIGT Where TIDSPUNKT BETWEEN '2012-12-01' AND '2012-12-02' ORDER BY QUEUE 
```

我得到了结果.. 那么问题是什么？它没有给我错误或任何东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:09:02.050

假设`start`and`end`是`java.sql.Date`对象（如果不是，请转换），我建议您使用`PreparedStatement`with`setDate()`来设置日期，如下所示：

```
 String sql = "SELECT ANTAL_KALD,BESVARET_25_SEK, "+
               " ((BESVARET_25_SEK/nullif(ANTAL_KALD,0))*100) as answer_percent, "+
               " TIDSPUNKT,QUEUE "
               +"FROM KS_DRIFT.PERO_NKM_KØ_OVERSIGT "+
               " WHERE TIDSPUNKT BETWEEN ?  AND ?";
   PreparedStatement qStmt=connection.prepareStatement(sql);
   qStmt.setDate(1, start);
   qStmt.setDate(1, end);

   ResultSet rs = qStmt.executeQuery(); 
```

**编辑**：要从`java.sql.Date`Joda `DateTime`Object 获取，请执行以下操作：

```
 java.sql.Date startDate = new java.sql.Date(start.toDate().getTime());
   java.sql.Date endDate   = new java.sql.Date(end.toDate().getTime()); 
```

在查询中使用这些转换后的对象。

# php - jquery移动表单不提交

> ID：13765514
> 
> 赞同：0
> 
> 时间：2012-12-07T14:55:05.750
> 
> 标签：php, jquery, mysql, jquery-mobile, submit

我想使用 php 表单获取一些用户数据并将其存储在 mysql 数据库中，问题是，当我提交表单时页面只是刷新。

这是我的php表单：

```
<form id="companyform" name="companyform" method="post" action="index3.php" data-ajax="false">
<b>To enlist your business fill in the form below:</b>
<p>
<label for="name">Company Name:</label>
<input type="text" name="companyname" id="companyname"  data-mini="true"/>
</p>
<p>
<label for="name">Company Address:</label>
<input type="text" name="companynaddress" id="companynaddress"  data-mini="true"/>
</p>
<p>
<label for="textfield">Tel No.:</label>
<input type="text" name="tel" id="tel"  data-mini="true"/>
</p>
<p>
<label for="textfield">Fax No.:</label>
<input type="text" name="fax" id="fax"  data-mini="true"/>
</p>
<p>
<label for="textfield">Email:</label>
<input type="text" name="email" id="email"  data-mini="true"/>
</p>
<p>
<label for="textfield">Website Address:</label>
<input type="text" name="website" id="website"  data-mini="true"/>
</p>

<p>
<label for="textfield">Contact Person Name:</label>
<input type="text" name="contactname" id="contactname"  data-mini="true"/>
</p>

<p>
<label for="textfield">Contact Person Number:</label>
<input type="text" name="contactnumber" id="contactnumber"  data-mini="true"/>
</p>

<p>
<label for="textfield">Contact Person Email:</label>
<input type="text" name="contactemail" id="contactemail"  data-mini="true"/>
</p>

<p>
<input name="submit" type="submit" id="submit" value="Submit" />
</p>
</form> 
```

这是我的数据库连接代码：

```
<?php

if (array_key_exists('submit', $_POST)) {

$con = mysql_connect("host",    "user", "pass");

if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("botswanasearchdb", $con);

$companyname = $_POST['companyname'];
$companyaddress = $_POST['companyaddress'];
$tel = $_POST['tel'];
$fax = $_POST['fax'];
$emailid = $_POST['emailid'];
$website = $_POST['website'];
$contactname = $_POST['contactname'];
$contactnumber = $_POST['contactnumber'];
$contactemail = $_POST['contactemail'];

// prepare the SQL query
 $sql = "INSERT INTO businessuser (companyname, companyaddress, tel, fax, emailid,   website, contactname, contactnumber, contactemail) VALUES ('$companyname',   '$companyaddress', '$tel', '$fax', '$emailid', '$website', '$contactname', '$contactnumber', '$contactemail')";
mysql_close($con);
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:20:08.953

这是您的表单标签：

```
<form id="companyform" name="companyform" method="post" action="index3.php" data-ajax="false"> 
```

因此，您将表单提交给`index3.php`（`action`属性）。根据您的评论`index3.php`包含您的表单，这就是为什么表单在您提交时刷新。您基本上是在提交表单时重新加载表单。

您需要将表单提交到包含您发布的 php 代码的 php 脚本。

**编辑：**如果所有内容都在同一页面上，您可以执行以下操作：

```
if (array_key_exists('submit', $_POST))
{
  // your code

  // show thank you message
}
else
{
  // show form
} 
```

**另一个编辑：**当您使用已弃用的`mysql_*`函数而不是转义数据时，您有一个整体的 sql 注入，并且`'`数据中的一个字符会破坏您的查询。您应该切换到 PDO / mysqli 和准备好的语句。并始终添加错误处理。

# java - 程序中间断网测试效果

> ID：13765519
> 
> 赞同：1
> 
> 时间：2012-12-07T14:55:28.670
> 
> 标签：java, unit-testing, testing, automated-tests

我想在执行程序的特定行之前测试网络连接断开的效果。比如考虑这个执行顺序：

```
1\. Connect to database.
2\. Get country list from database.
3\. Get a random country from list.
4\. Get city list of this country from database. 
```

如果网络连接在语句 4 之前断开，我想测试程序的行为。我可以通过设置断点，在遇到断点时关闭数据库，然后继续运行程序来使用调试器对其进行测试。

我想知道如何以更系统和更强大的方式完成此任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:12:57.053

假设 4 行伪代码在 MyService 中，并且 MyService 使用 MyDAO 访问数据库，您将有以下内容：

```
public class MyService {

    private MyDAO myDAO;

    public MySErvice(MyDAO myDAO) {
        this.myDAO = myDAO;
    }

    public List<City> getRandomCityList() {
        List<Country> countries = myDAO.getCountries();
        Country c = pickRandom(countries);
        return myDAO.getCities(country);
    }
} 
```

要对其进行测试，请使用 Mockito 之类的模拟框架来模拟 MyDAO，并将此模拟注入 MyService 实例。当网络出现故障时，当它的方法被抛出时，使模拟抛出与真正的 MyDAO 抛出的异常相同的异常`getCities()`，看看 MyService 是否做了正确的事情：

```
MyDAO mockDAO = mock(MyDAO.class);
List<Country> countries = Arrays.asList(new Country(...));
when(mockDAO.getCountries()).thenReturn(countries);
when(mockDAO.getCities((Country) any(Country.class))).thenThrow(new NetworkIsDownException());

MyService underTest = new MyService(mockDAO);
// TODO call underTest.getRandomCityList() and check that it does what it should do. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:16:01.063

一个不可移植的解决方案可能是修改运行测试的系统的防火墙规则，例如在使用 iptables 的 Linux 上，以删除包，从而模拟网络中断。

一个更便携的解决方案可能是将您的数据库连接到的 URI 包装在一些可以模拟网络中断的代理周围，就像[ActiveMQ 的 SocketProxy](http://svn.apache.org/repos/asf/activemq/trunk/activemq-broker/src/test/java/org/apache/activemq/util/SocketProxy.java)。不过，这仅在您的 API 使用 URI 连接到数据库时才有效。

# ruby-on-rails - rvmsudo 命令无法正常工作

> ID：13765520
> 
> 赞同：5
> 
> 时间：2012-12-07T14:55:33.117
> 
> 标签：ruby-on-rails, ruby, rvm, ubuntu-12.04

我正在尝试获取 RoR 环境的更新版本。

我正在运行 Ubuntu 12.04，我有这个设置：

```
$ groups
user adm cdrom sudo dip plugdev lpadmin sambashare rvm
$ rvm -v
rvm 1.17.2 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]
$ rvm list

rvm rubies

=* ruby-1.9.3-p327 [ x86_64 ]

# => - current
# =* - current && default
#  * - default
$ ruby -v
ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-linux]
$ gem -v
1.8.24
$ rails -v
Rails 3.2.9 
```

一切正常。但是现在我正在尝试安装 Thin，我发现我的 rvmsudo 命令几乎没用：

```
$ rvmsudo echo 1
1
$ rvmsudo ruby -v
sudo: ruby: command not found
$ rvmsudo gem -v
sudo: gem: command not found
$ rvmsudo rails -v
sudo: rails: command not found 
```

当我运行“rvmsudo Thin install”时出现同样的错误。

我完全被困住了。在 Ubuntu 10.04 中它运行良好，甚至我在 12.04 中的第一次测试也让 rvmsudo 运行良好。这次我遵循了完全相同的步骤，但似乎没有任何效果。

我使用“curl -L [https://get.rvm.io](https://get.rvm.io) | sudo bash -s stable”安装了 RVM，我将自己添加到 rvm 组，重新启动机器，使用“source /etc/profile.d/rvm.sh “并正常安装了我的东西。

我在这里错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T18:33:25.333

`export rvmsudo_secure_path=1`在文件的最后添加`~/.bashrc`并重新启动终端。

这对我*有用（Ubuntu 12.10 运行 bash）*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-19T21:42:11.697

这是因为您已在您的中设置了 secure_path 选项，`/etc/sudoers`并且该选项的值与您当前的 shell 不同`$PATH`。

解决方案：

1.  将以下命令添加到您的 shell 初始化脚本（对于 bash 销售，对于 *nix 是 .bashrc，对于 mac os x 是 .bash_profile）

    ```
    export rvmsudo_secure_path=0  # means don't use the value in rvmsudo 
    ```

2.  将 rvm 和 Ruby 的路径添加到该`secure_path`值。

从我的角度来看，第一个更可取。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:22:36.180

我设法让它工作。

我看到了[这个 serverfault 页面](https://serverfault.com/questions/452907/how-do-you-configure-rvmsudo-using-chef)，我认为问题很相似，所以我试了一下。

RVM 1.17 版似乎有些问题。我使用以下命令安装了以前的版本：

```
\curl -L https://get.rvm.io | sudo bash -s -- --version 1.16.13 
```

但请注意，RVM 1.17 安装 ruby​​-1.9.3-p327，而 RVM 1.16.13 安装 ruby​​-1.9.3-p286。

从 1.16.13 更新也不起作用，所以希望他们尽快修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T18:28:30.457

这似乎已在最新的 1.18.x 版本中得到修复。我升级到版本 1.18.5，这个问题就消失了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-21T17:34:38.210

更新 rvm 和 ruby​​ 后我有同样的问题，并且 rvmsudo_secure_path=1 对我有帮助，如[http://www.snowcrash.eu/rvmsudo_secure_path/中所述](http://www.snowcrash.eu/rvmsudo_secure_path/)

# javascript - 为什么函数在 javascript 中用于类？

> ID：13765525
> 
> 赞同：3
> 
> 时间：2012-12-07T14:55:53.587
> 
> 标签：javascript

我正在开发一个小型库，以根据用户提供的规范构建对象。它们可以具有继承和更多的类特性。

但是，我的方法与通常的方法不同，因为我没有将函数用作类。

这是创建对象的示例：

```
var objectTest = {
    someVar: 5,
    someMethod: function () {...}
}; 
```

这真的是我想要的。但是，所有其他类的实现都有不同的方法。所有这些最终都具有作为类的函数。

* * *

编辑：（澄清）

通常的做法：

*   使用函数作为类。
*   使用“new className()”创建新函数并将它们用作对象。

我的做法：

*   使用库来指定基本值/方法以及它们如何相互继承。
*   使用“myLib.create('className')”创建新对象并将它们用作对象。

* * *

我可以理解它背后的原因，使用原型可能更合乎逻辑。

但我想知道我的方法是否有任何我看不到的缺点，或者我正在做的事情可能被称为别的东西。

欢迎任何帮助或批评。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:58:06.833

与使用原型相比，您的方法有这些缺点：

*   您为对象的每个值定义一个新函数：这会减慢对象的创建速度，并且会占用无用的内存
*   你不能像原型一样定义继承

所以你并没有真正定义一个类，因为只有当实例可以共享相同的行为，但只有一个对象时，一个类才有意义。

另一方面，当您只想要一个“实例”时，您所做的一切都很好。

MDN 提出了[关于原型继承的良好指南](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_and_the_prototype_chain)。

* * *

为什么我说你为每个实例定义一个新函数：

```
var obj1 = {
    someVar: 5,
    someMethod: function () {console.log(this.someVar)}
};
var obj2 = {
    someVar: 5,
    someMethod: function () {console.log(this.someVar)}
};
console.log(obj1.someMethod==obj2.someMethod); // logs false 
```

虽然原型的使用不会复制功能：

```
function MyClass(avar){
    this.someVar = avar;
}
MyClass.prototype.someMethod = function(){
    console.log(this.someVar);
};
var obj1 = new MyClass();
var obj2 = new MyClass();
console.log(obj1.someMethod==obj2.someMethod); // logs true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:05:41.280

您看到函数用于类概念的原因是范围。JavaScript 是函数作用域的，因此对于包含（即没有命名空间或类型名称冲突等），函数是一种捕获作用域的方法。在 JavaScript 中的对象定义上，一切基本上都是公共集合的一部分。如果这是您需要的行为，那么您的方法很好。如果您需要保护任何变量或方法以使其私有或将服务范围限定为唯一的命名空间以避免冲突或允许可扩展性，您将需要了解函数和闭包并将它们作为服务实现为您的类。

这是一篇关于将其范围限定为模块级别的精彩帖子： [http ://weblogs.asp.net/dwahlin/archive/2011/08/02/techniques-strategies-and-patterns-for-structuring-javascript-code-revealing -module-pattern.aspx](http://weblogs.asp.net/dwahlin/archive/2011/08/02/techniques-strategies-and-patterns-for-structuring-javascript-code-revealing-module-pattern.aspx)

原型级别： [http ://weblogs.asp.net/dwahlin/archive/2011/08/03/techniques-strategies-and-patterns-for-structuring-javascript-code-revealing-prototype-pattern.aspx](http://weblogs.asp.net/dwahlin/archive/2011/08/03/techniques-strategies-and-patterns-for-structuring-javascript-code-revealing-prototype-pattern.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:03:55.513

JavaScript 只允许将函数用作对象的构造函数。

如果我们有这个：

```
function Foo() {
    this.bar = "bar";
}

var b = new Foo();
alert(b.bar); "bar" 
```

我们使用该`Foo`函数作为构造函数创建了一个新对象。在对象的创建中加入一些逻辑很方便。

* * *

它还允许您设置继承的值。通过向 的`.prototype`对象添加属性`Foo`，您创建的新对象将继承这些属性。

```
function Foo() {
    this.bar = "bar";
}
Foo.prototype.alertBar = function() {
    alert(this.bar);
}

var b = new Foo();
b.alertBar(); 
```

所以现在`b`对象自动继承该`alertBar`方法，即使它没有在对象上显式定义。

* * *

绝对不需要将函数用作构造函数。如您所知，您可以只使用文字语法来创建单个对象。

您也可以在不使用构造函数的情况下设置继承。假设您想要一些对象都应该从一组值继承。您可以使用`Object.create`.

```
var base = {
    foo: "bar"
}; 
```

现在，如果我们使用来创建新对象，并且如果我们作为第一个参数`Object.create`传递，那么新对象将继承自.`base``base`

```
var a = Object.create(base);
var b = Object.create(base);
var c = Object.create(base);

a.foo; // "bar"
b.foo; // "bar" 
```

所以你看到我们可以在没有构造函数的情况下创建对象，但仍然可以获得原型继承的好处。

* * *

最后，您可以将函数与普通对象结合起来创建新对象，而无需实际使用函数作为典型的构造函数。为此，您只需让函数返回一个使用文字语法创建的对象。

```
var fooMaker = (function() {

    var getBar = function() {
        return this.bar;
    };

    return function fooMaker() {

        return {
            bar: "bar",
            getBar: getBar
        };
    };
})();
var f = fooMaker();

f.getBar(); // "bar" 
```

# javascript - 生成与 Leaflet 一起使用的 GeoJSON 网格

> ID：13765528
> 
> 赞同：3
> 
> 时间：2012-12-07T14:56:12.007
> 
> 标签：javascript, json, mapping, leaflet, geojson

我正试图围绕生成非现实世界地图的最佳方法。我有一个客户，他想基本上创建一组数千个块，这些块可以以与 Leaflet 地图 ( [http://leafletjs.com](http://leafletjs.com) ) 交互的相同方式进行交互。

我了解如何使用 Leaflet，我认为最好的方法是创建一个 GeoJSON 文件，其中包含要在空白图块集上映射的块，但我无法找出生成 GeoJSON 文件的最佳方法。

这是我希望能够显示的粗略图像。当您缩小时，这些块将是可缩放的，并最终形成更大的图像。这些块可能是猫的形状，但您可以放大并单独悬停/单击每个块：

![在此处输入图像描述](../Images/eefd24ffa0bffb20d07da4e6940c8b09.png)

我过去曾这样做是为了使用 GeoJSON 文件来绘制州/国家/地区，但我总是从其他来源提取这些文件。关于如何生成这些块/构建块的 GeoJSON 文件的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T16:52:35.317

要制作网格，您可以使用 GeoJSON MultiPolygon [http://wiki.geojson.org/GeoJSON_draft_version_6#MultiPolygon](http://wiki.geojson.org/GeoJSON_draft_version_6#MultiPolygon)

对于非真实地图（仅图像），我使用以下代码为 Leaflet 生成网格：

```
var countX = 10; //cells by x
var countY = 10; //cells by y
var cellWidth = mapWidth / countX;
var cellHeight = mapHeight / countY;

var coordinates = [],
    c = {x: 0, y: mapHeight}, //cursor
    //top-left/top-right/bottom-right/bottom-left
    tLx, tLy,   tRx, tRy,
    bRx, bRy,   bLx, bLy;

// build coordinates array, from top-left to bottom-right
// count by row
for(var iY = 0; iY < countY; iY++){
  // count by cell in row
  for(var iX = 0; iX < countX; iX++){
    tLx = bLx = c.x;
    tLy = tRy = c.y;
    tRx = bRx =c.x + cellWidth;
    bRy = bLy = c.y - cellHeight;
    var cell = [
      // top-left/top-right/bottom-right/bottom-left/top-left
      [tLx, tLy], [tRx, tRy], [bRx, bRy], [bLx, bLy], [tLx, tLy]
    ];
    coordinates.push(cell);
    // refresh cusror for cell
    c.x = c.x + cellWidth;
  }
  // refresh cursor for row
  c.x = 0;
  c.y = c.y - cellHeight;
}

var grid = {
  type: 'FeatureCollection',
  features: [
    {
      type: 'Feature',
      geometry: {
        type:  'MultiPolygon',
        coordinates: [coordinates]
      }
    }
  ]
};
// add grid to map
L.geoJson(grid).addTo(map); 
```

要将事件绑定到每个单元格，文档[http://leafletjs.com/reference.html#geojson中有一个很好的示例](http://leafletjs.com/reference.html#geojson)

# php - PHP如何调用函数onClick

> ID：13765531
> 
> 赞同：-2
> 
> 时间：2012-12-07T14:56:35.190
> 
> 标签：php, javascript

我需要在加载页面之前调用这个函数 Hello()，发生的情况是：函数完成但 location.href 不起作用，我需要它如何工作？

```
<input type=button onClick="return Hello(this);location.href='go.php?f_name=<?php echo             $_POST['f_name']; ?>&job=<?php echo $_POST['job']; ?>&id_up=<?php echo $count1;?>'" value='Save'> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:57:58.580

您正在`Hello()`从`onclick`事件返回结果。因此，此后的任何内容都不会被调用。删除`return`，它应该可以正常工作：

```
<input type=button onClick="Hello(this);location.href='go.php?f_name=<?php echo             $_POST['f_name']; ?>&job=<?php echo $_POST['job']; ?>&id_up=<?php echo $count1;?>'" value='Save'> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:09:29.037

```
i try it but when function return false it should stay on same page 
```

**编辑 ：**

```
<?php
$_POST['f_name']    = 'stack';
$_POST['job']       = 'over';
$count1             = 'flow';
$valid_m            = 10;
?>
<script language='JavaScript' type='text/JavaScript'>
function Hello() 
{
    if ((document.f1.f_name.value == '') || (document.f1.job.value == '')) {
        alert('Please fill all fields');
        return false;
    }
    if ((1 > '<?php echo $valid_m ?>')) {
        alert('you should <?php echo $valid_m ?>, upload your sick leave letter');
        return false;
    }
    return true;
}
</script>
<input type=button onClick="if(Hello(this)) location.href='go.php?f_name=<?php echo $_POST['f_name']; ?>&job=<?php echo $_POST['job']; ?>&id_up=<?php echo $count1;?>'" value='Save'> 
```

# php - 在异常中使用 print_r？

> ID：13765533
> 
> 赞同：2
> 
> 时间：2012-12-07T14:56:38.847
> 
> 标签：php

> **可能重复：**
> [将 print_r 结果放入变量中](https://stackoverflow.com/questions/5762515/putting-print-r-results-in-variable)

我抛出一个异常并试图在异常中包含一个变量，如下所示：

```
throw new Exception('Oh no, an exception! ' . $variable); 
```

`$variable`（数组在哪里）

问题是，这只会将以下内容放在我的日志文件中：

> 不，例外！大批

不幸的是，我不是 PHP 专家，我猜这可能意味着以下两件事之一：

1) $variable 是一个空数组

2) $varialbe 是一个包含数据的数组，但在异常中输出它并不会输出其所有内容

如果 1) 是这种情况，请告诉我（我希望不是）

但是，如果 2) 是这种情况，我怎样才能获得有关的更多信息`$variable`？是否可以执行`print_r`或`var_dump`在异常内部执行如下操作：

```
throw new Exception('Oh no, an exception! ' . print_r($variable)); 
```

还是会导致问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T14:58:37.350

> 还是会导致问题？

是的，它会。将[`print_r`](http://php.net/print_r)在字符串完全构造之前评估，如果您尝试打印出`Exception`消息，输出将如下所示：

```
大批
(
    [x] => 5
    [y] => 65
)
哦不，一个例外！1

```

要解决此问题，您需要确保将[`print_r`](http://php.net/print_r)'s`$return`参数设置为`true`以便返回值而不是回显：

```
throw new Exception('Oh no, an exception! ' . print_r($variable, true)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-07T14:58:49.640

使用第二个参数 true 来返回输出而不是立即输出。

`print_r($variable, true)`

[文档是你的朋友](http://us2.php.net/manual/en/function.print-r.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T14:58:42.947

如果您查看 的[文档`print_r`](http://us2.php.net/manual/en/function.print-r.php)，您会看到第二个参数（如果为真）会导致函数将信息作为字符串返回，而不是立即发出。

# c++ - 围绕对象旋转的矩阵乘法opengl

> ID：13765534
> 
> 赞同：0
> 
> 时间：2012-12-07T14:56:41.667
> 
> 标签：c++, opengl

我创建了 2 个圆圈，一个围绕另一个旋转，就像月亮围绕太阳旋转一样。

我沿着 z 轴平移，然后围绕 y 轴应用旋转以使物体进入轨道。我需要计算 yRotation * ZTranslation * (0,0,0,1) 的矩阵乘法

IE

```
(cos(angle)   0  sin(angle)  0  ) ( 1  0  0   0   ) ( 0 )
(    0        1      0       0  ) ( 0  1  0   0   ) ( 0 )
(-sin(angle)  0  cos(angle)  0  ) ( 0  0  1 zTran ) ( 0 ) 
(    0        0      0       1  ) ( 0  0  0   1   ) ( 1 ) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:08:33.467

由于您在谈论圆圈，因此我假设您正在制作 2D 应用程序。

在 OpenGL 中，您有以下坐标：

```
 Y
   |
   |
   |
   O---- X
  /
 /
Z 
```

这意味着您的 2D 应用程序位于 XY 空间中，Z 垂直于显示器（并且朝向外部）。

所以，如果你有一个围绕另一个圆，你可能意味着首先在 XY 平面上平移这个圆（例如在 Y 轴上），然后在**Z**轴上应用一个旋转。

所以你的矩阵乘法应该是：

```
(cos(angle)   sin(angle)  0  0 ) ( 1  0  0   0   ) ( circle_center_x )
(-sin(angle)  cos(angle)  0  0 ) ( 0  1  0 yTran ) ( circle_center_y ) 
(    0            0       1  0 ) ( 0  0  1   0   ) (        0        )
(    0            0       0  1 ) ( 0  0  0   1   ) (        1        ) 
```

或者只是在 2D 中：

```
(cos(angle)   sin(angle) 0 ) ( 1  0   0   ) ( circle_center_x )
(-sin(angle)  cos(angle) 0 ) ( 0  1 yTran ) ( circle_center_y ) 
(    0            0      1 ) ( 0  0   1   ) (        1        ) 
```

使用 OpenGL 函数：

```
glRotatef(angle, 0, 0, 1);
glTranslatef(0, yTran, 0);
glBegin(GL_LINE_LOOP);
for (...)
    /* points of circle around circle_center_x/y */
glEnd(); 
```

请注意，在 OpenGL 中，矩阵在右侧相乘。所以如果你写`glRotatef`before `glTranslatef`，旋转将在翻译*后*应用。

# javascript - 回发后页面加载时未调用 javascript 函数

> ID：13765537
> 
> 赞同：0
> 
> 时间：2012-12-07T14:56:49.220
> 
> 标签：javascript, asp.net, master-pages

我在我的 ASP.NET page_load 函数中使用以下函数在我的启动中加载一个 javascript 函数（我使用母版页）：

```
((System.Web.UI.HtmlControls.HtmlGenericControl)Master.FindControl("Body")).Attributes["onload"] = "initialize()"; 
```

回发后似乎没有调用我的javascript函数，这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:05:48.787

为什么不`ClientScript.RegisterClientScriptBlock()`改用

```
string myscript = "<script type=\"text/javascript\">"+
        "divTimer();" +
        "initialize();" +
    "</script>";

ClientScript.RegisterClientScriptBlock( this.GetType(), "myscript", myscript); 
```

# iphone - iPhone iOS 6 UITabBarController 仅纵向，如何让模态视图控制器支持横向方向

> ID：13765544
> 
> 赞同：2
> 
> 时间：2012-12-07T14:57:07.530
> 
> 标签：iphone, ios, sdk, uitabbarcontroller, landscape

我想做的是最简单的概念。但是，我只是没有得到任何想要的结果。

我的应用程序是一个标准的选项卡栏应用程序，每个选项卡中的所有视图控制器都只支持纵向方向，这正是我想要的。

但是，在应用程序的一个部分中，我显示了一个模态视图控制器，它显然覆盖了选项卡栏控制器。这是一个文本输入屏幕，我非常希望这个视图能够支持横向和纵向。然后，一旦用户取消了该模态视图控制器，标签栏控制器将再次显示，一切都是纵向的。

我尝试了很多东西，但没有任何效果。如果我告诉应用程序支持两个方向，那么旋转会在模态上正确发生，但也会在应用程序的其余部分发生，这是我不想要的。

我已经尝试实现所有新的 shouldAutorotate 和 supportInterfaceOrientations 方法，但似乎没有任何效果。

我几乎要工作的最接近的尝试是我在我的应用程序委托中创建了一个 UITabBarController 类别，以转发 shouldAutorotate 和supportedInterfaceOrientations。这最初似乎可行，但由于某种原因，每当取消我的模态 vc 时，我的应用程序标签栏部分总是在状态栏后面向上移动 20 像素？我不知道那是怎么回事。

我创建了一个测试应用程序，其中没有 UITabBarController，我能够毫无问题地编写我想要的行为，并且它运行良好。因此，很明显，与标签栏控制器有关的某些事情使这成为一个难题。

请让我知道解决这个简单概念的诀窍是什么。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:32:29.320

我能够通过为 UITabBarController 和 UINavigationController 创建几个类别来解决这个问题。这是我使用的代码：

```
@implementation UITabBarController (rotations)

- (BOOL)shouldAutorotate
{
    return [self.selectedViewController shouldAutorotate];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return [self.selectedViewController shouldAutorotateToInterfaceOrientation:toInterfaceOrientation];
}

- (NSUInteger)supportedInterfaceOrientations
{
    return [self.selectedViewController supportedInterfaceOrientations];
}

@end

@implementation UINavigationController (navrotations)

- (BOOL)shouldAutorotate {

    return [self.topViewController shouldAutorotate];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return [self.topViewController shouldAutorotateToInterfaceOrientation:toInterfaceOrientation];
}

- (NSUInteger)supportedInterfaceOrientations
{
    return [self.topViewController supportedInterfaceOrientations];
}

@end 
```

然后，当然，我显示的每个视图控制器都需要响应 shouldAutorotate 和 supportedInterfaceOrientations 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T18:54:30.197

显然在 ios6 及更高版本中，旋转的工作方式是不同的。所以你要做的是以下

1.  在您的 .plist 中支持所有 4 个方向。
2.  子类化 UITabBarController（例如：CustomTabBarController）
3.  在 CustomTabBarController 中放入以下代码行

    ```
    -(NSUInteger)supportedInterfaceOrientations
    {
        return UIInterfaceOrientationMaskPortrait;
    }

    - (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
    {
        return UIInterfaceOrientationPortrait;
    } 
    ```

4.  在您的应用程序委托或您正在初始化 UITabBarController 的任何地方，将这些实例替换为 CustomTabBarController 实例。

5.  在您的模态控制器中放置线条

    ```
    - (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
     {
        return UIInterfaceOrientationLandscapeLeft;
    }

    -(BOOL)shouldAutorotate{
        return NO;

    } 
    ```

这一切都应该奏效。

显然，我发现的诀窍是，UITabBarController 不会听你的指令。它将支持您在 .plist 中提到的所有方向。

因此，您必须对其进行子类化。

我尝试执行上述所有操作，并且效果很好。请让我知道，如果您愿意，我可以将代码发送给您。

# java - 干净地停止线程

> ID：13765546
> 
> 赞同：4
> 
> 时间：2012-12-07T14:57:20.327
> 
> 标签：java, multithreading

我终于设法在我的程序中实现了 Thread.interrupt() 而不是 Thread.stop()。然而，我不确定我是否做得很好。

我有一个扩展 Thread 并声明了几个方法的类。**每个**方法都被抛出 InterruptedException （每个方法都执行 I/O 密集型操作，其中一些需要几分钟才能完成，因此我没有使用线程安全标志，因为在操作完成之前不会检查标志） . 我还在这些方法中的几个地方添加了以下代码来引发异常：

```
if (this.isInterrupted()) throw new InterruptedException(); 
```

在 run() 方法中，我为 InterruptedException 执行 try/catch 中的所有方法。如果被捕获，我会为我的类变量执行 Process.destroy() 和 BufferedReader.close()。

这一切都有效，而且似乎效果很好，但是我有几个问题：

1.  10多个方法都抛出InterruptedException是否正确？有一个更好的方法吗？
2.  通过检查 isInterrupted() 来膨胀方法是否正确？
3.  在 catch InterruptedException 块结束时，我是否必须执行“返回”或“空”某些值以使线程可用于 GC？如果我重新创建线程，它需要比平时更长的时间来初始化。
4.  最后，是否有与我所做的相关的任何问题/增强功能？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T01:36:09.507

Java 中的线程中断*并不意味着*停止该线程的执行。不是停止，是*中断*。当一些基本和关键的事情发生变化时，线程可以被中断，告诉线程它的执行上下文、它的任务或它的环境以某种重要的方式发生了变化。对此消息的线程反应是特定于实现的。它可以是停止，可以是重新启动或任何其他动作。不处理中断的线程不能被中断，但它的行为仍然可以改变，例如，通过使用共享变量。

例如，假设您有许多线程，所有线程都在问题空间的一部分中搜索解决方案。当一个线程找到解决方案时，它可以*中断*其他线程，因为它们对解决方案的搜索不再相关。已经找到了解决方案。

或者想象一个连续工作的主线程和一个网络通信线程。每次网络线程收到消息时，它都会用消息*中断*工作线程。基于消息和上下文是什么，工作线程可以决定下一步做什么。例如，如果消息是“STOP”，那么它可以立即停止所有执行。如果消息是“RESET”，它可以从头开始，或者可能不从头开始，并根据执行上下文重用以前的一些工作。

> 有超过 10 种方法是否正确，所有这些方法都 throw `InterruptedException`？有一个更好的方法吗？

不，这很好，只要您知道自己在做什么。如果您实现中断只是为了停止线程，则无需抛出 InterruptedExceptions。线程的 run() 方法是它的第一个方法，并且异常不会进一步进入堆栈。

> 通过检查 isInterrupted() 来膨胀方法是否正确？

视上下文而定。检查通常会在一些关键代码之前添加。通常它作为循环块中的第一项添加。

> 在 catch InterruptedException 块结束时，我是否必须执行“返回”或“空”某些值以使线程可用于 GC？如果我重新创建线程，它需要比平时更长的时间来初始化。

不。一旦线程从 run() 方法中存在，它就任由 GC 摆布。共享变量不会被 GC，只要它们仍然被其他对象引用。

# jquery - jquery 选择自定义属性

> ID：13765549
> 
> 赞同：1
> 
> 时间：2012-12-07T14:57:26.890
> 
> 标签：jquery

我有一个文本字段，我在其中添加了一个名为 maxchars 的自定义属性，值为 255。我似乎无法读取该值，有人可以告诉我我可能做错了什么。

jQuery

```
var textarea = jQuery(this);
var maxlength = parseInt(textarea.attr("maxchars")); 
```

html

```
<t:TextArea maxchars="255"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:00:25.103

您可以使用 Jquery 数据属性来执行此操作。

看到这个页面：[http ://api.jquery.com/data/](http://api.jquery.com/data/)

如果添加这样的属性：

```
<a id="myanchor" href=".." data-myattr="customattribute"> 
```

然后，您可以使用

```
$('#myanchor').data('myattr'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T15:00:34.653

```
$('[maxchars]') 
```

但它不是有效的 html。在它前面设置数据！要使其 html5 有效，请命名您的属性`data-maxchars`并使用选择器`$('[data-maxchars]')`

示例：HTML

```
<p maxchars="255">test</p> 
```

JS：

```
var text = $('[maxchars]').text();
alert(text); 
```

[小提琴](http://jsfiddle.net/ZPg7W/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T15:02:06.170

```
 $('textarea[maxchars="255"]') 
```

试试这个

# android - 音频android确实强制关闭应用程序

> ID：13765555
> 
> 赞同：0
> 
> 时间：2012-12-07T14:57:56.147
> 
> 标签：android, android-layout, android-audiomanager, android-handler

我创建了一个带有歌曲列表视图的音频播放器，当用户单击列表视图中的一个项目时，音乐播放器启动并按下按钮暂停它，这一切都很好！

我的下一站我实现了一个搜索栏来更新歌曲的进度和两个文本视图，一个用于当前歌曲的持续时间，一个用于歌曲的总持续时间。我已经编写了代码，一切似乎都很好，但每次我运行它都会强制关闭

请帮忙！

.Java 类

```
public class Nasheeds extends ListActivity implements OnCompletionListener, SeekBar.OnSeekBarChangeListener {
//ArrayList holds the data (as HashMaps) to load into the ListView
ArrayList<HashMap<String,String>> list = new ArrayList<HashMap<String,String>>();
//SimpleAdapter does the work to load the data in to the ListView
private SimpleAdapter sa;
private MediaPlayer mp;
public boolean istrue = true;
 private ImageButton btnPrevious;
 private ImageButton btnNext;

 private SeekBar songProgressBar;
 private TextView songCurrentDurationLabel;
 private TextView songTotalDurationLabel;

 //Handler to update UI timer, progress bar
 private Handler mHandler = new Handler();;
 private Utilities utils;
 private int seekForwardTime = 5000; //500 milliseconds
 private int seekBackwardTime = 5000;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.nasheeds2);

    //HashMap links each line of data to the correct TextView
    HashMap<String,String> item;
    for(int i=0;i<Nasheed.length;i++){
      item = new HashMap<String,String>();
      item.put( "line1", Nasheed[i][0]);
      item.put( "line2", Nasheed[i][1]);

      list.add( item );
    }

    sa = new SimpleAdapter(this, list,
            R.layout.nasheeds1,
            new String[] { "line1","line2" },
            new int[] {R.id.displayname, R.id.title});

    setListAdapter(sa);

    btnPrevious = (ImageButton) findViewById(R.id.prev);
    btnNext = (ImageButton)findViewById(R.id.next);
    songProgressBar = (SeekBar)findViewById(R.id.seekbar);
    songCurrentDurationLabel = (TextView)findViewById(R.id.songCurrentDurationLabel);
    songTotalDurationLabel = (TextView)findViewById(R.id.songTotalDurationLabel);

    utils = new Utilities();

    songProgressBar.setOnSeekBarChangeListener(this);
    mp.setOnCompletionListener(this);

  getListView().setOnItemClickListener(new OnItemClickListener() {

    public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        switch (arg2)
        {
        case 0:
            System.out.println("User selected option 1");
        //  mp.stop();
            if (mp != null && mp.isPlaying()) {
               mp.stop();
           }else
            mp = MediaPlayer.create(Nasheeds.this, R.raw.mok);
            mp.start();

            // MediaPlayer mp = MediaPlayer.create(Nasheeds.this, R.raw.mok);  
            //  mp.start(); 

            TextView tv=(TextView) findViewById(R.id.selectedfile);
            tv.setText("Playing "+ "Mountains of Mekkah, Zain Bikha");

            //set progress bar values
            songProgressBar.setProgress(0);
            songProgressBar.setMax(100);

            //updating progress bar
            updateProgressBar();
       /*     catch (IllegalArgumentException e){
                e.printStackTrace();
            } catch (IllegalStateException e){
                e.printStackTrace();
            } catch (IO Exception e){
                e.printStackTrace();
            }*/

            break;
        case 1:
            System.out.println("User selected option 2");
            if (mp != null && mp.isPlaying()) {
               mp.stop();
           }else
            mp = MediaPlayer.create(Nasheeds.this, R.raw.hnim);
            mp.start();

        case 2:

            break;                  
        }

    }

  });

  View playbtn = findViewById(R.id.play);
playbtn.setOnClickListener(new OnClickListener() {

    public void onClick(View v) {
        // TODO Auto-generated method stub
          if (istrue) {
              mp.pause();
              istrue = false;
          } else {
              mp.start();
              istrue = true;
          }

          }

});

btnPrevious.setOnClickListener(new View.OnClickListener() {

    public void onClick(View arg0) {
       /* if(currentSongIndex > 0){
            playSong(currentSongIndex - 1);
            currentSongIndex = currentSongIndex - 1;
        }else{
            // play last song
            playSong(list.size() - 1);
            currentSongIndex = list.size() - 1;
        }*/
        System.out.println("Click Works");

    }
});

btnNext.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        System.out.println("Click Works");
    }
});
}

public void updateProgressBar(){
    mHandler.postDelayed(mUpdateTimeTask, 100);
  }

 private Runnable mUpdateTimeTask = new Runnable(){
      public void run(){
          long totalDuration = mp.getDuration();
          long currentDuration = mp.getCurrentPosition();

          //displaying total duration time
          songTotalDurationLabel.setText(""+utils.milliSecondsToTimer(totalDuration));
          //displaying time completed playing
          songCurrentDurationLabel.setText(""+utils.milliSecondsToTimer(currentDuration));

          //updating progress bar
          int progress = (int)(utils.getProgressPercentage(currentDuration, totalDuration));
          songProgressBar.setProgress(progress);

          //running this thread after 100 milliseconds
          mHandler.postDelayed(this, 100);
      }
  };
public void onProgressChanged(SeekBar seekBar, int progress,
        boolean fromUser) {
    // TODO Auto-generated method stub

}
public void onStartTrackingTouch(SeekBar seekBar) {
    mHandler.removeCallbacks(mUpdateTimeTask);
}
public void onStopTrackingTouch(SeekBar seekBar) {
    mHandler.removeCallbacks(mUpdateTimeTask);
    int totalDuration = mp.getDuration();
    int currentPosition = utils.progressToTimer(seekBar.getProgress(), totalDuration);

    mp.seekTo(currentPosition);
    updateProgressBar();
}

   private String[][] Nasheed =
        {{"Mountains of Mekkah","Zain Bikha"},
        {"His name is Mohammed","Kamal Uddin"},
        {"Hadith 3",".....add hadith"},};

public void onCompletion(MediaPlayer mp) {

}

} 
```

实用程序类

```
package com.example.fuelfinder;

public class Utilities {
 /**
 * Function to convert milliseconds time to
 * Timer Format
 * Hours:Minutes:Seconds
 * */
public String milliSecondsToTimer(long milliseconds){
    String finalTimerString = "";
    String secondsString = "";

    // Convert total duration into time
       int hours = (int)( milliseconds / (1000*60*60));
       int minutes = (int)(milliseconds % (1000*60*60)) / (1000*60);
       int seconds = (int) ((milliseconds % (1000*60*60)) % (1000*60) / 1000);
       // Add hours if there
       if(hours > 0){
           finalTimerString = hours + ":";
       }

       // Prepending 0 to seconds if it is one digit
       if(seconds < 10){
           secondsString = "0" + seconds;
       }else{
           secondsString = "" + seconds;}

       finalTimerString = finalTimerString + minutes + ":" + secondsString;

    // return timer string
    return finalTimerString;
}

/**
 * Function to get Progress percentage
 * @param currentDuration
 * @param totalDuration
 * */
public int getProgressPercentage(long currentDuration, long totalDuration){
    Double percentage = (double) 0;

    long currentSeconds = (int) (currentDuration / 1000);
    long totalSeconds = (int) (totalDuration / 1000);

    // calculating percentage
    percentage =(((double)currentSeconds)/totalSeconds)*100;

    // return percentage
    return percentage.intValue();
}

/**
 * Function to change progress to timer
 * @param progress -
 * @param totalDuration
 * returns current duration in milliseconds
 * */
public int progressToTimer(int progress, int totalDuration) {
    int currentDuration = 0;
    totalDuration = (int) (totalDuration / 1000);
    currentDuration = (int) ((((double)progress) / 100) * totalDuration);

    // return current duration in milliseconds
    return currentDuration * 1000;
}
} 
```

xml文件1

```
 <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/displayname"
            android:textSize="18dip"
            android:textStyle="bold"
            android:singleLine="true"
            android:ellipsize="end"/>

    <LinearLayout
            android:orientation="horizontal"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">

            <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:id="@+id/title"
                    android:textSize="15dip"
                    android:singleLine="true"
                    android:ellipsize="end"
                    android:layout_weight="1.0"/>

            <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/duration"
                    android:gravity="right"
                    android:textSize="15dip"
                    android:singleLine="true"
                    android:ellipsize="end"/>
    </LinearLayout>

</LinearLayout> 
```

第二个xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

    <ListView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@android:id/list"
        android:layout_weight="1.0"
        />

    <LinearLayout
            android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@android:drawable/screen_background_light"
    android:padding="10dip">

    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/selectedfile"
            android:text="Not file selected"
            android:textColor="@android:color/black"
            android:gravity="center_horizontal"
            android:singleLine="true"
            android:ellipsize="middle"/>

    <SeekBar
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/seekbar"
            android:max="100"
            android:paddingBottom="10dip"/>

    <LinearLayout
                    android:orientation="horizontal"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:background="@android:drawable/screen_background_light">

        <TextView
            android:id="@+id/songCurrentDurationLabel"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="TextView" />

            <ImageButton
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/prev"
                    android:src="@android:drawable/ic_media_previous"
                    android:onClick="doClick"/>

            <ImageButton
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/play"
                    android:src="@android:drawable/ic_media_play"
                    android:onClick="onClick"/>

            <ImageButton
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/next"
                    android:src="@android:drawable/ic_media_next"
                    android:onClick="doClick"/>

            <TextView
                android:id="@+id/songTotalDurationLabel"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="TextView" />

    </LinearLayout> 
    </LinearLayout> 
```

日志猫：

```
12-07 14:43:02.262: E/AndroidRuntime(1009): FATAL EXCEPTION: main
12-07 14:43:02.262: E/AndroidRuntime(1009): java.lang.RuntimeException: Unable to start     activity ComponentInfo{com.example.fuelfinder/com.example.fuelfinder.Nasheeds}:  java.lang.NullPointerException
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.os.Looper.loop(Looper.java:137)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.ActivityThread.main(ActivityThread.java:4745)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at java.lang.reflect.Method.invokeNative(Native Method)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at java.lang.reflect.Method.invoke(Method.java:511)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at dalvik.system.NativeStart.main(Native Method)
12-07 14:43:02.262: E/AndroidRuntime(1009): Caused by: java.lang.NullPointerException
12-07 14:43:02.262: E/AndroidRuntime(1009):     at com.example.fuelfinder.Nasheeds.onCreate(Nasheeds.java:79)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.Activity.performCreate(Activity.java:5008)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-07 14:43:02.262: E/AndroidRuntime(1009):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-07 14:43:02.262: E/AndroidRuntime(1009):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:02:34.783

由于 StackOverflow 没有行号，因此很难具体说明发生了什么，但异常中的违规行相当清楚：

> 12-07 14:43:02.262：E/AndroidRuntime(1009)：引起：java.lang.NullPointerException 12-07 14:43:02.262：E/AndroidRuntime(1009)：在 com.example.fuelfinder.Nasheeds.onCreate (Nasheeds.java:79)

我有一种感觉，如果你在那里设置一个断点，你将能够很快找到问题。

# centos - 管理 RHEL 更新 - 我必须使用 RHN 吗？

> ID：13765558
> 
> 赞同：0
> 
> 时间：2012-12-07T14:58:06.453
> 
> 标签：centos, redhat, rpm, rhel

我们将 RackSpace 用于我们的私有云，并且每天都可以启动 RHEL 实例，这让我想到了管理这些系统上的更新的问题。

我告诉大家使用 CentOS，直到我们可以管理许可，这样我就可以管理存储库，并控制可用的软件包、安全更新等。

我是否必须使用 RHN 来管理 RHEL 包，或者我可以使用内部系统让系统从中收集包？

/* 请原谅这个问题的幼稚 - 就个人而言，我看不出我不能使用“createrepo”的任何原因，但我只是要求社区确保 */

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T01:34:59.507

CentOS 补丁通常在 RHEL 的 2-3 天内，所以你应该没问题。（安全补丁 - 发布完全是另一回事！）根据您的公司规模等，您可能希望获得一些 RHEL 许可证以帮助贡献...

# java - 在 Android 中的演示版和完整版之间共享存档游戏

> ID：13765560
> 
> 赞同：0
> 
> 时间：2012-12-07T14:58:18.580
> 
> 标签：java, android, andengine

我目前正在开发一款 Android 游戏，我的目标是创建游戏的免费/*演示*版，以便用户试用。但我也希望**演示中的存档游戏在完整版中自动导入**。

我存储在应用程序*私有存储*中的存档游戏基本上是映射多个 Java 对象的**JSON**字符串。用户可以根据需要创建任意数量的“新游戏”，并且他开始的每个游戏都有一个“自动保存”和一个“手动保存”文件。为了跟踪所有文件，我有一个包含文件名和一些附加信息（如玩家姓名等）的列表。

所以基本上有很多小文件处理保存游戏。这可能不是最优雅的方法，但效果很好。

**所以这是我的问题：**假设用户已经在演示版中启动了一个游戏（因此将有 3 个文件保存在演示版的私人存储中）。*我现在如何从完整版中访问这些文件？*

这两个版本不会有太大的不同。它们实际上是相同的，尽管有演示版本的限制。但我会使用相同的代码库。

我知道在这个论坛和其他地方有很多关于这个问题的问题，但我找不到合适的解决方案。我能找到的所有内容都涉及：

*   将文件存储在**世界可读的存储设备**中（如 SD 卡）或
*   使用**SharedPreferences**

但我不希望用户能够阅读存档游戏（甚至更改它——因为这可能会搞砸游戏）——所以没有 sd 卡，我也不能使用 SharedPreferences，因为每个单独的存档游戏都有大约。200 行代码（许多 Java 对象被翻译成 JSON）并将所有这些值和对象映射到某种用于 SharedPreferences 的键值结构对我来说似乎是不可能的。

**这一切都搞砸了，还是有人有想法？**

感谢您抽出宝贵时间，期待听到您的想法！

*   克里斯托夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:07:04.390

所以我只看到 2 个解决方案：

第一个是 WorldReadable SharedPreferences。你说，你存储 JsonStrings，所以没有必要再向下映射它们，如果你可以用你的 json-strings 制作对象（我喜欢使用[Gson](http://code.google.com/p/google-gson/)来做这种工作），你可以简单地存储这些字符串在 SharedPreferences 中。

第二种方式是打扰[ContentProviders](http://developer.android.com/guide/topics/providers/content-providers.html)并实现一个 ContentResolver 接口。对于您的用例，这是我可以想象的最安全的方式，但是您必须为此做很多事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:24:47.823

**你无法避免的**

有两件事是你无法避免的：

*   如果用户决定root手机，你不能阻止用户访问它，不管你做了什么让它变得更难。
*   如果您希望第二个应用程序在非 root 设备中访问相同的数据（保存的游戏），那么用户总是可以从您的应用程序外部访问它。

**你能做些什么来让它变得更难**

*   您可以在将数据存储到文件或共享首选项之前加密（即使用设备 IMEI）数据（与哈希一起防止更改）
*   您可以将数据存储在 SQLite 数据库中（需要更多知识来更改它），并在存储之前加密（更难）。
*   您可以使用[SQLCipher](https://guardianproject.info/code/sqlcipher/)将其存储在加密数据库中（加密将是透明的）。

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:23:03.767

您可以使用共享的内容提供者（这里是关于 ContentProviders 的一般文档[http://developer.android.com/guide/topics/providers/content-providers.html](http://developer.android.com/guide/topics/providers/content-providers.html)）

然后，您必须在清单中使用以下标志将其声明为可导出： android:exported="true"

例子：

```
<provider android:name="[yourpackage_here].SavegameProvider"
 android:authorities="[yourpackage_here].SavegameProvider"
 android:exported="true" /> 
```

您将能够在您的新应用程序中打开它。

# c++ - 用于输入多路复用的 C++ 设计模式？

> ID：13765564
> 
> 赞同：3
> 
> 时间：2012-12-07T14:58:24.850
> 
> 标签：c++, design-patterns

我必须在我的程序中从多个来源同步读取和处理数据，如下所示：

```
main
...
while(true)  {
dataSample1 = readInput1...
processData(dataSample1) 
....
dataSample2 = readInput2...
processData(dataSample2) 
} 
```

每个 readInput 在单独的组件中实现以处理不同性质的输入（例如套接字、usb 端口等），但数据样本的格式是相同的。问题是 readInput 和 processData 都是阻塞的，所以我必须想出解决方案来多路读取“processData”的输入。这个问题是否对应于“reactor”或“proactor”模式？是否有框架可以帮助实现而不将每个“readInput”移动到单独的线程中？
谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:04:41.917

您是否能够重写/重新配置各种`readInput`功能以成为非阻塞的？如果没有，单独的线程（甚至可能是单独的进程）是让它们并行运行的唯一方法。如果是，那么反应器模式可以帮助您在每个输入到达时触发正确的处理。

# php - 从php中的多维数组中选择项目

> ID：13765566
> 
> 赞同：0
> 
> 时间：2012-12-07T14:58:27.597
> 
> 标签：php, arrays, multidimensional-array

我已经搜索了该站点，但找不到解决我的问题的方法。我只想从数组中选择产品名称。（如：长笛、小号..）

那是我的阵列。

```
 $products = array
    ( 
      'MMS-1754'=> array( 'name'=> 'Flute', 'cost'=> 149.50 ), 
      'MMS-1864'=> array( 'name'=> 'Trumpet','cost' => 199.50 ), 
      'MMS-1965'=> array( 'name'=> 'Clarinet', 'cost'=> 299.50 ) 
    ); 
```

这是我用于填充下拉列表的 php 代码

```
echo'<select name="Name">'; 
foreach($products as $code => $word)
{
    foreach($word as $product)
    {
        echo'<option value="'.$code.'">'.$product.'</option>';
    }
}

echo'</select>'; 
```

我得到的结果是产品名称，还有成本价格。我只想要产品名称。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T15:00:27.327

你不需要第二个 foreach。您可以直接访问该名称。$product 值包含具有名称和成本的数组

```
echo'<select name="Name">'; 
foreach($products as $code => $product)
{
    echo'<option value="'.$code.'">'.$product['name'].'</option>';
}
echo'</select>'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T15:00:25.870

```
echo'<select name="Name">'; 
foreach($products as $code => $product)
{
    echo'<option value="'.$code.'">'.$product['name'].'</option>';
}

echo'</select>'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T15:00:43.360

```
echo'<select name="Name">'; 
foreach($products as $code => $word)
{
    echo'<option value="'.$code.'">'.$word['name'].'</option>';
}

echo'</select>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T15:02:17.537

这很容易：

```
echo'<select name="Name">'; 
foreach($products as $code => $product)
{
    echo'<option value="'.$code.'">'.$product['name'].'</option>';
}
echo'</select>'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T15:03:47.370

```
echo'<select name="Name">'; 
foreach($products as $code => $word)
{
    echo'<option value="'.$code.'">'.$word['name'].'</option>';
}

echo'</select>'; 
```

# .net - 将纯文本附加到变量值

> ID：13765567
> 
> 赞同：0
> 
> 时间：2012-12-07T14:58:30.253
> 
> 标签：.net, razor

我正在尝试使用 razor 模板引擎生成相当简单的 xml。这是我的模板：

```
<gridDef Id="@Model.MasterType.Name"/> 
```

我想将“网格”附加到 Id 属性值。它适用于代码块：

```
@{
  var name = Model.MasterType.Name + "Grid";
}
<gridDef Id="@name"/> 
```

但我想使用剃刀语法而不定义变量。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:01:25.070

您需要使用括号将 Razor 表达式与文字源分开：

```
<gridDef Id="@(Model.MasterType.Name)Grid" /> 
```

或者，您可以在表达式中连接字符串：

```
<gridDef Id="@(Model.MasterType.Name + "Grid")" /> 
```

# java - 如何将 Java 中的 Excel 文件与 DBUnit 进行比较

> ID：13765569
> 
> 赞同：0
> 
> 时间：2012-12-07T14:58:38.293
> 
> 标签：java, excel, compare, dbunit

我需要比较两个 Excel 文件以找出任何类型的内容差异。不考虑格式/颜色/字体差异。我遵循了在[这篇文章](https://stackoverflow.com/questions/866346/easiest-way-to-compare-two-excel-files-in-java)中找到的解决方案，但它基于 DBUnit XlsDataSet 类。此类的工作假设 Excel 文件具有特定结构： *第一行应表示表头*。在我的环境中并非总是如此。例如，表头可能从单元格 C4 开始。

但是，我想坚持使用 DBUnit，因为它提供了很好的支持。有谁知道如何配置表头在 XlsDataSet 类中的开始位置？

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:13:43.313

当一个文件的表头从 C4 开始而另一个文件从 A1 开始时，它们已经不同了。

为了比较从不同单元格开始的数据，我可以想到两种方法。

1.  在比较之前，检查空行/列，将内容移动到第一行/列。
2.  在您的文件中包含一个“关键字”作为起点。

这两种方式都需要大量的工作。也许更容易适应你的环境，所以所有文件都从 A1 开始。

# android - different behavior between webview's loadUrl() and loadData()

> ID：13765571
> 
> 赞同：2
> 
> 时间：2012-12-07T14:58:42.270
> 
> 标签：android, android-webview

```
webview.loadUrl("http://example.com/image.gif"); 
```

loads an animated gif

```
webview.loadData("<img src='http://example.com/image.gif'/>","text/html", "UTF-8"); 
```

loads a static image

```
webview.loadUrl("http://example.com/gif.html"); 
```

loads a page where every gif is not animated.

i've tested this on the emulator and on my galaxy tab 10.1 running 4.0.4\. I've seen some apps that load a webview with a page and they have animated gifs soo i must be missing something.

```
webview.getSettings().setJavaScriptEnabled(true); 
```

doesn't change anything and i've tried [http://code.google.com/p/slidetypekeyboard/source/browse/trunk/assets/index.html](http://code.google.com/p/slidetypekeyboard/source/browse/trunk/assets/index.html) but it wont animate the gif either

what i'm asking : how to enable gif animation with .loadData() ? To expand, i want

```
webview.loadData("<center><img src='http://example.com/image.gif'/><center>","text/html", "UTF-8"); 
```

to display the animated gif.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T06:48:40.723

I had the same problem. [This](https://stackoverflow.com/a/4249537/1778352) answer helps me. It has a different theme, but main trick is that

**"For some reason loadDataWithBaseURL and loadData functions have completely different implementation."**

Try this:

```
webview.loadDataWithBaseURL(null, "<center><img src='http://example.com/image.gif'/><center>", "text/html", "utf-8", null); 
```

# amazon-web-services - 实际上，如何设置 Amazon AWS 以使其自动扩展？

> ID：13765574
> 
> 赞同：5
> 
> 时间：2012-12-07T14:59:04.460
> 
> 标签：amazon-web-services, amazon-ec2, scalability, autoscaling

我有一个 EC2 实例几个月来工作得很好（仍在开发中，应用程序还没有上线），但我刚刚意识到我什至不知道如何根据流量来扩大/缩小我的 EC2 实例。

亚马逊提供的服务数量之多令人难以置信，我很困惑。

最初，我以为我只有一个实例，Amazon 会**透明地**分配资源或创建相同的实例来处理流量，但我的印象似乎是错误的。

**我的问题是：**有人可以告诉我（简单地说，项目符号列表或指向我的教程）**如何使我的实例自动增长**以处理 100,000 个同时用户，然后在激增完成后**自动返回？**

假设这是可能的，**我可以通过 AWS 控制面板执行此操作吗？**如果是这样，怎么做？

我能看到的只有微型、小型、中型等......实例。每个人都有有限的资源，不清楚如何自动设置实例，以便亚马逊动态分配额外的资源来处理流量高峰（或者甚至逐渐增加以跟上自然流量增长）。

**附带问题**我可以假设 Amazon 在扩展时自动处理 DDOS 攻击吗？（这意味着流氓流量最终会被亚马逊停止/放慢，扩展只会影响合法流量峰值）。我意识到这个问题可能真的很愚蠢，请记住我还没有喝咖啡:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:05:29.000

本文详细介绍了如何使用负载均衡器和 EC2 进行自动扩展：http: [//kkpradeeban.blogspot.com/2011/01/auto-scaling-with-amazon-ec2.html](http://kkpradeeban.blogspot.com/2011/01/auto-scaling-with-amazon-ec2.html)

对于可扩展性，您可能还想查看这篇关于为分布式系统实现 pub/sub 系统的文章：http: [//www.infoq.com/articles/AmazonPubSub](http://www.infoq.com/articles/AmazonPubSub)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T15:04:34.063

您无法自动更改实例类型（m1.small、m1.large 等）以响应负载的变化。但是，您可以让 AWS 在负载增加时自动创建新实例，并在负载下降时将其拆除。

我相信这篇文章会对你有所帮助： http: [//aws.amazon.com/autoscaling/](http://aws.amazon.com/autoscaling/)。

# grep - 我怎样才能让 grep 在文件中找到一行，但也显示它后面的行？

> ID：13765579
> 
> 赞同：1
> 
> 时间：2012-12-07T14:59:24.210
> 
> 标签：grep

我想使用 grep 命令来提取文本文件中包含特殊模式的那些行，但我也想提取这些特定行的下一行。可以使用grep吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:01:08.947

您可以使用以下选项指定匹配后要打印的行数`-A`：

```
grep -A1 pattern file 
```

演示：

```
$ cat file
line one 
line two
line three

$ grep -A1 'one' file
line one 
line two 
```

下次`man grep`！

# matlab - 在频域中使用高斯滤波器 + Matlab

> ID：13765580
> 
> 赞同：4
> 
> 时间：2012-12-07T14:59:28.903
> 
> 标签：matlab, image-processing

我在频域中阅读了有关高斯滤波器的信息，但这里有些地方我无法理解：

1.  高斯滤波器会一直是方阵吗？

2.  如果 1 的答案是肯定的，如果我的图像是矩形矩阵会发生什么？在 Matlab 中，我读取图像，然后`fft2`将其从空间域转换为频域，然后将`ffshift`其集中。我想要的是将图像的频域矩阵乘以高斯滤波矩阵，然后使用 将结果转换为空间域`ifft2`，但是由于高斯滤波矩阵和图像频域矩阵的大小不同，它们不能相乘. （我没有在这里使用`conv2`和`fspectial`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T17:30:54.380

高斯滤波器实际上是圆形的，因为它是距中心距离的函数。使用矩形矩阵是因为它更方便。
为了克服尺寸差异，您可以做的是对过滤器进行零填充：

```
img = imread( imgFileName ); % read image, use gray-level images here.
IMG = fft2( img ); % Fourier of img
sz = size( img );
h = fspecial( 'gaussian', sz, sigma ); % create a filter with std sigma same size as img
H = fft2( h ); % Fourier of filter
F = IMG.*H; % filter in Fourier space
f = ifft2( F ); % back to spatial domain. 
```

# html - CSS变换鼠标移动时失去悬停状态

> ID：13765581
> 
> 赞同：2
> 
> 时间：2012-12-07T14:59:30.170
> 
> 标签：html, css, hover, css-transforms

我有以下 HTML/CSS 标记，它应该在状态下转换`div`元素。`:hover`

将鼠标悬停在`div`元素上时，`:hover`样式会正确添加。但是在鼠标移动时，这些样式会丢失，直到鼠标停止移动。

为什么会这样？

* * *

**HTML：**

```
<div class="module">
sdfsdf
<br><br>
<img src="http://placekitten.com/100/100" />
</div>​ 
```

**CSS：**

```
.module
{
    width:200px;
    height:200px;
    background:blue;
    margin:10px;
    color:#fff;
    padding:10px;
}

.module:hover
{
    -webkit-transform-origin:50% 50%;
    -webkit-transition:-webkit-transform 0.08s;
    -webkit-font-smoothing:antialiased;
    -webkit-transform:perspective(800px) rotateX(0deg) rotateY(0deg) translateZ(-20px);

}​ 
```

* * *

[**-- 见 jsFiddle 演示 --**](http://jsfiddle.net/nHaHw/2/)

注意：我的演示和 CSS 目前仅适用于 webkit。

我在 Google Chrome 版本 23.0.1271.95 m 上复制了这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T08:07:44.087

似乎问题与负 z 值有关，因为将其更改为`translateZ(20px);`可以正常工作。一个修复，如果你不想使用额外的`div`，可以添加`-webkit-transform-style: preserve-3d;`到`body`.

这是一个更新的[jsfiddle](http://jsfiddle.net/nHaHw/17/)

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:06:40.173

我有同样的使用 Chrome。这修复了它：

```
<div class="container">
<div class="module">
    <img src="http://placekitten.com/100/100"> 
</div>
</div> 
```

和CSS

```
.module
{
width:200px;
height:200px;
background:blue;
color:#fff;
padding:10px;
}

.container:hover .module
{
-webkit-transform-origin:50% 50%;
-webkit-transition:-webkit-transform 0.08s;
-webkit-font-smoothing:antialiased;
-webkit-transform:perspective(800px) rotateX(0deg) rotateY(0deg) translateZ(-20px);

}​​​​​​​​​​​​​​​​​​​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-07T16:06:44.363

尝试这个

我把它放到一个容器 div 中。将悬停应用到容器并将 .module 上的指针事件设置为无。删除了不必要的东西。如果需要，您仍然可以将 -webkit- 添加到其中的一些内容中。我似乎没有必要。

请注意，我将过渡移到了悬停代码之外

```
* {
    box-sizing: border-box;
}

.container {
    width: 200px;
    height: 200px;
    margin: 10px;
    border: 1px solid black;
    perspective: 800px;
}

.module {
    width: 200px;
    height: 200px;
    background: blue;
    color: #fff;
    padding: 10px;
    pointer-events: none; 
    transition: transform 0.08s;
}

.container:hover .module {
    transform: translateZ(-20px);
}
```

```
 <div class="container">
            <div class="module">
                sdfsdf
                <br />
                <br />
                <img src="http://placekitten.com/100/100" />
            </div>​
        </div>
```

`

# c++ - 粒子与场景中的环境和对象的交互

> ID：13765582
> 
> 赞同：1
> 
> 时间：2012-12-07T14:59:33.547
> 
> 标签：c++, ogre, particle-system

我在 Ogre 中创建了一个 ParticleSystem，这样我的对象就会发射很多星星。

我的问题是：如何实现这颗星星与环境和场景中的物体的交互？但更重要的是，我可以用 ParticleSystem 解决这个问题吗？

任何帮助将不胜感激！

**更新**

我正在尝试在我的粒子文件中使用：

```
affector DeflectorPlane {
    ....
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T19:36:06.297

顾名思义，DeflectorPlane 只支持一个粒子可以反弹的平面（参见[Ogre 手册](http://www.ogre3d.org/docs/manual/manual_40.html#DeflectorPlane-Affector)中的条目）。

让粒子在任意表面反弹涉及到大量的碰撞检测，因此不是渲染而是物理引擎负责的任务，因此 Ogre3D 对此要求没有开箱即用的支持。

但就现有的 Ogre3D 物理引擎包装而言，有四种不同的选择：Newton、Bullet、PhysX 和 ODE。[每个包装器在Ogre Addons 论坛](http://www.ogre3d.org/addonforums/)中都有自己的专用部分，其中包含更多信息和链接。

# c++ - 使用分配给其他进程的内存

> ID：13765583
> 
> 赞同：1
> 
> 时间：2012-12-07T14:59:35.133
> 
> 标签：c++, memory-management

我有一个应用程序，我想测试是否正确处理了内存不足异常。所以我应该以某种方式填充内存以强制出现这种情况。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:29:29.877

在 Windows 上，您可以使用 Application Verifier 模拟资源不足的情况。

更多信息[在这里](http://msdn.microsoft.com/en-us/subscriptions/aa480483.aspx)。

# java - 导出应用程序时使用权限消失

> ID：13765584
> 
> 赞同：0
> 
> 时间：2012-12-07T14:59:40.233
> 
> 标签：java, android, eclipse

我将开始，我是一个android NEWB。这是我使用 Android 的第一周，虽然很有趣，但我想我将来会坚持使用 IOS 开发。

但是关于我的问题：我的应用程序非常简单。它转到一个 PHP 脚本，获取一些数据并将其显示给用户。当直接从 Eclipse 运行/安装时，它在模拟器和设备上运行良好。但是，如果我导出到 APK 并安装该应用程序，它会显示“无法解析主机 MYURL：没有与主机名关联的地址”。

这是因为清单文件中缺少构建。但是，我已将该字符串放在清单文件中，但每次我将应用程序导出到 APK 时，该字符串都会从清单文件中消失。我已经实时看到它发生了，我在 Eclipse 中打开了清单文件，单击“导出签名的 android 应用程序”，通过向导，当它构建 APK 时，权限行就消失了。

以前有人见过这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-07T18:33:32.953

我有同样的问题。它在调试期间可以正常工作，但是当我尝试导出应用程序时，它没有权限，并且它们神秘地从清单文件中消失了。

事实证明我正在更新 MyProject/bin/AndroidManifet.xml 而不是 MyProject/AndroidManifet.xml 中的权限

# c++ - 从 STL 优先级队列创建最小堆

> ID：13765588
> 
> 赞同：4
> 
> 时间：2012-12-07T15:00:07.780
> 
> 标签：c++, priority-queue, min-heap

我正在从 stl 优先级队列创建一个最小堆。这是我正在使用的课程。

```
class Plane
{
  private :
    int id ;
    int fuel ;
 public:
    Plane():id(0), fuel(0){}
    Plane(const int _id, const int _fuel):id(_id), fuel(_fuel) {}

    bool operator > (const Plane &obj)
    {
        return ( this->fuel > obj.fuel ? true : false ) ;
    } 
```

} ;

我主要是这样实例化一个对象。

```
 priority_queue<Plane*, vector<Plane*>, Plane> pq1 ;
 pq1.push(new Plane(0, 0)) ; 
```

我收到一个`xutility`我无法理解的错误。

> d:\microsoft visual studio 10.0\vc\include\xutility(674): 错误 C2064: 术语不计算为采用 2 个参数的函数

对其解决方案的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-07T15:08:31.313

如果您放弃使用指针（这对于您的简单结构来说太过分了），那么您可以[`std::greater`](http://en.cppreference.com/w/cpp/utility/functional/greater)从标题中使用`functional`：

```
std::priority_queue<Plane, std::vector<Plane>, std::greater<Plane> > pq1;
pq1.push(Plane(0, 0)); 
```

目前，您正在`Plane`作为比较类型进行喂养。这是行不通的，因为比较类型必须是一种函数对象，即它必须有一个`operator()`进行比较的对象。`Plane`没有这样的成员（仅仅为此目的添加它是个坏主意）。

`std::greater`有适当的方法，根据您的`operator>`. 但是，它不适用于指针，因为它使用指针比较（基于内存地址）。

顺便说一句，请注意，您的比较函数可以更简洁地表示为

```
bool operator>(const Plane &other)
{
    return fuel > other.fuel;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-07T15:03:34.897

第三个模板参数必须是采用 teo 的二元仿函数`Plane*`。你的`Plane`班级没有提供。

你需要某种形式的东西

```
struct CompPlanePtrs
{
  bool operator()(const Plane* lhs, const Plane* rhs) const {
    return lhs->fuel > rhs->fuel ;
  }
}; 
```

# node.js - 将评估文件的输出放入Nodejs中的另一个文件中

> ID：13765589
> 
> 赞同：0
> 
> 时间：2012-12-07T15:00:11.357
> 
> 标签：node.js, stream

在我的 Nodejs 脚本中，我有一行，按需调用：

```
eval(fs.readFileSync('eval.js')+''); 
```

这样做是因为有时我想知道我的“nodejs 脚本”中发生了什么，它的变量的内容。

因此，“eval.js”通常表示为：

```
console.dir(myVar); 
```

问题是，它在控制台输出中输出。“父”脚本还在控制台中输出一些信息，因此控制台运行得非常快，我无法得到我想要的。

我正在寻找将文件“eval.js”的所有输出放入另一个文件“x.log”的任何方法。

类似于（在“父”脚本中）：

```
evalFileToLog("eval.js", "x.log"); 
```

或“eval.js”：

```
// something what will forward stdout to "x.log"
console.dir(abc);
// blah blah blah
// something that will restore stdout to it's normal behaviour, like it was before. 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T03:52:22.983

您可以写入另一个流（例如文件或[标准错误](http://nodejs.org/api/stdio.html#stdio_console_warn_data)）以分隔输出，但我强烈建议您不要对程序中的任何文件进行同步读取。

另一种获取应用程序视图的方法是利用[repl](http://nodejs.org/api/repl.html)，您可以在程序中使用 shell，而不是淹没输出。

```
var repl = require('repl');
var bar = new MyApp();
relp.start({
  foo: bar
}); 
```

现在你已经`bar`暴露在你的外壳中了。

# ruby-on-rails - rails 保存 has_(and_belongs_to_) 使用 :through 的许多关系

> ID：13765592
> 
> 赞同：0
> 
> 时间：2012-12-07T15:00:16.890
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

所以我想保存一个 HABTM 关系，但我的模型上有额外的字段，所以我使用 has_many 和 through 方法。这是我的模型：

```
#project_task.rb
class ProjectTask < ActiveRecord::Base
   attr_accessible :description, :name, :user_id, :project_id, :user_ids
   belongs_to :project
   belongs_to :user #Created by

   has_many :project_task_users #Here is the HABTM
   has_many  :users, :through => :project_task_users #AND HERE

   validates :name, :presence => true
   validates :project_task_users, :length => { :minimum => 1} #must have atleast 1 record in the HABTM relation
   accepts_nested_attributes_for :project_task_users
end

#project_task_user.rb
class ProjectTaskUser < ActiveRecord::Base
   belongs_to :user
   belongs_to :project_task
end 
```

我的表格：

```
 <p>Users:</p>
        <% for user in @users %>
            <div>
              <%= check_box_tag "project_task[user_ids][]", user.id, @task.users.include?(user) %>
              <%= user.name %> - <%= user.company.name %>
            </div>
        <% end %> 
```

我的控制器：

# 得到

```
def new_task
    @project = Project.find(params[:project_id])
    @task = ProjectTask.new(:project_id => @project.id)
    @users = @project.users
end 
```

# 邮政

```
def new_task_post
    @project = Project.find(params[:project_id])
    @task = ProjectTask.new params[:project_task]
    @task.user_id = current_user.id
    if @task.save
      redirect_to @project
    else
      @users = @project.users
      render action:"new_task"
    end
  end 
```

当我提交时，返回 false 和带有验证`@task.save`的错误数组`project_task_users`

# 更新

正如 Pablo89 指出的那样，我将我的 check_box_tag 重命名为这个 `<%= check_box_tag :user_ids, user.id, @task.users.include?(user), :name => 'project_task[user_ids][]' -%>` ，只有当我注释掉验证时它才会保存。在创建 project_task 时，我应该如何验证是否选择了用户？

# asp.net-mvc - SignalR 和客户端证书

> ID：13765598
> 
> 赞同：3
> 
> 时间：2012-12-07T15:00:28.720
> 
> 标签：asp.net-mvc, signalr.client

我计划使用 SignalR 通知客户。

在生产中，我们被迫使用客户端 x509 证书来使用反向代理对客户端进行身份验证。它还将在连接到我们的 IIS 网络服务器之前终止 SSL。

这行得通吗？

我找不到任何 api 来添加客户端证书或使用 WebRequestHandler。

我不可能是第一个。

/HAXEN

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T22:14:14.343

关于使用基于客户端的证书：SingalR 中没有任何东西允许这样做，我查看了所有来源，显然这是一个疏忽，而且非常烦人。这是我发现的一个黑客：

```
 public class MyHttpClient: IHttpClient
    {
        DefaultHttpClient _client = new DefaultHttpClient();
        X509Certificate Certificate;

        Action<IRequest> SpiceAction(Action<IRequest> prepareRequest)
        {
            return new Action<IRequest>(req =>
            {
                var fi = typeof(HttpWebRequestWrapper).GetField("_request",
                     BindingFlags.NonPublic | BindingFlags.Instance);
                HttpWebRequest request = (HttpWebRequest) fi.GetValue(req);
                request.ClientCertificates.Add(Certificate);
                prepareRequest(req);
            });
        }

        public Task<IResponse> Get(string url, Action<IRequest> prepareRequest)
        {
            return _client.Get(url, SpiceAction(prepareRequest));
        }

        public Task<IResponse> Post(string url, Action<IRequest> prepareRequest,
            IDictionary<string, string> postData)
        {
            return _client.Post(url, SpiceAction(prepareRequest), postData);
        }
    } 
```

然后代替：

```
 var conn = new Connection("https://xxxxxxxx");
    conn.Start() 
```

做：

```
 var conn = new Connection("https://xxxxxxxx");
    conn.Start(new MyHttpClient() { Certificate = xxxxxxx }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T07:13:28.587

我们开始了，1.1 版的 SignalR 客户端证书支持开箱即用。

伟大的！

# windows - 代码的不同行为（是否调试和不同的计算机）

> ID：13765599
> 
> 赞同：2
> 
> 时间：2012-12-07T15:00:28.610
> 
> 标签：windows, multithreading, visual-studio-2010, visual-studio, visual-studio-debugging

我在 Visual Studio 2010 中创建了一个运行 2 个使用事件（`SetEvent()`, `WaitForSingleObject()`, `WaitForMultipleObjects()`）同步的线程的程序。发生以下情况：

*   当我使用调试器运行该程序时，它会运行一段时间然后崩溃

*   当我在不调试（.exe 文件）的情况下运行该程序时，它直接崩溃

*   当我使用调试器在另一台计算机上运行该程序时，它会立即崩溃，并通过 .exe 文件在一段时间后崩溃

调试时报如下错误：

```
Unhandled exception at 0x5eafcaf7 (msvcr100d.dll) in test.exe: 0xC0000005: Access violation reading location 0x0036f000. 
```

由于我不知道从哪里开始搜索，有人可以为这个主题带来一些启示吗？在调试器中运行代码与不运行代码有什么区别？（添加了哪种代码？）为什么不同的计算机在运行相同的代码时会有不同的行为？

在两台计算机中都有完全相同的操作系统（Windows 7），我假设相同的库和补丁。

谢谢您的帮助！

* * *

编辑 11.12.2012

我已经安装了应用程序验证程序并在 Visual Studio 中显示了一些错误，如下所示：

```
=========================================================== 
VERIFIER STOP 0000000000000013: pid 0x1E18: first chance access violation for
current stack trace

000000000874F000 : Invalid address being accessed
000000005201CAF7 : Code performing invalid access
000000000009E440 : Exception record. Use .exr to display it.
000000000009DF50 : Context record. Use .cxr to display it.
=========================================================== 
```

有人知道我如何查看哪个地址属于哪一行代码以确切知道异常发生的位置吗？我还在程序的帮助中读到，使用命令“！heap p -a ACCESS_ADDRESS”应该提供有关错误性质和堆块溢出的详细信息。我应该在哪里使用 Visual Studio 放置这个命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:12:03.247

在多线程环境中工作时，不同线程上的事情可能以不同的速度发生。在没有相关代码的情况下试图找出可能的原因是相当困难的。

该错误是一般的内存访问冲突错误。这通常发生在从函数返回的变量大于预期或类型不同时。

我们可以看看代码吗？

# javascript - 带有特定前置字符的 HTML 标记引号的正则表达式并打破 HTML 引号

> ID：13765600
> 
> 赞同：1
> 
> 时间：2012-12-07T15:00:30.863
> 
> 标签：javascript, html, regex

我正在研究一个正则表达式来匹配所有引号（双引号和单引号），它们前面必须有特定的字符，并且将在达到相同的引号类型或遇到 HTML 注释（<！--）时结束。

游戏规则如下：

1.  HTML 标签名称本身（例如“<a>”）无关紧要；正则表达式仅从 HTML 元素的属性中获取输入（<a **all="of this in bold is the attribute section">**）
2.  正则表达式必须能够找到单引号 ( `'`) 和双引号 ( `"`)，但只有在达到它自己的引号类型 ( `\1`)、HTML 开始 ( `<!--`) 或输入结尾( ) 时才能转义`$`。
3.  如果遇到 HTML 注释，则引用将被中断，但仍被视为引用：<a id="works **<!--** inpterrupted -->
4.  在第一个引号之前只能存在一组特定的字符，遵循以下模式：[^\w!#£¤€´¨-.:]

看到[这个正则表达式](http://regexpal.com/?flags=g&regex=%5B%5E%5Cw!%23%C2%A3%C2%A4%E2%82%AC%C2%B4%C2%A8%5C-.%3A%5D%28%27%7C%22%29%28.%7C%5Cn%29%2a%3F%28%5C1%7C%3C!--%7C%24%29&input=ALLOW%20%3C!--%20--%3E%0A%3Ca%20%20%27%27%20%3C!--%20--%3E%0A%3Ca%20%24%27%27%20%3C!--%20--%3E%3Ca%20%25%27%27%20%3C!--%20--%3E%3Ca%20%26%27%27%20%3C!--%20--%3E%3Ca%20%2F%27%27%20%3C!--%20--%3E%0A%3Ca%20%28%27%27%20%3C!--%20--%3E%3Ca%20%29%27%27%20%3C!--%20--%3E%3Ca%20%7B%27%27%20%3C!--%20--%3E%3Ca%20%7D%27%27%20%3C!--%20--%3E%0A%3Ca%20%5B%27%27%20%3C!--%20--%3E%3Ca%20%5D%27%27%20%3C!--%20--%3E%3Ca%20%3D%27%27%20%3C!--%20--%3E%3Ca%20%3F%27%27%20%3C!--%20--%3E%0A%3Ca%20%2B%27%27%20%3C!--%20--%3E%3Ca%20%60%27%27%20%3C!--%20--%3E%3Ca%20%7C%27%27%20%3C!--%20--%3E%3Ca%20%5E%27%27%20%3C!--%20--%3E%0A%3Ca%20~%27%27%20%3C!--%20--%3E%3Ca%20%2a%27%27%20%3C!--%20--%3E%3Ca%20%2C%27%27%20%3C!--%20--%3E%3Ca%20%3B%27%27%20%3C!--%20--%3E%0A%3Ca%20%3C%27%27%20%3C!--%20--%3E%3Ca%20%5C%27%27%20%3C!--%20--%3E%0ADISALLOW%20%3C!----%3E%0A%3Ca%20a%27%27%20%3C!--%20--%3E%3Ca%209%27%27%20%3C!--%20--%3E%3Ca%20!%27%27%20%3C!--%20--%3E%3Ca%20%23%27%27%20%3C!--%20--%3E%0A%3Ca%20%C2%A3%27%27%20%3C!--%20--%3E%3Ca%20%C2%A4%27%27%20%3C!--%20--%3E%3Ca%20%E2%82%AC%27%27%20%3C!--%20--%3E%3Ca%20%C2%B4%27%27%20%3C!--%20--%3E%0A%3Ca%20%C2%A8%27%27%20%3C!--%20--%3E%3Ca%20-%27%27%20%3C!--%20--%3E%3Ca%20_%27%27%20%3C!--%20--%3E%3Ca%20.%27%27%20%3C!--%20--%3E%0A%3Ca%20%3A%27%27%20%3C!--%20--%3E%0AWITH%20BOTH%20QUOTE%20TYPES%0A%3Ca%20single%3D%27hey%27%20double%3D%22you%22%20%3C!--%20--%3E%0ASTOP%20AT%20HTML%20QUOTE%0A%3Ca%20%3D%27%20%3C!--%20this%20will%20break%20both%20the%20quotation%20and%20the%20HTML%20tag%20--%3E%0AEND%20OF%20INPUT%0A%3Ca%20%3D%27%0Athis%20is%20still%20part%20of%20the%20quote)：

```
/[^\w!#£¤€´¨\-.:]('|")(.|\n)*?(\1|<!--|$)/ 
```

但是，DISALLOW 区域（在正则表达式中）存在问题。正则表达式永远不应该在这里工作，因为第一个字符是不允许的。

在此先感谢您的帮助！

## 澄清

[regexpal.com](http://regexpal.com/?flags=g&regex=%5B%5E%5Cw!%23%C2%A3%C2%A4%E2%82%AC%C2%B4%C2%A8%5C-.%3A%5D%28%27%7C%22%29%28.%7C%5Cn%29%2a%3F%28%5C1%7C%3C!--%7C%24%29&input=ALLOW%20%3C!--%20--%3E%0A%3Ca%20%20%27%27%20%3C!--%20--%3E%0A%3Ca%20%24%27%27%20%3C!--%20--%3E%3Ca%20%25%27%27%20%3C!--%20--%3E%3Ca%20%26%27%27%20%3C!--%20--%3E%3Ca%20%2F%27%27%20%3C!--%20--%3E%0A%3Ca%20%28%27%27%20%3C!--%20--%3E%3Ca%20%29%27%27%20%3C!--%20--%3E%3Ca%20%7B%27%27%20%3C!--%20--%3E%3Ca%20%7D%27%27%20%3C!--%20--%3E%0A%3Ca%20%5B%27%27%20%3C!--%20--%3E%3Ca%20%5D%27%27%20%3C!--%20--%3E%3Ca%20%3D%27%27%20%3C!--%20--%3E%3Ca%20%3F%27%27%20%3C!--%20--%3E%0A%3Ca%20%2B%27%27%20%3C!--%20--%3E%3Ca%20%60%27%27%20%3C!--%20--%3E%3Ca%20%7C%27%27%20%3C!--%20--%3E%3Ca%20%5E%27%27%20%3C!--%20--%3E%0A%3Ca%20~%27%27%20%3C!--%20--%3E%3Ca%20%2a%27%27%20%3C!--%20--%3E%3Ca%20%2C%27%27%20%3C!--%20--%3E%3Ca%20%3B%27%27%20%3C!--%20--%3E%0A%3Ca%20%3C%27%27%20%3C!--%20--%3E%3Ca%20%5C%27%27%20%3C!--%20--%3E%0ADISALLOW%20%3C!----%3E%0A%3Ca%20a%27%27%20%3C!--%20--%3E%3Ca%209%27%27%20%3C!--%20--%3E%3Ca%20!%27%27%20%3C!--%20--%3E%3Ca%20%23%27%27%20%3C!--%20--%3E%0A%3Ca%20%C2%A3%27%27%20%3C!--%20--%3E%3Ca%20%C2%A4%27%27%20%3C!--%20--%3E%3Ca%20%E2%82%AC%27%27%20%3C!--%20--%3E%3Ca%20%C2%B4%27%27%20%3C!--%20--%3E%0A%3Ca%20%C2%A8%27%27%20%3C!--%20--%3E%3Ca%20-%27%27%20%3C!--%20--%3E%3Ca%20_%27%27%20%3C!--%20--%3E%3Ca%20.%27%27%20%3C!--%20--%3E%0A%3Ca%20%3A%27%27%20%3C!--%20--%3E%0AWITH%20BOTH%20QUOTE%20TYPES%0A%3Ca%20single%3D%27hey%27%20double%3D%22you%22%20%3C!--%20--%3E%0ASTOP%20AT%20HTML%20QUOTE%0A%3Ca%20%3D%27%20%3C!--%20this%20will%20break%20both%20the%20quotation%20and%20the%20HTML%20tag%20--%3E%0AEND%20OF%20INPUT%0A%3Ca%20%3D%27%0Athis%20is%20still%20part%20of%20the%20quote)上的示例。一切——除了禁止部分下的内容——都是正确的。

期望的结果应该如下。粗体表示使用上面显示的正则表达式匹配。（许多）HTML 注释以一致的方式结束 HTML 标记。

### 允许

*   <a '' **<!--** -->
*   <a **$''** <!-- -->
*   <a **%''** <!-- -->
*   <a **&''** <!-- -->
*   <a **/''** <!-- -->
*   <a **(''** <!-- -->
*   < **a** )'' <!-- -->
*   <a **{''** <!-- -->
*   <a **}''** <!-- -->
*   <a **[''** <!-- -->
*   <a **]''** <!-- -->
*   <a **=''** <!-- -->
*   <a **?''** <!-- -->
*   <a **+''** <!-- -->
*   <a **`''** <!-- -->
*   <a **|''** <!-- -->
*   <a **^''** <!-- -->
*   <a **~''** <!-- -->
*   <a ***''** <!-- -->
*   <a **,''** <!-- -->
*   <a **;''** <!-- -->
*   <a **<''** <!-- -->
*   <a **\''** <!-- -->

### 不允许

*   <a a'' <!-- -->
*   <a 9'' <!-- -->
*   <a !'' <!-- -->
*   <a #'' <!-- -->
*   <a £'' <!-- -->
*   <a ¤'' <!-- -->
*   <a €'' <!-- -->
*   <a ''' <!-- -->
*   <a ¨'' <!-- -->
*   <a -'' <!-- -->
*   <a _'' <!-- -->
*   <a .'' <!-- -->
*   <a :'' <!-- -->

### 两种报价类型

*   <a single **='hey'** double **="you"** <!-- -->

### 停在 HTML 报价单处

*   <a **='** <!-- 这将破坏引号和 HTML 标记 -->

### 输入结束

<一个**='**

**这 - 在新的一行 - 仍然是报价的一部分**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:23:43.203

我知道了。自然，应该排除匹配开头的引号字符。

```
/[^\w!#£¤€´¨\-.:'"]('|")(.|\n)*?(\1|<!--|$)/ 
```

# ruby-on-rails - restful api (rails)、mvc javascript 应用程序（ember 或骨干网）和基于令牌的身份验证

> ID：13765604
> 
> 赞同：3
> 
> 时间：2012-12-07T15:00:38.260
> 
> 标签：ruby-on-rails, backbone.js, ember.js, restful-authentication

我阅读了基于令牌的身份验证并获得了通用 ID。我不明白的是，如果所有通信都与您自己的 api 后端（在我的情况下为 rails）进行，为什么在前端（在我的情况下是 ember）我需要这样的令牌。如果您与自己的后端严格通信，并且将身份验证留在该后端，那么为什么需要在 ember 应用程序中使用令牌？

您的后端有时会充当代理，但这很糟糕吗？如果可能，直接从 ember 应用程序执行此操作会更好吗？我会（主要）去推特查询。

感谢您分享您的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T17:31:43.833

我自己对这个话题有点陌生，但你的问题也有点不清楚。如果您指的是 oAuth 系统中使用的消费者密钥令牌，则需要这些令牌以确保使用您的 API 的第三方实际上已被授予使用权限 - 没有消费者密钥的任何人都无法使用您的 API。

或者，如果您指的是使用身份验证令牌对用户进行身份验证...当您创建具有身份验证的 Rails 应用程序（例如使用设计 gem）时，还会创建/使用会话控制器。会话（/cookies）基本上是一种“记住”用户已登录的方式。这避免了在用户执行的每个操作时都必须重新发送用户名/密码以验证他/她的身份。

当涉及到网络应用程序时，这种方法非常有效，因为所有浏览器都支持 cookie。但是，对于移动应用程序，情况并非如此。使用本机应用程序时不可能保留会话/cookie（这在技术上是可行的，但从我所读到的内容看来，它似乎需要相当多的体力劳动和一些代码魔法才能使其正常工作）。

现在，当您为您的应用程序创建 API 时，您需要记住您的 API 可能用于创建移动应用程序（将来由您或如果您向公众开放）。这意味着使用会话可能不是一个好主意。对于需要授权的每个请求，都需要发送用户名/密码，以确保用户有权执行请求的操作。但是在每个请求中发送用户名/密码绝对是个坏主意。这就是令牌身份验证的用武之地。如果您曾经使用过设计，您会注意到有一个启用令牌身份验证的选项。这基本上允许第 3 方发送令牌而不是用户名/密码，并且工作方式相同。

（我自己对这个话题还很陌生，从我迄今为止收集的信息来看，这似乎是事情的运作方式。现在，如果我在解释/理解中犯了任何错误，我希望人们能纠正我。）

# arrays - Delphi中的关联数组，带有字符串键的数组是可能的吗？

> ID：13765606
> 
> 赞同：8
> 
> 时间：2012-12-07T15:00:42.913
> 
> 标签：arrays, delphi, key, associative, delphi-xe3

如果您使用 php，您可以在编程语言中看到 php 具有关联数组（或数组宽度字符串键）。例如：

```
$server['hostname']  =  'localhost';
$server['database']  =  'test';
$server['username']  =  'root';
$server['password']  =  'password' ;    

// 2d array
$all['myserver']['hostname'] = 'localhost' ; 
```

但是在delphi中找不到任何使用关联数组的默认方法。

首先，我想找到没有任何输出组件或类的默认方式。其次，如果我真的找不到内部方式，我只能强制选择输出类。

我使用 Delphi XE3 ，非常感谢您的帮助。

编辑：我在这里找到了一个类：`http://www.delphipages.com/forum/showthread.php?t=26334` 与 php 相同，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-07T15:04:01.067

您可以[`TDictionary<string,string>`](http://docwiki.embarcadero.com/Libraries/XE2/en/System.Generics.Collections.TDictionary)从本`Generics.Collections`机使用。

```
var
  Dict: TDictionary<string,string>;
  myValue: string;
....
Dict := TDictionary<string,string>.Create;
try
  Dict.Add('hostname', 'localhost');
  Dict.Add('database', 'test');
  //etc.
  myValue := Dict['hostname'];
finally
  Dict.Free;
end; 
```

等等等等。

如果你想要一个包含字典的字典，你可以使用`TDictionary<string, TDictionary<string,string>>`.

但是，当您这样做时，您需要特别注意外部字典中包含的字典项的生命周期。您可以使用它`TObjectDictionary<K,V>`来帮助您管理它。您将像这样创建这些对象之一：

```
TObjectDictionary<string, TDictionary<string,string>>.Create([doOwnsValues]); 
```

其`TObjectDictionary<k,V>`操作与传统`TObjectList`的`OwnsObjects`set to相同`True`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-07T15:06:45.290

您可以为此目的使用 tStrings 和 tStringList，但二维数组超出了这些组件的范围。

用法;

```
var
  names  : TStrings;
begin
  ...
  names := TStringList.Create;
  ...
  ...
  names.values['ABC'] := 'VALUE of ABC' ;
  ...
  ...
end ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-05T11:49:11.547

我以简单的方式解决了这个问题（示例）：

```
uses StrUtils;

...

const const_TypesChar : array [0..4] of String =
    (
      'I',
      'F',
      'D',
      'S',
      'B'
    );
const const_TypesStr : array [0..4] of String =
    (
      'Integer',
      'Float',
      'Datetime',
      'String',
      'Boolean'
    );

...

Value := const_TypesStr[ AnsiIndexStr('S', const_TypesChar) ];

// As an example, after execution of this code Value variable will have 'String' value.

// 
```

然后在程序中我们使用两个数组**const_TypesChar**和**const_TypesStr作为一个具有****AnsiIndexStr**函数的关联数组。

优点是它很简单，而且每次我们向数组中添加元素时，我们不需要在程序中的不同位置更改代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-13T21:38:01.830

看看**ArrayS**。您可以使用关联数组来存储预定义的数据类型（整数、字符串、布尔值、浮点数）或其中任何一种。例如，下面我定义了一个关联的浮点数数组：

```
uses ArrayS;

var floats : IFltArray;

floats := CreateArray;
floats['first'] := 0.1;
floats['second'] := 0.2;
writeln( floats['second'] ); 
```

等等。

**更新于 2020-03-15**

[压缩源代码](http://www.delphikingdom.com/zip/arrays.zip)

俄语[用法示例](http://www.delphikingdom.com/asp/viewitem.asp?catalogid=868)

# xml - 解析utf8 xml时出现lxml编码错误

> ID：13765614
> 
> 赞同：1
> 
> 时间：2012-12-07T15:01:12.770
> 
> 标签：xml, encoding, utf-8, lxml

我正在尝试使用 lxml 遍历 XML 文件（UTF-8 编码，以 开头），但在字符丂上出现以下错误：

UnicodeEncodeError: 'cp932' codec can't encode character u'\u4e02' in position 0: 非法多字节序列

在此之前的其他字符被正确打印出来。代码是：

```
parser = etree.XMLParser(encoding='utf-8')
tree = etree.parse("filename.xml", parser)
root = tree.getroot()
for elem in root:
    print elem[0].text 
```

该错误是否意味着它没有在 utf-8 中解析文件，而是在 shift JIS 中解析文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:28:12.297

`UnicodeEncodeError`指向异常发生位置的堆栈跟踪。不幸的是，您没有包含它，但它很可能是将 unicode 文本打印到标准输出的最后一行。我假设标准输出`cp932`在您的系统上使用编码。

如果我的假设是正确的，您应该考虑更改您的环境，以便 stdout 使用可以表示 unicode 字符的编码（如 UTF-8）。（参见示例[通过 Python 中的 sys.stdout 编写 unicode 字符串](https://stackoverflow.com/questions/1473577/writing-unicode-strings-via-sys-stdout-in-python)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-08T21:33:15.307

我在使用 lxml 的 objectify 时遇到了类似的情况。这是我能够解决它的方法。

```
import unicodedata
my_name = root.name.text
if isinstance(my_name, unicode):
    # Decode to string.
    my_name = unicodedata.normalize('NFKD', my_name).encode('ascii','ignore') 
```

# wordpress - WordPress 图片上传器显示在错误的位置

> ID：13765616
> 
> 赞同：0
> 
> 时间：2012-12-07T15:01:20.373
> 
> 标签：wordpress, wordpress-theming

我正在尝试构建一个管理设置页面，该页面将允许用户为他们的徽标上传图片。我正在使用本教程：[http ://www.webmaster-source.com/2010/01/08/using-the-wordpress-uploader-in-your-plugin-or-theme/](http://www.webmaster-source.com/2010/01/08/using-the-wordpress-uploader-in-your-plugin-or-theme/)

我已将其更改为将脚本添加到队列中，而不是像现在的最佳实践那样打印。我的代码如下：

```
function my_admin_scripts() {
wp_enqueue_script('media-upload');
wp_enqueue_script('thickbox');
wp_register_script('my-upload', get_stylesheet_directory_uri().'/bigg-options.js', array('jquery','media-upload','thickbox'));
wp_enqueue_script('my-upload');
}

function my_admin_styles() {
wp_enqueue_style('thickbox');
}

if (isset($_GET['page']) && $_GET['page'] == 'bigg_options') {
add_action('admin_enqueue_scripts', 'my_admin_scripts');
add_action('admin_enqueue_styles', 'my_admin_styles');
} 
```

和 Javascript：

```
jQuery(document).ready(function() {

jQuery('#upload_image_button').click(function() {
 formfield = jQuery('#upload_image').attr('name');
 tb_show('', 'media-upload.php?type=image&amp;TB_iframe=true');
 return false;
});

window.send_to_editor = function(html) {
 imgurl = jQuery('img',html).attr('src');
 jQuery('#upload_image').val(imgurl);
 tb_remove();
}

}); 
```

它工作，媒体上传窗口打开。但它不是屏幕中间的厚框弹出窗口，而是正常的，它出现在页面底部，偏向左侧并且部分被遮挡。这是它去向的屏幕截图：

![上传错误截图](../Images/e84c27dec2f4f3fece87e3fb43bdc04d.png)

关于它为什么这样做以及如何让它正确定位的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:43:26.817

用`&modal=true`在你的`tb_show()`：

```
tb_show('', 'media-upload.php?type=image&amp;modal=true'); 
```

我相信你还需要添加一个`width`and `height`。

# javascript - 如何判断模型是否是模板中的新模型？

> ID：13765617
> 
> 赞同：1
> 
> 时间：2012-12-07T15:01:22.100
> 
> 标签：javascript, templates, backbone.js

如果我的模型是新模型还是现有模型，我想在模板中显示特定元素。

我试图显示`{{ id }}`，`{{ cid }}`但`{{ isNew }}`它们都是空的。

以下是示例：

```
// The Model
var MyModel = Backbone.Model.extend({});

// In the view
var model = new Contact();
this.$el.empty().append(this.template(model.toJSON()));

// The template :
{{#if isNew}}New model{{/if}} 
```

我该如何测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:56:16.240

这是我想出的解决方案：

```
// The Model
var MyModel = Backbone.Model.extend({
    'toJSON': function () {
    // Copied from the source
    var obj = _.clone(this.attributes);

    obj['isNew'] = this.isNew();
    return obj;
    }
}); 
```

当然，这确保了这个模型没有属性“isNew”；）

# jquery - jquery加载缓存

> ID：13765625
> 
> 赞同：0
> 
> 时间：2012-12-07T15:01:54.137
> 
> 标签：jquery

我有一个 jquery click 事件，它使用 .load() 将 html 表单加载到 div 中

表单片段有一个参考 js 文件，它重新定义了 js，同时还使用 ajax 响应填充表单输入。

当我单击表单上的保存时，然后加载 div（使用 .load）保存的视图版本。

如果我再次单击编辑以发起我提到的第一个操作，则会执行加载但不会重新加载 javascript 引用，因此不会启动 ajax 填充

有什么解决办法吗？

```
<script type="text/javascript" src="js/controls.js"></script> 
```

编辑：添加代码

```
function populate() {
        var index = 1;
        $("#list").html("&nbsp;");
        for (item in object) {
            var html ='blah';
            $("#list").append(html);

            $(".item").live('click',
                function() {
                    $("#container").load("./html-includes/file.html?ver="+ver, function () {
                        apiCall.getData(referenceId);
                        alert('callback'+$rootScope.currentPage);
                    });
                }
            );
            index++;
        };
    } 
```

在这种情况下，文件 html 有前面提到的 javascript 参考，其中有一个调试警报，它在第二次调用 .load 时没有出现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:16:46.733

很可能您的 $.load() 方法第一次工作，因为浏览器没有缓存中的数据。下次在循环中调用它时，不会执行 Ajax 调用，而是从缓存中返回数据。结果回调没有被触发....您可以使用 fidller 或类似工具看到这一点 - 您只会看到对服务器的一个请求....

可能的解决方案是关闭缓存（参见 $.ajax() 方法）或像当前时间一样在查询（又名 url）中添加动态参数，因此浏览器不会缓存结果。或者在 $.load() 中使用 post 方法（只需添加要发送的任何数据，Jquery 将使用 post 而不是 get），尽管我不确定这是否是一种优雅的方式 -)。

# android - 从另一个接收器启动广播接收器（启动接收器）

> ID：13765627
> 
> 赞同：0
> 
> 时间：2012-12-07T15:02:00.553
> 
> 标签：android, broadcastreceiver

在我的应用程序中，我有一个启动接收器，所以当设备重新启动时，我想唤醒另一个接收器。所以请帮助我。下面是我的代码：

```
public class BootUpReciever extends BroadcastReceiver{

Context context;
SharedPreferences settings;
SmsManager smsMgr = SmsManager.getDefault();
public static final String PREFS_NAME = "MyPrefsFile";

@Override
public void onReceive(Context context, Intent intent) {

    Intent sms = new Intent(context, SMSReceiver.class);
    sms.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    context.startActivity(sms);

    Intent netAvailability = new Intent(context, CheckingNetworkAvailability.class);
    netAvailability.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    context.startActivity(netAvailability); 
}    } 
```

这里 SMSReceiver.class 和 heckingNetworkAvailability.class 是我的接收者。我做错了什么吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T03:27:45.270

现在我正在使用包管理器并且它工作正常:)

```
@Override
public void onReceive(final Context context, Intent intent) {

    ComponentName sms = new ComponentName(context, SMSReceiver.class);
    context.getPackageManager().setComponentEnabledSetting(sms, 
            PackageManager.COMPONENT_ENABLED_STATE_ENABLED, PackageManager.DONT_KILL_APP);

    ComponentName net = new ComponentName(context, CheckingNetworkAvailability.class);
    context.getPackageManager().setComponentEnabledSetting(net, 
            PackageManager.COMPONENT_ENABLED_STATE_ENABLED, PackageManager.DONT_KILL_APP);
} 
```

# android - Toast 未显示在 AsyncTask 中

> ID：13765633
> 
> 赞同：-1
> 
> 时间：2012-12-07T15:02:25.147
> 
> 标签：android, android-asynctask, toast

问题很简单。实际上，当我尝试敬酒时，它没有显示出来。你能指导我解决这个问题吗？

```
 protected String doInBackground(Void... params) {
            if (result.equals("200")) {
              Toast.makeText(CallArduino,appliance + " Success ",Toast.LENGTH_LONG).show();    
          }else { 

                Toast.makeText(CallArduino, "Failed", Toast.LENGTH_SHORT).show();      
          } 

    return "success";
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:04:09.500

`Toast`不能在后台线程中显示，您应该在 UI 线程中调用它，`onPostExecute()`例如

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T15:03:48.337

您正在尝试在后台线程上执行 UI 操作，这是被禁止的。

任何 UI 操作（包括显示 toast）都必须在 UI 线程中完成。

例如，您可以在方法中显示您的吐司`onPostExecute`：

```
protected String doInBackground(Void... params) {
    // do your background stuff
} 

protected void onPostExecute (Result result) {
    if (result.equals("200")) {
        Toast.makeText(CallArduino,appliance + " Success ",Toast.LENGTH_LONG).show();    
    }else { 

        Toast.makeText(CallArduino, "Failed", Toast.LENGTH_SHORT).show();      
    } 
} 
```

# javascript - Chrome 浏览器中的客户端 XSLT 处理似乎依赖于 JavaScript

> ID：13765634
> 
> 赞同：0
> 
> 时间：2012-12-07T15:02:25.093
> 
> 标签：javascript, google-chrome, xslt

# 简单的问题

Chrome/Chromium 浏览器内置的 XSLT 处理是否依赖于启用的 JavaScript？

# 语境

我有一个 Web 应用程序，它始终提供 XML 以使用 XSLT 在客户端进行转换。它还大量使用客户端 JavaScript。我添加了一些标记和 JavaScript，如果 JavaScript 没有运行，它会向用户显示一个警告，即应用程序将无法正常运行，直到他们打开它。

这适用于 IE 和 Firefox，但是当我在 Chrome 浏览器中“不允许”JavaScript 时，页面根本不会呈现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:01:05.773

我在 Windows 7 上使用 Google Chrome 版本 23.0.1271.95 m 进行了测试，测试文档[http://home.arcor.de/martin.honnen/xslt/test2012120701.xml](http://home.arcor.de/martin.honnen/xslt/test2012120701.xml)`xml-stylesheet` （具有应用 XSLT 样式表 test2012120701.xsl的处理指令的 XML 文档创建带有 script 元素的 HTML 结果文档）和[http://home.arcor.de/martin.honnen/xslt/test2012120702.xml](http://home.arcor.de/martin.honnen/xslt/test2012120702.xml)（具有处理指令的 XML 文档`xml-stylesheet`应用 XSLT 样式表 test2012120702.xsl，它创建没有任何脚本的 HTML 结果文档）事实上，对于这两个文档，当在 Chrome 中禁用 Javascript 时，什么都不会呈现。使用带有 F12 的开发人员工具只显示`xml-stylesheet`文档树中的处理指令节点。

因此，基于该测试，确实似乎在 Chrome 中禁用 Javascript 会阻止通过`xml-stylesheet`处理指令进行的 XSLT 处理工作。当我在 Chrome 中再次启用 Javascript 并重新加载文档时，两种情况都会应用 XSLT。

Chrome 的行为是故意的还是我不知道的错误，但我可以确认问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:12:42.337

不，它没有

问题是您调用 XSLT 转换的方式

如果您使用处理指令执行此操作

拿这个不使用Javascript的样本（或多或少工作）

[http://innovimax.fr/open-data.xsl](http://innovimax.fr/open-data.xsl)

我说“或多或少”是因为该示例是在 Twitter 拥有 XML API 时完成的。现在只有 JSON。

# installation - ClickOnce 应用程序在错误的目录中查找

> ID：13765635
> 
> 赞同：0
> 
> 时间：2012-12-07T15:02:28.003
> 
> 标签：installation, clickonce, datadirectory

我有一个用 SQL 数据库制作的程序。在 VS 2010 中一切正常。但后来我发布它并抛出一个错误，说它找不到我的数据库。我用过|数据目录| 当我为它编写字符串时，我搜索了我的数据库文件。

我找到了一个文件夹，其中包含我的数据库和应用程序文件。我双击它，你知道什么，工作正常。我唯一的问题是安装程序的所有快捷方式都不起作用，它们指向一个空文件夹。有没有办法让它们链接到安装程序制作的这个好文件夹？

我注意到它在文件夹名称“data”下的文件路径下寻找我的数据库。在我的应用程序安装到的组件上的 AppData/Local 中有 2 个文件夹。一个导致我的应用程序，另一个导致什么都没有，并被标记为“数据”。似乎我的程序一直在里面寻找，但就像我说的，如果我按照其他路径并直接从该文件夹运行 .exe，它运行正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T16:41:23.750

Make sure your database is part of your project, and that the build type is "content", and "copy to output" is set to "copy always". In the Application Files dialog, make sure the database shows up, and is marked Data (which it sounds like you have). Is the database included in the deployment when you publish (check the output)? IF not, is it included in the files output when you build the project?

# jquery - 自动检测 CSS3 并切换 jQuery 动画/CSS3 过渡

> ID：13765636
> 
> 赞同：2
> 
> 时间：2012-12-07T15:02:29.693
> 
> 标签：jquery, css

是否有任何允许编写的插件或代码让我们说

```
$('something').move('left':'50px'); 
```

并会检测浏览器是否支持 CSS3 过渡，如果不支持 CSS3，将使用它们或正常的 jQuery 动画？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T15:04:46.680

是的，[jQuery 动画增强了](http://playground.benbarnett.net/jquery-animate-enhanced/).

它回退到 jQuery 的基于 JS 的动画，其中 CSS3 过渡不可用。

# macos - 带有 tmux / tmuxinator 和 iTerm2 的多个选项卡

> ID：13765639
> 
> 赞同：15
> 
> 时间：2012-12-07T15:02:46.477
> 
> 标签：macos, tmux, iterm, tmuxinator

我想在 iTerm2 中打开我所有有用的东西：

![没有 tmux 的 iTerm2](../Images/2ef221164255db9528345a020b85c7ee.png)

不像这样：

![带有 tmux 的 iTerm2](../Images/fd307c9281c5a2ebaa6e34cee8f280a2.png)

我正在使用 tmuxinator 我已经定义了一些选项卡。我想知道是否有可能获得前一种行为。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-11-02T22:53:58.933

我刚刚尝试使用 tmux 1.8。不是很明显，但**它确实有效**。

这是你要做的：

1.  打开 iTerm2（最新，确保至少安装了 tmux 1.8）。
2.  在 iTerm2 中，运行命令`tmux <your tmuxinator profile>`。然后分离`^b d`。
3.  在 iTerm2 中，运行命令`tmux -CC attach -t <your session>`。您将看到您的选项卡在不同的窗口中打开。
4.  打开菜单 Shell->Tmux->Dashboard
5.  选择并隐藏所有窗口。
6.  选择所有隐藏的窗口，然后单击在选项卡中打开。

我想知道如何避免在选项卡中隐藏和打开的部分。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-06-25T21:59:30.907

只是想对 justingordon 提到的[(1)](https://stackoverflow.com/a/19747819/3777091)添加一些评论。

这一切都很好。但我发现了如何简化步骤 4-6，使其自动发生。

转到 iTerm2 的***Preferences***，在***General***下，您将看到一个标题为***tmux***的部分。有一个选项说*附加时，打开无法识别的窗口*。如果您将当前选择从*Windows*更改为*Tabs*。

两个额外的提示。

1.  如果您愿意，您可以选择选项*Automatically hide the tmux client session after connection*。这将最小化您输入的 iTerm2 窗口

    tmux -CC 附加

2.  我还启用了选项*Focus follow mouse*。您可以在 Preferences 然后 Pointer 下找到此选项。它应该是左下角的第一个选项。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-10-06T14:40:35.290

要`tmuxinator`与`iterm2`窗格一起使用，请使用以下配置：

```
 attach: false 
```

结合

```
on_project_exit:
  - tmux -CC attach -t way 
```

它看起来像[这里所说的文档中的一个问题](https://github.com/tmuxinator/tmuxinator/issues/588#issuecomment-418236419)

这是我通常使用的示例：

```
# ~/.tmuxinator/way.yml
name: way
root: ~/learn/ruby/ruby-way/
attach: false
on_project_exit:
  - tmux -CC attach -t way

# Runs before everything. Use it to start daemons etc.
on_project_start:
  - export EDITOR="emacsclient --server-file=way -c"
  - export VISUAL=$EDITOR
  - emacs --daemon=way --title=RUBY-WAY
  - $EDITOR &

windows:
  - console:
      - echo "A currar"
  - testing:
      - echo "A testear" 
```

我希望这个对你有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-23T03:21:29.147

将此添加到您的`tmuxinator`配置中：

```
attach: false
post: tmux -CC attach 
```

[https://github.com/tmuxinator/tmuxinator/pull/293](https://github.com/tmuxinator/tmuxinator/pull/293)

# loops - VBA 代码需要很长时间才能执行

> ID：13765640
> 
> 赞同：1
> 
> 时间：2012-12-07T15:02:57.840
> 
> 标签：loops, excel, vba

以下 VBA 代码需要很长时间才能执行。我在 25 分钟前运行了 48,000 行，它仍在运行。如何缩短执行时间？

```
Sub delrows()

Dim r, RowCount As Long
r = 2

ActiveSheet.Columns(1).Select
RowCount = UsedRange.Rows.Count
userresponse = MsgBox("You have " & RowCount & " rows", vbOKOnly, "Info")

Rows(RowCount).Delete Shift:=xlUp

' Trim spaces

Columns("A:A").Select
Selection.Replace What:=" ", Replacement:="", LookAt:=xlPart, _
    SearchOrder:=xlByRows, MatchCase:=False, searchFormat:=False, _
    ReplaceFormat:=False

' Delete surplus columns

Range("L:T,V:AA,AE:AG,AR:AR,AU:AU,AZ:AZ").Select
    Selection.Delete Shift:=xlToLeft

' Delete surplus rows

Do
    If Left(Cells(r, 1), 1) = "D" _
       Or Left(Cells(r, 1), 1) = "H" _
       Or Left(Cells(r, 1), 1) = "I" _
       Or Left(Cells(r, 1), 2) = "MD" _
       Or Left(Cells(r, 1), 2) = "ND" _
       Or Left(Cells(r, 1), 3) = "MSF" _
       Or Left(Cells(r, 1), 5) = "MSGZZ" _
       Or Len(Cells(r, 1)) = 5 _
       Or Cells(r, 3) = 0 Then
       Rows(r).Delete Shift:=xlUp
    ElseIf Int(Right(Cells(r, 1), 4)) > 4000 Then
       Rows(r).Delete Shift:=xlUp
    Else: r = r + 1
    End If
Loop Until (r = RowCount)

End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T17:10:43.003

最大的问题可能是您正在循环的数据量。我已经更新了您的代码以创建一个公式来检查是否需要删除该行，然后您可以过滤该公式结果并一次删除所有行。

我做了很多评论来帮助你清理你的代码并理解我做了什么。我在评论前加上`'=>`.

最后一点，将值加载到数组中也可能会有所帮助，但是如果您有很多很多列的数据，这可能会更加困难。我没有大量的经验，但我知道它让世界变得更快！

祝好运并玩得开心点！

```
Option Explicit

Sub delrows()

With Application
    .ScreenUpdating = False
    .Calculation = xlCalculationManual
End With

Dim r As Long, RowCount As Long
r = 2

Dim wks As Worksheet
Set wks = Sheets(1) '=> change to whatever sheet index (or name) you want

'=> rarely a need to select anything in VBA [ActiveSheet.Columns(1).Select]

With wks

    RowCount = .Range("A" & .Rows.Count).End(xlUp).Row '=> as opposed to  [RowCount = UsedRange.Rows.Count], as UsedRange can be misleading
                                                            'NOTE: this also assumes Col A will have your last data row, can move to another column

    userresponse = MsgBox("You have " & RowCount & " rows", vbOKOnly, "Info")

    .Rows(RowCount).Delete Shift:=xlUp

    ' Trim spaces

    '=> rarely a need to select anything in VBA [Columns("A:A").Select]
    .Range("A1:A" & RowCount).Replace What:=" ", Replacement:="", lookat:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, searchFormat:=False, _
        ReplaceFormat:=False

    ' Delete surplus columns

    '=> rarely a need to select anything in VBA [Range("L:T,V:AA,AE:AG,AR:AR,AU:AU,AZ:AZ").Select]
    .Range("L:T,V:AA,AE:AG,AR:AR,AU:AU,AZ:AZ").Delete Shift:=xlToLeft ' as opposed to Selection.Delete Shift:=xlToLeft

    ' Delete surplus rows

    '=> Now, here is where we help you loop:

    '=> First insert column to the right to capture your data
    .Columns(1).Insert Shift:=xlToRight
    .Range("A1:A" & RowCount).FormulaR1C1 = "=If(OR(Left(RC[1],1) = ""D"",Left(RC[1],1) = ""H"", Left(RC[1],1) = ""I"", Left(RC[1],2) = ""MD"",Left(RC[1],2) = ""ND"",Left(RC[1],3) = ""MSF"",Left(RC[1],5) = ""MSGZZ"",Len(RC[1])=5),""DELETE"",If(Int(Right(RC[1],4)) > 4000,""DELETE"",""""),""""))"

    '=> Now, assuming you something to delete ...
    If Not .Columns(1).Find("DELETE", LookIn:=xlValues, lookat:=xlWhole) Is Nothing Then

        '=> filter and delete
        .Range("A1:A" & RowCount).AutoFilter 1, "DELETE"
        Intersect(.UsedRange, .UsedRange.Offset(1), .Range("A1:A" & RowCount)).SpecialCells(xlCellTypeVisible).EntireRow.Delete

    End If

    '=> Get rid of formula column
    .Columns(1).EntireColumn.Delete

End With

With Application
    .ScreenUpdating = True
    .Calculation = xlCalculationAutomatic
End With

End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T17:43:32.217

它如此缓慢的原因是您正在迭代每个单元格。下面复制到一个数组，找到需要删除的行然后删除。将 Sheet4 更新为您的工作表并将 Range("A2").CurrentRegion 更新为您需要的区域：

```
Dim data() As Variant
Dim count As Double, i As Double, z As Double, arrayCount As Double
Dim deleteRowsFinal As Range
Dim deleteRows() As Double

Application.ScreenUpdating = False

data = Sheet4.Range("A2").CurrentRegion.Value2

    For i = 1 To UBound(data, 1)        
        count = count + 1
        If (data(i, 1) = "D" Or Left(data(i, 1), 1) = "H" Or Left(data(i, 1), 1) = "I" Or Left(data(i, 1), 2) = "MD" _
                Or Left(data(i, 1), 2) = "ND" Or Left(data(i, 1), 3) = "MSF" Or Left(data(i, 1), 5) = "MSGZZ" _
                Or Len(data(i, 1)) = 5 Or data(i, 3) = 0 Or Int(Right(IIf(Cells(i, 1) = vbNullString, 0, Cells(i, 1)), 4)) > 4000) Then

            ReDim Preserve deleteRows(arrayCount)
            deleteRows(UBound(deleteRows)) = count
            arrayCount = arrayCount + 1                
        End If    
    Next i

    Set deleteRowsFinal = Sheet4.Rows(deleteRows(0))

    For z = 1 To UBound(deleteRows)
        Set deleteRowsFinal = Union(deleteRowsFinal, Sheet4.Rows(deleteRows(z)))
    Next z

    deleteRowsFinal.Delete Shift:=xlUp    

Application.ScreenUpdating = True 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T15:06:50.677

关闭屏幕更新以开始。在下面添加您的观察结果。
如果您认为它不会影响任何事情，您也可以禁用计算。

```
Application.ScreenUpdating = False

your code...

Application.ScreenUpdating = True 
```

编辑：我在这里上传了一个文件 - [https://dl.dropbox.com/u/24702181/TestDeleteRowsInChunk.xls](https://dl.dropbox.com/u/24702181/TestDeleteRowsInChunk.xls)

工作簿已启用宏。
打开后，单击“恢复数据”，然后单击“开始删除”。

查看代码以获取详细信息。我想它可以进一步优化。
几个提示

*   做一个反向循环。
*   获取数组中的单元格内容，使用数组检查值。
*   为要删除的行构建一个字符串。
*   分块删除。

# c# - LINQ 和 SQL 中的数据透视表 OR Where 子句

> ID：13765643
> 
> 赞同：-1
> 
> 时间：2012-12-07T15:03:24.503
> 
> 标签：c#, sql, linq

我正在尝试基于使用 SQL 和 LINQ 的表来实现行列表。可用表如下：

```
ID  SName  SValue  LName  LValue  FName  FValue
1   TextS  1.1     null   null    null   null
2    null  null    TextL  2.2     null   null
3    null  null    null   null    TextF  3.3 
```

我正在尝试编写一个查询，该查询可能会产生如下列表：

```
listColumn1  listColumn2
TextS        1.1
TextL        2.2
TextF        3.3 
```

请帮助您的专家建议。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:17:35.267

您没有指定您使用的 RDBMS，但如果您使用的是 SQL Server 2008+，并且您想在 SQL 中执行此操作，然后使用结果，您可以`UNPIVOT`获取数据：

```
SELECT x.listColumn1,
  x.listColumn2
FROM YourTable t
CROSS APPLY 
(
    VALUES
        (t.SName, t.SValue),
        (t.LName, t.LValue),
        (t.FName, t.FValue)
) x (listColumn1, listColumn2)
where x.listColumn1 is not null
  and x.listColumn2 is not null 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/10a36/4)

结果：

```
| LISTCOLUMN1 | LISTCOLUMN2 |
-----------------------------
|       TextS |         1.1 |
|       TextL |         2.2 |
|       TextF |         3.3 | 
```

# jquery-mobile - 从 jQuery Mobile 重置值

> ID：13765644
> 
> 赞同：2
> 
> 时间：2012-12-07T15:03:24.057
> 
> 标签：jquery-mobile, select, input, checkbox, radio

我需要重置我页面的字段元素的所有值。元素是：输入、选择（组合框）、复选框和单选组。搜索发现如下代码：

```
$("*").attr('value', '');
$("input[type='checkbox']").attr("checked",false); 

$('select').each(function() {
    if($(this).children().length > 0) {
        $($(this).children()[0]).attr('selected', 'selected');
        $(this).change();
    }
}); 
```

此代码的输入和复选框都可以，但其他组件在测试的代码中存在问题。广播组需要或采取任何一种选择，或至少选择第一种。组合框使用此代码重置，但在尝试选择新值时，它不会存储您的值。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:39:35.377

非文本输入需要刷新。这是一个这样做的例子：

```
//reset text input values, then refresh slider widgets
$(".ui-input-text").val('').filter('.ui-slider-input').slider('refresh');

//reset checkboxes and radio inputs, then refresh them
$(".ui-checkbox input[type='checkbox'], .ui-radio input[type='radio']").prop("checked", false).checkboxradio("refresh"); 

//reset all select menus and then refresh them
$('.ui-select select').val('').selectmenu('refresh');
return false; 
```

这是一个演示：http: [//jsfiddle.net/MLewd/1/](http://jsfiddle.net/MLewd/1/)

# javascript - “？”时的窗口事件 在当前 URL 之后添加

> ID：13765646
> 
> 赞同：0
> 
> 时间：2012-12-07T15:03:27.957
> 
> 标签：javascript, events, window

Hashchange 适用于何时

```
index.php 
```

改变，说

```
index.php#my-hash 
```

IE

```
$(window).bind('hashchange', function() {
  // do stuff
}); 
```

但是当有 时有事件吗？在网址之后，即

```
index.php?id=foo&something_else=bar... 
```

**编辑**

好的，这是我提交表格的时候。我提交表单，然后 URL 更改为

```
index.php?id=blah#my-hash 
```

但是我尝试听a）hashchange和b）表单提交：

```
$('form').submit(function() {
        go_to_signup_form();
}); 
```

两者都不起作用（我认为页面令人耳目一新？）。我不能过多地改变 php，因为它是 cms 的一部分，我不想破坏控制器类中发生的任何事情，所以我宁愿尝试看看何时：

```
index.php 
```

更改为

```
index.php?id=blah#my-hash 
```

编辑＃2感谢大家的反馈，让它与：

```
if (url.indexOf("?") !== -1) {
    go_to_signup_form();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:08:06.163

不，那是因为参数 ( `?foobar`) 通常不用于客户端代码。链接到同一个 url ( `index.php -> index.php?foo=bar`) 上的新参数会使您的浏览器加载新页面，而添加哈希 ( `index.php -> index.php#foo=bar`) 不会使浏览器向服务器传输任何数据。

url 的哈希部分，它是客户端数据。因此，为它设置一个`change`事件侦听器很有用。

在您的控制台中尝试这些，在 URL 中还没有哈希的随机站点上：

```
window.location.href += "?test" 
```

和：

```
window.location.href += "#test" 
```

您将看到第一个将重新加载页面（发送新的 HTTP 请求），第二个似乎不会做任何事情。

要阻止表单提交：

```
$('#target').submit(function() {
    // Your onclick code here
    return false; // Do not submit.
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:07:57.177

问题在于“hashchange”（从技术上讲，它意味着导航到锚点）完全是客户端操作。但是带有参数（“？”运算符）的 URL 会通过对服务器的新 HTTP 请求来实现，这会导致将新文档发送给用户。这意味着当用户点击链接`index.php?id=foo`时，页面会重新加载。

但是您可以通过检查`window.location.href`字符串来检查加载页面的 URL 的参数。

# json - 带有通过 JSON 提供的工具提示值的折线图上的 Googlechart 错误

> ID：13765649
> 
> 赞同：3
> 
> 时间：2012-12-07T15:03:43.453
> 
> 标签：json, google-visualization

我有一个谷歌图表，想添加一个自定义工具提示。[我在这个](https://stackoverflow.com/questions/2068593/how-to-customize-tooltipstext-and-format-in-google-vizualization-bar-charts)网站上找到了一些很棒的答案，并开始使用角色来做这件事。我还找到[了有关它的链接](https://developers.google.com/chart/interactive/docs/roles?hl=zh-CN)，它看起来是最好的方法。

我的数据是通过 json 生成的，我使用 php 文件来创建 json 提要。我这样编码的行

```
{"cols": [ {"id":"","label":"Period","pattern":""},
{"id":"","label":"Recorded P/L","type":"number", "role":"data"} ,
{"id":"","label": null,"type":"string", "role":"tooltip"},
{"id":"","label":"Best Available P/L","type":"number", "role":"data"},
{"id":"","label": null,"type":"string", "role":"tooltip"}
    ] 
```

然后它继续并添加所有数据。问题是当我尝试运行它时出现错误

给定轴上的所有系列必须具有相同的数据类型

我检查了 json 并且格式正确，但不确定我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T14:51:32.753

至少部分问题是您没有为第一列指定类型。

# symfony - 未找到 PHPUnit 的 TextUI/command.php

> ID：13765651
> 
> 赞同：6
> 
> 时间：2012-12-07T15:03:46.370
> 
> 标签：symfony, phpunit, composer-php

我按照以下步骤为我的 symfony2 项目安装了 phpunit： [如何使用从 composer 安装的 phpunit？](https://stackoverflow.com/questions/13764309/how-to-use-phpunit-installed-from-composer/13764915#13764915)

但我现在收到以下错误：

> 警告：包括（C:\Program Files (x86)\Zend\Apache2\Program Files (x86)\Zend\Apache2\htdocs\project1\vendor\phpunit\phpunit\PHPUnit\TextUI\Command.php）：无法打开流：第 150 行的 C:\Program Files (x86)\Zend\Apache2\htdocs\project1\vendor\composer\ClassLoader.php 中没有这样的文件或目录

该文件确实存在并且在 autoload_classmap 文件中，所以我不确定为什么我在运行时收到此错误`vendor/bin/phpunit -c app`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T21:26:41.510

你只应该修复你的 basePath 问题：而不是这个：

`C:\Program Files (x86)\Zend\Apache2\Program Files (x86)\Zend\Apache2\htdocs\project1\vendor\phpunit\phpunit\PHPUnit\TextUI\Command.php`

应该是这样的： `C:\Program Files (x86)\Zend\Apache2\htdocs\project1\vendor\phpunit\phpunit\PHPUnit\TextUI\Command.php`

你应该去阅读第 150 行`composer\ClassLoader.php`，如果可能的话，添加一些`echo`或`var_dump`调试并查看那里使用的变量的内容，这些变量指向错误的路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T07:26:55.143

`Program Files (x86)\Zend\Apache2\`

在包含错误中出现两次，但在打开流错误中没有出现。

`open stream: No such file or directory in C:\Program Files (x86)\Zend\Apache2\htdocs\project1\vendor\composer\ClassLoader.php on line 150`

# entity - 使用 Visual Studio 2010、Entity Framework 5.0、.Net Framework 4.0 刷新表会强制您删除表并重新添加它

> ID：13765657
> 
> 赞同：0
> 
> 时间：2012-12-07T15:04:01.870
> 
> 标签：entity

我想对 edmx 设计器中的表进行更改，因为我在 Sql Server DB（从数据库更新模型）中添加了一个列。当向导上来刷新表时，要刷新的表不在列表中（在刷新选项卡中），即使它位于设计器上。

我不得不删除表格，再次通过向导查看“添加”选项卡下的表格，并且能够使用新列重新添加它。

这种方法的问题是，如果你有一个或两个表就可以了，但是如果你的模型中有很多表怎么办？您必须删除整个模型并再次重新选择每个表才能重新创建模型。

我在这里错过了一步还是什么？

据我所知，使用带有 4.5 框架的 Visual Studio 2012 也会发生同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T16:38:17.313

我必须将 SP 1 应用于 VS 2010 和 2012 才能使其正常工作。

# php - 将类属性添加到表单错误

> ID：13765662
> 
> 赞同：14
> 
> 时间：2012-12-07T15:04:12.457
> 
> 标签：php, css, zend-form, zend-framework2

我正在使用 Zend Framework 2 开发应用程序，并使用**FormRow**帮助器在表单中呈现标签、输入和错误（如果存在）。

```
//within the view
echo $this->formRow($form->get('Name')); 
```

当用户在未填写所需输入文本字段的情况下提交表单时，FormRow 会呈现以下错误消息：

```
<label>
    <span>Name: </span>
    <input class="input-error" type="text" value="" placeholder="Insert Name Here" name="Name">
</label>
<ul>
    <li>Value is required and can't be empty</li>
</ul> 
```

如何为**li**标签设置一个类以在之后对其进行样式设置？

我知道我可以通过...回显带有所需类属性的 formElementErrors

```
<?php echo $this->formElementErrors($form->get("Name"), array('class' => "valuerequired", 'message' => "errortestmessage")); ?> 
```

..但是 FormRow 仍然会在没有类的情况下呈现错误消息。

仅供参考，我以这种方式设置实体：

```
public function getInputFilter()
    {
        if (!$this->inputFilter) {
            $inputFilter = new InputFilter();

            $factory = new InputFactory();

            $inputFilter->add($factory->createInput(array(
                'name'     => 'Name',
                'required' => true,
                'filters'  => array(
                    array('name' => 'StripTags'),
                    array('name' => 'StringTrim'),
                ),
                'validators' => array(
                    array(
                        'name'      => 'StringLength',
                        'options' => array(
                            'encoding' => 'UTF-8',
                            'min'      => 1,
                            'max'      => 100,
                        ),
                    ),
                ),
           )));

            $this->inputFilter = $inputFilter;
        }
        return $this->inputFilter;
    } 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-07T15:48:02.663

见[formElementErrors 的代码](https://github.com/zendframework/zf2/blob/master/library/Zend/Form/View/Helper/FormElementErrors.php)

基本上你可以这样做：

```
$this->formElementErrors($elem)
     ->setMessageOpenFormat('<ul%s><li class="some-class">')
     ->setMessageSeparatorString('</li><li class="some-class">'); 
```

但这很不方便......

更好的解决方案是通过您自己的类扩展 Zend\Form\View\Helper\FormElementErrors，然后将视图助手 formElementErrors 注册到您的类。所以基本上你会有这样的东西：

```
namespace Mymodule\Form\View\Helper;

use Zend\Form\View\Helper\FormElementErrors as OriginalFormElementErrors;

class FormElementErrors extends OriginalFormElementErrors  
{
    protected $messageCloseString     = '</li></ul>';
    protected $messageOpenFormat      = '<ul%s><li class="some-class">';
    protected $messageSeparatorString = '</li><li class="some-class">';
} 
```

最后一件事就是用这个新类注册视图助手。为此，您在 Modules Module.php 中提供以下代码

```
public function getViewHelperConfig()
{
    return array(
        'invokables' => array(
            'formelementerrors' => 'Mymodule\Form\View\Helper\FormElementErrors'
        ),
    );
} 
```

**displaimer**：此代码未经测试，如果有一些错误，请告诉我，但我认为这应该很好。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-12T15:58:59.080

好的，我自己的问题的解决方案就在我面前，而不是使用：

```
//within the view
echo $this->formRow($form->get('Name')); 
```

我分别调用了表单的每个元素：

```
 //within the view
    echo $this->formLabel($form->get('Name'));
    echo $this->formInput($form->get('Name'));
    echo $this->formElementErrors($form->get("Name"), array('class' => "some_class", 'message' => "errormessage")); 
```

不知道这是否是最有效的方法，如果您不这么认为，请留言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-18T09:25:12.167

FormRow 检查“form_element_errors”插件是否注册。如果是这样，则默认使用它来显示错误消息。

所以山姆的例子工作。您应该重新定义标准插件并告知 mvc。

我已经在 module.config.php 中完成了

```
'view_helpers' => array(
'invokables' => array(
    'formElementErrors'=> 'MyModule\View\Helper\FormElementErrors', 
```

和 FormRow 如我所愿开始显示错误:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-19T12:19:07.720

作为您的问题，请尝试

改变

```
//within the view
echo $this->formRow($form->get('Name')); 
```

至

```
//within the view
echo $this->formRow($form->get('Name'),null,false);
// Note: add more 2 last parameters, false- for $renderErrors => will NOT render Errors Message. 
//Look original function in helper/formrow.php: function __invoke(ElementInterface $element = null, $labelPosition = null, $renderErrors = null, $partial = null) 
```

将错误消息呈现为您的功能

```
echo $this->formElementErrors($form->get('name'), array('class' => 'your-class-here')); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-11T14:46:03.393

来自 ZF2 的文档。这是链接： http: [//framework.zend.com/manual/2.0/en/modules/zend.form.view.helpers.html#formelementerrors](http://framework.zend.com/manual/2.0/en/modules/zend.form.view.helpers.html#formelementerrors)

```
echo $this->formElementErrors($element, array('class' => 'help-inline'));
// <ul class="help-inline"><li>Value is required and can&#039;t be empty</li></ul> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-10T14:46:33.023

我`echo $this->formElementErrors($form, array('class' => "error-messages"));`习惯在一个地方显示所有错误消息：

```
echo $this->formElementErrors($form, array('class' => "error-messages"));// Print all error messagess

echo $this->formLabel($form->get('Name'));
echo $this->formInput($form->get('Name'));

echo $this->formLabel($form->get('Name2'));
echo $this->formInput($form->get('Name2')); 
```

# ruby - 水豚来访表现得很奇怪

> ID：13765664
> 
> 赞同：1
> 
> 时间：2012-12-07T15:04:22.563
> 
> 标签：ruby, https, capybara

我对访问命令有一个奇怪的问题。

感觉就像挂在一个安全的 (https://) 网站上一样。

当我有

```
When /^I access a company page$/ do
   visit('https://www.yahoo.com/yahoo')
end

When /^I access the Terms of Use Page$/ do
   visit('https://www.yahoo.com/terms-of-use')
end

When /^I access the Privacy Policy Page$/ do
   visit('https://www.yahoo.com/privacy')
end 
```

我解析到第一个调用的站点，后续访问在浏览器中显示新的 url，但继续解析到第一个站点。

有任何想法吗？

# javascript - 悬停仅在用户单击元素时有效

> ID：13765670
> 
> 赞同：0
> 
> 时间：2012-12-07T15:04:55.683
> 
> 标签：javascript, jquery, twitter-bootstrap

以下是我的 js fiddle 的链接，我试图在其中显示`hover for popover`带有 id的元素的悬停属性的弹出框`a1`。我面临的问题是，当页面首次加载并悬停在该元素上时，弹出框不会显示。但是当用户单击`hover for popover`然后进行悬停时，`hover`属性工作得非常好请让我知道为什么它没有发生在页面加载事件中以及我该如何修复它以便用户不必单击按钮并显示任何内容在里面。

**注意：**可以通过以下方法轻松完成，但问题是元素的 ID 是动态生成的，因此我不能将以下方法用于特定的一个 ID。

```
$(function ()
{ $("#example").popover();
}); 
```

**JSFIDDLE：http:** [//jsfiddle.net/weuWk/323/](http://jsfiddle.net/weuWk/323/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:10:57.813

首先，为所有悬停元素添加一个类：

```
<span id="a1" class="btn large primary hoverable">Popover</span> 
```

然后，将弹出框添加到每个项目：

```
$(document).ready(function(){
    $('.hoverable').popover({title: "Hello"});
}); 
```

**编辑：**要引用`id`（或任何其他属性），您可以使用[`.attr()`](http://api.jquery.com/attr/)如下：

```
$(document).ready(function(){
    $('.hoverable').each(function(){
      $(this).popover({title: $(this).attr('id')});
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T15:09:26.153

我认为问题在于您在`popover()`正确加载文档之前调用该函数，然后`$('#a1')`在您的示例之前可以匹配任何内容。

在此处检查您更新的 jsfiddle：http: [//jsfiddle.net/weuWk/325/](http://jsfiddle.net/weuWk/325/) 只有当您的文档准备好时，您才需要调用 popover：

```
$(document).ready(function() {
    $('#a1').popover({title: "Hello"});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:12:59.013

修复[http://jsfiddle.net/pieterwillaert/weuWk/327/](http://jsfiddle.net/pieterwillaert/weuWk/327/)

您所做的是以下内容：

*   加载文档时，您遍历所有按钮（我通过使用`'span'`您也可以轻松更改`'.button'`）
*   你给每个按钮一个弹出框

    ```
    $(document).ready(function() {

        $('span').each(function(index) {
             $(this).popover({title: "Hello"});
        });

    });​ 
    ```

# c# - 为什么 IDbDataParameter 使用 2001 年而不是 0001 年更新 Access DateTime 字段？

> ID：13765672
> 
> 赞同：0
> 
> 时间：2012-12-07T15:05:05.023
> 
> 标签：c#, ms-access, datetime, dbtype

为什么 IDbDataParameter 用 2001 年而不是 0001 年更新 MS Access DateTime 字段？我正在使用 IDbDataParameter。它适用于 SQL 服务器，但不适用于 MS Access。我以为我之前测试过这个...

```
IDbDataParameter dp;
var dbType = GetDatabaseType(Cmd.Connection);
for (int n = 0; n < Parameters.Length; n++)
{
var param = Parameters[n];
dp = Cmd.CreateParameter();
dp.ParameterName = paramNames[n];
TypeCode myTypeCode = Type.GetTypeCode(param.GetType());
if (myTypeCode == TypeCode.DateTime)     // this workaround is needed for MS Access and SQL Server
{
  if (dbType == DatabaseType.OleDb)
    dp.DbType = DbType.DateTime;         // set dates as DbType.DateTime for MS Access and Paradox
  else if (dbType == DatabaseType.MSSql)
    dp.DbType = DbType.DateTime2;        // set dates as DbType.DateTime2 for SQL Server
  dp.Value = param.ToString();
}
else
  dp.Value = param;
Cmd.Parameters.Add(dp); 
```

**Update1** 在 Access 中设置 DateTime 时有时也会出现错误的时间（OleDb 连接 > IDbConnection > IDbCommand）

10 秒另存为：2001-01-01 00:28:32 // dp.Value = param.ToString();

如果您格式化字符串，它也会保存为 2001，现在使用中午 12:00：2001-01-01 12:00:46 // dp.Value = ConvertToDateTime(param).ToString("yyyy-MM-dd hh:mm :ss");

**更新2**

```
/* Tests when executing insert and update queries against MS Access (OleDb Jet) and DateTime field using value of '0001-01-01 00:00:00'.
  * DateTime d = Convert.ToDateTime(param);
  * dp.Value = new DateTime(d.Year, d.Month, d.Day, d.Hour, d.Minute, d.Second); // Insert/Update = 2001-01-01
  * dp.Value = Convert.ToDateTime(param).ToString("yyyy-MM-dd hh:mm:ss");        // Insert/Update = 2001-01-01 00:00:00
  * dp.Value = param.ToString();                 // Insert/Update = 2001-01-01
  * dp.Value = Convert.ToDateTime(param);        // Insert/Update = 2001-01-01
  * dp.Value = param;                            // Insert/Update = 2001-01-01
  * dp.Value = new DateTime(1, 1, 1, 0, 0, 0);   // Insert/Update = 2001-01-01
  */

/* Tests when executing query against MS Access (OleDb Jet) and DateTime field using value of '2010-10-10 10:10:10'.
  * DateTime d = Convert.ToDateTime(param);
  * dp.Value = new DateTime(d.Year, d.Month, d.Day, d.Hour, d.Minute, d.Second); // Insert/Update = 2010-10-10 10:10:10
  * dp.Value = Convert.ToDateTime(param).ToString("yyyy-MM-dd hh:mm:ss");        // Insert/Update = 2010-10-10 10:10:10
  * dp.Value = param.ToString();                 // Insert/Update = 2010-10-10 10:10:10
  * dp.Value = Convert.ToDateTime(param);        // Insert/Update = 2010-10-10 10:10:10
  * dp.Value = param;                            // Insert/Update = 2010-10-10 10:10:10
  * dp.Value = new DateTime(2010, 10, 10, 10, 10, 10);   // Insert/Update = 2010-10-10 10:10:10
  */ 
```

# push-notification - 如何向多个设备（iOS）发送推送通知？

> ID：13765673
> 
> 赞同：2
> 
> 时间：2012-12-07T15:05:05.217
> 
> 标签：push-notification, apple-push-notifications, pushsharp

我正在尝试优化服务器上​​的推送通知。现在我一个一个地发送这些（带有一个旧图书馆），这需要一段时间（4小时）。

我重构了我的服务以发送带有大量设备令牌的通知（现在我尝试批量处理 500 个令牌）。为此，我正在使用[Redth/PushSharp](https://github.com/Redth/PushSharp)库。我按照[示例代码](https://github.com/Redth/PushSharp/blob/master/PushSharp.Sample/Program.cs)进行了修改，然后将其调整为将通知发送到多个设备令牌。

```
PushService service = new PushService();

//Wire up the events
service.Events.OnDeviceSubscriptionExpired += new PushSharp.Common.ChannelEvents.DeviceSubscriptionExpired(Events_OnDeviceSubscriptionExpired);
service.Events.OnDeviceSubscriptionIdChanged += new PushSharp.Common.ChannelEvents.DeviceSubscriptionIdChanged(Events_OnDeviceSubscriptionIdChanged);
service.Events.OnChannelException += new PushSharp.Common.ChannelEvents.ChannelExceptionDelegate(Events_OnChannelException);
service.Events.OnNotificationSendFailure += new PushSharp.Common.ChannelEvents.NotificationSendFailureDelegate(Events_OnNotificationSendFailure);
service.Events.OnNotificationSent += new PushSharp.Common.ChannelEvents.NotificationSentDelegate(Events_OnNotificationSent);
service.Events.OnChannelCreated += new PushSharp.Common.ChannelEvents.ChannelCreatedDelegate(Events_OnChannelCreated);
service.Events.OnChannelDestroyed += new PushSharp.Common.ChannelEvents.ChannelDestroyedDelegate(Events_OnChannelDestroyed);

//Configure and start ApplePushNotificationService
string p12Filename = ...
string p12FilePassword = ...

var appleCert = File.ReadAllBytes(p12Filename);

service.StartApplePushService(new ApplePushChannelSettings(true, appleCert, p12FilePassword));

var appleNotification = NotificationFactory.Apple();

foreach (var itemToProcess in itemsToProcess)
{
    itemToProcess.NotificationDateTime = DateTime.Now;
    mobile.SubmitChanges();

    string deviceToken = GetCleanDeviceToken(itemToProcess.MobileDevice.PushNotificationIdentifier);
    appleNotification.ForDeviceToken(deviceToken);
}

service.QueueNotification(appleNotification
    .WithAlert(itemsToProcess[0].MobileDeviceNotificationText.Text)
    .WithSound("default")
    .WithBadge(0)
    .WithCustomItem("View", itemsToProcess[0].Value.ToString()));

//Stop and wait for the queues to drains
service.StopAllServices(true); 
```

然后我尝试向 2 个设备发送 3 个通知。只有第一个设备得到了它们（问题与设备无关，因为我分别尝试了它们）。紧接着在[PushChannelBase 类](https://github.com/Redth/PushSharp/blob/master/PushSharp.Common/PushChannelBase.cs)中引发 OperationCanceledException 。所以我不知道怎么了。任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T14:51:36.230

您应该为每个要处理的项目排队单独的通知。
无法在单个通知上设置多个设备令牌。OperationCanceledException 将发生，因为您这样做了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T08:41:57.473

**示例：控制台 C# 应用程序**

这假设

1.  您有有效的生产和开发证书
2.  您在数据库中存储了多个设备令牌
3.  你有一个来自你的数据库的通知
4.  您正在使用[PushSharp](https://www.nuget.org/packages/PushSharp/)库

    ```
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using PushSharp;
    using PushSharp.Core;
    using PushSharp.Apple;
    using System.IO;

    namespace MyNotification
    {
        class Program
        {
            //args may take "true" or "false" to indicate the app is running for
            //development or production (Default = false which means Development)
            static void Main(string[] args)
            {
                bool isProduction = false;
                if (args != null && args.Length == 1)
                {
                    Console.Write(args[0] + Environment.NewLine);
                    bool.TryParse(args[0], out isProduction);
                }
                try
                {
                    //Gets a notification that needs sending from database
                    AppNotification notification = AppNotification.GetNotification();
                    if (notification != null && notification.ID > 0)
                    {          
                        //Gets all devices to send the above notification to         
                        List<IosDevice> devices = IosDevice.GetDevices(!isProduction);
                        if (devices != null && devices.Count > 0)
                        {
                            PushBroker push = new PushBroker();//a single instance per app
                            //Wire up the events for all the services that the broker registers
                            push.OnNotificationSent += NotificationSent;
                            push.OnChannelException += ChannelException;
                            push.OnServiceException += ServiceException;
                            push.OnNotificationFailed += NotificationFailed;
                            push.OnDeviceSubscriptionExpired += DeviceSubscriptionExpired;
                            push.OnChannelCreated += ChannelCreated;
                            push.OnChannelDestroyed += ChannelDestroyed;
                            //make sure your certifcates path are all good  
                            string apnsCertFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "../../Certificate/Certificates_Apple_Push_Production.p12");
                            if (!isProduction)
                                apnsCertFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "../../Certificate/Certificates_Apple_Push_Development.p12");
                            var appleCert = File.ReadAllBytes(apnsCertFile);
                            push.RegisterAppleService(new ApplePushChannelSettings(isProduction, appleCert, "135TrID35")); //Extension method

                            foreach (IosDevice device in devices)
                            {
                                //if it is required to send additional information as well as the alert message, uncomment objects[] and WithCustomItem 
                                //object[] obj = { "North", "5" };

                                push.QueueNotification(new AppleNotification()
                               .ForDeviceToken(device.DeviceToken)
                               .WithAlert(DateTime.Now.ToString())//(notification.AlertMessage)
                                    //.WithCustomItem("Link", obj)
                               .WithBadge(device.BadgeCount + 1)
                               .WithSound(notification.SoundFile));//sound.caf
                            }
                            push.StopAllServices(waitForQueuesToFinish: true);
                        }
                    }
                    Console.WriteLine("Queue Finished, press return to exit...");
                    Console.ReadLine();
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                    Console.ReadLine();
                }
            }

            static void NotificationSent(object sender, INotification notification)
            {
                Console.WriteLine("Sent: " + sender + " -> " + notification);
            }

            static void NotificationFailed(object sender, INotification notification, Exception notificationFailureException)
            {
                Console.WriteLine("Failure: " + sender + " -> " + notificationFailureException.Message + " -> " + notification);
            }

            static void ChannelException(object sender, IPushChannel channel, Exception exception)
            {
                Console.WriteLine("Channel Exception: " + sender + " -> " + exception);
            }

            static void ServiceException(object sender, Exception exception)
            {
                Console.WriteLine("Service Exception: " + sender + " -> " + exception);
            }

            static void DeviceSubscriptionExpired(object sender, string expiredDeviceSubscriptionId, DateTime timestamp, INotification notification)
            {
                Console.WriteLine("Device Subscription Expired: " + sender + " -> " + expiredDeviceSubscriptionId);
            }

            static void ChannelDestroyed(object sender)
            {
                Console.WriteLine("Channel Destroyed for: " + sender);
            }

            static void ChannelCreated(object sender, IPushChannel pushChannel)
            {
                Console.WriteLine("Channel Created for: " + sender);
            }  
        }

    } 
    ```

# c# - 从 DataGridViewComboBoxColumn 为 DataGridView 的源的基础属性赋值

> ID：13765674
> 
> 赞同：1
> 
> 时间：2012-12-07T15:05:07.633
> 
> 标签：c#, datagridview, datagridviewcombobox

我有一个分配给 CustomerPricing 的 BindingList 的 datagridview，在 CustomerPricing 中有诸如产品名称、价格、所需数量以及该项目是否应纳税等字段。在 datagridview 中，我有一个 DataGridViewComboBoxColumn，它的数据源是一个产品列表。产品具有名称、价格以及是否应纳税的字段。

客户的愿望是，一旦选择了产品，价格值会自动显示在 DataGridView 中，并且从开发人员的角度来看，Taxable 属性也会更新（不会显示）。

有谁知道如何做到这一点？我尝试使用 EditControlShowing 事件并将值直接分配给单元格，但这无助于更新未显示的基础对象的属性。我做了一个 hack，它可以工作，但速度很慢，只有在没有更可接受的方式时才愿意使用。

谢谢

# php - codeigniter xss 验证

> ID：13765675
> 
> 赞同：0
> 
> 时间：2012-12-07T15:05:11.143
> 
> 标签：php, codeigniter

在 CI用户[指南](http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html)中，它说“以下是所有可用准备功能的列表：”

**xss_clean** =*通过 XSS 过滤功能运行数据.....*

我的代码中的注释有我的问题。请阅读。

注意：对全局启用 xss 不感兴趣！！！

提前致谢

```
$this->form_validation->set_rules('select_language', 'Language', 'trim|required|xss_clean');

//Has this been cleaned above while validating and ready to be used or ...
$language = $this->input->post('text_fullname');

//... do I have to add true to run the data through the XSS filtering again myslef?
$language = $this->input->post('text_fullname', true); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:08:38.117

在您实际运行表单验证之前，不会过滤发布数据。

```
$this->form_validation->set_rules(
    'select_language',
    'Language',
    'trim|required|xss_clean'
);

// Unaltered $_POST input
$this->input->post('select_language');

$this->form_validation->run();

// Trimmed and xss_cleaned
$this->input->post('select_language'); 
```

另外：在我看来，xss 过滤在实际重要的地方使用更有意义，*输出*而不是输入。例如，如果 xss 过滤器在未来的版本中得到改进，您会想要利用它，对吗？*如果您只过滤输入，那么在您的输出上再次*运行 xss_clean 函数是不可能的，这违背了将其用作表单验证规则的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:11:56.500

正如其他答案所建议的，您需要先运行表单验证，但是！

你`$this->input->post('text_fullname')`不会被清理，因为你设置了验证规则`select_language`而不是`text_fullname`

# java - 休息服务不接受给定的帖子，尽管它被注释为多部分

> ID：13765676
> 
> 赞同：1
> 
> 时间：2012-12-07T15:05:12.330
> 
> 标签：java, rest, cxf, apache-httpclient-4.x

我有一个 apache cxf 休息服务，其中 on 方法需要接收图像和其他一些字符串数据。为此，我创建了一个这样的服务定义。

```
@Override
@POST
@Path("attach/{formId}/{instanceId}")
@Consumes("multipart/mixed")
@Produces("application/xml")
public UploadResult attach(@FormParam("username") @WebParam(name = "username") String user,
                           @FormParam("password") @WebParam(name = "password") String password,
                           @PathParam("formId") @WebParam(name = "formId") String formId,
                           @PathParam("instanceId") @WebParam(name = "instanceId") String instanceId,
                           @FormParam("group") @WebParam(name = "group") String group,
                           @FormParam("data") @WebParam(name = "data") byte[] data,
                           @FormParam("metadata") @WebParam(name = "metadata") byte[] metadata)
    throws PDProcessingException,
    PDSecurityException
{
    return svc.attach( user, password, formId, instanceId, group, data, metadata );
} 
```

现在我尝试对我的客户使用此方法，但它不起作用并返回 415 不受支持的媒体类型。我用 Wiztools.org RestClient 和一个测试客户端代码尝试了它，它调用了这样的方法

```
public static String attach(String username, String hashedpassword, String attachmentUri) {

    String retVal = "";
    HttpClient client = new DefaultHttpClient();
    HttpPost post = new HttpPost("http://192.168.101.27/pdxapi/service/rest/ClientApp/attach/DE_OJ_PDIX_TEST/SRSQS.0");
    try {
        String hashedPw = DigestFactory.calculatePasswordHash(hashedpassword);

        File file = new File(attachmentUri);
        if (file == null || !file.exists()){
            throw new RuntimeException("there is no file " + attachmentUri);
        }
        MultipartEntity entity = new MultipartEntity();
        entity.addPart("username", new StringBody(username));
        entity.addPart("password", new StringBody(hashedPw));
        FileBody fileBody = new FileBody(file,"image/jpeg");
        entity.addPart("data",fileBody);

        post.setEntity(entity);
        HttpResponse response = client.execute(post);
        if (response.getEntity() == null){

            retVal = "";                
        }
        else{
            BufferedReader rd = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
            StringBuffer sb = new StringBuffer();
            String line = "";
            while ((line = rd.readLine()) != null) {
                sb.append(line);
            }               
            retVal = sb.toString();             
        }

    } catch (IOException e) {
        System.out.print("exception " + e.getMessage());
    }
    return retVal;
} 
```

我也尝试了注释 @Consumes("multipart/form-data") 但结果相同。有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-22T08:06:12.550

[http://tacticalnuclearstrike.com/2010/01/using-multipartentity-in-android-applications/](http://tacticalnuclearstrike.com/2010/01/using-multipartentity-in-android-applications/) 将所需的 jar 文件添加到您的项目中

# linux - 我需要使用 Linux 几天。互联网上有免费的服务吗？

> ID：13765678
> 
> 赞同：0
> 
> 时间：2012-12-07T15:05:20.253
> 
> 标签：linux, service, virtual-machine, shared

我想知道是否有这样的服务，无论是免费的还是非常便宜的，我可以在其中使用 Linux 机器几天来安装和运行 2 个程序。我真正需要的是使用仅在 Linux 上运行的 Valgrind 调试器调试我的 ANSI C 应用程序，由于各种原因我现在无法访问它。

所以我需要的是：

1.  能够使用 gcc 编译/安装 valgrind 和我的 prog
2.  运行 valgrind 和我的 prog
3.  ftp/sftp，或任何其他方法，只要我可以在机器上发送或下载文件

我想通过 sourceforge 来做，但我的软件对人类没有任何用处，它是用于科学研究，做一些数学计算......

也许你们中的任何人都知道这种服务？或者知道我可以偶尔在哪里使用 Linux 机器？

请让我知道谢谢格言

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:10:09.333

您可以在亚马逊的基础设施上免费设置一个 Ubuntu 微型实例：http: [//aws.amazon.com/free/](http://aws.amazon.com/free/)

但实际上，我更愿意建议您自己安装 Linux，您甚至可以在 USB 记忆棒（随身碟）上安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:12:04.160

AWS 微型实例在我看来是免费的一年。问题是它们是否足以满足您的需求，但除此之外，如果您只需要几天时间，也许按小时付费的实例也足够便宜。

另一种选择是在虚拟机或物理机中运行 LiveCD，然后从那里执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T18:45:14.390

假设您使用的是 Windows，您可以免费下载 VMware Player。

[http://www.vmware.com/products/player/](http://www.vmware.com/products/player/)

然后下载您想要使用的任何 Linux 发行版 ISO 映像并在 VMware Player 中打开它。它将像您在机器上安装 Linux 一样运行。

如果您使用的是 Mac，那我就不合适了，但我想在 Mac 在 Linux 上运行之前有人告诉我，所以我认为您可以打开一个终端并运行/测试/开发您的程序。

# mysql - 同步本地和互联网数据库

> ID：13765680
> 
> 赞同：2
> 
> 时间：2012-12-07T15:05:26.630
> 
> 标签：mysql, synchronization

I have a PHP (CI + Fuel) app online for managing a few stores. The problem is that sometimes the stores lost the internet connection.

The system must be operational at all times so I need to have a copy of the db in a local server.

The question is, what is the easy way to sync the data between online server and local server?

My idea, when the internet server go off is work normaly in the local db and alson save all the insert and update querys in a table. Then when internet come back, run all the querys to sync.

# java - how to get/set frame position in vlcj?

> ID：13765681
> 
> 赞同：3
> 
> 时间：2012-12-07T15:05:25.770
> 
> 标签：java, vlcj

How to - 1.get the current frame position of an audio/video track ?? 2.how to go to a specific frame position of a track ?? using vlcj sdk . any code snippets would be highly appreciated !

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-04-25T15:18:20.227

实际上你可以用一点数学来做到这一点。这不是最干净的方式，但它很容易理解。

VLCj 允许您使用`.getLength()`. 但是，请注意，这会以毫秒为单位返回媒体的长度。此外，您可以使用`.getFPS()`.

所以现在你可以得到**总帧数**：

```
total_frames = .getFPS * .getLength() /1000; 
```

然后您可以使用`.getPosition()`以毫秒为单位找出**您当前的位置**，然后您可以将其转换为帧。这以百分比形式返回。

```
current_frame = .getPosition() * total_frames; 
```

现在，如果你想去**一个特定的框架**，让我们称之为`desired_frame`. 您可以使用`.setPosition()`其中的百分比。因此，您需要确定代表您要跳转到的帧的总数的百分比。

```
.setPosition((float)desired_frame/total_frames); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T13:31:55.507

VLCJ isn't really set up for this kind of frame by frame access directly - you can use `setTime()` and `getTime()` on the mediaplayer object, but that will return time from the beginning in milliseconds rather than the frame. Of course, if you know the frame rate it's then relatively trivial to convert from one to the other.

If you need lower level operations than VLCJ provides, then you may want to have a look at Xuggler.

# asp.net - CheckBox handling oncheck changed in ASP.net

> ID：13765683
> 
> 赞同：0
> 
> 时间：2012-12-07T15:05:36.583
> 
> 标签：asp.net, checkbox, event-handling

i had a DataList view which i add a check box in the Item Template

i want each item i select to increase some counter for examble once it's checked .. i used the following code to handle that ,but the event function is never accessed ?!

```
 protected void selectItemCheckBox_CheckedChanged(object sender, EventArgs e)
    {        
    int selected = 0;
    foreach (DataListItem i in DataList1.Items)
    {
        CheckBox chk = (CheckBox)i.FindControl("selectItemCheckBox");
        if (chk.Checked)
        {

            selected++;
        }
        selectedItemCount.Text = Convert.ToString(selected);
        }`
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:45:42.147

目前，您正在为每个选中的复选框循环遍历每个复选框，这效率低下，并且取决于您的其他代码，可能会造成麻烦。

你最好单独增加每个复选框。

```
...DataList...
<ItemTemplate>
    <asp:CheckBox id="selectItemCheckBox" runat="server"
        AutoPostBack="True"
        OnCheckedChanged="selectItemCheckBox_CheckedChanged" />
</ItemTemplate>
...DataList... 
```

*选中一个框后，使用发件人*更新该复选框的总数

 *```
protected void selectItemCheckBox_CheckedChanged(object sender, EventArgs e)
{
    // Parse the total selected items from the TextBox.
    // You may consider using a Label instead, or something non-editable like a hidden field
    int totalChecked;
    if (int.TryParse(selectedItemCount.Text, out totalChecked) = false)
        totalChecked = 0;

    // Get a reference to the CheckBox
    CheckBox selectItemCheckBox = (CheckBox)sender;

    // Increment the total
    if (selectItemCheckBox.Checked == true)
        totalChecked++;

    // Put back in the TextBox
    selectedItemCount.Text = totalChecked.ToString();
} 
```*

# sql - 找出时间范围内其他表中是否存在值

> ID：13765685
> 
> 赞同：0
> 
> 时间：2012-12-07T15:05:38.347
> 
> 标签：sql, oracle

我正在尝试评估用户的操作是否相对于另一个操作执行。这两个动作都标有时间戳。

我要评估的是，当用户在一个表中有一个条目时，例如`A`（两个表`ID`对单个用户都有相同的条目）在另一个表中是否有一个条目`B`，在输入时间`A`和 5 分钟前之间。我设法为所有值提取时间

```
SELECT 
  TO_CHAR(playdatetime - 5/(24*60),'YYYY-MM-DD HH24:MI:SS') five_min_future, 
  TO_CHAR(playdatetime,'YYYY-MM-DD HH24:MI:SS') jetzt, 
  TO_CHAR(SEARCHDATE,'YYYY-MM-DD HH24:MI:SS') ses_time 
```

我试图做这样的事情：

```
CASE 
  WHEN TO_CHAR(SEARCHDATE,'YYYY-MM-DD HH24:MI:SS') 
          BETWEEN TO_CHAR(playdatetime - 1/(24*60),'YYYY-MM-DD HH24:MI:SS') 
       AND 
       TO_CHAR(playdatetime,'YYYY-MM-DD HH24:MI:SS') 
  THEN 1 
  ELSE 0 
END timediff 
```

但是我怎样才能让它只检查一个用户而不仅仅是评估手头的行呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:19:13.807

以下查询显示同时存在于`a`和`b`中的记录，其中 in 的记录`b`出现在 5 分钟之前`a`：

```
select a.user_id,
       a.event_dt,
       b.event_dt
from   a
join   b
on     b.user_id  = a.user_id
and    b.event_dt between (a.event_dt - (5 / (60 * 24))) and a.event_dt; 
```

# google-maps-api-3 - 谷歌地图设置缩放控制栏从最小缩放开始

> ID：13765686
> 
> 赞同：0
> 
> 时间：2012-12-07T15:05:40.113
> 
> 标签：google-maps-api-3

我在网页中有一个谷歌地图，其中最小缩放设置为 7。我想将缩放控制栏设置为从 7 开始并且不显示较低的值。这可能吗？
我一直在寻找 API，但找不到任何有用的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:06:58.470

在地图初始化期间，设置此选项 -

```
minZoom:7 
```

这会将您的地图和缩放控制栏设置为 7 的缩放级别，并且您不能低于此级别。

# java - Eclipselink 多租户和租户层次结构（共享一些数据）

> ID：13765694
> 
> 赞同：0
> 
> 时间：2012-12-07T15:06:07.913
> 
> 标签：java, spring, struts, eclipselink, multi-tenant

我有兴趣将我的**Java+Struts+Spring+EclipseLink**应用程序与多租户一起使用，我做了一些示例来提供多租户，一切都很好。但...

我有一个可能出现这种情况的设备：

*   具有隔离数据和共享架构并使用单个表的租户 A、B、C。

*   租户 A 和 B 也可以看到来自租户 C 的数据。但租户 C 只能看到自己的数据，因为多租户正常工作。

一个真实的例子可能是一家具有不同部门的公司使用我的应用程序，但某些部门可以看到其他数据。

对于插入数据，我想我可以用它来管理我的代码，`@Multitenant(MultitenantType.SINGLE_TABLE)`但我不知道过滤器数据的部分是否可以用 eclipseLink 或我可以使用什么解决方案来管理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T15:46:27.310

您可能希望为每个租户使用不同的持久性单元，并为每个租户提供不同的配置。

您也可以不使用 @Multitenant 而是使用 @AdditionalCriteria 或应用程序逻辑。

# python - XPath：访问不是属性的东西

> ID：13765695
> 
> 赞同：0
> 
> 时间：2012-12-07T15:06:10.657
> 
> 标签：python, xml, xpath

我尝试使用 lxml 和 xpath 命令从以下代码段访问时间（07.12.2012 00:36 Uhr）。不幸的是，想要的信息不是属性。我可以使用哪个 xpath 来访问它？

我的片段：

```
{'class': 'artikeldiskussion-titel'}
<div class="artikeldiskussion-titel"><span id="posting-649631-titel"><b>So</b></span>

    <span id="an_id" style="position: absolute; visibility: hidden; z-index: 999;"    class="hint_grau">

    </span> <span class="anz-postings-user" title="759 Kommentare">(759)</span> &#183;           07.12.2012 00:36 Uhr
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:17:48.373

这是凌乱的html。

在没有看到更多样本的情况下，我会建议以下两种方法之一：

1.  抓取 div 中的最后一个文本节点：`/descendant::div[@class="artikeldiskussion-titel"]/child::text()[position()=last()]`
2.  在某个哨兵节点之后抓取文本节点：`/descendant::span[@class="anz-postings-user"]/following-sibling::text()[1]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:08:51.100

使用`text()`xpath 函数：

```
txt = tree.xpath('//path/to/span/text()') 
```

# sql-server-2008 - SQL Server 2008 - 程序结束运行时检索消息

> ID：13765696
> 
> 赞同：1
> 
> 时间：2012-12-07T15:06:12.060
> 
> 标签：sql-server-2008, stored-procedures

> **可能重复：**
> [如何在 SQLServer 上执行 SQL 脚本期间显示某些内容？](https://stackoverflow.com/questions/3700106/how-can-i-display-something-during-the-execution-of-a-sql-script-on-sqlserver)

我在同一个查询中运行了多个过程。我希望在每个程序完成运行时打印一条特定的消息。

我怎样才能做到这一点？

我试着做

```
PRINT 'message' 
```

在每个过程结束时，但它只是在所有消息都结束时同时打印所有消息。

# hibernate - 在特定查询上出现错误

> ID：13765698
> 
> 赞同：8
> 
> 时间：2012-12-07T15:06:28.150
> 
> 标签：hibernate, lucene, full-text-search, hibernate-search

Lucene 新手在这里。我在 java 客户端中将它与 Hibernate 一起使用，并且在特定查询中遇到此错误：

```
HSEARCH000146: The query string 'a' applied on field 'name' has no meaningfull tokens to  
be matched. Validate the query input against the Analyzer applied on this field. 
```

搜索适用于所有其他查询，即使结果集为空。我的测试数据库确实有这个带有“a”的记录。这里有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T17:26:25.503

'a' 是一个停用词，将被 StandardAnalyzer 从您的查询中过滤掉。停用词是在您搜索的语言中足够常见的词，并且被认为对生成搜索结果没有意义。这是一个简短的列表，但“a”是其中之一。

由于分析器已经删除了该术语，并且它是唯一存在的术语，因此您现在正在发送一个空查询，这是不可接受的，并且搜索失败。

对于好奇的人，这些是标准的 Lucene 英语停用词：

```
"a", "an", "and", "are", "as", "at", "be", "but", "by",
"for", "if", "in", "into", "is", "it",
"no", "not", "of", "on", "or", "such",
"that", "the", "their", "then", "there", "these",
"they", "this", "to", "was", "will", "with" 
```

* * *

如果您不想删除停用词，那么您应该设置您的`Analyzer`不带`StopFilter`, 或设置空停用词。在 的情况下`StandardAnalyzer`，您可以将自定义停止集传递[给构造函数](https://lucene.apache.org/core/4_10_0/analyzers-common/org/apache/lucene/analysis/standard/StandardAnalyzer.html#StandardAnalyzer(org.apache.lucene.analysis.util.CharArraySet))：

```
Analyzer analyzer = new StandardAnalyzer(CharArraySet.EMPTY_SET); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-30T03:40:45.167

你可以把

@Analyzer(impl=KeywordAnalyzer.class)

到你的领域来避免这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-13T12:59:27.027

# 建议的工作

@femtoRgon 已经解释了此错误的原因，当您尝试将用户输入标记为字符串列表然后将每个字符串输入 Hibernate 搜索查询时也会发生此问题。当你现在有一个停用词的字符串时，Hibernate 不知道如何处理这个字符串。

但是，您可以在将输入发送到 Hibernate Search 查询之前使用相同的分析器解析和验证输入。使用此方法，您可以从输入中提取相同的单词并避免错误，而无需更改为备用分析器类。

## 从您的实体类 MyModelClass.class 中检索当前分析器

```
FullTextEntityManager fullTextEntityManager = org.hibernate.search.jpa.Search
    .getFullTextEntityManager(entityManager);

QueryBuilder builder = fullTextEntityManager.getSearchFactory()
    .buildQueryBuilder().forEntity(MyModelClass.class).get();

Analyzer customAnalyzer = fullTextEntityManager.getSearchFactory()
    .getAnalyzer(MyModelClass.class); 
```

## 输入分词器

```
/**
 * Validate input against the tokenizer and return a list of terms.
 * @param analyzer
 * @param string
 * @return
 */
public static List<String> tokenizeString(Analyzer analyzer, String string)
{
    List<String> result = new ArrayList<String>();
    try
    {
        TokenStream stream = analyzer.tokenStream(null, new StringReader(string));
        stream.reset();
        while (stream.incrementToken())
        {
            result.add(stream.getAttribute(CharTermAttribute.class).toString());
        }
        stream.close();
    } catch (IOException e)
    {
        throw new RuntimeException(e);
    }
    return result;
} 
```

## 验证输入

现在您可以简单地通过同一个分析器运行您的输入字符串，并接收一个字符串列表，并像这样正确标记：

```
List<String> keywordsList = tokenizeString(customAnalyzer, "This is a sentence full of the evil stopwords); 
```

并会收到这份清单

```
[this, sentence, full, evil, stopwords] 
```

我的回答是基于[这个](https://stackoverflow.com/questions/2638200/how-to-get-a-token-from-a-lucene-tokenstream)和[这个](https://stackoverflow.com/questions/6334692/how-to-use-a-lucene-analyzer-to-tokenize-a-string)SO 帖子。

# c# - 如何获得子集的所有可能组合？

> ID：13765699
> 
> 赞同：3
> 
> 时间：2012-12-07T15:06:31.473
> 
> 标签：c#, algorithm, collections, matrix, combinations

考虑这个`List<string>`

```
List<string> data = new List<string>();
data.Add("Text1");
data.Add("Text2");
data.Add("Text3");
data.Add("Text4"); 
```

我遇到的问题是：如何获得列表子集的每个组合？有点像这样：

```
#Subset Dimension 4
Text1;Text2;Text3;Text4

#Subset Dimension 3
Text1;Text2;Text3;
Text1;Text2;Text4;
Text1;Text3;Text4;
Text2;Text3;Text4;

#Subset Dimension 2
Text1;Text2;
Text1;Text3;
Text1;Text4;
Text2;Text3;
Text2;Text4;

#Subset Dimension 1
Text1;
Text2;
Text3;
Text4; 
```

我想出了一个不错的解决方案，值得在这里分享。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:15:26.993

与 Abaco 的回答类似的逻辑，不同的实现......

```
foreach (var ss in data.SubSets_LB())
{
    Console.WriteLine(String.Join("; ",ss));
}

public static class SO_EXTENSIONS
{
    public static IEnumerable<IEnumerable<T>> SubSets_LB<T>(
      this IEnumerable<T> enumerable)
    {
        List<T> list = enumerable.ToList();
        ulong upper = (ulong)1 << list.Count;

        for (ulong i = 0; i < upper; i++)
        {
            List<T> l = new List<T>(list.Count);
            for (int j = 0; j < sizeof(ulong) * 8; j++)
            {
                if (((ulong)1 << j) >= upper) break;

                if (((i >> j) & 1) == 1)
                {
                    l.Add(list[j]);
                }
            }

            yield return l;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T19:39:56.163

我认为，这个问题的答案需要一些性能测试。我会试一试。这是*社区维基*，请随时更新。

```
void PerfTest()
{
    var list = Enumerable.Range(0, 21).ToList();

    var t1 = GetDurationInMs(list.SubSets_LB);
    var t2 = GetDurationInMs(list.SubSets_Jodrell2);
    var t3 = GetDurationInMs(() => list.CalcCombinations(20));

    Console.WriteLine("{0}\n{1}\n{2}", t1, t2, t3);
}

long GetDurationInMs(Func<IEnumerable<IEnumerable<int>>> fxn)
{
    fxn(); //JIT???
    var count = 0;

    var sw = Stopwatch.StartNew();
    foreach (var ss in fxn())
    {
        count = ss.Sum();
    }
    return sw.ElapsedMilliseconds;
} 
```

输出：

```
1281
1604 (_Jodrell not _Jodrell2)
6817 
```

**乔德雷尔的更新**

我已经建立了发布模式，即优化。当我通过 Visual Studio 运行时，我在 1 或 2 之间没有得到一致的偏差，但是在重复运行 LB 的答案获胜后，我得到的答案接近于，

```
1190
1260
more 
```

但是如果我从命令行而不是通过 Visual Studio 运行测试工具，我会得到更像这样的结果

```
987
879
still more 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T17:30:59.007

**编辑**

我已经接受了性能挑战，接下来是我的合并，它采用了所有答案中最好的方法。在我的测试中，它似乎有最好的性能。

```
public static IEnumerable<IEnumerable<T>> SubSets_Jodrell2<T>(
    this IEnumerable<T> source)
{
    var list = source.ToList();
    var limit = (ulong)(1 << list.Count);

    for (var i = limit; i > 0; i--)
    {
        yield return list.SubSet(i);
    }
}

private static IEnumerable<T> SubSet<T>(
    this IList<T> source, ulong bits)
{
    for (var i = 0; i < source.Count; i++)
    {
        if (((bits >> i) & 1) == 1)
        {
            yield return source[i];
        }
    }
} 
```

* * *

同样的想法，几乎与[LB的答案](https://stackoverflow.com/a/13765854/659190)相同，但我自己的解释。

我避免使用内部`List`和`Math.Pow`.

```
public static IEnumerable<IEnumerable<T>> SubSets_Jodrell(
    this IEnumerable<T> source)
{
    var count = source.Count();

    if (count > 64)
    {
        throw new OverflowException("Not Supported ...");
    }

    var limit = (ulong)(1 << count) - 2;

    for (var i = limit; i > 0; i--)
    {
        yield return source.SubSet(i);
    }
}

private static IEnumerable<T> SubSet<T>(
    this IEnumerable<T> source,
    ulong bits)
{
    var check = (ulong)1;
    foreach (var t in source)
    {
        if ((bits & check) > 0)
        {
            yield return t;
        }

        check <<= 1;
    }
} 
```

* * *

您会注意到，这些方法不适用于初始集合中超过 64 个元素，但无论如何它开始需要一段时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T15:06:31.473

我为列表开发了一个简单的 ExtensionMethod：

```
 /// <summary>
    /// Obtain all the combinations of the elements contained in a list
    /// </summary>
    /// <param name="subsetDimension">Subset Dimension</param>
    /// <returns>IEnumerable containing all the differents subsets</returns>
    public static IEnumerable<List<T>> CalcCombinations<T>(this List<T> list, int subsetDimension)
    {
        //First of all we will create a binary matrix. The dimension of a single row
        //must be the dimension of list 
        //on which we are working (we need a 0 or a 1 for every single element) so row
        //dimension is to obtain a row-length = list.count we have to
        //populate the matrix with the first 2^list.Count binary numbers
        int rowDimension = Convert.ToInt32(Math.Pow(2, list.Count));

        //Now we start counting! We will fill our matrix with every number from 1 
        //(0 is meaningless) to rowDimension
        //we are creating binary mask, hence the name
        List<int[]> combinationMasks = new List<int[]>();
        for (int i = 1; i < rowDimension; i++)
        {
            //I'll grab the binary rapresentation of the number
            string binaryString = Convert.ToString(i, 2);

            //I'll initialize an array of the apropriate dimension
            int[] mask = new int[list.Count];

            //Now, we have to convert our string in a array of 0 and 1, so first we 
            //obtain an array of int then we have to copy it inside our mask 
            //(which have the appropriate dimension), the Reverse()
            //is used because of the behaviour of CopyTo()
            binaryString.Select(x => x == '0' ? 0 : 1).Reverse().ToArray().CopyTo(mask, 0);

            //Why should we keep masks of a dimension which isn't the one of the subset?
            // We have to filter it then!
            if (mask.Sum() == subsetDimension) combinationMasks.Add(mask);
        }

        //And now we apply the matrix to our list
        foreach (int[] mask in combinationMasks)
        {
            List<T> temporaryList = new List<T>(list);

            //Executes the cycle in reverse order to avoid index out of bound
            for (int iter = mask.Length - 1; iter >= 0; iter--)
            {
                //Whenever a 0 is found the correspondent item is removed from the list
                if (mask[iter] == 0)
                    temporaryList.RemoveAt(iter);
            }
            yield return temporaryList;
        }
    }
} 
```

因此，考虑问题中的示例：

```
# Row Dimension of 4 (list.Count)
Binary Numbers to 2^4

# Binary Matrix
0 0 0 1 => skip
0 0 1 0 => skip
[...]
0 1 1 1 => added // Text2;Text3;Text4
[...]
1 0 1 1 => added // Text1;Text3;Text4
1 1 0 0 => skip
1 1 0 1 => added // Text1;Text2;Text4
1 1 1 0 => added // Text1;Text2;Text3
1 1 1 1 => skip 
```

希望这可以帮助某人:)

如果您需要澄清或想要贡献，请随时添加答案或评论（哪个更合适）。

# c# - 导出期间验证某些 XML 模式的自定义工具警告错误

> ID：13765702
> 
> 赞同：0
> 
> 时间：2012-12-07T15:06:38.740
> 
> 标签：c#, php, soap, types, wsdl

我有一个我想使用的由 PHP 和 SOAP 驱动的 Web 服务。我可以很好地添加 Web 服务，并在添加时获得方法列表（添加时使用添加服务引用）。但现在我得到一个错误：

> 警告 1 自定义工具警告：验证导出期间生成的某些 XML 模式时出错：未声明类型“http://www.w3.org/2001/XMLSchema:struct”。localPATH:Reference.svcmap 1 1 SOAP_Webservice_Test

据我了解，这是由于我的 PHP Soap API 中有一种特定类型。我已经用谷歌搜索了，但没有一个提到的修复对我有用。

任何建议如何继续我的调试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:38:33.307

关闭它是因为问题不在客户端，而是在我试图引用的肥皂服务器中。

# jquery - 在 jqgrid 上显示 json 数据和格式化的麻烦

> ID：13765715
> 
> 赞同：0
> 
> 时间：2012-12-07T15:07:28.040
> 
> 标签：jquery, jqgrid

我有一个问题，我需要在 jqgrid 上显示 json 数据。我得到的数据格式如下：

```
{"data":{"data":"\tat org.aaa.aaa.aaa.aaa.aaa.aaa(aaa.java:512)[147:org.aaa.aaa.aaa:9.1.1]\n\tat aaa.aaa.aaa.aaa.aaa.aaa(aaa.java:1789)[146:org.aaa:9.1.1]\n"}} 
```

我显示数据的 javascript 是：

```
 $("#grid").jqGrid({
  url: '/getdata',
      datatype: "json",
  mtype: "GET",
  colNames:['data'],
  colModel:[
     {name:'data', index:'data', align:'center'}
  ],
   jsonReader : {
          repeatitems: false,
      id: "0",
      cell: "",
       root: "logs",
      page: function() { return 1; },
      total: function() { return 1; },
      records: function(obj) { return obj.length; }
    },
   loadonce: true,      
   viewrecords: true,
   autowidth: true,
   multiselect: false,
   ignoreCase: true,
   sortable: true,
   height: 600, 
   rowNum: 999
 }); 
```

我尝试了几种组合，但无法使用此代码将数据显示在 jqgrid 上。jqgrid 显示一个空表。我想我在这里遗漏了一些东西。

我还必须格式化数据，以便每次点击“\n”时，我们都会在新行中显示它。我想我可以在列的格式化程序中使用“addrowdata”来做到这一点。是对的吗？

非常感谢任何指针。

谢谢，

阿莎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:04:28.157

我不建议您使用`addRowData`. `beforeProcessing`用于将服务器返回的数据修改为jqGrid可以读取的格式更有效。例如，您可以拆分`data.data`部分`\n`并填充相应项目的数组：

```
autoencode: true,
beforeProcessing: function (data) {
    var items = data.data.data.split("\n"), i, l, item;
    data.logs = [];
    for (i = 0, l = items.length; i < l; i++) {
        item = $.trim(items[i]);
        if (item.length > 0) {
            data.logs.push([item]);
        }
    }
} 
```

我在上面的代码中包含了对[jQuery.trim](http://api.jquery.com/jQuery.trim/)的调用，以删除每行开头或结尾处不需要的`\t`或其他空白字符。

我还包括了额外`autoencode: true`的选项，严格建议确保包含 HTML 特殊字符（如`<`、`>`等`&`）的文本将正确显示在网格内。

此外，您应该更改`jsonReader`为例如以下

```
jsonReader: {
    root: "logs",
    cell: "",
    id: function () {
        return function () {
            return $.jgrid.randId();
        }
    },
    page: function() { return 1; },
    total: function() { return 1; },
    records: function(obj) { return obj.logs.length; }
} 
```

的值看起来很棘手，但实现会为每一行`id`的属性生成真正唯一的值。`id`

[您可以在此处](http://www.ok-soft-gmbh.com/jqGrid/Asha.htm)找到相应的演示。

# mysql - MySQL 有什么更好的方法来加速一个具有数百万行的表或管理多个表？

> ID：13765716
> 
> 赞同：1
> 
> 时间：2012-12-07T15:07:28.023
> 
> 标签：mysql, sql, database, performance

我正在处理一个现有的 PHP/MySql/JS/Ajax Web 应用程序，它为用户处理大量的表行。这是页面当前的工作方式。

1.  用户上传 LARGE csv 文件。我正在使用的测试有 400,000 行（每行有 5 列）。
2.  php 为这些数据创建了一个全新的表并插入了数十万行。
3.  然后页面以有用的方式对这些数据进行排序/处理/显示给用户。处理包括搜索、按日期和其他行排序并重新显示它们而无需大量加载时间（这就是 JS/Ajax 的用武之地）。

我的问题是这个应用程序应该为每次上传将数据放入一个新表中，还是将每个文件的 id 放入一个大表中？我认为原始开发人员出于速度目的添加了单独的表格。速度对此非常重要。

有更快的方法吗？有没有更好的捕鼠器？有没有人对此感到厌烦？

请记住，每个 .csv 可以包含数十万行，并且每天可以上传数百个 .csv 文件。虽然它们可以在最后一次使用后大约 24 小时被删除（我在想 cron 工作有什么意见吗？）

谢谢你们！

基于评论的一些注释：

*   所有数据对于每个用户都是唯一的并且会发生变化，因此用户不会在几个小时后重新访问这些数据。只有当他们不小心关闭窗口然后又回来时，他们才会真正重新访问相同的 .csv。
*   不需要外键所有 csv 对每个用户都是私有的，不需要交叉引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:13:24.447

给定每天 10 ⁵行和 10 ² CSV，您每天查看 1000 万行（并且您说您会定期清除这些数据）。对于一个体面的数据库来说，这看起来并不可怕（特别是考虑到您可以在表内而不是跨多个表进行索引）。

显然，最常用的 CSV 可以很容易地保存在内存中以提高访问速度 - 甚至可能是所有这些（如果您每超过 24 小时刷新一次，基于几乎没有数据的非常简单的计算给我一个 1Gb 的数字。1Gb 是这些天不是不合理的内存量）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T15:13:32.493

出于无法更改数据结构的简单原因，我会回避将所有数据放入单个表中。

由于无论如何都会删除数据，并且您不需要组合来自不同负载的数据，因此没有明显的理由将数据放入单个表中。另一个论点是应用程序现在可以工作。您真的想在完成工作*后*发现一些需要单独表格的要求吗？

如果您确实决定使用单个表，则使用表分区。由于每个用户都在使用自己的数据，因此可以使用分区将每个用户加载到单独的分区中。虽然对分区有限制（比如没有外键），但这会让访问单个表中的数据和访问原始数据一样快。

# mysql - 休眠条件查询中的问题

> ID：13765718
> 
> 赞同：0
> 
> 时间：2012-12-07T15:07:40.703
> 
> 标签：mysql, database, hibernate

我在休眠条件查询中遇到问题我的 Pojo 映射如下

```
@Entity
@Table(name = "wsc_taheader")
public class TraceableActivityHeader{
@OneToMany(cascade = { CascadeType.ALL }, fetch  = FetchType.EAGER)
@JoinColumn(name = "taid")
@BatchSize(size=15)
private List<TraceableActivityStep> steps = new ArrayList<TraceableActivityStep>();
@Id
@Column(name = "taid")
public String taId;

}

@Entity
@Table(name = "wsc_tastep")
public class TraceableActivityStep implements BindObject {

private static final long serialVersionUID = 1L;

@ManyToOne
@JoinColumn(name = "taid", insertable = false, updatable = false, nullable = false)
private TraceableActivityHeader taHeader;
@Id
@GeneratedValue
@Column(name = "stepid")
private long stepId;
} 
```

在上面映射我在数据库中的数据就像

```
wsc_taheader
taId
1
2

wsc_tastep
stepId taId stepName
 1      1   BalanceQuery
 2      2   FundTransfer 1
 3      2   FundTransfer 2 
```

在上面的映射中，我创建了条件查询

```
public    List<TraceableActivityHeader>searchTAHeaderByExampleCriteria(TraceableActivityHeader exampleTAHeader) {
    List<Criterion> externalCriteria=new ArrayList<Criterion>();
    Criteria criteria = getCriteriaForExampleSearch(exampleTAHeader,  externalCriteria);
    return criteria.list();
    }
protected Criteria getCriteriaForExampleSearch(Object exampleObject,
        List externalCriteria) {
    Example example = Example.create(exampleObject).enableLike(
            MatchMode.ANYWHERE).ignoreCase();
    return getCriteriaForExampleSearch(example, exampleObject.getClass(),
            externalCriteria, new DefaultPropertySelector());
}
protected Criteria getCriteriaForExampleSearch(Example example,
        Class exampleClass, List<Criterion> externalCriteria,
        PropertySelector propertySelector) {

    Criteria criteria = getSession().createCriteria(exampleClass);
    criteria.add(example);

    criteria.add(example.setPropertySelector(propertySelector));
    if (externalCriteria != null && !externalCriteria.isEmpty()) {
        for (Iterator<Criterion> iter = externalCriteria.iterator(); iter.hasNext();) {
            Criterion element = iter.next();
            criteria.add(element);
        }
    }
    return criteria; 
```

}

但 searchTAHeaderByExampleCriteria() 返回的结果是

```
List<TraceableActivityHeader> list = traceableActivityManager
            .searchTAHeaderByExampleCriteria(traceableActivityHeader);
list.size is 3 which should be 2 
```

数据就像

```
1\. list.get(0) with TraceableActivityHeader
                taId=1
                    steps
                        taId=1 stepId=2
2\. list.get(1) with TraceableActivityHeader
                taId=2
                    steps
                        taId=2 stepId=1
                        taId=2 stepId=2

3\. list.get(2) with TraceableActivityHeader
                taId=2
                    steps
                        taId=2 stepId=1
                        taId=2 stepId=2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:33:53.923

通过设置处理查询结果的策略，我能够解决问题

```
criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY); 
```

# c# - WCF 基本 WinForm 应用程序通信问题

> ID：13765722
> 
> 赞同：0
> 
> 时间：2012-12-07T15:07:54.670
> 
> 标签：c#, .net, wcf

总而言之，我已经扩展[了本教程](http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication)以获取和反转显示在两个单独的 WinForm 应用程序中的字符串。但是，最终目标是让这种工作在 WinForm 应用程序之间运行，这些应用程序在彼此之间传递 SQL。为了方便起见，我扩展了这个例子，以下是我所拥有的

一个库 .dll 包含

```
public class WcfInterface
{
    private static WcfInterface instance;
    private ServiceHost host;
    private const string serviceEnd = "Done";

    protected WcfInterface()
    {
    }

    public static WcfInterface Instance()
    {
        if (instance == null)
            instance = new WcfInterface();
        return instance;
    }

    public void OpenServiceHost<T, U>() 
    {
        host = new ServiceHost(typeof(U), new Uri[] { new Uri("net.pipe://localhost") });
        host.AddServiceEndpoint(typeof(T), new NetNamedPipeBinding(), serviceEnd);
        host.Open();
    }

    public void CloseServiceHost<T>()
    {
        host.Close();
    }

    public T AddListnerToServiceHost<T>()
    {
        ChannelFactory<T> pipeFactory = 
            new ChannelFactory<T>(new NetNamedPipeBinding(), 
                                         new EndpointAddress(String.Format("net.pipe://localhost/{0}", 
                                                                                      serviceEnd)));
        T pipeProxy = pipeFactory.CreateChannel();
        return pipeProxy;
    }
} 
```

所以在“服务器”表单上，我做

```
private void Form1_Load(object sender, EventArgs e)
{
    List<string> sqlList = new List<string>();
    foreach (string line in this.richTextBoxSql.Lines)
        sqlList.Add(line);
    SqlInfo sqlInfo = new SqlInfo(sqlList);
    WcfInterface wcfInterface = WcfInterface.Instance();
    wcfInterface.OpenServiceHost<ISqlListing, SqlInfo>();
} 
```

在哪里

```
public class SqlInfo : ISqlListing
{
    private List<string> sqlList;
    public SqlInfo(List<string> sqlList)
    {
        this.sqlList = sqlList;
    }

    public List<string> PullSql()
    {
        return sqlList;
    }
}

[ServiceContract]
public interface ISqlListing
{
    [OperationContract]
    List<string> PullSql();
} 
```

在客户端 WinForm 应用程序中

```
private ISqlListing pipeProxy;
public Form1()
{
    InitializeComponent();
    WcfInterface wcfInterface = WcfInterface.Instance();
    pipeProxy = wcfInterface.AddListnerToServiceHost<ISqlListing>();
} 
```

在点击事件中，我尝试`List<string>`从服务器获取

```
private void button1_Click(object sender, EventArgs e)
{
    this.richTextBoxSql.Text = pipeProxy.PullSql().ToString(); // Code hangs here.
} 
```

我的问题是这有什么问题？

谢谢你的时间。

* * *

***编辑。我现在也根据评论更改了客户端代码如下***

```
private ISqlListing pipeProxy { get; set; }
private const string serviceEnd = "Done";

public Form1()
{
    InitializeComponent();
}

private void button1_Click(object sender, EventArgs e)
{
    this.richTextBoxSql.Text = pipeProxy.PullSql().ToString(); 
 }

private void Form1_Load(object sender, EventArgs e)
{
    ChannelFactory<ISqlListing> pipeFactory =
    new ChannelFactory<ISqlListing>(
      new NetNamedPipeBinding(),
      new EndpointAddress(
         String.Format("net.pipe://localhost/{0}", serviceEnd)));

    pipeProxy = pipeFactory.CreateChannel();
} 
```

***这也挂在点击事件上。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:19:22.900

您设置代码的方式是通过引用 WcfInterface.Instance 在客户端上创建 WCF 服务器。然后，您从为其提供服务的同一线程调用它，从而导致您的应用程序锁定。

有很多方法可以解决这个问题。以下是一些我想到的：

*   让服务在您的第一个 WinForm 应用程序中运行，然后使用 Visual Studio 中的“添加服务引用”功能来创建您的代理。请注意，您必须
*   您仍然可以为 WCF 合同引用一个公共库，但重新编写您的代码，这样您就不会在您的“客户端”WinForms 应用程序中创建服务的实例。

# android - java.lang.IllegalStateException：尝试重新打开一个已经关闭的对象：SQLiteQuery：SELECT * FROM pets

> ID：13765724
> 
> 赞同：0
> 
> 时间：2012-12-07T15:07:58.803
> 
> 标签：android, sqlite, exception, cursor

我的申请中有错误。

我是为Android制作应用程序的新手，所以我现在不知道出了什么问题...

这是在日志中：

```
java.lang.IllegalStateException: attempt to re-open an already-closed object: SQLiteQuery: SELECT * FROM pets 
```

我有一个 SQLite 数据库，其中是这种方法：

```
public List<Pet> getAllPets() {
    List<Pet> petList = new ArrayList<Pet>();
    String selectQuery = "SELECT * FROM " + TABLE_PETS;

    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);

    if (cursor.moveToFirst()) {
        do {
            Pet pet = new Pet();
            pet.setID(Integer.parseInt(cursor.getString(0)));
            pet.setName(cursor.getString(1));
            pet.setAge(cursor.getString(2));
            petList.add(pet);
        } while (cursor.moveToNext());
    }
    return petList;     
} 
```

然后我在其他活动中使用数据库中的这个方法来用每只宠物的名字填充 ListView....

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_list);
    PetListView = (ListView)findViewById(R.id.list);

    MyDatabaseHelper db = new MyDatabaseHelper(this);
    String [] items = new String[db.getPetsCount()];

    List<Pet> pets = db.getAllPets();
    for (int i = 0; i < db.getPetsCount(); i++) {
        items[i] = pets.get(i).getName();                   
    }
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.activity_list_item, items);
    PetListView.setAdapter(adapter);
} 
```

当此活动启动时，应用程序崩溃了..

拜托，你能告诉我穿的是什么吗？我该如何解决？非常感谢您的帮助。

编辑：

getPetsCount() 方法：

```
public int getPetsCount() {
    String countQuery = "SELECT * FROM " + TABLE_PETS;
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(countQuery, null);
    cursor.close();

    return cursor.getCount();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T17:24:21.060

最后我通过替换 getPetsCount 方法自己解决了这个问题：

```
public int getPetsCount() {
    String countQuery = "SELECT * FROM " + TABLE_PETS;
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(countQuery, null);
    int count = cursor.getCount();
    cursor.close();
    db.close();
    return count; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:09:59.583

首先，您应该在完成使用后关闭光标（这可能会解决您的问题）

```
public List<Pet> getAllPets() {
List<Pet> petList = new ArrayList<Pet>();
String selectQuery = "SELECT * FROM " + TABLE_PETS;

SQLiteDatabase db = this.getWritableDatabase();
Cursor cursor = db.rawQuery(selectQuery, null);

if (cursor.moveToFirst()) {
    do {
        Pet pet = new Pet();
        pet.setID(Integer.parseInt(cursor.getString(0)));
        pet.setName(cursor.getString(1));
        pet.setAge(cursor.getString(2));
        petList.add(pet);
    } while (cursor.moveToNext());
}

// Close cursor when finished using it
cursor.close();

return petList;     
} 
```

# c# - 用 2 个表中的数据填充 GridView

> ID：13765728
> 
> 赞同：0
> 
> 时间：2012-12-07T15:08:08.507
> 
> 标签：c#, asp.net, gridview

我有一个 asp.net 项目和 2 个表：

## 报告

RegisterID EventID UserID DateTime

## 用户

用户 ID 用户名

现在我想要一个显示日期时间和用户名的网格视图。

我从 2 小时开始尝试这个，但没有一次机会展示这个。

怎么做？

直到现在我有这个：

```
 public static List<EventRegistration> GetAllRegistrationsForEventID(Guid eventID)
    {
        using (CyberDBDataContext db = new CyberDBDataContext())
        {
            DataLoadOptions options = new DataLoadOptions();

            options.LoadWith<EventRegistration>(p => p.CyberUser);
            db.LoadOptions = options;

            List<EventRegistration> list = (from a in db.EventRegistrations where a.EventID == eventID select a).ToList();
            return list;
        } 
```

和这个：

```
 <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" SelectMethod="GetAllRegistrationsForEventID"
        TypeName="DAL.RegistrationHandler">
        <SelectParameters>
            <asp:QueryStringParameter DbType="Guid" DefaultValue="0000-000000-000000-0000" Name="eventID"
                QueryStringField="id" />
        </SelectParameters>
    </asp:ObjectDataSource>
    <asp:GridView  ID="GridView1" runat="server" AutoGenerateColumns="False" DataSourceID="ObjectDataSource1"
        EmptyDataText="Keine Spieler registriert" 
        onrowdatabound="GridView1_RowDataBound">
        <Columns>
            <asp:BoundField DataField="RegisterID" HeaderText="RegisterID" SortExpression="RegisterID"
                Visible="false" />
            <asp:BoundField DataField="EventID" HeaderText="EventID" SortExpression="EventID"
                Visible="false" />
            <asp:TemplateField HeaderText='Name' ItemStyle-HorizontalAlign='Center'>
                <ItemTemplate>
                    <asp:Label ID="lblName" runat="server" Text="Label"></asp:Label>
                </ItemTemplate>

            </asp:TemplateField>
            <asp:BoundField DataField="Timestamp" HeaderText="Anmeldezeit" SortExpression="Timestamp" />
            <asp:BoundField DataField="UserID" HeaderText="UserID" SortExpression="UserID"  />
        </Columns>
    </asp:GridView> 
```

但没有任何效果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:49:46.260

您的 select 方法是`GetAllRegistrationsForEventID`返回 EventRegistration 列表的方法。

返回一个将事件和用户信息投影在一起的匿名对象，例如： 首先有一个类：

```
class AllInfo
{
    string RegisterID ;
    string EventID ;
    string UserID ;
    string DateTime;
    string Username;
} 
```

然后

```
public static List<AllInfo> yourMethodName(Guid eventID)
{
    using (CyberDBDataContext db = new CyberDBDataContext())
    {
        DataLoadOptions options = new DataLoadOptions();

        options.LoadWith<EventRegistration>(p => p.CyberUser);
        db.LoadOptions = options;

        List<AllInfo> list = (from a in db.EventRegistrations 
                             where a.EventID == eventID 
                             select new AllInfo (){ RegisterID = a.RegisterID, 
                                                    EventID = a.EventID,
                                                    UserID = a.UserID,
                                                    UserName = a.User.UserName...}).ToList();
        return list;
    } 
```

}

# c# - 处理应用程序更新时连接字符串的位置

> ID：13765731
> 
> 赞同：0
> 
> 时间：2012-12-07T15:08:17.217
> 
> 标签：c#, wix, windows-installer, connection-string

我正在开发的应用程序之一正在被各种客户使用。应用程序需要连接到数据库，因此在 app.config 中定义了一个连接字符串。然而，每个客户端都需要不同的连接字符串。

客户必须在产品安装过程中提供数据库信息。他们需要在每个新版本中提供此信息。

我真正想要的是一些设置，如连接字符串，存储在不受新安装影响的位置。处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:52:14.050

您是否考虑过为每个客户创建一个转换（http://wix.tramontana.co.hu/tutorial/transforms）？将连接字符串粘贴在属性中，并使用转换在客户端上对其进行更新，这比更新安装程序以使用他们在安装期间输入的内容要快得多/容易得多（并且可能更不容易出错）。像运行一样简单：

> 安装程序.msi 转换=client.mst

缺点是他们必须确保在运行安装程序时使用转换，现在确定如何打包或启动它们等。如果你只是给任何老汤姆、迪克或哈利，这可能不是最好的解决方案，如果是您或您认识的人安装它，那么它可能是一个简单的解决方案。

或者，您可以使用机器上的 DSN 或其他设置来保持它们的一致性。

否则你必须修改/编辑你的安装，在这种情况下你应该看看[http://wix.tramontana.co.hu/tutorial/user-interface-revisited](http://wix.tramontana.co.hu/tutorial/user-interface-revisited)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T09:54:08.297

我建议将连接字符串存储在注册表中，您可以在进行升级时通过搜索该值来检索该值并将其存储为属性。如果未找到该值，您可以将其视为全新安装并提示输入该值，或将其作为命令行属性检索。

可以使用[RegistrySearch](http://wix.sourceforge.net/manual-wix2/wix_xsd_registrysearch.htm)来实现搜索，这是一个示例：

```
<Property Id="DATABASECONNECTIONSTRING">
  <RegistrySearch Id="DbConnectionString" Root="HKLM" Key="MyDBConnectionStringLocation" Name="ConnectionString" Type="raw" />
</Property> 
```

要存储值，请使用[RegsitryValue](http://wix.sourceforge.net/manual-wix3/wix_xsd_registryvalue.htm)元素：

```
<Component Id="PersistentProperty" KeyPath="yes">
  <RegistryValue Id="DbConnectionString" Root="HKLM" Key="MyDBConnectionStringLocation" Value="[DATABASECONNECTIONSTRING]" Name="DbConnectionString" Type="string" />
</Component> 
```

# hadoop - 如何从另一个人的列中填充 Cassandra 列族？

> ID：13765732
> 
> 赞同：1
> 
> 时间：2012-12-07T15:08:27.070
> 
> 标签：hadoop, cassandra

我一直读到，如果您的应用程序经常更改并且经常添加功能，Cassandra 就很好。

这是有道理的，因为您没有任何固定架构，您可以向行添加列以满足您的需要，而不是运行 ALTER TABLE 查询，这可能会为非常大的表冻结数小时的数据库。

但是，我有一个我无法解决的假设性问题。假设我有：

```
CREATE COLUMN FAMILY Students
    with comparator='CompositeType(UTF8Type,UTF8Type),
    and key_validation_class=UUIDType; 
```

每个学生都有一些通用列（你知道，meta:username、meta:password、meta:surname 等），而且每个学生都可以学习 N 门课程。这种 NN 关系是使用非规范化解决的，将 N 列添加到每个学生（课程：ID1，课程：ID2）。

另一方面，我可能有一个 Courses CF，其中每一行都包含以下所有学生 UUID。

所以我可以问“XXX学习了哪些课程”和“哪些学生学习了YYY课程”。

问题是：如果我没有创建第二个列族怎么办？也许在构建应用程序时，让学生学习特定课程并不是必需的。

这是一个简单的例子，但我相信它很常见。“使用 Cassandra，您可以根据查询而不是关系来计划 CF”。我现在需要那个查询，而起初它并不需要。

给定一个包含数千个条目的学生表，您将如何填写 Courses CF？这是 Hadoop、Pig 还是 Hive 的工作（我从未接触过这些，只是猜测）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:35:08.743

Pig（使用 Hadoop 集成）实际上非常适合这种类型的工作，因为您不仅可以使用 CassandraStorage 读取数据，还可以将数据写回 Cassandra。它为您提供并行处理能力，以最少的时间和开销完成工作。否则，另一种方法是自己编写一些东西来进行提取，然后编写新的 CF。

这是一个 Pig 示例，它从一个 CF 中的一组数据计算平均值并将它们输出到另一个：

```
rows = LOAD 'cassandra://HadoopTest/TestInput' USING CassandraStorage() AS (key:bytearray,cols:bag{col:tuple(name:chararray,value)});
columns = FOREACH rows GENERATE flatten(cols) AS (name,value);
grouped = GROUP columns BY name;
vals = FOREACH grouped GENERATE group, columns.value AS values;
avgs = FOREACH vals GENERATE group, 'Pig_Average' AS name, (long)SUM(values.value)/COUNT(values.value) AS average;    
cass_group = GROUP avgs BY group;   
cass_out = FOREACH cass_group GENERATE group, avgs.(name, average);
STORE cass_out INTO 'cassandra://HadoopTest/TestOutput' USING CassandraStorage(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-18T06:01:06.770

如果您使用现有的 cassandra 文件，则必须展开数据。由于 NOSQL 文件是单向的，这在 Cassandra 本身中可能是一个非常耗时的操作。数据必须以与第一个文件相反的顺序排序。坦率地说，我相信您将不得不返回用于填充第一个文件的原始数据并从中填充这个新文件。

# android - SQlite android查询中的LIKE语句错误

> ID：13765739
> 
> 赞同：-1
> 
> 时间：2012-12-07T15:08:39.823
> 
> 标签：android, sqlite

我在 sqlite android 中遇到了关于 LIKE 语句的问题。我用了一个小时来弄清楚，但我无法得到错误部分。有谁知道我的错误在哪里？

```
 public Cursor getSearch(String id) {

        String[] args = { id };

        return (database.rawQuery("SELECT " + SQLiteHelper.product_id
                + " as _id," 
                + SQLiteHelper.productName + " ," +SQLiteHelper.productDesp
                + "," + SQLiteHelper.productQtty + ","
                +SQLiteHelper.product_CategoryF+" FROM " 
                + SQLiteHelper.productTable+"  WHERE "
                + SQLiteHelper.productName +" LIKE 'id%'",null));
} 
```

错误信息

```
 bind or column index out of range: handle 0x5e3ec0 
```

有人知道我的错误在哪里吗？

解决方案

```
return (database.rawQuery("SELECT " + SQLiteHelper.product_id
                + " as _id," 
                + SQLiteHelper.productName + " ," +SQLiteHelper.productDesp
                + "," + SQLiteHelper.productQtty + ","
                +SQLiteHelper.product_CategoryF+" FROM " 
                + SQLiteHelper.productTable+"  WHERE "
                + SQLiteHelper.productName +" LIKE '"+id+"%'",null)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:15:09.957

你不需要像那样形成你的 SQL。`rawQuery`使得绑定参数变得非常容易。

```
rawQuery("SELECT ? as _id, ?, ?, ?, ? FROM ? WHERE ? LIKE 'id%'", new String[] {SQLiteHelper.product_id, SQLiteHelper.productName, SQLiteHelper.productDesp, SQLiteHelper.productQtty, SQLiteHelper.product_CategoryF, SQLiteHelper.productTable, SQLiteHelper.productName}); 
```

就您的代码而言，`,"+`您的 CategoryF 行上的通知应该是`+",`

```
 return (database.rawQuery("SELECT " + SQLiteHelper.product_id
            + " as _id," 
            + SQLiteHelper.productName + " ," +SQLiteHelper.productDesp
            + "," + SQLiteHelper.productQtty + ","
            ,"+SQLiteHelper.product_CategoryF+" FROM " 
            + SQLiteHelper.productTable+"  WHERE "
            + SQLiteHelper.productName +" LIKE 'id%'",null)); 
```

# asp.net-mvc - 将复选框值绑定到模型 mvc 中的列表

> ID：13765741
> 
> 赞同：4
> 
> 时间：2012-12-07T15:08:42.810
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我的问题是我必须创建如下布局，使用 MVC 为用户分配权限。![所需布局样本](../Images/644b0b6a6ef47c10c7a053e98edbf09f.png)

现在创建复选框没有问题，我将使用用户列表创建它。但是在提交表格时，我应该将其提交到下面的列表中。

```
public class UserRightsViewModel
    {
       public UserRightsViewModel()
        {
            _screenrights = new List<ScreenRight>();

        }
        public String Id { get; set; }// Role Name 
        List<ScreenRight> _screenrights;
        public List<ScreenRight> ScreenRights { get { return _screenrights; } set { _screenrights = value; } }

    } 
```

screenRight 的定义如下

```
public class ScreenRight
{
       public String UserName { get; set; }
        public Boolean Select{ get; set; }
        public Boolean Add{ get; set; }
        public Boolean Edit{ get; set; }
       ,,,
} 
```

现在，在提交表单时，我如何以正确的格式将其发布到控制器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T15:35:43.350

控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        var model = new UserRightsViewModel
        {
            // Obviously those could come from some data source
            ScreenRights = new[]
            {
                new ScreenRight { UserName = "Robert", Select = true, Add = false, Edit = false },
                new ScreenRight { UserName = "John", Select = true, Add = true, Edit = false },
                new ScreenRight { UserName = "Mike", Select = true, Add = true, Edit = false },
                new ScreenRight { UserName = "Allan", Select = true, Add = true, Edit = true },
                new ScreenRight { UserName = "Richard", Select = false, Add = false, Edit = false },
            }.ToList()
        };
        return View(model);
    }

    [HttpPost]
    public ActionResult Index(UserRightsViewModel model)
    {
        // The view model will be correctly populated here
        // TODO: do some processing with them and redirect or
        // render the same view passing it the view model
        ...
    }
} 
```

看法：

```
@model UserRightsViewModel

@using (Html.BeginForm())
{
    <table>    
        <thead>
            <tr>
                <th>User Id</th>
                <th>Select</th>
                <th>Add</th>
                <th>Edit</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < Model.ScreenRights.Count; i++)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(x => x.ScreenRights[i].UserName)
                        @Html.HiddenFor(x => x.ScreenRights[i].UserName)
                    </td>
                    <td>
                        @Html.CheckBoxFor(x => x.ScreenRights[i].Select)
                    </td>
                    <td>
                        @Html.CheckBoxFor(x => x.ScreenRights[i].Add)
                    </td>
                    <td>
                        @Html.CheckBoxFor(x => x.ScreenRights[i].Edit)
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <button type="submit">OK</button>
} 
```

延伸阅读：[`Model Binding To a List`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-07T15:27:16.377

要向后工作，您最终的 HTML 应该如下所示（忽略您的表格）

```
<input type="hidden" value="0" name="ScreenRights[0].Select"/>  
<input type="checkbox"  name="ScreenRights[0].Select"/>

<input type="hidden" value="0" name="ScreenRights[0].Add"/>  
<input type="checkbox" name="ScreenRights[0].Add"/>

<input type="hidden" value="0" name="ScreenRights[0].Edit"/> 
<input type="checkbox" name="ScreenRights[0].Edit"/>

<input type="hidden" value="0" name="ScreenRights[1].Select"/>  
<input type="checkbox"  name="ScreenRights[1].Select"/>

<input type="hidden" value="0" name="ScreenRights[1].Add"/>  
<input type="checkbox"  name="ScreenRights[1].Add"/>

<input type="hidden" value="0" name="ScreenRights[1].Edit"/> 
<input type="checkbox"  name="ScreenRights[1].Edit"/> 
```

这个想法是索引顺序显示在属性名称的 [i] 数组部分中，然后链接到下一个属性。它应该以与您的 i 相同的顺序绑定。这里的另一个关键是复选框仅与 CHECKED 属性绑定，因此值对于绑定器而言没有任何意义。这就是为什么你在前面有隐藏的输入。binder 将始终分配 false，如果选中该复选框，则将其覆盖为 true。您可以在简单模型上使用 Html.CheckBoxFor 验证生成的 html。

就让您的 HTML 看起来像这样而言，您可以手动完成，也可以使用内置框架。

我很确定您可以在 for 循环中执行此操作（i 作为迭代器）

```
@Html.CheckBoxFor(m => m.ScreenRights[i].Select)
@Html.CheckBoxFor(m => m.ScreenRights[i].Add)
@Html.CheckBoxFor(m => m.ScreenRights[i].Add) 
```

# java - 如何让两个小程序共享字段

> ID：13765742
> 
> 赞同：2
> 
> 时间：2012-12-07T15:08:49.843
> 
> 标签：java, javascript, applet, japplet

我有两个小程序。FirstApplet 小程序位于主 HTML 页面中。主页使用 javascript window.open(...) 打开嵌入 SecondApplet 小程序的新页面。

以下是两个小程序的定义方式：

```
public class SecondApplet extends JApplet{
    private static Long value;
    public void init(){
        value = new Long(6);
    }
    public static void testValue(){
        System.out.println(value);
    } 
}

public class FirstApplet extends JApplet{
    public void testValue(){
        SecondApplet.testValue();
    }
} 
```

现在我的问题是当 FirstApplet 调用

```
SecondApplet.testValue() 
```

静态字段失去了它的值，现在它的值为 0。我还尝试了我自己的对象模型，它们在 SecondApplet init() 方法中被实例化，但是当调用 FirstApplet.testValue() 时，这些对象现在为 NULL。

任何人都知道为什么会发生这种行为？我只是感到困惑，因为两个 Applet 都生活在同一个 JVM 中。

顺便说一句，我也尝试使用 getAppletContext.getApplet("secondapplet") 但它总是返回 NULL。甚至 getAppletContext.getApplets() 也总是返回一个元素。我在 HTML 页面中验证了 name 属性，它是正确的。

如果这是安全问题，只是想补充一点，我没有收到任何类型的错误或警告。

提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-07T15:15:05.700

它们在同一个 JVM 中，但它们是沙盒的。它们使用不同的类加载器，并且被禁止访问其他小应用程序的类加载器，因此它们也可能位于不同的 JVM 中。这是一项安全功能。您不希望某些恶意小程序访问所有打开的浏览器窗口中的数据。

在不同的浏览器窗口之间共享数据很棘手，因为它应该是。如果您确实需要这样做，您应该告诉我们您的具体要求是什么。也就是说，*为什么*需要共享数据？

# css - 在 dotless 中不起作用的简单 less 文件

> ID：13765744
> 
> 赞同：2
> 
> 时间：2012-12-07T15:08:50.330
> 
> 标签：css, less, dotless

以下 less 在 less.js 中有效，但在 dotless 中无效。这是真的吗？

```
#my-btn > .silver {  
color: blue;  
}

&:hover, &.hover {
 #my-btn > .silver;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:42:08.543

已经找到答案： [https](https://github.com/dotless/dotless/issues/144) ://github.com/dotless/dotless/issues/144 。我猜这是设计使然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:42:51.473

## 简短的回答：是的，它可以是真的。

在回答 Guffa 的评论时，我假设您`&`的内容包含在父选择器块中；如果没有，那可能是你的问题。

尽管如此，无论这是否是您的问题，我都注意到 LESS 的编译器差异，其中一些允许某些事情而不是其他事情。我注意到的一件事是，一些编译器允许复合选择器字符串作为 mixin（如 your `#my-btn > .silver`），而其他编译器似乎只允许 mixin 的单数选择器（如`#my-btn` *or* `.silver`）。

我无法告诉您哪些编译器允许选择器的哪种组合，但如果它在 less.js 中工作而不是 dotless，那么这可能就是原因。这是 dotless 中的错误还是编译器中的功能差异可能是一个有争议的问题。

# php - rewritecond query_string 反向引用

> ID：13765750
> 
> 赞同：1
> 
> 时间：2012-12-07T15:09:09.100
> 
> 标签：php, .htaccess, mod-rewrite

我正在尝试从此 URL 恢复 2 个变量：

```
RewriteCond %{QUERY_STRING} id_country=(.*)
RewriteCond %{QUERY_STRING} language=(en|it)
RewriteRule ^page33(.*) https://www.newsite.ch/page.php?language=%2&id_country=$1 [R=301,L] 
```

但是，%2 始终为空。我似乎只能反向引用一个变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:40:46.623

AFAIK不可能像您尝试一样。在反向引用（`%N`变量）中只有最后一个正则表达式匹配的数据。

您可以使用环境变量进行变通：

```
RewriteCond %{QUERY_STRING} id_country=(.*)
RewriteRule .* - [E=idcountry:%1]

RewriteCond %{QUERY_STRING} language=(en|it)
RewriteRule ^page33(.*) https://www.newsite.ch/page.php?language=%1&id_country=%{env:idcountry} [R=301,L] 
```

不同的解决方案是在一个正则表达式中匹配您需要的所有变量：

```
RewriteCond %{QUERY_STRING} id_country=(.*)
RewriteCond %{QUERY_STRING}&id_country=%1 language=(en|it).*&id_country=(.*)
RewriteRule ^page33(.*) https://www.newsite.ch/page.php?language=%1&id_country=%2 [R=301,L] 
```

注意第二个的第一个参数`RewriteCond`......它确保查询字符串参数的顺序将与正则表达式中的预期一致

# android - 调试从 Android 开发者控制台错误报告中提取的混淆堆栈跟踪

> ID：13765754
> 
> 赞同：3
> 
> 时间：2012-12-07T15:09:18.273
> 
> 标签：android, stack-trace, proguard

我在 Google Play 上有一个应用程序有一段时间了，它在历史上没有被混淆。有时用户的设备上会出现错误，我会通过 Android 开发者控制台应用程序错误报告获得报告，这让我可以看到崩溃的堆栈跟踪，我可以使用它来修复错误。我刚刚发布了我的应用程序的新版本，它第一次被混淆（ProGuard），我很好奇我是否可以使用 ProGuard`retrace`工具来对通过 Android 开发者控制台报告的堆栈跟踪进行去混淆处理。

我已阅读[此处的](http://developer.android.com/tools/help/proguard.html)*解码混淆堆栈跟踪*部分，但我仍然不确定命令接受的堆栈跟踪文件（或标准输入）的格式是什么，以及这是否与 Android 报告的格式错误相同开发者控制台错误报告。我保留了所有重要的文件。基本上我想知道的是，当第一个新的错误堆栈跟踪进入 Android 开发者控制台时，它是否会以我可以运行该工具的格式呈现，或者，我是否需要收集堆栈跟踪如果我希望使用其他工具重建堆栈跟踪，请使用其他特定格式？`retrace``mapping.txt``retrace``retrace`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:17:00.967

ReTrace 对于这些堆栈跟踪应该可以正常工作；它们就像普通的 Java 堆栈跟踪。如果您以 ReTrace 无法识别的格式获得堆栈跟踪，您仍然可以使用 ReTrace 的 -regex 选项指定自定义正则表达式。

# php - 如何 preg_replace WordPress 标题中的标签？

> ID：13765758
> 
> 赞同：0
> 
> 时间：2012-12-07T15:09:25.210
> 
> 标签：php, wordpress, preg-replace

我正在尝试在 POST TITLE 中找到任何帖子标签，并`preg_replace`与由 a 包围的标签匹配以`span`向其添加 css（粗体）。最终结果应该是带有粗体标签的帖子标题。

```
 <h2 class="entry-title">
            <a href="<?php the_permalink(); ?>" rel="bookmark" title="Permalink to <?php the_title(); ?>">
                <?php 
                    $titlename = the_title();
                    $tags = array(just_tags());
                    foreach($tags as $tag) {
                        $displaytitle = preg_replace("$tag", "<span class=\"larger\">$tag</span>", $titlename);
                    }
                    echo $displaytitle;
                ?>
            </a>
        </h2> 
```

正如您在代码中看到的那样，我修改了一些函数以尝试仅获取标签 no`$before`和`$after`.

```
function get_just_the_tag_list() {
    return get_the_term_list('post_tag');
}

function just_tags() {
    echo get_just_the_tag_list();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:14:43.483

您`preg_replace`正在寻找文本 "$tag" in `$titlename`。把它从引号中取出，或者用花括号括起来`"{$tag}"`！

`get_the_terms_list`返回一个 HTML 格式的术语列表。您想使用`get_the_terms`，它会自动作为数组返回，所以`$tags`应该像这样定义（假设它在循环中并且`$post`是准确的：

`$tags = get_the_terms($post->ID, 'post-tags');`

```
<h2 class="entry-title">
        <a href="<?php the_permalink(); ?>" rel="bookmark" title="Permalink to <?php the_title(); ?>">
            <?php 
                $titlename = get_the_title();
                $tags = get_the_terms($post->ID, 'post_tag');
                foreach($tags as $tag) {
                    $titlename = str_replace($tag->name, '<span class="larger">'.$tag->name.'</span>', $titlename);
                }
                echo $titlename;
            ?>
        </a>
    </h2> 
```

这意味着您`$displaytitle`正在为 each 完全重写`$tag`，如果`$tag`在帖子标题中找不到最后一个，则不会有任何改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:20:18.707

你不就是做这样的事吗？

```
$titlename = the_title();
$tags = get_the_terms($post->ID, 'post_tag');
foreach($tags as $tag) {
    $displaytitle = str_replace($tag->name, "<span class=\"larger\">$tag</span>", $titlename);
} 
```

您不需要使用正则表达式，因为您想替换整个标签。`just_tags`不再需要该功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:17:49.677

你真的应该研究一下 Wordpress 过滤器。the_title() 上直接有一个过滤器，可让您执行此功能。

```
apply_filters('the_title','my_filter')

function my_filter($title)
{
//do what you want and
return $title; //when finished altering.
} 
```

如果你想保持你需要的样子

```
get_the_title()
$titlename = get_the_title();//inside the loop
or
global $post;
$titlename = get_the_title($post->ID);//outside the loop 
```

加上 crowjonah 的回答，删除 $tag 周围的引号，尽管您可能需要这样做`preg_replace("/" . $tag->name . "/", '<span class="larger">'.$tag->name.'</span>', $titlename );`

或者本杰明·帕普的`str_replace`

```
str_replace($tag->name, '<span class="larger">'.$tag->name.'</span>', $titlename  ); 
```

# jsf-2 - 如何从 URL 中隐藏 .xhtml 扩展名

> ID：13765761
> 
> 赞同：5
> 
> 时间：2012-12-07T15:09:39.547
> 
> 标签：jsf-2

在 JSF 2.0 中，如何隐藏`.xhtml`URL 的扩展名？这个可以配置`web.xml`吗？

我只想将当前 URL “更改`http://localhost:8080/sms/faces/admin/account/process_monthly_fee.xhtml"`为`".../process_monthly_fee.jsf"`.

添加以下上下文参数`web.xml`并不能解决我的问题，但我的应用程序什么也不显示：

```
<context-param>
   <param-name>javax.faces.FACELETS_VIEW_MAPPINGS</param-name>
   <param-value>*.jspx</param-value>
</context-param> 
```

或者

```
<context-param>
  <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
  <param-value>.jspx</param-value>
</context-param> 
```

我的`web.xml`文件是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">

  <display-name>School Management System</display-name>
  <welcome-file-list>
    <welcome-file>faces/index.xhtml</welcome-file>
  </welcome-file-list>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
    <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
  </servlet-mapping>

 <servlet>
    <servlet-name>upload</servlet-name>
    <servlet-class>com.sms.model.student.Upload</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>upload</servlet-name>
    <url-pattern>/Upload</url-pattern>
  </servlet-mapping> 
<servlet>
    <servlet-name>marks</servlet-name>
    <servlet-class>com.sms.student.service.Mark</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>marks</servlet-name>
    <url-pattern>/marks</url-pattern>
  </servlet-mapping>
  <error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/error/error.xhtml</location>
  </error-page>
  <session-config>
    <session-timeout>30</session-timeout>
  </session-config>
<filter>
    <filter-name>Extensions Filter</filter-name>
    <filter-class>org.apache.myfaces.webapp.filter.ExtensionsFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>Extensions Filter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping>  
<context-param>
<param-name>org.richfaces.skin</param-name>
<param-value>classic</param-value>
</context-param>
<context-param>
<param-name>org.richfaces.enableControlSkinning</param-name>
<param-value>true</param-value>
</context-param>
</web-app> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-07T15:16:48.273

如果您只想更改扩展名，请按照@Captain Giraffe 提供的[**链接中的建议进行操作。**](https://stackoverflow.com/questions/5416546/jsf-2-0-view-file-name-extension-other-than-xhtml)

要完全隐藏扩展，您可以使用[**PrettyFaces**](http://ocpsoft.org/prettyfaces/)或[**OmniFaces**](http://omnifaces.org)。

OmniFaces[**展示**](http://showcase.omnifaces.org/facesviews/ExtensionlessURLs)以示例为特色。

**编辑**：我想@Captain Giraffe 提供的链接解决了一个不同的问题 - 如何拥有具有不同扩展名的文件然后`.xhtml`被 JSF 拾取。

如果您想更改 URL 末尾的扩展名，可以将其添加到您的`web.xml`:

```
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.foo</url-pattern>
</servlet-mapping> 
```

从现在开始，您的页面将可以通过以下方式访问`/YourApplicationRoot/pagename.foo`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-31T15:26:28.483

您只需要在 web.xml 中添加以下代码

```
<servlet>
    <servlet-name>faces</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>faces</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
</servlet-mapping>

<context-param>    
    <param-name>org.omnifaces.FACES_VIEWS_SCAN_PATHS</param-name>    
    <param-value>/*.xhtml</param-value>
</context-param> 
```

并在 pom.xml 中添加 omnifaces 依赖项

```
 <dependency>
        <groupId>org.omnifaces</groupId>
        <artifactId>omnifaces</artifactId>
        <version>2.6.6</version>
   </dependency> 
```

它会从 url 中隐藏 .xhtml 扩展名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-06T16:00:39.293

有一种使用**Dispatcher View**模式的方法，可以将任何页面映射`url`到任何`xhtml`页面（从`/WEB-INF`）。

例如，`url` `http://localhost:8080/sms/faces/admin/account/process_m_fee`可以转发到`/WEB-INF/faces/admin/account/process_monthly_fee.xhtml`. 所以`url`-s 和 jsf 页面可能没有 .xhtml 扩展名。

您可以[在这里](https://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern/30076976#30076976)查看详细信息（也可以查看最后一条评论）

# c# - 右键单击 DataGrid 总是返回 RowIndex -1

> ID：13765763
> 
> 赞同：1
> 
> 时间：2012-12-07T15:09:56.660
> 
> 标签：c#, winforms, datagridview

我在几个地方有一个带有数据网格的 WinForms 应用程序。

在其中一个数据网格上，我为右键单击设置了一个事件，如下所示：

```
private void dataBundles_CellMouseDown(object sender, DataGridViewCellMouseEventArgs e)
{
    try
    {
        if (e.Button == MouseButtons.Right)
        {
            var cell = dataBundles.HitTest(e.X, e.Y);
            int cellRow = cell.RowIndex;
            DataTable table = (DataTable)dataBundles.DataSource;
            string bundleID = table.Rows[cellRow]["BundleID"].ToString();
            dataBundles.Rows[cellRow].DefaultCellStyle.BackColor = Color.Red;
            if (MessageBox.Show("Are you sure you want to delete Bundle ID '" + bundleID + "'?",
                                "Confirm Delete Bundle", MessageBoxButtons.YesNo) == DialogResult.Yes)
            {
                int intBundleID = Int32.Parse(bundleID);
                cBundle bundle = new cBundle(intBundleID);
                bundle.Delete();
                PopulateDocumentsTab();                        
            }
            else
            {
                dataBundles.Rows[cellRow].DefaultCellStyle.BackColor = Color.White;
            }
        }
    }
    catch (Exception eX)
    {
        string eM = "Error occurred when right clicking the Bundles datagrid";
        aError err = new aError(eX, eM);
        MessageBox.Show(eX.Message, eM);
    }
} 
```

但是由于某种原因，无论我在哪里右键单击此数据网格，rowindex 总是返回一个 -1，这当然是“关闭”网格，因此会导致错误。

我看不出我做错了什么，因为我在同一个应用程序中的其他数据网格上使用了相同的代码来右键单击事件，它们都工作正常。

我敢肯定，无论我缺少什么，它都会变得很简单，但是我已经关注这段代码很长时间了。

有人可以让我摆脱痛苦吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:30:58.423

终于找到问题了。. .

我正在使用“CellMouseDown”事件

一旦我将相同的代码转移到“MouseDown”事件中，它就起作用了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:31:52.347

只需添加一些代码即可避免此错误

```
if (cellRow == -1) return 
```

出现此错误的原因是因为您使用的是`HitTest(e.X, e.Y)`for dataTable 或者`DataGridView`您尝试单击 DataGridView 中的某个位置而不是 中的某个位置`Cell`，`Row`因此这意味着结果是

> 单元格行 -1

# android - Android POST 有空响应

> ID：13765772
> 
> 赞同：5
> 
> 时间：2012-12-07T15:10:16.617
> 
> 标签：android

我正在使用 HttpClient 向[http://www.pgu.donland.ru/php/Login.php](http://www.pgu.donland.ru/php/Login.php)发送一个帖子请求，并希望得到这样的响应：

```
<?xml version="1.0" encoding="utf-8"?><resp status="1" uD="John" UID="2" e=""/> 
```

但不幸的是我不断得到：

`<?xml version="1.0" encoding="utf-8"?> <resp status="1" uD="" UID="" e=""/>`

这里发生了什么？

我正在使用一个自定义类，其中包含 HttpClient 客户端字段，在我的构造函数中我正在使用这些设置：

```
SchemeRegistry schemeRegistry = new SchemeRegistry();
    schemeRegistry.register(new Scheme("http", PlainSocketFactory
                                    .getSocketFactory(), 80));
    schemeRegistry.register(new Scheme("https", new EasySSLSocketFactory(),
                                    443));

    HttpParams params = new BasicHttpParams();
    params.setParameter(ConnManagerPNames.MAX_TOTAL_CONNECTIONS, 30);
    params.setParameter(ConnManagerPNames.MAX_CONNECTIONS_PER_ROUTE,
                                    new ConnPerRouteBean(30));
    params.setParameter(HttpProtocolParams.USE_EXPECT_CONTINUE, false);
    params.setParameter("http.socket.timeout", timeout * 1000);
    params.setParameter("http.connection.timeout", timeout * 1000);
    // params.setParameter("http.connection-manager.timeout", new
    // Long(timeout * 1000));
    params.setParameter("http.protocol.head-body-timeout", timeout * 1000);
    HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);

    ClientConnectionManager cm = new SingleClientConnManager(params,
                                    schemeRegistry);
    this.client = new DefaultHttpClient(cm, params); 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:23:17.917

服务器端有问题。检查 Login.php 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:24:50.460

好吧，对于意大利人来说，俄语并不是最简单的语言，但是......看起来 uD 和 UID 参数在从客户端接收到它们作为用户名/密码（或用户密钥）后被服务器回显。也许您没有向服务器发送任何用户 ID 或任何用户名/密码对，因此它无法以预期的方式响应您。

# lucene - 在搜索之前更新 Term 的值

> ID：13765774
> 
> 赞同：1
> 
> 时间：2012-12-07T15:10:30.370
> 
> 标签：lucene

我正在使用 Lucene 3.6.1。

您知道是否有办法在 Lucene 实际对包含该 Term 的 Document 执行搜索之前更改 Term 的值（Term.text()）？

我需要这种预处理，因为值在写入索引时是加密的。我虽然在这个词上搜索时需要做模糊搜索和/或近似搜索。

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:13:34.163

您想在找到之前更改存储在索引中的值吗？不，这没有意义。

如果您在索引中存储加密数据，则需要使用加密数据进行搜索。如果您需要能够利用正确的文本搜索，您只需要以未加密的形式对其进行索引。我猜，除非您使用某种对文本搜索友好的加密形式。我想如果它是一个简单的密码或其他东西，你可以加密索引值和查询和搜索就好了。不过，除此之外，我认为对加密数据进行模糊搜索并不可行。

我的建议：

您可以索引但不能存储字段的未加密形式，让您可以根据需要利用搜索。

然后可以创建一个字段来存储加密字段以容纳该字段的可检索版本。是否索引该字段取决于在某些情况下您是否可以使用加密数据进行搜索，但我猜不会。

就像是：

```
Document.add(new Field('fieldname', value, Field.Store.NO, Field.Index.ANALYZED);
Document.add(new Field('fieldnameencrypted', value, Field.Store.YES, Field.Index.NO); 
```

只能搜索 fieldname，但只能从找到的文档中检索 fieldnameencrypted（以加密形式）。

# java - Play 2.0.4 更新使用@EmbeddedId 的类时出现问题

> ID：13765775
> 
> 赞同：3
> 
> 时间：2012-12-07T15:10:31.263
> 
> 标签：java, playframework, playframework-2.0, ebean

我最近遇到了一个带有嵌入式 id 的类的问题。每当我想更新数据库中的现有条目时，都会收到错误“<code>java.lang.RuntimeException: No @javax.persistence.Id field found in class”。当我使用`update()`或`save()`在一个已经是令人兴奋的数据库条目的对象上时，我只会收到此错误。用于`save()`插入新条目，没有问题，删除现有条目也是如此`delete()`。

其他人在 Play Framework Google Group 中发布了一个关于这个问题的问题，但遗憾的是它从未得到回答。所以我想我会尝试在这里寻求帮助。

这是我的代码的基本外观：

```
@Entity
@Table(name = "files_location")
public class FilesLocation extends Model {

    @EmbeddedId
    public FilesLocationPK ids;

    @Column(name="status")
    public Character status; 

    @ManyToOne
    @MapsId("fileId")
    @JoinColumn(name = "file_id", referencedColumnName = "id", insertable = false, updatable = false)
    public File file;

    @ManyToOne
    @MapsId("locationId")
    @JoinColumn(name = "location_id", referencedColumnName = "id", insertable = false, updatable = false)
    public Location location;

}

@Embeddable
public class FilesLocationPK {

    @Column(name="file_id")
    public Integer fileId;

    @Column(name="location_id")
    public Integer locationId;
    ...
} 
```

错误如下所示：

```
java.lang.RuntimeException: No @javax.persistence.Id field found in class [class models.FilesLocation]
    at play.db.ebean.Model._idAccessors(Model.java:39)
    at play.db.ebean.Model._getId(Model.java:52)
    at play.db.ebean.Model.hashCode(Model.java:183)
    at java.lang.Object.toString(Object.java:219)
    at java.text.MessageFormat.subformat(Unknown Source)
    at java.text.MessageFormat.format(Unknown Source)
    at java.text.Format.format(Unknown Source)
    at java.text.MessageFormat.format(Unknown Source)
    at com.avaje.ebeaninternal.server.core.Message.msg(Message.java:39)
    ... 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-17T22:35:51.263

您需要在 PK 类中的键列上使用 @Id 注释。

Ebean 也将希望找到一个序列以用于生成这些。

# java - 使用 Spring 的 @Transactional 处理异常

> ID：13765776
> 
> 赞同：11
> 
> 时间：2012-12-07T15:10:41.237
> 
> 标签：java, spring, hibernate, spring-mvc

我正在使用 Spring MVC 和 hibernate 开发一个 Web 应用程序以实现持久性。给定我的 DAO，其中 GenericDao 具有 SessionFactory 成员属性：

```
@Repository
public class Dao extends GenericDao {
    public void save(Object o) {
        getCurrentSession().save(o);
    }
} 
```

和一个服务类

```
@Service
public class MyService {
    @Autowired
    Dao dao;

    @Transactional
    public void save(Object o) {
        dao.save(o);
    }
} 
```

如果发生持久性异常（约束、重复等），我想通知我的用户。据我所知，`@Transactional`注释仅在异常冒泡并且事务管理器回滚时才有效，因此我不应该在该方法中处理异常。我应该在哪里以及如何捕获在 DAO 中发生的异常，以便我可以将它直接呈现给我的用户，或者包含在我自己的异常中？

我想使用spring的事务支持。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T18:55:18.693

Spring 提供异常处理程序。

[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-exceptionhandlers](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-exceptionhandlers)

所以你可以在你的控制器中有这样的东西来处理 ConstraintViolationException

```
 @ExceptionHandler(ConstraintViolationException.class)
  public ModelAndView handleConstraintViolationException(IOException ex, Command command, HttpServletRequest request) 
{
    return new ModelAndView("ConstraintViolationExceptionView");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-30T18:51:32.163

在解决了这个问题一段时间后，我通过使用异常处理程序（如另一个答案中所述）和注释的`rollbackFor`属性解决了这个问题：`@Transactional`

```
@Transactional(rollbackFor = Exception.class) 
```

我的异常处理程序仍然被调用并相应地写入响应，但事务被回滚。

# facebook - 点赞按钮比 Graph Api 显示更多点赞

> ID：13765783
> 
> 赞同：1
> 
> 时间：2012-12-07T15:11:01.353
> 
> 标签：facebook, facebook-like, facebook-fql

Facebook LIKE 按钮显示的点赞数比 API 多！！！

我有一个链接：`http://premija.intensa.pro/person/130/ilona_kvelde`

当我在页面上创建 Like 按钮时，此时显示 48 个喜欢（您可以尝试在 Get Code 页面中输入链接：http: [//developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)）

但是，当我执行`FQL`查询时，它显示得更少。

`FQL`您可以在资源管理器中尝试

```
SELECT share_count, like_count, comment_count, total_count 
FROM link_stat WHERE url='http://premija.intensa.pro/person/130/ilona_kvelde' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:07:37.670

在[资源管理器中运行它](https://developers.facebook.com/tools/explorer?method=GET&path=fql?q=SELECT%20share_count,%20like_count,%20comment_count,%20total_count%20%20FROM%20link_stat%20WHERE%20url=%27http://premija.intensa.pro/person/130/ilona_kvelde%27)：

```
{
  "data": [
    {
      "share_count": 2, 
      "like_count": 30, 
      "comment_count": 0, 
      "total_count": 32
    }
  ]
} 
```

你是对的，有区别。可能存在某种时间延迟或隐私问题，不确定。[请注意，运行 'http://www.google.com'](https://developers.facebook.com/tools/explorer?method=GET&path=fql?q=SELECT%20share_count,%20like_count,%20comment_count,%20total_count%20%20FROM%20link_stat%20WHERE%20url=%27http://www.google.com%27)也有所不同。但是，如果这对您来说是一个重要的区别，那么您应该[在这里](https://developers.facebook.com/bugs)提交一个错误。似乎是在宏观层面上，因此是设计使然，但值得一试。

# yui - 在列数据表 YUI 中建立链接

> ID：13765784
> 
> 赞同：1
> 
> 时间：2012-12-07T15:11:17.373
> 
> 标签：yui

我有一个包含数据表的网页我想让第一列单元格将用户重定向到另一个页面取决于它的值所以我想首先从一个单元格中获取值第二个从这个单元格链接到另一个页面取决于那个值。

任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:50:12.890

您需要编写一个自定义单元格格式化程序。检查您正在使用的 YUI 版本的文档：

YUI 2：http: [//developer.yahoo.com/yui/datatable/#format](http://developer.yahoo.com/yui/datatable/#format)

YUI 3：http: [//yuilibrary.com/yui/docs/datatable/#formatters](http://yuilibrary.com/yui/docs/datatable/#formatters)

# php - 学说生成实体命名空间问题？

> ID：13765785
> 
> 赞同：4
> 
> 时间：2012-12-07T15:11:18.640
> 
> 标签：php, symfony, doctrine-orm, entity

好的，我对教义有最后一个问题：generate:entities 命令

我运行下面的命令，我得到了预期的文件

```
/src/MyNamespace/Bundle/MyNamespaceBundle/Resources/config/doctrine/metadata/orm 
```

命令：

```
php app/console doctrine:mapping:convert yml ./src/MyNamespace/Bundle/MyNamespaceBundle/Resources/config/doctrine/metadata/orm --from-database --em=my_manager --filter=TblReports --verbose 
```

我看到了`TblReports.orm.yml`文件，第一行是：

```
TblReports 
```

命令：（这应该是注释而不是 yml 吗？）

```
php app/console doctrine:mapping:import MyNamespaceBundle yml --em=my_manager --filter=TblReports 
```

我运行上面的命令我在这里得到文件

```
/src/MyNamespace/Bundle/MyNamespaceBundle/Resources/config/doctrine/ 
```

与从第一个命令生成的第一个文件同名，只是在不同的位置和第一行（我假设是命名空间）

```
TblReports.orm.yml 
```

现在第一行是：

```
MyNamespace\Bundle\MyNamespaceBundle\Entity\TblReports 
```

但我认为它需要

```
MyNamespace\Bundle\MyNamespaceBundle\Entity\Reports\TblReports 
```

现在我运行最后一个命令

```
php app/console doctrine:generate:entities MyNamespaceBundle --path=src --no-backup 
```

我收到这个错误

```
[RuntimeException]                                                    
  Bundle "MyNamespaceBundle" does not contain any mapped entities. 
```

如果我像这样运行命令

```
php app/console doctrine:generate:entities MyNamespaceBundle:Reports --path=src --no-backup 
```

我收到此错误（但名称空间看起来正确）

```
 [RuntimeException]                                                                                   
  Namespace "MyNamespace\Bundle\MyNamespaceBundle\Entity\Reports" does not contain any mapped entities. 
```

这是 my_manager ( config.yml )

```
# Doctrine Configuration
doctrine:
    dbal:
      default_connection: my_database
      connections:
        my_database:
          driver:   pdo_pgsql
          port:     5432
          dbname:   tbl_reports
          user:     foo_user
          password: foo_pass
          charset:  UTF8
          mapping_types:
            bit: string

    orm:
        auto_generate_proxy_classes: "%kernel.debug%"
        default_entity_manager: my_manager
        entity_managers:
            my_manager:
                connection: my_database
                mappings:
                    MyNamespaceBundle:
                      mapping: true
                      dir: Entity/Reports 
```

在 config_dev.yml 中（我使用 dev 和 prod yml 文件来控制我可以连接到的主机）

```
# Doctrine Configuration
doctrine:
    dbal:
      connections:
        my_database:
          host: 172.0.0.1 
```

问题：

1.  为什么我会收到此错误？
2.  我该如何解决？

相关问题：

*   [使用 Doctrine 生成实体到单独的命名空间中](https://stackoverflow.com/questions/13629959/generate-entities-with-doctrine-into-separate-namespace)
*   [单表的实体生成](https://stackoverflow.com/questions/13732017/entity-generation-for-single-table)

更新＃1：

好吧，我运行了第二个命令`annotation`而不是，`yml`文件是在以下位置生成的：

```
MyNamespace\Bundle\MyNamespaceBundle\Entity 
```

命令：

```
php app/console doctrine:mapping:import MyNamespaceBundle annotation --em=my_manager --filter=TblReports 
```

我运行了学说：generate:entities （双向），但仍然出现错误。我决定将文件移动到这个目录

```
MyNamespace\Bundle\MyNamespaceBundle\Entity\Reports 
```

我运行了学说：generate:entities agin（双向），但仍然出现错误。我查看了文件中的命名空间，发现它指向工作命名空间。我更新自：

```
MyNamespace\Bundle\MyNamespaceBundle\Entity\TblReports 
```

至

```
MyNamespace\Bundle\MyNamespaceBundle\Entity\Reports\TblReports 
```

运行此命令

```
php app/console doctrine:generate:entities MyNamespaceBundle:Reports --path=src --no-backup 
```

现在可以工作了

```
Generating entities for namespace "MyNamespace\Bundle\MyNamespaceBundle\Entity\Reports" 
```

所以我猜问题#3是：

3.  如何获得第二个命令以在导入时添加正确的命名空间？

我试过这个但没有骰子

```
php app/console doctrine:mapping:import MyNamespaceBundle:Reports annotation --em=my_manager --filter=TblReports 
```

文件：

*   [http://symfony.com/doc/master/reference/configuration/doctrine.html](http://symfony.com/doc/master/reference/configuration/doctrine.html)

资源：

*   [https://github.com/doctrine/DoctrineBundle/blob/master/Command/ImportMappingDoctrineCommand.php](https://github.com/doctrine/DoctrineBundle/blob/master/Command/ImportMappingDoctrineCommand.php)
*   [https://github.com/doctrine/DoctrineBundle/blob/master/Command/GenerateEntitiesDoctrineCommand.php](https://github.com/doctrine/DoctrineBundle/blob/master/Command/GenerateEntitiesDoctrineCommand.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:52:29.353

您的第一行需要以 : 结尾，如：

```
MyNamespace\Bundle\MyNamespaceBundle\Entity\TblReports: 
  <yml> data. 
```

您似乎将注释与 yml 混合在一起。选择一个并坚持下去。我不使用注释，所以剩下的就是 yml 注释。带有 yml 选项的学说：映射：导入/转换生成 yml 文件将 yml 文件放在 Bundle/Resources/config/doctrine 中。

然后使用 yml 文件的集合来创建实体类，并将它们放在每个 yml 文件中指定的位置，默认为 NamespaceBundle\Entity。

# c# - Imap Mail：AE.NET.Mail 邮件正文为空

> ID：13765786
> 
> 赞同：1
> 
> 时间：2012-12-07T15:11:28.420
> 
> 标签：c#, email, .net-4.0

我使用 AE.NET.Mail 来阅读我的电子邮件正文。
但所有这些身体都是空的！
我的代码如下：

```
 // Connect to the IMAP server. The 'true' parameter specifies to use SSL
    // which is important (for Gmail at least)
    ImapClient ic = new ImapClient("imap.soscharge.com", "main@domain.tk", "123",
                    ImapClient.AuthMethods.Login, 143, false);
    // Select a mailbox. Case-insensitive
    ic.SelectMailbox("INBOX");
    Console.WriteLine(ic.GetMessageCount());
    // Get the first *11* messages. 0 is the first message;
    // and it also includes the 10th message, which is really the eleventh ;)
    // MailMessage represents, well, a message in your mailbox
    MailMessage[] mm = ic.GetMessages(0, 10);
    foreach (MailMessage m in mm)
    {
        Response.Write(m.Sender + "<br /><br />");
    }
    foreach (MailMessage m in mm)
    {
        Response.Write(m.Sender + "<br /><br />");
    }
    // Probably wiser to use a using statement
    ic.Dispose(); 
```

我的电子邮件是 utf-8 编码的。
有什么问题，我怎样才能抓住那些尸体？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T18:00:59.637

GetMessages() 方法中有一个用于“headersonly”的默认参数，默认情况下为 true，当指定为 false 时，将下载消息正文：

```
 using (ImapClient ic = new ImapClient("imap.gmail.com", 
                    "anemail@example.org", 
                    "PasswordGoesHere!", 
                    ImapClient.AuthMethods.Login, 
                    993, true))
        {
            ic.SelectMailbox("INBOX");
            Console.WriteLine(ic.ListMailboxes("",""));

            // Note that you must specify that headersonly = false
            // when using GetMesssages().
            MailMessage[] mm = ic.GetMessages(0, 10, false);

            foreach (MailMessage m in mm)
            {
                Console.WriteLine(m.From);
                Console.WriteLine(m.Body);
                Console.WriteLine();
            }
        }

        Console.ReadKey(); 
```

# java - 如何与客户交换加密密钥？

> ID：13765787
> 
> 赞同：1
> 
> 时间：2012-12-07T15:11:30.417
> 
> 标签：java, encryption, amazon-s3, cryptography

我的 Java 应用程序需要处理加密文件。这是工作流程：

1.  客户加密文件（例如 RSA 加密）并将它们上传到 Amazon S3。
2.  我的 Java 应用程序从 AS3 中提取文件。
3.  我的 Java 应用程序解密文件。
4.  我的 Java 应用程序使用解密的文件创建其他文件。
5.  我的 Java 应用程序使用不同的密钥加密新文件并上传到 AS3。
6.  客户拿起文件。
7.  客户解密文件。

Amazon S3 提供用于下载/上传、解密/加密的 Java 类。此 API 将作为输入`java.security.KeyPair`。我不确定客户应该如何提供 My Java 应用程序的密钥，以便应用程序可以获取密钥`java.security.KeyPair`？

在客户和应用程序之间交换密钥的正确方法是什么？可以使用哪种密钥文件格式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:44:18.197

通常，非对称加密/解密的工作方式如下：

*   您生成一个私钥/公钥对。私钥应保密，不应四处发送等。公钥可以提供给客户而无需担心安全问题。
*   现在客户用这个公钥加密他的文件。加密文件**只能**用私钥解密。因此，用户可以将文件发送给您（在您的情况下通过 Amazon S3）。
    *   您收到文件并使用您的私钥对其进行解密。

现在您已经从客户那里获得了一份文件。为了能够发回加密的消息，您需要另一个公钥/私钥对。这一次，客户必须是唯一知道私钥的人。例如，他可以将公钥放入他发送给您的文件中。无论如何，您需要以某种方式从他那里获得公钥。使用该密钥，您可以加密文件并将它们发送到 Amazon S3。用户拿起它们并用他的私钥解密它们。

所以，客户**不能**给你一个`java.security.KeyPair`，因为那些包含私钥。发送私钥是不安全的。但他可以将公钥作为[`java.security.PublicKey`](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/PublicKey.html). 我认为最好的方法是将其发送给您，无论是在他提供的文件中，还是在他同时上传的单独文件中以及提供的文件之外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T15:19:56.060

问题是您还没有分配信任的方法。幸运的是，有一个运行良好：TLS。TLS 证书存储在浏览器中（如果您需要胖客户端，则存储在 JRE 中）。

您的密钥对应在本地生成（或在安全机器上生成并导入）。私钥应始终保持安全。客户使用 TLS 连接到您的站点，并下载您的公钥。然后客户上传他的密钥对的公钥。这可以在某些设置/配置阶段执行。

现在客户可以为您加密文件，您也可以为客户加密文件。请注意，TLS 已经提供加密（机密性）。因此，您获得的是文件在存储过程中受到保护，*在*传输之后。一旦您信任公钥（和可信赖的系统），您就可以通过纯 HTTP 发送文件。

添加签名非常重要，否则任何人都可以替换存储中的文件。可能还需要一些审计日志，否则文件可能会被删除。

其他方案是可能的（我更喜欢用于文件加密/解密的 PGP 方案），但它们需要密钥的带外通信。请注意，这只是基本方案，有很多陷阱，但为您的应用程序制定特定的安全架构显然是题外话。

# magento - Magento 的批量导入 + 导出 url 重写

> ID：13765792
> 
> 赞同：1
> 
> 时间：2012-12-07T15:12:01.760
> 
> 标签：magento, redirect, bulk, google-search-console

当我在互联网上查看如何根据仍在开发服务器上的新站点将 URL 从我当前的实时站点批量重定向到新 URL 时，我发现了 Magento 的“批量导入和导出 URL 重写扩展”。

我已经请我的程序员帮助我，他们已经向我发送了 2 个 CSV 文件，其中一个包含来自当前实时站点的所有请求和目标 url（这些通常也不同，可能是由于早期的重定向），还有一个类似的到新网站。当前的现场站点有 2500 个 url，未来的站点有 3500 个（可能是因为一些旧的、非活动的和不必要的类别仍然在新站点中）。

我正在考虑将当前站点的 url 粘贴到 Excel 工作表中，然后为每个 url 插入未来的 url。很多工作......然后我想：我不能将我的工作限制在大约。300 个 Google 已编入索引的网址（您可能知道，可以通过 Google 网站管理员工具找到）？

你会推荐什么？使用这样的扩展会有好处吗？那会有哪些优势？（如果您记住我的程序员会为我将所有重定向上传到 .htaccess 文件中？）

提前致谢。

亲切的问候，鲍勃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T03:49:44.083

Axel 给出了可怕的建议。301 重定向告诉谷歌将该页面的旧 PR 和权限转移到重定向中的新页面。如果其他网站链接到这些页面，你不想要一堆死链接，那么有人可能会删除它们。

更糟糕的是，如果您没有正确处理 404，Google 可以并且会惩罚您。

更改平台时始终设置 301 重定向，只有不了解或可能关心 SEO 的人才会提出其他建议

# io - The best way to get a string from a Writer

> ID：13765797
> 
> 赞同：69
> 
> 时间：2012-12-07T15:12:03.023
> 
> 标签：io, go

I have a piece of code that returns a web page using the built-in template system. It accepts a `ResponseWriter` to which the resulting markup is written. I now want to get to the markup **as a string** and put it in a database in some cases. I factored out a method that accepts a normal `Writer` instead of a `ResponseWriter` and am now trying to get to the written content. Aha - a `Pipe` may be what I need and then I can get the string with `ReadString` from the `bufio` library. But it turns out that the `PipeReader` coming out from the pipe is not compatible with `Reader` (that I would need for the `ReadString` method). W00t. Big surprise. So I could just read into byte[]s using the `PipeReader` but it feels a bit wrong when `ReadString` is there.

So what would be the best way to do it? Should I stick with the `Pipe` and read bytes or is there something better that I haven't found in the manual?

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-12-07T15:29:22.293

If your function accepts an io.Writer, you can pass a `*bytes.Buffer` to capture the output.

```
// import "bytes"
buf := new(bytes.Buffer)
f(buf)
buf.String() // returns a string of what was written to it 
```

If it requires an http.ResponseWriter, you can use a `*httptest.ResponseRecorder`. A response recorder holds all information that can be sent to a ResponseWriter, but the body is just a `*bytes.Buffer`.

```
// import "net/http/httptest"
r := httptest.NewRecorder()
f(r)
r.Body.String() // r.Body is a *bytes.Buffer 
```

* * *

## 回答 #2

> 赞同：-7
> 
> 时间：2016-06-29T08:59:25.427

The below code is possibly the simplest way to convert Writer (or any type) to string

```
package main

import "fmt"
import "io"
import "reflect"

func main(){
    var temp io.Writer
    output := fmt.Sprint(temp)
    fmt.Println(reflect.TypeOf(output))

} 
```

Output:

```
string 
```

# c++ - 我应该如何递归调用模板函数？

> ID：13765799
> 
> 赞同：4
> 
> 时间：2012-12-07T15:12:25.093
> 
> 标签：c++, templates, recursion

我正在尝试在 C++ 中创建一个树类，但我不确定在使用递归时应该如何使用模板。

例如我有以下功能：

```
template <typename Data>
void destroyTree(typename AVLTree<Data>::Node* element) {
    if(!element) {
        return;
    }
    destroyTree(element->getLeft());
    destroyTree(element->getRight());
    delete element;
} 
```

或者应该是：

```
template <typename Data>
void destroyTree(typename AVLTree<Data>::Node* element) {
    if(!element) {
        return;
    }
    destroyTree<Data>(element->getLeft());
    destroyTree<Data>(element->getRight());
    delete element;
} 
```

那么如果我从以下函数中调用它：

```
template <typename Data>
void AVLTree<Data>::function() {
    destroyTree(root);
} 
```

或者：

```
template <typename Data>
void AVLTree<Data>::function() {
    destroyTree<Data>(root);
} 
```

我尝试结合上述大多数可能性，但总是出错。通常它是一个`non matching function for call to`

如果有人对这个问题有一些经验，请帮助我。

谢谢你。

如果我使用 Nawaz 的建议，我会收到以下错误：

> 内部生成器用于构建 ** g++ -O0 -g3 -Wall -c -fmessage-length=0 -oAVLTest.o ..\AVLTest.cpp g++ -oAVLTree.exe AVLTest.o AVLTest.o：在函数 ZN15Data_Structures7AVLTreeIiE4Node7getLeftEv' 中： C:/Users/Alex/workspace/AVLTree/Debug/../AVLTree.h:(.text$_ZN15Data_Structures11destroyTreeIiEEvPNS_7AVLTreeIT_E4NodeE[void Data_Structures::destroyTree(Data_Structures::AVLTree::Node*)]+0x47)：未定义对Data_Structures的引用： :AVLTree::Node::~Node()' collect2: ld returned 1 exit status 发生构建错误，构建停止 耗时：532 ms。

我该怎么办？

所有相关代码都[在这里](http://pastebin.com/p2j23Rqe)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T15:16:47.507

这是对的：

```
//in the first case
destroyTree<Data>(element->getLeft());
destroyTree<Data>(element->getRight());

//in the second case
destroyTree<Data>(root); 
```

也就是说，您必须指定模板参数，因为编译器无法从函数参数中推断出它，因为它是不可推断的上下文。

# css - 将内容流出身体的最佳方式

> ID：13765800
> 
> 赞同：1
> 
> 时间：2012-12-07T15:12:27.547
> 
> 标签：css, css-float, positioning, css-position

我正在研究博客布局，其中一些信息（蓝色框）从帖子的正文中取出，如下所示：http: [//jsfiddle.net/rhr96/](http://jsfiddle.net/rhr96/)

这样做最好的是什么？

目前我正在做：

```
position: absolute;  
margin-left: negative value; 
```

将蓝色框流向左侧。

但我也可以这样做：

```
position: relative;  
float: left;
right: some px; 
```

这些中的任何一个被认为更好？或者有没有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:07:49.727

我认为这样做的最好方法，实际上可能是[这个](http://jsfiddle.net/YuZ8d/)（好吧，我说最好，我想在大多数情况下这是一个见仁见智的问题）

HTML：

```
<div class="container">
    <div class="outside">
        hi
    </div>
    <div class="inside">
        <p>Blah blah blah</p>
    </div>
</div> 
```

CSS：

```
.container { margin: 20px auto; width: 400px; }

.outside { background: #d8d8d8; float: left; margin: 0 5px 0 0; padding: 5px; }
.inside { background: #000; color: #fff; margin: 5px 0; overflow: hidden; } 
```

显然，您可以在同一页面上重复多次（我想如果这是用于博客文章，您可能会这样做）

**编辑：**我的答案用于`floats`将元素从正常流程中取出，`overflow: hidden`在内容上使用 意味着它不会包裹在浮动元素下方。

（如果你不太了解`overflow`我建议您[阅读它](http://css-tricks.com/the-css-overflow-property/)，它可以用于各种事情，例如浮动清除）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:13:09.237

简短的回答：`POSITION ABSOLUTE`

原因：设计师使用`position: absolute`是因为这是从正常文档流中取出元素的正确方法，使用`float: left;`不会从文档流中取出蓝框...

编辑：刚刚明白你真正想要什么，我在这里做了一个新的 1，你可以看看..

[**演示**](http://jsfiddle.net/qbtKm/)

HTML

```
<div class="container">
    <div class="block">1</div>
    <div class="content">This is a question</div>
</div> 
```

CSS

```
.container {
    height: 200px;
    width: 500px;
    border: 1px solid #eeeeee;
    margin: 30px;
    position: relative;
    font-family: Arial;
}

.block {
    position: absolute;
    height: 80px;
    width: 60px;
    background-color: #eeeeee;
    top: 10px;
    left: 10px;
    font-size: 36px;
    text-align: center;
}

.content {
    width: 410px;
    float: right;
    margin: 10px;
    font-size: 18px;
} 
```

# python - 如何调试无法运行的 PyInstaller 构建？

> ID：13765801
> 
> 赞同：12
> 
> 时间：2012-12-07T15:12:32.383
> 
> 标签：python, pyinstaller

我以前只使用过一次 PyInstaller，它与 wxPython 一起工作非常简单。不过，我目前正在尝试构建一个不同的项目。从命令行运行时，该项目运行良好。然而，在它构建之后，它永远不会启动主窗口（wxPython）。

我在构建规范中将调试和控制台标志设置为 True。我还添加`[('v', '', 'OPTION')]`了 PyInstaller 手册中指定的详细选项 ( )。这是规格：

```
# -*- 模式：python -*-
# basedir = os.path.realpath(os.path.dirname(__file__))
basedir = os.getcwd()

# 构建图标 toc.
图标目录 = []
对于 os.walk(os.path.join(basedir, 'icons')) 中的目录：
    对于 dir[2] 中的图标：
        icons_toc.append(
            (
                os.path.join('icons', icon),
                os.path.join(dir[0], 图标),
                '数据'，
            )
        )

一=分析（
    ['应用程序.py']，
    pathex=['.', './lib', '../broadpy/lib', '../broadpy/vendor'],
    隐藏进口=[]，
    hookspath=无
)
a.datas += icons_toc

pyz = PYZ(a.pure)

执行程序 = 执行程序（
    皮兹，
    a.scripts + [('v', '', 'OPTION')],
    a.二进制文件，
    a.zip 文件，
    a.数据，
    名称=os.path.join(
        'dist', '地址清洁器.exe'
    ),
    调试=真，
    条=无，
    upx=真，
    控制台=真
)

应用程序=捆绑（
    可执行程序，
    name=os.path.join('dist', '地址清理器.app')
)

```

现在，当我运行构建的可执行文件时，我得到以下输出：

```
C:\Users\tomas\Dropbox\Broadnet\address_cleaner>"C:\Users\tomas\Dropbox\Broadnet\address_cleaner\dist\Address cleaner.exe"
_MEIPASS2 为 NULL
存档名称是 C:\Users\tomas\Dropbox\Broadnet\address_cleaner\dist\Address cleaner.exe
提取二进制文件
通过设置运行孩子执行自我作为孩子
创建子进程
等待子进程完成...
_MEIPASS2 是 C:/Users/tomas/AppData/Local/Temp/_MEI30762/
存档名称是 C:\Users\tomas\Dropbox\Broadnet\address_cleaner\dist\Address cleaner.exe
已经在孩子 - 运行！
清单路径：C:/Users/tomas/AppData/Local/Temp/_MEI30762/Address cleaner.exe.manifest
创建的激活上下文
激活上下文已激活
C:/Users/tomas/AppData/Local/Temp/_MEI30762/python27.dll
操纵环境
PYTHONPATH=C:/Users/tomas/AppData/Local/Temp/_MEI30762;C:/Users/tomas/Dropbox/Broadnet/address_cleaner/dist
PYTHONHOME=C:/Users/tomas/AppData/Local/Temp/_MEI30762/
v
# 安装 zipimport 钩子
导入 zipimport # 内置
# 安装 zipimport 钩子
从 CArchive 导入模块
导入元帅#内置
提取iu
导入 imp # 内置
导入 nt # 内置
提取结构
导入 _struct # 内置
提取档案
安装导入钩子
out00-PYZ.pyz
运行脚本
导入 zlib # 内置
导入 errno # 内置
导入 _weakref # 内置
导入 _codecs # 内置
导入 _sre # 内置
导入 _collections # 内置
导入运算符#内置
导入 itertools # 内置
导入 _bisect # 内置
导入 _heapq # 内置
导入线程#内置
导入数学#内置
导入 binascii # 内置
import _hashlib # 从 C:\Users\tomas\AppData\Local\Temp\_MEI30762\_hashlib.pyd 动态加载
导入 _random # 内置
导入 cStringIO # 内置
回溯（最近一次通话最后）：
  文件“”，第 65 行，在
  文件“C:\Users\tomas\Downloads\pyinstaller-2.0\PyInstaller\loader\iu.py”，第 386 行，在 importHook
  文件“C:\Users\tomas\Downloads\pyinstaller-2.0\PyInstaller\loader\iu.py”，第 480 行，在 doimport
  文件“C:\Users\tomas\Dropbox\Broadnet\address_cleaner\build\pyi.win32\buildspec\out00-PYZ.pyz\win32com”，第 5 行，在
  文件“C:\Users\tomas\Downloads\pyinstaller-2.0\PyInstaller\loader\iu.py”，第 386 行，在 importHook
  文件“C:\Users\tomas\Downloads\pyinstaller-2.0\PyInstaller\loader\iu.py”，第 459 行，在 doimport
  文件“C:\Users\tomas\Downloads\pyinstaller-2.0\PyInstaller\loader\iu.py”，第 248 行，在 getmod
  文件“C:\Users\tomas\Downloads\pyinstaller-2.0\PyInstaller\loader\iu.py”，第 105 行，在 getmod
ImportError：DLL 加载失败：找不到指定的模块。
RC：来自 pyi_rth_win32comgenpy 的 -1
好的。
停用激活上下文
释放激活上下文
完毕
# 清除 __builtin__._
# 清除 sys.path
# 清除 sys.argv
# 清除 sys.ps1
# 清除 sys.ps2
# 清除 sys.exitfunc
# 清除 sys.exc_type
# 清除 sys.exc_value
# 清除 sys.exc_traceback
# 清除 sys.last_type
# 清除 sys.last_value
# 清除 sys.last_traceback
# 清除 sys.path_hooks
# 清除 sys.path_importer_cache
# 清除 sys.meta_path
# 清除 sys.flags
# 清除 sys.float_info
# 恢复 sys.stdin
# 恢复 sys.stdout
# 恢复 sys.stderr
# 清理 __main__
# 清理[1] cStringIO
# 清理[1] __future__
# 清理[1] _collections
# cleanup[1] 编码
# 清理 [1] 站点
# 清理[1] atexit
# 清理[1] 关闭
# 清理[1] _heapq
# 清理[1] _weakref
# 清理[1] abc
# 清理[1] _bisect
# 清理[1] _weakrefset
# cleanup[1] 临时文件
# 清理[1] binascii
# 清理[1] sre_constants
# cleanup[1] 集合
# 清理[1] _codecs
# 清理[1] _warnings
# cleanup[1] 数学
# cleanup[1] 运算符
# 清理[1] fnmatch
# cleanup[1] 编解码器
# 清理 [1] 重新
# 清理[1] _struct
# cleanup[1] 线程
# cleanup[1] 关键字
# cleanup[1] 信号
# 清理[1] 随机
# 清理[1] 迭代工具
# cleanup[1] encodings.aliases
# cleanup[1] 异常
# cleanup[1] heapq
# 清理[1] sre_compile
# 清理[1] _sre
# 清理[1] _random
# 清理[1] 哈希库
# cleanup[1] 平分
# 清理[1] sre_parse
# 清理[1] _hashlib
# 清理[2] copy_reg
# 清理[2] iu
# 清理[2] os.path
# cleanup[2] 存档
# cleanup[2] 结构体
# 清理[2] 错误号
# 清理[2] 小鬼
# 清理[2] _abcoll
# 清理[2] ntpath
# 清理[2] nt
# cleanup[2] 通用路径
# 清理[2] 统计
# 清理[2] zipimport
# cleanup[2] 警告
# 清理[2] 用户字典
# 清理[2] 类型
# 清理[2] zlib
# 清理[2] 行缓存
# 清理[2] 操作系统
# cleanup[2] 元帅
# 清理系统
# 清理 __builtin__
# 清理整数：41 个未释放的整数
# 清理浮动：31 个未释放的浮动
回到父...
C:\Users\tomas\Dropbox\Broadnet\address_cleaner\dist\Address cleaner.exe 的释放状态

```

所以现在我看到 iu.py 提出了一个异常，但我仍然不知道为什么。我还发现运行我的 Downloads/py-installer 文件夹中的 python 文件非常神秘，即使我删除了该文件夹。

所以总结一下 - 我必须采取哪些步骤来弄清楚应用程序在启动时崩溃的确切原因？

* * *

我在 Windows 8 上使用 PyInstaller 2.0 和 Python 2.7.3。这些事实都不会导致这个错误，因为我正在成功构建另一个项目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-05T17:19:17.800

[Pyinstaller 有时需要在 .spec 文件中明确引用才能正确打包依赖项](http://www.pyinstaller.org/wiki/FAQ)。

有关更多信息，请参阅[确保正确的导入语句以便 pyinstaller 识别它们](https://stackoverflow.com/questions/22455714/importerror-no-module-named-geometry-while-running-executables-obtained-from-py)。

例如，如果它们是从您的 Python 模块之一外部导入的（例如，从 pyinstaller 不会读取的 jar 或 c++ 文件），则很容易错过关键依赖项。

[依赖遍历器](http://www.dependencywalker.com/)可能是您系统地跟踪丢失的 DLL 的第一道防线。只需下载它，然后加载您的 exe 或附属 dll 以查看哪些缺少依赖项。然后，追踪它们并手动将它们与 .exe 一起添加到您的目录中（假设您的打包在*一个目录*中）。

作为旁注，对于 pyinstaller 2.1 (python 2.7.6)，我修改了`pyi_importers.py`文件以至少尝试打印导入时哪个模块是麻烦制造者：

```
# line 409 of Pyinstaller.loader.pyi_importers.py
try: module = imp.load_module(fullname, fp, filename, self._c_ext_tuple)
except Exception as e:
    print fullname # at least tells you what module couldn't be imported
    raise e 
```

然后，知道问题发生在哪里，然后您可以使用依赖项遍历器确定问题以根除丢失的 DLL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T15:50:55.957

我知道这个答案没有回答如何调试这样的问题，所以我不会将其标记为正确，但我设法构建了应用程序，我认为我应该分享如何。我做了三件事，每件事都**可能**是错误的原因，但我们永远不会知道：

*   我用官方的 Python 2.7.3 替换了 ActivePython 2.7.3。
*   我用纯 python 插件替换[pymysql](http://sourceforge.net/projects/mysql-python/)替换了[MySQLdb](https://github.com/petehunt/PyMySQL)。
*   我用非常相似的方法替换了[Levenshtein](http://pypi.python.org/pypi/python-Levenshtein/)[`difflib.SequenceMatcher.ratio`](http://docs.python.org/2.7/library/difflib#difflib.SequenceMatcher.ratio)。

# c - MonoMac NSDrawThreePartImage / C 绑定

> ID：13765805
> 
> 赞同：1
> 
> 时间：2012-12-07T15:12:38.687
> 
> 标签：c, mono, pinvoke, monomac

我想在我的 MonoMac 应用程序中使用函数 NSDrawThreePartImage ( [Application Kit Functions Reference )。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Miscellaneous/AppKit_Functions/Reference/reference.html)但是，它对我不可用。

查看 NSCell.cs 的源代码，我可以看到它已被注释掉：

```
//APPKIT_EXTERN void NSDrawThreePartImage(NSRect frame, NSImage *startCap, NSImage *centerFill, NSImage *endCap, BOOL vertical, NSCompositingOperation op, CGFloat alphaFraction, BOOL flipped); 
```

我猜这只是意味着，它从未实施过。

我知道这是一个 C API。手动调用此方法可能涉及什么？看起来可以使用 Pinvoke（[Binding Objective-C Types](http://www.mono-project.com/MonoMac/Documentation/Binding_New_Objective-C_Types)）来完成。有人可以确认这是正确的方法吗？

其次，我不熟悉如何去做，因为方法参数不仅仅是原语。也许有一个很好的指南，或者我可以参考一些现有的例子？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T18:28:32.813

由于它是一个 C API，您可以简单地使用 P/Invoke 来绑定它。

关于复杂类型：

*   `NSRect`变为`RectangleF`- 请参阅`NSGraphics.RectClip`monomac [/src/AppKit/NSGraphics.cs](https://github.com/mono/monomac/blob/master/src/AppKit/NSGraphics.cs#L116)中的示例。
*   `NSImage *`变成`IntPtr`- 使用构造函数`IntPtr`来构造它的`Handle`属性来获取地址。
*   `GCFloat`简直就是一个`float`。
*   `BOOL`是`bool`（参见`NSGraphics.BestDepth`示例）。
*   用于枚举`int`。`NSCompositingOperation`

因此，将各个部分放在一起，应该这样做：

```
[DllImport (Constants.AppKitLibrary)]
extern static void NSDrawThreePartImage (RectangleF rect, IntPtr startCap, IntPtr centerFill, IntPtr endCap, bool vertial, int op, float alphaFraction, bool flipped);

public void DrawThreePartImage (RectangleF frame, NSImage startCap, NSImage centerFill, NSImage endCap, bool vertical, NSCompositingOperation op, float alphaFraction, bool flipped)
{
    // Or throw ArgumentNullException if NULL is not allowed here
    var startCapPtr = startCap != null ? startCap.Handle : IntPtr.Zero;
    var centerFillPtr = centerFill != null ? centerFill.Handle : IntPtr.Zero;
    var endCapPtr = endCap != null ? endCap.Handle : IntPtr.Zero;
    NSDrawThreePartImage (frame, startCapPtr, centerFillPtr, endCapPtr, vertical, (int)op, alphaFraction, flipped);
} 
```

`NSDrawNinePartImage`应该以类似的方式工作。

不知道为什么它被注释掉了，很可能它只是从未得到实施。还有更多缺失的部分。让我知道它是否适合您，我会为您将它添加到 NSCell.cs 中。

**编辑：** 我刚刚将此添加到 NSCell.cs：[https](https://github.com/mono/monomac/commit/7c60d5756c49331642d2348c7c83320b9ec3f549) ://github.com/mono/monomac/commit/7c60d5756c49331642d2348c7c83320b9ec3f549 。非常感谢您对此进行测试！

# zend-framework - 需要使用 oracle 存储过程测试功能

> ID：13765806
> 
> 赞同：-1
> 
> 时间：2012-12-07T15:12:38.813
> 
> 标签：zend-framework, phpunit

我有这样的代码：

```
protected function _checkUserVisibility()
{
    try {
        if (!$params->getUsrParametr(self::ACTIVE_FIF)) { // calling oracle stored proc
            throw new Unitex_Exception('ALARM');
        }
    }
    catch (Exception $e) {
        $this->logOut();
        throw $e;
    }
} 
```

这个函数是从另一个函数调用的（依此类推）。

一个问题：如何对这部分代码进行工作单元测试？

**编辑1：**

首先采取 hehe [http://framework.zend.com/manual/1.12/en/zend.test.phpunit.html](http://framework.zend.com/manual/1.12/en/zend.test.phpunit.html) 比改进（希望）测试过程是：

```
class UserControllerTest extends Zend_Test_PHPUnit_ControllerTestCase {
..........
public function testLoginAction()
{
    $request = $this->getRequest();
    $request->setMethod('POST')
        ->setHeader('X_REQUESTED_WITH', 'XMLHttpRequest')
        ->setPost(array(
                'user'     => 'test_user',
                'password' => 'test_pwd',
        ));

        $filialId = 1;
        $stmt1 = Zend_Test_DbStatement::createUpdateStatement();
        $this->getAdapter()->appendStatementToStack($stmt1);
        $this->getAdapter()->appendStatementToStack($stmt1);
        $this->getAdapter()->appendStatementToStack($stmt1);
        $this->getAdapter()->appendStatementToStack($stmt1);

        $stmt1Rows = array(array('IRL_ALIAS' => 'RO_COMMON', 'ISADM' => 'N'));
        $stmt1 = Zend_Test_DbStatement::createSelectStatement($stmt1Rows);
        $this->getAdapter()->appendStatementToStack($stmt1);

        $this->dispatch('/user/login');// <-- crash here
    $this->assertController('user');
    $this->assertAction('login');
    $this->assertNotRedirect();
    $this->_getResponseJson();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T12:10:05.090

在您的单元测试中，您绝对不需要任何数据库交互。您的问题的答案是使用 stub 进行 db 功能。

假设 $`params`是`SomeClass`contains的属性`getUsrParametr`，例如从数据库中获取某些内容。您正在测试`_checkUserVisibility`方法，因此您不关心`SomeClass`. 这样您的测试将如下所示：

```
class YourClass
{
    protected $params;

    public function __construct(SomeClass $params)
    {
        $this->params = $params;
    }

    public function doSomething()
    {
        $this->_checkUserVisibility();
    }

    protected function _checkUserVisibility()
    {
        try {
            if (!$this->params->getUsrParametr(self::ACTIVE_FIF)) { // calling oracle stored proc
                throw new Unitex_Exception('ALARM');
            }
        }
        catch (Exception $e) {
            $this->logOut();
            throw $e;
        }
    }
} 
```

当然，单元测试您测试的唯一方法是公共方法，但是您可以通过测试公共方法来覆盖受保护的方法。

```
public function testDoSomethingAlarm()
{
    // set expected exception:
    $this->setExpectedException('Unitex_Exception', 'ALARM');

    // create the stub
    $params = $this->getMock('SomeClass', array('getUsrParametr'));

    // and set desired result
    $params->expects($this->any())
        ->method('getUsrParametr')
        ->will($this->returnValue(false));

    $yourClass = new YourClass($params);
    $yourClass->doSomething();
} 
```

第二个测试 which test case if`getUsrParametr`将返回`true`：

```
public function testDoSomethingLogout()
{
    // set expected exception:
    $this->setExpectedException('SomeOtherException');

    // create the stub
    $params = $this->getMock('SomeClass', array('getUsrParametr'));

    // set throw desired exception to test logout
    $params->expects($this->any())
        ->method('getUsrParametr')
        ->will($this->throwException('SomeOtherException'));

    // now you want create mock instead of real object beacuse you want check if your class will call logout method:   
    $yourClass = $this->getMockBuilder('YourClass')
        ->setMethods(array('logOut'))
        ->setConstructorArgs(array($params))
        ->getMock();

    // now you want ensure that logOut will be called
    $yourClass->expects($this->once())
        ->method('logOut');

    // pay attention that you've mocked only logOut method, so doSomething is real one
    $yourClass->doSomething();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T02:56:41.050

如果您将 PHP 5.3.2+ 与 PHPUnit 一起使用，您可以在运行测试之前使用反射将它们设置为公共来测试您的私有和受保护方法，否则您可以通过正确测试公共方法来测试受保护/私有方法使用受保护/私有方法。一般来说，这两个选项中的后者通常是你应该如何做的，但如果你想使用反射，这里有一个通用的例子：

```
protected static function getMethod($name) {
  $class = new ReflectionClass('MyClass');
  $method = $class->getMethod($name);
  $method->setAccessible(true);
  return $method;
}

public function testFoo() {
  $foo = self::getMethod('foo');
  $obj = new MyClass();
  $foo->invokeArgs($obj, array(...));
  ...
} 
```

# java - getResourceAsStream()：如何决定先在哪里搜索？

> ID：13765815
> 
> 赞同：0
> 
> 时间：2012-12-07T15:13:21.470
> 
> 标签：java, jar, classpath, directory, bufferedimage

想象以下文件夹结构

*   文件夹
    *   应用程序.jar
    *   img（其实我不知道它在那里）

App.jar 里面也有`img`文件夹。

所以我使用以下代码读取图像img

```
InputStream is = IconManager.class.getClassLoader().getResourceAsStream("img/1.png");
BufferedImage bimage = ImageIO.read(is);
is.close(); 
```

我之前就知道这个片段非常适合从 jar 本身读取文件。但是由于偶然有过时的 img 版本，`folder`它开始从外部读取图像文件`img`：文件夹/img 而不是 jar 本身。我花了很多时间来弄清楚。

**我的问题是为什么代码片段默认尝试从文件夹/img 而不是 App.jar 中读取？**

UPD：我使用`java -jar App.jar`from运行它`folder`

在构建 jar 之前，我使用 Windows 7 并且从未`classpath`在 Eclipse 中指定

# jax-ws - 希望通过 JAX-WS 客户端查看 SOAP-Traffic

> ID：13765817
> 
> 赞同：1
> 
> 时间：2012-12-07T15:13:24.290
> 
> 标签：jax-ws

我有 JAXWS-Client 与以下代码行连接到服务器：

```
final QName serviceName = new QName(Namespace.SERVICE, "FileService");
service = new FileService(new URL("http://localhost:8059/WS/FileService?wsdl"), serviceName);
file_service = service.getSOAP11(); 
```

我的问题是，我想通过 Eclipse TCP/IP-Monitor 查看肥皂流量。所以我将监视器设置在客户端和服务器之间。但我只能看到第一个响应中的 wsdl。我认为原因是，客户端从接收到的 wsdl（使用端口 8060）中读取端点地址并将其用于进一步的流量。但那是真正的端点，而不是 TCP/IP 监视器的伪造 (8059)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T16:34:24.813

要查看客户端上的肥皂流量，您必须设置系统属性：

```
com.sun.xml.ws.transport.http.client.HttpTransportPipe.dump=true 
```

然后你得到标准输出的肥皂流量。

# jquery - 使用 jquery 根据属性名称为跨度设置类

> ID：13765820
> 
> 赞同：0
> 
> 时间：2012-12-07T15:13:27.257
> 
> 标签：jquery

在我下面的代码中，我正在做菜单。

我要做的是，当用户单击菜单项时，该菜单项类需要更改为“当前”，而具有“当前”的菜单项需要更改为“菜单”。

但我就是无法让事情正常进行。

好的...当前更改为菜单。我可以通过颜色来判断。但是，当我单击从“当前”更改为“菜单”的那个时，不会出现警报。

另外，如何根据单击的数据源名称将菜单类设置为当前？你能看到这是怎么做到的吗？

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>PHP, jQuery search demo</title>
<style type="text/css">
.current{
padding:5px;
border:1px solid #000000;
background-color:white;
}
.menu{
padding:5px;
border:1px solid #000000;
background-color:red;
}
</style>

<script type="text/javascript" src="http://localhost/dev/ajax/jquery.js"></script>
<script type="text/javascript">
$(function() {

    $(".menunavi .menu").click(function() {

        alert ($(this).attr("data-feed"));
//Set the span with class="current" to class="menu"
        $(".menunavi .current").addClass("menu");
//Set the span with class="menu" to class="current" were data-feed = 'whatever was clicked'
        $(".menunavi .menu").addClass("current");

    });
});
</script>

</head>
<body>
        <div class="navigation clearfix">
            <div class="menunavi">
                    <span class="current" data-feed="photos">Photos</span>
                    <span class="menu" data-feed="watches">Watches</span>
                    <span class="menu" data-feed="audio">Audio</span>
                    <span class="menu" data-feed="sports">Sports</span>
                    <span class="menu" data-feed="drinks">Drinks</span>
                    <span class="menu" data-feed="furniture">Furniture</span>
                    <span class="menu" data-feed="computers">Computers</span>
                    <span class="menu" data-feed="stationary">Stationary</span>
                    <span class="menu" data-feed="phones">Phone</span>
                    <span class="menu" data-feed="cosmetics">Cosmetics</span>
            </div>
        </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:16:53.113

```
$('.menu,.current').click(function(){
   $(this).siblings().removeClass('current').addClass('menu');
   $(this).removeClass('menu').addClass('current');    
});​ 
```

这是一个 jsfiddle [http://jsfiddle.net/N4Gec/2/](http://jsfiddle.net/N4Gec/2/)

# php - 以批处理模式下载JPEG文件，保留路径

> ID：13765821
> 
> 赞同：-1
> 
> 时间：2012-12-07T15:13:27.023
> 
> 标签：php, batch-file, download, jpeg

我希望下载很多`jpeg`保留原始名称和路径的s。

示例：`http://www.somesite.org/path1/image1.jpg`, 应该被下载到（如果目录不存在则`www.mysite.com/path1/image1.jpg`创建目录） 这重复了很多次，从数据库的一个字段中获取原始下载站点。`"path1"`

可能吗？请记住，我不能使用`cURL`也不能使用，`wget`因为我使用的是“有限”托管服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:25:22.097

好吧，首先你必须找到一种方法来获取所有下载链接。有几种方法可以从数据库中获取数据，具体取决于它是什么数据库（mysql、exel、textfile...）

然后您需要使用 ftp 将这些文件上传到您的数据库中。删除路径的原始链接（删除 www.somesite.org）并使用您的站点 + 存储路径。

这是非常易于管理的，但我们不是在这里为您做所有的思考。**使用谷歌并先尝试方法，然后如果您遇到特定**问题再回来。

# javascript - 强制链接在新标签页中打开仍然是一种不好的礼仪吗？

> ID：13765830
> 
> 赞同：0
> 
> 时间：2012-12-07T15:14:12.713
> 
> 标签：javascript, html, tabs

现在标签式浏览已成为常态，是否仍然认为强制链接在新的“窗口”（）中打开是不礼貌的`target="_blank"`？对于我正在设计的页面，我认为这是一组链接的最佳选择，但我不想让访问我网站的任何纯粹主义者感到不安。

2012年有什么礼貌的事？

编辑：我正在谈论的链接是外部页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:19:50.547

大多数（流行）浏览器都有选项来覆盖新窗口/弹出窗口/选项卡的处理方式。
在新标签页中打开链接没有任何问题，只要它不是指向您自己网站的链接即可。

如果您要链接到自己网站上的页面，请在同一个选项卡中打开链接（所以不要提供任何链接`target`）否则，人们最终可能会在您的网站上打开大量选项卡，从而降低他们的系统速度，并且通常烦人。

就个人而言，我强制所有想要在新窗口中打开的页面改为在选项卡中打开。
具有更多“技术”经验的用户倾向于`Ctrl`+ `Click`/`Middle-Click`在新选项卡中打开页面，如果他们愿意的话。否则，他们通常会期望它们在同一页面中打开。

根据经验：

*不要强迫用户采取特定类型的行为。使您的网站按预期运行。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:20:40.563

我会说这取决于场景。我倾向于这个论点的“纯粹”端，但我知道谷歌新闻默认为新窗口/标签行为。它们并不以出色的设计而闻名，但鉴于它们是主要的网络存在，我认为可以为此功能制作案例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:17:39.063

我更喜欢强制他们在新选项卡中打开，因为它不会用另一个页面替换当前页面。但是，在不同的上下文中，您可能想要替换当前页面。在你的情况下，我认为它会很好，只要你不使用`<font face="comic_sans">`什么的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-07T15:18:52.827

你应该考虑像灯箱这样的东西。它可能适合您的页面。我在考虑弹出窗口。但那很糟糕。这些被大多数浏览器阻止，并且在移动设备上无法正常工作。

[http://lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)

或者这个： http: [//fancybox.net/](http://fancybox.net/)

# ruby-on-rails - 如何在 GEM koala 中查看自己是否登录 Facebook

> ID：13765833
> 
> 赞同：-1
> 
> 时间：2012-12-07T15:14:27.630
> 
> 标签：ruby-on-rails, facebook, koala

该应用程序是用 Ruby on Rails 编写的，使用 Koala GEM 来支持 Facebook 身份验证。

如何检查给定的用户。立即登录我们的应用程序。

我有登录密码

```
def index
  @oauth = Koala::Facebook::OAuth.new (APP_ID, SECRET, URL_US)
  @a = @oauth.url_for_oauth_code (:permissions => "email")
  redirect_to @a
end 
```

我会如果我工作考拉已经这样记录它调用redirect_to client_app_path 以及如何不redirect_to @a

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:09:19.023

你可以使用这个：

```
def index
  @oauth = Koala::Facebook::OAuth.new (APP_ID, SECRET, URL_US)
  facebook_user_id = @oauth.get_user_from_cookies(cookies)
  @a = @oauth.url_for_oauth_code (:permissions => "email")
  if facebook_user_id.present?
    redirect_to client_app_path
  else
    redirect_to @a
  end
end 
```

`@oauth.get_user_from_cookies(cookies)`如果您没有连接到 Facebook，我不确定输出，也许它是一个空字符串而不是 nil。如果是这样，请更改`if`语句以正确重定向（无论是否连接）。

在这里看到：[https](https://github.com/arsduo/koala/wiki/OAuth) ://github.com/arsduo/koala/wiki/OAuth在*Cookie Parsing*

# r - R 等效于 .first 或 .last sas 运算符

> ID：13765834
> 
> 赞同：6
> 
> 时间：2012-12-07T15:03:38.470
> 
> 标签：r, sas

有谁首先知道 SAS 的最佳 R 替代品是什么。或最后。运营商？我确实没有找到。

SAS 拥有第一。最后。自动变量，用于识别具有特定变量的相同值的组中的第一条和最后一条记录；因此在以下数据集中定义了 FIRST.model 和 LAST.model：

```
Model,SaleID,First.Model,Last.Model
Explorer,1,1,0
Explorer,2,0,0
Explorer,3,0,0
Explorer,4,0,1
Civic,5,1,0
Civic,6,0,0
Civic,7,0,1 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T21:44:51.020

听起来您正在寻找`!duplicated`，`fromLast`参数是`FALSE`or `TRUE`。

```
d <- datasets::Puromycin

d$state
# [1] treated   treated   treated   treated   treated   treated   treated  
# [8] treated   treated   treated   treated   treated   untreated untreated
#[15] untreated untreated untreated untreated untreated untreated untreated
#[22] untreated untreated
#Levels: treated untreated
!duplicated(d$state)
# [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
#[13]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
!duplicated(d$state,fromLast=TRUE)
# [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
#[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE 
```

此函数有一些警告和极端情况行为，您可以通过帮助文件 ( `?duplicated`) 找到它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T12:05:16.600

## 更新（先阅读）

如果您真的只对行索引感兴趣，也许可以直接使用`split`and `range`。以下假设您的数据集中的行名是按顺序编号的，但也可能进行调整。

```
irisFirstLast <- sapply(split(iris, iris$Species), 
                        function(x) range(as.numeric(rownames(x))))
irisFirstLast              ## Just the indices
#      setosa versicolor virginica
# [1,]      1         51       101
# [2,]     50        100       150
iris[irisFirstLast[1, ], ] ## `1` would represent "first"
#     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
# 1            5.1         3.5          1.4         0.2     setosa
# 51           7.0         3.2          4.7         1.4 versicolor
# 101          6.3         3.3          6.0         2.5  virginica
iris[irisFirstLast, ]      ## nothing would represent both first and last
#     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
# 1            5.1         3.5          1.4         0.2     setosa
# 50           5.0         3.3          1.4         0.2     setosa
# 51           7.0         3.2          4.7         1.4 versicolor
# 100          5.7         2.8          4.1         1.3 versicolor
# 101          6.3         3.3          6.0         2.5  virginica
# 150          5.9         3.0          5.1         1.8  virginica

d <- datasets::Puromycin   
dFirstLast <- sapply(split(d, d$state), 
                     function(x) range(as.numeric(rownames(x))))
dFirstLast
#      treated untreated
# [1,]       1        13
# [2,]      12        23
d[dFirstLast[2, ], ]       ## `2` would represent `last`
#    conc rate     state
# 12  1.1  200   treated
# 23  1.1  160 untreated 
```

如果使用命名行，一般方法是相同的，但您必须自己指定范围。这是一般模式：

```
datasetFirstLast <- sapply(split(dataset, dataset$groupingvariable), 
                           function(x) c(rownames(x)[1], 
                                         rownames(x)[length(rownames(x))])) 
```

### 初步答案（已编辑）

如果您有兴趣提取行而不是将行号用于其他目的，您还可以探索`data.table`. 这里有些例子：

```
library(data.table)
DT <- data.table(iris, key="Species")
DT[J(unique(Species)), mult = "first"]
#       Species Sepal.Length Sepal.Width Petal.Length Petal.Width
# 1:     setosa          5.1         3.5          1.4         0.2
# 2: versicolor          7.0         3.2          4.7         1.4
# 3:  virginica          6.3         3.3          6.0         2.5
DT[J(unique(Species)), mult = "last"]
#       Species Sepal.Length Sepal.Width Petal.Length Petal.Width
# 1:     setosa          5.0         3.3          1.4         0.2
# 2: versicolor          5.7         2.8          4.1         1.3
# 3:  virginica          5.9         3.0          5.1         1.8
DT[, .SD[c(1,.N)], by=Species]
#       Species Sepal.Length Sepal.Width Petal.Length Petal.Width
# 1:     setosa          5.1         3.5          1.4         0.2
# 2:     setosa          5.0         3.3          1.4         0.2
# 3: versicolor          7.0         3.2          4.7         1.4
# 4: versicolor          5.7         2.8          4.1         1.3
# 5:  virginica          6.3         3.3          6.0         2.5
# 6:  virginica          5.9         3.0          5.1         1.8 
```

最后一种方法非常方便。例如，如果您想要每组的前三行和后三行，您可以使用：（`DT[, .SD[c(1:3, (.N-2):.N)], by=Species]`仅供参考：`.N`表示每组的案例数。

其他有用的方法包括：

```
DT[, tail(.SD, 2), by = Species] ## last two rows of each group
DT[, head(.SD, 4), by = Species] ## first four rows of each group 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-12T13:05:58.420

带有 n=1 选项的 head 和 tail 函数结合 by 是一个不错的方法。 **请参阅**R for SAS 和 SPss 用户** (Robert Muenchen) 使用感兴趣的变量创建数据框，即最后。

```
dfby<- data.frame(df$var1, df$var2)
mylastList<-by(df,dfby,tail, n=1)
#turn into a dataframe
mylastDF<-do.call(rbind,mylastList) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-12T13:19:04.623

这是一个 dplyr 解决方案：

```
# input
dataset <- structure(list(Model = structure(c(2L, 2L, 2L, 2L, 1L, 1L, 1L
), .Label = c("Civic", "Explorer"), class = "factor"), SaleID = 1:7), .Names = c("Model", 
"SaleID"), class = "data.frame", row.names = c(NA, -7L))

# code 
library(dplyr)

dataset %>% 

  group_by(Model) %>%

  mutate(
          "First"        = row_number() == min( row_number() ),
          "Last"         = row_number() == max( row_number() )
  )

# output:

     Model SaleID First  Last
    <fctr>  <int> <lgl> <lgl>
1 Explorer      1  TRUE FALSE
2 Explorer      2 FALSE FALSE
3 Explorer      3 FALSE FALSE
4 Explorer      4 FALSE  TRUE
5    Civic      5  TRUE FALSE
6    Civic      6 FALSE FALSE
7    Civic      7 FALSE  TRUE 
```

PS：如果你没有安装 dplyr 运行：

```
install.packages("dplyr") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T21:28:20.520

下面的函数基于@Joe 对 First / Last 的描述。
该函数返回一个向量列表。

每个列表条目对应于数据框的列（即数据集的特征或变量）。
然后，在给定的列表条目中，存在与每个观察类别的第一个（或最后一个）元素相关的索引。

### 示例用法：

```
# Pass in your data frame, and indicate whether or not you want to find Last or find First. 
# Assign to the appropriate variable
first <- findFirstLast(myDF)
last  <- findFirstLast(myDF, findFirst=FALSE) 
```

### 使用示例`data(iris)`

```
data(iris)
first <- findFirstLast(iris)
last  <- findFirstLast(iris, findFirst=FALSE) 
```

### 每个物种的观察结果：

```
 first$Species
 #    setosa versicolor  virginica 
 #        1         51        101 

 last$Species
 #    setosa versicolor  virginica 
 #        50        100        150 
```

### 为每个第一次观察一个 sepcies 抓取整行

```
iris[first$Species, ]
#      Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#  1            5.1         3.5          1.4         0.2     setosa
#  51           7.0         3.2          4.7         1.4 versicolor
#  101          6.3         3.3          6.0         2.5  virginica 
```

* * *

### 函数 findFirstLast() 的代码：

```
 findFirstLast <- function(myDF, findFirst=TRUE) {
  # myDF should be a data frame or matrix 

    # By default, this function finds the first occurence of each unique value in a column
    # If instead we want to find last, set findFirst to FALSE.  This will give `maxOrMin` a value of -1
    #    finding the min of the negative indecies is the same as finding the max of the positive indecies. 
    maxOrMin <- ifelse(findFirst, 1, -1) 

    # For each column in myDF, make a list of all unique values (`levs`) and iterate over that list, 
    #   finding the min (or max) of all the indicies of where that given value appears within the column  
    apply(myDF, 2, function(colm) {
        levs <- unique(colm)
        sapply(levs, function(lev) {
          inds <- which(colm==lev)
          ifelse(length(inds)==0, NA, maxOrMin*min(inds*maxOrMin) ) 
        })   
      })
  } 
```

# r - 所有 ggplot2 命令中的异常错误

> ID：13765835
> 
> 赞同：9
> 
> 时间：2012-12-07T15:14:30.793
> 
> 标签：r, ggplot2

我什至不知道我是如何以及为什么从 ggplot 包中的任何命令接收所有这些输出的，我尝试重新安装 R 包，但到目前为止没有任何效果。

```
> library(ggplot2)
> qplot(x=1:10, y=1:10)
The following `from` values were not present in `x`: col, color, pch, cex, lty, lwd, srt, adj, bg, fg, min, max
The following `from` values were not present in `x`: col, color, pch, cex, lty, lwd, srt, adj, bg, fg, min, max
The following `from` values were not present in `x`: col, color, pch, cex, lty, lwd, srt, adj, bg, fg, min, max
The following `from` values were not present in `x`: col, color, pch, cex, lty, lwd, srt, adj, bg, fg, min, max
The following `from` values were not present in `x`: col, color, pch, cex, lty, lwd, srt, adj, bg, fg, min, max 
```

这是我的会话信息。

```
> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ggplot2_0.9.3

loaded via a namespace (and not attached):
 [1] colorspace_1.2-0   dichromat_1.2-4    digest_0.6.0       grid_2.15.2        gtable_0.1.2      
 [6] labeling_0.1       MASS_7.3-22        munsell_0.4        plyr_1.8           proto_0.3-9.2     
[11] RColorBrewer_1.0-5 reshape2_1.2.2     scales_0.2.3       stringr_0.6.2      tools_2.15.2 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-08T06:38:36.443

重新安装`ggplot2 0.9.3`表格`UK (London)`镜像解决了这个问题。

# ruby - 在 Ruby 中实现同步屏障

> ID：13765839
> 
> 赞同：9
> 
> 时间：2012-12-07T15:14:47.423
> 
> 标签：ruby, multithreading, thread-synchronization, fibers

我试图`__synchtreads()`在 Ruby 中“复制”CUDA 函数的行为。具体来说，我有一组`N`线程需要执行一些代码，然后在执行的中点相互等待，然后再继续其他业务。例如：

```
x = 0

a = Thread.new do
  x = 1
  syncthreads()  
end

b = Thread.new do 
  syncthreads()
  # x should have been changed
  raise if x == 0
end

[a,b].each { |t| t.join } 
```

我需要使用哪些工具来完成此操作？我尝试使用全局哈希，然后休眠，直到所有线程都设置了一个标志，表明它们已完成代码的第一部分。我无法让它正常工作；它导致挂起和死锁。我*认为*我需要使用 and 的组合，`Mutex`但`ConditionVariable`我不确定为什么/如何。

**编辑：** 50 次观看，没有答案！看起来像一个赏金的候选人......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T18:53:46.533

让我们实现一个同步屏障。它必须预先知道它将处理的线程数*n*。在前*n - 1*次调用`sync`屏障期间，将导致调用线程等待。调用号*n*将唤醒所有线程。

```
class Barrier
  def initialize(count)
    @mutex = Mutex.new
    @cond = ConditionVariable.new
    @count = count
  end

  def sync
    @mutex.synchronize do
      @count -= 1
      if @count > 0
        @cond.wait @mutex
      else
        @cond.broadcast
      end
    end
  end
end 
```

整体`sync`是一个临界区，即不能由两个线程同时执行。因此调用`Mutex#synchronize`.

当 的减小值为`@count`正时，线程被冻结。将互斥锁作为参数传递给调用[`ConditionVariable#wait`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/thread/rdoc/ConditionVariable.html#method-i-wait)对于防止死锁至关重要。它导致互斥锁在冻结线程之前被解锁。

一个简单的实验启动 1k 个线程并让它们将元素添加到数组中。首先，它们添加零，然后它们同步并添加一。预期的结果是一个有 2k 个元素的排序数组，其中 1k 个是 0，1k 个是 1。

```
mtx = Mutex.new
arr = []
num = 1000
barrier = Barrier.new num
num.times.map do
  Thread.start do
    mtx.synchronize { arr << 0 }
    barrier.sync
    mtx.synchronize { arr << 1 }
  end
end .map &:join;
# Prints true. See it break by deleting `barrier.sync`.
puts [
  arr.sort == arr,
  arr.count == 2 * num,
  arr.count(&:zero?) == num,
  arr.uniq == [0, 1],
].all? 
```

事实上，有[一个名为 barrier 的 gem](http://rubygems.org/gems/barrier)和我上面描述的完全一样。

最后一点，在这种情况下不要使用 sleep 来等待。这称为*忙等待*，[被认为是一种不好的做法](http://en.wikipedia.org/wiki/Busy_waiting)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T04:04:28.857

让线程相互等待可能有好处。但我认为让线程实际上在“中点”完成更干净，因为您的问题显然暗示线程需要在“中点”获得彼此的结果。干净的设计解决方案是让他们完成，交付他们的工作结果，并在这些基础上启动一组全新的线程。

# python - 在 ArrayViewEditor 中更改 Array 特征值时出现 python-error

> ID：13765840
> 
> 赞同：2
> 
> 时间：2012-12-07T15:14:57.680
> 
> 标签：python, traitsui

我是一名新手学生，使用 TraitsUI 模块来可视化数组特征。为了更新 Array 的值，我对演示代码做了一些修改，我收到了消息“IndexError: invalid index to scalar variable”

顺便说一句，我在 ArrayEditor 中使用了相同的方法并且它有效......

这个错误的原因是什么？

是否有正确的方法可以在 ArrayViewEditor 中启用 Array 值的更新？

下面是练习代码：

```
from numpy.random import random
from traits.api import HasTraits, Array,Button
from traitsui.api import View, Item
from traitsui.ui_editors.array_view_editor import ArrayViewEditor
import numpy as np

#-- ShowArray demo class -------------------------------------------------------

class ShowArray(HasTraits):

data = Array(editor = ArrayViewEditor(titles = [ 'x', 'y', 'z' ],
                                       format = '%.4f',
                                       show_index = False
                                       # Font fails with wx in OSX;
                                       #   see traitsui issue #13:
                                       # font   = 'Arial 8'
                                      ))
change = Button()
view = View(
    Item('data',show_label = False),
    Item('change',show_label = False),
    title     = 'Array Viewer',
    width     = 0.3,
    height    = 0.8,
    resizable = True
)
def _change_fired(self):
    self.data = np.arange(1,4)
#-- Run the demo ---------------------------------------------------------------

# Create the demo:
demo = ShowArray(data = random((100000, 3)))

# Run the demo (if invoked from the command line):
if __name__ == '__main__':
    demo.configure_traits() 
```

我执行了代码，然后按下“更改”按钮，出现错误：

```
Traceback (most recent call last):
File "C:\Python27\lib\site-packages\traitsui\wx\tabular_editor.py", line 167, in OnGetItemText
row, column )
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 323, in get_text
return self._result_for( 'get_text', object, trait, row, column )
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 574, in _result_for
return handler()
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 582, in <lambda>
return lambda: getattr( self, name )
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 412, in _get_text
self.object, self.name, self.row, self.column )
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 329, in get_content
return self._result_for( 'get_content', object, trait, row, column )
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 574, in _result_for
return handler()
File "C:\Python27\lib\site-packages\traitsui\tabular_adapter.py", line 582, in <lambda>
return lambda: getattr( self, name )
File "C:\Python27\lib\site-packages\traitsui\ui_editors\array_view_editor.py", line 53, in _get_content
return self.item[ self.column_id ]
IndexError: invalid index to scalar variable. 
```

Python 2.7.3，32 位。特质ui-4.2.0

# internationalization - lwuit 更改语言并应用它

> ID：13765841
> 
> 赞同：0
> 
> 时间：2012-12-07T15:15:00.740
> 
> 标签：internationalization, lwuit, codenameone

我有一个表格来更改我的 j2me 应用程序的语言。此应用程序由代号创建。

我创建了一个班级，并用两种语言英语和波斯语将我所有的话都写进了它。我用这段代码改变语言：

```
UIManager.getInstance().setResourceBundle(new CommonSettings().getFarsi()); 
```

我怎样才能将这种语言生动地应用到这个表单的所有组件上，或者不退出这个表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T09:38:12.363

您需要重新创建表单。`reloadForm()`如果您在状态机中调用该方法，GUI 构建器可以自动为您执行此操作。

# python - bash 脚本的 Python subprocess.check_call 不等待子进程完成

> ID：13765845
> 
> 赞同：2
> 
> 时间：2012-12-07T15:15:03.937
> 
> 标签：python, bash, subprocess

```
N = 50000
with open('input', 'w') as f:
    for i in range(N):
        f.write(str(i) + '\n')

run_command = '/bin/bash -e -o pipefail -c "((sort | tee >/dev/null >(cat | (tee >/dev/null >(sort >&3)))) <input 3>output)& wait"'

subprocess.check_call(run_command, shell=True)

time.sleep(sleep_time)

print sh.wc("output", "-l") 
```

运行这段 python 代码`sleep_time = 0`返回 0，但`sleep_time = 1`返回 50000。

原因似乎在于没有等待 bash 子进程完成。可能，我对该`wait`功能的使用不正确。我做了实验，但没有找到令人满意的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:47:14.163

当您`/bin/bash`的命令将在子 shell 中运行时，您将立即退出该进程。此外，您在该子 shell 中运行的命令也在后台运行，因为`&`最后，您可以将`$!`其作为参数传递`wait`给它，以*等待*最后一个后台进程退出。

# c# - 在 R* 树中插入新叶子

> ID：13765851
> 
> 赞同：3
> 
> 时间：2012-12-07T15:15:14.767
> 
> 标签：c#, java, gis, spatial-index, r-tree

R* Tree的插入算法的步骤是什么？

注意：我希望能够通过插入来构造树。无论我选择什么条件来选择最佳叶子，它总是给我具有最大重叠和最大面积覆盖的垃圾树（在树的每一级添加后测试最小重叠区域，在树的每一级的最小扩展率等） .

现在这个 R* 树是如何通过如此精美的插入构建的（来自[Wikipedia](http://en.wikipedia.org/wiki/R*_tree)）：

![在此处输入图像描述](../Images/7208094724c8634519372a4cee81f5d1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T09:13:38.413

R*-Tree 不仅仅是一种不同的插入叶策略。

随地吐痰策略（周边！）同样重要，因为它更喜欢“二次”页面，而不是其他策略（如 Ang-Tan）产生的切片。

此外，这可能是获得更漂亮树的关键，R*-tree 执行一种重新平衡来积极避免坏分裂。当一个节点过满时，它不会分裂，而是删除最少的中心元素（或子树 - 您在所有级别都需要它）并重新插入它们。这并不总能防止溢出，但它可能会减少树中的重叠。

但是当然你可以在实现中犯各种错误，R-tree 仍然可以工作，只是因为结构不好而表现不佳。你的树有多坏，你有截图吗？

# objective-c - iOS Settings Bundle 奇怪地消失了

> ID：13765852
> 
> 赞同：2
> 
> 时间：2012-12-07T15:15:16.403
> 
> 标签：objective-c, ios, plist, settings.bundle

我正在开发一些涉及连接到服务器的 iOS 应用程序，并且有一个内置的 Settings.Bundle ，它将主机名存储到该服务器。这个应用程序是由其他人准备的，到现在已经有一年多了。无论它们如何工作，设置包和连接总是完美无缺。今天下午测试时它仍然有效。然而午饭后我回来了，没有任何工作了，我对问题可能是什么一无所知。

午餐前，我在使用具有相同包标识符的应用程序时遇到了一些问题，因此我在 info.plist 中更改了该应用程序的包标识符，我一直在使用它来控制这些问题。

此外，我一直在尝试创建一个 .ipa 文件用于测试目的。所以我正忙于归档应用程序。该应用程序有一个外部库（zxing）来扫描二维码以实现轻松的登录功能。我的问题是如何将存档文件从通用 xcode 存档获取到真正的 ios 应用存档。我按照本指南（[http://pulkitsinghal.blogspot.nl/2012/03/wrong-archive-ios-app-archive-vs.html](http://pulkitsinghal.blogspot.nl/2012/03/wrong-archive-ios-app-archive-vs.html)）成功了。这涉及在我的 Zxing lib 的 Target>Build Settings 中将“Skip Install”设置更改为 YES。

一切都做得很好。除了，现在我在我的模拟器上运行我的应用程序，我无法再连接到服务器了。主机名似乎是 (null)，这在我的 Settings.Bundle 中进行了描述。

我还没有触及创建该设置项的程序。那么它怎么会在我身上消失呢？

是否可以通过更改我的主项目和 zxing lib 中的构建设置的包标识符来实现？会不会是别的东西？

关于我之前的更改可能如何影响 Settings.bundle 消失的任何想法？

（我可以提供任何类型的代码。但 atm 我不知道要发布什么）

一个可能的解决方案当然是将事情恢复到早期的版本，但我不知道是什么让它首先消失。或者是什么让它消失。并且不想失去几天的工作价值。

# java - Java EE 中已弃用的实体 Bean 与 @Entity 注释之间的关系？

> ID：13765853
> 
> 赞同：2
> 
> 时间：2012-12-07T15:15:16.153
> 
> 标签：java, jpa, annotations, entity-bean

Java 中有很多豆类和蔬菜，这让我有些困惑。我已经阅读了几本关于 Java EE 6 的新出版书籍，它们都说“实体 bean”已被修剪（“已弃用”对于尚未被 Java 框架洗脑的新手来说是正确的术语）。作者很快就说他们根本不会触及“实体豆”的主题。他们说它已被JPA取代。然后他们写了一两章关于对象关系映射并用`@Entity`. 他们还在这里和那里对字段进行一些注释，以在默认值不够时指定映射配置。

但是，通常当我们对 bean 类进行注解时，我们会将该注解作为类型前缀。例如，注释`@Stateful`使 bean 成为**有状态**会话 bean。这是否意味着`@Entity`注释使 bean 成为**实体**bean - 他们所说的不推荐使用的东西！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:31:06.323

@Entity 注释（映射）类与 J2EE 架构模型中的“已弃用”实体 bean 完全无关。反正也不是。

您正在阅读的那些“已弃用”的实体 bean 仍然存在，只是它们已被广泛重构，以至于对于习惯于老式 J2EE 的人来说几乎无法识别。

在新的 Java EE 模型中，服务和模型类被正确分离，JPA 注释的 @Entity bean 用作模型，@Stateless 或 @Stateful 会话 bean 用作服务类。

要记住的关键是*关注点分离*。

# php - 页面加载后的 JQuery .addclass()

> ID：13765855
> 
> 赞同：4
> 
> 时间：2012-12-07T15:15:29.243
> 
> 标签：php, load, addclass, removeclass

我将类分配给元素，但在加载页面后该类被删除。

我在我的 script.js 中使用了这个函数

```
$('#main-nav li ul li a').click(function(){
    $('#main-nav li ul li').children().removeClass('current');
    $(this).addClass('current');
}); 
```

这在我的 PHP 视图中：

```
 <ul id="main-nav">  <!-- Accordion Menu -->
    <li>
       <a href="#" class="nav-top-item no-submenu"> <!-- Add the class "no-submenu" to menu items with no sub menu -->
    On site
       </a>       
    </li>

    <li> 
       <a href="#" class="nav-top-item current"> <!-- Add the class "current" to current menu item -->
    Programs
       </a>
   <ul>
       <li><a href="<?php echo site_url('admin/country_management')?>">Manage country</a></li>
       <li><a href="<?php echo site_url('admin/channel_management')?>">Manage channel</a></li>
       <li><a href="#">Manage Comments</a></li>
       <li><a href="#">Manage Categories</a></li>
    </ul>
       </li>

</ul> <!-- End #main-nav --> 
```

如果我使用它`<li><a href="<?php echo site_url('...')?>">Manage</a></li>`，则添加类电流，但在移除负载后。

如果我在加载页面后使用 php 代码或有任何解决方案，我该如何添加类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-07-15T02:14:55.067

jQuery 是脚本语言......当加载页面时，它肯定会删除你以前的功能，因为点击事件不会触发，所以它不会工作......

加载页面后，只需通过 PHP 放置一些逻辑 ....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:18:27.160

使用 JQuery，您可以在页面加载时执行代码：

```
$(document).ready(function(){
    // your code here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:50:45.450

这应该工作：

```
$(document).ready(function(){
    $('#main-nav li > a').click(function(e){
        $('#main-nav a').removeClass('current');
        $(e.target).addClass('current');
    });

}); 
```

如果它不起作用，`</body>`请在文档末尾之前尝试此脚本块：

```
<script type="text/javascript">
$(function(){
    $('#main-nav li > a').click(function(e){
        $('#main-nav a').removeClass('current');
        $(e.target).addClass('current');
    });
});
</script> 
```

这将在所有 html 由 php 呈现后强制执行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-10T05:25:18.080

首先将您的函数包装在 a 中`$(document). ready(function () {})`并使用其中的`$('#main-nav'). on('click', 'li > a', function () {} )`方法。`. on()`最好将事件侦听器附加到动态加载的元素。

# wordpress - 如何以编程方式从 wordpress 环境外部将用户添加到 wordpress

> ID：13765856
> 
> 赞同：0
> 
> 时间：2012-12-07T15:15:34.593
> 
> 标签：wordpress, bulkinsert

我正在编写一个脚本来将数据从文本文件导入 wordpress。

数据需要访问帖子、用户、自定义字段和帖子元数据。

要导入它，我在用户表中查找作者，如果存在则获取 ID（如果不存在则无法生成），然后插入帖子数据，添加帖子元并获取远程图像也可以将它们插入并添加为发布元数据。

我正在从客户端在 ASP.net 中拥有的现有站点复制数据并将其拉入 wordpress 中，但是，我无法完全弄清楚如何以编程方式添加用户。我的意图是在不使用 wordpress 函数调用公共页面的情况下执行此操作，而只是尝试复制使用的适当 SQL。

有人可以指导我执行查询以插入新用户所需的功能吗？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:54:55.580

插入一个新用户。（假设新数据库使用标准表前缀'wp_'）

```
INSERT INTO
  wp_users
    (user_login, 
     user_pass, 
     user_nicename, 
     user_email, 
     user_url, 
     user_status, 
     display_name, 
     user_registered)
  VALUES
    ('$user_login', 
     '$user_pass', 
     '$user_nicename', 
     '$user_email', 
     '$user_url', 
     '$user_status', 
     '$display_name', 
     NOW()) 
```

获取插入 ID，然后设置用户角色和级别，例如订阅者

```
$capabilities = serialize(array('subscriber'));

INSERT INTO
  wp_usermeta
  (user_id, meta_key, meta_value)
VALUES
  ('$insert_id', 'wp_capabilities', '$capabilities')

INSERT INTO
  wp_usermeta
  (user_id, meta_key, meta_value)
VALUES
  ('$insert_id', 'wp_user_level', '0') 
```

# javascript - Jquery getJson 页面永远不会完成加载

> ID：13765859
> 
> 赞同：2
> 
> 时间：2012-12-07T15:15:54.453
> 
> 标签：javascript, jquery, jsonp

以下代码调用 JSON 并显示结果，但页面似乎从未完成加载。浏览器仍然说连接和查看源从不显示任何想法？

```
<script>
function getroadcondFiles () {
    jQuery.support.cors = true
//  electdiv=electdiv+"</center><br>";
    $.getJSON('http://example.com?callback=?',function(dataa){
//   console.log("before each");
     //console.log(dataa.result.totalCount);
     $.each(dataa.roadid, function(i,item){
    document.write(item.desc+"<br>");
    document.write(item.overstat[0]+"<br>");
    document.write(item.weatherstat[0]+"<br>");
    document.write(item.pavementstat[0]+"<br>");
    });

    ;}).error(function(jqXHR, textStatus, errorThrown) { alert(errorThrown); });
    ;}
</script>
</head>
<body>
<script>
$=jQuery;
getroadcondFiles();
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:18:54.257

检查[`$.ajaxError`](http://api.jquery.com/ajaxError/)或使用浏览器的调试器以更深入地了解故障。在不知道 json 调用是否失败（除了“这不起作用”之外没有错误）的情况下，无法判断失败的原因。

我建议使用`$.ajax`和`error`属性来确定查询是否出现问题。你会发现它是查询还是脚本，你会更好地了解如何纠正问题。

它甚至可能不是 ajax 失败，它可能是另一个仍在处理的脚本。再一次，使用浏览器的调试工具来更深入地了解真正的原始问题。

# jqplot - jqplot DateAxisRenderer 和时间戳在 IE/FF 中不起作用

> ID：13765862
> 
> 赞同：0
> 
> 时间：2012-12-07T15:16:05.877
> 
> 标签：jqplot

我以这种格式使用 xaxis 的时间戳值：`var timestamp = 1201662065000`

在 Chrome 下它可以工作，但`FF.17/IE8`它只渲染带有 y 轴的图表网格，但它不渲染 x 轴和系列（绘图）。所以它没有给出任何错误，但它不会呈现我的图表......

我认为它必须与日期解析有关，也许它在 FF/IE 中有所不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T09:24:01.373

你必须做错事。这是我为您展示的一个示例：http: [//jsfiddle.net/Bouillou/WdLnm/291/](http://jsfiddle.net/Bouillou/WdLnm/291/)

在某些情况下，Chrome 是一个非常好的浏览器，它可以自动纠正 html 错误（如缺少结束标记）或异常，如在单元格外部的表格中定义表单（）。其他浏览器不会执行代码。

我的建议是：使用 HTML 验证器测试您的代码。

这是 xaxis 代码部分：

```
 xaxis:
            {
                label: 'Dates',
                renderer: $.jqplot.DateAxisRenderer,
                rendererOptions: { tickRenderer: $.jqplot.CanvasAxisTickRenderer },
                tickOptions: {
                    formatString: '%d/%m/%Y',
                    angle: -30,
                    fontFamily: 'Arial',
                    fontSize: '13px',
                    fontWeight: 'bold'
                },
                min: "01-01-2012",
                tickInterval: '2 month',
                labelOptions: {
                    fontFamily: 'Arial',
                    fontSize: '14pt',
                    fontWeight: 'bold',
                    textColor: '#0070A3'
                }
            }, 
```

和使用的数据：

```
 var data = [[1325376000000, 1], [1350864000000, 2], [1354320000000, 3]]; 
```

# jquery - Chrome 扩展 XHR 不工作

> ID：13765863
> 
> 赞同：4
> 
> 时间：2012-12-07T15:16:15.023
> 
> 标签：jquery, google-chrome-extension, xmlhttprequest

:)

我正在将 Chrome 加载到 Facebook 中，并向我自己的网站发出一个简单的 JQuery GET 请求。调用 GET 请求时，我**在控制台中**收到以下错误...

```
"Refused to connect to 'https://www.istyla.com/Popup/t2.php' because it violates the
following Content Security Policy directive: "connect-src https://*.facebook.com 
http://*.facebook.com https://*.fbcdn.net http://*.fbcdn.net *.facebook.net 
*.spotilocal.com:* https://*.akamaihd.net ws://*.facebook.com:* http://*.akamaihd.net"." 
```

这突然发生了。它昨天工作...

这是我的 Chrome 扩展清单的一部分，其中包含**CSP 定义**：

```
"content_security_policy": "default-src 'self'; script-src 'self'; object-src 'self'; connect-src *" 
```

这是我的**GET 请求**（通过内容脚本加载 - JQuery 也作为单独的内容脚本加载）：

```
$.get("https://www.istyla.com/Popup/t2.php" + c, function (d) {
    //do my other stuff here
} 
```

顺便说一句... t2.php 确实允许所有来源。是 Facebook 在他们的网站上设置 CSP 吗？如何通过 JQuery GET 连接到我的 URL？

感谢您的任何建议... :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T19:21:37.747

我的脚本也有同样的问题。我将所有 AJAX 调用移至后台脚本。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-12-07T15:20:59.207

我认为直接 .get 不会跨域工作。您可以尝试使用 $.jsonp 吗？ [http://www.jquery4u.com/json/jsonp-examples/](http://www.jquery4u.com/json/jsonp-examples/)

# php - 发生算法

> ID：13765867
> 
> 赞同：0
> 
> 时间：2012-12-07T15:16:35.213
> 
> 标签：php, algorithm

有人可以帮我弄清楚如何获得当前一周是否在事件中。

我有以下变量： start_date ， end_date ， current_date week_occurrence 。

我有一个返回发生次数的函数

```
// will return the number of weeks between start - end
function get_weeks_count($start , $end) {
       return floor(abs(strtotime($start) - strtotime($end)) / 604800);    
    } 
```

现在我必须知道当前日期是否有效。

我有一个发生 = 每 N 周的条目。如何知道 N 是有效的。

**不那么抽象：**如果我们在 12 月并且每 3 周发生一次，则 start_date 是第 1 天，end_date 是 12 月 30 日）

它将返回：

```
 TRUE  for 1st week

 FALSE for the second week

 FALSE for the third week

 TRUE  for the last week 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:47:36.640

这是我解决问题的方法 - 这适用于每 $n 周发生一次。

```
$n = $week_occurrence;
$occurrence = false;

// To begin, get the number of weeks between the start and current dates.
$weeks = get_weeks_count($start_date , $current_date); // Using the function you already have

// Now check if $weeks == 0
if ($weeks == 0) {
    $occurrence = true;

// If not, check if $weeks is divisible by $n without any remainder
} else if ($weeks % $n == 0) {
    $occurrence = true;
} 
```

如果`$occurrence`仍然为假，则当前周不在正确的发生范围内，如果为真，则该周确实在范围内。

Effectively all we're doing here is checking that the current number of weeks since the start date is either equal to zero (we're still in the first week) or is divisible by the ocurrence without a remainder.

I hope this helps.

P.S. I've only answered the specific question that you asked. However, if you would like to know more about how this premiss could be used for scheduling etc., then feel free to ask and I'll expand on my answer accordingly

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:52:59.607

A combination of [DateTime](http://php.net/datetime) and [DateInterval](http://php.net/dateinterval) should help you achieve this easily.

```
function get_occurences(DateTime $start, DateTime $end, DateInterval $period) {
    $weeks = array();
    $cursor = clone $start;
    $rate = DateInterval::createFromDateString('1 week');
    do {
        /* We can check to see if it's within the occurrence period */
        if ($cursor == $start) {
            $isOccurrence = true;
            $start->add($period); // Move the start period up
        } else {
            $isOccurrence = false;
        }
        $weeks[$cursor->format('Y-m-d')] = $isOccurrence;
    } while($cursor->add($rate) < $end);
    return $weeks;
}

$period = DateInterval::createFromDateString('3 week');
$start = new DateTime('2012-12-01');
$end = new DateTime('2012-12-30');
/* From this array you can get both the number of occurrences as well as their respective dates*/
var_dump(get_occurences($start, $end, $period));

/** Output:

    array(5) {
      ["2012-12-01"]=>
      bool(true)
      ["2012-12-08"]=>
      bool(false)
      ["2012-12-15"]=>
      bool(false)
      ["2012-12-22"]=>
      bool(true)
      ["2012-12-29"]=>
      bool(false)
    }

*/ 
```

# ios - iOS：单个字符的 sizeWithFont 与字符串不同？

> ID：13765875
> 
> 赞同：1
> 
> 时间：2012-12-07T15:16:56.673
> 
> 标签：ios, position, width, uilabel, character

我正在尝试确定 UILabel 中字符的精确位置，例如：

(UILabel *)label.text = @"你好！";

我想确定'o'的位置。我认为我可以使用 sizeWithFont 将所有前面字符（或整个前面的字符串）的宽度相加。我得到的宽度值比它应该的值大了大约 10%。将单个字母的宽度相加（即 [@"H" sizeWithFont...] + [@"e" sizeWithFont...] + l... + l...）比 [@"Hell" sizeWithFont 累积更多的错误...]。

有没有一种方法可以准确地确定字符串中单个字形的位置？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:54:51.963

是的，但不在 UILabel 中，也不使用 sizeWithFont:。

我最近与 Apple Developer Support 合作，显然 sizeWithFont: 实际上是一个近似值。当您的文本 (1) 跨越多行并且 (2) 包含非拉丁字符（即中文、阿拉伯语）时，它会变得不那么准确，这两者都会导致 sizeWithFont: 无法捕获行间距变化。因此，如果您想要 100% 的准确率，请不要依赖此方法。

您可以做以下两件事：

(1) 使用不可编辑的 UITextView 代替 UILabel。这将支持 UITextInput 协议方法[firstRectForRange:](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITextInput_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITextInput/firstRectForRange:)，您可以使用它来获取所需字符的矩形。你可以使用这样的方法：

```
- (CGRect)rectOfCharacterAtIndex:(NSUInteger)characterIndex inTextView:(UITextView *)textView
{
    // set the beginning position to the index of the character
    UITextPosition *beginningPosition = [textView positionFromPosition:textView.beginningOfDocument offset:characterIndex];
    // set the end position to the index of the character plus 1
    UITextPosition *endPosition = [textView positionFromPosition:beginningPosition offset:1];
    // get the text range between these two positions
    UITextRange *characterTextRange = [textView textRangeFromPosition:beginningPosition toPosition:endPosition]];
    // get the rect of the character
    CGRect rectOfCharacter = [textView firstRectForRange:characterTextRange];
    // return the rect, converted from the text input view (unless you want it to be relative the text input view)
    return [textView convertRect:rectOfCharacter fromView:textView.textInputView];
} 
```

要使用它（假设屏幕上已经有一个名为 myTextView 的 UITextView），您可以这样做：

```
myTextView.text = @"Hello!";
CGRect rectOfOCharacter = [self rectOfCharacterAtIndex:4 inTextView:myTextView];
// do whatever you need with rectOfOCharacter 
```

仅使用此方法确定*ONE*字符的矩形。原因是在换行的情况下， firstRectForRange: 只返回第一行的矩形，在换行之前。

另外，如果您要经常使用它，请考虑将上述方法添加为 UITextView 类别。不要忘记添加错误处理！

[您可以通过阅读适用于 iOS 的文本、Web 和编辑编程指南来](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/CustomTextProcessing/CustomTextProcessing.html%23//apple_ref/doc/uid/TP40009542-CH4-SW43)了解有关 firstRectForRange: 如何“在后台”工作的更多信息。

(2) 通过继承 UIView 并使用 Core Text 渲染字符串来创建自己的 UILabel。由于您正在进行渲染，因此您将能够获得字符的位置。这种方法需要做很多工作，只有在你真的需要它时才值得（当然，我不知道你的应用程序的其他需求）。如果您不确定这将如何工作，我建议使用第一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:25:50.007

好吧，字体现在很聪明，并且考虑到字符的位置与其前一个字符。

这是一个关于字母起始位置的示例`o`：

```
NSRange posRange = [hello rangeOfString:@"o"];
NSString *substring = [hello substringToIndex:posRange.location];
CGSize size = [substring sizeWithFont:[UIFont systemFontOfSize:14.0f]]; 
```

不，您可以对包含字母的字符串执行相同的操作，`o`并减去在没有字母的字符串中找到的大小`o`。这应该给出字母的一个很好的起始位置和大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T11:49:44.603

在 ios6 中，您可以使用属性字符串

```
 NSMutableAttributedString *titleText2 = [[NSMutableAttributedString alloc] initWithString:strHello];
    NSRange posRange = [hello rangeOfString:@"o"];

    [titleText2 addAttributes:[NSDictionary dictionaryWithObject:[UIFont systemFontOfSize:14.0f] forKey:NSFontAttributeName] range:NameRange]; 
```

并使用此属性字符串设置您的 textView

# php - PHP 函数没有被调用，我是否遗漏了一些明显的东西？

> ID：13765876
> 
> 赞同：2
> 
> 时间：2012-12-07T15:17:08.453
> 
> 标签：php, jquery, ajax, function

我想我需要第二双眼睛。

我有一些 ajax 调用 php 文件，它返回 json。这一切都很好。然后我会提醒我返回的用于测试目的的数据元素。在这样做时，我缩小了我的功能没有被调用。

```
<?php

// database functions
$response = array();
$count = 1;

// connect to db
function connect() {   
$response['alert'] = 'connect ran'; // does not get alerted
}

// loop through query string
foreach ($_POST as $key => $value) {

switch ($key) {
    case 'connect':
        $response['alert'] = 'case ran';
        if ($value == 'true') {
        $response['alert'] = 'if ran'; // this is what gets alerted, should be overwriten by 'connect ran'
            connect(); // function call does not work?
        } else {
            $response['alert'] = 'false';
            $mysqli->close();
        }
        break;

        case 'otherstuff':
        break;
}
++$count;
}

$response['count'] = $count;

echo json_encode($response);

?> 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T15:19:46.240

你的`$response`变量超出[范围](http://php.net/manual/en/language.variables.scope.php)..`global`在你的函数中使用关键字来注册你的外部变量

```
function connect() {
    global $response;    
    $response['alert'] = 'connect ran';
} 
```

或 SDC 的编辑：

```
function connect($response) { 
    $response['alert'] = 'connect ran';
}

connect($response); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:24:45.497

实际上，您定义了结果变量，但使用了另一种类型，并且顶部还有另一个结果变量，因此您将数据放入 $result[] 但您尝试使用 $result ，因此您的代码可能不会给您预期的结果。

# forms - 在 R 中使用 mapply 获取矩阵形式的结果

> ID：13765878
> 
> 赞同：1
> 
> 时间：2012-12-07T15:17:15.120
> 
> 标签：forms, r, matrix

我`mapply`在两个矩阵上使用我的函数，但最终结果是一个向量。我试过使用`SIMPLIFY = TRUE`没有成功。

有没有办法让我以矩阵的形式得到我的结果而不必构造？

提前致谢。

```
> a=matrix(c(0,2, 0, 0, 1, 3, 0, 3, 2, 0, 3, 5, 0, 4, 0, 0),ncol=4)
> a
 [,1] [,2] [,3] [,4]
[1,]    0    1    2    0
[2,]    2    3    0    4
[3,]    0    0    3    0
[4,]    0    3    5    0

> ab=matrix(c(4,2, 0, 7, 1, 4, 5, 3, 2, 6, 3, 7, 1, 2, 1, 2),ncol=4)
> ab
 [,1] [,2] [,3] [,4]
[1,]    4    1    2    1
[2,]    2    4    6    2
[3,]    0    5    3    1
[4,]    7    3    7    2
> mapply(l0.0025,a,ab)
 [1] 3.9900 0.0000 0.0000 6.9825 0.0000 0.9975 4.9875 0.0000 
 [9] 0.0000 5.9850 0.0000 1.9950 0.9975 0.0050 0.9975 1.9950
l0.0025 <- function(x, y) { 
      if (x-y >= 0) {0.0025*(x-y)} else {-(1-0.0025)*(x-y)} 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:14:07.313

没有必要`mapply`。你得到你想要的：

```
l0.0025 <- function(x,y){
    tmp <- x-y
    tmp * ifelse(tmp>0,0.0025,-0.9975)        
}
> l0.0025(a,ab)
       [,1]   [,2]  [,3]   [,4]
[1,] 3.9900 0.0000 0.000 0.9975
[2,] 0.0000 0.9975 5.985 0.0050
[3,] 0.0000 4.9875 0.000 0.9975
[4,] 6.9825 0.0000 1.995 1.9950 
```

您必须记住这`ifelse()`是获取条件的矢量化方式，并且 R 中的运算符以矢量化方式工作。因此，您可以以不需要类似循环的结构的方式构建您的计算。

如果要使用 mapply，还必须考虑到它将矩阵视为向量。这就是它不返回矩阵的原因。

# extjs - Sencha 面板没有崩溃

> ID：13765886
> 
> 赞同：0
> 
> 时间：2012-12-07T15:17:53.307
> 
> 标签：extjs, panel, extjs4.1, collapse

在选项卡面板内，我有一个“可折叠”= true 的面板。

当我单击图标展开时，没有任何反应。只有当我更改选项卡然后返回到前一个选项卡时，才会触发展开事件并且面板正确展开。尝试崩溃时也会发生同样的奇怪行为。

我动态构建选项卡面板和面板。

这就是我构建标签面板的方式：

```
HnBSenchaUIGeneratorClass.prototype.GenTabPanel = function (modelConfigData, targetId) {    var hnb = this;

var _layout = "auto";
if (modelConfigData.Layout) {
    _layout = (Ext.decode(modelConfigData.Layout, true) == null) ? modelConfigData.Layout : Ext.decode(modelConfigData.Layout, true);
} else {
    _layout = "auto";
}

var tabPanel = new Ext.create('Ext.tab.Panel', {
    title: modelConfigData.WindowTitle || modelConfigData.Title,
    layout: _layout,
    closable: false,
    autoScroll: true,
    activeTab: modelConfigData.ActiveTab || 0,
    tabPosition: modelConfigData.TabPosition || 'top',
    listeners: {
        beforetabchange: {
            fn: function (tabPanel, newCard, oldCard, eOpts) {
                //TODO: validar se isto não invalida ou interfere algum outro processo ou validação.
                newCard.suspendLayout = true;
            }
        }
    }
});

if (modelConfigData.ObjId != undefined) tabPanel["objId"] = modelConfigData.ObjId;

if (modelConfigData.BodyStyle != undefined) tabPanel["bodyStyle"] = modelConfigData.BodyStyle;
if (modelConfigData.Closable != undefined) tabPanel["closable"] = modelConfigData.Closable;
if (modelConfigData.Flex != undefined) tabPanel["flex"] = modelConfigData.Flex;

if (modelConfigData.Border != undefined) tabPanel["border"] = modelConfigData.Border;
if (modelConfigData.Style != undefined) tabPanel["style"] = modelConfigData.Style;
if (modelConfigData.Height != undefined) tabPanel["height"] = modelConfigData.Height;
if (modelConfigData.Width != undefined) tabPanel["width"] = modelConfigData.Width;
if (modelConfigData.Defaults != undefined) tabPanel["defaults"] = modelConfigData.Defaults;
if (modelConfigData.Margin != undefined) tabPanel["margin"] = modelConfigData.Margin;
if (modelConfigData.Padding != undefined) tabPanel["padding"] = modelConfigData.Padding;
if (modelConfigData.Property != undefined) tabPanel["dataField"] = modelConfigData.Property;
if (modelConfigData.Anchor != undefined) tabPanel["anchor"] = modelConfigData.Anchor;
if (modelConfigData.Rowspan != undefined) tabPanel["rowspan"] = modelConfigData.Rowspan;
if (modelConfigData.Colspan != undefined) tabPanel["colspan"] = modelConfigData.Colspan;
if (modelConfigData.Disabled != undefined) tabPanel["disabled"] = modelConfigData.Disabled;

var obj;
Ext.Array.each(modelConfigData.Items, function () {
    if (this.DontRender === undefined || (this.DontRender != true && this.DontRender.toString().toUpperCase() != "TRUE")) {
        switch (this.Type) {
            case "panel":
                obj = hnb.GenPanel(this, targetId);
                break;
            case "form":
                obj = hnb.GenForm(this, targetId);
                break;
            case "list":
                obj = hnb.GenGrid(this, targetId);
                break;
            case "CommandExecution":
                obj = CreateObjectByCommandExecution(this, targetId);
                break;
            default:
                break;
        }
        if (obj) {
            if (this.ObjId != undefined)
                obj["objId"] = this.ObjId;

            var SelfDisabled = false;
            if (this.SelfDisabled != undefined) {
                if (this.SelfDisabled == true) {
                    SelfDisabled = true;
                }
            }
            obj.SelfDisabled = SelfDisabled;

            if (this.Disabled != undefined)
                obj.disabled = (this.Disabled.toString().toUpperCase() === "TRUE");

            tabPanel.add(obj);
        }
    }
});
return tabPanel; 
```

}

这就是我创建面板的方式：

```
HnBSenchaUIGeneratorClass.prototype.GenPanel = function (modelConfigData, targetId) {    var hnb = this;

var _layout = "auto";
if (modelConfigData.Layout) {
    _layout = (Ext.decode(modelConfigData.Layout, true) == null) ? modelConfigData.Layout : Ext.decode(modelConfigData.Layout, true);
} else {
    _layout = "auto";
}

var panel = new Ext.create('Ext.panel.Panel', {
    itemId: modelConfigData.ItemId,
    title: modelConfigData.WindowTitle || modelConfigData.Title,
    layout: _layout,
    closable: false,
    controlUrl: modelConfigData.ServiceURL
    //autoScroll: true
    //,border: modelConfigData.Border,
    //flex: modelConfigData.Flex
    //, bodyStyle: modelConfigData.BodyStyle //'background-color:green !important;'
});

if (modelConfigData.ObjId != undefined) {
    panel["objId"] = modelConfigData.ObjId;
    panel["itemId"] = modelConfigData.ObjId;
}

if (modelConfigData.Flex != undefined) panel["flex"] = modelConfigData.Flex;
if (modelConfigData.BodyStyle != undefined) panel["bodyStyle"] = modelConfigData.BodyStyle;
if (modelConfigData.Border != undefined) panel["border"] = modelConfigData.Border;
if (modelConfigData.Style != undefined) panel["style"] = modelConfigData.Style;
if (modelConfigData.Height != undefined) panel["height"] = modelConfigData.Height;
if (modelConfigData.Width != undefined) panel["width"] = modelConfigData.Width;
if (modelConfigData.Defaults != undefined) panel["defaults"] = modelConfigData.Defaults;

if (modelConfigData.Collapsible != undefined) panel["collapsible"] = modelConfigData.Collapsible;
if (modelConfigData.Collapsed != undefined) panel["collapsed"] = modelConfigData.Collapsed;
if (modelConfigData.Region != undefined) panel["region"] = modelConfigData.Region;
if (modelConfigData.Cmargins != undefined) panel["cmargins"] = modelConfigData.Cmargins;
if (modelConfigData.MinSize != undefined) panel["minSize"] = modelConfigData.MinSize;
if (modelConfigData.MaxSize != undefined) panel["maxSize"] = modelConfigData.MaxSize;

if (modelConfigData.Margin != undefined) panel["margin"] = modelConfigData.Margin;
if (modelConfigData.Padding != undefined) panel["padding"] = modelConfigData.Padding;
if (modelConfigData.Property != undefined) panel["dataField"] = modelConfigData.Property;
if (modelConfigData.Anchor != undefined) panel["anchor"] = modelConfigData.Anchor;
if (modelConfigData.Rowspan != undefined) panel["rowspan"] = modelConfigData.Rowspan;
if (modelConfigData.Colspan != undefined) panel["colspan"] = modelConfigData.Colspan;
if (modelConfigData.Disabled != undefined) panel["disabled"] = (modelConfigData.Disabled.toString().toUpperCase() === "TRUE");

addEvent(modelConfigData, panel);

var modelFields = [];
var panelFields = [];
Ext.Array.each(modelConfigData.Items, function () {
    var aux;
    if (this.DontRender === undefined || (this.DontRender != true && this.DontRender.toString().toUpperCase() != "TRUE")) {
        if (this.Type == "form") {
            aux = hnb.GenForm(this);
        }
        else {
            aux = hnb.CreateSenchaUIObject(this, panel, modelFields);
        }
    }

    if (aux) {
        panelFields.push(aux);
    }
});
panel.add(panelFields);

return panel; 
```

}

关于为什么会发生这种情况的任何想法？

我正在使用 Sencha 4.1.2a。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T13:22:03.357

我发现是什么阻止了这两个事件。

在创建选项卡面板时，我为“beforetabchange”设置了一个侦听器，我在其中执行了此操作：`newCard.suspendLayout = true;`

这是另一个屏幕所需要的，所以当我不想执行上述操作时，我基本上会添加一个“额外”变量。最后它看起来像这样：

```
listeners: {
        beforetabchange: {
            fn: function (tabPanel, newCard, oldCard, eOpts) {
                if (tabPanel.enableSuspendLayout === true) {
                    newCard.suspendLayout = true;
                }
            }
        }
    } 
```

# python - 更改字典中的列表项

> ID：13765891
> 
> 赞同：0
> 
> 时间：2012-12-07T15:18:29.860
> 
> 标签：python, django

我的 django 项目中有一个这样的字典，它对应于一个配置字段：

```
{u'active': True,
 u'alert': {u'item_sent': True,
            u'emails': [u'test@test.com', u'test@test.com'],
            u'job': u'500.00',
            u'in_negative': False}} 
```

如何遍历上面的每封电子邮件并附`'.fake'`加到它们的末尾？我就是为了这个——`"test@test.com.fake"`

我正在这样做，但它没有更改列表项：

```
for p in practice:
    email_count = len(p.config['alert']['emails'])
    if email_count > 0:
        print 'WE HAVE EMAILS'
        i = 0
        while i < email_count:        
            p.config['alert']['emails'][i] += '.fake'
            print p.config['alert']['emails'][i]
            i += 1
        p.save() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:24:33.233

我看不出为什么您的代码无法更改列表项，但试试这个：

```
for p in practice:
    p.config['alert']['emails'] = [e + '.fake' for e in p.config['alert']['emails']] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:18:56.667

原来我需要先将 p.config 分配给一个变量，然后再编辑它。“P”代表练习对象。

```
for p in practices:
    config = p.config

    config['alert']['emails'] = [
        '.{0}.fake'.format(x)
        for x in config['alert']['emails']
    ]

    p.config = config

    p.save() 
```

# c++ - 传递缺少初始值设定项的数组作为参数时编译失败

> ID：13765892
> 
> 赞同：1
> 
> 时间：2012-12-07T15:18:30.683
> 
> 标签：c++, c++03

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:33:00.713

该构造`(int[2]){0}`是 C99 复合文字，它不是 C++ 的一部分。任何人都可以猜测特定编译器在 C++ 上下文中的解释方式（或检查源代码的问题）。

PS。好的，看起来 gcc 4.7/gcc 4.8/clang-3.1 处理它相当明智 - 复合文字的类型与 C99 标准指定的相同。

我猜OP编译器有点老。

# android - EditText Android 上的 TextWatcher

> ID：13765893
> 
> 赞同：0
> 
> 时间：2012-12-07T15:18:30.483
> 
> 标签：android, textwatcher

我有 2 个 edittext，我想将第二个 edittext 设置为 0，如果第一个 edittext 的值低于 10，则将其停用。我使用了 TextWatcher，但运行时出现堆栈溢出错误。谁能帮我这个 ？？我的代码如下：

```
 qteDev = (EditText) findViewById(R.id.edt_qtedev);
    qte = (EditText) findViewById(R.id.edt_qte);
    qte.addTextChangedListener(new TextWatcher() {

    public void onTextChanged(CharSequence s, int start, int before, int count) {           
         if(qte.getText().toString().equals(""))
             return ;
         int l = qte.getText().length();
         if (l == 1) {
             qteDev.setText("0");
             qteDev.setClickable(false);
             qteDev.setEnabled(false);
             qteDev.setActivated(false);
         }
    }

    public void beforeTextChanged(CharSequence s, int start, int count, int after) {
         // TODO Auto-generated method stub
    }

    public void afterTextChanged(Editable s) {
        // TODO Auto-generated method stub
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:26:19.143

`afterTextChanged`在你的方法中尝试这样的事情：

```
public void afterTextChanged(Editable s) {
    if(Integer.parseInt(s.toString()) < 10) {
        secondEditText.setText(0);
        secondEditText.setEnabled(false);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T19:59:28.777

尝试修复您的 afterTextChanged 方法

```
qteDev = (EditText) findViewById(R.id.edt_qtedev);
qte = (EditText) findViewById(R.id.edt_qte);
qte.addTextChangedListener(new TextWatcher() {

public void afterTextChanged(Editable s) {
    // TODO Auto-generated method stub
    if(s.toString().length() < 10){
        qteDev.setText("0");
        qteDev.setEnable(false);
    }
} 
```

如果有任何问题，请发表任何评论。谢谢

# c++ - C和C++之间的指针区别

> ID：13765898
> 
> 赞同：2
> 
> 时间：2012-12-07T15:18:44.303
> 
> 标签：c++, c, pointers, arduino, ragel

我注意到以下 C 代码给出“警告：初始化丢弃指针目标类型的限定符”，但它仍然可以编译并按预期运行（输出 'W' 字符）。

```
#include <stdio.h>
int main(int argc, char *argv[])
{
    char buffer[20] = {'H','e','l','l','o',' ','W','o','r','l','d','!','\0'};

    const char* p = &buffer[0];

    char* c = (p + 6);

    printf("%c\n",*c);
} 
```

在 C++ 中，类似的代码根本无法编译并抱怨“错误：从 'const char*' 到 'char*' 的无效转换”

```
#include <iostream>
using namespace std;
int main()
{
   char buffer[20] = {'H','e','l','l','o',' ','W','o','r','l','d','!','\0'};

   const char* p = &buffer[0];

   char* c = p + 6;

   cout << *c;
   cout << endl;
   return 0;
} 
```

是什么原因？

是否可以修复 C++ 代码以使其像 C 对应物一样编译（和行为）？

更好的解释：感谢您的所有回答，但你们中的大多数人没有得到我真正的问题，所以我会尝试更详细地解释。

我正在使用用 C 编写的库。标题中的函数原型类似于：

```
void parse (const char* p, uint16_t len, uint8_t is_eof); 
```

在这个函数的实现中，它碰巧运行了类似的代码

```
char* c = p + 6; 
```

如果我用 C 编写代码并针对这个库进行编译，一切都很好。

现在我想在 C++ 中移植这个库，因为我在 C++ 项目中需要它。通过将函数参数重新定义为变量而不是常量，我成功地移植了库。但由于`p`指针实际上不需要更改，我更愿意将其定义为常量，就像在原始 C lib 中一样。放置一个变量而不是一个常量，我最终会在不保留所有原始语义的情况下移植一个库。这很糟糕，因为我不知道 C++ 库是否与原始 C 库运行得一样好。

我希望这足够清楚。

一个（希望）更好的解释：

我正在[学习 AVR 教程中的教程 - [CODE][C] 使用 Ragel 灵活/高效地解析字符串](http://www.avrfreaks.net/index.php?name=PNphpBB2&file=printview&t=80042&start=0)，问题与`parse_microscript()`函数有关。

因为我想在解析器中嵌入 Arduino 代码（即`Serial.println();`），所以我尝试用 C++ 宿主语言而不是教程中建议的 C 来编译这个 Ragel 解析器。

首先，我尝试包含`Arduino.h`在生成的 C 代码中，但 Arduino [IDE](http://en.wikipedia.org/wiki/Integrated_development_environment)无法编译（我相信是因为混合了 C 和 C++ 代码）。

然后我尝试从同一个 Ragel 脚本生成 C++ 代码，但是在编译多个“从 'const char*' 到 'char*' 的无效转换”时，针对生成的代码触发了错误。

使它在 C++ 中工作的唯一方法是删除所有常量关键字。这很糟糕，因为我正在更改 C 代码的原始语义，但它确实有效。

我试图通过提供上述 C 和 C++ 代码片段来隔离问题，但我可能很难解释这一点。

公认的答案是让 C++ 片段编译的原因，但是当我在 Arduino 代码中尝试这个解决方案时它不起作用。

我将使用以下命令编译的工作 Ragel 脚本`ragel -G2 -o microscript.cpp microscript.rl`：

```
#include "qp_port.h"
#include "pelican.h"
#include "bsp.h"
#include "Arduino.h"

static uint16_t currentNumber;

%%{
    machine microscript;

    action ClearNumber {
        currentNumber = 0;
    }

    action PrintNumber {
        Serial.print("parameter: ");
        Serial.println(currentNumber);
    }

    action RecordDigit {
        uint8_t digit = (*p) - '0';
        currentNumber = (currentNumber * 10) + digit;
    }

    number = ((digit @RecordDigit)+) > ClearNumber % PrintNumber;
    whitespace = space+;

    numlist = number (',' number)*;

    crlf = '\r\n';

    OK = crlf 'OK' crlf;

    main := |*

    crlf => {Serial.println("crlf");};

    OK => {Serial.println("OK detected");};

    *|;
}%%

%% Write data;

static uint8_t cs; /* The current parser state */
static char* ts;
static char* te;
static char* act;

void init_microscript() {
    %% write init;
}

void parse_microscript(char* p, uint16_t len, uint8_t is_eof) {
    char* pe = p + len; /* pe points to 1 byte beyond the end of this block of data */
    char* eof = is_eof ? pe : ((char*) 0); /* Indicates the end of all data, 0 if not in this block */

    %% write exec;
} 
```

正如您所看到的，我不得不将`parse_microscript`函数的第一个参数从 const更改`char* p`为`char*p`，再更改`const char* pe`为`char* pe`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T15:26:43.510

您可以使用正确的类型来修复*它们：*

```
const char* c = p + 6; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T15:24:40.990

这就是为什么您应该将 C 和 C++ 视为不同的语言。

你可以抛弃`const`：

```
char* c = (char*) p + 6; 
```

但这确实是一个***不好的做法。***

如果要更改指针，为什么要将其声明为 const？
如果你想要它是 a `const`，你为什么要抛弃 constness 呢？

提出上述问题并自行决定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T15:23:32.640

C++ 是强类型的，C 不是。

在 C++`{ 'H' ...};`中是一个常量字符数组（即`const char *`）。要初始化变量`buffer`，类型需要`const`删除该位。

由于 C 不是强类型，它只会发出警告。

恕我直言，C++ 在这方面更胜一筹。

# c# - 不保持会话

> ID：13765903
> 
> 赞同：0
> 
> 时间：2012-12-07T15:18:50.467
> 
> 标签：c#, asp.net

我有一个网站，我已将其添加到书签中。

情况是：我打开了从书签位置加载的浏览器和网站，现在 tab1 包含网站，接下来我正在记录它，现在它在主页中。

然后我打开了新标签，但我没有加载任何网站。然后我关闭了tab1，然后我从书签位置打开了网站。这里不是 loginpage，而是直接加载 tab2 中的页面。

当我可以关闭登录选项卡时，它应该在下一个选项卡中询问登录页面

请帮助我如何实现这一目标

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:31:51.553

登录 cookie 在相同的浏览器选项卡中共享（有时甚至在相同类型的浏览器中）。

换句话说，如果您在 IE 中登录一个选项卡，则不必登录不同的选项卡。登录 cookie 仍然有效，您将自动登录。

但是，如果您在 FireFox 或 Chrome 中打开相同的页面，即使您已在 IE 中登录，您仍然需要登录。

**更新：**如果选项卡已关闭并在不同的选项卡（在同一浏览器中）重新打开，请不要要求用户重新登录。甚至银行网站也不会这样做。（当然，如果浏览器关闭，用户需要重新登录。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:36:50.260

当页面关闭时，您需要注销用户。

您可以使用`onbeforeunload`事件手动注销活动用户。

看看这篇关于[在关闭浏览器或退出页面时保存更改的文章](http://www.codeproject.com/Articles/20260/Save-Changes-on-Close-of-Browser-or-When-Exiting-t)

# javascript - 带有基础的 Rails 3.2.5。Javascript 不工作

> ID：13765906
> 
> 赞同：1
> 
> 时间：2012-12-07T15:18:53.777
> 
> 标签：javascript, jquery, ruby-on-rails, gem

我设法使用他们在他们网站上的步骤安装了基础

```
 http://foundation.zurb.com/docs/rails.php 
```

我仔细地按照他们的步骤操作，并设法让我的主页与轨道图像滚动器一起工作。但是，如果我尝试使用 javascript Reveal 或 Clearing 组件，它们似乎不起作用。调试时我的控制台中没有错误。

有没有人遇到过这种情况或知道为什么会发生这种情况。

我的 application.js 看起来像这样

```
 //= require jquery
   //= require jquery_ujs
   //= require foundation/app
   //= require foundation
   //= require_tree . 
```

我的来源看起来像这样

```
<!-- Included CSS Files -->
<link href="/assets/application.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/globals.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/typography.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/grid.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/ui.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/forms.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/orbit.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/reveal.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/mobile.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/foundation/index.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/landing.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/layouts/layout.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<!-- Included JS Files -->
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/app.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/modernizr.foundation.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.reveal.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.orbit-1.4.0.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.customforms.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.placeholder.min.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.tooltips.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/index.js?body=1" type="text/javascript"></script>
<script src="/assets/landing.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script> 
```

# javascript - mootools.svn.js 在 IE8 中显示错误

> ID：13765907
> 
> 赞同：3
> 
> 时间：2012-12-07T15:19:00.497
> 
> 标签：javascript, internet-explorer-8, mootools

使用 mootools 的滑块标题脚本在 IE7 和 9 中运行良好，但在 8 中弹出错误。在所有其他浏览器中也运行良好。

```
Line: 2148
Char: 3
Error: Invalid procedure call or argument
Code: 0
URL: (Path to mootools.svn.js) 
```

代码是：

```
setStyle: function(property, value) {
    switch (property) {
        case 'opacity': 
            return this.setOpacity(parseFloat(value));
        case 'float': 
            property = (window.ie) ? 'styleFloat' : 'cssFloat';
    }
    property = property.camelCase();
    switch ($type(value)) {
        case 'number': 
            if (!['zIndex', 'zoom'].contains(property)) 
                value += 'px'; 
            break;
        case 'array': 
            value = 'rgb(' + value.join(',') + ')';
    }
    this.style[property] = value;
    return this;
}, 
```

第 2148 行是这样的：

```
this.style[property] = value; 
```

几天来我一直在寻找答案，但我对 JavaScript 不是很好，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:00:09.313

你在使用[http://code.google.com/p/cnetjavascript/downloads/detail?name=mootools.svn.js&can=2&q=](http://code.google.com/p/cnetjavascript/downloads/detail?name=mootools.svn.js&can=2&q=)吗？

它已被**弃用**，如果您检查源以获取对它的引用，`window.ie`它看起来像以下代码段。如果您正在使用它，您应该考虑升级到更新且受支持的 javascript 框架。

```
/*
Class: window
    Some properties are attached to the window object by the browser detection.

Properties:
    window.ie - will be set to true if the current browser is internet explorer (any).
    window.ie6 - will be set to true if the current browser is internet explorer 6.
    window.ie7 - will be set to true if the current browser is internet explorer 7.
    window.khtml - will be set to true if the current browser is Safari/Konqueror.
    window.gecko - will be set to true if the current browser is Mozilla/Gecko.
*/

if (window.ActiveXObject) window.ie = window[window.XMLHttpRequest ? 'ie7' : 'ie6'] = true;
else if (document.childNodes && !document.all && !navigator.taintEnabled) window.khtml = true;
else if (document.getBoxObjectFor != null) window.gecko = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:25:29.460

当您在通话后遇到异常时`this.style[property] = value`，这可能是一个无效值的实际问题 - 例如`width: -5`或'scroll：“none”'或类似的。

只需调试它并查看它是什么属性和值并在上游捕获它 - 通常是由于缓动/弹性（例如，高度上的 Fx.morph 与自定义过渡到 0）。

如果您无法防止该值无效，请在动画调用或触发它的任何内容周围加上 try/catch。

# c# - 如何设置工具条文本框接受按钮来调用工具条按钮调用的函数？

> ID：13765908
> 
> 赞同：0
> 
> 时间：2012-12-07T15:19:11.153
> 
> 标签：winforms, c#, winforms, textbox, toolstripbutton, acceptbutton

`TextBox`我的[winforms](/questions/tagged/winforms "显示标记为“winforms”的问题")中有一个。当用户开始输入时，我想设置该`AcceptButton`属性以调用另一个函数。然而，它正在调用另一个由`Button`my中的 a 调用的函数`ToolStrip`。详细地说，这是我的代码如下：

```
private void locNameTxtBx_TextChanged(object sender, EventArgs e)
{
    this.AcceptButton = searchBtn;
}

private void searchBtn_Click_1(object sender, EventArgs e)
{
    if (locNameTxtBx.Text != "")
    {
        List<SearchLocation> locationsArray = new List<SearchLocation>();
        var location = locNameTxtBx.Text;
        SearchLocation loc = new SearchLocation();
        loc.Where = location;
        locationsArray.Add(loc);
        mapArea.VE_FindLocations(locationsArray, true, true, null);
        mapArea.VE_SetZoomLevel(14);
    }
    else
    {
        MessageBox.Show("Please Enter Location");
    }
} 
```

`searchBtn`是`Button`中的一个`ToolStrip`。因此，当我尝试运行此代码时，出现此错误

> 无法将类型“System.Windows.Forms.ToolStripButton”隐式转换为“System.Windows.Forms.IButtonControl”。存在显式转换（您是否缺少演员表？）

我曾尝试将其转换为 ToolstripButton，如下所示：

```
private void locNameTxtBx_TextChanged(object sender, EventArgs e)
{
    this.AcceptButton = (ToolStripButton)searchBtn;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:38:57.747

您可以使用两个委托并将委托设置为在`locNameTxtBx_TextChanged`方法中使用。

```
 private delegate void ToUseDelegate();

    ToUseDelegate delegateIfNoText = delegate{
       MessageBox.Show("Please Enter Location");
    }

    ToUseDelegate delegateIfText = delegate{
       List<SearchLocation> locationsArray = new List<SearchLocation>();
       var location = locNameTxtBx.Text;
       SearchLocation loc = new SearchLocation();
       loc.Where = location;
       locationsArray.Add(loc);
       mapArea.VE_FindLocations(locationsArray, true, true, null);
       mapArea.VE_SetZoomLevel(14);
    }

    ToUseDelegate delToUse = delegateIfNoText;

    private void locNameTxtBx_TextChanged(object sender, EventArgs e)
    {
       this.AcceptButton = searchBtn;
       if (locNameTxtBx.Text != ""){
          delegateToUse = delegateIfNoText;
       } else {
          delegateToUse = delegateIfText;
       }
    }

    private void searchBtn_Click_1(object sender, EventArgs e)
    {
       delegateToUse();
    } 
```

# c - C中的字母树

> ID：13765910
> 
> 赞同：0
> 
> 时间：2012-12-07T15:19:15.520
> 
> 标签：c, tree, letters

我想存储一些与由简单 ascii 字母 (aZ) 组成的单词相关的数据，目标是在未来的解析中快速检索与单词相关的数据。

我虽然关于以下结构：

```
struct Foo {
  Foo *letter[26];
  void *data;
}; 
```

因此，可以在解析字符串中的单词的同时向下遍历“字母树”并获取相关数据。

```
"foo" => ['f' node] -> ['o' node] -> ['o' node] 
```

如果我有很多单词，问题是整个树的大小。

有没有办法在不损失性能的情况下减小树的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:24:14.500

你所描述的是所谓的`trie`。紧凑的[基数树](http://en.wikipedia.org/wiki/Compact_prefix_tree)更紧凑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:24:27.883

您是否有理由使用树而不是将单词存储在哈希表中？这些往往会使用更多的内存，但会为您提供近乎恒定的表查找时间性能。

# sql - 如何使用 SQL Server 检查目录是否存在？

> ID：13765911
> 
> 赞同：23
> 
> 时间：2012-12-07T15:19:16.820
> 
> 标签：sql, sql-server, directory, xp-cmdshell

我知道这个命令会创建一个目录：

```
EXEC master.sys.xp_create_subdir 'C:\testing\' 
```

但是如何检查“C:\testing\”是否存在？

```
IF EXISTS(... 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-07T15:27:59.503

```
 CREATE TABLE ResultSet (Directory varchar(200))

 INSERT INTO ResultSet
 EXEC master.dbo.xp_subdirs 'c:\'

 Select * FROM ResultSet where Directory = 'testing' 
```

会返回一个子目录列表，然后可以查看列表的内容。

# objective-c - 从 Blender 导出的 OpenGL ES Sphere alpha 纹理

> ID：13765918
> 
> 赞同：1
> 
> 时间：2012-12-07T15:19:26.020
> 
> 标签：objective-c, opengl-es, textures, alpha, blender

我在 iOS 5.0 中使用 OpenGL ES 1.1，我想绘制一个带有纹理映射的球体。纹理将是一张世界地图，它是一个带有 Alpha 通道的 .png。我想让它从内部看到地球的另一部分。

但是，我获得了这种奇怪的效果，我不知道为什么会这样。

我正在使用此脚本从 Blender 导出：[https ://github.com/jlamarche/iOS-OpenGLES-Stuff/tree/master/Blender%20Export/objc_blend_2.62](https://github.com/jlamarche/iOS-OpenGLES-Stuff/tree/master/Blender%20Export/objc_blend_2.62)

我已经尝试反转法线的方向，但没有帮助。

我不想激活剔除，因为我想看到两张脸。

[http://imageshack.us/photo/my-images/819/screenshot20121207at308.png/](http://imageshack.us/photo/my-images/819/screenshot20121207at308.png/)

# c# - c#+extjs4不向客户端发送用户无权的元素

> ID：13765921
> 
> 赞同：1
> 
> 时间：2012-12-07T15:19:35.213
> 
> 标签：c#, deployment, extjs4, rights

我们正在开发 c#+ExtJs4 应用程序。我们想尽可能地分离javascript和c#代码，js代码可以是一些需要被浏览器缓存的文件。

我们如何只发送用户拥有权限的 js 代码？例如，如果用户没有按钮的权限，我们不想在客户端代码中看到它。

有用户组，一个用户可以是一个或多个组的一部分。组成员可以在运行时在应用程序中更改。

我们首先想到的是，我们可以将一些指定的注释放入 javascript 源代码中，其中解析器可以跳过标记部分取决于用户权限。在部署时，也许我们可以生成与权限级别组合一样多的版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T06:27:34.533

为什么不使用一些“动态” javascript 渲染，可能是[SharpKit](http://sharpkit.net/)或[NetJsWire 之类](http://netjswire.codeplex.com/)的，这取决于您的需要，其中之一可能会根据自定义规则生成真正的动态 Javascript。

# android - Android Matrix Scale 适合左下和右上

> ID：13765927
> 
> 赞同：3
> 
> 时间：2012-12-07T15:20:05.133
> 
> 标签：android, android-layout, scale

Android 矩阵`Matrix.ScaleToFit`包含 4 个值：

> public static final Matrix.ScaleToFit CENTER
> 
> 计算将保持原始 src 纵横比的比例，但也将确保 src 完全适合 dst。至少一个轴（X 或 Y）将完全适合。结果以 dst 为中心。
> 
> 公共静态最终 Matrix.ScaleToFit END
> 
> 计算将保持原始 src 纵横比的比例，但也将确保 src 完全适合 dst。至少一个轴（X 或 Y）将完全适合。END 将结果与 dst 的右边缘和下边缘对齐。
> 
> 公共静态最终 Matrix.ScaleToFit 填充
> 
> 独立缩放 X 和 Y，以便 src 与 dst 完全匹配。这可能会改变 src 的纵横比。
> 
> 公共静态最终 Matrix.ScaleToFit 开始
> 
> 计算将保持原始 src 纵横比的比例，但也将确保 src 完全适合 dst。至少一个轴（X 或 Y）将完全适合。START 将结果与 dst 的左边缘和上边缘对齐。

我正在为我的项目寻找 2 个缺失值：

*   将结果与毛毡边缘和底部边缘对齐
*   将结果与右边缘和上边缘对齐

我真的不明白为什么这些可能性不在这个矩阵中。我是否需要使用和其他属性而不是`android:scaleType="xxxxx"` 在我的布局中？

# postgresql - 使用 now() 函数并执行触发器

> ID：13765930
> 
> 赞同：1
> 
> 时间：2012-12-07T15:20:20.017
> 
> 标签：postgresql, triggers, timestamp, infinite-loop, plpgsql

我正在尝试在 PostgreSQL 中创建一个触发器函数，该函数应该在插入或更新记录之前检查相同的记录`id`（即`id`与现有记录进行比较）。如果函数找到具有相同 的记录`id`，则该条目设置为`time_dead`。让我用这个例子来解释：

```
INSERT INTO persons (id, time_create, time_dead, name)
VALUES (1, 'now();', ' ', 'james'); 
```

我想要一张这样的桌子：

```
 id  time_create  time-dead  name
 1   06:12                   henry   
 2   07:12                   muka 
```

`id 1`有一个`time_create 06.12`但是`time_dead`是`NULL`。这是相同的，`id 2`但下次我尝试`insert`使用相同的 id 但不同的名称运行查询时，我应该得到一个像这样的表：

```
 id  time_create  time-dead  name
 1   06:12        14:35      henry   
 2   07:12                   muka
 1   14:35                   waks 
```

henry 和 waks 共享 相同 的`id` `1`. 运行`insert`查询后 henry's `time_dead`is equal to waks' `time_create`。如果要使用 id 1 创建另一个条目，假设为 james，则 james 的时间条目将等于`time_dead`for waks。等等。

到目前为止，我的功能看起来像这样。但它不起作用：

```
CREATE FUNCTION tr_function() RETURNS trigger AS '
BEGIN
  IF tg_op = ''UPDATE'' THEN
     UPDATE persons
     SET time_dead = NEW.time_create
     Where
         id = NEW.id
         AND time_dead IS NULL
         ;

  END IF;
  RETURN new;
END
' LANGUAGE plpgsql;

CREATE TRIGGER sofgr BEFORE INSERT OR UPDATE
        ON persons FOR each ROW
        EXECUTE PROCEDURE tr_function(); 
```

当我运行它时，它的说法`time_dead`不应该是`null`. 有没有一种方法可以编写一个`trigger function`自动输入时间`inserting or updating`但在我运行查询时给我上表的结果`select`？

我究竟做错了什么？

我的两张桌子：

```
CREATE TABLE temporary_object
(
  id integer NOT NULL,
  time_create timestamp without time zone NOT NULL,
  time_dead timestamp without time zone,
  PRIMARY KEY (id, time_create)
);

CREATE TABLE persons
(
  name text
)
INHERITS (temporary_object); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:06:25.753

### 触发功能

```
CREATE FUNCTION tr_function()
  RETURNS trigger AS
$func$
BEGIN

   UPDATE persons p
   SET    time_dead = NEW.time_create
   WHERE  p.id = NEW.id
   AND    p.time_dead IS NULL
   AND    p.name <> NEW.name;

   RETURN NEW;

END
$func$ LANGUAGE plpgsql; 
```

*   `INSERT`您在触发函数 ( `IF tg_op = ''UPDATE''`)中遗漏了案例。但是不需要检查`TG_OP`，因为触发器只会触发`INSERT OR UPDATE`- 假设您没有在其他触发器中使用相同的功能。所以我去掉了杂物。

*   请注意，您不必在用美元引用的字符串中转义单引号。

*   还补充说：

    ```
     AND    p.name <> NEW.name 
    ```

...以防止`INSERT`'s 立即终止自身（并导致*无限递归*）。这假定一行永远不会在具有相同`name`.

另外：设置仍然不是防弹的。`UPDATE`s 可能会弄乱您的系统。我可以继续更新`id`or 一行，从而终止其他行但不留下后续行。考虑禁止更新`id`. 当然，这会使触发器`ON UPDATE`毫无意义。我怀疑你需要从这个开始。

* * *

### 现在（）作为默认值

如果您想将其`now()`用作默认值，`time_create`只需这样做。[阅读有关设置列的手册`DEFAULT`](http://www.postgresql.org/docs/current/interactive/sql-createtable.html)。然后跳过s `time_create`，`INSERT`它会自动填充。

如果你想*强制*它（防止每个人输入不同的值）创建一个触发器`ON INSERT`或在触发器顶部添加以下内容：

```
IF TG_OP = 'INSERT' THEN
    NEW.time_create := now();   -- type timestamp or timestamptz!
    RETURN NEW;
END IF; 
```

假设您误导性命名的列“time_create”实际上是一种[`timestamp`](http://www.postgresql.org/docs/current/interactive/datatype-datetime.html)类型。
这将强制新行的当前时间戳。

# php - 如何使用今天的日历创建表格？jquery 和 php

> ID：13765932
> 
> 赞同：0
> 
> 时间：2012-12-07T15:20:30.637
> 
> 标签：php, jquery, codeigniter, calendar

HTML

```
<table class="" id="schedule">
        <thead>
            <tr>
                <th><input value="Time" type="text"></th>
                <th><input value="Monday" type="text"></th>
                <th><input value="Tuesday" type="text"></th>
                <th><input value="Wednesday" type="text"></th>
                <th><input value="Thursday" type="text"></th>
                <th><input value="Friday" type="text"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th><input value="9:00am" type="text"></th>
                <td class=""></td>
                <td class=""></td>
                <td class=""></td>
                <td class=""></td>
                <td class=""></td>
            </tr></tbody></table> 
```

我的问题是如何动态生成具有今天小时数的表格，而不必在 html 中硬编码它？我需要这张表包含一天中每个小时（24 小时）的 tr。

我的目标：我正在为我的诊所网站创建一个预订页面，我对该诊所的所有访问都存储在 mysql 中，格式为“visit,name_patient,date,time,clinic_num”，

我从 db 获取今天的所有记录，我想将它显示在一个表中。

**问题**

1.  那么有人能告诉我生成这样一个表的最简单的逻辑流程是什么吗？

2.  如何使用今天的时间“9am,10am,11am”生成行

**注意：** [http](http://apps.zarjay.net/scheduler/) ://apps.zarjay.net/scheduler/这看起来像我想要的，但时间仍然是硬编码的。大多数其他日历插件真的很复杂，而且对于我想要的 wt 来说太过分了

```
etc ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:37:42.073

这是我知道的最简单的方法：

```
<table>
    <?php foreach (range(0, 23) as $i) : ?>
    <tr>
        <td><?php echo date('ha', mktime($i, 0)); ?></td>
        <td>What ever you want here</td>
    </tr>   
    <?php endforeach; ?>
</table> 
```

更改 的值`range(0,23)`以满足您的需要

在这里，它应用于您的 HTML：

```
<table class="" id="schedule">
    <thead>
        <tr>
            <th><input value="Time" type="text"></th>
            <th><input value="Monday" type="text"></th>
            <th><input value="Tuesday" type="text"></th>
            <th><input value="Wednesday" type="text"></th>
            <th><input value="Thursday" type="text"></th>
            <th><input value="Friday" type="text"></th>
        </tr>
    </thead>
    <tbody>
        <?php foreach (range(0, 23) as $i) : ?>
        <tr>
            <th><input value="<?php echo date('ha', mktime($i, 0)); ?>" type="text" /></th>
            <td class=""></td>
            <td class=""></td>
            <td class=""></td>
            <td class=""></td>
            <td class=""></td>
        </tr>
        <?php endforeach; ?>
    </tbody>
</table> 
```

# delphi - Windows 访问文件

> ID：13765935
> 
> 赞同：0
> 
> 时间：2012-12-07T15:20:41.560
> 
> 标签：delphi, delphi-7, delphi-2010

如何找出 Windows 正在复制的文件或 Windows 试图访问的文件？我该如何限制它？我希望我的程序监视这些活动并做出响应...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:22:53.300

您可以查看各种目录和文件更改通知，请参阅此处了解更多详细信息，因为这不是一个简单的主题：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa365261(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365261(v=vs.85).aspx)

# java - 在 Pentaho 水壶中，如何检查文件名是否存在？

> ID：13765937
> 
> 赞同：0
> 
> 时间：2012-12-07T15:20:45.050
> 
> 标签：java, pentaho, kettle

我是pentaho水壶的新手...

现在，我有一个包含许多 .txt 文件的文件夹。

比如说：20121012.txt、20121014.txt……

每次我运行水壶作业时，它都会 grep 所有这些文件以导入数据库。

我需要在导入数据库之前处理检查以防止数据重复。

问题是，我怎样才能让水壶注意到已经导入的文件名？

**例如：**

20121012.txt <=如果这个文件是导入的，下次会检查文件名，如果是相同的文件名，则不导入。

在这种情况下，我不能只在“检查文件是否存在”步骤中简单地设置特定文件“20121012.txt”。这是因为txt文件很大。如果文件名指的是一天，那么 1 年包含 365-366 天。我不能以这种方式对所有天文件进行硬编码。

因此，可能的方法是在导入数据库之前检查该进程文件的文件名是否存在。

这是我的问题，我该怎么做？我需要使用哪些步骤或工作流程？谁能提供可以做到这一点的详细步骤？

我期待收到您的来信，如果您需要更多信息，请告诉我。

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T16:46:57.500

您可以通过将已处理的文件列表存储在数据库中的表之类的位置来做到这一点。在另一个步骤中加载表，然后通过合并将来自这些步骤的流连接起来，并仅通过文件加载步骤中不在另一个流中的那些文件。

确保稍后使用任何新处理的文件更新您已处理的表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T08:53:47.727

您可以使用“获取文件名”步骤。在此步骤中：设置存储文件的文件夹，然后设置通配符（例如“.*”，如果您想要文件夹中的所有文件）。

如果您的数据库存储了已导入的文件名，您可以使用“数据库查找”检查您的文件名是否已在数据库中，然后过滤流，以仅传递在数据库中未找到的文件名，从而使您的转换变得无效。

# ios - 来自 UITextField 的 iOS NSString - 检查值

> ID：13765944
> 
> 赞同：0
> 
> 时间：2012-12-07T15:21:09.900
> 
> 标签：ios, nsstring

在我的应用程序中，我有一个对话框，用户可以在其中向 UITextField 输入一些信息。在继续之前，我需要检查 UITextField.text 值是否等于某个值（当用户单击提交按钮时会捕获该值）。但是，我的条件（见下文）一直失败。

```
if (userAssignedName || userAssignedName.length > 0 || ![userAssignedName isEqualToString:@""]) {
 //do something
} else { 
[alertManager showAlert:@"You must enter a name for this OR"];
} 
```

当我在条件之前控制台登录 userAssignedName 时，我得到了我所期望的，什么都没有。

如何检查以确保字符串具有值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T15:29:35.280

那么解决方案很简单。3 个值中的任何一个都返回 YES/true 值。

```
![userAssignedName isEqualToString:@""] 
```

这将检查您的字符串是否等于空字符串。（这可能是您默认的文本字段？）这很好。

```
userAssignedName.length > 0 
```

这会检查字符串中的字符。这也很好，除非你不需要它。它主要用于在文本字段中保留最大数量的字符。

```
userAssignedName 
```

这将检查实际变量是否被实例化。并且不会也不应该以任何方式涉及用户输入。如果您删除它，您的检查将不会失败。

解决方案：

```
if (/*userAssignedName.length > 0 ||*/ ![userAssignedName isEqualToString:@""]) 
{
    //do something
} 
else 
{ 
    [alertManager showAlert:@"You must enter a name for this OR"];
} 
```

这应该可以解决问题。你是否使用评论取决于你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:36:51.323

替换这个：

```
if (userAssignedName || userAssignedName.length > 0 || ![userAssignedName isEqualToString:@""]) { 
```

和：

```
if (userAssignedName.length > 0) { 
```

您不想使用：

```
if (![userAssignedName isEqualToString:@""]) { 
```

因为 if `userAssignedName`is ，当您希望它失败时`nil`，此语句将成功。`if`

# python - 什么在 python ruby 的加载中实现了相同的功能

> ID：13765949
> 
> 赞同：0
> 
> 时间：2012-12-07T15:21:28.287
> 
> 标签：python, ipython, bpython

在**irb**我们可以这样做：

```
>> load 'example.rb' 
```

它将源加载`example.rb`到环境中。

bpython 和 ipython 的替代方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T17:25:22.263

假设你有一个名为 example.py 的文件存在于你的 PYTHONPATH 中（很像 ruby​​ 的 $LOAD_PATH）

在普通python中： [详细信息在这里](http://docs.python.org/2/tutorial/modules.html)

```
>>> import example  # Import module. 
>>> example.hello()  # Run code
hello

# Then, lets say you change the hello function to say "hello world, I'm changed!"

>>> reload(example)
<module 'example' from 'example.pyc'> 

>>> example.hello()
hello world, I changed! 
```

IPython 具有上述所有功能，并添加了其他方式。

1.  dreload 类似于 reload，但递归地重新加载 example.py 导入的模块。这意味着如果 example.py 依赖于 example2.py 并且您更改了 example2.py，example.example2 将反映更新后的更改

    ```
    In [5]: dreload(example)  # (after import, of course)

    In [6]: dreload?  # Details... 
    ```

2.  %run 魔法是我最喜欢的，因为它执行调用的文件，然后将该文件的命名空间嵌入到您当前的会话中。它意味着当它被调用时 reload 和 dreload，也像 import * 一样工作。我会说这是最像 ruby​​ 的“负载”。

    ```
    In [1]: %run example.py
    In [2]: hello()
    hello

    # Make some changes to code

    In [3]: %run example.py
    hello world, I changed!

    In [4]: %run?  # Details... 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:22:10.097

```
from this import * 
```

将 的内容加载`this.py`到您当前的命名空间中。

# objective-c - 更新类变量 NSMutableArray 的内容

> ID：13765950
> 
> 赞同：1
> 
> 时间：2012-12-07T15:21:29.660
> 
> 标签：objective-c, ios, nsmutablearray

总的来说，我是 Objective C 和 iOS 开发的新手，所以如果我错过了一些需要包含的信息，请告诉我，我会尽力而为。同时，如果我的任何假设是不正确的，或者如果我把它设置得完全愚蠢，请不要犹豫，对我大喊大叫。谢谢！

我有一个名为`feeds`. 这是我在 .h 文件中初始化它的方式：

```
@interface ClassViewController : ContentViewController <UITableViewDelegate,
UITableViewDataSource> {
    NSMutableArray *feeds;
}
@property (nonatomic, strong) NSMutableArray* feeds; 
```

在 .m 中：

```
@dynamic feeds; 
```

我正在尝试从 JSON 获取结果并将它们加载到`feeds`. 让我们假设其中`resArr`有正确的数据：

```
NSArray *resArr = [results objectForKey:@"data"];

if([self->feeds count]) {
    [self->feeds removeAllObjects];
    [self->feeds addObjectsFromArray:resArr];
 }
 else {
     self->feeds = [[NSMutableArray alloc] initWithArray:resArr];
 } 
```

现在，这第一次工作正常（即，我第一次将数据放入数组中），但随后出现以下错误：***** -[NSMutableArray addObjectsFromArray:]: array argument is not an NSArray**

我一无所知。有任何想法吗？

*编辑：JSON结构*

1：

```
{"code":200,"data":[{"name":"ABM"},{"name":"ACC"}]} 
```

2：

```
{"code":200,"data":{"100":{"subject":"ABM","title":"Decision Making in Agri-Food"},"130":{"subject":"ABM","title":"Farm Management I"}}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:27:33.150

您应该使用 self.feeds 而不是 self->feeds，这是一个很好的阅读[点（“.”）运算符和箭头（“->”）运算符在 C 与 Objective-C 中的使用](https://stackoverflow.com/questions/9072688/dot-operator-and-arrow-operator-use-in-c-vs-objective-c)

你确定后面的时间实际上是 NSArrays 吗？

*编辑添加*

看起来第一个 JSon 只是一个名称数组，而第二个是一个以 100、200 等为键的字典。因此 JSON 将其转换为一个以 100、200 为键的字典...

```
NSArray* resArr = [results objectForKey:@"data"];

if([self.feeds count]) {
    [self.feeds removeAllObjects];
    if([resArr isKindOfClass:[NSDictionary class]])
       [self.feeds addObjectsFromArray:resArr.allValues];
    else
       [self.feeds addObjectsFromArray:resArr];
 }
 else {
     self.feeds = [[NSMutableArray alloc] initWithArray:resArr];
 } 
```

# spring - Spring JPA TransactionRequiredException：没有事务正在进行中

> ID：13765954
> 
> 赞同：1
> 
> 时间：2012-12-07T15:21:48.473
> 
> 标签：spring, hibernate, jpa

所以一整天都花在让 JPA 工作上，没有成功，也许你会看到我错过了什么。

我将发布我的配置

**appContext.xml**

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value ="org.postgresql.Driver"/>
        <property name="url" value ="jdbc:postgresql://localhost:5432/db"/>
        <property name="username" value ="postgres"/>
        <property name="password" value ="pwd"/>
    </bean>

 <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="persistenceXmlLocation" value="classpath*:META-INF/persistence.xml"></property>
    <property name="persistenceUnitName" value="hibernatePersistenceUnit" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" >
            <property name="showSql" value="true"/>
        </bean>
    </property>
 </bean> -->

<!-- Declare a transaction manager-->
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
<property name="entityManagerFactory" ref="entityManagerFactory" />
</bean> 

    <context:annotation-config />
    <tx:annotation-driven transaction-manager="transactionManager" mode="aspectj" proxy-target-class="true"/> 
```

**我的 Chain.java 实体**

```
@Entity
@Table(name ="Chain")
public class Chain implements Serializable{

      private Long id;
      private String name;

@Id
@GeneratedValue(strategy=GenerationType.SEQUENCE, generator ="Chain_id_seq")
@SequenceGenerator(name="Chain_id_seq", sequenceName="Chain_id_seq")
public Long getId(){ return id;}
public void setId(Long id){ this.id = id;}

@Column(name = "name")
public String getName(){return name;}
public void setName(String value) {this.name = value;} 
```

**我的 ChainServiceImpl.java 类**

```
@Service("addChainService")
@Transactional(propagation = Propagation.SUPPORTS, readOnly = true)
public class ChainServiceImpl implements ChainService{

    @Autowired
    private ChainDao chainDao;

    @Autowired
    public ChainServiceImpl(ChainDao ChainDao) {
    this.chainDao = ChainDao;
    }

    public ChainServiceImpl() {
    }

    @Transactional(readOnly = false, propagation = Propagation.REQUIRED)
    public int addCaChain(Chain chain) {
        int id  = chainDao.saveCaChain(chain);
        return id;
    }
} 
```

**我的 ChainDaoImpl.java 类**

```
@Repository("chainDao")
public class ChainDaoImpl implements ChainDao{

    private EntityManager entityManager;

    @PersistenceContext
    public void setEntityManager(EntityManager em) {
        this. entityManager = em;
    }

    public int saveChain(Chain chain) {

        entityManager.persist(chain); //em.merge(u); for updates
        entityManager.flush();
        return 9;
    } 
} 
```

**异常跟踪**

```
javax.persistence.TransactionRequiredException: no transaction is in progress
    at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:733) ~[hibernate-entitymanager-3.5.0-Final.jar:3.5.0-Final]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.7.0_09]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) ~[na:1.7.0_09]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.7.0_09]
    at java.lang.reflect.Method.invoke(Method.java:601) ~[na:1.7.0_09]
    at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:365) ~[spring-orm-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at $Proxy18.flush(Unknown Source) ~[na:na]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.7.0_09]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) ~[na:1.7.0_09]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.7.0_09]
    at java.lang.reflect.Method.invoke(Method.java:601) ~[na:1.7.0_09]
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240) ~[spring-orm-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at $Proxy18.flush(Unknown Source) ~[na:na]
    at pl.signet.famoc.postgresql.jpa.dao.CaChainDaoImpl.saveCaChain(CaChainDaoImpl.java:47) ~[CaChainDaoImpl.class:na]
    at pl.signet.famoc.postgresql.jpa.service.SignetCAStorageChainServiceImpl.addCaChain(SignetCAStorageChainServiceImpl.java:33) ~[SignetCAStorageChainServiceImpl.class:na]
    at pl.signet.famoc.ws.spring.endpoint.FamocCaEndpoint.getCAChain(FamocCaEndpoint.java:42) ~[FamocCaEndpoint.class:na]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.7.0_09]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) ~[na:1.7.0_09]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.7.0_09]
    at java.lang.reflect.Method.invoke(Method.java:601) ~[na:1.7.0_09]
    at org.springframework.ws.server.endpoint.MethodEndpoint.invoke(MethodEndpoint.java:134) ~[spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.server.endpoint.adapter.DefaultMethodEndpointAdapter.invokeInternal(DefaultMethodEndpointAdapter.java:229) ~[spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.server.endpoint.adapter.AbstractMethodEndpointAdapter.invoke(AbstractMethodEndpointAdapter.java:53) ~[spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:233) [spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:173) [spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88) [spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:59) [spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.ws.transport.http.MessageDispatcherServlet.doService(MessageDispatcherServlet.java:221) [spring-ws-core-2.1.1.RELEASE.jar:na]
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882) [spring-webmvc-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) [spring-webmvc-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:641) [servlet-api.jar:na]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) [servlet-api.jar:na]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) [catalina.jar:7.0.30.A]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) [catalina.jar:7.0.30.A]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222) [catalina.jar:7.0.30.A]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) [catalina.jar:7.0.30.A]
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) [catalina.jar:7.0.30.A]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) [catalina.jar:7.0.30.A]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99) [catalina.jar:7.0.30.A]
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929) [catalina.jar:7.0.30.A]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) [catalina.jar:7.0.30.A]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) [catalina.jar:7.0.30.A]
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002) [tomcat-coyote.jar:7.0.30.A]
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585) [tomcat-coyote.jar:7.0.30.A]
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310) [tomcat-coyote.jar:7.0.30.A]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [na:1.7.0_09]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [na:1.7.0_09]
    at java.lang.Thread.run(Thread.java:722) [na:1.7.0_09] 
```

`entityManager.flush()`当我不使用刷新时出现异常，没有异常，但数据库没有任何反应，没有插入记录。

有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:58:41.967

I think you need a `<context:component-scan>` in your appContext.xml. The `<context:annotation-config>` only activates annotations on beans already registered in the application context. The `component-scan` both scans packages for beans to register and activates annotations. Since you don't have a `component-scan` the `@Transactional` annotation is not wrapping the method in a transaction.

A good [post](https://stackoverflow.com/questions/7414794/difference-between-contextannotation-config-vs-contextcomponent-scan) on the difference between component-scann and annotation-config.

# python - 无法从 Python 函数返回列表元素

> ID：13765955
> 
> 赞同：1
> 
> 时间：2012-12-07T15:21:56.760
> 
> 标签：python, csv, dictionary

我有一个函数， `table()`它读取 csv 文件并返回单个列表中的行。我想映射这些列表以创建一个字典，字段标题是键，基础行是值。但是，我似乎无法做到这一点。当我尝试`l`在命令提示符下仅调用从函数 () 创建的列表列表中的第一个元素时，它返回所有列表，直到“N”，即单词“None”中的第一个字母，尽管我打破了（返回）如果 reader 是 None。当我对文本文件的 sys.stdout 执行相同操作时，它执行相同操作，但 'N' 被替换为`<type 'list'>`. 有谁知道我做错了什么，以及如何根据我的 `table()`功能从 CSV 文件创建字典（或列列表）？

```
import csv

def table():
    with open('C:\\Python27\\test.csv', 'rb') as f:
        reader = csv.reader(f)
        for row in reader:
            print row
        if reader is None:
            return

l = list(str(table()))
keys = l[0]
print keys 
```

输出文本文件：

```
['Field1', 'Field2', 'Field3', 'Field4']
['a', '1', 'I', 'access']
['b', '2', 'II', 'accessing\n']
['c', '3', 'III', 'accommodation']
['d', '4', 'IIII', 'basically']
<type 'list'> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T15:27:46.083

更蟒蛇

```
def table():
    with open('C:\\Python27\\test.csv', 'rb') as f:
        reader = csv.reader(f)
        for row in reader:
            yield row 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T15:25:09.850

你实际上并没有从`table`函数中返回任何东西。试试这样：

```
def table():
    with open('C:\\Python27\\test.csv', 'rb') as f:
        lines = []
        reader = csv.reader(f)
        if reader:
            for row in reader:
                lines.append(row)
            return lines
        else:
            return [] 
```

# angularjs - 如何使 angular-ui 输入与 angularjs 属性（尤其是 ng-readonly）配合？

> ID：13765958
> 
> 赞同：2
> 
> 时间：2012-12-07T15:22:09.987
> 
> 标签：angularjs, angular-ui

我想使用 angularjs 和 angular-ui（特别是 ui-select2 功能）实现对选择输入的读/写访问控制。场景很简单：通过使用 ng-readonly 属性，我可以控制给定的输入值是否可以由用户更改。

```
<input id="clientShortName" class="span4" type="text" ng-readonly="readOnly" ng-model="client.shortName" />
<input ui-select2="{ tags: sometags}" id="clientTagsSelection" class="span4" type="text" ng-readonly="readOnly" ng-model="client.tagsSelection"/>
<input type="button" value="Edit" ng-click="readOnly = !readOnly"/> 
```

这适用于标准 angularjs，但是当我尝试使用由 angular-ui 定义的输入时，它不起作用（不会更改输入的读/写状态）。

此处涵盖了完整的场景：http: [//plnkr.co/edit/pKs4Tq](http://plnkr.co/edit/pKs4Tq)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:14:39.227

不幸的是，AngularUI`ui-select2`指令没有与 angularJS`ng-readonly`指令集成。

克服这个问题的一种方法是创建自己的指令并观察`readOnly`属性的变化，如下所示：

```
app.directive('csReadonly', function() {
  return {
    restrict: "A",
    link: function(scope, iElement, iAttrs, controller) {
      scope.$watch(iAttrs.csReadonly, function(readonly) {
        iElement.select2(readonly ? 'disable' : 'enable');
      });
    }
  }
}); 
```

并像这样使用它：

```
<input ui-select2="{ tags: sometags }" cs-readonly="readOnly" ... /> 
```

**Plunker**：[http ://plnkr.co/edit/LBFDg2](http://plnkr.co/edit/LBFDg2)

该方法的优点是，如果将来 AngularUI 决定包含对 的支持`ng-readonly`，您只需替换`cs-`为`ng-`就可以了。

# windows-8 - 以编程方式将 Internet Explorer 磁贴更改为另一个浏览器

> ID：13765964
> 
> 赞同：0
> 
> 时间：2012-12-07T15:22:36.383
> 
> 标签：windows-8, microsoft-metro

在我看来，如果用户在 Windows 8 上安装了另一个浏览器，则 Internet Explorer 的默认磁贴应该更改为该新浏览器。但是，Chrome 或 Firefox 目前似乎没有这样做。是否甚至可以以编程方式将 IE 磁贴替换为另一个应用程序的磁贴？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:44:24.390

开始屏幕是操作系统级别的，应用程序无法访问磁贴顺序。如果他们有，用户将失去所有的个性化，因为每个应用程序都会将自己移动到第一行和第一列，正如 Raymond Chen 所说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T01:26:04.273

**你不能那样做。**

所有 Windows 商店应用程序都在沙盒环境中工作，并且无法访问核心 OS api。应用程序仅限于核心操作系统 api，因此恶意应用程序无法在用户不知情的情况下更改系统设置。

# git - Git - 从现有项目设置远程存储库，并有可能进一步推动

> ID：13765965
> 
> 赞同：0
> 
> 时间：2012-12-07T15:22:40.240
> 
> 标签：git, repository

在我的新项目中，我和我的团队将使用 Git。我们希望拥有自己的远程存储库。形成这个远程存储库，我们将进一步推送代码（我们不是在这个项目中工作的唯一团队，该项目已经存在并且存在 git 存储库）。不幸的是，我们对 git 并不熟悉。我可以将已经存在的存储库克隆到远程位置。之后，团队的其他成员将从远程位置复制到他们自己的计算机上。问题是远程存储库应该是“裸露的”（我不确定 jet 是什么意思）以允许推送到自身。根据这里的最佳答案：

[Git推送错误'[远程拒绝]主->主（当前已签出分支）'](https://stackoverflow.com/questions/2816369/git-push-error-remote-rejected-master-master-branch-is-currently-checked/2933656#2933656)

我必须“（...）删除该文件夹中除 .git 之外的所有文件。” 我不想丢失任何数据，该项目已经存在。此外，我不确定它将如何进一步推动变革。

在同一主题中有一个不错的第二个答案，我可以使用它：在远程存储库上创建额外的分支，但我不喜欢创建额外的不必要存在（新分支）的想法。

应该如何设置所有这些存储库？我将不胜感激任何对解决方案的解释——正如我在开头所写的那样——我对 git 并不熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:41:37.770

第一个问题是您为什么要为您的团队建立一个自己的存储库。我猜想“所有人”的存储库是用于实时部署的存储库。所以对你来说最简单的方法是使用这个 repo 并从中提取。为您的团队创建一个名为 dev 的新分支，您可以创建更多分支来开发项目的某些部分。例如，如果您的团队中的某个人必须开发留言簿，他会检查您为团队创建的 dev 分支。之后，他将创建一个名为“guestbook”的新分支，例如，他必须检查分支并开始开发应用程序。如果它完成了，您将分支“留言簿”合并到您的“开发”分支中以查看结果。如果您的开发分支运行良好，您可以将其合并到主存储库的主分支中以使该功能生效。

如果你真的想要在不同的服务器上拥有自己的存储库，你可以简单地使用 git init --bare 创建一个新的 git 存储库。将项目克隆或更新（获取/拉取）到您的本地计算机。将 .git/config 文件中的远程源更改为您的新服务器并将您的项目推送到那里。

希望它有所帮助 - 但如果我是你，我会坚持在树枝上。有一天，您可能希望将团队的工作放回原始项目中，如果您在同一项目的单独存储库上开发，您将有更多的工作来完成。

# redis - Redis Cluster 与 ZeroMQ 在 Pub/Sub 中，用于水平扩展的分布式系统

> ID：13765969
> 
> 赞同：19
> 
> 时间：2012-12-07T15:23:01.130
> 
> 标签：redis, publish, publish-subscribe, zeromq, subscription

如果我要设计一个巨大的分布式系统，其吞吐量应该与系统中的订阅者数量和通道数量成线性关系，哪个更好？

1）**Redis Cluster**（仅适用于Redis 3.0 alpha，如果它是集群模式，你可以在一个节点上发布并在另一个完全不同的节点上订阅，消息会传播并到达你）。Publish 的复杂度是**O(N+M)**，其中 N 是订阅客户端的数量，M 是系统中订阅模式的数量，但是在 Redis 集群中它如何扩展？我接受有根据的猜测。

2) **ZeroMQ**从 3.x 开始，它进行服务器端过滤，所以它也有一些时间复杂度，但我在文档中没有看到任何关于它的内容。如果我想扩展它，我可以让许多服务器发布到任何频道，每个订阅者将连接到所有服务器，并订阅所需的频道。这看起来不错。

那么，对于大型发布者系统的横向扩展，哪一个更适合呢？我应该研究哪些其他解决方案？请记住，我想最小化延迟和吞吐量，但能够水平扩展。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-07T21:51:37.957

我猜你想最小化延迟。通道数无关紧要。关键因素是发布者的数量和订阅者的数量，消息大小，每个发布者每秒的消息数量，每个订阅者接收到的消息数量，大致。ZeroMQ 每秒可以从一个节点到另一个节点处理数百万条小消息；您的瓶颈将在软件出现之前很久就出现在网络上。因此，大多数大容量 pubsub 架构使用 ZeroMQ 支持的 PGM 多播之类的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-29T14:51:30.110

在 Redis 中，就像在 ZeroMQ 中一样，瓶颈将是网络。Redis 每秒可以达到数百万条消息，至少与 ZeroMQ 一样多。

您应该知道，Redis 集群的当前实现使用节点间总线在所有集群节点上分发 PUBLISH 消息。这种方法假设 PUBLISH 在 Redis 上非常便宜（如[Github 上的本期](https://github.com/antirez/redis/issues/120)所述）。

但是，涉及的开销很小，即节点间通信。当您扩大规模时，这种开销将更加显着。我知道还有另一种[Redis Cluster 实现](http://redis-cloud.com/redis/developers/redis-cluster)——请注意，它是一种商业实现——其中通道或模式以与 Redis 密钥分布方式类似的方式分布在集群节点上。至少根据供应商的说法，这应该可以节省节点间通信的开销并提高性能，但我自己没有进行基准测试。

# google-maps-api-3 - Google-Map V3（Sprite）中的裁剪标记图标

> ID：13765971
> 
> 赞同：4
> 
> 时间：2012-12-07T15:23:05.997
> 
> 标签：google-maps-api-3, icons, sprite, marker

我在谷歌地图（V3）标记上显示。为了更快地加载图标，所有图标都存储在一个精灵中。我注意到图标有时会被裁剪（在底部或 / 和右边缘缺少 1 像素宽的边框）。有趣的是，您可以缩放地图，然后问题就消失了。这是谷歌的错误还是我做错了什么。Firefox、Chrome 和 IE 会出现此问题。

有没有人有类似的经验或解决问题的方法？

我为这个问题做了一个简化的例子。这个例子也可以在线访问： [http ://www.gps-tracks.com/MarkerIconSpriteProblem.aspx](http://www.gps-tracks.com/MarkerIconSpriteProblem.aspx)

```
var markerIcon = new google.maps.MarkerImage(
  "pictures/NetzCats/C03-MapSpritesS03.png",
  new google.maps.Size(20, 16),
  new google.maps.Point(140, 1600),
  new google.maps.Point(10, 8)
  //new google.maps.Size(20, 16)
);

var marker = new google.maps.Marker({
  position: myLatlng,
  map: map,
  title: 'Hello World!',
  icon: markerIcon
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T20:30:10.583

您正在使用 v3.10 [http://jsfiddle.net/skdz6/](http://jsfiddle.net/skdz6/)

```
src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false" 
```

使用 3.9 版一切正常[http://jsfiddle.net/skdz6/1/](http://jsfiddle.net/skdz6/1/)

```
src="https://maps.googleapis.com/maps/api/js?v=3.9&sensor=false" 
```

有人知道让它在 v3.10 中工作吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-21T20:40:49.453

自 google maps API 3.11 版以来，该`Icon`对象替换为`MarkerImage`. Icon 支持与 MarkerImage 相同的参数。

自版本以来，标记的属性定义得更加清晰。对我来说，这工作得更好。

一个示例可能如下所示：

```
var image = {
  url: place.icon,
  size: new google.maps.Size(71, 71),
  origin: new google.maps.Point(0, 0),
  anchor: new google.maps.Point(17, 34),
  scaledSize: new google.maps.Size(25, 25)
}; 
```

有关更多信息，请查看此网站：[https ://developers.google.com/maps/documentation/javascript/markers](https://developers.google.com/maps/documentation/javascript/markers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T15:33:39.353

您将图标缩小到一半大小，因此它不可避免地会丢失一个边框或另一个边框，并且您正在交换大小和点，以及属性的顺序。

试试这个：

```
 var markerIcon = new google.maps.MarkerImage(
      new google.maps.Point(5, 8), // anchor (POINT)
      new google.maps.Point(140, 1600),//<====== origin (POINT)
      new google.maps.Size(10, 8), //<======scaledSize (SIZE)
      new google.maps.Size(20, 16), //<====== Size (SIZE)          
      "pictures/NetzCats/C03-MapSpritesS03.png" //URL
    ); 
```

[**文档在这里**](https://developers.google.com/maps/documentation/javascript/reference#MarkerImage)。

# r - 如何随机化一个向量

> ID：13765972
> 
> 赞同：94
> 
> 时间：2012-12-07T15:23:14.533
> 
> 标签：r, vector, random, shuffle

我想在一个简单的单行命令中随机重组向量中数字的顺序？

我的特定向量 V 对于从 1 到 10 的每个值有 150 个条目：

```
V <- rep(1:10, each=150) 
```

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-12-07T15:24:39.053

是的。

```
sample(V) 
```

来自`?sample`：

> 对于“sample”，“size”的默认值是从第一个参数推断的项目数，因此“sample(x)”会生成“x”（或“1:x”）元素的随机排列。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-07T15:24:54.883

使用`sample`功能

```
V<-rep(1:10, each=150)

set.seed(001) # just to make it reproducible
sample(V) 
```

# android - 如何解决这个意图错误？

> ID：13765975
> 
> 赞同：0
> 
> 时间：2012-12-07T15:23:21.063
> 
> 标签：android, android-intent

我写了以下代码：

```
package com.aamir.cool;

import android.app.*;
import android.os.*;
import android.view.*;
import android.widget.*;

public class MainActivity extends Activity
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ImageView img = (ImageView)findViewById(R.id.facebook);
        img.setOnClickListener(new View.OnClickListener(){
            public void onClick(View v){
                Intent intent = new Intent();
                intent.setAction(Intent.ACTION_VIEW);
                intent.addCategory(Intent.CATEGORY_BROWSABLE);
                intent.setData(Uri.parse("http://www.facebook.com/exandrok?ref=tn_tnmn"));
                startActivity(intent);
            }
        });
    }
} 
```

我收到错误 "Unknown Entity Intent" 、 "Unknown type of variable intent" 。如何解决这些错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:24:28.400

将以下行添加到您的导入语句中：

```
import android.content.Intent;
import android.net.Uri; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:25:45.620

添加正确的导入语句

```
import android.content.Intent
import android.net.Uri; 
```

如果您使用的是 Eclipse，您可以使用以下快捷方式添加/组织/优化您的导入

`Cmd-shift-O`在 OSX 上

`Ctrl+Shift+O`在 Windows / Linux 上

> Rawkode 仍然出现 2 错误：“未知实体 'uri”和“未知成员 'com.aamir.cool.R.id 的主要成员”

请确保它`main.xml`确实存在于您的`layout`文件夹中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:39:22.247

导入android.content.Intent后；首先检查您的 xml 文件并确保您没有任何布局问题并删除您的 R.java 文件并让它再次生成。完成后右键单击您的项目 Android Projects -> Fix Project Properties 然后选择“项目”并单击“清除”，然后尝试再次运行代码。如果仍然无法使用 ctrl+a ctrl+x 并保存文件，请确保您没有错误并再次 ctrl+v 并尝试再次运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-05T04:48:04.323

尝试在生成包的主页中验证 AndriodManifest.xml，如 gen/com 文件夹中所示

# python - Python 类引用的命名约定是什么

> ID：13765980
> 
> 赞同：39
> 
> 时间：2012-12-07T15:23:35.843
> 
> 标签：python, naming-conventions, pep8

在 Python 中引用类的变量的命名约定是什么？

```
class MyClass(object):
    pass

# which one is correct?
reference_to_class = MyClass

# or
ReferenceToClass = MyClass 
```

这是另一个类似于我的情况的示例：

```
# cars.py
class Car(object):
    pass

class Sedan(Car):
    pass

class Coupe(Car):
    pass

class StatonWagon(Car):
    pass

class Van(Car):
    pass

def get_car_class(slug, config):
    return config.get(slug)

# config.py
CONFIG = {
    'ford-mustang': Coupe,
    'buick-riviera': Coupe,
    'chevrolet-caprice': Sedan,
    'chevy-wan' Van:
    'ford-econoline': Van
}

# main.py
from config.py import CONFIG
from cars import get_car_class

MyCarClass = get_car_class('buick-riviera')

my_car = MyCarClass() 
```

我更喜欢 ReferenceToClass，每个刚接触代码的人都知道它是一个类而不是一个实例。但正如[poplitea 所写](https://stackoverflow.com/questions/13765980/what-is-the-naming-convention-for-python-class-references#comment18923309_13766060)，文献参考会很棒。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-07T15:29:16.583

在模块级别第二个：

`ReferenceToClass = MyClass`

作为函数参数，第一个：

`reference_to_class = MyClass`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-08-28T11:54:27.733

**tl；博士**：对于全局/公共名称，使用`AllCaps`XORcist[说](https://stackoverflow.com/a/13766060/4298200)：

```
class Logger:
    pass

AliasLogger = Logger 
```

对于函数参数和函数局部变量，请明确说明您正在处理具有如下描述性名称的类对象：

```
def some_func(logger_class):
    pass 
```

或类似的东西

```
def some_func(my_class_classobj):
    pass 
```

当这个词`"class"`实际上在你的类名中时。对于`classobj`，另请参见`class_`和`klass`。

* * *

**分析/动机**（长版）

没有彻底阅读，但乍一看[PEP 8](http://www.python.org/dev/peps/pep-0008/)似乎并没有明确说明这一点（谷歌的 python 风格指南也没有）。

由于变量名可能只是python中的另一个[名称绑定](https://docs.python.org/2/reference/executionmodel.html#naming-and-binding)`=`，因此在我看来，将该名称与定义块绑定还是稍后将等号绑定到某个对象并不重要。

为此，我同意[XORcist](https://stackoverflow.com/a/13766060/611007)在模块级“别名”引用应遵守您的类命名标准，可能是 AllCaps：

```
class MyClass(object):
    pass

# good
ReferenceToClass = MyClass 
```

但是，当涉及到参数和变量名称时，应该`lowercase_underscores`应该适用，对吧？我对此不满意，因为它会将您推向实例与类引用的歧义。一个全小写的名字有可能是为了暗示对象是一个实例。就此而言，我建议使用“class”后缀为您的全小写、类引用变量名称添加后缀，如下所示：

```
class Logger(object):
    pass

def function_expecting_class_reference(logger_class):
    pass 
```

我将您的示例类重命名为`MyClass`，`Logger`因为在实际场景中只有少数类名包含字符串`"class"`。然而，在后一种情况下，我建议再次避免描述性命名的歧义。例如，您可以使用`classobj`后缀：

```
class MyClass(object):
    pass

def function_expecting_class_reference(another_param, my_class_classobj):
    ReferenceToClass = MyClass 
```

我倾向于采取的另一种选择是使用后缀`klass`，例如`my_class_klass`. 似乎不是每个人都得到后者，但无论如何我还没有测试他们是否会得到前者更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T15:31:13.563

我将其视为实例变量，PEP8 将其定义为使用 lowercase_underscore_style。（小写，必要时用下划线分隔单词以提高可读性。）

[http://www.python.org/dev/peps/pep-0008/#id34](http://www.python.org/dev/peps/pep-0008/#id34)

# ios6 - 如何为 mkannotation pin drop 添加延迟

> ID：13765982
> 
> 赞同：0
> 
> 时间：2012-12-07T15:23:41.847
> 
> 标签：ios6, mkmapview, mkannotation

在我的地图视图中，我将地图设置为打开，然后延迟 2 秒，地图会放大以显示我的 mkannotation，我一直在尝试做的是在视图完全放大后动画针落下，但没有无法做到这一点。

所以基本上我想在我的位置放置注释+引脚添加延迟。

我该怎么做呢？

编写我当前在 ViewDidLoad 中的代码，mkannotation 的代码是无效的 - showDetails：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view.

[mapView setMapType:MKMapTypeStandard];
[mapView setZoomEnabled:YES];
[mapView setScrollEnabled:YES];
MKCoordinateRegion region = { {0.0, 0.0 }, { 0.0, 0.0 } };
region.center.latitude = 54.5;
region.center.longitude = -3.5;
region.span.longitudeDelta = 10.0f;
region.span.latitudeDelta = 10.0f;
[mapView setRegion:region animated:NO];

[self performSelector:@selector(zoomInToMyLocation)
           withObject:nil
           afterDelay:2]; //will zoom in after 2 seconds
}

-(void)zoomInToMyLocation
{
MKCoordinateRegion region = { {0.0, 0.0 }, { 0.0, 0.0 } };
region.center.latitude = 51.502729 ;
region.center.longitude = -0.071948;
region.span.longitudeDelta = 0.19f;
region.span.latitudeDelta = 0.19f;
[mapView setRegion:region animated:YES];

[mapView setDelegate:self];

DisplayMap *ann = [[DisplayMap alloc] init];
ann.title = @"Design Museum";
ann.subtitle = @"Camberwell, London";
ann.coordinate = region.center;
[mapView addAnnotation:ann];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T04:25:42.393

如果您在设置区域*之前*设置了代理，您的代理将收到对[mapView:regionDidChangeAnimated](http://developer.apple.com/library/ios/documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/occ/intfm/MKMapViewDelegate/mapView%3aregionDidChangeAnimated%3a)的调用。滚动时会调用很多次，因此您可以做的是检查地图的当前中心点，当它足够接近您的目标中心点时，您可以添加注释。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [mapView setDelegate:self];
     ............
    haveAddedPin = false;
}

-(void)zoomInToMyLocation
{
    MKCoordinateRegion region = { {0.0, 0.0 }, { 0.0, 0.0 } };
    region.center.latitude = 51.502729 ;
    region.center.longitude = -0.071948;
    region.span.longitudeDelta = 0.19f;
    region.span.latitudeDelta = 0.19f;
    [mapView setRegion:region animated:YES];
}

-(void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(Boolean) animated)
{
    if (haveAddedPin == false && mapView.center == the coordinates of the target you are zooming to)
    {
        DisplayMap *ann = [[DisplayMap alloc] init];
        ann.title = @"Design Museum";
        ann.subtitle = @"Camberwell, London";
        ann.coordinate = region.center;
        [mapView addAnnotation:ann];
        haveAddedPin = true;
    }
} 
```

# jquery - 如何在struts2中使用struts2-jquery插件进行部分页面刷新？

> ID：13765983
> 
> 赞同：2
> 
> 时间：2012-12-07T15:23:54.233
> 
> 标签：jquery, json, struts2, struts2-jquery, struts2-json-plugin

我想在这个帮助下进行部分页面刷新。举一个场景，我们根据它的选择选项有一个下拉列表，我想刷新页面的 div 部分，其中数据根据下拉选择填充。

这个怎么做？

**更新 ：**

我试过这个：

JSP 代码：
在此下拉选择中，我想填充（刷新）div。

```
<s:form id="RoleListForm">
      <s:label value="Roles"/>
      // JSON Action populating roleNameList on page Load
      <s:url id="fetchJsonRoleListUrl" action="fetchJsonRoleList"/> 
      <sj:select
         name="idRoleInfo"
         id="idRoleInfoList"
         href="%{fetchJsonRoleListUrl}"
         list="roleNameList"
         onChangeTopics="reloadRolePrivilegesDiv"
         listKey="idRoleInfo"
         listValue="roleName"
         emptyOption="true"/>
  </s:form> 
```

这是我想根据 DD 选择填充的 div 代码，但我没有填充文本字段值：

// 页面加载的 JSON 动作

```
 <s:url id="roleDetailsUrl" action="roleDetailsAction" />
 <sj:div href="%{roleDetailsUrl}" formIds="RoleListForm"  reloadTopics="reloadRolePrivilegesDiv">
    <s:textfield id="idRoleName" name="roleName" />
    <s:textfield id="idRolePrivileges" name="privileges"/>
 </sj:div> 
```

我在浏览器上的 div 部分得到这个：

```
{"roleName":"IT User","privileges":"IT User"} 
```

**更新部分：**

动作类：

```
 public class GraphsAction extends ActionSupport {

private String startDate;
private String endDate;
private String bodyStats;
HomeService homeService = new HomeService();
SimpleDateFormat formatter = new SimpleDateFormat("dd-MM-yyyy");

 public String reloadDatePicker() {
    Date date1 = new Date();
    Date date2 = new Date();
    Map session = ActionContext.getContext().getSession();
    Integer loginId = (Integer) session.get("loginId");
    if (loginId != null) {
        List list = homeService.getAllGraphData(loginId);
        List chestList = homeService.getChestGraphData(loginId);
        List waistList = homeService.getWaistGraphData(loginId);
        List hipsList = homeService.getHipsGraphData(loginId);
        List bicepsList = homeService.getBicepsGraphData(loginId);
        if (bodyStats.equals("")) {
            UserStats usetsts = (UserStats) list.get(0);
            date1 = usetsts.getUpadtedDate();
            this.startDate = formatter.format(date1);
            UserStats usetsts1 = (UserStats) list.get(list.size() - 1);
            date2 = usetsts1.getUpadtedDate();
            this.endDate = formatter.format(date2);
        }
        if (bodyStats.equals("0")) {
            UserStats usetsts = (UserStats) list.get(0);
            date1 = usetsts.getUpadtedDate();
            this.startDate = formatter.format(date1);
            UserStats usetsts1 = (UserStats) list.get(list.size() - 1);
            date2 = usetsts1.getUpadtedDate();
            this.endDate = formatter.format(date2);
        }
        if (bodyStats.equals("1")) {
            UserStats usetsts = (UserStats) list.get(0);
            date1 = usetsts.getUpadtedDate();
            this.startDate = formatter.format(date1);
            UserStats usetsts1 = (UserStats) list.get(list.size() - 1);
            date2 = usetsts1.getUpadtedDate();
            this.endDate = formatter.format(date2);
        }
        if (bodyStats.equals("2")) {
            UserStats usetsts = (UserStats) list.get(0);
            date1 = usetsts.getUpadtedDate();
            this.startDate = formatter.format(date1);
            UserStats usetsts1 = (UserStats) list.get(list.size() - 1);
            date2 = usetsts1.getUpadtedDate();
            this.endDate = formatter.format(date2);
        }
         return SUCCESS;
}

public String getEndDate() {
    return endDate;
}

public void setEndDate(String endDate) {
    this.endDate = endDate;
}

public String getStartDate() {
    return startDate;
}

public void setStartDate(String startDate) {
    this.startDate = startDate;
}
  public String getBodyStats() {
    return bodyStats;
}

public void setBodyStats(String bodyStats) {
    this.bodyStats = bodyStats;
}

} 
```

Struts.xml：

```
<action name="jsonReloadDatePickerAction"  class="com.ebhasin.fitnessbliss.actions.GraphsAction" method="reloadDatePicker">
     <result  name="success">/jsps/datePicker.jsp</result>
 </action> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-14T18:09:34.300

我几乎所有的软件解决方案都必须这样做......！！这些就是我所做的

a) 使用来自服务器的所有必要数据加载页面，并在 HTML 源代码中将下拉按钮的 onchange 事件与 JS 中的函数链接。

b) 使用从服务器获得的数据填充/初始化页面。

c) 由于我们已经将下拉按钮的 onchange 事件与我们在 JS 中的实现联系起来，我们所要做的就是从这些函数（在 JS 中）进行 AJAX 调用并从服务器获取所需的数据。同样在当前 AJAX 请求完成的响应中，我们从服务器获取相关数据，然后我们使用 DOM 操作来使用所需数据更新页面。

我们必须坚持页面的所有元素/div 的 id，并使用 jQuery 来摆弄它们。

一切顺利。

PS：如果您需要相同的参考代码，请联系我...！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:38:05.213

其中一个选项是将当前位于您内部的内容放在`<sj:div>`单独的 JSP 页面中，并将您的`roleDetailsAction`操作配置为返回该页面而不是 json 结果。

# objective-c - 如何在 Objective-C 中使用访问器方法进行指针工作

> ID：13765990
> 
> 赞同：2
> 
> 时间：2012-12-07T15:24:30.113
> 
> 标签：objective-c, ios, pointers

基本问题陈述：

我有一个很好的理由在需要通过引用传递小数的应用程序中做一些指针幻想。

所以我有一个存储许多小数的类，所以假设它具有这样的属性：

```
@property (nonatomic) double myDecimalValue; 
```

我想通过引用其他类来传递它。

```
[someOtherObject sendMyDecimalByReference:&myDecimalValue]; 
```

但是，问题出现了！实际必须编写的方式（因为它是一个属性）是

```
[someOtherObject sendMyDecimalByReference:&decimalOrigin.myDecimalValue]; 
```

这无法在objective-c中编译

我通过编写以下内容来解决它

```
- (double *) myDecimalValueRef;

[someOtherObject sendMyDecimalByReference:[decimalOrigin myDecimalValue]]; 
```

除了我有几十个这样的小数，我不想为每个值都写那个愚蠢的包装函数。

在 Objective-C 中是否有一种仅使用 Getter 函数的速记方法？

让我们假设我有充分的理由不使用 NSNumber。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T15:53:56.127

您可以直接使用和访问实例变量而不是属性吗？然后它将以与 C 结构成员相同的方式工作......

```
@interface SomeClass : NSObject
{
    @public
    double myDecimalValue;
}

// Keep the getter or not, assuming you synthesize it in a way that uses the
// myDecimalValue ivar
@property (nonatomic) double myDecimalValue;

@end 
```

然后你可以通过这种方式访问​​它：

```
[someOtherObject sendMyDecimalByReference:&decimalOrigin->myDecimalValue]; 
```

当然，健壮性是有限的，`someOtherObject`当您实际取消引用该值时必须保持有效对象，如果您有子类/超类，您将不得不考虑这种设计......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T15:57:38.223

虽然远非理想，但您可以公开 ivars。我什至讨厌这样说，但这是一个可能的解决方案。

另一种选择是为每个小数创建一对属性。创建常规属性和引用属性：

```
@interface Foo : NSObject
    double _myDecimal;

@property (nonatomic, assign) double myDecimal;
@property (nonatomic, assign) double *myDecimalRef;
@end

@implementation Foo
@synthesize myDecimal = _myDecimal;

- (double *)myDecimalRef {
    return &_myDecimal;
}

- (void)setMyDecimalRef(double *)val {
    _myDecimal = *val;
}

@end 
```

现在您可以执行以下操作：

```
[someOtherObject sendMyDecimalByReference:decimalOrigin.myDecimalRef]; 
```

或者是这样的：

```
*decimalOrigin.myDecimalRef = 3.14; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:43:41.083

你看过 NSValue 类吗？它允许您将指针作为对象传递。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSValue_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSValue_Class/Reference/Reference.html)

# uploadify - Uploadify 使用多个文件，一个 mvc 控制器调用

> ID：13765994
> 
> 赞同：0
> 
> 时间：2012-12-07T15:24:32.537
> 
> 标签：uploadify

从我在 Stackoverflow 和 Google 中读到的所有内容来看，似乎我又一次被迫在 IE 周围工作。由于它不支持多，我被迫使用 Uploadify 或其他一些 3rd 方插件。感谢 Microsoft .. 我想验证是否无法使用 Uploadify 将多选文件自动批处理到一个 MVC 控制器调用中。我认为用户可以通过多种方式添加文件，然后按下按钮上传文件，但这是吗？？？什么插件允许用户选择 4 个文件，关闭文件浏览对话框，然后在一个 http post 中自动发送所有文件？？？？？？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T05:44:38.897

您可以查看[uploadify](http://www.uploadify.com/documentation)的文档，它可以使用选项选择多个文件`multi`。

您还可以使用 auto:false 选项在所有文件排队后上传。

这是排队后可以[上传的](http://www.uploadify.com/documentation/uploadify/upload/)

# asp.net-mvc - ELMAH - MVC 3 - 403 - 禁止：访问被拒绝

> ID：13765995
> 
> 赞同：35
> 
> 时间：2012-12-07T15:24:34.407
> 
> 标签：asp.net-mvc, elmah, elmah.mvc

我已经使用 NuGet[为 MVC 安装了 Elmah，我能够在数据库中登录成功错误。](https://github.com/alexanderbeletsky/elmah.mvc)唯一的问题是我无法访问`/elmah`URL 来访问错误日志页面。

这是我的配置的一部分，如果我有任何配置错误，请您指出吗？

谢谢

错误

> *403 - 禁止：访问被拒绝。
> 您无权使用您提供的凭据查看此目录或页面。*

在我的`web.config`：

```
 <appSettings>
    <add key="webpages:Version" value="1.0.0.0" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="elmah.mvc.disableHandler" value="false" />
    <add key="elmah.mvc.disableHandleErrorFilter" value="false" />
    <add key="elmah.mvc.requiresAuthentication" value="true" />
    <add key="elmah.mvc.allowedRoles" value="Administrator" />
    <add key="elmah.mvc.route" value="elmah" />
  </appSettings> 
```

在`global.asax`：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("elmah.axd");
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );
    } 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-12-07T15:31:58.420

（这全部来自文档/入门）

您不需要以下行：

```
routes.IgnoreRoute("elmah.axd"); 
```

下一行负责处理它。

您需要配置的所有内容都在您的`web.config`文件中。就像是：

```
<elmah>
  <security allowRemoteAccess="yes" />
  <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="mySqlConnString" />
</elmah>
<location path="elmah.axd">
  <system.web>
    <authorization>
      <allow roles="Administrator" />
      <deny users="*" />
    </authorization>
  </system.web>
</location> 
```

应该让你去。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-11-19T16:09:00.950

以防万一有人遇到我遇到的同样问题。

这是我的代码，这是错误的：

```
<elmah>
    <security allowremoteAccess="true" />
</elmah> 
```

问题是允许 r emoteAccess 中**的****r**，它是小写的，而它应该是大写的！

正确代码：

```
<elmah>
    <security allowRemoteAccess="true" />
</elmah> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-11T06:11:27.850

即使我已将远程访问添加到我的 web.config：

```
<add key="elmah.mvc.allowedRoles" value="adminrole" />  

<elmah>
      <security allowRemoteAccess="true" />
      <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="DefaultConnection" />
      </elmah> 
```

我必须在服务器上编辑 Elmah.Athz.config 并添加我想授予 elmah 访问权限的角色。我不得不添加`^adminrole`

# facebook - 从应用程序发布到 Facebook 时是否可以预先填充评论框？

> ID：13765998
> 
> 赞同：0
> 
> 时间：2012-12-07T15:24:38.987
> 
> 标签：facebook, facebook-like

我在我的应用程序中添加了 facebook 推荐/赞按钮。我想要的只是当用户点击推荐/喜欢按钮时，评论框应该预先填充一些默认文本。

是否有可能做到这一点？如果是这样，我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:10:55.113

如果您在谈论 facebook 评论框：这是不可能的。结帐：[Facebook Like Button with prepopulated Comment](https://stackoverflow.com/questions/7564550/facebook-like-button-with-prepopulated-comment)

否则，如果它是自定义评论框，则需要通过 javascript SDK 完成。[在此处查看](https://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)有关在页面上订阅喜欢事件的文档。