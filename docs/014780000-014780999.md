# StackOverflow 问答 14780000-14780999

# excel - 优秀；在受保护的工作表上更新另一个单元格后更改单元格

> ID：14780000
> 
> 赞同：-1
> 
> 时间：2013-02-08T19:32:04.280
> 
> 标签：excel, vba

**编辑：如果我使用 ActiveSheet.unprotect 代替**

好的，如果我的工作表不受保护，以下工作正常！

```
Private Sub Worksheet_Change(ByVal Target As Range)

On Error GoTo Reset_EnableEvents
Application.EnableEvents = False

If Not Intersect(Target, Range("D6:G6")) Is Nothing Then 'do the following if D6 is updated
Range("D7").Interior.ColorIndex = 15
    If Range("D6") = "No" Then
        Range("D7").Interior.ColorIndex = 38
    End If
End If

If Not Intersect(Target, Range("D7:G7")) Is Nothing Then 'do the following if D6 is updated
    If Range("D7") <> "" Then
        Range("D7").Interior.ColorIndex = 15
    End If
End If

If Not Intersect(Target, Range("e12:f12")) Is Nothing Then 'do the following if E12:F12 is updated

    Range("d28").Value = Range("e12").Value 'set d28 to date entered in e12
    Range("c23").Interior.ColorIndex = 36 ' reset color of cell c23

    If Range("e12") = "" Then ' do the following if e12 is empty
        Range("c39") = Chr(34) & "Do you work period?" & Chr(34)
    Else
        Range("c39") = Chr(34) & "Do you work beyond " & Range("e13").Text & " (approx. period)?" & Chr(34)

            If Date >= Range("e15").Value Then
                Range("c23").Interior.ColorIndex = 3
            End If
    End If

End If

If Not Intersect(Target, Range("E32")) Is Nothing Then 'do the following if E32 is updated
    If Range("e32") = "Yes" Then
        MsgBox "Please have the client complete a MVA Questionnaire."
    End If
End If

If Not Intersect(Target, Range("E41")) Is Nothing Then 'do the following if E41 is updated
    If Range("e41") = "Yes" Then
        Range("d42").Interior.ColorIndex = 38
    ElseIf Range("e41") = "No" Then
        Range("d42").Interior.ColorIndex = 36
        Range("d42") = "Not Required"
    ElseIf Range("e41") = "" Then
        Range("d42").Interior.ColorIndex = 36
        Range("d42") = ""
    End If
End If

Reset_EnableEvents:
Application.EnableEvents = True
End Sub 
```

但是当我保护工作表并只允许选择未锁定的单元格并向工作表添加密码时，上述单元格背景颜色和单元格值不会更新

我尝试在开头和结尾添加 activeworksheet.unprotect 和protect ，它仍然无法正常工作！

```
Private Sub Worksheet_Change(ByVal Target As Range)

On Error GoTo Reset_EnableEvents
Application.EnableEvents = False

'ActiveWorkSheet.Unprotect Password:="a"

`..... all the if not intersect

ActiveWorkSheet.Protect Password:="a"

Reset_EnableEvents:
Application.EnableEvents = True
End Sub 
```

我还尝试在每个 if 语句中添加保护和取消保护，但它仍然不起作用，

```
If Not Intersect(Target, Range("e12:f12")) Is Nothing Then 'do the following if E12:F12 is updated
ActiveWorkSheet.Unprotect Password:="a"
    Range("d28").Value = Range("e12").Value 'set d28 to date entered in e12
    Range("c23").Interior.ColorIndex = 36 ' reset color of cell c23

    If Range("e12") = "" Then ' do the following if e12 is empty
        Range("c39") = Chr(34) & "Do you work period?" & Chr(34)
    Else
        Range("c39") = Chr(34) & "Do you work beyond " & Range("e13").Text & " (approx. period)?" & Chr(34)

            If Date >= Range("e15").Value Then
                Range("c23").Interior.ColorIndex = 3
            End If
    End If
ActiveWorkSheet.Protect Password:="a"
End If 
```

帮助？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:36:20.433

我将其更改为`ActiveSheet.Protect`并且可以正常工作

# java - 透明的模糊视图，模糊了下面的布局

> ID：14780006
> 
> 赞同：49
> 
> 时间：2013-02-08T19:32:43.907
> 
> 标签：java, android

我有一个透明的线性布局，现在我正在寻找一种方法给它一个模糊效果，所以它下面的东西会变得模糊。就像 Windows 7 Aero 的外观（见截图）。

我知道你可以做这样的模糊效果：

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_BLUR_BEHIND); 
```

但这仅适用于出现对话框时模糊背景。

我已经在谷歌上搜索了将近一个小时，但我找不到任何东西。有人对如何做到这一点有任何建议吗？

谢谢

![Windows 7 Aero 效果](../Images/a0a87c5a2259f5ac0c27231ae572fb57.png)

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2014-05-29T06:50:17.213

在 android 上实时模糊仍然是一个障碍。以下是一些可行机制之间的综合比较：

> **StackBlur**`Onur` （已经在名字下的答案中列出`fastBlur`）：

它的外观（在半径 20 处）：

![在此处输入图像描述](../Images/e73b08426315d90ec0afa620ab81d469.png)

生成每个记录的时间（毫秒）`BitmapDrawable`：

```
I/(10266): Total time taken: 35
I/(10266): Total time taken: 54
I/(10266): Total time taken: 48
I/(10266): Total time taken: 36
I/(10266): Total time taken: 48
I/(10266): Total time taken: 39
I/(10266): Total time taken: 49
I/(10266): Total time taken: 50
I/(10266): Total time taken: 35
I/(10266): Total time taken: 47 
```

平均 => ~ 44.1 毫秒 => 每秒 22 个可绘制对象

> **渲染脚本**：

`ScriptIntrinsicBlur`提供始终如一的快速模糊。它使用支持库提供的 api 8 及更高版本。

它的样子（在半径 20 处）：

![在此处输入图像描述](../Images/2945c4dda0d60f1d913838622880c67b.png)

生成每个记录的时间（毫秒）`BitmapDrawable`：

```
I/(9342): Total time taken: 14
I/(9342): Total time taken: 16
I/(9342): Total time taken: 13
I/(9342): Total time taken: 28
I/(9342): Total time taken: 14
I/(9342): Total time taken: 12
I/(9342): Total time taken: 14
I/(9342): Total time taken: 19
I/(9342): Total time taken: 13
I/(9342): Total time taken: 13 
```

平均 => ~ 15.6 毫秒 => 每秒 64 个可绘制对象

> **渲染脚本（半径 = 3）+ 缩放（20%）**：

这是另一种获得体面（？）但*快速*模糊的方法。我们所做的是将位图缩放到其大小的一小部分——比如 20%——并将模糊算法应用于缩小的版本。完成后，我们将位图缩放到其原始大小。结果不如在原版上使用模糊算法，但还算过得去。另请注意，半径值不应太高，否则生成的位图将难以辨认。

它看起来像什么：

![在此处输入图像描述](../Images/ed0e8eeef5a4a5e117698e1c8ebec966.png)

生成每个记录的时间（毫秒）`BitmapDrawable`：

```
I/(11631): Total time taken: 5
I/(11631): Total time taken: 19
I/(11631): Total time taken: 3
I/(11631): Total time taken: 7
I/(11631): Total time taken: 7
I/(11631): Total time taken: 5
I/(11631): Total time taken: 7
I/(11631): Total time taken: 17
I/(11631): Total time taken: 5
I/(11631): Total time taken: 4 
```

平均 => ~ 7.9 毫秒 => 每秒 126 个可绘制对象

> **StackBlur（半径 = 3）+ 缩放（20%）**：

与上面#3 相同的概念。将大小减小到 20% 并在缩放的位图上应用 stackblur。

![在此处输入图像描述](../Images/59a758e244aba7c3fbb2e62f57ae34b0.png)

```
I/(12690): Total time taken: 4
I/(12690): Total time taken: 20
I/(12690): Total time taken: 4
I/(12690): Total time taken: 4
I/(12690): Total time taken: 5
I/(12690): Total time taken: 5
I/(12690): Total time taken: 4
I/(12690): Total time taken: 21
I/(12690): Total time taken: 3
I/(12690): Total time taken: 4 
```

平均 => ~ 7.4 毫秒 => 每秒 135 个可绘制对象

在 Nex4 上进行的测试。位图大小 - 200 像素 x 200 像素

**另一个提示**：方法`buildDrawingCache()`和`getDrawingCache()`本身需要很长时间。另一种方法是使用您需要模糊的视图尺寸创建位图：

```
Bitmap toDrawOn = Bitmap.createBitmap(viewWidth, viewHeight, Bitmap.Config.ARGB_8888);

// Create a canvas - assign `toDrawOn` as an offscreen bitmap to it
Canvas holdingCanvas = new Canvas(toDrawOn);

// Now, let the view draw itself on this canvas
yourView.draw(holdingCanvas); 
```

视图现已绘制`toDrawOn`，您可以随意使用它。

根据我的经验，这比生成和访问视图的绘图缓存要快得多。

如果您在实施上述 4 种方法中的任何一种时需要帮助，请在评论中告诉我。

请记住，上面的 GIF 已被缩小等等。如果您想查看原始屏幕捕获 (mp4) 文件 - 请查看此[链接](http://ge.tt/77kPl8i1/v/0?c)。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2014-05-24T01:35:26.333

这在我脑海中有一段时间了，由于您的问题，我刚刚实现了它。

为此，我们需要将模糊布局下方的布局绘制为位图。与使用模糊算法相比，我们需要模糊该位图，最后绘制模糊位图作为我们的模糊布局的背景。

幸运的是 android 有缓存绘图机制，所以第一部分很容易。我们可以简单地为我们的下方布局启用缓存绘图，并`getDrawingCache()`从中获取位图。

现在我们需要一个快速的模糊算法。我用这个[https://stackoverflow.com/a/10028267/3133545](https://stackoverflow.com/a/10028267/3133545)

这里是。

```
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.ColorFilter;
import android.graphics.Paint;
import android.graphics.PixelFormat;
import android.graphics.drawable.Drawable;
import android.util.Log;
import android.view.View;

import java.lang.ref.WeakReference;
import java.util.InputMismatchException;

/**
 * A drawable that draws the target view as blurred using fast blur
 * <p/>
 * <p/>
 * TODO:we might use setBounds() to draw only part a of the target view
 * <p/>
 * Created by 10uR on 24.5.2014.
 */
public class BlurDrawable extends Drawable {

    private WeakReference<View> targetRef;
    private Bitmap blurred;
    private Paint paint;
    private int radius;

    public BlurDrawable(View target) {
        this(target, 10);
    }

    public BlurDrawable(View target, int radius) {
        this.targetRef = new WeakReference<View>(target);
        setRadius(radius);
        target.setDrawingCacheEnabled(true);
        target.setDrawingCacheQuality(View.DRAWING_CACHE_QUALITY_AUTO);
        paint = new Paint();
        paint.setAntiAlias(true);
        paint.setFilterBitmap(true);
    }

    @Override
    public void draw(Canvas canvas) {
        if (blurred == null) {
            View target = targetRef.get();
            if (target != null) {
                Bitmap bitmap = target.getDrawingCache(true);
                if (bitmap == null) return;
                blurred = fastBlur(bitmap, radius);
            }
        }
        if (blurred != null && !blurred.isRecycled())
            canvas.drawBitmap(blurred, 0, 0, paint);
    }

    /**
     * Set the bluring radius that will be applied to target view's bitmap
     *
     * @param radius should be 0-100
     */
    public void setRadius(int radius) {
        if (radius < 0 || radius > 100)
            throw new InputMismatchException("Radius must be 0 <= radius <= 100 !");
        this.radius = radius;
        if (blurred != null) {
            blurred.recycle();
            blurred = null;
        }
        invalidateSelf();
    }

    public int getRadius() {
        return radius;
    }

    @Override
    public void setAlpha(int alpha) {
    }

    @Override
    public void setColorFilter(ColorFilter cf) {

    }

    @Override
    public int getOpacity() {
        return PixelFormat.TRANSLUCENT;
    }

    /**
     * from https://stackoverflow.com/a/10028267/3133545
     * <p/>
     * <p/>
     * <p/>
     * Stack Blur v1.0 from
     * http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html
     * <p/>
     * Java Author: Mario Klingemann <mario at quasimondo.com>
     * http://incubator.quasimondo.com
     * created Feburary 29, 2004
     * Android port : Yahel Bouaziz <yahel at kayenko.com>
     * http://www.kayenko.com
     * ported april 5th, 2012
     * <p/>
     * This is a compromise between Gaussian Blur and Box blur
     * It creates much better looking blurs than Box Blur, but is
     * 7x faster than my Gaussian Blur implementation.
     * <p/>
     * I called it Stack Blur because this describes best how this
     * filter works internally: it creates a kind of moving stack
     * of colors whilst scanning through the image. Thereby it
     * just has to add one new block of color to the right side
     * of the stack and remove the leftmost color. The remaining
     * colors on the topmost layer of the stack are either added on
     * or reduced by one, depending on if they are on the right or
     * on the left side of the stack.
     * <p/>
     * If you are using this algorithm in your code please add
     * the following line:
     * <p/>
     * Stack Blur Algorithm by Mario Klingemann <mario@quasimondo.com>
     */
    private static Bitmap fastBlur(Bitmap sentBitmap, int radius) {

        Bitmap bitmap = sentBitmap.copy(sentBitmap.getConfig(), true);

        if (radius < 1) {
            return (null);
        }

        int w = bitmap.getWidth();
        int h = bitmap.getHeight();

        int[] pix = new int[w * h];
        Log.e("pix", w + " " + h + " " + pix.length);
        bitmap.getPixels(pix, 0, w, 0, 0, w, h);

        int wm = w - 1;
        int hm = h - 1;
        int wh = w * h;
        int div = radius + radius + 1;

        int r[] = new int[wh];
        int g[] = new int[wh];
        int b[] = new int[wh];
        int rsum, gsum, bsum, x, y, i, p, yp, yi, yw;
        int vmin[] = new int[Math.max(w, h)];

        int divsum = (div + 1) >> 1;
        divsum *= divsum;
        int dv[] = new int[256 * divsum];
        for (i = 0; i < 256 * divsum; i++) {
            dv[i] = (i / divsum);
        }

        yw = yi = 0;

        int[][] stack = new int[div][3];
        int stackpointer;
        int stackstart;
        int[] sir;
        int rbs;
        int r1 = radius + 1;
        int routsum, goutsum, boutsum;
        int rinsum, ginsum, binsum;

        for (y = 0; y < h; y++) {
            rinsum = ginsum = binsum = routsum = goutsum = boutsum = rsum = gsum = bsum = 0;
            for (i = -radius; i <= radius; i++) {
                p = pix[yi + Math.min(wm, Math.max(i, 0))];
                sir = stack[i + radius];
                sir[0] = (p & 0xff0000) >> 16;
                sir[1] = (p & 0x00ff00) >> 8;
                sir[2] = (p & 0x0000ff);
                rbs = r1 - Math.abs(i);
                rsum += sir[0] * rbs;
                gsum += sir[1] * rbs;
                bsum += sir[2] * rbs;
                if (i > 0) {
                    rinsum += sir[0];
                    ginsum += sir[1];
                    binsum += sir[2];
                } else {
                    routsum += sir[0];
                    goutsum += sir[1];
                    boutsum += sir[2];
                }
            }
            stackpointer = radius;

            for (x = 0; x < w; x++) {

                r[yi] = dv[rsum];
                g[yi] = dv[gsum];
                b[yi] = dv[bsum];

                rsum -= routsum;
                gsum -= goutsum;
                bsum -= boutsum;

                stackstart = stackpointer - radius + div;
                sir = stack[stackstart % div];

                routsum -= sir[0];
                goutsum -= sir[1];
                boutsum -= sir[2];

                if (y == 0) {
                    vmin[x] = Math.min(x + radius + 1, wm);
                }
                p = pix[yw + vmin[x]];

                sir[0] = (p & 0xff0000) >> 16;
                sir[1] = (p & 0x00ff00) >> 8;
                sir[2] = (p & 0x0000ff);

                rinsum += sir[0];
                ginsum += sir[1];
                binsum += sir[2];

                rsum += rinsum;
                gsum += ginsum;
                bsum += binsum;

                stackpointer = (stackpointer + 1) % div;
                sir = stack[(stackpointer) % div];

                routsum += sir[0];
                goutsum += sir[1];
                boutsum += sir[2];

                rinsum -= sir[0];
                ginsum -= sir[1];
                binsum -= sir[2];

                yi++;
            }
            yw += w;
        }
        for (x = 0; x < w; x++) {
            rinsum = ginsum = binsum = routsum = goutsum = boutsum = rsum = gsum = bsum = 0;
            yp = -radius * w;
            for (i = -radius; i <= radius; i++) {
                yi = Math.max(0, yp) + x;

                sir = stack[i + radius];

                sir[0] = r[yi];
                sir[1] = g[yi];
                sir[2] = b[yi];

                rbs = r1 - Math.abs(i);

                rsum += r[yi] * rbs;
                gsum += g[yi] * rbs;
                bsum += b[yi] * rbs;

                if (i > 0) {
                    rinsum += sir[0];
                    ginsum += sir[1];
                    binsum += sir[2];
                } else {
                    routsum += sir[0];
                    goutsum += sir[1];
                    boutsum += sir[2];
                }

                if (i < hm) {
                    yp += w;
                }
            }
            yi = x;
            stackpointer = radius;
            for (y = 0; y < h; y++) {
                // Preserve alpha channel: ( 0xff000000 & pix[yi] )
                pix[yi] = (0xff000000 & pix[yi]) | (dv[rsum] << 16) | (dv[gsum] << 8) | dv[bsum];

                rsum -= routsum;
                gsum -= goutsum;
                bsum -= boutsum;

                stackstart = stackpointer - radius + div;
                sir = stack[stackstart % div];

                routsum -= sir[0];
                goutsum -= sir[1];
                boutsum -= sir[2];

                if (x == 0) {
                    vmin[y] = Math.min(y + r1, hm) * w;
                }
                p = x + vmin[y];

                sir[0] = r[p];
                sir[1] = g[p];
                sir[2] = b[p];

                rinsum += sir[0];
                ginsum += sir[1];
                binsum += sir[2];

                rsum += rinsum;
                gsum += ginsum;
                bsum += binsum;

                stackpointer = (stackpointer + 1) % div;
                sir = stack[stackpointer];

                routsum += sir[0];
                goutsum += sir[1];
                boutsum += sir[2];

                rinsum -= sir[0];
                ginsum -= sir[1];
                binsum -= sir[2];

                yi += w;
            }
        }

        bitmap.setPixels(pix, 0, w, 0, 0, w, h);

        return (bitmap);
    }

} 
```

用法 ：

```
View beneathView = //the view that beneath blur view
View blurView= //blur View

BlurDrawable blurDrawable = new BlurDrawable(beneathView, radius);

blurView.setBackgroundDrawable(blurDrawable); 
```

以及我的测试应用程序的样子：

![测试申请](../Images/fa87fcc44f1d2df35a137a4426e820dc.png)

*我决定不使用它，因为它太老套了，而且看起来不像我想象的那么酷。*

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-05-29T09:57:55.477

[这是 GDE](https://plus.google.com/+MarioViviani/posts/fhuzYkji9zz?utm_source=Android%20Weekly&utm_campaign=0ebb6e887b-Android_Weekly_103&utm_medium=email&utm_term=0_4eb677ad19-0ebb6e887b-337837333) [Mario Viviani](https://plus.google.com/100707738835400160066)的“使用 Renderscript 有效地模糊图像”的好方法。

这是复制/粘贴：

模糊图像是许多开发人员需要实现的效果，可能需要一些时间和精力来实现。此外，由于需要进行大量图像处理，因此如果编码不当，在 CPU 和内存使用方面可能会非常痛苦。

有一种快速有效的模糊图像解决方案，即[Renderscript](http://developer.android.com/guide/topics/renderscript/compute.html)。

[自API 11](http://developer.android.com/about/versions/android-3.0.html) ( `Honeycomb`)起可用，`Renderscript`允许利用 GPU 加速并针对高性能 3D 渲染和计算操作。 `Renderscript`是一个非常复杂和清晰的产品，并且允许使用原生 C99 语言进行深度配置和编码，从而实现可移植性、性能和可用性。

但是，由于[API 17](http://developer.android.com/about/versions/android-4.2.html) (4.2.2)`Renderscript`提供了一些执行定义明确的操作的内置函数，称为 Intrinsics。Intrinsics 是预先编写的脚本，允许执行模糊、Blen、矩阵卷积等操作，而无需编写`Renderscript`代码。

这是我写的一个简单的方法，可以轻松地有效地将模糊滤镜应用于位图：

```
public Bitmap blurBitmap(Bitmap bitmap) {

    //Let's create an empty bitmap with the same size of the bitmap we want to blur
    Bitmap outBitmap = Bitmap.createBitmap(bitmap.getWidth(), bitmap.getHeight(), Config.ARGB_8888);

    //Instantiate a new Renderscript
    RenderScript rs = RenderScript.create(getApplicationContext());

    //Create an Intrinsic Blur Script using the Renderscript
    ScriptIntrinsicBlur blurScript = ScriptIntrinsicBlur.create(rs, Element.U8_4(rs));

    //Create the in/out Allocations with the Renderscript and the in/out bitmaps
    Allocation allIn = Allocation.createFromBitmap(rs, bitmap);
    Allocation allOut = Allocation.createFromBitmap(rs, outBitmap);

    //Set the radius of the blur
    blurScript.setRadius(25.f);

    //Perform the Renderscript
    blurScript.setInput(allIn);
    blurScript.forEach(allOut);

    //Copy the final bitmap created by the out Allocation to the outBitmap
    allOut.copyTo(outBitmap);

    //recycle the original bitmap
    bitmap.recycle();

    //After finishing everything, we destroy the Renderscript.
    rs.destroy();

    return outBitmap;
} 
```

![RenderScript 模糊图像](../Images/c5a00d5ec21df3ba1549572ec0fa5e04.png)

还有……瞧！位图模糊！:-)

请记住，要运行之前的代码，您需要最低 API 17 (4.2.2)。

这是此方法的要点： [https ://gist.github.com/Mariuxtheone/903c35b4927c0df18cf8](https://gist.github.com/Mariuxtheone/903c35b4927c0df18cf8)

如果您想了解更多关于 Intrinsics 的信息，请查看 Android 开发者博客上的这篇文章： [http ://android-developers.blogspot.it/2013/08/renderscript-intrinsics.html](http://android-developers.blogspot.it/2013/08/renderscript-intrinsics.html)

如果您有兴趣了解有关 Renderscript 的更多信息，请查看以下链接： [http :](http://android-developers.blogspot.it/2011/03/renderscript.html) [//android-developers.blogspot.it/2011/02/introducing-renderscript.html http://android-developers.blogspot.it/2011](http://android-developers.blogspot.it/2011/02/introducing-renderscript.html) [/03/renderscript.html](http://android-developers.blogspot.it/2011/03/renderscript.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-19T12:02:15.960

使用布局功能不容易做到这一点。

我建议将父视图绘制到画布上，如下所述：[如何使任何视图绘制到画布上？](https://stackoverflow.com/questions/17531858/how-to-make-any-view-to-draw-to-canvas)隐藏前景视图。然后，模糊画布并使用此数据作为背景或其中的一部分绘制前景视图。

如果您希望此效果生效，这将是非常耗费资源的操作。您至少应该尝试缓存模糊结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-02T09:43:12.013

步骤 1\. 剪切位图中需要模糊的背景图像部分。

步骤 2\. 模糊位图的那部分。

步骤 3\. 将位图设置为背景。

### 方法

```
private void applyBlur(final View image, final View layout) {
image.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {
        @Override
        public boolean onPreDraw() {
            image.getViewTreeObserver().removeOnPreDrawListener(this);
            image.buildDrawingCache();

            Bitmap bmp = image.getDrawingCache();

            Bitmap overlay = Bitmap.createBitmap((int) (layout.getMeasuredWidth()),
                    (int) (layout.getMeasuredHeight()), Bitmap.Config.ARGB_8888);

            Canvas canvas = new Canvas(overlay);

            canvas.translate(-layout.getLeft(), -layout.getTop());
            canvas.drawBitmap(bmp, 0, 0, null);

            RenderScript rs = RenderScript.create(getActivity());

            Allocation overlayAlloc = Allocation.createFromBitmap(
                    rs, overlay);

            ScriptIntrinsicBlur blur = ScriptIntrinsicBlur.create(
                    rs, overlayAlloc.getElement());

            blur.setInput(overlayAlloc);

            blur.setRadius(20);

            blur.forEach(overlayAlloc);

            overlayAlloc.copyTo(overlay);

            layout.setBackground(new BitmapDrawable(
                    getResources(), overlay));

            rs.destroy();
            return true;
        }
    });
} 
```

### ...

现在调用这个函数：

### 调用方法

applyBlur(detail_main_image, titleLayout);

### ...

//其中detail_main_image是我必须在其上显示模糊部分的图像//并且titleLayout是我必须在其上设置背景模糊的视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-20T14:31:27.380

如果您为此创建自定义视图，则可以使用**maskFilter**属性使视图模糊：

```
private val paint = Paint(ANTI_ALIAS_FLAG)
private val path = Path()

init {
    paint.maskFilter = BlurMaskFilter(15f, BlurMaskFilter.Blur.NORMAL)
}

override fun onDraw(canvas: Canvas) {
    super.onDraw(canvas)
    ...
    canvas.drawPath(path, paint)
} 
```

# python - Python 列表到 Cython

> ID：14780007
> 
> 赞同：17
> 
> 时间：2013-02-08T19:32:45.573
> 
> 标签：python, arrays, cython

我想知道如何使用 Cython 将普通的 python 列表转换为 C 列表，处理它并返回一个 python 列表。像：

Python脚本：

```
import mymodule

a = [1,2,3,4,5,6]
len = len(a)
print(mymodule.process(a,len)) 
```

Cython 脚本（mymodule.pyd）：

```
cpdef process(a, int len):
    cdef float y
    for i in range(len):
        y = a[i]
        a[i] = y * 2
    return a 
```

我阅读了有关 MemoryView 和许多其他内容的信息，但我并不真正理解发生了什么，并且很多示例都使用 Numpy（我不想使用它来避免我的脚本的用户下载一个大包......无论如何我认为它不是'不能使用我的软件）。我需要一个非常简单的例子来理解到底发生了什么。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-08T20:03:52.423

您需要将列表的内容显式复制到数组中。例如...

```
cimport cython
from libc.stdlib cimport malloc, free

...

def process(a, int len):

    cdef int *my_ints

    my_ints = <int *>malloc(len(a)*cython.sizeof(int))
    if my_ints is NULL:
        raise MemoryError()

    for i in xrange(len(a)):
        my_ints[i] = a[i]

    with nogil:
        #Once you convert all of your Python types to C types, then you can release the GIL and do the real work
        ...
        free(my_ints)

    #convert back to python return type
    return value 
```

# c# - 反序列化 XML 为集合属性返回 null

> ID：14780008
> 
> 赞同：7
> 
> 时间：2013-02-08T19:32:46.427
> 
> 标签：c#, xml, deserialization, xmlserializer

我正在尝试反序列化以下 XML：

```
<?xml version="1.0" encoding="utf-8" ?> 
<mf:somedata xmlns:mf="urn:somedata">
    <CurrentAccount>
        <AccountType>test</AccountType>
        <Charge>
            <ChargeType>test</ChargeType>
        </Charge>
    </CurrentAccount>
    <CurrentAccount>
        <AccountType>test 2</AccountType>
        <Charge>
            <ChargeType>test 2</ChargeType>
        </Charge>
    </CurrentAccount>
</mf:somedata> 
```

使用以下类：

```
[XmlRoot("somedata", Namespace = "urn:somedata")]
public class MfCurrentAccounts
{
    [XmlElement("CurrentAccount")]
    public CurrentAccount[] CurrentAccounts { get; set; }
}

public class CurrentAccount
{
    public string AccountType { get; set; }

    [XmlElement("Charge")]
    public Charge[] Charges { get; set; }
}

public class Charge
{
    public string ChargeType { get; set; }
}

var c = new XmlSerializer(typeof(MfCurrentAccounts)).Deserialize(new StringReader(xml)) as MfCurrentAccounts;

c.CurrentAccounts // <-- is always null 
```

但是无论我尝试什么，当我反序列化 CurrentAccounts 数组时它都是空的。我已经尝试了所有我能想到的属性组合（我也尝试过 XmlArray 和 XmlArrayItem）。

我究竟做错了什么？:S

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:58:16.807

问题在于命名空间。

当我在测试情况下创建整个类设置时，我得到了一个非常不同的输出。这是我认为您应该尝试阅读的内容：

```
 <?xml version="1.0"?>
    <mf:somedata xmlns:mf="urn:somedata">
        <mf:CurrentAccount>
            <mf:AccountType>something 1</mf:AccountType>
            <mf:Charge>
                <mf:ChargeType>Charge Type 1</mf:ChargeType>
            </mf:Charge>
        </mf:CurrentAccount>
        <mf:CurrentAccount>
            <mf:AccountType>something 2</mf:AccountType>
            <mf:Charge>
                <mf:ChargeType>Charge Type 2</mf:ChargeType>
            </mf:Charge>
        </mf:CurrentAccount>
    </mf:somedata> 
```

注意所有额外的`mf:`。当您声明命名空间时，序列化程序将使用该命名空间，并且仅反序列化正确属于该命名空间的节点。您要么需要完全摆脱它，要么适当地修复您的输入。这是我用来生成该输出*注释的代码：类定义完全不变*

```
XmlSerializer ser = new XmlSerializer(typeof(MfCurrentAccounts));
XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
ns.Add("mf", "urn:somedata");

MemoryStream ms = new MemoryStream();
ser.Serialize(ms, a, ns); 
```

并在重新阅读时：

```
ms.Position = 0;
b = ser.Deserialize(ms) as MfCurrentAccounts; 
```

在运行这两个部分之后，b 现在是 a 的完美克隆，我上面显示的 xml 是生成的 xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:50:57.510

也许您应该尝试将您的 MfCurrentAccounts 类替换为：

```
[XmlRoot("somedata", Namespace = "urn:somedata")]
public class MfCurrentAccounts : List<CurrentAccount>
{
   public MfCurrentAccounts():base()
   {}

} 
```

或者看看[https://stackoverflow.com/a/364410/1236044](https://stackoverflow.com/a/364410/1236044)

希望这会有所帮助

# c# - 使用 Jquery-Ajax 请求返回特定值

> ID：14780015
> 
> 赞同：0
> 
> 时间：2013-02-08T19:33:12.823
> 
> 标签：c#, ajax, jquery, data-binding, knockout.js

我正在开发一个带有 knockout.js 的网络表单。有一次，我根据列表中的选定值得到一个值`select`。我在 viewModel 中有以下代码：

```
 self.discoveryForms = ko.observableArray([]);
        self.selectedTemplate = ko.observable();
        self.selectedDiscoveryForm = ko.observable();

        //behaviors
        self.selectedTemplate.subscribe(function (newValue) {
            console.log(newValue.DiscoveryFormID());

            self.GetDiscoveryForms(newValue.DiscoveryFormID());
        });

        self.GetDiscoveryForms = function (discoveryFormID) {
            console.log(discoveryFormID);
            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                data: "{ID: '" + discoveryFormID + "'}",
                url: ("Default.aspx/GetDiscoveryForms"),
                dataType: "json",                    
                success: function (response) { self.FindDiscoveryForms(response), console.log(response)}
                });
        }

        self.FindDiscoveryForms = function (response) {
            ko.mapping.fromJS(response.d, null, viewModel.discoveryForms);
            ko.applyBindings(viewModel);
        } 
```

从实体获取数据的 c# 是这样的：

```
 [WebMethod]
public static List<DiscoveryForm> GetDiscoveryForms(){
    List<DiscoveryForm> discoveryForms = new List<DiscoveryForm>();

    using (IntranetContainer db = new IntranetContainer())
    {
        discoveryForms = db.DiscoveryForms.Select(x => new DiscoveryForm()
        {
            ID = x.ID,
            Name = x.Name,
            Welcome = x.Welcome,
            WelcomeNote = x.WelcomeNote,
            WelcomeBack = x.WelcomeBack,
            WelcomeBackNote = x.WelcomeBackNote
        }).ToList();
    }

    return discoveryForms;
}

public class DiscoveryForm
{
    public long ID { get; set; }
    public string Name { get; set; }
    public string Welcome { get; set; }
    public string WelcomeNote { get; set; }
    public string WelcomeBack { get; set; }
    public string WelcomeBackNote { get; set; }
} 
```

问题是，虽然我希望 ajax 请求只返回`ID`由 选择的发现表单`selectedTemplate`，但它目前将所有值返回到数组中。我认为那`data: "{ID: '" + discoveryFormID + "'}",`会做到这一点。有人可以向我解释为什么会这样以及如何解决吗？我应该在 c# 方面做些什么吗？我是 javascript、ajax 和 knockout.js 的新手。

为了纠正这个问题，查询必须如下所示：

```
 data: "{'id':"+discoveryFormID + "}", 
```

并且根据下面的答案更改了c#方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:08:54.257

您的服务必须看起来像

```
public static List<DiscoveryForm> GetDiscoveryForms(int[] ids){ 
```

然后这个参数必须用于查询。

现在你没有任何东西可以缩小你的范围。

# mysql - 准备好的声明：如何加入标题

> ID：14780016
> 
> 赞同：0
> 
> 时间：2013-02-08T19:33:14.530
> 
> 标签：mysql, join, prepared-statement, pivot

我有 2 个表，我想在其中加入准备好的语句中的标题和第一列。我已经设法加入专栏，但如何加入标题？

**表格1 ：**

```
 ID |Name 
----------
  1  |  A  
  2  |  B  
  3  |  C  
  4  |  D  
  5  |  E 
```

**表2：**

```
TeamA|TeamB|Won|Lost
--------------------
  1  |  2  | 5 | 3
  1  |  3  | 2 | 4
  1  |  4  | 9 | 1
  2  |  5  | 5 | 5
  3  |  1  | 2 | 4 
```

**结果矩阵：**

```
 |  A | B |  C | D | E
----------------------------
  A  |  0 | 2 | -2 | 8 | 0
  B  |  0 | 0 |  0 | 0 | 0
  C  | -2 | 0 |  0 | 0 | 0 
```

[SQL小提琴](http://sqlfiddle.com/#!2/3e22e/2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:50:51.363

为了从 ids 中获取团队名称，您必须在桌子上加入两次。

如果您知道所有值，则代码的静态版本为：

```
select a.name teamA,
  max(case when b.name = 'A' then won - lost else 0 end) as A,
  max(case when b.name = 'B' then won - lost else 0 end) as B,
  max(case when b.name = 'C' then won - lost else 0 end) as C,
  max(case when b.name = 'D' then won - lost else 0 end) as D,
  max(case when b.name = 'E' then won - lost else 0 end) as E
from yourtable t
left join teams a
  on t.teama = a.id
left join teams b
  on t.teamb = b.id
group by a.name; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/3e22e/31)。

然后，如果您使用准备好的语句来动态创建它，代码将是：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MAX(CASE WHEN TeamB = ''',
      TeamB,
      ''' THEN won - lost else 0 END) AS `',
      TeamB, '`'
    )
  ) INTO @sql
from
(
  select a.name TeamA,
    b.name TeamB,
    t.won,
    t.lost
  from yourtable t
  left join teams a
    on t.teama = a.id
  left join teams b
    on t.teamb = b.id
  order by teamb
) x;

SET @sql 
  = CONCAT('SELECT TeamA, ', @sql, ' 
           from
           (
             select a.name TeamA,
              b.name TeamB,
              t.won,
              t.lost
            from yourtable t
            left join teams a
              on t.teama = a.id
            left join teams b
              on t.teamb = b.id
           ) s
           group by TeamA');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/3e22e/30)

结果是：

```
| TEAMA |  A | B | C | D | E |
------------------------------
|     A |  0 | 2 | 0 | 8 | 0 |
|     B |  0 | 0 | 0 | 0 | 0 |
|     C | -2 | 0 | 0 | 0 | 0 | 
```

# hadoop - Piglatin：根据袋子中的值过滤记录

> ID：14780017
> 
> 赞同：3
> 
> 时间：2013-02-08T19:33:21.753
> 
> 标签：hadoop, apache-pig

我是 Piglatin 的新手，我有一个看起来像这样的数据文件（消息、电子邮件、用户会话、垃圾邮件类型）

为了简单起见，我只使用了垃圾邮件/非垃圾邮件-该字段的值通常是大约 100 种不同的变体

```
message1  user1@email  12345      spam
message2  user1@email  12345      spam
message3  user1@email  12345      not-spam

message10  user2@email  90879      not-spam
message11  user2@email  90879      not-spam 
```

如果来自一个用户的任何一条消息被标记为垃圾邮件，我只需要 - 删除/过滤他的所有消息。所以上面的输出看起来像

```
message10  user2@email  90879      not-spam
message11  user2@email  90879      not-spam 
```

其他 3 条消息被删除 - 因为它们来自同一个用户/会话

我正在尝试使用分组和嵌套来解决上述问题。任何帮助表示赞赏

```
DATA = LOAD './spamdata' using PigStorage() as (message:chararray, mailid:chararray,  session:long, spamType:chararray);
GDATA = GROUP DATA BY (mailid,session); 
```

GDATA 看起来像

```
GDATA: {group: (message: chararray,session: long),DATA: {(message: chararray,mailid: chararray,session: long,spamType: chararray)}} 
```

我需要的只是从这个组中转储元素，其中包中的元素都没有“非垃圾邮件”类型的元素

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:24:18.293

你可以想出这样的东西：

```
DATA = LOAD....;
S =  FOREACH (FILTER DATA BY spamType == 'spam') GENERATE mailid, session;
SPAM = DISTINCT S;
JOINED = JOIN DATA BY (mailid, session) LEFT OUTER, SPAM BY (mailid, session);

RES = FOREACH (FILTER JOINED by SPAM::mailid is null)
  GENERATE $0 AS message, $1 AS mailid, $2 AS session, $3 AS spamType;

dump RES; 
```

这里的想法是首先识别那些垃圾邮件发送者。在对原始数据集执行左连接后，我们可以通过仅选择那些没有右表匹配的行来获得非垃圾邮件发送者列表（例如：SPAM::mailid 为空）。

# wpf - 无需登录即可发布到应用页面

> ID：14780020
> 
> 赞同：0
> 
> 时间：2013-02-08T19:33:40.827
> 
> 标签：wpf, facebook, facebook-c#-sdk

我目前正在使用 .NET/C# 开发一个多用户信息亭项目。当用户完成特定操作时，信息亭需要发布到自己的 Facebook 页面。我们不希望用户在自助服务终端上登录他们的个人 Facebook 帐户。

我很难弄清楚是否可以在没有用户登录的情况下将 Facebook 应用程序直接发布到关联的应用程序页面。我一直在研究应用程序访问令牌，但似乎这些令牌没有足够的向页面发表评论的权限。

我已经创建了我的 Facebook 应用程序页面，我打算看看我是否可以授予我的应用程序在该页面上发布的权限，但似乎在 Facebook 批准之前我实际上无法将应用程序添加到页面中。

我真的只是想知道我正在尝试做的事情是否可行，如果是这样，任何人都可以指出我解决这个问题的任何方向将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:20:49.420

你不能这样做。基本上，您将不得不以一种或另一种方式进行身份验证。您可以存储访问令牌并继续使用它，但您需要在某些时候使用 OAuth 来获取访问令牌。

应该注意的是，这与 Facebook C# SDK 无关，而是 Facebook 的图形 API 的工作方式。您可以在此处阅读有关页面身份验证的信息：[https ://developers.facebook.com/docs/howtos/login/login-as-page/](https://developers.facebook.com/docs/howtos/login/login-as-page/)

# ios - iOS 和国际化 - 一个 AppStore 包中的所有文件？

> ID：14780022
> 
> 赞同：0
> 
> 时间：2013-02-08T19:33:46.723
> 
> 标签：ios, xcode, internationalization, app-store

我有一个关于国际化的问题，但我在谷歌上搜索失败，所以我决定在这里问。

我正在编写一个包含大量资源（图像和影片剪辑）的应用程序。另外，我需要创建多个语言版本的应用程序。我的首要任务是使包的大小尽可能小，因为我不希望用户被迫下载包含资源所有可能语言版本的包。一种解决方案是创建 N 个项目，每个项目都包含特定语言的资源。它有一个主要缺点——维护起来要困难得多。

我的问题是：如果我使用 Apple 本地化应用程序的方式（即我将拥有多个 .lproj 文件夹），特定国家/地区的 AppStore 会仅下载特定语言的所需资源吗？如果没有，如何在不制作N个项目的情况下实现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:43:07.720

App Store 不会根据用户 App Store 的位置转储其余的资源文件。语言和区域设置在设备上确定；用户可以轻松地在设备上切换他们的语言，并使用支持该不同语言的应用程序，而无需重新下载。

至于不创建N个项目的方法，有多种方法：

*   您可以在线托管您的图像和视频剪辑，并且设备会根据设备语言确定要访问哪一个。有了这个，您可以按需下载（但应用程序需要持续的网络访问），或者在第一次运行应用程序时下载所有必需的文件（如果设备上的语言发生变化，则重新下载，这不是经常）

*   这更适用于图像，但图像可以有两个组件。不包含特定语言内容的背景和包含特定语言内容的叠加层。所有语言的背景都将保持不变，并且可以根据语言应用适当的叠加层。如果覆盖只是文本，那么所有这些覆盖的大小将比使用整个图像时小得多。

否则，您将需要使用 N 个项目。不过我不喜欢这个想法，因为将来维护起来会很痛苦，但有时如果您的应用程序是媒体繁重的，则可能需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:42:18.317

**简而言之：每个人都得到了一切。**

所有用户 - 无论 App Store 国家/地区 - 下载整个应用程序 - 包括应用程序可用的所有语言的所有资源。

您可能住在丹麦，但更喜欢在您的设备上使用英语或德语。因此，仅仅为丹麦人提供丹麦本地化是没有意义的。您也可能是居住在德国的意大利人。

# c++ - regex_replace 问题

> ID：14780027
> 
> 赞同：4
> 
> 时间：2013-02-08T19:34:14.760
> 
> 标签：c++, regex, string, c++11, visual-studio-2012

我正在使用**C++11**（Windows 7 64 位，Visual Studio 2012）

我正在使用循环将一些子字符串替换为另一个子字符串。我有一个文件，其中的数字用双斜杠 (//) 分隔。例如：

```
10//20//1 3//4//5 5//2//1 to 10 20 1 3 4 5 5 2 1 
```

但是，当我尝试使用**regex**进行操作时，似乎我做错了什么。没发生什么事。另外，我在哪里可以阅读更多关于**正则表达式 C++11的信息**

```
string fData(data.substr(2));
string replaceStr("10//20//1 3//4//5 5//2//1");
regex r("//"
regex_replace(fData,r," "); 
```

但什么也没发生。

就像我之前说的，如果您还可以指出**一个网页，我可以阅读更多关于此**的内容，除了答案。我有它的工作，但我想开始使用正则表达式。

***谢谢***

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T19:40:03.707

`regex_replace`不对字符串进行就地编辑；它**返回**输出字符串。

例如： `auto out = regex_replace(fData,r," ");`

在这个例子中，out 将是一个期望值的字符串（“10 20 1 3 4 5 5 2 1”）。[这个备忘单](http://cpprocks.com/wp-content/uploads/c++11-regex-cheatsheet.pdf)非常有用（来自[http://cpprocks.com/regex-cheatsheet/](http://cpprocks.com/regex-cheatsheet/)）。享受！

# objective-c - NSMutableArray 拒绝运行

> ID：14780029
> 
> 赞同：0
> 
> 时间：2013-02-08T19:34:23.057
> 
> 标签：objective-c, cocoa, nsmutablearray

我打算做可编辑的字符串数组。所以首先我创建了这个属性：

```
@property (strong, nonatomic) NSMutableArray *history; 
```

然后我做了懒惰的实例化：

```
- (NSMutableArray *)history
{
    if (!_history) _history=[NSMutableArray array];
    return _history;
} 
```

现在，当我只想向数组中添加一个对象时：

```
[self.history addObject:self.game.text] 
```

（self.game.text 是一个 NSString ，但在 Objective C 中我被告知它应该接收任何类型的类）

而且……即使是那种简单的方法也行不通。我没有收到任何错误，只是模拟器保持黑屏，屏幕女巫告诉“Theard 1：signal SIGABRT”

甚至不知道如何开始修复它......（当我将以下行作为评论时，应用程序运行良好。那条简单的线似乎造成了问题）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T19:38:18.950

内存管理、自动释放、弱（属性）特性以及所有这些你甚至没有听说过的可怕东西，因为你生活在 ARC 梦想中。

要解决这个问题：

```
if (!_history) self.history = [NSMutableArray array];
return _history; 
```

# java - 哪个布局管理器可以用 Java 制作这个布局？

> ID：14780031
> 
> 赞同：2
> 
> 时间：2013-02-08T19:34:29.157
> 
> 标签：java, swing, grid-layout

我想用java做这个布局：

![在此处输入图像描述](../Images/533305dff6912bfa94d003fd1fce2887.png)

NORTH 和 SOUTH 标签很容易通过 BorderLayout 实现。但其余的应该在中心位置。所以我试着把CENTER分成左右两个网格，把左边的网格分成3个不同的网格，但是它们并没有停留在我想要的位置，看起来也很复杂。也许有更简单的方法。

有谁有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:06:59.973

为了解决这种情况，我所做的是这样的：

```
 1\. The content pane will have the BorderLayout, the top JLabel and
    the bottom JLabel will go to their respective places using the   
    BorderLayout's PAGE_START and PAGE_END constraints. Now the   
    CENTER area is occupied by the BasePanel.
 2\. The BasePanel will have GridLayout (1 Rows, 2 Columns), with two
    JPanel, left and right.
 3\. Here right JPanel will have a GridLayout (3 Rows, 1, Columns
    , 10 HorizontalGap, 10 VerticalGap).
 4\. Left JPanel will have GridBagLayout with two JPanels one for
    GRID 0, 0 and other for GRID 0, 1.
 5\. The JPanel at Grid 0, 0 will have GridBagLayout, for JTextField
    and the JLabel.
 6\. The JPanel at Grid 0, 1 will have BorderLayout one for
    JTextArea and one for another JPanel with GridLayout having 
    2 JRadioButtons. 
```

这是代码，它为指定的输出执行上述任务：

```
import javax.swing.*;
import java.awt.*;
import java.util.Random;

/**
 * Created with IntelliJ IDEA.
 * User: Gagandeep Bali
 * Date: 2/10/13
 * Time: 1:23 PM
 * To change this template use File | Settings | File Templates.
 */
public class LayoutExample
{
    private JTextField tField;
    private JTextArea tArea1;
    private JTextArea tArea2;
    private JTextArea tArea3;
    private JTextArea tArea4;

    private JRadioButton leftRButton;
    private JRadioButton rightRButton;

    private GridBagConstraints gbc;

    private Random random;

    public LayoutExample()
    {
        gbc = new GridBagConstraints();
        random = new Random();
    }

    private void displayGUI()
    {
        JFrame frame = new JFrame("Nested Layout Example");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        JPanel contentPane = getPanel();
        contentPane.setLayout(new BorderLayout(5, 5));
        JLabel topLabel = new JLabel(
                        "PAGE_START Label", JLabel.CENTER);
        contentPane.add(topLabel, BorderLayout.PAGE_START);

        JPanel basePanel = getPanel();
        basePanel.setLayout(new GridLayout(1, 2));

        JPanel leftPanel = getPanel();
        leftPanel.setLayout(new GridBagLayout());
        leftPanel.setBorder(
                BorderFactory.createEmptyBorder(
                        10, 10, 10, 10));
        JLabel fieldLabel = new JLabel("Label", JLabel.CENTER);
        tField = new JTextField(20);

        JPanel topPanel = getPanel();
        topPanel.setLayout(new GridBagLayout());
        topPanel.add(fieldLabel, getConstraints(
                            0, 0, 1, 1
                , GridBagConstraints.HORIZONTAL, 0.3f, 0.1f));
        topPanel.add(tField, getConstraints(
                            1, 0, 2, 1
                , GridBagConstraints.HORIZONTAL, 0.7f, 1.0f));
        leftPanel.add(topPanel, getConstraints(
                        0, 0, 1, 1
                        , GridBagConstraints.BOTH, 1.0f, 0.40f));

        JPanel middlePanel = getPanel();
        middlePanel.setLayout(new BorderLayout(5, 5));
        tArea1 = new JTextArea(10, 10);
        middlePanel.add(tArea1, BorderLayout.CENTER);
        JPanel radioPanel = getPanel();
        radioPanel.setLayout(new GridLayout(1, 2, 5, 5));
        leftRButton = new JRadioButton("Left", false);
        rightRButton = new JRadioButton("Right", false);
        radioPanel.add(leftRButton);
        radioPanel.add(rightRButton);
        middlePanel.add(radioPanel, BorderLayout.PAGE_END);
        leftPanel.add(middlePanel, getConstraints(
                               0, 1, 1, 2
                             , GridBagConstraints.BOTH, 1.0f, 0.60f));
        basePanel.add(leftPanel);

        JPanel rightPanel = getPanel();
        rightPanel.setLayout(new GridLayout(0, 1, 10, 10));
        rightPanel.setBorder(
                BorderFactory.createEmptyBorder(
                                    10, 10, 10, 10));
        tArea2 = new JTextArea(10, 10);
        tArea3 = new JTextArea(10, 10);
        tArea4 = new JTextArea(10, 10);
        rightPanel.add(tArea2);
        rightPanel.add(tArea3);
        rightPanel.add(tArea4);
        basePanel.add(rightPanel);
        contentPane.add(basePanel, BorderLayout.CENTER);

        JLabel bottomLabel = new JLabel(
                "PAGE_END Label", JLabel.CENTER);
        contentPane.add(bottomLabel, BorderLayout.PAGE_END);

        frame.setContentPane(contentPane);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    private JPanel getPanel()
    {
        JPanel panel = new JPanel();
        panel.setOpaque(true);
        panel.setBackground(new Color(random.nextFloat()
                            , random.nextFloat(), random.nextFloat()
                                                , random.nextFloat()));
        panel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));

        return panel;
    }

    private GridBagConstraints getConstraints(
                            int x, int y, int w, int h, int fillValue
                                        , float weightx, float weighty)
    {
        //GridBagConstraints gbc = new GridBagConstraints();
        gbc.anchor = GridBagConstraints.FIRST_LINE_START;
        gbc.fill = fillValue;
        gbc.gridx = x;
        gbc.gridy = y;
        gbc.gridwidth = w;
        gbc.gridheight = h;
        gbc.weightx = weightx;
        gbc.weighty = weighty;

        return gbc;
    }

    public static void main(String... args)
    {
        Runnable runnable = new Runnable(){
                @Override
                public void run()
                {
                    new LayoutExample().displayGUI();
                }
        };
        EventQueue.invokeLater(runnable);
    }
} 
```

这是相同的输出：

![嵌套布局](../Images/a9eebb6d6e81b7d415f073be288f99d3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T19:44:25.790

`BorderLayout`为您的外部布局。

`NORTH`并且`SOUTH`是您各自的标签。

`EAST`or`CENTER`应该被分配一个嵌套`Panel`的，你分配一个`BoxLayout`，或者一个单列`GridLayout`，或者另一个`BorderLayout`（使用`NORTH`，`CENTER`和`SOUTH`）你把你的 3 `JTextAreas`。

`WEST`（或者`CENTER`如果`EAST`在前面的步骤中使用过）可以使用另一个嵌套`Panel`的，分配 a`GridBagLayout`或 a来完成`GroupLayout`。

[在此处](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)查看更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T19:44:07.750

正如你需要的想法，这里是：

*   创建两个面板左，右。

    *   在左侧面板上添加带有 BorderLayout.NORTH 的 JTF
    *   在左侧面板上添加带有 BorderLayout.CENTER 的 JTA
    *   在左侧面板上添加带有 FlowLayout 的单选按钮

    *   在右侧面板上添加带有 BorderLayout.NORTH 的 JTA1

    *   在右侧面板上添加带有 BorderLayout.CENTER 的 JTA2
    *   在右侧面板上添加带有 BorderLayout.BOTTOM 的 JTA3

# opengl - 在 OpenGL 中是否可以在现有转换之前将转换插入矩阵？（前缀乘法）

> ID：14780032
> 
> 赞同：0
> 
> 时间：2013-02-08T19:34:35.027
> 
> 标签：opengl, matrix, box2d, transformation

为了提供一些关于这个问题的背景知识，我正在使用 Box2D，并尝试使用内置的调试绘制功能来创建一个调试叠加层，这将使我能够在游戏图形上看到物理体的实际形状。问题出现在通过在渲染场景之前平移和旋转模型视图矩阵实现的移动视图系统以及 Box2D 坐标是屏幕坐标的较小比例因子的事实（在当前项目的情况下，我将屏幕坐标相乘） 0.05 得到 box2D 坐标）。这两个功能都可以独立正常工作。

当需要使用 Box2D 的调试渲染时，我可以通过缩放模型视图矩阵来轻松进行缩放，但前提是视图系统根本没有对其进行转换。之后，如果我对缩放的模型视图应用与使用视图系统对原始模型视图所做的相同的转换，我会得到正确的结果。我知道如何使它以相当昂贵的方式工作，但是如果有某种方法可以在 OpenGL 中插入转换（也就是使用前缀乘法而不是通常的后缀），那会容易得多。

我正在使用没有着色器的旧 OpenGL 内置矩阵，所以我只使用 glTranslate 和 glRotate 等函数来操作矩阵。有没有一种方法可以直接读取/写入矩阵中的值，或者使用某种 OpenGL 设置来应用转换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:46:38.403

> 有没有办法直接读取/写入矩阵中的值

是的`glGetDoublev`（我建议为此使用双精度）可以查询各个堆栈上的当前矩阵。见[http://www.opengl.org/sdk/docs/man2/xhtml/glGet.xml](http://www.opengl.org/sdk/docs/man2/xhtml/glGet.xml)

然后你可以使用

```
glPushMatrix();
glLoadIdentity();
your_transformation();
glMultMatrix(queried_matrix); 
```

在堆栈上的内容之前应用您自己的转换。使用`glPopMatrix`后自己清理。

# sql - 案例的 SQL 查询问题

> ID：14780034
> 
> 赞同：1
> 
> 时间：2013-02-08T19:34:43.620
> 
> 标签：sql, sql-server, tsql

您能否让我知道如何根据条件离开加入两个不同的表？我很感激任何帮助。

```
SELECT A.id,
       A.flag,
       B.fname,
       B.lname
FROM   Table1 A
       CASE 
            WHEN ISNULL(A.flag, 0) = 0 THEN LEFT
       JOIN Table2 B
            ON  B.id = A.id
                ELSE
       LEFT JOIN Table3 B
            ON  B.id = A.id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:39:34.747

你不能。但是您可以连接两个表，然后在`select`子句中选择您想要的值：

```
SELECT A.id, A.flag,
       (case when coalesce(A.flag, 0) = 0 then b.fname else c.fname end) as fname,
       (case when coalesce(A.flag, 0) = 0 then B.lname else c.lname end) as lname
FROM Table1 A left outer join
     Table2 B
     on B.id = A.id left outer join
     Table3 C
     on c.id = A.id 
```

如果 Table2 或 Table3 中有任何 id 的多行，这将产生额外的行。

作为一种通常效率较低的替代方法，您还可以执行以下操作：

```
select a.id, a.flag,
       MAX(case when coalesce(A.flag, 0) = 0 and which = 'b' or
                     coalesce(A.flag, 0) <> 0 and which = 'c'
                then b.fname
           end) as fname,
       MAX(case when coalesce(A.flag, 0) = 0 and which = 'b' or
                     coalesce(A.flag, 0) <> 0 and which = 'c'
                then b.lname
           end) as lname
from table1 A left outer join
     ((select b.*, 'b' as which from table2 b)
      union all
      (select c.*, 'c' as which from table3 c)
     ) b
group by a.id, a.flag 
```

这`group by`将消除不需要的重复项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:50:21.443

Since the table to join is dependent on the A.flag, you should apply that knowledge in the join clause...

```
SELECT A.id, A.flag, 
    fname = coalesce(t2.fname, t3.fname), 
    lname = coalesce(t2.lname, t3.lname)
FROM Table1 A
LEFT JOIN Table2 t2 on t2.id = A.id and isnull(A.flag, 0) = 0
LEFT JOIN Table3 t3 on t3.id = A.id and isnull(A.flag, 0) = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T19:43:51.590

```
SELECT A.id,
       A.flag,
       CASE 
            WHEN ISNULL(A.flag, 0) = 0 THEN B1.fname
            ELSE B2.fname
       END as fname,
       CASE 
            WHEN ISNULL(A.flag, 0) = 0 THEN B1.lname
            ELSE B2.lname
       END as lname
FROM   Table1 A
       LEFT JOIN Table2 B1
            ON  B1.id = A.id
       LEFT JOIN Table3 B2
            ON  B2.id = A.id 
```

尝试这个：

```
 CASE 
        WHEN ISNULL(A.flag, 0) = 0 THEN B1.fname + ' ' + B1.lname
            ELSE B2.fname + ' ' + B2.lname
        END as name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T19:45:03.497

你不能直接做。然而，有一种完全不直观的方式实际上是有效的。您使用不同的条件进行左连接并合并。像这样的东西。

```
select a.id
, coalesce(c.name, b.name, 'no name found') name

from tableA a left join tableB b on a.field1 = b.field1
left join tableC c on a.field1 = c.field2

etc 
```

# xcode - XCode 4.6 clang 分析器担心空 C++ 指针不能为空

> ID：14780043
> 
> 赞同：2
> 
> 时间：2013-02-08T19:35:23.540
> 
> 标签：xcode, clang, objective-c++

运行 XCode 4.6 的分析器和新的 clang 编译器，我看到很多警告

> 被调用的 C++ 对象指针为空

即使对于像这样的受保护的表达

```
- (BOOL) validate: (Node*) node
{
    if (!self.hypertext) return YES;
    return self.hypertext->HasNode(node);
} 
```

1）我怎样才能让静态分析仪相信这是得到妥善保护的？2) 在某些情况下，我可能想**断言**指针不会为空。如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T19:06:19.143

这里的问题是您没有使用指针，而是使用 ObjC 调用的结果。

虽然不太可能，但分析器会看到以下情况：第一次调用返回的指针不为空，因此测试通过，第二次调用返回的指针为空。

您应该能够使用局部变量来解决问题。

```
- (BOOL) validate: (Node*) node
{
    YourType ht = [self hypertext];
    if (!ht) return YES;
    return ht->HasNode(node);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:41:28.093

clang 静态分析器显然支持函数的“非空”属性，用于声明指针不应为空。不过，我不确定是否将其应用于 Obj-C 方法。

```
int bar(int*p, int q, int *r) __attribute__((nonnull(1,3))); 
```

[http://clang-analyzer.llvm.org/annotations.html#attr_nonnull](http://clang-analyzer.llvm.org/annotations.html#attr_nonnull)

# iphone - 应用委托对象

> ID：14780045
> 
> 赞同：3
> 
> 时间：2013-02-08T19:35:26.133
> 
> 标签：iphone, ios, objective-c, xcode

在我的 appdelegate 中，我声明了一个我开发的自定义类的对象。在我的视图控制器中，我添加了以下代码行：

```
AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
[appDelegate.dbConnector loadImages:self]; 
```

没有错误，但是即使编译器处理了 loadImages，它也不会进入函数。我已经使用断点来检查这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:36:54.543

您的`dbConnector`财产可能为零。确保您正在为该属性设置一个实例。您可以向 nil 发送任何消息，这样您就不会收到任何警告或错误。您的`dbConnector`属性默认为 nil，直到您为其分配了一些东西。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-06-09T06:18:09.470

```
[appDelegate.dbConnector loadImages:appDelegate]; 
```

# ios - 模仿 UISplitviewController 的 _detailitem 行为的正确方法

> ID：14780046
> 
> 赞同：0
> 
> 时间：2013-02-08T19:35:52.483
> 
> 标签：ios, objective-c, ipad

我的视图上有两个容器视图，试图模仿左侧的拆分视图控制器 tableview 和右侧的详细视图。在 master 上使用`didselect`row 时`tableview`，详细视图应显示一些详细信息

问题是当我将数据传递给详细视图控制器实例时，它总是返回 null。

在主人：

```
@property (nonatomic,strong) LogDetailViewController *wods;
UIStoryboard*  sb = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                                  bundle:nil];
    self.wods= [sb instantiateViewControllerWithIdentifier:@"LogDetailViewController"];
//also tried self.wods= [[LogDetailViewController alloc] init];
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
     //one of the if else method rest of it was too long
     else if ([indexPath section]==1){
        GIRLS *girls =[self.girlsList objectAtIndex:indexPath.row];
        self.wods.girls = girls;
        self.wods.section=1;
        [[NSNotificationCenter defaultCenter] postNotificationName:@"refreshLOGDetails" object:nil];
    }
} 
```

![在此处输入图像描述](../Images/0615857e5a77ddb04ad9c26c6be0dba3.png)

![在此处输入图像描述](../Images/12119de5055bf9275566b371af2c5d89.png)

![在此处输入图像描述](../Images/d50356669a1c5afdf97aee6eb7ca8f5f.png)

详细地：

```
@property  int section;
@property (nonatomic, strong) GIRLS *girls;
//refresh notification
extern NSString * const NOTIF_refreshLOGDetails;
@synthesize section;
@synthesize girls;

- (void)refreshLOGDetails:(NSNotification *)notif
{
    NSLog(@"Notification refreshLOGDetails works");
    [self configureView];
}
- (void)configureView
{  
 //also tried self.girls and self.section 
  NSLog(@"Section is %i",section);
  NSLog(@"configure view object %@",girls);

} 
```

输出：

```
Notification refreshLOGDetails works
Section is 0
configure view object (null) 
```

我做错了什么？为什么我得到空值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:26:09.757

我认为问题在于您在实例化 LogDetailViewController 或使用 alloc init 时创建了一个新实例。如果您在故事板的容器视图中将它们设置为控制器，那么您需要引用在那里创建的控制器，而不是创建新控制器。您可以使用 self.parentViewController 来获取对包含容器视图的控制器的引用。self.parentViewController.childViewControllers 将为您提供一个包含 master 和 detail 的数组——您只需要从该数组中获取正确的数组并将其返回即可。

# javascript - 用于媒体查询的 jQuery 调整大小功能

> ID：14780047
> 
> 赞同：2
> 
> 时间：2013-02-08T19:35:56.533
> 
> 标签：javascript, jquery, jquery-ui, jquery-mobile, jquery-events

我添加了重新调整大小功能，因为当我使用媒体查询时，立方体没有显示出来....当我将浏览器调整到 iPhone 屏幕的大小时，iPhone 图像只有在刷新页面时才会出现....但是每次我调整窗口大小时，它都会不断刷新.....是否有可能只为 iPhone 屏幕刷新浏览器窗口......就像在 js 中指定宽度......

在下面提供我的代码....

[http://jsfiddle.net/sDXTx/1/](http://jsfiddle.net/sDXTx/1/)

```
<script type="text/javascript">

$(window).bind('resize', function() { location.reload();

     Gallery.setOptions({
            size: 78,
            lightbox: false,
            //animation:  'drop'
            //speed:      500,
            //closeOnEsc: true,
            //slideshow:  false,
            //slideshow_speed: 3000,
            //cube_speed: 1000
        });

 }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:40:22.437

这应该可以解决问题：

```
if ((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
    $(window).bind('resize', function () {
        location.reload();
        Gallery.setOptions({
            size: 78,
            lightbox: false
            //animation:  'drop'
            //speed:      500,
            //closeOnEsc: true,
            //slideshow:  false,
            //slideshow_speed: 3000,
            //cube_speed: 1000
        });

    })
} 
```

另外，请务必删除参数中的最后一个逗号，否则 IE 会抛出错误！

# css - 圆形悬停效果可缩放以将 div 填充到 100%

> ID：14780048
> 
> 赞同：0
> 
> 时间：2013-02-08T19:35:59.513
> 
> 标签：css, hover, transition, geometry

希望有人能帮我解决这个问题..？

[这是我的开发站点： http](http://colinmorley.com/stuck/index2new.html) ://colinmorley.com/stuck/index2new.html

正如您将能够看到它对除了品牌新的圆形悬停效果之外的所有内容的响应。它只是不像其他元素那样缩放以适应它所在的 div 的宽度和高度。

我在这里找到了圆形悬停效果的教程：http: [//tympanus.net/codrops/2012/08/08/circle-hover-effects-with-css-transitions/](http://tympanus.net/codrops/2012/08/08/circle-hover-effects-with-css-transitions/)

基本上，我如何使其缩放以适应，然后在较小的浏览器尺寸时缩小？？？

非常感谢，如果你能帮忙:)

科尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:54:14.733

**1.**从`<li>`元素中删除高度，并将这些样式添加到该元素：

```
width: 100%;
padding-bottom: 100%;
position: relative; 
```

**2.**将这些样式添加到该`<li>`元素的子元素`<div>`：

```
position: absolute;
top: 0;
bottom: 0;
left: 0;
right: 0; 
```

**4.**用这个替换那个 child`<div>`的`:hover`state box-shadow：

```
box-shadow: inset 0 0 0 200px rgba(0,0,0, 0.6), inset 0 0 0 0px rgba(255,255,255,0.8), 0 1px 2px rgba(0,0,0,0.1); 
```

**3.**删除链接包装器 div ( `.Col`) 的上边距，并添加以下样式：

```
position: absolute;
width: 100%;
top: 50%;
margin-top: -12px; 
```

我截取了我的结果截图：

![在此处输入图像描述](../Images/9746618c84221ce38122fbe2515450f9.png)

# c++ - 有人可以向我解释一下环境变量在 C++ 中是如何工作的吗？

> ID：14780059
> 
> 赞同：0
> 
> 时间：2013-02-08T19:36:49.110
> 
> 标签：c++, getenv

我正在尝试编写自己的 getenv 版本。我还没有开始，所以我想先了解环境。

如果它是全局的，为什么我不能在我的函数中打印它？environ 是字符串还是字符数组？为什么环境是双指针？谢谢你。

```
#include <iostream>
#include <string>
#include <stdlib.h>
void myenv(char*);

void myenv(char* name)
{
std::cout<<environ;
}

int main(int argc, char** argv, char** environ)
{
myenv("PATH");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:41:33.857

`environ`是一个`char**`。它指向一个数组`char*`，每个数组都指向一个字符串`char`。所以它就像一个字符串数组。例如，`environ[0]`是以 null 结尾的字符串。尝试打印出：

```
std::cout << environ[0]; 
```

每个字符串都是一个形式为 的环境变量`name=value`。它们对应于当前进程的环境变量。

但是，`environ`它不是 C++ 的一个特性，并且是不可移植的。它来自`unistd.h`POSIX 定义的标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:39:18.863

它`char **`包含环境。变量

`extern char **environ;`

[http://pubs.opengroup.org/onlinepubs/007908799/xsh/environ.html](http://pubs.opengroup.org/onlinepubs/007908799/xsh/environ.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:17:33.900

只需添加；

> environ 是字符串还是字符数组？为什么环境是双指针？

environ 寻址一个指针数组，每个指针都指向字符串的第一个地址。环境不是一个字符串，而是一堆字符串（嗯，环境可以是空的，所以“bunch”可以为零）。

```
environ[0] contains a pointer to the 'first' environment variable.
environ[1] contains a pointer to the 'second'.

environ[0][0] would reference the first character of the 'first' name in the environment.
environ[1][0] would reference the first character of the 'second' name. 
```

*或者，如果没有至少两个环境变量，则 environ[1] 指向 segfault 区域或更糟的是 random memory*。

我引用了第一和第二，因为没有关于环境名称字符串如何排序的定义规则（例如，不要期望名称是按字母顺序排列的）。

# vps - Linode VPS 功能

> ID：14780065
> 
> 赞同：0
> 
> 时间：2013-02-08T19:37:53.793
> 
> 标签：vps, linode

我对VPS没有经验。在过去的一两年里，我越来越喜欢 Web 开发，作为一种爱好和工作。我目前正在管理一个 wordpress 网站、一个 codeigniter 应用程序、一个 node.js/mongodb 应用程序以及其他各种个人项目。它们目前都是单独托管的（misc LAMP 托管、heroku 等）。

我正在寻找一种解决方案，使我能够执行以下操作：

*   托管静态/PHP 站点/应用程序（所以是 LAMP 堆栈）
*   Node.js/MongoDB/Redis
*   能够支持其他堆栈（django/yesod/RoR/等）

Linode VPS 能够处理所有这些吗？这些网站都没有获得大量流量。Web 应用程序是私人的业务管理应用程序，一次可供 2-10 人使用。公共网站是小型企业网站和我的投资组合。我也希望能够在相同的 VPS 上托管未来的工作（相同类型的小型网站/应用程序）。

我没有在同一台服务器上管理多个域的经验。这是否可以通过单个 Linode VPS 轻松完成（或可能）？

*编辑* 我正在查看 Linode 512MB/1GB VPS，分别为 20 美元/40 美元。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T15:52:01.530

当然。

尤其是在[大规模的](https://blog.linode.com/2013/03/07/linode-nextgen-the-network/) [Linode](https://blog.linode.com/2013/03/18/linode-nextgen-the-hardware/) [NextGen](https://blog.linode.com/2013/04/09/linode-nextgen-ram-upgrade/) [升级](https://blog.linode.com/2013/07/25/storage-space-doubled/)之后，一个 Linode VPS 可以轻松处理这种工作负载。由于它是 VPS 而不仅仅是共享主机，因此您可以获得 root 访问权限，因此可以完全控制系统。

此外，Linode 还包括高级磁盘映像管理等功能，允许您根据需要克隆和调整磁盘映像的大小并快速启动到不同的映像，以及允许直接访问服务器控制台的[带外](https://en.wikipedia.org/wiki/Out-of-band_management)shell。如果您无法通过 SSH 访问它。对于此类工作负载，Linode 1024 (1GB) 计划绰绰有余。

那里有许多不同的 VPS 提供商。 [Rackspace](http://www.rackspace.com/cloud/servers/)非常昂贵，但可能具有最高级别的可靠性（100% 正常运行时间 SLA，每 30 分钟停机时间 5% 退款）和出色的“狂热支持”。对于不太重要的需求，有许多较小的 VPS 提供商提供便宜的价格，但通常只有最少的资源和更少的功能。有些为磁盘密集型应用程序提供超快速 SSD 存储。您应该货比三家并进行研究，以便找到满足您要求的 VPS 提供商。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T19:11:12.620

我建议您可以在 hostgator 等知名托管公司上查看共享吊装计划，因为流量不多。我还建议您也购买一个用于管理工具的 cpanel。Cpanel 有一个 Web 界面，您可以使用它来控制每个工具使用鼠标和键盘。

另一方面，linode 有一个 CLI 界面，他们的支持希望您对管理 VPS 服务器有一定的了解。

# asp.net - 是什么让缓存无法在 WebMatrix 中工作？

> ID：14780066
> 
> 赞同：0
> 
> 时间：2013-02-08T19:37:59.013
> 
> 标签：asp.net, iis, razor, webmatrix

我在 WebMatrix Razor ASP.Net 站点中有许多页面，我在其中添加了一行代码：

```
 Response.OutputCache(600); 
```

通过阅读它，我假设这意味着 IIS 将创建页面生成的 html 的缓存，在接下来的 10 分钟内提供该 html，并且在下一个请求到来的 10 分钟后，它将再次运行代码.

现在该页面作为定时 jquery 调用的一部分被获取。客户端中的时间码每分钟运行一次。那里的代码非常简单：

```
 function wknTimer4() {
        $.get('PerfPanel', function(data) {
        $('#perfPanel').html(data);

        }); 
```

它偶尔会出现缓存，但是当我查看在 10 分钟内完成的数据库查询数量时，我可能有超过 100 个数据库查询。我知道缓存没有按我预期的方式工作。缓存是否仅适用于单个会话？还有其他限制吗？

更新：客户端做什么并不重要，无论是通过 jQuery 调用还是直接 html 来获取页面。如果服务器正在缓存，那么客户端做什么都没有关系。

更新 2：此处转储的完整代码。无聊的东西：

```
@{  

    var db = Database.Open("LOS"); 
    var selectQueryString = "SELECT * FROM LXD_funding ORDER BY LXDOrder"; 
    // cache the results of this page for 600 seconds
    Response.OutputCache(600); 

 }

@foreach (var row in db.Query(selectQueryString) ){

    <h1>
    <a href="Dashboard/FundingDetails/@row.Status">@row.quotes</a>  Loans @row.NALStatus, oldest     @(NALWorkTime.WorkDays(row.StatusChange,DateTime.Now)) days

    </h1>

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:48:31.970

您对 OutputCache 如何工作的假设是正确的。您可以检查 firebug 或 chrome 工具来查看到达您页面的传出请求吗？如果您使用 jQuery，有时人们会将 $.get 或 $.ajax 上的缓存属性设置为 false，这会导致对页面的请求具有时髦的尾随查询字符串。我犯了一个错误，即全局设置它以解决 jQuery 和 IE 的一些问题：

[http://api.jquery.com/jQuery.ajaxSetup/](http://api.jquery.com/jQuery.ajaxSetup/)

这里要查看的另一个是数据库调用的分组。您是否只是通过一个请求打了很多电话？您是否在另一个阅读器中循环执行 db 命令？这种情况下的代码会很有帮助。

祝你好运，我希望这会有所帮助！

# java - jpanel 作为内部类

> ID：14780067
> 
> 赞同：0
> 
> 时间：2013-02-08T19:38:02.780
> 
> 标签：java, swing

我需要编写一个简单的网球游戏。为了在不同的窗口之间移动（主菜单面板、游戏面板、设置面板），我决定使用内部类扩展 JPanel 并在发生某些事件`start new game`时替换它。

但问题是 - 它看不到我的内心阶级。我的意思是我将它添加到 JFrame

```
mainframe.add(new MainMenuPanel()); 
```

但是当我运行程序时屏幕上没有任何内容。有什么问题？

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class MainFrame{
JFrame mainframe;

public static void main(String[] args){
    new MainFrame();
}

public MainFrame() {
    mainframe = new JFrame();
    mainframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    mainframe.setSize(300, 400);
    mainframe.setTitle("X-Tennis v0.1");

    mainframe.add(new MainMenuPanel());

    mainframe.getContentPane().setLayout(new GridLayout());
    mainframe.getContentPane().setBackground(Color.WHITE);
    mainframe.setVisible(true); 
}

public class MainMenuPanel extends JPanel {

    JPanel mainmenupanel;
    JLabel label1;
    JButton btnNewGame,btnJoinGame;
    ImageIcon iconNewGame,iconJoinGame;

    public MainMenuPanel(){
        mainmenupanel = new JPanel();

        label1 = new JLabel("X-TENNIS");
        label1.setFont(new Font("Comic Sans MS",Font.ITALIC,20));
        label1.setForeground(Color.BLUE);

        btnNewGame = new JButton("New Game", iconNewGame);
        btnNewGame.setFocusPainted(false);
        btnNewGame.addActionListener(
                new ActionListener() {
                    public void actionPerformed(ActionEvent e){
                        JOptionPane.showMessageDialog(mainframe, "New game");
                        //delete current panel and add another to mainframe
                    }
                }
        );
        btnNewGame.setPreferredSize(new Dimension(140,30));     
        btnJoinGame = new JButton("Join game",iconJoinGame);    
        mainmenupanel.add(label1);
        mainmenupanel.add(btnNewGame);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T19:44:21.090

您在内部创建一个新的`JPanel`, ，但从不将其添加到容器本身。你可以做`mainmenupanel``MainMenuPanel`

```
add(mainmenupanel); 
```

如果您打算让它`JPanel`占据父级的全部区域，那么您可以简单地将组件直接添加到您的实例中，`MainMenuPanel`如 @Mad 所示

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T19:47:37.990

`mainmenupanel`类内不需要，`MainMenuPanel`因为 MainMenuPanel`JPanel`本身就是一个

简单地将所有组件`MainMenuPanel`直接添加到自身

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T19:40:35.713

~~首先，您应该将组件添加到 ContentPane。在 Swing 中，所有显示的非菜单组件`JFrame`都应该在 ContentPane 中。~~

 ~~```
mainframe.getContentPane().add(new MainMenuPanel()); 
```~~  ~~编辑：我对内容窗格有误，请参阅@MadProgrammer 评论。

然后，您必须将在 MainMenuPanel 中创建的 JPanel 添加到 MainMenuPanel 实例本身。

```
add(mainmenupanel); 
```

但是您可能应该摆脱该中间容器本身并将标签添加到 MainMenuPanel 实例本身：

```
add(label1);
add(btnNewGame); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T19:43:48.443

```
 mainmenupanel.add(label1);
    mainmenupanel.add(btnNewGame); 
```

试试这个 ：

```
 super.add(label1);
    super.add(btnNewGame); 
```~~

# android - 访问另一个类的布局？

> ID：14780071
> 
> 赞同：0
> 
> 时间：2013-02-08T19:38:16.540
> 
> 标签：android, android-listview, android-activity

我有一个自定义 ListView，其中有一个 textview 和一个图像。我在我的 customlistadapter 类中为 imageview 设置了 onclicklistener，所以我需要在单击图像时对主布局进行一些更改。请参阅以下代码以供参考...

**MainActivity.java**

```
hmDataList.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long arg1) {

            DataFields dataField = (DataFields) hmDataList
                    .getItemAtPosition(position);
            ImageView v = (ImageView) view.findViewById(R.id.hmFieldDeleteImage);
            RelativeLayout mainRL = (RelativeLayout)view.findViewById(R.id.hmFieldMainRL);
            } 
```

}

**CustomListAdapter.java**

```
 public View getView(int position, View convertView, ViewGroup parent) {
        holder = null;
        DataFields rowItems = (DataFields) getItem(position);
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Activity.LAYOUT_INFLATER_SERVICE);

        if (convertView == null) {
            convertView = inflater.inflate(R.layout.home_field_row, null);
            holder = new ViewHolder();
            holder.mName = (TextView) convertView.findViewById(R.id.hmFieldName);
            holder.mDeleteImage = (ImageView)convertView.findViewById(R.id.hmFieldDeleteImage);

            convertView.setTag(holder);

            holder.mDeleteImage.setTag(position);
            final View clickView = convertView;
            holder.mDeleteImage.setOnClickListener(new ImageView.OnClickListener() {

                @Override
                public void onClick(final View view) {
                    count++;
                    clickView.setBackgroundColor(color.list_row_bg);
                    //
                    //Some changes has to be made for the main activity's layout
                    //
                }
            });
        }

        else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.mName.setText(rowItems.getName());

        return convertView;
    } 
```

**list_row.xml**

```
<TextView
    android:id="@+id/hmFieldName"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_centerVertical="true"
    android:layout_marginBottom="10dp"
    android:layout_marginLeft="10dp"
    android:layout_marginTop="10dp"
    android:gravity="left"
    android:shadowColor="#000000"
    android:shadowDx="0"
    android:shadowDy="0"
    android:shadowRadius="2"
    android:text="@string/no_data"
    android:textAppearance="?android:attr/textAppearanceMedium"
    android:textColor="#F2F2F2" />

<ImageView
    android:id="@+id/hmFieldDeleteImage"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerVertical="true"
    android:layout_marginBottom="10dp"
    android:layout_marginRight="10dp"
    android:layout_marginTop="10dp"
    android:contentDescription="@string/right_arrow"
    android:src="@drawable/delete" /> 
```

**activity_main.xml**有一些隐藏的小部件，所以我需要在单击自定义 ListView 中的图像时取消隐藏它们。

简单来说，有没有办法从其他类更新主要活动的 gui？非常感谢任何类型的帮助或示例或参考。谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T19:54:47.100

这是一个很好的方法：

在您的**MainActivity.java**添加：

```
public onClickListener mListener = new OnClickListener(){
        @Override
            public void onClick(final View view) {
                count++;
                view.setBackgroundColor(color.list_row_bg);
                //
                //Some changes has to be made for the main activity's layout
                //

               // Here you can delete add or do anything to your views
            }

  }; 
```

当您创建一个新的 CustomListAdapter 对象时：

```
CustomListAdapter adapter = new .....;
adapter.setActivity(this); 
```

并在您的**CustomListAdapter.java**添加：

```
 private MainActivity mActivity;

 public void setActivity(MainActivity activity){
          mActivity = activity;
 } 
```

并在您的 getView 方法中：

public View getView(int position, View convertView, ViewGroup parent) { holder = null; DataFields rowItems = (DataFields) getItem(position); LayoutInflater inflater = (LayoutInflater) 上下文 .getSystemService(Activity.LAYOUT_INFLATER_SERVICE);

```
 if (convertView == null) {
        convertView = inflater.inflate(R.layout.home_field_row, null);

             ....  Same Code

        holder.mDeleteImage.setTag(position);
        final View clickView = convertView;
// use this code
        holder.mDeleteImage.setOnClickListener(mActivity.mListener);
    }

    else {
        holder = (ViewHolder) convertView.getTag();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:46:06.590

在您定义图像/按钮是否首先隐藏之前的其他活动。

在你 OnClick 放上`setContentView(yourmainActivity)`然后定义你的`ImageView`哪个是不可见的。然后用你的方法使背部可见。PS把代码放在startActivity之后。希望对你有帮助。

# facebook - Facebook oauth auth_type=reauthenticate 不适用于某些用户

> ID：14780076
> 
> 赞同：5
> 
> 时间：2013-02-08T19:38:56.280
> 
> 标签：facebook, oauth

我的应用程序向 Facebook 请求身份验证。如果用户已经登录到 Facebook，并且他们登录到 Facebook 的用户已经授权了应用程序，我们发现了一个问题。Facebook 将使用您登录的用户来验证应用程序，而不会告诉用户他们正在验证谁。我们有多个 Facebook 帐户的用户，这导致了一个问题，因为人们在没有意识到的情况下验证了错误的帐户。我通过将 auth_type=reauthenticate 添加到查询字符串来解决该问题。

根据 Facebook 的 auth_type=reauthenticate 参数将始终要求用户再次输入密码：[https ://developers.facebook.com/docs/reauthentication/](https://developers.facebook.com/docs/reauthentication/)

不幸的是，auth_type=reauthenticate 参数不适用于某些帐户。大多数用户会被提示输入密码，但如果他们已经授权了应用程序，一些用户只会通过。似乎没有理由说明 auth_type=reauthenticate 参数对某些用户有效，但对其他用户却被忽略。忽略该值的用户总是这样做。

我使用的授权 URL 是这样的：

https://www.facebook.com/dialog/oauth?client_id=[my_client_id]&redirect_uri=[my_redirect_uri]&display=popup&auth_type=reauthenticate&response_type=code%20token&scope=publish_stream,manage_pages,offline_access

（将 [my_client_id] 和 [my_redirect_uri] 替换为我的值）

有没有办法让所有用户再次输入他们的密码，或者有没有其他方法让 Facebook 向用户显示他们正在验证的帐户？

# r - r xyplot“步骤”以数据点为中心

> ID：14780085
> 
> 赞同：2
> 
> 时间：2013-02-08T19:39:27.853
> 
> 标签：r, lattice

的类型参数`xyplot()`可以用“s”表示“步骤”。来自`help(plot)`：

> 这两种步长类型在 xy 偏好上有所不同：从 (x1,y1) 到 (x2,y2) 且 x1 < x2，'type = "s"' 先水平移动，然后垂直移动，而 'type = "S"'反过来移动。

即，如果您使用`type="s"`，则步骤的水平部分的左端连接到数据点，而`type="S"`右端连接到数据点。

```
library(lattice)
set.seed(12345)
num.points <- 10
my.df <- data.frame(x=sort(sample(1:100, num.points)),
                    y=sample(1:40, num.points, replace=TRUE))

xyplot(y~x, data=my.df, type=c("p","s"), col="blue", main='type="s"')
xyplot(y~x, data=my.df, type=c("p","S"), col="red", main='type="S"') 
```

![类型='s'](../Images/0212fdea6ddefbe722a02d290aa15ba4.png)

![类型='S'](../Images/d3a0d17ff4c7976a8b3f421b238f89c0.png)

如何实现“阶梯”图，其中垂直运动发生在数据点之间，即在 处`x1 + (x2-x1)/2`，以便阶梯的水平部分以数据点为中心？

编辑以包含一些示例代码。我想迟到总比没有好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:13:01.530

这是一个基本的图形解决方案，因为我不是`lattice`.

本质上，您可以使用`segments`首先绘制水平，然后是垂直步骤，将移位的坐标作为向量传递。

这是一个例子：

```
set.seed(12345)

# Generate some data
num.points <- 10
x <- sort(sample(1:100, num.points))
y <- sample(1:40, num.points, replace=T)

# Plot the data with style = "s" and "S"
par(mfrow=c(1,3))

plot(x, y, "s", col="red", lwd=2, las=1, 
     main="Style: 's'", xlim=c(0, 100))
points(x, y, pch=19, col="red", cex=0.8)

plot(x, y, "S", col="blue", lwd=2, las=1, 
     main="Style: 'S'", xlim=c(0, 100))
points(x, y, pch=19, col="blue", cex=0.8)

# Now plot our points
plot(x, y, pch=19, col="orange", cex=0.8, las=1, 
     main="Centered steps", xlim=c(0, 100))

# Calculate the starting and ending points of the
# horizontal segments, by shifting the x coordinates
# by half the difference with the next point
# Note we leave the first and last point as starting and
# ending points
x.start <- x - (c(0, diff(x)/2))
x.end <- x + (c(diff(x)/2, 0))

# Now draw the horizontal segments
segments(x.start, y, x.end, y, col="orange", lwd=2)
# and the vertical ones (no need to draw the last one)
segments(x.end[-length(x.end)], y[1:(length(y)-1)], 
         x.end[-length(x.end)], y[-1], col="orange", lwd=2) 
```

结果如下： ![阶梯图](../Images/f6ea878fc0ae952e998851bd2dc4d4c9.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T21:12:22.980

我正在使用出色的@nico 答案来给出它的格子版本。即使我对@Dwin 也很满意，因为这个问题没有提供可重现的示例，但是自定义格子面板有时具有挑战性。这个想法是使用`panel.segments`相当于`segments`基本图形的。

```
library(lattice)
xyplot(y~x,
       panel =function(...){
         ll <- list(...)
         x <- ll$x
         y <- ll$y
         x.start <- x - (c(0, diff(x)/2))
         x.end   <- x + (c(diff(x)/2, 0))
         panel.segments(x.start, y, x.end, y, col="orange", lwd=2)
         panel.segments(x.end[-length(x.end)], y[1:(length(y)-1)], 
                        x.end[-length(x.end)], y[-1], col="orange", lwd=2)
         ## this is optional just to compare with type s
         panel.xyplot(...,type='s')
         ## and type S
         panel.xyplot(...,type='S')
       }) 
```

![在此处输入图像描述](../Images/fc9bc4e1424746a9c478486ecbeb7d7a.png)

# c# - 使用 Emgu 进行数据集的 PCA

> ID：14780088
> 
> 赞同：0
> 
> 时间：2013-02-08T19:39:42.423
> 
> 标签：c#, opencv, emgucv

我正在尝试对数据集执行 PCA，目前我有 8 组数据，对于每条数据，我有 618 条关于它的信息。以下是我到目前为止尝试过的代码：

```
 double[,] RawData = new double[8, 618];

        for (int i = 0; i < 8; i++)//Copies Data to Emgu Matrix
        {
            for (int j = 0; j < 618; j++)
            {
                double val = Convert.ToDouble(DataList[i][j]);
                RawData.SetValue(val, i, j);
            }
        }

        Matrix<Double> DataMatrix = new Matrix<Double>(RawData);
        Matrix<Double> Mean = new Matrix<Double>(1, 618);
        Matrix<Double> EigenValues = new Matrix<Double>(1, 618);
        Matrix<Double> EigenVectors = new Matrix<Double>(618, 618);

        CvInvoke.cvCalcPCA(DataMatrix, Mean, EigenValues, EigenVectors, Emgu.CV.CvEnum.PCA_TYPE.CV_PCA_DATA_AS_COL);

        Matrix<Double> PC1 = new Matrix<Double>(1, 618);
        for (int i = 0; i < 618; i++)
             PC1[0, i] = EigenVectors[0, i];

        Matrix<Double> Results = new Matrix<Double>(8, 1);

        CvInvoke.cvProjectPCA(DataMatrix, Mean, PC1, Results);

        TestStatus.Items.Add("PCA Projection Results = ");
        for (int i = 0; i < 8; i++)
        {
            TestStatus.Items.Add(Convert.ToString(DataMatrix[i, 0]));
        } 
```

Emgu.CV.Util.CvException: OpenCV: (evals0.cols == 1 || evals0.rows == 1) && ecount0 <= ecount && evects0.cols == evects.cols && evects0.rows == ecount0

在 Emgu.CV.CvInvoke.CvErrorHandler（Int32 状态，字符串 funcName，字符串 errMsg，字符串文件名，Int32 行，IntPtr userData）

在 Emgu.CV.CvInvoke.cvCalcPCA(IntPtr data, IntPtr avg, IntPtr eigenvalues, IntPtr eigenvectors, PCA_TYPE flags) at Project_3._0.MainWindow.Capture_3D_Face_Click(Object sender, RoutedEventArgs e) in f:\Project\Project 3.0\Project 3.0 \MainWindow.xaml.cs：第 516 行

这是由该行引起的：（在上面的代码中）

```
 CvInvoke.cvCalcPCA(DataMatrix, Mean, EigenValues, EigenVectors, Emgu.CV.CvEnum.PCA_TYPE.CV_PCA_DATA_AS_COL); 
```

如何正确设置矩阵以使 PCA 发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T10:31:02.840

在您提供的代码中，不应该是

```
Emgu.CV.CvEnum.PCA_TYPE.CV_PCA_DATA_AS_ROW 
```

代替

```
Emgu.CV.CvEnum.PCA_TYPE.CV_PCA_DATA_AS_COL 
```

（注意每个句子的最后 3 个字符）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T11:38:47.673

您可以查看 emguCV 的源代码并查看错误中提到的行中的哪些条件被触发。由于我只有 OpenCV，我无法提供更多帮助，因为我的 PCA 版本没有这样的断言。

可能还涉及一些魔术，例如“您必须使用 float 而不是 double”。

# java - 在类上使用接口

> ID：14780096
> 
> 赞同：2
> 
> 时间：2013-02-08T19:40:06.783
> 
> 标签：java, interface, coupling

我对使用 Java 类的接口的建议有点困惑，就像在这个线程中一样：[为什么应该首选 Java 类的接口？](https://stackoverflow.com/questions/147468/why-should-the-interface-for-a-java-class-be-prefered)

我理解您为什么要使用该界面：如果稍后发生更改，您需要清理的代码就会减少。

但是，在某些情况下，使用接口会阻止您利用性能原因，您首先选择该特定类吗？

例如，如果我有一个 TreeMap，我假设我应该能够在最多 O(logn) 中找到任何元素。这就是为什么它有我可以利用的好方法，比如higherEntry()、lowerEntry()、lastEntry()。

如果我改为将此 TreeMap 引用为 Map，现在我相信我不得不通过 O(n) 中的列表一次迭代一个元素来定位该条目。

我是 Java 新手，所以如果我在这里遗漏了什么，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:43:21.433

> 如果我改为将此 TreeMap 引用为 Map，现在我相信我不得不通过 O(n) 中的列表一次迭代一个元素来定位该条目。

不，你不是被迫这样做的。如果您确定您的`Map`引用包含对 的引用`TreeMap`，并且您想要访问 的特定方法`TreeMap`，那么您始终可以将引用类型转换为`Map`引用`TreeMap`，然后访问适当的方法，例如`higherEntry()`, `lowerEntry()`。但是，唯一需要注意的是，您必须确保您的`Map`引用实际上指向 a `TreeMap`，以避免`ClassCastException`在运行时获得 a 。

这是由一个事实暗示的，a`super class`和它本质上`sub classes`是*协变*的。因此，您可以在它们之间执行强制转换，前提是您在运行时没有违反规则（即`super class`引用持有对其他`sub class`实例的引用，这与`sub class`您要转换的对象不协变）。

现在以您的示例为例，由于[`TreeMap`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)还实现了[`NavigableMap`](http://docs.oracle.com/javase/7/docs/api/java/util/NavigableMap.html)接口，它是接口的子接口`Map`，因此您可以使用它来代替`Map`接口。因此，您可以拥有多态性的优势，而无需进行类型转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T19:44:03.770

如果您想使用 、 和 等方法`higherEntry`，`lowerEntry`则`lastEntry`只需使用`NavigableMap`接口而不是`Map`接口或`TreeMap`类。

一般来说，尽可能频繁地使用接口，并尽可能使用最通用的接口来支持您想要使用的所有操作。

# visual-studio-2010 - 将 Visual Studio 2010 连接到 Team Forge

> ID：14780101
> 
> 赞同：1
> 
> 时间：2013-02-08T19:40:26.207
> 
> 标签：visual-studio-2010

对于存储在 Team Forge 中的项目，我如何获得签出、签入、更改跟踪功能？

我已经使用 AnkhSVN 和 Tortoise 安装了 CollabNet 的集成应用程序，但在 VS 中我看不到通常的 SVN 右键单击​​选项：签入、签出等或文件更改跟踪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:58:38.210

右键单击解决方案资源管理器中的项目，然后选择“将选定的项目添加到 Subversion”

# wpf - 向图像控件添加边框可防止图像显示 WPF

> ID：14780105
> 
> 赞同：0
> 
> 时间：2013-02-08T19:40:49.533
> 
> 标签：wpf, image, border

我有一个对我来说毫无意义的令人困惑的问题 - 我试图在 WPF 中的图像控件周围放置一个边框。图像控件完美地显示图像（我已经通过代码和 XAML 加载，并且都可以正常工作）。但是，当我在图像控件周围放置边框时，图像根本不会出现。这发生在三个图像控件都具有相同配置的情况下。有谁知道这是为什么或我该如何解决？非常感谢，杰夫。

XAML（带注释的边框）如下：

```
<!--<Border BorderBrush="Black" BorderThickness="2" Margin="201,172,618,450" Grid.Column="1">-->
                    <Image Name="imgFault11" Stretch="Fill" Grid.Column="1" Margin="200,172,619,450">

                <!--</Border>--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:46:30.490

您将两者都放入 Grid.Column="1"
将图像放入边框
开始时没有边距

```
<Border BorderBrush="Black" BorderThickness="2" Grid.Column="1">
     <Image Name="imgFault11" Stretch="Fill">
</Border> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-02-07T18:20:20.227

您可能必须将边框发送到背景。添加后，它会覆盖图像。右键单击边框.. 去订购，然后选择“发送到后面”。边界控件在工具箱中。这有点混乱，因为让边框与图像框大小相匹配需要时间才能正确，然后你在另一个控件之上拥有一个控件..等等。

# tfs - TFS 2010：实时报告

> ID：14780106
> 
> 赞同：0
> 
> 时间：2013-02-08T19:40:58.297
> 
> 标签：tfs, tfs-2010, tfs-reports, tfs-query, tfs-warehouse

我想创建一个实时显示迭代状态的报告。我能够在 Tfs_Warehouse 数据库上创建一个查询（见下文），但是我发现该数据库是从 Tfs_Collection 数据库及时填充的。

有没有一种方法可以让我立即看到报告中反映的工作项的更改？

```
 SELECT *
 FROM [CurrentWorkItemView] c 
 left join [vDimWorkItemTreeOverlay] t on t.WorkItemSK = c.WorkItemSK
 where c.IterationName = @iteration and c.System_WorkItemType = 'User Story'
 order by  c.Microsoft_VSTS_Common_StackRank, c.System_id 
```

注意：这不是完整的查询，因为我不能很好地适应它。基本上，它加入 2 个表（CurrentWorkItemView 和 vDimWorkItemTreeOverlay）以获取每个用户故事的用户故事和相关任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:45:36.907

不，不是通过仓库。当您需要来自工作项的最新信息时，请在 Excel 或 Visual Studio 中使用工作项查询。

您还可以使用 TFS api 直接查询操作数据存储。

# c# - 依赖 HttpContext 的单元测试

> ID：14780112
> 
> 赞同：2
> 
> 时间：2013-02-08T19:41:52.360
> 
> 标签：c#, asp.net, unit-testing, httpcontext

我需要测试一些依赖于当前上下文的静态方法。现在，我当然可以使用`HttpContextWrapper`来从我自己的代码中删除这种依赖关系。问题在于我在这些方法中使用的第 3 方 API。他们依赖于`HttpContext`，所以我对此无能为力。但是，我想做的是`HttpContext`用我的`HttpContextBase`.

所以我的代码看起来像这样：

```
public static bool IsSignedUpUser()
{
    //This calls IsSignedUpUser with the production context
    return IsSignedUpUser(new HttpContextWrapper(HttpContext.Current));
}

public static bool IsSignedUpUser(HttpContextBase context)
{
    HttpCookie objCookie = SomeExternalAPIThatReliesOnHttpContextBeingSet();

    return (objCookie != null)
} 
```

我想做的是：

```
HttpContext.Current = context; //where context is a mocked HttpContextBase 
```

这样，当第 3 方 API 查找`HttpContext`查询字符串、cookie 值等时，它不会抛出`NullReferenceException`.

**为什么这不是骗子？**

在被引用为欺骗的问题中的代码中，作者看起来完全控制，没有外部依赖。我正在使用依赖于的第三方库`HttpContext`，我无法更改他们的方法签名以接受`HttpContextBase`，所以我需要一种方法来分配我的`HttpContextBase`到`HttpContext`

如果这是不可能的，并且到目前为止我被引导相信它不是，那么好的答案应该建议如何删除这些依赖项。500 - Internal Server Error 至少有一个好的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T21:16:56.140

在我看来，您应该用您注入的自定义接口方法替换对 SomeExternalAPIThatReliesOnHttpContextBeingSet 的调用，然后可以像其他任何方法一样模拟该方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:22:32.353

[编辑] 根据@jessehouwing，“痣”现在是“假货”，这应该会改善您的 Google-fu

啊，静态依赖......更糟糕的那种。

这可能是矫枉过正，但我​​可能会考虑使用`Moles`（或他们重命名的任何东西），这将让您覆盖**任何**行为，静态的、密封的或其他的；这里有一些链接可以细读：

*   [嘲笑不可嘲笑的人](http://geekswithblogs.net/thomasweller/archive/2010/04/28/mocking-the-unmockable-using-microsoft-moles-with-gallio.aspx)
*   [鼹鼠框架](http://msdn.microsoft.com/en-us/library/ff798506.aspx)
*   [使用 Moles 进行单元测试](http://blogs.msdn.com/b/kristol/archive/2010/03/07/unit-testing-with-microsoft-moles.aspx)
*   [一个不同的“嘲笑不可模仿者”](http://www.slideshare.net/orbitone/moles-5655584)

# uml - 您会在类图中显示 JSP 文件吗？

> ID：14780113
> 
> 赞同：2
> 
> 时间：2013-02-08T19:41:55.680
> 
> 标签：uml, diagram

我开发了一个使用 JSP 和 Java 类的在线 Web 应用程序。

我知道 Java 类会出现在类图上，但 JSP 文件会出现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:46:24.590

我的回答是**否定**的。

类图可以在不同的层次上用于不同的目的。两个非常常见的用法是**设计**和**分析**。

1-**分析类图**显示实体及其关系并为您的问题域建模（不涉及解决方案或技术）

2-**设计类图为**您的解决方案建模，并且可能包含结构类。它们非常接近您的代码。（在这种情况下，您的 Java 类）

设计类图可以根据您的需要具有不同的抽象级别。除非有特定原因，否则在类图中包含 UI 细节是非常罕见的。

基本上你必须对你的范围做出决定，例如，除非有理由，否则在你的类图中包含 java 库类并不是很有用。

# c# - 使用按钮 c# 滚动到 RichTextBox

> ID：14780114
> 
> 赞同：0
> 
> 时间：2013-02-08T19:42:06.930
> 
> 标签：c#, winforms

如何编写两个按钮以向上和向下滚动到 RichTextBox 中？我尝试什么：

```
private void btnScrollTop_Click(object sender, EventArgs e) {
            if (rtbDefinitie.SelectionStart >= 30) {
                rtbDefinitie.SelectionStart -= 30;
                rtbDefinitie.ScrollToCaret();
            }
        }
private void btnScrollBottom_Click(object sender, EventArgs e) {
            if (rtbDefinitie.SelectionStart <= 30) {
                rtbDefinitie.SelectionStart += 30;
                rtbDefinitie.ScrollToCaret();
            }
        } 
```

但是在我按两次向下滚动按钮后，它似乎卡住了。我需要做什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:52:18.977

第二次点击似乎被解释为 DoubleClick，因此您也可以注册此事件并在其后面放置相同的代码（或替换`30`by `60`）

编辑：如果应用程序卡住了，因为它正在工作并且没有时间更新 GUI，您可以尝试`Application.DoEvents();`在每个引发的 Clickevent 之后调用：

```
private void btnScrollBottom_Click(object sender, EventArgs e) {
            if (rtbDefinitie.SelectionStart <= rtbDefinitie.TextLength) {
                rtbDefinitie.SelectionStart += 30;
                rtbDefinitie.ScrollToCaret();
                Application.DoEvents();
            }
        } 
```

# github - 为 nginx 用户添加 SSH-Key（用于 github）

> ID：14780115
> 
> 赞同：2
> 
> 时间：2013-02-08T19:42:06.617
> 
> 标签：github, ssh, nginx

我在使用 nginx 和 SSH 密钥时遇到了一些问题。

我需要为 nginx 用户添加一个 ssh 密钥以访问私有 github 存储库，然后运行“git ...”命令将 repo 拉取或克隆到我的 Ubuntu 机器上。

由于 nginx 用户只是一个工作任务，是否可以为该用户生成密钥？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T19:46:25.310

您可以使用以下命令以其他用户身份运行命令，而无需提供密码`sudo`：

```
$ sudo -u nginx ssh-keygen -t rsa -C "email@address.com" 
```

# java - 我应该如何设计 Lego Mindstorms 风格的代码块编辑器？

> ID：14780121
> 
> 赞同：0
> 
> 时间：2013-02-08T19:42:20.530
> 
> 标签：java, design-patterns

我已经开始了一个项目，我需要设计一个可以用作代码块编辑器的应用程序，就像 Lego Mindstorms 和[Blockly，一个 google 项目](https://developers.google.com/blockly/)。

**用 Java 设计这样的应用程序有哪些可能的方法？**

更具体地说，假设我有一个块 A，我如何定义可以与它连接的其他块？我想到的是使用子类并检查层次结构，或者另一种可能的解决方案可能是某种二维表来验证连接是否有效（尽管我认为它可能会变得太大？）。

ps：我希望这在SO问题的范围内。如果没有，请指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:50:43.607

如果您不喜欢图形方法，并且我不确定 Lego MindStorms 是如何工作的，那么[ANTLR](http://www.antlr.org)可能有资格作为解决方案。

*“ANTLR 是一个强大的解析器生成器，用于读取、处理、执行或翻译结构化文本或二进制文件。它被广泛用于构建语言、工具和框架。ANTLR 从语法生成一个可以构建和遍历解析树的解析器。 "*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T03:59:27.810

Lego Mindstorms 基本上是 National Instruments LabVIEW 编程语言的精简修改版。

我认为您正在尝试完成的项目将非常复杂。除非您只有非常有限数量的操作，您可以使用您的编辑器构建的代码将能够执行这将不是一件容易的事。

本质上，您正在尝试在这里开发一种全新的编程语言。在考虑实现 GUI 的细节之前，您需要确定您正在设计的语言的“语法”和其他语义。例如，您要支持 for 循环吗？while 循环？案例/切换语句？如果语句？去吗？抛出和捕获异常？

我不确定您的要求和资源是什么，但您最好尝试致电 National Instruments，看看他们是否会为您/与您一起构建 MindStorms IDE 之类的东西，或者看看那里是否有其他开源语言您可以修改以满足您的需求。

有一个开放的 LabVIEW 克隆，但它是一个德语页面：[http](http://www.myopenlab.de/) ://www.myopenlab.de/ 。

以下是其他几个：[http](http://en.wikipedia.org/wiki/Visual_programming_language) ://en.wikipedia.org/wiki/Visual_programming_language 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T21:06:30.503

我正在做与我的 C# 项目类似的事情。我使用了一个[树视图控件](http://www.codeproject.com/KB/tree/Generic_Tree_View/GenericTreeView.JPG)，我允许用户添加将显示在树视图中的操作，并且程序将通过树视图节点运行，调用它们的操作。在幕后，我使用[了这种模式](https://stackoverflow.com/questions/12769721/allow-the-user-to-arrange-methods/12769812#12769812)。如果您需要更多帮助，请发表评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-26T07:06:03.430

为什么不直接使用[Blockly](https://developers.google.com/blockly/)？毕竟，这就是它的目的。它在[gitub上的](https://github.com/google/blockly)[Apache 许可证](https://en.wikipedia.org/wiki/Apache_License)下可用。如果您不想使用 Blockly，请告诉我们 Blockly 不符合您的需求。:-)

# php - 是否可以用变量名定义一个常量？

> ID：14780125
> 
> 赞同：-2
> 
> 时间：2013-02-08T19:42:29.900
> 
> 标签：php, constants

我希望能够从数组中生成一些常量。所以是这样的：

```
foreach ($array as $key => $value) {
    define($key,$value);
} 
```

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:43:53.473

您已经在代码中执行此操作。或者你的意思是这样的？

```
$array = array("sparkles" => "pretty");

foreach($array as $key=>$value) {
    ${$key} = $value;
}

echo $sparkles; //pretty 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:51:24.217

另一种方法是，如果您要定义**许多**常量并安装了 APC：

```
$constants = array(
    'ONE'   => 1,
    'TWO'   => 2,
    'THREE' => 3,
);
apc_define_constants('numbers', $constants); 
```

（来自的直接示例[`apc_define_constants`](http://www.php.net/manual/en/function.apc-define-constants.php)）

* * *

编辑：[关于性能的有趣读物](http://shwup.blogspot.ro/2010/04/about-constants.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T19:52:49.037

假设 PHP 5.3 或更高版本，您可以这样做：

```
array_walk($array, function ($value, $key) { 
    define($key, $value);
}); 
```

或者

```
array_walk(array_flip($array), 'define'); 
```

* * *

但老实说，我只会使用您当前的方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-08T19:48:33.997

您也可以尝试使用`extract`功能。它产生的结果（几乎）与 njk 的答案相同

见： http: [//php.net/manual/en/function.extract.php](http://php.net/manual/en/function.extract.php)

# d3.js - 生成后使用 D3 访问与数据关联的元素

> ID：14780126
> 
> 赞同：1
> 
> 时间：2013-02-08T19:42:33.630
> 
> 标签：d3.js

我有一个数据集，每个项目都使用 D3 链接到 svg rects。

```
var bars = svg_content.selectAll("rect")
    .data(dataset);
    .enter()
    .append("rect") 
```

假设生成已完成（即 .enter() 过程已完成且矩形已生成）。

我将如何访问与该数据集的特定索引关联的矩形（例如，链接到第三条数据的矩形）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:07:59.280

您可以根据需要使用[selection.filter](https://github.com/mbostock/d3/wiki/Selections#wiki-filter)或常用[selection.select](https://github.com/mbostock/d3/wiki/Selections#wiki-select)的函数形式：

```
var third = selection.filter(function(d, i) { return i == 2; });

// Equivalently
var third = selection.select(function(d, i) { return i == 2; }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:38:13.630

有几种方法可以做到这一点。通常，在 d3 中，您倾向于从选择中访问数据。所以你会看到类似的东西：

```
var bars = svg_content.selectAll("rect")
    .data(dataset);
    .enter()
    .append("rect")
    .attr('class', function(d) { return d.myName; }); 
```

这里 d 是数据集中与特定矩形相关联的数据项。该代码将使用每个数据项的“myName”属性对每个矩形进行分类。

假设您想特别放置其中一个矩形。一个与`myName='aName'`. 我们将选择该矩形并根据相关数据设置“转换”属性。

```
svg.content.selectAll('rect.aName')
    .attr('transform', function(d) { return 'translate(' + d.x + ',' + d.y + 20 ')'; }) 
```

请注意，在这两种情况下，您还可以访问项目的索引，如果它也相关，还可以访问父索引（使用`function(d,i,j) {...}`）

最后，虽然我一般不鼓励这样做，但我已经为单元测试直接访问了与带有`__data__`. 以 jQuery 为例：

```
$.find("svg rect.aName")[0].__data__; 
```

[你可以在这里](http://jsfiddle.net/superboggly/aa2kU/1/)玩一个快速的小提琴

# log4j - 使用 Log4j JMS appender 连接 ActiveMQ

> ID：14780127
> 
> 赞同：1
> 
> 时间：2013-02-08T19:42:34.840
> 
> 标签：log4j, mule, activemq, esb

我正在尝试使用 ActiveMQ 将日志记录添加到我们的 Mule 应用程序，以便将所有消息写入 SQL Server 数据库。这是我在 Mule 中的 Log4j 属性文件的内容：

```
log4j.rootCategory=INFO, console, jms

log4j.logger.org.apache.activemq=INFO, stdout

log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.layout=org.apache.log4j.PatternLayout
log4j.appender.console.layout.ConversionPattern=%-5p %d [%t] %c: %m%n

# Mule classes
log4j.logger.org.mule=INFO
log4j.logger.com.mulesoft=INFO

# Your custom classes
log4j.logger.com.mycompany=DEBUG

# JMS Appender
log4j.appender.jms=org.apache.log4j.net.JMSAppender
log4j.appender.jms.InitialContextFactoryName=org.apache.activemq.jndi.ActiveMQInitialContextFactory
log4j.appender.jms.ProviderURL=tcp://sjc04-wduatesb1:9162
#tcp//localhost:61616
log4j.appender.jms.TopicBindingName=logTopic
log4j.appender.jms.TopicConnectionFactoryBindingName=ConnectionFactory 
```

如您所见，我正在尝试使用 JMS appender 。我还有一个 JNDI 配置文件指向要读取的主题，存储在 $MULE_HOME/conf/ 中的该文件的内容是

topic.logTopic=logTopic

但是，我发现即使消息在主题上被入队和出队，它也没有被写入数据库。有人对我哪里出错有任何想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-05T13:48:59.483

解决此问题的一种方法是创建将消息放入队列的主题的订阅者，然后让队列使用者将消息放入数据库中。

# ruby - 将 Rails 部分附加到现有 PDF

> ID：14780134
> 
> 赞同：0
> 
> 时间：2013-02-08T19:43:20.253
> 
> 标签：ruby, pdf, ruby-on-rails-3.2, pdf-generation, wicked-pdf

我有一个 Rails 项目，我正在使用 wicked_pdf 从生成的 html 生成 PDF，并且我在该 pdf 的每个页面上附加了一个漂亮的页脚。很多这些 PDF 页面实际上来自解析的单词 .doc 或 .txt 文件，然后我在下载时使用此页脚将它们转换为 PDF。

但是... PDF 也被上传到系统，虽然没有在应用程序中解析和显示，但我需要它们在下载时将页脚作为上面的其他文件。有没有办法做到这一点？

我不需要编辑 PDF 中的任何内容，只需要添加此页脚即可。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T15:28:41.827

如果它已经是 PDF，那么 wicked_pdf 在这里帮不了你，但你可以使用 Prawn 或 PDFtk。

您可以使用以下内容在现有 pdf 的每一页的底部区域顶部放置一些内容：

```
require 'prawn'
require 'pdf-reader'

respond_to do |format|
  format.pdf {
    input_filename = Rails.root.join('input.pdf')

    page_count = PDF::Reader.new(input_filename).page_count

    file = Prawn::Document.new(:skip_page_creation => true) do |pdf|

      page_count.times do |num|
        pdf.start_new_page(:template => input_filename, :template_page => num+1)
        pdf.move_down(700)
        pdf.text('FOOTER TEXT')
      end

    end
    send_data file.render
  }
end 
```

# jquery - 指示棋盘移动

> ID：14780136
> 
> 赞同：1
> 
> 时间：2013-02-08T19:43:25.350
> 
> 标签：jquery, html, css

我正在开发一款游戏，我想指出刚刚做出的动作。

当页面加载时，我想指出：

*   这件作品来自哪里
*   新地点
*   曾经在新位置的作品

我尝试过使用 jquery fadein() 和 delay()，但没有成功。以下代码代表棋盘。顶部中间的单元格是刚刚移动到右上角单元格的部分，取代了绿色部分。我尝试了各种方法来隐藏新移动的（红色），直到旧的（绿色）部分消失，但无法弄清楚。

这是当前的[小提琴](http://jsfiddle.net/bLb3H/55/)。

谢谢你的帮助。

```
<table border="1" id="tbl">
<tr>
  <td ></td>
  <td  bgcolor=#000000 >

 <img  src="http://icons.iconarchive.com/icons/deleket/soft-scraps/32/Button-BlankRed-icon.png" id="fadeout1"/>        

  </td>
  <td id="cap" class="items  p1 p3 bg">

  <img src="http://icons.iconarchive.com/icons/deleket/soft-scraps/32/Button-Blank-Green-icon.png" id="fadeout2"/>          

      <img src="http://icons.iconarchive.com/icons/deleket/soft-scraps/32/Button-Blank-Red-icon.png"  /></td>      
 </tr>

 <tr>      
  <td bgcolor=#000000 ></td>
  <td class="items  p1"></td>
  <td class="items p3" bgcolor=#000000 ></td>
 </tr>

<tr>      
  <td class="piece" id="p1" ><img src="http://icons.iconarchive.com/icons/deleket/soft-scraps/32/Button-Blank-Gray-icon.png" /></td>
  <td bgcolor=#000000 ></td>
    <td class="piece" id="p3" ><img src="http://icons.iconarchive.com/icons/deleket/soft-scraps/32/Button-Blank-Gray-icon.png" /></td>
 </tr>

</table> 
```

jQuery：

```
 $("#fadeout1").show().delay(1000).fadeOut('slow')
 $("#fadeout2").show().delay(2000).fadeOut('slow') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:54:13.343

你可以尝试这样的事情：http: [//jsfiddle.net/turiyag/bLb3H/57/](http://jsfiddle.net/turiyag/bLb3H/57/)

与其不显示图像，不如让它们重叠，位置：绝对。

```
#tbl td { width:32px; height:32px; padding:0px; margin: 0px; vertical-align:top;}
img {position:absolute; padding:0px; margin: 0px;} 
```

**编辑：**

我建议在故障排除过程中清理您的代码。查看重构 ( [http://en.wikipedia.org/wiki/Code_refactoring](http://en.wikipedia.org/wiki/Code_refactoring) ) 了解更多信息。在这方面我最喜欢的文本是 ( [http://www.amazon.ca/Refactoring-Improving-Design-Existing-Code/dp/0201485672](http://www.amazon.ca/Refactoring-Improving-Design-Existing-Code/dp/0201485672) )。

在您的特定情况下，我会编写更多函数，并重组您的脚本以更充分地利用 jQuery 的优势。值得注意的是，我将包括一个绘制表格的函数、为表格着色的 CSS 类、用于检索表格中单元格的 x/y 坐标的 jQuery 扩展，以及一个确定移动有效性的函数。我已经根据您的代码制作了一个重构示例。您会注意到它是“自我记录”。从简单的一瞥就很容易准确地理解代码的作用，即使没有注释。

[http://jsfiddle.net/turiyag/vCT9D/](http://jsfiddle.net/turiyag/vCT9D/)

```
$('#gameboard td').droppable({
    hoverClass: 'over',
    activate: function (event, ui) {
        isDragging = true;
    },
    drop: function (event, ui) {
        var img = ui.draggable;
        if($(this).validMove()) {
            movePiece(img, $(this));
            markValidMoves($(this));
        } else {
            img.draggable('option', 'revert', true);
        }
        isDragging = false;
    }
}); 
```

# c++ - 计算边界框的面积

> ID：14780138
> 
> 赞同：0
> 
> 时间：2013-02-08T19:43:29.877
> 
> 标签：c++, opencv

你好 StackOverflowers

我创建了一个应用程序，它使用 inRange 函数根据预定义的颜色分割图像。然后我在检测到的对象周围绘制边界框。

我的问题是如何确定区域属性，例如：面积、大小、高度和中心点。

在这里，我放置了一个屏幕转储示例.....

![在此处输入图像描述](../Images/9d172ea23ff89e8def59f1be825f0081.png)

我应该如何检索这些边界框或任何其他被淹没的边界框的区域属性......？

```
vector<vector<Point> > contours;
    vector<Vec4i> hierarchy;
    findContours(mBlur, contours, hierarchy, CV_RETR_EXTERNAL,  CV_CHAIN_APPROX_SIMPLE, Point(0, 0) );

     /// Approximate contours to polygons + get bounding rects and circles
  vector<vector<Point> > contours_poly( contours.size() );
  vector<Rect> boundRect( contours.size() );
  vector<Point2f>center( contours.size() );
  vector<float>radius( contours.size() );

  for( int i = 0; i < contours.size(); i++ )
     { approxPolyDP( Mat(contours[i]), contours_poly[i], 3, true );
       boundRect[i] = boundingRect( Mat(contours_poly[i]) );
     }

  /// Draw polygonal contour + bonding rects
  Mat drawing = Mat::zeros( range_out.size(), CV_8UC3 );
  for( int i = 0; i< contours.size(); i++ )
     {
       Scalar color = Scalar(255,0,255);
       drawContours( drawing, contours_poly, i, color, 1, 8, vector<Vec4i>(), 0, Point() );
       rectangle( drawing, boundRect[i].tl(), boundRect[i].br(), color, 2, 8, 0 );
     } 
```

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:47:23.577

只需遍历分段形状的 2D 坐标（图片中的粉红色细线，您可以发现它只是检查哪些像素不是黑色并查看其坐标）并存储找到的最大和最小 X 和 Y。那么，宽度是`maxX - minX`，高度是`maxY - minY`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T21:52:20.883

您可以使用内置的 OpenCV[函数](http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html#contourarea)获取该区域。还有其他功能可以满足您的一切需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T04:54:57.560

```
void visualizeSegments(Mat& img, Mat& dst)
{
    vector<vector<Point>> contours;
    vector<Vec4i> hierarchy;
    findContours(img, contours, hierarchy, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE);
    dst=Mat::zeros(img.size(), CV_8UC3);
    for(int i = 0; i < contours.size(); i++)
    { 
        //Moments mu = moments(contours[i], true );
        //Point2f centroid(mu.m10/mu.m00,mu.m01/mu.m00);        
        //double area = fabs(contourArea(Mat(contours[i])));
        //vector<Point> contours_poly;
        //approxPolyDP(Mat(contours[i]), contours_poly, 3, true);
        //Rect boundRect = boundingRect(Mat(contours_poly));
        drawContours(dst, contours, i, Scalar(255,0,0), -1, 8, hierarchy);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T16:13:32.777

如前所述，[OpenCV](http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html#contourarea)中有一组有用的函数 1\. double contourArea(InputArray contour, bool oriented=false ) ：计算面积 2\. double arcLength(InputArray curve, bool closed) ：计算周长 3\. 力矩(InputArray 数组, bool binaryImage=false ) : 计算重心 4\. void HuMoments(const Moments& m, OutputArray hu) : 如果你想要对分类有用的附加属性

# java - JAVA为什么arrayCopy是系统调用？

> ID：14780140
> 
> 赞同：2
> 
> 时间：2013-02-08T19:43:35.617
> 
> 标签：java

例子

```
short size = 1234;
    byte[] payload = {12,43, 55,123, 11, 55};

byte [] shortSize = ByteBuffer.allocate(2).putShort(size).array();
byte[] entirePayload = new byte[shortSize.length+payload.length];   

System.arraycopy(shortSize, 0, entirePayload, 0, 2);
System.arraycopy(payload, 0, entirePayload, 2, payload.length); 
```

这是 Java 系统调用是否有根本原因？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T19:47:47.823

也许`arraycopy`会更适合 . [`java.util.Arrays`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)，但是直到 Java 1.2 才添加该类，而`arraycopy`在 Java 最开始时就存在。`System`似乎是放置它的下一个最佳位置。

另请注意，此方法是在本机代码中实现的，以使其更快，因此有点特殊。

# java - 在Java中调用重载函数？

> ID：14780143
> 
> 赞同：1
> 
> 时间：2013-02-08T19:43:45.440
> 
> 标签：java, generics, implicit, explicit

如何在 Java 中调用数组函数？

目前它看起来像：

```
public static void WriteLine(Object Array[]) {
    for (int I = 0; I < Array.length; ++I) {
        Out.println(Array[I]);
    }
}

public static void WriteLine(Object Text) {
    Out.println(Text);
} 
```

我也试过：

```
public static <T> void WriteLine(T Array[]) {
    for (int I = 0; I < Array.length; ++I) {
        Out.println(Array[I]);
    }
} 
```

在我的主要，我做：

```
int[] I = new int[]{1, 2, 3, 4, 5};
WriteLine(I); 
```

我也试过：

```
WriteLine<int[]>(I); 
```

不行。。

它打印：[I@2f56f920

又名 int 数组的地址。如何显式调用特定的数组函数，或者如何让编译器知道自动（隐式）调用哪一个？

我还不习惯 Java/Generics/Object .. 刚从 C++ 迁移到模板 :(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T19:48:18.983

An `int`is not an`Object`所以 an `int[]`is not an `Object[]`：

```
Integer[] I = new Integer[]{1, 2, 3, 4, 5};
WriteLine(I); 
```

或者您应该`WriteLine`为所有原始类型重载：

```
public static void WriteLine(int Array[]) {
...
public static void WriteLine(long Array[]) {
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:49:27.617

我会去

```
System.out.println(Arrays.toString(myArray)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T19:50:04.387

我会将您的数组命名为“Array”以外的名称，因为 Java 将 Array 类与 Object 或 T 泛型类混淆了。如果您只想打印数组的每个元素，您可能还需要考虑使用 StringBuilder。

```
public static void write(Object arr[]) {
    for (int i = 0; i < arr.length; ++i) {
        System.out.println(arr[i]);
    }
} 
```

应该够好了。

如果您真的想使用 StringBuilder，然后打印，请执行以下操作：

```
public static void write(Object arr[]) {
    sb = new StringBuilder();
    for (int i = 0; i < arr.length; ++i) {
        sb.append(arr[i] + " ");
    }
    System.out.println(sb.toString());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T19:52:33.720

原始数组是 java.lang.Object 的子类型。重载在编译时解决，选择最具体的方法，如果是 writeLine(Object text)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T19:55:35.980

您有两个选项来确保调用正确的函数：

1-

```
Object[] objArray = new Object[] { 1, 2, 3, 4, 5 }; 
```

2-

```
Integer[] integerArray = new Integer[] { 1, 2, 3, 4, 5 }; 
```

附带说明一下，您应该遵循[Java 命名约定](http://java.about.com/od/javasyntax/a/nameconventions.htm)。例如方法名称应该是`writeLine`循环中的索引变量应该是`small case`

# php - 添加链接以将 JPGraph 条形图下载为 JPG？

> ID：14780144
> 
> 赞同：0
> 
> 时间：2013-02-08T19:43:45.657
> 
> 标签：php, jpgraph

我有一个使用 jpgraph 的应用程序。我希望能够让用户能够从链接下载图形作为 jpg 文件。当前 URL 如下所示：

```
 chart.php?act=img&t=cost&fy=2012&rt=Electricity&mo=ALL 
```

如果我右键单击下载，它将显示**“无标题”**作为名称，并且只允许我使用**.bmp**格式。如果我预览图像，它确实显示正确，但我想将它保存为**.jpg**

我查看了 JPGRAPH 文档，但在向生成的图像添加扩展时找不到任何内容。

有人有这样做的经验或有想法让我尝试吗？

编辑：：：：：

**我试图将它保存到一个文件中，但是我有许多不同的图表，并且每个图表都需要单独的名称......现在正在处理......：**

```
$graph->Stroke('tmp/myimage.png'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:50:41.300

try using this at the top of **chart.php**

```
header('Content-Disposition: inline; filename="filename.jpg"'); 
```

# algorithm - 如何插入实现为二叉树的二叉最大堆？

> ID：14780152
> 
> 赞同：3
> 
> 时间：2013-02-08T19:43:54.240
> 
> 标签：algorithm, data-structures, language-agnostic, tree, binary-heap

在实现为二叉树的二叉最大堆中（每个节点存储指向其父、左子和右子的指针），如果您有指向堆根的指针，您将如何实现插入操作？应该发生的是节点首先作为最后一行中的最后一个元素插入。对于基于数组，您可以追加到数组，但对于基于树的实现，您将如何找到正确的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:11:01.317

在[这个较早的问题](https://stackoverflow.com/questions/13846585/k-th-element-in-a-heap-tree)中，我给出了一个简短的算法，它使用数字*k*的二进制表示，以便找到一种方法来在自上而下的遍历中从二进制堆中选择第*k个节点。*假设您跟踪二进制堆的显式树表示中的节点数，您可以执行以下操作来执行插入操作：

1.  使用上面的算法，确定新节点应该去哪里，然后在那个位置插入节点。
2.  通过重新连接树以将其与其父级交换或通过交换节点及其父级的数据字段直到元素处于其最终位置，不断地向上冒泡节点。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:29:58.457

如果您将新顶点挂在树的任何叶子下（作为左后继或右后继，无关紧要），然后从这个新顶点修复堆到顶部（也就是说，对于所有其他具有后继的顶点，交换它与更大的继任者并在需要时向上爬），您的新元素将在不破坏堆的情况下找到它的正确位置。但是，这只会保证您每个其他插入操作都将花费 O(h) 时间，其中 h 是树的最大高度。显然，最好将堆表示为一个数组，因为这样可以保证每个插入操作都将花费 O(logN) 时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-08T11:35:26.630

为了找到应该插入新节点的确切位置，我们使用二进制堆大小的二进制表示。这需要 O(log N)，然后我们冒泡它需要 O(log N)。所以插入操作需要 O(log N) ......有关详细说明，请查看我关于二进制堆的博客文章 -

[http://theoryofprogramming.com/2015/02/01/binary-heaps-and-heapsort-algorithm/](http://theoryofprogramming.com/2015/02/01/binary-heaps-and-heapsort-algorithm/)

我希望它对你有帮助，如果有，请告诉我......！☺

# java - 创建一个包含不规则大小矩形的视图 (WebViews)

> ID：14780153
> 
> 赞同：1
> 
> 时间：2013-02-08T19:43:55.183
> 
> 标签：java, android, layout, view, responsive-design

我正在尝试在 Android 上创建一个不规则的动态视图。它由许多矩形组成，它们都可以有不同的大小。视图应该是可滚动的（当您在屏幕上上下滑动手指时显示更多内容）。每个矩形都是一个 WebView： ![布局](../Images/016f8b4775b412cb44a8da37bf9a7856.png)

**问题：**考虑到应该可以创建动态内容，解决此问题的最佳方法是什么？动态内容意味着，从设备上的服务器推送的数据无需任何用户交互即可显示。

我认为使用 ListView 或 GridView，我无法创建跨 ListView 和 GridView 项目边界“合并”的元素。

**Bonuspoints：**你知道任何可以计算布局参数的算法，比如屏幕被瓷砖填满，没有空间是空的吗？

# sql - PostgreSQL 的 libpq 和 SELECT FROM

> ID：14780154
> 
> 赞同：0
> 
> 时间：2013-02-08T19:43:59.777
> 
> 标签：sql, c, postgresql, libpq

我有如下代码（当然是部分的）。我可以成功连接到数据库，我可以做`INSERT INTO`所有这些事情，但是`SELECT FROM`永远无法显示结果。

```
snprintf(sqlSelect, sizeof(sqlSelect), "select * from %s", sqlTableName);

res = PQexec(conn, sqlSelect);
if (PQresultStatus(res) != PGRES_TUPLES_OK) {
    fprintf(stderr, "SELECT FROM failed: %s", PQerrorMessage(conn));
    PQclear(res);
    exitNicely(conn);
}

PQclear(res); 
```

为什么上面的代码没有`SELECT * FROM db_name`在终端打印结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T03:04:25.420

该代码不会打印出或以其他方式使用结果行，它只是获取它们并将它们丢弃。

您需要遍历结果集并实际对其进行处理。有关执行此操作的一些方法，请参阅[libpq 示例](http://www.postgresql.org/docs/current/static/libpq-example.html)。

（CW，因为我只是将欧文的观点转化为答案）。

# jsf-2 - 带有 @NotNull 约束的属性的 JSF 2.0 必需字段标签装饰器

> ID：14780159
> 
> 赞同：10
> 
> 时间：2013-02-08T19:44:06.920
> 
> 标签：jsf-2, primefaces

我有一个*JSF 2.0 应用程序*，它也使用*Primefaces 3.3*。目前有一个很好的功能，如果相关`<p:inputText>`使用`required="true"`属性，标签会用星号装饰。

`@NotNull`该字段绑定到一个带有验证约束注释的 bean 属性。`required="true"`当 bean 属性已经用 @NotNull 注释时，还必须在 XHTML 中添加似乎是多余且容易出错的。

是否有一个钩子或某种方法可以自动装饰使用@NotNull 绑定到属性的组件的标签？

非常感谢任何想法或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T21:26:47.047

注意：这是一个黑客。由于使用了自省，它可能会对性能产生影响

1.  在基本级别上，您需要知道该字段是否使用`@NotNull`. 在一个合理的地方执行这个检查，比如`@PostConstruct`一个视图范围的 bean。声明一个全局变量来确定需要的属性

    ```
    boolean  requiredAttribute;        

    @PostConstruct
    public void init{ 
    Field theField = this.getClass().getField("theField");
    NotNull theAnnotation = theField.getAnnotation(NotNull.class);
    if(theAnnotation != null){
       requiredAttribute = true;
       }
    } 
    ```

2.  将属性绑定`required`到支持 bean 中的变量

    ```
    <p:inputText id="inputit" required="#{myBean.requiredAttribute}"/> 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-27T10:01:50.263

此解决方案基于 PF 6.0，我不记得`BeanValidationMetadataExtractor`在以前的版本中是否可用。无论如何，创建一个 DIY 提取器是一项简单的任务。

我有一个类似的问题。在我的具体情况下：

*   应告知用户某个字段（读取`UIInput`）是必需的
*   我不想`required="true"`在 comp 上重复，因为它已经绑定到`@NotNull`/ `@NotBlank`property/field
*   *在我的情况下，标签组件可能不存在（而且我不喜欢星号标签）*

所以，这就是我所做的：

```
import java.util.Set;
import javax.el.ValueExpression;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.event.AbortProcessingException;
import javax.faces.event.PreRenderComponentEvent;
import javax.faces.event.SystemEvent;
import javax.faces.event.SystemEventListener;
import javax.validation.constraints.NotNull;
import javax.validation.metadata.ConstraintDescriptor;
import org.hibernate.validator.constraints.NotBlank;
import org.hibernate.validator.constraints.NotEmpty;
import org.omnifaces.util.Faces;
import org.primefaces.context.RequestContext;
import org.primefaces.metadata.BeanValidationMetadataExtractor;

public class InputValidatorConstraintListener implements SystemEventListener
{
    @Override
    public boolean isListenerForSource(Object source)
    {
        return source instanceof UIInput;
    }

    @Override
    public void processEvent(SystemEvent event) throws AbortProcessingException
    {
        if(event instanceof PreRenderComponentEvent)
        {
            UIInput component = (UIInput) event.getSource();

            component.getPassThroughAttributes().computeIfAbsent("data-required", k ->
            {
                ValueExpression requiredExpression = component.getValueExpression("required");
                if(requiredExpression != null || !component.isRequired())
                {
                    FacesContext context = Faces.getContext();
                    ValueExpression valueExpression = component.getValueExpression("value");
                    RequestContext requestContext = RequestContext.getCurrentInstance();

                    try
                    {
                        Set<ConstraintDescriptor<?>> constraints = BeanValidationMetadataExtractor.extractAllConstraintDescriptors(context, requestContext, valueExpression);
                        if(constraints != null && !constraints.isEmpty())
                        {
                            return constraints.stream()
                                .map(ConstraintDescriptor::getAnnotation)
                                .anyMatch(x -> x instanceof NotNull || x instanceof NotBlank || x instanceof NotEmpty);
                        }
                    }
                    catch(Exception e)
                    {
                        return false;
                    }
                }

                return false;
            });
        }
    }
} 
```

并在 faces-config.xml 中声明：

```
<?xml version="1.0" encoding="utf-8"?>
<faces-config version="2.2" xmlns="http://xmlns.jcp.org/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-facesconfig_2_2.xsd">

    <application>
        <system-event-listener>
            <system-event-listener-class>it.shape.core.jsf.listener.InputValidatorConstraintListener</system-event-listener-class>
            <system-event-class>javax.faces.event.PreRenderComponentEvent</system-event-class>
        </system-event-listener>
    </application>

</faces-config> 
```

使用这个 listener s 会使用passthrough 属性`UIInput`进行渲染：`data-required`

```
<input 
    id="form:editPanelMain:j_idt253" 
    name="form:editPanelMain:j_idt253" 
    type="text" 
    value="Rack Assemply" 
    size="80" 
    data-required="true"    <============================ NOTE THIS!!
    data-widget="widget_form_editPanelMain_j_idt253" 
    class="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all" 
    role="textbox" 
    aria-disabled="false" 
    aria-readonly="false"> 
```

现在，我使用 css 规则突出显示这些字段：

```
input[data-required='true'], 
.ui-inputfield[data-required='true'], 
*[data-required='true']  .ui-inputfield {
    box-shadow: inset 0px 2px 2px #bf8f8f;
} 
```

您可以调整此侦听器以根据需要设置组件或使用适合您特定需求的其他方法。

另一种方法可能是：

*   听`UILabel`s 而不是`UIInput`s
*   获取`UIInput`与标签的`for`/ `forValue`ValueExpression 关联的
*   检查`UIInput`验证约束
*   最终调用`UIInput.setRequired(true)`

性能影响可以忽略不计，因为我已经测试了大约 3000 个组件的复杂页面。

# java - WSO2 Governance Registry - 添加服务通知

> ID：14780165
> 
> 赞同：0
> 
> 时间：2013-02-08T19:44:40.837
> 
> 标签：java, notifications, registry, axis2, wso2

我正在按照此[**链接**](http://docs.wso2.org/wiki/display/Governance453/Notification+E-mail+Customization+Sample)中列出的示例添加自定义电子邮件通知。

在我的 maven 项目“ *RegistryService* ”中：我创建了 EmailTransformHandler 并使用 maven 创建了*RegistryService-0.1.jar*。我还`GREG_HOME/repository/conf/axis2/axis2.xml`通过添加处理程序来修改：

```
<handler name="EmailTransformHandler"
                 class="com.registration.example.service.EmailTransformHandler"/> 
```

并将 RegistryService-0.1.jar 放入`GREG_HOME/repository/components/dropins`

```
package com.registration.example.service;

import java.util.ArrayList;

import org.apache.axiom.om.OMElement;
import org.apache.axiom.om.xpath.AXIOMXPath;
import org.apache.axiom.soap.SOAPEnvelope;
import org.apache.axis2.AxisFault;
import org.apache.axis2.context.MessageContext;
import org.apache.axis2.engine.Handler;
import org.apache.axis2.handlers.AbstractHandler;

public class EmailTransformHandler extends AbstractHandler implements Handler {

    private String name;

    public String getName() {
        return name;
    }

    @Override
    public InvocationResponse invoke(MessageContext msgContext) throws AxisFault {
        if (msgContext.getTo() != null && msgContext.getTo().getAddress().startsWith("mailto:")) {
            try {
                SOAPEnvelope env = msgContext.getEnvelope();
                AXIOMXPath xPath = new AXIOMXPath("//ns:text");
                xPath.addNamespace("ns", "registry_example");
                OMElement element = (OMElement) ((ArrayList) xPath.evaluate(env)).get(0);
                element.setText(element.getText().replace("--", "This message intercepted by Terminator"));

            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        return InvocationResponse.CONTINUE;
    }

} 
```

当我转到 GREG_HOME/bin 并启动服务器时，出现以下异常：

```
2013-02-08 12:05:00,952] FATAL {org.wso2.carbon.core.init.CarbonServerManager} -  WSO2 Carbon initialization Failed
org.apache.axis2.AxisFault: Exception occured while loading the Axis configuration from GREG_HOME/wso2/wso2greg-4.5.3/repository/conf/axis2/axis2.xml
    at org.wso2.carbon.core.CarbonAxisConfigurator.getAxisConfiguration(CarbonAxisConfigurator.java:190)
    at org.apache.axis2.context.ConfigurationContextFactory.createConfigurationContext(ConfigurationContextFactory.java:64)
    at org.wso2.carbon.core.CarbonConfigurationContextFactory.createNewConfigurationContext(CarbonConfigurationContextFactory.java:65)
    at org.wso2.carbon.core.init.CarbonServerManager.initializeCarbon(CarbonServerManager.java:398)
    at org.wso2.carbon.core.init.CarbonServerManager.removePendingItem(CarbonServerManager.java:290)
    at org.wso2.carbon.core.init.PreAxis2ConfigItemListener.bundleChanged(PreAxis2ConfigItemListener.java:118)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent(BundleContextImpl.java:847)
    at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230)
    at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)
Caused by: org.apache.axis2.deployment.DeploymentException: com.registration.example.service.EmailTransformHandler
    at org.apache.axis2.deployment.util.Utils.loadHandler(Utils.java:149)
    at org.apache.axis2.deployment.AxisConfigBuilder.processPhaseList(AxisConfigBuilder.java:549)
    at org.apache.axis2.deployment.AxisConfigBuilder.processPhaseOrders(AxisConfigBuilder.java:584)
    at org.apache.axis2.deployment.AxisConfigBuilder.populateConfig(AxisConfigBuilder.java:150)
    at org.wso2.carbon.core.CarbonAxisConfigurator.populateAxisConfiguration(CarbonAxisConfigurator.java:308)
    at org.wso2.carbon.core.CarbonAxisConfigurator.getAxisConfiguration(CarbonAxisConfigurator.java:188)
    ... 8 more
Caused by: java.lang.ClassNotFoundException: com.registration.example.service.EmailTransformHandler
    at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513)
    at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:429)
    at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417)
    at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at org.apache.axis2.util.Loader.loadClass(Loader.java:261)
    at org.apache.axis2.util.Loader.loadClass(Loader.java:229)
    at org.apache.axis2.deployment.util.Utils.loadHandler(Utils.java:116)
    ... 13 more 
```

我缺少什么配置？谷歌搜索这个错误不会产生任何相关结果（除了一些对我没有多大帮助的俄罗斯论坛）。我什至尝试通过 WSO2 管理控制台添加 jar 作为扩展，但我仍然得到这个异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:31:34.750

根据错误，您的 RegistryService-0.1.jar 未正确设置为类路径。如果 jar 文件不是 OSGI 包，则应将 jar 文件放入“GREG_HOME/repository/components/lib”目录。

-阿吉特

# highcharts - HighCharts 数据标签重叠

> ID：14780172
> 
> 赞同：1
> 
> 时间：2013-02-08T19:45:38.417
> 
> 标签：highcharts

[http://jsfiddle.net/nUCBj/1/](http://jsfiddle.net/nUCBj/1/)

如何防止数据标签重叠？我尝试使用格式化程序选项并使用 CSS 位置/顶部/底部等定位 dataLabel... 数据标签是必需的。我不能只在它的地方使用工具提示:-)

谢谢，

```
$(function () {
var chart = new Highcharts.Chart({
    chart: {
        renderTo: 'container'
    },
    xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },

    plotOptions: {
        series: {
            dataLabels: {
                enabled: true,
                backgroundColor: 'rgba(255, 255, 255, 0.7)',
                borderWidth: 1,
                shadow: true,
                borderRadius: 1,
                useHTML: true,
                padding: 1
            }
        }
    },

    series: [{
                        name: 'test',
        data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4] },{
            name: 'test2',
        data: [31, 80, 106.4, 22, 150, 17, 135.7, 14, 230, 181, 9, 54]
    }]
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:19:58.427

系列中的数据属性可以作为对象数组而不是数字数组传入。每个对象都可以定义自己的 dataLabels 选项（[http://api.highcharts.com/highcharts#series.data](http://api.highcharts.com/highcharts#series.data)）。对于第一个系列，您可以将点对齐到左侧，将第二个对齐到右侧，这样它们就不会重叠。

# python - Django 自定义保存装饰器导致表单集保存中的内部错误（管理员内联）

> ID：14780175
> 
> 赞同：0
> 
> 时间：2013-02-08T19:45:51.743
> 
> 标签：python, django

我有一个自定义保存方法和一个自定义装饰器，可以在我的自定义保存之前和之后运行 Django 的模型 save()：

模型.py：

```
from django.contrib.auth.models import User
from django.db import models

def save_decorator(method_to_decorate):
    def wrapper(self, *args, **kwargs):
        super(type(self), self).save(*args, **kwargs)
        method_to_decorate(self, *args, **kwargs)
        super(type(self), self).save(*args, ** kwargs)
    return wrapper

class The_Image_Abstract(models.Model):

    class Meta:
        abstract = True

    create_time = models.DateTimeField(editable=False)

class Avatar(The_Image_Abstract):
    #I'm using this to track Avatar class in the template. There should be a better way.

    user = models.OneToOneField(User, related_name='avatar')

    @save_decorator
    def save(self, *args, **kwargs):
        "my stuff here"
        pass 
```

当 Avatar 在管理页面中保存或修改时，这非常有效。但是，当 Avatar 在另一个模型的内联中保存为表单集时，它会引发内部错误（表单集在添加装饰器之前工作）。这里出了什么问题？我看到有人在使用 Postgres 时收到此错误的帖子，而且我也在使用 Postgres，但我不认为这种情况是由 Postgres 引起的。

```
Request Method:     POST
Request URL:     http://localhost/admin/auth/normal_user/add/
Django Version:     1.4.3
Exception Type:     InternalError
Exception Value:     

current transaction is aborted, commands ignored until end of transaction block

Exception Location:     /home/eras/projects/kart/venv/local/lib/python2.7/site-packages/django/db/models/sql/compiler.py in execute_sql, line 912
Python Executable:     /home/eras/projects/kart/venv/bin/python
Python Version:     2.7.3 
```

任何帮助表示赞赏！

谢谢，

时代

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:09:20.847

好的，我找到了发生这种情况的原因。这与装饰器在设置一些没有默认值的非空字段之前尝试保存模型有关。我仍然不确定为什么只有在管理内联（表单集）中保存新对象时才会导致错误。但是在运行自定义保存功能之前将这些必填字段设置为某个值可以解决问题。

# java - javax.persistence.Entity 生成 NullPoint 异常

> ID：14780176
> 
> 赞同：0
> 
> 时间：2013-02-08T19:45:51.713
> 
> 标签：java, hibernate, jpa, playframework, playframework-2.0

我在 play framework 2.0.4 中使用 Hibernate for ORM。我有一个名为 video 的模型类，它使用 JPA 进行了注释。但是，当我运行应用程序时，出现以下错误

```
 [NullPointerException: null] In C:\Users\username\IdeaProjects\projectname\app\models\Video.java at line 4.

 1package models;

2

3 import java.util.Date;
4 import javax.persistence.Entity;
5 import javax.persistence.Id;
6
7@Entity
8public class Video { 
```

我刚刚开始学习游戏，不知道是什么导致了这个问题以及如何解决它。堆栈跟踪 ！@6d9h9310f - 内部服务器错误，请求 [GET /] ->

```
 play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NullPo
  interException: null]]
    at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [
  play_2.9.1.jar:2.0.4]
    at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [
 play_2.9.1.jar:2.0.4]
    at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2]
    at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.
 4]
    at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.
  2]
    at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.j
   ar:2.0.2]
 Caused by: java.lang.NullPointerException: null
    at models.Video._ebean_get_video_name(Video.java:4) ~[classes/:na]
    at models.Video.getVideoName(Video.java:43) ~[classes/:na]
    at controllers.Application.index(Application.java:15) ~[classes/:2.0.4]
    at Routes$$anonfun$routes$1$$anonfun$apply$1$$anonfun$apply$2.apply(rout
 es_routing.scala:32) ~[classes/:na]
    at Routes$$anonfun$routes$1$$anonfun$apply$1$$anonfun$apply$2.apply(rout
  es_routing.scala:32) ~[classes/:na]
    at play.core.Router$HandlerInvoker$$anon$5$$anon$1.invocation(Router.sca 
```

我意识到然后我只是调用视频实体的主键我没有问题但是当我尝试获取任何其他属性时会发生这种情况。我还意识到在我的数据库中生成了一个名为 _ebean_intercept 的新列，它的所有行都是空的，这是否会导致问题。

# java - 在操纵杆上保持位置

> ID：14780177
> 
> 赞同：0
> 
> 时间：2013-02-08T19:45:53.980
> 
> 标签：java, android

我正在尝试编写一个操纵杆，在该操纵杆中，用户仅在停止移动拇指（或至少只有一点，例如摇晃）时才发送他的坐标。

我找不到为此的触摸事件。

进一步说明：棕色 = 拇指，红色是可以容忍的区域/圆圈（在该空间中移动接下来的 2 秒将计为 1 个坐标）

![在此处输入图像描述](../Images/c263a02d8fc097ef35b02ef76cd47564.png)

```
int actionType = event.getAction();
if (actionType == MotionEvent.ACTION_MOVE){} 
```

这就是我检索我的 toucheventdata 的方式。我需要类似`ACTION_HOLD`计时器的东西。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-19T12:56:57.997

尝试四舍五入坐标。

将坐标除以整数（例如 10），

将结果转换为整数（或四舍五入）并在下一步中乘以相同的整数。

例子：

```
5,30 / 10 = 0,53
(int) 0,53 = 0
0 * 10 = 0

14,4 / 10 = 1,44
(int) 1,44 = 1
1 * 10 = 10 
```

# ruby - 设计与 RoR3 应用程序上的多个子域无法正常工作

> ID：14780178
> 
> 赞同：9
> 
> 时间：2013-02-08T19:46:00.373
> 
> 标签：ruby, ruby-on-rails-3, cookies, devise

我已经看到很多关于这个主题的问题，但其中很多都有相互矛盾的信息，并且由于某种原因它对我不起作用。

**我有：**

顶级域：即 lvh.me（开发）。每个用户都有子域：即 userdomain.lvh.me 登录表单在顶级域中：lvh.me

**我想：**

*   如果用户登录，则需要在所有子域之间共享会话。我的意思是，会话需要在 lvh.me:3000/something 和 userdomain.lvh.me:3000 中处于活动状态
*   如果用户从 lvh.me:3000/something 注销它应该可以工作，如果用户从 userdomain.lvh.me:3000 注销它也应该可以工作。

**我试过**

*   在初始化程序中设置以下内容：

    MyApplication::Application.config.session_store :cookie_store, :key => '_mykey', :domain => :all

**发生了什么？**

我可以登录 lvh.me:3000，我被正确地重定向到 lvh.me:3000/internalpage，如果我去 subdomain.lvh.me:3000 效果很好。我也可以从 lvh.me:3000/internalpage 注销，**但是**如果我尝试从 subdomain.lvh.me:3000 注销它不起作用。Devise SessionsController 中的destroy 动作被执行，一切都被执行，但会话并没有终止。

* * *

根据[http://excid3.com/blog/sharing-a-devise-user-session-across-subdomains-with-rails-3/](http://excid3.com/blog/sharing-a-devise-user-session-across-subdomains-with-rails-3/)，

> 这里的诀窍是 :domain 选项。它的作用是设置 TLD（顶级域）的级别并告诉 Rails 域的长度。您要在这里注意的部分是，如果您设置 :domain => :all like 在某些地方是推荐的，除非您使用 localhost，否则它根本不起作用。:all 默认的 TLD 长度为 1，这意味着如果您使用 Pow (myapp.dev) 进行测试，它也不会工作，因为这是长度为 2 的 TLD。

**所以，读完之后我也试过了**

MyApplication::Application.config.session_store :cookie_store, :key => '_mykey', :domain => 'lvh.me'

**发生了什么？** 我可以登录 lvh.me:3000，我被正确重定向到 lvh.me:3000/internalpage，如果我去 subdomain.lvh.me:3000 它不起作用，我在那里没有会话。如果我回到 lvh.me:3000/internalpage 我的会话就消失了。那里发生什么了？

* * *

**还有什么？**

然后，在阅读[rails 3.2 subdomains 并设计](https://stackoverflow.com/questions/9540354/rails-3-2-subdomains-and-devise)之后，我将初始化程序行更改为

```
MyApplication::Application.config.session_store :cookie_store, :key => '_mykey', :domain => '.lvh.me' 
```

注意“。” 在域名之前。根据SO中的帖子：

> 这允许跨子域访问此 cookie，并且应用程序应跨子域维护它的会话。可能不是 100% 您正在寻找的东西，但它应该让您朝着正确的方向前进。

**发生了什么？** 没什么，没用。如果与我尝试的最后一件事相比，行为相同。

* * *

我终于尝试[了 Rails 3 session_store domain :all 真的做什么？](https://stackoverflow.com/questions/4060333/what-does-rails-3-session-store-domain-all-really-do) ，创建一个自定义类来处理 cookie。但我没有运气。

当然，我在每次尝试之前都删除了所有 cookie 和临时文件。我还更改了 cookie 的名称。有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T21:46:30.287

根据这个人的说法：[Rails：我如何在多个子域之间共享永久 cookie？](https://stackoverflow.com/q/6301121/429564)您需要手动设置域吗？谷歌搜索它看起来像`'.domainname.com'`一开始的点真的是要走的路。

如果您继承自`Devise::SessionsController`您可以在创建时手动设置它

```
class SessionsController < Devise::SessionsController
  def create
    # modify the cookie here
    super
  end
end 
```

我正在设置一个工作示例来测试它，我会在之后发回，干杯！

# 这是我的编辑

忘记在创建时使用令牌进行回火。问题在于，您需要将令牌域设置为“.lvh.me”，这就是它的全部内容，*但* `domain: '.lvh.me'`什么也不做。这是我的概念证明，最终归结为控制器内部的单个更改：

```
class HomeController < ApplicationController
  def index
    cookies[:_cookietest_session] = {domain: '.lvh.me'}
  end
end 
```

在 Chrome 中，令牌看起来像这样

![在此处输入图像描述](../Images/8ab0fa21d4efe2883a3a27d00f39593b.png)

对于 subdomain.lvh.me、lvh.me 和我尝试过的任何其他子域。我可以从任何地方登录/签出，并相应地创建/销毁会话。

现在我不建议按照我的方式进行操作，我喜欢中间件方法，我认为如果设置正确，它会工作得很好。如果您需要进一步的帮助，请告诉我。

干杯!

## 好的最后一件事

我回去尝试了，`domain: :all`因为它确实应该按您的预期工作。如果我访问 lvh.me，我会得到一个带有 .lvh.me 的 cookie，但如果我访问 subdomain.lvh.me，我会得到一个读取 .subdomain.lvh.me 的 cookie

![在此处输入图像描述](../Images/b8ef99093cd918dfb7827c49051f1ada.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-25T19:17:56.593

我认为问题在于 :all 添加了 . 到 subdomain.lvh.me，这样您就可以使用 foo.subdomain.lvh.me 保持登录状态，这对您没有多大好处。

:all 如果您的原始登录名来自根域 lvh.me 然后您重定向到子域，则似乎可以正常工作。但是您无法通过以这种方式设置的子域登录。

```
MyApplication::Application.config.session_store :cookie_store, :key => '_mykey', :domain => '.lvh.me' 
```

看起来像是指定这个的正确方法。

笔记：

*   确保在进行更改后重新启动 rails。
*   确保在再次测试之前清除您的域的 cookie。您可以留下在测试之间造成混淆的剩余 cookie。

# file - Visual Studio 2012 是否保存欺骗 Dropbox 的文件？

> ID：14780183
> 
> 赞同：1
> 
> 时间：2013-02-08T19:46:14.610
> 
> 标签：file, visual-studio-2012, dropbox

我正在将 VS2012 用于新的 Windows Store 应用程序。我有两台机器，一台 Win8 PC 和一台 MacBook Pro，它们都使用同一个 DropBox 帐户来保持工作文件同步。这是问题所在。我目前只在 PC 上工作，使用 VS2012。然而，我不断收到一个弹出对话框消息，提示我一直在编辑和测试的文件已被另一个程序修改，我要重新加载它吗？

我拒绝重新加载它，然后转到单独的文本编辑程序来比较这两个文件。

这是我找到的。标记为“home.js”的文件仍然包含我开始编辑会话时的原始内容。标记为“home（Dell1405 的冲突副本 2013-02-08）.js”的文件与我的最新更新一致。因此，DropBox 似乎已尝试同步文件的较新副本，但导致认为该文件来自另一个来源，因此将其标记为冲突副本。

所以 VS 提醒我的“新”文件实际上是我在调试模式下运行项目时保存的最新副本，它与 VS 编辑窗口中显示的代码一致。

所以我的问题是：在调试时，VS 是否将我的代码文件保存在与我看到的磁盘位置不同的某个临时区域中？这就是让 DropBox（和我）感到困惑的地方吗？如果是这样，我该如何解决？

我想我可以在开始工作之前关闭我的 PC 上的 DropBox，但是我不得不求助于sneaker-net 将编辑过的图像从我的 Mac 移动到 PC。

# angularjs - 在 AngularJS 中管理同步服务器端数据的最佳方法

> ID：14780185
> 
> 赞同：1
> 
> 时间：2013-02-08T19:46:19.480
> 
> 标签：angularjs

我正在使用 Oauth 在我的 AngularJS 应用程序中管理会话用户。我的 Angular 应用程序需要知道有关会话用户的信息，因为它在我的 $resource 对象中使用（用于进行 GET /user/:user/projects 之类的 REST 调用）。我希望这个用户变量是全局和**同步**的，因此使用 $resource 或 $http 进行异步调用以获取用户将样板添加到需要此会话用户的代码中（因为它必须等待用户信息从服务器返回）。

现在我正在使用这个肮脏的黑客来解决这个问题：在我的 index.ejs 文件中（注意用户是用 ejs 呈现在服务器端的）

```
 <script type="text/javascript">

    var session_user =  <%- user  %>;

    </script> 
```

然后我做

```
$rootScope.user = session_user 
```

问题是当我对控制器进行单元测试时，当然 session_user 没有定义。

我在想也许我可以创建一个返回这个`session_user`变量的服务，所以我可以使用模拟进行测试。还有其他想法吗？解决此类问题的推荐方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T21:00:53.750

实际上，这似乎并没有那么多肮脏的黑客行为。仅当会话用户更改而不从服务器重新加载您的 html（从而获得新的会话用户）时，这似乎是有问题的。

Angular 模块具有`constant`我用于此类事情的功能：

```
angular.module("MyModule", [])
       .constant("User", window.session_user); 
```

然后您可以将`User`其视为控制器中的可注入值。

# android - TextView 的文本对齐方式

> ID：14780187
> 
> 赞同：0
> 
> 时间：2013-02-08T19:46:26.597
> 
> 标签：android

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout
    android:id="@+id/widget33"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:stretchColumns="*"
    xmlns:android="http://schemas.android.com/apk/res/android">
<TableRow
    android:id="@+id/widget34"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">
<TextView
    android:id="@+id/widget35"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView"
    android:gravity="center" />
<TextView
    android:id="@+id/widget36"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView"
    android:gravity="center" />
<TextView
    android:id="@+id/widget37"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView"
    android:gravity="center" />
</TableRow>
</TableLayout> 
```

即使设置了文本，文本`TextViews`也未对齐。文本移动到极右。当我在 droidDraw 中检查相同的代码时，一切似乎都很好。发生了什么？`centre``gravity``center`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:16:23.677

//尝试

```
android:layout_gravity="center" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:02:36.017

只要你使用`wrap_content`for`android:layout_width`和`android:layout_height`，重力不会做任何事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-08T20:03:48.313

如果您将 TextView 设置为 wrap_content 它占用尽可能小的空间。当您将其设置为居中时，它会在 wrap_content 中居中。这似乎没有区别。

如果将 TextView 设置为 fill 或 match_parent，它将在 TableLayout 内居中。

# excel - Excel - 将数据从一个范围匹配到另一个范围，并从匹配数据右侧的单元格中获取值

> ID：14780192
> 
> 赞同：3
> 
> 时间：2013-02-08T19:46:43.427
> 
> 标签：excel

我对 Excel 公式并不是那么好，我正在尝试弄清楚如何首先检查列中是否存在单元格值，如果存在，则获取下一个单元格的值。

具体来说，我有一系列单元格，从 B31 到 B39。我想要做的是查看这些值是否出现在单元格 F3 到 F12 中，如果出现，则将单元格中的值直接放在右侧，即 G3 到 G12 列的位置 D31 到 D39。

我尝试了 IFs 语句、匹配、VLookup 并尝试了我在网上找到的解决方案，但它不断返回公式无效。我也尝试过 Stack Overflow 中给出的答案：

> Excel：检查列中是否存在单元格值，然后获取下一个单元格的值

，但我并不真正理解这个公式，所以我在尝试将我的范围转换为给定的公式时迷路了。

这是我正在尝试使用的公式。

> =If (ISerror(Match (B31,F:F,0),"不匹配", Vlookup (b31,F,G,2,false)

请任何人都可以帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T19:55:16.493

将此公式放入单元格 d31 并复制到 d39

```
 =iferror(vlookup(b31,$f$3:$g$12,2,0),"") 
```

这是正在发生的事情。查找：

*   取一个值（这里是 b31 的内容），
*   在范围的第一列（范围 f3:g12 中的 f3:f12）中查找它，并且
*   返回该范围内的列中对应行的值（在本例中，为范围 f3:g12 的第二列或 g3:g12）。

如您所知，VLOOKUP 的最后一个参数设置匹配类型，FALSE 或 0 表示完全匹配。

最后，当 VLOOKUP 未找到匹配项时，IFERROR 会处理 #N/A。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T04:30:28.383

这是我如何使用chuffs解决方案中的公式：

在 Sheet1 的 C5 列中，我有一个列表中的名字和调查的答案，但没有电子邮件地址。在第二张表的 A1 和 C1 列中，我有名字和电子邮件地址，但没有对调查的答案。我需要电子邮件地址和我的项目调查的答案。

使用这个公式，我能够得到如下解决方案，将匹配的电子邮件地址放在工作表 1 的 A1 列中。

```
=IFERROR(VLOOKUP(C5,Sheet1!$A$2:$C$654,3,0),"") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-09T16:04:15.523

谢谢你们，伙计们。你很棒。

我使用了[Chuff 的答案](https://stackoverflow.com/a/14780334/2311633)并对其进行了一些修改以做我想做的事。

我在同一个工作簿中有 2 个工作表。

在第一个工作表上，我在 3 列中有一个 SMS 列表：`phone number, date & time, message`

然后我在电话号码旁边插入了一个新的空白列

在工作表 2 上，我有两列：`phone number, name of person`

使用公式检查左侧的单元格，并与工作表2中的范围匹配，选择与数字对应的名称并将其输入到工作表1的空白单元格中。

然后只需将公式复制到整个列，直到最后一个短信它工作得很好。

```
=VLOOKUP(A3,Sheet2!$A$1:$B$31,2,0) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-20T07:08:03.533

我在我的 Excel 表上添加了以下内容

```
=VLOOKUP(B2,Res_partner!$A$2:$C$21208,1,FALSE) 
```

似乎仍然不起作用。我得到一个#N/A
但是

```
=VLOOKUP(B2,Res_partner!$C$2:$C$21208,1,FALSE) 
```

作品

# android-widget - 自动关注数字密码输入的下一个编辑文本

> ID：14780195
> 
> 赞同：0
> 
> 时间：2013-02-08T19:47:12.680
> 
> 标签：android-widget

从我的应用程序中，我希望在 iPhone 上实现的更像是用四位数字输入密码，这意味着带有掩码点。我已经完成了正确的条目。但是，在使用 TextWatcher 的具体实现`addTextChangedListener`时，当我输入了 4 个错误的数字并且焦点返回到第一个数字并且每个数字也被清除时。在这种情况下，用于数字输入的原始软键盘切换回 qwert 键盘，输入的任何字母或数字都变得可见，而不会被点屏蔽。

```
myEditText1.addTextChangedListener(new MyTextWatcher(mPasswordEditText){
       @Override
        public void afterTextChanged(Editable arg0) {
        }

        @Override
        public void beforeTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {

        }

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            s = mPasswordEditText.getText();
            int cacheH = UnlockScreen.this.mPasswordEditText.getHeight();
            if(s.length() == 1){
                UnlockScreen.this.mPasswordEditText1.requestFocus();
                    mPasswordEditText.setInputType(InputType.TYPE_TEXT_VARIATION_PASSWORD);
                    mPasswordEditText.setTransformationMethod(PasswordTransformationMethod.getInstance());
                    mPasswordEditText.setMinHeight(cacheH);
            }                   
        }
}); 
```

但它并没有像预期的那样运作良好。XML 布局是：

```
 <EditText
                    android:id="@+id/unlock_screen_password_edittext_1"
                    style="@style/passcodeStyle"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight=".20"
                    android:layout_marginRight="10dip"
                    android:digits="@string/digits_only"
                    android:gravity="center"
                    android:inputType="number"
                    android:password="true"
                    android:maxLength="1"/> 
```

任何想法，伙计们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:31:35.930

我正在使用 setText(s.toString().replace(s.toString(), '.')); 而不是 mPasswordEditText.setInputType(InputType.TYPE_TEXT_VARIATION_PASSWORD); 和 mPasswordEditText.setTransformationMethod(PasswordTransformationMethod.getInstance()); 并在每个编辑文本中为 textChange 状态设置标志。我不确定这是否是最好的解决方案，但对于我的应用程序来说，它工作得很好，到目前为止我还没有想到更好的方法。

# android - 如何在 Android 中使用 Google chrome 而不是 WebView 加载网页？

> ID：14780196
> 
> 赞同：0
> 
> 时间：2013-02-08T19:47:23.060
> 
> 标签：android, google-chrome, android-webview

我想让用户通过单击按钮访问我的网站。

但是，我希望应用程序打开谷歌浏览器或其他外部网络浏览器来打开网站，而不是使用 WebView 加载 url。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:52:17.670

你可以用`ACTION_VIEW` `Intent`——

```
Uri myUri = Uri.parse("http://www.whereever.com/");
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(myUri);
startActivity(intent); 
```

如果您想在单击按钮时执行此操作，则需要将其放入`onClick`您的`onClickListener`.

# php - MySQL 检索数据 IF 列不为空

> ID：14780199
> 
> 赞同：-1
> 
> 时间：2013-02-08T19:47:43.113
> 
> 标签：php, mysql, sql, if-statement, pdo

我有这张桌子：

```
title1  title2   type
---------------------
qwe1    xcv2     3
asd1    tzu      7
fgh1    (empty)  4 
```

我有这个查询：

```
SELECT `title1` AS `title`, `type`
FROM `table`
UNION
SELECT `title2` AS `title`, `type`
FROM `table`
ORDER BY `title` ASC, type 
```

（请[在此处查看小提琴](http://sqlfiddle.com/#!2/3ec9a/5)）。

如果 title2 为空，如何转换此查询以使其不显示任何行？不应显示第 1 行。

我试图实现一个 IF 语句，但我总是得到一个 mysql 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:57:50.643

使用 时`UNION`，会删除重复项。你确定你不想用`UNION ALL`吗？另外，你有什么理由需要一个`title2`？对我来说，它似乎没有正常化。

```
SELECT title1 AS title, `type`
FROM `table`
UNION ALL
SELECT title2 AS title, `type`
FROM `table`
WHERE title2 IS NOT NULL AND title2 <> '' 
```

## [查看演示](http://sqlfiddle.com/#!2/3ec9a/26)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:55:27.300

您应该使用 WHERE 语句为您的查询定义条件

```
SELECT `title1` AS `title`, `type`
FROM `table`
WHERE `title1` IS NOT NULL AND LENGTH(`title1`) > 0
UNION
SELECT `title2` AS `title`, `type`
FROM `table`
WHERE `title2` IS NOT NULL AND LENGTH(`title2`) > 0
ORDER BY `title` ASC, type 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:16:16.217

我认为，而不是检查 if`title2 is not null`和`title2 <> ''`，最短的方法是使用 COALESCE 将任何 Null 值转换为空，然后检查 COALESCE 的结果是否为 <> ''，如下所示：

```
SELECT title1 AS title, `type`
FROM `table`
UNION
SELECT title2 AS title, `type`
FROM `table`
WHERE COALESCE(title2, '') <> '' 
```

如果您不需要删除重复项，我认为最好使用 UNION ALL 而不是 UNION。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T19:53:32.597

这应该涵盖空字符串和空值：

```
SELECT `title1` AS `title`, `type`
FROM `table`
UNION
SELECT `title2` AS `title`, `type`
FROM `table` where title2 is not null and title2 <> ''
ORDER BY `title` ASC, type 
```

# php - MySQL Insert 是否允许不指定所有字段？

> ID：14780200
> 
> 赞同：3
> 
> 时间：2013-02-08T19:47:46.403
> 
> 标签：php, mysql, database

我有两个 mysql 插入语句。在插入语句中指定的所有字段都可以正常工作并将记录插入到 testTable。（即使 http_referer 为空，插入语句也将记录插入到引用字段为空的表中）

指定所有字段的第一个插入语句：

```
mysql_query("INSERT INTO testTable VALUES('$ID','".$_SERVER['REMOTE_ADDR']."',NOW(),'Page1','".$_SERVER['HTTP_REFERER']."')"); 
```

问题在于第二个插入语句没有向 testTable 插入任何记录！你们能告诉我为什么我的第二个插入语句没有向 testTable 插入任何记录吗？

第二个插入语句：

```
mysql_query("INSERT INTO testTable VALUES('$ID','".$_SERVER['REMOTE_ADDR']."',NOW(),'Page1')"); 
```

创建表：

```
CREATE TABLE IF NOT EXISTS `testTable` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `ip` varchar(32) DEFAULT NULL,
  `date` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  `Title` varchar(32) NOT NULL,
  `Ref` varchar(250) NULL default '',
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1784 ; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T19:49:22.300

是的，通过使用列列表。

```
$sql = "INSERT INTO table (`ip`, `date`, `Title`) VALUES ('".$_SERVER['REMOTE_ADDR']."', NOW(), 'Page 1')"; 
```

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T19:51:35.393

您可以选择在插入语句中指定要插入的列。

```
$sql = "INSERT INTO testTable(ID, ip, date, Title)
VALUES('$ID','".$_SERVER['REMOTE_ADDR']."',NOW(),'Page1')"; 
```

此外，请不要使用`mysql`现在已弃用的函数。使用`MySQLi`, 或`PDO`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T19:50:13.763

您必须使用第二个查询指定字段。如果您不打算按列的顺序插入每一列，那么您必须指定列名。

```
INSERT INTO table (column1, column2, columns3) VALUES ('$value1', '$value2', '$value3'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T19:53:19.353

您可以使用列列表或`SET`语法

栏目列表：

`INSERT INTO table (column1, column2) VALUES ('$value1', '$value2');`

设置语法：

`INSERT INTO table SET column1 = '$value1', column2 = '$value2';`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T20:20:47.550

在第一个查询中不会出现错误，因为您正在指定所有列和字段。如果任何字段是自动增量或默认为 null，您应该提及所有列名以及插入查询中的值，接受自动增量字段的 null

这是演示

1.  所有字段值

    ```
    insert into testtable values (1,"127.1.1.0",curdate(),"test 1","default"); 
    ```

2.  无默认值

    ```
    insert into testtable (id,ip,date,title) values (1,"127.1.1.0",curdate(),"test 1"); 
    ```

3.  没有自动增量字段

    ```
    insert into testtable (ip,date,title) values ("127.1.1.0",curdate(),"test 1"); 
    ```

# java - GWT GXT StoreFilterField 事件

> ID：14780202
> 
> 赞同：0
> 
> 时间：2013-02-08T19:47:50.067
> 
> 标签：java, gwt, filter, tree, gxt

仅当用户至少键入 3 个字符时，我才想搜索我的树。我如何捕捉“doSelect”事件来做到这一点？如果我在文本字段上添加一个 keylistener 来检查它的值，则在 doSelect 之后调用处理程序。谁能帮我？

这是一个例子...

```
 filterText = new StoreFilterField<ModelData>() {

        @Override
        protected boolean doSelect(Store<ModelData> store,
                ModelData parent, ModelData record, String property,
                String filter) {

                String name = record.get("name");
                name = name.toLowerCase();
                if (name.startsWith(filter.toLowerCase())) 
                    return true;
                else
                    return false;
        }

    };

    KeyListener keyListener = new KeyListener() {
        public void componentKeyUp(ComponentEvent event) {
            loadingImage.setVisible(false);
            if(filterText.isValid() && filterText.getRawValue().length()>=FILTER_MIN_SIZE) {
                filterText.bind(store);
            } else {
                filterText.unbind(store);
            }

        }

    }; 
    filterText.setMinLength(FILTER_MIN_SIZE);
    filterText.bind(store); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:05:17.703

（似乎是 GXT 2，如果您实际使用的是 GXT 3，请告诉我）

`StoreFilterField`依赖于`applyFilters`实际应用所有这些的方法。它已经检查了文本是否至少有一个字符：

```
protected void applyFilters(Store<M> store) {
  if (getRawValue().length() > 0) {
    store.addFilter(filter);
    store.applyFilters(property);
  } else {
    store.removeFilter(filter);
  }
} 
```

我看到覆盖它的最简单方法是子类化`StoreFilterField`并重新定义此方法：

```
filterText = new StoreFilterField<ModelData>() {
  @Override
  protected void applyFilters(Store<M> store) {
    if (getRawValue().length() > 3) {
      store.addFilter(filter);
      store.applyFilters(getProperty());
    } else {
      store.removeFilter(filter);
    }
  }
} 
```

# javascript - 根据值在气泡图上设置气泡颜色

> ID：14780203
> 
> 赞同：0
> 
> 时间：2013-02-08T19:47:55.073
> 
> 标签：javascript

我必须根据数组上的数字设置气泡图上每个气泡的颜色。我唯一知道的是：

*   如果值等于**3**，颜色必须是**"#a68500"**
*   如果值等于**0**，颜色必须是**"#fff79b"**

因此，如果数组的一个元素的值为“2.5”，我必须在色标中找到代表该数字的颜色。

我正在使用 dojox.charting，但我不知道如何创建一个基于值返回颜色的函数。

任何想法都会有所帮助！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:04:00.830

所以在这里我认为你会想要对数值 rgb 值做一些基于百分比的数学运算。如果您有 rgb 到 hex 函数可用，请利用它们，如果没有：

```
var r,g,b,rgb = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(color);

if( rgb.length == 5 ) { //argb hex format
    r = parseInt(rgb[2], 16);
    g = parseInt(rgb[3], 16);
    b = parseInt(rgb[4], 16);
    }
else {
    r = parseInt(rgb[1], 16);
    g = parseInt(rgb[2], 16);
    b = parseInt(rgb[3], 16);
} 
```

因此，对于 r：0 是 ff，3 是 a6，您将转换为 0:255 和 3:166，这会将 2.5 置于 ~181 回到 Hex 会做`181.toString(16);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:13:55.753

```
function getInterpolation(x, min1, max1, min2, max2) {
    return Math.round(x/(max1-min1)*(max2-min2)+min2);    
} 
```

`getInterpolation(2.5, 0, 3, 0xff, 0xa6);`对每个 RGB 组件使用此方法。如果您经常在循环中使用它，您可以将 min 和 max 更改为一些 const 值。

# c++ - 自制的 Vigenere 密码；使用 acsii 字符操作

> ID：14780206
> 
> 赞同：0
> 
> 时间：2013-02-08T19:48:04.640
> 
> 标签：c++, ascii, modulo, vigenere

正如帖子标题所暗示的，我正在努力加强对 C++ 和字符操作的掌握，这一次是通过创建 Vigenere Cipher。对于那些不熟悉它的人来说，这是一种加密文本文件的相当简单的方法。

它的基本工作方式是存在一个字符串“key”，并且每个字符（至少在我的情况下）都是一个小写字母字符。这些存储在一个数组中，用于“移动”正在编码的文件的值。字符“a”会将目标移动 0，而“z”会将目标移动 25。“移位”是循环的，这意味着如果“z”移动“b”（1），它应该会导致'一种'。

* * *

**我目前的方法如下：**

```
//Assume cipher[] contains "[a][b][c][x ][y ][z ]" Cipher is a <string> object
//Assume ptr[] contains    "[0][1][2][23][24][25]
#A whole bunch of includes
char c;
ifstream is;
ofstream os;
is.open(argv[3]) //"myinput.txt"
os.open(argv[4])  //"myoutput.txt"

int i = 0;

while( is.good() ) {

    c = is.get();

    if( is.good() ) { //did we just hit the EoF?

        c = tolower( c - 0 ); //just make sure it's lowercase

        c = c + ptr[ i % cipher.size() ] % 26;

        if( c> 122 )
            c = ( c % 123 ) + 97;

        i++;
        os.put( c );
    }
} 
```

* * *

我相信我的问题在于我的模运算。也许是因为我花了很多时间来解决这个问题，但我昨晚花了几个小时写这个，然后又躺在床上一个小时试图把我的想法包裹在如何有效地创造我想要的东西上：

```
grab char.
check char.                            //let char = 'z'
check the cipher.                      //let the cipher = 'y'
eval cipher shift                      //'y' shift value = 24
shift z 24 places (cyclically)         //'z'==25, 25+24=49, 49%26=23\. 23='x' 
```

问题在这里：如何使用 ACSII 做到这一点？('a'=97, z='121')

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:56:08.787

想象一下，您想通过两步将“1”数字 0-9 在 20 和 29 之间“洗牌”，使 20 变为 22，而 29 变为 21。你会怎么做？

好吧，我会减去 20 [我们的基数]，然后将剩余的数字洗牌，然后再加 20。

新数字 = 数字 - 20；新数字 %= 10; 新数字 += 20;

同样的原则也适用于 ascii——当然基数不是 20。

# java - 识别 Tomcat 上的服务器（HttpServletRequest.getLocalAddr() 失败）

> ID：14780207
> 
> 赞同：1
> 
> 时间：2013-02-08T19:48:05.483
> 
> 标签：java, apache, tomcat

使用 Apache 后面的 Tomcat 设置，如何轻松确定服务器的 id（理想情况下为 IP 地址）？

具体情况是在负载均衡器后面设置了多个服务器，因此传入的请求主机名不唯一，不足以识别特定服务器以进行日志记录。不幸的是，使用`HttpServletRequest.getLocalAddr()`返回相同的主机名而不是预期的 IP 地址（我假设这与这里的这个非常老的问题有关：[https](https://issues.apache.org/bugzilla/show_bug.cgi?id=46082) ://issues.apache.org/bugzilla/show_bug.cgi?id=46082 ） .

有没有办法`getLocalAddr()`按照记录执行，或者是否需要其他方法来查询服务器的 IP 地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:52:20.037

在我们的项目中，我们使用 JMX 来获取所有配置信息。它需要几个步骤，因为它就像在 server.xml 文件中向下导航这个链接有一些信息： http: [//oss.wxnet.org/mbeans.html](http://oss.wxnet.org/mbeans.html)

如果你想要的只是 IP，这可能是矫枉过正，但我​​想我会把它扔在那里。

```
 MBeanServer mbeanServer = ManagementFactory.getPlatformMBeanServer();
  Set<ObjectName> theConnectors = mbeanServer.queryNames(
      new ObjectName("Catalina:type=Connector,*"),
      null);
  if (theConnectors != null)
  {
      for (ObjectName nextConnectorName : theConnectors)
      {
        InetAddress theInetAddress = (InetAddress) mbeanServer.getAttribute(
          nextConnectorName,
          "address");
        if (theInetAddress != null)
        {
          ipAddress = theInetAddress.getHostAddress();
        }
        if (!StringUtil.isEmpty(ipAddress))
        {
          // found the IP address
          break;
        }
      }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:31:36.443

对于我的情况，解决方案是直接获取服务器的 IP 地址，而不是尝试通过 HttpServleRequest 获取本地地址。

我通过以下方式缓存了 IP 以在我的过滤器中使用：

```
private static final String serverIp;
static {
    String addressString = null;
    try
    {
        InetAddress address = InetAddress.getLocalHost();
        addressString = address.getHostAddress();
    } catch (Exception e)
    {
        logger.error("Exception while attempting to determine local ip address",e);
    }

    if (addressString != null) serverIp = addressString;
    else serverIp = "unknown";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-30T10:36:57.347

我最近有一个类似的问题（在最初的问题之后几年）并找到了这个问题和答案。就我而言，问题是`ServletRequest#getLocalAddr()`实现返回的是远程地址而不是本地地址。该问题是由 Tomcat v9.0.22 中的回归引起的。它已在 v9.0.23 中修复。在此处查看问题和答案：

[https://stackoverflow.com/a/57725039/9602527](https://stackoverflow.com/a/57725039/9602527)

# sql-server-2008 - 从数据集中删除重复值

> ID：14780209
> 
> 赞同：1
> 
> 时间：2013-02-08T19:48:07.680
> 
> 标签：sql-server-2008, tsql, sql-update

我正在使用以下数据集（表 1）开发 SSRS 报告。我按帐户和期间分组。我的目标是在一个组内获得总费用和预算。因为每个组的预算数据都是重复的，所以我不能对预算使用 SUM() 函数。如何删除重复项，使新数据集看起来像这样？（表2）请指教。感谢您的时间。

表格1

```
ID Account Period  Expense Budget
1  100     201301  20      100
2  100     201301  30      100
3  100     201302  10      150
4  100     201302  40      150
5  200     ................... 
```

表 2

```
ID Account Period  Expense Budget
1  100     201301  20      100
2  100     201301  30      NULL
3  100     201302  10      150
4  100     201302  40      NULL
5  200     ................... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:09:36.353

如果您真的想使重复预算为空，请尝试此更新命令

请检查 sqlfiddle [http://sqlfiddle.com/#!3/1e619/11](http://sqlfiddle.com/#!3/1e619/11)

```
Update table1 
set budget = null
where id in
(
      select aa.id from
        (
          select id,row_number() 
          over(partition by Budget order by Period) as rno
          from table1
        ) aa
     where rno > 1
);

select * from table1; 
```

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:01:19.283

如果您必须在 SQL 中进行分组，我会使用窗口函数。如果你可以在 SSRS 中做到这一点，只需添加一个“行分组父级”会更好。

对于 SQL，我会这样做：

```
declare @Temp table ( ID int identity, Account int, period int, expense int, budget int);

insert into @Temp values (100, 201301,  20, 100),(100, 201301,  30, 100),(100, 201302,  10, 150),(100, 201302,  40, 150)

select *
from @Temp

select 
    ID
,   Account
,   Period
,   Expense
,   case when (row_number() over(partition by Budget order by Period) = 1) then Budget end  as Budget-- only shows first occurrence of an order amount ordering by person
from @Temp 
```

# haskell - Haskell 无法构造无限类型：a0 = [a0]

> ID：14780214
> 
> 赞同：2
> 
> 时间：2013-02-08T19:48:32.220
> 
> 标签：haskell

我正在尝试使用 Haskell 解决 Project Euler 的第二个问题。问题相当简单——将偶数斐波那契数相加小于 4000000。（我是强迫症，我正在实施一个稍微修改过的函数——一个允许任意限制的函数）。

我的初始代码是：

```
euler2 limit (num1:num2) 
    |(num1>limit) = 0
    |((num2>limit) && ((mod num1 2) == 0)) = num1
    |(num2>limit) = 0
    |(((mod num1 2) == 0) && ((mod num2 2) == 0)) = num1+num2+(euler2 limit [num1+num2,num1+num2+num2])
    |((mod num1 2) == 0) = num1+(euler2 limit [num1+num2,num1+num2+num2])
    |((mod num2 2) == 0) = num2+(euler2 limit [num1+num2,num1+num2+num2])
    |otherwise = euler2 limit [num1+num2,num1+num2+num2]
euler2 limit [] = euler2 limit [1,2] 
```

这产生了以下错误：

```
Occurs check: cannot construct the infinite type: a0 = [a0]
In the second argument of `(>)', namely `limit'
In the first argument of `(&&)', namely `(num2 > limit)'
In the expression: ((num2 > limit) && ((mod num1 2) == 0)) 
```

现在通过一些试验和错误，我意识到它正在尝试将类型转换`num2`为列表，并且这个小变化：

```
euler2 limit (num1:num2:[]) | (num1 > limit) = 0 
```

解决问题。我的问题是为什么？发生了什么事，为什么它拒绝转换`num1`为`num2`Ints？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T20:51:36.597

的类型`(:)`是

```
(:) :: a -> [a] -> [a] 
```

如果您有模式匹配

```
euler2 limit (num1:num2) 
```

名称`num1`和`num2`绑定到构造函数的相应参数`(:)`（如果提供的参数是非空列表），因此`num2`是一个列表，其元素的类型为`num1`.

如果你匹配

```
(num1:num2:[]) 
```

那是隐式括起来的

```
(num1 : (num2 : [])) 
```

并且 now`num2 : []`与作为 top-level 的第二个参数的列表`(:)`匹配，并且匹配成功，绑定`num2`到第二个列表元素，如果提供的参数是一个恰好包含两个元素的列表。

# list - SharePoint 列表数据源给出 HTTP 401“未经授权”错误

> ID：14780220
> 
> 赞同：5
> 
> 时间：2013-02-08T19:49:05.857
> 
> 标签：list, sharepoint, ssrs-2008, reporting-services

我构建了一个使用 SharePoint 列表作为其数据源的报表。数据源设置为在 SSRS 中使用 Windows 身份验证（集成安全）。它在 SSRS/BIDS 中运行得很好，但是当部署到 Report Manager 环境时，我收到一个错误：

> 报告处理过程中发生错误。(rsProcessingAborted)
> 
> 数据集“ListData”的查询执行失败。(rsErrorExecutingCommand)
> 
> 访问指定的 SharePoint 列表时出错。连接字符串可能无效。验证连接字符串是否正确。(rsSPDataProviderError)
> 
> 请求失败，HTTP 状态为 401：未授权。

我已将报表对象和数据源从 BIDS 部署到环境中。我检查了属性以确认在报告管理器端也设置了集成安全性，所以我不确定为什么它没有将凭据正确传递给源。

有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-24T23:31:18.753

SSRS 的服务帐户对您没有帮助。最好有一个特定的服务帐户来运行 SSRS 服务，但这不是用来进行身份验证的。使用报告服务配置工具在服务器上设置执行帐户也很好，这有助于运行无人值守的报告，但这又不是您的问题。

Kerberos 是一种选择，是的，但是如果您还没有使用它，那么对于一个小问题来说这是一个很大的努力。

Sharepoint 列表数据源将仅接受集成的安全连接，因此您需要在数据源中将 Windows 用户作为凭据存储在报表服务器中。

我通常创建一个名为 Reportuser 的用户（例如 reportuser@[domain].com）。在您的域上创建此用户，确保它有权访问 SharePoint。

在报表数据源属性中的 BIDS/visual studio 中，在凭据选项卡下，单击“使用 Windows 身份验证（集成安全性）”旁边的单选按钮。将数据源上传到报表管理器网站。（你已经完成了这部分）。

导航到报告管理器网站，以及已上传数据源的属性。

在以“连接使用”开头的部分下：

选中“安全存储在报表服务器中的凭据”选项

像这样输入用户名和密码（其中域替换为您的网络域）：reportuser@domain.com 密码

重要部分：勾选“连接到数据源时用作 Windows 凭据”

测试连接并将工作 - 我刚刚测试过它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T13:11:53.160

检查这些情况：

1.  对数据源使用 Connect Using 部分中的第二个选项。检查附加的图像。 ![图片](../Images/73c0cbeb34f99ee4a6f9d2cf242ebcb6.png)

2.  检查您是否正确配置了所有 web.config 条目。您可以通过附加 w3wp 进程来跟踪此类错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T21:32:52.830

我遇到了同样的问题，发现我使用的帐户不正确，因为 SharePoint Designer 和 Visual Studio 使用相同的凭据。当我尝试部署我的报告时，我注意到它失败了，因为它使用了没有权限的用户。该用户不是我当前登录的用户。相反，它是我上次用来登录 SharePoint Designer 的那个。一旦我使用具有我想要的报告权限的用户登录到 SharePoint Designer，然后就能够使用 Visual Studio 正确登录到 SSRS。这两个程序之间的 Windows 凭据绑定在一起。

# grails - grails hasMany of jodatime Instants

> ID：14780224
> 
> 赞同：0
> 
> 时间：2013-02-08T19:49:10.527
> 
> 标签：grails, groovy, jodatime

如何解决[http://jira.grails.org/browse/GPJODATIME-28](http://jira.grails.org/browse/GPJODATIME-28)防止域类具有任何扩展类型的 hasMany 的问题？我正在考虑将整个应用程序切换为保留从 BigDecimal 派生的自定义 UserType 用于 posix 纪元日期。看起来就像是核桃的锤子。我可以采取另一种方法吗？

```
import org.joda.time.Instant    
class Foo {    
    Instant birthday 

    Set favoriteDays = []

    static hasMany = [
        favoriteDays : Instant
    ]

    static constraints = {
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:23:31.527

希望我没有在您的问题中遗漏任何内容，但我已经做过这样的事情：

创建一个名为的类`MyInstant`并在`hasMany`

```
import org.joda.time.Instant   
class MyInstant {
    Instant myInstant
    //anything else you might need
}

class Foo {
    MyInstant birthday

    Set favoriteDays = []
    static hasMany = [favoriteDays: MyInstant]
} 
```

我已经在以下方面进行了测试`FooController`：

```
import org.joda.time.Instant
class FooController {
   def save() {
      def fooInstance = new Foo(params)
        .addToFavoriteDays(new MyInstant(myInstant: new Instant()))
        .addToFavoriteDays(new MyInstant(myInstant: new Instant()))
        .addToFavoriteDays(new MyInstant(myInstant: new Instant()))

        if (!fooInstance.save(flush: true)) {
          render(view: "create", model: [fooInstance: fooInstance])
          return
        }

        flash.message = message(code: 'default.created.message', args: [message(code: 'foo.label', default: Foo'), fooInstance.id])
        redirect(action: "show", id: fooInstance.id)
    }
} 
```

一切都正确保存，`show`然后动作显示所有瞬间的新 Foo。我已经在 H2 和 MySql 上对此进行了测试。

# text - javafx 绘制线条和文本

> ID：14780228
> 
> 赞同：4
> 
> 时间：2013-02-08T19:49:32.183
> 
> 标签：text, line, javafx-2, lines

我在 JavaFx 中画线时遇到问题。我们正在制作一个模拟交通的应用程序 - 有 16 条街道，每条街道都有不同的颜色，具体取决于交通情况。有一张很简单的图：http: [//img546.imageshack.us/img546/9949/uliceu.jpg](http://img546.imageshack.us/img546/9949/uliceu.jpg)

我关于如何做到这一点的第一个想法是将街道画成线条并简单地改变它的颜色。但我不能把文字放在线上（我想要一个带有街道名称的文字）。所以我试图在 StackPane 上放一行和一个文本。然后我在 BorderPane 中心添加了 StackPanes ......但它没有用。似乎 StackPane 不尊重行的开始 x，开始 y ......这些行相互重叠。

该应用程序的主窗格是 BorderPane，我想将地图放在中心。它不需要动态调整大小，我们只有一张地图，因此可以静态定位。

我需要这样的东西：http: [//img834.imageshack.us/img834/1157/ulicac.jpg](http://img834.imageshack.us/img834/1157/ulicac.jpg) 但是街道需要相互连接......就像第一张照片一样

你对如何做到这一点有什么建议吗？任何提示将不胜感激:)

像那样：

```
Group gr = new Group();    
Text text = new Text("1st Street");  
text.setFill(Color.web("fabbff"));
Line line = new Line(0, 150, 200,150);   
line.setStrokeWidth(20); 
line.setStroke(Color.web("000000")); 
gr.getChildren().addAll(line, text);
group.getChildren().addAll(gr, //and every other street); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:12:49.767

默认情况下，您使用的[StackPane](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/StackPane.html)会将所有内容置于 StackPane 的中心，这不是您想要的。

不要使用 StackPane，而是使用普通的[Pane](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/Pane.html)（如果您需要对窗格进行 CSS 样式设置或在调整窗格大小时调整窗格中的控件），否则，请使用[Group](http://docs.oracle.com/javafx/2/api/javafx/scene/Group.html)。正如您所说，您正在绘制的地图不需要动态调整大小，那么也许只是一个 Group 就可以了。

项目在组或窗格的子列表中的放置顺序将决定项目的呈现顺序。首先添加到列表的项目将首先呈现，最后添加到列表的项目将呈现在最先添加的项目之上。因此，您首先将街道线添加到窗格或组中，然后在街道顶部添加[文本](http://docs.oracle.com/javafx/2/api/javafx/scene/text/Text.html)（或[标签）。](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Label.html)

另一种选择是使用直接绘制[Canvas](http://docs.oracle.com/javafx/2/api/javafx/scene/canvas/Canvas.html)，但对于您的应用程序，在窗格或组中使用场景图对象可能是更好的方法。

使用一个窗格/组，首先添加所有街道，然后是所有名称，或者一个窗格/组用于所有街道，另一个用于所有街道名称。单独的窗格可能会很好，因为您可以根据需要通过在街道名称组上设置可见标志来切换街道名称的可见性。不要将一个组用于一条街道及其名称，然后尝试将多个街道+街道名称组叠加在一起，否则在交叉路口，一些街道名称将被它们顶部的街道遮挡。

> 当我画一条线时，我可以指定位置 x，y，但我不能设置文本或标签的位置......或者我可以吗？

除了通过在创建线时为其提供坐标来定位线外，您还需要定位文本，使其显示在线的顶部。您可以使用[text.relocate(x, y)](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#relocate%28double,%20double%29)方法在给定位置定位文本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-11T21:35:01.280

我知道这是一个旧线程。但是，我有同样的问题：如何向线条添加标签，以防止绕线移动。这段代码对我有用：

```
line = new Line();
line.startXProperty().bind(source.layoutXProperty().add(source.getBoundsInParent().getWidth() / 2.0));
line.startYProperty().bind( source.layoutYProperty().add(source.getBoundsInParent().getHeight() / 2.0));

line.endXProperty().bind( target.layoutXProperty().add( target.getBoundsInParent().getWidth() / 2.0));
line.endYProperty().bind( target.layoutYProperty().add( target.getBoundsInParent().getHeight() / 2.0));

label.layoutXProperty().bind(line.endXProperty().subtract(line.endXProperty().subtract(line.startXProperty()).divide(2)));
label.layoutYProperty().bind(line.endYProperty().subtract(line.endYProperty().subtract(line.startYProperty()).divide(2)));

getChildren().addAll( line, label); 
```

# bash - XPath to list available tags non recursively (using xmllint in a shell script)

> ID：14780233
> 
> 赞同：3
> 
> 时间：2013-02-08T19:49:49.783
> 
> 标签：bash, list, xpath, tags

I'm trying to construct an XPath argument for use in the program xmllint (used within a Bash shell script) that will return a list of available tags within a tag (while not listing subtags).

Here's the sort of XML I have:

```
<functionInformation>
    <class>
        setup
    </class>
    <description>
        This is a natural language description of this function.
    </description>
    <prerequisiteFunctions>
        myFunction1
        myFunction2
    </prerequisiteFunctions>
    <prerequisitePrograms>
        myProgram1
        myProgram2
    </prerequisitePrograms>
</functionInformation> 
```

This XML is stored in the Bash variable functionInformation.

The output that I would like to have when using xmllint on this XML is the following:

```
class
description
prerequisiteFunctions
prerequisitePrograms 
```

I should note that I would like the tags returned in a non recursive way (I do not want all available tags or subtags listed).

I can access information in tags using xmllint in a way such as the following:

```
descriptionFunctionInformation="$(echo "${functionInformation}"\
                | xmllint --xpath '/functionInformation/description/text()' -\
                | xargs -i echo -n "{}")" 
```

Could you point me in the right direction on how I may build an XPath (or something similar) to return the information I need?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:12:22.960

您可以使用`xmlstarlet`：

```
xmlstarlet sel -t -m '/*/*' -v 'concat(name(.)," ")' < xmlfile 
```

# highcharts - Highcharts - line chart dataLabels on every other point?

> ID：14780234
> 
> 赞同：0
> 
> 时间：2013-02-08T19:49:52.170
> 
> 标签：highcharts

I have a Highcharts line graph that has dataLabels configured in the plotOptions. This is all working well and I have a nice label displayed over each point.

```
plotOptions: {
    line: {
        dataLabels: {
            enabled: true,
            formatter: function() {
            return '$' + Highcharts.numberFormat(Math.round(this.y),0,0,",");
            }
        }
    }
} 
```

However, is there a way to set an interval that determines how often the dataLabels appear over the points? I want to show every point in my graph, but due to space constraints, only show the dataLabel every 2 or 3 points.

**Edit:**

Difficulty level: My graph has multiple y-axes, uses datetime for the x-axis, and has irregular data. [http://jsfiddle.net/SQkMW/68/](http://jsfiddle.net/SQkMW/68/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T19:56:07.210

是的，如果点 x mod 2 为 0，则您可以只返回一个空白字符串，以便每隔 2 次显示一次，例如（[http://jsfiddle.net/HzYtV/](http://jsfiddle.net/HzYtV/)）：

```
formatter: function() {
    if(this.point.x % 2 == 0) return '';
    return this.y +'mm';
} 
```

对于日期时间轴，您必须创建一个变量并手动增加它[http://jsfiddle.net/SQkMW/69/](http://jsfiddle.net/SQkMW/69/)

# ios - How to speed up scrolling in UIScrollView?

> ID：14780236
> 
> 赞同：7
> 
> 时间：2013-02-08T19:50:01.173
> 
> 标签：ios, objective-c, uiscrollview, scroll, paging

I want to make paging/scrolling in UIScrollView to be faster, so when the user lefts his finger the next page will come faster than normal regardless the speed of the acceleration.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T20:22:09.307

调整`decelerationRate`你的 UIScrollView。

更多阅读：[UIScrollView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-08T20:46:54.737

如果我正确理解您的问题，您已将 ScrollView 设置为对齐页面（pagingEnabled = YES）。当用户抬起手指时，您希望它比当前更快地捕捉到最近的页面吗？

如果这就是您要完成的任务，我建议您这样做：

*   禁用 pagingEnabled (pagingEnabled = NO)。我们要自己做。
*   设置一些对象（可能是 ViewController）作为滚动视图的委托。
*   在 Scrollview 委托中，覆盖方法`scrollViewDidEndDragging:willDecelerate:`。您还需要覆盖该方法`scrollViewWillEndDragging:withVelocity:targetContentOffset:`，以便获得拖动的速度。
*   在 中`scrollViewDidEndDragging:willDecelerate:`，您可以计算拖动的方向（使用从其他方法获得的速度）和到最近页面的偏移量。`UIView`从那里，它就像使用具有所需持续时间的动画块设置滚动视图的 contentOffset 一样简单。例如：

`[UIView animateWithDuration:.25f animations:^{ scrollview.contentOffset = calculatedCGPoint; }];`

这应该会给你想要的效果。

# ios - Objective-C 中的 Base 62 转换

> ID：14780246
> 
> 赞同：24
> 
> 时间：2013-02-08T19:50:25.197
> 
> 标签：ios, objective-c, cocoa-touch

我花了太多时间试图为 Objective-C 找到 base 62 转换的实现。我确信这是一个糟糕的例子，必须有一种优雅、超高效的方法来做到这一点，但这有效，请编辑或回答以改进它！但我想帮助那些寻找这个的人有一些有用的东西。似乎没有针对 Objective-C 实现找到任何特定的东西。

```
@implementation Base62Converter

+(int)decode:(NSString*)string
{
    int num = 0;
    NSString * alphabet = @"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

    for (int i = 0, len = [string length]; i < len; i++)
    {
        NSRange range = [alphabet rangeOfString:[string substringWithRange:NSMakeRange(i,1)]];
        num = num * 62 + range.location;
    }

    return num;
}

+(NSString*)encode:(int)num
{
    NSString * alphabet = @"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
    NSMutableString * precursor = [NSMutableString stringWithCapacity:3];

    while (num > 0)
    {
        [precursor appendString:[alphabet substringWithRange:NSMakeRange( num % 62, 1 )]];
        num /= 62;
    }

    // http://stackoverflow.com/questions/6720191/reverse-nsstring-text
    NSMutableString *reversedString = [NSMutableString stringWithCapacity:[precursor length]];

    [precursor enumerateSubstringsInRange:NSMakeRange(0,[precursor length])
                             options:(NSStringEnumerationReverse |NSStringEnumerationByComposedCharacterSequences)
                          usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
                              [reversedString appendString:substring];
                          }];
    return reversedString;
}

@end 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-08T20:03:27.147

你的代码很好。如果有的话，让它更通用。这是任何基础的递归版本（相同的代码）：

```
#import <Foundation/Foundation.h>

@interface BaseConversion : NSObject
+(NSString*) formatNumber:(NSUInteger)n toBase:(NSUInteger)base;
+(NSString*) formatNumber:(NSUInteger)n usingAlphabet:(NSString*)alphabet;
@end

@implementation BaseConversion

// Uses the alphabet length as base.
+(NSString*) formatNumber:(NSUInteger)n usingAlphabet:(NSString*)alphabet
{
    NSUInteger base = [alphabet length];
    if (n<base){
        // direct conversion
        NSRange range = NSMakeRange(n, 1);
        return [alphabet substringWithRange:range];
    } else {
        return [NSString stringWithFormat:@"%@%@",

                // Get the number minus the last digit and do a recursive call.
                // Note that division between integer drops the decimals, eg: 769/10 = 76
                [self formatNumber:n/base usingAlphabet:alphabet],

                // Get the last digit and perform direct conversion with the result.
                [alphabet substringWithRange:NSMakeRange(n%base, 1)]];
    }
}

+(NSString*) formatNumber:(NSUInteger)n toBase:(NSUInteger)base 
{
    NSString *alphabet = @"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"; // 62 digits
    NSAssert([alphabet length]>=base,@"Not enough characters. Use base %ld or lower.",(unsigned long)[alphabet length]);
    return [self formatNumber:n usingAlphabet:[alphabet substringWithRange:NSMakeRange (0, base)]];
}

@end

int main(int argc, char *argv[]) {
    @autoreleasepool {
        NSLog(@"%@",[BaseConversion formatNumber:3735928559 toBase:16]); // deadbeef
        return EXIT_SUCCESS;
    }
} 
```

Swift 3 版本：[https ://gist.github.com/j4n0/056475333d0ddfe963ac5dc44fa53bf2](https://gist.github.com/j4n0/056475333d0ddfe963ac5dc44fa53bf2)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-08T22:06:20.930

`encode`您可以以不需要反转最终字符串的方式改进您的方法：

```
+ (NSString *)encode:(NSUInteger)num
{
    NSString *alphabet = @"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
    NSUInteger base = [alphabet length];
    NSMutableString *result = [NSMutableString string];
    while (num > 0) {
        NSString *digit = [alphabet substringWithRange:NSMakeRange(num % base, 1)];
        [result insertString:digit atIndex:0];
        num /= base;
    }
    return result;
} 
```

当然，这也可以推广到任意基础或字母，正如@Jano 在他的回答中所建议的那样。

请注意，此方法（以及您的原始`encode`方法）返回一个空字符串 for `num = 0`，因此您可能需要单独考虑这种情况（或仅替换`while (num > 0) { ... }`为`do { ... } while (num > 0)`.

* * *

为了提高效率，可以`NSString`完全避免所有中间对象，并使用纯 C 字符串：

```
+ (NSString *)encode:(NSUInteger)num
{
    static const char *alphabet = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
    NSUInteger base = 62;

    char result[20]; // sufficient room to encode 2^64 in Base-62
    char *p = result + sizeof(result);

    *--p = 0; // NULL termination
    while (num > 0) {
        *--p = alphabet[num % base];
        num /= base;
    }
    return [NSString stringWithUTF8String:p];
} 
```

# wix - WiX bootstrapper that only shows the package Dialogs or atleast one that doesn't require the license approval

> ID：14780250
> 
> 赞同：2
> 
> 时间：2013-02-08T19:50:30.287
> 
> 标签：wix

I have a project that I am creating an installer for. I have the msi created that will do the install but I also need to install some pre-reqs (.NET 4.0 and VSTO client tools or whatever they are called)

From what I can tell I need to use a bootstrapper and while it seems to work I really don't want the default dialogs that make me approve the license. I would like to skip that completely. (If I could hide the bootstrapper that would be fine but just having an "Install" button without the EULA would be ok).

Here is the xml I am currently using.

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
<WixVariable Id="WixStdbaLogo" Value="logo.png" />
<BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense">
</BootstrapperApplicationRef>

    <Chain>
        <!-- TODO: Define the list of chained packages. -->
  <PackageGroupRef Id="NetFx40Web"/>
        <MsiPackage SourceFile="TestRibbonLocationInstaller.msi" DisplayInternalUI="yes"  /> 
    </Chain>
</Bundle> 
```

So from what I can tell I need to basically create a custom bootstrap application for this that I then reference as the bootstrapperapplication. By doing this I will be able to better control the UI (Basically hide it).

Is this thought process correct?

# c# - 旋转并使两条线平行

> ID：14780251
> 
> 赞同：0
> 
> 时间：2013-02-08T19:50:32.280
> 
> 标签：c#, rotation, geometry, line, aforge

我有两条线段，点
Line1 = (x1,y1) , ( x2,y2) --- 更小
Line2 = (x3,y3) , (x4,y4) --- 更大

如何使 Line1（更小）旋转并使其平行于 Line2（更大）使用

1) (x1,y1) 作为旋转固定点或
2) (x2,y2) 作为旋转固定点或
3) 中心点作为旋转固定点

我正在使用 C#.NET。和 Aforge.NET 库。

![中心点作为旋转的固定点](../Images/03ebbcf258f3259ca591da0a031e53bc.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T03:36:25.677

下面描述的所有操作都可以表示为[仿射变换](http://en.wikipedia.org/wiki/Affine_transformation#Representation)矩阵。

1.  将所需的旋转中心移动到原点。
2.  计算旋转角度或直接计算旋转矩阵。见下文。
3.  应用该旋转，作为围绕原点的旋转。
4.  应用反向平移将旋转中心移回其原始位置。

您可以将这三个矩阵相乘以获得整个操作的单个矩阵。您甚至可以使用笔和纸来完成，并将结果硬编码到您的应用程序中。

至于如何计算[旋转矩阵](http://en.wikipedia.org/wiki/Rotation_matrix)：跨越线的两个向量的点积除以这些向量的长度，就是 cos(φ)，即它们之间夹角的余弦。正弦为 ±sqrt(1-cos(φ)²)。您只需要旋转矩阵中的这两个数字，因此无需根据性能实际计算角度。但是，获得正确的符号可能会很棘手，因此就简单的编程而言，您可能会更好地调用两次`atan2`、 差异以及随后调用`sin`and `cos`。

# mysql - Delphi 2010, Connect to mySQL and Firebird database without lib dlls

> ID：14780256
> 
> 赞同：2
> 
> 时间：2013-02-08T19:50:56.487
> 
> 标签：mysql, delphi-2010, firebird, delphi

I am writing a portable application that connects to both a firebird database and a mysql database. I am writing the application in Delphi 2010, and using dbExpress components to connect to both databases. SQLconnection component uses dbxmys.dll and libmysql.dll for the mysql database, and dbxfb.dll and fbclient.dll for the firebird database.

On my development computer I had to move the dll files into /windows/system/. I think this is because of the system paths, in order to find the correct files and connect. I tried this on another client machine, and the software could not connect because the dll files were not found. Because this is a portable application I do not want to include a sub directory of the application directory to include the dll files, however I do not think the a client machine can run the applicaiton without having mySQL and Firebird installed and the pathing set correctly.

Is there a better way to do this? I have concidered making a sub directory and forcing my application to look there, (since firebird and mySQL can be installed anywhere) if they were included I would know for sure were they were at on any computer my app is launched from. But I don't really want to take this approach.

What are my options as far as direct db connection, or solving the dll requirement problem, I am not an experienced software developer. Thanks in advance.

Update: The DLLs are now in the same directory with the exe, and the application launches fine. I Still do not want to use any dlls. I have found a few components that do not require dlls, but they also require payment, finding another free option would be ideal.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:59:56.653

您可以做的是将 .dll 作为压缩资源存储在主 .exe 中，然后将它们展开到本地文件夹（例如本地“应用程序数据”），然后从那里执行库。因此，您不需要将文件放在系统路径中（可能具有管理员权限），也不需要更改路径本身。

因此，您不需要将 .dll 与 .exe 一起复制，如果 .dll 已经可用，您的应用程序将使用它们。.exe 文件夹不会被库文件“污染”，您的软件仍然可以自行安装：如果您将 .exe 复制到另一台计算机，您仍然有 .dll，可以安装在其中一个隐藏的本地文件夹。

例如，我们的[SynProject 工具](http://synopse.info/fossil/wiki?name=SynProject)如何使用 Hunspell 库进行拼写检查。看到[这个答案](https://stackoverflow.com/questions/4237276/delphi-spell-checker/4238145#4238145)。

# ruby-on-rails - Rails route helper not calling to_param

> ID：14780259
> 
> 赞同：1
> 
> 时间：2013-02-08T19:51:12.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

I have a named route:

```
resources :groups do ... end 
```

Groups have an overriden to_param method using the [StringEx gem](https://github.com/rsl/stringex):

```
acts_as_url :name, sync_url: true

def to_param
  url
end 
```

And most of the time, I can call it by passing a group in:

```
group_path(g) 
```

But sometimes (and I haven't been able to find a clear link on the circumstances) it gives me this:

```
ActionController::RoutingError (No route matches {:action=>"show", :controller=>"groups", :id=>#<Group id: 121, name: "Example", kind: "ex" ... 
```

Really looks like it's not calling to_param, and is just calling to_s or inspect on the group.

Any idea what's going on? This is awfully frustrating.

# android - Unable to import InAppBillingService

> ID：14780260
> 
> 赞同：0
> 
> 时间：2013-02-08T19:51:13.283
> 
> 标签：android, libraries, in-app-billing

I am trying to implement in app billing in my app, but I just can not find the library. Acording to my SDK manager I have already installed the library, but I am not able to find it anywhere on my computer.

Based on information I found at the documentation pages I found out that it should be located at in the android SDK folder at /extras/google/google_play_services/ but I am not able to find it.

I know that you are supposed to import it through file > import > android > existing android code into Workspace and this is not the problem.

Have I not instaled it corectly or am I just not able to find the file on my Windows computer?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:32:10.693

Check `Window->Preferences...Android` screen. At the top is the root location of your SDK, open than folder and look for the `/extras/google/google_play_services/` in there. Then import as you suggest in your question.

# c++ - Receiving multiple loadFinished signals for a requested web page

> ID：14780261
> 
> 赞同：3
> 
> 时间：2013-02-08T19:51:16.943
> 
> 标签：c++, qt, webkit, qt5, qwebpage

I'm receiving multiple `loadFinished` signals when I attempt to load a `QWebPage` and I'm not sure what's causing the issue. There were a couple of other questions that seemed to allude to the same problem, but the solutions didn't work for me:

*   [QtWebPage - loadFinished() called multiple times](https://stackoverflow.com/questions/9966433/qtwebpage-loadfinished-called-multiple-times)
*   [Signal QWebPage::loadFinished(bool) returns twice?](https://stackoverflow.com/questions/8415289/signal-qwebpageloadfinishedbool-returns-twice)

In the first question, the answer was to connect signals to slots only once," but I already do that. The answer to the second question suggests that I should connect to the frame's `loadFinished` signal, but I simply don't get the necessary data when that is done.

I attempt to load multiple pages:

```
int main(int argc, char *argv[])
{
    QApplication app(argc, argv);    

    QList<QUrl> urls;
    urls.append(QUrl("http://www.useragentstring.com/pages/Chrome/"));
    urls.append(QUrl("http://www.useragentstring.com/pages/Firefox/"));
    urls.append(QUrl("http://www.useragentstring.com/pages/Opera/"));
    urls.append(QUrl("http://www.useragentstring.com/pages/Internet Explorer/"));
    urls.append(QUrl("http://www.useragentstring.com/pages/Safari/"));

    foreach(QUrl url, urls)
    {
        UA* ua = new UA();
        QWebPage* page = new QWebPage();
        //QObject::connect(page, SIGNAL(loadFinished(bool)), ua, SLOT(pageLoadFinished(bool)));
        QObject::connect(page->mainFrame(), SIGNAL(loadFinished(bool)), ua, SLOT(frameLoadFinished(bool)));
        // Load the page
        page->mainFrame()->load(url);
    }

    return app.exec();
} 
```

The class that processes the signals looks like this:

```
class UA:public QObject
{
    Q_OBJECT
private:
    int _numPageLoadSignals;
    int _numFrameLoadSignals
public:
    UA()
    {
        _numPageLoadSignals = 0;
        _numFrameLoadSignals = 0;
    }
    ~UA(){}
public slots:
    void pageLoadFinished(bool ok)
    {
        _numPageLoadSignals++;

        QWebPage * page = qobject_cast<QWebPage *>(sender());
        if(ok && page)
        {    
            qDebug() << _numPageLoadSignals << " loads " 
                << page->mainFrame()->documentElement().findAll("div#liste ul li a").count()
                << " elements found on: " << page->mainFrame()->requestedUrl().toString();
        }
    }

    void frameLoadFinished(bool ok)
    {
        _numFrameLoadSignals++;
        QWebFrame * frame = qobject_cast<QWebFrame *>(sender());
        if(ok && frame)
        {
            qDebug() << _numFrameLoadSignals << " loads " 
                <<  frame->documentElement().findAll("div#liste ul li a").count()
                << " elements found on: " << frame->requestedUrl().toString();
        }
    }
}; 
```

Here is the result of only connecting to the frame's `loadFinished` signal:

```
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Safari/"
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Chrome/"
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Opera/"
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Firefox/"
1  loads  241  elements found on:  "http://www.useragentstring.com/pages/Internet Explorer/" 
```

Here are the results when I connect to the page's `loadFinished` signal:

```
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Safari/"
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Chrome/"
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Firefox/"
1  loads  0  elements found on:  "http://www.useragentstring.com/pages/Internet Explorer/"
2  loads  576  elements found on:  "http://www.useragentstring.com/pages/Safari/"
2  loads  782  elements found on:  "http://www.useragentstring.com/pages/Chrome/"
2  loads  241  elements found on:  "http://www.useragentstring.com/pages/Internet Explorer/"
2  loads  1946  elements found on:  "http://www.useragentstring.com/pages/Firefox/"
3  loads  241  elements found on:  "http://www.useragentstring.com/pages/Internet Explorer/"
3  loads  1946  elements found on:  "http://www.useragentstring.com/pages/Firefox/"
3  loads  782  elements found on:  "http://www.useragentstring.com/pages/Chrome/"
1  loads  964  elements found on:  "http://www.useragentstring.com/pages/Opera/"
3  loads  576  elements found on:  "http://www.useragentstring.com/pages/Safari/" 
```

I don't understand the behavior, why sometimes I get relevant content and other times I don't. If I connect to the page's `loadFinished` signal, then I will eventually get the content but I don't know when it will actually happen. **How do I know when my page has actually finished loading?**

## Update

I'm assuming that most of my content will arrive in less than 3 seconds, so I've come up with a workaround: I set a timer event to signal the `UA::loadFinished` 3 seconds after the first `loadFinished` signal is received from the `QWebPage`. That's not very pretty, nor is it efficient, but it works for this situation.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-22T16:06:42.547

引用 QWebPage 文档：

> 最后，当页面内容完全加载时，会发出 loadFinished() 信号，与脚本执行或页面渲染无关。

关键是最后一句话。因此，以下线程中的一些人指出了我认为的问题。

[为什么 QWebView.loadFinished 在某些网站（例如 youtube）上会被多次调用？](https://stackoverflow.com/questions/8775152/why-is-qwebview-loadfinished-called-several-times-on-some-sites-e-g-youtube)

我一直在努力编写一个爬虫，该爬虫涉及在幕后使用 javascript 加载内容的页面。多个 loadFinished 是一个问题（我希望它在一切都解决后触发。），但我注意到基本问题是即使在最后一个 loadFinished 激活一个插槽之后，网页内容仍可能无法呈现/准备。

因此，我对 QWebPage 类的许多信号进行了试验，以查看它们中的任何一个是否在 loadFinished 信号之后始终被触发。

找到一个：repaintRequested(QRect)

我不知道这是否一直有效。但是，如果任何内容影响了网页的外观，我相信必须调用此信号才能假定页面完整。我既没有显示页面，也没有使用视图小部件，但信号始终被触发。唯一的问题是它被触发了很多次。（比loadFinished多得多），因此你需要检查mainFrame->requestedUrl()是否与mainFrame->url()相同，并且你感兴趣的内容的关键字是否存在。（特别是如果您像我一样重用 webPage。随后的请求更改了 requestedUrl，而之前加载的 mainFrame 内容仍然存在。那里有一些持久性）

减少要检查的信号数量的技巧可能是仅在从 QWebPage 接收到 loadFinished 信号（并可能检查额外条件）后才连接 repaintRequested。

这可能无法解决无限嵌套加载，因为不知道是否有任何信号是最后一个，但是如果您正在搜索内容，那么在加载该特定内容后必然会触发一个信号（我的意思是集成到 DOM :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-27T16:08:59.257

我解决了这个问题，指定死对象的内存缓存容量，换句话说，我只是使用以下方法禁用 QtWebKit 内存缓存：

```
QWebSettings::setObjectCacheCapacities(0, 0, 0); 
```

要了解更多信息，请点击此处的链接

[http://qt-project.org/doc/qt-4.8/qwebsettings.html#setObjectCacheCapacities](http://qt-project.org/doc/qt-4.8/qwebsettings.html#setObjectCacheCapacities)

# java - Transitive dependencies not resolved when dependency version defined in parents dependencyManagement

> ID：14780274
> 
> 赞同：12
> 
> 时间：2013-02-08T19:51:43.880
> 
> 标签：java, maven, maven-3

I've got a multi-module project with layout as below:

```
pom.xml
projA
  trunk
    pom.xml
    projA1
      pom.xml
    projA2
      pom.xml 
```

In the parent's pom I've defined `dependencyManagement` and `properties`:

```
<properties>
  <javaee-api.version>6.0</javaee-api.version>
  <log4j.version>1.2.11</log4j.version>
</properties>
...
<dependencyManagement>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>  
      <artifactId>junit</artifactId>
      <version>${junit.version}</version>
    </dependency>
    <dependency>
      <groupId>javax</groupId>  
      <artifactId>javaee-api</artifactId>
      <version>${javaee-api.version}</version>
    </dependency>
  </dependencies>
</dependencyManagement> 
```

pom.xml for projA2 contains:

```
<dependency>
  <groupId>log4j</groupId>
  <artifactId>log4j</artifactId>
</dependency> 
```

pom.xml for projA1 contains:

```
<dependency>
  <groupId>${project.groupId}</groupId>
  <artifactId>projA2</artifactId>
  <version>${project.version}</version>
</dependency> 
```

In projA1 I'm using log4j but the dependency is transitive (from projA2).

Now when I run `mvn dependency:tree -X` I get:

```
[WARNING] Invalid POM for mypackage:projA2:jar:1.0, transitive dependencies (if any) will not be available, enable debug logging for more details: Some problems were encountered while processing the POMs:
[ERROR] 'dependencies.dependency.version' for javax:javaee-api:jar is missing. @ line 37, column 15
[ERROR] 'dependencies.dependency.version' for log4j:log4j:jar is missing. @ line 56, column 15 
```

but just below this lines I get:

```
[DEBUG]   testArtifact: artifact=log4j:log4j:jar:1.2.11:compile
[DEBUG]   includeArtifact: artifact=log4j:log4j:jar:1.2.11:compile
[DEBUG]   startProcessChildren: artifact=log4j:log4j:jar:1.2.11:compile
[DEBUG]   endProcessChildren: artifact=log4j:log4j:jar:1.2.11:compile
[DEBUG]   testArtifact: artifact=javax:javaee-api:jar:6.0:provided
[DEBUG]   includeArtifact: artifact=javax:javaee-api:jar:6.0:provided
[DEBUG]   startProcessChildren: artifact=javax:javaee-api:jar:6.0:provided
[DEBUG]   endProcessChildren: artifact=javax:javaee-api:jar:6.0:provided 
```

The only solution is to specify log4j version (`<version>${project.version}</version>`) in projA2 pom.xml.

Question: what am I doing wrong :-(? I don't want to specify versions that are already defined in parent's `dependencyManagement` section.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-25T23:26:20.777

我遇到了同样的问题。在我的情况下，如果忘记更新本地存储库中的父 POM。试着做

```
mvn install 
```

对于父模块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-17T15:50:23.573

有类似的问题。从本地存储库中删除（手动）所有涉及的项目并稍后运行“mvn clean install”对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T20:07:43.803

我有一个类似的问题：我在我的 settings.xml 中定义了一个属性，并将它用于我的 pom 和我的父 pom 的依赖项中的 systemPaths。忽略“无效”包会导致编译错误，因为在类路径中缺少用作传递依赖项的包。

我发现（转移到你的问题），如果我用“mvn -Dlog4j.version=2.1.11”调用 maven，警告就会消失，编译错误也会消失。对我来说，这不是令人满意的解决方案，但它解决了隐形传递依赖的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:12:16.130

```
<dependency>
  <groupId>log4j</groupId>
  <artifactId>log4j</artifactId>
</dependency> 
```

需要 in`/projA/trunk/pom.xml`而不是`/projA/trunk/projA2/pom.xml`.

当然，如果您希望它在您的所有项目中都可用，而不仅仅是 projA，它必须在`pom.xml`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-05T08:38:32.723

我遇到了与 OP 完全相同的问题。事实证明这是一个 maven 错误，因为更新到最新的 maven 版本（写作时为 3.3.3）解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-28T12:16:42.003

它可能是存储库问题搜索您丢失的依赖项找出正确的存储库并像这样添加到您的 pom：

```
<repositories>
        <repository>
            <id>jboss-3rd-party-releases</id>
            <url>https://repository.jboss.org/nexus/content/repositories/thirdparty-releases/</url>
        </repository>
    </repositories> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-11T18:37:08.720

添加：

```
<dependency>
  <groupId>log4j</groupId>
  <artifactId>log4j</artifactId>
  <version>${log4j.version}</version>
</dependency> 
```

到`dependencyManagement`父 POM 的部分（就像你对 JUnit 所做的那样）。任何需要 log4j 的孩子都可以指定一个依赖项：

```
<dependency>
  <groupId>log4j</groupId>
  <artifactId>log4j</artifactId>
</dependency> 
```

没有版本，它会工作，因为版本将从父级中提取。

# regex - 带有反向引用的正则表达式在 chomsky 层次结构中属于哪里（它们是否完全属于那里）？

> ID：14780277
> 
> 赞同：3
> 
> 时间：2013-02-08T19:51:55.990
> 
> 标签：regex

我在这里有些困惑 - 带有反向引用的 RegEx 显然*不是*正则表达式，因为它们可以例如用于描述上下文相关的复制语言（任何单词 w 的“ww”）。然而与此同时，它们仍然不能用来描述像 HTML 这样的上下文无关语言（甚至只是匹配括号）——至少我不知道在 POSIX 正则表达式中这样的东西会是什么样子。

话虽这么说 - 这种“*正则表达式*”是否属于乔姆斯基层次结构中的任何地方，或者它们是否是某些令人厌恶的科学怪人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:10:24.117

他们真的不适合。

带有反向引用的正则表达式可以匹配一些非上下文无关语言（例如`(.*)\1`），但也不能匹配所有上下文无关语言（典型示例是嵌套括号）。

[这是 CSTheory StackExchange 上的相关帖子](https://cstheory.stackexchange.com/questions/1047/where-do-most-regex-implementations-fall-on-the-complexity-scale)，其中包含更多详细信息。

另请注意，某些实现（例如 .NET 或 Perl）比反向引用更进一步，并且*可以*匹配嵌套括号。

# c++ - 将一个对象添加到另一个对象 C++

> ID：14780278
> 
> 赞同：0
> 
> 时间：2013-02-08T19:51:58.743
> 
> 标签：c++, aggregation

我试图简单地将一个对象添加到一个类中的另一个对象，例如将播放器添加到工厂。

对于我的工厂.h

```
class Factory
{
public:

    Factory(void);
    ~Factory(void);
    void addMaze(Maze maze);
    void addPlayer(Player player);
    std::string getSessionTime();
    std::string setSessionTime(std::string time);

    private:

    int m_ID;
    Player m_player;
    Maze m_maze ;
    std::string m_SessionTime;
    std::string m_filePath [50];

    }; 
```

然后在我的工厂课上我有：

```
void Factory::addPlayer(Player player)
{
    m_player.add(player); //This is what I feel like I want to do
} 
```

所以，我正在尝试将一个玩家添加到我的玩家列表中，但这不会做吗？我错过了一些非常明显的东西吗？如果有人可以帮助或指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T19:55:18.887

`Player m_player;`声明类型的数据成员`Player`，而不是玩家列表。如果您想要一个列表，请拥有一个成员`std::list<Player>`或更常见的`std::vector<Player>`.

你的功能可能看起来像

```
void Factory::addPlayer(const Player& player)
{
    m_players.push_back(player);
} 
```

# sql - Microsoft Access 找不到字段“|1”

> ID：14780280
> 
> 赞同：3
> 
> 时间：2013-02-08T19:52:07.953
> 
> 标签：sql, ms-access, vba, runtime-error

在 Access 中通过 VBA 运行查询时，我不断收到运行时错误“2465”。

错误：Microsoft Access 找不到表达式中引用的字段“|1”

我似乎无法找到发生此问题的位置。下面是我目前用来重新查询表单的 VBA 代码。

```
Dim Test As String
Test = "*" & Combo161.Value

Dim strSQL As String
Dim strWhere As String
strWhere = (Chr(34) + Test + (Chr(34)))

'MsgBox (strWhere)

strSQL = "SELECT * FROM Test_Query WHERE TestID " & strWhere

'MsgBox (strSQL)
[Form_Test (subform)].RecordSource = strSQL
[Form_Test (subform)].Requery 
```

具有文本的`TestID`字段格式，而不是数字。这有关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-03-09T23:20:58.547

我刚刚修复了这个错误。我引用了子表单的源对象，而不是表单属性中给出的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-12T23:06:29.430

我有同样的错误。我缺少的是字符串周围的双引号。这个错误有点误导。检查语法等，您会发现问题与逗号或双引号等有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T19:57:12.563

尝试：

```
Dim Test As String
Test = "*" & Combo161.Value

Dim strSQL As String
Dim strWhere As String
strWhere = (Chr(34) & Test & (Chr(34)))

'MsgBox (strWhere)

strSQL = "SELECT * FROM Test_Query WHERE TestID Like " & strWhere

'To test
'Debug.print strSQL 
```

如果这是一个子表单，那么：

```
Me.[Form_Test (subform)].Form.RecordSource = strSQL
''Not needed when changing record source
''Me.[Form_Test (subform)].Form.Requery 
```

您没有等号 / Like 并且 VBA 中的连接符是 &，而不是 +，使用 + 会导致空值问题，但在这种情况下，我认为问题是缺少 Like，即

```
TestID Like "*something" 
```

您可以使用组合和链接字段控制子表单的内容：

![组合链接](../Images/10f18419ce57ea8da7326c046a6a05dc.png)

# php - 用新图像替换 html 字符串中的现有图像标签

> ID：14780281
> 
> 赞同：1
> 
> 时间：2013-02-08T19:52:11.040
> 
> 标签：php, domdocument

我正在尝试用带有 id 属性的新图像标签替换现有的图像标签。

我有 DB 像返回的 htmlstring

```
<div>
<p>random p</p>
<img src='a.jpb'/>
</div>
<span>random span</span>
<img src='b.jpb'/>

more... 
```

我想用 id 属性替换图像的“某些”，例如：

更换

```
<img src='a.jpb'/> 
```

到

```
<img id='123' src='a.jpb'/> 
```

我使用 domdocument

```
$doc = new DOMDocument();

          $doc->loadHTML($html);

          $imageTags = $doc->getElementsByTagName('img');

          $imgSource=$this->DBimgSource;
          $id=$this->DBID;

          foreach($imageTags as $tag) {
              //getting all the images tags from $html string
              $source=$tag->getAttribute('src');

           if(!empty($imgSource) && !empty($source)){
             if(in_array($source, $imgSource)){

              $id=array_search($source,$imgSource);
              $imgID=$id;
              $tag->setAttribute('id',$imgID);
              $newImageTag=$doc->saveXML($tag);

              //I am not sure how to replace existing image tags within $html with the $newImageTag                

              }
            }
          } 
```

任何想法如何做到这一点？反正我也想不出来。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:19:02.900

这对我有用：

```
$html = "<html><body><img src='foo.jpg'/></body></html>";
$doc = new DOMDocument();
$doc->loadHTML($html);
$img = $doc->getElementsByTagName('img')->item(0);
$img->setAttribute('id', 'newId');
$html = $doc->saveHTML();
echo $html; 
```

输出是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><img src="foo.jpg" id="newId"></body></html> 
```

# javascript - 如何编写信号量检查两种不同的状态

> ID：14780290
> 
> 赞同：0
> 
> 时间：2013-02-08T19:52:40.140
> 
> 标签：javascript, jquery, node.js, text-to-speech, semaphore

我正在使用文本到语音服务 (TTS) 从 Yelp API 读取结果。我遇到了时间问题：

1.  如果我太快调用 TTS 函数，语音会自行中断。

我的想法是编写一个信号量来检查音频是否正在播放，并且只有在完成后才将下一个命令变为红色。很遗憾：

1.  如果我等到音频没有播放（audio.paused == true），程序挂起/不会跳出while循环。

有没有人对如何解决第一个问题而不遇到第二个问题有任何想法？

```
//check if command isn't already queued, and then add command to the queue
function voiceSynth (string, name) { 
if(voiceQueue.indexOf(string)== -1){
    voiceQueue.push(string) 
    voiceQueue.push(name) //used to keep track of the current item being read
}       
//Iterate over items in the queue
while (voiceQueue.length > 1){
    if (voiceBusy == false && audio.paused == true) {   
        voiceCall.call(undefined, voiceQueue.shift(),voiceQueue.shift())
    }
    }
}
//ajax call to the TTS service
function voiceCall (string, name) {
    voiceBusy = true
    console.log('synth called on ' + string)
    $.ajax('read/?string=' + string + '&speed=' + speed, {
        type: 'GET',
        success: function(src) {
            audio.setAttribute('src', src)  
            audio.play()
            voiceBusy = false
            voiceCursor = name  
        },
        error: function(xhr, ajaxOptions, thrownError) {
            console.log(xhr)
            console.log(ajaxOptions)
            console.log(thrownError)
            }
    })
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T21:14:11.173

信号量用于多线程/IPC 环境。使用 javascript 引擎，您没有这个。您正在尝试在 Javascript 中进行*轮询*，这在其单线程环境中不起作用，除非您使用 setTimeout 或 setInteval。

在您的设置中，您似乎有三种类型的事件：一个新的语音任务出现（并且应该被排队），一个 Yelp AJAX 调用返回，以及音频播放结束。您似乎已经处理了前两个事件，并且您正试图弄清楚如何处理音频结束事件。

我会将所有队列*服务*代码移动到它自己的函数中，然后只要发生有趣的事件就调用它。让队列服务代码弄清楚要做什么。其余代码只需要处理事件并跟踪状态。像这样的东西可能会起作用：

```
 var ajaxOutstanding = false;
    var audioOutstanding = false;

    function voiceSynth(string, name) {
       if(voiceQueue.indexOf(string)== -1){
          voiceQueue.push(string) 
          voiceQueue.push(name) //used to keep track of the current item being read
       }
       serviceQueue();
    }

    //ajax call to the TTS service
    function voiceCall (string, name) {
        console.log('synth called on ' + string)
        $.ajax('read/?string=' + string + '&speed=' + speed, {
            type: 'GET',
            success: function(src) {
                ajaxOutstanding = false;
                audio.setAttribute('src', src);
                audioOutstanding = true;
                audio.play();
                voiceCursor = name;
                serviceQueue();
            },
            error: function(xhr, ajaxOptions, thrownError) {
                ajaxOutstanding = false;
                console.log(xhr);
                console.log(ajaxOptions);
                console.log(thrownError);
                serviceQueue();
            }
        });
    }

    function handleAudioEnded() {
        audioOutstanding = false;
        serviceQueue();
    }

    audio.addEventListener('ended', handleAudioEnded);

    function serviceQueue() {
        if (voiceQueue.length > 1 && !ajaxOustanding && !audioOutstanding) {
        voiceCall.call(undefined, voiceQueue.shift(),voiceQueue.shift());
        }
    } 
```

顺便一提，

```
 voiceCall.call(undefined, voiceQueue.shift(),voiceQueue.shift()); 
```

是相同的

```
 voiceCall(voiceQueue.shift(), voiceQueue.shift()); 
```

并且更清晰。

# python - 将数据发送到服务器烧瓶 html

> ID：14780291
> 
> 赞同：2
> 
> 时间：2013-02-08T19:52:43.627
> 
> 标签：python, html, flask

我正在尝试创建一个将数据发送到服务器的简单复选框，这是我的 html 代码。

```
<form action="." method="POST">
<div class="checksheet">

    <input id="XML Parser" class="checkbox" type="checkbox"/>XML Parser
    <input id="Feed Parser" class="checkbox" type="checkbox"/>Feed Parser
    <input id="Text Parser" class="checkbox" type="checkbox"/>Text Parser
    <input id="Case Normalization" class="checkbox" type="checkbox"/>Case Normalization
    <input id="Stemmer" class="checkbox" type="checkbox"/>  Stemmer

</div>

<div class="submit"><input type="submit"  value="Send" name="raw_text"></div>
</form> 
```

我想要做的与这里提出的问题非常相似：[将数据从文本框发送到 Flask？](https://stackoverflow.com/questions/12277933/send-data-from-a-textbox-into-flask?rq=1) 但除了文本框..我有复选框。

但我得到这个错误：

```
Not Found

The requested URL was not found on the server.

If you entered the URL manually please check your spelling and try again. 
```

我的服务器端代码（在烧瓶中）是：

```
@app.route('/raw_text.html')
def home ():
    file = "sample.xml"
    contents = open(file).read()

    contents = contents.decode('utf-8')
    return render_template('raw_text.html',  contents=contents,file=file)

@app.route('/raw_text.html',methods=['POST'])
def get_data():
    print "REQUEST ",request.form()
    data = request.form['raw_text']
    print data
    return "Processed" 
```

有什么建议么。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:57:29.240

一些东西：

1.  您的复选框元素需要一个`name`属性，这是将数据发送到后端时使用的属性。每个相互关联的复选框都需要具有相同的`name`.

2.  您的`action`属性需要指向一个 URL。如果您将其发布到与表单相同的页面，则可以删除该属性。

3.  `ID`'s 不能包含空格。

4.  为了便于访问，复选框需要`<label>`s，

# java - JOOQ - How to get the tbl_name.col_name of a TableField?

> ID：14780293
> 
> 赞同：3
> 
> 时间：2013-02-08T19:52:54.320
> 
> 标签：java, mysql, sql, jooq

How to get the table + column qualifier name from the [**TableField**](http://www.jooq.org/javadoc/latest/org/jooq/class-use/TableField.html).

I have tried the following methods

```
USER.ID.toString(); // "db.user.id"
USER.ID.getName();  // "id" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T08:43:27.603

正如您所注意到的，该`TableField.toString()`方法呈现完全限定的列。你有两个选择：

### 自己做：

```
String sql = USER.getName() + "." + USER.ID.getName(); 
```

### 使用`Configuration`配置为省略模式名称的 a：

```
Settings settings = new Settings();
settings.setRenderSchema(false);                    // Omit schema rendering
settings.setRenderNameStyle(RenderNameStyle.AS_IS); // Omit escaping names
DSLContext = DSL.using(SQLDialect.MYSQL, settings);
String sql = ctx.render(USER.ID); 
```

# ios - ios上传文件到亚马逊s3

> ID：14780297
> 
> 赞同：0
> 
> 时间：2013-02-08T19:53:09.650
> 
> 标签：ios, amazon-s3

我正在开发一个需要能够将文件上传到亚马逊 s3 的 ios 应用程序，但我遇到了一些问题。该函数设法在 s3 存储桶中创建正确的密钥或路径，但文件本身不会上传到其中。以下是我尝试过的其中一个选项的代码

```
if (self.s3 == nil) {
        self.s3 = [[AmazonS3Client alloc] initWithAccessKey:[Config getS3Key] withSecretKey:[Config getS3Secret]] ;

    }
  [self performSelectorInBackground:@selector(processBackgroundThreadUploadInBackground:)
                           withObject:params];

}

- (void)processBackgroundThreadUploadInBackground:(NSMutableDictionary *)params
{

    S3PutObjectRequest *por = [[S3PutObjectRequest alloc] initWithKey:@"staging/videos/" inBucket:@"aaa.aaaaa.com"];
    por.contentType = @"video/mp4";
    por.data        = [NSData dataWithContentsOfURL:[NSURL URLWithString:[params valueForKey:@"takeurl"]]];

//    por.contentType = @"image/png";
//    por.data        = [params valueForKey:@"takeimage"];

    S3PutObjectResponse *putObjectResponse = [self.s3 putObject:por];
    [self performSelectorOnMainThread:@selector(showCheckErrorMessage:)
                           withObject:putObjectResponse.error
                        waitUntilDone:NO];
} 
```

这会在 s3 上的存储桶中创建关键路径 staging/videos/ 但文件不存在。我也用图像文件试过这个。我已检查以确保我要推高的数据不为零。我从服务器得到的 xml 响应说内容长度为 0。我还尝试了来自 s3 sdk 的多部分方法，结果相同。谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-09T17:21:48.733

我显然很晚才做出这个回应，但以防万一其他人将来遇到这个问题，你的请求结构是错误的。

通过做：

```
S3PutObjectRequest *por = [[S3PutObjectRequest alloc] initWithKey:@"staging/videos/" inBucket:@"aaa.aaaaa.com"]; 
```

在您的密钥末尾带有反斜杠，您正在创建一个文件夹，而不是一个文件。您需要以包含后缀 ex 的文件名结束您的密钥`@"staging/videos/video.mp4"`。

# windows - m12-073 更新导致 IIS 服务不可用

> ID：14780298
> 
> 赞同：0
> 
> 时间：2013-02-08T19:53:13.177
> 
> 标签：windows, iis

我是一名开发人员。我已经使用 Visual Studio 2010 创建了一个网站和服务。我正在运行一台完全修补的 Windows 7 计算机。

我需要能够使用除我的开发计算机以外的设备访问 Web 服务器来调试它。我安装了 IIS 7.5 并将一切配置为正常工作。当另一台设备在这台开发计算机上访问网站时，我能够进行调试。

那是昨天。今天早上我启动了我的电脑，并且有来自 Microsoft 的更新。m12-073。它提到了IIS。

当我在进行更新后今天开始从事这个项目时，我在任何计算机或设备上都出现服务不可用 (503) 错误，而不是开发计算机。开发计算机仍然可以正常工作。

昨天和今天的唯一变化是更新和重启。

我尝试卸载更新并没有解决它。我在更新之前尝试了系统还原，但没有奏效。

我现在很难过。它昨天有效，今天无效，只有更新是变化。

帮助？

# python - KeyError: 'PATH_INFO' 使用 Pydev 和 Google App Engine 时

> ID：14780302
> 
> 赞同：2
> 
> 时间：2013-02-08T19:53:22.473
> 
> 标签：python, eclipse, google-app-engine, pydev

我刚刚在 Ubuntu 12.10 下使用 Eclipse 开始使用 GAE，当我尝试运行示例应用程序时，我遇到了一个我无法解决的错误：

```
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app

class MainPage(webapp.RequestHandler):

    def get(self):
        self.response.headers['Content-Type'] = 'text/plain'
        self.response.out.write('Hello, webapp World!')

application = webapp.WSGIApplication([('/', MainPage)], debug=True)

def main():
    run_wsgi_app(application)

if __name__ == "__main__":
    main() 
```

我收到了这个错误：

```
 Traceback (most recent call last):
  File "/home/mordrec/workspace/helloworld/helloworld.py", line 20, in <module>
    main()
  File "/home/mordrec/workspace/helloworld/helloworld.py", line 17, in main
    run_wsgi_app(application)
  File "/opt/google_appengine/google/appengine/ext/webapp/util.py", line 98, in run_wsgi_app
    run_bare_wsgi_app(add_wsgi_middleware(application))
  File "/opt/google_appengine/google/appengine/ext/webapp/util.py", line 116, in run_bare_wsgi_app
    result = application(env, _start_response)
  File "/opt/google_appengine/google/appengine/ext/webapp/_webapp25.py", line 688, in __call__
    match = regexp.match(request.path)
  File "/opt/google_appengine/lib/webob_1_1_1/webob/request.py", line 303, in path
    urllib.quote(self.path_info, PATH_SAFE))
  File "/opt/google_appengine/lib/webob_1_1_1/webob/descriptors.py", line 23, in fget
    return req.environ[key]
KeyError: 'PATH_INFO' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T00:54:16.140

一两个小时前，我遇到了完全相同的问题（但在 Mac 上）。以下说明中的步骤#5（“在本地部署”）对我有用。

您可以或多或少地遵循这些相同的说明来进行调试（只需执行“调试为”）。

[http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/](http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/)

要在本地运行它，右键单击 helloworld.py，选择“Run As” -> “Run Configuration”，新建一个“PyDev Google App Run”。

1.  在 Main 选项卡 -> Main 模块中，手动键入“dev_appserver.py”的目录路径。“浏览”按钮无法帮助您，请手动输入。 ![在此处输入图像描述](../Images/b0259ee1b46035053cea6fcb105e71f5.png)

2.  在参数选项卡 -> 程序参数中，输入“${project_loc}/src”。 ![在此处输入图像描述](../Images/ada9652e27e067e72d9752dd492455ed.png)

3.  运行。默认情况下，它将部署到 localhost:8080。 ![在此处输入图像描述](../Images/7097feec49833b6c0146b3ad497744e6.png)

4.  完毕。 ![在此处输入图像描述](../Images/f57697526f62040b93d97d9349dd82dd.png)

# sql-server - 如何在行的列中插入当前日期

> ID：14780303
> 
> 赞同：5
> 
> 时间：2013-02-08T19:53:25.343
> 
> 标签：sql-server, database-schema, sql-server-2008

如何在 MS SqlServer Mgm Studio 的“编辑数据”视图中将当前日期插入行列？我想获得`GetDate()`函数调用的等效值。

这是一张我希望能澄清问题的图片：

![澄清问题的图像](../Images/a7789c93a5780af3eba9de6c8baaabee.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:10:13.037

您无法键入函数，因此请键入日期或以下解决方案之一

*   `GetDate()`在表上的 modifiedddate 列上创建一个默认值。
*   创建一个更新触发器，当行中的数据更改时更新 modifyddate 列。

# asp.net-mvc - iTextsharp：循环添加图像和文本（IE、Firefox、Chrome）

> ID：14780304
> 
> 赞同：1
> 
> 时间：2013-02-08T19:53:27.153
> 
> 标签：asp.net-mvc, image, loops, text, itextsharp

我有一个带有生成 pdf 文件的按钮的表单。该文件循环遍历图像和文本数组，并将每个图像和文本插入到文档的绝对位置。我可以添加图像，没有文字，效果很好。我也可以添加没有图像的文本，并且一切正常。但是，当我同时添加两者时，我得到的错误是

```
there was an error processing the document. 
```

这是代码

```
[HttpPost]
    public FileStreamResult ff(MyModel model)
    {
        MemoryStream workStream = new MemoryStream();
        Document doc = new Document();
        doc.SetMargins(50, 25, 25, 30);
        PdfWriter.GetInstance(doc, workStream).CloseStream = false;
        PdfWriter writer = PdfWriter.GetInstance(doc, workStream);
        writer.CloseStream = false;
        doc.Open();
        PdfContentByte cb = writer.DirectContent;
        string path = "";
        Image Img;

        int num = 0;
        float imageSize = 160f, margin = 5f, position = 600;
        ColumnText ct;

        foreach (var item in model)
        {

            /*ct = new ColumnText(cb);
            myText = new Phrase(new Chunk(numbering[num] + " " + item.Caption, FontFactory.GetFont(FontFactory.TIMES, 9, Font.ITALIC)));
            ct.SetSimpleColumn(myText, doc.LeftMargin + margin, position + 5f, imageSize, 2, 15, Element.ALIGN_LEFT);
            ct.Go();
            x += 10;
            y += 12;*/

   /////The code above and the code below(withing the loop) do not work when they are together but work well when they are not together

            path = item.path;
            Img = Image.GetInstance(path);
            Img.ScaleToFit(imageSize, imageSize);
            Img.SetAbsolutePosition(doc.LeftMargin + margin, position);
            Img.Border = Rectangle.TOP_BORDER | Rectangle.RIGHT_BORDER | Rectangle.BOTTOM_BORDER | Rectangle.LEFT_BORDER;
            Img.BorderWidth = 1f;
            doc.Add(Img);

            num++;
            position -= imageSize;
        }

        document.Close();
        byte[] byteInfo = workStream.ToArray();
        workStream.Write(byteInfo, 0, byteInfo.Length);
        workStream.Position = 0;

        return new FileStreamResult(workStream, "application/pdf");

    } 
```

Internet explorer 和 firefox 显示错误`There was an error processing the page. There was an error reading this document(18)`。

Chrome 确实显示了页面，但是图片的排列是错误的。第二张图片首先出现，最后一张图片未能显示，但边框显示为最后一张图片（如空画布）

请问我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T09:21:53.803

如果设置结果的文件名有帮助吗？

```
var result = new FileStreamResult(workStream, "application/pdf");
result.FileDownloadName = "test.pdf";
return result; 
```

# highcharts - 使用 Navigator 的主从图表

> ID：14780305
> 
> 赞同：0
> 
> 时间：2013-02-08T19:53:31.920
> 
> 标签：highcharts, highstock, navigator

我可以在 Highcharts 主从图表中使用 Highstock 图表中的导航器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T13:16:53.097

要添加 Navigator，它需要 Highstock 许可证。将主从图表与导航器一起使用的目的是什么？这是类似的功能。但是，这里有一个例子：http: [//jsfiddle.net/f7pmW/](http://jsfiddle.net/f7pmW/)

放入 createDetail() 函数：

```
new Highcharts.StockChart(...); 
```

# sql - 加入 100 个表

> ID：14780307
> 
> 赞同：11
> 
> 时间：2013-02-08T19:53:35.217
> 
> 标签：sql, sql-server, sql-server-2008, join, normalization

假设我有一个主表，其中有 100 列引用（作为外键）到大约 100 个表（包含主键）。

整个信息包需要加入这 100 个表。而且加入这么多表肯定是性能问题。希望我们可以预期任何用户都希望在查询中请求一组包含不超过 5-7 个表（在这 100 个表中）的值的数据，这些表将条件（在查询的 WHERE 部分）置于大约 3-4 张桌子（在这 100 张桌子中）。不同的查询具有不同的表组合，用于生成查询的“SELECT”部分并将条件放在“WHERE”中。但是，同样，每个 SELECT 将需要大约 5-7 个表，每个 WHERE 将需要大约 3-4 个表（当然，用于生成 SELECT 的表列表可能与用于将条件放入 WHERE 的表列表重叠）。

我可以编写一个带有底层代码的 VIEW 加入所有这 100 个表。然后我可以将上面提到的 SQL 查询写入这个 VIEW。但是在这种情况下，如何指示 SQL Server（尽管代码中明确说明要连接所有这 100 个表）应该只连接大约 11 个表（11 个表足以连接以产生 SELECT结果并考虑 WHERE 条件）。

另一种方法可能是创建一个转换以下“假”代码的“功能”

```
SELECT field1, field2, field3 FROM TheFakeTable WHERE field1=12 and field4=5 
```

进入以下“真实”代码：

```
SELECT T1.field1, T2.field2, T3.field3 FROM TheRealMainTable 
join T1 on ....
join T2 on ....
join T3 on ....
join T4 on ....
WHERE T1.field1=12 and T4.field4=5 
```

从语法的角度来看，即使允许这种“TheFakeTable-mechanism”与真实表格和结构的任何混合组合也不是问题。这里真正的问题是如何在技术上实现这个“特性”。我可以创建一个将“假”代码作为输入并生成“真实”代码的函数。但这并不方便，因为它需要在出现“TheFakeTable-mechanism”的任何地方使用动态 SQL 工具。一个梦幻般的解决方案是在我的 Management Studio 中扩展 SQL 语言的语法，以允许编写这样的假代码，然后在发送到服务器之前自动将此代码转换为真实代码。

我的问题是：

1.  是否可以指示 SQl 服务器在上述 VIEW 中仅加入 11 个表而不是 100 个表（或成为天才）？
2.  如果我决定创建这个“TheFakeTable-mechanism”功能，那么在技术上实现这个功能的最佳形式是什么？

感谢大家的每一条评论！

PS 100 个表的结构源于我在这里提出的以下问题： [Normalizing anextreme big table](https://stackoverflow.com/questions/14758912/normalizing-an-extremely-big-table)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-08T20:34:29.297

SQL Server 优化器确实包含删除冗余连接的逻辑，但存在一些限制，并且连接必须可[证明是冗余](http://msmvps.com/blogs/robfarley/archive/2008/11/09/join-simplification-in-sql-server.aspx)的。总而言之，连接可以产生四种效果：

1.  它可以添加额外的列（来自连接表）
2.  它可以添加额外的行（连接的表可能会多次匹配源行）
3.  它可以删除行（连接的表可能没有匹配）
4.  它可以引入`NULL`s（对于 a`RIGHT`或`FULL JOIN`）

要成功删除冗余连接，查询（或视图）必须考虑所有四种可能性。正确完成此操作后，效果可能会令人惊讶。例如：

```
USE AdventureWorks2012;
GO
CREATE VIEW dbo.ComplexView
AS
    SELECT
        pc.ProductCategoryID, pc.Name AS CatName,
        ps.ProductSubcategoryID, ps.Name AS SubCatName,
        p.ProductID, p.Name AS ProductName,
        p.Color, p.ListPrice, p.ReorderPoint,
        pm.Name AS ModelName, pm.ModifiedDate
    FROM Production.ProductCategory AS pc
    FULL JOIN Production.ProductSubcategory AS ps ON
        ps.ProductCategoryID = pc.ProductCategoryID
    FULL JOIN Production.Product AS p ON
        p.ProductSubcategoryID = ps.ProductSubcategoryID
    FULL JOIN Production.ProductModel AS pm ON
        pm.ProductModelID = p.ProductModelID 
```

优化器可以成功简化以下查询：

```
SELECT
    c.ProductID,
    c.ProductName
FROM dbo.ComplexView AS c
WHERE
    c.ProductName LIKE N'G%'; 
```

至：

![简化计划](../Images/07f3dee1a7d3da2a15272c13e801fdf4.png)

[Rob Farley 在最初的 MVP Deep Dives 书中](https://rads.stackoverflow.com/amzn/click/com/1935182048)深入地描述了这些想法，并且有一段他在 SQLBits[上就该主题进行演讲的录音。](http://sqlbits.com/Sessions/Event5/Designing_for_simplification)

主要限制是外键关系[必须基于单个键](http://connect.microsoft.com/SQLServer/feedback/details/510217/support-join-elimination-for-multi-column-foreign-key-constraints)以有助于简化过程，并且针对这种视图的查询的编译时间可能会变得很长，特别是随着连接数量的增加。编写一个包含 100 个表且所有语义都完全正确的视图可能是一个相当大的挑战。我倾向于寻找替代解决方案，也许使用[动态 SQL](http://www.sommarskog.se/dynamic_sql.html)。

也就是说，非规范化表的特殊特性可能意味着视图非常易于组装，只需要强制执行的`FOREIGN KEYs`不可`NULL`引用列和适当`UNIQUE`的约束即可使该解决方案按您希望的方式工作，而无需 100 个物理连接运算符的开销在计划中。

## 例子

使用十个表而不是一百个：

```
-- Referenced tables
CREATE TABLE dbo.Ref01 (col01 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref02 (col02 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref03 (col03 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref04 (col04 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref05 (col05 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref06 (col06 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref07 (col07 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref08 (col08 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref09 (col09 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE);
CREATE TABLE dbo.Ref10 (col10 tinyint PRIMARY KEY, item varchar(50) NOT NULL UNIQUE); 
```

父表定义（带有页面压缩）：

```
CREATE TABLE dbo.Normalized
(
    pk      integer IDENTITY NOT NULL,
    col01   tinyint NOT NULL REFERENCES dbo.Ref01,
    col02   tinyint NOT NULL REFERENCES dbo.Ref02,
    col03   tinyint NOT NULL REFERENCES dbo.Ref03,
    col04   tinyint NOT NULL REFERENCES dbo.Ref04,
    col05   tinyint NOT NULL REFERENCES dbo.Ref05,
    col06   tinyint NOT NULL REFERENCES dbo.Ref06,
    col07   tinyint NOT NULL REFERENCES dbo.Ref07,
    col08   tinyint NOT NULL REFERENCES dbo.Ref08,
    col09   tinyint NOT NULL REFERENCES dbo.Ref09,
    col10   tinyint NOT NULL REFERENCES dbo.Ref10,

    CONSTRAINT PK_Normalized
        PRIMARY KEY CLUSTERED (pk)
        WITH (DATA_COMPRESSION = PAGE)
); 
```

风景：

```
CREATE VIEW dbo.Denormalized
WITH SCHEMABINDING AS
SELECT
    item01 = r01.item,
    item02 = r02.item,
    item03 = r03.item,
    item04 = r04.item,
    item05 = r05.item,
    item06 = r06.item,
    item07 = r07.item,
    item08 = r08.item,
    item09 = r09.item,
    item10 = r10.item
FROM dbo.Normalized AS n
JOIN dbo.Ref01 AS r01 ON r01.col01 = n.col01
JOIN dbo.Ref02 AS r02 ON r02.col02 = n.col02
JOIN dbo.Ref03 AS r03 ON r03.col03 = n.col03
JOIN dbo.Ref04 AS r04 ON r04.col04 = n.col04
JOIN dbo.Ref05 AS r05 ON r05.col05 = n.col05
JOIN dbo.Ref06 AS r06 ON r06.col06 = n.col06
JOIN dbo.Ref07 AS r07 ON r07.col07 = n.col07
JOIN dbo.Ref08 AS r08 ON r08.col08 = n.col08
JOIN dbo.Ref09 AS r09 ON r09.col09 = n.col09
JOIN dbo.Ref10 AS r10 ON r10.col10 = n.col10; 
```

修改统计信息以使优化器认为该表非常大：

```
UPDATE STATISTICS dbo.Normalized WITH ROWCOUNT = 100000000, PAGECOUNT = 5000000; 
```

用户查询示例：

```
SELECT
    d.item06,
    d.item07
FROM dbo.Denormalized AS d
WHERE
    d.item08 = 'Banana'
    AND d.item01 = 'Green'; 
```

给我们这个执行计划：

![执行计划1](../Images/fff16a42036cd594b37c170780c119ba.png)

规范化表的扫描看起来很糟糕，但是存储引擎在扫描期间应用了两个 Bloom-filter 位图（因此无法匹配的行甚至不会出现在查询处理器中）。这可能足以在您的情况下提供可接受的性能，并且肯定比扫描具有溢出列的原始表更好。

如果您能够在某个阶段升级到 SQL Server 2012 Enterprise，您还有另一个选择：在规范化表上创建列存储索引：

```
CREATE NONCLUSTERED COLUMNSTORE INDEX cs 
ON dbo.Normalized (col01,col02,col03,col04,col05,col06,col07,col08,col09,col10); 
```

执行计划是：

![列存储计划](../Images/5662f56c71b3802a15e7e6db22632ff4.png)

这对您来说可能看起来更糟，但是列存储提供了出色的压缩，并且整个执行计划在批处理模式下运行，并为所有贡献的列提供了过滤器。如果服务器有足够的线程和内存可用，这个替代方案真的可以实现。

最终，考虑到表的数量以及执行计划不佳或需要过多编译时间的可能性，我不确定这种规范化是正确的方法。我可能会首先更正非规范化表的架构（正确的数据类型等），可能会应用数据压缩......通常的事情。

如果数据确实属于星型模式，那么它可能需要更多的设计工作，而不仅仅是将重复的数据元素拆分到单独的表中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T19:56:18.177

为什么您认为加入 100 个表会成为性能问题？

如果所有的键都是主键，那么所有的连接都将使用索引。那么，唯一的问题是索引是否适合内存。如果它们适合内存，性能可能根本不是问题。

在做出这样的声明之前，您应该尝试使用 100 个连接进行查询。

此外，根据原始问题，参考表中只有几个值。表格本身适合单页，加上索引的另一页。这是 200 个页面，最多会占用几兆字节的页面缓存。不要担心优化，创建视图，如果您有性能问题，请考虑下一步。不要预设性能问题。

阐述：

这已经收到了很多评论。让我解释一下为什么这个想法可能不像听起来那么疯狂。

首先，我假设所有连接都是通过主键索引完成的，并且索引适合内存。

页面上的 100 个键占用 400 个字节。假设原始字符串平均每个有 40 个字节。这些将占用页面上的 4,000 字节，所以我们有一个节省。事实上，在之前的方案中，大约 2 条记录可以放在一个页面上。大约 20 个适合带有键的页面。

因此，使用键读取记录*在 I/O 方面*比读取原始记录快 10 倍左右。在关于少量值的假设下，索引和原始数据适合内存。

阅读20条记录需要多长时间？旧方法需要阅读 10 页。使用这些键，可以读取一页和 100*20 索引查找（可能需要额外查找来获取值）。根据系统的不同，2,000 个索引查找可能比额外的 9 页 I/O 更快——甚至快得多。我想说的是，这是一个合理的情况。它可能会或可能不会发生在特定系统上，但这并不疯狂。

这有点过于简单了。SQL Server 实际上并不一次读取一个页面。我认为它们是以 4 个一组的形式读取的（并且在进行全表扫描时可能会有前瞻读取）。但另一方面，在大多数情况下，表扫描查询的 I/O 绑定比处理器绑定更多，因此有空闲的处理器周期用于在引用表中查找值。

事实上，使用键可以比不使用它们*更快*地读取表，因为备用处理周期将用于查找（“备用”在读取时处理能力可用的意义上）。事实上，带有键的表可能小到足以放入可用的缓存中，从而大大提高了更复杂查询的性能。

实际性能取决于很多因素，例如字符串的长度、原始表（是否大于可用缓存？）、底层硬件同时进行 I/O 读取和处理的能力，以及对查询优化器正确执行连接的依赖。

*我最初的观点是，先验地*假设100 个连接是一件坏事是不正确的。该假设需要进行测试，使用密钥甚至可能会提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:46:04.083

如果您的数据没有太大变化，您可能会受益于创建[索引视图](http://msdn.microsoft.com/en-us/library/ms191432.aspx)，它基本上实现了视图。

如果数据经常更改，这可能不是一个好的选择，因为服务器必须为视图基础表中的每次更改维护索引视图。

这是一篇很好的[博客文章](http://www.techrepublic.com/article/see-performance-gains-by-using-indexed-views-in-sql-server/6160148)，可以更好地描述它。

来自博客：

```
CREATE VIEW dbo.vw_SalesByProduct_Indexed
 WITH SCHEMABINDING
 AS
      SELECT 
            Product, 
            COUNT_BIG(*) AS ProductCount, 
            SUM(ISNULL(SalePrice,0)) AS TotalSales
      FROM dbo.SalesHistory
      GROUP BY Product
 GO 
```

> 下面的脚本在我们的视图上创建索引：

```
CREATE UNIQUE CLUSTERED INDEX idx_SalesView ON vw_SalesByProduct_Indexed(Product) 
```

> 要显示已在视图上创建索引并且它确实占用了数据库中的空间，请运行以下脚本以找出聚集索引中有多少行以及视图占用了多少空间。

```
EXECUTE sp_spaceused 'vw_SalesByProduct_Indexed' 
```

> 下面的 SELECT 语句与之前的语句相同，只是这次它执行聚集索引查找，这通常非常快。

```
SELECT 
      Product, TotalSales, ProductCount 
 FROM vw_SalesByProduct_Indexed
 WHERE Product = 'Computer' 
```

# c# - SQL 查询在 SQL Server 2008 中有效，但在 C# 中无效

> ID：14780308
> 
> 赞同：0
> 
> 时间：2013-02-08T19:53:36.623
> 
> 标签：c#, sql-server-2008

我正在开发一个应用程序，我必须从数据库中检索一些数据。我正在使用以下查询。

```
SELECT DISTINCT Context.ContextId, ContextName 
FROM Context
INNER JOIN RunInstance 
   ON Context.ContextId IN 
      (SELECT RunInstance.ContextId 
       FROM RunInstance 
       INNER JOIN ProcessInstance 
          ON RunInstance.RunInstanceId 
             IN (SELECT RunInstanceId FROM ProcessInstance 
                 WHERE RiskDate = '2010-08-20' )); 
```

此查询在 SQL Server 2008 中完美运行。

但是，当我将它放在我的 C# 应用程序中时，它没有显示任何输出。

我的代码：

```
string squery = @"SELECT DISTINCT Context.ContextId, ContextName FROM Context INNER JOIN RunInstance ON Context.ContextId IN 
    (Select RunInstance.ContextId From RunInstance 
    INNER JOIN ProcessInstance ON RunInstance.RunInstanceId 
    IN (SELECT RunInstanceId FROM ProcessInstance Where 
    RiskDate = '2010-08-20' )); ";

using(SqlConnection sqcon = new SqlConnection("Data Source=WMLON-Z8-SQL20,61433;Initial Catalog=statusdb;Integrated Security=True")){
    sqcon.Open();
    using(SqlCommand command = new SqlCommand(squery,sqcon))
        using(SqlDataReader reader = command.ExecuteReader()){
            while(reader.Read()){
                Console.WriteLine(reader[0]+"\t"+reader[1]);
            }
        }
} 
```

谁能告诉我问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:17:06.187

请把[CommandText](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtext.aspx)放到[CommandType](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtype.aspx)中试试。

```
using(SqlConnection sqcon = new SqlConnection(
"Data Source=WMLON-Z8-SQL20,61433;Initial Catalog=statusdb;Integrated Security=True"))
{
   using(SqlCommand command = new SqlCommand(squery,sqcon)){
      command.CommandType = CommandType.Text;
      sqcon.Open();
      using(SqlDataReader reader = command.ExecuteReader())
      {
          while(reader.Read()){
            Console.WriteLine(reader[0]+"\t"+reader[1]);
          }
      }
      sqcon.Close();
   }
} 

-- Using EXISTS or IN could improve your query
    SELECT DISTINCT
            Context.ContextId ,
            ContextName
    FROM    Context
            INNER JOIN RunInstance ON Context.ContextId = RunInstance.ContextId 
            INNER JOIN ProcessInstance ON RunInstance.RunInstanceId = ProcessInstance.RunInstanceId
    WHERE   RiskDate = '2010-08-20' 
```

# sql-server - 如何使用 TSQL 获取 CHECK 约束的表达式？

> ID：14780310
> 
> 赞同：0
> 
> 时间：2013-02-08T19:53:57.020
> 
> 标签：sql-server, tsql

以下语句将返回所有 CHECK 约束。

```
SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_TYPE = 'CHECK' 
```

我如何获得表达式？例如，我想查看实际的约束，例如`([ApplicationId]=(8))`，被应用到表中。

谢谢！

SQL 服务器 2005

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T19:59:27.380

这是你想要的？

```
SELECT tc.CONSTRAINT_SCHEMA, tc.CONSTRAINT_NAME, tc.TABLE_NAME, cc.CHECK_CLAUSE
FROM [INFORMATION_SCHEMA].[CHECK_CONSTRAINTS] cc
     INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc 
       ON  cc.CONSTRAINT_NAME = tc.CONSTRAINT_NAME 
       AND cc.CONSTRAINT_SCHEMA = tc.TABLE_SCHEMA 
```

# javascript - Javascript 日期 - 如何知道 DST 在给定时区是否有效

> ID：14780313
> 
> 赞同：7
> 
> 时间：2013-02-08T19:54:05.030
> 
> 标签：javascript, node.js, timezone, dst

首先，我不是在寻找 DST 是否在本地生效。

我正在运行一个 Node 进程，该进程的数据具有关联的时间戳。我需要将这些时间戳转换为指定时区的日/月/年，但我得到的只是时区的偏移量和 DST 偏移量。

我希望日期/时刻在时区方面效果更好。它们适用于 UTC 或本地时区，但似乎您需要破解它才能获得其他东西。

有什么我想念的吗？假设我可以确定 DST 是否生效，这是否可行：

```
var d = new Date(ts + timezone_offset - local_offset);
d.getMonth();
d.getDate(); 
```

其中 timezone_offset 是时区的偏移量（标准偏移量或 dst 偏移量）？

如何确定 DST 是否生效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-28T17:00:45.643

首先，认识到如果你只有*偏移量*，你就无法解决这个问题。您必须有一个时区标识符，例如`"America/New_York"`. 既然在问题评论中你说你确实有这个，那么你可以使用[这些库之一](https://stackoverflow.com/a/15171030/634824)来完成工作。

我之前已经发布了这个问题的另一个答案，推荐[TimeZoneJS](https://github.com/mde/timezone-js)，但我现在会收回 - 因为这个问题专门关于 DST，并且 TimeZoneJS 有错误，在 DST 转换附近错误地报告值。

相反，我现在建议将[moment.js](http://momentjs.com)与[moment-timezone](http://momentjs.com/timezone)附加组件一起使用。一旦安装了这两个库（确保根据文档加载实际时区数据），代码就非常简单：

```
moment(timestamp).tz(timezone).isDST() 
```

例如：

```
moment(1451624400000).tz('America/New_York').isDST(); // false
moment(1467345600000).tz('America/New_York').isDST(); // true 
```

或者，如果您的时间戳已经是本地时间的字符串，那么请改用以下语法：

```
moment.tz('2016-01-01T00:00:00','America/New_York').isDST(); // false
moment.tz('2016-07-01T00:00:00','America/New_York').isDST(); // true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:44:10.350

moment.js ( [http://momentjs.com/](http://momentjs.com/) ) 有一个 isDST 函数。您可以使用 moment（更简单），或检查它是如何实现的。

```
moment(your_date).isDST(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T21:50:13.503

> 有什么我想念的吗？假设我可以确定 DST 是否生效，这是否适用`timezone_offset`于请求的时区偏移量？

尝试始终使用 UTC 方法来获取日期的属性。这样您（服务器的）本地时区将不会影响任何计算：

```
var d = new Date(ts + timezone_offset);
d.getUTCMonth();
d.getUTCDate(); 
```

> 如何确定 DST 是否生效？

这很复杂。根据地区的不同，有许多不同的算法来确定 DST 的开始和结束 - 例如，请查看[http://en.wikipedia.org/wiki/Daylight_saving_time_by_country](http://en.wikipedia.org/wiki/Daylight_saving_time_by_country)。

我不知道是否有任何库已经对这些进行了编码，或者甚至可能联系[时区数据库](http://en.wikipedia.org/wiki/IANA_time_zone_database)以获取正确的信息。最后的手段是向用户本人询问时区详细信息。

# java - 解码整数序列的最快方法

> ID：14780317
> 
> 赞同：-1
> 
> 时间：2013-02-08T19:54:20.740
> 
> 标签：java, io, memory-mapped-files

假设以下文件格式：

```
Integer1 Integer2 Integer3 Integer4 ... 
```

这些是使用 DataInputStream 编写的二进制整数。有 220 亿个它们写入一个大小约为 90G 的文件。

可用 RAM > 2 * 文件大小。

因此，它可以轻松放入内存中。读取和解码此类整数的最快方法是什么。目前，

```
MappedByteBuffer reads 500M numbers in time: 212.986 seconds
DataInputStream wrapped around a BufferedInputStream reads 500M numbers in time 306.755 seconds. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T21:07:22.207

答案取决于 JVM、操作系统、硬件和访问模式的确切组合。Martin Thompson 编写了一个程序，可用于测试各种读写方式的顺序 I/O 性能：http: [//mechanical-sympathy.blogspot.com/2011/12/java-sequential-io-performance.html](http://mechanical-sympathy.blogspot.com/2011/12/java-sequential-io-performance.html)

他在他的平台上的测试结论：使用 RandomAccessFile。

# java - Java在编译时找不到符号

> ID：14780321
> 
> 赞同：0
> 
> 时间：2013-02-08T19:54:27.280
> 
> 标签：java, compiler-errors

我正在关注 Java 教程（留给我自己的设备编写测试代码），但是在尝试编译时出现符号未找到错误。我看了又看，但无法弄清楚为什么我编写的代码会产生此错误。这可能很简单，但我很感激有人指出原因，因为我正在拔头发试图了解我做错了什么！

TestBeerExpert.java：

```
package com.example.model;

import com.example.model.*;
import java.util.*;

public class TestBeerExpert {

    public static void main(String[] args) {
        TestBeerExpert test = new TestBeerExpert();
        test.go();
    }

    private void go() {
        BeerExpert expert = new BeerExpert();
        List<String> brands = expert.getBrands("amber");
        ...
    }
} 
```

啤酒专家.java：

```
package com.example.model;

import java.util.*;

public class BeerExpert {

    public List<String> getBrands(String color) {
        List<String> brands = new ArrayList<String>();
        ...
        return(brands);
    }

} 
```

目录结构：

`beerV1 -> src -> com -> example -> model -> TestBeerExpert.java & BeerExpert.java`

编译`beerV1`自`javac -d classes src/com/example/model/TestBeerExpert.java`

而实际的错误：

```
src/com/example/model/TestBeerExpert.java:14: error: cannot find symbol
        BeerExpert expert = new BeerExpert();
        ^
  symbol:   class BeerExpert
  location: class TestBeerExpert
src/com/example/model/TestBeerExpert.java:14: error: cannot find symbol
        BeerExpert expert = new BeerExpert();
                                ^
  symbol:   class BeerExpert
  location: class TestBeerExpert
2 errors 
```

对于我的生活，我无法弄清楚我做错了什么。这些文件位于同一目录和包中，据我所知，这应该正在编译。我很感激现在只纠正了代码，但解释了我做错了什么，这样我以后才能记住它。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:01:30.147

添加`src`到您的*源路径*

```
 javac -sourcepath src -d classes src/com/example/model/TestBeerExpert.java 
```

您需要这样做，因为您`javac`从源所在的不同目录执行。

无需先编译`BeerExpert`（javac 将使用上述命令为您完成）。

验证：

```
~/beerV1$ ls src/com/example/model/
BeerExpert.java  TestBeerExpert.java
~/beerV1$ ls classes
~/beerV1$ javac -sourcepath src -d classes src/com/example/model/TestBeerExpert.java
~/beerV1$ ls classes/com/example/model/
BeerExpert.class  TestBeerExpert.class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:13:08.593

您收到编译错误，因为编译器无法找到 BeerExpert 类。试试下面 1\. 首先编译 BeerExpert.java 使用：javac -d classes src\com\example\model\BeerExpert.java 2\. 然后编译 TestBeerExpert.java javac -cp classes -d classes src\com\example\model\TestBeerExpert。爪哇

# c++ - 带有 2 个形参错误的 c++ 模板。

> ID：14780323
> 
> 赞同：0
> 
> 时间：2013-02-08T19:54:37.203
> 
> 标签：c++

在我的编程课上，我们只是被介绍到 C++ 中模板的概念。这是我们在上学期的 Java 课程中从未涉及过的概念，而 C++ 的整个语法真的让我陷入了一个循环。我将在下面发布的代码收到一长串编译错误。这会让我觉得我在模板语法中遗漏了一些非常明显的东西。以下只是我正在尝试使用的示例模板，可以帮助我开始做作业。如果你们中的任何人对为什么不编译有任何见解，我将不胜感激。谢谢！！

键值对.h

```
#include <fstream>
#include <iostream>
#include <string>

#ifndef KEYVALUEPAIR
#define KEYVALUEPAIR

template<class key, class value>
class keyValuePair
{
private:

key kvar;

value vvar; 

public:

keyValuePair(); //Default Constructor

void setKvar(key object1); //Method to set kvar to a value

void setVvar(value object2); //Method to set vvar to a value    

key getKvar(); //Method to return kvar

value getVvar(); //Method to return vvar

};

#include "keyValuePair.cpp"
#endif 
```

键值对.cpp

```
#include <iostream>
#include <fstream>
#include <string>

#include "keyValuePair.h"

template<class key, class value>;
keyValuePair<key, value>::keyValuePair()
{
}

template<class key, class value>; //return the value of kvar
key keyValuePair<key, value>::getKvar()
{
return kvar;
}

template<class key, class value>; //return the value of vvar
value keyValuePair<key, value>::getVvar()
{
return vvar;
}

template<class key, class value>; //set the value of kvar
void keyValuePair<key, value>::setKvar(key& object1)
{
object1 = kvar;
}

template<class key, class value>; //set the value of vvar
void keyValuePair<key, value>::setVvar(value& object2)
{
object2 = vvar;
} 
```

主文件

```
#include <fstream>
#include <iostream>
#include <string>

#include "keyValuePair.h"

using namespace std; 

int main(int argc, char* argv[])
{

fstream myFile(argv[1], ios::in);
fstream fout("out.txt", ios::out); 

myFile.close();
fout.close(); 

keyValuePair<string, int> sample;

sample.setKvar("Hello World.");
sample.setVvar(3);

cout << sample.getKvar() << sample.getVvar() << "\n"; 

return 0; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:06:19.417

去掉后面的分号`template<class key, class value>`：

```
 !--here
template<class key, class value>; 
keyValuePair<key, value>::keyValuePair()
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:07:44.120

keyValuePair.h 不应包含 keyValuePair.cpp。还应直接声明 keyValuePair.cpp 中的函数体（模板的最佳实践与普通函数不同）

```
template<class key, class value>
class keyValuePair
{
private:

    key kvar;

    value vvar; 

public:

    keyValuePair(){} //Default Constructor

    void setKvar(key object1){kvar = object1;} //Method to set kvar to a value

    void setVvar(value object2){vvar = object2;} //Method to set vvar to a value    

    key getKvar(){return kvar;} //Method to return kvar

    value getVvar(){return vvar;} //Method to return vvar

}; 
```

后面的分号

```
template<class key, class value>; 
```

也是一个错字。

此外，您的 setKvar 函数将 kvar 的值分配给通过引用获取的参数。我不认为这是您想要看到的，因为该函数被命名为 set。

模板类成员函数的主体通常在行中声明的原因是编译器只会为特定类型或类型生成代码（称为为特定类型实例化模板），如果它看到它们在该编译单元中使用（通常一个编译单元和一个 .cpp 文件是一回事）。

这意味着如果您将函数体放在 keyValuePair.cpp 中并尝试在 main.cpp 中使用它们，则链接器会给您“未找到”错误，因为在编译单元 keyValuePair.cpp 中编译器看不到它们被使用所以它从未创造过它们。

您可以像这样直接为特定类型实例化模板：

```
template keyValuePair<int,long>; 
```

然而，这可能是一种不好的风格，因为每次您想使用带有新类型的模板时，您都需要将这些声明添加到您的 keyValuePair.cpp 文件中，这首先破坏了具有灵活性的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:07:51.100

您在语法上有几个小错误。

*   您声明`setKvar`并按`setVvar`值获取参数，但定义它们以获取引用。（删除`&`.cpp 文件）

*   后面不要加分号`template<class key, class value>`

*   在`setKvar`and中`setVvar`，您在作业中交换了参数。它应该像`kvar = object1;`in`setKvar`和类比`vvar = object2;`in`setVvar`

*   头文件中不要包含cpp文件，直接将内容包含到头文件中，就像PorkyBrain说的那样。

# algorithm - 最大重叠点

> ID：14780324
> 
> 赞同：4
> 
> 时间：2013-02-08T19:54:39.553
> 
> 标签：algorithm, clrs

假设我们希望跟踪一组区间中的最大重叠点——数据库中与它重叠的区间数最多的点。

一种。表明总会有一个最大重叠点，它是其中一个线段的端点。

湾。设计一个有效支持操作 INTERVAL-INSERT、INTERVAL-DELETE 和 FIND-POM 的数据结构，该操作返回最大重叠点。（提示：保留所有端点的红黑树。将 +1 值与每个左端点相关联，并将 -1 值与每个右端点相关联。用一些额外信息来扩充树的每个节点以维护最大重叠点。）

这个问题在《*算法介绍*》一书中。但我不知道如何解决第二个问题。如果一个更伟大的头脑有一个优雅的解决方案，请与我分享你的想法！谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-09T04:59:14.953

引用：[http ://ripcrixalis.blog.com/2011/02/08/clrs-chapter-14/](http://ripcrixalis.blog.com/2011/02/08/clrs-chapter-14/)

保留所有端点的 RB 树。我们将端点一一插入，作为从左到右扫描的扫描线。对于每个左端点 e，关联一个值 p[e] = +1（将重叠增加 1）。与每个右端点 e 关联一个值 p[e] = -1（将重叠减少 1）。当多个端点具有相同的值时，请先插入具有该值的所有左侧端点，然后再插入具有该值的任何右侧端点。

这是一些直觉。让 e1, e2, . . . , en 是与我们的区间相对应的端点的排序序列。让 s(i, j) 表示总和 p[ei] + p[ei+1] + · · · + p[ej]，其中 1 ≤ i ≤ j ≤ n。我们希望找到一个最大化 s(1, i ) 的 i。每个节点 x 存储三个新属性。我们存储 v[x] = s(l[x], r [x])，即 x 的子树中所有节点的值的总和。我们还存储 m[x]，即通过表达式 s(l[x], i) 对任何 i 获得的最大值。我们将 o[x] 存储为 m[x] 达到最大值的 i 的值。对于哨兵，我们定义 v[nil[T]] = m[nil[T]] = 0。

我们可以以自下而上的方式计算这些属性以满足定理 14.1 的要求：

```
v[x] = v[left[x]] + p[x] + v[right[x]] ,
m[x] = max{
m[left[x]] (max is in x’s left subtree),
v[left[x]] + p[x] (max is at x),
v[left[x]] + p[x] + m[right[x]] (max is in x’s right subtree). } 
```

一旦我们了解了如何计算 m[x]，就可以直接从 x 及其两个子项中的信息计算 o[x]。

FIND-POM：返回其端点由 o[root[T]] 表示的区间。由于我们如何定义新属性，定理 14.1 说每个操作在 O(lg n) 时间内运行。事实上，FIND-POM 只需要 O(1) 时间。

# xml - 通过 bash 导出同一文件中的多个 XML 块

> ID：14780326
> 
> 赞同：0
> 
> 时间：2013-02-08T19:54:42.627
> 
> 标签：xml, bash

我有一个包含一堆单独代码块的 XML 文件。每个都需要在自己的文件中...每个都以 . 开头`<?xml version="1.0" encoding="UTF-8"?>`和结尾`</endxml>`。BASH 有没有一种方法可以让我获取这个单个文件并将每个代码块都放在它自己的文件之上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:07:39.213

如果`</endxml>`保证自己在单独的行上，您可以尝试这个（不一定是最好的）：

```
awk 'BEGIN {nout=1;} /^<\/endxml>$/ {close("xml"nout".xml"); ++nout;} !/^<\/endxml>$/ {print >("xml"nout".xml");}' 
```

它将创建文件`xml1.xml`，`xml2.xml`等等。删除该`</endxml>`行，并保留 XML 标头。

# matlab - 生成每个之间距离最小的3-d随机点？

> ID：14780328
> 
> 赞同：4
> 
> 时间：2013-02-08T19:54:46.600
> 
> 标签：matlab, geometry, distance, minimum

那里。我将使用这个特定字符在 matlab 中生成 10^6 个随机点。这些点应该在半径为 25 的球体内，它们是 3-D，所以我们有 x、y、z 或 r、theta、phi。每个点之间有一个最小距离。首先，我决定生成点然后检查距离，然后省略不具备这些条件的点。但是，它可能会省略很多点。另一种方法是使用 RSA（随机序列加法），这意味着一个一个地生成点，它们之间的最小距离。例如生成第一个点，然后从点 1 的最小距离中随机生成第二个点。继续直到达到 10^6 个点。但这需要很多时间，我无法达到 10^6 点，因为为新点搜索适当位置的速度需要很长时间。

现在我正在使用这个程序：

```
Nmax=10000; 
R=25; 
P=rand(1,3); 
k=1; 
while k<Nmax 
theta=2*pi*rand(1); 
phi=pi*rand(1); 
r = R*sqrt(rand(1)); 
% convert to cartesian 
x=r.*sin(theta).*cos(phi); 
y=r.*sin(theta).*sin(phi); 
z=r.*cos(theta); 
P1=[x y z]; 
r=sqrt((x-0)^2+(y-0)^2+(z-0)^2); 
D = pdist2(P1,P,'euclidean'); 
% euclidean distance 

    if D>0.146*r^(2/3) 
        P=[P;P1]; 
        k=k+1;
    end 
    i=i+1; 
end 
x=P(:,1);y=P(:,2);z=P(:,3); plot3(x,y,z,'.'); 
```

如何通过这些条件有效地生成积分？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T14:50:57.577

我仔细研究了您的算法，并得出结论，它永远不会起作用-至少如果您真的想在该领域获得一百万分，则不会。有一张简单的图片可以解释为什么不这样做 - 这是您需要测试的点数（使用您的 RSA 技术）以获得一个额外的“好”点。如您所见，这仅在几千点处渐近（我针对 200k 点运行了一个稍微快一点的算法来产生这个）：

![测试点图](../Images/c3be0a5e81dbc0027f8944274dd6962a.png)

我不知道您是否曾经尝试过在将它们完美排列时计算出可以放入球体的理论点数，但我开始怀疑这个数字比 1E6 小很多。

我用来调查这个的完整代码，以及它生成的输出，可以在[这里](http://www.floris.us/SO/html/randInSphere.html)找到。我从来没有达到我在之前的答案中描述的技术......在你描述的设置中还有太多其他事情要做。

编辑：我开始认为，即使有“完美”的安排，也可能无法获得 100 万分。我为自己做了一个简单的模型如下：

想象一下，您从“外壳”(r=25) 开始，并尝试以相等距离拟合点。如果将“壳”的面积除以一个“排除盘”（半径为 r_sub_crit）的面积，您将得到该距离处点数的（高）估计：

```
numpoints = 4*pi*r^2 / (pi*(0.146 * r^(2/3))^2) ~ 188 * r^(2/3) 
```

下一个“外壳”的半径应该小 0.146*r^(2/3) - 但如果您认为这些点的排列非常仔细，您可能会更接近一点。再一次，让我们大方地说贝壳可以比标准更接近 1/sqrt(3)。然后，您可以使用简单的 python 脚本从外壳开始并按自己的方式进行操作：

```
import scipy as sc
r = 25
npts = 0
def rc(r):
  return 0.146*sc.power(r, 2./3.)
while (r > rc(r)):  
  morePts = sc.floor(4/(0.146*0.146)*sc.power(r, 2./3.))
  npts = npts + morePts
  print morePts, ' more points at r = ', r
  r = r - rc(r)/sc.sqrt(3)

print 'total number of points fitted in sphere: ', npts 
```

这个的输出是：

```
1604.0  more points at r =  25
1573.0  more points at r =  24.2793037966
1542.0  more points at r =  23.5725257555
1512.0  more points at r =  22.8795314897
1482.0  more points at r =  22.2001865995
1452.0  more points at r =  21.5343566722
1422.0  more points at r =  20.8819072818
1393.0  more points at r =  20.2427039885
1364.0  more points at r =  19.6166123391
1336.0  more points at r =  19.0034978659
1308.0  more points at r =  18.4032260869
1280.0  more points at r =  17.8156625053
1252.0  more points at r =  17.2406726094
1224.0  more points at r =  16.6781218719
1197.0  more points at r =  16.1278757499
1171.0  more points at r =  15.5897996844
1144.0  more points at r =  15.0637590998
1118.0  more points at r =  14.549619404
1092.0  more points at r =  14.0472459873
1066.0  more points at r =  13.5565042228
1041.0  more points at r =  13.0772594652
1016.0  more points at r =  12.6093770509
991.0  more points at r =  12.1527222975
967.0  more points at r =  11.707160503
943.0  more points at r =  11.2725569457
919.0  more points at r =  10.8487768835
896.0  more points at r =  10.4356855535
872.0  more points at r =  10.0331481711
850.0  more points at r =  9.64102993012
827.0  more points at r =  9.25919600154
805.0  more points at r =  8.88751153329
783.0  more points at r =  8.52584164948
761.0  more points at r =  8.17405144976
740.0  more points at r =  7.83200600865
718.0  more points at r =  7.49957037478
698.0  more points at r =  7.17660957023
677.0  more points at r =  6.86298858965
657.0  more points at r =  6.55857239952
637.0  more points at r =  6.26322593726
618.0  more points at r =  5.97681411037
598.0  more points at r =  5.69920179546
579.0  more points at r =  5.43025383729
561.0  more points at r =  5.16983504778
542.0  more points at r =  4.91781020487
524.0  more points at r =  4.67404405146
506.0  more points at r =  4.43840129415
489.0  more points at r =  4.21074660206
472.0  more points at r =  3.9909446055
455.0  more points at r =  3.77885989456
438.0  more points at r =  3.57435701766
422.0  more points at r =  3.37730048004
406.0  more points at r =  3.1875547421
390.0  more points at r =  3.00498421767
375.0  more points at r =  2.82945327223
360.0  more points at r =  2.66082622092
345.0  more points at r =  2.49896732654
331.0  more points at r =  2.34374079733
316.0  more points at r =  2.19501078464
303.0  more points at r =  2.05264138052
289.0  more points at r =  1.91649661498
276.0  more points at r =  1.78644045325
263.0  more points at r =  1.66233679273
250.0  more points at r =  1.54404945973
238.0  more points at r =  1.43144220603
226.0  more points at r =  1.32437870508
214.0  more points at r =  1.22272254805
203.0  more points at r =  1.1263372394
192.0  more points at r =  1.03508619218
181.0  more points at r =  0.94883272297
170.0  more points at r =  0.867440046252
160.0  more points at r =  0.790771268402
150.0  more points at r =  0.718689381062
140.0  more points at r =  0.65105725389
131.0  more points at r =  0.587737626612
122.0  more points at r =  0.528593100237
113.0  more points at r =  0.473486127367
105.0  more points at r =  0.422279001431
97.0  more points at r =  0.374833844693
89.0  more points at r =  0.331012594847
82.0  more points at r =  0.290676989951
75.0  more points at r =  0.253688551418
68.0  more points at r =  0.219908564725
61.0  more points at r =  0.189198057381
55.0  more points at r =  0.161417773651
49.0  more points at r =  0.136428145311
44.0  more points at r =  0.114089257597
38.0  more points at r =  0.0942608092113
33.0  more points at r =  0.0768020649149
29.0  more points at r =  0.0615717987589
24.0  more points at r =  0.0484282253244
20.0  more points at r =  0.0372289153633
17.0  more points at r =  0.0278306908104
13.0  more points at r =  0.0200894920319
10.0  more points at r =  0.013860207063
8.0  more points at r =  0.00899644813842
5.0  more points at r =  0.00535025545232 

total number of points fitted in sphere:  55600.0 
```

这似乎证实了你真的无法达到一百万，无论你如何尝试......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T00:17:31.240

你可以做很多事情来改进你的程序——算法和代码。

在代码方面，真正让你慢下来的一件事是，你不仅使用`for`循环（这很慢），而且在行中

```
P = [P;P1]; 
```

您将元素附加到数组。每次发生这种情况时，Matlab 都需要找到一个新的地方来放置数据，复制过程中的所有点。这很快变得非常缓慢。预分配数组

```
P = zeros(1000000, 3); 
```

跟踪到目前为止您找到的点数 N，并将距离计算更改为

```
D = pdist2(P1, P(1:N, :), 'euclidean'); 
```

至少会解决这个问题......

另一个问题是您检查所有先前找到的点的新点 - 因此，当您有 100 个点时，您检查大约 100x100，对于 1000，它是 1000x1000。然后你可以看到这个算法至少是 O(N^3) ......不计算随着密度的增加你会得到更多“未命中”的事实。N=10E6的AO(N^3)算法至少需要10E18个周期；如果您有一台 4 GHz 机器，每次比较有一个时钟周期，您将需要 2.5E9 秒 = 大约 80 年。您可以尝试并行处理，但这只是蛮力 - 谁想要呢？

我建议您考虑将问题分解成更小的部分（从字面上看）：例如，如果您将球体分成大约为最大距离大小的小盒子，并且对于每个盒子，您跟踪哪些点在它，那么您只需要检查“这个”框及其直接邻居中的点 - 总共 27 个框。如果您的盒子的宽度为 2.5 毫米，那么您将拥有 100x100x100 = 1M 的盒子。这看起来很多，但现在您的计算时间将大大减少，因为（在算法结束时）每个盒子平均只有 1 个点......当然，使用您使用的距离标准，您将在中心附近有更多点，但这是一个细节。

您需要的数据结构将是一个 100x100x100 的单元格数组，每个单元格都包含迄今为止“在该单元格中”找到的好点的索引。元胞数组的问题在于它不适合向量化。相反，如果您有内存，则可以将其分配为 10x100x100x100 的 4D 数组，假设每个单元格不超过 10 个点（如果这样做，则必须单独处理；在这里与我合作...） . 使用`-1`尚未找到的点的索引

那么您的支票将是这样的：

```
% initializing:
bigList = zeros(10,102,102,102)-1; % avoid hitting the edge...
NPlist = zeros(102, 102, 102); % track # valid points in each box
bottomcorner = [-25.5, -25.5, -25.5]; % boxes span from -25.5 to +25.5
cellSize = 0.5; 
```

.

```
% in your loop:
P1= [x, y, z];
cellCoords = ceil(P1/cellSize);
goodFlag = true;
pointsSoFar = bigList(:, cellCoords(1)+(-1:1), cellCoords(2)+(-1:1), cellCoords(3)+(-1:1));
pointsToCheck = find(pointsSoFar>0); % this is where the big gains come...
r=sum(P1.^2);
D = pdist2(P1,P(pointsToCheck, :),'euclidean'); % euclidean distance 

if D>0.146*r^(2/3) 
    P(k,:) = P1;
    % check the syntax of this line...
    cci = ind2sub([102 102 102], cellCoords(1), cellCoords(2), cellCoords(3));
    NP(cci)=NP(cci)+1; % increasing number of points in this box
    % you want to handle the case where this > 10!!!
    bigList(NP(cci), cci) = k;
    k=k+1;
end
.... 
```

我不知道你能不能从这里拿走；如果你不能，请在笔记中说明，我可能在这个周末有时间更详细地编写代码。有一些方法可以通过一些矢量化来加快速度，但很快就会变得难以管理。

我认为在空间中随机放置大量点，然后使用上面的进行巨大的矢量化剔除，可能是要走的路。但我建议先采取一些小步骤......如果你能让上述工作正常，你可以进一步优化（数组大小等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-11T13:10:42.353

我找到[了参考资料](http://www.academia.edu/1100820/Simulated_brain_tumor_growth_dynamics_using_a_three-dimensional_cellular_automaton)——“使用三维细胞自动机模拟脑肿瘤生长动力学”，Ansal 等人 (2000)。

我同意这令人费解——直到你意识到一件重要的事情。他们正在报告他们的结果`mm`，但您的代码是用`cm`. 虽然这可能看起来微不足道，但“临界半径”的公式`rc = 0.146r^(2/3)`包括一个常数 ，`0.146`即维度 - 维度是`mm^(1/3)`，而不是`cm^(1/3)`。

当我在我的 python 代码中进行更改以评估可能的网格站点的数量时，它会增加 10 倍。现在他们声称他们使用的是 0.38 的“干扰限制”——这个数字你真的找不到更多的站点. 如果你包括这个限制，我预测不会超过 200k 点 - 仍然低于他们的 150 万，但不是那么疯狂。

您可能会考虑联系作者与他们讨论这个问题？如果您想将我包括在对话中，您可以给我发电子邮件：SO（只有两个字母）在`my handle name`dot `united states`。与我在上面发布链接的域相同...

# xml - 如何将平面 xml 数组变成树？

> ID：14780330
> 
> 赞同：-1
> 
> 时间：2013-02-08T19:54:53.607
> 
> 标签：xml, xslt-1.0

有人可以提供以下帮助吗？

我需要转换

```
<categories type="array">
      <category type="array">
        <category-name><![CDATA[Categories]]></category-name>
        <category-name><![CDATA[BAGS & TRIPODS]]></category-name>
        <category-name><![CDATA[Bags & Cases]]></category-name>
        <category-name><![CDATA[soft cases]]></category-name>
        <category-name><![CDATA[camera]]></category-name>
      </category>
    </categories> 
```

进入

```
<Category>
        <Name>BAGS &amp; TRIPODS</Name>
        <Category>
          <Name>Bags &amp; Cases</Name>
          <Category>
            <Name>soft cases</Name>
            <Category>
              <Name>camera</Name>
            </Category>
          </Category>
        </Category>
      </Category> 
```

这必须在 XSLT 1.0 中。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T21:20:17.667

你的意思是你想把一个平面序列变成一棵树，其中每个父母只有一个孩子？

在父元素的模板中，不要将模板应用于所有子元素，而仅应用于第一个子元素：

```
 <xsl:template match="category[@type='array']">
    <xsl:apply-templates select="*[1]"/>    
  </xsl:template> 
```

然后在每个孩子的模板中，通过写出新的 Category 元素及其名称来处理该孩子，然后将模板应用于紧随其后的兄弟姐妹：

```
 <xsl:template match="category-name">
    <Category>
      <Name>
        <xsl:apply-templates/>
      </Name>
      <xsl:apply-templates select="following-sibling::*[1]"/>
    </Category>
  </xsl:template> 
```

在您的示例中，数组中的初始项目似乎已被删除；我们需要特殊的代码：

```
 <xsl:template match="category-name
                       [normalize-space = 'Categories']">
    <xsl:apply-templates select="following-sibling::*[1]"/>
  </xsl:template> 
```

全部一起：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="1.0">

   <xsl:output method="xml" indent="yes"/>

  <xsl:template match="category[@type='array']">
    <xsl:apply-templates select="*[1]"/>    
  </xsl:template>

  <xsl:template match="category-name[normalize-space = 'Categories']">
    <xsl:apply-templates select="following-sibling::*[1]"/>
  </xsl:template>  

  <xsl:template match="category-name">
    <Category>
      <Name>
        <xsl:apply-templates/>
      </Name>
      <xsl:apply-templates select="following-sibling::*[1]"/>
    </Category>
  </xsl:template>

</xsl:stylesheet> 
```

根据您提供的输入，这将产生以下内容：

```
<Category>
  <Name>Categories</Name>
  <Category>
    <Name>BAGS &amp; TRIPODS</Name>
    <Category>
      <Name>Bags &amp; Cases</Name>
      <Category>
        <Name>soft cases</Name>
        <Category>
          <Name>camera</Name>
        </Category>
      </Category>
    </Category>
  </Category>
</Category> 
```

# android - 安卓运行时异常

> ID：14780331
> 
> 赞同：0
> 
> 时间：2013-02-08T19:55:09.330
> 
> 标签：android, exception, android-activity, inflate

谁能向我解释以下 logcat 抱怨什么？

```
02-08 20:40:04.383: E/AndroidRuntime(10227): FATAL EXCEPTION: main
02-08 20:40:04.383: E/AndroidRuntime(10227): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.decko/com.example.decko.Game}: android.view.InflateException: Binary XML file line #27: Error inflating class android.widget.ImageButton
02-08 20:40:04.383: E/AndroidRuntime(10227):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
02-08 20:40:04.383: E/AndroidRuntime(10227):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
02-08 20:40:04.383: E/AndroidRuntime(10227):    at..` 
```

编辑：这是我的 Game 类的 java 代码。

```
package com.example.decko;

import android.app.Activity;
import android.os.Bundle;
import android.view.Gravity;
import android.view.View;
import android.widget.GridLayout;
import android.widget.HorizontalScrollView;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.LinearLayout.LayoutParams;

public class Game extends Activity {
GridLayout parentGrid;
HorizontalScrollView parentLinear;
LinearLayout innerLinearLayout;

private deckWrapper deck; 

ImageButton deckButton;
ImageView pilePosition;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_game);

    //Fill up and shuffle cards
    this.deck = new deckWrapper();
    //..Done
    // Defining layout hierarchy
    parentGrid = (GridLayout) findViewById(R.id.GridLayout1);
    parentLinear = (HorizontalScrollView) findViewById(R.id.horizontalScrollView1);
    innerLinearLayout = (LinearLayout) findViewById(R.id.innerLinearLayout);
    //..Done 

    //Define Deck and Card positions
    deckButton = (ImageButton) findViewById(R.id.deck);
    pilePosition = (ImageView) findViewById(R.id.cardpile);
    //..Done

}
public void deckButtonOnClick(View v) {
    this.pickCard();

}
protected void pickCard() {
    ImageView imageView = new ImageView(getApplicationContext());
    imageView.setImageResource(deck.takeCard());
    imageView.setAdjustViewBounds(true);

    LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(
            LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
    params.setMargins(6, 0, 6, 0);

    params.gravity = Gravity.TOP | Gravity.LEFT;
    imageView.setLayoutParams(params);
    imageView.setTag("1");
    imageView.setOnClickListener(new MyOnClickListener());  // TODO
    innerLinearLayout.addView(imageView);
} 
```

}

我知道这很乱。当我将主题从常规 api 14 主题更改为 Android.holo 时，出现了问题。我还在 xml 文件中定义了每个按钮的 clicklistener，例如：

```
 <ImageButton
        android:id="@+id/deck"
        android:layout_column="0"
        android:layout_gravity="center"
        android:layout_marginBottom="50dp"
        android:layout_marginRight="60dp"
        android:layout_row="0"
        android:onClick="deckButtonOnClick"
        android:background="@style/AppBaseTheme"
        android:src="@drawable/deck_1" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T17:36:33.497

我认为您不能为 android:background 指定样式。它期望那里有一个drawable。

# tridion - CDA Broker API：通过组件 ID 列表获取 ComponentPresentations

> ID：14780332
> 
> 赞同：5
> 
> 时间：2013-02-08T19:55:12.890
> 
> 标签：tridion, tridion-2011, tridion-content-delivery

我正在尝试查看是否有一种方法可以通过在一个 API 中传递 ComponentID 列表而不是在循环中传递每一个来获取 ComponentPresentations。就我而言，所有 DCP 也都使用相同的模板。

当我检查 API 时，我找不到任何可以接受 tcmids 列表或那些行中的东西的方法。我试图解决的用例是在一个 API 调用中获取所有 DCP，而不是循环通过 10-15（在我的情况下）并独立获取每个 DCP，这在我们第一次访问代理数据库时无效。

我能够使用 OData Web 服务获得相同的结果，但我们还没有准备好使用 Odata。不确定 Odata 和代理 API 是否略有不同，但找不到任何文档从查询点解释 API 与 Odata 在功能上的差异。

任何帮助将不胜感激。

ENV：Tridion 2011 SP1，Java API。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T20:02:56.073

OData 和 Broker API*非常*不同。如果您想了解有关 OData 的信息，我建议您查看[此处](http://www.odata.org/)和[此处](https://stackoverflow.com/questions/tagged/odata)。

不，您不能通过 Content Delivery API 执行该操作。使用正确配置的缓存，您将在每个组件表示中只访问一次数据库，因此影响最小化......

# java - 程序终止，JFrame 不出现

> ID：14780343
> 
> 赞同：-3
> 
> 时间：2013-02-08T19:55:50.643
> 
> 标签：java

嘿伙计们，我正在编写一个用于练习的 java 程序。它涉及一个 JFrame、JButton 和动作侦听器。当我尝试运行程序（通过 Eclipse）时，控制台显示“Window(5) [Java Application]”[...]

有谁知道修复？这是我的代码：

**窗口.java**

```
package com.github.dtroll.Carzett.main;

import java.awt.Color;

import javax.swing.JFrame;

public class Window {
public static void startGame() {
    JFrame f = new JFrame("Journey To Carzett");
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setResizable(true);
    f.setBackground(Color.GRAY);
    f.setVisible(true);
    f.setSize(750, 500);
    //JPanel p = new JPanel(new BorderLayout());
}
public static void main(String args[]) {

    new Window();
           new StartPanel();
}

} 
```

**StartPanel.java** （用于在按下按钮时向程序添加面板。）

```
package com.github.dtroll.Carzett.main;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JPanel;
public class StartPanel extends JPanel implements ActionListener{

/**
 * 
 */
private static final long serialVersionUID = 1L;
private JButton start;

public StartPanel(){
    Icon startButton = new ImageIcon("/images/buttons/start.png");
    this.start = new JButton(startButton);
    this.start.addActionListener(this);
    this.add(start);
}

@Override
public void actionPerformed(ActionEvent e) {
    if(e.getSource() == start){
        //insert methods here
    }

}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:06:24.230

看起来您并没有真正连接 JPanel 和 JFrame。基本上，您需要将 JPanel 添加到 JFrame，然后“打包”JFrame 并将其设置为可见。尝试这个：

```
public static void main(String args[]) {

    Window frame = new Window();
    frame.startGame(new StartPanel());

} 
```

您的窗口代码应如下所示：

```
public static void startGame(JPanel panel) {
    JFrame f = new JFrame("Journey To Carzett");
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setResizable(true);
    f.setBackground(Color.GRAY);
    f.setVisible(true);
    f.setSize(750, 500);
    f.getContentPane(panel);
    f.pack();
    f.setVisible(true);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:00:28.903

你在哪里调用`startgame()`. 如果您不调用它，则不会出现框架。要查看框架，只需在 main 中添加：

```
startGame() 
```

# c# - 将字符串转换为货币和全球化问题

> ID：14780349
> 
> 赞同：1
> 
> 时间：2013-02-08T19:56:28.163
> 
> 标签：c#, string, globalization

我有这个：

```
var pl = new CultureInfo("pl-PL");
decimal valsue = decimal.Parse("2,25 PLN", pl); 
```

如果我不将“PLN”放入我的字符串中，它可以正常工作。但是 PLN 是我国的货币，我认为它应该解析，所以也许我做错了什么？是否有任何选项可以将其解析为十进制，并将“PLN”附加到字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:07:33.567

如果你看一下你`CultureInfo`的[`NumberFormat`](http://msdn.microsoft.com/en-us/library/2xdwt6xx.aspx)对象，这将产生一些关于它打算如何解析值的线索。特别是`NumberFormat.CurrencySymbol`对于“pl-PL”文化来说`zł`。

换句话说，这个表达式会成功解析：`decimal.Parse("2,25 zł", pl);`

如果您更喜欢使用 PLN 作为货币符号（从技术上讲，它是货币*代码*），则可以配置一个 custom `NumberFormat`，如下所示：

```
var pln = (NumberFormatInfo) pl.NumberFormat.Clone(); // Clone is needed to create a copy whose properties can be set.
pln.CurrencySymbol = "PLN";
decimal valsue = decimal.Parse("2,25 PLN", NumberStyles.Currency, pln); 
```

[`NumberStyles.Currency`](http://msdn.microsoft.com/en-us/library/system.globalization.numberstyles.aspx)但请注意Parse 调用中的用法：默认情况下，`decimal.Parse`仅接受包含数值的字符串，不接受货币格式。

# javascript - 使用 JavaScript 将相对路径转换为绝对路径

> ID：14780350
> 
> 赞同：84
> 
> 时间：2013-02-08T19:56:36.540
> 
> 标签：javascript, html, path

有一个函数，它给了我这样的网址：

```
./some.css
./extra/some.css
../../lib/slider/slider.css 
```

它始终是相对路径。

假设我们知道页面的当前路径，例如`http://site.com/stats/2012/`，不确定如何将这些相对路径转换为真实路径？

我们应该得到类似的东西：

```
./some.css => http://site.com/stats/2012/some.css
./extra/some.css => http://site.com/stats/2012/extra/some.css
../../lib/slider/slider.css => http://site.com/lib/slider/slider.css 
```

没有 jQuery，只有香草 javascript。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2017-06-14T14:40:40.477

最简单、最有效、最正确的方法就是使用[URL](http://caniuse.com/#feat=url) api。

```
new URL("http://www.stackoverflow.com?q=hello").href;
//=> http://www.stackoverflow.com/?q=hello"

new URL("mypath","http://www.stackoverflow.com").href;
//=> "http://www.stackoverflow.com/mypath"

new URL("../mypath","http://www.stackoverflow.com/search").href
//=> "http://www.stackoverflow.com/mypath"

new URL("../mypath", document.baseURI).href
//=> "https://stackoverflow.com/questions/mypath" 
```

`a`在性能方面，此解决方案与使用字符串操作相当，并且速度是创建标签的两倍。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2013-02-08T21:30:22.977

Javascript 会为你做这件事。无需创建函数。

```
var link = document.createElement("a");
link.href = "../../lib/slider/slider.css";
alert(link.protocol+"//"+link.host+link.pathname+link.search+link.hash);

// Output will be "http://www.yoursite.com/lib/slider/slider.css" 
```

但是如果你需要它作为一个函数：

```
var absolutePath = function(href) {
    var link = document.createElement("a");
    link.href = href;
    return (link.protocol+"//"+link.host+link.pathname+link.search+link.hash);
} 
```

**更新：**如果您需要完整的绝对路径，则更简单的版本：

```
var absolutePath = function(href) {
    var link = document.createElement("a");
    link.href = href;
    return link.href;
} 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2013-02-08T20:04:31.687

这应该这样做：

```
function absolute(base, relative) {
    var stack = base.split("/"),
        parts = relative.split("/");
    stack.pop(); // remove current file name (or empty string)
                 // (omit if "base" is the current folder without trailing slash)
    for (var i=0; i<parts.length; i++) {
        if (parts[i] == ".")
            continue;
        if (parts[i] == "..")
            stack.pop();
        else
            stack.push(parts[i]);
    }
    return stack.join("/");
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-09-14T13:41:38.190

这来自[MDN](https://developer.mozilla.org/en-US/docs/Web/API/document.cookie#Using_relative_URLs_in_the_path_parameter)是牢不可破的！

```
/*\
|*|
|*|  :: translate relative paths to absolute paths ::
|*|
|*|  https://developer.mozilla.org/en-US/docs/Web/API/document.cookie
|*|
|*|  The following code is released under the GNU Public License, version 3 or later.
|*|  http://www.gnu.org/licenses/gpl-3.0-standalone.html
|*|
\*/

function relPathToAbs (sRelPath) {
  var nUpLn, sDir = "", sPath = location.pathname.replace(/[^\/]*$/, sRelPath.replace(/(\/|^)(?:\.?\/+)+/g, "$1"));
  for (var nEnd, nStart = 0; nEnd = sPath.indexOf("/../", nStart), nEnd > -1; nStart = nEnd + nUpLn) {
    nUpLn = /^\/(?:\.\.\/)*/.exec(sPath.slice(nEnd))[0].length;
    sDir = (sDir + sPath.substring(nStart, nEnd)).replace(new RegExp("(?:\\\/+[^\\\/]*){0," + ((nUpLn - 1) / 3) + "}$"), "/");
  }
  return sDir + sPath.substr(nStart);
} 
```

示例用法：

```
/* Let us be in /en-US/docs/Web/API/document.cookie */

alert(location.pathname);
// displays: /en-US/docs/Web/API/document.cookie

alert(relPathToAbs("./"));
// displays: /en-US/docs/Web/API/

alert(relPathToAbs("../Guide/API/DOM/Storage"));
// displays: /en-US/docs/Web/Guide/API/DOM/Storage

alert(relPathToAbs("../../Firefox"));
// displays: /en-US/docs/Firefox

alert(relPathToAbs("../Guide/././API/../../../Firefox"));
// displays: /en-US/docs/Firefox 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-29T11:49:27.187

如果您想在浏览器中对来自自定义网页的链接（而不是运行脚本的页面）进行相对到绝对转换，您可以使用@Bergi 建议的功能的增强版本：

```
var resolveURL=function resolve(url, base){
    if('string'!==typeof url || !url){
        return null; // wrong or empty url
    }
    else if(url.match(/^[a-z]+\:\/\//i)){ 
        return url; // url is absolute already 
    }
    else if(url.match(/^\/\//)){ 
        return 'http:'+url; // url is absolute already 
    }
    else if(url.match(/^[a-z]+\:/i)){ 
        return url; // data URI, mailto:, tel:, etc.
    }
    else if('string'!==typeof base){
        var a=document.createElement('a'); 
        a.href=url; // try to resolve url without base  
        if(!a.pathname){ 
            return null; // url not valid 
        }
        return 'http://'+url;
    }
    else{ 
        base=resolve(base); // check base
        if(base===null){
            return null; // wrong base
        }
    }
    var a=document.createElement('a'); 
    a.href=base;

    if(url[0]==='/'){ 
        base=[]; // rooted path
    }
    else{ 
        base=a.pathname.split('/'); // relative path
        base.pop(); 
    }
    url=url.split('/');
    for(var i=0; i<url.length; ++i){
        if(url[i]==='.'){ // current directory
            continue;
        }
        if(url[i]==='..'){ // parent directory
            if('undefined'===typeof base.pop() || base.length===0){ 
                return null; // wrong url accessing non-existing parent directories
            }
        }
        else{ // child directory
            base.push(url[i]); 
        }
    }
    return a.protocol+'//'+a.hostname+base.join('/');
} 
```

如果出现问题，它将返回`null`。

用法：

```
resolveURL('./some.css', 'http://example.com/stats/2012/'); 
// returns http://example.com/stats/2012/some.css

resolveURL('extra/some.css', 'http://example.com/stats/2012/');
// returns http://example.com/stats/2012/extra/some.css

resolveURL('../../lib/slider/slider.css', 'http://example.com/stats/2012/');
// returns http://example.com/lib/slider/slider.css

resolveURL('/rootFolder/some.css', 'https://example.com/stats/2012/');
// returns https://example.com/rootFolder/some.css

resolveURL('localhost');
// returns http://localhost

resolveURL('../non_existing_file', 'example.com')
// returns null 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-05-12T18:21:35.617

我知道这是一个非常古老的问题，但你可以这样做 `(new URL(relativePath, location)).href`：

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-11-18T20:01:47.090

href 解决方案仅在加载文档后才有效（至少在 IE11 中）。这对我有用：

```
link = link || document.createElement("a");
link.href =  document.baseURI + "/../" + href;
return link.href; 
```

请参阅[https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-12-30T16:47:08.610

```
function canonicalize(url) {
    var div = document.createElement('div');
    div.innerHTML = "<a></a>";
    div.firstChild.href = url; // Ensures that the href is properly escaped
    div.innerHTML = div.innerHTML; // Run the current innerHTML back through the parser
    return div.firstChild.href;
} 
```

这也适用于 IE6，与其他一些解决方案不同（请参阅[从相对 URL 获取绝对 URL。（IE6 问题）](https://stackoverflow.com/questions/470832/getting-an-absolute-url-from-a-relative-one-ie6-issue)）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-04-04T21:20:49.067

建议和接受的解决方案不支持服务器相对 URL，也不适用于绝对 URL。例如，如果我的亲戚是 /sites/folder1 它将不起作用。

这是另一个功能，它支持完整的、服务器相对或相对 URL 以及 ../ 用于上一级。它并不完美，但涵盖了很多选择。当您的基本 URL 不是当前页面 URL 时使用此选项，否则会有更好的选择。

```
 function relativeToAbsolute(base, relative) {
    //make sure base ends with /
    if (base[base.length - 1] != '/')
        base += '/';

    //base: https://server/relative/subfolder/
    //url: https://server
    let url = base.substr(0, base.indexOf('/', base.indexOf('//') + 2));
    //baseServerRelative: /relative/subfolder/
    let baseServerRelative = base.substr(base.indexOf('/', base.indexOf('//') + 2));
    if (relative.indexOf('/') === 0)//relative is server relative
        url += relative;
    else if (relative.indexOf("://") > 0)//relative is a full url, ignore base.
        url = relative;
    else {
        while (relative.indexOf('../') === 0) {
            //remove ../ from relative
            relative = relative.substring(3);
            //remove one part from baseServerRelative. /relative/subfolder/ -> /relative/
            if (baseServerRelative !== '/') {
                let lastPartIndex = baseServerRelative.lastIndexOf('/', baseServerRelative.length - 2);
                baseServerRelative = baseServerRelative.substring(0, lastPartIndex + 1);
            }
        }
        url += baseServerRelative + relative;//relative is a relative to base.
    }

    return url;
} 
```

希望这可以帮助。JavaScript 中没有这个基本实用程序真的很令人沮丧。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-12-23T07:28:56.547

我必须为已接受的解决方案添加一个修复程序，因为我们可以在 angularjs 导航中的 # 之后添加斜杠。

```
function getAbsoluteUrl(base, relative) {
  // remove everything after #
  var hashPosition = base.indexOf('#');
  if (hashPosition > 0){
    base = base.slice(0, hashPosition);
  }

  // the rest of the function is taken from http://stackoverflow.com/a/14780463
  // http://stackoverflow.com/a/25833886 - this doesn't work in cordova
  // http://stackoverflow.com/a/14781678 - this doesn't work in cordova
  var stack = base.split("/"),
      parts = relative.split("/");
  stack.pop(); // remove current file name (or empty string)
               // (omit if "base" is the current folder without trailing slash)
  for (var i=0; i<parts.length; i++) {
    if (parts[i] == ".")
      continue;
    if (parts[i] == "..")
      stack.pop();
    else
      stack.push(parts[i]);
  }
  return stack.join("/");
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-15T12:18:51.970

[通过使用历史 API](https://developer.mozilla.org/en-US/docs/Web/API/History_API)（IE 10 或更高版本），我找到了一个非常简单的解决方案，同时仍然支持 IE 10（IE 不支持 URL-API ）。此解决方案无需任何字符串操作即可工作。

```
function resolveUrl(relativePath) {
    var originalUrl = document.location.href;
    history.replaceState(history.state, '', relativePath);
    var resolvedUrl = document.location.href;
    history.replaceState(history.state, '', originalUrl);
    return resolvedUrl;
} 
```

`history.replaceState()`不会触发浏览器导航，但仍会修改`document.location`并支持相对路径和绝对路径。

此解决方案的一个缺点是，如果您已经在使用 History-API 并设置了带有标题的自定义状态，则当前状态的标题会丢失。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-02-27T22:24:16.213

这将起作用。但仅当您打开带有文件名的页面时。当您打开这样的链接时，它将无法正常工作`stackoverflow.com/page`。它将与`stackoverflow.com/page/index.php`

```
function reltoabs(link){
    let absLink = location.href.split("/");
    let relLink = link;
    let slashesNum = link.match(/[.]{2}\//g) ? link.match(/[.]{2}\//g).length : 0;
    for(let i = 0; i < slashesNum + 1; i++){
        relLink = relLink.replace("../", "");
        absLink.pop();
    }
    absLink = absLink.join("/");
    absLink += "/" + relLink;
    return absLink;
} 
```

# wordpress - Wordpress 如果帖子或博客类别声明

> ID：14780353
> 
> 赞同：0
> 
> 时间：2013-02-08T19:56:57.600
> 
> 标签：wordpress, post, categories

在 Wordpress 上遇到了一个小问题。

我正在尝试使用 PHP 来检查我所在的页面是类别页面还是帖子页面，如果它不在任何一个页面上，它将不会做其他任何事情。

我的代码是：

```
<?php if( (!is_category($category)) || (!is_single($post)) ) { ?>

Do something...

<?php } ?> 
```

当我在没有或类别位的情况下尝试它时工作正常。当我将它们连接在一起时，代码停止工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:37:43.790

我认为您实际上要测试的是它是否不是类别**而**不是帖子。所以相应地改变你的条件：

```
if( (!is_category($category)) && (!is_single($post)) ) { 
```

# c++ - While 循环跳过所有其他输入

> ID：14780356
> 
> 赞同：1
> 
> 时间：2013-02-08T19:57:05.960
> 
> 标签：c++

我正在尝试编写一个程序，该程序将打开用户输入文件名，然后获取该文件中的名称并将它们从姓氏、名字中间名排列到名字中间名姓氏。但是，我的 while 循环正在跳过输入文件中的所有其他名称。

这是我的主要内容：

```
using namespace std;

int main() {

    string fullName;
    string lastName;
    string first_middleName;

    size_t pos;

    string fileName;
    ifstream inData;

    cout << "Please type the file name including extension(such as .txt)." << endl;
    cout << "If your file is in a different directory please specify the path:";

    getline(cin, fileName);
    inData.open(fileName.c_str());

    if(!inData) {
        cout << "Cannot open" << fileName << "." << endl;
        return 1;
    }

    getline(inData, fullName);

    while(getline(inData, fullName)) {
        pos = fullName.find(',');
        lastName = fullName.substr(0, pos);
        first_middleName = fullName.substr(pos + 2);
        cout << first_middleName << " " << lastName << endl;
        getline(inData, fullName);
    }

    inData.close();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T19:58:43.243

这是因为您每个循环读取两行

```
while(getline(inData,fullName)){
    ...
    getline(inData,fullName);       
} 
```

# java - Spring FactoryBean - 基于其他对象中的值的对象

> ID：14780358
> 
> 赞同：0
> 
> 时间：2013-02-08T19:57:17.490
> 
> 标签：java, spring

用一个愚蠢的例子来解决这个问题：

假设我创建了一个 FactoryBean 实现来创建一个 Manager 对象。

```
public class ManagerFactory implements BeanFactory<Manager> {

    // implemented methods from interface

} 
```

现在，该工厂需要获取一个名为 employeeId 的字段，以便查找员工以预填充 ManagerFactory 创建的 Manager bean 的各个字段（是的，我知道，在现实世界中，Manager 会扩展 Employee，假设我可以'不要那样做）。

那么，既然这个employeeId 字段不是常量，那么处理这个问题的唯一方法是在FactoryBean 中创建一个setEmployeeId() 方法，然后获取FactoryBean 本身，然后在调用getObject() 之前设置employeeId？

还是我没有任何意义？

杰森

# python - 是否可以在 matplotlib hexbin 图上绘制相同点的列表？

> ID：14780362
> 
> 赞同：2
> 
> 时间：2013-02-08T19:57:24.823
> 
> 标签：python, matplotlib

我有这个非常简单的代码，它绘制了一个完全相同的 100 个点 (10,10) 的列表。不幸的是，我收到了警告和空白图表。

**我的代码：**

```
import matplotlib.pyplot as plt

mylist = list()
for i in range(100):
    mylist.append(10)

def plot():

    plt.subplot(111)
    plt.hexbin(mylist,mylist,bins='log', cmap=plt.cm.YlOrRd_r)
    plt.axis([0,50,0,50])

    plt.show()

plot() 
```

**警告：** ![在此处输入图像描述](../Images/745cdc7a3e770c0476f7d087ba22f0d9.png)

1.  不能在 a 上绘制相同的数据`hexbin`吗？
2.  难道我做错了什么？

**我的具体情况：**

我知道这可能是一个奇怪的问题，但我的程序正在绘制大量的点 (x,y)（`hexbin`当然），有时这些点可能都是相同的。

如果我稍微改变上面的代码并在`list[i]`（我是任何索引）处抛出一个不同的点（x，y），代码运行良好并绘制数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:03:17.640

问题是它试图通过查看最大值和最小值`x`以及`y`值来猜测网格的限制，并在此输入的情况下使步长`sx = (x_max - x_min) / num_x_bins`严格为零。`extent`解决方案是使用关键字告诉代码使数组有多大。

```
mylist = list()
for i in range(100):
    mylist.append(10)

def plot():

    plt.subplot(111)
    plt.hexbin(mylist,mylist,bins='log', cmap=plt.cm.YlOrRd_r, extent=[0, 50, 0, 50])
    plt.axis([0,50,0,50])

    plt.show()

plot() 
```

有一个 PR 可以解决这个问题（应该在 1.4 [https://github.com/matplotlib/matplotlib/pull/3038](https://github.com/matplotlib/matplotlib/pull/3038)中）

与此同时，我会使用类似的东西（未经测试，这里可能有一些微不足道的错误）：

```
import matplotlib.transfroms as mtrans
def safe_hexbin(ax, x, y, *args, **kwargs):
      if 'extent' not in kwargs:
          xmin = np.amin(x)
          xmax = np.amax(x)
          ymin = np.amin(y)
          ymax = np.amax(y)
          # to avoid issues with singular data, expand the min/max pairs
          xmin, xmax = mtrans.nonsingular(xmin, xmax, expander=0.1)
          ymin, ymax = mtrans.nonsingular(ymin, ymax, expander=0.1)
          kwargs['extent'] = (xmin, xmax, ymin, ymax)
      return ax.hexbin(x, y, *args, **kwargs)

safe_hexbin(plt.gca(), x, y, ...) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-08T20:16:42.943

我看到你正在做的事情有几个问题：

1.  对日志值使用零
2.  你的`myList`值都是 10
3.  可能没有`hexbins`为您的用例提供所有必要的输入

所以我得到这个输出：

```
import numpy as np
import matplotlib.pyplot as plt
x = np.logspace(-1, 2)
y = np.logspace(-1, 2)
x = np.hstack([x, x])  # duplicate all points
y = np.hstack([y, y])  # duplicate all points
xx, yy = np.meshgrid(x,y)
C = xx**2 + 10./yy**2
fig, ax = plt.subplots()
ax.hexbin(x, y, C, bins='log', cmap=plt.cm.YlOrRd_r)
plt.show() 
```

# javascript - 为什么这个循环不会产生我想要的结果？

> ID：14780365
> 
> 赞同：2
> 
> 时间：2013-02-08T19:57:33.700
> 
> 标签：javascript, jquery, coffeescript

期望的结果：

```
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12] 
```

我的循环：

```
arr = []
n = 0; b = 0
while b < 2
  while n < 12
    arr.push n
    n++
  b++
return arr 
```

实际结果 ：

```
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T19:59:22.810

`n`在内部循环中完成后将的值重新初始化为 0：

```
arr = []
n = 0; b = 0
while b < 2
  while n < 12
    arr.push n
    n++
  n = 0         // <------ Added this
  b++
return arr 
```

这样，每个外部迭代都有一个“新”值`n`。

尽管有了这个，我得到的值是 0 到 11，而不是你想的 1 到 12。所以我会把它修改成这个（用真正的JS）：

```
function test() {
    var arr = [];
    var n = 1;
    var b = 0;
    while (b < 2) {
        while (n <= 12) {
            arr.push(n);
            n++;
        }
        n = 1;
        b++;
    }
    return arr;
} 
```

但正如@Blender 指出的那样，因为你实际上只是在模拟一个`for`循环，所以使用一个！：

```
function test2() {
    var arr = [];
    for (var b = 0; b < 2; b++) {
        for (var n = 1; n <= 12; n++) {
            arr.push(n);
        }
    }
    return arr;
} 
```

# php - PHP - 复杂的正则表达式提取

> ID：14780367
> 
> 赞同：0
> 
> 时间：2013-02-08T19:57:40.140
> 
> 标签：php, regex, preg-match-all

我有一些字符串要解析，它变得有点复杂了。

```
<?php
$notecomments = '
This is the first of the notes, and so whatever comes later is appended.<br>
(<b>John Smith</b>) at <b class="datetimeGMT">2012-02-07 00:00:20 GMT</b><hr>This is a comment posted<br><br>(<b>Alex Boom</b>) at <b class="datetimeGMT">2013-02-07 00:08:06 GMT</b><hr>And let's put some more in here<br />with a new line.';

if(preg_match_all('/\(<b>(?:(?!\(<b>).)*/s', $notecomments, $matches)){
print_r($matches);
}

/* result of code:
Array
(
    [0] => Array
        (
            [0] => (<b>John Smith</b>) at <b class="datetimeGMT">2012-02-07 00:00:20 GMT</b><hr>This is a comment posted<br><br>
            [1] => (<b>Alex Boom</b>) at <b class="datetimeGMT">2013-02-07 00:08:06 GMT</b><hr>And let's put some more in here<br />with a new line.
        )

)
*/
?> 
```

我可以循环浏览“附加”注释，因为我在`preg_match_all`正则表达式规则中有要使用的指标。

但是，我的许多笔记在我的`preg_match_all`. （在这种情况下：“这是第一个注释，所以后面的内容都会被附加。
”）

**我的第一个目标实现了。** 这是我上面的代码的结果。我正在提取第一个注释的附加注释。

**我的下一个目标**是在第一次迭代之前检测到任何东西。这就是我卡住的地方。（在我上面的正则表达式语句中，在第一次迭代之前检测到任何东西）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:06:03.510

我为此使用带有两个正则表达式的 preg_replace_callback

```
 $notecomments = "This is the first of the notes, and so whatever comes later is appended.<br>(<b>John Smith</b>) at <b class=\"datetimeGMT\">2012-02-07 00:00:20 GMT</b><hr>This is a comment posted<br><br>(<b>Alex Boom</b>) at <b class=\"datetimeGMT\">2013-02-07 00:08:06 GMT</b><hr>And let's put some more in here<br />with a new line.";
 $output=preg_replace_callback(array("~<b (.*?)>(.+?)</b>~si","~<b>(.+?)</b>~si"),function($matches){
if(isset($matches[2])){
  print_r($matches[2]."\n");
}else{
  print_r($matches[1]."\n");
}
return '';},' '.$notecomments.' '); 
```

输出：

```
 2012-02-07 00:00:20 GMT
 2013-02-07 00:08:06 GMT
 John Smith
 Alex Boom 
```

# bash - 比较 $var

> ID：14780372
> 
> 赞同：0
> 
> 时间：2013-02-08T19:57:57.330
> 
> 标签：bash, if-statement, var

我有一个测试脚本，需要读取变量“LAB”并通过电子邮件发送正确的公司。我已经看过但找不到任何有效的东西。

有什么想法吗？

```
#!
#
LAB=3
#
if [ "$LAB" = "$1" ];then
    echo "Got Zumbrota" && ./mailZ 
fi
#
if [ "$LAB" = "$2" ];then
    echo "Got Barron" && ./mailB 
fi
#
if [ "$LAB" = "$3" ];then
    echo "Got Stearns" && ./mailS
fi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:03:03.767

如果这是一个 bash 脚本，请使用

```
#!/bin/bash 
```

并`-eq`用于整数比较，因为 LAB 是脚本中的整数

```
if [ $LAB -eq $1 ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T21:40:34.753

这些级联 if 语句可以压缩为 case 语句：

```
case "$LAB" in
1)  echo "Got Zumbrota" && ./mailZ 
    ;;
2)  echo "Got Barron" && ./mailB 
    ;;
3)  echo "Got Stearns" && ./mailS
    ;;
*)  echo "don't know what to do with $LAB"
    ;;
esac 
```

# python - 将不同的“模式”放入同一个 MongoDB 集合中

> ID：14780381
> 
> 赞同：0
> 
> 时间：2013-02-08T19:58:59.887
> 
> 标签：python, performance, mongodb

TLDR；将两种不同类型的文档放在同一个集合中以节省到数据库的往返行程是否有缺点？

所以我有孩子的文档，以及父母中引用孩子的键列表，几乎每当我们想要父母时，我们也希望孩子们一起来。最简单的方法是获取父节点，然后使用带有 $IN 的子键列表获取子节点（在 SQL 中，我们将使用连接）。但是，这意味着为相当频繁的操作进行 2 次往返。我们有几个选项可以改进这一点，特别是因为我们可以在检索父键的同时检索子键：

1.  将孩子放在父文档中

    虽然这会发挥 mongo 的优势，但我们也希望保持这些数据标准化

2.  线程中的管道数据库请求

    一旦我们将连接池考虑在内，这可能会或可能不会提高性能。这也意味着在 python 应用程序中处理线程，这并不可怕，但也不是很好。

3.  将父/子文档保存在同一个集合中（不嵌入）

    这样我们就可以一次查询所有的键；这确实意味着包装器中用于访问数据库的一些概念开销，并强制所有索引都是稀疏的，但否则看起来很简单。

我们可以分析所有这些选项，但尽管没有在网上找到任何东西，但确实感觉那里的人应该已经有了这方面的经验。那么，我的分析中是否遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:41:22.193

我将分别讨论这三点。您应该知道，这绝对取决于哪种情况最有效。没有“理论上正确”的答案，因为它取决于您的数据存储/访问模式。

1.  关于如何存储数据始终是一个相当复杂的决定。我认为主要规则应该是“我如何查询我的数据？”，而不是“我们希望所有数据都标准化”。数据规范化是您为关系数据库而不是 MongoDB 所做的事情。如果您几乎总是与父项一起查询子项，并且您没有未绑定的子项列表，那么您应该这样存储它们。请注意，MongoDB 中的文档限制为 16MB（这比您想象的要多得多）。

2.  避免穿线。您最好从两个不同的集合中依次运行两个查询。不太复杂是一件好事！

3.  这可行，但这是一种相当丑陋的方式。但话又说回来，丑陋并不总是一件坏事，如果它能让事情进展得更快。当然，我不太清楚您的父文档和子文档有多不同，因此很难说这是否是一个好的解决方案。一个稀疏索引，我假设您将根据它是父还是子在特定字段上执行，这是一个好主意。但也许您也可以使用一个索引。在您展示建议的架构后，我很乐意更新您的答案。

我建议您进行一些基准测试，但忘记选项 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T09:40:31.980

如果层次结构中有更多级别（对于一个级别也可以正常工作），那么拥有一组祖先是一个不错的选择。这是一种不是我发明的技巧，当然它在 mongodb 开发人员课程中进行了解释：[https](https://education.10gen.com/courses) ://education.10gen.com/courses （这只是一个链接，您可以在其中找到我无法链接到的诅咒教程直接）。在这种情况下，您有一个 id 数组，其中至少包含节点本身和所有祖先 id。如果您查询子树，您只需在祖先数组中搜索根。

这些文件包含：

```
{ancestors: [2,7,6]} 
```

您查询节点 6 下的子树：

```
find({ancestors:6}) 
```

这很好，但在现实世界的示例中，您通常不会查询 id。因此，您将有两个查询，一个用于有意义的事物，一个用于 id 属于该事物的查询。

但是，如果您在第一步查询 id，则此解决方案可以解决您的问题。

我认为由于 mongodb 很多事情都取决于父子关系的结构。如果只有一个级别的沿袭，则没有真正特别的理由单独存储数据，在这种情况下，丑陋的方式是不错的选择，甚至如果您可能对其进行复杂的查询（和索引），请使用非规范化.

（您实际上没有机会查询父母的某些特征并在同一个查询中检索孩子而不进行反规范化/嵌入），但仅当您有很少的连接时才嵌入，并且仅当您不复制大量数据时才进行非规范化。如果您将子 id 存储在一个数组中（并对其进行索引），这两个查询的性能不会那么糟糕，与保持非规范化数据的清洁或使用嵌入处理 16MB 限制相比，这并不是一个坏主意。

# r - 用于对一个向量的元素应用运算的语法（和/或函数），使用第二个向量的 arg 元素

> ID：14780383
> 
> 赞同：1
> 
> 时间：2013-02-08T19:59:05.753
> 
> 标签：r, syntax, apply

我试图通过对向量应用操作，以向量化的方式使用*第二个*向量的元素来找到创建向量结果的正确表达式。用例是我有一个原始值向量和一个断点向量。我想要的是一个表达式，它将给我一个结果，即在断点上对值向量中的值应用逻辑运算的总和。换句话说：

鉴于：

```
rawfoo <- c(30, 4, 22, 77, 1,169, 10)
breaksfoo <- c(10,50, 80)
resultfoo <- data.frame(breaks=breaksfoo, matching=numeric(length(breaksfoo))) 
```

我想编写一个*表达式*，为 resultfoo$matching 提供列值，即：对于 breakfoo 中的每个值，sum(rawfoo > breaksfoo[i])，

```
resultfoo
  breaks nmatching
1     10         3
2     50         2
3     80         1 
```

我一直在尝试各种形式的 apply 并且在如何表达功能方面遇到了问题。也许我在叫错树？如果需要，可以提供多个故障演示。（但我的猜测是这个问题非常简单，不需要错误消息来消除歧义；-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:07:23.743

您可以分三个步骤完成：

1.  编写一个函数，给定一个中断，返回一个包含两个元素的列表：中断本身和`sum(break > rawfoo)`.

2.  比您可以使用`sapply`将此功能应用于`breaksfoo`.

3.  最后，您需要转换 的结果`sapply`，它是一个矩阵，以获得您需要的数据框。

以下代码在一个语句中完成所有这三个步骤：

```
 as.data.frame(t(sapply(breaksfoo, 
                        function(x) list(breaks = x, nmatching = sum(x > rawfoo))))) 
```

返回

```
 breaks nmatching
1     10         2
2     50         5
3     80         6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:18:58.957

结合可能会得到你想要的东西`findInterval`。`table`

```
#finds which interval rawfoo is in
x <- findInterval(rawfoo,breaksfoo)
#[1] 1 0 1 2 0 3 1
#tabulates the information
table(x)
#0 1 2 3 
#2 3 1 1 
#cuts off the last element
head(table(x),-1)
#0 1 2 
#2 3 1 
resultfoo$nmatching <- head(table(x),-1) 
```

这*几乎*是您想要的，除了`10`被放置在第二个存储桶中，因为`findInterval`' 的间隔包含在较低端，而您的示例将它放在第一个存储桶中，因为您想要一个严格的不等式。您可以添加一个校正向量，该向量将重新分配给正确的存储桶：

```
y <- table(rawfoo)[as.character(breaksfoo)]
y[is.na(y)] <- 0
y <- y - c(0,head(y,-1))
resultfoo$nmatching <- resultfoo$nmatching + y 
```

为了使这更容易，您可以将其包装到一个函数中。

```
fnfoo <- function(raw,breaks) {
  x <- head(table(findInterval(rawfoo,breaksfoo)),-1)
  y <- table(rawfoo)[as.character(breaksfoo)]
  y[is.na(y)] <- 0
  x + y - c(0,head(y,-1))
}
resultfoo$nmatching <- fnfoo(rawfoo,breaksfoo) 
```

**编辑：**我正在浏览另一个问题，并意识到`cut`在这里效果更好。

```
data.frame(table(cut(rawfoo,c(-Inf,breaksfoo),right=TRUE)))
#        Var1 Freq
# 1 (-Inf,10]    3
# 2   (10,50]    2
# 3   (50,80]    1 
```

# javascript - 使用 Javascript 验证单选按钮

> ID：14780387
> 
> 赞同：3
> 
> 时间：2013-02-08T19:59:24.400
> 
> 标签：javascript, radio-button, validation

我已经在这里梳理了很多页面，但仍然无法让我的显式验证器工作。基本上，当单击提交按钮时，我希望脚本验证一个单选是否被选中，如果一个被选中则什么都不做。如果未选中，我希望它发布一条警报消息。

大致我的html看起来像：

```
<form id="myForm" onsubmit = "check()">
<input type = "radio" name = "c" id = "1" value = "1" />
<input type = "radio" name = "c" id = "2" value = "2" />
<input type = "radio" name = "c" id = "3" value = "3" />

<input type = "submit" value = "Submit" /> 
```

* * *

我的 JS 页面如下所示：

```
function check() {
    var r = document.getElementsByName("c")
    var c = 0

    for(var i=0; i < r.length; i++){
       if(c[i].checked) {
          c = i; }
    }

    alert("please select radio");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:03:35.100

试试这个

```
function check() {
var r = document.getElementsByName("c")
var c = -1

for(var i=0; i < r.length; i++){
   if(r[i].checked) {
      c = i; 
   }
}
if (c == -1) alert("please select radio");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:01:54.380

这个

```
c[i].check 
```

应该

```
c[i].checked 
```

你实际上并没有对结果做任何事情，你只是一直在警觉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:52:27.950

```
<html>
<head>
<script language="javascript">
function check()    {

chosen = ""
len = document.myform.chk.length

for (i = 0; i <len; i++) {
if (document.myform.chk[i].checked) {
chosen = document.myform.chk[i].value
}
}

if (chosen == "") {
alert("No Option selected");
return false;
}
else {
alert("option selected");
return true;
}
}
</script>
</head>
<body>
<form name="myform" onsubmit = "return check();">
<input type = "radio" name = "chk" id = "1" value = "1" >
<input type = "radio" name = "chk" id = "2" value = "2" >
<input type = "radio" name = "chk" id = "3" value = "3" >

<input type="submit" value="submit">

</form>
</body>
</html> 
```

检查此验证希望它也可以帮助您。[还要在jsfiddle](http://jsfiddle.net/FUQDL/)中检查它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-31T10:45:19.507

```
 function ShowMsg() {    

             if (fnSpeciality() == false) 
              {
              document.getElementById("myform").focus();
               return false;
            }

                function fnSpeciality() 
                {
             return fnRblfnSpeciality();
                 }
              function fnSpeciality() {
                   return fnRblfnSpeciality();
                          }

    function fnRblfnSpeciality() {

        var list = document.getElementById('myform'); //Client ID of the radiolist
        var inputs = list.getElementsByTagName("input");
        var isItemChecked = false;
        for (var i = 0; i < inputs.length; i++) {
            var listItem = inputs[i];

            if (listItem.checked) {
                //alert(listItem.value);
                isItemChecked = true;
                break;
            }
        }
     if (isItemChecked == false) {
            if (isItemChecked =="") {
                alert('Please select a speciality.');
                return false;
            }
            // else return true;
        }
        return true;
    } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-10-07T09:20:01.787

信用卡借记卡现金

```
 </td>
            </tr> 
```

我正在使用单选按钮列表..请分享是否对此单选按钮进行 java 脚本验证

# android - 阻止图书馆访问

> ID：14780388
> 
> 赞同：2
> 
> 时间：2013-02-08T19:59:26.540
> 
> 标签：android, jar

我的项目中有一个我不信任的库。我不想反编译它并查看代码。有没有办法防止它继承清单文件中的所有权限（例如，互联网访问）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:52:44.793

没有办法做到 没有办法做到

# api - API - 如何以编程方式合并 .VersionControlServer.GetMergeCandidates 返回的合并候选列表？

> ID：14780389
> 
> 赞同：0
> 
> 时间：2013-02-08T19:59:26.353
> 
> 标签：api, tfs

我正在创建默认合并窗口的克隆，以添加功能。

我已经在下面的命令的网格中有一个合并候选人：

```
 MergeCandidate[] candidates = tfs.GetMergeCandidates(edtSelectedSource.Text, cbxTargetBranchs.Text); 
```

现在，用户选择了 1 个或多个候选者，我需要合并它们。

但是 TFS API VersionControl.Merge 需要源路径和目标路径。

首先，我的问题是，我需要逐个迭代每个候选并合并其变更集的每个文件？其次，我如何从变更集中获取目标路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T23:09:48.550

首先，我已经使用 TFS API 进行了大量编程，但是我永远不会盲目相信自动化的合并。合并冲突最好由人来处理。是的，这很痛苦，并且在许多情况下可以自动化，但在许多其他情况下 - 事情可能会出错。在生产分支上执行此操作之前，我会三思而后行。

以下是一些应该有所帮助的提示：

您需要创建一个临时工作区。工作区是一切发生的沙箱。工作区可以有文件，因此可以有与之关联的文件位置。工作区项目具有丰富的元数据。

查看 Workspace 和 WorkspaceInfo 类。

然后看一下工作区客户端：

[http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.item.aspx](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.item.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T23:37:44.727

只要变更集是连续的，您就可以在一次合并调用中完成。如果它们不连续，则需要为每个连续块提交 n 次合并。假设他们选择变更集 10、15 和 20，并且这些变更集是连续的（即在该范围内没有其他候选者），那么您将提交 versionFrom 为 10 和 versionTo 为 20 的合并。

就路径而言，您希望使用传递给 QueryMergeCandidates 的路径，并且还需要指定完整的递归类型。

# jquery-mobile - jquery mobile中的对话框关闭事件

> ID：14780391
> 
> 赞同：6
> 
> 时间：2013-02-08T19:59:28.503
> 
> 标签：jquery-mobile, dialog, event-handling

我正在使用 jquery mobile 和一个对话框来显示一些多个选择框。一些内容是使用 Ajax 根据选择动态创建的。我想在对话框关闭时（通过常规 x 按钮）进行 Ajax 调用。html 的主要部分如下所示：

```
 <a href="#queryPage" data-rel="dialog"  data-transition="slidedown"  >Filter Results</a>
    <div data-role="page" id="queryPage" data-theme="a">
    <div data-role="header" data-theme="a">
    <h1>Select Filters</h1>
    </div>
    <div data-role="content">
    <form action="" method="get" id="filterForm">
    <fieldset id ="filterFields"></fieldset>
    </form>
    </div>
    </div> 
```

我目前正在通过在页面隐藏上运行代码来拨打电话，如下所示： `$('#queryPage').live('pagehide', function(event) { //code for ajax call });`

但是，我想在对话框关闭时进行调用，因为某些选择列表很大，并且即使对话框尚未关闭，它们也会创建一个隐藏 queryPage 的新页面。我努力了：

```
 $('#queryPage').bind('dialogclose', function(event) {
         alert('closed');
     }); 
```

也试过

```
 $('#queryPage').dialog({close:function(event, ui){
        alert("closed");
    }}); 
```

这些我已经放入了一个在页面加载时调用的函数，但是当对话框关闭时不会显示警报。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T20:20:51.483

对话框没有特定的事件，因为它们只是显示为对话框的页面。试试这个`pagehide`事件。

```
$("#MyDialog").bind("pagehide",function(){
  alert("Dialog closed");
}); 
```

此外，您的示例代码的第一行有一个链接，该链接位于`<div data-role="page">`不应执行的 a 之外。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-05T17:11:57.327

Pagehide 可以这样委派：

```
$(document).delegate("#MyDialog", "pagehide", function() {
  alert("Dialog closed");
}); 
```

您还可以访问调用页面的屏幕元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-11T05:31:28.037

Andleer 分享了使用 jquery 关闭对话框的适当事件。但是，我们也可以用这种方式编码。

```
 $(document).on("pagehide","#Dialog",function(){
        console.log('Dialog has closed.');
    }); 
```

# highcharts - 如何在 x/y 轴上显示十六进制值？

> ID：14780392
> 
> 赞同：0
> 
> 时间：2013-02-08T19:59:29.813
> 
> 标签：highcharts

在 highcharts 中是否有一种简单的方法可以在 x/y 轴上显示十六进制值而不是十进制值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T12:20:48.133

您还可以使用 formatter() 映射您的值[http://api.highcharts.com/highcharts#xAxis.labels.formatter](http://api.highcharts.com/highcharts#xAxis.labels.formatter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:06:27.673

由于您必须告诉 highcharts 在轴上显示哪些类别，因此您必须先将小数转换为十六进制：

```
var cat = [100,200,300,400,500,600,700,800,900,1000,1100,1200];
var hexValues = $.map(cat,function(cat){
  return cat.toString(16);
}); 
```

然后将它们分配给轴：

```
 xAxis: {
        categories: hexValues
    }, 
```

# playframework - 如何在 Play 2.0 Scala 二进制发行版中添加自述文件以外的文档？

> ID：14780393
> 
> 赞同：2
> 
> 时间：2013-02-08T19:59:34.120
> 
> 标签：playframework, playframework-2.0

在 Play Framework 2.0 Scala 中，它会自动将 README 添加到二进制文件中。如何添加其他文档？例如，我也有一个我想要包含的 HOWTO.develop 文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:32:29.810

实际上，`dist`任务非常有限。

它只需要依赖项 (JAR)、`start`脚本、配置文件和`README`文件，因此如果生成的 zip.xml 文件，则没有简单的方法可以添加其他内容。（[来源](https://github.com/playframework/Play20/blob/2.1.0/framework/src/sbt-plugin/src/main/scala/PlayCommands.scala#L240)）

# scripting - 在 VUser 脚本中编写 Java 或 C 脚本以在 Ajax 中操作 Web 应用程序

> ID：14780394
> 
> 赞同：0
> 
> 时间：2013-02-08T19:59:37.863
> 
> 标签：scripting, client-side, loadrunner

我想知道是否可以在 vuser 录制的脚本中编写脚本（使用 C 或 Java）*来*控制/操作元素，使用 Ajax 在 Web 应用程序/页面上单击单选按钮等并处于测试状态？

问题是，当针对使用 Ajax 实现的 Web 应用程序运行 vuser 脚本时，我需要操作页面元素以使脚本进一步运行（使用 http-protocol），并且因为 http-protocol 专注于记录 http-traffic，如Web 请求和响应在录制期间不会捕获带有“隐藏”单选按钮菜单的操作/客户端行为。

我希望有人知道/做过这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T21:01:28.637

您可以使用 C 轻松完成此操作，因为 WEB/HTML LoadRunner 脚本是在 C 中编译和运行的。您可以编写任意数量的自定义函数，并在整个脚本中随意调用它们。将最初的录音视为一个起点，然后开始。

从技术上讲，您也可以使用 JAVA 执行此操作，但您必须创建一个空的 JAVA 用户脚本并手动编写整个代码。我在处理 JAVA 服务测试方面做过类似的工作，但这并不适合胆小的人。

# html - 活动链接 wordpress

> ID：14780395
> 
> 赞同：0
> 
> 时间：2013-02-08T19:59:41.703
> 
> 标签：html, css, wordpress, navigation

我正在为客户开发一个 wordpress 网站。我有导航工作，当他们将鼠标悬停在导航上时，他们将获得绿色背景。对于每个链接导航项都是如此。

我还希望所选页面具有相同的背景，以便网站的访问者知道他当前在哪里。

到目前为止我所拥有的：

WordPress：

```
<div id="nav">  
   <?php wp_nav_menu ( array ('theme_location' => 'header-nav','container' => false)); ?>
</div> 
```

CSS：

```
#nav {
    /*float:right;*/
    float:left;
    height:6em;
    /*width:560px;*/
    /*width:612px;*/
    width:710px;
    /*background:#525252;*/
}

#nav ul {
    list-style:none;
}
#nav li a{
    width:80px;
    text-align:center;
}
#nav li a {
    text-decoration:none;
    float:left;
    padding:3.4em 0.4em 0 0;
    position:relative;
    right:-1em;
    /*left:6em;*/
    color:#fff;
    height:2.1em;
}
#nav li a:hover{
    color:#333;
    /*background:#60b5b2;*/
    background:#69dc37;
    font-weight:bold;
}
#nav li a:active {
    color:#fff;
    background:#69dc37;
} 
```

我在网上搜索，发现[一篇关于菜单突出显示的帖子](http://codex.wordpress.org/Dynamic_Menu_Highlighting)。我试过了，但没有奏效。

我需要一些建议/帮助才能使活动链接（后台）正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:06:13.743

请在您的 CSS 代码中将背景更正为背景颜色：

```
#nav li a:hover{
    color:#333;
    /*background:#60b5b2;*/
    background-color:#69dc37;
    font-weight:bold;
}

#nav li a:active {
    color:#fff;
    background-color:#69dc37;
} 
```

# python - {% load url from future %} 和命名空间如何在 Django 中工作？

> ID：14780399
> 
> 赞同：0
> 
> 时间：2013-02-08T19:59:52.320
> 
> 标签：python, django, url, dynamic, future

**有人可以向我展示{% load url from future %}**和**命名空间**概念如何工作的示例（加上一个小解释）吗？

我是 python 和 django 的新手，我需要学习如何不制作硬编码的 url，以及如何使用其他函数，如 reverse()。

这是我正在尝试做的一个例子：

**网址.py**

```
urlpatterns = patterns('',
    """
      This one is what i did first but works with hardcoded url inside 
      top-navigator.html:
      url(r'^books/$', 'books.views.book_index'),

      The next one is what i'm trying to do:
      (but of course is not correct)
    """
    url(r'^books/$', include('books.views.book_index', namespace='books')),
) 
```

* * *

**顶部导航器.html**

当我尝试运行服务器时显示错误：

> 渲染时捕获 ImportError：没有名为 book_index 的模块

```
{% load url from future %}

<div class="navbar-inner">
<ul class="nav">
    <li class="active"><a href="/">Home</a></li>
    <li><a href="{% url 'books:book_index' %}">Books</a></li>
    <li><a href="/authors">Authors</a></li>
    <li><a href="/publishers">Publishers</a></li>
    <li><a href="/contact">Contact</a></li>
</ul>
</div> 
```

我该怎么做才能对所有链接做类似的事情？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:13:31.043

要使用命名空间和`include`语句，您*必须*在其中导入另一个 urls.py 文件`patterns`。

你不能`include`像你在这里所做的那样只是一个视图。

将您的代码更改为

```
{% url 'book_index' %}"

url(r'^books/$', 'books.views.book_index', name='books')) 
```

或者为了说明目的使用命名空间：

```
more_patterns = patterns('',
    url(r'^$', 'book.views.book_index', name='book_index')),
)

urlpatterns = patterns('',
    url(r'^books/', include(more_patterns, namespace='books')),
                            #^^^^^^^ note you would normally use a string that points
                            #        to a python file containing urls.
)

{% url 'books:book_index' %} will now resolve. 
```

# scheme - 方案替代模型

> ID：14780400
> 
> 赞同：0
> 
> 时间：2013-02-08T19:59:54.043
> 
> 标签：scheme, racket

对于程序：

```
(define (double fn) (lambda (x) (fn (fn x)))) 
```

调用时：

```
(((double (double double)) 1+) 0) 
```

这个对吗：

```
(double (lambda (x) (double (double x) 1+) 0))
        ((lambda (x) (double^4 x) 1+) 0)
                ((double^4 1+) 0)
                 (16+ 0)
                    16 
```

同样，在调用时：

```
(((((double double) double) double) 1+) 0) 
```

这个对吗：

```
(((double double (double double) double) 1+) 0)
  (double (double (lambda (x) (double (double x) 1+) 0)))
    (double (lambda (x) (double^4 1+) 0))
            ((lambda (x) (double^16 x) 1+) 0)
                         ((double^16 1+) 0)
                              (256+ 0)
                                256 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:19:10.550

我会推荐 DrRacket 中的步进器。它允许您一次显示一个步骤。它甚至可以让你回去。

![在此处输入图像描述](../Images/211053f9914598952d388a7fbd508f86.png)

首先我选择了语言“HTDP: Advanced with lambda”。然后我进入了这个程序：

```
(define (double fn) 
  (lambda (x) (fn (fn x))))

(((double (double double)) add1) 0) 
```

最后我点击了步进按钮。

# perl - 删除“重复”公式

> ID：14780410
> 
> 赞同：0
> 
> 时间：2013-02-08T20:00:46.310
> 
> 标签：perl, duplicate-removal

我制作了一个程序，它将接收 5 个数字，并将使用前四个来获取第五个数字作为解决方案。解只能包含正整数，并且唯一可接受的运算符是“+ - * /”。有 11 种不同的方式可以用括号排列数字和运算符。例如 "(n @ n) @ n @ n" 其中 n 代表数字，@ 代表运算符。

我找到所有解决方案都没有问题，我的问题是删除“重复项”。我已经能够使用删除大多数重复项

```
%Seen = ();
@solutions = grep { ! $Seen{ $_ }++ } @solutions; 
```

但是我无法找到删除“重复”公式的方法。

在删除第一个重复项后，使用 21 14 2 7 获得 34 为我们提供了 4 个解决方案。他们来了

```
21/7=3; 14+3=17; 2*17=34
21/7=3; 3+14=17; 2*17=34
21/7=3; 3+14=17; 17*2=34
21/7=3; 14+3=17; 17*2=34 
```

我的老师认为这些在数学上是相同的，因此所有四个都只是一种解决方案。我不知道该怎么做是找到这些“重复”并删除它们。任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:07:12.077

例如，对于交换运算，只考虑`x @ y`where `x <= y`。这种方式，`2 * 17`是可能的，但`17 * 2`不是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T20:29:43.970

您使用的重复数据删除代码的更通用形式是

```
grep !$seen{key($_)}++, ... 
```

在这种情况下，`key`将是

```
sub key {
   ( my $key = $_[0] ) =~ s/(\d+)([*+])(\d+)/ $1 < $3 ? "$1$2$3" : "$3$2$1" /eg;
   return $key;
} 
```

在您的情况下，您可能想先简单地标准化您的输入

```
sub normalise(_) {
   ( my $s = $_[0] ) =~ s/(\d+)([*+])(\d+)/ $1 < $3 ? "$1$2$3" : "$3$2$1" /eg;
   return $s;
}

@solutions = grep !$seen{$_}++, map normalise, @solutions; 
```

# javascript - 我的反 xss 功能安全吗？

> ID：14780412
> 
> 赞同：2
> 
> 时间：2013-02-08T20:00:59.127
> 
> 标签：javascript, security, filter, xss

我的网站上有一些 javascript 函数，但我不知道使用它们是否安全。

这是我的代码：

```
// works like PHP's $_GET
function get(name){
    name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    regexS="[\\?&]"+name+"=([^&#]*)";
    regex=new RegExp(regexS);
    results=regex.exec(window.location.href);
    if(results==null)
        return '';
    return results[1];
}

// and here is my anti xss filter
var param = unescape(decodeURI(get("q")));
param = param.replace(/<(.*?)>/gi, "");
someElement.innerHTML = param; 
```

是否可以绕过此过滤器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T05:00:17.833

不要试图在进入您的应用程序的过程中找到 XSS。您的程序可能会在内部转换数据，以使您创建的任何过滤器都可能是可绕过的。

*取而代之的是，在应用程序输出*的过程中应用适当的 HTML 编码数据。这样你就可以避免漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:00:25.550

不，但是如果您在倒数第二行中模拟多行模式，如下所示：

```
param = param.replace(/<([\s\S]*?)>/gi, ""); 
```

您的示例代码将是安全的。您的示例代码中最大的缺陷是`innerHTML`在您根本不想添加 HTML 时使用。因此，`innerHTML`您应该使用并尝试过滤掉 HTML，而不是使用和尝试过滤掉 HTML ，这样[`createTextNode`](https://developer.mozilla.org/de/docs/DOM/document.createTextNode)您就不必再担心 XSS。因此，如果您喜欢，请保留您的`get`函数，并使用如下参数值（改编自 MDN）：

```
var param = unescape(decodeURI(get("q")));
var text  = document.createTextNode(param);
document.getElementById(someElement).appendChild(newtext); 
```

如果你使用 jQuery，你可以使用[`.text()`](http://api.jquery.com/text/#text2)函数，它本身使用`createTextNode`.

# python - 类分布错误

> ID：14780414
> 
> 赞同：0
> 
> 时间：2013-02-08T20:01:25.560
> 
> 标签：python, python-3.x

这是课程：

```
class Player:
    #variables
    hand = []
    name = 'Test Player'
    #functions
    def take(self, card): #allows player to take a card
        self.hand.append(card)
    def __str__(self):
        msg = self.name
        if len(self.hand) > 0:
            msg = msg + "\nIn hand:"
            for card in self.hand:
                msg = msg + ' ' + card.short_name
        return msg 
```

这是功能：

```
def deal(players):
    deck = Deck.generate_deck()
    if len(players) <= 4:
        for player in players:
            for cards in range (0, 7):
                card = random.choice(deck)
                player.take(card)
                deck.remove(card)
    else:
        for player in players:
            for cards in range (0, 5):
                card = random.choice(deck)
                player.take(card)
                deck.remove(card)
    return deck 
```

这是问题所在。当我调用函数向五个玩家发牌时，这就是我得到的。

```
Player 1
In hand: JC 2H KD 8H QD KH AS 10S QC 10H AH 6S JD 4H 5S 4S 9C 3C QH 9S AD 6D 8S 10C 7C
25

Player 2
In hand: JC 2H KD 8H QD KH AS 10S QC 10H AH 6S JD 4H 5S 4S 9C 3C QH 9S AD 6D 8S 10C 7C
25

Player 3
In hand: JC 2H KD 8H QD KH AS 10S QC 10H AH 6S JD 4H 5S 4S 9C 3C QH 9S AD 6D 8S 10C 7C
25

Player 4
In hand: JC 2H KD 8H QD KH AS 10S QC 10H AH 6S JD 4H 5S 4S 9C 3C QH 9S AD 6D 8S 10C 7C
25

Player 5
In hand: JC 2H KD 8H QD KH AS 10S QC 10H AH 6S JD 4H 5S 4S 9C 3C QH 9S AD 6D 8S 10C 7C
25 
```

ps 之后的数字是我测试代码中的一个小调试，没有影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:03:28.573

您的问题是您的`hand = []`清单附在班级上；它是一个类属性并在实例之间共享。

为方法中的每个玩家创建一个新列表`__init__`：

```
class Player:
    def __init__(self):
        self.hand = [] 
```

# java - 在没有 Random 库的情况下获取随机数

> ID：14780416
> 
> 赞同：-4
> 
> 时间：2013-02-08T20:01:34.193
> 
> 标签：java, dll, random

我想在我给出的范围内获得随机数，但我不想使用 Java 的随机库或任何我必须初始化的东西。

有谁知道在不使用 java 库的情况下获取随机数的另一种方法？

谢谢

编辑：您如何看待这个解决方案？

```
 int random = i + (int)(System.currentTimeMillis()%((j - i) + 1)); 
```

其中 i 和 j 是范围

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:04:09.060

您必须实现自己的伪随机数生成算法，这实际上是在重新发明轮子，而且不安全！

另一种解决方案是使用生成真正随机数的服务，[例如 Random.org](http://www.random.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:08:54.957

我了解到生成最多随机数的最佳方法是使用 Mersenne Twister 随机数生成器。该生成器将为您提供足够的随机数，无需重新设置种子，它的周期为 (2^19937) - 1

这是 MerseenTwister 的源代码

[https://java2s.com/Open-Source/Java/Natural-Language-Processing/MorphAdorner/edu/northwestern/at/utils/math/randomnumbers/MersenneTwister.java.htm](https://java2s.com/Open-Source/Java/Natural-Language-Processing/MorphAdorner/edu/northwestern/at/utils/math/randomnumbers/MersenneTwister.java.htm)

这是一个生成随机数的类。

```
class RandomVariable {

/** Initialize Mersenne Twister generator. */
private static MersenneTwister rnd = new MersenneTwister();

public static double rand() {
    return rnd.nextDouble();
}

/** Generate a random number from a uniform random variable.
 *
 *  @param  min Mininum value for the random variable.
 *  @param  max Maximum value for the random variable.
 *
 *  @return     A random double between min and max.
 */
public static double uniform(double min, double max) {
    return min + (max - min) * rand();
}
} 
```

这是一个生成随机数的示例。请注意，我从源中删除了评论。这可能会破坏代码的开源性质，但我无法将其全部复制并格式化为代码。

```
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;

public class sample{
public static void main(String args[]){
    RandomVariable gen = new RandomVariable();
    double num = gen.uniform(-1,1);

    int n = 10000;
    Set<Double> nums = new HashSet<Double>();
    while (numbers.size() < n)
        nums.add(gen.uniform(-1,1));

}
}
class RandomVariable {

/** Initialize Mersenne Twister generator. */
private static MersenneTwister rnd = new MersenneTwister();

public static double rand() {
    return rnd.nextDouble();
}

/** Generate a random number from a uniform random variable.
 *
 *  @param  min Mininum value for the random variable.
 *  @param  max Maximum value for the random variable.
 *
 *  @return     A random double between min and max.
 */
public static double uniform(double min, double max) {
    return min + (max - min) * rand();
}
}

class MersenneTwister extends java.util.Random implements Serializable {
// Period parameters

private static final int N = 624;
private static final int M = 397;
private static final int MATRIX_A = 0x9908b0df;   // private static final 
//* constant vector a
private static final int UPPER_MASK = 0x80000000; // most significant 
//   w-r bits
private static final int LOWER_MASK = 0x7fffffff; // least significant 
//  r bits
// Tempering parameters
private static final int TEMPERING_MASK_B = 0x9d2c5680;
private static final int TEMPERING_MASK_C = 0xefc60000;
private int mt[]; // the array for the state vector
private int mti; // mti==N+1 means mt[N] is not initialized
private int mag01[];
// a good initial seed (of int size, though stored in a long)
// private static final long GOOD_SEED = 4357;

/* implemented here because there's a bug in Random's implementation
of the Gaussian code (divide by zero, and log(0), ugh!), yet its
gaussian variables are private so we can't access them here.  :-( */
private double __nextNextGaussian;
private boolean __haveNextNextGaussian;

/**
 * Constructor using the default seed.
 */
public MersenneTwister() {
    this(System.currentTimeMillis());
}

/**
 * Constructor using a given seed.  Though you pass this seed in
 * as a long, it's best to make sure it's actually an integer.
 */
public MersenneTwister(final long seed) {
    super(seed);    /* just in case */
    setSeed(seed);
}

/**
 * Constructor using an array.
 */
public MersenneTwister(final int[] array) {
    super(System.currentTimeMillis());
    /* pick something at random just in case */
    setSeed(array);
}

/**
 * Initalize the pseudo random number generator.  Don't
 * pass in a long that's bigger than an int (Mersenne Twister
 * only uses the first 32 bits for its seed).
 */
synchronized public void setSeed(final long seed) {
    // it's always good style to call super
    super.setSeed(seed);

    // Due to a bug in java.util.Random clear up to 1.2, we're
    // doing our own Gaussian variable.
    __haveNextNextGaussian = false;

    mt = new int[N];

    mag01 = new int[2];
    mag01[0] = 0x0;
    mag01[1] = MATRIX_A;

    mt[0] = (int) (seed & 0xfffffff);
    for (mti = 1; mti < N; mti++) {
        mt[mti] =
                (1812433253 * (mt[mti - 1] ^ (mt[mti - 1] >>> 30)) + mti);

        /* See Knuth TAOCP Vol2\. 3rd Ed. P.106 for multiplier. */

        /* In the previous versions, MSBs of the seed affect   */

        /* only MSBs of the array mt[].                        */

        /* 2002/01/09 modified by Makoto Matsumoto             */
        mt[mti] &= 0xffffffff;

        /* for >32 bit machines */
    }
}

/**
 * An alternative, more complete, method of seeding the
 * pseudo random number generator.  array must be an
 * array of 624 ints, and they can be any value as long as
 * they're not *all* zero.
 */
synchronized public void setSeed(final int[] array) {
    int i, j, k;

    setSeed(19650218);
    i = 1;
    j = 0;
    k = (N > array.length ? N : array.length);
    for (; k != 0; k--) {
        mt[i] = (mt[i] ^ ((mt[i - 1] ^ (mt[i - 1] >>> 30)) * 1664525))
                + array[j] + j; /* non linear */
        mt[i] &= 0xffffffff; /* for WORDSIZE > 32 machines */
        i++;
        j++;
        if (i >= N) {
            mt[0] = mt[N - 1];
            i = 1;
        }
        if (j >= array.length) {
            j = 0;
        }
    }
    for (k = N - 1; k != 0; k--) {
        mt[i] = (mt[i] ^ ((mt[i - 1] ^ (mt[i - 1] >>> 30)) * 1566083941))
                - i; /* non linear */
        mt[i] &= 0xffffffff; /* for WORDSIZE > 32 machines */
        i++;
        if (i >= N) {
            mt[0] = mt[N - 1];
            i = 1;
        }
    }
    mt[0] = 0x80000000; /* MSB is 1; assuring non-zero initial array */
}

/**
 * Returns an integer with <em>bits</em> bits filled with a random number.
 */
synchronized protected int next(final int bits) {
    int y;

    if (mti >= N) // generate N words at one time
    {
        int kk;
        final int[] mt = this.mt; // locals are slightly faster
        final int[] mag01 = this.mag01; // locals are slightly faster

        for (kk = 0; kk < N - M; kk++) {
            y = (mt[kk] & UPPER_MASK) | (mt[kk + 1] & LOWER_MASK);
            mt[kk] = mt[kk + M] ^ (y >>> 1) ^ mag01[y & 0x1];
        }
        for (; kk < N - 1; kk++) {
            y = (mt[kk] & UPPER_MASK) | (mt[kk + 1] & LOWER_MASK);
            mt[kk] = mt[kk + (M - N)] ^ (y >>> 1) ^ mag01[y & 0x1];
        }
        y = (mt[N - 1] & UPPER_MASK) | (mt[0] & LOWER_MASK);
        mt[N - 1] = mt[M - 1] ^ (y >>> 1) ^ mag01[y & 0x1];

        mti = 0;
    }

    y = mt[mti++];
    y ^= y >>> 11;                          // TEMPERING_SHIFT_U(y)
    y ^= (y << 7) & TEMPERING_MASK_B;       // TEMPERING_SHIFT_S(y)
    y ^= (y << 15) & TEMPERING_MASK_C;      // TEMPERING_SHIFT_T(y)
    y ^= (y >>> 18);                        // TEMPERING_SHIFT_L(y)

    return y >>> (32 - bits);    // hope that's right!
}

/* If you've got a truly old version of Java, you can omit these
two next methods. */
private synchronized void writeObject(final ObjectOutputStream out)
        throws IOException {
    // just so we're synchronized.
    out.defaultWriteObject();
}

private synchronized void readObject(final ObjectInputStream in)
        throws IOException, ClassNotFoundException {
    // just so we're synchronized.
    in.defaultReadObject();
}

/** This method is missing from jdk 1.0.x and below.  JDK 1.1
includes this for us, but what the heck.*/
public boolean nextBoolean() {
    return next(1) != 0;
}

/** This generates a coin flip with a probability <tt>probability</tt>
of returning true, else returning false. <tt>probability</tt> must
be between 0.0 and 1.0, inclusive.  Not as precise a random real
event as nextBoolean(double), but twice as fast. To explicitly
use this, remember you may need to cast to float first. */
public boolean nextBoolean(final float probability) {
    if (probability < 0.0f || probability > 1.0f) {
        throw new IllegalArgumentException("probability must be between 0.0"
                + " and 1.0 inclusive.");
    }
    if (probability == 0.0f) {
        return false;            // fix half-open issues
    } else if (probability == 1.0f) {
        return true;        // fix half-open issues
    }
    return nextFloat() < probability;
}

/** This generates a coin flip with a probability <tt>probability</tt>
of returning true, else returning false. <tt>probability</tt> must
be between 0.0 and 1.0, inclusive. */
public boolean nextBoolean(final double probability) {
    if (probability < 0.0 || probability > 1.0) {
        throw new IllegalArgumentException("probability must be between 0.0"
                + " and 1.0 inclusive.");
    }
    if (probability == 0.0) {
        return false;             // fix half-open issues
    } else if (probability == 1.0) {
        return true; // fix half-open issues
    }
    return nextDouble() < probability;
}

/** This method is missing from JDK 1.1 and below.  JDK 1.2
includes this for us, but what the heck. */
public int nextInt(final int n) {
    if (n <= 0) {
        throw new IllegalArgumentException("n must be >= 0");
    }

    if ((n & -n) == n) {
        return (int) ((n * (long) next(31)) >> 31);
    }

    int bits, val;

    do {
        bits = next(31);
        val = bits % n;
    } while (bits - val + (n - 1) < 0);
    return val;
}

/** This method is for completness' sake.
Returns a long drawn uniformly from 0 to n-1\.  Suffice it to say,
n must be > 0, or an IllegalArgumentException is raised. */
public long nextLong(final long n) {
    if (n <= 0) {
        throw new IllegalArgumentException("n must be >= 0");
    }

    long bits, val;

    do {
        bits = (nextLong() >>> 1);
        val = bits % n;
    } while (bits - val + (n - 1) < 0);
    return val;
}

/** A bug fix for versions of JDK 1.1 and below.  JDK 1.2 fixes
this for us, but what the heck. */
public double nextDouble() {
    return (((long) next(26) << 27) + next(27))
            / (double) (1L << 53);
}

/** A bug fix for versions of JDK 1.1 and below.  JDK 1.2 fixes
this for us, but what the heck. */
public float nextFloat() {
    return next(24) / ((float) (1 << 24));
}

/** A bug fix for all versions of the JDK.  The JDK appears to
use all four bytes in an integer as independent byte values!
Totally wrong. I've submitted a bug report. */
public void nextBytes(final byte[] bytes) {
    for (int x = 0; x < bytes.length; x++) {
        bytes[x] = (byte) next(8);
    }
}

/** For completeness' sake, though it's not in java.util.Random.  */
public char nextChar() {
    // chars are 16-bit UniCode values
    return (char) (next(16));
}

/** For completeness' sake, though it's not in java.util.Random. */
public short nextShort() {
    return (short) (next(16));
}

/** For completeness' sake, though it's not in java.util.Random.  */
public byte nextByte() {
    return (byte) (next(8));
}

/** A bug fix for all JDK code including 1.2\.  nextGaussian can theoretical
 * ly
ask for the log of 0 and divide it by 0! See Java bug
<a href="http://developer.java.sun.com/developer/bugParade/bugs/4254501.h
 * tml">
http://developer.java.sun.com/developer/bugParade/bugs/4254501.html</a>
 */
synchronized public double nextGaussian() {
    if (__haveNextNextGaussian) {
        __haveNextNextGaussian = false;
        return __nextNextGaussian;
    } else {
        double v1, v2, s;

        do {
            v1 = 2 * nextDouble() - 1; // between -1.0 and 1.0
            v2 = 2 * nextDouble() - 1; // between -1.0 and 1.0
            s = v1 * v1 + v2 * v2;
        } while (s >= 1 || s == 0);
        double multiplier = /* Strict*/ Math.sqrt(-2
                * /* Strict*/ Math.log(s) / s);

        __nextNextGaussian = v2 * multiplier;
        __haveNextNextGaussian = true;
        return v1 * multiplier;
    }
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:17:09.017

[java.lang.math](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#random%28%29)中有一个默认的随机方法。

它返回一个介于 0.0 和 1.0 (0.0 <= n < 1.0) 之间的双精度值。

您可以做一些简单的技巧将其转换为各种随机值：

```
boolean coinFlip = (Math.random() >= 0.5);
int card = (int)(Math.random() * 52); 
```

但是，这会在幕后创建一个新的 java.util.Random() ，我认为您正试图避免这种情况。

如果您不想使用任何库，那么您必须自己实现，这可能最终会变得更加复杂。

您提到使用时间，这当然可以用于生成数字，但对于任何实际目的，它并不是真正随机的。就像是：

```
long betweenOneAndTen = 1 + (System.currentTimeMillis() % 10); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T21:14:25.660

如果你使用这个`Math.random()`函数，你就不会依赖`Random`类，也不会初始化任何东西（至少这不是你的责任）。`System.currentTimeMillis()`调用,`System.nanoTime()`和---之间没有根本区别，`Math.random()`只是后者性能更高，并且更擅长返回随机值。

# javascript - 使用 jquery 调用 Rest WS 成功但没有结果

> ID：14780419
> 
> 赞同：0
> 
> 时间：2013-02-08T20:01:38.947
> 
> 标签：javascript, jquery, html, rest

使用 HTML 和 javascript 网页调用 Restful WS 时遇到问题。

这是我的代码：

```
$.ajax({ 
               type: "GET",
               dataType: "script",
               crossDomain: true,
               url: "http://localhost:8013/publicationservice/lista",              
               complete: function (xhr) {
                   console.log(xhr);
                   console.log("======");

               },
            }); 
```

这就是我调用服务的方式。它返回一个 readyState：4、responseCode：200 和消息：“成功”。但是我的 Rest WS 的方法返回一个字符串。问题是，当我打印“xhr”时，我得到了对象数据。但是当我打印 responseText 属性时，它显示未定义。但是，当我在 chrome 控制台和 firefox firebug 中进行调试时，在“网络”选项卡中，我看到我的结果为字符串的响应（这恰好是与 JSONP 一起工作的 JSON。为什么我不使用 dataType json 或 jsonp 那么? 因为它给了我一个错误，但是当我将数据类型设置为脚本时它工作正常）。但这是主要问题，我无法获得完成应用程序所需的 String 的值。我已经尝试了 $ajax 调用的所有可能参数，但没有成功。如果有人可以帮助我，我会很感激的。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:28:11.817

将[dataType](http://docs.jquery.com/Specifying_the_Data_Type_for_AJAX_Requests)设置为**script**告诉 jquery 将响应作为 javascript 应用程序代码执行，我认为这在您的情况下是不正确的。

如果在将 dataType 设置为**json**时遇到错误，这通常是因为响应未通过 json 验证。一些[验证器](http://jsonlint.com/)的严格程度各不相同，例如：

此代码在某些解析器中未通过 json 验证：

```
{
     key : "value"
} 
```

相反，您必须将键和值都用引号括起来，如下所示：

```
{
     "key" : "value"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:37:10.147

您似乎遇到了同源安全策略。无论您是从同一主机还是另一个主机加载 Web 服务，脚本都会加载，但其他数据类型受到限制。阅读更多：[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)和[跨源资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

解决此问题的一种方法是添加 CORS 标头，以便您可以使用`json`数据类型检索数据，甚至`text`.

假设您的脚本从 运行`http://www.example.com`，然后让服务器上的 Web 服务`localhost:8013`返回标头：

```
Access-Control-Allow-Origin: http://www.example.com 
```

这将使*现代*浏览器可以跨域访问您的 Web 服务。请注意，较旧的浏览器没有实现这一点，您不应该依赖它。

只要您有权更改 Web 服务的输出，我会推荐以下替代方案：

另一种克服同源限制的方法是更改​​您的 Web 服务以返回*正确的*JSONP，这意味着在您的 Web 服务响应中包括变量赋值或函数调用。假设您的网络服务意味着返回`{ "status": "Green", "options": { "alpha": true, "bravo": null } }`，那么您将让它发送：

```
window.var1 = { "status": "Green", "options": { "alpha": true, "bravo": null } } 
```

或者：

```
callbackFunction( { "status": "Green", "options": { "alpha": true, "bravo": null } }  ) 
```

在后一种情况下，您必须`callbackFunction()`在运行`$.ajax`命令之前进行定义。在前一种情况下，您最终会得到一个污染全局命名空间的变量。

# java - 如何使用 PhoneGap 将音频流式传输到 Android 应用程序

> ID：14780420
> 
> 赞同：1
> 
> 时间：2013-02-08T20:01:39.907
> 
> 标签：java, android, cordova, streaming

我需要为 Android 创建一个流媒体和互联网广播的应用程序。
无线电流使用 mms 和 http。
我知道 android 支持 RTSP (RTP, SDP)、HTTP/HTTPS 渐进式流媒体和 HTTP/HTTPS 实时流媒体，但我不明白如何在 PhoneGap 中流式传输它们。
我试过这个：

```
<audio controls src="http://source" /> 
```

和

```
<audio controls src="mms://source" /> 
```

但什么也没有出现。
也许我需要使用java来读取流？
我在谷歌上没有找到任何有用的东西。

罗比

# php - 多个表单提交

> ID：14780421
> 
> 赞同：0
> 
> 时间：2013-02-08T20:01:41.787
> 
> 标签：php, jquery, ajax, forms

只是为了提供一些背景信息，我是一个没有受过正规教育或经验的自学程序员，所以提前为我的代码道歉......

下面的代码试图将一个为 iphone 设计的站点变成一个单页站点（即使用 ajax）。我在提交多个表单时遇到问题...看起来这是在单击表单#id2 上的提交按钮时发生的。

我已经做了一些研究，并正在考虑实施以下 jquery 解决方案来防止多次提交表单： [如何防止表单从客户端多次提交？](https://stackoverflow.com/questions/926816/how-to-prevent-multiple-form-submit-from-client-side)

和这个用于防止服务器端提交多个表单的 php 解决方案： [http ://www.ideologics.co.uk/programming/how-to-prevent-multiple-form-submissions-in-php](http://www.ideologics.co.uk/programming/how-to-prevent-multiple-form-submissions-in-php)

还有一些网站建议将 ajax 邮政编码设置`async`为 false 和`cache`false 但我不完全确定原因以及这是否适用于我的情况。

我必须使用委托函数的原因是因为单击表单#id1 上的提交会加载一个带有 id#2 的表单...我尝试使用`on`jquery 站点所说的取代委托函数的函数，但这似乎不起作用。我正在使用谷歌 CDN 加载版本 1.8.2。

```
var startUrl = 'menu.php';

$(document).ready(function(){
    loadPage(startUrl);
});

function loadPage(url) {
    $('body').append('<div id="progress">Loading...</div>');
    scrollTo(0,0);
    if (url == startUrl) {
        var element = ' #header ul';
    } else {
        var element = ' #content';
    }

    $('#container').load(url + element, function(){
        var title = $('h2').html() || 'Menu';
        $('h1').html(title); 
        $('h2').remove();
        $('.leftButton').remove();

        if (url != startUrl) {
            $('#header').append('<div class="leftButton">Menu</div>');
            $('#header .leftButton').click(function(e){
                $(e.target).addClass('clicked');
                loadPage(startUrl);
            });     
        } 

        $("#container").delegate("a", "click", function(e){
    var url = e.target.href;
            if (url.match(/example.com/)) { 
                    e.preventDefault();
                    loadPage(url);
                }
    });

    $("#container").delegate("form", "submit", function(event){
        event.preventDefault();
    });

        $('#id1').submit(function(){
    var formData = $(this).serialize();
    $.post('processform1.php',formData,processResults);     

    function processResults(data) {
        $('#id1').remove();
        $('#container').html(data);
    }

        });

        $("#container").delegate("#id2", "submit", function(event){
        var formData = $(this).serialize();
    $.post('processform3.php',formData,processResults);     

    function processResults(data) {
        $('#id2').remove();
        $('#container').html(data);
    }

        event.preventDefault();
    });                 

        $('#progress').remove();        

});
} 
```

以下是索引页面：

```
<html>
<head>
    <title>Title</title>
    <meta name="viewport" content="user-scalable=no, width=device-width" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link rel="apple-touch-icon-precomposed" href="myCustomIcon.png" />
    <link rel="apple-touch-startup-image" href="myCustomStartupGraphic.png" />
    <link rel="stylesheet" href="iphone.css" type="text/css" media="screen" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript" src="iphone.js"></script> 

</head>
<body>
    <div id="header">
        <h1>Menu</h1>
    </div>
    <div id="container"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:05:29.843

只需将其放在提交按钮所在页面的 JS 中即可

```
<script type="text/javascript">
  $(document).ready(function(){
    $("input[type='submit']").attr("disabled", false);
    $("form").submit(function(){
      $("input[type='submit']").attr("disabled", true).val("Please wait...");
      return true;
    })
  })
</script> 
```

您可能需要使用`on()`事件处理程序或进行其他修改，具体取决于表单是否在页面加载时生成。

# android - SQL 语法不正确，但为什么呢？

> ID：14780425
> 
> 赞同：0
> 
> 时间：2013-02-08T20:02:08.993
> 
> 标签：android, sql, syntax, logcat

在 android 中，我使用 database.rawQuery(command, selectionArgs); 我正在使用的命令是

```
SELECT * FROM vocab_info WHERE name = AQA GCSE Spanish 
```

我得到的错误是：

```
(1) near "GCSE": syntax error 
```

但我不知道出了什么问题。有什么建议么？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T20:03:03.577

试试这个。

```
SELECT * FROM vocab_info WHERE name = 'AQA GCSE Spanish' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T20:04:10.507

你应该在你的字符串周围加上单引号

```
SELECT * FROM vocab_info WHERE name = 'AQA GCSE Spanish' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:06:49.407

```
select * from vocab_info where name in ('AQA', 'GCSE', 'Spanish') 
```

# php - MySQL 存储字符在一台服务器上转义，但不在另一台服务器上

> ID：14780429
> 
> 赞同：1
> 
> 时间：2013-02-08T20:02:39.857
> 
> 标签：php, mysql, mysql-real-escape-string

所以我有一个非常简单的应用程序，将数据存储在 MySQL 数据库中，数据被发布到 php 文件中，然后将其包装在 mysql_escape_string() 中，然后将其插入数据库。

在我本地安装的运行 php 和 mysql 的 apache 上，它工作正常，但在我的主机帐户上，它存储任何 ' 和 " 前面带有 \ 的字符。两个数据库都使用相同的 latin1_swedish_ci 字符集，并且都运行相同版本的 mysql：5.5 .27 但显然表现不同。

我对此一无所知。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:15:35.707

正如@njk 评论的那样，您的托管服务提供商很可能在他们的 PHP 环境中启用了魔术引号。因此，当您的代码看到它们时，PHP 请求参数已经包含转义。然后，您使用 mysql_real_escape_string() 将转义应用于“\”转义字符，结果是文字“\”字符最终出现在您的数据库中。

您可以通过上传一个快速的 PHP 脚本来验证您的托管 PHP 环境中的当前设置，该脚本检查[get_magic_quotes_gpc()](http://www.php.net/manual/en/function.get-magic-quotes-gpc.php)并根据结果打印“是”或“否”。您还可以检查来自[phpinfo()](http://www.php.net/phpinfo)的报告。

一般来说，您应该始终将您的开发环境与您的托管环境的 PHP 版本和 PHP 设置相匹配，这样您就可以更加确信地测试您的代码，确保在部署时它会以相同的方式工作。

另一种解决方案是编写您的应用程序以在运行时有条件地撤消魔术引号（如果启用了魔术引号）。然后像往常一样应用 mysql 转义。这是一个 PHP 代码示例的链接，用于在运行时撤消魔术引号：http: [//php.net/manual/en/security.magicquotes.disabling.php](http://php.net/manual/en/security.magicquotes.disabling.php)

第三条建议是更换托管服务提供商。一个还没有启用多年前已弃用的 PHP 功能的好人。没有任何借口！

# jquery - DateBox 获取日期

> ID：14780431
> 
> 赞同：0
> 
> 时间：2013-02-08T20:02:49.723
> 
> 标签：jquery, jquery-mobile, jquery-plugins

我正在使用 DateBox 插件 ( [http://dev.jtsage.com/jQM-DateBox/](http://dev.jtsage.com/jQM-DateBox/) ) 在 jqm 网站上使用。我希望它充当从数据库中检索项目的选择器。我们已经编写了一个可以在桌面站点上运行的脚本，只需要稍作修改。它通过获取通过 URL 传递的日期来选择数据库信息来工作。是否可以使用此插件，特别是日历上的每一天项目作为链接？另外，我很难得到日期。我并没有真正关注网站上的文档。

谢谢！

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-05T08:15:49.377

试试移动滚动。[http://mobiscroll.com/](http://mobiscroll.com/) 我认为它可以做大部分事情。

# xcode - 是否可以使用仅安装 Xcode 4.3 CLI 工具的 MacPorts？

> ID：14780434
> 
> 赞同：0
> 
> 时间：2013-02-08T20:02:58.677
> 
> 标签：xcode, macports

我知道从 Xcode 4.3 开始，CLI 工具是一个单独的安装，这会在升级时导致现有 MacPorts 安装出现许多问题。这个问题与那个问题无关。使用全新的 rMBP 15.4"，我尝试通过从 Apple Developer 站点下载*仅*安装CLI 工具。MacPorts 不仅找不到 Xcode，而且 xcodebuilder 本身也无法执行（只是挂起......）。我尝试了很多使用 xcode-select 指向 CLI 二进制文件的迭代，但我无法让 MacPorts 或只是 CLI 二进制文件工作。

是否根本不可能只安装（非常整洁且对 SSD 友好的）CLI 工具并让 MacPorts 工作？在此处和 Google 上的多次搜索中，我找不到任何明确确认或否认这一点的人。使用 128GB SSD，每 GB 都很重要……而 4+GB Xcode 安装（其中 99% 我不需要）是浪费空间。MacPorts 需要的正确 Xcode 安装中有什么东西吗？

# c# - 如何使整个 GridView 只读？

> ID：14780440
> 
> 赞同：0
> 
> 时间：2013-02-08T20:03:15.917
> 
> 标签：c#, winforms

我可以在表单加载时将单个列设置为只读，但我想将完整的网格视图设置为只读，而不是将每一列设置为只读。是否可以 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:06:06.943

因为您将其标记为 WinForms，我假设您正在询问`DataGridView`它，它具有属性`ReadOnly`，将其设置为 true。

# php - 通过 li results 传递查询结果

> ID：14780443
> 
> 赞同：0
> 
> 时间：2013-02-08T20:03:27.747
> 
> 标签：php

我有一个创建图像链接列表的查询，我想通过这些图像链接的 url 传递一个变量。但是，因为有多个结果，所以当我尝试传递它时，我得到的查询乘以有多少结果。

例如，如果 $filter = "sub 1, sub 2" 并且返回三张图片，那么passed_filter = "sub1, sub2, sub1, sub2, sub1, sub2"

所以我要做的是passed_filter =“sub1，sub2”。

$filter 从多选下拉列表中传递。而passed_filter 是$filter 的结果被发送回结果页面。

关于如何更改下面的代码来做我想做的任何想法？

php页面：

```
<?php
echo "<h2>Currently Displaying: Custom Selection</h2>";

    include ("connect.php");

    $filter = $_GET["filter"];
    $filterIn = $filter;

        $result = mysql_query("SELECT * FROM edt_images
                                WHERE cat1 IN ($filterIn)
                                OR cat2 IN ($filterIn)
                                OR cat3 IN ($filterIn)
                                OR cat4 IN ($filterIn)
                                OR cat5 IN ($filterIn)
                                OR cat6 IN ($filterIn)
                                ORDER BY vote_item_id")                         
            or die(mysql_error());

        echo "<div id='results_container'>";
        echo "<ul id='items'>";

        while ($row = mysql_fetch_array($result)) {

                echo "<li><a href='subpage.php?passed_filter=".$filter."&id=".$row['id']."' border='0'>
                         <img src='files/300x200/thumb2_".$row['item_name'].".".$row['file_extension']."' border='0' class='filtered_images'/>
                         </a>
                            <br />
                                <strong>
                                    ".$row['file_tag_line']." 
                                </strong>
                      </li>"; 
        }

        echo "</ul>";
        echo "</div>";
?> 
```

提前致谢。请让我知道是否还有其他需要发布的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:17:26.640

## 1) 停止使用`mysql_`函数

## 2) 标准化

```
CREATE TABLE edit_images_category (
  id tinyint,
  category varchar(10),
  PRIMARY KEY (id, category));

INSERT INTO edit_image_category (id, category)
SELECT id, cat1 AS cat FROM edit_images
UNION ALL
SELECT id, cat2 AS cat FROM edit_images
UNION ALL
SELECT id, cat3 AS cat FROM edit_images
UNION ALL
SELECT id, cat4 AS cat FROM edit_images
UNION ALL
SELECT id, cat5 AS cat FROM edit_images
UNION ALL
SELECT id, cat6 AS cat FROM edit_images 
```

## 3) 进行搜索

```
SELECT * FROM edit_images_category WHERE cat IN ($filterIn) 
```

## [查看演示](http://sqlfiddle.com/#!2/a12fc/1)

# asp.net - 在没有 HTTP 上下文的情况下加载 ProfileBase

> ID：14780445
> 
> 赞同：2
> 
> 时间：2013-02-08T20:03:30.423
> 
> 标签：asp.net, asp.net-membership

我正在转换在经典 ASP.Net Membership Provider 中序列化的用户配置文件数据，以便在 SimpleMembership 中使用。我无法弄清楚如何为`ProfileBase`系统中的每个用户获取对象。

如果*特定*用户已登录，我可以执行以下操作：

```
MyModel myModel = 
    (MyModel)HttpContext.Current.Profile.GetPropertyValue("MyKey"); 
```

其中*MyKey*指的是这样建立的配置文件密钥`web.config`：

```
<add name="MyModel" type="MyNS.MyModel" serializeAs="Binary" /> 
```

但是，如果没有 HTTP 上下文的好处（我试图为系统中的所有用户执行此操作，而不是登录用户），我无法弄清楚如何加载配置文件并最终`MyModel`为每个用户加载一个实例在系统中。

我试过了：

```
ProfileInfoCollection profiles = 
     ProfileManager.GetAllProfiles(ProfileAuthenticationOption.All);

foreach (var profile in profiles)
{
    var pi = (ProfileBase)profile;
    // OOPS!  Unfortunately GetAllProfiles returns 
    // ProfileInfo and not ProfileCommon or ProfileBase
} 
```

和

```
MembershipUserCollection existingUsers = Membership.GetAllUsers();
foreach (MembershipUser mu in existingUsers)
{
    mu. // OOPS! No link to the profile from the user...
} 
```

如何检索系统中每个配置文件的`ProfileCommon`或`ProfileBase`实例，从而最终`MyModel`与每个用户关联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:27:25.850

由于我找不到这个问题的答案，我选择直接从 SQL 读取配置文件数据。

事实证明，格式很简单。在 aspnet_Profile 中：

*   PropertyNames 使用 NameOfProperty:TypeFlag:Offset:Length 格式（对所有属性重复）。
*   FlagType 是字符串的“S”或二进制的“B”
*   偏移量是相应数据字段中的偏移量
*   长度是相应数据字段中数据的长度
*   PropertyValuesString 包含所有没有分隔符的字符串属性。
*   PropertyValuesBinary 包含所有没有分隔符的二进制属性。
*   BinaryFormatter 用于序列化二进制（非字符串）属性

这是我为解析数据而编写的一小段代码：

```
private class Migrate_PropNames
{
    public string Name { get; set; }
    public bool IsString { get; set; }
    public int Offset { get; set; }
    public int Length { get; set; }
}
....

Dictionary<string, Migrate_PropNames> propInfo = ParsePropInfo(propertyNames);
// Example string property
string firstName = Migrate_GetString(propInfo["FirstName"], propertyValuesString);
// Example binary property
MyType myType = 
    Migrate_GetBinary<MyType>(propInfo["MyTypeKey"], propertyValuesBinary));

private T Migrate_GetBinary<T>(Migrate_PropNames propNames, byte[] propertyValuesBinary)
{
    byte[] data = new byte[propNames.Length];
    Array.Copy(propertyValuesBinary, propNames.Offset, data, 0, propNames.Length);

    var fmt = new BinaryFormatter();
    using (var ms = new MemoryStream(data))
    {
        T original = (T)fmt.Deserialize(ms);
        return original;
    }
}

private string Migrate_GetString(Migrate_PropNames propNames, string propertyNames)
{
    return propertyNames.Substring(propNames.Offset, propNames.Length);
}

private Dictionary<string, Migrate_PropNames> ParsePropInfo(string propertyNames)
{
    Dictionary<string, Migrate_PropNames> result = new Dictionary<string,Migrate_PropNames>();

    string[] parts = propertyNames.Split(new string[] { ":"}, StringSplitOptions.RemoveEmptyEntries);
    for (int i = 0; i < parts.Length; i += 4)
    {
        Migrate_PropNames pn = new Migrate_PropNames();
        pn.Name = parts[i];
        pn.IsString = (parts[i + 1] == "S");
        pn.Offset = int.Parse(parts[i + 2]);
        pn.Length = int.Parse(parts[i + 3]);

        result.Add(pn.Name, pn);
    }

    return result;
} 
```

我希望这可以帮助别人。我很乐意接受正确显示如何使用 API 的不同答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-10T12:43:16.737

从`ProfileInfo`or`MemberShipUser`对象，您应该可以`ProfileBase`使用`ProfileBase.Create(string username)`.

# javascript - 获取具有特定类的项目的索引值

> ID：14780451
> 
> 赞同：0
> 
> 时间：2013-02-08T20:03:55.873
> 
> 标签：javascript, jquery

我试图弄清楚如何获取给定类的元素的索引值。例如，我有。

**HTML：**

```
<ul>
    <li>One</li>
    <li>Two</li>
    <li class="open">Three</li>
    <li>Four</li>
</ul> 
```

**jQuery**

```
var index = $('li .open').index();
console.log(index); 
```

**我的期望：**

预期的控制台结果应等于**2**。我得到的是**-1**。

无论如何，我显然做错了什么，所以对此的任何帮助将不胜感激。我在这里开始了一个小提琴：http: [//jsfiddle.net/](http://jsfiddle.net/gENcn/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:04:55.397

空间有所不同：

*   `li .open`选择一个元素`open`内的类的`<li>`元素。
*   `li.open`选择`<li>`一个类为 的元素`open`。

**演示：http: [//jsfiddle.net/gENcn/2/](http://jsfiddle.net/gENcn/2/)**

# c# - 允许鼠标指针位于屏幕边界之外

> ID：14780455
> 
> 赞同：0
> 
> 时间：2013-02-08T20:04:03.670
> 
> 标签：c#, xna, camera

我正在使用 XNA 4.0 和 c# 制作游戏。我刚刚完成了我的相机课，它几乎按预期工作，除了一件事。我可以用鼠标移动来旋转相机，但问题是当我到达屏幕边缘时，鼠标停止，相机移动也停止。

有什么方法可以让鼠标指针在屏幕边界之外，以便能够继续跟踪指针？或者有没有更简单的方法？

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

public class ArcBallCamera
{
    private float speeder = 100;
    public ArcBallCamera(float aspectRation, Vector3 lookAt)
        : this(aspectRation, MathHelper.PiOver4, lookAt, Vector3.Up, 0.1f, float.MaxValue) { }

    public ArcBallCamera(float aspectRatio, float fieldOfView, Vector3 lookAt, Vector3 up, float nearPlane, float farPlane)
    {
        this.aspectRatio = aspectRatio;
        this.fieldOfView = fieldOfView;
        this.lookAt = lookAt;
        this.nearPlane = nearPlane;
        this.farPlane = farPlane;
    }

    /// <summary>
    /// Recreates our view matrix, then signals that the view matrix
    /// is clean.
    /// </summary>
    public void ReCreateViewMatrix()
    {

        //Calculate the relative position of the camera                        
        position = Vector3.Transform(Vector3.Backward, Matrix.CreateFromYawPitchRoll(yaw, pitch, 0));
        //Convert the relative position to the absolute position
        position *= zoom;
        position += lookAt;

        //Calculate a new viewmatrix
        viewMatrix = Matrix.CreateLookAt(position, lookAt, Vector3.Up);
        viewMatrixDirty = false;
    }

    /// <summary>
    /// Recreates our projection matrix, then signals that the projection
    /// matrix is clean.
    /// </summary>
    public void ReCreateProjectionMatrix()
    {
        projectionMatrix = Matrix.CreatePerspectiveFieldOfView(fieldOfView, AspectRatio, nearPlane, farPlane);
        projectionMatrixDirty = false;
    }

    #region HelperMethods

    /// <summary>
    /// Moves the camera and lookAt at to the right,
    /// as seen from the camera, while keeping the same height
    /// </summary>        
    public void MoveCameraRight(float amount)
    {
        Vector3 right = Vector3.Normalize(LookAt - Position); //calculate forward
        right = Vector3.Cross(right, Vector3.Up); //calculate the real right
        //right.Y = 0;
        right.Normalize();
        LookAt += right * amount;
    }

    /// <summary>
    /// Moves the camera and lookAt forward,
    /// as seen from the camera, while keeping the same height
    /// </summary>        
    public void MoveCameraForward(float amount)
    {
        Vector3 forward = Vector3.Normalize(LookAt - Position);
       // forward.Y = 0;
        forward.Normalize();
        LookAt += forward * amount;
    }

    /// <summary>
    /// Moves the camera and lookAt up or down,
    /// LOL
    /// </summary>        
    public void MoveCameraUp(float amount)
    {
        Vector3 up = Vector3.Normalize(LookAt - position);
        up = Vector3.Cross(up, Vector3.Left);   //Calculate the REAL FUCKING UP/DOWN
        up.X = 0;
        up.Z = 0;
        up.Normalize();
        LookAt += up * amount;
    }

    #endregion

    #region FieldsAndProperties
    //We don't need an update method because the camera only needs updating
    //when we change one of it's parameters.
    //We keep track if one of our matrices is dirty
    //and reacalculate that matrix when it is accesed.
    private bool viewMatrixDirty = true;
    private bool projectionMatrixDirty = true;

    public float MinPitch = -MathHelper.PiOver2 + 0.3f;
    public float MaxPitch = MathHelper.PiOver2 - 0.3f;

    private float pitch;
    public float Pitch
    {
        get { return pitch; }
        set
        {
            viewMatrixDirty = true;
            pitch = MathHelper.Clamp(value, MinPitch, MaxPitch);
        }
    }

    private float yaw;
    public float Yaw
    {
        get { return yaw; }
        set
        {
            viewMatrixDirty = true;
            yaw = value;
        }
    }

    private float fieldOfView;
    public float FieldOfView
    {
        get { return fieldOfView; }
        set
        {
            projectionMatrixDirty = true;
            fieldOfView = value;
        }
    }

    private float aspectRatio;
    public float AspectRatio
    {
        get { return aspectRatio; }
        set
        {
            projectionMatrixDirty = true;
            aspectRatio = value;
        }
    }

    private float nearPlane;
    public float NearPlane
    {
        get { return nearPlane; }
        set
        {
            projectionMatrixDirty = true;
            nearPlane = value;
        }
    }

    private float farPlane;
    public float FarPlane
    {
        get { return farPlane; }
        set
        {
            projectionMatrixDirty = true;
            farPlane = value;
        }
    }

    public float MinZoom = 1;
    public float MaxZoom = float.MaxValue;
    private float zoom = 1;
    public float Zoom
    {
        get { return zoom; }
        set
        {
            viewMatrixDirty = true;
            zoom = MathHelper.Clamp(value, MinZoom, MaxZoom);
        }
    }

    private Vector3 position;
    public Vector3 Position
    {
        get
        {
            if (viewMatrixDirty)
            {
                ReCreateViewMatrix();
            }
            return position;
        }
    }

    private Vector3 lookAt;
    public Vector3 LookAt
    {
        get { return lookAt; }
        set
        {
            viewMatrixDirty = true;
            lookAt = value;
        }
    }
    #endregion

    #region ICamera Members
    public Matrix ViewProjectionMatrix
    {
        get { return ViewMatrix * ProjectionMatrix; }
    }

    private Matrix viewMatrix;
    public Matrix ViewMatrix
    {
        get
        {
            if (viewMatrixDirty)
            {
                ReCreateViewMatrix();
            }
            return viewMatrix;
        }
    }

    private Matrix projectionMatrix;
    public Matrix ProjectionMatrix
    {
        get
        {
            if (projectionMatrixDirty)
            {
                ReCreateProjectionMatrix();
            }
            return projectionMatrix;
        }
    }
    #endregion

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:08:53.427

您可以为每一帧重新[设置鼠标位置](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.input.mouse.setposition.aspx)。

例子：

```
// Center of the window
var resetPosition = new Point(WindowWidth / 2, WindowHeight / 2);

// Get the movement since the last frame
var mouseState = Mouse.GetState();
var mousePosition = new Point(mouseState.X, mouseState.Y);
var delta = mousePosition - resetPosition;

// Reset the mouse position
Mouse.SetPosition(resetPosition.X, resetPosition.Y);

// Use the delta
RotateCamera(delta); 
```

# actionscript-3 - 为什么没有事件侦听器或引用的封闭 NetConnection 会留在内存中？

> ID：14780456
> 
> 赞同：6
> 
> 时间：2013-02-08T20:04:07.770
> 
> 标签：actionscript-3, flash, memory-management, memory-leaks, amfphp

似乎如果 flash.net.NetConnection 被实例化并连接到 HTTP URL（例如 AMFPHP 网关），那么即使在关闭并且唯一引用设置为 null 之后，垃圾收集也不会拾取该实例。

另一方面，如果实例连接到 null（如用于播放视频/mp3 文件时所做的那样），则该实例将从内存*中*清除。

为了澄清，以下连接将保留在内存中：

```
var stickyConn:NetConnection = new NetConnection();
stickyConn.connect("http://myserver/amfphp/gateway.php");
stickyConn.close();
stickyConn = null; 
```

然而，以下连接将立即从内存中清除：

```
var tempConn:NetConnection = new NetConnection();
tempConn.connect(null);
tempConn.close();
tempConn = null; 
```

我已经尝试过一些事情来解决这个问题：

*   将客户端设置为空对象（因为客户端的默认值是 NetConnection 本身）
*   在关闭连接之前，调用`connect(null)`
*   *关闭连接后*，再次调用`connect(null)`并关闭它

有没有人遇到过这个问题？有针对这个的解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T11:28:30.057

我经常使用 AS3 构建重载 FLV/Mp4 播放器。当我使用 Akamai 或 Adob​​e 的内部 NetConnection 类等服务时，我始终牢记 `client` [object](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetConnection.html#client)。

> > 这是调用所有回调方法的 NetConnection 的属性。默认值为此 NetConnection 实例`this`。如果将客户端属性设置为另一个对象，则会在该对象上调用回调方法。

通过这种方式，您可以轻松了解垃圾收集从未以相同的方式真正应用于每个组件。所以，哪里`stickyConn = null;`只会停止播放，因为你从来没有声明过弱引用，垃圾收集不知道要寻找什么。

我已经根据特定玩家使用不同的方法取得了成功：

> 简单的陈述`NetConnectionObj.client = this`通常就足够了。但是，如果您的 NetConnection 被扩展或实现了一个接口呢？只需使用`null`Dictionary 对象： var d:Dictionary = new Dictionary(true); . 从这里垃圾收集将识别“d”作为弱引用并自动转储它；
> 
> > 因此，您的代码段看起来有点像这样： `var Dc:Dictionary = new Dictionary(true);
> > NetConnection:NetConnection.client = Dc;`
> > 
> > > 或具有相同意图的一些变体。

我知道这行得通，所以如果您需要帮助，请联系...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-14T03:33:45.197

I may have been vague with the last answer in regards to GC and Dictionary Objects. Please take this snippet into consideration. I wrote it quickly but I try to explain the Concept of what solves your problem; mainly since I have dealt with it before:

```
public class Main extends MovieClip {

    private var connection:NetConnection;
    private var __nData:*;
    private var _instance:*;
    private var _closure:Function;
    private var _D:Dictionary;

    public function Main() {    
        connection = new NetConnection();
        connection.addEventListener(NetStatusEvent.NET_STATUS, _nsHandle)
        connection.connect(null);
    }
    public function _nsHandle(event:NetStatusEvent):void {
        try {
            connection = new NetConnection();
            connection.connect(null);
            connection.client = RegisterForGC(event.target);
            RegisterForGC(connection);
        } finally {
            __nData = event.target.netConnection;
        }           
    }
    public function RegisterForGC(NCObject:*):* {
        _instance = NCObject;
        _closure  = function  ():void       {}
        _listener = function (e:Event):void {}
        _D = new Dictionary(true);
        _D[_listener] = "A";
        _D[_instance] = "B";
        _D[_closure]  = "C";
        try {
            new LocalConnection().connect( "A" );
            new LocalConnection().connect( "B" );
        } catch (anything:*) { }
        return _instance;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-02T18:57:36.287

我不确定，但您的示例似乎表明您在舞台/框架上声明您的变量。

关（）; 这就是你需要的全部工作但是......从我发现的 NetConnection 出于某种原因，除非所有变量/函数都在外部类中声明，例如。public vars public 函数，即使在使用 close() 后它也会保留在内存中；

拔出我的头发，用一个音频流项目来解决这个问题。但是，一旦我将所有编码移至外部类， close(); 实际上关闭了连接。

如果您的代码在舞台上的框架上或在 MC 中，我将创建一个类并在所述 External Class.as 中声明变量和函数，并且由于某些愚蠢的原因它可以工作。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-14T22:08:20.993

您是否在使用 NetStream 对象并且在完成后不处理它？我之所以这么问，是因为我很少看到后面没有 NetStream 对象的 NetConnection。

# linux - Vi 提升用户权限

> ID：14780457
> 
> 赞同：1
> 
> 时间：2013-02-08T20:04:09.243
> 
> 标签：linux, vim, vi

如果您在 vi 或 vim 中打开文件并且没有写入权限，有没有办法`sudo su`不必放弃所有更改并重新打开？

目前，我必须放弃所有更改，关闭 vi 然后`su vi`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:10:12.240

如果您安装[Sudo Edit 插件](https://github.com/chrisbra/SudoEdit.vim)，您`:SudoWrite`将获得询问您的 root 密码的命令。然后它将文件以root身份写入，非常方便。我经常用它来编辑 /etc/.

从文档中：

```
2.2 SudoWrite                            *SudoWrite*

:[range]SudoWrite[!] [file]

SudoWrite will write the given file using any of the configured methods for
superuser authtication. It basically does something like this: >

     :w !sudo tee >/dev/null file

If no filename is given, SudoWrite will try to write the current file name.
If the current buffer does not contain any file, it will abort.

You can specify a range to write just like |:w|. If no range is given, it will
write the whole file. If the bang argument is not given, the buffer will only
be written, if it was modified.

Again, you can use the protocol handler sudo: for writing. 
```

# spring - Spring MVC 将输入表单 id 和值提交到表单支持对象

> ID：14780462
> 
> 赞同：0
> 
> 时间：2013-02-08T20:04:25.623
> 
> 标签：spring, jsp, spring-mvc

我正在使用 Spring MVC 在提交时将输入字段的值自动映射到表单支持对象。我想要大多数输入字段的值，但是有些字段我想要输入 id 元素。例如，如果用户选择“English”作为语言，我不希望表单支持对象的值是“English”，而是希望它是“en”（设置为输入 id语言选择）。

处理这种情况的典型方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:35:52.150

这样做的方法是[选择标签](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/view.html#view-jsp-formtaglib-selecttag)。典型用法：

```
<form:select id="language" path="language" items="${availableLanguages}" /> 
```

在你的控制器中的某个地方：

```
modelAndView.addObject("availableLanguages", new HashMap<String, String>(){
    {
        put("en", "English");
        put("ru", "Russian");
    }
}); 
```

# css - 格式化引导轮播布局

> ID：14780464
> 
> 赞同：0
> 
> 时间：2013-02-08T20:04:41.963
> 
> 标签：css, twitter-bootstrap

我试图让引导轮播显示在轮播两侧的控制箭头上，因为默认情况下它们会重叠到图像中。

这是我要完成的示例：http: [//jsfiddle.net/LHAB8/](http://jsfiddle.net/LHAB8/)

理想情况下，我希望它看起来像

[左箭头] [一次显示 4 个框的轮播] [右箭头]

```
<div class="span2">
   <a data-slide="prev" href="#myCarousel" class="left carousel-control">‹&lt;/a>
</div>
<div class="carousel slide span8" id="myCarousel">
    ...
</div>
<div class="span2">
   <a data-slide="next" href="#myCarousel" class="right carousel-control">›&lt;/a>
</div> 
```

但我无法使用引导网格系统进行定位以使其看起来正确 - 布局不需要响应。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T15:24:11.610

您可以在 div.carousel 上添加填充

```
.carousel
{
    padding:10px 70px;
} 
```

[http://jsfiddle.net/LHAB8/1/](http://jsfiddle.net/LHAB8/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:14:36.740

要执行此 hack，您可以修改引导 css 或添加以下内容：

**html**

```
<a href="my-control left">Left</a>
<a href="my-control right">Right</a> 
```

**jQuery**

```
$('.carousel-control').hide();
$('.my-control').click(function(e) 
{
    e.preventDefault();
    if($(this).hasClass('left'))
        $('#myCarousel').carousel('prev');
    else if($(this).hasClass('right'))
        $('#myCarousel').carousel('next');
}); 
```

查看[Bootstrap 文档](http://twitter.github.com/bootstrap/javascript.html#carousel)以获取更多事件

# junit - 服务器启动后执行junit测试

> ID：14780465
> 
> 赞同：1
> 
> 时间：2013-02-08T20:04:43.047
> 
> 标签：junit

我是junit的新手，作为构建过程的一部分，我需要执行一些测试，即构建完成后，服务器启动，然后我需要在服务器上执行一些单元测试。
例如：
1\. 服务器是否加载了配置 xml
2\. 服务器是否将其消息发送到节点 XYZ
问题是我知道如何对原始简单功能进行单元测试，
但我如何执行涉及启动服务器和触发的此类测试服务器内部功能 ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:15:22.770

我建议使用像 Hudson、Jenkins 或类似的 CI 服务器。配置一个构建非常容易，例如 Tomcat，然后继续使用构建脚本（maven、gradle、ant）运行您的测试。我建议您将这部分作为构建管道的一部分，并且不要在开发人员 PC 上运行它。这些类型的测试根本不能很好地扩展。

# desire2learn - 通过 Valence 检索特定学生/年级项目的字母值（由方案定义）？

> ID：14780467
> 
> 赞同：1
> 
> 时间：2013-02-08T20:04:58.393
> 
> 标签：desire2learn, valence

我有一个带有字母等级值的选择框，其中有一个与选择框绑定的自定义等级方案。选择框设置为“奖励”项目，因此积分值不会对任何课程计算产生任何影响，但我必须为该项目分配价值。用户（教师）从方案（A、B 等）下拉列表中选择一个等级。如果我努力检索为特定学生选择的成绩，我会得到“DisplayedGrade”属性的分值，但该分值不是实际显示的值。例如，选择了 A。“DisplayedGrade”返回为“9.4/10”。我想我可以想办法将这些点值转换为字母，但我希望选择字母。有没有办法获得实际的字母值？我是否必须以某种方式参与计划，

更新：自从我第一次输入此内容以来，我开始意识到分配的“点”值实际上是我在方案设置中创建初始“分配值 %”时必须输入的 % 值。在这种情况下，选择了 9.4 === "A"。在该方案中，94% 是在分配值 % 中为 A 输入的值。

更新^2：示例帮助！

这是我打的电话：/d2l/api/le/1.1/184115/grades/3502480/values/180070

基于[http://docs.valence.desire2learn.com/res/grade.html#get--d2l-api-le-(D2LVERSION-version)-(D2LID-orgUnitId)-grades-final-values-(D2LID -用户身份）](http://docs.valence.desire2learn.com/res/grade.html#get--d2l-api-le-(D2LVERSION-version)-(D2LID-orgUnitId)-grades-final-values-(D2LID-userId))

这是被退回的。

```
{
    "GradeObjectIdentifier": "3502480",
    "GradeObjectName": "eGrade",
    "GradeObjectType": 3,
    "GradeObjectTypeName": "Selectbox",
    "DisplayedGrade": "9.4 / 10"
} 
```

这是我*希望*得到的：

```
{
    "GradeObjectIdentifier": "3502480",
    "GradeObjectName": "eGrade",
    "GradeObjectType": 3,
    "GradeObjectTypeName": "Selectbox",
    "DisplayedGrade": "A"
} 
```

我想我也必须调用该计划来比较值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T19:57:58.123

我已经在两个测试 LMS 实例上尝试过这个：一个 LE v10.0.0 和一个 LE v10.2.0。在这两种情况下，我都能得到一个返回的成绩值块，显示一个`DisplayedGrade`带有*符号*的显示，而不是你所拥有的数值。我使用了路由`/d2l/api/le/1.1/{orgUnitId}/grades/values/{userId}/`（管理员调用用户上下文）和`/d2l/api/le/1.1/{orgUnitId}/grades/values/myGradeValues/`（学生调用用户上下文）。

我认为您的困难可能在于等级对象定义本身。为了显示*成绩方案符号*而不是您需要的点值

1.  编辑成绩对象。

2.  在*学生视图*的“显示选项”部分，选择“*覆盖此项目的显示选项”*。

3.  确保选中*等级方案符号。*

看来，只要选中*Grade scheme symbol*，API 调用似乎就会返回适当的符号作为`DisplayedGrade`属性（即使*Points Grade*也被选中）。默认显示设置似乎只选择了*分数等级*（至少在我的测试实例上）。

# jquery - .each() 没有针对正确的元素

> ID：14780471
> 
> 赞同：4
> 
> 时间：2013-02-08T20:05:26.123
> 
> 标签：jquery, each

我在让我的 jQuery 定位正确的 div 时遇到了一些麻烦。我正在创建一个水平条形图小部件，并且我希望值标签在​​小于 10% 时碰到条形的右侧（为了便于阅读）。

看起来我没有正确定位***barValue*** div，因为它没有像应有的那样将 <10% 的值颠倒过来。

![在此处输入图像描述](../Images/d0f9ca65db9753ee488e4390158fb0b0.png)

[**这是一个小提琴。**](http://jsfiddle.net/pYmbP/1/)

```
$(function() {
    $(".barChart").each(function() {
        $(this).html("<div class='barLabel'>" 
            + $(this).data('title') + 
        "</div><div class='barContainer'><div class='bar' style='width:" 
            + $(this).data('value') + 
        "%'><div class='barValue'>" 
            + $(this).data('value') + "%" 
            + "</div></div></div>");
        if($(this).data('value') <= 10) {
            $(this, ".barContainer .barValue").css({
                "margin-right": "-20px",
                "color": "#000",
            });
        }
    });
}); 
```

* * *

```
<div class="barChart" data-value="64" data-title="Apples"></div>
<div class="barChart" data-value="6" data-title="Oranges"></div> 
```

* * *

```
.barChart {
    width:100%;
    margin:5px;
}
    .barChart .barLabel {
        float:left;
        font-size:12px;
        color:#BBB;
    }
    .barChart .barContainer {
        width:-webkit-calc(100%-85);    
        margin-left:75px;

        -moz-box-sizing: border-box; 
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        height:15px;
        padding:1px;
        border:1px solid #EEE;
    }
    .bar {
        -moz-box-sizing: border-box; 
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        height:100%;

        border:1px solid #FF0000;
        background: #CC0000; /* Old browsers */
        background: -moz-linear-gradient(top, #FF0000 0%, #CC0000 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #FF0000), color-stop(100%, #CC0000)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top, #FF0000 0%, #CC0000 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top, #FF0000 0%, #CC0000 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top, #FF0000 0%, #CC0000 100%); /* IE10+ */
        background: linear-gradient(to bottom, #FF0000 0%, #CC0000 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#FF0000', endColorstr='#CC0000', GradientType=0 ); /* IE6-9 */
    }
    .barValue {
        float:right;
        margin-top:-2px;
        font-size:10px;
        color:#FFF;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T20:09:35.127

你有你的参数在这里倒退：

```
$(this, ".barContainer .barValue") 
```

应该

```
$(".barContainer .barValue", this) 
```

第一个参数是选择器，第二个是上下文。

[http://jsfiddle.net/pYmbP/3/](http://jsfiddle.net/pYmbP/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:11:11.273

```
$(function() {
$(".barChart").each(function() {
    $(this).html("<div class='barLabel'>" 
        + $(this).data('title') + 
    "</div><div class='barContainer'><div class='bar' style='width:" 
        + $(this).data('value') + 
    "%'><div class='barValue'>" 
        + $(this).data('value') + "%" 
        + "</div></div></div>");
    if($(this).data('value') <= 10) {
        $(this).find('.barValue').css({
            "margin-right": "-20px",
            color: "#000",
        });
    }
});
}); 
```

这应该做你喜欢的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:11:45.670

`.barContainer .barValue`是`this`（当前`.barchart`元素）的后代。使用 jQuery 选择器语法，上下文是*第二个*参数，而不是第一个：

```
$(".barContainer .barValue", this) 
```

或者您可以使用`.find`，因为无论如何它都会在内部完成

```
$(this).find(".barContainer .barValue") 
```

[http://jsfiddle.net/ExplosionPIlls/pYmbP/4/](http://jsfiddle.net/ExplosionPIlls/pYmbP/4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:08:25.563

$(this).data('value') 不是整数，不能比较为。尝试：

```
parseInt($(this).data('value')) 
```

# php - 允许特定的 PHP 文件访问强化的 wp-content 文件夹

> ID：14780479
> 
> 赞同：4
> 
> 时间：2013-02-08T19:04:03.580
> 
> 标签：php, .htaccess

1) 我的 wp-content 使用包含以下代码的 .htaccess 文件进行了强化：

```
<Files *.php> 
deny from all
</Files> 
```

2）我想要（需要）授权`xml-sitemap-xsl.php`否则我在我的错误日志中得到这个错误：`client denied by server configuration: /home/user/mysite.net/wp-content/plugins/wordpress-seo/css/xml-sitemap-xsl.php, referer: http://mysite.net/sitemap_index.xml`

3）我想我应该添加以下代码，但我不确定它是否是正确的代码，也不确定它的放置位置：

```
<Files "xml-sitemap-xsl.php">
Allow from all
</Files> 
```

我要避免的是拒绝和允许命令之间的冲突。

谢谢，

P。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T19:18:21.400

**这**与 Wordpress 没有太大关系，我也不`.htaccess`是**.**`.php`**`.php`**

该`<Files>`指令用于向特定文件添加特定规则，据我所知，它*级联*.

考虑到您的评论，这应该可以解决问题

```
<Files *.php> 
    deny from all
</Files>
<Files "xml-sitemap-xsl.php">
    Order Allow,Deny
    Allow from all
</Files> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:21:21.840

请参阅：[拒绝直接访问除 index.php 之外的所有 .php 文件](https://stackoverflow.com/questions/1340001/deny-direct-access-to-all-php-files-except-index-php/1607587#1607587)

# java - 线程退出回调

> ID：14780486
> 
> 赞同：8
> 
> 时间：2013-02-08T20:06:21.730
> 
> 标签：java, thread-safety

我需要能够为当前正在运行的线程注入一些退出代码。我已经为此苦苦挣扎了一段时间，终于想出了一个解决方案，这里有一些类似于我正在做的代码：

```
public static void injectThreadExitCallback(final Runnable callback) {
    final curr = Thread.currentThread();
    new Thread() {
        @Override
        public void run() {
            try {
                curr.join();
                callback.run();
            } catch (InterruptedException ex) {
                ... logging ...
            }
        }
    }.start();
} 
```

它似乎工作正常并且完全符合我的要求，我唯一担心的是，如果这会导致任何泄漏或其他不良副作用，我可能不会看到。

或者这完全没问题，如果是这样，这非常有用。我可以看到一个简单的库，它可以动态地将退出代码添加到现有线程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:12:23.933

你最好这样做

```
new Thread () {
    @Override
    public void run () {
        try
        {
            // Thread logic here
        }
        finally
        {
            // Thread exit logic here
        }
    }
}.start (); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T20:29:03.903

除非该线程正在积极协作，否则您不可能将代码注入正在运行的线程中，例如 AWT 中的 Event Dispatch Thread，它的根部有一个循环，可将 Runnables 从队列中取出并执行它们。

您的设计可能会将数据竞争引入以前是单线程的代码中，因此没有并发问题。

最后，该设计浪费了宝贵的系统资源（一个线程），只能等待另一个线程完成。

如果您需要它来从外部修补一些现有代码，那么它可能是唯一的选择；如果没有，最好为其提供一个更有效的明确机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:14:24.737

如果您想确保无论如何调用它，您可以`callback.run();`在块之后`catch`或块中移动`final`

# ruby - ruby watir-webdriver 在哈希中使用变量

> ID：14780492
> 
> 赞同：2
> 
> 时间：2013-02-08T20:06:46.797
> 
> 标签：ruby, watir-webdriver

我正在尝试创建中间有变量的哈希。我似乎无法将变量视为仅作为文字的变量。变量是数组colors中的一个元素
如

```
text1 = {:style => 'background-color: variable;'} 
```

我以为这会奏效。

```
text1 = {:style => 'background-color: #{variable};'} 
```

以下工作，但它是一种迂回的方法

```
text2 = ''
text2  << "background-color: " << variable << ";"
text1 = {:style => text2} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:49:43.190

如果要使用 将变量插入字符串`#{}`，则需要使用双引号而不是单引号。

```
variable = "green"
text1 = {:style => "background-color: #{variable};"}  #Notice the double quotes
#=> {:style=>"background-color: green;"} 
```

# html - 使图像透明的最佳方法是什么？

> ID：14780493
> 
> 赞同：1
> 
> 时间：2013-02-08T20:06:47.563
> 
> 标签：html, css

我需要向页面添加透明图像，这里有两种方法 - 保存为半透明 png（无论如何它都会有一些透明部分）或将其保存为完全填充，然后在 css 中添加“不透明度”。什么是正确的方法，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:07:45.347

将图像保存为透明 png。并非所有浏览器都支持该`opacity`样式。

# ruby-on-rails - 寻找一种在 Rails 站点中重定向 aspx 请求的方法

> ID：14780497
> 
> 赞同：2
> 
> 时间：2013-02-08T20:07:03.460
> 
> 标签：ruby-on-rails, routing

我们正在创建一个新的基于 Rails 的站点，它将取代一个旧的 .Net 站点，这带来了一个有趣的问题 - 有没有一种方法可以在 Rails 中设置一个路由，将所有请求重定向到 .aspx页面到我的 Rails 应用程序的某个地方？比如说主页？

我可以执行以下简单的操作来将请求重定向到单个页面：

```
get '/page.aspx' => 'home#index' 
```

但我想做类似以下的事情：

```
match '/*.aspx' => redirect('/') 
```

该规则确实有效，但效果有点太好了——我的所有请求现在都被重定向到 root，而不仅仅是 aspx 页面的请求，那么有没有更好的方法来定义 aspx 匹配规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:18:02.830

我只是`before_filter`在应用程序控制器中设置一个：

```
def ApplicationController <  ActionController::Base
  before_filter :redirect_aspx

  private

  def redirect_aspx
    redirect_to "/", status: :moved_permanently if params[:format] == 'aspx'
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:27:34.117

```
scope :format => true, :constraints => { :format => 'aspx' } do
  get '/*x' => redirect('/')
end 
```

# wpf - VS 告诉我我的课完全不存在

> ID：14780500
> 
> 赞同：2
> 
> 时间：2013-02-08T20:07:23.853
> 
> 标签：wpf, visual-studio-2012

我为我的 WPF 应用程序编写了一个 MarkupExtension。Visual Studio 2012 中的 XAML 设计器报告以下错误。

> 错误 1 ​​名称“MyMarkupExtension”在命名空间“clr-namespace:MyNamespace”中不存在。

它确实存在于该命名空间中。我已经检查了三次。我已经建造、重建、清理和建造，然后关闭并重新启动了 Visual Studio。没有任何效果。我不明白。它在同一个爆炸组件中。我没有做任何有趣的把戏。除了 Visual Studio 暗地里恨我之外，没有任何理由不可行！

# qt - Qt5 & QtQuick2 - 透明主窗口

> ID：14780504
> 
> 赞同：8
> 
> 时间：2013-02-08T20:07:33.380
> 
> 标签：qt, qml, qt5, qtquick2

我正在尝试创建一个带有无框窗口和圆角的简单 Qt UI。从使用*QtQuick 2 应用程序*模板的新项目开始，我的代码如下所示：

*主文件*

```
#include <QtGui/QGuiApplication>
#include "qtquick2applicationviewer.h"

int main(int argc, char *argv[])
{
    QGuiApplication app(argc, argv);

    QtQuick2ApplicationViewer viewer;

    viewer.setMainQmlFile(QStringLiteral("qml/qtquick-test/main.qml"));
    viewer.setFlags(Qt::FramelessWindowHint);
    viewer.showExpanded();

    return app.exec();
} 
```

*main.qml*

```
import QtQuick 2.0

Rectangle {
    width: 360
    height: 360
    radius: 10
    color: "red"

    Text {
        text: qsTr("Hello World")
        anchors.centerIn: parent
    }
    MouseArea {
        anchors.fill: parent
        onClicked: {
            Qt.quit();
        }
    }
} 
```

这是结果：

![这就是结果](../Images/5f3e3e1139fe0e6f669169271b1e9582.png)

我不想做的是通过使主窗口透明来摆脱白色角落。但是，据我所知，Qt5 中没有办法做到这一点，因为我们没有样式表等，而且我没有使用 QtWidget。我应该使用 QtWidget 吗？

顺便说一句，我是 Qt 和 Qt5 的新手。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-24T10:16:41.797

这适用于我在 Windows 8 和 Ubuntu 12.04 下。

```
import QtQuick 2.3
import QtQuick.Window 2.2

Window {
    width: 300
    height: 300
    flags: Qt.FramelessWindowHint | Qt.Window
    color: "transparent"

    Rectangle {
        color: "brown"
        anchors.fill: parent
        anchors.margins: 10
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-01T22:37:38.263

对于像我一样偶然发现这么晚的人。至少对于 C++ 和 Python，您必须指定小部件属性`WA_TranslucentBackground`才能使背景透明。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-31T06:06:20.413

您必须使用
`viewer.setMask()`
它来告诉显示 qml 的 qt 小部件在哪里绘制以及在哪里不绘制......

我主要使用矩形掩码，但 setMask 接受 QRegion 我认为它支持更复杂的形式甚至位图掩码

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-06-12T15:16:03.013

将背景清除颜色设置为在应用程序查看器上的 alpha 为 0：

```
viewer.setColor(QColor(0, 0, 0, 0)); 
```

# c# - clickonce 部署后，工作应用程序无法使用 webclient

> ID：14780505
> 
> 赞同：0
> 
> 时间：2013-02-08T20:07:34.690
> 
> 标签：c#, clickonce

我使用 C# express 2010 构建了一个应用程序，它在我的机器上运行良好，部署成功，但我似乎无法使其正常运行。

似乎有问题的是对自定义 JSON 服务的所有 WebClient 调用。

1.  在VS2010中，它们都可以工作，
2.  如果我在 bin 文件夹中拾取 exe 一切正常，
3.  但是在 ClickOnce 安装中，不，没有工作......

这可能是什么原因...

我尝试了不同的 ClickOnce 安全设置，问题仍然存在......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T13:45:24.443

简短的回答，它不再存在，证明：

[http://blogs.msdn.com/b/krimakey/archive/2009/05/20/where-did-my-permission-set-controls-go.aspx](http://blogs.msdn.com/b/krimakey/archive/2009/05/20/where-did-my-permission-set-controls-go.aspx)

长答案是：您可以使用以下准则在 XML 编辑器中自己设置 trustinfo：

[http://msdn.microsoft.com/en-us/library/6ad1fshk(VS.80).aspx](http://msdn.microsoft.com/en-us/library/6ad1fshk(VS.80).aspx)

# c# - 自定义 Nullable 结构

> ID：14780510
> 
> 赞同：0
> 
> 时间：2013-02-08T20:07:51.773
> 
> 标签：c#, clr

我正在阅读[CLR Via C#](https://rads.stackoverflow.com/amzn/click/com/0735667454) 书并尝试提供的示例。

```
[Serializable, StructLayout(LayoutKind.Sequential)]
public struct MyNullable<T> where T : struct
{
    private readonly  bool _hasValue ; //Should be false
    private readonly T _value; //Really should be value=default(T)

    public MyNullable(T value)
    {
        _value = value;
        _hasValue = true;
    }

    public bool HasValue {
        get { return _hasValue; }
    }

    public T Value
    {
        get
        {
            if (!_hasValue)
            {
                throw new InvalidOperationException("Nullable object must have a value");
            }
            return _value;
        }
    }

    public T GetValueOrDefault()
    {
        return _value;
    }

    public T GetValueOrDefault(T defaultValue)
    {
        return !_hasValue ? defaultValue : _value;
    }

    public override bool Equals(object obj)
    {
        if (!_hasValue) return obj == null;
        if (obj == null) return false;
        return _value.Equals(obj);
    }

    public override int GetHashCode()
    {
        return !_hasValue ? 0 : _value.GetHashCode();
    }
    public override string ToString()
    {
        return _hasValue ? _value.ToString() : "";
    }

    public static implicit operator MyNullable<T>(T value)
    {
        return new MyNullable<T>(value);
    }

    public static explicit operator T(MyNullable<T> value)
    {
        return value.Value;
    }
} 
```

这段代码应该让我为 MyNullable 分配一个空值

MyNullable i = null;

但 Visual Studio 给我的错误消息是“无法将源类型 null 转换为目标类型 MyNullable”

我认为 **公共静态隐式运算符 MyNullable(T value)** 和

```
 **public static explicit operator T(MyNullable<T> value)** 
```

成功了，但似乎并非如此。

有什么办法可以让这段代码工作吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:13:22.710

正如@EricLippert 在他最近的一篇博客文章中所说，不可能在用户代码中实现。幕后发生了很多事情。

请参阅：[http ://ericlippert.com/2012/12/20/nullable-micro-optimizations-part-one/](http://ericlippert.com/2012/12/20/nullable-micro-optimizations-part-one/)

# msdtc - MSDTC/DTCPing 仅在一个方向上起作用

> ID：14780514
> 
> 赞同：5
> 
> 时间：2013-02-08T20:08:06.843
> 
> 标签：msdtc

如果我设置了两台 windows server 2008 r2 机器，我可以让分布式事务只在一个方向上工作。当我可以让 DTCPing 成功工作时，DTC 正在工作。但是，DTCPing 仅在我从一台机器开始测试到另一台机器时才有效，反之则不行。

让我们称我的机器应用程序和数据库。

如果我在两者上开始 DTCPing 并将应用程序键入数据库上的实例并按 Enter，则 DTCPing 反映成功。

如果我在应用程序上的实例和密钥数据库上都开始 DTCPing，我没有得到任何说有故障的信息，它只是没有运行完成。看起来它完成了 rpc 测试，但没有进行绑定测试。日志确实反映了一个错误，但我的理解是它与集群检查有关，并且这些机器不在集群中并且没关系。如果这不正确，请通知我，但是当我在成功的方向上进行 DTCPing 时，我确实在日志中看到了同样的错误。

应用程序的 DTCPing 窗口中的输出显示如下：

```
DTCping log file: C:\DTCPing\APP1840.log
RPC server is ready
Please Start Partner DTCping before pinging
++++++++++++Validating Remote Computer Name++++++++++++
Please refer to following log file for details:
    C:\DTCPing\APP1840.log
Invoking RPC method on database
RPC test is successful
++++++++++++RPC test completed+++++++++++++++
Please start PING from database to complete the test 
```

数据库窗口中的输出显示：

```
DTCping log file: C:\DTCPing\DATABASE1612.log
RPC server is ready
Please Start Partner DTCping before pinging
Please send following LOG to Microsoft for analysis:
    Partner LOG: APP1840.log
    My LOG: DATABASE1612.log 
```

登录应用程序是这样的：

```
IP Configure Information
    Host Name . . . . . . . . . : app
    DNS Servers . . . . . . . . : 10.40.100.2
                                         10.60.100.2
    Node Type . . . . . . . . . : Hybrid
    NetBIOS Scope ID. . . . . . : 
    IP Routing Enabled. . . . . : no
    WINS Proxy Enabled. . . . . : no
    NetBIOS Resolution Uses DNS : no

Ethernet adapter {870B0C62-7C24-482A-ACCD-61B112ED77EB}:

    Description . . . . . . . . : vmxnet3 Ethernet Adapter #5
    Physical Address. . . . . . : 00-50-56-01-01-9B
    DHCP Enabled. . . . . . . . : no
    IP Address. . . . . . . . . : 10.45.20.50
    Subnet Mask . . . . . . . . : 255.255.255.0
    Default Gateway . . . . . . : 10.45.20.1
    DHCP Server . . . . . . . . : 
    Primary WINS Server . . . . : 
    Secondary WINS Server . . . : 
    Lease Obtained. . . . . . . : Thu Jan 01 00:00:00 1970
    Lease Expires . . . . . . . : Thu Jan 01 00:00:00 1970

++++++++++++lmhosts.sam++++++++++++

++++++++++++hosts      ++++++++++++

02-08, 12:49:53.496-->Error(0x424) at clutil.cpp @256
02-08, 12:49:53.496-->-->OpenCluster
02-08, 12:49:53.496-->-->1060(The specified service does not exist as an installed service.)
++++++++++++++++++++++++++++++++++++++++++++++
     DTCping 1.9 Report for APP  
++++++++++++++++++++++++++++++++++++++++++++++
RPC server is ready
++++++++++++Validating Remote Computer Name++++++++++++
02-08, 12:50:03.589-->Start DTC connection test
Name Resolution:
    database-->10.45.20.48-->database
02-08, 12:50:03.667-->Start RPC test (APP-->database)
RPC test is successful
    Partner's CID:FF897F99-E4A4-47EE-9FD2-6B09BED00B86
++++++++++++RPC test completed+++++++++++++++ 
```

登录数据库是这样的：

```
IP Configure Information
    Host Name . . . . . . . . . : database
    DNS Servers . . . . . . . . : 10.40.100.2
                                         10.60.100.2
    Node Type . . . . . . . . . : Hybrid
    NetBIOS Scope ID. . . . . . : 
    IP Routing Enabled. . . . . : no
    WINS Proxy Enabled. . . . . : no
    NetBIOS Resolution Uses DNS : no

Ethernet adapter {FCCFD12A-F8C1-4EB8-87D1-E2C2CFC07AB9}:

    Description . . . . . . . . : vmxnet3 Ethernet Adapter #6
    Physical Address. . . . . . : 00-50-56-01-01-99
    DHCP Enabled. . . . . . . . : no
    IP Address. . . . . . . . . : 10.45.20.48
    Subnet Mask . . . . . . . . : 255.255.255.0
    Default Gateway . . . . . . : 10.45.20.1
    DHCP Server . . . . . . . . : 
    Primary WINS Server . . . . : 
    Secondary WINS Server . . . : 
    Lease Obtained. . . . . . . : Thu Jan 01 00:00:00 1970
    Lease Expires . . . . . . . : Thu Jan 01 00:00:00 1970

++++++++++++lmhosts.sam++++++++++++

++++++++++++hosts      ++++++++++++

02-08, 12:49:47.953-->Error(0x424) at clutil.cpp @256
02-08, 12:49:47.953-->-->OpenCluster
02-08, 12:49:47.953-->-->1060(The specified service does not exist as an installed service.)
++++++++++++++++++++++++++++++++++++++++++++++
     DTCping 1.9 Report for DATABASE  
++++++++++++++++++++++++++++++++++++++++++++++
RPC server is ready
02-08, 12:50:02.822-->RPC server:DATABASE received following information:
    Network Name: database
    Source  Port: 49198
    Partner LOG: APP1840.log
    Partner CID: C94B257A-E177-4DFE-BC29-A33740ED59D9 
```

我应该期望 MSDTC 通常会双向工作吗？我有理由看到这种行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-17T11:18:38.220

从来没有解决这个问题。最终只是让交易朝着正确的方向工作，并放弃了让它双向工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-11T00:33:04.147

我遇到了和你一样的问题。

我会向你推荐：

请按照以下几点对 MSDTC 进行故障排除

[https://blogs.msdn.microsoft.com/distributedservices/2011/11/22/troubleshooting-msdtc-communication-checklist/](https://blogs.msdn.microsoft.com/distributedservices/2011/11/22/troubleshooting-msdtc-communication-checklist/)

如果所有步骤都正常，SQL server 和 Webserver 之间的通信通过了 WinRm 测试。如果，只有 DTCPing 中的错误仍然存​​在，请执行以下步骤。

错误可能位于机器的 CID 中。这往往发生在使用基于现有图像创建的机器时，例如由 Softlayer 或 Aws 创建的机器。

您可以识别这是否是错误，因为在机器中，如果 DTCPing 中的通信失败，您将获得一个合作伙伴 CID：00000000-0000-0000-0000-000000000000。

然后按照此页面中的 CID 解析步骤（考虑重新安装）。 [https://msdn.microsoft.com/en-us/library/aa561924.aspx](https://msdn.microsoft.com/en-us/library/aa561924.aspx)

如果您需要更多帮助，请给我一些反馈。

# c++ - Qt 中的切换开关

> ID：14780517
> 
> 赞同：33
> 
> 时间：2013-02-08T20:08:18.417
> 
> 标签：c++, qt, user-interface

我正在尝试使用与Qt中的[Android 开关等效的元素。](http://developer.android.com/design/building-blocks/switches.html)我在 QML 中找到了一个 ToggleSwitch，但在实际的 C++ Qt 库中什么也没有。我只是遗漏了什么，还是我必须自己重新实现这个小部件？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2016-06-29T14:27:54.510

这是一个例子：

`switch.h`：

```
#pragma once
#include <QtWidgets>

class Switch : public QAbstractButton {
    Q_OBJECT
    Q_PROPERTY(int offset READ offset WRITE setOffset)
    Q_PROPERTY(QBrush brush READ brush WRITE setBrush)

public:
    Switch(QWidget* parent = nullptr);
    Switch(const QBrush& brush, QWidget* parent = nullptr);

    QSize sizeHint() const override;

    QBrush brush() const {
        return _brush;
    }
    void setBrush(const QBrush &brsh) {
        _brush = brsh;
    }

    int offset() const {
        return _x;
    }
    void setOffset(int o) {
        _x = o;
        update();
    }

protected:
    void paintEvent(QPaintEvent*) override;
    void mouseReleaseEvent(QMouseEvent*) override;
    void enterEvent(QEvent*) override;

private:
    bool _switch;
    qreal _opacity;
    int _x, _y, _height, _margin;
    QBrush _thumb, _track, _brush;
    QPropertyAnimation *_anim = nullptr;
}; 
```

`switch.cpp`：

```
Switch::Switch(QWidget *parent) : QAbstractButton(parent),
_height(16),
_opacity(0.000),
_switch(false),
_margin(3),
_thumb("#d5d5d5"),
_anim(new QPropertyAnimation(this, "offset", this))
{
    setOffset(_height / 2);
    _y = _height / 2;
    setBrush(QColor("#009688"));
}

Switch::Switch(const QBrush &brush, QWidget *parent) : QAbstractButton(parent),
_height(16),
_switch(false),
_opacity(0.000),
_margin(3),
_thumb("#d5d5d5"),
_anim(new QPropertyAnimation(this, "offset", this))
{
    setOffset(_height / 2);
    _y = _height / 2;
    setBrush(brush);
}

void Switch::paintEvent(QPaintEvent *e) {
    QPainter p(this);
    p.setPen(Qt::NoPen);
    if (isEnabled()) {
        p.setBrush(_switch ? brush() : Qt::black);
        p.setOpacity(_switch ? 0.5 : 0.38);
        p.setRenderHint(QPainter::Antialiasing, true);
        p.drawRoundedRect(QRect(_margin, _margin, width() - 2 * _margin, height() - 2 * _margin), 8.0, 8.0);
        p.setBrush(_thumb);
        p.setOpacity(1.0);
        p.drawEllipse(QRectF(offset() - (_height / 2), _y - (_height / 2), height(), height()));
    } else {
        p.setBrush(Qt::black);
        p.setOpacity(0.12);
        p.drawRoundedRect(QRect(_margin, _margin, width() - 2 * _margin, height() - 2 * _margin), 8.0, 8.0);
        p.setOpacity(1.0);
        p.setBrush(QColor("#BDBDBD"));
        p.drawEllipse(QRectF(offset() - (_height / 2), _y - (_height / 2), height(), height()));
    }
}

void Switch::mouseReleaseEvent(QMouseEvent *e) {
    if (e->button() & Qt::LeftButton) {
        _switch = _switch ? false : true;
        _thumb = _switch ? _brush : QBrush("#d5d5d5");
        if (_switch) {
            _anim->setStartValue(_height / 2);
            _anim->setEndValue(width() - _height);
            _anim->setDuration(120);
            _anim->start();
        } else {
            _anim->setStartValue(offset());
            _anim->setEndValue(_height / 2);
            _anim->setDuration(120);
            _anim->start();
        }
    }
    QAbstractButton::mouseReleaseEvent(e);
}

void Switch::enterEvent(QEvent *e) {
    setCursor(Qt::PointingHandCursor);
    QAbstractButton::enterEvent(e);
}

QSize Switch::sizeHint() const {
    return QSize(2 * (_height + _margin), _height + 2 * _margin);
} 
```

`main.cpp`：

```
#include "switch.h"

    int main(int argc, char *argv[]) {
        QApplication a(argc, argv);
        QWidget *widget = new QWidget;
        widget->setWindowFlags(Qt::FramelessWindowHint);
        QHBoxLayout layout;
        widget->setLayout(&layout);
        Switch *_switch = new Switch;
        Switch *_switch2 = new Switch;
        _switch2->setDisabled(true);
        layout.addWidget(_switch);
        layout.addWidget(_switch2);
        widget->show();
        return a.exec();
    } 
```

[![在此处输入图像描述](../Images/d6b32cf2d53beae974295f07d5ed5d27.png)](https://i.stack.imgur.com/kjzll.gif)

# 2018 年 8 月 20 日更新

**新材质切换小工具！**

`style.h`

```
/*
 * This is nearly complete Material design Switch widget implementation in qtwidgets module.
 * More info: https://material.io/design/components/selection-controls.html#switches
 * Copyright (C) 2018 Iman Ahmadvand
 *
 * This is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * It is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
*/

#ifndef STYLE_H
#define STYLE_H

#include <QtCore/qeasingcurve.h>

#define cyan500 QColor("#00bcd4")
#define gray50 QColor("#fafafa")
#define black QColor("#000000")
#define gray400 QColor("#bdbdbd")

Q_DECL_IMPORT void qt_blurImage(QPainter *p, QImage &blurImage, qreal radius, bool quality, bool alphaOnly, int transposed = 0); // src/widgets/effects/qpixmapfilter.cpp

namespace Style {

    using Type = QEasingCurve::Type;

    struct Animation {
        Animation() = default;
        Animation(Type _easing, int _duration) :easing{ _easing }, duration{ _duration } {

        }

        Type easing;
        int duration;
    };

    struct Switch {
        Switch() :
            height{ 36 },
            font{ QFont("Roboto medium", 13) },
            indicatorMargin{ QMargins(8, 8, 8, 8) },
            thumbOnBrush{ cyan500 },
            thumbOnOpacity{ 1 },
            trackOnBrush{ cyan500 },
            trackOnOpacity{ 0.5 },
            thumbOffBrush{ gray50 },
            thumbOffOpacity{ 1 },
            trackOffBrush{ black },
            trackOffOpacity{ 0.38 },
            thumbDisabled{ gray400 },
            thumbDisabledOpacity{ 1 },
            trackDisabled{ black },
            trackDisabledOpacity{ 0.12 },
            textColor{ black },
            disabledTextOpacity{ 0.26 },
            thumbBrushAnimation{ Animation(Type::Linear, 150) },
            trackBrushAnimation{ Animation(Type::Linear, 150) },
            thumbPosAniamtion{ Animation(Type::InOutQuad, 150) } {

        }

        int height;
        QFont font;
        QMargins indicatorMargin;
        QColor thumbOnBrush;
        double thumbOnOpacity;
        QColor trackOnBrush;
        double trackOnOpacity;
        QColor thumbOffBrush;
        double thumbOffOpacity;
        QColor trackOffBrush;
        double trackOffOpacity;
        QColor thumbDisabled;
        double thumbDisabledOpacity;
        QColor trackDisabled;
        double trackDisabledOpacity;
        QColor textColor;
        double disabledTextOpacity;
        Animation thumbBrushAnimation;
        Animation trackBrushAnimation;
        Animation thumbPosAniamtion;
    };

    inline QPixmap drawShadowEllipse(qreal radius, qreal elevation, const QColor& color) {
        auto px = QPixmap(radius * 2, radius * 2);
        px.fill(Qt::transparent);

        { // draw ellipes
            QPainter p(&px);
            p.setBrush(color);
            p.setPen(Qt::NoPen);
            p.setRenderHint(QPainter::Antialiasing, true);
            p.drawEllipse(QRectF(0, 0, px.size().width(), px.size().height()).center(), radius - elevation, radius - elevation);
        }

        QImage tmp(px.size(), QImage::Format_ARGB32_Premultiplied);
        tmp.setDevicePixelRatio(px.devicePixelRatioF());
        tmp.fill(0);
        QPainter tmpPainter(&tmp);
        tmpPainter.setCompositionMode(QPainter::CompositionMode_Source);
        tmpPainter.drawPixmap(QPointF(), px);
        tmpPainter.end();

        // blur the alpha channel
        QImage blurred(tmp.size(), QImage::Format_ARGB32_Premultiplied);
        blurred.setDevicePixelRatio(px.devicePixelRatioF());
        blurred.fill(0);
        {
            QPainter blurPainter(&blurred);
            qt_blurImage(&blurPainter, tmp, elevation * 4., true, false);
        }

        tmp = blurred;

        return QPixmap::fromImage(tmp);
    }

} // namespace Style

#endif // STYLE_H 
```

`switch.h`

```
/*
 * This is nearly complete Material design Switch widget implementation in qtwidgets module.
 * More info: https://material.io/design/components/selection-controls.html#switches
 * Copyright (C) 2018-2020 Iman Ahmadvand
 *
 * This is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * It is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
*/

#ifndef SWITCH_H
#define SWITCH_H

#include <QtWidgets>
#include "style.h"

class Animator final : public QVariantAnimation {
    Q_OBJECT
    Q_PROPERTY(QObject* targetObject READ targetObject WRITE setTargetObject)

  public:
    Animator(QObject* target, QObject* parent = nullptr);
    ~Animator() override;

    QObject* targetObject() const;
    void setTargetObject(QObject* target);

    inline bool isRunning() const {
        return state() == Running;
    }

  public slots:
    void setup(int duration, QEasingCurve easing = QEasingCurve::Linear);
    void interpolate(const QVariant& start, const QVariant& end);
    void setCurrentValue(const QVariant&);

  protected:
    void updateCurrentValue(const QVariant& value) override final;
    void updateState(QAbstractAnimation::State newState, QAbstractAnimation::State oldState) override final;

  private:
    QPointer<QObject> target;
};

class SelectionControl : public QAbstractButton {
    Q_OBJECT

  public:
    explicit SelectionControl(QWidget* parent = nullptr);
    ~SelectionControl() override;

    Qt::CheckState checkState() const;

  Q_SIGNALS:
    void stateChanged(int);

  protected:
    void enterEvent(QEvent*) override;
    void checkStateSet() override;
    void nextCheckState() override;
    virtual void toggle(Qt::CheckState state) = 0;
};

class Switch final : public SelectionControl {
    Q_OBJECT

    static constexpr auto CORNER_RADIUS = 8.0;
    static constexpr auto THUMB_RADIUS = 14.5;
    static constexpr auto SHADOW_ELEVATION = 2.0;

  public:
    explicit Switch(QWidget* parent = nullptr);
    Switch(const QString& text, QWidget* parent = nullptr);
    Switch(const QString& text, const QBrush&, QWidget* parent = nullptr);
    ~Switch() override;

    QSize sizeHint() const override final;

  protected:
    void paintEvent(QPaintEvent*) override final;
    void resizeEvent(QResizeEvent*) override final;
    void toggle(Qt::CheckState) override final;

    void init();
    QRect indicatorRect();
    QRect textRect();

    static inline QColor colorFromOpacity(const QColor& c, qreal opacity) {
        return QColor(c.red(), c.green(), c.blue(), qRound(opacity * 255.0));
    }
    static inline bool ltr(QWidget* w) {
        if (nullptr != w)
            return w->layoutDirection() == Qt::LeftToRight;

        return false;
    }

  private:
    Style::Switch style;
    QPixmap shadowPixmap;
    QPointer<Animator> thumbBrushAnimation;
    QPointer<Animator> trackBrushAnimation;
    QPointer<Animator> thumbPosAniamtion;
};

#endif // SWITCH_H 
```

`switch.cpp`

```
/*
 * This is nearly complete Material design Switch widget implementation in qtwidgets module.
 * More info: https://material.io/design/components/selection-controls.html#switches
 * Copyright (C) 2018-2020 Iman Ahmadvand
 *
 * This is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * It is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
*/

#include "switch.h"

Animator::Animator(QObject* target, QObject* parent) : QVariantAnimation(parent) {
    setTargetObject(target);
}

Animator::~Animator() {
    stop();
}

QObject* Animator::targetObject() const {
    return target.data();
}

void Animator::setTargetObject(QObject* _target) {
    if (target.data() == _target)
        return;

    if (isRunning()) {
        qWarning("Animation::setTargetObject: you can't change the target of a running animation");
        return;
    }

    target = _target;
}

void Animator::updateCurrentValue(const QVariant& value) {
    Q_UNUSED(value);

    if (!target.isNull()) {
        auto update = QEvent(QEvent::StyleAnimationUpdate);
        update.setAccepted(false);
        QCoreApplication::sendEvent(target.data(), &update);
        if (!update.isAccepted())
            stop();
    }
}

void Animator::updateState(QAbstractAnimation::State newState, QAbstractAnimation::State oldState) {
    if (target.isNull() && oldState == Stopped) {
        qWarning("Animation::updateState: Changing state of an animation without target");
        return;
    }

    QVariantAnimation::updateState(newState, oldState);

    if (!endValue().isValid() && direction() == Forward) {
        qWarning("Animation::updateState (%s): starting an animation without end value", targetObject()->metaObject()->className());
    }
}

void Animator::setup(int duration, QEasingCurve easing) {
    setDuration(duration);
    setEasingCurve(easing);
}

void Animator::interpolate(const QVariant& _start, const QVariant& end) {
    setStartValue(_start);
    setEndValue(end);
    start();
}

void Animator::setCurrentValue(const QVariant& value) {
    setStartValue(value);
    setEndValue(value);
    updateCurrentValue(currentValue());
}

SelectionControl::SelectionControl(QWidget* parent) : QAbstractButton(parent) {
    setObjectName("SelectionControl");
    setCheckable(true);
}

SelectionControl::~SelectionControl() {

}

void SelectionControl::enterEvent(QEvent* e) {
    setCursor(Qt::PointingHandCursor);
    QAbstractButton::enterEvent(e);
}

Qt::CheckState SelectionControl::checkState() const {
    return isChecked() ? Qt::Checked : Qt::Unchecked;
}

void SelectionControl::checkStateSet() {
    const auto state = checkState();
    emit stateChanged(state);
    toggle(state);
}

void SelectionControl::nextCheckState() {
    QAbstractButton::nextCheckState();
    SelectionControl::checkStateSet();
}

void Switch::init() {
    setFont(style.font);
    setObjectName("Switch");
    /* setup animations */
    thumbBrushAnimation = new Animator{ this, this };
    trackBrushAnimation = new Animator{ this, this };
    thumbPosAniamtion = new Animator{ this, this };
    thumbPosAniamtion->setup(style.thumbPosAniamtion.duration, style.thumbPosAniamtion.easing);
    trackBrushAnimation->setup(style.trackBrushAnimation.duration, style.trackBrushAnimation.easing);
    thumbBrushAnimation->setup(style.thumbBrushAnimation.duration, style.thumbBrushAnimation.easing);
    /* set init values */
    trackBrushAnimation->setStartValue(colorFromOpacity(style.trackOffBrush, style.trackOffOpacity));
    trackBrushAnimation->setEndValue(colorFromOpacity(style.trackOffBrush, style.trackOffOpacity));
    thumbBrushAnimation->setStartValue(colorFromOpacity(style.thumbOffBrush, style.thumbOffOpacity));
    thumbBrushAnimation->setEndValue(colorFromOpacity(style.thumbOffBrush, style.thumbOffOpacity));
    /* set standard palettes */
    auto p = palette();
    p.setColor(QPalette::Active, QPalette::ButtonText, style.textColor);
    p.setColor(QPalette::Disabled, QPalette::ButtonText, style.textColor);
    setPalette(p);
    setSizePolicy(QSizePolicy(QSizePolicy::Policy::Preferred, QSizePolicy::Policy::Fixed));
}

QRect Switch::indicatorRect() {
    const auto w = style.indicatorMargin.left() + style.height + style.indicatorMargin.right();
    return ltr(this) ? QRect(0, 0, w, style.height) : QRect(width() - w, 0, w, style.height);
}

QRect Switch::textRect() {
    const auto w = style.indicatorMargin.left() + style.height + style.indicatorMargin.right();
    return ltr(this) ? rect().marginsRemoved(QMargins(w, 0, 0, 0)) : rect().marginsRemoved(QMargins(0, 0, w, 0));
}

Switch::Switch(QWidget* parent) : SelectionControl(parent) {
    init();
}

Switch::Switch(const QString& text, QWidget* parent) : Switch(parent) {
    setText(text);
}

Switch::Switch(const QString& text, const QBrush& brush, QWidget* parent) : Switch(text, parent) {
    style.thumbOnBrush = brush.color();
    style.trackOnBrush = brush.color();
}

Switch::~Switch() {

}

QSize Switch::sizeHint() const {
    auto h = style.height;
    auto w = style.indicatorMargin.left() + style.height + style.indicatorMargin.right() + fontMetrics().width(text());

    return QSize(w, h);
}

void Switch::paintEvent(QPaintEvent*) {
    /* for desktop usage we do not need Radial reaction */

    QPainter p(this);

    const auto _indicatorRect = indicatorRect();
    const auto _textRect = textRect();
    auto trackMargin = style.indicatorMargin;
    trackMargin.setTop(trackMargin.top() + 2);
    trackMargin.setBottom(trackMargin.bottom() + 2);
    QRectF trackRect = _indicatorRect.marginsRemoved(trackMargin);

    if (isEnabled()) {
        p.setOpacity(1.0);
        p.setPen(Qt::NoPen);
        /* draw track */
        p.setBrush(trackBrushAnimation->currentValue().value<QColor>());
        p.setRenderHint(QPainter::Antialiasing, true);
        p.drawRoundedRect(trackRect, CORNER_RADIUS, CORNER_RADIUS);
        p.setRenderHint(QPainter::Antialiasing, false);
        /* draw thumb */
        trackRect.setX(trackRect.x() - trackMargin.left() - trackMargin.right() - 2 + thumbPosAniamtion->currentValue().toInt());
        auto thumbRect = trackRect;

        if (!shadowPixmap.isNull())
            p.drawPixmap(thumbRect.center() - QPointF(THUMB_RADIUS, THUMB_RADIUS - 1.0), shadowPixmap);

        p.setBrush(thumbBrushAnimation->currentValue().value<QColor>());
        p.setRenderHint(QPainter::Antialiasing, true);
        //        qDebug() << thumbRect << thumbPosAniamtion->currentValue();
        p.drawEllipse(thumbRect.center(), THUMB_RADIUS - SHADOW_ELEVATION - 1.0, THUMB_RADIUS - SHADOW_ELEVATION - 1.0);
        p.setRenderHint(QPainter::Antialiasing, false);

        /* draw text */
        if (text().isEmpty())
            return;

        p.setOpacity(1.0);
        p.setPen(palette().color(QPalette::Active, QPalette::ButtonText));
        p.setFont(font());
        p.drawText(_textRect, Qt::AlignLeft | Qt::AlignVCenter, text());
    } else {
        p.setOpacity(style.trackDisabledOpacity);
        p.setPen(Qt::NoPen);
        // draw track
        p.setBrush(style.trackDisabled);
        p.setRenderHint(QPainter::Antialiasing, true);
        p.drawRoundedRect(trackRect, CORNER_RADIUS, CORNER_RADIUS);
        p.setRenderHint(QPainter::Antialiasing, false);
        // draw thumb
        p.setOpacity(1.0);
        if (!isChecked())
            trackRect.setX(trackRect.x() - trackMargin.left() - trackMargin.right() - 2);
        else
            trackRect.setX(trackRect.x() + trackMargin.left() + trackMargin.right() + 2);
        auto thumbRect = trackRect;

        if (!shadowPixmap.isNull())
            p.drawPixmap(thumbRect.center() - QPointF(THUMB_RADIUS, THUMB_RADIUS - 1.0), shadowPixmap);

        p.setOpacity(1.0);
        p.setBrush(style.thumbDisabled);
        p.setRenderHint(QPainter::Antialiasing, true);
        p.drawEllipse(thumbRect.center(), THUMB_RADIUS - SHADOW_ELEVATION - 1.0, THUMB_RADIUS - SHADOW_ELEVATION - 1.0);

        /* draw text */
        if (text().isEmpty())
            return;

        p.setOpacity(style.disabledTextOpacity);
        p.setPen(palette().color(QPalette::Disabled, QPalette::ButtonText));
        p.setFont(font());
        p.drawText(_textRect, Qt::AlignLeft | Qt::AlignVCenter, text());
    }
}

void Switch::resizeEvent(QResizeEvent* e) {
    shadowPixmap = Style::drawShadowEllipse(THUMB_RADIUS, SHADOW_ELEVATION, QColor(0, 0, 0, 70));
    SelectionControl::resizeEvent(e);
}

void Switch::toggle(Qt::CheckState state) {
    if (state == Qt::Checked) {
        const QVariant posEnd = (style.indicatorMargin.left() + style.indicatorMargin.right() + 2) * 2;
        const QVariant thumbEnd = colorFromOpacity(style.thumbOnBrush, style.thumbOnOpacity);
        const QVariant trackEnd = colorFromOpacity(style.trackOnBrush, style.trackOnOpacity);

        if (!isVisible()) {
            thumbPosAniamtion->setCurrentValue(posEnd);
            thumbBrushAnimation->setCurrentValue(thumbEnd);
            trackBrushAnimation->setCurrentValue(trackEnd);
        } else {
            thumbPosAniamtion->interpolate(0, posEnd);
            thumbBrushAnimation->interpolate(colorFromOpacity(style.thumbOffBrush, style.thumbOffOpacity), thumbEnd);
            trackBrushAnimation->interpolate(colorFromOpacity(style.trackOffBrush, style.trackOffOpacity), trackEnd);
        }
    } else { // Qt::Unchecked
        const QVariant posEnd = 0;
        const QVariant thumbEnd = colorFromOpacity(style.thumbOffBrush, style.thumbOffOpacity);
        const QVariant trackEnd = colorFromOpacity(style.trackOffBrush, style.trackOffOpacity);

        if (!isVisible()) {
            thumbPosAniamtion->setCurrentValue(posEnd);
            thumbBrushAnimation->setCurrentValue(thumbEnd);
            trackBrushAnimation->setCurrentValue(trackEnd);
        } else {
            thumbPosAniamtion->interpolate(thumbPosAniamtion->currentValue().toInt(), posEnd);
            thumbBrushAnimation->interpolate(colorFromOpacity(style.thumbOnBrush, style.thumbOnOpacity), thumbEnd);
            trackBrushAnimation->interpolate(colorFromOpacity(style.trackOnBrush, style.trackOnOpacity), trackEnd);
        }
    }
} 
```

`main.cpp`

```
#include "switch.h"

int main(int argc, char *argv[]) {
    QApplication application(argc, argv);
    QWidget container;
    QVBoxLayout mainLayout;
    container.setLayout(&mainLayout);

    Switch* switch1 = new Switch("SWITCH");
    mainLayout.addWidget(switch1);
    Switch* switch2 = new Switch("SWITCH");
    mainLayout.addWidget(switch2);
    switch2->setDisabled(true);
    Switch* switch3 = new Switch("SWITCH");
    mainLayout.addWidget(switch3);
    switch3->setLayoutDirection(Qt::RightToLeft);
    Switch* switch4 = new Switch("SWITCH");
    mainLayout.addWidget(switch4);
    switch4->setLayoutDirection(Qt::RightToLeft);
    switch4->setChecked(true);
    switch4->setDisabled(true);

    QButtonGroup bg;
    Switch* item1 = new Switch("ITEM1");
    Switch* item2 = new Switch("ITEM2");
    bg.addButton(item1);
    bg.addButton(item2);
    mainLayout.addWidget(item1);
    mainLayout.addWidget(item2);
    mainLayout.setMargin(100);

    container.show();
    return application.exec();
} 
```

结果：

[![在此处输入图像描述](../Images/d94124b608d887205ab4bb38949b0f32.png)](https://i.stack.imgur.com/0DNuw.gif)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2018-06-25T12:20:06.343

几个月前，我做了一个实现，它的视觉效果需要与常见的桌面样式更加一致（可用的 C++ 和 Python 版本；Python 版本是原型，即它们可能会以不同的方式工作）。请注意，美学是使用`paintEvent`. 不要期望不同的视觉效果取决于系统。

[![Qt (C++;Python) 中的开关按钮实现](../Images/b6b88e66cecbd1309ae0ec33d58e87bd.png)](https://i.stack.imgur.com/IGtD5.gif)

* * *

**C++ 实现**

注意：不要忘记包含（不在我的示例中）。

*用法：*

```
SwitchButton* sbtn = new SwitchButton(this); // Default style is Style::ONOFF
bool current = sbtn->value();
sbtn->setValue(!current); 
```

*(...).hpp*

```
class SwitchButton : public QWidget
{
  Q_OBJECT
    Q_DISABLE_COPY(SwitchButton)

public:
  enum Style
  {
    YESNO,
    ONOFF,
    BOOL,
    EMPTY
  };

public:
  explicit SwitchButton(QWidget* parent = nullptr, Style style = Style::ONOFF);
  ~SwitchButton() override;

  //-- QWidget methods
  void mousePressEvent(QMouseEvent *) override;
  void paintEvent(QPaintEvent* event) override;
  void setEnabled(bool);

  //-- Setters
  void setDuration(int);
  void setValue(bool);

  //-- Getters
  bool value() const;

signals:
  void valueChanged(bool newvalue);

private:
  class SwitchCircle;
  class SwitchBackground;
  void _update();

private:
  bool _value;
  int  _duration;

  QLinearGradient _lg;
  QLinearGradient _lg2;
  QLinearGradient _lg_disabled;

  QColor _pencolor;
  QColor _offcolor;
  QColor _oncolor;
  int    _tol;
  int    _borderradius;

  // This order for definition is important (these widgets overlap)
  QLabel*           _labeloff;
  SwitchBackground* _background;
  QLabel*           _labelon;
  SwitchCircle*     _circle;

  bool _enabled;

  QPropertyAnimation* __btn_move;
  QPropertyAnimation* __back_move;
};

class SwitchButton::SwitchBackground : public QWidget
{
  Q_OBJECT
    Q_DISABLE_COPY(SwitchBackground)

public:
  explicit SwitchBackground(QWidget* parent = nullptr, QColor color = QColor(154, 205, 50), bool rect = false);
  ~SwitchBackground() override;

  //-- QWidget methods
  void paintEvent(QPaintEvent* event) override;
  void setEnabled(bool);

private:
  bool            _rect;
  int             _borderradius;
  QColor          _color;
  QColor          _pencolor;
  QLinearGradient _lg;
  QLinearGradient _lg_disabled;

  bool _enabled;
};

class SwitchButton::SwitchCircle : public QWidget
{
  Q_OBJECT
    Q_DISABLE_COPY(SwitchCircle)

public:
  explicit SwitchCircle(QWidget* parent = nullptr, QColor color = QColor(255, 255, 255), bool rect = false);
  ~SwitchCircle() override;

  //-- QWidget methods
  void paintEvent(QPaintEvent* event) override;
  void setEnabled(bool);

private:
  bool            _rect;
  int             _borderradius;
  QColor          _color;
  QColor          _pencolor;
  QRadialGradient _rg;
  QLinearGradient _lg;
  QLinearGradient _lg_disabled;

  bool _enabled;
}; 
```

*(...).cpp*

```
SwitchButton::SwitchButton(QWidget* parent, Style style)
  : QWidget(parent)
  , _value(false)
  , _duration(100)
  , _enabled(true)
{
  _pencolor = QColor(120, 120, 120);

  _lg = QLinearGradient(35, 30, 35, 0);
  _lg.setColorAt(0, QColor(210, 210, 210));
  _lg.setColorAt(0.25, QColor(255, 255, 255));
  _lg.setColorAt(0.82, QColor(255, 255, 255));
  _lg.setColorAt(1, QColor(210, 210, 210));

  _lg2 = QLinearGradient(50, 30, 35, 0);
  _lg2.setColorAt(0, QColor(230, 230, 230));
  _lg2.setColorAt(0.25, QColor(255, 255, 255));
  _lg2.setColorAt(0.82, QColor(255, 255, 255));
  _lg2.setColorAt(1, QColor(230, 230, 230));

  _lg_disabled = QLinearGradient(50, 30, 35, 0);
  _lg_disabled.setColorAt(0, QColor(200, 200, 200));
  _lg_disabled.setColorAt(0.25, QColor(230, 230, 230));
  _lg_disabled.setColorAt(0.82, QColor(230, 230, 230));
  _lg_disabled.setColorAt(1, QColor(200, 200, 200));

  _offcolor = QColor(255, 255, 255);
  _oncolor = QColor(154, 205, 50);
  _tol = 0;
  _borderradius = 12;
  _labeloff = NEW QLabel(this);
  _background = NEW SwitchBackground(this, _oncolor);
  _labelon = NEW QLabel(this);
  _circle = NEW SwitchCircle(this, _offcolor);
  __btn_move = NEW QPropertyAnimation(this);
  __back_move = NEW QPropertyAnimation(this);

  __btn_move->setTargetObject(_circle);
  __btn_move->setPropertyName("pos");
  __back_move->setTargetObject(_background);
  __back_move->setPropertyName("size");

  setWindowFlags(Qt::FramelessWindowHint);
  setAttribute(Qt::WA_TranslucentBackground);

  _labeloff->setText("Off");
  _labelon->setText("On");
  _labeloff->move(31, 5);
  _labelon->move(15, 5);
  setFixedSize(QSize(60, 24));
  if (style == Style::YESNO)
  {
    _labeloff->setText("No");
    _labelon->setText("Yes");
    _labeloff->move(33, 5);
    _labelon->move(12, 5);
    setFixedSize(QSize(60, 24));
  }
  else if (style == Style::BOOL)
  {
    _labeloff->setText("False");
    _labelon->setText("True");
    _labeloff->move(37, 5);
    _labelon->move(12, 5);
    setFixedSize(QSize(75, 24));
  }
  if (style == Style::EMPTY)
  {
    _labeloff->setText("");
    _labelon->setText("");
    _labeloff->move(31, 5);
    _labelon->move(12, 5);
    setFixedSize(QSize(45, 24));
  }

  _labeloff->setStyleSheet("color: rgb(120, 120, 120); font-weight: bold;");
  _labelon->setStyleSheet("color: rgb(255, 255, 255); font-weight: bold;");

  _background->resize(20, 20);

  _background->move(2, 2);
  _circle->move(2, 2);
}

SwitchButton::~SwitchButton()
{
  delete _circle;
  delete _background;
  delete _labeloff;
  delete _labelon;
  delete __btn_move;
  delete __back_move;
}

void SwitchButton::paintEvent(QPaintEvent*)
{
  QPainter* painter = new QPainter;
  painter->begin(this);
  painter->setRenderHint(QPainter::Antialiasing, true);

  QPen pen(Qt::NoPen);
  painter->setPen(pen);

  painter->setBrush(_pencolor);
  painter->drawRoundedRect(0, 0
    , width(), height()
    , 12, 12);

  painter->setBrush(_lg);
  painter->drawRoundedRect(1, 1
    , width() - 2, height() - 2
    , 10, 10);

  painter->setBrush(QColor(210, 210, 210));
  painter->drawRoundedRect(2, 2
    , width() - 4, height() - 4
    , 10, 10);

  if (_enabled)
  {
    painter->setBrush(_lg2);
    painter->drawRoundedRect(3, 3
      , width() - 6, height() - 6
      , 7, 7);
  }
  else
  {
    painter->setBrush(_lg_disabled);
    painter->drawRoundedRect(3, 3
      , width() - 6, height() - 6
      , 7, 7);
  }
  painter->end();
}

void SwitchButton::mousePressEvent(QMouseEvent*)
{
  if (!_enabled)
    return;

  __btn_move->stop();
  __back_move->stop();

  __btn_move->setDuration(_duration);
  __back_move->setDuration(_duration);

  int hback = 20;
  QSize initial_size(hback, hback);
  QSize final_size(width() - 4, hback);

  int xi = 2;
  int y  = 2;
  int xf = width() - 22;

  if (_value)
  {
    final_size = QSize(hback, hback);
    initial_size = QSize(width() - 4, hback);

    xi = xf;
    xf = 2;
  }

  __btn_move->setStartValue(QPoint(xi, y));
  __btn_move->setEndValue(QPoint(xf, y));

  __back_move->setStartValue(initial_size);
  __back_move->setEndValue(final_size);

  __btn_move->start();
  __back_move->start();

  // Assigning new current value
  _value = !_value;
  emit valueChanged(_value);
}

void SwitchButton::setEnabled(bool flag)
{
  _enabled = flag;
  _circle->setEnabled(flag);
  _background->setEnabled(flag);
  if (flag)
    _labelon->show();
  else
  {
    if (value())
      _labelon->show();
    else
      _labelon->hide();
  }
  QWidget::setEnabled(flag);
}

void SwitchButton::setDuration(int time)
{
  _duration = time;
}

void SwitchButton::setValue(bool flag)
{
  if (flag == value())
    return;
  else
  {
    _value = flag;
    _update();
    setEnabled(_enabled);
  }
}

bool SwitchButton::value() const
{
  return _value;
}

void SwitchButton::_update()
{
  int hback = 20;
  QSize final_size(width() - 4, hback);

  int y = 2;
  int xf = width() - 22;

  if (_value)
  {
    final_size = QSize(hback, hback);
    xf = 2;
  }

  _circle->move(QPoint(xf, y));
  _background->resize(final_size);
}

SwitchButton::SwitchBackground::SwitchBackground(QWidget* parent, QColor color, bool rect)
  : QWidget(parent)
  , _rect(rect)
  , _borderradius(12)
  , _color(color)
  , _pencolor(QColor(170, 170, 170))
{
  setFixedHeight(20);

  _lg = QLinearGradient(0, 25, 70, 0);
  _lg.setColorAt(0, QColor(154, 194, 50));
  _lg.setColorAt(0.25, QColor(154, 210, 50));
  _lg.setColorAt(0.95, QColor(154, 194, 50));

  _lg_disabled = QLinearGradient(0, 25, 70, 0);
  _lg_disabled.setColorAt(0, QColor(190, 190, 190));
  _lg_disabled.setColorAt(0.25, QColor(230, 230, 230));
  _lg_disabled.setColorAt(0.95, QColor(190, 190, 190));

  if (_rect)
    _borderradius = 0;

  _enabled = true;
}
SwitchButton::SwitchBackground::~SwitchBackground()
{
}
void SwitchButton::SwitchBackground::paintEvent(QPaintEvent*)
{
  QPainter* painter = new QPainter;
  painter->begin(this);
  painter->setRenderHint(QPainter::Antialiasing, true);

  QPen pen(Qt::NoPen);
  painter->setPen(pen);
  if (_enabled)
  {
    painter->setBrush(QColor(154, 190, 50));
    painter->drawRoundedRect(0, 0
      , width(), height()
      , 10, 10);

    painter->setBrush(_lg);
    painter->drawRoundedRect(1, 1, width()-2, height()-2, 8, 8);
  }
  else
  {
    painter->setBrush(QColor(150, 150, 150));
    painter->drawRoundedRect(0, 0
      , width(), height()
      , 10, 10);

    painter->setBrush(_lg_disabled);
    painter->drawRoundedRect(1, 1, width() - 2, height() - 2, 8, 8);
  }
  painter->end();
}
void SwitchButton::SwitchBackground::setEnabled(bool flag)
{
  _enabled = flag;
}

SwitchButton::SwitchCircle::SwitchCircle(QWidget* parent, QColor color, bool rect)
  : QWidget(parent)
  , _rect(rect)
  , _borderradius(12)
  , _color(color)
  , _pencolor(QColor(120, 120, 120))
{
  setFixedSize(20, 20);

  _rg = QRadialGradient(static_cast<int>(width() / 2), static_cast<int>(height() / 2), 12);
  _rg.setColorAt(0, QColor(255, 255, 255));
  _rg.setColorAt(0.6, QColor(255, 255, 255));
  _rg.setColorAt(1, QColor(205, 205, 205));

  _lg = QLinearGradient(3, 18, 20, 4);
  _lg.setColorAt(0, QColor(255, 255, 255));
  _lg.setColorAt(0.55, QColor(230, 230, 230));
  _lg.setColorAt(0.72, QColor(255, 255, 255));
  _lg.setColorAt(1, QColor(255, 255, 255));

  _lg_disabled = QLinearGradient(3, 18, 20, 4);
  _lg_disabled.setColorAt(0, QColor(230, 230, 230));
  _lg_disabled.setColorAt(0.55, QColor(210, 210, 210));
  _lg_disabled.setColorAt(0.72, QColor(230, 230, 230));
  _lg_disabled.setColorAt(1, QColor(230, 230, 230));

  _enabled = true;
}
SwitchButton::SwitchCircle::~SwitchCircle()
{
}
void SwitchButton::SwitchCircle::paintEvent(QPaintEvent*)
{
  QPainter* painter = new QPainter;
  painter->begin(this);
  painter->setRenderHint(QPainter::Antialiasing, true);

  QPen pen(Qt::NoPen);
  painter->setPen(pen);
  painter->setBrush(_pencolor);

  painter->drawEllipse(0, 0, 20, 20);
  painter->setBrush(_rg);
  painter->drawEllipse(1, 1, 18, 18);

  painter->setBrush(QColor(210, 210, 210));
  painter->drawEllipse(2, 2, 16, 16);

  if (_enabled)
  {
    painter->setBrush(_lg);
    painter->drawEllipse(3, 3, 14, 14);
  }
  else
  {
    painter->setBrush(_lg_disabled);
    painter->drawEllipse(3, 3, 14, 14);
  }

  painter->end();
}
void SwitchButton::SwitchCircle::setEnabled(bool flag)
{
  _enabled = flag;
} 
```

* * *

**Python 实现（原型；PyQt5）**

*用法：*

```
switchbtn = SwitchButton(self, "On", 15, "Off", 31, 60) 
```

*(...).py*

```
from PyQt5 import QtWidgets, QtCore, QtGui

class SwitchButton(QtWidgets.QWidget):
    def __init__(self, parent=None, w1="Yes", l1=12, w2="No", l2=33, width=60):
        super(SwitchButton, self).__init__(parent)
        self.setWindowFlags(QtCore.Qt.FramelessWindowHint)
        self.setAttribute(QtCore.Qt.WA_TranslucentBackground)
        self.__labeloff = QtWidgets.QLabel(self)
        self.__labeloff.setText(w2)
        self.__labeloff.setStyleSheet("""color: rgb(120, 120, 120); font-weight: bold;""")
        self.__background  = Background(self)
        self.__labelon = QtWidgets.QLabel(self)
        self.__labelon.setText(w1)
        self.__labelon.setStyleSheet("""color: rgb(255, 255, 255); font-weight: bold;""")
        self.__circle      = Circle(self)
        self.__circlemove  = None
        self.__ellipsemove = None
        self.__enabled     = True
        self.__duration    = 100
        self.__value       = False
        self.setFixedSize(width, 24)

        self.__background.resize(20, 20)
        self.__background.move(2, 2)
        self.__circle.move(2, 2)
        self.__labelon.move(l1, 5)
        self.__labeloff.move(l2, 5)

    def setDuration(self, time):
        self.__duration = time

    def mousePressEvent(self, event):
        if not self.__enabled:
            return

        self.__circlemove = QtCore.QPropertyAnimation(self.__circle, b"pos")
        self.__circlemove.setDuration(self.__duration)

        self.__ellipsemove = QtCore.QPropertyAnimation(self.__background, b"size")
        self.__ellipsemove.setDuration(self.__duration)

        xs = 2
        y  = 2
        xf = self.width()-22
        hback = 20
        isize = QtCore.QSize(hback, hback)
        bsize = QtCore.QSize(self.width()-4, hback)
        if self.__value:
            xf = 2
            xs = self.width()-22
            bsize = QtCore.QSize(hback, hback)
            isize = QtCore.QSize(self.width()-4, hback)

        self.__circlemove.setStartValue(QtCore.QPoint(xs, y))
        self.__circlemove.setEndValue(QtCore.QPoint(xf, y))

        self.__ellipsemove.setStartValue(isize)
        self.__ellipsemove.setEndValue(bsize)

        self.__circlemove.start()
        self.__ellipsemove.start()
        self.__value = not self.__value

    def paintEvent(self, event):
        s = self.size()
        qp = QtGui.QPainter()
        qp.begin(self)
        qp.setRenderHint(QtGui.QPainter.Antialiasing, True)
        pen = QtGui.QPen(QtCore.Qt.NoPen)
        qp.setPen(pen)
        qp.setBrush(QtGui.QColor(120, 120, 120))
        qp.drawRoundedRect(0, 0, s.width(), s.height(), 12, 12)
        lg = QtGui.QLinearGradient(35, 30, 35, 0)
        lg.setColorAt(0, QtGui.QColor(210, 210, 210, 255))
        lg.setColorAt(0.25, QtGui.QColor(255, 255, 255, 255))
        lg.setColorAt(0.82, QtGui.QColor(255, 255, 255, 255))
        lg.setColorAt(1, QtGui.QColor(210, 210, 210, 255))
        qp.setBrush(lg)
        qp.drawRoundedRect(1, 1, s.width()-2, s.height()-2, 10, 10)

        qp.setBrush(QtGui.QColor(210, 210, 210))
        qp.drawRoundedRect(2, 2, s.width() - 4, s.height() - 4, 10, 10)

        if self.__enabled:
            lg = QtGui.QLinearGradient(50, 30, 35, 0)
            lg.setColorAt(0, QtGui.QColor(230, 230, 230, 255))
            lg.setColorAt(0.25, QtGui.QColor(255, 255, 255, 255))
            lg.setColorAt(0.82, QtGui.QColor(255, 255, 255, 255))
            lg.setColorAt(1, QtGui.QColor(230, 230, 230, 255))
            qp.setBrush(lg)
            qp.drawRoundedRect(3, 3, s.width() - 6, s.height() - 6, 7, 7)
        else:
            lg = QtGui.QLinearGradient(50, 30, 35, 0)
            lg.setColorAt(0, QtGui.QColor(200, 200, 200, 255))
            lg.setColorAt(0.25, QtGui.QColor(230, 230, 230, 255))
            lg.setColorAt(0.82, QtGui.QColor(230, 230, 230, 255))
            lg.setColorAt(1, QtGui.QColor(200, 200, 200, 255))
            qp.setBrush(lg)
            qp.drawRoundedRect(3, 3, s.width() - 6, s.height() - 6, 7, 7)
        qp.end()

class Circle(QtWidgets.QWidget):
    def __init__(self, parent=None):
        super(Circle, self).__init__(parent)
        self.__enabled = True
        self.setFixedSize(20, 20)

    def paintEvent(self, event):
        s = self.size()
        qp = QtGui.QPainter()
        qp.begin(self)
        qp.setRenderHint(QtGui.QPainter.Antialiasing, True)
        qp.setPen(QtCore.Qt.NoPen)
        qp.setBrush(QtGui.QColor(120, 120, 120))
        qp.drawEllipse(0, 0, 20, 20)
        rg = QtGui.QRadialGradient(int(self.width() / 2), int(self.height() / 2), 12)
        rg.setColorAt(0, QtGui.QColor(255, 255, 255))
        rg.setColorAt(0.6, QtGui.QColor(255, 255, 255))
        rg.setColorAt(1, QtGui.QColor(205, 205, 205))
        qp.setBrush(QtGui.QBrush(rg))
        qp.drawEllipse(1,1, 18, 18)

        qp.setBrush(QtGui.QColor(210, 210, 210))
        qp.drawEllipse(2, 2, 16, 16)

        if self.__enabled:
            lg = QtGui.QLinearGradient(3, 18,20, 4)
            lg.setColorAt(0, QtGui.QColor(255, 255, 255, 255))
            lg.setColorAt(0.55, QtGui.QColor(230, 230, 230, 255))
            lg.setColorAt(0.72, QtGui.QColor(255, 255, 255, 255))
            lg.setColorAt(1, QtGui.QColor(255, 255, 255, 255))
            qp.setBrush(lg)
            qp.drawEllipse(3,3, 14, 14)
        else:
            lg = QtGui.QLinearGradient(3, 18, 20, 4)
            lg.setColorAt(0, QtGui.QColor(230, 230, 230))
            lg.setColorAt(0.55, QtGui.QColor(210, 210, 210))
            lg.setColorAt(0.72, QtGui.QColor(230, 230, 230))
            lg.setColorAt(1, QtGui.QColor(230, 230, 230))
            qp.setBrush(lg)
            qp.drawEllipse(3, 3, 14, 14)
        qp.end()

class Background(QtWidgets.QWidget):
    def __init__(self, parent=None):
        super(Background, self).__init__(parent)
        self.__enabled = True
        self.setFixedHeight(20)

    def paintEvent(self, event):
        s = self.size()
        qp = QtGui.QPainter()
        qp.begin(self)
        qp.setRenderHint(QtGui.QPainter.Antialiasing, True)
        pen = QtGui.QPen(QtCore.Qt.NoPen)
        qp.setPen(pen)
        qp.setBrush(QtGui.QColor(154,205,50))
        if self.__enabled:
            qp.setBrush(QtGui.QColor(154, 190, 50))
            qp.drawRoundedRect(0, 0, s.width(), s.height(), 10, 10)

            lg = QtGui.QLinearGradient(0, 25, 70, 0)
            lg.setColorAt(0, QtGui.QColor(154, 184, 50))
            lg.setColorAt(0.35, QtGui.QColor(154, 210, 50))
            lg.setColorAt(0.85, QtGui.QColor(154, 184, 50))
            qp.setBrush(lg)
            qp.drawRoundedRect(1, 1, s.width() - 2, s.height() - 2, 8, 8)
        else:
            qp.setBrush(QtGui.QColor(150, 150, 150))
            qp.drawRoundedRect(0, 0, s.width(), s.height(), 10, 10)

            lg = QtGui.QLinearGradient(5, 25, 60, 0)
            lg.setColorAt(0, QtGui.QColor(190, 190, 190))
            lg.setColorAt(0.35, QtGui.QColor(230, 230, 230))
            lg.setColorAt(0.85, QtGui.QColor(190, 190, 190))
            qp.setBrush(lg)
            qp.drawRoundedRect(1, 1, s.width() - 2, s.height() - 2, 8, 8)
        qp.end() 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-08-13T15:29:47.743

这是@IMAN4K 的[答案](https://stackoverflow.com/a/38102598/3564517)的 Python 3 / PyQt5 实现。

对原始实现的改进：

*   拇指大小可以大于/小于轨道大小
*   使用当前应用的调色板进行着色
*   单击时发出切换/单击信号
*   其他各种修复

[![在此处输入图像描述](../Images/a65654c984e713eb9f99a8e8c8eaada5.png)](https://i.stack.imgur.com/LHLiq.gif)

```
from PyQt5.QtCore import QPropertyAnimation, QRectF, QSize, Qt, pyqtProperty
from PyQt5.QtGui import QPainter
from PyQt5.QtWidgets import (
    QAbstractButton,
    QApplication,
    QHBoxLayout,
    QSizePolicy,
    QWidget,
)

class Switch(QAbstractButton):
    def __init__(self, parent=None, track_radius=10, thumb_radius=8):
        super().__init__(parent=parent)
        self.setCheckable(True)
        self.setSizePolicy(QSizePolicy.Fixed, QSizePolicy.Fixed)

        self._track_radius = track_radius
        self._thumb_radius = thumb_radius

        self._margin = max(0, self._thumb_radius - self._track_radius)
        self._base_offset = max(self._thumb_radius, self._track_radius)
        self._end_offset = {
            True: lambda: self.width() - self._base_offset,
            False: lambda: self._base_offset,
        }
        self._offset = self._base_offset

        palette = self.palette()
        if self._thumb_radius > self._track_radius:
            self._track_color = {
                True: palette.highlight(),
                False: palette.dark(),
            }
            self._thumb_color = {
                True: palette.highlight(),
                False: palette.light(),
            }
            self._text_color = {
                True: palette.highlightedText().color(),
                False: palette.dark().color(),
            }
            self._thumb_text = {
                True: '',
                False: '',
            }
            self._track_opacity = 0.5
        else:
            self._thumb_color = {
                True: palette.highlightedText(),
                False: palette.light(),
            }
            self._track_color = {
                True: palette.highlight(),
                False: palette.dark(),
            }
            self._text_color = {
                True: palette.highlight().color(),
                False: palette.dark().color(),
            }
            self._thumb_text = {
                True: '✔',
                False: '✕',
            }
            self._track_opacity = 1

    @pyqtProperty(int)
    def offset(self):
        return self._offset

    @offset.setter
    def offset(self, value):
        self._offset = value
        self.update()

    def sizeHint(self):  # pylint: disable=invalid-name
        return QSize(
            4 * self._track_radius + 2 * self._margin,
            2 * self._track_radius + 2 * self._margin,
        )

    def setChecked(self, checked):
        super().setChecked(checked)
        self.offset = self._end_offset[checked]()

    def resizeEvent(self, event):
        super().resizeEvent(event)
        self.offset = self._end_offset[self.isChecked()]()

    def paintEvent(self, event):  # pylint: disable=invalid-name, unused-argument
        p = QPainter(self)
        p.setRenderHint(QPainter.Antialiasing, True)
        p.setPen(Qt.NoPen)
        track_opacity = self._track_opacity
        thumb_opacity = 1.0
        text_opacity = 1.0
        if self.isEnabled():
            track_brush = self._track_color[self.isChecked()]
            thumb_brush = self._thumb_color[self.isChecked()]
            text_color = self._text_color[self.isChecked()]
        else:
            track_opacity *= 0.8
            track_brush = self.palette().shadow()
            thumb_brush = self.palette().mid()
            text_color = self.palette().shadow().color()

        p.setBrush(track_brush)
        p.setOpacity(track_opacity)
        p.drawRoundedRect(
            self._margin,
            self._margin,
            self.width() - 2 * self._margin,
            self.height() - 2 * self._margin,
            self._track_radius,
            self._track_radius,
        )
        p.setBrush(thumb_brush)
        p.setOpacity(thumb_opacity)
        p.drawEllipse(
            self.offset - self._thumb_radius,
            self._base_offset - self._thumb_radius,
            2 * self._thumb_radius,
            2 * self._thumb_radius,
        )
        p.setPen(text_color)
        p.setOpacity(text_opacity)
        font = p.font()
        font.setPixelSize(1.5 * self._thumb_radius)
        p.setFont(font)
        p.drawText(
            QRectF(
                self.offset - self._thumb_radius,
                self._base_offset - self._thumb_radius,
                2 * self._thumb_radius,
                2 * self._thumb_radius,
            ),
            Qt.AlignCenter,
            self._thumb_text[self.isChecked()],
        )

    def mouseReleaseEvent(self, event):  # pylint: disable=invalid-name
        super().mouseReleaseEvent(event)
        if event.button() == Qt.LeftButton:
            anim = QPropertyAnimation(self, b'offset', self)
            anim.setDuration(120)
            anim.setStartValue(self.offset)
            anim.setEndValue(self._end_offset[self.isChecked()]())
            anim.start()

    def enterEvent(self, event):  # pylint: disable=invalid-name
        self.setCursor(Qt.PointingHandCursor)
        super().enterEvent(event)

def main():
    app = QApplication([])

    # Thumb size < track size (Gitlab style)
    s1 = Switch()
    s1.toggled.connect(lambda c: print('toggled', c))
    s1.clicked.connect(lambda c: print('clicked', c))
    s1.pressed.connect(lambda: print('pressed'))
    s1.released.connect(lambda: print('released'))
    s2 = Switch()
    s2.setEnabled(False)

    # Thumb size > track size (Android style)
    s3 = Switch(thumb_radius=11, track_radius=8)
    s4 = Switch(thumb_radius=11, track_radius=8)
    s4.setEnabled(False)

    l = QHBoxLayout()
    l.addWidget(s1)
    l.addWidget(s2)
    l.addWidget(s3)
    l.addWidget(s4)
    w = QWidget()
    w.setLayout(l)
    w.show()

    app.exec()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-02-11T00:19:05.230

@piccy 的建议是我之前为这样的拨动开关所做的。通过一些调整。

我们必须模拟类似于 iOS 开/关开关的行为。这意味着您需要一个渐变的运动，而滑块的限制为 0-1，没有外部动画。

因此，我所做的是将滑块的值范围设置为与滑块的最大宽度相同。

然后连接滑块释放信号并检查该值是否小于最大值的一半，如果是，则将滑块值设置为 0，否则将滑块值设置为最大值。

当您释放鼠标时，这将为您提供良好的拖动效果并剪辑到极端。

如果您希望滑块在单击另一侧时仅切换而没有任何拖动，请连接滑块值更改信号并检查新值是否更接近任一极端，*如果滑块未处于向下状态*，则将其设置为滑块值. 如果滑块向下，请不要更改滑块值，因为您可能会中断先前的拖动动作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-08T20:39:40.477

您也可以使用范围为 0 到 1 的水平方向的 QSlider 控件来执行此操作。您可能希望将其最大宽度设置为 50 左右，以防止它在对话框的宽度上拉伸. 然后，您可以使用样式表对其进行调整以改善外观，或者将其子类化并自己绘制控件。可能不需要太多代码就可以让它看起来不错。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-08T20:10:47.380

好吧，你必须使用[QCheckBox](http://qt-project.org/doc/qt-4.8/qcheckbox.html)。它不是拨动开关，但它做同样的事情。如果您真的想要不同的视觉效果，则必须创建自定义小部件

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-08T20:17:01.183

戴维塔在他关于复选框[的回答中是正确的。](https://stackoverflow.com/a/14780549/488657)但是，如果您正在寻找类似于第三个示例的东西（开/关开关），您可以简单地使用两个[QPushButton](http://doc.qt.digia.com/qt/qpushbutton.html)并将它们设置为[checkable](http://doc.qt.digia.com/qt/qabstractbutton.html#checkable-prop)。同时让它们[自动排](http://doc.qt.digia.com/4.7-snapshot/qabstractbutton.html#autoExclusive-prop)他，你应该很高兴。

[通过使用样式表](http://doc.qt.digia.com/stable/stylesheet.html)的一些视觉样式，您应该能够接近，如果不是正确的话。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-06-07T15:09:19.857

这是@Stefan Scherfke 答案的C++ 实现，它是@IMAN4K 答案的Python 3 / PyQt5 实现。除了 Stefan Scherfke 添加的改进之外，我还添加了一些改进。

根据赋予构造函数的参数，切换按钮有 2 种不同的设计。

```
explicit ToggleButton(int trackRadius, int thumbRadius, QWidget* parent = nullptr); 
```

在第一个设计（***trackRadius>thumbRadius***）中，球（拇指）半径小于滑块（轨道）半径，因此球根据开/关状态在滑块内移动，包括勾选“✔”和取消勾选“✕”分数。

在第二种设计（***trackRadius<thumbRadius***）中，球（拇指）半径大于滑动（轨道）半径，一个扁平的胖球在轨道上滑动并根据开/关情况改变颜色。

[![在此处输入图像描述](../Images/759fdeb06b7284e80515255f321899f6.png)](https://i.stack.imgur.com/7pXT4.gif)

我在 QChar 类型中使用 U+2714 Heavy Check 和 U+2715 unCheck 标记作为 UTF-16，以免在源代码中产生编码问题。

由于drawText函数提供的抗锯齿问题，我用DrawPath函数绘制了Heavy Check“✔”和Uncheck“✕”标记。

**绘图路径**：

[![在此处输入图像描述](../Images/cdf4d9ac981ca4f329b6849d59719e53.png)](https://i.stack.imgur.com/UCDUB.png)

**绘图文本**：

[![在此处输入图像描述](../Images/19b04e6f7b145f34b998dbae3ead7890.png)](https://i.stack.imgur.com/ypbzv.png)

但是由于drawPath函数无法对齐，所以我根据这张图片手动计算了Pixel offsets来提供对齐。

[![在此处输入图像描述](../Images/e3e6a7ac82ec0ee2788448e68cddca45.png)](https://i.stack.imgur.com/aSJpK.png)

* * *

**切换按钮.h**

```
#ifndef TOGGLEBUTTON_H
#define TOGGLEBUTTON_H

#include <QtWidgets/QAbstractButton>

class QPropertyAnimation;

class ToggleButton :public QAbstractButton
{
    Q_OBJECT
        Q_PROPERTY(int mOffset READ offset WRITE setOffset);
public:
    explicit ToggleButton(int trackRadius, int thumbRadius, QWidget* parent = nullptr);
    ~ToggleButton();

    QSize sizeHint() const override;

protected:
    void paintEvent(QPaintEvent *) override;
    void resizeEvent(QResizeEvent*) override;
    void mouseReleaseEvent(QMouseEvent  *) override;
    void enterEvent(QEvent *event) override;
    void setChecked(bool checked);

    int offset();
    void setOffset(int value);

private:
    qreal mOffset;
    qreal mBaseOffset;
    qreal mMargin;
    qreal mTrackRadius;
    qreal mThumbRadius;
    qreal mOpacity;
    QPropertyAnimation* mAnimation;

    QHash<bool, qreal> mEndOffset;
    QHash<bool, QBrush> mTrackColor;
    QHash<bool, QBrush> mThumbColor;
    QHash<bool, QColor> mTextColor;
    QHash<bool, QString> mThumbText;

};

#endif // TOGGLEBUTTON_H 
```

* * *

**切换按钮.cpp**

```
#include "toggleButton.h"
#include <QtCore/QEvent>
#include <QtCore/QCoreApplication>
#include <QtCore/QPropertyAnimation> 
#include <QtGui/QPainter> 
#include <QtGui/QMouseEvent> 

///<summary>
/// Toggle button has 2 different design. In the first design, if the ball (thumb) radius is 
/// larger than the slide (track) radius, a flat ball slides and colors from the slide according to 
/// the on / off situation. In the second design, if the ball radius is smaller than the slide radius, 
/// the ball moves according to the on / off status inside the slide and includes the check and uncheck marks.
///</summary>
ToggleButton::ToggleButton(int trackRadius, int thumbRadius, QWidget* parent)
    : QAbstractButton(parent)
{
    setCheckable(true);
    setSizePolicy(QSizePolicy(QSizePolicy::Policy::Fixed, QSizePolicy::Policy::Fixed));
    mTrackRadius = trackRadius;
    mThumbRadius = thumbRadius;
    mAnimation = new QPropertyAnimation(this);
    mAnimation->setTargetObject(this);

    mMargin = 0 > (mThumbRadius - mTrackRadius) ? 0 : (mThumbRadius - mTrackRadius);
    mBaseOffset = mThumbRadius > mTrackRadius ? mThumbRadius : mTrackRadius;
    mEndOffset.insert(true, 4 * mTrackRadius + 2 * mMargin - mBaseOffset); // width - offset
    mEndOffset.insert(false, mBaseOffset);
    mOffset = mBaseOffset;
    QPalette palette = this->palette();

    if (mThumbRadius > mTrackRadius)
    {
        mTrackColor.insert(true, palette.highlight());
        mTrackColor.insert(false, palette.dark());
        mThumbColor.insert(true, palette.highlight());
        mThumbColor.insert(false, palette.light());
        mTextColor.insert(true, palette.highlightedText().color());
        mTextColor.insert(false, palette.dark().color());
        mThumbText.insert(true, "");
        mThumbText.insert(false, "");
        mOpacity = 0.5;
    }
    else
    {
        mTrackColor.insert(true, palette.highlight());
        mTrackColor.insert(false, palette.dark());
        mThumbColor.insert(true, palette.highlightedText());
        mThumbColor.insert(false, palette.light());
        mTextColor.insert(true, palette.highlight().color());
        mTextColor.insert(false, palette.dark().color());
        mThumbText.insert(true, QChar(0x2714)); // check character
        mThumbText.insert(false, QChar(0x2715)); // uncheck character
        mOpacity = 1.0;
    }
}

ToggleButton::~ToggleButton()
{
    delete mAnimation;
}

QSize ToggleButton::sizeHint() const
{
    int w = 4 * mTrackRadius + 2 * mMargin;
    int h = 2 * mTrackRadius + 2 * mMargin;

    return QSize(w, h);
}

void ToggleButton::paintEvent(QPaintEvent *)
{
    QPainter p(this);
    QPainter::RenderHints m_paintFlags = QPainter::RenderHints(QPainter::Antialiasing |
        QPainter::TextAntialiasing);
    p.setRenderHints(m_paintFlags, true);
    p.setPen(Qt::NoPen);
    bool check = isChecked();
    qreal trackOpacity = mOpacity;
    qreal textOpacity = 1.0;
    qreal thumbOpacity = 1.0;
    QBrush trackBrush;
    QBrush thumbBrush;
    QColor textColor;

    if (this->isEnabled())
    {

        trackBrush = mTrackColor[check];
        thumbBrush = mThumbColor[check];
        textColor = mTextColor[check];
    }
    else
    {
        trackOpacity *= 0.8;
        trackBrush = this->palette().shadow();
        thumbBrush = this->palette().mid();
        textColor = this->palette().shadow().color();
    }

    p.setBrush(trackBrush);
    p.setOpacity(trackOpacity);
    p.drawRoundedRect(mMargin, mMargin, width() - 2 * mMargin, height() - 2 * mMargin, mTrackRadius, mTrackRadius);

    p.setBrush(thumbBrush);
    p.setOpacity(thumbOpacity);
    p.drawEllipse(mOffset - mThumbRadius, mBaseOffset - mThumbRadius, 2 * mThumbRadius, 2 * mThumbRadius);

    p.setPen(textColor);
    p.setOpacity(textOpacity);
    QFont font = p.font();
    font.setPixelSize(1.5*mThumbRadius);
    p.setFont(font);

    // Since the antialiasasing provided by the drawText function is incompetent,
    // DrawPath function preferred. But since the drawPath function is not capable of aligment,
    // Pixel offsets calculated to provide aligment.
    QPainterPath textPath;
    qreal pixelOffset = (qreal)mThumbRadius * (1 - 1 / 1.414);
    textPath.addText(mOffset - mThumbRadius + pixelOffset, mBaseOffset + mThumbRadius - pixelOffset, font, mThumbText.value(check));
    p.drawPath(textPath);

    /*p.drawText(QRectF(mOffset - mThumbRadius,
        mBaseOffset - mThumbRadius,
        2 * mThumbRadius,
        2 * mThumbRadius),
        Qt::AlignCenter,
        mThumbText.value(check));*/
}

void ToggleButton::resizeEvent(QResizeEvent* e)
{
    QAbstractButton::resizeEvent(e);
    mOffset = mEndOffset.value(isChecked());
}

void ToggleButton::mouseReleaseEvent(QMouseEvent  *e)
{
    QAbstractButton::mouseReleaseEvent(e);
    if (e->button() == Qt::LeftButton)
    {
        mAnimation->setDuration(120);
        mAnimation->setPropertyName("mOffset");
        mAnimation->setStartValue(mOffset);
        mAnimation->setEndValue(mEndOffset[isChecked()]);
        mAnimation->start();
    }
}

void ToggleButton::enterEvent(QEvent * event)
{
    setCursor(Qt::PointingHandCursor);
    QAbstractButton::enterEvent(event);
}

void ToggleButton::setChecked(bool checked)
{
    QAbstractButton::setChecked(checked);
    mOffset = mEndOffset.value(checked);
}

int ToggleButton::offset()
{
    return mOffset;
}

void ToggleButton::setOffset(int value)
{
    mOffset = value;
    update();
} 
```

* * *

**主文件**

```
#include "toggleButton.h"
#include <QtWidgets/QApplication>
#include <QtWidgets/QHBoxLayout>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    QWidget *widget = new QWidget;
    widget->setWindowFlags(Qt::FramelessWindowHint);
    QHBoxLayout layout;
    widget->setLayout(&layout);
    ToggleButton *toggleButton1 = new ToggleButton(10, 8);
    ToggleButton *toggleButton2 = new ToggleButton(10, 12);
    layout.addWidget(toggleButton1);
    layout.addWidget(toggleButton2);
    widget->show();
    return a.exec();
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-08T20:16:26.223

另请参阅带有[可检查的](http://qt-project.org/doc/qt-4.8/qabstractbutton.html#checkable-prop)[QRadioButton](http://doc.qt.digia.com/4.7-snapshot/qradiobutton.html)和[QPushButton](http://qt-project.org/doc/qt-4.8/qpushbutton.html) ，并且可以制作一些样式表或自定义绘图，例如“开/关开关切换”

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-09-22T13:08:35.907

我知道这个线程很旧，但是尽管 Viv 给出了很好的提示，但我在这个特定问题上遇到了很多困难。

无论如何，我想我会在这里分享我想出的解决方案，也许它会一路帮助其他人。

```
void Switch::on_sldSwitch_actionTriggered(int action) {
    if(action != 7) ui->sldSwitch->setValue((action%2) ? 100 : 0);
}

void Switch::on_sldSwitch_sliderReleased() {
    ui->sldSwitch->setValue((ui->sldSwitch->sliderPosition() >= 50) ? 100 : 0);
} 
```

一点解释：`actionTriggered`每次点击或用键盘移动滑块时都会调用。当它被拖动时，它会发出信号'7'。为避免立即捕捉，操作 7 被阻止。

向右移动时，它在单击时发出 3，在键盘上按“右”（或“下”）时发出 1，这就是为什么当它不是偶数时我们会向右对齐。

向左移动时，它会发出 2 或 4。

`sliderReleased()`一旦您在拖动后放开鼠标按钮，就会调用它，但是此时，滑块仍然具有其旧值（这让我很受挫）。所以，为了获得正确的位置来捕捉我查询`sliderPosition`而不是，`value`就是这样。

我希望这可以帮助别人。

# jquery - 检查是否在选择“行”中选择了所需的文件

> ID：14780519
> 
> 赞同：5
> 
> 时间：2013-02-08T20:08:21.400
> 
> 标签：jquery, html-select

我在一个表单中有多个选择，我需要使用 jQuery 检查是否至少`required="true"`选择了所有必填字段 ( )。

像这样的东西：

```
<select class="check" name="first">
    <option value="some" required="true">Some required</option>
    <option value="other">Other Value</option>
    <option value="few" required="true">Few required</option>
</select>
<select class="check" name="second">
    <option value="some" required="true">Some required</option>
    <option value="other">Other Value</option>
    <option value="few" required="true">Few required</option>
</select>
<select class="check" name="third">
    <option value="some" required="true">Some required</option>
    <option value="other">Other Value</option>
    <option value="few" required="true">Few required</option>
</select>
<select name="other">
    <option value="some" required="true">Some required</option>
    <option value="other">Other Value</option>
    <option value="few" required="true">Few required</option>
</select> 
```

我需要检查其类包含的所有选择元素，`.check`并确保分配了所有必填字段。

我正在考虑如下进行。

1.  创建一个包含所有必需值的数组：

    ```
    var requiredFields = [];
    $('option:selected', this).attr('required').each(function(){
        requiredFields.push($(this).val());
    }) 
    ```

2.  创建一个包含所有选定值的数组：

    ```
    var valuesSelected = [];
    $('.check').each(function(){
        valuesSelected.push($(this).val());
    }) 
    ```

3.  检查必填字段是否在选定的值数组中，如果没有，请执行以下操作：

    ```
    for(i=0;i<requiredFields;i++){
        if(jQuery.inArray(requiredFields[i], valuesSelected)==-1){
             var error += 'Please select '+requiredFields[i];
        }
    } 
    ```

4.  显示错误消息，或者如果为空则执行某些操作：

    ```
    if(error!=''){
        alert(error); // just for testing
    } else {
         // have fun
    } 
    ```

我已经建立了一个简单的[jsFiddle](http://jsfiddle.net/4vNcU/1/ "jsFiddle")来测试它，但似乎我一定做错了什么，有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:10:17.590

您不会像在 javascript 中那样创建数组或将元素添加到数组中。

代替

```
var requiredFields = array(); 
```

和

```
var requiredFields = []; 
```

和

```
requiredFields[]=$(this).val(); 
```

和

```
requiredFields.push($(this).val()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T21:08:41.947

找到了解决方案，我做错了很多事情：

```
 var requiredFields = [];
    $(form).find('option[required]').each(function(){
        if(jQuery.inArray($(this).html(), requiredFields)==-1){
            requiredFields.push($(this).html());
        }
    })
    var valuesSelected = [];
    $(form).find('option:selected').each(function(){
        valuesSelected.push($(this).html());
    })
    for(i=0;i<requiredFields.length;i++){
        if(jQuery.inArray(requiredFields[i], valuesSelected)==-1){
             var msgErr2 = msgErr2 + 'Please select '+requiredFields[i]+'<br>';
        }
    } 
```

这个工作正常，希望对某人有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T21:13:01.100

这是一种使用地图的方法 [http://jsfiddle.net/4vNcU/4/](http://jsfiddle.net/4vNcU/4/)

```
$(document).on('click', '.check-select', function () {
var error = $(".check").find("option:selected").map(collectErrors);
for (var i = 0; i < error.length; i++) {
    alert(error[i]);
}
});

function collectErrors() {
    if ($(this).attr("required") == undefined) {
       var $parent = $(this).parent();
       return "Please select one of the folowing:" + 
       findRequired($parent) + 
       " For the select box " + $parent.attr("name");
    }
}

function findRequired($parent) {
    return $parent.find("option[required=true]").map(function () {
        return $(this).text();
    }).toArray().join()
} 
```

# python - 如何打印字符串“\n”

> ID：14780533
> 
> 赞同：0
> 
> 时间：2013-02-08T20:09:40.227
> 
> 标签：python

我想打印实际的以下字符串：`\n`，但是我尝试的所有内容都只是将其读取为换行符。我如何打印以下内容：`\n`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T20:10:58.140

采用

```
print "\\n" 
```

或原始字符串

```
print r"\n" 
```

查看有关[字符串](http://docs.python.org/2/tutorial/introduction.html#strings)的教程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T20:10:57.687

`\`与另一个逃脱`\`。

```
print "\\n" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-08T20:13:06.020

你必须以`\n`某种方式逃脱

要么只是序列

`print "\\n"`

或将整个字符串标记为原始

`print r"\n"`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T20:11:40.997

您需要转义反斜杠：

```
>>> print("\\n")
\n 
```

# mysql - MySQL在一个查询中获取多个列关联值

> ID：14780540
> 
> 赞同：1
> 
> 时间：2013-02-08T20:10:12.770
> 
> 标签：mysql, select, field

我有 2 张桌子：

```
STEP
id 
value

SCALE
id 
s1
s2
s3
s4
s5
s6 
```

现在 step.id 是 scale.s1、scale.s2、scale.s3 等的外键我想从 step 中获取 scale.s1-s6 值。我用嵌套选择编写了这个查询。是否可以通过一次选择获得此值？

```
SELECT (
    SELECT step.val FROM step, scale WHERE step.id = scale.s1 AND scale.id = 1) as v1,(
    SELECT step.val FROM step,scale WHERE step.id = scale.s2 AND scale.id = 1) as v2, (
    SELECT step.val FROM step,scale WHERE step.id = scale.s3 AND scale.id = 1) as v3, (
    SELECT step.val FROM step,scale WHERE step.id = scale.s4 AND scale.id = 1) as v4, (
    SELECT step.val FROM step,scale WHERE step.id = scale.s5 AND scale.id = 1) as v5, (
    SELECT step.val FROM step,scale WHERE step.id = scale.s4 AND scale.id = 1) as v6, (
    SELECT step.val FROM step,scale WHERE step.id = scale.s5 AND scale.id = 1) as v7 ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:41:10.180

您可以使用带有`MAX`and的单个查询来做到这一点`CASE`：

```
SELECT
  MAX(CASE WHEN scale.s1 = step.id THEN step.val END) v1,
  MAX(CASE WHEN scale.s2 = step.id THEN step.val END) v2,
  MAX(CASE WHEN scale.s3 = step.id THEN step.val END) v3,
  MAX(CASE WHEN scale.s4 = step.id THEN step.val END) v4,
  MAX(CASE WHEN scale.s5 = step.id THEN step.val END) v5,
  MAX(CASE WHEN scale.s6 = step.id THEN step.val END) v6
FROM step, scale
WHERE scale.id = 1 
```

这是[小提琴](http://sqlfiddle.com/#!2/fa451/1)。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:39:29.303

只需多次加入步骤。这是前三个：

```
select s.id, s1.val as v1, s2.val as v2, s3.val as v3
from scale s
join step s1 on s.s1 = s1.id
join step s2 on s.s2 = s2.id
join step s3 on s.s3 = s3.id 
```

# android - Eclipse 中的 Android Maven - 创建 Activity

> ID：14780542
> 
> 赞同：4
> 
> 时间：2013-02-08T20:10:17.993
> 
> 标签：android, eclipse, adt, m2eclipse, m2e

每次我使用 Android-Maven 插件在 Eclipse 中创建 Activity 时，Activity 都会自动在 src 而不是 src/main/java 下创建。

例如，我在 Eclipse 包资源管理器中有 src/main/java 源文件。在源文件夹下，我有 com.example.package.name 包。我右键单击包并选择“新建”->“其他”并选择“Android Activity”。输入有关新活动的所有信息后，我单击“完成”。问题是，当 Eclipse 创建 Activity 并更新 Manifest 时，它会将新 Activity 放在“src/com/example/package/name”下，并在 Manifest 中指明该路径。它应该将 Activity 放在“src/main/java/com/example/package/name”下。

这种行为对于基于 ant 的 Android 构建是正确的和预期的，但不是 Maven，因为 Maven 在编译和启动您的 Android 应用程序之前需要一个 src/main/java 和 src/main/test 文件夹！Maven 仍然会编译和构建，这很尴尬并且不遵循主要的 Maven “约定优于配置”原则：( [http://www.sonatype.org/maven/why](http://www.sonatype.org/maven/why) )

还有其他人有这些问题吗？手动重新定位这些活动并手动更新清单是处理此问题的唯一方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:09:59.847

你应该看看[m2e-android](http://rgladwell.github.com/m2e-android/) - An Android Configurator for M2E Maven Integration for Eclipse。

如您所见，它允许您使用标准的 Maven 目录布局：

![在此处输入图像描述](../Images/becc7b9e06cfcb82d23e9032100fbf2f.png)

# eclipse - 在 Eclipse CDT (Juno) 中使用 GDB DSF 在调试下发送信号到进程

> ID：14780543
> 
> 赞同：5
> 
> 时间：2013-02-08T20:10:21.257
> 
> 标签：eclipse, gdb, eclipse-cdt

有人可以解释如何使用 GDB (DSF) 向 Eclipse CDT 下正在调试的进程发送信号吗？显然，不再使用 Eclipse (Junon) 中的 Signals 视图，而且我在使用 Eclipse + CDT 进行调试方面相当缺乏经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T21:51:01.670

您可以尝试的一件事是，从终端窗口中找到进程的 id，使用`ps -ef`. 然后使用`kill`命令从终端窗口发送信号，例如。`kill -2 <id>`将向进程发送 SIGINT。

# sql-server - 当一行为空时，绝对不返回任何内容

> ID：14780556
> 
> 赞同：0
> 
> 时间：2013-02-08T20:11:03.270
> 
> 标签：sql-server, dotnetnuke

我在 SQL Server 2008 之上使用 DotNetNuke。当以下代码返回 NULL 值时，我试图完全不返回任何内容。我不想要一个空行，我不想要“null”，我什么都不想要。这甚至可能吗？我尝试使用 COALESCE，但我要么遗漏了一些东西，要么它不是为此目的而设计的。

```
DECLARE @Category table (Category varchar(15), Deleted bit)

INSERT INTO @Category (Category, Deleted)
SELECT 'Benefits', 0
UNION ALL
SELECT 'UR', 0
UNION ALL
SELECT 'Events', 1

DECLARE @Staff Table (DNNUserID int, InternalStaff bit, 
Deleted bit, InactiveStaff bit)

INSERT INTO @Staff (DNNUserID, InternalStaff, Deleted, InactiveStaff)
SELECT '556', 1, 0, 0
UNION ALL
SELECT '423', 0, 0, 0
UNION ALL
SELECT '111', 1, 0, 1
UNION ALL
SELECT '222', 1, 1, 0

SELECT Category FROM @Category WHERE Deleted = 0
UNION ALL
SELECT CASE WHEN '111' IN 
    (SELECT DnnUserID FROM @Staff WHERE Deleted = 0 AND 
    InactiveStaff = 0 AND InternalStaff = 1) 
    THEN 'Internal Use Only' 
ELSE NULL END 
```

变量表只是为了便于使用，这里有两个名称大致相同的真实表，我实际上必须使用它们。

我不能使用存储过程来执行这些操作，它必须是简单的选择语句或标量 UDF，以便我们使用的 Telerik 控件能够理解它。

我无法直接访问 DNN 的实际背景（因此我无法编辑任何 DNN 或 Telerik 的代码），只能访问服务器，并且只能通过主 DNN Web 界面将 select 语句添加到 Telerik 控件。

这个想法是，如果个人是我工作的公司的内部成员，我们会看到类别表中的主列表，以及下拉列表中的条目“仅限内部使用”。如果其他人使用它，例如，我们客户的一位员工，他们只会看到类别中的列表。

这可行吗？我目前正在尝试不使用某个功能，因为我无法在实时系统中对其进行测试（我今天在家工作，VPN 已关闭），但如果有必要，我可以并且会在我家进行测试使用上述 SQL 的数据库。

编辑

我可以在一个函数中大致使用它：

```
DECLARE @DNNUserID int = 111

DECLARE @Category table (Category varchar(15), Deleted bit)

INSERT INTO @Category (Category, Deleted)
SELECT 'Benefits', 0
UNION ALL
SELECT 'UR', 0
UNION ALL
SELECT 'Events', 1

DECLARE @Staff Table (DNNUserID int, InternalStaff bit, Deleted bit, 
InactiveStaff bit)

INSERT INTO @Staff (DNNUserID, InternalStaff, Deleted, InactiveStaff)
SELECT '556', 1, 0, 0
UNION ALL
SELECT '423', 0, 0, 0
UNION ALL
SELECT '111', 1, 0, 1
UNION ALL
SELECT '222', 1, 1, 0

IF @DNNUserID NOT IN (SELECT DnnUserID FROM @Staff WHERE Deleted = 0 
AND InactiveStaff = 0 AND InternalStaff = 1)
    BEGIN
        SELECT Category FROM @Category WHERE Deleted = 0
    END
IF @DNNUserID IN (SELECT DnnUserID FROM @Staff WHERE Deleted = 0 
AND InactiveStaff = 0 AND InternalStaff = 1)
    BEGIN
        SELECT Category FROM @Category WHERE Deleted = 0
        UNION ALL
        SELECT 'Internal Use Only'
    END 
```

但！我宁愿找到一种方法来做到这一点而不必诉诸函数这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:22:27.497

```
DECLARE @Category table (Category varchar(15), Deleted bit)

INSERT INTO @Category (Category, Deleted)
SELECT 'Benefits', 0
UNION ALL
SELECT 'UR', 0
UNION ALL
SELECT 'Events', 1

DECLARE @Staff Table (DNNUserID int, InternalStaff bit, 
Deleted bit, InactiveStaff bit)

INSERT INTO @Staff (DNNUserID, InternalStaff, Deleted, InactiveStaff)
SELECT '556', 1, 0, 0
UNION ALL
SELECT '423', 0, 0, 0
UNION ALL
SELECT '111', 1, 0, 1
UNION ALL
SELECT '222', 1, 1, 0

SELECT Category FROM @Category WHERE Deleted = 0
UNION ALL
Select * from
(
SELECT CASE WHEN '111' IN 
    (SELECT DnnUserID FROM @Staff WHERE Deleted = 0 AND 
    InactiveStaff = 0 AND InternalStaff = 1) 
    THEN 'Internal Use Only' 
ELSE NULL END as ARow
) a 
where ARow is not null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:26:54.180

这可能对你有用。EXISTS 听起来很适合您尝试做的事情。

```
DECLARE @Category table (Category varchar(15), Deleted bit)

INSERT INTO @Category (Category, Deleted)
SELECT 'Benefits', 0
UNION ALL
SELECT 'UR', 0
UNION ALL
SELECT 'Events', 1

DECLARE @Staff Table (DNNUserID int, InternalStaff bit, 
Deleted bit, InactiveStaff bit)

INSERT INTO @Staff (DNNUserID, InternalStaff, Deleted, InactiveStaff)
SELECT '556', 1, 0, 0
UNION ALL
SELECT '423', 0, 0, 0
UNION ALL
SELECT '111', 1, 0, 1
UNION ALL
SELECT '222', 1, 1, 0

SELECT Category FROM @Category WHERE Deleted = 0
UNION ALL

SELECT 'Internal Use Only'
WHERE EXISTS
    (
    SELECT 1 
    FROM @Staff
    WHERE Deleted = 0 AND 
      InactiveStaff = 0 AND 
      InternalStaff = 1 AND
      DNNUserID = 111
    ) 
```

# .net - 在 .NET 中“手动”使用 TLS 的 SMTP

> ID：14780557
> 
> 赞同：2
> 
> 时间：2013-02-08T20:11:07.797
> 
> 标签：.net, ssl, smtp

我想通过 SMTP 服务器发送电子邮件，但不想使用内置`SmtpClient`类，因为它不能对电子邮件标头提供太多控制。

我发现[了一个在 .NET 中发送 SMTP 邮件的示例](http://www.eggheadcafe.com/articles/20030316.asp)，基本上可以归结为：

```
string server = "smtp.server.com";
int port = 25;

IPHostEntry host = Dns.GetHostEntry(server);
IPEndPoint endPt = new IPEndPoint(host.AddressList[0], port);

using (Socket s = new Socket(endPt.AddressFamily, SocketType.Stream, ProtocolType.Tcp)) {
    s.Connect(endPt);

    Action<string> Senddata = (string msg) => {
        byte[] _msg = Encoding.ASCII.GetBytes(msg);
        s.Send(_msg, 0, _msg.Length, SocketFlags.None);
    };

    Senddata("HELO " + server);
    // Rest of email data elided
} 
```

但大概这不适用于需要 TLS 的连接，例如 Gmail 的 SMTP 服务器。

有没有一种直接的方法可以通过显式 SSL 连接进行这种交换，例如使用`STARTTLS`SMTP 命令？我对 SSL 协议了解不多，当然也不想陷入尝试编写自己的实现的困境。我希望有一种方法可以使用`SslStream`类或其他东西来发送数据。

# html - 什么是 CSS 合并文件？

> ID：14780559
> 
> 赞同：0
> 
> 时间：2013-02-08T20:11:19.263
> 
> 标签：html, css, missing-data

我正在将网站转换为 CMS。我注意到代码中有一行调用了mergeFile：

```
<link rel="stylesheet" 
   type="text/css" href="foo/bar/style.css@mergeFile=_page.css" /> 
```

我似乎无法从此 mergeFile 访问所有 CSS。什么是 mergeFile 以及如何访问它的内容？

# python - 这个表达式在 Python 中是正确的：{}.keys().insert(0, "") == None。为什么？

> ID：14780563
> 
> 赞同：3
> 
> 时间：2013-02-08T20:11:25.437
> 
> 标签：python

查看我的 Python 会话：

```
>>> {}.keys().insert(0, "") == 无
真的

```

但：

```
>>> k = {}.keys()
>>> k
[]
>>> k.插入（0，“”）
>>> k
['']

```

为什么？？

**附言**。感谢帮助！Python 有非常奇怪的设计 - 不支持链接：

*   [http://en.wikipedia.org/wiki/Method_chaining](http://en.wikipedia.org/wiki/Method_chaining)

那是我问题的根源...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-08T20:13:50.373

`list.insert` *返回* `None`；当您打印时，`k`您正在打印列表的新状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:15:57.863

您正在检查返回类型`None`，以防万一，它的计算结果为`True`. Python`insert`返回`None`

# python - Python：避免数组上的嵌套循环

> ID：14780567
> 
> 赞同：5
> 
> 时间：2013-02-08T20:11:38.593
> 
> 标签：python

我正在使用 etree 遍历一个 xml 文件。

```
import xml.etree.ElementTree as etree
tree = etree.parse('x.xml')
root = tree.getroot()
for child in root[0]:
 for child in child.getchildren():
        for child in child.getchildren():
            for child in child.getchildren():
               print(child.attrib) 
```

python中避免这些嵌套for循环的惯用方式是什么。

```
 getchildren() ⇒ list of Element instances [#]
    Returns all subelements. The elements are returned in document order.

Returns:
A list of subelements. 
```

我在 SO 中看到了一些帖子，例如 [避免嵌套 for 循环](https://stackoverflow.com/questions/11174745/avoiding-nested-for-loops) ，但没有直接转化为我的使用。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:25:23.723

如果您想获取`n`树中级别较深的孩子，然后遍历它们，您可以执行以下操作：

```
def childrenAtLevel(tree, n):
    if n == 1:
        for child in tree.getchildren():
            yield child
    else:
        for child in tree.getchildren():
            for e in childrenAtLevel(child, n-1):
                yield e 
```

然后，要获得四个层次的元素，您只需说：

```
for e in childrenAtLevel(root, 4):
     # do something with e 
```

或者，如果您想获取所有叶节点（即本身没有任何子节点的节点），您可以执行以下操作：

```
def getLeafNodes(tree):
    if len(tree) == 0:
         yield tree
    else:
         for child in tree.getchildren():
            for leaf in getLeafNodes(child):
                yield leaf 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:40:01.947

`itertools.chain.from_iterable`将压平一层嵌套；您可以使用`functools.reduce`它来应用它*n*次（[压缩“n”次对象成员调用](https://stackoverflow.com/questions/14635914/compressing-n-time-object-member-call?lq=1)）：

```
from itertools import chain
from functools import reduce

for child in reduce(lambda x, _: chain.from_iterable(x), range(3), root):
    print(child.attrib) 
```

请注意，`getchildren`已弃用；迭代一个节点直接产生它的子节点。

# python - 我需要从文本文件创建用户列表

> ID：14780581
> 
> 赞同：-2
> 
> 时间：2013-02-08T20:13:13.277
> 
> 标签：python, list, text

我有一个数据文本文件。它看起来像这样，但有几百行。

```
Test: 0
AssignentDone
UserDone
johndoe
Assignment8
Resp: YES
Trade: YES
Journal: YES 
```

我需要建立一个用户名列表。每个人下面的数据都是杂乱无章的，但是每个人数据的末尾是“UserDone”行，然后下一行是新用户的名称。

我有这个

```
def get_names( file ):
    with open("userdata.txt", "rt") as file:
        for line in file:
            if "UserDone" in line:
                students= list(file.readlines()[1])` 
```

当我运行这个时，我得到

```
ValueError: Mixing iteration and read methods would lose data 
```

有什么方法可以让 python 识别“UserDone”行，然后将下一行添加到列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:22:14.413

你不能使用文件迭代和 readline，否则你会弄得一团糟，python 很乐意让你知道。尝试以下方法（我相信它可以以更智能的方式完成）

```
def get_names( file ):
    savenext = False
    with open("userdata.txt", "rt") as file:
        for line in file:
            if savenext == True:
                students= line
                savenext == False

            if "UserDone" in line:
                savenext = True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:19:20.613

也许看看 .split 函数？[http://docs.python.org/2/library/stdtypes.html#str.split](http://docs.python.org/2/library/stdtypes.html#str.split)

或正则表达式模块：[http ://docs.python.org/2/library/re.html](http://docs.python.org/2/library/re.html)

# python - Ipython 笔记本。Windows 7 中的 %pylab 加载错误

> ID：14780582
> 
> 赞同：1
> 
> 时间：2013-02-08T20:13:12.620
> 
> 标签：python, windows-7, ipython, enthought, ipython-notebook

我运行 Windows 7，Enthought Python Distribution 7.3-2 Academic。
我打开一个命令提示符，切换到我的代码目录并输入

`U:\rsch>ipython notebook`

在新笔记本中，我输入`%pylab`并收到以下错误：

```
In [1]: %pylab

---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
U:\rsch\<ipython-input-1-5c1faa999e5b> in <module>()
----> 1 get_ipython().magic(u'pylab')

D:\Python27\lib\site-packages\IPython\core\interactiveshell.pyc in magic(self, arg_s, next_input)
   1983                 self._magic_locals = sys._getframe(1).f_locals
   1984             with self.builtin_trap:
-> 1985                 result = fn(magic_args)
   1986             # Ensure we're not keeping object references around:

   1987             self._magic_locals = {}

D:\Python27\lib\site-packages\IPython\core\magic.pyc in magic_pylab(self, s)
   3471             import_all_status = True
   3472 
-> 3473         self.shell.enable_pylab(s, import_all=import_all_status)
   3474 
   3475     def magic_tb(self, s):

D:\Python27\lib\site-packages\IPython\core\interactiveshell.pyc in enable_pylab(self, gui, import_all)
   2592         ns = {}
   2593         try:
-> 2594             gui = pylab_activate(ns, gui, import_all, self)
   2595         except KeyError:
   2596             error("Backend %r not supported" % gui)

D:\Python27\lib\site-packages\IPython\core\pylabtools.pyc in pylab_activate(user_ns, gui, import_all, shell)
    327     itself, and will be needed next to configure IPython's gui integration.
    328     """
--> 329     gui, backend = find_gui_and_backend(gui)
    330     activate_matplotlib(backend)
    331     import_pylab(user_ns, import_all)

D:\Python27\lib\site-packages\IPython\core\pylabtools.pyc in find_gui_and_backend(gui)
    194     """
    195 
--> 196     import matplotlib
    197 
    198     if gui and gui != 'auto':

D:\Python27\lib\site-packages\matplotlib\__init__.py in <module>()
    131 import sys, os, tempfile
    132 
--> 133 from matplotlib.rcsetup import (defaultParams,
    134                                 validate_backend,
    135                                 validate_toolbar,

D:\Python27\lib\site-packages\matplotlib\rcsetup.py in <module>()
     17 import warnings
     18 from matplotlib.fontconfig_pattern import parse_fontconfig_pattern
---> 19 from matplotlib.colors import is_color_like
     20 
     21 #interactive_bk = ['gtk', 'gtkagg', 'gtkcairo', 'fltkagg', 'qtagg', 'qt4agg',

D:\Python27\lib\site-packages\matplotlib\colors.py in <module>()
     50 """
     51 import re
---> 52 import numpy as np
     53 from numpy import ma
     54 import matplotlib.cbook as cbook

D:\Python27\lib\site-packages\numpy\__init__.pyc in <module>()
    141         return loader(*packages, **options)
    142 
--> 143     import add_newdocs
    144     __all__ = ['add_newdocs']
    145 

D:\Python27\lib\site-packages\numpy\add_newdocs.py in <module>()
      7 #       core/fromnumeric.py, core/defmatrix.py up-to-date.

      8 
----> 9 from numpy.lib import add_newdoc
     10 
     11 ###############################################################################

D:\Python27\lib\site-packages\numpy\lib\__init__.py in <module>()
     11 
     12 import scimath as emath
---> 13 from polynomial import *
     14 #import convertcode

     15 from utils import *

D:\Python27\lib\site-packages\numpy\lib\polynomial.py in <module>()
     15 from numpy.lib.function_base import trim_zeros, sort_complex
     16 from numpy.lib.type_check import iscomplex, real, imag
---> 17 from numpy.linalg import eigvals, lstsq
     18 
     19 class RankWarning(UserWarning):

D:\Python27\lib\site-packages\numpy\linalg\__init__.py in <module>()
     46 from info import __doc__
     47 
---> 48 from linalg import *
     49 
     50 from numpy.testing import Tester

D:\Python27\lib\site-packages\numpy\linalg\linalg.py in <module>()
     21         isfinite, size, finfo, absolute, log, exp
     22 from numpy.lib import triu
---> 23 from numpy.linalg import lapack_lite
     24 from numpy.matrixlib.defmatrix import matrix_power
     25 from numpy.compat import asbytes

ImportError: DLL load failed: The specified path is invalid. 
```

不知道该怎么办。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T08:48:24.913

我遇到了同样的问题，这对我有用：

1.  我确保在**没有**“pylab”的情况下调用 IPython
2.  然后，我确保所有会话/实例（对不起，但我是新手 :) 都已关闭。您可以通过 ctrl-C 在所有终端中执行此操作，如果可能，在笔记本仪表板中按“关闭”。

可能有更优雅的方法可以做到这一点，但这对我有用。

开发人员请注意，当他们尝试运行的第一个笔记本出现错误时，许多新手可能会感到非常沮丧。

亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T21:11:47.277

EPD 随 ipython 0.12 一起提供。从那时起，Ipython 发展了很多。您应该通过输入“enpkg ipython”更新到 ipython 0.13.1，如下所述：https: [//support.enthought.com/entries/22415022-Using-enpkg-to-update-EPD-packages](https://support.enthought.com/entries/22415022-Using-enpkg-to-update-EPD-packages)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:36:04.027

您可能在系统路径中缺少 Scripts 目录。要检查，运行

```
echo %PATH% 
```

从命令提示符中查找`D:\Python27\Scripts`. 如果它丢失，您可以从控制面板手动添加它，或使用诸如[Rapid Environment Editor](http://www.rapidee.com/en/download)之类的实用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T14:32:23.650

不幸的是，这些错误消息并没有真正有用。从消息中您只知道在导入“lapack_lite”（Numpy 的一部分）期间无法导入“某些 dll”。

您可以使用[Dependency Walker](http://www.dependencywalker.com/)查看导致问题的特定 DLL，打开“D:\Python27\Lib\site-packages\numpy\linalg\lapack_lite.pyd”可能会显示更多信息。

# nhibernate - 基本的 Fluent NHibernate 关系问题

> ID：14780584
> 
> 赞同：1
> 
> 时间：2013-02-08T20:13:23.760
> 
> 标签：nhibernate, fluent-nhibernate

我目前正在从事的项目是使用实体框架，但是我们遇到了一些问题，因此我正在研究使用 NHibernate，我们相信这将解决我们遇到的大部分问题。

无论如何，我一直在复制系统的一个简单部分，但我遇到了一个我认为是一对多关系的非常简单的问题，因为它给出了非常奇怪的结果。

这是我的实体：

```
public class Task : Base.Domain
{
    private IList<TaskProperty> _taskProperties = new BindingList<taskProperty>();
    private string _name = String.Empty;
    private string _description = String.Empty;

    public virtual IList<TaskProperty> TaskProperties
    {
        get
        {
            return _taskProperties;
        }
        set
        {
            if (_taskProperties == value) return;
            _taskProperties = value;
            OnNotifiyPropertyChanged("TaskProperties");
        }
    }

    public virtual string Name
    {
        get
        {
            return _name;
        }
        set
        {
            if (_name == value) return;
            _name = value;
            base.OnNotifiyPropertyChanged("Name");
        }
    }

    public virtual string Description
    {
        get
        {
            return _description;
        }
        set
        {
            if (_description == value) return;
            _description = value;
            base.OnNotifiyPropertyChanged("Description");
        }
    }

    public Task() 
        : base()
    { }      
}

public class TaskProperty : Base.Domain
{
    private Task _task = null;
    private string _name = string.Empty;
    private string _description = string.Empty;
    private int _propertyType = 0;            

    //public virtual int TaskID { get; set; }
    public virtual Task Task
    {
        get
        {
            return _task;
        }
        set
        {
            if (_task == value) return;
            _task = value;
            OnNotifiyPropertyChanged("Task");
        }
    }

    public virtual string Name
    {
        get
        {
            return _name;
        }
        set
        {
            if (_name == value) return;
            _name = value;
            OnNotifiyPropertyChanged("Name");
        }
    }

    public virtual string Description
    {
        get
        {
            return _description;
        }
        set
        {
            if (_description == value) return;
            _description = value;
            OnNotifiyPropertyChanged("Description");
        }
    }

    public virtual int PropertyType
    {
        get
        {
            return _propertyType;
        }
        set
        {
            if (_propertyType == value) return;
            _propertyType = value;
            OnNotifiyPropertyChanged("PropertyType");
        }
    }

    public TaskProperty()
        : base()
    { }     
} 
```

这是我的 NHibernate 映射：

```
public class TaskMapping : ClassMap<Task>
{
    public TaskMapping()
    {
        Id(x => x.Id).Column("RETTaskID");
        Map(x => x.Name);
        Map(x => x.Description);
        Map(x => x.Version);
        HasMany(x => x.TaskProperties).KeyColumn("RETTaskPropertyID");
        Table("RETTask");
    }
}

public class TaskPropertyMapping : ClassMap<TaskProperty>
{
    public TaskPropertyMapping()
    {
        Id(x => x.Id).Column("RETTaskPropertyID");
        Map(x => x.Name);
        Map(x => x.Description);
        Map(x => x.PropertyType);
        References(x => x.Task).Column("RETTaskID");
        Table("RETTaskProperty");
    }
} 
```

注意：这些实体继承的 Domain 类包含 ID (int Id)。

我面临的问题是，例如，当我从 ID 为 27 的数据库中获取 I Task 时，我也获得了 ID 为 27 的 TaskProperty，而不是通过外部与 Task 相关的预期的 4 个 TaskProperty钥匙。

这在实体框架中运行良好，我知道这对于任何 ORM 来说都是一个简单的情况，所以我假设我的映射设置不正确，但是从我找到的所有示例来看，我似乎没有做错任何事情！

任何答案/建议都将受到欢迎。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T04:19:44.273

你快到了。HasMany 和 References 的列映射必须相同：

```
public TaskMapping()
{
  ...
  HasMany(x => x.TaskProperties).KeyColumn("RETTaskID"); // use this
  // HasMany(x => x.TaskProperties).KeyColumn("RETTaskPropertyID"); // instead of this
}
public TaskPropertyMapping()
{
  ...
  References(x => x.Task).Column("RETTaskID");
} 
```

集合项目必须具有对所有者的引用列。此列用于两个方向，因为这就是 DB 中的引用管理方式...

# ruby - 在正则表达式匹配周围显示字符

> ID：14780588
> 
> 赞同：0
> 
> 时间：2013-02-08T20:13:40.710
> 
> 标签：ruby, regex

是否可以在正则表达式匹配周围显示字符？我有下面的字符串，我想`"change"`在比赛前显示 3-5 个字符时替换每次出现的 。

```
string = "val=change anotherval=change stringhere:change: foo=bar foofoo=barbar" 
```

到目前为止我所拥有的

```
while line.match(/change/)
  printf "\n\n Substitute the FIRST change below:\n"
  printf "#{line}\n"

  printf "\n\tSubstitute => "
  substitution = gets.chomp

  line = line.sub(/change/, "#{substitution}")
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:25:44.920

如果你想了解和肮脏的 Perl 风格：

```
before_chars = $`[-3, 3] 
```

这是模式匹配之前的最后三个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T13:58:58.363

## 替代方案：使用 $1 匹配变量

tadman 的答案使用特殊的预匹配变量 ( **$`** )。Ruby 还会将捕获组存储在编号变量中，这可能同样神奇，但可能更直观。例如：

```
string = "val=change anotherval=change stringhere:change: foo=bar foofoo=barbar"
string.sub(/(.{3})?change/, "\\1#{substitution}")
$1
# => "al=" 
```

但是，无论您使用哪种方法，请确保在您上次尝试的匹配失败时明确检查匹配变量的空值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T09:31:36.977

您可能会使用`gsub!`以下方式给出的 with 块：

```
line = "val=change anotherval=change stringhere:change: foo=bar foofoo=barbar"

# line.gsub!(/(?<where>.{0,3})change/) {
line.gsub!(/(?<where>\S+)change/) {

  printf "\n\n Substitute the change around #{Regexp.last_match[:where]} => \n"
  substitution = gets.chomp

  "#{Regexp.last_match[:where]}#{substitution}"
}

puts line 
```

产量：

```
 Substitute the change around val= => 
111
 Substitute the change around anotherval= => 
222
 Substitute the change around stringhere: => 
333

val=111 anotherval=222 stringhere:333: foo=bar foofoo=barbar 
```

`gsub!`将替换就地匹配，而更合适的模式`\S+`而不是注释掉`.{0,3}`将使您能够打印出人类可读的提示。

# scala - Scala 语法查询，返回类型推断

> ID：14780590
> 
> 赞同：1
> 
> 时间：2013-02-08T20:13:45.067
> 
> 标签：scala

代码似乎微不足道，但我不理解返回值中的一件事：

```
trait JdbcTemplate {
  def query(psc: PreparedStatementCreator,
            rowMapper: RowMapper): List[_]
} 
```

这里到底是什么`List[_]`意思？不会使用`List[Any]`暗示同样的事情吗？我在哪里可以阅读差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T21:10:38.050

`Any`是一种特定的、已知的（尽管完全包罗万象）类型。使用下划线作为类型参数是对所谓的“存在类型”的更繁琐和更通用的语法的简写。存在类型是非特定的：他们说至少有一种类型可以去这里。它们是通用量化的对偶，即对更常用的无界类型参数的解释。例如，`def method[T](t: T) ...`。在此构造中，`T`可以绑定到任何类型，尽管在实例化该类型的每个位置（每次调用该方法），它都绑定到特定类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:18:32.567

鉴于这`_`意味着您不关心类型并且[`Any`是一切的超类型](http://www.scala-lang.org/node/128)，两者都是相同的。

# github - 计算每个贡献者的字数

> ID：14780593
> 
> 赞同：-1
> 
> 时间：2013-02-08T20:13:54.823
> 
> 标签：github, repository

如何计算每个贡献者在存储库中写的字数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:53:29.597

最好在该 GitHub 的本地克隆上解决，以便分析 git 日志并检查每个贡献者。

请参阅“[获取贡献者统计信息](http://codeimpossible.com/2011/12/16/Stupid-Git-Trick-getting-contributor-stats/)”，基于：

```
git log --author="Jared Barboza" --pretty=tformat: --numstat | \
grep -v public/javascripts/jquery | \
gawk '{ add += $1 ; subs += $2 ; loc += $1 - $2 } END \
{ printf "added lines: %s removed lines : %s total lines: %s\n",add,subs,loc }' - 
```

但这是针对给定贡献者添加/删除的行。

（有点像“ [Git：如何根据添加/更改的代码行来估计一个人对我的项目的贡献？](https://stackoverflow.com/questions/4592866/git-how-to-estimate-a-contribution-of-a-person-to-my-project-in-terms-of-added) ”）

您可以将类似的方法与“[量化 git diff 中的变化量？](https://stackoverflow.com/questions/2874318/quantifying-the-amount-of-change-in-a-git-diff) ”中描述的方法相结合。
或者您可以为此使用专用程序，例如**[git-wordcount](https://github.com/huitseeker/git-wordcount)**。

# mysql - 这段 SQL 代码有什么问题

> ID：14780595
> 
> 赞同：0
> 
> 时间：2013-02-08T20:13:59.253
> 
> 标签：mysql, sql

我想将所有列 URL 行更新为 Test 但我从下面的查询中收到以下错误

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM STx AS a LEFT JOIN Routes AS b ON a.RouteID = b.RouteID WHERE a.GroupID ' at line 3

UPDATE Routes SET URL = 'test' 
WHERE ID in (
    SELECT b.ID
    FROM Stx a left JOIN Routes b on a.RouteID = b.RouteID
    where a.GroupID = 39 and a.Status = 'Provisioned'
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:26:33.547

我可以看到这里没有语法错误。我在 MySQL 5.5 上对其进行了测试，并且语句解析得很好。

`b.ID`我怀疑您在和之间可能有一个非 ASCII 空白字符`FROM`。尝试删除这两个标记之间的所有空格和换行符，然后重新插入一个纯空格。

但这并不能解决下一个问题：MySQL 不支持表的 UPDATE 和在单个查询中从同一个表中选择。所以你不能像你一样使用子查询。这就是为什么其他答案建议使用多表更新的原因。

另一种可能性是您没有共享您正在运行的真实查询。Stack Overflow 上的很多人在查询方面寻求帮助，但他们修改了查询以在他们的问题中发布，使其更简单或隐藏专有信息。

请不要只说“它不起作用”。这无助于我们改进我们的答案。提供错误消息（如果有），并确保*准确*显示您正在输入的语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:18:14.233

为什么不只是：

```
UPDATE Routes a JOIN Stx b ON (a.routeid = b.routeid)
 SET a.URL = 'test'
where b.groupid = 39 and b.status = 'Provisioned' 
```

[我在这里创建了一个示例 SQL Fiddle。](http://sqlfiddle.com/#!2/0549f/1)

如果您尝试做一些不同的事情，请您发布您的真实查询，或者更改 SQL fiddle 中的数据模型以显示您遇到的麻烦，并发布一个链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:27:15.710

```
 UPDATE Routes AS b
    JOIN Stx AS a ON a.RouteID = b.RouteID
    SET b.URL = 'test'
    WHERE a.GroupID = 39 and a.Status = 'Provisioned' 
```

# python - 如果提供了 ID，则查找 Flickr 用户名？

> ID：14780596
> 
> 赞同：1
> 
> 时间：2013-02-08T20:14:00.477
> 
> 标签：python, flickr

如果我有该帐户的用户 ID，是否有 API 调用或其他方式来查找 Flickr 帐户的用户名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T14:28:39.970

flickr.people.getInfo[调用](http://www.flickr.com/services/api/flickr.people.getInfo.html)将满足您的需求。

# ios - 在 ios 上每分钟运行一次应用程序

> ID：14780598
> 
> 赞同：-6
> 
> 时间：2013-02-08T20:14:13.393
> 
> 标签：ios

我想在 iOS 的后台每分钟运行我的应用程序。我可以这样做吗？有什么例子吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:17:42.480

查看[https://developer.apple.com/library/IOs/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html](https://developer.apple.com/library/IOs/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html) 了解您在 IOS 的后台可以做什么和不可以做什么。

您可能希望在后台执行的许多任务可以通过操作系统完成，例如通知，但是当您的应用程序在后台时，它应该将大部分时间花在暂停的情况下，除非：您需要在若干特定用户服务中的至少一项。您需要执行一个有限长度的任务。当您的应用程序未运行时，您需要使用通知来提醒用户一些相关信息。（这些取自我链接的网站）

# python - 是否有推荐的做法或框架来实现 google-app-engine db.Model/ndb.Model) 的记录级别权限？

> ID：14780599
> 
> 赞同：2
> 
> 时间：2013-02-08T20:14:19.530
> 
> 标签：python, google-app-engine, user-permissions, database-permissions

是否有推荐的做法或框架来使用 google-app-engine db.Model (和/或 ndb.Model) 实现记录级别权限和属性级别可见性？

我已阅读有关模型挂钩的信息，但我很想看看是否有现有的推荐最佳实践来执行此操作。

```
class Person(db.Model):

 first_name = db.StringProperty()
 last_name = db.StringProperty()
 city = db.StringProperty()

 # Record level permissions:
 #  "top" visible only to managers
 #  "medium" visible to managers & supervisors
 #  "none" visible to all (unless other permissions restrict)
 secrecy = db.StringProperty(required=True, choices=set(["top", "medium", "none"]))

 birth_year = db.IntegerProperty() # Accessible only with "Manager" permission
 height = db.IntegerProperty() # Writable only with "Supervisor" permission 
```

对此的更多上下文 - 我需要这些权限检查是模型级别的，因为我希望允许用户通过简单的 JavaScript RPC 调用执行任意 GQL 查询和 DML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:53:43.487

对于实体级（=记录级）权限，您应该查看[Namespaces API](https://developers.google.com/appengine/docs/python/multitenancy/overview)。Afaik，没有针对属性级别权限的开箱即用解决方案 - 您必须自己编写代码。

请注意，命名空间通过将命名空间添加到实体键来工作。这意味着您将无法进行跨命名空间查询并获得一个您需要知道它的命名空间的实体（以及种类、父级和 id/name）。

命名空间是实现多租户的一种有效方式，例如让完全不同的客户使用相同的 GAE 应用程序，防止代码错误将一个客户的数据暴露给另一个客户的可能性。

# windows-8 - WinRt下自定义控件的SurfaceImageSource问题

> ID：14780609
> 
> 赞同：1
> 
> 时间：2013-02-08T20:15:04.867
> 
> 标签：windows-8, windows-runtime

我正在使用“Windows 运行时”为 Window 8 创建一个应用程序。

我有一个自定义控件，它可以自己绘画。为此，我使用 Rectangle 控件并将其“Fill”属性设置为从 SurfaceImageSource 派生的 ImageBrush，然后使用 ID2D1RenderTarget 进行绘画。对于绘制位图，我使用 ID2D1RenderTarget::CreateBitmapFromWicBitmap 并保存返回的 ID2D1Bitmap。控件是动画的，我创建了我需要的所有位图，然后不断地绘制场景。

在大多数情况下，这一切都很好。然而，我发现在随机的基础上，突然间，我已经隐藏的所有 ID2D1Bitmaps 都停止了绘制任何东西。我可以追溯代码，似乎没有任何问题，但是当我调用 ID2D1RenderTarget::DrawBitmap 时，什么也没有发生。但是，我发现如果我强制从文件中重新创建 ID2D1Bitmap，它就会再次正常工作。就好像位图已经失效或什么的。

这种位图丢失的情况很少发生，而且似乎是随机的，但我几乎可以保证它会在播放后的一个小时左右内失败。我很确定这不是内存泄漏，因为我可以一次运行应用程序数小时而不会增加使用的内存。另外，如果我强制位图重新加载，我可以继续，就好像什么都没发生一样。

谁能给我一个关于这里可能发生的事情的线索？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:57:56.520

经过多次试验和错误（由于很难重现问题而没有帮助），我发现问题的根源在于对 ID2DRenderTarget::BeginDraw 的调用返回 DXGI_ERROR_DEVICE_REMOVED。在我的代码所基于的示例代码中，它表明为了响应这个错误，我需要重新创建我正在做的上下文。但是，我并没有删除与旧上下文关联的所有缓存位图，并且这些位图不适用于新上下文。我修复了这个问题，现在我的应用程序从这个错误中恢复了。

虽然这解决了问题，但我仍然不确定我为什么在玩游戏时会随机出现“设备已删除”错误。此外，不用说，在播放过程中重新加载所有图形显示为令人讨厌的延迟故障。幸运的是它很少发生，所以我想我将不得不忍受它。

# c# - 在显示编辑表单之前从数据库中刷新数据集中的一行

> ID：14780611
> 
> 赞同：1
> 
> 时间：2013-02-08T20:15:09.980
> 
> 标签：c#, datagridview, dataset, refresh, row

我有一个 DataSet + TableAdapter 和绑定的 dataGridView。我有一个编辑按钮，它打开一个新表单，其中包含要编辑的详细信息（WinForms）。在打开新表单之前，如何从数据库中刷新 Dataset 和 dataGrid 中的一行（选定的一行）？

示例：两个用户 A 和 B。用户 A 更改了记录 ID(10)，而用户 B 在记录 ID(10) 中仍然具有旧值。用户 B 按下编辑按钮，应该从数据库中获取新数据（用户 A 更改后的数据）。

```
 string sql = "SELECT * FROM Orders";
        SqlConnection connection = new SqlConnection(connectionString);
        SqlDataAdapter da = new SqlDataAdapter(sql, connection);
        DataSet ds = new DataSet();
        connection.Open();
        da.Fill(ds, "Orders");
        connection.Close();
        dataGridView1.DataSource = ds;
        .....
           private void button1_Click(object sender, EventArgs e)
           {
           //?
           //refresh selected row in datagrid (from current database record)
           //?
           EditForm()
           } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:36:36.160

在您的 TableAdapter 中创建一个新查询，该查询应该只获取一行，并仅使用您已有的行的主键调用它。

将结果插入一个新的 DataSet 并获取第一行（在检查 Rows.Count() > 0 之后）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:01:03.320

我会在它自己的方法中附上填充gridview位，比如fill_grid（）。然后只需在编辑链接点击事件中调用该方法即可。然后任何改变的都会更新。然后将该方法也添加到所有其他按钮链接事件中。然后，每次用户单击链接时，网格都会“刷新”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-04T20:12:32.360

对于那些在 2019 年寻找答案的人，假设`dataAdapter`是一个定义较早的班级成员

```
 private void ButtonUpdate_Click(object sender, RoutedEventArgs e)
    {
        if (dataGrid.SelectedItem is DataRowView view)
        {
            DataRow currentRow = view.Row;
            DataTable table = currentRow.Table;
            dataAdapter.Fill(table.Rows.IndexOf(currentRow), 1, table);
        }
    } 
```

# regex - 查找非数字的正则表达式是什么（不包括句点）

> ID：14780613
> 
> 赞同：1
> 
> 时间：2013-02-08T20:15:20.187
> 
> 标签：regex

作为代码段中的这一点，我想将输入的文本限制为仅数字和句点。

我一切正常，但我想缩短我的代码，这样如果它找到一个非数字它就会返回。PERIOD (.) 被标记为非数字。有没有办法只说 NON_DIGITS_LESS_PERIOD 之类的东西？

我刚在想

```
/\D[^\.]/ 
```

但这实际上是在寻找一个非数字后跟一个非句点。

在我尝试时如何限制它的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:18:20.147

所以你实际上想要一个 NON_(DIGIT_OR_PERIOD)：

```
/[^\d.]/ 
```

顺便说一句，与`/^[\d.]*$/`.

# emacs - 您对 Emacs 源代码导航的最佳体验是什么？

> ID：14780617
> 
> 赞同：0
> 
> 时间：2013-02-08T20:15:31.123
> 
> 标签：emacs

我有一个大项目，有许多 .c 和 .h 文件可供导航。你有最好的体验是什么工具？我在网上搜索，发现用户推荐`etags`,`global`和`ECB`. 我只是想知道哪一个最适合我的情况，以便我可以坚持下去。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:22:59.760

我认为`etags`还是`ctags`很容易使用的。许多开源项目都带有`make`规则来为这些类型生成数据库。对于 C++，`ebrowse`更好。就个人而言，我喜欢使用与`emacs`. 如果你下载的是第三方应用，每次升级都必须重新编译，而且通常会有更多的集成工作。至少如果您从`etags`and开始`ctags`，您会发现它们没有所需的功能，然后调查一些 3rd 方 eLISP 包。

我做了一些假设。

1.  您使用 *nix。
2.  您使用 Gnu emacs。

XEmacs 和/或 Windows 和 OSx 上的其他东西可能会更好。

显然，`global`符合我的标准；但我从未亲自使用过它。我试图开始`CEDET`工作，这非常困难。**如果你的发行版**附带了一个包（`.deb`,`.rpm`等），它可能会更容易一些，比如`CEDET`.

# javascript - 以编程方式将参数传递给 grunt 任务？

> ID：14780622
> 
> 赞同：46
> 
> 时间：2013-02-08T20:15:44.180
> 
> 标签：javascript, node.js, gruntjs

我有一个调用其他 grunt 任务的 grunt 任务。我想用程序确定的参数调用一个子任务。这可能吗？我花了一些时间挖掘**lib/grunt.js**和**lib/grunt/task.js**，但无法弄清楚。

我正在使用**Gruntfile.js**`grunt-compass`中指定的以下参数：

 **```
compass: {
  default_options: {
    src: 'components/201',
    dest: 'build',
    require: ['zurb-foundation']
  }
} 
```

我希望能够在运行时覆盖它们：

**任务/my-task.js**：

```
// simplified example
module.exports = function(grunt) {
  grunt.registerTask('foo', 'bar', function() {
    var chooseDest = doWork();
    grunt.task.run('compass', {src: 'src', dest: chooseDest});
  });
}; 
```

以供参考：

```
$ grunt --version
grunt-cli v0.1.6
grunt v0.4.0rc6 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-08T20:33:03.243

我想到了。使用`<%= %>`Gruntfile.js 中的语法：

```
compass: {
  default_options: {
    src: 'components/<%= myTask.src %>',
    dest: 'build',
    require: ['zurb-foundation']
  }
} 
```

然后你可以在你的任务中设置它：

```
grunt.config.set('myTask.src', getSrc()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-22T13:01:47.590

您可以编辑所有 Grunt 配置：

```
grunt.config('compass.default_options.src', 'blabla'); 
```

就在运行任务之前。但是您的解决方案是“更清洁的”。**

# clojure - Clojure 模式匹配

> ID：14780627
> 
> 赞同：1
> 
> 时间：2013-02-08T20:16:08.860
> 
> 标签：clojure, pattern-matching

我正在尝试使用 Clojure [https://github.com/clojure/core.match](https://github.com/clojure/core.match)库实现 http 路由器。但是由于匹配是宏的 - 似乎在不使用 eval 的情况下，路由表的运行时更新是不可能的，这是邪恶的。有什么更清洁的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T00:31:22.670

正如亚历克斯在评论中所说，您将要查看[Compojure](https://github.com/weavejester/compojure)。

由于您在问题中引用了路由，因此这里是文档[的详细路由](https://github.com/weavejester/compojure/wiki/Routes-In-Detail)部分。

Stack Overflow 上也有[关于](https://stackoverflow.com/questions/3488353/whats-the-big-idea-behind-compojure-routes)compojure 路由背后的“大创意”的讨论。

# java - java进度条动画

> ID：14780635
> 
> 赞同：1
> 
> 时间：2013-02-08T20:16:51.117
> 
> 标签：java, user-interface, jprogressbar

所以我用谷歌搜索了这个，但我可以在上面找到任何东西：我在我的代码中调用了这个方法

```
 try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (Exception exc) {
        System.out.print("failed to load look and feel");
    } 
```

然后，我添加了一个名为 progressBar 的 JProgressBar，并在我单击 gui 上的按钮时调用此代码：

```
 progressBar.setBorderPainted(true);
    progressBar.setValue(progressBar.getValue()+1);
    Progresslabel.setText("Progress... "+progressBar.getString()); 
```

Progresslabel 只是一个显示进度的标签。现在，当我这样做时，进度条如下所示：

[http://i.imgur.com/gXp5ByH.png](http://i.imgur.com/gXp5ByH.png)

而不是在其他应用程序上这样：

[http://i.imgur.com/M61Cd59.png](http://i.imgur.com/M61Cd59.png)

看看我是如何非常矩形的，并且只填充进度条的一部分，而不是外部？我想知道是否有一种方法可以使用默认系统外观，但能够使用进度条，并让它们看起来像在其他程序上一样。有没有办法做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-21T22:43:01.753

您可以使用[SWT](https://www.eclipse.org/swt)使本机小部件出现。Swing progress 尽最大努力模拟操作系统的小部件，但它们不是真实的。缺少动画 Windows 进度条是 Swing 的缺点之一。

另一方面，SWT 使用看起来非常漂亮的真正的本机小部件。

# excel - 替换范围的一列中的数据

> ID：14780639
> 
> 赞同：0
> 
> 时间：2013-02-08T20:17:00.833
> 
> 标签：excel, vba

我已经过滤了一个工作簿，我需要将 A 列中的所有数据替换为“ISSUE”。这似乎很简单，我确信当我没有过滤器时我可以让它工作没有问题。

我已经设置了一个动态范围并使用了“对于 DRange 中的每个单元格”，但没有任何乐趣。

任何建议或帮助将不胜感激，

谢谢，

夏兰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:35:47.527

请执行下列操作：

1.  根据需要应用过滤器。
2.  选择`A`您需要替换的所有值。
3.  应用选择后，键入“ISSUE”，但按`CTRL`+`ENTER`而不是通常的`ENTER`- 这将使用键入的值自动填充整个选定范围，并且只有 FILTERED 值。

# spring - 具有多个连接工厂的 RabbitMQ 和 Camel

> ID：14780641
> 
> 赞同：1
> 
> 时间：2013-02-08T20:17:08.887
> 
> 标签：spring, rabbitmq

我正在尝试实现路由解决方案，其中我需要从一个兔子 mq 队列中读取消息并将消息放在不同的兔子 mq/不同队列上。

我能够与队列分开读写，但它不能一起工作。

这是骆驼配置文件：

```
 <?xml version="1.0" encoding="UTF-8"?>

    <beans xmlns="http://www.springframework.org/schema/beans"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:rabbit="http://www.springframework.org/schema/rabbit"
           xmlns:context="http://www.springframework.org/schema/context"
           xsi:schemaLocation="
           http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
           http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
           http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit-1.0.xsd">

        <context:annotation-config/>
        <context:component-scan base-package="amqp.spring.camel.component"/>

        <camelContext xmlns="http://camel.apache.org/schema/spring">

            <jmxAgent id="agent" createConnector="false" disabled="true" />
            <template id="wfcTemplate" />
            <template id="routerTemplate" />

            <route>
                <from uri="spring-amqp:exchange1:queue1:ABCD?type=topic&amp;autodelete=false&amp;durable=true" />
                <log  message="Message available on a RabbitMQ Queue : ${body}" />
                <to uri="spring-amqp:exchange2:queue2:EFGH?type=topic&amp;autodelete=false&amp;durable=true" />
            </route>
        </camelContext>

        <rabbit:connection-factory id="producerConnectionFactory" connection-factory="producerConnectionFactory" />
        <rabbit:template id="routerTemplate" connection-factory="producerConnectionFactory" message-converter="messageConverter" exchange="exchange2" />
        <rabbit:admin connection-factory="producerConnectionFactory" />
        <bean id="producerConnectionFactory" class="org.springframework.amqp.rabbit.connection.CachingConnectionFactory">
            <property name="host" value="10.0.10.100"/>
            <property name="port" value="5672"/>
            <property name="username" value="shailesh"/>
            <property name="password" value="shailesh"/>
            <property name="virtualHost" value="vh1"/>
        </bean>

        <rabbit:connection-factory id="consumerConnectionFactory" connection-factory="consumerConnectionFactory"/>
        <rabbit:template id="wfcTemplate" connection-factory="consumerConnectionFactory" message-converter="messageConverter" exchange="exchange1" />
        <rabbit:admin connection-factory="consumerConnectionFactory"/>
        <bean id="consumerConnectionFactory" class="org.springframework.amqp.rabbit.connection.CachingConnectionFactory">
            <property name="host" value="10.0.10.101"/>
            <property name="port" value="5672"/>
            <property name="username" value="shailesh"/>
            <property name="password" value="shailesh"/>
            <property name="virtualHost" value="vh2"/>
        </bean>

        <!-- converters -->
        <bean id="jsonMessageConverter" class="amqp.spring.converter.XStreamConverter"/>
        <bean id="textMessageConverter" class="amqp.spring.converter.StringConverter"/>
        <bean id="messageConverter" class="amqp.spring.converter.ContentTypeConverterFactory">
            <property name="converters">
                <map>
                    <entry key="application/json" value-ref="jsonMessageConverter"/>
                    <entry key="application/xml" value-ref="textMessageConverter"/>
                </map>
            </property>
            <property name="fallbackConverter" ref="textMessageConverter"/>
        </bean>

    </beans> 
```

我得到的错误如下：

```
 [pache.camel.spring.Main.main()] SpringCamelContext             INFO  Total 1 routes, of which 1 is started.
    [pache.camel.spring.Main.main()] SpringCamelContext             INFO  Apache Camel 2.10.3 (CamelContext: camel-1) started in 0.589 seconds
    [PConsumer.SpringAMQPExecutor-1] route1                         INFO  Message available on a RabbitMQ Queue : Hello, world! Fri Feb 08 14:14:33 CST 2013
    [l-1) thread #0 - amqp-producer] SpringAMQPProducer             ERROR Could not deliver message via AMQP
    java.lang.NullPointerException
        at amqp.spring.camel.component.SpringAMQPProducer$AMQPProducerTask.run(SpringAMQPProducer.java:150)[camel-spring-amqp-1.4.jar:]
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)[:1.7.0_11]
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)[:1.7.0_11]
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)[:1.7.0_11]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)[:1.7.0_11]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)[:1.7.0_11]
        at java.lang.Thread.run(Thread.java:722)[:1.7.0_11] 
```

# javascript - .append 链接不会触发 onclick 功能

> ID：14780644
> 
> 赞同：1
> 
> 时间：2013-02-08T20:17:13.243
> 
> 标签：javascript, jquery

我四处寻找我找不到这个问题的答案。在我的代码中，在 div 内部创建了一个链接，并赋予了 onclick 值以将参数传递给函数。我无法弄清楚为什么它不会触发。

```
var imgCount = 0;
var curImg;

function resetImg(target) {
alert(target);
}

$(".add").click(function () {
imgCount = imgCount + 1;
curImg = "theImg" + imgCount;

//Here we add the remove link
$('#links')
    .append('<a href="#" onclick="javascript:resetImg(\'' + curImg + '\');"  class="dynamic">Call Function</a>');
$('.dynamic').css('display', 'block');
}); 
```

这是小提琴：http: [//jsfiddle.net/stewarjs/4UV7A/](http://jsfiddle.net/stewarjs/4UV7A/)

我在创建链接时尝试过使用 .click() ，但是传递的参数需要对每个链接都是唯一的。我尝试获取 $(this).attr("id") 但值返回未定义。

感谢您的任何帮助。杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:21:03.687

我建议您使用已有的 jQuery 方法，而不是尝试将 HTML 转换为 JavaScript。

```
 $('#links')
    .append($("<a>").attr('href', '#').on('click', function () { resetImg(curImg);
 }).addClass('dynamic').text('Call Function')); 
```

[http://jsfiddle.net/ExplosionPIlls/4UV7A/1/](http://jsfiddle.net/ExplosionPIlls/4UV7A/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:20:13.450

从 onclick 中删除`javascript:`，它应该是这样的：`onclick="resetImg(\'' + curImg + '\');"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:22:24.613

总有办法摆脱`onclick`处理程序。这是我的做法：

```
var image_count = 0;

$('#links').on('click', '.dynamic', function(e) {
    e.preventDefault()

    alert($(this).data('image'));
});

$('.add').click(function () {
    $('<a />', {
        'href': '#',
        'data-image': 'theImg' + (++image_count),
        'class': 'dynamic',
        'text': 'Call function'
    }).appendTo('#links');
}); 
```

**演示：http: [//jsfiddle.net/4UV7A/4/](http://jsfiddle.net/4UV7A/4/)**

# c++ - R 和 C++ 迭代

> ID：14780647
> 
> 赞同：4
> 
> 时间：2013-02-08T20:17:27.463
> 
> 标签：c++, r, loops, rcpp

我正在尝试编写一个函数，该函数使用 Rcpp 从 R 在 C++ 中运行循环。

我有一个矩阵 Z，它比函数应该返回的矩阵 OUT 短一行，因为 OUT 的第一行的每个位置将由标量 sigma_0 给出。

该函数应该实现微分方程。每次迭代取决于来自矩阵 Z 的值以及先前生成的矩阵 OUT 值。

我得到的是这样的：

```
cppFunction('
    NumericMatrix sim(NumericMatrix Z, long double sigma_0, long double delta, long double omega, long double gamma) {
        int nrow = Z.nrow() + 1, ncol = Z.ncol();
        NumericMatrix out(nrow, ncol);

        for(int q = 0; q < ncol; q++) {
            out(0, q) = sigma_0;
        }

        for(int i = 0; i < ncol; i++) {

            for(int j = 1; j < nrow; j++) {
                long double z = Z(j - 1, i);
                long double sigma = out(j - 1, i);
                out(j, i) = pow(abs(z * sigma) - gamma * z * sigma, delta);

            }
        }

        return out;
    }
') 
```

不幸的是，我相当肯定它不起作用。该函数运行但计算的值不正确 - 我已经检查了 Excel 中的简单示例和纯 R 编码。我已经剥离了主微分方程，试图逐步构建它，以查看使用 C++ 的 Excel 和 R 的实现何时开始不同。这似乎是当我开始使用 abs() 函数和 power() 函数时，但我根本无法缩小问题的范围。任何帮助将不胜感激 - 我可能会提到这是我第一次使用 C++ 和 C++ 以及 R。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:24:31.830

我想你想要`fabs`而不是`abs`. `abs`对`int`s 进行`fabs`操作，而对双精度数/浮点数进行操作。

# oracle - Oracle/PLSQL 中的分页错误

> ID：14780650
> 
> 赞同：1
> 
> 时间：2013-02-08T20:17:30.780
> 
> 标签：oracle, plsql, pagination, runtime-error, dynamic-sql

嘿，我正在尝试`paging`在 PLSQL 中添加我的动态 sql 块，但是由于某种原因，当我运行测试脚本时它会出错：

```
ORA-00932: inconsistent datatypes: expected - got - 
```

这是我的程序：

```
create or replace 
  procedure spm_search_patientmedrecs (
    p_columnsort_in       in varchar2,
    p_column1_in          in varchar2,
    p_column2_in          in varchar2,
    p_column3_in          in varchar2,
    p_column4_in          in varchar2,
    p_ascdesc_in          in varchar2,
    p_return_cur_out      out sys_refcursor
  is
    lv_sql             varchar2(32767);
    lv_startnum        number:= 1;
    lv_incrementby     number:= 20;
  begin
    lv_sql := '';    
        lv_sql := 'select * from (
                   select /*+ first_rows(20) */
                      '||p_column1_in||',
                      '||p_column2_in||',
                      '||p_column3_in||',
                      '||p_column4_in||',
                      row_number() over
                        (order by '||p_columnsort_in||' '||p_ascdesc_in||') rn
                   from membermedicalreconcilationhdr h,
                        membermedicalreconcilationdet d
                   where h.membermedreconciliationhdrskey = 
                         d.membermedreconciliationhdrskey)
                   where rn between :lv_startnum and :lv_incrementby
                   order by rn';

        open p_return_cur_out for lv_sql;
  end spm_search_patientmedrecs; 
```

这是我的测试脚本：

```
 set serveroutput on
  declare 
    type tempcursor is ref cursor;
    v_cur_result tempcursor;
    p_columnsort_in   varchar2(50);
    p_column1_in      varchar2(50);
    p_column2_in      varchar2(50);
    p_column3_in      varchar2(50);
    p_column4_in      varchar2(50);
    p_ascdesc_in          varchar2(50);
  begin
    spm_search_patientmedrecs
    ('h.PRIMARYMEMBERPLANID',
     'h.PRIMARYMEMBERPLANID',
     'h.ASSIGNEDUSERID',
     'd.MEMBERMEDRECONCILIATIONDETSKEY',
     'd.GENERICNM',
     'ASC',
     v_cur_result
     );
   loop
      fetch v_cur_result into
        p_column1_in,p_column2_in,p_column3_in,p_column4_in;
        dbms_output.put_line('column 1: '||p_column1_in||' column 2: '||p_column2_in||
                             ' column 3: '||p_column3_in||' column 4: '||p_column4_in);
      exit when v_cur_result%notfound;
    end loop;
  end; 
```

我上面发布的错误对我来说没有意义，但我一直在寻找原因。如果有人能指出我正确的方向，将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:30:16.497

我突然想到了几个问题。

*   您用于返回游标的查询返回 5 列（传入的 4 列加上计算的`rn`），而您`fetch`仅将数据提取到 4 个变量中。您要么需要修改查询以仅返回 4 列，要么修改测试脚本以将数据提取到 5 个变量中。
*   在您的过程中，您的 SQL 语句中有绑定变量，但您在打开游标时没有传入任何绑定变量。我的猜测是你想要这样的东西

`USING`使用子句传递绑定变量

```
open p_return_cur_out 
     for lv_sql 
   using lv_startnum, lv_incrementby; 
```

可能还有更多错误——如果有，发布完整的堆栈跟踪（包括错误的行号）会很有帮助。

还有几件事需要注意。

*   除非`p_columnsort_in`碰巧指定了唯一的列，否则您的分页代码很可能会错过行和/或在多个页面中显示行，因为没有完全指定排序顺序。如果第 20 行和第 21 行具有相同的`p_columnsort_in`值，则在第一个查询中以一种方式对它们进行排序而在第二个查询中以另一种方式对它们进行排序是完全合法的，因此第 20 行可能会出现在第一页和第二页上，而第 21 行可能不会出现任何地方。
*   如果效率是一个问题，那么使用`rownum`可能最终会比使用这样的分析函数更有效，因为优化器通常可以更好地优化`rownum`谓词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:30:29.833

```
create or replace 
  procedure spm_search_patientmedrecs (
    p_columnsort_in       in varchar2,
    p_column1_in          in varchar2,
    p_column2_in          in varchar2,
    p_column3_in          in varchar2,
    p_column4_in          in varchar2,
    p_ascdesc_in          in varchar2,
    p_return_cur_out      out sys_refcursor
  is
    lv_sql             varchar2(32767);
    lv_startnum        number:= 1;
    lv_incrementby     number:= 20;
  begin
        lv_sql := 'select * from (
                   select /*+ first_rows(20) */
                      '||p_column1_in||',
                      '||p_column2_in||',
                      '||p_column3_in||',
                      '||p_column4_in||',
                      row_number() over
                        (order by '||p_columnsort_in||' '||p_ascdesc_in||') rn
                   from membermedicalreconcilationhdr h,
                        membermedicalreconcilationdet d
                   where h.membermedreconciliationhdrskey = 
                         d.membermedreconciliationhdrskey)
                   where rn between :1 and :2
                   order by rn';
        open p_return_cur_out for lv_sql using lv_startnum, lv_incrementby;
  end spm_search_patientmedrecs; 
```

# python - 有没有办法从 django 的视图中上传文件？

> ID：14780653
> 
> 赞同：0
> 
> 时间：2013-02-08T20:17:37.120
> 
> 标签：python, django, django-models, django-views

我知道您可以在 django 中使用 ModelForm 上传文件，但是有没有办法通过视图来代替？例如，在表单完成后，我想要一个自动化的过程来创建一个文件（基于表单的输入）并将其上传到我的媒体目录，但文件本身不是由提交的用户提交的形式。因此，在表单提交视图中，我想编写生成非文本文件（视频）并将其上传到我的媒体目录的代码。我的媒体文件托管在 amazon S3 上，如果有影响的话。这在 django 中是否可行，如果可以，怎么办？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T14:47:39.480

所以我回答了我原来的问题：

```
input = "blah file input"
filename = "media/filename.txt"
storage = default_storage.open(filename, 'w+')
storage.write(input)
storage.close() 
```

# facebook - Facebook fql 查询仅提供用户的 100 个最新状态

> ID：14780654
> 
> 赞同：0
> 
> 时间：2013-02-08T20:17:38.940
> 
> 标签：facebook, facebook-graph-api, facebook-fql, koala

```
@graph = Koala::Facebook::API.new($access_token) 
```

下面的查询只返回某个用户的最新 100 个状态，而不是所有状态

```
@graph.fql_query("SELECT status_id, message FROM status WHERE uid='user_id'") 
```

怎么了？如果我做错了什么，任何人都可以指导我。

等待中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:47:13.023

Facebook 对它返回的数据非常吝啬，除非你要求更多。

尝试添加`LIMIT 200`到查询的末尾，看看是否能给你更多。我认为任何表都不会返回超过 5000 行，有些表返回的行数要少得多。

如果这不起作用，您可能需要进行多个查询，`LIMIT 100 OFFSET _n_`其中100`_n_`的 a 将是 101、201、301 等`LIMIT`。

# r - ggplot2：倒序日期

> ID：14780658
> 
> 赞同：2
> 
> 时间：2013-02-08T20:17:49.647
> 
> 标签：r, ggplot2

我正在 ggplot2 中绘制数据集与日期，y 轴是日期。我想按时间倒序排列日期。最早的日期在 y 轴的顶部。另外，我想以我想要的方式格式化日期。

我遇到的麻烦是我相信我需要 scale_y_continuous() 和 scale_y_reverse 来完成此任务，但它们不能很好地配合使用。我在我的情节中尝试的是：

```
... ggplot setup ... +
scale_y_continuous(label=function(juldate) strftime(chron(juldate), "%Y-%m-%d")) +
scale_y_reverse() 
```

我得到的错误是：

```
Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale. 
```

我怎样才能让格式化和反转一起工作？请注意，在这个例子中，y 轴是一个儒略日期整数，这是我最后一次尝试让事情很好地协同工作。

独立地，任何一个 scale_y... 语句都会做它应该做的事情，要么正确格式化，要么反转轴，但我不能同时使用两者。

任何帮助表示赞赏。

谢谢，马特

添加：可重现的示例

```
 library("ggplot2")
 library("chron")

 # Data to graph.  Want to show a calendar, days on the left
 # and candle lines showing the duration of each event.
 work <- rbind(
             data.frame(ydate_start=15480, ydate_end=15489, event="Event One"),
             data.frame(ydate_start=15485, ydate_end=15499, event="Event Two")
             )

 # Formats nicely, but I want order of dates reversed
 ggplot(work,
        aes(x=event,
            y=ydate_start,
            ymin=ydate_start,
            ymax=ydate_end,
            color=event)
 ) +
     geom_linerange() +
     ylab("Date") +
     scale_y_continuous(label=function(x) strftime(chron(x), "%Y-%m-%d"))

 # Order reversed, but no formatting applied
 ggplot(work,
        aes(x=event,
            y=ydate_start,
            ymin=ydate_start,
            ymax=ydate_end,
            color=event)
 ) +
     geom_linerange() +
     ylab("Date") +
     scale_y_reverse()

 # Both delarations don't play well together well
 ggplot(work,
        aes(x=event,
            y=ydate_start,
            ymin=ydate_start,
            ymax=ydate_end,
            color=event)
 ) +
     geom_linerange() +
     ylab("Date") +
     scale_y_continuous(label=function(x) strftime(chron(x), "%Y-%m-%d")) +
     scale_y_reverse()
#> Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:47:38.797

我解决了我自己的问题。我一定有错字或者没有以某种方式正确尝试过，但解决方案是 scale_y_reverse() 将“标签”作为参数，就像 scale_y_continuous 一样。以下作品：

```
library("ggplot2")
library("chron")

# Data to graph.  Want to show a calendar, days on the left
# and candle lines showing the duration of each event.
work <- rbind(
            data.frame(ydate_start=15480, ydate_end=15489, event="Event One"),
            data.frame(ydate_start=15485, ydate_end=15499, event="Event Two")
            )

# THIS SOLVES THE PROBLEM
ggplot(work,
       aes(x=event,
           y=ydate_start,
           ymin=ydate_start,
           ymax=ydate_end,
           color=event)
) +
    geom_linerange() +
    ylab("Date") +
    scale_y_reverse(label=function(x) strftime(chron(x), "%Y-%m-%d")) 
```

# php - 电子邮件似乎只发送到 gmail

> ID：14780659
> 
> 赞同：1
> 
> 时间：2013-02-08T20:17:51.433
> 
> 标签：php

我正在使用一些代码将数据发送到数据库，该数据库还将确认电子邮件发送到在表单字段中输入的电子邮件地址

出于某种奇怪的原因，它似乎只发送到我的 gmail 帐户，而没有像 hotmail tiscali yahoo 这样的其他东西

这是我用来发送电子邮件的代码

```
 // this send the receiver an email with the link to their ecard
 mail("$receiveremail","Somebody loves you !", "<img src=\"http://www.somebodylovesyou.co.uk/images/email-header.jpg\" width=\"300\" height=\"57\"> 
 </p>
 <p>Hello $name,</p>
 <p>Someone you know has sent you a secret valentine's message from http://www.somebodylovesyou.co.uk </p>
 <p>You can view your message here : <a href='http://www.somebodylovesyou.co.uk/viewcard.php?rand=$eid'>http://www.somebodylovesyou.co.uk/viewcard.php?rand=$eid</a></P>
 <P>Why not send a special someone a secret valentine's message at http://www.somebodylovesyou.co.uk</p>
 <P>Happy Valentines", $headers); 

 // this send the receiver an email with the link to their ecard
 mail("$youremail","View the message you've just sent", "<img src=\"http://www.somebodylovesyou.co.uk/images/email-header.jpg\" width=\"300\" height=\"57\"> 
 </p>
 <p>Hello,</p>
 <p>Thanks for using Somebody Loves You </p>
 <p>You can view the message you sent here : <a href='http://www.somebodylovesyou.co.uk/viewcard.php?rand=$eid'>http://www.somebodylovesyou.co.uk/viewcard.php?rand=$eid</a></P>
 <P>Happy Valentine's", $headers);?> 
```

有人建议我也使用这些标题来帮助发送电子邮件，但它似乎不起作用

```
 // these headers are for the purpose of sending the email replay to hotmail and yahoo addresses
 $headers = "MIME-Version: 1.0\r\n"; 
 $headers .= "Content-type: text/html; charset=iso-8859-1\r\n"; 
 $headers .= "From: SOMEBODY LOVES YOU <hello@somebodylovesyou.co.uk>\r\n"; 
 $headers .= "Reply-To: <hello@somebodylovesyou.co.uk>\r\n"; 
 $headers .= "X-Priority: 3\r\n"; 
 $headers .= "X-MSMail-Priority: Normal\r\n"; 
 $headers .= "X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2800.1409\r\n"; 
 $headers .= "X-Mailer: Microsoft Outlook Express 6.00.2800.1409"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:14:05.800

从技术上讲，就协议而言，Gmail 与任何其他电子邮件服务完全相同，所以我想这不是与代码相关的问题。

我要检查的是您的外发电子邮件服务器和域，尤其是两件事：

*   [SPF](http://en.wikipedia.org/wiki/Sender_Policy_Framework)记录
*   [DKIM](http://en.wikipedia.org/wiki/DKIM)签名

这些是电子邮件伪造预防技术。某些电子邮件服务会自动拒绝任何没有 SPF 和 DKIM 的邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:40:57.137

试试[SwiftMailer](http://swiftmailer.org/)它非常容易使用而且非常健壮

```
$body = "<img src=\"http://www.somebodylovesyou.co.uk/images/email-header.jpg\" width=\"300\" height=\"57\">   </p>  <p>Hello $name,</p>  <p>Someone you know has sent you a secret valentine's message from http://www.somebodylovesyou.co.uk </p>  <p>You can view your message here : <a href='http://www.somebodylovesyou.co.uk/viewcard.php?rand=$eid'>http://www.somebodylovesyou.co.uk/viewcard.php?rand=$eid</a></P> <P>Why not send a special someone a secret valentine's message at http://www.somebodylovesyou.co.uk</p>  <P>Happy Valentines</p>";      
    $transport = Swift_MailTransport::newInstance();

     $mailer = Swift_Mailer::newInstance($transport);
     $message = Swift_Message::newInstance($subject)
             ->setFrom(array("hello@somebodylovesyou.co.uk" => "SOMEBODY LOVES YOU"))
             ->setTo(array($receiveremail))
             ->setBody($body, 'text/html');

$mailer->send($message); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:42:27.703

听起来这不是您的代码的问题。如果它到达一个邮件提供商而不是另一个，那么其他提供商将阻止它或将其标记为垃圾邮件。

此时，您要检查确保正确设置 MX 记录和其他 DNS 记录以识别您的服务器。

您的域/IP 也有可能被列入黑名单。在这种情况下，每个邮件提供商都有您可以采取的步骤来摆脱他们的黑名单。

# java - 我的代码正在做我想做的一半。请帮忙

> ID：14780663
> 
> 赞同：0
> 
> 时间：2013-02-08T20:18:15.600
> 
> 标签：java

该代码应该反转一个字符串，所以如果我输入“你好吗”它应该返回“你是多么嗨”并且单词以正确的顺序出现，但它们的单词也颠倒了（例如“ouy era woh ih") 有人看到我应该添加或删除什么吗？

```
import java.util.*;
public class ReverseString
{
    public static void main(String args[])
    {
        String original, reverse = "";
        Scanner in = new Scanner(System.in);

        System.out.println("Enter a string to reverse");
        original = in.nextLine();

        int length = original.length();

        for ( int i = length - 1 ; i >= 0 ; i-- )
            reverse =reverse + original.charAt(i);

            System.out.println("Reverse of entered string is "+reverse);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:20:46.717

你需要把字符串分解成这样的词：

```
splitArray = original.split("\\s+"); 
```

或者更多细节：

```
public class ReverseString {

    public static void main(String args[]) {
        String original, reverse = "";
        Scanner in = new Scanner(System.in);

        System.out.println("Enter a string to reverse");
        original = in.nextLine();

        String[] splitArray;
        try {
            splitArray = original.split("\\s+");
            for (int i = splitArray.length - 1; i >= 0; i--) {
                reverse = reverse + splitArray[i] + " ";
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        System.out.println("Reverse of entered string is: " + reverse);
    }
} 
```

输出：

```
run:
Enter a string to reverse
this is a test
Reverse of entered string is: test a is this 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:22:31.007

最简单的方法是以相反的顺序拆分和访问数组：

```
String str = "hi how are you";

String[] words = str.split(" ");

StringBuilder buffer = new StringBuilder();
for (int i = words.length - 1; i >= 0; i--) {

     if(i != ( words.length - 1)) buffer.append(" ");

     buffer.append(words[i]);

     System.out.println(words[i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:22:58.980

里面的这个颠倒的词序`str`：

```
String [] parts = str.split (" ");
StringBuilder sb = new StringBuilder ();
for (int i = parts.length - 1; i >= 0; i--)
{
    if (sb.length () > 0) sb.append (' ');
    sb.append (parts [i]);
}
str = sb.toString (); 
```

# c++ - Boost Property Tree：从节点中删除属性

> ID：14780665
> 
> 赞同：1
> 
> 时间：2013-02-08T20:18:23.563
> 
> 标签：c++, c++11, boost, boost-propertytree

我有以下 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<gexf>
  <graph>
    <nodes>
      <node id="0" label="0" start="0" end="25"/>
      <node id="1" label="1" start="1"/>
      <node id="2" label="2" start="2"/>
      ...
    </nodes>
    <edges>
      <edge id="0" source="0" target="1" start="7" end="19"/>
      <edge id="1" source="0" target="2" start="8" end="20"/>
      ...
    </edges>
  </graph>
</gexf> 
```

我想用 and 删除边缘的`start`and属性。`end``source="0"``target="1"`

我尝试这样做的方式是在以下代码中。假设 XML 文件名为`ptree_test.gexf`我读入它，在树中找到正确的边，然后尝试使用`erase`来摆脱属性。

```
#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/xml_parser.hpp>
#include <iostream>

using boost::property_tree::ptree;

int main(int argc, char *argv[]) {

  ptree pt;

  read_xml("ptree_test.gexf", pt);

  // Now find edge (0, 1) and delete the start and end attributes
  ptree edge;
  int id1, id2;
  id1 = 0;
  id2 = 1;

  for(auto &e : pt.get_child("gexf.graph.edges")) {
    int s, t;
    s = e.second.get<int>("<xmlattr>.source");
    t = e.second.get<int>("<xmlattr>.target");

    // Check if this is the correct edge
    // Two checks because it can be reversed
    if((id1 == s && id2 == t) || (id1 == t && id2 == s)) {
      edge = e.second;
      break;
    }
  }

  for(auto & attr : edge.get_child("<xmlattr>")) {
    if(attr.first == "end" || attr.first == "start") {
      edge.erase(attr.first);
    }
  }

  write_xml(std::cout, pt);
  return 0;
} 
```

这不起作用。它不会删除该属性。事实上，如果我输入一个调试语句来打印它的返回值，`edge.erase(attr.first)`就会显示`0`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:09:02.500

在回答之前，我想再次劝阻您不要将 Boost.PropertyTree 用作快速而肮脏的 XML 处理系统。请[使用真正的 XML 解析器](https://stackoverflow.com/questions/9387610/what-xml-parser-should-i-use-in-c)；有很多可供选择，有些非常有效，几乎不需要依赖维护。

无论如何，您的问题来自[您对`erase`](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/property_tree/basic_ptree.html#idp66428336-bb). 您正试图从*您正在迭代*的列表中删除一个元素。那是行不通的。并非没有为您的循环进行特殊编码。

所以你不能在这里使用基于范围的 for 循环。您必须在迭代器上使用真正的 for 循环。

```
auto &children = edge.get_child();
for(auto &attrIt = children.begin(); attrIt != children.end();)
{
  auto &attr = *attrIt;
  //Do stuff here.

  if(attr.first == "end" || attr.first == "start")
    attrIt = children.erase(attrIt);
  else
    ++attrIt;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-02T18:56:53.343

主要问题是您正在此行中制作子树的副本：

```
 edge = e.second; 
```

然后修改该*副本*而不是原始副本。后来，正如@NicolBolas 所说，您需要一个交互器来`erase`. 完整的代码如下所示：

```
int main(){
        boost::property_tree::ptree pt;
        read_xml("ptree_test.gexf", pt, boost::property_tree::xml_parser::trim_whitespace);
        int id1, id2;
        id1 = 0;
        id2 = 1;
        for(auto &e : pt.get_child("gexf.graph.edges")) {
            int s, t;
            s = e.second.get<int>("<xmlattr>.source");
            t = e.second.get<int>("<xmlattr>.target");
            // Check if this is the correct edge
            // Two checks because it can be reversed
            if((id1 == s && id2 == t) || (id1 == t && id2 == s)){
                auto &children = e.second.get_child("<xmlattr>");
                for(auto attrIt = children.begin(); attrIt != children.end(); ++attrIt){
                  if(attrIt->first == "end" || attrIt->first == "start")
                    attrIt = children.erase(attrIt);
                }
                break; // maybe shouldn't be here to keep looking?
            }
        }
        write_xml("ptree_test_copy.gexf", pt, std::locale(), bpt::xml_writer_settings<std::string>{'\t', 1});
} 
```

[![之前和之后](../Images/841a937712d3504c399a01052702cdea.png)](https://i.stack.imgur.com/Xtosr.png)

# jquery - 在jquery mobile中使用URL参数多次调用动态页面

> ID：14780666
> 
> 赞同：1
> 
> 时间：2013-02-08T20:18:24.803
> 
> 标签：jquery, html, cordova, jquery-mobile

我正在使用带有 phonegap 的 jQuery mobile 来创建 iPhone 应用程序。我在 URL 中传递动态 id 以从数据库中获取数据并在页面加载时填写页面上的字段。

```
$.mobile.changePage( "child-form-page.html?id=1"); 
```

它第一次工作正常，并且调用了 data-roll div id live 函数

```
$('#childForm').live('pagecreate',function(event){ 
  //Fetch data and fill fields based on ID i get in url
}); 
```

但是当我提交表单并使用同一页面移动到下一个表单时，`$.mobile.changePage( "child-form-page.html?id=2");`触发`$('#childForm').live`功能两次，数据丢失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:14:50.210

如果您`<script>`在该部分中添加了标签`<header>`，则您的事件将仅在第一个页面加载时绑定。如果您将`<script>`标签作为标签的第一个子`<div role="page">`标签，它将被一遍又一遍地绑定。

本页底部的详细信息：http: [//jquerymobile.com/demos/1.2.0/docs/pages/page-anatomy.html](http://jquerymobile.com/demos/1.2.0/docs/pages/page-anatomy.html)

另外，请确保您没有使用`$(document).ready();` [http://jquerymobile.com/demos/1.2.0/docs/api/events.html](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:32:19.820

因为您没有向我们提供更多代码，所以我只能为您提供解决问题的方法。jQuery Mobiles 的工作性质会在绑定事件时给我们带来一些问题。jQuery 事件绑定没有阻止多个事件（相同事件，例如单击事件）绑定到单个元素的检查。

这可以通过几种方式来防止，我会为你列举所有这些，但我认为你的问题与多事件绑定无关，因为与 jQuery 不同，jQuery Mobile 页面事件绑定会阻止多绑定，在这种情况下你会找到你的解决方案在我的答案的底部。

**解决方案1：**

在绑定之前删除事件：

```
$('#index').live('pagebeforeshow',function(e,data){    
    $('#test-button').die().live('click', function(e) {
        alert('Button click');
    });    
}); 
```

如果您有不同的事件绑定到一个对象：

```
$('#index').live('pagebeforeshow',function(e,data){    
    $('#test-button').die('click').live('click', function(e) {
        alert('Button click');
    });    
}); 
```

**解决方案2：**

使用 jQuery 过滤器选择器，如下所示：

```
$('#carousel div:Event(!click)').each(function(){
    //If click is not bind to #carousel div do something
}); 
```

因为事件过滤器不是官方 jQuery 框架的一部分，所以可以在这里找到：http: [//www.codenothing.com/archives/2009/event-filter/](http://www.codenothing.com/archives/2009/event-filter/)

简而言之，如果速度是您主要关心的问题，那么解决方案 2 比解决方案 1 好得多。

**解决方案3：**

一个新的，可能是最简单的。

```
$(document).on('pagebeforeshow', '#page', function(event){  
    if(event.handled !== true) // This will prevent event triggering more then once
    {
        // Some code
        event.handled = true;
    }
    return false;                
}); 
```

此解决方案的 Tnx 到 sholsinger：http: [//sholsinger.com/archive/2011/08/prevent-jquery-live-handlers-from-firing-multiple-times/](http://sholsinger.com/archive/2011/08/prevent-jquery-live-handlers-from-firing-multiple-times/)

**pageChange 事件怪癖 - 触发两次**

有时候pagechange事件可以触发两次，和前面提到的问题没有任何关系。

pagebeforechange 事件发生两次的原因是由于在 toPage 不是 jQuery 增强的 DOM 对象时 changePage 中的递归调用。这种递归是危险的，因为允许开发人员在事件中更改 toPage。如果开发人员始终将 toPage 设置为字符串，则在 pagebeforechange 事件处理程序中，无论它是否是对象，都会导致无限递归循环。pageload 事件将新页面作为数据对象的页面属性传递（这应该添加到文档中，当前未列出）。因此，pageload 事件可用于访问加载的页面。

简而言之，这是因为您正在通过 pageChange 发送其他参数。

例子：

```
<a data-role="button" data-icon="arrow-r" data-iconpos="right" href="#care-plan-view?id=9e273f31-2672-47fd-9baa-6c35f093a800&amp;name=Sat"><h3>Sat</h3></a> 
```

[要解决此问题，请使用页面事件转换顺序](http://www.gajotres.net/document-onpageinit-vs-document-ready/)一章中列出的任何页面事件（这是我关于 jQuery Mobile 页面事件绑定的其他答案/文章）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-26T14:29:06.803

如果您执行 DOM 操作，例如通过`pagecreate`处理程序中的 jQuery，您可能会无意中触发此类行为。

```
<div data-role="page" id="somePage"> 
  <div id="elem"/>
</div> 
```

和处理程序：

```
$('#somePage').on("pagecreate", function() {    
  var table = $('<table></table>').addClass('t');                                                       
  $('#elem').append(table);
}); 
```

由于`elem`div 未定义为`<div id="elem"></div>`, 但是`<div id="elem"/>`，这会导致麻烦。

因此，它很可能与您要传递的动态 id 无关。

# java - java蛇和梯子游戏中如何设置蛇和梯子的位置？

> ID：14780667
> 
> 赞同：1
> 
> 时间：2013-02-08T20:18:28.980
> 
> 标签：java, algorithm, swing, user-interface

我正在用java开发一个蛇和梯子游戏，它是可配置的——也就是说，你可以在其中设置蛇和梯子的“头”和“尾”位置。我已经尝试加载蛇图像并适当地调整它们的大小适合头部和尾部位置的范围，但这似乎会影响图像的质量。任何人都可以提出更好的方法/算法吗？非常感谢帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:22:00.077

我建议将蛇形图形分成几个部分——一个头部、一个尾巴和一个或多个中间身体部分。然后，根据所需的蛇长度，您可以根据需要从中间部分绘制它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T06:44:46.880

您使用的方法有两个“问题”，可能会导致质量不佳：

1.  您正在（我假设）升级图形图像，这将导致块状。

2.  如果你改变 x 和 y 轴的比例（例如放大），长蛇会比短蛇更胖更宽，这不是人们期望看到的。

我会稍微修改 fd 的解决方案。进行如下操作：

为头部、尾部和中间的*单个*部分准备一个图形，这样您就可以将任意数量的中间部分链接在一起。

当你需要画一条蛇时，计算它的长度。然后看看整条蛇需要多少个中间部分才能等于或大于这个计算的长度。

创建一个正确大小的位图缓冲区，以容纳具有正确数量的中间部分的水平（或垂直！）蛇。将背景绘制为透明，然后将蛇绘制到此位图中。它通常会比您需要的时间稍长一些。

缩放和旋转位图并将其放置在板上的正确位置。

您仍会在一定程度上进行缩放，但比例因子应该足够小以至于不明显。例如，如果您需要 5.5 个中间部分来精确匹配，那么您将绘制 6 个中间部分，然后将整条蛇缩放大约 5.5/6 以使其长度完全正确。这不到 10% 的变化，所以应该不明显。

这样就解决了上面的问题：

1.  蛇的宽度只会略有不同
2.  你只低档，从不高档。

它具有以下实际好处：

1.  您只需要水平（或垂直）布置蛇，这很容易做到
2.  它应该非常有效。所有真正的工作都是由图形库完成的，它必须旋转、缩放和放置构建的蛇。在大多数平台上，这些操作被实现为在硬件中计算的转换矩阵，因此速度非常快。我在自己编写的 Android 应用程序中广泛使用了这种方法，而且速度非常快。

请注意，蛇中的“摆动”越多，您的比例因子与 1.0 的差异就越小，因此宽度的变化就越小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-07T19:36:44.807

公共类 SankesAndLadder {

```
static int turn = 0;
static int[] gameBoard = new int[100];
static Map<Integer, Integer> ladderPositionValue;
static Map<Integer, Integer> snakePositionValue;
static int userPosition = 0;
static int computerPosition = 0;

public static void populateBoard() {
    ladderPositionValue = new HashMap<>();
    snakePositionValue = new HashMap<>();
    // SUPPOSE WE HAVE 10 LADDERS AND 10 SNAKES
    for (int i = 0; i < 10; i++) {
        int ladderPositionKey = (int) (Math.random() * 85) + 10;
        if (!ladderPositionValue.keySet().contains(ladderPositionKey)) {
            ladderPositionValue.put((int) (Math.random() * 100) + 1, (int) (Math.random() * 10) + 5);
        } else {
            i--;
        }
        int snakePositionKey = (int) (Math.random() * 95) + 15;
        if (!ladderPositionValue.keySet().contains(ladderPositionKey) &&
                !snakePositionValue.keySet().contains(ladderPositionKey)) {
            snakePositionValue.put((int) (Math.random() * 100) + 1, (int) (Math.random() * 10) + 5);
        } else {
            i--;
        }
    }
}

public static int rollDice(int repeat) {
    System.out.println("ROLLING DICE...PRESS ANY KEY TO CONTINUE:");
    Scanner in = new Scanner(System.in);
    String cont = in.nextLine();
    int rolledNo = (int) (Math.random() * 6) + 1;
    if (rolledNo == 6) {
        System.out.println("NUMBER IS:" + rolledNo + ". ANOTHER CHANCE.");
        rollDice(repeat++);
    } else {
        System.out.println("NUMBER IS:" + rolledNo);
    }
    int finalCount = rolledNo + (repeat * 6);
    return finalCount;
}

public static boolean userTurn() {
    if (turn % 2 == 0) {
        turn++;
        return true;
    }
    turn++;
    return false;
}

public static void newUserPosition(int rolledNo) {
    userPosition = userPosition + rolledNo;
    System.out.println("YOUR NEW POSITION IS:" + userPosition);
    userPosition = checkSnakeOrLadder(userPosition);
}

public static void newComputerPosition(int rolledNo) {
    computerPosition = computerPosition + rolledNo;
    computerPosition = checkSnakeOrLadder(userPosition);
}

private static int checkSnakeOrLadder(int position) {
    if (snakePositionValue.keySet().contains(position)) {
        System.out.println("AAAAAAAAAAAHHHH ... BITTEN BY SNAKE");
        position = position - snakePositionValue.get(position);
    } else if (ladderPositionValue.keySet().contains(position)) {
        System.out.println("YAAAAAAAY.. GOT A LADDER");
        position = position + ladderPositionValue.get(position);
    }
    return position;
}

public static void main(String args[]) {
    System.out.println("WELCOME TO SNAKES & LADDER");
    System.out.println("***************************");
    populateBoard();
    while (userPosition != 100 && computerPosition != 100) {
        if (userTurn()) {
            System.out.println("YOUR TURN:");
            int rolledNo = rollDice(0);
            System.out.println("MOVING YOUR POSITION:");
            newUserPosition(rolledNo);
        } else {
            System.out.println("COMPUTER TURN:");
            int rolledNo = rollDice(0);
            System.out.println("MOVING COMPUTER POSITION:");
            newComputerPosition(rolledNo);
        }
    }
    if (userPosition == 100) {
        System.out.println("YOUR ARE THE WINNER!!!!");
    } else if (computerPosition == 100) {
        System.out.println("COMPUTER WON!!!!");
    }
} 
```

}

# jquery - 切换事件无缘无故隐藏了我的 div

> ID：14780669
> 
> 赞同：0
> 
> 时间：2013-02-08T20:18:31.440
> 
> 标签：jquery, setinterval

嗨，我有一个要切换的复选框。当我第一次单击/检查时，它会启动 setinterval（开始我的幻灯片），当我第二次单击时，它会停止幻灯片（clearinterval）。但无缘无故，它会在页面加载时隐藏/显示：none 我的复选框......

```
$("#start").toggle(function ()
            {
                var interval = setInterval(function() 
                {
                    alert("hey")
                    Img++
                    if (Img == 27)
                        {
                            Img = 0;
                        }
                    $("[src='images/slideshow2/carre/slideImg" + Img + ".jpg']").fadeIn()
                    $("#imgRonde").attr("src", "images/slideshow2/carre/slideImg" + Img + ".jpg");
                    $(".grandeurori").attr("href", "images/slideshow2/slideImg" + Img + ".jpg");
                }, 3000);

            }, function ()
            {
                clearInterval(interval)
            }) 
```

希望你能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:23:59.930

`.toggle()`不是在您的复选框上触发事件的方法。这是一个隐藏/显示的功能。你想用`.change()`

[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

[http://api.jquery.com/change/](http://api.jquery.com/change/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:23:49.243

您尝试使用的切换已在 jquery 1.9 中删除：

[http://api.jquery.com/toggle-event/](http://api.jquery.com/toggle-event/)

它改为调用此切换：

[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

# php - 在多个页面上发布数据

> ID：14780672
> 
> 赞同：1
> 
> 时间：2013-02-08T20:18:35.367
> 
> 标签：php, javascript, jquery, ajax

我想在多个页面上发布表单中的数据，但主要操作仍应为“”。所以点击后，它应该在同一页面上刷新，但 POST 数据也会转到另一个`.php`. 我需要这个，因为在另一个 .php 文件中，创建了一个图形，该图形被嵌入回原始表单页面。

我试过使用隐藏字段。我也可以`graph.php?var1=3&var2=3`，等等，但我宁愿不那样显示它。

我对javascript不太熟悉，但我觉得那是要走的路？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:26:41.433

是的，听起来您应该进行 jQuery .ajax 调用或使用 XMLHTTPRequest。发布到你需要的 URL，一旦你得到结果，重新加载页面。

```
var i = 0
var pages = 3
var fd = new FormData();    
fd.append( 'value1', $('form input').val() );
fd.append( 'value2', $('form textarea').val() );

$.ajax({
  url: 'http://example.com/page1.php',
  data: fd,
  processData: false,
  contentType: false,
  type: 'POST',
  success: function(data){
    i++;
    captureFunction();
  }
});

$.ajax({
  url: 'http://example.com/page2.php',
  data: fd,
  processData: false,
  contentType: false,
  type: 'POST',
  success: function(data){
    i++;
    captureFunction();
  }
});

$.ajax({
  url: 'http://example.com/page3.php',
  data: fd,
  processData: false,
  contentType: false,
  type: 'POST',
  success: function(data){
    i++;
    captureFunction();
  }
});

var captureFunction = function() {
  if(i != pages) return;
  location.reload()
} 
```

我认为这不会开箱即用，但会是您开始 hack 的一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:44:45.693

由于您正在使用`PHP`

当页面重新加载时，将 POST 请求卷曲到每个所需的页面。

例如

```
class Asynchronous {

    public function add($url, $params)
    {
        foreach ($params as $key => &$val) {
          if (is_array($val)) $val = implode(',', $val);
            $post_params[] = $key.'='.urlencode($val);
        }
        $post_string = implode('&', $post_params);

        $parts=parse_url($url);

        $fp = fsockopen($parts['host'], 
            isset($parts['port'])?$parts['port']:80, 
            $errno, $errstr, 30);

        $out = "POST ".$parts['path']." HTTP/1.1\r\n";
        $out.= "Host: ".$parts['host']."\r\n";
        $out.= "Content-Type: application/x-www-form-urlencoded\r\n";
        $out.= "Content-Length: ".strlen($post_string)."\r\n";
        $out.= "Connection: Close\r\n\r\n";
        if (isset($post_string)) $out.= $post_string;

        fwrite($fp, $out);
        fclose($fp);
    }
} 
```

# vb.net - 调整动态创建的标签的大小以适合其中的文本？

> ID：14780679
> 
> 赞同：2
> 
> 时间：2013-02-08T20:19:01.007
> 
> 标签：vb.net, winforms

我正在动态创建一个标签，然后动态地向它添加文本（并且添加到它的文本量每次都会不同）。因此，标签需要始终与其中的文本具有相同的宽度。

在 Windows 设计器中创建标签时，默认情况下会发生这种情况。但是当动态创建标签时，它似乎被“设置”在特定宽度，无论其中有多少文本（这意味着它经常“切断”一些文本）。

所以......知道如何让动态创建的标签始终与其中的文本保持相同的宽度吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:21:53.703

如果您想手动执行此操作，则可以在每次更改文本时执行以下操作：

```
Dim g As Graphics = Label1.CreateGraphics()
Label1.Width = CInt(g.MeasureString(Label1.Text, Label1.Font).Width) 
```

但是，简单地将标签的`AutoSize`属性设置为`True`并让标签为您完成工作要容易得多。

```
Label1.AutoSize = True 
```

# java - 需要一个可以将流程图导出为 xml 以供以后在 JavaApp 中使用的程序

> ID：14780681
> 
> 赞同：-2
> 
> 时间：2013-02-08T20:19:03.807
> 
> 标签：java, xml, marshalling, flowchart

我想开发一种简单的方法来为网站生成流程图。

这就是为什么我需要这样的东西：

首先在 <insert-program-here> 中绘制流程图并将其导出为 xml 文件。

此 xml 文件应由另一个程序导入和解组，在这种情况下，该程序是一个 Java 应用程序，它只不过是一个图形界面，用户可以使用它按照流程图找到他/她的特定解决方案。

我希望到目前为止我做对了..

有谁知道一个简单的程序，可以将流程图导出为 xml 文件，以便我可以如上所述使用它？还是有其他更舒适的方式来满足我的需求？

谢谢你的帮助！

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T19:50:51.020

我个人会推荐 yEd，因为我有很好的经验。它默认使用 XML 格式 GraphML，因此您的用户不必使用导出功能，但可以使用保存工作时生成的文件。

但我认为无法用简单的“我推荐程序 X”来回答您的问题。因为没有人知道你真正需要什么。也许一个程序无法为您提供您想要的流程图的所有功能。也许其他人不够便宜。

我想你必须自己找到合适的。要确定哪个程序可以为您完成，您可以检查几个绘图应用程序。可以在[这个问题](https://stackoverflow.com/questions/1705476/best-flowchart-software-online-or-offline-preferrably-free)中找到流程图程序列表。如果这还不够，您可以使用 google 查找更多信息。

# asp.net - GridView 计算字段

> ID：14780683
> 
> 赞同：0
> 
> 时间：2013-02-08T20:19:08.893
> 
> 标签：asp.net, gridview, webforms

我可以在我的 ASPX 页面中创建一个自定义链接，如下所示：

```
<asp:GridView 

    ID="GridView1" 
    CssClass="rounded-corner" 
    runat="server" 
    AutoGenerateColumns="false"
    EnableModelValidation="True" 
    AllowSorting="True"
    onsorting="GridView1_Sorting" 
    EnableViewState="true"
    AllowPaging="True"   
    PageSize="10"
    OnPageIndexChanging="GridView1_PageIndexChanging" >

        <Columns>
            <asp:BoundField DataField="DATE_ENTERED" HeaderText="Date Submitted" dataformatstring="{0:MMMM d, yyyy}" htmlencode="false" />
            <asp:BoundField DataField="CLIENT_CLAIM_NUM" HeaderText="Your Claim #" />
            <asp:BoundField DataField="PRIMARY_INSURED" HeaderText="Insured" />
            <asp:BoundField DataField="PRIMARY_CLAIMANT" HeaderText="Claimant" />
            <asp:BoundField DataField="LOB_ID" HeaderText="Type" />

            <asp:TemplateField HeaderText="Branch">
                <ItemTemplate>
                   <asp:HyperLink ID="BRANCH_NAME" runat="server" NavigateUrl='<%# "mailto:"+Eval("OWNERS_EMAIL") %>' Text='<%# Eval("BRANCH_NAME") %>' ToolTip='<%# 
                   "<span style=\"text-decoration:underline;\">"+Eval("BRANCH_NAME").ToString().Trim() + "</span><br />" + 
                   Eval("OWNERS_FIRST_NAME").ToString().Trim() + " " +
                   Eval("OWNERS_LAST_NAME").ToString().Trim() + "<br />" + 
                   Eval("OWNERS_EMAIL").ToString().Trim() + "<br />" + 
                   Eval("OWNERS_OFFICE_PHONE").ToString().Trim() + "<br />" + 
                   Eval("OWNERS_FAX_PHONE").ToString().Trim()
                   %> '> 
                   </asp:HyperLink>
                </ItemTemplate>
            </asp:TemplateField>

        </Columns>

</asp:GridView> 
```

相反，是否有一种方法可以直接在我的代码中执行此操作；通过创建一种“计算字段？”

后面的代码如下：

```
DbProviderFactory dbf = DbProviderFactories.GetFactory();
using ( IDbConnection con = dbf.CreateConnection() )
{
    string sSQL;
    // 12/04/2006 Paul.  Only include active users. 
    sSQL = "select top 20                "         + ControlChars.CrLf
         + " DATE_ENTERED, CLIENT_CLAIM_NUM, PRIMARY_INSURED, PRIMARY_CLAIMANT, LOB_ID, BRANCH_NAME," + ControlChars.CrLf
         + " OWNERS_FIRST_NAME, OWNERS_LAST_NAME, OWNERS_NAME, OWNERS_EMAIL, OWNERS_OFFICE_PHONE, OWNERS_FAX_PHONE" + ControlChars.CrLf
         + "  from vwFILES_DetailViewWithOwners" + ControlChars.CrLf
         + " where 1 = 1                   " + ControlChars.CrLf;
    using ( IDbCommand cmd = con.CreateCommand() )
    {
        cmd.CommandText = sSQL;

        using ( DbDataAdapter da = dbf.CreateDataAdapter() )
        {
            ((IDbDataAdapter)da).SelectCommand = cmd;
            using ( DataTable dt = new DataTable() )
            {
                da.Fill(dt);
                vwMain = dt.DefaultView;
                GridView1.DataSource = vwMain;
                if ( !IsPostBack )
                {

                    GridView1.DataBind();
                }
            }
        }
    }
} 
```

我可以简单地在我的代码中创建新字段，这样我就可以这样称呼它：

```
<asp:TemplateField HeaderText="Branch">
    <ItemTemplate>
       <asp:HyperLink ID="BRANCH_NAME" 
            runat="server" 
            NavigateUrl='<%# "mailto:"+Eval("OWNERS_EMAIL") %>' 
            Text='<%# Eval("BRANCH_NAME") %>' 
            ToolTip='<%# Eval("MY_CALCULATED_FIELD") %>'> 
       </asp:HyperLink>
    </ItemTemplate>
</asp:TemplateField> 
```

谢谢你的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T21:04:23.957

您可以在 C# 代码中创建一个函数来格式化数据。MSDN上的这篇文章谈到了它：http: [//msdn.microsoft.com/en-us/library/bb288032.aspx#aspnett12ustmpfldsvb_topic5](http://msdn.microsoft.com/en-us/library/bb288032.aspx#aspnett12ustmpfldsvb_topic5)

总而言之，您可以像这样更改您的项目模板：

```
<ItemTemplate>
    <asp:HyperLink ID="BRANCH_NAME" runat="server" 
          NavigateUrl='<%# "mailto:"+Eval("OWNERS_EMAIL") %>' 
          Text='<%# Eval("BRANCH_NAME") %>' 
          ToolTip='<%# GetBranchAddress(CType(Container.DataItem, System.Data.DataRowView).Row) %> '> 
    </asp:HyperLink>
</ItemTemplate> 
```

在你的 c# 中，创建一个这样的函数：

```
protected string GetBranchAddress(DataRow row)
{
    return "<span style=\"text-decoration:underline;\">"+ 
               row["BRANCH_NAME"].ToString().Trim() + "</span><br />" + 
               row["OWNERS_FIRST_NAME"].ToString().Trim() + " " +
               row["OWNERS_LAST_NAME"].ToString().Trim() + "<br />" + 
               row["OWNERS_EMAIL"].ToString().Trim() + "<br />" + 
               row["OWNERS_OFFICE_PHONE"].ToString().Trim() + "<br />" + 
               row["OWNERS_FAX_PHONE"].ToString().Trim();

} 
```

这种方法也很好，因为您可以在 c# 函数中设置断点并添加错误处理等。

# grid - 改编自 Kendo UI 音乐商店的示例不起作用

> ID：14780685
> 
> 赞同：0
> 
> 时间：2013-02-08T20:19:14.477
> 
> 标签：grid, kendo-ui

我是 stackoverflow 的新手，Kendo UI 的新手和 Web 开发的新手……我是昨天出生的 :)。开玩笑说我的问题并不是真正的问题，我知道论坛对特定问题的规定，但我需要帮助。

我的问题是这样的：

我改编了 Kendo UI MVC 音乐商店教程，但使用 MVC ASP.net（我与 Delphi 合作）并且它不起作用。

我有两个文件：

**类别.html**

```
 <!DOCTYPE html>
   <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es">
     <head>
       <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

       <title>Administración de Categorías</title>

       <link href="kendo/styles/kendo.common.min.css" rel="stylesheet" type="text/css" />
       <link href="kendo/styles/kendo.default.min.css" rel="stylesheet" type="text/css" />

       <link rel="stylesheet" href="css/menuvir.css" type="text/css"/>

       <script src="kendo/js/jquery.min.js" type="text/javascript"></script>
       <script src="kendo/js/kendo.web.min.js" type="text/javascript"></script>

     </head>

     <body>

       <div id="categGrid"></div>

       <script src="js/category.js type="text/javascript"></script>      

     </body>
   </html> 
```

和**Category.js**

```
(function (window, $, kendo) {
  var getCategAsync = function () {
    var deferred = $.Deferred(),     
        translateCateg = function (data) {
          deferred.resolve($.map(data.result, function(item) {
            return {
              value: item.ID,
              text: item.Description
            };
          }));
        },
        loadCateg = function () {
          new kendo.data.DataSource({
            type: "json",
            transport: {
              read: "/w/Category?select=ID,Description"
            },
            schema: {
              data: 'result'/*,
                      total: store.config.wcfSchemaTotal*/
            }
          }).fetch(function (data) {
            translateCateg(data);
          });
        };
    window.setTimeout(loadCateg, 1);
    return deferred.promise();
  };
  var getLangAsync = function () {
    var deferred = $.Deferred(),

        translateLang = function (data) {
          deferred.resolve($.map(data.result, function(item) {
            return {
              value: item.ID,
              text: item.Description
            };
          }));
        },
    loadLang = function () {
      new kendo.data.DataSource({
        type: "json",
        transport: {
          read: "/w/Language?select=ID,Description"
        },
        schema: {
          data: 'result'/*,
                      total: store.config.wcfSchemaTotal*/
        }
      }).fetch(function (data) {
        translateLang(data);
      });
    };
    window.setTimeout(loadLang, 1);
    return deferred.promise();
  };
  var initGrid = function (categs, langs, categEditor, langEditor) {
    $("#categGrid").kendoGrid({
      sortable: true,
      groupable: false, //true,
      filterable: false, //true,
      pageable: true,
      editable: "inline",
      toolbar: ["create"],
      dataSource: {
        type: "json",
        pageSize: 10,
        serverPaging: false, //true,
        serverFiltering: false, //true,
        serverSorting: false, //true,
        sort: { field: "SortOrder", dir: "asc" },
          transport: {
            type: "json",
            read: {
              url: "/w/Category?select=ID,Description",
              type: "GET"
            }/*,
                update: {
                  url: function (data) {
                    return store.config.albumsUrl + "(" + data.AlbumId + ")"
                  },
                  type: "PUT"
                },
                destroy: {
                  url: function (data) {
                    return store.config.albumsUrl + "(" + data.AlbumId + ")";
                  },
                  type: "DELETE"
                },
                create: {
                  url: store.config.albumsUrl,
                  type: "POST" 
                } */
          },
          schema: {
            data: "result",
            //total: store.config.wcfSchemaTotal,
            model: {
              id: "ID",
              fields: {
                ID: { type: "number" },
                Description: { type: "string", validation: {required: true} },
                Language: { type: "number", defaultValue: 1 },
                SortOrder: { type: "number", defaultValue: 0 },
                Status: { type: "number", defaultValue: 0 },
                Parent: { type: "number", defaultValue: 0 }
              }
            }
          },
      },

          columns: [
              { field: "ID", title: "ID", editable: false, filterable: false, width: 20 },
              { field: "Description", title: "Descripción", filterable: false, width: 150 },
              { field: "Language", title: "Idioma", values: langs, editor: langEditor, filterable: false, width: 50 },
              { field: "SortOrder", title: "Orden", filterable: false, width: 20 },
              { field: "Status", title: "Estado", filterable: false, width: 50 },
              { field: "Parent", title: "Subcategoría de", values: categs, editor: categEditor, filterable: false, width: 150 },
              { command: ["edit", "destroy"], title: "&nbsp;", width: "160px" }
          ]
      });
  };
  // Wait for both the genres and artists lists to load.
  $.when(getCategAsync(), getLangAsync())
    .done(function(categs, langs) {
      var categEditor = function (container, options) {
        $('<input data-text-field="text" data-value-field="value" data-bind="value:' + options.field + '" />')
                  .appendTo(container)
                  .kendoComboBox({
                      autoBind: false,
                      dataSource: categs
                  });
          };
      var langEditor = function (container, options) {
        $('<input data-text-field="text" data-value-field="value" data-bind="value:' + options.field + '" />')
          .appendTo(container)
          .kendoComboBox({
            autoBind: false,
            dataSource: langs
          });
      };
      initGrid(categs, langs, categEditor, langEditor);
    });
})(window, jQuery, kendo); 
```

当我执行此操作时，Firebug 控制台中没有显示任何内容并且没有错误。

怎么了 ？任何帮助表示赞赏。

在此先感谢并为我的英语感到抱歉。

**更新**

抱歉，我忘记在此处更新 Category.html 代码，但我的值总是正确的“id”，但它不起作用。感谢您及时的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:26:07.237

好吧，对于初学者来说，您的 JQuery 正在尝试在您的 HTML 中不存在的 ID 上创建 KendoGrid

```
$("#categGrid").kendoGrid( 
```

与您的 HTML 中的任何内容都不匹配。你的意思

```
 $("#grid").kendoGrid({ 
```

这会发现

```
<div id="grid"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T13:20:27.383

我解决了这个问题。我更改了一些我错误地适应的选项。

这是有效的代码。

```
(function (window, $, kendo) {
  var getCategAsync = function () {
      var deferred = $.Deferred(),

          translateCateg = function (data) {
              deferred.resolve($.map(data.items, function(item) {
                  return {
                      value: item.ID,
                      text: item.Description
                  };
              }));
          },

          loadCateg = function () {
              new kendo.data.DataSource({
                  transport: {
                      read: {
                        url: "/w/Category?select=ID,Description",
                        dataType: "json",
                        type: "GET"
                      }
                  },
                  schema: {
                      data: 'result'/*,
                      total: store.config.wcfSchemaTotal*/
                  }
              }).fetch(function (data) {
                  translateCateg(data);
              });
          };

      window.setTimeout(loadCateg, 1);
      return deferred.promise();
  };

  var getLangAsync = function () {
      var deferred = $.Deferred(),

          translateLang = function (data) {
              deferred.resolve($.map(data.items, function(item) {
                  return {
                      value: item.ID,
                      text: item.Description
                  };
              }));
          },

          loadLang = function () {
              new kendo.data.DataSource({
                  transport: {                      
                      read: {
                        url: "/w/Language?select=ID,Description",
                        dataType: "json",
                        type: "GET"
                      }
                  },
                  schema: {
                      data: 'result'/*,
                      total: store.config.wcfSchemaTotal*/
                  }
              }).fetch(function (data) {
                  translateLang(data);
              });
          };

      window.setTimeout(loadLang, 1);
      return deferred.promise();
  };

  var initGrid = function (categs, langs, categEditor, langEditor) {
      $("#categGrid").kendoGrid({
          sortable: true,
          groupable: false, //true,
          filterable: false, //true,
          pageable: true,
          editable: "inline",
          toolbar: ["create"],

          dataSource: {
              type: "json",
              pageSize: 10,
              serverPaging: false, //true,
              serverFiltering: false, //true,
              serverSorting: false, //true,
              sort: { field: "SortOrder", dir: "asc" },
              transport: {                  
                  read: {
                      url: "/w/Category?select=*",
                      type: "GET",
                      dataType: "json"
                  }/*,
                  update: {
                      url: function(data) {
                        return "/w/Category?ID=" + data.ID;
                      },
                      contentType: "application/json",
                      type: "PUT"
                  },
                  destroy: {
                      url: function (data) {
                          return store.config.albumsUrl + "(" + data.AlbumId + ")";
                      },
                      type: "DELETE"
                  },
                  create: {
                      url: store.config.albumsUrl,
                      type: "POST" 
                  } */
              },
              schema: {
                  data: "result",
                  total: function(response) {
                    return response.result.length;
                  },
                  model: {
                      id: "ID",
                      fields: {
                          ID: { type: "number" },
                          Description: { type: "string", validation: {required: true} },
                          Language: { type: "number", defaultValue: 1 },
                          SortOrder: { type: "number", defaultValue: 0 },
                          Status: { type: "number", defaultValue: 0 },
                          Parent: { type: "number", defaultValue: 0 }
                      }
                  }
              },
          },

          columns: [
              { field: "ID", title: "ID", editable: false, filterable: false, width: 20 },
              { field: "Description", title: "Descripción", filterable: false, width: 150 },
              { field: "Language", title: "Idioma", values: langs, editor: langEditor, filterable: false, width: 50 },
              { field: "SortOrder", title: "Orden", filterable: false, width: 20 },
              { field: "Status", title: "Estado", filterable: false, width: 50 },
              { field: "Parent", title: "Subcategoría de", values: categs, editor: categEditor, filterable: false, width: 150 },
              { command: ["edit", "destroy"], title: "&nbsp;", width: "160px" }
          ]
      });
  };

  // Wait for both the genres and artists lists to load.
  $.when(getCategAsync(), getLangAsync())
      .done(function(categs, langs) {
          var categEditor = function (container, options) {
              $('<input data-text-field="text" data-value-field="value" data-bind="value:' + options.field + '" />')
                  .appendTo(container)
                  .kendoComboBox({
                      autoBind: false,
                      dataSource: categs
                  });
          };

          var langEditor = function (container, options) {
              $('<input data-text-field="text" data-value-field="value" data-bind="value:' + options.field + '" />')
                  .appendTo(container)
                  .kendoComboBox({
                      autoBind: false,
                      dataSource: langs
                  });
          };

          initGrid(categs, langs, categEditor, langEditor);
      });
})(window, jQuery, kendo); 
```

谢谢。

# actionscript-3 - 照片加载顺序混乱 as3

> ID：14780690
> 
> 赞同：1
> 
> 时间：2013-02-08T20:19:42.583
> 
> 标签：actionscript-3, flash, loader

我创建了一个容器（或影片剪辑），它将按顺序添加照片并显示在舞台上。但是，由于文件大小不同，它会先添加最小文件大小的照片。我该如何解决这个问题。请看下面的示例代码

```
// image0.jpg -> 3k
// image1.jpg -> 2k
// image2.jpg -> 1k
// image3.jpg -> 2k
// image5.jpg -> 1k

var photoPath:Array = new Array();
var photoContainer:MovieClip = new MovieClip();

photoPath.push('image0.jpg');
photoPath.push('image1.jpg');
photoPath.push('image2.jpg');
photoPath.push('image3.jpg');
photoPath.push('image4.jpg');

for(var i = 0; i < photoPath.length; i++)
{
    var loader:Loader = new Loader();
    loader.load(URLRequest(photoPath[i]));
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, photoLoaded);
}

function photoLoaded(e:Event):void
{
    photoContainer.addChild(e.target.content);
}

//output will looks like (image2,image5,image1,image3,image0) instead of 0,1,2,3,4,5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:40:56.893

有很多方法可以处理这个问题，可能最简单的改造当前代码的方法是在实例化时将加载器添加到显示列表中。这将保证它们以正确的顺序放置在 photoContainer 中。如果您绝对需要位图本身而不是加载器本身在显示列表中，您可以在您的 photoLoaded 方法中解决这个问题：

```
import flash.display.Loader;

var photoPath:Array = new Array();
var photoContainer:MovieClip = new MovieClip();

photoPath.push('image0.jpg');
photoPath.push('image1.jpg');
photoPath.push('image2.jpg');
photoPath.push('image3.jpg');
photoPath.push('image4.jpg');

for(var i = 0; i < photoPath.length; i++)
{
    var loader:Loader = new Loader();
    photoContainer.addChild(loader);  //add the loader to photoContainer
    loader.load(new URLRequest(photoPath[i]));
    //you only actually have to listen for complete below if you want to replace the loader with its contents 
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, photoLoaded);
}

function photoLoaded(e:Event):void
{
    var loader:Loader = e.target.loader;
    var index:int = photoContainer.getChildIndex(loader);
    // this will add the contents of the loader in the same order the loader was originally added
    photoContainer.addChildAt(loader.content, index);
    photoContainer.removeChild(loader);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:48:31.007

只需按照数组中给定的顺序加载照片并将其添加到容器中：

```
var photoPath:Array = new Array();
var photoContainer:MovieClip = new MovieClip();
var i:int = 0;

photoPath.push('image0.jpg');
photoPath.push('image1.jpg');
photoPath.push('image2.jpg');
photoPath.push('image3.jpg');
photoPath.push('image4.jpg');

loadPhoto(i);

function loadPhoto(i:int):void
{
    var loader:Loader = new Loader();
    loader.load(new URLRequest(photoPath[i]));
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, photoLoaded);
}

function photoLoaded(e:Event):void
{
    photoContainer.addChild(e.target.content);
    trace(e.target.url); // Verify
    if(i<photoPath.length-1) loadPhoto(++i);
} 
```

输出：

```
image0.jpg
image1.jpg
image2.jpg
image3.jpg
image4.jpg 
```

# python - Python：用零填充浮点数

> ID：14780692
> 
> 赞同：1
> 
> 时间：2013-02-08T20:19:53.900
> 
> 标签：python

如何用零填充双数到指定长度？

```
printf "{:.3}".format(0.12) # Doesn't pad 
```

我想得到

```
0.120 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T20:22:35.493

你需要一个`f`after `3`：

```
In [19]: "{:.3f}".format(0.12)
Out[19]: '0.120' 
```

如果你没有指定任何类型的浮点数，那么它`'g'`默认使用。

```
In [27]: "{:.20}".format(0.12)
Out[27]: '0.11999999999999999556'

In [28]: "{:.20g}".format(0.12)
Out[28]: '0.11999999999999999556' 
```

文档[在这里](http://docs.python.org/2/library/string.html#formatspec)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:23:26.590

您可以使用格式字符串来完成

```
print('%.3f' % 0.12) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:26:42.247

您缺少[类型说明符](http://docs.python.org/2/library/stdtypes.html#string-formatting)：

```
>>> print "{:.3f}".format(0.12)
0.120 
```

# algorithm - 什么是最简单（和正确）的转义算法？

> ID：14780699
> 
> 赞同：8
> 
> 时间：2013-02-08T20:20:29.880
> 
> 标签：algorithm, escaping

免责声明：这是一个理论问题，目的是增加我的理解。我知道我总是可以使用 JSON 库之类的工具来解决问题。

假设我想创建一个逗号分隔的值列表，这些值本身可能包含逗号。这些逗号需要首先转义。假设我`.`用作转义字符，则`["a", "b,c"]`变为`a,b.,c`.

但是，如果其中一个值最初包含一个`.,`序列，那么我们需要在转义逗号*之前转义这些值。*就这样`[ "a", "b.,c" ]`变成了`a,b..,c`。

但是，如果其中一个值最初包含一个`..,`序列，那么我们需要在转义逗号*之前转义这些值。*就这样`[ "a", "b..,c" ]`变成了`a,b...,c`。

但是，如果其中一个值最初包含一个`...,`序列，那么我们需要在转义逗号*之前转义这些值。*就这样`[ "a", "b...,c" ]`变成了`a,b....,c`。

ETC...

解码过程必须执行反向递归。

但是，我怀疑我是否太难了，并且有一种更简单的方法。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T21:38:01.263

感谢@mkbeckish 的评论，我意识到该算法可以实现为：

```
// encoding
text.replace(escape, escape + escape);
text.replace(delim , escape + delim);

// decoding
text.replace(escape + delim , delim);
text.replace(escape + escape, escape); 
```

[示例实现。](http://stacked-crooked.com/view?id=918b9a31ca244fccc1bc19f92f7911bd)

很愚蠢，我自己没有意识到这一点..

# php - PHP 和 MySQL，查询在一个而不是另一个中工作

> ID：14780701
> 
> 赞同：-2
> 
> 时间：2013-02-08T20:20:32.437
> 
> 标签：php, mysql, mysqli

我有一个在 phpMyAdmin 中有效的查询，但在通过 php 运行时无效

这是查询：

```
DELETE FROM 'table' WHERE 'id' NOT IN ( SELECT DISTINCT id FROM ( SELECT * FROM 'table' ORDER BY scoreDESC LIMIT 10 ) foo) 
```

基本上，它对表格进行排序以降序得分，然后保留前 10 名并删除其余的。我可以通过 phpmyadmin 运行这个很好的槽，但我的 php 代码说不

这是 php 脚本：

```
function add_highscore()
{

    mysql_query("DELETE FROM highscores WHERE id NOT IN ( SELECT DISTINCT id FROM ( SELECT * FROM highscores ORDER BY score DESC LIMIT 10 ) foo)")
    or die('0');

    echo "1";

    mysql_close($table_id);
} 
```

连接没有问题，我在有效的脚本中有更多功能。

有任何想法吗？非常感谢您的帮助！

干杯，乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:27:01.310

可能是函数没有被调用或连接没有建立。你应该尝试 mysql_error 来捕获错误或使用 try catch 来捕获错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:30:28.570

试试这个：

```
<?PHP
function add_highscore()
{
    $link = mysqli_connect($host, $user, $password, $database);
    $query = "DELETE FROM highscores WHERE id NOT IN ( SELECT DISTINCT (id) FROM ( SELECT * FROM highscores ORDER BY score DESC LIMIT 10 ) foo)";
    mysqli_query($link, $query)    or die('0');

    echo "1";

    mysqli_close($table_id);
}
?> 
```

MYSQL版本

```
<?PHP
function add_highscore()
{

    $link = mysql_connect($server, $username, $password);
    mysql_select_db($database_name, $link);

    $query = "DELETE FROM highscores WHERE id NOT IN ( SELECT DISTINCT(id) FROM ( SELECT * FROM highscores ORDER BY score DESC LIMIT 10 ) foo)";
    return mysql_query($query)   or die('0');

    echo "1";

    mysql_close($link);
}

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:38:19.637

我建议你使用 ORM 库，它更容易处理查询并且更安全

例如：[红豆](http://redbeanphp.com/)

或 [在本站搜索](https://stackoverflow.com/questions/108699/good-php-orm-library)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:44:25.183

将此添加到脚本的顶部：

```
error_reporting(E_ALL); 
```

并替换：

```
die('0'); 
```

和：

```
die(mysql_error()); 
```

这应该有助于表明脚本的“不工作”种类。

# python - 如何使用 python 读取和写入表/矩阵到文件？

> ID：14780702
> 
> 赞同：4
> 
> 时间：2013-02-08T20:20:36.240
> 
> 标签：python, matrix, file-io, tabular

我正在尝试创建一个程序，该程序获取数据并将其放入文本文件中仅包含数字的 2 x 10 表中。然后程序需要在以后的迭代中检索这些信息。但我不知道该怎么做。我一直在研究 numty 命令、常规文件命令以及尝试制作表格的方法。但我似乎无法让这些工作。

这是我正在尝试制作的表格的示例：

```
0    1    1    1    0    9    6    5
5    2    7    2    1    1    1    0 
```

然后我会检索这些值。有什么好方法可以做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T21:06:52.460

为什么不使用`csv`模块？

```
table = [[1,2,3],[4,5,6]]

import csv

# write it
with open('test_file.csv', 'w') as csvfile:
    writer = csv.writer(csvfile)
    [writer.writerow(r) for r in table]

# read it
with open('test_file.csv', 'r') as csvfile:
    reader = csv.reader(csvfile)
    table = [[int(e) for e in r] for r in reader] 
```

这种方法还有一个额外的好处，就是使文件可以被其他程序（如 Excel）读取。

哎呀，如果您真的需要空格或制表符分隔，只需添加`delimiter="\t"`到您的阅读器和编写器结构即可。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T21:03:34.973

`numpy`应该够了

```
table = np.loadtxt(filename) 
```

这将具有形状（2,10）。如果你想要它转置，只需`.T`在右括号后添加一个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:24:13.270

一个接一个地处理这些行：

```
with open('filename') as f:
   for ln in f:
       a = [int(x) for x in ln.split()] 
```

或者，生成一个二维数组：

```
with open('filename') as f:
   a = [[int(x) for x in ln.split()] for ln in f] 
```

感谢 Ord 和 Francesco Montesano 的评论

# php - 用 preg_replace 替换所有出现的文本组

> ID：14780704
> 
> 赞同：0
> 
> 时间：2013-02-08T20:20:39.260
> 
> 标签：php, regex, preg-replace

我在一个字符串中有一些（HTML）文本，并且在该文本中有几次出现这个 "Group" `<br><hr/><br>`。简单的正则表达式`(<br><hr\/><br>)`找到第**一次**出现。我正在寻找的是一种使用 preg_replace用另一个文本替换*所有出现的方法。*

当我使用 preg_replace 的正则表达式时，我只得到一个空字符串 - 我的日志文件中没有错误。

这个 preg_replace 对我有用：`preg_replace('@(<br><hr\/><br>)@', ' *POST* ', $string);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:25:05.280

测试一下

```
 $output=preg_replace_callback("#<br><hr\/><br>#",function($matches){print_r($matches[0]."\n");return 'replace Text';},' '.$str.' '); 
```

# java - 如何以最佳方式在 Wicket 中使用 DropDownChoice 和 ChoiceRenderer 来处理显示和 ID 值？

> ID：14780705
> 
> 赞同：0
> 
> 时间：2013-02-08T20:20:41.183
> 
> 标签：java, wicket

我正在尝试使用 Wicket 在表单中创建一个简单的下拉选择框，但被 Wicket 抛出的异常所困扰。如下：

**最后一个原因：没有为类定义get方法：类java.lang.Long表达式：id**

当我继续检查代码和 Wicket 文档时，我根本无法弄清楚我做错了什么，并且可以利用 Stackoverflow 和 Wicket 社区的帮助。以下是一些相关的代码片段......首先，我的表单使用了 CompoundPropertyModel：

```
add(jobForm);

// Unrelated fields snipped, see 'employmentTypeId':
jobForm.setModel(new CompoundPropertyModel<Job>(jobModel));
jobForm.add(new DropDownChoice("employmentTypeId", new List<GenericPickList>, new ChoiceRenderer<GenericPickList>("description", "id"))); 
```

DropDownChoice中的参数解释：#1，组件的wicket:id，#2，在实际实现中，这是一个GenericPickList（即List）的全填充List集合，#3，我的ChoiceRenderer标识描述字段作为显示值和作为 ID 的 id 值，均来自 GenericPickList 类。

GenericPickList 类很简单：

```
public class GenericPickList {

    private long id;
    private String description;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

} 
```

该错误表明 ChoiceRenderer 没有在 GenericPickList 中找到 id 字段的 getter，但它就在那里，所以我相信我的假设是不正确的。任何人都可以对此提供任何见解吗？

作为补充说明（和令人沮丧的一点），从 ChoiceRenderer 构造函数中删除“id”似乎可以正常工作：

```
new ChoiceRenderer<GenericPickList>("description"); 
```

当然，由于这些是与主键关联的数据驱动值，因此出于我的目的需要包含 ID 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:36:53.463

当您使用“id”时，您实际上是在告诉检票口在您的模型中查找属性 id，并且它看起来不像任何就业类型 ID 类型的模型都具有属性 id。

[Wicket 选择渲染器文档](https://ci.apache.org/projects/wicket/apidocs/1.5.x/org/apache/wicket/markup/html/form/ChoiceRenderer.html)

# ios - UItextView 禁用选择选项

> ID：14780714
> 
> 赞同：0
> 
> 时间：2013-02-08T20:21:35.020
> 
> 标签：ios

我有一个 UItextView 使用我分配了一些手势的代码创建。UItextView 不应该是可编辑的，我还想删除通过按住它来选择文本的可能性，包括显示的菜单剪切/粘贴。我在整个互联网上发现：

```
- (BOOL)canBecomeFirstResponder {
return NO;
} 
```

我将此代码插入到我的文件中，并设置 text.delegate = self. 我什至在 .h 文件中包含了 UItextViewDelegate 我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:23:59.500

您应该修改`editable`.`UITextView`

要禁用复制粘贴，最简单的方法是继承 UITextView，并`canPerformAction:withSender:`像这样实现：

```
@interface MyTextView : UITextView @end

@implementation MyTextView

- (BOOL)canPerformAction:(SEL)action withSender:(id)sender
{
    return NO;
}

@end 
```

如果您使用 XIB 或 Storyboard 来布局 UI，请确保为文本视图提供正确的类。

# backbone.js - Backgrid 无法呈现列

> ID：14780715
> 
> 赞同：1
> 
> 时间：2013-02-08T20:21:36.517
> 
> 标签：backbone.js, backgrid

我只是在学习 backgrid.js 的基础知识。因此，当我尝试在主页[Backgrid.js](http://wyuenho.github.com/backgrid/)上复制代码时，由于在为列传递对象数组时出现特定错误，我无法呈现网格。我相信我使用了正确的格式

```
 var columns = [
    { name: "name", label: "Name", cell: "string" },
    { name: "address", label: "Address", cell: "string" },
    { name: "tel", label: "Phone", cell: "integer" },
    { name: "email", label: "Email", cell: "string" },
    { name: "type", label: "Contact Type", cell: "string" }
]; 
```

在这一步初始化网格的过程中出现*Uncaught TypeError: Object [object Object] has no method 'listenTo'的错误：*

```
 var grid = new Backgrid.Grid({
        columns: columns,
        collection: this.collection
    }); 
```

我如何初始化网格有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T14:20:43.343

问题出在我使用的backbone.js 版本上。我建议使用正确版本的库。

> Backgrid.js 依赖于 3 个库来运行：
> 
> jquery >= 1.7.0, underscore.js ~ 1.4.0, 和bone.js ~ 0.9.10。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T21:32:46.720

这是一个关于如何使用它的简单结构。

HTML

```
<div id="container"></div> 
```

JS

```
$(function(){
    /** Columns definition */
    var columns = [
    { name: "name", label: "Name", cell: "string" },
    { name: "address", label: "Address", cell: "string" },
    { name: "tel", label: "Phone", cell: "integer" },
    { name: "email", label: "Email", cell: "string" },
    { name: "type", label: "Contact Type", cell: "string" }
    ];

    /** Model instance */
    var mdl = Backbone.Model.extend({});

    /** Collection instance */
    var col = Backbone.Collection.extend({
        model: mdl  
    });

    /** Test array of JSON (usually coming from a server) */
    var json = [
        {"name": "Goose", "address": "a 1st address", "tel": 25500100, "email": "w@test.net","type": 1},
        {"name": "Ducky", "address": "a 2nd address", "tel": 25500123, "email": "w@test1.net","type": 2}
   ];

   /** Create the Grid */
   var grid = new Backgrid.Grid({
      columns: columns,
      collection: new col(json)
   });

   /** Add the Grid to the container */
   $("#container").append(grid.render().$el);
}); 
```

# c++ - 无法使用 WinAPI 显示窗口

> ID：14780716
> 
> 赞同：0
> 
> 时间：2013-02-08T20:21:39.953
> 
> 标签：c++, windows, winapi, directx

我知道这是一个无聊的问题，我之前已经做过一百万次了，但是我无法在我编写的 WinAPI 程序中显示一个简单的窗口。它后来使用 DirectX 在窗口上绘图，但我已经调试了程序，即使在所有 DirectX 内容开始执行之前它也无法显示窗口。我只在任务栏上看到程序图标，但没有窗口。

这是处理窗口创建的一段代码。

```
WNDCLASSEX wc;
    ZeroMemory(&wc, sizeof(wc));
    wc.cbSize = sizeof(WNDCLASSEX);
    wc.style = CS_HREDRAW | CS_VREDRAW;
    wc.lpfnWndProc = (WNDPROC)WndProc;
    wc.hInstance = hInstance;
    wc.lpszClassName = title.c_str();
    wc.hCursor = LoadCursor(NULL, IDC_ARROW);
    wc.cbClsExtra = 0;
    wc.cbWndExtra = 0;
    wc.hIcon = 0;
    wc.hIconSm = 0;
    wc.hbrBackground = 0;
    wc.lpszMenuName = 0;

    if(!RegisterClassEx(&wc))
    {
        debug << "Failed to register window class." << std::endl;
        return 0;
    }

    DWORD dwStyle, dwExStyle;
    dwStyle = WS_OVERLAPPEDWINDOW | WS_VISIBLE;
    dwExStyle = WS_EX_APPWINDOW | WS_EX_WINDOWEDGE;

    AdjustWindowRectEx(&windowRect, dwStyle, FALSE, dwExStyle);

    int wwidth = windowRect.right - windowRect.left;
    int wheight = windowRect.bottom - windowRect.top;

    debug << "Screensize: " << wwidth << "x" << wheight << std::endl;
    debug << "Creating program window..." << std::endl;

    HWND hWnd = CreateWindowExW(dwExStyle, wc.lpszClassName, title.c_str(), dwStyle | WS_CLIPCHILDREN | WS_CLIPSIBLINGS, 0, 0, wwidth, wheight, NULL, NULL, hInstance, 0); 

    if(!hWnd)
    {
        debug << "Error occured while trying to display the window.\n";
        return false;
    }

    ShowWindow(hWnd, SW_SHOW);
    UpdateWindow(hWnd); 
```

我绝望了。我开始觉得我的编程环境、库等有问题。我使用的是 VS2012/Win7，以及 VS 附带的标准 c++ 编译器。

**编辑** WindowRect 在这里

```
RECT windowRect;
    windowRect.left = 0;
    windowRect.right = g_engine->getScreenWidth(); //800
    windowRect.top = 0;
    windowRect.bottom = g_engine->getScreenHeight(); //600 
```

这是 DefWindowProc

```
LRESULT CALLBACK WndProc (HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
if(msg == WM_DESTROY)
    return DefWindowProc(hWnd, msg, wParam, lParam);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:53:58.030

我遇到这个问题的大部分时间都是来自`WinProc`.

您`WinProc`可能会调用`DefWndProc`而不返回其返回值。这使得`WM_NCCREATE`被视为返回 false（而不是应该返回的 true），从而导致创建过程停止。

一个适当的windowproc应该是

```
LRESULT CALLBACK WndProc (HWND h, UINT u, WPARAM w, LPARAM l)
{
  if(...) {}
  else if(...) {}
  else if(...) {} //prematurely return if you don't want the default behavior

  return DefWndProc(h,u,w,l);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:43:53.773

你的 wndProc 看起来不对：

```
if(msg == WM_DESTROY) // <-- you should remove it and let system handle default messages 
    return DefWindowProc(hWnd, msg, wParam, lParam); 
```

# jquery-ui - 我如何仅使用代码将可拖动的内容放回可放置的位置

> ID：14780717
> 
> 赞同：0
> 
> 时间：2013-02-08T20:21:43.637
> 
> 标签：jquery-ui, drag-and-drop

我的应用程序的基本概念是将一组托盘映射到卡车上。我有一个页面，允许用户拖动可拖动的 div“托盘”并将其放置在卡车上的可放置 div“插槽”中。每行、左右列的重量和卡车总重量都是即时计算的。然后，我将所有信息传递到一个页面以打印托盘和槽位表，以便操作员可以装载卡车。如果用户只装载了一半的卡车然后想稍后再回来完成，那么问题就在于恢复负载。我知道如何保存任意数量的数据点，但是当我重建页面时，我找不到将“托盘”放回其“插槽”的方法。

这是托盘的 div，一些插槽和放置过程（我不确定还需要什么）

```
 //load the playpen with the pallets that belong on this truck
  for (var i = 0; i < noPallets; i++) {
      $('<div id="' + PalletIDs[i] + '">' + PalletIDs[i] + '<br>' + Storage[i] + ':' + Weights[i] + '</div>').data('pallet', 
      { ID: PalletIDs[i], Weight: Weights[i], columnNo: 0, rowNo: 0, tierNo:0 }).appendTo('#playpen').draggable({
      containment: '#content',
      stack: '#playpen div',
      cursor: 'move',
      start: handlePalletStart,
      revert: true
  });
  }
  // Create the pallet slots for truck left
   var words = ['C<br>one', 'C<br>two', 'C<br>three', 'C<br>four', 'C<br>five', 'C<br>six', 'C<br>seven', 'C<br>eight', 'C<br>nine', 'C<br>ten', 'C<br>eleven'];
   for (var i = 1; i <= 11; i++) {
     position = 1000 + (i * 10) + 3
       $('<div id="' + position + '">' + words[i - 1] + '</div>').data('position', { columnNo: 1, rowNo: i, tierNo: 3 }).appendTo('#truckleftC').droppable({
           accept: '#playpen div',
           hoverClass: 'hovered',
           drop: handlePalletDrop
       });
   }

    function handlePalletDrop(event, ui) {
    // this is the truck location we are about to drop into

  var columnNo = $(this).data('position').columnNo;
  var rowNo = $(this).data('position').rowNo;
  var tierNo = $(this).data('position').tierNo;
  // this is pallet information
  var palletID = ui.draggable.data('pallet').ID;
  var weight = ui.draggable.data('pallet').Weight;
  // if the pallet was already in a positio, we need to zero that position
  if (ui.draggable.data('pallet').columnNo != 0) {
      oldposition = ui.draggable.data('pallet').columnNo * 1000 + ui.draggable.data('pallet').rowNo * 10 + ui.draggable.data('pallet').tierNo;
      //          alert(oldposition);
    for (var h = 0; h <= 65; h++) {
        if (aryTWeight[h][0] == oldposition) {
            aryTWeight[h][1] = 0;
        }
    }
  }

  // set the position in the truck for this pallet
  ui.draggable.data('pallet').columnNo = columnNo;
  ui.draggable.data('pallet').rowNo = rowNo;
  ui.draggable.data('pallet').tierNo = tierNo;
  // set the weight for this position in the truck
  position = columnNo * 1000 + rowNo * 10 + tierNo
 //      alert(position);
  for (var h = 0; h <= 65; h++) {
      if (aryTWeight[h][0] == position) {
          aryTWeight[h][1] = weight;
     }
  }
 //     alert(columnNo + ' : ' + rowNo + ' : ' + tierNo);

  // set the hidden text box with the palletid so data can be posted to next page
  for (var i = 0; i < document.forms[0].elements.length; i++) {
      element = document.forms[0].elements[i];
      if (element.name == oldposition) {
          element.value = 0;
      };
      if (element.name == position) {
          element.value = palletID;
      };
  }
  // set all of the weights for rows, columns and totals
  calcWeights();

  ui.draggable.addClass('correct');
  ui.draggable.position({ of: $(this), my: 'left top', at: 'left top' });
  ui.draggable.draggable('option', 'revert', false); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:38:39.330

您可以存储已加载托盘的 x 和 y 坐标，然后在重建页面时设置调色板的 css 位置：absolute; 并将 top 和 left 设置为存储的 x 和 y。并以编程方式将它们附加到可放置的 div 中。

这完全取决于您的插槽是如何工作的，如果您有很多可放置对象并且每个可放置对象只能包含一个可拖动对象，那么只需存储这些对并在重建页面时使用 jquery 将可拖动对象附加到可放置对象。

```
var html = '<div id="myDraggableDiv"></div>'

$('#' + droppableId).append(html); 
```

如果您需要任何特殊的 css，例如精确的顶部和左侧，请在创建元素后将其添加到样式属性或 jquery 中。

# javascript - 如何在包含 HTML 的 contentEditable 中获取光标位置？

> ID：14780724
> 
> 赞同：0
> 
> 时间：2013-02-08T20:22:12.237
> 
> 标签：javascript, contenteditable, cursor-position

我需要在 contentEditable div 中获取光标位置。我从[Get a range's start and end offset's relative's relative to its parent container](https://stackoverflow.com/questions/4811822/get-a-ranges-start-and-end-offsets-relative-to-its-parent-container/4812022#4812022)和[https://stackoverflow.com/a/4770562/2008261](https://stackoverflow.com/a/4770562/2008261)中获得了一些有用的功能。

但是这些功能没有帮助，因为我需要 HTML 中的实际位置，这就是我需要的。

如果我有：

```
<div id="diva" contenteditable="true">Insert <b>text here</b></div> 
```

我将光标放在“文本”一词之前，它在处理文本时返回 7。但我需要它返回 10 ，就好像它处理 contentEditabe div 的内部 HTML 一样。

这些是我之前提到的功能：

```
function getCaretCharacterOffsetWithin(element) {
var caretOffset = 0;
if (typeof window.getSelection != "undefined") {
    var range = window.getSelection().getRangeAt(0);
    var preCaretRange = range.cloneRange();
    preCaretRange.selectNodeContents(element);
    preCaretRange.setEnd(range.endContainer, range.endOffset);
    caretOffset = preCaretRange.toString().length;
} else if (typeof document.selection != "undefined" && document.selection.type != "Control") {
    var textRange = document.selection.createRange();
    var preCaretTextRange = document.body.createTextRange();
    preCaretTextRange.moveToElementText(element);
    preCaretTextRange.setEndPoint("EndToEnd", textRange);
    caretOffset = preCaretTextRange.text.length;
}
return caretOffset;
} 
```

和 ：

```
function getCharacterOffsetWithin(range, node) {
var treeWalker = document.createTreeWalker(
    node,
    NodeFilter.SHOW_TEXT,
    function(node) {
        var nodeRange = document.createRange();
        nodeRange.selectNode(node);
        return nodeRange.compareBoundaryPoints(Range.END_TO_END, range) < 1 ?
            NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
    },
    false
);

var charCount = 0;
while (treeWalker.nextNode()) {
    charCount += treeWalker.currentNode.length;
}
if (range.startContainer.nodeType == 3) {
    charCount += range.startOffset;
}
return charCount;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:40:41.990

之前必须解决这个问题（我创建了一个基于 Web 的文字处理器）：唯一可行的解​​决方案是遍历 DOM 树并计算 innerHTML 和 outerHTML 长度，然后使用范围内的偏移量（如果有的话）。

我也强烈反对使用 contentEditable 实现，你将花费更多的时间来尝试修复它们的问题并尝试覆盖它们的行为，而不是编写你真正想要的功能。

我的实现是一个函数，它采用范围偏移并向上走，直到它到达指定的边界父级。有些事情要记住，以前的兄弟姐妹很容易添加，但是包装父母在属性等方面很棘手，以考虑长度。

我的计算是取一个节点的整个长度`"<div id="" class="" foo="bar">sometext</div>"`，减去 的长度`innerHTML`，减去 的长度，`tagname`得到`subtract 3`长度`<div id="" class="" foo="bar">`

但是，除非您控制了该 HTML 的创建，否则您的计数仍然可能是错误的，因为在测试长度时，取决于浏览器，一行中的多个空格会以 1 个字符或多个字符的形式返回。

# mysql - 如何为此内容设置 MySQL 表可编辑

> ID：14780726
> 
> 赞同：0
> 
> 时间：2013-02-08T20:22:14.417
> 
> 标签：mysql, contenteditable

我相信我已经正确设置了数据库，因为网页没有返回该错误，但我不知道如何在数据库中创建表，因此此代码可以保存到数据库然后检索它。

```
 <script>
    $(document).ready(function() {

        $("#save").click(function (e) {         
            var content = $('#editable').html();    

            $.ajax({
                url: 'save.php',
                type: 'POST',
                data: {
                content: content
                },              
                success:function (data) {

                    if (data == '1')
                    {
                        $("#status")
                        .addClass("success")
                        .html("Data saved successfully")
                        .fadeIn('fast')
                        .delay(3000)
                        .fadeOut('slow');   
                    }
                    else
                    {
                        $("#status")
                        .addClass("error")
                        .html("An error occured, the data could not be saved")
                        .fadeIn('fast')
                        .delay(3000)
                        .fadeOut('slow');   
                    }
                }
            });   

        });

        $("#editable").click(function (e) {
            $("#save").show();
            e.stopPropagation();
        });

        $(document).click(function() {
            $("#save").hide();  
        });

    });

</script>
</head>
<body>
    <div id="wrap">
        <h1><a href="http://gazpo.com/2011/09/contenteditable/" > HTML5 Inline text editing and saving </a></h1>

        <h4>The demo to edit the data with html5 <i>contentEditable</i>, and saving the changes to database with PHP and jQuery.</h4>

        <div id="status"></div>

        <div id="content">

        <div id="editable" contentEditable="true">
        <?php
            //get data from database.
            include("db.php");
            $sql = mysql_query("select text from content where element_id='1'");
            $row = mysql_fetch_array($sql);         
            echo $row['text'];
        ?>      
        </div>  

        <button id="save">Save</button>
        </div>

        <div id="footer">
        <a href="http://gazpo.com/">Tutorial by gazpo.com</a> 
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:14:26.070

不与上面评论的人争论本教程的用处，但如果你想创建必要的表来完成这个，你可以发出以下两个 SQL 语句：

```
CREATE TABLE content ( element_id varchar(1), text text);
INSERT INTO content (element_id, text) VALUES ('1','Hello World!'); 
```

但是，此表对其他任何事情都没有多大用处。

嗯，哪个数据库？我想您首先必须创建一个，但数据库的名称（以及连接到它所需的用户/密码）在代码片段中不可见。我猜他们隐藏在某个地方`db.php`。如果您使用的正是从教程中下载的示例，请在上述语句之前发出以下语句：

```
CREATE DATABASE test;
use test 
```

（哦，本教程假设您可以使用`root`没有密码的帐户登录 - 如果您以这种方式设置了 mySQL DB，我希望您的开发服务器上运行了防火墙。）

# javascript - 在新窗口中打开位于 iframe 中的外部网站的链接

> ID：14780734
> 
> 赞同：0
> 
> 时间：2013-02-08T20:22:38.903
> 
> 标签：javascript, html, iframe

我有一个网站，其中一个页面上有一个 iframe，它指向一个外部 URL（我无法控制）。我正在尝试找到一种方法让 iframe 中的所有链接（不是整个页面）在新窗口中打开。我已经尝试了几个没有运气的解决方案。有没有办法可以定位 iframe 并使用 HTML 基本标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:25:24.110

由于同源策略，如果域和协议匹配，您只能修改 iframe 的内容。

# breeze - 查询失败，error.message 是数据

> ID：14780735
> 
> 赞同：5
> 
> 时间：2013-02-08T20:22:52.573
> 
> 标签：breeze

朋友的查询失败了。幸运的是，他在他的失败回调中发现了它（你确实为每个服务器调用都有一个失败回调，对吧？）。这是他所拥有的：

```
var getPersons = 函数（personsObservable）{
    return EntityQuery.from('Person')
           .using(manager).execute()
           .then(querySucceeded).fail(queryFailed);
}
函数查询失败（错误）{
    var msg = '获取数据时出错。' + 错误消息；
    日志错误（消息，错误）；
    抛出错误；
}

```

简单地显示`error.message`了 JSON 数据......看起来有点像这样：

```
"[{"$id":"1","$type":"Person, ProjectName","Id":12,"FirstName":"Bob","LastName":"Smith","Email":" bs@contoso.com","博客":"http://bs.contoso.com","Twitter": ..." 

```

**笏？** 他检查了`error.XHR`提供用于此查询的完整 AJAX XHR 对象的 。他可以看到 HTTP 状态码是 200 ......这意味着服务器上的一切都很酷。他拥有真实数据的事实几乎说明了同样的事情。

那么微风为什么会失败呢？他如何诊断问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T20:22:52.573

微风*可能*会失败。但问题很可能出在其他地方。通常如果 Breeze 失败，会有一个有意义的错误消息。此错误消息没有意义。但它确实提供了线索。

## 首先检查您的成功回调

可以调用失败回调 (1) 如果**操作失败**或 (2) 如果**成功回调失败**。如果操作失败，您将遇到与 Breeze 相关的问题。如果成功回调失败，您可能遇到了应用程序代码问题。

要确定哪个，在成功回调的第一行放置一个断点（在他的例子中，第一行`querySucceeded`）。如果你到达断点，你就知道 Breeze 已经完成了它的工作并且已经交给你了。逐步检查您的回调，找出最有可能是您的错误，因此很容易修复。

## 检查您的自定义 EntityType 构造函数和初始化程序

在他的情况下，它没有到达成功回调。所以当 Breeze 试图从服务器的 JSON 数据中创建缓存的实体时出现了问题。那会是什么？

有很多潜在的原因。可能是微风错误。但是，始终最好首先消除飞行员的错误。您是否为此编写了[自定义构造函数或初始化](http://www.breezejs.com/documentation/extending-entities)`EntityType`程序？

他做到了。他有一个初始化器，可以将`fullName`计算属性添加到他的`Person`. 它看起来像这样：

```
metadataStore.registerEntityTypeCtor('Person', null, personInitializer);

函数personInitializer（人）{
    person.fullName = ko.computed(function () {
        返回 entity.firstName() + ' ' + person.lastName();
    });
}

```

他没有看到问题。但是按照诊断程序，他**在初始化程序上放置了一个断点**。

果然……他打错字了……

```
// “实体”不存在。空对象错误
返回 entity.firstName() + ' ' + person.lastName();

```

他一改成`entity`，`person`一切都好。

我目前无法解释为什么 null 对象引用在消息中`fail`的 JSON`Person`数据中表现为 Q 承诺错误。奇怪的事情发生在 JavaScript 中。但线索在那里：

*   服务器传递数据
*   在到达成功回调之前失败
*   数据是关于`Person`
*   有一个`Person`初始化器（或构造器）

阅读线索，你就会知道去哪里找。

希望这个提示可以使您免于白发和秃头。

# java - FlexTable 可见性监听器

> ID：14780736
> 
> 赞同：0
> 
> 时间：2013-02-08T20:22:53.860
> 
> 标签：java, javascript, html, gwt

我有一个控制面板，在那里我在其他 2 个面板之间进行面板切换。我想在其中一个面板中添加一个可见性侦听器：当变得不可见或从父级移除时比做某事 - 回调。

```
 parentPanel.remove(panel_1);
        parentPanel.add(panel_2); 
```

在 panel_1 内部，我想要一个回调，但也许其他人可以将他从 UI 中删除。

我应该使用它来添加回调的函数的名称是什么？- 找不到

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:43:32.003

GWT 中的每个小部件都有`onAttach()`和`onDetach()`方法。您可以覆盖它们。

# jquery - 不知道在我的 jQuery 脚本中将“.stop()”放在哪里

> ID：14780742
> 
> 赞同：2
> 
> 时间：2013-02-08T20:23:05.757
> 
> 标签：jquery

我正在用一些 jQuery 效果更新我客户的网络画廊。我已经进行了一些成功的更改，但现在我的最终脚本有问题。一切正常，但是当您开始快速单击时，动画会打破常规模式，一切都变得一团糟。我知道我需要使用 stop() 函数，但我根本无法让它 100% 正常工作。

```
$(function () { 
    $(".gallery_view_switch").toggle(function () {

        $(this).html('Switching ...');
        $(".sidebar").slideToggle('slow', function () {
            $(".single_page").animate({width: 870}, 700),
            $('img.gallery').css('margin-left', '5px'), 
            $('#top').css('margin-right', '-290px'), 
            $('.gallery_view_switch').html('Show gallery navigation');   
        });

    },function () {

        $(this).html('Switching ...');
        $('img.gallery').css('margin-left', '12px'),
        $(".single_page").animate({width: 550}, 700, function () {
            $('#top').css('margin-right', '30px'), 
            $(".sidebar").slideToggle('slow'),
            $('.gallery_view_switch').html('Hide gallery navigation');
        });
    });
}) 
```

因此，我们在这里有一个“点击”操作，带有画廊导航的侧边栏上升，内容获得额外的大小和图像的新 CSS 属性，因此画廊现在拥有更广阔的视野。

在第二次单击时，内容会获得原始大小和属性，并且侧边栏会切换回原始位置。

我在这里尝试做的是停止动画队列以进行额外的点击，并且在一切就绪并准备好之前不允许出现新的动画。

谢谢！

**编辑2：**

```
 $(function () { 

    var isExpanding = false;

    $(".gallery_view_switch").toggle(function () {

        if(!isExpanding) {           

            $(this).html('Switching ...');

            $(".sidebar").slideToggle('slow', function () {

                isExpanding = true;

                $(".single_page").animate({
                    width: 870
                }, 700),
                $('img.gallery').css('margin-left', '5px'), 
                $('#top').css('margin-right', '-290px'), 
                $('.gallery_view_switch').html('Show gallery navigation'); 

                isExpanding = false;

            });
        }
    },function () {
        if(!isExpanding) {

            $(this).html('Switching ...');
            $('img.gallery').css('margin-left', '12px'),

            $(".single_page").animate({
                width: 550
            }, 700, function () {

                isExpanding = true;

                $('#top').css('margin-right', '30px'), 
                $(".sidebar").stop().slideToggle('slow'),
                $('.gallery_view_switch').html('Hide gallery navigation');

                isExpanding = false;

            });
        }
    });

}) 
```

还有另一个编辑，仍然无法正常工作......我真的不明白我必须在这里更改什么才能使其正常工作？我尝试了这么多真/假组合，但没有成功，它像以前一样工作，有重叠。或者在某些真假组合中，它是完全锁定的，一旦展开就无法返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:26:56.210

在动画函数上使用[.stop() ：](http://api.jquery.com/stop/)

```
$(function () { 
    $(".gallery_view_switch").toggle(function () {

        $(this).html('Switching ...');
        $(".sidebar").stop().slideToggle('slow', function () {
            $(".single_page").stop().animate({width: 870}, 700),
            $('img.gallery').css('margin-left', '5px'), 
            $('#top').css('margin-right', '-290px'), 
            $('.gallery_view_switch').html('Show gallery navigation');   
        });

    },function () {

        $(this).html('Switching ...');
        $('img.gallery').css('margin-left', '12px'),
        $(".single_page").stop().animate({width: 550}, 700, function () {
            $('#top').css('margin-right', '30px'), 
            $(".sidebar").stop().slideToggle('slow'),
            $('.gallery_view_switch').html('Hide gallery navigation');
        });
    });
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:27:35.927

我会这样做以防止 Double 事件：

```
$(function () { 

var isExpanding = false;

$(".gallery_view_switch").toggle(function () {

    if(!isExpanding) {
        //stuff
        $(".sidebar").slideToggle('slow', function () {
            isExanding = true;
            //Do your stuff
            isExpanding = false;
        });
    }
},function () {
    if(!isExpanding) {
        $(".single_page").animate({width: 550}, 700, function () {
            isExanding = true;
            //Do your stuff
            isExpanding = false;
        });
    }
}); 
```

# java - 无法从我的 SQLite 数据库中删除所有行

> ID：14780744
> 
> 赞同：0
> 
> 时间：2013-02-08T20:23:19.777
> 
> 标签：java, android, sqlite

我正在从我的数据库中填充一个 alertDialog，允许用户选择一个预设的电子邮件模板。填充似乎有效，但我无法删除或编辑它，只能添加它。我想删除所有行并从头开始重新填充它，但我似乎可以删除单个条目或所有条目。

这是我的 DB Handler 类中的删除方法：

```
public void deleteAppointment() {           
    ourDatabase.delete(DATABASE_TABLETEMP, null, null);         
} 
```

这段代码我曾经尝试删除所有行，但它不存在。谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:29:10.360

你可以做：

```
Drop table tablename  
--run rebuild scripts 
```

# perl - 用 awk / gawk 组合分割线

> ID：14780745
> 
> 赞同：1
> 
> 时间：2013-02-08T20:23:22.227
> 
> 标签：perl, sed, awk, gawk

如果超过 X 个字符，系统会在日志文件中换行。我正在尝试从日志中提取各种数据，但首先我需要合并所有分割线，以便 gawk 可以将字段解析为单个记录。

例如：

```
2012/11/01 field1 field2 field3 field4 fi
eld5 field6 field7
2012/11/03 field1 field2 field3
2012/12/31 field1 field2 field3 field4 fi
eld5 field6 field7 field8 field9 field10 
field11 field12 field13
2013/01/10 field1 field2 field3
2013/01/11 field1 field2 field3 field4 
```

我想回来

```
2012/11/01 field1 field2 field3 field4 field5 field6 field7
2012/11/03 field1 field2 field3
2012/12/31 field1 field2 field3 field4 field5 field6 field7 field8 field9 field10 field11 field12 field13
2013/01/10 field1 field2 field3
2013/01/11 field1 field2 field3 field4 
```

在我的情况下，实际的最大行长度是 130。我不愿意测试该长度并用于`getline`加入下一行，以防有一个正好 130 个字符长的条目。

清理完日志文件后，我还想提取所有相关事件，其中“相关”可能涉及以下标准：

*   'foo' 位于记录中任何字段的任何位置
*   **字段2 ~ /bar| dtn** /
*   如果**field1** ~ /xyz|abc/ && **field98** == "0001"

我想知道是否需要运行两个连续的 gawk 程序，或者是否可以将所有这些程序合并为一个。

我是一个笨拙的新手，来自非 Unix

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:36:13.260

```
gawk '{ gsub( "\n", "" ); printf $0 RT }
    END { print }' RS='\n[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]' input 
```

这可以通过以下方式稍微简化：

```
gawk --re-interval '{ gsub( "\n", "" ); printf $0 RT }
    END { print }' RS='\n[0-9]{4}/[0-9]{2}/[0-9]{2}' input 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:20:26.833

这可能对您有用（GNU sed）：

```
sed -r ':a;$!N;\#\n[0-9]{4}/[0-9]{2}/[0-9]{2}#!{s/\n//;ta};P;D' file 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T00:16:19.387

```
$ awk '{printf "%s%s",($1 ~ "/" ? rs : ""),$0; rs=RS} END{print ""}' file
2012/11/01 field1 field2 field3 field4 field5 field6 field7
2012/11/03 field1 field2 field3
2012/12/31 field1 field2 field3 field4 field5 field6 field7 field8 field9 field10 field11  field12 field13
2013/01/10 field1 field2 field3
2013/01/11 field1 field2 field3 field4 
```

现在我注意到您实际上并不想只打印重新组合的记录，这是另一种方法，它更适合在重新编译的记录上进行测试（此脚本中的“s”：

```
$ awk 'NR>1 && $1~"/"{print s; s=""} {s=s $0} END{print s}' file 
```

现在有了这个结构，您可以对 s 执行测试，而不是仅仅打印 s，例如（注意第三条记录中的“foo”）：

```
$ cat file
2012/11/01 field1 field2 field3 field4 fi
eld5 field6 field7
2012/11/03 field1 field2 field3
2012/12/31 field1 field2 foo field4 fi
eld5 field6 field7 field8 field9 field10
field11 field12 field13
2013/01/10 field1 field2 field3
2013/01/11 field1 field2 field3 field4

$ awk '
function tst(rec,     flds,nf,i) {
   nf=split(rec,flds)
   if (rec ~ "foo") {
      print rec
      for (i=1;i<=nf;i++)
         print "\t",i,flds[i]
   }
}
NR>1 && $1~"/" { tst(s); s="" }
{ s=s $0 }
END { tst(s) }
' file
2012/12/31 field1 field2 foo field4 field5 field6 field7 field8 field9 field10 field11 field12 field13
         1 2012/12/31
         2 field1
         3 field2
         4 foo
         5 field4
         6 field5
         7 field6
         8 field7
         9 field8
         10 field9
         11 field10
         12 field11
         13 field12
         14 field13 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T20:45:50.183

这是一个稍微大一点的 Perl 解决方案，它还处理额外的过滤（正如您也标记了这个*perl*）：

```
root@virtualdeb:~# cat combine_and_filter.pl 
#!/usr/bin/perl -n 

if (m!^2\d{3}/\d{2}/\d{2} !){
    print $prevline if $prevline =~ m/field13/;
    $prevline = $_;
}else{
    chomp($prevline);
    $prevline .= $_
}

root@virtualdeb:~# perl combine_and_filter < /tmp/in.txt
2012/12/31 field1 field2 field3 field4 field5 field6 field7 field8 field9 field10 field11 field12 field13 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-08T20:48:41.230

这可能对您有用：

```
awk --re-interval '/^[0-9]{4}\//&&s{print s;s=""}{s=s""sprintf($0)}END{print s}' file 
```

用你的例子测试：

```
kent$  echo "2012/11/01 field1 field2 field3 field4 fi
eld5 field6 field7
2012/11/03 field1 field2 field3
2012/12/31 field1 field2 field3 field4 fi
eld5 field6 field7 field8 field9 field10 
field11 field12 field13
2013/01/10 field1 field2 field3
2013/01/11 field1 field2 field3 field4"|awk --re-interval '/^[0-9]{4}\//&&s{print s;s=""}{s=s""sprintf($0)}END{print s}'
2012/11/01 field1 field2 field3 field4 field5 field6 field7
2012/11/03 field1 field2 field3
2012/12/31 field1 field2 field3 field4 field5 field6 field7 field8 field9 field10 field11 field12 field13
2013/01/10 field1 field2 field3
2013/01/11 field1 field2 field3 field4 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-08T20:58:54.383

这是一个非常简短的脚本来完成这个。

```
sed '/^[[:digit:]]/ { :r N; /\n\([^[:digit:]]\)/ s:: \1:g; tr; } ' FILE 
```

您对这种形式感到满意吗？

# database - Enterprise Architect：一次只隐藏所有连接器的一些外键标签

> ID：14780746
> 
> 赞同：7
> 
> 时间：2013-02-08T20:23:21.870
> 
> 标签：database, database-design, enterprise-architect, database-diagramming, database-diagram

我正在使用 Enterprise Architect 9，我想在所有连接器中隐藏一些外键标签，但不是全部。

我经常使用关联连接器，当我设置外键时，它会显示一些我不想看到的标签。我只想显示数字（源和目标底部标签，但不是顶部）和中间底部标签。

我知道我可以右键单击它并选择“可见性”->“设置标签可见性”，然后禁用所有我不想要的，但我需要在每个连接器上执行此操作，并且我想默认隐藏所有其他连接器连接器也是。

我知道我可以右键单击图表，选择“属性”->“连接器”选项卡并选中“抑制所有连接器标签”选项。但它禁用了我所有的标签，这是我不想要的。

有没有办法设置默认情况下一次向所有连接器显示哪些标签？

感谢您的回答

PS我知道，已经有类似的问题，但是我的问题有点不同，那个答案还不够

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-18T16:56:27.540

我已经使用与Project->Settings->UML Types 屏幕中`<<FK>>`基类的原型链接的形状脚本对其进行了管理。`association`

如果您有这样的形状脚本：

```
shape LeftTopLabel { }

shape RightTopLabel { }

shape MiddleBottomLabel { } 
```

然后你用空脚本覆盖的标签类型将消失，其余的将保留。

请注意，这将影响项目中的所有图表。

# c# - 如何关闭嵌套在线程内的线程？

> ID：14780748
> 
> 赞同：1
> 
> 时间：2013-02-08T20:23:27.283
> 
> 标签：c#, multithreading, nested, abort

我的代码中有一个线程嵌套在另一个线程中。在我的关闭事件中，我使用`upperThread.Abort()`关闭面线。但是，我的代码被挂断了。我相信这是因为我`lowerThread()`的仍在运行。如何关闭较低（嵌套）线程以正确关闭应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-16T12:16:13.733

`Thread.Abort()`不推荐，但在极少数情况下仍可能需要。

这里有一个简单的例子：

```
var parent = new Thread(new ThreadStart(() =>
{
    Thread child = null;
    try
    {
        child = new Thread(new ThreadStart(() =>
        {
            // do stuff
        }));
        child.Start();
    }
    catch (ThreadAbortException)
    {
        if (child != null && child.IsAlive)
        {
            // Abort child when parent is aborted
            child.Abort();
        }
    }
}));
parent.Start();
parent.Abort(); 
```

[在MSDN](https://msdn.microsoft.com/en-us/library/system.threading.threadabortexception(v=vs.110).aspx)上阅读有关 ThreadAbortException 的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-19T11:21:52.447

里面的面线你可以抓住`ThreadAbortException`。它在线程中止时抛出。然后在 catch 语句中你可以中止你的内线程

# javascript - Mockjax 在同一个测试文件中两次？

> ID：14780749
> 
> 赞同：1
> 
> 时间：2013-02-08T20:23:28.247
> 
> 标签：javascript, unit-testing, qunit, mockjax

使用 Qunit 和 MockJax，我试图进行两个测试，为了便于理解，在这里进行了简化。以下两个测试之一失败，可能是因为这两个测试并行运行，因此它们没有各自绕道`$.ajax()`. （唯一的区别是每个中的 responseText。）关于调整它以便以下两个测试通过的好方法的任何想法？

```
function testAjax() {
    return $.ajax({
        type: 'POST',
        dataType: 'json', 
        url: '/fakeservice/1',
        data: {'a':'b'}
    });
}

asyncTest("testAjax 1", function () {
    $.mockjax({
        url: '/fakeservice/1',
        type: 'POST',
        dataType: 'json',
        responseText: { 'name1': 'foo' }
    });

    testAjax().then(
        function (response) {
            deepEqual(response.name1, 'foo', "no name1");
            start();
        },
        function (error) {
            ok(false, "got AJAX error");
            start(); 
        }
    );
});

asyncTest("testAjax 2", function () {
    $.mockjax({
        url: '/fakeservice/1',
        type: 'POST',
        dataType: 'json',
        responseText: { 'name1': 'bar' }
    });

    testAjax().then(
        function (response) {
            deepEqual(response.name1, "bar", "no name1");
            start();
        },
        function (error) {
            ok(false, "got AJAX error");
            start();
        }
    );
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:01:21.090

您必须`$.mockjaxClear()`在每次测试结束时调用（例如在`teardown()`您的模块的方法中）。这会破坏模拟并为下一次测试准备环境。

```
function testAjax() {
    return $.ajax({
        type: 'POST',
        dataType: 'json', 
        url: '/fakeservice/1',
        data: {'a':'b'}
    });
}

module("AJAX tests", {
    teardown: function() {
        $.mockjaxClear();
    }
});
asyncTest("testAjax 1", function () {
    $.mockjax({
        url: '/fakeservice/1',
        type: 'POST',
        dataType: 'json',
        responseText: { 'name1': 'foo' }
    });

    testAjax().then(
        function (response) {
            deepEqual(response.name1, 'foo', "no name1");
            start();
        },
        function (error) {
            ok(false, "got AJAX error");
            start();
        }
    );
});

asyncTest("testAjax 2", function () {
    $.mockjax({
        url: '/fakeservice/1',
        type: 'POST',
        dataType: 'json',
        responseText: { 'name1': 'bar' }
    });

    testAjax().then(
        function (response) {
            deepEqual(response.name1, "bar", "no name1");
            start();
        },
        function (error) {
            ok(false, "got AJAX error");
            start();
        }
    );

}); 
```

[在 jsFiddle 上](http://jsfiddle.net/odi86/L4Kny/)查看您改编的示例。

# python - 将密钥与 ndb 中的 KeyProperty 进行比较

> ID：14780752
> 
> 赞同：0
> 
> 时间：2013-02-08T20:23:37.120
> 
> 标签：python, google-app-engine, app-engine-ndb

我正在尝试进行比较键的查询，但没有得到任何结果。

我有一个教程和一个章节模型。章节模型包含一个 keyProperty 类型的 Tutorial。( `tutKey = ndb.KeyProperty(kind='Tutorial')`)

```
tutID = self.request.cookies.get('tut_id', '')

tutIns = ndb.Key('Tutorial', int(tutID)).get()
chaps = Chapter.query(Chapter.tutKey == tutIns.key)

self.render('editTut.html', chaps=chaps, tutins=tutIns.key) 
```

我发送`tutIns.key`只是为了测试实例是否正常工作，是的，它返回 Key( `Key('Tutorial', 1)`)。此外，如果我只进行查询 Chapter.query() 它会按预期返回所有章节。

这就是我在本章中存储 tutkey 的方式：

```
tutID = self.request.cookies.get('tut_id', '')
tutorial = ndb.Key('Tutorial', tutID)
.
.
.

chap = Chapter(tutKey=tutorial, title=title, content=content,
                           note=note, order=order)
chap.put() 
```

在开发控制台中，我可以看到存储在第 1 章和第 2 章中的 tutkey 是相同的密钥，但该密钥不等于教程密钥。我以错误的方式创建章节？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T21:02:35.530

在这里，您将 ID 转换为 int：

```
tutIns = ndb.Key('Tutorial', int(tutID)).get() 
```

但是在这里，您将其用作字符串：

```
tutID = self.request.cookies.get('tut_id', '')
tutorial = ndb.Key('Tutorial', tutID) 
```

生成的 Key 实例不相等。

# ajax - 将页面中的多个项目刮成整齐的行

> ID：14780759
> 
> 赞同：1
> 
> 时间：2013-02-08T20:24:12.180
> 
> 标签：ajax, json, perl, web-scraping, mozrepl

举个例子：

我从 .txt 加载输入：

本杰明，Schuvlein，德国，1912，M，White

我做了一些代码，为了简洁起见，我不会在这里发布并访问链接：

[https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ](https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ)

1.  我想从该页面上抓取多个内容。在下面的代码中，我只做 1。
2.  我还想让每个项目在输出 .txt 中用 , 分隔。
3.  而且，我希望输出之前是输入。

我在代码中使用了以下包：

```
use strict;
use warnings;
use WWW::Mechanize::Firefox;
use Data::Dumper;
use LWP::UserAgent;
use JSON;
use CGI qw/escape/;
use HTML::DOM; 
```

以下是相关代码：

```
my $ua = LWP::UserAgent->new;
open(my $o, '>', 'out2.txt') or die "Can't open output file: $!";
# Here is the url, although in practice, it is scraped itself using different code
my $url = 'https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ'; 
print "My URL is <$url>\n";  
my $request = HTTP::Request->new(GET => $url);
  $request->push_header('Content-Type' => 'application/json');
  my $response = $ua->request($request);
 die "Error ".$response->code if !$response->is_success;
 my $dom_tree = new HTML::DOM;
 $dom_tree->write($response->content);
 $dom_tree->close;
  my $str = $dom_tree->getElementsByTagName('table')->[0]->getElementsByTagName("td")->[10]->as_text();
 print $str;
print $o $str; 
```

所需的输出（来自该链接）类似于：

Benjamin，Schuvlein，德国，1912，M，White，Queens，New York，Married，Same Place，Head，等等......

（该输出部分中有多少是可抓取的？）

任何有关如何在链接中获取链接的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:37:16.617

尝试这个

```
use LWP::Simple;
use LWP::UserAgent;
use HTML::TableExtract;

$ENV{'PERL_LWP_SSL_VERIFY_HOSTNAME'} = 0;
$ua = LWP::UserAgent->new;
$ua->agent("Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.91 Safari/537.11");
$req = HTTP::Request->new(GET => "https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ");
$res = $ua->request($req);
$content = $res->content;
#$content = get("https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ") or die "Couldn't get it! $!";
$te = HTML::TableExtract->new( attribs => { 'class' => 'result-data' } );
# $te = HTML::TableExtract->new( );
$te->parse($content);
$table = $te->first_table_found;
# print $content; exit;
# $te->tables_dump(1);
#print Dumper($te);
#print Dumper($table);
print $table->cell(4,0) . ' = ' . $table->cell(4,1), "\n"; exit; 
```

哪个打印出来

> 活动地点： = Assembly District 2, Queens, New York City, 皇后区, 纽约, 美国

我还注意到这个标题：

> X-Copyright:COPYRIGHT WARNING 可通过 FamilySearch API 访问的数据受版权保护。未经许可，禁止对这些数据进行任何程序化访问、重新格式化或重新路由。FamilySearch 认为此类未经授权的使用侵犯了其复制、派生和分发权。如需更多信息，请联系 devnet (at) familysearch.org。

另请参阅[http://metacpan.org/pod/HTML::Element#SYNOPSIS](http://metacpan.org/pod/HTML%3a%3aElement#SYNOPSIS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:24:44.480

使用[`HTML::TreeBuilder::XPath`](https://metacpan.org/module/HTML%3a%3aTreeBuilder%3a%3aXPath)访问 HTML 很简单。该程序使用标签作为键构建数据的哈希，因此可以提取任何所需的信息。我已将任何包含逗号或空格的字段括在引号中。

我不知道你是否有这个网站的许可以这种方式提取数据，但我应该提请你注意`X-Copyright`HTTP 响应中的这个标头。这种方法显然属于*程序访问*的标题。

> X-版权：版权警告可通过 FamilySearch API 访问的数据受版权保护。未经许可，禁止对这些数据进行任何程序化访问、重新格式化或重新路由。FamilySearch 认为此类未经授权的使用侵犯了其复制、派生和分发权。如需更多信息，请联系 devnet (at) familysearch.org。

我应该期待您的电子邮件吗？我回复了你的第一封邮件，但从那以后就再也没有听到过。

```
use strict;
use warnings;

use URI;
use LWP;
use HTML::TreeBuilder::XPath;

my $url = URI->new('https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ');

my $ua = LWP::UserAgent->new;
my $resp = $ua->get($url);
die $resp->status_line unless $resp->is_success;

my $tree = HTML::TreeBuilder::XPath->new_from_content($resp->decoded_content);
my @results = $tree->findnodes('//table[@class="result-data"]//tr[@class="result-item"]');
my %data;
for my $item (@results) {
  my ($key, $val) = map $_->as_trimmed_text, $item->content_list;
  $key =~ s/:$//;
  $data{$key} = $val;
}

my $record = join ',', map { local $_ = $data{$_}; /[,\s]/ ? qq<"$_"> : $_ }
  'name', 'birthplace', 'estimated birth year', 'gender', 'race (standardized)',
  'event place', 'marital status', 'residence in 1935',
  'relationship to head of household (standardized)';

print $record, "\n"; 
```

**输出**

```
"Benjamin Schuvlein",Germany,1912,Male,White,"Assembly District 2, Queens, New York City, Queens, New York, United States",Married,"Same Place",Head 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T15:09:50.283

我以为我已经回答了你的问题。

问题是您正在尝试使用 LWP 获取网页。如果您已经拥有 WWW::Mechanize::Firefox，为什么还要尝试这样做？

你试过这个吗？

它将检索并保存每个链接以供进一步分析。一个小小的改变，你就“得到”了 DOM 树。抱歉，我无权访问此页面，所以我只希望它能正常工作。

```
my $i=1;
for my $link (@links) {
  print Dumper $link->url;
  print Dumper $link->text;
  my $tempfile = './$i.html';$i++;
  $mech->get( $link, ':content_file' => $tempfile, synchronize => 1 );
  my $dom_tree = $mech->document();
  my $str = $dom_tree->getElementsByTagName('table')->[0]->getElementsByTagName("td")->[9]->as_text();

 } 
```

编辑：使用正则表达式处理页面内容（每个人：请记住，总是有不止一种方法可以用 Perl 做某事！。它有效，很容易......）

它用这个 cmd 试了一下：

wget -nd ' [https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ](https://familysearch.org/pal:/MM9.1.1/K3BN-LLJ) ' -O 1.html|cat 1.html|1.pl

```
use Data::Dumper;
use strict;
use warnings;

local $/=undef;
my $html = <>;#read from file
#$html = $mech->content( format => 'html' );# read data from mech object
my $data = {};
my $current_label = "not_defined";
while ($html =~ s!(<td[^>]*>.*?</td>)!!is){ # process each TD
    my $td = $1;
    print "td: $td\n";
    my $td_val = $td;
    $td_val =~ s!<[^>]*>!!gis;
    $td_val =~ s!\s+! !gs;
    $td_val =~ s!(\A\s+|\s+\z)!!gs;
    if      ($td =~ m!result-label!){ #primitive state machine, store the current label
        print "current_label: $current_label\n";
        $current_label = $td_val;
    } elsif ($td =~ m!result-value!){ #add each data to current label
        push(@{$data->{$current_label}},$td_val);

    } else {
        warn "found something else: $td\n";
    }
}
#process it using a white lists of known entries (son,race, etc).Delete from the result if you find it on white list, die if you find something new.
#multi type
foreach my $type (qw(son wife daughter head)){
    process_multi($type,$data->{$type});
    delete($data->{$type});
}
#simple type
foreach my $type (qw(birthplace age)){
    process_simple($type,$data->{$type});
    delete($data->{$type});
}

die "Unknown label!".Dumper($data) if scalar(keys %{$data})>0; 
```

输出：

```
 'line number:' => [
                          '28'
                        ],
      'estimated birth year:' => [
                                   '1912'
                                 ],
      'head' => [
                  'Benjamin Schuvlein',
                  'M',
                  '28',
                  'Germany'
                ], 
```

# php - Jquery淡入对象数组 - 一次一个项目

> ID：14780763
> 
> 赞同：0
> 
> 时间：2013-02-08T20:24:41.217
> 
> 标签：php, jquery, json, for-loop

每天学习很多关于 Jquery 的知识。但是，似乎我一生都无法弄清楚如何在这个多维数组中一次显示一个项目，同时淡入和淡出每个项目。*注意我不希望这些附加，只显示一组，然后淡出并淡入到下一组。这里有一些信息给你的专业人士。

基本上在这里，我将我在名为 data 的 json 对象中的内容存储到结果中。这似乎每次都会循环，就好像我放了 alert(result['question']) 它一次会给我每个值一个，但是当试图将它应用到我的 div 时，我正在使用一个名为 span 的类.Active，它只会循环遍历整个内容并给我数组中的最后一项。2+2 lol duh 1 2\. 我在这里做错了什么？如果需要，我会尝试为它安装一个 jfiddle。

来自 php 页面的对象（称为数据）

```
[{"id":"238","question":"Which of these is a noun?","answer":"horse"},{"id":"238","question":"Which of these is a noun?","answer":"long"},{"id":"238","question":"Which of these is a noun?","answer":"pretty"},{"id":"238","question":"Which of these is a noun?","answer":"hair"},{"id":"238","question":"2+2 lol duh 1 2","answer":"4"}] 
```

代码

```
for (var i = 0; i < data.length; i++) {
    result = data[i];
    console.log(result['question']);

    liText += '<span><h5>'+result["question"]+'</h5>';
    liText += '<p><b>Option:&nbsp;</b>'+result["answer"];

    liText += '</p></span>';

    $.each(result['question'], function(index) {
        $(this).delay(400*index).fadeIn(300);

    });
    $('.Active').text(result['question']);

    } 
```

结果的控制台日志[问题] *注意这些是正确的，5 个不同的问题，前 4 个是相同的。

```
Which of these is a noun?

index....mid=119 (line 227)

Which of these is a noun?

index....mid=119 (line 227)

Which of these is a noun?

index....mid=119 (line 227)

Which of these is a noun?

index....mid=119 (line 227)

2+2 lol duh 1 2 
```

ps * 一百万个尊重点，如果你能让它与我上面的 liText 一起工作:)

编辑*

当删除 .each 并在此周围移动一些东西似乎可行时，任何可以帮助我首先淡出淡入淡出并淡出每个的人都会感激不尽。位于 $('.Active')

```
for (var i = 0; i < data.length; i++) {
    result = data[i];
    alert(result['question']);
    $('.Active').text(result['question']); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:05:01.640

试试这个：

```
for (var i = 0; i < data.length; i++) {
    result = data[i];

    var $question = $("<span>").text(result['question']).hide()
                               .delay(400*i).fadeIn(300);

    $('.Active').append($question);
} 
```

我完全删除了该`liText`部分，因为您没有对它做任何事情。

[http://jsfiddle.net/Qf3FZ/](http://jsfiddle.net/Qf3FZ/)

# c# - 获取超网格列的实际宽度

> ID：14780765
> 
> 赞同：3
> 
> 时间：2013-02-08T20:24:48.197
> 
> 标签：c#, winforms, infragistics, ultrawingrid

如何在 UltraGrid 和 UltraGrid 中准确获得扩展的 UltraGridColumn 宽度？

我有以下 Windows 窗体：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        IEnumerable<string> test = new List<string>{DateTime.Now.ToString()};
        this.ultraGrid2.DataSource = test;
        this.ultraGrid2.DisplayLayout.AutoFitStyle = AutoFitStyle.ExtendLastColumn;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        MessageBox.Show("The column width is " + this.ultraGrid2.DisplayLayout.Bands[0].Columns[0].Width);
    }
} 
```

![表格是什么样子的](../Images/ebf34344cc471c85a345e3d0d9b77107.png)

无论我如何操作或调整表单大小。`width`仍然给出相同的默认值。只有当我调整列的大小时，它才会改变。在这种情况下，我认为宽度将接近表单本身的 x 大小。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T21:21:33.347

如果您将 设置为`AutoFitStyle`最后一列`ExtendLastColumn`的`Width`属性，则不会反映该列的实际宽度。如果您将其设置为`AutoFitStyle`，则`None`可以设置并读取列宽度。

但是，至少只是为了阅读，有一种解决方法：
在上面的示例中，只有一列，您可以获得该列的 CellSizeResolved 属性

```
UltraGridColumn column = grid.DisplayLayout.Bands[0].Columns[0];
Debug.WriteLine("Column width is " + column.CellSizeResolved.Width); 
```

# c# - 如何使用 Dapper Dot Net 从数据库结果映射到 Dictionary 对象？

> ID：14780767
> 
> 赞同：76
> 
> 时间：2013-02-08T20:25:09.790
> 
> 标签：c#, asp.net, dapper

如果我有一个简单的查询，例如：

```
string sql = "SELECT UniqueString, ID  FROM Table"; 
```

我想将它映射到一个字典对象，例如：

```
Dictionary<string, int> myDictionary = new Dictionary<string, int>(); 
```

我将如何使用 Dapper 做到这一点？

我认为它是这样的：

```
myDictionary = conn.Query<string, int>(sql, new {  }).ToDictionary(); 
```

但无法弄清楚正确的语法。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2013-02-09T08:37:53.503

已经展示了各种方法；就我个人而言，我只会使用非通用 api：

```
var dict = conn.Query(sql, args).ToDictionary(
    row => (string)row.UniqueString,
    row => (int)row.Id); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2018-08-13T05:13:12.973

```
string strSql = "SELECT DISTINCT TableID AS [Key],TableName AS [Value] FROM dbo.TS_TStuctMaster";
Dictionary<string,string> dicts = sqlConnection.Query<KeyValuePair<string,string>>(strSql).ToDictionary(pair => pair.Key, pair => pair.Value); 
```

您可以使用别名和强类型。

**别名是关键点，匹配KeyValuePair类型Key和Value的属性。**

它在强类型下工作并且运行良好。

*我不喜欢动态类型。它在某些情况下会带来灾难。此外，装箱和拆箱会带来性能损失。*

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-02-08T21:56:16.127

也可以在没有额外课程的情况下工作：

```
var myDictionary = conn.Query<string, int, KeyValuePair<string,int>>(sql, (s,i) => new KeyValuePair<string, int>(s,i))
    .ToDictionary(kv => kv.Key, kv => kv.Value); 
```

**注意**：使用 Dapper.NET 3.5 版本时，采用第一种、第二种和返回类型的 Query 方法需要您指定更多参数，因为 .NET 4.0 和 .NET 4.5 版本利用[可选参数](http://msdn.microsoft.com/en-us/library/dd264739.aspx)。

在这种情况下，以下代码应该可以工作：

```
string splitOn = "TheNameOfTheValueColumn";
var myDictionary = conn.Query<string, int, KeyValuePair<string,int>>(sql, (s,i) => new KeyValuePair<string, int>(s,i), null, null, false, splitOn, null, null)
        .ToDictionary(kv => kv.Key, kv => kv.Value); 
```

大多数参数将恢复为默认值，但这`splitOn`是必需的，否则它将默认为“id”值。

对于返回两列“ *ID* ”和“ *Description* ”的查询，`splitOn`应设置为“ *Description* ”。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2019-04-04T08:37:07.660

如果您使用 > .net 4.7 或 netstandard2，您可以使用值元组。代码很好，很简洁，没有使用动态。

```
var sql = "SELECT UniqueString, Id  FROM Table";
var dict = conn.Query<(string UniqueString, int Id)>(sql)
           .ToDictionary(t => t.UniqueString,t => t.Id); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-11-19T18:35:34.837

Dapper 还有一个扩展方法`ExecuteReader`. 所以，你也可以这样做：

```
var sql = "SELECT UniqueString, ID  FROM Table";
var rows = new List<Dictionary<string, int>>();
using (var reader = cn.ExecuteReader(sql)) {
    while (reader.Read()) {
        var dict = new Dictionary<string, int>();
        for (var i = 0; i < reader.FieldCount; i++) {
            dict[reader.GetName(i)] = reader.GetInt32(i);
        }
        rows.Add(dict);
    }
} 
```

这种方法可以在不知道列名的情况下工作。此外，如果您不知道数据类型，您可以更改`Dictionary<string,int>`为`Dictionary<string,object>`和。`GetInt32(i)``GetValue(i)`

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-02-08T21:15:21.743

我不确定您尝试做的事情是否可行。如果您定义一个类来将查询映射到这变得更加微不足道：

```
public class MyRow
{
    public int Id { get; set; }
    public string UniqueString { get; set; }
} 
```

然后，您只需执行以下操作：

```
var sql = "SELECT UniqueString, ID  FROM Table";
var myDictionary = conn.Query<MyRow>(sql).ToDictionary(row => row.UniqueString, row => row.Id); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-11-30T14:40:32.797

对于您在运行时不知道其结构的表

```
 using var db = new SqlConnection(_connectionString);
    var sql = $"Select * From {tableName} Order By {primaryKey}";

    var result = await db.QueryAsync(sql); 
    return result
        .Cast<IDictionary<string, object>>()
        .Select(it => it.ToDictionary(it => it.Key, it => it.Value)); 
```

# java - 确定是否在 Java 中的旋转矩形内单击鼠标（AWT，swing）

> ID：14780774
> 
> 赞同：0
> 
> 时间：2013-02-08T20:25:37.637
> 
> 标签：java, swing, affinetransform

如果矩形已旋转，我在弄清楚如何确定是否在矩形内单击了鼠标单击事件时遇到了一些麻烦。

假设我有一个像这样简单的 MouseAdapter。它只是打印出一个声明，如果 mousePressed 实际上在矩形内，我们就在矩形内点击。

```
MouseAdapter mAdapter = new MouseAdapter() {
    public void mousePressed(MouseEvent e) {
        int xPos = e.getX();
        int yPos = e.getY();
        if(xPos >= rect.x && xPos <= rect.x + rect.width && yPos >= rect.y && yPos <= rect.y + rect.height) {
            System.out.println("HIT INSIDE RECTANGLE");
        }
    }
}; 
```

我的问题来自旋转矩形时。上面的 if 语句显然没有考虑旋转，所以在我旋转矩形之后，我的命中测试失败了。对于旋转，我在 paint() 函数中做这样简单的事情：

```
class drawRect {

    Rectangle rect = new Rectangle();

    ...

    public void paint(Graphics g) {
        Graphcis2D g2 = (Graphics2D) g;
        AffineTransform old = g2.getTransform();
        g.rotate(Math.toRadians(90), rect.x, rect.y); 
        g2.draw(rect);
        g2.setTransform(old);
    }
} 
```

这只是一些快速的伪代码，所以你们可以理解我想要做什么。所以请不要担心语法和所有这些。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:52:34.693

您也可以将旋转应用于鼠标坐标。干编码：

```
MouseAdapter mAdapter = new MouseAdapter() {
    public void mousePressed(MouseEvent e) {
        // Create the same transform as used for drawing the rectangle
        AffineTransform t = new AffineTransform();
        t.rotate(Math.toRadians(90), rect.x, rect.y);
        Point2D tp = t.inverseTransform(e.getPoint());

        if(rect.contains(tp)) {
            System.out.println("HIT INSIDE RECTANGLE");
        }
    }
}; 
```

# entity-framework - UnitOfWork 和实体框架上下文

> ID：14780776
> 
> 赞同：1
> 
> 时间：2013-02-08T20:25:46.787
> 
> 标签：entity-framework, repository-pattern, unit-of-work

所以我要解决的问题是这个；我们正在使用实体框架来访问我们的 Oracle 数据库，该数据库有 1200-1500 个表。现在请注意，我们不会全部访问它们，但可能有 800 多个可以访问。我们正在使用 UnitOfWork --> Repository --> Service 模式，效果很好，但我们正在尝试确定是否应该拥有一个大的 DbContext，或者多个特定于手头任务的小上下文。

我们的 UnitOfWork 是使用 EFUnitOfWorkBase 设置的，如下所示：

```
public abstract class EFUnitOfWorkBase : IUnitOfWork
{
    private bool isDisposed = false;

    public DbContextBase Context { get; set; }

    protected EFUnitOfWorkBase(DbContextBase context)
    {
        Context = context;
    }

    public int Commit()
    {
        return Context.SaveChanges();
    }

    public void Dispose()
    {
        if (!isDisposed)
            Dispose(true);
        GC.SuppressFinalize(this);
    }

    private void Dispose(bool disposing)
    {
        isDisposed = true;
        if (disposing)
        {
            if (this.Context != null)
                this.Context.Dispose();
        }
    }

    public IRepository<TEntity> GetRepository<TEntity>() where TEntity : Common.EntityBase<TEntity>
    {
        return new Repository<TEntity>(this);
    }
} 
```

我们创建的任何工作单元都扩展了该基础单元并提供如下上下文：

```
public class EmployeeDirectoryUnitOfWork : EFUnitOfWorkBase
{
    public EmployeeDirectoryUnitOfWork(string connectionString)
        : base(new EmployeeDirectoryContext(connectionString))
    {
    }
} 
```

DbContext 通过工作单元传递一个连接字符串。

`Repository`看起来像这样：

```
public abstract class RepositoryBase<TEntity> : IRepository<TEntity> where TEntity : class
{
    protected DbContextBase Context;
    protected DbSet<TEntity> EntitySet;

    public RepositoryBase(EFUnitOfWorkBase unitOfWork)
    {
        Enforce.ArgumentNotNull(unitOfWork, "unitOfWork");

        Context = unitOfWork.Context;
        EntitySet = Context.Set<TEntity>();
    }

    public TEntity Add(TEntity entity)
    {
        Enforce.ArgumentNotNull(entity, "entity");

        return EntitySet.Add(entity);
    }

    public TEntity Attach(TEntity entity)
    {
        Enforce.ArgumentNotNull(entity, "entity");

        return EntitySet.Attach(entity);
    }

    public TEntity Delete(TEntity entity)
    {
        Enforce.ArgumentNotNull(entity, "entity");

        return EntitySet.Remove(entity);
    }

    public System.Linq.IQueryable<TEntity> Query()
    {
        return EntitySet.AsQueryable();
    }

    public TEntity Save(TEntity entity)
    {
        Enforce.ArgumentNotNull(entity, "entity");

        Attach(entity);
        Context.MarkModified(entity);

        return entity;
    }
} 
```

关于如何最好地处理这种情况的任何建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T20:31:14.730

在这种情况下，当您有这样的大型应用程序时，我认为您可能应该采用更多的领域驱动设计方法并将上下文拆分为一些单独的有界上下文。这样，当后来的开发人员向程序添加功能时，他们将被限制为只能访问某些表，具体取决于他们将在那里使用的上下文。

为了获得更好的信息，Julie Lerman 最近推出了一门关于 Pluralsight 的关于企业实体框架的课程，非常棒。[她在这个网站](http://learnentityframework.com/LearnEntityFramework/tutorials/new-entity-framework-in-the-enterprise-course-on-pluralsight/)上发布了一个小片段（实际上是关于有界上下文）。这是一门非常好的课程，我强烈推荐它，尤其是对于你正在做的事情。

# java - javafx过渡的当前圆位置

> ID：14780781
> 
> 赞同：0
> 
> 时间：2013-02-08T20:26:03.967
> 
> 标签：java, javafx

我试图找出我在过渡时下降的圆圈的当前位置。我需要什么？设置每一秒的计时器。圆圈的位置？或任何建议如何获得实际位置值。

这段代码显示了我的 hitOuterCirlce 方法的一部分，甚至显示了相同的 getCenterX - 圆的值：

```
 // (x-u)*(x-u) + (y-v) )*(y-v) < (r * r)
    // outer circle:
    double u = 2 * (3.141 * circle.getRadius());
    double res1 = (circle.getCenterX() - u) * (circle.getCenterX() - u);
    double v = (1.333 * 3.141) * (circle.getRadius() * circle.getRadius()) * circle.getRadius();
    double res2 = (circle.getCenterY() - v) * (circle.getCenterY() - v);
    double res3 = (circle.getRadius() * circle.getRadius()); 
```

我怎样才能解决这个问题？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:45:07.267

只需绑定到圆的 centerX/Y 属性

示例代码：

```
DoubleProperty xValue = new SimpleDoubleProperty();
    xValue.bind(circle.centerXProperty());
    xValue.addListener(new ChangeListener() {
        @Override
        public void changed(ObservableValue arg0, Object arg1, Object arg2) {

            System.out.println(" Current center X : " + (double) arg2);
        }
    }); 
```

# ruby - Ruby map() 用于单个对象

> ID：14780783
> 
> 赞同：16
> 
> 时间：2013-02-08T20:26:07.727
> 
> 标签：ruby, map

我正在寻找一种在 Ruby 中“映射”单个项目的方法。

我想调用这个函数并传递一个块，对象将被让给块，然后块的结果将返回给调用者。正是 map 的作用，但对于单个元素。

动机是有时你生成的对象只是用来构造其他东西。然后不再需要原始对象。将转换放入一个块中并消除临时性会很好。

作为一个人为的例子，假设我想创建一个表示月/年组合的整数。对于今天的日期，代码如下所示：

```
day = Date.today
month_number = day.year * 100 + day.month 
```

如果我能做这样的事情，我真的很喜欢：

```
month_number = Date.today.some_function { |d| d.year * 100 + d.month } 
```

但我不知道“some_function”是什么（或者它是否存在）。

如果有更多的 Ruby 方式来处理这样的事情，我会全力以赴。我知道猴子修补类，但我希望处理那些更短暂的情况。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-08T20:32:10.710

[**`instance_eval`**](http://apidock.com/ruby/BasicObject/instance_eval)就是你要找的。

```
month_number = Date.today.instance_eval { |d| d.year * 100 + d.month } 
```

`|d|`也是可选的，默认`self`为对象上下文。

这可能会以更紧凑的方式满足您的需求。

```
month_number = Date.today.instance_eval { year * 100 + month } 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-02-09T02:30:12.383

使用`instance_eval`as in`jondavidjohn`的答案是一种方法，但它有重新分配的开销`self`。这样的特性曾经[在 Ruby 核心中被提出](http://bugs.ruby-lang.org/issues/6684#note-2)，但被拒绝并被撤回。使用其中一位 Ruby 开发人员 knu (Akinori MUSHA) 提供的解决方案，您可以这样编写：

```
month_number = Date.today.tap{|d| break d.year * 100 + d.month} 
```

使用`tap`，您唯一需要做的额外事情就是将其放在`break`块的开头。

* * *

```
require 'benchmark'

n = 500000
Benchmark.bm do |x|
  x.report{n.times{Date.today.instance_eval{year * 100 + month}}}
  x.report{n.times{Date.today.instance_eval{|d| d.year * 100 + d.month}}}
  x.report{n.times{Date.today.tap{|d| break d.year * 100 + d.month}}}
end

       user     system      total        real
   2.130000   0.400000   2.530000 (  2.524296)
   2.120000   0.400000   2.520000 (  2.527134)
   1.410000   0.390000   1.800000 (  1.799213) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-08T20:33:58.490

Ruby 的内置[`Object#tap`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-tap)函数很接近，但它不返回块的值。

这是一个想法：

```
class Object
  def sap
    yield self
  end
end

eleven = 10.sap { |x| x + 1 } # => 11
month_number = Date.today.sap { |d| d.year * 100 + d.month } # => 201202 
```

# c# - Ninject - 基本使用

> ID：14780789
> 
> 赞同：0
> 
> 时间：2013-02-08T20:26:47.260
> 
> 标签：c#, asp.net-mvc, dependency-injection, ninject

我有一堂课`Ninject`

但我不知道 Ninject 这么高。

为什么总是必须键入这个方法？

```
protected override IController GetControllerInstance(
  System.Web.Routing.RequestContext requestContext, 
  System.Type controllerType)
{
  return controllerType == null 
    ? null 
    : (IController)ninjectKernel.Get(controllerType);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:31:36.937

Ninject 是一个[IOC（控制反转）](http://en.wikipedia.org/wiki/Inversion_of_control)包。

您总是输入的代码要求 Ninject 容器找到指定类型的控制器。

# abcpdf - 使用 ABCPDF 解析 PDF

> ID：14780790
> 
> 赞同：0
> 
> 时间：2013-02-08T20:26:50.113
> 
> 标签：abcpdf

我想解析我用 ABCPDF 下载的 PDF 文档，但我找不到文档中的任何元素或如何访问它们并迭代它们。我想解析出一些文本。

```
var webClient = new WebClient();
                                var bytes = webClient.DownloadData("http://test.com/test.pdf");

                                var doc = new Doc();
                                doc.Read(bytes); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T09:30:41.690

使用[Doc.GetText](http://www.websupergoo.com/helppdf9net/source/5-abcpdf/doc/1-methods/gettext.htm)方法从当前页面提取内容，指定返回内容的格式。

```
doc.PageNumber = 1;
string pageContent = doc.GetText("Text"); 
```

上面的示例将按布局顺序返回纯文本。指定“SVG”或“SVG+”会随文本返回附加信息，例如样式和位置。

# c++ - Indy10 TCP 服务器冻结

> ID：14780792
> 
> 赞同：0
> 
> 时间：2013-02-08T20:26:54.127
> 
> 标签：c++, c++builder, indy, indy10

我将 Indy 与 C++ Builder XE3 一起使用。这是完美的系统，但我有一些问题。IdTCPServer 工作得非常好，但是当我与他有一些连接并且我想停止服务器时，我的应用程序就冻结了。我试着一步一步告诉我是怎么做的：1）启动应用程序（和服务器监听）2）等待新连接（或模拟它，没有区别）3）当我们有10-15个连接时 - 然后尝试停止服务器听。4) 当代码到达 IdTCPServer1->Active = false - 应用程序将被冻结

我做了小视频。也许它更好地解释了情况。[http://www.youtube.com/watch?v=BNgTxYbLx8g](http://www.youtube.com/watch?v=BNgTxYbLx8g)

这里是我的代码：

连接：

```
EnterCriticalSection(&CritLock);
++ActiveConnections;
SetActiveConnections(ActiveConnections);
LeaveCriticalSection(&CritLock); 
```

断开连接：

```
EnterCriticalSection(&CritLock);
--ActiveConnections;
SetActiveConnections(ActiveConnections);
LeaveCriticalSection(&CritLock); 
```

停止服务器代码：

```
void TForm1::StopServer()
{
    TList *list = IdTCPServer1->Contexts->LockList();
    try
    {
        for(int i = 0; i < list->Count; ++i)
        {
            TIdContext *AContext = reinterpret_cast<TIdContext*>(list->Items[i]);
            try
            {
                if (AContext->Connection->Connected())
                {
                    AContext->Connection->IOHandler->InputBuffer->Clear();
                    AContext->Connection->IOHandler->WriteBufferCancel();
                    AContext->Connection->IOHandler->WriteBufferClear();
                    AContext->Connection->IOHandler->WriteBufferClose();
                    AContext->Connection->IOHandler->CloseGracefully();
                    AContext->Connection->Disconnect();
                }
            }
            catch (const Exception &e)
            {

            }
        }
    }
    __finally
    {
        IdTCPServer1->Contexts->UnlockList();
    }
    IdTCPServer1->Contexts->Clear();
    //IdTCPServer1->StopListening();
    IdTCPServer1->Active = false;
} 
```

谢谢指教！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:48:17.283

您需要删除`StopServer()`除最后一行之外的所有代码。停用时`TIdTCPServer`，它会为您执行所有必要的清理工作。 **不要**自己做（尤其是因为你做错了）。

```
void TForm1::StopServer()
{
    IdTCPServer1->Active = false;
} 
```

现在，仅使用该代码，如果您的应用程序仍然冻结，那么这意味着您正在死锁主线程。如果您`StopServer()`在主线程的上下文中调用并且在您的服务器代码中发生以下两种情况之一，则会发生这种情况：

1.  您的`TIdTCPServer`事件处理程序之一对主线程执行同步操作（通过`TIdSync`或`TThread::Synchronize()`）。

2.  您的`TIdTCPServer`事件处理程序之一会吞下 Indy 异常，并且不允许`TIdTCPServer`在需要时正确终止一个或多个客户端线程。

在内部，`TIdTCPServer::Active`属性设置器关闭所有活动套接字并等待它们各自的线程完全终止，阻塞调用线程直到属性设置器退出。如果您在主线程中停用服务器，并且其中一个服务器线程执行了主线程无法处理的同步，或者在应该停止时没有正确终止，这将阻止服务器停用退出并因此死锁主线程线。

因此，请确保：

1.  当服务器被主线程停用时，您没有对主线程执行同步操作。如果您必须同步，则改为在工作线程中停用服务器，以便不再阻塞主线程。

2.  您的事件处理程序不会在块中吞下任何 Indy`EIdException`派生的异常。`try/catch`如果你捕捉到这样的异常，当你用完它时重新抛出它。让我们`TIdTCPServer`处理任何 Indy 异常，以便它可以根据需要执行内部清理。

最后，附带说明一下，您不需要手动跟踪连接。 `TIdTCPServer`已经在`Contexts`酒店内为您做到了。如果您需要知道当前连接了多少客户端，只需`Lock()`列出`Contexts`列表，读取其`Count`属性（或对客户端执行任何其他操作），然后`Unlock()`查看列表。

# c# - 显示“空”行的列表视图

> ID：14780794
> 
> 赞同：0
> 
> 时间：2013-02-08T20:26:56.243
> 
> 标签：c#, wpf, listview, data-binding

我花了好几天没有自己解决这个问题，这让我相信我不了解有关 xaml 和代码隐藏的一些非常基本的东西。我正在尝试使用 WPF 和 c# 在 ListView 中显示来自 ObservableCollection 的数据。

当我开始调试时，窗口会显示带有网格和标题的列表视图。有与应存在的项目数相等的可点击行，但这些项目显示为空白或空。我正在编写一个不完整的教程来尝试学习我的方法，代码如下：

MainWindow.xaml.cs：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();           
    }   
} 
```

名称列表.cs：

```
class NameList : ObservableCollection<PersonName>
{
    public NameList()
        : base()
    {
        Add(new PersonName("Willa", "Cather")); //enumerated? (firstName, lastName)
        Add(new PersonName("Isak", "Dinesen"));
        Add(new PersonName("Victor", "Hugo"));
        Add(new PersonName("Jules", "Verne"));
    }
} 
```

人名.cs：

```
class PersonName
{
    private string firstname;
    private string lastname;

    public PersonName(string first, string last)
    {
        this.firstname = first;
        this.lastname = last;
    }

    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

我会包括 xaml，但我还没有想出如何在此处的问题中做到这一点，所以我会尽我所能把它拼出来：

```
ListView ItemsSource=""{Binding Source={StaticResource NameListData}}"

GridViewColumn DisplayMemberBinding="{Binding Path=FirstName}"

GridViewColumn DisplayMemberBinding="{Binding Path=LastName}" 
```

我只列出了实际的绑定，我不认为布局信息太重要，但如果我的假设有误，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:35:29.313

您为私有字段分配一个值

```
this.firstname 
```

但绑定到属性

```
public string FirstName { get; set; } 
```

这应该工作

```
public PersonName(string first, string last)
{
    this.Firstname = first;
    this.Lastname = last;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:44:29.107

您的 MainWindow 将需要一个包含您的数据的属性，以便您可以绑定到

```
public partial class MainWindow : Window
{
    private NameList _nameList;

    public NameList NameList
    {
        get { return _nameList; }
        set
        {
            if (_nameList != value)
            {
                _nameList = value;
            }
         }
    }

    public MainWindow ()
    {
        InitializeComponent(); 

        NameList = new NameList();
    }
} 
```

您的 PersonName 类需要分配属性（而不是成员），以便您可以绑定到它们：

```
public class PersonName
{
    public PersonName(string first, string last)
    {
        FirstName = first;
        LastName = last;
    }

    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

在您的 XAML 中，您可以像这样绑定：

```
<ListView ItemsSource="{Binding NameList}">
    <ListView.ItemTemplate>
        <DataTemplate>
            <TextBlock>
                <Run Text="{Binding LastName}" /><Run Text=", " /><Run Text="{Binding FirstName}" />
            </TextBlock>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView> 
```

因此，您的结果将如下所示：

![在此处输入图像描述](../Images/bbfcb94f97118d9426cdb5de018c2898.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:54:08.670

所以我只是想通了，@LPL 引发的一闪而过的理解。

当我声明我的属性时，我没有将 get 和 set 值设置为私有字符串，因此当绑定调用它们时，它知道存在四个项目，但它们是空项目。现在的功能代码如下所示：

```
 public string FirstName
    {
        get {return firstname; }
        set{ firstname=value; }
    } 
```

具有 LastName 的等效属性。对简单的问题感到高​​兴成为巨大的头痛。

# jquery - jQuery访问父对象但对象为空？

> ID：14780796
> 
> 赞同：0
> 
> 时间：2013-02-08T20:27:02.730
> 
> 标签：jquery

我想获取一个选定选项的父项，它是一个 td，然后使用 insertAfter 在它之后插入另一个 td，但引用返回 null？有人能告诉我为什么吗？

谢谢

```
JQ('.defieldselect').live('change',function(){
    var $option = JQ(this).find('option:selected');
    if($option.attr('rel')=='Date'){            
        var ddlID = $option.parent().parent().parent().find('.criteria-value').find('input').attr("id");
        var index = ddlID.split("_")[1];
        var select = CreateDateSelectList(index);
        $(select).insertAfter($option.parent);
    }        
}); 
```

HTML

```
 <tr>

        <td id="g1_c0_criteria_field" class="criteria-field">
            <select class="defieldselect" name="g1_c0_criteria_field">

<option rel="Text">Product ID 1</option>
<option rel="Date">Date Added</option>

            </select>
        </td>
        <td class="criteria-operator">
            <select id="g1_c0_criteria_operator" name="g1_c0_criteria_operator">
                <option value="=">is equal to</option>
                <option value="!=">is not equal to</option>
                <option value="&gt;">is greater than</option>
                <option value="&lt;">is less than</option>
                <option value="LIKE">contains</option>
                <option value="NOT LIKE">does not contain</option>
                <option value="LIKE">begins with</option>
            </select>
        </td>

    </tr> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:30:00.007

`parent()`尝试使用该`closest()`函数，而不是使用一系列调用。

```
$option.closest('div.parentClass').find('.criteria-value').... 
```

为您正在寻找的任何父母传递一个有效的选择器。这样你就不会太依赖结构了。

# java - 更新地图和阅读地图时无锁解决方案

> ID：14780797
> 
> 赞同：0
> 
> 时间：2013-02-08T20:27:11.077
> 
> 标签：java, database, concurrency, atomic, concurrenthashmap

我正在尝试测量每个线程插入数据库所需的时间。我已经以每个线程在插入时所花费的时间的`ConcurrentHashMap`名称捕获了所有这些性能数字。`histogram`

下面是我测量每个线程花费多少时间并将其存储在`ConcurrentHashMap`

```
class Task implements Runnable {

public static ConcurrentHashMap<Long, AtomicLong> histogram = new ConcurrentHashMap<Long, AtomicLong>();

     @Override
     public void run() {

     try {

     long start = System.nanoTime();

     preparedStatement.executeUpdate(); // flush the records.

     long end = System.nanoTime() - start;

     final AtomicLong before = histogram.putIfAbsent(end / 1000000, new AtomicLong(1L));
          if (before != null) {
               before.incrementAndGet();
          }

         }
     }

    } 
```

**所以我的问题是我试图测量每个线程花费多少时间并将所有这些数字存储在 a 中的`ConcurrentHashMap`方式是否是线程安全的？**

我认为我的整个更新操作是`Atomic`. 我只是想看看如果我的整个操作没有，是否有比这更好的方法`Atomic`。我主要在找`lock free solution`。

**然后在每个线程完成执行任务后，我`Histogram`从 main 方法打印这个映射，因为我已经将该映射设置为`Static`. 那么这种方式对不对？**

```
public class LoadTest {

public static void main(String[] args) {

//executing all the threads using ExecutorService

//And then I am printing out the historgram that got created in Task class    
System.out.println(Task.histogram);

     }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:42:56.190

您的代码是正确的；还有一个（更复杂的）习惯用法可以避免`AtomicLong`每次都实例化。但是请注意，由于关键部分的持续时间非常短，因此“天真的”基于锁的解决方案可能同样好。

# php - 如何在 PHP 中阅读 Google Drive 电子表格？

> ID：14780804
> 
> 赞同：40
> 
> 时间：2013-02-08T20:27:42.207
> 
> 标签：php, google-drive-api

我要做的就是从网站上阅读 Google 电子表格。我已经阅读并重新阅读了 Google Drive API 文档以及 Stack Overflow 上的所有 Google Drive PHP 内容，但我仍然无法到达终点区。

这是我所做的：

1.  去过 Google APIs Console 并且：
    1.  在“服务”下启用“Drive API”和“Drive SDK”；
    2.  在“API 访问”下创建了 OAuth 2.0 客户端 ID。在“Web 应用程序的客户端 ID”下，控制台给了我“客户端 ID”、“电子邮件地址”、“客户端密码”、“重定向 URI”和“JavaScript 来源”；
2.  下载了“Google API PHP 客户端库”；
3.  打开 Google Drive 文档（电子表格）并单击“共享”以获取文档的“密钥”；
4.  设置以下代码：

```
<?php 
session_start(); 
require_once 'lib/gapi/Google_Client.php'; 
require_once 'lib/gapi/contrib/Google_DriveService.php'; 

define( 'GDRIVE_CLIENT_ID', '<API Console - API Access - Client ID>' ); 
define( 'GDRIVE_CLIENT_SECRET', '<API Console - API Access - Client secret>' ); 
define( 'GDRIVE_REDIRECT_URIS', '<API Console - API Access - Redirect URIs>' ); 

define( 'GDRIVE_SCOPE_01', 'h t t p s://www.googleapis.com/auth/drive' ); 
define( 'GDRIVE_SCOPE_02', 'h t t p s://www.googleapis.com/auth/drive.apps.readonly' ); 
define( 'GDRIVE_SCOPE_03', 'h t t p s://www.googleapis.com/auth/drive.file' ); 
define( 'GDRIVE_SCOPE_04', 'h t t p s://www.googleapis.com/auth/drive.metadata.readonly' ); 
define( 'GDRIVE_SCOPE_05', 'h t t p s://www.googleapis.com/auth/drive.readonly' ); 
define( 'GDRIVE_FILE_KEY', '<'key' given from 'sharing' document>' ); 

$client = new Google_Client(); 
$client->setClientId( GDRIVE_CLIENT_ID ); 
$client->setClientSecret( GDRIVE_CLIENT_SECRET ); 
$client->setRedirectUri( GDRIVE_REDIRECT_URIS ); 
$client->setScopes( array( GDRIVE_SCOPE_01, GDRIVE_SCOPE_02, GDRIVE_SCOPE_03, GDRIVE_SCOPE_04, GDRIVE_SCOPE_05 ) ); 

try { 
  $file = $service->files->get( GDRIVE_FILE_KEY ); 
  echo "Title: ", $file->getTitle(); 
  echo "Description: ", $file->getDescription(); 
  echo "MIME type: ", $file->getMimeType(); 
} catch (Exception $e) { 
  echo "An error occurred: ", $e->getMessage(); 
} 
?> 
```

一切运行良好（无论如何都没有错误），直到`$service->files->get( GDRIVE_FILE_KEY )`触发异常的调用：

> 发生错误：调用 GET 时出错`https://www.googleapis.com/drive/v2/files`：(403) 已超出未验证使用的每日限制。继续使用需要注册。

我究竟做错了什么？我把头发拉了出来（嗯，剩下的）。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-08-07T14:54:32.703

如果您不想打扰 API 或 Google 身份验证，还有一个更简单但不太干净的解决方案。

1.  转到 Google Drive 中的电子表格。
2.  转到文件 -> 发布到网络
3.  在“**发布到网络”**对话框中，您可以获得指向电子表格的 .csv 链接。

[![在此处输入图像描述](../Images/815d7e351e3b1b2af3c625e373e6eb1d.png)](https://i.stack.imgur.com/H29py.png)

您现在可以像访问 Web 上的任何其他 csv 文件一样访问内容。这是一些示例代码：

```
$spreadsheet_url="https://docs.google.com/spreadsheet/pub?key=<somecode>&single=true&gid=0&output=csv";

if(!ini_set('default_socket_timeout', 15)) echo "<!-- unable to change socket timeout -->";

if (($handle = fopen($spreadsheet_url, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $spreadsheet_data[] = $data;
    }
    fclose($handle);
}
else
    die("Problem reading csv"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-09T16:01:33.140

请查看[Google Drive PHP 快速入门](https://developers.google.com/drive/v3/web/quickstart/php)。您实际上并未授权您的客户。从...开始`$authUrl = $client->createAuthUrl();`

所有 Google Drive 请求都需要某种授权。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-03-31T10:23:16.223

我创建了一个示例项目，该项目使用服务帐户对 Google 电子表格进行身份验证，以便访问电子表格的内容。

查看[https://github.com/juampynr/google-spreadsheet-reader](https://github.com/juampynr/google-spreadsheet-reader)上的 README 。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-17T10:29:16.737

您需要使用 oauth，如果您不使用，谷歌只会允许您提出一些请求。

如果您只想从谷歌电子表格中读取数据或将数据写入其中，那么您可以使用电子表格 API。查看[php-google-spreadsheet-client](https://github.com/asimlqt/php-google-spreadsheet-client)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-22T02:11:12.007

如果您希望自己的文件被读取，您需要一个服务帐户而不是“Web 应用程序的客户端 ID”。我自己一直在与这个问题作斗争很长时间，这给我带来了解决方案： [https ://developers.google.com/drive/web/service-accounts](https://developers.google.com/drive/web/service-accounts)

# javascript - 两个 Node 服务器是否可以同时运行并交互，从而使一个作为中介服务于客户端？

> ID：14780806
> 
> 赞同：3
> 
> 时间：2013-02-08T20:27:46.710
> 
> 标签：javascript, multithreading, node.js, express, socket.io

我以非常基本的方式修改了一个[简单聊天教程](http://psitsmike.com/2011/09/node-js-and-socket-io-chat-tutorial/)中的一些代码，这样我就有一个 JavaScript 聊天机器人，它位于 NodeJS 服务器上，当用户输入内容时，它会立即向客户端发送响应。

这是 NodeJS 服务器上代码的相关部分，它可以工作：

```
socket.on('sendchat', function (data) {
    // we tell the client to execute 'updatechat' with 2 parameters
    io.sockets.emit('updatechat', socket.username, data);
    // we also tell the client to send the bot's response
    io.sockets.emit('updatechat', 'BOT', bot.transform(data));
}); 
```

因此，机器人的响应与用户的输入密切相关。我现在想将机器人放在不同的节点服务器上，以便聊天可以像对待用户一样向机器人传递和做出反应，并且机器人可以独立处理和行动。大致：

**USER（客户端/浏览器）`<--->`MEDIATOR（节点服务器 1）`<--->`CHAT BOT（节点服务器 2）**

...

我已经尝试了在我看来是显而易见的事情（这显然也是错误的），这是从我的客户那里得到的：

```
var socket = io.connect('http://localhost:8080'); // 8080 being the port for the other server 
```

我将它放入我的服务器端 js 文件中，如下所示：

```
var app = require('express').createServer();
var io = require('socket.io').listen(app);
app.listen(8080);

var socket = io.connect('http://localhost:8080'); 
```

但这会在节点控制台中产生一个错误，说该`io`对象没有方法`connect`。也许这是因为`connect`只属于客户端的 JS 脚本。有没有一种简单的方法可以让我的 Node 服务器与另一个 Node 服务器交互而不会破坏客户端库？

更根本的是，是否有可能同时运行两个节点服务器并让一个作为中介在推送到客户端之前传递和接收来自另一个的消息？我正在使用 Express 框架 (v2.4.6) 和 socket.io (v0.8.4)，但我愿意接受其他建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T21:49:56.533

您的代码中有一些错误。一个应该使用

```
io.sockets.on('connection', function (socket) {
socket.on('updatechat', function(data) {
...
sockets.emit('User',{'user': 'login'});
sockets.emit('User',{'data': data});
});
}); 
```

使用 socket.emit 而不是 io.sockets.emit。io.sockets.emit 将发送给所有客户端。此外，您不能从服务器上的客户端删除同一行！！！，请使用以下命令从节点连接到另一台服务器。

```
var ioc = require('socket.io-client');         //ioc
var socket2 = ioc.connect('server2:8080');   //socket2 
```

休息你可以弄清楚：客户端->套接字->服务器->套接字2->服务器2

更新：socket.io-client 是一个单独的包，需要安装它才能工作。见这里：[https ://npmjs.org/package/socket.io-client](https://npmjs.org/package/socket.io-client)

只需执行此操作即可安装`npm install socket.io-client`

# spring - 如何正确加载我的懒惰关联实体（而不使它们急切地加载）？

> ID：14780807
> 
> 赞同：1
> 
> 时间：2013-02-08T20:27:48.070
> 
> 标签：spring, hibernate, jpa, lazy-loading

我正在使用 Spring 3.1.1.RELEASE、Hibernate 4.1.0.Final、JPA 2.0 构建 WAR，并回复 JBoss 7.1.1.Final。我有这个实体有几个懒惰的关联......</p>

```
@GenericGenerator(name = "uuid-strategy", strategy = "uuid.hex")
@Entity
@Table(name = "cb_contract",
    uniqueConstraints = {@UniqueConstraint(columnNames={"OPPORTUNITY_ID","PRODUCT_ID"})}
)
public class Contract implements Serializable {

    …
    @Id
    @Column(name = "ID")
    @GeneratedValue(generator = "uuid-strategy")
    private String id;

    @OneToOne(fetch = FetchType.LAZY, targetEntity = Product.class)
    @JoinColumn(name = "PRODUCT_ID")
    @NotNull
    private Product product;

    @OneToOne(fetch = FetchType.LAZY, targetEntity = Organization.class)
    @JoinColumn(name = "ORGANIZATION_ID")
    @NotNull
    private Organization org; 
```

我从一种事务方法加载这些实体……</p>

```
@Transactional
@Service
public class ContractServiceImpl implements ContractService
...

public List<Contract> findContractByOppId(final String oppId)
{
    final Contract contract = new Contract();
    contract.setOpportunityId(oppId);
    return m_contractDao.find(contract);
}   // findContractByOppId 
```

然后尝试将它们保存在另一个@Transactional方法中（这个私有方法是从@Transactional公共方法中调用的）：

```
@Service
@Transactional
public class UserServiceImpl implements UserService
{
...
private void saveUserContracts(final User user, final Set<Contract> contracts)
{
    if (contracts != null)
    {
        for (final Contract contract : contracts)
        {
            contract.getOrg();
            contract.getProduct();

            final UserContract userContract = new UserContract();
            userContract.setContract(contract);
            userContract.setUser(user);
            userContractDao.save(userContract);
        }   // for
    }   // if
}   // saveUserContracts 
```

但是，在尝试保存它们时，我得到了以下异常。如何让惰性实体加载（最好使用 JPA，而不是特定于 Hibernate 的方法）？

```
org.hibernate.LazyInitializationException: could not initialize proxy - no Session
    at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:149)
    at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:195)
    at org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:185)
    at org.mainco.subco.organization.domain.Organization_$$_javassist_10.hashCode(Organization_$$_javassist_10.java)
    at org.mainco.subco.ecom.domain.Contract.hashCode(Contract.java:134)
    at java.util.HashMap.put(HashMap.java:372)
    at java.util.HashSet.add(HashSet.java:200)
    at java.util.AbstractCollection.addAll(AbstractCollection.java:305)
    at java.util.HashSet.<init>(HashSet.java:100)
    at org.mainco.subco.user.test.service.UserServiceTest.testAddUser(UserServiceTest.java:116)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

谢谢， - 戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T18:26:14.540

根据提供的信息，我认为至少有三件事是错误的（如果我的解释与现实不符，请纠正我）：

*   `Contract#hashCode()`似乎依赖于延迟加载的属性。不要那样做，这`hashCode`是一种基本的方法，它需要在每个上下文中工作，即即使实体没有附加到会话。
*   您似乎正在做这样的事情：X 类调用事务服务 A，获取结果并将它们传递给另一个事务服务 B。发生的情况是，一旦 A 完成，所有实体都将被*分离*，即它们不再附加到持久性会话，这意味着您不能延迟加载成员。即使在您有会话的 B 内部，这些实体也不会自动重新连接。本质上这就是异常的原因。
*   `UserServiceTest`可能或可能没有正确设置事务支持，真的不能说。

您可以做的是确保 X 本身是事务性的，在这种情况下，A 和 B 中的方法默认参与同一个事务。在 X 完成之前，实体不会分离。

# css - Firefox 中奇怪的引导下拉菜单行为

> ID：14780808
> 
> 赞同：5
> 
> 时间：2013-02-08T20:27:56.770
> 
> 标签：css, firefox, drop-down-menu, twitter-bootstrap

我正在做一个在 Chrome 上开发的网络应用程序，没有问题。我决定在 Firefox 中快速测试该站点，看看是否有任何差异，并在桌子上的下拉菜单中发现了一个奇怪的行为。

我做了一个[小提琴](http://jsfiddle.net/dKtu9/2)来单独测试行为。您可以看到下拉菜单出现在页面底部，而不是靠近 td。如果您在 Chrome 中尝试它，它可以完美运行，但在 Firefox 中失败。

经过调查，我发现在 的 css 中禁用这两个属性后`.dropdown-menu`，下拉菜单按预期工作。

```
top: 100%
left: 0; 
```

下拉菜单在 a 上有效`div`，但在 a 上无效`td`。

表格的 html 中是否有问题导致下拉列表无法出现在正确的位置，或者只是一个 css 故障，必须根据我的确切需要进行修补？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T20:35:32.840

Firefox 不支持单元`position: relative;`格`table`。为了解决这个问题，您需要将下拉列表包装在`div`.

[这是 jsFiddle 上的一个工作示例](http://jsfiddle.net/htmled/SHYaL/)。

```
<table class="table table-bordered">
  <tr>
    <td class="rl2">
      <div class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><b class="caret"></b></a>
        <ul class="dropdown-menu" aria-labelledby="dLabel" role="menu">
          <li><a href="#" class="rl1">rl1</a></li>
          <li><a href="#" class="rl2">rl2</a></li>
        </ul>
      </div>
    </td>
    <td>...</td>
    <td>...</td>
  </tr>
</table> 
```

# android - 如何在android中打开屏幕之前/之后执行异步任务？

> ID：14780809
> 
> 赞同：0
> 
> 时间：2013-02-08T20:28:00.530
> 
> 标签：android, android-intent, android-asynctask

您好，我正在从屏幕 B 执行操作。操作后，我正在显示一个警报对话框。一旦用户单击该对话框中的 OK 按钮，它将导航到屏幕 A。这是通过 Intent 发生的。

屏幕 A 包含一个列表。该列表通过列表活动和数组适配器填充。

我需要在打开屏幕 A 之前或之后调用异步任务来更新列表。

怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:47:01.093

最好的方法是在 onResume() 或 onCreate() 方法中实例化 AsyncTask。然后，在 AsyncTask 类的 doInBackground 方法中，您可以将 listView 所需的数据加载到某个数组中。最后，在 onPostExecute() 中，您应该使用数组中的数据实例化您的适配器，然后将其分配给您的 listView。像这样的东西：

```
ProgressDialog pd;
ArrayAdapter<String> adapter;
ArrayList<String> dataStrings;

@Override
public void onResume() {
         dataStrings = new ArrayList<String>();
         pd = new ProgressDialog(context);
         new MyAsyncTask().execute(params);
}

public class MyAsyncTask extends AsyncTask<String,  Boolean, ArrayList<String>> {

    @Override
    protected void onPreExecute( )
    {
        pd = new ProgressDialog(context);
        pd.setTitle(EsCache.instance.getLangItem("LABEL_PLEASE_WAIT"));
        pd.setMessage(EsCache.instance.getLangItem("LABEL_LOADING_DATA"));
        pd.setCancelable(true);
        pd.show();
    }

    @Override
    protected ArrayList<String> doInBackground(String... params) {
        // TODO Auto-generated method stub

               dataStrings = SomeMethodGetData(); // returns data and stores it in list
               return dataStrings;
    }

    @Override
    protected void onPostExecute(ArrayList<String> list) {
              adapter = new ArrayAdapter<String>(context,
                android.R.layout.simple_list_item_1, dataStrings);

              listView.setAdapter(adapter); 
      pd.dismiss();
    }

} 
```

这只是一个最简单的演示，但它完成了工作，如果您使用一些自定义适配器，它并没有太大的不同。您必须小心，但不要混淆某些内容并尝试从 doInBackground() 更改与 UI 相关的任何内容：) 我希望这对您有所帮助。

# c# - 关闭流程的其他实例的正确方法？

> ID：14780810
> 
> 赞同：0
> 
> 时间：2013-02-08T20:28:11.550
> 
> 标签：c#, winforms, process

SO 周围有很多不同的例子，使用`mutex`，`Environment.Exit(0)`（控制台应用程序），`Application.Exit()`（Win forms）和很多帖子说不要使用`process.kill()`。

有人可以解释我如何关闭我的应用程序的其他实例的政治不正确性。它是一个 Windows 窗体应用程序。这似乎在我的本地环境中运行良好，但我担心存在一些我不知道的严重问题。

```
 // I get the current process name and ID
    string currentProcName = Process.GetCurrentProcess().ProcessName;
    int currentProcID = Process.GetCurrentProcess().Id;

    // I then get a list of all process running under this name
    Process[] currentProcess = Process.GetProcessesByName(currentProcName);

    foreach (Process proc in currentProcess)
    {
        // if the found process id is using the same name, but not this current id, kill it.
        if (proc.Id != currentProcID)
        {

            proc.Kill(); // Documentation says it imediatly stops the associated process.
            proc.Close(); // Documentation says that it frees all resources associated with this component

        }
    } 
```

根据文档，我认为这是关闭正在运行的应用程序的其他实例的合理方法。如果有的话，有经验的可以指出一些问题吗？除了原子性，我将添加异常处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:32:30.397

我必须在这里向 Raymond Chen 提供参考：

*   [为什么不能捕获 TerminateProcess？](http://blogs.msdn.com/b/oldnewthing/archive/2004/07/22/191123.aspx)
*   [关于杀死进程与关闭进程的进一步讨论](http://blogs.msdn.com/b/oldnewthing/archive/2004/07/23/192531.aspx)

到目前为止，以合作方式关闭进程是摆脱它的*最佳方法：它允许发生正确的关闭/关闭。*杀死一个进程基本上是调用`TerminateProcess`，它会完全**停止**它正在做的任何事情并杀死臭虫。

# php - 使用对话提要发布到朋友墙？（FB 2013 年 2 月 6 日更改）

> ID：14780812
> 
> 赞同：0
> 
> 时间：2013-02-08T20:28:26.507
> 
> 标签：php, facebook, facebook-wall

我正在使用 PHP SDK 在朋友墙上创建帖子，在 2 月 6 日更改之前，我只是使用了图形 api 和 /[friend id]/feed/ 以及帖子和参数。我不确定如何使用对话提要在另一面墙上创建帖子。这就是我设置它并将它们链接到网址的方式。这是它引导我到的页面：

“未找到您请求的页面。您可能单击了过期的链接或输入了错误的地址。某些网址区分大小写。”

```
$url = "https://www.facebook.com/[friend id]/feed?
 app_id=[app id]&
 redirect_uri=[redirect url]&
 link=[link]&
 message=[message]&
 picture=[picture url]&
 caption=[caption]&
 description=[description]&
 name=[name]"; 
```

//just using facebook.com/dialog/feed?... 可以很好地发布到我自己的墙上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:39:01.883

`to`通过直接 url 调用提要对话框时，您必须使用该参数。[检查提要对话框参考](http://developers.facebook.com/docs/reference/dialogs/feed/)的“直接 URL 示例”和“属性”块。

最终的 url 看起来像这样（注意`/dialog/feed`和`to=...`部分）：

```
$url = 'https://www.facebook.com/dialog/feed?
        app_id=[appid]&
        link=[link]&
        picture=[picture url]&
        name=[name]&
        caption=[caption]&
        description=[description]&
        redirect_uri=[redirect uri]&
        to=[friend id]'; 
```

# r - 如何使 wilcox.test 适应我在 R 中的数据？

> ID：14780817
> 
> 赞同：0
> 
> 时间：2013-02-08T20:15:58.360
> 
> 标签：r

我是 R 新手，并试图在我的数据上使用 wilcox.test：我有一个数据帧 36021X246，其行名作为探针 ID，最后一行是一个标签，指示样本属于哪个组 - 前 140 个的“控制”和“处理”为最后 106 个。

我将非常感谢在执行测试时知道如何定义这两个组......我无法在网上找到关于“公式”参数的太多信息，除了 -

“公式

一个形式为 lhs ~ rhs 的公式，其中 lhs 是一个数值变量，给出数据值，而 rhs 是一个具有两个级别的因子，给出相应的组。"

如果有人能解释 lhs~rhs 的含义以及如何定义这个公式，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:38:48.627

R 通常假设每一行都是一个案例，而列是关联变量。如果您的两个样本中的案例都出现在同一个数据框中，那么一列将是样本成员资格的指示变量。我们称之为 IndSample。Wilcoxon 是单变量检验，因此您将有另一列包含您正在测试的响应值。我们称它为 Y。然后你写

```
wilcox.test(y ~ IndSample, data=MyData, .....) 
```

以及用于测试的其余参数：它是双面的吗？你想要一个准确的统计数据吗？（在你的情况下可能不是。）

在我看来，您的数据似乎就在我身边。这对数据框来说是有问题的，因为您不能像使用矩阵那样从数据框中拉出一行。

你需要抓住最后一行并将其变成一个因素 - 比如

```
factor(c(MyData[lastrow,])) 
```

然后拉出包含您的回复的行：

```
Y <- as.numeric(c(MyData[ResponseRow,])) 
```

然后做wilcoxon。

但是，我不确定我是否正确理解了您的情况。对于适度的 wilcoxon 测试，这似乎是一个非常大的数据矩阵。

# loops - 一旦进入无限循环，如何终止从 Sublime Text 2 终端运行的程序？

> ID：14780818
> 
> 赞同：21
> 
> 时间：2013-02-08T20:29:08.877
> 
> 标签：loops, sublimetext2, infinite-loop, sublimetext

即使我关闭了 sublime，这个过程也会继续进行，因为我的笔记本电脑一直在旋转，直到几分钟后减速到爬行。我在 mint linux 上，似乎也无法从终端终止进程。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-05-04T22:11:59.153

**执行这个命令：**

```
ps -A | grep sublime 
```

**结果示例：**

```
2547 ? 00:02:37 sublime_text 
```

**您将使用以下命令终止进程：**

```
kill -9 2547 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-06-17T14:56:55.423

```
killall sublime_text 
```

为我工作 Sublime Text 3 Ubuntu 16.04

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-13T18:28:08.393

```
$ ps aux | grep Sublime
bibhas   646   0.0  4.2  3489812 177340   ??  S    Fri08PM  29:17.03 /Applications/Sublime Text 2.app/Contents/MacOS/Sublime Text 2 -psn_0_487543
$ sudo kill -9 646 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-12-16T22:26:34.310

在 MAC 上：

`kill -9 $(pgrep Sublime)`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-18T03:45:38.630

一种简单而残酷的方法是杀死程序正在运行的进程。例如，如果您正在运行 java 程序，则使用`$killall java`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-05T14:36:49.770

在 MAC 上：

首先你必须杀死进程，然后删除所有会话

```
1) kill -9 $(pgrep Sublime)
2) sudo rm /Users/YOUR----NAME----HERE/Library/Application\ Support/Sublime\ Text\ 3/Local/Auto\ Save\ Session.sublime_session 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-25T14:33:31.260

对于那些在 MAC 上通过 iTerm 使用 fishshell（可能对 zsh 有帮助）的人：

```
kill -9 (pgrep Sublime) 
```

# ruby-on-rails - Rails 中的表单选择字段选项数组。铁轨方式

> ID：14780820
> 
> 赞同：0
> 
> 时间：2013-02-08T20:29:30.610
> 
> 标签：ruby-on-rails, ruby, forms, select, options

这是一个简单的问题，但我很难找到答案。我的表单中有一个选择字段，我想根据我的查询记录数构建选项数组。

我在我的控制器中得到我的计数：

```
@num_pages= Page.where(:site_id => @siteid).count 
```

我希望我的选项数组就像 {["1", 1], ["2", 2], ...} 一直到@num_pages。

现在**我知道**我可以做一个循环并构建该数组，但我想知道是否有更多**“rails”**的方式来做到这一点。这样我的选择代码仍然可以像这样简单：

```
<%= select_tag(:nav_order, options_for_select(@num_pages)) %> 
```

...不使用循环和数组推送以及你有什么。

更新

感谢回复，我的代码现在可以这样工作。但是，我决定将映射保留在视图中而不是控制器中。

```
<% options_array = (1..@page_count).to_a.collect{|p| ["#{p}", p]} %>  
<%= select_tag(:nav_order, options_for_select(options_array)) %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:37:37.627

如果我正确理解了您的问题，我认为这应该可以解决问题：

```
Array.new(@num_pages){ |i| [(i+1).to_s, i+1] } 
```

带有数字和输出的示例：

```
irb(main):001:0> Array.new(5){ |i| [(i+1).to_s, i+1] }
=> [["1", 1], ["2", 2], ["3", 3], ["4", 4], ["5", 5]] 
```

不确定这是否是“rails”方式，但我认为这很简单:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:44:32.303

在控制器中构建数组？

```
num = Page.where(:site_id => @siteid).count
@num_pages = (1..num).to_a.collect{|p| ["#{p}", p]} 
```

# c# - 尝试使计算属性与 Entity Framework 配合得很好

> ID：14780821
> 
> 赞同：1
> 
> 时间：2013-02-08T20:29:34.100
> 
> 标签：c#, entity-framework

这是我正在使用的类的简化版本：

```
public class Parent
{
    public int Id { get; set; }
    public List<Child> Children { get; set; }
    public int ChildrenSum { get { return Children.Sum(c => c.Value); } }
}

public class Child
{
    public int Id { get; set; }
    public int Value { get; set; }
    public Parent Parent { get; set; }
}

public class TestDbContext : DbContext
{
    public DbSet<Parent> Parents { get; set; }
    public DbSet<Child> Children { get; set; }
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Child>().HasRequired(e => e.Parent);
        modelBuilder.Entity<Parent>().HasMany(e => e.Children);
    }
}

public class TestDbContextInitializer : DropCreateDatabaseAlways<TestDbContext>
{
    protected override void Seed(TestDbContext context)
    {
        var parent = new Parent { Children = new List<Child>() };
        parent.Children.Add(new Child { Value = 3 });
        parent.Children.Add(new Child { Value = 1 });
        parent.Children.Add(new Child { Value = 2 });
        context.Parents.Add(parent);
    }
} 
```

当我让一切运行时，所有种子信息都在数据库中，但是 ChildrenSum 属性失败，因为孩子们没有被急切地加载。这是我的期望，因为我没有将导航属性设为虚拟。我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:00:29.663

当您创建导航属性时`virtual`，您会启用延迟加载。你说得对。但在这种情况下，延迟加载的反面不是急切加载。它是“除非*您*进行加载，否则不会加载”。

因此，您要么必须启用延迟加载，要么使用[`Include`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbextensions.include%28v=vs.103%29.aspx). 或者做类似的事情

```
db.Entry(parent).Collection(p => p.Children).Load(); 
```

where`db`是一个`TestDbContext`实例和`parent`一个获取的`Parent`对象。

# android - 将应用程序图像存储在内部存储与外部存储中

> ID：14780823
> 
> 赞同：2
> 
> 时间：2013-02-08T20:29:37.673
> 
> 标签：android, storage, external, internal

我正在编写一个 android 应用程序，最终用户将在其中捕获图片。通常，我会将应用程序数据（价值几 KB）存储在内部存储器中。但是在这里，这些图片每张都达到 450K，而且可能有好几张。

由于内部存储空间有限，将这些图像存储在那里是个好主意还是应该使用外部存储空间？我只是在这里寻找最佳实践建议。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:35:10.820

这取决于您的应用程序功能以及图像的大小。

存储在外部存储上更好地节省内部存储空间，但您应该注意外部存储并不总是可用（例如，当 USB 在文件传输模式下连接时）所以您需要先检查它是否已挂载，这里是一个示例帮助函数

```
public boolean isExternalStorageMounted() {
    String state = Environment.getExternalStorageState();
    if (Environment.MEDIA_MOUNTED.equals(state)) {
        return true;
    }
    return false;
} 
```

此外，如果您希望在卸载应用程序时删除文件，则应避免在 SD 卡上创建独立文件夹，应使用`getExternalFilesDir()`可以保存图像的目录，卸载应用程序时将删除该目录。

# scala - 在 Scala 中调用的这种特殊语法是什么

> ID：14780834
> 
> 赞同：0
> 
> 时间：2013-02-08T20:30:26.127
> 
> 标签：scala

我正在为不耐烦的人浏览 Scala，但不幸的是，它假设了以前的 Java 经验并了解如何`[T]`在这里使用：

```
object Iterables {
   def filter[T](unfiltered: Iterable[T], predicate: T => Boolean): Iterable[T] = {...}
   def find[T](iterable: Iterable[T], predicate: T => Boolean): T = {...}
} 
```

`[T]`和的每个实例的语法在`T`这里都非常混乱。直接列在函数名之后有什么意义，比如`filter[T]`. 我在参数列表中了解，我们正在寻找一个 Iterable 类型`T`。但是如果 T 是一个类型，那是什么`predicate: T => Boolean`意思呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:33:50.143

本声明：

```
def filter[T](unfiltered: Iterable[T], predicate: T => Boolean): Iterable[T] 
```

可以读作如下：对于任何类型，`T`此函数接受`Iterable`该类型以及从该类型到的函数`Boolean`。最后它返回`Iterable`相同的类型。

*上面的那个类型*基本上意味着：你可以用`Iterable[String]`, `Iterable[Date]`,调用这个函数`Iterable[Foo]`- 你明白了。但无论您选择哪种类型，它必须在所有地方都相同。例如：

```
val result = filter(List("a", "bb", "ccc"), (s: String) => s.length() > 1) 
```

是正确的。但这不是：

```
val result: Seq[Int] = filter(List("a"), (s: String) => s.length() > 1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T11:23:43.830

**类型参数方法**

scala 中的方法可以接受一个或多个s ，`type parameter`就像 a或一样。`class``object``trait`

在这种情况下，这意味着可以为一个类型调用相同的方法，该类型`T`可能因调用而异，但必须在定义中保持一致。

让我们使用例如

```
def filter[T](unfiltered: Iterable[T], predicate: T => Boolean): Iterable[T] 
```

该方法希望您传递：
- an `Iterable`of `T`s ( `unfiltered`)
- 一个将 a 转换`T`为 a `Boolean`( `predicate`)的函数，
结果将是另一个`Iterable`s `T`。

然后该方法将在`unfiltered`对象上进行迭代，并为每个元素应用`predicate`, 来决定是否必须对其进行过滤。

结果`Iterable`仅包含满足的元素`predicate`（即`t`返回的元素`predicate(t)`）`true`

您可以为任何类型调用过滤器`T`，但约束条件是所有参数和结果类型必须保持一致。

**例子**

```
//filtered is List(2,3)
val filtered: Iterable[Int] = filter(List(1, 2, 3), (i: Int) => i > 1) 

//filtered is List("b", "abc")
val filtered: Iterable[String] = filter(List("a", "b", "abc"), (s: String) => s contains "b") 

//filtered is List(Some(1), Some(2))
val filtered: Iterable[Option[Int]] = filter(List(Some(1), Some(2), None), (op: Option[Int]) => op.isDefined)

//you can't call this because T is not the same everywhere it's used
val filtered: Iterable[Int] = filter(List(1, 2, 3), (op: Option[Int]) => op.isDefined)

//this will get you
<console>:12: error: type mismatch;
 found   : Option[Int] => Boolean
 required: Int => Boolean
           val filtered: Iterable[Int] = filter(List(1, 2, 3), (op: Option[Int]) => op.isDefined) 

                                                                             ^ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T09:36:23.317

它被称为*泛型方法*。

（在 java、C# 和 C++ 中也有类似的功能（调用它的地方是*模板函数*））

# python - Python IDLE 无法运行

> ID：14780835
> 
> 赞同：0
> 
> 时间：2013-02-08T20:30:26.430
> 
> 标签：python, process, command, python-idle

前段时间，我在 python 中编写了一个脚本，其中包含许多命令提示符语法……我不小心创建了一个无限循环，结果搞砸了。每次我尝试通过 IDLE 测试任何脚本时，它都会不断打开和关闭命令提示符窗口，直到我从 taskmgr 手动终止进程......在命令行中运行脚本工作正常......

那么我该如何解决呢？

# javascript - 包括 javascript 到谷歌网站

> ID：14780838
> 
> 赞同：6
> 
> 时间：2013-02-08T20:30:38.210
> 
> 标签：javascript, google-sites, html-box-gadget

我正在尝试在 Google 协作平台中包含一个简单的 javascript，但按下按钮时我什么也得不到。我将代码放在 HTML Box 中。该代码在本地测试时完美运行。这是我的代码：

```
<script>
  function calcul(){
    x = parseFloat(document.getElementById("value1").value);
    y = parseFloat(document.getElementById("value2").value);
    document.getElementById("answer").innerHTML=x+y;
  }
</script>

<form action="" id="nothing">
  <input type="text" id="value1">
  <input type="text" id="value2">
<input type="button" value="Calculate" id="but" onclick="calcul()" />

<p id="answer"></p> 
```

有什么我忘了让它工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:44:13.277

Google 协作平台会更改您的整个脚本。您必须更加小心地编写 JavaScript。

`var`在每个变量前面添加将解决您的问题：

```
<script>
  function calcul(){
    var x = parseFloat(document.getElementById("value1").value);
    var y = parseFloat(document.getElementById("value2").value);
    document.getElementById("answer").innerHTML=x+y;
  }
</script>

<form action="" id="nothing">
  <input type="text" id="value1">
  <input type="text" id="value2">
  <input type="button" value="Calculate" id="but" onclick="calcul()" />
</form>

<p id="answer"></p> 
```

这将起作用;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:50:40.473

Google 协作平台会过滤掉它认为不安全的操作。[这里](http://www.mydigitallife.info/how-to-add-javascript-or-custom-contents-to-google-sites-with-gadget/)有一些细节，但无法通过快速搜索找到官方文档。

正如另一个答案所提到的，您的变量需要`var`声明。这是必需的，因为如果没有这个，变量将成为窗口的全局变量，并且可能用于逃避 Google 在站点 javascript 支持周围放置的任何沙箱，从而可能导致安全问题。

所以要修复：

```
var x = parseFloat(document.getElementById("value1").value);
var y = parseFloat(document.getElementById("value2").value); 
```

# ruby-on-rails - 在 Rails 视图中可以访问哪些变量？

> ID：14780840
> 
> 赞同：0
> 
> 时间：2013-02-08T20:30:55.890
> 
> 标签：ruby-on-rails

在 Rails 视图中（无论是 erb 还是 html 或其他），视图中有可访问的 ruby​​ 变量。什么定义了视图的范围？是在被调用的控制器函数范围内的任何变量吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:33:16.810

它是在您的控制器中声明的任何实例变量以及可以通过 before_filter 在您的应用程序控制器中设置的任何实例变量。

# javascript - 在上传之前从 uploadify 队列中获取文件名

> ID：14780842
> 
> 赞同：0
> 
> 时间：2013-02-08T20:31:03.520
> 
> 标签：javascript, jquery, uploadify

这个问题不是[这个问题](https://stackoverflow.com/questions/3440295/get-file-names-from-uploadify-jquery-plugin)的重复。

我试图在上传之前从上传队列中获取文件名，所以我可以在表单中显示这些名称。检查文档，他们谈了很多关于如何在上传后管理此类信息，但我之前找不到如何去做。

已经尝试访问它认为脚本使用的输入，`$('#file_upload').val()`但无论如何，即使在选择了一些文件之后，我也得到了一个空值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:35:56.317

[onSelect](http://www.uploadify.com/documentation/uploadify/onselect/)事件怎么样？

```
$("#file_upload").uploadify({
    'swf'      : '/uploadify/uploadify.swf',
    'uploader' : '/uploadify/uploadify.php',
    'onSelect' : function(file) {
        alert('The file ' + file.name + ' was added to the queue.');
    }
}); 
```

# cordova - 电话间隙和地理围栏

> ID：14780845
> 
> 赞同：0
> 
> 时间：2013-02-08T20:31:11.950
> 
> 标签：cordova, geolocation

一个客户让我在phonegap中构建一个App，原理是用户的地理位置会触发一个特定的问卷。而正确的答案将产生一个新的位置去和新的位置一个新的问卷等......

有没有办法在phonegap中做到这一点，或者它是一个原生的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T04:26:29.660

您可以在 PhoneGap 中执行此操作。您需要调用[Geolocation.watchPosition](http://docs.phonegap.com/en/2.3.0/cordova_geolocation_geolocation.md.html#geolocation.watchPosition)来跟踪您所在的位置。在 watchPosition 的成功回调中，您会将结果与您期望的位置进行比较。

# c - 枚举和结构的声明

> ID：14780849
> 
> 赞同：0
> 
> 时间：2013-02-08T20:31:24.440
> 
> 标签：c, c89

我编写了一些文件：main.c、functions.c、functions2.c 和 header.h。functions.c 和 functions2 中的一些函数使用了我的一些枚举和结构。

我必须在哪里放置我的枚举和结构？如何在functions.c 和functions2.c 中为它们编写声明？我的功能（来自不同的文件）必须看到它们。

例如，我在 header.h 中编写了这样的函数声明：

```
int func(void);
void func2(int); 
```

但我不知道它是如何为枚举和结构编写的。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:38:30.547

functions.c 的示例：

```
#include "header.h"

int func(void)
{
 ...
}

void func2(int)
{

} 
```

header.h 的示例：

```
#ifndef HEADER_H
#define HEADER_H

int func(void);
void func2(int);

enum eMyEnum
{
 eZero = 0,
 eOne,  
 eTwo
};

struct sMyStruct
{ 
 int i;
 float f;
};

#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:39:42.900

**声明结构：**

```
typedef struct <optional struct name>
{
   int    member1;
   char*  member2;

} <struct type name>; 
```

将您想要的任何成员以上述格式放入结构中，并使用您想要的任何名称。然后你使用：

```
<struct type name> my_struct; 
```

声明结构的实例。

**声明枚举：**

```
typedef enum
{
    value_name,
    another_value_name,
    yet_another_value_name

} <enum type name>; 
```

将任何值放在上面的枚举中，使用您想要的任何名称。然后你使用：

```
<enum type name> my_enum; 
```

声明枚举的实例。

# java - 从 3.1.2 升级到 3.2.1.Release，无法解析 @repository 和 getJdbcTemplate

> ID：14780850
> 
> 赞同：0
> 
> 时间：2013-02-08T20:31:26.347
> 
> 标签：java, spring, spring-mvc

我刚刚更新了我的 pom.xml 引用以获取最新版本的 spring，现在我的代码中出现了**@Transaction 和 @Repository**引用的错误。

我添加了 spring-tx 哪些接缝来修复我的 @transaction 引用，但是 @repository 现在在哪里？

我无法弄清楚的其他错误是：

**getJdbcTemplate 似乎没有解决。RowMapper 也无法解决。**

这些搬到哪里去了？

为什么会发生这种变化？如果所有注释都在一个 Maven 存储库中，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:51:03.037

对于@Repository，请在 pom.xml 中添加以下内容：-

```
<dependency>
<groupId>org.springframework</groupId>
<artifactId>spring-context</artifactId>
<version>3.2.1.RELEASE</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:53:04.810

您可以在 spring-jdbc jar 下找到 jdbc 方法和行映射器类，并且应该为 @Repository 注释添加 spring-context jar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:52:16.970

`org.springframework.stereotype.Repository`在`spring-context`（从 2.0 开始）。`getJdbcTemplate`显然是一种方法。你期待它在哪一堂课？

# sql - 希望使用 ISNULL 函数来检查图像是否处于活动状态，否则选择最大值

> ID：14780851
> 
> 赞同：2
> 
> 时间：2013-02-08T20:31:30.990
> 
> 标签：sql, select, case, isnull

如果图像被标记为活动并且有人点击链接，他们应该被带到活动图像，否则他们应该被带到（MAX）最近上传的图像。我的第一个选择有效，但不完全有效。

这是我的选择：

```
 select
    b.image_id, b.active, c.id as event_id
from event.dbo.lite() a
left outer join event.dbo.dia_tracker b on a.code = b.patient_id 
    and image_id = (select max(image_id) from event.dbo.dia_tracker where patient_id = {$patient->hex})
left outer join event.dbo.ev c on a.code = c.patient_id and c.task_id in ('WR','RC') and c.status<>0
where a.code = {$patient->hex} 
```

这是我需要一些帮助的新选择。

```
select 
    image_id, 
    active,
    case when active <>1 than image_id = (select max(image_id) from event.dbo.dia_tracker where patient_id = 'DSMA')
from event.dbo.dia_tracker

where active = '1' and image_id = (select max(image_id) from event.dbo.dia_tracker where patient_id = 'DSMA') 
```

自动取款机有点乱。我在想我可以使用 isnull 以更少的代码行完成更多工作。

更新：

```
select 
    *,
    ISNULL(active,image_id) as  image
from event.dbo.dia_tracker

    where active = '1' and image_id = (select max(image_id) from event.dbo.dia_tracker where patient_id = 'DSMA') 
```

仍然需要帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:44:34.927

如果 active = 1，则子查询正在分组并将结果带到活动图像，否则为最新图像。

```
select *, t1.image_id as  image
from event.dbo.dia_tracker t1
WHERE EXISTS (select 1
              from event.dbo.dia_tracker t2                      
              where t2.patient_id = 'DSMA'
              group by case when t2.active = '1' then t2.image_id end
              having MAX(t2.image_id ) = t1.image_id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:24:14.157

如果您发布所有相关的 DDL 和示例数据会容易得多，但您可以尝试这样的事情来获取您的`image_id`

```
SELECT COALESCE(
  (SELECT image_id FROM dia_tracker WHERE patient_id = 'DSMA' AND active=1), 
  (SELECT MAX(image_id) FROM dia_tracker WHERE patient_id = 'DSMA')
) AS image_id 
```

如果它 ( `image_id`) 唯一标识您要查找的行，您可以尝试

```
SELECT * FROM dia_tracker
WHERE image_id = (SELECT COALESCE(
  (SELECT image_id FROM dia_tracker WHERE patient_id = 'DSMA' AND active=1), 
  (SELECT MAX(image_id) FROM dia_tracker WHERE patient_id = 'DSMA')
) AS image_id) 
```

# scope - 如何在 Sublime Text 2 中为片段定义自定义范围？

> ID：14780854
> 
> 赞同：2
> 
> 时间：2013-02-08T20:31:45.673
> 
> 标签：scope, sublimetext2, code-snippets

我有以下片段：

```
<snippet>
    <content><![CDATA[
{{#_}}${1:$SELECTION}{{/_}}
]]></content>
    <tabTrigger>i18n</tabTrigger>
    <!-- What can I put in scope? -->
    <scope>text.handlebars</scope>
</snippet> 
```

但我只希望它在以“.handlebars”结尾的文件中可用。我想这样做是因为我想为几种不同的文件类型重载 i18n 选项卡触发器。现在，我坚持为这种特殊情况重命名选项卡触发器。

这个问题对现有范围非常有用： [Defining scope for custom Sublime Text 2 snippets](https://stackoverflow.com/questions/13922174/defining-scope-for-custom-sublime-text-2-snippets)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:05:18.337

对于您的车把示例，[nrw / sublime-text-handlebars](https://github.com/nrw/sublime-text-handlebars)使用`text.html.handlebars`. 您需要*Handlebars.tmLanguage*文件来获得语法。

*编辑*：范围名称由`scopeName`语法的 tmLanguage 文件中的键定义。再次以您的示例为例，*Handlebars.tmLanguage*的第 681 行：

```
<key>scopeName</key>
<string>text.html.handlebars</string> 
```

要创建您自己的语法定义，请参阅[此非官方文档文章](https://sublime-text-unofficial-documentation.readthedocs.org/en/latest/reference/syntaxdefs.html)。 `scopeName`设置应用于片段定义中范围键的值。

# sql - SQL查询未向数据库插入正确的值

> ID：14780856
> 
> 赞同：0
> 
> 时间：2013-02-08T20:31:52.247
> 
> 标签：sql, sql-server, database

下面是 SQL 语句：

```
SQL = "INSERT INTO MYIMAGES(image_blob, filename, description, filesize, accountnum, rmanum, billol, copiedfilename) VALUES(?, '"
SQL = SQL & File.Filename & "', '"
SQL = SQL & Replace(Upload.Form("DESCR"), "'", "''") & "', '"
SQL = SQL & File.Size & "', '"
SQL = SQL & Replace(Upload.Form("accountnum"), "'", "''") & "', '"
SQL = SQL & Replace(Upload.Form("rmanum"), "'", "''") & "', '"
SQL = SQL & Replace(Upload.Form("billol"), "'", "''") & "', "
SQL = SQL & Replace(Upload.Form("accountnum"), "'", "''") & "-" & Replace(Upload.Form("rmanum"), "'", "''") & ")" 
```

accountnum = 3456345 rmanum = 345234

输入的数据库中的值是`3111111`我想要的`3456345-345234`

该列的数据类型是`varchar(255)`- 我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:38:31.850

如果您使用 sql 参数，您可以避免`REPLACE`任何 sql 注入

前任：

将sql语句更改为

```
INSERT INTO MYIMAGES(image_blob, filename, description, filesize, 
   accountnum, rmanum, billol, copiedfilename) 
VALUES(@p1, @p2, @p3,@p4,@p5, @p6, @p7,@p8) 
```

然后做

```
cmd.Parameters.AddWithValue("@p2",File.Filename)
cmd.Parameters.AddWithValue("@p3",Upload.Form("DESCR")) 
```

……

```
//this will insert correct data
cmd.Parameters.AddWithValue("@p8",Upload.Form("accountnum") & "-" & 
                                  Upload.Form("rmanum")) 
```

根据 OP 评论更新：对于 ASP 试试这个

```
dim cmd, rs, param1, param2, param3, param4, param5,param6, param7, param8
set cmd = server.CreateObject("adodb.command")
strCmd = "INSERT INTO MYIMAGES(image_blob, filename, description, 
            filesize, accountnum, rmanum, billol, copiedfilename)
            VALUES(?,?,?,?,?,?,?,?)"
Set cmd.ActiveConnection = objConn
cmd.CommandText = strCmd
cmd.CommandType = adCmdText
Set param1 = cmd.CreateParameter ("image_blob", adWChar, adParamInput, 50)
param1.value = image_blob
cmd.Parameters.Append param1
....
Set param8 = cmd.CreateParameter ("copiedfilename", adWChar, adParamInput, 50)
param8.value = Upload.Form("accountnum") & "-" & Upload.Form("rmanum")
cmd.Parameters.Append param8
Set rs = cmd.Execute() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:37:19.847

尝试这个：

```
SQL = "INSERT INTO MYIMAGES(image_blob, filename, description, filesize, accountnum, rmanum, billol, copiedfilename) VALUES(?, '"
SQL = SQL & File.Filename & "', '"
SQL = SQL & Replace(Upload.Form("DESCR"), "'", "''") & "', '"
SQL = SQL & File.Size & "', '"
SQL = SQL & Replace(Upload.Form("accountnum"), "'", "''") & "', '"
SQL = SQL & Replace(Upload.Form("rmanum"), "'", "''") & "', '"
SQL = SQL & Replace(Upload.Form("billol"), "'", "''") & "', '"
SQL = SQL & Replace(Upload.Form("accountnum"), "'", "''") & "-" & Replace(Upload.Form("rmanum"), "'", "''") & "')" 
```

我刚刚将 ' 放在最后一个值的开头和结尾，这样它就不会被解释为数学表达式

这是：

```
3456345-345234 = 3111111 
```

# html - 逃脱 在 HTML 中，标签和实体不在 那应该这样做。更多描述也可以帮助给出更好的答案:) html 4 4 回答 4 This answer is useful 23 我来这里是为了寻找一种在 JavaScript 代码中普遍转义的方法。 经过一番研究，我发现如果你试图在 JavaScript 代码中转义，以便它可以安全地嵌入到 html标记之间，你应该而是会像结束你的脚本一样。 抱歉，它对 OP 没有任何帮助。接受的答案是绝对正确的，您需要知道哪些构造在您的内部语言中是合法的，才能知道如何在不中断代码的情况下避免发生。 于 2014-06-01T19:11:17.713 回答 This answer is useful 9 HTML 规范详细解释了允许的内容以及如何安全地转义内容。尤其是考虑到 HTML 的历史，这是一项不平凡的任务。 从 HTML 规范： 避免本节中描述的相当奇怪的限制的最简单和最安全的方法是，<!--当这些序列<\!--出现在脚本中的文字中（例如，在字符串中、正则表达式或注释），并避免编写在表达式中使用此类结构的代码。这样做可以避免本节中的限制容易触发的陷阱：即，由于历史原因，在 HTML 中解析脚本块是一种奇怪而奇特的做法，在面对这些序列时会产生不直观的行为。<script<\script</script<\/script 来源：https ://www.w3.org/TR/html52/semantics-scripting.html#restrictions-for-contents-of-script-elements 于 2018-10-09T18:10:44.137 回答 This answer is useful 8 在 HTML 中，与 XHTML 相反，script元素的内容被处理为纯文本，除了出现结束标记，因此。没有通用的机制来避免这种情况。任何绕过此功能的方法都不可避免地依赖于元素内部使用的“语言”。“语言”这个词在这里用引号引起来，因为内容可以是任何东西，只要你的代码可以解析和处理它。 所以：没有通用机制，但对于 JavaScript 或某些浏览器识别的少数其他客户端脚本语言之外的内容，您可以制定自己的规则。 于 2013-02-08T21:13:57.407 回答 This answer is useful 0 更多的 HTML 编码可能会有所帮助？<对于<. 很难知道你在用它做什么。如果您不确定脚本标签之间的内容可能是什么（看起来您可能正在尝试将其用作某种模板持有者？）那么您可以/应该使用 CDATA 部分：  那应该这样做。更多描述也可以帮助给出更好的答案:) 于 2013-02-08T20:37:30.980 回答 Related 1 c# - 设置基本游戏和调试基本问题 1 python - 为什么描述符（在 Python 中）不能插入（放置）在已经初始化的对象中？ 2 android - 如何冻结有根安卓设备上的应用程序 4 ios - 从对象数组中检索元素时出现问题 - 目标 C 2 c# - sql查询经纬度 6 sql - oracle中的全外连接 1 jquery - jquery表单高级表单克隆 2 php - 使用贝宝接收付款 1 c# - 在框架中启动的应用程序标志 1 bash - 如何重定向标准输入或阻止键盘输入？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14780858
> 
> 赞同：17
> 
> 时间：
> 
> 标签：html

在 HTML 中，标签和实体不在`<script>`标签内解析，而是`</`立即结束标签。因此，

```
<script><b>fun &amp; things</ 
```

会给你一个包含确切内容的脚本标签`<b>fun &amp; things`。

如果您包含 JSON 并且希望`</`在脚本中包含字符，则可以将其替换为，`<\/`因为这些字符出现的唯一位置是字符串，并且`\/`是一个转义序列，会变成单个正斜杠。

但是，如果您不使用 JavaScript，则此技巧不起作用。就我而言，我正在尝试将 a`<script type="math/tex">`插入源代码，以便[MathJax](http://www.mathjax.org/)对其进行处理。有没有办法`</`在原始 HTML 源中转义？（我没有特别需要，`</`但我正在编写一个通用工具，并希望可以使用任何文本。）

（可以在 JavaScript 中创建 script 标签并填充它`innerText`，但我正在使用原始 HTML，所以我不能这样做。）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-06-01T19:11:17.713

我来这里是为了寻找一种`</script>`在 JavaScript 代码中普遍转义的方法。

经过一番研究，我发现如果你试图`</script>`在 JavaScript 代码中转义，以便它可以安全地嵌入到 html`<script>`和`</script>`标记之间，你应该`</script`用`</scr\ipt`or替换`</scri\pt`。这样做更安全，因为如果将其替换为`<\/script`可能会破坏 JavaScript 代码，如下所示：`var q = -1</script/.test("script");`

小心不要寻找，`</script>`而是`</script`因为`</script asdasdas>`会像结束你的脚本一样`</script>`。

抱歉，它对 OP 没有任何帮助。接受的答案是绝对正确的，您需要知道哪些构造在您的内部语言中是合法的，`<script></script>`才能知道如何在`</script>`不中断代码的情况下避免发生。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-10-09T18:10:44.137

HTML 规范详细解释了允许的内容以及如何安全地转义内容。尤其是考虑到 HTML 的历史，这是一项不平凡的任务。

从 HTML 规范：

> 避免本节中描述的相当奇怪的限制的最简单和最安全的方法是，`&lt;!--`当这些序列`&lt;\!--`出现在脚本中的文字中（例如，在字符串中、正则表达式或注释），并避免编写在表达式中使用此类结构的代码。这样做可以避免本节中的限制容易触发的陷阱：即，由于历史原因，在 HTML 中解析脚本块是一种奇怪而奇特的做法，在面对这些序列时会产生不直观的行为。`&lt;script``&lt;\script``&lt;/script``&lt;\/script`

来源：[https ://www.w3.org/TR/html52/semantics-scripting.html#restrictions-for-contents-of-script-elements](https://www.w3.org/TR/html52/semantics-scripting.html#restrictions-for-contents-of-script-elements)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-08T21:13:57.407

在 HTML 中，与 XHTML 相反，`script`元素的内容被处理为纯文本，除了出现结束标记，因此`</`结束处理并且必须在符合文档的情况下开始结束标记`</script>`。没有通用的机制来避免这种情况。任何绕过此功能的方法都不可避免地依赖于元素内部使用的“语言”。“语言”这个词在这里用引号引起来，因为内容可以是任何东西，只要你的代码可以解析和处理它。

所以：没有通用机制，但对于 JavaScript 或某些浏览器识别的少数其他客户端脚本语言之外的内容，您可以制定自己的规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:37:30.980

更多的 HTML 编码可能会有所帮助？`&lt;`对于`<`.

很难知道你在用它做什么。如果您不确定脚本标签之间的内容可能是什么（看起来您可能正在尝试将其用作某种模板持有者？）那么您可以/应该使用 CDATA 部分：

```
<script><![CDATA[<b>fun &amp; things</b>]]></script> 
```

那应该这样做。更多描述也可以帮助给出更好的答案:)

# image - Drupal ImageCache 动作特性？

> ID：14780859
> 
> 赞同：0
> 
> 时间：2013-02-08T20:31:59.083
> 
> 标签：image, drupal, drupal-modules

我正在尝试在 Drupal 站点上创建滚动图像列表。[与本页](http://iudm.org/)底部的类似。这是 Drupal ImageCache Action 的一个特性吗？如果没有，我将如何做到这一点是 Drupal？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T21:15:30.730

imagecache 的目的是根据需要提供不同大小的图像。这对于像这里这样的缩略图显示通常很有用：[http ://www.ifood.tv/recipes](http://www.ifood.tv/recipes)

根据您的要求使用此模块：[http ://drupal.org/project/jcarousel](http://drupal.org/project/jcarousel)

# r - 修复轴标签中的排版

> ID：14780860
> 
> 赞同：20
> 
> 时间：2013-02-08T20:31:59.430
> 
> 标签：r, plot, typography

序言：我想从 R 创建出版级图形而不进行后处理。我研究所的其他研究人员总是在图形软件（如 Adob​​e Illustrator）中进行后处理。我希望避免这种情况。

我的抱怨是 R 没有对负数使用正确的减号（尤其是在绘图轴中）：

```
plot(-20:-1, rnorm(20) + 1 : 20) 
```

![用负数绘制](../Images/b29bf7e48ced61131d7fc174edfe5a15.png)

（我已经圈出违规者供您考虑。）

作为一个排版书呆子（这是真的！检查我的职业简历！）这是不可接受的。我需要在这里使用正确的 Unicode 字符 ᴍɪɴᴜꜱ ꜱɪɢɴ (U+2212, “−”)。我的一个朋友通过在发布之前替换 Adob​​e Illustrator 中的所有减号来实现这一点，但我不禁认为必须有更好的方法——从 R 中——来实现这一点；并且*不会*强迫我手动替换所有轴标签。

（我目前没有使用 ggplot2 但如果有一个仅适用于 ggplot2 的解决方案，我会很乐意接受。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T20:55:30.447

也许手动绘制轴和标签，而不是接受默认值？

```
plot(-20:-1, rnorm(20) + 1 : 20, xaxt="n")
Axis(-20:-1, at=seq(-20,-5,5), side=1,
  labels=paste("\U2212",seq(20,5,-5),sep="")) 
```

![在此处输入图像描述](../Images/5f30ce3bbf486d6f142c78babfb15008.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-23T16:30:02.857

这是使用ggplot的方法。该`pdf`设备不呈现 unicode 符号，因此请`cairo_pdf`改用。

```
unicode_minus <- function(x) sub('^-', '\U2212', format(x))

# change the default scales
scale_x_continuous <- function(..., labels=unicode_minus)
                        ggplot2::scale_x_continuous(..., labels=labels)
scale_y_continuous <- function(..., labels=unicode_minus)
                        ggplot2::scale_y_continuous(..., labels=labels)

qplot(-20:-1, rnorm(20) + 1:20) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-08T21:34:28.257

另一种方法与 Joshua Ulrich 提供的方法几乎相同，只是您可以让 R 计算轴刻度：

```
plot(-20:-1, rnorm(20) + 1 : 20, xaxt="n")
at <- axTicks(1, usr=par("usr")[1:2])
labs <- gsub("-", "\U2212", print.default(at))
axis(1, at=at, labels=labs) 
```

![在此处输入图像描述](../Images/839fa49afbfd7d76f17ce9028f487dcc.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-09T03:44:33.287

这是一个修复**格子**图轴标签的技巧。`panel.axis()`这个想法是在大多数/所有高级绘图函数调用的 低级函数中插入代码。

这里（上面和下面有几行上下文）是您将在调用之后“手动”插入的代码`library(lattice); trace("panel.axis", edit=TRUE)`：

```
if (draw.labels && !is.null(labels)) {
    {
        labels <- gsub("-", "\U2212", labels)  ## <- My addition
        Encoding(labels) <- "UTF-8"            ## <- My addition
        just <- if (outside) 
            switch(side, bottom = if (rot[1] == 0) c("centre", 
```

一个更好的选择（一旦你猜到了`at=`参数的正确值（[并在这里查看几种方法来做到这一点](https://stackoverflow.com/questions/11319161/what-is-a-fast-way-to-set-debugging-code-at-a-given-line-in-a-function)））是运行这个：

```
library(lattice)

trace(what = "panel.axis",
      tracer = quote({labels <- gsub("-", "\U2212", labels)
                      Encoding(labels) <- "UTF-8"}),
      at = list(c(30,3,2,2))) 
```

在我检查过的许多屏幕或文件图形设备中的任何一个上都会打印刻度标签中的正确减号

要在您自己的屏幕设备上进行比较，请直接运行上面的代码块，然后：

```
xyplot(1:10 ~ -1:-10)
untrace("panel.axis")
windows()
xyplot(1:10 ~ -1:-10) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-03T13:21:15.963

新包装[标志](https://cran.r-project.org/web/packages/signs/readme/README.html)完全符合 OP 的要求。这是网站上的一个例子：

```
library(dplyr)
library(ggplot2)
library(ggrepel)

theme_set(theme_gray())
theme_update(panel.grid.minor = element_blank())

p <- 
  ggplot(sleep) +
  aes(group, extra) +
  geom_point() +
  xlab("Drug") +
  ylab("Extra Sleep (hours)")

label_hours <- function(mapping) {
  geom_text_repel(
    mapping,
    nudge_x       = -.1,
    direction     = "y",
    segment.size  = .4,
    segment.color = "grey75",
    hjust         = "right"
  )
}

p +
  label_hours(
    mapping = aes(
      label = case_when(
        group == 1 ~ signs(extra, accuracy = .1), # Unicode minuses
        group == 2 ~ number(extra, accuracy = .1) # ASCII minuses
      )
    )
  ) +
  scale_y_continuous(
    limits = c(-4, 6),
    breaks = seq(-4, 6),
    labels = signs_format(accuracy = .1) # Unicode, analogous to number_format() 
  ) 
```

![这是网站上的情节。](../Images/9413098e317c3c7c24530a192a2eefd9.png)

# html - 导航栏中的中心表单

> ID：14780865
> 
> 赞同：4
> 
> 时间：2013-02-08T20:32:16.943
> 
> 标签：html, css, twitter-bootstrap, center, navbar

我想要做的是在导航栏的中心放置搜索框（[图片在这里](http://i.imgur.com/TUBrBbr.png)）。我该怎么做？

**HTML：**

```
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">logo</a>
      <div class="nav-collapse collapse">
        <form class="navbar-form pull-right">
          <div class="input-append">
            <input class="span4" id="appendedInputButton" type="text" placeholder="Search...">
            <button class="btn" type="button">Search</button>
          </div>
        </form>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div> 
```

我正在使用 Bootstrap 附带的默认 CSS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:42:50.013

将表单元素包装在它自己的 div 中，并给它一个类或一个 id，然后创建一个自定义代码行以使其居中，例如：

HTML：

```
<div id="search">
*form code here*
</div> 
```

CSS：

```
#search { width: 200px; margin: auto; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:38:26.247

如果您需要覆盖应用程序中的内置 CSS，请使用 !important，如下所示：

```
<div style="margin: 0px auto !important;"></div> 
```

或者，把它放在你的 CSS 类中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:53:39.310

看到这个...

```
.nav-collapse{
    margin-right: 50%;
} 
```

[例子](http://jsfiddle.net/KFYyd/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-03T21:53:25.893

对于 Bootstrap 3，我也为此苦苦挣扎了很长时间。我终于找到了对我来说完美的解决方案： [Bootstrap NavBar with left, center and right aligned items](https://stackoverflow.com/questions/19733447/bootstrap-navbar-with-left-center-and-right-aligned-items) 刚刚在我的搜索框周围的导航栏中添加了一个类，使用Skelly 的答案中的 css 定义。

然后，我必须将 text-align:left 应用于表单中的某些元素（例如，附加到我的搜索表单的预输入建议）。

# html - 如何使标题覆盖整个页面长度？

> ID：14780866
> 
> 赞同：1
> 
> 时间：2013-02-08T20:32:27.283
> 
> 标签：html, css

如何使标题覆盖内容并跨越整个页面长度？当我使用这个 css

```
#header {
    display: inline-block;
    background-color: #015367;
}

#login {
    color: #b92c2c;
    font-size: 1.25em;
    margin-left: 18em;
    position: relative;
    top: 16px;
    text-decoration: none;
}

#search-form {
    margin-left: 0.5em;
    margin-right: 15em;
    position: relative;
    top: 18px;
}

.lfloat {
    float: left;
}

.rfloat {
    float: right;
} 
```

用这个 html

```
<body>
    <div id="header">
        <div id="page-nav" class="rfloat">
            <a id="login" class="lfloat" href="/login">login</a>
            <form id="search-form" class="rfloat" action="search.py" method="get">
                <input id="searchbox" type="text" name="q" placeholder="search"/>
            </form>
        </div>
    </div>
</body> 
```

我得到这个结果（在 Firefox 中） ![html+css 结果](../Images/0092522708aa35d3223a04299bc78bd3.png)

我需要更改什么以获得正确的标题（如 stackoverflow、facebook 等）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:40:14.690

既然你使用`float`了里面的元素`#header`，那么你只需要添加这个。

```
#header {
    background-color: #015367;
    overflow:hidden;
} 
```

**溢出前：隐藏**

![在此处输入图像描述](../Images/b4614a2fda58485895130f8e8f29a46a.png)

注意黑色边框，`#header`它没有包裹内容。

**溢出后：隐藏**

![在此处输入图像描述](../Images/f87857bf9b66b802ac1021e3b82373ee.png)

看看：http: [//jsfiddle.net/AliBassam/vpRc2/](http://jsfiddle.net/AliBassam/vpRc2/)

调整`top`使元素以您喜欢的方式定位，`position:relative;`这里没有用，只需使用`floats`and `margins`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:35:18.680

将此添加到您的 CSS 以将正文的边距归零：

```
body {
  margin: 0;
} 
```

见[演示](http://jsfiddle.net/zaknotzak/yPGYb/)。

我还建议您从and中删除您的`position`and`top`属性，并改用它来定位它们。`#login``#search-form``margin`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:46:20.687

内联块？？

```
#header {
    float:left;
    width:100%;
    clear:both;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:46:05.067

我怀疑您只是试图扩展标题框以包含登录表单。您遇到的效果是由于在标题标签中使用了浮动元素。浮动元素被从文档的正常流程中取出，这就是为什么父元素无法检测到它们实际占用空间的原因。

对此有一个简单的解决方法，只需在`overflow:hidden;`标题 div 的样式中添加一个。这将解决问题，但它不被认为是正确的方法。溢出并不意味着以这种方式使用。相反，我对您的建议是使用“clearfix”方法。

这是实际代码的链接：[http ://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html)

您所要做的就是将此代码作为一个类添加到标题元素中。

我希望这有帮助 ：）

# python - 字节字符串转换为 int

> ID：14780869
> 
> 赞同：4
> 
> 时间：2013-02-08T20:32:53.033
> 
> 标签：python

我想将这样的字符串转换为 int: `s = 'A0 00 00 00 63'`。最简单/最好的方法是什么？

例如`'20 01'`应该变成`8193`(2 * 16^3 + 1 * 16^0 = 8193)。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T20:34:20.303

`int()`与任何一个一起使用`str.split()`：

```
In [31]: s='20 01'

In [32]: int("".join(s.split()),16)
Out[32]: 8193 
```

或`str.replace()`将基数作为 16 传递：

```
In [34]: int(s.replace(" ",""),16)
Out[34]: 8193 
```

这里两者`split()`都`replace()`转换 `'20 01'`为`'2001'`：

```
In [35]: '20 01'.replace(" ","")
Out[35]: '2001'

In [36]: "".join('20 01'.split())
Out[36]: '2001' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:39:16.013

```
>>> s = 'A0 00 00 00 63'
>>> s = s.replace(" ","")
>>> print s
A000000063
>>> for i in xrange(0,len(s),4):
        print int(s[i:i+3],16)

2560
0
99 
```

# vba - 如何使用指向不同驱动器号的链接表分配前端

> ID：14780871
> 
> 赞同：2
> 
> 时间：2013-02-08T20:33:07.997
> 
> 标签：vba, ms-access, networking

我有一个问题，我很难为其设置合适的标题。我需要将前端分发到我们 WAN 中的多个位置。后端表将位于每个人都可以访问的特定驱动器上。

我遇到的问题是，并非每个人都拥有包含映射到相同驱动器号的后端的驱动器。Access 似乎通过路径（即 H:\tables\backend）而不是服务器名称（wvadrive1\tables\backend）来引用后端的位置。

我知道我可以通过 VB 代码引用服务器名称而不是驱动器名称，但是当通过链接表管理器/外部数据设置链接表时，似乎访问映射它基于驱动器号。

是否有一个简单的解决方案来确保我将其分发给的每个人都将他们的表格正确链接？我可以在第一次打开数据库时运行一些 VBA 来映射链接表吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:50:04.490

使用 VBA 将`TableDef.Connect`属性更改为指向文件共享（UNC 路径）而不是驱动器号。

在最简单的情况下，您的所有用户都可以使用相同的 UNC 路径，并且所有链接表都在同一个 db 文件中......

```
Const cstrUncPath As String = ";DATABASE=\\Server\ShareName\AnotherFolder\YourDb.mdb"
Dim db As DAO.database
Dim tdf As DAO.TableDef

Set db = CurrentDb
For Each tdf In db.TableDefs
    If tdf.Connect Like ";DATABASE=*" Then
        tdf.Connect = cstrUncPath
        tdf.RefreshLink
    End If
Next
Set tdf = Nothing
Set db = Nothing 
```

在将 db 文件分发给用户之前对其执行此操作。如果您愿意，您可以随后从用户的 db 文件的本地副本运行类似的过程。

请注意，代码只会更改访问表的链接。到其他数据源（ODBC、Excel、文本文件等）的链接将被忽略。

如果您需要链接到多个 Access 后端数据库中的表，请使用包含数据库路径和表/链接名称的单独表。然后，您可以*将该*表作为记录集打开并循环访问以根据需要更改/创建链接。

# sharepoint-2010 - 分页在 Visual Web 部件的 SPGridView 中不起作用

> ID：14780872
> 
> 赞同：1
> 
> 时间：2013-02-08T20:33:12.927
> 
> 标签：sharepoint-2010

当我单击页面时，分页不起作用。什么都没有显示。这是代码，

**我的 ascx 表单上的标记，**

```
<div class="mGrid">
<SharePoint:SPGridView
  runat="server"
  ID="gdSharedReport"
  AutoGenerateColumns="false" 
  CssClass="mGrid"
  AllowPaging="true"
  PagerStyle-CssClass="pgr"
  AlternatingRowStyle-CssClass="alt"
  EmptyDataText="No Survey found."
  OnSorting="gdSharedReport_Sorting"
  OnPageIndexChanging="gdSharedReport_PageIndexChanging"
/>
</div> 
```

**我的 ascx.cs 上的代码，**

```
 public DataView dv;

        protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack)
            {
               GenerateGrid();
            }

        }
       private DataTable BindData()
      {
        DataTable table;

        table = new DataTable();

        table.Columns.Add("SurveySet", typeof(string));
        table.Columns.Add("SurveySection", typeof(string));
        table.Columns.Add("SurveyQuestion", typeof(string));
        table.Columns.Add("Employee", typeof(string));
        table.Columns.Add("Supervisor", typeof(string));
        table.Columns.Add("EmployeeNumber", typeof(string));
        table.Columns.Add("SurveyDate", typeof(string));

        DataRow row;

        try
        {
           SPListItemCollection collListItems = list.GetItems(oQuery);

           row = table.NewRow();
           //Logic here to set rows
           table.Rows.Add(row);
        }
        catch(Exception ex){}

        return table;
      }
      private void GenerateGrid()
    {
        DataTable dt = BindData();
        dv = new DataView(dt);
        gdSharedReport.DataSource = dv;

        gdSharedReport.AutoGenerateColumns = false;
        gdSharedReport.AllowSorting = true;
        gdSharedReport.Sorting += new GridViewSortEventHandler(gdSharedReport_Sorting);

        //Setting bound fields here

        gdSharedReport.PageSize = 10;
        gdSharedReport.AllowPaging = true;
        gdSharedReport.PageIndexChanging +=
            new GridViewPageEventHandler(gdSharedReport_PageIndexChanging);
        gdSharedReport.PagerTemplate = null; 

        if (ViewState["SortDirection"] != null && ViewState["SortExpression"] != null)
        {
            dv.Sort = ViewState["SortExpression"].ToString()
                + " " + ViewState["SortDirection"].ToString();
        }

        gdSharedReport.DataBind(); 

    }

    public void gdSharedReport_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        gdSharedReport.PageIndex = e.NewPageIndex;
        gdSharedReport.DataBind();
    }

    public void gdSharedReport_Sorting(object sender, GridViewSortEventArgs e)
    {
        string lastExpression = "";
        if (ViewState["SortExpression"] != null)
            lastExpression = ViewState["SortExpression"].ToString();

        string lastDirection = "asc";
        if (ViewState["SortDirection"] != null)
            lastDirection = ViewState["SortDirection"].ToString();

        string newDirection = "asc";
        if (e.SortExpression == lastExpression)
            newDirection = (lastDirection == "asc") ? "desc" : "asc";

        ViewState["SortExpression"] = e.SortExpression;
        ViewState["SortDirection"] = newDirection;

        dv.Sort = e.SortExpression + " " + newDirection;
        gdSharedReport.DataBind();
    } 
```

这是网格加载的方式，

![在此处输入图像描述](../Images/85dae1a1f34cc1bc461c13e3de87f54e.png)

这是我点击页面时的结果，

![在此处输入图像描述](../Images/2ed0972a0021b0962d244d80a963b7c5.png)

如果我修改以下功能，

```
public void gdSharedReport_PageIndexChanging(object sender, GridViewPageEventArgs e)
        {
            gdSharedReport.PageIndex = e.NewPageIndex;
           gdSharedReport.DataBind();

        } 
```

至，

```
public void gdSharedReport_PageIndexChanging(object sender, GridViewPageEventArgs e)
        {
            gdSharedReport.PageIndex = e.NewPageIndex;
            gdSharedReport.DataSource = BindData();
            gdSharedReport.DataBind();

        } 
```

然后分页开始工作，但如果我点击分页，分页号码就会消失，

![在此处输入图像描述](../Images/4a1756c76e9da1f23f6ffa66980ea0c8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-20T09:52:41.477

> 您需要在页面索引更改事件中再次指定分页。

```
public void gdSharedReport_PageIndexChanging(object sender, GridViewPageEventArgs e)
        {
            gdSharedReport.PageIndex = e.NewPageIndex;
            gdSharedReport.AllowPaging = true;
            gdSharedReport.PageIndexChanging += new GridViewPageEventHandler(gdSharedReport_PageIndexChanging);
            gdSharedReport.PagerTemplate = null;
            gdSharedReport.DataSource = BindData();
            gdSharedReport.DataBind();

        } 
```

# php - 具有重写规则的法语字符

> ID：14780875
> 
> 赞同：1
> 
> 时间：2013-02-08T20:33:25.400
> 
> 标签：php, regex, .htaccess, mod-rewrite, url-rewriting

我的数据库中有类别名称，一些主题有法语字符，如 é è ê。它可以正常工作，直到今天我尝试向其中添加另一个字符 à 然后我开始收到 SERVER ERROR

这是我的.htaccess：

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^([A-Za-z0-9éèêà_-\s]+)-(\d+)\.htm$   classified.php?id=$2 [L] 
```

如您所见，没有 à 它可以正常工作。

如何将那个东西添加到正则表达式中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T21:39:27.987

如果您使用各种字符和重音字母，那么为什么不让任何东西过去呢？

注意：使用此规则也将允许空格；

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^(.*)-(\d+)\.htm$   classified.php?id=$2 [L] 
```

稍后，如果您决定限制正则表达式，假设您不想要这些字符中的任何一个 # $ % 那么您必须例外：

```
 Options +FollowSymlinks
  RewriteEngine on
  RewriteRule ^([^#$%]+)-(\d+)\.htm$   classified.php?id=$2 [L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T21:19:35.420

似乎 URL 中的扩展 ASCII 字符以 UTF-8 和 url 编码形式发送。例如：

```
/éèêà-1.htm -> /%C3%A9%C3%A8%C3%AA%C3%A0-1.htm 
```

上面的 URL 可以像这样被 mod_rewrite 匹配：

```
RewriteEngine On
RewriteRule ^(?:\w|\xC3\xA9|\xC3\xA8|\xC3\xAA|\xC3\xA0)+-(\d+)\.htm$ classified.php?id=$1 [L] 
```

# javascript - 强制 Javascript 编码与除指定元素之外的每个 LI 解除关联

> ID：14780881
> 
> 赞同：0
> 
> 时间：2013-02-08T20:33:57.850
> 
> 标签：javascript

如何修改下面的代码，使其不抓取除指定元素中的所有 LI 之外的每个 LI？原因是我在另一个页面上有一个单独的水平下拉菜单，当下面的代码应用于页面时，我的右键菜单类似于我的下拉菜单。我怎样才能让它只适用于指定的元素：`document.getElementById('Menu')`

```
<!DOCTYPE html>

<head>
    <script language="javascript" type="text/javascript">
        var MenuObj;
        var activeMenuItem = false;

        //Function to highlight menu item
        function highlightMenuItem() {
            this.className = 'MenuHighlighted';
        }

        function deHighlightMenuItem() {
            this.className = '';
        }

        //Function to show menu on click of menu item
        function showMenu(e) {
            var myMouseX = (e || event).clientX;
            var myMouseY = (e || event).clientY;
            MenuObj.style.left = myMouseX + 'px';
            MenuObj.style.top = myMouseY + 'px';
            MenuObj.style.display = 'block';
            return false;
        }

        //Function to hide menu on click of menu item
        function hideMenu(e) {
            if (document.all) e = event;
            if (e.button == 0) {
                MenuObj.style.display = 'none';
            }
        }

        function initMenu() {
            MenuObj = document.getElementById('Menu');
            MenuObj.style.display = 'block';
            var menuItems = MenuObj.getElementsByTagName('LI');
            for (var no = 0; no < menuItems.length; no++) {
                menuItems[no].onmouseover = highlightMenuItem;
                menuItems[no].onmouseout = deHighlightMenuItem;

                var aTag = menuItems[no].getElementsByTagName('A')[0];
                aTag.style.paddingLeft = '5px';
                aTag.style.width = (aTag.offsetWidth) + 'px';
                aTag.onclick = hideMenu;
            }
            MenuObj.style.display = 'none';
        }

    </script>
    <style type="text/css">
        #Menu
        {
            /* The menu container */
            border: 1px solid #808080;
            background-color: #EDEDED;
            margin: 0px;
            padding: 0px;
            width: 120px; /* Width of context menu */
            font-family: Trebuchet MS;
            font-size: 8pt;
            background-repeat: repeat-y; /* Never change these two values */
            display: none;
            position: absolute;
        }
        #Menu a
        {
            /* Links in the context menu */
            color: #252525;
            text-decoration: none;
            line-height: 20px;
            vertical-align: middle;
            height: 20px; /* Don't change these 3 values */
            display: block;
            width: 100%;
        }
        #Menu li
        {
            /* Each menu item */
            list-style-type: none;
            padding: 1px;
            margin: 1px;
            cursor: pointer;
        }
        #Menu li div
        {
            /* Dynamically created divs */
            cursor: pointer;
        }
        #Menu .MenuHighlighted
        {
            background-color: #C4D0D4;
        }

    </style>
</head>
<body>
<select style="width: 250px;" id="refdocs_list">
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select>

    <div>

                    <ul id="Menu">
                        <li><a href="#nogo">Delete document</a></li>
                        <div style="height:1px; background: #808080;"></div>
                        <li style="height: 5px;"><a href="#nogo">Clear all</a></li>
                    </ul>

        <script type="text/javascript">
            initMenu();
            MenuObj.style.display = 'none';
            document.getElementById('refdocs_list').oncontextmenu = showMenu;
            document.getElementById('refdocs_list').onclick = hideMenu;
            document.documentElement.onclick = hideMenu;
        </script>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:00:23.140

原来我的菜单和我的右键菜单使用相同的 div 名称#menu

改变了，瞧，它又可以工作了。

# ios - iOS 客户端可能的编码不匹配

> ID：14780884
> 
> 赞同：0
> 
> 时间：2013-02-08T20:34:07.710
> 
> 标签：ios, http, encoding, content-type, emoji

我有一个 iOS 应用程序，我们遇到了一些似乎与编码问题有关的错误，因为某些内容在到达服务器时被截断。这是有问题的，因为它一直在扰乱我们的身份验证机制，这涉及对发布的内容进行哈希处理（以及其他一些内容，但这是基础知识）。

到目前为止，我们还无法在本地重现该问题。我们有一个理论，它与表情符号键盘之类的东西有关；但我尝试过发布表情符号、国际字符以及我能想到的一切。当我尝试时，一切都会正确发布。我知道 ios 4 和 5 之间 ios 对表情符号的编码方式有所不同；我们已经设法与我们的一些客户进行了交谈，试图了解他们正在使用什么，通常是 iOS 6，iPhone 4s 或 5（就像我们的测试设备一样，我已经测试过使用 ios 5 和 6) ...所以它似乎与操作系统无关。

这就是我们为帖子设置请求正文的方式。

```
[req setHTTPBody:[paramString dataUsingEncoding:NSUTF8StringEncoding]]; 
```

以前，我只是将内容类型设置为：

```
[req setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"]; 
```

我的理论是，明确内容类型中的字符集可能会解决它：

```
[req setValue:@"application/x-www-form-urlencoded; charset=UTF-8" forHTTPHeaderField:@"Content-Type"]; 
```

所以我的问题是，这很疯狂吗？您认为明确将字符集设置为 UTF-8 会解决问题吗？您可以推荐任何其他故障排除技术来找出问题所在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:20:39.147

你有失败请求的wireshark或fiddler跟踪吗？我将从那里开始验证客户端确实在发送截断的数据，这不是服务器端的问题。

无论发送的数据如何，都要检查`Content-Length`标头是否正确。由于问题不容易重现，或许可以从看到问题的用户那里收集更具体的数据，这样可以识别有问题的输入，并且可以重复重现损坏的请求。

如果您直接从 UITextField 中提取字符串，我怀疑这是一个编码问题，您不应该有编码问题。如果您要去/来自 CStrings 或 NSData，那么这将是第一个要检查的地方。

无论如何都不是一个决定性的答案，但这就是我要开始的地方。

# r - 如何在ggplot2中包装堆叠的面

> ID：14780885
> 
> 赞同：2
> 
> 时间：2013-02-08T20:34:12.493
> 
> 标签：r, ggplot2, facet, facet-wrap

在我的 data.frame`df`中，我有变量`A, B, C`和`D`. 我想用and绘制`C`vs`D`和 facet 。是一个具有 3 个级别的因子，我希望它是垂直分面的，并且有许多我希望水平分面的变量。但是，当我这样做时`A``B``B``A`

```
sp <- ggplot(df, aes(x=D, y=C)) + geom_point()
sp + facet_grid(B ~ A) 
```

情节水平延伸太远。我想`facet_wrap`水平使用（带`A`），但`facet_grid`垂直使用，这样`B`变量就不会错位。我怎样才能做到这一点？

# java - slf4j 登录控制台而不是文件

> ID：14780886
> 
> 赞同：3
> 
> 时间：2013-02-08T20:34:13.587
> 
> 标签：java, logging, webdav, slf4j, milton

我正在测试 Milton WebDAV API，我需要在打开某些文档时进行记录。我可以让它登录 Eclipse 的控制台，但不能让它把消息放在外部文件上。

在 SO 和 Google 上找到了几个链接，但没有一个有效。我已经在这上面花了大约 4 小时。有什么猜测吗？

这是情况（尽我所能格式化）：

### log4j.properties

```
# Direct log messages to a log file
log4j.appender.file=org.apache.log4j.FileAppender
log4j.appender.file.File=/home/paulo/workspace/MiltonTutorial/logs/log.txt
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n

# Root logger option
log4j.rootLogger=INFO, file 
```

### 文档资源.java

```
public class DocumentResource implements GetableResource,
    PropFindableResource, DeletableResource, MoveableResource,
    CopyableResource, ReplaceableResource, PropPatchableResource, MultiNamespaceCustomPropertyResource {

    private final static Logger log = LoggerFactory.getLogger(DocumentResource.class);
    Document doc;

    (...)

    @Override
    public void sendContent(OutputStream out, Range arg1,
            Map<String, String> arg2, String arg3) throws IOException,
            NotAuthorizedException, BadRequestException {
        log.info(">>> File {} opened", doc.getFileName());

        out.write(this.doc.getContent());
    } 
```

### 在 WebDAV 客户端上执行“get testfile”时的 Eclipse 控制台

> 08/02/2013 18:03:15 com.ettrema.tutorial.milton.DocumentResource sendContent INFO: >>> 文件 testfile 打开

### log.txt 大内容[在这里](http://pastebin.com/raw.php?i=5ejRyieS "这里")

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:59:55.777

只需将您的 log4j 文件编辑为如下所示：

```
log4j.rootLogger=DEBUG, A2

log4j.appender.A1=org.apache.log4j.ConsoleAppender
log4j.appender.A1.layout=org.apache.log4j.PatternLayout
log4j.appender.A1.layout.ConversionPattern=%-5p %c %x - %m%n

log4j.appender.A2=org.apache.log4j.FileAppender  
log4j.appender.A2.File=/a.log  
log4j.appender.A2.layout=org.apache.log4j.PatternLayout
log4j.appender.A2.layout.ConversionPattern=%-5p %c %x - %m%n

log4j.logger.io.milton=TRACE 
```

如果没有应用记录器设置（即您没有看到文件中出现日志），那么您的类路径中的某处可能有另一个 log4j.properties 文件正在使用而不是这个文件。有时它可以包含在 jar 文件中（eek！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T21:03:18.027

`slf4j`只是其他记录器的包装器，其中一个`log4j`用于将内容记录到文件中（由 配置`log4j.properties`）。

当您的 SLF4 配置为登录到控制台时，系统的其余部分很可能正在使用 Log4J 的 API。

确保你`slf4j-log4j12.jar`的类路径中有，而不是`slf4j-simple`一个

# ruby-on-rails - 轮胎 + Will_Paginate 不采用 Tire.options

> ID：14780888
> 
> 赞同：1
> 
> 时间：2013-02-08T20:34:22.780
> 
> 标签：ruby-on-rails, elasticsearch, tire

我正在尝试将轮胎集成到我的网站中，但我在分页时遇到了困难。我尝试在轮胎上下文之外对结果进行分页，而 will_paginate 正在处理该数组。但是，当我在轮胎的上下文中尝试 will_paginate 时，我遇到了一个大问题。

Will_Paginate 将显示正确的页数并考虑 :per_page 但是当我单击该页面时，结果不会加载，而是与第一页相同。页码在 will_paginate 导航中突出显示。

@results.inspect 产生这个：

```
 #<Tire::Search::Search:0x007f88ab9153d0 @indices=["deja-set-development"], @types=[],        @options={:load=>true, :page=>1, :per_page=>2}, @path="/deja-set-development/_search", @query=#<Tire::Search::Query:0x007f88ab915088 @value={:query_string=>{:query=>"oh"}}>, @facets={"type"=>{:terms=>{:field=>:_type, :size=>10, :all_terms=>false}}}> 
```

这是我调用 will_paginate 的地方：

```
= will_paginate @search_results.results, params 
```

这是我遍历结果的地方

```
@search_results.results.each 
```

有人有想法吗？

编辑 - -

我不确定发生了什么，但我这样做了，它正在工作。

```
@search_results = @search_results.paginate(:page => params[:page], :per_page => 5) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T08:02:26.813

请查看 Tire 中的[集成测试](https://github.com/karmi/tire/commit/09bab36)，并确保您正确通过了所有选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:19:45.227

所以为了澄清，我在这里附上了我与@karmi 的 github 通信。

[https://github.com/karmi/tire/issues/627#issuecomment-13449368](https://github.com/karmi/tire/issues/627#issuecomment-13449368)

我使用的是 Tire.search，而不是按模型搜索。正如@karmi 所说，目前轮胎不支持 :per_page 和 :page 。

这是我解决这个问题的方法：

```
 @search_results = Tire.search [:index1, :index2, :index3], :load => true, :from => from, :size => size  do
        query do
            string q, :default_operator => 'AND', :fields => [:name1, :name2]
        end
    end 
```

我最终不得不旋转我自己的小型分页系统来增加“大小”和“来自”。这是有关该主题的弹性搜索链接。

[http://www.elasticsearch.org/guide/reference/api/search/from-size.html](http://www.elasticsearch.org/guide/reference/api/search/from-size.html)

您仍然可以访问

```
 = @search_results.results.total_entries/next_page/previous_page 
```

这有助于分页。

再次感谢@karmi。

# razor - 如何在 C# 中从 MVC3 中的字符串返回视图

> ID：14780891
> 
> 赞同：0
> 
> 时间：2013-02-08T20:34:52.497
> 
> 标签：razor, view

```
public ActionResult Default()
{
    ViewBag.Message = "Hello,World!";
    var template = "<h1>@ViewBag.Message</h1>";
    //How to make the content of the following "View" = "template"
    return View();
} 
```

然后构建html结果为：

```
<h1>Hello,World!</h1> 
```

请帮助我，谢谢！我知道 RazorEngine 可以解析 Razor 文件，但不能将字符串渲染到 View。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:04:18.150

改用内容结果，它返回原始内容。它不使用关联视图，而只是将内容直接返回给请求者。

```
return Content(template); 
```

# java - 跨多个类使用单个 JFrame

> ID：14780893
> 
> 赞同：0
> 
> 时间：2013-02-08T20:34:59.850
> 
> 标签：java, swing, user-interface, jframe

我正在开发一个 Java 视频游戏，到目前为止它有一个主菜单类和一个游戏类。正如我现在设置的那样，每个类都使用自己的 JFrame，这意味着当用户单击“开始游戏”时，主菜单 JFrame 关闭，游戏 JFrame 打开。显然这并不理想，我希望两个类都使用相同的 JFrame，但是我真的不知道该怎么做，而且互联网搜索也没有帮助。

我的主菜单类是：

`public class Frame extends javax.swing.JFrame { ... }`

我现在已经设置好了，以便我的 Game 类导入我的 Frame 类，但是当我尝试从我的游戏中制作 JFrame 显示元素时，什么也没有出现。所以我的问题是：

如何跨多个类使用一个 JFrame？

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:59:46.273

而不是需要将主框架的引用传递给每个子面板，这可能会暴露您不希望他们访问的程序部分（例如），您应该使用[CardLayout](http://docs.oracle.com/javase/7/docs/api/java/awt/CardLayout.html)之类的东西并使用主机作为主要显示中心，根据需要切换面板

查看[如何使用 CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)以获得更多示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:56:43.630

您应该在整个游戏中只使用一帧。并且应该有许多 JPanel 用于不同的内容。

决定内容和切换应该是这样的：

```
switch( currentState )  {

   case introduction: 
        setContentPane(new IntroductionPanel());
        break;
    case insideGame:
        setContentPane( new GamePanel() );
    ...
    ...
    ...

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T20:59:24.583

使用 cardLayout 切换面板 [http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:49:57.143

与其让每个类成为自己的框架，不如拥有一个框架，由多个类操作它。我可能会设置这样的东西：

```
public class MainFrame extends JFrame {
    public MainFrame() {
        super("Cool Game!");
        setDefaultCloseOperation(EXIT_ON_CLOSE);
    }
}

public class Game {
    private final MainFrame mainFrame;

    public Game(final MainFrame mainFrame) {
        this.mainFrame = mainFrame;
        mainFrame.setContentPane(createGamePanel());
    }

    private JPanel createGamePanel() {
        //...
    }
}

public class MainMenu {
    private final MainFrame mainFrame;

    public MainMenu(final MainFrame mainFrame) {
        this.mainFrame = mainFrame;
    }

    public void showMainMenu() {
        mainFrame.setContentPane(createMainMenuPanel());
    }

    private JPanel createMainMenuPanel() {
        //...
    }
} 
```

# c - 无限管道疯狂

> ID：14780894
> 
> 赞同：1
> 
> 时间：2013-02-08T20:35:00.953
> 
> 标签：c, posix, pipe

我正在尝试创建一组无限的管道来从左进程遍历到右进程。我正在使用 fd 来保留以前的 fd 并将其输入到新进程中。任何人都可以看到我要去哪里错了。在这一点上应该很容易看到。我记录得很好。

```
 //Keep the previous out fd for the in of the subsequent process
    int prev_out_fd;

    for (x = 0; x < prog_count; ++x)
    {

        //Create a pipe for both processes to share
        int pipefd[2];

        if (x != prog_count -1)
        {
            pipe(pipefd);
        }

        prog_defs[x].pid = fork();

        if(prog_defs[x].pid == 0)
        {

            //If this is the first process we don't need a read end
            if (x == 0)
            {
                close(pipefd[0]);
            }

            //If this is not the first process, set the input to the output of the previous pipe
            if (x != 0)
            {
                dup2(prev_out_fd, STDIN_FILENO);

                //Pipe now garbage.  Get rid of it.
                close (prev_out_fd);
            }

            if(x != prog_count - 1)
            {
                dup2(pipefd[1], STDOUT_FILENO);
                close(pipefd[0]);
                close(pipefd[1]);
            }

            execvp(prog_defs[x].bin, prog_defs[x].args);
        }

        if (x != 0)
            close(prev_out_fd);

        prev_out_fd = pipefd[0];
        close(pipefd[1]);

    } 
```

# jquery - jquery fancybox 在 FF 和 IE 中关闭后仍然内联播放视频

> ID：14780895
> 
> 赞同：0
> 
> 时间：2013-02-08T20:35:03.517
> 
> 标签：jquery, replace, youtube, fancybox, fancybox-2

所以这是我的html

```
<a href="#aboutbarrybio" id="about_barry" class="aboutusbox">Link to Bio</a>

<div id="aboutbarrybio" class="bio_wrapper" style="display: none;">
<div class="about_video">
    <div class="video_wrapper">
        <div class="placard" style="display: none;"><img width="720" height="405" style="cursor:pointer;" src="http://we4.me/tiv/wp-content/uploads/2013/02/youtube-placard-e1359864185923.png"></div>
        <div style="display: block;" class="thevideo">
            <embed width="720" height="405" wmode="transparent" type="application/x-shockwave-flash" src="http://www.youtube.com/v/9bZkp7q19f0&amp;autoplay=1&amp;rel=0">
        </div>
    </div>
</div> 
```

这是我为 fancybox 编写的 javascript：

```
$(".aboutusbox").fancybox({
  padding       : 1,
  width         : 960,
  afterShow     : function() {
    $('.fancybox-opened .placard').each(function(){
        $('.fancybox-opened .placard').show();
        $('.fancybox-opened .thevideo').hide();
    });

    $('.fancybox-opened .placard').click(function(){
        $('.fancybox-opened .placard').hide();
        $('.fancybox-opened .thevideo').show();
    });
  },
  afterClose    : function() {
    $('.fancybox-inner').empty();
  }
}); 
```

尝试用图像标语牌替换视频，然后使用内联隐藏框在fancybox中显示。问题是，如果用户在 Firefox（和 IE？）上播放视频时关闭，它仍然在后台播放。Chrome 按预期工作。有什么方法可以减轻减去 iframe/ajax、youtube api 或仅使用视频本身？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:01:01.403

无需内嵌视频（以及相关问题），您可以执行以下操作：

*   直接链接到视频（获取`href`），
*   打开fancybox并将标语牌图像设置为内容，
*   将 a 绑定`click`到标语牌图像，然后将其替换为 youtube 内容（在`afterShow`回调内部）。

此外，您可以使用（HTML5）`data-*`属性从链接中传递图像/视频尺寸，而不是这样：

```
<a href="#aboutbarrybio" id="about_barry" class="aboutusbox">Link to Bio</a> 
```

...你可以这样做：

```
<a id="about_barry" class="aboutusbox" href="http://www.youtube.com/v/9bZkp7q19f0&amp;autoplay=1&amp;rel=0" data-width="720" data-height="405">Link to Bio</a> 
```

然后使用此脚本显示标语牌图像并将其替换`click`为 youtube 视频：

```
$(document).ready(function () {
    $(".aboutusbox").fancybox({
        padding: 0,
        fitToView: false, // fancybox won't auto-resize to fit in viewport
        // set placard image as content
        content: '<img class="placard" src="http://we4.me/tiv/wp-content/uploads/2013/02/youtube-placard-e1359864185923.png" width="720" height="405" alt="placard" />',
        scrolling: 'no',
        afterShow: function () {
            // get dimensions from data attributes
            var $width = $(this.element).data('width');
            var $height = $(this.element).data('height');
            // create youtube content
            var newContent = "<iframe src='" + this.href + "' frameborder='0' allowfullscreen width='" + $width + "' height='" + $height + "'></iframe>";
            // replace content on placard click
            $(".fancybox-inner").on("click", ".placard", function () {
                $(".fancybox-inner").html(newContent);
            });
        }
    });
}); // ready 
```

请参阅**[JSFIDDLE](http://jsfiddle.net/YBcTQ/)**演示。

**需要`.on()`jQuery 1.7+的**通知****

# c# - 从另一个类（在另一个线程上）在文本框中写入

> ID：14780899
> 
> 赞同：1
> 
> 时间：2013-02-08T20:35:20.923
> 
> 标签：c#, .net, winforms, multithreading, class

我需要在我的程序中创建类来启动一系列事件以在文本框中写入文本。我知道班级不应该知道表格。怎么做？考虑到我将在另一个线程上安装类的事实。

我已经尝试过创建一个接口，该接口连接类并使用 ref 参数在表单上创建方法。

**更新：* *你们都误解了我-我在谈论不在编程中的事件。我需要的只是将文本从另一个类添加到文本框。我添加了“事件链”来从类似问题中定义它，在它们中，他们试图直接从课堂上更改文本。对不起。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:46:52.787

这里有两种可能的选择：

“其他类”需要在“完成”工作后立即更新文本框。如果是这种情况，它不应该知道表单、任何文本框、界面，什么都没有。它应该只*返回一个值*并让表单使用该返回值来设置一个文本框，或者做任何事情。

在大多数情况下，这是您想要做的，它是解决此类问题的最简单和最有效的方法。如果没有必要，不要使用更复杂的东西。

如果在任务“完成”时信息没​​有发生，而是通过定期间隔发生，那么您可以使用`Progress`带有`IProgress`接口的类。

让`Form`创建一个实例：`Progress<string> progress = new Progress<string>();`. 让表单为该实例附加一个事件处理程序。请注意，该`Progress`实例将“捕获”当前同步上下文，这是一种说它在 UI 线程中运行的奇特方式。这可以这样做：

```
progress.ProgressChanged += (_, data) => textBox1.Text = data; 
```

然后让另一个类接受一个`IProgress<string>`实例并定期调用：

```
progress.Report(someString); 
```

如果您需要 and 的 4.5 之前的实现`Progress`，`IProgress`这里有一个可以在 .NET 3.5+ 中编译和运行的实现：

```
public interface IProgress<T>
{
    void Report(T data);
}

public class Progress<T> : IProgress<T>
{
    SynchronizationContext context;
    public Progress()
    {
        context = SynchronizationContext.Current
            ?? new SynchronizationContext();
    }

    public Progress(Action<T> action)
        : this()
    {
        ProgressReported += action;
    }

    public event Action<T> ProgressReported;

    void IProgress<T>.Report(T data)
    {
        var action = ProgressReported;
        if (action != null)
        {
            context.Post(arg => action((T)arg), data);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:44:33.523

在对您的应用程序了解不够的情况下，我会建议您需要在由表单处理的类中调用一个事件。发生的事情是这样的：

1.  班级有活动。
2.  表单启动并实例化类。
3.  Form 为类中的事件分配一个处理程序。
4.  类做它需要做的任何事情，直到它到达它需要与表单通信的地步。
5.  班级引发事件。
6.  表单中的处理程序被执行并且文本框发生变化。

所以在类的代码中你需要添加一些定义：

```
public delegate void FinishedEventHandler(object sender, string ValueToReturn);
public event FinishedEventHandler Finished; 
```

第一个是带有事件*签名*的委托。按照惯例，第一个参数始终是对类本身实例的引用，其余的是您要返回的值。二是真实事件。

现在，在对类进行任何处理的函数中，我们需要在适当的时候引发事件：

```
void DoSomething()
{
    .
    .
    .
    if(Finished!=null) Finished(this, "some value");
} 
```

if 子句用于确保确实有人在处理我们的事件，否则我们可能会遇到异常。

现在让我们看一下表格。我们需要添加一个处理事件的函数。它需要与我们之前定义的委托具有相同的签名。在该函数中，我们根据返回的值对表单进行所需的任何更改：

```
private void FinishedEventHandler(object sender, string ValueToReturn)
{
    TextBox1.Text = ValueToReturn;
} 
```

现在我们准备好使用我们刚刚创建的所有管道。首先我们将处理程序添加到事件中，然后我们可以调用类的处理函数。

```
MyClass.Finished += FinishedEventHandler;
MyClass.DoSomething(); 
```

这里有一个更详细的教程：

[http://msdn.microsoft.com/en-us/library/aa645739(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa645739(v=vs.71).aspx)

# java - 如果我们不使用 hashmap 或 hashset，则不需要 Java hashCode() 方法覆盖

> ID：14780903
> 
> 赞同：10
> 
> 时间：2013-02-08T20:35:31.437
> 
> 标签：java, equals, hashcode

我的同事正在重写该`equals()`方法。我的回答是，您是否也覆盖了该`hashCode()`方法？他的回答是因为我们不会使用散列映射或散列集，如果我们覆盖应该并不重要`hashCode()`。那是对的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-08T20:38:28.597

是的，他实际上是正确的 - 但是，如果有一天您需要将对象放入基于哈希的集合中，则必须在任何地方添加哈希码，这可能会很烦人 + 那天您可能会错误地实现哈希码（即不一致with equals) 因为你错过了 equals 方法中的一些微妙之处......

考虑到大多数 IDE 都提供自动 equals/hashcode 生成功能，我认为没有理由不同时创建两者。

另一种看待它的方式是：当您覆盖父类的方法时，您应该遵循该父类定义的协定。在 Object 的情况下，[equals 的 javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)非常清楚：

> 请注意，每当重写该方法时，通常都需要重写 hashCode 方法，以维护 hashCode 方法的一般约定，即相等的对象必须具有相等的哈希码。

因此，除非您有真正的设计理由不覆盖哈希码，否则**默认决定应该是遵循父类合同并覆盖两者都不覆盖或覆盖两者**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-08T20:40:36.660

如果您覆盖`equals()`，也请覆盖`hashCode()`。即使您现在不使用`hashCode()`，您或其他人也可能会使用它。

有关此主题的更多信息，请查看出色的[SO 答案](https://stackoverflow.com/a/27609/283084)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-08T20:39:34.757

这是一种代码气味。例如，如果您覆盖 hashCode 或 equals 而不覆盖另一个，Findbugs 会警告您。您应该覆盖两者，以使它们彼此一致（即 a.equals(b) => a.hashCode() == b.hashCode()）。

现在稍加努力，以后可能会省去很多麻烦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T21:29:05.143

> 您必须在每个覆盖 equals 的类中覆盖 hashCode。不这样做将导致违反 Object.hashCode 的一般约定，这将阻止您的类与所有基于哈希的集合（包括 HashMap、HashSet 和 Hashtable）一起正常运行。

有效的 Java 条款 9：当你覆盖 equals 时，总是覆盖 hashCode。

如果您的课程是公共课程，那么您将无法控制您的课程在未来开发中的使用方式。如果不查看源代码（或通过反射），就无法知道这个类是否覆盖了 hasCode 方法，如果用户在任何基于散列的集合中使用它，用户会对结果感到惊讶。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T20:38:53.600

一般的：

仅覆盖您想以自己的方式使用的那些方法以及受此覆盖影响的那些方法。

具体到您的问题：

从java文档，

> 请注意，每当重写 equals() 方法时，通常都需要重写 hashCode 方法，以维护 hashCode 方法的一般约定，即相等的对象必须具有相等的哈希码。

[等于](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-08T20:44:22.640

实际上假设您创建了两个不同的对象，而没有覆盖 equals 和 hashCode 方法。然后如果你调用 equals 方法 java 隐式调用 hashCode 方法然后检查哈希码的相等性。

重写 hashCode 方法足以检查两个对象的相等性。它对未来很有用。您可以在集合上使用此类。

否则，如果您只实现 equal 方法，它将仅解决两个对象的相等问题。

# ios - 停止 NSOperationQueue

> ID：14780909
> 
> 赞同：2
> 
> 时间：2013-02-08T20:35:54.010
> 
> 标签：ios, nsurlconnection, nsoperation, nsoperationqueue

我有一个 NSOperationQueue 处理循环中从 Web 服务器导入数据。它通过以下设计实现了这一点。

1.  NSURLConnect 封装在一个 NSOperation 中并添加到队列中

2.  成功完成下载后（使用块），来自请求的数据被包装在另一个 NSOperation 中，该 NSOperation 将相关数据添加到 Core Data。此操作被添加到队列中。

3.  成功完成后（使用另一个块），（并在指定的延迟之后）我调用启动它的方法并返回到步骤 1。因此，我在 x 秒后进行另一个服务器调用。

这很好用。我能够从服务器获取数据并在后台处理所有事情。而且因为这些只是 NSOperations，所以我可以将所有内容放在后台，并一次执行多个请求。这真的很好用。

我目前遇到的唯一问题是，一旦操作进行，我就无法成功取消操作。

我尝试过类似以下的方法：

```
- (void)flushQueue
{
    self.isFlushingQueue = YES;
    [self.operationQueue cancelAllOperations];
    [self.operationQueue waitUntilAllOperationsAreFinished];
    self.isFlushingQueue = NO;
    NSLog(@"successfully flushed Queue");

} 
```

其中 self.isFlushingQueue 是一个 BOOL，我在将任何新操作添加到队列之前用于检查。这似乎应该有效，但实际上并没有。关于停止我的科学怪人创作的任何想法？

**编辑（已解决问题，但从不同的角度）**

我仍然对为什么我无法取消这些操作感到困惑（我很乐意继续尝试可能的解决方案），但我对如何以稍微不同的方式解决这个问题有了一些了解。我决定只使用一个包含所有活动连接列表的数据结构（NSMutableDictionary），而不是处理取消操作并等待队列完成。像这样的东西：

```
self.activeConnections = [NSMutableDictionary dictionaryWithDictionary:@{
                          @"UpdateContacts": @YES,
                          @"UpdateGroups" : @YES}]; 
```

然后在我将任何操作添加到队列之前，我只需询问该特定呼叫是打开还是关闭。我已经对此进行了测试，并且成功地对要循环的每个单独的服务器请求进行了有限控制。要关闭所有内容，我可以将所有连接设置为@NO。

这个解决方案有几个缺点（必须手动管理一个额外的数据结构，并且每个操作都必须重新开始以查看它在终止之前是打开还是关闭）。

**编辑——追求更准确的解决方案**

我删除了所有不相关的代码（注意没有错误处理）。我发布了两种方法。第一个是如何创建请求 NSOperation 的示例，第二个是生成完成块的便捷方法。

注意完成块生成器被几十个不同的请求调用，类似于第一种方法。

```
- (void)updateContactsWithOptions:(NSDictionary*)options
{
    //Hard coded for ease of understanding
    NSString *contactsURL = @"api/url";
    NSDictionary *params = @{@"sortBy" : @"LastName"};

    NSMutableURLRequest *request = [self createRequestUsingURLString:contactsURL andParameters:params];

    ConnectionCompleteBlock processBlock = [self blockForImportingDataToEntity:@"Contact"
                                                                 usingSelector:@selector(updateContactsWithOptions:)
                                                                   withOptions:options andParsingSelector:@selector(requestUsesRowsFromData:)];

    BBYConnectionOperation *op = [[BBYConnectionOperation alloc] initWithURLRequest:request
                                                                        andDelegate:self
                                                                 andCompletionBlock:processBlock];

    //This used to check using self.isFlushingQueue
    if ([[self.activeConnections objectForKey:@"UpdateContacts"] isEqualToNumber:@YES]){
        [self.operationQueue addOperation:op];
    }

}

- (ConnectionCompleteBlock) blockForImportingDataToEntity:(NSString*)entityName usingSelector:(SEL)loopSelector withOptions:(NSDictionary*)options andParsingSelector:(SEL)parseSelector
{
    return ^(BOOL success, NSData *connectionData, NSError *error){

        //Pull out variables from options
        BOOL doesLoop = [[options valueForKey:@"doesLoop"] boolValue];
        NSTimeInterval timeInterval = [[options valueForKey:@"interval"] integerValue];

        //Data processed before importing to core data
        NSData *dataToImport = [self performSelector:parseSelector withObject:connectionData];

        BBYImportToCoreDataOperation *importOperation = [[BBYImportToCoreDataOperation alloc] initWithData:dataToImport 
          andContext:self.managedObjectContext 
          andNameOfEntityToImport:entityName];

        [importOperation setCompletionBlock:^ (BOOL success, NSError *error){
             if(success){
                 NSLog(@"Import %@s was successful",entityName);
                 if(doesLoop == YES){
                     dispatch_async(dispatch_get_main_queue(), ^{
                         [self performSelector:loopSelector withObject:options afterDelay:timeInterval];
                     });
                 }
             }
         }];

        [self.operationQueue addOperation:importOperation];

    };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T15:39:02.467

取消 NSOperation 只是一个请求，一个设置在`NSOperation`. `NSOperation`实际操作该请求并取消它的工作取决于您的子类。然后，您需要确保为等设置了正确的标志`isExecuting`。`isFinished`您还需要以符合 KVO 的方式执行此操作。只有设置了这些标志后，操作才完成。

[文档Concurrency Programming Guide -> Configure Operations for Concurrent Execution](http://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html#//apple_ref/doc/uid/TP40008091-CH101-SW8)中有一个示例。尽管我了解此示例可能无法正确解释所有多线程边缘情况。示例代码中提供了另一个更复杂的示例`LinkedImageFetcher`：`QRunLoopOperation`

If you think you are responding to the cancellation request correctly then you really need to post your NSOperation subclass code to examine the problem any further.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:47:51.850

当可以添加更多操作时，不要使用自己的标志，您可以尝试

`- (void)setSuspended:(BOOL)suspend`

方法上`NSOperationQueue`？在添加新操作之前，检查队列是否被挂起`isSuspended`？

# java - WinRun4J - 无法加载库 jar

> ID：14780911
> 
> 赞同：1
> 
> 时间：2013-02-08T20:35:55.270
> 
> 标签：java, winrun4j

我正在尝试使用 WinRun4J 将我的 Java 程序作为 Windows 服务执行。该服务已正确创建并运行，直到由于 ClassNotFoundException 而停止：

```
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Failed to import bean definitions from relative location [appContext-webServices.xml]
Offending resource: class path resource [spring/appContext.xml]; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Unexpected exception parsing XML document from class path resource [spring/appContext-webServices.xml]; nested exception is java.lang.RuntimeException: javax.xml.bind.JAXBException
 - with linked exception:
[java.lang.ClassNotFoundException: com/sun/xml/bind/v2/ContextFactory]
at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:76)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:271)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseDefaultElement(DefaultBeanDefinitionDocumentReader.java:196)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:181)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:243)
at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:127)
at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:93)
at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:131)
at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:522)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:436)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
at br.com.gep.sped.extrator.AppServico.serviceMain(AppServico.java:22)
Caused by: org.springframework.beans.factory.BeanDefinitionStoreException: Unexpected exception parsing XML document from class path resource     [spring/appContext-webServices.xml]; nested exception is java.lang.RuntimeException: javax.xml.bind.JAXBException
 - with linked exception:
[java.lang.ClassNotFoundException: com/sun/xml/bind/v2/ContextFactory]
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:412)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:255)
... 20 common frames omitted
Caused by: java.lang.RuntimeException: javax.xml.bind.JAXBException
 - with linked exception:
[java.lang.ClassNotFoundException: com/sun/xml/bind/v2/ContextFactory]
at org.apache.cxf.configuration.spring.AbstractBeanDefinitionParser.getContext(AbstractBeanDefinitionParser.java:326)
at org.apache.cxf.configuration.spring.AbstractBeanDefinitionParser.mapElementToJaxbProperty(AbstractBeanDefinitionParser.java:352)
at org.apache.cxf.configuration.spring.AbstractBeanDefinitionParser.mapElementToJaxbProperty(AbstractBeanDefinitionParser.java:294)
at org.apache.cxf.transport.http.spring.HttpConduitBeanDefinitionParser.doParse(HttpConduitBeanDefinitionParser.java:58)
at org.springframework.beans.factory.xml.AbstractSingleBeanDefinitionParser.parseInternal(AbstractSingleBeanDefinitionParser.java:85)
at org.springframework.beans.factory.xml.AbstractBeanDefinitionParser.parse(AbstractBeanDefinitionParser.java:59)
at org.springframework.beans.factory.xml.NamespaceHandlerSupport.parse(NamespaceHandlerSupport.java:73)
at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1419)
at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1409)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:184)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
... 23 common frames omitted
Caused by: javax.xml.bind.JAXBException: null
at javax.xml.bind.ContextFinder.newInstance(Unknown Source)
at javax.xml.bind.ContextFinder.find(Unknown Source)
at javax.xml.bind.JAXBContext.newInstance(Unknown Source)
at org.apache.cxf.common.jaxb.JAXBContextCache$2.run(JAXBContextCache.java:267)
at org.apache.cxf.common.jaxb.JAXBContextCache$2.run(JAXBContextCache.java:265)
at java.security.AccessController.doPrivileged(Native Method)
at org.apache.cxf.common.jaxb.JAXBContextCache.createContext(JAXBContextCache.java:265)
at org.apache.cxf.common.jaxb.JAXBContextCache.getCachedContextAndSchemas(JAXBContextCache.java:172)
at org.apache.cxf.configuration.spring.AbstractBeanDefinitionParser.getContext(AbstractBeanDefinitionParser.java:321)
... 36 common frames omitted
Caused by: java.lang.ClassNotFoundException: com/sun/xml/bind/v2/ContextFactory
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at javax.xml.bind.ContextFinder.safeLoadClass(Unknown Source)
... 45 common frames omitted 
```

我怀疑 WinRun4J 没有加载我在 lib 文件夹中的 lib jar。我的应用程序工作目录是这样的：

```
application directory
     -> bin directory
     -> lib directory 
```

主应用程序 jar 在 bin 文件夹中，其他 jar 在 lib 文件夹中。这是我的 servico.ini 文件，由 WinRun4J 使用：

```
vm.version.min=1.6
single.instance=process
service.class=br.com.gep.sped.extrator.AppServico
service.id=AgenteWIN
service.name=Agente Win
service.description=Agente de extração dos dados SPED.
classpath.1=*.jar
classpath.2=../lib/*.jar
vmarg.1=-Xmn100M
vmarg.2=-Xms500M
vmarg.3=-Xmx500M 
```

我在 classpath.2 中尝试了很多变体，但都没有成功。
我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T13:56:57.050

作为 Windows，您可能需要使用反斜杠而不是正斜杠

```
classpath.2=..\lib\*.jar 
```

如果这还不够，请尝试添加

```
working.directory=. 
```

以确保根据正确的基本目录解析相对路径。如果一切都失败了，您可以将清单添加到您的主 JAR 文件中，其中`Class-Path`包含枚举所有`../lib/file.jar`文件并`classpath.2`完全取消。

编辑：看到堆栈跟踪看起来 WinRun4J 没有正确设置线程上下文类加载器。尝试添加

```
Thread.currentThread().setContextClassLoader(
    AppServico.class.getClassLoader()); 
```

`serviceMain`在你实例化任何与 Spring/CXF 相关的东西之前，到你的顶部。

# java - 确定复杂度等级

> ID：14780913
> 
> 赞同：2
> 
> 时间：2013-02-08T20:36:01.197
> 
> 标签：java, performance, complexity-theory, big-o

这里的大符号是什么？解释将不胜感激。谢谢。

```
public static int[] mystery1(int[] list) {

  int[] result = new int[2 * list.length];
  for (int i = 0; i < list.length; i++) {
    result[2 * i] = list[i] / 2 + list[i] % 2;
    result[2 * i + 1] = list[i] / 2;
  }

  return result;

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-08T20:37:50.467

是`O(n)`，其中 n 是列表的长度。无论如何，您都会浏览整个列表一次。

算术运算的数量为：

*   2n 次乘法
*   2n 个加法
*   2n个分区
*   n 模运算

这还不包括实现 for 循环的算术运算。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T20:39:04.600

在）

命令的数量并不像您使用的控制结构（循环）那么重要。如果你考虑这个函数，它只有一个循环。该循环使用列表的长度 (n) 作为迭代次数。如果列表的长度加倍，则循环完成所需的时间也会加倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:40:16.427

大 O 代表最坏的情况。因为您无法比较两台不同计算机执行操作所需的时间，所以大 O 应用于算法将执行的操作数量。操作可以是从方法调用到变量赋值的任何内容。

浏览您的代码

```
 int[] result = new int[2 * list.length]; 
  for (int i = 0; i < list.length; i++) {
    result[2 * i] = list[i] / 2 + list[i] % 2; 
    result[2 * i + 1] = list[i] / 2; 
  }

  return result; 
```

重负载在`for`循环中。因为您循环`list.length`时间，所以此方法的大 O 是`O(list.length)`. 但是，为了彻底起见，您确实可以计算其他操作。当您分配一个新的 int 数组时，您会计算它。当您将数组中的索引计算`result`为时`2 * i`，您也将其计算在内。但是，由于这些操作需要固定的时间，它们会被循环所花费的可变时间所吞噬。

你应该阅读你的笔记，但你会了解到有不同级别的复杂性，常数、线性、对数等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T21:02:08.427

它开着）。因为只有一个 for 循环迭代。这取决于数组的长度，并且会线性增长。

# c# - SQL Server CE 查询异常

> ID：14780914
> 
> 赞同：0
> 
> 时间：2013-02-08T20:36:02.917
> 
> 标签：c#, asp.net, sql-server-ce

可能是一个简单的问题，但我对 ASP.net 很陌生，我不断收到异常

> *解析查询时出错。[令牌行号=1，令牌行偏移量=142，令牌错误=]*
> 
> *说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。*
> 
> *异常详细信息：System.Data.SqlServerCe.SqlCeException：解析查询时出错。[令牌行号=1，令牌行偏移量=142，令牌错误=]*

我要做的就是让我的网格视图只显示与用户在文本框中输入的内容相似的结果。

```
protected void Button1_Click(object sender, EventArgs e)
{
   string query = TextBox1.Text;
   string sql = "SELECT [Username], [Job Description] AS Job_Description, [Hours Worked] AS Hours_Worked, [Date], [ID] FROM [TimeData]"; // this one works fine 

   string sql2 = "SELECT [Username], [Job Description] AS Job_Description, [Hours Worked] AS Hours_Worked, [ID], [Date] FROM [TimeData] WHERE ([Username] == '" +query + "'";
   Response.Write("done");
   SqlDataSource1.SelectCommand = sql2;
} 
```

我正在使用本地`.SDF`文件中的数据源。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:38:21.430

看起来您在 sql2 末尾缺少右括号

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T20:44:17.160

正如@Adam 所说，您缺少右括号。此外，将 SQL 的“==”更改为“=”。

但是，将用户名 ( `query`var) 直接添加到 SQL 中会使您的应用程序遭受[SQL 注入](http://en.wikipedia.org/wiki/Sql_injection)攻击。您应该使用 SQL 参数，请参阅[http://www.dotnetperls.com/sqlparameter](http://www.dotnetperls.com/sqlparameter)示例。

# datetime - 带时间戳的循环批处理

> ID：14780915
> 
> 赞同：2
> 
> 时间：2013-02-08T20:36:03.603
> 
> 标签：datetime, for-loop, batch-processing, batch-rename

我需要在一个循环中重命名多个文件并包含一个时间戳......我的努力始于更新每个文件的时间戳，以便文件具有唯一的名称。

```
setlocal enabledelayedexpansion
SET date=%date:~-4,4%%date:~-10,2%%date:~-7,2%
for /f %%a in ('dir /b TCA_*') do (SET
time=%time:~-11,2%%time:~-8,2%%time:~-5,2%%time:~-2,2%  
ren %%a %date%TCA_%time%.txt) 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T02:06:05.837

在循环中，变量不会更新。为了解决这个问题，`setlocal enabledelayedexpansion`添加了脚本。

基本上，如果您希望它们更新，您需要用感叹号 (!) 而不是百分号 (%) 将它们括起来。

# c++ - 类中变量的排列

> ID：14780925
> 
> 赞同：0
> 
> 时间：2013-02-08T20:36:55.243
> 
> 标签：c++, class, memory

有个问题想请教大家。你们中的许多人会回答“没有区别”，但我有点坚持认为问题的措辞有所不同：

“哪个类使用的内存最少？”

他们要求一个单一的答案——一定有一个！我和以前的微软实习生聊过，他坚持没有答案。

也许有些人会愿意提供他们的想法？

```
Which class uses the least amount of memory?

class A 
{
    float duration;
    char code;
    int count;
    bool enabled;
};

class B 
{
    float duration;
    int count;
    char code;
    bool enabled;
};

class C
{
    char code;
    int count;
    bool enabled;
    float duration;
};

class D
{
    bool enabled;
    float duration;
    char code;
    int count;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:43:58.717

在 MSVC2010 我得到

A = 16 字节 B = 12 字节 C = 16 字节 D = 16 字节

这可能是由于不同类型的对齐。由于 char 和 bool 都很小，它们共享一个 DWORD。

然而，这是编译器和平台无关的。没有什么可以阻止编译器实现者将它们全部设为相同大小或将 char 设为 64 字节或其他任何内容。标准对这种事情的要求是相当宽松的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:46:55.890

答案 E，这个 :-)

```
class E
{
    float duration;
    char code;
    int count;
    bool enabled;
} __attribute__((packed)); 
```

其他例子没什么好说的，它真的取决于编译器，arch，......

# android - 在 Android ImageViews 中放大图像时如何防止像素混合

> ID：14780926
> 
> 赞同：0
> 
> 时间：2013-02-08T20:37:01.977
> 
> 标签：android, pixel

我想使用 16x16 图像并将它们炸毁，而不会在 Android 中混合像素。我知道它会非常像像素（这就是我想要的）。如何在保持像素完整的同时放大图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:54:20.287

只需确保在导入图像之前，它已经是您想要的大小，这样如果您在图像视图中使用它，图像质量将保持不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-24T13:09:55.473

我曾经有过同样的问题

[如何在android java中将图像加载为像素图像？](https://stackoverflow.com/questions/63555990/how-to-load-image-as-pixel-image-in-android-java/63561676#63561676)

这就是我解决它的方法

像素正方形的宽度 = 屏幕宽度 / 像素数

# c - 计算无符号整数中的位数

> ID：14780928
> 
> 赞同：2
> 
> 时间：2013-02-08T20:37:11.437
> 
> 标签：c, binary, bit-manipulation

我想编写一个`bitCount()`在文件中命名的函数：`bitcount.c`它返回其无符号整数参数的二进制表示形式的位数。

这是我到目前为止所拥有的：

```
#include <stdio.h>

int bitCount (unsigned int n);

int main () {
    printf ("# 1-bits in base 2 representation of %u = %d, should be 0\n",
        0, bitCount (0));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 1\n",
        1, bitCount (1));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 16\n",
        2863311530u, bitCount (2863311530u));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 1\n",
        536870912, bitCount (536870912));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 32\n",
        4294967295u, bitCount (4294967295u));
    return 0;
}

int bitCount (unsigned int n) {
    /* your code here */
} 
```

好的，当我运行它时，我得到：

```
# 1-bits in base 2 representation of 0 = 1, should be 0
# 1-bits in base 2 representation of 1 = 56, should be 1
# 1-bits in base 2 representation of 2863311530 = 57, should be 16
# 1-bits in base 2 representation of 536870912 = 67, should be 1
# 1-bits in base 2 representation of 4294967295 = 65, should be 32

RUN SUCCESSFUL (total time: 14ms) 
```

它不会返回正确的位数。

在 C 中返回其无符号整数参数的二进制表示形式的位数的最佳方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-11-21T21:35:33.523

这是一个不需要迭代的解决方案。它利用了这样一个事实，即在二进制中添加位完全独立于位的位置，并且总和永远不会超过 2 位。`00+00=00`, `00+01=01`, `01+00=01`, `01+01=10`. 第一次添加同时添加 16 个不同的 1 位值，第二次添加 8 个 2 位值，之后每个添加一半，直到只剩下一个值。

```
int bitCount(unsigned int n)
{
    n = ((0xaaaaaaaa & n) >> 1) + (0x55555555 & n);
    n = ((0xcccccccc & n) >> 2) + (0x33333333 & n);
    n = ((0xf0f0f0f0 & n) >> 4) + (0x0f0f0f0f & n);
    n = ((0xff00ff00 & n) >> 8) + (0x00ff00ff & n);
    n = ((0xffff0000 & n) >> 16) + (0x0000ffff & n);
    return n;
} 
```

这是硬编码为 32 位整数，如果您的大小不同，则需要调整。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-08T20:45:54.363

```
 int bitCount(unsigned int n) {

    int counter = 0;
    while(n) {
        counter += n % 2;
        n >>= 1;
    }
    return counter;
 } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-17T18:51:24.040

[事实证明，这里](https://stackoverflow.com/questions/109023/how-to-count-the-number-of-set-bits-in-a-32-bit-integer)有一些非常复杂的计算方法。

下面的 impl （我学过的）只是循环在每次迭代中敲掉最低有效位。

```
int bitCount(unsigned int n) {

  int counter = 0;
  while(n) {
    counter ++;
    n &= (n - 1);
  }
  return counter;
} 
```

# ruby-on-rails - 带有ajax的Rails checkbox_tag

> ID：14780929
> 
> 赞同：2
> 
> 时间：2013-02-08T20:37:12.243
> 
> 标签：ruby-on-rails, ajax, checkbox

我试图弄清楚如何使用 Rails 3.2.11 中的复选框通过 ajax 传递数据。我认为以下行

```
<%= check_box_tag(
        "institution_ids_#{inst.name.gsub(" ", "")}",
          inst.id,
          false,
        data: {
          remote: true,
          institution_id: inst.id}) %> 
```

当我更改复选框的状态时，我可以看到控制器被正确调用（特别是控制器的 index 方法，这是我想要的，因为那是我所在的视图），但是，我似乎无法从控制器上的 params 哈希访问机构 ID 变量。有人可以解释一下我如何使用 ajax 在复选框中将数据从视图传递到控制器。我认为 remote: true 函数会使用我设置的附加参数（它没有）正确调用控制器（确实如此）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T20:55:20.760

你为什么不使用 jquery 来`Ajax`拨打电话。

```
<%= check_box_tag( "institution_ids_#{inst.name.gsub(" ", "")}", inst.id, false %>

<script>
     $('#checkbox_id').change(function(){
        $.get('controller/action?inst_id='+$(this).val(), function(data,status){
            if(status == 'success'){
              alert(data)
             }
        })
     })
   </script> 
```

在控制器中：

```
def action
   inst_id = params[:inst_id]
   #do something
   render :text => "success" 
end 
```

# c# - 服务器没有收到客户端的消息

> ID：14780931
> 
> 赞同：0
> 
> 时间：2013-02-08T20:37:22.383
> 
> 标签：c#, websocket

我成功地用 C# 制作了一个可以连接的 WebSocket 服务器。我按照 RFC 6455 的要求进行握手。

无论我（通过`WebSocket.send()`）向它发送什么（例如“asd”），流都只有 9 个字节的数据，这些数据是 UTF8“无法表示的”。

```
using System.Net.Sockets;
using System.Net;
using System;
using System.Text;
using System.Text.RegularExpressions;
using System.Security.Cryptography;

class Server
{
    public static void Main()
    {
        TcpListener server = new TcpListener(IPAddress.Parse("127.0.0.1"), 80);

        server.Start();

        TcpClient client = server.AcceptTcpClient();
        NetworkStream stream = client.GetStream();

        Boolean isHandshaked = false;

        while (true)
        {
            while (!stream.DataAvailable)
            {
            }

            Byte[] bytes = new Byte[client.Available];

            stream.Read(bytes, 0, bytes.Length);

            if (!isHandshaked)
            {
                Byte[] response = Encoding.UTF8.GetBytes("HTTP/1.1 101 Switching Protocols" + Environment.NewLine
                    + "Connection: Upgrade" + Environment.NewLine
                    + "Upgrade: websocket" + Environment.NewLine
                    + "Sec-WebSocket-Accept: " + Convert.ToBase64String(
                        SHA1.Create().ComputeHash(
                            Encoding.UTF8.GetBytes(
                                new Regex("Sec-WebSocket-Key: (.*)").Match(
                                    Encoding.UTF8.GetString(bytes)
                                ).Groups[1].Value.Trim() + "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"
                            )
                        )
                    ) + Environment.NewLine
                     + Environment.NewLine);

                stream.Write(response, 0, response.Length);

                isHandshaked = true;
            }
            else
            {
                Console.WriteLine(Encoding.UTF8.GetString(bytes));
            }
        }
    }
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T12:13:38.270

客户端和服务器之间的消息不是以纯文本形式发送的。有关如何对它们进行编码/解码，请参阅标准的[数据帧](https://www.rfc-editor.org/rfc/rfc6455#section-5.2)部分。

对于您发送 3 字节字符串的客户端示例，这将导致消息

*   1 字节 - 0x81 - 表示这是一条非分段短信
*   1 字节 - 0x83 - 表示消息体长 3 个字节并且其内容被屏蔽（所有客户端 -> 服务器消息都使用屏蔽。服务器 -> 客户端消息不得被屏蔽）。如果消息被屏蔽，则设置最高位 (byte_val & 0x80)。剩余的 7 位 (byte_val & 0x7F) 使消息的长度最多为 125 个字节。有关如何确定较长消息的长度，请参阅下面的链接。
*   4 个字节 - 掩码。始终为 4 个字节。由客户端确定的内容，应针对每条消息进行更改
*   3 个字节 - 消息。可以使用规范[第 5.3 节中的掩码和算法进行解码。](https://www.rfc-editor.org/rfc/rfc6455#section-5.3)

您可以使用如下代码取消屏蔽消息

```
byte mask[4];
byte[] msg_data;
// read message, initialising mask, msg_data
for (int i=0; i<msg_data.Length; i++)
{
    msg_data[i] = msg_data[i] ^ mask[i%4]
} 
```

如果您需要更多详细信息，[前一篇文章](https://stackoverflow.com/questions/8125507/how-can-i-send-and-receive-websocket-messages-on-the-server-side/8125509#8125509)解释了消息发送/接收，并包含一些有用的伪代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:49:03.453

有一个空循环来检查数据 ie`while (!stream.DataAvailable){}`确实是您可以避免的不好的做法。

read 方法是 a `blocking method`，所以它会等到数据可用

```
int bufferSize = 1024; // change it as you want
byte[] message = new byte[bufferSize];
readLength = stream.Read(message, 0, bufferSize); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T21:49:47.863

您可以尝试下面的代码，看看它是否有效，我怀疑您没有阅读完整的回复。

```
 byte[] buffer = new byte[4155];
    int bytesRead = 0;

    using (var input = client.GetStream())
    {
      while (true)
                    {
                        bytesRead = input.Read(buffer, 0, buffer.Length);
                        totalBytes += bytesRead;
                        if (bytesRead > 0)
                            // keep processing ur data here, add it to another buffer maybe
                        else
                            break; // come out of while loop if there is no data
                    }

    }
  } 
```

# linux - 设备 sdb 上的缓冲区 I/O 错误

> ID：14780933
> 
> 赞同：3
> 
> 时间：2013-02-08T20:37:29.200
> 
> 标签：linux, usb

当我在 Linux 上的 USB 端口上连接我的手机（华为品牌）时，我收到以下错误消息`dmesg`：

```
[45771.099208] Buffer I/O error on device sdb, logical block 33
[45771.099212] Buffer I/O error on device sdb, logical block 33
[45771.099222] Buffer I/O error on device sdb, logical block 0
[45771.099225] Buffer I/O error on device sdb, logical block 0
[45771.099232] Buffer I/O error on device sdb, logical block 2
[45771.099236] Buffer I/O error on device sdb, logical block 2
[45771.099240] Buffer I/O error on device sdb, logical block 0
[45771.099243] Buffer I/O error on device sdb, logical block 0
[45771.099250] Buffer I/O error on device sdb, logical block 0
[45771.099257] Buffer I/O error on device sdb, logical block 512 
```

如果我在运行 Windows 时连接手机，则一切正常。我必须注意到我以前遇到过同样的问题，突然它才开始起作用。但是我重新安装了 Linux，现在我遇到了问题。有谁知道是驱动问题还是什么？

# android - Phonegap 设备准备好没有响应/触发

> ID：14780935
> 
> 赞同：0
> 
> 时间：2013-02-08T20:37:36.287
> 
> 标签：android, cordova

我正在编写一个使用 Sqlite 在本地存储数据的移动应用程序。在过去的 4 天里，我一直试图弄清楚为什么当 Jquery 和 phonegap 完全加载时没有创建数据库。sqlite 中的 create 语句不起作用，回调函数也不起作用。deviceready 不起作用，但如果检查 sqlite 支持它会触发。示例代码是别人的代码，但同样的事情发生了。有人可以帮帮我吗？

```
var jqmReady = $.Deferred(),
pgReady = $.Deferred();

// jqm page is ready
$(document).bind("pageinit", jqmReady.resolve);

// phonegap ready
document.addEventListener("deviceready", pgReady.resolve, false);

// all ready, throw a custom 'onDeviceready' event
$.when(jqmReady, pgReady).then(function(){
  $(document).trigger("onDeviceready"); 
});

function onDeviceReady(){
        db.transaction(populateDB, errorCB, successCB);
    }

    //create table and insert some record
    function populateDB(tx) {
        tx.executeSql('CREATE TABLE IF NOT EXISTS SoccerPlayer (id INTEGER PRIMARY KEY AUTOINCREMENT, Name TEXT NOT NULL, Club TEXT NOT NULL)');
        tx.executeSql('INSERT INTO SoccerPlayer(Name,Club) VALUES ("Alexandre Pato", "AC Milan")');
        tx.executeSql('INSERT INTO SoccerPlayer(Name,Club) VALUES ("Van Persie", "Arsenal")');
    }

    //function will be called when an error occurred
    function errorCB(err) {
        alert("Error processing SQL: "+err.code);
    }
    //function will be called when process succeed
    function successCB() {
        alert("success!");
        db.transaction(queryDB,errorCB);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T01:28:08.787

我没有在模拟器或物理设备上运行它，但通过查看代码，我可以立即看到一个问题。试试这个，看看它是否有帮助：

改变

```
$.when(jqmReady, pgReady).then(function(){
     $(document).trigger("onDeviceready"); 
}); 
```

至

```
$.when(jqmReady, pgReady).then(function(){
     onDeviceReady();
}); 
```

我建议更改的原因是因为`$(document).trigger("onDeviceready")`触发了“onDeviceready”事件。您没有设置侦听器来捕获该事件，我假设您想要它做的是调用“onDeviceReady()”函数。

# c - 将字符串从一个指针复制到另一个

> ID：14780937
> 
> 赞同：0
> 
> 时间：2013-02-08T20:37:43.243
> 
> 标签：c, pointers

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char * find_dot();
char * find_end();

int main(int argc, char * argv[]){

  char *file_extension[10];

  int i;
  for(i = 1; i < argc; i++){

    //if an option
    if(argv[i][0] == '-'){
      switch(argv[i][0]){

        default:;
      }

    //otherwise, should be the file
    }else{ 
      char *dot_location_ptr;
      char *end_location_ptr;
      char *filename_ptr = argv[i];

      dot_location_ptr = find_dot(filename_ptr);
      end_location_ptr = find_end(filename_ptr);

      memcpy(file_extension, dot_location_ptr, end_location_ptr - dot_location_ptr); 
```

find_dot 返回指向“。”的指针。在参数中，使用 strrchr，find_end 返回指向参数中 '\0' 的指针。

它编译，但我得到一个分段错误。我要做的就是将文件扩展名捕获为字符串，并将该扩展名与其他字符串进行比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:40:09.180

> ```
> char *file_extension[10];
>      ^ 
> ```

你说的`file_extension`不对。您需要一个 char 数组，而不是指针数组。放下`*`.

# unix - replace string using UNIX commands

> ID：14780942
> 
> 赞同：0
> 
> 时间：2013-02-08T20:37:55.910
> 
> 标签：unix

I want to replace the first occurrence of search pattern with something and rest with something else as:

```
aaa
bbb
ccccc
country
dddd
country
frrffr4
grtgt
gthth
country
dddrr 
```

here I want **country** to be replaced. First occurence of countryshould be **my_country** and rest of the occurences with **our_country** as:

```
aaa
bbb
ccccc
my_country
dddd
our_country
frrffr4
grtgt
gthth
our_country
dddrr 
```

Is there any command to do this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:44:35.363

Try this:

```
awk 'BEGIN {r="my_country"} /country/ {print r; r="our_country"; next} {print}' 
```

# ruby-on-rails - 将依赖于值的数据属性添加到 simple_form 复选框集合

> ID：14780943
> 
> 赞同：7
> 
> 时间：2013-02-08T20:37:57.353
> 
> 标签：ruby-on-rails, forms, simple-form, custom-data-attribute

我正在为单个集合生成一个复选框列表，如下所示：

```
= f.input :parts, as:check_boxes, collection: @parts_list 
```

我希望集合中的一些复选框消失/重新出现，具体取决于表单中较高的选择小部件的值。（例如从Robot select中选择“Tracker Robot”意味着“Legs”部分复选框消失，“Wheels”复选框出现等）

我想做的是将计算数据属性附加到每个单独的零件复选框，属性值列出可以使用该零件的机器人；然后一些 JS 将完成隐藏/显示复选框的工作。但是，我不知道如何使用 simple_form 生成这些数据属性。

我通常会创建一个自定义“部件”输入，但制作自定义集合输入似乎有问题；它在 form_builder.rb 中寻找一个命名方法 (collection_parts)，但它不存在，如果我尝试扩展 FormBuilder，它会让我陷入一个大兔子洞。

我可以编写一些 JS 来将数据属性加载到生成的 HTML 中，但是我必须根据我的 Rails 数据生成自定义 JS，这感觉是错误的做法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T00:18:26.123

假设表单用于`Order`模型，并且您正在`parts`根据名为 的字段的值更改集合`region`。

更新表单视图。指定表单、`region`字段和`parts`字段的 ID。

```
= simple_form_for(@order, :html => { :id => "order-form"}) do |f|
  = f.input :region, :wrapper_html => { :id => "order-form-region",                      |
      "data-parts-url" => parts_orders_path(:id => @order.id, :region => @order.region)} |

  = f.input :parts, as: check_boxes, collection: @parts_list,                            |
      :wrapper_html => { id' => 'parts-check-box-list'}                                  | 
```

`parts`添加在`route.rb`文件中调用的新操作。

```
resources :orders do
  collection do
    get :parts
  end
end 
```

将新操作添加到您的控制器

```
class OrdersController < ApplicationController

  # expects id and region as parameters
  def parts
    @order =  params[:id].present? ? Order.find(params[:id]) : Order.new
    @parts_list = Part.where(:region => params[:region])
  end
end 
```

添加助手

```
def parts_collection(order, parts_list)
  "".tap do |pc| 
    # to generate the markup for collection we need a dummy form
    simple_form_for(order) do |f| 
      pc << f.input(:parts, as: check_boxes, collection: parts_list, 
        :wrapper_html => {:id => 'parts-check-box-list'})
    end
  end
end 
```

为动作添加一个 js 视图 ( `orders/parts.js.erb`)

```
$('#parts-check-box-list').replaceWith('<%= j(parts_collection(@order, @parts_list)) %>'); 
```

`region`为您的字段注册数据更改事件处理程序`application.js`

```
$(document).ready(function() {
  $('#order-form').on("change", "#order-form-region", function () {
    // Access the data-parts-url set in the region field to submit JS request
    $.getScript($(this).attr('data-parts-url'));
  });
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-16T22:16:53.940

我认为你可以这样做：

```
= f.input :parts do
  = f.collection_check_boxes :parts, @parts_list, :id, :to_s, item_wrapper_tag: :label, item_wrapper_class: :checkbox do |b|
    - b.check_box(data: { YOUR DATA ATTRIBUTES HERE }) + b.text 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T16:03:28.917

这可能更简单。

**假设**

```
@robots - an array containing the list of robots
@parts - a hash containing a list of parts for each robot 
```

**示例代码**

```
# controller
@robots = %w[tracker nontracker]
@parts = { tracker: %w[wheels lcd resistor], nontracker: %w[lcd resistor] }

# view
= f.input :robots, as: :select, collection: @robots, input_html: { id: 'robot-select' }

#parts-list

:javascript
  var parts = #{@parts.to_json};

  $(document).ready(function() {
    $('#robot-select').change(function() {
      $('#parts-list').html('');

      $(parts[$(this).val()]).each(function(index, text) {
        $('#parts-list').append('<input type="checkbox" value=' + text + '>' + text + '</input>')
      })          
    })
  }) 
```

如果您克隆[https://github.com/jvnill/simple_form_search_app](https://github.com/jvnill/simple_form_search_app)并转到`/robots`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T23:00:03.820

SimpleForm 中的一些输入选项接受为集合中的每个项目调用的 lambda：

```
f.input :role_ids, :collection => (1..10).to_a,
  :label_method => :to_i, :value_method => :to_i,
  :as => :check_boxes, :required=> true,
  :disabled => ->(item){ item.even? } 
```

但`input_html`似乎不是其中之一。

解决方案可能是创建一个应用数据属性本身的自定义 SimpleForm 集合输入。也许没有那么灵活，但我认为这是目前唯一的方法。

[GitHub 上有一个教程页面](https://github.com/plataformatec/simple_form/wiki/Adding-custom-input-components)可以帮助您入门。

# java - 使用我的公共 IP 创建 ServerSocket java

> ID：14780947
> 
> 赞同：1
> 
> 时间：2013-02-08T20:38:25.607
> 
> 标签：java, ip, serversocket

好吧，这是我的代码：

```
import java.io.InputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.net.Socket;
import java.net.ServerSocket;
import java.net.InetAddress;
import java.net.UnknownHostException;

public class TcpServerEcho {

public static void main(String argv[]) {

    int port = Integer.parseInt(argv[0]);
    ServerSocket server_socket = null;

    try {

        InetAddress thisIp = InetAddress.getByName("kiravaio.homepc.it");
        System.out.println(thisIp.getHostAddress());

        //or
        //server_socket = new ServerSocket(port, 10, InetAddress.getByName("79.47.49.68"));
        server_socket = new ServerSocket(port, 10, thisIp);

    }
    catch (Exception e) {
        System.err.println("Impossible to create socket server!");
        System.out.flush();
        System.exit(1);
    }

    System.out.printf("Server active on port: %d and on address %s\n", port, server_socket.getInetAddress());

    Socket client_socket = null;
    boolean exec = true;

    while(exec) {

        try {

            client_socket = server_socket.accept();

            InputStream is = client_socket.getInputStream();

            OutputStream os = client_socket.getOutputStream();

            boolean stop = false;

            System.out.println("Received: ");

            while(!stop) {
                int b = is.read();
                System.out.print((char)b);
                if(b == -1) {stop = true;}
                else {os.write( (byte)b );}
            }

        }

        catch (IOException ioe) {
            System.err.println("Error I/O!");
        } finally {
            try {
                client_socket.close();
            }

            catch (IOException ioe) {}
            }

        System.out.println("");
    }

    try {
        /* Never executed */
        server_socket.close();
    } catch (IOException ioe) {}
}

} 
```

我无法在我的公共 IP 上创建一个套接字。我有一个域 kiravaio.homepc.it 每次我的 ip public 更改时都会更新。首先，我使用 InetAddress thisIp = InetAddress.getByName("kiravaio.homepc.it"); 获取我的 IP 地址 然后我创建套接字： server_socket = new ServerSocket(port, 10, thisIp); 但它总是失败，我不知道为什么，只有在 127.0.0.1 上创建一个套接字才有效！:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:45:26.330

查找`homepc.it`显示这是一个 dyndns 服务域名。该域名解析为您的*路由器*的 IP，而不是您的 PC。

您的 PC 将有一个由您的路由器分配给它的专用网络 IP 地址（例如 192.168.1.x）（您的 PC 使用该 IP 与执行 NAT（网络地址转换）的路由器通信）。

您必须绑定到该地址（或仅使用构造函数，`ServerSocket`因为它只需要一个端口；这将绑定到`0.0.0.0`( `INADDR_ANY`) 并侦听所有接口），并配置您的路由器以将您选择的端口转发到该 IP 地址。

（如果你不知道怎么做，你应该查阅你的路由器手册或者向[https://superuser.com/](https://superuser.com/)发个问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:46:02.460

我坚信对于 ServerSocket，您不需要指定要使用的 ip 地址，只需执行 new ServerSocket(port)，客户端应该能够通过您的动态域进行连接。

# ruby-on-rails - heroku PostgreSQL 数据库迁移错误

> ID：14780960
> 
> 赞同：1
> 
> 时间：2013-02-08T20:39:22.653
> 
> 标签：ruby-on-rails, postgresql, heroku

当我尝试在 heroku 中迁移 postgres 数据库时出现错误。首先我得到：

```
$ heroku run rake db:migrate --trace
rake aborted!
undefined method `find_by_name' for Gem::Specification:Class
/app/lib/tasks/auto_annotate_models.rake:22:in `<top (required)>'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/depen                                        dencies.rb:245:in `load'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/depen                                        dencies.rb:245:in `block in load'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/depen                                        dencies.rb:236:in `load_dependency'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/depen                                        dencies.rb:245:in `load'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:425:in `b                                        lock in load_tasks'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:425:in `e                                        ach'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:425:in `l                                        oad_tasks'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/application.rb:145:                                        in `load_tasks'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/railtie/configurabl                                        e.rb:30:in `method_missing'
/app/Rakefile:7:in `<top (required)>'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/rake_module.rb:25:in `lo                                        ad'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/rake_module.rb:25:in `lo                                        ad_rakefile'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:583:in `r                                        aw_load_rakefile'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:89:in `bl                                        ock in load_rakefile'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `s                                        tandard_exception_handling'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:88:in `lo                                        ad_rakefile'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:72:in `bl                                        ock in run'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `s                                        tandard_exception_handling'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:70:in `ru                                        n'
/app/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/app/vendor/bundle/ruby/1.9.1/bin/rake:19:in `load'
/app/vendor/bundle/ruby/1.9.1/bin/rake:19:in `<main>' 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:18:40.220

在进行迁移之前，您是否执行过 heroku run rake db:create？

# android - jmockit 和 robolectric 可以共存吗？

> ID：14780965
> 
> 赞同：6
> 
> 时间：2013-02-08T20:39:38.637
> 
> 标签：android, robolectric, jmockit

我正在尝试使用 Robolectric 实现单元测试来替换 android.jar 中的存根方法，同时还使用 jMockit 来模拟 Android 类（在我的例子中是片段）。但是，我似乎无法让它工作。如果我用 注释测试类`@RunWith(RobolectricTestRunner.class)`，我得到：

> java.lang.IllegalStateException：JMockit 未正确初始化；检查 jmockit.jar 在类路径中是否位于 junit.jar 之前（如果使用 JUnit；如果没有，请查看文档）

如果我使用`@RunWith(JMockit.class)`或不使用`@RunWith`，我会得到“存根！” 例外。

目前，我的类路径按以下顺序排列：robolectric、jmockit、junit、android。

有没有人能够让 jmockit 和 robolectric 一起玩得很好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T04:46:46.997

这应该是可能的。我没有对此进行测试，但您可以创建自己的测试运行器。

查看 JMockit 和 Robolectric 测试运行器的源代码：

*   [机器人电动](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/RobolectricTestRunner.java)
*   [JMockit](https://code.google.com/p/jmockit/source/browse/trunk/main/src/mockit/integration/junit4/JMockit.java)

在这两个中，Robolectric 一个要复杂得多，因此我们不想复制该功能。JMockit 测试运行程序相当简单。它应该可以扩展 RobolectricTestRunner 并包含 JMockit 功能。

```
import mockit.internal.startup.*;
class MyTestRunner extends RobolectricTestRunner {

   static { Startup.initializeIfNeeded(); }

   /**
    * Constructs a new instance of the test runner.
    *
    * @throws InitializationError if the test class is malformed
    */
   public MyTestRunner(Class<?> testClass) throws InitializationError
   {
      super(testClass);
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-09T06:19:13.990

在版本 1.8（2014 年 4 月 27 日）中，JMockit 可以与 Robolectric 结合使用。

```
JMockit now works fine with the Robolectric Android testing tool (tested with Robolectric 2.2 and 2.3). 
```

[http://jmockit.org/changes.html](http://jmockit.org/changes.html)

# c# - 如何从 InternetExplorer 对象查看源 HTML？

> ID：14780981
> 
> 赞同：1
> 
> 时间：2013-02-08T20:40:50.530
> 
> 标签：c#, .net

当我实例化一个 IE 对象并导航到一个 url 时，我不知道如何从该地址获取源 HTML 代码。

这是我正在使用的代码：

```
SHDocVw.InternetExplorer IE = new SHDocVw.InternetExplorer();
IE.Visible = false;
IE.Navigate("www.testsite.com"); 
```

我想要类似的东西：

```
string source = IE.ToSource(); 
```

所以我可以检查它的内容。我能做到这一点吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T20:52:56.080

试试看：

```
SHDocVw.InternetExplorer IE = new SHDocVw.InternetExplorer();
IE.Visible = false;
IE.Navigate("www.testsite.com");
mshtml.IHTMLDocument2 htmlDoc 
         = IE.Document as mshtml.IHTMLDocument2;
string content = htmlDoc.body.outerHTML; 
```

您可以从 body.parent 属性访问整个 HTML 字符串：

```
string content = htmlDoc.body.parent.outerHTML; 
```

[你可以在这里看到一个很好的例子（c++ 中的例子）](http://www.codeproject.com/Articles/8923/Retrieving-the-HTML-source-code)

# c# - 更改 Web 应用程序的语言 c#

> ID：14780984
> 
> 赞同：0
> 
> 时间：2013-02-08T20:40:59.260
> 
> 标签：c#, asp.net, globalization

我已经进行了一些研究，而这样做的唯一方法似乎是在 Web 应用程序的每个页面中覆盖 InitializeCulture 方法。事情是，我的应用程序有 80 页，所以我想知道是否有另一种更容易的方法。

```
 protected override void InitializeCulture()
    {
        if (Session["CultureLang"] != null)
        {
            string selectedLanguage = Session["CultureLang"].ToString();
            if (selectedLanguage == "True")
                selectedLanguage = "en-US";
            Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(selectedLanguage);
            Thread.CurrentThread.CurrentUICulture = new CultureInfo(selectedLanguage);
        }
        base.InitializeCulture();
    } 
```

我在 web.config 文件中有这个：

```
<globalization culture="auto" uiCulture="auto" requestEncoding="UTF-8" responseEncoding="UTF-8" fileEncoding="UTF-8"/> 
```

注意：我更改语言的按钮位于自定义 web 控件中，如果这有任何改变的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:55:24.187

`class`添加一个包含文化感知代码的基础怎么样，然后你的 80 多个页面继承自这个基础类。

就像是：

```
public abstract class CultureAwarePage : Page
{
   protected override void InitializeCulture() { ... }
}

public partial class MyPage1 : CultureAwarePage
{
  ...
} 
```

# java - Google 的 j2objc 可以处理和转换二进制 JAR 文件吗？

> ID：14780991
> 
> 赞同：3
> 
> 时间：2013-02-08T20:41:29.057
> 
> 标签：java, ios, objective-c, j2objc

我希望开始使用移动开发（特别是 iOS），虽然我通常很擅长学习语言，但 Objective-C 几乎每一次都让我感到困惑。因此，查看 j2objc（因为我已经了解 Java），我认为它可能符合我所寻找的要求。

不过，我的问题非常简单：转换器能否正确处理我的源代码引用的情况，例如，仅二进制（字节码）JAR 文件中的 Apache Commons 代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-10T17:40:17.567

不，j2objc 需要源代码（它使用 Eclipse 编译器的前端）。不过，[RoboVM 项目](http://www.robovm.org/)使用类文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T03:50:13.510

J2objc 适合只编写一次业务逻辑。如果您打算为 Android、iOS 和 GWT 编写应用程序，请使用它。但是你总是需要为 UI、网络和其他特定平台的东西（相机、地理定位等）编写本机代码。如果你打算成为一名移动开发专家，我的建议是现在就开始学习 Objective-c（两年前我和你一样。我花了时间学习 Objective-c，这是成为跨平台的唯一途径移动极客:-)。我从这本书开始：Objective-C 2.0 编程（Stephen G. Kochan）。祝你好运 ！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-22T10:03:31.913

否：j2objc 需要源代码。但是 j2objc 允许编译引用 .jar 文件的源代码。但是带有 .class 文件的 jar 文件不会被转译

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-08T21:07:39.860

我也来自 Java 背景，并且自己学习了 Objective-C（并且也教过它）。

如果你真的想为 iOS 开发移动应用程序，最好的办法就是投资学习 Objective-C。J2ObjC 不足以创建 iOS 应用程序，因为它不提供 UI 支持并且还不稳定（介于 alpha 和 beta 质量之间）

```
J2ObjC does not provide any sort of platform-independent UI toolkit, nor are there any plans to do so in the future. 
```

Objective-C一开始看起来很奇怪，特别是对于有Java或C/C++背景的人来说，但是一旦学会了；你会开始欣赏这种语言。

[这是一门很好的入门课程](https://itunes.apple.com/ca/itunes-u/developing-apps-for-ios-sd/id395631522)，Apple 提供了学习 iOS 开发和 Objective-C 的优秀资源。

我强烈怀疑任何*语言翻译*工具，例如 J2ObjC，是否足以构建好的 iOS 应用程序。

# qt - Qt 通过 HTTP 流式传输大文件并刷新到 eMMC Flash

> ID：14780996
> 
> 赞同：6
> 
> 时间：2013-02-08T20:41:42.323
> 
> 标签：qt, http, streaming, qfile, qtembedded

我正在一个内存非常有限的嵌入式 Linux 设备上通过 HTTP 将一个大文件 ( 1Gb ) 流式传输到我在 Qt 中的服务器。当我第一次收到标头时，我确定将数据写入文件系统的哪个位置，创建一个指向该位置的 QFile 指针，然后打开文件进行追加。服务器中有一个“累积”函数，每次新数据到达套接字时都会调用该函数。从那个累积函数中，我想通过 write() 将数据流式传输到文件中。您可以在下面看到我的累积功能。

我的问题是执行此操作时的内存使用情况——我的内存不足。我不应该能够在每次累积迭代中刷新（）和 fsync（），而不必担心 RAM 的使用吗？我做错了什么，我该如何解决？谢谢 -

我在累积功能之前打开我的文件一次：

```
// Open the file
filePointerToWriteTo->open(QIODevice::WriteOnly | QIODevice::Append | QIODevice::Unbuffered) 
```

这是累加函数的一部分：

```
// Extract the QFile pointer from the QVariant
QFile *filePointerToWriteTo = (QFile *)(containerForPointer->pointer).value<void *>();

qDebug() << "APPENDING bytes: " << data.length();

// Write to the file and sync
filePointerToWriteTo->write(data);
filePointerToWriteTo->waitForBytesWritten(-1);
filePointerToWriteTo->flush(); // Flush
fsync(filePointerToWriteTo->handle()); // Make sure bytes are written to disk 
```

编辑：

我检测了我的代码，“waitForBytesWritten(-1)”调用总是返回“false”。文档说这应该等到数据写入设备。

此外，如果我只取消注释“写入（数据）”行，那么我的可用内存永远不会减少。会发生什么？“写”是如何消耗这么多内存的？

编辑：

现在我正在做以下事情。我没有用完内存，但我的可用内存下降到 2Mb 并悬停在那里，直到整个文件被传输。此时，内存被释放。如果我在中间终止传输，内核似乎会保留内存，因为它保持大约 2Mb 的空闲空间，直到我重新启动进程并尝试写入同一个文件。我仍然认为我应该能够在每次迭代中使用和刷新内存：

```
// Extract the QFile pointer from the QVariant
QFile *filePointerToWriteTo = (QFile *)(containerForPointer->pointer).value<void *>();

int numberOfBytesWritten = filePointerToWriteTo->write(data);
qDebug() << "APPENDING bytes: " << data.length() << " ACTUALLY WROTE: " << numberOfBytesWritten;

// Flush and sync
bool didWaitForWrite = filePointerToWriteTo->waitForBytesWritten(-1); // <----------------------- This ALWAYS returns false!
filePointerToWriteTo->flush(); // Flush
fsync(filePointerToWriteTo->handle()); // Make sure bytes are written to disk
fdatasync(filePointerToWriteTo->handle()); // Specific Sync
sync(); // Total sync 
```

编辑：

这听起来像是我误解了 Linux 缓存。阅读这篇文章 --> [http://blog.scoutapp.com/articles/2010/10/06/determining-free-memory-on-linux](http://blog.scoutapp.com/articles/2010/10/06/determining-free-memory-on-linux)后，我可能误解了“free -mt”的输出。我一直在观察该输出中的“免费”字段，并看到它在大量文件传输中下降到 2MB 左右。我只想看到它在文件传输完成后恢复到高水平的免费数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T19:14:25.477

我认为 Linux 只是在缓存它可以缓存的所有东西，并在 2MB 可用内存限制附近释放它可以腾出的东西。在 512 MB RAM 系统上接收或发送约 2Gb 的文件时，我不会耗尽内存。在我的 Qt 程序中，在接收到所有数据后，附加到文件并关闭文件。我在 QProcess 中执行以下操作，以在单独的终端中的“free -mt”命令中查看我的“空闲”内存返回：

```
// Now we've returned a large file - so free up cache in linux
QProcess freeCachedMemory;
freeCachedMemory.start("sh");
freeCachedMemory.write("sync; echo 3 > /proc/sys/vm/drop_caches"); // Sync to disk and clear Linux cache
freeCachedMemory.waitForFinished();
freeCachedMemory.close(); 
```