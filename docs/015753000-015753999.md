# StackOverflow 问答 15753000-15753999

# observablecollection - Observable 的一般使用

> ID：15753001
> 
> 赞同：0
> 
> 时间：2013-04-01T22:25:37.037
> 
> 标签：observablecollection, system.reactive, observable

尽管我不时在我的代码中使用 Observable 和 Rx，但在“推送模型”及其使用方面，我仍然有这个问题。

例如，假设我有这个简单的代码：

```
 private readonly static List<string> numbers = new List<string>
  {
      "1",
      "2",
      "3",
      "4",
      "5"
  };

  static void Main(string[] args)
  {
      PrintCollection();
      Console.ReadLine();
      numbers.Add("6");
      Console.ReadLine();
  }

  private static void PrintCollection()
  {
      IObservable<string> observable = numbers.ToObservable();
      observable.Subscribe<string>(x => { Console.WriteLine(x); });
  } 
```

当程序运行时，只会打印 1-5，但不会打印 6，除非我使用 ObservableCollection 之类的东西并连接“CollectionChanged”事件。然而，这让我想知道“推送模型”到底是什么。我一直认为“推送模型”意味着一旦数据（集合）订阅了一个事件，所有新添加到该集合的数据也将订阅同一个事件。

此外，我看到的大多数使用 Observable 的示例似乎都是 WPF、视图模型驱动的实现，我想知道是否有人将它用于任何后端处理，典型的例子是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:55:17.733

我认为您对 ToObservable 的作用感到困惑 - 基本上，它说“看到这组东西？我想创建一个新的流，将这些值反馈给我。” 它不会以任何有意义的方式“包装”源列表，例如监听未来的变化，它更多的是及时的快照 - 生成的 observable 就是创建 observable 时该列表的样子。

有很多方法可以对集合的“实时视图”进行建模 - 您已经提到过：创建一个 ObservableCollection 并通过写入 CollectionChanged 事件来创建可观察对象。您也可以在此处使用 Subject，尽管它将状态的概念注入 rx 的“无状态”世界。

实际上，需要强调的一点是：rx 流在概念上比传统的命令式/oo 编程更具“功能性”；您随着时间的推移声明一个潜在值流，而不是状态机（尽管您可以强制它像状态机一样工作）......您弄清楚随着时间的推移您想要/需要“查看”的值是什么，这就是您声明的方式你的流。

然而，在这样的特定情况下，声明一个随机变化的值流是很困难的。这可以通过其他方式（事件、轮询等）更好地满足。

也就是说，你可以这样写：

```
var numbers = new List<string>
{
    "1",
    "2",
    "3",
    "4",
    "5"
};
var source = new ObservableCollection<string>(numbers);
var query = Observable.Create<string>((obs) =>
    {
        foreach(var oldItem in source)
        {
            obs.OnNext(oldItem);
        }
        NotifyCollectionChangedEventHandler h;
        h = (o, e) => 
        {
            Console.WriteLine("Collection changed!");
            foreach(var item in e.NewItems)
            {
                obs.OnNext(item as string);
            }
        };
        source.CollectionChanged += h;
        return Disposable.Create (() => source.CollectionChanged -= h);
    });

using(query.Subscribe(Console.WriteLine))
{
    source.Add("6");
    Console.ReadLine();
} 
```

输出：

```
1
2
3
4
5
Collection changed!
6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T13:34:51.533

在订阅之前，您可以将 Observables 连接在一起：

```
var numbers = new List<string> { "1", "2", "3", "4", "5" }.ToObservable();
numbers = numbers.Concat(new [] { "6" }.ToObservable());
numbers.Subscribe(n => Console.WriteLine(n), ex => Console.WriteLine(ex.ToString()), () => Console.WriteLine("Completed.")); 
```

输出：
1 2 3 4 5 6 完成。

您可以使用主题并在订阅后添加项目（这是一个显示事情发生时间/地点的示例）：

```
var subject = new ReplaySubject<string>();
subject.OnNext("7");
subject.Subscribe(n => Console.WriteLine(n), ex => Console.WriteLine(ex.ToString()), () => Console.WriteLine("Completed."));
subject.OnNext("8");
numbers.Subscribe(n => subject.OnNext(n));
subject.OnNext("9");
subject.OnNext("10"); 
```

输出：7 8 1 2 3 4 5 6 9 10

您还询问是否有使用 Rx 进行后端处理的示例。我敢说那是它主要使用的地方，但我没有任何确凿的证据支持这一点。它绝对不仅仅是 WPF，它还有更广泛的应用程序。这是 ObservableCollection，我相信它更像是 WPF 的东西，因为它用于数据绑定，而 ObservableCollection 不是 Rx 的一部分。

希望有帮助。

# c# - 保留字符串的 Xml 编码字符

> ID：15753004
> 
> 赞同：3
> 
> 时间：2013-04-01T22:25:47.207
> 
> 标签：c#, linq-to-xml

我需要更新一个 XML 文档；使用 C#，最好是 Linq To Xml。源 XML 文件具有以下节点：

```
<characters>Lorem &#xD;Ipsum</characters> 
```

我需要将此节点更新为如下内容：

```
<characters>Lorem1 &#xD;Ipsum2</characters> 
```

当我从 Xml 中读取字符串时；我明白了：

```
"Lorem &#xD;Ipsum" 
```

当我使用

```
copyEl.SetElementValue(ns + "characters", "Lorem1 &#xD;Ipsum2"); 
```

输出的 Xml 具有被重新转义的编码字符的前导 & 符号：

```
 <characters>Lorem1 &amp;#xD;Ipsum2</characters> 
```

我想按原样保留原始字符串中的 Xml 编码；但我不确定如何去做。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:31:54.517

使用 Linq-to-XML 或任何 xml 抽象类的美妙之处在于您无需担心字符串编码。只需将字符串作为 C# 字符串传入，然后让 linq 为您将其转换为 XML 字符串：

```
copyEl.SetElementValue(ns + "characters", "Lorem1 \rIpsum2"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:55:49.060

您的 xml 中有空格，您可以使用[http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.whitespacehandling.aspx以各种方式处理](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.whitespacehandling.aspx)

# f# - F# TypeProvider "XMLProvider" 给出 System.Exception

> ID：15753005
> 
> 赞同：4
> 
> 时间：2013-04-01T22:25:51.093
> 
> 标签：f#, type-providers, f#-data

我正在尝试使用 XML 类型提供程序处理 Twitter 推文，如下面的代码所示。该代码在使用 LINQ XElement 函数访问推文数据值时工作正常，但是在使用由 XMLProvider 创建的类型时，它会失败并出现异常提示：“XML 不匹配：预期只有一个 'title' 子级”。我知道没有给出命名空间，但是，如果需要，我不知道如何通过提供者指定它们。

```
// ...

open FSharp.Net
open FSharp.Data

let ns = "http://www.w3.org/2005/Atom"

// General helpers for XML

let xelem s (el: XContainer) = el.Element(XName.Get(s, ns)) 
// ...
let xvalue (el: XElement) = el.Value

let twitterUri = "http://search.twitter.com/search.atom?q=Windows8&rpp=100&lang=en"
type Tweets = XmlProvider<"SampleTweets.xml", Global=false>

let feed = Tweets.Load twitterUri

// title 0 & 1 produce correct values

let title0 = feed.XElement |> xelem "title" |> xvalue
let title1 = feed.XElement |> xelem "entry" |> xelem "title" |> xvalue

// title 2 produces: "XML mismatch: Expected exactly one 'title' child"

let title2 = feed.Title
let title3 = feed.GetEntries().[0].Title 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T14:45:03.937

这是 FSharp.Data 中的一个错误，与 xml 中有一个默认命名空间有关`xmlns="http://www.w3.org/2005/Atom"`。

版本 1.1.3 修复了此问题，但您也可以执行以下操作作为解决方法：

```
[<Literal>]
let twitterUri = "http://search.twitter.com/search.atom?q=Windows8&rpp=100&lang=en"
type Tweets = XmlProvider<twitterUri>

let feedXml = (Http.Request twitterUri).Replace("xmlns=\"http://www.w3.org/2005/Atom\"", null)

let feed = Tweets.Parse feedXml
let t = feed.Title 
```

# objective-c - 被封装的数据，不能传递给另一个类

> ID：15753006
> 
> 赞同：0
> 
> 时间：2013-04-01T22:25:57.970
> 
> 标签：objective-c

我在 DifficultySelection 中创建了一个变量（难度），当我尝试从 CharacterSelection 访问这个变量时，结果 = 0，所以我猜测某处的封装存在问题。

**难度选择.h：**

```
@class CharacterSelection;
@interface DifficultySelection : UIViewController
{
    CharacterSelection *charPage;
    UIButton *normalDifficulty;
    int difficulty;

}

- (IBAction)normalDifficulty:(id)sender;

@property (strong) CharacterSelection *charPage;
@property (strong) DifficultySelection *diffPage;    
@property (strong, nonatomic) IBOutlet UIButton *normalDifficulty;
@property (nonatomic, readwrite) int difficulty;
@end 
```

**难度选择.m：**

```
#import "DifficultySelection.h"
#import "CharacterSelection.h"

@interface DifficultySelection ()  
@end

@implementation DifficultySelection
@synthesize normalDifficulty, charPage, diffPage, difficulty;

- (IBAction)normalDifficulty:(id)sender {
    if (! self.charPage)
        self.charPage = [[CharacterSelection alloc] initWithNibName:nil bundle:nil];
    self.difficulty = 1;
    charPage.diffPage = self;
    [self.navigationController pushViewController:self.charPage animated:YES];

}
@end 
```

**字符选择.h：**

```
#import "DifficultySelection.h"
@class MainGameDisplay;
@class DifficultySelection;

@interface CharacterSelection : UIViewController <UIScrollViewDelegate> {
    MainGameDisplay *openGame;
    DifficultySelection *diffPage;
}

@property (nonatomic, readwrite) CharacterSelection *charPage;    
@property (strong) DifficultySelection *diffPage;
@property (nonatomic, readwrite) int difficulty;
@end 
```

**字符选择.m：**

```
#import "CharacterSelection.h"
#import "MainGameDisplay.h"

@interface CharacterSelection ()
@end

@implementation CharacterSelection
@synthesize diffPage, charPage;

- (void)viewDidLoad
{
    self.difficulty = charPage.diffPage.difficulty;
    printf("Diff:%i %i", self.difficulty, diffPage.difficulty);
    //Both of these output 0, encapsulation problem.
}
@end 
```

# d3.js - 为什么我在这个 d3 代码中的缩放错误？

> ID：15753007
> 
> 赞同：0
> 
> 时间：2013-04-01T22:26:06.270
> 
> 标签：d3.js, css-transforms, scaletransform, translate3d

此代码在此处实时运行：http: [//domtree.breckyunits.com](http://domtree.breckyunits.com)

稍微偏离的部分是缩放行为。当我放大一个点时，它会正确放大，但会转换到错误的点。我觉得我需要同时进行某种类型的转换/翻译，但我不太确定如何理解这些东西。我对线性代数和向量/矩阵的练习很少。

需要工作的部分代码是重绘函数：

```
var redraw = function () {
  vis.attr("transform", "scale(" + d3.event.scale + "," + d3.event.scale + ") "
    + "translate(" + d3.event.translate[0] + "," + d3.event.translate[1] + ")");
} 
```

[您可以在https://github.com/breck7/domtree/blob/master/domtree.js](https://github.com/breck7/domtree/blob/master/domtree.js)查看所有代码

vis 在前面的代码中定义：

```
vis = d3.select("#body").append("svg:svg")
    .attr("viewBox", "0 0 " + w + " " + h )
    .call(d3.behavior.zoom().on("zoom", redraw))
    .attr("preserveAspectRatio", "xMidYMid meet")
    .append("svg:g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T14:19:59.370

不要在 [Object] "vis" 中包含 .call() 以简化调试

阅读其他帖子： [d3.js zoom xScale / xAxis](https://stackoverflow.com/questions/10433951/d3-js-zoom-xscale-xaxis/14927154#14927154)

```
var vis, zm; // as global !
vis.call(zm=d3.behavior.zoom().on("zoom", draw));
function draw() {
    console.log(zm.scale(), zm.translate());
} 
```

# unit-testing - 如何在 AngularJS 的指令单元测试中注入服务

> ID：15753009
> 
> 赞同：27
> 
> 时间：2013-04-01T22:26:13.430
> 
> 标签：unit-testing, angularjs, jasmine, angularjs-directive

我需要测试一个对某些注入服务进行调用的指令。以下代码是一个示例指令，它侦听事件，并在指定元素内按下 Enter 时重定向浏览器。

编辑：*我觉得我可能正在涉足 E2E 测试领域？*

```
angular.module('fooApp')
  .directive('gotoOnEnter', ['$location', function ($location) {

    var _linkFn = function link(scope, element, attrs) {

        element.off('keypress').on('keypress', function(e) {
                  if(e.keyCode === 13)
                  {
                       $location.path(scope.redirectUrl);
                  }
              });
    }

    return {
      restrict: 'A',
      link: _linkFn
    };
  }]); 
```

问题是我还没有弄清楚如何注入服务以在指令中监视它们。

我提出的解决方案如下所示： *它不起作用，正如预期的那样，因为我没有成功地注入`$locacion`服务以进行监视。*

```
describe('Directive: gotoOnEnter', function () {
  beforeEach(module('fooApp'));

  var element;

  it('should visit the link in scope.url when enter is pressed', inject(function ($rootScope, $compile, $location) {

    element = angular.element('<input type="text" goto-on-enter>');
    element = $compile(element)($rootScope);

    $rootScope.redirectUrl = 'http://www.google.com';
    $rootScope.$digest();

    var e = jQuery.Event('keypress');
    e.keyCode = 13;
    element.trigger(e);

    spyOn($location, 'path');

    expect($location.path).toHaveBeenCalledWith('http://www.google.com');
  })); 
```

**这产生**

```
Expected spy path to have been called with [ 'http://www.google.com' ] but it was never called. 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-07T18:00:39.420

要装饰、存根、提供模拟或覆盖任何给定的服务，您可以使用该`$provide`服务。 `$provide.value`等`$provide.decorator`文档[在这里](https://docs.angularjs.org/api/auto/service/$provide)。

然后你可以做这样的事情：

```
 var $location;

 beforeEach(function() {
    module('studentportalenApp', function($provide) {
      $provide.decorator('$location', function($delegate) {

        $delegate.path = jasmine.createSpy();

        return $delegate;
      });
    });

    inject(function(_$location_) {
      $location = _$location_;
    });

  }); 
```

...

```
it('should visit the link in scope.redirectUrl when enter is pressed', inject(function ($rootScope, $compile, $location) {
    element = angular.element('<input type="text" goto-on-enter>');
    element = $compile(element)($rootScope);

    $rootScope.redirectUrl = 'http://www.google.com';
    $rootScope.$digest();

    var e = jQuery.Event('keypress');
    e.keyCode = 13;
    element.trigger(e);

    $rootScope.$digest();

    expect($location.path).toHaveBeenCalledWith('http://www.google.com');

})); 
```

# php - 使用 PHP 按特定顺序合并多个 PNG 图像

> ID：15753010
> 
> 赞同：0
> 
> 时间：2013-04-01T22:26:18.090
> 
> 标签：php, image, merge, png

我在 SOF 上找到了将 PNG 图像与透明胶片合并在一起的代码：

```
$imgl = "thumb/pattern.png";
$img2 = "thumb/frame.png";

$dest = imagecreatefrompng($imgl);
$src = imagecreatefrompng($img2);
imagecolortransparent($src, imagecolorat($src, 0, 0));

$src_x = imagesx($src);
$src_y = imagesy($src);
imagecopymerge($dest, $src, 0, 0, 0, 0, $src_x, $src_y, 100);

// Output and free from memory
header('Content-Type: image/png');
imagegif($dest);

imagedestroy($dest);
imagedestroy($src); 
```

但是，我有多个要合并的图像，并且我想按特定顺序合并这些图像。我怎样才能改变这个代码来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T22:41:11.930

未经测试，但你得到了一般的想法。注意内存限制和执行时间限制

```
$imgl = "thumb/pattern.png";
$img = imagecreatefrompng($imgl);

$aImg = array('img2.png','img3.png');

foreach($aImg as $sImg){
 $src = imagecreatefrompng($sImg);
 imagecolortransparent($src, imagecolorat($src, 0, 0));
 $src_x = imagesx($src);
 $src_y = imagesy($src);
 imagecopymerge($dest, $src, 0, 0, 0, 0, $src_x, $src_y, 100);
} 
```

# java - 雅虎商店订单 API 访问

> ID：15753012
> 
> 赞同：2
> 
> 时间：2013-04-01T22:26:25.823
> 
> 标签：java, yahoo, yahoo-api

我有一段时间试图弄清楚这个 Yahoo Store API 的东西。我已经在互联网上搜索了示例，但几乎一无所获。我已经创建了我的请求：

```
String data = "";
data += "<?xml version=\"1.0\" encoding=\"utf-8\" ?>";
data += "<ystorewsRequest>";
data += "<StoreID>" + storeID + "</StoreID>";
data += "<SecurityHeader>";
data += "<PartnerStoreContractToken>" + token + "</PartnerStoreContractToken>";
data += "</SecurityHeader>";
data += "<Version> 1.0 </Version>";
data += "<Verb> get </Verb>";
data += "<ResourceList>";
data += "<OrderListQuery>";
data += "<Filter>";
data += "<Include> all </Include>";
data += "</Filter>";
data += "<QueryParams>";
data += "<OrderID> 5441 </OrderID>";
data += "</QueryParams>";
data += "</OrderListQuery>";
data += "</ResourceList>";
data += "</ystorewsRequest>"; 
```

并尝试将数据发送到 API 文档中列出的 URL： [https](https://MyStoreID.order.store.yahooapis.com/V1/order) ://MyStoreID.order.store.yahooapis.com/V1/order （存储在字符串地址中）

```
url = new URL(address);

HttpURLConnection conn = (HttpURLConnection)url.openConnection();
conn.setDoOutput(true);
conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
conn.setRequestMethod("POST");

String urlParameters = "query=" + data;

DataOutputStream wr = new DataOutputStream (
          conn.getOutputStream ());
  wr.writeBytes (urlParameters);
  wr.flush ();
  wr.close ();

BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));

line = rd.readLine();
rd.close(); 
```

结果我收到了这个错误；

```
java.io.IOException: Server returned HTTP response code: 400 for URL: https://MyStoreID.order.store.yahooapis.com/V1/order
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(Unknown Source) 
```

我几乎完全迷失了这一点，因为雅虎提供了一些糟糕的文档，而且我找不到任何示例。有没有人尝试过使用来自 Java 的 Yahoo API 调用连接到 Yahoo Store？在这一点上的任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T19:51:53.503

我能够弄清楚这一点。所以我会为其他人发布解决方案。这是一个 PHP 脚本，它将请求有关订单号 5863 的所有信息。我可以从 java 程序中调用 PHP 脚本并根据需要从那里解析结果。

```
<?php

//build xml request
$data = "<?xml version='1.0' encoding='utf-8'?>";
$data .= "<ystorewsRequest>";
$data .= "<StoreID>your store id</StoreID>";     //insert your store id
$data .= "<SecurityHeader>";
$data .= "<PartnerStoreContractToken>your token</PartnerStoreContractToken>";  //insert your token`
$data .= "</SecurityHeader>";
$data .= "<Version>1.0</Version>";
$data .= "<Verb>get</Verb>";
$data .= "<ResourceList>";
$data .= "<OrderListQuery>";
$data .= "<Filter>";
$data .= "<Include>all</Include>";
$data .= "</Filter>";
$data .= "<QueryParams>";
$data .= "<OrderID>5863</OrderID>";
$data .= "</QueryParams>";
$data .= "</OrderListQuery>";
$data .= "</ResourceList>";
$data .= "</ystorewsRequest>"; 

//send request to yahoo order api
$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER, 0);    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);    
curl_setopt($ch, CURLOPT_URL, "https://your_store_id.order.store.yahooapis.com/V1/order");          //insert your store id
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
$content=curl_exec($ch);

//print raw xml data returned from yahoo
echo htmlentities( $content);
?> 
```

# c# - LINQ：选择不同于 lst 并将不同的属性附加到一个中

> ID：15753015
> 
> 赞同：0
> 
> 时间：2013-04-01T22:26:37.047
> 
> 标签：c#, linq

我有以下问题，我想寻求帮助。我必须选择不同的值（一个属性的标准），然后从其余属性中提取不同的值。

假设我有以下课程，其中每个课程`BOM`都有一个或多个`FlatComponents`不同的`Parts`and `QtyPer`。

例子：

```
public sealed class BOM {
    public string FlatComponent {
        get;
        set;
    }

    public string Part {
        get;
        set;
    }

    public string QtyPer {
        get;
        set;
    }

    public BOM(String flatComponent, String part, String qtyPer) {
        this.FlatComponent=flatComponent;
        this.Part=part;
        this.QtyPer=qtyPer;
    }
} 
```

```
List<BOM> list=new List<BOM>();
list.Add(new BOM("a", "1", "2"));
list.Add(new BOM("a", "3", "4"));
list.Add(new BOM("b", "5", "6"));
list.Add(new BOM("c", "7", "8"));
list.Add(new BOM("c", "9", "0")); 
```

如何`FlatComponents`使用 LINQ（以逗号分隔）在每个属性中选择不同的值及其不同的值？

```
结果 = [
    ["a", "1, 3", "2, 4"],
    [“b”，“5”，“6”]，
    ["c", "7, 9", "8, 0"]
    ]

```

我试过使用`.Distinct()`，但我对 LINQ 很陌生......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:52:57.153

试试这个：

```
var result = list
    .GroupBy(e => e.FlatComponent)
    .Select(e => new BOM
        {
            FlatComponent = e.Key,
            Part = string.Join(", ", e.Select(x => x.Part)),
            QtyPer = string.Join(", ", e.Select(x => x.QtyPer))
        }); 
```

它将`BOM`为每个创建一个不同的`FlatComponent`，将`Part`和`QtyPer`属性与`", "`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:47:49.473

我想不出一种方法可以在一个表达式中完成所有操作（并且仍然可以理解），但是这里有一些代码可以满足您的需求：

[编辑：没有注意到您将零件和数量作为单个字符串，这改变了它：]

```
var groups = list.GroupBy(item => item.FlatComponent);
List<List<string>> result = new List<List<string>>();

foreach (var group in groups) {
    var current = new List<string>();
    current.Add(group.Key);
    current.AddRange(group.Select(grp => string.Format("{0}, {1}", grp.Part, grp.QtyPer)));
    result.Add(current.Distinct().ToList());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T22:47:50.737

您通常可以在 LINQ 中使用`GroupBy`. 这会以您为所需结果提供的格式生成结果：

```
IEnumerable<string[]> asEnumerable = list.GroupBy(bom => bom.FlatComponent).Select(grouping => new string[] { grouping.Key, string.Join(", ", grouping.Select(bom => bom.Part)), string.Join(", ", grouping.Select(bom => bom.QtyPer)) });
string[][] asStringArray = asEnumerable.ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T22:50:52.737

```
// For convenience add read-only property
public sealed class BOM
{
    ...
    public string PartAndQuantity { get{return Part + ", " + QtyPer;} }
}

// Group by FlatComponent and then use string.Join:
var result = list.GroupBy (l => l.FlatComponent).Select(
    g => new 
    {
        Flat=g.Key, 
        Parts=string.Join(", ", g.Select (x => x.PartAndQuantity))
    }); 
```

这将导致

```
Flat Parts 
a    "1, 2, 3, 4"
b    "5, 6"
c    "7, 8, 9, 0" 
```

但是你可能想要

```
var result = list.GroupBy (l => l.FlatComponent).Select(
    g => new 
    {
        Flat=g.Key, 
        Parts=g.Select (x => x.PartAndQuantity).ToList()
    }); 
```

# machine-learning - Weka 中的训练和测试集不兼容

> ID：15753018
> 
> 赞同：1
> 
> 时间：2013-04-01T22:26:42.820
> 
> 标签：machine-learning, classification, weka

我有一个训练集。我在训练集上执行了以下过滤器，

1.  四分位数范围和 RemoveWithValues（用于删除异常值和极值）。
2.  替换缺失值。
3.  NumerictoNominal

我使用了带有交叉验证的朴素贝叶斯分类器（10 折）。准确率达到 62%。保存了模型。

我对测试数据使用了“NumerictoNominal”过滤器。测试数据有缺失值，Class 属性也为空。测试和训练数据中属性的数量和顺序是相同的。

当我在 Weka 中使用 Supplied test set 选项运行 Naive bayes 时，我收到一个错误，说训练和测试数据不兼容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T06:24:25.487

请参阅[我](https://stackoverflow.com/questions/10947015/does-test-file-in-weka-requires-same-or-less-number-of-features-as-train/10947334#10947334)对这个问题的回答。您需要在测试和训练文件中使用相同的标头信息。

# javascript - javascript 中来自 crypto.randomBytes() 的浮点数

> ID：15753019
> 
> 赞同：4
> 
> 时间：2013-04-01T22:26:43.193
> 
> 标签：javascript, math, cryptography

如何将从 crypto.randomBytes 返回的字节数组转换为浮点数？我正在为 Math.random() 写一个小的替代品

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T18:54:41.197

假设您有一系列随机选择的字节，它们在 [0, 256) 上均匀分布。取其中的七个字节，比如一个[0]，一个[1]，……一个[6]。计算 (((((((a [6] % 32)/32 + a [5] )/256 + a [4] )/256 + a [3] )/256 + a [2] )/256 + a [1] )/256 + a [0] )/ 256.

解释：a [6] % 32 表示[6]模 32 的余数。这需要[6]的 5 位。然后除以 32 将这些位“移动”到小数点的右侧，添加 8 个新位，除以 256 将“移动”右 8 位，依此类推，直到我们有 53 位。

这在 [0, 1) 中提供了 2 ^(53个可能的结果。)可以提供更多，因为随着值接近零，浮点分辨率会更好，但随之而来的是一致性问题和其他问题。

# java - 显示 Activity 后加载布局

> ID：15753020
> 
> 赞同：0
> 
> 时间：2013-04-01T22:26:53.720
> 
> 标签：java, android, layout, android-activity

我有一个需要加载的资源密集型布局，它可以在我的 Nexus 4 上运行，延迟大约一秒。我无法想象在速度较慢的设备上会是什么样子，这是它的主要用途；因此我需要一种加载活动的方法，并显示一个空白布局。然后在设备缓冲布局时构建布局。我已经尝试放入`setContentView(R.layout.main);`，`AsyncTask`但问题仍然存在（可能是因为我在 期间调用它`onCreate`）。有人对如何解决这个问题有任何建议吗？提前致谢。

编辑：有点像 Facebook 应用程序，但不完全一样。加载背景的东西，然后在处理信息时加载信息，而不是等到它全部预加载然后显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:52:09.873

显示一个空白布局，可能带有进度条、活动指示器，甚至是默认图像。准备好布局后，将其换入。如果您想在 UI 部分可用时显示它们，请加载单个视图。

布局是 UI 的整体框架。您应该在您的应用启动时尽快显示它，以便用户知道您的应用在那里。之后，您可以随时投入资源。

[查看将操作发送到多个线程](http://developer.android.com/training/multiple-threads/index.html)的示例应用程序。这是一个图像查看器，其主布局相当无趣。图像在解码时显示。

# haskell - 编写一个 Eq 实例

> ID：15753021
> 
> 赞同：-4
> 
> 时间：2013-04-01T22:26:58.553
> 
> 标签：haskell, instance

我有这个功能：

```
func:: [[[Char]]] -> Int -> [(Int,Int,[Char],[Char],[Char],[Char],[Char],[Char],[Char],[Char])] -> [[[Char]]] 
func mymap scope klkl = 
```

该函数在 GHCi 上运行良好，但是当我在 Hugs 上运行此代码时，出现此错误：

```
Hugs> :l asdf
ERROR "asdf.hs":238 - Instance of Eq (Int,Int,[Char],[Char],[Char],[Char],[Char],[Char],[Char],[Char]) required for definition of func 
```

你能告诉我如何为 Hugs 解决这个问题吗？我已经有一个`show`10 元组的函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:45:11.410

你的典型`Eq`例子就像他们来的一样脑残。我将举一个三元组的例子，你可以用你最喜欢的编辑器将它扩展成一个 10 元组。

```
instance (Eq a, Eq b, Eq c) => Eq (a, b, c) where
    (a, b, c) == (a', b', c') = a == a' && b == b' && c == c' 
```

# php - 正则表达式匹配除 / 以外的所有内容：

> ID：15753025
> 
> 赞同：3
> 
> 时间：2013-04-01T22:27:09.853
> 
> 标签：php, regex, preg-match

我正在编写一个正则表达式，它应该执行以下操作：

如果匹配的段以 开头，则匹配不是 / 不匹配的所有内容：

例子：

**asdjhas** /* *fdjkl* */ **sdfds:dsfsdf** /:sdff/ **sdffff**

粗体部分应与正则表达式匹配。正如你所看到的，所有的正斜杠都不匹配，只有以 : 开头的部分不匹配。

我想出了这个： ([^/]+) 可以按预期工作，但它也会匹配以 : 开头的部分。我尝试使用否定的前瞻性断言，但老实说，我真的不理解它们。

我也在使用 PHPs preg 库为我做匹配。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:35:38.507

我认为这就是您所需要的，并且它确实适用于您的测试字符串：

```
preg_match_all('@
   (?:    # start group
     ^    # start of string
     |    # OR
     /    # slash character
    )     # end grouping
    (     # start capture
    [^:/] # character class of anything except colon and slash
    .*?   # anything until...
    )     # end capture
    (?=   # start lookahead
    /     # literal slash (lookahead is used so it is not consumed
          # which allows a slash to be used to start the next group)
    |     # OR
    $     # end of the string
    )     # end lookahead
    @x', $str, $matches); 
```

编辑：使用lookbehind`(?<=`而不是`(?:`似乎也可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:51:28.697

你可以拆分字符串

```
/(?::[^/]+/*)? 
```

IE

```
$string = 'asdjhas/*fdjkl*/sdfds:dsfsdf/:sdff/sdffff';

$parts = preg_split('#/(?::[^/]+/*)?#', $string);

/*
Array
(
    [0] => asdjhas
    [1] => *fdjkl*
    [2] => sdfds:dsfsdf
    [3] => sdffff
)
*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T22:46:54.780

另一种简单的方法是使用[preg_split()](http://php.net/manual/en/function.preg-split.php)代替：

```
$string = 'asdjhas/fdjkl/sdfds:dsfsdf/:sdff/sdffff';
$m = preg_split('/\/(:[^\/]*\/?)?/', $string);
print_r(array_filter($m)); 
```

结果：

```
Array
(
    [0] => asdjhas
    [1] => fdjkl
    [2] => sdfds:dsfsdf
    [3] => sdffff
) 
```

# c++ - 需要 c++ 语法错误帮助，缺少 ';' 前 '}'

> ID：15753029
> 
> 赞同：2
> 
> 时间：2013-04-01T22:27:36.470
> 
> 标签：c++, syntax-error

```
else if((RI >= 181) && (RI <= 210)){
        if((ICT1 = false) || ((ICT2 = false) || (ICT3 = false))){
        cout << "ICT \n";
        if(ICT1 = false){
            ICT1 = true;
            goto endICT;
        }
        if(ICT2 = false){
            ICT2 = true;
            goto endICT;
        }
        if(ICT3 = false){
            ICT3 = true;
            goto endICT;
        }
            endICT:
    } 
```

你好呀！这只是我程序的一部分，这段代码出现了几次，有不同的变量和其他东西。当我编译代码时，我得到“错误 C2143：语法错误：缺少';' 在'}'之前“我是所有这些编码的新手，希望有任何帮助！谢谢你的时间！编辑：对不起，我之前没有包含足够的代码！基本上是选择一个随机数，如果它在一个范围内，它会通过这部分。此范围只能选择 3 次，因为第一个“如果”将不成立。感谢您迄今为止的所有帮助！错误也在“endICT：”行中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:29:01.997

只需插入一个空语句：

```
 if(ICT3 = false){
        ICT3 = true;
        goto endICT;
    }
        endICT: ;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-01T22:47:16.033

首先请注意，使用`goto`语句被认为是一种不好的做法。只有在没有其他选择的情况下才应该使用它。

这段代码还有更多的东西。我在代码中添加了一些注释

```
if(ICT3 = false) //this will assign value false into variable ICT3
     //you might want to write if(ICT3 == false) to compare and execute
{
   ICT3 = true;
   goto endICT; //this goto statement is completely redundant
}

//I assume that you want to have some code here, that does not execute
//if ICT3 == false in the first place... You should use if() ... else
//statement instead

endICT: ; //You are missing some ; here should be enough
} 
```

有关 C/C++ 中的流控制语句的更多信息，[请转到此处](http://www.tutorialspoint.com/ansi_c/c_control_statements.htm)。有关 C/C++ 中运算符的更多信息，请[尝试此](http://www.tutorialspoint.com/cprogramming/c_operators.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T22:29:21.160

可能编译器与您的标签 endICT 混淆：

然后是关闭）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T22:06:01.583

这在语义上等同于您发布的代码：

```
else if ( RI >= 181 && RI <= 210 )
{
    cout << "ICT \n";
    if ( ! ICT1 )
        ICT1 = true;
    else if ( ! ICT2 )
        ICT2 = true;
    else if ( ! ICT3 )
        ICT3 = true;
} 
```

# javascript - 引导水平滚动间谍？

> ID：15753033
> 
> 赞同：3
> 
> 时间：2013-04-01T22:28:04.107
> 
> 标签：javascript, jquery, twitter-bootstrap, scroll, scrollspy

我正在成功使用 Bootstrap 的 scrollspy，但我想在目标锚点水平级联的页面上使用它。我已经调整无济于事，无法使其正常工作。我也试过[https://gist.github.com/marcoleong/1922743](https://gist.github.com/marcoleong/1922743)没有成功。

请在[http://jsfiddle.net/AzSWV/2/](http://jsfiddle.net/AzSWV/2/)上查看我的小提琴，它适用于调用`$('body').scrollspy();`

您最初可以看到垂直滚动间谍工作。**取消注释 CSS 并更新 fiddle 以查看水平布局。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-02T15:07:09.910

通过分别用or替换所有出现的`top`or并分别`Top`用`left`or替换or来解决这个问题。我还更改了目标元素。`Left``height``Height``width``Width`

[http://jsfiddle.net/AzSWV/19/](http://jsfiddle.net/AzSWV/19/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-19T16:29:45.777

我需要类似的东西，但比我在网上找到的任何东西都要干净一些，所以我自己做了。

摆弄每个幻灯片项目的多列：[https ://jsfiddle.net/darcher/dLmyhgzq/249/](https://jsfiddle.net/darcher/dLmyhgzq/249/)

一切都是 CSS 驱动的，除了将`active`类分配给正确的`nav-link`，这需要额外的 javascript。

```
$(function() {

  var parent = document.querySelector('.scrollspy-h-container');
  var parentDimensions = parent.getBoundingClientRect();
  var parentX = parentDimensions.x;

  parent.querySelectorAll('.nav-link').forEach(function(item, index, array) {
    item.setAttribute('aria-controls', item.href);
    item.classList.remove('active');
    array[0].classList.add('active');
  });

  parent.addEventListener('scroll', function () {

    var items = document.querySelectorAll('.scrollspy-h-item');
    var arr = [];

    items.forEach(function (item, index, array) {

      var itemDimensions = item.getBoundingClientRect();
      var itemX = itemDimensions.x;
      arr[index] = itemX;

      var itemId = item.id;
      var itemBtn = document.querySelector('a[href="#' + itemId + '"]');
      itemBtn.setAttribute('data-index', index);

      itemBtn.classList.contains('active') && itemBtn.classList.remove('active');

    });

    var closest = arr.reduce(function(prev, curr, index, array) {
      return  (Math.abs(curr - parentX) < Math.abs(prev - parentX) ? curr : prev)
    });

    arr.map(function(item, index, array){
      (item === closest) && document.querySelector('[data-index="' + index  + '"]').classList.add('active');
    });

  });

});
```

```
@import 'https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css';

html {
  scroll-behavior: smooth;
}

body {
  height: 1000px;
}

.pull-right{float:right}

.nav {
  position: relative;
  z-index: 2;
  transform:translate(-5px, 80px);
}

.scrollspy-h-container {
  overflow-x: scroll;
  scroll-behavior: smooth;
  width: 100%;
  border-radius: .25rem;
}

.scrollspy-h {
  position: relative;
  width: calc(100% * 4);
}

.scrollspy-h>.scrollspy-h-item {
  display: inline-block;
  padding:5rem 0;
  float: left;
  width: calc(100% / 4);
  text-align: center;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>

<div class="container-fluid">

  <div class="row">
    <div class="col p-4">
      <nav class="pull-right">
        <ul class="nav nav-pills pull-right" id="scrollspy-h">
          <li class="nav-item">
            <a class="nav-link text-light active" href="#item-1">Link 1</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#item-2">Link 2</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#item-3">Link 3</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#item-4">Link 4</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="scrollspy-h-container">
        <div data-spy="scroll" data-target="#scrollspy-h" data-offset="88" class="scrollspy-h">
          <div class="scrollspy-h-item bg-success" id="item-1">
            <h2 class="display-4">Link 1</h2>
            <p>This is the first pane that you'll see in the scroller</p>
          </div>
          <div class="scrollspy-h-item bg-warning" id="item-2">
            <h2 class="display-4">Link 2</h2>
            <p>This is the second pane that you'll see in the scroller</p>
          </div>
          <div class="scrollspy-h-item bg-info" id="item-3">
            <h2 class="display-4">Link 3</h2>
            <p>This is the third pane that you'll see in the scroller</p>
          </div>
          <div class="scrollspy-h-item bg-danger" id="item-4">
            <h2 class="display-4">Link 4</h2>
            <p>This is the fourth pane that you'll see in the scroller</p>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-07T05:31:12.387

我通过参考这个简约的垂直滚动间谍：http: [//jsfiddle.net/mekwall/up4nu/](http://jsfiddle.net/mekwall/up4nu/)

在没有看到您的 [实际] 代码的情况下，我无法真正专门为您更改我的值，但使用它应该不会太难：

```
$(document).ready(function(){
    var lastId;
    //change this selector to the section containing your menu items
    var pickerMenu = $("#sliderInner");
    var menuItems = pickerMenu.find("a");
    //finds the anchors to be linked to
    var scrollItems = menuItems.map(function(){
        var item = $($(this).attr("href"));
        if(item.length){ return item; }
    });

    //if you are scrolling the body rather than an overflow div change #main to body
    $('#main').scroll(function(){
        var currentItem = scrollItems.map(function(){
            //currently uses center of the screen as active location
            //feel free to place the $(window) section with 0 to go from left
            //or remove the the /2 to have from the right
            if($(this).offset().left < ($(window).width()/2)){
                return this;
            }
        });
        currentItem = currentItem[currentItem.length - 1];

        var id = currentItem && currentItem.length ? currentItem[0].id : "";
        if (lastId !== id) {
            lastId = id;

        //adds the class 'active' to the parent of the link
        menuItems
            .parent().removeClass("active")
            .end().filter("[href=#"+id+"]").parent().addClass("active");
        }
    });
    //set first item to active
    menuItems.first().parent().addClass("active");
}); 
```

编辑：根据您的要求使用您的测试数据更新您的小提琴[http://jsfiddle.net/AzSWV/12/](http://jsfiddle.net/AzSWV/12/)

EDIT2：您可能想要包含一些方便的向下滚动以向左滚动内容.. 在[https://github.com/brandonaaron/jquery-mousewheel](https://github.com/brandonaaron/jquery-mousewheel)上查看 Brandon Aaron 的 jQuery Mousewheel 插件并将其与此结合：

```
$("#main").mousewheel(function(e, delta) {
    this.scrollLeft -= (delta * 50);
    e.preventDefault();
}); 
```

# angularjs - 如何在angularjs中显示数组中的一项？

> ID：15753037
> 
> 赞同：1
> 
> 时间：2013-04-01T22:28:32.040
> 
> 标签：angularjs, angularjs-scope, angularjs-routing

所以我为一个简单的应用程序编写前端，我坚持一件事。有一个新闻列表页面应该将用户带到单个新闻页面。

所有新闻都在一个数组中，它位于新闻控制器中：

```
'use strict';

NaturaApp.controller('NewsCtrl', function($scope, $routeParams) {
$scope.$on('$routeUpdate', function(value) {

});
$scope.categories = [{
tout: "tout",
produits: "produits"}];

var categories = {
tout: "tout",
produits: "produits"
};

$scope.newsOne = [{
id: '1',
categoryID: categories.tout,
name: 'One Lorem ipsum.',
thumb: 'http://lorempixel.com/90/90/nature',
shot: 'Lorem ipsum dolor sit amet.',
cont: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Commodi necessitatibus natus ullam.'},
{
id: '2',
categoryID: categories.tout,
name: 'Two Lorem ipsum.',
thumb: 'http://lorempixel.com/90/90/animals',
shot: 'Lorem ipsum dolor sit amet.',
cont: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Impedit labore.'},
{
id: '3',
categoryID: categories.tout,
name: 'Three Lorem ipsum.',
thumb: 'http://lorempixel.com/90/90/abstract',
shot: 'Lorem ipsum dolor sit amet.',
cont: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Id aliquid quidem obcaecati numquam nobis nam!'}];

$scope.newsTwo = [{
id: '1',
categoryID: categories.produits,
name: 'One CAT2 Lorem ipsum.',
thumb: 'http://lorempixel.com/90/90/sports',
shot: 'Lorem ipsum dolor sit amet.',
cont: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Commodi necessitatibus natus ullam.'},
{
id: '2',
categoryID: categories.produits,
name: 'Two CAT2 Lorem ipsum.',
thumb: 'http://lorempixel.com/90/90/cats',
shot: 'Lorem ipsum dolor sit amet.',
cont: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Impedit labore.'},
{
id: '3',
categoryID: categories.produits,
name: 'Three CAT2 Lorem ipsum.',
thumb: 'http://lorempixel.com/90/90/food',
shot: 'Lorem ipsum dolor sit amet.',
cont: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Id aliquid quidem obcaecati numquam nobis nam!'}];
}); 
```

这是新闻列表页面，正常工作：

```
<ul class="list">
<li ng-repeat="newsOne in newsOne">
<a href="#/news/{{newsOne.id}}" data-transition="slide-in">
<span>
<img src="{{newsOne.thumb}}"/>
</span>
<span>
<b>{{newsOne.name}}</b><br>
{{newsOne.shot}}
</span>
<span class="chevron"></span>
</a>
</li>
</ul> 
```

老实说，我不知道如何使一个选定的新闻可见...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:44:27.320

[在这里](http://plnkr.co/edit/3yV7WHVJFU5SCoNhnlAz?p=preview)工作 plnkr

在您的**路由配置中**：

```
NaturaApp.config(['$routeProvider', function($routeProvider) {

    $routeProvider        
        .when('/news/', {
            templateUrl: 'news.html',
            controller: 'NewsCtrl',
        })      
        .when('/news/:id', {
            templateUrl: 'news-post.html',
            controller: 'NewsCtrl',
        });

}]); 
```

**学校控制：**

```
NaturaApp.controller('NewsCtrl', ['$scope', '$routeParams', function($scope, $routeParams) {

    var listOfNews = [....];

    if($routeParams.id)
    {
       $scope.news = listOfNews[$routeParams.id];
    }
    else
    {
       $scope.news = listOfNews;
    }        

}]); 
```

在您 看来： **news.html**：

```
<div ng-repeat="newspost in news">
   <h1>{{newspost.title}}</h1>
</div> 
```

**新闻-post.html：**

```
<h1>{{newspost.title}}</h1>
<p>{{newspost.content}}</p> 
```

# ruby-on-rails - 如何通过表单中的下拉菜单设置新对象的 belongs_to 关联？

> ID：15753038
> 
> 赞同：1
> 
> 时间：2013-04-01T22:28:37.783
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model, associations, model-associations

所以我是 Rails 的新手，我刚刚浏览完 Michael 的 Hartl 的 railstutorial.org。我现在正在构建我的第一个应用程序，并且遇到了我的第一个障碍。

所以基本上我有泡泡（相当于主题）和谣言。谣言属于泡泡，泡泡有很多谣言。创建新谣言时，用户必须选择它所属的泡泡。

我创建了我的 2 个模型，如下所示：

```
class Bubble < ActiveRecord::Base
  attr_accessible :description, :name

  has_many :rumors, dependent: destroy

  validates :description, presence: true, length: { maximum: 300 }
  validates :name, presence: true, length: { maximum: 50 }
end 
```

和

```
class Rumor < ActiveRecord::Base
  attr_accessible :content, :title, :bubble_id

  belongs_to :bubble

  validates :title, presence: true, length: { maximum: 30 }
  validates :content, presence: true, length: { maximum: 300 }
  validates :bubble_id, presence: true
end 
```

创建新 Rumor 的表单呈现在主页上：

```
<%= simple_form_for(@rumor) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :title %>
    <%= f.input :content %>
    <%= f.input :bubble_id, collection: @bubbles %>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %> 
```

因此，我在我的 StaticPagesController 中定义了变量：

```
def home
  @bubbles = Bubble.all
  @rumor = Rumor.new
  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @bubble }
  end
end 
```

我的 Bubble 控制器如下： class BubblesController < ApplicationController

```
 before_filter :authenticate_user!, only: [:create, :edit, :destroy]

  # GET /bubbles
  # GET /bubbles.json
  def index
    if params[:tag]
      @bubbles = Bubble.tagged_with(params[:tag])
    else
      @bubbles = Bubble.all
    end
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @bubbles }
    end
  end

  # GET /bubbles/1
  # GET /bubbles/1.json
  def show
    @bubble = Bubble.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @bubble }
    end
  end

  # GET /bubbles/new
  # GET /bubbles/new.json
  def new
    @bubble = Bubble.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @bubble }
    end
  end

  # GET /bubbles/1/edit
  def edit
    @bubble = Bubble.find(params[:id])
  end

  # POST /bubbles
  # POST /bubbles.json
  def create
    @bubble = Bubble.new(params[:bubble])

    respond_to do |format|
      if @bubble.save
        format.html { redirect_to @bubble, notice: 'Bubble was successfully created.' }
        format.json { render json: @bubble, status: :created, location: @bubble }
      else
        format.html { render action: "new" }
        format.json { render json: @bubble.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /bubbles/1
  # PUT /bubbles/1.json
  def update
    @bubble = Bubble.find(params[:id])

    respond_to do |format|
      if @bubble.update_attributes(params[:bubble])
        format.html { redirect_to @bubble, notice: 'Bubble was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @bubble.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /bubbles/1
  # DELETE /bubbles/1.json
  def destroy
    @bubble = Bubble.find(params[:id])
    @bubble.destroy

    respond_to do |format|
      format.html { redirect_to bubbles_url }
      format.json { head :no_content }
    end
  end
end 
```

还有谣言控制器：

```
class RumorsController < ApplicationController

  before_filter :authenticate_user!, only: [:new, :create, :edit, :destroy]

  # GET /rumors
  # GET /rumors.json
  def index
    @rumors = Rumor.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @rumors }
    end
  end

  # GET /rumors/1
  # GET /rumors/1.json
  def show
    @rumor = Rumor.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @rumor }
    end
  end

  # GET /rumors/new
  # GET /rumors/new.json
  def new
    @rumor = Rumor.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @rumor }
    end
  end

  # GET /rumors/1/edit
  def edit
    @rumor = Rumor.find(params[:id])
  end

  # POST /rumors
  # POST /rumors.json
  def create
    @rumor = Rumor.new(params[:rumor])

    respond_to do |format|
      if @rumor.save
        format.html { redirect_to @rumor, notice: 'Rumor was successfully created.' }
        format.json { render json: @rumor, status: :created, location: @rumor }
      else
        format.html { render action: "new" }
        format.json { render json: @rumor.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /rumors/1
  # PUT /rumors/1.json
  def update
    @rumor = Rumor.find(params[:id])

    respond_to do |format|
      if @rumor.update_attributes(params[:rumor])
        format.html { redirect_to @rumor, notice: 'Rumor was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @rumor.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /rumors/1
  # DELETE /rumors/1.json
  def destroy
    @rumor = Rumor.find(params[:id])
    @rumor.destroy

    respond_to do |format|
      format.html { redirect_to rumors_url }
      format.json { head :no_content }
    end
  end
end 
```

我仍然很难弄清楚如何通过表单建立关联，因此即使这不是我问题的完整解决方案，任何帮助都将不胜感激。

# nginx - Nginx、ModX 和友好 URL（URL 重写）

> ID：15753039
> 
> 赞同：0
> 
> 时间：2013-04-01T22:28:42.573
> 
> 标签：nginx, modx

我正在将一些 ModX Evo 网站从我的旧网络服务器（Debian / Apache / ISPConfig3）迁移到我的新网络服务器（Debian / Nginx / ISPConfig3）。

ISPConfig 允许您向每个虚拟主机添加 Nginx 指令，这就是我添加以下代码的地方：

```
if ($http_user_agent ~* "internal dummy connection") {
  return 403;
}

location /manager {
}

location /assets {
}

location / {
  if (!-f $request_filename) {
    rewrite ^(.*)$ /index.php?q=$1;
  }
} 
```

当我打开友好 URL*和*友好别名，并将我的首选后缀设置为 .html，然后预览给定页面（例如[http://example.com/friendly-url.html](http://example.com/friendly-url.html)）时，浏览器会尝试提供 HTML 页面作为下载。

（如果您下载此文件并在文本编辑器中打开，则该文件在 ModX 安装根目录中具有 index.php 的确切内容）。

我究竟做错了什么？在 nginx 中如何实现 URL 重写？这甚至是 URL 重写问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T07:00:11.020

您是否尝试过使用此页面中的 nginx 指令 - [http://rtfm.modx.com/display/revolution20/Nginx+Server+Config](http://rtfm.modx.com/display/revolution20/Nginx+Server+Config)？

# asp.net - asp.net 获取当前用户ID

> ID：15753040
> 
> 赞同：1
> 
> 时间：2013-04-01T22:28:44.520
> 
> 标签：asp.net

在代码后面我有这个：

```
 protected void ButtonSave_Click(object sender, EventArgs e)
        {
            Guid guid = (Guid)Membership.GetUser().ProviderUserKey;
            string name = TextBoxCategoryName.Text;
           // string user = Membership.GetUser().UserName;
            this.connection.Open();
            command = connection.CreateCommand();
            command.CommandText = "insert into ProfitCategories(name, IdUser) values ( '" + name + "', "+guid+" )";
            command.ExecuteNonQuery();

            connection.Close();
        } 
```

但这给出了错误：`Incorrect syntax near 'a8'.` 如何从当前用户获取 GUID 并插入数据库

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T22:42:24.043

尽管 Mike 已经为您提供了答案，但我想提请您注意使用*存储过程*而不是 sql 查询

```
 try
  {
      Guid guid = (Guid)Membership.GetUser().ProviderUserKey;
      string name = TextBoxCategoryName.Text;

       using (SqlConnection con = new SqlConnection(sqlConnection))
            {
            SqlCommand command = new SqlCommand("sp_InsertUserDatails", sqlConnection);
            command.CommandType = CommandType.StoredProcedure;
            command.Parameters.Add("@name", SqlDbType.VarChar).Value = name ;
            command.Parameters.Add("@IdUser", SqlDbType.VarChar).Value = guid ;
            sqlConnection.Open();
            return command.ExecuteNonQuery();
            sqlConnection.Close();
            }
  }
catch (SqlException ex)
  {
     Console.WriteLine("SQL Error" + ex.Message.ToString());
     return 0;
  } 
```

这里是存储过程

```
 CREATE PROCEDURE sp_InsertUserDatails 
(
    @name varchar(100),
    @IdUser varchar(100)
)
AS
BEGIN
    insert into dbo.ProfitCategories(name, IdUser) 
    values (@name, @IdUser)
END
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:38:30.987

**小问题**：您的 GUID 周围缺少单引号。它应该是：

```
command.CommandText = "insert into ProfitCategories (name, IdUser) values ( '" + name + "', '" + guid + "' )"; 
```

但不要这样做。

**最大的问题**：如果你这样修复，你就有被 SQL 注入的风险。使用 SQL 语句的参数来适当地修复，或使用存储过程。

阅读：

[MSDN SqlCommand.Parameters](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.parameters.aspx)

[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)

# netezza - 错误 [08S01] 将数据插入到 netezza 中的外部表时出现通信链接故障

> ID：15753042
> 
> 赞同：2
> 
> 时间：2013-04-01T22:28:49.393
> 
> 标签：netezza

我正在尝试将数据从文本文件加载到**Netezza**中的外部表。

这是我的命令

```
INSERT INTO XTABLE_DHARMESH SELECT * FROM EXTERNAL 'C:\Dhams\mergeresult.txt' 
USING (delimiter ',' REMOTESOURCE 'ODBC' LOGDIR 'C:\Dhams'); 
```

我正进入（状态`ERROR [08S01] Communication link failure.`

当我的文件中有 100 万条记录而我的文本文件中有 1000 条记录时它工作正常时会发生此错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-21T20:55:36.533

我发现**Windows 7**和**Windows Server 2008 R2** TCP 烟囱设置是罪魁祸首。

[http://blogs.dirteam.com/blogs/sanderberkouwer/archive/2008/05/15/backward-compatible-networking-with-server-core.aspx](http://blogs.dirteam.com/blogs/sanderberkouwer/archive/2008/05/15/backward-compatible-networking-with-server-core.aspx)

以下命令为我解决了这个问题：

```
netsh interface tcp set global rss=disabled
netsh interface tcp set global chimney=disabled
netsh interface tcp set global autotuning=disabled 
```

您可以使用以下命令确认它们已被禁用

```
netsh int tcp show global 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T06:16:06.263

不幸的是，在使用较旧的固件和 ODBC 驱动程序时会发生这种情况。它已在 Netezza 固件 7.0 中修复

# java - 在 id 上同步删除

> ID：15753060
> 
> 赞同：0
> 
> 时间：2013-04-01T22:30:05.203
> 
> 标签：java, concurrency, concurrenthashmap

我需要确保多个线程不会同时尝试访问同一个资源。我有一堆这些资源，所以我想为每个资源（而不是一个全局锁）拥有一个单独的锁对象，这样线程就不会不必要地阻塞彼此。

`ConcurrentMap.putIfAbsent()`Eddie在[https://stackoverflow.com/a/659939/82156](https://stackoverflow.com/a/659939/82156)中为此提供了一个很好的解决方案。

```
// From https://stackoverflow.com/a/659939/82156
public Page getPage(Integer id) {
  Page p = cache.get(id);
  if (p == null) {
    synchronized (getCacheSyncObject(id)) {
      p = getFromDataBase(id);
      cache.store(p);
    }
  }
}

private ConcurrentMap<Integer, Integer> locks = new ConcurrentHashMap<Integer, Integer>();

private Object getCacheSyncObject(final Integer id) {
  locks.putIfAbsent(id, id);
  return locks.get(id);
} 
```

但是，该实现的一个问题是哈希图将无限增长。有没有办法在线程完成时删除哈希键而不会搞砸并发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:38:51.183

如果您知道特定线程是请求特定锁的最后一个线程，那么您可以使用`locks.remove(id, id)`. 否则，您需要对两个不容易同步的事件进行原子更新。

如果您释放然后删除锁，另一个线程可能会抓住您释放的锁，而另一个线程会使新的锁对象忘记原始锁对象。在这种情况下，您最终可能会同时调用两个`getFromDataBase(id)`线程`cache.store(p)`。如果您删除然后释放，则可能有另一个线程在等待您释放旧锁，而新线程已经建立了新锁。可能会发生同样的碰撞。

本质上，您不能在不向系统添加新锁的情况下原子地释放锁并将其从 HashMap 中删除。在这种情况下，您要么最终得到一个全局锁——这阻碍了哈希特定锁定的加速——要么你需要为每个页面添加一个额外的锁，它本身就会有相同的删除问题。或者，如果您可以访问 HashMap 的内部结构，您可以尝试一些棘手的存储桶锁暴露给您的更高级别的逻辑，尽管我不建议您尝试实现这样的事情。

限制哈希图大小的一种解决方案是改用固定大小的映射。用大数字 (10,000) 修改您的整数 ID，并将修改后的数字用作唯一的锁 ID。两个散列冲突并需要为不同页面使用相同锁的可能性非常小，并且您对锁消耗的内存有一个硬上限。在这种情况下，您实际上不需要 HashMap，因为您可以将 Integer 锁定对象预分配到静态 const 数组中，并直接从 id 对象请求 mod 哈希。

此外，您应该小心在锁之外进行缓存读取，除非缓存本身受到同时读写的保护，因为一个线程可能正在写入，而另一个线程则从问题中指定的代码方式读取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T01:00:19.870

Pyrce 让我意识到并不要求每个资源都有自己的锁定对象。相反，我可以使用一个包含 100 个锁对象的池，这些对象可以在资源之间共享。这样，锁定对象的集合就不会无限增长，但我仍然可以获得我希望通过删除单个全局锁定获得的大部分并发优势。

这意味着我不再需要使用 a `ConcurrentHashMap`，而可以只使用一个急切初始化的简单数组。

```
// getPage() remains unchanged
public Page getPage(Integer id) {
  Page p = cache.get(id);
  if (p == null) {
    synchronized (getCacheSyncObject(id)) {
      p = getFromDataBase(id);
      cache.store(p);
    }
  }
}

private int MAX_LOCKS = 100;
private Object[] locks = new Object[MAX_LOCKS];

{
    for(int i=0; i<locks.length; ++i)
        locks[i] = new Object();
}

private Object getCacheSyncObject(final Integer id) {  
  return locks[ id % MAX_LOCKS ];
} 
```

# mysql - SQL 插入数据类型号插入溢出错误

> ID：15753061
> 
> 赞同：0
> 
> 时间：2013-04-01T22:30:17.093
> 
> 标签：mysql, sql-server-2008, sql-insert

请任何人帮助我解决下面的错误，下面的插入语句？

**第 1 行：将数字转换为数字数据类型的算术溢出错误。**

```
 CREATE TABLE [dbo].[Table_test]([EMPLOYERCODE] [int] NOT NULL,
    [Tran_type] [char](3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
)

INSERT INTO Table_Test (EMPLOYERCODE
                                , SSN
                                    , Tran_type )
                            VALUES (91001
                                    , 799005001
                                    , 9 
                                    , CAST(18 As numeric(11, 2))
                                    , CAST(90 As numeric(11, 2))
                                    , CAST(11 As numeric(11, 2))
                                    , 4300485073
                                    , CAST('SST'  As char(3))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:39:28.867

只是一个想法，在您的 INSERT 语句中，您最后的 2 个铸件：

```
CAST(90 As numeric(11, 2))
CAST(11 As numeric(11, 2)) 
```

似乎与 CREATE TABLE 语句不兼容：

```
[SSVAVGHRSWORKED] [numeric](3, 2) NULL,
[COMPLETENESS] [numeric](6, 2) NULL, 
```

我建议你改变任何一个。

# r - Markdown 报告未在 Rstudio 中执行

> ID：15753066
> 
> 赞同：2
> 
> 时间：2013-04-01T22:30:38.143
> 
> 标签：r, markdown, knitr, rstudio, r-markdown

我正在生成错误：

```
> options(encoding='UTF-8'); require(knitr); knit('March-2013-Report.Rmd');
Loading required package: knitr

processing file: March-2013-Report.Rmd
  |......................                                           |  33%
  ordinary text without R code

  |...........................................                      |  67%
label: unnamed-chunk-1
Quitting from lines 4-5 (March-2013-Report.Rmd) 
Error in evaluate(code, envir = env, new_device = FALSE, stop_on_error = if (options$include) opts_knit$get("stop_on_error") else 2L) : 
  unused argument(s) (new_device = FALSE, stop_on_error = if (options$include) opts_knit$get("stop_on_error") else 2)
Calls: knit ... process_group.block -> call_block -> block_exec -> in_dir -> evaluate

Execution halted

knitr terminated with status 1 
```

使用 RStudio 编织`.Rmd`文件中包含的以下代码时：

```
March 2013 - UGA Google Analytics Report
========================================================

```{r}
2+2
```

## About this Report

## Future Vision for GA and Web Reporting

## Analysis

### Basic Page Stats 
```

我通常可以调试我的错误，并确定这是显而易见的，但我做错了什么，为什么不编译？

提前致谢。

更新：会话信息

```
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] plyr_1.7.1      stringr_0.6.1   rga_0.8         httr_0.2        lubridate_1.2.0
[6] rjson_0.2.10    RCurl_1.95-1.1  bitops_1.0-4.1 

loaded via a namespace (and not attached):
[1] codetools_0.2-8 digest_0.5.2    evaluate_0.4.2  formatR_0.6     knitr_1.1.8    
[6] tools_2.15.0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T03:55:56.130

我的猜测是，这是过时软件包的问题。可以试试更新吗？在 RStudio 中，在`packages`选项卡下，您应该可以选择更新任何需要的包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-31T06:11:46.313

尝试清除 knitr 缓存 - 如果任何块有`cache=TRUE`

我通常在 Knit'ng 时遇到这个问题，其中一些代码块有`cache=TRUE`

# nginx - 用于媒体文件的烧瓶 send_from_directory

> ID：15753069
> 
> 赞同：4
> 
> 时间：2013-04-01T22:30:55.390
> 
> 标签：nginx, flask

我有一个用于家庭网络的小型 Flask 应用程序。

目前我有 Flask 与 uWSGI 和 nginx 一起运行。

该应用程序基本上扫描一个位置并提供媒体文件。下面是渲染这些文件的代码：

```
@app.route('/get_media/<path:filename>', methods=['GET'])
    def get_media(filename):
        return send_from_directory('/media/', filename) 
```

工作正常，`send_from_directory`但似乎很慢。我必须承认我并不真正了解其背后的过程。python 服务这些文件还是 nginx？我希望 nginx 能够为这些文件提供服务，但我不确定如何配置别名，因为我希望应用程序遍历文件的目录但想将服务移交给 nginx。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T10:43:41.243

如果你已经在使用 nginx，你应该使用 nginx 来提供媒体和静态文件，没有理由用 uWSGI 和烧瓶来提供它们，太多的开销。

```
#in case you have structure /path/to/your/media_dir/media
location /media {
   root /path/to/your/media_dir;
}

#in case you have structure /path/to/your/media_dir
location /media {
   alias /path/to/your/media_dir;
} 
```

# delphi - 如何在 Delphi DLL 中保存全局对象？

> ID：15753073
> 
> 赞同：0
> 
> 时间：2013-04-01T22:31:09.800
> 
> 标签：delphi, memory-management, delphi-2010

我有一个用 Delphi 编写的简单 DLL。它提供了对作为资源嵌入的一些只读数据进行操作的功能。我发现在每次调用时加载该资源非常慢，所以我想把它放在一个在调用之间停留的对象中。

这样做的正确方法是什么？以下作品：

```
var
  MyObject: TMyObject;

function ReportSomethingAboutMyObject(): Integer; stdcall; export;

exports ReportSomethingAboutMyObject();

begin
  MyObject = TMyObject.Create;
  LoadTheResourceIntoObject(MyObject);
end. 
```

但我担心内存泄漏或其他意外行为。

如果对象是读写的并且可能是非线程安全的，我很想知道答案会有什么不同。

## 更新 1

根据要求，我将提供更具体的用例。我在 DLL 中嵌入了一个文本文件 (ini) 作为资源，我只需要进行查找。`TMemIniFile`如果我只加载一次资源并将其保留为`TStringList`更简单的示例，这一切都会更快。加载后，内容不会改变。将来我希望能够更改数据结构以获得更智能的东西，例如`TDictionary`.

相比之下，我想考虑第二种情况，其中全局对象是完全不同的东西，比如我想在调用之间保留的数据库连接（因为可能有很多）。那应该怎么做不同呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:35:56.073

如果您想做类似的事情并确保内存不会泄漏，请尝试将缓存对象移动到一个单元中。将加载它`initialization`的代码和清理它的代码放入`finalization`. 这些应该分别在加载和卸载 DLL 时自动调用。

# javascript - 以角度处理两个视图之间的数据

> ID：15753076
> 
> 赞同：1
> 
> 时间：2013-04-01T22:31:27.860
> 
> 标签：javascript, angularjs, routes

我有两个视图，我使用路由来访问它们。我的主要观点是一个使用`ListController`.

该控制器发出`$http`请求并取回一些数据，然后`success`我就这样做了：`$scope.data = response.data;`

当我单击列表项时，我的路线转到`#/view/:id`

我可以在我的其他控制器中`id`使用：`routeParams``DetailController`

既然`$scope.data`是 的一部分，`ListController`我如何访问说`$scope.data`在我的`DetailController`？

（或至少传递`$scope.data[some Id]`给`DetailController`）

**编辑**

```
app.factory('dataService', function(data)
{
  var data = data;
  return data;
}); 
```

答案是把它放在我的`DetailController`. `response.data`我仍然可以使用

```
presentationService().then(
    function success(response)
    {
        log(response.data);
    },
    function error(response)
    {
        log(response);
    }
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:38:08.030

您不应使用范围在控制器之间共享数据。改用服务。观看这部短片：[http ://egghead.io/video/angularjs-sharing-data-between-controllers/](http://egghead.io/video/angularjs-sharing-data-between-controllers/)

希望能帮助到你。

# wpf - 如何在页面中拉伸 XAML 控件

> ID：15753086
> 
> 赞同：1
> 
> 时间：2013-04-01T22:32:15.377
> 
> 标签：wpf, xaml

这一直困扰着我一段时间。我无法让我的网格和/或边框拉伸为 xaml 页面的高度和宽度。默认情况下，VerticalAlignment 和 Horizo​​ntalAlignment 都应设置为“拉伸”，但它们只想拉伸到我在其中的子元素的高度，我不知道为什么。

示例：如果我有一个固定宽度为 1024 且高度为 768 的 WPF XAML 页面，那么对我来说，以下代码应该显示一个可以拉伸页面宽度和高度的网格，它的宽度和高度都可以正常工作。事实上，它只适用于宽度，因为我指定了一个硬编码的宽度。

```
 <page ..
  ...
  ..
  d:width="1024" d:height="768">

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition height = "*" />  
      <RowDefinition height = "50" /> 
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition width = "250" /> <!-- Left Side Navbar !-->
      <ColumnDefinition width = "*" /> <!-- TabControl !-->
    </Grid.ColumnDefinitions>

    <Border grid.column = "0">
       <Textbox></Textbox>
    </Border> <!-- Vertical should stretch !-->

    <Border grid.column = "1">
       <TabControl></TabControl> 
    </Border>
  </Grid> 
```

我将页面的背景颜色设置为绿色，只是为了查看页面本身是否拉伸到屏幕的全高，而事实并非如此，它只是垂直拉伸到网格内控制子元素的范围。我应该能够设置网格或边框以拉伸高度和宽度，即使其中没​​有任何元素，有人可以展示真正正确的方法吗？

# ios - NSAutoReleasePool 释放视图控制器？

> ID：15753087
> 
> 赞同：2
> 
> 时间：2013-04-01T22:32:18.620
> 
> 标签：ios, crash, segmentation-fault, nsautoreleasepool

因此，我在对从我们的测试仪获得的崩溃日志进行故障排除时遇到了一些困难。该应用程序因 崩溃而崩溃`EXC_CRASH (SIGSEGV)`，并且任何线程中唯一可识别的代码位于线程 6 中。堆栈跟踪如下所示：

```
...
15  MyApplication                   0x002cfcf2 0xfb000 + 1920242
16  MyApplication                   0x00107f26 -[CCViewController dealloc] (CCViewController.m:73)
17  MyApplication                   0x001cc27c -[CCSubmitReportController dealloc] (CCSubmitReportController.m:646)
18  CoreFoundation                  0x36f41c3c 0x36f3f000 + 11324
...
26  Foundation                      0x35396bd4 0x35387000 + 64468
27  MyApplication                   0x001c794e -[CCGetFeedOperation main] (CCGetFeedOperation.m:102)
... 
```

如果您查看第 102 行`CCGetFeedOperation`，它只是在工作结束时耗尽了操作的自动释放池。

所以我试图弄清楚为什么自动释放池会试图释放委托。对委托的引用被传递给操作类，如下所示：

```
@property (assign) id <CCGetFeedOperationDelegate> feedDelegate; 
```

我唯一能想到的是我在主线程上调用一个方法并等待它完成，然后再调用池排水。

```
invocation = [NSInvocation invocationWithTarget:feedDelegate
                                                       selector:@selector(operation:didGetFeed:) 
                                            retainArguments:YES, self, feedDetailsModel]; 
```

但这仍然不能解释为什么操作的池会导致视图控制器被释放。想法？

*编辑：顺便说一句，我无法重现这个。我只在我们的测试人员和野外人员的崩溃报告中看到过它。*

*编辑2：自动释放池非常简单，它在操作`main`方法开始时分配，并在工作完成时耗尽。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T00:16:05.327

如果你在释放自动释放池的过程中崩溃，那只是意味着你在那个事件循环中的某个地方过度释放了一些东西。如果同一个对象上有自动释放，那么在池耗尽之前您不会看到崩溃。这并不意味着自动释放与它有任何关系。那是最后一次发布的时候。

确保您使用访问器进行所有属性访问（除了 init 和 dealloc）。如果这种情况在非 ARC 代码中崩溃，直接访问 ivars 是第一大原因。在任何情况下，您都需要审核保留和释放的平衡。如果出现错误，迁移到 ARC 通常会减少这些类型，如果可能，强烈建议使用。

# c - C fopen 写入失败，errno 为 2

> ID：15753090
> 
> 赞同：10
> 
> 时间：2013-04-01T22:32:37.590
> 
> 标签：c, fopen, errno

我不明白为什么这似乎因 errno 为 2 而失败：

```
char debugText [256];
sprintf (debugText, "C:\\List.txt");
dfile = fopen( debugText, "w");
fprintf ( dfile, "  err %d \n", errno); 
```

我说似乎是因为当 dfile 为 NULL 时，文件被创建并充满了我的输出。

那么发生了什么 ？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-01T22:38:34.820

所有这一切都告诉你，在你打电话`errno`后它的值是 2 。`fopen`你不知道调用失败，因为你没有检查是否`dfile == NULL`. 如果输出实际上已写入文件，则可能`fopen`调用成功，并且该`errno`值是以前的调用遗留下来的，可能是您没有明确进行的调用。

失败的调用可以设置`errno`为一些非零值，但成功的调用*不*设置`errno`为 0。要检查错误，您需要

*   调用前设置`errno`为0；
*   进行调用并检查它返回的值，看它是成功还是失败；和
*   在调用之后检查 的值`errno`——但*前提*是你知道它失败了（否则 的值`errno`是没有意义的）。

如果`defile == NULL`，则`fprintf`调用具有未定义的行为；它可能会失败。

另一方面，你说那`dfile`是`NULL`。你怎么知道？你的代码没有检查它。（如果`fopen`调用真的失败`C:\List.txt`了，你的程序之前运行的内容是否会遗留下来？）

你从这个程序中得到什么输出？

```
#include <stdio.h>
#include <errno.h>
int main(void) {
    char debugText [256];
    FILE *dfile;

    sprintf (debugText, "C:\\List.txt");
    dfile = fopen( debugText, "w");
    if (dfile == NULL) {
        printf("fopen failed, errno = %d\n", errno);
    }
    else {
        printf("fopen succeeded\n");
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-01T22:34:14.277

```
2 ENOENT No such file or directory.  A component of a specified pathname
         did not exist, or the pathname was an empty string. 
```

以下是错误代码列表：

[http://www.thegeekstuff.com/2010/10/linux-error-codes/](http://www.thegeekstuff.com/2010/10/linux-error-codes/)

但是您应该先检查是否`fopen()`返回`NULL`，因为这个值`errno`可能是从其他东西中遗留下来的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-01T22:51:07.587

没有库函数会设置`errno`为零。

您应该只`errno`在函数报告错误后进行检查。

例如，您的代码应该是：

```
if ((dfile = fopen(debugText, "w")) == 0)
    ...then fopen() failed and errno is relevant... 
```

如果函数没有报告失败，则 in 的值`errno`可以是任何值。例如，在 Solaris 上，您通常会在成功操作后`errno`设置为`ENOTTY`，因为`stdout`未连接到终端。这并不意味着实际上出了什么问题。它只是意味着测试标准输出是否是终端失败（因为它不是终端）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-18T06:07:25.983

就我而言，我`errno == 2`在尝试打开文件以使用 FAT 文件系统在已安装的闪存驱动器上写入时遇到了；事实证明，如果文件不符合[8.3 规则](https://en.wikipedia.org/wiki/8.3_filename)，则`fopen`返回`NULL`并设置`errno`为`ENOENT`.

有必要说，我在嵌入式系统上遇到过这种情况，这不应该是 Windows 上的问题。

# r - 将名为 List 的混合长度转换为 data.frame

> ID：15753091
> 
> 赞同：17
> 
> 时间：2013-04-01T22:32:38.290
> 
> 标签：r, dataframe

我有以下格式的列表：

```
[[1]]
[[1]]$a
[1] 1

[[1]]$b
[1] 3

[[1]]$c
[1] 5

[[2]]       
[[2]]$c
[1] 2

[[2]]$a
[1] 3 
```

有一个预定义的可能“键”列表（在本例中为`a`、`b`和`c`），列表中的每个元素（“行”）都将具有为这些键中的一个或多个定义的值。我正在寻找一种从上面的列表结构到 data.frame 的快速方法，在这种情况下，它看起来如下所示：

```
 a  b c
1 1  3 5
2 3 NA 2 
```

任何帮助，将不胜感激！

* * *

**附录**

我正在处理一个最多有 50,000 行和 3-6 列的表，其中大部分值都指定了。我将从 JSON 中获取表格并尝试快速将其放入 data.frame 结构中。

下面是一些代码，用于创建我将使用的比例的示例列表：

```
ids <- c("a", "b", "c")
createList <- function(approxSize=100){     
    set.seed(1234)

    fifth <- round(approxSize/5)

    list <- list()
    list[1:(fifth*5)] <- rep(
        list(list(a=1, b=2, c=3), 
                 list(a=3, b=4, c=5),
                 list(a=7, c=9),
                 list(c=6, a=8, b=3),
                 list(b=6)), 
        fifth)

    list
} 
```

只需创建一个包含`approxSize`50,000 个的列表来测试这种大小的列表的性能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-01T23:00:54.290

这是一个简短的答案，但我怀疑它会非常快。

```
> library(plyr)
> rbind.fill(lapply(x, as.data.frame))
  a  b c
 1 1  3 5
 2 3 NA 2 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-01T23:14:44.130

这是我最初的想法。它不会加快你的方法，但它确实大大简化了代码：

```
# makeDF <- function(List, Names) {
#     m <- t(sapply(List, function(X) unlist(X)[Names], 
#     as.data.frame(m)
# }    

## vapply() is a bit faster than sapply()
makeDF <- function(List, Names) {
    m <- t(vapply(List, 
                  FUN = function(X) unlist(X)[Names], 
                  FUN.VALUE = numeric(length(Names))))
    as.data.frame(m)
}

## Test timing with a 50k-item list
ll <- createList(50000)
nms <- c("a", "b", "c")

system.time(makeDF(ll, nms))
# user  system elapsed 
# 0.47    0.00    0.47 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-01T23:13:47.350

如果您事先知道可能的值，并且您正在处理大数据，也许使用`data.table`并且`set`会很快

```
cc <- createList(50000)

system.time({
nas <- rep.int(NA_real_, length(cc))
DT <-  setnames(as.data.table(replicate(length(ids),nas, simplify = FALSE)), ids)

for(xx in seq_along(cc)){

  .n <- names(cc[[xx]])
  for(j in .n){
    set(DT, i = xx, j = j, value = cc[[xx]][[j]])
  }

}

})

# user  system elapsed 
# 0.68    0.01    0.70 
```

* * *

## 后代的旧（慢解决方案）

```
full <- c('a','b', 'c')

system.time({
for(xx in seq_along(cc)) {
  mm <- setdiff(full, names(cc[[xx]]))
  if(length(mm) || all(names(cc[[xx]]) == full)){
  cc[[xx]] <- as.data.table(cc[[xx]])
  # any missing columns

  if(length(mm)){
  # if required add additional columns
    cc[[xx]][, (mm) := as.list(rep(NA_real_, length(mm)))]
  }
  # put columns in correct order
  setcolorder(cc[[xx]], full) 
  }
}

 cdt <- rbindlist(cc)
})

#   user  system elapsed 
# 21.83    0.06   22.00 
```

第二个解决方案留在这里展示如何`data.table`使用不好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-07T05:30:50.173

我知道这是一个老问题，但我刚刚遇到它，没有看到我所知道的最简单的解决方案真是令人痛苦。所以在这里（只需在 rbindlist 中指定 'fill=TRUE'）：

```
library(data.table)
list = list(list(a=1,b=3,c=5),list(c=2,a=3))
rbindlist(list,fill=TRUE)

#    a  b c
# 1: 1  3 5
# 2: 3 NA 2 
```

我不知道这是否是最快的方法，但我愿意打赌它会竞争，因为 data.table 的周到设计和在许多其他任务上的出色表现。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-01T22:58:11.563

好吧，我尝试了第一个想法，性能并没有我担心的那么糟糕，但我确信仍有改进的空间（尤其是在浪费矩阵 -> data.frame 转换中）。

```
convertList <- function(myList, ids){
    #this computes a list of the numerical index for each value to handle the missing/
    # improperly ordered list elements. So it will have a list in which each element 
    # associated with A has a value of 1, B ->2, and C -> 3\. So a row containing
    # A=_, C=_, B=_ would have a value of `1,3,2`
    idInd <- lapply(myList, function(x){match(names(x), ids)})

    # Calculate the row indices if I were to unlist myList. So if there were two elements
    # in the first row, 3 in the third, and 1 in the fourth, you'd see: 1, 1, 2, 2, 2, 3
    rowInd <- inverse.rle(list(values=1:length(myList), lengths=sapply(myList, length)))

    #Unlist the first list created to just be a numerical matrix
    idInd <- unlist(idInd)

    #create a grid of addresses. The first column is the row address, the second is the col
    address <- cbind(rowInd, idInd)

    #have to use a matrix because you can't assign a data.frame 
    # using an addressing table like we have above
    mat <- matrix(ncol=length(ids), nrow=length(myList))

    # assign the values to the addresses in the matrix
    mat[address] <- unlist(myList)

    # convert to data.frame
    df <- as.data.frame(mat)
    colnames(df) <- ids

    df
}   
myList <- createList(50000)
ids <- letters[1:3]

system.time(df <- convertList(myList, ids)) 
```

在我的笔记本电脑（Windows 7、Intel i7 M620 @ 2.67 GHz、4GB RAM）上转换 50,000 行大约需要 0.29 秒。

仍然对其他答案非常感兴趣！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-13T01:57:06.157

在 dplyr 中：

```
bind_rows(lapply(x, as_data_frame))

# A tibble: 2 x 3
      a     b     c
  <dbl> <dbl> <dbl>
1     1     3     5
2     3    NA     2 
```

# ios - 旋转不能正常工作

> ID：15753092
> 
> 赞同：0
> 
> 时间：2013-04-01T22:32:55.557
> 
> 标签：ios, xcode, ipad, rotation

我正在尝试为 iPad 创建一个图形计算器。在纵向视图上有一个普通的计算器，旋转时它会将视图更新为图形计算器。

我的问题是我有两个视图，一个纵向和一个横向。风景有一个图表，但是一旦风景旋转到纵向并返回，图表就不会使用 setneedsdisplay 自行更新

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T08:49:59.383

如果我没听错的话，图表视图应该只以横向显示，而不能旋转为纵向。所以我认为这是这里的主要问题。

在您的项目 -> 目标 -> 摘要中有相关设置，您可以在其中选择应用支持的方向。

在视图控制器的代码中，您可以添加这些方法，以将特定的视图控制器限制为某个方向： [iOS 6.0 中的接口方向](https://stackoverflow.com/questions/12404556/interface-orientation-in-ios-6-0)

# scala - sbt 12 自定义测试目录

> ID：15753093
> 
> 赞同：2
> 
> 时间：2013-04-01T22:33:10.733
> 
> 标签：scala, sbt

我正在从 sbt 11 升级到 sbt 12.2，我们目前有以下项目结构：

```
src
  main
    scala/...
  test
    shared
      scala/...
    unit
      scala/...
    integration
      scala/...
    functional
      scala/... 
```

当我升级到 sbt 12 时，测试不再运行，我们得到：`No tests to run for unit:test`. 查看 sbt 12 文档，为了使其开箱即用，我们需要为测试源重新构建文件夹和包结构。但是，我想在不得不重组之前先检查是否还有其他事情可以做。

我们的测试配置如下（仅显示单元测试配置，其他测试类型具有相同的配置）：

```
lazy val project = Project(ID, BASE, settings = platformSettings)
.configs(Shared)
.configs(UnitTests)

lazy val Shared = config("shared").extend(Runtime)
lazy val sharedSettings = configure(Shared, "shared")

lazy val UnitTests = config("unit") extend(Shared)
lazy val unitTestSettings = configure(UnitTests, "unit")

private def configure(configuration: Configuration, testType: String) = {
  inConfig(configuration)(Defaults.testSettings) ++ inConfig(configuration)(settingsFor(testType))
}

private def settingsFor(testType: String): Seq[Setting[_]] = Seq (
  sourceDirectory <<= baseDirectory(_ / "src" / "test" / testType),
  testListeners <<= (target in Compile).map({ (target) => Seq(new JUnitXmlTestsListener(target.getAbsolutePath()))}),
  parallelExecution := false
) 
```

# sql-server - TSQL - 在没有动态 SQL 的情况下获取每个表中每列的最大数据长度

> ID：15753096
> 
> 赞同：2
> 
> 时间：2013-04-01T22:33:41.017
> 
> 标签：sql-server, tsql, sql-server-2012

有没有办法获得存储在数据库中每一列中的最大数据长度？我见过一些使用动态 SQL 的解决方案，但我想知道是否可以通过常规查询来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T09:38:08.123

是的，只需查询`INFORMATION_SCHEMA.COLUMNS`数据库的视图，您可以根据需要从数据库中所有表的所有列中获取信息，请参阅以下内容了解更多详细信息：

[Information_Schema - 列](http://msdn.microsoft.com/en-us/library/ms188348.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-04T05:58:52.377

如果您谈论的是特定数据的长度而*不是*列的声明长度，恐怕没有动态 SQL 就无法实现。

原因是只有一种方法可以检索数据，那就是`SELECT`语句。但是，此语句需要一个显式列，该列是语句本身的一部分。没有什么像

```
-- This does not work
select col.Data 
  from Table 
 where Table.col.Name='ColumnName' 
```

所以答案是：没有。

# sockets - IPv6 寻址中的 IP_TOS（用于 IPv4 套接字的 setsockopt 函数中的 PPROTO_IP 选项）的等价物是什么？

> ID：15753100
> 
> 赞同：3
> 
> 时间：2013-04-01T22:34:13.453
> 
> 标签：sockets

我正在`setsocketopt`为 IPv4 地址使用函数并 为选项使用`IP_TOS`值。`PPROTO_IP`

IPv6寻址中IP_TOS的等价物是什么？在 IPv6 中我们使用`PROTO_IPv6`，但我找不到任何与`IP_TOS`IPv6 寻址类似的选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:38:31.797

我不知道它的支持范围有多广，但我相信“setsockopt() 流量类”的常量是`IPV6_TCLASS`：

*   [http://www.ietf.org/rfc/rfc3542.txt](http://www.ietf.org/rfc/rfc3542.txt)

也可以看看：

*   [http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.commtechref/doc/commtrf2/setsockopt.htm](http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.commtechref/doc/commtrf2/setsockopt.htm)

*   [http://developer.android.com/reference/java/net/SocketOptions.html](http://developer.android.com/reference/java/net/SocketOptions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:07:19.987

[弃用旧的 QoS API](http://web.archive.org/web/20151208005603/http://blogs.msdn.com/b/wndp/archive/2006/07/05/657196.aspx)

“在 XP 中，我们禁用了 Winsock IP_TOS 选项。如果您使用此套接字选项，调用将成功但会被静默忽略。您可以通过注册表值重新启用它。在 Vista 中，此注册表机制已被删除：**Winsock IP_TOS 选项不再可用。** "

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T00:20:02.420

根据[MSDN 文章 ID：248611](http://web.archive.org/web/20190119192230/https://support.microsoft.com/en-us/help/248611/setsockopt-is-unable-to-mark-the-internet-protocol-type-of-service-bit) ToS 被忽略，GQOS API 仅限于 IPv4。对于 IPv6 和 IPv4，您必须使用需要 Vista 或更高版本平台的[qWAVE QOS 。](http://msdn.microsoft.com/en-us/library/windows/desktop/bb960848%28v=vs.85%29.aspx)

即 QoS 完全从 Windows 领域的 BSD 套接字中抽象出来。

# mysql - python: sqlalchemy - 如何使用新的事件系统确保连接不会过时

> ID：15753102
> 
> 赞同：5
> 
> 时间：2013-04-01T22:34:19.563
> 
> 标签：mysql, sqlalchemy, database-connection, operationalerror

我在 python 中使用 sqlalchemy 包。在对现有表执行自动加载后，我有一个操作需要一些时间才能执行。当我尝试使用连接时，这会导致以下错误：

```
sqlalchemy.exc.OperationalError: (OperationalError) (2006, 'MySQL server has gone away') 
```

我有一个简单的实用函数，可以执行多次插入：

```
def insert_data(data_2_insert, table_name):
    engine = create_engine('mysql://blah:blah123@localhost/dbname')
    # Metadata is a Table catalog. 
    metadata = MetaData()
    table = Table(table_name, metadata, autoload=True, autoload_with=engine)
    for c in mytable.c:
        print c
    column_names = tuple(c.name for c in mytable.c)
    final_data = [dict(zip(column_names, x)) for x in data_2_insert]
    ins = mytable.insert()
    conn = engine.connect()
    conn.execute(ins, final_data)
    conn.close() 
```

由于“data_2_insert”有 677,161 行，因此执行时间很长。

```
final_data = [dict(zip(column_names, x)) for x in data_2_insert] 
```

我遇到了[这个问题](https://stackoverflow.com/questions/3033234/handle-mysql-restart-in-sqlalchemy)，它指的是类似的问题。但是我不确定如何实现[接受的答案](https://stackoverflow.com/a/3034003/445073)建议的连接管理，因为 robots.jpg 在评论中指出了这一点：

> SQLAlchemy 0.7 的注意事项 - PoolListener 已弃用，但可以使用新的[事件系统](http://docs.sqlalchemy.org/en/latest/core/pooling.html#disconnect-handling-pessimistic)实现相同的解决方案。

如果有人可以请告诉我一些关于如何将这些建议整合到我使用 sqlalchemy 的方式的指示，我将非常感激。谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-02T10:40:08.513

我想你正在寻找这样的东西：

```
from sqlalchemy import exc, event
from sqlalchemy.pool import Pool

@event.listens_for(Pool, "checkout")
def check_connection(dbapi_con, con_record, con_proxy):
    '''Listener for Pool checkout events that pings every connection before using.
    Implements pessimistic disconnect handling strategy. See also:
    http://docs.sqlalchemy.org/en/rel_0_8/core/pooling.html#disconnect-handling-pessimistic'''

    cursor = dbapi_con.cursor()
    try:
        cursor.execute("SELECT 1")  # could also be dbapi_con.ping(),
                                    # not sure what is better
    except exc.OperationalError, ex:
        if ex.args[0] in (2006,   # MySQL server has gone away
                          2013,   # Lost connection to MySQL server during query
                          2055):  # Lost connection to MySQL server at '%s', system error: %d
            # caught by pool, which will retry with a new connection
            raise exc.DisconnectionError()
        else:
            raise 
```

如果您希望有条件地触发此策略，则应避免在此处使用装饰器，而是使用`listen()`函数注册侦听器：

```
# somewhere during app initialization
if config.check_connection_on_checkout:
    event.listen(Pool, "checkout", check_connection) 
```

更多信息：

*   [连接池事件](http://docs.sqlalchemy.org/en/rel_0_8/core/event.html)
*   [事件 API](http://docs.sqlalchemy.org/en/rel_0_8/core/events.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-07T13:12:11.353

现在有更好的方法来处理它 - **pool_recycle**

```
engine = create_engine('mysql://...', pool_recycle=3600) 
```

MySQL 的默认超时时间为 8 小时。这导致连接被 MySQL 关闭，但它上面的引擎（例如 SQLAlchemy）不知道它。

有两种方法可以解决它 -

1.  [乐观](https://docs.sqlalchemy.org/en/14/core/pooling.html#disconnect-handling-optimistic)- 使用`pool_recycle`
2.  [悲观](https://docs.sqlalchemy.org/en/14/core/pooling.html#disconnect-handling-pessimistic)- 使用`pool_pre_ping=True`

我更喜欢使用 pool_recycle ，因为它不会`SELECT 1`在每次查询之前发出一个 - 减少对数据库的压力

# command-line - 未知卸载 ID 的 REG QUERY

> ID：15753103
> 
> 赞同：0
> 
> 时间：2013-04-01T22:34:33.730
> 
> 标签：command-line, uninstallation, sccm-2007

我一直在寻找和寻找，并没有想出一个好的答案。我正在尝试在两个位置的注册表中查询软件的 UninstallString。

```
-HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall 
-HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall 
```

`UninstallString`需要设置为变量或直接通过管道输入以运行`msiexec.exe /x {GUID} /qn`.

我希望它在 powershell 或命令中只是我的易用性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:00:53.337

```
@ECHO OFF
SETLOCAL
set "uninstall1=" 
FOR /F "tokens=2*" %%A IN (
   'REG QUERY "HKLM\Software\Microsoft\Windows\CurrentVersion" /v Uninstall'
) DO (set Uninstall1=%%B)

set uninstall 
```

这应该检索第一个字符串，如果它存在的话。

对第二个字符串重复公式。最后`SET uninstall`只是报告开始`UNINSTALL`验证的环境变量。

然后

```
if defined Uninstall1 msiexec ... "%Uninstall1%" 
```

应该`MSIEXEC`使用您需要的参数执行（其中...是您的选项 - /x、/qn 等等）

# javascript - Jasmine 规范生成的随机数与执行时不同

> ID：15753107
> 
> 赞同：5
> 
> 时间：2013-04-01T22:34:45.753
> 
> 标签：javascript, ruby-on-rails, testing, tdd, jasmine

我有一个 Jasmine 测试失败，因为正在生成一个随机数，并且这个随机值对于执行和规范是不同的。

```
fetch: function(options) {
    if(typeof options === "undefined") {
        options = {};
    }
    if(typeof options.data === "undefined") {
        options.data = {};
    }
    options.data.id = this.journalId;
    options.data.random = Math.floor(Math.random()*10000);
    col.prototype.fetch.call(this, options);
} 
```

下面的测试失败，因为`Math.floor(Math.random()*10000)`正在生成不同的值。

```
it("should call parent fetch with default options", function() {
  this.collection.fetch();
  expect(this.fetchSpy).toHaveBeenCalledWith({
    data: {
      id: 1,
      random: Math.floor(Math.random()*10000) 
    }
  }); 
}); 
```

对于生成随机数的情况，有没有办法让我的测试通过？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-01T22:44:26.413

您可以模拟`Math.random`功能。茉莉花2：

```
it("should call parent fetch with default options", function() {
  spyOn(Math, 'random').and.returnValue(0.1);
  this.collection.fetch();
  expect(this.fetchSpy).toHaveBeenCalledWith({
    data: {
      id: 1,
      random: Math.floor(Math.random()*10000)
    }
  }); 
}); 
```

茉莉花1：

```
it("should call parent fetch with default options", function() {
  jasmine.spyOn(Math, 'random').andReturn(0.1);
  this.collection.fetch();
  expect(this.fetchSpy).toHaveBeenCalledWith({
    data: {
      id: 1,
      random: Math.floor(Math.random()*10000)
    }
  }); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-23T07:32:58.803

你不应该*spyOn* `Math.random`。

有很多包使用这个功能（甚至**Jasmine**），更好的方法是编写一个方法来包装随机的东西。

```
class Fetcher {
  fetch(url) {
    const rand = this.generateRandomNumber(64);
    // ...
  }

  generateRandomNumber(n) {
    return Math.floor(Math.random() * n);
  }
} 
```

现在你可以嘲笑它了！

```
it('should pass', () => {
  const fetcher = new Fetcher();
  // mock
  spyOn(fetcher, 'generateRandomNumber').and.returnValues(1,2,3);

  // action
  const result = fetcher.fetch('some-url');

  // assertion
  expect(result).toBe('some-result');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-28T10:30:01.707

如果要模拟一系列“随机”值，可以使用：

```
spyOn(Math, 'random').and.returnValues(0.1, 0.2, 0.3, 0.4); 
```

请注意，您必须在 returnValue 中添加**s**否则**它将**不起作用

# jpa - JPQL 更新查询的执行更新需要事务异常

> ID：15753112
> 
> 赞同：6
> 
> 时间：2013-04-01T22:35:30.740
> 
> 标签：jpa, transactions, sql-update, jpql, entitymanager

当我尝试运行此代码时出现此错误。

错误：

javax.persistence.TransactionRequiredException：通过容器管理的事务实体管理器的非事务访问获得的查询对象不支持执行更新

代码：（_ut 是一个 UserTransaction 对象）

公共无效 setMainCategory（整数部门 ID，整数 catId）{

```
 try {
            Query setmain = _entityManager.createNamedQuery("Category.setAsMain");
            Query removeMain = _entityManager.createNamedQuery("Category.removeMain");
            setmain.setParameter("categoryId", catId);
            Department d;
            d=_entityManager.find(Department.class, deptId);
            removeMain.setParameter("department", d);
            _ut.begin();
            removeMain.executeUpdate();
            _ut.commit();
            _ut.begin();
            setmain.executeUpdate();
            _ut.commit();
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

我还有其他实现相同的功能，它们不会抛出此错误。

任何建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-02T21:36:33.207

您正在使用 an`EntityManager`来获取 Named Queries 并且还使用 an *(我认为是)* injection `UserTransaction`。

看到错误消息是*“...Query object getting through non-transactional access...”*。这意味着您正在*通过非事务性访问获得“NamedQuery”*，因为 与`EntityManager`不在同一个事务中`_ut`。所以，你首先加入`EntityManager`到`UserTransaction`然后你得到并执行查询。

最后，您的块应如下所示：

```
@PersistenceContext(unitName = "myPU")
EntityManager em;

@Inject
UserTransaction ut;

public void doSomeStuff()
{
    ut.begin();
    em.joinTransaction();

    em.createNamedQuery("query1").executeUpdate();

    ut.commit();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T08:49:24.433

问题不是来自您的方法实现，而是来自您的执行上下文。
所有更新数据库的方法都必须在打开的事务中执行。您确保的方式取决于您管理事务的方式。如果事务是用户管理的，您必须显式检索并加入现有事务或打开一个新事务。如果它是容器管理的，只需`@transactional`在您的方法上添加注释或确保调用层次结构中有一个方法保存该注释。

在这里，您在容器管理的事务上下文中使用用户管理的事务（请参阅错误消息中的“容器管理的事务实体管理器”）。您不应该这样开始并自己提交/回滚事务。如果您想这样做，只需检索应用程序管理的 EntityManager 即可正确访问 JTA 事务。

参看。[http://docs.oracle.com/cd/E19226-01/820-7627/bnbqy/index.html](http://docs.oracle.com/cd/E19226-01/820-7627/bnbqy/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T09:16:35.357

根据报错信息，我认为原因是你的交易顺序，你在交易中没有得到部门d，所以d的语句是分离的，然后你想直接更新它，这会将语句更改为托管，JPA 无法做到这一点。只需在事务中移动查找代码，我认为就可以了。

# assembly - 调试平面程序集二进制文件

> ID：15753116
> 
> 赞同：3
> 
> 时间：2013-04-01T22:35:49.660
> 
> 标签：assembly, x86

我是 Windows XP 中使用 FASM 的程序集和低级编程的新手。当我组装下面的代码时，它给了我一个 .bin 文件。

```
data1 db 25
data2 db 10001001b
data3 db 12h
      org 0x10
data4 db '2367'
      org 0x18
data5 db ?
      org 0x20
data6 db 'Hello there' 
```

我正在学习的书是使用 windows 调试命令来查看每个命令的值和地址，但是当我使用调试时它会显示其他内容

我的问题是有没有可以调试这些文件的应用程序？甚至引导加载程序程序集二进制文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T09:00:40.167

使用 'org' 指令将变量放在特定位置在 MASM 中有效，但在 FASM 或 NASM 中无效。

使用 FASM 和 NASM，您必须这样做：

```
data1 db 25                       // 0x00
data2 db 10001001b                // 0x01
data3 db 12h                      // 0x02
      times 0x10 - ($-$$) db 0
data4 db '2367'                   // 0x10
      times 0x18 - ($-$$) db 0
data5 db '?'                      // 0x18
      times 0x20 - ($-$$) db 0
data6 db 'Hello there'            // 0x20 
```

然后，您可以组装为平面二进制文件并使用 hexdump 检查结果：

```
00000000  19 89 12 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  32 33 36 37 00 00 00 00  3f 00 00 00 00 00 00 00  |2367....?.......|
00000020  48 65 6c 6c 6f 20 74 68  65 72 65                 |Hello there| 
```

您应该阅读FASM 手册的[2.2.3](http://flatassembler.net/docs.php?article=manual#2.2.3)和[2.2.4部分。](http://flatassembler.net/docs.php?article=manual#2.2.4)

# webdriver - 如何定位不同网页上的元素？

> ID：15753117
> 
> 赞同：0
> 
> 时间：2013-04-01T22:35:50.580
> 
> 标签：webdriver

我是 java 和 webdriver 的新手。我的网络应用程序将一些数据添加到网页上的表格中。如果添加成功，则会打开一个新网页，并在新页面上显示成功消息。如果添加不成功，则会引发 javascript 警报。接受警报后如何使用 webdriver 检查新网页上是否存在消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T04:33:38.827

如果它在新窗口中打开，您需要先将控件切换到新窗口

[在这里](http://santoshsarmajv.blogspot.in/2012/04/how-to-switch-control-to-pop-up-window.html)找到切换窗口控制的逻辑

将控件切换到新窗口后，您可以验证您想要的任何内容。元素或文本。

元素存在吗？方法逻辑[在这里](http://santoshsarmajv.blogspot.in/2012/07/iselementpresent.html)。

是文本存在吗？方法逻辑[在这里](http://santoshsarmajv.blogspot.in/2013/01/istextpresent-in-webdriver.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:56:59.137

如果我正确理解了这个问题，在将数据发送到表格后，如果发送成功，则窗口会加载一个新网页，否则一旦您接受警报，就会出现警报，窗口已加载。

发送数据后，检查是否存在警报，如果存在警报，则接受它。接下来是验证新加载的网页中是否存在文本。

```
public void isAlertPresent(){
try {
    driver.switchTo.alert().accept();
}
catch ( NoAlertPresentException e ){
}

System.out.println(driver.findElement(By.tagName("body")).getText().contains("Expected Message")); 
```

如果消息出现的位置是静态的，那么我建议您使用比上述更好的方法，例如元素是否具有该文本

```
WebElement element = driver.findElement(By.id("elementID"));

System.out.println(element.getText().trim().equals("Expected Message")); 
```

# javascript - 有没有办法在加载所有元素之前运行 RequireJS 模块？

> ID：15753124
> 
> 赞同：5
> 
> 时间：2013-04-01T22:36:22.257
> 
> 标签：javascript, jquery, requirejs

我从 RequireJS 模块运行 jQuery 初始化。

但是，我注意到 RequireJS 会等到所有页面资产都加载完毕后再执行我的代码。

我正在将一些大图像加载到我的页面中，但不想等到它们被加载来设置我的 jQuery 插件。

尝试执行此操作时是否有最佳实践？

这是我的设置：

**索引.html**

```
<script data-main="js/main.js" src="js/libs/require.js"></script> 
```

**main.js**

```
require(["inits"], function(Inits) {
  //Nothing here yet.
}); 
```

**初始化.js**

```
define([
      'jquery', 
      'jquery.plugin1', 
      'jquery.plugin2',
      'etc'
], function ($) {
   //jQuery Document Ready.
   $(function(){
       //Jquery Init Code here
   });
} 
```

我是 RequireJS 的新手，我做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:03:28.430

好的，所以我有一个似乎正在工作的解决方法。

在这里引用这张票：

[https://github.com/jrburke/requirejs/issues/463](https://github.com/jrburke/requirejs/issues/463)

我将带有 data-main 的脚本标签移到了正文标签的末尾。

```
 <script data-main="js/main.js" src="js/libs/require.js"></script>
 </body> 
```

然后解开我的 jquery 函数：

**前**

```
define([
  'jquery', 
  'jquery.plugin1', 
  'jquery.plugin2',
  'etc'
], function ($) {
   //jQuery Document Ready.
   $(function(){
       //Jquery Init Code here
   });
} 
```

**后**

```
define([
  'jquery', 
  'jquery.plugin1', 
  'jquery.plugin2',
  'etc'
], function ($) {
   //Jquery Init Code here with no Ready Wrapper.
} 
```

它似乎正在工作，并且位于 html 文件的末尾“应该”防止 DOM 出现任何问题。然而，我对这种方法并不完全满意。我想保持开放，看看其他人是否有更好的主意。

# javascript - 使用 requirejs 优化器缩小为单个 javascript 和单个 css

> ID：15753127
> 
> 赞同：2
> 
> 时间：2013-04-01T22:37:00.543
> 
> 标签：javascript, css, requirejs, r.js

我正在编写 jQuery 插件并使用 requirejs 以使我的插件模块化并且更易于编码。该插件也有自己的 css 文件。现在，我想合并和缩小所有的 js 文件和 css 文件。我正在使用 r.js 来做到这一点。这是 build.js 配置文件，它知道如何将 js 文件连接和缩小到一个文件中：

```
({
    baseUrl: 'js/plugin',
    optimize: 'none', // none, uglify or uglify2
    wrap: true,
    name: '../vendor/almond',
    include: 'main',
    out: '../dist/jquery.my-plugin.min.js'
}) 
```

如何添加一个选项来缩小 css 文件？我看到了 cssIn 选项，但是我在哪里告诉 r.js 输出名称是什么？我需要使用模块吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:13:04.420

`r.js``.css`在项目目录中找到的所有文件中自动内联 @import url(...) 链接的内容（从而将多个文件连接到一个主样式表中）。

但是，在您当前的构建配置中，仅`baseUrl`指定，`r.js`甚至不知道 CSS 文件夹（大概是`../../style/`相对于`js/plugin/`. 您必须将`appDir`和`dir`属性添加到您的 buildconfig 文件（在[示例配置文件](https://github.com/jrburke/r.js/blob/master/build/example.build.js)中详细说明）并将项目根目录（即。`appDir`）设置为包含 JS 和 CSS 文件夹的目录。

*请注意，如文档中所述，添加`appDir`将需要更改`baseUrl`相对于`appDir`.*

# node.js - 如何将无缓冲数据从 STDOUT 传输到 ServerResponse？

> ID：15753133
> 
> 赞同：4
> 
> 时间：2013-04-01T22:37:31.187
> 
> 标签：node.js

如何将子进程的无缓冲输出通过管道传输到 HTTP.ServerResponse？

下面的 Node.js 代码适用于*缓冲*输出，但不适用于*无缓冲*输出。

```
var http = require('http'),
    spawn = require('child_process').spawn;

http.createServer(function (req, res) {
    req.on('data', function (data) {
        var ping = spawn("ping", ["127.0.0.1"]);
        ping.stdout.pipe(res);
        ping.stderr.pipe(res);
        req.connection.on('end', function() {
            ping.kill();
        });
    });
}); 
```

这是来自的输出`ping 127.0.0.1`：

```
ping 127.0.0.1
PING 127.0.0.1 (127.0.0.1): 56 data bytes
Request timeout for icmp_seq 0
Request timeout for icmp_seq 1 
```

由于`ping`将请求超时作为非*缓冲*数据写入 STDOUT，因此上面的代码仅在`ping`成功时才有效。

我正在使用 Node.js v0.8.19。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-08T14:33:49.343

这是一个[常见的问题](https://unix.stackexchange.com/questions/25372/turn-off-buffering-in-pipe)，不一定限于 Node.js。

如果您使用的是 Unix，则可以使用该[`unbuffer`](http://expect.sourceforge.net/example/unbuffer.man.html)脚本，它是[Expect](http://www.nist.gov/el/msid/expect.cfm)的一部分。大多数 GNU 系统也提供[`stdbuf`](http://www.gnu.org/software/coreutils/manual/html_node/stdbuf-invocation.html)，它可以让你做同样的事情（尽管我承认对它不是很熟悉）。

如果要使用`unbuffer`，只需将上面的示例更改为：

```
var ping = spawn("unbuffer", ["ping", "127.0.0.1"]); 
```

如果你在 Windows 上，事情就有点困难了，因为 Windows 本身并不提供任何与`PTY`. 诸如[winpty](https://github.com/peters/winpty)（及其 JavaScript 绑定[pty.js ）之类的项目尝试使用](https://github.com/chjj/pty.js/)[Windows 控制台 API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682073(v=vs.85).aspx)重新创建此功能，尽管我发现它们的实现有些错误和不完整。

[ActiveState 的 win32 Expect 包](http://www.activestate.com/activetcl/expect)不是最容易安装的东西，并且在默认发行版中不包含该`unbuffer`脚本。然而，如果你设法让一切正常工作并对 Unix`unbuffer`脚本进行一些小的修改，你应该能够编译一个`unbuffer`可执行文件，然后你可以从 Node.js 调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T09:23:07.203

您正在终止请求连接端的 ping 进程，这会在服务器上成功接收到请求后立即发生。ping 在它可以输出之前一直关闭`Request timeout for icmp_seq 5`。

尝试做这样的事情

```
var http=require('http');
var spawn = require('child_process').spawn;
http.createServer(function (req, res) {
        var ping = spawn("ping", ["127.0.0.1","-c","20"]);
        ping.stdout.pipe(res);
        ping.stderr.pipe(res);
}).listen(8080); 
```

注意： ping 永远持续，所以你不能等待它结束。使用 -c ping x 次。

# selenium - 通过 Xpath 获取元素 (Geb)

> ID：15753134
> 
> 赞同：2
> 
> 时间：2013-04-01T22:37:32.247
> 
> 标签：selenium, groovy, spock, geb

我在通过 Xpath 获取 Element 时遇到问题。我将 Spock 与 Geb 一起使用。我有 HTML：

```
<form class="form" style="display: block;">
<div class="crm-field">
<div class="req label">
<span class="required">*</span>
Моё Имя:
</div>
<div class="value">
<input class="signup" type="text" style="background-color: rgb(255, 255, 255);">
</div>
</div>

<div class="crm-field">
<div class="req label">
<span class="required">*</span>
Login:
</div>
<div class="value">
<input class="signup" type="text" style="background-color: rgb(255, 255, 255);">
</div>
</div>

<div class="crm-field">
<div class="req label">
<span class="required">*</span>
Мой E-mail:
</div>
<div class="value">
<input class="signup" type="text" style="background-color: rgb(255, 255, 255);">
</div>
</div>

<div class="crm-field">
<div class="req label">
<span class="required">*</span>
Пароль:
</div>
<div class="value">
<input class="signup" type="text" style="background-color: rgb(255, 255, 255);">
</div>
</div> 
```

我需要获取`<input class="signup" type="text" style="background-color: rgb(255, 255, 255);">`写入字符串。但是 Geb 只使用 CSS 搜索。请帮助我获取所有输入以及如何将文本写入输入。

我用于获取元素：

```
 driver.findElement(By.xpath("//html/body/div[3]/div[2]/form/div[2]/div[2]/input")) << arg 
```

但我没有得到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T12:22:07.463

Geb 不支持 XPath 表达式，但您仍然可以使用 Geb 的[索引 css 选择器](http://www.gebish.org/manual/snapshot/navigator.html#indexes_and_ranges)获取所需的元素。请注意，与 XPath 基于 1 的索引相反，这些索引是基于 0 的。例如：

```
$('form.form > div', 1).find('input') 
```

**编辑**

实际上，Geb 现在[支持 XPath 表达式](http://www.gebish.org/manual/snapshot/navigator.html#using_webdrivers_by_class_selectors)。请记住，它尚未发布，仅在最新快照中可用，`0.10.1-SNAPHOT`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T09:44:27.507

你还没有说清楚你需要**哪**一个，因为它们都是相似的。但是，在这种情况下，工作方式与位置 XPath 略有不同。

这意味着，得到一些接近你需要的东西，然后围绕它移动 DOM。

例如，如果您需要`input`标签`Email`（大概是输入电子邮件）。您将首先获得`Email`标签（它**接近**您需要的标签）：

```
//div[contains(text(), 'Email')] 
```

然后你会得到这个的`div` **隔壁**，即`div`直接在这个之后，进行以下查询：

```
//div[contains(text(), 'Email')]/following-sibling:div 
```

然后你就可以说，我想要`input`里面的 this `div`，所以它变成：

```
//div[contains(text(), 'Email')]/following-sibling:div/input[@type='text'] 
```

然后，您已经唯一标识了`input`元素，您可以在其中输入`Email`.

# objective-c - 有没有办法从字符串反射性地调用 Objective-C 中的函数？

> ID：15753135
> 
> 赞同：4
> 
> 时间：2013-04-01T22:37:32.433
> 
> 标签：objective-c, reflection

是否有任何 Objective-C 运行时函数可以让我从标识函数的字符串中获取函数（或块）指针？我需要一些方法来动态查找和调用基于某种形式的字符串标识的函数或静态方法。

理想情况下，这个函数应该能够存在于任何动态加载的库中。

查看[Objective-C 运行时参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)，最好的选择看起来像`class_getClassMethod`，但在这个参考中似乎没有任何与函数相关的函数。还有其他原始 C 方法可以通过名称获取指向函数的指针吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:11:23.990

如果你想调用一些静态的 objc 方法，你可以把它作为一个类的类方法

```
@interface MyClas : NSObject
+ (int)doWork;
@end 
```

并通过调用该方法

```
[[MyClass class] performSelector:NSSelectorFromString(@"doWork")]; 
```

如果你真的想使用 C 风格的函数指针，你可以检查[dlsym()](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/dlsym.3.html)

> dlsym() 返回由以空字符结尾的字符串符号指定的代码或数据位置的地址。搜索哪些库和包取决于句柄参数 如果使用特殊句柄 RTLD_DEFAULT 调用 dlsym()，则进程中的所有 mach-o 图像（除了那些使用 dlopen(xxx, RTLD_LOCAL) 加载的图像）按它们的顺序搜索被加载。这可能是一个昂贵的搜索，应该避免。

因此您可以使用它根据符号名称查找函数指针

不知道为什么要这样做，有时使用函数表可以做到

```
typedef struct {
    char *name,
    void *fptr // function pointer
} FuncEntry;

FuncEntry table[] = {
    {"method", method},
    {"method2", method2},
}

// search the table and compare the name to locate function, you get the idea 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:41:49.690

如果您知道方法签名，您可以使用`NSSelectorFromString`函数为其创建选择器，例如：

```
SEL selector = NSSelectorFromString(@"doWork");
[worker performSelector:selector]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T23:08:38.373

你可以用[libffi](http://en.wikipedia.org/wiki/Libffi)做你想做的事。但除非你正在做一些事情，比如创建自己的脚本语言或类似的事情，否则你需要做很多这类事情。很可能是矫枉过正

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T23:23:38.117

我想知道同样的事情..我想，在研究了一下之后..没有“标准C”方法来做这样的事情..（喘气）..但是救援？目标 C 块！

一个匿名函数..可以是 OUTSIDE any`@implementation`等...

```
 void doCFunction() { printf("You called me by Name!"); } 
```

然后，在你的 Objective-C 方法中......你可以以某种方式“获取”名称，并“调用”函数......

```
NSDictionary *functionDict = @{ @"aName" : ^{ doCFunction(); } };
NSString *theName = @"aName";

((void (^)()) functionDict[theName] )(); 
```

结果：`You called me by Name!`

喜欢它！⌘

# php - PHP将单词替换为除图像以外的链接

> ID：15753137
> 
> 赞同：1
> 
> 时间：2013-04-01T22:37:43.057
> 
> 标签：php, preg-replace, str-replace

我的代码是

```
$words = array();
$links = array();
$result = mysql_query("SELECT `keyword`, `link` FROM `articles` where `link`!='".$act."' ") 
or die(mysql_error());
$i = 0;
while($row = mysql_fetch_array( $result )) 
{
if (!empty($row['keyword']))
{
$words[$i] = '/(?<!(src="|alt="))'.$row['keyword'].'/i';
$links[$i] = '<a href="'.$row['link'].'.html" class="ared">'.$row['keyword'].'</a>';
$i++;
}
}
$text = preg_replace($words, $links, $text); 
```

我想用 Guys 替换 Hello，除了 img src 和 alt。

从

```
Say Hello my dear <img src="say-hello-my-dear.jpg" alt="say hello my dear" /> 
```

我想

```
Say Guys my dear <img src="say-hello-my-dear.jpg" alt="say hello my dear" /> 
```

当前代码仅在我的关键字只有 1 个单词时才替换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:42:38.593

编辑：先前建议的更正不相关。

仍然：

*   如果您有性能限制，我建议您不要使用任何正则表达式，而仅在您的情况下使用 str_replace 。
*   您必须更改遗留的 MySQL 函数：http: [//php.net/manual/en/function.mysql-fetch-array.php](http://php.net/manual/en/function.mysql-fetch-array.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:46:50.690

编辑：我不敢相信我花了这么长时间才明白您正在尝试使用正则表达式解析大块 HTML。阅读这个问题的答案： [RegEx match open tags except XHTML self-contained tags](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T00:13:49.253

编辑：我更新了代码以更好地工作。

我不确定到底是什么问题，但是查看您的代码，我不会感到惊讶的是，正则表达式背后的负面外观与多个单词字符串不匹配，其中“关键字”不是 src 或 alt 之后的第一个单词。增强正则表达式可能是可能的，但恕我直言，复杂的正则表达式对于您的 html 解析需求来说可能有点太脆弱了。我建议自己做一些基本的 html 解析并在正确的地方做一个简单的字符串替换。

这是一些基本代码。肯定有比这更好的解决方案，但我不会在这上面花太多时间。可能，您应该创建一个`a`具有正确属性的新 html 元素，而不是在文本节点中插入 html。然后你就不必解码它了。但这将是我的基本方法。

```
$text = "Lorem ipsum <img src=\"lorem ipsum\" alt=\"dolor sit amet\" /> dolor sit amet";

$result = array(
  array('keyword' => 'lorem', 'link' => 'http://www.google.com'),
  array('keyword' => 'ipsum', 'link' => 'http://www.bing.com'),
  array('keyword' => 'dolor sit', 'link' => 'http://www.yahoo.com'),
);

$doc = new DOMDocument();
$doc->loadHTML($text);
$xpath = new DOMXPath($doc);

foreach($result as $row) {
  if (!empty($row['keyword'])) {
    $search = $row['keyword'];
    $replace = '<a href="'.$row['link'].'.html" class="ared">'.$row['keyword'].'</a>';

    $text_nodes = $xpath->evaluate('//text()');
    foreach($text_nodes as $text_node) {
      $text_node->nodeValue = str_ireplace($search, $replace, $text_node->nodeValue);
    }
  }
}

echo html_entity_decode($doc->saveHTML()); 
```

`$result`数据结构与您的`mysql_fetch_array()`. 我只获取创建的 html DOMDocument 的根的子级。如果`$text`更复杂，应该很容易更彻底地遍历文档。我希望这可以帮助你。

# iphone - 如何在课堂之外为 CCSprite 设置动画？

> ID：15753144
> 
> 赞同：0
> 
> 时间：2013-04-01T22:38:35.313
> 
> 标签：iphone, objective-c, ipad, cocos2d-iphone

我在 ClassA 中有实例变量 Cc Sprite *someSprite。B类有实例变量

A 类 * A 类。我想为 B 类中的一些 Sprite 制作动画。我知道我可以合成

并使用像classA这样的点符号来访问它。someSprite，但我想为它制作动画

使用 CCAnimation。`Is there anyway to do this?`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:01:46.957

您可以只使用点符号，然后为该精灵运行一个动作：

```
[classA.someSprite runAction:[CCMoveBy actionWithDuration:1.0 position:ccp(100, 100)]] 
```

# ruby-on-rails-3 - 多表继承 Rails 和 activerecord

> ID：15753146
> 
> 赞同：5
> 
> 时间：2013-04-01T22:38:56.707
> 
> 标签：ruby-on-rails-3, activerecord, class-table-inheritance

我正在尝试使用 ActiveRecord 实现多表继承。看起来所有可用的宝石都很老了。我错过了什么吗？是否有任何“本机”方法可以使用 activerecord 实现这一点？我正在使用 Rails 3.2.3 和 activerecord 3.2.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-08-05T21:07:57.393

### Rails 6.1+ 委托类型

Rails 6.1 添加了一种“原生”方式来通过`delegated type`.

详情请参阅[相应的 PR](https://github.com/rails/rails/pull/39341)。

> 通过这种方法，“超类”是一个由其自己的表表示的具体类，其中存储了所有“子类”之间共享的所有超类属性。然后每个子类都有自己的单独表，用于特定于其实现的附加属性。这类似于 Django 中所谓的多表继承，但这种方法不是实际继承，而是使用委托来形成层次结构并分担责任。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T23:51:21.167

单表继承（每辆 Car 和 Truck 共享一个数据库）

```
class Vehicle < ActiveRecord
end

class Car < Vehicle
end

class Truck < Vehicle
end 
```

在您的情况下，您不是共享数据库，而是共享功能。然后您应该编写一个模块并将其包含在每个模型中

```
class Car < ActiveRecord
  extend VehicleFinders
end

class Truck < ActiveRecord
  extend VehicleFinders
end

module VehicleFinders
  def find_purchased
    #...
  end
end 
```

所以在`extend`模块的方法中是调用类的类方法。`include`模块的方法是调用类对象的实例方法

这对你来说可能是一本好书[http://raysrashmi.com/2012/05/05/enhance-rails-models](http://raysrashmi.com/2012/05/05/enhance-rails-models)

# javascript - 在 AngularJS 中初始化时将全局函数和数据附加到 $rootScope

> ID：15753147
> 
> 赞同：16
> 
> 时间：2013-04-01T22:39:00.870
> 
> 标签：javascript, angularjs

我希望在我第一次启动 AngularJS 应用程序或每次刷新页面时调用一个“全局函数”。

此函数将调用我的服务器`$http.get()`以获取使用我的应用程序所需的全局信息。我需要访问`$rootScope`此功能。在那之后，只有在这个请求完成之后，我才使用`app.config`并`$routeProvider.when()`加载好的控制器。

```
app.config(['$routeProvider', function($routeProvider) {
    $routeProvider
        .when('/', 
        {
            /**/
        });
}]); 
```

我不希望应用程序在此操作完成之前执行某些操作。所以我想我必须使用“解决”，但我真的不知道如何使用它。

任何的想法？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-01T23:03:41.747

这不是解决给定问题的最佳方法，但这里是针对您的问题提出的解决方案。

里面的任何东西`run(...)`都将在初始化时运行。

```
angular.module('fooApp').run(['$http', '$rootScope' function($http, $rootScope) {
 $http.get(...).success(function(response) {
     $rootScope.somedata = response;
 });

 $rootScope.globalFn = function() {
   alert('This function is available in all scopes, and views');
 }

}]); 
```

现在可以在所有视图中触发警报，使用`ng-click="globalFn()"`.

*请注意，如果没有显式继承，使用新隔离范围的指令将无法访问此数据：* `$scope.inheritedGlobalFn = $rootScope.globalFn`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T04:41:00.390

作为解决方案的第一步，我认为您可以监控在每次路由更改（或您的情况下的页面刷新）之前触发的 $routeChangeStart 事件。

```
var app = angular.module('myApp').run(['$rootScope', function($rootScope) {
    $rootScope.$on("$routeChangeStart", function (event, next, current) {
        if (!$rootScope.myBooleanProperty)) {
            $location.path('/');
        }
        else {
            $location.path('/page');
        }
    });
}); 
```

你应该看看[这篇](http://www.frederiknakstad.com/authentication-in-single-page-applications-with-angular-js/)关于单页应用程序中的身份验证的文章。我想你可以做类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-25T15:14:31.420

请考虑这个答案： [https ://stackoverflow.com/a/27050497/1056679](https://stackoverflow.com/a/27050497/1056679)

在执行实际控制器之前，我尝试收集所有可能的解决全局范围内依赖关系的方法。

# c# - Crystal Report 公式中的格式时间字段

> ID：15753148
> 
> 赞同：0
> 
> 时间：2013-04-01T22:39:07.420
> 
> 标签：c#, visual-studio-2012, crystal-reports, sql-server-2012

这是交易，我有一个带有 Time(7) 字段的 SQL 数据库，当我在 VS 项目中连接到 CR 时，CR 将我的 Time 数据库列检测为字符串......或者这让我相信。我可以从数据库中导入我的所有数据，但是当我尝试使用 CR 公式格式化报告中的文件时，我得到***“这个函数已经给出了很多参数”***

我已经阅读了很多并绑定了许多公式，但仍然无法纠正这个问题，我当前的公式代码（看起来很简单）是：

> totext ({Checkin_CheckoutT.Checkin_time}, "hh:mm")

我尝试了另一个似乎在正确轨道上的代码：

> Totext(CTime({Checkin_CheckoutT.Checkin_time}), "hh:mm")

但是有了这个，当我刷新我的报告时，我得到了***“错误的时间格式字符串” 。***我整天都在看这个，但仍然没有解决方案......请帮助！

当前软件：SQL 管理器 2012、VS 2012、Sap CR 13.0.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:19:49.677

Time(7) 只是一个非常精确的时间字段，但是 Crystal（或至少正在使用的版本）是在 Time(7) 存在之前构建的，所以它不知道如何处理它。结果是`hh:mm:ss.nnnnnnn`格式的时间字符串。如果您只需要字符串中的小时和分钟，则使用`Left({Checkin_CheckoutT.Checkin_time}, 5)`拉出前 5 个字符（这将是`hh:mm`部分）。

如果需要，您也可以在之后将其翻转回水晶时间：`CTime(Left({Checkin_CheckoutT.Checkin_time}, 5))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T01:29:26.253

如果您 Crystal 将其作为字符串字段读取，并且您不想弄乱 SQL 代码来转换它，这应该可以工作。我很确定我记得 SQL time(7) 字段在 hh:mm:ss.ms

`time(tonumber(split({yourtime7string},":")[1]),tonumber(split({yourtime7string},":")[2]),0)`

从那里右键单击，格式化字段并告诉Crystal您希望它的外观。

如果您必须在公式中对其进行格式化

```
totext(time(tonumber(split({yourtime7string},":")[1]),tonumber(split({yourtime7string},":")[2]),0),"HH:mm") 
```

# java - ObjectInputStream.readObject() 给出 EOFException

> ID：15753156
> 
> 赞同：3
> 
> 时间：2013-04-01T22:39:43.610
> 
> 标签：java, objectinputstream, eofexception

我对编程完全陌生，所以我很难解决自己的错误。有人建议我在这个网站上尝试一下，所以我想为什么不试一试。

我发现的有关此错误的其他帖子似乎不太相关：大多数人建议关闭输入流，但我的代码已经这样做了。

**我想要它做什么：**将一个名为“photo”的照片对象写入一个名为“test.ser”的文件。然后读取文件“test.ser”并将“test.ser”中对象（“photo”）的路径返回给我。

**它的实际作用：**将一个名为“photo”的 Photo 对象写入“test.ser”。读取“test.ser”，返回 EOFException 并且没有路径。

返回路径实际上并不是很重要，只要它返回一些对我有价值的东西。但是当我使用“System.out.println(photo)”或“photo.getId()”时，我遇到了同样的错误。

我不太确定我需要在这里粘贴什么，所以我将发布我用于序列化和反序列化对象的两个 try/catch-es：

序列化对象：

```
 File test = new File("path.../something.ser");
    Photo photo = new Photo(2, "..\\images\\2.jpg", getImage("..\\images\\2.jpg"));

    try {
        FileOutputStream fos = new FileOutputStream(test);
        ObjectOutputStream out = new ObjectOutputStream(fos);

        if (!test.exists()) {
            test.createNewFile();
        }
        out.writeObject(photo);
        out.close();
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

反序列化对象：

```
 try {
        FileInputStream fis = new FileInputStream(test);
        ObjectInputStream in = new ObjectInputStream(fis);

        in.readObject();

        photo = (Photo)in.readObject();
        photo.getPath();
        in.close();

    } catch (Exception e) {
        e.printStackTrace();
    } 
```

和错误：

```
run:
null
java.io.EOFException
    at java.io.ObjectInputStream$BlockDataInputStream.peekByte(ObjectInputStream.java:2571)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1315)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:369)
    at view.Main.<init>(Main.java:103) 
  //103 is the line that casts the input object to a Photo object.

BUILD SUCCESSFUL (total time: 1 second) 
```

据我所知，当我尝试将通过 readObject 方法接收到的对象类型转换为“照片”类对象时，会发生错误。至少，这就是第 103 行的错误所指的内容。

我在别处读到该错误意味着我“试图读取比实际更多的对象”。不过不确定这意味着什么，因为我只想让它读取 1 张图像——它应该在对象内——并返回它的位置。

我还读到 ObjectInputStream 永远不会返回 null，除非我在某处给出了该值。但它实际上正在返回（？）“null”，即使我的代码不包含空值......

我已经做了好几天了（是的，我就是那么糟糕），但仍然没有运气。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T22:44:15.023

你读了两遍：

```
 in.readObject();

    photo = (Photo)in.readObject(); 
```

删除第一行。此外，您不必创建文件。输出流将为您执行此操作。

# javascript - 在javascript中向元素添加多个事件侦听器

> ID：15753157
> 
> 赞同：2
> 
> 时间：2013-04-01T22:39:44.483
> 
> 标签：javascript, events, return, addeventlistener

我有一个小的拖放设置并运行，但它使用内联javascript，我更愿意将它全部移动到外部文件。从理论上讲，这是一个简单的交换，但是我的检查器中出现了 referenceErrors 并且我的缩小失败了。

据我所知，问题来自`return`.

原始 HTML

```
<section id="titles" ondrop="dropClip(this, event)" ondragenter="return false" ondragover="return false"></section> 
```

所需的 HTML

```
<section id="titles"></section> 
```

JavaScript

```
var titles = document.getElementById('titles');

titles
    .addEventListener('drop', dropClip(this, event))
    .addEventListener('dragenter', return false)
    .addEventListener('dragover', return false); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-01T23:14:01.533

Javascript 是一种语言，其中函数是“一流的对象”。这意味着，可能与您可能有经验的其他编程语言相反，您可以像对待任何其他对象一样对待函数：您可以传递它，您可以返回它，您可以拥有一个函数，其中包含一个带有里面的函数，以此类推。

这样做的结果可能是在 Javascript 中取得成功所需的一种非常意想不到的编程风格。在其他语言中，UI 事件绑定以多种方式发生（例如 C#`Button1.Click += new System.EventHandler(this.myEventHandler);`或 Classic VB `Button_Click()`）。在 C# 中，您可以传递委托，委托是具有专门定义的一组参数和返回值的特殊对象，函数可以绑定到这些对象。但是这一切都在 javascript 中消失了，因为您可以直接将函数附加到*属性*。对于浏览器 DOM 事件处理，该属性被假定为一个函数引用，并且在该事件的本机事件处理代码期间，它调用附加到与该事件同名的属性的函数。

好吧，你说，我们有函数。我们可以传递它们并将它们视为变量。怎么办？

首先，请特别注意以下两个函数声明是*相同*的。它们产生完全相同的结果，即声明`myfun`在当前范围内命名的函数（在浏览器中，`window`对象或正在运行的当前函数）。

```
function myfun(param1, param2) {
   //do some stuff
};

var myfun = function (param1, param2) {
   //do some stuff
}; 
```

（*实际上，第一个最终会`name`得到第二个不会的属性，并且可能还有其他一些细微的差异，但出于所有实际意图和目的，它们是相同的*）。

第一个只是第二个的捷径。基本上，您创建一个函数（可能有名称也可能没有名称）并将其分配给一个变量。程序员使用调用结果“`myfun`函数”的便捷快捷方式，但实际上情况是“`myfun`变量——它现在包含一个特定的函数”。

您可以获得对同一函数的许多引用——这是一个真正的对象——只需将其分配给其他变量：

```
function myfun(param1, param2) {
   //do some stuff
};

var a = myfun, b = myfun, c = myfun;

a(); // runs `myfun`
b(); // runs `myfun`
c(); // runs `myfun` 
```

接下来要注意的是，要调用一个函数，您必须在其名称后使用括号，并且任何参数都放在括号内。

```
var result = myfun('a', 1); // invoke the `myfun` function
   // and store its return value in variable `result` 
```

但是回顾一下我们的赋值语句`a`，它们都是函数的别名`b`：在那些情况下，我们没有使用括号，因为 --**在这里它变得非常重要，所以要注意**：`c``myfun`

 **> 要*调用*函数（并获取函数的返回值），请在其名称后使用括号。
> 
> 要传递函数*引用*，请不要使用括号。

如果我们改为这样做会怎样：

```
var a = myfun(), b = myfun(), c = myfun(); 
```

`a`, `b`, 并且`c`不再是指向`myfun`函数的指针。它们都将是返回的*结果*，`myfun`并且将包含`myfun`返回的任何内容——或者`undefined`如果它没有返回任何内容。如果您尝试调用其中之一，假设`a()`您会收到类似于以下内容的错误：

```
> TypeError: a is not a function 
```

现在我已经画了所有的背景，有一件简单的事情要知道，它会让你走上成功的轨道`addEventListener`：它需要一个函数作为第二个参数。在您的示例代码中，您已经放置了您希望在 addEventListener 调用它们时运行的函数的内容，但没有实际的函数。

您可以通过首先实际声明函数来解决这个问题，例如：

```
function doNothing() {
   return false;
}

titles.addEventListener('dragenter', doNothing);
   // Note: this is not invocation like `doNothing()`, but passing a reference 
```

或者，您可以简单地将函数语句包装到*匿名函数*中。请记住，javascript 中的函数实际上没有名称，我们只有包含函数的变量。匿名函数是一个根本没有名称的函数，它可以通过隐式名称分配来调用（例如作为参数传递——它将具有参数的名称）或通过执行魔术调用直接调用在它后面加上括号的动作。

看起来像这样：

```
titles.addEventListener('dragenter', function () { // anonymous function
    return false;
}); 
```

如果你想调用一个匿名函数，你必须让 javascript 知道你想把它当作一个值来对待，而不是在当前范围内创建一个命名函数的普通快捷方法（其中`function myfun`被视为`var myfun = function`）。这是通过将整个事物包装在另一组括号中来完成的，如下所示：

```
(function () { // begin a function value containing an anonymous function
    // do something
}()); //invoke it, and close the function value 
```

我希望这可以帮助您更多地了解 javascript、为什么您的代码无法正常工作以及您需要做什么才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:47:53.997

当然，您必须将提供给 addEventListener 的函数内容包装到一个函数中。

例如，而不是`.addEventListener('drop', dropClip(this, event))`你会写`.addEventListener('drop', function(event) { dropClip(this, event); })`**

# performance - 您如何在 AppleScript 的处理程序中有效地构建列表？

> ID：15753161
> 
> 赞同：5
> 
> 时间：2013-04-01T22:40:11.317
> 
> 标签：performance, list, reference, applescript, handler

AppleScript 文档建议使用以下代码来有效地构建列表：

```
set bigList to {}
set bigListRef to a reference to bigList
set numItems to 100000
set t to (time of (current date)) --Start timing operations
repeat with n from 1 to numItems
    copy n to the end of bigListRef
end
set total to (time of (current date)) - t --End timing 
```

注意显式引用的使用。这在脚本的顶层或显式运行处理程序中运行良好，但如果您在另一个处理程序中逐字运行相同的确切代码，如下所示：

```
on buildList()
    set bigList to {}
    set bigListRef to a reference to bigList
    set numItems to 100000
    set t to (time of (current date)) --Start timing operations
    repeat with n from 1 to numItems
        copy n to the end of bigListRef
    end
    set total to (time of (current date)) - t --End timing
end buildList
buildList() 
```

它中断，产生一条错误消息，“无法将 bigList 转换为类型引用”。为什么这会中断，在 run() 之外的处理程序中有效构建列表的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:28:54.727

`set end of l to i`似乎比`copy i to end of l`：

```
on f()
    set l to {}
    repeat with i from 1 to 100000
        set end of l to i
    end repeat
    l
end f
set t to time of (current date)
set l to f()
(time of (current date)) - t 
```

您还可以使用脚本对象：

```
on f()
    script s
        property l : {}
    end script
    repeat with i from 1 to 100000
        copy i to end of l of s
    end repeat
    l of s
end f
set t to time of (current date)
set l to f()
(time of (current date)) - t 
```

100000 也超过了[可以保存在已编译脚本中的项目的限制](https://discussions.apple.com/thread/1897143?start=0&tstart=0)，因此如果您运行脚本并尝试将其保存为 scpt，则会收到如下错误：

> 文档“Untitled”无法保存为“Untitled.scpt”。

您可以将`set l to f()`l 放在本地处理程序中，添加`set l to {}`到末尾，或将脚本另存为 .applescript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:55:39.300

这是我前段时间进行的速度测试的结果和方法。请注意，每个试验的第一个结果较慢，因为该脚本之前没有编译过。

[list_speed.xlsx](https://dl.dropbox.com/u/2422542/list_speed.xlsx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T01:22:32.973

将“global bigList”添加到 buildList() 的第一行可修复编译器错误。似乎在运行处理程序中，变量默认是裸露的，并且“引用”运算符很有用。但是，在其他情况下，变量本质上已经是间接引用，并且创建另一个引用层会破坏一些东西。在这些上下文中声明全局变量会去除间接引用并允许“引用”运算符工作，但这是不必要的。只需使用默认的间接引用。

如果不清楚，那是因为我不完全了解机制。如果您对这里发生的事情有更好的了解，请在下面发表评论。

# android - OnTouchListener 用于 Jelly Bean 中的视图

> ID：15753162
> 
> 赞同：1
> 
> 时间：2013-04-01T22:40:26.893
> 
> 标签：android, android-layout, android-ui, android-4.2-jelly-bean

我有一个游戏活动，其中包含一个填满整个屏幕的 SurfaceView。该应用程序被声明为全屏，并显示为全屏。

我的 SurfaceView 有一个 OnTouchListener，它提供一个 GestureDetector，它的功能在大多数设备上都可以正常工作。监听器的设置很简单：

```
surface.setOnTouchListener(listener); 
```

但是，在 Jelly Bean (Nexus 4) 上，触摸软按钮（返回、主页等）会在与我的 SurfaceView 无关的坐标中生成触摸事件。

这目前会产生奇怪的行为。

我可以通过简单地检查触摸事件并查看它们是否适合表面尺寸来解决这个问题。

但是，我想知道是否有更优雅的解决方案 - 一个只会从我的表面而不是那些软按钮给我触摸事件的解决方案。

这在某些未来的设备会做出不同变化的情况下也很重要（例如，将软按钮放在 UPPER 区域）。

# ios - zoomScale、contentOffset 和 Retina

> ID：15753163
> 
> 赞同：0
> 
> 时间：2013-04-01T22:40:29.123
> 
> 标签：ios, objective-c, uiscrollview, zooming

我已经[研究](https://stackoverflow.com/questions/5026650/scrollview-contentoffset-zoomscale) [了](https://stackoverflow.com/questions/15604276/change-zoomscale-and-contentoffset-of-uiscrollview-in-uiapplicationstatebackgrou) [所有](https://stackoverflow.com/questions/7301744/unwanted-scrolling-when-animating-zoomscale-in-uiscrollview) [这些](https://stackoverflow.com/questions/3051361/how-much-contentoffset-changes-in-uiscrollview-for-zooming) [SO](https://stackoverflow.com/questions/13160206/uiscrollview-and-zoomscale) [答案](https://stackoverflow.com/questions/1854547/updating-zoomscale-of-uiscrollview)，但似乎没有一个能解决我面临的问题。

简而言之，我的滚动/缩放代码可以在*视网膜前*设备上正常工作，但在 iOS 5.x 和 6.x 的 4、4S 和 5 上，我的代码适用于低于 1.0 的任何缩放值对其进行了测试，但在 zoomScale 恰好为 1.0 或更高时中断。

此时，整个视图向顶部/左侧移动

这段代码：

```
- (void) layoutSubviews {

    [super layoutSubviews] ;

    ::NSLog(@"x:%.02f contentOffset (%0.2f:%0.2f)"
    ,   self.zoomScale
    ,   self.contentOffset.x
    ,   self.contentOffset.y) ;
} 
```

在视网膜上产生这个：（zoomScale 从小于 1.0 到大于 1.0 的**抖动过渡）**

```
x:0.96 contentOffset (1334.37:622.55)
x:0.98 contentOffset (1371.34:639.45)
x:1.00 contentOffset (226.45:202.26) 
x:1.02 contentOffset (227.59:204.19) 
x:1.03 contentOffset (228.71:206.10) 
```

在非视网膜上产生这个：（zoomScale 从小于 1.0 到大于 1.0 的**平滑过渡）**

```
x:0.95 contentOffset (2211.01:2247.41) 
x:0.97 contentOffset (2257.25:2295.54) 
x:0.99 contentOffset (2303.52:2343.69) 
x:1.03 contentOffset (2403.40:2447.63) 
x:1.05 contentOffset (2457.57:2504.00) 
```

任何人？

**编辑**记录滚动/缩放的视图变换会产生一致的（仍然是错误的！）结果：

非视网膜

```
scale:0.98 contentOffset(29.11:40.02) transform: [0.978491, 0, 0, 0.978491, 0, 0]
scale:0.99 contentOffset(31.79:43.71) transform: [0.992378, 0, 0, 0.992378, 0, 0]
scale:1.01 contentOffset(35.71:49.11) transform: [1.01268, 0, 0, 1.01268, 0, 0]
scale:1.03 contentOffset(38.40:52.79) transform: [1.02656, 0, 0, 1.02656, 0, 0]
scale:1.04 contentOffset(41.09:56.49) transform: [1.04048, 0, 0, 1.04048, 0, 0] 
```

视网膜

```
scale:0.98 contentOffset(1377.56:1511.69) transform: [0.984364, 0, 0, 0.984364, 0, 0]
scale:0.99 contentOffset(1392.50:1528.51) transform: [0.993929, 0, 0, 0.993929, 0, 0]
scale:1.02 contentOffset(227.42:300.11) transform: [1.01742, 0, 0, 1.01742, 0, 0]
scale:1.03 contentOffset(228.26:301.48) transform: [1.02922, 0, 0, 1.02922, 0, 0]
scale:1.03 contentOffset(228.48:301.84) transform: [1.03236, 0, 0, 1.03236, 0, 0] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:49:34.513

固定的。

当我在初始化时更换

```
 self.scrollView.contentSize = (CGSize) {CGFLOAT_MAX, CGFLOAT_MAX} ; 
```

和

```
self.scrollView.contentSize = (CGSize) {1e9, 1e9} ; 
```

然后 zoomScale 和 contentOffset 在视网膜和非视网膜设备上变得一致。

我的猜测是，当 Apple 推出 Retina 设备时，它们还（不经意间？）*将浮点坐标空间的跨度*从

**[CGFLOAT_MIN，CGFLOAT_MAX]**

到

**[未定义，CGFLOAT_MAX/retina-device-scale]**

...

# matlab - 使用 ND 数组中前 2 个元素的逻辑索引？

> ID：15753164
> 
> 赞同：0
> 
> 时间：2013-04-01T22:40:30.427
> 
> 标签：matlab

所以我有一个 = rand(3,3,2)。

然后我有一个逻辑索引，类似于

> > b = [1 0 0; 0 0 1; 1 1 1]

b =

```
 1     0     0
 0     0     1
 1     1     1 
```

但我希望能够为 a(:,:,1) 和 a(:,:,2) 调用 a(b)。a(:,:,1) 和 a(:,:,2) 都有共享的逻辑索引。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:51:39.423

```
a1 = a(:,:,1);
a2 = a(:,:,2);

selected_a1 = a1(b==1);
selected_a2 = a2(b==1); 
```

在这里，我们选择矩阵 a 中 b 为 1 的所有值，然后将它们存储到 selected_a1 和 selected_a2 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:43:56.883

假设`b`是一个逻辑数组（如果不是，则通过 do 进行转换`b = logical(b);`），然后尝试以下操作：

```
a([b(:); b(:)]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T22:45:32.647

如果`b`是一个逻辑数组，那么你可以做

```
n = size(a, 3);

a(repmat(b, [1,1,n])) 
```

# dart - 如何使用 Dart 和 web 以 60fps 的速度驱动动画循环？

> ID：15753170
> 
> 赞同：20
> 
> 时间：2013-04-01T22:41:07.543
> 
> 标签：dart, dart-html

如何在 Dart Web 应用程序中以 60fps 的速度驱动动画循环或游戏循环？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-04-01T22:41:07.543

使用`window.animationFrame`，传统的基于未来的表亲`window.requestAnimationFrame`。

Dart 一直在转向使用[Future](http://api.dartlang.org/docs/releases/latest/dart_async/Future.html)和[Stream](http://api.dartlang.org/docs/releases/latest/dart_async/Stream.html)作为更面向对象的方式来处理异步操作。基于回调的 (old 'n busted)`requestAnimationFrame`被基于 Future 的 (new hotness) 取代`animationFrame`。

这是一个示例：

```
import 'dart:html';

gameLoop(num delta) {
  // do stuff
  window.animationFrame.then(gameLoop);
}

void main() {
  window.animationFrame.then(gameLoop);
} 
```

的签名`animationFrame`看起来像：

```
Future<num> animationFrame(); 
```

请注意如何`animationFrame`返回一个以 a 结尾的 Future `num`，它包含一个类似于 的“高性能计时器” `window.performance.now()`。`num`从现在到页面开始时，这是一个单调递增的增量。它具有微秒分辨率。

Future 在浏览器即将绘制页面之前完成。更新您的世界状态并在此 Future 完成时绘制所有内容。

如果您希望动画或循环继续，您必须在每一帧上从 animationFrame 请求一个新的 Future。在此示例中，`gameLoop()`注册以在下一个动画帧上得到通知。

顺便说一句，有一个名为[game_loop](http://pub.dartlang.org/packages/game_loop)的 pub 包，您可能会发现它很有用。

# apache - 使用 HTACCESS 重写 index.html 并将 http://site.com 重定向到 http://www.site.com

> ID：15753176
> 
> 赞同：1
> 
> 时间：2013-04-01T22:41:43.520
> 
> 标签：apache, .htaccess, redirect

在 .htaccess 中，我看到如何重写**/index.html**以指向主域：

```
RewriteEngine on
RewriteCond %{THE_REQUEST} ^.*\/index\.html?\ HTTP/
RewriteRule ^(.*)index\.html?$ "/$1" [R=301,L] 
```

我也了解 .htaccess 如何防止网站在 WWW 下被索引，而没有它

```
RewriteEngine on
rewritecond %{http_host} ^mycustomcloset.com [nc]
rewriterule ^(.*)$ http://www.mycustomcloset.com/$1 [r=301,nc] 
```

但是你如何同时做到这两点呢？

换句话说，我希望**mycustomcloset.com**和**mycustomcloset.com/index.html**都指向**[http://www.mycustomcloset.com](http://www.mycustomcloset.com)**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T05:36:00.547

我不理解您问题的第一个代码，但是您仍然可以尝试这个：

```
Options +FollowSymlinks
RewriteEngine on
RewriteBase /

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} !^$
RewriteRule ^(.*) http://www.%{HTTP_HOST}/$1 [R,NE] 
```

现在，如果您还想将*mycustomcloset.com/index.html*和*www.mycustomcloset.com/index.html*重定向到*www.mycustomcloset.com* ，那么您可以试试这个：

```
Options +FollowSymlinks
RewriteEngine on
RewriteBase /

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} !^$
RewriteCond %{REQUEST_URI} !^/index.html$
RewriteRule ^(.*) http://www.%{HTTP_HOST}/$1 [R,NE]

RewriteRule ^index.html$ http://www.mycustomcloset.com [R,NE] 
```

# java - 数据存储管理

> ID：15753178
> 
> 赞同：0
> 
> 时间：2013-04-01T22:41:55.280
> 
> 标签：java

我的任务是创建一个商店系统。我用来编程的语言是Java，信息必须保存在程序运行的电脑中。

据我所知，Access 在 Visual Basic 方面做得很好，因为我可以使用 Access 界面并使用 VB 编辑一些 cdoe。

我想到的另一个选择是创建某种我自己的导入/导出系统，它将信息保存到文件中并在需要时加载它们，这需要大量额外的编码。

所以我该怎么做？用 Java 做到这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T22:44:10.523

执行此操作的标准方法可能是使用 SQL 数据库，例如 sqlite 或 mysql，但这在很大程度上取决于您正在设计的系统类型。选项真的是，

*   SQL 数据库（如 sqlite）
*   NoSQL 数据库（如 couchdb）
*   对象序列化。您可以只序列化对象并将它们转储到文件中。

您是否需要处理多个程序读写数据库的并发性？您是否需要降低数据丢失或损坏的风险，或者您是否可以牺牲一些数据安全性来快速轻松地实施？您需要存储大量数据还是仅存储一些数据？它需要多快访问，是一次访问还是需要查询某些内容？

我们确实需要所有这些问题的答案，以便能够为您提供最佳答案。

# openstreetmap - 如何避免标记重叠

> ID：15753179
> 
> 赞同：0
> 
> 时间：2013-04-01T22:42:09.353
> 
> 标签：openstreetmap, cloudmade

我在 cloudemade 地图中有很多标记。有时在同一位置有多个 ob 标记。我使用集群功能，但如何避免在同一个坐标上有多个标记？在这种情况下，我只想将标记放在一起。

```
var myMarkerLatLng = new CM.LatLng(<?php echo($rowg['lat'].','.$rowg['lon']); ?>);
                var myMarker = new CM.Marker(myMarkerLatLng, {
                    title: "<?php echo($row['name']); ?>",
                    icon: icon 
                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:33:58.710

我们的旧 Web Maps API 已弃用。请使用传单代替它。[您可以在http://leafletjs.com/examples/quick-start.html](http://leafletjs.com/examples/quick-start.html)找到好的代码示例。是免费且易于定制的。

# html - css 垂直居中文本

> ID：15753180
> 
> 赞同：0
> 
> 时间：2013-04-01T22:42:10.500
> 
> 标签：html, css

我在 w3school 的测试器中输入了这个，但我不知道如何垂直对齐文本。`vertical-align:middle;`没有帮助。

```
<!DOCTYPE html>
<html>
<head>
<style>
ul
{
list-style-type:none;
margin:0;
padding:0;
}
a
{
display:block;
width:100px;
height:30px;
margin:5px;
background-color:#66CC33;
text-decoration:none; color:#000;
text-align:center;
font-family:"Verdana",Times,serif;
vertical-align:middle;
}
</style>
</head>

<body>
<ul>
<li><a href="#home">Home</a></li>
<li><a href="#news">News</a></li>
<li><a href="#contact">Contact</a></li>
<li><a href="#about">About</a></li>
</ul>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T22:44:15.670

设置`line-height`等于`height`（30px）。

[http://jsfiddle.net/9Gr9S/](http://jsfiddle.net/9Gr9S/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:44:37.070

```
li {
padding-right: 80px;
padding-top: 25px; /*could be bottom depens on what you prefer to do.*/
} 
```

我猜这项工作，如果 px 不匹配与他们一起玩，看看你能做什么。

不要忘记确认或投票。

# netty - 有关如何在 Netty 中编写阻塞应用程序代码的详细信息？

> ID：15753183
> 
> 赞同：0
> 
> 时间：2013-04-01T22:42:30.510
> 
> 标签：netty

我在这里看到了常见问题解答[http://netty.io/4.0/guide/#faq.4](http://netty.io/4.0/guide/#faq.4)但我正在寻找更多详细信息。（FAQ 中的代码摘录如下。）我认为`DefaultEventExecutor`应该是`DefaultEventExecutorGroup`，但我没有找到一个全面的解释，让我知道在`MyHandler`课堂上放什么，或者如何处理更复杂的情况。

*   你在什么方面实施`MyHandler`？`messageReceived`?
*   信息如何从上一步 ( `HttpChunkAggregator`) 流向`MyHandler`? 换句话说，一个处理程序调用什么来将消息传递给下一个处理程序？
*   如果有两个带有阻塞代码的处理程序，可以并行执行，你会怎么做，然后（我猜）将它们的结果组合到第三个处理程序中来编写响应？

[来自[常见问题](http://netty.io/4.0/guide/#faq.4)]

```
public static void main(String[] args) throws Exception {
    final EventExecutor executor = new DefaultEventExecutor(8);

    ServerBootstrap bootstrap = new ServerBootstrap();
    bootstrap.group(new NioEventLoopGroup(), new NioEventLoopGroup());
    bootstrap.childHandler(new ChannelInitializer<Channel>() {
        @Override
        public void initChannel(Channel channel) {
            ChannelPipeline pipeline = channel.pipeline();
            pipeline.addLast("decoder", new HttpRequestDecoder());
            pipeline.addLast("aggregator", new HttpChunkAggregator(65536));
            pipeline.addLast("encoder", new HttpResponseEncoder());
            pipeline.addLast("chunkedWriter", new ChunkedWriteHandler());

            // MyHandler contains code that blocks so add it with the
            // EventExecutor to the pipeline.
            pipeline.addLast(executor, "handler", new MyHandler());        
        }
     });

     sb.bind(socketAddress);

     // Other code

  }

   public class MyHandler extends SimpleChannelUpstreamHandler {
      // Your blocking application code 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T07:22:04.750

[`BlockingReadHandler`](https://github.com/netty/netty/blob/3/src/main/java/org/jboss/netty/handler/queue/BlockingReadHandler.java)尽管它适用于 3.x，但可能会给您一个想法。它已从 4.0 中删除，因为它不是很有用 - 大多数人只想保持异步。另请注意，使用基于反应器的框架模拟阻塞操作只会由于上下文切换增加而降低性能。

# variables - 如何测试具有可变 ID 的项目？

> ID：15753185
> 
> 赞同：0
> 
> 时间：2013-04-01T22:42:35.690
> 
> 标签：variables, xpath, selenium, selenium-ide, automated-tests

我想在我的网页中测试可变图片和可变复选框。它就像一个在线市场，所以每次你刷新同一个页面时，你都会得到不同ID的不同图片和不同ID的复选框。

我试过 XPath，但它包含一个 ID，所以我不能每次都在同一个页面上使用它：

```
INPUT[@name="data[car.**88535**]"] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T07:34:06.497

您实际上可以使用 xpath “列出”所有复选框。

喜欢 ：

`List<WebElement> elements = driver.findElements(By.xpath("//input[@type='checkbox']"));`

我认为您可以将其用于您的图片。

因此，您可以这样做：

```
void checkCB(List<WebElement> c) {
    for (WebElement e : c)
        if ("yes".equals(e.getAttribute("checked")))
        Systeme.println("Element is checked");
} 
```

（目前使用 selenium 2.0 编写）

# sql-server - 将 SQL Server 表格图表粘贴到 Word 中 - 图表太小

> ID：15753188
> 
> 赞同：4
> 
> 时间：2013-04-01T22:42:48.393
> 
> 标签：sql-server, sql-server-2008, ms-word, diagram

使用 SQL Server 2008 R2

1.  从我的工作站，我通过远程桌面登录到我们的 SQL Server 并启动 SQL Server Management Studio。

2.  我创建了一个新的数据库图表并排列了表格——图表看起来很好。

3.  然后我选择 Edit -> Copy Diagram to Clipboard

4.  我最小化远程桌面会话并将图表粘贴到 Word（在我的工作站上）。

不幸的是，该图大约是 SQL Server 上显示的大小的 1/5——我知道，我可以扩展该图以使其更大——但它看起来像 Cr*p！！并且非常不可读。

通过远程桌面工作时，是否有什么导致图表如此之小？（我别无选择，因为我必须远程登录 SQL Server 才能生成图表）。

有没有其他人有这个问题？

我要做的就是将图表从 SQL Server 复制到 Word（以更新一些文档）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-27T09:49:34.520

您可以粘贴到 MS Paint 中，然后将其保存为 .bmp 文件。然后您可以通过文件传输选项发送文件。

我认为这会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-05T05:55:41.563

*   在数据库图中，在复制之前，请放大到所需的缩放。
*   将其复制并粘贴到 MS 油漆中！

而已！这会将放大的分辨率复制到油漆中，然后从那里导出到您喜欢的格式是小菜一碟！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-25T05:21:17.910

当图表在屏幕上时使用**printscreen 按钮**并将其粘贴到**MS Paint**中，它将为您提供与显示器一样的精确分辨率。

# php - 我有两个复选框，我需要根据我的 sql 值显示或隐藏一个或另一个

> ID：15753189
> 
> 赞同：0
> 
> 时间：2013-04-01T22:42:56.733
> 
> 标签：php, sql

如果选中复选框`['transfer']`，这将是页面上显示的默认复选框，则在保存并刷新页面后，他们应该只有查看复选框的选项`['reverse']`。

如果他们选择反向并保存复选框的选项`['transfer']`应该再次出现。

我正试图绕过它，它看起来很简单，但我有一个块自动取款机。

所以我为我的 sql 查询创建了一个变量：

```
$secular = sql::value("select * from ev.do.taskAU where event_id = $event_id and transfer = '1'"); 
```

本质上，这两个复选框将在数据库中具有相同的字段名称。这将是`['transfer']`并且它应该根据位 0 或 1 更改。

希望这是有道理的，任何帮助将不胜感激。

这就是我正在尝试的：

```
<?php 

$secular = sql::value("select * from event.dbo.taskAU where event_id = $event_id and transfer = '1'");
$checked = $secular['transfer'];

?>

<table><tr>
     <?php if ($checked == 1) echo "<td>Transfer</td><?php if (in_array(login::$id, array('02O','04R','0A3','0BN','0BO','00D','0FR','0E1'))) { echo <td>". cbox_return('transfer') ."</td>"; ?>
     <?php if ($checked == 0) echo "<td>Reverse</td><?php if (in_array(login::$id, array('02O','04R','0A3','0BN','0BO','00D','0FR','0E1'))) { echo <td>". cbox_return('transfer') ."</td>"; ?></tr></table>

</tr></table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:23:56.143

一旦您从数据库中获得了该项目是否被检查的值，您将使用以下代码：

```
 $checked = ('whatever value you got from the database');

$checkedValOne = (in_array(login::$id, array('02O','04R','0A3','0BN','0BO','00D','0FR','0E1'))) ? true : false;

$checkedValTwo = ($checked == 1 ? true : false;

    <input type="checkbox" value="<?php echo (($checkedValOne && $checkedValTwo) ? "checked" : ""));?>" /> 
```

`checked`仅当数据库中的值为. 时，上述代码才会添加到复选框中`1`。

# php - 如何通过 AJAX-Post 传递嵌套的 PHP-Array？

> ID：15753190
> 
> 赞同：1
> 
> 时间：2013-04-01T22:42:57.060
> 
> 标签：php, jquery, ajax, arrays, post

我有一个期望的 PHP 脚本：

```
$_REQUEST['asdf']['bsdf']['csdf'] 
```

在调用它时设置，我无法更改它。我想通过 ajax 调用这个 PHP 脚本：

```
myurl = 'example-url.com';
myid = $(this.$element).attr('id'); //gets the id of a textfield: csdf
value = 'somevalue';

$.ajax({type: 'POST',
        url: myurl,
        data: {'asdf[bsdf][myid]': value},
        success: function (data) {
          /* blabla */
       }
}); 
```

但它不起作用，因为 var "myid" 没有填充假定的值 "csdf"。有人可以帮我怎么做吗？

PS：我无法访问 PHP 文件，因此无法更改结构...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:30:17.340

在 JS 中

```
... {
     ...
     data: {[['first', 'array', 'nested'], 'other', 'in', 'parent', 'array']},
     ...
} 
```

在 PHP 中获取 POST vars 与其他句子

[http://php.net/manual/en/reserved.variables.post.php](http://php.net/manual/en/reserved.variables.post.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:18:33.513

尝试这样的事情：

```
var myurl = 'example-url.com';
var myid = $(this.$element).attr('id'); //gets the id of a textfield: csdf
var value = 'somevalue';

var param = {};
param[myid] = value;

$.ajax({type: 'POST',
        url: myurl,
        data: {'asdf[bsdf]' : param},
        success: function (data) {

                 }
}); 
```

您可以在通过 ajax 调用传递的数据之外构建 param 对象，以保持正确的密钥到位。

# email - 查找登录的用户电子邮件 Buddypress

> ID：15753194
> 
> 赞同：0
> 
> 时间：2013-04-01T22:43:07.093
> 
> 标签：email, buddypress

如何检索和显示当前登录的用户的电子邮件。我正在使用 Buddypress。

```
<?php
global $bp;

 function bp_member_user_email() {
echo $bp->bp_get_member_user_email();
}

$bp->bp_member_user_email();

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T06:51:29.203

一：

```
global $bp;
echo $bp->loggedin_user->userdata->user_email; 
```

二：

```
global $bp;
echo bp_core_get_user_email($bp->loggedin_user->id); 
```

三：

```
echo bp_core_get_user_email(get_current_user_id()); 
```

# html - 在空格后删除字符串中的字符

> ID：15753196
> 
> 赞同：0
> 
> 时间：2013-04-01T22:43:21.253
> 
> 标签：html, whitespace

我对那个 java 框架有问题，它似乎在空格字符后删除了字符串的内容。

代码示例

```
<input type="text" name="txtName" size="25" value=<%=Name%>> 
```

如果 Name 等于“This is my name”，则输入文本仅显示“This”。

我猜这是为了避免 xss 问题，但我需要能够使用包含空格的字符串，所以我该如何解决这个问题？（我正在使用tomcat）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:44:50.270

您需要在value 属性的*值周围添加引号。*

当属性值包含空格时，在**HTML**中总是如此。

（即它与Java无关）

它应该如下所示：

```
<input type="text" name="txtName" size="25" value="<%= Name %>"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T22:45:32.527

这会做... `value="<%=Name%>"`

```
<input type="text" name="txtName" size="25" value="<%=Name%>"> 
```

# jquery - Internet Explorer 中的 Markdown 失败

> ID：15753198
> 
> 赞同：5
> 
> 时间：2013-04-01T22:43:58.167
> 
> 标签：jquery, css, markdown, jquery-1.9, wmd-markdown

为了我的目的，我正在使用来自[*arhpreston*](https://github.com/arhpreston/jquery-markdown "Extends the stacakoverflow markdown editor to work as a jQuery plugin.")[的jQuery Markdown 。](https://github.com/arhpreston/jquery-markdown "扩展 stacakoverflow 降价编辑器以作为 jQuery 插件工作。")*我的 jQuery 代码（虽然无关）是：*

 *```
var converter = new Markdown.Converter();
$(document).ready(function(e) {
    $('#content').html( converter.makeHtml($('#content').text()) );
}); 
```

其中，`#content`是一个`div`：

```
<div id="content">This is another of most common type of error. It is usually encountered when you are trying something which needs a user registration(at the very least). If you haven't registered on the hub yet, **Gods help you!**.

Anyways, the hub is mostly open for registrations on weekends(*generally* Sunday; sometimes Saturday too). Keep looking at the **Hub Topic** for the notifying information on the registration details. 

### NOTE
You must not, under any non-dire circumstance ask any Admin to get your nick registered. We *WILL* be banning you. It is annoying if nothing else.</div> 
```

一切正常，我完全没有问题。唯一的问题是文本在 Internet Explorer 中被解析为半 HTML，如屏幕截图所示：

![像往常一样，MS IE 很烂](https://i.stack.imgur.com/ognE2.png)

[像往常一样，MS IE 很烂]

从屏幕截图中可以看出，我所有的粗体和斜体都被正确的 HTML 解析，但所有其他标记都失败了。链接（带有`[1]:`方案）被解析，但未链接到实际内容。它们只是作为文本附加在末尾。

之间的以下内容`hr`显示了应该如何解析它。

* * *

这是另一种最常见的错误类型。当您尝试需要用户注册（至少）的东西时，通常会遇到这种情况。如果你还没有在Hub上注册，请大**神帮助你！**.

无论如何，该中心主要在周末开放注册（*通常是*周日；有时也是周六）。继续查看**Hub 主题**以获取有关注册详细信息的通知信息。

### 笔记

在任何非危急情况下，您都不得要求任何管理员注册您的昵称。我们*将*禁止你。如果没有别的，这很烦人。

* * *

我为此使用 IE 7。但问题也存在于 IE 8 上。jQuery 版本是 1.9.1。该页面在任何其他操作系统（Windows Xp 到 8、*nix 和 Leopard）中的任何其他浏览器（Opera、Firefox、Chrome、Safari）上解析都没有问题。通过向 IE 用户显示使用其他浏览器的消息，我没有任何问题。**只想知道这个故障是从哪里来的？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T16:10:13.700

尝试将呼叫替换为`.text()`呼叫`.html()`。我还没有验证这一点，但确实记得早期版本的 IE 有一些类似的东西。*

# ruby-on-rails - Rails webrick 生产端口号

> ID：15753203
> 
> 赞同：0
> 
> 时间：2013-04-01T22:44:19.380
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

如何在生产中永久更改我的应用程序端口号？

我知道我可以在启动服务器时指定端口号`rails s -p 3005`，但想知道如何更改它，这样我每次启动应用程序时都不必指定端口号。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-01T22:51:55.210

**不要在生产中使用 webrick。**

它仅针对开发目的进行了优化。[例如，使用thin](http://code.macournoyer.com/thin/)、[unicorn](http://unicorn.bogomips.org/)或[Passenger](https://www.phusionpassenger.com/)之类的东西。在部署应用程序时，您可以找到启动或重新启动 Web 服务器的 capistrano 配方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:52:01.893

即使问题引用在开发中运行，[这似乎也回答了您的问题。](https://stackoverflow.com/questions/3842818/how-to-change-rails-3-server-default-port-in-develoment)我倾向于同意根据 config/boot.rb[修改](https://stackoverflow.com/a/6539193/1223770)。

但是，iltempo 是正确的，您应该在生产中使用不同的堆栈。我和Passenger相处得很好。

# c++ - 使用 xmlrpc 的未定义引用错误

> ID：15753208
> 
> 赞同：1
> 
> 时间：2013-04-01T22:44:42.367
> 
> 标签：c++, qt, linker, undefined, xml-rpc

我正在尝试在 QT-Creator 中使用 XML-RPC 客户端示例，并且出现了我似乎能够解决的链接错误。

主.cpp：

```
#include <cstdlib>
#include <string>
#include <iostream>
#include <xmlrpc-c/girerr.hpp>
#include <xmlrpc-c/base.hpp>
#include <xmlrpc-c/client_simple.hpp>

using namespace std;

int
main(int argc, char **) {

    if (argc-1 > 0) {
        cerr << "This program has no arguments" << endl;
        exit(1);
    }

    try {
        string const serverUrl("http://localhost:8080/RPC2");
        string const methodName("sample.add");

        xmlrpc_c::clientSimple myClient;
        xmlrpc_c::value result;

        myClient.call(serverUrl, methodName, "ii", &result, 5, 7);

        int const sum = xmlrpc_c::value_int(result);
            // Assume the method returned an integer; throws error if not

        cout << "Result of RPC (sum of 5 and 7): " << sum << endl;

   } catch (exception const& e) {
        cerr << "Client threw error: " << e.what() << endl;
    } catch (...) {
        cerr << "Client threw unexpected error." << endl;
    }

    return 0;
} 
```

。轮廓：

```
#-------------------------------------------------
#
# Project created by QtCreator 2013-04-02T00:25:47
#
#-------------------------------------------------

QT       += core gui

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

TARGET = Mark2
TEMPLATE = app

SOURCES += main.cpp\
        mainwindow.cpp

HEADERS  += mainwindow.h

FORMS    += mainwindow.ui

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/release/ -lxmlrpc++
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/debug/ -lxmlrpc++
else:unix: LIBS += -L$$PWD/../../../../../../usr/lib/ -lxmlrpc++

INCLUDEPATH += $$PWD/../../../../../../usr/include
DEPENDPATH += $$PWD/../../../../../../usr/include

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/release/ -lxmlrpc_client++
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/debug/ -lxmlrpc_client++
else:unix: LIBS += -L$$PWD/../../../../../../usr/lib/ -lxmlrpc_client++

INCLUDEPATH += $$PWD/../../../../../../usr/include
DEPENDPATH += $$PWD/../../../../../../usr/include 
```

这直接来自[http://xmlrpc-c.sourceforge.net/doc/#clientexamplepp](http://xmlrpc-c.sourceforge.net/doc/#clientexamplepp)

我收到以下错误：

> 错误：未定义对“xmlrpc_c::clientSimple::clientSimple()”的引用

如您所见，我已包括

> xmlrpc-c/client_simple.hpp

它提供了 clientSimple 的定义。我已经通过 ubuntu 软件中心“libxmlrpc-c++4-dev”和“xmlrpc-api-utils”安装了 xmlrpc 库

我错过了什么？任何帮助将不胜感激！

# php - 使用连接变量连接到 MySQL DB

> ID：15753216
> 
> 赞同：0
> 
> 时间：2013-04-01T22:45:19.900
> 
> 标签：php, mysql

我有一个包含两个表的数据库。我创建了一个通过连接变量连接到数据库的注册脚本。我只指定 DBuser DBpassword DBhost 和 DBname 作为我的参数。我是否必须添加我试图访问的特定数据库表

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:54:28.683

连接数据库就够了；你不需要，但要使用其他 mysql 语句，如`select`, `insert`,... 是的，你应该指定表名

# java - 如何从图像中读取文本

> ID：15753217
> 
> 赞同：-1
> 
> 时间：2013-04-01T22:45:23.313
> 
> 标签：java, php, javascript

嘿伙计们，是否可以从图像中读取文本，例如您如何提交表单并要求您填写图像中的文本。我想知道是否可以阅读其中的文字。如果有，是什么语言？

大卫·比加

编辑：

我不是想阅读验证码，我只是给出一个带有文本的图像示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:46:20.810

可以使用[光学字符识别](http://en.wikipedia.org/wiki/Optical_character_recognition)读取文本。

但是，[CAPTCHA](http://en.wikipedia.org/wiki/CAPTCHA)旨在阻止这种情况，以便将人类与计算机区分开来。

# css - :hover 在 IE9 中使用线性渐变

> ID：15753218
> 
> 赞同：0
> 
> 时间：2013-04-01T22:45:24.760
> 
> 标签：css, internet-explorer-9, hover, css3pie, linear-gradients

这个按钮的设计要求它有一个线性渐变，但是当你将鼠标悬停在它上面时，按钮应该变成一个平面颜色。主类看起来像这样，它似乎在我测试过的所有浏览器中都可以使用。如您所见，我还使用 PIE 使渐变在较低的 IE 浏览器中正常工作。

```
.mvcView.button.texture {
        background-color: #F34914;
        border-width: 0px;
        color: #fff;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        padding: 4px;

        min-width: 40px;
        overflow:visible;   /*overflow visible is required for ie 7 to respect min-width and doesn't seem to affect other browsers.  */
        width : auto;
        vertical-align: middle;

        font-family: Arial;
        background-color: #F34914;
        background: -webkit-linear-gradient(top, #F34914, #8A2800);
        background: -moz-linear-gradient(top, #F34914, #8A2800);
        background: -ms-linear-gradient(top, #F34914, #8A2800);
        background: -o-linear-gradient(top, #F34914, #8A2800);
        background: linear-gradient(top, #F34914, #8A2800);
       -pie-background: linear-gradient(#F34914, #8A2800);

       behavior: url('/PIE.htc');
} 
```

对于 webkit 浏览器，以下 css 将鼠标悬停时颜色更改为平坦：

```
.mvcView.button.texture:hover {
    background: #AA3200;
} 
```

对于 IE9，只有当我这样做时，悬停才有效：

```
.mvcView.button.texture:hover {
    background: #AA3200;
    background-color: #AA3200;
    -pie-background: linear-gradient(#AA3200, #AA3200);

    behavior: url('/PIE.htc');
} 
```

还有另一种更优雅的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-01T19:57:59.410

似乎这是一个 PIE 错误。我有同样的问题。如果您将 PIE 行为分配给 css 类或 id，看起来您不能只是`#id:hover{background:#some-color;}`，因为它`-pie-background`也期待您已经将其定义为渐变，因此它适用于除 IE 之外的所有浏览器是正常的，因为 PIE 是专门为此设计的。一种解决方法是使用 PIE 设置父级样式（添加圆角、阴影、渐变），并添加一个继承父级宽度和高度的子级，并使用或不使用 PIE 和`background:none;`（无渐变）设置样式。然后为孩子简单地做`.child:hover{background:#some-solid-color;}`. 因此，如果它是您正在设计的按钮，正常时，它将填充您定义的任何父饼图渐变，并且当悬停时，由于子“覆盖”（可以这么说）父，它将显示纯色。当然，当深度嵌套 div 或任何其他元素时，这违背了我的更好判断。另一方面，您在上面为 IE9 发布的解决方案也可以解决问题（IE 6-8 也是如此）。虽然我不知道这两种解决方案中的哪一种会适得其反，但如果我不得不猜测一下，我认为添加一个无梯度的孩子会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T09:55:07.527

渐变是某种图像，所以如果你设置渐变，你可以这样做

```
.button {
    background-image: linear-gradient(#F34914, #8A2800);
}

.button:hover {
    background-image: none;
    background-color: #AA3200;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-03T10:17:48.527

```
/** DON'T FORGET ABOUT <element class="ahover"><span>Text</span></a> IF U USE TEXT ELEMENT *//

.ahover {
display: block;
/** text-indent: -999em; ** if u use only only img **/
position: relative;
}
.ahover:after {
content: "";
height: 100%;
left: 0;
opacity: 0;
position: absolute;
top: 0;
transition: all 0.5s ease 0s;
width: 100%;
z-index: 1;
}
.ahover:hover:after {
opacity: 1;
}
.ahover span {
display: block;
position: relative;
z-index: 3 } 
```

# datatable - DataTables 的问题 - sScrollX 属性不起作用

> ID：15753222
> 
> 赞同：1
> 
> 时间：2013-04-01T22:45:41.073
> 
> 标签：datatable, datatables

我的 JavaScript 如下所示：

```
$(document).ready(function () {
        oTable = $('#ecTable').dataTable({
            "sScrollY": "580px",
            "sScrollX": "600px",
            "bPaginate": false,
            "bScrollCollapse": true,
            "bProcessing": true,
            "bInfo": true,
            "aaSorting": [[0, 'desc']]
        });
    }); 
```

结果表如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/ln4ps.png)

如您所见，有些事情是不对的。我似乎无法让 DataTables 实际显示 X 滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-20T12:07:08.140

尝试这个..

```
"sScrollXInner": "100%",
"sScrollX": "100%" 
```

# java - Log4j Jboss 配置

> ID：15753223
> 
> 赞同：0
> 
> 时间：2013-04-01T22:45:48.827
> 
> 标签：java, maven, log4j, jboss7.x

我正在使用 Maven 和 JBOSS 7.1 开发一个网络应用程序，

Iv 环顾四周，但找不到任何关于如何使用 maven 和 JBOSS 7.1 设置 log4j 的直接示例。

理想情况下，我希望能够为每个要捕获日志的类登录到服务器上的不同文件，

有人可以帮我吗？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:03:16.730

我以这种方式配置了 JBOSS 7.1 记录器：

默认情况下，JBoss 有几个记录器（数据输入点）和两个附加程序（数据输出点）CONSOLE 和 FILE，在 JBOSS_HOME/standalone/configuration 目录下的standalone.xml 文件中定义。

在standalone.xml 中，我在`<profile>`以下部分创建了新的附加程序：

```
<periodic-rotating-file-handler name="FOO_BAR_FILE">
    <formatter>
        <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
    </formatter>
    <file relative-to="jboss.server.log.dir" path="foo_bar_file.log"/>
    <suffix value=".yyyy-MM-dd"/>
    <append value="true"/>
</periodic-rotating-file-handler> 
```

为我需要记录的特定类添加了记录器：

```
<logger category="my.example.Foobar">
    <level name="INFO"/>
    <handlers>
        <handler name="FOO_BAR_FILE"/>
    </handlers>
</logger> 
```

还有我的班级Foobar：

```
public class Foobar {
    final static Logger log = LoggerFactory.getLogger(Foobar.class);

    public Foobar() {
        /* Log to foo_bar_file.log in jboss server log dir. */
        log.info("Foobar log example.");
    }
} 
```

# vbscript - 将变量从 vbscript 传递到带有参数的批处理文件

> ID：15753224
> 
> 赞同：0
> 
> 时间：2013-04-01T22:45:56.210
> 
> 标签：vbscript, batch-file

请问如何将这个 vbs 中的“inp”变量传递给我的名为 job.bat 的批处理？确实在从 job.bat 执行回显（echo %2）时，我注意到 inp 没有正确传递。提示命令查看 inp而不是从 vbs 检索到的值。谢谢

```
For Each listElement In xmlDoc.selectNodes("document/Lists/list")
 msgbox "toto"
 inp=listElement.selectSingleNode("entry").text
 out=  listElement.selectSingleNode("output").text
 jeton=  listElement.selectSingleNode("token").text

 dim shell
 set shell=createobject("wscript.shell") 
 shell.run "job.bat ""a file"" **inp** "
 set shell=nothing 
 Next 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T08:13:14.413

与其他几种语言不同，VBScript 不会在字符串中展开变量。正因为如此，`inp`在字符串

```
"job.bat ""a file"" inp " 
```

只是文字字符串`"inp"`，而不是变量的值`inp`。要生成具有变量值的字符串，您必须像[@rojo](https://stackoverflow.com/a/15754722/1630171)建议的那样连接基本字符串和变量：

```
shell.run "job.bat ""a file"" " & inp 
```

但是，如果没有一些安全预防措施，我不建议这样做。一方面，您应该始终在参数周围加上双引号，以防它们包含空格。我通常为此使用引用函数来防止指令充满四引号：

```
Function qq(str) : qq = Chr(34) & str & Chr(34) : End Function

'...
shell.run "job.bat " & qq("a file") & " " & qq(inp) 
```

您还应该*始终*对传递给 shell 命令的所有用户输入进行清理。否则，您的用户可能会通过输入类似`foo & del /s /q C:\*.*`. 通常的做法是只允许输入字符串中的已知良好字符，并用安全字符（例如下划线）替换其他所有字符。您可以使用正则表达式来实现：

```
Set re = New RegExp
re.Pattern = "[^ a-z0-9äöü.,_$%()-]"
re.Global  = True
re.IgnoreCase = True

inp = re.Replace(inp, "_") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T01:38:55.787

我想你要找的是这个。

```
shell.run "job.bat ""argfile.ext"" " & inp 
```

* * *

然而，正如[Ansgar Wiechers](https://stackoverflow.com/a/15759171/1683264)指出的那样，这是一个潜在的严重安全漏洞，因为精心制作的 XML 文件可以运行任意命令。要封装批处理文件参数并防止意外后果，请考虑切换到`Shell.Application`对象的[ShellExecute 方法](http://ss64.com/vb/shellexecute.html)。

```
For Each listElement In xmlDoc.selectNodes("document/Lists/list")

    msgbox "toto"
    inp = listElement.selectSingleNode("entry").text
    out = listElement.selectSingleNode("output").text
    jeton = listElement.selectSingleNode("token").text

    set shell=CreateObject("Shell.Application") 
    shell.ShellExecute "job.bat", """a file"" " & inp, "path\to\batfile\", "runas", 1
    set shell=nothing 

Next 
```

# javascript - 在执行淡出和淡入时更新内容

> ID：15753225
> 
> 赞同：1
> 
> 时间：2013-04-01T22:45:57.683
> 
> 标签：javascript, jquery, html

我正在尝试更新动态测验的内容，当您回答问题时，您单击下一个按钮，然后该部分应该淡出，更新内容，然后再次淡入新问题。

这是我用来做这件事的一段代码

```
function changeQuestion(){
    questions.fadeOut();
    // first, check answer
    if($("#myForm input[type='radio']:checked").length ==1){
        //add the answer to the answers array
        answers[number] = $("#myForm input[type='radio']:checked").val(); 
        // increment the number
        number++;

        // then, move to next question OR show results
        if (number < allQuestions.length) {
            $('#back').show();
            addQuestionAndAnswers();

        }else {
            displayResult();
        }
    }else{
        alert('please select an answer before proceed');
    }
    questions.fadeIn(); 
} 
```

但是，当我在该部分淡出时单击下一个按钮进行内容更新时......我一直在尝试执行一个淡出内容的函数fadeOut()，然后调用changeQuestion函数，但我得到了相同的结果。我会留下我正在尝试做的事情，希望有人能帮助我。

[http://jsfiddle.net/xtatanx/Wn8Qg/16/](http://jsfiddle.net/xtatanx/Wn8Qg/16/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:49:25.223

您必须使用完成功能，`fadeOut()`以便仅在淡入淡出完成后替换内容。有关更多信息，请参阅[jQuery 文档。`.fadeOut()`](http://api.jquery.com/fadeOut/)

像这样的东西：

```
function changeQuestion(){
    questions.fadeOut(function() {
        // first, check answer
    if($("#myForm input[type='radio']:checked").length ==1){
            //add the answer to the answers array
            answers[number] = $("#myForm input[type='radio']:checked").val(); 
            // increment the number
            number++;

            // then, move to next question OR show results
            if (number < allQuestions.length) {
                $('#back').show();
                addQuestionAndAnswers();

            }else {
                displayResult();
            }
        }else{
            alert('please select an answer before proceed');
        }
        questions.fadeIn(); 
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:53:07.653

我建议将您的`changeQuestion()`功能更改为：

```
function changeQuestion() {
    if ($("#myForm input[type='radio']:checked").length == 1) {
        questions.fadeOut(400, function () {
            // first, check answer

            //add the answer to the answers array
            answers[number] = $("#myForm input[type='radio']:checked").val();
            // increment the number
            number++;

            // then, move to next question OR show results
            if (number < allQuestions.length) {
                $('#back').show();
                addQuestionAndAnswers();

            } else {
                displayResult();
            }
            questions.fadeIn();
        });
    } else {
        alert('please select an answer before proceed');
    }
} 
```

这样，通过在尝试淡出之前评估是否有选定的答案，如果没有选定的答案，您将不会淡出；此外，由于您在淡入淡出完成后更改内容，您的效果应该看起来像预期的那样......

[**点击这里进行演示**](http://jsfiddle.net/darkajax/2WV6u/1/)

# java - 使用套接字连接到远程虚拟机

> ID：15753232
> 
> 赞同：0
> 
> 时间：2013-04-01T22:46:19.453
> 
> 标签：java, sockets, ubuntu, client-server, serversocket

我正在尝试使用 Java 中的套接字连接到虚拟机。我的客户端和服务器应用程序在本地主机上没有问题。当我运行服务器代码并尝试使用 IP 地址和端口号从单独的计算机连接时，我的客户端连接超时。

这是我的虚拟机网络设置页面的链接[https://wiki.redbrick.dcu.ie/mw/RBVM_Networking](https://wiki.redbrick.dcu.ie/mw/RBVM_Networking)

我是否需要在 Java 中指定任何特定参数以使我的服务器接受连接？这是我必须与 VM 网络管理员讨论的问题吗？

任何建议，将不胜感激 ！

ps 我正在运行 ubuntu 服务器，可以远程访问 phpmyadmin 没有问题。

**编辑**

我已经运行了 nmap，并且我用于服务器端应用程序的端口显示为打开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:40:38.360

我的提供商阻止了除了少数几个端口之外的所有端口，得到了一个开放端口列表，现在它可以工作了。呸！

# bash - 在 ksh 中使用“typeset -r”和“readonly”关键字确定范围异常

> ID：15753234
> 
> 赞同：1
> 
> 时间：2013-04-01T22:46:22.107
> 
> 标签：bash, shell, ksh, readonly, typeset

`function`首先，在使用关键字 vs.声明函数时，我知道 bash 和 ksh 之间的一般范围界定差异（动态/静态），`myfunction()`并且这篇文章仅讨论有关只读变量的范围界定问题。

不过，今天我偶然发现了一些让我感到困惑的事情。我有一个脚本，它从使用关键字声明的函数中获取文件`function`（因此，当我通过“全局范围护目镜”查看这些单独的文件时，我并没有立即意识到为什么会发生以下情况）。作为最近清理的一部分，我将这些源文件中的各种变量设置为只读，并注意到代码的某些部分在 ksh93 下停止工作，这取决于我如何将变量标记为只读。更具体地说，如果我使用`readonly FOO=bar`,`${FOO}`将对源文件的其余部分取消设置。

这说明了问题：

（注意：内联代码的行为是相同的（与获取源代码的第二个脚本相比），但由于它在这里保存了一些行并且帖子已经很长了，所以我保持原样）

readonly_test_sourced.sh：

```
readonly   foo=function
typeset -r bar=function
typeset    baz=function
readonly   baz
qux=function
readonly   qux
quux=function
typeset -r quux 
```

readonly_test.sh：

```
function f
{
    . ./readonly_test_sourced.sh
    printf "foo=${foo}\nbar=${bar}\nbaz=${baz}\nqux=${qux}\nquux=${quux}\n"
}

g()
{
    . ./readonly_test_sourced.sh
    printf "foo=${foo}\nbar=${bar}\nbaz=${baz}\nqux=${qux}\nquux=${quux}\n"
}

[ -n "${KSH_VERSION}" ]  && echo "ksh: ${KSH_VERSION}"
[ -n "${BASH_VERSION}" ] && echo "bash: ${BASH_VERSION}"

for var in foo bar baz qux quux; do
    unset "${var}"
    eval "$var=global" # don't do this at home, there are better ways
done

func="${1:-f}"
echo
echo "inside function ${func}"
echo '----------------'
${func}

echo
echo "global scope after calling ${func}"
echo '----------------------------'
printf "foo=${foo}\nbar=${bar}\nbaz=${baz}\nqux=${qux}\nquux=${quux}\n" 
```

这是我使用 ksh93u+ 得到的输出：

```
$ ksh ./readonly_test.sh f
ksh: Version JM 93u+ 2012-02-29

inside function f
----------------
foo=
bar=function
baz=function
qux=
quux=

global scope after calling f
----------------------------
foo=function
bar=global
baz=global
qux=function
quux=function

$ ksh ./readonly_test.sh g
ksh: Version JM 93u+ 2012-02-29

inside function g
----------------
foo=function
bar=function
baz=function
qux=function
quux=function

global scope after calling g
----------------------------
foo=function
bar=function
baz=function
qux=function
quux=function 
```

这就是我在 bash 4.2 中得到的：

```
$ bash ./readonly_test.sh f
bash: 4.2.42(1)-release

inside function f
----------------
foo=function
bar=function
baz=function
qux=function
quux=

global scope after calling f
----------------------------
foo=function
bar=global
baz=global
qux=function
quux=function

$ bash ./readonly_test.sh g
bash: 4.2.42(1)-release

inside function g
----------------
foo=function
bar=function
baz=function
qux=function
quux=

global scope after calling g
----------------------------
foo=function
bar=global
baz=global
qux=function
quux=function 
```

我还通过 mksh 运行它（它根据其手册页实现动态范围，它确实产生与使用 bash 相同的结果）：

```
$ mksh ./readonly_test.sh f
ksh: @(#)MIRBSD KSH R40 2012/03/20

inside function f
----------------
foo=function
bar=function
baz=function
qux=function
quux=

global scope after calling f
----------------------------
foo=function
bar=global
baz=global
qux=function
quux=function

$ mksh ./readonly_test.sh g
ksh: @(#)MIRBSD KSH R40 2012/03/20

inside function g
----------------
foo=function
bar=function
baz=function
qux=function
quux=

global scope after calling g
----------------------------
foo=function
bar=global
baz=global
qux=function
quux=function 
```

观察：

*   `readonly`有时`typeset -r`是同义词，有时不是

*   bash 和 mksh

    *   有 3 种可能的不同情况（对于 f 和 g）：

        *   [1]`readonly foo=function`赋值`'function'`给全局变量`foo`，不声明新的局部变量（与 [4] 相同）
        *   [2]`typeset -r bar=function`分配`'function'`给新的局部变量`bar`（与 [3] 相同）
        *   [3]`typeset baz=function; readonly baz`分配`'function'`给新的局部变量`baz`（与 [2] 相同）
        *   [4]`qux=function; readonly qux`分配`'function'`给全局变量`qux`并且不声明新的局部变量（与 [1] 相同）。`qux`在本地和全局范围内都是只读的，但这是可以预期的，因为它将全局变量标记为只读，并且由于动态范围，它在函数中也变为只读（旁注：[另请参见](https://stackoverflow.com/questions/5005903/scoping-problems-in-different-shell-languages)）。
        *   [5]`quux=function; typeset -r quux`赋值`'function'`给全局变量`quux`，然后声明一个`quux`没有值的新局部变量
    *   `readonly`从不声明新的（局部）变量（如预期的那样）。对于 [1] 和 [4]，它将全局变量标记为只读，对于 [3]，它标记新的局部变量。这完全是我所期望的，这意味着`readonly`运行的范围与相应变量本身的范围相同，即

        *   `x=y`; if `$x`is local then`readonly x`会将局部变量标记为`x`只读
        *   `x=y`; 如果`$x`是全局的，那么`readonly x`会将全局变量标记为`x`只读
    *   [1] / [2] 和 [4] / [5] 之间的一致性，分别

*   在 ksh 中（讨论 f；g 的行为符合预期）：

    *   还有3种可能的不同情况：
        *   [6] `readonly foo=function`：类似于 [5]、[8] 和 [9]，但更令人困惑，因为这是一个单一的命令（相对于：先赋值，`readonly`后赋值`typeset -r`）。显然`readonly`声明了一个`foo`没有值的新局部变量，但将全局变量设置`foo`为`'function'`. **？！？**. `foo`在函数和全局范围内都变为只读。
        *   [7]`typeset -r bar=function`分配`'function'`给新的局部变量`bar`（与 [8] 相同）
        *   [8]`typeset baz=function; readonly baz`分配`'function'`给新的局部变量`baz`（与 [7] 相同）。`baz`仅在函数范围内变为只读
        *   [9]`qux=function; readonly qux`分配`'function'`给全局变量`qux`，然后声明一个`qux`没有值的新局部变量（与 [5]、[6]、[10] 相同）。`qux`仅在函数范围内变为只读
        *   [10]`quux=function; typeset -r quux`分配`'function'`给全局变量`quux`，然后声明一个`quux`没有值的新局部变量（与 [5]、[9]、[10] 相同）。`quux`仅在函数范围内变为只读。
    *   `readonly`似乎在 [6] 和 [9] 中声明了新的局部变量，但在 [8] 中没有。

bash 的行为是预期的。`typeset`(= `declare`) 在函数范围内创建/修改（bash 可以`-g`选择强制在全局范围内创建/修改，即使在函数内部使用），`readonly`实际上只是“标记”现有变量，从不引入新的局部变量。[5] 让我有点困惑，因为我之前从未声明过未设置的只读变量，我会假设如果存在同名的全局变量，它会修改它，但我绝对可以忍受这种行为，因为它是一致的与其他场景和存在`-g`。

但是，据我了解，ksh 手册页无法完全解释上述所有场景以及关键字`readonly`和`typeset -r`关键字之间的细微差别，除非我在重新阅读问题中的相应部分时遗漏了某些内容。最让我困惑的是，它在 and 之间的作用域差异的解释附近没有提到关键字，`readonly`并且内置的简短解释也没有提到任何关于此的内容。基于此，我永远不会假设像 do 那样引入新的、静态范围的变量，而且在某些（但不是全部）场景中这样做似乎真的出乎意料。`foo()``function bar``readonly``readonly``typeset -r`

对我来说最令人困惑的场景是 [6]，我无法理解那里到底发生了什么（这也是破坏我的代码的特定场景）。

我的观察是否正确，有人可以阐明 ksh93 的行为吗？（我希望这个问题的范围可以接受（没有双关语））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T13:52:40.597

欢迎来到 shell 不兼容的世界 :)

如果我正确理解了这个问题，那就是关于

**功能废话{}**

和

**废话（）{}**

寻找广告人 ksh(1)（在 Solaris 上，如果这有什么不同的话）

```
 Functions defined by the function name syntax and called  by
 name execute in the same process as the caller and share all
 files and present working directory with the  caller.
 ...
 Ordinarily,  variables
 are  shared  between  the  calling program and the function.
 However, the typeset special built-in command used within  a
 function  defines  local  variables whose scope includes the
 current function. They can be passed to functions that  they 
```

相对

```
 Functions defined  with  the  name()  syntax  and  functions
 defined  with the function name syntax that are invoked with
 the . special built-in are executed in the caller's environ-
 ment  and  share  all  variables  and traps with the caller.
 Errors within these function  executions  cause  the  script
 that contains them to abort. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T12:55:25.560

错误如下，当您不使用`"local"`或使函数成为子shell时，函数没有“本地”范围！

因此，使用`f() ( <code> )`而不是`f() { <code> }`获取您的本地范围！

不过，你有一点！

`"readonly <var>"`和的区别`"declare -r <var>"`！

```
# ./readonly_test.sh
bash: 3.00.16(1)-release

inside function
----------------
foo=function
bar=function
baz=function
qux=function
quux=

global scope after calling
----------------------------
foo=global
bar=global
baz=global
qux=global
quux=global 
```

# sql-server - 具有多个数据库引擎的实体框架

> ID：15753244
> 
> 赞同：1
> 
> 时间：2013-04-01T22:47:08.913
> 
> 标签：sql-server, oracle, db2, entity-framework-5

我们有一些 .Net 应用程序，我们想开始使用 Entity Framework 5.0，但问题是我们的客户可以选择使用以下任一数据库引擎：

*   SQL Server（95% 的客户使用此引擎）
*   Oracle（3% 使用此引擎）
*   DB2 (2%)

如您所见，我们绝大多数的客户都使用 SQL Server。所以我的问题是，假设每个数据库引擎将具有相同的精确架构布局，那么我们所要做的就是更改实体连接字符串以针对这些引擎类型中的每一个，对吗？

对不起，如果这似乎是一个简单的问题，但我只是想确保我在这里走在正确的轨道上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T12:20:18.990

我不知道实体框架，但数据库引擎之间有很多差异。

例如安全性，在 DB2 中始终是外部的（OS secutiry），在 Oracle 中大部分时间是内部的。过程语言不同，希望你不要将它用于多平台应用程序。

最好的办法是尝试对每个数据库执行，并调整过程以便在所有数据库中工作，但我认为你必须做更多的事情来更改连接字符串。

# ios - iOS stringByEvaluatingJavaScriptFromString 问题

> ID：15753247
> 
> 赞同：1
> 
> 时间：2013-04-01T22:47:21.887
> 
> 标签：ios, uiwebview, stringbyevaluatingjavascr

我在下面有这个代码来设置我的 UIWebView：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
{

    [webView stringByEvaluatingJavaScriptFromString:[NSString stringWithFormat:@"document.getElementById(\"image\").src=\"q%@.png\";", self.imageIndex]];

    NSLog(@"%f", [[webView stringByEvaluatingJavaScriptFromString:@"document.getElementById(\"image\").height;"] floatValue]);

    CGFloat width = [[webView stringByEvaluatingJavaScriptFromString:@"document.width"] floatValue];
    CGFloat height = [[webView stringByEvaluatingJavaScriptFromString:@"document.height"] floatValue];   

    CGSize contentSize = CGSizeMake(width, height);

    [self setUpNewSize:contentSize];
} 
```

我为具有 id 的对象设置了新图像（并且它有效）。但大小不变。如您所见，我使用 NSLog 打印高度值，但它显示高度为 0.0000。

这是我的 HTML 文件：

```
<!DOCTYPE html>
<html>
    <head>

        <title>Question 1</title>

    </head>

    <body>

        <h3 id="header">Question 1</h3>

        <img id="image" src="" alt="" width="100%">

    </body>

</html> 
```

我对每个图像都有不同的高度，并且它会动态变化。所以我的问题是为什么当我调用 stringByEvaluatingJavaScriptFromString 时 document 和 img 的高度没有改变。也许我需要创建一些重新加载方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:30:19.637

您在设置 src 属性后立即访问高度和宽度。您应该先等待图像加载。

您可以通过检查以下委托调用中的请求 url 来检测图像是否正在加载。

`- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType`

一旦您知道图像开始加载，您就可以在随后的调用中获取它的高度和宽度

```
- (void)webViewDidFinishLoad:(UIWebView *)webView 
```

# php - 独特的访客柜台？

> ID：15753248
> 
> 赞同：0
> 
> 时间：2013-04-01T22:47:25.857
> 
> 标签：php

我找到了一个脚本，可以让我显示唯一身份访问者的数量，但似乎有问题。它在停止之前数了我三遍。我不擅长 PHP，但我试图找出问题所在，但无法解决。我的代码有问题吗？还有另一种更好、更简单的方法吗？

```
<?php

$filename = "UniqueCount.txt";

if (!file_exists($filename))
{
// hits.txt doesn't exist, let's try to create it.
$fd = fopen($filename, "w+");
fclose($fd);
}

$file = file($filename);
$file = array_unique($file);
$hits = count($file);

// Print out the number of unique visitors we have had.
echo $hits;

$fd = fopen($filename, "r");
$fstring = fread($fd, filesize($filename));
fclose($fd);

$fd = fopen($filename, "w");
$fcounted = $fstring . "
" . $_SERVER["REMOTE_ADDR"];
$fout = fwrite($fd, $fcounted);
fclose($fd);

?> 
```

要启动，当它创建文件时。我得到错误，说

`0 Warning: fread() [function.fread]: Length parameter must be greater than 0 in /home/content/46/10721146/html/UniqueHits.php on line 20`

提前致谢，

精英玩家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-08T15:34:38.357

有更简单、更完美的方式将数据存储在数据库中

创建两个表

```
CREATE TABLE `pageview` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`page` text NOT NULL,
`userip` text NOT NULL,
 PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 
```

// 全视图

```
CREATE TABLE `totalview` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`page` text NOT NULL,
`totalvisit` text NOT NULL,
 PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 
```

插入和更新表

```
$check_ip = mysql_query("select userip from pageview where page='yourpage' and userip='$user_ip'");
if(mysql_num_rows($check_ip)>=1)
{

}
else
{
  $insertview = mysql_query("insert into pageview values('','yourpage','$user_ip')");

  $updateview = mysql_query("update totalview set totalvisit = totalvisit+1 where page='yourpage' ");
} 
```

完整的教程在这里[http://talkerscode.com/webtricks/create-a-simple-pageviews-counter-using-php-and-mysql.php](http://talkerscode.com/webtricks/create-a-simple-pageviews-counter-using-php-and-mysql.php)

# actionscript-3 - AS3 子类不工作

> ID：15753253
> 
> 赞同：0
> 
> 时间：2013-04-01T22:47:52.620
> 
> 标签：actionscript-3, flash

错误 5000“必须子类 flash.display.MovieClip”/“必须子类 flash.display.SimpleButton” 我终于决定在论坛跳跃后询问答案。基本上，当我扩展 MovieClip 时，影片剪辑的错误消失了，但出现了简单的按钮错误。当我扩展简单按钮时，出现影片剪辑错误。包含两者或以其他方式使其工作的最简单方法是什么？

```
//psuedo code 

import flash.display.*;
public class classInSession extends MovieClip //or SimpleButton
{
    var Btn:SimpleButton;//This needs SimpleButton
    public function reception123() {

        stop();//This needs MovieClip
        Btn.enabled = true;//This needs SimpleButton
        Btn.addEventListener(MouseEvent.MOUSE_DOWN, goSomewhere);

        function goSomewhere(event:MouseEvent):void{
            gotoAndStop(1);//This also needs MovieClip
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:05:11.517

既是 a `MovieClip`（用于动画）*又*是 a `SimpleButton`（用于按钮）是没有意义的。

你想要的是 a `MovieClip`which *has a* `SimpleButton`。

您发布的代码就是这样做的，但我认为您的主要问题是您实际上并没有 create `Btn`，所以它是`null`在进行该调用时（因此没有子类化`SimpleButton`）：

1.  你的类应该有一个构造函数；
2.  在构造函数中，您使用`Btn = new SimpleButton();`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T11:38:48.833

我做了很多，但我相信击中标记的箭头是从发布设置中取消选中“自动声明阶段实例”。

# c# - c# RavenDB 嵌入式优化

> ID：15753256
> 
> 赞同：0
> 
> 时间：2013-04-01T22:48:20.580
> 
> 标签：c#, .net, database, optimization, ravendb

我有一个数据库（RavenDB），它需要能够每 10 秒处理 300 个查询（全文搜索）。为了提高性能，我拆分了数据库，所以我有多个 documentStores 我的代码：

```
 var watch = Stopwatch.StartNew();
        int taskcnt = 0;
        int sum = 0;

        for (int i = 0; i < 11; i++)
        {
            Parallel.For(0, 7, new Action<int>((x) =>
            {
                for(int docomentStore = 0;docomentStore < 5; docomentStore++)
                {
                    var stopWatch = Stopwatch.StartNew();
                    Task<IList<eBayItem>> task = new Task<IList<eBayItem>>(Database.ExecuteQuery, new Filter()
                    {
                        Store = "test" + docomentStore,
                        MaxPrice = 600,
                        MinPrice = 200,
                        BIN = true,
                        Keywords = new List<string>() { "Canon", "MP", "Black" },
                        ExcludedKeywords = new List<string>() { "G1", "T3" }
                    });
                    task.ContinueWith((list) => {
                        stopWatch.Stop();
                        sum += stopWatch.Elapsed.Milliseconds;
                        taskcnt++;
                        if (taskcnt == 300)
                        {
                            watch.Stop();
                            Console.WriteLine("Average time: " + (sum / (float)300).ToString());
                            Console.WriteLine("Total time: " + watch.Elapsed.ToString() + "ms");

                        }

                    });
                    task.Start();
                }

            }));
            Thread.Sleep(1000);

        } 
```

*   平均查询时间：514,13 ms
*   总时间：00:01:29.9108016

我查询 ravenDB 的代码：

```
 public static IList<eBayItem> ExecuteQuery(object Filter)
    {
        IList<eBayItem> items;
        Filter filter = (Filter)Filter;

        if (int.Parse(filter.Store.ToCharArray().Last().ToString()) > 4)
        {
            Console.WriteLine(filter.Store); return null;
        }
        using (var session = Shards[filter.Store].OpenSession())
        {
            var query = session.Query<eBayItem, eBayItemIndexer>().Where(y => y.Price <= filter.MaxPrice && y.Price >= filter.MinPrice);

            query = filter.Keywords.ToArray()
            .Aggregate(query, (q, term) =>
                q.Search(xx => xx.Title, term, options: SearchOptions.And));
            if (filter.ExcludedKeywords.Count > 0)
            {
                query = filter.ExcludedKeywords.ToArray().Aggregate(query, (q, exterm) =>
                q.Search(it => it.Title, exterm, options: SearchOptions.Not));
            }
            items = query.ToList<eBayItem>();
        }
        return items;
    } 
```

以及 RavenDB 的初始化：

```
 static Dictionary<string, EmbeddableDocumentStore> Shards = new Dictionary<string, EmbeddableDocumentStore>();
    public static void Connect()
    {
        Shards.Add("test0", new EmbeddableDocumentStore() { DataDirectory = "test.db" });
        Shards.Add("test1", new EmbeddableDocumentStore() { DataDirectory = "test1.db" });
        Shards.Add("test2", new EmbeddableDocumentStore() { DataDirectory = "test2.db" });
        Shards.Add("test3", new EmbeddableDocumentStore() { DataDirectory = "test3.db" });
        Shards.Add("test4", new EmbeddableDocumentStore() { DataDirectory = "test4.db" });
        foreach (string  key in Shards.Keys)
        {
            EmbeddableDocumentStore store = Shards[key];
            store.Initialize();
            IndexCreation.CreateIndexes(typeof(eBayItemIndexer).Assembly, store);
        }
    } 
```

如何优化我的代码，使我的总时间更短？把我的数据库分成 5 个不同的数据库好不好？

**编辑：**该程序只有 1 个 documentStore 而不是 5 个。（正如[Ayende Rahien](https://stackoverflow.com/questions/15753256/c-sharp-ravendb-embedded-optimize/15755871#15755871)所建议的）这也是它自己的查询：

```
Price_Range:[* TO Dx600] AND Price_Range:[Dx200 TO NULL] AND Title:(Canon) AND Title:(MP) AND Title:(Black) -Title:(G1) -Title:(T3) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T04:05:23.627

不，这不好。使用单个嵌入式 RavenDB。如果你需要分片，这涉及到多台机器。

通常，每个 RavenDB 查询都在几毫秒内。您需要显示查询的样子（您可以在它们上调用 ToString() 来查看）。

以这种方式拥有 RavenDB 的分片意味着它们都在争夺 CPU 和 IO

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-21T11:02:21.913

我知道这是一篇旧帖子，但这是我得到的最高搜索结果。

我遇到了同样的问题，我的查询需要 500 毫秒。现在通过应用以下搜索实践需要 100 毫秒：[http ://ravendb.net/docs/article-page/2.5/csharp/client-api/querying/static-indexes/searching](http://ravendb.net/docs/article-page/2.5/csharp/client-api/querying/static-indexes/searching)

# asp.net - 如何修复 ASP.NET 应用程序的 502.3 错误

> ID：15753261
> 
> 赞同：1
> 
> 时间：2013-04-01T22:48:45.070
> 
> 标签：asp.net, http, iis, timeout

我们的 asp.net 应用程序中的一项操作在服务器端代码运行 2 分钟时导致 HTTP 502 错误。失败的请求跟踪确认这是一个超时错误 (502 3)。我们尝试在 httpRuntime 元素上增加 executionTimeout 无济于事。我们相信代码会执行一些 sql 查询然后遍历数据 - 现在我们只想增加超时，以便应用程序继续运行 - 任何想法我们需要增加哪个超时设置？@[Application Development] @[Technology Infrastructure] #urgent btw，我们已经在我们的测试环境中复制了这个

# .net - 如何使用 sendgrid 电子邮件发送嵌入的图像？

> ID：15753264
> 
> 赞同：10
> 
> 时间：2013-04-01T22:49:08.490
> 
> 标签：.net, email, sendgrid

我从 SendGrid 开始发送我的电子邮件，但我找不到如何嵌入图像。在不使用 SendGrid 的情况下，我使用以下代码发送带有嵌入图像的电子邮件：

```
var mail = new System.Net.Mail.MailMessage();
mail.Subject = "Warning";
mail.From = "from_user@test.com";
mail.To.Add("to_user@test.com");
mail.IsBodyHtml = true;
mail.Body = "<html><body><a href='http://www.mywebsite.com' title='My Website'><img src='cid:my_image' alt='My Image' border='0' /></a><br /><h1>My E-mail Title</h1>E-mail content.</body></html>";
var av = AlternateView.CreateAlternateViewFromString(mail.Body, null, "text/html");
av.LinkedResources.Add(new LinkedResource(@"C:\my_image.png", "image/png"){ContentId="my_image"});
mail.AlternateViews.Add(av);
var smtp = new SmtpClient("smtp.test.com");
smtp.Credentials = new NetworkCredential("user", "pass");
smtp.Send(mail); 
```

--- 已编辑 ---

现在我正在使用以下代码发送我的电子邮件（使用 SendGrid 类）。

```
var message = SendGrid.GetInstance();
message.Subject = "Warning";
message.From = new MailAddress("from_user@test.com");
message.To = new MailAddress[] { new MailAddress("to_user@test.com") };
message.Html = "<html><body><a href='http://www.mywebsite.com' title='My Website'><img src='cid:my_image' alt='My Image' border='0' /></a><br /><h1>My E-mail Title</h1>E-mail content.</body></html>";
var transportSMTP = SMTP.GetInstance(new NetworkCredential("user", "pass"));
transportSMTP.Deliver(message); 
```

我需要知道的是如何使用其内容 ID (CID) 在电子邮件中嵌入和链接我的图像。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-07-08T18:06:03.047

我也玩弄了一点。解决方案是先附加图像，然后在电子邮件中使用文件的直接名称嵌入。

```
var myMessage = new SendGridMessage();
myMessage.AddTo("to@email.com");
myMessage.From = "from@email.com";
myMessage.Subject ="Forgotten Password";
string body = @"<div><img src='cid:email_reset' alt='Email Reset Header' border='0' /></div>" +
              @"<p>Content...</p>";

string att = Request.PhysicalApplicationPath + @"Content\files\images\email_reset.jpg";
var attachment = new Attachment(att, new ContentType("image/jpeg"));
var linkedResource = new LinkedResource(att, new ContentType("image/jpeg"));
myMessage.AddAttachment(attachment.ContentStream, attachment.Name);
myMessage.EmbedImage(attachment.Name, "email_reset");

myMessage.Text = WebUtility.HtmlDecode(Regex.Replace(body, "<[^>]*(>|$)", string.Empty));
myMessage.Html = body;

// Authenticate and Send the email 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-27T20:44:13.370

对于正在努力通过 SendGrid 发送电子邮件中的嵌入图像并使用存储的模板的任何人，它的工作原理如下：

```
/* In my case the images reside in the SQL DB as BLOBs but for this example it does not matter.
All you need is an array of bytes with your image.
*/
var imageContent = File.ReadAllBytes("Images\\logo_eml.jpg");
using (MemoryStream s = new MemoryStream(imageContent))
{
    ContentType ctype = new ContentType("image/jpg");
    var attachment = new System.Net.Mail.Attachment(s, ctype);
    var linkedResource = new LinkedResource(s, ctype);
    attachment.Name = "cibc_ins_logo_eml.jpg";
    emailMsg.AddAttachment(attachment.ContentStream, attachment.Name);
    emailMsg.EmbedImage(attachment.Name, linkedResource.ContentId + ".jpg");

    values.Add("%embedLogo%", linkedResource.ContentId + ".jpg");
}

string templateJSON = "{\"to\": [\"%to%\"],\r \"sub\": {\":name\": [\"%name%\"],\":embedLogo\": [\"%embedLogo%\"]},\r \"category\": [\"Quotes\"],\r \"filters\": {\"templates\": {\"settings\": {\"enable\": 1,\"template_id\": \"%templateid%\"}}}}"
emailMsg.Headers.Add("x-smtpapi", SubstituteTemplate(templateJSON, values)); 
```

最后一行将替换这些值。就我而言，它只是进行正则表达式替换。此代码必须注意将`%embedLogo%`您的特定 JSON 中的值替换为`linkedResource.ContentId+".jpg"`先前存储在`values`which is a中的值`Dictionary<string,string>`。

这是您在存储的 HTML 模板中需要的内容：

```
<img width="227" height="86" src="cid::embedLogo"> 
```

CID 和两个冒号很关键。

然后 Gmail 将显示嵌入的图像，而不仅仅是附加的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-23T23:07:04.960

我与一位 SendGrid 客户支持工程师交谈，他指导我到这里..

[https://github.com/sendgrid/sendgrid-csharp/blob/ca91fad22dfec2cd1219267fe979c1d9a33a522e/SendGrid/SendGridMail/SendGrid.cs#L211](https://github.com/sendgrid/sendgrid-csharp/blob/ca91fad22dfec2cd1219267fe979c1d9a33a522e/SendGrid/SendGridMail/SendGrid.cs#L211)

所以你的代码将是......

```
var message = SendGrid.GetInstance();
message.Subject = "Warning";
message.From = new MailAddress("from_user@test.com");
message.To = new MailAddress[] { new MailAddress("to_user@test.com") };
message.Html = "<html><body><a href='http://www.mywebsite.com' title='My Website'><img src='cid:my_image' alt='My Image' border='0' /></a><br /><h1>My E-mail Title</h1>E-mail content.</body></html>";

// added    
message.EmbedImage(@"C:\my_image.png","my_image");
// added

var transportSMTP = SMTP.GetInstance(new NetworkCredential("user", "pass"));
transportSMTP.Deliver(message); 
```

我正在寻找一种添加 MemoryStream 对象而不是文件名的方法，它看起来似乎还没有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-28T19:03:25.460

对于任何寻找更简单的东西的人，您可以在 Base64 中对图像文件进行编码，然后将其作为字符串直接嵌入到电子邮件的 html 正文中，它对我有用，因为我只想在电子邮件签名中包含一个小徽标：

```
<img alt="My Image" src="data:image/jpeg;base64,/9j/4S/+RXhpZgAATU0AKgAAAAgACAESAAMAENkDZ5u8/61a+X...more encoding" /> 
```

# jquery - jquery css显示块

> ID：15753267
> 
> 赞同：-1
> 
> 时间：2013-04-01T22:49:26.823
> 
> 标签：jquery, menu, hover

我试图有一个简单的内联菜单，当某个元素悬停时，下面的一行会出现提供子菜单。不幸的是，我无法在悬停时显示子菜单。我在查询中的 CSS 和显示块中没有显示，想知道 CSS 是否以某种方式覆盖它？

CSS

```
ul.main_menu  {
    list-style-type: none;
    text-align: center;
}
ul.main_menu li  {
    margin-left: 20px;
    display: inline;
}
ul.main_menu li a  {
    text-decoration: none;
    color: white;
}
.submenu  {
    height: 20px;
    width: 100%;
}
#services_menu  {
    display: none;
    margin-top: 10px;
}
#services_menu ul {
    list-style-type: none;
    text-align: center;
}
#services_menu ul li  {
    margin-left: 20px;
    display: inline;
}
#service_menu ul li a  {
    text-decoration: none;
    color: white;
} 
```

查询

```
$("#servicebutton").hover(
  function () {
    $('#services_menu').css("display","block");
  }, 
  function () {
    $('#services_menu').css("display","none");
  }); 
```

HTML

```
<ul class="main_menu">
  <li id="homebutton"> <a href="#">Home </a></li>
  <li id="servicebutton"> <a href="#" >Services </a></li>
  <li id="packagebutton"> <a href="#" >Packages </a></li>
  <li id="spabutton"> <a href="#">The spa </a></li>
  <li id="productbutton"> <a href="#">Product </a></li>
  <li id="mebutton"> <a href="#">About Me </a></li>
  <li id="contactbutton"> <a href="#">Contact </a></li>
              <div class="submenu">
              <div id="services_menu">
              <ul>
                <li>Services1</li>
                <li>Services2</li>
                <li>Services3</li>
                <li>Services4</li>
                <li>Services5</li>
              </ul>
              </div>
              </div>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:51:00.867

为什么不使用 jQuery`hide()`和`show()`函数？

```
$('#services_menu').hide();
$('#services_menu').show(); 
```

这些功能会为您服务，`display: block`甚至`display: none`可以`display: inline`在需要时进行检测。

编辑：正如@undefined 在下面的评论中指出的那样，您可能还缺少文档就绪处理程序。总而言之，您的代码应如下所示：

```
$(document).ready(function () {
    $("#servicebutton").hover(
        function () {
            $('#services_menu').show();
        }, 
        function () {
            $('#services_menu').hide();
        }
    );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:59:20.700

## [演示](http://jsfiddle.net/mohammadAdil/7VpyY/3/)

您的代码似乎工作正常。

尝试`ready`像这样包装你的脚本

```
 $(document).ready(function(){
     $("#servicebutton").hover(
       function () {
        $('#services_menu').css("display","block");
       }, 
       function () {
         $('#services_menu').css("display","none");
       });
   }); 
```

# android - 以最佳编码风格（最少重复）向 Android 的 Activity（父类）和 FragmentActivity（子类）添加功能

> ID：15753269
> 
> 赞同：3
> 
> 时间：2013-04-01T22:49:44.060
> 
> 标签：android, inheritance, coding-style, android-activity, android-fragmentactivity

在 Android 库中，[FragmentActivity](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)扩展[了 Activity](http://developer.android.com/reference/android/app/Activity.html)。我想添加一些方法，并覆盖原始[Activity](http://developer.android.com/reference/android/app/Activity.html)的一些方法。

```
import android.app.Activity

public class Activiti extends Activity {
    public void myNewMethod() { ... }
} 
```

由于原始层次结构，[FragmentActivity](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)扩展了[Activity](http://developer.android.com/reference/android/app/Activity.html)，`myNewMethod()`也应该出现在我的库中`FragmentActiviti`

```
import android.support.v4.app.FragmentActivity;

public abstract class FragmentActiviti extends FragmentActivity {
    public void myNewMethod() { ... }
} 
```

但这会导致**代码重复**，我不希望这种情况发生。**有没有办法避免这种重复？**

* * *

### 编辑：使用场景

**Activiti.java**

```
public abstract class Activiti extends Activity {
    private int current_orientation = Configuration.ORIENTATION_UNDEFINED;  // ORIENTATION_UNDEFINED = 0

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        current_orientation = this.getResources().getConfiguration().orientation;
    }
    protected boolean isDevicePortrait() { return current_orientation == Configuration.ORIENTATION_PORTRAIT; }
} 
```

**FragmentActiviti.java**

```
public abstract class FragmentActiviti extends FragmentActivity {
    /* This onCreate() can be omitted. Just putting here explicitly. */
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    protected void someUtilsForFragments() { /* not used yet */ }
} 
```

**E_fragtest_06.java**

```
public class E_fragtest_06 extends FragmentActiviti {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        System.out.printf(isDevicePortrait());      // this NOT WORK for now
    }
} 
```

* * *

### 编辑 2：尝试使用 Util 类

我认为使用[装饰器类](http://en.wikipedia.org/wiki/Decorator_pattern)将是解决这个问题的最好方法（不重复代码）。但是[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)在 Android Activity 场景中应用有点困难（或不可能）。

我尝试实施@hazzik 的方法，但我仍然遇到一些问题。

**ActivityUtil.java**

```
public abstract class ActivityUtil {
    private int current_orientation = Configuration.ORIENTATION_UNDEFINED;  // ORIENTATION_UNDEFINED = 0

    public void onCreate(Activity activity, Bundle savedInstanceState) {
        activity.onCreate(savedInstanceState);
        current_orientation = activity.getResources().getConfiguration().orientation;
    }
    public boolean isDevicePortrait() { return current_orientation == Configuration.ORIENTATION_PORTRAIT; }
} 
```

**Activiti.java**

```
public class Activiti extends Activity {
    private ActivityUtil activityUtil;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        activityUtil.onCreate(this, savedInstanceState);
    }
    protected boolean isDevicePortrait() { return activityUtil.isDevicePortrait(); }
} 
```

**FragmentActiviti.java**

```
public abstract class FragmentActiviti extends FragmentActivity {
    private ActivityUtil activityUtil;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        activityUtil.onCreate(this, savedInstanceState);
    }
    protected boolean isDevicePortrait() { return activityUtil.isDevicePortrait(); }
} 
```

在`ActivityUtil.onCreate()`，`activity.onCreate(savedInstanceState);`导致此编译错误：

> Activity 类型的 onCreate(Bundle) 方法不可见。

如果我更改`Activity`为`Activiti`：

```
public abstract class ActivityUtil {
    public void onCreate(Activiti activity, Bundle savedInstanceState) { ... }
    ...
} 
```

这将导致`FragmentActiviti.onCreate()`'s中的另一个编译错误`activityUtil.onCreate()`：

> ActivityUtil 类型中的 onCreate(Activiti, Bundle) 方法不适用于参数 (FragmentActiviti, Bundle)

我理解为什么会发生这些错误。但我只是不知道如何避免它们。

* * *

感谢所有为这个问题做出贡献的人，特别是 @flup 指导我了解[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)，@hazzik 和 @donramos 的广泛努力，我在这里发布

# 我的增强型 Android`Activity`和`FragmentActivity`课程。

如果您也在开发 Android 应用程序，我希望我的代码可以在某些方面帮助你们:-)

**ActivityCore.java**

```
package xxx.android;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.res.Configuration;
import android.os.Bundle;

public final class ActivityCore {
    public interface ActivityCallbackInterface {
        public void onCreateCallback(Bundle savedInstanceState);
        public void onBeforeSaveInstanceState(Bundle outState);
        public void onSaveInstanceStateCallback(Bundle outState);
    }

    private final Activity activity;
    /**
     * This current_orientation variable should be once set, never changed during the object life-cycle.
     * But Activity.getResources() is not yet ready upon the object constructs.
     * That's why THIS CLASS is wholly responsible to maintain THIS VARIABLE UNCHANGED.
     */
    private int current_orientation = Configuration.ORIENTATION_UNDEFINED;  // ORIENTATION_UNDEFINED = 0

    public ActivityCore(Activity activity) { this.activity = activity; }

    public void onCreate(Bundle savedInstanceState) {
        ((ActivityCallbackInterface) activity).onCreateCallback(savedInstanceState);
        current_orientation = activity.getResources().getConfiguration().orientation;
    }

    public void onSaveInstanceState(Bundle outState) {
        /**
         * THIS is the best ever place i have found, to unload unwanted Fragments,
         * thus prevent re-creating of un-needed Fragments in the next state of Activity.
         *   (state e.g. Portrait-to-Landscape, or Landscape-to-Portrait)
         * 
         * The KEY is to do it BEFORE super.onSaveInstanceState()
         *   (my guess for this reason is, in super.onSaveInstanceState(),
         *    it saves the layout hierarchy, thus saved the Fragments into the Bundle also.
         *    Thus restored.
         *    Note that Fragments NOT IN LAYOUT, having ONLY TAGS, are also restored.)
         */
        ((ActivityCallbackInterface) activity).onBeforeSaveInstanceState(outState);
        ((ActivityCallbackInterface) activity).onSaveInstanceStateCallback(outState);
    }

    public int getCurrentOrientation() { return current_orientation; }

    public boolean isDevicePortrait() { return current_orientation == Configuration.ORIENTATION_PORTRAIT; }
    public boolean isDeviceLandscape() { return current_orientation == Configuration.ORIENTATION_LANDSCAPE; }
    public boolean isNewDevicePortrait() { return activity.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT; }
    public boolean isNewDeviceLandscape() { return activity.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE; }
    public boolean isPortrait2Landscape() { return isDevicePortrait() && isNewDeviceLandscape(); }
    public boolean isLandscape2Portrait() { return isDeviceLandscape() && isNewDevicePortrait(); }

    public String describeCurrentOrientation() { return describeOrientation(current_orientation); }
    public String getCurrentOrientationTag() { return getOrientationTag(current_orientation); }
    public String describeNewOrientation() { return describeOrientation(activity.getResources().getConfiguration().orientation); }
    public String getNewOrientationTag() { return getOrientationTag(activity.getResources().getConfiguration().orientation); }
    private String describeOrientation(final int orientation) {
        switch (orientation) {
            case Configuration.ORIENTATION_UNDEFINED: return "ORIENTATION_UNDEFINED";   // 0
            case Configuration.ORIENTATION_PORTRAIT: return "ORIENTATION_PORTRAIT";     // 1
            case Configuration.ORIENTATION_LANDSCAPE: return "ORIENTATION_LANDSCAPE";   // 2
            case Configuration.ORIENTATION_SQUARE: return "ORIENTATION_SQUARE";         // 3
            default: return null;
        }
    }
    @SuppressLint("DefaultLocale")
    private String getOrientationTag(final int orientation) {
        return String.format("[%d:%s]", orientation, describeOrientation(orientation).substring(12, 16).toLowerCase());
    }
} 
```

**活动.java**

```
package xxx.android.app;

import xxx.android.ActivityCore;
import xxx.android.ActivityCore.ActivityCallbackInterface;
import android.os.Bundle;

public abstract class Activity extends android.app.Activity implements ActivityCallbackInterface {
    private final ActivityCore activityCore;

    public Activity() { super(); activityCore = new ActivityCore(this); }

    @Override
    protected void onCreate(Bundle savedInstanceState) { activityCore.onCreate(savedInstanceState); }
    @Override public void onCreateCallback(Bundle savedInstanceState) { super.onCreate(savedInstanceState); }

    @Override
    public void onBeforeSaveInstanceState(Bundle outState) {}       // Optionally: let child class override
    @Override
    protected void onSaveInstanceState(Bundle outState) { activityCore.onSaveInstanceState(outState); }
    @Override public void onSaveInstanceStateCallback(Bundle outState) { super.onSaveInstanceState(outState); }

    public final int getCurrentOrientation() { return activityCore.getCurrentOrientation(); }

    public final boolean isDevicePortrait() { return activityCore.isDevicePortrait(); }
    public final boolean isDeviceLandscape() { return activityCore.isDeviceLandscape(); }
    public final boolean isNewDevicePortrait() { return activityCore.isNewDevicePortrait(); }
    public final boolean isNewDeviceLandscape() { return activityCore.isNewDeviceLandscape(); }
    public final boolean isPortrait2Landscape() { return activityCore.isPortrait2Landscape(); }
    public final boolean isLandscape2Portrait() { return activityCore.isLandscape2Portrait(); }

    public final String describeCurrentOrientation() { return activityCore.describeCurrentOrientation(); }
    public final String getCurrentOrientationTag() { return activityCore.getCurrentOrientationTag(); }
    public final String describeNewOrientation() { return activityCore.describeNewOrientation(); }
    public final String getNewOrientationTag() { return activityCore.getNewOrientationTag(); }
} 
```

**片段活动.java**

```
package xxx.android.support.v4.app;

import xxx.android.ActivityCore;
import xxx.android.ActivityCore.ActivityCallbackInterface;
import android.os.Bundle;

public abstract class FragmentActivity extends android.support.v4.app.FragmentActivity implements ActivityCallbackInterface {
    private final ActivityCore activityCore;

    public FragmentActivity() { super(); activityCore = new ActivityCore(this); }

    @Override
    protected void onCreate(Bundle savedInstanceState) { activityCore.onCreate(savedInstanceState); }
    @Override public void onCreateCallback(Bundle savedInstanceState) { super.onCreate(savedInstanceState); }

    @Override
    public void onBeforeSaveInstanceState(Bundle outState) {}       // Optionally: let child class override
    @Override
    protected void onSaveInstanceState(Bundle outState) { activityCore.onSaveInstanceState(outState); }
    @Override public void onSaveInstanceStateCallback(Bundle outState) { super.onSaveInstanceState(outState); }

    public final int getCurrentOrientation() { return activityCore.getCurrentOrientation(); }

    public final boolean isDevicePortrait() { return activityCore.isDevicePortrait(); }
    public final boolean isDeviceLandscape() { return activityCore.isDeviceLandscape(); }
    public final boolean isNewDevicePortrait() { return activityCore.isNewDevicePortrait(); }
    public final boolean isNewDeviceLandscape() { return activityCore.isNewDeviceLandscape(); }
    public final boolean isPortrait2Landscape() { return activityCore.isPortrait2Landscape(); }
    public final boolean isLandscape2Portrait() { return activityCore.isLandscape2Portrait(); }

    public final String describeCurrentOrientation() { return activityCore.describeCurrentOrientation(); }
    public final String getCurrentOrientationTag() { return activityCore.getCurrentOrientationTag(); }
    public final String describeNewOrientation() { return activityCore.describeNewOrientation(); }
    public final String getNewOrientationTag() { return activityCore.getNewOrientationTag(); }
} 
```

最后，我真的要感谢你们如此乐于助人，并不断与我一起更新解决进度！你们都是使 stackoverflow 成为程序员的完美网站的关键人物。如果您在我的代码中发现任何问题，或者有任何改进空间，请不要犹豫再次帮助我 :-)

## ~~一些改进？~~

~~因为`onBeforeSaveInstanceState()`是在使用时实现的，所以这三个类都需要保留`abstract`。这会导致成员变量的重复`current_orientation`。如果`current_orientation`可以放入`class ActivityBase`，或将其分组到其他地方，那就更好了！~~

*愚蠢的我。我已经修好了:-)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:04:10.823

在我看来，这里最好的解决方案是将逻辑委托给某个类，我们称之为`CustomActivityLogic`.

`CustomActivity`如果您想从逻辑类访问活动类的某些数据或方法，您还需要为活动创建通用接口 ( )。

要调用受保护的虚拟覆盖方法，有两种解决方案：

*   从重写的方法调用晚餐的方法
*   在子类中创建一个新方法并从这个新方法调用超级方法。从共享逻辑调用新方法。

**CustomActivity.java**

```
public interface CustomActivity {
    void someMethod();
} 
```

**Activiti.java**

```
import android.app.Activity

public class Activiti 
    extends Activity 
    implements CustomActivity {

    private CustomActivityLogic logic = new CustomActivityLogic();

    public void someMethod() { /***/ }

    public void myNewMethod() { logic.myNewMethod(this); }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        logic.onCreate(this, savedInstanceState); // call shared logic
        super.onCreate(savedInstanceState); // call super
    }
} 
```

**FragmentActivitii.java**

```
import android.support.v4.app.FragmentActivity;

public class FragmentActivitii 
    extends FragmentActivity 
    implements CustomActivity {

    private CustomActivityLogic logic = new CustomActivityLogic();

    public void someMethod() { /***/ }

    public void myNewMethod() { logic.myNewMethod(this); }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        logic.onCreate(this, savedInstanceState); // call shared logic
        super.onCreate(savedInstanceState); // call super
    }
} 
```

**CustomActivityLogic.java**

```
 public class CustomActivityLogic {
     public void myNewMethod(CustomActivity activity) { /*...*/ }
     public void onCreate(Activity activity, Bundle savedInstanceState) { 
         /* shared creation logic */
     }
 } 
```

**使 onCreate 可通过`CustomActivity`接口从外部调用的方法**

**CustomActivity.java**

```
public interface CustomActivity {
    void someMethod();
    void onCreateSuper(Bundle savedInstanceState);
} 
```

**Activiti.java**

```
import android.app.Activity

public class Activiti 
    extends Activity 
    implements CustomActivity {

    private CustomActivityLogic logic = new CustomActivityLogic();

    public void someMethod() { /***/ }

    public void myNewMethod() { logic.myNewMethod(this); }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        logic.onCreate(this, savedInstanceState); // call shared logic
    }

    public void onCreateSuper(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState); // call super
    }
} 
```

**FragmentActivitii.java**

```
import android.support.v4.app.FragmentActivity;

public class FragmentActivitii 
    extends FragmentActivity 
    implements CustomActivity {

    private CustomActivityLogic logic = new CustomActivityLogic();

    public void someMethod() { /***/ }

    public void myNewMethod() { logic.myNewMethod(this); }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        logic.onCreate(this, savedInstanceState); // call shared logic
    }

    public void onCreateSuper(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState); // call super
    }
} 
```

**CustomActivityLogic.java**

```
 public class CustomActivityLogic {
     public void myNewMethod(CustomActivity activity) { /*...*/ }
     public void onCreate(CustomActivity activity, Bundle savedInstanceState) { 
         /* shared creation logic */
         activity.onCreateSuper(savedInstanceState); // call-back super
     }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T21:38:55.587

您希望添加帮助跟踪方向的辅助方法。我认为这还不足以保证创建子类。

把它们放在一个辅助类中：

```
public class OrientationHelper {
    private Activity activity;
    private int current_orientation;

    public OrientationHelper(Activity activity){
        this.activity = activity;
        orientation = Configuration.ORIENTATION_UNDEFINED;
    }

    public int getNewOrientation() { 
        return activity.getResources().getConfiguration().orientation;
    }

    // call this when you wish to update current_orientation
    public void updateOrientation() {
        current_orientation = getNewOrientation();
    }

    public int getCurrentOrientation() { 
        return current_orientation; 
    }

    public boolean isDevicePortrait() { 
        return current_orientation == Configuration.ORIENTATION_PORTRAIT; 
    }

    public boolean isDeviceLandscape() { 
        return current_orientation == Configuration.ORIENTATION_LANDSCAPE; 
    }

    public boolean isNewDevicePortrait() { 
        return getCurrentOrientation() == Configuration.ORIENTATION_PORTRAIT; 
    }

    public boolean isNewDeviceLandscape() { 
        return getCurrentOrientation() == Configuration.ORIENTATION_LANDSCAPE; 
    }

    public boolean isPortrait2Landscape() { 
        return isDevicePortrait() && isNewDeviceLandscape(); 
    }

    public boolean isLandscape2Portrait() { 
        return isDeviceLandscape() && isNewDevicePortrait(); 
    }

    public String describeCurrentOrientation() { 
        return describeOrientation(current_orientation); 
    }

    public String describeNewOrientation() { 
        return describeOrientation(getNewOrientation());
    }

    private String describeOrientation(int current_orientation) {
        switch (current_orientation) {
            case Configuration.ORIENTATION_UNDEFINED: 
                return "ORIENTATION_UNDEFINED";
            case Configuration.ORIENTATION_PORTRAIT: 
                return "ORIENTATION_PORTRAIT";
            case Configuration.ORIENTATION_LANDSCAPE: 
                return "ORIENTATION_LANDSCAPE";
            case Configuration.ORIENTATION_SQUARE: 
                return "ORIENTATION_SQUARE";
            default: return null;
        }
    }
} 
```

在那些使用方向的活动中（并且只有那些），您可以实例化 OrientationHelper 并在选定的位置调用 updateOrientation()。

另一段代码，用于组织实例状态的保存，我不会将其放入不同的类中，以便您可以重用它。因为这不是人们期望对状态保存进行修改的地方，因此它可能会被忽略。（我花了一点时间滚动来弄清楚它应该做什么。）

我认为最易读的方法是在你使用它的每个活动中明确地写出来。

最后要考虑的一件事是 Sherlock Actionbar 已经扩展了 Activity。我认为这是正确的。但这意味着如果你也扩展 Activity，你偶尔会遇到麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:05:51.237

如何使用`Decorator Pattern`？不幸的是，这将要求您委托所有现有的方法，或者为您的目的所必需的任何方法。

```
public class ActivityDecorator extends Activity 
{
    private Activity RealActivity;
    public ActivityDecorator(Activity _realActivity)
    {
        RealActivity = _realActivity;
    }

    public void myNewMethod() { ... }  // this exposes the added/new functionality

    // unfortunately for old functionality you need to delegate
    public void oldMethod() { RealActivity.oldMethod(); }
} 
```

但是，一旦您为`ActivityProxy`该类完成了一次，您就可以构造`ActivityDecorator`具有派生类型的实例，`Activity`例如`FragmentActivity`在您的情况下。例如

```
ActivityDecorator decorator = new ActivityDecorator(new FragmentActivity()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T00:57:33.953

您的设计问题是即将到来的 Java 8 虚拟扩展解决的问题之一。有关更多详细信息，请参见下面的 URL：

[http://java.dzone.com/articles/java-8-virtual-extension](http://java.dzone.com/articles/java-8-virtual-extension)

与此同时，没有简单的方法。装饰器类将不起作用，而是实现一个实用程序类，您的两个类都将调用它：

**根据新信息编辑：**

```
/** NOTE: cannot be abstract class **/
public class ActivitiBase {
   private int current_orientation = Configuration.ORIENTATION_UNDEFINED;  // ORIENTATION_UNDEFINED = 0

    private Activity activity;
    public void ActivitiBase(Activity activity) {
        this.activity = activity;
    }

   public void onCreate(Bundle savedInstanceState) {
      current_orientation = activity.getResources().getConfiguration().orientation;
   }

   public boolean isDevicePortrait() { return current_orientation == 
                      Configuration.ORIENTATION_PORTRAIT; }
   }    

   public void myNewMethod() { ... }
} 
```

活动课：

```
public class Activiti extends Activity {
    private ActiviBase activitiBase;

    public Activiti() {
       activitiBase = new ActiviBase(this);
    }

    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      activitiBase.onCreate(savedInstanceState);
    }

    public void myNewMethod() { 
       activitiBase.myNewMethod();
    }
} 
```

FrameActiviti 类：

```
public class FrameActiviti extends FrameActivity {
    private ActiviBase activitiBase;

    public FrameActiviti() {
       activitiBase = new ActiviBase(this);
    }

    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      activitiBase.onCreate(savedInstanceState);
    }

    public void myNewMethod() { 
       activitiBase.myNewMethod();
    }
} 
```

# opengl - 世界到本地坐标

> ID：15753270
> 
> 赞同：-1
> 
> 时间：2013-04-01T22:49:44.193
> 
> 标签：opengl, graphics, opengl-es, game-physics

我正在使用光线拾取，现在有了世界矩阵中的坐标。如何将其转换为我的对象本地坐标？

也许将对象的本地坐标转换为世界坐标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T07:41:30.933

你的问题不清楚。你说你使用光线拾取，当你选择图像中像素的位置并从点屏幕空间坐标计算世界点坐标时，我会阅读/理解它，最后你想在对象空间坐标中得到这个点吗？

通常，大多数 3D 对象都应用 4x4 矩阵变换以在空间中进行变换（缩放、旋转、移动）。当您的对象没有应用此变换时，它被称为处于绑定姿势或对象空间。当矩阵 M 应用于对象时，所得到的变换对象被称为在世界空间中。如果您有矩阵 M（您知道用于将对象从对象空间转换到世界空间的矩阵）并且您已经能够在世界空间中的对象上选择一个点（例如它的一个顶点）并且想知道该点在对象空间中的位置是什么，那么您需要做的就是将矩阵逆 M-1 应用于该点坐标（其中 M 再次是从对象到世界空间的矩阵）。

从技术上讲，要使其正常工作，您需要了解：

*   应用于您的对象的对象到世界矩阵是什么，您知道吗，您可以访问它吗？让我们称这个矩阵M，
*   你需要从这个矩阵 M 计算矩阵逆 M-1，你知道怎么做吗？
*   一旦你有 M-1，那么只需做一个简单的点矩阵乘法：Pobject = Pworld * M-1。

如果您对矩阵和矩阵变换还不熟悉或不熟悉，我强烈建议您阅读 www.scratchapixel.com，尤其是关于矩阵的课程（第 4 课）。

矩阵课：[http ://scratchapixel.com/lessons/3d-basic-lessons/lesson-4-geometry/](http://scratchapixel.com/lessons/3d-basic-lessons/lesson-4-geometry/)

计算矩阵逆的课程：[http ://www.scratchapixel.com/lessons/3d-advanced-lessons/matrix-inverse-row-reduction/](http://www.scratchapixel.com/lessons/3d-advanced-lessons/matrix-inverse-row-reduction/)

# delphi - 从十进制数中获取分数

> ID：15753273
> 
> 赞同：2
> 
> 时间：2013-04-01T22:50:16.003
> 
> 标签：delphi, math

我正在开发一个解决方程组的程序。当它给我结果时，它就像：“x1 = 1,36842”。我想得到那个“1,36842”的分数，所以我写了这段代码。

```
procedure TForm1.Button1Click(Sender: TObject);
var numero,s:string;
    a,intpart,fracpart,frazfatta:double;
    y,i,mcd,x,nume,denomin,R:integer;
begin
 a:=StrToFloat(Edit1.Text);  //get the value of a
 IntPart := Trunc(a);        // here I get the numerator and the denominator
 FracPart := a-Trunc(a);
 Edit2.Text:=FloatToStr(FracPart);
 numero:='1';
 for i:= 1 to (length(Edit2.Text)-2) do
 begin
  numero:=numero+'0';
 end;                       //in this loop it creates a string that has many 0 as the length of the denominator
 Edit3.text:=FloatToStr(IntPart);
 y:=StrToInt(numero);
 x:=StrToInt(Edit3.Text);
 while y <> 0 do
 begin
  R:= x mod y;
  x:=y;
  y:=R;
 end;
 mcd:=x;              //at the end of this loop I have the greatest common divisor
 nume:= StrToInt(Edit3.Text) div mcd;
 denomin:= StrToInt(numero) div mcd;
 Memo1.Lines.Add('fraction: '+IntToStr(nume)+'/'+IntToStr(denomin));
end; 
```

它不能正常工作，因为它给我的分数是错误的。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T06:23:46.760

您的代码无法工作，因为您使用的是二进制浮点。并且二进制浮点类型不能表示您试图表示的十进制数。可表示的二进制浮点数的形式为*s2 ^e*，其中*s*是有效数，*e*是指数。因此，例如，您不能将 0.1 表示为二进制浮点值。

最明显的解决方案是使用整数算术执行计算。根本不要调用 StrToFloat。不要碰浮点运算。自己解析输入字符串。找到小数点。使用后面的位数来计算小数刻度。去掉任何前导或尾随零。其余的使用整数算术。

例如，假设输入是`'2.79'`。通过处理文本将其转换为分子和分母变量

```
Numerator := 279;
Denominator := 100; 
```

显然，您必须编写字符串解析例程而不是使用整数文字，但这是例程。

最后，通过求这两个整数的gcd来完成问题。

底线是，要表示和操作十进制数据，您需要十进制算法。这不包括二进制浮点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T02:16:20.463

我建议先定义一个函数 GreaterCommonDivisor 函数（wiki[参考](http://en.wikipedia.org/wiki/Euclidean_algorithm#Implementations)）

这将是类似 Java/C 的代码，因为我不熟悉 Delphi

让

```
float x = inputnum // where inputnum is a float
// eg. x = 123.56 
```

然后，乘

```
int n = 1;
while(decimalpart != 0){// or cast int and check if equal-> (int)x == x
    x = x * 10;
    decimalpart = x % 1;
    // or a function getting the decimal part if the cast does work
    n *= 10;
}

// running eg. x = 123.56 now x = 12356
//             n = 100 
```

那么你现在应该`(float)x/n == inputnum`有`eg. (12356/100 == 123.56)`

这意味着您有一个此时可能无法简化的分数。您现在要做的就是实现和使用 GCD 功能

```
 int gcd = GreaterCommonDivisor(x, n);
 // GreaterCommonDivisor(12356, 100) returns 4
 // therefore for correct implementation gcd = 4
 x /= gcd; // 12356 / 4 = 3089
 n /= gcd; // 100 / 4 = 25 
```

这应该快速简单地实现，但是：

## 主要陷阱：

*   浮动必须终止。例如，0.333333333333333333 的预期值不会四舍五入为 1/3
*   Float * n <= max_int_value，否则会出现溢出，有解决方法，但可能有其他解决方案更适合这些更大的数字

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T19:51:32.787

[连分数](http://en.wikipedia.org/wiki/Continued_fraction)可用于找到对实数的良好有理逼近。这是 JavaScript 中的一个实现，我确信移植到 Delphi 很简单：

```
function float2rat(x) {
    var tolerance = 1.0E-6;
    var h1=1; var h2=0;
    var k1=0; var k2=1;
    var b = x;
    do {
        var a = Math.floor(b);
        var aux = h1; h1 = a*h1+h2; h2 = aux;
        aux = k1; k1 = a*k1+k2; k2 = aux;
        b = 1/(b-a);
    } while (Math.abs(x-h1/k1) > x*tolerance);

    return h1+"/"+k1;
} 
```

例如，1.36842 转换为 26/19。

[您可以在我的博客上](http://jonisalonen.com/2012/converting-decimal-numbers-to-ratios/)找到有关此算法的现场演示和更多信息。

# android - 使用 ActionBarSherlock 实现 HoloEverywhere 错误

> ID：15753275
> 
> 赞同：0
> 
> 时间：2013-04-01T22:50:31.443
> 
> 标签：android, actionbarsherlock, android-holo-everywhere

导入`Sherlock`成功后，我正在实施`HoloEverywhere`.

我面临的唯一问题如下图所示，`android.support.v4.app`编译错误和`pom.xml`错误也是如此。

![在此处输入图像描述](https://i.stack.imgur.com/soA32.png) 即使在 Properties>Android 和 Properties>Java Build Path 中导入库 (Sherlock) 后，这些错误也会出现。

关于这个问题的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T22:52:56.717

删除您的应用程序库文件夹中的 Android 支持库。

# java - LayoutInflater 是如何工作的？

> ID：15753276
> 
> 赞同：1
> 
> 时间：2013-04-01T22:50:36.377
> 
> 标签：java, android, layout, view, layout-inflater

我是 Android 开发的新手，我对 Android 开发社区中流传的短语“Inflate a View”很好奇。

我知道这与调用`LayoutInflater`类的 Inflate 方法有关，但我仍然没有掌握它背后的概念。这基本上意味着通过传递它的 ID 来返回一个视图，就像 JavaScript 的`document.getElementById()`那种东西，还是还有更多？任何形式的启蒙都会受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:56:27.043

它基本上是用于将 xml`Layout`文件实例化为要在 java 代码中使用的对象的术语。您可以通过调用`setContentView(R.layout.file name minus xml extension)`或使用来做到这一点`LayoutInflater`。只有在充气之后才能称其为孩子`Views`。了解这一点很重要，因为我已经看到很多关于 SO 的问题，其中人们的应用程序崩溃了，结果他们试图引用`view`类似的

```
EditText et = (EditText) findViewById(R.id.someID); 
```

并且他们没有调用`setContentView()`来获取`Layout`which 持有`EditText`导致 a 的内容，`NPE`因为直到is`EditText`才实际存在。`Layout``inflated`

我确定您已经看过上面的文档，但[无论如何它们都在这里](http://developer.android.com/reference/android/view/LayoutInflater.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:56:53.803

虽然细节肯定比我要说的更复杂，但我认为考虑膨胀视图的最简单方法是从 xml 布局文件到实际`View`对象的过程。充斥在许多不同类中的膨胀方法通常都采用一个`id`参数，您可以将其设置为`R.layout.xxx`.

# c# - 尝试使用 ksp/unity3d 二进制文件时出现问题？

> ID：15753277
> 
> 赞同：9
> 
> 时间：2013-04-01T22:50:36.653
> 
> 标签：c#, .net, unity3d

我正在尝试使用 kerbal 空间程序 (ksp) 二进制文件来读取其中一个 ksp 零件模型，我在引用下添加了 ksp 二进制文件和 UnityEngine.dll 然后我正在执行以下操作：

```
Planet p = new Planet(); 
```

运行它会给我以下安全异常：

ECall 方法必须打包到系统模块中。

我可以绕过或解决这个问题吗？

编辑：

我发现它不是来自 ksp dll，而是来自 untiy 的，他们使用：

```
 [WrapperlessIcall ]
    [MethodImpl (MethodImplOptions.InternalCall)]
    public extern void StopAllCoroutines (); 
```

我需要一种方法来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T21:54:19.340

`MethodImplOptions.InternalCall`仅表示`StopAllCoroutines`直接在 CLR 而不是 BCL（或其他一些库）中实现。这是[MSDN](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx)。

至于修改 Unity3D 不调用这个，你将无法绕过它。

# php - 具有多个规则的密码验证

> ID：15753279
> 
> 赞同：1
> 
> 时间：2013-04-01T22:50:45.713
> 
> 标签：php, regex, preg-match

我正在尝试在 PHP 中编写一个验证以下内容的正则表达式：

*   至少 10 个字符
*   至少有 2 个大写字符
*   至少有 2 个数字或符号

我几乎查看了我能找到的所有参考资料，但无济于事。

我想我可以单独测试，但这让我很伤心:(

有人可以帮忙吗？（然后把我送到一个我可以用简单的英语 Reg Ex 学习的地方？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T00:26:15.783

## 这张图值1000多字

*（这是很多熵）*

![密码短语和熵](https://i.stack.imgur.com/hcEu6.png)

*（图片来自 XKCD）*

考虑到这一点，如果密码长度高于 X（例如.. 20），您可能需要考虑删除规则 2 和 3，或者将最小值增加到至少 16 个字符（作为唯一规则）。

* * *

至于你的要求：

与拥有一个庞大、丑陋、难以维护的高级正则表达式相反，您可能希望将问题分解为较小的部分，并使用专用函数分别处理每一位。

为此，您可以查看[`ctype_*`函数](http://www.php.net/manual/en/book.ctype.php)、[count_chars()](http://www.php.net/manual/en/function.count-chars.php)和[多字节字符串函数](http://php.net/manual/en/book.mbstring.php)。

* * *

现在丑了：

此高级 RegEx 将返回**`true`**或**`false`**根据您的规则：

```
preg_match('/^(?=.{10,}$)(?=.*?[A-Z].*?[A-Z])(?=.*?([\x20-\x40\x5b-\x60\x7b-\x7e\x80-\xbf]).*?(?1).*?$).*$/',$string); 
```

在这里测试演示：[http ://regex101.com/r/qE9eB2](http://regex101.com/r/qE9eB2)

**第一**部分（LookAhead）：`(?=.{10,}$)`将检查字符串长度，如果它至少有 10 个字符，则继续。您可以放弃它并使用[strlen()](http://www.php.net/manual/en/function.strlen.php)甚至更好**[的 mb_strlen()](http://www.php.net/manual/en/function.mb-strlen.php)**进行检查。

**第二**部分（也是 LookAhead）：`(?=.*?[A-Z].*?[A-Z])`将检查是否存在 2 个大写字符。您也可以`$upper=preg_replace('/[^A-Z]/','',$string)`改为 a 并将字符数计为`$upper`两个以上。

**3rd** LookAhead 使用一个字符类：`[\x20-\x40\x5b-\x60\x7b-\x7e\x80-\xbf]`为常见符号使用十六进制转义字符范围（几乎可以在普通键盘上找到所有符号）。您也可以`$sym=preg_replace('/[^a-zA-Z]/','',$string)`改为 a 并将字符数计为`$sym`两个以上。*注意：为了缩短我使用递归组`(?1)`不再重复相同的字符类*

对于学习，我所知道的最全面的 RegExp 参考是：[regular-expressions.info](http://www.regular-expressions.info/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:54:20.810

您可以使用前瞻来确保正确包含您要查找的内容。

```
/(?=.*[A-Z].*[A-Z])(?=.*[^a-zA-Z].*[^a-zA-Z]).{10,}/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T01:11:26.223

我一直喜欢用好的旧程序代码来处理这样的事情。正则表达式可能很有用，但它们也可能有点麻烦，特别是对于代码维护和快速扫描（正则表达式并不完全是可读性的例子）。

```
function strContains($string, $contains, $n = 1, $exact = false) {
    $length = strlen($string);
    $tally  = 0;
    for ($i = 0; $i < $length; $i++) {
        if (strpos($contains, $string[$i]) !== false) {
            $tally++;
        }
    }
    return ($exact ? $tally == $n : $tally >= $n);
}
function validPassword($password) {
    if (strlen($password) < 10) {
        return false;
    }
    $upperChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    $upperCount = 2;
    if (strContains($password, $upperChars, $upperCount) === false) {
        return false;
    }
    $numSymChars = '0123456789!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~';
    $numSymCount = 2;
    if (strContains($password, $numSymChars, $numSymCount) === false) {
        return false;
    }
    return true;
} 
```

# android - Robolectric + SQLiteStatement.executeUpdateDelete() 不执行任何操作

> ID：15753281
> 
> 赞同：1
> 
> 时间：2013-04-01T22:51:00.310
> 
> 标签：android, sqlite, robolectric

我需要在表中增加一些整数。我不想进行选择和连续更新，而是想通过单个查询来做到这一点。但运气不好。

以下代码返回 0：

```
final SQLiteStatement stmt = helper.getWritableDatabase().
    compileStatement("update my_table set my_count = my_count + 1 where _id = ?");
try
{
    stmt.bindLong(1, id);
    return stmt.executeUpdateDelete();
}
finally
{
    stmt.close();
} 
```

当然，也不会更新任何记录。

但这会返回 1：

```
final ContentValues v = new ContentValues();
v.put("my_count", 1);
return helper.getWritableDatabase().
    update("my_table", v, "_id=?", new String[]{String.valueOf(id)}); 
```

具有指定 id 的记录是 100% 存在的。试图在交易中或没有交易的情况下做到这一点 - 结果是一样的。没有在真正的 SQLiteStatement 上进行测试，可能是 Robolectric 错误。

有人对这种影响有任何假设吗？或有关如何解决此问题的建议（可能不使用`SQLiteStatement`）？

谢谢。

**更新 1。**

我还进行了一些简单的测试：

```
@RunWith(RobolectricTestRunner.class)
public class SQLiteStatementTest
{

    private static class TestOpenHelper extends SQLiteOpenHelper
    {
        public TestOpenHelper(Context context)
        {
            super(context, "test", null, 1);
        }

        @Override
        public void onCreate(SQLiteDatabase db)
        {
            db.execSQL("CREATE TABLE test(_id INTEGER PRIMARY KEY AUTOINCREMENT, count INTEGER)");
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
        {
        }
    }

    @Test
    public void testExecuteUpdateDeleteModifiesRow() throws Exception
    {
        final int initialCount = 6;
        final TestOpenHelper helper = new TestOpenHelper(Robolectric.application);

        final ContentValues v = new ContentValues();
        v.put("count", initialCount);
        final long id = helper.getWritableDatabase().insert("test", null, v);

        final SQLiteStatement stmt = helper.getWritableDatabase().
            compileStatement("update test set count = count + 1 where _id=?");

        stmt.bindLong(1, id);
        assertThat(stmt.executeUpdateDelete(), is(1));

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T19:09:36.513

根据以下来源：

[https://github.com/pivotal/robolectric/blob/master/src/main/java/org/robolectric/shadows/ShadowSQLiteStatement.java](https://github.com/pivotal/robolectric/blob/master/src/main/java/org/robolectric/shadows/ShadowSQLiteStatement.java)

`executeUpdateDelete()`没有实施。

由于默认情况下`callThroughByDefault = false`此方法被隐藏为*空实现*。这就是我不明白的原因`RuntimeException("Stub!")`。

隐藏这种方法应该很容易，但我在 robolectric 中发现了一个[更普遍的问题](https://stackoverflow.com/questions/15603583/impossible-runtimeexception-stub-with-robolectric/15772227#15772227)（使用方法）`Uri.parse``2.0-alpha-2`

**更新 1。**

将请求拉到影子`executeUpdateDelete()`：
[https ://github.com/pivotal/robolectric/pull/450](https://github.com/pivotal/robolectric/pull/450)
[https://github.com/pivotal/robolectric/pull/451](https://github.com/pivotal/robolectric/pull/451)

# java - 为什么这个简单的线程程序会卡住？

> ID：15753290
> 
> 赞同：3
> 
> 时间：2013-04-01T22:51:43.483
> 
> 标签：java, concurrency, portability, memory-visibility

看一下这个简单的 Java 程序：

```
import java.lang.*;

class A {
    static boolean done;
    public static void main(String args[]) {
        done = false;
        new Thread() {
            public void run() {
            try {
                Thread.sleep(1000); // dummy work load
            } catch (Exception e) {
                done = true;
            }
            done = true;
            }
        }.start();
        while (!done);
        System.out.println("bye");
    }
} 
```

在一台机器上，它打印“再见”并立即退出，而在另一台机器上，它不打印任何东西并永远坐在那里。为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-01T22:55:32.060

这是因为您的`boolean`is not `volatile`，因此`Thread`允许 s 缓存它的副本并且从不更新它们。我会推荐一个`AtomicBoolean`- 这将防止您可能遇到的任何问题。

```
public static void main(String args[]) {
    final AtomicBoolean done = new AtomicBoolean(false);
    new Thread() {
        public void run() {
            done.set(true);
        }
    }.start();
    while (!done.get());
    System.out.println("bye");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:58:03.750

到达主程序的 while 循环（也是一个线程）时，新线程可能正在完成它的 run()，其中 done 标志设置为 true。只是为了确认这一点，您可以在 run() 之前将 done 设置为 true，然后查看您的再见是否也显示在其他机器上。希望这会有所帮助。

# symfony - 如何将数据库中的所有数据显示到twig中？

> ID：15753291
> 
> 赞同：2
> 
> 时间：2013-04-01T22:51:43.690
> 
> 标签：symfony, doctrine, symfony-2.1

**更新：**正如 Gerry 建议的那样，我解决了这个问题，但我无法使用 twig 显示任何内容。我转储变量，这就是我得到的：

```
object(Acme\Bundle\NewBundle\Entity\database)#275 (10) {
 ["id":"Acme\Bundle\NewBundle\Entity\database":private]=> int(2) 
["username":"Acme\Bundle\WebBundle\Entity\database":private]=> string(4) "almighty" 
["password":"Acme\Bundle\NewBundle\Entity\database":private]=> string(7) "blabla" 
["from":"Acme\Bundle\NewBundle\Entity\database":private]=> string(6) "bitola" .... 
```

我尝试过：

```
{{% for i in user %}}
{{i.username}} - username
{{i.password}} - password
{{% endfor %}} 
```

仍然没有运气..变量中有数据，但它是一个对象而不是数组。那么我该如何显示呢？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:55:15.440

您只需要将`find()`方法的结果分配给您的模板。`find()`返回结果对象（如果匹配）。

```
$user = $this->getDoctrine()
    ->getRepository('AcmeNewBundle:database')
    ->find($username);

return $this->render('AcmeNewBundle:Default:hello.html.twig',array('user' => $user)); 
```

如果您的用户对象具有属性用户名，您可以在模板中显示它，如下所示：

```
{{ user.username }} 
```

# c# - 同一服务器上的 WCF 服务之间响应缓慢

> ID：15753297
> 
> 赞同：2
> 
> 时间：2013-04-01T22:52:29.857
> 
> 标签：c#, wcf, enterprise-library

我在我的`UAT`环境中遇到了一个非常奇怪的问题。我有两个`WCF`相互通信的服务。在较高的层次上，我的 Web 应用程序与业务层通信，并从那里将 wcf 请求传递到处理所有请求并返回响应的事务层。我面临的问题是事务层接收业务层发送的请求大约需要 1 分钟。服务部署在`WCF`同一台服务器上，并且此应用程序设置在生产中完美运行，所以我不确定发生了什么......

**示例**：

Web-frontend 向业务层发送 wcf 请求以获取所有广告的列表。业务层执行一些安全检查（我已从示例中删除），然后通过另一个 WCF 请求将请求简单地传递到事务层。但是事务层接收这个请求需要 1 分钟。

**业务层：**

```
 public partial class AdsManagementService : IAdsManagementService
{
    public ListAdvertisementResponse ListAdvertisement(ListAdvertisementRequest request)
    {
        LogManager.Write("Initiated AdsManagement.AdsManagentService.ListAdvertisement()", LogCategory.Trace.ToString());

        var response = new ListAdvertisementResponse();
        response.Advertisements = new List<Advertisement>();

        LogManager.Write("Authentication token validated in AdsManagement.AdsManagentService.ListAdvertisement()", LogCategory.Event.ToString());
        var client = new AdService.AdsManagementServiceClient();

        try
        {
            response = client.ListAdvertisement(request);
            LogManager.Write("response received by AdsManagement.AdsManagentService.ListAdvertisement()", LogCategory.Event.ToString());
        }
        finally
        {
            try
            {
                client.Close();
            }
            catch (Exception ex)
            {
                LogManager.ExceptionHandler(ex);
            }
        }
    }
} 
```

**交易层**

我在每个方法调用的开始/结束处添加了日志跟踪（BEGIN、END），以显示处理该方法需要多长时间。

```
 public ListAdvertisementResponse ListAdvertisement(ListAdvertisementRequest request)
    {
        LogManager.Write("BEGIN - ListAdvertisement", LogCategory.Event);
        var response = new ListAdvertisementResponse();

        try
        {                
            response.Advertisements = new List<AdvertisementType>();

            var ads = AdvertisementDataContextInstance.Advertisements;

            foreach (var ad in ads)
            {
                AdvertisementType advertisement = ConvertToAdvertisementType(ad);

                string filePath = AdFilePath + @"\" + ad.Code;

                if (Directory.Exists(filePath))
                {
                    string[] files = Directory.GetFiles(filePath);

                    foreach (string file in files)
                    {
                        advertisement.Files.Add(file);
                    }
                }

                response.Advertisements.Add(advertisement);
            }
        }
        catch (Exception ex)
        {
            response.ErrorAction = ResponseActionEnum.GeneralException;
            response.ErrorDetails = ex.Message;
            response.ErrorMessage = "Unable to list advertisements.";
        }

        LogManager.Write("END - ListAdvertisement", LogCategory.Event);
        return response;
    } 
```

**业务层日志跟踪**

```
**Timestamp: 2/04/2013 9:23:08 AM**
Thread Name: 
Category: Trace
Severity: Information
Message: Initiated AdsManagement.AdsManagentService.ListAdvertisement()

**Timestamp: 2/04/2013 9:23:08 AM**
Thread Name: 
Category: Event
Severity: Information
Message: Authentication token validated in AdsManagement.AdsManagentService.ListAdvertisement()

**Timestamp: 2/04/2013 9:24:02 AM**
Thread Name: 
Category: Event
Severity: Information
Message: Response received by AdsManagement.AdsManagentService.ListAdvertisement()

**Timestamp: 2/04/2013 9:24:02 AM**
Thread Name: 
Category: Trace
Severity: Information
Message: Completed AdsManagement.AdsManagentService.ListAdvertisement()

**TRANSACTION LAYER LOG TRACE**

**2/04/2013 9:24:02 AM** - BEGIN - ListAdvertisement

**2/04/2013 9:24:02 AM** - BEGIN - ConvertToAdvertisementType

2/04/2013 9:24:02 AM - END - ConvertToAdvertisementType

2/04/2013 9:24:02 AM - BEGIN - ConvertToAdvertisementType

2/04/2013 9:24:02 AM - END - ConvertToAdvertisementType

2/04/2013 9:24:02 AM - BEGIN - ConvertToAdvertisementType

2/04/2013 9:24:02 AM - END - ConvertToAdvertisementType

**2/04/2013 9:24:02 AM** - END - ListAdvertisement

As you can see, there is roughly a 1 minute delay before the Transaction layer receives the request. I have no idea what is causing this. I think it might be the logging system (Microsoft.Practices.EnterpriseLibrary.Logging). I've noticed that it creates a separate log file almost every time it receives a request, almost as if the original log file is being kept open which stops it from writing to that file. Perhaps there is a 1 minute timeout on the logging before it decides to create a new log file and write to that?

I have the following log files in the logging directory for today's date: Every time I send a new request to the Transaction Layer, there is a 1min delay and then it creates a new log file:

RTITraceGeneral.log          02/04/2013 9:20 AM

RTIEvent.log                 02/04/2013 9:20 AM

c9d64c18-80d9-4993-b167-2070190fce51RTITraceGeneral.log    02/04/2013 9:20 AM

a7acf427-a919-4fe4-9832-d186e9e28c0cRTIEvent.log           02/04/2013 9:24 AM

8e35dbdc-3c94-4e93-866a-3affcbf5f082RTITraceGeneral.log    02/04/2013 9:24 AM 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:31:26.060

我设法弄清楚了。IIS 中的 WCF 应用程序设置为多进程应用程序池，这似乎产生了问题。更改此设置后，为所有 WCF 服务使用单个进程应用程序池，日志文件现在在单个文件中创建，不再有延迟！

# html - HTML5 表单验证

> ID：15753303
> 
> 赞同：2
> 
> 时间：2013-04-01T22:53:11.343
> 
> 标签：html, forms, validation

有没有办法在不需要的输入元素中使用 HTML5 的内置表单验证？即当且仅当字段具有实际值时，是否有方法验证 HTML5 输入？

`some_name`例如，当且仅当用户在输入中实际输入值时，我想使用以下标记来检查是否是 URL。如果用户`input`留空，表单应该仍然可以像往常一样提交。

```
<input type="url" name="some_name" [some attribute or additional markup?]/> 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T22:58:18.647

使用接受 javascript 正则表达式的模式属性。

`<input type="url" name="some_name" pattern="your regular expression"/>`

# javascript - 如何获取在函数内部创建的变量？

> ID：15753308
> 
> 赞同：3
> 
> 时间：2013-04-01T22:54:13.407
> 
> 标签：javascript, node.js, variables

我在 node.js 中执行 javascript 文件，我需要访问在该文件中创建的所有变量。由于这些 javascript 文件可以根据开发人员上下文保存任何内容，因此我需要以编程方式访问变量。

我的问题是：如何获取在函数内部创建的变量？像这样的东西：

```
function test(){
    var a = 'hello world';
    var b = 100;
}

console.log(test.variables);
// -> { "a": 'hello world', "b": 100 } 
```

这有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:56:14.180

不，您需要在对象中返回这些值。

```
function test(){
    var a = 'hello world',
        b = 100;
    return {
      a: a,
      b: b
    };
}

console.log(test); //  { "a": 'hello world', "b": 100 } 
```

或者您可以将这些值保存到函数范围之外的变量中：

```
var variables = null;
function test(){
    var a = 'hello world',
        b = 100;
    variables = {
      a: a,
      b: b
    };
}
console.log(variables); //  { "a": 'hello world', "b": 100 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:55:56.263

> 这有可能吗？

不——不改变功能。

# ios - 如何在 iOS 中重新排列约束？

> ID：15753309
> 
> 赞同：0
> 
> 时间：2013-04-01T22:54:15.513
> 
> 标签：ios, xcode, interface-builder

在 XCode 中，我正在处理一个在多个屏幕上使用的小视图：

![在此处输入图像描述](https://i.stack.imgur.com/YTFg0.jpg)

顶部有黑色条。默认情况下，它有 2 个约束来定义栏底部和视图底部之间的静态距离。因此，如果我在大屏幕上加载此视图，顶部栏将被拉伸。我想保持它固定的高度，而是想在中心拉伸视图。

我试图删除 2 个约束，但它们被立即重新创建。还尝试将它们的值设置为“自动”，但这也无济于事。

如何保持顶部栏固定并粘在顶部 - 并将视图置于中心动态高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:10:52.310

您需要添加两个新约束。一种将顶栏的顶部空间设置为superview，另一种将顶栏的高度设置为。添加这些约束后，您应该能够删除导致此问题的其他两个约束。您可以使用情节提要窗口右下角的中间按钮（图钉）添加这些约束：

![在此处输入图像描述](https://i.stack.imgur.com/nOCF5.png)

# xcode - 将 NSWindow 设置调整为子窗口

> ID：15753313
> 
> 赞同：4
> 
> 时间：2013-04-01T22:54:24.250
> 
> 标签：xcode, macos, nswindow

让我重新表述一下这个问题：

如何保持子 NSWindow（使用 NSWindow 添加到主 NSWindow `addChildWindow`）与主窗口的大小相同？

**老问题：**

我有两个`NSWindow`：一个 uiWindow 和一个 openglWindow。uiWindow 是无边界的，最初的大小与 openglWindow 相同。我将它添加为子窗口。我想让 uiWindow 跟随 openglWindow 经历的任何大小变化。为此，我订阅了 openglWindow 的委托，并且正在听该`windowWillResize`方法。然而，我现在很困惑。我不知道在 uiWindow 上调用哪个函数来调整它的大小。有很多选择：

*   `setFrame: display:` `
*   `contentRectForFrameRect`

*   `frameRectForContentRect`

下面是子窗口的初始化代码。

```
NSRect uiWindowRect = [self.openglWindow convertRectToScreen:((NSView*)self.openglWindow.contentView).bounds];
NSWindow* uiWindow = [[NSWindow alloc] initWithContentRect:uiWindowRect styleMask:NSBorderlessWindowMask backing:NSBackingStoreNonretained defer:NO];

[self.openglWindow addChildWindow:uiWindow ordered:NSWindowAbove]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T01:06:23.180

我找到了一种完全符合我要求的方法。这是供参考的代码：

```
-(void)windowDidResize:(NSNotification *)notification{
    CGRect frame = CGRectMake(self.openglWindow.frame.origin.x,self.openglWindow.frame.origin.y, ((NSView*)self.openglWindow.contentView).frame.size.width, ((NSView*)self.openglWindow.contentView).frame.size.height);
    [self.window setFrame:frame display:YES];
    [self.window setFrameOrigin:NSMakePoint(self.openglWindow.frame.origin.x,self.openglWindow.frame.origin.y)];
    [self.window viewsNeedDisplay];
} 
```

# android - IntentService 中的 NetworkOnMainThreadException

> ID：15753316
> 
> 赞同：9
> 
> 时间：2013-04-01T22:54:37.903
> 
> 标签：android, static-methods, intentservice

我正在从 IntentService 进行网络调用，但仍收到 NetworkOnMainThreadException。我的理解是 IntentService 总是在工作线程上运行，所以我很惊讶地看到这一点。关键部分可能是我的 IntentService 正在调用一个执行网络调用的静态帮助程序类。静态助手类在我的主应用程序类中实例化。

我认为这仍然会在 IntentService 的工作线程上执行。我错过了什么？

老实说，比起快速修复代码，我更喜欢内容丰富的讨论。但如果需要代码，则应提供代码：

```
//MyApplication.java
public class MyApplication extends Application{

private static NetworkUtils utils;

    @Override
    public void onCreate() {
        super.onCreate();
        utils = new NetworkUtils(this);
        ...
    }
    ...
}

//NetworkUtils.java
public class NetworkUtils {

    private static Context context;
    private static final Gson gson = new Gson();

    public NetworkUtils(Context context) {
        this.context = context;
    }

    public static final DataResponse login(String email, String password) {
        //*** NetworkOnMainThreadException OCCURS HERE ***
        DataResponse response = HttpConnection.put(url, json);
        ...
        return response;
    }
    ...
}

//LoginService.java
public class LoginService extends IntentService {

    public LoginService() {
        super("LoginService");
    }

    @Override
    public void onStart(Intent intent, int startId) {
        onHandleIntent(intent);
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        Bundle bundle = new Bundle();
        DataResponse response = NetworkUtils.login(email, password);
        ...
        bundle.putBoolean(MyConstants.ExtraKeys.LOGGED, response.success);
        MainApplication.getApplicationInstance().sendBroadCast(MyConstants.Actions.LOGIN, bundle);
    }
}

//LoginActivity.java
public class LoginActivity extends ActionBarActivity implements IDialogClickListener {
    ...
    public void onLoginButtonPressed() {
        Intent intent = new Intent(MainApplication.getApplicationInstance(), LoginService.class);
        this.startService(intent);
    }
} 
```

另外，Logcat：

```
> 04-01 18:20:41.048: VERBOSE/com.foo.foo(28942):
>     com.foo.foo.network.HttpConnection.execute - METHOD: PUT   
> 04-01 18:20:41.068: ERROR/com.foo.foo(28942):
>     com.foo.foo.social.NetworkUtils.login - class
>     android.os.NetworkOnMainThreadException:  null   
> 04-01 18:20:41.169: DEBUG/com.foo.foo(28942):
>     com.foo.foo.MainActivity$MyReceiver.onReceive - BROADCAST RECEIVED:
>     com.foo.foo.MainApplication@422d81d8 - Intent { act=com.foo.foo.login
>     dat=com.foo.foo.scheme://data/1364854841079 (has extras) }   
> 04-01 18:20:41.169: INFO/com.foo.foo(28942):
>     com.foo.foo.activity.LoginActivity.setData - ACTION: com.foo.foo.login
>     - ISERROR: true 
```

**解决方案**

根本问题是一些`onHandleIntent`显式调用的遗留代码。在上面的 LoginService.java 中：

```
@Override 
public void onStart(Intent intent, int startId) { 
    onHandleIntent(intent); 
} 
```

这导致 onHandleIntent 代码在主线程上运行，因为它是从 onStart 事件（显然在主线程上运行）调用的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-12T21:30:15.033

我已经发现了这个问题。在上面的 LoginService.java 中查看这个令人费解的覆盖：

```
@Override 
public void onStart(Intent intent, int startId) { 
    onHandleIntent(intent); 
} 
```

这导致`onHandleIntent`代码在主线程上运行，因为它是从 onStart 事件（显然在主线程上运行）调用的。我很想读懂把它放进去的开发者的想法！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T00:03:25.107

你的怀疑是正确的。您正在从应用程序类中实例化 NetworkUtils 类。无论您如何称呼它，它都不会在后台线程中运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T00:45:53.397

严格来说，它是一个包含静态变量的类。我强烈建议您避免使用静态变量。相反，使用 Android API 将状态持久保存在 SharedPreferences 或 Bundles 等对象中。

Android 对象环境在设计上是暂时的。与其将状态保存在内存中，不如将其保存在专门为其设计的对象和构造中，例如 Bundles 和 SharedPreferences。你会快乐很多。尝试任何其他方法，你最终会试图将大量的蠕虫挤回一个很小的罐子里。

# php - Mongodb集团和项目运营商

> ID：15753317
> 
> 赞同：2
> 
> 时间：2013-04-01T22:54:48.213
> 
> 标签：php, mongodb, mongodb-query

我正在尝试按“group_name”分组，并使用聚合框架使用 php 驱动程序选择字段“group_name”和“group_id”：

```
Array
(
    [$project] => Array
        (
            [group_name] => 1
            [group_id] => 1
        )

    [$group] => Array
        (
            [_id] => $group_name
            [total_sum] => Array
                (
                    [$sum] => 1
                )

        )

) 
```

我得到了这个：`[errmsg] => exception: A pipeline stage specification object must contain exactly one field.` 但是，当我只使用`$project`或`$group`操作符时，它工作得很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T10:04:32.407

问题是您将 $project 和 $group 组合在一起。

你的数组应该看起来更像

```
{
  $project: {
    group_name: 1,
    group_id: 1
  },
},
{   
  $group:{
    _id:{
      group_name:'$group_name',
    },
    total_sum:{$sum:1}
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T03:01:34.437

您需要重新格式化并使用逗号作为分隔符。这是一个管道，因此它一次接收每个项目。

我没有尝试过，但尝试：

```
array
(
array(
array(
    '$project' => array(
        "group_name" => 1,
        "group_id"   => 1,
    )
),

array(
    '$group' => array(
        "_id" => array("group_name" => '$group_name'),
        "total_sum" => array('$sum' => 1),
    ),
)
) 
```

# jquery - YUI 3 获取元素的高度并将其应用于另一个元素

> ID：15753318
> 
> 赞同：0
> 
> 时间：2013-04-01T22:54:54.720
> 
> 标签：jquery, css, yui

我是 YUI 的新手，我发现它....与多年来使用 jQuery 相比很奇怪。我似乎一生都无法找到如何写这样的东西：

我正在尝试获取 div id #header 的高度，并将值为 #header 高度的 ﻿margin-top 应用于名为#noHero 的 div id。

所以 html 标记最终会是这样的：

```
<header id="header" />
<div id="noHero" style="height: HEADER HEIGHT" /> 
```

希望有人可以在这里帮助我。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:38:28.090

画廊模块[尺寸](http://yuilibrary.com/gallery/show/dimensions)提供`totalHeight()`，因此您可以这样做：

```
Y.one('#noHero').setStyle('margin-top', Y.one('#header').totalHeight()+'px') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T13:46:54.407

这应该有效：

```
Y.one('#noHero').setStyle('margin-top', Y.one('#header').get('region').height+'px') 
```

# python - Python：连接四个交替转弯

> ID：15753322
> 
> 赞同：2
> 
> 时间：2013-04-01T22:55:14.357
> 
> 标签：python

我一直在开发一个实现connect 4游戏的程序，但遇到了障碍。这是我的输出：

```
>>> ================================ RESTART ================================
>>> 
Player 1 please pick a column: 5
-----------------------------
| 0 | 1 | 2 | 3 | 4 | 5 | 6 |
-----------------------------
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   | x |   |
-----------------------------
Player 2 please pick a column: 6
-----------------------------
| 0 | 1 | 2 | 3 | 4 | 5 | 6 |
-----------------------------
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   | o |
----------------------------- 
```

所以基本上板子在交替轮流时不会“更新”基本上我的代码最终应该看起来像这样：

```
-----------------------------
| 0 | 1 | 2 | 3 | 4 | 5 | 6 |
-----------------------------
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |
|   |   |   |   |   | x | o |
----------------------------- 
```

我不太确定我必须做什么才能让董事会正确更新。我试过弄乱打印功能，但输出最终变得比以前更糟。这是我的代码：

从播放器导入 *

```
def play_game(board, player1,player2):
    b = ConnectFour()
    f = Human(1)
    g = Human(2)
    while True:
        f.play_turn(1)
        if b.is_game_over() == None:
            g.play_turn(2)
            if b.is_game_over() == None:
                pass
            else:
                print "Player 2 wins"
                break
        else:
            print "Player 1 wins"
            break 
```

基本上：玩家 1 玩，然后我们检查是否有赢家，如果没有玩家 2 玩，依此类推。这调用了一个单独的类：

```
class Human(Player):
    def play_turn(self,board):
        super(Human, self).play_turn(board)
        b = ConnectFour()   
        x = raw_input("Player %s please pick a column: " % self.playernum)
        b.play_turn(self.playernum, int(x))
        b.print_board() 
```

任何想法、意见或建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:54:35.527

问题是，虽然你在传递`board`对象，但你忽略了它们，只是到处创建新对象。

首先，看`Human.play_turn`：

```
def play_turn(self,board):
    super(Human, self).play_turn(board)
    b = ConnectFour()   
    x = raw_input("Player %s please pick a column: " % self.playernum)
    b.play_turn(self.playernum, int(x))
    b.print_board() 
```

这传递`board`给 super 方法`Player.play_turn`，但随后它创建了一个新板`b = ConnectFour()`，并且它所做的一切都是针对*该*板，而不是原始板。

同样，在 中`play_game`，您采用 a `board`、 a`player1`和 a `player2`，但对它们不做任何事情，而是创建名为`b`、`f`和的新值`g`。

所以，你想要的是这样的：

```
def play_game(board, player1,player2):
    while True:
        player1.play_turn(board)
        if board.is_game_over() == None:
            player2.play_turn(board)
            if board.is_game_over() == None:
                pass
            else:
                print "Player 2 wins"
                break
        else:
            print "Player 1 wins"
            break

class Human(Player):
    def play_turn(self,board):
        super(Human, self).play_turn(board)
        x = raw_input("Player %s please pick a column: " % self.playernum)
        board.play_turn(self.playernum, int(x))
        board.print_board() 
```

这应该可以解决您的直接问题 - 但我猜您在所有其他功能中都有非常相似的问题。

同时，你的设计也有一些奇怪的地方。

例如，你为什么要检查`if b.is_game_over() == None:`？如果游戏结束，被调用的函数`is_game_over`应该返回一些真实的东西，否则返回一些虚假的东西。虽然`None`是一个合理的“虚假的东西”，`False`但更合理——而且，无论哪种方式，很难想象你为什么要明确地检查它，而不是仅仅检查它是否是虚假的。（另外，即使您出于某种原因*确实*需要专门检查`None`，也几乎没有充分的理由使用`== None`而不是`is None`.）

其次，为什么需要在函数之外创建`board`、、`player1`和？在此功能之外，它们似乎并没有那么有用。`player2``play_game`

最后，即使只有两个玩家，我认为如果您重构公共部分，您的代码会更简单：

```
def play_game(board, player1,player2):
    while True:
        for player in player1, player2:
            player.play_turn(board)
            if board.is_game_over():
                print "Player {} wins".format(player.playernum)
                break 
```

最后一件事：你的逻辑似乎没有考虑到游戏可能结束的可能性，因为当前玩家没有行动。我不确定这在 Connect 4 中是平局还是失败，但我很确定这不是胜利，是吗？

# mercurial - hg 回退的反向

> ID：15753326
> 
> 赞同：0
> 
> 时间：2013-04-01T22:55:22.323
> 
> 标签：mercurial

我正在寻找一种类似的方法`hg backout`，但相反。具体来说，我不想撤消与给定变更集相关的差异，而是希望将它们实际应用到任意修订之上。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T22:58:05.170

`hg transplant`（捆绑扩展）或`hg graft`（核心，自 2.0 起）执行此操作。

# matlab - 基于参数matlab的非线性约束

> ID：15753328
> 
> 赞同：0
> 
> 时间：2013-04-01T22:55:35.663
> 
> 标签：matlab, constraints, nonlinear-optimization

我尝试在 fmincon 优化器中施加非线性约束。问题是非线性约束应该仅在参数之一为负时才相关。代码是这样的：

```
function [c, ceq] = confun_Model11(param)
% Nonlinear inequality constraints: c(x)<=0
if  param(6)<0
    c = (-4)*param(5)*param(7) + param(6)^2+eps;
else
    c = [];
end

%Nonlinear equality constraints: ceq(x)=0
ceq = [];
end 
```

问题是，例如，当使用诊断选项时，Matlab 说没有非线性约束：

```
Constraints
 Number of nonlinear inequality constraints: 0
 Number of nonlinear equality constraints:   0 
```

并且在寻找最优值的过程中也违反了这种非线性约束。有人可以指出我是否没有正确定义非线性条件约束吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T04:45:14.110

我不确定 fmincon 能否应对运行时变化的约束数量。

当您不希望约束处于活动状态时，最好返回一个满足约束 c(x)<=0 的值，而不是尝试在代码评估中关闭约束。

```
function [c, ceq] = confun_Model11(param)
% Nonlinear inequality constraints: c(x)<=0
c = (-4)*param(5)*param(7) + param(6)^2+eps;

% Ensure constraint isn't violated if param(6) is positive
if param(6) >= 0
    c = -abs(c);
end

%Nonlinear equality constraints: ceq(x)=0
ceq = [];
end 
```

现在，这仍然不是很好，因为根据参数上的其他（线性？）约束，约束函数可能是不连续的。一般来说，如果约束函数是连续且平滑的，那么您更有可能在优化方面取得成功 - 因此请尝试将您的约束函数重新定义为没有“if”语句或“abs”函数的东西......即。在您希望应用约束的地方刚刚越过零的东西。

使用多个非线性约束来实现这一目标可能是有意义的。

# android - T-Mobile 网络是否允许传入的 UDP 数据包？

> ID：15753330
> 
> 赞同：3
> 
> 时间：2013-04-01T22:55:40.110
> 
> 标签：android, udp, 3g

简短版本：**T-Mobile 网络是否允许传入的 UDP 数据包？**

更长的版本：

我正在编写一个通过移动网络连接两个 Android 的小型测试应用程序。它可以在 LAN 上工作，但不能超过 3g。

大多数运营商阻止通过其网络传入的 TCP 连接，同样的限制是否适用于传入的 UDP？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-17T21:15:22.647

我最近一直在测试来自[T-Mobile Slovakia (Deutsche Telekom)](http://en.wikipedia.org/wiki/Slovak_Telekom)的 3G 上的 UDP 端口转发，发现这是不可能的。他们正在使用[对称 NAT](http://en.wikipedia.org/wiki/Network_address_translation)，这将阻止您在两个对等方之间通信端点，因为一个对等方的传入端口将取决于另一个对等方的 IP 地址。[我在这里](https://stackoverflow.com/a/18139611/273348)写了更多关于它的内容。

[在这方面，我对O2 Slovakia (Telefónica)](http://en.wikipedia.org/wiki/Telef%C3%B3nica_Slovakia)没有任何问题。

编辑：考虑到这个问题已经 5 个月了，现在这可能无关紧要，但是既然你提到了构建一个测试应用程序，我发现的关于 NAT 遍历的最佳教程是 IMO [this one](http://www.brynosaurus.com/pub/net/p2pnat/)。

# php - 为什么 $this 代表当前类

> ID：15753333
> 
> 赞同：0
> 
> 时间：2013-04-01T22:55:59.233
> 
> 标签：php

我已经在互联网上搜索了一个有效的解释，为什么`$this`未定义时代表当前类。

我在搜索时在文档中找到了这个`$this`：

*当从对象上下文中调用方法时，伪变量 $this 可用。$this 是对调用对象的引用（通常是方法所属的对象，但也可能是另一个对象，如果该方法是从辅助对象的上下文中静态调用的）。*

我理解在一定程度上，让我们以下面的例子为例：

```
class Foo {
    public $Database;

    public function __construct() {
        $this->Database = 'Test';
    }
        protected function Test()
    {
         return 'Example';
    }
         public function BarFunction()
    {
           return $this->Test();
    }
}

$Test = new Foo();
echo $Test->Database;
echo "\r\n\r\n";
echo $Test->BarFunction(); 
```

输出：

```
Test

Example 
```

使用静态函数时，`self::`接管`$this`

所以我的总体问题是，为什么`$this`自动占位符代表当前类而无需在使用之前定义？

为什么`self::`只能与静态函数一起使用？因为总的来说，我在使用时看到它更整洁

`self::ProtectedFunction();`

超过：

`$This->ProtectedFunction();`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:01:13.563

`self`引用当前类，并`$this`引用该类的当前*实例*。

# c++ - siginfo 匿名工会

> ID：15753339
> 
> 赞同：0
> 
> 时间：2013-04-01T22:56:29.210
> 
> 标签：c++, c, linux, struct, linux-kernel

我正在尝试获取生成 sigsys 信号的系统调用的地址！但我从 gcc 收到以下错误：

```
gcc emulator.c -fms-extensions
error: ‘siginfo_t’ has no member named ‘si_call_addr’ 
```

我使用的代码是：

```
static void emulator(int nr, siginfo_t *siginfo, void *void_context)
{
        ucontext_t *ctx = (ucontext_t *)(void_context);
        int syscall;
        char *buf;
        ssize_t bytes;
        size_t len;

        if (siginfo->si_code != SYS_SECCOMP)
                return;
        if (!ctx)
                return;

        syscall = ctx->uc_mcontext.gregs[REG_SYSCALL];
      printf("System call %d ADDR %X\n", syscall,  siginfo->si_call_addr);

        setcontext(ctx);

        return;
} 
```

si_call_addr 被定义为 siginfo_t 中的匿名结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:02:19.190

siginfo_t 中没有`si_call_addr`。您可能正在寻找`si_addr`会员。

这是linux提供的siginfo_t：

```
 siginfo_t {
       int      si_signo;    /* Signal number */
       int      si_errno;    /* An errno value */
       int      si_code;     /* Signal code */
       int      si_trapno;   /* Trap number that caused
                                hardware-generated signal
                                (unused on most architectures) */
       pid_t    si_pid;      /* Sending process ID */
       uid_t    si_uid;      /* Real user ID of sending process */
       int      si_status;   /* Exit value or signal */
       clock_t  si_utime;    /* User time consumed */
       clock_t  si_stime;    /* System time consumed */
       sigval_t si_value;    /* Signal value */
       int      si_int;      /* POSIX.1b signal */
       void    *si_ptr;      /* POSIX.1b signal */
       int      si_overrun;  /* Timer overrun count; POSIX.1b timers */
       int      si_timerid;  /* Timer ID; POSIX.1b timers */
       void    *si_addr;     /* Memory location which caused fault */
       long     si_band;     /* Band event (was int in
                                glibc 2.3.2 and earlier) */
       int      si_fd;       /* File descriptor */
       short    si_addr_lsb; /* Least significant bit of address
                                (since kernel 2.6.32) */
   } 
```

# c++ - SDL、标题和奇怪的错误..？

> ID：15753341
> 
> 赞同：0
> 
> 时间：2013-04-01T22:56:46.537
> 
> 标签：c++, header, g++, sdl, symbols

我正在学习如何使用 SDL，到目前为止一切正常。每当我尝试编译我的代码时，我都会收到以下错误：

```
Undefined symbols for architecture x86_64:
  "Tile::draw(SDL_Surface*)", referenced from:
    _SDL_main in ccTWWnIW.o
  "Tile::update()", referencedfrom:
    _SDL_main in ccTWWnIW.o
  "Tile::Tile(int)", referenced from:
    _SDL_main in ccTWWnIW.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

奇怪的是，它仅在我的“player.cpp”代码位中包含“level.h”头文件时发生。而在我的主程序中包含“level.h”并不会触发编译器全部。我在两个主程序中使用“level.h”中定义的类——实例化图块，更新它们并将它们blit到屏幕上——以及在“player.cpp”中——来检查碰撞。我注释掉了使用“level.h”中定义的任何组件的“player.cpp”的所有部分，但我仍然遇到编译器错误。我在“player.cpp”中包含了相同的 SDL 标头，并在我的编译器上相应地设置了标志，所以我真的不明白为什么会出现“ld: symbol(s) not found for architecture x86_64”消息.

错误消息中引用的“level.cpp”位：

```
#include "SDL.h"
#include "SDL_image.h"
#include <iostream>
#include "Variables.h"
#include <cstdlib>
#include "level.h"

class Tile{
public:
    int damage;
    int velocity;
    bool solid;
    SDL_Rect position;
    SDL_Rect crop;
    SDL_Surface* image;
    Tile(int type);
    ~Tile();
    bool update();
    void draw(SDL_Surface* target);
}; 
```

...

```
Tile::Tile(int type){
    if(type == 0){
        damage = 0;
        velocity = 20;
        solid = true;
        position.x = 600;
        position.y = rand() % 500;
        SDL_Surface* temp_image = IMG_Load_RW(SDL_RWFromFile("spritesheet.png", "rb"), 1);
        image = SDL_DisplayFormatAlpha(temp_image);
        SDL_FreeSurface(temp_image);
        crop.x = 0;
        crop.y = 0;
        crop.w = 50;
        crop.h = 50;
    }
} 
```

...

```
bool Tile::update(){
    position.x = position.x - velocity;
    if(position.x <= 0) {
        position.x = 700;
        position.y = rand()%500;
    }
    else return 0;
} 
```

...

```
void Tile::draw(SDL_Surface* target){
SDL_BlitSurface(image, &crop, target, &position);
} 
```

我知道编码风格很垃圾，这只是我在玩弄和学习 SDL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:28:12.583

我不确定基于此的确切问题是什么，但是您应该做一些事情。

在你的头球周围放置头球后卫，例如。在 level.h 中，你会想要这样的东西：

```
#ifndef LEVEL_H_
#define LEVEL_H_ 
```

在顶部，并且：

```
#endif 
```

在底部。这是为了防止在文件被多个不同的源文件包含时多次定义符号。

其次，您需要将类定义放入头文件（.h）而不是 .cpp 文件中。在您的情况下，将 tile 内容移动到其自己的文件（tile.h、tile.cpp）中可能会更好，但无论哪种方式，tile 类定义都需要位于头文件中。

# javascript - 在函数内的函数中分配隐藏变量

> ID：15753342
> 
> 赞同：0
> 
> 时间：2013-04-01T22:56:52.493
> 
> 标签：javascript, function, google-maps-api-3, pass-by-reference, hidden-variables

我有类似于以下的 javascript 代码，但是当我尝试在 foo() 中使用“myVar”时，它的值是未定义的。我也尝试将变量传递给 bar() 并直接分配它，但不会通过引用传递。

```
function foo() { 
   bar();
   var myVar = document.getElementById('coords').value;
   // myVar should now be (40.7143528, -74.0059731)
   alert(myVar); // returns blank

   var request = {
    location: myVar,
    radius: 500,
    types: [type] //previously defined 
   };

   //Then send a search request to Google...
}

function bar() {
   geocoder.geocode( {'address':address}, function(results, status) {

      document.getElementById('coords').value = results[0].geometry.location;
      // Let's say the location is NYC (40.7143528, -74.0059731)

     alert(document.getElementById('coords').value); //returns the correct value
     // however, this pops up after the pop up in function foo() 

   });
} 
```

使用以下 HTML

```
<input type="hidden" id="coords" name="coords"/> 
```

真正的代码是使用 Google Maps API，如果这会有所不同：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:02:11.693

**[jsfiddle 演示](http://jsfiddle.net/dgELX/)**

对我来说运行良好。确保在定义函数时要在`function`定义前面实际使用。

```
function foo() { 
 bar();
 var myVar = document.getElementById('coords').value;
}

function bar() {
 document.getElementById('coords').value = 4;
}

foo(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T20:25:47.853

`bar`异步运行，因为`geocoder`确实如此。这意味着

```
document.getElementById('coords').value = results[0].geometry.location; 
```

实际执行*后*

```
var myVar = document.getElementById('coords').value; 
```

你不能以这种方式使用ajax。你所有依赖`results`/的工作`status`都必须在回调中完成。

# web-services - 为什么我的 Web 服务中的元素“元素”中的“类型”属性值无效？

> ID：15753345
> 
> 赞同：2
> 
> 时间：2013-04-01T22:57:02.737
> 
> 标签：web-services, xsd

我正在签订合同第一个网络服务，所以我的第一个 xds(MensajeDetails.xds) 是：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://webservices.samples.blog.com" targetNamespace="http://webservices.samples.blog.com" elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:element name="Mensaje" type="Mensaje"/>
    <xs:complexType name="Mensaje">
        <xs:sequence>
            <xs:element name="IdMensajesEnviados" type="xs:long"/>
            <xs:element name="CodigoEstatus" type="xs:int"/>
            <xs:element name="DescripcionEstatus" type="xs:string"/>
        </xs:sequence>
    </xs:complexType>
</xs:schema> 
```

在我的第二个 xds (MensajeDetailsS​​erviceOperation.xds) 我已经：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://com/blog/samples/webservices/mensajeservice" xmlns:account="http://webservices.samples.blog.com" targetNamespace="http://com/blog/samples/webservices/mensajeservice" elementFormDefault="qualified">
    <xsd:import namespace="http://webservices.samples.blog.com" schemaLocation="MensajeDetails.xsd"/>
    <xsd:element name="MensajeDetailsRequest">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="IdUsuario" type="xsd:long"/>
                <xsd:element name="Token" type="xsd:string"/>
                <xsd:element name="IdServicio" type="xsd:int"/>
                <xsd:element name="Archivo" type="xsd:byte"/>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
    <xsd:element name="MensajeDetailsResponse">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="MensajeDetails" type="mensaje:Mensaje"/>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
</xsd:schema> 
```

所以日食告诉我，在我的第二个 xds

```
s4s-att-invalid-value: Invalid attribute value for 'type' in element 'element'.
    Recorded reason: UndeclaredPrefix: Cannot resolve 'mensaje:Mensaje' as a QName: the prefix 'mensaje' is not declared." in the line:
    <xsd:element name="MensajeDetails" type="mensaje:Mensaje"/> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:09:00.873

您已将命名空间导入您的架构并为其声明了命名空间前缀，在您的架构声明中，您拥有`xmlns:account="http://webservices.samples.blog.com"`，这将前缀“帐户”绑定到您导入的命名空间。

因此，要么将元素更改为，要么`account:Mensaje`将前缀更改为`mensaje`

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns="http://com/blog/samples/webservices/mensajeservice"
  xmlns:mensaje="http://webservices.samples.blog.com"
  targetNamespace="http://com/blog/samples/webservices/mensajeservice"
  elementFormDefault="qualified"> 
```

# wcf - 带有 WCF json 的 Kendo ui 自动完成功能不起作用

> ID：15753349
> 
> 赞同：1
> 
> 时间：2013-04-01T22:57:18.167
> 
> 标签：wcf, autocomplete, kendo-ui

I'，在项目中使用剑道 ui 自动完成控件。自动完成从 WCF 服务获取数据，返回 JSON 格式的数据。在 html 页面中，我输入了以下代码：

```
$("#txtAutocomplete").kendoAutoComplete({
            filter: "contains",
            minLength: 3,
            dataSource: {
                type: "json",
                serverFiltering: true,
                serverPaging: true,
                pageSize: 20,
                transport: {
                    read: "http://localhost:52054/MyService.svc/Autocomplete"
                }
            }
        }); 
```

WCF 服务可以这样调用：

```
http://localhost:52054/MyService.svc/Autocomplete/anyword 
```

它以这样的 json 文件响应：

```
["abc1","abc2","abc3"] 
```

但自动完成不起作用，我在 jquery.min.js 中遇到多个语法错误

有什么建议吗？谢谢你的时间！

# ruby-on-rails - 如何配置 DATABASE_URL 以将 host_names 列表添加到 heroku 上的 database.yml？

> ID：15753350
> 
> 赞同：3
> 
> 时间：2013-04-01T22:57:18.400
> 
> 标签：ruby-on-rails, heroku, discourse

Heroku 从 DATABASE_URL 环境变量生成 database.yml，如下所示：[https ://gist.github.com/liliakai/c161ad5704be04e88999](https://gist.github.com/liliakai/c161ad5704be04e88999)

我希望生成的 database.yml 包含该行

```
host_names:  
  - my.customdomain.com 
```

我如何将它编码到 DATABASE_URL 上的查询字符串中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T15:01:08.907

您可以手动设置`DATABASE_URL`类似的属性

```
$ heroku config:get DATABASE_URL
[copy returned value]
$ heroku config:set DATABASE_URL=[paste value]?host_names=my.customdomain.com 
```

**请注意，这是脆弱的**；升级新数据库或重置凭据将重置`DATABASE_URL`. 这些类型的添加也会导致 Heroku pgbackups 插件无法工作。

最后，这对于 Heroku 上的 Discourse 不是必需的——我只是自己设置了 Discourse，不需要它。

# javascript - 动画以延迟开始

> ID：15753353
> 
> 赞同：0
> 
> 时间：2013-04-01T22:57:49.740
> 
> 标签：javascript, jquery

我已经编写了从外部 php 文件加载内容的脚本。我正在使用 jquery1-9-1。我的脚本工作正常，除了我第二次单击按钮的那一刻。动画开始前有 0.5 秒的延迟。我想我知道问题出在哪里。`$("#header").animate({marginTop: "10px"...`必须在第一次单击时执行。单击一次后，必须将其停用。谁知道如何解决？不要对我如此苛刻，对不起我的英语

```
$(document).ready(function () {
    var content = $("#content");
    $("#main_menu a").click(function () {
        var id = this.id;
        $("#header").animate({
            marginTop: "10px"
        }, 500, function () {
            $("#content").fadeOut(500, function () {
                $("#content").load(id + ".php")
                $("#content").fadeIn(500)
            })
        })
    })
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:04:31.853

我不得不问，`content = $("#content")`如果您拒绝使用它并`$("#content")`稍后重复调用，那么缓存有什么意义？

无论如何，您需要一个变量来判断它是否是第一次运行：

```
 $(function () {
        var content = $("#content"), isfirst = true;
        $("#main_menu a").click(function () {
            var id = this.id,
                reveal = function() {
                    content.fadeOut(500, function () {
                        content.load(id + ".php")
                        content.fadeIn(500)
                    });
                };
            if( isfirst) $("#header").animate({marginTop: "10px"}, 500, reveal);
            else reveal();
            isfirst = false;
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:03:30.440

在这种情况下，您需要跟踪它是否已加载。一个简单的变量和一些闭包应该可以做到：

```
var isLoaded = false;
$("#main_menu a").click(function () {
          var id = this.id;
          if (!isLoaded) {
              $("#header").animate({
                 marginTop: "10px"
              }, 500);
              isLoaded = true;
          }
          $("#content").fadeOut(500, function () {
          $("#content").load(id + ".php")
          $("#content").fadeIn(500)
       })
  }); 
```

# php - zf2 表单验证（zfcAdmin 和 BjyAuthorize 相关）

> ID：15753359
> 
> 赞同：1
> 
> 时间：2013-04-01T22:58:33.457
> 
> 标签：php, validation, zend-framework2, zend-form

在 zfcAdmin 和 BjyAuthorize 中集成我的自定义模块时，我遇到了验证问题。

我的表单类：

```
...    
$formOptions = $this->settings->getFormSettings();
foreach ($formOptions as $field){
if (isset($field['field']))
    $this->add($field['field']);        
}
... 
```

我的过滤器类：

```
$formOptions = $this->settings->getFormSettings();
foreach ($formOptions as $filter){
if (isset($filter['filter']))
    $this->add($filter['filter']);   
}
... 
```

从配置文件中检索字段、过滤器和其他选项。

基本上一切正常：可以从数据库中添加、编辑或删除表单数据。同样zfcAdmin模块安装后没问题升了。使用 'site/mymodule' 路由和 'site/admin/mymodule' 路由一切正常：我仍然可以从 db 添加、编辑和删除项目。

这里的问题是：我需要一些表单元素（在这种特殊情况下为 Select）只能由管理员编辑/查看。（我可以为管理员编写一个新的控制器/实体类“ad hoc”，但我想对整个站点使用相同的代码。）

我安装并配置了 bjyoungblood/BjyAuthorize 模块：它允许我只向管理员显示一些表单元素/字段，但是当我处于编辑模式时，会显示表单验证错误：“值是必需的，不能为空”

这里的代码：

```
//view/mymodule/mymodule/update.phtml
<div id="page" style="margin-top: 50px;">

<?php if (isset($this->messages) && count($this->messages) > 0 ): ?>
<?php foreach ($this->messages as $msg): ?>
<div class="alert alert-<?php echo $this->escapeHtmlAttr($msg['type']); ?>">
    <?php if (isset($msg['icon'])) echo '<i class="'.$this->escapeHtmlAttr($msg['icon']).'"></i>&nbsp;'; ?><?php echo $this->escapeHtml($msg['message']); ?>
</div>
<?php endforeach; ?>
<?php endif; ?>

<?php
$title = 'Edit Item';
$this->headTitle($title);
?>
<h1><?php echo $this->escapeHtml($title); ?></h1>

<?php
$form = $this->form;
$form->setAttribute('action', $this->url($this->route . 'mymodule/update', array('action' => 'update', 'id' => $this->id )));
$form->prepare();
$form->setAttribute('method', 'post');
$input = $form->getInputFilter();

?>

<?php echo $this->form()->openTag($form) ?>
<dl class="zend_form">
    <?php foreach ($form as $element): ?>

        <?php
            //CHECK USER PRIVILEDGES
            $elName = $element->getName();
            $elResource = isset($this->form_options[$elName]['auth']) ? $this->form_options[$elName]['auth']['resource'] : "userresource"; 
            $elPrivilege = isset($this->form_options[$elName]['auth']) ? $this->form_options[$elName]['auth']['privilege'] : "view";

            //SHOW THE ELEMENT IF ALLOWED
            if($this->isAllowed($elResource, $elPrivilege)): 
        ?>
            <?php if ($element->getLabel() != null): ?>
                <dt><?php echo $this->formLabel($element) ?></dt>
                <?php endif ?>
            <?php if ($element instanceof Zend\Form\Element\Button): ?>
                <dd><?php echo $this->formButton($element) ?></dd>
                <?php elseif ($element instanceof Zend\Form\Element\Select): ?>
                <dd><?php echo $this->formSelect($element) . $this->formElementErrors($element) ?></dd>
                <?php else: ?>
                <dd><?php echo $this->formInput($element) . $this->formElementErrors($element) ?></dd>
                <?php endif ?>
           <?php else: ?>
           <?php        

           ?>          
        <?php endif ?> 

    <?php endforeach ?>
</dl>
<?php echo $this->form()->closeTag() ?>

</div>
<div class="clear-both"></div> 
```

我的控制器动作

```
//controller
        public function updateAction(){
            $messages = array();
            $id = (int)$this->getEvent()->getRouteMatch()->getParam('id');
            $form = $this->getServiceLocator()->get('FormItemService');

            $itemMapper = $this->getItemMapper();
            $item = $itemMapper->findById($id);
            $form->bind($item);

            $request = $this->getRequest();

            if($request->isPost()){
                $form->setData($request->getPost());
                if ($form->isValid()) {             
                    die('c');//never here
                    $service = $this->getServiceLocator()->get('mymodule\Service\Item');
                    if ( $service->save($form->getData()) )
                    {
                        $messages[] = array(
                                'type'    => 'success',
                                'icon'    => 'icon-ok-sign',
                                'message' => 'Your profile has been updated successfully!',
                        );
                    }
                    else
                    {
                        $messages[] = array(
                                'type'    => 'error',
                                'icon'    => 'icon-remove-sign',
                                'message' => 'Profile update failed!  See error messages below for more details.',
                        );
                    }
                }else{
                    var_dump($form->getMessages());//Value is required and can't be empty
                }
            }

            return array(
                'messages' => $messages,    
                'form' => $form,
                'id' => $id,    
                'form_options' => $this->getServiceLocator()->get('mymodule_module_options')->getFormSettings(),
                'route' => $this->checkRoute($this->getEvent()->getRouteMatch()->getmatchedRouteName())
            );
        } 
```

如果不允许用户查看资源，则不会回显该元素。因此 $request->getPost() 对该表单元素没有任何值，并且 isValid() 返回错误。

有没有人解决过类似的问题，或者谁能指出我正确的方向？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T07:08:58.710

问题是您没有在您定义必填字段的 FormFilter 类中进行任何安全检查。

$form->isValid() 函数根据这些过滤器元素检查发布的数据。所以在你的视图中阻止'echo field'是不够的，你仍然需要对过滤器元素应用安全检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T08:26:51.843

另一种方法是制作两种形式，一种用于前端，一种用于管理员。由于管理员的表单将具有相同的字段加上一个额外的选择字段，因此您可以使管理表单扩展前端表单。例如

```
class myForm 
{
    public function __construct(...) 
    {
         // add fields and set validators
    }
} 
```

管理表格可以是：

```
class MyAdminForm extends myForm
{
    public function __construct(...)
    {
        parent::__construct(...);
        // add the extra field and extra validator
    }
} 
```

这样，即使您编辑前端表单（或验证器），后端也将始终是最新的。

希望这可以帮助 ：），

斯托扬

# javascript - 启动 jquery fadeToggle hidden

> ID：15753361
> 
> 赞同：1
> 
> 时间：2013-04-01T22:58:47.317
> 
> 标签：javascript, jquery, html, fade

我想使用 fadeToggle 自动淡入和淡出一些图像。它正在工作，但是所有图像都开始“淡入”，我希望它们开始不可见，以便它们一张一张地出现。提前致谢！

```
 $(function () {
function run_animation($element, delay, duration) {
    $element.delay(delay).fadeToggle(duration, function () {
        run_animation($element, delay, duration);
    });
}
run_animation($('.pointer1'), 2000, 1000);
run_animation($('.pointer2'), 2500, 1000);
run_animation($('.pointer3'), 3000, 1000);
run_animation($('.pointer4'), 3500, 1000);
run_animation($('.pointer5'), 4000, 1000); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:00:57.743

您是否尝试使用 CSS 隐藏图像？尝试`display:none`，如果需要，您可以在`show()`.

# jquery - 如何防止 Datebox 影响其他输入元素？

> ID：15753363
> 
> 赞同：0
> 
> 时间：2013-04-01T22:58:58.267
> 
> 标签：jquery, html, css, datebox

我目前有一个包含一堆输入元素的表单。我想使用 Datebox 的日历功能来输入日期。

我的问题是 Datebox 使用的 CSS 和 JS 会影响表单上的其他输入元素。防止 Datebox 的 CSS 影响其他输入表单的最佳方法是什么？

这是一个[jsFiddle 链接。（点击这里）](http://tinyurl.com/d4fvs8k)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T06:23:09.673

看起来它是您包含的样式的 jquery mobile css，而不是 datepicker。您可以重置输入样式，尽管您可能不想要 jquery 移动样式表。

# javascript - 改进 Retina iPad 上的慢画布动画 - KineticJS

> ID：15753373
> 
> 赞同：3
> 
> 时间：2013-04-01T22:59:52.043
> 
> 标签：javascript, html, canvas, kineticjs, retina-display

我正在使用 KineticJS 来执行 HTML Canvas 动画。动画在所有桌面浏览器和非视网膜 iDevices（包括 iPad mini）上都能完美运行。但是，从 Retina 设备（浏览器或使用 appcelerator 的应用内 web 视图）来看，这些动画非常缓慢。我在视网膜显示器上看到了与画布动画类似的问题，但还没有找到任何真正的解决方案。

我的 Stage 构造函数是 1024w x 768h。所有图像均已预加载。动画是使用预加载器的回调函数构造的。

如果我将我的舞台大小减半（并相应地缩放内部内容），动画将几乎正常播放（仍然比其他 ipad 有点断断续续）。我尝试这样做的唯一理由是我非常不了解视网膜显示器是两个“点”/像素。

欢迎任何见解或想法。我的下一个尝试是开始更改图像分辨率，而不是动态缩放。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T12:31:10.220

这是由于四个月前添加的一项功能。KineticJS 将识别设备的像素比是否超过 1，并尝试使其与像素比 1 一样清晰。问题是，就像您发现的那样，它会破坏性能，以至于它毫无用处。我们发现我们的用例就是这种情况。

我们的解决方案：我们在 KineticJS 中注释掉了像素比率部分，并将其硬编码为始终为 1。

优点：

性能恢复正常

缺点：

图像没有那么清晰

这是我们进行更改的部分：

```
Kinetic.Canvas = function(width, height, pixelRatio) {
// eduplus change to fix pixel ratio performance problems
this.pixelRatio = 1; //pixelRatio || _pixelRatio; 
```

在与 Eric 讨论这个问题时，他发表了评论以研究像素比性能，但我认为他还没有时间这样做。希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-28T05:29:09.587

使用 KineticJS 5 或更高版本（我不确定何时引入此全局设置），最简单且侵入性最小的方法是在实例化阶段之前将 Kinetic.pixelRatio 设置为您想要的值：

```
Kinetic.pixelRatio = 1;
var stage = new Kinetic.Stage({
    ...
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-29T20:47:32.573

我在实例化我的 Stage 之前使用它来重载 pixelRatio 而不修改 KineticJS 的源文件。（使您不必在任何更新后更新源文件。）

[https://gist.github.com/echo/6107722](https://gist.github.com/echong/6107722)

咖啡脚本：

```
# Adjust device pixel ratio
for className in ["HitCanvas", "SceneCanvas", "Canvas"]
    Kinetic[className].prototype.init = ((p_method) -> (p_config={}) ->
        p_config.pixelRatio = 1
        p_method.call @, p_config
    ) Kinetic[className].prototype.init 
```

JavaScript：

```
_ref = ["HitCanvas", "SceneCanvas", "Canvas"];
for (_i = 0, _len = _ref.length; _i < _len; _i++) {
  className = _ref[_i];
  Kinetic[className].prototype.init = (function(p_method) {
    return function(p_config) {
      if (p_config == null) {
        p_config = {};
      }
      p_config.pixelRatio = 1;
      return p_method.call(this, p_config);
    };
  })(Kinetic[className].prototype.init);
} 
```

# python - 在python中扫描用户输入

> ID：15753376
> 
> 赞同：0
> 
> 时间：2013-04-01T23:00:18.210
> 
> 标签：python

```
direction = input("enter a direction: ")
if direction != "quit" and direction != "go north" and direction != "go south" and direction != "go east" and direction != "go west" and direction != "go up" and direction != "go down" and direction != "look":
    print ("please enter in the following format, go (north,east,south,west,up,down)")

elif direction == "quit":
    print ("OK ... but a small part of you may never leave until you have personally saved Muirfieland from the clutches of evil .. Bwahahahahahah (sinister laugh) ... the game should then end.")

elif direction == "look":
    print ("You see nothing but endless void stretching off in all directions ...")

else:
    print ("You wander of in the direction of " + direction) 
```

我需要知道如何在 python 中做到这一点。例如，我需要扫描用户输入的前 2 个字母

```
i = user_input
#user inputs go ayisgfdygasdf 
```

我需要它能够扫描用户输入，检查前 2 个字母是否正常，如果它们正常，但它无法识别第二个单词，在这种情况下是“ayisgfdygasdf”，然后打印“对不起，我做不到那”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:14:18.027

他也可以尝试使用：

```
 directions.split() 
```

但在某些情况下可能需要使用 try/except。

有关拆分和方法的更多信息，请尝试使用：

```
 dir(directions) 
```

查看对象方向有哪些方法

或者：

```
 help(directions.split) 
```

查看有关特定方法的帮助（在本例中为对象方向的方法拆分）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:27:37.520

您可以索引输入的各个字符：

```
if direction[:2] == "go":
    print "Sorry, I can't do that." 
```

但是，尝试为每个可能的输入分配一个 if-else 分支通常是一个糟糕的选择……很难快速维护。

在这种情况下，一种更简洁的方法可能是定义一个具有有效输入的字典，如下所示：

```
input_response = {"quit":"OK ... but", "go north": "You wander off north", \
                  "go south": "You wander off south"} # etc 
```

然后，您可以将代码重新编写为：

```
try:
    print input_response[direction]
except KeyError:
    if direction[:2] == "go":
        print "Sorry, I can't do that."
    else:
        print ("please enter in the following format...") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:09:11.323

您可以使用 [] 表示法通过索引访问 python 中字符串的字符。您可以通过输入 user_input[:2] 检查字符串中的前两个字符。此代码将包括所有字符，但不包括键入的索引。所以这个符号将包括 user_input[0] 和 user_input[1]。然后您可以检查 user_input[:2] 是否等于 'go'，然后从那里继续。

希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T23:10:06.290

而是尝试使用：

```
direction = sys.stdin.readlines() 
```

完成后可能需要您按 ctrl+D，但您将能够捕获更多内容。

此外，要获得子数组，您甚至可以检查：

```
direction[:2] != "go" 
```

或者，对于更具可读性的代码：

```
if not direction.startswith("go"): 
```

我还建议，为了使您的代码更具可读性，

```
defined_direction = frozenset(["quit", "go north", "go south"])
if( direction not in defined_direction):
   print "please enter...." 
```

# listview - 在动态列表视图中显示选中的项目

> ID：15753377
> 
> 赞同：0
> 
> 时间：2013-04-01T23:00:30.610
> 
> 标签：listview, jquery-mobile, selection

我有一个从 ajax 调用填充的列表视图。列表中的项目设置为调用 js 函数 onclick，该函数将更新页面上的另一个列表视图。我想保持第一个列表视图的选定项目的突出显示状态，直到用户选择列表中的另一个项目。我尝试将单击处理程序添加到列表项的锚点`('li a:first')`并将我的主题的 ui-btn-down 类添加到 li 但这在我的 iPad 上不起作用。我希望有一个聪明的方法来做到这一点，我太累了，无法想到。

任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T05:04:27.043

昨天有一个类似的问题，我给出了如下解决方案。

```
$('#listAddr li').bind('click', function () {
    $('#listAddr li').attr("data-theme", "c").removeClass("ui-btn-up-b").removeClass('ui-btn-hover-b').addClass("ui-btn-up-c").addClass('ui-btn-hover-c');
    $(this).attr("data-theme", "b").removeClass("ui-btn-up-c").removeClass('ui-btn-hover-c').addClass("ui-btn-up-b").addClass('ui-btn-hover-b');
}); 
```

基本上它改变了主题并删除/添加了相关类。

您可以查看有关此的示例`**[Live fiddle](http://jsfiddle.net/mayooresan/hJYSL/)**`

# android - 如何将 onMarkerClickListener 的 onMarkerClick 的默认功能更改为其他功能

> ID：15753381
> 
> 赞同：0
> 
> 时间：2013-04-01T23:00:48.720
> 
> 标签：android, google-maps-android-api-2

当我点击地图上的标记时，我想显示一个对话框。但它不工作。发生的事情是相机只移动到屏幕的中心，这是默认的事情。但是我重写了该方法并返回了true！为什么我不明白？

```
 @Override
        public boolean onMarkerClick(Marker marker) {
            // TODO Auto-generated method stub
        if( (marker.getId()).equals(savedMarkerId)){

            AlertDialog.Builder builder1 = new AlertDialog.Builder(MainActivity.this);
            builder1.setMessage("hello there!!")
                   .setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int id) {                                   
                       }
                   });                         
           builder1.create();
           builder1.show();

        }
            return true;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-06T17:10:43.867

builder.create() 返回您要在下一步中显示的 Alertdialog

```
AlertDialog alert11 = builder1.create();
alert11.show(); 
```

# git - 有没有办法限制本地 git repo 上用户的推送访问？

> ID：15753382
> 
> 赞同：0
> 
> 时间：2013-04-01T23:00:52.260
> 
> 标签：git, authorization, gerrit

在当前的工作流程中，我们有一个中心化的 git 存储库。这个 git repo 应该是“有福的”，其中代码经过大量 QA 和 Verfied。这意味着不允许任何开发人员推送到这个祝福的仓库，唯一被允许推送到这个祝福的仓库的实体是 Gerrit。我将 Gerrit 视为看门人，但从安全方面来看，开发人员可以绕过这一点并直接推送到受祝福的 repo。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:18:52.217

永远不要相信那些邪恶的开发者！他们到处推送代码。;-)

[git-scm 页面](http://git-scm.com/)非常广泛地解释了如何通过git 挂钩[使用 ACL 强制访问。](http://git-scm.com/book/en/Customizing-Git-An-Example-Git-Enforced-Policy)

# javascript - jQuery 事件仅在加载整个 DOM 时起作用

> ID：15753387
> 
> 赞同：-1
> 
> 时间：2013-04-01T23:01:31.067
> 
> 标签：javascript, jquery, dom, requirejs, single-page-application

我有一组 jQuery 事件，我想在加载它**自己的**DOM 对象时执行，例如：

```
 $("#div1").on('click',function(){ /* Stuff one*/ }); //#div 1 must exist
 $(".div2").on('click',function(){ /* Stuff two */}); //all objects with div 2 class must exist 
```

下一个代码有效，尽管整个 DOM 太大（它是一个[SPA 网站](http://en.wikipedia.org/wiki/Single-page_application)）并且需要等待一段时间：

```
$(function(){
     $("#div1").on('click',function(){ /* Stuff one*/ }); //#div 1 must exist
     $(".div2").on('click',function(){ /* Stuff two */});  //all objects with div 2 class must exist
}); 
```

我想试试这段代码，但[事件 .load() 已从 jQuery 1.8 中弃用](http://api.jquery.com/load-event/)：

```
$("#div1").on('load',function(){
  $(this).bind('click',function(){ /* Stuff one*/ }); //#div 1 must exist
}
$("#div2").on('load',function(){
  $(this).bind('click',function(){ /* Stuff two*/ }); //all objects with div 2 class must exist
} 
```

请问有谁知道如何使用未弃用的代码来产生相同的效果？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:08:47.187

您始终可以使用原生并`script`在要加载的 DOM 的每个部分之后插入您的元素。如果`script`元素位于您即将被操作的 DOM 之后，那么您可以确定在页面的该点之前的所有 DOM 都已经构建并运行。

您也可以使用事件委托并将处理程序附加到您的文档中，尽管我不建议这样做，特别是如果它是一个反复出现的问题。文档上的委托事件过多会影响性能。

根据我们在评论中的对话，您的代码可能类似于：

```
<body>
    <!-- HTML to be manipulated -->
    <script>
        require(['my-script'], function(myScript) {
            myScript.init(); // initialize DOM manipulation and attach event handlers
        });
    </script>
    <!-- More HTML -->
</body> 
```

我的脚本.js：

```
define(function(require, exports, module) {
    // Your code..
    exports.init = function() {
        // Initialize DOM
    };
    // Your code..
}); 
```

# python - 如何模拟请求和响应？

> ID：15753390
> 
> 赞同：310
> 
> 时间：2013-04-01T23:01:53.710
> 
> 标签：python, mocking, request

我正在尝试使用[Pythons 模拟包](http://www.voidspace.org.uk/python/mock)来模拟 Pythons`requests`模块。让我在以下情况下工作的基本电话是什么？

在我的views.py 中，我有一个函数可以进行各种requests.get() 调用，每次都有不同的响应

```
def myview(request):
  res1 = requests.get('aurl')
  res2 = request.get('burl')
  res3 = request.get('curl') 
```

在我的测试类中，我想做这样的事情，但无法弄清楚确切的方法调用

第1步：

```
# Mock the requests module
# when mockedRequests.get('aurl') is called then return 'a response'
# when mockedRequests.get('burl') is called then return 'b response'
# when mockedRequests.get('curl') is called then return 'c response' 
```

第2步：

呼唤我的观点

第 3 步：

验证响应包含“a 响应”、“b 响应”、“c 响应”

如何完成第 1 步（模拟请求模块）？

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2015-02-13T20:00:50.960

这是你可以做到的（你可以按原样运行这个文件）：

```
import requests
import unittest
from unittest import mock

# This is the class we want to test
class MyGreatClass:
    def fetch_json(self, url):
        response = requests.get(url)
        return response.json()

# This method will be used by the mock to replace requests.get
def mocked_requests_get(*args, **kwargs):
    class MockResponse:
        def __init__(self, json_data, status_code):
            self.json_data = json_data
            self.status_code = status_code

        def json(self):
            return self.json_data

    if args[0] == 'http://someurl.com/test.json':
        return MockResponse({"key1": "value1"}, 200)
    elif args[0] == 'http://someotherurl.com/anothertest.json':
        return MockResponse({"key2": "value2"}, 200)

    return MockResponse(None, 404)

# Our test case class
class MyGreatClassTestCase(unittest.TestCase):

    # We patch 'requests.get' with our own method. The mock object is passed in to our test case method.
    @mock.patch('requests.get', side_effect=mocked_requests_get)
    def test_fetch(self, mock_get):
        # Assert requests.get calls
        mgc = MyGreatClass()
        json_data = mgc.fetch_json('http://someurl.com/test.json')
        self.assertEqual(json_data, {"key1": "value1"})
        json_data = mgc.fetch_json('http://someotherurl.com/anothertest.json')
        self.assertEqual(json_data, {"key2": "value2"})
        json_data = mgc.fetch_json('http://nonexistenturl.com/cantfindme.json')
        self.assertIsNone(json_data)

        # We can even assert that our mocked method was called with the right parameters
        self.assertIn(mock.call('http://someurl.com/test.json'), mock_get.call_args_list)
        self.assertIn(mock.call('http://someotherurl.com/anothertest.json'), mock_get.call_args_list)

        self.assertEqual(len(mock_get.call_args_list), 3)

if __name__ == '__main__':
    unittest.main() 
```

**重要提示：**如果您的`MyGreatClass`课程位于不同的包中，例如`my.great.package`，您必须模拟`my.great.package.requests.get`而不是仅仅 'request.get'。在这种情况下，您的测试用例将如下所示：

```
import unittest
from unittest import mock
from my.great.package import MyGreatClass

# This method will be used by the mock to replace requests.get
def mocked_requests_get(*args, **kwargs):
    # Same as above

class MyGreatClassTestCase(unittest.TestCase):

    # Now we must patch 'my.great.package.requests.get'
    @mock.patch('my.great.package.requests.get', side_effect=mocked_requests_get)
    def test_fetch(self, mock_get):
        # Same as above

if __name__ == '__main__':
    unittest.main() 
```

享受！

* * *

## 回答 #2

> 赞同：209
> 
> 时间：2014-05-28T14:29:26.087

尝试使用[响应库](https://github.com/getsentry/responses)。这是[他们文档](https://github.com/getsentry/responses#basics)中的一个示例：

```
import responses
import requests

@responses.activate
def test_simple():
    responses.add(responses.GET, 'http://twitter.com/api/1/foobar',
                  json={'error': 'not found'}, status=404)

    resp = requests.get('http://twitter.com/api/1/foobar')

    assert resp.json() == {"error": "not found"}

    assert len(responses.calls) == 1
    assert responses.calls[0].request.url == 'http://twitter.com/api/1/foobar'
    assert responses.calls[0].response.text == '{"error": "not found"}' 
```

它为自己设置所有模拟提供了相当不错的便利。

还有[HTTPretty](https://github.com/gabrielfalcao/HTTPretty)：

它不是特定于`requests`库的，在某些方面更强大，尽管我发现它不适合检查它拦截的请求，这`responses`很容易

还有[httmock](https://github.com/patrys/httmock)。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2013-04-02T21:56:26.500

这对我有用：

```
import mock
@mock.patch('requests.get', mock.Mock(side_effect = lambda k:{'aurl': 'a response', 'burl' : 'b response'}.get(k, 'unhandled request %s'%k))) 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2015-05-08T20:43:22.237

我使用[requests-mock](http://requests-mock.readthedocs.org/en/latest/matching.html#simple)为单独的模块编写测试：

```
# module.py
import requests

class A():

    def get_response(self, url):
        response = requests.get(url)
        return response.text 
```

和测试：

```
# tests.py
import requests_mock
import unittest

from module import A

class TestAPI(unittest.TestCase):

    @requests_mock.mock()
    def test_get_response(self, m):
        a = A()
        m.get('http://aurl.com', text='a response')
        self.assertEqual(a.get_response('http://aurl.com'), 'a response')
        m.get('http://burl.com', text='b response')
        self.assertEqual(a.get_response('http://burl.com'), 'b response')
        m.get('http://curl.com', text='c response')
        self.assertEqual(a.get_response('http://curl.com'), 'c response')

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2017-02-17T23:02:59.223

这就是您模拟 requests.post 的方式，将其更改为您的 http 方法

```
@patch.object(requests, 'post')
def your_test_method(self, mockpost):
    mockresponse = Mock()
    mockpost.return_value = mockresponse
    mockresponse.text = 'mock return'

    #call your target method now 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2020-12-24T11:38:26.327

这是一个带有请求响应类的解决方案。恕我直言，它更干净。

```
import json
from unittest.mock import patch
from requests.models import Response

def mocked_request_get(*args, **kwargs):
    response_content = None
    request_url = kwargs.get('url', None)
    if request_url == 'aurl':
        response_content = json.dumps('a response')
    elif request_url == 'burl':
        response_content = json.dumps('b response')
    elif request_url == 'curl':
        response_content = json.dumps('c response')
    response = Response()
    response.status_code = 200
    response._content = str.encode(response_content)
    return response

@mock.patch('requests.get', side_effect=mocked_requests_get)
def test_fetch(self, mock_get):
     response = requests.get(url='aurl')
     assert ... 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-11-24T17:07:53.327

我从[Johannes Farhenkrug](https://stackoverflow.com/users/171933/johannes-fahrenkrug)的答案[开始](https://stackoverflow.com/a/28507806/3559967)，它对我很有用。我需要模拟 requests 库，因为我的目标是隔离我的应用程序而不是测试任何第三方资源。

然后我阅读了更多关于 python 的[Mock](https://docs.python.org/3/library/unittest.mock.html)库的信息，我意识到我可以用 python Mock 类替换 MockResponse 类，你可能称之为“Test Double”或“Fake”。

这样做的好处是可以访问诸如 等之类`assert_called_with`的东西`call_args`。不需要额外的库。诸如“可读性”或“更 Pythonic”之类的其他好处是主观的，因此它们可能对您起作用，也可能不会起作用。

这是我的版本，使用 python 的 Mock 而不是测试替身进行了更新：

```
import json
import requests
from unittest import mock

# defube stubs
AUTH_TOKEN = '{"prop": "value"}'
LIST_OF_WIDGETS = '{"widgets": ["widget1", "widget2"]}'
PURCHASED_WIDGETS = '{"widgets": ["purchased_widget"]}'

# exception class when an unknown URL is mocked
class MockNotSupported(Exception):
  pass

# factory method that cranks out the Mocks
def mock_requests_factory(response_stub: str, status_code: int = 200):
    return mock.Mock(**{
        'json.return_value': json.loads(response_stub),
        'text.return_value': response_stub,
        'status_code': status_code,
        'ok': status_code == 200
    })

# side effect mock function
def mock_requests_post(*args, **kwargs):
    if args[0].endswith('/api/v1/get_auth_token'):
        return mock_requests_factory(AUTH_TOKEN)
    elif args[0].endswith('/api/v1/get_widgets'):
        return mock_requests_factory(LIST_OF_WIDGETS)
    elif args[0].endswith('/api/v1/purchased_widgets'):
        return mock_requests_factory(PURCHASED_WIDGETS)

    raise MockNotSupported

# patch requests.post and run tests
with mock.patch('requests.post') as requests_post_mock:
  requests_post_mock.side_effect = mock_requests_post
  response = requests.post('https://myserver/api/v1/get_widgets')
  assert response.ok is True
  assert response.status_code == 200
  assert 'widgets' in response.json()

  # now I can also do this
  requests_post_mock.assert_called_with('https://myserver/api/v1/get_widgets') 
```

Repl.it 链接：

[https://repl.it/@abkonsta/Using-unittestMock-for-requestspost#main.py](https://repl.it/@abkonsta/Using-unittestMock-for-requestspost#main.py)

[https://repl.it/@abkonsta/Using-test-double-for-requestspost#main.py](https://repl.it/@abkonsta/Using-test-double-for-requestspost#main.py)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-03-31T18:37:51.350

如果你想模拟一个假响应，另一种方法是简单地实例化一个基础 HttpResponse 类的实例，如下所示：

```
from django.http.response import HttpResponseBase

self.fake_response = HttpResponseBase() 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-09-12T17:43:04.307

解决请求的一种可能方法是使用库 betamax，它记录所有请求，然后如果您在相同的 url 中使用相同的参数发出请求，betamax 将使用记录的请求，我一直在使用它来测试网络爬虫它为我节省了很多时间。

```
import os

import requests
from betamax import Betamax
from betamax_serializers import pretty_json

WORKERS_DIR = os.path.dirname(os.path.abspath(__file__))
CASSETTES_DIR = os.path.join(WORKERS_DIR, u'resources', u'cassettes')
MATCH_REQUESTS_ON = [u'method', u'uri', u'path', u'query']

Betamax.register_serializer(pretty_json.PrettyJSONSerializer)
with Betamax.configure() as config:
    config.cassette_library_dir = CASSETTES_DIR
    config.default_cassette_options[u'serialize_with'] = u'prettyjson'
    config.default_cassette_options[u'match_requests_on'] = MATCH_REQUESTS_ON
    config.default_cassette_options[u'preserve_exact_body_bytes'] = True

class WorkerCertidaoTRT2:
    session = requests.session()

    def make_request(self, input_json):
        with Betamax(self.session) as vcr:
            vcr.use_cassette(u'google')
            response = session.get('http://www.google.com') 
```

[https://betamax.readthedocs.io/en/latest/](https://betamax.readthedocs.io/en/latest/)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2021-07-25T19:45:12.700

这对我有用，虽然我还没有做太多复杂的测试。

```
import json
from requests import Response

class MockResponse(Response):
    def __init__(self,
                 url='http://example.com',
                 headers={'Content-Type':'text/html; charset=UTF-8'},
                 status_code=200,
                 reason = 'Success',
                 _content = 'Some html goes here',
                 json_ = None,
                 encoding='UTF-8'
                 ):
    self.url = url
    self.headers = headers
    if json_ and headers['Content-Type'] == 'application/json':
        self._content = json.dumps(json_).encode(encoding)
    else:
        self._content = _content.encode(encoding)

    self.status_code = status_code
    self.reason = reason
    self.encoding = encoding 
```

然后您可以创建响应：

```
mock_response = MockResponse(
    headers={'Content-Type' :'application/json'},
    status_code=401,
    json_={'success': False},
    reason='Unauthorized'
)
mock_response.raise_for_status() 
```

给

```
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://example.com 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2022-01-10T16:16:48.537

你可以使用[requests-mock](https://requests-mock.readthedocs.io/en/latest/mocker.html)代替吗？

假设你的 myview 函数取而代之的是一个`requests.Session`对象，用它发出请求，并对输出做一些事情：

```
# mypackage.py
def myview(session):
    res1 = session.get("http://aurl")
    res2 = session.get("http://burl")
    res3 = session.get("http://curl")
    return f"{res1.text}, {res2.text}, {res3.text}" 
```

```
# test_myview.py
from mypackage import myview
import requests

def test_myview(requests_mock):
    # set up requests
    a_req = requests_mock.get("http://aurl", text="a response")
    b_req = requests_mock.get("http://burl", text="b response")
    c_req = requests_mock.get("http://curl", text="c response")

    # test myview behaviour
    session = requests.Session()
    assert myview(session) == "a response, b response, c response"

    # check that requests weren't called repeatedly
    assert a_req.called_once
    assert b_req.called_once
    assert c_req.called_once
    assert requests_mock.call_count == 3 
```

您还可以`requests_mock`与 Pytest 以外的框架一起使用 - 文档很棒。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-05-06T15:21:54.893

我将添加此信息，因为我很难弄清楚如何模拟异步 api 调用。

这是我为模拟异步调用所做的。

这是我想测试的功能

```
async def get_user_info(headers, payload):
    return await httpx.AsyncClient().post(URI, json=payload, headers=headers) 
```

你仍然需要 MockResponse 类

```
class MockResponse:
    def __init__(self, json_data, status_code):
        self.json_data = json_data
        self.status_code = status_code

    def json(self):
        return self.json_data 
```

您添加 MockResponseAsync 类

```
class MockResponseAsync:
    def __init__(self, json_data, status_code):
        self.response = MockResponse(json_data, status_code)

    async def getResponse(self):
        return self.response 
```

这是测试。这里重要的是我之前创建了响应，因为**init**函数不能是异步的，并且对 getResponse 的调用是异步的，所以它全部被检查出来。

```
@pytest.mark.asyncio
@patch('httpx.AsyncClient')
async def test_get_user_info_valid(self, mock_post):
    """test_get_user_info_valid"""
    # Given
    token_bd = "abc"
    username = "bob"
    payload = {
        'USERNAME': username,
        'DBNAME': 'TEST'
    }
    headers = {
        'Authorization': 'Bearer ' + token_bd,
        'Content-Type': 'application/json'
    }
    async_response = MockResponseAsync("", 200)
    mock_post.return_value.post.return_value = async_response.getResponse()

    # When
    await api_bd.get_user_info(headers, payload)

    # Then
    mock_post.return_value.post.assert_called_once_with(
        URI, json=payload, headers=headers) 
```

如果你有更好的方法告诉我，但我认为这样很干净。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-10-25T10:48:47.393

迄今为止最简单的方法：

```
from unittest import TestCase
from unittest.mock import Mock, patch

from .utils import method_foo

class TestFoo(TestCase):

    @patch.object(utils_requests, "post")  # change to desired method here
    def test_foo(self, mock_requests_post):
        # EXPLANATION: mocked 'post' method above will return some built-in mock, 
        # and its method 'json' will return mock 'mock_data',
        # which got argument 'return_value' with our data to be returned
        mock_data = Mock(return_value=[{"id": 1}, {"id": 2}])
        mock_requests_post.return_value.json = mock_data

        method_foo()

        # TODO: asserts here

"""
Example of method that you can test in utils.py
"""
def method_foo():
    response = requests.post("http://example.com")
    records = response.json()
    for record in records:
        print(record.get("id"))
        # do other stuff here 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-12-27T22:31:36.883

只是对那些仍在苦苦挣扎的人的有用提示，从 urllib 或 urllib2/urllib3 转换为请求并尝试模拟响应 - 我在实现模拟时遇到了一个稍微令人困惑的错误：

`with requests.get(path, auth=HTTPBasicAuth('user', 'pass'), verify=False) as url:`

> 属性错误：__enter__

好吧，当然，如果我对`with`工作原理有所了解（我不知道），我会知道这是一个退化的、不必要的[上下文](https://www.python.org/dev/peps/pep-0343/)（来自[PEP 343](https://www.python.org/dev/peps/pep-0343/)）。[使用 requests 库时是不必要的，因为它在后台为您做的](https://github.com/requests/requests/blob/5c1f72e80a7d7ac129631ea5b0c34c7876bc6ed7/requests/api.py#L59)事情基本相同。只需删除`with`并使用 bare`requests.get(...)`和[Bob's your uncle](https://english.stackexchange.com/questions/20346/bobs-your-uncle-no-hes-not)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-04-16T02:39:01.720

对于 pytest 用户，有一个来自[https://pypi.org/project/pytest-responsemock/的便利装置](https://pypi.org/project/pytest-responsemock/)

例如模拟 GET 到[http://some.domain](http://some.domain)你可以：

```
def test_me(response_mock):

    with response_mock('GET http://some.domain -> 200 :Nice'):
        response = send_request()
        assert result.ok
        assert result.content == b'Nice' 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-10T21:29:44.033

对于那些不想为**pytest**安装额外库的人，[有](https://docs.pytest.org/en/latest/how-to/monkeypatch.html?highlight=mock#monkeypatching-returned-objects-building-mock-classes)一个例子。根据上面的示例，我将在此处复制它并添加一些扩展名：

```
import datetime

import requests

class MockResponse:
    def __init__(self, json_data, status_code):
        self.json_data = json_data
        self.status_code = status_code
        self.elapsed = datetime.timedelta(seconds=1)

    # mock json() method always returns a specific testing dictionary
    def json(self):
        return self.json_data

def test_get_json(monkeypatch):
    # Any arguments may be passed and mock_get() will always return our
    # mocked object, which only has the .json() method.
    def mock_get(*args, **kwargs):
        return MockResponse({'mock_key': 'mock_value'}, 418)

    # apply the monkeypatch for requests.get to mock_get
    monkeypatch.setattr(requests, 'get', mock_get)

    # app.get_json, which contains requests.get, uses the monkeypatch
    response = requests.get('https://fakeurl')
    response_json = response.json()

    assert response_json['mock_key'] == 'mock_value'
    assert response.status_code == 418
    assert response.elapsed.total_seconds() == 1

============================= test session starts ==============================
collecting ... collected 1 item

test_so.py::test_get_json PASSED                                          [100%]

============================== 1 passed in 0.07s =============================== 
```

# ant - 如果变量未定义，则任务失败

> ID：15753395
> 
> 赞同：2
> 
> 时间：2013-04-01T23:02:27.823
> 
> 标签：ant

如果未定义它使用的变量，我希望我的 Ant 任务失败。例如目前

`<mkdir dir="${some.dir}"/>`

总是成功，如果`some.dir`被定义，它会在变量的值下创建一个目录，如果不是，它会创建一个名为字面意思的目录`${some.dir}`。

有没有办法以及如何在 Ant 中当前宽松和更严格的变量解析模式之间切换？我在 Eclipse 中运行它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T03:07:16.210

```
<fail unless="some.dir"/>

<mkdir dir="${some.dir}"/> 
```

或者

```
<fail>
    <condition>
        <not>
            <isset property="some.dir"/>
        </not>
    </condition>
</fail>

<mkdir dir="${some.dir}"/> 
```

# css - 使用 column-count 和 column-gap (CSS3) 时，Safari Mobile 上的文本会被裁剪

> ID：15753402
> 
> 赞同：1
> 
> 时间：2013-04-01T23:03:09.010
> 
> 标签：css, mobile-safari, multiple-columns, column-width

这是我正在使用的代码：

```
<ul>
<li>TEXT<br>TEXT</li>
<li>TEXT<br>TEXT</li>
<li>TEXT<br>TEXT</li>
</ul>

ul {
    -webkit-column-count: 3;
    -webkit-column-gap: 90px;
    column-count: 3;
    column-gap: 90px;
    -moz-column-count: 3;
    -moz-column-gap: 90px;
} 
```

问题是使用 Safari Mobile 后的文本`<br>`被裁剪（其他浏览器没有问题.. 好吧，对于 IE < 10，我使用了肮脏的 hack，但我不在乎）。这是您可以重现该问题的页面：http: [//goo.gl/ojWx9](http://goo.gl/ojWx9)

这是来自 Safari Mobile 的截图： ![来自 Safari iOS 的屏幕截图](https://i.stack.imgur.com/NqoZ0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T15:01:02.273

大的列间隙加上“空白：nowrap”导致内容超出列。这会导致 Mobile Safari 中的剪辑错误。

您需要减小列间距大小以适应文本或允许换行符来解决问题。

# mysql - mysql查询的基数违规

> ID：15753404
> 
> 赞同：8
> 
> 时间：2013-04-01T23:03:23.433
> 
> 标签：mysql, sql

我在此查询中遇到错误：

```
SELECT i.name, i.surname, (SELECT u.username FROM user u WHERE u.info_id IN (1,9,10,15,25,40,42,43,44)) as email FROM `userinfo` i WHERE i.id IN (1,9,10,15,25,40,42,43,44) 
```

错误：

> 基数违规：1242 子查询返回多于 1 行

我知道这可以通过使用 JOIN 语句来解决，但我不知道如何解决。

为了进一步澄清我的问题，我有两个表，用户和用户信息：

*用户*

```
id info_id username 
```

*用户信息*

```
id name surname 
```

来自的 info_id 行`user`与 的 id 相关`userinfo`，因此有一个以这种格式 (1,4,7,8,9) 的 userinfo id 列表，我希望 name 和 surname (from `userinfo`) 和用户名`user`与 info_id 匹配

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-01T23:12:13.920

您需要在相关子查询中指定两个表之间的关系，

```
SELECT  i.name, 
        i.surname, 
        (
            SELECT  u.username 
            FROM    user u 
            WHERE   u.info_id = i.id) as email 
FROM    userinfo i 
WHERE   i.id IN (1,9,10,15,25,40,42,43,44) 
```

并通过使用`JOIN`（*我更喜欢*）

```
SELECT  i.name, 
        i.surname, 
        u.username as Email
FROM    userinfo i 
        INNER JOIN user u 
            ON u.info_id = i.id
WHERE   i.id IN (1,9,10,15,25,40,42,43,44) 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T23:12:42.287

您只能在字段列表中返回一行。您似乎想对结果进行分组。

```
SELECT
    i.name, i.surname,
    GROUP_CONCAT(u.username) AS email
FROM
    userinfo i
    JOIN user u ON (i.id = u.info_id)
WHERE
    i.id IN (1,9,10,15,25,40,42,43,44)
GROUP BY
    i.id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T23:12:27.460

```
SELECT i.name, i.surname, u.username as email 
FROM `userinfo` i 
     INNER JOIN
     `user` u ON i.info_id=u.id
WHERE i.id IN (1,9,10,15,25,40,42,43,44) 
```

学习使用连接，没有它们，您将双手绑在背后并蒙住眼睛。连接是如何使用关系数据库的关系部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T23:15:43.163

你的意思是：

```
SELECT i.name, i.surname, (SELECT u.username FROM user u WHERE u.id IN (1,9,10,15,25,40,42,43,44)) as email

FROM `userinfo` i

WHERE i.id IN (1,9,10,15,25,40,42,43,44) 
```

# regex - 文章（a/an/the）和数字（1-4 位）之间的正则表达式短语

> ID：15753409
> 
> 赞同：0
> 
> 时间：2013-04-01T23:03:37.607
> 
> 标签：regex, bash, sed, awk, grep

我已经尝试了几十种正则表达式的排列来解决这个问题，但我没有遇到任何运气。

我需要遍历数十个文件，在“the/a/an”和可能数字为 1-4 的数字之间提取特定短语，忽略标点符号，例如 {}()[]。

**例子**

> 敏捷的棕色狐狸 {15} 以某种方式跳过懒狗 [20] 4，这绝对不适合所有观众 (0012)。

*应该返回：*

> 快速棕色狐狸 15
> 
> 懒狗 20
> 
> 某种方式 4
> 
> 观众0012

消除标点符号不是问题：`sed 's/[][{}()]//g'`

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:39:00.250

在 GNU awk 中，您可以将输入拆分为以数字结尾的记录，这些记录可选地用标点符号包围：

```
$ cat file
The quick brown fox {15} jumps over the lazy dog [20] in a certain way 4 that is definitely not appropriate for all of the viewers (0012).

$ gawk -v RS='[[:punct:]]*[[:digit:]]+[[:punct:]]*' 'RT{print $0 RT}' file
The quick brown fox {15}
 jumps over the lazy dog [20]
 in a certain way 4
 that is definitely not appropriate for all of the viewers (0012). 
```

然后您需要做的就是打印您想要的记录部分和记录终止符：

```
$ gawk -v RS='[[:punct:]]*[[:digit:]]+[[:punct:]]*' 'RT{print gensub(/.*\y(the|a|an)\y/,"\\1","") gensub(/[[:punct:]]/,"","g",RT)}' file
The quick brown fox 15
the lazy dog 20
a certain way 4
the viewers 0012 
```

我刚刚注意到，在您的示例中，您将输出转换为全部小写。只需`$0=tolower($0)`在 print 之前添加一个 in 即可（也解决了`the|a|an`比较不区分大小写的问题）：

```
$ gawk -v RS='[[:punct:]]*[[:digit:]]+[[:punct:]]*' 'RT{$0=tolower($0); print gensub(/.*\y(the|a|an)\y/,"\\1","") gensub(/[[:punct:]]/,"","g",RT)}' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T08:50:16.473

纯 Bash 和使用正则表达式的练习：

```
while read line ; do
  line=" $line"                                 # add leading space as word boundary

  while [ -n "$line" ] ; do
    [[ "$line" =~ [[:space:]]((an|a|the|An|A|The)([[:space:]]+[^[:digit:]]+)([[:digit:]]{1,4}))(.+$) ]]

    match="${BASH_REMATCH[2]}${BASH_REMATCH[3]}${BASH_REMATCH[4]}"
    match=${match//[()\[\]\{\}]/}               # remove parentheses
    [ -n "$match" ] && echo "'$match'"          # print if not empty

    line="${BASH_REMATCH[5]}"                   # the postmatch
  done
done < "$infile" 
```

输出：

```
'The quick brown fox 15'
'the lazy dog 20'
'a certain way 4'
'the viewers 0012' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:10:12.023

```
grep -ioP "(a|an|the).*?\d{1,4}" files 
```

将`-o`仅打印匹配的文本，并且每个匹配项都在其自己的行上。 `-P`用于不情愿的量词，也使正则表达式自动扩展。您当然可以`sed`按照上面的建议将此输出通过管道传输到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T15:16:15.907

这可能对您有用（GNU sed）：

```
sed -r '/\b(the|an|a)\b/I!d;s//\n&/;s/[^\n]*\n//;s/\{([0-9]{1,4})\}|\(([0-9]{1,4})\)|\[([0-9]{1,4})\]|\b([0-9]{1,4})\b/\1\2\3\4\n/;P;D' file 
```

# vba - MS Excel：在一行混合内容中查找最早日期

> ID：15753410
> 
> 赞同：0
> 
> 时间：2013-04-01T23:03:37.973
> 
> 标签：vba, excel, excel-formula

有谁知道如何在 Microsoft Excel 中连续获取最早的日期。每行上没有可预测的列数，并且除了日期之外还有一些值需要忽略。可以使用 Excel 公式或 VBA 来完成。

有没有人有什么建议？

现在我正在使用这个快速而肮脏的 VBA 函数，但是当我加载新的输入数据（大约 200 行乘 100 列）时，出现了一个消息框，说 Excel 没有足够的资源来处理我的更改。

```
' returns smallest date on row
Public Function getSmallestDateFromRow(r As Integer, sheetName As String) As Date
    Dim toReturn As Date
    Dim rng As Range
    Dim scanToColumn As Integer
    Dim c As Integer
    Dim tmp As Variant

    Set rng = Sheets(sheetName).Cells.Find("*", [a1], , , xlByColumns, xlPrevious) 'is this inefficient?
    scanToColumn = rng.Column
    toReturn = #12/12/2100#

    For c = 1 To scanToColumn
        tmp = Sheets(sheetName).Cells(r, c).Value
        If (IsDate(tmp)) Then
            If (toReturn = Null) Then
                toReturn = tmp
            ElseIf (toReturn > tmp) Then
                toReturn = tmp
            End If
        End If
    Next c

    If (toReturn = #12/12/2100#) Then
       toReturn = 0
    End If

    getSmallestDateFromRow = toReturn
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:21:53.993

您必须记住 Excel（和许多其他 Microsoft 产品）将日期存储为浮点数：

*   整数部分是自 1900 年 1 月 1 日以来经过的天数（例如：1 相当于 1/1/1900）
*   小数部分是过去一天的“分数”（例如：0.5 相当于下午 12:00）

然后，关于如何找到最小或最大日期值的问题被您的行中可能有许多其他数字的事实所混淆。因此，您必须首先为日期定义一个“有效排名”。之后，一个简单的“数组公式”就可以解决问题：

**例子。**假设您的有效范围在 2000 年 1 月 1 日到 2100 年 12 月 31 日之间。那么您的有效“数字排名”是：

*   2000 年 1 月 1 日相当于 36526
*   12/31/2100 相当于 73415

现在您可以编写函数来跟踪此范围内的最小日期值：

```
function trackMinimum(rowRange as range) as date
    on error resume next
    dim j as integer, minValue as date
    dim t0 as double, t1 as double
    dim ans as date

    t0 = cdbl(dateserial(2000,1,1))
    t1 = cdbl(dateserial(2100,12,31))
    ans = 0
    for j = 1 to rowRange.columns.count
        if ans = 0 then ' You need to store the first valid value
            if rowRange.cells(1,j).value >= t0 and rowRange.cells(1,j) <= t1 then
                ans = rowRange.cells(1,j).value
            end if
        else
            if (rowRange.cells(1,j).value >= t0 and rowRange.cells(1,j) <= t1) _ 
               and rowRange.cells.value < ans then
                ans = rowRange.cells(1,j).value
            end if
        end if
    next j
    trackMinimum = ans
end function 
```

当然，我假设`rowRange`参数是单行范围。

希望这可以帮助你

* * *

顺便说一句，该`isDate()`函数不是“故障安全”：它必须采用有效的表达式（文本）来检测它是否是日期，这可能取决于格式。也就是说，您可能更喜欢使用`isDate(.cells(r,c).Text)' instead of`.value `, since the`Value` 属性，它可能会返回一个可以被评估为“不是日期”的双精度值或浮点值。

# sql - 在存储过程中缓存动态 sql

> ID：15753412
> 
> 赞同：1
> 
> 时间：2013-04-01T23:03:44.600
> 
> 标签：sql, sql-server, tsql

我在存储过程中有动态 SQL，它创建动态表并插入数据。我的问题是，这个查询计划是否会被缓存。

这是我当前如何在存储过程中构建动态 SQL 的简单示例。

```
CREATE PROCEDURE [dbo].[GetOrders] 
@CustID AS INT
AS 

BEGIN

DECLARE @SQL NVARCHAR(MAX) 

DECLARE @TableName AS VARCHAR(500)

    SET @TableName = CONVERT(VARCHAR(255), NEWID())

    SET @SQL = 'CREATE TABLE [dbo].[' + @TableName + ']
(
  [OrderID] [int] NOT NULL
) '

    EXEC sp_executesql @SQL

    SET @SQL = 'insert [dbo].[' + @TableName + '](OrderID) 
            select OrderID from dbo.Orders where CustomerID=@CustID'

    EXEC sp_executesql @SQL, N'@CustID INT', @CustID = @CustID

 END
 GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:20:06.940

是的，这个查询计划将被缓存。您可以通过运行代码然后立即运行此查询来看到这一点：

```
SELECT *
FROM sys.dm_exec_query_stats s
CROSS APPLY sys.dm_exec_query_plan(s.plan_handle) qp
WHERE creation_time >= DATEADD(SECOND, -10, GETDATE()) 
```

由于您每次都基于 NEWID() 创建一个新表，因此您每次都会获得一个单独的计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:22:08.603

是的，执行计划将在第一次执行时创建并缓存在内存（而不是磁盘）中。当您为每个查询创建一个新表时，我认为该计划不会被重用，但我尚未对此进行测试。

存储过程计划缓存在内存中而不是磁盘上的事实意味着它会在服务器重新启动时或由于低重用率而从缓存中消失。如果过程所依赖的数据变化到足以导致统计信息失效，它也可能会从缓存中掉出来。这会导致 SQL Server 使计划无效。

您可以检查使用以下查询创建的执行计划：

```
SELECT sc.*
FROM master.dbo.syscacheobjects AS sc
WHERE sc.cacheobjtype = 'Executable Plan' 
```

# android - Android让Toast先于Thread.sleep // Systemclock.sleep

> ID：15753413
> 
> 赞同：2
> 
> 时间：2013-04-01T23:03:51.210
> 
> 标签：android, sleep

我想让 Toast 出现，然后让 sleep 运行。

如果我这样做，吐司会在睡眠后出现，但我希望它反过来。有人有建议吗？这是我的代码

```
switch (checkedRadioButton) {
                  case R.id.radio0 : radioButtonSelected = "radiobutton1";
                  Toast.makeText(getApplicationContext(), "text", Toast.LENGTH_LONG).show();
                  vd.vibrate(100);        
                  android.os.SystemClock.sleep(1000);         
                  vd.vibrate(100); 
```

到目前为止谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:12:47.083

toast 的显示是一个异步的（即不是阻塞调用）操作，意味着一旦执行了 toast 请求，操作系统就跳转到下一个操作，同时准备并显示 toast。

要获得您的默认行为，您应该在延迟几秒钟后执行线程睡眠调用。为此使用 a`Handler`及其**postDelay**方法。

延迟时间应该是这样的：

```
LONG_DELAY = 3500;  // 3.5 seconds
SHORT_DELAY = 2000; // 2 seconds 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-16T09:35:45.607

尝试使用 AsyncTask 类。按原样编写此代码。不需要取类 AsyncTask 的变量名。

```
 new AsyncTask<Void, Void, Void>() {

           @Override
           protected void onPostExecute(Void result) {
               Toast toast2 = Toast.makeText(context, "Task completed",
                       Toast.LENGTH_SHORT);
               toast2.show();

           }

           @Override
           protected void onPreExecute() {
               Toast.makeText(getApplicationContext(), "here is your text before Sleep", Toast.LENGTH_LONG).show();
           }

           @Override
           protected Void doInBackground(Void... voids) {

                   try {

                       Thread.sleep(1000); // time in milisec 1000ms= 1sec

                   } catch (InterruptedException e) {
                       e.printStackTrace();
                   }

               return null;
           }

       }.execute(); 
```

# mysql - 跳过 mysqldump 中的版本检查注释

> ID：15753414
> 
> 赞同：4
> 
> 时间：2013-04-01T23:03:59.100
> 
> 标签：mysql, mysqldump

如何跳过 MySQL 转储中的版本检查注释。

```
/*!50003 ... */ ; 
```

我基本上希望 mysqldump 假设版本是相同的，因此是兼容的。

我想要这个的原因是我可以转储我的数据库的结构，并提交，并将其与其他时间点和其他环境进行比较。

目前它还在条件版本检查注释中包装存储过程、触发器和函数。我希望它只是将它们作为普通 SQL 输出（没有评论）。并完全删除条件`SET`语句。

我在这里看到了一个类似的问题，但是它没有回答我的问题：[如何在 MySQL 转储中删除这些评论？](https://stackoverflow.com/questions/1916392/how-can-i-get-rid-of-these-comments-in-a-mysql-dump)

我不打算执行 SQL。

并且在它上面做一个`grep`/`sed`也会删除触发器等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:23:37.007

要仅删除 SET 命令，请使用：

```
perl -pi.bak -e 's|^/\*!\d{5} SET .*;\s*$||g;' filename.sql 
```

要仅删除评论，请使用：

```
perl -pi.bak -e '
    s|/\*!\d{5} ([^\*]+)\*/|\1|g;
    s|\*/$||g;
    s|\*/\s*(;?;?)$|\1|g;
    s|/\*!\d{5} ||g;' filename.sql 
```

要删除两者，请使用：

```
perl -pi.bak -e '
    s|^/\*!\d{5} SET .*;\s*$||g;
    s|/\*!\d{5} ([^\*]+)\*/|\1|g;
    s|\*/$||g;
    s|\*/\s*(;?;?)$|\1|g;
    s|/\*!\d{5} ||g;' filename.sql 
```

# html - 什么是从屏幕阅读器隐藏图标的适当方法

> ID：15753418
> 
> 赞同：5
> 
> 时间：2013-04-01T23:04:17.863
> 
> 标签：html, accessibility, font-face, wai-aria, screen-readers

在我的 Web 应用程序中，我为自己制作了一个仅由图标组成的字体。我使用这些图标来补充应用程序中的标题和子标题，使其更具视觉吸引力。

然而，像 JAWS 这样的屏幕阅读器会读出这一点，这会给屏幕阅读器的用户带来不愉快的体验。

例如，角色`c`显示云的图像。我以这种方式使用它来补充例如标题，例如`<h1>`：

`<span class="my-font">c</span>`

现在我希望屏幕阅读器完全忽略这一点，因为这只是对现有标题的补充，而不是为页面上的内容添加任何新含义。通过我的研究，我发现了两种可能性：

`aria-hidden="true"`或者`role="presentation"`

我只是不确定其中哪一个（或两者都适合）适合我想要实现的目标。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T02:21:33.233

您应该使用该[`aria-hidden="true"`](http://www.w3.org/TR/wai-aria/states_and_properties#aria-hidden)属性，它说：

> 表示该元素及其所有后代对于作者实现的任何用户都是不可见或不可感知的。

这意味着该元素不应该被任何用户感知。所以使用：

```
<span class="my-font" aria-hidden="true">c</span> 
```

如果图标应该是一个链接或者不仅仅是为了装饰，我建议你附上一些文字，以便屏幕阅读器知道它是什么。您可以将文本移出屏幕，使其仅对屏幕阅读器可见。

**HTML**

```
<span>
    <span class="my-font" aria-hidden="true">c</span>
    <span class="screen-reader">About me</span>
</span> 
```

**CSS**

```
.screen-reader {
    position:absolute;
    top:-9999px;
    left:-9999px;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-03T19:01:55.900

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-06T19:27:36.180

While `aria-hidden="true"` works to hide the audible icon, it will still show up in the assistive technology's list of links and headings.

I'm still trying to find a way to hide them entirely, but it's tricky. To the OP, yes, `aria-hidden="true"` will hide them somewhat, but not entirely. Don't rely on it alone. Also, make sure you test with real users!

I came across this really good article: [http://pictos.cc/articles/using-icon-fonts/](http://pictos.cc/articles/using-icon-fonts/)

# c++ - Qt QML 数据模型似乎不适用于 C++

> ID：15753419
> 
> 赞同：4
> 
> 时间：2013-04-01T23:04:23.203
> 
> 标签：c++, qt, model-view-controller, qml, datamodel

我一直在使用[http://doc.qt.digia.com/4.7/qdeclarativemodels.html](http://doc.qt.digia.com/4.7/qdeclarativemodels.html)中的示例，这是 QML 声明性数据模型的 Qt 页面。特别是，我正在使用`objectlistmodel`Qt SDK 附带的示例（在示例/声明/模型视图/对象列表模型中）。[在我尝试将它与http://www.developer.nokia.com/Community/Wiki/How_to_create_a_Page_Control_component_in_QML](http://www.developer.nokia.com/Community/Wiki/How_to_create_a_Page_Control_component_in_QML)上的 QMLPageControl 示例结合起来之前，这一切似乎都运行得很好。

当我尝试使用这样的 QML ListView 显示基于 QML 的 ListModel（填充有 QML ListElements）时：

```
import QtQuick 1.0

Rectangle {
   width: 200; height: 200

   ListModel {
       id: qmlModel
       ListElement { name: "qml entry1 (red)"; colour: "red" }
       ListElement { name: "qml entry2 (orange)"; colour: "orange" }
       ListElement { name: "qml entry3 (yellow)"; colour: "yellow" }
       ListElement { name: "qml entry4 (green)"; colour: "green" }
       ListElement { name: "qml entry5 (blue)"; colour: "blue" }
       ListElement { name: "qml entry6 (purple)"; colour: "purple" }
   }

   ListView {

       id: list_view

       anchors.fill: parent
       model: qmlModel
       delegate: Rectangle {
           height: 20
           width: 200
           color: colour
           Text { text: name }

       }
    }
} 
```

...一切都很好。这完全按预期工作 - 弹出一个窗口，其中包含带状彩色背景的一些文本。

![显示 QML ListModel 的 ListView](https://i.stack.imgur.com/0F4NF.png)

然后，我可以做一些更复杂的事情，比如使用 PathView：

```
import QtQuick 1.0

Rectangle {
    width: 200; height: 200

    ListModel {
        id: qmlModel
        ListElement { name: "qml entry1 (red)"; colour: "red" }
        ListElement { name: "qml entry2 (orange)"; colour: "orange" }
        ListElement { name: "qml entry3 (yellow)"; colour: "yellow" }
        ListElement { name: "qml entry4 (green)"; colour: "green" }
        ListElement { name: "qml entry5 (blue)"; colour: "blue" }
        ListElement { name: "qml entry6 (purple)"; colour: "purple" }
    }

    //       ListView {
    //           id: list_view
    //           anchors.fill: parent
    //           model: qmlModel
    //           delegate: Rectangle {
    //               height: 20
    //               width: 200
    //               color: colour
    //               Text { text: name }
    //           }
    //       }

    PathView {
        id: my_path_view

        anchors.fill: parent

        Keys.onRightPressed: if (!moving && interactive) incrementCurrentIndex()
        Keys.onLeftPressed: if (!moving && interactive) decrementCurrentIndex()

        flickDeceleration: 500

        preferredHighlightBegin: 0.5
        preferredHighlightEnd: 0.5
        focus: true
        interactive: true
        model: qmlModel

        delegate: Rectangle {
            width: 100
            height: 100
            color: colour
            Text {
                anchors.centerIn: parent
                text: name
            }
        }

        path: Path {
            startX: - my_path_view.width * my_path_view.model.count / 2 + my_path_view.width / 2
            startY: my_path_view.height / 2
            PathLine {
                x: my_path_view.width * my_path_view.model.count / 2 + my_path_view.width / 2
                y: my_path_view.height / 2
            }
        }
    }
} 
```

同样，这一切都按预期工作 - 弹出一个窗口，其中包含可轻弹、可拖动的彩色框列表。

![显示 QML ListModel 的 PathView](https://i.stack.imgur.com/fDwNB.png)

![PathView 显示 QML ListModel，在运动中](https://i.stack.imgur.com/HwSIc.png)

备份，然后我可以像这样在 C++ 中定义一个数据对象：

数据对象.h

```
#ifndef DATAOBJECT_H
#define DATAOBJECT_H

#include <QObject>

class DataObject : public QObject
{
    Q_OBJECT

    Q_PROPERTY( QString name READ name WRITE setName NOTIFY nameChanged )
    Q_PROPERTY( QString colour READ colour WRITE setColour NOTIFY colourChanged )

public:
    DataObject( QObject * parent = 0 );
    DataObject( const QString &_name, const QString &_color, QObject * parent=0 );

    QString name() const;
    void setName(const QString &);

    QString colour() const;
    void setColour(const QString &);

signals:
    void nameChanged();
    void colourChanged();

private:
    QString m_name;
    QString m_colour;
};

#endif // DATAOBJECT_H 
```

数据对象.cpp

```
#include "dataobject.h"
#include <QDebug>

DataObject::DataObject( QObject * parent )
    : QObject( parent )
{
    qDebug() << "DataObject::DataObject() has been called.\n";

}

DataObject::DataObject( const QString &_name, const QString &_colour, QObject * parent )
    : QObject( parent )
    , m_name( _name )
    , m_colour( _colour )
{
    qDebug() << "DataObject::DataObject(name, color) has been called.\n";

}

QString DataObject::name() const {
    qDebug() << "name() has been called.\n";
    return m_name;
}

void DataObject::setName(const QString &name) {
    qDebug() << "setName has been called.\n";
    if ( name != m_name ) {
        m_name = name;
        emit nameChanged();
    }
}

QString DataObject::colour() const {
    qDebug() << "colour() has been called.\n";
    return m_colour;
}

void DataObject::setColour(const QString &colour) {
    qDebug() << "setColour has been called.\n";
    if ( colour != m_colour ) {
        m_colour = colour;
        emit colourChanged();
    }
} 
```

然后我将它添加到 QML 上下文中：

```
#include <QApplication>
#include <QDialog>
#include <QDeclarativeView>
#include <QDeclarativeContext>
#include <QLayout>
#include <QDir>
#include "qmlapplicationviewer.h"
#include "dataobject.h"

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    QList<QObject*> dataList;
    dataList.append( new DataObject( "c++ entry1 (red)", "red" ) );
    dataList.append( new DataObject( "c++ entry2 (orange)", "orange" ) );
    dataList.append( new DataObject( "c++ entry3 (yellow)", "yellow" ) );
    dataList.append( new DataObject( "c++ entry4 (green)", "green" ) );
    dataList.append( new DataObject( "c++ entry5 (blue)", "blue" ) );
    dataList.append( new DataObject( "c++ entry6 (purple)", "purple" ) );

    QmlApplicationViewer viewer;
    viewer.rootContext()->setContextProperty( "cppModel", QVariant::fromValue(dataList) );
    viewer.setOrientation(QmlApplicationViewer::ScreenOrientationAuto);
#if defined( Q_OS_MAC )
    viewer.setMainQmlFile("../Resources/qml/main.qml");
#elif defined( Q_OS_WIN32 )
    viewer.setMainQmlFile("qml/main.qml");
#else
#error - unknown platform
#endif
    viewer.showExpanded();

    return app.exec();
} 
```

最后，在 QML 中，我将这个 C++ 模型添加到 ListView：

```
import QtQuick 1.0

Rectangle {
    width: 200; height: 200

    ListModel {
        id: qmlModel
        ListElement { name: "qml entry1 (red)"; colour: "red" }
        ListElement { name: "qml entry2 (orange)"; colour: "orange" }
        ListElement { name: "qml entry3 (yellow)"; colour: "yellow" }
        ListElement { name: "qml entry4 (green)"; colour: "green" }
        ListElement { name: "qml entry5 (blue)"; colour: "blue" }
        ListElement { name: "qml entry6 (purple)"; colour: "purple" }
    }

           ListView {

               id: list_view

               anchors.fill: parent
               //model: qmlModel
               model: cppModel
               delegate: Rectangle {
                   height: 20
                   width: 200
                   color: colour
                   Text { text: name }

               }
           }

} 
```

再一次，这工作得很好 - 出现一个对话框，其中包含以带状排列的彩色背景的文本。显示由 C++ 模型支持的 ListView 似乎每一点都有效，以及显示由 QML ListModel 支持的 ListView。

![ListView 在 C++ 中显示 QList](https://i.stack.imgur.com/YUjqX.png)

我想要工作的是一个支持 PathView 的 C++ 模型，如下所示：

```
import QtQuick 1.0

Rectangle {
    width: 200; height: 200

    ListModel {
        id: qmlModel
        ListElement { name: "qml entry1 (red)"; colour: "red" }
        ListElement { name: "qml entry2 (orange)"; colour: "orange" }
        ListElement { name: "qml entry3 (yellow)"; colour: "yellow" }
        ListElement { name: "qml entry4 (green)"; colour: "green" }
        ListElement { name: "qml entry5 (blue)"; colour: "blue" }
        ListElement { name: "qml entry6 (purple)"; colour: "purple" }
    }

//    ListView {

//       id: list_view

//       anchors.fill: parent
//       model: qmlModel
//       //model: cppModel
//       delegate: Rectangle {
//           height: 20
//           width: 200
//           color: colour
//           Text { text: name }

//       }
//    }

    PathView {
        id: my_path_view

        anchors.fill: parent

        Keys.onRightPressed: if (!moving && interactive) incrementCurrentIndex()
        Keys.onLeftPressed: if (!moving && interactive) decrementCurrentIndex()

        flickDeceleration: 500

        preferredHighlightBegin: 0.5
        preferredHighlightEnd: 0.5
        focus: true
        interactive: true
        //model: qmlModel
        model: cppModel

        delegate: Rectangle {
            width: 100
            height: 100
            color: colour
            Text {
                anchors.centerIn: parent
                text: name
            }
        }

        path: Path {
            startX: - my_path_view.width * my_path_view.model.count / 2 + my_path_view.width / 2
            startY: my_path_view.height / 2
            PathLine {
                x: my_path_view.width * my_path_view.model.count / 2 + my_path_view.width / 2
                y: my_path_view.height / 2
            }
        }
    }
} 
```

这不起作用。我看到的是彩色矩形，但它们不能与鼠标交互，并且它们不在 qmlviewer 对话框中居中。

![QML PathView 中的 C++ QList](https://i.stack.imgur.com/iX733.png)

在调试控制台上，我看到了这个：

```
QDeclarativeDebugServer: Waiting for connection on port 3768...
QDeclarativeDebugServer: Connection established
QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call
QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call
colour() has been called.

name() has been called.

colour() has been called.

name() has been called.

colour() has been called.

name() has been called.

colour() has been called.

name() has been called.

colour() has been called.

name() has been called.

colour() has been called.

name() has been called.

QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call
QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call
QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call
QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call
QPainterPath::lineTo: Adding point where x or y is NaN or Inf, ignoring call 
```

似乎 QList 的基本形状足够接近 QML ListModel/ListItem 集合以供 ListView 显示，但不足以接近 PathView 来显示。

有谁知道可能出了什么问题？不幸的是，QML 类文档并没有真正与编写符合 C++ 替代的目标放在一起。例如，http://qt-project.org/doc/qt-4.8/qml-pathview.html 上的 PathView 对象文档[没有](http://qt-project.org/doc/qt-4.8/qml-pathview.html)说明其模型需要支持哪些属性。此外，ListModel 文档不是确定性的——它没有准确说明 ListModel 支持哪些属性，也没有明确的文档说明 QList 如何精确地满足这些要求以及它如何不满足这些要求。

更新：我已经在 Windows 上使用 Qt 5 进行了尝试，但我仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T06:03:40.170

事实证明， 的`count`属性`cppModel`不可用有一个非常简单的原因——因为既没有`QAbstractListModel`也`QList<>`没有`count`属性！

我假设 a`ListModel`可以用基于 C++ 的对象（如 QList<> ）替换这一事实意味着它们是多态的，并且 ListView 或 PathView 将使用`count`属性来正确处理它们。

首先， a`QAbstractListModel`也不`QList<>`是多态的`ListModel`。事实证明，它们都只是特例——a`ListView`知道它是否具有 a`ListModel`或 a`QList<>`或 a`QAbstractListModel`并且具有用于使用每个的单独代码路径。`ListView`不需要不存在的属性`count`来管理 a`QList<>`或 a `QAbstractListModel`。事实上，我不清楚，`ListView`甚至`PathView`使用`ListModel`'`count`属性。该`count`属性似乎主要是为了 QML 程序员的利益。在我的示例中，我使用该`count`属性`Path`在`PathView`. 如果我使用`length`属性代替，我的示例将完美运行，因为`QList<>`确实有`length`属性。

感谢 #qt-qml 上的 blam 和 torgeirl 帮助我解决这个问题（他们都不想通过发布这个答案来收集 stackoverflow 积分，所以我发布它是为了社区的利益）。

# batch-file - 如何将特定文件类型从一个文件夹复制到另一个文件夹

> ID：15753420
> 
> 赞同：3
> 
> 时间：2013-04-01T23:04:27.587
> 
> 标签：batch-file, copy, dos

如何在保留文件夹结构的同时将特定文件类型从一个文件夹复制到另一个文件夹？

以下批处理命令能够将特定文件类型复制到文件夹，但无法保留文件夹结构：

```
for /R c:\source %%f in (*.cpp,*.h) do copy %%f x:\destination\ 
```

我该如何修改它以使文件夹结构与源代码保持一致？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:07:11.140

```
xcopy /e c:\source\*.xml x:\destination\ 
```

应该做的工作。

看

```
xcopy /? 
```

从文档提示中。用于`/e`with-empty-directories 或`/s`用于忽略空目录。

# android - 我应该使用广播接收器还是服务？

> ID：15753424
> 
> 赞同：0
> 
> 时间：2013-04-01T23:05:01.907
> 
> 标签：android, service, broadcastreceiver, alarmmanager

我不清楚它们之间的区别。我试图阅读它，发现服务适用于长期运行的操作，但没有人说短期运行的操作如何。

我想在午夜做点什么——只是更新一些东西。我已经为午夜制作了一个 AlarmManager，但我不知道我应该调用 BroadcastReceiver 还是 Service。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:44:52.547

听起来您将根据您提到的少量内容执行最少的处理。在这种情况下，服务可能会过大。有很好的讨论涵盖广播接收器和服务之间的差异。查看 API 文档或在此处查看：

[Android 广播接收器与服务](https://stackoverflow.com/questions/14548927/android-broadcast-receiver-vs-service)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T03:39:07.160

在这种情况下，我个人会建议您使用 BroadcastReceiver。因为通过使用广播接收器，您的应用程序只能在警报继续时触发。另一方面，如果您使用服务，那么您的服务将继续在后台运行。

# html - HTML/CSS - 页面滚动（y）无明显原因

> ID：15753425
> 
> 赞同：1
> 
> 时间：2013-04-01T23:05:09.483
> 
> 标签：html, css, scroll

这次很简单的问题——为什么这个页面有滚动条？我想不出任何理由 - 用萤火虫检查了所有元素，甚至没有一个到达页面底部。

这是 CSSdesk：[http](http://cssdesk.com/hcAPj) ://cssdesk.com/hcAPj 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:16:02.363

您将`#sidebar`元素定义为具有`min-height:100%`，但除了文档之外没有参考（具有显式高度设置的元素）。因此，`100%`使用了窗口（框架）的高度，并且由于它不与顶部齐平，因此它会从底部溢出。

# android - 如何递归检查文件夹的空性，不包括特定文件夹？

> ID：15753427
> 
> 赞同：0
> 
> 时间：2013-04-01T23:05:19.487
> 
> 标签：android, shell, directory, is-empty

我不是 linux/unix shell 命令的专家。

抱歉说得这么具体，但我想问一下：

假设我有一个文件夹，我需要检查它是否没有“简单”文件（所有文件不包括文件夹/目录），并且还忽略其中的特定文件夹。我怎么做？

请注意，我打算在 Android 上运行该命令（不使用 API，因为我打算使用它来检查受保护文件夹的信息），因此它的命令可能比 linux/unix 的普通 shell 少。

如果需要，我可以运行多个 shell 命令，并在执行下一个命令之前检查每个命令的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T15:11:17.757

这可能会帮助你

```
find /path/to/dirs/* -type d -empty \( ! -iname "DIR TO IGNORE" \) 
```

* * *

请查看以下示例，这将列出 /home/test 中的所有空文件夹 - 不包括`ruby`文件夹

```
[user@server:/home/test]# mkdir shell bash php ruby perl
[user@server:/home/test]# touch shell/testing.sh
[user@server:/home/test]# find /home/test/* -type d -empty \( ! -iname "ruby" \)
/home/test/bash
/home/test/perl
/home/test/php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:00:27.327

好的，我已经通过递归检查每个文件来处理它，并忽略了那些在我想使用 Java 忽略的路径中的文件。

终端命令是：

```
find /PATH/TO/FOLDER/* -type f 
```

如果其他人也可以让它跳过特定的文件夹，那就太好了。

# macos - 为什么 git 有时会冻结在 git-credential-osxkeychain 上？

> ID：15753429
> 
> 赞同：4
> 
> 时间：2013-04-01T23:05:38.910
> 
> 标签：macos, git, bash, keychain

当我`cd some-repo; git push origin master`在我的 bash 终端中执行此操作时，它不会要求我输入用户名/密码，因为我猜 git 已经保存了它（那是很久以前，我不记得它是如何下降的细节了）。我正在推送到 GitHub 存储库作为远程源。

所以我有一个 C++ 程序，它做一个 fork 和

```
execl("/bin/bash", "/bin/bash", "-c", "cd some-repo; git push origin master", (char *)0); 
```

然后等待子 bash 进程完成。

有时它工作得很好，但其他时候（似乎是随机的）它会冻结。查看正在运行的进程层次结构，我看到：

```
MyProgram
  git
    git-remote-http
      git
        git-credential-osxkeychain 
```

如果我杀死最子级的 git-credential-osx 进程，我的程序将恢复（因为最父级的 git 命令完成），输出并不令人惊讶，例如：

```
error: git-credential-osxkeychain died of signal 15
error: RPC failed; result=7, HTTP code = 0
fatal: The remote end hung up unexpectedly
fatal: The remote end hung up unexpectedly 
```

我的问题：为什么`git push origin master`在 bash 终端中似乎总是有效（不询问我任何用户名密码或其他标准输入），但有时会在 git-credential-osxkeychain 上挂起（可能会在标准输入上要求某些内容），但有时在我运行时不会它来自我的 C++ 程序？

我尝试在 git-credential-osxkeychain 上查找手册页，但实际上找不到任何东西。运行它只打印`Usage: git credential-osxkeychain <get|store|erase>`对我来说不够自我解释。谢谢！

我正在运行 OS X 10.8.3；git 版本 1.7.12.4 (Apple Git-37); GNU bash，版本 3.2.48(1)-release (x86_64-apple-darwin12)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T08:01:09.990

没有太多信息，我的猜测是挂起取决于您的登录钥匙串当时是否被锁定。在 Mac 上，如果登录钥匙串已解锁，则获取您的用户名和密码的查询可以不受阻碍地进行。但如果钥匙串被锁定，那么 Mac OS X 会提示您输入登录密码以解锁钥匙串。我怀疑对话框在那里，只是隐藏在某些东西后面，所以你可能错过了它。它会等待您输入密码，从而有效地挂起该过程。

这里有更多关于[gitcredential 基础设施](http://git-scm.com/docs/gitcredentials)的信息，还有更多关于 API（包括帮助程序的命令行）的[信息](https://www.kernel.org/pub/software/scm/git/docs/technical/api-credentials.html)。

# node.js - 包含 node.d.ts 时的 Typescript 编译器错误

> ID：15753432
> 
> 赞同：5
> 
> 时间：2013-04-01T23:05:49.583
> 
> 标签：node.js, typescript, tsc

我最近开始从 PHP 切换到 Node.js，因为我是 Typescript 的忠实粉丝，所以我使用的是 Typescript + Node.js。当我开始扩大规模并真正构建我的代码时，我的示例编译得很好。但后来我遇到了一个问题。每当在我的一个 .ts 文件中引用 node.d.ts（带有参考文档注释）时，Node.js 中的 Typescript 编译器都会抱怨重复定义。我的两个 .ts 文件抱怨没有 node.d.ts 定义，但我的 main.js 文件没有。（以下文件：）

search_request.ts

```
/// <reference path="definitions/mustache.d.ts" />

import url = module("url");
import mu = module("mu2");

export function handler(request, response) {
    //code..
} 
```

main.ts

```
/// <reference path="servers/search_request.ts" />

import search_request = module("./servers/search_request");
import express = module("express");

var app = express();

app.get("/search.html", search_request.handler);
app.listen(3000); 
```

如果我添加`<reference path="node.d.ts" />`到 search_request.ts 的顶部，它编译得很好。如果我删除它，我会收到有关缺少定义的警告。但是，如果我将它包含在任一文件中，编译 main.ts 会给我数百条关于重复标识符的警告。

我不是 Typescript 的新手，但我是 Node.js 的新手，并且是直接使用 tsc 编译器而不是通过 VS2012 的新手。我到底做错了什么？编译器是否像 lib.d.ts 一样隐式包含 node.d.ts？如果是这样，为什么我在编译 search_request.ts 时会出错？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T15:33:37.433

所以 Ryan Cavanaugh 的改变确实解决了我的问题，但是以一种迂回的方式。我的真正问题与您所期望的完全一样：node.d.ts 被多次包含（就像 express.d.ts 一样）。我的文件结构是这样的：

```
C:\Project
   -node.d.ts
   \public
      -main.ts
      \definitions
         -node.d.ts 
```

所以很自然，在我的 main.ts 文件中，我包含了定义/node.d.ts。但不知何故，node（或者可能是 tsc）自动包含了 node.d.ts 文件，该文件直接比 main.ts 高一个。我不知道怎么做，它仍然让我很困惑，但这就是问题所在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T23:17:53.467

```
/// <reference path="servers/search_request.ts" />

import search_request = module("./servers/search_request");
import express = module("express"); 
```

一个好的经验法则是永远不要将`reference`标签与顶级`import`或.d.ts 文件混合到非 .d.ts 文件中`export`。

如果您将`reference`标签删除到 search_request.ts，这应该会起作用。

# c - C链表添加和删除

> ID：15753440
> 
> 赞同：2
> 
> 时间：2013-04-01T23:07:10.070
> 
> 标签：c

```
typedef struct _readyQ {
    pcb_t *pcb;
    struct _readyQ  *next;
} readyQ;

static readyQ *ready_queue_head = NULL, *ready_queue_tail = NULL;
static void submit_ready_request(pcb_t *pcb);

static void submit_ready_request(pcb_t *pcb)
{
    readyQ *r;
    /* Build I/O Request */
    r = malloc(sizeof(readyQ));
    assert(r != NULL);
    r->pcb = pcb;
    r->next = NULL;

    pthread_mutex_lock(&readyQ_mutex);
    /* Add request to head of queue */
    if (ready_queue_tail != NULL)
    {
        ready_queue_tail->next = r;
        ready_queue_tail = r;
    }
    else
    {
        ready_queue_head = r;
        ready_queue_tail = r;
    }
    pthread_mutex_unlock(&readyQ_mutex);
} 
```

最初头/尾都是NULL。所以，当我第一次通过 submit_ready_request 添加时，我会去其他部分

```
ready_queue_head = r;
ready_queue_tail = r; 
```

都指向同一个 readyQ r。

现在，当我添加另一个时，它将转到

```
ready_queue_tail->next = r;
ready_queue_tail = r; 
```

我想知道在这种情况下， `ready_queue_head->next`执行上面的代码后会指向 r 吗？

因为我试图通过这个删除，但它不起作用

```
readyQ *r;
r = malloc(sizeof(readyQ));
if (ready_queue_head != NULL) {   //not empty so remove
       r = ready_queue_head;  
       if(ready_queue_head->next != NULL){   
          ready_queue_head = ready_queue_head->next; 
        } else {    //only one in the queue
          ready_queue_head = NULL;
          ready_queue_tail = NULL;
       }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:19:50.630

我怀疑当您说它不起作用时，您的意思`r`是在“删除”两个节点后它不为空。如果是这样，则错误是删除代码中的此分配：

```
r = malloc(sizeof(readyQ)); 
```

如果列表为空，那将是结果（可能不需要）。如果列表不为空，则该内存会立即泄漏。它可能应该只是：

```
r = NULL; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:49:48.983

我没有看到任何错误（除了虚假的 malloc），因此编译了您的代码并且没有收到任何段错误或其他错误。我唯一改变的是删除互斥锁。可能故障出在互斥体中？您的出队代码是否受互斥锁保护？

同样在回答您关于 ready_queue_head->next 的问题时，是的，它会按您的预期工作。实际上，您可以将出队代码简化为：

```
r = ready_queue_head;  
ready_queue_head = ready_queue_head->next; 
if (ready_queue_head == NULL){   
    ready_queue_tail = NULL;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T00:42:39.040

首先，`malloc()`弹出操作不需要。其次，你的 push 和 pop 都过于迂腐。*非常*仔细地盯着这个推送和弹出逻辑，在你*知道*它是如何工作的之前不要合并它。您需要考虑*两者*如何协同工作才能真正掌握简单性。

首先是推送逻辑。以下假设`r`是新分配的节点**，其 next 指针为 NULL**：

```
if (ready_queue_head != NULL)
    ready_queue_tail->next = r;
else
    ready_queue_head = r;
ready_queue_tail = r; 
```

同样，流行逻辑

```
r = ready_queue_head;
if (r != NULL) 
   ready_queue_head = r->next 
```

在您的脑海中考虑一些测试用例。

**推送逻辑**

*   当你在一个空列表中插入一个新节点时会发生什么？由于列表为空，因此头指针将​​为 NULL，因此头指针和尾指针最终都将引用新节点。
*   插入一个包含一个元素的列表怎么样？由于头指针非空，所以尾指针也必须有效，所以将其next指针设置为新节点，然后将尾指针指向新节点。
*   如果在插入之前列表中有多个节点，这种情况会改变吗？一点也不。

**流行逻辑**

*   当您从空队列请求弹出时会发生什么？由于头指针在空队列上为 NULL，因此返回值`r`也将为 NULL。
*   当您从单元素队列请求弹出时会发生什么？头指针引用单个元素，因此`r`将正确设置。因为`r`是非空的，所以头指针前进到它的`next`指针，这将是空的。列表现在为空（head 为 NULL）并且返回节点指针已设置。
*   一个包含多个节点的列表呢？单节点弹出中的所有内容都适用，但头指针在退出时不会为 NULL，因此列表仍然不是空的（但*比*以前短了一个元素。同样，返回节点指针`r`已正确设置。

无论如何，我希望它有所帮助。很难理解尾指针在这一切中的参与程度有多么小，但在你想了一会儿之后就不知道了。作为奖励，这是明显复杂的 is-empty 逻辑。

```
return (ready_queue_head != NULL); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-01T23:23:51.597

```
r = malloc(sizeof(readyQ)); 
```

上面的语句不会为结构分配内存。相反，它将为指向结构的指针分配内存。

# jquery - jquery追加xml数据

> ID：15753443
> 
> 赞同：0
> 
> 时间：2013-04-01T23:07:18.323
> 
> 标签：jquery, xml, append

我使用 jquery isotope 来展示我的投资组合。由于 xml 文件，我想加载所有同位素项目。

我试图用 jquery 和 xml 数据附加同位素元素。

我的脚本看起来像这样：

```
$(document).ready(function()
  {
$.get('data.xml', function (d) {

    $(d).find('element').each(function () {
        var $element = $(this);
        var id = $element.attr("id");
        var size = $element.attr("size");
        var category = $element.attr("category");
        var urlpage = $element.find('urlpage').text();
        var urlimage = $element.find('urlimage').text();
        var title = $element.find('title').text();

$('<div class= " element '+ size +' '+ category +' " id="_'+id+'"></div>').html('<a class= "link" href="' + urlpage + '"><img  src="' + urlimage + '" class="thumbnail" />' + '<div>' + '<span>' + + '<span>' + '<i class="icon-pencil"></i>' + '&nbsp;&nbsp;' + title + '</span><span class="more">more.</span></div></a></div>').appendTo('#container');

});

$container.isotope({
    itemSelector : '.element',
    layoutMode: 'masonryHorizontal',
    masonryHorizontal: {
    rowHeight: 210
    },
});

});
}); 
```

我的xml是这样的：

```
<?xml version="1.0" encoding="utf-8" ?>

<element>
    <element id="13" size="" category="portfolio">
    <urlpage>/portfolio/dock.html</urlpage>
    <urlimage>./Post thumbnail images/formlabs.jpg</urlimage>
    <title>Formlabs : An offordable 3D printer on kickstarter</title>
</element>

<element>
    <element id="12" size="" category="portfolio">
    <urlpage>/portfolio/dock.html</urlpage>
    <urlimage>./Post thumbnail images/Bumper.JPG</urlimage>
    <title>Minimal Bumper for iPhone 5</title>
</element> 
```

但是什么也没有发生……我想我的剧本有错误……

怎么了？

对不起我的英语，我是法国人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:20:17.597

您的 XML 无效。你有一个元素，在它里面你有另一个没有关闭的元素。此外，您的所有标签都必须在根标签内（例如元素）。

你为什么不这样做：

```
<?xml version="1.0" encoding="utf-8" ?>
<elements>
<element id="13" size="" category="portfolio">
    <urlpage>/portfolio/dock.html</urlpage>
    <urlimage>./Post thumbnail images/formlabs.jpg</urlimage>
    <title>Formlabs : An offordable 3D printer on kickstarter</title>
</element>

<element id="12" size="" category="portfolio">
    <urlpage>/portfolio/dock.html</urlpage>
    <urlimage>./Post thumbnail images/Bumper.JPG</urlimage>
    <title>Minimal Bumper for iPhone 5</title>
</element>
</elements> 
```

# python - Python无法使连接信号到类函数工作

> ID：15753447
> 
> 赞同：0
> 
> 时间：2013-04-01T23:07:51.887
> 
> 标签：python, list, pyqt

嗨，我正在制作这个小项目，我需要将一个按钮连接到一个将特定框架（存储在列表中）设置为 QMainWindow 的中央小部件的方法，我已经调用了两次方法 nuevaEscena() 到创建两个场景（创建了 2 个帧），这是我尝试过的，但是当我单击“Escena #”按钮时，似乎没有发出信号，放置了一个打印来检查并且它什么也不打印单击按钮，它仅在调用 nuevaEscena() 时打印，我也不确定我处理显示框架的方式是否正确，谢谢这里是代码：

```
import sys
import sip
from PyQt4.QtCore import *
from PyQt4.QtGui import *
#from blurdev.gui import Dialog
# from Py3dsMax import mxs

myMimeType = 'application/MyWindow'

class MyLabel(QLabel):
    def __init__(self, parent):
        super(MyLabel, self).__init__(parent)
        self.setStyleSheet("background-image: url(selector.png);")
        self.adjustSize()
    def mouseMoveEvent(self, e):
        if e.buttons() != Qt.LeftButton:
            return

        # write the relative cursor position to mime data
        mimeData = QMimeData()
        # simple string with 'x,y'
        mimeData.setText('%d,%d' % (e.x(), e.y()))
        # start the drag operation
        # exec_ will return the accepted action from dropEvent
        if drag.exec_(Qt.MoveAction | Qt.CopyAction) == Qt.MoveAction:
            self.show()

    def mousePressEvent(self, event):
        itemData   = QByteArray()
        dataStream = QDataStream(itemData, QIODevice.WriteOnly)
        dataStream.writeString(self.text())
        dataStream << QPoint(event.pos() - self.rect().topLeft())

        mimeData = QMimeData()
        mimeData.setData(myMimeType, itemData)
        mimeData.setText(self.text())

        drag = QDrag(self)
        drag.setMimeData(mimeData)
        drag.setHotSpot(event.pos() - self.rect().topLeft())

        #self.hide()
        # mxs.select(mxs.getNodeByName('a'))
        if drag.exec_(Qt.MoveAction | Qt.CopyAction) == Qt.MoveAction:
            self.close()
        else:
            self.show()

class MyFrame(QFrame):
    def __init__(self, parent=None):
        super(MyFrame, self).__init__(parent)
        self.setStyleSheet("background-image: url(logo.png);")
        self.setFixedSize(800,600)
        y = 6

        for labelNumber in range(6):
            label = MyLabel(self)
            label.resize(50, 50)
            label.move(6, y)
            label.show()
            y += label.height() + 2

        self.setAcceptDrops(True)

    def dragEnterEvent(self, event):
        if event.mimeData().hasFormat(myMimeType):
            if event.source() in self.children():
                event.setDropAction(Qt.MoveAction)
                event.accept()
            else:
                event.acceptProposedAction()

    def dropEvent(self, event):
        if event.mimeData().hasFormat(myMimeType):
            mime       = event.mimeData()
            itemData   = mime.data(myMimeType)
            dataStream = QDataStream(itemData, QIODevice.ReadOnly)

            text = QByteArray()
            offset = QPoint()
            dataStream >> text >> offset

            newLabel = MyLabel(self)
            newLabel.setText(event.mimeData().text())
            newLabel.move(event.pos() - offset)
            newLabel.resize(50, 50)
            newLabel.show()

            if event.source() in self.children():
                event.setDropAction(Qt.MoveAction)
                event.accept()

            else:
                event.acceptProposedAction()

        #~ else:
            #~ event.ignore()

class MyWindow(QMainWindow):
    def __init__(self, parent=None):
        super(MyWindow, self).__init__(parent)
        self.move(app.desktop().screen().rect().center() - self.rect().center())
        self.crearPanelEscenas()
        self.crearMenus()
        self.nuevaEscena()
        self.nuevaEscena()

    #GUI Interfaces
    def crearPanelEscenas(self):
        # Lista de escenas
        self.listaEscenas = []
        # Escena actual
        self.escenaActual = -1;
        # Panel para los botones de escenas
        self.listaEscenasGUI = QDockWidget("Escenas")
        self.listaEscenasGUI.setFeatures(QDockWidget.NoDockWidgetFeatures)

        dockWidget = QWidget()
        dockWidgetLayout = QHBoxLayout()
        dockWidget.setLayout(dockWidgetLayout)

        self.listaEscenasGUI.setWidget(dockWidget)
        self.addDockWidget(Qt.TopDockWidgetArea, self.listaEscenasGUI)

    def nuevaEscena(self):
        self.escenaActual = self.escenaActual + 1;
        # Button para seleccionar escena a ver
        myButton = QPushButton("Escena "+str(self.escenaActual))
        self.listaEscenasGUI.widget().layout().addWidget(myButton)
        # Creo la escena nueva
        nuevaEscena = MyFrame() 
        # La guardo             
        self.listaEscenas.append(nuevaEscena)   
        self.connect(myButton, SIGNAL("clicked()"), SLOT(self.mostrarEscena(self.escenaActual)))

    def mostrarEscena(self, index):
        print "Clicked"
        self.escenaActual = index
        self.setCentralWidget(self.listaEscenas[index])

    #GUI Menus
    def crearMenus(self):
        self.menuBar = self.menuBar()
        adicionarAction = QAction("Adicionar",self.menuBar)
        eliminarAction = QAction("Eliminar",self.menuBar)

        self.menuArchivo  = self.menuBar.addMenu("&Archivo")
        self.menuInterfaz = self.menuBar.addMenu("&Interfaz")

        self.menuInterfaz.addAction(adicionarAction)
        self.menuInterfaz.addAction(eliminarAction)

if __name__ == "__main__":
    app = QApplication(sys.argv)
    app.setApplicationName('GUI Picker')
    main = MyWindow()
    main.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:18:42.533

这是你应该做的：

```
MyButton.clicked.connect(lambda: self.mostrarEscena(self.escenaActual)) 
```

您需要一个 lambda 函数，否则您将调用该方法并传递结果对象。

使用这个绑定`clicked`比使用连接信号简单得多

# ios - UIAppearance 的外观代理是如何工作的？

> ID：15753448
> 
> 赞同：4
> 
> 时间：2013-04-01T23:07:58.637
> 
> 标签：ios, objective-c, uiappearance

我试图了解[`UIAppearance`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html). 协议的两种方法都`UIAppearance`返回一个类型为 的“外观代理” `id`。这个“外观代理”是什么？是不是类似于 File's Owner 代理，一个以后会填写的对象？它如何改变屏幕对象的外观？

# c++builder - C++ Builder 中等效的“使用”部分

> ID：15753449
> 
> 赞同：1
> 
> 时间：2013-04-01T23:08:35.700
> 
> 标签：c++builder

我正在使用 C++ Builder 2009，我正在尝试让我的`Korzh's Localizer`组件来处理我`Fast Reports`的翻译。该组件正确翻译了我的程序的其余部分。

为了翻译`Fast Reports`，还有一个额外的步骤。`LocFRProcs`在说明中，通过将单元名称放在部分中来参考使用`uses`。不幸的是，我的 delphi 知识很低，所以我不知道 C++ 中的等价物……我猜我需要做某种包含……但我不确定如何使用 .帕斯文件。

## 一些屏幕截图以供澄清

搜索`LocFRProcs`：

![在此处输入图像描述](https://i.stack.imgur.com/JwMlG.jpg)

具有的目录`LocFRProcs.pas`：

![在此处输入图像描述](https://i.stack.imgur.com/Q3vwU.jpg)

`LocFRProcs`添加到使用部分的 Korzh 说明：

![在此处输入图像描述](https://i.stack.imgur.com/Go34S.jpg)

**更新 2：**

1.  打开 localizer12 项目文件。
2.  右键单击项目并转到选项
3.  点击链接
4.  将“链接器输出”更改为“生成所有 C++ Builder 文件（包括包库）”
5.  点击确定
6.  右键单击项目并选择构建。
7.  我认为这会生成一个 LocFRProcs.hpp 或 LocFRProcs.h 文件，但没有。

生成全部后的目录截图： ![在此处输入图像描述](https://i.stack.imgur.com/Zg1uo.jpg)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T00:25:39.130

该`uses`子句的 C++ 等价物确实是`#include`语句。您不包含 .pas 文件，而是包含其 C++ .hpp 头文件，例如：

德尔福：

```
uses
   ..., LocFRProcs; 
```

C++：

```
...
#include <LocFRProcs.hpp> 
```

如果您没有 LocFRProcs.hpp 文件，则必须先编译 LocFRProcs.pas。如果您没有在 IDE 中安装 Delphi 个性和/或如果组件包不包含用于在 C++ IDE 中编译 .pas 文件的 C++ 项目，C++Builder 具有命令行 Delphi 编译器无论哪种方式，在编译 .pas 文件时，您都可以配置 Delphi 编译器以输出 C++ 支持文件（.hpp、.obj、.lib 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-01T23:17:25.190

Remy 的回答当然是正确的，但是由于这个问题在 Google 搜索中出现在 C++ Builder 中等效的“使用”部分的顶部（来自标题），我只想指出，当一个主要的 Delphi 库说在“用途”部分包含一个单位，它可能意味着以下一项或多项：

```
(1) #include statements 
(2) .lib file included in the Project 
(3) #pragma link 
```

这提出了 DevExpress VCL dxRichEditControl，有关添加新文件保存格式的文档说，“将 dxRichEdit.OpenXML、dxRichEdit.Doc 和/或 dxRichEdit.Html 单元添加到使用条款”

对于那个图书馆，这意味着：

(1) 添加#include 语句

```
#include "dxRichEdit.OpenXML.hpp"
#include "dxRichEdit.Html.hpp"
#include "dxRichEdit.Doc.hpp" 
```

(2) 将.lib 文件添加到项目中

```
C:\Program Files (x86)\DevExpress\VCL\Library\RS26\dxRichEditControlDocFormatRS26.lib
C:\Program Files (x86)\DevExpress\VCL\Library\RS26\dxRichEditControlHtmlFormatRS26.lib
C:\Program Files (x86)\DevExpress\VCL\Library\RS26\dxRichEditControlOpenXMLFormatRS26.lib 
```

(3) 不需要#pragma 链接，因为这些语句已生成并包含在 .hpp 文件中

# php - 使用 PHP 获得更高质量的 PNG 透明度

> ID：15753460
> 
> 赞同：1
> 
> 时间：2013-04-01T23:09:38.163
> 
> 标签：php, image, merge, png

我有一个看起来像这样的代码：

```
<?php
$imgl = "test/white.png";
$img2 = "test/1.png";

$dest = imagecreatefrompng($imgl);
$src = imagecreatefrompng($img2);
imagecolortransparent($src, imagecolorat($src, 0, 0));
imagecolortransparent($dest, imagecolorat($dest, 0, 0));

$src_x = imagesx($src);
$src_y = imagesy($src);
imagecopymerge($dest, $src, 0, 0, 0, 0, $src_x, $src_y, 100);

// Output and free from memory
header('Content-Type: image/png');
imagegif($dest);

imagedestroy($dest);
imagedestroy($src);
?> 
```

此代码将图像合并在一起，同时保持其透明度。但是，此代码将图像的透明度保持在非常低的质量，并且边缘看起来非常粗糙。我想知道，有没有一种方法可以保持图像的透明度，但质量更好？但是，我仍然希望这个脚本完成相同的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:11:27.473

看起来您正在将图像输出为 GIF，而不是 PNG。尝试`imagepng()`代替`imagegif()`.

```
imagepng($dest); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:17:52.123

GIF 只有一个 1 位的 alpha 通道，这意味着它无法表示部分透明度。每个像素要么完全透明，要么完全不透明。这是您的代码的第一个潜在问题。

另一种是`imagecolortransparent()`将单一颜色设置为透明。这意味着只有具有该颜色的像素*才会*透明。如果您需要平滑过渡，您可能需要自己实现实际的每像素真彩色透明度。

# performance - 对于今天的 vDSP 性能，使用 1 的步幅是否仍然至关重要？

> ID：15753463
> 
> 赞同：2
> 
> 时间：2013-04-01T23:09:51.830
> 
> 标签：performance, vectorization, intrinsics, vdsp, vmat

在2006 年 11 月关于使用*vDSP*对代码进行矢量化的一篇[有用但有些过时](http://www.ffnn.nl/pages/articles/apple-mac-os-x/vectorizing-with-vdsp-and-veclib.php)的文章中，作者发表了以下声明：

 *> 需要记住的重要一点是，只有步幅等于 1 的操作才能交付极快的矢量化代码。

今天仍然如此吗？即使在具有更强大矢量内在函数的更新的*英特尔处理器上？*

我之所以问是因为我正在编写一些矩阵数学例程，并且刚刚开始将它们全部切换为使用*类似于 Fortran*的列优先排序，以便更容易地与*MATLAB*、*BLAS*和*LAPACK*兼容。但现在我发现我对*vDSP*的一些调用需要处理不再连续的向量……</p>

目前，这些*vDSP*调用是我的代码执行的瓶颈例程。并不是说这将*永远*如此，但至少现在我不想放慢它们的速度，只是为了让对其他库的调用更简单。

我现在最常调用的*vDSP*`vDSP_distancesq`例程是为了以防万一。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:30:51.903

尚真。AFAIK（从 SSE4.x 开始，我认为 AVX 不会改变这一点）SSE 内存加载指令仅加载连续块。

您可以以 2 的步幅进行矢量化，但需要一些额外的混洗操作。

为了一次从缓存中加载整个 SSE 寄存器，这实际上是一个适合同一缓存行的问题。（而且内存 -> 缓存传输的数量对性能更为关键）。

为了支持 scatter-gather SSE，需要大更新的不是 SIMD 指令，而是缓存和内存控制器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T13:50:08.957

是的。

如果有充分的理由，我们（Apple 的 Vector and Numerics Group）可以为某些其他步幅添加优化。例如，对于 2 步长，在某些处理器模型上，我们会照常加载向量块，但然后使用各种置换指令仅提取每个其他元素。这将导致代码不如单元步长代码快，但会比当前代码快。这并不经常这样做，因为通常还有其他更好的方法，例如将跨步数据复制到单位跨度缓冲区，在缓冲区上执行多个 vDSP 操作，然后将数据复制回来。

您描述的案例似乎不是专门研究非单位步幅的好人选。如果您正在对数组的连续列执行多个 vDSP_distancesq 操作，最好并行执行（一次多列）而不是串行执行（所有列，然后是另一列，...）。如果您只对隔离列执行单个 vDSP_distancesq 操作，则还有其他问题。矩阵上的列操作因缓存问题而臭名昭著，尤其是当每行的字节数是 2 的相当大的幂的倍数时。该操作可能会受到内存负载的限制，因此编写专门的代码来优化计算可能没有任何好处。*

# python - 在 django 中通过管理站点添加对象时出错

> ID：15753464
> 
> 赞同：1
> 
> 时间：2013-04-01T23:10:02.950
> 
> 标签：python, django, admin, models

我创建了以下模型：

```
class BasePrice(models.Model):
        start_hour = models.TimeField(blank=False)
        end_hour = models.TimeField(blank=False)
        monday = models.BooleanField(blank=False)
        tuesday = models.BooleanField(blank=False)
        wednesday = models.BooleanField(blank=False)
        thursday = models.BooleanField(blank=False)
        friday = models.BooleanField(blank=False)
        price = models.IntegerField(blank=False)

        def __unicode__(self):

            days = ""

            if (self.monday == True):
                days = days + " Mon"
            if (self.tuesday == True):
                days = days + " Tue"
            if (self.wednesday == True):
                days = days + " Wed"
            if (self.thursday == True):
                days = days + " Thu"
            if (self.friday == True):
                days = days + " Fri"
            return "Price " + str(self.price) + " at " + str(self.start_hour) + ":" +str(self.end_hour) + " in " + days

    def clean(self):

        if self.start_hour > self.end_hour:
            raise ValidationError('Start hour is older than end hour!')

class RentPeriod(models.Model):
    start_date = models.DateField(blank=False)
    end_date = models.DateField(blank=False)
    desk = models.ForeignKey(Desk)
    base_prices = models.ManyToManyField(BasePrice)

    def __unicode__(self):
        return "Period " + str(self.start_date) + " to " + str(self.end_date) + " for " + self.desk.__unicode__()

    def clean(self):

        if self.start_date > self.end_date:
            raise ValidationError('Start date is older than end date!')

    def validate_unique(self, *args, **kwargs):
        super(RentPeriod, self).validate_unique(*args, **kwargs)
    # overlaping hours
        basePrices = self.base_prices.all()

        for price in basePrices:
            qs = self.__class__._default_manager.filter(
                (Q(monday=True) & Q(monday=price.monday)) |
                (Q(tuesday=True) & Q(tuesday=price.tuesday)) |
                (Q(wednesday=True) & Q(wednesday=price.wednesday)) |
                (Q(thursday=True) & Q(thursday=price.thursday)) |
                (Q(friday=True) & Q(friday=price.friday)),
                start_hour__lte=self.end_hour,
                end_hour__gte=self.start_hour
            )

            if qs.exists():
                raise ValidationError({NON_FIELD_ERRORS: ('overlaping hours range',)}) 
```

**通常，在通过管理站点**添加 RentPeriod 实例时，我希望避免在指定日期内重叠时间。当我尝试添加 RentPeriod 实例时，出现以下错误：

> '' 需要为字段“rentperiod”设置一个值，然后才能使用这种多对多关系。

我读过[click](https://stackoverflow.com/questions/6090859/django-instance-needs-to-have-a-primary-key-value-before-a-many-to-many-relatio)，但我不知道如何让它工作。你能帮忙吗？

**注意：**在这种情况下，复杂度 (n^2) 无关紧要。

**更新** 我根据[文档创建了自定义验证器](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin)

表格.py

```
from biurrko.rents.models import RentPeriod
from django.forms.models import ModelForm

class RentPeriodForm(ModelForm):
    class Meta:
        model = RentPeriod

    def clean(self):
        cleaned_data = self.cleaned_data
        basePrices = cleaned_data['base_prices']
        end_hour = cleaned_data['end_hour']
        start_hour = cleaned_data['start_hour']

        for price in basePrices:
            qs = basePrices.filter(
                (Q(monday=True) & Q(monday=price.monday)) |
                (Q(tuesday=True) & Q(tuesday=price.tuesday)) |
                (Q(wednesday=True) & Q(wednesday=price.wednesday)) |
                (Q(thursday=True) & Q(thursday=price.thursday)) |
                (Q(friday=True) & Q(friday=price.friday)),
                start_hour__lte=end_hour,
                end_hour__gte=start_hour
            )

            if qs.exists():
                raise ValidationError({NON_FIELD_ERRORS: ('overlaping hours range',)}) 

        # only for test
        raise ValidationError({NON_FIELD_ERRORS: ('reached',)}) 
        # return cleaned_data 
```

和 admin.py

```
from django.contrib import admin
from biurrko.rents.models import Desk, Room, RentPeriod, BasePrice
from biurrko.rents.forms import RentPeriodForm

admin.site.register(Desk)
admin.site.register(Room)
admin.site.register(RentPeriod)
admin.site.register(BasePrice)

class RentPeriodAdmin(admin.ModelAdmin):
    form = RentPeriodForm 
```

不幸的是，自己的验证器“没有被调用”——我的意思是即使测试 ValidationError 也没有提高。

***更新 2***弄清楚“注册”语句有问题。它应该是：

```
admin.site.register(RentPeriod, RentPeriodAdmin) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T06:13:41.530

我建议模型上的 validate_unique 不是这样做的地方。

要进行此级别的验证，您需要模型有一个 PK，但是为了有一个 PK，它需要保存到 DB，但是为了保存到 DB，它需要验证。看到问题了吗？

您需要将这种验证移动到表单/表单集中。这意味着重载 InlineFormset 的 clean() 方法，我假设您使用该方法输入小时数。参考：[Django 中的内联表单验证](https://stackoverflow.com/questions/877723/inline-form-validation-in-django)

# c++ - 使用 DirectXMath 中的 XMVECTOR 作为类成员仅在发布模式下会导致崩溃？

> ID：15753465
> 
> 赞同：2
> 
> 时间：2013-04-01T23:10:04.227
> 
> 标签：c++, simd, release-mode, directxmath

我一直在尝试使用 XMVECTOR 作为边界框的类成员，因为我做了很多计算，但我每帧只使用一次 XMFLOAT3，所以边界框有一种方法可以让我在 XMFLOAT3 中居中，否则它会停留在 XMVECTOR 中；该类使用 __declspec(align(16)) 进行删除，并在调试模式下工作。但是在发布模式下，它会在我将其设置为某些东西的瞬间崩溃：

```
 Box& Box::operator=(const Box& box)
    {
        _center = box._center;
        _extents = box._extents;
        return *this;
    } 
```

每当我这样做时：

```
Box A;

Box B;

A = B; 
```

它崩溃了，给了我 0xC0000005：访问冲突读取位置 0x00000000。当我将它创建为指针时它也会崩溃：

```
Box* A = new Box(); 
```

这是构造函数：

```
 Box::Box()
    {
        center = XMVectorZero();
        extents = XMVectorSplatOne();
    } 
```

同样，这在 Debug 模式下运行良好，但在 Release 中它崩溃了。Release 模式会发生什么变化而生成无效代码？除了将框对齐到 16 个字节之外，我还需要做其他事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-01T23:15:50.067

该类不是在对齐的地址上创建的，因此即使 XM* 成员在 16 字节边界上对齐，父级的对齐方式也会使它们未对齐，从而导致崩溃。

为了防止这种情况，您需要使用`_mm_alloc`（实际上只是 wraps [`_aligned_alloc`](http://msdn.microsoft.com/en-us/library/8z34s9c6%28v=vs.80%29.aspx)），或者将默认分配器替换为返回最小对齐到 16 字节的块的分配器（在 x64 下，默认分配器就是这种情况）。

在 C++ 中，一个简单的解决方案是为所有包含 XM* 成员的类创建一个基类，如下所示：

```
template<size_t Alignment> class AlignedAllocationPolicy
{
    public:
    static void* operator new(size_t size)
    {
        return _aligned_malloc(size,Alienment);
    }

    static void operator delete(void* memory)
    {
        _aligned_free(memory);
    }
};

class MyAlignedObject : public AlignedAllocationPolicy<16>
{
//...
}; 
```

正如@Dave 所指出的，这是一个最小的示例，您希望重载*所有*`new`and`delete`运算符，特别是`new[]`and`delete[]`

# java - 如何创建全局查找上下文？

> ID：15753467
> 
> 赞同：0
> 
> 时间：2013-04-01T23:10:11.773
> 
> 标签：java, openide

我正在制作一个 Openide 应用程序，它使用多个窗口来查看同一个文档，并且我想制作它，以便在每个窗口中启用保存按钮（如果已启用）。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:10:11.773

这很容易，您可以自己实现`ContextGlobalProvider`. 这[两个](http://weblogs.java.net/blog/timboudreau/archive/2007/01/how_to_replace.html) [来源](http://bb10.com/java-netbeans-modules-openide-devel/2012-11/msg00138.html)可以帮助您做到这一点。

使用这些资源，我能够创建两个不同版本的`CentralLookup`. 这是您的“上下文”不变时的第一个：

```
@ServiceProvider(service = ContextGlobalProvider.class,
    //this next arg is nessesary if you want yours to be the default
    supersedes = "org.netbeans.modules.openide.windows.GlobalActionContextImpl")
public class CentralLookup implements ContextGlobalProvider{
    private final InstanceContent content = new InstanceContent();
    private final Lookup lookup = new AbstractLookup(content);
    public CentralLookup() {}

    public void add(Object instance){
        content.add(instance);
    }

    public void remove(Object instance){
        content.remove(instance);
    }

    public static CentralLookup getInstance() {
        return CentralLookupHolder.INSTANCE;
    }

    // this is apperently only called once...
    @Override
    public Lookup createGlobalContext() {
        return lookup;
    }
    private static class CentralLookupHolder {
        //private static final CentralLookup INSTANCE = new CentralLookup();
        private static final CentralLookup INSTANCE = Lookup.getDefault().lookup(CentralLookup.class);
    }
} 
```

如果您想要一个随当前上下文或“文档”而变化的内容，请使用以下命令：

```
 @ServiceProvider(service = ContextGlobalProvider.class,
    //this next arg is nessesary if you want yours to be the default
    supersedes = "org.netbeans.modules.openide.windows.GlobalActionContextImpl")
public class CentralLookup implements ContextGlobalProvider, Lookup.Provider{
    public CentralLookup() {}

    public void add(Object instance){
        getCurrentDocument().content.add(instance);
    }

    public void remove(Object instance){
        getCurrentDocument().content.remove(instance);
    }

    public static CentralLookup getInstance() {
        return CentralLookupHolder.INSTANCE;
    }

    // this is apperently only called once...
    @Override
    public Lookup createGlobalContext() {
        return Lookups.proxy(this);
    }

    @Override
    public Lookup getLookup(){
        return getCurrentDocument().lookup;
    }
    /**
     * Refresh which lookup is current.  Call this after changing the current document
     */
    public void updateLookupCurrent(){
        Utilities.actionsGlobalContext().lookup(ActionMap.class);
    }
    private static class CentralLookupHolder {
        //private static final CentralLookup INSTANCE = new CentralLookup();
        private static final CentralLookup INSTANCE = Lookup.getDefault().lookup(CentralLookup.class);
    }
} 
```

# ruby-on-rails - 无法启动 Rails 服务器

> ID：15753471
> 
> 赞同：0
> 
> 时间：2013-04-01T23:10:24.700
> 
> 标签：ruby-on-rails, ruby

当我尝试在“mainstreet”环境中启动我的 Rails 服务器时，我的 config/site_config.rb 文件中的这个函数

```
def self.settings(env)
    answer = YAML::load_file('config/siteconfig.yml')[env]
    raise "No settings for environment #{env}" if answer.nil?
    answer
end 
```

返回“环境主街没有设置”在siteconfig.yml中我有：

```
mainstreet:
environment: mainstreet
S3_DOC_BUCKET: 
PPTX_GEN_SERVICE:
PDF_GEN_SERVICE: 
OBJ_THUMB_SERVICE: 
WINDOWS_CLIENT_URL: 
KM_KEY:
HOST_NAME: http://localhost:3000 
```

我在 /config 中有一个 mainstreet.rb 文件，其中定义了设置。我是红宝石的新手，所以我不确定这里发生了什么，我从来没有遇到过这样的问题。另外，我正在使用Windows。

这是完整的跟踪：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:14:08.500

听起来当前目录不是您认为的那样...您需要指定配置文件的完整路径：

```
def self.settings(env)
    path = File.join(Rails.root, "config", "siteconfig.yml")
    answer = YAML::load_file(path)[env]
    raise "No settings for environment #{env}" if answer.nil?
    answer
end 
```

编辑：您的配置文件格式错误，如果您在这里的内容是正确的。它应该缩进：

```
mainstreet:
    environment: mainstreet
    S3_DOC_BUCKET: 
    PPTX_GEN_SERVICE:
    PDF_GEN_SERVICE: 
    OBJ_THUMB_SERVICE: 
    WINDOWS_CLIENT_URL: 
    KM_KEY:
    HOST_NAME: http://localhost:3000 
```

在 rails3 控制台中，文件解析正确：

```
irb(main):039:0> y = YAML.load_file("c.yml")["mainstreet"]
=> {"environment"=>"mainstreet", "S3_DOC_BUCKET"=>nil, "PPTX_GEN_SERVICE"=>nil, "PDF_GEN_SERVICE"=>nil, "OBJ_THUMB_SERVICE"=>nil, "WINDOWS_CLIENT_URL"=>nil, "KM_KEY"=>nil, "HOST_NAME"=>"http://localhost:3000"} 
```

这假设您将“mainstreet”作为`env`函数中的值传递

# django - 在 Heroku 上部署 Django/静态文件的正确方法

> ID：15753474
> 
> 赞同：8
> 
> 时间：2013-04-01T23:10:45.173
> 
> 标签：django, heroku, nginx, amazon-s3, gunicorn

我目前正在开发一个 Django 应用程序，并计划使用 Heroku 和 gunicorn 进行部署。我一直在阅读一些文档，对于使用 nginx 或 Amazon S3 支持静态文件并使 Django 关闭调试模式的正确方法，我有点困惑。

1.  如果我将 Nginx 与 gunicorn 一起使用，是否所有静态文件都存储在 Heroku 上，如果是这样，在 Heroku 上存储有限的情况下，如何处理用户上传的文件？

2.  如果我使用 S3 来托管我的静态文件，应用程序是否仍然需要使用 nginx，或者出于安全目的我仍然需要它？你会推荐什么？

我一直在寻找一个涉及 Heroku 和 nginx 的教程，但到目前为止还没有找到。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T02:44:33.777

如果您要部署到 Heroku，您可能不需要弄乱任何 nginx。请参阅本指南

*   [Django 和静态资产](https://devcenter.heroku.com/articles/django-assets)。
*   [https://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/](https://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/)

也可以看看

*   [https://devcenter.heroku.com/articles/s3](https://devcenter.heroku.com/articles/s3)

# ios - 控制音量并从 xcode 关闭 3g

> ID：15753479
> 
> 赞同：0
> 
> 时间：2013-04-01T23:11:07.590
> 
> 标签：ios, xcode, wifi, volume, 3g

我想知道，他们是否可以使用 xcode 在 ios 设备上控制音量和 3g？我的“心灵”冥想应用程序需要该功能来阻止外界干扰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T10:03:58.493

您无法禁用 3g、蜂窝数据或飞行模式

关于音量取决于您使用的控件。我需要一些细节，所以我可以帮助你

# sql - 仅当一个字段值不存在时才插入表值

> ID：15753480
> 
> 赞同：0
> 
> 时间：2013-04-01T23:11:15.927
> 
> 标签：sql, sql-server-2008

我只想在 field_tag 值不存在时才插入表中。我想在插入表之前检查..如果收据之前存在于相同的 field_tag 值下。如果不存在，那么只有我想插入。我正在使用 sql server 2008

```
INSERT INTO [INVENTORY].[TBL_RECEIPTS]
           ([TicketNbr]
       ,[RevisionNbr]
           ,[Location_ID]
           ,[ContractNumber]
           ,[Storage_ID]
       ,[VarietyID]
           ,[GrossWeight]
           ,[TareWeight]
           ,[Carrier]
           ,[Receipt_date]
           ,[Last_update]
           ,[Inv_weight]
       ,[SAPBatch]
       ,[MoistureFactor]
       ,[Load_Harvested]
       ,[FIELDID]
       ,[GROWER_LOAD_NBR]
       ,[HARVEST_NBR]
       ,[TRACE_WORMS]
       ,[COR_CERT]
       ,[GFF_DEST]
---    ,[GFF_CONTRACT]
       ,[CAB_ID]
       ,[sOURCE]
       ,[CREATED_BY]
       ,[TOTALBONUSES]
       ,[PIDNUMBER] 
       ,[CARRIERVENDORID]
       ,[HAUL_ZONE]
       ,[FIELD_Tag]
       ,[Station]
       ,[COUNTY]
       ,[GradeDate]
       ,[Load_Received]
       ,[Load_Processed]

)
     VALUES
           (@CERT
      ,@RevisionNbr
           ,@Location_ID
           ,@ContractNUmber
           ,@Storage_ID
       ,@VarietyID
           ,@Gross_Weight
           ,@TareWeight
           ,@CarrierName
           ,@receipt_date
           ,Getdate()
           ,@Inv_weight
       ,@receiptbATCHnbr
       ,@DockageWeight
       ,@HARVEST_DT
       ,@FIELDID
       ,@GROWER_LOAD_NBR
       ,@HARVEST_NUMBER
       ,@TRACE_WORMS    
       ,@COR_CERT
       ,@GFF_DEST
---    ,@CONTRACT
       ,@CAB_ID
       ,'I'
       ,'Scale Interface'
       ,0
       ,@ContractPIDNumber
       ,@CARRIERID
       ,@HAUL_ZONE
       ,@FIELD_TAG
       ,@STATION
       ,@COUNTY
       ,@GRADE_DT
       ,@Arrival_dt
       ,@current_Date
) 
```

我确实喜欢这样：

```
insert into yourtable
(field1, field2, etc)
select value1, value2, etc
where not exists
( SELECT * FROM [INVENTORY].[TBL_RECEIPTS] WHERE Field_Tag = @FIELD_TAG) 
```

如何打印错误，我想对此进行错误处理。如果重复存在..它应该打印消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:16:40.560

像这样的东西应该工作。

```
insert into yourtable
(field1, field2, etc)
select value1, value2, etc
where not exists
(subquery to specify
condition under which you don't insert record) 
```

**编辑从这里开始**

如果记录已经存在，另一种通知用户的方法

```
declare @Records as int;
set @Records = select count(*) from tbl_receipts
where field_tag = @Field_Tag;

if @Records > 0
begin
select 'record exists'
end

else
begin
insert query
select 'record added'
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-15T18:35:54.757

它处于工作状态，请测试它。如果没有 imei=69212 和 description='dfhjsdfh' 的条目，将在数据库中输入 `insert into events select 1,2,3 from ( select 1 from events where not exists ( select 1 from events where imei=69212 and description='dfhjsdfh' group by imei) group by imei) AS tt;`

# javascript - 创建一个可移动的 div 元素

> ID：15753484
> 
> 赞同：-1
> 
> 时间：2013-04-01T23:11:36.173
> 
> 标签：javascript, jquery, html

当用户将鼠标悬停在段落标记中的 div 内的文本上时，我正在尝试创建一个移动的 div。发生这种情况时，我只想让 div 移动几个像素。我也不希望 div 在浏览器内滚动，所以我希望它位于它拥有的浏览器空间内。我将如何创建这些界限？我怎样才能让我的 div 移动。我应该使用 jquery 还是 JavaScript。

```
<div class="box">
<p>hello everyone</p>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:14:58.907

使用 CSS 可能会更容易。像这样的东西可以工作（显然根据需要扩展以适应您的布局）：

```
.box {
   margin-left:0px;
}
.box:hover {
   margin-left:5px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:22:05.960

正如 cmallard 所说：

```
.box {
   margin-left:0px;
}
.box:hover {
   margin-left:5px;
} 
```

我可以在评论中看到你要求解释/翻译，所以我可以清楚他所说的话并告诉你：悬停就像 if 语句，如果用户将鼠标悬停/将鼠标放在这个当前类上，那么 CSS 代码将显示，现在其他部分没有显示任何内容。（5px 悬停 [if] 和 0px 没有悬停 [else]）。

希望我有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:15:11.520

# [演示](http://jsfiddle.net/mohammadAdil/PKCGL/1/)

```
$('.box p').mouseover(function(){
  $('.box').css('margin-left','+=2');
}); 
```

为了使其不可滚动，使其`fixed`定位

```
.box{
    position:fixed;
} 
```

# web-services - 为 .NET 选择什么 Web 服务框架

> ID：15753485
> 
> 赞同：2
> 
> 时间：2013-04-01T23:11:46.023
> 
> 标签：web-services, asp.net-web-api, odata, servicestack, wcf-ria-services

我们有一个使用现有 WCF Ria 服务的 Silverlight 应用程序。现在我们将使用 HTML/JavaScript 编写新的前端应用程序。显然，WCF Ria Services 不是 JavaScript 客户端使用的最佳选择，这就是为什么我们需要决定选择什么。我在看[ASP.NET Web API](http://www.asp.net/web-api)、[OData](http://www.odata.org)和[ServiceStack](http://www.servicestack.net)。就个人而言，我喜欢 ServiceStack 的透明性，但 OData 支持许多开箱即用的有用功能。我梦想的框架执行以下操作：

*   处理不同的序列化格式。
*   与其他人相处得很好（从非基于 ms 技术的应用程序中使用服务应该没有问题）。
*   允许过滤像[OData $filter](http://www.odata.org/documentation/odata-v2-documentation/uri-conventions/#45_Filter_System_Query_Option_filter)这样的数据，但不是特别使用它的语法，任何其他的都是可以接受的。
*   允许扩展对象导航属性，如[OData $expand](http://www.odata.org/documentation/odata-v2-documentation/uri-conventions/#46_Expand_System_Query_Option_expand)。
*   使用干净的 URI 和正确的 HTTP 方法映射实现 RESTful 服务。

我可以使用 ServiceStack 实现这些目标吗？或者也许这里没有提到其他一些框架？

**更新**

*   对于扩展（或隐藏）的导航属性，可以参考[这个答案](https://stackoverflow.com/questions/14858641/how-to-omit-get-only-properties-in-servicestack-json-serializer/14859968#14859968)
*   有关查询序列化，请参阅[linq2rest](http://linq2rest.codeplex.com)项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:32:10.753

ServiceStack[强烈反对 OData 等不透明的技术](https://stackoverflow.com/a/9579090/85785)。

除此之外，[一旦您公开了一种查询语言](http://blog.ploeh.dk/2012/03/26/IQueryableTisTightCoupling/)，您就失去了对客户绑定的查询空间的控制，并且实际上将失去对重大更改的信心，从而冻结您的底层数据库模式。这[首先与明确定义的服务边界背道而驰](https://stackoverflow.com/a/15369736/85785)。

在需要公开临时查询的情况下，我宁愿使用映射到某些反射的显式字段和可配置/可覆盖的查询构建器，以便我保留完全控制权。

### 使用与 DTO 分离的 ServiceStack 查询示例

尽管 ServiceStack 使用了基于查询的解决方案，例如这个[丰富的 Northwind 数据浏览器](http://northwind.mattjcowan.com/customers)，它附带了[详细解释，解释了所使用的方法](http://www.mattjcowan.com/funcoding/2013/03/10/rest-api-with-llblgen-and-servicestack)。我认为这是比 OData 更好的方法，因为 LLBGen 数据模型与 ServiceStack DTO 分离且易于管理。

# php - 从 xml 获取值并传输到数据库

> ID：15753487
> 
> 赞同：0
> 
> 时间：2013-04-01T23:11:52.047
> 
> 标签：php, html, mysql, xml, loops

我需要帮助。我必须从 xml 中获取值（我尝试使用 simplexml，但它不起作用）。我有这样的事情：

```
<param name="country" type="text">Germany</param>
<param name="city" type="text">Munchen</param> 
```

我想把这个值输入到我的 MySQL 中

```
INSTERT INTO localization SET country='Germany', city='Munchen' 
```

这必须循环完成，因为我有很多价值观有人知道它是如何工作的吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:16:01.617

```
<input name="country" type="hidden" value="germany">
<input name="city" type="hidden" value="Munchen"> 
```

如果您想创建一个值循环，您应该使用 php 并添加会话或发布标签以创建成员或用户选择的循环值。

# java - 根据字符串输入将值插入列表的最快/最干净的方法是什么？

> ID：15753489
> 
> 赞同：0
> 
> 时间：2013-04-01T23:11:56.800
> 
> 标签：java, algorithm, sorting, arraylist

我有一个无法修改的 Java 对象（对象 1），其中包含 25 个 ArrayList。我必须使用另一个对象（对象 2）并根据在对象 2 中找到的字符串将其放入对象 1 的相应列表之一中。每个列表都有一个且只有一个与之关联的唯一字符串，可以在任何对象 2。插入所有对象 2 的最快方法和/或最干净的方法是什么。

现在我只是使用 if/else if 语句来进行排序，并且我不能使用 switch 语句，因为带有 String case 的 switch 语句最近才在 Java SE 7 中实现。

编辑1：修改了标题和问题。这里还有一个例子：

```
if ("1.3.6.1.4.1.19376.1.5.3.1.3.25".equals(root)) {
            physicalExamModel.addVitalSigns(observationModel);
        } else if ("1.3.6.1.4.1.19376.1.5.3.1.1.9.16".equals(root)) {
            physicalExamModel.addGeneralAppearanceObservations(observationModel);
        } else if ("1.3.6.1.4.1.19376.1.5.3.1.1.9.48".equals(root)) {
            physicalExamModel.addVisibleImplantedMedicalDevicesObservations(observationModel);
        } else if ("1.3.6.1.4.1.19376.1.5.3.1.1.9.17".equals(root)) {
            physicalExamModel.addIntegumentarySystemObservations(observationModel);
        } else if ("1.3.6.1.4.1.19376.1.5.3.1.1.9.18".equals(root)) {
            physicalExamModel.addHeadObservations(observationModel);
        } else if ("1.3.6.1.4.1.19376.1.5.3.1.1.9.19".equals(root)) {
            physicalExamModel.addEyeObservations(observationModel); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:21:40.137

假设您的`Object2`实例存储在 some `Array`or`Collection`并且所需的字段是唯一的，您可以将它们存储在 a 中`Map`，然后根据需要将它们取出。

使用 a`TreeMap`他们甚至会被排序：

```
final Collection<Object2> object2s = new LinkedList<>();
final Map<String, Object2> myMap = new TreeMap<>();
for(final Object2 o2 : object2s) {
    myMap.put(o2.getField(), o2);
}

final Object2 desiredObject2 = myMap.get("SomeDesiredValue"); 
```

假设所需的值不是唯一的，那么您可以使用`Collections.sort`自定义比较器对 a 进行排序`List`或`Object2`按所需字段对 a`Arrays.sort`进行排序：`Array`

```
final List<Object2> object2s = new LinkedList<>();
Collections.sort(object2s, new Comparator<Object2>() {

    @Override
    public int compare(Object2 o1, Object2 o2) {
        return o1.getField().compareTo(o2.getField());
    }
}); 
```

具有始终被排序的`Map`优点，即使您`Object2`稍后添加更多，但缺点是属性**必须**是唯一的。否则，该`Collections.sort`方法将正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:14:16.277

为什么不使用`Map<String, List<Foo>>`? 键是“与 [每个列表] 关联的唯一字符串”，值当然是列表本身。

# android - 在android中返回大于1MiB的结果？

> ID：15753493
> 
> 赞同：1
> 
> 时间：2013-04-01T23:12:17.410
> 
> 标签：android, android-activity

`Activity`有没有办法从大于 1 MiB的值中返回一个值？我有一个 2 MiB 大的字节数组，如果我尝试以通常的方式从活动中返回它（startActivityForResult、setResult、finish），我会得到一个

```
"JavaBinder FAILED BINDER TRANSACTION" error. 
```

我知道通过意图传递的数据有 1MiB 的限制。那么我怎样才能返回一个大于 1 MiB 的值呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:54:48.857

我不知道我喜欢这个答案，但您可以将数据分配给应用程序类中的字段，然后从您返回的活动中读取它。哈克，但它应该工作。然后返回一个布尔值，让调用活动知道您是否成功设置数据。

# php - 发送邮件表单 - 从单选按钮获取值

> ID：15753501
> 
> 赞同：0
> 
> 时间：2013-04-01T23:12:57.807
> 
> 标签：php, forms, button, radio, mailing

我已经尝试了在这个网站上找到的许多解决方案，但我似乎无法弄清楚这一点。

我的单选按钮：

```
<input type="radio" id="radio1" name="apartman" />
<label for="radio1">Apartman 1</label>
<input type="radio" id="radio2" name="apartman" />
<label for="radio2">Sunny Shit 2</label>
<input type="radio" id="radio3" name="apartman" />
<label for="radio3">Penthouse</label>
<input type="radio" id="radio4" name="apartman" />
<label for="radio4">Rupčaga</label>
<input type="radio" id="radio5" name="apartman" />
<label for="radio5">Štala Gold Class</label> 
```

这是我在邮件脚本中得到的 PHP：

```
$apartman = $_POST['apartman']; 
```

我不断收到邮件的结果是：

公寓：开

我想得到的结果：

公寓：[所选单选按钮的值]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:18:07.547

唯一区分每个单选按钮的是`id`属性，但是 ID 不用于计算表单数据，您还需要为`value`每个单选按钮添加一个属性，您将获得所需的效果：

```
<input type="radio" id="radio1" name="apartman" value="radio1" />
<label for="radio1">Apartman 1</label>
<input type="radio" id="radio2" name="apartman" value="radio2" />
<label for="radio2">Sunny Shit 2</label>
<input type="radio" id="radio3" name="apartman" value="radio3" />
<label for="radio3">Penthouse</label>
<input type="radio" id="radio4" name="apartman" value="radio4" />
<label for="radio4">Rupčaga</label>
<input type="radio" id="radio5" name="apartman" value="radio5" />
<label for="radio5">Štala Gold Class</label> 
```

# r - R中的Adabag包

> ID：15753503
> 
> 赞同：5
> 
> 时间：2013-04-01T23:13:16.163
> 
> 标签：r, adaboost

我正在尝试使用 R 的 adabag 包进行分类。

以下调用与 R 的 ada 包的 ada() 函数完美配合。

```
model<-ada(factor(label)~., data=trainingdata) 
```

但是当下面的 adabag 的函数调用中使用相同的训练数据集时，它会返回错误：

```
model<-boosting(factor(label)~., data=trainingdata)

Error in `[.data.frame`(data, , as.character(formula[[2]])) : 
undefined columns selected 
```

这个错误究竟暗示了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T00:49:43.293

`boosting`在运行第一个示例的小修改时，我得到了确切的错误消息：

```
> data(iris)
> iris.adaboost <- boosting(factor(Species)~., data=iris, boos=TRUE, mfinal=10)
Error in `[.data.frame`(data, , as.character(formula[[2]])) : 
  undefined columns selected 
```

因此，您应该尝试我刚刚在评论中给出的建议（事先进行 factor()-ing）。公式接口的`boosting`功能不够全，甚至无法处理`factor`其解析树中的函数。

# android - 检测活动是否因为方向改变而重新启动

> ID：15753504
> 
> 赞同：1
> 
> 时间：2013-04-01T23:13:16.200
> 
> 标签：android

如何检测用户是否更改了设备方向，以便在每次重新创建活动时不运行相同的初始化代码？或者如何恢复我的活动状态（包括变量值）？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:25:52.323

推荐的方法是使用[onSavedInstanceState()](http://developer.android.com/training/basics/activity-lifecycle/recreating.html)。这将保存您的`Activity`和变量的状态。

我通常这样做的方式，据说是文档中的最后手段，是自己处理配置更改。在`manifest`你可以声明

```
<activity
    ...
     android:configChanges="orientation"/> 
```

然后在你的`Activity`

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
    // add logic here if you need
} 
```

# jquery - jQuery Mobile 的历史导航或脚本加载问题

> ID：15753511
> 
> 赞同：1
> 
> 时间：2013-04-01T23:13:45.557
> 
> 标签：jquery, jquery-mobile

我对 jQuery Mobile（和 Web 开发）有点陌生，并且有历史问题。

首先，上下文：

*   我必须使用 jQuery Mobile
*   我正在使用单页模板。
*   我现在有大约 10 个网页
*   在每个页面中，我都有一个加载菜单的脚本（menuHeader.html + menuHeader.js）。
*   菜单在“pagecreate”事件中加载

事情是，我在一个页面上“玩”（填写一些字段，使用列表上的 JQM 搜索字段等）。

当我使用 $.mobile.changePage 转到另一个页面时，我可以返回到第一页：我已经得到了页面的确切状态，就像我离开它一样。但是，如 JQM 文档中所述， $.mobile.changePage 仅加载另一个页面的第一个 data-role=page 。

=>因此，我的下一页上没有任何菜单。

另一种方法是使用我的新 URL 设置 location.href 并在每个页面中加载我的脚本（这是我的第一个想法）。如果我这样做，菜单会在每一页上加载，但如果不完全重新加载，我就无法返回上一页。

=> 这意味着我的表格和列表是空的，等等。

=> 另外，如果我在 pagecreate 或 document.ready 上调用 Web 服务，Web 服务似乎又被调用了一次。目前这没什么大不了的，但将来可能会导致性能问题。

是否有一种方法可以在每个页面上加载脚本并能够正确使用历史导航（无需重新加载整个前一页）？一种“超级” changePage ？

我的最后一个解决方案是在每个页面中复制我的菜单，但我真的很想避免这种情况，因为如果颜色、标签或任何必须更改的内容，我不想修改每个页面。

我会很感激一些帮助（这个问题现在让我发疯了一个星期）......

提前致谢 ！

斯蒂芬妮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T02:01:57.373

jQuery Mobile 具有可用作导航栏的持久页眉/页脚功能。 [http://jquerymobile.com/demos/1.2.0/docs/toolbars/footer-persist-a.html](http://jquerymobile.com/demos/1.2.0/docs/toolbars/footer-persist-a.html)。

您所要做的就是`data-id`在所有页面的页眉页脚中添加相同的属性值。

# c# - 如何使用 NewtonSoft Json.Net 将 Json 字典反序列化为平面类

> ID：15753513
> 
> 赞同：4
> 
> 时间：2013-04-01T23:13:53.543
> 
> 标签：c#, json, serialization, json.net, flatten

我从我无法控制的服务中获得了类似的 Json：

```
"SomeKey": 
{
    "Name": "Some name",
    "Type": "Some type"
},
"SomeOtherKey": 
{
    "Name": "Some other name",
    "Type": "Some type"
} 
```

我正在尝试通过使用 NewtonSoft Json.Net 将该字符串反序列化为 .Net 类，它工作得很好，因为我的类现在看起来像这样：

```
public class MyRootClass
{
  public Dictionary<String, MyChildClass> Devices { get; set; }
}

public class MyChildClass
{
  [JsonProperty("Name")]
  public String Name { get; set; }
  [JsonProperty("Type")]
  public String Type { get; set; }
} 
```

然而，我更喜欢我的班级的扁平化版本，没有这样的字典：

```
public class MyRootClass
{
  [JsonProperty("InsertMiracleCodeHere")]
  public String Key { get; set; }
  [JsonProperty("Name")]
  public String Name { get; set; }
  [JsonProperty("Type")]
  public String Type { get; set; }
} 
```

但是，我不知道如何实现这一点，因为我不知道如何访问自定义转换器中的键，如下所示：

[http://blog.maskalik.com/asp-net/json-net-implement-custom-serialization](http://blog.maskalik.com/asp-net/json-net-implement-custom-serialization)

以防万一有人关心，可以找到指向我获得的 Json 字符串的实际示例的页面的链接：[Ninjablocks Rest API documentation with json samples](http://docs.ninja.is/rest/device.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:28:10.923

我不知道是否有办法用 JSON.NET 做到这一点。也许你想多了。如何创建一个单独的 DTO 类型来反序列化 JSON，然后将结果投影到更适合您的域的另一种类型。例如：

```
public class MyRootDTO
{
  public Dictionary<String, MyChildDTO> Devices { get; set; }
}

public class MyChildDTO
{
  [JsonProperty("Name")]
  public String Name { get; set; }
  [JsonProperty("Type")]
  public String Type { get; set; }
}

public class MyRoot
{
  public String Key { get; set; }
  public String Name { get; set; }
  public String Type { get; set; }
} 
```

然后您可以将其映射如下：

```
public IEnumerable<MyRoot> MapMyRootDTO(MyRootDTO root)
{
    return root.Devices.Select(r => new MyRoot
    {
        Key = r.Key,
        Name = r.Value.Name
        Type = r.Value.Type
    });
} 
```

# php - 使用 PHP 中的 SendGrid 向邮件列表中的每个收件人发送单独的电子邮件

> ID：15753518
> 
> 赞同：1
> 
> 时间：2013-04-01T23:14:12.793
> 
> 标签：php, email, sendgrid

我正在发送一封电子邮件，以通知我的用户有关系统中的某些更改。

为了提高可传递性，我想单独发送每封电子邮件，而不是作为一封带有长 cc\bcc 列表的电子邮件。

我遇到的所有教程都谈到了插件，以及将值数组绑定到消息中的占位符的复杂方法。

我正在寻找一种相当简单的方法来做到这一点，使用对 SendGrid 服务器的**单个调用**，最好使用 XSMTP-API 标头，并且没有任何不必要的复杂性。

我已经在网上搜索了几个小时的解决方案，我可以自信地说那里似乎没有适合我的解决方案，所以我不得不打开一个新线程，虽然我很好意识到这是一个常见的话题，我已经阅读了多个关于类似问题的主题。不幸的是，没有一个对我有帮助。

我仅限于旧版本的 sendgrid 或 swiftMailer 库，因为我的生产服务器不支持命名空间。

在此先感谢，O。

伪代码：

```
$conn = $PDOStaticClass::getInstance();
$dbHelper = new DbPdoHelper($conn);

$mailList = $dbHelper->getMailinglist();

//$mailList now contains an associative array with the email addresses with of my clients, what's next? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:34:01.513

使用 SendGrid SMTPAPI 标头，这非常容易。您所要做的就是在发送消息时`to`在标题中添加一组地址，它会自动为列表中的每个人生成一封新电子邮件（不是密件抄送或抄送）。`X-SMTPAPI`例如：

```
"X-SMTPAPI": {
  "to": [
    "ben@example.com",
    "Joe Smith <joe@example.com>"
  ]
} 
```

Ben 和 Joe 都会收到包含相同数据的单独电子邮件。如果您想自定义他们每个人收到的电子邮件，您可以使用替换来完成此操作。有关更多信息，请参阅文档：http: [//sendgrid.com/docs/API_Reference/SMTP_API/index.html](http://sendgrid.com/docs/API_Reference/SMTP_API/index.html)。

您还可以使用[SendGrid PHP 库](https://github.com/sendgrid/sendgrid-php)来简化此过程：

```
$conn = $PDOStaticClass::getInstance();
$dbHelper = new DbPdoHelper($conn);
$sendgrid = new SendGrid('username', 'password');

$mail = new SendGrid\Mail();
$mail->setRecipientsInHeader(true);
$mailList = $dbHelper->getMailinglist();
foreach($mailList as $email) {    
  $mail->addTo($email);
}
// ...
$sendgrid->smtp->send($mail); 
```

# macos - 在 Mac OSX 的终端中，如何使用 shift + 箭头来选择文本？

> ID：15753523
> 
> 赞同：7
> 
> 时间：2013-04-01T23:14:37.497
> 
> 标签：macos, terminal, keyboard-shortcuts

我在 Fedora 上使用终端编码已经有一段时间了。在 Mac 的本地终端上，我发现了一些非常令人不安的事情：

我无法使用 SHIFT + 箭头或其他键盘组合选择文本。使用鼠标选择某些内容真的很痛苦，即使当我用鼠标选择了一些文本时，我也无法使用退格键来删除选定的文本。

无论如何，Mac上是否有任何应用程序可以获得该键盘快捷键？

再见 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:45:19.030

根据[这篇 Macword 文章](http://www.macworld.com/article/1059321/termtext.html)，它[引用了 MacOSXHints.com 提示](http://hints.macworld.com/article.php?story=20060115014737999)……可以通过击键进入`Start Keyboard Selection`模式……</p>

`Option`+ `Command`+`Enter`

*这是在 10.4 是新版本时*写回的，对我来说 .. 在 10.8.3 上不起作用。希望此信息可以引导您找到可行的解决方案。你可以[在这里观看他们的电影](http://media.macworld.com/media/legacy/2007/08/downloads/termtextpasteb.mov)。

# php - 每10秒随机显示一次mysql查询结果

> ID：15753526
> 
> 赞同：0
> 
> 时间：2013-04-01T23:14:44.890
> 
> 标签：php, javascript, jquery

我在 mysql 表中有大量报价，我想每 10 秒在我的网页上显示一个随机报价。我用谷歌搜索了这个问题，但我确实找到了如何从数据库中选择一个随机记录作为第 1 部分以及如何每 10 秒更改一次页面上的文本作为第 2 部分，因此当我将两个部分链接在一起时，我会显示随机报价页面，但它每 10 秒重复一次。所以请帮忙。

```
<?PHP

$dbh = new PDO('mysql:dbname='.$db_name.';host='.$db_host.';charset=utf8', $db_username, $db_password );

$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, 1);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$sql = "SELECT message FROM `fb_messages` ORDER BY RAND( ) LIMIT 1";

try {

    $msg = $dbh->prepare($sql);
    $msg->execute();
    $msgtxt = $msg->fetchAll(PDO::FETCH_COLUMN, 0);
    $txt = json_encode($msgtxt);
    }

    catch(PDOException $e)
{
    echo $e->getMessage();
    die();
}
?>
<html>
<head>
<title>Rotating Text</title>
<script type="text/javascript">
var rotatingTextElement;
var rotatingText = new Array();
var ctr = 0;

function initRotateText() {
rotatingTextElement = document.getElementById("textToChange");
rotatingText[0] = rotatingTextElement.innerHTML; // store the content that's already on the page
rotatingText[1] = "Some Text";
setInterval(rotateText, 5000);
}
function rotateText() {
ctr++;
if(ctr >= rotatingText.length) {
ctr = 0;
}
rotatingTextElement.innerHTML = rotatingText[ctr];
}
window.onload = initRotateText;
</script>
</head>
<body>
<span id="textToChange"><?php echo $txt; ?></span>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T09:02:06.713

要使实际解决方案起作用，您必须每 10 秒使用[ajax](http://api.jquery.com/jQuery.ajax/)调用来加载新的随机数。

理论如下：

*   您使用给定的代码作为第一个随机显示
*   将 setInterval 设置为每十秒调用一次 rotateText（就像现在一样）
*   但是您更改了 rotateText 的主体以向您的服务器发出 ajax 调用，并加载下一个随机引用

函数的主体可能如下（实现时要小心，我假设存在[jQuery 库](http://api.jquery.com/)，并且 url 必须匹配，稍后详述）：

```
function rotateText() {
  $.ajax({
    url: 'your/url/for/the/generator/php',
    dataType: 'text',
    success: function (response) {
      rotatingTextElement.innerHTML = response;
    }
  });
} 
```

为此，您必须创建第二个 php 文件，它什么都不做，只是加载一个随机引用并将其回显到输出，并将 ajax 调用中的 url 指向该 php.ini 文件。

从您的代码中复制：

```
<?php
$dbh = new PDO('mysql:dbname=' . $db_name . ';host=' . $db_host . ';charset=utf8', $db_username, $db_password);

$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, 1);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$sql = "SELECT message FROM `fb_messages` ORDER BY RAND() LIMIT 1";

try {
  $msg = $dbh->prepare($sql);
  $msg->execute();
  $msgtxt = $msg->fetchAll(PDO::FETCH_COLUMN, 0);
  $txt = json_encode($msgtxt);
} catch(PDOException $e) {
  echo $e->getMessage();
  die();
}
header('Content-Type: text/plain');
echo $txt; 
```

这没有其他任何作用，只是加载下一个随机引用，并将其显示为输出中的纯文本行。

使用您定义的数组，您可以执行一些操作，例如用 10-15 个元素预填充数组，然后在它们之间旋转。（这将是真正的旋转，因为上面提到的 ajax 解决方案每十秒给出一个新的随机报价，没有特定的顺序）

# sql-server - TSQL - 使用 Like 进行模式匹配

> ID：15753527
> 
> 赞同：2
> 
> 时间：2013-04-01T23:14:48.537
> 
> 标签：sql-server, database, tsql, pattern-matching

我正在使用 SQL Server 2012。

我知道我可以在查询中使用 Like 来匹配数据库中的模式：

IE

```
SELECT * from PEOPLE where name LIKE 'STEVE%' 
```

将返回所有称为史蒂夫的人。

但是我可以在数据中使用通配符而不是查询。

例如，我有一个数据库，其中包含这些模式

```
Row     Input                 Response
  1     '% is a sort of %'    'I know that.' 
```

我如何能够将“大众汽车是一种汽车”的用户输入与第 1 行中的数据相匹配？

出于背景考虑，我最近一直在研究聊天机器人，它们通常会通过 XML 文件进行这种匹配。

对于奖励积分，我如何将 % 值存储在变量中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:54:05.413

通常你会这样做`WHERE column LIKE @variable`，但为什么你不能反过来呢？

```
DECLARE @x TABLE([Row] INT, Input VARCHAR(32), Response VARCHAR(32));

INSERT @x([Row],Input,Response) SELECT 1, '% is a sort of %', 'I know that.';

DECLARE @variable VARCHAR(32) = 'VW is a sort of Car';

SELECT [Row], Input, Response
    FROM @x
    WHERE @variable LIKE [Input]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T23:30:16.977

您实际上可以使用这种包含模式列表的表，并将这些模式“应用”在这样的查询中：

```
SELECT PT.pattern AS matching_pattern, 
       ST.searched_field AS matched_value
FROM Pattern_Table AS PT
    INNER JOIN Searched_Table AS ST ON ST.searched_field LIKE PT.pattern 
```

这将输出如下内容：

```
matching_pattern    matched_value
% is a sort of %    VW is a sort of Car 
```

[在 SQLFiddle 上查看它](http://sqlfiddle.com/#!2/f9864/1)（即使它是 MySQL 它仍然有效）

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T23:19:44.860

正则表达式将使您能够访问它匹配的模式部分。我假设这就是“将 % 存储在变量中”的意思：

[http://msdn.microsoft.com/en-us/magazine/cc163473.aspx](http://msdn.microsoft.com/en-us/magazine/cc163473.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T23:18:56.567

你可以做一个非常相似的搜索

```
where input like '%is a sort of%' 
```

或者您可以查找正则表达式`regex`以获得更复杂的模式匹配

# tree - 树结构数据的分布式数据库？

> ID：15753529
> 
> 赞同：1
> 
> 时间：2013-04-01T23:15:00.140
> 
> 标签：tree, nosql, neo4j, hierarchical-data, couchbase

我正在寻找一个旨在处理树状结构数据的数据库。我研究过 Neo4j，它很好，但它并不真正支持分片。另一方面，Couchbase 并不是真正为单个数据树构建的（据我了解）。

理论上，数据树很容易在服务器之间拆分，而完整的图表则不然。我不需要完整图表的好处，因为我需要动态拆分大数据集的能力。完整的数据集不适合单个服务器。

我需要的功能是（解释为好像它是一个普通的计算机文件系统）：

1.  选择某些“文件夹”中的每个节点，不包括“子文件夹”
2.  在具有冗余的服务器之间拆分数据库（和负载）

系统负载将主要是读取（大约 90%）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:31:04.520

我发表评论是因为我想尝试提供帮助，并且认为我的链接真的不值得回答。=)

我一直在关注泰坦，现在它似乎非常前沿。阅读文章（[http://thinkaurelius.com/2013/03/30/titan-server-from-a-single-server-to-a-highly-available-cluster/](http://thinkaurelius.com/2013/03/30/titan-server-from-a-single-server-to-a-highly-available-cluster/)）后，他们似乎在使用 Cassandra一些容量，所以卡桑德拉的规模与泰坦的规模紧密相连。

从文章看来，您不必明确分片数据。当它达到一定大小时，它将自动为您分发。

这是关于 Titan 以及它如何使用 Cassandra 的另一个演示文稿：http: [//blog.andreamostosi.name/2013/03/titan-distributed-graph-database/](http://blog.andreamostosi.name/2013/03/titan-distributed-graph-database/)

# database - Blink-tree 如何应对这种情况？

> ID：15753534
> 
> 赞同：1
> 
> 时间：2013-04-01T23:15:30.127
> 
> 标签：database, blink

在 Blink 树中进行插入时，它将存储从根节点到叶节点的路径。并且当子节点分裂时，它会将这种变化传播到父节点。假设在传播研究线程A中的根节点时，当前插入检查堆栈（用于存储路径）并发现堆栈的底部节点是“根”。而“根”也需要分裂。它将创建一个新的根。

那么，如果“根”已经被另一个线程分割并且“根”现在不是真正的根怎么办。因此，由线程 A 创建新根是不正确的。

Blink-tree 如何应对这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T04:45:24.053

我不确定作者打算如何处理这个问题（我确实认为这是真的）。一种可能性是添加一个包含树高度（深度）的标题块和叶子上方每个高度的第一个块的地址。如果您曾经跑出堆栈的末尾，则需要锁定该块并读取它以确定新的根（或者更准确地说，是堆栈中高于树高的第一个块）。如果它在那里，请解锁标题块并将该块添加到您的堆栈中，然后再继续。如果新根不存在，您可以创建它并将其添加到头块，然后再写回索引块（在写入新根之后）。从理论上讲，如果根在上升和下降阶段之间多次分裂，这可能会发生不止一次。

# ios - 核心数据获取特定对象

> ID：15753535
> 
> 赞同：1
> 
> 时间：2013-04-01T23:15:31.127
> 
> 标签：ios, core-data, ios6.1

```
- (NSManagedObjectContext *)anObjectByEntityForName:(NSString *)entityName withValue:(NSObject *)value forKeyPath:(NSString *)keyPath {
NSFetchRequest *request = [[NSFetchRequest alloc] init];
[request setEntity:[NSEntityDescription entityForName:entityName inManagedObjectContext:self.managedObjectContext]];
[request setPredicate:[NSPredicate predicateWithFormat:@"%@ == %@", keyPath, value]];

NSError *error = nil;
NSMutableArray *mutableFetchResults = [[self.managedObjectContext executeFetchRequest:request error:&error] mutableCopy];
if (!mutableFetchResults) {
    [request release];
    [mutableFetchResults release];
    return nil;
}

if ([mutableFetchResults count] == 0) {
    [request release];
    [mutableFetchResults release];
    return nil;
}

id anObject = [mutableFetchResults objectAtIndex:0];
[request release];
[mutableFetchResults release];

return anObject;
} 
```

对于键路径“isSelected”和值@YES，此代码返回 nil。但如果没有谓词，则返回所有对象。在数据库中至少有 1 个符合条件的对象。whit有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:18:50.283

对于键或键路径，您必须使用 %K 格式：

```
[request setPredicate:[NSPredicate predicateWithFormat:@"%K == %@", keyPath, value]]; 
```

显示在[文档中](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795-SW2)

# java - Parent JPanel - 如何监听子 JPanel 的组件生成的事件？

> ID：15753536
> 
> 赞同：2
> 
> 时间：2013-04-01T23:15:39.660
> 
> 标签：java, swing, event-handling, jpanel

我制作了一个 JPanel Child，其中包含几个单选按钮。每当单击单选按钮时，我也希望从子级生成一个 ActionEvent。此操作事件应该“包含”对实际生成事件的按钮的引用。

这个 Child 将用作另一个 JPanel Parent 中的组件，该组件将侦听来自 Child 的事件，而不是侦听单个单选按钮。

我怎样才能做到这一点 ？

到目前为止的代码 -

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class RadioListener extends JPanel implements ActionListener{

public static final String id = "id";

public RadioListener(){

    for(int i = 1; i < 5; i++){
        JRadioButton jrb = new JRadioButton(i + "", false);
        jrb.putClientProperty(id, i);
        this.add(jrb);
        jrb.addActionListener(this);

    }

}

public void actionPerformed(ActionEvent e){

    JRadioButton jrb = (JRadioButton) e.getSource(); 
    Integer id = (Integer) jrb.getClientProperty(RadioListener.id);
    System.out.println("id " + id);

}

public static void main(String[]args){

    JFrame frame = new JFrame("Radio buttons");
    frame.getContentPane().setLayout(new FlowLayout());
    frame.setSize(400, 100);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().add(new RadioListener());
    frame.setVisible(true);

}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:55:34.703

我建议为组件提供作为其他相关方注册兴趣的代理的能力。

这意味着您不需要公开其他组件不应调用或访问的方法/组件。

您还应该为侦听器使用内部类，因为它们将防止暴露其他人不应该访问的其他方法

```
public class ProxyActionListener extends JPanel {

    public static final String id = "id";
    private List<JRadioButton> buttons;

    public ProxyActionListener() {

        buttons = new ArrayList<>(25);
        ActionHandler actionHandler = new ActionHandler();

        for (int i = 1; i < 5; i++) {
            JRadioButton jrb = new JRadioButton(i + "", false);
            jrb.putClientProperty(id, i);
            this.add(jrb);
            jrb.addActionListener(actionHandler);
            buttons.add(jrb);

        }

    }

    public void addActionListener(ActionListener listener) {
        for (JRadioButton btn : buttons) {
            btn.addActionListener(listener);
        }
    }

    public void removeActionListener(ActionListener listener) {
        for (JRadioButton btn : buttons) {
            btn.removeActionListener(listener);
        }
    }

    public static void main(String[] args) {

        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                ProxyActionListener pal = new ProxyActionListener();
                pal.addActionListener(new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent e) {
                        JRadioButton jrb = (JRadioButton) e.getSource();
                        Integer id = (Integer) jrb.getClientProperty(ProxyActionListener.id);
                        System.out.println("Proxy- id " + id);
                    }
                });

                JFrame frame = new JFrame("Radio buttons");
                frame.getContentPane().setLayout(new FlowLayout());
                frame.setSize(400, 100);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.getContentPane().add(pal);
                frame.setVisible(true);
            }
        });
    }

    protected class ActionHandler implements ActionListener {

        @Override
        public void actionPerformed(ActionEvent e) {

            JRadioButton jrb = (JRadioButton) e.getSource();
            Integer id = (Integer) jrb.getClientProperty(ProxyActionListener.id);
            System.out.println("id " + id);

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T01:07:59.770

为了更进一步地了解 MadProgrammer 的建议 (1+)，您可以为此目的使用 Swing Components 固有的 PropertyChangeSupport：

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;

import javax.swing.*;

@SuppressWarnings("serial")
public class RadioListenerTesterHFOE extends JPanel {
   private RadioListenerHFOE radioListenerHfoe = new RadioListenerHFOE();

   public RadioListenerTesterHFOE() {
      add(radioListenerHfoe);
      radioListenerHfoe.addPropertyChangeListener(new PropertyChangeListener() {

         @Override
         public void propertyChange(PropertyChangeEvent pcEvt) {
            if (pcEvt.getPropertyName().equals(RadioListenerHFOE.RADIO)) {
               System.out.println("Radio Selected: " + pcEvt.getNewValue());
            }
         }
      });
   }

   private static void createAndShowGui() {
      RadioListenerTesterHFOE mainPanel = new RadioListenerTesterHFOE();

      JFrame frame = new JFrame("RadioListenerTesterHFOE");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

class RadioListenerHFOE extends JPanel {
   private static final String[] LABELS = {"1", "2", "3", "4"};
   private static final int GAP = 5;
   public static final String RADIO = "radio";
   private ButtonGroup buttonGroup = new ButtonGroup();
   private RadioListenerHandler handler = new RadioListenerHandler();

   public RadioListenerHFOE() {
      setLayout(new GridLayout(1, 0, GAP, 0));
      for (String label : LABELS) {
         JRadioButton radioButton = new JRadioButton(label);
         radioButton.setActionCommand(label);
         radioButton.addActionListener(handler);
         buttonGroup.add(radioButton);
         add(radioButton);
      }      
   }

   private class RadioListenerHandler implements ActionListener {
      private String actionCommand = null;

      @Override
      public void actionPerformed(ActionEvent evt) {
         setActionCommand(evt.getActionCommand());
      }

      private void setActionCommand(String actionCommand) {
         String oldValue = this.actionCommand;
         String newValue = actionCommand;
         this.actionCommand = newValue;
         firePropertyChange(RADIO, oldValue, newValue);
      }
   }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:51:35.370

这个解决方案足够好吗？

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
public class RadioListener extends JPanel{

public static final String id = "id";
private ActionListener privateActionListener;
JRadioButton[] btns = new JRadioButton[5];

public RadioListener(){

    for(int i = 0; i < btns.length; i++){
        JRadioButton jrb = new JRadioButton(i + "", false);
        jrb.putClientProperty(id, i);
        btns[i] = jrb;
        this.add(jrb);      
    }

}

public static void main(String[]args){

    JFrame frame = new JFrame("Radio buttons");
    frame.getContentPane().setLayout(new FlowLayout());
    frame.setSize(400, 100);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    AnActionListener an = new AnActionListener();
    RadioListener rl = new RadioListener();
    rl.setActionListener(an);
    frame.getContentPane().add(rl);
    frame.setVisible(true);

}

public ActionListener getActionListener() {
    return privateActionListener;
}

public void setActionListener(ActionListener privateActionListener) {

    this.privateActionListener = privateActionListener;
    for(int i = 0; i < btns.length; i ++){

        btns[i].addActionListener(privateActionListener);

    }

}

}

class AnActionListener implements ActionListener{

public void actionPerformed(ActionEvent e){

    JRadioButton jrb = (JRadioButton) e.getSource(); 
    Integer id = (Integer) jrb.getClientProperty(RadioListener.id);
    System.out.println("id " + id);

}

} 
```

# visual-studio-2012 - 构建期间生成的通用测试部署项？

> ID：15753539
> 
> 赞同：1
> 
> 时间：2013-04-01T23:15:50.067
> 
> 标签：visual-studio-2012, msbuild

如何将通用测试的部署项指定为构建过程生成的文件？我目前对默认构建过程模板的理解是自动化测试（编辑构建定义->流程->基本->自动化测试）将在指定的解决方案之后运行（我在编辑构建定义中只指定了一个.sln文件->必需- > 要构建的项目 -> 要构建的项目）已成功构建，但我的通用测试包装的可执行文件是在同一 TFS 构建期间编写的文件。

此外：

1.  触发新构建的用户无权编辑构建定义
2.  创建或编辑通用测试时，用户不直接编辑 XML，也无权指定位于构建代理的构建文件夹中的部署项目（使用通用测试 GUI 中部署项目的文件选择器）
3.  我不能使用`DeploymentItem`属性，因为这不是托管代码（如果我错了，请纠正我）

我尝试指定一个公共（或其他用户可访问的）放置目录（编辑构建定义 -> 构建默认值 -> 将构建输出复制到以下放置文件夹），然后从放置目录中指定通用测试的部署项，但我相信这无济于事，因为通用测试是在将构建输出复制到放置文件夹之前运行的，而且我还需要使用先前存在于输出文件夹中的已包装可执行文件的过时副本运行*通用*测试以前成功的构建，以防错误阻止可执行文件的成功新构建被包装以进行通用测试。

这可以通过使用构建定义或通用测试定义中某处可用的环境变量或其他变量来实现吗？

[（复制并改编[自我在 MSDN 上的帖子](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/01d2598f-6f68-4afc-8a9a-4b7358af86fe)）]

# java - Java观察者模式如何处理大量事件

> ID：15753541
> 
> 赞同：0
> 
> 时间：2013-04-01T23:15:54.987
> 
> 标签：java, observer-pattern

我正在开发一个具有客户端和服务器的应用程序。当客户端收到一个数据包时，它需要通知任何屏幕对象需要什么数据包（例如，登录屏幕只对有关登录的数据包感兴趣）。

目前我已经设置了系统，因此所有屏幕对象都会收到任何即将到来的数据包的通知。然后每个屏幕检查通过的数据包是否适用于它自己。

我想知道是否有人知道任何方法，而不是每个屏幕对象都监听每个数据包，网络侦听器只是发送屏幕正在侦听的数据包。（这样我就不必有 100 个 if 语句来检查通过的数据包是否是 a、b、c、d、e、f）。我可以通过为每个数据包实现一个新事件来做到这一点，但这可能会很快变得混乱。

对此事的任何帮助都会令人惊叹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T11:36:54.493

这可能是您的问题的解决方案。创建接口包：

```
public interface Packet {
  public void callListener();
} 
```

为每个数据包创建一个实现*Packet*的类。例如，要管理登录数据包，您可以创建一个*LoginPacket*类：

```
public class LoginPacket implements Packet{
  public void callListener() {
    ListenerLogin.notify(this);
            //you can add additional Listeners

  } 
} 
```

在主类*Reader*中，*读取*数据包时调用特定的侦听器：

```
public class Reader{
  public void parse(Packet p) {
   p.callListener();
}
} 
```

*这样，在parse*方法中就不需要任何 if/else 语句。

# ember.js - Ember.js 数据问题

> ID：15753542
> 
> 赞同：0
> 
> 时间：2013-04-01T23:16:00.017
> 
> 标签：ember.js, ember-data

我`JSON`在这个 URL 的服务器上得到了这种格式的`localhost:8080/contractlines`：

```
{contractlines:[{"id":1,"site":"A","product":"B","price":200}]} 
```

以下是我的 JS 代码：

```
window.App=Ember.Application.create({
  LOG_TRANSITIONS: true
});
App.IndexRoute = Ember.Route.extend({
  setupController: function(controller) {
    console.log('hello');
    // Set the IndexController's `title`
    controller.set('title', "My App");
  }
});

App.Store = DS.Store.extend({
  revision: 12
});

App.Router.map(function() {
  this.resource('contractlines');
});

App.Contractline=DS.Model.extend({
  id: DS.attr('number'),
  site: DS.attr('string'),
  product: DS.attr('string'),
  price:DS.attr('number')
});

App.ContractlinesRoute=Ember.Route.extend({
  model:function(){
    var tr=App.Contractline.find();
    console.log(tr);
    return tr;
  }
});
App.ContractlineController = Ember.ArrayController.extend(); 
```

以下是我的 HTML 代码：

```
 <script type="text/x-handlebars">
 <h1>contractlines</h1>
  {{outlet}}
 </script>

 <script type="text/x-handlebars" data-template-name="contractlines">
  {{#each contractline in controller}}
 <ul class="thumbnails">
    <li>
        {{#linkTo contractlines.contractline contractlines}}
       {{contractline.site}}
        {{/linkTo}}
    </li>
    {{/each}}
</ul>
{{outlet}}

</script> 
```

`localhost:8080/webapp/testember.html#/contractlines`但是，尽管没有错误，但在我访问时没有生成输出。我成功地`JSON`从服务器获取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T13:06:34.487

我不知道这是否是整个问题，但我认为您需要`{{#each contractline in controller}}`向下移动一行（即在打开的 ul 标签下方）。

# template-toolkit - 通过条件语句时打印 HTML 注释

> ID：15753547
> 
> 赞同：0
> 
> 时间：2013-04-01T23:16:40.567
> 
> 标签：template-toolkit

我是 Template Toolkit 的新手，正在尝试更新一些现有的模板，因此我感谢收到的任何帮助。

我已经设置了一个条件语句来检查模块的名称，然后将该名称输出为一个 dirified HTML ID（例如“这是一个标题”->“this_is_a_title”）。

代码：`<div [% IF Tag.module_name %]id="[% Tag.module_name | dirify %]"[% END %]>`

但是，在某些情况下，输入的标题已包含在 HTML 注释中。这超出了我的控制范围，所以我想做的就是以某种方式解决这个问题。我想：

*   剥离评论标签，留下评论文本本身，以便它仍然可以用于 ID；或者
*   忽略使用 HTML 注释的标题，根本不插入 ID 属性

目前，带有 HTML 注释的标题的输出结果为`<div id="">`，这很难看。我已经尝试找到我需要的代码，并多次搜索解决方案，但我似乎无法解决。这可能吗，还是我需要接受空 ID？

更新：在 dirify 过滤器之前为 HTML 传递了一个额外的过滤器，最终工作以删除 HTML 注释并 dirifying 剩余的文本。使用 [% ATtag.list_name | html | dirify %] 有助于输出格式`<!--This is a Title-->`为`this_is_a_title`. 我还能够将上面的原始代码示例简化为简单`<div id="[% Tag.module_name | html | dirify %]">`的输出`<div id="this_is_a_title">`（或任何 dirified 标题最终是什么）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T04:48:17.970

这可能会满足您的需要：

```
[%- SET dirified = Tag.module_name FILTER dirify;
    IF dirified; -%]
    <div id="[% dirified %]">
[%- ELSE -%]
    <div>
[%- END-%] 
```

如果没有 HTML 注释问题的具体示例，就很难说。

# php - 获取数据库中值的总和

> ID：15753548
> 
> 赞同：1
> 
> 时间：2013-04-01T23:16:44.617
> 
> 标签：php, sum

嗨，我已经在 Stackoverflow 中搜索并尝试了一些正确的答案，但没有一个有效。

我试过了

```
$query = "SELECT * FROM Temp";
$query_run = mysql_query($query);
$qty= 0;
While ($num = mysql_fetch_assoc ($query_run)) {
$qty += $num['Price'];
}
echo $qty; 
```

或者

```
$result = mysql_query('SELECT SUM(Price) AS value_sum FROM Temp');
$row = mysql_fetch_assoc($result);
$sum = $row['value_sum']; 
```

都说

> 警告：mysql_fetch_assoc()：提供的参数不是有效的 MySQL 结果资源

有人可以帮助我吗？谢谢

# java - Java KeyBindings：它是如何工作的？

> ID：15753551
> 
> 赞同：0
> 
> 时间：2013-04-01T23:17:29.557
> 
> 标签：java, key-bindings

我一直看到我应该使用 Key Bindings 而不是 KeyListeners。所以我找到了这个页面：[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。我通读了它并尝试实现它。

```
 Action numPressed = new AbstractAction() {
        public void actionPerformed(ActionEvent e) {
            System.out.println("hi");
        }
    };
    this.getInputMap().put(KeyStroke.getKeyStroke("1"), "released");
    this.getActionMap().put("released", numPressed); 
```

我决定看看会发生什么。这个类扩展了一个JPanel。早些时候，我使用`this.setFocusable(true)`. 但是，当我输入“1”时，我看不到任何事情发生。我究竟做错了什么？应该如何实现键绑定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:20:38.183

您的示例仅在面板具有焦点时才有效，请尝试使用`getInputMap(WHEN_IN_FOCUSED_WINDOW)`。

您可能还会发现您的`KeyStroke`语句也不起作用，我建议您尝试使用`KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, true)`它，这将为您提供一个`KeyStroke`响应关键版本的对象。

**更新了示例**

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import javax.swing.AbstractAction;
import javax.swing.ActionMap;
import javax.swing.InputMap;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.KeyStroke;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestKeyBindings04 {

    public static void main(String[] args) {
        new TestKeyBindings04();
    }

    public TestKeyBindings04() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JPanel {

        public TestPane() {
            InputMap im = getInputMap(WHEN_IN_FOCUSED_WINDOW);
            ActionMap am = getActionMap();

            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, false), "pressed");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, true), "released");

            am.put("pressed", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    System.out.println("Pressed");
                }
            });

            am.put("released", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    System.out.println("released");
                }
            });

            setFocusable(true);
            requestFocusInWindow();        
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.dispose();
        }
    }
} 
```

# c++ - c++11：通过别名模板对枚举类类型导数进行类型转换

> ID：15753552
> 
> 赞同：1
> 
> 时间：2013-04-01T23:17:31.890
> 
> 标签：c++, c++11, gcc4.7, enum-class, template-aliases

考虑以下代码，它在 clang 中编译得很好，但在 gcc (4.7.2) 中编译得不好：

```
template<typename T> using remove_ref_typed =
    typename std::remove_reference<T>::type; // alias-template w/ 'typename'

template<typename T> using remove_ref =
    std::remove_reference<T>; // alias-template w/o 'typename'

enum class E : int { E0, E1 }; // some enum class

class C {} obj; // some non-enum class

void proof_of_concept()
{
    remove_ref<C&>::type o1 = obj; // ... gcc ok
    remove_ref_typed<C&> o2 = obj; // ... gcc ok

    remove_ref<E&>::type e1 = E::E1; // ... gcc ok
    remove_ref_typed<E&> e2 = E::E1; // ... gcc internal "bus error"
} 
```

代码在 clang 中编译得很好，但在 gcc (4.7.2) 中，最终语句导致：

```
sandbox_cpp11.cpp:100:22: internal compiler error: Bus error
Please submit a full bug report,
with preprocessed source if appropriate.
See <http://bugzilla.redhat.com/bugzilla> for instructions. 
```

有问题的陈述与前3个陈述之间的区别是：

1.  它涉及枚举类类型，而不是非枚举类类型。
2.  它使用一个别名模板，它声明`typename`并`::type`为方便起见

**我的问题：**以这种方式使用`typename`（在“别名模板”中）是否符合 C++11 标准**，即使**`typename`在不需要说明符的上下文中使用？或者这是 gcc 中的“语言不合规错误”？

# python - 通过 Matlab 的 system() 通过 shell 脚本调用 python 脚本会导致奇怪的错误

> ID：15753556
> 
> 赞同：4
> 
> 时间：2013-04-01T23:18:03.190
> 
> 标签：python, matlab, shell

所以我让 Matlab “呼唤”到一个外部 python 库。Matlab 端使用 dlmwrite() 将双精度矩阵写入文件，通过连接构建命令字符串（它只是一行）：

```
#/bin/tcsh
python myscript.py -option1 long_file_path1 long_file_path2 long_file_path3<br> 
```

这个可怕的长命令被写到一个 shell 脚本中，让它命名为 caller.sh，然后 Matlab 使用 system() 命令成功地在 caller.sh 上调用 chmod 755。

但是，当我尝试在 shell 脚本（即 system(['sh caller.sh']) 上实际运行 system() 命令时，它会因一声巨响而崩溃：

```
Traceback (most recent call last):
  File "/homes/sb1006/PhD_Year_1/code//my_libs/LSTM/python/monohiddenlayer_regression_LSTM.py", line 1, in <module>
    import pybrain
  File "/homes/sb1006/PhD_Year_1/code/my_libs/LSTM/python/pybrain/__init__.py", line 1, in <module>
    from structure.__init__ import *
  File "/homes/sb1006/PhD_Year_1/code/my_libs/LSTM/python/pybrain/structure/__init__.py", line 1, in <module>
    from connections.__init__ import *
  File "/homes/sb1006/PhD_Year_1/code/my_libs/LSTM/python/pybrain/structure/connections/__init__.py", line 1, in <module>
    from full import FullConnection
  File "/homes/sb1006/PhD_Year_1/code/my_libs/LSTM/python/pybrain/structure/connections/full.py", line 3, in <module>
    from scipy import reshape, dot, outer
  File "/usr/lib/python2.7/dist-packages/scipy/__init__.py", line 78, in <module>
    from numpy import show_config as show_numpy_config
  File "/usr/lib/python2.7/dist-packages/numpy/__init__.py", line 137, in <module>
    import add_newdocs
  File "/usr/lib/python2.7/dist-packages/numpy/add_newdocs.py", line 9, in <module>
    from numpy.lib import add_newdoc
  File "/usr/lib/python2.7/dist-packages/numpy/lib/__init__.py", line 13, in <module>
    from polynomial import *
  File "/usr/lib/python2.7/dist-packages/numpy/lib/polynomial.py", line 17, in <module>
    from numpy.linalg import eigvals, lstsq
  File "/usr/lib/python2.7/dist-packages/numpy/linalg/__init__.py", line 48, in <module>
    from linalg import *
  File "/usr/lib/python2.7/dist-packages/numpy/linalg/linalg.py", line 23, in <module>
    from numpy.linalg import lapack_lite
ImportError: /usr/lib/matlab/R2012a/sys/os/glnxa64/libgfortran.so.3: version 'GFORTRAN_1.4' not found (required by /usr/lib/liblapack.so.3gf) 
```

当我从单独的 shell 运行 caller.sh 时（例如，我设置了一个断点，并将 system() 中的命令复制粘贴到终端中），一切运行正常。当我将 caller.sh 的内容直接复制到终端时，它运行良好。

但由于某种原因，Matlab system(['sh caller.sh']) 导致它以最奇怪的方式爆炸，这表明我在自己的 python 脚本中调用的 python 库缺少 Matlab 运行时中的一些线性代数库？！尽管它独立于 Matlab 运行，而且显然如此。我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:13:39.193

我想 Matlab 通过设置的包装器运行，`LD_LIBRARY_PATH`以便 Matlab 可以从`/usr/lib/matlab/R2012a/sys/os/glnxa64/`. 当然，当它们从 matlab 运行时，它们会破坏正确的应用程序，因为它们与这些库的不兼容版本相关联。我只能想到`LD_LIBRARY_PATH`在您的脚本中取消设置，但这不是最干净的解决方案。

# scala - Scala - 蛋糕模式 + 类型类 + 需要构造函数参数的实现

> ID：15753558
> 
> 赞同：1
> 
> 时间：2013-04-01T23:18:25.233
> 
> 标签：scala, typeclass, cake-pattern

这是我尽可能多地提炼出来的一些代码：

```
trait CakeLayer[A] extends {
  // typeclass hack to make it play nice with traits
  implicit def requireTypeclass: MyTypeclass[A]
  val typeclassInVal = requireTypeclass

  /* other stuff */
}

class FooImpl

object FooImpl {
  implicit object FooImplIsTypeclass extends MyTypeclass[FooImpl]
}

// This works perfectly
class Foo extends CakeLayer[FooImpl] {
  override def requireTypeclass = implicitly
}

// This gives me NullPointerException
// Occurs in a function of my "Bar" that contains an anonymous function
// which uses typeclassInVal. it is the first access to that val
// probably due to the parameter in the typeclass constructor?
class BarImpl(x: Int)

object BarImpl {
  class BarImplIsTypeclass(x: Int) extends MyTypeclass[BarImpl]
}

class Bar(x: Int) extends CakeLayer[BarImpl] {
  val typeclass = new BarImpl.BarImplIsTypeclass(x)
  override def requireTypeclass = typeclass
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:08:56.957

简单的变量初始化顺序，从祖先开始。

首先， `typeclassInVal`在祖先特征被初始化。要做到这一点，`requireTypeclass`被称为。它在`Bar`和 access中被覆盖`val typeclass`，尚未初始化，因此此时为 null。所以`typeclassInVal`一劳永逸地初始化为null，并且在第一次使用它时会得到一个NPE。

简单的解决方法可能是没有 val，而只是祖先特征中的 def，或者有一个惰性 val。

# node.js - Nodejs堆栈冲突

> ID：15753559
> 
> 赞同：0
> 
> 时间：2013-04-01T23:18:25.280
> 
> 标签：node.js, backbone.js

我正在开发一个 Nodejs 应用程序来熟悉该框架。据我所知，每个人都使用 expressjs 框架，所以我也安装了它。

我打算使用backbonejs/requirejs。

到目前为止，我对它们如何一起工作或是否应该一起工作感到困惑。Express 想要从我能看到的内容中渲染视图（通过玉）。虽然我计划让主干使用把手来进行渲染。

**我应该将 expressjs 与主干js 一起用于宁静的应用程序吗？**对不起，如果这是一个模糊的问题，只需要一些方向。

还有关于使用这两者的任何体面的最新教程吗？我发现的大多数都过时了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:28:09.253

它们是完全不同的东西（如果我理解正确的话）。您似乎想在客户端使用 Backbone，对吗？（我假设这是因为您使用 Require.js）。如果是这种情况，Backbone 在客户端，而 Express 在服务器上运行。它们只通过 HTTP/Sockets 进行真正的交谈/但是您正在与服务器进行通信，因此您可以使用任何您想要的东西。

您还可以将 Handlebars 用于客户端模板和 Jade 服务器端（尽管让您的 Jade 正确编译到 Handlebars 模板可能有点困难）。但是，如果您愿意，您也可以在服务器上使用带有 Express 的 Handlebars（我在[这里](https://github.com/donpark/hbs)找到了一个模块）。

如果您尝试在服务器端使用 Backbone，您仍然可以这样做，并且它们可以很好地协同工作，但是我无法为您提供太多帮助。

至于教程，即使是日期示例也可以。两者（Backbone 和 Express）完全兼容，我认为您在旧教程中可能遇到的唯一问题是旧版本 Express 中的语法略有不同。

如果您对 Backbone/Express 的特定部分有疑问，但您似乎无法一起工作，请随时提问。

# c++ - C++ 和我的鼠标类全局变量

> ID：15753562
> 
> 赞同：0
> 
> 时间：2013-04-01T23:18:35.520
> 
> 标签：c++, global-variables, scope, extern

我被卡住了，太烦人了...我有发送鼠标坐标的 Windows 消息，并且我有一个可以看到这些坐标的游戏循环，但是当我调用一个查看鼠标坐标的类时，它看不到鼠标坐标，它只是创建自己的鼠标版本，而不管我定义 global.h 并在使用它的 .cpp 文件上引用 extern ：

**鼠标.h**

```
#pragma once

class Mouse
{
public:
    int x;
    int y;
    void MouseMove( int x, int y );
    Mouse();
}; 
```

**全球.h**

```
#include "Mouse.h"

static Mouse mouse; 
```

**Game.cpp //代码片段//**

```
Game::Game( HWND hWnd, Mouse &mouse  )
    :
    gfx( hWnd ),
    mouse( mouse )
{
...
if( scenes[ a ]->interactiveObjects[ b ]->CheckCollision( mouse.x, mouse.y ) )
{
.... // Game is looping if no messages stored, the windows loop updates my mouse coordinates by calling a routine in my Mouse.cpp. My windows loop sends the mouse through as a parameter to my game object which I no longer want to use... I want to use my global mouse as the mouse reference. 
```

“InteractiveObject.cpp”它包含“Global.h”并引用其中声明的鼠标......对吗？那么为什么我的检查碰撞没有看到mouse.x和mouse.y（我必须从我的游戏对象中传递坐标作为参数mouseX和mouseY :(

```
#include "Global.h"
extern Mouse mouse;

#include "InteractiveObject.h"

InteractiveObject::InteractiveObject(  int id_, string title_, Image* theImage_, int type_, int x_, int y_, int z_ )
    : 
    id( id_ ),
    title( title_ ),
    theImage( theImage_ ),
    type( type_ ),
    x( x_ ),
    y( y_ ),
    z( z_ )
{
    pos.x = x_;
    pos.y = y_;
    pos.z = z_;
}

bool InteractiveObject::CheckCollision( int mouseX, int mouseY )
{
    if( 
        mouse.x > x &&
        mouse.x < x + theImage->width &&
        mouse.y > y &&
        mouse.y < y + theImage->height
    )   
    /*if( 
        mouseX > x &&
        mouseX < x + theImage->width &&
        mouseY > y &&
        mouseY < y + theImage->height
    )*/
    {
        return TRUE;
    }

    return FALSE;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:32:11.657

您的 global.h 正在扩展到您包含它的每个文件中。因此，您包含它的每个文件都有一个全局的静态（仅表示此文件）实例化。尝试使用单例模式或将变量声明为 extern标头，然后在 mouse.cpp 中一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:26:53.950

我不是单身的粉丝，但为了暂时控制你的虫子......

使它成为一个[单例](http://en.wikipedia.org/wiki/Singleton_pattern)。

```
class Mouse
{
public:
    int x;
    int y;
    void MouseMove( int x, int y );
    static Mouse & get_mouse()
    {
        static Mouse m;
        return m;
    }
private:
    // Inaccessible outside of Mouse!
    Mouse();
    Mouse( const Mouse & );
}; 
```

现在您的代码将需要调用`Mouse::get_mouse()`以获取唯一的`Mouse`.

您现在可以放心，`Mouse`不会在任何地方意外创建额外的实例。如果发生这种情况，您的编译器会阻止您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T23:31:21.347

在你的 global.h 标题中，你应该有

```
extern Mouse mouse; 
```

在实现文件的文件范围内的代码中的一个位置（并且仅一个位置），您应该有下面的行。InteractiveObject.cpp 可以正常工作。

```
Mouse mouse; 
```

通过这种方式，global.h 向任何包含它的文件单元保证在某处存在 Mouse 类型的鼠标变量。“鼠标鼠标”行实际上分配了该实例。

这样做有架构上的影响，但它会起作用。按照您的方式，任何包含 global.h 的实现文件都会创建它自己的本地“鼠标”实例，该实例与任何其他实例不同。虽然 extern Mouse... 行向链接器承诺“鼠标”存在于全局范围内。

# blackberry-10 - Blackberry 10 Cascades：在标签剪辑文本上设置 textStyle.lineHeight

> ID：15753564
> 
> 赞同：0
> 
> 时间：2013-04-01T23:18:46.547
> 
> 标签：blackberry-10, blackberry-cascades

我有以下 QML（托管在 TabbedPane 中，如果这可能会有所不同）：

```
Container {
    Label {
        text: "Lorem ipsum dolor sit amet, consectetur adipiscing elit."
        multiline: true
        textStyle.fontSize: FontSize.XLarge
        textStyle.lineHeight: 0.8
        textStyle.color: Color.Black
    }
} 
```

将 textStyle.lineHeight 属性设置为小于 1.0 的值符合我的预期，除了标签中文本的底线在底部被剪裁。任何想法如何解决这个问题，或者我做错了什么？

结果的屏幕截图，来自运行 OS 10.0.9.348 的 Dev Alpha B 设备。结果在 10.1 模拟器上看起来相同。

![在此处输入图像描述](https://i.stack.imgur.com/QTS0Z.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:39:20.797

黑莓论坛上的乐于助人的人为我回答了这个问题。

解决方法是在标签文本的末尾添加一个“\n”。这修复了剪裁，但在标签下增加了额外的空间。我们可以通过在包装容器上设置一个负的 bottomPadding 值来解决这个问题。

# asp.net - 在浏览器中访问 WCF 服务

> ID：15753568
> 
> 赞同：0
> 
> 时间：2013-04-01T23:18:55.377
> 
> 标签：asp.net, xml, wcf, iis, xpo

我正在尝试从我的浏览器访问 WCF 网络服务，但是当我从 VS10 中单击 WCFfile 和“*在浏览器中查看*”时，它向我显示：

> 此页面包含以下错误：
> 
> 第 3 行第 2 列的错误：StartTag：无效元素名称
> 
> 下面是第一个错误之前的页面渲染。

我使用 XPO 作为 ORM 和 VS10、IIS8、SQL SERVER 2012 Express 版本。我一直在浏览论坛，但没有找到解决方案。

# javascript - 简单的井字游戏 AI

> ID：15753572
> 
> 赞同：8
> 
> 时间：2013-04-01T23:19:25.947
> 
> 标签：javascript, artificial-intelligence, tic-tac-toe

我知道这已经被问了很多，我已经搜索了其他代码，但我所看到的大部分内容似乎都不是完美无缺的（永远不会丢失），而且简单、优雅和高效。而且我无法决定哪种类型的解决方案适合该描述。

我见过的解决方案是：

(1) 使用带有 alpha-beta 剪枝的 minimax。这对我来说似乎很复杂，对于这样一个简单的游戏来说可能是不必要的？是不是太复杂了？如果不是，我需要做很多硬编码还是我误解了算法？

(2) 使用维基百科的伪代码策略编写代码......我不完全确定如何实现这一点。例如，它只是说“检查分叉”。这些检查中的大多数是否会通过拥有一系列winningLines并检查它们是否会被填写或类似的东西来完成？如果没有，有人可以给我关于什么数据结构的提示或关于如何实现伪代码中提出的检查的任何基本提示：[http](http://en.wikipedia.org/wiki/Tic-tac-toe#Strategy) ://en.wikipedia.org/wiki/Tic-tac-toe#Strategy 。我还看到算法为“X”方和“O”方提供数值，然后使用总和来决定获胜者，但我不明白为什么这特别有用。

还有其他*合理的*解决方案吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-01T23:25:25.613

老实说，在处理 AI 和启发式算法时，最简单的任务会很快变得复杂。极小极大方法将为您提供最佳结果，考虑到您正在实施人工智能这一事实，这应该不会太难。这是一个基于 2 玩家回合的游戏逻辑的既定标准。

看看这个网站......它对井字游戏 AI 和 minimax 实现提供了一些很好的见解。

[http://www.ntu.edu.sg/home/ehchua/programming/java/JavaGame_TicTacToe_AI.html](http://www.ntu.edu.sg/home/ehchua/programming/java/JavaGame_TicTacToe_AI.html)

编辑：

注意到有人写了“蛮力”……这最终将成为实现极小极大启发式算法的一种低效方式。根据其他玩家的最后一步迭代每一个可能的移动只是实现启发式的另一种方式......除了在我看来，它似乎是更多的工作。Minimax 的实现将简单而有效。

编辑2：

“更简单的实现”是相对的。Minimax 是标准，正如我在评论中所说，您可以操纵启发式以适应您正在寻找的情况......

我希望我能告诉你最简单的方法，但是有很多变量取决于你的游戏在代码中的植入。

接受建议，看看你的游戏实现，然后看看最适合你的！

对一个人来说简单的事情，对另一个人来说可能很复杂。我只是想为您提供选择，而极小极大非常可靠。也许尝试调整它以满足您的需求。

编辑3：

如果您需要更多指导，请告诉我。我很乐意提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T23:29:28.447

使用您选择的格式[将此图像](http://xkcd.com/832_large/)“编码”为一组动作。AI 总是会赢或打平。

例如，您可以将其编码如下：

```
var turns = {
  "mefirst":{
    "move":0,
    "next":[
      null,
      {
        "move":4,
        "next":[
          null,
          null,
          {"move":8}, // win
          {"move":8}, // win
          null,
          {"move":8}, // win
          {"move":8}, // win
          {"move":8}, // win
          {
            "move":6,
            "next":[
              null,
              null,
       /* AND SO ON... */
    ]
  }
}; 
```

然后你可以开始：

```
if( ai_goes_first) {
    game = turns.mefirst;
    makeMove(game.move);
}
else game = turns.themfirst;
playerTurn(); 
```

`playerTurn`类似的东西在哪里：

```
function playerTurn() {
    when player clicks a valid squeare {
        game = game.next[chosenSquare];
        makeMove(game.move);
        if( game.next) playerTurn();
    }
} 
```

# algorithm - 什么是可能的循环不变量

> ID：15753583
> 
> 赞同：0
> 
> 时间：2013-04-01T23:20:49.840
> 
> 标签：algorithm, loop-invariant

有人可以为以下简单算法提供一个可能的循环不变量：

输入：`A[0,...,n-1]`和`B[0,...,m-1]`，每个都可能包含重复的元素

输出：第一对 (i,j) 使得`A[i] == B[j]`.

算法：

```
for i <- 0 to n-1
    for j <- 0 to m-1
        if A[i] = B[j] then
           return (i,j)
        endif
    endfor
endfor
return null 
```

到目前为止，我只有一种可能有效或无效的解决方案：

`S = {(i,j) | A[0,...,i-1] and B[0,...,j-1] has no common elements}`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:26:02.037

在第一个循环的迭代`qth`内部的第二个循环的迭代开始`pth`时，`A[i] != B[j]`对于所有`i = 0...p - 1, j = 0...q - 1`.

# python - 如何使用 Pyglet 创建 OpenGL 3.0 上下文

> ID：15753586
> 
> 赞同：3
> 
> 时间：2013-04-01T23:21:01.560
> 
> 标签：python, opengl, py2exe, opengl-3, pyglet

我想使用 OpenGL 3.0 功能（帧缓冲区对象、2D 纹理数组），但 Pyglet 创建的默认 OpenGL 上下文不支持这些。

在 Pyglet 源中有以下示例：[https ://code.google.com/p/pyglet/source/browse/examples/opengl_3.py](https://code.google.com/p/pyglet/source/browse/examples/opengl_3.py)

可悲的是，这个示例最后一次编辑是在 2008 年，似乎不再有效（不再`get_info()`是上下文方法），甚至似乎不再使用`major_version`and参数。`minor_version`

然而，真正起作用的是将 PyOpenGL 与 Pyglet 结合使用。这是访问 OpenGL 3.0+ 的唯一方法吗？无论我最终使用哪种方法，它都必须与 Py2exe 一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T13:18:23.263

`pyglet`应该自动创建最高版本的上下文。您的硬件/驱动程序是否支持 OpenGL 3？

```
$ python -c "from pyglet.window import Window; print(Window().context.get_info
().get_version())"
4.2.0 
```

`major_version`并且`minor_version`似乎也有效：

```
$ python -c "from pyglet.window import Window; \
             from pyglet.gl import Config; \
             print(Window(config=Config(major_version=3, minor_version=2))\
                     .context.get_info().get_version())"
3.2.0 
```

`get_info`仍然[是一个 Context 方法](https://code.google.com/p/pyglet/source/browse/pyglet/gl/base.py#382)。你用什么pyglet？

`get_info`在 pyglet 1.2 之前不是 Context 方法，并且 pyglet 1.1 没有 OpenGL 3 示例。

您应该使用 pyglet 1.2 alpha（或最新源）。

# php - 带有尖括号的意外 preg 行为

> ID：15753591
> 
> 赞同：0
> 
> 时间：2013-04-01T23:21:43.623
> 
> 标签：php, regex

为什么目标字符串中的尖括号会否定第二个示例中的匹配文本。

```
$str = '[example1](example2)';
echo preg_replace('/\[(.*?)\]\((.*)\)/', '$2 $1', $str);

// output: example2 example1

$str = '[example1](<example2>)';
echo preg_replace('/\[(.*?)\]\((.*)\)/', '$2 $1', $str);

// output: example1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:23:37.047

`<example2>`被浏览器解析为标签，所以它不会显示出来。如果您右键单击并查看源代码，您将在那里看到它。同样，如果您通过 CLI 运行它，您将看到正确的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:28:29.890

```
$str = '[example1](<example2>)';

echo $str; 
```

将为您生成`[example1]()`，因为 Web 浏览器假定`<example2>`是 html 标记。**显示**以下结果时也会发生同样的情况。这场比赛碰巧还不错。

```
echo preg_replace('/\[(.*?)\]\((.*)\)/', '$2 $1', $str); 
```

# c# - 我可以指望 ASMX Web 服务应用程序中的线程亲和性吗？

> ID：15753598
> 
> 赞同：1
> 
> 时间：2013-04-01T23:22:18.487
> 
> 标签：c#, asp.net, web-services, thread-safety, asmx

我有一个“企业”项目，它有很多很多层。WinForms 客户端连接到 Web 服务，该服务调用业务层，该业务层从另一个系统调用转换层，该转换层又调用多个包装器以最终更新一个值。不开玩笑——这就是 12 年的持续发展将要做的事情。

我现在必须将一个 ID 从客户端一直传递到数据库层。ID 必须随**每个请求**一起移动。我最初的想法是一直探测它，但这将非常耗时并且几乎是不可能的（几乎一路下来都有大量的静态疯狂）。

所以我正在考虑在 ASP.NET Web 服务应用程序中分配这个`ThreadLocalStorage`ID `Application_BeginRequest`。然后最后一个与数据库对话的库可以读取该值并将其传递给数据库。

我的问题是：我可以计算从`Application_BeginRequest`一直到链中最后一个库的线程亲和性吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:32:52.803

你最好使用[HttpContext.Items](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.items.aspx)。

如果您决定使用异步页面`HttpContext`（包括项目）将正确移动到新线程，但普通 TLS 不会。

请注意，如果您不依赖 ASP.Net 线程管理（即创建自己的线程/使用线程池/或任何类似的方法 `.ParallelFor`），那么您将需要确保正确地将上下文传递给新线程（即在操作早期分配 HttpContex.Current在新线程上）。如果您希望多个线程同时处理单个请求，我建议不要使用`HttpContext.Items`.

# c# - MSDN SocketAsyncEventArgs 示例：创建了多少个线程？

> ID：15753600
> 
> 赞同：1
> 
> 时间：2013-04-01T23:22:42.233
> 
> 标签：c#, .net, msdn

我查看了 MSDN [SocketAsyncEventArgs](http://msdn.microsoft.com/en-us/library/system.net.sockets.socketasynceventargs.aspx)示例，无法完全了解在 100 个无限写入我们客户端的情况下将创建多少线程？

或者如果我们改用`ProcessReceive`某种形式的通信协议来与客户端对话并无限地回读会更好，我们会`ProcessReceive`在 100 个单独的运行线程中，还是在一个线程中有点像 Unity3d 例程？

我很感兴趣，因为在该示例中没有看到任何直接与线程相关的代码，除了`Semaphore`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:29:41.100

对此的答案是“视情况而定”。 `SendAsync`, `AcceptAsync`, 并`ReceiveAsync`使用异步 IO 和完成端口。这是通过 IO 线程的独立线程池完成的。这类似于“其他”线程池的操作——它有一个最小值和最大值。IO 线程池的默认最大值为 1000 [1] 因此可以想象，该示例可能高达 100 个线程。

线程池根据需要创建处于等待状态的线程，并在异步 IO 完成时将这些线程从等待状态中取出以处理结果。

但是，实际上它取决于何时发送数据包以及何时接收数据包。可以想象，如果对所有发送的所有响应都是按顺序发生的，它可能低至 1 个线程。但是，这可能非常罕见。实际上，您可以真正估计的最接近的线程数在 1 到 100 个线程之间，包括 1 到 100 个线程。

您可以通过跟踪`Thread.CurrentThread.ManagedThreadId`每个异步操作来测试这一点。

要记住的重要一点是 Completed 事件是在线程池线程上引发的，并且应该采取常规的线程安全预防措施（例如使用`Semaphore`）。

[1] Joe Duffy，*Windows 上的并发编程*，2008，Addison-Wesley Professional

# php - 如果 $_get 为空，则设置变量默认值

> ID：15753611
> 
> 赞同：-5
> 
> 时间：2013-04-01T23:24:13.213
> 
> 标签：php, xml, variables

下面是我用于我的页面之一的代码，但如果 $_GET['file'] 不存在，我想设置默认文件。

```
$catalogfile = $_GET['file'];
$catalogfileend = "Product_Catalog.xml";
$xmlfile = $catalogfile . $catalogfileend;
$startPage = $_GET['page']; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-01T23:25:15.483

```
$catalogfile = isset($_GET['file']) && file_exists($_GET['file'])
    ? $_GET['file'] : 'defaultfile'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T23:28:53.007

也很高兴检查 $_GET['file'] 不是空的并且是字符串

```
$catalogfile = !empty($_GET['file']) && is_string($_GET['file']) ? 
    $_GET['file'] : 'defaultFile'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T23:25:55.723

用这个：

```
$catalogfile = isset($_GET['file']) ? $_GET['file'] : "DEFAULT File"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-01T23:27:29.460

我会使用：

```
$catalogfile = 'defaultfile';
if (isset($_GET['file']) && file_exists($_GET['file'])) {
    $catalogfile = $_GET['file'];
} 
```

为了更好的可读性。

# mysql - Mysql根据外键的存在改变表时间

> ID：15753612
> 
> 赞同：3
> 
> 时间：2013-04-01T23:24:26.050
> 
> 标签：mysql, indexing, foreign-keys, alter

我们有一种情况，我们有一个表 A 和 B，其中 A 有几千行（大约 50k），B 有几百万行（大约 5M）。表 B 有一列指向表 A 的主键。我们需要在表 A 中添加一列，并担心当 alter 语句运行时，它可能会对表 B 产生读锁。

我的第一个问题是，在更改表 A 时表 B 会被锁定，这是真的吗？如果是，最好先将外键从 B 删除到 A，然后运行 ​​alter 语句，然后重新创建外键。

我们为每个表使用 MySQL 5.5、InnoDB 和单独的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:10:18.830

你试过这个吗？

```
set foreign_key_checks = 0;
ALTER TABLE ...;
set foreign_key_checks = 1; 
```

如果永久删除是安全的，您可以删除外键。但是暂时删除外键约束然后在`ALTER`语句之后再次添加它会是一个开销。

# orchardcms - Orchard 模块覆盖字段驱动程序

> ID：15753614
> 
> 赞同：0
> 
> 时间：2013-04-01T23:24:52.867
> 
> 标签：orchardcms

各位果园人好！

我不确定我想做的事情是否可行，但我想覆盖我正在编写的模块中单个字段的驱动程序。

我想要更多控制的字段是内容选择器字段。基本上我希望内容选择器为其各自的内容项加载形状。我查看了[Sipke 的 Content Picker Widget](http://orchard.codeplex.com/SourceControl/network/forks/sfmskywalker/ContentPickerWidget/changeset/2cfc6b211e7d)以获取有关如何加载形状的示例，但是我不确定在我的模块中实现类似功能的最佳/推荐方法。

我将内容选择器字段附加到我的内容部分，并且内容项标题的默认内容选择器逗号列表按预期显示。我试图在 Placement.info 中定义一个备用，但我无法从备用视图中加载内容项形状。

据推测，按照 Sipke 的示例，这些形状需要在 Driver 中构建并传递。如果这是正确的做法，我怎么能以最少的“黑客”以最果园的方式做到这一点。查看调试器，我可以在我的部分驱动程序中“破解”我需要的字段；但是我正在构建的模块将来会被不熟悉它的人重用，如果他们开始从内容部分添加/删除字段，我希望一切都相应地表现！

当然，如果我必须选择“hacky”选项，我愿意这样做，但前提是我已经用尽了所有其他选项。这是我的第一个模块，在此过程中我学到了很多东西，我真的在尽我所能学习构建果园模块的“正确”方法。

提前致谢！

# debian - 厨师服务器>异常：NoMethodError：未定义的方法“保存”# 运行“刀配置-i”时

> ID：15753617
> 
> 赞同：1
> 
> 时间：2013-04-01T23:25:14.390
> 
> 标签：debian, chef-infra, knife

不确定这个问题是否已得到解决，或者我是否做错了什么。查看当前票证，并没有看到同样的错误。

我正在遵循 Opscode wiki 提供的“在 Debian 或 Ubuntu 上使用软件包安装 Chef 服务器”的安装指南：http: [//wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+或+Ubuntu+使用+包](http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages)

安装似乎很顺利，直到我到达“配置命令行客户端”部分。我从我的用户主目录运行'knife configure -i'并输入以下内容：

```
admin@chef:~$ knife configure -i
Overwrite /home/admin/.chef/knife.rb? (Y/N) y
Please enter the chef server URL: http://chef.website.org:4000
Please enter a clientname for the new client: [admin]
Please enter the existing admin clientname: [chef-webui]
Please enter the location of the existing admin client's private key: [/etc/chef/webui.pem] .chef/webui.pem
Please enter the validation clientname: [chef-validator]
Please enter the location of the validation key: [/etc/chef/validation.pem] .chef/validation.pem
Please enter the path to a chef repository (or leave blank): 
```

...我收到以下错误：

```
Creating initial API user...
ERROR: knife encountered an unexpected error
This may be a bug in the 'configure' knife command or plugin
Please collect the output of this command with the `-VV` option before filing a bug report.
Exception: NoMethodError: undefined method `save' for #<Hash:0x7f9b5d518d08> 
```

运行 'knife configure -i' 时，-VV 选项似乎不适用于 -i 选项

当我使用 -VV 命令运行教程中的下一个命令时，我收到：

```
admin@chef:~$ knife client list -VV
DEBUG: Using configuration from /home/admin/.chef/knife.rb
WARN: Failed to read the private key /home/admin/.chef/admin.pem: #<Errno::ENOENT: No such file or directory - /home/admin/.chef/admin.pem>
/usr/lib/ruby/vendor_ruby/chef/rest/auth_credentials.rb:64:in `load_signing_key': I cannot read /home/admin/.chef/admin.pem, which you told me to use to sign requests! (Chef::Exceptions::PrivateKeyMissing)
from /usr/lib/ruby/vendor_ruby/chef/rest/auth_credentials.rb:34:in `initialize'
from /usr/lib/ruby/vendor_ruby/chef/rest.rb:64:in `new'
from /usr/lib/ruby/vendor_ruby/chef/rest.rb:64:in `initialize'
from /usr/lib/ruby/vendor_ruby/chef/api_client.rb:198:in `new'
from /usr/lib/ruby/vendor_ruby/chef/api_client.rb:198:in `list'
from /usr/lib/ruby/vendor_ruby/chef/knife/client_list.rb:38:in `run'
from /usr/lib/ruby/vendor_ruby/chef/knife.rb:408:in `run_with_pretty_exceptions'
from /usr/lib/ruby/vendor_ruby/chef/knife.rb:168:in `run'
from /usr/lib/ruby/vendor_ruby/chef/application/knife.rb:123:in `run'
from /usr/bin/knife:24 
```

我猜这是来自拒绝运行的“knife config -i”。我在这里做错了什么？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T15:37:23.657

这是因为 ruby​​-json 包中与安全相关的更改。看一下：

[http://community.opscode.com/chat/chef/2013-02-26](http://community.opscode.com/chat/chef/2013-02-26)

[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701629](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701629)

# facebook - Facebook 开放图形图像、HTTP 302 和缓存控制

> ID：15753621
> 
> 赞同：3
> 
> 时间：2013-04-01T23:25:55.127
> 
> 标签：facebook, facebook-opengraph, http-redirect

我不断收到警告，即 og:image 不是来自 Facebook 调试器的正确尺寸，尽管它是。Facebook 一直使用我网站的徽标，而不是我在 og:image 元元素中指定的图像。

我发现这个问题的原因是因为我的图像 URL 正在重定向到 Amazon Web Services 的 S3 存储 URL，因此我为元元素提供的 URL 是一个发送 HTTP 302 状态代码的页面。我认为 Facebook 不遵循重定向的原因是因为我没有随重定向响应发送任何“缓存控制”标头。但是，我不熟悉如何或需要设置哪些标题。那么，为了让 Facebook 满意，我必须设置哪些缓存控制标头？

我使用重定向的原因是，我的图像 URL 可以根据 URL 中包含的参数动态创建各种大小，并在 S3 上缓存调整大小的图像。我做重定向而不是发送数据，因为我宁愿在 AWS 上使用带宽而不是在我的 VPS 上。如果可以的话，我想保留这个设置。

谢谢阅读。非常感谢所有帮助！:)

# c# - 在 ASP.NET MVC 中找不到具有覆盖视图路径（位置格式）的共享布局

> ID：15753626
> 
> 赞同：6
> 
> 时间：2013-04-01T23:26:23.833
> 
> 标签：c#, asp.net, asp.net-mvc, path, viewengine

我正在对视图、控制器和模型进行分组。**结构是**

```
~/Controllers
-- /_Shared
--  -- /Views
--  -- /Content
--  -- /Scripts
-- /Home
-- -- /Models
-- -- /Content
-- -- /Scripts
-- -- /Views
-- -- HomeController.cs
-- /Account
-- -- /Models
-- -- /Views
... 
```

**视图和部分视图有效，但布局**（主视图）**不起作用**。当我在 .cshtml 文件中指定布局时，例如：

```
@{ Layout = "SimpleSharedLayout"; } 
```

我收到此错误：在以下路径中找不到布局页面“SimpleLayout”：

> “~/Controllers/Account/Views/SimpleSharedLayout”。

Asp.NET 仅搜索当前控制器目录中的布局，**而不查看共享文件夹***（位于 ~/Controllers/_Shared/Views）*

虽然这**工作得很好。**

```
@Html.Partial("SharedPartialView") 
```

我必须指定具有完整路径的布局，例如

```
@{ Layout = "~/Controllers/_Shared/Views/SimpleSharedLayout.cshtml"; } 
```

这不是一件难事，但我为无法让它工作而疯狂。

使用 IIS Express、VS 2012、.NET 4.5

**你知道我错过了什么吗？**

**我的视图引擎：**

```
public class AreaViewEngine : RazorViewEngine
{
    public AreaViewEngine()
    {
        AreaViewLocationFormats = new[] {
                         "~/Controllers/{1}/Views/{0}.cshtml",
                         "~/Controllers/_Shared/Views/{0}.cshtml"};

        ViewLocationFormats = AreaViewLocationFormats;

        AreaMasterLocationFormats = new[] { "~/Controllers/_Shared/Views/{0}.cshtml" };

        MasterLocationFormats = AreaMasterLocationFormats;

        AreaPartialViewLocationFormats = new[] { "~/Controllers/_Shared/Views/{0}.cshtml",
                         "~/Controllers/{1}/Views/{0}.cshtml"};

        PartialViewLocationFormats = AreaPartialViewLocationFormats;
    }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:06:07.483

恕我直言，您正在与框架的约定作斗争。我的建议是通过创建区域来按照这些场景的预期方式使用该框架。

我知道这可能不是您想要的答案，但我觉得您所描述的是 T 的区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T21:44:30.170

尝试重载 ViewEngine 并覆盖 AreaMasterLocationFormats 和 MasterLocationFormats。检查这个其他惊人的答案，它可能是你正在寻找的。

[如何在 MVC 中设置默认路由（到某个区域）](https://stackoverflow.com/questions/2140208/how-to-set-a-default-route-to-an-area-in-mvc)

忽略标题，它实际上不是关于路由，而是 viewEngine 在哪里以及如何搜索文件。

# msbuild - MSBuild.ExtensionPack.Xml.XmlFile TaskAction="ReadAttribute" 失败

> ID：15753628
> 
> 赞同：3
> 
> 时间：2013-04-01T23:26:35.187
> 
> 标签：msbuild, msbuildextensionpack

我无法读取`<add name="ReleaseVersion" value="4"/>`下面 app.config 中的 value 属性。我完全不知所措。我怀疑 XPath 值或 Key 值。

### 目标

```
 <Target Name="xxx"
          DependsOnTargets="CopyFilesToOutputDirectory" >

    <ItemGroup>
      <_DestinationAppConfigFile Include="@(AppConfigWithTargetPath->'$(OutDir)%(TargetPath)')" />
    </ItemGroup>

    <MSBuild.ExtensionPack.Xml.XmlFile TaskAction="ReadAttribute"
                                       File="%(_DestinationAppConfigFile.FullPath)"
                                       XPath="/configuration/system.diagnostics/switches/add[@name='ReleaseVersion']/@value"
                                       Value="$(ReleaseVersion)" />

    <Error Condition = " '$(ReleaseVersion)'=='' "
           Text="Failed to read attribute." />

    <Message Text="ReleaseVersion: $(ReleaseVersion)"
             Importance="high" />

  </Target> 
```

### 应用程序配置

```
 <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <system.diagnostics>
      <switches>
        <!-- ReleaseVersion (Conditional release switch); 0- = PRODUCTION, 1 = MIRROR, 2 = EMERGENCYRELEASE, 3 = USERACCEPTANCETESTING, 4 = QA, 5 = DEVELOPMENT, 6 = DRN DEVELOPMENT -->
        <add name="ReleaseVersion" value="4"/>
        <!-- Stop (Stops execution to allow for Just-In-Time (JIT) debugging); 0 = CONTINUE EXECUTION, 1 = LAUNCH DEBUGGER -->
        <add name="Stop" value="0"/>
      </switches>
    </system.diagnostics>
  </configuration> 
```

### 更新

我查看了 http://msbuildextensionpack.codeplex.com/SourceControl/changeset/view/83099#1714660 的代码`XmlFile.ReadAttribute`，[它](http://msbuildextensionpack.codeplex.com/SourceControl/changeset/view/83099#1714660)使用`SelectSingleNode`命名空间语法进行调用。这可能是问题所在。

```
 private void ReadAttribute()
    {
        if (string.IsNullOrEmpty(this.XPath))
        {
            this.Log.LogError("XPath is Required");
            return;
        }

        this.LogTaskMessage(string.Format(CultureInfo.CurrentUICulture, "Read Attribute: {0}", this.XPath));
        XmlNode node = this.xmlFileDoc.SelectSingleNode(this.XPath, this.namespaceManager);
        if (node != null && node.NodeType == XmlNodeType.Attribute)
        {
            this.Value = node.Value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T03:46:24.483

您的示例代码几乎是正确的；它只需要对 XmlFile 任务的用法稍作改动。对 XmlFile ReadAttribute 的调用应将**Value**声明为任务的输出。为此，[请将 Output 元素添加到任务声明](http://msdn.microsoft.com/en-us/library/ms164287.aspx)中，将`TaskParameter`值设置为“Value”并将`PropertyName`值设置为“ReleaseVersion”，类似于以下内容：

```
<MSBuild.ExtensionPack.Xml.XmlFile 
        TaskAction="ReadAttribute"
        File="[example-path-to-app-config]"
        XPath="/configuration/system.diagnostics/switches/add[@name='ReleaseVersion']/@value">
    <Output TaskParameter="Value" PropertyName="ReleaseVersion" />
<MSBuild.ExtensionPack.Xml.XmlFile> 
```

进行更改后，任务应该找到/读取属性值，假设您的 ToolsVersion 设置为您的特定 MSBuild 扩展包实现所需的版本

# android - Android溢出滚动错误？事件在滚动时不跟随元素

> ID：15753630
> 
> 赞同：1
> 
> 时间：2013-04-01T23:26:49.093
> 
> 标签：android, css, mobile, overflow

我在一个 Android 网站上工作，似乎无法让溢出滚动在我的平板电脑上正常工作。

在我的设备上，这些项目会像您期望的那样在视觉上滚动。但是，当您按下滚动项目时，如果没有发生滚动，它会返回本应位于该位置的项目。在下面的示例中，如果您滚动到最底部并按下`Link 8`，它将返回`Link 4`。

我正在使用普通浏览器（“Internet”版本 4.0.4-UELPL）在三星 Galaxy Tab（10.1"）上运行 Android 4.0.4。

这是我的测试用例：http: [//jsfiddle.net/davishmcclurg/EhJrS/](http://jsfiddle.net/davishmcclurg/EhJrS/)

HTML：

```
<ul>
    <li>Link 1</li>
    <li>Link 2</li>
    <li>Link 3</li>
    <li>Link 4</li>
    <li>Link 5</li>
    <li>Link 6</li>
    <li>Link 7</li>
    <li>Link 8</li>
</ul> 
```

CSS：

```
html, body {
    height: 100%;
    margin: 0;
}

ul {
    height: 100%;
    overflow: auto;
    margin: 0;
}

ul li {
    height: 25%;
} 
```

JS：

```
var els = document.getElementsByTagName("li");
for (var i = 0; i < els.length; i += 1) {
    els[i].onclick = function () { alert(this.innerHTML); };
} 
```

# python - dev_appserver.py 给我一个错误

> ID：15753632
> 
> 赞同：3
> 
> 时间：2013-04-01T23:27:28.300
> 
> 标签：python, google-app-engine

在 OS X Lion 上将 GAE 升级到 1.7.6 后，运行 dev_appserver.py 时出现无法解决的错误。它在以前的版本中运行良好。最初错误说我需要使用 pip 安装 PyObjC 和 PIL。现在，它说`can't open file '/usr/local/bin/_python_runtime.py': [Errno 2] No such file or directory`。这是完整的错误：

```
INFO     2013-04-01 23:01:15,091 sdk_update_checker.py:244] Checking for updates to the SDK.
INFO     2013-04-01 23:01:15,660 sdk_update_checker.py:272] The SDK is up to date.
INFO     2013-04-01 23:01:15,705 api_server.py:152] Starting API server at: http://localhost:50096
INFO     2013-04-01 23:01:15,721 dispatcher.py:98] Starting server "default" running at: http://localhost:8080
INFO     2013-04-01 23:01:15,759 admin_server.py:117] Starting admin server at: http://localhost:8000
/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python: can't open file '/usr/local/bin/_python_runtime.py': [Errno 2] No such file or directory
ERROR    2013-04-01 23:01:15,785 http_runtime.py:221] unexpected port response from runtime ['']; exiting the development server
INFO     2013-04-01 23:01:16,775 api_server.py:517] Applying all pending transactions and saving the datastore
INFO     2013-04-01 23:01:16,775 api_server.py:520] Saving search indexes
Exception in thread Thread-1 (most likely raised during interpreter shutdown) 
```

[我在这里](https://stackoverflow.com/questions/15696835/app-engine-development-environment-fails-to-launch-app)找到了关于此的类似帖子，但它是在 Windows 7 机器上，并且似乎他没有找到解决方案（或者他可能找到了但没有跟进）。有任何想法吗？

编辑：它适用于 GoogleAppEngineLauncher GUI，但不适用于命令行。不知道为什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-24T18:41:28.977

从我对 Fat Lotus 的回复来看，这对我有用：

我再次更新了 GAE Launcher，它重新创建了符号链接，现在它工作正常。当前`/usr/local/bin/_python_runtime.py`链接到的符号链接是`/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-de‌​fault.bundle/Contents/Resources/google_appengine/_python_runtime.py`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T16:22:24.617

我也遇到过这个问题（与 Homebrew 安装有关）；我已经设法通过使用以下方法使事情正常进行：

```
ln -s /usr/local/Cellar/google-app-engine/1.7.5/share/google-app-engine/_python_runtime.py /usr/local/bin/_python_runtime.py 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-24T00:10:18.167

关于找不到 _python_runtime.py，我看到了同样的错误。这是由于没有通过首先将应用程序复制到本地驱动器来运行 GoogleAppEngineLauncher 造成的。

确保您仔细阅读错误消息，因为我一开始并没有阅读所有错误消息。从本地磁盘运行安装程序解决了这个问题，至少对我来说。

# c# - C# 可移植类库 - 如何包含 System.Data.Linq

> ID：15753635
> 
> 赞同：12
> 
> 时间：2013-04-01T23:27:45.490
> 
> 标签：c#, windows-phone, portable-class-library

是否可以在可移植类库项目中引用 System.Data.Linq？

**注意：** 我只是想在 WP8 和 WinStore8 应用程序 [DataContext] 之间共享代码

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-01T23:44:50.130

不它不是。数据命名空间在 PCL 中不可用。

您可以知道，因为[http://msdn.microsoft.com/en-us/library/system.data.aspx](http://msdn.microsoft.com/en-us/library/system.data.aspx)它的所有成员都没有 PCL 图标，并且它没有在[http://msdn.microsoft.com/上列出zh-CN/图书馆/vstudio/gg597391%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/vstudio/gg597391%28v=vs.100%29.aspx)

# heroku - 如何从 heroku 访问私有 github 存储库？

> ID：15753641
> 
> 赞同：7
> 
> 时间：2013-04-01T23:28:19.260
> 
> 标签：heroku, ssh-keys

我有一个私人仓库，我在部署到 Heroku 时尝试访问它。但是，Heroku 不允许我克隆私人仓库，并给我以下错误（如我所料）：

```
Host key verification failed.
       fatal: The remote end hung up unexpectedly
       Git error: command `git clone
       'git@github.com:pr/lm-models.git'
       "/tmp/build_3r0z0znww0zda/vendor/bundle/ruby/1.9.1/cache/bundler/git/lm-models-aab025aaadbe07202b16e1db7505ae1726f8723a"
       --bare --no-hardlinks` in directory /tmp/build_3r0z0znww0zda has failed.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

我找到了这个，但不想以明文形式显示我的用户名/密码：

[将heroku应用程序链接到私人（组织）github repo](https://stackoverflow.com/questions/13066860/linking-heroku-app-to-a-privateorganization-github-repo)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-10-15T22:13:42.557

这对我有用：

1.  生成[Github 访问令牌](https://help.github.com/articles/creating-an-access-token-for-command-line-use/)
2.  在 requirements.txt 列出私有模块如下：

    ```
    git+https://your_user_name:your_git_token@github.com/your_company/your_module.git 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-11-02T12:17:10.787

Heroku 仅支持使用 Git 开箱即用的 HTTP(S) Basic 身份验证。这很不幸，因为这意味着您需要将您的凭据添加为安装 URL 的一部分，并将其作为纯文本提交到您的依赖项列表中。要让您的应用支持 SSH 密钥，请执行以下操作：

1.  [创建一个新的 SSH 密钥](https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#generating-a-new-ssh-key)，Heroku 将使用它来访问 GitHub 存储库。选择一个不同的名称，例如`id_rsa_heroku`。
2.  将密钥的公共部分添加到您的 GitHub 帐户（[设置链接](https://github.com/settings/keys)）。
3.  使用[heroku-buildpack-ssh-key](https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-ssh-key)：`heroku buildpacks:add https://github.com/heroku/heroku-buildpack-ssh-key.git -i 1`
4.  将密钥的私有部分设置为 Heroku 应用程序的环境变量：`heroku config:set BUILDPACK_SSH_KEY=$(cat ~/.ssh/id_rsa_heroku)`

从这一刻起，Heroku 应该能够从您有权访问的任何私有存储库中访问和下载代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T02:40:18.850

您需要在 Gemfile 中使用用户名/密码，或者提供依赖项。你也可以使用 Gemfury（假设它是一个 gem）：

*   [https://devcenter.heroku.com/articles/git-submodules#vendoring](https://devcenter.heroku.com/articles/git-submodules#vendoring)
*   [http://gembundler.com/v1.3/bundle_package.html](http://gembundler.com/v1.3/bundle_package.html)
*   [https://devcenter.heroku.com/articles/gemfury](https://devcenter.heroku.com/articles/gemfury)

# git - 在 git 中使用两个存储库

> ID：15753642
> 
> 赞同：3
> 
> 时间：2013-04-01T23:28:20.377
> 
> 标签：git, bitbucket

我和我的朋友正在处理一些小项目，但我们遇到了 Git 问题。我们有一个由我创建的主存储库。我的朋友将它分叉并将其克隆到他的本地机器上。

现在，当我进行一些更改时，我通过执行以下操作将提交推送到我的存储库：

```
git add -u
git commit -m "message"
git push origin master 
```

我正在通过`git pull`命令从存储库中获取更改。

我的朋友正在通过执行命令来提交更改：

```
git add -u
git commit -m "message"
git push origin master 
```

`git pull upstream master`他正在通过命令从 repo 中获取更改。

在我们这样做之后，我们在同步我们的存储库时遇到了问题。当我的朋友创建拉取请求时，它说存在冲突......每次我们推送提交时都会发生这种情况。

如果我的朋友做了一些更改并创建了 Pull Request，git 会自动将他的代码行添加到我的 repo 中而不会发生任何冲突，如何让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T01:46:09.847

好吧，如果您更改同一行代码，显然您会遇到冲突 - 这是正常的，这就是您想要发生的事情。你不会合并你没有测试过的代码。

因此，在执行 Pull Request 之前，任何发送它的人都应该`pull`（基本上：`pull`= `fetch`+ `merge`）从您的存储库中获取最新更改，解决冲突并确保其版本是最新的。

然后，如果您在接受 PR 之前将新提交推送到您的存储库，则 PR 将过期并且无法自动合并。因此，您可以将您的朋友分支拉到您自己的工作场所并解决冲突 - 或者您让您的朋友`pull`再次成为您的主分支等等。

不过，当与某人密切合作时，我总是更愿意给我的同事写作许可；所以他可以随心所欲地推动。

这里唯一真正重要的是，在将任何分支合并到另一个分支之前，该分支必须是最新的（`pull`并且冲突已解决）。

# java - Java - 私有内部类的对象作为外部类构造函数的参数

> ID：15753643
> 
> 赞同：1
> 
> 时间：2013-04-01T23:28:27.047
> 
> 标签：java, constructor, private, inner-classes

```
public class Person
{
    private class Date
    {
        public Date(int month, int day, int year)
        {
            ...
        }
    }

    private String name;
    private Date birthDate;

    public Person(String name, Date birthDate)
    {
        ...
    }
} 
```

上面，我有一个外部类 Person 和一个私有内部类 Date。Person 对象的构造函数应将 Date 作为其参数之一。

```
public class Test
{
    public static void main(String[] args)
    {
        Person testPerson = new Person("Mr. Sandman", new Date(1, 1, 1970));
    }
} 
```

但是，当我尝试在单独的“测试”文件 Test.java（上图）（与我的 Person.java 文件位于同一文件夹中）中创建 Person 对象时，出现错误。

错误是这样的：“错误：没有为 Person(String,Date) 找到合适的构造函数”（编译器引用了我实例化 testPerson 的行作为错误的原因。）

问题：我做错了什么？另外，如何创建 Person 对象并将 Date 对象传递给 Person 的构造函数？（如果 Date 是 Person 的私有内部类，这是否可能？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:31:41.577

`Date`是 的私有内部类`Person`，因此您将无法从另一个（非 Person）类创建它的实例。两件事情：

*   为了使您当前的设计工作，将访问权限`Date`从私有更改为公共
*   您还需要为`Person`该类创建一个默认构造函数，因为您需要它的一个实例来创建内部类。
*   请考虑更改您的内部类名称。SDK中已经有一个`Date`类。

老实说，您应该`Date`按照其他人的建议将您的课程创建为独立课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:37:29.853

您可以添加一个将 a作为第二个参数的新`Person`构造函数，并从该对象创建一个对象（可能通过一个对象）。`java.util.Date``Person.Date``java.util.Date``Calendar`

你也可以让你现有的构造函数`private`，因为没有人能够使用它。

# c - c函数的汇编代码

> ID：15753646
> 
> 赞同：5
> 
> 时间：2013-04-01T23:28:42.740
> 
> 标签：c, assembly, x86

我试图理解 C 函数的汇编代码。我不明白为什么`andl -16`主要是这样做的。是否为局部变量分配空间。如果是这样，为什么`subl 32`要为 main 完成。

我无法理解`func1`. 对于 8086 处理器，在读取时堆栈从高位地址增长到低位地址。所以这里为什么访问在 ebp 的正面（用于参数偏移），为什么不在 ebp 的负面。func1 中的局部变量是 3 + 返回地址 + 保存的寄存器 - 所以它必须是 20，但为什么是 24？( `subl $24,esp`)

```
#include<stdio.h>
int add(int a, int b){
 int res = 0;
 res = a + b;
 return res;
}
int func1(int a){
 int s1,s2,s3;
 s1 = add(a,a);
 s2 = add(s1,a);
 s3 = add(s1,s2);
 return s3;
}
int main(){
 int a,b;
 a = 1;b = 2;
 b = func1(a);
 printf("\n a : %d b : %d \n",a,b);
 return 0;
} 
```

汇编代码：

```
 .file   "sample.c"
        .text
.globl add
        .type   add, @function
add:
        pushl   %ebp
        movl    %esp, %ebp
        subl    $16, %esp
        movl    $0, -4(%ebp)
        movl    12(%ebp), %eax
        movl    8(%ebp), %edx
        leal    (%edx,%eax), %eax
        movl    %eax, -4(%ebp)
        movl    -4(%ebp), %eax
        leave
        ret
        .size   add, .-add
.globl func1
        .type   func1, @function
func1:
        pushl   %ebp
        movl    %esp, %ebp
        subl    $24, %esp
        movl    8(%ebp), %eax
        movl    %eax, 4(%esp)
        movl    8(%ebp), %eax
        movl    %eax, (%esp)
        call    add
        movl    %eax, -4(%ebp)
        movl    8(%ebp), %eax
        movl    %eax, 4(%esp)
        movl    -4(%ebp), %eax
        movl    %eax, (%esp)
        call    add
        movl    %eax, -8(%ebp)
        movl    -8(%ebp), %eax
        movl    %eax, 4(%esp)
        movl    -4(%ebp), %eax
        movl    %eax, (%esp)
                                      call    add
        movl    %eax, -12(%ebp)
        movl    -12(%ebp), %eax
        leave
        ret
        .size   func1, .-func1
        .section        .rodata
.LC0:
        .string "\n a : %d b : %d \n"
        .text
.globl main
        .type   main, @function
main:
        pushl   %ebp
        movl    %esp, %ebp
        andl    $-16, %esp
        subl    $32, %esp
        movl    $1, 28(%esp)
        movl    $2, 24(%esp)
        movl    28(%esp), %eax
        movl    %eax, (%esp)
        call    func1
        movl    %eax, 24(%esp)
        movl    $.LC0, %eax
        movl    24(%esp), %edx
        movl    %edx, 8(%esp)
        movl    28(%esp), %edx
        movl    %edx, 4(%esp)
        movl    %eax, (%esp)
        call    printf
        movl    $0, %eax
        leave
        ret
        .size   main, .-main
        .ident  "GCC: (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5"
        .section        .note.GNU-stack,"",@progbits 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:55:50.017

通过`andl $-16, %esp`清除低四位，将堆栈指针对齐到 16 字节的倍数。

唯一使用正偏移的地方`(%ebp)`是参数访问。

您没有说明您的目标平台是什么或您用于编译的开关。汇编代码显示已插入一些 Ubuntu 标识符，但我不熟悉它使用的 ABI，除此之外它可能类似于通常用于 Intel x86 架构的 ABI。所以我猜测 ABI 在例程调用中需要 8 字节对齐，因此编译器将堆栈帧设为`func1`24 字节而不是 20 字节，以保持 8 字节对齐。

我将进一步猜测编译器在开始时将堆栈对齐为 16 字节`main`作为编译器中的一种“首选项”，以防它使用更喜欢 16 字节对齐的 SSE 指令，或其他更喜欢 16 字节对齐的操作.

所以，我们有：

在`main`中，`andl $-16, %esp`作为编译器首选项，将堆栈对齐为 16 字节的倍数。内部`main`,`28(%esp)`和`24(%esp)`引用编译器保存在堆栈中的临时值，而`8(%esp)`,`4(%esp)`和`(%esp)`用于将参数传递给`func1`和`printf`。我们从汇编代码调用`printf`但在您的代码中注释掉的事实中看到，您粘贴的 C 源代码与用于生成汇编代码的 C 源代码不同：这**不是**从C 源代码。

在`func1`中，堆栈上分配了 24 个字节而不是 20 个，以保持 8 字节对齐。在内部`func1`，通过`8(%ebp)`和访问参数`4(%ebp)`。从`-12(%ebp)`到`-4(%ebp)`的位置用于保存变量的值。`4(%esp)`并`(%esp)`用于将参数传递给`add`.

这是堆栈帧`func1`：

```
    - 4(%ebp) = 20(%esp): s1。
    - 8(%ebp) = 16(%esp): s2。
    -12(%ebp) = 12(%esp): s3。
    -16(%ebp) = 8(%esp)：未使用的填充。
    -20(%ebp) = 4(%esp)：传递 add 的第二个参数。
    -24(%ebp) = 0(%esp)：传递 add 的第一个参数。

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T23:53:32.053

我建议通过它的输出来解决这个问题，`objdump -S`它会给你与 C 源代码的相互列表。

# java - Java 字符串数组获取基于 n!/r!(nr)! 的所有组合！

> ID：15753658
> 
> 赞同：0
> 
> 时间：2013-04-01T23:30:48.003
> 
> 标签：java, arrays, string, recursion, combinations

我试图搜索它，但还没有找到明确的答案。我正在尝试编写一个程序，将字符串数组与另一个字符串数组的所有组合进行比较，但这些组合的元素数量与前一个数组相同。为了更好地解释，假设我有两个字符串数组，n = {alpha,beta,gamma,delta,epsilon} 和 r ={beta,gamma,delta}。现在我想做的是，从集合'n'中获取所有组合（每个组合中的三个字符串）并将集合'r'与它们全部进行比较。如果我得到匹配，然后执行一些操作。我知道要获得所有组合，我需要应用公式，

```
 nCr = n!/r!(n-r)!   (where 0<=r<=n) 
```

在我的例子中，n = 5，r = 3，总共有 10 种组合。我需要生成所有这些组合（在本例中为 10 个）并将它们与数组“r”进行比较。我还没有一个起点，我不希望得到答案，但对如何实现它有一点了解（可能会递归完成？）会很棒！提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:22:37.357

鉴于您在评论中提供的其他上下文，这就是我的建议。

将*n*变成一个集合以便于查询：

```
String[] n = {"alpha", "beta", "gamma", "delta", "epsilon"};
Set<String> nset = new HashSet<String>();
nset.addAll(Arrays.asList(n)); 
```

现在您可以检查它是否包含*r*的所有元素：

```
String[] r = {"beta", "gamma", "delta"};
if (nset.containsAll(Arrays.asList(r))) {
  // do something
} 
```

这可以用多个不同的*r*数组重复，它比遍历所有可能的*n*子集并将它们与特定的*r*进行比较更有效。

# javascript - 在两个重叠的椭圆形状区域内生成随机点

> ID：15753662
> 
> 赞同：2
> 
> 时间：2013-04-01T23:31:00.277
> 
> 标签：javascript, math, random, shapes

使用 JavaScript、PHP 或伪代码，有人可以展示如何在两个重叠的椭圆形状之间的区域内生成随机点吗？如果您看一下下图，黑色标记的区域将是要填充的区域。

如果您假设两个椭圆形状都与其中心在 0, 0 处对齐，并且我们给内部椭圆的 x 轴大小为 200，y 轴为 150，则较大的椭圆（黑色区域的外边缘）具有 x - 轴大小为 300，y 轴大小为 250。

![一个椭圆形状，以黑色显示该区域以在内部生成点](https://i.stack.imgur.com/N6IM3.jpg)

我知道我可以只取一个矩形区域并生成随机点，然后检查它们与中心的距离，看看它们是否落入黑色区域，但如果可能的话，我想要一种更复杂、更少浪费的方法来做这件事！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T01:41:54.000

现在是凌晨 4 点，所以我建议仔细检查我写的所有内容。也就是说，变换中出现雅可比行列式，

x = √r * cosθ
y = √r * sinθ

是 det( cosθ / 2√r, - √r * sinθ ; sinθ / 2√r, √r * cosθ ) = (cosθ)^2 / 2 + (sinθ)^2 /2 = 1/2。这意味着它是恒定的。因此，笛卡尔坐标中区域 A 的任何区域都映射到新坐标系中的“变形区域”A/2 区域。由于原始区域的位置完全独立，因此我们得出结论，如果原始区域是，则该（和均匀的延伸）必须是均匀分布。这意味着您只需统一采样以匹配您的区域：

```
var r = 80,
    R = 120,
    _r = Math.sqrt(Math.random()*(R*R-r*r)+r*r),
    theta = Math.random()*2*Math.PI;
plot(_r*Math.cos(theta),_r*Math.sin(theta)/4); 
```

[http://jsfiddle.net/SQERh/](http://jsfiddle.net/SQERh/)

这与您的描述略有不同，因为您的内椭圆不是外椭圆的均匀拉伸，这使得类似的极坐标变换更加复杂，因为半径成为角度的函数。

# javascript - 具有 2 个不同日期的 Angular Datepicker

> ID：15753665
> 
> 赞同：0
> 
> 时间：2013-04-01T23:31:11.437
> 
> 标签：javascript, jquery, angularjs, datepicker

我尝试使此脚本适用于 2 个不同的日期：

[http://fiddle.jshell.net/yXjkq/1/](http://fiddle.jshell.net/yXjkq/1/)

它适用于第一个，但不适用于第二个。我试图理解为什么？

JavaScript：

```
var mySecondModule = angular.module('MyReportModule', []);

function TheReportCtrl($scope) {
    $scope.selectedDate = "Aladdin";
    $scope.selectedDate2 = "Aladdin2";
}
mySecondModule.directive('datepicker', ['$parse', function($parse) {
    return {
        restrict: "A",
        link: function(scope, element, attrs) {
            //using $parse instead of scope[attrs.datepicker] for cases
            //where attrs.datepicker is 'foo.bar.lol'
            parsed = $parse(attrs.datepicker);
            $(element).datepicker({
                onSelect: function(dateText, inst) {
                    scope.$apply(function(){
                        parsed.assign(scope, dateText);
                    });
                }
            })
        }
    }
}]); 
```

HTML：

```
<div ng-app="MyReportModule">
  <div ng-controller="TheReportCtrl">

   <input type="text" datepicker="selectedDate" />{{selectedDate}} 
   <input type="text" datepicker="selectedDate2" />{{selectedDate2}} 

</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:55:24.983

将其更改`parsed = $parse(attrs.datepicker);`为`var parsed = $parse(attrs.datepicker);`对我有用。请尝试让我们知道。

# facebook - Facebook 发布流图 api

> ID：15753668
> 
> 赞同：0
> 
> 时间：2013-04-01T23:31:28.077
> 
> 标签：facebook, facebook-graph-api

在过去的几天里，我尝试使用图形 API（Javascript）在用户的朋友墙上发布当我使用时：

FB.api('/me/feed', 'post', params, function(response) 它有效！。

但是，当我尝试使用它时：

```
FB.api('/' + targetID +'/feed', 'post', params, function (response) it does not work 
```

这是我的代码

```
window.fbAsyncInit = function () 
  {
   FB.init({
   appId:'1**************3', 
   status:true, 
   cookie:true, 
   xfbml:true 
  });
FB.getLoginStatus(function (response) 
 {
  if (response.status === 'connected') 
   {
       var uid = response.authResponse.userID;
       var at = response.authResponse.accessToken;
       var params = {};
       params['message'] = 'message';
       params['name'] = 'name';
       params['description'] = 'description';
       params['link'] = 'link';
       params['picture'] = 'url picture';
       params['caption'] = 'caption';

       FB.api('/me/feed', 'post', params, function(response) 
       {
        if (!response || response.error) 
         {
          alert('Error occured');
         } 
        else 
         {
          alert('Published to stream!');
         }
       });  

     var targetID='1*******2';
     FB.api('/' + targetID +'/feed',  'post', params, function(response) 
      {
       if (!response || response.error) 
       {
         alert('not published! no yay');
       } 
       else 
       {
        alert('Published yay!');
       }
      }); 
    } else if (response.status === 'not_authorized') {
    // xxxxxxx
   } else {
    // the user isn't logged in to Facebook.
  }
 });
};

(function (d, debug) 
{
  var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
  if (d.getElementById(id)) 
   {
    return;
   }
   js = d.createElement('script');
   js.id = id;
   js.async = true;
   js.src = "https://connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
   ref.parentNode.insertBefore(js, ref);
 }(document, /*debug*/ true)); 
```

谁能帮帮我？

非常感谢！

# python - 如何在没有 API 的情况下通过网络抓取用户数据库？

> ID：15753669
> 
> 赞同：2
> 
> 时间：2013-04-01T23:31:40.937
> 
> 标签：python, web-scraping, beautifulsoup, urllib2

为了好玩，我从昨晚开始学习了如何使用 Python 的 urllib、urllib2、cookie-jar 和 BeautifulSoup 进行基本的网页抓取。只花了一点时间，但我已经弄清楚如何从我需要的每个用户的个人资料中获取所有信息（确切地说是 OKCupid）。但是，我只知道如何做到这一点，并且不知道如何在没有站点 API 的情况下通过用户的公共数据库。

有什么简单的方法可以做到这一点？谢谢。

# android - 扩展 SimpleCursor 适配器

> ID：15753672
> 
> 赞同：0
> 
> 时间：2013-04-01T23:32:08.207
> 
> 标签：android, gridview, simplecursoradapter, android-cursorloader

我是 android 开发的新手，我正在寻找最简单的解释来使用带有 cursorloader 的 SimpleCursorAdapter 类来从我的 android 设备中提取视频缩略图和详细信息。我正在我的应用程序中做一个迷你视频文件浏览器，我正在使用一个 gridView、一个片段和一些指向一些外部 URI 的内容提供程序。任何形式的帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:39:31.953

查看 Android 培训指南。

[在后台加载数据](http://developer.android.com/training/load-data-background/index.html)指南向您展示了如何设置 CursorLoader 并使用它从内容提供者获取数据。

[向多个线程发送操作](http://developer.android.com/training/multiple-threads/index.html)指南向您展示了如何在后台线程上工作。它包括用于下载、缓存、解码和显示图像的示例代码，这与您正在执行的操作非常接近。

第二个指南广泛使用了片段。

我不确定“指向某个外部 URI”的内容提供者是什么意思。内容提供者可以由*任何*类型的数据支持，但它们最适合设备上存在的结构化数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T01:00:21.673

有关在后台下载图像的示例，请查看[此处](http://goo.gl/58oXQ)。

我在 ListView 中使用了它，它可以很好地在另一个线程上下载图像以及管理图像缓存。使用了简单的回调，我在列表中实现了一个视图切换器，以允许从占位符图像轻松转换到真实的下载图像。

# php - 未使用 PHP 在 POST 中发送复选框

> ID：15753677
> 
> 赞同：0
> 
> 时间：2013-04-01T23:32:42.230
> 
> 标签：php, html, smarty

我有一个复选框，它没有使用 POST 发送到回调页面。我读过它需要一个值，并且我提供了它，但不确定还有什么问题。这是我目前正在使用的复选框代码。Smarty 在这里被使用。

```
{foreach from=$all_splash_carriers item=item}
            <tr>
                    <td class="evp">{$item.carrier}:</td>
                    <td><input name="{$item.splash_carriers_id}.splashcarrier.{$item.carrier_id}" value="{$item.url}"/><input type="checkbox"  name="{$item.carrier_id}.checkbox" value="1" {if $item.activated == '1'}checked{/if}/>Activated</td>

            <tr>
{/foreach} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:35:20.373

如果未选中复选框，则不会发送该复选框。

此外，PHP 会默默地将名称中的任何点转换为下划线，因为否则“register_globals”模式将呈现无法访问的全局变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:45:41.627

```
if $item.activated == '1' 
```

应该

```
if ($item.activated == '1') 
```

# qt - 当 QListView 由 QComboBoxes 填充时获取信号

> ID：15753678
> 
> 赞同：0
> 
> 时间：2013-04-01T23:32:47.190
> 
> 标签：qt, user-interface, pyside

我正在开发一个读取数据库并在其中的项目发生更改时将其更新回来的 UI。我的 UI 由一个 QListView 组成，它由 QComboBoxes 填充。现在，我可以在组合框项更改时收到信号（尽管我无法获取已更改的小部件项的索引），并且我需要让父列表视图知道成员小部件的值已更改。关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T12:44:07.660

获取小部件索引的一个简单技巧是将小部件索引编码到每个组合框项目的项目数据中。您可以将 QString 设置为 itemData ，它编码对您的标准项目数据和小部件索引的引用，例如

```
pComboBox1->setItemText(1, "Item 1");
pComboBox1->setItemData(1, "1-1"); 
pComboBox1->setItemData(2, "Item 2");
pComboBox1->setItemData(2, "2-1"); // Item 2 in 1st combo box
pComboBox2->setItemText(1, "Item 1");
pComboBox2->setItemData(1, "1-2"); // Item 1 in 2nd combo box
// and so on 
```

# java - 逆向法？

> ID：15753681
> 
> 赞同：-2
> 
> 时间：2013-04-01T23:33:17.147
> 
> 标签：java, matrix, identity

我正在创建一个程序来创建一个身份矩阵——这很容易。但现在我需要创建身份矩阵，但要倒退。结果需要是这样的：

> 0 0 1
> 
> 0 1 0
> 
> 1 0 0

这是我正在使用的创建身份矩阵的程序：

```
import java.util.*;
class Lab19Part2 {
    public static int[][] create(int size) {
        int[][] matrix = new int[size][size];

            for(int i = 0; i < size; i++)
            for(int j = 0; j < size; j++)
                matrix[i][j] = (i == j) ? 1 : 0;
            return matrix;
    } public static void main(String[] args) {
        Scanner input=new Scanner(System.in);
        System.out.println("Enter size of matrix: ");
            int size=input.nextInt();
            int matrix[][]=create(size);

            for (int i=0 ; i < matrix.length ; i++) { 
            System.out.println();

                for (int j=0 ; j < matrix[i].length ; j++){
                System.out.print(matrix[i][j]+" ");
                }
            }
    }
} 
```

虽然它像这样打印出身份矩阵：

> 1 0 0
> 
> 0 1 0
> 
> 0 0 1

问题是，我如何使它像第一个身份矩阵一样打印出来？我知道它与 for 循环有关，但我无法确定它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:35:00.873

改变

```
matrix[i][j] = (i == j) ? 1 : 0; 
```

到

```
matrix[i][j] = (i == size - j - 1) ? 1 : 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:35:07.187

您需要更改控制值是 1 还是 0 的条件：

```
matrix[i][j] = (i + j == size - 1) ? 1 : 0; 
```

因此，如果 size 为`3`，则位置 [0][2]、[1][1] 和 [2][0] 得到 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:38:11.167

为什么不为您的身份案例这样做：

```
for(int i = 0; i < size; i++) {
    matrix[i][i] = 1;
} 
```

然后对于另一种情况使用：

```
for(int i = 0; i < size; i++) {
    matrix[i][size - (i+1)] = 1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T03:43:26.380

以下是如何使用[la4j](http://la4j.org)（Java 的线性代数）创建它的简短示例：

```
Matrix a = new Basic2DMatrix(Matrices.asIdentitySource(3)).transpose();

// will create a 3x3 matrix
//
// 0 0 1
// 0 1 0
// 1 0 0 
```

# class - 在 Tritium 中，如何选择包含多个类的 div？

> ID：15753682
> 
> 赞同：0
> 
> 时间：2013-04-01T23:33:20.330
> 
> 标签：class, html, moovweb, tritium

我忘记了如何在 Moovweb SDK 中执行此操作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:57:28.340

假设这是您的 HTML：

```
<div class="foo bar"></div> 
```

您可以使用 XPath`contains()`函数：

```
$("div[contains(@class, 'foo')]") {
  # More Tritium here...
} 
```

# ios - 无法从情节提要显式加载视图控制器

> ID：15753683
> 
> 赞同：7
> 
> 时间：2013-04-01T23:33:33.367
> 
> 标签：ios, storyboard

我正在从故事板显式加载视图控制器并具有以下代码：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"Storyboard" bundle:nil];
UIViewController *initViewController = [storyboard instantiateViewControllerWithIdentifier:@"InitialScreen"]; 
```

但是我收到一个错误“'Storyboard () doesn't contain a view controller with identifier 'InitialScreen'”

然而，从屏幕截图中可以看出，视图控制器确实具有该标识符。我之前成功地使用过这种加载控制器的相同方式，但不知道为什么这次它不起作用。任何想法可能是什么问题？

![在此处输入图像描述](https://i.stack.imgur.com/W4Wdh.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:10:29.593

我刚刚发现了问题 - 这是模拟器的问题，我发现我的代码绝对没有问题，并且 100% 确定没问题，当我过去遇到这种情况时，我通常会发现罪魁祸首是Xcode 本身。因此，即使我已经多次清理和重建，我还是决定尝试重置模拟器中的内容——然后宾果游戏开始工作了。我把它归结为模拟器缓存内容中的一个错误，而不是更新以反映在 IB 中所做的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:37:31.807

您的故事板名称是否与您尝试从中加载视图控制器的故事板文件的名称匹配？通常故事板被命名为`MainStoryboard_iPhone`

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil]; 
```

您还应该检查以确保 Storyboard ID 文本字段中没有尾随空格。除此之外，其他一切看起来都应该对我有用。

# java - 如何在 web.xml 中设置资源的根路径

> ID：15753684
> 
> 赞同：1
> 
> 时间：2013-04-01T23:33:36.743
> 
> 标签：java, apache, tomcat, spring-mvc, spring-security

我的 web.xml 中有两个 servlet 映射我想为以下 servlet 引用的资源设置根路径。我的目标是不必将整个路径放在我的 JSP 中。

示例：我希望能够放置 (/images) 而不是必须放置 (resources/admin/images) 的图像路径

文件结构如下：

```
 |_ admin
    |_index.jsp
    |_resources
         |_images
         |_views
              |_dashboard.jsp (file in which I want to use the scoped file paths) 
```

我有一个根范围，它是我的站点（localhost.com）的基础。我想要另一个位于我试图定义的管理员级别的范围（localhost.com/admin）。

我尝试搜索，但不确定要添加到我的 servlet 映射中的内容。下面是我的 web.xml

```
<display-name>cr</display-name>
<description>cr</description>
<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>classpath:log4j.xml</param-value>
</context-param>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        classpath:applicationContext.xml
        classpath:spring-security.xml
    </param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<servlet>
    <servlet-name>cr</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/conf/spring-controllers.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>cr</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

<filter>
    <filter-name>httpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>httpMethodFilter</filter-name>
    <servlet-name>cr</servlet-name>
</filter-mapping>

<servlet>
    <servlet-name>admin</servlet-name>
    <jsp-file>/resources/admin/index.jsp</jsp-file>
</servlet>

<servlet-mapping>
    <servlet-name>admin</servlet-name>
    <url-pattern>/admin/*</url-pattern>
</servlet-mapping>

<session-config>
    <session-timeout>15</session-timeout>
</session-config>

<!-- Spring Security -->
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>
        org.springframework.web.filter.DelegatingFilterProxy
    </filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T10:20:11.783

如果您不想暴露完整的文件路径，请将 jsp 文件放在 WEB-INF 文件夹中。虽然您不能直接访问 WEB-INF 文件夹中的文件，但您可以将请求转发给它。

前锋应该是这样的：

```
RequestDispatcher view = req.getRequestDispatcher("/WEB-INF/admin/index.jsp");
view.forward(req, resp); 
```

# iphone - Xcode Undefined symbols for architecture i386：这个错误代码是什么意思，我该如何修复它？

> ID：15753686
> 
> 赞同：1
> 
> 时间：2013-04-01T23:33:40.430
> 
> 标签：iphone, ios, objective-c, xcode

我该如何解决这个问题。任何帮助，将不胜感激。

```
directory not found for option '-   L/Users/blank/Desktop/project/ipad_client/move/Modules/Unity/Libraries' 
```

架构 i386 的未定义符号：“_AFNetworkingReachabilityDidChangeNotification”，引用自：moveChat.o 中的 -[moveChat startTrackingNetworkEvents]

# visual-studio-2010 - 使用泛型进行单元测试

> ID：15753690
> 
> 赞同：0
> 
> 时间：2013-04-01T23:33:58.437
> 
> 标签：visual-studio-2010, unit-testing, generics

我有类似的东西：

```
class BackupList : List<Backup> {} 
```

VS2010 为我生成的测试看起来有点像：

```
[TestMethod()]
[DeploymentItem("[...].exe")]
public void AddBackupNormal()
{
    SqlServer_Accessor.BackupList ls = new SqlServer_Accessor.BackupList("", "");
    SqlServer_Accessor.Backup bk = new SqlServer_Accessor.Backup();
    ls.Add(bk);
    Assert.IsTrue(ls.Count == 0); // won't compile
    List<SqlServer_Accessor.Backup> x = new List<SqlServer_Accessor.Backup>();
    Assert.IsTrue(x.Count == 1);  // compiles fine
} 
```

但是，在上面， .Count 引用无法编译：

> 错误 1 ​​'xxx.SqlServer_Accessor.BackupList' 不包含 'Count' 的定义，并且找不到接受类型为 'xxx.SqlServer_Accessor.BackupList' 的第一个参数的扩展方法 'Count'（您是否缺少 using 指令或程序集参考？） C:[...]Tests\SqlServer_BackupListTest.cs

有趣的是，对原始类型的引用似乎包含一个 .Count 属性，正如我所期望的那样......所以问题是 _accessor 似乎正在转换为 List<> 以外的东西。

如何解决这个问题？

TIA-e！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-03T14:32:12.797

我的第一个猜测是你的测试类需要一个参考......

`using System.Collections.Generic;`

# java - 性能基准测试是否属于 JUnit 领域？

> ID：15753691
> 
> 赞同：1
> 
> 时间：2013-04-01T23:34:00.760
> 
> 标签：java, junit, benchmarking

我正在为我的应用程序设计一些测试用例。假设我有一个名为

`ProcessedDataObject createProcessedDataObject(RawDataHolder input)`

的性能`createProcessedDataObject`至关重要，因此我想包括一些针对恒定输入的基准性能测试（例如`input`，从本地文本文件构建，因此它不会变化），如果以后每次修改需要超过一定数量的 nanos，则失败方法。IOW，我希望测试的设计能够引发危险信号，以防未来的变化增加复杂性以超过时间基准。

我的问题是：基准性能测试是否属于 JUnit 领域，还是应该将其保留在外部？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:25:42.280

如果您只是在寻找一个大概的估计，那么 JUnit 就可以了。但是，您不想在构建时使用的测试套件中包含基准，因为这会减慢构建速度。如果您希望发布您的基准，那么在我看来，不应该使用 JUnit。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T04:04:27.100

我建议您将测试用例拆分为功能性单元测试和非功能性集成测试。如果您使用的是 Maven，您可以使用[Surefire](http://maven.apache.org/surefire/maven-surefire-plugin/) + [Failsafe](http://maven.apache.org/surefire/maven-failsafe-plugin)来实现这一点。您仍然可以将性能测试编写为 JUnit 测试，但这样可以在逻辑上将它们分开，从而将功能测试和性能测试分开。

在不太了解您的实现的情况下，我假设您的性能测试实际上是集成测试，无论如何......

正如评论所暗示的那样，您需要注意您的通过/失败标准和阈值。

例如，如果我的测试限制是 100 毫微，它需要 101 毫微，这是否足以使构建失败？我应该运行相同的测试 10 次并取平均值吗？我是否应该运行 10 次相同的测试并确保每次都低于阈值？我应该进行多少次试运行？所有这些（以及更多）都是您应该考虑的因素。

# android - 同一语言的两个版本的应用本地化

> ID：15753693
> 
> 赞同：3
> 
> 时间：2013-04-01T23:34:01.730
> 
> 标签：android, iphone, ios, xcode

**背景：** 我们正在尝试为 FR-FR、FR-CA、ES-ES 和 ES-MX 本地化应用程序。我们分别为 android 和 ios 创建了正确的 localizable.strings 和 strings.xml 文件。这四个看起来都受两个操作系统的支持。

**问题：** 我们在测试这些问题是否正确时遇到了问题。例如，在任一操作系统中都可以选择法语，但不能选择加拿大法语。当我们在 iOS 设备中将语言切换为法语并将地区切换为加拿大时，它只会更改键盘。

**问题：**

*   我们如何测试这些语言？
*   这些语言是否随仅在该地区购买的手机一起提供？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:27:19.100

请注意，对于 Android，language-country 属性不一定需要以真正的组合存在才能使其仍然有效。例如，如果您在加拿大为德语创建本地化，即使可能没有人为该特定组合制作手机，它仍然可以工作。

当遇到未知组合时，Android 只会级联到不太精确的德语语言属性以进行语言相关的本地化（假设德语甚至出现在手机/apk 上）并级联到不太精确的仅地理属性加拿大（假设与加拿大相关的属性甚至出现在手机/apk 上）。

不幸的是，我对 iOS 的了解还不够，无法就这部分问题给你具体的建议。

您如何测试本地化？在去年的 Google I/O 上，有一个关于新的 Eclipse 本地化工具 的[演示，用于同时在许多不同的语言环境中测试您的布局。](https://developers.google.com/events/io/2012/sessions/gooio2012/104/)

作为另一种测试策略，这对 iOS 也有帮助，除了询问远在国外的家人和朋友，或者询问您自己的现有客户（如果有的话），您可以继续[http://fiverr.com/](http://fiverr.com/)并支付 5美元给在魁北克讲法语的人，以便在他们的手机上对您的应用程序进行[快速测试](http://fiverr.com/gigs/search?utf8=%E2%9C%93&query=mobile%20canada&order=&x=-638&y=-151&search_in=sub_category&sub_category=online-web-testing-qa&category=programming-tech)，并将您的应用程序在他们的设备上运行的手机屏幕截图发送给您。

根据您的预算和定位的地理位置，必须有许多其他网站/服务可以帮助您众包（或雇用机械土耳其人）这样的任务。

# php - 如何从 PHP 中的推文或字符串中捕获 URL，使用 parse_url 但它不起作用

> ID：15753694
> 
> 赞同：0
> 
> 时间：2013-04-01T23:34:07.010
> 
> 标签：php, twitter, oembed

好的，我想从自动更新我的应用程序的推文中动态自动解析 URL，我尝试使用 PHP 中的 parse_url 函数解析它们，但它没有返回我所期望的.. 我基本上只想捕获 URL从推文..

示例：约翰麦凯恩最新的推文说：

```
Must-read Jackson Diehl: "What the #Iraq war taught me about #Syria" http://t.co/7YHYQY6bW0 
```

在使用 parse_url 从该推文中捕获 URL 后，它返回了这个

```
array(2) { ["path"]=> string(35) "Must-read Jackson Diehl: "What the " ["fragment"]=> string(55) "Iraq war taught me about #Syria" http://t.co/7YHYQY6bW0" } 
```

我基本上只想 `http://t.co/7YHYQY6bW0`在同一条推文中捕获或任何其他多个 url ......我怎么能在 PHP 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:49:25.973

parse_url 用于拆分 URL 本身的片段。您需要执行类似 preg_match_all 的操作，因为一条推文中可能有多个 URL。

```
<?php
    $string = 'Must-read Jackson Diehl: "What the #Iraq war taught me about #Syria" http://t.co/7YHYQY6bW0';

    preg_match_all('!http[s]?://[^ ]+!',$string,$urls);

    print_r($urls);

?> 
```

# java - Java相当于Delphi加密？

> ID：15753695
> 
> 赞同：2
> 
> 时间：2013-04-01T23:34:11.370
> 
> 标签：java, delphi, encryption, delphi-2010, lockbox-2

我有一个 Delphi 2010 应用程序，它使用 Lockbox 组件来加密数据。该程序使用 Key128 调用 Triple DES Encrypt String CBCEx 函数。密钥由函数生成：

```
GenerateLMDKey(Key128, SizeOf(Key128), 'Leadmec'); 
```

我正在用 Java 开发一个 Web 服务来访问数据库数据并提供一个 Android 应用程序。我需要解密由 Delphi 函数加密的密码。我该怎么做呢？这真的可能吗？

这是加密密码的样子：`ho+RZpDW8z7hxH2cyjaBDg==`

# azure - 将 Umbraco 部署到 SQL Azure

> ID：15753696
> 
> 赞同：1
> 
> 时间：2013-04-01T23:34:12.653
> 
> 标签：azure, umbraco, azure-sql-database

我已成功将 Umbraco 4.7 实施到 Windows Azure 网站和 SQL Azure，但有时我会收到类似于以下错误的错误：

```
SQL helper exception in ExecuteScalar ---> System.Data.SqlClient.SqlException: A transport-level error has occurred when receiving results from the server. (provider: TCP Provider, error: 0 - An existing connection was forcibly closed by the remote host.) ---> 
```

似乎 Umbraco 不管理重试逻辑（sql azure 瞬态故障处理）。有没有人知道在 umbraco 方面实现这一点的任何非创伤性方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T23:40:03.370

Amhed，没有简单的方法可以做到这一点，在 Azure 中使用 Umbraco 的人通常会遇到导致连接问题的会话状态问题，但正如您所说，您只捕获了 1%，这意味着您正在处理暂时性错误。您可能已经在这里看到了讨论

[http://our.umbraco.org/forum/core/general/27179-SQL-Azure-connectivity-issues?p=1](http://our.umbraco.org/forum/core/general/27179-SQL-Azure-connectivity-issues?p=1)

最终效果是您必须使用 umbraco 代码库并在其中使用重试框架重新构建它。这给使用 Umbraco 和获取未来版本带来了严重的开销。你最好游说 Umbraco 核心团队建立一个完整的重试框架并支持它。（让我们甚至不谈论安全问题；）

这可能不是您想听到的，但实际上它是您自己的数据层时间。

说了这么多，我去看看：；）（因为这确实让我对别的东西感兴趣）

虽然从查看他们正在使用的 Umbraco 中的源代码作为起点

Microsoft.ApplicationBlocks.Data

作为建立连接和执行 SQL 命令的基础

从查看 umbraco.DataLayer.SqlHelpers.SqlServer.SqlServerHelper

使用 SH = Microsoft.ApplicationBlocks.Data.SqlHelper;

所以我的猜测是你需要替换这个块。在互联网上进行快速（肮脏）搜索

[http://www.sharpdeveloper.net/source/SqlHelper-Source-Code-cs.html](http://www.sharpdeveloper.net/source/SqlHelper-Source-Code-cs.html)

您可以反映课程以确保。

然后，您可以使用瞬态故障处理框架进行重建，然后您可以有效地降低 dll 更改的潜力（著名的遗言）。

但你至少可以得到

使用 (ReliableSqlConnection conn = new ReliableSqlConnection(connString, retryPolicy))

轻松上那种类型的课和更可爱的东西。

[http://msdn.microsoft.com/en-us/library/hh680899(v=pandp.50).aspx](http://msdn.microsoft.com/en-us/library/hh680899(v=pandp.50).aspx)

如果我要这样做，这就是我要开始的地方，我会进入那个级别。

我不确定这是否会覆盖 100% 的连接集，因为我没有在 umbraco 代码库中积极工作，所以这是最好的猜测，但看看源代码，这是我将开始并改变并看起来是你最好的起点.

hths,

詹姆士

# mandrill - 是否可以为 Mandrill 创建“开发”API 密钥？

> ID：15753697
> 
> 赞同：11
> 
> 时间：2013-04-01T23:34:13.353
> 
> 标签：mandrill

我正在使用 Mandrill 从我的 Rails 3 应用程序发送电子邮件。在生产中，我使用我在他们的管理控制台中设置的 API 密钥。为了防止可能向我们所有用户发送电子邮件的开发和测试 SNAFU，我已将垃圾密钥放入开发和测试环境配置中，而我只将真正的密钥放入生产配置中。Mandrill 允许您创建多个 API 密钥。有谁知道是否有办法配置 Mandrill，以便使用开发或测试密钥发送电子邮件的 API 调用将失败，除非满足某个先决条件（例如电子邮件域与 mycompany.com 匹配）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-07-05T12:26:34.687

Mandril 现在添加了测试 API 密钥。[在他们的网站上阅读更多](http://help.mandrill.com/entries/24486133-Does-Mandrill-have-a-test-mode-or-sandbox-)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-02T00:33:05.520

Mandrill API 密钥的功能相同，并且对帐户中的所有 API 调用具有完全访问权限。目前没有开发、沙盒或测试密钥或范围 API 密钥的概念。但是，测试模式/功能在开发路线图上。我目前没有预计到达时间，但这绝对是我们正在努力的事情。

编辑添加：截至最初回答此问题时，这是不可能的。Mandrill 现在确实有一个[测试模式](https://mandrill.zendesk.com/hc/en-us/articles/205582447-Does-Mandrill-Have-a-Test-Mode-or-Sandbox-)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-06-14T16:08:37.203

在 Mandrill 中创建“开发”API 密钥有两种可能的方法，它们服务于不同的用例：

1.  创建一个[测试密钥](https://mandrill.zendesk.com/hc/en-us/articles/205582447-Does-Mandrill-have-a-test-mode-or-sandbox-)。实际上不会发送使用此密钥发送的电子邮件。这是最简单的方法，如果您的测试流程不需要您实际接收测试电子邮件，则该方法适用。（您仍然可以在“出站”选项卡中看到本应发送的电子邮件的内容*。*）

2.  创建一个实时 API 密钥，并使用[规则引擎](https://mandrill.zendesk.com/hc/en-us/articles/205583117-What-is-the-rules-engine-)创建它，以便使用此密钥发送的电子邮件将被自动拒绝，除非收件人地址与某种模式匹配。如果您的测试流程需要实际接收您发送的电子邮件，您应该使用这种方法 - 例如，如果您对密码重置功能进行了自动端到端测试。

### 方法 1：使用测试模式

[测试模式](https://mandrill.zendesk.com/hc/en-us/articles/205582447-Does-Mandrill-have-a-test-mode-or-sandbox-)于 2013 年添加到 Mandrill。要使用它，首先从*设置*选项卡的*SMTP 和 API 信息*部分的*API 密钥*子部分创建一个测试密钥。您在此处创建的第一个密钥将始终是实时密钥，但如果您再次单击“新建 API 密钥”，您将能够选择创建一个测试密钥：

 **![屏幕截图显示](https://i.stack.imgur.com/f5a5f.png)

完成此操作后，使用测试密钥“发送”一些电子邮件（实际上不会发送电子邮件），然后从屏幕右上角的下拉菜单中单击*打开测试模式选项：*

![显示如何打开测试模式的屏幕截图](https://i.stack.imgur.com/Lx6BX.png)

当管理面板处于测试模式时，如果您转到*出站*选项卡，您将能够看到您要求 Mandrill 使用您的测试 API 密钥发送的电子邮件，就好像它们真的已经发送一样。

### 方法 2：使用规则引擎

*首先，从设置*选项卡的*SMTP 和 API 信息*部分的*API 密钥*子部分创建一个新的实时 API 密钥。您***必须***为密钥提供描述，否则您将无法从规则引擎中引用它。

 ***接下来，转到*出站选项卡的**规则*部分，然后单击“添加规则”：

 *![显示“出站”、“规则”和“添加规则”的图像](https://i.stack.imgur.com/XXOQj.png)

在规则界面中，设置一个规则，如果 API 密钥是您的测试密钥并且收件人的电子邮件与您选择的某些模式匹配，则该规则将拒绝电子邮件。该模式可以是单个电子邮件地址，例如`testbot@yourdomain.com`，也可以是整个域，例如`*@yourdomain.com`.

![示例规则](https://i.stack.imgur.com/Bf2F7.png)

如果您想制作自己的复杂模式，请注意，根据[文档](https://mandrill.zendesk.com/hc/en-us/articles/205583117-What-is-the-rules-engine-)，Mandrill 使用 Python 的[fnmatch](https://docs.python.org/2/library/fnmatch.html)模块将您的模式与电子邮件地址匹配（它使用 glob 语法，如果您使用 Unix，您可能会在 shell 中熟悉该语法） .

您使用此密钥发送到与您的模式匹配的域的电子邮件将真正被发送并显示在实时出站选项卡中。与模式不匹配的将不会发送，并将在实时出站选项卡中显示为“已拒绝”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-18T23:28:58.127

即使在测试/开发中，我们也希望看到电子邮件发送出去，这样我们就可以看到事情是端到端的。为了防止客户收到测试电子邮件时出现问题，我们配置了一个初始化程序（Ruby on Rails），如果不是生产，它将替换收件人。不要把检查留给个别的 Mailer 实现——有人会忘记。

```
MandrillMailer.configure do |config|
  config.api_key = ENV['MANDRILL_API_KEY']

  # Set recipients to test@ourdomain.com if we're not in production
  if !Rails.env.production?
    config.interceptor = Proc.new do |params|
       params[:to] = [{ email: "test@ourdomain.com", name: "Test", type: "to" }]
    end
  end

end 
```******

# api - 处理中的 Twitter 应用程序

> ID：15753699
> 
> 赞同：0
> 
> 时间：2013-04-01T23:34:33.897
> 
> 标签：api, twitter, processing

我正在尝试创建的 Twitter 应用程序存在很大问题。我已经连续两周解决这个问题，每天 14 小时，我无法弄清楚如何解决。我是新手，所以我相信这只是一件简单的事情。

我需要我的推特流一次显示五条推文。然后我需要它删除最旧的推文并用新的推文替换它。现在有人告诉我最好的方法是使用 Linkedlist，这很有意义。但是，每当我尝试合并它时，它都行不通。

如果有人可以帮助我，我将不胜感激，因为此时我已经束手无策了。

这是代码：

```
import com.francisli.processing.http.*;

import java.util.LinkedList;

//LinkedList myList;

HashMap overall = new HashMap();

HttpClient client;

LinkedList myList;

PImage prhomoPix;

int results_to_show = 5;
int updateTime = 10000;
int updateDiff = 0;

void setup()
{

 myList = new LinkedList();
 for (int i = 0; i < 5; i++) 
 {
   myList.add(client);
 }

  size(1143, 800);

  prhomoPix = loadImage("PrhomoAppBg.jpg");

  background(0);
  image(prhomoPix, 0, 0);

  fill(0, 0, 0, 80);
  noStroke();
  rect(20, 135, 370, 670);

  fill(0, 0, 0, 80);
  noStroke();
  rect(755, 135, 370, 670);

  textAlign(CENTER, CENTER);

}

void responseReceived(HttpRequest request, HttpResponse response)
{

 if(response.statusCode == 200)
 {

    JSONObject allresults;
    allresults = response.getContentAsJSONObject();
    //JSONObject timeline_tweets = response.getContentAsJSONObject();

  for (int i = 0; i < 5; i++)
 {

    text(allresults.get("results").get(i).get("text").stringValue(), 25, 50+(i*120), 330, 330);

  }
  frameRate(2);

//}

   //for (int i=0; i < results_to_show; i++)
  //{

  // text(allresults.get("results").get(i).get("text").stringValue(), 25, 50+(i*120), 330, 330);
 // }

}

      else
  {
    text("UH-OH" + response.getContentAsString(), 50, 50);
  } 
}

void tweetUpdate()
{

  if(millis() > (updateTime + updateDiff))
  {

    client = new HttpClient(this, "search.twitter.com");//what webservice we are using, this is the priate OAuth one. "this" means it is not cpying setting from anywhere else
    client.GET("search.json?q=dublin&rpp="+results_to_show+"&result_type=recent");

    //println(myList);

    updateDiff = millis();

  }  

 }

   void draw()
{
 myList.remove(client);
 myList.add(client);
 tweetUpdate(); 

} 
```

再次非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:49:11.753

To be honest with you, Java is really not my field, but these tutorials looked quite self explanatory. Hope they help.

[http://examples.javacodegeeks.com/core-java/util/linkedlist/](http://examples.javacodegeeks.com/core-java/util/linkedlist/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:31:56.943

1.  您必须在方法中重新绘制整个屏幕`draw()`。
2.  我猜，人们告诉你**将推文**`LinkedList`保存在`HttpClient`.
3.  更新方法中的推文列表`responseReceived()`。

最终，您的平局将如下所示：

```
void draw() {
  // repaint
  background(0);
  // draw picture
  image(prhomoPix, 0, 0);
  // repaint all tweets
  for(int i=0; i< tweetsList.size(); ++i {
    drawTweet(tweetsList);
  }
  tweetUpdate(); // update list of tweets from server
} 
```

`tweetUpdate()`

```
void tweetUpdate() {
    client = new HttpClient(this, "search.twitter.com");
    client.GET("search.json?q=dublin&rpp="+results_to_show+"&result_type=recent");
} 
```

# objective-c - 观察者通知后 UIViewcontroller 未重新加载

> ID：15753700
> 
> 赞同：0
> 
> 时间：2013-04-01T23:34:41.997
> 
> 标签：objective-c, uiviewcontroller, afnetworking, nsnotificationcenter, nsnotifications

嗨，我有一个 uiviewcontroller，它在从 web 服务接收数据后添加 4 个子视图。我向 uiviewcontroller 添加了一个观察者，该观察者会在数据完全从 web 服务加载时进行观察。一旦完成，uiviewcontroler 就会添加 4 个子视图。

但是我的问题是它不会这样做，除非我切换到另一个选项卡视图而不是再次返回该选项卡。

有没有办法重新加载这个页面？我在响应观察者通知但视图不刷新的函数下使用了 [uiviewcontroller.view setNeedsDisplay]。

感谢你们的帮助:)

这是我的观察者功能：

```
 -(void)projectListFromServer:(NSNotification *) response

{
NSLog(@"%@",response);

for (int i = 0; i < 4; i++)
{
    childview2 = [self.storyboard instantiateViewControllerWithIdentifier:(@"slider")];
    childview2.image = @"wicked";
    childview2.couponID = @"cool";

    NSLog(@"%@", self.childview2.couponID);
    [self addChildViewController:childview2];
}

 [self.childview.view setNeedsDisplay];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T04:33:19.703

您正在调用`addChildViewController`，但看起来您实际上并未将`childview2`的视图层次结构添加到包含视图控制器的视图层次结构中。

您需要做这样的事情，当然根据您当前层次结构中您实际希望插入这些新视图的位置进行调整：

```
[self addChildViewController:self.childview2]; // assuming childview2 is a @property
[self.view addSubview:self.childview2.view]; // adjust based on your actual hierarchy
[self.childview2 didMoveToParentViewController:self]; 
```

顺便说一句，您应该避免给视图控制器命名，例如`childview2`. 视图和视图控制器是两个完全不同的东西。

# python - 如何使用 argparse 将列表作为命令行参数传递？

> ID：15753701
> 
> 赞同：643
> 
> 时间：2013-04-01T23:34:58.827
> 
> 标签：python, argparse

我正在尝试将列表作为参数传递给命令行程序。是否可以[`argparse`](https://docs.python.org/3/library/argparse.html)选择将列表作为选项传递？

```
parser.add_argument('-l', '--list',
                      type=list, action='store',
                      dest='list',
                      help='<Required> Set flag',
                      required=True) 
```

脚本调用如下

```
python test.py -l "265340 268738 270774 270817" 
```

* * *

## 回答 #1

> 赞同：1262
> 
> 时间：2013-04-01T23:37:27.263

# 简短的回答

使用`nargs`选项或选项`'append'`设置`action`（取决于您希望用户界面的行为方式）。

**纳尔格斯**

```
parser.add_argument('-l','--list', nargs='+', help='<Required> Set flag', required=True)
# Use like:
# python arg.py -l 1234 2345 3456 4567 
```

`nargs='+'`接受 1 个或多个参数，`nargs='*'`接受零个或多个。

**附加**

```
parser.add_argument('-l','--list', action='append', help='<Required> Set flag', required=True)
# Use like:
# python arg.py -l 1234 -l 2345 -l 3456 -l 4567 
```

`append`您可以多次提供选项来建立列表。

**不要用`type=list`！！！**- 可能没有您想使用`type=list`的情况`argparse`。曾经。

* * *

# 长答案

让我们更详细地了解一些可能尝试执行此操作的不同方式以及最终结果。

```
import argparse

parser = argparse.ArgumentParser()

# By default it will fail with multiple arguments.
parser.add_argument('--default')

# Telling the type to be a list will also fail for multiple arguments,
# but give incorrect results for a single argument.
parser.add_argument('--list-type', type=list)

# This will allow you to provide multiple arguments, but you will get
# a list of lists which is not desired.
parser.add_argument('--list-type-nargs', type=list, nargs='+')

# This is the correct way to handle accepting multiple arguments.
# '+' == 1 or more.
# '*' == 0 or more.
# '?' == 0 or 1.
# An int is an explicit number of arguments to accept.
parser.add_argument('--nargs', nargs='+')

# To make the input integers
parser.add_argument('--nargs-int-type', nargs='+', type=int)

# An alternate way to accept multiple inputs, but you must
# provide the flag once per input. Of course, you can use
# type=int here if you want.
parser.add_argument('--append-action', action='append')

# To show the results of the given option to screen.
for _, value in parser.parse_args()._get_kwargs():
    if value is not None:
        print(value) 
```

这是您可以期待的输出：

```
$ python arg.py --default 1234 2345 3456 4567
...
arg.py: error: unrecognized arguments: 2345 3456 4567

$ python arg.py --list-type 1234 2345 3456 4567
...
arg.py: error: unrecognized arguments: 2345 3456 4567

$ # Quotes won't help here... 
$ python arg.py --list-type "1234 2345 3456 4567"
['1', '2', '3', '4', ' ', '2', '3', '4', '5', ' ', '3', '4', '5', '6', ' ', '4', '5', '6', '7']

$ python arg.py --list-type-nargs 1234 2345 3456 4567
[['1', '2', '3', '4'], ['2', '3', '4', '5'], ['3', '4', '5', '6'], ['4', '5', '6', '7']]

$ python arg.py --nargs 1234 2345 3456 4567
['1234', '2345', '3456', '4567']

$ python arg.py --nargs-int-type 1234 2345 3456 4567
[1234, 2345, 3456, 4567]

$ # Negative numbers are handled perfectly fine out of the box.
$ python arg.py --nargs-int-type -1234 2345 -3456 4567
[-1234, 2345, -3456, 4567]

$ python arg.py --append-action 1234 --append-action 2345 --append-action 3456 --append-action 4567
['1234', '2345', '3456', '4567'] 
```

*要点*：

*   使用`nargs`或`action='append'`
    *   `nargs`从用户的角度来看可能更直接，但如果有位置参数，则可能不直观，因为`argparse`无法分辨什么应该是位置参数以及什么属于`nargs`; 如果您有位置参数，那么`action='append'`最终可能是一个更好的选择。
    *   `nargs`以上仅在给出`'*'`、`'+'`或时才成立`'?'`。如果您提供一个整数（例如`4`），那么将选项与`nargs`位置参数混合将没有问题，因为`argparse`将确切地知道该选项期望有多少值。
*   不要在命令行上使用引号¹
*   不要使用`type=list`，因为它会返回列表列表
    *   发生这种情况是因为在后台`argparse`使用 的值`type`来强制您选择的*每个给定参数*`type`，而不是所有参数的集合。
    *   您可以使用`type=int`（或其他）获取整数列表（或其他）

* * *

¹：我不是说一般......我的意思是使用引号将*列表传递给`argparse`*不是你想要的。

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2014-07-21T13:55:57.373

我更喜欢传递我稍后在脚本中解析的分隔字符串。原因是：该列表可以是任何类型`int`或，如果有多个可选参数和位置参数`str`，有时使用I 会遇到问题。`nargs`

```
parser = ArgumentParser()
parser.add_argument('-l', '--list', help='delimited list input', type=str)
args = parser.parse_args()
my_list = [int(item) for item in args.list.split(',')] 
```

然后，

```
python test.py -l "265340,268738,270774,270817" [other arguments] 
```

或者，

```
python test.py -l 265340,268738,270774,270817 [other arguments] 
```

会正常工作。分隔符也可以是一个空格，它会像问题中的示例一样在参数值周围强制使用引号。

或者您可以使用 Chepner 评论中建议的 lambda 类型：

```
parser.add_argument('-l', '--list', help='delimited list input', 
    type=lambda s: [int(item) for item in s.split(',')]) 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-03-27T11:52:07.553

此外，如果您事先知道列表[`nargs`](http://docs.python.org/2/library/argparse.html#nargs)，您可能希望使用：[`choices`](http://docs.python.org/2/library/argparse.html#choices)

```
>>> parser = argparse.ArgumentParser(prog='game.py')
>>> parser.add_argument('move', choices=['rock', 'paper', 'scissors'])
>>> parser.parse_args(['rock'])
Namespace(move='rock')
>>> parser.parse_args(['fire'])
usage: game.py [-h] {rock,paper,scissors}
game.py: error: argument move: invalid choice: 'fire' (choose from 'rock',
'paper', 'scissors') 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-01-20T20:30:38.260

在 argparse 的 add_argument 方法中使用**nargs 参数**

我`nargs='*'`用作 add_argument 参数。如果我没有传递任何显式参数，我特别习惯于`nargs='*'`选择默认值

包括一个代码片段作为示例：

**示例：temp_args1.py**

*请注意：*下面的示例代码是用 python3 编写的。通过改变打印语句格式，可以在python2中运行

```
#!/usr/local/bin/python3.6

from argparse import ArgumentParser

description = 'testing for passing multiple arguments and to get list of args'
parser = ArgumentParser(description=description)
parser.add_argument('-i', '--item', action='store', dest='alist',
                    type=str, nargs='*', default=['item1', 'item2', 'item3'],
                    help="Examples: -i item1 item2, -i item3")
opts = parser.parse_args()

print("List of items: {}".format(opts.alist)) 
```

注意：我正在收集存储在列表中的多个字符串参数 -`opts.alist` 如果您想要整数列表，请将类型参数更改`parser.add_argument`为`int`

**执行结果：**

```
python3.6 temp_agrs1.py -i item5 item6 item7
List of items: ['item5', 'item6', 'item7']

python3.6 temp_agrs1.py -i item10
List of items: ['item10']

python3.6 temp_agrs1.py
List of items: ['item1', 'item2', 'item3'] 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-03-31T16:45:16.583

如果您打算让单个开关采用多个参数，那么您可以使用`nargs='+'`. 如果您的示例 '-l' 实际上采用整数：

```
a = argparse.ArgumentParser()
a.add_argument(
    '-l', '--list',  # either of this switches
    nargs='+',       # one or more parameters to this switch
    type=int,        # /parameters/ are ints
    dest='lst',      # store in 'lst'.
    default=[],      # since we're not specifying required.
)

print a.parse_args("-l 123 234 345 456".split(' '))
print a.parse_args("-l 123 -l=234 -l345 --list 456".split(' ')) 
```

生产

```
Namespace(lst=[123, 234, 345, 456])
Namespace(lst=[456])  # Attention! 
```

如果您多次指定相同的参数，默认操作 ( `'store'`) 将替换现有数据。

另一种方法是使用以下`append`操作：

```
a = argparse.ArgumentParser()
a.add_argument(
    '-l', '--list',  # either of this switches
    type=int,        # /parameters/ are ints
    dest='lst',      # store in 'lst'.
    default=[],      # since we're not specifying required.
    action='append', # add to the list instead of replacing it
)

print a.parse_args("-l 123 -l=234 -l345 --list 456".split(' ')) 
```

哪个生产

```
Namespace(lst=[123, 234, 345, 456]) 
```

或者您可以编写自定义处理程序/操作来解析逗号分隔的值，以便您可以执行

```
-l 123,234,345 -l 456 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-11-10T17:04:08.480

In `add_argument()`,`type`只是一个可调用对象，它接收字符串并返回选项值。

```
import ast

def arg_as_list(s):                                                            
    v = ast.literal_eval(s)                                                    
    if type(v) is not list:                                                    
        raise argparse.ArgumentTypeError("Argument \"%s\" is not a list" % (s))
    return v                                                                   

def foo():
    parser.add_argument("--list", type=arg_as_list, default=[],
                        help="List of values") 
```

这将允许：

```
$ ./tool --list "[1,2,3,4]" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-04-14T10:43:50.830

我认为最优雅的解决方案是将 lambda 函数传递给“类型”，正如 Chepner 所提到的。除此之外，如果您事先不知道列表的分隔符是什么，您还可以将多个分隔符传递给 re.split：

```
# python3 test.py -l "abc xyz, 123"

import re
import argparse

parser = argparse.ArgumentParser(description='Process a list.')
parser.add_argument('-l', '--list',
                    type=lambda s: re.split(' |, ', s),
                    required=True,
                    help='comma or space delimited list of characters')

args = parser.parse_args()
print(args.list)

# Output: ['abc', 'xyz', '123'] 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-07-19T13:14:51.810

如果您有一个嵌套列表，其中内部列表具有不同的类型和长度，并且您希望保留该类型，例如，

`[[1, 2], ["foo", "bar"], [3.14, "baz", 20]]`

那么您可以使用[@sam-mason](https://stackoverflow.com/users/1358308/sam-mason)提出的解决方案来解决[这个问题](https://stackoverflow.com/questions/57112608/parse-a-nested-list-with-python-argparse)，如下所示：

```
from argparse import ArgumentParser
import json

parser = ArgumentParser()
parser.add_argument('-l', type=json.loads)
parser.parse_args(['-l', '[[1,2],["foo","bar"],[3.14,"baz",20]]']) 
```

这使：

```
Namespace(l=[[1, 2], ['foo', 'bar'], [3.14, 'baz', 20]]) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-04-21T17:40:27.930

### JSON 列表解决方案

通过命令行处理传递列表（也是字典）的一个好方法是使用**json**。这简化了 argparse 解析，但代价是需要单独的步骤来解析 json。

```
# parse_list.py
import argparse
import json

parser = argparse.ArgumentParser()
parser.add_argument('-l', '--list', type=str)
args = parser.parse_args()
# parse string json input to python list
parsed_list = json.loads(args.list)
print(parsed_list) 
```

### 示例用法

```
$ python parse_list.py -l "[265340, 268738, 270774, 270817]"
[265340, 268738, 270774, 270817] 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-16T17:12:37.227

我想处理传递多个列表、整数值和字符串。

有用的链接 =>[如何将 Bash 变量传递给 Python？](https://stackoverflow.com/a/7521111/2402577)

```
def main(args):
    my_args = []
    for arg in args:
        if arg.startswith("[") and arg.endswith("]"):
            arg = arg.replace("[", "").replace("]", "")
            my_args.append(arg.split(","))
        else:
            my_args.append(arg)

    print(my_args)

if __name__ == "__main__":
    import sys
    main(sys.argv[1:]) 
```

* * *

顺序并不重要。如果您想传递一个列表，只需在 and 之间执行操作，`"["`并`"]`使用逗号分隔它们。

然后，

```
python test.py my_string 3 "[1,2]" "[3,4,5]" 
```

输出 => `['my_string', '3', ['1', '2'], ['3', '4', '5']]`，`my_args`变量按顺序包含参数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-25T06:40:04.993

您可以将列表解析为字符串并使用`eval`内置函数将其读取为列表。在这种情况下，您必须将单引号放入双引号（或其他方式）以确保成功的字符串解析。

```
# declare the list arg as a string
parser.add_argument('-l', '--list', type=str)

# parse
args = parser.parse()

# turn the 'list' string argument into a list object
args.list = eval(args.list)
print(list)
print(type(list)) 
```

测试：

```
python list_arg.py --list "[1, 2, 3]"

[1, 2, 3]
<class 'list'> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-18T01:37:42.010

请注意，如果您`action='append'`与`default`参数一起传递，Argparse 将尝试附加到提供的默认值，而不是替换您可能期望或可能不期望的默认值。

这是`action='append` [Argparse Docs 中给出的一个示例](https://docs.python.org/3/library/argparse.html#action)。在这种情况下，事情将按预期工作：

```
>> import argparse
>> parser = argparse.ArgumentParser()
>> parser.add_argument('--foo', action='append')
>> parser.parse_args('--foo 1 --foo 2'.split())

Out[2]: Namespace(foo=['1', '2']) 
```

但是，如果您选择提供默认值，Argparse 的“附加”操作将尝试附加到提供的默认值，而不是替换默认值：

```
import argparse
REASONABLE_DEFAULTS = ['3', '4']
parser = argparse.ArgumentParser()
parser.add_argument('--foo', default=REASONABLE_DEFAULTS,action='append')
parser.parse_args('--foo 1 --foo 2'.split())

Out[6]: Namespace(foo=['3', '4', '1', '2']) 
```

如果您*希望*Argparse*替换*默认值——例如传入一个元组作为默认值，而不是一个列表——这可能会导致一些令人困惑的错误：

```
import argparse
REASONABLE_DEFAULTS = ('3', '4')
parser = argparse.ArgumentParser()
parser.add_argument('--foo', default=REASONABLE_DEFAULTS,action='append')
parser.parse_args('--foo 1 --foo 2'.split())

AttributeError: 'tuple' object has no attribute 'append' 
```

有一个[跟踪这种意外行为的错误](https://bugs.python.org/issue16399)，但由于它可以追溯到 2012 年，因此不太可能得到解决。

# java - 通过 Socket 发送不可序列化的对象

> ID：15753704
> 
> 赞同：-1
> 
> 时间：2013-04-01T23:35:12.927
> 
> 标签：java, serversocket, notserializableexception

我正在尝试通过`java.net.Socket`并`java.net.ServerSocket`使用`ObjectOutputStream`and发送一些对象，`ObjectInputStream`但我遇到了一个问题。我尝试发送的对象不可序列化。我已经尝试将它们作为 a 发送，`String`但无法投射。此问题的任何解决方法？

编辑：

我正在查看问题的 StackTrace，发现它是由 JLabel 抛出的。我认为这很奇怪，因为 JLabel 实现了 Serializable。但是当我通过 eclipse 检查 JavaDocs 并来到错误被抛出的那一行`public boolean updateImage(ect..)`并意识到这是由于 Icon 引起的。有什么办法可以避免这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:26:21.917

每个 Swing 组件的 Javadoc 中都有关于不序列化 Swing 组件的*响亮警告。*阅读。您应该做的是序列化相应的*模型。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:35:47.067

您需要实现 Serializable 接口伴侣；）看看这里：[http ://docs.oracle.com/javase/1.5.0/docs/api/java/io/Serializable.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/Serializable.html)

您需要在您尝试通过套接字发送的对象的类上实现此接口。

# android - Android Google Maps v2 - OnMyLocationChangeListener - 它到底需要什么？

> ID：15753706
> 
> 赞同：1
> 
> 时间：2013-04-01T23:35:17.657
> 
> 标签：android, google-maps-android-api-2

因为不想混淆，所以我会尝试用SDK示例代码来解释。

一切正常 - 除了`"onMyLocationChange"`回调。

```
 - API 16 & 17 tested 
 - updated Play Services Rev.5 
 - Tested with ICS Tablet&Phone 
```

我刚刚添加了接收位置更新所需的内容：

```
UiSettingsDemoActivity implements OnMyLocationChangeListener 
```

附在地图上：

```
mMap.setOnMyLocationChangeListener(this); 
```

并实现了回调

```
@Override
public void onMyLocationChange(Location arg0) {
    ....
} 
```

但是这个方法永远不会被触发。

2 月 26 日的发行说明：[https](https://groups.google.com/d/msg/google-maps-android-api-notify/va_IsjNu5-M/QPtoSn69UMgJ) ://groups.google.com/d/msg/google-maps-android-api-notify/va_IsjNu5-M/QPtoSn69UMgJ - 所以我认为这是可行的。

编辑：[http ://code.google.com/p/gmaps-api-issues/issues/detail?id=4644](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4644)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:45:31.257

Have you added a `LocationListener` in your application?:

```
locationListener = new MyLocationListener();  
locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener); 
```

MyLocationListener:

```
public class MyLocationListener implements LocationListener 
{
static final String TAG = MyLocationListener.class.getSimpleName();
@Override
public void onLocationChanged(Location location) {
     SGTasksListAppObj.getInstance().currentUserLocation = location;
     Log.d(TAG, "New location was set to currentUserLocation: "+location.toString());

}

@Override
public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub
}

@Override
public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub
}

} 
```

**Update:**

Maybe you should try the:

```
map.setMyLocationEnabled(boolean boolean); 
```

method, and check this link:

[How to get My Location changed event with Google Maps android API v2?](https://stackoverflow.com/questions/13742551/how-to-get-my-location-changed-event-with-google-maps-android-api-v2/14305851#14305851)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:48:03.500

How are you testing whether your location have changed? I would assume it would involve moving around or using dummy data and change the location manually. Does your gps need to be turned on?

# symfony - Symfony2 删除记录

> ID：15753710
> 
> 赞同：1
> 
> 时间：2013-04-01T23:35:30.157
> 
> 标签：symfony

我在使用 Symfony2 从我的数据库中删除记录时遇到问题。希望有人可以帮助我。

这是我的代码：

```
// Get user's account
$account = $this->getUser()->getAccount();

// Get manager
$em = $this->getDoctrine()->getManager();

// Get entity
$entity = $em->getRepository('WICPurchaseOrderLineItemBundle:PurchaseOrderLineItem')->findBy(array('account'=>$account->getId(), 'id'=>$id));

// If not entity
if (!$entity) {
throw $this->createNotFoundException('Unable to find this entity.');
}

// Remove the record...
$em->remove($entity);
$em->flush();

// Go to this url...
return $this->redirect($this->generateUrl('purchaseOrder_view', array('id' => '8'))); 
```

运行此程序时，我收到此错误：

```
 EntityManager#remove() expects parameter 1 to be an entity object, array given. 
```

我的网址如下所示：

```
 {{ path('purchase_order_remove_line_item', { 'id': purchaseOrderLineItem.id }) }} 
```

我的“id”号码需要先变成一个对象吗？不知道如何解决这个问题，仍在学习 Symfony。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T00:23:16.040

您只需要使用`findOneBy`方法而不是`findBy`方法。

```
$entity = $em->getRepository('WICPurchaseOrderLineItemBundle:PurchaseOrderLineItem')->findOneBy(array('account'=>$account->getId(), 'id'=>$id)); 
```

# git - 从 git 开始的 git-tfs

> ID：15753712
> 
> 赞同：1
> 
> 时间：2013-04-01T23:36:03.353
> 
> 标签：git, tfs, git-tfs

我有一个现有的 git repo，我被迫放入 tfs。我想使用 git-tfs 工具，但我一生都无法弄清楚如何做到这一点。我见过的所有例子都是从 git tfs clone 开始的，但我已经有一个 git repo 并且想在它上面运行“checkin”。

编辑：我已经尝试根据我需要的相反场景将指令拼凑在一起。我尝试创建一个空项目并将其添加到 tfs，然后从 git 复制我的代码，但我丢失了我的历史记录（我不想要）。我在这里寻找的是一组完成我需要的步骤。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T16:23:42.223

事实上，git-tfs 只能通过克隆 TFS 存储库来工作。

我只是希望您没有很多分支可以签入 TFS，否则这将很无聊但可行！

首先，在 tfs 中创建一个空存储库。

**旧解决方案**（如果您想采用这种方式仍然有效......）：~~并使用 tfs.clone 克隆它。您应该能够轻松地做到这一点，并且在这个新的 git 存储库中应该只有一个没有文件的提交。~~

~~现在，向您现有的 git 存储库添加一个远程，并将远程 master 重新定位到新存储库的初始提交。~~

**新解决方案：**使用[此脚本](https://gist.github.com/pmiossec/2421ffcc8011e873641b)

然后使用 'git tfs rcheckin' 提交所有历史记录。它应该很长:(

之后，如果您有要提交的分支，并且您有 git-tfs 0.17.1 的最新版本，请提取好的修订版并使用以下命令创建一个 tfs 分支：

git tfs 分支名称_of_my_branch

并重新设置 git 分支的所有提交并使用 rcheckin ： git tfs rcheckin -i Name_of_my_branch

对你所有的分支都这样做，那应该很好......

但是我应该补充一点，如果你有合并提交，它们都会在这个过程中丢失:(你不会有一个比现有 git 存储库更漂亮的存储库

PS：

*   我真的很抱歉你在使用了 git 之后不得不使用 TFS

*   您不能使用即将发布的 TFS 2012 的新功能并允许在 TFS 中拥有一个 git 存储库吗？ [http://blogs.msdn.com/b/bharry/archive/2013/01/30/git-init-vs.aspx](http://blogs.msdn.com/b/bharry/archive/2013/01/30/git-init-vs.aspx)和 [http://www.hanselman.com/blog/GitSupportForVisualStudioGitTFSAndVSPutIntoContext.aspx](http://www.hanselman.com/blog/GitSupportForVisualStudioGitTFSAndVSPutIntoContext.aspx)

# java - 小数点后 8 位出现的双打的微小添加：Android

> ID：15753713
> 
> 赞同：0
> 
> 时间：2013-04-01T23:36:07.537
> 
> 标签：java, android, double

关于这个，我还是有点菜鸟。我对正在发生的事情感到困惑。我将 3.542 存储在 sqlite 数据库中。使用 Firefox sqlite 查看器检查数据库证实了这一点。然后我使用以下代码检索了该值：

```
public double getCaffPer(String type) {
    SQLiteQueryBuilder builder = new SQLiteQueryBuilder();
    builder.setTables(DRKTYPES);
    String[] columns = { MGCAFF };
    String[] selectionArgs = { type };
    Cursor cursor;
    cursor = builder.query(ourDatabase, columns, TYPE + "=?",
            selectionArgs, null, null, null);
    float result = -1;
    if (cursor.getCount() != 0) {
        cursor.moveToFirst();
        result = cursor.getFloat(0);
    }
    cursor.close();
    return result;
} 
```

调试显示结果值为 3.542。但后来在我的代码中，我调用了这个方法：

```
double caff = helper.getCaffPer(typeName); 
```

它给了我 3.5420000553131104。我知道这没什么区别，但我很困惑为什么要添加最后的东西。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:39:41.153

发生该行为是因为您声明`result`为 a`float`但`getCaffPer()`返回 a `double`。Java 在这两种类型之间进行静默转换，这会在输出中引入差异。

# python - ElementTree SyntaxError：预期的路径分隔符 ([)

> ID：15753714
> 
> 赞同：3
> 
> 时间：2013-04-01T23:36:21.003
> 
> 标签：python, libxml2, elementtree

在过去的几天里，我进行了广泛的搜索，似乎找不到我想要的东西。我使用 Python 2.7.3 和 ElementTree 编写了一个脚本来解析 XML 文件并编辑隐藏在 XML 文件中的属性。该脚本工作正常。上周晚些时候，我与一位客户开会，他告诉我目标平台将是 CentOS。我想，没问题。为了在预期的平台上进行测试，我创建了一个 CentOS VMWare 客户端，令我惊讶的是，我的脚本搞砸了，给了我错误消息“ **SyntaxError: expected path separator ([)** ” 在我研究这个错误的性质的过程中message 我了解到 CentOS 6.4 支持 Python 2.6.6，
这个客户不会在平台上升级 Python，也不会安装额外的库，所以 lxml 对我来说不是一个选项。我的问题是，如果没有 ElementTree 对 [@attribute] 设施的支持，我还能以某种方式访问​​隐藏的属性并对其进行编辑吗？

这是我正在处理的 XML 类型的示例：

```
`

<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<my-gui>
    <vehicles>
        <car vendor="Ford"/>
    </vehicles>
    <options>
        <line transmission='manual'/>
    </options>
    <title>Dealership</title>
    <choice id='manual' title="Dealership">
        <pkg-deal id='manual' auth='manager'>.</pkg-deal>
    </choice>
    <choice id='manual' title='Dealership'/>
    <choice id='manual' DealerLocation='Dealer_Loc'/>
    <choices-outline color='color_choice'>
        <line choice='blue'/>
    </choices-outline>
    <choice id='cars' GroupID='convertables'>
        <pkg-deal id='model.Taurus' version="SEL" arguments='LeatherInterior' enabled='XMRadio'>Taurus</pkg-deal>
        <pkg-deal id='model.Mustang' version="GT" enabled='SIRIUSRadio'>Mustang</pkg-deal>
        <pkg-deal id='model.Focus' version="SE" enabled='XMRadio'>Focus</pkg-deal>
        <pkg-deal id='model.Fairlane'>Fairlane</pkg-deal>
        <pkg-deal id='model.Fusion' version="SE" arguments='ClothInerior'>Fusion</pkg-deal>
        <pkg-deal id='model.Fiesta' version="S Hatch" enabled="SIRIUSRadio">Fiesta</pkg-deal>
    </choice>
</my-gui>

` 
```

这是在 Python 2.6.6 下中断的成功 Python 2.7.3 代码片段：

```
if self.root.iterfind('pkg-deal'): 
          self.deal = self.root.find('.//pkg-deal[@id="model.fusion"]')
          self.arg = str(self.deal.get('arguments'))
          if self.arg.find('with Scotchguard=') > 0:  
            QtGui.QMessageBox.information(self, 'DealerAssist', 'The selected car is already updated. Nothing to do.')            
            self.leave()        
          self.deal.set('arguments', self.arg + ' with Scotchguard') 
          ...
      ... 
```

有没有办法可以修改这个“if”语句块的第一行，允许我编辑 Fusion 元素的“arguments”属性？还是我被降级为实现 libxml2，这有望成为一个真正的痛苦？...

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T20:25:49.247

这可能会回避这个问题，但您可以尝试从 Python 2.7 复制并粘贴 ElementTree 的版本，重命名它以避免与标准库冲突，然后导入和使用它。

但是，由于 ElementTree 不打算用作独立文件，因此您需要做的是导航到`C:\Python27\Lib\xml`并复制整个`etree`文件夹并通过`import etree.ElementTree`在脚本中执行导入 ElementTree。

为避免意外从 Python 2.6 导入或使用 ElementTree 版本，您可能应该重命名`etree`文件夹及其内容，删除`.pyc`文件，并修复文件内的导入以引用 Python 2.7 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-24T16:03:02.077

另一个用户在这里解决了同样的问题[。](https://stackoverflow.com/questions/13667979/python-2-6-1-expected-path-separator)

该用户在 Python 2.6 中手动过滤了属性。我在这里发布他们的代码示例，即使该示例专门与提问者的代码有关：

```
def final_xml(self,username):
    users = self.root.findall("user")
    for user in users:
        if user.attrib.get('username') == 'user1':
            break
    else:
        raise ValueError('No such user')

    # `user` is now set to the correct element
    self.root.remove(user)
    print user
    tree = ET.ElementTree(self.root)
    tree.write("msl.xml") 
```

# .net - 使用 wcf rest 服务在 iis7 上显示错误？

> ID：15753719
> 
> 赞同：2
> 
> 时间：2013-04-01T23:37:04.330
> 
> 标签：.net, wcf, iis-7

我有一个 wcf 休息服务，当我把它放在 iss7 上并运行给我这个

```
The server encountered an error processing the request.
See server logs for more details. 
```

但日志什么也没说。所以我的问题是如何解决这些错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T00:23:30.090

根据我的需要（调试），只需在我的服务行为上将此设置为 true 并得到异常。

```
<serviceDebug includeExceptionDetailInFaults="false"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T22:50:19.567

您可以使用多种方法来获取详细的错误。基本上，它们的工作原理都与`BlaShadow`. 这是一篇关于此的[博客文章](http://nsamteladze.blogspot.com/2013/07/enable-verbosely-errors-in-wcf-data.html)。

我知道获得更好错误的 3 种方法：

1.  设置`UseVerboseErrors' in`InitializeService' 方法。但是，如果在调用“InitializeService”之前发生错误（发生这种情况），这不会给您任何帮助。

2.  `IncludeExceptionDetailInFaults`在服务类之前使用属性设置为 true。

3.  `IncludeExceptionDetailInFaults`使用 web.config设置为 true。

# python - web2py，安全地将远程数据库复制到本地机器

> ID：15753720
> 
> 赞同：0
> 
> 时间：2013-04-01T23:37:26.643
> 
> 标签：python, web2py

我有一个 web2py 应用程序。我想添加特权用户可以将应用程序的数据库从远程服务器下载/复制到本地计算机的功能。问题是数据库包含敏感信息，如登录凭据。如何在从远程服务器复制 db 时即时修改 db 条目？

# java - 创建 XML 文档“SAX 样式”？

> ID：15753724
> 
> 赞同：2
> 
> 时间：2013-04-01T23:37:37.180
> 
> 标签：java, xml, sax

我需要将一个（可能很大的）XML 文档直接发送到流中，所以我想以“SAX 样式”执行它——以流方式，当我去的时候，文档通过线路发送——而不是到“DOM 样式”——以批处理方式，其中文档构建在内存中，然后在最后通过网络发送。我确信这很容易做到，但我找不到适合我生活的好教程。提前感谢您的建议。

**编辑**需要明确的是，我并不特别关注要使用哪个 XML API，只要它在构建文档时通过网络发送文档，而不是在内存中构建整个文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T02:35:28.837

我倾向于使用[StAX](http://docs.oracle.com/javase/tutorial/jaxp/stax/using.html)而不是 SAX 来生成 XML - API 更易于使用。XML 是流式传输的，而不是保存在内存中。

例子：

```
XMLStreamWriter w = XMLOutputFactory.newInstance().createXMLStreamWriter(System.out);
try
{
    w.writeStartDocument();
    w.writeStartElement("root");
    for (int i = 0; i < 1000; i++)
    {
        w.writeStartElement("number");
        w.writeCharacters(String.valueOf(i));
        w.writeEndElement(); //number
    }
    w.writeEndElement(); //root
    w.writeEndDocument();
}
finally
{
    w.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T03:15:40.807

您最好的方法可能取决于您的数据的来源。它是从内存中开始的吗？您是否从外部来源（如服务或数据库）检索数据？

如果您要转换大量对象，例如来自数据库的查询，那么执行简单对象到 XML 转换的对象序列化程序（例如 Jackson）可能仍然符合您的低内存消耗目标——您只需申请它迭代地。打开您的流，读取一行，对其进行序列化，将其输出到流中，读取下一行，对其进行序列化等。您始终保持打开相同的输出流，但始终保持内存中的 XML 代码量小的。

# powershell - 如何使用 powershell 在 Windows 8 中打开 Windows Location 平台

> ID：15753728
> 
> 赞同：0
> 
> 时间：2013-04-01T23:38:13.903
> 
> 标签：powershell

有没有办法使用 PowerShell 在 Windows 8 中检查“打开 Windows 位置平台”选项？此选项在控制面板 - 位置设置下可用。

当我手动打开它时，我没有找到任何为此进行的注册表设置。如果我找到任何注册表设置，我可以使用该注册表选项来启用它，但不幸的是注册表没有变化。

提前感谢普拉文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:25:44.077

实际上，我只是使用 Procmon 查看正在更改的 reg 密钥，并看到该密钥名为“SensorPermissionState”。如果复选框被选中（即它已打开），则值为 1。

如果您清除复选框，它将设置为 0x00000000

所以这应该打开它（似乎要求你在 Admin Shell 中）：

```
Set-ItemProperty ` 
    -path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Sensor\Overrides\{BFA794E4-F964-4FDB-90F6-51056BFE4B44}\' ` 
    -name sensorpermissionstate -value 1 
```

并关闭它

```
Set-ItemProperty ` 
    -path 'HKLM:\SOFTWARE\Microsoft\Windows nt\CurrentVersion\Sensor\Overrides\{BFA794E4-F964-4FDB-90F6-51056BFE4B44}' `
    -name sensorpermissionstate -Value 0 
```

# dotnetnuke - 如何在 dnn6 中自定义用户帐户下拉列表

> ID：15753733
> 
> 赞同：0
> 
> 时间：2013-04-01T23:38:39.590
> 
> 标签：dotnetnuke

在 dnn6 中，请您转到 admin->user accounts 并查看下拉选择器吗？它显示您可以按用户名、电子邮件等进行搜索，但不能按名字或姓氏进行搜索。你知道这个下拉列表是如何填充的，所以我们可以改变它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T16:18:57.983

我不知道为什么您的字段不会填充这些字段，我没有将它们添加到我的字段中，它们已经存在。

下拉列表的填充出现在 \desktopmodules\Admin\Security\Users.ascx.cs 文件中

```
ProfilePropertyDefinitionCollection profileProperties = ProfileController.GetPropertyDefinitionsByPortal(PortalId, false, false); 
```

因此，我将首先查看您在门户级别定义的配置文件属性，看看您那里是否有名字/姓氏。您可以在“用户帐户设置”选项卡（在“配置文件设置”部分下）的“管理员/站点设置”页面中找到配置文件属性

如果您使用的是 DNN6（不是 DNN7），那么您将转到管理员/用户帐户页面并转到用户帐户模块的操作并找到用户配置文件属性区域。

# macos - Mac OS X 驱动程序与 Linux USB 复合小工具驱动程序 g_multi 一起使用

> ID：15753737
> 
> 赞同：7
> 
> 时间：2013-04-01T23:39:10.080
> 
> 标签：macos, usb, driver, embedded-linux

我有兴趣在嵌入式 Linux 设备中使用[Linux USB 复合小工具驱动程序`g_multi`](http://kernel.org/doc/Documentation/usb/gadget_multi.txt)，用于 Ethernet-over-USB 和 serial-over-USB（Ethernet-over-USB 是为 RNDIS 模式编译的；我对海量存储功能，所以我禁用了它）。我已经对其进行了测试，并且可以在 Windows 和 Linux 上正常工作。但是，使用 Mac OS X 进行的简短测试表明 OS X 不会自动为其加载驱动程序。

我知道原则上 OS X 具有基于 USB 的以太网的功能，因为它可以自动与 Linux USB`g_ether`驱动程序（为 RNDIS 模式编译）一起工作。同样，OS X 也可以使用带有 Linux USB 驱动程序的serial-over-USB ——我可以使用[ZOC](http://www.emtec.com/zoc/screenshotsmac.html)`g_serial`连接到 USB 串行端口。但是当 Linux 设备运行时它什么也不做。`g_multi`

我找不到任何说明如何使 OS X 与运行`g_multi`驱动程序的 Linux 设备一起工作的文档。有没有人成功做到这一点？

是否可以使用某种简单的 OS X 驱动程序来完成，该驱动程序基本上告诉 OS X 为每个组件功能加载其驱动程序（有点像我用于 Windows 的 INF 文件，它只是告诉 Windows 加载标准 Windows以太网和串行 USB 驱动程序）？如果是这样，这样做的程序是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-12-11T21:12:02.597

不幸的是，MAC OS 不支持 RNDIS。您需要第三方驱动程序，例如[https://www.joshuawise.com/horndis](https://www.joshuawise.com/horndis)。

# .htaccess - .htaccess 重定向到子文件夹

> ID：15753740
> 
> 赞同：-3
> 
> 时间：2013-04-01T23:39:25.990
> 
> 标签：.htaccess, mod-rewrite

请帮助设置 .htaccess / mod_rewrite 重定向，它将：

-> 将 example.com 重定向到 example.com/forum/ 和

-> 将 example.com/any-posts.php 重定向到 example.com/forum/any-posts.php

实际上，我在一个月前创建了一个论坛，该论坛正在“example.com”上访问，但现在需要将所有内容重定向到 /forum/ 以便它像：example.com/forum/ 文件夹一样工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:49:25.077

In that case, you must rewrite the url

the .htaccess should be

```
RewriteEngine on
RewriteRule ^(.*)$ /forum/$1 [L] 
```

and you get example.com to example.com/forum/

# html - 如何将此标签文本居中对齐？

> ID：15753746
> 
> 赞同：2
> 
> 时间：2013-04-01T23:40:26.120
> 
> 标签：html, css, forms

如何垂直对齐此文本的中心？

从：

![在此处输入图像描述](https://i.stack.imgur.com/RQfXq.jpg)

到：

![在此处输入图像描述](https://i.stack.imgur.com/bfAJL.png)

```
<<p>
<label></label>
<input type="checkbox" id="checkbox" name="checkbox" class="regular-checkbox big-checkbox" value="Yes" checked="checked">
<label for="checkbox" style="margin-right:10px;"></label>Subscribe me to your mailing list for upcoming events, hot offers and deals
</p> 
```

[http://jsfiddle.net/JoshSalway/E5CxM/](http://jsfiddle.net/JoshSalway/E5CxM/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:42:22.363

试试这个：-

[http://jsfiddle.net/AFGMf/](http://jsfiddle.net/AFGMf/)

```
 label
    {
        vertical-align:middle;
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-01T23:43:43.803

尽管看起来违反直觉，您需要添加`vertical-align: middle`到要垂直对齐*的*元素，而不是要垂直对齐的元素（在这种情况下，`label[for=checkbox]`.

在此处查看演示：http: [//jsfiddle.net/E5CxM/2/](http://jsfiddle.net/E5CxM/2/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-01T23:41:30.867

使用 line-height 使文本垂直居中

```
label{
line-height: 45px;
height: 45px;
display: inline-block;
} 
```

下面是一个简单的例子来说明它是如何工作的：

[http://jsfiddle.net/E5CxM/10/](http://jsfiddle.net/E5CxM/10/)

# .net - xsd.exe：解决 XSD 冲突

> ID：15753749
> 
> 赞同：0
> 
> 时间：2013-04-01T23:41:08.727
> 
> 标签：.net, xml, exchangewebservices

我正在尝试在此位置组合 Exchange 自动发现 XSD：

[http://msdn.microsoft.com/en-us/library/ee160637(v=exchg.80).aspx](http://msdn.microsoft.com/en-us/library/ee160637(v=exchg.80).aspx)

基本上，它是一个“请求”XSD 和三个“响应 XSD”。三个响应 XSD 定义了不同的响应（正确响应、错误响应和重定向响应），因此每个文件都包含一个类似于这样的类：

```
<Autodiscover>
 <Request>
   ...
 </Request>
</Autodiscover>

<Autodiscover>
<Response>
   ...good response...
</Response>
</Autodiscover>

<Autodiscover>
<Response>
   ...error response...
</Response>
</Autodiscover>

<Autodiscover>
<Response>
   ...redirect response...
</Response>
</Autodiscover> 
```

问题是“响应”XSD 显然具有相同的名称，因此一旦我生成 XSD 并将它们包含在项目（C# 项目）中，它们就会发生冲突。处理这种情况的最佳实践是什么，希望对原始 XSD 进行最少修改或不修改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:43:52.593

将每个生成的类放入其自己的命名空间，然后（可选）为每个类创建一个别名。

# html - 如何禁用 unicode 黑色电话在 iOS 邮件应用程序上呈现为红色电话？

> ID：15753750
> 
> 赞同：2
> 
> 时间：2013-04-01T23:41:15.103
> 
> 标签：html, ios, unicode, html-email, emoji

我在 html 电子邮件中使用[unicode 黑色电话字符 (☎ U+260E) 。](http://www.decodeunicode.org/en/u+260E)在 iOS 邮件应用程序（在 iPhone 和 iPad 上测试）上，黑色电话字符呈现为红色表情符号电话图标。

![unicode 电话图标](https://i.stack.imgur.com/S0KYY.png)

请注意，[unicode 白色电话字符 (☏ U+260F)](http://www.decodeunicode.org/en/u+260F)不会显示为表情符号。

我试图将字体强制为“Helvetica”……但没有运气。

**有什么办法可以强制 iOS Mail 使用扁平的黑色电话 unicode 字符？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T04:36:25.273

我无法在 iOS 邮件中对此进行测试，并且我怀疑它是否可以在那里工作，但这是可以选择特定字形变体的*方式*。根据 Unicode 标准，您可以通过在 U+260E 后紧跟控制字符 U+FE0E VARIATION SELECTOR-15来选择[标准化变体“BLACK TELEPHONE text style”（与“BLACK TELEPHONE emoji style”相反）。](http://www.unicode.org/Public/UNIDATA/StandardizedVariants.html)

在 HTML 中，字符序列 U+260E U+FE0E 可以写成`&#x260e;&#xfe0e;`.

但恐怕软件对变体选择器的支持仍然非常有限。例如，网络浏览器似乎以不同的方式失败。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-09T16:10:05.297

晚了一年多一点，但是像这样指定字体来解决这个问题：

```
<span style="font-family:dingbats, arial unicode ms, code2000, sans-serif;">&#x260e;</span> 
```

# php - 如何在类的方法中从 PDO 返回 LastInsertID

> ID：15753753
> 
> 赞同：1
> 
> 时间：2013-04-01T23:41:22.773
> 
> 标签：php, mysql, pdo

我创建了一个小类来处理我的 MySql 查询。

但是，现在我正在尝试获取最后插入的 id 的值，但这对我来说并不适用

如果我在类中的 processQuery 方法使用任何查询（如插入/更新/删除）执行准备语句

我已经添加了这一行 $this->lastInsertId = $this->pdo->lastInsertId; 它应该给我最后插入的 Id 并将其存储在名为 $lastInsertId 的公共变量中，然后我可以从我的外部代码访问它。

如何获取最后插入的 ID 以使用此类？

谢谢

这是我的课

```
<?php

class connection {

    private $connString;
    private $userName;
    private $passCode;
    private $server;
    private $pdo;
    private $errorMessage;
    public $lastInsertId;

    private $pdo_opt = array (
                            PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
                            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
                            );

    function __construct($dbName, $serverName = 'localhost'){

        //sets credentials
        $this->setConnectionCredentials($dbName, $serverName);

        //start the connect
        $this->startConnection();

    }

    function startConnection(){

            $this->pdo = new PDO($this->connString, $this->userName, $this->passCode, $this->pdo_opt);

            if( ! $this->pdo){

                $this->errorMessage  = 'Failed to connect to database. Please try to refresh this page in 1 minute. ';
                $this->errorMessage .= 'However, if you continue to see this message please contact your system administrator.';

            }

    }

    //this will close the PDO connection
    public function endConnection(){

        $this->pdo = null;
    }

    //return a dataset with the results
    public function getDataSet($query, $data = NULL)
    {
        $cmd = $this->pdo->prepare( $query );

        $cmd->execute($data);

        return $cmd->fetchAll();
    }

    //return a dataset with the results
    public function processQuery($query, $data = NULL)
    {
        $cmd = $this->pdo->prepare( $query );
        $this->lastInsertId = $this->pdo->lastInsertId;
        return $cmd->execute($data);
    }

    //this where you need to set new server credentials with a new case statment
    function setConnectionCredentials($dbName, $serv){

        switch($serv){

            case 'BLAH':
                $this->connString   = 'mysql:host='.$serv.';dbname='.$dbName.';charset=utf8';
                $this->userName     = 'BLAH';
                $this->passCode     = 'BLAH';
            break;

            default:
                $this->connString   = 'mysql:host='.$serv.';dbname='.$dbName.';charset=utf8';
                $this->userName     = 'BLAH2';
                $this->passCode     = 'BLAH2';
            break;

            }

    }

}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:44:54.750

您可以添加这样的方法：

```
public function lastInsertId($name = NULL) {
    if(!$this->pdo) {
        throw new Exception('not connected');
    }

    return $this->pdo->lastInsertId($name);
} 
```

它只是一个包装器[`PDO::lastInsertId()`](http://www.php.net/manual/en/pdo.lastinsertid.php)。您不需要最后一个插入 ID 的本地副本。如果 PDO 未连接，它将抛出异常。`return FALSE;`如果这更适合您的设计，您可以将其更改为。

像这样使用它：

```
$con = new connection('testdb'); 
$con->processQuery('INSERT INTO `foo` ....');
$lastInsertId = $con->lastInsertId(); 
```

# mysql - Mysql：修剪数字在X和Y MIN / MAX之间

> ID：15753755
> 
> 赞同：0
> 
> 时间：2013-04-01T23:41:41.757
> 
> 标签：mysql

我不知道用于此的术语或确切的词，但我正在寻找 MySQL 中的一个函数，它可以将一个数字修剪为 X 和 Y 之间。

例如，像这样：

```
SELECT TRIM_NUMBER(NUMBER, MIN, MAX); 
```

如果我这样做：`TRIM_NUMBER(50, 1, 100)`应该没问题，然后返回`50`.

但是如果我这样做：`TRIM_NUMBER(999, 1, 100)`它应该 return `100`，因为它是我设置的 MAX 值。同样的事情也适用于 MIN。

MySQL 中是否包含任何此类功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:49:09.953

试试这个

```
SELECT GREATEST(LEAST(NUMBER, 100), 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:50:29.260

没有内置任何东西，而是您自己编写的代码，如下所示：

```
select if(num < 1, 1, if (num > 100, 100, num)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T00:00:47.317

如果你想要一个函数的“矫枉过正”，这里有一个建议：

```
create function trimNumber(x double, floorValue double, ceilValue double) returns double
begin
   declare ans double;
   if x >= floorValue and x <= ceilValue then
       set ans = x;
   else
       if x < floorValue then
           set ans = floorValue;
       else
           set ans = ceilValue;
       end if;
   end if;
   return ans;
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T23:46:58.350

我认为您正在寻找类似的东西（来自 MySQL 参考手册）：

[http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_between](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_between)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-02T01:07:10.830

只需添加它，因为它是 ANSI 标准的表达方式：

```
select (case when num < 1 then 1
             when num > 100 then 100
             else num
        end) as TrimmedNum 
```

# python - py2neo 中的 MVC 和 OOP

> ID：15753757
> 
> 赞同：0
> 
> 时间：2013-04-01T23:42:00.767
> 
> 标签：python, py2neo

我正在寻找一些使用 py2neo 的“最佳实践”编码风格。来自 Django ORM 和 Bulbs（另一个 python neo4j 库），我习惯于 MVC 风格的模型与控制器分离，如下所示：

```
class Node_Type_A(Node):
    element_type = 'A node'
    modified = DateTime(default=now())

    def custom_A_method(self):
        pass 
```

我读到这是用元类完成的，我认为它在 py2neo 中不可用，而且很可能是矫枉过正。

但我想知道一个好的实用的 py2neo 编码风格来实现：

*   一些节点/关系模板（节点类型`A`有`modified`var吗？是什么类型的？我的节点是什么类型的`node_b`？）
*   将每个节点类型的变量和方法放在一起：

    ```
    res = graph_db.create({dict})
    res.custom_A_method() 
    ```

*   将更改的变量保存回数据库，例如`a.modified = now()`

在py2neo中有什么方法吗？感谢您的任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T07:48:48.090

如果您正在使用（或来自）Django，那么我建议您查看 Rob Edwards 的[neomodel](https://github.com/robinedwards/neomodel)。它建立在 py2neo 之上，特别适合在 Django 中使用，但在该环境之外同样可用。它是为 Django 模型式的编码风格而设计的，这种风格应该很熟悉，希望能给你想要的东西！

# sql - 拆分字符串，将数据复制到多个表中

> ID：15753760
> 
> 赞同：0
> 
> 时间：2013-04-01T23:42:26.767
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2005

我有以下表格

**表 A**

```
RID | Name        |Phone       |Email        |CreatedOn
------------------------------------------------------------
1 | John Smith    | 2143556789 |t1@gmail.com |2012-09-01 09:30:00
2 | Jason K Crull | 2347896543 |t2@gmail.com |2012-08-02 10:34:00 
```

**表 B**

```
CID| FirstName |LastName |Phone      |Email        |CreatedOn          |Title|Address|City|State
---------------------------------------------------------------------------------------------------
11 | John      | Smith   |2143556789 |t1@gmail.com |2012-09-01 09:30:00|NULL|NULL|NULL|NULL
12 | Jason     | K Crull |2347896543 |t2@gmail.com |2012-08-02 10:34:00|NULL|NULL|NULL|NULL 
```

**表 C**

```
RID | CID |IsAuthor|CreatedOn
-----------------------------------------
1   | 11  | 0      |2012-09-01 09:30:00
2   | 12  | 0      |2012-08-02 10:34:00 
```

对于“表 A”中的每一行，需要在“表 B”中创建一行，将名称拆分为名字和姓氏，如图所示，创建行后，将新行插入表 C，其中 RID 来自表 A，CID 来自表 B , IsAuthor 位默认为 0 和表 A 中的 CreatedOn。CID 自动递增。任何人都可以帮助我实现这一目标。我对 SQL 很陌生。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:45:54.003

停止思考“每一行”，将其视为“一组”。在 SQL Server 中逐行处理任何内容很少有效率，而且从这些方面考虑也很少有好处。

```
--INSERT dbo.TableC(RID, CID, IsAuthor, CreatedOn)
  SELECT a.RID, b.CID, IsAuthor = 0, a.CreatedOn
  FROM dbo.TableA AS a
  INNER JOIN dbo.TableB AS b
  ON a.Name = b.FirstName + ' ' b.LastName; 
```

当您认为它返回了正确的结果时，取消注释`INSERT`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T23:55:55.130

我相信您正在寻找类似的东西（我遗漏了一些字段，但这应该能说明问题）。主要看的是用于将名称拆分为名字和姓氏的`substring`and函数：`charindex`

```
insert into tableb (firstname,lastname,phone,email)
select 
  left(name, charindex(' ',name)-1), 
  substring(name, charindex(' ', name)+1, len(name)), 
  phone, email
from tablea ;

insert into tablec
select a.rid, b.cid, 0, a.createdon
from tablea a 
  inner join tableb b on a.name = b.firstname + ' ' + b.lastname
    and a.phone = b.phone and a.email = b.email ; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/cf108/2)

如果担心相同的名称、电子邮件等，那么您可能需要考虑使用可怕的光标和`scope_identity()`. 希望你不必走那条路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T00:04:00.487

要拆分名称，我会使用它`CharIndex`来查找空间的位置，然后`Substring`将单词分开。

为了跟踪 TableB 中的数据来自 TableA 中的哪一行，我只需将一列粘贴到 B 上以记录此数据，然后在插入表 C 时将其删除。另一种方法是使 CID 成为身份在 C 而不是 B 上的列，首先填充 C，然后在填充时将该数据提供给 TableB。

```
if OBJECT_ID('TableA','U') is not null drop table TableA
create table TableA 
(
    rid int not null identity(1,1) primary key clustered
    , Name nvarchar(64)
    , Phone nvarchar(16)
    , Email nvarchar(256)
    , CreatedOn datetime default (getutcdate())
)
if OBJECT_ID('TableB','U') is not null drop table TableB
create table TableB  
(
    cid int not null identity(1,1) primary key clustered
    , FirstName nvarchar(64)
    , LastName nvarchar(64)
    , Phone nvarchar(16)
    , Email nvarchar(256)
    , CreatedOn datetime default (getutcdate())
    , Title nvarchar(16)
    , [Address] nvarchar(256)
    , City nvarchar(64)
    , [State] nvarchar(64)
)
if OBJECT_ID('TableC','U') is not null drop table TableC
create table TableC 
(
    rid int primary key clustered
    , cid int unique 
    , IsAuthor bit default(0)
    , CreatedOn datetime default (getutcdate())
)

insert TableA (Name, Phone, Email) select 'John Smith', '2143556789', 't1@gmail.com'
insert TableA (Name, Phone, Email) select 'Jason K Crull', '2347896543', 't2@gmail.com'

alter table TableB 
add TempRid int

insert TableB(FirstName, LastName, Phone, Email, TempRid)
select case when CHARINDEX(' ', Name) > 0 then SUBSTRING(Name, 1, CHARINDEX(' ', Name)-1) else Name end
, case when CHARINDEX(' ', Name) > 0 then SUBSTRING(Name, CHARINDEX(' ', Name)+1, LEN(Name)) else '' end
, Phone
, Email
, Rid
from TableA

insert TableC (rid, cid)
select TempRid, cid 
from TableB

alter table TableB
drop column TempRid

select * from TableB
select * from TableC 
```

在这里试试：[http ://sqlfiddle.com/#!3/aaaed/1](http://sqlfiddle.com/#!3/aaaed/1)

或者这里的替代方法（在 B 之前插入 C）：http: //sqlfiddle.com/#! [3/99592/1](http://sqlfiddle.com/#!3/99592/1)

# ruby-on-rails - 由于 :id 导致的 Rails 路由混乱

> ID：15753767
> 
> 赞同：1
> 
> 时间：2013-04-01T23:43:35.040
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, routes

我正在使用设计进行身份验证。注册用户时，我会创建一个个人资料名称，我想将其用作他们的个人资料路线。所以，它可能看起来像这样：www.myapp.com/profile-name。我遇到的问题是路线没有去正确的地方。

*路线.rb*

```
resources :majors do 
  resources :reviews
end 

devise_for :users

...

match '/:id' => 'users#show', as: :user_profile 
```

我已将 :user_profile 路由放在路由文件的底部。我的部分 rake 路线如下所示：

```
major GET            /majors/:id(.:format)   majors#show
user_profile GET     /:id(.:format)          users#show 
```

在个人资料页面 (myapp.com/my-custom-profile-name) 上没有问题。但是在专业显示页面上，我使用`user_profile_path`链接到用户的个人资料，并且 url 是 www.myapp.com/:id - :id 是主要的 :id。因此，专业的 :id 与 user_profile :id 混合在一起。

我的用户控制器如下所示：

```
def show
  @user = User.find_by_profile_name(params[:id])
  @reviews = @user.reviews
end 
```

我已经更改了网址，在不同的区域进行了测试，更改了路线文件的顺序，整天搜索和测试。我无法弄清楚我错过了什么。我认为这真的很简单，但它让我望而却步。有任何想法吗？

* * *

**解决方案：**

解决方案是首先让路线正确。由于我创建了一个自定义的动态 url (myapp.com/user-profile-name)，我需要在路由中调用 id：

```
get '/:id' => 'users#show', as: :id 
```

这改变了我的路线看起来像这样：

```
id GET        /:id(.:format)              users#show 
```

用户分享评论，他们的名字贴在他们的评论旁边。我无法从他们评论中的姓名链接到他们的个人资料。我能够在这样的视图上做到这一点：

```
<%= link_to review.user.profile_name, id_path(review.user.profile_name) %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:53:03.893

要获取特定的用户配置文件，您需要将用户配置文件 ID 传递到 user_profile 命名路由：

`user_profile_path(@user)`

# php - How to get value from Bootstrap's botton?

> ID：15753770
> 
> 赞同：0
> 
> 时间：2013-04-01T23:43:49.463
> 
> 标签：php, twitter-bootstrap

Hi Bootstrap buttons are very beautiful, but How could I get the value which the user click or enter?

ie. for the check boxes.

```
<label class="checkbox inline">
  <input type="checkbox" id="inlineCheckbox1" value="option1"> 1
</label>
<label class="checkbox inline">
  <input type="checkbox" id="inlineCheckbox2" value="option2"> 2
</label>
<label class="checkbox inline">
  <input type="checkbox" id="inlineCheckbox3" value="option3"> 3
</label> 
```

If I use the PHP, could I get the values to the next page? How?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T23:49:00.250

have you tried give same same to checkboxex and handle it at phpside? like;

HTML

```
<form .....
    <label class="checkbox inline">
      <input name="mycheckboxes[]" type="checkbox" id="inlineCheckbox1" value="option1"> 1
    </label>
    <label class="checkbox inline">
      <input name="mycheckboxes[]" type="checkbox" id="inlineCheckbox2" value="option2"> 2
    </label>
    <label class="checkbox inline">
      <input name="mycheckboxes[]" type="checkbox" id="inlineCheckbox3" value="option3"> 3
    </label> 
```

PHP

```
var_dump($_POST); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:11:58.453

给它一个有意义的名字。对于这样的表格：

```
<input type="checkbox" name="gender" id="inlineCheckbox1" value="male"> male
<input type="checkbox" name="gender" id="inlineCheckbox1" value="female"> female 
```

您只需执行以下操作：

```
if (isset($_POST['gender']))
{
    $user_gender = $_POST['gender']; // would equal either "male" or "female"
} 
```

或捷径：

```
$user_gender = isset($_POST['gender']) && $_POST['gender'] == "male"  ? "male" : "female"; 
```

快乐编码。希望这可以帮助！

# vb.net - 通过 TCP/UDP 发送串行字节数据 - Visual Basic

> ID：15753771
> 
> 赞同：0
> 
> 时间：2013-04-01T23:43:50.600
> 
> 标签：vb.net, stream, byte, tcpclient, networkstream

我正在构建一个 .NET WinForms 应用程序以通过 TCP/UDP 向同一网络上的联网电视发送串行命令。NEC（制造商）创建了一个名为 PD Comms 的工具，它可以做到这一点并且效果很好，但是对于最终用户来说太复杂了。我的界面将有一个按钮，可将所有必要的电源/音量/输入选择命令发送到所有电视。

我遇到的问题是让电视接受我的数据流。我认为问题与我如何将数据发送到面板有关。作为一项试验，我一直在对四台电视中的一台进行简单的开机命令。我的应用程序在连接到网络时成功打开了网络流，因此我输入的 IP 地址/端口没有问题。我发送此命令的代码如下。

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
Dim client As New TcpClient("10.71.208.61", 7142)
Dim dataStream As NetworkStream = client.GetStream()
Dim commandData() As Byte = {1, 30, 41, 30, 41, 30, 43, 2, 43, 32, 30, 33, 44, 36, 30, 30, 30, 31, 3, 73, 0D}
dataStream.Write(commandData, 0, commandData.Length)
client.Close()
End Sub 
```

我相信我将数据分配给 commandData 字节数组的行不正确。该命令通过没有任何错误并与面板建立连接。似乎它正在成功发送代码，但电视根本没有响应（打开），这表明我发送的数据格式不正确。我使用的字节数据是 NEC 的 PD Comms Tool 的直接输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T05:56:55.270

使用[Wireshark](http://www.wireshark.org)之类的工具来检查和比较 NEC 工具发送的 TCP/UDP 数据包以及您的代码发送的数据包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-28T04:49:53.767

万一这个问题抓住了其他人......这只是我表示数据类型的方式。正确的格式是：

```
Dim commandData() As Byte = {&H30, &H30, "&H5F", &H64, &H31, "&H0D"} 
```

# java - Cant Draw Rectangle

> ID：15753776
> 
> 赞同：0
> 
> 时间：2013-04-01T23:44:36.527
> 
> 标签：java, swing, graphics, jpanel, rectangles

I am trying to just make a simple game, but for the game to work I need to be able to draw a rectangle. I added the paint method and told it to draw a rectangle and it didnt work. can someone please fix my code or tell me why a rectangle isn't being drawn?

```
import java.awt.Graphics;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Graphic extends JPanel{

JFrame f = new JFrame("lol");
JPanel p = new JPanel(new GridBagLayout());

public Graphic(){

        f.setVisible(true);
        f.setSize(1600,900);
        //above decides if the frame is visible and the size of it
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //above makes the Jpanel which is in the frame
        JButton b1 = new JButton("Play");
        JButton b2 = new JButton("Stop");
        //above makes a button

        GridBagConstraints c = new GridBagConstraints();

        c.insets = new Insets(10,10,10,10);
        c.gridx = 0;
        c.gridy = 1;

        p.add(b1,c);
        //c.gridx = 0;
        //c.gridy = 2;
        p.add(b2);

        f.add(p);
}
public void paint(Graphics g){
    g.drawRect(100,100,100,100);
}

public static void main(String args[]) {
    Graphic G = new Graphic();
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:49:19.710

You never actually *add* the panel to your `JFrame`. Replace:

```
f.add(p); 
```

with

```
f.add(p, BorderLayout.NORTH);
f.add(this); 
```

Obviously, this will displace the `JPanel` `p` in the `BorderLayout.CENTER` position, so you need to decide where this be now located. You could add it up *NORTH* as shown.

* * *

Also you should override `paintComponent` rather than `paint`, while remembering to call `super.paintComponent(g)`.

See: [Custom Painting](http://docs.oracle.com/javase/tutorial/uiswing/painting/)

# javascript - 在函数结束之前阻止 JS 代码运行

> ID：15753782
> 
> 赞同：0
> 
> 时间：2013-04-01T23:45:01.467
> 
> 标签：javascript, jquery

我不能把头绕在这个上面吗？
**为什么这是我的：**
.each 循环会一直运行，即使我在每个循环中将事情拖延 1000 毫秒？
**问题**是 window.location.href 命令在 setTimeout**完成之前运行****到 EARLY**吗？也提前结束的 stopload() 函数也是如此？我已经看到一些关于递归 setTimeout 函数的内容是这里需要什么以及如何实现它？

 **```
function shop(clickedButton)
{
  var buttonvalue = $(clickedButton).val();
  startLoad();
  pdel = 1000;

  $("input:submit[value='buy']").each(function(index)
  {
    if(index != 1)
    {

       $("#backgroundPopup").text(index);
       var submithing = this;  
       setTimeout(function(){ clicksubmitbutton(submithing); },pdel);
       pdel += 1000;
    }                      
  });   

  stopLoad();

  if(buttonvalue == "1")
  {
     window.scrollTo(0,0);
  }
  else
  {
     window.location.href = 'http://my.url';
  } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T23:53:22.210

Javascript 没有休眠或停顿的概念。在调用之后继续执行`setTimeout`。这个函数只是安排一个函数在给定的毫秒数之后运行。

为了获得您想要的行为，您需要在`setTimeout`回调函数中调用下一次迭代。

就像是：

```
function submitTheThing(index) {
    if (done) { //some logic
        return;
    }

    // do something

    setTimeout(function() { submitTheThing(index+1); }, 1000);
} 
```**

# matlab - MATLAB 从矩阵中删除 NaN 值并将值左移

> ID：15753786
> 
> 赞同：2
> 
> 时间：2013-04-01T23:45:30.570
> 
> 标签：matlab

我正在尝试计算以下矩阵中的列差异：

```
A = 
     0       NaN       NaN    0.3750       NaN
     NaN    0.1250    0.2500  0.3750       NaN 
```

我想获得：

```
0.3750 NaN    NaN
0.1250 0.1250 0.1250 
```

我本质上是按列进行差异，跳过 NaN 值并将值向左移动。

一维情况是：

```
A = [0 NaN 0.250 0.375 NaN 0.625];
NaN_diff(A) = [0.250 0.125 0.250]; 
```

有什么方法可以在 MATLAB 中有效地做到这一点，而无需每行使用低效的 find() 查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:56:33.283

这是一个矢量化大多数操作的解决方案：

```
notNan = ~isnan(A);
numNN  = sum(notNan,2);

shifted = NaN(size(A));

for r = 1:size(A,1)
   myRow = A(r,:);
   shifted(r,1:numNN(r)) = myRow(notNan(r,:));
end

nanDiff = diff(shifted,1,2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T00:46:23.803

这是另一种矢量化解决方案：

```
%// Convert to cell array without NaNs
[rows, cols] = size(A);
C = cellfun(@(x)x(~isnan(x)), mat2cell(A, ones(1, rows), cols), 'Uniform', 0);

%// Compute diff for each row and pad
N = max(sum(~isnan(A), 2));
C = cellfun(@(x)[diff(x) nan(1, N - length(x))], C, 'Uniform', 0);

%// Convert back to a matrix
nandiff = vertcat(C{:}); 
```

如果您想用零而不是`NaN`值填充结果矩阵，请将`nan`函数调用更改`nan(1, N - length(x))`为`zeros`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T16:04:52.280

这是一种替代方法，它确实需要您遍历每一行，但仍应具有不错的性能并且对我来说感觉非常直观。

```
B = NaN(size(A,1),size(A,2)-1)

for i = 1:size(A,1)
   idx = ~isnan(A(:,i))
   B(i,1:sum(idx)) = diff(A(i,idx))
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-09T09:31:59.533

我知道这是一个相当古老的问题，但是对于像我这样偶然进入此页面的人来说，这里有一个更简单（恕我直言）的问题解决方案：

```
A = [0 NaN 0.250 0.375 NaN 0.625];
A(isnan(A))=[]; % identify index of NaN values and remove them from the array
B = diff(A); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-01T16:34:03.730

这是另一个不使用循环的简单解决方案[但假设所有值都按升序排列]：

```
A=[0       NaN       NaN    0.3750       NaN;NaN    0.1250    0.2500  0.3750       NaN]
A(isnan(A(:,1)))=0;
B=sort(A,2);
C=diff(B,1,2) 
```

# python - 如何将空格键键绑定到tkinter（python）中的某个方法

> ID：15753793
> 
> 赞同：11
> 
> 时间：2013-04-01T23:45:51.993
> 
> 标签：python, methods, python-2.7, tkinter, python-imaging-library

我正在用 python 做一个项目，我做了一个方法来在 tkinter 中绘制一个特定的东西。我想要它，这样每当我按下空格键时，图像就会自行重绘（再次运行该方法，因为我对该方法进行了编码，以便它可以重绘自身）。如果我按下空格键，我将如何将空格键绑定到方法，以便程序运行、绘制和重新绘制？

例如，我想要它，以便每当我按空格键时，程序都会在画布上的随机位置绘制：

```
from Tkinter import *
from random import *

root=Tk()
canvas=Canvas(root,width=400,height=300,bg='white')
def draw():
    canvas.delete(ALL)# clear canvas first
    canvas.create_oval(randint(0,399),randint(0,299),15,15,fill='red')
draw()
canvas.pack()
root.mainloop() 
```

我如何将空格键绑定到方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-02T00:10:17.653

```
from Tkinter import *
from random import *

root=Tk()
canvas=Canvas(root,width=400,height=300,bg='white')
def draw(event=None):
    canvas.delete(ALL)# clear canvas first
    canvas.create_oval(randint(0,399),randint(0,299),15,15,fill='red')
draw()
canvas.pack()

root.bind("<space>", draw)
root.mainloop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:08:46.737

你可以这样做：

```
from Tkinter import *
from random import *

root=Tk()
canvas=Canvas(root,width=400,height=300,bg='white')

def draw(event):
    if event.char == ' ':
        canvas.delete(ALL)# clear canvas first
        canvas.create_oval(randint(0,399),randint(0,299),15,15,fill='red')

root.bind('<Key>', draw)

canvas.pack()
root.mainloop() 
```

基本上，您将绘图函数绑定到某个顶级元素，该`<Key>`绑定在按下键盘上的键时触发。然后，传入的事件对象有一个`char`成员，该成员包含一个字符串，表示在键盘上按下的键。

只有当它绑定的对象具有焦点时才会触发该事件，这就是我将`draw`方法绑定到`root`对象的原因，因为它始终是焦点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-27T14:41:35.353

您也可以使用`canvas.bind_all("<space>", yourFunction)` That 将监听整个应用程序中的事件，而不仅仅是小部件。

# python - (Python) If I have a point (0,0), how can I change the x value of that point by a given number

> ID：15753795
> 
> 赞同：0
> 
> 时间：2013-04-01T23:46:02.393
> 
> 标签：python

I have a point (0,0), and I want to increase the x coordinate of that point by a value that a user will specify.

```
def change_coordinates():
    origin = (0,0)
    x = input("By how much do you want to increase the x value?")
    # here I need a code that would change origin from (0,0) to (0+x,0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:53:10.773

如果您使用 python 2.7.3 或以下版本：

```
origin = (origin[0] + x, origin[1]) 
```

如果您的 python 版本大于 3：

```
origin = (origin[0] + int(x), origin[1]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:53:26.490

```
position = (1, 2)
x, y = position
position = (x + 3, y)
# now position is (4, 2) 
```

# sql - syntax error SQL Access Nested IIF ISNULL statements

> ID：15753797
> 
> 赞同：0
> 
> 时间：2013-04-01T23:46:23.223
> 
> 标签：sql, ms-access, syntax-error, isnull, iif-function

I'm getting a syntax error, I've changed it multiple times, re-typed it and tried to draw a map even. Now after my head is about to expload, out of desperation I'm turning to someone who has an eye for this.

I might be pushing it trying to grab distinct counts of the iif statements, but probably this question is less technical and more about having an eye...

I don't get problems with the FROM/WHERE clauses but they are provided for additional reference.

Please help me if I'm doing something totally wrong:

```
(SELECT DISTINCT(COUNT(IIF(ISNULL(CombineTables.[Product Description]),

IIF(ISNULL(CombineTables.[Product Number (OEM)]),

IIF(ISNULL(CombineTables.[Product Number (under supplier PA)],"Incomplete Data",CombineTables.[Product Number (under supplier PA)])),

CombineTables.[Product Number (OEM)]),

CombineTables.[Product Description])))
FROM CombineTables WHERE [PA#]=Forms!PADiagnosticsForm!Combo2 AND "QTR." & " " & CombineTables.Quarter & "-" & CombineTables.Year=Forms!PADiagnosticsForm!List68)

FROM CombineTables
WHERE CombineTables.[Price Agreement Price]*CombineTables.Quantity-CombineTables.[Total Extended Price]<>0 And CombineTables.[PA#]=Forms!PADiagnosticsForm!Combo2 And "QTR." & " " & CombineTables.Quarter & "-" & CombineTables.Year=Forms!PADiagnosticsForm!List68; 
```

I thank you in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T01:45:56.677

您的查询有几个问题：

1.  它是不完整的。第`(`一个之前的第一个`SELECT`使它成为第二个之前的表达式`FROM CombineTables`。因此它缺少一个领先的`SELECT`. 如果这不是您的完整查询，那么它对试图帮助您的人没有帮助。
2.  `NZ(A,B) is identical to and more concise than`IIF（ISNULL（A，B，A））`
3.  您的 SELECT`COUNT`模式是可疑的，尤其是对于所有`IIF(ISNULL`s。因为实际上，被-ed 的内容永远不会为 NULL，所以您不妨重写as`COUNT`中的整个块。 与 SUM 不同的是，它不关心被计算的实际值，它只关心值是否为 NULL（计为 0，任何非 NULL 都计为 1）。`COUNT``COUNT(1)``COUNT`

# c++ - 类的重载 = 运算符，其行为类似于矩阵

> ID：15753800
> 
> 赞同：1
> 
> 时间：2013-04-01T23:46:56.273
> 
> 标签：c++, operator-overloading, overloading

我有一个类的模板，其行为类似于矩阵。所以用例是这样的：

```
Matrix matrix(10,10);
matrix[0][0]=4;
//set the values for the rest of the matrix
cout<<matrix[1][2]<<endl; 
```

当我直接在构造函数中设置值时，效果很好，但是当我想使用时，`matrix[x][y]=z;`我得到`error: lvalue required as left operand of assignment`. 我假设，我必须重载`=`运算符。尽管如此，我整个晚上都尝试了，但我没有找到如何实现它。有人会这么好心并告诉我如何`=`为我的代码重载运算符，使其为该矩阵分配值吗？

代码：

```
#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <cstring>
#include <sstream>

using namespace std;

class Matrix {
public:

    Matrix(int x,int y) {
        _arrayofarrays = new int*[x];
        for (int i = 0; i < x; ++i)
            _arrayofarrays[i] = new int[y];

        // works here
        _arrayofarrays[3][4] = 5;
    }

    class Proxy {
    public:

        Proxy(int* _array) : _array(_array) {
        }

        int operator[](int index) {
            return _array[index];
        }
    private:
        int* _array;
    };

    Proxy operator[](int index) {
        return Proxy(_arrayofarrays[index]);
    }

private:
    int** _arrayofarrays;
};

int main() {
    Matrix matrix(5,5);

    // doesn't work :-S
    // matrix[2][1]=0;

    cout << matrix[3][4] << endl;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T23:51:42.000

如果你打算修改代理引用的矩阵的元素，那么类`operator[]`中的重载`Proxy`必须返回一个引用：

```
int& operator[](int index) 
```

此时，您返回`int`，它会复制元素的值——不是您想要的。也应该有一个`const`重载，所以它`operator[]`适用于`const`矩阵。这个可以按值返回：

```
int operator[](int index) const 
```

实际上，它`size_t`比索引更适合`int`，因为它是无符号类型。您没有为负索引赋予任何特定含义，因此禁止它们是有意义的。

除非您想一次分配一整行`operator=`，否则您不需要重载。`Proxy`事实上，你根本不需要这个`Proxy`类，因为你可以直接返回一个指向行数组的指针。然而，如果你想改变你的设计——例如，使用稀疏或打包的表示——那么`Proxy`你可以保留`m[i][j]`接口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T23:53:32.430

问题是您在 proxy::operator[] 中返回一个 int 值。您的第一个 [] 运算符返回代理对象，第二个返回一个 int。如果您的代理 [] 运算符要返回一个 int 引用，那么您将能够分配给它：

```
int& operator[](int index) {
    return _array[index];
} 
```

# .net - How do i pre-process the http request before creating the controller?

> ID：15753803
> 
> 赞同：0
> 
> 时间：2013-04-01T23:47:30.390
> 
> 标签：.net, asp.net-mvc-4

In WebAPI, when I wanted to do some work with the http request before the controller was called, all I did was create a DelegatingHandler and did my pre and post controller operations in there, then register in the WebApiConfig. It would appear that this is not the same with internet applications.

I'm having a hard time finding where to intercept the request, where can I do this?

# php - Saving information to mysql in multiple tables

> ID：15753804
> 
> 赞同：0
> 
> 时间：2013-04-01T23:47:37.447
> 
> 标签：php, phpmyadmin

I am trying to get information to be saved in one database into 5 tables from user input. There are no errors that pop-up but the data won't save to the DB. Any sample code or typed solutions would be great. Thanks.

Here is my code so far: The arrays are defined on a different page.

```
$array = array("example");
$random = $array;
shuffle($random); 
```

HTML:

```
<tr>
<form action="Voting_action.php" method="post">
<td><input type="image" value="<?php echo $img;?>" /> 
<input type="submit"class="buttontable1" value="<?php echo array_pop($random);?>" name="name"/></td>
<td><input type="image" value="<?php echo $img;?>" />
<input type="submit" class="buttontable2" value="<?php echo array_pop($random2);?>" name="name2" /></td>
</form>
</tr>

<tr>
<form action="Voting_action.php" method="post">
<td><input type="image" value="<?php echo $img;?>" />
<input type="submit" class="buttontable1" value="<?php echo array_pop($random3);?>" name="name3"/></td>
<td><input type="image" value="<?php echo $img;?>" />
<input type="submit" class="buttontable2" value="<?php echo array_pop($random4);?>" name="name4" /></td>
</form>
</tr>

<tr>
<form action="Voting_action.php" method="post">
<td><input type="image" value="<?php echo $img;?>" />
<input type="submit" class="buttontable1" value="<?php echo array_pop($random);?>" name="name"/></td>
<td><input type="image" value="<?php echo $img;?>" />
<input type="submit" class="buttontable2" value="<?php echo array_pop($random5);?>" name="name5" /></td>
</form>
</tr> 
```

Here's the PHP mysqli code I have so far with some help from other tutorials and forums:

```
<?php
include('Voting.php');
$server = '';
$dbname= '';
$username = '';
$password = '';

$link = new mysqli($server, $username, $password, $dbname);

if (mysqli_connect_error()) {
header('Location: /errordocs/500.php');
exit;
}

$link->autocommit(FALSE);

$sql = "INSERT INTO table (name) VALUES (?)";

if ($stmt = $link->prepare($sql)) {
  $stmt->bind_param("sssss", $array);
  $stmt->execute();

$firstinsert = $stmt->affected_rows;
 }
$stmt->close;

$newid = $link->insert_id;

$sql = "INSERT INTO table(name2) VALUES (?)";

if ($stmt = $link->prepare($sql)) {
  $stmt->bind_param("ssi", $array2);
  $stmt->execute();

$secondinsert = $stmt->affected_rows;
 }
$stmt->close;

$newid = $link->insert_id;

$sql = "INSERT INTO table(name3) VALUES (?)";

if ($stmt = $link->prepare($sql)) {
  $stmt->bind_param("ssi", $array3);
  $stmt->execute();

$thirdinsert = $stmt->affected_rows;
 }
$stmt->close;

$newid = $link->insert_id;

$sql = "INSERT INTO table(name4) VALUES (?)";

if ($stmt = $link->prepare($sql)) {
  $stmt->bind_param("ssi", $array4);
  $stmt->execute();

$fourthinsert = $stmt->affected_rows;
 }
$stmt->close;

$newid = $link->insert_id;

$sql = "INSERT INTO table(name5) VALUES (?)";

if ($stmt = $link->prepare($sql)) {
  $stmt->bind_param("ssi", $array5);
  $stmt->execute();

$fifthinsert = $stmt->affected_rows;
 }
$stmt->close;

if (($firstinsert == 1) && ($secondinsert == 1) && ($thirdinsert == 1) && ($fourthinsert == 1) && ($fifthinsert == 1)) {

$link->commit();
$link->autocommit(TRUE);
  return 1;
 } else {
$link->rollback();
$link->autocommit(TRUE);
  return 0;
 }
?> 
```

Thank in advance!

# c# - 为什么此函数失败并显示“解析查询时出错。[令牌行号，令牌行偏移量，，令牌错误，，]”？

> ID：15753812
> 
> 赞同：-1
> 
> 时间：2013-04-01T23:48:26.827
> 
> 标签：c#, sql, compact-framework, sql-server-ce, .net-1.0

这段代码：

```
public bool IsValidColumn(string tableName, string columnName)
{
    //return true;// <-- when I uncomment this, I don't get the err msg (but I don't know whether it's a valid column or not, either)
    bool validColumn = false;
    string tblQuery = "SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @tableName AND COLUMN_NAME = @columnName";
    checkConnection();
    try
    {
        SqlCeCommand cmd = objCon.CreateCommand();
        cmd.CommandText = tblQuery;
        SqlCeParameter tblNameParam = new SqlCeParameter("@tableName", SqlDbType.NVarChar, 128);
        tblNameParam.Value = tableName;
        cmd.Parameters.Add(tblNameParam);
        SqlCeParameter colNameParam = new SqlCeParameter("@columnName", SqlDbType.NVarChar, 128);
        colNameParam.Value = tableName;
        cmd.Parameters.Add(colNameParam);
        //int i = (int)cmd.ExecuteScalar();
        int i = 0;
        object obj = cmd.ExecuteScalar();
        if ((obj != null) && (obj != DBNull.Value)) 
        {
            i = Int32.Parse(obj.ToString());
            validColumn = i > 0;
        } 
        else 
        {
            MessageBox.Show("NULL returned from ExecuteScalar. Remove this line.");
        }
    }
    catch (SqlCeException sqlceex)
    {
        return false; 
    }
    catch (Exception ex)
    {
        return false;
    }
    return validColumn;
} 
```

...改编自/基于此处较早的答案：[如何使用 C# 确定 SQL Server CE 表中是否存在列？](https://stackoverflow.com/questions/15693639/how-can-i-determine-whether-a-column-exists-in-a-sql-server-ce-table-with-c)

然而，它导致我得到，“解析查询时出错。[令牌行号，令牌行偏移，，令牌错误，，]”（我在这里抱怨：[为什么解析这个 DDL 时出错，为什么引擎不能更具体地定位它？](https://stackoverflow.com/questions/15707487/why-is-there-an-err-parsing-this-ddl-and-why-cant-the-engine-be-more-specific)这里：

[SQL Server CE 的 DDL 解析器非常挑剔，但对它发现的问题保密](https://stackoverflow.com/questions/15713194/sql-server-ces-ddl-parser-is-very-picky-but-secretive-about-what-it-is-finding)）。

在我试图查明导致这个错误消息的原因时，我实际上已经相当多地重构了遗留代码（从冰箱里扔了很多腐臭的意大利面），所以这并没有浪费时间，但现在我发现导致错误消息的原因是上面代码中的内容。所以问题是：如何*在*不生成此错误消息的情况下确定列是否有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T18:12:22.613

从您的评论中，我看到了这条消息：

> SQL Server CE 不支持并行事务。

我猜您的代码在您进行交易时正在调用此检查。您可能需要与交易分开进行错误检查。

我使用了一段时间的事务，然后意识到它们并不是真正需要对数据库进行简单的读/写操作......因为我没有与银行机构打交道。我敢打赌，删除您的交易报表是安全的，但这只是旁注。

我注意到你的很多代码都使用了这些专门的语句：

*   `checkConnection()`,
*   `objCon.CreateCommand()`和
*   `isValidField`.

这些真的对你有帮助吗？

你在多少地方调用这些例程？

该错误消息听起来好像您在调用之前已经在代码中的其他位置启动了另一个事务`IsValidColumn`。

也许您可以修改代码以`IsValidColumn`尽早检查（例如程序启动时），以便您在开始交易之前就已经知道该列是有效的。

# java - Java 中的持久性

> ID：15753813
> 
> 赞同：-5
> 
> 时间：2013-04-01T23:48:34.253
> 
> 标签：java, android, persistent

如何在 Java 中使用持久性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:32:37.097

如果您将其存储`item.getItemId()`在`onOptionsItemSelected`SharedPreferences 中，然后将`switch`块移动到一个新函数中，这样`onCreate`您就可以调用该新函数来恢复选择：

```
public void onCreate(Bundle savedInstanceState) {
    SharedPreferences prefs = getSharedPreferences("prefName", 0);
    int thicknessId = prefs.getInt("thicknessFieldName", 1); // Replace 1 with first-load state
    switchScribbleView(thicknessId);

    int colorId = prefs.getInt("colorFieldName", 4); // Replace 4 with first-load state
    switchScribbleView(colorId);

    //... rest of code
}

public boolean onOptionsItemSelected(MenuItem item) {
    int menuId = item.getItemId();

    //Get old values so they persist
    SharedPreferences prefs = getSharedPreferences("prefName", 0);
    int thicknessId = prefs.getInt("thicknessFieldName", 0);
    int colorId = prefs.getInt("colorFieldName", 0);

    if (menuId <= 2) // Control Thick and Thin
        thicknessId = menuId;
    else if (menuId >= 4) // Control Color
        colorId = menuId;

    Editor editor = getSharedPreferences("prefName", 0).edit();
    editor.putInt("thicknessFieldName", thicknessId);
    editor.putInt("colorFieldName", colorId);
    editor.commit();

    switchScribbleView(item.getItemId();
    return true;
}

private void switchScribbleView(int menuId) {
    switch (menuId) {
        //... switch block here
    }
} 
```

# php - 带有来自 MySQL 数据库的重复事件的 PHP 日历

> ID：15753827
> 
> 赞同：11
> 
> 时间：2013-04-01T23:50:00.007
> 
> 标签：php, mysql

**更新：** 以下是我原来的问题。请参阅我的答案以了解我是如何解决的。

* * *

我正在尝试使用 MySQL 数据库表“churchcal_events”中的事件填充我的日历。我可能有特定日期的一次性事件和可以设置为每周一、每隔一个周四或每个月的第二个周五的重复事件。

一次性事件没有问题。每周的活动都有效（每周，每隔一周）。但是**每个月的事件仅在第一个月显示，而不是在接下来的几个月中显示**。

**Churchcal_events 表**- 排除对此问题不重要的字段

```
+----+----------------+------------+-----------+------------+------------+
| id | name           | recurring  | frequency | recur_type | recur_day  |
+----+----------------+------------+-----------+------------+------------+
| 1  | Test Weekly    | 1          | 1         | W          | Sunday     |
| 2  | Test Bi-Weekly | 1          | 2         | W          | Monday     |
| 3  | Test Monthly   | 1          | 1         | M          | Friday     |
+----+----------------+------------+-----------+------------+------------+ 
```

**php 代码**- 在每个月的每一天的循环内

```
//query all events
    $get_events = db_query("SELECT * FROM {churchcal_events}
    WHERE (MONTH(date) = :month AND YEAR(date) = :year AND DAY(date) = :day) OR
    (recurring = :recur AND recur_day LIKE :calendar_day)
    ORDER BY starttime",
    array(
      ':month' => $month,
      ':year' => $year,
      ':day' => $list_day,
      ':recur' => '1',
      ':calendar_day' => '%' . date('l', strtotime($month . '/' . $list_day . '/' . $year)) . '%',
    ));

    foreach($get_events as $event) {

      //see if events belong to this calendar
      $calendar_assign = db_query("SELECT * FROM {churchcal_assign} WHERE event_id = :event_id AND calendar_id = :cal_id",
      array(
        ':event_id' => $event->id,
        ':cal_id' => $cal_id,
      ));

      if($calendar_assign->rowCount() > 0) {

        //if recurring, see if event should be on this day
        if($event->recurring == '1') {

          $recur_day = $event->recur_day;
          $recur_freq = $event->frequency;
          $recur_type = $event->recur_type;

          $recur_start = new DateTime(date('Y-m-d', strtotime($event->recur_start)));
          $recur_end = new DateTime(date('Y-m-d', strtotime($event->recur_end)));

          $recur_start->modify($recur_day);

          $recur_interval = new DateInterval("P{$recur_freq}{$recur_type}");
          $recur_period = new DatePeriod($recur_start, $recur_interval, $recur_end);

          foreach($recur_period as $recur_date) {

            if($recur_date->format('Ymd') == date('Ymd', strtotime($month . '/' . $list_day . '/' . $year))) {

              $calendar .= calendar_event($event-id, $event->name, $event->starttime);

            }

          }

        } 
```

**如何使示例 Churchcal_events 表中的 ID“3”显示在每个月的第一个星期五？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-02T07:19:53.377

如果有人想做类似的事情，我将发布我在过去五个小时内编写和测试的代码。

我决定将我的两个表转换为三个，将所有重复选项移至第三个表：

**'churchcal_events'** - 我没有在此处包含活动信息的其他字段

```
+----+-----------+------------+------------+------------+-----------+
| id | name      | date       | starttime  | endtime    | recurring |
+----+-----------+------------+------------+------------+-----------+
| 1  | Event 1   | 2013-04-01 | 10:30:00   | 12:00:00   | 0         |
| 2  | Event 2   |            | 14:00:00   | 15:00:00   | 1         |
| 3  | Event 3   |            | 09:00:00   |            | 1         |
| 4  | Event 4   |            | 19:00:00   | 21:00:00   | 1         |
+----+-----------+------------+------------+------------+-----------+ 
```

**'churchcal_assign'** - 将事件路由到适当的日历（因为整个网站都会有不同部门的日历）

```
+----------+-------------+
| event_id | calendar_id | 
+----------+-------------+
| 1        | 1           |
| 2        | 1           |
| 3        | 1           |
| 4        | 1           |
+----------+-------------+ 
```

**'churchcal_recur_events'** - 以下是每个事件重复发生的规则

```
+----------+-----------+------------+----------------+------------+-------------+-----------+
| event_id | frequency | recur_type | recur_day_num  | recur_day  | recur_start | recur_end |
+----------+-----------+------------+----------------+------------+-------------+-----------+
| 2        | 1         | Week       | NULL           | Sunday     | NULL        | NULL      |
| 3        | 2         | Week       | NULL           | Wednesday  | 2013-04-01  | NULL      |
| 4        | 2         | Month      | third          | Friday     | 2013-04-01  | NULL      |
+----------+-----------+------------+----------------+------------+-------------+-----------+ 
```

**新代码 (PHP)** - 这是一天循环

```
 //query all events
    $get_events = db_query("SELECT * FROM {churchcal_events ce, churchcal_recur_events cre}
    WHERE (MONTH(ce.date) = :month AND YEAR(ce.date) = :year AND DAY(ce.date) = :day) OR
    (ce.id = cre.event_id AND ce.recurring = :recur AND cre.recur_day = :calendar_day)
    ORDER BY starttime",
    array(
      ':month' => $month,
      ':year' => $year,
      ':day' => $list_day,
      ':recur' => '1',
      ':calendar_day' => date('l', strtotime($month . '/' . $list_day . '/' . $year)),
    ));

    foreach($get_events as $event) {

      //see if events belong to this calendar
      $calendar_assign = db_query("SELECT * FROM {churchcal_assign} WHERE event_id = :event_id AND calendar_id = :cal_id",
      array(
        ':event_id' => $event->id,
        ':cal_id' => $cal_id,
      ));

      if($calendar_assign->rowCount() > 0) {

        //one-time events
        if(($event->recurring != '1') && ($single_event_id != $event->id)) {
          $calendar .= calendar_event($event->id, $event->name, $event->starttime);
          $single_event_id = $event->id;
          //$calendar .= $single_event_id;
        }

          //monthly recurring events
          if(($event->recur_type == 'Month') && ($event->recurring == '1')
          //day is on or before end date
          && (($event->recur_end >= date('Y-m-d', strtotime($month . '/' . $list_day . '/' . $year))) || ($event->recur_end == '0000-00-00') || ($event->recur_end == NULL))
          //day is on or after start date
          && (($event->recur_start <= date('Y-m-d', strtotime($month . '/' . $list_day . '/' . $year))) || ($event->recur_start == '0000-00-00') || ($event->recur_start == NULL))
          //day is equal to date of recurrence, i.e. first friday, third monday, etc
          && ($year . date('m', strtotime($year . '/' . $month . '/' . $list_day)) . $list_day == date('Ymj', strtotime($event->recur_day_num . ' ' . $event->recur_day . ' of ' . date('F', strtotime($month . '/' . $list_day . '/' . $year)) . ' ' . $year)))
          //day is in agreement with month frequency, i.e. every month, every other, etc. from start date
          && ($month % $event->frequency == date('m', strtotime($event->recur_start)) % $event->frequency)) {
            $calendar .= calendar_event($event->id, $event->name, $event->starttime);
          }

          //weekly recurring events
          if(($event->recur_type == 'Week') && ($event->recurring == '1')
          //day is on or before end date
          && (($event->recur_end >= date('Y-m-d', strtotime($month . '/' . $list_day . '/' . $year))) || ($event->recur_end == '0000-00-00') || ($event->recur_end == NULL))
          //day is on or after start date
          && (($event->recur_start <= date('Y-m-d', strtotime($month . '/' . $list_day . '/' . $year))) || ($event->recur_start == '0000-00-00') || ($event->recur_start == NULL))
          //day is in agreement with week frequency, i.e. every week, every other, etc. from start date
          && (date('W', strtotime($month . '/' . $list_day . '/' . $year)) % $event->frequency == date('W', strtotime($event->recur_start)) % $event->frequency)) {

            $calendar .= calendar_event($event->id, $event->name, $event->starttime);

          }

      }

    } 
```

如果你不像我一样在 Drupal 模块中创建它，你可以用你自己的数据库查询函数替换 'db_query()'，比如 PHP 的默认 'mysql_query()'；

# python - 没有内置插件的选择排序 Python

> ID：15753828
> 
> 赞同：0
> 
> 时间：2013-04-01T23:50:03.897
> 
> 标签：python, algorithm, sorting, selection

我知道python有一堆内置函数，但我尝试编码选择排序最小化内置函数，因为我试图理解算法。我的输出对于我的选择排序不正确。任何帮助表示赞赏！提前致谢。

```
def selection_sort(list):
    for index in range(0, len(list)):
        for i in range(index,len(list)):
            iSmall = index

            if list[iSmall] > list[i]:
                iSmall = i
        list[index], list[iSmall] = list[iSmall], list[index]
    return list  

if __name__ == '__main__':
    print selection_sort([5,2,4,6,1,3,]) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:57:50.790

`iSmall = index`不合适。我没有提到所有评论者提到的任何事情，这都是真的（截至本次编辑）。所以，你的代码`iSmall = index`在正确的地方：

```
def selection_sort(list):
    for index in range(0, len(list)):
        iSmall = index
        for i in range(index,len(list)):
            if list[iSmall] > list[i]:
                iSmall = i
        list[index], list[iSmall] = list[iSmall], list[index]
    return list  

if __name__ == '__main__':
    print selection_sort([5,2,4,6,1,3,]) 
```

换句话说，您正在寻找最小数字的索引（并尝试将其存储在 中，但您在循环的每次迭代中`iSMall`都重置`iSmall`为。因此设置不正确，它始终设置为，除非在内部循环的最后一次迭代将其更改为其他内容。`index``for i in range(index,len(list)):``iSmall``index`

# visual-studio-2010 - 手动设置下一条语句时未创建 Visual Studio 变量

> ID：15753831
> 
> 赞同：0
> 
> 时间：2013-04-01T23:50:42.413
> 
> 标签：visual-studio-2010, c#-4.0, .net-4.0, visual-studio-debugging

我今天刚开始使用新的 Windows 7 x64 机器，在调试过程中体验了一些新的东西。我有可以被认为如下的代码：

```
if(/*Some criteria that evaluates to false*/)
{
    int weekNum = (int)DateTime.Now.Subtract(_myObject.StartDate).TotalDays/7;

    //Do something with weekNum
} 
```

我想通过 if 块中的代码进行调试。在我目前的情况下，将下一条语句设置为块内的第一行比使我的数据符合条件要容易得多，因此我将下一个执行行设置为 int weekNum ... 这给出了一个空引用异常，因为它，显然，没有实例化 weekNum。我已经验证右侧表达式中没有任何内容为空，并且可以通过将右侧复制并粘贴到监视或即时窗口中来成功获得结果。如果我从字面上用 if(true) 替换它，它就可以正常工作。在这样的场景中选择下一个执行语句对我来说是一种非常常规的调试方式。为什么会这样？

编辑：我已经验证当前的构建配置没有优化。

编辑：我无法在另一个测试项目中重现它。我修改了原始代码以从方程式中删除我的对象，这是在原始项目中获得异常的新完整代码：

```
 private void SelectDefaultLearningUnit()
    {
        TODLogic.LearningUnit currentLu = null;

        //If sce is active get the learning unit for the current week.
        if (!_sce.IsCancelled && !_sce.IsCancelled
            && _sce.StartDate <= DateTime.Now
            && _sce.EndDate > DateTime.Now)
        {
            //Get number of weeks since semester started
            int currentWeek = (int)4;    //THIS LINE STILL BLOWS UP

            //Find the first learning unit for the current week
            currentLu = _LearningUnits.Where(lu => lu.StartWeek <= currentWeek && lu.EndWeek >= currentWeek).FirstOrDefault();  //May be null
        }

        if (currentLu == null)
            currentLu = _LearningUnits.FirstOrDefault();

        cbLearningUnit.SelectedItem = currentLu;
    } 
```

同样，只有当我在 if 块内手动设置执行时才会出现异常，否则它会被跳过。我看到的唯一区别是，如果我在测试项目中对变量进行监视，它会说 currentWeek 的值是 0，直到它到达该行然后它被分配。在它爆炸的项目中，它在当前周的左侧显示一个红色的感叹号，并且值表示''为空。我希望它要么说值为 0，要么说“currentWeek”未定义！这就是为什么我最初认为它认为 currentWeek 是“未实例化”的，即不存在。

# java - 当我处理不同的类时，Java 对象/类型总是给我错误

> ID：15753832
> 
> 赞同：0
> 
> 时间：2013-04-01T23:51:00.777
> 
> 标签：java, class, types

所以我的任务是基本上用java在电脑上创建游戏“Hearts”。

我首先创建了一个对象“卡片”：

*

> 公共类卡{
> 
> ```
>  public enum Suit {
>         CLUBS,
>             HEARTS,
>             SPADES,
>             DIAMONDS
>     }
>     public enum Value {
>         TWO,
>             THREE,
>             FOUR,
>             FIVE,
>             SIX,
>             SEVEN,
>             EIGHT,
>             NINE,
>             TEN,
>             JACK,
>             QUEEN,
>             KING,
>             ACE}
> 
>       private Suit suit;  
>           private Value value; 
> ```
> 
> > public Card(Suit suit, Value value){ suit = getSuit(); 值 = getValue(); } }

但是，每当我尝试在另一个类中使用类型 Suit 或 Value 时，我都会收到错误“无法解析为变量”。所有 .java 文件都在同一个文件夹中，并且我的 Card 类上没有任何错误消息......那我做错了什么？为什么 java 不能识别 Value 和 Suit 类型？

PS：另外一节课是老师给我们的测试课。我不能改变它，因为它是他用来给我们评分的。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:55:27.030

您可以通过在前面添加类名来访问所有内部（静态）类以及枚举：

`Card.Suit`会成功的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T23:53:08.863

试试卡片::西装。我不确定语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T00:29:25.607

在 Card 类之外的单独文件中声明您的 Suit 和 Value 枚举：

在 Suit.java 中：

```
public enum Suit {
    CLUBS,
    HEARTS,
    SPADES,
    DIAMONDS
} 
```

在 Value.java 中：

```
public enum Value {
    TWO,
    THREE,
    FOUR,
    ...
} 
```

然后在 Card.java 中，您的 Card 类将开始如下所示：

```
public class Card {

    Suit suit;
    Value value;

    public Card(Suit suit, Value value)
    { 
        this.suit = suit;
        this.value = value;
    } 
} 
```

# javascript - OO Javascript：原型的使用和调用

> ID：15753833
> 
> 赞同：0
> 
> 时间：2013-04-01T23:51:12.013
> 
> 标签：javascript, oop, call, prototype

我有这个代码：

```
function Stickman() {
    //some methods and properties

}

function JuniorStickman() {
    Stickman.call(this);
    this.p = new value // override a property in Stickman

}
JuniorStickman.prototype = new Stickman();

junior = new JuniorStickman(); 
```

我从 MDN 的一个示例中改编了这段代码：[https ://developer.mozilla.org/en-US/docs/JavaScript/Introduction_to_Object-Oriented_JavaScript](https://developer.mozilla.org/en-US/docs/JavaScript/Introduction_to_Object-Oriented_JavaScript)

我不明白的是： call() 和行

```
JuniorStickman.prototype = new Stickman() 
```

似乎做同样的事情。如果我注释掉该行

```
JuniorStickman.prototype = new Stickman(); 
```

我的 JuniorStickman 仍然具有 Stickman 的所有方法和属性；真的; 他的原型属性现在是 JuniorStickman 而不是 Stickman，但这似乎并不重要。

这里如何调用工作以使我的 Junior Stickman（初级）拥有 Stickman 的所有方法，并且原型分配是否必要？

据我了解， call() 并没有真正给我继承权。我只是得到一种 Stickman 的副本，我可以在其中添加/覆盖属性。这个对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T23:56:16.833

> 在这里调用如何使我的初级Stickman拥有Stickman的所有方法

您在代码中的注释似乎表明您在`Stickman`构造函数中设置所有属性（也是方法）。因此，如果您调用`Stickman`并显式设置`this`为新`JuniorStickman`实例 ( )，则分配给内部的`Stickman.call(this);`所有属性都将分配给新实例。`this``Stickman`

[`.call` *^([MDN])*](https://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/Function/call)所做的只是`this`在函数内部设置引用第一个参数。例子：

```
function foo() {
    alert(this.bar);
}

foo.call({bar: 42}); // alerts 42
foo.call({bar: 'baz'}); // alerts baz 
```

那么***为什么***在这里`.call`使用呢？它与在其他语言中调用的作用相同`super()`：它在新的子实例上执行父构造函数。

> 原型分配是否必要

这不是你的情况。但通常你将所有应该*跨实例共享的*属性分配给函数的*原型*，即`Stickman.prototype`. 例如，方法通常分配给原型。只有*特定*于每个实例的属性才应在构造函数中分配。

如果您不进行此分配，则 的实例`JuniorStickman`将没有任何分配给的方法，`Stickman.prototype`因为它不在实例的原型链中。

* * *

FWIW，通过将父级的新实例分配给原型来设置继承不是最佳方式。如果`Stickman`需要*强制*参数怎么办？你会通过哪些？

你现在不想创建一个新的`Stickman`实例，你想要的只是带入`Stickman.prototype`原型链。这可以使用[`Object.create` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)轻松完成：

```
JuniorStickman.prototype = Object.create(Stickman.prototype); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:15:42.870

JavaScript 原型就像子类。但是“子”对象的所有实例都继承了一个父实例。更改的复杂值会针对所有子实例进行更改。

当使用 parent.call(thisContext) 时，使用 this.somevar 在父函数体中声明的父变量将对子实例变得唯一，因为它们被初始化为子的 this 上下文。当你只有 parent.call(this 那么孩子不会是父母的一个实例，所以：

(child instanceof parent) 如果您只使用 parent.call(this

```
function parent(){
  this.arr=[];
  this.name="parent";
}
function child1(){
 parent.call(this);//sets all this elements 
                   //of parent to the current 
                   // instance of child1
}
child1.prototype = new parent();
function child2(){
}
child2.prototype = new parent();
var c1=new child1();
c1.name="c1"
c1.arr.push(["c1"]);
var anotherc1=new child1();
anotherc1.name="another c1";
anotherc1.arr.push("another c1");
var c2 = new child2();
c2.name="c2";
c2.arr.push(["c2"]);
var anotherc2 = new child2();
anotherc2.name="another c2";
anotherc2.arr.push(["another c2"]);
console.log(c1.name,c1.arr);//["c1"]
console.log(anotherc1.name,anotherc1.arr);//["anotherc1"]
console.log(c2.name,c2.arr);//["c2","anotherc2"]
console.log(anotherc2.name,anotherc2.arr);//["c2","anotherc2"]
console.log(c1 instanceof parent);//true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T23:58:10.263

如果您的 Stickman() 构造函数对每个新实例执行不同的操作（假设它将属性设置为等于创建时间），那么您会希望 JuniorStickman() 的每个实例调用 Stickman() 构造函数而不是依赖于您调用 Stickman() 设置原型时存储在原型中的时间戳。

例如：

```
function a() {
    this.time = new Date().getTime();
}

function b() {
    // a.call(this)
    this.hello = "something";
}

b.prototype = new a(); 
```

注释掉该行后，每个新 b() 的时间戳都是相同的，但是如果您取消注释该行，那么它们的行为将与您希望的一样。

# opengl - glSwapBuffers 在哪里定义？

> ID：15753840
> 
> 赞同：3
> 
> 时间：2013-04-01T23:51:50.203
> 
> 标签：opengl

我需要在我的代码中使用 glSwapBuffers，但令我惊讶的是，此方法不在标头 GL/gl.h 中。我需要包含哪个头文件才能使用此方法？不使用它不是一个选项，因为我正在为其他客户端提供一个接口，这是文档化接口的一部分。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-02T00:02:27.147

没有函数“glSwapBuffers”，OpenGL 没有定义它。交换双缓冲窗口的前后缓冲是底层图形系统提供的功能，即Win32 GDI，或X11 GLX。您正在寻找的功能是`wglSwapBuffers`和/或`glXSwapBuffers`. 在 MacOS X 上，NSOpenGLViews 会自动交换。

但是，您很可能正在使用一些框架，例如 GLUT、GLFW 或 Qt，它们提供了围绕这些功能的可移植包装器。阅读框架的文档。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-09-24T15:20:33.223

使用 glSwapAPPLE() 或 aglSwapBuffer()

# java - 为什么原始数组字段会打印出空指针异常？

> ID：15753841
> 
> 赞同：0
> 
> 时间：2013-04-01T23:51:50.593
> 
> 标签：java, nullpointerexception, runtime-error

```
public class Whatever {
    static double d;
    static char c;
    static String[] s;
    static char[] b;
    static double[] dd;
    static Whatever w;
    static Whatever[] ww;

    public static void main(String[] args) {
        System.out.println(Whatever.d); //prints out 0.0
        System.out.println("hi"+Whatever.c+"hi"); //prints out hi hi
        System.out.println(s); //prints out null
        System.out.println(b); //null pointer exception!
        System.out.println(Whatever.dd);
        System.out.println(Whatever.w);
        System.out.println(Whatever.ww);
    }
} 
```

为什么会出现空指针异常？

如果可以的话，请根据记忆进行解释，但是我对记忆有基本的了解，所以也不要太深入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T01:19:08.050

好的，现在您已经发布了完整的代码，它更容易提供帮助！当您使用原始数组调用时，*通常*会发生这种情况：`PrintStream.println`

```
String s = String.valueOf(x); 
```

最终会这样做：

```
return (obj == null) ? "null" : obj.toString(); 
```

如您所见，提供的对象为 null 的可能性已被显式处理。`PrintStream`但是，该类有一个特定的重载，*仅*适用于 char 数组。这是逻辑的粗略跟踪：

```
write(cbuf, 0, cbuf.length); 
```

`cbuf`给定的 char 数组在哪里。正如你所看到的，它试图引用字符数组的长度，如果数组没有被初始化，它将被 NPE 炸毁。这是实施中奇怪且不幸的不一致。

因此，现在您了解NPE 发生的*原因*- 修复它只需在尝试打印之前初始化 char 数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:16:49.927

这里有几个问题：

```
1\. You're not allocating any space for `int x`
2\. If you want to print the contents of `x`, it should be `x.toString()`
3\. What did you expect the output to be from your sample code? 
```

我猜#3 不是你实际使用的，我建议你展示你的真实代码以获得真正的答案:)

希望这可以为您澄清一点。

```
$ cat Whatever.java 
public class Whatever {
    static final int MAX = 5;
    int[] x = new int[MAX]; // allocate array to sizeof '5'

    public Whatever() {
        // do stuff
    }

    public void addStuff() {
        for(int i=0; i<MAX; i++)
            x[i] = i + 2;

    }

    public void printX() {
        for(int i=0; i<MAX; i++)
            System.out.println(i + ": " + x[i]);

    }

    public static void main(String[] args){
        Whatever w = new Whatever();  // new instance of 'Whatever'
        w.addStuff();                 // add some ints to the array
        w.printX();                   // print out the array
        // print the Array 'x'
        System.out.println("Array: " + w.x);
    }
}
$ java Whatever 
0:  2
1:  3
2:  4
3:  5
4:  6
Array: [I@870114c 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T00:51:43.303

问题基本上根源于如何`PrintStream.println(...)`实施。除了`char[]`，原始数组被视为`java.lang.Object`。所以`println`使用的重载是[`println(Object)`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html#println%28java.lang.Object%29). 在下面，打印对象涉及调用对象的`toString()`. 因此，NPE。

如果你想防御空值，你应该考虑使用[`String.valueOf(Object)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#valueOf%28java.lang.Object%29).

# ios - UITableViewController 委托

> ID：15753843
> 
> 赞同：1
> 
> 时间：2013-04-01T23:52:05.257
> 
> 标签：ios, objective-c, xcode

我有一个 UITableViewController 类，我称之为“MasterViewController”。在 MasterViewController 中，我想显示一个使用不同 UITableViewController（不是 MasterViewController）的 tableview。我这样做是因为另一个 tableview 已经使用 MasterViewController 作为它的委托和数据源。

我在 MasterViewController 的方法中有以下逻辑；

```
ToTableViewController *toController = [[ToTableViewController alloc] init];
UIView *toView = [[UIView alloc] initWithFrame:CGRectMake(10,10,250,200)];
//toView.backgroundColor = [UIColor redColor];
UITableView *toTableView = [[UITableView alloc] initWithFrame:CGRectMake(10,10,220,180) style:UITableViewStylePlain];

[toTableView setDelegate:toController];
[toTableView setDataSource:toController];

[toView addSubview:toTableView];

[self.view addSubview:toView];

[toTableView reloadData]; 
```

我希望 ToTableViewController 成为这个新 tableview (toTableView) 的委托和数据源。

问题是我的 ToTableViewController cellForRowAtIndexPath 方法没有被调用。事实上，没有调用任何委托方法。

对于任何反馈，我们都表示感谢。

蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T02:10:48.293

我很确定您的问题是`toController`发布得太早了。使用 ARC（我假设您也是），我按照您的尝试使用它。我得到了相同的结果，委托方法似乎没有被调用。解决的方法是不为`toController`. 而是将其声明为 MasterViewController 类的成员，例如

```
@property (strong, nonatomic) ToTableViewController *toController; 
```

然后在代码中使用变量名`_toController`来引用它。

编辑：为了在我的第一个测试中清楚，我有 ToTableViewController 从 UITableViewController 继承。因为这样我真的不需要添加 UITableView 你正在创建和附加委托（你可以直接使用 _toController.view ）所以在第二个测试中我从头开始创建了一个 ToTableViewController 继承自委托协议，其中单独的UITableView 变得很有必要。只是为了完整起见，这里是有效的代码：

ToTableViewController.h

```
#import <Foundation/Foundation.h>

@interface ToTableViewController : NSObject <UITableViewDelegate, UITableViewDataSource>

@end 
```

ToTableViewController.m

```
#import "ToTableViewController.h"

@implementation ToTableViewController

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 13;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    NSString *str1 = @"Row #";
    cell.textLabel.text = [str1 stringByAppendingFormat:@"%d", indexPath.row+1];

    return cell;
}

@end 
```

MasterViewController.m（我在 .m 文件中声明了 toController ，如图所示，但可以在 .h 文件中这样做......）

```
#import "MasterViewController.h"
#import "ToTableViewController.h"

@interface MasterViewController ()

@property (strong, nonatomic) ToTableViewController *toController;

@end

@implementation MasterViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    _toController = [[ToTableViewController alloc] init];
    UIView *toView = [[UIView alloc] initWithFrame:CGRectMake(10,10,250,200)];
    toView.backgroundColor = [UIColor redColor];

    UITableView *toTableView = [[UITableView alloc] initWithFrame:CGRectMake(10,10,220,180) style:UITableViewStylePlain];

    [toTableView setDelegate:_toController];
    [toTableView setDataSource:_toController];

    [toView addSubview:toTableView];

    [self.view addSubview:toView];
}

@end 
```

# performance - Ads API 城市密钥是静态的吗？

> ID：15753844
> 
> 赞同：1
> 
> 时间：2013-04-01T23:52:07.643
> 
> 标签：performance, facebook-ads-api

我需要查找大量的城市代码，但 Ads API 不太适合这个。（我不能提交大于 50 的批次。如果我查询得太快，它并不总是返回有效的响应。）最好的解决方案可能是缓存结果。

所以，我的问题是，我应该将结果缓存多长时间？关键值是静态的吗？还是在添加新城市时它们偶尔会发生变化？

另外，有没有比缓存更好的方法？

# javascript - 跨域 XHR 工作奇怪

> ID：15753846
> 
> 赞同：0
> 
> 时间：2013-04-01T23:52:36.860
> 
> 标签：javascript, xmlhttprequest, cross-domain, client-side

我遇到了大约一个月都无法解决的问题。您可以在此处查看示例页面：[http ://www.7ya.ru/travel/tours/](http://www.7ya.ru/travel/tours/)

所以，问题是小绿色表单是我们使用跨域 XHR 的小部件，有些人对此有疑问。XHR 请求失败。完全没有要求。检查员只是说“取消”。此问题出现在 OSX 和 Win 上的 FF、Opera 和 Chrome 中。

但！如果您尝试清理缓存（例如在 Chrome 中）：

![chrome私有数据控件中的复选框](https://dl.dropbox.com/u/12269325/cleanup_me.png)

您会看到小部件开始像魅力一样工作。此外，如果您尝试仅清理缓存，它将无法正常工作。

那么，是否有人知道哪些数据可能会影响两个不同平台上大多数浏览器中的 XHR 请求？

**PS**我一直在尝试使用“香草”XHR 和 jQuery 版本，但它的工作原理相同。

**PSS**代码位（CoffeeScript）：

1.  lt_jq - 本地 jQuery 版本 ($.noConflict())
2.  @inspect - JSON.stringify() 带有一些额外的格式化参数

* * *

```
request = lt_jq.ajax({
    url       : method,
    dataType  : "json",
    data      : params,
    xhrFields : withCredentials:true
})

request.done (data)->
    @request_id = (data.request_id || null)
    callback?(data)

request.fail =>
    console.log "Request failed [#{method}], #{@inspect(params)}" 
```

**问题已结束，评论中的详细信息**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T16:39:35.997

您正在使用的网络是否使用缓存代理，或者从它的声音来看，您是否在网络上安装了防病毒软件或某种过滤器来过滤请求？

听起来文件在没有正确标题的情况下被缓存，因此 CORS 标题被切断......

我建议你检查这个最简单的方法：使用铬：

1.  清除缓存，打开开发工具，并在请求运行时观察 **请求**。确保在请求和响应标头中有 CORS 标头。
2.  现在您的缓存中有文件，请重新加载您的页面。检查它是否不起作用。
3.  现在它不起作用，转到 chrome://view-http-cache/ 查看各个缓存条目，并查找该文件的请求。打开它。
4.  检查缓存文件上是否有 CORS 标头。

如果没有...确保代理/防病毒不会切断您网络中的 CORS 标头，或尝试不同的解决方案

# java - 你将如何在 Ruby 中实现这个 Java 枚举类？

> ID：15753847
> 
> 赞同：1
> 
> 时间：2013-04-01T23:52:40.163
> 
> 标签：java, ruby, enums, enumeration

我有来自 Java 类的以下代码：

```
enum TokenType {
  CHR("[a-z]"),
  INTEGER("[0-9]"),
  OP_EQUALS("\\="),
  OP_PLUS  ("\\+"),
  OP_MINUS("\\-"),
  OP_MULTIPLY("\\*"),
  OP_DIVIDE("\\/"),
  OP_LESS("\\<"),
  LOGIC_AND("and"),
  LOGIC_NOT("not"),
  LOGIC_TRUE("true"),
  LOGIC_FALSE("false"),
  PUNCT_LEFTPAREN("\\("),
  PUNCT_RIGHTPAREN("\\)"),
  PUNCT_SEMIC("\\;"),
  EOF("\\#"),
  ;

  private TokenType(String ch) {
    this.tokenClass = ch;
  }
  String tokenClass;

  public static TokenType parse(String in) {
    for (TokenType type : TokenType.values()) {
      if (in.matches(type.tokenClass)) {
        return type;
      }
    }
    return null;
  }

} 
```

作为一个 Ruby 新手，我正在尝试在 Ruby 中实现这一点。越简单越好。我根据此处的一些帖子尝试了以下操作，但似乎无法完成。我希望该类有一个 parse() 方法，该方法将输入字符串与所有枚举选项匹配，如果没有任何模式匹配，则返回 null。这是我到目前为止所尝试的：

```
 class TokenType
  attr_accessor :tokenClass
  def initialize(str)
     @tokenClass = str
  end

    CHR = new("[a-z]")
    INTEGER = new("[0-9]"),
    OP_EQUALS = new("\\="),
    OP_PLUS = new("\\+"),
    OP_MINUS= new("\\-"),
    OP_MULTIPLY= new("\\*"),
    OP_DIVIDE = new("\\/"),
    OP_LESS = new("\\<"),
    LOGIC_AND = new("and"),
    LOGIC_NOT = new("not"),
    LOGIC_TRUE = new("true"),
    LOGIC_FALSE = new("false"),
    PUNCT_LEFTPAREN = new("\\("),
    PUNCT_RIGHTPAREN = new("\\)"),
    PUNCT_SEMIC = new("\\;"),
    EOF= new("\\#"),

    class << self
      private :new
    end   

    def TokenType.parse(str_in)

    end
end 
```

有什么想法或想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T03:48:02.917

您正在尝试使用 ruby​​ 语法编写 java 代码。我会做以下事情：

```
def parse str
  case str
  when 'a'..'z' then CHR
  when 0..9 then INTEGER
  …
  end
end 
```

`case`你可以决定在你的类中定义常量或者做任何你想做的事情，但是匹配是由 ruby​​ 子句的内置设施为你完成的。

# php - 试图删除 sql 中的重复记录，但查询进入无限循环

> ID：15753862
> 
> 赞同：0
> 
> 时间：2013-04-01T23:54:24.500
> 
> 标签：php, mysql, sql

这是我的桌面测试

```
id   identifier
---  ---------
1      zz
1      zzz
3      d 
5      w
7      v
8      q
9      cc
9      ccc 
```

在这里，我想删除重复的 id 并保留最新的 id。标识符可以有重复的值，这无关紧要，但 id 应该是唯一的。

我写了这个查询来解决这个问题，但问题是它进入了一个无限循环。

请帮我解决这个问题，因为我看不到错误。谢谢

```
 delete test
    from test
    inner join(
    select max(id) as lastId, identifier
    from test
    where id in (
              select id 
                from test
               group by id
              having count(*) > 1
       )
    group by id
    )dup on dup.id = test.id
    where test.id<dup.id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:26:30.767

看看[如何用 SQL 删除重复的行？](https://stackoverflow.com/questions/1173963/how-to-delete-duplicate-rows-with-sql)

并尝试这个（适用于您想要做的），我使用标识符列，但使用帖子中显示的日期列更好。

```
DELETE FROM Test WHERE Identifier NOT IN
    (SELECT MAX(Identifier) FROM Test GROUP BY Id); 
```

现在使用 DateField：

```
id   identifier   DateField
---  ---------    ----------
1      zz         2013-02-01
1      zzz        2013-03-02
3      d          2013-03-02
5      w          2013-03-02
7      v          2013-03-02
8      q          2013-03-02
9      cc         2013-01-15
9      ccc        2013-03-02 
```

也就是表，并且行 (1, zzz) 比 (1,zz) 新，你可以通过 DateField 列知道它，然后这个查询删除两行 (1, zz) 和 (9, cc) 最旧的ID 是 1 和 9。

```
DELETE FROM Test WHERE Datefield NOT IN
    (SELECT MAX(Datefield) FROM Test GROUP BY Id); 
```

在 SQL Server 2008 R2 中我没有收到任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T01:13:29.940

如果您在 上有一个索引`test(id, identifier)`，则以下内容应该非常有效：

```
delete from test
    where test.identifer < (select maxid 
                            from (select max(identifier) as maxid from test t2 where t2.id = t.id
                                 ) a
                           ) 
```

双嵌套查询是 MySQL 在同一查询中引用更新/删除表的技巧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T07:36:48.933

CREATE TEMPORARY TABLE tmp_tb_name AS
SELECT id,SUBSTRING_INDEX(GROUP_CONCAT(identifier ORDER BY id DESC),',',1)
FROM tb_name GROUP BY id ORDER BY NULL;

截断表 tb_name;

插入到 tb_name 选择 tmp_tb_name;

如果存在 tmp_tb_name 则删除临时表；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-21T16:14:26.083

**更新** 我找到了解决问题的方法：这就是我解决问题的方法 当表中有数百万个实体时，这是对我有用的解决方案。任何其他 SQL 查询都会创建大量进程并给服务器带来负担。

```
$i=0;
    while($i<10)
    {

        $statement="SELECT * 
                      FROM  test 
                      WHERE  id = :i";
        $query=$db->prepare($statement);
        $query->bindParam(':i',$i,PDO::PARAM_INT);
        $query->execute();
        $results=$query->fetchAll(PDO::FETCH_ASSOC);
        $c=count($results);
        $temp=$results[$c-1];

        $statement="DELETE FROM test WHERE id= :i";
           $query=$db->prepare($statement);
             $query->bindParam(':i',$i,PDO::PARAM_INT);
             $query->execute();

        $statement="Insert into test values(:id,:identifier)";
        $query=$db->prepare($statement);
             $query->bindParam(':id',$temp['id'],PDO::PARAM_INT);
             $query->bindParam(':identifier',$temp['identifier'],PDO::PARAM_STR);
             $query->execute();
             $results=$query->fetchAll(PDO::FETCH_ASSOC);

        $i++;

    } 
```

# c# - 要调用此方法，“Membership.Provider”属性必须是“ExtendedMembershipProvider”的实例

> ID：15753864
> 
> 赞同：39
> 
> 时间：2013-04-01T23:54:43.233
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-membership

目前，每当我尝试使用主机提供商 DiscountASP 上 ASP.Net MVC4 中内置的默认会员服务注册用户或登录时，我都会收到错误消息

> 要调用此方法，“Membership.Provider”属性必须是“ExtendedMembershipProvider”的一个实例。

这不会在本地发生。

这是我的`InitializeSimpleMembershipAttribute.cs`：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = false, Inherited = true)]
public sealed class InitializeSimpleMembershipAttribute : ActionFilterAttribute
{
    private static SimpleMembershipInitializer _initializer;
    private static object _initializerLock = new object();
    private static bool _isInitialized;

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        // Ensure ASP.NET Simple Membership is initialized only once per app start
        LazyInitializer.EnsureInitialized(ref _initializer, ref _isInitialized, ref _initializerLock);
    }

    private abstract class SimpleMembershipInitializer
    {
        protected SimpleMembershipInitializer()
        {
            Database.SetInitializer<UsersContext>(null);

            try
            {
                using (var context = new UsersContext())
                {
                    if (!context.Database.Exists())
                    {
                        // Create the SimpleMembership database without Entity Framework migration schema
                        ((IObjectContextAdapter)context).ObjectContext.CreateDatabase();
                    }
                }

                WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true);
            }
            catch (Exception ex)
            {
                throw new InvalidOperationException("The ASP.NET Simple Membership database could not be initialized. For more information, please see http://go.microsoft.com/fwlink/?LinkId=256588", ex);
            }
        }
    }
} 
```

这是错误的完整屏幕截图：

[![](https://i.stack.imgur.com/dcj35.png)](https://i.stack.imgur.com/dcj35.png)

有谁知道我该如何解决这个问题或知道一篇解决它的文章？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-04-02T01:52:43.733

`web.config`尝试在您的`<system.web>`节点内设置以下内容：

```
 <roleManager enabled="true" defaultProvider="SimpleRoleProvider">
        <providers>
            <clear />
            <add name="SimpleRoleProvider" type="WebMatrix.WebData.SimpleRoleProvider, WebMatrix.WebData" />
        </providers>
    </roleManager>
    <membership defaultProvider="SimpleMembershipProvider">
        <providers>
            <clear />
            <add name="SimpleMembershipProvider" type="WebMatrix.WebData.SimpleMembershipProvider, WebMatrix.WebData" />
        </providers>
    </membership>
    <sessionState mode="InProc" customProvider="DefaultSessionProvider">
        <providers>
            <add name="DefaultSessionProvider" type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" />
        </providers>
    </sessionState> 
```

听起来 SimpleMembership 在您使用时无法识别。

此外，值得一提的是，该[`WebMatrix.webData`](http://www.nuget.org/packages/Microsoft.AspNet.WebPages.WebData)库可以通过 NuGet 安装：

```
PM> Install-Package Microsoft.AspNet.WebPages.WebData 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-07-12T11:34:20.287

尝试更改 AccountController.cs 下的 Login 功能

```
 //
    // POST: /Account/Login

    [AllowAnonymous]
    [HttpPost]
    public ActionResult Login(LoginModel model, string returnUrl)
    {
        if (ModelState.IsValid)
        {
            if (Membership.ValidateUser(model.UserName, model.Password))
            {
                FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                if (Url.IsLocalUrl(returnUrl))
                {
                    return Redirect(returnUrl);
                }
                else
                {
                    return RedirectToAction("Index", "Home");
                }
            }
            else
            {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-22T20:24:26.300

做了上面的步骤，但没有帮助。改变 web.config 有帮助：

```
 <dependentAssembly>
    <assemblyIdentity name="WebMatrix.Data" publicKeyToken="31bf3856ad364e35" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.0.0.0" />
  </dependentAssembly>
          <dependentAssembly>
    <assemblyIdentity name="WebMatrix.WebData" publicKeyToken="31bf3856ad364e35" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.0.0.0" />
  </dependentAssembly> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-24T19:58:55.013

我有同样的错误，但对我来说这是 100% 的参考。我在让 WebMatrix.WebSecurity 工作几次时遇到了麻烦……每次都是因为我没有使用 MVC 4 Internet 模板创建项目。

关键是模板中的引用和配置默认工作，所以只需重新创建您的项目就可以了。

我的解决方法是： 1\. 将我的项目备份到另一个文件夹。2\. 检查所有文件 3\. 创建一个新的 MVC 4 Internet 项目，名称完全相同。4.复制+粘贴（覆盖）原始项目。5\. 添加任何缺失的引用、更改的路由、.config 设置/数据库连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-25T14:24:13.490

我只是解决同样的问题。

我的问题是在更新 nuget 包后开始的。我的 VS 2019 在 web.config 中添加了新行“membership”和“roleManager”，因此它被重复了（就像以前一样）。

我评论了旧值，然后每次注销和登录时都会显示此“membership.provider”警告。

只需使用旧的，因为更适合您的代码。

下面是我删除的 web.config 中生成的代码：

```
<membership defaultProvider="DefaultMembershipProvider">
      <providers>
        <add name="DefaultMembershipProvider" type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
      </providers>
    </membership>
    <roleManager defaultProvider="DefaultRoleProvider">
      <providers>
        <add name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" applicationName="/" />
      </providers>
    </roleManager> 
```

# java - 使用信号量在java中实现循环障碍

> ID：15753869
> 
> 赞同：0
> 
> 时间：2013-04-01T23:55:02.653
> 
> 标签：java, multithreading, semaphore, cyclicbarrier

问题如下，因为仅使用 down() 调用屏障，因此它将等待 n 个线程到达，然后在**关键区域**中一起执行所有 n 个线程，现在我如何通知调用**barrier.down**的线程它现在可以继续前进。我尝试在**phase2(** )之后添加**notifyAll()**但这不起作用。帮助？:)

 **```
public class cyclicBarrier {
    private int n;
    private int count;
    private semaphore mutex;
    private semaphore turnstile;
    private semaphore turnstile2;

    public cyclicBarrier(int n){
        this.n = n;
        this.count = 0;
        this.mutex = new semaphore(1);
        this.turnstile = new semaphore(0);
        this.turnstile2 = new semaphore(0);
    }

    public synchronized void down() throws InterruptedException{
        this.phase1(); //waits for n threads to arrive
        this.phase2(); //waits for n threads to execute
    }

    private synchronized void phase1() throws InterruptedException {
        this.mutex.down();
        this.count++;
        if(this.count == this.n){
            for(int i = 0; i < this.n; i++){
                this.turnstile.signal(); //when n threads received then move on to phase 2
            }
        }
        this.mutex.signal();
        this.turnstile.down(); //keeps waiting till I get n threads
    }

    private synchronized void phase2() throws InterruptedException {
        this.mutex.down();
        this.count--;
        if(this.count == 0){
            for(int i = 0; i < this.n; i++){
                this.turnstile2.signal(); //reset the barrier for reuse 
            }
        }
        this.mutex.signal();
        this.turnstile2.down(); //keeps waiting till n threads get executed
    }
}

public class semaphore {
    private int counter;

    public semaphore(int number){
        if (number > 0) {
            this.counter = number;
        }
    }

    public synchronized void signal(){
        this.counter++;
        notifyAll();
    }

    public synchronized void down() throws InterruptedException{
        while (this.counter <= 0){
            wait();
        }
        this.counter--;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-11T11:18:37.580

我看到您正在使用[*The Little Book of Semaphores*](http://www.greenteapress.com/semaphores/)的解决方案。本书的一个要点是，您可以使用信号量作为唯一的协调原语来解决许多协调问题。**使用同步**来实现信号量是非常好的，因为这是正确执行它所必需的。然而，在解决一个应该用信号量解决的难题的方法中使用**同步，它没有抓住重点。**

另外，我认为它不适用于您的情况：您不会在**this.turnstile.down()**处陷入僵局吗？您阻塞了一个信号量，该信号量在对象和方法上持有一个排他锁（通过**synchronized**），这将允许该信号量被释放。

如上所述解决问题：您向线程发出信号，表明它们可以通过从**barrier.down()**返回来继续。**您可以通过turntile.down()**确保您不会过早返回。

**旁白：信号量实现**

您的信号量实现看起来是正确的，除了您只允许非负初始值，这至少是非标准的。这样做有什么我看不到的动机吗？如果您认为负初始值是错误的，为什么不抛出错误而不是默默地做其他事情呢？

**旁白：其他同步原语**

请注意，java 构造**synchronized**、**.wait()**和**.notify()**对应于[Monitor](http://en.wikipedia.org/wiki/Monitor_(synchronization)#Implicit_condition_variable_monitors)协调原语。使用监视器（或其他协调原语）而不是信号量来解决难题可能是有益的，但我建议将这些努力分开。[尝试使用Haskell 的 Software Transactional Memory](http://book.realworldhaskell.org/read/software-transactional-memory.html)解决难题时，我获得了一些乐趣。

**旁白：关于可运行性**

你说你已经尝试了一些东西，这表明你有一些代码可以让你运行问题中的代码。如果您包含该代码会很有帮助，因此我们也可以轻松运行它。我可能会检查我假设的死锁是否真的发生了。**

# javascript - 这在私人环境中

> ID：15753884
> 
> 赞同：1
> 
> 时间：2013-04-01T23:56:08.440
> 
> 标签：javascript, variables, object, scope, private

我想访问在私有上下文中创建的变量。我正在创建一个这样的私有上下文：

```
(new Function("var a = 'hello'; console.log('this', this);")).call({});
// outputs -> this Object {} 
```

我正在`call`使用一个空上下文的函数。但`this`不持有`a`变量。无论如何，它怎么可能`console.log`在空上下文中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:00:08.380

**[jsFiddle 演示](http://jsfiddle.net/26e5v/)**

在创建对象的函数的范围`var a`内存在。但是，一旦该范围丢失，变量也会丢失。如果你想`a`持久化，你需要将它附加到使用`this`关键字创建的对象上：

```
(new Function("this.a = 'hello'; console.log(this);")).call({}); 
```

但是，这是一种混淆的方式。这里有一些不需要的元素。主要`new`是不需要关键字（[`Function`](http://www.java2s.com/Tutorial/JavaScript/0140__Function/FunctioncapitalF.htm)意味着函数对象）。`Function`还自带方法，比如`call`.

```
Function("this.a = 'hello'; console.log(this);").call({}); 
```

这也将起作用。此外，如果您想保留变量 a 中的内容，您可以随时执行此操作（[演示](http://jsfiddle.net/8sU65/1)）：

```
var obj = {};
Function("this.a = 'hello'").call(obj);
obj.a;//hello 
```

* * *

至于为什么它适用于空上下文。你实际上已经给了它一个新构造的对象`{}`。这`this`就是遇到引用时在函数内部使用的范围。实际上，`call()`如果您不打算使用范围，则不需要参数。像这样的东西：

```
Function("console.log(5);").call(); 
```

`5`将无错误地登录到控制台。

* * *

您的问题中使用的方法是从魔术字符串构建一个函数。我必须说，这种方法非常酷，与 eval 非常相似。但是你正在寻找的归结为我认为的这种差异：

```
function ball(){
 var color = "red";
 return color;
}

function Ball(){
 this.color = "red";
}

console.log(ball());//logs red
console.log(new Ball().color);//logs red 
```

# ember.js - Ember.js：基于 Fixture 中的所有元素设置计算属性

> ID：15753885
> 
> 赞同：2
> 
> 时间：2013-04-01T23:56:16.083
> 
> 标签：ember.js, ember-data

我正在构建一个简单的数据可视化，根据记录总数显示设备类型的份额。我想知道是否有一种方法可以根据夹具中的所有元素计算属性。

```
App.Devices = DS.Model.extend({
    label: DS.attr('string'),
    measure: DS.attr('number'),
    share: function() {
        //code to return measure / fixtureTotal
    }.property('measure')
});

App.Devices.FIXTURES = [
    { id: "0", label: "Computer", measure: 10 },
    { id: "1", label: "Mobile",   measure: 20 },
    { id: "2", label: "Tablet",   measure: 30 }
]                                 //  fixtureTotal = 60 
```

因此，在这种情况下，“计算机”将占总记录的 (10/60) 份额。

这可以通过计算属性来完成还是需要其他解决方案？理想情况下，此解决方案将与 fixtureAdaptor 或 RESTAdaptor 一起使用

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:39:50.480

似乎与我在 todomvc.com 中看到的类似：[https ://github.com/addyosmani/todomvc/blob/gh-pages/architecture-examples/emberjs/js/controllers/todos_controller.js#L32](https://github.com/addyosmani/todomvc/blob/gh-pages/architecture-examples/emberjs/js/controllers/todos_controller.js#L32)

假设您有一个显示所有设备的 ArrayController，这就是我要尝试的：

*   在 ArrayController 上为 Devices 创建一个计算属性，用于计算总数，并取决于`@each.measure`;
*   （暗示 Device 将由指向其自己的 ObjectController 的子视图显示）添加`needs: ['devices']`到声明子控制器，以表明该控制器依赖于 Devices 控制器；
*   在计算共享的设备控制器上创建一个计算属性，并依赖于`measure`和`controllers.devices.total`。

然后在 Device 控制器的 share() 属性函数中，可以使用 获取对父控制器实例的引用，`this.get('controllers.devices')`甚至可以直接使用 获取total 属性的值`this.get('controllers.devices.total')`。

* * *

我最初从“我自己没有尝试过”开始回答，但因为我也想看看这是否可行，这里有一个带有工作代码的 JSBin：http: [//jsbin.com/ajoqak/12/edit](http://jsbin.com/ajoqak/12/edit)（编辑以使其与 REST 适配器一起使用）。

请注意，这假设 Ember.js 1.0.0-rc2 和我几天前制作的 ember-data 构建（还没有正式版本）；API 与我使用以前版本看到的一些答案/示例有所不同。

# c# - 按枚举类型对数据网格列进行排序

> ID：15753887
> 
> 赞同：1
> 
> 时间：2013-04-01T23:56:21.253
> 
> 标签：c#, wpf, sorting, datagrid, enums

我的列中有一个`DataGrid`显示一些枚举值的列。我将 设置`SortMemberPath`为由这些枚举值表示的属性。但是，当单击列标题时，它不会对我的枚举进行排序，因为我没有指定如何对这种类型进行排序。这是一个枚举，所以我不能完全覆盖 < 运算符。有任何想法吗？

更新：如果可以的话，我会尽量避免使用第二个属性。我只能设置 SortMemberPath = "MyEnumProperty"。我无法告诉它如何解释该值。

```
_colDefs["Subtype"] = new DataGridTextColumn()
{       
    Binding = new Binding("") { Converter = new SubtypeConverter() },
    SortMemberPath = "Subtype"
}; 
```

我的财产如下所示：

```
public SubtypeEnum Subtype { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:57:17.193

您可以通过硬转换将枚举转换为 int：

```
(int)MyEnum.EnumValue 
```

如果你可以在你的数据结构中添加一个伪造的属性，它只是将它的枚举值重新转换为 int，你应该能够按该属性对其进行排序，即使它不可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T14:35:07.790

尝试在绑定中指定属性名称：

```
_colDefs["Subtype"] = new DataGridTextColumn()
{       
    Binding = new Binding("Subtype"),
    SortMemberPath = "Subtype"
}; 
```

您甚至不再需要转换器（如果它只是转换为字符串）。

# javascript - 为什么这个循环通过 facebook 帖子不起作用？

> ID：15753888
> 
> 赞同：0
> 
> 时间：2013-04-01T23:56:32.580
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我正在使用 Javascript 中的 Facebook API 来尝试从 Facebook 中提取帖子。[我从文档中的这个页面](https://developers.facebook.com/docs/reference/javascript/FB.api/)复制了代码。该函数将访问给定的页面并实际产生响应。但是， response.length 和 response[i] 返回为“未定义”，因此循环无法工作。为什么会这样？

```
<button onclick="ShowMyPosts()">Show posts</button>
<script language="javascript" type="text/javascript">
    function ShowMyPosts() {
        FB.api('/TheWalkingDeadAMC/posts', { limit: 3 }, function(response) {
            console.log(response)
            console.log(response.length)
          for (var i=0, l=response.length; i<l; i++) {
                var post = response[i];
                console.log(post)
                if (post.message) {
                    console.log('Message: ' + post.message);
                } else if (post.attachment && post.attachment.name) {
              console.log('Attachment: ' + post.attachment.name);
            }
          }
  }
)
console.log("successfully ran function")        
};
</script> 
```

我如何获得访问令牌。这是不正确的吗？

```
FB.login(function(response) {
    if (response.authResponse) {
        var access_token =   FB.getAuthResponse()['accessToken'];
        console.log('Access Token = '+ access_token);
        FB.api('/me', function(response) {
            console.log('Good to see you, ' + response.name + '.');
            });
    } else {
        console.log('User cancelled login or did not fully authorize.');
        }{scope: 'read_stream'} 
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T01:53:52.133

当您查询 Graph API - 大多数结果将在`data`键内...

使用[Graph API Explorer](https://developers.facebook.com/tools/explorer)，您可以测试您的调用并查看结果，而无需编写任何代码。

这是您的 Graph API 调用测试的[直接链接。](https://developers.facebook.com/tools/explorer?method=GET&path=TheWalkingDeadAMC/posts)如您所见`data`，持有职位。

所以，你需要循环`response.data`而不是`response`.

代码应如下所示：

```
function ShowMyPosts() {
    FB.api('/TheWalkingDeadAMC/posts', { limit: 3 }, function(response) {
       console.log(response.data);
       console.log(response.data.length)
       for (var i=0, l=response.data.length; i<l; i++) {
          var post = response.data[i];
          console.log(post)
          if (post.message) {
             console.log('Message: ' + post.message);
          } else if (post.attachment && post.attachment.name) {
             console.log('Attachment: ' + post.attachment.name);
          }
       }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T15:16:05.400

我认为问题在于我的 FB.login 不正确。这是下面的正确代码：

```
FB.login(
function(response) {
    if (response.authResponse) {
        var access_token =   FB.getAuthResponse()['accessToken'];
        console.log('Access Token = '+ access_token);
        FB.api('/me', function(response) {
            console.log('Good to see you, ' + response.name + '.');
            });
    } else {
        console.log('User cancelled login or did not fully authorize.');
        }},
    {scope: 'read_stream'}  
    ); 
```

# c# - Ninject.Web.Mvc.FluentValidation 和 FluentValidation.MVC4

> ID：15753892
> 
> 赞同：2
> 
> 时间：2013-04-01T23:56:55.817
> 
> 标签：c#, asp.net-mvc, fluentvalidation, ninject.web.mvc

我尝试在我的 ASP.NET MVC4 项目中设置 Ninject.Web.Mvc.FluentValidation，如下所示：

```
var ninjectValidatorFactory = new NinjectValidatorFactory(kernel);
//ModelValidatorProviders.Providers.Add(new FluentValidationModelValidatorProvider(new NinjectValidatorFactory(kernel)));
FluentValidationModelValidatorProvider.Configure(x => x.ValidatorFactory = ninjectValidatorFactory);

DataAnnotationsModelValidatorProvider.AddImplicitRequiredAttributeForValueTypes = false; 
```

但我收到以下错误：

```
Error   1   The type 'FluentValidation.ValidatorFactoryBase' is defined in an assembly that is not referenced. You must add a reference to assembly 'FluentValidation, Version=2.0.0.0, ...

Error   2   Cannot implicitly convert type 'Ninject.Web.Mvc.FluentValidation.NinjectValidatorFactory' to 'FluentValidation.IValidatorFactory'. An explicit conversion exists (are you missing a cast?) 
```

我可以看到 Ninject.Web.Mvc.FluentValidation 的 NuGet 包是 3.0.0.0 版，错误告诉我它正在寻找 FluentValidation 的第 2 版以获取其依赖项。

如果我只为 Ninject.Web.Mvc.FluentValidation 安装 NuGet 包，那么它会安装 FluentValidation v2 依赖项而不是版本 3.4.6

但我也可以在这里看到：[https](https://github.com/ninject/ninject.web.mvc.fluentvalidation/commit/82096d0afd15c41d01c09fd47f4247682261768e) ://github.com/ninject/ninject.web.mvc.fluentvalidation/commit/82096d0afd15c41d01c09fd47f4247682261768e 关于正在更新版本 3.4.6 的项目的说明

我目前正在使用 NuGet 将 FluentValidation.MVC4 包添加到我的项目中，然后在它之后添加 Ninject.Web.Mvc.FluentValidation （发现它的依赖项已经存在并且不添加它）。

我可以看到 NuGet 包最后一次发布是在 2013 年 4 月 1 日，但是当我查看项目中的 .nuspec 文件时，它显示

```
<dependency id="FluentValidation" version="3.2.0.0" /> 
```

这个设置有什么我做错了吗？或者我可以通过包管理器控制台来更新依赖版本的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T11:25:11.560

**更新：**这样做的原因是因为使用的是强命名`Ninject.Web.Mvc.FluentValidation`的签名版本。`FluentValidation`

David Ebbo 有一篇关于强名称和绑定重定向的好文章 [http://blog.davidebbo.com/2011/01/nuget-versioning-part-3-unification-via.html](http://blog.davidebbo.com/2011/01/nuget-versioning-part-3-unification-via.html)

我仍然没有费心这样做来解决我的问题，NuGet 包只有 1 个类，the `NinjectValidatorFactory`，所以值得自己实现。

* * *

为了暂时解决我的问题，我已将`NinjectValidatorFactory`课程放入我自己的项目中。在我看来，当前的 NuGet 包在使用 FluentValidation 3.4.6 之前需要进一步更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-03T05:30:17.330

在包管理器控制台中输入这些代码：

```
Install-Package FluentValidation-Signed
Install-Package FluentValidation.MVC3-Signed -IgnoreDependencies
Install-Package Ninject.Web.Mvc.FluentValidation -IgnoreDependencies 
```

-IgnoreDependencies 很重要。

# select - SELECT WHERE CASE 语句

> ID：15753894
> 
> 赞同：0
> 
> 时间：2013-04-01T23:57:10.260
> 
> 标签：select, case, where

我正在开展一个项目，在该项目中，用户对记录的访问受到基于用户的用户组的限制。我创建了一个全局变量 $usr_sec_group，并且我想在几个应用程序的 SELECT 语句中的 WHERE 子句中添加一个 CASE 语句，该语句根据 $usr_sec_group 的值应用不同的过滤器。关于 mySQL，我是一个相对“新手”，我尝试编写这样的语句并没有奏效。这是基本逻辑：

```
SELECT 
   field1,
   field2,
   etc
FROM
  Organizations
CASE $user_sec_group
  WHEN 1 THEN 'filter_statement_1'
  WHEN 2 THEN 'filter_statement_2'
  WHEN 3 THEN 'filter_statement_3'
  ELSE 'filter_statement_else'
END CASE
ORDER By
   field1 
```

“filter_statements”可以是任何有效的过滤器，例如

```
'oName => 'a' AND oName < 'g' 
```

我假设问题是一个相对简单的语法问题，但到目前为止，我还不能编写一个有效的 CASE 语句。

我将不胜感激一些指导！

此致，

埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:15:54.013

您尝试的解决方案将不起作用：这不仅仅是语法问题，您必须使用动态 sql。即使你使用了动态sql，*也不*是管理访问权限的好方法。

更好的方法是在各种访问级别创建特定视图，然后授予特定用户适当的访问权限并撤销其他用户的访问权限：

```
GRANT SELECT ON MyDatabase.viewABC 
    TO 'someuser'@'somehost'; 
```

看

*   [授予/撤销命令](http://dev.mysql.com/tech-resources/articles/mysql_intro.html#SECTION0006100000)

*   [MySQL权限介绍](http://www.databasejournal.com/features/mysql/article.php/3311731/An-introduction-to-MySQL-permissions.htm)

*   [如何授予多个用户权限；MySQL](http://dev.mysql.com/doc/refman/5.5/en/grant.html)

# html - 将 IE 复制粘贴到 Outlook 电子邮件时 CSS 表格格式丢失

> ID：15753898
> 
> 赞同：1
> 
> 时间：2013-04-01T23:57:33.443
> 
> 标签：html, css, internet-explorer, twitter-bootstrap, internet-explorer-8

我正在更新公司内部网站。网站上有一张汇总数据表。每天，该表都会从页面复制到电子邮件中，并发送给使用 Outlook 2010 的人员。该公司目前使用的是 IE8。

问题是新网站使用 Twitter Bootstrap 进行表格样式设置。将表格复制并粘贴到 Outlook 中时，大部分样式都丢失了。

旧网站的每个 , 等都附加了`tr`类`td`。

Chrome 在新网站上运行没有任何问题。

以下是表格和问题的一些示例：

旧网站 - [http://jsbin.com/ifeqav/1/edit](http://jsbin.com/ifeqav/1/edit)

新网站 - [http://jsbin.com/iwuven/1/edit](http://jsbin.com/iwuven/1/edit)

有谁知道解决这个问题？我已经尝试过[这个建议](https://stackoverflow.com/a/4307826/1873505)，但它似乎无法与 bootstrap 一起正常工作。

IE9 能解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T00:07:04.533

Outlook 2007 及更高版本不使用 IE 进行 HTML 邮件格式设置。相反，他们使用 Word（是的，这很糟糕，每个人都知道）。Word 不支持 CSS2 中的许多功能，更不用说 CSS3。不幸的是，这意味着向 Outlook 用户提供图形电子邮件的最佳方式是向他们发送 1990 年代的 HTML 电子邮件：`<table>`布局的恐怖和邪恶的回归`spacer.gif`。这种可恶的做法是可以接受的，因为 Outlook/Word 不解释任何语义内容。

或者只是在您的电子邮件顶部添加一个链接，上面写着：“使用 Outlook？单击此处在浏览器中查看您的消息”。

# ios - 如何在 iOS 应用程序中完全“关闭和清除”FBSession 的 activeSession 信息？

> ID：15753899
> 
> 赞同：3
> 
> 时间：2013-04-01T23:57:37.680
> 
> 标签：ios, facebook-graph-api

我目前正在创建一个 iOS 应用程序，它允许用户从我的应用程序的设置视图控制器中连接/断开他们的 Facebook 帐户。Facebook 的 SDK 开发人员文档建议在 FBSession.activeSession 类上调用“closeAndClearTokenInformation”方法，该方法根据文档“关闭内存中的会话，并清除与该会话相关的任何持久缓存”。

我研究过这个问题，并注意到很多人在使用 Facebook 的 SDK 时遇到了同样的差异；具体来说，在“关闭和清除”activeSession 之后，在打开一个新会话时，应用程序会跳转到 iphone 的浏览器（快速切换），但不会提示用户使用他们的 facebook 凭据登录。相反，会通知用户“他们已经获得了此应用程序的授权，他们应该按‘确定’继续。”

我期待 Facebook 的 SDK 再次提示用户输入他们的电子邮件/电话号码和密码，因为我从上一个会话中清除了他们的会话信息。我还从用户默认值中删除了所有令牌信息，同时“清除和关闭”会话，希望这能解决我的问题，但这个问题仍然存在。

以下是我试图清除我的 Facebook 会话信息的方法：

```
[[FBSession activeSession] closeAndClearTokenInformation];
[[FBSession activeSession] close];
[FBSession setActiveSession:nil];
NSLog(@"The active facebook session: %@", [[FBSession activeSession] description]); 
```

这是我的输出控制台显示的内容：

```
2013-04-01 17:07:11.759 RoyalCourt Debug[4728:c07] The active facebook session:
<FBSession: 0xb86e060, state: FBSessionStateCreated, loginHandler: 0x0, appID:
164860420329245, urlSchemeSuffix: , tokenCachingStrategy:<FBSessionTokenCachingStrategy:
0xb864650>, expirationDate: (null), refreshDate: (null), 
attemptedRefreshDate: 0001-12-30 00:00:00 +0000, permissions:()> 
```

我想知道：

1.  以前的会话信息存储在哪里，如何删除它？
2.  为什么 SDK 在调用 [[FBSession activeSession] closeAndClearTokenInformation] 方法后并没有真正清除所有缓存的会话数据？是否需要采取其他步骤才能完全删除所有以前的 Facebook 会话信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-25T20:22:41.513

iOS 也缓存 facebook 令牌。您还需要清除它以摆脱旧令牌

```
ACAccountStore *store = [[ACAccountStore alloc] init];
        NSArray *fbAccounts = [store accountsWithAccountType:[store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook]];
        for (ACAccount *fb in fbAccounts) {
            [store renewCredentialsForAccount:fb completion:^(ACAccountCredentialRenewResult renewResult, NSError *error) {

            }];
        } 
```

# python - Python - Asyncore（客户端）套接字 - 无法确定连接状态

> ID：15753901
> 
> 赞同：0
> 
> 时间：2013-04-01T23:58:00.827
> 
> 标签：python, sockets, asyncsocket, asyncore

出于某种原因，`self.connected`该类`asyncore.dispatcher`不认为我的套接字是在客户端连接的。服务器端将套接字视为已连接并将其视为已连接，但客户端不知道它是否已连接并且`handle_connect`不“proc”，因此我不能使用它的覆盖版本来检查套接字是否连接。

关于这段代码为什么它不起作用的任何想法：

```
#!/usr/bin/python
# -*- coding: iso-8859-15 -*-
import asyncore
from threading import *
from socket import *
from time import sleep
from os import _exit
from logger import *
from config import *

class logDispatcher(asyncore.dispatcher):
    def __init__(self, config=None):
        self.inbuffer = ''
        self.buffer = ''
        self.lockedbuffer = False
        self.is_writable = False

        asyncore.dispatcher.__init__(self)
        #Thread.__init__(self)

        self.create_socket(AF_INET, SOCK_STREAM)

        #self.is_writable = True
        #self.start()

    def compare(self, obj, otherobj):
        return (str(obj).lower() == str(otherobj).lower()[:len(str(obj))])
    def _in(self, obj, otherobj):
        return (str(obj).lower() in str(otherobj).lower())

    def parse(self):
        if self.inbuffer[-2:] != '\r\n':
            return False

        self.lockedbuffer = True
        self.inbuffer = ''
        self.lockedbuffer = False

    def readable(self):
        return True

    def handle_connect(self):
        log('Connected to ' + str(server), 'SOCK_CORE')

    def handle_close(self):
        self.close()

    def handle_read(self):
        data = self.recv(8192)
        while self.lockedbuffer:
            sleep(0.01)
        self.inbuffer += data

    def writable(self):
        return (len(self.buffer) > 0)

    def handle_write(self):
        while self.is_writable:
            sent = self.send(self.buffer)
            sleep(1)
            self.buffer = self.buffer[sent:]
            if len(self.buffer) <= 0:
                self.is_writable = False
            sleep(0.01)

    def _send(self, what):
        self.buffer += what + '\r\n'
        self.is_writable = True

    def handle_error(self):
        log('Error, closing socket!', 'SOCK_CORE')
        self.close()

    def run(self):
        log('Log socket engine initating', 'SOCK_CORE')
        self.connect((server, server_port))

        print self.connected
        sleep(3)
        print self.connected

class start(Thread):
    def __init__(self):
        Thread.__init__(self)
        self.start()
    def run(self):
        asyncore.loop(0.1)

start()
logDisp = logDispatcher()
logDisp.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:38:41.173

```
def handle_connect_event(self):
    self.is_connected = True 
```

将它添加到您的调度程序将为您提供一种检查套接字是否已连接的方法，这要归功于`python -m trace -t script.py`Python中的一些堆栈跟踪（`asyncore`只要套接字已连接或处于连接状态。

之后，我还替换了线程 asyncore.loop() 并将其替换为锁定主线程的“静态”放置，这两种组合之一（或两者）现在解决了问题..逻辑不一样就像我不喜欢的问题一样，但我假设我需要创建自己的 dispach_event 就像我要创建一个 OpenGL GUI 类一样，我会在每个循环中手动调用 dispatch_event() 在线程中的一些方式“让事物保持活力”..这只是一个想法..

无论如何，这是一个工作示例：

```
#!/usr/bin/python
# -*- coding: iso-8859-15 -*-
import asyncore, socket
from threading import *
from time import sleep
from os import _exit
from logger import *
from config import *

def _map():
    return {}
def _array():
    return []

class logDispatcher(Thread, asyncore.dispatcher):
    def __init__(self, config=None):
        self.inbuffer = ''
        self.buffer = ''
        self.lockedbuffer = False
        self.is_writable = False

        self.is_connected = False

        self.exit = False
        self.initated = False

        asyncore.dispatcher.__init__(self)
        Thread.__init__(self)

        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        try:
            self.connect((server, server_port))
        except:
            log('Could not connect to ' + server, 'LOG_SOCK')
            return None

        self.start()

    def handle_connect_event(self):
        self.is_connected = True

    def handle_connect(self):
        self.is_connected = True
        log('Connected to ' + str(server), 'LOG_SOCK')

    def handle_close(self):
        self.is_connected = False
        self.close()

    def handle_read(self):
        data = self.recv(8192)
        while self.lockedbuffer:
            sleep(0.01)

        self.inbuffer += data

    def handle_write(self):
        while self.is_writable:
            sent = self.send(self.buffer)
            sleep(1)

            self.buffer = self.buffer[sent:]
            if len(self.buffer) <= 0:
                self.is_writable = False
            sleep(0.01)

    def _send(self, what):
        self.buffer += what + '\r\n'
        self.is_writable = True

    def run(self):
        sleep(1)
        log('Log engine initating (hooking on to main)', 'LOG_CORE')

        main = None
        for t in enumerate():
            if t.getName() == 'MainThread':
                main = t

        log('Log engine attached to main', 'LOG_CORE')

        while (main and main.isAlive()) and (self.connected or self.is_connected):
            print 'WHAM', self.connected, self.is_connected
            sleep(1)

while 1:
    logDisp = logDispatcher()
    asyncore.loop(0.1)
    log('Logserver disconnected, trying to reconnect!', 'CORE')
    sleep(10) 
```

# javascript - jQuery动画在左侧位置不起作用

> ID：15753905
> 
> 赞同：1
> 
> 时间：2013-04-01T23:58:18.293
> 
> 标签：javascript, jquery, jquery-animate

我是 jQuery 新手，我正在尝试做一些非常简单的事情，但看起来并不是那么简单。

我在 DIV 中有一个菜单，DIV 的宽度为 500 像素，菜单为 250 像素。在菜单上我放了一个按钮。这个想法是，当有人单击按钮时，菜单从 DIV 的左侧转到右侧。

好吧，它不工作。

小提琴： http: [//jsfiddle.net/KUR52/](http://jsfiddle.net/KUR52/)和代码：

```
<div class="menuWrap">

        <a href="#" class="button"> MENU </a>

        <nav class="menu">

            <ul>
              <li>Lorem ipsum dolor</li>
              <li>Aenean commodo</li>
              <li>Aenean massa</li>
              <li>Lorem ipsum</li>
              <li>Aenean</li>
              <li>Aenean massa</li>
              <li>Lorem ipsum </li>
              <li>Aenean </li>
              <li>Aenean massa cum </li>
            </ul>

        </nav> 
```

CSS

```
.button {
    display: block;
    background-color: gray;

    height: 50px;
    width: 50px;
}

.menuWrap {
    width: 500px;
    background-color: lightblue;
}
    .menu {
        position: relative;
     /* left:250px; */
        left:0;
        width: 250px;
        background-color: orange;
    }
        .menu ul{
            margin: 0;
            padding: 0;
            list-style:none;
        } 
```

jQuery

```
$(document).ready(function () {

    $('.button').click(function () {
        $('.menu').toggle(function () {

                $(this).animate({left:'250px'}, 300)

            }, function () {

                $(this).animate({left:'0px'}, 300)

            }

            );
        });
}); 
```

我找到了几个可能的解决方案，但我无法让它们工作，最有希望的是：[jQuery - 显示滑动面板时绝对定位的 div 的“左”位置动画](https://stackoverflow.com/questions/2665368/jquery-animating-left-position-of-absolutely-positioned-div-when-sliding-pan)但它并没有让我变化太大，主要是因为我不明白`parseInt`以及如何使用我从中获得的价值。这是我的失败尝试[http://jsfiddle.net/W5avM/](http://jsfiddle.net/W5avM/)

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:02:20.743

看来您想使用`toggle`事件方法，您正在滥用此功能，并且它已从 jQuery 1.9 中删除。您正在使用`toggle`隐藏元素并且不接受 2 个回调函数的效果方法。

```
$(document).ready(function () {
    $('.button').click(function () {
        var $menu = $('.menu'),
            val = $menu.css('left') === '250px' ? '0px' : '250px';
        $menu.animate({
            left: val
        }, 300)
    });
}); 
```

[http://jsfiddle.net/Hh5nH/](http://jsfiddle.net/Hh5nH/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:02:03.030

`toggle()`显示或隐藏元素。我认为这不是您正在寻找的方法。

您可能想使用`toggleClass`来更改菜单上的类，并在 CSS 中设置不同的位置状态。这可以使用 CSS3 过渡进行动画处理。或者，您可以将 click 事件绑定到一个处理程序，该处理程序：

1.  检查当前位置。
2.  根据当前位置，将菜单设置为交替状态

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T00:07:56.033

试试这个让你开始：

```
$('.button').click(function () {
    $('.menu').animate({left:'250px'}, 300);    
}); 
```

# winapi - SetWindowsHookEx 崩溃

> ID：15753911
> 
> 赞同：0
> 
> 时间：2013-04-01T23:59:29.300
> 
> 标签：winapi, google-chrome-extension

我有一个 NPAPI 插件，它利用`SetWindowsHookEx`引擎盖进行一些屏幕抓取。这个插件似乎在我测试过的大多数机器上都能成功运行。但是，在一台机器（32 位 Windows 7）上，当我在 Chrome（26.0.1410.43m）下运行插件时，调用会`SetWindowsHookEx`崩溃托管插件的进程。这不是`SetWindowsHookEx`返回错误 - 它只是使进程崩溃。再说一次，这只发生在一台机器上：它在我们测试过的所有其他机器上都能正常工作。

但奇怪的是。您可能知道，Chrome 有多种定位插件的方法。通常，我们的 setup.exe 创建一些指向插件的注册表项，如下所示（来自 NSIS 安装程序）：

```
WriteRegStr HKLM "Software\MozillaPlugins\@alanta.com/WinVncCtl\" "Path" "$INSTDIR\npWinVnc.dll"
WriteRegStr HKLM "Software\MozillaPlugins\@alanta.com/WinVncCtl\" "ProductName" "Alanta Remote Desktop Server"
WriteRegStr HKLM "Software\MozillaPlugins\@alanta.com/WinVncCtl\MimeTypes\application/x-alanta-vnc" "Description" "Alanta's VNC Server NPAPI Plugin" 
```

`SetWindowsHookEx`当 Chrome 从该位置加载插件时，它会在调用时崩溃。

但是，如果我卸载插件，然后将完全相同的 DLL 复制到`%ProgramFiles%\Mozilla Firefox\Plugins\`，那么 Chrome 加载并运行插件就好了，调用`SetWindowsHookEx()`成功。

对于它的价值，这是实际的（相当沼泽标准）调用：

```
// Add the CallWnd hook
hCallWndHook = SetWindowsHookEx(
                WH_CALLWNDPROC,                 // Hook in before msg reaches app
                (HOOKPROC) CallWndProc,         // Hook procedure
                hInstance,                      // This DLL instance
                0L                              // Hook in to all apps
               //   GetCurrentThreadId()            // DEBUG : HOOK ONLY WinVNC
                ); 
```

调试器表明所有参数都指向合法、有效的东西。

有什么解决这个问题的建议吗？`SetWindowsHookEx`任何人都知道在这种情况下可能会出现任何奇怪之处吗？

编辑：`CallWndProc`看起来像这样：

```
LRESULT CALLBACK CallWndProc(int nCode, WPARAM wParam, LPARAM lParam)
{
  // Do we have to handle this message?
  if (nCode == HC_ACTION)
  {
      // Process the hook if the WinVNC thread ID is valid
      if (vnc_thread_id)
      {
          CWPSTRUCT *cwpStruct = (CWPSTRUCT *) lParam;
          HookHandle(cwpStruct->message, cwpStruct->hwnd, cwpStruct->wParam, cwpStruct->lParam);
      }
  }

   // Call the next handler in the chain
   return CallNextHookEx (hCallWndHook, nCode, wParam, lParam);
} 
```

中的断点`CallWndProc`似乎没有被击中，所以我怀疑崩溃是在设置钩子期间发生的，而不是在以后的处理期间发生的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T04:22:32.753

事实证明，这是一个激进的安全计划。显然，它的启发式方法允许某些 DLL 通过，而不允许其他 DLL。它一看到对`SetWindowsHookEx()`. 用合理的东西替换它可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:23:13.840

如果相同的 DLL 在放置在不同的目录中时表现不同，则表明这正在改变插件加载的顺序。

（*DLL 加载的目录不影响用于定位和加载其依赖项的搜索路径*）

我当然会看看在同一系统上加载的其他插件，看看它们的存在是否会触发（或者甚至可能导致）你的崩溃。

之后，我建议卸载并重新安装 Chrome，可能在一个新目录中，以防其中一个 Chrome 二进制文件被损坏或破坏。

# assembly - MIPS 基本 lw 查询

> ID：15753912
> 
> 赞同：0
> 
> 时间：2013-04-01T23:59:30.063
> 
> 标签：assembly, mips

我正在做一个任务，我试图在 C++ 和 MIPS 之间进行转换，我有一个问题要求我转换 B[8] = A[i-3] i、A 和 B 存储在注册表中分别为 $s0、$s4 和 $s5。我坚持的部分是如何将 i-3 存储到 A[] 中。有可能做这样的事情吗？：

```
lw $t0, 32($s5)
addi $t1, $s0, -3
lw $t2, $t1($s4)
sw $t0, 0($t2) 
```

我对 MIPS 还是有点陌生​​，主要是想弄清楚你是否可以以这种方式使用 lw。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:08:12.777

您不能`lw`使用寄存器作为索引来调用。假设寄存器中的值是正确的，您需要分两步执行：

```
add $t1, $t1, $s4
lw $t2, 0($t1) 
```

不要忘记，在访问每个元素为 4 个字节长的字数组时，您需要将索引乘以 4。

# php - 拆分字符串

> ID：15753913
> 
> 赞同：-4
> 
> 时间：2013-04-01T23:59:49.000
> 
> 标签：php, algorithm, encryption

我创建了一个加密算法，我需要在其中进行反转，我需要将一个字符串分成 3 对组成一个数组，我看了一遍，没有找到任何帮助，我该怎么做？

编辑：我试过了：

```
<?php
$todecode="#number too big to post#";
$len=strlen($todecode);
$a=0;
$b=array();
While($len!=$a){
//$decoded=chunk_split($todecode);
$add1=$todecode[$a];
$a=$a+1;
$add2=$todecode[$a];
$a=$a+1;
$add3=$todecode[$a];
$a=$a+1;
$adder=$add1,$add2,$add3;
array_push($b,$adder);
} 
```

但还没有别的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T00:12:56.347

我不了解 PHP，但我可以就您必须做什么提供建议。

首先，您需要计算字符串的字符数，并创建您需要的 3 个元胞数组：

*   如果您的字符串有 19 个字符，那么您将需要`ceil(19 / 3) = 7`数组，或者（更好）一个 7×3 数组

然后你需要将字符存储在数组的每一行：

```
i = -1; j=0;
for(j=0; j<length_of_your_string; j++) {
    if (j % 3 == 0)
        i++;
    result_array[i][j % 3] = your_string.charAt(j);
} 
```

我把翻译留给你可以使用的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:14:37.530

```
 $num_str = "12312312315234535";
    print_r(str_split($num_str,3)); 
```

# macos - 有谁知道 Mac OS X 的 Google App Engine 本地数据存储文件位于何处

> ID：15753914
> 
> 赞同：1
> 
> 时间：2013-04-01T23:59:58.053
> 
> 标签：macos, google-app-engine, local-storage

有谁知道 Mac OS X 的 Google App Engine 本地数据存储文件位于何处？我想复制它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T12:52:03.640

`/tmp`如果您在没有附加参数的情况下启动 SDK，它应该存储在该目录中。
考虑从`--datastore_path=/your/path`

# android - ListView 在使用 ViewHolder 滚动时崩溃应用程序

> ID：15753915
> 
> 赞同：1
> 
> 时间：2013-04-02T00:00:03.487
> 
> 标签：android, listview, android-listview, custom-adapter

当我在由扩展 baseAdapter 的 customAdapter 提供的 ListView 中上下滚动几次时，我的应用程序崩溃了。

还有一个问题是，当我上下滚动时，行中的信息有时会改变位置，有时会消失，这只是

LOGCAT

```
04-02 00:30:25.390: I/System.out(4461): Not a DRM File, opening notmally
04-02 00:30:25.445: I/System.out(4461): buffer returned 
04-02 00:30:25.531: I/dalvikvm-heap(4461): Forcing collection of SoftReferences for 12582928-byte allocation
04-02 00:30:25.570: E/dalvikvm-heap(4461): Out of memory on a 12582928-byte allocation.
04-02 00:30:25.570: I/dalvikvm(4461): "main" prio=5 tid=1 RUNNABLE
04-02 00:30:25.570: I/dalvikvm(4461):   | group="main" sCount=0 dsCount=0 obj=0x41135508 self=0x40f0a930
04-02 00:30:25.570: I/dalvikvm(4461):   | sysTid=4461 nice=0 sched=0/0 cgrp=apps handle=1074736944
04-02 00:30:25.570: I/dalvikvm(4461):   | schedstat=( 11607757611 1931762655 12518 ) utm=1084 stm=75 core=1
04-02 00:30:25.570: I/dalvikvm(4461):   at android.graphics.BitmapFactory.nativeDecodeStream(Native Method)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:619)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.graphics.BitmapFactory.decodeFile(BitmapFactory.java:385)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.graphics.BitmapFactory.decodeFile(BitmapFactory.java:418)
04-02 00:30:25.570: I/dalvikvm(4461):   at com.android.moha.MainActivity$MyCustomAdapter.getView(MainActivity.java:754)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.widget.AbsListView.obtainView(AbsListView.java:2445)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.widget.ListView.makeAndAddView(ListView.java:1769)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.widget.ListView.fillUp(ListView.java:706)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.widget.ListView.fillGap(ListView.java:645)
04-02 00:30:25.570: I/dalvikvm(4461):   at android.widget.AbsListView.trackMotionScroll(AbsListView.java:5530)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.widget.AbsListView.scrollIfNeeded(AbsListView.java:3413)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.widget.AbsListView.onTouchEvent(AbsListView.java:3906)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.View.dispatchTouchEvent(View.java:7340)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2179)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1914)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2185)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1928)
04-02 00:30:25.578: I/dalvikvm(4461):   at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:2113)
04-02 00:30:25.578: I/dalvikvm(4461):   at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1466)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.app.Activity.dispatchTouchEvent(Activity.java:2468)
04-02 00:30:25.578: I/dalvikvm(4461):   at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:2061)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.View.dispatchPointerEvent(View.java:7525)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3368)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3300)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4392)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4370)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4474)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:171)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.InputEventReceiver.nativeConsumeBatchedInputEvents(Native Method)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.InputEventReceiver.consumeBatchedInputEvents(InputEventReceiver.java:163)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl.doConsumeBatchedInput(ViewRootImpl.java:4442)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.ViewRootImpl$ConsumeBatchedInputRunnable.run(ViewRootImpl.java:4493)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.Choreographer.doCallbacks(Choreographer.java:555)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.Choreographer.doFrame(Choreographer.java:523)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.os.Handler.handleCallback(Handler.java:615)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.os.Handler.dispatchMessage(Handler.java:92)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.os.Looper.loop(Looper.java:137)
04-02 00:30:25.578: I/dalvikvm(4461):   at android.app.ActivityThread.main(ActivityThread.java:4895)
04-02 00:30:25.578: I/dalvikvm(4461):   at java.lang.reflect.Method.invokeNative(Native Method)
04-02 00:30:25.578: I/dalvikvm(4461):   at java.lang.reflect.Method.invoke(Method.java:511)
04-02 00:30:25.578: I/dalvikvm(4461):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:994)
04-02 00:30:25.578: I/dalvikvm(4461):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:761)
04-02 00:30:25.578: I/dalvikvm(4461):   at dalvik.system.NativeStart.main(Native Method)
04-02 00:30:25.617: E/InputEventReceiver(4461): Exception dispatching input event. 
```

自定义适配器 getView

```
 @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        System.out.println("getView " + position + " " + convertView);
        final ViewHolder holder;
        if (convertView == null) {
            mInflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = mInflater.inflate(l, null);
            holder  = new ViewHolder();

            holder.id = (TextView)convertView.findViewById(R.id.id);
            holder.name = (TextView)convertView.findViewById(R.id.name);
            holder.price = (TextView)convertView.findViewById(R.id.price);
            holder.description = (TextView)convertView.findViewById(R.id.description);
            holder.button = (Button) convertView.findViewById(R.id.order);
            holder.quantity = (TextView) convertView.findViewById(R.id.quantity);

            if (a == itemsList){
            holder.img = (ImageView) convertView.findViewById(R.id.menu_icon);

            }

            convertView.setTag(holder);
        }

        else {
            holder = (ViewHolder)convertView.getTag();
        }
        holder.id.setText(getId(getItem(position)));
        holder.name.setText(getName(getItem(position)));
        holder.price.setText("£ " + getPrice(getItem(position)));
        holder.description.setText(getDesc(getItem(position)));
        String path = getImgPath(getItem(position));
        if(a==itemsList){

            final String quantity = "1";

            sign = "+";

            if(path.equals("") || path.equals(null)){
                //holder.img.setImageDrawable(defaul);
                holder.img.setContentDescription("default");
            }
            else{
                Bitmap bm = BitmapFactory.decodeFile(path);
                holder.img.setImageBitmap(bm);
                holder.img.setContentDescription("set");
            }

        holder.img.setOnClickListener(new View.OnClickListener() {

            @SuppressLint("NewApi")
            @Override
            public void onClick(View v) {
                final ImageView full = (ImageView) findViewById(R.id.fullScreen);
                full.setVisibility(View.VISIBLE);
                full.setEnabled(true);

                full.setBackgroundColor(Color.BLACK);
                full.setImageDrawable(holder.img.getDrawable());

                full.setScaleType(ImageView.ScaleType.CENTER_INSIDE);

                full.setOnTouchListener(new View.OnTouchListener() {

                    @Override
                    public boolean onTouch(View v, MotionEvent event) {
                        full.setVisibility(View.GONE);
                        full.setEnabled(false);
                        return true;

                    }
                });

            }
        });
        holder.button.setOnClickListener(new android.view.View.OnClickListener(){
             public void onClick(View v) {
              //System.out.println("id" + v.getId());
              //System.out.println("bid" + R.id.order);
                // System.out.println("hell :" + lv.getItemAtPosition(position));
                 //System.out.println("hell :" + lv.getItemAtPosition(position));

              HashMap<String, String> map = itemsList.get(position);
            // System.out.println("items :" + lv.getAdapter().getItem(position));
             //System.out.println("orders :" + orderList.toString());

          if(v.getId() == R.id.order)
         {
              HashMap<String, String> hsh = map;

              String ss = null ;

              boolean done = false;
              for(int i=0; orderList.size()>i; i++){
                  HashMap<String, String> s = orderList.get(i);
                  ss= s.get(TAG_ID).toString();
                 if ( ss.equalsIgnoreCase(getItem(position).get(TAG_ID).toString()))
                  {
                      int foo = Integer.parseInt(s.get(TAG_QUANTITY).toString());
                      s.put(TAG_QUANTITY,( "" + (foo+1)));
                      done=true;
                      break;
                  }

              }
              if(!done)
              {
                  hsh.put(TAG_QUANTITY, quantity);
                  orderList.add(hsh);
              }

              //Log.d("Selected : ", orderList.toString());
            //  ListAdapter order = new MyCustomAdapter(1,orderList,R.layout.list_item);
              // updating listview
             // list1.setAdapter(order);
             // list11.setAdapter(order);

            ((MyCustomAdapter)  list1.getAdapter()).notifyDataSetChanged();
            ((MyCustomAdapter)  list11.getAdapter()).notifyDataSetChanged();

                      Float fo = Float.parseFloat(map.get(TAG_PRICE).toString());
                      Float total = Float.parseFloat(t.getText().toString());

                      //System.out.println("heeeeeeeeeeeeeere :" +fo);
                      t.setText(""+ String.format("%.2f", (fo+total)));
                      totalll = Float.parseFloat(t.getText().toString());
              }
        }
      });
        }
        else
        {                   
            sign = "-";
            if (value == 1)
            {
                holder.quantity.setVisibility(View.VISIBLE);
            }

            ListView l = list1;
            if(((Button) findViewById(R.id.handle)).isPressed())
            {
                l = list11;
            }else{l = list1;}
            final SwipeDetector swipeDetector = new SwipeDetector();
            l.setOnTouchListener(swipeDetector);
            l.setOnItemClickListener(new OnItemClickListener() {
                public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                        if (swipeDetector.swipeDetected()){                                                               
                              Float fo = Float.parseFloat((getItem(position).get(TAG_PRICE)).toString());
                              Float Quant = Float.parseFloat((getItem(position).get(TAG_QUANTITY)).toString());
                              Float total = Float.parseFloat(t.getText().toString());
                              //System.out.println("heeeeeeeeeeeeeere :" +fo);
                              orderList.remove(getItem(position));
                              t.setText(""+ String.format("%.2f", (total-(fo*Quant))));
                    //remove        //  ListAdapter order = new MyCustomAdapter(1,orderList,R.layout.list_item);
                    //remove        //  list1.setAdapter(order);
                    //remove        //  list11.setAdapter(order);
                              ((MyCustomAdapter)  list1.getAdapter()).notifyDataSetChanged();
                              ((MyCustomAdapter)  list11.getAdapter()).notifyDataSetChanged();
                            } 

                     }
            });
            holder.button.setOnClickListener(new View.OnClickListener(){
                 public void onClick(View v) {
                 // System.out.println("id " + v.getId());
                 // System.out.println("bid " + R.id.order);
                  HashMap<String, String> map = getItem(position);

              if(v.getId() == R.id.order)
             {

                  if ( orderList.contains(getItem(position)) ){
                      System.out.println("item :" +getItem(position));
                      //holder.quantity.setText("q");
                      int foo = Integer.parseInt(map.get(TAG_QUANTITY).toString());

                      map.put(TAG_QUANTITY, "" + (foo-1));
                      if((foo-1)==0)
                      {
                          orderList.remove(getItem(position));
                      }

                  }

                 // ListAdapter order = new MyCustomAdapter(1,orderList,R.layout.list_item);
                          // updating listview
                //        list1.setAdapter(order);
                //        list11.setAdapter(order);
                  ((MyCustomAdapter)  list1.getAdapter()).notifyDataSetChanged();
                  ((MyCustomAdapter)  list11.getAdapter()).notifyDataSetChanged();

                          Float fo = Float.parseFloat(map.get(TAG_PRICE).toString());
                          Float total = Float.parseFloat(t.getText().toString());

                          //System.out.println("heeeeeeeeeeeeeere :" +fo);
                          t.setText(""+ String.format("%.2f", (total-fo)));
                  }
            }
          });
            holder.button.setOnLongClickListener(new View.OnLongClickListener() {

                @Override
                public boolean onLongClick(View v) {
                      Float fo = Float.parseFloat((getItem(position).get(TAG_PRICE)).toString());
                      Float Quant = Float.parseFloat((getItem(position).get(TAG_QUANTITY)).toString());
                      Float total = Float.parseFloat(t.getText().toString());
                      //System.out.println("heeeeeeeeeeeeeere :" +fo);
                      orderList.remove(getItem(position));
                      t.setText(""+ String.format("%.2f", (total-(fo*Quant))));
                      ((MyCustomAdapter) list1.getAdapter()).notifyDataSetChanged();
                      ((MyCustomAdapter) list11.getAdapter()).notifyDataSetChanged();
                    return false;
                }
            });
        }

        if(a==orderList){holder.quantity.setText(getQuant(getItem(position)));}
        if(sign=="-"){holder.button.setText(sign);}
        return convertView;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:10:32.853

在持有人上设置数据时，请务必涵盖所有信息案例，

我的意思是，如果第一项在数据行上没有“描述”，那么您向下滚动然后向上滚动，该项目将从其他行设置“描述”。

只需检查您的 if 语句 when `holder ==null`& when`holder !=null`并检查每个项目是否具有价值，如果没有为其设置默认值。

希望回答对你有帮助

# python - 在 Pandas 中获取数据帧与向量的点积，并返回数据帧

> ID：15753916
> 
> 赞同：10
> 
> 时间：2013-04-02T00:00:06.553
> 
> 标签：python, pandas, dataframe, dot-product

我无法`dot()` [在官方文档](http://pandas.pydata.org/pandas-docs/dev/api.html)中找到有关该方法的条目。但是方法就在那里，我可以使用它。为什么是这样？

关于这个话题，有没有办法计算数据框中每一行与另一个向量的逐元素乘法？（并获得一个`dataframe`背面？），即类似于`dot()`但不是计算点积，而是计算元素乘积。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-11-10T23:16:52.707

`mul`本质上是做外积，而`dot`做内积。让我扩展接受的答案：

```
In [13]: df = pd.DataFrame({'A': [1., 1., 1., 2., 2., 2.], 'B': np.arange(1., 7.)})

In [14]: v1 = np.array([2,2,2,3,3,3])

In [15]: v2 = np.array([2,3])

In [16]: df.shape
Out[16]: (6, 2)

In [17]: v1.shape
Out[17]: (6,)

In [18]: v2.shape
Out[18]: (2,)

In [24]: df.mul(v2)
Out[24]: 
   A   B
0  2   3
1  2   6
2  2   9
3  4  12
4  4  15
5  4  18

In [26]: df.dot(v2)
Out[26]: 
0     5
1     8
2    11
3    16
4    19
5    22
dtype: float64 
```

所以：

`df.mul`采用形状为 (6,2) 的矩阵和向量 (6, 1) 并返回形状为 (6,2) 的矩阵

尽管：

`df.dot`采用形状矩阵 (6,2) 和向量 (2,1) 并返回 (6,1)。

这些不是同一个操作，它们分别是外积和内积。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-02T00:30:33.633

以下是如何将 DataFrame 与向量相乘的示例：

```
In [60]: df = pd.DataFrame({'A': [1., 1., 1., 2., 2., 2.], 'B': np.arange(1., 7.)})

In [61]: vector = np.array([2,2,2,3,3,3])

In [62]: df.mul(vector, axis=0)
Out[62]: 
   A   B
0  2   2
1  2   4
2  2   6
3  6  12
4  6  15
5  6  18 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T00:06:27.397

很难准确地说出来。

通常，一种方法存在并且没有记录，因为它被供应商认为是内部的，并且可能会发生变化。

当然，这可能是整理文档的人的简单疏忽。

关于你的第二个问题；我真的不知道 - 但最好为它提出一个新的 S/O 问题。只是扫描 API，你能用 DataFrame 的 .applymap(function) 特性做点什么吗？

# python - 如何在 python 正则表达式中忽略多个空格字符和单词

> ID：15753919
> 
> 赞同：0
> 
> 时间：2013-04-02T00:00:30.260
> 
> 标签：python, regex

我有一个模式，它正在寻找 word1 后跟 word2 后跟 word3 ，其间有任意数量的字符。但是，我的文件包含许多随机换行符和其他空白字符 - 这意味着在单词 1 和 2 或单词 2 和 3 之间可能有 0 个或多个单词和/或 0 个或多个随机换行符

为什么这段代码不起作用？（它不匹配任何东西）

```
strings = re.findall('word1[.\s]*word2[.\s]*word3', f.read()) 
```

[.\s]* - 我的意思是 - 多次查找 '.'(any char) 或 '\s'(newline char) (*)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:06:15.753

您的 reg ex 不起作用的原因是 reg ex-es 仅尝试在单行上匹配。他们在找到换行符 ( `\n`) 时停止并尝试从模式的开头开始匹配新行上的模式。

为了使 reg ex 忽略换行符，您必须将`re.DOTALL`其作为第三个参数添加到`findall`函数中：

```
strings = re.findall('word1.*?word2.*?word3', f.read(), re.DOTALL) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:03:04.923

你有两个问题：

1)`.`括号内没有任何特殊含义`[]`。

`[]`改为使用您的`()`，如下所示：`(.|\s)`

2)`\`并不意味着您认为它在常规字符串中的作用。

尝试使用原始字符串：

```
re.findall(r'word1 ..blah..') 
```

注意`r`字符串的前缀。

把它们放在一起：

```
strings = re.findall(r'word1(.|\s)*word2(.|\s)*word3', f.read()) 
```

但是，请注意这会更改返回的列表。

# ios - Apple 开发者注册我们的网站时，有没有办法验证他们的身份？

> ID：15753921
> 
> 赞同：1
> 
> 时间：2013-04-02T00:01:00.227
> 
> 标签：ios, affiliate

我们是注册的 Apple 附属公司，并拥有一个包含 iOS 开发者社区的网站。会员资格应该只适用于已将应用程序发布到 App Store 的开发人员，我们希望通过某种方式对此进行检查。

目前，我们要求开发者提供他们发布的应用程序之一的应用程序 ID，然后我们使用此信息在我们的数据库中查找他们的艺术家 ID（即开发人员 ID）。但是，用户可以从 iTunes 网站复制任何应用程序的 ID 并注册，即使他不是该应用程序的真正开发者。

我们想到了一种方法，但认为这是不允许或不可能的：开发人员指定用于在 Apple Developer Program 中注册的电子邮件地址，然后我们调用一些 API 或其他资源来验证该电子邮件地址是否确实已注册。如果是，我们将通过该电子邮件地址完成注册过程。这可能吗？

还是有其他方法可以检查用户是否有已发布的应用程序？我们不需要 100% 万无一失的方法：只需要一种最低限度的可靠方法。即使只是简单地验证用户是注册的 Apple 开发人员也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:15:59.077

您必须是开发人员才能阅读开发论坛。使用代码在开发论坛上发帖，然后向用户询问该代码（发布链接，例如：[https](https://devforums.apple.com/message/799093) ://devforums.apple.com/message/799093 ）。这至少可以证明他们可以访问论坛（或访问论坛的人）。除非您是 Apple，否则我认为没有万无一失的方法来验证用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:08:20.527

我会调查使用开发人员的证书来签署某些东西，证明他们是私钥的控制者。您首先需要验证使用条款，因为我不知道 Apple 是否允许这种使用，但加密应该可以作为身份验证正常工作。

# entity-framework - 使用 C# .NET 和实体框架进行存储库实验

> ID：15753924
> 
> 赞同：1
> 
> 时间：2013-04-02T00:01:27.447
> 
> 标签：entity-framework, repository-pattern, ddd-repositories

我正在构建一个资产跟踪应用程序。使用 SQL Server 2008、C# .NET 和实体框架。这是我创建存储库的第一次体验，根据我的研究，存储库旨在抽象数据访问过程。我一直在尝试一些设计，我很好奇它们中的任何一个是好的，还是会带来任何严重的开发风险。存储库应支持按序列号、条形码或主机名查询资产。

为了使示例简短，我不包括更新、删除、插入方法。此外，这些示例忽略了可能的泛型实现，因为泛型实现总是可以在以后制定，而现在只会使示例更加混乱。请阅读以下 3 种设计，并让我知道我是否在正确的轨道上使用其中任何一种：

## 设计一

我的第一个设计是这样的：

```
public interface IAssetRepository
{
    public Asset fetchBySerialNumber(String serialNumber);
    public Asset fetchByBarcode(String barcode);
    public ICollection<Asset> fetchByHostname(String hostname);
    public Asset fetchActiveByHostname(String hostname);
}

public class AssetRepository : IAssetRepository
{
    private InventoryEntites entities;

    public Asset fetchBySerialNumber(String serialNumber)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.SerialNumber == serialNumber
                                  select a;

        return query.FirstOrDefault();
    }

    public Asset fetchByBarcode(String barcode)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Barcode == barcode
                                  select a;

        return query.FirstOrDefault();
    }

    public Asset fetchActiveByHostname(String hostname)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Hostname == hostname && a.IsDeployed == true
                                  select a;

        return query.FirstOrDefault();
    }

    public ICollection<Asset> fetchByHostname(String hostname)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Hostname == hostname
                                  select a;

        return query.ToList();
    }
} 
```

## 设计二

在我的第二次尝试中，我认为我可以通过包装用作参数的原始类型来利用临时多态性：

```
public interface IAssetRepository
{
    public Asset fetch(SerialNumber serialNumber);
    public Asset fetch(Barcode barcode);
    public ICollection<Asset> fetch(Hostname hostname);
    public Asset fetchActive(Hostname hostname);
}

public class SerialNumber
{
    private String value;

    public SerialNumber(String value)
    { this.value = value; }

    public String Value
    {
        get { return this.value; }
    }
}

// Barcode and Hostname classes are similar to SerialNumber

public class AssetRepository : IAssetRepository
{
    private InventoryEntites entities;

    public Asset fetch(SerialNumber serialNumber)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.SerialNumber == serialNumber.Value
                                  select a;

        return query.FirstOrDefault();
    }

    public Asset fetch(Barcode barcode)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Barcode == barcode.Value
                                  select a;

        return query.FirstOrDefault();
    }

    public ICollection<Asset> fetch(Hostname hostname)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Hostname == hostname.Value && a.IsDeployed == true
                                  select a;

        return query.FirstOrDefault();
    }

    public Asset fetchActive(Hostname hostname)
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Hostname == hostname.Value
                                  select a;

        return query.ToList();
    }
} 
```

## 设计 3

本着“告诉，不问”的精神，我的最后一个设计将实际查询移至 SerialNumber、Hostname 和 Barcode 类，而不是询问它们的值。SerialNumber 等类现在必须包含对数据源的引用。这些可能会受益于接口，因此它们可以支持不同的数据源。我不知道这是否是一个好的设计，因为它们每个都有对实体的单独引用。客户端必须在将对象（序列号等）发送到存储库之前构造它们。由于客户端不会引用实体，因此在构造期间无法注入对实体的相同引用：

```
// Same interface as last
public interface IAssetRepository
{
    public Asset fetch(SerialNumber serialNumber);
    public Asset fetch(Barcode barcode);
    public ICollection<Asset> fetch(Hostname hostname);
    public Asset fetchActive(Hostname hostname);
}

// Could include other methods like, findStartingWith(), findContains(), etc.
public class SerialNumber
{
    private InventoryEntites entities;
    private String value;

    public SerialNumber(String value)
    { 
        this.value = value;
        this.entities = new InventoryEntities();
    }

    public Asset find()
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.SerialNumber == this.value
                                  select a;

        return query.FirstOrDefault();
    }
}

// Barcode classes is similar to SerialNumber

public class Hostname
{
    private InventoryEntites entities;
    private String value;

    public Hostname(String value)
    { 
        this.value = value;
        this.entities = new InventoryEntities();
    }

    public ICollection<Asset> find()
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Hostname == this.value
                                  select a;

        return query.ToList();
    }

    public Asset findActive()
    {
        IQueryable<Asset> query = from a in this.entities.Assets
                                  where a.Hostname == this.value && a.IsDeployed == true
                                  select a;

        return query.FirstOrDefault();
    }
}

public class AssetRepository : IAssetRepository
{
    private InventoryEntites entities;

    public Asset fetch(SerialNumber serialNumber)
    {
        return serialNumber.find();
    }

    public Asset fetch(Barcode barcode)
    {
        return barcode.find();
    }

    public ICollection<Asset> fetch(Hostname hostname)
    {
        return hostname.find();
    }

    public Asset fetchActive(Hostname hostname)
    {
        return hostname.findActive();
    }

    // Other methods could include

    public ICollection<Asset> fetch(Location location)
    {
        return location.find();
    }

    public ICollection<Asset> fetchActive(Location location)
    {
        return location.findActive();
    }
} 
```

## 更新

做了一些研究，发现了这篇文章：

[MSDN：实践中的模式：内聚和耦合](http://msdn.microsoft.com/en-us/magazine/cc947917.aspx)

这句话让我想到了设计 3。也许应该将这一小组类整合到一个更像设计 2 的设计中？

> **霰弹枪手术**系统中某种类型的更改反复导致对一组类进行大量小的更改。霰弹枪手术通常意味着单个逻辑想法或功能分布在多个类别中。尝试通过将必须更改的所有代码部分合并到一个单一的内聚类中来解决此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T06:14:21.667

我总是使用设计#1，因为它更容易分辨存储库的作用。它确实传达了意图。

如果您在设计二中对实体（等）进行某种验证`Barcode`以验证 ID，那么我更愿意这样做。如果你不这样做，它不会增加任何价值，因为你可以获取一个`hostName`id 并用它创建一个`BarCode`。

设计三更多的是与存储库混合的数据访问对象。这是一个不不。

*（旁注：请遵循 .NET 命名约定。方法名称应为`PascalCase`）*

# c - C通用双链表每个节点持有多个项目

> ID：15753926
> 
> 赞同：3
> 
> 时间：2013-04-02T00:01:35.417
> 
> 标签：c, generics, linked-list

我正在尝试设计一个通用链表，其中每个节点可以存储多个项目，例如颜色、形状和大小。

这就是我的 .h 文件的样子

```
typedef struct linked{
    char type;
    void * item;
    struct linked * next;
    struct linked * prev;
}LinkedList;

LinkedList * NewLinkedList();
LinkedList * next(Iterator **I);
int hasNext(Iterator *I);
void insertion(LinkedList **a, void *b);
void printStringList(LinkedList *L);
void printIntList(LinkedList *L);
void printDoubleList(LinkedList *L);
void delete(LinkedList *L, void *n); 
```

我应该通过添加 void * item2 和 void * item3 ...来修改结构吗？或者有没有更好的方法来做到这一点。

我的第二个问题是：每次使用 void 指针时都必须对它们进行类型转换吗？这是我的代码`printIntList`

```
void printList(LinkedList *L)
{
    LinkedList *tmp = NULL;
    tmp = L;
    while(L)
    {
        printf("%d\n",*(int*)L->item);
        L=L->next;
    }
} 
```

我有`printIntList`和。有什么办法可以将它们结合起来吗？`printDoubleList``printStringList`

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:15:14.417

是的，您可能应该使用三个指针，或者某些形状可以没有颜色或大小？如果没有，您应该考虑创建三个指针，每个指针都有它们指向的类型，这样您就不必强制转换和删除类型。

该结构可能如下所示：

```
typedef struct linked{
    Size * size;
    Color* color;
    Shape* shape;
    struct linked * next;
    struct linked * prev;
}LinkedList; 
```

**如果您确实想在一个节点中存储更多相同类型的项目**（例如两种颜色......），您应该考虑使用[union](http://tigcc.ticalc.org/doc/keywords.html#union)。

要回答第二个问题......是的，你应该在`void`每次使用它们时都投射指针（至少在你的情况下=）。您应该再次考虑 union 以获得更漂亮的代码......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:15:23.387

> 我应该通过添加 void * item2 和 void * item3 ...来修改结构吗？或者有没有更好的方法来做到这一点。

这取决于您的列表的通用性。如果它用于保存一些特定的值，您可以创建它们全部，或者为它们创建一个结构，如果它可能保存不同类型的值，您可能想要创建一个联合，如果它可能在一个节点中保存许多值，您可能最好创建一些值数组。

> 每次使用 void 指针时都必须对它们进行类型转换吗？

当您分配给他们/从他们（`int * a = a_void_pointer`/ `a_void_pointer = an_int_pointer`）时 - 否

当您取消引用这样的指针 ( `*a_void_pointer`) - 是的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T00:18:16.290

您可以使用可区分的联合类型制作通用列表：

```
typedef struct listitem
{
  char type;
  union
  {
    integer i;
    double d;
    char *s;
    // etc.
  } u;
} Listitem; 
```

在您的 LinkedList 中使用此列表项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T00:20:59.007

你可以这样做：

```
typedef struct links {
    struct links * next;
    struct links * prev;
} links;

typedef struct outer_node {
  links l; // links to outer_node.l
  struct inner_node * children;
} outer_node;

typedef struct inner_node {
  links l; // links to inner_node.l
  char type;
  void * item;
} inner_node; 
```

基本上，你有一个链表，它的每个节点都是它自己的链表。

两个列表都使用相同类型的链接进行组织，因此您无需复制链接/取消链接代码。

您将需要使用`offsetof()`宏从指向`links`其容器的指针`inner_node`或`outer_node`.

这是一个完整的演示：

```
#include <stdio.h>
#include <stdlib.h>
#include <stddef.h>

typedef struct links {
    struct links * next;
    struct links * prev;
} links;

typedef struct outer_node {
  links l; // links to outer_node.l
  struct inner_node * children;
} outer_node;

typedef struct inner_node {
  links l; // links to inner_node.l
  char type;
  void * item;
} inner_node;

void linkNodes(links* l1, links* l2)
{
  links* tmp = l1->prev;
  l1->next->prev = l2->prev;
  l1->next = l2;

  l2->prev->next = tmp;
  l2->prev = l1;
}

inner_node* createNode(char type, void* item, inner_node* sibling)
{
  inner_node* n = malloc(sizeof(*n));
  n->type = type;
  n->item = item;
  n->l.prev = &n->l;
  n->l.next = &n->l;
  if (sibling != NULL)
    linkNodes(&n->l, &sibling->l);
  return n;
}

outer_node* createOuterNode(inner_node* child, outer_node* sibling)
{
  outer_node* n = malloc(sizeof(*n));
  n->l.prev = &n->l;
  n->l.next = &n->l;
  n->children = child;
  if (sibling != NULL)
    linkNodes(&n->l, &sibling->l);
  return n;  
}

void PrintList(links* l, int level)
{
  links* l2 = l;
  do
  {
    if (level == 0)
    {
      outer_node* n = (void*)((char*)l2 + offsetof(outer_node, l));
      printf("{\n");
      PrintList(&n->children->l, level + 1);
      printf("}\n");
    }
    else
    {
      inner_node* n = (void*)((char*)l2 + offsetof(inner_node, l));
      printf("  type: %d, item: %s\n", n->type, (char*)n->item);
    }
    l2 = l2->next;
  } while (l2 != l);
}

int main(void)
{
  outer_node* root = 
    createOuterNode(
      createNode(0, "something",
        NULL
      ),
      createOuterNode(
        createNode(1, "foo",
          createNode(2, "bar",
            NULL
          )
        ),
        createOuterNode(
          createNode(3, "red",
            createNode(3, "green",
              createNode(3, "blue",
                NULL
              )
            )
          ),
          createOuterNode(
            createNode(4, "cat",
              createNode(5, "dog",
                createNode(6, "raven",
                  createNode(7, "shark",
                    NULL
                  )
                )
              )
            ),
            NULL
          )
        )
      )
    );

  PrintList(&root->l, 0);

  return 0;
} 
```

输出（[ideone](http://ideone.com/6Np83i)）：

```
{
  type: 0, item: something
}
{
  type: 1, item: foo
  type: 2, item: bar
}
{
  type: 3, item: red
  type: 3, item: green
  type: 3, item: blue
}
{
  type: 4, item: cat
  type: 5, item: dog
  type: 6, item: raven
  type: 7, item: shark
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-02T00:37:15.393

您需要考虑每个元素定义的项目是否真的是动态的。颜色、尺寸、形状是否限制了您需要存储的物品？

如果这就是您真正需要的，为什么不保持简单并最小化间接/内存分配：

```
enum ShapeFlags { sizeDefined = 0x01, colorDefined = 0x02, shapeDefined = 0x04 };

typedef struct shapeList {
    ShapeFlags shapeFlags;
    Size  size;
    Color color;
    Shape shape;
    struct Linked * next;
    struct Linked * prev;
} ShapeList; 
```

另一方面，如果您确实拥有一组非常动态的属性，则列表列表的替代方法可能是拥有一个带有哨兵的列表。

```
enum FieldFlag { terminator = 0x01, size = 0x02, color = 0x04, shape = 0x08 };

typedef struct list
{
  FieldFlag type;
  void* value;
  struct list* next;
  struct list* previous;
} List; 
```

然后，您可以正常迭代并使用`terminator`标志来了解对象的结尾。

# php - 去除 我有一个返回 xml 的函数，但返回一个带有两个的 xml <?xml version="1.0"?> 标签 我无法修复呼叫以通过一个呼叫返回它。我尝试使用 SimpleXMLElement，所以当我将此 xml 加载到 simplexml 时，由于标签重复，它会出错 问问题 问问题 2013-04-02T00:03:03.980 2389 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有一个返回 xml 的函数，但返回一个带有两个的 xml <?xml version="1.0"?> 标签 我无法修复呼叫以通过一个呼叫返回它。我尝试使用 SimpleXMLElement，所以当我将此 xml 加载到 simplexml 时，由于标签重复，它会出错。任何人都知道我如何在加载到 xml 之前删除标签 我试过做 $new_xml = preg_replace('/<?xml(.*)?>(.*)?<\/?>/', '', $xml); 我也做过（顺便说一句。只是不确定它是否是最好的方法，因为我不确定内部是否有时会有更多信息 $xml = str_replace('<?xml version="1.0"?>', '', $xml); Pong Paddle 碰撞速度和反弹角 好吧，我为此搜索了很多，但我能找到的只是人们说像做 pi * 方向，方向是我假设的球进入的角度。但我的问题是，我不知道我是如何得到球进入的角度的，所以我无法做到这些。如果有人能解释我将如何计算球撞击桨帽的角度，反弹后球的速度量以及到那时它应该增加的角度，那就太棒了。 感谢您的所有回复！ 我的代码如下工作（所以你可以知道我想怎么做）： /* General Paddle Properties */ double PaddleLength = 80; //Down-wards length of the paddle double PaddleWidth = 8; //How thick the paddle is /* Positioning of user control paddle */ double UserPaddleTop = 0; //How far away from the top of the screen the paddle is double UserPaddleLeft = 10; //How far left from the side of the client rectangle it is /* Positioning of ai controled paddle */ double AIPaddleTop = 0; double AIPaddleLeft = 10; /* Ball properties and position */ double BallSize = 5; double BallTop = 0; double BallLeft = 0; double BallSpeedY = -0.01, BallSpeedX = -0.03; 方法： private void UpdateBall() { if (((int)(UserPaddleLeft + PaddleWidth) == (int)BallLeft) && !((int)UserPaddleTop > (int)BallTop) && !((int)(UserPaddleTop + PaddleLength) < BallTop) || ((int)(AIPaddleLeft - PaddleWidth) == (int)BallLeft) && !((int)AIPaddleTop > (int)BallTop) && !((int)(AIPaddleTop + PaddleLength) < BallTop)) //Collided { BallSpeedX = -BallSpeedX; //The height is 800 the balltop is 300 BallSpeedY = Math.Cos(BallSpeedX } if ((int)BallTop == 0 || (int)BallTop == ClientRectangle.Height) //Hit the top { BallSpeedY = -BallSpeedY; } if ((int)BallLeft == 0) { System.Diagnostics.Debug.WriteLine("AI gets one point!"); BallSpeedX = -0.03; //Goes towards the user AI has scored Scores[0]++; this.Title = "Pong Testing - Scores: " + Scores[0] + "|" + Scores[1]; ResetAll(); } else if ((int)BallLeft == ClientRectangle.Width) { System.Diagnostics.Debug.WriteLine("User gets one point!"); BallSpeedX = 0.03; //Goes towards the AI user has scored Scores[1]++; this.Title = "Pong Testing - Scores: " + Scores[0] + "|" + Scores[1]; ResetAll(); } BallLeft = (BallLeft + BallSpeedX); BallTop = (BallTop + BallSpeedY); } private void UpdateAI() { if(!((int)(BallTop + PaddleLength) == 0) && !( (int)(BallTop + PaddleLength) >= ClientRectangle.Height ) ) //Make sure updating it pos won't make it go out of bounds AIPaddleTop = BallTop; //Change to real ai by using offset } protected override void OnUpdateFrame(FrameEventArgs e) { base.OnUpdateFrame(e); if ( (int)UserPaddleTop != 0 && Keyboard[Key.Up]) { UserPaddleTop = UserPaddleTop - MoveSpeed; } else if (Keyboard[Key.Down] && (int)(UserPaddleTop + PaddleLength) != ClientRectangle.Height) { UserPaddleTop = UserPaddleTop + MoveSpeed; } } 更新 1： 感谢大家的帮助，我已经能够为它想出一些基本代码，但现在这个代码只是让球飞得太快，以至于不可能得到它。有人可以帮忙吗？ 代码： double AngleNormal = Math.Atan2(BallSpeedX,BallSpeedY); double AngleBallMovement = Math.Sqrt((BallSpeedX * BallSpeedX) + (BallSpeedY * BallSpeedY)); double ReflectionAngle = AngleNormal - (AngleBallMovement - AngleNormal); BallSpeedY = Math.Sin(ReflectionAngle); BallSpeedX = Math.Cos(ReflectionAngle); phpxmlxml-parsingpreg-replace 4 2 回答 2 This answer is useful 1 这将删除第一行直到结束 > 和尾随的换行符。 <?php $xml = "<?xml version=\"1.0\"?>\n\t<tag></tag>"; $xml = preg_replace('!^[^>]+>(\r\n|\n)!','',$xml); echo $xml; ?> 它也适用于不符合 1.0 版的其他 XML 文件。 于 2013-04-02T00:23:37.790 回答 This answer is useful 0 @AbsoluteƵERØ 的回答帮助了我。 在我的例子中，我自己创建了 XML。 $doc = new DOMDocument(); $doc->formatOutput = true; $root = $doc->createElement('TAG1'); $doc->appendChild($root); // ... some loop that inserts more children of TAG1 with attributes $xml_file = 'relative/path/to/file.xml'; $doc->save($xml_file); // Here the XML file is saved along with the line that poses problems // Read created XML $t_xml = file_get_contents($xml_file); // Remove first line $t_xml = preg_replace('!^[^>]+>(\r\n|\n)!', '', $t_xml); // Save into same file as original file_put_contents($xml_file, $t_xml); 于 2021-04-23T13:22:40.077 回答 Related 2 iphone - 动画时 pushViewController 不工作：否 1 ios - NSTimer 阻止其他动画 0 php - 如何在不改变页面位置的情况下执行mysql查询 1 eclipse - maven 不和我一起工作，是否缺少任何依赖项？ 1 python - 通过 matplotlib 将 2D 坐标系转换为 3D 1 git - 如何在 github 中由不同用户合并同一 repo 的所有分支 1 excel - 如何使用主键在 Excel 中创建“平均值”表？ 2 java - launch4j 中的 .exe 有效，但并非在所有计算机上都有效 8 java - 在浏览器（chrome/firefox）中运行本地 java 小程序“您的安全设置已阻止本地应用程序运行” 1 php - 如何 在php中用`替换所有新的字符串行？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15753933
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, xml, xml-parsing, preg-replace

我有一个返回 xml 的函数，但返回一个带有两个的 xml

```
 <?xml version="1.0"?> 
```

标签

我无法修复呼叫以通过一个呼叫返回它。我尝试使用 SimpleXMLElement，所以当我将此 xml 加载到 simplexml 时，由于标签重复，它会出错。任何人都知道我如何在加载到 xml 之前删除标签

我试过做

```
$new_xml = preg_replace('/<?xml(.*)?>(.*)?<\/?>/', '', $xml); 
```

我也做过（顺便说一句。只是不确定它是否是最好的方法，因为我不确定内部是否有时会有更多信息

```
 $xml = str_replace('<?xml version="1.0"?>', '', $xml); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:23:37.790

这将删除第一行直到结束 > 和尾随的换行符。

```
<?php
$xml = "<?xml version=\"1.0\"?>\n\t<tag></tag>";

     $xml = preg_replace('!^[^>]+>(\r\n|\n)!','',$xml);

echo $xml;
?> 
```

它也适用于不符合 1.0 版的其他 XML 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-23T13:22:40.077

@AbsoluteƵERØ 的回答帮助了我。

在我的例子中，我自己创建了 XML。

```
$doc = new DOMDocument();
$doc->formatOutput = true;

$root = $doc->createElement('TAG1');
$doc->appendChild($root);

// ... some loop that inserts more children of TAG1 with attributes

$xml_file = 'relative/path/to/file.xml';

$doc->save($xml_file); // Here the XML file is saved along with the line that poses problems

// Read created XML
$t_xml = file_get_contents($xml_file);

// Remove first line
$t_xml = preg_replace('!^[^>]+>(\r\n|\n)!', '', $t_xml);

// Save into same file as original
file_put_contents($xml_file, $t_xml); 
```

# javascript - 在 HTML 页面中隐藏用户的 JS/逻辑

> ID：15753935
> 
> 赞同：0
> 
> 时间：2013-04-02T00:03:14.627
> 
> 标签：javascript, obfuscation

我知道没有办法向用户隐藏加载到 HTML 页面中的 JS，但是对于我安排的接下来的几个项目（游戏），这确实造成了很大的问题 - 没有什么可以阻止勇敢的用户简单地打开安慰自己，比如说，再给自己二十条生命/在他们的分数上增加一百万。

代码混淆会使这变得更加困难，但并非不可能，而且让需要保护的东西在服务器/PHP 上运行似乎根本不切实际——无论如何，检索到的任何数据都可能再次被覆盖。类似地，可以使用闭包隐藏变量，但构造函数仍然可见，因此可以重写。

（我意识到在浏览器游戏中发生这种情况的可能性很低，但我认为这个问题值得讨论，因为数据安全/隐藏比游戏更进一步）

我不能使用 Flash，因为它们需要在移动设备上工作（出于同样的原因，applet OOQ），而且我确实需要将 JS 用于一个游戏的引擎，因为大量运行时代码是动态生成的/改变。

有没有人在 JS/HTML 游戏中向最终用户隐藏程序逻辑的实用或巧妙的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:07:59.123

对此没有真正的解决方案，您只能真正阻止或减慢用户的速度 - 而不是阻止他们。

我过去选择做的是这样的：

```
(function(){
    var Game = {
        // game object stuff.
    }
    // Game listeners
    window.addEventListener("load", function() {
        Game.init();
    });
})(); 
```

函数包装器从全局命名空间中隐藏了 Game 变量（因此在 JavaScript 控制台中，继续进行修改并不那么简单）。希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:10:12.830

服务器端验证是确保客户端完整性的唯一方法。

对不起 ：（

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T00:28:25.367

在这里，乔的想法是正确的。

您的解决方案是在闭包内运行所有内容。

没有的`Game.player.num_lives;`东西。

```
var Game = (function () {

    var game = {},

        import = function (module_name, module_constructor) {
        },

        public_interface = {
            import : import,
            load   : load,
            start  : start
        };

    return public_interface;
}());

/* player.js */
Game.import("player", function () { /* ... */ }); 
```

现在除了 running`.start();`之外，游戏之外应该没有任何交互。

这使得事情在结构方面变得更加复杂，并确保每个注入的对象都可以访问它需要的其他部分（最少）。

如果我们谈论的是单人游戏，那么现在篡改变得非常非常困难。
就多人游戏而言，这对于保护您的服务器免受客户端-服务器通信完全没有任何作用。通过手工制作发布到服务器的帖子来破解排行榜或“自动触发”等需要通过在服务器上运行游戏来处理，并且仅接受和验证客户端输入（并告诉客户端接下来会发生什么回复）。

# c# - Pong Paddle 碰撞速度和反弹角

> ID：15753937
> 
> 赞同：4
> 
> 时间：2013-04-02T00:03:30.470
> 
> 标签：c#, pong

好吧，我为此搜索了很多，但我能找到的只是人们说像做 pi * 方向，方向是我假设的球进入的角度。但我的问题是，我不知道我是如何得到球进入的角度的，所以我无法做到这些。如果有人能**解释**我将如何计算球撞击桨帽的角度，反弹后球的速度量以及到那时它应该增加的角度，那就太棒了。

感谢您的所有回复！

我的代码如下工作（所以你可以知道我想怎么做）：

```
/* General Paddle Properties */
double PaddleLength = 80;  //Down-wards length of the paddle
double PaddleWidth = 8;  //How thick the paddle is

/* Positioning of user control paddle */
double UserPaddleTop = 0;  //How far away from the top of the screen the paddle is
double UserPaddleLeft = 10;  //How far left from the side of the client rectangle it is

/* Positioning of ai controled paddle */
double AIPaddleTop = 0;
double AIPaddleLeft = 10;

/* Ball properties and position */
double BallSize = 5;
double BallTop = 0; 
double BallLeft = 0;
double BallSpeedY = -0.01, BallSpeedX = -0.03; 
```

方法：

```
private void UpdateBall()
        {
            if (((int)(UserPaddleLeft + PaddleWidth) == (int)BallLeft) && !((int)UserPaddleTop > (int)BallTop) && !((int)(UserPaddleTop + PaddleLength) < BallTop) 
                || ((int)(AIPaddleLeft - PaddleWidth) == (int)BallLeft) && !((int)AIPaddleTop > (int)BallTop) && !((int)(AIPaddleTop + PaddleLength) < BallTop)) //Collided
            {
                BallSpeedX = -BallSpeedX; //The height is 800 the balltop is 300
                BallSpeedY = Math.Cos(BallSpeedX
            }

            if ((int)BallTop == 0 || (int)BallTop == ClientRectangle.Height) //Hit the top 
            {
                BallSpeedY = -BallSpeedY;
            }

            if ((int)BallLeft == 0)
            {
                System.Diagnostics.Debug.WriteLine("AI gets one point!");
                BallSpeedX = -0.03; //Goes towards the user AI has scored
                Scores[0]++;
                this.Title = "Pong Testing - Scores: " + Scores[0] + "|" + Scores[1];
                ResetAll();
            }
            else if ((int)BallLeft == ClientRectangle.Width)
            {
                System.Diagnostics.Debug.WriteLine("User gets one point!");
                BallSpeedX = 0.03; //Goes towards the AI user has scored
                Scores[1]++;
                this.Title = "Pong Testing - Scores: " + Scores[0] + "|" + Scores[1];
                ResetAll();
            }

            BallLeft = (BallLeft + BallSpeedX);
            BallTop = (BallTop + BallSpeedY);
        }

        private void UpdateAI()
        {
            if(!((int)(BallTop + PaddleLength) == 0) && !( (int)(BallTop + PaddleLength) >= ClientRectangle.Height ) ) //Make sure updating it pos won't make it go out of bounds
                AIPaddleTop = BallTop; //Change to real ai by using offset
        }

        protected override void OnUpdateFrame(FrameEventArgs e)
        {
            base.OnUpdateFrame(e);

            if ( (int)UserPaddleTop != 0 && Keyboard[Key.Up])
            {
                UserPaddleTop = UserPaddleTop - MoveSpeed;
            }
            else if (Keyboard[Key.Down] && (int)(UserPaddleTop + PaddleLength) != ClientRectangle.Height)
            {
                UserPaddleTop = UserPaddleTop + MoveSpeed;
            }
        } 
```

更新 1：

感谢大家的帮助，我已经能够为它想出一些基本代码，但现在这个代码只是让球飞得太快，以至于不可能得到它。有人可以帮忙吗？

代码：

```
 double AngleNormal = Math.Atan2(BallSpeedX,BallSpeedY);
        double AngleBallMovement = Math.Sqrt((BallSpeedX * BallSpeedX) + (BallSpeedY * BallSpeedY));
        double ReflectionAngle = AngleNormal - (AngleBallMovement - AngleNormal);
        BallSpeedY = Math.Sin(ReflectionAngle);
        BallSpeedX = Math.Cos(ReflectionAngle); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:32:12.597

在最简单的意义上（忽略球旋转、摩擦、桨运动等）是计算相对于表面法线的入射角并将其反转。在简单物理碰撞的情况下，入射角是球在碰撞点相对于桨板表面法线的运动角度。在任意坐标空间中，计算类似于：

```
angleReflect = angleNormal - (angleBallMovement - angleNormal) 
```

对于一个真正的矩形桨的非常简单的情况，法线将垂直于桨的运动轴。这使您几乎无法控制球，因为反射角始终纯粹是球移动方向的函数。

您可以通过根据球撞击球拍中心的距离改变球拍表面的法线向量来模拟弯曲的球拍表面。这允许球员通过在球拍上偏离中心截取球来改变球的运动角度，以获得更陡或更浅的反射角。

真正有趣的是当您开始将摩擦、旋转和桨运动计算添加到混合中时。对大多数玩家来说有一点需要跟踪，但允许一些有趣的技巧投篮:)

--

至于***如何***计算角度，trig 函数`Math.atan2(x, y)`将为您提供给定 [x,y] 速度矢量的角度（以弧度为单位），并`Math.sqrt(x*x + y*y)`为您提供运动矢量的长度。这为您提供了一条线，您可以与桨的表面相交（考虑到球的半径，如果您要精确的话）以获得击球点。运动“线”的剩余部分使用入射角和您添加的任何其他计算来反映，给出球的最终位置和新的速度矢量。

激光笔和镜子是很好的可视化工具:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T02:45:06.327

为了计算角度，您必须知道球的移动方向。您的值中有这些`BallSpeedX`信息`BallSpeedY`。假设你的原始位置是 (0, 0)，`BallSpeedX`是 2，`BallSpeedY`是 3。所以你有一个直角三角形，一边是 2，另一边是 3，你可以使用简单的三角函数来计算角度。

现在，桨可能与 X 轴平行，因此您必须计算相对于该轴的角度。但这不应该太难。

一旦你知道球撞击球拍的角度，你只需从 180 度（或 pi 弧度）中减去该值，这就是新的角度。因此，如果球以 60 度角撞击球拍，它将以 120 度角反弹。这是假设没有旋转、完美的弹性、没有桨运动等。

球离开桨时的速度取决于您。您可以假设没有能量损失，并让球以与前进时相同的速度从桨上下来。或者您可以说弹跳吸收了球的 10% 的能量，在这种情况下，您希望将球的速度降低 10%（但不要只是从 X 和 Y 速度值中减去 10%，否则您会改变角度）。

现在一清二楚？

# javascript - YUI3 如何查看元素是否存在

> ID：15753945
> 
> 赞同：3
> 
> 时间：2013-04-02T00:05:55.313
> 
> 标签：javascript, css, yui3

如何判断 YUI3 中是否存在元素？

例如，如果`#noHero`存在，则将类名添加到`#header`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-17T11:07:39.930

如果您使用 来检查是否存在单个节点`Y.one()`，则以下操作将起作用：

```
var el = Y.one("#noHero");

if (el) {
  // do something
} 
```

但是，值得注意的是，`Y.all()`它将返回一个空`NodeList`值，其评估结果为真。在这种情况下，您应该使用`.size()`您的测试条件。

```
var els = Y.all(".noHero");

if (els.size()) {
  // do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T00:11:15.810

# [jsFiddle 演示](http://jsfiddle.net/mohammadAdil/hwf72/6/)

```
function findThis() {
    return Y.one("#noHero");
}

if (findThis()) {
   alert("found");
}
else{
  alert('not found');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-17T03:39:59.117

您可以尝试以这种方式使用

```
var mainDiv =Y.one("#noHero");

if ( mainDiv ) {
    mainDiv.addClass(".someClass");
} 
```

在上面的语句中，如果 YUI 找不到节点，它将返回“null”，这总是错误的

# html - 有人能告诉我为什么我的桌子是透明的吗？

> ID：15753949
> 
> 赞同：0
> 
> 时间：2013-04-02T00:06:34.143
> 
> 标签：html, css

我有一个正在处理的站点，我需要该表具有不透明的背景。

```
 <li>
            <div> some code </div>

    <div style="height:110px;" class="tableOwner">
        <img style="margin-top:30px;float:left;" src="/newimg/ClickShare.png"></img>

        <table border="0" class="tableShare" style="background-color:white !important;">
            <tbody style="background-color:white">
            <tr>
                <td><span class='st_sharethis' displayText='ShareThis' style="float:left;"></span></td> 
                <td><span class='st_facebook' displayText='Facebook' style="float:left;"></span></td>
            </tr>
            <tr>
                <td><span class='st_twitter' displayText='Tweet' style="float:left;"></span></td>
                <td><span class='st_blogger' displayText='Blogger' style="float:left;"></span></td>
            </tr>
            <tr>
                <td><span class='st_googleplus' displayText='Google +' style="float:left;"></span></td>
                <td><span class='st_linkedin' displayText='LinkedIn' style="float:left;"></span></td>
            </tr>
            <tr>
                <td><span class='st_pinterest' displayText='Pinterest' style="float:left;"></span></td>
                <td><span class='st_email' displayText='Email' style="float:left;"></span></td>
            </tr>
            </tbody>
        </table>

    </div>
</li> 
```

不幸的是，无论我做什么，无论我制作 table、tbody 还是 td 都有 background-color:white ...背景总是显示为透明的。span 中的类告诉浏览器从哪里获取 PNG 图像，但除此之外，表格的背景应该是白色而不是透明的。

帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T00:24:17.463

我在萤火虫中试过这个，它对我有用。

将此CSS应用于表格

```
.tableShare
{
position:relative;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:21:03.843

你的表没有内容；它使桌子没有大小；看：[小提琴](http://jsfiddle.net/ZyWJk/)

```
//you content on <td> or <span>

...<td><span class='st_sharethis' displayText='ShareThis' style="float:left;"> your content here </span></td>.. 
```

# ruby - 将 ruby api 转换为 rest api web 应用程序

> ID：15753950
> 
> 赞同：0
> 
> 时间：2013-04-02T00:06:43.440
> 
> 标签：ruby, ruby-on-rails-3, sinatra

我有一个 ruby​​ 应用程序，它基本上是一个 API 服务器——可以对该服务器的 IP 地址和端口进行调用——以访问这个应用程序。

现在，我希望将其转换为具有身份验证并遵循 REST 结构的常规 ruby​​ Web 应用程序。

最简单/最快的方法是什么？

我还希望核心 Ruby 代码（实际上为 API 提供支持）与 REST 绑定/身份验证模型分开——以便可以单独更新核心代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T01:06:55.120

就个人而言，我建议使用 Rails 和[Rabl](https://github.com/nesquena/rabl)。如果您关心 API 的版本控制（提示：您会的），那么[Version Cake](https://github.com/bwillis/versioncake) gem 也是绝对必须的。当第三方 API 从他们的脚下改变时，人们通常不喜欢它。

对于身份验证，我建议使用用户 ID 和令牌的组合，作为标头（即`X-YOURAPP-TOKEN = ryan-a003c850e1`）或作为操作的参数传入。然后通过在 上拆分此令牌`-`并找到用户记录，然后检查该用户的 API 密钥是否与令牌的其余部分匹配来完成“身份验证”。如果是这样，那么应该对用户进行身份验证。将用户记录存储在实例变量`@current_api_user`中，以便可以在控制器中访问它。

您的控制器设置在一个层次结构中，其中您有一个`BaseController`包含此身份验证逻辑（作为 a `before_filter`），然后其他控制器继承自该控制器。如果您有任何其他助手，他们也会进入此控制器。显然，我假设您此时对 Rails 有所了解。

对于授权，请使用[CanCan](https://github.com/ryanb/cancan)。它的 README 和 Wiki 是有关如何使用它的重要信息来源。您可能需要对您的 API 进行授权，即使您在最初的帖子中没有这样说。

使用与此类似的设置是我为 Spree 构建 API 的方式，您可以在此处查看：[https](https://github.com/spree/spree/tree/master/api) ://github.com/spree/spree/tree/master/api 。

* * *

其他人会推荐在 Rails上使用[Sinatra ，在 Rabl 上使用](http://sinatrarb.com)[Active Model Serializers](https://github.com/josevalim/active_model_serializers)。其他人仍然会建议您使用[超媒体 API](https://www.google.com.au/search?q=hypermedia+API)而不是传统的 REST 接口。甚至[有一本书](http://www.designinghypermediaapis.com/)关于如何做到这一点。

老实说，这取决于您决定使用什么。

# c# - 从数据表中的复选框中获取值

> ID：15753951
> 
> 赞同：0
> 
> 时间：2013-04-02T00:07:00.433
> 
> 标签：c#, html, asp.net-mvc

我有一个数据表，我在每一行旁边都写了复选框。但是，当我提交页面时，没有任何东西传递给我的方法。任何帮助表示赞赏！我的代码如下

模型：

```
foreach (int analysis in ChemList.Select(d => d.analysisId).Distinct())
        {
            DataRow dr = GridData.NewRow();
            GridData.Rows.Add(dr);
            GridData.Rows[gridrow][0] = "<input type='checkbox' value="+checknum+"    checked>";
            GridData.Rows[gridrow][1] = ChemList[listrow].analysisId;
            GridData.Rows[gridrow][2] = ChemList[listrow].analysisTime;
            GridData.Rows[gridrow][3] = ChemList[listrow].sampleType;
            GridData.Rows[gridrow][4] = ChemList[listrow].productId; 
```

确保写入复选框的模板：

```
@using System;
@model TheManhattanProject.Models.CellValueViewModel
<td>
@{if(Model.Value.StartsWith("<input type='checkbox'"))
{

        @Html.Raw(Model.Value);

}
else
{

        @Html.DisplayFor(x => x.Value);

}
}
</td> 
```

看法：

```
@using (Html.BeginForm("Average", "Home", "POST"))
{
<input type="submit" value="Average" />
<div id="grid">
    <table id="example"  class ="gridTable">
        <thead class="gridHead">
            <tr>
              @Html.DisplayFor(x => x.Columns)
            </tr>
        </thead>
        <tbody>
             @Html.DisplayFor(x => x.Rows)
        </tbody>
    </table>
    </div>
} 
```

控制器方法（只是一个占位符，但值保持为空）：

```
 [HttpPost]
    public ActionResult Average(params int[] values)
    {

        return RedirectToAction("Index");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T02:15:56.153

您的控制器将采用您期望它通常采用的任何内容，`FormCollection collection`并通过其`name`属性获取复选框：`collection["checkBoxName"]`

# jquery - 如何使用 CSS 或 jQuery 强制行内块换行到新行？

> ID：15753953
> 
> 赞同：0
> 
> 时间：2013-04-02T00:07:24.423
> 
> 标签：jquery, html, css

我有十件物品。我如何做到两行，每行有五个项目？

HTML：

```
<ul>
    <li>item1</li>
    <li>item2</li>
    //...
    <li>item5</li>
    //newline
    <li>item6</li>
    <li>item10</li>
<ul> 
```

CSS：

```
ul li { display: inline-block; } 
```

注意，我必须使用`inline-block`而不是`inline`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T00:17:11.907

你可以试试这个

```
$( "ul li" ).eq( 4 ).after( "<br />" ); 
```

[**演示**](http://jsfiddle.net/AFdtz/)

# php - 远程表单网络应用程序

> ID：15753954
> 
> 赞同：0
> 
> 时间：2013-04-02T00:07:47.853
> 
> 标签：php, javascript, curl

我想实现我自己的个人网络应用程序，它需要一堆个人信息并在一个远程不同的网站上填写一份工作申请。我打算使用的语言是 PHP。根据网络上的一些文章，我可能会在这种情况下使用 php_curl。

我想就这个特定主题（使用 php 操作远程网站）获得一些建议，因为我对 php_curl 没有太多经验。

我想知道这种类型的网络应用程序是否可以使用 javascript / php / mysql？我应该使用什么技术，或者我会遇到什么类型的陷阱？

*这类似于已经提出的问题，但我重新制作了它，因为我无法查看帖子上的任何答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T06:48:39.793

您可能会花费更多的时间来尝试构建一个自动化的解决方案来执行此操作，而不是您实际上只是手动填写表单。即使每个站点都有一个 API 来输入此信息（这将是执行此操作的最简单方法），但每次集成可能只需将您的信息剪切/粘贴到网站中即可。

如果没有 API，您需要弄清楚在提交表单时基本上伪造对每个站点的 POST 请求。您可能需要通过登录过程存储和发送 cookie，以便能够处理管理会话 cookie 之类的事情。

我只是没有为您看到可行的前进方式。

# java - 收集未提交的表单值

> ID：15753955
> 
> 赞同：1
> 
> 时间：2013-04-02T00:07:51.027
> 
> 标签：java, php, forms, submit, form-submit

是否可以从废弃的表单中获取数据？

前任：

姓名：Jim Hancock 地址：1223 Fruitville Dr. 电话：845-525-1156 电子邮件：Jim.c

（提交按钮）

在上面的例子中：在没有点击提交按钮的情况下，用户要么导航到另一个页面，要么完全关闭浏览器，现在我没有数据，而实际上这个人完成了表单的 75%......

有什么想法还是不允许这种类型的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:09:07.483

这种事情可以用ajax来完成。每隔一段时间，只需通过 ajax 请求提交他们拥有的表单数据。如何存储它以及如何实现这样的系统超出了诸如此类的简单问题的范围。但这是可以完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-21T09:03:58.427

您不想将所有未提交的表单保留在数据库中。而是使用 javascript 和 cookie。看看 javascript 库：[Garlic.js](http://garlicjs.org/)

# html - CKEditor 去除内联属性

> ID：15753956
> 
> 赞同：25
> 
> 时间：2013-04-02T00:07:55.547
> 
> 标签：html, ckeditor, strip-tags

我使用 CKEditor 已经有一段时间了，效果很好。我几乎摆脱了我遇到的任何问题，但我似乎无法弄清楚这一点。当我向元素添加内联属性时，例如`style = "color: #ff0;"`在`<p></p>`标签上，当我从所见即所得切换到源视图时，它们会被剥离。没有保存或提交，并且 ckeditor 已添加到我的站点，这是我自己的脚本。关于什么会导致这种情况的任何想法。我能找到的所有搜索结果都与 Drupal 中发生的这种情况相对应，但 Drupal 似乎不是所有情况下的编辑器的问题。再次感谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-02T07:19:36.047

感觉就像您使用的是[高级内容过滤器 (ACF)](http://docs.ckeditor.com/#!/guide/dev_advanced_content_filter)附带的 CKEditor 4.1+ 。如果是这样，您需要指定`config.allowedContent`并[配置它](http://docs.ckeditor.com/#!/guide/dev_allowed_content_rules)以使您的工作正常。您可能还对[`config.extraAllowedContent`](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-extraAllowedContent).

有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/15659962/1464696)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-02-19T14:43:34.563

对于正在寻找有关如何在不完全禁用 ACF 的情况下在 CKEditor 中启用附加标记的简单示例的任何人，这里有一个简短的片段：

```
CKEDITOR.replace( 'editor1', {
    extraAllowedContent: 'style;*[id,rel](*){*}'
} ); 
```

[这里的extraAllowedContent](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-extraAllowedContent)启用`<style>`元素，允许所有（`*`是通配符）已经允许的元素的两个附加属性（在方括号中），允许`(*)`为它们使用任何类名并允许使用任何内联样式`{*}`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-13T07:10:23.160

您好，您可以轻松停止 ACF。默认情况下，您的配置是---

```
function ckeditor($name,$value='',$height=300){
    return '<textarea name="'.addslashes($name).'">'.htmlspecialchars($value).'</textarea>
<script>$(function(){CKEDITOR.replace("'.addslashes($name).'",{});});</script>';
} 
```

只需将其添加到大括号中：

```
allowedContent: true 
```

现在您的配置将是：

```
function ckeditor($name,$value='',$height=300){
    return '<textarea name="'.addslashes($name).'">'.htmlspecialchars($value).'</textarea>
<script>$(function(){CKEDITOR.replace("'.addslashes($name).'",{allowedContent: true});});</script>';
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-30T11:43:33.167

我遇到了同样的问题，下面的答案解决了我的问题：

```
config.allowedContent = true;
config.extraAllowedContent = '*(*);*{*}';
config.extraAllowedContent = 'span;ul;li;table;td;style;*[id];*(*);*{*}'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-06T10:49:27.213

我遇到了同样的问题，在使用此方法时，ck 在粘贴块元素时，在块元素内（在 ap 中粘贴了一些属性的 div）不仅剥离了一些属性，而且剥离了整个元素：

```
editor.insertHtml(html); 
```

解决问题的方法是使用此解决方法：

```
editor.insertElement(CKEDITOR.dom.element.createFromHtml(html)); 
```

# excel - 多个 IF AND 语句表现出色

> ID：15753961
> 
> 赞同：10
> 
> 时间：2013-04-02T00:08:13.153
> 
> 标签：excel

我需要根据两个不同单元格中的文本在 Excel 中编写“if”语句。

```
If E2 ='in play'   and F2 ='closed'      output 3 
If E2= 'in play'   and F2 ='suspended'   output 2
If E2 ='In Play'   and F2 ='Null'        output 1 
If E2 ='Pre-Play'  and F2 ='Null'        output -1
If E2 ='Completed' and F2 ='Closed'      output 2
If E2 ='Suspended' and F2 ='Null'        output 3
If anything else output -2 
```

其中 Null 是单元格中没有值

我试图用下面的代码来做到这一点，但我似乎无法让两个或多个 IF AND 语句一起工作。我怎么解决这个问题？

```
=IF(AND(E2="In Play",F2="Closed"),3, -2), IF(AND(E2="In Play",F2=" Suspended"),3,-2) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-02T00:37:27.350

考虑到您有多个“测试”，例如，

1.  如果 E2 = 'in play' 并且 F2 = 'close'，输出 3
2.  如果 E2 = 'in play' 并且 F2 = 'suspended'，输出 2
3.  等等。

您真正需要做的是在`False`参数中进行连续测试。您目前正尝试用逗号分隔每个测试，但这是行不通的。

您的前三个测试都可以加入一个表达式，例如：

`=IF(E2="In Play",IF(F2="Closed",3,IF(F2="suspended",2,IF(F2="Null",1))))`

请记住，每个后续测试都需要是前一个测试的嵌套 FALSE 参数，您可以这样做：

`=IF(E2="In Play",IF(F2="Closed",3,IF(F2="suspended",2,IF(F2="Null",1))),IF(AND(E2="Pre-Play",F2="Null"),-1,IF(AND(E2="completed",F2="closed"),2,IF(AND(E2="suspended",F2="Null"),3,-2))))`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-02T00:30:59.107

使用您的 AND，您不应该有一个 FALSE 值 -2，直到最后，例如只有 2 个 AND

`=IF(AND(E2="In Play",F2="Closed"),3,IF(AND(E2="In Play",F2=" Suspended"),3,-2))`

虽然嵌套 IF 和 AND 的组合可能会更好 - 尝试这样的完整公式：[编辑 - 谢谢大卫]

`=IF(E2="In Play",IF(F2="Closed",3,IF(F2="Suspended",2,IF(F2="Null",1))),IF(AND(E2="Pre-play",F2="Null"),-1,IF(AND(E2="Completed",F2="Closed"),2,IF(AND(E2="Pre-play",F2="Null"),3,-2))))`

为了避免像上面这样的长公式，您可以在 K2:K5 等列中创建一个包含所有 E2 可能性的表，在 L1:N1 等行中创建所有 F2 可能性然后在 L2:N5 中填写所需的结果并使用此公式

`=INDEX($L$2:$N$5,MATCH(E2,$K$2:$K$5,0),MATCH(F2,$L$1:$N$1,0))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T13:35:46.853

尝试以下操作：

```
=IF(OR(E2="in play",E2="pre play",E2="complete",E2="suspended"),
IF(E2="in play",IF(F2="closed",3,IF(F2="suspended",2,IF(ISBLANK(F2),1,-2))),
IF(E2="pre play",IF(ISBLANK(F2),-1,-2),IF(E2="completed",IF(F2="closed",2,-2),
IF(E2="suspended",IF(ISBLANK(F2),3,-2))))),-2) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-01-26T22:35:22.253

让这两个交流

```
=IF(OR(AND(MID(K27,6,1)="N",(MID(K27,6,1)="C"),(MID(K27,6,1)="H"),(MID(K27,6,1)="I"),(MID(K27,6,1)="B"),(MID(K27,6,1)="F"),(MID(K27,6,1)="L"),(MID(K27,6,1)="M"),(MID(K27,6,1)="P"),(MID(K27,6,1)="R"),(MID(K27,6,1)="P"),ISTEXT(G27)="61"),AND(RIGHT(K27,2)=G27)),"Good","Review")

=IF(AND(RIGHT(K27,2)=G27),"Good","Review") 
```

# mahout - 如何根据评级制作 Mahout 稀疏向量？

> ID：15753964
> 
> 赞同：2
> 
> 时间：2013-04-02T00:08:31.630
> 
> 标签：mahout, arff

有[一个从文本创建 Mahout Vector 对象的示例](https://cwiki.apache.org/MAHOUT/creating-vectors-from-text.html)。它说：

> 在创建向量之前，您需要将文档转换为 SequenceFile 格式。SequenceFile 是一个 hadoop 类，它允许我们将任意键值对写入其中。DocumentVectorizer 要求键是具有唯一文档 ID 的文本，值是 UTF-8 格式的文本内容。

这有点清楚，因为我知道 SequenceFile 是什么。然而，对于所有 Mahout 算法（聚类、分类等），内容实际上是一个词袋（或 n-gram）。值是否被视为空格分隔？

更重要的是，我实际上想对非文本的内容进行聚类。例如，假设我有用户以空格分隔格式对电影进行评分：

```
user1 movie_11 5
user1 movie_12 4
..
user2 movie_21 1
user2 movie_22 5
.. 
```

假设我想对电影进行聚类。我可以将用户视为“文档”（电影分组），将电影视为“单词”。我如何将这些评级转换为矢量文件？我可以将其转换为[arff](http://www.cs.waikato.ac.nz/~ml/weka/arff.html)（还不确定如何）并使用 Mahout 的[arff.vector](https://cwiki.apache.org/MAHOUT/creating-vectors-from-wekas-arff-format.html)。有没有一个更简单的实用程序，只需要文档到单词的关联（或计数）并制作向量？

不必将 1 亿个评级作为 ARFF 放在磁盘上只是为了将其放入序列文件中，而只是为了将其放入向量中，这将是很方便的。

# asp.net - 将 LINQDataSource 连接到内存中的集合（通用列表）

> ID：15753965
> 
> 赞同：1
> 
> 时间：2013-04-02T00:08:35.707
> 
> 标签：asp.net, vb.net, linq

所以我有一个我正在尝试使用升级的 asp.net 应用程序。我想要完成的是使用一个下拉列表中选择的值来确定第二个下拉列表中显示的值。为此，我创建了两个 DDL，并将它们绑定到标记中的 LINQDataSource 对象。我想我要做的是将第二个 LinqDatasource 绑定到我在表单 Load 上创建的 List(of tablename) 列表，这样我就可以将集合放在内存中并且可以在客户端运行 LINQ，因此我可以动态确定返回集数据源以及下拉列表中的值。

我看到你可以将你的 LinqDataSource 指向一个列表，只要列表是一个属性。因此，我尝试了以下操作，但收到错误消息，提示找不到我的课程。

```
<asp:DropDownList ID="ddlTitle" runat="server" DataTextField="Title" DataValueField="Title"
        DataSourceID="ViolationTitles" Width="203px" >
    </asp:DropDownList>

        <asp:DropDownList ID="ddlChapters" runat="server" 
        DataTextField="FullChapterName" DataValueField="Chapter_Number"
        DataSourceID="ViolationChapters" Width="203px">
    </asp:DropDownList>

    <asp:LinqDataSource ID="ViolationTitles" runat="server" 
        ContextTypeName="ARS_LINQ_Connections.ARSDataContext" EntityTypeName="" Select="new (key as Title, it as Violation_Title_Chapters)" 
        TableName="Violation_Title_Chapters" GroupBy="Title">
    </asp:LinqDataSource>

    <asp:LinqDataSource ID="ViolationChapters" runat="server"
    ContextTypeName="Test"  
        EntityTypeName="" 
        TableName="rsViolations" 
        Select='new (Title, Chapter_Number, Chapter_Name, String.Concat(Chapter_Number + ". " + Chapter_Name) as FullChapterName)'>
    </asp:LinqDataSource> 
```

代码背后

```
Public Class Test
    Inherits System.Web.UI.Page
    Public Property rsViolations As New List(Of Violation_Code)

    Dim arslinq As New ARS_LINQ_Connections.ARSDataContext
    Dim rsTitles As New List(Of Violation_Title_Chapter)

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        rsViolations = (From v In arslinq.Violation_Codes).ToList
        rsTitles = (From t In arslinq.Violation_Title_Chapters).ToList

    End Sub
End Class 
```

# salesforce - Salesforce：是否可以在对象概览页面的每一行中添加自定义 url？

> ID：15753977
> 
> 赞同：1
> 
> 时间：2013-04-02T00:10:15.070
> 
> 标签：salesforce

我知道可以在列表视图顶部添加按钮以及新按钮，但是是否可以在每一行中添加自定义按钮/链接？或者我必须使用自定义动态字段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T09:59:06.717

当您创建一个新的自定义按钮/链接时，您可以选择“详细页面链接”来实现它。

![在此处输入图像描述](https://i.stack.imgur.com/ML9O0.gif)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T11:29:16.947

如果您想要的东西本质上是指向其他地方的链接 - 正如@Jair 所示，“自定义链接”将是最好的解决方案。

但是，这只会显示在详细视图页面上，如果您想在列表视图（在对象的选项卡上）或报表等位置查看此链接，则此链接将不起作用。为了实现这一点 - 创造一个新的领域。该字段可以是 URL 类型（如果它必须是可编辑的......或者您可能想使用一些工作流程来填写它？）。

或者 - 如果它不必是可编辑的 - 创建一个新的公式字段（类型 = 文本），然后您可以使用类似的功能[`HYPERLINK()`](https://help.salesforce.com/apex/HTViewHelpDoc?id=customize_functions_a_h.htm&language=en_US#HYPERLINK)来实现您想要的。

# ios - ios - 我的应用从 ios 6.0 切换到 5.0 时应该注意什么？

> ID：15753980
> 
> 赞同：1
> 
> 时间：2013-04-02T00:10:28.107
> 
> 标签：ios, objective-c, xcode, ios5, ios6

我出于某种原因，不知道为什么，最初发布了一个部署目标为 6.0 的应用程序，但我真正想要的是让每个人都能够使用该应用程序，所以我真的需要选择 5.1 或 5.0

我正在考虑将部署目标更改为 5.0，但我不确定更改回来的后果是什么。这是一个使用故事板的商业应用程序。

非常感谢您的建议谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T02:21:53.577

无法给出简单的答案。你只需要疯狂地测试。就个人而言，我认为如果你为 iOS 6 编写了应用程序，试图让它向后兼容 iOS 5 是一个失败的原因。但是，如果必须的话，请尝试一下……以下是一些要点：

*   视图控制器旋转/方向的处理完全不同。iOS 6 使用 Info.plist 设置以及`supportedInterfaceOrientations`. iOS 5，呃，没有。它使用完全不同的规则来确定旋转。

*   正如你所知道的，如果 iOS 5 甚至加载了打开了自动布局的故事板或 nib，kaboom。

*   两个系统之间的文本绘制有很大不同；相同的文本最终可能会以不同的方式绘制。当然，NSAttributedString 的东西在 iOS 6 中是新的。

*   UILabel sizeToFit 在两者之间表现不同。

*   iOS 6 需要一堆权限才能访问各种用户库；iOS 5 没有。

*   手势识别器与其视图的子视图交互的方式有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:34:22.103

将我的应用程序切换回 iOS 5 时遇到的一个大问题是**“使用自动布局”**设置，该设置**仅在 iOS 6 上受支持**，您必须重新检查整个情节提要视图并在**“文件检查器”下取消选中它”**。当然禁用它意味着您需要手动编写一些代码行来重新管理所有视图控制器。除此之外，没有什么特别值得一提的。

# ruby-on-rails - 安装 ImageMagick 时出错（使用 Brew）

> ID：15753985
> 
> 赞同：1
> 
> 时间：2013-04-02T00:10:55.590
> 
> 标签：ruby-on-rails, imagemagick, paperclip, homebrew

我正在尝试使用 brew 安装 ImageMagick，但不断收到以下信息：

我运行命令：`brew install magic

但是得到这个：`

```
Error: undefined local variable or method `x11' for #<X11Dependency::Proxy::Freetype:0x10b827858> 
```

**帮助！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T05:11:59.103

这看起来是[今天刚刚修复](https://github.com/mxcl/homebrew/commit/17e83c4f242464c36648b147bb10ed1c89448f55)的 Homebrew 错误。您的 Homebrew 是否具有最新的公式和支持文件？尝试更新它：

```
brew update 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T05:37:26.717

我认为您需要更新 brew 安装

```
cd /usr/local
brew update
git reset --hard FETCH_HEAD 
```

然后尝试

```
brew install imagemagick 
```

# c - 我如何对最后一个 else 语句不做任何事情，然后继续到数组的下一部分？

> ID：15753986
> 
> 赞同：2
> 
> 时间：2013-04-02T00:11:03.523
> 
> 标签：c, arrays, if-statement

我该怎么办

如果我输入“a a”并在我期望它返回“b b”时将其移动，但是我收到一个错误，我希望 for 循环跳过任何不是 AZ、az 或 0-9 的内容

```
for ( ; i <= w; i++)

    if ((word[i] + rotx) >= 65 && (word[i] + rotx) <=90)
    {
        word[i] += (rotx);
    }
    else if ((word[i] + rotx) >= 97 && (word[i] + rotx) <=122)
    {
        word[i] += (rotx);
    }
    else if ((word[i] + rotx) >= 48 && (word[i] +rotx) <= 57)
    {
        word[i] += (rotx);
    }
    else if ((word[i] + rotx) > 90 && (word[i]+rotx) <97)
    {
        word[i] = 64 + (rotx - (90-word[i]));
    }
    else if ((word[i] + rotx) > 122)
    {
        word[i] = 96 + (rotx - (122-word[i]));
    }
    else if ((word[i] + rotx) > 57)
    {
        word[i] = 47 + (rotx - (57-word[i]));
    } 
```

OUTPUT 输入字符串“a a” 输入旋转 1

-bash：1：找不到命令

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T00:13:04.033

你可以不使用其他。或者使用一个`continue`语句，如果你希望 else 在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T00:14:25.113

如果您希望您的程序刚刚落入下一条语句，请不要包含您所显示的 body 的另一`else`部分。`empty`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T00:20:21.737

我认为最后一个 else 语句的意思是 < 57。除此之外，您不仅可以调用超过 122 和小于 57 的语句，然后还有 else word[i] += (rotx); ??

对不起，90到97之间。

或者使用 switch 语句会更经济。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T00:39:49.983

如果你想让你的最后一个`else`什么都不做，你可以使用`continue`里面的关键字。`{}`对于任何条件，您可以通过为其定义一个空代码块或简单地省略大小写来定义条件不做任何事情。如果您希望 case 在`switch`语句中不执行任何操作，则可以为它定义一个空块`{}`，也可以使用`break`关键字。或者，您只是不理会给定的案例。

至于您对问题的编辑，我不确定您的代码中的 rotx 是什么以及您试图实现什么。当你寻求帮助时，这些不能省略，否则就像说“我的代码不起作用，请帮助”，你可能知道没有人想要/能够猜测你的任务要求。所以，在指定任务时请多加注意，记住，如果你帮助社区帮助你，社区愿意帮助你。

# php - 如何在 PHP 中显示来自 rss 提要的图像？

> ID：15753990
> 
> 赞同：0
> 
> 时间：2013-04-02T00:11:52.463
> 
> 标签：php, rss

我正在尝试在 PHP 文件中显示来自 rss 提要的图像。

php 文件非常简单，而且没有太多内容。

RSS 提要也来自天空新闻。

我得到的 php 文件将提取我需要的所有信息并显示它们，但我不完全确定如何显示图像。

这是我的 php 代码：

```
<?php
$rss = simplexml_load_file('http://www.skysports.com/rss/0,20514,11959,00.xml');

echo '<h1>'. $rss->channel->title . '</h1>';

foreach ($rss->channel->item as $item) {
   echo '<h2><a href="'. $item->link .'">' . $item->title . "</a></h2>";
   echo "<p>" . $item->pubDate . "</p>";
   echo "<p>" . $item->description . "</p>";
} 
?> 
```

这是 xml RSS 提要的结构：

```
<?xml version="1.0" encoding="iso-8859-1" ?>

        <?xml-stylesheet title="XSL_formatting" type="text/xsl" href="http://www.skysports.com/styles/rss-render/0,26674,,00.xsl"?>         
         <rss version="2.0">
            <channel>

                    <title>Sky Sports | Football News</title>
                 <link>http://www.skysports.com</link>

                <description>Europa League News</description>
                 <language>en-gb</language>
                <lastBuildDate>Wed, 27 Mar 2013 18:20:18 GMT</lastBuildDate>
                <copyright>Copyright 2013, BSKYB. All Rights Reserved.</copyright>                      
                <category>Football</category>
                <image>
                    <title>Sky Sports</title>
                    <url>http://www.skysports.com/Images/skysports/site/ss-logo-07.gif</url>
                    <link>http://www.skysports.com</link>                       
                </image>
                <ttl>120</ttl>                              

            <item><title><![CDATA[Cisse eyes glory]]></title><description><![CDATA[Papiss Cisse is confident that Newcastle's season can finish in glory.]]></description><link>http://www1.skysports.com/football/news/11959/8601723/</link><guid isPermaLink="false">11959_8601723</guid><pubDate>Wed, 27 Mar 2013 18:12:36 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/02/128x67/Newcastle-v-Metalist-Kharkiv-Papiss-Cisse_2900940.jpg" length="123456" /></item>

            <item><title><![CDATA[Chelsea clash moved to Moscow]]></title><description><![CDATA[UEFA has confirmed that Chelsea's Europa League quarter-final second-leg with Rubin Kazan has been moved to the Luzhniki Stadium in Moscow.]]></description><link>http://www1.skysports.com/football/news/11959/8580924/</link><guid isPermaLink="false">11959_8580924</guid><pubDate>Thu, 21 Mar 2013 10:43:18 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Rubin-Kazan-v-Levante-Jos-Rondon-Sergio-Balle_2915002.jpg" length="123456" /></item>

            <item><title><![CDATA[UEFA opens Inter 'abuse' case]]></title><description><![CDATA[UEFA has announced that a disciplinary case is to be opened against Inter Milan, following reports of fans racially abusing Tottenham players during last Thursday's Europa League game at the San Siro.]]></description><link>http://www1.skysports.com/football/news/11959/8575656/</link><guid isPermaLink="false">11959_8575656</guid><pubDate>Mon, 18 Mar 2013 12:26:33 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Inter-Milan-v-Tottenham-Emmanuel-Adebayor_2915019.jpg" length="123456" /></item>

            <item><title><![CDATA[Gallas wants racism reaction]]></title><description><![CDATA[Tottenham defender William Gallas says walking off the pitch is an understandable reaction to racist abuse and has called on UEFA to respond after chants marred Thursday's game with Inter Milan.]]></description><link>http://www1.skysports.com/football/news/11959/8569919/</link><guid isPermaLink="false">11959_8569919</guid><pubDate>Sat, 16 Mar 2013 11:09:25 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/12/08/128x67/William-Gallas-Tottenham-vs-Valencia_2811170.jpg" length="123456" /></item>

            <item><title><![CDATA[Spurs want tough UEFA stance]]></title><description><![CDATA[Tottenham Hotspur have told Sky Sports they want UEFA to 'make a stand' against racism after their players were abused at Inter Milan on Thursday.]]></description><link>http://www1.skysports.com/football/news/11959/8567989/</link><guid isPermaLink="false">11959_8567989</guid><pubDate>Fri, 15 Mar 2013 13:45:03 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Inter-Milan-v-Tottenham-Jake-Livermore-Antoni_2915000.jpg" length="123456" /></item>

            <item><title><![CDATA[Pardew: Perfect Europa draw]]></title><description><![CDATA[Alan Pardew was delighted as Newcastle were drawn to face Benfica in the quarter-finals of this season's Europa League.]]></description><link>http://www1.skysports.com/football/news/11959/8567905/</link><guid isPermaLink="false">11959_8567905</guid><pubDate>Fri, 15 Mar 2013 13:18:54 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Alan-Pardew-Beard_2910689.jpg" length="123456" /></item>

            <item><title><![CDATA[Bernstein slams Spurs abuse]]></title><description><![CDATA[Football Association chairman David Bernstein has condemned the racist abuse directed towards some Tottenham players in their Europa League game with Inter Milan on Thursday night.]]></description><link>http://www1.skysports.com/football/news/11959/8567723/</link><guid isPermaLink="false">11959_8567723</guid><pubDate>Fri, 15 Mar 2013 12:33:42 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/12/09/128x67/Bernstein_2827663.jpg" length="123456" /></item>

            <item><title><![CDATA[English trio are kept apart]]></title><description><![CDATA[The three Premier League clubs have been kept apart in the Europa League quarter-final draw.]]></description><link>http://www1.skysports.com/football/news/11959/8567594/</link><guid isPermaLink="false">11959_8567594</guid><pubDate>Fri, 15 Mar 2013 11:58:29 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/12/12/128x67/trophy_2871143.jpg" length="123456" /></item>

            <item><title><![CDATA[UEFA waits on Inter decision]]></title><description><![CDATA[UEFA has confirmed they do not expect to make a decision on Friday over whether to open a case against Inter Milan after some of their fans racially abused Tottenham players.]]></description><link>http://www1.skysports.com/football/news/11959/8567161/</link><guid isPermaLink="false">11959_8567161</guid><pubDate>Fri, 15 Mar 2013 09:55:55 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Inter-Milan-v-Tottenham-Emmanuel-Adebayor_2915019.jpg" length="123456" /></item>

            <item><title><![CDATA[Pardew: Europa glory possible]]></title><description><![CDATA[Alan Pardew believes Newcastle United are capable of winning the Europa League after making their way into the quarter-finals.]]></description><link>http://www1.skysports.com/football/news/11959/8566927/</link><guid isPermaLink="false">11959_8566927</guid><pubDate>Fri, 15 Mar 2013 08:24:22 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Alan_2915255.jpg" length="123456" /></item>

            <item><title><![CDATA[Benitez: Torres back on track]]></title><description><![CDATA[Chelsea interim manager Rafael Benitez believes Fernando Torres has fresh confidence, despite his penalty miss in the Europa League victory over Steaua Bucharest.]]></description><link>http://www1.skysports.com/football/news/11959/8566349/</link><guid isPermaLink="false">11959_8566349</guid><pubDate>Fri, 15 Mar 2013 00:06:25 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/benitez_2915142.jpg" length="123456" /></item>

            <item><title><![CDATA[Cech content with 'big win']]></title><description><![CDATA[Chelsea goalkeeper Petr Cech felt his side were always capable of seeing off Steaua Bucharest in the UEFA Europa League to advance to the quarter-finals but was relieved to get the job done.]]></description><link>http://www1.skysports.com/football/news/11959/8566291/</link><guid isPermaLink="false">11959_8566291</guid><pubDate>Thu, 14 Mar 2013 23:15:00 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/02/128x67/Cech1_2904805.jpg" length="123456" /></item>

            <item><title><![CDATA[Stramaccioni proud of Inter]]></title><description><![CDATA[Inter Milan head coach Andrea Stramaccioni hailed his side's monumental effort as they very nearly pulled off a shock triumph against Tottenham in the UEFA Europa League.]]></description><link>http://www1.skysports.com/football/news/11959/8566278/</link><guid isPermaLink="false">11959_8566278</guid><pubDate>Thu, 14 Mar 2013 23:01:16 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Inter-Milan-v-Tottenham-Andrea-Stramaccioni_2915006.jpg" length="123456" /></item>

            <item><title><![CDATA[Pardew salutes super Cisse]]></title><description><![CDATA[Alan Pardew saluted more last-gasp heroics from Papiss Cisse after his dramatic lone goal against Anzhi Makhachkala sent Newcastle through to the Europa League quarter-finals.]]></description><link>http://www1.skysports.com/football/news/11959/8566265/</link><guid isPermaLink="false">11959_8566265</guid><pubDate>Thu, 14 Mar 2013 22:51:34 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Alan_2915255.jpg" length="123456" /></item>

            <item><title><![CDATA[Lazio too strong for Stuttgart]]></title><description><![CDATA[Libor Kozak scored twice in the opening 10 minutes and completed a hat-trick late on as Lazio turned on the style behind closed doors to reach the Europa League quarter-finals.]]></description><link>http://www.skysports.com/football/match_report/0,19764,11065_3602531,00.html</link><guid isPermaLink="false">11959_8566244</guid><pubDate>Thu, 14 Mar 2013 22:38:58 GMT</pubDate><category>Report</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Lazio-v-Stuttgart-Libor-Kozak-2_2915077.jpg" length="123456" /></item>

            <item><title><![CDATA[AVB: UEFA will act on chants]]></title><description><![CDATA[Andre Villas-Boas expects UEFA to act after Inter Milan fans appeared to racially abuse Tottenham players as they fought back to reach the UEFA Europa League quarter-finals.]]></description><link>http://www1.skysports.com/football/news/11959/8566242/</link><guid isPermaLink="false">11959_8566242</guid><pubDate>Thu, 14 Mar 2013 22:37:49 GMT</pubDate><category>News Story</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/avb2_2915141.jpg" length="123456" /></item>

            <item><title><![CDATA[Fenerbahce sneak past Plzen]]></title><description><![CDATA[Substitute Salih Ucan was the hero as Fenerbahce did enough to squeeze into the Europa League quarter-finals with a home draw against Viktoria Plzen.]]></description><link>http://www.skysports.com/football/match_report/0,19764,11065_3602528,00.html</link><guid isPermaLink="false">11959_8566227</guid><pubDate>Thu, 14 Mar 2013 22:25:04 GMT</pubDate><category>Report</category><enclosure type="image/jpg" url="http://img.skysports.com/13/02/128x67/Vladimir-Darida_2900876.jpg" length="123456" /></item>

            <item><title><![CDATA[Benfica ease past Bordeaux]]></title><description><![CDATA[Benfica eased into the quarter-finals of the Europa League as they proved too strong for Bordeaux in the south of France.]]></description><link>http://www.skysports.com/football/match_report/0,19764,11065_3602529,00.html</link><guid isPermaLink="false">11959_8566219</guid><pubDate>Thu, 14 Mar 2013 22:21:16 GMT</pubDate><category>Report</category><enclosure type="image/jpg" url="http://img.skysports.com/11/04/128x67/Jardelcelebrates_2590756.jpg" length="123456" /></item>

            <item><title><![CDATA[Cisse stuns Anzhi to win it]]></title><description><![CDATA[Papiss Cisse headed Newcastle into the quarter-finals of the Europa League with a stoppage-time winner against 10-man Anzhi Makhachkala.]]></description><link>http://www.skysports.com/football/match_report/0,19764,11065_3602530,00.html</link><guid isPermaLink="false">11959_8566188</guid><pubDate>Thu, 14 Mar 2013 22:02:58 GMT</pubDate><category>Report</category><enclosure type="image/jpg" url="http://img.skysports.com/13/03/128x67/Newcastle-v-Anzhi-Makhachkala-Papiss-Cisse-St_2915107.jpg" length="123456" /></item>

            </channel>
        </rss> 
```

有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T00:16:53.093

`echo "<img src=\"" . (string)$item->enclosure['url'][0] . "\">";`

# c++ - 我的班级无法识别（错误：“不是类型”）

> ID：15753991
> 
> 赞同：0
> 
> 时间：2013-04-02T00:11:53.103
> 
> 标签：c++

我正在尝试使用 Allegro 在 C++ 中创建游戏，并且创建了一个简单的 Rectangle 类，但它似乎超出了我的主程序的范围，我有：

### 矢量2.h

```
#include "stdafx.h"

#ifndef __VECTOR2_H
#define __VECTOR2_H

using namespace std;

struct Vector2
{
public:
    float X,Y;
    Vector2() { }
    Vector2(const Vector2&) { }
    Vector2(const float& x, const float& y) : X(x), Y(y) { }
    ~Vector2( ) { }
    Vector2 operator+(const Vector2& v);
    Vector2 operator-(const Vector2& v);
};

#endif 
```

### 矩形.h

```
#include "Vector2.h"

#ifndef __RECTANGLE_H_
#define __RECTANGLE_H_

using namespace std;

class Rectangle
{
public:
    Rectangle() { }
    Rectangle(const Rectangle& r);
    Rectangle(const float& x,const float& y,const float& h,const float& w);
    ~Rectangle() { }
    void SetPosX(const float& x);
    void SetPosY(const float& y);
    void SetHeight(const float& h);
    void SetWidth(const float& w);

    bool Intersects(const Rectangle* r);

    Vector2* GetIntersection(const Rectangle* r);

    float x,y,w,h;
};

#endif 
```

### 主要的

```
#include "stdafx.h"
#include "Rectangle.h"

using namespace std;

// Other functions...

void myDraw(ALLEGRO_BITMAP* texture, Rectangle source, Rectangle dest, ALLEGRO_COLOR tint, Vector2 scale, float angle, int flags) //<-- This is where the error message points
{
    al_draw_tinted_scaled_rotated_bitmap_region(texture,
    source.x, source.y, source.w, source.h,
    tint,
    dest.x, dest.x, dest.w, dest.h,
    scale.X, scale.Y,
    angle, flags);

    return;
} 
```

帮助？

我得到的具体错误是***main.cpp(147): error C2061: syntax error : identifier 'Rectangle'***

# c++ - 处理由双链表组成的学生队列

> ID：15753993
> 
> 赞同：0
> 
> 时间：2013-04-02T00:11:58.013
> 
> 标签：c++, linked-list

我编写了这个函数来一次弹出并打印出 3 个学生，并一直这样做直到队列为空。由于某种原因，它仅在打印 3 个学生后停止。关于为什么的任何想法？Front 是指向我列表前面的指针，而 back 是指向后面的指针。该列表是非循环的。

```
void pop_front()
    {
        int num = 0;
            string value;
            while(front != NULL)
            {
                while(num<3)
                {
                    Node *temp = front;
                    if(front->next)
                    {   value = front->name;
                        front = front->next;
                        front->prev = NULL;
                        size--;
                        delete temp;
                        cout<<value<<", ";
                        num++;
                        continue;
                    }
                    cout<<endl;
                    if(front->next == NULL)
                    {
                        value=front->name;
                        front = NULL;
                        back = NULL;
                        delete temp;
                        size--;
                        cout<<" The last student in this priority Queue list is:  "<<value<<endl;
                    }
                }
            }
            return;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T00:22:25.770

您需要在循环内重置`num`为 0 `while(front != NULL)`，而不是在循环外。

# .net - 通过 WebAPI 进行基于 JSON 的 OAuth 身份验证 - 是否有任何简洁的模板/示例？

> ID：15753995
> 
> 赞同：0
> 
> 时间：2013-04-02T00:12:17.133
> 
> 标签：.net, authentication, web-applications, oauth, asp.net-web-api

我正在构建一个 webAPI 应用程序，它为 html/js 客户端公开端点——所有控制器都返回/接受 JSON/XML。此应用程序已构建，现在需要身份验证/授权。

我找到了很多提供部分解决方案的示例，但还没有找到一个简单、最新、简明的指南，其中包含示例代码来展示如何从 webAPI 的基本实现转变为通过以下方式对客户端应用程序和用户进行身份验证/授权的示例代码认证。

是否有任何 VS 模板可以证明这一点，或者最近有关于这个主题的文章/帖子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T05:32:54.817

不。

我只能将您指向身份服务器的 wiki - 有许多用于各种 OAuth2 流程的示例以及示例代码。

[https://github.com/thinktecture/Thinktecture.IdentityServer.v2/wiki](https://github.com/thinktecture/Thinktecture.IdentityServer.v2/wiki)

# asp.net-mvc - 多对多关系上的实体框架错误

> ID：15753998
> 
> 赞同：3
> 
> 时间：2013-04-02T00:12:45.353
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, asp.net-mvc-4, ef-code-first

我有以下约会课程：

```
public class Appointment
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int appointmentId { get; set; }

    public int Mins { get; set; }
    public DateTime StartDateTime { get; set; }
    public string Note { get; set; }

    //Navagation Properties
    public CompanyInformation Company { get; set; }

    public virtual ICollection<Service> Services { get; set; }

    public UserProfile Customer { get; set; }
    public UserProfile Staff { get; set; }

    public int? ParentID { get; set; }
    public Appointment ParentAppointment { get; set; }
} 
```

和以下服务等级：

```
public class Service
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int serviceId { get; set; }
    public string name { get; set; }
    public string description { get; set; }
    public decimal price { get; set; }

    public bool isPublished { get; set; }
    public bool isActive { get; set; }

    public virtual CompanyInformation Company { get; set; }

    public UserProfile defaultStaff { get; set; }

    public virtual ICollection<Appointment> Appointments { get; set; }
} 
```

我试图通过以下方式在这两者之间建立多对多关系：

```
 modelBuilder.Entity<Service>().HasMany(e => e.Appointments).WithMany(e => e.Services); 
```

在 DbContext 的 OnModelCreating 中。当我尝试更新数据库时，出现以下错误。

```
 Introducing FOREIGN KEY constraint 'FK_dbo.ServiceAppointments_dbo.Appointments_Appointment_appointmentId' on table 'ServiceAppointments' may cause cycles or multiple cascade paths. Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, or modify other FOREIGN KEY constraints. 
```

无法创建约束。请参阅以前的错误。

我对其进行了一些研究，发现问题出在级联删除上，我应该禁用它。问题是我不知道我发现的方法和选项似乎对我不起作用（它们显然适用于一对多关系）。任何解决此问题的帮助将不胜感激。提前致谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T02:26:25.270

**这应该可以正常工作**（*您不需要多对多的映射，按惯例工作*）。你有哪个版本的 EF/CF？但无论如何，既然不...

a）**尝试删除**@Lajos提到的约定-应该可以解决问题，

b）如果这不起作用，您可以**手动“重写”关系**- 并关闭级联，像这样......

```
modelBuilder.Entity<Appointment>()
    .HasOptional(x => x.ParentAppointment)
    .WithOptionalDependent()
    .WillCascadeOnDelete(false);

modelBuilder.Entity<ServiceAppointment>()
    .HasKey(x => new { x.ServiceId, x.AppointmentId });

modelBuilder.Entity<ServiceAppointment>()
    .HasRequired(x => x.Service)
    .WithMany(x => x.Appointments)
    .HasForeignKey(at => at.ServiceId)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<ServiceAppointment>()
    .HasRequired(x => x.Appointment)
    .WithMany(x => x.Services)
    .HasForeignKey(at => at.AppointmentId)
    .WillCascadeOnDelete(false); 
```

只需将两个类中的集合更改为...

```
// public virtual ICollection<Appointment> Appointments { get; set; }
public virtual ICollection<ServiceAppointment> Appointments { get; set; }

// public virtual ICollection<Service> Services { get; set; }
public virtual ICollection<ServiceAppointment> Services { get; set; }

public class ServiceAppointment
{
    public int ServiceId { get; set; }
    public int AppointmentId { get; set; }
    public Service Service { get; set; }
    public Appointment Appointment { get; set; }
} 
```

...那肯定可以解决问题。尽管您失去了“服务”“约会”直接导航（全部通过 ServiceAppointments）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T01:16:44.467

```
protected override void OnModelCreating( DbModelBuilder modelBuilder )
      {

         modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();

     modelBuilder.Entity<Appointment>()
        .WithRequiredDependent()
        .WillCascadeOnDelete( false );

     modelBuilder.Entity<Service>()
        .WithRequiredDependent()
        .WillCascadeOnDelete( false );

      } 
```

# php - 使用正则表达式查找最多 16 个字符的短语？(php)

> ID：15753999
> 
> 赞同：1
> 
> 时间：2013-04-02T00:12:46.713
> 
> 标签：php, regex, string

我面临的小问题。我有一个长字符串，里面有很多单词，我正在尝试将其拆分，但是字符串的大部分部分都有一个开始和结束来引用它是静态的，但是这个只有一个结束，我想要得到的字符串的实际位是动态的，但最多 16 个字符，它可能会更少，并且短语中的单词数量是未知的。

例子：

```
Name: John Smith Occupation: Doctor Currently Busy Gender: Male 
```

我想自己获得“当前很忙”，而不是之前得到另一个字符串的结尾。

但我也想使用相同的代码从这个字符串中获取“Not Yet Here”：

```
Name: John Smith Occupation: Doctor Not Yet Here Gender: Male 
```

我找不到办法，我什至不知道这是否可能，所以希望这里有人可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:27:47.393

您的问题是 RegEx 可能无法解决的问题。如果“职业”的值可以是一个或多个词，并且它直接被另一个可以是一个或多个词的值所取代，那么作为人类，你将如何区分这两个短语？

我希望至少，你有一组已知的`Occupation`值。如果是这种情况，那么您可以像这样制作您的表达式：

```
(?<=Doctor |Nurse ).*(?= Gender) 
```

和位是lookbehind`(?<=...)`和`(?=...)`lookahead断言，本质上说“确保表达式`Doctor |Nurse`出现在匹配的短语之前（但不匹配它的那部分），并且表达式`Gender`出现在匹配的短语之后（但也不匹配那部分的）。”

看看这个：[http ://regexr.com?34buq](http://regexr.com?34buq)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T08:36:30.540

不是最优雅的方式，但这里有一个解决方案：

```
$string = 'Name: John Smith Occupation: Doctor Currently Busy Gender: Male';
$groups = array_filter(preg_split('/\s?\w+:\s?/', $string));
// Split by [\s? => optional space][\w+ => characters a-zA-Z0-9_][:][\s? => optional space]

// $groups[2] contains 'Doctor Currently Busy'
$pieces = explode(' ', $groups[2]);
$pieces = array_reverse($pieces);
$length = 0;$i = 0;$c = count($pieces);$result = array(); // We need this for the loop
// $c and $i are to preserve the first word if the length of all words are < 16 !

foreach($pieces as $piece){
    $length += strlen($piece);
    $i++;
    if($length <= 16 && $c != $i){
        $result[] = $piece;
    }else{
        break;
    }
}

$result = array_reverse($result);
$final_result = implode(' ', $result);
echo $final_result; // Currently Busy 
```