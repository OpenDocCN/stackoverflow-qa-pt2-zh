# StackOverflow 问答 14489000-14489999

# jquery - 通过单击缩略图交换 Jquery 图像和标题

> ID：14489004
> 
> 赞同：0
> 
> 时间：2013-01-23T20:42:55.963
> 
> 标签：jquery, jquery-animate, show-hide

我正在尝试创建一个简单的 jquery 图片库，其中单击缩略图按钮（每张图片 1 个）通过淡入淡出交换图像并交换文本标题。

我有包含绝对位于另一个之上的图像的 div，旁边有一个标题，下面有缩略图/按钮。

我写的 jquery 可以工作——除了页面加载时的第一次转换。第一个过渡使目标图像出现，然后淡出，然后淡入。它应该只是淡入。

我是 jquery 的新手，如果这是糟糕的代码，我深表歉意......

谁能告诉我为什么第一次转换不能正常工作？

谢谢

查询：

```
$(document).ready(function(){
    $('.gallery_button').click(function(){
     $('.gallery_slide').animate( {opacity:0.0}, 2000 );
     $('#slide'+$(this).attr('id')).toggleClass('visible');
     $('#slide'+$(this).attr('id')).animate( {opacity:1.0}, 2000 );
     $('.gallery_caption').hide();
         $('#caption'+$(this).attr('id')).show();
         $('#caption'+$(this).attr('id')).toggleClass('visible');
    });
}); 
```

HTML：

```
<div id="gallery_slider">
<div class="gallery_slide" id="slide1"><img src="img1.jpg"/></div>
<div class="gallery_slide hidden" id="slide2"><img src="img2.jpg"/></div>
<div class="gallery_slide hidden" id="slide3"><img src="img3.jpg"/></div>

<div class="gallery_caption" id="caption1">Caption 1</div>
<div class="gallery_caption hidden" id="caption2"/>Caption2</div>
<div class="gallery_caption hidden" id="caption3"/>Caption3</div>

<div class="gallery_button"><img src="button.gif" id="1"/></div>
<div class="gallery_button"><img src="button.gif" id="2"/></div>
<div class="gallery_button"><img src="button.gif" id="3"/></div>
</div> 
```

CSS：

```
#gallery_slider{position:relative; height:500px;}
.gallery_slide{position:absolute; top:0; left:0; width:640px; height:480px;}
.gallery_caption{position:absolute; bottom:20px; left:660px; width:160px; min-height:150px;}
.gallery_button{width:10px; height:10px; margin:490px 8px 0 0; float:left;}

.hidden{display:none;}
.visible{display:block; visibility:visible;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:50:51.160

这正是这段代码告诉它要做的事情：

```
 $('#slide'+$(this).attr('id')).toggleClass('visible'); // shows it
 $('#slide'+$(this).attr('id')).animate( {opacity:1.0}, 2000 );  // fades it in 
```

试试这个：

```
$(document).ready(function () {
  $('.gallery_button img').click(function () {
    var id = this.id;
    $('.gallery_caption').hide();
    $('.gallery_slide').fadeOut(2000, function () {
      $('#caption' + id).show();
      $('#slide' + id).fadeIn(2000);
    });
  });
}); 
```

[http://jsfiddle.net/mblase75/Utb8f/](http://jsfiddle.net/mblase75/Utb8f/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T19:00:17.703

我很想弄清楚如何使用原始格式对原始问题进行排序，因为这是我的第一段 jquery，所以我终于设法让它工作：

```
$(document).ready(function(){
$('.gallery_button').click(function(){
    var id = this.id;
    $('.gallery_caption:visible').hide();
    $('.gallery_slide:visible').fadeOut(500, function(){
        $('#slide' + id).fadeIn(5000);
        $('#caption' + id).show();
    });
    });
}); 
```

感谢大家的投入和帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:23:24.687

我无法发表评论，但我想指出您的 HTML 可以通过一些评论来完成。

底部的按钮是嵌套的，因为 div 似乎没有 end 。此外，您的其他一些 div 的格式为

```
<div />something</div> 
```

代替

```
<div>something</div> 
```

这是您的代码的清理版本：

```
<div id="gallery_slider">
<div class="gallery_slide" id="slide1"><img src="img1.jpg"/></div>
<div class="gallery_slide hidden" id="slide2"><img src="img2.jpg"/></div>
<div class="gallery_slide hidden" id="slide3"><img src="img3.jpg"/></div>

<div class="gallery_caption" id="caption1">Caption 1</div>
<div class="gallery_caption hidden" id="caption2">Caption2</div>
<div class="gallery_caption hidden" id="caption3">Caption3</div>

<div class="gallery_button"><img src="button.gif" id="1"/></div>
<div class="gallery_button"><img src="button.gif" id="1"/></div>
<div class="gallery_button"><img src="button.gif" id="1"/></div>
</div> 
```

此外，如果您想查看一些现有的东西（如果您愿意的话，最好使用已经存在并且已经过大量人测试的东西）或者只是想了解其他人是如何做到这一点的之前，我已经通过并发现了一些我认为可以实现您想要实现的流行插件：

*   [http://www.tn3gallery.com/?refCode=ae1bfc](http://www.tn3gallery.com/?refCode=ae1bfc)
*   [http://www.pikachoose.com/](http://www.pikachoose.com/)
*   [http://www.robertnyman.com/picture-slides/](http://www.robertnyman.com/picture-slides/)
*   [http://css-tricks.com/anythingslider-jquery-plugin/](http://css-tricks.com/anythingslider-jquery-plugin/)
*   [http://coffeescripter.com/code/ad-gallery/#ad-image-0](http://coffeescripter.com/code/ad-gallery/#ad-image-0)
*   [http://www.queness.com/post/3036/create-a-custom-jquery-image-gallery-with-jcarousel](http://www.queness.com/post/3036/create-a-custom-jquery-image-gallery-with-jcarousel)
*   [http://slidesjs.com/](http://slidesjs.com/)
*   [http://www.woothemes.com/flexslider/](http://www.woothemes.com/flexslider/)
*   [http://www.pixedelic.com/plugins/camera/](http://www.pixedelic.com/plugins/camera/)

希望有帮助。

**编辑：**

我已经完成并制作了一个小代码片段（用猫来幽默）来举例说明如何在不使用 ID 的情况下做到这一点，因此您可以添加新元素并交换它们而不必担心 ID。

[http://jsfiddle.net/Q6agB/1/](http://jsfiddle.net/Q6agB/1/)（第二次编辑后） [http://jsfiddle.net/Q6agB/3/](http://jsfiddle.net/Q6agB/3/)（第三次编辑，带评论）

将相关的元素（因此带有标题的图像）保持在一起是很好的，这样您就可以轻松地移动它们，并且当有人扫视您的东西时（可能是您在一段时间内，在您忘记了所有代码之后），他们可以很容易地告诉你你一直在做什么。所以这就是我将标题与图像分组的原因。

这就是你想要达到的目标吗？

# python - 使用正则表达式和 python 解析命令

> ID：14489010
> 
> 赞同：1
> 
> 时间：2013-01-23T20:43:06.513
> 
> 标签：python, regex, parsing, command

我有一个这样的字符串：

```
str = "something move 11 something move 12 something 13 copy 14 15" 
```

*其中“某物”表示一些文本，或者根本没有文本。*
结果我想要一个像这样的列表：

```
[('move', 11, ''), ('move', 12, 13), ('copy', 14, 15)] 
```

我尝试使用这个：

```
re.findall('(move|copy).+?([0-9]+).+?([0-9]+)*', str) 
```

但它给了我的输出：

```
[('move', 11, ''), ('move', 12, ''), ('copy', 14, '')] 
```

我知道这是因为最后一个数字是可选的，但我只是不知道它是如何工作的。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:34:57.910

您可以使用[正则表达式](http://docs.python.org/2/library/re.html)（带有后向和前瞻）：

```
In [1]: import re

In [2]: tokens = "something move 11 something move 12 something 13 copy 14 15"

In [3]: split_movements = re.split('(?<=\d)\s(?!\d+)', tokens)

In [4]: split_movements
Out[4]: ['something move 11', 'something move 12', 'something 13', 'copy 14 15']

In [5]: movements = [re.split('\s(?=\d+)', m) for m in split_movements]

In [6]: movements
Out[6]: 
[['something move', '11'],
 ['something move', '12'],
 ['something', '13'],
 ['copy', '14', '15']] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:41:12.053

基于[@Ashwini Chaudhary 的回答](https://stackoverflow.com/a/14489160/4279)：

```
#!/usr/bin/env python
import re

commands = "copy move".split()
input_string  = "something move 11 something move 12 something 13 copy 14 15"
tokens = iter(re.split("(%s)" % "|".join(map(re.escape, commands)), input_string))
result = []
for tok in tokens:
     if tok in commands:
        args = re.findall(r"\d+", next(tokens, ""))
        result.append((tok,) + tuple(args) + ("",)*(2 - len(args)))
print(result) 
```

### [输出](http://ideone.com/9Cf3VV)

```
[('move', '11', ''), ('move', '12', '13'), ('copy', '14', '15')] 
```

要将每个命令限制为两个参数，只需使用 slicing: `tuple(arg[:2])`。

# python - 模拟 Python 按键以控制游戏

> ID：14489013
> 
> 赞同：39
> 
> 时间：2013-01-23T20:43:14.557
> 
> 标签：python, python-2.7, keypress, simulate

我正在尝试使用我的 Kinect 和 Python 来控制一个游戏（我的两个测试游戏是《半条命 2》和《我的世界》）。一切正常，除了一件事。游戏将响应模拟鼠标事件和模拟鼠标移动（鼠标事件通过 ctypes 完成，鼠标移动使用 pywin32 完成）。然而问题是游戏忽略了模拟按键。他们都将在聊天窗口 (Minecraft) 或开发者控制台 (Half Life 2) 中选择模拟按键，但在玩实际游戏时不会。

我尝试了几种发送按键的方法：

```
import win32com.client as client
wsh = client.Dispatch('WScript.Shell')
wsh.AppActivate(gameName)
wsh.SendKeys(key) 
```

和：

```
import win32api
win32api.keybd_event(keyHexCode, 0, 0) 
```

和：

```
import ctypes
import time

SendInput = ctypes.windll.user32.SendInput

# C struct redefinitions 
PUL = ctypes.POINTER(ctypes.c_ulong)
class KeyBdInput(ctypes.Structure):
    _fields_ = [("wVk", ctypes.c_ushort),
                ("wScan", ctypes.c_ushort),
                ("dwFlags", ctypes.c_ulong),
                ("time", ctypes.c_ulong),
                ("dwExtraInfo", PUL)]

class HardwareInput(ctypes.Structure):
    _fields_ = [("uMsg", ctypes.c_ulong),
                ("wParamL", ctypes.c_short),
                ("wParamH", ctypes.c_ushort)]

class MouseInput(ctypes.Structure):
    _fields_ = [("dx", ctypes.c_long),
                ("dy", ctypes.c_long),
                ("mouseData", ctypes.c_ulong),
                ("dwFlags", ctypes.c_ulong),
                ("time",ctypes.c_ulong),
                ("dwExtraInfo", PUL)]

class Input_I(ctypes.Union):
    _fields_ = [("ki", KeyBdInput),
                 ("mi", MouseInput),
                 ("hi", HardwareInput)]

class Input(ctypes.Structure):
    _fields_ = [("type", ctypes.c_ulong),
                ("ii", Input_I)]

# Actuals Functions

def PressKey(hexKeyCode):

    extra = ctypes.c_ulong(0)
    ii_ = Input_I()
    ii_.ki = KeyBdInput( hexKeyCode, 0x48, 0, 0, ctypes.pointer(extra) )
    x = Input( ctypes.c_ulong(1), ii_ )
    ctypes.windll.user32.SendInput(1, ctypes.pointer(x), ctypes.sizeof(x))

def ReleaseKey(hexKeyCode):

    extra = ctypes.c_ulong(0)
    ii_ = Input_I()
    ii_.ki = KeyBdInput( hexKeyCode, 0x48, 0x0002, 0, ctypes.pointer(extra) )
    x = Input( ctypes.c_ulong(1), ii_ )
    ctypes.windll.user32.SendInput(1, ctypes.pointer(x), ctypes.sizeof(x)) 
```

我应该指出最后一个代码不是我的，这是 Stack Overflow 上的另一个问题。

有谁知道为什么这些都不起作用以及正确的方法是什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-05-05T08:38:54.430

我在尝试模拟《半条命 2》中的按键时遇到了同样的问题。正如 Robin 所说，解决方案是使用 ScanCodes 而不是 VK。

我编辑了您的最后一个代码示例，使其使用 ScanCodes。我用《半条命 2》试了一下，效果很好：

```
import ctypes
import time

SendInput = ctypes.windll.user32.SendInput

# C struct redefinitions 
PUL = ctypes.POINTER(ctypes.c_ulong)
class KeyBdInput(ctypes.Structure):
    _fields_ = [("wVk", ctypes.c_ushort),
                ("wScan", ctypes.c_ushort),
                ("dwFlags", ctypes.c_ulong),
                ("time", ctypes.c_ulong),
                ("dwExtraInfo", PUL)]

class HardwareInput(ctypes.Structure):
    _fields_ = [("uMsg", ctypes.c_ulong),
                ("wParamL", ctypes.c_short),
                ("wParamH", ctypes.c_ushort)]

class MouseInput(ctypes.Structure):
    _fields_ = [("dx", ctypes.c_long),
                ("dy", ctypes.c_long),
                ("mouseData", ctypes.c_ulong),
                ("dwFlags", ctypes.c_ulong),
                ("time",ctypes.c_ulong),
                ("dwExtraInfo", PUL)]

class Input_I(ctypes.Union):
    _fields_ = [("ki", KeyBdInput),
                 ("mi", MouseInput),
                 ("hi", HardwareInput)]

class Input(ctypes.Structure):
    _fields_ = [("type", ctypes.c_ulong),
                ("ii", Input_I)]

# Actuals Functions

def PressKey(hexKeyCode):
    extra = ctypes.c_ulong(0)
    ii_ = Input_I()
    ii_.ki = KeyBdInput( 0, hexKeyCode, 0x0008, 0, ctypes.pointer(extra) )
    x = Input( ctypes.c_ulong(1), ii_ )
    ctypes.windll.user32.SendInput(1, ctypes.pointer(x), ctypes.sizeof(x))

def ReleaseKey(hexKeyCode):
    extra = ctypes.c_ulong(0)
    ii_ = Input_I()
    ii_.ki = KeyBdInput( 0, hexKeyCode, 0x0008 | 0x0002, 0, ctypes.pointer(extra) )
    x = Input( ctypes.c_ulong(1), ii_ )
    ctypes.windll.user32.SendInput(1, ctypes.pointer(x), ctypes.sizeof(x))

# directx scan codes http://www.gamespp.com/directx/directInputKeyboardScanCodes.html
while (True):
    PressKey(0x11)
    time.sleep(1)
    ReleaseKey(0x11)
    time.sleep(1) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-13T00:00:31.163

游戏可能正在使用 DirectInput 设备。

因此，游戏期待 DirectInput 按键。根据[这个论坛](http://forum.sysinternals.com/sending-keystrokes-to-games-directinput_topic18025.html)帖子的最后一篇文章，DirectInput 响应的是 ScanCodes，而不是 VKs。[您可以尝试使用此工具](http://www.gamedev.net/topic/371104-c-directinput-hooking-component-and-sample/)发送 DirectInput 按键。开发人员还提供了源代码和详细说明。

如果可行，您可以尝试发送适当的 ScanCodes 而不是 VKs [(list of scancodes)](http://msdn.microsoft.com/en-us/library/aa299374%28v=vs.60%29.aspx)。

还有一个名为[DirectPython](http://directpython.sourceforge.net/)的旧项目，它允许您与 DirectX/DirectInput 交互。

# html - 如何正确引用 HTML 中的本地资源？

> ID：14489016
> 
> 赞同：59
> 
> 时间：2013-01-23T20:43:21.063
> 
> 标签：html, src, ref

事实证明，对某些人来说，引用本地资源可能是一个难题。我正在寻找本地资源引用的规范答案，以及它们的含义。

拿这些例子来说，这些参考路径有什么区别呢？

*   `<img src="myfile.png" />`（没有前导斜杠）
*   `<img src="/myfile.png" />`（带前导斜线）
*   `<img src="folder/myfile.png" />`（子文件夹中没有前导斜杠/）
*   `<img src="/folder/myfile.png" />`（带有前导斜杠 / 在子文件夹中）
*   `<img src="../folder/myfile.png" />`（带有点和前导斜杠 / 在子文件夹中）

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2013-01-23T20:43:21.063

*   前导斜杠告诉浏览器从根目录开始。
*   如果您没有前导斜杠，则表示您从当前目录引用。
*   如果在前导斜杠前添加两个点，则表示您正在引用当前目录的父目录。

采取以下文件夹结构

![演示文件夹结构](../Images/ac7aa7ed775827db0de66ec75502401e.png)

***注意：***

*   ROOT 复选标记为绿色，
*   第二个复选标记是橙色，
*   第三个复选标记是紫色，
*   第四个复选标记是黄色

现在在`index.html.en`文件中，您需要放置以下标记

```
<p>
    <span>src="check_mark.png"</span>
    <img src="check_mark.png" />
    <span>I'm purple because I'm referenced from this current directory</span>
</p>

<p>
    <span>src="/check_mark.png"</span>
    <img src="/check_mark.png" />
    <span>I'm green because I'm referenced from the ROOT directory</span>
</p>

<p>
    <span>src="subfolder/check_mark.png"</span>
    <img src="subfolder/check_mark.png" />
    <span>I'm yellow because I'm referenced from the child of this current directory</span>
</p>

<p>
    <span>src="/subfolder/check_mark.png"</span>
    <img src="/subfolder/check_mark.png" />
    <span>I'm orange because I'm referenced from the child of the ROOT directory</span>
</p>

<p>
    <span>src="../subfolder/check_mark.png"</span>
    <img src="../subfolder/check_mark.png" />
    <span>I'm purple because I'm referenced from the parent of this current directory</span>
</p>

<p>
    <span>src="subfolder/subfolder/check_mark.png"</span>
    <img src="subfolder/subfolder/check_mark.png" />
    <span>I'm [broken] because there is no subfolder two children down from this current directory</span>
</p>

<p>
    <span>src="/subfolder/subfolder/check_mark.png"</span>
    <img src="/subfolder/subfolder/check_mark.png" />
    <span>I'm purple because I'm referenced two children down from the ROOT directory</span>
</p> 
```

现在，如果您加载`index.html.en`位于第二个子文件夹
[http://example.com/subfolder/subfolder/中的文件](http://example.com/subfolder/subfolder/)

这将是你的输出

![在此处输入图像描述](../Images/ba9c3bb4725187eeeda9e56d88d334cf.png)

# oop - 将父对象添加到 VFP 中创建的对象

> ID：14489017
> 
> 赞同：0
> 
> 时间：2013-01-23T20:43:23.570
> 
> 标签：oop, object, foxpro

我有一个用 CREATEOBJECT() 创建的对象，我想给他设置一个父对象。来自 msdn： `When you create an object with the CREATEOBJECT( ) function, the object is scoped to a property of the class or a variable in the method that calls this function. The parent property of the object is undefined.`

使用 .addobject() 是不可能的，因为此方法创建 object ，但我已经创建了 object 。

问题是：如何创建许多具有父对象的对象（例如命令按钮）？提前致谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:18:38.800

您无法添加现有对象并获得父/子关系。您可以添加对现有对象的对象引用，同时设置一个伪父对象。但是，这不会给你一个可见的存在。也就是说，它适用于正在处理的对象，但不适用于控件。

那么为什么你有一个不在容器内或表单上的按钮呢？在我看来，这里存在一个根本性的误解。

# visual-studio-2010 - 对第三方可执行文件隐藏调试器

> ID：14489020
> 
> 赞同：3
> 
> 时间：2013-01-23T20:43:34.927
> 
> 标签：visual-studio-2010, debugging

我有一个用 Visual C++ 编写的 DLL，它与第三方程序（通过标准化接口）一起工作，我需要知道该程序是否正确调用了我的函数，如果有的话。

通常我可以只选择可执行文件作为调试入口命令，但是这个特定的可执行文件可以以某种方式检测到有一个调试器连接并拒绝运行。

它给出以下消息：

> ---------------------------------------
> 棱镜 8.1.1
> ------- --------
> 找到调试器
> 
> 发现一个调试器在您的系统中运行。
> 
> 请从内存中卸载它并重新启动您的程序！
> 
> 请访问：www.prism-astro.com 以获得支持。
> --------------------------
> 好的
> ---------- -----

如何从程序中隐藏调试器。
请注意，我只是在尝试调试我的 DLL 而不是第三方程序，所以我认为不应该存在法律问题。

# maven - maven 输出大量“FINE”日志消息，我该如何阻止它？

> ID：14489025
> 
> 赞同：2
> 
> 时间：2013-01-23T20:44:01.797
> 
> 标签：maven, maven-3

当我运行 maven 时，我得到的输出就像我指定了日志级别 FINE 一样，这使得很难找到实际的输出。我还得到了数百行列出显式和隐式绑定的行。据我所知，我根本没有配置 mvn。我在 cygwin shell 中运行。

这是一个示例，它还提供了有关我的版本等的信息。

```
$ mvn --show-version
Apache Maven 3.0.4 (r1232337; 2012-01-17 03:44:56-0500)
Maven home: C:\apache-maven-3.0.4
Java version: 1.6.0_31, vendor: Sun Microsystems Inc.
Java home: C:\Program Files\Java\jdk1.6.0_31\jre
Default locale: en_US, platform encoding: Cp1252
OS name: "windows 7", version: "6.1", arch: "amd64", family: "windows"
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Module execution: 344ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: TypeListeners & ProvisionListener creation: 6ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Scopes creation: 4ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Converters creation: 1ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Binding creation: 23ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Private environment creation: 1ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Injector construction: 0ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Binding initialization: 20ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Binding indexing: 1ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Collecting injection requests: 0ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Binding validation: 1ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Static validation: 0ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Instance member validation: 5ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Provider verification: 2ms
Jan 23, 2013 3:33:03 PM com.google.inject.internal.util.Stopwatch resetAndLog
FINE: Static member injection: 0ms
Jan 23, 2013 3:33:03 PM org.sonatype.guice.bean.reflect.Logs$JULSink debug
FINE: Add publisher: com.google.inject.internal.InjectorImpl@561777b1

-----[explicit bindings]-------------------------------------------------------
0\. ProviderInstanceBinding{key=Key[type=com.google.inject.Injector, annotation=[none]], source=[unknown source], scope=Scopes.NO_SCOPE, provider=Provider<Injector>}
1\. ProviderInstanceBinding{key=Key[type=java.util.logging.Logger, annotation=[none]], source=[unknown source], scope=Scopes.NO_SCOPE, provider=Provider<Logger>}
2\. InstanceBinding{key=Key[type=com.google.inject.Stage, annotation=[none]], source=[unknown source], instance=DEVELOPMENT}
.
.
.
194\. ConstructorBinding{key=Key[type=org.apache.maven.lifecycle.internal.ThreadConfigurationService, annotation=[none]], source=ClassRealm[plexus.core, parent: null], scope=Scopes.SINGLETON}
195\. ConstructorBinding{key=Key[type=org.apache.maven.lifecycle.internal.MojoExecutor, annotation=[none]], source=ClassRealm[plexus.core, parent: null], scope=Scopes.SINGLETON}
196\. ConstructorBinding{key=Key[type=org.apache.maven.lifecycle.internal.LifecycleThreadedBuilder, annotation=[none]], source=ClassRealm[plexus.core, parent: null], scope=Scopes.SINGLETON}
197\. ConstructorBinding{key=Key[type=org.apache.maven.lifecycle.Lifecycle, annotation=[none]], source=ClassRealm[plexus.core, parent: null], scope=Scopes.SINGLETON} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:54:59.080

它看起来更像是日志输出，而不是 Maven 生成的任何东西。查看[Stopwatch 类](http://grepcode.com/file/repo1.maven.org/maven2/com.jolira/guice/2.1.8/com/google/inject/internal/util/Stopwatch.java#Stopwatch.resetAndLog%28java.lang.String%29)的源代码，它使用 Java Util Logging。您是否将默认日志记录属性设置为包含 FINE 级别的输出？这可能在 JAVA_HOME 本身中。

但是，这更像是你配置日志的方式，而不是 Maven 所做的任何事情

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T21:05:51.653

你能检查`JDK_HOME/jre/lib/logging.properties`你的JDK文件夹下的文件吗？maven 中的 guice 使用 java.util.logging，如果您指定了类似的文件，它可以使用 java.util.logging 打开一个或多个记录器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T20:51:31.530

答案是我的 JAVA_HOME 指向的是 JDK 安装而不是 JRE 安装……这对我来说毫无意义，但它现在可以工作了。

我编辑了 mvn 命令脚本以回显它运行 java 的位置。从 .../Java/jdk1.6.0_31/bin 运行时，我会收到所有这些错误，但从 .../Java/jre6/bin 运行时，我不会。

我猜jdk假设更多的调试......还是什么？我以前从未见过这样的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T21:54:39.060

由于`--show-version`记录到

> 在不停止构建的情况下显示版本信息

我相信这些信息不知何故来自 pom.xml 文件、配置错误的 settings.xml 文件或内部的调试设置`MAVEN_HOME`。

# iphone - UITableView,numberOfRowsInSection

> ID：14489028
> 
> 赞同：0
> 
> 时间：2013-01-23T20:44:10.373
> 
> 标签：iphone, ios, xcode

我有三个数据（日期、视图、文本字段）。我使用 SQLite（FMDB）。并且，它输出到 tableview。当您运行此代码时，所有部分都会输出相同的单元格。我想在每个日期的单元格中输入文本并查看。我是初学者，请告诉我。

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    titleArry = [[NSMutableArray alloc] init ]; //タイトルを格納するための可変配列
    dateArray = [[NSMutableArray alloc] init ]; // 日付格納する可変配列
    contentsArry = [[NSMutableArray alloc] init ]; //画像を格納するための可変配列

    [DataModel selectTitle:titleArry];
    [DataModel selectDateTitle:dateArray]; 
    [DataModel selectContents:contentsArry];

    NSMutableSet *mutableSet = [NSMutableSet setWithArray:dateArray]; // 日付の重複を取り除く
    array = [mutableSet allObjects];

    [table reloadData];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return array.count;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return  contentsArry.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] ;
    }

    //セルに表示する内容
    cell.textLabel.text = [titleArry objectAtIndex:indexPath.row];
    cell.imageView.image = [[UIImage alloc] initWithData:[contentsArry objectAtIndex:indexPath.row]];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:01:15.910

在方法中选择数组中正确的对象`cellForRowAtIndexPath`：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    //get the right object (use the object that is in the array, this is just an example)
    NSObject *object = [array objectAtIndex:indexPath];
    cell.textLabel.text = object.title
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:48:12.477

看看[cellForRowAtIndexPath](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html)

# python - Python 歌词开启器适用于一个文件，但不适用于另一个文件？

> ID：14489032
> 
> 赞同：0
> 
> 时间：2013-01-23T20:44:27.800
> 
> 标签：python, file, printing, python-3.x

我编写了一个程序，可以帮助我在歌曲的歌词之间快速切换。它从文件中读取歌词`.lyr`并将它们打印出来给我。

这是一个简化版本，没有任何附加功能，例如`edit_line()`. 此代码仍然出现问题。

```
import os

class Lyrics:

    def __init__(self, file):
        '''Initialize new Lyrics object'''
        self.file = file.replace("/", "\\")
        self.path = self.file.rsplit("\\", 1)[0] + "\\"
        self.suffix = "." + self.file.rsplit(".")[-2]
        self.name = self.file\
                    .replace(self.path, "")\
                    .replace(".lyr", "")\
                    .replace(self.suffix, "")

    def draw(self):
        '''Draw lyrics on user's screen'''
        maxlen = len(str(len(self.content)))
        print("[[ %s ]]"%self.name)
        for i,line in enumerate(self.content):
            print("%i  %s"%(i+1, line), end="")

    def play(self):
        '''View lyrics'''
        with open(self.file, "r") as f:
            self.content = f.readlines()
        #os.system("cls")
        self.draw()
        input("[[ Press enter to quit ... ]]")

def main(directory):
    # Get lyric files from directory
    lyric_files = []
    for file in os.listdir(directory):
        if file.endswith(".lyr"):
            lyric_files.append(Lyrics(directory + file))

    # Create variable for showing messages to user
    msg = ""

    # Main loop
    while True:

        # Print lyric files
        #os.system("cls")
        for i, file in enumerate(lyric_files):
            print("%i :: %s"%(i+1, file.name))

        # Handle input
        cmd = input("%s>"%msg)
        if cmd == "bye":
            break
        try:
            lyric_files[int(cmd)-1].play()
            msg = ""
        except ValueError:
            msg = "ValueError: Input must be an integer\n"
        except IndexError:
            msg = "IndexError: Integer must be between 1 and %i\n"%len(lyric_files)

if __name__ == "__main__":
    main("E:\\documents\\lyrics\\") 
```

* * *

中的文件`E:\documents\lyrics\`使用以下格式命名：

```
Artist - Song.format.lyr` 
```

例如：

```
E:\documents\lyrics\Adele - Set Fire to the Rain.mp3.lyr 
```

* * *

当我打开程序时，它会按原样列出所有文件，然后要求我输入：

```
1 :: Adele - Set Fire to the Rain
2 :: Eminem - Not Afraid
3 :: Nicki Minaj - Starships
> 
```

`Set Fire to the Rain`当我用 index打开歌词时`1`，它们打开得非常完美。但是，当我尝试打开歌词时`Not Afraid`，我可以在输出中看到大约 50 行歌词，而歌词文件实际上是 120 行左右。然后它要求我输入来自`main()`函数的输入，`ValueError`如下所示：

```
1  first_line_in_lyrics
2  second_line_in_lyrics
i  ...
42 fourty_second_line_in_lyrics
43 fourty_third_line_in_lyrics
1 :: Adele - Set Fire to the Rain
2 :: Eminem - Not Afraid
3 :: Nicki Minaj - Starships
ValueError: Input must be an integer
> 
```

这些文件彼此几乎相同（当然歌词不同）。该程序在 IDLE 上运行良好，但在 python 命令行上却不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:32:45.240

这个问题看起来很奇怪，但并非不可能。这是我们目前得到的：

1.  由于文件确实打开并且其中一些被打印出来，所以问题必须出在文件的打印上。
2.  我三次检查了您的代码，问题不在您的`draw()`方法中。
3.  由于问题只发生在某些文件上，而其他文件没有，问题可能出在文件本身上。
4.  由于问题只发生在 python 命令行而不是 IDLE：问题必须在打印某些文件的某些内容，这些文件可以在 IDLE 中打印，但不能在 python 命令行中打印。

如果您确定您的绘图功能看起来完全像这样（我花了一段时间才弄清楚这`maxlen`件事）：

```
def draw(self):
    '''Draw lyrics on user's screen'''
    maxlen = len(str(len(self.content)))
    print("[[ %s ]]"%self.name)
    for i,line in enumerate(self.content):
        print("%i  %s"%(i+1, line), end="") 
```

我们只剩下这样一个事实，即`self.content`文件内容本身和/或文件内容本身存在问题。

简单地说：我 99% 确定文件中有一些字符可以由 IDLE 打印，但不能由 python 命令行打印。这样的字符可以是任何东西：`%`, `'`, `"`, `´`, `|`, `#`，甚至是一些不使用箭头键滚动就看不到的不可见字符。

如果您可以发布您的歌词内容，我可以尝试提供更多帮助。尤其是最后打印的行，以及根本不打印的第一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:28:15.777

你说你编写了一个程序：

> 它从 .lyr 文件中读取歌词并将其打印给我

但是我对您的程序的阅读：

```
def get_lyric_files(path):
    lyric_files = []
    for lyrics in os.listdir(path):
        if lyrics[:-4].split(".")[-1] in ("wav", "mp3"):
            lyric_files .append(Lyrics(path + lyrics))
    return lyric_files 
```

看起来您从 .mp3 和 .wav 文件中获取歌词。一些 mp3 文件包含歌词标签，但您不解析它们。也许你打算：

```
lyric_files .append(Lyrics(path + lyrics + '.lyr')) 
```

### 开始编辑

我现在看到我误读了这一行：

```
if lyrics[:-4].split(".")[-1] in ("wav", "mp3"): 
```

我以为是：

```
if lyrics[-4:].split(".")[-1] in ("wav", "mp3"): 
```

此代码匹配`*.mp3.???`. 如果您只是在寻找 .lyr 文件，为什么不：

```
if lyrics[-8:] in (".wav.lyr", ".mp3.lyr"): 
```

### 编辑 2

此外，这也不好：

```
try:
    lyrics[int(cmd)-1].play()
except ValueError:
    pass
except IndexError:
    pass 
```

您真的要在 .play() 中捕获并忽略 ValueError 和 IndexError 吗？反而：

```
try:
    lyric = lyrics[int(cmd)-1]
except ValueError:
    print 'You must enter a number'
except IndexError:
    print 'You must enter a number between 1 and', len(lyrics)
else:
    lyric.play() 
```

如果它正在发挥作用，这可能会帮助您找到您的问题，因为它`try`不会掩盖任何错误。

### 结束编辑

否则，如果您想从 .mp3 文件中读取歌词，您可以使用 mutagen 之类的库

```
import mutagen, mutagen.mp3, mutagen.easyid3

# . . .

mp3Tags = mutagen.mp3.MP3(mp3FileName)
lyricFrame = mp3Tags.get("USLT::'eng'")
if lyricFrame:
    lyricText = lyricFrame.text
    lyrics = lyricText.split('\n') 
```

# c# - 在画布上为矩形设置 zindex 不会将其置于前面

> ID：14489035
> 
> 赞同：2
> 
> 时间：2013-01-23T20:44:39.933
> 
> 标签：c#, wpf, canvas, z-index

我的画布和画在上面的矩形有问题。他们以相反的创建顺序获取事件（最新的在顶部），而不是 zindex 的顺序......

我已将 ItemsControl 与资源列表绑定。

然后有一个画布作为项目面板：

```
<ItemsControl.ItemsPanel>
    <ItemsPanelTemplate>
        <Canvas x:Name="BitmapCanvas"/>
    </ItemsPanelTemplate>
</ItemsControl.ItemsPanel> 
```

所有资源都绑定为矩形：

```
<ItemsControl.ItemTemplate>
    <DataTemplate DataType="interfaces:IResourceView">
        <Rectangle ...> 
```

并且有一种风格：

```
<Rectangle.Style>
    <Style TargetType="{x:Type Rectangle}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=IsSelected}" Value="true">
                <Setter Property="Canvas.ZIndex" Value="0"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=IsSelected}" Value="false">
                <Setter Property="Canvas.ZIndex" Value="15"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    ...</Rectangle.Style></Rectangle></DataTemplate></ItemsControl.ItemTemplate> 
```

正如你所看到的，当矩形被选中时，我将它的 Zindex 设置为 0，然后其他的 zindex 值更大。我也在尝试使用交换值，但矩形仍然以同样的方式获得焦点。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:02:29.450

在 DataTemplate 中的 Rectangle 上设置`Canvas.ZIndex`（或实际上是 WPF 中的[Panel.ZIndex](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.zindex.aspx)）无效，因为这些 Rectangle 不是 ItemsPanelTemplate 中 Canvas 的直接子级。换句话说，矩形不是同级，而是`ZIndex`一个相对值，只影响同一个容器控件的同级。

实际上，每个矩形都被放入 ContentPresenter 的内容中（这是 ItemsControl 的项目容器类型）。然后将这些 ContentPresenter 放入 Canvas。

为了使事情正常进行，您可以将 DataTriggers 移动到[ItemContainerStyle](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemcontainerstyle.aspx)：

```
<ItemsControl.ItemContainerStyle>
    <Style TargetType="ContentPresenter">
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=IsSelected}" Value="true">
                <Setter Property="Panel.ZIndex" Value="0"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=IsSelected}" Value="false">
                <Setter Property="Panel.ZIndex" Value="15"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
</ItemsControl.ItemContainerStyle> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:45:27.097

你的问题是你的触发器。Style 仅支持 EventTrigger，不支持任何其他类型，因此您的触发器将永远不会被执行。不过，您在 DataTemplate 中，并且它们确实支持 DataTrigger，因此您可以移动一些东西来解决问题：

```
<ItemsControl.ItemTemplate>
    <DataTemplate>
        <Rectangle x:Name="Rect"/>
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=IsSelected}" Value="true">
                <Setter TargetName="Rect" Property="Canvas.ZIndex" Value="0"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=IsSelected}" Value="false">
                <Setter TargetName="Rect" Property="Canvas.ZIndex" Value="15"/>
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>
</ItemsControl.ItemTemplate> 
```

# singleton - C++ 中的经典单例

> ID：14489038
> 
> 赞同：0
> 
> 时间：2013-01-23T20:45:00.590
> 
> 标签：singleton

我见过 C++ 中的经典单例类。我的理解是这个实现是线程安全的。然后我读到，如果这个类包含在 2 个 DLL 中并且两者都加载到 1 个应用程序中，您将获得 2 个静态变量副本，因此是 S 类的 2 个实例，因此它不是完全线程安全的。

那么解决方案还是使用互斥锁？（我知道这是 C# 中的常见做法，详见：[http ://csharpindepth.com/Articles/General/Singleton.aspx](http://csharpindepth.com/Articles/General/Singleton.aspx)

```
class S
{
    public:
        static S& getInstance()
        {
            static S    instance; 
            return instance;
        }
    private:
        S();
        S(S const&);              // Don't Implement
        void operator=(S const&); // Don't implement
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:47:44.897

静态变量的作用域是它的编译单元。

如果您有 2 个 dll 编译 2 个包含该静态成员的代码块（或者更糟糕的是，您将它放在头文件中......）那么两个 dll 都将使用该变量进行编译。

没有锁会改变这一事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T15:24:29.793

这是 C++ 中的单例代码

```
#include<iostream>
using namespace std;
class singletonClass
{

    static int i;
    static singletonClass* instance;
public:

    static singletonClass* createInstance()
    {

        if(i==0)
        {

            instance =new singletonClass;
            i=1;

        }

        return instance;

    }
    void test()
    {

        cout<<"successfully created instance";
    }
};

int singletonClass::i=0;
singletonClass* singletonClass::instance=NULL;
int main()
{

    singletonClass *temp=singletonClass::createInstance();//////return instance!!!
    temp->test();
} 
```

谢谢

# php - PHP 无法识别 MySQL 安装

> ID：14489039
> 
> 赞同：0
> 
> 时间：2013-01-23T20:45:05.547
> 
> 标签：php, mysql

伙计们，

我已经为此浪费了大约 4 个小时的生命，现在我要来找你了。我意识到以前有人问过这个问题，但是我已经广泛阅读了类似的问题，但仍然无法弄清楚我做错了什么。我使用以下来源安装了 PHP 5.2.17 和 Apache 2.2：[http ://www.thesitewizard.com/php/install-mysql-windows-vista.shtml](http://www.thesitewizard.com/php/install-mysql-windows-vista.shtml)

安装效果很好，我一直在使用它们在我的电脑上工作。我最近决定我也想尝试添加 MySQL。我使用相同的源（即上面的链接）来安装 MySQL。我安装了最新版本的 MySQL (5.5)，在我的计算机上安装它似乎一切顺利。

在我的 PHP.ini 文件中，设置了以下内容且未注释掉：

```
extension_dir = "c:\php\ext"
extension=php_mysql.dll
extension=php_mysqli.dll 
```

PHP 文件夹位于正确的位置，我查看并看到 .dll 文件确实存在于“ext”目录中。自从进行上述所有更改后，我都重新启动了 Apache 和我的计算机。

phpMyAdmin 给我这个错误：“缺少 mysqli 扩展。请检查您的 PHP 配置。” 并且函数 phpinfo() 在 test.php 页面中调用时，无法识别 MySQL 扩展（以验证它是否与 PHP 一起使用），正如我的源教程网站所说的那样。

此外，我按照教程站点的说明将这个“;c:\php”添加到了路径下的系统变量中。再次，在所有这些完成后我重新启动了计算机。多次重启Apache。MySQL 允许在正确的端口中使用。有什么想法吗？

感谢您的宝贵时间，我非常感谢。

编辑：以防万一，我在没有密码的情况下安装了 MySQL，因为它说我的 root 密码错误或其他什么，所以我卸载了它，然后在没有密码的情况下重新安装它，安装一直进行。

# java - Updating a table - when the table data array has been cleared

> ID：14489041
> 
> 赞同：3
> 
> 时间：2013-01-23T20:45:11.963
> 
> 标签：java, button, swt

**Data Model Class - Datamodel**

ArrayList = dataArray (stores data for tableviewer) clearArray() - Method that clears the array

**Table Viewer Class - DataTableViewer**

The last column of the table displays a button

**Dialog Class - DataDialog**

Create Table Viewer:

```
viewer.setInput(DataModel.getInstance().getArrayData()); 
```

Dialog Button = Clear Results:

```
DataModel.getInstance().clearArray();
viewer.refresh(); 
```

**Issue**

When the user clicks the Clear Results button. It removes the displayed data from the table. But the buttons are still displaying in the table.

I know the problem has to be because the clear button is clearing the dataArray in the DataModel. The buttons are not getting notified that the data is now gone.

How can I refresh the buttons, so when the user clears the table, the buttons clear as well?

*** EDIT ****

I did not include all code, but I have tried to show the basics for my issue. Class where I am building a arraylist of data to show in the table.

```
public class DataModel  {

   static ArrayList data = new ArrayList();

   private DataModel() {
   }

   public void buildArray(String id, String name) {
      data.add(id, name)
   }

   public void clearArray() {
      data.clear();
   }    

   public ArrayList getDataArray() {
       return data;
   }   
 } 
```

This is the table viewer class

```
public class DataTableViewer extends TableViewer {   

public DataTableViewer() {
   Table table = getTable();
   createColumns();
   table.setHeaderVisible(true);
   table.setLinesVisible(true);
   setContentProvider(new ArrayContentProvider());
}

private void createColumns() {
   TableViewerColumn col = new TableViewerColumn(this , SWT.NONE);
   col.getColumn().setWidth(150);
   col.getColumn().setText("ID");
   col.setLabelProvider(new ColorColumnLabelProvider());

   col = new TableViewerColumn(this , SWT.NONE);
   col.getColumn().setWidth(150);
   col.getColumn().setText("Name");
   col.setLabelProvider(new ColorColumnLabelProvider());

   col = new TableViewerColumn(this , SWT.NONE);
   col.getColumn().setWidth(50);
   col.getColumn().setText("");
   col.setLabelProvider(new ColorColumnLabelProvider());
}

public class ColorColumnLabelProvider extends ColumnLabelProvider {
   @Override
   public void update(final ViewerCell cell) {
      Object element = cell.getElement();
      if(element instanceof DataModel.SaveData) {
        DataModel.SaveData p = (DataModel.SaveData) element;
        switch(cell.getColumnIndex()) {            
           case 0: {
              cell.setText(p.getID());
              break;
           }
           case 1: {
              cell.setText(p.getName());
              break;
           }
           case 2: {
              Map<Object, Button> buttons = new HashMap<Object, Button>();   
              TableItem item = (TableItem) cell.getItem();
              Button button;
              String filename = (((DataModel.SaveData) element).getID() + "/" + ((DataModel.SaveData) element).getName());
              if(buttons.containsKey(cell.getElement())) {
                 button = buttons.get(cell.getElement());
              }
              else
              {
                button = new Button((Composite) cell.getViewerRow().getControl(),SWT.PUSH);
                button.setImage(appReg.getImage("ICON"));
                button.setData("file.id", filename);
                buttons.put(cell.getElement(), button);
              }
              TableEditor editor = new TableEditor(item.getParent());
              editor.grabHorizontal  = true;
              editor.grabVertical = true;
              editor.setEditor(button , item, cell.getColumnIndex());
              button.addListener(SWT.Selection, new SelectionListener());
              editor.layout();
              break;
           }

class SelectionListener implements Listener {

  public SelectionListener() {
  }

  @Override
  public void handleEvent(Event event) {
    if (event.widget instanceof Button) {
      String fileId =  (String) event.widget.getData("file.id");
      final File viewerFile = new File(fileId);
      try {
        Desktop.getDesktop().open(viewerFile);
      }
      catch (IOException e) {
        e.printStackTrace();
      }
    }
  }
  }// End SelectionListener Class
} 
```

This is the dialog class that displays the tableviewer built from the arraylist from the DataModel class and using the table from DataTableViewer class.

```
 public class DataDialog extends TitleAreaDialog {

   Button clearButton;
   DataTableViewer  viewer;

    public DataDialog() {
    }

    protected Control createDialogArea() {
        createClearResultsButton();
        createTableViewer();
}

private void createTableViewer() {
    viewer = new DataTableViewer(parent, SWT.BORDER|SWT.V_SCROLL|SWT.FULL_SELECTION | SWT.MULTI);
        viewer.setInput(DataModel.getInstance().getDataArray());
}

protected void createClearResultsButton() {
    clearButton = new Button(composite, SWT.PUSH);
        clearButton.setText("Clear Results");
        clearButton.addSelectionListener(new SelectionAdapter() {
          public void widgetSelected(SelectionEvent e) {
             boolean more = MessageDialog.openConfirm(null, "Confirmation Message", "Are you sure you want to remove all results from the table?");
           if(more == true) {
              clearTableRows(); 
           }
        }
    });
}

public void clearTableRows() { 
     DataModel.getInstance().clearDataArray();
     viewer.refresh();
 }
} 
```

The Basic Issue :
1\. DialogData class - opens

1.  User sees 2 rows in the table with a button for each row in the 3rd column.

2.  Each button corresponds with specific data in their row (maybe filename)

3.  The user is finished viewing the data in the table.

4.  The user clicks on the clear button to remove the data

5.  Clicked method clears the ArrayList data in DataModel class. The code then refreshes the viewer.

6.  The user now sees a blank table, but the buttons are still visible.

I am trying to figure out how to dispose of the buttons or how to clear the Button map in the DataTableViewer Class, when the rest of the data is cleared.

I think when the data is clear, that does not reset the buttons. So the buttons that has already been create is still valid and stored in the Map.

I hope this is more understanding.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T09:23:59.517

With the method `viewer.getTable().getChildren();` you are able to access all children of the `Table`.

You are able to iterate over all children of the `Table` and dispose the `Button`s manually.

```
Control[] children = viewer.getTable().getChildren();
for(Control element : children) {
    if(element instanceof Button) {
        element.dispose();
    }
} 
```

I couldn't get your example running, so I hope it works for your case. You probably have to paste my code in your method `clearTableRows();`

Something like this:

```
public void clearTableRows() {
    DataModel.getInstance().clearDataArray();

    Control[] children = viewer.getTable().getChildren();
    for (Control element : children) {
        if (element instanceof Button) {
            element.dispose();
        }
    }
    viewer.refresh();
} 
```

Source:

*   Eclipse API: [`Composite.getChildren()`](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/Composite.html)

# .net - 无法在类中创建第二个字典属性

> ID：14489055
> 
> 赞同：0
> 
> 时间：2013-01-23T20:45:57.797
> 
> 标签：.net, vb.net

clsFile 有 2 个字典，但是，在构造函数中，第一个字典总是创建，但第二个字典最终是 Nothing

字典相同（Of Long，clsEmployee）；但之前我尝试制作第二个（Long，clsCondition）和（Of String，clsCondoition） - 无济于事。类 clsEmployee 和 clsCondition 也是代码中的对象。

clsFile 的代码：

```
Option Explicit On
Imports System.Data.OleDb
Imports System.Data.SqlClient
Imports System.Text.RegularExpressions

Public Class clsFile

'-- CLASS LOCAL VARIABLES DECLARATION
Private cnDB As SqlConnection
Private m_Number As String
Private m_Auditor As clsEmployee
Private m_User As clsEmployee
Private m_Reviewer As clsEmployee
Private m_FileTypeId As Long
Private m_ReviewStatusId As Long
Private m_ActionDTTM As Date
Private m_SelectDTTM As Date
Private m_ReviewDTTM As Date

Private m_inAudit As Boolean
Private m_ReviewersDict As Dictionary(Of Long, clsEmployee)
Private m_ConditionsDict As Dictionary(Of Long, clsEmployee)

**************************************PROPERTIES***********************************

  Public Property Reviewers() As Dictionary(Of Long, clsEmployee)
    Get
        Reviewers = m_ReviewersDict

    End Get

    Set(ByVal ReviewersDict As Dictionary(Of Long, clsEmployee))
        m_ReviewersDict = ReviewersDict
    End Set
End Property

Public Property Conditions() As Dictionary(Of Long, clsEmployee)
    Get
        Conditions = m_ConditionsDict

    End Get

    Set(ByVal ConditionsDict As Dictionary(Of Long, clsEmployee))
        m_ConditionsDict = Conditions
    End Set
End Property 
```

***** ** *** ** *** ** *** ** *** ****构造函数****** ** *** ** *** ** *** ** *** ** *** ** *****

```
 Public Sub New(*arguments provided*)
    number= strLoanNumber

    Me.Reviewer = New clsEmployee(RVWR_ID)
    Me.Reviewer.Dept.Id = RBW_Dept_ID
    Me.Auditor = New clsEmployee(AUD_ID)
    Me.User = New clsEmployee(USR_ID)

    Me.Reviewers = New Dictionary(Of Long, clsEmployee)
    Me.Conditions = New Dictionary(Of Long, clsEmployee) 

    cnDB = SQLcn

End Sub 
```

* * *

` 单步执行代码时 - Me.Conditions = 即使在构造函数运行后也没有。我使用 VB.net，VS2005。

任何想法为什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:54:19.050

一定

```
Set(ByVal ConditionsDict As Dictionary(Of Long, clsEmployee))
        m_ConditionsDict = Conditions
End Set 
```

应该

```
Set(ByVal ConditionsDict As Dictionary(Of Long, clsEmployee))
        m_ConditionsDict = ConditionsDict
End Set 
```

?

# git - git cherry-pick 是否保存任何元数据？

> ID：14489056
> 
> 赞同：8
> 
> 时间：2013-01-23T20:46:01.643
> 
> 标签：git

给定一个从分支中挑选到 master 中的提交，然后将该分支合并回 master：

git 是如何知道来自前一个 cherry-pick 的更改不应该与来自合并的更改发生冲突的？是否有任何类型的元数据与精心挑选的提交一起保存？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T20:52:36.360

不，采摘樱桃的行为也没有什么特别之处。当合并的任一侧发生完全相同的更改时，Git*总是会注意到。*提交甚至不必看起来很相似。只要某些文本以相同的方式开始并以相同的方式结束，就没有理由将其标记为冲突。

# excel - 当我读入一个变量时，为什么 matlab 会返回这个？

> ID：14489058
> 
> 赞同：2
> 
> 时间：2013-01-23T20:46:12.217
> 
> 标签：excel, matlab, xls

我有一个 excel 数据集，其中有一列是我想读入 Matlab 的文件路径列表。当我使用`xlsread`命令时，我得到以下结果

```
raw = 

'files'        
[1x135 char]  
[1x135 char] 
[1x141 char] 
[1x141 char] 
[1x149 char]
[1x149 char] 
```

现在我知道元素 1 中的文件路径是 135 个字符，但我不明白的是如何让 Matlab 显示路径。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:51:57.740

您可能想看看[cell arrays](http://www.mathworks.co.uk/help/matlab/cell-arrays.html)。正如[xlsread 文档所述](http://www.mathworks.co.uk/help/matlab/ref/xlsread.html#outputarg_raw)，`raw`输出参数是元胞数组。元胞数组元素的访问方式如下：

```
myPath = raw{2} 
```

注意花括号而不是普通括号。显示元胞数组内容时，MATLAB 将仅在低于特定大小时显示矩阵的内容，这就是为什么您的所有路径都没有以这种格式显示的原因。

# c# - Json 日期格式到 .net DateTime

> ID：14489059
> 
> 赞同：-3
> 
> 时间：2013-01-23T20:46:18.177
> 
> 标签：c#, .net, json

在过去的两个小时里，我试图将此 /Date(1358805600000)/ 转换为正常日期。没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:50:05.573

您可以从 Epoch 开始并添加秒数：

```
public static DateTime UnixTimeToDateTime(long UnixTime)
{
   DateTime epoch = new DateTime(1970,1,1,0,0,0,0);

   return epoch.AddSeconds(UnixTime).ToLocalTime();
} 
```

请注意，这不会*给*您一个 JSON 日期（无论是什么），而是一个普通`DateTime`对象。然后，您可以使用[JSON.NET 之](http://json.codeplex.com/)类的 JSON 序列化程序将此`DateTime`对象转换为 JSON 字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:27:23.177

抢先 Marc B 的评论，以提供可接受的答案：

没有“json”日期之类的东西。Json 只是一种编码格式。这是一个 JavaScript 时间戳，自 1970 年 1 月 1 日以来的毫秒数。

除以 1000，你得到一个标准的 unix 时间戳（以秒为单位）。

# android - Android 模拟器发送网络提供商更新

> ID：14489064
> 
> 赞同：2
> 
> 时间：2013-01-23T20:46:42.997
> 
> 标签：android, ddms, android-location

如何将更新发送到 Android 模拟器，就好像它们来自“网络”提供商一样。DDMS 似乎作为“gps”提供者发送，没有办法改变它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:55:58.633

据我所知，不幸的是，您不能在模拟器中使用“网络”提供程序。

> 注意：提供模拟位置数据是作为 GPS 位置数据注入的，因此您必须从 GPS_PROVIDER 请求位置更新才能使模拟位置数据起作用。

[http://developer.android.com/guide/topics/location/strategies.html#MockData](http://developer.android.com/guide/topics/location/strategies.html#MockData)

# java - 如何将 BufferedReader 包裹在 FileReader 周围？

> ID：14489068
> 
> 赞同：0
> 
> 时间：2013-01-23T20:46:58.623
> 
> 标签：java, bufferedreader, filereader

我将如何在 readFileFixed 方法中实现/包装 FileReader 周围的 BufferedReader？我还需要调查：

1.  变量初始化。
2.  异常处理
3.  关闭阅读器
4.  我如何阅读文件。

任何提示将不胜感激。

```
package codeTest;

import java.io.File;
import java.io.FileReader;
import java.io.IOException;

import java.util.Scanner;

public class CodeTestExerciseBadCode {

    private static final String testFilename = "CodeTestExerciseBadCode.java";

    public CodeTestExerciseBadCode() {}

    public static void main(String[] args) throws IOException {
        CodeTestExerciseBadCode part2 = new CodeTestExerciseBadCode();

        System.out.println(part2.readFileFixed());
    }

    public String readFile() {
        File f = null;
        FileReader fr = null;
        StringBuffer content = null;

        try {
        f = new File(testFilename);
        fr = new FileReader(f);

        int c;

            while ((c = fr.read()) != -1) {
                if (content == null) {
                content = new StringBuffer();
                }

            content.append((char) c);
            }

        fr.close();
        } catch (Exception e) {
            // Error message along with the cause of the Error
            throw new RuntimeException("An error occured reading your file", e);
        }

    return content.toString();
    }

    public String readFileFixed() throws IOException {
        StringBuffer content = null;
        File file = new File(testFilename);

        // I added this as a test. If directory name is provided then no issues
        if (file.isFile() && (file.length() > 0)) {

            // Placed inside the if() block, to avoid creating it unnecessarily if not needed
            content = new StringBuffer();

            try {
                Scanner scanner = new Scanner(file);

                while (scanner.hasNextLine()) {
                    content.append(scanner.nextLine());
                    content.append(System.getProperty("line.separator"));
                }

            } catch (Exception e) {
                // Throw an exception instead of printing the stack trace
                throw new IOException("An error occured reading your file", e);
            }
        }

        return((content == null)
        ? ""
        : content.toString());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:54:40.157

类似的东西

```
String s;
File file = new File("file.txt");
StringBuilder content = new StringBuilder( (int) file.length());
BufferedReader r = new BufferedReader(new FileReader(file));
try {
  while ( (s = r.readLine()) != null ) {
    content.append(s);
    content.append('\n');
} finally {
    r.close();
} 
```

此外，在此网页的右侧，您会看到许多可能有用的链接。

# ios - NSDictionary 释放触发 valueForKey 返回值释放

> ID：14489071
> 
> 赞同：3
> 
> 时间：2013-01-23T20:47:16.433
> 
> 标签：ios, objective-c, memory-management, nsdictionary, nsmutabledictionary

我目前正在尝试自己进行 iOS 开发。现在我无法理解内存管理。这是我困惑的原因：

```
NSString *path = [self.dataPath stringByAppendingPathComponent:@"dummy.plist"];
NSMutableDictionary *dict = [[NSMutableDictionary alloc] initWithContentsOfFile:path];
NSString *dummyKeyValue = [dict valueForKey:@"dummyKey"];

// NSLog(@"%@",[NSString stringWithString:dummyKeyValue]);

[dict release];

NSString *anotherString = [dummyKeyValue lowercaseString]; 
```

这段代码在最后一行触发了 EXC_BAD_ACCESS 错误。似乎是因为 NSDictionary 释放了它的键值。我不明白的是为什么`dummyKeyValue`没有考虑定义，因为显然`dummyKeyValue`仍然指向`"dummyKey"`.

现在，当您注释掉该`NSLog`行时，会出现下一个问题甚至更有趣的现象。以`dummyKeyValue`一种或另一种方式使用似乎可以防止释放它指向的内存。为什么？

帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:56:55.337

在手动引用计数模式下，简单地定义一个变量并不意味着变量指向的对象会自动保留。当`dict`被释放时，它释放它的值对象，如果没有其他对象对它们有强引用（即它们的引用计数现在为0），它们被释放。这就是你在这里看到的。

如果要保留对 dummyKeyValue 的强引用，则需要在收到后保留。当然，这也意味着你需要在完成后释放它。试试这个：

```
NSString *dummyKeyValue = [[[dict valueForKey:@"dummyKey"] retain] autorelease]; 
```

现在 dummyKeyValue 将一直存在，直到当前自动释放池范围结束。通常，访问器方法被编写为在返回值之前执行此操作，以避免您所看到的情况。

值得注意的是，如果您使用的是 ARC（自动引用计数），则不会出现此问题，因为编译器会插入必要的保留/释放调用，以确保 dummyKeyValue 一直存在，直到您完成它为止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:56:09.040

这是基本的内存管理。当您创建`dict`时，字典正在管理它包含的所有键和值的内存。

当您获得一个值并将其分配给您的`dummyKeyValue`变量时，您不会对该值进行任何额外的内存管理。您只需有一个指向对象的变量。

现在，当您 release 时`dict`，字典也会释放其所有键和值。换句话说，所有键和值的保留计数都减一。由于此时没有其他任何东西保留了键和值，因此它们都被释放了。

此时，您的`dummyKeyValue`变量指向导致崩溃的已释放值。

您必须选择解决此问题。

1.  保留存储的值`dummyKeyValue`（需要释放）。
2.  `[dict release]`在您最后一次使用 后，将呼叫移至`dummyKeyValue`。

该`NSLog`语句似乎可以解决问题的原因是您`NSLog`创建了一个 autoreleased `NSString`。这`NSString`将保留您用于创建它的值。因此，当 `dict`被释放时，`NSString`仍然具有对与 . 相同的对象的引用`dummyKeyValue`。这允许该对象的寿命更长一些，以防止崩溃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T20:56:42.073

（您应该使用`objectForKey:`从 . 中检索东西`NSDictionary`。）

首先，打开 ARC。如果您刚开始使用 Cocoa，那么除了内存管理之外，您还需要学习有关环境的许多其他内容。供应商捆绑的编译器将处理您 99% 的内存管理问题，您应该让它解决。这一直是 Cocoa 新开发人员的主要绊脚石，现在已被排除。一旦你掌握了其他所有内容，稍后再回到这个主题。现在，忽略此答案的其余部分。没有第三步。

也就是说，这就是这里发生的事情：

当您使用 将对象从字典中取出时`objectForKey:`，您不会获得它的所有权。它只是一个引用，字典仍然拥有该对象。如果你销毁字典，它的所有对象都会随之而来——除非它们也被其他东西拥有（保留）。如果您希望对象在字典被破坏后仍然存在，您需要使用以下命令对其进行声明`retain`：

```
NSString *dummyKeyValue = [[dict objectForKey:@"dummyKey"] retain]; 
```

像这样获得所有权后，您现在还负责放弃该所有权，方法是`release`在您完成对象时使用，或者通过自动释放它，在这种情况下，它将在此方法结束后的某个时间释放。

使用检索到的对象作为参数`stringWithString:`使其继续存在，因为显然，作为您不能依赖的内部细节，该方法正在保留和自动释放参数。或者其他你不能依赖的东西。这是一个有趣的发现，但不是管理对象生命周期的实用方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:56:01.583

你应该写：

```
NSString *dummyKeyValue = [[dict valueForKey:@"dummyKey"] retain]; 
```

或者

```
NSString *dummyKeyValue = [[dict valueForKey:@"dummyKey"] copy]; 
```

你有一个对象的引用并不重要，因为你没有使用 ARC。每个对象都有一个引用计数。在您`dummyKeyValue`的字典存在之前，您的 ref 计数为 1。当你释放它时，引用计数减少（变为 0）并且对象被释放。所以`dummyKeyValue`没有任何意义。

顺便说一句，如果您想增加对象的引用计数，请使用`retain`和`release`来减少它。

# python - Python AWS BOTO 错误

> ID：14489072
> 
> 赞同：1
> 
> 时间：2013-01-23T20:47:25.647
> 
> 标签：python, amazon-web-services, amazon-ec2, boto

所以我试图让所有实例通过 python 检查它们的状态。

我在这里找到了一个有人建议的脚本，看起来像这样：

```
from boto.ec2.connection import EC2Connection

conn = EC2Connection('MY Key ID', 'Secret Access Key')

reservations = conn.get_all_instances()
instance = reservations.instances[0]
print instance.status 
```

但是，每次我运行它时，我都会收到如下错误：

```
File "/usr/lib/python2.7/dist-packages/boto/ec2/connection.py", line 466, in get_all_instances
, verb='POST')
File "/usr/lib/python2.7/dist-packages/boto/connection.py", line 882, in get_list
response = self.make_request(action, params, path, verb)
File "/usr/lib/python2.7/dist-packages/boto/connection.py", line 868, in make_request
return self._mexe(http_request)
File "/usr/lib/python2.7/dist-packages/boto/connection.py", line 794, in _mexe
raise e
socket.gaierror: Errno -2 Name or service not known 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:54:25.207

与其直接构造 EC2Connection 对象，不如尝试以下方法：

```
import boto.ec2
conn = boto.ec2.connect_to_region('us-east-1',
                                  aws_access_key_id='<access_key>',
                                  aws_secret_access_key='<secret_key>')

reservations = conn.get_all_instances()
instances = [i for r in reservations for i in r.instances]
for instance in instances:
    print instance.id, instance.state 
```

那对你有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-09T16:17:12.470

boto--- 文档实际上告诉您使用 AWS CLI 工具来执行凭证

特别是这篇文章：[https ://boto3.readthedocs.io/en/latest/guide/quickstart.html](https://boto3.readthedocs.io/en/latest/guide/quickstart.html)

```
 If you have the AWS CLI installed, 
 then you can use it to configure your credentials file:   aws configure 
```

希望能帮助到你

# asp.net-mvc-3 - mvc3小数四舍五入2位

> ID：14489076
> 
> 赞同：2
> 
> 时间：2013-01-23T20:47:46.647
> 
> 标签：asp.net-mvc-3, sql-server-2008, decimal

我有一个接受纬度和经度的模型，但是由于某种原因，在创建模型时，它会不断将纬度/经度四舍五入到小数点后 2 位，而不是保存整个值，例如这个 -81.39522999999997 保存为 -81.39000000000000 我该如何修复这？

我的模型是

```
public decimal? longit { get; set; } 
```

观点是

```
@Html.HiddenFor(model => model.longit, new {@Value = "-81.39522999999997" }) 
```

我的 MSSQL 保存为 longit Decimal(16,14)

如果我的经度为 103.39522999999997，那么快速问题 16,14 表示左侧 2 位数字和右侧 14 位数字，是否会产生错误？因为它将是 (16,13) 这是我第一次使用小数..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T01:06:48.193

嘿大家我学会了怎么做..如果你曾经想过这样做

1.  您需要转到初始化实体表的 Context 类..

    公共 DbSet 重新列出 { 获取；放; } 看起来类似然后你写这段代码

    ```
    public class mycontext : DbContext
    {
    public DbSet<relisting> relistings { get; set; }
    //this is the code you write
     protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<relisting>().Property(x => x.latit).HasPrecision(16, 14);
        modelBuilder.Entity<relisting>().Property(x => x.longit).HasPrecision(16, 14);

    }
    //ends here
       } 
    ```

重新列出是小数点所在的模型的名称，然后 x=> **x.mydecimal**是您想要的小数点属性，然后您可以精确地输入您想要的东西有多精确.. 工作就像一个魅力

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-02T00:10:01.703

在我的情况下，我使用实体框架将其转换为十进制（来自 SQL Server `Decimal(9,6)`，因为这似乎高达 0.1m。

纬度/经度不需要任何接近双精度的地方。

无论如何，我可以通过`DisplayFormatAttribute`在我的纬度/经度属性上添加一个来对抗 MVC：

```
[DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = {0:0.######})] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:49:12.253

如果您需要这种精度，请使用[`double`](http://msdn.microsoft.com/en-us/library/system.double.aspx)而不是：[`decimal`](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)

```
public double? longit { get; set; } 
```

十进制代表金钱，双精度代表科学。由于您在这里做科学（计算纬度和经度）而不是处理金钱，因此您最好使用正确的数据类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-07T19:56:24.753

旧帖子，但是当更新的货币汇率仅以小数点后 2 位保存到数据库时，这也让我困惑了一段时间（事实证明，这是默认值）。我对可以这样设置的实体使用模型映射：-

```
public class CurrencyMapping : EntityTypeConfiguration<Currency>
{
    public CurrencyMapping()
    {
        HasKey(x => x.Id);
        Property(x => x.Id).IsRequired();
        // .HasPrecision(precision, scale)
        // 'precision' is the total number of digits the db will store,
        // regardless of where the decimal point falls 
        // 'scale' is the number of decimal places that will be stored
        Property(x => x.Rate).IsRequired().HasPrecision(16, 6);
    }
} 
```

# gradle - Gradle 忽略传递依赖

> ID：14489078
> 
> 赞同：4
> 
> 时间：2013-01-23T20:47:52.087
> 
> 标签：gradle, gradlefx

我正在尝试使用一个 Flex 库 (SWC)，它在它的 POM 中定义了一些依赖项。我希望 Gradle 会自动提供这些传递依赖。但是，`gradle dependencies`仅显示手动添加的一个依赖项。

```
merged
\--- com.example:flex-core:1.0.0 
```

库的 POM 文件包含以下内容：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.example</groupId>
  <artifactId>flex-core</artifactId>
  <version>1.0.0-SNAPSHOT</version>
  <packaging>swc</packaging>
  <dependencies>
    <dependency>
      <groupId>org.as3commons</groupId>
      <artifactId>as3commons-lang</artifactId>
      <version>0.3.6</version>
      <type>swc</type>
      <scope>external</scope>
    </dependency>
    <dependency>
      <groupId>org.as3commons</groupId>
      <artifactId>as3commons-collections</artifactId>
      <version>1.3.2</version>
      <type>swc</type>
      <scope>external</scope>
    </dependency>
    <dependency>
      <groupId>org.as3commons</groupId>
      <artifactId>as3commons-reflect</artifactId>
      <version>1.6.0</version>
      <type>swc</type>
      <scope>external</scope>
    </dependency>
  </dependencies>
</project> 
```

我在我的添加了以下依赖项`build.gradle`：

```
dependencies {
    merged 'com.example:flex-core:1.0.0@swc'
} 
```

为什么 Gradle 会忽略 POM 的依赖关系？是因为“外部”范围吗？是否可以在不手动添加的情况下获取这些依赖项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T22:24:23.460

在声明依赖项 ( )时，您使用的是[仅工件表示法。](http://gradle.org/docs/current/userguide/userguide_single.html#artifactOnly)`@scw`这意味着 Gradle 将仅检索工件本身，而不使用 POM 中的传递依赖项。

试试这个：

```
dependencies {
    merged 'com.example:core:1.0.0'
} 
```

名字不应该是`flex-core`吗？至少 POM 上面是这么说的。

# qt - 如何在 CGL 和 Qt 之间共享 GL 上下文？

> ID：14489080
> 
> 赞同：1
> 
> 时间：2013-01-23T20:47:55.423
> 
> 标签：qt, opengl

源代码 A 使用`CGLContextObj`.

源代码 B 使用`QGLContext`.

有什么方法可以让这些代码共享一个 GL 上下文？

*   可以`QGLContext`从 a 设置`CGLContextObj`吗？
*   可以`CGLContextObj`从 a 设置`QGLContext`吗？
*   可以从其他类型设置a`QGLContext`和 a吗？`CGLContextObj`

（我知道这`CGLContextObj`是 Apple 特有的，而`QGLContext`与平台无关。假设代码只能在 Mac 上运行。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:03:21.880

当前的 GL 上下文[存储在一个公共线程局部变量](http://www.opengl.org/wiki/Context)中，无论您在给定平台上使用哪个应用程序框架。所以设置好后`QGLContext`，可以调用`CGLGetCurrentContext()`获取对应的`CGLContextObj`。

# ruby - 我们可以使用 selenium-webdriver 找到内部 HREF 值吗？

> ID：14489081
> 
> 赞同：0
> 
> 时间：2013-01-23T20:48:01.367
> 
> 标签：ruby, selenium-webdriver, xpath

请找到以下html代码：

```
<fieldset class="attachmentTable large"><legend>SMF&nbsp;:</legend>
<table cellspacing="2" cellpadding="2" border="0">
<tr> <td> <a href="
/aems/file/test.html"> </a> </td>
<td>   foo     </td>
</tr>  </table>
</fieldset>

<fieldset class="attachmentTable large"><legend>tax&nbsp;:</legend>
<table cellspacing="2" cellpadding="2" border="0">
<tr> <td> <a href="

/relf/file/test.html">

</a></td>
<td>  foo   </td>
</tr> </table>
</fieldset> 
```

Usinf`XPATH`和`selenium-webdriver`我们可以`/aems/file/test.html`从 html 的部分得到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:08:16.697

这可能对你有用

```
link = @driver.find_element(:xpath,"//fieldset[contains(@class,'attachmentTable')]/table/tr/td/a")
href= link.attribute("href")
puts href 
```

**更新**

我之所以选择`contains`是因为[这个](http://cweiske.de/tagebuch/XPath%3a%20Select%20element%20by%20class.htm)

# jquery - 滚动捕捉以对 100% 高度的 div 产生影响

> ID：14489085
> 
> 赞同：0
> 
> 时间：2013-01-23T20:48:10.700
> 
> 标签：jquery, css, scroll

我正在寻找添加滚动效果，释放滚轮时捕捉到 div 的顶部。唯一的问题是每个 div 都有 100% 的高度（因此一次将在屏幕上显示一个图像）。
我遇到了这个小提琴： http: [//jsfiddle.net/djsbaker/dxzk4/](http://jsfiddle.net/djsbaker/dxzk4/)似乎在 300px 的间隔下工作得很好，但是如何将这样的东西翻译成 100% 高度的 div？

这是我的代码：

```
<div class="fill-browser" style="background-image: url(../images/background-v2.jpg)"></div>
<div class="fill-browser" style="background-image: url(../images/background-v2.jpg)"></div>
<div class="fill-browser" style="background-image: url(../images/background-v2.jpg)"></div> 
```

CSS：

```
 .fill-browser{
    position:relative;
    left: 1%;
    height:98%;
    width:98%;
    margin-bottom: 5px;
    background: no-repeat 50% 50%;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
            } 
```

这里也是一个 jsfiddle 演示：http: [//jsfiddle.net/vHAWW/](http://jsfiddle.net/vHAWW/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:58:55.597

它也可以 100% 工作，

取决于你有多少盒子，你需要将盒子的父高度设置为盒子 * 100，盒子的高度设置为 100/盒子，也不要忘记将 body 和 html 设置为 100%。

jsfiddle.net/WQtA8

```
body, html {
    height:100%;
}
.box
{
    color: #fff;
    height: 10%;
    width: 300px;
    border: 1px solid white;
}
#container {
    height:1000%;
    width:300px;
    background-color:blue;
}
.red {background-color:red;}
.green {background-color:green;}
.yellow {background-color:yellow;} 
```

编辑：

既然您已经使用 jquery，不妨动态计算和设置高度：

```
$(document).ready(function() {

var boxes = $(".box").length;
var height = boxes * 100 + "%";
var boxheight = 100/boxes + "%";
$("#container").css({ height : height });
  $(".box").css({height: boxheight});
}); 
```

# javascript - 通过 URL 传递 JavaScript 变量

> ID：14489087
> 
> 赞同：3
> 
> 时间：2013-01-23T20:48:14.177
> 
> 标签：javascript

我有一个使用 javascript 设置一些变量的页面，`Math.random()`如图所示。

```
var RandomValue1 = Math.floor(Math.random() * 5);
var RandomValue2 = Math.floor(Math.random() * 6);
var string = array1[RandomValue1];
var string = array2[RandomValue2]; 
```

我想允许用户将`RandomValue`值通过传递`URL`给另一个人。当第二个人去 shared`URL`时，`RandomValue`是第一个人的价值 - 以便第二个人看到与第一个人相同的“字符串”。

我对网页设计和网页编程相当陌生，所以我不知道这是否需要在服务器端或客户端处理。

我假设我需要传递一个类似的 url，`page1.html?RandomValue1=1&RandomValue2=3`但我无法让页面然后设置这些变量并加载。这可以在 内完成`JavaScript`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:56:44.267

您可以使用 javascript 读取 GET 变量。这是一个示例函数（[source](http://papermashup.com/read-url-get-variables-withjavascript/)）：

```
function getUrlVars() {
  var vars = {};
  var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
    vars[key] = value;
  });
  return vars;
} 
```

用法：

```
var first = getUrlVars()["id"];
var second = getUrlVars()["page"];

alert(first);
alert(second); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:52:57.933

你的假设是正确的。您需要将这些变量作为参数放入 URL。我会进一步建议使用“#”而不是实际参数，这样您就不会冒险每次都更新页面，因此 URL 看起来像 mydomain.com/page.html#RandomValue1=1&RandomValue2=3。

您可以使用 Javascript 通过 window.location.href 方法获取/设置这些参数。在页面加载时，Javascript 将检查是否有“#”并解析 URL 中的任何内容。页面加载后，可以使用 Javascript 更新这些参数。

有关如何使用 window.location 的完整文档，请参阅以下链接：

[https://developer.mozilla.org/en-US/docs/DOM/window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)

哦，这是一个 javascript 库，可以帮助您更快地到达那里。它与哈希 ('#') 一起使用，并会自动为您解析（取消参数化）参数，将它们分配给您可以使用的字符串/对象等。

[http://benalman.com/projects/jquery-bbq-plugin/](http://benalman.com/projects/jquery-bbq-plugin/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:50:39.437

我会用 PHP 来做。

您可以在页面上放置一个隐藏字段（在表单中）。将表单方法设置为 GET 并将操作设置为另一个 PHP 页面。

```
<form id="form" name="form" action="my_page.php" method="GET">
  <input id="myId" name="myName" type="hidden />
</form> 
```

在 PHP 页面中，您可以使用 $_GET 对象管理变量。

```
<?php
  if(isset($_GET['myName'])){
    //do something with value;
  }
?> 
```

请记住，GET 和 POST 变量基于 HTML 元素的 name 属性。在我的示例中，隐藏字段的名称为`myName`，所以当我想引用它时，我使用`$_GET['myName'];`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:52:48.210

您将需要使用服务器来协调两个客户端之间的数据。换句话说，第一个用户需要将他们的随机值提交给服务器——这可以使用 GET URL 来完成，`page1.html?RandomValue1=1`尽管您可能想研究 POST 请求。

无论如何，然后第二个用户可以转到共享 URL 以查看存储在服务器上的值。

# jquery - 转换为参数字符串时缺少数组索引

> ID：14489088
> 
> 赞同：1
> 
> 时间：2013-01-23T20:48:15.340
> 
> 标签：jquery, ajax

我正在尝试将简单数组转换为参数字符串

```
$j.param({ instances: [1, null, null, null, null, null, null] }) 
```

但是输出是

```
instances%5B%5D=1&
instances%5B1%5D=null&
instances%5B2%5D=null&
instances%5B3%5D=null&
instances%5B4%5D=null&
instances%5B5%5D=null&
instances%5B6%5D=null 
```

转换为

```
instances[]=1
instances[1]=null
instances[2]=null
instances[3]=null
instances[4]=null 
```

为什么第一个元素缺少它的索引？我正在使用 jQuery v1.7.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:17:14.593

```
$j.param({ instances: [1, '', '', '', '', '', ''] }) 
```

工作正常，谢谢大家的意见！

# c# - 表单未显示在 Show() 上，因为它正在被使用（？）

> ID：14489095
> 
> 赞同：1
> 
> 时间：2013-01-23T20:48:39.500
> 
> 标签：c#, forms, docking

我在尝试从这个[Dock Container](http://www.codeproject.com/Articles/25976/Visual-Studio-IDE-like-Dock-Container)中删除表单时遇到了麻烦，一旦我使用了`dockContainer.Add(form)`，`dockContainer.Remove(dockableFormInfo)`然后当我使用 使其显示自己时`form.Show()`，它根本不会显示。

通过属性查看它显示表单实际上是`visible = true`，但即使使用 Form 的可停靠控件已从容器中删除，我的想法是它仍然使用 Form 资源，因此我无法使其出现在控件之外.

如何使表格显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T12:57:21.507

问题解决了，首先感谢 Hans Passant 的 TopLevel 提示。

从停靠容器中移除后，只需将**TopLevel 设置为 true**！

这是测试代码：

```
using System;
using System.Drawing;
using System.Windows.Forms;
using Crom.Controls.Docking;

namespace DockingTester
{
    public partial class Form1 : Form
    {
        private Form dummyForm;
        private readonly Guid dummyFormGuid = Guid.NewGuid();

        public Form1()
        {
            InitializeComponent();
            CreateDummyForm();
            this.dummyForm.Show();
        }

        private void CreateDummyForm()
        {
            dummyForm = new Form();
            this.dummyForm.Text = "Dummy docking test form";
        }

        private static void DockUndockForm(DockContainer dockContainer, Form form, Guid guid)
        {
            DockableFormInfo formInfo = dockContainer.GetFormInfo(guid);

            //Add
            if (formInfo == null)
            {
                formInfo = dockContainer.Add(form, zAllowedDock.All, guid);
                dockContainer.DockForm(formInfo, DockStyle.Left, zDockMode.Inner);
            }
            //Remove
            else
            {
                Form dummy =  formInfo.DockableForm;
                dockContainer.Undock(formInfo, new Rectangle(Point.Empty, new Size(100, 300)));
                dockContainer.Remove(formInfo);

                dummy.FormBorderStyle = System.Windows.Forms.FormBorderStyle.Sizable;
                dummy.TopLevel = true;
            }
        }

        private void dockUndockButton_Click(object sender, EventArgs e)
        {
            if (this.dummyForm.IsDisposed)
                CreateDummyForm();
            DockUndockForm(this.dockContainer1, this.dummyForm, this.dummyFormGuid);
        }

    }
} 
```

# php - opencart 类别产品中的最后一个产品 - 图片

> ID：14489102
> 
> 赞同：0
> 
> 时间：2013-01-23T20:49:14.297
> 
> 标签：php, image, opencart, product

我创建电子商店，我的第一个问题是，我不知道如何将最后一个产品（如图像）制作到下一页。

看这里：[http](http://puoskis24.lt/index.php?route=product/category&path=63) ://puoskis24.lt/index.php?route=product/category&path=63你可以看到列表中显示了 15 个产品，如何制作 16 个（最后一个产品是 16 个空白区域）产品将是我的图片？

这是我的产品页面代码（category.tpl）：

```
<div class="product-list">

<?php foreach ($products as $product) { ?>
<div>

  <?php if ($product['thumb']) { ?>
  <div class="image"><a href="<?php echo $product['href']; ?>"><img src="<?php echo $product['thumb']; ?>" title="<?php echo $product['name']; ?>" alt="<?php echo $product['name']; ?>" /></a></div>
  <?php } ?>
  <div class="name" style="text-align:center;display: inline;"><a href="<?php echo $product['href']; ?>"><p><?php echo $product['name']; ?></p></a></div>
  <div class="description"><?php echo $product['description']; ?></div>
  <?php if ($product['price']) { ?>
  <div class="price" style="text-align:center;display: inline;">
    <?php if (!$product['special']) { ?>
    <?php echo $product['price'];?>
    <?php } else { ?>
    <span class="price-old"><?php echo $product['price']; ?></span> <span class="price-new"><?php echo $product['special']; ?></span>
    <?php } ?>
    <?php if ($product['tax']) { ?>
    <br />
    <span class="price-tax"><?php echo $text_tax; ?> <?php echo $product['tax']; ?></span>
    <?php } ?>
  </div>
  <?php } ?>
  <?php if ($product['rating']) { ?>
  <div class="rating"><img src="catalog/view/theme/default/image/stars-<?php echo $product['rating']; ?>.png" alt="<?php echo $product['reviews']; ?>" /></div>
  <?php } ?>
    <div class="cart" style="display:none;">

    </div>
  <div class="wishlist"><!--<a onclick="addToWishList('<?php echo $product_id; ?>');"><?php echo $button_wishlist; ?></a>--></div>
<div class="compare"><!--<a onclick="addToCompare('<?php echo $product_id; ?>');"><?php echo $button_compare; ?></a>--></div>
</div>
<?php } ?>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T15:25:05.840

管理员 -> 系统 -> 设置 -> '编辑' -> 选项 -> 第一个选项：

> **每页默认项目（目录）：** 确定每页显示多少目录项目（产品、类别等）

:)

# linux - 如何删除 netcat 地址？

> ID：14489103
> 
> 赞同：0
> 
> 时间：2013-01-23T20:49:14.343
> 
> 标签：linux, networking

当我在服务器端（或客户端）使用此命令时： $nc -l 2380

我不再使用这个地址：

```
$
$
$nc -l 2380 
nc: Address already in use
$
$ 
```

我如何删除地址？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:25:43.953

您是否尝试过停止侦听该端口的其他 netcat 进程？

# asp.net-mvc-4 - 模板编辑器

> ID：14489104
> 
> 赞同：0
> 
> 时间：2013-01-23T20:49:16.267
> 
> 标签：asp.net-mvc-4, mvc-editor-templates, editorfor

对于设计问题，我需要将大量输入文本包装在特定模板中。我希望使用 editorfor 模板，我写道：

**看法**

```
@Html.EditorFor(model => model.UserName, "bootstrap_FormInputControls")
@Html.EditorFor(model => model.Email, "bootstrap_FormInputControls") 
```

**编辑器模板**

```
@model MyModel
<div class="controls">
  @Html.TextBoxFor(m => m.Tag, new { placeholder = "Email" })
</div> 
```

这当然不是一般的......我希望使用 EditorFor 中指定的值（电子邮件，用户名，......）。可能吗？提前致谢

# postgresql - PostgreSQL - 关系 [表] 不存在

> ID：14489105
> 
> 赞同：13
> 
> 时间：2013-01-23T20:49:41.073
> 
> 标签：postgresql

我刚刚创建了一个新用户，我希望它可以访问我们有限数量的公共表。用户已创建，我现在将 privs 授予一个公共表。然后，我以该用户身份登录数据库，并尝试在用户应该能够访问的表上运行 SELECT，但我必须错过一个步骤或做错了什么，因为当我运行查询时，我得到：

**关系 [表] 不存在**

以下是我按顺序执行的步骤。

```
CREATE USER pqb2b WITH PASSWORD 'foo'

 select * from pg_user;
 usename  | usesysid | usecreatedb | usesuper | usecatupd |  passwd   | valuntil | useconfig
 ----------+----------+-------------+----------+-----------+----------+----         |
postgres |       10 | t           | t        | t         | ******** |          | 
 pgb2b   | 17267767 | t           | f        | f         | ******** | infinity | 
```

(1 行)

```
GRANT ALL on b_users to pgb2b;

SELECT
schemaname||'.'||tablename
FROM
pg_tables
WHERE
has_table_privilege (
    'pgb2b',
    schemaname||'.'||tablename,
    'select'
 )
AND
schemaname NOT IN (
    'pg_catalog',
    'information_schema'
 ); 
```

* * *

```
public.b_users
(1 row)

~ postgres$ psql -U pgb2b  mydb
psql (9.0.3)
Type "help" for help.

mydb=> select * from b_users;
ERROR:  relation "b_users" does not exist
LINE 1: select * from b_users;

 mydb=> \d+ b_users
 Did not find any relation named "b_users". 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-24T14:27:15.217

即使我向我的 pgb2b 用户授予权限，我也忘记指定该用户的用法：

```
GRANT usage on schema public to pgb2b; 
```

这解决了这个问题。我发现这篇关于设置 PostgreSQL 用户权限[的帖子非常有帮助。](http://forums.devshed.com/postgresql-help-21/permission-denied-for-schema-error-337648.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-24T21:10:50.333

请注意可能会看到此内容的其他人，尽管它可能不适用于此特定问题-

如果您**不使用公共架构**，则需要更新 search_path

```
SET search_path TO my_schema, public; 
```

信用：[为什么 PostgreSQL 的 \dt 只显示公共模式表？](https://stackoverflow.com/questions/6931883/why-does-postgresqls-dt-show-only-public-schema-tables)

# xslt - 对 xslt 1.0 中节点集的元素求和

> ID：14489106
> 
> 赞同：0
> 
> 时间：2013-01-23T20:49:40.787
> 
> 标签：xslt

我有以下 xml，其结构相同，但节点和值可能不同：

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="test.xsl"?>
<main>
    <_All>
        <_001372>
            <_2012-Oct-10>
                <Employee_Amount>1.0</Employee_Amount>
                <Combo_Savings_Amount>2.0</Combo_Savings_Amount>
                <Total_Sales>3.0</Total_Sales>
                <Dine_in_Amount>4.0</Dine_in_Amount>
                <Promos_Actual>5.0</Promos_Actual>
                <Cash_Count>6.0</Cash_Count>
                </_2012-Oct-10>
            <_2012-Oct-11>
                <Employee_Amount>7.0</Employee_Amount>
                <Combo_Savings_Amount>0.0</Combo_Savings_Amount>
                <Total_Sales>0.0</Total_Sales>
                <Dine_in_Amount>0.0</Dine_in_Amount>
                <Promos_Actual>0.0</Promos_Actual>
                <Cash_Count>0.0</Cash_Count>
                </_2012-Oct-11>
            </_001372>
        <_024139>
            <_2012-Oct-10>
                <Employee_Amount>0.0</Employee_Amount>
                <Combo_Savings_Amount>313.148999999997</Combo_Savings_Amount>
                <Total_Sales>3515.5</Total_Sales>
                <Dine_in_Amount>543.86</Dine_in_Amount>
                <Promos_Actual>0.0</Promos_Actual>
                <Cash_Count>330.0</Cash_Count>
                </_2012-Oct-10>
            <_2012-Oct-11>
                <Employee_Amount>10.0</Employee_Amount>
                <Combo_Savings_Amount>17.0</Combo_Savings_Amount>
                <Total_Sales>5.0</Total_Sales>
                <Dine_in_Amount>7.0</Dine_in_Amount>
                <Promos_Actual>0.0</Promos_Actual>
                <Cash_Count>20.0</Cash_Count>
                </_2012-Oct-11>
            </_024139>
        <_101010>
            <_2012-Oct-10>
                <Employee_Amount>5.0</Employee_Amount>
                <Combo_Savings_Amount>0.0</Combo_Savings_Amount>
                <Total_Sales>0.0</Total_Sales>
                <Dine_in_Amount>0.0</Dine_in_Amount>
                <Promos_Actual>0.0</Promos_Actual>
                <Cash_Count>0.0</Cash_Count>
                </_2012-Oct-10>
            <_2012-Oct-11>
                <Employee_Amount>0.0</Employee_Amount>
                <Combo_Savings_Amount>0.0</Combo_Savings_Amount>
                <Total_Sales>0.0</Total_Sales>
                <Dine_in_Amount>0.0</Dine_in_Amount>
                <Promos_Actual>0.0</Promos_Actual>
                <Cash_Count>0.0</Cash_Count>
                </_2012-Oct-11>
            </_101010>
    </_All>
</main> 
```

我需要总结一家商店的所有元素。例如，我需要将日期 date01 和 date02 的 Employee_Amount 相加。与所有节点相同。我尝试如下：

```
<?xml version="1.0" encoding="US-ASCII"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
    <xsl:output method="html" indent="yes" />
    <xsl:template match="/*">
        <table border="1" cellspacing="1" cellpadding="1"
            align="center">
            <tr bgcolor="#8181F7">
                <xsl:apply-templates select="/*/*/*/*" mode="ColHeader" />
            </tr>
            <tr bgcolor="#00FFFF">
                <td>
                    <xsl:value-of
                        select="translate(name(child::*),'_',' ')" />
                </td>
                <td>&#160;</td>
                <xsl:for-each select="/*[1]/*[1]/*[1]/*[1]/*">
                    <xsl:variable name="pos" select="position()" />
                    <td>
                        <xsl:value-of
                            select='format-number(sum(/*/*/*/*/*[$pos]),"#.##")' />
                    </td>
                </xsl:for-each>
            </tr>
            <xsl:apply-templates select="/*/*/*" mode="values" />
        </table>
    </xsl:template>

    <xsl:template match="/*/*/*/*" mode="ColHeader">
        <xsl:if test="position() = 1">
            <th>Region</th>
            <th>Store</th>
            <xsl:for-each select="./*">
                <th>
                    <xsl:value-of select="translate(name(),'_',' ')" />
                </th>
            </xsl:for-each>
        </xsl:if>
    </xsl:template>
    <xsl:template match="/*/*/*" mode="values">
        <xsl:for-each select=".">
            <tr>
                <td>&#160;</td>
                <td>
                    <xsl:value-of select="translate(name(),'_',' ')" />
                </td>
                <xsl:apply-templates select="./*/*" mode="rollupVal"/>
            </tr>
        </xsl:for-each>
    </xsl:template>
    <xsl:template match="/*/*/*/*/*" mode="rollupVal">
        <xsl:variable name="pos1" select="current()"/>
                    <td>
                        <xsl:value-of select='format-number(sum(./node()[$pos1]), "#.##")'/>
                    </td>
    </xsl:template>
</xsl:stylesheet> 
```

但我无法总结这些行。请帮我。谢谢

编辑：输出HTML是：

```
<table align="center" cellpadding="1" cellspacing="1" border="1">
    <tr bgcolor="#8181F7">
    <th>Region</th><th>Store</th><th>Employee Amount</th><th>Combo Savings Amount</th><th>Total Sales</th><th>Dine in Amount</th><th>Promos Actual</th><th>Cash Count</th>
    </tr>
    <tr bgcolor="#00FFFF">
        <td> All</td>
        <td>&nbsp;</td>
        <td>18</td>
        <td>332.15</td>
        <td>3523.5</td>
        <td>554.86</td>
        <td>5</td>
        <td>356</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td> 001372 44CLOSED</td>
        <td>8</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td> 024139</td>
        <td>10</td>
        <td>330.15</td>
        <td>3520.5</td>
        <td>550.86</td>
        <td>0</td>
        <td>350</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:43:22.807

这个 XSL 仍然有点乱，但它似乎产生了预期的输出：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
  <xsl:output method="html" indent="yes" />
  <xsl:key name="field" match="/*/*/*/*/*" use="local-name()" />
  <xsl:variable name="fieldGroups" select="/*/*/*/*/*[generate-id() = generate-id(key('field', local-name())[1])]" />

  <xsl:template match="/*">
    <table border="1" cellspacing="1" cellpadding="1"
        align="center">
      <tr bgcolor="#8181F7">
        <!-- First date node -->
        <xsl:call-template name="ColHeaders" />
      </tr>
      <!-- All node -->
      <xsl:apply-templates select="*" mode="GrandTotal" />
      <!-- Each store -->
      <xsl:apply-templates select="*/*" mode="values" />
    </table>
  </xsl:template>

  <xsl:template name="EmptyCell">
    <td>&#160;</td>
  </xsl:template>

  <xsl:template match="/*/*" mode="GrandTotal">
    <tr bgcolor="#00FFFF">
      <td>
        <xsl:value-of select="translate(name(.),'_',' ')" />
      </td>
      <xsl:call-template name="EmptyCell" />
      <!-- Each field of first date -->
      <xsl:apply-templates select="$fieldGroups" mode="FieldTotal" />
    </tr>
  </xsl:template>

  <xsl:template match='/*/*/*/*/*' mode='FieldTotal'>
    <xsl:variable name="pos" select="position()" />
    <td>
      <xsl:value-of select='format-number(sum(key("field", local-name())),"0.##")' />
    </td>
  </xsl:template>

  <xsl:template name="ColHeaders">
    <th>Region</th>
    <th>Store</th>
    <xsl:apply-templates select="$fieldGroups" mode="ColHeader" />
  </xsl:template>

  <xsl:template match="*" mode="ColHeader">
    <th>
      <xsl:value-of select="translate(name(),'_',' ')" />
    </th>
  </xsl:template>

  <!-- Matches stores -->
  <xsl:template match="/*/*/*" mode="values">
    <tr>
      <xsl:call-template name="EmptyCell" />
      <td>
        <!-- Store code -->
        <xsl:value-of select="translate(name(),'_',' ')" />
      </td>
      <!-- All fields in first date -->
      <xsl:apply-templates select="*[1]/*" mode="rollupVal"/>
    </tr>
  </xsl:template>

  <xsl:template match="/*/*/*/*/*" mode="rollupVal">
    <xsl:variable name="pos1" select="position()"/>
    <td>
      <xsl:value-of select='format-number(sum(../../*/*[$pos1]), "0.##")'/>
    </td>
  </xsl:template>
</xsl:stylesheet> 
```

输出：

```
<table border="1" cellspacing="1" cellpadding="1" align="center">
  <tr bgcolor="#8181F7">
    <th>Region</th>
    <th>Store</th>
    <th>Employee Amount</th>
    <th>Combo Savings Amount</th>
    <th>Total Sales</th>
    <th>Dine in Amount</th>
    <th>Promos Actual</th>
    <th>Cash Count</th>
  </tr>
  <tr bgcolor="#00FFFF">
    <td> All</td>
    <td> </td>
    <td>18</td>
    <td>332.14</td>
    <td>3523.5</td>
    <td>554.86</td>
    <td>5</td>
    <td>356</td>
  </tr>
  <tr>
    <td> </td>
    <td> store01</td>
    <td>8</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
    <td>5</td>
    <td>6</td>
  </tr>
  <tr>
    <td> </td>
    <td> store02</td>
    <td>10</td>
    <td>330.14</td>
    <td>3520.5</td>
    <td>550.86</td>
    <td>0</td>
    <td>350</td>
  </tr>
</table> 
```

# php - 需要一些 GROUP_CONCAT MySQL 更好的理解请

> ID：14489107
> 
> 赞同：1
> 
> 时间：2013-01-23T20:49:42.130
> 
> 标签：php, mysql, group-concat

我遇到的问题是 list_items.item_id 不止一个（其中有两个）。看来 concat 组只是将所有信息集中在一起，而不是将它们集中在父表的每一行中。这是我与 GROUP_CONCAT 的第一次牛仔竞技表演。我希望实现的是每个父项都连接了连接信息。任何帮助表示赞赏。

```
SELECT list_items.item_id, sub_cats.cat_name as subcatname, 
main_cats.cat_name maincatname, main_title,fabric,other,care,item_main_cat,item_sub_cat,
GROUP_CONCAT(sub_id) as subidgrp,
GROUP_CONCAT(price) as pricegrp,
GROUP_CONCAT(item_size) as itemszgrp,
GROUP_CONCAT(item_color) as itmcolorgrp,
GROUP_CONCAT(img_name) as imgnmgrp,
GROUP_CONCAT(item_quantity) as itmqntygrp
from list_items LEFT JOIN item_size_etc ON      
list_items.item_id = item_size_etc.parent_id LEFT JOIN main_cats on     
list_items.item_main_cat=main_cats.cat_id LEFT JOIN sub_cats on 
list_items.item_sub_cat=sub_cats.cat_id where list_items.active='Y' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:53:10.950

任何聚合函数（COUNT、SUM、MAX 等）的默认行为是将整个表视为一个“组”。

要使每个组对应于给定列的不同值，换句话说，要获取每个项目的小计，您需要添加一个 GROUP BY 子句。

例如，将此添加到查询的末尾：

```
...
GROUP BY list_items.item_id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T20:53:16.877

[`GROUP_CONCAT()`是一个聚合函数](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)，这意味着它期望子句的存在`GROUP BY`能够正确运行。因为 MySQL（与其他 RDBMS 不同）对`GROUP BY`内容很宽容，所以您的查询在语法上是有效的，但不会产生正确的结果。

如果您仅添加，您*可能会*获得所需的结果`GROUP BY list_items.item_id`，但更好的是列出 中列表`SELECT`中的所有列`GROUP BY`。

```
SELECT
  list_items.item_id, 
  sub_cats.cat_name as subcatname, 
  main_cats.cat_name maincatname,
  main_title,
  fabric,
  other, 
  care,
  item_main_cat,
  item_sub_cat,
  GROUP_CONCAT(sub_id) as subidgrp,
  GROUP_CONCAT(price) as pricegrp,
  GROUP_CONCAT(item_size) as itemszgrp,
  GROUP_CONCAT(item_color) as itmcolorgrp,
  GROUP_CONCAT(img_name) as imgnmgrp,
  GROUP_CONCAT(item_quantity) as itmqntygrp
FROM 
  list_items
  LEFT JOIN item_size_etc ON  list_items.item_id = item_size_etc.parent_id
  LEFT JOIN main_cats on  list_items.item_main_cat=main_cats.cat_id
  LEFT JOIN sub_cats on list_items.item_sub_cat=sub_cats.cat_id 
WHERE list_items.active='Y'  
GROUP BY
list_items.item_id, 
  sub_cats.cat_name as subcatname, 
  main_cats.cat_name maincatname,
  main_title,
  fabric,
  other, 
  care,
  item_main_cat,
  item_sub_cat 
```

# git - 如何将“git checkout”别名为“git co”

> ID：14489109
> 
> 赞同：162
> 
> 时间：2013-01-23T20:49:50.530
> 
> 标签：git, alias, git-alias

我希望命令`git co`与输入相同`git checkout`。

普通的 Bash 别名 ( `alias co='checkout'`) 不起作用。

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2013-01-23T20:49:50.530

命令：

`git config --global alias.co checkout`

将创建一个 git 别名来执行此操作。它会将以下条目添加到您的全局`~/.gitconfig`文件中：

```
[alias]
    co = checkout 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-23T21:17:55.237

此外，可以将其编辑到您的 git 配置中：

```
[alias]
   co = checkout 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-12T21:34:00.043

简单地添加一些注释，bash alias 用于为命令设置别名，而 co 或 checkout 是命令 git 的参数或标志，因此它不起作用。

# wpf - 如何动态绑定和静态添加 MenuItem？

> ID：14489112
> 
> 赞同：25
> 
> 时间：2013-01-23T20:49:59.693
> 
> 标签：wpf, xaml, styles, datatemplate, menuitem

我将 MenuItem 的 ItemsSource 绑定到 ViewModel 中的 ObservableCollection。这是我的xml：

```
<MenuItem Header="_View"
          ItemsSource="{Binding Windows}">
  <MenuItem.ItemContainerStyle>
    <Style>
      <Setter Property="MenuItem.Header"
              Value="{Binding Title}" />
    </Style>
  </MenuItem.ItemContainerStyle>
</MenuItem> 
```

这部分效果很好，但现在我还想将一些静态菜单项添加到同一个视图菜单项中，并用分隔符分隔。像这样的东西，即使我知道这行不通，因为我不能两次设置项目。

```
<MenuItem Header="_View"
          ItemsSource="{Binding Windows}">
  <MenuItem.ItemContainerStyle>
    <Style>
      <Setter Property="MenuItem.Header"
              Value="{Binding Title}" />
    </Style>
  </MenuItem.ItemContainerStyle>
  <Separator />
  <MenuItem Header="item 1" />
  <MenuItem Header="item 2" />
</MenuItem> 
```

现在我已经通过向 MenuItem 添加另一个级别来创建一个解决方法，如下所示：

```
<MenuItem Header="_View">
  <MenuItem Header="Windows"
            ItemsSource="{Binding Windows}">
    <MenuItem.ItemContainerStyle>
      <Style>
        <Setter Property="MenuItem.Header"
                Value="{Binding Title}" />
      </Style>
    </MenuItem.ItemContainerStyle>
  </MenuItem>
  <MenuItem Header="Load Layout" />
  <MenuItem Header="Save Layout" />
</MenuItem> 
```

这很好用，但如果可能的话，我宁愿没有子菜单。哦，我也更喜欢在 xaml 中而不是在后面的代码中执行此操作。有任何想法吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-23T21:13:10.487

您可以使用 a`CompositeCollection`来执行此操作，您可以组合不同的 Collections 并在 xaml 中添加静态项。

例子：

xml:

```
<Window x:Class="WpfApplication8.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="233" Width="143" Name="UI">
    <Window.Resources>
        <CollectionViewSource Source="{Binding ElementName=UI, Path=Windows}" x:Key="YourMenuItems"/>
     </Window.Resources>

    <Grid DataContext="{Binding ElementName=UI}">
        <Menu Height="24" VerticalAlignment="Top">
        <MenuItem Header="_View" >
                <MenuItem Header="Windows">
                    <MenuItem.ItemsSource>
                        <CompositeCollection>
                            <CollectionContainer Collection="{Binding Source={StaticResource YourMenuItems}}" />
                            <MenuItem Header="Menu Item 1" />
                            <MenuItem Header="Menu Item 2" />
                            <MenuItem Header="Menu Item 3" />
                        </CompositeCollection>
                    </MenuItem.ItemsSource>
                    <MenuItem.ItemContainerStyle>
                        <Style>
                            <Setter Property="MenuItem.Header" Value="{Binding Title}"/>
                        </Style>
                    </MenuItem.ItemContainerStyle>
                </MenuItem>
            </MenuItem>
        </Menu>
    </Grid>
</Window> 
```

代码

```
public partial class MainWindow : Window
{
    private ObservableCollection<MyObject> _windows = new ObservableCollection<MyObject>();

    public MainWindow()
    {
        InitializeComponent();
        Windows.Add(new MyObject { Title = "Collection Item 1" });
        Windows.Add(new MyObject { Title = "Collection Item 2" });
    }

    public ObservableCollection<MyObject> Windows
    {
        get { return _windows; }
        set { _windows = value; }
    }
}

public class MyObject
{
    public string Title { get; set; }
} 
```

结果：

![在此处输入图像描述](../Images/00db65837f709a9a3c2c34fe1fae15ff.png)

# c# - 发送数据后启用 SerialPort DataReceived 事件

> ID：14489116
> 
> 赞同：0
> 
> 时间：2013-01-23T20:50:15.747
> 
> 标签：c#, events, serial-port

所以我正在与设备交谈，TX 和 RX 引脚实际上在内部连接在一起。当我向设备发送数据时，我看到我的`SerialPort.DataReceived`事件正在接收相同的数据。

我只想在发送数据后触发此事件。
我尝试在发送数据之前简单地取消订阅，然后`SerialPort.Write`调用一次订阅，但是写入函数看起来是在一个单独的线程中处理的，所以我仍然会收到数据，因为订阅会立即发生。

看起来没有我可以用来订阅的“DataSendComplete”类型的事件。有任何想法吗？

编辑：我尝试添加

```
if (serialPort.BytesToWrite != 0)
            return; 
```

但是我猜在事件触发时所有的数据都已经发送了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:07:12.033

没有办法可靠地做到这一点，你不可能得到正确的时机。驱动程序将数据从传输缓冲区物理传输到 UART 的确切时间以及 UART 传输 FIFO 中字节的确切时间无法在用户模式程序中确定。只有司机可以试一试，它没有这个选项。

您需要寻找一个选项来关闭设备中的回声，如果该设备使用 Hayes 命令集，则需要使用 ATE0 命令。或者只是丢弃您在 DataReceived 事件处理程序中发送的字节数。

# java - Webservice - 加载属性文件

> ID：14489117
> 
> 赞同：0
> 
> 时间：2013-01-23T20:50:19.383
> 
> 标签：java, web-services, properties, loading

我正在创建一个连接到服务器 A、发送消息 M 并返回响应消息 R 的 Web 服务。连接到服务器 A 的值位于我需要在 web 服务中加载的属性文件中。由于我每次都连接到同一台服务器，（我只是发送差异消息并获得适当的响应）我只想加载一次属性文件。我不想每次调用 web 服务时都加载属性文件，以便提高性能。您能告诉我如何实现这一目标吗？我打算将此网络服务部署到 tomcat 服务器上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:51:58.060

使用[属性](http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html)加载您的属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:54:25.773

标准的java属性文件应该做的很好，创建

```
 static public Properties prop; 
```

初始化它并在整个应用程序中使用它

# java - 在 Swing 面板上排列 Swing 组件

> ID：14489121
> 
> 赞同：3
> 
> 时间：2013-01-23T20:50:43.160
> 
> 标签：java, swing, user-interface, border, layout-manager

我是 Swing 的新手，但有点努力实现我想要做的事情。我想构建一个如下所示的屏幕：

![在此处输入图像描述](../Images/2bf9dee788de6a8c3479ba78cad73307.png)

我不确定哪种布局最适合这种屏幕。我尝试使用 BorderLayout 但它永远不会正确。我得到了右下角的按钮，但中间的组件被证明是相当具有挑战性的。我知道如何将组件添加到面板上，但我正在努力的领域是如何对齐它们。有时，如果我在带有 BORDERLAYOUT 的面板上添加一个文本字段，它会占用我不想要的整个面板的全部空间。

我设法使用 AbsoluteLayout 让它几乎可以工作，但我怀疑如果我希望屏幕流畅，这不是最好的选择。

```
setBounds(100, 100, 775, 599);
getContentPane().setLayout(new BorderLayout());
contentPanel.setBackground(SystemColor.control);
contentPanel.setForeground(Color.RED);
contentPanel.setBorder(new EtchedBorder(EtchedBorder.LOWERED, null, null));
getContentPane().add(contentPanel, BorderLayout.CENTER);
contentPanel.setLayout(new BorderLayout(0, 0));
{
    JPanel topHeadersPanel = new JPanel();
    contentPanel.add(topHeadersPanel, BorderLayout.NORTH);
    topHeadersPanel.setLayout(new BorderLayout(0, 0));
    {
        JLabel lblSetSourceRecord = new JLabel("Source customer record:");
        lblSetSourceRecord.setFont(new Font("Tahoma", Font.BOLD, 12));
        topHeadersPanel.add(lblSetSourceRecord, BorderLayout.WEST);
    }
    {
        JLabel lblSetDestinationRecord = new JLabel("Destination customer record:");
        lblSetDestinationRecord.setFont(new Font("Tahoma", Font.BOLD, 12));
        topHeadersPanel.add(lblSetDestinationRecord, BorderLayout.EAST);
    }

    {
        JLabel lblSetDestinationRecord = new JLabel("Source customer:");
        lblSetDestinationRecord.setFont(new Font("Tahoma", Font.BOLD, 12));
        topHeadersPanel.add(lblSetDestinationRecord, BorderLayout.SOUTH);
    }
}
{
    JPanel buttonPane = new JPanel();
    buttonPane.setBorder(new EtchedBorder(EtchedBorder.LOWERED, null, null));
    buttonPane.setLayout(new FlowLayout(FlowLayout.CENTER));
    getContentPane().add(buttonPane, BorderLayout.SOUTH);
    {
        JPanel panel = new JPanel();
        buttonPane.add(panel);
    }
    {
        JButton okButton = new JButton("OK");
        okButton.setActionCommand("OK");
        buttonPane.add(okButton);
        getRootPane().setDefaultButton(okButton);
    }
    {
        JButton cancelButton = new JButton("Cancel");
        cancelButton.setActionCommand("Cancel");
        buttonPane.add(cancelButton);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:54:31.980

`GridLayout`尝试使用 1 行和 2 列在 a 中制作上部，将其添加`BorderLayout`为 CENTER 并将按钮添加为`BorderLayout.BOTTOM`. 在上部，使用两个面板，一个用于左侧，一个用于右侧。

这里有一些代码来展示这一点（我不能真正复制/粘贴你的例子）：

```
public class MW extends JFrame {

    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                createAndShowUI();
            }
        });
    }

    private static void createAndShowUI() {
        MW x = new MW();

        JPanel mainPanel = new JPanel();
        mainPanel.setLayout(new GridLayout(1, 2));

        JPanel leftPanel = new JPanel();
        JLabel srcLabel = new JLabel("Source record:");
        leftPanel.add(srcLabel);
        JPanel rightPanel = new JPanel();
        JLabel dstLabel = new JLabel("Destination record:");
        rightPanel.add(dstLabel);

        mainPanel.add(leftPanel);
        mainPanel.add(rightPanel);

        JPanel buttonPanel = new JPanel();
        buttonPanel.setLayout(new FlowLayout(FlowLayout.CENTER));
        JButton okButton = new JButton("OK");
        buttonPanel.add(okButton);
        JButton cancelButton = new JButton("Cancel");
        buttonPanel.add(cancelButton);

        x.setSize(400, 400);
        x.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        x.add(mainPanel, BorderLayout.CENTER);
        x.add(buttonPanel, BorderLayout.PAGE_END);
        x.setLocationRelativeTo(null);
        x.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T20:58:48.140

看看这张图片，我在其中装箱了可以执行此操作的嵌套组件

![在此处输入图像描述](../Images/a5e813d24181ffbfabab19809621a35c.png)

在顶层，垂直框中的两个棕色部分。

然后上面的一个有一个网格或一个以蓝色显示的水平框。

然后它们中的每一个都有一个淡黄色的盒子布局，在它们之间有适当的间距。

接下来是容器并在每个容器中使用适当的布局，最终组件进入容器。

有一些工具可以使这更容易。我很久以前使用过 NetBeans 编辑器。然后我在 Eclipse 的 IBM WSAD/RAD 版本中使用了编辑器。现在，如果我需要做这样的布局，我会在 MyEclipse 中使用 Matisse 编辑器。

**编辑**

刚刚注意到@DaDaDom 在外面建议了一些类似的东西，棕色水平。他喜欢这样的边框布局，上面的框在 CENTER，按钮框在 SOUTH。那会很好用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-03-18T02:00:01.407

我还将使用组布局，因为这将帮助您对齐标签和文本框。

# java - JSONObject 抛出异常

> ID：14489126
> 
> 赞同：2
> 
> 时间：2013-01-23T20:51:01.467
> 
> 标签：java, android

我有这部分代码（请注意，它`responseBody`确实来自网络服务器）。

```
public JSONObject getObj(){
    String responseBody = '[{"zip":"56601","city":"Bemidji","state":"MN","county":"Beltrami","dist":"0.14802"},{"zip":"56619","city":"Bemidji","state":"MN","county":"Beltrami","dist":"3.98172"}]';

    JSONObject response = null;

    try{
        response = new JSONObject(responseBody);
    }catch(JSONException ex){
        Logger.getLogger(Http.class.getName()).log(Level.SEVERE, null, ex);
    }
    return response;
} 
```

我不明白为什么 JSONObject 会抛出异常。是什么让它这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:01:32.143

这是一个带有 JSONObject 的 JSONArray，而不是 JSONObject。

看到这个链接： [http ://www.w3schools.com/json/json_syntax.asp](http://www.w3schools.com/json/json_syntax.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:00:20.980

这应该有效：

```
public static JSONArray getObj(){
    String responseBody = "[{\"zip\":\"56601\",\"city\":\"Bemidji\",\"state\":\"MN\",\"county\":\"Beltrami\",\"dist\":\"0.14802\"},{\"zip\":\"56619\",\"city\":\"Bemidji\",\"state\":\"MN\",\"county\":\"Beltrami\",\"dist\":\"3.98172\"}]";

    JSONArray response = null;

    try{
        return new JSONArray(responseBody);
    }catch(JSONException ex){
        ex.printStackTrace();
    }
    return response;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:09:56.813

你得到一个例外，因为你试图创建一个`JSONObject`- 它包含在 {} 中 - 从`JSONArray`包含在 [] 中的东西中创建一个 - 。如果您查看您的响应主体，您会看到它包含在方括号 [] 中，并且是一个 JSONArray。

要取出单个对象，您需要 (1) 创建一个 JSONArray；(2) 为您想要的值创建一个单独的 JSONObject；(3) 返回那个对象。例如，要返回 responseBody 中的第一个值：

```
try{
JSONArray responseArray = new JSONArray(responseBody);
return responseArray.getJSONObject(0);
} catch (JSONException e) {
    Log.e("JSON", e.toString());
} 
```

要从上述示例中返回的特定 JSONObject 中获取信息，例如邮政编码，您可以使用：

```
JSONObject a = getObj(); 
String zip = a.getString("zip"); 
```

遍历数组同样简单。因为 JSONObjects 是通过它们的索引号从 JSONArray 中提取出来的，所以只需使用 a`for loop`将每个对象拉出来。然后，您可以根据需要处理内部字符串。

# backbone.js - 骨干样板代码和使用 grunt bbb 构建

> ID：14489128
> 
> 赞同：0
> 
> 时间：2013-01-23T20:51:28.207
> 
> 标签：backbone.js, gruntjs, backbone-boilerplate

我一直在关注[Addy Osmani 关于使用 grunt 和 bbb 插件](http://addyosmani.github.com/backbone-fundamentals/#backbone-boilerplate-and-grunt-bbb)构建一个小型主干网应用程序的指南。但是，我仍然对一些事情感到困惑。例如，运行“bbb init”后，我的页面将无法加载。我在 css 和 require.js 文件上都遇到了参考错误。

我在 LAMP 环境中构建（OSX 上的 MAMP）。我知道 grunt-bbb 可以在 Node.js 上工作，但它必须这样做吗？Backbone 毕竟是一个客户端 mvc 框架，所以我相信它应该可以工作。当我运行“bbb server”来启动开发服务器时，一切似乎都很好。但我将无法部署到节点服务器。我必须在 Apache 上托管我的应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:30:58.393

您是否在子文件夹中运行您的应用程序？（例如`localhost/my/app`：）还是到根？

Backbone-Boilerplate 默认将该`app.root`值设置为`/`。如果您在子文件夹中运行，则需要在此处更新值：[https ://github.com/tbranyen/backbone-boilerplate/blob/master/app/app.js#L14](https://github.com/tbranyen/backbone-boilerplate/blob/master/app/app.js#L14)

同时更新文件路径`index.html`（[第 13](https://github.com/tbranyen/backbone-boilerplate/blob/master/index.html#L13)行和[第 33 行](https://github.com/tbranyen/backbone-boilerplate/blob/master/index.html#L33)）

如果您不使用`pushState`，则可以将值设置为空字符串。否则，添加根文件夹。

# html - html/css 服务器状态检查器？

> ID：14489129
> 
> 赞同：-5
> 
> 时间：2013-01-23T20:51:32.653
> 
> 标签：html, css

这个想法是，我希望能够用 html 或 css 编写它，以每 10 分钟 ping 一次地址或 IP，以检查它是否会反弹信号，如果是，那么我网站上的状态会显示其“在线” ，或者如果它没有收到信号，那么它会将我网页上的文字更改为“离线”。我不知道如何使它与多台服务器可互换，到目前为止，我只找到了一种使用 cron 作业的方法，但我正在运行 Windows 7，不知道如何在模拟器中编写脚本成立。此外，我对 html 和 css 还很陌生，或者我可能已经知道如何做到这一点：/

非常感谢任何帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:57:02.143

你可以在外部服务器上写一个文件吗？

如果是这样，请在此处添加一个小样式表，以更改以下 HTML：

```
<span class="online">Online</span>
<span class="offline">Offline</span> 
```

从此CSS（在您的服务器上）：

```
.online { display: none; }
.offline { display: inline; } 
```

对此：

```
.online { display: inline; }
.offline { display: none; } 
```

确保链接它们，以便外部服务器的样式表在 HTML 标头中*最后列出。*

* * *

但是，这种纯 CSS 方法**不能**每十分钟重复一次——为此，您需要 JavaScript。

向外部服务器发出[JSON-P](http://api.jquery.com/jQuery.getJSON/)请求，将 HTML 中的文本默认设置为“离线”，如果 JSON-P 请求成功，则将其更改为“在线”。（JSON-P 永远不会返回错误。）但是，这也要求您在该外部服务器上有一个自己制作的页面来返回 JSON，即使它是空的。

如果您无权写入外部服务器，那么您可能无能为力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:54:52.960

为此，您需要在页面中添加一些 JavaScript。

您可以执行 AJAX 请求来确定页面是否在线 - 如果成功加载页面，AJAX 请求将返回 200 状态代码。如果该页面与您的测试页面位于不同的域中，则您需要启用跨域请求 (CORS) 或 JSONP 响应，或者在您的服务器上使用代理页面。

当然，如果它失败了，这并不意味着该网站处于离线状态 - 您的连接可能已断开（例如）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:06:50.567

好吧，您需要一个服务器基础脚本 [PHP/ASP] 和带有 AJAX 的 JavaScript 在客户端。

您可以使用 JavaScript jQuery 库 (http://jquery.com/) 一个强大的库，可以让您节省时间。

Html 会是这样的：

```
<div class='serverstatus'></div> 
```

对于 php，您必须制作一个小脚本，例如

```
$host = 'Your IP'; 
$port = your.port; 
//here you define the Server Info [IP/PORT]
$timeout = 1;
//You open a connection to that ip on that port and check if responding or not
$handler = fsockopen($host,$port,$errcd,$errstr,$timeout);
if($handler){   
   echo "1";
} else {
   echo "0"; 
} 
fclose($handler); 
```

这是现在用于 JavaScript 的 PHP 文件：

阿贾克斯会

```
 setTimeout(function() {$.ajax({
            url:'phpfile.php',
            type: 'GET',
            success: function(data){
                if (data == "1") {
                    $(".serverstatus").html("Online");
                }
                else if (data == "0") {
                    $(".serverstatus").html("Offline");
                }
                else {
                    $(".serverstatus").html("Undefined");
                }

            }
        });},600000); 
```

需要 jQuery 库。

据您所知，CSS 称为 Cascading Styled Sheet，它仅用于设计目的。使用 CSS，您无法编写脚本，除了样式化您的页面外，您什么也做不了。HTML 用于创建 HTML 内容，同样它不用于那种东西

为此，您需要学习 PHP 或 ASP 用于外部 Source 之间的“连接部分”，以及用于实时更新的 javascript。

# c# - ASP.NET 有条件地显示 Div

> ID：14489130
> 
> 赞同：5
> 
> 时间：2013-01-23T20:51:33.503
> 
> 标签：c#, asp.net, webforms

我用谷歌搜索了这个并没有找到我需要的东西。我发现的所有现有解决方案都将“可见性”设置为 false。这似乎对我不起作用，因为我的应用程序呈现 PDF，它只是“隐藏”了 DIV 并在它的位置留下了一个很大的空白。

相反，我不想渲染 HTML。例如，在 PHP 中，这可以像这样简单地完成：

```
<?php if ($showDiv == true) { ?>
<div>Lorem ipsum dolor sit amet</div>
<?php } ?> 
```

在 ASP.NET MVC 中，我可以简单地传递一个 ViewBag 变量并做同样的事情。

ASP.NET (C#) 中的解决方案是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-23T20:57:53.787

```
<% if ( showDiv ) { %>
<div></div>
<% } %> 
```

其中 showDiv 将是您后面代码中的受保护属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-23T20:53:51.677

在.aspx 文件中

```
<div runat="server" id="hideableDiv">Lorem ipsum dolor sit amet</div> 
```

在后面的代码中

```
...
hideableDiv.Visible = false;
... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-23T20:58:25.057

使用`<asp:panel>`呈现为 HTML 的控件`<div>`。然后，您可以切换可见性。如果`visible`设置为 false，asp.net 将不会呈现任何内容。

```
 <asp:Panel id="MyPanel" runat="server">
    ...
    </asp:Panel>

   MyPanel.Visible = false; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-23T21:01:03.473

标记

```
<div runat="server" id="myPdfDiv">Lorem ipsum dolor sit amet</div> 
```

代码隐藏

```
myPdfDiv.Visible = false;
myPdfDiv.InnerHTML = ""; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-23T21:02:31.863

是的，您可以将 div 放在 ASP PlaceHolder 控件中：

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.placeholder(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.placeholder(v=vs.71).aspx)

```
<asp:PlaceHolder id="PlaceHolder1" runat="server">
<div></div>
</asp:PlaceHolder> 
```

然后在代码隐藏中，您可以像这样设置它：

```
PlaceHolder1.Visible = true; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-23T21:24:10.453

另一个不会产生任何 HTML 的解决方案：

**HTML**：

```
<asp:Literal ID ="litDiv" runat="server">       
</asp:Literal> 
```

**代码背后：**

```
bool showDiv = true;
if (showDiv)
    this.litDiv.Text = "<div>Lorem ipsum dolor sit amet</div>"; 
```

# mysql - MySQL 用户表字符密码

> ID：14489137
> 
> 赞同：0
> 
> 时间：2013-01-23T20:52:06.723
> 
> 标签：mysql, string, char

有人可以对 MySQL表的`Password: Char(41)`列有所了解吗？`Users`如何转换字符串以在该列中工作？

我看到的密码看起来与文本等价物完全不同：`*2DA8242XXXXXXXXX`代表一个 8 个字符的密码，例如`abcdefgh`.

简单地说，**为什么**要使用 Char 类型以及**如何**使用它，因为我搜索过的所有地方充其量都提供了一个模糊的答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:56:21.103

您可以使用 MySQL`PASSWORD()`功能，例如

```
SELECT PASSWORD('mypassword') 
```

（安全提示：那个明文密码会出现在mysql日志中记录的语句中。）

我认为查找存储在 mysql.users 表中的密码值信息的最佳位置是 MySQL 参考手册。

见： [http ://dev.mysql.com/doc/refman/5.5/en/password-hashing.html](http://dev.mysql.com/doc/refman/5.5/en/password-hashing.html)

# php - PHP 显示 While Loop From 函数

> ID：14489141
> 
> 赞同：0
> 
> 时间：2013-01-23T20:52:21.783
> 
> 标签：php, mysql

我有一个关于显示函数内容的问题，这个函数显示了一个while循环。

这是我的模型中的一个函数：

```
function get_results($id)
{
    $stmt = "select * where ... "
    $stmt = $this->BEAR->Database->query($stmt);

    $result = '';

    while($row = mysqli_fetch_array($stmt))
    {
        $result .= '<div>';
        $result .= $row['name'];
        $result .= '</div>';
    }

    $this->BEAR->Template->setData('loop', $result, FALSE);
} 
```

这是我的控制器：

```
 $BEAR->Webprofile->get_results(Template->getData('id')); 
```

这是我的观点：

```
<?php echo $this->getData('loop');?> 
```

这在我的视图中显示循环没有问题。但我希望在我的模型中没有任何 HTMl，是否有这样做（因为这会导致我的模型中出现大量 HTML）。也许我可以在模型中设置数据，然后在我的视图中获取数据。

我尝试在模型函数中单独设置 while 循环，如下所示：

```
 while($row = mysqli_fetch_array($stmt))
    {
       $this->BEAR->Template->setData('name', $row['name']);
       $this->BEAR->Template->setData('name', $row['age']);
    } 
```

然后调用Controller中的函数并调用每个setData，但这仅显示第一个结果而不是完整的while循环内容。

因此，我希望在我的视图中（使用 HTML）显示我的 while 循环的所有内容，但希望我的函数只是获取和设置数据。这可以做到吗？任何想法或指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:11:42.347

你需要对你的 MVC 应用一些纪律。您的模型需要返回原始数据。它应该只返回对象或数据数组。关键是一致性。

您的视图需要包含所有代码以添加您的 html 格式。拥有一个简单地调用您编写的模型函数的视图，该函数会输出一个 div 或有序列表，这会使视图的整个概念变得毫无用处。你的视图应该提供所有的 HTML 代码。

由于您使用的是 PHP，因此您可以轻松地加入和退出 HTML。

从您的模型中的类似内容开始：

```
function get_results($id)
{
    $stmt = "select * where ... "
    $stmt = $this->BEAR->Database->query($stmt);

    $results = array();

    while($row = mysqli_fetch_array($stmt))
    {
        $results[] = $row['name'];       
    }
    return results; 
} 
```

从那里，您应该能够确定您的控制器应该调用此函数，并将 $results 与特定视图文件一起传递到您的视图/模板中以进行渲染。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:13:39.547

```
function get_results($id)
{
    $stmt = "select * where ... "
    $stmt = $this->BEAR->Database->query($stmt);

    $result = '';
    $result = mysqli_fetch_array($stmt);
    return $result;
} 
```

然后在你的控制器中：

```
 $this->BEAR->Template->setData('loop', $model->get_results($id), FALSE); 
```

然后在你的模板中

```
foreach($rows as $row){
     ....do something with each row
} 
```

如何从模型中获取数据然后传递给模板的完整示例

```
class MyController {
    function controller_showResults(){
        $model = new Model();
        $results = $model->get_results($_GET['id']);
        $this->BEAR->Template->setData('loop', $results, FALSE);
    }
} 
```

现在视图假设模板中 setData 的第一个参数是传递给视图的变量，并且该变量是 $results

```
<?php foreach($loop as $l): ?>
    <div><?php echo $l['name'] ?></div>
<?php endforeach; ?> 
```

# java - 如何向站点发送 2GB POST 数据包？

> ID：14489154
> 
> 赞同：1
> 
> 时间：2013-01-23T20:52:51.903
> 
> 标签：java, http, post, packets

基本上，我试图向我的网站发送一个 2GB 的 HTTP POST 数据包来测试它，因为 HTTP GET 不能达到那么高。但是，我对此不是很有经验，需要关于如何实际尝试的建议/解释。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:10:23.823

尝试执行此操作时会出现许多问题。我将尝试简要介绍它们-

1) 服务器设置 - 出于安全原因，许多服务器默认会阻止 2GB POST（具有无限或高的帖子最大值将使 DoS 更容易）。PHP 的默认值为 20M。

1-a) 服务器设置 - 许多服务器也有超时设置，如果请求在一定时间内未完成，它将放弃该请求。2GB 很可能会触发此设置。

2) 浏览器设置 - 我对此并不肯定，但您的浏览器也可能会尝试阻止这种情况。

3) 硬件 - 会有多个硬件瓶颈可能导致问题。物理内存（服务器和客户端）、网络带宽、可用的 HDD 空间（服务器上的写入权限，取决于您对 post 所做的操作）。

4) 3rd Party Host - 如果您的网站由第三方托管，他们可能已经实施了安全措施来阻止这种情况。

这可能不是一个完整的列表 - 但一个 2GB 的 post 文件可能会在传输过程中的许多不同阶段遇到问题。

如果您想要一种发送方式 - 这是一种方式

```
<html>
    <body>
            <form method="post">
                    <input type="hidden"
                    <?php
                            echo " value='";
                            for($i=0;$i<2147483648;$i++)
                                    {
                                            echo "a";
                                    }
                            echo "'";
                    ?>
                    >
                    <input type="submit">
            </form>
<?php if(isset($_POST['test'])){
    echo $_POST['test'];
}
?>
    </body>
</html> 
```

虽然，我真的不推荐使用这种方式。我还没有测试它，因为我现在不想破坏我的网络服务器。我的数学可能有点偏离 - 但假设 1 个字符是 1 个字节（基本 ascii）。如果页面完全加载，这将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:10:45.267

由于使用 HTTP 请求将 2GB 从 A 点传输到 B 点似乎不合适（在您的情况下也是如此？），您可能希望在某个时候查看 FTP/Javascript，以便传输数据的任务在背景并且不会冻结您的浏览器，也不会冻结服务器。

假设：

1.  您的服务器可以通过 FTP 处理文件传输

2.  您的 2GB 数据存储在客户端的某个位置，而不是动态生成的。

3.  有一些 JavaScript 库，您可以使用 FTP 管理文件传输（连接和实际传输）

4.  使用上述库和一些 AJAX，您还需要将您的 http POST 请求生命周期与文件传输的状态同步。然后，在请求中，您可以坚持只提交有关您正在上传的 2GB 的信息。

我已经搜索过类似“ftp javascript 客户端”的内容，并且只列出了商业浏览器嵌入式 FTP 客户端。（如果我说废话，请随时纠正我）。

# asp.net - IIS7.5下的Asp Net Mvc 4应用程序未重定向到登录页面

> ID：14489155
> 
> 赞同：1
> 
> 时间：2013-01-23T20:52:58.003
> 
> 标签：asp.net, asp.net-mvc, iis, iis-7, asp.net-mvc-4

> **可能重复：**
> [MVC4 HTTP 错误 403.14 - 禁止](https://stackoverflow.com/questions/11425574/mvc4-http-error-403-14-forbidden)

每次我必须配置一个 ASP.Net mvc 应用程序时，我都会遇到同样的错误：

```
HTTP Error 403.14 - Forbidden
The Web server is configured to not list the contents of this directory. 
```

这可能发生是有原因的，我已经弄清楚了。

将应用程序池配置为使用 LocalSystem 帐户。在项目文件夹中添加了此用户的权限。

今天另一个有这个问题的应用程序只更改应用程序池以使用 LocalSystem 帐户是不够的。我能做些什么来解决这个问题。

PS：在 Asp Net mvc 中，我们没有在 IIS 上启用浏览器目录，所以我不明白为什么会出现问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:58:13.017

您看到此错误正是因为您不允许目录浏览。这向您显示的是 MVC 没有收到请求并且 IIS 正在尝试查找默认文档。 [我过去回答过一个类似的问题](https://stackoverflow.com/questions/11425574/mvc4-http-error-403-14-forbidden/11433491#11433491)，也许其中一些建议会帮助你发现你的问题

> 错误 403.14 是不允许列出目录内容的 HTTP 错误代码。请确保
> 
> *   您已将网站设置为 IIS 中的应用程序您已在服务器上安装了 .NET 4.5
> *   您已将应用程序池设置为运行正确版本的 .NET 框架（即，它未设置为 .NET 2.0
> *   您正在应用程序池 .NET 上使用集成管道
> *   4.5实际上是在IIS中注册的。有关类似问题/解决方案，请参阅[此帖子](https://stackoverflow.com/questions/2374957/asp-net-mvc-on-iis-7-5)通常，a 和 d 是围绕 MVC 部署到 IIS 的最大问题

另外，检查您的 web.config 并确保此行存在：

```
<system.webServer>
   <modules runAllManagedModulesForAllRequests="true"/> 
 </system.webServer> 
```

**更新**

好吧，我当然没想到我的回答会受到如此多的关注……话虽如此，我可以在下面的对话中展开更多的讨论。DarinD 表示担心

```
<system.webServer>
   <modules runAllManagedModulesForAllRequests="true"/> 
 </system.webServer> 
```

是您的 Web 服务器的额外负担，他是正确的。此行将导致 IIS 为任何请求加载所有模块，包括静态文件。话虽如此，考虑到 IIS 7 的各个方面（例如内核缓存），除非您托管一个非常高流量的站点/拥有大量模块，否则您或您的用户很可能不会注意到性能影响。

如果您想查看可能不同的解决方案，请查看[此博客文章](http://www.britishdeveloper.co.uk/2010/06/dont-use-modules-runallmanagedmodulesfo.html)以获取有关上面 managedModule 行的更多信息，您可以测试那里提出的解决方案是否也解决了您的问题。

最后，[这是一篇博](http://blogs.msdn.com/b/tmarq/archive/2010/04/01/asp-net-4-0-enables-routing-of-extensionless-urls-without-impacting-static-requests.aspx)文，不仅涵盖了潜在的性能影响，还深入探讨了路由的工作原理以及在 IIS 6 和 7 上获取无扩展 URL 路由所需的操作（也应涵盖 7.5）

# java - 有什么方法可以显着提高此文件搜索的效率？

> ID：14489170
> 
> 赞同：0
> 
> 时间：2013-01-23T20:53:45.367
> 
> 标签：java, recursion, file-search

此方法使用递归来查找名称中包含特定字符串的文件。它在网络驱动器上搜索，有时必须搜索数百甚至数千个目录才能找到它要查找的内容。它相当慢——有时需要 5-10 秒。我怀疑延迟是由网络连接引起的，因为这个网络对于其他一切都非常快。无论如何，这只是我创造的东西，所以那里可能有更有效的东西。

```
public static File findFile(File root, String name)
{
    File [] dir = root.listFiles();
    File a = null;

    for(int i = 0; i < dir.length; i++)
    {
        if(dir[i].isDirectory() && a == null)
            a = findFile(dir[i],name);
        else if(dir[i].getName().indexOf(name) > -1)
            return dir[i];
    }

    return a;
} 
```

那么有什么办法可以改善这一点吗？还是搜索这么多目录的过程总是那么慢？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:06:46.683

这可能是矫枉过正，但考虑建立一个[index](http://en.wikipedia.org/wiki/Search_engine_indexing)。

就个人而言，我过去曾使用[Apache Lucene](http://lucene.apache.org/core/)来索引各种 Web 资产，包括图像文件、PDF、html 等。使用 Lucene 4.1，添加到索引以及搜索索引非常简单。

**将文件夹（和所有子文件夹）添加到索引**

首先，将网络驱动器中的所有内容添加到索引中非常简单：

> java org.apache.lucene.demo.IndexFiles -docs {path-to-folder}

**搜索索引**

将所有必需的文件添加到索引后，您可以使用 Lucene 库提供的搜索索引器来搜索文档：

```
IndexSearcher.search(query, n) 
```

配置的可能性无穷无尽，您也不仅限于搜索文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:57:43.130

在大型目录结构中，搜索必须花费更长的时间。如果您需要速度，请考虑基于索引的方法（构建并动态更新文件名索引，并且只在其中进行查找）。

这正是 Linux`locate`命令的工作原理，它的搜索是即时的。

# hibernate - 由于缺少 com.googlecode.s2hibernate.struts2.plugin.s2hibernatevalidator.interceptor.HibernateValidatorInterceptor 而导致部署错误

> ID：14489176
> 
> 赞同：1
> 
> 时间：2013-01-23T20:54:14.740
> 
> 标签：hibernate, struts2, tomcat6, validation

我有一个使用 Struts2 和 Hibernate 的 Web 应用程序。当我运行构建脚本来部署项目时，它会在本地没有错误地部署它。但是当我尝试在服务器上部署它时，我得到了这个奇怪的错误：

```
INFO: Deploying web application directory IsobolCurator
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from org.hibernate.util.DTDEntityResolver.resolveEntity(DTDEntityResolver.java:73)
recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
-----
WARN from com.opensymphony.xwork2.util.logging.commons.CommonsLogger.warn(CommonsLogger.java:56)
Unable to load config class com.googlecode.s2hibernate.struts2.plugin.s2hibernatevalidator.interceptor.HibernateValidatorInterceptor at interceptor - jar:file:/usr/local/apache-tomcat-6.0.35-ontowebapi/webapps/IsobolCurator/WEB-INF/lib/struts2-fullhibernatecore-plugin-2.2.1-GA.jar!/struts-plugin.xml:16:173 probably due to a missing jar, which might be fine if you never plan to use the hibernateValidatorInterceptor interceptor
-----
ERROR from com.opensymphony.xwork2.util.logging.commons.CommonsLogger.error(CommonsLogger.java:38)
Actual exception
Could not load class com.googlecode.s2hibernate.struts2.plugin.s2hibernatevalidator.interceptor.HibernateValidatorInterceptor. Perhaps it exists but certain dependencies are not available? - interceptor - jar:file:/usr/local/apache-tomcat-6.0.35-ontowebapi/webapps/IsobolCurator/WEB-INF/lib/struts2-fullhibernatecore-plugin-2.2.1-GA.jar!/struts-plugin.xml:16:173
        at org.apache.struts2.impl.StrutsObjectFactory.buildInterceptor(StrutsObjectFactory.java:81)
        at com.opensymphony.xwork2.config.providers.InterceptorBuilder.constructInterceptorReference(InterceptorBuilder.java:70)
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.lookupInterceptorReference(XmlConfigurationProvider.java:998)
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadInterceptorStack(XmlConfigurationProvider.java:817)
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadInterceptorStacks(XmlConfigurationProvider.java:830)
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadInterceptors(XmlConfigurationProvider.java:853)
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.addPackage(XmlConfigurationProvider.java:460)
        at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadPackages(XmlConfigurationProvider.java:275)
        at org.apache.struts2.config.StrutsXmlConfigurationProvider.loadPackages(StrutsXmlConfigurationProvider.java:112)
        at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:204)
        at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:66)
        at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:390)
        at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:436)
        at org.apache.struts2.dispatcher.FilterDispatcher.init(FilterDispatcher.java:193)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:295)
        at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:422)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4726)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
        at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1079)
        at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:1002)
        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:506)
        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317)
        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065)
        at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
        at org.apache.catalina.core.StandardService.start(StandardService.java:525)
        at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
        at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.lang.NoClassDefFoundError: javax/validation/spi/ValidationProvider
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
        at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2818)
        at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1159)
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1647)
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Class.java:186)
        at com.googlecode.s2hibernate.struts2.plugin.s2hibernatevalidator.interceptor.HibernateValidatorInterceptor.configValidator(HibernateValidatorInterceptor.java:44)
        at com.googlecode.s2hibernate.struts2.plugin.s2hibernatevalidator.interceptor.HibernateValidatorInterceptor.<clinit>(HibernateValidatorInterceptor.java:24)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
        at java.lang.Class.newInstance0(Class.java:372)
        at java.lang.Class.newInstance(Class.java:325)
        at com.opensymphony.xwork2.ObjectFactory.buildBean(ObjectFactory.java:130)
        at com.opensymphony.xwork2.ObjectFactory.buildBean(ObjectFactory.java:161)
        at com.opensymphony.xwork2.ObjectFactory.buildBean(ObjectFactory.java:150)
        at org.apache.struts2.impl.StrutsObjectFactory.buildInterceptor(StrutsObjectFactory.java:52)
        ... 40 more
Caused by: java.lang.ClassNotFoundException: javax.validation.spi.ValidationProvider
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
        ... 61 more 
```

有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:04:31.017

通过将 bean-validator.jar 添加到我的 lib 文件夹来解决。感谢罗马 C 的提示。

# java - 如何解决不需要的 TestNG assertEquals 重载

> ID：14489186
> 
> 赞同：1
> 
> 时间：2013-01-23T20:54:43.637
> 
> 标签：java, testng

我遇到了一个问题，其中某些类 X 扩展了 java.util.AbstractMap，并且还重载了`equals(Object)`。调用`org.testng.Assert.assertEquals(X a, X b)`解析为`assertEquals(Map<?,?>, Map<?,?>)`. 不是调用“equals”方法，而是比较映射条目。`assertEquals(a, b)`即使`a.equals(b)`是错误的，这也会导致通过。

这段代码演示了这个问题：

```
import static org.testng.Assert.assertEquals;
import static org.testng.Assert.assertTrue;

import java.util.AbstractMap;
import java.util.Collections;
import java.util.Set;

import org.testng.annotations.Test;

public class AssertTest {
    static class X extends AbstractMap<String, Object> {
        private int i;

        public X(int i) {
        this.i = i;
        }

        @Override
        public Set<Entry<String, Object>> entrySet() {
        return Collections.EMPTY_SET;
        }

        @Override
        public boolean equals(Object o) {
        return o instanceof X && i == ((X)o).i;
        }

        @Override
        public int hashCode() {
        return i;
        }
    }

    @Test
    public void test() {
        X one = new X(1);
        X two = new X(2);
        assertEquals(one, two); // passes, should fail IMO
        assertTrue(one.equals(two)); // correctly fails
    }
} 
```

解决此问题的最佳方法是什么？一种可能性是记住不要使用`assertEquals`来验证 X 的实例是否匹配，但这非常容易出错。

另一种可能性是简单地制作 testng 的本地副本并重命名重载。这会产生持续的维护问题。

我唯一的另一个想法是创建一个特定于项目的 Assert 类，该类委托给 testng.Assert 但将有问题的重载重命名为“assertCollectionEquals”、“assertMapEquals”等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:58:04.547

`org.testng.Assert.assertEquals(X a, X b)`调用迭代条目集[的`assertEquals(Map, Map)`方法](https://github.com/cbeust/testng/blob/master/src/main/java/org/testng/Assert.java#L816)`Map#equals`并检查所有条目是否相等，绕过该方法，正如您所注意到的。

一个简单的强制转换将避免调用该方法，`X#equals`而是使用该方法：

```
assertEquals((Object) one, (Object) two); 
```

您还可以将变量声明为对象以获得相同的结果：

```
Object one = new X(1);
Object two = new X(2);
assertEquals(one, two); 
```

这并不能真正解决您的问题，因为它仍然容易出错。

`assertEquals`为了避免偶尔出现的错误，我可以想到一些解决方法（在这里累了，所以有些可能没有什么意义），使用没有强制调用的事实`x.entrySet()`：

*   编写一些代码来解析 X 类的所有测试文件，并确保有一个适当的强制转换（不简单）或 no`X`在左侧声明`=`
*   在方法中使用模拟框架和模拟 X `@BeforeGroups`（如果您使用组）并将依赖于该惯用语的每个测试放在同一个组中，以便他们将使用模拟 X，其中 entrySet 无法通过您的测试（并且其他方法作为预期），或者至少记录/打印一些警告。如果你还需要用`entrySet`同样的方法不起作用
*   使用模拟框架来模拟`TestNG#assertEquals(Map, Map)`以获得所需的行为
*   在所有需要该习惯用法的测试类中，创建一个临时`assertEquals(Map, Map)`方法。如果您有所有 assertEquals 方法的静态导入，您也必须重新实现其他签名:-(
*   have all those test classes inherit a BaseXTestClass where you implement an `assertEquals(Map, Map)` method - same caveat

# java - Java透明PNG到剪贴板

> ID：14489194
> 
> 赞同：10
> 
> 时间：2013-01-23T20:55:14.177
> 
> 标签：java, png, clipboard, transparent

我正在尝试将 png 文件复制到程序中的剪贴板，并在粘贴到另一个程序（例如 ms office、paint、photoshop）时保持其 alpha 通道。问题是，大多数程序中的 alpha 通道都会变黑。我已经在网上搜索了几个小时，但找不到解决方案。我正在使用的代码：

```
setClipboard(Toolkit.getDefaultToolkit().getImage(parent.getSelectedPicturePath()));

public static void setClipboard(Image image) {
    ImageSelection imgSel;
if (OSDetector.isWindows()) {
    imgSel = new ImageSelection(image);
} else {
    imgSel = new ImageSelection(getBufferedImage(image));
}
Toolkit.getDefaultToolkit().getSystemClipboard().setContents(imgSel, null);
} 
```

有什么方法可以维护 Java 中的 alpha 通道？我尝试将 png 转换为 BufferedImage、Image 等并将其粘贴到剪贴板，但没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-14T06:21:07.387

假设它`OSDetector`工作正常，我能够让 OP 的代码在运行 Oracle JDK 1.8.0_131 的 Windows Server 2008R2 64 位上开箱即用。OP 省略了 的代码`getBufferedImage()`，但我怀疑它是[此博客](https://blog.pengoworks.com/index.cfm/2008/2/8/The-nightmares-of-getting-images-from-the-Mac-OS-X-clipboard-using-Java)中版本的一些变体。

当我在 Windows 上使用博客的版本`getBufferedImage()`（忽略`OSDetector`检查）测试代码时，我能够重现整个图像为黑色的问题的变体，结果证明这是异步调用的时间问题`Image.getWidth()`, `Image.getHeight()`,和`Graphics.drawImage()`，所有这些都立即返回并采取观察者进行异步更新。博客代码通过`null`（无观察者）所有这些调用，并期望立即返回结果，而我测试时并非如此。

一旦我修改`getBufferedImage()`为使用回调，我重现了确切的问题：alpha 通道显示为黑色。这种行为的原因是具有透明度的图像被绘制到默认为黑色画布的图形上下文中。您所看到的正是您在具有黑色背景的网页上查看图像时所看到的。

为了改变这一点，我使用了[这个 StackOverflow 答案](https://stackoverflow.com/a/26918760/7711045)的提示并将背景涂成白色。

我使用了[这个站点](http://www.java2s.com/Tutorial/Java/0120__Development/SettinganimageontheclipboardwithacustomTransferableobjecttoholdtheimage.htm)`ImageSelection`的实现，它简单地将一个实例包装在using 中。`Image``Transferrable``DataFlavor.imageFlavor`

最终，对于我的测试，原始图像和缓冲图像变体都可以在 Windows 上运行。下面是代码：

```
public static void getBufferedImage(Image image, Consumer<Image> imageConsumer) {

    image.getWidth((img, info, x, y, w, h) -> {
        if (info == ImageObserver.ALLBITS) {
            BufferedImage buffered = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
            Graphics2D g2 = buffered.createGraphics();
            g2.setColor(Color.WHITE); // You choose the background color
            g2.fillRect(0, 0, w, h);
            if (g2.drawImage(img, 0, 0, w, h, (img2, info2, x2, y2, w2, h2) -> {
                if (info2 == ImageObserver.ALLBITS) {
                    g2.dispose();
                    imageConsumer.accept(img2);
                    return false;
                }
                return true;
            })) {
                g2.dispose();
                imageConsumer.accept(buffered);
            }
            return false;
        }
        return true;
    });
}

public static void setClipboard(Image image) {
    boolean testBuffered = true; // Both buffered and non-buffered worked for me
    if (!testBuffered) {
        Toolkit.getDefaultToolkit().getSystemClipboard().setContents(new ImageSelection(image), null);
    } else {
        getBufferedImage(image, (buffered) -> {
            ImageSelection imgSel = new ImageSelection(buffered);
            Toolkit.getDefaultToolkit().getSystemClipboard().setContents(imgSel, null);
        });
    }
} 
```

我希望这有帮助。祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-08T09:54:03.760

这是正确的答案吗？你试过这个吗？

```
 public void doCopyToClipboardAction()
{
  // figure out which frame is in the foreground
  MetaFrame activeMetaFrame = null;
  for (MetaFrame mf : frames)
  {
    if (mf.isActive()) activeMetaFrame = mf;
  }
  // get the image from the current jframe
  Image image = activeMetaFrame.getCurrentImage();
  // place that image on the clipboard
  setClipboard(image);
}

// code below from exampledepot.com
//This method writes a image to the system clipboard.
//otherwise it returns null.
public static void setClipboard(Image image)
{
   ImageSelection imgSel = new ImageSelection(image);
   Toolkit.getDefaultToolkit().getSystemClipboard().setContents(imgSel, null);
}

// This class is used to hold an image while on the clipboard.
static class ImageSelection implements Transferable
{
  private Image image;

  public ImageSelection(Image image)
  {
    this.image = image;
  }

  // Returns supported flavors
  public DataFlavor[] getTransferDataFlavors()
  {
    return new DataFlavor[] { DataFlavor.imageFlavor };
  }

  // Returns true if flavor is supported
  public boolean isDataFlavorSupported(DataFlavor flavor)
  {
    return DataFlavor.imageFlavor.equals(flavor);
  }

  // Returns image
  public Object getTransferData(DataFlavor flavor)
      throws UnsupportedFlavorException, IOException
  {
    if (!DataFlavor.imageFlavor.equals(flavor))
    {
      throw new UnsupportedFlavorException(flavor);
    }
    return image;
  }
} 
```

来源：[http ://alvinalexander.com/java/java-copy-image-to-clipboard-example](http://alvinalexander.com/java/java-copy-image-to-clipboard-example)

我自己没有尝试过，对此我不确定。希望你得到正确的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-10T21:53:23.163

这是一个非常简单、自包含的示例。阅读或创建图像取决于您。这段代码只是创建了一个在 alpha 类型的 BufferedImage 上绘制的红色圆圈。当我将它粘贴到任何支持透明度的程序中时，它会正确显示。希望能帮助到你。

```
import java.awt.*;
import java.awt.datatransfer.*;
import java.awt.image.BufferedImage;
import java.io.IOException;

public class CopyImageToClipboard {
    public void createClipboardImageWithAlpha() {
        //Create a buffered image of the correct type, with alpha.
        BufferedImage image = new BufferedImage(600, 600, BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2d = image.createGraphics();
        //Draw in the buffered image.
        g2d.setColor(Color.red);
        g2d.fillOval(10, 10, 580, 580);

        //Add the BufferedImage to the clipboard with transferable image flavor.
        Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
        Transferable transferableImage = getTransferableImage(image);
        clipboard.setContents(transferableImage, null);
    }

    private Transferable getTransferableImage(final BufferedImage bufferedImage) {
        return new Transferable() {
            @Override
            public DataFlavor[] getTransferDataFlavors() {
                return new DataFlavor[] { DataFlavor.imageFlavor };
            }

            @Override
            public boolean isDataFlavorSupported(DataFlavor flavor) {
                return DataFlavor.imageFlavor.equals(flavor);
            }

            @Override
            public Object getTransferData(DataFlavor flavor) throws UnsupportedFlavorException, IOException {
                if (DataFlavor.imageFlavor.equals(flavor)) {
                    return bufferedImage;
                }
                return null;
            }
        };
    }
} 
```

# math - 如何在给定两个旋转角度和一个速度的情况下计算 x、y、z 速度？

> ID：14489195
> 
> 赞同：2
> 
> 时间：2013-01-23T20:55:24.883
> 
> 标签：math, vector, 3d

这个问题的另一种说法是：给定长方体的对角线长度和 2 个旋转角，我如何找到长方体的长度、宽度和高度。

这是一个 3d 游戏，用户可以更改上/下旋转（向上和向下箭头键）、左/右旋转（左和右箭头键）并且对象可以加速和反转（Q 和 w）。每一帧，对象 x、y、z 都会根据其当前速度以及上/下和左/右旋转进行更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:08:30.037

如果`alpha`是左/右角并且`beta`是上/下角，那么

```
v.x = speed * sin (alpha) * cos(beta)
v.y = speed * sin (beta)
v.z = speed * cos (alpha) * cos(beta) 
```

假设，没有旋转将返回方向 (0, 0, 1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:34:50.377

我假设这个长方体是使用静态参考系测量的，其中对角线从原点开始并延伸到其他点。如果不是，这个问题没有明确的答案，因为单独的对角线长度不能确定任意长方体的宽度、高度和长度，因为有无数个长方体可以具有相同的对角线。

听起来您使用的是球坐标系：[http ://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates](http://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates)

来自文章：

```
x = r sin θ cos φ
y = r sin θ sin φ
z = r cos θ 
```

`r`是你的对角线长度。您必须确定`θ`并`φ`基于您的旋转角度；它们可能不是正确的倾角和方位角。有关如何在球坐标中定义这些角度的详细信息，请参阅文章。

# macos - 在 Mac Lion 上安装 PLR

> ID：14489197
> 
> 赞同：1
> 
> 时间：2013-01-23T20:55:33.770
> 
> 标签：macos, r, postgresql, plr

我正在尝试在运行 OS X 10.7.5、Postgres 9.2 和 R 2.15.2 的 MacBook Pro 上安装 PL/R 8.3.0.13.1。我在网上找到了一个[很好的 Windows 分步指南](http://www.bostongis.com/PrinterFriendly.aspx?content_name=postgresql_plr_tut01) ，但我找不到任何与 Mac 类似的东西。
当我运行这个命令时我卡住了[作为官方文档]（[http://www.joeconway.com/plr/doc/plr-install.html](http://www.joeconway.com/plr/doc/plr-install.html)）：

```
USE_PGXS=1 make 
```

输出：

```
make: pkg-config: Command not found
make: pkg-config: Command not found
make: pkg-config: Command not found
make: pkg-config: Command not found
make: pkg-config: Command not found

*** Cannot build PL/R because R_HOME cannot be found.
*** Refer to the documentation for details. 
```

显然，这意味着我需要以某种方式创建 R_HOME、变量和/或位置......

知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T18:45:42.573

错误消息实际上有点令人困惑。如果您查看 PL/R 的 Makefile，逻辑是它`R_HOME`在设置时用于查找 R，否则它会尝试`pkg-config`. 你没有设置，所以它会退出。

如果可能的话，我建议走这`pkg-config`条路线。该`R_HOME`路线似乎假设了一种可能不普遍适用的 R 安装方案。也许它适用于直接从源代码构建。

以上适用于所有平台。现在在 OS X 上，这取决于你如何安装 R。例如，如果你使用 MacPorts，它会变成这样：

```
sudo port install pkgconfig
sudo port install R 
```

然后自己构建 PL/R：

```
make USE_PGXS=1 
```

但这会中断，因为 PL/R 不希望 MacPorts 将 R 头文件分成两个单独的目录（我想是架构相关和独立的）。

Homebrew 可能会更好，但原理是一样的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:21:53.493

您需要弄清楚应该设置 PLR 环境 R_HOME 变量的内容。在终端会话中，我得到了这个

```
computername:~ username$ R RHOME      #only enter stuff after"$"
/Library/Frameworks/R.framework/Resources 
```

这是您链接到的页面的底部：

“提示：R_HOME 必须在启动 PostgreSQL 的用户环境中定义，在启动 postmaster 之前。否则 PL/R 将拒绝加载。请参阅 plr_environ()，它允许检查 PostgreSQL postmaster 可用的环境过程。 ”

这是来自[描述问题并提供修复的网页](https://bugs.launchpad.net/ubuntu/+source/plr/+bug/130059)：

```
To fix: Add a "R_HOME = '/usr/lib/R' " to /etc/postgresql/version/cluster/environmen

Example Fix for version 8.1:
 $ sudo -s
 # echo -e "\nR_HOME = '/usr/lib/R'" >> /etc/postgresql/8.1/main/environment
 # exit

To Test:
 $ sudo /etc/init.d/postgresql-8.1 restart
 $ sudo -u postgres psql plr_test
 plr_test=# select test();
  test
 ------ 
```

# websphere - Websphere 服务器端口未按预期运行

> ID：14489205
> 
> 赞同：0
> 
> 时间：2013-01-23T20:56:02.743
> 
> 标签：websphere, admin, rad, ports

在 WAS 中，管理控制台通常通过 url 访问：`https://localhost:9043/console`。现在我只想知道这个 9043 是从哪里来的。所以我去`Servers--> Application Servers --> server1 --> Ports`并期望看到`9043`作为列出的端口之一。有：`WC_adminhost : 9060`和`WC_adminhost_secure :9043`。到现在为止还挺好。

我的问题是：如果`https://localhost:9043/console`打开页面，为什么会 `http://localhost:9060/console`给出错误页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:45:07.490

我想命名有点混乱，但这是你的答案。为了访问管理控制台，有两个 URL：

```
http://localhost:9060/admin/ (shortened) 
http://localhost:9060/ibm/console 
```

没有页面定义为 /console，所以我希望你得到 404。

然后，如果您的服务器是安全的，您将被重定向到端口 9043

# mysql - 在MySQL中按大圆距离计算和分组

> ID：14489213
> 
> 赞同：1
> 
> 时间：2013-01-23T20:56:30.360
> 
> 标签：mysql, sql

我有两张桌子，一张大致如下：

```
client_ip  server_ip  speed
---------  ---------  -----
1.2.3.4    9.1.2.3    100
1.2.3.5    9.1.2.3    1033 
```

还有一个有地理数据的：

```
ip       latitude    longitude
-------  --------    ---------
1.2.3.4  13.75       100.21
1.2.3.5  21.1234     141.21
9.1.2.3  13.75       99.21 
```

我想编写一个选择查询，找出两个 IP 地址之间的大圆距离，按它分组，并计算平均速度。因此，例如，理想的输出将类似于：

```
distance  avg(speed)
--------  ----------
21        99
100       1234 
```

虽然我知道在 SQL 中获得大圆距离方面有[很好的资源，但我对如何有效地连接这两个表有点模糊，因为两者都相当大（数百万行）。](https://developers.google.com/maps/articles/phpsqlsearch_v3#findnearsql)

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:13:56.557

假设地理数据表中的 IP 是唯一的，实际上它并不是一个非常昂贵的连接。即使您从 server_ip 列中具有非唯一值的表加入，您也不必告诉系统它是外连接——对于“速度”表中的每一行，都会有一个，并且只有一个，IP表中匹配client_ip的条目，并且只有一个IP表中匹配server_ip的条目。因此，您可以毫无问题地使用内部连接。

```
SELECT <c.client_ip to s.server_ip distance calc> AS Distance, AVG(sp.speed) AS AvgSpeed
FROM speedTable sp JOIN geoTable c
    ON sp.client_ip = c.client_ip JOIN geoTable s
    ON sp.server_ip = s.server_ip
WHERE 1 = 1 --whatever your where clause is
GROUP BY <c.client_ip to s.server_ip distance calc> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:14:37.897

好吧，连接可能不是这个查询的慢部分，它将是每一行的距离计算......

```
SELECT
  client_ip,
  server_ip,
  avg(speed),
  {your distance calculation} AS distance
FROM 
  speeds
  JOIN geo AS geo_client ON geo_client.ip=speeds.client_ip 
  JOIN geo AS geo_server ON geo_server.ip=speeds.server_ip
GROUP BY
  distance 
```

有你的连接，但请注意，距离计算是在每一行上完成的，有数百万行，你会在那里受到很大的打击。您可以尝试一些事情，也许看看这些其他帖子：

*   [使用庞大的 SQL Server 数据库进行距离计算](https://stackoverflow.com/questions/8526075/distance-calculation-with-huge-sql-server-database)
*   [优化 SQL 距离查询](https://stackoverflow.com/questions/2441757/optimising-sql-distance-query)
*   [SQL获取经度和纬度的距​​离](http://www.n-smith.com/index.cfm/my-blog/2008-08-15-sql-get-distance-from-longitude-and-latitude/)

# javascript - 带有导航的jQuery滚动内容

> ID：14489219
> 
> 赞同：2
> 
> 时间：2013-01-23T20:56:48.033
> 
> 标签：javascript, jquery, html

有人可以告诉我如何滚动内容。例如我有一个这样的链接

```
<a href="#">content3</a> 
```

当用户单击该链接时，我想将内容滚动到`div content3`.

有人可以告诉我如何使用 jQuery 做到这一点吗？

这是我的完整代码。

```
<div class="container">
<div class="nav">
    <ul>
        <li><a class="active" href="#">content1</a></li>
        <li><a href="#">content2</a></li>
        <li><a href="#">content3</a></li>
        <li><a href="#">content4</a></li>
    </ul>
</div>
<div id="content">
<div id="content1" class="content1">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div>
<div id="content2" class="content2">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div>
<div id="content3" class="content3">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div>
<div id="content4" class="content4">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:58:06.560

您不需要 jQuery 来执行此操作 - 只需使用“content3”`href="#content3"`滚动到元素。`id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:00:27.517

jQuery 有 scrollTop 和 scrollLeft 方法来做到这一点。如果它只是垂直滚动，那么 scrollTop(yVal) 就可以了

[http://api.jquery.com/scrollTop/](http://api.jquery.com/scrollTop/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:00:43.417

使用[滚动顶部](http://api.jquery.com/scrollTop/)：

例子 ：

```
<a scrollTo="content3" href="#">click me to scroll to the div "content3"</a>

$(document).ready(function(){
    $('a').on('click',function(){
        $("#container").animate({ scrollTop: $('#'+$(this).attr('scrollTo')).offset().top }, 1000);
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T21:01:35.820

不知道你想做什么，但去看看[wowslider.com](http://wowslider.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T21:06:14.313

像这样使用 $('body').scrollTop 属性：

```
$('#button1').click(function(){
    var element = $('#content1'),
    elemTop = element.offset().top, // You get the element top to know where to move the window
    windowTop = elemTop + 20; // You can add some pixels so the element dont be shown on the very edge
    $("html, body").animate({
           scrollTop:  windowTop // Animate the change so it doesnt seem invasive
    }, "fast");
    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T21:07:22.177

试试这个...

```
$('a').on('click', function (){
    $('html,body').animate({
        scrollTop: $('#'+$(this).text()).offset().top},
    'slow');
}); 
```

请参阅此[JsFiddle 示例](http://jsfiddle.net/cCwjq/1/)

问候...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-23T21:08:29.023

根据您的标记，您似乎想使用锚文本来确定滚动的位置。如果您单击该`content1`链接，它将滚动到`<div id="content1">`。

```
$('.nav ul li a').click(function(){

    $('html, body').animate({
        scrollTop: $('#' + $(this).text()).offset().top
    }, 2000);

}); 
```

以小提琴为例：http: [//jsfiddle.net/ZG3zh/](http://jsfiddle.net/ZG3zh/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-23T21:13:27.277

为了使用 HTML 滚动，您需要设置滚动到`href`的锚点`#+'id of element'`。

示例：我想滚动到`<div id="scrollHere">Hello World</div>` 使用`anchor`标签或`a`使用代码，`<a href="#scrollHere">Click Me!</a>`

# c# - 如何解决 NHibernate.MappingException

> ID：14489220
> 
> 赞同：2
> 
> 时间：2013-01-23T20:56:48.470
> 
> 标签：c#, sql, nhibernate, nhibernate-mapping

![在此处输入图像描述](../Images/3f576d48c78c96803a58ef3ca354c87f.png) 我有一个数据库、hbm 映射文件和位于**类库**中的 App.config 。现在从一个测试项目中我引用该库并尝试调用我创建的 HibernateHelper 类，在运行时抛出以下错误：

**NHibernate.MappingException：无法编译映射文档：HibernateExample.Mappings.Products.hbm.xml**

请记住，这是一个从测试项目中引用的类库。如果我将它的输出类型更改为控制台应用程序，它运行良好。但是当我将它改回类库并从我的测试项目中引用它时，它会引发上述错误。

我尝试添加 config.Configure() 但这会引发 NhibernateDuplicateMapping 异常。

**修复：通过从 appconfig 中删除来修复重复映射问题。并通过在我的测试项目中放置一个 hibernate.cfg.xml 文件来修复问题映射实体。**

* * *

```
 public sealed class NHibernateHelper
{
    private static ISessionFactory _sessionFactory;
    const string Connectionstring = "servicestring";

    public static void OpenSession()
    {      
        var config = new Configuration();                        
        config.Configure();
        config.AddAssembly(Assembly.GetCallingAssembly());    
        _sessionFactory = config.BuildSessionFactory();

    }

    public static ISession GetCurrentSession()
    {
        ISession session = null; 
        if (_sessionFactory == null)
            OpenSession();

        if (_sessionFactory != null)
        {
            session = _sessionFactory.OpenSession();
        }

        return session;
    }

    public static void CloseSessionFactory()
    {
        if (_sessionFactory != null)
        {
            _sessionFactory.Close();
        }
    }

    // var dsn = ConfigurationManager.ConnectionStrings[Connectionstring].ConnectionString;
    //config.SessionFactory().Integrate.Using<MsSqlCeDialect>().Connected.ByAppConfing(dsn);
    // System.Diagnostics.Debug.WriteLine("My connection string: "+dsn);
    //Get NHibernate configuration 
    //_sessionFactory = config.BuildSessionFactory();  
    //config.AddAssembly("HibernateExample");
} 
```

有任何想法吗？

```
 <?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="hibernate-configuration" type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate" />
  </configSections>
  <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2" >
    <session-factory>
      <property name="connection.driver_class"> NHibernate.Driver.SqlServerCeDriver</property>
        <property name="dialect">NHibernate.Dialect.MsSqlCeDialect</property>
      <property name="connection.connection_string">Data Source=FirstSample.sdf;</property>
      <property name="show_sql">true</property>
      <mapping assembly="HibernateExample"/>
    </session-factory>
  </hibernate-configuration>

  <connectionStrings>
        <add name="testconnectionstring"
            connectionString="Data Source=|DataDirectory|\FirstSample.sdf;Integrated Security=True"
            providerName="Microsoft.SqlServerCe.Client.3.5" />
    </connectionStrings>

  <runtime>
    <assemblyBinding xmlns="urnchemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Data.SqlServerCe" publicKeyToken="89845DCD8080CC91" culture="neutral"/>
        <bindingRedirect oldVersion="0.0.0.0-9.0.242.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
    </assemblyBinding>

  </runtime>
</configuration> 
```

* * *

```
 <?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="HibernateExample" namespace="HibernateExample.Domain" >
  <class name="Product" table="Products">
    <id name="Id" type="integer">
      <generator class="identity"/>
    </id>
    <property name="Name" type="string"/>
    <property name="Category" type="string"/>
    <property name="Discontinued" />
  </class>
</hibernate-mapping> 
```

* * *

抛出异常：

```
 Test 'NunitTest.TestClass.canquerydb' failed: NHibernate.MappingException : Could not compile the mapping document: HibernateExample.Mappings.Products.hbm.xml
  ----> System.InvalidOperationException : Could not find the dialect in the configuration
    at NHibernate.Cfg.Configuration.LogAndThrow(Exception exception)
    at NHibernate.Cfg.Configuration.AddDeserializedMapping(HbmMapping mappingDocument, String documentFileName)
    at NHibernate.Cfg.Configuration.ProcessMappingsQueue()
    at NHibernate.Cfg.Configuration.AddInputStream(Stream xmlInputStream, String name)
    at NHibernate.Cfg.Configuration.AddResource(String path, Assembly assembly)
    at NHibernate.Cfg.Configuration.AddAssembly(Assembly assembly)
    at NHibernate.Cfg.Configuration.AddAssembly(String assemblyName)
    NHibernateTest\NHibernateHelper.cs(21,0): at HibernateExample.NHibernateTest.NHibernateHelper.openSession()
    NHibernateTest\NHibernateHelper.cs(28,0): at HibernateExample.NHibernateTest.NHibernateHelper.GetCurrentSession()
    TestClass.cs(21,0): at NunitTest.TestClass.canquerydb()
    --InvalidOperationException
    at NHibernate.Dialect.Dialect.GetDialect(IDictionary`2 props)
    at NHibernate.Cfg.Configuration.AddDeserializedMapping(HbmMapping mappingDocument, String documentFileName) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T19:28:25.833

从错误中，您似乎没有`Dialect`在添加映射之前配置 。这是必需的。

这是一段简单的基本配置代码：

```
var configuration = new Configuration();
configuration.SessionFactory().Integrate.Using<MsSql2012Dialect>()
                                        .Connected.ByAppConfing("connName");//sic
//now you can add the mappings 
```

# html - @font-face 自定义字体无法使用 django 的 xhtml2pdf 正确呈现

> ID：14489223
> 
> 赞同：0
> 
> 时间：2013-01-23T20:57:00.840
> 
> 标签：html, css, django, font-face, xhtml2pdf

我在尝试从 HTML 呈现 pdf 时尝试使用自定义字体。

我已经在 HTML 中尝试过了，字体显示出来了，所以字体的路径必须是正确的，并且它可能被正确使用。字体是 .ttf 类型，根据[http://xhtml2pdf-base.googlecode.com/hg/doc/xhtml2pdf-en.html](http://xhtml2pdf-base.googlecode.com/hg/doc/xhtml2pdf-en.html)上的文档，它应该呈现，但它没有。

这是我的风格标签中的内容：

```
@font-face {
  font-family: "Swiss";
  src: url("/static/font/swiss.ttf");
}
body {
  font-family: "Swiss";
  font-size: 12px;
} 
```

和html：

```
<body>
  asdf
</body> 
```

我已经尝试了很多东西，从字体 url 和字体系列中去掉引号，我的身体被包裹在 HTML 标签中，所以 html 的格式正确。在网页中呈现时一切都呈现正常，但在转换为 PDF 时呈现不正确。谁能帮我找出错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:23:16.163

最好的方法是使用回调来使用文件系统路径获取字体。更准确，而且您不会为每个资源（资源含义、字体、图像等）访问网络服务器

```
pisa.CreatePDF(html.encode("UTF-8"), file_object , encoding='UTF-8',
               link_callback=fetch_resources)

def fetch_resources(uri, rel):
    find_file_in_path_using_uri
    return path 
```

顺便说一句，我认为你的问题是你还没有收集静态字体，所以字体并不真正位于 /static/font/swiss.ttf。我的意思是它们不在 django 之外，而 xhtml2pdf 在 django 之外。我不是百分百确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-13T12:39:01.037

我曾经也有过一样的问题。[gdrimes](https://stackoverflow.com/users/6470600/gdrimes)是对的。从相对更改网址后：

```
@font-face {
            font-family: FreeSans;
            src: url("./FreeSans.ttf");
        } 
```

绝对

```
@font-face {
            font-family: FreeSans;
            src: url("/home/rok/Documents/Muzey/muzey/website/templates/pdf/FreeSans.ttf");
        } 
```

我的 PDF 文档中的字体已更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-08T04:12:40.703

我迟到了这个线程，但我最近遇到了同样的问题。使用回调来提供字体定义的建议确实有效（但在我的情况下有一些限制，因为我需要一些逻辑来根据外部条件使用不同的字体）。但是，我发现问题在于 url("/static/font/swiss.ttf") 需要是绝对文件位置，而不是相对于您的应用程序位置，如图所示。例如，在我的情况下，我的应用程序位置是“/home/user/app”，url 需要是：url("/home/user/app/static/font/swiss.ttf")。

# sas - SAS Proc SQL 将常量添加到变量

> ID：14489224
> 
> 赞同：0
> 
> 时间：2013-01-23T20:57:01.300
> 
> 标签：sas, greenplum

我有一个带有数字变量`to`、`from`和的 SAS 数据集`weight`。一些观测值的值为 0 `weight`。我需要所有的`weight`值都是正数，所以我希望简单地将所有`weight`值加 1。

如何使用 Proc SQL 做到这一点？

我尝试了以下方法，但它不起作用：

```
proc sql;
    update mylib.mydata
        set weight=weight+1;
quit; 
```

错误是：

```
ERROR: A CURRENT-OF-CURSOR operation cannot be initiated because
the column "weight" cannot be used to uniquely identify a row
because of its data type. 
```

此外，`mylib`指的是 Greenplum 设备。这可能是问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:11:35.710

如果您拥有更新该表的数据库权限，您可能希望使用 SAS/Access 传递工具。您需要知道正确的语法才能使其正常工作。这是一个无效的示例：

```
proc sql;
  connect to greenplm as dbcon
    (server=greenplum04 db=sample port=5432 user=gpusr1 password=gppwd1);
  execute (
     /* Native code goes here */

     update sample.mydata
        set weight=weight+1   

   ) by dbcon;
quit; 
```

连接字符串将与`LIBNAME`定义“mylib”libref 的连接字符串相同。

但是，如果您真的想创建一个 SAS 数据集（而不是更新真实表），您可以通过一个简单的数据步骤来做到这一点：

```
data mydata;
   set mylib.mydata
   weight = weight + 1;
run; 
```

这将创建可与其他 SAS 过程一起使用的表的**副本。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:27:13.197

在progress.com 上查看[此说明。](http://knowledgebase.progress.com/articles/Article/9081)您可能需要添加`UPDATE_MULT_ROWS=YES`到您的库定义中。

# dictionary - 有限地图示例

> ID：14489232
> 
> 赞同：10
> 
> 时间：2013-01-23T20:57:36.283
> 
> 标签：dictionary, coq

对于我的应用程序，我需要在 Coq 中使用和推理有限映射。谷歌搜索我发现 FMapAVL 似乎非常适合我的需求。问题是文档很少，我还没有弄清楚我应该如何使用它。

作为一个简单的例子，考虑以下使用对列表的有限映射的愚蠢实现。

```
Require Export Bool.
Require Export List.
Require Export Arith.EqNat.

Definition map_nat_nat: Type := list (nat * nat).

Fixpoint find (k: nat) (m: map_nat_nat) :=
match m with
| nil => None
| kv :: m' => if beq_nat (fst kv) k 
                then Some (snd kv)
                else find k m'
end.

Notation "x |-> y" := (pair x y) (at level 60, no associativity).
Notation "[ ]" := nil.
Notation "[ p , .. , r ]" := (cons p .. (cons r nil) .. ).

Example ex1: find 3 [1 |-> 2, 3 |-> 4] = Some 4.
Proof. reflexivity. Qed.

Example ex2: find 5 [1 |-> 2, 3 |-> 4] = None.
Proof. reflexivity. Qed. 
```

我如何使用 FMapAVL 而不是对列表来定义和证明类似的示例？

* * *

# 解决方案

感谢[Ptival bellow 的回答](https://stackoverflow.com/a/14489867/359178)，这是一个完整的工作示例：

```
Require Export FMapAVL.
Require Export Coq.Structures.OrderedTypeEx.

Module M := FMapAVL.Make(Nat_as_OT).

Definition map_nat_nat: Type := M.t nat.

Definition find k (m: map_nat_nat) := M.find k m.

Definition update (p: nat * nat) (m: map_nat_nat) :=
  M.add (fst p) (snd p) m.

Notation "k |-> v" := (pair k v) (at level 60).
Notation "[ ]" := (M.empty nat).
Notation "[ p1 , .. , pn ]" := (update p1 .. (update pn (M.empty nat)) .. ).

Example ex1: find 3 [1 |-> 2, 3 |-> 4] = Some 4.
Proof. reflexivity. Qed.

Example ex2: find 5 [1 |-> 2, 3 |-> 4] = None.
Proof. reflexivity. Qed. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T21:38:07.083

假设您知道如何创建模块`OrderedNat : OrderedType`模块，请在评论中询问您是否需要帮助。

```
Module M := FMapAVL.Make(OrderedNat).

Definition map_nat_nat := M.t nat.

Definition find k (m : nap_nat_nat) := M.find k m. (* you can just use M.find otherwise... *)

Notation "x |-> y" := (M.add x y M.empty) (at level 60, no associativity).

Notation "[ ]" := nil.

Notation "[ k1 |-> d1 , .. , kn |-> dn ]" := (M.add k1 d1 .. (M.add kn dn M.empty) .. ). 
```

我现在无法测试，但它应该与此非常相似。

# php - Ajax加载页面，传递POST数据

> ID：14489236
> 
> 赞同：0
> 
> 时间：2013-01-23T20:57:45.920
> 
> 标签：php, ajax, forms, post

我的所有网页都加载了 ajax，我不确定如何从加载的页面中包含 POST 数据。目标是拥有一个注册表单并将该数据发布到另一个 php 文件并在那里进行处理。

ajaxloader.js

```
$(document).ready(function(){
    checkURL();
    $('ul li a').click(function (e){

            checkURL(this.hash);

    }); 

    setInterval("checkURL()",250);
    loadPage('#Home');
});

var lasturl="";

function checkURL(hash)
{
    if(!hash) hash=window.location.hash;

    if(hash != lasturl)
    {
        lasturl=hash;
        loadPage(hash);
    }
}

function loadPage(url)
{
    url=url.replace('#','');

    $.ajax({
        type: "POST",
        url: "load_page.php",
        data: 'page='+url,
        success: function(msg){

            if(parseInt(msg)!=0)
            {
                $('#pageContent').html(msg);
            }
        }

    });

} 
```

load_page.php

```
if(!$_POST['page']) die("0");

$page = $_POST['page'];

if(file_exists($page.'.php'))
echo include($page.'.php');

else echo 'There is no such page!';
?> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:02:25.663

所以你的 load_page.php 看起来像

```
if(!$_POST['page']) die("0");

$page = $_POST['page'];
ob_start();

if(file_exists($page.'.php'))
include($page.'.php');
else echo 'There is no such page!';

$content = ob_get_clean();
echo $content; 
```

这应该可以完成这项工作。但是，您不能像这样传递整个网站，您需要 base64_encode() 以确保一切正常。然后看看这个 [http://phpjs.org/functions/base64_decode/](http://phpjs.org/functions/base64_decode/)

# dom - 什么是 DOM 元素属性的 attribute.specified？

> ID：14489237
> 
> 赞同：6
> 
> 时间：2013-01-23T20:57:49.850
> 
> 标签：dom, attributes

我只是偶然发现了这样的事情......

```
function(element) {
  ...
  var attributes = element.attributes;
  for (var index = 0, length = attributes.length; index < length; index++) {
    var attribute = attributes[index];

    // what is ".specified"?
    if (attribute.specified) {
      ...
    }
  }
} 
```

我正在查看 DOM 元素、元素接口的 W3C 规范，但我看不到`specified`任何地方。

[http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-745549614](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-745549614)

是什么`attribute.specified`意思？它代表什么？它在规范中的哪里定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:59:26.193

`<img src="kittens.jpg">`. 属性为`src`，其值为`kittens.jpg`。DOM 元素是通用定义。实际属性由所使用的实际语言指定，例如 XML、HTML 等....

指定 = 属性有一个明确的值分配给它。例如，指定了 src 属性，因为它被赋予了值 kittens.jpg，但是

```
<input type="checkbox" checked /> 
```

选中的属性是 PRESENT，但不是 SPECIFIED。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-21T23:36:00.377

我刚刚发现属性节点的属性`specified`仅对 IE 6-7 有意义的信息，因为在 IE 6-7 中`attributes`返回特定元素节点**支持的所有属性的集合。**然后您可以使用`specified`来确定集合中的属性是否附加到元素节点。如果元素节点没有指定/定义此属性，它将返回 false。在现代浏览器中返回**附加到元素**`attributes`的属性的集合实际上，这意味着集合中的每一个都将在现代浏览器中返回。对于现代浏览器，这种方式适用于 IE 6-7。**`attribute.specified``true``element.hasAttribute(attribute)``element.attributes[attribute].specified`**

 *** * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-11-11T14:49:02.543

不同的浏览器对 DOM 有不同的实现，注意实现是负责这个属性的，而不是用户。但是，用户可以更改该属性的默认值。

至于 Chrome 54.0.2840.71，它使每个 attribute.specified 都为真，无论它是否在 DOM 规范中，它是否具有价值。例如，`__test`指定的属性在 Chrome（版本 54）中始终为 true。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <div __test></div>
    <script>
        var div=document.querySelector("div");
        var attributes = div.attributes;
        var attr_test=attributes[0];
        attr_test.specified=false;// "specified" is not writable and Setting it silently fails.
        console.log(attr_test.specified);
    </script>
</body>
</html> 
```

所以我同意“它正在被淘汰”。

DOM level3 中的“attribute.specified”与 DOM level2 规范不同。

1.同一点

> 如果该属性在实例文档中被显式地赋予了一个值，则为真，否则为假。如果应用程序更改了此属性节点的值（即使它最终具有与默认值相同的值），则将其设置为 true。

2.差异
“DOM-Level2”有更复杂的判断条件来判断“attribute.specified”是否为真。
“DOM-Level3”说

> 该实现可以类似地处理来自其他模式的具有默认值的属性，但应用程序应使用 Document.normalizeDocument() 来保证此信息是最新的。

`specified of type boolean, readonly`在
[https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-637646024](https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-637646024)
与[https://www.w3.org/TR/DOM-Level-2-Core/](https://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-862529273)中搜索
[core.html#ID-862529273](https://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-862529273)**

# jira - 如何在 Jira 中基于组件创建汇总表？

> ID：14489238
> 
> 赞同：1
> 
> 时间：2013-01-23T20:57:50.840
> 
> 标签：jira

我们在 Jira 有一个项目，它有 10 个组件。如何创建一个汇总表（小工具）来显示每个组件的未结工单？

以下是所需输出的示例：

```
ComponentName NumberOfTickets
component1  5
component2  1
component3  0
component4  10 
```

谢谢！

编辑：mdoar 的解决方案适用于我最初的问题。是否可以将其他字段作为组，例如状态，不想要的输出

```
ComponentName Open InProgress QA Closed
component1  5 4 1 10
component2  1 0 1 3
component3  0 1 5 9
component4  10 1 4 6 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:06:45.560

创建一个过滤器，例如： project = FOO 并且解决方案为空 保存过滤器 在仪表板上创建一个新的问题统计小工具并将其配置为使用保存的过滤器 选择组件作为分​​组依据的字段。

# erlang - f(var) 仅适用于 shell 会话？

> ID：14489240
> 
> 赞同：1
> 
> 时间：2013-01-23T20:57:56.640
> 
> 标签：erlang

我需要在循环中重置一些变量以分配新值（例如查找子字符串的索引）我不能重用相同的 var 所以我必须取消设置它并且据我所知 f(var) 只有在外壳中工作？

那么有没有办法在脚本中做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T21:13:32.043

`f()`是一个仅限 shell 的命令。

Erlang 作为一种语言使用不可变变量，因此不允许在代码本身中重置变量。建议是熟悉递归、列表推导、映射或折叠，以完成 Erlang 中程序意义上不存在的“循环”。

如果您*必须*依赖变量状态，那么最接近可变变量的是进程字典：`get/1`和`put/2`. 除非有充分的理由使用它们，否则通常不鼓励使用它们。

# ruby-on-rails - 建立连接不会带来模型关联

> ID：14489243
> 
> 赞同：0
> 
> 时间：2013-01-23T20:58:03.050
> 
> 标签：ruby-on-rails, multiple-databases

问题：我有多个必须连接的数据库，具体取决于从一开始就选择的服务器。如果我有一个具有用户类关联的客户端表，我可以很好地连接到其中一个数据库并查询客户端，但如果我这样做了，`@clients.userclasses`我会收到一条错误消息，指出表用户类不存在，因为它恢复到原始数据库。

下面的代码：

```
class Connection < ActiveRecord::Base
  self.abstract_class = true
end

class Client < Connection
  has_many :userclasses, :dependent => :destroy
end

class Userclass < Connection
  belongs_to :client
  self.table_name = "userclasses"
end

class ClientsController < ApplicationController
  before_filter :set_server
  def show
    @client = Client.find(params[:id])
    respond_to do |format|
      format.html{ render html: @client}
      format.xml { render xml: @client }
    end
  end
  private

  def set_server
    @server = Server.find(params[:server_id])
    unless @server.nil? or @server.database.nil?
      Client.establish_connection(ActiveRecord::Base.configurations["#{@server.database}"])
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T13:50:03.463

我最终只是将整个 ActiveRecord 连接切换到我需要的连接，而不是尝试仅切换我正在使用的模型。

```
def set_server
    @server = Server.find(params[:server_id])
    unless @server.nil? or @server.database.nil?
      ActiveRecord::Base.establish_connection(ActiveRecord::Base.configurations["#{@server.database}"])
    end
  end 
```

# ruby-on-rails - 需要有关 Rails 应用程序的图像大小调整和显示的建议

> ID：14489254
> 
> 赞同：0
> 
> 时间：2013-01-23T20:58:37.400
> 
> 标签：ruby-on-rails, image

我将首先解释我想做什么。

我有一个带有缩略图的图库网格布局页面。每个缩略图图像的大小应相同，例如 120 像素 x 80 像素。当用户在页面上向下滚动时，我想在页面加载时显示所有图像以及更多图像。网格中的单个图像将存在悬停和单击状态，其中会弹出完整尺寸的图像以显示在灯箱中。

1.  有哪些解决方案（宝石、技术等）可将较大的图像（1024 x 768）加载到我的数据库（照片）模型中，以便我可以生成预定义的较小尺寸的小缩略图？

2.  如果我的目标是在用户向下滚动页面时允许加载更多内容，那么加载整个小图像页面的最佳方式是什么？或者我应该只加载用户看到的内容，然后在他们向下滚动时使用 AJAX 加载更多内容？

3.  在这种情况下，回形针是一种常见的解决方案吗？我正在研究这个和 RailsCasts 上的 CarrierWave。

4.  如果使用回形针之类的东西，它可以处理裁剪与其他图像的纵横比不同的图像吗？即，将与矩形图像相同的方形图像缩放和裁剪到定义的大小。

我是在 Rails 应用程序中处理大量图像的新手，我很欣赏人们熟悉的任何建议、书籍、教程和技术。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:19:31.613

1）我更喜欢回形针，尽管这可能是由于使用其他宝石的经验较少。

2) 通常，处理页面上大量图像的最佳方法是使用精灵表。如果页面上的图像总是相同的，这可能是一个不错的选择。如果你正在做一些无限滚动的事情，ajax 是要走的路（[railscast on无限滚动](http://railscasts.com/episodes/114-endless-page-revised)）

3）我不确定回形针是否是一种常见的解决方案，但它肯定是你应该考虑的一个。

4) 是的，[在回形针中进行裁剪](http://viget.com/extend/manual-cropping-with-paperclip)。

# javascript - 在新的浏览器选项卡中打开 ppt 文件

> ID：14489255
> 
> 赞同：6
> 
> 时间：2013-01-23T20:58:38.340
> 
> 标签：javascript, jquery, html, powerpoint

包含如下 .pdf 的链接将在新选项卡中打开：

```
<a target="_blank" href="http://somePDF.pdf">Download</a> 
```

是否可以在新的浏览器选项卡中打开 Powerpoint 文件 .ppt，而不是让用户下载文件？

我已经尝试了以下方法，但这会使用户下载文件：

```
<a target="_blank" href="http://somePPT.ppt">Download</a> 
```

我不确定这是否可行，也无法找到任何相关信息，所以我在这里发帖。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T21:00:16.250

如果用户的浏览器无法显示该文件并且没有可以显示该文件的插件，它将提供该文件作为下载。

如果您可以将 PowerPoint 幻灯片导出为 PDF 或 HTML，它们更有可能显示在浏览器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:25:31.577

您可以检查浏览器是否安装了 pdf 插件，如果没有，请使用[pdf.js](https://github.com/mozilla/pdf.js)将您的 pdf 转换为 html 页面。

可能看起来像这样：

```
function hasPDFPlugin() {
   for(var i = 0; i < navigator.plugins.length; i++) {
      if(navigator.plugins[i].name.toLowerCase().indexOf('pdf') >== 0) {
        return true;
      }
   }
   return false;
}

if(!hasPDFPlugin()) {
  // do the pdf.js stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-14T08:56:04.187

在谷歌文档的帮助下，它可以在 url= [https://docs.google.com/viewerng/viewer?url=之后查看。添加文件位置](https://docs.google.com/viewerng/viewer?url=)

前 https://docs.google.com/viewerng/viewer?url=http://example.in/filename.ppt

# android - 访问系统功能的全局函数 android

> ID：14489256
> 
> 赞同：0
> 
> 时间：2013-01-23T20:58:40.257
> 
> 标签：android

嗨，我创建了一个全局操作类并在这个类中创建了函数，我试图在另一个活动中访问我遇到的问题是，在 Eclipse 中，我在访问系统功能（如 getSystemService）的函数周围出现编码错误() 和 getApplicationContext() 有人知道为什么或如何让全局类接受系统功能吗？

继承人我到目前为止继承人我的 GloblActions.java

```
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.util.Log;

public class GlobalActions{
        Context mContext;

        // constructor
        public GlobalActions(Context context){
            this.mContext = context;
        }

        public final static boolean isOnline (Context someContext){ {

            Log.v("globals", "isonline");

    ConnectivityManager cm = (ConnectivityManager) someContext.getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo netInfo = cm.getActiveNetworkInfo();

        if (netInfo != null && netInfo.isConnectedOrConnecting()) {
            return true;
        }
        return false;
        }

}

        public final static void checkInternet(Context someContext){

                    isOnline(someContext);
                    if(isOnline(someContext) == false){
                       Log.v("globals", "isOnline = false");
                       Intent register = new Intent(someContext.getApplicationContext(), LoginForm.class);
                       someContext.startActivity(register);
                    }
                }

        } 
```

这是我在活动中使用该功能的地方。我的目标是通过调用全局函数来检查每个活动的互联网连接，如果没有找到连接，则转到一个没有互联网连接的活动。

```
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.app.Activity;
import android.content.Intent;
import android.view.View;
import android.view.animation.Animation;
import android.view.animation.AnimationUtils;
import android.widget.TextView;
import android.os.Handler;
import com.myApp.myApp.GlobalActions;

public class IntroLoader extends Activity {

    public Handler handler;
    public TextView loadText = null;
    public Animation AniFadein = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.lo_introloader);
        findViewById(R.id.progressBar1).setVisibility(View.GONE);
        findViewById(R.id.loadTextView).setVisibility(View.GONE);
         GlobalActions.isOnline(null);
         GlobalActions.checkInternet(null);

        handler = new Handler();
        final Runnable fadeIn = new Runnable()
        {
            public void run() 
            {
               animations();
               findViewById(R.id.progressBar1).setVisibility(View.VISIBLE);
               findViewById(R.id.loadTextView).setVisibility(View.VISIBLE);
                         }
        };
        handler.postDelayed(fadeIn, 3000);

        final Runnable aSyncTask= new Runnable()
        {
            public void run() 
            {

               PostTask posttask;
               posttask = new PostTask();
               posttask.execute();

            }
        };
        handler.postDelayed(aSyncTask, 4000);

    }

    public void animations(){

        loadText = (TextView)findViewById(R.id.loadTextView);
        AniFadein = AnimationUtils.loadAnimation(this, R.anim.fadein);  
        loadText.startAnimation(AniFadein); 

    }

  public class PostTask extends AsyncTask<Void, String, Boolean> {

        protected void onPreExecute() {
            super.onPreExecute();

        }

        @Override
        protected Boolean doInBackground(Void... params) {
            boolean result = false;
            publishProgress("progress");
            return result;
        }

        protected void onProgressUpdate(String... progress) {
            StringBuilder str = new StringBuilder();
                for (int i = 1; i < progress.length; i++) {
                    str.append(progress[i] + " ");

                }
        }

            @Override
        protected void onPostExecute(Boolean result) {
            super.onPostExecute(result);
            checkLoginData();
          }
    }

  public void checkLoginData(){

      Intent register = new Intent(getApplicationContext(), LoginForm.class);
      startActivity(register);

  }         

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:00:52.607

做

```
 ConnectivityManager cm = (ConnectivityManager) mContext.getSystemService(Context.CONNECTIVITY_SERVICE); 
```

上下文可以使用该方法`getSystemService()`，但您的类不是上下文，您需要使用您的`mContext`变量。

这意味着您也可以替换`getApplicationContext()`为`mContext`. 如果你*真的*需要`getApplicationContext()`（不太可能 - 正常的上下文应该可以正常工作），使用

```
mContext.getApplicationContext() 
```

此外，您将您的`isOnline()`方法声明为静态，但随后您需要使用 Context 来检查和制作 toast。要么不要让它成为静态的*，要么*改变它以便它在上下文中接受，例如

```
public final static boolean isOnline (Context someContext){ 
```

并将需要 Context 的调用替换为`someContext`. 静态方法不需要类的实例，因此不能使用`mContext`. 一旦你解决了`getApplicationContext()`你现在遇到的问题，编译器应该抛出一个关于以静态方式访问非静态字段的错误。和你的一样`checkInternet()`。我建议您重新评估您的逻辑，您的类存在多个问题 - 我建议将所有内容都设置为在 Context 中接受的静态方法，该方法将由调用 Activity 给出。

最后要小心在全局非 UI 类中显示 Toast 和其他 UI 元素。Toast 应该没问题，因为它们在窗口顶部运行，但是 Dialog 将需要一个窗口，如果`mContext`不是 的实例`Activity`，则将失败（活动有一个窗口，其他上下文（如`getApplicationContext()`）没有。

# python - django 应用程序文件结构的约定是什么

> ID：14489263
> 
> 赞同：0
> 
> 时间：2013-01-23T20:58:52.240
> 
> 标签：python, django

到目前为止，我已经看到了两种结构，但不确定哪个被认为是约定：

*   [应用程序]
    *   静止的
    *   媒体

或者

*   [应用程序]
    *   静止的
        *   媒体

在 Django 中放置媒体文件的正确位置在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:12:33.820

检查此处描述的结构[http://www.deploydjango.com/django_project_structure/index.html](http://www.deploydjango.com/django_project_structure/index.html)

# python - 识别列表列表中具有 3 个共同元素的列表

> ID：14489266
> 
> 赞同：1
> 
> 时间：2013-01-23T20:59:03.067
> 
> 标签：python

我有一个列表列表。如果存在具有前三个共同元素的子列表，则将它们合并到一个列表中并添加所有第四个元素。

这个问题最好用代码和所需的输出来解释。

```
a_list = [['apple', 50, 60, 7],
          ['orange', 70, 50, 8],
          ['apple', 50, 60, 12]]

# output:
# [['apple', 50, 60, 19], ['orange', 70, 50, 8]] 
```

我已经有类似问题的代码（前段时间由 Stack Overflow 中的另一个用户给我），但我不完全理解它，所以我无法相应地修改它。这段代码的作用是检查第 0 个和第 2 个元素是否相同，如果相同，则合并子列表，添加第 1 个和第 3 个元素：

```
import defaultdict
data = [['42x120x1800', 50, '50x90x800', 60],
        ['42x120x1800', 8, '50x90x800', 10],
        ['2x10x800', 5, '5x9x80', 6]]

d = defaultdict(lambda :[0, 0])
for sub_list in data:
    key = (sub_list[0], sub_list[2])
    d[key][0] += sub_list[1]
    d[key][1] += sub_list[3]

new_data = [[key[0], val[0], key[1], val[1]] for key, val in d.iteritems()]
# [['2x10x800', 5, '5x9x80', 6], ['42x120x1800', 58, '50x90x800', 70]] 
```

应该如何修改代码以适应我的新问题？如果您也能花时间彻底解释代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:05:28.223

您可以使用相同的原则，通过使用前三个元素作为键，并使用`int`作为默认值工厂`defaultdict`（所以你得到`0`作为初始值）：

```
from collections import defaultdict

a_list = [['apple', 50, 60, 7],
          ['orange', 70, 50, 8],
          ['apple', 50, 60, 12]]

d = defaultdict(int)
for sub_list in a_list:
    key = tuple(sub_list[:3])
    d[key] += sub_list[-1]

new_data = [list(k) + [v] for k, v in d.iteritems()] 
```

如果您使用的是 Python 3，则可以将其简化为：

```
d = defaultdict(int)
for *key, v in a_list:
    d[tuple(key)] += v

new_data = [list(k) + [v] for k, v in d.items()] 
```

因为您可以使用加[星标的目标](http://docs.python.org/3/reference/simple_stmts.html#assignment-statements)从列表中获取所有“剩余”值，所以每个子列表主要分配给`key`，最后一个值分配给，使循环更简单（并且在 dict 中`v`没有方法`.iteritems()`Python 3，因为`.items()`它已经是一个迭代器）。

因此，我们使用 a`defaultdict`作为`0`默认值，然后对于从前 3 个值生成的每个键（作为元组，因此您可以将其用作字典键）对最后一个值求和。

*   因此，对于第一项`['apple', 50, 60, 7]`我们创建一个 key `('apple', 50, 60)`，查找它`d`（它不存在，但`defaultdict`随后将`int()`用于创建 的新值`0`），并`7`从第一项添加。

*   `('orange', 70, 50)`对key 和 value做同样的事情`8`。

*   对于第三项，我们`('apple', 50, 60)`再次获得密钥并添加`12`到预先存在`7`的`d[('apple', 50, 60)]`. 总共19个。

然后我们将（键，值）对转换回列表，您就完成了。这导致：

```
>>> new_data
[['apple', 50, 60, 19], ['orange', 70, 50, 8]] 
```

需要对数据进行排序的替代实现使用`itertools.groupby`：

```
from itertools import groupby
from operator import itemgetter

a_list = [['apple', 50, 60, 7],
          ['orange', 70, 50, 8],
          ['apple', 50, 60, 12]]

newlist = [list(key) + [sum(i[-1] for i in sublists)] 
    for key, sublists in groupby(sorted(a_list), key=itemgetter(0, 1, 2))] 
```

对于相同的输出。如果您的数据未排序，这会变慢，但了解不同的方法是件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:05:10.567

我会做这样的事情：

```
>>> a_list = [['apple', 50, 60, 7],
...           ['orange', 70, 50, 8],
...           ['apple', 50, 60, 12]]
>>> 
>>> from collections import defaultdict
>>> d = defaultdict(list)
>>> from operator import itemgetter
>>> getter = itemgetter(0,1,2)
>>> for lst in a_list:
...     d[getter(lst)].extend(lst[3:])
... 
>>> d
defaultdict(<type 'list'>, {('apple', 50, 60): [7, 12], ('orange', 70, 50): [8]})
>>> print [list(k)+v for k,v in d.items()]
[['apple', 50, 60, 7, 12], ['orange', 70, 50, 8]] 
```

然而，这并没有给出总和。它可以通过以下方式轻松修复：

```
print [list(k)+[sum(v)] for k,v in d.items()] 
```

没有太多理由比 Martijn 更优雅的解决方案更喜欢这个，除了它允许用户有一个包含超过 4 个项目的输入列表（后面的元素按预期求和）。换句话说，这将通过列表：

```
a_list = [['apple', 50, 60, 7, 12],
          ['orange', 70, 50, 8]] 
```

也是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:03:46.980

形成密钥，`[:3]`以便获得前 3 个元素。

# ruby - 任何人都知道我如何在rails中做一个“if”？

> ID：14489268
> 
> 赞同：-4
> 
> 时间：2013-01-23T20:59:10.617
> 
> 标签：ruby

我一直在开发一个小型应用程序，并且在创建新帖子时的某个时候，我希望我的应用程序检查数据库中的某些文本值，特别是寻找“已完成”。

到目前为止，我想出了这个；

```
@job = current_user.Jobs.where(:all, :project_status => "completed")
if @job.exists?
   do something
else
   send an error
end 
```

这是完全错误的，在阅读了一些内容并通过几个例子之后，我认为下面的内容是一样的；

```
@job = current_user.Jobs.exists?(:conditions = {:project_status => "completed"}) 
```

但是我在我的研究中没有找到一个例子，上面的行进入“如果”条件，我只是这样做吗？

```
@job = current_user.Jobs.exists?(:conditions = {:project_status => "completed"})
     if @job
        do something here
     else
        do something else here
     end 
```

那会更短，更清洁，更正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:02:17.097

```
if @job.project_status.include?("completed")
 #something here 
else
 #nothing
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:12:21.270

我不确定该列中是否还有其他内容。包含可能不如评估字符串快。

```
if @job.project_status == 'completed'
 #something here 
end 
```

这最终可能比包含更快？如果什么都不会发生，你也不需要 else 。

# xml - 从 R 中的字符向量创建数据框

> ID：14489270
> 
> 赞同：0
> 
> 时间：2013-01-23T20:59:12.457
> 
> 标签：xml, regex, r, stringr

我有一些文本形式的数据，取自网页。它很长，但遵循以下形式：

```
<p><span class="monthyear">Jan 2001</span>
<br><b>Foo text (2)</b></p>
<p><span class="monthyear">Nov 2006</span>
<br><b>Bar text (29)</b>
<br><b>More bar text (4)</b>
<br><b>Yet more bar text (102)</b></p>
<p><span class="monthyear">Apr 2004</span>
<br><b>Further foo text (1)</b>
<br><b>Combination foo and bar text (41)</b></p> 
```

我想将其相关部分提取到数据框中，如下所示：

```
 monthyear          info  n
1  Jan 2001      Foo text  2
2  Nov 2006      Bar text 29
3  Nov 2006 More bar text  4 
```

...但我不知道该怎么做。如果我在一个名为 text 的字符向量中有 html，我可以使用**stringr**包中的函数提取月份数据：

```
monthyear <- str_extract_all(
text[1],perl("(?<=\\\"monthyear\\\">).*?20[0-9]{2}")
) 
```

我可以以相同的方式提取**信息**和**n数据，但鉴于****每个月年条目有多个****信息**和**n**条目，我不知道如何组合它们。我对这一切都错了吗？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T07:50:37.857

不幸的是，我们无法始终控制数据源的质量，因此我们不得不求助于一些繁琐的手动处理。（有人说数据分析师的大部分时间都花在清理数据上，而不是分析上。）

正如评论中已经指出的那样，正则表达式并不是处理 HTML 的最佳工具，因为 HTML 通常不是真正的*常规*语言（我认为它被称为无*上下文语言*）。但是，如果 HTML 源代码有些*规则*（就像您提供的示例数据中那样），您仍然可以有效地使用它们。

这是一个分步示例。我已将 HTML 标题标签添加到您的示例文本中并将其存储在此处：http: [//ideone.com/O1PC05](http://ideone.com/O1PC05)

1.  使用读入您的数据`readLines`

    ```
    x1 <- readLines("http://ideone.com/plain/O1PC05") 
    ```

2.  隔离网页的“正文”

    ```
    bodycontent <- grep("<body>|</body>", x1)
    x2 <- x1[(bodycontent[1]+1):(bodycontent[2]-1)] 
    ```

3.  `grepl`如果在给定的行中找到“monthyear”，则返回 a`TRUE`或for。`FALSE`用于`cumsum`创建“组”，`split`并将字符向量转换为列表。

    ```
    x3 <- split(x2, cumsum(grepl("monthyear", x2))) 
    ```

4.  如果您愿意，可以分多个步骤执行以下操作。基本思想是`lapply`覆盖您的列表，用制表符替换所有 HTML 标记，并用制表符替换括号。之后，您可以使用，但由于我们插入的选项卡比我们需要的多得多`read.delim`，因此期望得到很多包含值的列。`NA`

    由于多种原因，这很可能是您失败的地方。(1) 它假定源数据确实结构良好...... (2) 但是，文本本身可能有括号...... (3) 或者，正文中可能有其他内容，包括脚本标签、表格标签，依此类推，将被读入并尝试处理。

    ```
    x4 <- read.delim(header = FALSE,
                     stringsAsFactors = FALSE,
                     strip.white = TRUE, 
                     sep = "\t", 
                     text = 
                       unlist(lapply(x3, 
                                     function(x) {
                                       temp <- gsub("<(.|\n)*?>", "\t", x)
                                       paste(gsub("[()]", "\t", temp), 
                                             collapse="\t")
                                       }))) 
    ```

5.  我提到在第 4 步中，我们最终会得到很多垃圾列。让我们摆脱那些。

    ```
    x5 <- x4[apply(x4, 2, function(x) !all(is.na(x)))] 
    ```

6.  现在，让我们以更有意义的方式命名列。我们知道第一列是设计的“monthyear”变量，其他的*应该*是“info”和“n”，所以我们可以做一些基本`rep`的s`paste`来获取我们的变量名。当我们使用它时，我们将使用`as.yearmon`“zoo”包将我们的“monyear”变量转换为实际日期，从而允许我们对实际日期进行排序和做其他漂亮的事情。

    ```
    myseq <- ncol(x5[-1])/2 # We expect pairs of columns, right?
    names(x5) <- c("monthyear", 
                   paste(rep(c("info", "n"), myseq), 
                         sep(1:myseq, each = 2), sep = "."))
    library(zoo)
    x5$monthyear <- as.Date(as.yearmon(x5$monthyear, "%b %Y"))
    x5
    #    monthyear           info.1 n.1                       info.2 n.2            info.3 n.3
    # 1 2001-01-01         Foo text   2                               NA                    NA
    # 2 2006-11-01         Bar text  29                More bar text   4 Yet more bar text 102
    # 3 2004-04-01 Further foo text   1 Combination foo and bar text  41                    NA 
    ```

7.  如果您真的想要长格式的数据，请使用`reshape`：

    ```
    x6 <- reshape(x5, 
                  direction = "long", 
                  idvar = "monthyear", 
                  varying = 2:ncol(x5)) 
    ```

8.  进行一些可选的清理，例如按日期排序输出、重置行名和删除不完整的案例：

    ```
    x6 <- x6[order(x6$monthyear), ]
    rownames(x6) <- NULL
    x6[complete.cases(x6), ]
    #    monthyear time                         info   n
    # 1 2001-01-01    1                     Foo text   2
    # 4 2004-04-01    1             Further foo text   1
    # 5 2004-04-01    2 Combination foo and bar text  41
    # 7 2006-11-01    1                     Bar text  29
    # 8 2006-11-01    2                More bar text   4
    # 9 2006-11-01    3            Yet more bar text 102 
    ```

无论如何，尝试一下，并根据需要进行修改。我的猜测是，在某些时候，您必须在纯文本编辑器中打开文件并在那里进行一些初步清理，然后才能继续。**

# openam - 在环境之间传输 openAM 9 配置

> ID：14489271
> 
> 赞同：1
> 
> 时间：2013-01-23T20:59:13.213
> 
> 标签：openam

我试图找到在不同环境之间传输配置文件的最不痛苦的方式，并且我发现了许多在传输后会破坏系统的东西。我得到了一个脚本，它将保持属性值对于依赖于环境的属性值正确，但这里列出了一些我不确定的事情。也许有人可以对他们有所了解。

我想要做的是简单地根据openAM 9书中的步骤传输xml文件（只需使用ssoadm导出/导入到xml文件），但通过深入分析文件，我发现许多可能会破坏系统的差异，所以任何帮助表示赞赏。

1.  在每个 xml 文件中，我们都有针对 'iplanet-am-auth-ldap-bind-passwd' 的部分，其下带有哈希值，但在一个 xml 文件中，我们缺少一行带有哈希值。我想知道如果我们用正确的哈希值添加那行会破坏系统还是只要哈希匹配目标环境就没有关系？

2.  'iplanet-am-logging-buffer-size' 的大小是否必须与目标环境中最初设置的大小相匹配，或者如果我们覆盖源 xml 文件中的值就可以了？

3.  出于某种原因，我们在具有相同名称的委托规则中有不同的链接，例如：

    ```
    # environment1 - sms://dc=test-domain,dc=net/sunEntitlementService/1.0/application/ws/1/entitlement/entitlements

    # environment2 - sms://dc=test-domain,dc=net/sunEntitlementService/1.0/application/ws/1/entitlement/decision

    # environment3  - sms://*dc=test-domain,dc=net/sunIdentityRepositoryService/1.0/application/agent 
    ```

这可能是由于很久以前设置服务器的方式或由于随着时间的推移而开发的过程（我不知道），但我的问题是：

如果规则名称相同但环境之间的某些（或全部）选项/值不同，并且我们用来自不同环境的源文件覆盖它们，这会破坏事情还是无关紧要？

# php - 蛋糕php包含在包含

> ID：14489274
> 
> 赞同：3
> 
> 时间：2013-01-23T20:59:23.660
> 
> 标签：php, cakephp, model, database-relations

我正在为我的项目使用 CakePHP... 为了加快我的代码速度，我只想获得一些与我的实际对象相关的模型：

```
$result = $this->Category->find(
                'first',
                array(
                    'conditions' => array(
                        'Category.folder' => $path[0]
                    ),
                    'contain' => array('Rubric',
                        'conditions' => array('Rubric.category_id' => 'Category.id'),
                        'contain' => array('Subrubric',
                            'conditions' => array('Subrubric.rubric_id' => 'Rubric.id')
                        )
                    )
                )
            ); 
```

path[0] 是来自 url 的参数...

找到了类别和量规，但没有找到子量规。还有一些与我的对象相关的条目，但我希望它们出现在我的 rubric 视图中，而不是类别视图中。

模型关系：

类别：

```
public $hasMany = array(
        'Rubric' => array(
            'className' => 'Rubric',
            'foreignKey' => 'category_id',
            'dependent' => false,
            'conditions' => '',
            'fields' => '',
            'order' => 'title',
            'limit' => '',
            'offset' => '',
            'exclusive' => '',
            'finderQuery' => '',
            'counterQuery' => ''
        )
    ); 
```

专栏：

```
public $hasMany = array(
    'Entrieslocation' => array(
        'className' => 'Entrieslocation',
        'foreignKey' => 'rubric_id',
        'dependent' => false,
        'conditions' => '',
        'fields' => '',
        'order' => '',
        'limit' => '',
        'offset' => '',
        'exclusive' => '',
        'finderQuery' => '',
        'counterQuery' => ''
    ),
    'Subrubric' => array(
        'className' => 'Subrubric',
        'foreignKey' => 'rubric_id',
        'dependent' => false,
        'conditions' => '',
        'fields' => '',
        'order' => '',
        'limit' => '',
        'offset' => '',
        'exclusive' => '',
        'finderQuery' => '',
        'counterQuery' => ''
    )
); 
```

在这里，我不想要入口位置...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:22:53.173

看到这个：[包含更深层次的关联](http://book.cakephp.org/1.3/en/The-Manual/Core-Behaviors/Containable.html)

您不应该在更深层次的关系中使用节点“包含”。您的代码应如下所示。

```
 $result = $this->Category->find(
            'first',
            array(
                'conditions' => array(
                    'Category.folder' => $path[0]
                ),
                'contain' => array('Rubric',
                    'conditions' => array('Rubric.category_id' => 'Category.id'),
                    'Subrubric' => array(
                        'conditions' => array('Subrubric.rubric_id' => 'Rubric.id')
                    )
                )
            )
        ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T05:40:49.880

您还可以使用另一种选择。

```
$this->ModelName->unbindModel(array
(
    'hasMany' => array
    (
        'OtherModel'
    )
));

$this->ModelName->bindModel(array
(
    'belongsTo' => array
    (
        'SomeOtherModel' => array
        (
            'foreignKey' => false,
            'conditions' => array
            (
                'ModelName.id = SomeOtherModel.foreignKey'
            )
        )
    )
));
```

# java - 在颠覆项目结构中寻找正确处理配置和数据库模式文件

> ID：14489287
> 
> 赞同：2
> 
> 时间：2013-01-23T21:00:20.180
> 
> 标签：java, database, svn, maven, database-migration

在 SVN 中，我们有一个项目，该项目具有使用休眠等的所有数据库逻辑。但是，该项目取决于处于与代码匹配的特定状态的数据库模式。

同样，我们还将在 Config 目录中运行用于服务器的配置脚本。

如何在 SVN 中正确设置项目结构来克服这一点？

结构可能是这样的：

```
--DBHibernateProject
------trunk
------branches
------tags
--DatabaseScriptsProject
------trunk
------branches
------tags
--ConfigProject
------trunk
------branches
------tags 
```

但是我们如何将数据库脚本项目绑定到 DBHibernateProject 的 Release-1.0 呢？hibernate 项目在 maven 存储库中有一个可部署的资产（jar），但 db 脚本没有。我想确保正确的数据库脚本与应用程序的正确版本相关联。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T05:37:27.077

如果“项目依赖于...”意味着“对于 DBHibernateProject 的每个修订版，我们必须使用 DatabaseScriptsProject 和 ConfigProject 的预定义和固定修订版（它们在 DBHibernateProject 树中使用/引用）”您始终可以使用纯 Subversion 端解决方案：带有 PEG 修订的外部

没有关于源树结构的知识就不能说更多：“依赖”和“也有配置脚本”不能翻译（容易）成正式的依赖，比如（我糟糕的重建）

> DBHibernateProject 的每个修订版都**必须具有相关的** *DatabaseScriptsProject*（用于此代码的正确架构）和 *ConfigProject*（用于生成数据库架构的脚本，由 DBHibernateProject 使用）

如果我的重建是正确的，在 Subversion 样式中（没有 Maven，这可能是我的错误）我将在 DBHibernateProject 树中创建两个目录类型的外部对象，它们分别引用 DatabaseScriptsProject 和 ConfigProject 树中的“某种状态下的某些树”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:08:55.403

您要么通过流程完成，要么制作一个 SVN 项目。

您可以为团队制定一条规则，当您完成一组数据库内容时，您使用与它所使用的代码的标签相同的标签对其进行标记。这可能很乏味，但如果更改通常在数据库和代码之间同步，则这是可行的。

另一种方法是在 SVN 中创建一个带有一个主干和一组标签和分支的项目。然后，您可以通过在存储库的顶层放置一些包含代码、脚本和休眠内容的文件夹来完成同样的事情。可以管理您的 SVN 存储库的权限，以便不同的人对特定文件夹具有写入权限，但这会产生每次分支时不断修改权限的成本（如果您愚蠢地允许修改标签，可能还会添加标签）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-28T00:06:58.493

1.  将我所有的 SQL 脚本保存在 SVN 中
2.  不允许修改它们（如果要更改某些内容，请创建包含正确 SQL 语句的新 SQL 文件）
3.  配置**maven dbpatch 插件** [https://github.com/m-szalik/dbpatch-maven-plugin](https://github.com/m-szalik/dbpatch-maven-plugin)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T15:12:44.463

难道你不能有一个看起来像这样的数据库项目的单一项目布局：

```
----DatabaseProject
-------trunk
--------DBHibernateProject
--------DatabaseScriptsProject
-------branches
-------tags

----OtherProject
-------trunk
-------branches
-------tags

----ConfigProject
-------trunk
-------branches
-------tags 
```

如果配置项目不与其他项目绑定，而只是服务器的脚本，那么我猜你可以将它作为与 OtherProject 相同的布局。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T23:54:10.537

我强烈建议使用[liquibase](http://www.liquibase.org/)来管理您的数据库迁移。更改文件是从类路径中读取的，这意味着它们可以与匹配的 Hibernate 类文件一起部署在同一个 jar 中。

我从未使用过它，但 liquibase 确实有一些对[休眠](http://www.liquibase.org/manual/hibernate)的支持，这可能会被证明是有用的。

有关 Maven 示例，请参见：

*   [在运行删除/加载数据脚本之前锁定 oracle 数据库](https://stackoverflow.com/questions/10794169/lock-oracle-database-before-running-the-delete-load-data-scripts/10804663#10804663)

对于一些更多的理论阅读，我建议：

*   [http://martinfowler.com/articles/evodb.html](http://martinfowler.com/articles/evodb.html)
*   [http://www.codinghorror.com/blog/2008/02/get-your-database-under-version-control.html](http://www.codinghorror.com/blog/2008/02/get-your-database-under-version-control.html)

为了公平起见，在同一功能空间中还有一些其他工具：

*   [http://flywaydb.org/](http://flywaydb.org/)
*   [http://code.google.com/p/dbmigrate/](http://code.google.com/p/dbmigrate/)

# inno-setup - 如果 WizardForm.NextButton 被禁用，我如何调用下一步执行？

> ID：14489292
> 
> 赞同：0
> 
> 时间：2013-01-23T21:00:40.670
> 
> 标签：inno-setup

我创建了自己的“下一步”按钮。因此，我需要模拟原始的“下一步”按钮单击以继续执行其他安装程序步骤。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-15T11:56:11.793

```
Wizardform.NextButton.OnClick(nil) 
```

# iphone - 签到位置服务已启用

> ID：14489298
> 
> 赞同：0
> 
> 时间：2013-01-23T21:01:06.720
> 
> 标签：iphone, ios, location

我试图弄清楚如何检测位置服务是否处于活动状态并搜索用户位置。这是为了创建一个位置切换按钮。

当应用程序启动时，它使用以下方式打开位置服务：

```
[locationController.locationManager startMonitoringSignificantLocationChanges]; 
```

然后我有一个按钮，我想执行以下操作：

```
if (location.services active) {
    //turn off LS
} else {
    // turn on
} 
```

这不是关于 locationServicesEnabled 的问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:10:48.913

据我所知，定位服务是一种系统服务，可以同时被多个应用程序使用。因此，当您使用它时，您在访问它之前不知道它是打开还是关闭。操作系统将根据使用情况将其打开或关闭，您对它的状态一无所知。

# php - 在 nginx 上设置 php 站点

> ID：14489303
> 
> 赞同：0
> 
> 时间：2013-01-23T21:01:25.377
> 
> 标签：php, nginx, yii

我正在尝试设置 nginx 服务器来运行 Yii 应用程序。我使用 yiic 命令创建了一个 bootsrap yii 应用程序，该文件夹当前位于 /usr/share/nginx/www 中。该文件夹称为 mysite。我已经设法在 /etc/nginx/sites-available/default 中使用以下配置运行它

```
 # You may add here your
# server {
#   ...
# }
# statements for each of your virtual hosts to this file

##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# http://wiki.nginx.org/Pitfalls
# http://wiki.nginx.org/QuickStart
# http://wiki.nginx.org/Configuration
#
# Generally, you will want to move this file somewhere, and start with a clean
# file but keep this around for reference. Or just disable in sites-enabled.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

server {
    set $host_path "/usr/share/nginx/";
    access_log  /usr/share/nginx/www/log/access.log;

    server_name  diabcalc;
    root   $host_path/www;
    set $yii_bootstrap "index.php";

    charset utf-8;

    location / {
        index  index.html $yii_bootstrap;
        try_files $uri $uri/ /$yii_bootstrap?$args;
    }

    location ~ ^/(protected|framework|themes/\w+/views) {
        deny  all;
    }

    #avoid processing of calls to unexisting static files by yii
    location ~ \.(js|css|png|jpg|gif|swf|ico|pdf|mov|fla|zip|rar)$ {
        try_files $uri =404;
    }

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    location ~ \.php {
        fastcgi_split_path_info  ^(.+\.php)(.*)$;

        #let yii catch the calls to unexising PHP files
        set $fsn /$yii_bootstrap;
        if (-f $document_root$fastcgi_script_name){
            set $fsn $fastcgi_script_name;
        }

        fastcgi_pass   127.0.0.1:9000;
        include fastcgi_params;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fsn;

        #PATH_INFO and PATH_TRANSLATED can be omitted, but RFC 3875 specifies them for CGI
        fastcgi_param  PATH_INFO        $fastcgi_path_info;
        fastcgi_param  PATH_TRANSLATED  $document_root$fsn;
    }

    location ~ /\.ht {
        deny  all;
    }
}

server {
       listen 80;
       server_name phpmyadmin;
       root /usr/share/nginx/www/;

       index index.php index.html;
       location = /favicon.ico {
                log_not_found off;
                access_log off;
       }
       location = /robots.txt {
                allow all;
                log_not_found off;
                access_log off;
       }
       # Make sure files with the following extensions do not get loaded by nginx because nginx would display the source code, and these files can contain PASSWORDS!
        location ~* \.(engine|inc|info|install|make|module|profile|test|po|sh|.*sql|theme|tpl(\.php)?|xtmpl)$|^(\..*|Entries.*|Repository|Root|Tag|Template)$|\.php_ {
                deny all;
        }
       # Deny all attempts to access hidden files such as .htaccess, .htpasswd, .DS_Store (Mac).
       location ~ /\. {
                deny all;
                access_log off;
                log_not_found off;
       }
       location ~*  \.(jpg|jpeg|png|gif|css|js|ico)$ {
                expires max;
                log_not_found off;
       }
       location ~ \.php$ {
                try_files $uri =404;
                include /etc/nginx/fastcgi_params;
                fastcgi_pass 127.0.0.1:9000;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
       }
}

# another virtual host using mix of IP-, name-, and port-based configuration
#
#server {
#   listen 8000;
#   listen somename:8080;
#   server_name somename alias another.alias;
#   root html;
#   index index.html index.htm;
#
#   location / {
#       try_files $uri $uri/ =404;
#   }
#}

# HTTPS server
#
#server {
#   listen 443;
#   server_name localhost;
#
#   root html;
#   index index.html index.htm;
#
#   ssl on;
#   ssl_certificate cert.pem;
#   ssl_certificate_key cert.key;
#
#   ssl_session_timeout 5m;
#
#   ssl_protocols SSLv3 TLSv1;
#   ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv3:+EXP;
#   ssl_prefer_server_ciphers on;
#
#   location / {
#       try_files $uri $uri/ =404;
#   }
#} 
```

我现在已将 phpmyadmin 复制到应用程序所在的同一个文件夹中，即 /usr/share/nginx/www。所以上面的文件夹中存在 mysite 和 phpadmin 这两个文件夹。但我无法显示 phpadmin，我不确定如何在 nginx 配置中进行设置。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:03:10.803

nginx 不会自己处理 PHP。您需要一些东西来代理 PHP 请求 - PHP-FPM 或 Apache 很常见。

# c# - 模型显示正确但返回 null

> ID：14489304
> 
> 赞同：0
> 
> 时间：2013-01-23T21:01:27.257
> 
> 标签：c#, asp.net-mvc-3, forms, razor

我使用强类型模型填充了部分视图。在这种局部视图中是一种形式。当我提交表单时，它告诉我模型内部的对象为空，即使它们不是因为部分视图基于同一模型渲染了所有元素。

更具体地说，我在传回所有复选框时遇到了麻烦。如果您查看我的控制器，您会看到我检查是否`CompanyOptions`为空，并且每次运行程序时它都会打印`STUFF IS NULL`，这意味着它是空的。

模型：

```
public class Company
{
    public string Name { get; set; }
    public string DatabaseName { get; set; }
    public CompanyOptions CompanyOptions;
}

 public class CompanyOptions
    {

        public CompanyLicenseOptions CompanyLicenseOptions { get; set; }
    }

 public class CompanyLicenseOptions
    {
        public List<CompanyLicenseOption> CompanyLicenseOptionsList;
} 
```

看法：

```
@using (Html.BeginForm("Action", FormMethod.Post))
{
    for (int i = 0; i < Model.CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList.Count; i++)
    {
        @Html.CheckBoxFor(model => model.CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[i].IsLicensed, checkboxHtmlAttributes);
        <label for="@Model.CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[i].LicenseName">@Model.CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[i].LicenseName</label>                                                                                       
        <br/>
    } 
    @Html.HiddenFor(model => model.DatabaseName)
    <input id="submit_licenses" type="submit" style="display:none;" />
} 
```

控制器：

```
 [HttpPost]
        public void Action(Company model)
        {
            System.Diagnostics.Debug.WriteLine("STUFF:" + model.DatabaseName);
            if(model.CompanyOptions!=null)foreach (var item in model.CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList) System.Diagnostics.Debug.WriteLine("STUFF:" + item);
            else System.Diagnostics.Debug.WriteLine("STUFF IS NULL");
        } 
```

生成的 HTML：

```
<input class="licenses" data-val="true" disabled="" id="CompanyOptions_CompanyLicenseOptions_CompanyLicenseOptionsList_0__IsLicensed" name="CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[0].IsLicensed" type="checkbox" value="true" /><input name="CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[0].IsLicensed" type="hidden" value="false" /> 
```

不相关的 JS

```
$('#save_licenses').click(function () {
        swap_licenses(true);
        $('#submit_licenses').click();
    }); 
```

邮政：

```
Request URL:http://localhost:3080/Controller/Action
Request Method:POST
Status Code:200 OK

CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[0].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[1].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[2].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[3].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[4].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[5].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[6].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[7].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[8].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[9].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[10].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[11].IsLicensed:false
    CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[12].IsLicensed:false
    DatabaseName:myDb 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:22:51.223

```
<input class="licenses" data-val="true" disabled="" id="CompanyOptions_CompanyLicenseOptions_CompanyLicenseOptionsList_0__IsLicensed" name="CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[0].IsLicensed" type="checkbox" value="true" /><input name="CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList[0].IsLicensed" type="hidden" value="false" /> 
```

这是你的问题：

```
disabled="" 
```

您的复选框是`disabled`，因此不会将任何内容发送到服务器。这就是 HTML 的工作原理。禁用的元素永远不会被发送。所以去掉这个属性。

如果您想阻止用户修改值，但初始值被发送到服务器，请使用`readonly`属性，而不是`disabled`.

我在您的代码中看到的另一个问题是`CompanyLicenseOptionsList`集合字段。它应该是具有公共 getter 和 setter 的属性：

```
public class CompanyLicenseOptions
{
    public List<CompanyLicenseOption> CompanyLicenseOptionsList { get; set; }
} 
```

您的`CompanyOptions`字段也是如此（您已将其定义为字段，而它应该是属性）：

```
public class Company
{
    public string Name { get; set; }
    public string DatabaseName { get; set; }
    public CompanyOptions CompanyOptions { get; set; }
} 
```

* * *

更新：

现在您已经解决了缺少 getter 和 setter 的问题，剩下的就是确保干预此对象图中的所有模型都具有默认（无参数）构造函数。如果您希望它们显示为动作参数，这是一个要求，因为否则默认模型绑定器将不知道如何实例化它们。如果由于某种原因您无法为所有对象添加默认构造函数，我强烈建议您修改对象层次结构并立即开始使用视图模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:14:29.243

您应该使用 foreach 循环而不是简单的 for，这样：

```
@using (Html.BeginForm("Action", FormMethod.Post))
{
    foreach (var option in Model.CompanyOptions.CompanyLicenseOptions.CompanyLicenseOptionsList)
    {
        @Html.CheckBoxFor(o => o.IsLicensed, checkboxHtmlAttributes);
        <label for="@option.LicenseName">@option.LicenseName</label>                                                                                       
        <br/>
    } 
    @Html.HiddenFor(model => model.DatabaseName)
    <input id="submit_licenses" type="submit" style="display:none;" />
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T21:40:32.530

由于所有这些复选框的端点都是 a `List<T>`，因此您需要确保在使用之前对其进行实例化：

```
public class CompanyOptions
{
    public CompanyLicenseOptions CompanyLicenseOptions { get; set; }
}
public class CompanyLicenseOptions
{
    public List<CompanyLicenseOption> CompanyLicenseOptionsList;
    public CompanyLicenseOptions() 
    {
         CompanyLicenseOptionsList = new List<CompanyLicenseOption>();
    }
} 
```

编辑：为确保读者获得此答案的正确上下文并避免混淆，我复制了我上面的 OP 代码。

# java - 参数 JAXBElement 字符串

> ID：14489306
> 
> 赞同：14
> 
> 时间：2013-01-23T21:01:33.050
> 
> 标签：java, jaxb, annotations

我有关于 JAXB 的简单问题。这是示例代码：

```
 //setter that has input JAXBElement
   b.setBIC(JAXBElement<String> value); 
```

如何初始化使用来自其他对象的字符串的输入元素？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-23T21:04:18.780

您可以直接创建一个实例，或者如果您从 XML 模式生成 Java 模型，则在生成的类`JAXBElement`上使用方便的方法。`ObjectFactory`

```
package org.example.schema;

import javax.xml.bind.*;
import javax.xml.namespace.QName;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance("org.example.schema");

        Root root = new Root();

        QName fooQName = new QName("http://www.example.org/schema", "foo");
        JAXBElement<String> fooValue = new JAXBElement<String>(fooQName, String.class, "FOO");
        root.setFoo(fooValue);

        ObjectFactory objectFactory = new ObjectFactory();
        JAXBElement<String> barValue = objectFactory.createRootBar("BAR");
        root.setBar(barValue);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(root, System.out);
    }

} 
```

**架构.xsd**

上面的演示代码基于从以下 XML 模式生成的 Java 模型。首先获得`JAXBElement<String>`属性的原因是当您拥有一个既是`nillable="true"`and的元素时`minOccurs="0"`。

```
<?xml version="1.0" encoding="UTF-8"?>
<schema 
    xmlns="http://www.w3.org/2001/XMLSchema" 
    targetNamespace="http://www.example.org/schema" 
    xmlns:tns="http://www.example.org/schema" 
    elementFormDefault="qualified">
    <element name="root">
        <complexType>
            <sequence>
                <element name="foo" type="string" minOccurs="0" nillable="true"/>
                <element name="bar" type="string" minOccurs="0" nillable="true"/>
            </sequence>
        </complexType>
    </element>
</schema> 
```

**根**

以下类是从`schema.xsd`您的问题中生成的并包含类似的属性。

```
package org.example.schema;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = {"foo","bar"})
@XmlRootElement(name = "root")
public class Root {

    @XmlElementRef(name = "foo", namespace = "http://www.example.org/schema", type = JAXBElement.class)
    protected JAXBElement<String> foo;
    @XmlElementRef(name = "bar", namespace = "http://www.example.org/schema", type = JAXBElement.class)
    protected JAXBElement<String> bar;

    public JAXBElement<String> getFoo() {
        return foo;
    }

    public void setFoo(JAXBElement<String> value) {
        this.foo = value;
    }

    public JAXBElement<String> getBar() {
        return bar;
    }

    public void setBar(JAXBElement<String> value) {
        this.bar = value;
    }

} 
```

**对象工厂**

下面是生成的`ObjectFactory`类，其中包含用于创建`JAXBElement`.

```
package org.example.schema;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;
import javax.xml.namespace.QName;

@XmlRegistry
public class ObjectFactory {

    private final static QName _RootFoo_QNAME = new QName("http://www.example.org/schema", "foo");
    private final static QName _RootBar_QNAME = new QName("http://www.example.org/schema", "bar");

    public Root createRoot() {
        return new Root();
    }

    @XmlElementDecl(namespace = "http://www.example.org/schema", name = "foo", scope = Root.class)
    public JAXBElement<String> createRootFoo(String value) {
        return new JAXBElement<String>(_RootFoo_QNAME, String.class, Root.class, value);
    }

    @XmlElementDecl(namespace = "http://www.example.org/schema", name = "bar", scope = Root.class)
    public JAXBElement<String> createRootBar(String value) {
        return new JAXBElement<String>(_RootBar_QNAME, String.class, Root.class, value);
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-05T09:53:41.773

我们可以执行以下操作来创建 JAXBElement 对象： 仅针对可能遇到此问题的其他人，例如给出的示例 b.setBIC(JAXBElement value); 让我们假设您的类是 ClassB 并且对象是 b。

```
b.setBIC(new JAXBElement(new QName(ClassB.class.getSimpleName()), ClassB.class, "StringToBeInitialized")); 
```

# python - 在动词/名词/形容词形式之间转换单词

> ID：14489309
> 
> 赞同：33
> 
> 时间：2013-01-23T21:01:47.687
> 
> 标签：python, nlp, nltk, wordnet

我想要一个可以跨不同词性翻译/转换的python库函数。有时它应该输出多个单词（例如“coder”和“code”都是动词“to code”的名词，一个是主语，另一个是宾语）

```
# :: String => List of String
print verbify('writer') # => ['write']
print nounize('written') # => ['writer']
print adjectivate('write') # => ['written'] 
```

我主要关心动词<=>名词，用于我想写的笔记程序。即我可以写“咖啡因拮抗 A1”或“咖啡因是 A1 拮抗剂”，并且通过一些 NLP 它可以找出它们的意思相同。（我知道这并不容易，它需要 NLP 来解析而不只是标记，但我想破解一个原型）。

类似的问题...... [将形容词和副词转换为名词形式](https://stackoverflow.com/questions/7548479/converting-adjectives-and-adverbs-to-their-noun-forms) （这个答案只源于词根。我想在词性之间切换。）

ps 在语言学中称为转换[http://en.wikipedia.org/wiki/Conversion_%28linguistics%29](http://en.wikipedia.org/wiki/Conversion_%28linguistics%29)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-05-25T18:05:18.103

这更像是一种启发式方法。我刚刚对它进行了编码，因此很适合这种风格。它使用来自 wordnet 的 derivationally_related_forms()。我已经实施了名词化。我猜verify的工作方式类似。从我测试的结果来看，效果很好：

```
from nltk.corpus import wordnet as wn

def nounify(verb_word):
    """ Transform a verb to the closest noun: die -> death """
    verb_synsets = wn.synsets(verb_word, pos="v")

    # Word not found
    if not verb_synsets:
        return []

    # Get all verb lemmas of the word
    verb_lemmas = [l for s in verb_synsets \
                   for l in s.lemmas if s.name.split('.')[1] == 'v']

    # Get related forms
    derivationally_related_forms = [(l, l.derivationally_related_forms()) \
                                    for l in    verb_lemmas]

    # filter only the nouns
    related_noun_lemmas = [l for drf in derivationally_related_forms \
                           for l in drf[1] if l.synset.name.split('.')[1] == 'n']

    # Extract the words from the lemmas
    words = [l.name for l in related_noun_lemmas]
    len_words = len(words)

    # Build the result in the form of a list containing tuples (word, probability)
    result = [(w, float(words.count(w))/len_words) for w in set(words)]
    result.sort(key=lambda w: -w[1])

    # return all the possibilities sorted by probability
    return result 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-01-12T00:57:44.410

这是一个理论上能够在名词/动词/形容词/副词形式之间转换单词的函数，我从[这里](http://bogdani.webfactional.com/convert-words-between-verbnounadjectiveadverb-forms-using-wordnet/)更新（最初由[bogs](https://stackoverflow.com/users/1607029/bogs)编写，我相信）现在符合 nltk 3.2.5`synset.lemmas`并且`sysnset.name`是函数。

```
from nltk.corpus import wordnet as wn

# Just to make it a bit more readable
WN_NOUN = 'n'
WN_VERB = 'v'
WN_ADJECTIVE = 'a'
WN_ADJECTIVE_SATELLITE = 's'
WN_ADVERB = 'r'

def convert(word, from_pos, to_pos):    
    """ Transform words given from/to POS tags """

    synsets = wn.synsets(word, pos=from_pos)

    # Word not found
    if not synsets:
        return []

    # Get all lemmas of the word (consider 'a'and 's' equivalent)
    lemmas = []
    for s in synsets:
        for l in s.lemmas():
            if s.name().split('.')[1] == from_pos or from_pos in (WN_ADJECTIVE, WN_ADJECTIVE_SATELLITE) and s.name().split('.')[1] in (WN_ADJECTIVE, WN_ADJECTIVE_SATELLITE):
                lemmas += [l]

    # Get related forms
    derivationally_related_forms = [(l, l.derivationally_related_forms()) for l in lemmas]

    # filter only the desired pos (consider 'a' and 's' equivalent)
    related_noun_lemmas = []

    for drf in derivationally_related_forms:
        for l in drf[1]:
            if l.synset().name().split('.')[1] == to_pos or to_pos in (WN_ADJECTIVE, WN_ADJECTIVE_SATELLITE) and l.synset().name().split('.')[1] in (WN_ADJECTIVE, WN_ADJECTIVE_SATELLITE):
                related_noun_lemmas += [l]

    # Extract the words from the lemmas
    words = [l.name() for l in related_noun_lemmas]
    len_words = len(words)

    # Build the result in the form of a list containing tuples (word, probability)
    result = [(w, float(words.count(w)) / len_words) for w in set(words)]
    result.sort(key=lambda w:-w[1])

    # return all the possibilities sorted by probability
    return result

convert('direct', 'a', 'r')
convert('direct', 'a', 'n')
convert('quick', 'a', 'r')
convert('quickly', 'r', 'a')
convert('hunger', 'n', 'v')
convert('run', 'v', 'a')
convert('tired', 'a', 'r')
convert('tired', 'a', 'v')
convert('tired', 'a', 'n')
convert('tired', 'a', 's')
convert('wonder', 'v', 'n')
convert('wonder', 'n', 'a') 
```

正如您在下面看到的，它的效果不是很好。它无法在形容词和副词形式之间切换（我的具体目标），但在其他情况下它确实给出了一些有趣的结果。

```
>>> convert('direct', 'a', 'r')
[]
>>> convert('direct', 'a', 'n')
[('directness', 0.6666666666666666), ('line', 0.3333333333333333)]
>>> convert('quick', 'a', 'r')
[]
>>> convert('quickly', 'r', 'a')
[]
>>> convert('hunger', 'n', 'v')
[('hunger', 0.75), ('thirst', 0.25)]
>>> convert('run', 'v', 'a')
[('persistent', 0.16666666666666666), ('executive', 0.16666666666666666), ('operative', 0.16666666666666666), ('prevalent', 0.16666666666666666), ('meltable', 0.16666666666666666), ('operant', 0.16666666666666666)]
>>> convert('tired', 'a', 'r')
[]
>>> convert('tired', 'a', 'v')
[]
>>> convert('tired', 'a', 'n')
[('triteness', 0.25), ('banality', 0.25), ('tiredness', 0.25), ('commonplace', 0.25)]
>>> convert('tired', 'a', 's')
[]
>>> convert('wonder', 'v', 'n')
[('wonder', 0.3333333333333333), ('wonderer', 0.2222222222222222), ('marveller', 0.1111111111111111), ('marvel', 0.1111111111111111), ('wonderment', 0.1111111111111111), ('question', 0.1111111111111111)]
>>> convert('wonder', 'n', 'a')
[('curious', 0.4), ('wondrous', 0.2), ('marvelous', 0.2), ('marvellous', 0.2)] 
```

希望这可以为某人省点麻烦

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-24T02:06:14.343

我知道这并不能回答您的全部问题，但确实回答了大部分问题。我会查看 [http://nodebox.net/code/index.php/Linguistics#verb_conjugation](http://nodebox.net/code/index.php/Linguistics#verb_conjugation) 这个 Python 库能够结合动词，并识别一个词是动词、名词还是形容词。

示例代码

```
print en.verb.present("gave")
print en.verb.present("gave", person=3, negate=False)
>>> give
>>> gives 
```

它还可以对单词进行分类。

```
print en.is_noun("banana")
>>> True 
```

下载位于链接顶部。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-24T04:54:05.743

一种方法可能是使用带有词性标签和词形映射的词词典。如果您获取或创建这样的字典（如果您可以访问任何传统字典的数据，这是很有可能的，因为所有字典都列出了单词的 POS 标签，以及所有派生形式的基本形式），您可以使用如下内容：

```
def is_verb(word):
    if word:
        tags = pos_tags(word)
        return 'VB' in tags or 'VBP' in tags or 'VBZ' in tags \
               or 'VBD' in tags or 'VBN' in tags:

def verbify(word):
    if is_verb(word):
        return word
    else:
       forms = []
       for tag in pos_tags(word):
           base = word_form(word, tag[:2])
           if is_verb(base):
              forms.append(base)
       return forms 
```

# rest - 向 JMeter REST 请求添加身份验证

> ID：14489310
> 
> 赞同：2
> 
> 时间：2013-01-23T21:01:51.757
> 
> 标签：rest, jmeter

我今天大部分时间都在试图让它发挥作用，但仍然没有成功。我有一个简单的案例 - 我只想向我的网络服务发送一个 GET 请求。但是无论我做什么，我都无法对其进行身份验证。我尝试了各种授权管理器、Cookie 管理器、标头管理器的组合……但无济于事。

我把它归结为这个最简单的测试：

```
Thread Group
---->HTTP Authorization Manager
---->HTTP Request
---->View Results Tree 
```

我可能会错过什么？我已经为授权管理器尝试了几个 URL，目前将其设置为`https://[domain]:[port]`.
我已经填写了用户名和密码，就是这样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:35:54.920

要启用抢先式身份验证，请使用 http 请求的 HTTPClient 3.1 实现。
然后更改以下文件以添加：

*   jmeter.properties：

    `httpclient.parameters.file=httpclient.parameters`

*   httpclient.参数：

    `http.authentication.preemptive$Boolean=true`

# jquery - 随机选项卡验证

> ID：14489311
> 
> 赞同：0
> 
> 时间：2013-01-23T21:02:00.500
> 
> 标签：jquery, ajax, tabs

我似乎找不到任何与我正在尝试做的完全一样的例子，即使它看起来像是最常见的例子。我在后端使用 JSP 并在每次单击选项卡时访问数据库进行验证。我有 5 个选项卡，每个选项卡都有一个表单，因为这是用于编辑这些表单中的信息，所以文本字段已经填写。我需要做的是验证这些字段中的信息是否已被编辑 - 我有已经 - 每当单击选项卡时，但如果信息不正确，则用户无法继续前进。现在棘手的部分是，用户可以单击 5 个选项卡中的任何一个，并且用户在导航选项卡时必须遵循特定的顺序。这就是我遇到问题的地方。这是我的代码：

```
$(function() {
    $("#tabs").tabs({
    select: function(event, ui) {
    var $emptabs = $('#tabs').tabs();
    var selected = $emptabs.tabs('option', 'selected');
    //$('#tabs-' + selected).on('focusout', function() {
    //tabChange();
    alert('validating tab ' + ui.index);
    }
    });
    var firstName = $("#firstname").val();
    var middleInitial = $("#middleinitial").val();
    var lastName = $("#lastname").val();
    var suffix = $("#suffix").val();
    var gender = $("#gender").val();
    var dob = $("#dob").val();
    var ssn1 = $("#ssn1").val();
    var ssn2 = $("#ssn2").val();
    var ssn3 = $("#ssn3").val();
    var password1 = $("#password1").val();
    var password2 = $("#password2").val();
    var mrtlStsCd = $("#mrtlstscd").val();
    var strAddr1 = $("#straddr1").val();
    var strAddr2 = $("#straddr2").val();
    var city = $("#city").val();
    var state = $("#state").val();
    var zipCode = $("#zipcode").val();
    var zipPls4= $("#zippls4").val();
    var country = $("#country").val();
    var hmPhone = $("#hmphone").val();
    var cellPhone = $("#cellphone").val();

    $.ajax({
        async : "false",
        type: "POST", 
        url: "http://localhost/test/ActionServlet",
        data: { firstname: firstName, middleinitial: middleInitial, lastname: lastName, suffix: suffix, empgender: gender, dob: dob, ssn1: ssn1, ssn2: ssn2, 
                ssn3: ssn3, password1: password1, password2: password2, mrtlstscd: mrtlStsCd, straddr1: strAddr1, straddr2: strAddr2, city: city, state: state, zipcode: zipCode, zippls4: zipPls4, 
                country: country, hmphone: hmPhone, cellphone: cellPhone, step:1 },
        success: function(data) {
            var xmlDoc = null;

            if (window.DOMParser)
            {
               parser = new DOMParser();
               xmlDoc = parser.parseFromString(data,"text/xml");
            }
            else // Internet Explorer
            {
               xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
               xmlDoc.async = false;
               xmlDoc.loadXML(data); 
            }

            var status = xmlDoc.getElementsByTagName("status")[0].childNodes[0].nodeValue;

            if (status == "ok")
            {
                var nextPageID = xmlDoc.getElementsByTagName("nextpageid")[0].childNodes[0].nodeValue;
                 alert('valid');
                $('#personalmessage').hide();
                $emptabs.tabs('select', selected+1);
            }
            else if (status == "errors")
            {
                alert('not valid');
                var errorElements = xmlDoc.getElementsByTagName("error");
                var errors = "";

                for (var x= 0; x < errorElements.length; x++) 
                {
                    errors += errorElements[x].childNodes[0].nodeValue + "<br>";
                }

                $('#personalmessage').show();
                $("h2").html(errors);   
            }
        },
        error: function(jqXHR, textStatus, errorThrown) {
            $('#personalmessage').show();
            $("h2").html(errorThrown);  
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:22:22.533

好吧，由于没有人回答我的问题，我在这里得到了一位开发人员的帮助。我想这里没有人知道答案，或者只是不想回答。无论如何，我会很乐意分享我的解决方案。在父页面上，选项卡脚本如下所示：

```
var $prevseltab = 0;
var $tabfuncs = {};
var $preventDefault;
var $bindTabs;
$(function() {
    $("#tabs").tabs();

    $preventDefault = function(e){
        e.preventDefault();
    }

    $bindTabs = function(){
        $("#tabs").bind("tabsselect", function(e, tab) {
            $tabfuncs[$prevseltab](e,tab.index);
            return false;
        });
    };

    $bindTabs();    
}); 
```

在子页面上，它看起来像这样：

```
$tabfuncs[0] = function(e,currtab) {

    var firstName = $("#firstname").val();
    var middleInitial = $("#middleinitial").val();

    $.ajax({
        async : "false",
        type: "POST", 
        url: "http://localhost/test/ActionServlet",
        data: { firstname: firstName, middleinitial: middleInitial, step:1 },
        success: function(data) {
            var xmlDoc = null;

            if (window.DOMParser)
            {
               parser = new DOMParser();
               xmlDoc = parser.parseFromString(data,"text/xml");
            }
            else // Internet Explorer
            {
               xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
               xmlDoc.async = false;
               xmlDoc.loadXML(data); 
            }

            var status = xmlDoc.getElementsByTagName("status")[0].childNodes[0].nodeValue;

            if (status == "ok")
            {
                 $('#personalmessage').hide();

                 var $emptabs = $('#tabs').tabs();
                 $emptabs.unbind("tabsselect");
                 $prevseltab = currtab;
                 $emptabs.tabs('select', currtab);
                 $bindTabs();
                 return true;
            }
            else if (status == "errors")
            {
                var errorElements = xmlDoc.getElementsByTagName("error");
                var errors = "";

                for (var x= 0; x < errorElements.length; x++) 
                {
                    errors += errorElements[x].childNodes[0].nodeValue + "<br>";
                }

                $('#personalmessage').show();
                $("h2").html(errors);   
                e.preventDefault();
                return false;
            }
        },
        error: function(jqXHR, textStatus, errorThrown) {
            $('#personalmessage').show();
            $("h2").html(errorThrown);  
            return false;
        }
    });
};

$(function() {
    $('#tabs').on('click', '#submit1', function() {
        $tabfuncs[0]();
    });
}); 
```

# c# - 如何使 WPF 数据网格的第一行成为自动添加新行行

> ID：14489313
> 
> 赞同：2
> 
> 时间：2013-01-23T21:02:05.733
> 
> 标签：c#, wpf, c#-4.0, wpfdatagrid

我有一个实现的简单类`INotifyPropertyChanged`：

```
class Revision {

 - int Id
 - string Description

} 
```

然后，我有另一个类，它包含上述“修订”类的可观察集合：

```
ObservableCollection<Revision> revisionList = new ObservableCollection<Revision>(); 
```

在我的 UI 中，我有一个 Datagrid，它双向绑定到上面的“revisionList”，自动生成列并显示一个空白行，以便我可以添加新行。

但是，我希望数据网格做的是让空白的新行行成为网格的第一行而不是最后一行，之后，我希望下一行是“revisionList”中的所有修订对象，按“Id”属性降序排列。

为了更清楚，假设我在“revisionList”中有3个修订，我得到的是这样的默认数据网格：

```
 ----------------------------------
|  Id  |        Description        |
 ----------------------------------
|  0   |   Revision 00             |
 ----------------------------------
|  1   |   Revision 01             |
 ----------------------------------
|  2   |   Revision 02             |
 ----------------------------------
|  < blank add new revision line > |
 ---------------------------------- 
```

我想要的是数据网格是这样的：

```
 ----------------------------------
|  Id  |        Description        |
 ----------------------------------
|  < blank add new revision line > |
 ----------------------------------
|  2   |   Revision 02             |
 ----------------------------------
|  1   |   Revision 01             |
 ----------------------------------
|  0   |   Revision 00             |
 ---------------------------------- 
```

有什么方法可以设置数据绑定，或者我可以使用的数据网格上的任何事件，以便数据网格自动像这样运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:54:20.483

我不知道你是如何加载你的 observable 集合的，但如果你碰巧使用了 for 循环，你可以在加载之前添加空白修订，然后从顶部开始使用 for 循环。

```
 var blankRevision = new Revision(); 
 revisionList.add(blankRevision);

 for (int i = YourDataSource.Count; i > 0; i--) {

      revisionList.add(YourDataSource[i-1]);
 } 
```

如果这没有帮助，还有其他方法可以做到这一点。此外，不让您的数据网格自动生成可能更有帮助，而是制作一些 DataGridTextColumns 并将 id 和描述绑定到列，这将允许对列进行更多自定义。

# linux - 如何使用 grep 和字符串在多个文件中搜索单个单词或短语？

> ID：14489316
> 
> 赞同：0
> 
> 时间：2013-01-23T21:02:24.913
> 
> 标签：linux, search, command

我试图在多个文件中寻找像“数字”这样的词，而不仅仅是使用终端的 txt 文件。我试过字符串 -r /media/E016-5484/* | grep numbers 但它仍然不起作用！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:07:07.607

假设您在名称中包含 file_pattern 的所有文件中查找 1234

```
 grep 1234 ` find . -name "*file_pattern*"` 
```

或者

```
 find  . -name "*file_pattern*" -exec grep 1234 {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-19T15:55:37.727

如果我没记错的话，你正在寻找 `grep numbers -r /media/E016-5484`

从手册页：

> -r，--递归
> 
> 递归地读取每个目录下的所有文件，仅当它们位于命令行时才遵循符号链接。这等效于 -d 递归选项。

# vim - 如何在 Vim 命令行中扩展函数参数？

> ID：14489320
> 
> 赞同：2
> 
> 时间：2013-01-23T21:02:30.983
> 
> 标签：vim

Vim 的[Utl](https://github.com/vim-scripts/utl.vim)插件提供了一种在编辑器中进行 Web 查询的便捷方式。当直接从命令行调用时，字典查找可以这样完成：

```
:Utl ol http://dict.leo.org/?search=my+search+term 
```

定义具有相同目的的自定义命令（`my+search+term`作为用户输入）的正确方法是什么？我似乎无法解决`<f-args>`这个问题：

```
command -nargs=1 SearchLeo :exe ":Utl ol http://dict.leo.org/?search=" . expand("<f-args>") 
```

在这里定义函数参数的正确方法是什么？或者我应该把它变成一个更完整的功能？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T11:50:07.803

1.  您可能不需要`expand()`这里；它仅用于扩展 glob（如`*.txt`）或当前文件的特殊变量`%`。
2.  您将参数引用两次，一次通过`<f-args>`（`<q-args>`会稍微正确一些，尽管它只与可变数量的参数有关），一次是字面意思。

用这个：

```
command -nargs=1 SearchLeo :exe ":Utl ol http://dict.leo.org/?search=" . <q-args> 
```

# haskell - IO Monad 是否懒惰地评估？

> ID：14489331
> 
> 赞同：-3
> 
> 时间：2013-01-23T21:02:56.233
> 
> 标签：haskell

这是以下代码，我尝试在其中找到一些素数除数。我曾尝试将 TAOCP 算法转换为 Haskell 程序，但我可以理解什么时候会懒惰或急切地评估：

```
modof2 n = let a0 = shiftR n 1
           a1 = shiftL a0 1
       in n-a1
iseven n = modof2 n == 0

factoringby2 n = let s=(lastf (takeWhile f [1..])) + 1
                 d=n `quot` powerof2 s
             in (s,d)
  where f s = let d = n `quot` (powerof2 s)
            in if isodd d 
               then False
               else True
      lastf [] = 0
      lastf xs = last xs

miller_rabin_prime_test n 0 result=return result
miller_rabin_prime_test n k result| (isodd n) && n>3 = do
                                            a<-randomRIO(2,n-2)
                                            let z = basic_step n a (fst sd) (snd sd)
                                            miller_rabin_prime_test n (k-1) z
  where sd=factoringby2 n
basic_step:: Integer->Integer->Int->Integer->Bool
basic_step n a s d =any (\x-> x==1 || x==n-1) (map x (map u [0..s-1]))
  where u j=powerof2(j)*d 
        x j=modular_pow a j n 1

isprime n = if n==2 || n==3
        then return True
        else if n<2
             then return False
             else if iseven n
                  then return False
                  else miller_rabin_prime_test n 5 True
x_m :: Double->Integer->Integer
x_m 0 n = 2
x_m m n = f (x_m (m-1) n) `mod` n
where f x = x^2 +1
l::Double->Double
l m = 2 ^ (floor (log2 m))
where log2 m = log m / log 2
g m n = let a = x_m m n
        b = x_m ((l m)-1) n
     in gcd (a-b) n

gg n = [g m n|m<-[1..]]

algorithmB n = do
            testprime<-isprime n
            let a = head (filter (1>) (gg n))
            c<-algorithmB (n `div` a)
            if testprime
            then return []
            else return (a:c) 
```

算法 B 不会终止。为什么会发生这种情况？我认为这就是原因，因为它不会懒惰地评估。真的吗？谢谢`c<-algorithmB (n `div` a)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:29:17.430

`algorithmB`在无限循环中调用自己。当然回不去了！

# android - Android：setVisibility 未将 View 设置为可见

> ID：14489340
> 
> 赞同：0
> 
> 时间：2013-01-23T21:03:24.707
> 
> 标签：android

我正在使用 minSDK = 8 和 targetSDK = 17

在活动开始时，我的 3 个屏幕（3 个不同的视图）在 XML 布局中设置为不可见。在 onResume 中，我调用了 setScreen(1)，它启动了一个将 View 'wait' 设置为可见的动画。然而，在 'wait' 设置为可见的第 34 行，没有任何反应。如果我从第 43 行中删除注释 // 'main' 设置为不可见，'wait' 变为可见。

为什么注释掉第 43 行时不出现“等待”？为什么需要将已经不可见的“主”视图设置为不可见才能出现“等待”？

```
public class TestActivity extends Activity {
static final String TAG = "test";
public Context context;
Activity myActivity;
UserFunctions userFunctions;
Button but_begin;
int status;
View main;
View wait;
View noconnect;
Animation fadeIntoWait;
Animation fadeIntoConnect;
Animation fadeIntoMain;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.test);
    context = getApplicationContext();
    myActivity = this;

    main = findViewById(R.id.screen_main);
    wait = findViewById(R.id.screen_wait);
    noconnect = findViewById(R.id.screen_connect);

    fadeIntoWait = AnimationUtils.loadAnimation(this, R.anim.fade_in);
    fadeIntoConnect = AnimationUtils.loadAnimation(this, R.anim.fade_in);
    fadeIntoMain = AnimationUtils.loadAnimation(this, R.anim.fade_in);

    fadeIntoWait.setAnimationListener(new AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {
            wait.setVisibility(View.VISIBLE);
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {
            //main.setVisibility(View.INVISIBLE);
            //noconnect.setVisibility(View.INVISIBLE);

        }
    });
    fadeIntoConnect.setAnimationListener(new AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {

            noconnect.setVisibility(View.VISIBLE);
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {
            wait.setVisibility(View.INVISIBLE);
        }
    });
    fadeIntoMain.setAnimationListener(new AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {

            main.setVisibility(View.VISIBLE);

        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {
            wait.setVisibility(View.INVISIBLE);
        }
    });

}

@Override
public void onStart() {

    super.onStart();

}

@Override
public void onResume() {
    super.onResume();

    setScreen(1);

}

public void setScreen(int screen) {

    switch (screen) {
    case 1: // into wait
        wait.startAnimation(fadeIntoWait);

        break;
    case 2: // to noconnect
        noconnect.startAnimation(fadeIntoConnect);

        break;

    case 3: // to main
        main.startAnimation(fadeIntoMain);

        break;
    }
}

public void gotoActivity(Class<?> s) {
    Intent g = new Intent(getApplicationContext(), s);

    // Close all views before launching Dashboard
    g.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    startActivity(g);
    overridePendingTransition(R.anim.fade_in, R.anim.fade_out);
}

public void retryConnect(View view) {

}

public void begin(View view) {
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    menu.add(0, 1, 0, "Exit App");
    menu.add(0, 2, 0, "Close Menu");
    menu.add(0, 3, 0, "Dashboard");

    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {

    case 1: // log out
        closeOptionsMenu();
        return true;
    case 2: // Exit App
        finish();
        return true;
    case 3: // Exit App
        gotoActivity(DashboardActivity.class);
        return true;

    }
    return super.onOptionsItemSelected(item);

}

public void menu(View v) {

    openOptionsMenu();

}

} 
```

这是 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<LinearLayout
    android:id="@+id/header"
    android:layout_width="match_parent"
    android:layout_height="44dp"
    android:layout_alignParentTop="true"
    android:background="@drawable/line" >
</LinearLayout>

<FrameLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_below="@id/header" >

    <RelativeLayout
        android:id="@+id/screen_wait"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#000"
        android:visibility="gone" >

        <ImageView
            android:id="@+id/img_wait"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_gravity="center"
            android:contentDescription="@string/wait"
            android:src="@drawable/wait"
             />
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/screen_connect"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#000"
        android:visibility="gone" >

        <ImageView
            android:id="@+id/img_connect"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_gravity="center"
            android:contentDescription="@string/connect"
            android:onClick="retryConnect"
            android:src="@drawable/connect"
            />
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/screen_main"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#000"
        android:visibility="gone" >

        <ScrollView
            android:id="@+id/middle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_above="@+id/footer"
            android:background="#2F2430" >

            <RelativeLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:background="#2F2430" >

                <TextView
                    android:id="@+id/textView3"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content" />

                <TextView
                    android:id="@+id/textView1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentLeft="true"
                    android:text="@string/idea"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textColor="#21dbd4" />

                <Button
                    android:id="@+id/but_begin"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_below="@+id/TextView01"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="67dp"
                    android:onClick="begin"
                    android:text="Begin" />
            </RelativeLayout>
        </ScrollView>

        <RelativeLayout
            android:id="@+id/footer"
            android:layout_width="match_parent"
            android:layout_height="44dp"
            android:layout_alignParentBottom="true"
            android:background="@drawable/line"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/textView2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:text="Pennies:" />

            <TextView
                android:id="@+id/textView4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:layout_marginLeft="22dp"
                android:layout_toRightOf="@+id/textView2" />

            <Button
                android:id="@+id/btnMenu"
                style="?android:attr/buttonStyleSmall"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:onClick="menu"
                android:text="Menu" />
            </RelativeLayout>
        </RelativeLayout>
    </FrameLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-10T13:26:01.133

你的 UI 直到 onCreate() 之后才会布局。尝试将动画移动到 onStart() 或更好，一旦布局完成，使用 ViewTreeObserver 启动它们

# javascript - Twitter 小部件在我的 JavaScript 函数中不起作用

> ID：14489342
> 
> 赞同：1
> 
> 时间：2013-01-23T21:03:30.103
> 
> 标签：javascript, widget, twitter, innerhtml

我构建了一个 Twitter 小部件，并试图让它在我的页面上显示在一个预构建的 JavaScript 函数中。

我将小部件放在一个隐藏的 div 中，当点击页面上的链接时会显示该 div，但小部件没有显示，我不知道为什么。我正在从 Twitter 复制代码。

下面是 JavaScript 函数和 Twitter Widget 代码：

```
function showTwitterFeed(a) {
    $(".navlink").removeClass("active");
    $(a).addClass("active");
    $("#content").css("display","block");
    document.getElementById('content').innerHTML = "<a class=\"twitter-timeline\" width=\"500\" height=\"600\" href=\"https://twitter.com/PLInVancity\" data-widget-id=\"293993973104656384\">Tweets by @PLInVancity</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=\"//platform.twitter.com/widgets.js\";fjs.parentNode.insertBefore(js,fjs);}}(document,\"script\",\"twitter-wjs\");</script>";
} 
```

如果有人知道为什么它不起作用，请告诉我。将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:11:33.437

```
function showTwitterFeed(a) {
    $(".navlink").removeClass("active");
    $(a).addClass("active");
    $("#content").css({"display": "block"});
    $('#content').html("<a class=\"twitter-timeline\" width=\"500\" height=\"600\" href=\"https:\/\/twitter.com\/PLInVancity\" data-widget-id=\"293993973104656384\">Tweets by @PLInVancity<\/a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=\"\/\/platform.twitter.com/widgets.js\";fjs.parentNode.insertBefore(js,fjs);}}(document,\"script\",\"twitter-wjs\");<\/script>");
} 
```

我相信这解决了它（在 JsFiddle 中不再收到任何错误）。您需要转义所有“/”。

编辑：绝对固定，这是小提琴：http: [//jsfiddle.net/klatzkaj/73A3m/](http://jsfiddle.net/klatzkaj/73A3m/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-31T12:47:53.107

你必须在`<script/>`你`<head></head>`的 html中包含

# php - 使用 PHP 来自 MySQL Db 的 Em Dash 和 En Dash

> ID：14489345
> 
> 赞同：2
> 
> 时间：2013-01-23T21:03:35.783
> 
> 标签：php, mysql, utf-8

我正在尝试使用 PHP 输出一个包含 em dash 和 en dash 的 MySQL 数据库字段，但是尽管 ROWs 输出，这些破折号的值却没有。

据我所知，这些字符应该以正确的英语使用，因此我认为我不应该将它们剥离或用替代品（如连字符）替换它们。

通过在 INSERT 之前添加此代码，我能够正确地将 em dash 和 en dash 放入数据库（而没有这一行，我看到了不需要的字符）：

```
mysql_query('SET NAMES utf8'); 
```

但是，该值不会输出。数据库表及其字段正在使用 utf8_general_ci 排序规则，我的 PHP 页面中有这些行：

```
header('Content-type: text/html; charset=utf-8');
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

我正在输出这样的值：

```
echo nl2br(htmlentities(preg_replace("/[\r\n]+/", "\n\n", $row['someText']))); 
```

如果我输出没有格式化的值，我会看到这个问号字符：

�</p>

有谁知道如何解决这个问题？即使语法不正确，我是否被迫用连字符替换它们，或者有没有办法在它们出现在数据库中时输出它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:09:49.727

在从 Db 检索数据之前，我添加了相同的 MySQL 命令，这解决了这个问题。

```
mysql_query('SET NAMES utf8'); // Use utf-8 
```

我不知道*为什么*需要这样做，但我会进行调查，看看是否可以将其设为默认值。

# php - 是否可以使用 PHP-CGI 运行 APC？

> ID：14489346
> 
> 赞同：0
> 
> 时间：2013-01-23T21:03:36.097
> 
> 标签：php, fastcgi, apc

是否可以使用 PHP-CGI 运行 APC？我无法获取上传文件的 apc 上传值，我使用的配置是：

```
apc.rfc1867 On
apc.rfc1867_freq    0
apc.rfc1867_name    APC_UPLOAD_PROGRESS
apc.rfc1867_prefix  upload_
apc.rfc1867_ttl 3600 
```

php代码：

```
$status = apc_fetch('upload_'.$uid); // $uid = id for the file 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:20:57.363

不，APC 在作为 CGI 运行时不起作用——它依赖于与其他进程共享数据，这仅在所有 PHP 进程一起启动时才起作用。（仅当 PHP 作为 Apache 模块或在 FastCGI / FPM 下运行时才适用。）

# google-maps - 当 lat/lng 用于中心点而不是地理编码 extjs/gmapanel 时，谷歌地图没有得到控制

> ID：14489347
> 
> 赞同：0
> 
> 时间：2013-01-23T21:03:36.147
> 
> 标签：google-maps, extjs

我正在为谷歌地图使用版本 2。代码如下

```
var smallGoogleMap = new Ext.ux.GMapPanel({
xtype: 'gmappanel',
id : 'gSmallSiteMap',
width:'100%',
height:1000,
zoomLevel: 10,
gmapType: 'map',
mapConfOpts: ['enableScrollWheelZoom','enableDoubleClickZoom','enableDragging'],
mapControls: ['GSmallMapControl','GMapTypeControl','NonExistantControl'],
setCenter: {
  lat: latitude,
  lng: longitude,
  marker:{ title: newTitle}
}
}); 
```

如果我在 setCenter 中使用 geoCodeAddr，如下所示，我将获得对结果谷歌地图的控制，但使用上面的代码（lat/lng）我失去了控制。

```
setCenter: {
  geoCodeAddr: newAdd,
  marker:{ title: newTitle}
} 
```

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T15:35:11.017

好吧，在网上搜索后，我发现源代码 GMapPanel.js 必须修改才能获得理想的结果。

需要修改的原始代码如下

```
......
if (typeof this.addControl == 'object' && this.gmapType === 'map') {
        this.gmap.addControl(this.addControl);
    }

    if (typeof this.setCenter === 'object') {
        if (typeof this.setCenter.geoCodeAddr === 'string'){
            this.geoCodeLookup(this.setCenter.geoCodeAddr);
        }else{
            if (this.gmapType === 'map'){
                point = new GLatLng(this.setCenter.lat,this.setCenter.lng);
                this.gmap.setCenter(point, this.zoomLevel);    
            }
            if (typeof this.setCenter.marker === 'object' && typeof point === 'object'){
                this.addMarker(point,this.setCenter.marker,this.setCenter.marker.clear);
            }
        }
        if (this.gmapType === 'panorama'){
            this.gmap.setLocationAndPOV(new GLatLng(this.setCenter.lat,this.setCenter.lng), {yaw: this.yaw, pitch: this.pitch, zoom: this.zoom});
        }
    }
GEvent.bind(this.gmap, 'load', this, function(){
        this.onMapReady();
    });
},
onMapReady : function(){
    this.addMarkers(this.markers);
    this.addMapControls();
    this.addOptions();  
},
........ 
```

它必须修改如下

```
......
if (typeof this.addControl == 'object' && this.gmapType === 'map') {
        this.gmap.addControl(this.addControl);
    }

    GEvent.bind(this.gmap, 'load', this, function(){
        this.onMapReady();
    });

    if (typeof this.setCenter === 'object') {
        if (typeof this.setCenter.geoCodeAddr === 'string'){
            this.geoCodeLookup(this.setCenter.geoCodeAddr);
        }else{
            if (this.gmapType === 'map'){
                point = new GLatLng(this.setCenter.lat,this.setCenter.lng);
                this.gmap.setCenter(point, this.zoomLevel);    
            }
            if (typeof this.setCenter.marker === 'object' && typeof point === 'object'){
                this.addMarker(point,this.setCenter.marker,this.setCenter.marker.clear);
            }
        }
        if (this.gmapType === 'panorama'){
            this.gmap.setLocationAndPOV(new GLatLng(this.setCenter.lat,this.setCenter.lng), {yaw: this.yaw, pitch: this.pitch, zoom: this.zoom});
        }
    }

},
onMapReady : function(){
    this.addMarkers(this.markers);
    this.addMapControls();
    this.addOptions();  
},
........ 
```

在设置 setCenter 以获取地图上的控件之前，我们必须移动“GEvent.bind”。

```
GEvent.bind(this.gmap, 'load', this, function(){
    this.onMapReady();
}); 
```

# c# - 反转交叉连接输入

> ID：14489352
> 
> 赞同：-3
> 
> 时间：2013-01-23T21:03:50.030
> 
> 标签：c#, sql, sql-server, tsql

表由以下存储过程填充：

```
exec('
insert into tblSegments
    (SegmentName, CarTypeID, EngineTypeID, AxleTypeID)
select distinct
    ''' + @SegmentName + '''
    , CT.CarTypeID
    , ET.EngineTypeID
    , AT.AxleTypeID
from
    tblCarTypes CT
        cross join tblEngineTypes ET
        cross join tblAxleTypes AT
where
    CT.CarTypeName in (' + @CarTypes + ')
    and ET.EngineTypeName in (' + @EngineTypes + ')
    and AT.AxleTypeName in (' + @AxleTypes + ')
') 
```

参数，除了`@SegmentName`，是字符串，如 (for `@CarTypes`) `'hatchback','suv','sedan'`。

表中的数据是否可用于为单个`SegmentName`存储过程的先前条目创建一个列表，类似于

Run1：@CarTypes、@EngineTypes、@AxleTypes
Run2：@CarTypes、@EngineTypes、@AxleTypes
Run3：@CarTypes、@EngineTypes、@AxleTypes

...？

运行不需要按顺序进行。该过程可能涉及 T-SQL 和 C# 的组合。我很确定这是不可能的；也许有人可以证明我错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:09:46.653

不，这是不可能的，因为您正在接受一个可能以逗号分隔的值字符串，这将在您的结果表中创建单独的行。您可以轻松地为 CarTypes、EngineTypes 和 AxleTypes 变量分别获取一个值，但是要按动态 SQL 的每次执行分别对它们进行分组，您需要某种 executionID 列或其他东西来对每次执行时的行进行分组。

所以你是正确的，你想要做的事情是完全可能的，但不是你提供的模式设计。如果这是您想要保留的信息，我将创建另一个表并在运行时填充它。您可以在包含输入变量的表上放置一个标识列，并使用 @@IDENTITY 插入该表以填充主表中的 executionID 列，以便您可以轻松地将变量汇总表与交叉连接的结果表相关联.

# c - TreeView fontsize - 自定义绘制或所有者绘制

> ID：14489358
> 
> 赞同：1
> 
> 时间：2013-01-23T21:04:19.477
> 
> 标签：c, winapi, fonts, treeview, treeviewitem

我想更改 TreeView 控件的字体大小。在 goolge 上搜索后，我才知道应该为这个 TreeView 使用 CustomDraw。但是`NMTVCUSTOMDRAW`结构只有设置TreeView中显示文本的前景色和背景色`clrText`。`clrText`

我的问题是：

```
Q1: How to change the font size in a TreeView? For the background color of TreeView,
    one can just use `TreeView_SetBkColor` or send a message. Anything similar
    for font size?

Q2: What's the difference between Custom Draw and Owner Draw? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:27:58.313

Q1。您可以使用`WM_SETFONT`消息执行此操作。

Q2。他们做类似的事情。Owner draw 是一个较旧的系统，这意味着您必须自己绘制整个控件。自定义绘图更新且更灵活，如果您愿意，您可以只处理绘图的一部分（甚至不绘图，只需更改字体/颜色）。

# html - div "style=resize:both" 不能在 chrome 中缩小（但在 Firefox 中有效）

> ID：14489361
> 
> 赞同：2
> 
> 时间：2013-01-23T21:04:57.317
> 
> 标签：html, css, google-chrome

我有以下 div：

```
<div style='overflow:hidden;resize:both;border:1px solid orange;'>
   <div style='background-color:#aaa;width:400px;height:300px;'>
   </div>
</div> 
```

你可以在这里看到它：http: [//jsfiddle.net/4w7zd/](http://jsfiddle.net/4w7zd/)

如果你在 Firefox 中运行它，你可以调整主 div 的大小。（使它更大或更小）但是，如果您在 chrome 中运行它，您只能调整大小以使其更大（更宽和更高）

有人可以告诉我如何解决它，以便我可以使主 div 尽可能小（就像使用 firefox 一样）？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:22:07.713

我做了一些测试，似乎内容使得无法在 chrome 中调整大小。我已将您的案例更新为此

```
<div style='overflow:auto;resize:both;border:1px solid orange; min-height: 10px;'>
    <div style='background-color:#eee;width:400px;max-height:300px; height:100%;'>
    </div>
</div> 
```

它现在似乎可以工作了：http: [//jsfiddle.net/4w7zd/7/](http://jsfiddle.net/4w7zd/7/)

不确定这是否适合您，但它可能会为您指明正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:28:38.837

在 chrome 中，使用时的最小宽度`resize`取决于它的内容。这种方式在谷歌浏览器中适用于我：http: [//jqueryui.com/resizable/](http://jqueryui.com/resizable/)

嵌入 jquery 库：

```
 <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
  <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script> 
```

Javascript：

```
<script>
  $(function() {
    $( ".resizable" ).resizable();
  });
</script> 
```

HTML：

```
<div class="resizable" class="ui-widget-content">
  <h3 class="ui-widget-header">Resizable</h3>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-22T23:46:52.550

这是一种解决方法：

```
div {resize: both;}
div:active {
  width: 0;
  height: 0;
} 
```

它适用于 Chrome、Safari 和 Firefox。它可能在 IE 上不起作用，但我还没有检查过。但是，此解决方法的问题是您无法与可调整大小的 div 中的元素进行交互。

[http://jsfiddle.net/Lf5qmos4/](http://jsfiddle.net/Lf5qmos4/)

# java - CSV 写入使用 Java 产生奇怪的错误

> ID：14489362
> 
> 赞同：1
> 
> 时间：2013-01-23T21:05:00.477
> 
> 标签：java, arrays, string, supercsv

我尝试将我的数组写入一个文件，但是我得到的不是我的数据，而是两个单元格；一个是 `[Ljava.lang.String;@7b1ddcde`，另一个是`[Lorg.supercsv.cellprocessor.ift.CellProcessor;@658fb1f7`我不知道这到底是怎么发生的，因为我的数组实际上是一组非常好的数据，当我将它打印到控制台时就可以工作。

我的表格包含所有标题和必需的单元格，只是这些奇怪的错误占据了前两个单元格，并且没有写入其他数据。

我的 CellProcessor 方法充满了，`new Optional(),`所以我认为这不是问题所在。这是整个方法。我很抱歉，我的代码很糟糕，它是匆忙编写的。

```
static String[] writeWithCsvListWriter(String filename) throws Exception {
    ICsvListWriter listWriter = null;
    try {
            listWriter = new CsvListWriter(new FileWriter(Main.filename + ".csv"),
                    CsvPreference.STANDARD_PREFERENCE);

            final CellProcessor[] processors = getProcessors();
            final String[] header = new String[] { "Year", "mm", "Max Temp", "Min Temp",
                    "af days", "Rain", "Sun" };

            listWriter.writeHeader(header);

            FileReader fileReader = new FileReader(filename);
            BufferedReader bufferedReader = new BufferedReader(fileReader);
            List<String> lines = new ArrayList<String>();
            String line = null;

            int i = 0;
            while ((line = bufferedReader.readLine()) != null) {
                if(line.startsWith("   2010")){
                    try {
                        String[] splitArray = line.split("\\s+");
                        System.out.println("Writing Array");
                        listWriter.write(splitArray, processors);
                    } catch (PatternSyntaxException ex) {
                    }
                }
                i++;
            }
            bufferedReader.close();
    } finally {
            if( listWriter != null ) {
                    listWriter.close();
            }
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:14:21.050

查看[ICsvListWriter API](http://supercsv.sourceforge.net/apidocs/org/supercsv/io/ICsvListWriter.html)，在我看来您正在获取方法`write(Object... columns)`，而不是`write(List<?> columns, CellProcessor[] processors)`。

您尝试调用的方法似乎期望 List 作为第一个参数，而不是数组，因此请先将您的数组转换为列表，然后再尝试编写它。就像是;

```
String[] splitArray = line.split("\\s+");
List list = Arrays.asList(splitArray);
System.out.println("Writing Array");
listWriter.write(list, processors); 
```

# javascript - 检测粗体和斜体支持

> ID：14489363
> 
> 赞同：12
> 
> 时间：2013-01-23T21:05:06.963
> 
> 标签：javascript, css

一些字体不支持 CSS 斜体或粗体（例如[Zapfino](http://en.wikipedia.org/wiki/Zapfino)不支持斜体，因为它已经很像脚本了）。我想检测何时不支持字体样式，以便我可以禁用编辑器中的样式按钮。

我试过这样[的](https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript/118251#118251)事情：

```
that.checkFontData = function( fontList )
{   var test = $("<span style='font-size:24px;absolute;visibility:hidden;height:auto;width:auto;white-space:nowrap;'>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678910</span>");
    $('body').append( test );
    for (var i= 0, iMax = fontList.length; i < iMax; ++i)
    {   test.css( 'fontFamily', fontList[i] );
        var normalWidth = test.outerWidth( true );
        var normalHeight = test.outerHeight( true );
        test.css( 'fontStyle', 'italic' );
        var italicWidth = test.outerWidth( true );
        var italicHeight = test.outerHeight( true );
        test.css( 'fontStyle', 'normal' );
        test.css( 'fontWeight', 'bold' );
        var boldWidth = test.outerWidth( true );
        var boldHeight = test.outerHeight( true );
        console.log( fontList[i]  + ", normal: " + normalWidth + ", bold: " + boldWidth + ", italic: " + italicWidth  );
    }
    test.remove( );
}; 
```

但它不起作用......许多提供斜体或粗体的字体报告相同的宽度。

接下来，我想用画布元素来检测这一点，但是，可惜的是，Firefox 甚至没有在画布中呈现斜体文本，所以这个想法很糟糕。

你有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:44:58.170

要检测**粗体**和*斜体*支持，您可以将文本转换为图像并进行比较。

这样做的方法是：

1.  创建一个`canvas`^(见下文)（无需将其附加到 DOM）
2.  在中绘制文本`canvas`
3.  将画布转换为图像（这里我使用`png`）
4.  比较图片的base64字符串

关于`canvas`：

> 接下来，我想用画布元素来检测这一点，但是，可惜的是，Firefox 甚至没有在画布中呈现斜体文本，所以这个想法很糟糕。

某些字体在 Firefox 的画布中没有斜体，因为本机斜体字体不存在。其他浏览器会尝试伪斜体（倾斜）字体。

**[在 jsFiddle 上查看](http://jsfiddle.net/r4gfq/3/)**（此演示还测试了 Google 字体`Snowburst One`）

```
function detectBoldItalic(fonts) {
    // Create canvas
    var canvas = document.createElement('canvas');
    canvas.width = 1000;
    canvas.height = 30;
    var context = canvas.getContext("2d");
    var test = {}, results = {};
    // Default
    context.font = "normal 16px a base case font";
    context.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678910", 10, 20);
    var standard = canvas.toDataURL("image/png");
    context.setTransform(1, 0, 0, 1, 0, 0);
    context.clearRect(0, 0, canvas.width, canvas.height);
    // Start test
    for (var i = 0; i < fonts.length; i++) {
        var styles = ["normal", "bold", "italic"];
        test[fonts[i]] = {};
        results[fonts[i]] = {};
        for (var j = 0; j < styles.length; j++) {
            // Draw text in canvas
            context.font = styles[j] + " 16px " + fonts[i];
            context.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678910", 10, 20);
            // Convert canvas to png
            test[fonts[i]][styles[j]] = canvas.toDataURL("image/png");
            // Clear canvas
            context.setTransform(1, 0, 0, 1, 0, 0);
            context.clearRect(0, 0, canvas.width, canvas.height);
        }
        if (test[fonts[i]]["normal"] !== standard) {
            results[fonts[i]]["bold"] = test[fonts[i]]["normal"] !== test[fonts[i]]["bold"] ? true:false; // Support bold
            results[fonts[i]]["italic"] = test[fonts[i]]["normal"] !== test[fonts[i]]["italic"] ? true:false; // Support italic
        } else {
            results[fonts[i]] = false; // Font does not exist
        }
    }
    return results;
}
console.log(detectBoldItalic(["Arial","Zapfino"])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:38:27.247

我已经在 jsFiddle 中测试了您的代码，它确实为自然网络字体（如 and）提供了不同的大小 `Georgia`，`Arial`但对于外部加载的字体（如 `Snowburst One`（Googlefont））则没有。

[JS小提琴你的脚本](http://jsfiddle.net/v6b9Q/1/)

经过一些研究，我发现对于`@font-face`加载的字体没有 css 字体转换适用。人们加载`@font-face`变体并像这样应用它们：

```
body { font-family:"DroidSerifRegular", Georgia, serif; }
h1 {
    font-family:"DroidSerifBold", Georgia, serif;
    font-weight:normal;
}
em {
    font-family:"DroidSerifItalic", Georgia, serif;
    font-weight:normal;
    font-style:normal;
}
strong em {
    font-family:"DroidSerifBoldItalic", Georgia, serif;
    font-weight:normal;
    font-style:normal;
} 
```

如果您使用的`@font-face`字体与上面的示例类似，您可能会想出某种命名约定。然后，您可以通过检查与后备字体相比的宽度来检查这些字体是否存在。

```
test.css('fontFamily', 'sans-serif');
var defaultWidth = test.outerWidth( true );

for (var i= 0, iMax = fontList.length; i < iMax; ++i)
{   test.css( 'fontFamily', fontList[i] + ', sans-serif' );

    var normalWidth = test.outerWidth( true );
    var normalHeight = test.outerHeight( true );
    test.css( 'fontFamily', fontList[i] + 'Italic, sans-serif' );
    var italicWidth = test.outerWidth( true );
    var italicHeight = test.outerHeight( true );
    test.css( 'fontFamily', fontList[i] + 'Bold, sans-serif' );
    var boldWidth = test.outerWidth( true );
    var boldHeight = test.outerHeight( true );
    console.log( "default: "+ defaultWidth + ", " fontList[i]  + ", normal: " + normalWidth + ", bold: " + boldWidth + ", italic: " + italicWidth  );
} 
```

如果样式版本的宽度与默认版本相比有所改变，那么它就是“宾果游戏”！

注意：这不适用于等宽字体，因为所有字符的宽度始终相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T16:30:53.550

使用 Font.js，您可以更可靠地访问用于计算的字体指标。[http://pomax.nihongoresources.com/pages/Font.js](http://pomax.nihongoresources.com/pages/Font.js)

# iphone - 为使用 iTunes 文件共享的 iOS 编写 Web 查看器

> ID：14489368
> 
> 赞同：1
> 
> 时间：2013-01-23T21:05:16.547
> 
> 标签：iphone, ios, objective-c, xcode, ipad

有没有人有这方面的例子？我设法设置了一个`UIWebView`通过 iTunes 文件共享加载单个页面的程序。
问题是因为文件共享不允许目录我需要一种解压缩 zip 文件的方法，该文件将包含页面中的所有图像/javascript/css 等。

我已经尝试了一些 zip 压缩框架，但对 iOS 几乎没有用处，也许有更好的东西？

# excel - 在 Excel 列中搜索字符串

> ID：14489369
> 
> 赞同：0
> 
> 时间：2013-01-23T21:05:22.907
> 
> 标签：excel, vba

我有一个看起来像这样的 Excel 文件：

```
Col A   Col B   Col C
------  -----   -------
ABC     3600    Title 1
DEF     3601    Title 2
ABC     3603    Title 3
GHI     3603    Title 4
ABC     3602    Title 5
JKL     3604    Title 6 
```

等等

我需要这样说：如果 A 列是“ABC”而 B 列不是（3601,3602,3603,3700），那么在 D 列（空列）中放置一个“1”。

我究竟如何把它放在VBA中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:33:39.650

你需要VBA吗？

一个公式是：

```
=IF(A1="ABC";IF(OR(B1=3601;B1=3602;B1=3603;B1=3700);"";1);"") 
```

下图中有一个错误（单元格移动），上面的公式是正确的。

![在此处输入图像描述](../Images/1a5eb103e67d43e95c97be9c7d0dd7a8.png)

VBA：

```
Function CellCombination(Cell1 As Range, Cell2 As Range) As String
  CellCombination = ""
    If Cell1.Value = "ABC" Then
      Select Case Cell2.Value
        Case 3601 To 3603, 3700
        Case Else
          CellCombination = "1"
      End Select
   End If
End Function 
```

带有示例的电子表格：[http ://www.bumpclub.ee/~jyri_r/Excel/CellCombinations.xls](http://www.bumpclub.ee/~jyri_r/Excel/CellCombinations.xls)

# android - Android：设置自定义标题栏的背景可绘制对象

> ID：14489371
> 
> 赞同：0
> 
> 时间：2013-01-23T21:05:33.170
> 
> 标签：android, drawable

好吧，我想我遇到了一些错误。

LayerLists 中的位图似乎存在错误：http: [//www.michaelpardo.com/2011/10/repeating-bitmaps-inside-layerlists/](http://www.michaelpardo.com/2011/10/repeating-bitmaps-inside-layerlists/)

我有我想在我的自定义标题栏中用作背景可绘制的图层列表。

```
<style name="custom_titlebar_background">
<item name="android:background">@drawable/custom_titlebar_background</item>
</style> 
```

**编辑：** 要使用链接的解决方法，我需要以编程方式设置标题栏的背景，但我不知道如何。这似乎不起作用，它改变了整个屏幕的背景（包括实际的内容视图）：

```
LayerDrawable layer = (LayerDrawable)getResources().getDrawable(R.drawable.custom_titlebar_background);
        setLayerDrawableBitmapsRepeating(layer);
        getWindow().setBackgroundDrawable(layer); 
```

有什么方法可以引用自定义标题栏来调用 setBackgroundDrawable() 或任何其他方法来设置自定义标题栏的背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:25:03.647

像这样创建您的自定义标题栏：

`res/layout/mytitle.xml`- 这是代表​​标题栏的视图

```
<?xml version="1.0" encoding="utf-8"?>
<TextView
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/myTitle"
  android:text="This is my new title"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
/> 
```

`res/values/themes.xml`-

创建一个继承默认主题的主题，并将背景样式设置为我们自己的样式。

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="customTheme" parent="android:Theme"> 
        <item name="android:windowTitleBackgroundStyle">@style/WindowTitleBackground</item>   
    </style> 
</resources> 
```

`res/values/styles.xml`- 这是我们设置主题以使用您想要的背景作为标题背景的地方

```
<?xml version="1.0" encoding="utf-8"?>
<resources> 
   <style name="WindowTitleBackground">     
        <item name="android:background">@drawable/custom_titlebar_background</item>                   
    </style>
</resources> 
```

在 中`AndroidMANIFEST.xml`，在应用程序（针对整个应用程序）或活动（仅此活动）标签中设置主题属性

```
<activity android:name=".CustomTitleBar" android:theme="@style/customTheme" ... 
```

从 Activity（称为 CustomTitleBar）：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

        requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
        setContentView(R.layout.main);
        getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.mytitle);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T22:56:02.823

我找到了解决方案。它完全是肮脏的，并利用了无证成员。这至少对我有用，因为我的自定义标题栏仅在 2.x 设备上使用以获得类似 Holo 的外观。

似乎android标题视图始终具有相同的ID。

```
// http://stackoverflow.com/questions/820398/android-change-custom-title-view-at-run-time
        LayerDrawable layer = (LayerDrawable)getResources().getDrawable(R.drawable.custom_titlebar_background);
        setLayerDrawableBitmapsRepeating(layer);

        // get title view and set new background view
        try
        {
            // retrieve value for com.android.internal.R.id.title_container(=0x1020149)
            int titleContainerId = (Integer) Class.forName("com.android.internal.R$id").getField("title_container").get(null);
            View titleView = findViewById(titleContainerId);

            if(titleView != null)
            {
                titleView.setBackgroundDrawable(layer);
            }
        }
        catch(Exception e)
        {
            // nothing, just skip
        } 
```

只要您不做重要的事情并且您的应用程序在没有它的情况下仍然可以工作，我认为没有理由不使用此解决方法来修复旧 Android 版本上的可平铺位图。

# rabbitmq - 无法连接到 Cloudfoundry 微实例中的 RabbitMQ

> ID：14489372
> 
> 赞同：2
> 
> 时间：2013-01-23T21:05:34.093
> 
> 标签：rabbitmq, cloud-foundry

我有一个应用程序在 cloudfoundry.com 上运行了一段时间，部署到 api.cloudfoundry.com 时一切正常。我最近设置了一个 CF 微实例在云环境中进行本地测试，当我的应用程序部署到微实例时，它无法连接到我的兔子服务。我得到以下异常：

```
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.springframework.integration.MessageHandlingException: error occurred in message handler [org.springframework.integration.amqp.outbound.AmqpOutboundEndpoint#0]
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:894)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84)
...
org.springframework.integration.MessageHandlingException: error occurred in message handler [org.springframework.integration.amqp.outbound.AmqpOutboundEndpoint#0]
    org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:79)
    org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:115)
    org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:102)
...
org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection timed out
    org.springframework.amqp.rabbit.connection.RabbitUtils.convertRabbitAccessException(RabbitUtils.java:109)
    org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:163)
    org.springframework.amqp.rabbit.connection.CachingConnectionFactory.createConnection(CachingConnectionFactory.java:228)
    org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils$1.createConnection(ConnectionFactoryUtils.java:119)
    org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils.doGetTransactionalResourceHolder(ConnectionFactoryUtils.java:163)
    org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils.getTransactionalResourceHolder(ConnectionFactoryUtils.java:109)
    org.springframework.amqp.rabbit.connection.RabbitAccessor.getTransactionalResourceHolder(RabbitAccessor.java:100)
    org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:591)
    org.springframework.amqp.rabbit.core.RabbitTemplate.send(RabbitTemplate.java:329)
    org.springframework.amqp.rabbit.core.RabbitTemplate.convertAndSend(RabbitTemplate.java:385)
    org.springframework.integration.amqp.outbound.AmqpOutboundEndpoint.send(AmqpOutboundEndpoint.java:200)
    org.springframework.integration.amqp.outbound.AmqpOutboundEndpoint.handleRequestMessage(AmqpOutboundEndpoint.java:192) 
```

我不确定要看什么（我确定在微型实例中有一些东西我可以看，但不确定是什么），所以我想我会在这里问。

我已验证该服务存在：

```
vmc services
Getting services... OK

name                    service    version
xxx-mongo    mongodb    2.0    
xxx-mysql    mysql      5.1    
xxx-rabbit   rabbitmq   2.4 
```

我已验证该服务已绑定到我的应用程序：

```
vmc app myapp
myapp: running
  platform: spring on java
  usage: 512M × 1 instance
  urls: mydomain.cloudfoundry.me
  services: xxx-mysql, xxx-rabbit, xxx-mongo 
```

我什至试图重新绑定它，但它说它是绑定的：

```
vmc bind-service xxx-rabbit myapp
Binding xxx-rabbit to myapp... SKIPPED
App myapp already binds xxx-rabbit. 
```

我的应用程序是一个 Spring 应用程序。兔子服务的配置是这样设置的：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans  xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:cloud="http://schema.cloudfoundry.org/spring"
        xmlns:jdbc="http://www.springframework.org/schema/jdbc"
        xmlns:util="http://www.springframework.org/schema/util"
        xmlns:mongo="http://www.springframework.org/schema/data/mongo"
        xmlns:rabbit="http://www.springframework.org/schema/rabbit"
        xsi:schemaLocation="http://www.springframework.org/schema/data/mongo
          http://www.springframework.org/schema/data/mongo/spring-mongo-1.1.xsd
          http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit-1.0.xsd
          http://www.springframework.org/schema/jdbc
          http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd
          http://schema.cloudfoundry.org/spring
          http://schema.cloudfoundry.org/spring/cloudfoundry-spring.xsd
          http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
          http://www.springframework.org/schema/util
          http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <!-- MongoDB setup -->
    <mongo:db-factory
        id="mongoDbFactory"
        dbname="xxx"
        host="127.0.0.1"
        port="27017"
        username="test_user"
        password="test_pass"  />

    <bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg ref="mongoDbFactory" />
    </bean>

    <!-- Set up the AmqpTemplate/RabbitTemplate: -->
    <rabbit:connection-factory id="rabbitConnectionFactory"/>
    <rabbit:template id="rabbitTemplate" connection-factory="rabbitConnectionFactory"/>

    <bean id="jdbcDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <property name="url" value="jdbc:mysql://127.0.0.1:3306/test" />
        <property name="username" value="spring" />
        <property name="password" value="spring" />
    </bean>

    <jdbc:initialize-database data-source="jdbcDataSource">
        <jdbc:script location="classpath:oauthTokenStoreSchema.sql"/>
    </jdbc:initialize-database>
</beans> 
```

此配置依赖于 Spring 自动重新配置，据我所知，它工作正常。它不会在启动时抱怨，只有当我实际尝试向队列发送消息时，如下所示：

```
org.springframework.integration.Message<Message> msg = MessageBuilder.withPayload(m).build();
messagesChannel.send(msg); 
```

最后，我登录到微实例查看 rabbit 是否真的在运行，它似乎是：

```
vcap@micro:~$ ps -ef | grep rabbit
root      1492     1  0 Jan14 ?        00:17:00 ruby /var/vcap/packages/rabbit_node/services/rabbit/bin/rabbit_node -c /var/vcap/jobs/rabbit_node/config/rabbit_node.yml
root      1509     1  0 Jan14 ?        00:14:48 ruby /var/vcap/packages/rabbit_gateway/services/ng/rabbit/bin/rabbit_gateway -c /var/vcap/jobs/rabbit_gateway/config/rabbit_gateway.yml
root      1771  1492  0 Jan14 ?        00:14:36 /var/vcap/data/packages/erlang/3/lib/erlang/erts-5.8.2/bin/beam -W w -K true -A30 -P 1048576 -- -root /var/vcap/data/packages/erlang/3/lib/erlang -progname erl -- -home /var/vcap/store/rabbit/instances/d55204b5-814c-4c64-bd35-861d77ee927d -- -noshell -noinput -sname d55204b5-814c-4c64-bd35-861d77ee927d@localhost -boot /var/vcap/store/rabbit/instances/d55204b5-814c-4c64-bd35-861d77ee927d/plugins/rabbit -config /var/vcap/store/rabbit/instances/d55204b5-814c-4c64-bd35-861d77ee927d/config/rabbitmq -kernel inet_default_connect_options [{nodelay,true}] -rabbit tcp_listeners [{"10.0.1.21",10001}] -sasl errlog_type error -kernel error_logger {file,"/var/vcap/sys/service-log/rabbit/d55204b5-814c-4c64-bd35-861d77ee927d/d55204b5-814c-4c64-bd35-861d77ee927d@localhost.log"} -sasl sasl_error_logger {file,"/var/vcap/sys/service-log/rabbit/d55204b5-814c-4c64-bd35-861d77ee927d/d55204b5-814c-4c64-bd35-861d77ee927d@localhost-sasl.log"} -os_mon start_cpu_sup true -os_mon start_disksup false -os_mon start_memsup false -mnesia dir "/var/vcap/store/rabbit/instances/d55204b5-814c-4c64-bd35-861d77ee927d/mnesia" -smp disable
vcap     49299 49278  0 02:38 pts/0    00:00:00 grep --color=auto rabbit 
```

同样，当我部署到 api.cloudfoundry.com 时，该应用程序可以很好地连接到 rabbitmq。如果有帮助，我也在运行 v119 的 micro。

您能提供的任何帮助都会很棒！谢谢。

编辑：根据 Hitesh 的建议，我尝试使用云配置文件，但这不起作用。我也试过这个：

```
<beans profile="default">
        <rabbit:connection-factory
            id="rabbitConnectionFactory"
            host="localhost"
            password="testpwd"
            port="1238"
            username="testuser"
            virtual-host="virthost" />
        <rabbit:template id="rabbitTemplate" connection-factory="rabbitConnectionFactory"/>
    </beans>

    <beans profile="cloud">
        <cloud:rabbit-connection-factory id="rabbitConnectionFactory" />
        <rabbit:template id="rabbitTemplate" connection-factory="rabbitConnectionFactory"/>
    </beans> 
```

有趣的是，我尝试了这个（从文档中复制）：

```
<rabbit:connection-factory
    id="rabbitConnectionFactory"
    host="localhost"
    password="testpwd"
    port="1238"
    username="testuser"
    virtual-host="virthost" />
<rabbit:template id="rabbitTemplate" connection-factory="rabbitConnectionFactory"/> 
```

现在我的发送应用程序工作了！但我的接收应用程序仍然无法正常工作。它得到这个错误：

```
ERROR: main org.springframework.web.servlet.DispatcherServlet - Context initialization failed
org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.integration.amqp.inbound.AmqpInboundChannelAdapter#0'; nested exception is org.springframework.amqp.UncategorizedAmqpException: java.util.concurrent.TimeoutException: Timed out waiting for startup
    at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:170)
    at org.springframework.context.support.DefaultLifecycleProcessor.access$1(DefaultLifecycleProcessor.java:154)
    at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:339)
    at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:143)
    at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:108)
    at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:926)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:467)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:212)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1206)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4734)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1079)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:1002)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:506)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: org.springframework.amqp.UncategorizedAmqpException: java.util.concurrent.TimeoutException: Timed out waiting for startup
    at org.springframework.amqp.rabbit.connection.RabbitUtils.convertRabbitAccessException(RabbitUtils.java:118)
    at org.springframework.amqp.rabbit.connection.RabbitAccessor.convertRabbitAccessException(RabbitAccessor.java:106)
    at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:365)
    at org.springframework.integration.amqp.inbound.AmqpInboundChannelAdapter.doStart(AmqpInboundChannelAdapter.java:85)
    at org.springframework.integration.endpoint.AbstractEndpoint.start(AbstractEndpoint.java:84)
    at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:167)
    ... 39 more
Caused by: java.util.concurrent.TimeoutException: Timed out waiting for startup
    at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.getStartupException(SimpleMessageListenerContainer.java:512)
    at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doStart(SimpleMessageListenerContainer.java:337)
    at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:363)
    ... 42 more 
```

我已经尝试了上面的所有配置，但没有一个工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T00:47:50.713

我建议使用 rabbitmq 试用示例 spring 应用程序，它位于此处： [https](https://github.com/rabbitmq/rabbitmq-cloudfoundry-samples/tree/master/spring) ://github.com/rabbitmq/rabbitmq-cloudfoundry-samples/tree/master/spring 。还有一个分步文档可以帮助您完成它。您可以将那里的配置与您的应用程序进行比较，如果它有效，则意味着配置中可能缺少某些内容。此外，如果这没有帮助，那么您可以在此处发布问题“ [http://support.cloudfoundry.com](http://support.cloudfoundry.com) ”，让我们访问您的应用程序，以便我们自己尝试部署它。

谢谢，

*   希特什

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T21:17:17.413

我建议您尝试替换这些行：

```
<!-- Set up the AmqpTemplate/RabbitTemplate: -->
<rabbit:connection-factory id="rabbitConnectionFactory"/> 
```

和 ：

```
<!-- Obtain a connection to the RabbitMQ via cloudfoundry-runtime: -->
<cloud:rabbit-connection-factory id="connectionFactory"/> 
```

后一种情况是使用将读取兔子的云命名空间-

# php - 检查文件是否在 html 上传表单中？

> ID：14489373
> 
> 赞同：1
> 
> 时间：2013-01-23T21:05:34.657
> 
> 标签：php, file

好的，我找不到一个好的答案，我如何检查一个文件是否真的用 php 放入了文件上传 html 表单中？

正在做

```
if (isset($_FILES['new_image'])) 
```

总是返回它已设置，所以这不好。任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:08:54.700

您只需要以下代码：

```
if(isset($_FILES['new_image'])) {
    // code to execute
} 
```

或者，

```
if(isset($_FILES['new_image']) && $_FILES['new_image']['size'] > 0) {
    // code to execute
} 
```

...并且您的表单标签应至少包含

```
<form enctype="multipart/form-data">

</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:07:59.570

您可能会添加 && $_FILES['new_image']['name'] != ''

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:13:51.313

[在 php 中，您可以使用 GD 的imagecreatefromstring](http://php.net/manual/en/function.imagecreatefromstring.php)检查字符串是否为图像。

`false`如果图像不受支持，此函数会返回，因此您也可以检查图像是否有效。

# linux - 多线程和多tcp连接

> ID：14489378
> 
> 赞同：1
> 
> 时间：2013-01-23T21:06:03.733
> 
> 标签：linux, sockets, tcp, pthreads

我有一个具有多个线程的应用程序，一个线程正在创建 4 个 tcp 连接，然后该线程创建另一个线程，该线程将使用 poll 或其他任何方法处理这 4 个连接的接收函数，并且原始线程（第一个）开始发送消息到这 4 个连接（循环）。就像下面的伪代码一样，

```
main()
{

    pthread_create( &thread1, NULL, sending_thread, (void*) args);

}

void *sending_thread( void *ptr )
{
    int i=0;
    int *connections;
    connections = create_connections();

    pthread_create( &thread1, NULL, receiving_thread, (void*)&connections);
        while(1) {

        send(connections[i], "test"); 
        i++;
        if (i > 3)
        i=0;             

        }
}

void *receiving_thread( void *ptr )
{
    char *msg; 
        msg = receive(connections[i]);
        save_received_msg_to_disk(msg);

} 
```

我的问题是如何检查我的连接并打开断开的连接？例如，假设connection1出现故障，我是否需要使用相同的fd创建另一个连接，在这种情况下是connection[1]？还是有其他方法可以处理这种情况？

环境是Linux中的C/pthread

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T14:07:02.793

以下是基于您的代码和注释的一些要点。

*   虽然线程确实允许一些事情并行发生，但它们通常具有非零成本，涉及更多涉及的设计，总是归结为同步。就像您的情况一样，没有简单的方法可以重新建立其中一个连接并再次在两个线程之间共享它。
*   我从未见过输入和输出流完全独立的应用程序。我可以想象像隧道代理或基于 TCP 的 VPN 之类的东西，这可能是有意义的，但在一般情况下，一些更高级别的协议仍然会施加一些请求-响应语义，这再次会在发送和接收线程之间施加/要求仲裁。
*   当您需要*吞吐量*和尝试最小化*延迟*时，情况会有所不同。在互斥锁上等待睡眠通常对前者来说是可以的，但对后者来说很少是一个好主意。从单个线程循环写入多个阻塞套接字会伤害两者。
*   如果您有大量的输出流和稀疏的输入，那么只有使用类似[`epoll(7)`](http://www.kernel.org/doc/man-pages/online/pages/man7/epoll.7.html)检测饱和连接并在它们再次可用时收到通知然后饿死其他连接才有意义。

我知道这不能直接回答你的问题，但我的~~咆哮~~列表不适合评论。希望这有所帮助。

### 编辑0：

这是通常的设置[`epoll(7)`](http://www.kernel.org/doc/man-pages/online/pages/man7/epoll.7.html)：

*   使您的套接字非阻塞（[`fcntl(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl.2.html)with `O_NONBLOCK`）。
*   设置`epoll_data.fd`为每个潜在通道的套接字描述符（在您的示例中为四个套接字）。`union epoll_data`如果您想保留更复杂的结构，那么其他选项是可能的，而只是套接字描述符。
*   使用`EPOLLIN`and`EPOLLET`获得*边缘触发*行为，即当输入缓冲区不为空时被唤醒。
*   仅`EPOLLOUT`当您`EWOULDBLOCK`从 a获取时才设置`write(2)`，否则照常输出。此处与`EPOLLET`检测输出缓冲区空间可用的逻辑相同。
*   用于`EPOLLRDHUP`检测另一端是否干净断开（对于突然断开，您需要处理`EPIPE`错误表单`write(2)`）。
*   `epoll_wait(2)`为您提供要迭代的事件数量。分别检查输入 ( `events & EPOLLIN`) 和输出 ( `events & EPOLLOUT`)。
*   在从`data.fd`（或以其他方式关联的套接字）读取输入时，直到获得`EWOULDBLOCK`.
*   在输出写入之前，直到您获得`EWOULDBLOCK`或您没有更多待处理的输出数据（`EPOLLOUT`在这种情况下删除）。

它看起来很多，但是一旦你掌握了它就非常简单。

你也可以做 non-blocking [`connect(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/connect.2.html)，如果你想重新建立中断的流而不伤害其他仍在运行的流，这可能是一个好主意（返回`connect(2)`set to并且你等待套接字变成可写的，如上）。`-1`[`errno(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/errno.3.html)`EINPROGRESS`

# android - sharedpreferences 不读取按钮状态

> ID：14489384
> 
> 赞同：2
> 
> 时间：2013-01-23T21:06:48.877
> 
> 标签：android, eclipse, onclick, sharedpreferences, togglebutton

当应用程序被杀死并通过 重新启动时，我正在尝试保存切换按钮的状态`SharedPreferences`。

我可以看到`/data/data/myapp/shared_prefs`值 true/false 的 xml 被写入，但我坚持让代码在每次我杀死并重新启动应用程序时读取首选项。

该按钮只是重置为默认状态，在我的情况下是真的。就我而言，我在一个片段上运行它；所以我不得不使用：

`final SharedPreferences preferences = this.getActivity().getSharedPreferences("tg1pref",0);`

这是我的代码：

```
boolean on;
public SharedPreferences preferences;

final ToggleButton toggleButton1 = (ToggleButton) v.findViewById(R.id.toggleButton1);

    final SharedPreferences preferences = this.getActivity().getSharedPreferences("tg1pref",0);
    boolean tg1pref = preferences.getBoolean("tg1pref", true);
    if (tg1pref = true) {
        toggleButton1.setChecked(true);
    } else {
        toggleButton1.setChecked(false);
    }

    toggleButton1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
        if((toggleButton1.isChecked())) {
                    SharedPreferences.Editor editor = preferences.edit();
                    editor.putBoolean("tg1pref", true); // value to store
                    editor.commit(); 
        } else {
                    SharedPreferences.Editor editor = preferences.edit();
                    editor.putBoolean("tg1pref", false); // value to store
                    editor.commit();
            }
        }
    }); 
```

谢谢您的帮助！

**用 t0mm13b 方法解决：**

```
 if (tg1pref = true) {

//That should be:

    if (tglpref){ // Meaning and same as if (tglpref == true) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:10:33.250

这一行：

```
if (tg1pref = true) { 
```

那应该是：

```
if (tglpref){ // Meaning and same as if (tglpref == true) 
```

里面有错别字！

# c# - 如何防止在离屏时绘制 XNA 组件？

> ID：14489395
> 
> 赞同：5
> 
> 时间：2013-01-23T21:07:27.667
> 
> 标签：c#, performance, xna, drawablegamecomponent

我正在 XNA 中制作 2d 游戏。使用可绘制游戏组件时，哪一个更具有性能？

1.当一个组件不在屏幕上时，从组件列表中删除它，当它在屏幕上时添加它。

2.当它的屏幕外不运行它的绘图函数时（通过使用“唤醒”布尔字段和围绕绘图函数中所有内容的 if 语句）

我目前正在使用方法2，效果很好。它很方便，因为组件的draworder不会改变（如果我删除并重新添加它们会改变，我需要更多代码来管理它）事实上我只是想到如果它不在组件列表中它不会更新我需要其他东西来跟踪它是否在屏幕上..

另外我没有带有分析器的视觉工作室的精美版本，所以我只是在这里问人们从他们的经验中的想法

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-24T14:11:57.470

在使用 SpriteBatch 时，有时会被忽视的 CPU 性能概念是批处理 sprite 的方式。并且使用可绘制游戏组件并不容易有效地批处理精灵。

基本上，GPU 绘制精灵并不慢，而 CPU 将所有精灵组织成一个批次并不慢。缓慢的部分是 CPU 必须与 GPU 通信它需要绘制的内容（向其发送批处理信息）。当您调用 spriteBatch.Draw() 时**，不会发生**这种 CPU 到 GPU 的通信。当您调用 spriteBatch.End() 时会发生这种情况。因此，效率低下的果实是调用 spriteBatch.End() 的频率较低。（当然，这意味着调用 Begin() 的频率也更低）。此外，非常谨慎地使用 spriteSortMode.Imediate，因为它会立即导致 CPU 将每个精灵信息发送到 GPU（慢）。

因此，如果您在每个游戏组件类中调用 Begin() 和 End()，并且有许多组件，那么您会不必要地花费大量时间，与担心屏幕外精灵相比，您可能会节省更多时间来提出更好的批处理方案.

另外：无论如何，GPU 都会自动忽略其像素着色器中的屏幕外精灵。所以在 CPU 上剔除屏幕外精灵不会节省 GPU 时间......

# php - PHP下拉列表仅选择列表中的最后一项

> ID：14489396
> 
> 赞同：-2
> 
> 时间：2013-01-23T21:07:37.317
> 
> 标签：php, html

好的，所以我有这个页面，我希望下拉列表包含来自 json 提要的所有内容。只是“标签”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:20:40.307

```
<select name="items">  
<?php
$arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/paper_items.json"),true);
$str = '';
foreach($arr as $item) {

$label = $item['label'];       
$str .= "<tr><td style='text-align: center !important;'><b>Name:</b> $label</td>";
echo "<option class=\"selection\" value=\"$label\">$label</option>";
}
?>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:27:34.467

您正在将 $label 的内容输出到下拉列表。在 foreach 循环结束时，只有最后一个标签存储在 $label 中。因此，仅显示最后一个标签。

相反，在循环内生成 <option>label</option> 标签并将其附加到 $label。当然，在进入循环之前用空字符串初始化 $label。

# django - 南方，如何从 CharField 迁移到 ForeignKey？

> ID：14489400
> 
> 赞同：6
> 
> 时间：2013-01-23T21:07:54.200
> 
> 标签：django, casting, django-south, database-migration

该模型：

```
class ListContext(models.Model):
    content = models.CharField(max_length=200, blank=True) 
```

我使用 south 来管理模式迁移。

现在我将以前的模型更改为这个：

```
from django.contrib.contenttypes.models import ContentType

class ListContext(models.Model):
    content = models.ForeignKey(ContentType, blank=True, null=True) 
```

对于迁移：

```
$ python manage.py schemamigration --auto page 
 ~ Changed field content on page.ListContext
 + Added index for ['content'] on page.ListContext
Created 0010_auto__chg_field_listcontext_content.py. You can now apply this migration with: ./manage.py migrate page 
```

一切都很好，直到这一点：

```
$ python manage.py migrate page 
Running migrations for page:
 - Migrating forwards to 0010_auto__chg_field_listcontext_content.
 > page:0010_auto__chg_field_listcontext_content
FATAL ERROR - The following SQL query failed: ALTER TABLE "page_page_listcontext" ALTER
COLUMN "content_id" TYPE integer, ALTER COLUMN "content_id" DROP NOT NULL, ALTER COLUMN
"content_id" DROP DEFAULT;

The error was: column "content_id" cannot be cast to type integer

Error in migration: page:0010_auto__chg_field_listcontext_content 
```

我可以猜到错误发生在从 string 转换为 int 的过程中，但是我怎样才能避免这种情况并完成迁移呢？

有什么区别吗，我不在乎保留存储在表中的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:29:40.317

如果您手动编辑 forwards 功能：

重命名列：

```
db.rename_column('sometable', 'content', 'content_old') 
```

然后将您的列添加回来：

```
db.add_column('sometable', 'content', self.gf('django.db.models.fields.IntegerField')(default=0)) 
```

然后通过查找 id 执行更新新字段的查询。

```
db.execute("""
  UPDATE sometable SET content =
  (SELECT FKTable.id FROM FKTable
  WHERE (FKTable.content = sometable.content_old AND
  sometable.content_old != '')
  OR (FKTable.content = 'none' AND sometable.content_old = '')) --Maybe cut the OR out
""") 
```

然后，您必须做一些花哨的事情才能使向后正常工作。

# jquery - 电子邮件有效时动态显示提交按钮

> ID：14489401
> 
> 赞同：3
> 
> 时间：2013-01-23T21:07:56.543
> 
> 标签：jquery

我确信这应该很容易，但我无法让它工作。

html

```
<label for="email">Enter email for updates:</label>
<input type="text" name="email" id="email" placeholder="your@email.com" />
<button name="submit" type="submit">Submit</button> 
```

js

```
$(document).ready(function() {

  $('button').hide();

  $('input').keyup(function() {
    if( !validateEmail(email) ){ 
      $('button').show();
    }
  };

  function validateEmail(email) {
    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
    return emailReg.test( email );
  }

}); 
```

我并不是在寻找它是最好的电子邮件验证，而只是一种在表单看起来正确时向用户展示的简单方法。

感激地收到任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T21:09:46.947

5个问题：

1.  语法错误（当某些东西不起作用时，你应该看看你的[控制台）](https://developers.google.com/chrome-developer-tools/docs/console)
2.  当输入不再有效时，您不会使按钮消失
3.  你并没有真正测试输入（感谢 Eli）
4.  您不检查“电子邮件”是否为空
5.  您的正则表达式拒绝了一些有效的电子邮件（尝试`"valid email"@example.com`）

我对前四个问题的建议：

```
 $('button').hide();
  $('input').keyup(function() {
    if( validateEmail($(this).val()) ){ 
      $('button').show();
    } else {
      $('button').hide();
    }
  });

  function validateEmail(email) {
    if (!email) return false;
    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
    return emailReg.test( email );
  } 
```

[示范](http://jsbin.com/ipawiy/1/)

对于最后一个问题，我建议您阅读[Stop Validating Email Addresses With Your Complex Regex](http://davidcel.is/blog/2012/09/06/stop-validating-email-addresses-with-regex/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:13:22.373

协助dystroy所说的，存在语法错误。但此外，您`email`在调用`validateEmail`. 根据史蒂夫的评论，我还使核心更加具体。这是更新的代码。

```
$('#email').keyup(function() {
    var email = $(this).val();

    if(validateEmail(email) ){ 
      $('button[type="submit"]').show();
    }
    else {
      $('button[type="submit"]').hide();
    }

  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:32:54.903

感谢 dystroy、Eli Gassert 和 danronmoon。你们在这里指出了许多不同的错误。供将来参考，这是您现在对我有用的不同修复程序中的代码：

```
$('button').hide();

$('input').keyup(function() {
    var email = $('#email').val();

    if( validateEmail(email)){ 
        $('button').show();
    } else {
        $('button').hide();
    }
});

function validateEmail(email) {
    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
    return emailReg.test(email);
} 
```

# r - Epanechnikov（内核）的反函数

> ID：14489404
> 
> 赞同：2
> 
> 时间：2013-01-23T21:08:03.107
> 
> 标签：r, inverse

我已经估计了一些具有“密度”的数据并将内核设置为 Epanechnikov，是否有一个反函数可以检索到估计为他的原始值的值？

```
set.seed(1)
data<-rnorm(518,10,3)
hist(data)

data_E<-density(data,bw="sj",kernel="epanechnikov")
hist(data_E$y)

k<-quantile(data_E$y, 0.95)
k 
```

在上面公开的示例中，我有一个样本大小 518，由此我通过内核方法（Epanechnikov）估计了密度，之后我想找到这个“新数据”中某个元素的值的“原始数据”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:36:27.000

否。您在估计密度的过程中删除了信息。例如，该`density`函数不存储其输入`ecdf`。

编辑。我也许可以软化一点。您可以使用密度信息来重建原始值的粗略估计。您需要知道返回的对象中记录的样本大小，然后使用估计值生成新数据。积分密度，沿其支持范围平均分割累积概率函数，您可以构建经验分位数估计。

# php - 如何仅排除某个类别中的最新帖子以显示在 WordPress 的首页上？

> ID：14489422
> 
> 赞同：1
> 
> 时间：2013-01-23T21:08:55.810
> 
> 标签：php, wordpress

我只希望从首页中排除该类别的最新帖子。应显示同一类别的所有其他人。我似乎无法弄清楚这一点。这是我到目前为止得到的，但它不包括首页的整个类别。

```
function exclude_category2($query) { 
if ( $query->is_home ) { 
$query->set('cat', '-1,-4,-36'); 
} 
return $query; 
} 
add_filter('pre_get_posts', 'exclude_category2'); 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:04:55.827

You could use some hook like `template_redirect` to remove the top element from the global $posts array using `array_shift` like gok suggests (somewhat, he didn't really say how to do it). In that case it would look like this

```
add_action( 'template_redirect', function() {
    global $posts;
    array_shift( $posts );
}); 
```

But I think a more elegant approach would be this

```
add_action( 'loop_start', function( $args ) {
    $args[0]->next_post();
}); 
```

If you put this in functions.php, at the beginning of the Wordpress loop, it will automatically go to the next post which means it will skip the first post always.

If you want to do this only on certain pages, use the relevant template tag like `is_home()` inside the function. `if ( is_home() ) $args[0]->next_post();`.

If you are not using PHP version >= 5.3 you will have to give the function a name, since lower versions of PHP do not support anonymous functions.

# wcf - 您可以在 azure acs 中同时拥有客户端证书安全性和服务身份认证吗

> ID：14489423
> 
> 赞同：7
> 
> 时间：2013-01-23T21:09:15.403
> 
> 标签：wcf, security, azure, certificate, acs

我们有一个 WCF 服务，它需要 azure 的 acs 服务提供的令牌，并且 acs 被配置为使用内置的服务标识进行身份验证。

我们是否也可以只允许通过客户端证书身份验证访问该服务（因此只有安装了证书的客户端才能调用该服务）而且还提供用户名和密码以提供给 acs 服务以获取 acs 服务提供的令牌为服务（并最终为其他用户）建立声明

还是其中之一？

我们最终还将使用 https 作为服务，以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T03:12:50.937

您应该能够通过在 ACS 中设置多个服务身份来做到这一点，一个用于用户名和密码，一个用于证书。

参考：

[http://msdn.microsoft.com/en-us/library/windowsazure/gg185924.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg185924.aspx)

[http://msdn.microsoft.com/en-us/library/windowsazure/hh289316.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh289316.aspx)

[http://msdn.microsoft.com/en-us/library/windowsazure/gg185954.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg185954.aspx)

# python - 如何使用 Python Nose 测试自定义异常、消息

> ID：14489424
> 
> 赞同：2
> 
> 时间：2013-01-23T21:09:16.917
> 
> 标签：python, exception-handling, nose

**我的自定义异常类：**

```
class MyCustomException(Exception):
    pass

class MyCustomRestException(MyCustomException):

    def __init__(self, status, uri, msg=""):
        self.uri = uri
        self.status = status
        self.msg = msg
        super(MyCustomException, self).__init__(msg)

    def __str__(self):
        return "HTTP ERROR %s: %s \n %s" % (self.status, self.msg, self.uri) 
```

**我的测试**

```
# note: @raises(MyCustomRestException) works by itself
@raises(MyCustomRestException, 'HTTP ERROR 403: Invalid User')
def test_bad_token():
    sc = SomeClass('xxx', account_number)
    result = ec.method_that_generates_exception() 
```

**这是鼻子吐出来的东西**

```
12:52:13 ~/sandbox/ec$ nosetests -v
Failure: AttributeError ('str' object has no attribute '__name__') ... ERROR

======================================================================
ERROR: Failure: AttributeError ('str' object has no attribute '__name__')
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/site-packages/nose/loader.py", line 390, in loadTestsFromName
    addr.filename, addr.module)
  File "/usr/local/lib/python2.7/site-packages/nose/importer.py", line 39, in importFromPath
    return self.importFromDir(dir_path, fqname)
  File "/usr/local/lib/python2.7/site-packages/nose/importer.py", line 86, in importFromDir
    mod = load_module(part_fqname, fh, filename, desc)
  File "/ec/tests/my_client_tests.py", line 16, in <module>
    @raises(MyCustomRestException, 'HTTP ERROR 403: Invalid User')
  File "/usr/local/lib/python2.7/site-packages/nose/tools/nontrivial.py", line 55, in raises
    valid = ' or '.join([e.__name__ for e in exceptions])
AttributeError: 'str' object has no attribute '__name__'

----------------------------------------------------------------------
Ran 1 test in 0.012s

FAILED (errors=1) 
```

**所以 ...**

我的问题有两个：

*   如何修复此错误？
*   我如何测试（单独或全部）：
    *   异常类型
    *   异常状态
    *   异常.uri
    *   异常.msg

**解决方案：在 alynna 的帮助下（下）**

这很好用。

```
def test_bad_token():
    sc = SomeClass('xxx', account_number)

    with assert_raises(MyCustomRestException) as e:
        sc.method_that_generates_exception()

    assert_equal(e.exception.status, 403)
    assert_equal(e.exception.msg, 'Invalid User') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:14:31.313

我认为您的问题是 @raises 装饰器的参数都应该是异常类：[https ://nose.readthedocs.org/en/latest/testing_tools.html#nose.tools.raises](https://nose.readthedocs.org/en/latest/testing_tools.html#nose.tools.raises)

您可能需要 assertRaises 代替。文档显示它用于测试异常的额外属性：http: [//docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises](http://docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:27:20.633

Nose 的`@raises`装饰器不支持检查异常类以外的任何内容。传递更多参数意味着您希望允许将更多类型的异常解释为有效。因此，Nose 将您传递的字符串解释为异常并且找不到它的`__name__`. （见[文档](https://nose.readthedocs.org/en/latest/testing_tools.html#nose.tools.raises)）

要修复它，您可以为您的自定义异常实现额外的装饰器，例如：

```
from nose.tools import eq_
from functools import wraps

def raises_custom(status=None, uri=None, msg=None):
    assert status or uri or msg, 'You need to pass either status, uri, or msg'
    def decorator(function):
        @wraps(function)
        def wrapper(*args, **kwargs):
            try:
                function(*args, **kwargs)
            except MyCustomException, e:
                def check(value, name):
                    if value:
                        eq_(getattr(exception, name), value)
                check(status, 'status')
                check(uri, 'uri')
                check(msg, 'msg')
            except:
                raise
            else:
                message = "%{} did not raise MyCustomException".format(\
                    function.__name__)
                raise AssertionError(message)
        return wrapper
    return decorator 
```

然后像`@raises_custom(msg="HTTP ERROR 403: Invalid User")`.

（我没有测试上面的代码，只是想大致说明它的外观）

更新：正如 alynna 建议的那样，使用 assertRaises 可能更干净。尤其是如果您可以确定应该发生异常的特定位置会更好 - 而不是用装饰器包装整个函数。

# git - 如何让 git 读取模式更改？

> ID：14489425
> 
> 赞同：4
> 
> 时间：2013-01-23T21:09:25.680
> 
> 标签：git, permissions, git-svn, mode, folder-permissions

我已更改文件夹的权限，并希望将其推送到存储库。但是，git 无法识别权限更改。

知道为什么不以及如何解决吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:31:04.577

**Git & 目录模式：**

简而言之，您通常需要扩展来提交目录模式和权限。看到这个问题：

[git如何处理文件夹权限？](https://stackoverflow.com/q/1071241/1175253)--> [http://joeyh.name/code/etckeeper/](http://joeyh.name/code/etckeeper/)

**Git 和文件模式（仅限常规文件）：**

使用[git-config(1)](http://git-scm.com/docs/git-config)查看，git 是如何配置的：

`git config core.filemode`或`git config --global core.filemode`分别

`git config core.filemode true`将启用模式变化意识。

笔记：

*   任何本地设置都会覆盖相应的`--gobal`设置（如有疑问，我建议先更改本地配置）。
*   `core.filemode`仅适用于常规文件的 x 位。

也可以看看：

*   [如何让 Git 忽略文件模式 (chmod) 更改？](https://stackoverflow.com/q/1580596/1175253)
*   [如何在不接受所有文本更改的情况下使 git 接受模式更改？](https://stackoverflow.com/q/1611211/1175253)

# javascript - 从 Javascript 调用自定义活动来播放视频（java.lang.RuntimeException：无法暂停活动）

> ID：14489429
> 
> 赞同：1
> 
> 时间：2013-01-23T21:09:41.443
> 
> 标签：javascript, android, nullpointerexception, android-mediaplayer

我需要在不显示控件的情况下全屏播放视频。我创建了一个自定义活动来执行此操作。它正在工作，但发生了一些变化，现在当我尝试完成（）它时它崩溃了。

Javascript调用：

```
jiPlayVideo.PlayVideo('/sdcard/download/V2.3gp'); 
```

Javascript回调代码：

```
public class JavascriptInterface {

      //private WebView mAppView;
      private MainActivity mGap;

      public JavascriptInterface(MainActivity gap, WebView view)
      {
        mGap = gap;
      }

      public String PlayVideo(String myURL){
                      Intent intent = new Intent(mGap, VideoActivity.class);
                      Bundle b = new Bundle();
                      b.putString("myURL", myURL);
                      intent.putExtras(b); //Put your id to your next Intent
                      startActivity(intent);

                      return("");
      }
    } 
```

自定义活动：

```
package com.RGi.SynchedIn;

import org.apache.cordova.DroidGap;

import com.RGi.SynchedIn.MainActivity.JavascriptInterface;

import android.content.Intent;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.webkit.WebView;
import android.widget.VideoView;

public class VideoActivity extends DroidGap {
public static VideoActivity theVideoActivity;

@Override
public void onCreate(Bundle savedInstanceState) {         

   super.onCreate(savedInstanceState);
   super.init();

   theVideoActivity = this;
   setContentView(R.layout.videoview);

   VideoView v = (VideoView) findViewById(R.id.video);
   Bundle b = getIntent().getExtras();
   String myFolder =  b.getString("myURL");

   v.setVideoPath(myFolder);
   v.start();
   v.setOnCompletionListener(mCompletionListener);

}

private MediaPlayer.OnCompletionListener mCompletionListener =  
         new MediaPlayer.OnCompletionListener() {  
         public void onCompletion(MediaPlayer mp) { 
            finish();
         }  
     };  

     @Override
     public void onStart() {
         super.onStart();
     }

    @Override
     public void onResume() {
         super.onResume();
     }

     @Override
     public void onPause() {
         super.onPause();
     }

     @Override
     public void onStop() {
         super.onStop();
     }

    @Override
     public void onDestroy() {
         super.onDestroy();
     }

} 
```

我得到的错误是：

```
01-23 16:01:56.584: E/AndroidRuntime(7486): FATAL EXCEPTION: main
01-23 16:01:56.584: E/AndroidRuntime(7486): java.lang.RuntimeException: Unable to pause activity {com.RGi.SynchedIn/com.RGi.SynchedIn.VideoActivity}: java.lang.NullPointerException
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread.performPauseActivity(ActivityThread.java:2358)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread.performPauseActivity(ActivityThread.java:2315)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread.handlePauseActivity(ActivityThread.java:2295)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread.access$1700(ActivityThread.java:117)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:946)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.os.Looper.loop(Looper.java:130)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread.main(ActivityThread.java:3687)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at java.lang.reflect.Method.invokeNative(Native Method)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at java.lang.reflect.Method.invoke(Method.java:507)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at dalvik.system.NativeStart.main(Native Method)
01-23 16:01:56.584: E/AndroidRuntime(7486): Caused by: java.lang.NullPointerException
01-23 16:01:56.584: E/AndroidRuntime(7486):     at java.lang.String.indexOf(String.java:1145)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at org.apache.cordova.CordovaWebView.loadUrlNow(CordovaWebView.java:507)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at org.apache.cordova.CordovaWebView.loadUrl(CordovaWebView.java:392)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at org.apache.cordova.CordovaWebView.handlePause(CordovaWebView.java:907)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at org.apache.cordova.DroidGap.onPause(DroidGap.java:632)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at com.RGi.SynchedIn.VideoActivity.onPause(VideoActivity.java:59)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.Activity.performPause(Activity.java:3851)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.Instrumentation.callActivityOnPause(Instrumentation.java:1191)
01-23 16:01:56.584: E/AndroidRuntime(7486):     at android.app.ActivityThread.performPauseActivity(ActivityThread.java:2345)
01-23 16:01:56.584: E/AndroidRuntime(7486):     ... 12 more 
```

我在这里想念什么。这似乎是一个非常简单的活动，但每次都失败了 super.onPause。此外，如果我删除 OnCompletionListener() 中的完成并使用后退按钮，我会得到同样的错误。

谢谢

# javascript - 将组合器与 $(this) 一起使用

> ID：14489436
> 
> 赞同：1
> 
> 时间：2013-01-23T21:09:54.640
> 
> 标签：javascript, jquery, jquery-selectors

如何选择`$(this)`. 这些复杂的选择器并不是我真正的强项。我已经尝试使用组合器来获得它的兄弟姐妹`+`。但是把它和这个结合起来让我很困惑。`$(this`当我看到 a后跟 a时，我不明白`, something)`

`$(this, '+ input.in')``$(this)`没用，因为它似乎只选择与;相同的东西

[http://jsbin.com/oguhuv/2/](http://jsbin.com/oguhuv/2/)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:12:27.050

您可以简单地使用类似的东西：

```
$(this).next('input.in').children(selector) 
```

或者

```
$(this).next('input.in').find(selector) 
```

如果目标选择器不是`input.in`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T21:12:47.053

一旦你`this`担心了，你就不再真的只使用选择器了。您必须使用 jQuery API 告诉它在哪里寻找更多/不同的元素。根据具体情况，可以通过 、 或 查找兄弟`.next()`姐妹`.previous()`。`.parent().children(selector)`

该构造`$(this, selector)`几乎可以肯定是一个错误，但`$(selector, this)`与`$(this).find(selector)`.

*编辑*注意下面的评论指出这`.siblings(selector)`与`.parent().children(selector)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T21:15:58.253

要`this`用作选择器的[上下文](http://api.jquery.com/jQuery/#jQuery1)，您需要交换参数：`$('+ input.in', this)`. 此外，您忘记将 a`*`用于要选择输入子代的兄弟姐妹：

```
$('+ * input.in', this); 
```

（是的，这[确实有效](http://jsfiddle.net/JbaHu/)）。但是，使用 jQuery 方法来导航 DOM 会更清晰：

```
$(this).next().find("input.in") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T21:32:10.750

jQuery 中的 CSS 选择器用于过滤一组元素（例如`.filter()`, `.not()`）或查找后代元素（例如 $('.foo') 来搜索整个文档，$('foo', data) 来搜索另一个对象，比如 AJAX 响应，或者 someElement.find('.foo') 来搜索元素的内容）。在您的情况下，您有一个元素，并且它不包含目标元素，因此无论您使用什么选择器，这些都无法看到它。

但是，您对“兄弟”一词的使用暗示[了要使用的正确功能](http://api.jquery.com/siblings/)。找到所有兄弟姐妹后，您可以使用选择器过滤该列表；jQuery 让您一次性完成所有操作，因此您的示例将是`$(this).siblings('input.in')`

# excel - 用于维护数据包之间关系的 Excel 宏

> ID：14489440
> 
> 赞同：0
> 
> 时间：2013-01-23T21:10:03.857
> 
> 标签：excel, vba

这可能有点奇怪，但我正在围绕一个已经到位的系统工作，并且正在寻找一种在不重组数据的情况下进行改进的方法。

我拥有的是一个包含以下列和数据结构的电子表格。为格式道歉我不知道如何在这里更好地解释电子表格。

```
LocalizationPackId | TextValue | PageId | TargetId | ApplicationId
         1         |    xxx    |   1    |  AA1     |       1
         1         |    xxx    |   1    |  AB1     |       1
         2         |    xxx    |   1    |  AA1     |       1
         2         |    xxx    |   1    |  AB1     |       1
         3         |    xxx    |   1    |  AA1     |       1 
```

当然，真正的工作表在每个 LocalizationPack 中都有数百个条目。我正在寻找的是一种技术，用于验证包含在 LocalizationPackId = 1 中的 PageId + TargetId + ApplicationId 的任何唯一条目也包含所有后续本地化包中的镜像条目。

在上面的示例中，我希望 MACRO 在运行时检查任何缺失值。它会看到在 LocalizationPack 1 中有一个值 1/AB1/1，然后检查其他包的该值。然后它会发现 LocalizationPack 3 缺少 1/AB1，并从 LocalizationPack 1 创建一个镜像原始行的行，但具有正确的 LocalizationPackId 和 TextValue = "NEEDS LOCALIZATION"。理想情况下，新创建的行也将以红色突出显示。

我对宏没有任何经验，但我对 C# 相当了解。有人可以帮助我开始这方面的工作，或者给我指一个指南来展示完成此类事情所需的技术吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:44:32.687

我将从使用公式而不是宏来识别丢失的本地化包开始。如果 LocalizationPackId 在单元格 A1 中，其他标签在第 1 行，数据从第 2 行开始，那么第 2 行的合适公式为：

```
=COUNTIFS(C2:C$1000,C2,D2:D$1000,D2,E2:E$1000,E2)-(MAX(A2:A$1000)-A2+1) 
```

...然后可以将其复制到所有相关行（我已将公式带到第 1000 行，但它可以轻松达到您想要的程度）。

（编辑）

这是我的电子表格中的样子，上面的公式在 G 列中：

![在此处输入图像描述](../Images/123ee629796d6f272bf75e9632637359.png)

（编辑结束）

此公式的结果是与 PageId、TargetId 和 ApplicationId 的每个组合对齐的负数，它显示了在首次引入该本地化之后的包中缺少多少版本的本地化。

它不会告诉您哪个包缺少本地化，但是`=COUNTIF()`告诉您每个包中存在的本地化数量将为您指明正确的方向。

您可以使用 VBA 自动搜索以准确定义每个包中缺少哪些本地化，但是，如果您不经常这样做，那么编写和调试 VBA 代码可能比其价值更麻烦。上面的`=COUNTIFS()`公式将提供一个自动和持续的保证，即没有丢失本地化。

如果您经常这样做，那么该`=COUNTIFS()`专栏将是 VBA 代码自动化该过程的良好开端。

# c - 全局变量对于子进程和父进程是静态的吗？

> ID：14489441
> 
> 赞同：3
> 
> 时间：2013-01-23T21:10:06.543
> 
> 标签：c, linux

> **可能重复：**
> [分叉后，全局变量是否共享？](https://stackoverflow.com/questions/4298678/after-forking-are-global-variables-shared)

在我的 C 程序中，我将结构链表作为全局变量。然后我分叉了一个子进程。现在在子进程中如果我释放链表的一个节点，然后结束子进程。节点也会在父进程中消失吗？

当我尝试这个时，似乎节点仍然存在于父进程中......这是对的吗？为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T21:11:39.717

不，它不会在父进程中消失。正确的心智模式是孩子正在获得父母记忆**的独立副本**。这两个进程不共享内存（除非您明确设置[共享内存](http://en.wikipedia.org/wiki/Shared_memory)段并将数据放在那里）。

如果你使用[线程](http://en.wikipedia.org/wiki/Multithreading_%28software%29#Multithreading)而不是进程，情况就完全不同了。在同一进程中运行的线程确实共享地址空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T21:13:04.913

[`fork(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/fork.2.html)创建父虚拟地址空间的**副本**`struct`，因此除非您将这些s 放入共享内存中，否则它们是完全不相关的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T21:17:08.873

是的，它按预期工作，您不能从孩子（或来自父母的孩子）修改父母

这两个进程（父进程和子进程）是两个不同的进程，就像您的一个进程无法写入内存一样，例如，也在您的机器上运行的网络服务器，父进程无法写入子进程，反之亦然。

为了避免将父进程中的所有内容复制到子进程中，操作系统使用了一种称为“写时复制”的东西，其工作原理如下：当创建“子”进程时，代表父进程的页面被复制，并标记为“只读”。当发生写入时，操作系统会捕获该写入（这是不允许的，因为内存是只读的），并制作内存的副本，以便写入内存的进程作为它自己的内存副本 [并取消标记另一个进程上的“只读”，因此它现在可以修改数据，因为它具有原始内存内容]。

正如其他人所说，您可以通过使用“共享内存”（如果您愿意，也可以在完全独立的进程之间共享）来克服这个问题。

# scala - Set Content type of FakeRequest (PlayFramework 2.1 - RC2)

> ID：14489443
> 
> 赞同：1
> 
> 时间：2013-01-23T21:10:19.860
> 
> 标签：scala, playframework, playframework-2.0, playframework-2.1

I want to set content-type of Fake Request (Play 2.1-RC2). Following code doesn't work (an action receives application/octet-stream instead of application/pdf)

```
route(FakeRequest(POST,
                  controllers.routes.FilesController.filesEndpointPost().url,
                  FakeHeaders(Seq(CONTENT_TYPE->Seq("application/pdf"))),
                  AnyContentAsRaw(RawBuffer(1000,"brokenpdf".getBytes))
                 )
     ).get 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T07:40:25.920

这有效（内容类型仍然是 application/pdf）（注意：使用此代码来测试处理二进制流的操作）：

```
route(FakeRequest(POST,
                  controllers.routes.FilesController.filesEndpointPost().url,
                  FakeHeaders(Seq(CONTENT_TYPE->Seq("application/pdf"))),
                  "brokenpdf"))
      (new Writeable({s:String => s.getBytes}, None)
     ).get 
```

# ruby-on-rails - 使用 Devise、Omniauth 和 SoundCloud 登录

> ID：14489445
> 
> 赞同：3
> 
> 时间：2013-01-23T21:10:24.670
> 
> 标签：ruby-on-rails, devise, omniauth, soundcloud

我正在尝试使用 Devise 和 Omniauth 登录我的 Rails 应用程序。我已经安装了omniauth-soundcloud 和omniauth gems。我在 Soundcloud 中创建了一个应用程序：

```
name: sitename
url: http://127.0.0.1:3000
redirect_url: http://127.0.0.1:3000 
```

我按照类似于 Railscasts #235 的步骤操作，并创建了登录链接，但是当我单击时，我被重定向到以下 URL：

```
http://127.0.0.1:3000/?error=redirect_uri_mismatch&error_description=The+redirection+URI+provided+does+not+match+a+pre-registered+value.&state=e917179df8ad4e1e1cbef8f8b3d4497c59cf774853a78f94 
```

发生了什么？我应该为此忘记设计吗？谢谢！

编辑

对不起，我忘了删除 Gemfile 中的 'omniauth' gem。这造成了麻烦，一切运行都知道。

问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T18:56:34.627

如果您关注 Ryan Bate 的 Railscast - 这是 URI（开发） -`http://localhost:3000/users/auth/soundcloud/callback`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:23:07.293

这会是你的答案吗？向 soundcloud 注册新应用？

[重定向 URI 不匹配 iOS soundcloud](https://stackoverflow.com/questions/11728139/redirect-uri-mismatch-ios-soundcloud)

# wordpress - 仅由一页使用的 Wordpress 模板（可能不会成为模板）

> ID：14489448
> 
> 赞同：0
> 
> 时间：2013-01-23T21:10:44.530
> 
> 标签：wordpress

我只是在学习 WordPress 的基础知识，想知道如何做某事。

我理解模板的概念。我可以拥有多个运行单个模板的页面，以便整个站点具有一致的外观和感觉。

在 php 文件中，我将 product.php 声明为模板，其中包含如下代码：

```
/*
Template Name: Products
*/ 
```

然后，当我创建新页面时，它会在管理区域中作为模板选项提供给我。

但是，我很难理解的是以下内容。

有些页面的结构是完全独特的。我不希望他们跑掉模板。我想这背后的主要原因是最终用户可能会不小心覆盖管理部分中的模板，我希望尽可能将其保持在最低限度。

让我感到困惑的是，对于这样的页面，您是否还需要在 WP 管理部分中创建页面，或者，使用所需的任何方法，它会自动出现在页面部分下吗？

有人可以解释一下这将如何在 WordPress 中完成。

提前感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:17:58.957

WordPress 中的每个页面都将使用某种模板。如果它没有模板，那么你会很不走运，因为那样......你的数据会去哪里？为了不让您的客户破坏事情，您创建一个模板，以便他们只是编辑文本等，而不是涉足页面结构（我们将在您创建模板时将其留给您）。

我以前有过多达十个不同模板的网站。仅仅因为某些页面确实具有独特的信息架构。如果您需要一个模板，请不要害怕添加模板，因为有时确实没有其他方法可以走。

不确定这是否是最好的建议 - 但如果我真的担心我的客户会开始弄乱页面模板，我只会编写一些 javascript 来检查他们是否是管理员以及他们是否不是管理员隐藏允许他们更改模板的元素。

如果您不希望用户能够看到某些模板，或者您不希望他们能够看到特定的模板文件，您可以将其放在您的 functions.php 中：

```
function add_jquery_admin() {
    global $parent_file;

    // if editing page in WP admin and user is not an admin
    if ( isset( $_GET['action'] ) && $_GET['action'] == 'edit' && isset( $_GET['post'] ) && $parent_file == 'edit.php' && !current_user_can('manage_options')) {

        // remove the options for each of the templates on the template select element
        echo '
        <script>
            var q = jQuery.noConflict();
            q(function(){
                q("#page_template option[value=\"template-file-name-1.php\"]").remove();
                q("#page_template option[value=\"template-file-name-2.php\"]").remove();
                q("#page_template option[value=\"template-file-name-3.php\"]").remove();
            });
        </script>
        ';

        // get current post id
        $post_id = $_GET['post'];

        // if the post id 123, 1234, or 12345 
        if ( $post_id == 123 || $post_id == 1234 || $post_id == 12345 ) { // if on one of these post ids disable the template selector

            // disable the page template select element
            echo '
            <script>
            var j = jQuery.noConflict();
            j(function(){
                j("#page_template").attr("disabled", "disabled"); 
            });
            </script>
            ';
        }
    }
}

add_filter('admin_head', 'add_jquery_admin'); 
```

我没有测试，但我认为应该没问题。你只需要在你看到这些的地方切换模板文件名 - `q("#page_template option[value=\"template-file-name-1.php\"]").remove();`。

此外，您需要为您不希望他们看到模板选择元素的每个页面收集唯一的帖子 ID。您可以通过查看 URL 来获得它 - 它会`post=200`在 URL 中显示类似的内容。你要把这些放在这里—— `if ( $post_id == 123 || $post_id == 1234 || $post_id == 12345 )`。

我知道这看起来有点麻烦，但我真的想不出或找到任何其他解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:39:50.167

我希望其他人觉得这很有用。我还没有尝试过，但我刚刚发现，如果您创建一个名称约定为 page-.php 的文件，那么它将自动为带有该 slug 的页面加载。

我知道这必须是可能的。感谢您的所有贡献。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T21:20:21.007

就像凯尔说的那样。使用页面模板执行此操作。没有什么可失去的。创建 php 文件后，您可以通过 wp-admin 面板添加页面。

# solr - 如何在 solr4 中对存储在其他服务器上的 XML 文件进行索引

> ID：14489450
> 
> 赞同：3
> 
> 时间：2013-01-23T21:10:59.980
> 
> 标签：solr, dataimporthandler, data-import, solr4

我将所有 XML 文件都存储在另一台服务器上，并且我已经在不同的服务器上安装和配置了 SOLR。如何将这些 XML 文件索引到 SOLR。我已经检查过 nutch，但它的主要目的是抓取 html 页面并将它们编入索引。我不需要爬行。我在其他服务器上的特定路径上有所有这些文件。我只需要在 SOLR 中索引这些 XML 文件。我已经安装并配置了 SOLR4。

如果有人做过这样的事情，请告诉我该怎么做。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:21:15.257

为什么不从 Solr 服务器挂载驱动器，然后执行以下操作：

java -jar post.jar "Z:\home\data\delivery\textarticles.xml"

post.jar 位于 exampledocs 文件夹中。您也可以将其用作示例应用程序并构建您自己的应用程序以从其他服务器发布这些 xml 文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:15:33.433

看看[DataImportHandler](http://wiki.apache.org/solr/DataImportHandler#Example%3a_Indexing_wikipedia)。我认为如果设置了适当的权限，您应该能够访问网络文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T12:55:09.077

Based on your comment to Shane Alexander's answer, you will need to use the [URLDataSource](http://wiki.apache.org/solr/DataImportHandler#httpds) option of the DataImportHandler to retrive the file via a Url. Additionally, you will need to incorporate the patch from [SOLR-1490](https://issues.apache.org/jira/browse/SOLR-1490) to allow for authentication support.

# pattern-matching - 是否可以使用 SML 中的给定值进行模式匹配？

> ID：14489452
> 
> 赞同：0
> 
> 时间：2013-01-23T21:11:15.120
> 
> 标签：pattern-matching, sml

在 Scala 中是可能的，所以我想知道这在 SML 中是否也可能，考虑这样的代码：

```
fun in_list(elem,coll) =   
  case coll of
      [] => false
    | elem :: tail => true
    | head :: tail => in_list(elem,tail); 
```

在`case`我想使用`elem`from 参数的第二行中，但 SML 将其视为占位符并在冗余情况下抛出错误（第三行）。

那么 - 是否可以在`elem`这里使用，如果可以，如何使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:29:09.887

不，这是不可能的。您必须使用`if`：

```
fun in_list(elem,coll) =   
  case coll of
      [] => false
    | head :: tail =>
        if head = elem
        then true
        else in_list(elem,tail) 
```

或者，在这种情况下，您也可以使用逻辑运算符而不是`if`：

```
fun in_list(elem,coll) =   
  case coll of
      [] => false
    | head :: tail =>
        head = elem orelse in_list(elem,tail) 
```

# json - 在一个盒子里休息后端？

> ID：14489453
> 
> 赞同：3
> 
> 时间：2013-01-23T21:11:19.490
> 
> 标签：json, rest, angularjs, backend

我正在寻找像后端即服务这样的东西，但它可以是自托管的。这些是我正在寻找的基本功能：

*   身份验证/访问控制
*   JSON 支持
*   资源
*   基本业务逻辑支持
*   开源或易于扩展
*   应该与例如 angular.js 兼容

是否有任何 REST 后端实现可以做大部分的事情，比如后端作为服务提供者（kinvey 看起来不错）可以做，但我可以在 Intranet 上托管？

问候奥斯卡

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T03:22:43.407

我最近在一个个人项目中使用了 Deployd。它可能符合您正在寻找的东西：http: [//deployd.com/](http://deployd.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-02T04:33:06.000

虽然我还没有使用过，但也可以看看[Firebase](https://www.firebase.com/)和[Backand](https://www.backand.com/) ......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-25T15:13:46.283

the next thing i want to try is [Dreamfactory](http://www.dreamfactory.com/), from what i've read it's perfect for a Backend with REST API and fits good to an AngularJS Frontend.

maybe you'll give it a shot aswell.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-14T20:19:32.067

您可以查看[Divroll Backend](https://github.com/divroll/backend)，这是一个基于 Java 的后端平台，可通过其 REST 端点 API 与 Angular 或任何 Javascript 框架一起使用。

它可以自托管在任何服务器或应用程序服务器中，因为它是自包含的并且不需要外部模块（和数据库）。

# email - 带有 Javamail API 的消息号

> ID：14489455
> 
> 赞同：2
> 
> 时间：2013-01-23T21:11:23.227
> 
> 标签：email, imap, jakarta-mail

我想知道 JavaMail API 中的消息编号是如何工作的。他们总是按时间排序吗？

我想要做的是避免重新获取 gmail 文件夹上的标题。假设我有一个包含 20,000 条消息的文件夹，我今天要处理它。明天，有 100 条新消息，我不希望再次获取所有 20,000 个标头。我可以问一下 msg nums 吗？20,001 - 20,100？我认为这在以后的消息添加到文件夹的正常情况下会起作用。但是，如果用户使用 Thunderbird 之类的客户端手动将较早时间段的内容插入到文件夹中，情况会怎样呢？

[s]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:13:20.737

它是控制消息编号如何工作的服务器。基本上在所有情况下，消息编号都对应于将消息添加到邮箱的顺序。

例如，在您的收件箱中，这是**接收**消息的顺序。您的电子邮件客户端可能会按照发送顺序显示消息，这可能完全不同。

消息可能会从列表中删除，但消息永远不会插入到现有消息之前。如果您正在寻找新消息，您必须处理现有消息被删除、更改消息编号的情况。

请参阅 JavaMail UIDFolder 接口，以及它所基于的 IMAP 规范。如果您跟踪您看到的最后一个 UID，您只需要查看 UID 大于该 UID 的消息。还有更多细节，但这只是一个开始。阅读文档，如果您有任何问题，请告诉我。

# vb.net - 使用 EPPlus 的 Excel 工作表的标题

> ID：14489456
> 
> 赞同：5
> 
> 时间：2013-01-23T21:11:26.503
> 
> 标签：vb.net, excel, epplus, vba

我正在使用 EPPLus 从我的数据集中创建和格式化 Excel 表。我想使用 EPPlus 在 excel 表上设置标题。我找不到办法。我想设置左标题，右标题和中心标题。我已经使用 VBA 代码完成了这项工作，但我想摆脱它。在VBA中我会做

```
With ActiveSheet.PageSetup
.LeftHeader = ""
.RightHeader =""
.CenterHeader= ""
End With 
```

帮助！！谢谢

PS：我正在创建一个 winforms 应用程序。我不确定这是否会改变任何事情，只是想在这里提一下。谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-25T14:58:10.670

我终于弄明白了。

```
It can be done using 
workSheet.HeaderFooter.FirstHeader.LeftAlignedText = ""
workSheet.HeaderFooter.FirstHeader.RightAlignedText = ""
workSheet.HeaderFooter.FirstHeader.CenterAlignedText = "" 
```

这设置为第一页。`FirstHeader`将属性更改为`EvenHeader`并`OddHeader`设置 if 用于以下页面。

如果页面具有不同的标题，则有几个属性可以`differentFirst`设置。`differentOddEven`但是我无法通过将它们设置为 false 并仅设置其中一个标题来使其工作。必须分别设置所有三个。

希望有用 谢谢

# java - GSON：如何在保持循环引用的同时防止 StackOverflowError？

> ID：14489463
> 
> 赞同：12
> 
> 时间：2013-01-23T21:11:46.373
> 
> 标签：java, json, serialization, gson

我有一个带有循环引用的结构。出于调试目的，我想转储它。基本上和任何格式一样，但我选择了 JSON。

因为它可以是任何类，所以我选择了不需要 JAXB 注释的 GSON。

但是 GSON 命中循环引用并递归直到`StackOverflowError`.

我如何将 GSON 限制为

*   忽略某些班级成员？两者`@XmlTransient`皆不`@JsonIgnore`服从。

*   忽略某些对象图路径？例如，我可以指示 GSON 不要序列化`release.customFields.product`​​.

*   到最多2个级别的深度？

相关：[Gson.toJson 给出 StackOverFlowError，在这种情况下如何获得正确的 json？（公共静态类）](https://stackoverflow.com/questions/13460200/gson-tojson-gives-stackoverflowerror-how-to-get-proper-json-in-this-case-publ)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-23T21:16:40.853

只需使字段瞬态（如中`private transient int field = 4;`）。GSON 明白这一点。

**编辑**

无需内置注解；Gson 允许您插入自己的策略来排除字段和类。它们不能基于路径或嵌套级别，但注释和名称很好。

如果我想跳过“my.model.Person”类中名为“lastName”的字段，我可以编写如下排除策略：

```
class MyExclusionStrategy implements ExclusionStrategy {

    public boolean shouldSkipField(FieldAttributes fa) {                
        String className = fa.getDeclaringClass().getName();
        String fieldName = fa.getName();
        return 
            className.equals("my.model.Person")
                && fieldName.equals("lastName");
    }

    @Override
    public boolean shouldSkipClass(Class<?> type) {
        // never skips any class
        return false;
    }
} 
```

我也可以自己做注释：

```
@Retention(RetentionPolicy.RUNTIME)
public @interface GsonRepellent {

} 
```

并将方法重写`shouldSkipField`为：

```
public boolean shouldSkipField(FieldAttributes fa) {
    return fa.getAnnotation(GsonRepellent.class) != null;
} 
```

这将使我能够执行以下操作：

```
public class Person {
    @GsonRepellent
    private String lastName = "Troscianko";

    // ... 
```

要使用自定义排除策略，请使用构建器构建 Gson 对象：

```
Gson g = new GsonBuilder()
       .setExclusionStrategies(new MyOwnExclusionStrategy())
       .create(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-28T07:15:40.600

我知道这个问题已经有几年了，但我想为我的解决方案做出贡献。尽管@fdreger 的答案在您想**总是**排除一个字段的情况下是完全有效的，但如果您只想在某些情况下排除它，它就不起作用，避免这种递归。我解决问题的方法是：

1.  我自己写`JsonSerializer`。在其中，我定义了一个静态变量来控制同一个类的对象被序列化的次数，并且根据值，对象可以被序列化或不被序列化。

    ```
     import com.fasterxml.jackson.core.JsonGenerator;
     import com.fasterxml.jackson.core.JsonProcessingException;
     import com.fasterxml.jackson.databind.JsonSerializer;
     import com.fasterxml.jackson.databind.SerializerProvider;
     import java.io.IOException;

     public class UserJsonSerializer extends JsonSerializer<User> {

         private static final ThreadLocal<Integer> depth = new ThreadLocal<Integer>() {
            @Override
            protected Integer initialValue() {
                return 0;
            }
         };

         @Override
         public void serialize(User user, JsonGenerator generator, SerializerProvider provider) throws IOException, JsonProcessingException {
            // Here, we limit the number of instances to return. In this case, just 1.

            depth.set(depth.get() + 1);
            if(depth.get() >= 1) {
                generator.writeNull();
            } else {
                generator.writeObject(user);
            }
         }

         public static void clear() {
            depth.remove();
         }
    } 
    ```

2.  绑定`UserJsonSerializer`到你要控制的类

    ```
    public class SomeClass implements Serializable {
        @JsonSerialize(using = UserJsonSerializer.class)
        private User user;

       //...others fields...
    } 
    ```

3.  `UserJsonSerializer#clear()`每次要解析新实体时，不要忘记调用方法来重新初始化计数器。

我希望这有帮助。

# javascript - 为什么我的自定义 jQuery 函数不起作用？

> ID：14489468
> 
> 赞同：0
> 
> 时间：2013-01-23T21:12:18.597
> 
> 标签：javascript, jquery, function

我正在按照[本教程](http://docs.jquery.com/Tutorials%3aGetting_Started_with_jQuery#Plug_me%3a_Writing_your_own_plugins)尝试创建自定义 jQuery 函数，但出现以下错误：

> 未捕获的类型错误：对象 [object Object] 没有方法 'foobar'

使用以下代码：

```
 jQuery.fn.foobar = function(options) {
   var settings = jQuery.extend({
     value: 5, name: "pete", bar: 655
   }, options);
 };

$(document).ready(function() {
    $("p").foobar();
}); 
```

**编辑：** 我包括了。看来我有两次指向 jQuery 的链接。一次进入头部，一次进入身体：

```
<!DOCTYPE html>
<html lang="en">
  <head>
   <script src="/js/jquery.js"></script> 
  </head>
  <body>
    <p>Some text</p>

    <script type='text/javascript' src="/js/quiz.js"></script>
    <script src="/js/jquery.js"></script> 
</body>
</html> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:50:38.410

一段时间后，我发现我已经包含了两次 jQuery 的链接；一次在标题中，一次在正文中。我删除了正文中的链接，这解决了问题。

但是，在自定义代码之前包含 jQuery 很重要。请参阅此页面上的[问题 2 。](http://jquerybyexample.blogspot.com/2012/03/various-reasons-and-solutions-of-jquery.html)

# c# - Sitecore 实例需要来自其他项目的 DLL...？

> ID：14489469
> 
> 赞同：0
> 
> 时间：2013-01-23T21:12:19.233
> 
> 标签：c#, reflection, lucene, sitecore, sitecore6

好吧，伙计们，这个真的很奇怪：在为我的 Web 数据库重建 Lucene 索引时，我的 Sitecore 实例 (6.4.1) 正在打盹。查看日志文件，在索引重建开始之前，一切都很顺利，然后日志中充满了 MEGABYTES 的以下堆栈跟踪，一遍又一遍地重复：

```
ManagedPoolThread #6 15:57:06 ERROR Failed to sort items
Exception: System.IO.FileNotFoundException
Message: Could not load file or assembly 'file:///[OTHER PROJECT LIBRARY].dll' or one of its dependencies. The system cannot find the file specified.
Source: mscorlib
    at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
    at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
    at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)
    at System.Reflection.RuntimeAssembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean forIntrospection, Boolean suppressSecurityChecks, StackCrawlMark& stackMark)
    at System.Reflection.Assembly.LoadFrom(String assemblyFile)
    at Sitecore.Reflection.ReflectionUtil.LoadAssembly(String name)
    at Sitecore.Reflection.ReflectionUtil.CreateObject(String assembly, String className, Object[] parameters)
    at Sitecore.Reflection.ReflectionUtil.CreateObject(String typeName, Object[] parameters)
    at Sitecore.Data.Comparers.ComparerFactory.GetComparer(String sortingId, Database database)
    at Sitecore.Data.Comparers.ComparerFactory.GetComparer(Item item)
    at Sitecore.Configuration.Factory.GetItemComparer(Item item)
    at Sitecore.Data.Managers.ItemProvider.Sort(ItemList items, Item owner) 
```

（[OTHER PROJECT LIBRARY].dll 为保护隐私而被缩短，但它是该项目的 sitecore/website/bin 目录的完整路径）

真正奇怪的是，在解决方案或整个文件树（项目和网站文件夹）中都没有以任何方式、形状或形式引用此 DLL。

但关键是：这个 DLL 甚至不是来自同一个项目，它来自我在我的工作站上的另一个项目（它与这个项目一起在它自己的 Sitecore 实例中运行）。

这怎么可能发生？项目 A 试图从项目 B 中引用一个 DLL，而这个 DLL 没有以任何方式被引用。我什至检查了我数据库中的 EventQueue 表......我真的开始失去理智了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:13:36.380

查看附加的堆栈跟踪，您会发现问题在于 Sitecore 在对某些项目进行排序时尝试找到合适的比较器。看起来您的一项项目的**“类型”**字段设置为来自某个外部库的类名。也许有人从剪贴板粘贴了一些错误的类名并且没有注意到它？

尝试执行此查询以查找字段值设置错误的 Item 的名称和 id 以及字段的值：

```
SELECT 
    ii.Name, ii.ID, f.Value 
FROM 
    [Sitecore_Master].[dbo].[SharedFields] f,
    [Sitecore_Master].[dbo].[Items] i,
    [Sitecore_Web].[dbo].[Items] ii
WHERE f.FieldId = i.ID 
    AND i.Name = 'Type'
    AND ii.ID = f.ItemId
    AND f.Value LIKE '%[OTHER ASSSEMBLY NAME WITHOUT DLL].%' 
```

将数据库的名称更改为您的数据库并使用日志中显示的程序集的名称。您也可以在没有**AND i.Name = 'Type'**行的情况下尝试使用其他数据库进行此查询。

另一种方法是重写**ItemProvider**类，如下所示：

```
namespace My.Namespace
{
    public class MyItemProvider : Sitecore.Data.Managers.ItemProvider
    {
        protected override void Sort(Sitecore.Collections.ItemList items, Sitecore.Data.Items.Item owner)
        {
            try
            {
                base.Sort(items, owner);
            }
            catch (System.Exception exc)
            {
                Sitecore.Diagnostics.Log.Error("Exception while sorting children of " + owner.Paths.FullPath, exc, this);
            }
        }
    }
} 
```

并更改您的**sitecore.config**文件：

```
<itemManager defaultProvider="default">
    <providers>
        <clear/>
        <add name="default" type="My.Namespace.MyItemProvider, My.Assembly"/>
    </providers>
</itemManager> 
```

您现在应该在日志中看到导致问题的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T04:41:25.500

查看您的配置文件，看看您是否可以找到对这个神秘 DLL 的引用。

提示：浏览到 /sitecore/admin/showconfig.aspx 以查看来自主 web.config 的完整配置设置以及所有包含配置文件。我的预感是有一些自定义处理程序引用了索引重建后触发的 DLL

# mysql - mysql case/when语句在过程中

> ID：14489470
> 
> 赞同：0
> 
> 时间：2013-01-23T21:12:21.117
> 
> 标签：mysql, mysql-workbench

在第一个“;”之后我不断收到 1064 语法错误 在第一个 when 语句中。[我试图从这里](https://stackoverflow.com/questions/5167985/how-to-use-a-case-when-statement-in-a-mysql-stored-procedure)和[这里](https://stackoverflow.com/questions/12133272/what-is-wrong-with-my-mysql-case-when-syntax/12133343#12133343)获得提示都无济于事。帮助任何人？

```
DELIMITER //

CREATE PROCEDURE `test` ()
BEGIN
    SELECT *,
        case 
        when variable_1 between 0.75 and 4     then 4;
        when variable_1 between 0    and 0.74  then "<4";
        when variable_1 between 4.1  and 365  then ">4";
        end case as variable_2;
END // 
```

修改后的问题：

实际代码：

```
DELIMITER //

CREATE PROCEDURE `infant_outcomes`.`new_procedure` ()
BEGIN
SELECT * FROM CDI

        INNER JOIN

    -- CDI subquery grouping and filtering 
    (SELECT CDI.subj_CDI as subj_CDI_grouping, Min(hearing_age_CDI) min_hearing_age_CDI,
    case 
    when CDI.hearing_age_CDI between 1.75 and 4.25 then 3
    when CDI.hearing_age_CDI between 4.75 and 7.25 then 6

    end as hearing_age_CDI_group
    FROM CDI
    group by CDI.subj_CDI, hearing_age_CDI_group
    ORDER BY CDI.subj_CDI, CDI.hearing_age_CDI ASC) CDI_filtered

        on
            CDI.subj_CDI = subj_CDI_grouping
            AND CDI.hearing_age_CDI = CDI_filtered.min_hearing_age_CDI

    where hearing_age_CDI_group is not null
    ORDER BY 
    CDI.subj_CDI, CDI_filtered.hearing_age_CDI_group
END // 
```

我在“End //”处收到语法错误虽然以下两个答案的组合有效，但实际代码本身会引发该错误......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:14:24.043

因为你打破了声明。

```
SELECT *,
    case 
    when variable_1 between 0.75 and 4     then "4"
    when variable_1 between 0    and 0.74  then "<4"
    when variable_1 between 4.1  and 365  then ">4"
    end as variable_2; 
```

你错过了分号

```
ORDER BY 
CDI.subj_CDI, CDI_filtered.hearing_age_CDI_group;
                                                ^________ this. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:19:12.400

case 表达式以“end”结尾，而不是“end case”。

删除尾随的“案例”：

```
DELIMITER //

CREATE PROCEDURE `test` ()
BEGIN
    SELECT *,
        case 
        when variable_1 between 0.75 and 4     then 4;
        when variable_1 between 0    and 0.74  then "<4";
        when variable_1 between 4.1  and 365  then ">4";
        end as variable_2; -- "case" removed
END // 
```

# php - setcookie() 适用于本地主机，但不适用于我的在线服务器

> ID：14489473
> 
> 赞同：0
> 
> 时间：2013-01-23T21:12:25.857
> 
> 标签：php, cookies, setcookie

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我有一个问题`setcookie()`。在本地主机上它工作得很好，但是当我把它放到网上时它没有设置。

这是我的代码：

```
setcookie("blabcookie",$gebruiker->gebruiker_id,time()+6000,"/",".domain.be", 0); 
```

任何帮助，将不胜感激

# routing - 任何人都有关于复杂 Spinejs 路线的信息？

> ID：14489478
> 
> 赞同：2
> 
> 时间：2013-01-23T21:12:48.110
> 
> 标签：routing, spine.js

我有三个模型（专辑、歌曲、艺术家），我想得到一个特定类型的列表。现在这个应用程序的后端有一个 API 端点（/browse），它获取两个参数（grenre(s) 和项目类型（'album'、'song' 或 'artist'）并输出 JSON。

我不确定是否需要为每个模型提供单独的 api 端点来查询，或者是否可以使用我现在拥有的后端。

另外，有没有复杂路由的好例子？该网站上的示例非常基本......

我正在考虑类似 /browse/(albums | Artists | song)/genre+genre+genre/(rating | trending | listens) 之类的东西（这将是我将三个参数发送回服务器以获取项目类型，流派（多个是可选的，我必须在路线中做一些正则表达式）和sortby）。

更新：这就是我所拥有的。

```
var Chart = Spine.Controller.sub({
events: {
    'click .chart_clickthrough': 'chartNav',
    'change input.browse_switch': 'refreshChart',
    'change input.sort_switch': 'refreshChart'
},
browse: {
    url: '/api/chart',
    processData: true,
    data: {
        browse_object: 'song',
        sort: 'trending',
        genre: []
    }
},

init: function() {
    this.refreshChart();
},
render:function(model,sortby) {
    var items = model.all();
    if($('.chart_list').children.length > 0) {
        $('.chart_list').html('');
    }
    if(model) {
        //unbind the event for the model we aren't displaying. prevents the view from being updated too often
        Song.unbind('refresh');
        Artist.unbind('refresh');
        Album.unbind('refresh');

        model.bind('refresh', function() {
            chart.render(model,sortby);
        });
        for(var i = 0, l = items.length; i < l; i++) {
            //console.log(model.all()[i]);
            var template = $('#chartTpl').html(),
                data = items[i],
                html = Mustache.to_html(template, data);
            $('.chart_list').append(html);
        }
    }
},

refreshChart: function(e) {
    if(e) {
        e.preventDefault();
    }

    this.browse.data.browse_object = $('#BrowseOptions input[name=browse_object]:checked').val();
    this.browse.data.sort = $('#BrowseOptions input[name=sort]:checked').val();

    switch(this.browse.data.browse_object) {
        case 'album':   Album.fetch(this.browse);
                        this.render(Album,this.browse.data.sort);
                        break;
        case 'song':    Song.fetch(this.browse);
                        this.render(Song,this.browse.data.sort);
                        break;
        case 'artist':  Artist.fetch(this.browse);
                        this.render(Artist,this.browse.data.sort);
                        break;
    }
},

chartNav: function(e) {
    e.preventDefault();
    var attr = e.target.attributes,
        type = attr['data-type'].value,
        id = attr['data-id'].value,
        id2 = attr['data-album-id'].value;

    //console.log('clicked id: ' + id + ', type: ' + type + ', album id: ' + id2);
    if (type === 'Artist') {
        this.navigate('/artist',id);
    } else {
        var albumId = type === 'album' ? id : id2;
        this.navigate('/album', albumId);
    }

}
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T04:44:44.590

将多个客户端 Spine.js 模型指向单个服务器端路由应该没问题。在您的客户端代码中，您需要做的是在每个 Spine.js 模型中指定它们应如何形成 URL 以联系服务器：

请参阅 [http://spinejs.com/docs/ajax](http://spinejs.com/docs/ajax)，例如：

Contact.extend({ url: "/users" });

在服务器端，您需要分别支持 C/R/U/D 路由上的 POST/GET/PUT/DELETE 操作，并解析参数以确定预期的模型。

# css - 用非固定字体大小覆盖父元素固定字体大小

> ID：14489480
> 
> 赞同：2
> 
> 时间：2013-01-23T21:13:02.137
> 
> 标签：css

我可以用非固定字体大小覆盖父元素（例如 div）的固定字体大小吗？我有一个问题，对于特定的 HTML 页面，我希望元素使用相对于 Body 元素而不是相对于父 div 的字体大小。

我的 HTML

```
<body id="templateBody">
    <div>
         <p> 
```

我的 CSS

```
body{
  font-size: 76%
}

div{
  font-size:11px
} 
```

如何为 p 指定字体大小，以便它是 Body 字体大小的相对 (%age) 而不是固定的 div 字体大小？有没有办法在不改变 div 样式的情况下覆盖 div 的固定字体大小？我尝试使用 rem，但它在 IE8 上不起作用...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:45:13.650

你不能。一旦设置了父元素的字体大小，就无法引用父元素的父元素的字体大小。

除了浏览器支持问题之外，该`rem`单位还指*根*元素的字体大小，它始终是`html`HTML 文档中的元素。因此，如果将`body`字体大小设置为百分比，则可以*间接*将`p`字体大小设置为相对于它，但仅在将其设置为相对于根元素的字体大小的意义上。

在文档中混合 px 和 % 字体大小通常没有什么意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:44:19.267

不，不幸的是没有。

您将不得不修改 div 的字体大小。

# tsql - T-SQL - 按日期范围内的日期分组，两列计数

> ID：14489484
> 
> 赞同：2
> 
> 时间：2013-01-23T21:13:13.713
> 
> 标签：tsql, cross-join

我有一个问题跟踪数据库。我需要能够提供一个日期范围内每天打开和关闭的所有问题的报告。

我已经能够一次生成一列的结果......全部打开或全部关闭。我真的很想一次性完成所有工作，而不是在一份报告中分两部分提供结果。

有问题的列是 dteOpen (datetime)、dteClosed(datetime)。

## 这是我返回所有打开的东西。

```
Declare @dt1 datetime = '1/1/1900', 
Declare @dt2 datetime = '1/1/1900',
Declare @tT int = 0IF OBJECT_ID('tempdb..#TempDate') IS NoT NULL  
      DROP TABLE #TempDate

;WITH ctedaterange 
     AS (SELECT [rn]=Row_number() 
                       OVER( 
                         ORDER BY (SELECT NULL)) 
         FROM   sys.objects a 
                CROSS JOIN sys.objects b 
                CROSS JOIN sys.objects c 
                CROSS JOIN sys.objects d) 
SELECT CAST(Dateadd(dd, rn, @dt1) AS DATE) As DateRange
into #TempDate
FROM   ctedaterange 
WHERE  [rn] <= Datediff(dd, @dt1, @dt2)

Select td.DateRange,Count(ID)as countNumber 

from #TempDate td
LEFT outer JOIN tblProblemslist pl
ON CAST(pl.dtmOpen AS DATE) = td.DateRange
AND    dtmOpen between @dt1 and @dt2
AND ticketType = @tT
Group by td.DateRange
Order by td.DateRange 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:52:33.693

基本上，只需`tblProblemsList`再次加入，但有已关闭问题的条件。然后，您可以将另一个添加`COUNT`到您的查询中。

在不了解您的表结构的情况下，我猜您想要这样的东西：

```
DECLARE @from       datetime = '12/1/2012'; 
DECLARE @through    datetime = '12/31/2012';
DECLARE @then       datetime = DATEADD(dd, -1, @from);
Declare @ticketType int = 0;

DECLARE @dateRange  table
(
    dateRange   date
    , id        int IDENTITY
)

-- use a loop to populate the @daterange table var
-- rather than selecting from sys.object and
-- using a ranking function
WHILE   @then < @through
BEGIN
    INSERT INTO @dateRange (dateRange) VALUES (DATEADD(dd, 1, @then))
    SET         @then = DATEADD(dd, 1, @then)
END

SELECT      dateRange.dateRange
            , COUNT(listOfOpened.id) AS countOfOpened
            , COUNT(listOfClosed.id) AS countOfClosed
FROM        @dateRange AS dateRange
            LEFT OUTER JOIN tblProblemsList AS listOfOpened
                ON  CAST(listOfOpened.dtmOpen AS DATE) = dateRange.dateRange
                AND listOfOpened.dtmOpen BETWEEN @from AND @through
                AND listOfOpened.ticketType = @ticketType
            LEFT OUTER JOIN tblProblemsList AS listOfClosed
                ON  CAST(listOfClosed.dtmClosed AS DATE) = dateRange.dateRange
                AND listOfClosed.dtmClosed BETWEEN @from AND @through
                AND listOfClosed.ticketType = @ticketType
GROUP BY    dateRange.dateRange
ORDER BY    dateRange.dateRange 
```

# jquery - 自定义 json 请求中的无限滚动

> ID：14489491
> 
> 赞同：0
> 
> 时间：2013-01-23T21:13:27.420
> 
> 标签：jquery, json, load, scroll

我在这里胡乱猜测；因为我完全不知道我想要的是否可能。看看 WIP [http://www.mathijsdelva.be/2013](http://www.mathijsdelva.be/2013)。一切都很好，除了一些怪癖。不过，在智能手机/平板电脑上，一次加载我所有的镜头非常繁重，所以我正在考虑在我的网站上添加滚动加载功能。我什至不知道我应该如何开始编码；这超出了我的能力。当前代码：

```
$.getJSON('http://api.flickr.com/services/rest/?format=json&method=flickr.photosets.getPhotos&photoset_id=' + photoset_id + '&per_page=1000' + '&page=1' + '&api_key=' + apiKey + '&user_id=' + userId + '&jsoncallback=?', function (data) {
    $.each(data.photoset.photo, function (i, flickrPhoto) {
        var basePhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/' + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";
        var basePhotoURLMobile = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/' + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_z.jpg";
        var flickrLink = "http://www.flickr.com/photos/" + data.photoset.owner + "/" + flickrPhoto.id + "/";

        var $img = $("<img/>").attr("src", basePhotoURL);
        var $imgMobile = $("<img/>").attr("src", basePhotoURLMobile);
        var $wrap = $("<div class='item'></div>");
        if($(window).width() < 501) {
            $wrap.append($imgMobile);
        } else {
            $wrap.append($img);
        }
        $wrap.append("<a href='" + basePhotoURL + "'.jpg' title='View full size' class='zoom' rel='enroll' />");
        $wrap.append("<a href='" + flickrLink + "' class='flickr' title='View on Flickr' target='_blank' />");
        $wrap.appendTo('#photographs');
    });

    var loaded = 0;
    var totalAmount = $('#photographs .item').length;

    if($(window).width() > 1140) {
        $('#photographs .item').each(function() {
            loaded;
            $(this).imagesLoaded(function($images) {
                loaded++;
                var percentage =  parseInt((loaded / 51) * 100);
                console.log(loaded + ' van de ' + totalAmount);
                $("#bigloader").progressbar({
                      value: percentage
                    });
                if(loaded == 50) {
                    $("#photographs, #loader").fadeIn("fast");
                    $("#bigloader, #preloading").fadeOut("fast");
                    $("#photographs").gridalicious({
                        gutter: 2,
                        animate: true,
                        effect: 'fadeInOnAppear',
                        width: 430
                    });
                } else if (loaded == totalAmount) {
                    $("#loader").fadeOut("fast");       
                };
            }); 
        });
    } else {
        $('#photographs .item').each(function() {
            loaded;
            $(this).imagesLoaded(function($images) {
                loaded++;
                var percentage =  parseInt((loaded / 51) * 100);
                console.log(loaded);
                $("#bigloader").progressbar({
                      value: percentage
                    });
                if(loaded == 50) {
                    $("#photographs, #loader").fadeIn("fast");
                    $("#bigloader, #preloading").fadeOut("fast");
                    $("#photographs").gridalicious({
                        gutter: 2,
                        animate: true,
                        effect: 'fadeInOnAppear',
                        width: 320
                    });
                } else if (loaded == totalAmount) {
                    $("#loader").fadeOut("fast");       
                };
            }); 
        });
    }
}); 
```

有人有任何线索吗？我将永远感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:28:51.317

假设您正在垂直滚动，从概念上讲，您可以使用滚动事件来发出批处理 ajax 请求。您正在使用的那个 api 似乎也有页面参数。

//根据下面的评论编辑

[http://api.jquery.com/scroll](http://api.jquery.com/scroll)
[http://docs.jquery.com/CSS/scrollTop](http://docs.jquery.com/CSS/scrollTop)

```
functionCalledByScroll(requestNumber) { 
    $.get('<url>' + 'per_page=<amount you need>' + '&page=<requestNumber>', 
        function (data) { 
            $(data).each(<your call back above>);
        }
    }); 
} 
```

记录您对页面参数发出的请求数。每个滚动差异（例如 1000 像素或更多）请求一些数量（50 项）。然后以与您相同的方式将 json 对象加载到 html 中。

# c# - ToggleButton 的 Checked 事件在绑定工作之前发生

> ID：14489502
> 
> 赞同：0
> 
> 时间：2013-01-23T21:13:56.497
> 
> 标签：c#, silverlight, windows-phone-7, data-binding, binding

我有一个切换按钮和一个选中的事件处理程序。此外，我对视图模型的属性进行了双向绑定。我在调试中看到的是我进入了处理程序，然后进入了属性的设置器。问题是我的业务逻辑需要正确的属性值。这种行为对我来说似乎很奇怪。

# android - Eclipse 中的 Android 库项目：RunTimeException ClassNotFoundException

> ID：14489503
> 
> 赞同：1
> 
> 时间：2013-01-23T21:14:12.647
> 
> 标签：android, eclipse-adt

以下代码来自具有库、试用版和完整应用程序的 Android 应用程序。在项目属性中，将库设置为库，在试用/完整版中引用库。但是，我似乎在命名包或 android:name(s) 时遗漏了一些东西：

如果我尝试运行完整的应用程序，该应用程序会在移动设备上停止并显示以下消息：

```
E/AndroidRuntime(28658): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{at.prm.privatecalls/at.prm.privatecalls.library.SettingsActivity}: java.lang.ClassNotFoundException: Didn't find class "at.prm.privatecalls.library.SettingsActivity" on path: /data/app/at.prm.privatecalls-1.apk 
```

**lib清单：**

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="at.prm.privatecalls.library"
  android:versionCode="1"
  android:versionName="@string/versionname" >

<uses-sdk android:minSdkVersion="11" android:targetSdkVersion="17" />

<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="SettingsActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    ...
</application> 
```

**应用清单：**

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="at.prm.privatecalls"
  android:versionCode="1"
  android:versionName="@string/versionname" >

<uses-sdk android:minSdkVersion="11" android:targetSdkVersion="17" />

<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity 
        android:name="at.prm.privatecalls.library.SettingsActivity" 
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    ...
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T15:57:29.600

我从一个新的应用程序开始，创建了库和两个完整和试用的项目，然后复制了代码。有效，但是，我不知道错误的原因。

# jquery - jQuery.waypoint - 方向未定义

> ID：14489504
> 
> 赞同：3
> 
> 时间：2013-01-23T21:14:16.320
> 
> 标签：jquery, jquery-waypoints

我在使用航点插件时遇到问题，因为许多教程，如[http://webdesign.tutsplus.com/tutorials/javascript-tutorials/create-a-sticky-navigation-header-using-jquery-waypoints/](http://webdesign.tutsplus.com/tutorials/javascript-tutorials/create-a-sticky-navigation-header-using-jquery-waypoints/)建议。

这是我的代码：

```
<script type="text/javascript">

jQuery(function() {
var nav_container = jQuery("#menu-wrapper");
var nav = jQuery("#menu");
nav_container.waypoint(function(event, direction) {

    jQuery("#fixed").toggleClass('stickyfixed');
    jQuery('#zweitenavigation').toggleClass('invisible');
    alert(direction);
    var new_height  = (direction === "down") ? '92px' : '195px';
    jQuery("#header").animate({'height': new_height}, 300);
},{offset:50}
);
});
</script> 
```

问题是

```
direction === "down" 
```

不评估为真或假，它只是未定义。因此动画只被触发一次。

有谁知道问题出在哪里？顺便说一句，toggleClass 工作正常。

感谢您的帮助和最好的问候斯蒂芬

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-30T00:21:03.550

Waypoints 2.0 版去掉了这个`event`参数。现在只有`direction`. 您引用的教程在链接到这个新版本的 Waypoint 时犯了一个很大的错误，而没有更新他们的教程以匹配新的处理程序签名。

# sql-server-2008 - IIS7 应用程序池设置 ApplicationPoolIdentity、NetworkService 或自定义帐户

> ID：14489506
> 
> 赞同：0
> 
> 时间：2013-01-23T21:14:21.860
> 
> 标签：sql-server-2008, iis-7, sql-server-2008-r2, sql-server-express, applicationpoolidentity

我继承了一个连接到 2 个 SQL Server（数据存储）和一个 SQLExpress DB（会员登录）的应用程序。它从未成功部署，因此我的任务是部署到 Server 2008 R2 上的 IIS 7.5。

根据我所阅读的内容，我需要在连接到 SQL Server 时使用 ApplicaitonPoolIdentity，在连接到 SQLExpress 时需要使用 NetworkService。由于我需要使用其中一个，我决定使用我的网络帐户作为自定义帐户下的测试。它按预期工作。然而几个小时后，会员登录停止工作。该错误指示我删除 SQLExpress 的用户配置文件中的文件，并建议我将 AppPool 更改为 NetworkService。但是在 NetworkService 上，我无法连接到 SQL Server。我将其保留为自定义帐户，认为这只是侥幸。几个小时后，我被要求再次删除 SQLExpress 用户配置文件中的文件。

我已经验证我的所有连接字符串都是正确的。有没有人见过这样的设置？如果是这样，我将不胜感激有关如何进行设置的任何建议。

谢谢， TJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T16:03:09.530

对于遇到此问题的其他人：最后，我只是将成员资格从 SQLExpress 转移到 SQL Server。那时我能够同时使用 ApplicaitonPoolIdentity 和自定义帐户。对我来说，这似乎是更好的路径。如果您想确保 SQL 与成员资格一起使用，请阅读[THIS](http://msdn.microsoft.com/en-us/library/x28wfk74.aspx)

# php - 如何使用自定义字段制作 PayPal 加密的“立即购买”按钮？

> ID：14489512
> 
> 赞同：1
> 
> 时间：2013-01-23T21:14:32.303
> 
> 标签：php, button, encryption, paypal

有没有办法让我的 PHP 代码生成一个加密的 BuyNow 按钮，该按钮还包括自定义字段并实现 IPN URL 和重定向页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T16:14:35.033

您不必加密。只需使用“自定义”变量，除其他外，您可能需要放入其中，添加价格和产品编号的哈希值，如下所示：

```
$sCustom .= '|' . md5($sSalt . $sProduct . $sPrice); 
```

然后，在处理 IPN 时，请确保此散列不受接收回的内容的干扰。如果是，则阻止交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T21:53:15.103

在加密按钮中有一个名为“自定义”的字段，您可以将一个数组序列化到其中，它将返回到您的 IPN :)

# jquery - 带有流行的自定义滚动条的顽固问题

> ID：14489518
> 
> 赞同：3
> 
> 时间：2013-01-23T21:14:54.540
> 
> 标签：jquery, scrollbar

代码更新：[http ://mawk3y.net/test/brand.php?id=12](http://mawk3y.net/test/brand.php?id=12)

原始的 jquery 插件在这里[http://manos.malihu.gr/tuts/jquery_custom_scrollbar.html](http://manos.malihu.gr/tuts/jquery_custom_scrollbar.html)

```
$(".content1").mCustomScrollbar({
scrollButtons:{
enable:true
}
});
$("#contact_details").mCustomScrollbar({
scrollButtons:{
enable:true
}
}); 
```

.content1 是有问题的 div：自定义滚动条在您调整窗口大小或启动 firebug 之前不会显示，contact_details 是第一个选项卡内的 div，尽管两个 div 都只包含文本，但没有任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:07:33.727

您的滚动条内联 CSS`#content_11`已`display:none`设置。

```
<div class="mCSB_scrollTools" style="position: absolute; display: none;"> ... </div> 
```

当您重新调整页面大小时，插件会覆盖该元素，从而使其出现。通过在我的浏览器中手动替换`display: none`，`display: block;`我可以使滚动条出现（尽管在错误的位置）。

你的功能 div`#contact_details`已经`display: block`有了。

```
<div class="mCSB_scrollTools" style="position: absolute; display: block;">...</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T04:02:14.033

问题是你的

```
$(window).load(function(){ 
```

在你的里面

```
$(document).ready(function(e) { 
```

如果您要在此 div 中包含图像，请删除文档准备功能。否则删除窗口加载功能。你不需要两者。

# list - 返回列表的第一个 n

> ID：14489520
> 
> 赞同：4
> 
> 时间：2013-01-23T21:15:08.937
> 
> 标签：list, scheme

如何返回`n`列表的第一个元素？这是我所拥有的：

```
(define returns(lambda (list n)
 (cond ((null? list) '())
 (((!= (0) n) (- n 1)) (car list) (cons (car list) (returns (cdr list) n)))
        (else '())))) 
```

例子：

```
(returns '(5 4 5 2 1) 2)
(5 4)

(returns '(5 4 5 2 1) 3)
(5 4 5) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T21:21:50.397

您要求的[`take`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket/list..rkt%29._take%29%29)程序：

```
(define returns take)

(returns '(5 4 5 2 1) 2)
=> (5 4)

(returns '(5 4 5 2 1) 3)
=> (5 4 5) 
```

这看起来像家庭作业，所以我想你必须从头开始实现它。一些提示，填空：

```
(define returns
  (lambda (lst n)
    (if <???>                     ; if n is zero
        <???>                     ; return the empty list
        (cons <???>               ; otherwise cons the first element of the list
              (returns <???>      ; advance the recursion over the list
                       <???>))))) ; subtract 1 from n 
```

不要忘记测试它！

# perl - 当 Starman 收到 HUP 时 ZMQ 套接字阻塞

> ID：14489522
> 
> 赞同：4
> 
> 时间：2013-01-23T21:15:28.753
> 
> 标签：perl, zeromq, plack, starman

我有以下代码。我想`$pub->close`在starman服务器接收到HUP信号时调用该方法。

*   我怎么知道子进程结束了？
*   我可以使用 END {} 块吗？我试过这个，它似乎在 plackup 重新启动时工作（在编辑之后）。我用starman试过这个。我发送了 HUP 信号，但孩子们没有重新启动。
*   我应该为 HUP 安装信号处理程序吗？这是如何运作的？

我想在孩子重新启动之前进行清理，如果我不这样做，子进程将阻塞。

这是我使用的 .psgi 文件。

```
use ZMQ;
use ZMQ::Constants ':all';
use Plack::Builder;

our $ctx = ZMQ::Context->new(1);
my $pub = $ctx->socket(ZMQ_PUB);
$pub->bind('tcp://127.0.0.1:5998');

# I want to close the socket and terminate the context
# when the server is restarted with kill -HUP pid
# It seems the children won't restart because the sockets isn't closed.
# The next two lines should be called before the child process ends.

# $pub->close;
# $ctx->term;

builder {
    $app
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T15:11:37.630

PSGI 应用程序没有标准的方法来注册每个进程的清理处理程序，而且 Starman 似乎没有实现任何直接可用的东西。但是你可以在进程退出时给 Starman 打补丁来运行一些代码。

由于 Starman 基于 Net::Server::PreFork 并且不使用 child_finish_hook() 本身，因此您可以通过将其插入 .psgi 文件中来覆盖此 Net::Server::PreFork 钩子：

```
sub Starman::Server::child_finish_hook {
    $pub->close();
    $ctx->term();
} 
```

ZMQ 内部使用线程可能会以某种方式阻止使用 END 块进行清理（或仅取决于全局析构函数），我认为将信号处理留给 Net::Server 框架是最明智的。

# xcode - xcode 在哪里存储项目文件位置/最近的项目？

> ID：14489526
> 
> 赞同：0
> 
> 时间：2013-01-23T21:16:08.587
> 
> 标签：xcode, xcode4, xcode4.5

当您加载 xcode 时，它​​会告诉您最近处理的文件/项目是什么。Xcode 在哪里存储这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:26:17.747

我相信它们存储在`com.apple.Xcode NSRecentXCProjectDocuments`. 这是“专家”首选项的一部分，不会通过 GUI 显示。

这可能会根据您要执行的操作而略有不同。例如，`$ defaults write com.apple.Xcode NSRecentDocumentsLimit 20`将显示 20 个最近的项目（而不是默认的 10 个）。

至于访问列表本身，我唯一能找到的是[快速搜索框](http://code.google.com/p/qsb-mac/source/browse/trunk/Vermilion/Modules/RecentDocuments/RecentDocumentsSource.m?r=545)源代码中的以下代码（尽管它看起来可能需要外部库）：

```
 if ([appIdentifier isEqualToString:@"com.apple.Xcode"]) {
          NSArray *recentXCodeProjects
            = GTMCFAutorelease(
                CFPreferencesCopyValue(CFSTR("NSRecentXCProjectDocuments"),
                                       (CFStringRef)appIdentifier,
                                       kCFPreferencesCurrentUser,
                                       kCFPreferencesAnyHost)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-06T15:49:33.410

我不知道这是否是问题的意思，但我正在寻找添加图像并需要项目外部目录，所以这就是我以非常简单的方式找到它的方式：

当您像我的图片一样单击时，您可以在屏幕右侧看到完整路径：

```
/Users/user_name/Desktop/app_name 
```

第一个 / 可以告诉你这是一个基于 unix 的系统

你可以使用mac中的finder来找到这个位置。这就是它的用途。

# django - 基于模型选择的 Django 表单字段

> ID：14489527
> 
> 赞同：1
> 
> 时间：2013-01-23T21:16:10.567
> 
> 标签：django, forms, models

我想提供基于模型选择的表单字段。所以，如果在我的模型中：

```
COLORS = (
    ('BLA', 'Black'),
    ('WHI', 'White'),
    ('RED', 'Red'),
    ('BLU', 'Blue'),
)

YEAR_CHOICES = []
for r in range(1980, (datetime.datetime.now().year+1)):
    YEAR_CHOICES.append((r,r))

class Thing(models.Model):
    stuff = models.ForeignKey(Stuff)
    color = models.CharField(max_length=3, choices=COLORS)
    year = models.IntegerField(('year'), max_length=4, choices=YEAR_CHOICES, default=datetime.datetime.now().year) 
```

我想创建两个表单域，一个是`<select>`选项`YEAR_CHOICES`，一个是选项`COLORS`。你能用 做这个`ModelChoiceField`吗？在我的重新定义选择`forms.py`似乎不是很干。否则，你将如何解决这个问题？

这样的事情是我所设想的，但它不起作用：

```
class BrowseForm(forms.Form):
    stuff = forms.ModelChoiceField(queryset=Stuff.objects.all())
    color = forms.ModelChoiceField(queryset=Thing.color.choices())
    year = forms.ModelChoiceField(queryset=Thing.year.choices()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:21:37.357

来自文档（[这里](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#field-types)）

您可以使用`select`小部件并指定选择。在你的情况下

`color = forms.CharField(max_length=20, widget=forms.Select(choices=COLORS))`

但是，由于您已经`color`与`choices`您一起定义，实际上不需要做*任何事情*（除了将元设置为`BrowseForm`to `Thing`）即可使其正常工作。它将默认为您想要的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:24:38.797

您可以使用模型表单

```
from django.forms import ModelForm

class BrowseForm(ModelForm):
    class Meta:
        model = Thing 
```

然后它会自动拉入您的选择。

# c++ - 探查器如何理解输出

> ID：14489528
> 
> 赞同：2
> 
> 时间：2013-01-23T21:16:11.563
> 
> 标签：c++, profiler

```
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total           
 time   seconds   seconds    calls  ms/call  ms/call  name    
 50.05      0.01     0.01  2556500     0.00     0.00  NonPrem::init()
 50.05      0.01     0.01  2530000     0.00     0.00  NonPrem::getSize() const
  0.00      0.01     0.00    27250     0.00     0.00  std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_lower_bound(std::_Rb_tree_node<std::pair<int const, NonPrem> >*, std::_Rb_tree_node<std::pair<int const, NonPrem> >*, int const&)
  0.00      0.01     0.00    13500     0.00     0.00  std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&)
  0.00      0.01     0.00    13500     0.00     0.00  std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<int const, NonPrem> >, std::pair<int const, NonPrem> const&)
  0.00      0.01     0.00     1500     0.00     0.00  operator+(NonPrem const&, NonPrem const&)
  0.00      0.01     0.00      250     0.00     0.00  std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique(std::pair<int const, NonPrem> const&)
  0.00      0.01     0.00      250     0.00     0.00  std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_erase(std::_Rb_tree_node<std::pair<int const, NonPrem> >*)
  0.00      0.01     0.00        1     0.00     0.00  _GLOBAL__sub_I__ZplRK7NonPremS1_
  0.00      0.01     0.00        1     0.00     0.14  RegularMapRun()
  0.00      0.01     0.00        1     0.00     9.84  RegularVectorRun()
  0.00      0.01     0.00        1     0.00     0.03  MyQuickInitArrayRun()

 %         the percentage of the total running time of the
time       program used by this function.

cumulative a running sum of the number of seconds accounted
 seconds   for by this function and those listed above it.

 self      the number of seconds accounted for by this
seconds    function alone.  This is the major sort for this
           listing.

calls      the number of times this function was invoked, if
           this function is profiled, else blank.

 self      the average number of milliseconds spent in this
ms/call    function per call, if this function is profiled,
       else blank.

 total     the average number of milliseconds spent in this
ms/call    function and its descendents per call, if this 
       function is profiled, else blank.

name       the name of the function.  This is the minor sort
           for this listing. The index shows the location of
       the function in the gprof listing. If the index is
       in parenthesis it shows where it would appear in
       the gprof listing if it were to be printed.

             Call graph (explanation follows)

granularity: each sample hit covers 2 byte(s) for 99.89% of 0.01 seconds

index % time    self  children    called     name
                                                 <spontaneous>
[1]    100.0    0.00    0.01                 main [1]
                0.00    0.01       1/1           RegularVectorRun() [2]
                0.00    0.00       1/1           RegularMapRun() [5]
                0.00    0.00       1/1           MyQuickInitArrayRun() [8]
-----------------------------------------------
                0.00    0.01       1/1           main [1]
[2]     98.3    0.00    0.01       1         RegularVectorRun() [2]
                0.00    0.00 2500000/2530000     NonPrem::getSize() const [4]
                0.00    0.00 2500500/2556500     NonPrem::init() [3]
                0.00    0.00     500/1500        operator+(NonPrem const&, NonPrem const&) [9]
-----------------------------------------------
                0.00    0.00    1500/2556500     operator+(NonPrem const&, NonPrem const&) [9]
                0.00    0.00   13500/2556500     std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&) [6]
                0.00    0.00   13750/2556500     MyQuickInitArrayRun() [8]
                0.00    0.00   27250/2556500     RegularMapRun() [5]
                0.00    0.00 2500500/2556500     RegularVectorRun() [2]
[3]     50.0    0.01    0.00 2556500         NonPrem::init() [3]
-----------------------------------------------
                0.00    0.00    3000/2530000     operator+(NonPrem const&, NonPrem const&) [9]
                0.00    0.00   13500/2530000     RegularMapRun() [5]
                0.00    0.00   13500/2530000     std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&) [6]
                0.00    0.00 2500000/2530000     RegularVectorRun() [2]
[4]     50.0    0.01    0.00 2530000         NonPrem::getSize() const [4]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[5]      1.4    0.00    0.00       1         RegularMapRun() [5]
                0.00    0.00   27250/2556500     NonPrem::init() [3]
                0.00    0.00   13500/13500       std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<int const, NonPrem> >, std::pair<int const, NonPrem> const&) [7]
                0.00    0.00   13500/2530000     NonPrem::getSize() const [4]
                0.00    0.00     500/1500        operator+(NonPrem const&, NonPrem const&) [9]
                0.00    0.00   27250/27250       std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_lower_bound(std::_Rb_tree_node<std::pair<int const, NonPrem> >*, std::_Rb_tree_node<std::pair<int const, NonPrem> >*, int const&) [17]
                0.00    0.00     250/250         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_erase(std::_Rb_tree_node<std::pair<int const, NonPrem> >*) [18]
-----------------------------------------------
                0.00    0.00     250/13500       std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique(std::pair<int const, NonPrem> const&) [10]
                0.00    0.00   13250/13500       std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<int const, NonPrem> >, std::pair<int const, NonPrem> const&) [7]
[6]      0.5    0.00    0.00   13500         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&) [6]
                0.00    0.00   13500/2530000     NonPrem::getSize() const [4]
                0.00    0.00   13500/2556500     NonPrem::init() [3]
-----------------------------------------------
                0.00    0.00   13500/13500       RegularMapRun() [5]
[7]      0.5    0.00    0.00   13500         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<int const, NonPrem> >, std::pair<int const, NonPrem> const&) [7]
                0.00    0.00   13250/13500       std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&) [6]
                0.00    0.00     250/250         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique(std::pair<int const, NonPrem> const&) [10]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[8]      0.3    0.00    0.00       1         MyQuickInitArrayRun() [8]
                0.00    0.00   13750/2556500     NonPrem::init() [3]
                0.00    0.00     500/1500        operator+(NonPrem const&, NonPrem const&) [9]
-----------------------------------------------
                0.00    0.00     500/1500        MyQuickInitArrayRun() [8]
                0.00    0.00     500/1500        RegularVectorRun() [2]
                0.00    0.00     500/1500        RegularMapRun() [5]
[9]      0.1    0.00    0.00    1500         operator+(NonPrem const&, NonPrem const&) [9]
                0.00    0.00    3000/2530000     NonPrem::getSize() const [4]
                0.00    0.00    1500/2556500     NonPrem::init() [3]
-----------------------------------------------
                0.00    0.00     250/250         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<int const, NonPrem> >, std::pair<int const, NonPrem> const&) [7]
[10]     0.0    0.00    0.00     250         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique(std::pair<int const, NonPrem> const&) [10]
                0.00    0.00     250/13500       std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&) [6]
-----------------------------------------------
                0.00    0.00   27250/27250       RegularMapRun() [5]
[17]     0.0    0.00    0.00   27250         std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_lower_bound(std::_Rb_tree_node<std::pair<int const, NonPrem> >*, std::_Rb_tree_node<std::pair<int const, NonPrem> >*, int const&) [17]
-----------------------------------------------
                               13500             std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_erase(std::_Rb_tree_node<std::pair<int const, NonPrem> >*) [18]
                0.00    0.00     250/250         RegularMapRun() [5]
[18]     0.0    0.00    0.00     250+13500   std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_erase(std::_Rb_tree_node<std::pair<int const, NonPrem> >*) [18]
                               13500             std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_erase(std::_Rb_tree_node<std::pair<int const, NonPrem> >*) [18]
-----------------------------------------------
                0.00    0.00       1/1           __libc_csu_init [27]
[19]     0.0    0.00    0.00       1         _GLOBAL__sub_I__ZplRK7NonPremS1_ [19]
-----------------------------------------------

 This table describes the call tree of the program, and was sorted by
 the total amount of time spent in each function and its children.

 Each entry in this table consists of several lines.  The line with the
 index number at the left hand margin lists the current function.
 The lines above it list the functions that called this function,
 and the lines below it list the functions this one called.
 This line lists:
     index  A unique number given to each element of the table.
        Index numbers are sorted numerically.
        The index number is printed next to every function name so
        it is easier to look up where the function in the table.

     % time This is the percentage of the `total' time that was spent
        in this function and its children.  Note that due to
        different viewpoints, functions excluded by options, etc,
        these numbers will NOT add up to 100%.

     self   This is the total amount of time spent in this function.

     children   This is the total amount of time propagated into this
        function by its children.

     called This is the number of times the function was called.
        If the function called itself recursively, the number
        only includes non-recursive calls, and is followed by
        a `+' and the number of recursive calls.

     name   The name of the current function.  The index number is
        printed after it.  If the function is a member of a
        cycle, the cycle number is printed between the
        function's name and the index number.

 For the function's parents, the fields have the following meanings:

     self   This is the amount of time that was propagated directly
        from the function into this parent.

     children   This is the amount of time that was propagated from
        the function's children into this parent.

     called This is the number of times this parent called the
        function `/' the total number of times the function
        was called.  Recursive calls to the function are not
        included in the number after the `/'.

     name   This is the name of the parent.  The parent's index
        number is printed after it.  If the parent is a
        member of a cycle, the cycle number is printed between
        the name and the index number.

 If the parents of the function cannot be determined, the word
 `<spontaneous>' is printed in the `name' field, and all the other
 fields are blank.

 For the function's children, the fields have the following meanings:

     self   This is the amount of time that was propagated directly
        from the child into the function.

     children   This is the amount of time that was propagated from the
        child's children to the function.

     called This is the number of times the function called
        this child `/' the total number of times the child
        was called.  Recursive calls by the child are not
        listed in the number after the `/'.

     name   This is the name of the child.  The child's index
        number is printed after it.  If the child is a
        member of a cycle, the cycle number is printed
        between the name and the index number.

 If there are any cycles (circles) in the call graph, there is an
 entry for the cycle-as-a-whole.  This entry shows who called the
 cycle (as parents) and the members of the cycle (as children.)
 The `+' recursive calls entry shows the number of function calls that
 were internal to the cycle, and the calls entry for each member shows,
 for that member, how many times it was called from other members of
 the cycle.

Index by function name

  [19] _GLOBAL__sub_I__ZplRK7NonPremS1_ [3] NonPrem::init() [10] std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique(std::pair<int const, NonPrem> const&)
   [5] RegularMapRun()         [4] NonPrem::getSize() const [7] std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<int const, NonPrem> >, std::pair<int const, NonPrem> const&)
   [2] RegularVectorRun()      [6] std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<int const, NonPrem> const&) [18] std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_erase(std::_Rb_tree_node<std::pair<int const, NonPrem> >*)
   [8] MyQuickInitArrayRun()  [17] std::_Rb_tree<int, std::pair<int const, NonPrem>, std::_Select1st<std::pair<int const, NonPrem> >, std::less<int>, std::allocator<std::pair<int const, NonPrem> > >::_M_lower_bound(std::_Rb_tree_node<std::pair<int const, NonPrem> >*, std::_Rb_tree_node<std::pair<int const, NonPrem> >*, int const&) [9] operator+(NonPrem const&, NonPrem const&) 
```

我是 gprof 的新手，所以我需要一些帮助。

我被要求使用分析器解析我的程序的输出。

我应该写哪个函数更快，以及哪一行表明了这一点。

我该如何做到这一点？

# c# - 从 LINQ/EF 获取前 n 天日期数据的有效方法

> ID：14489530
> 
> 赞同：1
> 
> 时间：2013-01-23T21:16:24.510
> 
> 标签：c#, performance, linq, entity-framework-4, linq-to-entities

我有一个包含所有订单详细信息的销售表。它有列 ID、SaleDate、Price。通过 Entity Framework v4，获取前 30 天每日总销售额的有效方法是什么？

```
public static List<ChartTotal> GetTotalsByDate()
{
    List<ChartTotal> totals = new List<ChartTotal>();
    ChartTotal totalForDay = null;
    DateTime orderDate = DateTime.Now;
    int DAY_COUNT = 30;
    using (LinqModel db = new LinqModel())
    {
        do
        {
        DAY_COUNT--;
        orderDate = orderDate.AddDays(-1);
        totalForDay = new ChartTotal { OrderDate = String.Format("{0:dd MMM}", orderDate), Total = db.Sales.Where(p=>p.SaleDate < orderDate).Sum(o => o.GrandTotal) };
        totals.Add(totalForDay);
        } while (DAY_COUNT > 0);
    }
    return totals;
} 
```

我不希望它做得如此粗糙。我能否以某种方式一次性获取所有数据，换句话说，我想替换循环，以便最大限度地减少往返行程。我应该改用存储过程吗？

环境：Asp.Net 4.5、EF v4、SQL Sever 2012、VS 2012。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:27:44.273

这应该为您提供过去 30 天（包括今天）的每天总数。您可以使用`EntityFunctions.TruncateTime`剥离的时间部分`DateTime`。

```
var q = from x in Sales
        where x.SaleDate > DateTime.Now.AddDays(-30) &&
              x.SaleDate <= DateTime.Now
        group x by EntityFunctions.TruncateTime(x.SaleDate) into g
        select new ChartTotal()
        {
           OrderDate = g.Key,
           Total     = g.Sum(y => y.GrandTotal)
        }; 
```

# xml - 将 XML 字符样式导入 InDesign？

> ID：14489531
> 
> 赞同：1
> 
> 时间：2013-01-23T21:16:34.183
> 
> 标签：xml, adobe-indesign

## 概括

我正在尝试将一些 XML 导入 InDesign，标记为段落和字符样式。我的段落样式运行良好，因为每个条目条目都有一个固定的、可预测的结构；但是，我不能让任意字符样式起作用，因为（在一个段落内）它们可以以任何数量或顺序出现。

你能帮助我吗？

我似乎在 Adob​​e 文档中找不到这个问题。

## 更多详情

我的 XML 看起来像这样：

```
<root>
  <item>
    <title>Lorem <italic>ipsum</italic> dolor.</title>
    <description><italic>Consectetur.</italic> Ut vel <bold>aliquet.</bold> Maecenas non leo, <italic>in congue.</italic></description>
  </item>
  <item>
    <title><italic>Aenean leo</italic>, interdum <italic>in fermentum.</italic></title>
    <description><bold>Excepteur.</bold> Non proident, sunt in <italic>mollit anim id est</italic> labore et dolore.</description>
  </item>
</root> 
```

我用等效的标签标记了我的 InDesign 文件：

结构

*   根
*   物品

段落样式

*   标题
*   描述

字符样式

*   斜体
*   大胆的

在 XML 中，例如在第一**项的****描述**字段中，出现两个**斜体**部分，它们之间有一个**粗体**（以及其他非样式文本）。然而，在第二个**项目**中，**斜体**跟在一个**粗体**之后。我不知道如何标记模板以允许像这样的任意段落......这不像**斜体**跨度出现在每条记录的同一个位置。

 ******此外，段落出现在**标题**和**描述**字段中的一个或两个中。

这需要一些 JavaScript 吗？我不确定从哪里开始，因为与预定义标记结构不匹配的文本在导入后甚至不会进入我的文档。换句话说，没有什么要处理的。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T14:02:55.340

[本文](http://www.indesignusergroup.com/chapters/brisbane/files/643/Brisbane_Handout.pdf)很好地概述了将 XML 标记映射到样式。它不应该需要任何Javascript来让它工作。我最近参与了一个项目，该项目涉及将 XML 标记映射到样式，并且对小型文档非常有效。

您必须问自己每个 XML 元素在实际 InDesign 文档中代表什么。您的`item`标签会由文本框表示吗？或者您的`root`标签会由文本框表示吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-08T21:33:30.837

我在这里找到了答案：http: [//carijansen.com/indesign-xml-reference-guide/](http://carijansen.com/indesign-xml-reference-guide/)

剪辑：

> 将 XML 标记映射到样式，在用 XML 标记标记的内容与段落、字符样式、表格或单元格样式之间创建链接，随后将根据映射参考格式化 InDesign 文档中的插入 XML 数据。
> 
> 要将 XML 标记映射到各种 InDesign 样式：
> 
> 1.  从标签面板菜单或结构面板菜单中选择将标签**映射到样式。**
> 
> 列出了“标签”面板中可用的所有标签。样式菜单在每个标签旁边提供一个下拉菜单，其中包含标签可能映射到的所有段落、字符、表格和单元格样式的列表。
> 
> 2.  单击将标签映射到样式对话框中的**按名称映射以自动映射匹配的标签和样式名称。**所有匹配的名称都会自动链接起来。对于任何未映射的标签，您可以从下拉菜单中选择替代映射选项。
> 3.  将所有使用的标签链接到文档样​​式后，单击“确定”。导入的 XML 数据现在使用匹配的段落、字符、表格和单元格样式自动格式化。******

# iphone - UIPageViewController 导航方向适用于 iOS 5，但不适用于 6

> ID：14489533
> 
> 赞同：0
> 
> 时间：2013-01-23T21:16:37.097
> 
> 标签：iphone, ios, objective-c, xcode, ios6

我有一个翻页应用程序，可以在 iOS 5.1 模拟器中正常运行，但我正在更新到 iOS 6 并且 UIPageViewController 出现问题。所有页面视图控制器都有一个 UIScrollView 设置为添加到它们的边界。我将 navigationOrientation 设置为 Horizo​​ntal 并且翻页在 iOS 5 中正常工作。

```
BookController *bc = [[BookController alloc] initWithTransitionStyle:UIPageViewControllerTransitionStylePageCurl
                                               navigationOrientation:UIPageViewControllerNavigationOrientationHorizontal
                                                             options:nil];
bc.dataSource = bc;
bc.delegate = bc;
bc.bookDelegate = theDelegate; 
```

在 iOS 5 中，水平滚动时会触发以下方法...

```
- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController
       viewControllerAfterViewController:(UIViewController *)viewController;

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController
      viewControllerBeforeViewController:(UIViewController *)viewController; 
```

**但是，在 iOS 6 中，它们在水平和垂直滚动时触发。**

任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:50:22.410

我猜发生了什么事是 Apple 在 iOS 6 中添加了滚动视图或滚动手势识别器，因为`UIPageViewController`s 现在支持`UIPageViewControllerTransitionStyleScroll`，而在 iOS 6 之前它们不支持。这可能只是你必须忍受的变化，但我会做更多的搜索，看看是否有某种方法可以禁用垂直滚动。

# iphone - 从 Javascript 在 Safari 中打开 webView 链接？

> ID：14489541
> 
> 赞同：0
> 
> 时间：2013-01-23T21:17:35.010
> 
> 标签：iphone, ios, xcode, uiwebview, youtube

谢谢你看我的问题。为了进行一些测试，我已将 webView 的当前 URL 的字符串输出到控制台中。但是对于 m.youtube.com，似乎没有传递任何 URL。这可能是使用以下方法的原因：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    if (navigationType == UIWebViewNavigationTypeLinkClicked) {

        [[UIApplication sharedApplication] openURL:request.URL];
        return NO;
    }

    return YES;
} 
```

不适用于 m.youtube.com，但可用于其他网站。

正如马修所说，YouTube 使用 Javascript 加载，所以让我改写我的问题 - 当页面上加载新的 javascript 时，有没有办法在 Safari 中打开网站？

我上传了一个包含我的问题的示例项目。

[https://www.dropbox.com/sh/m4yjv7awpj9wlh8/q0nQgHlQQC/YouTubeWebView](https://www.dropbox.com/sh/m4yjv7awpj9wlh8/q0nQgHlQQC/YouTubeWebView)

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T04:01:42.143

我想你可以参考[这个](https://stackoverflow.com/questions/11524805/how-to-open-the-url-in-safari-not-in-webview)，这可能有助于你在没有 URL 的情况下在 safari 中传递你的 webview 请求

# facebook - 在 Windows 8 应用程序中发布到朋友墙

> ID：14489544
> 
> 赞同：0
> 
> 时间：2013-01-23T21:17:58.690
> 
> 标签：facebook, facebook-graph-api, windows-8, friend, facebook-wall

不推荐使用用于发布到朋友墙上的 graphi api profile_id/feed。博客[https://developers.facebook.com/blog/post/2012/10/10/growth-quality-apps-with-open-graph/](https://developers.facebook.com/blog/post/2012/10/10/growing-quality-apps-with-open-graph/)指示应该使用提要/对话框。

如何在 Windows 8 应用程序中使用提要/对话框？如果不能，如何在 Windows 8 应用程序中向朋友的墙发帖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:21:39.267

您可以在其中打开一个带有 Feed 对话框的 web 视图，否则在迁移生效后无法发布到用户朋友的墙上

# angularjs - 使模板化的数据可用于 ng-model

> ID：14489547
> 
> 赞同：0
> 
> 时间：2013-01-23T21:18:18.550
> 
> 标签：angularjs

使用服务器端模板和客户端 angularjs 时，我无法让 angularjs 识别我在服务器上模板化的值。

例如（或[在 jsfiddle 上](http://jsfiddle.net/shkd7/8/)）：

```
<div ng-app>
<div ng-controller="Ctrl">
    <textarea ng-model="data" placeholder="Enter a name here">Templated in</textarea>
    {{data}}
</div>
</div> 
```

Angularjs 将始终将文本区域中的值替换为`$scope.data`(null) 的值。我想要的是`$scope.data`在应用程序引导上采用“模板化”的值，然后从那里正常继续。

如何从服务器模板中输入一个值，然后让 angularjs 模型在客户端上绑定该值一次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:21:38.947

使用[ng-init](http://docs.angularjs.org/api/ng.directive:ngInit)

```
<textarea ng-model="data" placeholder="Enter a name here"
 ng-init="data='Templated in'"></textarea> 
```

另请参阅[AngularJS - 使用 ng-model 时忽略输入文本框上的值属性？](https://stackoverflow.com/questions/10610282/angularjs-value-attribute-on-an-input-text-box-is-ignored-when-there-is-a-ng-m)和
[rails + angularjs 在编辑时将值加载到文本字段中](https://stackoverflow.com/questions/12703820/rails-angularjs-loading-values-into-textfields-on-edit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-21T22:51:51.190

我在尝试自己解决这个问题时遇到了这个答案，但我从来不喜欢我必须从 HTML 规范需要的字段部分移动信息。我觉得这不是正确的方法。

有一段时间，我最终利用 Angular 位于 jQuery 之上的事实（或者如果完整的 jQuery 不可用，则使用嵌入式 jqLit​​e 子集）来解决这个问题，而无需移动内容，甚至不接触 ng-init。具体来说，您可以在控制器初始化阶段使用（ [Angular/jqLit​​e 版本](http://docs.angularjs.org/api/angular.element)的）[标准 jQuery 方法访问 textarea 的内容。](http://api.jquery.com/jQuery/)

所以我只是做了

```
var doc = angular.element(document.documentElement);

$scope.data = doc.find('textarea').eq(0).val(); 
```

在我的控制器中，正是我将初始化任何其他范围变量的地方。（或者，这是[修改后的 jsFiddle](http://jsfiddle.net/shkd7/11/) ...）

有了完整的 jQuery 库，代码就更简单了，因为此时您可以访问完整的[jQuery 选择器](http://api.jquery.com/category/selectors/)并且可以直接跳转到`$('textarea').eq(0).val()`（或者甚至添加一个 id 到该字段并在该字段上选择：）`$('#data-textarea').val()`。

这种方法的好处是它适用于任何表单元素，尽管因为其中大部分是`<input>`标签，并且 jqLit​​e 不支持选择器，所以找到您想要的确切的选择器可能有点棘手。那时我会简单地包含完整的 jQuery 库并利用选择器，但这就是我。

这种方法还有一个主要缺点，就是将 DOM 感知代码放置在控制器中，这完全打破了 Angular 约定（The Angular Way (TM)）*和*MVC/MVVM 编程范式。不是最好的解决方案。

**更新：**所以我最终意识到我需要一个更长期的解决方案，一个不违反这么多最佳实践的解决方案。答案实际上来自 Angular 最重要的元素，没有它，其余的都不会起作用（你可以争辩说对于其他组件，但对于这个组件来说更是如此）：**指令**。进一步来说：

```
app.directive('input', ['$parse', function ($parse) {
    return {
        restrict: 'E',
        require: '?ngModel',
        link: function (scope, element, attrs) {
            if(attrs.value) {
                $parse(attrs.ngModel).assign(attrs.value, scope);
            }
        }
    };
}]); 
```

这有许多优点。首先，它不会破坏有助于加强 MVC/MVVM 的 Angular 约定。其次，它甚至不涉及 jqLit​​e/jQuery，也不涉及底层的 DOM 函数。第三，它具有保留用于定义默认值的 HTML 约定的预期效果，允许（或至少简化）Angular 与其他现有技术（例如服务器端模板引擎）的使用。

为什么Angular默认不这样做？好吧，如果没有更多的研究，我不知道实际的答案，但一个可能的答案是 HTML 约定有利于静态页面内容，而 Angular 是为动态页面内容而设计的。这意味着在许多地方打破 HTML 约定，而不是让它限制 Angular 应用程序的可能性。由于控制器被期望承担初始化模型的责任（并且在大多数情况下这样的期望是正确的），Angular 团队将有动机忽略`value`属性的内容（以及它在其他表单标签中的类似物）。

当然，使用这种方法，对于在控制器初始化之前已经存在的任何适用元素，控制器 init*可以*覆盖该`value`属性。然而，这种行为在整个应用程序中并不一致，因为新元素将触发指令评估，而*不是*控制器初始化阶段。（具有自己的控制器的部分也具有这种行为 - 在部分的控制器 init 之前存在的元素可以被所述 init 覆盖，但之后添加的其他元素不会重新触发 init。）

有许多其他方法可以编写这样的指令，并且它也可以扩展为执行任意数量的其他事情，但希望这种方法可以帮助其他人。

# codeigniter - Codeigniter 扩展系统库不起作用

> ID：14489550
> 
> 赞同：2
> 
> 时间：2013-01-23T21:18:23.130
> 
> 标签：codeigniter, codeigniter-2

我使用 Codeigniter 2.1.3 并尝试扩展系统库 Cart：

我创建了 My_Cart.php 并将其放入 application/libraries/

它有：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class MY_Cart extends CI_Cart {

    function __construct()
    {
        parent::__construct();
        // allow anything in the product name
        $this->product_name_rules = '\d\D';
    }

    // get in stock amount for every item in cart
    function enrich_stock()
    {
        ...
    }

} 
```

但是当我在控制器中使用它时，`$this->cart->enrich_stock()` 我会出错

**致命错误：在第 15 行的 .../application/controllers/cart.php 中调用未定义的方法 CI_Cart::enrich_stock()**

问题是它完全按照文档中的描述实现： [扩展本机库](http://ellislab.com/codeigniter/user-guide/general/creating_libraries.html)

而且它在本地服务器上运行良好，但是今天我将整个站点上传到生产服务器上，并且出现了错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T01:50:40.740

根据评论，解决方案是重命名`My_Cart.php`为`MY_Cart.php`. 在使用区分大小写的系统（如 Linux）时，大写很重要。

# infragistics - Infragistics 网格滚动问题

> ID：14489551
> 
> 赞同：1
> 
> 时间：2013-01-23T21:18:22.530
> 
> 标签：infragistics, ignite-ui, iggrid

我有这段代码，如果`IgGrid control`正在编辑中的单元格，它可以正常工作：

```
var verticalContainer = $("#BookLabor_scrollContainer");
var topPos = verticalContainer.scrollTop();
$("#BookLabor").igGrid("option", "dataSource", blankLaborDS);
$('#BookLabor').igGrid('dataBind');
verticalContainer.scrollTop(topPos); 
```

但是，当我使用一个`IgDialog`在网格单元上弹出的*按钮单击事件*时，这不会滚动回正在编辑的行：

```
var verticalContainer = $("#BookLabor_scrollContainer");
var topPos = verticalContainer.scrollTop();
$("#BookLabor").igGrid("option", "dataSource", blankLaborDS);
$('#BookLabor').igGrid('dataBind');
verticalContainer.scrollTop(topPos); 
```

有一个虚拟滚动的方法`IgGrid`，但是在线文档没有详细解释如何使用它。

`Infragistics`来自所有专家的任何技巧、提示和提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T15:09:11.340

与滚动相关的 API 非常基本，您使用的 API 非常相似：

*   `.igGrid("scrollContainer")`只是一个简写，所以你不必使用 #BookLabor_scrollContainer （它是一个内部 id）
*   `.igGrid("virtualScrollTo", scrollContainerTop);`就像您使用虚拟滚动时的滚动顶部一样，您可能会（如果没有更多代码就无法判断）所以您可能想尝试一下。

**但是**，是否有理由在单元格编辑后调用 dataBind ？（我很难找到一个场景）。它不是以任何方式设计的，它会在更大的数据中产生大量开销。如果您需要更新单元格值，您应该使用不需要重新绑定并且之后也不需要滚动的更新 API。请参阅：http: [//help.infragistics.com/jQuery/2012.2/ui.iggridupdating ＃方法](http://help.infragistics.com/jQuery/2012.2/ui.iggridupdating#methods)

至于对话框，更新再次提供了一个内部使用对话框的行模板，我强烈建议如果行编辑是可以接受的。示例： http: [//www.infragistics.com/products/jquery/sample/grid/row-edit-template](http://www.infragistics.com/products/jquery/sample/grid/row-edit-template)

# maven - Intellij：jboss-ejb3.xml 条目不断从 ${PROJECT_DIR}/.idea/artifacts/XXX_war_exploded.xml 中消失

> ID：14489557
> 
> 赞同：0
> 
> 时间：2013-01-23T21:18:47.613
> 
> 标签：maven, intellij-idea, java-ee-6

为什么虽然我已经

1.  在我的项目的 EJB 方面设置 JBoss EJB 部署描述符的正确路径

2.  添加`jboss-ejb3.xml`到 Intellij 的工件 Patrac-web:war exploded 的 <output root>/WEB-INF

每当我对 pom.xml 进行最简单的更改时，Intellij 都会从以下条目中删除`${PROJECT_DIR}/.idea/artifacts/Patrac_web_war_exploded.xml`：

```
<element id="file-copy" path="$PROJECT_DIR$/Patrac-ejb/src/main/resources/META-INF/jboss-ejb3.xml" /> 
```

并且，因此，`jboss-ejb3.xml`不会被复制到目标目录？

就好像每次我对`pom.xml`Intellij 进行更改时，都会使用 POM “重新加载”部署配置，以覆盖我在 IDE 中所做的设置。也许是因为我没有从源目录`pom.xml`复制`jboss-ejb3.xml`到目标目录的条目，所以每当 Intellij“重新加载”时，我在 Intellij IDE 中所做的设置都会消失。纯粹是我的猜测，但这似乎正在发生。

如果是这样，我需要做出什么改变`pom.xml`才能让这种情况停止发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T08:17:37.650

当一个项目从 Maven （重新）导入时，IDEA 会配置它，当您从 IDEA 调用“构建”时，它会产生与 Maven 的“包”目标相同的结果。如果您需要将 jboss-ejb3.xml 复制到 WEB-INF，只需将其放在 'src/main/webapp/WEB-INF' 目录下，它将被 Maven 复制，IDEA 也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:35:04.930

这是我尝试的 Nik 解决方案的替代方案，因为我想离开`jboss-ejb3.xml`META-INF。 [看了一下 maven 文档](https://maven.apache.org/plugins/maven-war-plugin/examples/adding-filtering-webresources.html "Maven War 插件 - 添加和过滤外部 Web 资源")，它显示了如何将其`jboss-ejb3.xml`视为 Web 资源并将其复制到 WEB-INF 中，我在 maven-war-plugin 配置中添加了以下内容，问题得到解决。嗯，有点。但不是真的。

```
<webResources>
    <resource>
        <directory>../Patrac-ejb/src/main/resources/META-INF</directory>
        <includes>
            <include>jboss-ejb3.xml</include>
        </includes>
        <targetPath>WEB-INF</targetPath>
    </resource>
</webResources> 
```

虽然这样做消除了摆弄 IDEA 方面配置设置的需要（因为 Maven 被配置为复制文件，而不是 IDEA），但引入了一个新问题：`jboss-ejb3.xml`WAR 中出现了两个副本，一个在 WEB-INF 和EJB JAR 中的另一个（在 META-INF 中）。尽管没有明显的后果（应用程序运行得很好），但我宁愿不要在 EJB JAR 中放置描述符的副本。

使用[Maven EJB 插件文档](https://maven.apache.org/plugins/maven-ejb-plugin/ejb-mojo.html "Maven EJB 插件")，我尝试将排除项添加到我的 maven-ejb-plugin 配置中，例如

```
<configuration>
    <ejbVersion>3.1</ejbVersion>
    <excludes>
        <exclude>**/jboss-ejb3.xml</exclude>
    </excludes>
</configuration> 
```

这应该可以防止重复副本`jboss-ejb3.xml`出现在 EJB JAR META-INF 中，但它对我不起作用，在谷歌搜索“maven-ejb-plugin 排除无法正常工作”的各种变体后，我放弃了。

如果我可以让排除项工作，那么我会更喜欢这个解决方案而不是移动`jboss-ejb3.xml`到 src/main/webapp/WEB-INF 因为虽然这个解决方案稍微复杂一些（它需要两个 POM 中的额外 Maven 配置设置），但 EJB相关的描述符将保留在 EJB 模块中。

我决定使用 Nik 的解决方案，直到我可以解决排除问题。

# youtube-api - 如何获得观看次数：Youtube 分析报告查询

> ID：14489560
> 
> 赞同：0
> 
> 时间：2013-01-23T21:18:57.990
> 
> 标签：youtube-api

_analyticService = new YoutubeAnalyticsService(_authenticator = CreateAuthenticator()); ... var result = _analyticService.Reports.Query("channel==myChannelCode", "2013-01-01", "2013-02-02", "views").Fetch();

我创建了一个新的 Youtube 分析服务，并向服务器发送了一个查询。我的目标是获得用户对其视频的观看次数。

我如何使用结果来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:10:22.930

在您的要求中

> _analyticService.Reports.Query("channel==myChannelCode", "2013-01-01", "2013-02-02", "views").Fetch();

您仅在 1 月 1 日至 2 月 2 日期间获取视图。要获得完整的观看次数，您需要获得生命周期观看次数，请尝试指定距离较远的开始日期和结束日期，例如 start-date=2005-01-01 和 end-date=2100-01-01。

您可能还想用您正在查找的视频的视频 ID 指定一个过滤器，例如 filter=video==_iwmv6644dA 请注意，api 返回的视图计数似乎没有像 on 那样快速更新观看页面，因此可能不完全相同。

但是，此请求可以很好地获取我的一个视频的观看次数： [https ://www.googleapis.com/youtube/analytics/v1/reports?ids=channel%3D%3DUCYHMS8hN8s49F93iJuEgG6w&start-date=2005-01-01&end -date=2100-01-01&metrics=views&filters=video%3D%3D_iwmv6644dA&key=](https://www.googleapis.com/youtube/analytics/v1/reports?ids=channel%3D%3DUCYHMS8hN8s49F93iJuEgG6w&start-date=2005-01-01&end-date=2100-01-01&metrics=views&filters=video%3D%3D_iwmv6644dA&key=) {YOUR_API_KEY}

# ruby-on-rails - 是否可以使用变量来构建 link_to 命令？（轨道 3.2.11）

> ID：14489562
> 
> 赞同：0
> 
> 时间：2013-01-23T21:19:09.377
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在为视障人士创建我的 Rails 应用程序的一部分。这要求我只使用文本和链接来创建它，以便让使用语音阅读器的人更容易浏览。我想使用现有模型中的字段来动态构建 link_to 命令。我希望能够使用模型上包含用户单击的文本的多个字段和模型中包含链接的另一个字段来构建变量。

这是我的控制器中的代码：

```
MediaLibrary.find(:all, conditions: ["media_type_id < ?", 3], limit: 5).each do |media_item|
  @audio_links["link_text"] = "Audio of #{MediaCreator.find(media_item.media_creator_id).name} #{media_item.media_created.to_time.strftime('%A, %B %d, %Y')} at #{media_item.meeting_time}
   #{media_item.am_pm} - #{media_item.name}" 
  @audio_links["link"] = media_item.link
end 
```

这是我认为的代码：

```
<% @audio_links.each do |audio_link| %>
  <li>
    <%= link_to audio_link["link_text"], '#{audio_link["link"]}'  %>
  </li>
<% end %> 
```

我还尝试了以下方法：

```
<% @audio_links.each do |audio_link| %>
  <li>
    <%= link_to 'audio_link["link_text"]', '#{audio_link["link"]}'  %>
  </li>
<% end %> 
```

还有这个：

```
<% @audio_links.each do |audio_link| %>
  <li>
    <%= link_to '#{audio_link["link_text"]}', '#{audio_link["link"]}'  %>
  </li>
<% end %> 
```

我尝试了更多变体，但是当我尝试显示屏幕或链接显示时，我在 link_to 命令上得到了**can't convert String into Integer错误，其中显示的文本如下所示。**发生这种情况时，单击链接时会出现其他错误。

```
#{audio_link["link_text"]} 
```

我在 Stack Overflow 和整个网络上进行了很多搜索。我还没有在任何地方找到一个这样的例子。我在旧帖子中看到有 set_path 命令（2010），但最近的帖子没有。我用过 html_safe！之前并将其添加到我的代码中。我不知道我的代码是否有问题，或者我是否正在尝试一些不可能的事情。我真诚地希望这是可能的，因为它会让有语音阅读器的人更容易知道他们在点击什么。

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:23:07.400

您不能在单引号中进行字符串插值。用双引号替换单引号，您的变量将被正确扩展。

例如：

```
<%= link_to audio_link["link_text"], "#{audio_link['link']}"  %> 
```

# jenkins - Windows Jenkins Master 可以拥有 Linux Jenkins Slave 吗？

> ID：14489567
> 
> 赞同：2
> 
> 时间：2013-01-23T21:19:28.113
> 
> 标签：jenkins

我已经用 Windows 从站设置了很多 Windows 主站。

我有设置 Linux Master 的说明。

但是，我真正想做的是在 Windows 主机上设置一个 Linux (ubuntu) 从站。

问题是我的 Windows 主机没有用于从机的 SSH 选项，因此似乎没有任何 Linux 从机指令适用。

任何想法，如果这是可能的，如果可以，如何去做？

坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:29:21.237

在不同的操作系统上运行主机之间应该没有任何重大差异。

我以为[SSH Slaves 插件](https://wiki.jenkins-ci.org/display/JENKINS/SSH+Slaves+plugin)是默认安装的，但如果没有，您可以尝试从插件中心安装它。

# jquery - 单击时选择框？打开选择框时隐藏第一项，关闭时显示？

> ID：14489569
> 
> 赞同：0
> 
> 时间：2013-01-23T21:19:30.177
> 
> 标签：jquery, select, drop-down-menu

我有这个……</p>

```
<select class="wr-dropdown">
    <option selected="" value="Navigation">Navigation</option>
    <option value="something">Something</option>
    <option value="something">Something</option>
    …
</select> 
```

单击下拉菜单时，我想隐藏第一个选项“导航”……当进行选择或关闭下拉菜单时，我想再次显示它。

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-28T07:40:38.263

打开选择时，您可以使用普通的HTML隐藏选项的第一个元素：

```
<select name="list">
<option selected="selected" hidden>First Element</option>
<option>Second Element</option>
<option>Third Element</option>

</select> 
```

这是工作小提琴：[https ://jsfiddle.net/sujan_mhrzn/y5kxtkc6/](https://jsfiddle.net/sujan_mhrzn/y5kxtkc6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T22:02:07.660

如果您不喜欢第二个选项使用 Andrews Method 跳转到选择框的方式，顺便说一句，这是一个很好的例子。你可以这样做：

```
 $("select").focus(function(){  
    $(this).find("option").eq(0).html(''); 
 })
$("select").blur(function(){ 
   $(this).find("option").eq(0).html('Navigation');
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:28:14.547

```
$("select").focus(function(){  
    $(this).find("option").eq(0).remove(); 
 })
$("select").blur(function(){ 
    $(this).prepend("<option selected='selected'>Navigation</option>");
}) 
```

这行得通。

这是小提琴：http: [//jsfiddle.net/klatzkaj/38tpv/](http://jsfiddle.net/klatzkaj/38tpv/)

# svn - Subversion：如何预览提交？

> ID：14489571
> 
> 赞同：6
> 
> 时间：2013-01-23T21:19:37.497
> 
> 标签：svn

有没有办法列出将在我的本地副本中修改、添加和删除的所有文件，以便我可以在提交前进行完整性检查？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:29:17.040

您尝试做的确实是每次提交之前的一个好习惯。

在 Windows 上，您应该使用 TortoiseSVN。结合比较工具（Beyond Compere 等）是您的赢家工具。

在 Linux 机器上，您可以使用`svn st`（简写`svn staus`）来查看修改/删除/添加的文件并`svn diff <file>`查看更改。我使用以下命令以更漂亮的形式查看差异：

```
svn diff <file> | vim - 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:36:06.203

如果您使用 TortoiseSVN，最好的方法是右键单击您的本地副本。选择“ **TortoiseSVN”-->“检查修改”。**

这将为您提供所需的清单。

如果没有，正如有人建议的那样，请在命令行上使用**svn status 。**

这是给你你正在寻找的东西......

# awk - 使用 awk 从午夜后的微秒转换时间戳

> ID：14489572
> 
> 赞同：1
> 
> 时间：2013-01-23T21:19:54.923
> 
> 标签：awk

我有一个大的 linux 文件，它在每一行上打印出一个时间戳，标记为午夜过后的微秒。我一直在尝试想出一个聪明的短 awk 脚本，它将使用 awk 将其更改为 YY-mm-d HH:MM:SS.ms 格式（我在这里查看了其他一些帖子，但大多数都处理转换从时代开始，而不是从今天午夜开始）。我已经用 strftime 尝试了一些东西，但似乎没有什么能让我得到正确的日期和时间。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T22:28:19.260

我假设“自午夜以来的微秒”是指整数微秒

```
echo 86399123456 | awk '
    BEGIN { midnight = mktime(strftime("%Y %m %d 0 0 0", systime())) }
    {
        seconds = $1 / 1e6
        fraction = $1 % 1e6
        printf "%s.%06d\n", strftime("%Y-%m-%d %T", midnight + seconds), fraction
    }
' 
```

输出

```
2013-01-23 23:59:59.123456 
```

# php - 自动裁剪，自制 GPS 跟踪

> ID：14489573
> 
> 赞同：0
> 
> 时间：2013-01-23T21:19:57.047
> 
> 标签：php, jquery, image, gps, photoshop-script

我有这张图片： ![在此处输入图像描述](../Images/c1f4b9b4670d98824133b4f393a83ef1.png)

我想自动裁剪蓝色矩形之外的任何东西。

为什么？

我计划使用这张图片和我们在现场的一些 GPS 设备。我有指示不要使用谷歌地图/地球。使用尺寸等于图像像素的 div，我将 div 的背景图像设置为图片。然后使用我们数据库中的 gps 数据，在 div 中绘制一个点和标签。

蓝色框的一角表示标记的确切坐标。因此，不需要蓝色框外的所有内容，并且会通过我的积分来绘制。

想知道是否可以向我添加图像上传脚本以自动裁剪图像。

或者，如果在阅读本文时有人认为我很愚蠢并走上了一条艰难的道路，请叫我出来。

先感谢您。

# ruby-on-rails - 将变量传递给rails中的电子邮件模板

> ID：14489575
> 
> 赞同：0
> 
> 时间：2013-01-23T21:20:04.537
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

嗨，忘记这一切，我明白这不起作用的逻辑。更新的问题；

当在 URL 中获取类时，我将如何在我的控制器中定义运行并执行以下操作；

1）我需要为 current_user 找到所有“工作”我猜是这样的；

```
@joblisting = current_user.Joblisting.find(params[:id) 
```

2）然后我需要接受这些工作并检查他们的列“job_status”是否包含“已完成”文本或其他“

3）如果jobs_status是“完成”那么我需要运行代码所以我做一个“如果”

4）我必须通过计算。

```
@joblisting = current_user.Joblisting.find(params[:id]
   if @joblisting.where(:project_status => "completed")
      number_to_currency(current_user.Joblisting.where(:project_status => 'completed').sum('jobprice') * 1.60 - current_user.Joblisting.where(:project_status => 'completed').sum('jobprice'))
      Notifier.notify_payout(current_user).deliver
      @joblisting.project_status = 'paid'
      @joblisting.save
end 
```

这就是我所拥有的，我坚持将计算传递给 Notifier.notify_payout 模板。

我敢肯定，谁比我更了解 Rails，谁都会马上看到我的错误。

# python - 为什么 [].extend(list1) 不创建与 list1 相同的列表？

> ID：14489576
> 
> 赞同：0
> 
> 时间：2013-01-23T21:20:05.383
> 
> 标签：python

> **可能重复：**
> [Python 列表扩展和变量赋值](https://stackoverflow.com/questions/9724356/python-list-extension-and-variable-assignment)

字符串的类比是正确的：

```
string1 = 'abc'
''.join(string1) == string1 # True 
```

那么为什么这不成立：

```
list1 = ['a', 'b', 'c']
[].extend(list1) == list1 # AttributeError: 'NoneType' object has no attribute 'extend' 
```

`type([])`返回列表。为什么它会被视为 NoneType 而不是具有扩展方法的列表？

这是一个学术问题。我不会这样做是常规代码，我只是想了解。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T21:21:20.883

因为`list.extend()`修改了列表并且不返回列表本身。你需要做的是得到你所期望的：

```
lst = ['a', 'b', 'c']
cplst = []
cplst.extend(lst)
cplst == lst 
```

您引用的功能并不是真正相似的。 返回通过将迭代器的成员与正在编辑`join()`的字符串连接在一起而创建的新字符串。`join`类似的`list`操作看起来更像：

```
def JoiningList(list):

    def join(self, iterable):
        new_list = iterable[0]
        for item in iterable[1:]:
            new_list.extend(self)
            new_list.append(item)
        return new_list 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-23T21:21:46.780

您正在尝试将扩展名的**返回值与列表进行比较。**`extend`是就地操作，这意味着它不返回任何内容。

`join`另一方面，实际上返回的是运算的结果，因此可以比较两个字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:23:53.243

```
>>> first = [1,2,3]
>>> second = []
>>> second.extend(first)
>>> first == second
True 
```

# android - Android RadioGroup getCheckedRadioButtonId 不一致

> ID：14489578
> 
> 赞同：0
> 
> 时间：2013-01-23T21:20:14.847
> 
> 标签：android, android-widget

我正在使用带有几个单选按钮的单选组。我实现`RadioGroup.OnCheckedChangedListener(RadioGroup group, int checkedId)`了，也是`RadioGroup.getCheckedRadioButtonId()`。

但是，无论我点击哪个按钮，该方法`RadioGroup.getCheckedRadioButtonId`总是返回我的单选按钮的一个相同 ID。监听器工作得很好。

我在这里看到一些帖子说上述方法有效，有人知道发生了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:57:27.433

我正在调试，突然间我意识到我得到这个错误的原因。

当我创建无线电组时，我将其*设为 static*，我猜从 getCheckedRadioButtonId() 返回的相同 id 是默认 id。在 checkchangedlistener(RadioGroup rg, int id) 中，rg 与我的静态无线电组不同。哎呀

# c# - 从 html.listboxfor 中获取所选项目而不在 MVC 中发布帖子

> ID：14489580
> 
> 赞同：1
> 
> 时间：2013-01-23T21:20:17.593
> 
> 标签：c#, asp.net-mvc, html

我正在启动 MVC，但这就是我想要的。

我在一侧有一个项目列表，在另一侧有一个文本框。我想单击列表中的一个项目并让文本框显示该项目的文本，但不使用按钮或帖子；类似于“ `OnSelectedIndexChanged`”的东西。

这就是我到目前为止所拥有的。

控制器：

```
public ActionResult Index()
{
    var model = new TestModel();
    model.ListOfItems = new List<SelectListItem>();
    SelectListItem item = new SelectListItem();
    item.Text = "Item's text";
    item.Value = "Value for the list";
    model.ListOfItems.Add(item);
    return View(model);
} 
```

模型：

```
public int[] ItemId { get; set; }
public List<SelectListItem> ListOfItems { get; set; } 
```

看法：

```
<script type="text/javascript">
function showText() {
    var selectedItem = itemsList.options.selectedIndex;
    txtValue.Text = selectedItem.value;
}
</script>
<h2>Test</h2>

@Html.ListBoxFor(x => x.ItemId, new MultiSelectList(Model.ListOfItems, "Text", "Value", Model.ItemId), new { size = 6, id = "itemsList", OnChange = "showText" })
@Html.TextBox("itemText", "", new { id = "txtItem" }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:30:36.513

有一些 javascript 监听列表框上的点击事件并获取项目文本并设置为另一个文本框的值

```
$(function(){

  $("#ItemId option").click(function () {
    var _this = $(this);
    $("#txtItem").val($(_this).text());
  });

}); 
```

工作样本：http: [//jsfiddle.net/w4sxw/](http://jsfiddle.net/w4sxw/)

假设您已将 jQuery 加载到页面。

# mysql - MySQL UPDATE QUERY 重复错误

> ID：14489583
> 
> 赞同：0
> 
> 时间：2013-01-23T21:20:40.757
> 
> 标签：mysql, sql-update

让我们看看我能否确定这个问题，因为这对我的中级 MySQL 技能来说相当复杂。

问题：

我需要更新我的一个数据库表中的一些数据。问题是我正在更新的数据与不止一行相关联。

id mailing_list_id 订阅者 ID

9031 51 81053

9112 52 81053

13535 71 81053

我需要更新 mailing_list_id 52 并将其重命名为 51 但subscriber_id 已经存在且 mailing_list_id 为 51 所以我想在更新期间跳过该记录。

当我使用以下内容时：

更新订阅 SET mailing_list_id = 51 WHERE mailing_list_id = 52;

我收到一条错误消息，提示存在重复条目。

我需要做的是忽略查询中的重复项，但我不知道如何编写查询。任何帮助，将不胜感激。

我需要在我的查询中添加一些内容，以跳过订阅者 ID 已经具有邮件列表 ID 的行 # 与我尝试将其更改为的行相同。不确定这是否有意义，或者在这一点上我是否在漫无目的。我知道我想做什么我只是不知道实现它的查询语法或方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:31:34.673

哪个字段 mailing_list_id 有索引（唯一或主要）？如果是，那么您无法更改其他行中存在的数据。

解决方案是： 1\. 您删除字段 mailing_list_id 中的额外键（唯一或主键）。2.或者您创建新表并删除表，删除表订阅后，在下面运行查询以创建新表订阅。

```
CREATE TABLE subscriptions (
     id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
     mailing_list_id INT(11),
     subscriber_id INT(11)
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:30:06.367

虽然我不建议将其作为永久解决方案，但这应该可以消除您的错误，这样您就可以在规划更好的模式时让事情正常进行 - 唯一键`REPLACE INTO`等。

```
UPDATE IGNORE subscriptions SET mailing_list_id = 51 WHERE mailing_list_id = 52; 
```

# c# - 更新 DATETIME 列，其中说 DATETIME < 当前 DATETIME

> ID：14489589
> 
> 赞同：0
> 
> 时间：2013-01-23T21:21:02.817
> 
> 标签：c#, asp.net, sql-server

我有一个 ASP.NET 4.0 C# Web 应用程序，它允许多个用户同时更新 SQL Server DB 中的行。我正在尝试提出一个快速系统，该系统将阻止 USER1 更新自 USER1 上次刷新页面以来 USER2 更新的行。

我遇到的问题是我的网络应用程序总是更新行，即使我认为它不应该。但是当我手动运行查询时，它只会在我认为应该更新时更新。

这是我在 C# 中的 SQL 查询：

```
SQLString = "update statuses set stat = '" + UpdaterDD.SelectedValue +
            "', tester = '" + Session["Username"].ToString() +
            "', timestamp_m = '" + DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss.fff") +
            "' where id IN (" + IDs + ") and timestamp_m < '" + PageLoadTime + "';"; 
```

这是一个“现实世界”的例子：

```
SQLString = "update statuses set stat = 'PASS', tester = 'tester007',
             timestamp_m = '2013-01-23 14:20:07.221' where id IN (122645) and
             timestamp_m < '2013-01-23 14:20:06.164';" 
```

我的想法是，只有在用户上次加载页面后没有其他用户更改此行时，这才会更新。`PageLoadTime`如您所见，我已将其格式化为与我的 SQL Server DB 相同的格式`DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss.fff")`，但仍有问题。

有谁知道为什么我得到两个不同的结果？我想做的甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:51:16.710

我真的认为问题在于页面加载时间设置不正确，或者在 DB 调用之前立即设置。对于调试，您可以尝试将您知道将允许或禁止插入的值硬编码到其中。

这是您所拥有的参数化版本。我还让数据库服务器将时间戳设置为其当前时间，而不是传递一个值。如果您的数据库服务器和您的 Web 服务器的时间可能不同步，请自行设置。

使用参数化，您不必担心日期/时间格式是否正确。我不知道 stat、tester 和 timestamp_m 的 DB 类型是什么，因此添加参数 DB 类型可能需要调整。

```
string sql = "update statuses set stat = @stat, tester = @tester" +
        ", timestamp_m = getdate()" +
        " where id IN (" + IDs + ") and timestamp_m < @pageLoadTime";

SQLConnection conn = getMeASqlConnection();

SQLCommand cmd = new SQLCommand(sql, conn);

cmd.Parameters.Add("@stat", System.Data.SqlDbType.NVarChar).Value = UpdaterDD.SelectedValue;
cmd.Parameters.Add("@tester", System.Data.SqlDbType.NVarChar).Value = Session["Username"].ToString();
// Here, pageLoadTime is a DateTime object, not a string
cmd.Parameters.Add("@pageLoadTime", System.Data.SqlDbType.DateTime).Value = pageLoadTime; 
```

# java - 遍历数组 - java

> ID：14489590
> 
> 赞同：33
> 
> 时间：2013-01-23T21:21:05.370
> 
> 标签：java, arrays

我想知道是否最好有一个方法并将其传递`Array`给该方法，或者每次我想检查一个数字是否在`array`.

例如：

```
public static boolean inArray(int[] array, int check) {

    for (int i = 0; i < array.length; i++) {
        if (array[i] == check) 
            return true;
    }

    return false;
} 
```

我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-01-23T21:37:17.227

至少从 Java 1.5.0 (Java 5) 开始，代码可以稍微清理一下。`Array`s 和任何实现`Iterator`（例如`Collection`s）的东西都可以这样循环：

```
public static boolean inArray(int[] array, int check) {
   for (int o : array){
      if (o == check) {
         return true;
      }
   }
   return false;
} 
```

在 Java 8 中，您还可以执行以下操作：

```
// import java.util.stream.IntStream;

public static boolean inArray(int[] array, int check) {
   return IntStream.of(array).anyMatch(val -> val == check);
} 
```

尽管为此转换为流可能是矫枉过正。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-23T21:34:10.467

您绝对应该将此逻辑封装到一个方法中。

多次重复相同的代码没有任何好处。

此外，如果您将逻辑放在一个方法中并且它发生了变化，您只需要在一个地方修改您的代码。

是否要使用 3rd 方库是一个完全不同的决定。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-23T21:22:43.797

如果您使用的是数组（并且纯粹是数组），“包含”的查找是`O(N)`，因为最坏的情况是，您必须迭代整个数组。现在，如果对数组进行排序，您可以使用二进制搜索，这将搜索时间减少到`log(N)`排序的开销。

如果这是重复调用的内容，请将其放在一个函数中：

```
private boolean inArray(int[] array, int value)
{  
     for (int i = 0; i < array.length; i++)
     {
        if (array[i] == value) 
        {
            return true;
        }
     }
    return false;  
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-23T21:26:26.863

您可以导入 lib org.apache.commons.lang.ArrayUtils

有一个静态方法，您可以在其中传递一个 int 数组和一个要检查的值。

contains(int[] array, int valueToFind) 检查值是否在给定的数组中。

```
ArrayUtils.contains(intArray, valueToFind); 
```

[ArrayUtils API](http://commons.apache.org/lang/api-2.1/org/apache/commons/lang/ArrayUtils.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-26T07:19:53.767

使用 java 8 Stream API 可以简化您的工作。

```
public static boolean inArray(int[] array, int check) {
    return Stream.of(array).anyMatch(i -> i == check);
} 
```

只是您有创建新`Stream`from的开销`Array`，但这提供了使用其他`Stream`API 的机会。在您的情况下，您可能不想为单线操作创建新方法，除非您希望将其用作实用程序。希望这可以帮助！

# graphics - 在 3D 图形中，为什么不经常使用纹理来实现抗锯齿？

> ID：14489592
> 
> 赞同：1
> 
> 时间：2013-01-23T21:21:07.357
> 
> 标签：graphics, 3d, antialiasing, multisampling

通常，使用诸如超级采样或多重采样之类的技术来生成高保真图像。

我最近一直在使用 CSS3 3D 处理移动设备，[这个技巧](https://stackoverflow.com/a/9333891/340947)在获得四边形的高质量非锯齿边缘方面做得非常出色。

这个技巧的工作方式是四边形的纹理在每个维度上获得两个额外的像素，在边界外形成一个透明的一个像素宽的轮廓。由于纹理采样插值，只要变换不会使相机过于靠近边缘，效果与预过滤抗锯齿渲染方法没有什么不同。

例如，采用这种方法渲染 3D 模型的概念和技术限制是什么？

我想我已经有一点可以排除在一般情况下使用这种技巧。当几何图形不是矩形时，它对减少锯齿没有任何作用：对于带有 CSS3 的 HTML5，具有透明 1px 轮廓边框的结果是平滑的，这取决于这些元素是矩形的，以便它们整齐地光栅化成像素网格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:36:33.923

您链接到的技巧似乎与纹理插值无关。CSS 添加了一个绘制为线条的边框。浏览器中的光栅化器正在绘制没有抗锯齿的多边形，并且正在绘制带有抗锯齿的线条。

要回答您为什么不想在 1 像素边框上融入透明度的问题是，透明度很难正确绘制，并且当多边形不是从后向前绘制时可能会导致伪影。您需要根据距离对多边形进行预排序，或者使用不透明的多边形来检查是否使用深度缓冲区和多重采样进行遮挡。

# apache - 如何在cygwin中设置psql命令？

> ID：14489594
> 
> 赞同：14
> 
> 时间：2013-01-23T21:21:11.920
> 
> 标签：apache, postgresql, cygwin, psql

我的机器上有一个本地开发站点，带有 Apache 服务器和 PostgreSQL 9.1 数据库。当我使用 Windows 时，我还安装了 Cygwin。我想通过 pgAdmin III 的 Cygwin insead 访问数据库并进行一些查询，但它告诉我找不到 psql 命令。我应该如何在 cygwin 中设置 psql 命令？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2017-01-11T02:14:03.397

到今天为止，你只需要在 cygwin中安装*postgresql-client包：*

*   运行 cygwin *setup.exe*文件（可以多次运行以添加更多包）。
*   在搜索框中输入 postgresql，选择postgresql *-* *client*并按“下一步”进行安装。

[![在此处输入图像描述](../Images/08b125214d1db46e44a8529f5f3ecbe4.png)](https://i.stack.imgur.com/dEH7b.png)

现在你可以打开 Cygwin 终端并输入*psql*来运行！

[![在此处输入图像描述](../Images/41ceefd920cdeec4846242a37d3bdc96.png)](https://i.stack.imgur.com/Mq6Qy.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-05-25T18:01:06.097

The best combo for Cygwin on Windows, I've found, is the normal Windows Postgres installation combined with Cygwin psql.

Cygwin psql (and other command-line tools) can be compiled from source fairly easily. Here's the steps for 9.2.4:

```
$ wget http://ftp.postgresql.org/pub/source/v9.2.4/postgresql-9.2.4.tar.bz2
$ tar xjf postgresql-9.2.4.tar.bz2
$ cd postgresql-9.2.4/
$ ./configure
$ cd src/bin/psql
$ make 
```

This creates a psql.exe binary that works well with Cygwin. However, by default, it tries to connect to the local instance using a Unix socket instead of TCP. So use -h to specify the hostname and force TCP, for example:

```
$ ./psql -h localhost -U postgres 
```

Move this psql.exe to someplace on your path (e.g. ~/bin) and possibly wrap in a script to add '-h localhost' for convenience when no other arguments supplied.

The source could be modified to change the default, but that takes actual work ;)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-22T06:35:05.437

如果我正确理解您的问题，您正在运行 cygwin，因为您想在 Windows 上通过 bash 和 psql 对 PostgreSQL 运行查询，对吗？

Cygwin 可以从 bash 运行 Windows 二进制文件，因此请安装本机 Windows 版本并确保 psql.exe 在`PATH` 您应该能够在必要时复制可执行文件。

无需安装 PostgreSQL 的本机 Cygwin 版本。只需使用现有的 psql 工具，并确保您可以访问 Windows 原生 psql.exe。

# node.js - mongoose 从嵌套文档中移除

> ID：14489596
> 
> 赞同：4
> 
> 时间：2013-01-23T21:21:19.133
> 
> 标签：node.js, mongodb, mongoose

我有以下两个模式和模型：

```
var Customer = new Schema({
    name: String,
    jobs: [{ type: Schema.Types.ObjectId, ref: 'Job' }]
});

var Job = new Schema({
    title: String,
    customer: { type: Schema.Types.ObjectId, ref: 'Customer' }
});

var CustomerModel = mongoose.model('Customer', Customer);
var JobModel = mongoose.model('Job', Job); 
```

工作文档通过_id 引用客户文档，并且客户文档还包含所有工作_id 的数组。

当我删除作业时，我需要从 Customer.jobs 数组中删除相应的 _id。

这是我的路线 - 作业被删除，但我无法从数组中删除它的 id

```
app.delete('/api/jobs/:jobId', function(req, res){
    return JobModel.findById(req.params.jobId, function(err, job){
        return job.remove(function(err){
            if(!err){
                CustomerModel.update({_id: job.customer._id}, {$pull : {'customer.jobs' : job.customer._id}}, function(err, numberAffected){
                        console.log(numberAffected);
                        if(!err){
                            return console.log('removed job id');
                        } else {
                            return console.log(err);
                        }
                    });
                console.log('Job removed');
                return res.send('');
            } else{
                console.log(err);
            }
        });
    });
}); 
```

numberAffected 始终为 0，并且“已删除的工作 id”总是被解雇

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T23:03:56.097

你的`$pull`. 试试这个：

```
CustomerModel.update({_id: job.customer}, {$pull : {jobs : job._id}}, ... 
```

# .net - 实体框架：向关系表添加信息但保留 EF 对象格式

> ID：14489598
> 
> 赞同：3
> 
> 时间：2013-01-23T21:21:25.483
> 
> 标签：.net, sql-server, linq, entity-framework

如果我有 3 张桌子：

> **客户**
> CustID
> 姓名
> 电子邮件
> 
> **列表**
> ListID
> 标题
> 
> **客户**
> 列表客户
> ID 列表 ID

实体框架使获取客户列表变得非常容易。

```
db.Customers.FirstOrDefault(c => c.Name == "Bob").Lists 
```

我需要保存创建关系表的时间戳，这样我就可以看到客户何时被添加到列表中。

我不想在关系表中添加列“时间戳”，因为它会与直观的 LINQ 功能混淆，因为该表`CustomersLists`出现而不是`Customer.Lists`.

我有大约 12 个表需要这个时间戳，其中大多数没有多对多的关系。只是钓鱼，看看是否有人有一个我忽略的非常好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T09:16:21.563

不要映射`timestamp`in EF 映射。`timestamp`并将数据库层上该列的默认值设置为： `getDate()`。它将在插入时将其设置为当前的“日期时间”。

# c++ - 实时和非实时应用程序的日志记录工具

> ID：14489599
> 
> 赞同：9
> 
> 时间：2013-01-23T21:21:27.607
> 
> 标签：c++, linux, logging, real-time

我们正在开发在 RT-Linux 上运行的标准和实时应用程序。问题是，*从实时和非实时进程记录应用程序跟踪的有效方法*是什么？

*高效*，我的意思是记录应用程序跟踪的过程不应因增加延迟等而导致 RT-perf 受到影响。

理想情况下，跟踪应该存储在带有时间戳的单个文件中，以便更容易跟踪进程之间的交互。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:35:48.570

对于实时记录，我建议使用与裸记录到文件不同的方法。向文件写入大量信息**会**损害您的性能。

我可以建议其他更轻的机制：

*   使用统计信息/计数器来填写您的应用程序正在执行的操作
*   以某种二进制格式写入/编码日志以进行离线处理。这种二进制格式可能更紧凑，因此更轻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:35:28.257

由于您使用的是 linux，因此您可以使用[syslog()](http://linux.die.net/man/3/syslog)：

> openlog() 为程序打开与系统记录器的连接。

这意味着您的程序将消息转发到另一个可能具有低优先级的程序。

如果您想要更花哨的东西，请[提高日志记录](http://boost-log.sourceforge.net/libs/log1/doc/html/index.html)。

# svn - Subversion：如何将更改、修改和删除的文件导出到我的本地副本？

> ID：14489605
> 
> 赞同：0
> 
> 时间：2013-01-23T21:21:48.723
> 
> 标签：svn

我想将在开发机器上的本地副本上所做的更改迁移到生产机器上的本地副本。从我的本地副本导出更改的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:37:34.297

我这样做的方法是将开发机器上的更改提交到存储库，然后更新生产机器结帐。这可确保正确记录和更新所有内容。

但是，我认为这不是您的情况的理想选择（或者您没有从生产服务器上的存储库中进行签出），因此最简单的方法是导出您的开发机器签出，然后覆盖生产机器复制。如果您不删除生产副本，那么只有开发导出中的文件会被覆盖，并且您将保留您可能拥有的任何生产特定文件（日志文件等）。

一个风险稍低的选项（为了安全起见，我会这样做）是只复制那些在开发结帐中修改过的文件，并在生产副本中覆盖它们的对应文件。这更加手动（除非您编写脚本来自动化复制到生产），但您可以保证不会覆盖生产副本上您不打算覆盖的任何内容。

我之前已经完成了所有三种方法，老实说，我更喜欢第一种，因为它简单、可逆和日志记录。如果出现问题，我可以立即恢复到上一个​​稳定副本，并且非常容易检查生产使用的代码库版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T05:12:34.257

如果“本地副本”必须翻译为“工作副本”并且这些 WC 链接到 repo 中的相同 Repository 和 URL，您可以

*   从 DEV WC 提交更改
*   在 PROD 端更新 WC

PS - 如果您不想将废料提交到主干，您可以在提交之前重新定位到 repo 内的任何其他位置，并在更新之前重新定位 PROD WC

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T22:08:21.300

这里有一个比较重，购买有效的方法。如果可以从同一台机器访问两个目录，例如作为 Windows 共享或临时挂载，请使用[WinMerge](http://winmerge.org/)或[Meld](http://meldmerge.org/)等工具来找出差异并选择要复制的文件。

否则，将生产机器上的修订版导出到开发机器上的空目录；使用相同的工具删除导出的源代码树中的公共文件并将您的更改复制到它。此时，您的导出目录将包含您要复制到生产机器的文件。

# r - 在 MongoDB (rmongodb) 中附加 BSON 数组

> ID：14489612
> 
> 赞同：1
> 
> 时间：2013-01-23T21:22:41.810
> 
> 标签：r, mongodb, crud, rmongodb, nosql

我找到[了](http://docs.mongodb.org/manual/reference/operator/push/)有关如何使用`$push`运算符向数组添加新值的信息。但是，我似乎无法使用[rmongodb](http://www.google.de/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDMQFjAA&url=http://cran.r-project.org/package=rmongodb&ei=h1EAUc_SNpHEtAbttYHwCA&usg=AFQjCNFN9MJ2U7G7L4qgqWhNM0oMVKCVkw&bvm=bv.41248874,d.Yms)

假设我们在数据库中有以下文档

```
_id : 7      51005201f8ab44f1690f9526
tags : 4     
    1 : 2    a
    2 : 2    b
    3 : 2    c 
```

我想为数组添加一个值`tags`。这是我尝试过的：

```
q <- mongo.bson.from.list(list(tags="a")) 
```

# 试一试

在这里，我尝试使用[$push](http://docs.mongodb.org/manual/reference/operator/push/)运算符

## 代码

```
bnew <- mongo.bson.from.list(list("$push"=list("tags"="d")))

> mongo.update(mongo=con, ns, criteria=q, objNew=bnew)
[1] FALSE 
```

## 日志文件

```
Thu Jan 24 16:42:27 [initandlisten] MongoDB starting : pid=6260 port=27017 dbpath=\data\db\ 64-bit host=ASHB-109C-02
Thu Jan 24 16:42:27 [initandlisten] db version v2.2.2, pdfile version 4.5
Thu Jan 24 16:42:27 [initandlisten] git version: d1b43b61a5308c4ad0679d34b262c5af9d664267
Thu Jan 24 16:42:27 [initandlisten] build info: windows sys.getwindowsversion(major=6, minor=1, build=7601, platform=2, service_pack='Service Pack 1') BOOST_LIB_VERSION=1_49
Thu Jan 24 16:42:27 [initandlisten] options: { logpath: "log_1.txt" }
Thu Jan 24 16:42:27 [initandlisten] journal dir=/data/db/journal
Thu Jan 24 16:42:27 [initandlisten] recover : no journal files present, no recovery needed
Thu Jan 24 16:42:27 [initandlisten] waiting for connections on port 27017
Thu Jan 24 16:42:27 [websvr] admin web console waiting for connections on port 28017
Thu Jan 24 16:42:36 [initandlisten] connection accepted from 127.0.0.1:52419 #1 (1 connection now open)
Thu Jan 24 16:42:44 [conn1]  __test.test Assertion failure x == _nfields src\mongo\db\jsobj.cpp 1250
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\util\stacktrace.cpp(161)                           mongo::printStackTrace+0x3e
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\util\assert_util.cpp(109)                          mongo::verifyFailed+0xdc
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\db\jsobj.cpp(1250)                                 mongo::BSONIteratorSorted::BSONIteratorSorted+0xf3
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\db\ops\update_internal.cpp(906)                    mongo::ModSetState::createNewFromMods+0xa3
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\db\ops\update.cpp(370)                             mongo::_updateObjects+0x15a2
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(573)                               mongo::receivedUpdate+0x60d
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(437)                               mongo::assembleResponse+0x626
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\db\db.cpp(192)                                     mongo::MyMessageHandler::process+0xf5
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\mongo\util\net\message_server_port.cpp(86)               mongo::pms::threadRun+0x59a
Thu Jan 24 16:42:44 [conn1] mongod.exe    ...\src\third_party\boost\libs\thread\src\win32\thread.cpp(180)  boost::`anonymous namespace'::thread_start_function+0x21
Thu Jan 24 16:42:44 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(314)      _callthreadstartex+0x17
Thu Jan 24 16:42:44 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(292)      _threadstartex+0x7f
Thu Jan 24 16:42:44 [conn1] kernel32.dll                                                                   BaseThreadInitThunk+0xd
Thu Jan 24 16:42:44 [conn1] update __test.test query: { tags: "a" } update: { $push: { tags: "d" } } nscanned:1 keyUpdates:0 exception: assertion src\mongo\db\jsobj.cpp:1250 locks(micros) w:398335 399ms
Thu Jan 24 16:42:48 CTRL_CLOSE_EVENT signal
Thu Jan 24 16:42:48 [consoleTerminate] got CTRL_CLOSE_EVENT, will terminate after current cmd ends
Thu Jan 24 16:42:48 [consoleTerminate] now exiting
Thu Jan 24 16:42:48 dbexit: 
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: going to close listening sockets...
Thu Jan 24 16:42:48 [consoleTerminate] closing listening socket: 496
Thu Jan 24 16:42:48 [consoleTerminate] closing listening socket: 516
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: going to flush diaglog...
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: going to close sockets...
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: waiting for fs preallocator...
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: lock for final commit...
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: final commit...
Thu Jan 24 16:42:48 [conn1] end connection 127.0.0.1:52419 (0 connections now open)
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: closing all files...
Thu Jan 24 16:42:48 [consoleTerminate] closeAllFiles() finished
Thu Jan 24 16:42:48 [consoleTerminate] journalCleanup...
Thu Jan 24 16:42:48 [consoleTerminate] removeJournalFiles
Thu Jan 24 16:42:48 [consoleTerminate] shutdown: removing fs lock...
Thu Jan 24 16:42:48 dbexit: really exiting now 
```

# 尝试 2

在这里，我尝试使用[$addToSet](http://docs.mongodb.org/manual/reference/operator/addToSet/)运算符

## 代码

```
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.start.object(buf, "$addToSet")
mongo.bson.buffer.start.object(buf, name="tags")
mongo.bson.buffer.start.array(buf, "$each")
values <- list("d", "e", "f")
for (ii in seq(along=values)) {
    mongo.bson.buffer.append(
        buf=buf, 
        name=as.character(ii),
        value=values[[ii]]
    )
}
mongo.bson.buffer.finish.object(buf)
mongo.bson.buffer.finish.object(buf)
mongo.bson.buffer.finish.object(buf)
bnew <- mongo.bson.from.buffer(buf)
bnew

> mongo.update(mongo=con, ns, criteria=q, objNew=bnew)
[1] FALSE 
```

## 日志文件

```
Thu Jan 24 16:43:52 [initandlisten] MongoDB starting : pid=4184 port=27017 dbpath=\data\db\ 64-bit host=ASHB-109C-02
Thu Jan 24 16:43:52 [initandlisten] db version v2.2.2, pdfile version 4.5
Thu Jan 24 16:43:52 [initandlisten] git version: d1b43b61a5308c4ad0679d34b262c5af9d664267
Thu Jan 24 16:43:52 [initandlisten] build info: windows sys.getwindowsversion(major=6, minor=1, build=7601, platform=2, service_pack='Service Pack 1') BOOST_LIB_VERSION=1_49
Thu Jan 24 16:43:52 [initandlisten] options: { logpath: "log_2.txt" }
Thu Jan 24 16:43:52 [initandlisten] journal dir=/data/db/journal
Thu Jan 24 16:43:52 [initandlisten] recover : no journal files present, no recovery needed
Thu Jan 24 16:43:52 [initandlisten] waiting for connections on port 27017
Thu Jan 24 16:43:52 [websvr] admin web console waiting for connections on port 28017
Thu Jan 24 16:43:57 [initandlisten] connection accepted from 127.0.0.1:52435 #1 (1 connection now open)
Thu Jan 24 16:44:27 [conn1]  __test.test Assertion failure x == _nfields src\mongo\db\jsobj.cpp 1250
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\util\stacktrace.cpp(161)                           mongo::printStackTrace+0x3e
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\util\assert_util.cpp(109)                          mongo::verifyFailed+0xdc
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\db\jsobj.cpp(1250)                                 mongo::BSONIteratorSorted::BSONIteratorSorted+0xf3
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\db\ops\update_internal.cpp(906)                    mongo::ModSetState::createNewFromMods+0xa3
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\db\ops\update.cpp(370)                             mongo::_updateObjects+0x15a2
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(573)                               mongo::receivedUpdate+0x60d
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(437)                               mongo::assembleResponse+0x626
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\db\db.cpp(192)                                     mongo::MyMessageHandler::process+0xf5
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\mongo\util\net\message_server_port.cpp(86)               mongo::pms::threadRun+0x59a
Thu Jan 24 16:44:28 [conn1] mongod.exe    ...\src\third_party\boost\libs\thread\src\win32\thread.cpp(180)  boost::`anonymous namespace'::thread_start_function+0x21
Thu Jan 24 16:44:28 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(314)      _callthreadstartex+0x17
Thu Jan 24 16:44:28 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(292)      _threadstartex+0x7f
Thu Jan 24 16:44:28 [conn1] kernel32.dll                                                                   BaseThreadInitThunk+0xd
Thu Jan 24 16:44:28 [conn1] update __test.test query: { tags: "a" } update: { $addToSet: { tags: { $each: [ "d", "e", "f" ] } } } nscanned:1 keyUpdates:0 exception: assertion src\mongo\db\jsobj.cpp:1250 locks(micros) w:390312 390ms
Thu Jan 24 16:44:33 [conn1] end connection 127.0.0.1:52435 (0 connections now open)
Thu Jan 24 16:44:37 CTRL_CLOSE_EVENT signal
Thu Jan 24 16:44:37 [consoleTerminate] got CTRL_CLOSE_EVENT, will terminate after current cmd ends
Thu Jan 24 16:44:37 [consoleTerminate] now exiting
Thu Jan 24 16:44:37 dbexit: 
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: going to close listening sockets...
Thu Jan 24 16:44:37 [consoleTerminate] closing listening socket: 496
Thu Jan 24 16:44:37 [consoleTerminate] closing listening socket: 500
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: going to flush diaglog...
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: going to close sockets...
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: waiting for fs preallocator...
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: lock for final commit...
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: final commit...
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: closing all files...
Thu Jan 24 16:44:37 [consoleTerminate] closeAllFiles() finished
Thu Jan 24 16:44:37 [consoleTerminate] journalCleanup...
Thu Jan 24 16:44:37 [consoleTerminate] removeJournalFiles
Thu Jan 24 16:44:37 [consoleTerminate] shutdown: removing fs lock...
Thu Jan 24 16:44:37 dbexit: really exiting now 
```

我在这里做错了什么？

* * *

# 附加信息

对于那些感兴趣的人：这是生成示例文档的代码

```
pkg <- "rmongodb"
lib <- file.path(R.home(), "library")
if (!suppressWarnings(require(pkg, lib.loc=lib, character.only=TRUE))) {
    install.packages(pkg, lib=lib)
    require(pkg, lib.loc=lib, character.only=TRUE)
}

# CONNECTION
db  <- "__test" 
ns  <- paste(db, "test", sep=".")
con <- mongo.create(db=db)

# ENSURE EMPTY DB
mongo.remove(mongo=con, ns=ns)

# INSERT
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.start.array(buf, name="tags")
values <- list("a", "b", "c")
for (ii in seq(along=values)) {
    mongo.bson.buffer.append(
        buf=buf, 
        name=as.character(ii), 
        value=values[[ii]]
    )
}   
mongo.bson.buffer.finish.object(buf)
mongo.bson.buffer.finish.object(buf)
b <- mongo.bson.from.buffer(buf)
mongo.insert(mongo=con, ns=ns, b=b) 
```

* * *

# 编辑 2013-01-29

正如 10gen 的[Tad Marshall](https://stackoverflow.com/users/1058798/tad-marshall)在他对我的[错误报告](https://jira.mongodb.org/browse/SERVER-8319?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=252431#comment-252431)的评论中所建议的那样，我重新运行了插入文档的代码，而 MongoDB 服务器在`--objcheck`模式下运行（验证 BSON 结构）并且瞧：服务器不会让我插入文档由于断言失败。如果我在没有`--objcheck`标志的情况下运行服务器，则插入成功（但这可能只是因为没有进行验证）。

**请注意，我尝试了将数组放在一起的两个不同版本，`tags`因为我的初始代码生成了一个文档，恕我直言，它与 MongoDB 的索引约定不同步：**

## （可能）无效的文件

我上面就是这样做的。我注意到我没有确保数组索引以`0`. 插入此文档将失败（请参阅下面的日志文件）

```
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.start.array(buf, name="tags")
values <- list("a", "b", "c")
for (ii in seq(along=values)) {
    mongo.bson.buffer.append(
        buf=buf, 
        name=as.character(ii), 
        value=values[[ii]]
    )
}   
mongo.bson.buffer.finish.object(buf) # finish array 'tags'
mongo.bson.buffer.finish.object(buf) # finish buffer
b <- mongo.bson.from.buffer(buf)
> b
    tags : 4     
        1 : 2    a
        2 : 2    b
        3 : 2    c 
```

## 有效文件

我确保索引以 开头`0`，所以这绝对应该是一个有效的 BSON 文档。但是插入这个文件也会失败（见下面的日志文件）

```
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.start.array(buf, name="tags")
values <- list("a", "b", "c")
for (ii in seq(along=values)) {
    mongo.bson.buffer.append(
        buf=buf, 
        name=as.character(ii-1), 
        value=values[[ii]]
    )
}   
mongo.bson.buffer.finish.object(buf) # finish array 'tags'
mongo.bson.buffer.finish.object(buf) # finish buffer
b <- mongo.bson.from.buffer(buf)
b
mongo.insert(mongo=con, ns=ns, b=b)
> b
    tags : 4     
        0 : 2    a
        1 : 2    b
        2 : 2    c 
```

## 日志文件

```
Tue Jan 29 14:20:46 [initandlisten] MongoDB starting : pid=6440 port=27017 

[...]

Tue Jan 29 14:20:59 [initandlisten] connection accepted from 127.0.0.1:62137 #1 (1 connection now open)
Tue Jan 29 14:21:03 [conn1] Assertion: 10307:Client Error: bad object in message
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\util\stacktrace.cpp(161)                           mongo::printStackTrace+0x3e
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\util\assert_util.cpp(154)                          mongo::msgasserted+0xc1
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\db\dbmessage.h(205)                                mongo::DbMessage::nextJsObj+0x103
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(784)                               mongo::receivedInsert+0xdb
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(434)                               mongo::assembleResponse+0x607
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\db\db.cpp(192)                                     mongo::MyMessageHandler::process+0xf5
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\mongo\util\net\message_server_port.cpp(86)               mongo::pms::threadRun+0x59a
Tue Jan 29 14:21:04 [conn1] mongod.exe    ...\src\third_party\boost\libs\thread\src\win32\thread.cpp(180)  boost::`anonymous namespace'::thread_start_function+0x21
Tue Jan 29 14:21:04 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(314)      _callthreadstartex+0x17
Tue Jan 29 14:21:04 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(292)      _threadstartex+0x7f
Tue Jan 29 14:21:04 [conn1] kernel32.dll                                                                   BaseThreadInitThunk+0xd
Tue Jan 29 14:21:04 [conn1] insert __test.test keyUpdates:0 exception: Client Error: bad object in message code:10307  0ms
Tue Jan 29 14:21:07 [conn1] Assertion: 10307:Client Error: bad object in message
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\util\stacktrace.cpp(161)                           mongo::printStackTrace+0x3e
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\util\assert_util.cpp(154)                          mongo::msgasserted+0xc1
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\db\dbmessage.h(205)                                mongo::DbMessage::nextJsObj+0x103
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(784)                               mongo::receivedInsert+0xdb
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\db\instance.cpp(434)                               mongo::assembleResponse+0x607
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\db\db.cpp(192)                                     mongo::MyMessageHandler::process+0xf5
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\mongo\util\net\message_server_port.cpp(86)               mongo::pms::threadRun+0x59a
Tue Jan 29 14:21:07 [conn1] mongod.exe    ...\src\third_party\boost\libs\thread\src\win32\thread.cpp(180)  boost::`anonymous namespace'::thread_start_function+0x21
Tue Jan 29 14:21:07 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(314)      _callthreadstartex+0x17
Tue Jan 29 14:21:07 [conn1] mongod.exe    f:\dd\vctools\crt_bld\self_64_amd64\crt\src\threadex.c(292)      _threadstartex+0x7f
Tue Jan 29 14:21:07 [conn1] kernel32.dll                                                                   BaseThreadInitThunk+0xd
Tue Jan 29 14:21:07 [conn1] insert __test.test keyUpdates:0 exception: Client Error: bad object in message code:10307  0ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T18:40:56.930

Rappster，这两个示例在我的开发机器上都对我有用，但是我在运行 mongod 2.1.0 的调试版本时稍微过时了。

由于您正在使用示例代码使服务器崩溃，这是 10 代人想要了解的内容。你介意去[https://jira.mongodb.org/secure/Dashboard.jspa](https://jira.mongodb.org/secure/Dashboard.jspa)报告这个错误吗？

谢谢，

杰拉德·林兹利

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T08:56:10.793

哦，我现在正在打自己。我没有仔细查看您创建文档的方式。当您只需要一个来完成您开始的数组时，您有两个 mongo.bson.finish.object() 调用。你不需要调用它来完成一个 BSON。mongo.bson.from.buffer() 进行必要的内务处理。这是我没有足够仔细地阅读您的代码的错。当文档的初始插入是问题时，我认为这是您的更新失败。对于将来的问题，如果您的示例更易于阅读，将会有所帮助。例如，这将构建文档：

```
library('rmongodb')
m = mongo.create()
ns = '__test.test'
mongo.insert(m, ns, list(tags=c('a', 'b', 'c')) 
```

但是，您可能正在粘贴真实世界的代码，所以我知道复杂性来自哪里。一切都很酷。只是因为错过了这一点而自责，并让你大吃一惊。问候

# powershell - 可以使用 ISE 作为嵌入式 Powershell 的主机吗？

> ID：14489616
> 
> 赞同：0
> 
> 时间：2013-01-23T21:22:49.000
> 
> 标签：powershell

我正在将 Powershell 支持作为内部自动化/脚本语言添加到应用程序中。我想做的一件事是拥有一个运行时环境，我可以在其中输入命令、获取输出等。所以我开始考虑实现我自己的 PSHost。

然后我想象着我的未来。随着时间的推移，我将实现一个提示/命令/执行/响应+日志循环，可能是一个可配置的 UI，可能是一些调试，比如简单的断点......

不好了！我将编写自己的 ISE！

所以我的问题是：是否可以在我的应用程序中将 ISE 用于 Powershell 脚本？也许通过远程处理？也许通过嵌入某些 ISE 组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:39:10.987

除了作为最终用户应用程序之外，我还没有看到 ISE 公开其界面的任何方式。然而，我写了一个主机，它并不像听起来那么糟糕。

# java - 在Java bean中创建一个进程，获取输出并返回网页

> ID：14489624
> 
> 赞同：3
> 
> 时间：2013-01-23T21:23:07.567
> 
> 标签：java, jsf, jakarta-ee, javabeans

假设我有一个名为“Mainbean”的 java bean，用于处理来自网页的请求。

我想在这个 bean 中创建一个进程“proc”，并获取 proc 的输出，将它们异步返回到网页，并在 JSF 中的 inputTextArea 中显示它们。

由于“proc”可能有这么多行输出，我想逐行实时返回它们，但在处理完成后不显示所有它们。

我使用以下代码创建了一个进程并尝试获取输出。但似乎进程未能正常退出，导致退出值始终为-1。

```
builder = new ProcessBuilder("java", "-Xms1024m","-Xmx1024m","-Xss65536k","-cp ",spaceMaker,"SmartBridge", solution," ",this.specFile,"1000000");
proc = builder.start();
InputStream is = proc.getInputStream();
InputStreamReader isr = new InputStreamReader(is);
BufferedReader br = new BufferedReader(isr);
returnValue  = proc.waitFor();

while ((line = br.readLine()) != null) {
    // Outputs your process execution
    System.out.println(line);
    this.metaOutput = this.metaOutput.concat(line);
    exit = proc.exitValue();
    if (exit == 0) {
        // Process finished
        break;
    }
    return output;
} 
```

在 JSF 页面中，我使用以下代码：

```
<h:form>
    <h:inputTextarea id="processOutput" value="#{mainBean.metaOutput}" cols="80" rows="20">
        <f:ajax render="processOutput"/>
    </h:inputTextarea>
 </h:form> 
```

我的问题是：我怎样才能使用这些技术来满足我在高层的要求？当然，代码示例肯定会对我有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T09:14:49.023

如果您正在寻找反向 ajax 类型的响应。您可以使用 PRIMEFACES PUSH 反向 ajax 技术。链接在这里。[PrimPush](http://www.primefaces.org/showcase/push/index.jsf)

# c# - 为什么在 SQL Server 中重命名表后没有检索到子表数据？

> ID：14489627
> 
> 赞同：0
> 
> 时间：2013-01-23T21:23:23.263
> 
> 标签：c#, sql-server, entity-framework

在 SQL Server 中，我将表 TrialOrderStockNumbers 重命名为 TrialOrderStock。外键指向 TrialOrders 表。在 EF 设计器中，我删除了 TrialOrderStockNumbers 实体并运行从数据库更新模型向导（添加回 TrialOrderStock 表）。当我运行应用程序时，子数据现在丢失了。

现在在 SQL Profiler 中，不会执行任何查询来获取 Stock 数据。在进行更改分析器之前显示了选择数据的语句。我不得不放弃所有更改，并且（现在）我打算保留旧表名。

我首先使用实体​​框架数据库。**为什么在 SQL Server 中重命名表并更新模型后，Entity Framework 停止检索子数据？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:48:23.410

自从我使用 MEF 以来已经有一段时间了，我遇到了类似的问题，即实体与数据库模式不同步。据我记得，我只是重新生成了域服务，问题就解决了。

# xpages - 设置富文本控件的焦点

> ID：14489630
> 
> 赞同：0
> 
> 时间：2013-01-23T21:23:28.173
> 
> 标签：xpages

我可以通过以下方式为几乎任何类型的控件设置焦点：

```
var f = dojo.byId('#{id:NotInvitedMsg}');
if (f != null)
   f.focus() 
```

但这至少在我想要的方式上不适用于富文本控件。我假设它正在设置焦点，但由于富文本控件由多个组件组成，因此编辑区域没有获得焦点。无论如何将焦点设置到编辑区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:29:44.793

OpenNTF 终于回应了我，我发现了这个：

[http://openntf.org/XSnippets.nsf/snippet.xsp?id=focus-on-ckeditor-rich-text-field](http://openntf.org/XSnippets.nsf/snippet.xsp?id=focus-on-ckeditor-rich-text-field)

效果很好！

如果发帖者在文档上投入更多精力，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:31:09.427

尝试

```
 try {
 var el = dojo.query('div[id*="yourid"]');
 var node = el[el.length-1];
 setTimeout(function() { node.focus(); }, 500);
//node.focus();
 } catch (e) { } 
```

# r - 如何在多面 R ggplot boxplot 中删除未使用的因子？

> ID：14489632
> 
> 赞同：3
> 
> 时间：2013-01-23T21:23:35.717
> 
> 标签：r, ggplot2

下面是一些我用来制作箱线图的示例代码：

```
stest <- read.table(text="    site  year    conc
    south   2001    5.3
    south   2001    4.67
    south   2001    4.98
    south   2002    5.76
    south   2002    5.93
    north   2001    4.64
    north   2001    6.32
    north   2003    11.5
    north   2003    6.3
    north   2004    9.6
    north   2004    56.11
    north   2004    63.55
    north   2004    61.35
    north   2005    67.11
    north   2006    39.17
    north   2006    43.51
    north   2006    76.21
    north   2006    158.89
    north   2006    122.27
", header=TRUE)

require(ggplot2)
ggplot(stest, aes(x=year, y=conc)) +
  geom_boxplot(horizontal=TRUE) +
  facet_wrap(~site, ncol=1) +
  coord_flip() +
  scale_y_log10() 
```

结果是：

![箱形图](../Images/bc06e7f8aaec900d5c178b5463d565ab.png)

我尝试了所有我能想到的方法，但无法绘制**南面**仅包含显示数据的年份（2001 年和 2002 年）的图。我正在尝试做的事情可能吗？

这是屏幕截图的[链接](http://dl.dropbox.com/u/20145982/2013-01-23_2130.png)（DEAD），显示了我想要实现的目标：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:28:36.760

使用`scales='free.x'`参数来`facet_wrap`。但我怀疑你需要做更多的事情才能得到你正在寻找的情节。

特别`aes(x=factor(year), y=conc)`是在您的初次`ggplot`通话中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T16:21:18.440

一种绕过问题的简单方法（效果相当好）：分别生成两个箱线图，然后使用包的命令将
它们连接在一起。`grid.arrange``gridExtra`

```
library(gridExtra)

p1 <- ggplot(subset(stest,site=="north"), aes(x=factor(year), y=conc)) +
 geom_boxplot(horizontal=TRUE) + coord_flip() + scale_y_log10(name="")

p2 <- ggplot(subset(stest,site=="south"), aes(x=factor(year), y=conc)) +
 geom_boxplot(horizontal=TRUE) + coord_flip() + 
 scale_y_log10(name="X Title",breaks=seq(4,6,by=.5)) +

grid.arrange(p1, p2, ncol=1) 
```

# functional-programming - 如何在 Mac 终端的 SML/NJ 的 REPL 中移动光标？

> ID：14489635
> 
> 赞同：2
> 
> 时间：2013-01-23T21:23:43.307
> 
> 标签：functional-programming, sml, smlnj

在 Mac OSX 的终端中，我打开`SML`，如果我输入错误，我希望将光标移动到该位置以修改某些内容或添加/删除某些内容，但是一旦我`<-`在键盘上点击（左箭头），就会`REPL`给我

![在此处输入图像描述](../Images/25a067fcf7c0c074713accae2ea84b2b.png)

是的，那个`^[[D`东西。

那么如何移动光标呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:21:31.167

是的，SML/NJ 的 REPL 不支持方向键。您可以使用该[`rlwrap`工具](http://utopia.knoware.nl/~hlub/rlwrap/#rlwrap)来解决此问题。这使您可以使用向左和向右箭头键在一行内导航，并使用向上和向下箭头键来调用您之前输入的行。

如果您使用 Emacs 编写 SML 文件，您还可以在 Emacs 缓冲区中运行 SML。

# javascript - 在 Angular.js 中连接模型

> ID：14489637
> 
> 赞同：2
> 
> 时间：2013-01-23T21:23:49.923
> 
> 标签：javascript, frameworks, model, angularjs

我刚刚开始使用 Angular.js，我不确定如何将两个“模型”“链接”在一起。我的 index.php 文件中有以下代码

```
<div ng-controller="AccountCtrl">
    <h2>Accounts</h2>
    <ul>
        <li ng-repeat="account in accounts">
            <span>{{account.id}} {{account.ownedBy}}</span>
        </li>
    </ul>
</div>
<div ng-controller="TransactionCtrl">
    <h2>Transactions</h2>
    <ul>
        <li ng-repeat="transaction in transactions">
            <span>{{transaction.id}} {{transaction.timestamp}} {{transaction.amount}} {{transaction.description}} {{transaction.account}}</span>
        </li>
    </ul>
</div> 
```

和下面的js

```
function AccountCtrl($scope, $http) {
    // initialize Data
    $http({
        method:'GET', 
        url:'http://api.mydomain.ca/accounts'
    }).success(function(data, status, headers, config) {
        $scope.accounts = data;
    }).error(function(data, status, headers, config) {
        alert('Error getting accounts. HTTP Response status code: '+status);
    });
}
function TransactionCtrl($scope, $http) {
    // initialize Data
    $http({
        method:'GET', 
        url:'http://api.mydomain.ca/transactions'
    }).success(function(data, status, headers, config) {
        $scope.transactions = data;
    }).error(function(data, status, headers, config) {
        alert('Error getting transactions. HTTP Response status code: '+status);
    });
} 
```

所以在我的例子中，每个账户都会有很多交易，我想在我的账户控制器中添加一个函数来根据交易计算账户的余额，但我不知道该怎么做，因为它们在不同的 $scopes 中。

有没有办法在 Angular 中执行此操作，或者当我获得帐户时，我是否必须在我的 JSON 响应中从服务器返回“链接”交易信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:54:13.793

我想`account`成立`transactions`，对吧？然后我猜，你可以创建一个`service`来管理账户/交易数据。将此服务注入两个控制器。

```
module = angular.module('app', []);

module.factory('accountService', function($http) {
  var obj = {
    // handles http communication to/from server.
    // also has methods/getters/setters for data manipulation, etc.
  };
  return obj;
});

module.controller('AccountCtrl', function($scope, accountService) {
   // access accountService for the view-databind.
});

module.controller('TransactionCtrl', function($scope, accountService) {
   // access accountService for the view-databind.
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:02:24.243

由于您同时发出两个 http 请求，我将更改我的服务以将交易作为帐户对象的属性返回。然后它将是一个服务器调用，开销更少，并且您的数据将采用您需要的格式。我认为您对最后一个问题的想法是正确的。

使用 Angular 也是不错的选择。如果您还没有找到它们，John Lindquest 在 egghead.io 上发布了一组很棒的[视频](http://egghead.io/)。

# c# - 从包含“\0”字符的非托管 C++ DLL 返回 LPTSTR

> ID：14489640
> 
> 赞同：1
> 
> 时间：2013-01-23T21:24:04.900
> 
> 标签：c#, c++, pinvoke, marshalling

我有一个调用非托管 C++ dll 的 C# gui。回调用于 dll -> gui 消息传递。

在 dll 中创建了一个可能包含“\0”字符的 LPTSTR。该字符串需要通过回调参数完整地通过回调传递回gui。

不幸的是，我只能将字符串传递给 gui，直到出现空字符。似乎编组切断了字符串。

```
// C# callback declarations
public delegate bool callbackDelegate(int iEvent, [MarshalAs(UnmanagedType.LPWStr)] string SomeString);
private callbackDelegate callbackDelegateInstance;

// instantiating and calling the callback in C#
callbackDelegateInstance = new callbackDelegate(CallbackHandler);
DLLCallbackFunction(callbackDelegateInstance);

// C# callback handler
private bool CallbackHandler(int iEvent, [MarshalAs(UnmanagedType.LPWStr)] string SomeString)
{
    // SomeString only contains characters up until the null char
} 
```

有没有办法返回整个字符串，包括来自 dll 的空字符？

我确实可以访问 dll 和 gui 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:33:51.023

您可以将其编组为原始字节数组而不是 LPTSTR。如果您的数据不是固定大小，则必须添加一个额外的长度参数。

委托将被声明为：

```
 public delegate bool callbackDelegate(int iEvent, [MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 2)] byte[] data, int dataCount); 
```

在非托管方面：

```
typedef void (__stdcall *callbackDelegate)(int iEvent, const char* data, int size); 
```

# c# - 使用 SOAP 将 PDF 文件作为附件添加到 TestTrack

> ID：14489641
> 
> 赞同：0
> 
> 时间：2013-01-23T21:24:08.070
> 
> 标签：c#, pdf, soap, attachment, testtrack

在过去的一年中，我最近开始使用 C#，所以我对此有点陌生，但通常可以通过一些努力来破解一些东西，但这个让我望而却步。我们使用 TestTrack 在我们公司进行开发错误/问题跟踪。我创建了一个自定义 Windows 窗体应用程序，作为我们一个部门的 TestTrack 的前端。它使用 SOAP 进行连接。我没有使用 WPF/WCF，也不想走那条路。我很难找到任何有关如何正确编码 PDF 附件文件的示例。下面的代码确实在 TestTrack 中创建了一个已存在问题的附件，但是当您尝试在 TestTrack 中打开它时，它会弹出一条错误消息，上面写着“图像数据不足”。如果您想使用 SOAP 将文本文件添加到 TestTrack，下面的示例确实有效。我想知道我需要在下面更改什么，以便我可以将 PDF 文件放入 TestTrack，然后能够在 TestTrack 应用程序中打开它而不会出现上述错误。提前感谢您的任何输入/帮助。

```
 public void getAttachments(long lSession, CDefect def)
    {
        ttsoapcgi cgiengine = new ttsoapcgi();

        // Lock the defect for edit.
        CDefect lockedDefect = cgiengine.editDefect(lSession, def.recordid, "", false);

        string attachment = "c:\\TEST\\TEST_PDF.PDF";

        CFileAttachment file = new CFileAttachment();
        file.mstrFileName = Path.GetFileName(attachment);

        System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding();

        StreamReader reader = new StreamReader(attachment);
        file.mstrFileName = Path.GetFileName(attachment);
        file.mpFileData = enc.GetBytes(reader.ReadToEnd());
        reader.Close();

        CReportedByRecord reprec = lockedDefect.reportedbylist[0];
        CFileAttachment[] afile = reprec.attachmentlist;
            if (afile == null)
            {
                lockedDefect.reportedbylist[0].attachmentlist = new CFileAttachment[1];
                lockedDefect.reportedbylist[0].attachmentlist[0] = file;
            }

            // Save our changes.
            cgiengine.saveDefect(lSession, lockedDefect);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T13:37:46.010

这是允许我将 PDF 附加到 SOAP 并将其作为问题附件放入 TestTrack 的修改方法：

```
 public void getAttachments(long lSession, CDefect def)
    {
        ttsoapcgi cgiengine = new ttsoapcgi();

        // Lock the defect for edit.
        CDefect lockedDefect = cgiengine.editDefect(lSession, def.recordid, "", false);

        string attachment = "c:\\TEST\\TEST_PDF.PDF";

        CFileAttachment file = new CFileAttachment();

        file.mpFileData = File.ReadAllBytes(attachment);
        file.mstrFileName = Path.GetFileName(attachment);

        CReportedByRecord reprec = lockedDefect.reportedbylist[0];
        CFileAttachment[] afile = reprec.attachmentlist;
            if (afile == null)
            {
                lockedDefect.reportedbylist[0].attachmentlist = new CFileAttachment[1];
                lockedDefect.reportedbylist[0].attachmentlist[0] = file;
            }

            // Save our changes.
            cgiengine.saveDefect(lSession, lockedDefect);
    } 
```

# kineticjs - 如何找到 Kinetic 生成的画布的 ID？

> ID：14489643
> 
> 赞同：1
> 
> 时间：2013-01-23T21:24:10.660
> 
> 标签：kineticjs

在我使用 Kinetic 创建想要的画布后，我想以其他方式对其进行操作。我在文档中找不到 Kinetic 创建的画布的 ID。我想通过使用 getElementById 来获取它。谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T15:50:15.177

不幸的是，Kinetic 没有用 ID 定义 Canvas。使用“getCanvas”函数可能有效，但您需要从特定层调用它。对我来说最好的解决方案是使用 div 容器的 id 并调用“getElementsByTagName”来访问 Canvas 元素。但是通常无论如何你只有一个 Canvas，所以你可以像这样得到它：

```
console.log(document.getElementsByTagName('canvas')[0]); 
```

唯一的问题是 Kinetic 为每个图层创建一个单独的 Canvas 元素，因此最好在您的项目中只使用一个图层，或者您必须浏览它们：

```
var canvases = document.getElementsByTagName('canvas');
for (var i = 0; i < canvases.length; i++) {
    console.log(canvases[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:37:39.307

会使用`getCanvas()`工作吗？（[动力学文档](http://kineticjs.com/docs/symbols/Kinetic.Layer.php#getCanvas)只是说它用于“获取图层画布”）

此外，我不确定这是否是相同的想法，但您可以查看[这个问题](https://stackoverflow.com/questions/12129614/kineticjs-animation-with-jquery)。

# rdf - 如何过滤 dbpedia 中的歧义名称

> ID：14489644
> 
> 赞同：1
> 
> 时间：2013-01-23T21:24:17.433
> 
> 标签：rdf, sparql, dbpedia

我正在尝试使用以下 SPARQL 查询来查找法国的 Rhône 部门。

```
SELECT * WHERE {
  ?x rdfs:label "Rhone"@en.
  ?x rdf:type dbpedia-owl:Place.
  ?x dbpedia-owl:abstract ?abstract.
  FILTER (LANGMATCHES(LANG(?abstract), 'en'))
} 
```

这是 DBPEDIA 资源：[http](http://dbpedia.org/page/Rh%C3%B4ne_(department) ://dbpedia.org/page/Rh%C3%B4ne_(department )

问题是它一直在寻找罗纳河，而不是部门（或州）。如果我将 rdf:type 更改为 PopulatedPlace 或 Settlement，那么搜索将找不到任何内容。

我可以使用“*”或“吗？” 扩大搜索字符串的字符，例如：

> '* 罗纳河 *'

如：

```
SELECT * WHERE {
  ?x rdfs:label "*Rhone*"@en.
  ?x rdf:type dbpedia-owl:Settlement.
  ?x dbpedia-owl:abstract ?abstract.
  FILTER (LANGMATCHES(LANG(?abstract), 'en'))
} 
```

其次，我认为在一个查询中使用多个过滤器是可以的，例如：

```
SELECT * WHERE {
  ?x rdfs:label "Rhone"@en.
  ?x rdf:type dbpedia-owl:Place.
  ?x rdf:type dbpedia-owl:PopulatedPlace.
  ?x rdf:type dbpedia-owl:Settlement.
  ?x dbpedia-owl:abstract ?abstract.
  FILTER (LANGMATCHES(LANG(?abstract), 'en'))
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:34:40.713

是的，您可以使用通配符创建搜索字符串 - 有点。您可以`FILTER`使用字符串匹配*正则表达式*，`FILTER (regex(?label, "Rhone"))`该正则表达式将字符串与内容中任何位置的字符串“Rhone”匹配。这`FILTER`会使查询执行速度变慢。

但是，这不会返回您想要的资源，因为该部门的标签是“Rhône”。

任何字符的通配符都是`.`（句点）。因此，如果您不确定“Rhône”的拼写并希望它出现在标签中的任何位置，您可以使用

```
SELECT * WHERE {
  ?x rdf:type dbpedia-owl:Place.
  ?x dbpedia-owl:abstract ?abstract.
  ?x rdfs:label ?label.
  FILTER (regex(?label, "Rh.ne") && LANGMATCHES(LANG(?abstract), 'en'))
} 
```

由于正则表达式，完成此查询确实需要很长时间。我刚试过这个查询，它超时了。

第三个查询有效，但只会匹配`dbpedia-owl:Place`s 和`dbpedia-owl:PopulatedPlace`s 和`dbpedia-owl:Settlement`s 的资源（同时）。罗讷河谷是三者。
如果您想要`dbpedia-owl:Place`or`dbpedia-owl:PopulatedPlace`或`dbpedia-owl:Settlement`，请使用：

```
SELECT DISTINCT * WHERE {
  {
  ?x rdf:type dbpedia-owl:Place.
  ?x rdfs:label ?label.
  ?x dbpedia-owl:abstract ?abstract.
  FILTER (regex(?label, "Rhône") && LANGMATCHES(LANG(?abstract), 'en'))
  } UNION {
  ?x rdf:type dbpedia-owl:Settlement.
  ?x rdfs:label ?label.
  ?x dbpedia-owl:abstract ?abstract.
  FILTER (regex(?label, "Rhône") && LANGMATCHES(LANG(?abstract), 'en'))
  } UNION {
  ?x rdf:type dbpedia-owl:PopulatedPlace.
  ?x rdfs:label ?label.
  ?x dbpedia-owl:abstract ?abstract.
  FILTER (regex(?label, "Rhône") && LANGMATCHES(LANG(?abstract), 'en'))
  }
} 
```

# php - 如何运行 PHP PDO SQL 查询而不等待响应

> ID：14489645
> 
> 赞同：0
> 
> 时间：2013-01-23T21:24:19.987
> 
> 标签：php, sql, pdo

> **可能重复：**
> [如何实现应该在 php 中的线程中完成的任务](https://stackoverflow.com/questions/6841830/how-can-i-achieve-a-task-that-should-be-done-in-thread-in-php)

通常在 PHP 中运行 PDO 查询时，它会等待数据库结果。有没有办法避免这种情况？

我需要我的脚本快速回复，但运行的 SQL 可能需要一些时间才能运行。

例子：

```
<?php
$pdo = new PDO('bla bla');

// This takes up to 1 second, but I need the script to reply within a few ms
$pdo->exec('UPDATE large_table SET foo = \'bar\' WHERE id = 42');
die('ok'); 
```

这是可行的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:36:08.523

对于`INSERT`查询，您可以使用`INSERT DELAYED`（[手动](http://dev.mysql.com/doc/refman/5.5/en/insert-delayed.html)）。这些查询将被放入工作队列并立即返回。缺点是您没有关于查询是否成功执行的任何反馈。

然而，由于不明原因，没有`UPDATE DELAYED`...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:28:12.410

常见的方法是先渲染输出，然后使用刷新输出到客户端[`flush()`](http://php.net/manual/de/function.flush.php)，然后执行耗时查询。你也应该知道[`ignore_user_abort()`](http://php.net/manual/de/function.ignore-user-abort.php). 尽管与客户端的连接可能已经结束，但此函数使 PHP 保持运行。（例如用户关闭浏览器）

我准备了两个脚本来说明这一点。首先是`slow.php`提前刷新输出，然后开始一项耗时的任务。第二个是`get.php`使用 libcurl 接收页面。如果您对其进行测试，get.php 将几乎立即返回，而 slow.php 仍在运行。我还用当前的 Mozilla 测试了慢速 php。

*慢.php：*

```
// The example will not work unless ob_end_clean() is called
// on top. Strange behaviour! Would like to know a reason
ob_end_clean();

// disable all content encoding as we won't
// be able to calculate the content-length if its enabled
@apache_setenv('no-gzip', 1);
@ini_set('zlib.output_compression', 0);
@ini_set('implicit_flush', 1);
header("Content-Encoding: none");

// Tell client that he should close the connection
header("Connection: close");

// keep the script running even if the CLIENT closes the connection
ignore_user_abort(); 

// using ob* functions its easy to content the content-length later
ob_start();

// do your output
echo 'hello world', PHP_EOL;

// get the content length
$size = ob_get_length();
header("Content-Length: $size");

// clear ob* buffers
for ($i = 0; $i < ob_get_level(); $i++) {
    ob_end_flush();
}
flush(); // clear php internal output buffer

// start a time consuming task
sleep(3); 
```

*获取.php*

```
// simplest curl example
$url = 'http://localhost/slow.php';

$ch = curl_init($url);
$fp = fopen("example_homepage.txt", "w");

curl_setopt($ch, CURLOPT_FILE, $fp);
curl_setopt($ch, CURLOPT_HEADER, 0);

curl_exec($ch);
curl_close($ch);
fclose($fp); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:26:20.430

在您进行更新时，通过 AJAX 调用您的更新脚本，向您的用户显示一个加载器。

如果您真的不需要在页面加载时输出中的查询结果，这是唯一的方法。

# ios - ipad 在滚动时立即转到链接，如果触摸

> ID：14489648
> 
> 赞同：0
> 
> 时间：2013-01-23T21:24:31.043
> 
> 标签：ios

当用户尝试上下滚动页面时，如何立即停止 iPad 上的 Safari？

什么是 jquery 来阻止这个？

# java - 在 Java 中总是抛出相同的异常实例

> ID：14489655
> 
> 赞同：13
> 
> 时间：2013-01-23T21:25:07.073
> 
> 标签：java, scala, exception-handling

总是有人告诉我，Java 异常处理非常昂贵。

我在问在程序开始时创建特定类型的异常实例而不创建新实例是否是一种好习惯，总是抛出相同的异常对象。

我只是想举个例子。常用代码：

```
if (!checkSomething(myObject))
   throw new CustomException("your object is invalid"); 
```

选择：

```
static CustomException MYEXP = new CustomException("your object is invalid");

//somewhere else
if (!checkSomething(myObject))
    throw MYEXP; 
```

当然，我在这里做了一些假设：

1.  `MyCustomException`没有参数
2.  客户端代码，无论何时是一个好的实践，都很大程度上基于异常处理，重构不是一种选择。

所以问题是：

1.  这是一个好习惯吗？
2.  这会损坏一些 JVM 机制吗？
3.  如果 1 是肯定的，是否有可能获得性能提升？（我认为不是，但不确定）
4.  如果 1 和 3 是肯定的，为什么不作为实践赞助？
5.  如果 1 不是，为什么 Martin Odersky 在他对 Scala 的介绍中说 Scala 在某些情况下是这样工作的？（在 28.30 分钟，他告诉执行 break 时抛出了异常，观众说这很耗时，他回答说不是每次都创建异常）[Fosdem 2009](https://www.youtube.com/watch?v=zqFryHC018k)

我希望这不是一个无聊/愚蠢的问题，我对此很好奇。我认为异常处理的真正成本是*处理*而不是创建。

**编辑** 添加了关于 FOSDEM 演示文稿的精确讨论的参考

免责声明：我的代码都没有像提议的那样工作，我也无意管理这样的异常，我只是在做一个“假设”问题，这种好奇心是从该视频的确认中产生的。我想：如果它是在 Scala 中完成的，为什么不在 Java 中呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-23T21:28:45.240

不，不要那样做。昂贵的部分不是处理异常，而是生成堆栈跟踪。不幸的是，堆栈跟踪也是有用的部分。如果你抛出一个保存的异常，你将传递一个误导性的堆栈跟踪。

可能在 Scala 的实现中，在某些情况下这样做是有意义的。（也许他们正在做一些递归的事情，并且想要预先生成一个异常对象，所以如果他们用完内存，他们仍然可以产生一个异常。）他们也有很多关于他们正在做什么的信息，所以他们有更好的机会做对了。但是 JVM 语言实现者所做的优化是一个非常特殊的情况。

所以你不会*破坏*任何东西，除非你认为提供误导性信息构成破坏。这对我来说似乎是一个很大的风险。

尝试 Thomas Eding 关于如何创建没有堆栈跟踪的异常的建议似乎有效：

```
groovy:000> class MyException extends Exception {
groovy:001>     public Throwable fillInStackTrace() {}}
===> true
groovy:000> e = new MyException()
===> MyException
groovy:000> Arrays.asList(e.stackTrace)
===> [] 
```

另请查看[JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.20.2)：

> 由方法 blowUp 引发的 NullPointerException（这是一种 RuntimeException）不会被 main 中的 try 语句捕获，因为 NullPointerException 不能分配给 BlewIt 类型的变量。这会导致 finally 子句执行，之后执行 main 的线程（测试程序的唯一线程）由于未捕获的异常而终止，这通常会导致打印异常名称和简单的回溯。但是，本规范不需要回溯。
> 
> 强制回溯的问题在于，可以在程序中的某一点创建异常并在以后抛出异常。将堆栈跟踪存储在异常中是非常昂贵的，除非它实际上被抛出（在这种情况下，可能会在展开堆栈时生成跟踪）。因此，我们不要求在每个异常中都进行回溯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:30:38.557

> Q1。这是一个好习惯吗？

我的书中没有。它增加了复杂性并阻碍了诊断（请参阅我对 Q2 的回答）。

> Q2。这会损坏一些 JVM 机制吗？

您不会从这样的异常对象中获得有意义的堆栈跟踪。

> Q3。如果1是yes，有性能增益吗？（我认为不是，但不确定）
> 
> Q4。如果 1 和 3 是肯定的，为什么不作为实践赞助？

由于上述问题。

> Q5。如果 1 不是，为什么 Martin Odersky 在他对 Scala 的介绍中说 Scala 在某些情况下是这样工作的？（对不起，我现在不记得这个肯定的上下文）Fosdem 2009

没有上下文很难回答。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T23:10:27.760

你可以这样做，但例外

1.  必须没有堆栈跟踪，因为初始堆栈跟踪只会在后续使用中混淆。

2.  不能接受被抑制的异常。如果多个线程试图向它添加抑制的异常，事情就会被破坏。

所以你的异常构造函数必须做

```
super(msg, cause, /*enableSuppression*/false, /*writableStackTrace*/false); 
```

见[http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#Throwable%28java.lang.String,%20java.lang.Throwable,%20boolean,%20boolean%29](http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#Throwable%28java.lang.String,%20java.lang.Throwable,%20boolean,%20boolean%29)

* * *

现在，有用吗？是的，否则为什么这两个布尔标志首先存在？:)

在一些复杂的情况下，异常可以作为一种流程控制装置，它可以产生更简单、更快的代码。这种异常被称为“控制异常”。

如果异常确实是为了表明程序异常错误，那么使用传统的异常。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-23T21:59:15.353

尽管异常相对昂贵并且应该保持在最低限度，但它们不会花费太多，以至于您应该“出于性能目的”做一些迟钝的事情这通常是一个糟糕的借口，甚至有人认为过早的优化应该不惜一切代价避免。虽然这并不完全正确，但您可以衡量异常的速度有多慢。

```
long start = System.nanoTime();
int exceptionCount = 0;
for (int i = 0; i < 20000; i++)
    try {
        int j = i / (i & 1);
    } catch (ArithmeticException ae) {
        exceptionCount++;
    }
long time = System.nanoTime() - start;
System.out.printf("Each exception took average of %,d ns%n", time / exceptionCount); 
```

打印我认为合理的估计。

```
Each exception took average of 3,064 ns 
```

注意：随着循环次数的增加，异常会被优化掉。即 10 倍的迭代次数

```
Each exception took average of 327 ns 
```

以及 10 倍以上

```
Each exception took average of 35 ns 
```

以及 10 倍以上

```
Each exception took average of 5 ns 
```

如果抛出的异常足够多，那么 JIT 似乎足够聪明，可以优化掉异常。

# php - 从日期开始的平均天数 Mysql, PHP

> ID：14489657
> 
> 赞同：0
> 
> 时间：2013-01-23T21:25:09.407
> 
> 标签：php, mysql, date, average

> **可能重复：**
> [在 SQL 中以 Days:Hours:Mins:Seconds 格式计算 DateDiff](https://stackoverflow.com/questions/10800185/calculate-datediff-in-sql-in-dayshoursminsseconds-format)

我有这个 MySql 查询：

```
SELECT DATEDIFF(MAX(hit_date), MIN(hit_date)) / (COUNT(hit_date) - 1) AS hitavg FROM my_table 
```

这将返回一个值（hit_date 列中记录的行之间的平均天数，此列采用 TIMESTAMP 格式，因此 YY:MM:DD HH:MM:SS）

假设这个值是 385.500（从查询返回），我如何在 PHP 中将这个数字格式化为***385 天，“n”小时***（其中“n”是十进制值，在本例中为 500）？

在此先感谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:35:48.320

好吧，如果你只想要天和小时，那么：

```
$value = 385.500;

$days = (int) $value;
$hours = 24 * ($value - $days);

echo "$days Days, $hours Hours"; 
```

# php - php、ajax 和 json 编码/解码

> ID：14489660
> 
> 赞同：1
> 
> 时间：2013-01-23T21:25:24.660
> 
> 标签：php, json, jquery

我正在使用 jQuery 和[jquery-json](http://code.google.com/p/jquery-json/)将数据发布到 PHP 脚本。

```
 $.post('<?php echo url_for('/ajax.php'); ?>', 'data=' + $.toJSON(order), function (response) {

                if (response == "success") {
                    $("#respond").html('<div class="success">Item Saved!</div>').hide().fadeIn(1000);
                    setTimeout(function () {
                        $('#respond').fadeOut(1000);
                    }, 2000);
                }
         }) 
```

如果我 console.log(order) 我得到以下 JOSN：

```
{"details":[{"template_id":"25","font_size":"22"}]} 
```

在我的 ajax.php 文件中，我有：

```
$data = json_decode($_POST["data"]);
var_dump($data);exit; 
```

返回'NULL'

但是当我有以下代码时：

```
$data = $_POST["data"];
var_dump($data);exit; 
```

它返回：

```
string(61) "{\"details\":[{\"template_id\":\"25\",\"font_size\":\"26\"}]}" 
```

有什么理由让它逃脱吗？

解码这个最简单的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:28:49.090

您可能需要`magic_quotes_gpc`在您的 php.ini 或 .htaccess 文件中禁用将斜杠添加到您的帖子变量的文件。

或者你可以像这样调用`stripslashes`$_POST['data'] ：

```
$data = json_decode(stripslashes($_POST["data"])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:47:18.637

您需要将 dataType: 'json' 添加到您的 ajax 调用中。

```
$.ajax({
    url: url,
    type: 'post',
    dataType: 'json',
    data: $.toJSON(order),
    async: true,
    success: function (data) {

      if (data.response) {
        $("#respond").html('<div class="success">Item Saved </div>').hide().fadeIn(1000);
                    setTimeout(function () {
                        $('#respond').fadeOut(1000);
                    }, 2000);

      }

    }

}); 
```

# ruby - 模拟文件输入作为 Rspec 上的文件路径

> ID：14489664
> 
> 赞同：5
> 
> 时间：2013-01-23T21:25:41.260
> 
> 标签：ruby, testing, rspec, mocking, sinatra

我有一个关于如何使用 rspec 模拟文件输入的问题。我有一个类的以下代码，但不完全知道为什么要模拟文件输入。`filepath`是`/path/to/the/file`

我在谷歌上进行了搜索，通常结果是加载实际文件而不是模拟，但实际上我正在寻找相反的地方，只模拟，但不使用实际文件。

```
module Service
  class Signing
    def initialize(filepath)
      @config = YAML.load_file(filepath)
      raise "Missing config file." if @config.nil?
    end

    def sign()      …
    end

    private
    def which()     …
    end

  end 
end 
```

是否可以为此文件输入模拟使用 EOF 分隔符？

```
file =  <<EOF
A_NAME: ABC
A_ALIAS: my_alias
EOF 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:48:49.143

您可以`YAML.load_file`从文本中提取并返回已解析的 YAML，如下所示：

```
yaml_text = <<-EOF
  A_NAME: ABC
  A_ALIAS: my_alias
EOF
yaml = YAML.load(yaml_text)
filepath = "bogus_filename.yml"
YAML.stub(:load_file).with(filepath).and_return(yaml) 
```

这并不能完全消除文件加载本身，但要做到这一点，您必须假设 YAML.load_file 在幕后做了什么，这不是一个好主意。由于可以安全地假设 YAML 实现已经过测试，因此您可以使用上面的代码将整个调用替换为 parsed-from-text 固定装置。

如果您想测试正确的文件名是否传递给`load_file`，请将存根替换为期望：

```
YAML.should_receive(:load_file).with(filepath).and_return(yaml) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-19T17:18:34.147

如果这个想法是对某事寄予期望，我认为这种调用`YAML.load`伪造回报的方法没有多大好处。`YAML.load_file`实际上返回一个哈希，所以我的建议不是做所有的事情，而是简单地返回一个哈希：

```
parsed_yaml = { 
  "somekey" => {
    "someotherkey" => "abc"
  } 
}

YAML.should_receive(:load_file).with(filepath).and_return(parsed_yaml) 
```

由于这应该是一个单元测试而不是一个集成测试，我认为这会更有意义。

# javascript - Javascript和原型制作过程

> ID：14489665
> 
> 赞同：1
> 
> 时间：2013-01-23T21:25:41.887
> 
> 标签：javascript, oop, prototype

我正在尝试编写一个执行幻灯片放映的脚本。我可以用函数来做，但我想使用原型方法。我很难弄清楚的是程序。这是我试图做的

```
var displayVars = {
    slide: '',
    thumb: ''   
}

//setup display
display = function(slide,thumb) {

    displayVars.slide = $(slide);

    displayVars.thumb = $(thumb);

    // set slider width
}

display.prototype.play = function() {

    // move slide to this location

    display.hightlight();
}

display.prototype.hightlight = function() {

    // add border to element
}

$(function() {

    newdis = new display('.show-slide','.window-thumbs');

    displayVars.timer = setTimeout(newdis.play,500);

}); 
```

如果您在播放功能中注意到我想调用 highlight 方法。我真正想要的是每次调用 play 函数时都运行 highlight 函数。我无法理解如何做到这一点，因为“显示”或“这个”不会让我访问突出显示功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:28:40.807

问题不在于原型函数的内部结构，而在于设置超时处理程序的方式。

```
displayVars.timer = setTimeout(function() { newdis.play(); }, 500); 
```

然后你就可以`this`在“播放”功能中使用：

```
display.prototype.play = function() {

  // move slide to this location

  this.hightlight();
} 
```

函数和任何类型的对象之间没有内在的“成员关系”。对象属性可以引用函数，但唯一意味着什么是通过对象属性引用进行函数调用时。由于您没有*调用*该函数，而只是获取对它的引用以传递给“setTimeout()”，因此无需设置`this`. 通过将其包装在通过对象引用显式调用“播放”的匿名函数中，您可以`this`正确设置。

另一种方法是使用较新浏览器中可用的“bind()”函数：

```
displayVars.tinmer = setTimeout(newdis.play.bind(newdis), 500); 
```

这将具有与匿名函数或多或少相同的效果（有一些额外的微妙之处，在大多数情况下并没有太大的区别）。

# jquery - JQuery，在加载到变量的页面上使用选择器

> ID：14489668
> 
> 赞同：1
> 
> 时间：2013-01-23T21:26:09.563
> 
> 标签：jquery, jquery-selectors, greasemonkey

我正在编写一个带有一些 JQuery 的greasemonkey 脚本。

我将许多页面加载到变量中。我使用 $.get 来获取变量/数组中的页面。这很好用。

现在我想知道如何使用 jquery 选择器从存储在变量中的页面中提取数据。

我想做的是写这样的东西：

```
mypages[i].(".foo a").each(function( index ) {...}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:29:28.543

你*真正*想做的是写这样的东西： `$(mypages[i]).find(".foo a").each(...)`

jQuery 对象是非常非歧视性的。它将接受几乎任何东西并将其转换为类似 jQuery 的对象，因此假设它`mypages[i]`是 HTML 字符串、jQuery 对象或 DOM 元素，应该为你做

# java - 动态生成 XML Schema

> ID：14489669
> 
> 赞同：3
> 
> 时间：2013-01-23T21:26:13.987
> 
> 标签：java, xml, xsd, xerces2-j

我正在尝试使用 Xerces-J 动态生成 XML 模式并收到以下错误，感谢有关它的任何帮助。

```
DocumentBuilderFactory dbfac = DocumentBuilderFactory.newInstance();
dbfac.setNamespaceAware(true);

DocumentBuilder docBuilder = dbfac.newDocumentBuilder();
Document doc = docBuilder.newDocument();

Element schema = doc.createElement("xs:schema");           
schema.setAttribute("xmlns:xs", "http://www.w3.org/2001/XMLSchema");
doc.appendChild(schema);

Element e = doc.createElement("xs:element");            
e.setAttribute("name", "test");
e.setAttribute("type", "xs:string");

schema.appendChild(e);

TransformerFactory transfac = TransformerFactory.newInstance();
Transformer trans = transfac.newTransformer();
trans.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "no");
trans.setOutputProperty(OutputKeys.INDENT, "yes");

//create string from xml tree
StringWriter sw = new StringWriter();
StreamResult result = new StreamResult(sw);
DOMSource source = new DOMSource(doc);

trans.transform(source, result);
String xmlString = sw.toString();

System.out.println(xmlString);

SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

Schema schema1 = schemaFactory.newSchema(source);

Output is

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="test" type="xs:string"/>
</xs:schema> 
```

org.xml.sax.SAXParseException：s4s-elt-schema-ns：元素“xs:schema”的命名空间必须来自模式命名空间“http://www.w3.org/2001/XMLSchema”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:40:32.910

在构建 DOM 时，您不会将命名空间指定为属性。相反，使用`createElement()`带有两个参数的版本：第一个是命名空间 URI，第二个是元素的限定名称。

另请注意，限定名称的前缀将自动与命名空间 URI 匹配。如果你愿意，你可以完全消除前缀，序列化器会做正确的事情（要么创建一个`xmlns`没有前缀的属性，要么生成一个前缀）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-02T08:10:37.253

我遇到了类似的问题并找到了[Apache Commons XMLSchema](http://ws.apache.org/commons/XmlSchema/index.html)

# c++ - 3d 空间中的文本 - 如何回车？（openGL、C++、OSX）

> ID：14489670
> 
> 赞同：1
> 
> 时间：2013-01-23T21:26:14.027
> 
> 标签：c++, macos, opengl

这是我检测到炸弹威胁的 if 语句（只是我正在制作的游戏）......

```
if (exodus2_bomb == 1)
{
    float exodus2_theta_math = (exodus2_theta)/10.0*M_PI;
    float exodus2_phi_math = (exodus2_phi)/10.0*2*M_PI;
    r_exodus2_x = radius_exodus_pos * sin(exodus2_theta_math) * cos(exodus2_phi_math);
    r_exodus2_y = radius_exodus_pos * sin(exodus2_theta_math) * sin(exodus2_phi_math);
    r_exodus2_z = radius_exodus_pos * cos(exodus2_theta_math);  

    glPushMatrix();
    glTranslatef(r_exodus2_x,r_exodus2_y,r_exodus2_z);
    glColor3f (1.0, 0.0, 0.0);        
    glRasterPos3i(exodus2_x/10,exodus2_y/10,exodus2_z/10);
    string exodus2 = "BOMB!!";
    void * fontexodus2 = GLUT_BITMAP_HELVETICA_10;
    for (string::iterator i = exodus2.begin(); i != exodus2.end(); ++i)
    {
        char c = *i;
        glutBitmapCharacter(fontexodus2, c);
    }
    glEnd();
    glPopMatrix();

    glPushMatrix();
    glTranslatef(r_exodus2_x,r_exodus2_y,r_exodus2_z);
    glColor3f (1.0, 0.0, 0.0);        
    glRasterPos3i(exodus2_x/10,exodus2_y/10,exodus2_z/10);
    string exodus2b = "\n THREAT LEVEL 1";
    void * fontexodus2b = GLUT_BITMAP_HELVETICA_10;
    for (string::iterator i = exodus2b.begin(); i != exodus2b.end(); ++i)
    {
        char c = *i;
        glutBitmapCharacter(fontexodus2b, c);
    }
    glEnd();
    glPopMatrix();
} 
```

我想要的是“string exodus2”和“string exodus2b”之间的回车。但是，它总是在一条线上。而且我没有屏幕上的房地产。

是否可以在我的字符串迭代器中的某处添加回车？

不幸的是，使用“glTranslatef”和“glRasterPos3i”只会导致两行文本之间的距离在我移动相机时不一致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:36:32.563

您需要分别渲染每个字符串，并修改适当的光栅位置以重置字符串的位置。如果使用`glutBitmapHeight`，您可以确定需要将光栅位置“向下”移动多远以模拟新行。

如果您希望字符串在 3D 中定位，但随后“行为”就像它们被限制在 2D 中的同一平面上一样，您可以使用该`glBitmap`命令修改屏幕空间中的光栅位置。

```
int lineHeight   = glutBitmapHeight( font );  // number of pixels between "lines"
int stringLength = glutBitmapLength( font, s1 );  // returns length of string 1 in pixels

glutBitmap( 0, 0, 0, 0, -stringLength, lineHeight, NULL );  // move raster position
glutBitmapString( font, s2 ); 
```

第五个和第六个参数`glBitmap`控制光栅位置移动多远。

或者，如果您希望将这些字符串锚定在相对于窗口的位置，与 3D 空间中的点相比，请查看`glWindowPos`.

顺便说一句，所有这些函数都在 OpenGL 3.0 中被弃用，在 OpenGL 3.1 中被删除，除非您在高于 3.2 的 OpenGL 版本中使用兼容性上下文。

# backbone.js - 在backbone.js初始化函数中设置数组值

> ID：14489672
> 
> 赞同：0
> 
> 时间：2013-01-23T21:26:18.950
> 
> 标签：backbone.js

我正在尝试在backbone.js 模型初始化函数中设置一个数组值。在以“this.set ...”开头的行中，出现“意外字符串”错误。不能以这种方式设置数组值吗？

谢谢！

```
var bGenericItem = Backbone.Model.extend({

    defaults: {
        attrArray: new Array({'item_id': '', 'type': '', 'name':''})
    },
    initialize: function(){
        // Set the id to cid for now
        this.set({ attrArray["item_id"]: this.cid });
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:21:07.627

你试图做的事情没有任何意义。你`defaults`是一个包含单个对象的数组：

```
defaults: {
    attrArray: [
        { item_id: '', type: '', name: '' }
    ]
}, 
```

如果要保存属性对象列表，可以使用数组。但是，如果您有一个属性对象列表，`item_id`您希望`attrArray['item_id']`引用哪个属性对象？您是否假设`attrArray`它将始终初始化为默认值，并且没有人会发送一个`attrArray`作为模型初始数据的一部分？如果是这样，你会想要更像这样的东西：

```
// Use a function so that each instance gets its own array,
// otherwise the default array will be attached to the prototype
// and shared by all instances.
defaults: function() {
    return {
        attrArray: [
            { item_id: '', type: '', name: '' }
        ]
    };
},
initialize: function() {
    // get will return a reference to the array (not a copy!) so
    // we can modify it in-place.
    this.get('attrArray')[0]['item_id'] = this.cid;
} 
```

请注意，您会遇到一些需要特殊处理的数组属性问题：

1.  `get('attrArray')`将返回对模型内部数组的引用，因此修改该返回值将更改模型。
2.  诸如此类的事情`a = m.get('attrArray'); a.push({ ... }); m.set('attrArray', a)`不会按照您期望的方式工作，`set`不会注意到数组已更改（因为它没有，`a == a`毕竟是真的）所以`"change"`除非您克隆和之间的某处`attrArray`，否则您不会收到事件。`get``set`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:19:45.057

你的代码有几个问题

1：`defaults`设置是一个对象文字，这意味着您分配给它的值在定义后立即设置。您需要将默认值设置为函数，而不是文字值。这将确保每个模型实例都获得它自己的默认值副本，而不是在每个模型实例之间共享一个副本。

2：你也不应该使用`new Array`，只使用数组文字语法`[]`。但是你在这段代码中并没有真正使用数组，所以我现在删除了数组包装器。

3：不能`attrArray`直接访问。您必须从模型的属性中获取它，然后对其进行更新

```
 var bGenericItem = Backbone.Model.extend({

    defaults: function(){
      return {
        attrArray: {'item_id': '', 'type': '', 'name':''}
      };
    },
    initialize: function(){
        // Set the id to cid for now
        var arr = this.get("attrArray");
        arr["item_id"] = this.cid;
    }
}); 
```

# asp.net - 实体框架：如何解决“外键约束可能导致循环或多个级联路径”？

> ID：14489676
> 
> 赞同：37
> 
> 时间：2013-01-23T21:26:29.673
> 
> 标签：asp.net, entity-framework, sqlmembershipprovider

关于这个问题有很多问题，但我无法解决我的问题。有人可以看看这个：

我有一张与和表`Office`有一对多关系的表。最后两个表都派生自与创建的预定义表具有共享主键关系的表。似乎table 和table之间存在多对多的关系，我没有参与其中。`Doctor``Secretary``Employee``Users``sqlmembershipprovider``Users``Roles`

`Employee`我的问题是在我的表和该表之间创建（零，一）-（一）关系，`Users`我以它们之间的共享主键关系结束，然后引发错误。（这个问题有更好的解决方案吗？）

**这是错误：**

> 在表“aspnet_UsersInRoles”上引入 FOREIGN KEY 约束“FK_dbo.aspnet_UsersInRoles_dbo.aspnet_Users_UserId”可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。无法创建约束。请参阅以前的错误。

**这是我在逆向工程后的代码和会员代码：**

```
public class Office
{
    public Office()
    {
        this.Doctors = new HashSet<Doctor>();
        this.Secretaries = new HashSet<Secretary>();
    }

    [Key]
    public System.Guid OfficeId { get; set; }
    public virtual ICollection<Doctor> Doctors { get; set; }
    public virtual ICollection<Secretary> Secretaries { get; set; }
}

public class Employee
{
    [Key, ForeignKey("User")]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public System.Guid Id { get; set; }
    public string Name { get; set; }

    [ForeignKey("Office")]
    public System.Guid OfficeId { get; set; }

    // shared primary key 
    public virtual aspnet_Users User { get; set; }

    public virtual Office Office { get; set; }
}

public class Doctor :Employee
{
    public Doctor()
    {
        this.Expertises = new HashSet<Expertise>();
    }
    //the rest..    
    public virtual ICollection<Expertise> Expertises { get; set; }
}

public class Secretary : Employee
{
    // blah blah
}

public class aspnet_Users
{
    public aspnet_Users()
    {
        this.aspnet_Roles = new List<aspnet_Roles>();
    }

    public System.Guid ApplicationId { get; set; }
    public System.Guid UserId { get; set; }
    //the rest..
    public virtual aspnet_Applications aspnet_Applications { get; set; }
    public virtual ICollection<aspnet_Roles> aspnet_Roles { get; set; }
}

public class aspnet_Roles
{
    public aspnet_Roles()
    {
        this.aspnet_Users = new List<aspnet_Users>();
    }

    public System.Guid ApplicationId { get; set; }
    public System.Guid RoleId { get; set; }
    //the rest..
    public virtual aspnet_Applications aspnet_Applications { get; set; }
    public virtual ICollection<aspnet_Users> aspnet_Users { get; set; }
} 
```

**编辑：**`Users`关系更深入，表和表之间存在多对一的关系`Applications`，也存在于`Roles`和之间`Applications`。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-01-24T03:44:47.207

您可以使用 fluent api 指定错误消息建议的操作。

在您的上下文中：

```
protected override void OnModelCreating( DbModelBuilder modelBuilder )
{
        base.OnModelCreating(modelBuilder);
        modelBuilder.Entity<aspnet_UsersInRoles>().HasMany(i => i.Users).WithRequired().WillCascadeOnDelete(false);
} 
```

请注意，您没有包含表 aspnet_UsersInRoles 的定义，因此此代码可能不起作用。

另一种选择是通过添加这个来删除所有 CASCADE DELETES

```
modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>(); 
```

如果您需要有关使用 fluent api 配置关系的更多信息，我建议[http://msdn.microsoft.com/en-US/data/jj591620](http://msdn.microsoft.com/en-US/data/jj591620)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-08-26T19:28:35.823

您还可以修改迁移类。在我的迁移课程中是：

```
CreateTable(
    "dbo.Spendings",
    c => new
        {
          SpendingId = c.Int(nullable: false, identity: true),
          CategoryGroupId = c.Int(nullable: false),
          CategoryId = c.Int(nullable: false),
          Sum = c.Single(nullable: false),
          Date = c.DateTime(nullable: false),
          Comment = c.String(),
          UserId = c.String(),
          LastUpdate = c.String(),
        })
    .PrimaryKey(t => t.SpendingId)
    .ForeignKey("dbo.Categories", t => t.CategoryId, cascadeDelete: true)
    .ForeignKey("dbo.CategoryGroups", t => t.CategoryGroupId, cascadeDelete: true)
    .Index(t => t.CategoryGroupId)
    .Index(t => t.CategoryId); 
```

删除“cascadeDelete：true”后，Update-Database 可以完美运行。

或作为`false`

```
 .ForeignKey("dbo.Categories", t => t.CategoryId, cascadeDelete: false) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-02-10T07:47:48.300

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();
    } 
```

在上下文中添加此代码

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-24T15:30:09.543

根据您的评论，问题在于您在两个表中使用相同的 PK。我会立即改变这一点，将用户 PK 作为员工中的一个额外字段，与用户有 FK 关系（我猜是一对一）。并为用户添加一个独立的 PK（另一个尊重您的表格的指南）。如果要保证Employees 中的新外键（指向Users 的外键）是唯一的，可以随时添加唯一索引。

这样你就可以保持你的结构不变并且你摆脱了循环。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-19T18:00:04.523

只是一个**更新**：

正如其他答案所暗示的，您无需对删除执行任何操作。Entityframework Core 1.0 的更新方法如下

```
table.ForeignKey(name: "FK_Cities_Regions_RegionId",
                 column: x => x.RegionId,
                 principalTable: "Regions",
                 principalColumn: "RegionId",
                 onDelete: ReferentialAction.NoAction); 
```

注意：`ReferentialAction.NoAction`继续`onDelete`

# javascript - 如何在 Locomotivejs 中设置咖啡脚本？

> ID：14489677
> 
> 赞同：2
> 
> 时间：2013-01-23T21:26:34.907
> 
> 标签：javascript, node.js, express, coffeescript, locomotivejs

我应该怎么做才能在 Locomotivejs 中设置咖啡脚本。

这似乎很容易，但我无法弄清楚。

我在“all.js”中设置了选项，没有运气。

我想我快到了或很远才能做到这一点。:(

```
this.set("options",{coffee:true}); 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T21:27:24.460

您需要添加一个`server.js`文件并使用 CoffeeScript 支持启动 Locomotive，如下所示：

```
locomotive = require('locomotive')

locomotive.boot('.', 'development', {"coffeeScript": true}, (err, server) -> 
  throw err if (err)

  server.listen(3000, 'localhost', ()-> 
    addr = this.address()
    console.log('listening on %s:%d', addr.address, addr.port);
  )
) 
```

要启动应用程序：

```
$ node server 
```

此拉取请求中有更多信息： [https ://github.com/jaredhanson/locomotive/pull/44](https://github.com/jaredhanson/locomotive/pull/44)

对`lcm`命令行的 --coffee 选项的支持将添加到即将发布的版本中。

# git - 是否应该使用 Git 来存储持续集成构建？

> ID：14489684
> 
> 赞同：10
> 
> 时间：2013-01-23T21:27:16.307
> 
> 标签：git, build, continuous-integration, ivy, artifactory

在每天可以创建多个构建（发布候选包）但每个月只有一个升级到生产环境的环境中，我认为将每个构建存储在 Git 中会很浪费，但应该有一个短期位置来发布最后几个构建.

我目前正在将这些发布到共享目录。过去我曾看到 IVY 用于这种二进制发布。Git 看起来有点矫枉过正，因为它的模型永远不会删除任何东西，它会变得臃肿。

是否有一种公认的、标准化的方式来管理/发布这些临时构建工件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-23T22:23:44.067

我不会将构建工件存储在 git 中，而是考虑从持续集成 (CI) 服务器或专用工件存储库（例如[artifactory](https://www.jfrog.com/artifactory/)或[nexus](http://www.sonatype.org/nexus/) ）共享构建工件。一般来说，我发现最好避免在所有 SCM 中使用大型二进制文件，因为您无法区分它们或进行增量更新，因此您会发现您的 git 存储库快速增长，因为它在每次更改时都存储了完整版本的二进制文件。

大多数持续集成工具（例如 Jenkins）将能够归档最后 X 个构建工件或上个月内制作的所有构建工件。他们还有一些插件，可以帮助支持和自动化推广您认为有帮助的构建的过程（即[Jenkins 构建推广](https://wiki.jenkins-ci.org/display/JENKINS/Promoted+Builds+Plugin)）。

通过使用工件存储库或 CI 服务器来管理构建工件，您通常还可以通过 API 访问工件，这在您想要自动化部署过程时非常有用，例如，您可以进行诸如“getLastSuccesfullBuild”和“getLastPromotedBuild( ）' ETC。

# c# - ASP.NET MVC 的新手，在渲染包含表单的操作时遇到问题

> ID：14489686
> 
> 赞同：1
> 
> 时间：2013-01-23T21:27:21.487
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, model-view-controller, renderaction

我习惯了 ASP.NET Web 表单，并且正在慢慢学习 ASP.NET MVC。我的网站主页上有一个小登录表单。我的自然想法是，这个登录表单可能在其他地方有用，它不是主页的主要操作，所以我想将它分离成一个局部视图。而且因为它与帐户有关，所以我希望在我的 AccountController 而不是我的 HomepageController 中登录。

登录表单是一个非常基本的强类型部分视图：

```
@model Models.Account.AccountLogin

   <h2>Login Form</h2>

    @using (Html.BeginForm("_Login", "Account")) { 

        @Html.ValidationSummary()

        <div>
            <span>Email address:</span>
            @Html.TextBoxFor(x => x.EmailAddress)
        </div>

        <div>
            <span>Password:</span>
            @Html.PasswordFor(x => x.Password)
        </div>

        <div>
            <span>Remember me?</span>
            @Html.CheckBoxFor(x => x.RememberMe)
        </div>

        <input type="submit" value="Log In" />
    }

</div> 
```

在主页上，我有这个：

```
@Html.Action("_Login", "Account") 
```

最后，在帐户控制器中，这是：

```
[HttpGet]
    public PartialViewResult _Login()
    {
        return PartialView();
    }

[HttpPost]
public PartialViewResult _Login(AccountLogin loginDetails)
{
    // Do something with this

    return PartialView();
} 
```

现在，当我加载我的主页时，它看起来不错并且包含表单。当我单击登录按钮时，它会将我带到`myurl/Account/_Login`，其中包含表单，但不在 _Layout 母版页中，只是基本的纯 HTML，当我单击登录时它根本没有做任何事情。

![按下登录后的登录表单](../Images/85b316c1048fdcb6215a2dedc480ede8.png)

我很确定我错过了我应该在这里做的一些基本方面，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:32:58.800

这是因为您要返回一个局部视图，该视图剥离了母版页，只返回了主要内容。通常以下划线开头的动作用于部分（例如，在页面的一部分中进行 ajaxing，但不是整个页面）。听起来你想要一个完整的动作，而不是部分动作，所以

```
[HttpPost]
public ActionResult Login(AccountLogin loginDetails)
{
    // Do something with this

    return View();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:46:25.460

这里的问题是您正在执行整页回发。

你有两个选择，真的。

首先，您可以使用整页回发，然后调用`Html.Partial`显示您的部分。

就像是

```
[HttpGet]
public ActionResult Login()
{
    return View();//this typically returns the view found at Account/Index.cshtml
} 
```

然后沿线创建一个视图

```
@{
    ViewBag.Title = "Index";
}

<h2>Title</h2>

@Html.Partial("PartialNameGoesHere") 
```

然后在指定的位置呈现您的部分内容，但这是在页面加载时完成的（如果您查看生成的 HTML，它看起来就像您是内联编写的一样）。

或者您可以使用 jQuery/AJAX 按需加载部分。假设您有一些描述的主页

```
public ActionResult Home()
{
    return View();
}

public ActionResult Login()
{
    return PartialView("_Login");
} 
```

创建视图

```
@{
    ViewBag.Title = "Index";
}

<h2>Home</h2>
<div>
    <p>Hey welcome to my pretty awesome page!</p>
</div>
<a href="#" class="my-login-link">Show me the login!</a>
<div id="container">

</div> 
```

然后，您可以在需要时使用一些 JS 将其加载`PartialView`到容器中。`div`

```
$(function() {
    $('.my-login-link').click(function() {
        $.ajax({
            url: 'account/login',
            success: function(data) {
                $('#container').html(data);
            }
        });
        return false;//cancel default action
    });
}); 
```

在这种情况下，页面加载正常，没有登录部分。当用户单击链接时，`Login`控制器`Account`上的 将使用 AJAX/jQuery 调用。这将返回 PartialView 的 HTML，然后您可以在`Success`处理程序中使用 jQuery 将其添加到页面中。

# java - 在 OpenCv4Android 中存储测试数据

> ID：14489689
> 
> 赞同：0
> 
> 时间：2013-01-23T21:27:24.820
> 
> 标签：java, android, c++, opencv

有什么方法可以在 OpenCv4Android 中保存测试数据（在 Java 中不是本机），例如 C++ 中 OpenCv 中的 FileStorage 类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:54:17.543

查看[官方 OpenCV java 文档](http://docs.opencv.org/java/)（版本 2.4.3.2）后，我没有找到 c++ 的任何替代品`FileStorage`。所以你应该自己保存和读取数据或使用本机代码。

# ios - 这些 Dsymutil 警告在 XCode 4.5 中意味着什么？

> ID：14489692
> 
> 赞同：13
> 
> 时间：2013-01-23T21:27:37.643
> 
> 标签：ios, xcode, xcode4.5, dsymutil

我正在链接一个针对 iOS 的静态框架，针对 armv7 ios 6 应用程序，我怀疑原始二进制文件来自 XCode 3.x 并使用 GCC 编译，我现在正在使用 CLang 编译器链接它。我没有框架的源代码，只有二进制文件：

```
(null): warning: (armv7) /.../DerivedData/.../armv7/HardwareObjectFile.o unable to open object file 
```

我收到 69 条类似上述警告，每个链接到静态框架的 .o 文件都有一条。

出于某种原因，此警告是否严重？我已经简化了巨大的路径，这似乎表明库中的二进制文件已经在“/Users/somedeveloperthatisntme”中硬编码了一个路径，这几乎没有帮助，但不存在，因为我在一台甚至没有的计算机上使用这个库有一个名为“Users/somedeveloperthatisntme”的文件夹。

[Dsymutil](http://developer.apple.com/library/Mac/#documentation/Darwin/Reference/ManPages/man1/dsymutil.1.html)似乎是一种“操纵存档的 DWARF 调试符号文件”的工具，尽管我对它是什么以及它的作用一无所知，尽管 Apple 提供了详尽的文档，它告诉我为什么，但从来没有告诉我。它在做什么，这个警告对我意味着什么？我怀疑我需要供应商提供一个新的库/静态框架来解决这个问题？

*更新：*我无法解决这个问题，原因似乎在于由非常旧的 XCODE 版本编译的非常旧的二进制文件，作为第三方供应商的移动框架的一部分提供。这种情况下的问题将通过让该供应商重建他们的库来解决，我要求他们这样做，因为警告让我发疯，但他们似乎无法做到。最后，我放弃了他们的技术并用其他东西取而代之。（咧嘴笑）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-09-02T21:42:19.830

这些错误与您使用的架构和您引用的资源有关。我自己也不明白原因，但是如果您希望它们消失，请转到构建设置，然后构建选项，然后选择调试信息格式并选择 DWARF。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-27T17:09:07.997

我在另一边，构建一个库供其他人使用，并且我能够通过在构建设置中设置“GCC_GENERATE_DEBUGGING_SYMBOLS = NO”来更改库项目，以使这些警告在消耗的应用程序项目中消失输出框架。

这不能解决您的问题，但如果您与该供应商联系，您可以将其传递。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-14T17:28:41.403

其他答案包含有用的信息，但我希望简明扼要地写下真正的答案：

您无法修复此问题，错误的含义很简单：当前链接器将这些库文件视为包含无法打开的元素。

要解决警告，请联系供应商并获取已使用更高版本的 CLANG 重建的重新编译库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-09T15:44:35.317

我所做的只是删除 /Library/Developer/Xcode/DerivedData 文件夹，它为我修复了所有问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-26T15:04:04.147

出现这些警告的另一个原因是项目中发布版本的符号剥离设置不正确。联系框架的作者并告诉他们使用正确的符号剥离设置制作一个新的二进制文件。

# javascript - 如何在Javascript中为回调提供执行函数对象实例

> ID：14489697
> 
> 赞同：0
> 
> 时间：2013-01-23T21:27:58.913
> 
> 标签：javascript, websocket, callback, dom-events

我有一个命名空间对象，在该对象上定义了一些函数。其中一个函数用于创建到远程服务器的 websocket 会话。

```
ns.Session = function(url, config, callback){
   var ws = new WebSocket(url);
   ws.onmessage = function (e){
       if(login(e.data)){
           // This is the point at which I need to pass back the session object to callback
           callback(session):
       }
   }
   ....
} 
```

在 Javascript 中，据我所知，如果有人调用此函数，`ns.Session(....)`则`this`对象将是 ns. 那么，如何让“会话”的**实例**发送到回调。
`arguments.callee`据我所知，已弃用。

我这样做的全部原因是在服务器确认登录之前会话不被认为是“可用的”，所以我不想在实际连接和登录之前过早返回函数对象。因此使用的回调。如果有更好的方法来实现这一点，我也对此持开放态度。

Session 还有很多其他的内部函数，比如`addHandler`,`sendData`等等，为了简洁起见，我没有在这里展示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T21:50:08.603

您可以像这样使用指针来运行：

```
ns.Session = function session(...) {
    // 'session' here points to your function, so you do
    callback(session); // like you wrote
    callback(ns.Session); // same effect if you don't change ns and ns.Session pointers
} 
```

另外，我不明白为什么在这种情况下使用“实例”一词，因为函数只有一个实例。如果你用'new'关键字调用它，函数会从函数中创建新对象，现在你可以使用“instance”这个词。

# c - C“double to num”转换代码：为什么这样写？

> ID：14489698
> 
> 赞同：2
> 
> 时间：2013-01-23T21:28:01.767
> 
> 标签：c, double, type-conversion, low-level

我不明白以下 C 转换函数是如何工作的（以及为什么要这样写）；我相当肯定原作者知道他在做什么：

```
typedef union TValue {
  uint64_t u64;
  double n;
  struct {
    uint32_t lo;    /* Lower 32 bits of number. */
    uint32_t hi;    /* Upper 32 bits of number. */
  } u32;
  [...]
} TValue;

static int32_t num2bit(double n)
{
  TValue o;
  o.n = n + 6755399441055744.0;  /* 2^52 + 2^51 */
  return (int32_t)o.u32.lo;
}

static uint64_t num2u64(double n)
{
#ifdef _MSC_VER
  if (n >= 9223372036854775808.0)  /* They think it's a feature. */
    return (uint64_t)(int64_t)(n - 18446744073709551616.0);
  else
#endif
  return (uint64_t)n;
} 
```

*   num2bit 实际上只是投入了`double`吗`int32_t`？为什么要加法？为什么要这样写？
*   num2u64 中提到的这个“功能”是什么？（我相信 _MSC_VER 意味着它是微软 C 编译器的代码路径）。

请注意，并不*总是*使用这些函数（取决于 CPU 架构），这是针对 little-endian 的（我解决了一些预处理器宏以简化）。

在线浏览镜像的链接（代码来自[LuaJIT](http://luajit.org)项目）：环绕[头文件](http://repo.or.cz/w/luajit-2.0.git/blob_plain/HEAD:/src/lj_obj.h)（或[整个项目](http://repo.or.cz/w/luajit-2.0.git/)）。

每一个提示都值得赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-24T10:27:36.310

num2bit 旨在实现[Lua BitOp 语义](http://bitop.luajit.org/semantics.html)，尤其是 wrt。模运算。实现定义的行为得到了很好的控制，因为无论如何 LuaJIT 只适用于特定的 CPU、平台和编译器。不要在其他任何地方使用此代码。

num2u64 是 MSVC 的错误/错误功能的解决方法，它始终通过 int64_t 将双精度转换为 uint64_t。对于 >= 2^63 的数字，这不会给出所需的结果。MS 认为这种可憎行为是一种“特征”。呃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:43:12.997

num2bit：通过将第 51 位和第 52 位设置为 1，这会强制指数为特定数字（否则会溢出） - 然后当您返回 (int32_t)o.u32.lo 时，您知道您得到的是一个整数由于指数是固定的，因此与双精度的“低 32 位”值相同。所以，这是一个快速获得大多数双打整数值的技巧。看起来这样做会截断小数点后的数字，如果一开始是 2^51 或更大，则会产生意想不到的效果。

```
>>> math.frexp(1.0 + 6755399441055744.0)
(0.7500000000000001, 53)
>>> math.frexp(0.0 + 6755399441055744.0)
(0.75, 53)
>>> math.frexp(564563465 + 6755399441055744.0)
(0.7500000626791358, 53)
>>> math.frexp(-564563465 + 6755399441055744.0)
(0.7499999373208642, 53)
>>> math.frexp(1.5 + 6755399441055744.0)
(0.7500000000000002, 53)
>>> math.frexp(1.6 + 6755399441055744.0)
(0.7500000000000002, 53)
>>> math.frexp(1.4 + 6755399441055744.0)
(0.7500000000000001, 53) 
```

编辑：设置第 51 位和第 52 位的原因是因为如果您只设置第 52 位，那么负数会导致指数发生变化：

```
>>> math.frexp(0 + 4503599627370496.0)
(0.5, 53)
>>> math.frexp(-543635634 + 4503599627370496.0)
(0.9999998792886404, 52) 
```

num2u64：没有线索。但第一个数字是 2^63，第二个是 2^64。将大于 2^63 的 double 转换为其整数表示时，可能是为了防止溢出或签名失败，但我不能告诉你更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T02:22:52.513

`num2bit`手动将 IEEE 标准的内存表示转换`double`为 32 位、定点、二进制补码格式，使用舍入到最接近的整数。

通过 a 进行转换`union`是不安全的，因为它违反了*严格的类型别名规则*。你不能给工会的一个成员写信，然后从另一个成员那里读。做类似的事情会更合适

```
static int32_t num2bit(double n)
{
  int32_t o;
  n += 6755399441055744.0;  /* 2^52 + 2^51 */
  memcpy( & o, & n, sizeof o ); /* OK with strict aliasing but must mind endianness. */
  return o;
} 
```

此功能可能旨在作为一种优化，但它的价值本身是可疑的。您需要重新测试每一个新的微处理器，并确保它只用于速度更快的硬件上。

另请注意，普通 C 浮点整数转换使用四舍五入或截断。这个函数可能根本不打算处理小数值。

* * *

`num2u64`是特定于 Windows 的解决方法（请注意`#ifdef`）。将`double`大于 2 ^(63)的值转换为无符号整数时，会发生“不好的事情”（可能是饱和），因此作者减去 2 ^(64)使其成为负数，然后将其转换为有符号负整数，然后转换结果到一个值大于 2 ^(63)的无符号整数。

在任何情况下，您都可以看出意图只是将 a 转换`double`为 a `uint64_t`，因为这就是它在非 Windows 平台上所做的一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T22:27:12.673

这些功能通过魔术“工作”。

这来自 n1570.pdf 的§6.2.6.1p7，它是 C 标准草案：当一个值存储在联合类型对象的成员中时，对象表示的字节不对应于该成员但确实对应其他成员取未指定值

请注意所呈现的代码如何通过分配给 on 然后使用 o.u32.lo 的值来使用*未指定的值。*

这来自n1570.pdf的§6.3.1.3p3，它是C标准草案：否则，新类型被签名并且值不能在其中表示；结果是实现定义的，或者引发了实现定义的信号。

请注意呈现的代码如何调用实现定义的行为，因为它多次从无符号转换为有符号的 32 位整数。假设它改为引发实现定义的计算异常信号。如果要返回默认信号处理程序，这也会导致未定义的行为。`/* They think it's a feature. */`

# interface - 了解界面

> ID：14489702
> 
> 赞同：2
> 
> 时间：2013-01-23T21:28:10.113
> 
> 标签：interface, go, go-interface

我是 Go 语言的新手，我试图通过编写一段简单的代码来理解 Go 接口。我收到一个错误，因为我无法理解引用接口方法的正确方法，请告诉我哪里出错了。

```
type Info interface {
Noofchar() int
}

type Testinfo struct {
noofchar int
}

func (x Testinfo)Noofchar() int {
return x.noofchar
}

func main(){
var t Info
fmt.Println(x.Testinfo)
fmt.Println("No of char ",t.Noofchar())
x.noofchar++
fmt.Println("No of char ",t.Noofchar())
} 
```

我是否通过 t.Noofchar() 正确引用了该方法？或者我还缺少其他东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:38:48.883

方法通常接收指向结构的指针。

```
func (x Testinfo)Noofchar() int { 
```

变成

```
func (x *Testinfo)Noofchar() int { 
```

一开始就拿出来`var x Info`，稍微重构`main()`一下，结果代码是：

```
package main

import "fmt"

type Info interface {
    Noofchar() int
    Increment()
}

type Testinfo struct {
    noofchar int
}

func (x *Testinfo) Noofchar() int {
    return x.noofchar
}
func (x *Testinfo) Increment() {
    x.noofchar++
}

func main(){
    var t Info = &Testinfo{noofchar:1}
    fmt.Println("No of char ",t.Noofchar())
    t.Increment()
    fmt.Println("No of char ",t.Noofchar())
} 
```

[http://play.golang.org/p/6D-LzzYYMU](http://play.golang.org/p/6D-LzzYYMU)

在您的示例中，您`x`直接修改。如果要传递接口，则无法访问底层数据结构，只能访问方法。因此，我将您的直接增量更改为一种`Increment()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:35:36.860

`x`是一个变量，您可以为其分配任何实现`Info`接口的东西。您没有为该变量分配任何内容。

一旦你分配了一些东西，`x.noofchar++`将无法工作，因为再次`x`可以保存任何实现`Info`接口的东西，这意味着你只能访问由该接口定义的方法。接口不允许直接访问字段。

`Info`接口中定义的唯一方法是`Noofchar() int`方法，因此这是与存储在 中的值进行交互的唯一方法`x`。

`x`方法接收者定义的与变量`(x Testinfo)`完全无关。`var x Info`那`x` *确实*可以直接访问结构字段。

`t.Noofchar()`调用是正确的并且会起作用。

# php - 从服务器上的外部源将 Javascript 写入页面

> ID：14489705
> 
> 赞同：1
> 
> 时间：2013-01-23T21:28:14.660
> 
> 标签：php, file

我一直在寻找这个，虽然我的问题似乎比其他人发布的类似问题容易得多，但我仍然找不到解决方案。

我想要一个数组来填充 .txt 文件中的内容。事情是（与其他人有这个问题相反），我不需要对 txt 文件中的内容做任何事情，因为它已经是`[1, 2, 3], [a, b, c], ...`等的形式。所以我唯一想做的就是打印txt 文件中的内容

`<script>`在和之间的某处`</script>`，有：

```
var locations = [
*contents of the txt file should go here*
]; 
```

就是这样！有没有办法从 txt 文件中获取内容并用 javascript 打印出来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:30:44.127

假设您在浏览器上下文中使用 javascript，这是不可能的。安全限制阻止在浏览器中运行的脚本访问主机的文件系统。

编辑：伟大的评论家伙！如果您能够使用 HTML5，那么您就有一些使用 FileAPI（草案）标准的文件访问能力。

**Paul S**提供了这个 jsbin 来演示：http: [//jsbin.com/ulodaj/1/](http://jsbin.com/ulodaj/1/)

理想情况下，您要做的是将该文本文件转换为 JSON 格式，然后使用 FileAPI 从磁盘读取字符串。从那里，只是`locations = JSON.parse(fileText)`

编辑：因此，如果文本文件位于 PHP 站点上的目录中，为什么不使用 PHP 读取文件并按照 OP 中的指示写入数据？

这里要注意的是，您仍然希望输入文件是有效的 JSON——`[1, 2, 3], [a, b, c]`不是。一个小的改变`{ foo: [a,b,c], bar: [1,2,3] }`就可以了。请注意，我什至不会提及使用`eval`，因为......是的，它是邪恶的。不要使用它:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T22:04:16.280

使用[*File API*](http://www.w3.org/TR/FileAPI/)[`FileReader`](https://developer.mozilla.org/en-US/docs/DOM/FileReader)访问本地计算机上用户选择的文件，这在大多数现代浏览器上都可用[，](http://caniuse.com/#feat=fileapi)您可以通过以下方式实现所需的操作（[示例](http://jsbin.com/ulodaj/1/)）：

```
var locations;
input.onchange = function () { // `input` some <input type="file">
    var fr = new FileReader();
    fr.onload = function (e) {locations = this.result.split("\n");}; // make this callback your next stage
    fr.readAsText(this.files[0]);
} 
```

请注意，这是事件驱动的，因此您必须使用回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:30:42.970

首先，请原谅我没有详细描述这个问题。我找到了解决我的问题的方法，而且我在这里还很新（而且不是那么好的程序员），但我会尝试解释答案。

**首先，问题：** 我有 php 页面，在该页面上有一些 javascript 代码`<head>`。在那个 javascript 中，我想从 txt 文件中加载内容。txt 文件中的*确切文本*是：

```
var locations = [
['a', 123, 456, 'foo', 'bar'],
[...],
['b', 456, 789, 'bar', 'foo'],
]; 
```

我知道这不是一个完美的解决方案，而且我知道该`var locations [];`部分应该在 javascript 而不是 txt 文件中，但这对我来说很好。

**解决方案：** 在 javascript`<?php echo file_get_contents('text.txt'); ?>`中，我将文本文件的内容放在了我希望显示的位置，就是这样！

它解决我的问题的原因是因为我必须经常更新位置数组，并且代码出现在大约 30 页上。当有新位置时，我不想更新`<head>`这些页面的所有部分，所以我想在 javascript 中放入一些代码，从外部文件中获取位置。现在我只需要更新一个文件。

再次，我意识到我没有以清晰的方式描述我的问题，但我希望其他有同样问题的人可以使用这个解决方案！

# mysql - 选择 0000-00-00 00:00:00 的 MySQL 日期时间列

> ID：14489710
> 
> 赞同：4
> 
> 时间：2013-01-23T21:28:30.173
> 
> 标签：mysql, database, datetime

我正在寻找一种简单的方法来选择日期时间列 000-00-00 00:00:00 （基本上是默认的未设置值）。

以下查询似乎有效：

```
SELECT * FROM myTable WHERE datetimeCol < 1 
```

但这会一直可靠地工作并跨越不同的 mysql 版本吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T22:26:27.903

I would check for "zero" dates like this:

```
SELECT * FROM myTable WHERE datetimeCol = CONVERT(0,DATETIME) 
```

I would prefer the equality predicate over an inequality predicate; it seems to convey my intentions more clearly. And if there are more predicates in the statement, and if the datetimeCol is a leading column in an index, it may help the optimizer make use of a multi-column index.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T21:31:10.020

尝试这个：

```
SELECT * FROM myTable WHERE datetimeCol = '0000-00-00 00:00:00' 
```

事后看来可能很明显；）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T21:37:47.570

如何与`0`价值进行比较：

```
datetimeCol = 0 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-15T04:06:21.137

尝试这个：

`SELECT * FROM myTable WHERE UNIX_TIMESTAMP(datetimeCol) = 0`

# ruby-on-rails - Ruby on Rails - 将 XML 存储在临时文件中

> ID：14489712
> 
> 赞同：2
> 
> 时间：2013-01-23T21:28:35.433
> 
> 标签：ruby-on-rails, ruby, xml, nokogiri, temporary-files

我希望能够将我的 xml 存储到一个临时文件中，然后将其发送到另一个控制器中的另一个方法进行处理。目前它不允许我读取文件，一旦发送，因为它是一个私有方法。

控制器 #1

```
xml_doc  = Nokogiri::XML(@builder.to_xml)
@tempfile = Tempfile.new('xml')
@tempfile.write(xml_doc)
redirect_to upload_xml_admin_events_path(:file => @tempfile) 
```

控制器 #2

版本 #1

```
xml = params[:file].read
xmldoc = Nokogiri::XML(xml) 
```

给我这个错误：“文件：0x6ebfb00”的未定义方法“读取”：字符串

版本 #2

```
xml = params[:file]
xml.open
xmldoc = Nokogiri::XML(xml) 
```

给我这个错误：为“#File：0x6a12bd8”调用私有方法`open'：String

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:28:16.640

It seems like you are thinking that params can be objects, which can be forgiven due to Rails magic. In reality [all params are strings with a key in the key=value format.](http://en.wikipedia.org/wiki/Query_string)

So the issue here is that when you redirect with the parameter 'file', it turns your Tempfile object into a string. This is why the error is telling you that there are no accessible methods called read or open for a string. I see a few options:

1.  Do whatever you are going to do with the file on Controller 1 instead of redirecting to Controller 2\. You won't have to create extra objects, hit a database, or have crazy parameters in your URL.

2.  If the XML can be really large, it might be better to make an AR object called XmlFile or something and write it to the database in Controller 1, then redirect with that id in the parameters. This way, you won't have to send crazy long XML strings in the URL ([which is bad](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url)):

    ```
    # Controller 1
    @xml = XmlFile.new(@builder.to_xml)
    redirect_to upload_xml_admin_events_path(:xml => @xml) #implicitly @xml.to_s

    # Controller 2
    @xml = XmlFile.find(params[:xml])
    Nokogiri::XML(@xml) 
    ```

3.  If the XML is always (very) small, you can send the XML as a param in plain text (this seems to be closest to what you are currently doing, but strikes me as less elegant) You might run into URL encoding issues here though.

    ```
    # Controller 1
    xml = @builder.to_xml
    redirect_to upload_xml_admin_events_path(:xml => xml)

    # Controller 2
    @xml = Nokogiri::XML(params[:xml]) 
    ```

# java - ReverseGeocodingTask 任务到方法

> ID：14489714
> 
> 赞同：0
> 
> 时间：2013-01-23T21:28:37.570
> 
> 标签：java, android, geolocation

我从 android 站点获取了一个代码，该代码执行反向地理编码（将位置从数字传输到文本）

它工作正常，但由于我的应用程序发生了一些变化，我需要将此代码更改为普通方法，现在它是一个 AsyncTask。它应该得到一个位置并返回一个字符串。

这段代码对我来说有点奇怪，所以我需要你们的帮助：

```
private class ReverseGeocodingTask extends AsyncTask<Location, Void, Void> 
{
    Context mContext;

    public ReverseGeocodingTask(Context context) 
    {
        super();
        mContext = context;
    }

    @Override
    protected Void doInBackground(Location... params) 
    {
        Geocoder geocoder = new Geocoder(mContext, Locale.getDefault());

        Location loc = params[0];
        List<Address> addresses = null;
        try {
            addresses = geocoder.getFromLocation(loc.getLatitude(), loc.getLongitude(), 1);
        } catch (IOException e) {
            e.printStackTrace();
            // Update address field with the exception.
            LocationService.this.address = e.toString();
        }
        if (addresses != null && addresses.size() > 0) 
        {
            Address address = addresses.get(0);
            // Format the first line of address (if available), city, and country name.
            String addressText = String.format("%s, %s, %s",
                    address.getMaxAddressLineIndex() > 0 ? address.getAddressLine(0) : "",
                    address.getLocality(),
                    address.getCountryName());
            // Update address field on UI.
           // Message.obtain(mHandler, UPDATE_ADDRESS, addressText).sendToTarget();
            LocationService.this.address = addressText;
        }
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:32:01.190

你首先制作一个这样的方法

```
public String reverseGeocode(Location loc) {

} 
```

更改抓住第一个位置的线，作为唯一使用的线，然后将其删除 - 你已经有了 loc

```
//Location loc = params[0]; 
```

然后，不要将地址设置为该位置服务，只需将其返回：

```
//LocationService.this.address = addressText;
return addressText; 
```

将它们拼接到方法中，最后删除不必要的 return 语句，你就很成功了。

仔细一看，我还看到了一个异常，你只想抛出链而不是在这个方法中处理。让任何调用您的方法的方法逐个处理：这不是该方法可以解决的问题。

# django - Django 注册限制到特定域的电子邮件地址

> ID：14489719
> 
> 赞同：2
> 
> 时间：2013-01-23T21:28:48.577
> 
> 标签：django, django-models, django-forms, django-templates, django-registration

对 Django 来说相当新，并且有一个关于 Django 注册的问题。

我已经成功启动并使用电子邮件验证正确注册用户，现在我想做的是修改功能，以便只允许具有特定域电子邮件地址的人注册。因此，例如，如果“xyz.org”是域，那么只有尝试使用 blahblahblah@xyz.org 电子邮件注册的用户才会成功。

下面是我到目前为止处理这一切的相关代码，减去注册成功等。我想我基本上只需要能够插入一种新类型的表单对象来验证电子邮件字段，但我不确定如何。非常感谢所有冗长的内容，因为我对此仍然有些粗略。谢谢！

```
url(r'^accounts/', include('registration.backends.default.urls') 
```

`

```
{% block content %}

{% if form.errors %}
<p>Reg form errors</p>
{% endif %}

<form method="post" action=''>
{% csrf_token %}
{{ form.as_p }}

<input type="submit" value="Send activation email" />
</form>

{% endblock %} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:04:32.227

You will need to subclass `registration.forms.RegistrationForm` and add a custom [validator](https://docs.djangoproject.com/en/dev/ref/validators/#built-in-validators) for the email field, a RegexValidator will work.

```
from registration.forms import RegistrationForm

class NewRegistrationForm(RegistrationForm):
    def __init__(self, *args, **kwargs):
        super(NewRegistrationForm, self).__init__(*args, **kwargs)
        self.fields['email'].validators = [validate_domain] 
```

After you have the validator, and the new form, you will have to use this new form for the registration view. In your `urls.py`:

```
urlpatterns = patterns(
    ...
    url(r'^register/$', register, { 'form_class': NewRegistrationForm }, name='registration_register')
    ...
) 
```

I haven't tested this out, but I hope it puts you on the right track!

# objective-c - 关闭模态呈现的 UITabBarController

> ID：14489723
> 
> 赞同：0
> 
> 时间：2013-01-23T21:28:55.917
> 
> 标签：objective-c, uitabbarcontroller

编辑：添加了包含解雇的代码。

**新数据**

该问题与旧数据下列出的问题相同，只是解雇线已更改。

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];
    if([title isEqualToString:@"Yes"])
    {
        NSLog(@"Calling Dismissal...");
        [self.presentingViewController dismissViewControllerAnimated:YES completion:nil];
    }
} 
```

正在调用该函数，因为日志中显示“正在调用解雇...”。

当前层次结构：UITabBarController - NavigationController/NavigationController - View1/View2

**旧数据**

万一问题令人困惑，我试图解除一个 UITabBarController 而不是我以模态方式呈现的。UITabBarController 确实使用 NavigationControllers 来设置内部的两个视图。但是，无论我放入多少 parentViewController

（IE）：

```
[self.parentViewController.parentViewController.etc... dismissViewControllerAnimated:YES completion:nil]; 
```

UITableBarController 不会关闭。我在调用上面代码行的两个视图的 NavigationController 中放置了一个按钮。关于如何关闭 UITableViewController 的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:34:33.367

呈现视图控制器与父视图控制器的概念不同，需要将其关闭。这段代码：

```
[self.presentingViewController dismissViewControllerAnimated:YES completion:nil]; 
```

通常会做到这一点。

但是，根据这个控制器的功能，我通常更喜欢让我呈现的控制器发送委托消息或发送`NSNotification`给父级，因此父级可以在解雇之前提取它需要的任何数据。

# jsf - 如何确保用户在查看任何页面之前已登录？JSF

> ID：14489728
> 
> 赞同：0
> 
> 时间：2013-01-23T21:29:18.873
> 
> 标签：jsf

我创建了一个项目，我希望确保用户已登录并使用我的 ldap 服务器进行身份验证，我将如何处理，

```
 |-- META-INF
 |-- WEB-INF
 |-- resources
 |    |-- css
 |    |    `-- style.css
 |
 |-- upload
 |    |-- uploadText.xhtml
 |
 |-- index.xhtml
 |-- SubmittedText.xhtml
 |-- etc.xhtml 
```

我想保护除资源文件夹之外的所有内容

这是我当前的 web.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee         http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
    <filter>
        <filter-name>Upload Filter</filter-name>
        <filter-class>richard.fileupload.UploadFilter</filter-class>
        <init-param>
            <param-name>sizeThreshold</param-name>
            <param-value>1024</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>Upload Filter</filter-name>
        <url-pattern>/upload/*</url-pattern>
    </filter-mapping>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>
    <welcome-file-list>
        <welcome-file>index.xhtml</welcome-file>
    </welcome-file-list>
    <context-param>
        <param-name>javax.faces.PROJECT_STAGE</param-name>
        <param-value>Development</param-value>
    </context-param>
    <context-param>
        <param-name>facelets.LIBRARIES</param-name>
        <param-value>/WEB-INF/corejsf.taglib.xml</param-value>
    </context-param>
    <context-param>
        <param-name>javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL</param-name>
        <param-value>true</param-value>
    </context-param>
    <login-config>
        <auth-method>FORM</auth-method>
        <realm-name>LDAP</realm-name>
        <form-login-config>
            <form-login-page>/login.xhtml</form-login-page>
            <form-error-page>/login-failed.xhtml</form-error-page>
        </form-login-config>
    </login-config>
    <security-role>
        <role-name>*</role-name>
    </security-role>
    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Restircted resources</web-resource-name>
            <url-pattern>/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint> 
    </security-constraint>
    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Allowed resources</web-resource-name>
            <url-pattern>/javax.faces.resource/*</url-pattern>
            <!--  <http-method>GETLIB</http-method>
            <http-method>COPY</http-method>
            <http-method>MOVE</http-method>
            <http-method>DELETE</http-method>
            <http-method>PROPFIND</http-method>
            <http-method>GET</http-method>
            <http-method>HEAD</http-method>
            <http-method>PUT</http-method>
            <http-method>MKCOL</http-method>
            <http-method>PROPPATCH</http-method>
            <http-method>LOCK</http-method>
            <http-method>UNLOCK</http-method>
            <http-method>VERSION-CONTROL</http-method>
            <http-method>CHECKIN</http-method>
            <http-method>CHECKOUT</http-method>
            <http-method>UNCHECKOUT</http-method>
            <http-method>REPORT</http-method>
            <http-method>UPDATE</http-method>
            <http-method>CANCELUPLOAD</http-method>-->
        </web-resource-collection>
        <!-- No Auth Contraint! -->
    </security-constraint>
</web-app> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:37:48.637

您`<security-constraint>`缺少`<auth-constraint>`. 没有身份验证约束的安全约束基本上是公共资源。例如，如果您想限制所有角色，那么您应该将以下身份验证约束放在安全约束中。

```
<auth-constraint>
    <role-name>*</role-name>
</auth-constraint> 
```

总而言之，如果您想限制`/*`期望的一切`/javax.faces.resource/*`，那么您应该具有以下安全约束，完全按照以下顺序`web.xml`：

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Restircted resources</web-resource-name>
        <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>*</role-name>
    </auth-constraint> 
</security-constraint>
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Allowed resources</web-resource-name>
        <url-pattern>/javax.faces.resource/*</url-pattern>
    </web-resource-collection>
    <!-- No Auth Contraint! -->
</security-constraint> 
```

您的 HTTP 方法限制列表有些荒谬，请忽略它。默认情况下，它已经应用于每个 HTTP 方法。

# ajax - 如何使用 Arquillian Graphene 持续测试 AJAX？

> ID：14489729
> 
> 赞同：0
> 
> 时间：2013-01-23T21:29:19.677
> 
> 标签：ajax, firefox, junit, jboss-arquillian

我正在使用 WebDriver 运行 Arquillian Graphene (2.0.0.Alpha3)，但结果不一致。有时，我的 JUnit 测试会毫无问题地通过，有时我会收到如下错误：

```
12:13:29.667 WARN - Exception thrown
org.openqa.selenium.WebDriverException: ReferenceError: Graphene is not defined
Command duration or timeout: 946 milliseconds
Build info: version: '2.28.0', revision: '18309', time: '2012-12-11 20:21:18'
System info: os.name: 'Windows 7', os.arch: 'amd64', os.version: '6.1', java.version: '1.6.0_30'
Session ID: 6dce0406-d50d-46d9-8e28-01f159a593b7
Driver info: org.openqa.selenium.firefox.FirefoxDriver
Capabilities [{platform=XP, acceptSslCerts=true, javascriptEnabled=true, browserName=firefox, rotatable=false, locationContextEnabled=true, version=10.0.12, cssSelectorsEnabled=true, databaseEnabled=true, handlesAlerts=true, nativeEvents=true, webStorageEnabled=true, applicationCacheEnabled=true, takesScreenshot=true}]
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at org.openqa.selenium.remote.ErrorHandler.createThrowable(ErrorHandler.java:187)
    at org.openqa.selenium.remote.ErrorHandler.throwIfResponseFailed(ErrorHandler.java:145)
    at org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:533)
    at org.openqa.selenium.remote.RemoteWebDriver.executeScript(RemoteWebDriver.java:441)
    at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.openqa.selenium.support.events.EventFiringWebDriver$2.invoke(EventFiringWebDriver.java:101)
    at $Proxy1.executeScript(Unknown Source)
    at org.openqa.selenium.support.events.EventFiringWebDriver.executeScript(EventFiringWebDriver.java:209)
    at org.openqa.selenium.remote.server.handler.ExecuteScript.call(ExecuteScript.java:55)
    at org.openqa.selenium.remote.server.handler.ExecuteScript.call(ExecuteScript.java:1)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at org.openqa.selenium.remote.server.DefaultSession$1.run(DefaultSession.java:167)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

似乎大多数问题都发生在请求保护上。例如：

```
guardXhr(_acceptButton).click(); 
```

可能是什么原因？有没有办法调试或解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T01:00:46.373

这被确认是 2.0.0.Alpha3: [ARQGRA-262](https://issues.jboss.org/browse/ARQGRA-262)中的一个错误。

有一个可用的修复程序，并且似乎可以使用最新的 2.0.0.Beta1-SNAPSHOT。

# ssl - 不懂 OpenSSL_add_all_algorithms 方法

> ID：14489731
> 
> 赞同：10
> 
> 时间：2013-01-23T21:29:22.280
> 
> 标签：ssl, openssl

文件说

> OpenSSL 保留一个摘要算法和密码的内部表。它使用此表通过诸如 EVP_get_cipher_byname() 之类的函数来查找密码。
> 
> OpenSSL_add_all_digests() 将所有摘要算法添加到表中。

我的问题是，这个表存储在哪里？我的代码怎么知道这个方法已经执行了？......它在内部是如何工作的，如果我想要更多的 SSL 连接，一个添加所有摘要而一个不添加，该怎么办？有谁知道这方面的任何好的文档？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T22:45:00.843

手册页的注释部分几乎总结了它：

> 一个典型的应用程序最初会调用 OpenSSL_add_all_algorithms() 并在退出之前调用 EVP_cleanup()。

和

> 密码和摘要查找函数用于库的许多部分。如果表未初始化，则几个函数将行为不端并抱怨他们找不到算法。这包括 PEM、PKCS#12、SSL 和 S/MIME 库。这是 OpenSSL 邮件列表中的常见查询。

因此，假设您正在编写一个典型的应用程序，您将把它添加到您的 OpenSSL 初始化代码中：

```
OpenSSL_add_all_algorithms(); 
```

这是 OpenSSL 清理代码：

```
EVP_cleanup(); 
```

你就完成了。您始终负责在使用 OpenSSL 的应用程序中自己调用这些。如果您想知道 OpenSSL 如何在内部存储表，[请使用源 Luke](https://www.openssl.org/source/)。

要控制可用于特定 SSL 上下文的密码，您将使用[SSL_CTX_set_cipher_list](https://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html)。

至于比手册页更好的文档，我可以推荐[John Viega、Matt Messier 和 Pravir Chandra 的“Network Security with OpenSSL”](http://shop.oreilly.com/product/9780596002701.do)。这本书很旧，没有涵盖较新版本的 OpenSSL，但其中大部分内容仍然非常适用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-01T19:14:52.250

较新的 OpenSSL 版本不需要 OpenSSL_add_all_algorithms() 并被忽略。为了向后和向前兼容，请使用：

```
# if OPENSSL_API_COMPAT < 0x10100000L
OpenSSL_add_all_algorithms();
# endif 
```

和

```
# if OPENSSL_API_COMPAT < 0x10100000L
EVP_cleanup();
# endif 
```

这同样适用于 OpenSSL_add_all_ciphers() 和 OpenSSL_add_all_digests()。

有关更多详细信息，请参阅 [https://www.openssl.org/docs/man1.1.0/man3/OpenSSL_add_all_digests.html的手册页](https://www.openssl.org/docs/man1.1.0/man3/OpenSSL_add_all_digests.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-22T16:06:54.587

这是一个老问题。该 API 在几年前已被弃用：

> OPENSSL_init_crypto() 在 OpenSSL 1.1.0 中弃用了 OpenSSL_add_all_algorithms()、OpenSSL_add_all_ciphers()、OpenSSL_add_all_digests() 和 EVP_cleanup() 函数。

参考： [https ://www.openssl.org/docs/man1.1.0/man3/OpenSSL_add_all_algorithms.html](https://www.openssl.org/docs/man1.1.0/man3/OpenSSL_add_all_algorithms.html)

# java - 错误“无法打开系统剪贴板”，尝试设置系统剪贴板失败/打开和关闭。原因是什么？

> ID：14489733
> 
> 赞同：4
> 
> 时间：2013-01-23T21:29:26.413
> 
> 标签：java

我正在编写一个程序，并且在我的程序中，我希望在我的程序没有焦点时观看键盘。我使用一个名为“JNativeHook”的罐子，可以在这里找到[http://code.google.com/p/jnativehook/](http://code.google.com/p/jnativehook/)

关于我的问题：这个 jar 可以工作并捕获每个按键和释放事件。在我的代码中，我跟踪这些，在每个按键事件中，如果按下“v”或 ctrl 键，我为每个按键设置一个标志，如果两者都为真，则用户正在粘贴。当用户最初粘贴时，程序将计数器递增到 1。在下一次粘贴时，如果计数器为 1，它将系统剪贴板的文本设置为“Test Paste1”，递增计数器，它执行 3 次，第三次取模计数器 3 并重新启动。（我计划添加控制，以便如果按下某个组合，keyListener 处于活动状态并尝试更改系统剪贴板；再次按下它会关闭它）

我的问题是，有时它确实修改了剪贴板，我实际上粘贴了正确的文本，有时它没有，我得到一个错误

```
Exception in thread "pool-1-thread-135" java.lang.IllegalStateException: cannot open system clipboard 
```

所以有时我可以打开键盘，有时不能。我正在使用记事本进行测试。所以我运行我的程序，打开记事本，复制一些东西。然后我粘贴，它说，然后下一次粘贴有时正确有时不正确，下一次（第二次粘贴），下一次（第三次）。然后，如果我一直坚持下去，它就会重新开始。

为什么有时我无法访问剪贴板，我怎么能这样写才能保证文本到达剪贴板？

我想把这条线放在一个while循环中，而没有异常继续。但是，如果剪贴板在 x 时间内“无法访问”，我可能会陷入无限循环。

继续：

```
http://stackoverflow.com/questions/14492472/cannot-gain-control-over-clipboard-even-with-controlling-logic 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:36:06.640

其他一些程序打开了剪贴板，您正在使用的代码会引发异常来指示这一点。

所以，一开始，如果你等待太久，你似乎不得不忙着等待并放弃。但是，有一种可能的解决方法，将您的程序设置为剪贴板的所有者，并在您失去它时重新获得所有权（因为剪贴板的所有者在失去所有权时会收到通知）。

阅读此处的线程以获得可能的解决方案：http: [//www.coderanch.com/t/377833/java/java/listen-clipboard](http://www.coderanch.com/t/377833/java/java/listen-clipboard)

# asp.net-mvc - 开发网站时的缩放约定

> ID：14489741
> 
> 赞同：0
> 
> 时间：2013-01-23T21:30:01.790
> 
> 标签：asp.net-mvc, zooming

请问在开发网站时是否有缩放约定？作为背景

1.  建议似乎是开发一个基于浏览器设置为 100% 的网站
2.  如果我这样做，那么在具有全屏文本的响应式网站上，它太大而太少适合。我可以在 CSS 设置 Zoom: 70% 内得到我想要的
3.  问题是，有约定吗？当我去一些网站时，它似乎默认将浏览器缩放调整为 90%。我在 ASP.NET MVC 4 中进行编码，有没有办法让浏览器缩放在他们进入我的网站时调整为 90%，好像这似乎是最好的解决方案，我为此优化了网站。

任何有关约定以及如何开发网站以获得最佳缩放级别的建议将不胜感激

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:40:20.313

这正是“响应式设计”旨在解决的问题。不再考虑固定像素，而是考虑百分比和 em。

您的网站应该适应用户的任何分辨率。

[响应式网页设计](http://en.wikipedia.org/wiki/Responsive_web_design)

# c# - 从文件中读取文本，然后存储和比较它们

> ID：14489743
> 
> 赞同：0
> 
> 时间：2013-01-23T21:30:10.690
> 
> 标签：c#, list, text-files, storage

我正在尝试在 C# 中创建一个程序，该程序从文本文件中读取文本行并将它们存储在列表中。然后我必须将每一行与另一个同样大（50 行）的文本文件进行比较，并将差异显示在屏幕上？有人可以帮忙吗？将不胜感激。到目前为止，我只能读取文件。

```
 TextReader tr = new StreamReader("file1.txt");
        for (var i = 0; i < 1; i++)
        {
            tr.ReadLine();
        }
    TextReader tra = new StreamReader("file2.txt");
        for (var f = 0; f < 1; f++)
        {
            tra.ReadLine();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:49:58.067

> *只有一个字符（一个文件中的测验答案，另一个文件中的答案键*

```
var count = File.ReadLines("file1.txt")
                 .Zip(File.ReadLines("file2.txt"), (f1, f2) => f1 == f2)
                 .Count(b => b); 
```

**输入：file1.txt**

```
a
a
c
d 
```

**输入：file2.txt**

```
a
a
b
d 
```

**输出：**

3

* * *

**编辑@AlexeiLevenkov**

```
var two = new[] { true, false }.Count();
var one = new[] { true, false }.Count(b => b); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T16:38:47.580

```
List<string> testlist1 = new List<string>();
List<string> testlist2 = new List<string>();
//populate Lists
for (int i = 0; i < testlist1.Count; i++)
{
     if (testlist2[i] == testlist1[i])
          //do something
     else
         //do something else
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:59:20.190

您可以创建简单的类来保存必要的数据。在这个类中，我们存储每个文件中的行并`Color`指示是否相等。

```
public class LineComparer
{
        public string Line1 { get; set; }
        public string Line2 { get; set; }
        public Brush Color { get; set; }
} 
```

在下一步中，您必须使用文件中的数据填充列表：

```
public List<LineComparer> _comparer = new List<LineComparer>();

public void ReadFiles()
{
    TextReader tr1 = new StreamReader("file1.txt");
    TextReader tr2 = new StreamReader("file2.txt");

    string line1, line2 = null;

    while ((line1 = tr1.ReadLine()) != null)
    {
        _comparer.Add(new LineComparer{ Line1 = line1 });
    }

    int index = 0;

    while ((line2 = tr2.ReadLine()) != null)
    {
        if(index < _comparer.Count)
            _comparer[index].Line2 = line2;
        else
            _comparer.Add(new LineComparer{ Line2 = line2 });
        index++;
    }

    tr1.Close();
    tr2.Close();

    _comparer.ForEach(x => { if(x.Line1 != x.Line2) x.Color = new SolidColorBrush(Colors.Red); else x.Color = new SolidColorBrush(Colors.Green); });
} 
```

要显示文件差异，您可以`ListBox`使用`ItemTemplate`：

```
<ListBox ItemsSource="{Binding}"
         Grid.IsSharedSizeScope="True"
         >
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid Background="{Binding Color}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" SharedSizeGroup="A" />
                    <ColumnDefinition Width="10" />
                    <ColumnDefinition Width="*" SharedSizeGroup="B" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="{Binding Line1}" 
                           TextWrapping="Wrap" />

                <TextBlock Text="{Binding Line2}" 
                           TextWrapping="Wrap"
                           Grid.Column="2"
                           />
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

例子：

“file1.txt”：

```
First
Second
Third
Fourth
Fifth
Sixth
Seventh 
```

“文件2.txt”：

```
First
second
Third
Fourth
Fifth 
```

结果是：

![在此处输入图像描述](../Images/ca8bd33e7de6fd5a081a761974f73878.png)

[这](http://sdrv.ms/WQoSGW)是示例解决方案（FileComparer.zip）。

# android - 具有多个片段的单个 Activity，典型场景。努力实现期望的行为

> ID：14489746
> 
> 赞同：3
> 
> 时间：2013-01-23T21:30:31.017
> 
> 标签：android, android-fragments

我有一个应用程序在给定时间运行具有多个 (2) 片段的单个活动。我在左侧有一个片段，它用作在右侧显示哪个片段的菜单。

例如，菜单由不同的运动组成；足球、篮球、棒球、滑雪等。当用户选择一项运动时，右侧会显示一个包含特定运动详细信息的片段。

我已经将我的应用程序设置为在 layout-large 和 layout-small-landscape 中一次显示两个片段。然而，在 layout-small-portrait 中，在给定时间只显示一个片段。

想象一下；用户正在 layout-small-landscape 中浏览应用程序（一次两个片段）并选择一项运动，Football。在他选择篮球后不久。如果他现在选择旋转到 layout-small-portrait （一次一个片段），我希望发生以下情况：

篮球片段应该是可见的，但是如果他按下后退按钮，他应该返回菜单而不是足球片段（！），默认情况下是返回堆栈中的前一个片段。

我目前已经解决了这个问题，如下所示：

```
....

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // static fragments
    if(menuFragment == null) menuFragment = new MenuFragment();
    if(baseFragment == null) baseFragment = new TimerFragment(); // default content fragment

    FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);

    // Determine what layout we're in..
    if(app().getLayoutBehavior(this) == LayoutBehavior.SINGLE_FRAGMENT) {
    // We are currently in single fragment mode

        if(savedInstanceState != null) {

            if(!rotateFromSingleToDual) {
                // We just changed orientation from dual fragments to single fragment!

                // Clear the entire fragment back stack
                for(int i=0;i<getSupportFragmentManager().getBackStackEntryCount();i++) {
                    getSupportFragmentManager().popBackStack();
                }

                ft.replace(R.id.fragmentOne, menuFragment); // Add menu fragment at the bottom of the stack
                ft.replace(R.id.fragmentOne, baseFragment);
                ft.addToBackStack(null);
                ft.commit();
            }

            rotateFromSingleToDual = true;
            return;
        }

        rotateFromSingleToDual = true;

        ft.replace(R.id.fragmentOne, menuFragment);
    } else if(app().getLayoutBehavior(this) == LayoutBehavior.DUAL_FRAGMENTS) {
    // We are now in dual fragments mode

        if(savedInstanceState != null) {

            if(rotateFromSingleToDual) {
                // We just changed orientation from single fragment to dual fragments!
                ft.replace(R.id.fragmentOne, menuFragment);
                ft.replace(R.id.fragmentTwo, baseFragment);
                ft.commit();
            }

            rotateFromSingleToDual = false;
            return;
        }

        rotateFromSingleToDual = false;

        ft.replace(R.id.fragmentOne, menuFragment);
        ft.replace(R.id.fragmentTwo, baseFragment);
    }

    ft.commit();
} 
```

这是有效的，至少有时是这样。但是，很多时候我得到 java.lang.IllegalStateException: Fragment already added: MenuFragment (....)

谁能给我一些关于如何更好地实现这一点的指示？我当前的代码一点也不漂亮，我相信很多开发人员都想实现这一点。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:26:39.050

实现此场景的常用方法是仅在显示多个片段的模式下使用片段堆栈。当您处于单片段模式时，您将启动一个新活动，该活动的唯一工作是显示单个片段并利用活动回栈。

在您的情况下，您只需要记住当前选择的旋转点，以便在开始新活动时将其设置为参数。

在这里解释得更好：-

[http://developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

希望有帮助。

# mysql - MySQL IN() 子句多次返回

> ID：14489752
> 
> 赞同：0
> 
> 时间：2013-01-23T21:30:45.387
> 
> 标签：mysql

我有一个特殊的数据环境，我需要以某种方式返回数据来填充表。

这是我当前的查询：

```
SELECT 
  bs_id, 
  IF(bs_board = 0, 'All Boards', (SELECT b_name FROM certboards WHERE b_id IN (REPLACE(bs_board, ';', ',')))) AS board 
FROM boardsubs 
```

如您所见，我有一个`if`声明，然后是一个特殊的子选择。

我有这个的原因是该字段`bs_board`是一个`varchar`包含多个行ID的字段，如下所示：

```
1;2;6;17 
```

所以，像它这样的查询工作正常，但它只返回第一个匹配的`b_name`。我需要它来返回所有匹配项。例如，`1;2`它应该返回两个板`Board 1`并`Board 2`在同一列中。稍后我可以处理`<br>`在每个结果之间添加一个。

但是我正在处理的问题是它必须在单个列中返回名称或所有名称，因为该字段可以包含与选择的原始编辑器一样多的名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:37:05.873

将`b_id IN (REPLACE(bs_board, ';', ','))`导致`b_id IN ('1,2,6,7')`哪个与`b_id IN (1,2,6,7)`您正在寻找的不同。

要使其工作，要么在执行查询之前解析字符串，要么使用准备好的语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:01:14.797

这不会像您认为的那样起作用。

假设`bs_board`是`'1;2;3'`

在您的查询中，`REPLACE(bs_board, ';', ',')`将解析为`'1,2,3'`，这是一个单一的文字字符串。这使您的最终子查询：

```
SELECT b_name FROM certboards WHERE b_id IN ('1,2,3') 
```

这相当于：

```
SELECT b_name FROM certboards WHERE b_id = '1,2,3' 
```

该问题最正确的解决方案是[规范化您的数据库](http://en.wikipedia.org/wiki/Database_normalization#Non-first_normal_form_.28NF.C2.B2_or_N1NF.29)。您当前的系统或在单个字段中存储多个值正是您不应该使用 RDBMS 做的事情，这正是原因。该数据库并非旨在处理此类字段。您*应该*有一个单独的表格，每个表格都有一行`bs_board`，然后`JOIN`是表格。

这个问题没有好的解决方案。这是一个基本的模式设计缺陷。最简单的解决方法是使用应用程序逻辑来修复它。首先你运行：

```
SELECT bs_id, bs_board FROM boardsubs 
```

从那里您可以解析`bs_board`应用程序逻辑中的字段并构建您想要运行的实际查询：

```
SELECT bs_id, 
  IF(bs_board = 0, 'All Boards', (SELECT b_name FROM certboards WHERE b_id IN (<InsertedStringHere>) AS board 
FROM boardsubs 
```

有其他方法可以解决这个问题，但您会遇到排序顺序、匹配和许多其他问题。最好的解决方案是添加一个表并将这个多值字段移动到该表中。

# jquery - 刷新网页不会在 Firefox 中使用 jQuery 活动重置 HTML 表

> ID：14489754
> 
> 赞同：0
> 
> 时间：2013-01-23T21:30:48.977
> 
> 标签：jquery, html, firefox

对不起，如果这个问题以前被问过。

*   我有一个简单的 HTML 表格，并通过 jQuery 添加了一些隐藏/取消隐藏功能。

*   该表在 Chrome`24.0.1312.52 m`和 IE8+ 中运行良好。

*   但是，当我在 Firefox 中刷新网页时`15.0.1`，之前填写的表格不会被重置。以前有人有过这种经历吗？我需要添加一些东西让 jQuery 重置表单吗？

下面是我的代码和[jsfiddle](http://jsfiddle.net/maniator/qpK7Y/)的链接。感谢您的任何建议！

HTML：

```
<table>
    <tr>
        <th>
            <label for="id_application">Application:</label>
        </th>
        <td>
            <select name="application" id="id_application">
                <option value="">Make a selection</option>
                <option value="a">Aerial</option>
                <option value="b">Ground</option>
                <option value="c">Orchard/Airblast</option>
            </select>
        </td>
    </tr>
    <tr>
        <th>
            <label for="id_boom_height">Boom height:</label>
        </th>
        <td>
            <select name="boom_height" id="id_boom_height">
                <option value="">Make a selection</option>
                <option value="1">Low</option>
                <option value="2">High</option>
            </select>
        </td>
    </tr>
    <tr>
        <th>
            <label for="id_orchard_type">Orchard type:</label>
        </th>
        <td>
            <select name="orchard_type" id="id_orchard_type">
                <option value="">Make a selection</option>
                <option value="1">Vineyard in leaf</option>
                <option value="2">Orchard or dormant vineyard</option>
            </select>
        </td>
    </tr>
</table> 
```

JS

```
 $(document).ready(function () {
        $('#id_boom_height').closest('tr').hide();
        $('#id_orchard_type').closest('tr').hide();

        $('#id_application').change(function () {
            $('#id_boom_height').closest('tr').hide();
            $('#id_orchard_type').closest('tr').hide();
            if ($(this).val() == "b") {
                $('#id_boom_height').closest('tr').show();
                $('#id_orchard_type').closest('tr').hide();
            } else if ($(this).val() == "a") {
                $('#id_boom_height').closest('tr').hide();
                $('#id_orchard_type').closest('tr').hide();
            } else if ($(this).val() == "c") {
                $('#id_boom_height').closest('tr').hide();
                $('#id_orchard_type').closest('tr').show();

            }
        });
    }); 
```

### 更新：

感谢 Hanlet Escaño 的帮助。我在表格中添加了一个重置​​按钮并将其绑定到页面刷新。因此，当我在 Firefox 中刷新页面时，我能够将表格更改为其默认状态。

### 但是，当我单击重置按钮时，只有表单的内容被重置，但它的结构。这是[示例](http://jsfiddle.net/godhong/CFbtH/9/)。如果有人可以帮助我，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:00:32.800

我在相同版本的 Firefox 上尝试过，但没有收到您的错误。但是，我已经稍微修改了您的代码，以便在人们离开页面时重置表单。在您弄清楚出了什么问题之前，这是一种解决方法。

**HTML：**

```
<table>
    <tr>
        <th>
            <label for="id_application">Application:</label>
        </th>
        <td>
            <select name="application" id="id_application">
                <option value="">Make a selection</option>
                <option value="a">Aerial</option>
                <option value="b">Ground</option>
                <option value="c">Orchard/Airblast</option>
            </select>
        </td>
    </tr>
    <tr>
        <th>
            <label for="id_boom_height">Boom height:</label>
        </th>
        <td>
            <select name="boom_height" id="id_boom_height">
                <option value="">Make a selection</option>
                <option value="1">Low</option>
                <option value="2">High</option>
            </select>
        </td>
    </tr>
    <tr>
        <th>
            <label for="id_orchard_type">Orchard type:</label>
        </th>
        <td>
            <select name="orchard_type" id="id_orchard_type">
                <option value="">Make a selection</option>
                <option value="1">Vineyard in leaf</option>
                <option value="2">Orchard or dormant vineyard</option>
            </select>
        </td>
    </tr>
</table>

<button onclick="$('#id_application>option:eq(0)').attr('selected', true);  $('#id_application').change();">Try</button> 
```

**jQuery：**

```
$('#id_boom_height').closest('tr').hide();
        $('#id_orchard_type').closest('tr').hide();

        $('#id_application').change(function () {
            $('#id_boom_height').closest('tr').hide();
            $('#id_orchard_type').closest('tr').hide();
            if ($(this).val() == "b") {
                $('#id_boom_height').closest('tr').show();
                $('#id_orchard_type').closest('tr').hide();
            } else if ($(this).val() == "a") {
                $('#id_boom_height').closest('tr').hide();
                $('#id_orchard_type').closest('tr').hide();
            } else if ($(this).val() == "c") {
                $('#id_boom_height').closest('tr').hide();
                $('#id_orchard_type').closest('tr').show();

            }
        });

$(window).bind('beforeunload',function(){
    $('#id_application>option:eq(0)').attr('selected', true);
    $('#id_application').change();
}); 
```

JSFiddle：http: [//jsfiddle.net/wLnyu/6/](http://jsfiddle.net/wLnyu/6/)

祝你好运！

# jquery - Jquery - 使用 onclick 和 onload 过滤显示结果

> ID：14489756
> 
> 赞同：0
> 
> 时间：2013-01-23T21:31:00.610
> 
> 标签：jquery, jquery-filter

我有几个单选按钮和列表项列表（ul/li）的页面。首次进入页面时，将显示完整列表。检查收音机将缩小列表范围。

我找到了一些 jquery 代码，它运行良好。我想要并且无法找到/做的（除了当前的过滤）是在页面加载时开始过滤（还没有点击），这样如果有任何预定义/预检查的收音机（如下面的第一个收音机）列表将是已过滤的列表 - 不是完整列表。

谢谢你的帮助！这是 jsfiddle 上的链接：http: [//jsfiddle.net/3NdHt/](http://jsfiddle.net/3NdHt/)

```
<div class="tags">
<label><input type="radio" rel="apac" name="geo" checked /> APAC</label>
<label><input type="radio" rel="emea" name="geo" /> EMEA</label>
<label><input type="radio" rel="east" name="geo" /> US East</label>
<label><input type="radio" rel="west" name="geo" /> US West</label>
</div>
<br />

<ul class="results">
<li class="apac">APAC 1</li>
<li class="apac">APAC 1</li>      
<li class="emea">EMEA </li>
<li class="west east">WEST EAST 1</li>  
<li class="west">WEST 2</li>     
<li class="east">EAST</li>      
</ul> 
```

查询：

```
$(document).ready(function() {
$('div.tags').delegate('input[type=radio]', 'change', function() {
  var $lis = $('.results > li'),
  $checked = $('input:checked');
  if ($checked.length) {
    var selector = $checked.map(function (){
        return '.' + $(this).attr('rel');
    }).get().join('');
        $lis.hide().filter(selector).show();  
  } else {
    $lis.show();
}
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:36:51.987

将函数从委托的更改事件中拉出（顺便说一句，您应该使用`.on()`而不是`.delegate()`），然后在文档准备好时调用它。

**[jsFiddle 示例](http://jsfiddle.net/j08691/3NdHt/1/)**

```
$('div.tags').delegate('input[type=radio]', 'change', update);
update(); // THIS CALLS THE FUNCTION ON DOC READY

function update() {
    var $lis = $('.results > li'),
        $checked = $('input:checked');
    if ($checked.length) {
        var selector = $checked.map(function () {
            return '.' + $(this).attr('rel');
        }).get().join('');

        $lis.hide().filter(selector).show();

    } else {
        $lis.show();
    }
} 
```

# linux - 删除文件中模式之间的某些字符的所有出现

> ID：14489758
> 
> 赞同：0
> 
> 时间：2013-01-23T21:31:04.393
> 
> 标签：linux, bash, shell

我有一个文件，其中包含 PHP 代码到 TWIG 的某种错误翻译，我只需要删除括号 () 的第一次和最后一次出现以及包含在 {% 和 %} 标记之间的 $ 的任何出现

例如，如果文件中有：

```
{% if($var.has($something)) %}
This symbols ($($)$) won't be deleted becoase they aren't between {% and %} 
```

我需要将其转换为：

```
{% if var.has( something) %}
This symbols ($($)$) won't be deleted becoase they aren't between {% and %} 
```

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:16:00.710

当涉及语法时，我喜欢`vim`用于该任务。在你的情况下：

vim -c '%g/{%/norm /(^[ma%x`ar ' 文件

解释：-vim -c - 运行命令

*   %g - 每行
*   /{% - 包含模式 {%
*   norm - 进入 vim 正常模式
*   /（ - 去 （
*   ^{ - ESC（按 CTRL+V< 后跟 ESC）
*   ma - 将当前位置标记为“a”
*   % - 去匹配结束）
*   x - 删除它
*   `a - 回到 (
*   r - 将其替换为空格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T22:00:12.887

你需要它有多准确？如果您在一行中没有多个 {% %} {% %} （或者如果可以`s/%}/&\n/g`防止这种情况发生），则可以使用丑陋的可怕

```
sed -e ':s; s/{%\(.*\)\$\(.*\)%}/{%\1\2%}/; ts; s/{%\([^(]*\)(\(.*\))\(.*\)%}/{%\1 \2 \3%}/' 
```

它删除所有`$`s 内部`{% %}`，然后删除最外面的括号（如果有）。

# vb.net - 在 Quartz.Net 中运行作业

> ID：14489763
> 
> 赞同：1
> 
> 时间：2013-01-23T21:31:10.500
> 
> 标签：vb.net, quartz.net

我了解到您将 Quartz 解决方案编译成可以作为 Windows 服务运行的 exe。而且这个 Quartz 服务器以某种方式运行作业。我没有得到的是，我将所有实际工作的工作代码放在哪里？就像假设我希望我的“工作”调用一个存储过程，或者每小时调用一个 Web 服务。或者如果我有想要执行的本地 VB 代码怎么办？（而且我不想创建另一个从命令行调用的独立 VB 应用程序。）所有这些类型的作业配置将在哪里存储、编码和配置并不明显。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T10:27:00.957

我建议你先阅读教程。[您可以在 Jay Vilalta 的博客](http://jvilalta.blogspot.co.uk/)
上找到很多有用的信息。

[Quartz.Net 入门：第 1 部分](http://jvilalta.blogspot.co.uk/2009/03/getting-started-with-quartznet-part-1.html)
[Quartz.Net 入门：第 2 部分](http://jvilalta.blogspot.co.uk/2009/03/getting-started-with-quartznet-part-2.html)
[Quartz.Net 入门：第 3 部分](http://jvilalta.blogspot.co.uk/2009/04/getting-started-with-quartznet-part-3.html)

和

[在 Quartz.Net 1.0 中以编程方式调度作业](http://jvilalta.blogspot.co.uk/2011/03/scheduling-jobs-programmatically-in.html)

或者

[在 Quartz.Net 2.0 中以编程方式调度作业](http://jvilalta.blogspot.co.uk/2011/03/scheduling-jobs-programmatically-in_09.html)

然后您可以查看[github 代码](https://github.com/quartznet/quartznet)并尝试使用文档非常齐全的[示例。](https://github.com/quartznet/quartznet/tree/master/src/Quartz.Examples)

**更新**：

服务器是调度程序。
它是一个 Windows 服务应用程序，它不断运行并运行您使用客户端应用程序安排的作业。
您甚至可以像我一样编写自己的服务器（Windows 服务），因为我不想使用远程处理与该层通信。

您可以决定使用几行代码在控制台应用程序中安排和运行作业（我不建议这样做）：

```
class Program
{
    public static StdSchedulerFactory SchedulerFactory;
    public static IScheduler Scheduler;

    static void Main(string[] args)
    {
        SchedulerFactory = new StdSchedulerFactory();
        Scheduler = SchedulerFactory.GetScheduler();

        var simpleTrigger = TriggerBuilder.Create()
                 .WithIdentity("Trigger1", "GenericGroup")
                 .StartNow()
                 .WithSimpleSchedule(x => x.RepeatForever().WithIntervalInSeconds(5))
                 .Build();

        var simpleJob = JobBuilder.Create<SimpleJob>()
                                     .WithIdentity("simpleJob", "GenericGroup")
                                     .Build();

        Scheduler.ScheduleJob(simpleJob, simpleTrigger);

        Console.WriteLine("Scheduler started");

        Scheduler.Start();

        Console.WriteLine("Running jobs ...");

        Console.ReadLine();

        Scheduler.Shutdown(waitForJobsToComplete: false);

        Console.WriteLine("Shutdown scheduler!");

    }
} 
```

这是工作：

```
public class SimpleJob : IJob
{
    public virtual void Execute(IJobExecutionContext context)
    {
        JobKey jobKey = context.JobDetail.Key;
        Console.WriteLine("{0} Executing job {1} ", DateTime.Now.ToString(), jobKey.Name);
    }
} 
```

[你可以在这里](https://skydrive.live.com/embed?cid=669ADF1AF64DF389&resid=669ADF1AF64DF389!237&authkey=AODX-S72dTewRyI)下载一个测试项目（**VerySimpleQuartzApp**）。

**上面的应用程序不存储触发器/作业信息。**

您可以决定是否要将作业/触发器的信息保存在 XML 文件中，如此[处](http://damjank.blogspot.co.uk/2012/06/quartznet-task-scheduling.html)和[此处](http://jayvilalta.com/blog/2012/11/09/scheduling-a-quartz-net-job-using-xml/)所述。 或者，您可以将作业/触发器存储在[数据库](http://www.quartz-scheduler.net/tutorial/lesson_9.html)中，以便调度程序（通常是 Windows 服务）可以读取这些信息并运行作业。

如果您正在寻找一个可以与服务器通信（通过远程处理）并安排作业并运行它的示例，那么就是[这样](https://github.com/quartznet/quartznet/blob/master/src/Quartz.Examples/example12/RemoteClientExample.cs)。

有一些开源项目（管理器）可用于启动/停止或安排作业。[在这里](https://stackoverflow.com/a/12491747/219406)阅读我的答案。

# javascript - 未捕获的类型错误：无法读取未定义的属性“顶部”

> ID：14489768
> 
> 赞同：3
> 
> 时间：2013-01-23T21:31:35.183
> 
> 标签：javascript, jquery

我有一些这样的 jQuery 代码

```
$(document).ready(function(){
    $('.content-nav a').on('click',function(){
      var str = $(this).attr("href");   
      var the_id = str.substr(1);
        $("#container").animate({ scrollTop: $(the_id).offset().top }, 1000);
    });
}); 
```

当我单击链接时，我收到错误消息`Uncaught TypeError: Cannot read property 'top' of undefined`

有人可以告诉我有什么问题吗？

我正在使用从 google api 加载的 jQuery 1.8.3。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T21:32:34.527

如果`the_id`是一个id，那么你需要

```
$('#'+the_id).offset().top 
```

# php - 在 PHP 中解析数组

> ID：14489770
> 
> 赞同：0
> 
> 时间：2013-01-23T21:31:57.097
> 
> 标签：php

> **可能重复：**
> [使用 PHP 解析 JSON 文件](https://stackoverflow.com/questions/4343596/parsing-json-file-with-php)

任何人都可以提出一种优雅的方法来使用 php 将下面形式的数组更改为仅包含主键的数组吗？

```
[{
    "PrimaryKey": "489",
    "name": "Ted"
}, {
    "PrimaryKey": "488",
    "name": "Bill"
}, {
    "PrimaryKey": "487",
    "singleFbId": "Joe"
}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:35:28.177

```
<?php
$data = '[{
    "PrimaryKey": "489",
    "name": "Ted"
}, {
    "PrimaryKey": "488",
    "name": "Bill"
}, {
    "PrimaryKey": "487",
    "singleFbId": "Joe"
}]';

$array = json_decode($data, TRUE);

print_r($array); 
```

# objective-c - Speex 编码/解码导致嘶嘶声（Objective-c）

> ID：14489779
> 
> 赞同：3
> 
> 时间：2013-01-23T21:32:21.640
> 
> 标签：objective-c, encoding, decoding, audiotoolbox, speex

当我绕过 speex 编码/解码步骤时，原始音频输出是正确的。我想要的是对从我的录制回调中捕获的整个缓冲区进行编码、解码并发送回播放循环。我不确定的几项是：

1.  为 enc_buffer 和 dec_buffer 分配什么大小
2.  在 speex_bits_read_from(SpeexBits* bits,char* bytes,int len) 中指定什么长度
3.  在 int speex_bits_write(SpeexBits* bits,char* bytes,int max_len) 中指定的最大大小

这是我的 speex 编解码器初始化：

```
#define SAMPLE_RATE 8000
#define MAX_FRAMES 100
#define FRAME_SIZE 160

enc_state = speex_encoder_init(&speex_nb_mode);
dec_state = speex_decoder_init(&speex_nb_mode);

spx_int32_t tmp;
tmp=5;
speex_encoder_ctl(enc_state, SPEEX_SET_QUALITY, &tmp);
tmp=1;
speex_encoder_ctl(enc_state, SPEEX_SET_COMPLEXITY, &tmp);

speex_encoder_ctl(enc_state, SPEEX_GET_FRAME_SIZE, &enc_frame_size );
speex_decoder_ctl(dec_state, SPEEX_GET_FRAME_SIZE, &dec_frame_size );

tmp = SAMPLE_RATE;

speex_encoder_ctl(enc_state, SPEEX_SET_SAMPLING_RATE, &tmp);
speex_decoder_ctl(dec_state, SPEEX_SET_SAMPLING_RATE, &tmp);

speex_bits_init(&enc_bits);
speex_bits_init(&dec_bits);

//Unsure of this allocation size
enc_buffer = (char*)malloc(sizeof(char)*enc_frame_size*MAX_FRAMES);
dec_buffer = (spx_int16_t*)malloc(sizeof(spx_int16_t)*dec_frame_size*MAX_FRAMES); 
```

我的编码/解码方法：

```
-(char*)encodeAudioBuffer:(spx_int16_t*)audioBuffer withByteSize:(int)numberOfFrames andWriteSizeTo:(int*)inSize{
    speex_bits_reset(&enc_bits);
    speex_encode_int(enc_state, audioBuffer, &enc_bits);

    //Unsure of this third argument. 'numberOfFrames' is the stored number of input frames from my recording callback.
    *inSize = speex_bits_write(&enc_bits, enc_buffer, numberOfFrames*enc_frame_size);

    return enc_buffer;
}
-(spx_int16_t*)decodeSpeexBits:(char*)encodedAudio  withEncodedSize:(int)encodedSize andDecodedSize:(int)decodedSize{

    //Unsure of this third argument.  'encodedSize' is the number written to *inSize in the encode method
    speex_bits_read_from(&dec_bits, encodedAudio, encodedSize*dec_frame_size);

    speex_decode_int(dec_state, &dec_bits, dec_buffer);
    return dec_buffer;
} 
```

他们是这样称呼的：

```
- (void)encodeBufferList:(AudioBufferList*)bufferList withNumberOfFrames:(int)numberOfFrames{
    AudioBuffer sourceBuffer = bufferList->mBuffers[0];
    int speexSize = 0;
    char* encodedAudio = [speexCodec encodeAudioBuffer:(spx_int16_t*)sourceBuffer.mData withByteSize:numberOfFrames andWriteSizeTo:&speexSize];
    spx_int16_t* decodedAudio = [speexCodec decodeSpeexBits:encodedAudio withEncodedSize:speexSize andDecodedSize:sourceBuffer.mDataByteSize];
    memcpy(audioBuffer.mData, sourceBuffer.mData, numberOfFrames * sizeof(SInt32));
} 
```

其中“bufferList”是从我的录制/播放回调返回的。有人可以验证我正在正确填充缓冲区吗？[我在这里](https://stackoverflow.com/questions/12621500/speex-in-ios-really-poor-quality-and-robotic-sound)看到了一个类似的问题，但看不到我的代码中哪里可能做错了：

```
static OSStatus recordingCallback(void *inRefCon, AudioUnitRenderActionFlags *ioActionFlags, const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, UInt32 inNumberFrames, AudioBufferList *ioData)
{
    AudioBuffer buffer;
    OSStatus status;
    AudioStreamer *input = (__bridge AudioStreamer*) inRefCon;

    buffer.mDataByteSize = inNumberFrames * sizeof(SInt16);
    buffer.mNumberChannels = 1;
    buffer.mData = malloc( inNumberFrames * sizeof(SInt16));

    AudioBufferList bufferList;
    bufferList.mNumberBuffers = 1;
    bufferList.mBuffers[0] = buffer;

    status = AudioUnitRender([input rioAUInstance], ioActionFlags, inTimeStamp, inBusNumber, inNumberFrames, &bufferList);
    [input encodeBufferList:&bufferList withNumberOfFrames:inNumberFrames];
    return noErr;
}

static OSStatus playbackCallback(void *inRefCon, AudioUnitRenderActionFlags *ioActionFlags, const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, UInt32 inNumberFrames, AudioBufferList *ioData)
{
    AudioStreamer* input = (__bridge AudioStreamer*)inRefCon;
    UInt32 size = MIN(ioData->mBuffers[0].mDataByteSize, [input audioBuffer].mDataByteSize);
    memcpy(ioData->mBuffers[0].mData, input.audioBuffer.mData, size);
    return noErr;
} 
```

编码/解码产生的噪音是颗粒状的静态嘶嘶声，但它不是完全随机的信息——当我对着麦克风吹气时，我可以在噪音后面听到它。

任何帮助解决这个问题将不胜感激。一旦我把所有事情都整理好，我可能最终会写博客，似乎很多人在设置这个编解码器时遇到了各种琐碎的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:57:21.420

所以这是编码/解码函数中的一个问题，我需要跨多个帧调用 speex_encode_int，因为它似乎一次只处理 1 帧，然后将它们写入编码缓冲区，如下所示：

```
-(char*)encodeAudioBuffer:(spx_int16_t*)audioBuffer withNumberOfFrames:(int)numberOfFrames andWriteSizeTo:(int*)inSize{
    speex_bits_reset(&enc_bits);
    for(int i = 0; i < numberOfFrames; ++i){
        speex_encode_int(enc_state, audioBuffer+i, &enc_bits);
    }
    *inSize = speex_bits_write(&enc_bits, enc_buffer, numberOfFrames);
    return enc_buffer;
} 
```

与解码类似，speex_bits_read_from 编码缓冲区，然后遍历每一帧的 dec_bits，写入解码缓冲区

```
-(spx_int16_t*)decodeSpeexBits:(char*)encodedAudio  withEncodedSize:(int)encodedSize andNumberOfFrames:(int)numberOfFrames{
    speex_bits_read_from(&dec_bits, encodedAudio, encodedSize);
    for(int i = 0; i < numberOfFrames; ++i){
        speex_decode_int(dec_state, &dec_bits, dec_buffer+i);
    }
    return dec_buffer;
} 
```

**这对我来说仍然运行得很慢**。即使将 speex 库配置为使用定点计算而不是浮点计算，它的运行速度仍然比我的音频循环慢（导致一种新的断断续续）。关于如何让这个运行更快的任何线索？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:28:42.703

在您的两个循环中，您都在传递音频缓冲区，但没有考虑帧大小：

```
for(int i = 0; i < numberOfFrames; ++i){
    speex_encode_int(enc_state, audioBuffer+i, &enc_bits);
} 
```

它应该是：

```
for(int i = 0; i < numberOfFrames; ++i){
    speex_encode_int(enc_state, audioBuffer + (i * enc_frame_size), &enc_bits);
} 
```

希望有帮助。

# json - Dojo 1.8 JsonRest 和 DataGrid

> ID：14489783
> 
> 赞同：0
> 
> 时间：2013-01-23T21:32:40.557
> 
> 标签：json, rest, dojo

我正在尝试在 Dojo 1.8 中获得 JsonRest 功能。工作加载DataGrid。我已经让 Dojo 客户端成功地与 REST 服务器通信。我拨打电话，我的 DataGrid 标题已填充，但未填充任何数据。来自 REST 调用的响应是……

{"data":{"fundId":"12345","fundDescription":"高风险股票基金","bidPrice":26.8,"offerPrice":27.4,"lastUpdated":"2013-01-23T14:13: 45"}}

我的 Dojo 代码是...

```
 require([
            "dojo/store/JsonRest",
            "dojo/store/Memory",
            "dojo/store/Cache",
            "dojox/grid/DataGrid",
            "dojo/data/ObjectStore",
            "dojo/query",
            "dojo/domReady!" 
        ], function(JsonRest, Memory, Cache, DataGrid, ObjectStore, query) {

            var restStore, memoryStore, myStore, dataStore, grid;

            restStore =  JsonRest({target:"http://localhost:8080/funds/12345"});
            memoryStore = new Memory();
            myStore = Cache(restStore, memoryStore);

            grid = new DataGrid({
                store: dataStore = new ObjectStore({objectStore: myStore}),

        structure: [
            {name:"Fund Id", field:"fundId", width: "200px"},
            {name:"Description", field:"fundDescription", width: "200px"},
            {name:"Bid Price", field:"bidPrice", width: "100px"},
            {name:"Offer Price", field:"offerPrice", width: "100px"},
            {name:"Last Updated", field:"lastUpdated", width: "200px"}
        ]
            }, "target-node-id"); // make sure you have a target HTML element with this id

            grid.startup();

            query("#save").onclick(function(){
                dataStore.save();
            });
        }); 
```

为了将数据成功加载到网格中，我缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T06:50:35.590

我想这可能是由于您的`REST`-Response's `data`is not an `array`but an `object`. 它实际上应该是这样的：

```
 [{
        "fundId": "12345",
        "fundDescription": "High Risk Equity Fund",
        "bidPrice": 26.8,
        "offerPrice": 27.4,
        "lastUpdated": "2013-01-23T14:13:45"
    }] 
```

`ObjectStore`期望`array`一个. 由于我通常不会按照您的方式进行操作，因此我不太确定您必须更改什么。但是你必须确保`JSON`-Response 无论如何都会给你一个`array`。`ObjectStore`也许你必须稍后提交它：

```
grid = new DataGrid({
    // getting data, after making sure its an array ;)
    store: dataStore = new ObjectStore({objectStore: myStore.get(0)}),
    ... 
```

我不知道您是否出于某些原因必须这样做，但是对于您的示例，据我所知，在[此示例](http://dojotoolkit.org/documentation/tutorials/1.8/store_driven_grid/)中的完成方式应该适合您的需要...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T20:33:50.300

我有一个类似的问题，我的数据来自 CXF Web 服务，看起来像：

{"Customer":[{"id":1,"name":"John-1"},{"id":2," name":"John-2"}]}

我在这里找到了答案：http: [//dojotoolkit.org/documentation/tutorials/1.8/populating_datagrid/](http://dojotoolkit.org/documentation/tutorials/1.8/populating_datagrid/)而我必须手动从商店中获取我的数据。

```
....
restStore.query("", {}).then(function(data){    
    dataStore = new ObjectStore({objectStore: new Memory({ data: data['Customer'] })}),

    grid = new DataGrid({
        store: dataStore,
        items:data.items,
        structure: [
            {name:"Customer ID", field:"id", width: "200px"},
            {name:"Customer Name", field:"name", width: "200px"}
        ]
    }, "target-node-id"); // make sure you have a target HTML element with this id
    grid.startup();
}
... 
```

我希望这有帮助。
这是我第一次发帖，所以如果事情有点搞砸，我会很糟糕。

# mdx - 使用 A 列和 B 列计算比率 - 在 Powerpivot/MDX/DAX 中，而不是在 SQL 中

> ID：14489789
> 
> 赞同：1
> 
> 时间：2013-01-23T21:33:02.553
> 
> 标签：mdx, pivot-table, powerpivot, dax

我有一个查询来拉动漏斗的点击率，如果用户点击一个页面，它记录为“1”，否则为 NULL -

```
SELECT datestamp
    ,COUNT(visits) as Visits
    ,count([QE001]) as firstcount 
    ,count([QE002]) as secondcount
    ,count([QE004]) as thirdcount
    ,count([QE006]) as finalcount
    ,user_type
    ,user_loc
FROM
    dbname.dbo.loggingtable
GROUP BY user_type, user_loc 
```

我想为每个比率设置一列，例如 firstcount/Visits、secondcount/firstcount 等以及总数（finalcount/Visits）。

我知道这可以做到

*   通过添加“计算字段”在 Excel 数据透视表中
*   在 SQL 中通过分组
*   在 PowerPivot 中通过添加计算列，例如

    ```
    =IFERROR(QueryName[finalcount]/QueryName[Visits],0) 
    ```

*   但我需要给报告消费者一个选项，只用 user_type 或只用 user_loc 等进行切片，excel 会倾向于添加比例，这不起作用 b/c

    ```
    SUM(A/B) != SUM(A)/SUM(B) 
    ```

**在 DAX/MDX/PowerPivot 中是否有一种方法可以添加计算列/度量，以便*对于任何用户定义的数据子集*（日期范围、用户类型、位置等）？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T13:53:24.570

是的，通过计算的措施。计算列用于创建您希望在行/列/报告标题上看到的值...计算度量用于创建您希望在数据透视表的值部分中看到的值，并且可以按列中的列进行切片/切块模型。

最简单的方法是在 powerpivot 表的计算区域中创建 3 个计算的“度量”。

```
TotalVisits:=SUM(QueryName[visits])
TotalFinalCount:=SUM(QueryName[finalcount])
TotalFinalCount2VisitsRatio:=[TotalFinalCount]/[TotalVisits] 
```

然后，您可以按 user_type 或仅 user_loc（或其他）对计算的度量 [TotalFinalCount2VisitsRatio] 进行切片，并且将正确计算该值。这里的区别是您明确告诉 xVelocity 引擎 SUM-then-DIVIDE。如果您创建计算列，那么引擎会认为您要先除后求和。

此外，您不必将度量分解为 3 个单独的度量……这只是一个好习惯。如果您有兴趣了解更多信息，我会推荐[这本书](https://rads.stackoverflow.com/amzn/click/com/1615470158)……作者是 PowerPivot/DAX 大师，这本书非常简单明了。

# version-control - 确定谁签出了哪些文件

> ID：14489791
> 
> 赞同：1
> 
> 时间：2013-01-23T21:33:28.060
> 
> 标签：version-control, vcs-checkout

在**TFS 2010**中，如何确定哪个**用户***签出了*哪些**文件** ？

 *这个问题不包括逐个查看每个文件夹。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T23:29:55.373

安装[TFS 2010 电动工具](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)，然后在源代码管理资源管理器中右键单击任何文件夹并选择“在源代码管理中查找”。您现在可以搜索所有签出的文件，并按用户 ID 过滤

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:51:36.363

```
tf status /login:UserName 
```

此[状态命令](http://msdn.microsoft.com/en-us/library/9s5ae285.aspx)和许多其他有用的提示可以在[How to force undo checkout?中找到。#TFS](http://fci-h.blogspot.com/2011/01/how-to-force-undo-checkout-tfs.html)。*

# c# - 如何编写自定义 POCO 序列化器/反序列化器？

> ID：14489799
> 
> 赞同：6
> 
> 时间：2013-01-23T21:33:56.940
> 
> 标签：c#, .net, serialization, poco

我想为 FIX 消息（不像 XML）编写一个自定义的 .NET 序列化器/反序列化器。基本上消息被编码为`<tag>=<value>;<tag>=<value>;...`

所以一个样本可能是：

```
51=2;20=hello;31=2 
```

我想使用类似于我使用 XMLSerializer 类能够序列化/反序列化消息的方式的 FIX Serializer 类。我想我会写一个 FIX 消息类，如：

```
[Serializable]
public class FixMessage
{ 
     [FIXValuePair(51)]
     public double Price { get; set; }

     [FIXValuePair(20)]
     public string SomethingElse { get; set; }
} 
```

关于如何编写这样的序列化器/反序列化器的任何指示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T21:36:24.467

使用反射，您可以遍历正在序列化的对象的属性，然后可以检查每个属性的属性（再次使用反射）。最后，您将输出发送到流中。

您的代码可能看起来像这样（简化）：

```
public string Serialize(object o)
{
    string result = ""; // TODO: use string builder

    Type type = o.GeyType();

    foreach (var pi in type.GetProperties())
    {
        string name = pi.Name;
        string value = pi.GetValue(o, null).ToString();

        object[] attrs = pi.GetCustomAttributes(true);
        foreach (var attr in attrs)
        {
           var vp = attr as FIXValuePairAttribute;
           if (vp != null) name = vp.Name;
        }

        result += name + "=" + value + ";";
    }

    return result;
} 
```

# python - Python，我想为一组文件替换部分文件名

> ID：14489801
> 
> 赞同：2
> 
> 时间：2013-01-23T21:34:07.890
> 
> 标签：python, file, rename

我想编写一个程序，询问您要替换什么以及用什么替换它。

我有一大组具有不同扩展名的文件，我想替换部分文件名，但我要替换的所有部分都是相同的。我想对文件夹中的每个文件都这样做

所以我有类似的文件

```
ABC.txt
gjdABCkg.txt
ABCfg.jpg
ffABCff.exe 
```

我只想用我想要的任何 3 个字母替换 ABC 我正在使用 python 3.2

我正在四处寻找是否可以让它工作，但我所做的没有任何工作，所以这就是我到目前为止所拥有的。

```
import os  

directory = input ("Enter your directory")
old = input ("Enter what you want to replace ")
new = input ("Enter what you want to replace it with") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:41:20.123

您可能需要添加一些东西，但这是基本思想：

```
import os

def rename(path,old,new):
    for f in os.listdir(path):
        os.rename(os.path.join(path, f), 
                  os.path.join(path, f.replace(old, new))) 
```

编辑：正如评论中提到的*@JF Sebastian*，您可以使用 Python 3.3 中的相对路径（至少在 Linux 机器上）。

从[文档](http://docs.python.org/dev/library/os.html#os.replace)：

`os.replace(src, dst, *, src_dir_fd=None, dst_dir_fd=None)`可以支持指定`src_dir_fd`和/或`dst_dir_fd`提供[相对于目录描述符的路径](http://docs.python.org/dev/library/os.html#dir-fd)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T21:41:23.183

```
import os

def rename(path,oldstr,newstr):
    for files in os.listdir(path):
        os.rename(os.path.join(path, files), os.path.join(path, files.replace(oldstr, newstr))) 
```

使用它可以轻松完成您的工作

# c# - 访问 CheckBox 作为 DataGridViewCheckBoxCell 中的控件

> ID：14489806
> 
> 赞同：-3
> 
> 时间：2013-01-23T21:34:24.863
> 
> 标签：c#, winforms, datagridview

我可以访问作为DataGridViewCheckBoxCell 中的**控件的 CheckBox 吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:12:07.757

简单地说：不。因为`DatagridviewCheckBoxColumn`不是继承自`Control`，而是继承自`DataGridViewElement`父类（不是继承自`Control`任何一个！）。

来源：[DatagridviewCheckBoxColumn](http://msdn.microsoft.com/de-de/library/system.windows.forms.datagridviewcheckboxcolumn%28v=vs.80%29.aspx)

# windows - Windows：打印简单矢量图形 - 示例？

> ID：14489809
> 
> 赞同：2
> 
> 时间：2013-01-23T21:34:39.327
> 
> 标签：windows, winapi, printing, vector-graphics, polygons

我想使用 Windows API 打印一些矢量图形（或者更准确地说：只不过是一些折线）。打印必须在自己的线程中完成。

当我向 Google/MSDN 询问一些代码片段或示例时，我主要找到如何使用一些 WindowsForms/.NET 废话进行打印的文档，但没有 WinAPI 示例。或者我发现 MS 提供的一个非常*大*的 XPS 打印示例非常令人困惑，并且不仅仅是向打印机发送一些数据。

所以我的问题是：是否有一个简单的例子来演示如何打印出一些愚蠢的行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T10:50:56.437

如果你想使用传统的 GDI 函数来做到这一点，你有两个主要步骤：

*   首先，学习使用 GDI 函数在自己的窗口中绘图。此类别中的一些函数包括[PolyLine](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162815%28v=vs.85%29.aspx)、[LineTo](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145029%28v=vs.85%29.aspx) - 等等。

*   接下来，让它与打印机一起工作。这与在屏幕上绘制实际上是相同的概念，除了您获得的 HDC 代表页面的一部分而不是屏幕的一部分 - 并且涉及更多的设置和清理。在屏幕上绘图时，您可以直接获取窗口DC，绘制，您就完成了；打印到页面涉及更多 - 您必须选择打印机，启动文档，启动页面等等。

我发现[这篇关于 Win32 GDI 打印](http://win32-framework.sourceforge.net/Tutorials/tutorial9.htm)的相当不错的教程可能对您有用 - 它涵盖了所有设置/清理步骤。需要注意的一件事是它将位图发送到打印机。相反，您希望`StretchDIBits`用您自己的`PolyLine`etc 调用替换该调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T09:13:30.770

这是非常基本的 GDI 功能。看看 MSDN 中的[GDI 画线功能](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145031%28v=vs.85%29.aspx)。请注意，大多数语言和环境都有自己的 GDI 包装器，它们提供相同的功能。

# javascript - 谷歌地图事件时间戳

> ID：14489810
> 
> 赞同：0
> 
> 时间：2013-01-23T21:34:43.357
> 
> 标签：javascript, google-maps-api-3

是否可以从谷歌地图侦听器事件中获取时间戳？我想要一个 mousemove 事件，但我需要能够限制它。这是我希望完成的一些代码。我需要谷歌地图事件的原因是它也返回了纬度/经度。

```
var lastMoved = 0;
google.maps.event.addListener(mapObject, "mousemove", function(event){

    if(event.timeStamp - lastMoved > 1000){
        alert("Hello!");
        lastMoved = event.timeStamp;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:06:53.577

采用`new Date().getTime()`

这是 google maps [http://jsbin.com/atotiq/1/edit](http://jsbin.com/atotiq/1/edit)的定时点击事件的一个非常基本的示例。您可以对 mousemove 事件应用相同的方法。

# php - 在php中多次将数组拆分为数组

> ID：14489811
> 
> 赞同：0
> 
> 时间：2013-01-23T21:34:46.000
> 
> 标签：php, arrays, foreach, split

我有一个 div 数组（博客文章）。说 33 篇博文。我的任务是首先将它们*分成*对（每隔两个 div 包装一个），这样我就有 17 个 div（每个包含一对博客文章，最后一个可能只包含一个博客文章）然后 - 我想要这 15 个pair-divs 再次分成 5 个组（最后一个可能包含更少）......所以最后我有 3 个块，每个块包含最多 5 个块，每个块包含两个博客文章。我说得够清楚吗？

当然，所有帖子的总数是未知的，所以我必须让它自动工作。

在寻找答案时，我发现了名为的函数[`array_chunk`](http://php.net/manual/en/function.array-chunk.php)，它正是这样做的 - 将数组拆分为数组......在我的例子中 - 我必须运行这个函数两次。它完美地工作:)

```
$posts = array( 1,2,3,4 ... 33 );
$pairs = array_chunk( $posts, 2 ) // $pairs will contain an array of 17 arrays each containing two elements
$wrap = array_chunk( $pairs, 5 ) // $wrap will contain an array of 3 arrays each containing an array of pairs 
```

唯一困扰我的是，当我通过输出所有 div 时，`foreach`我碰巧自然有 3 个嵌套`foreaches`...首先渲染 3 个（或更多）大包装器 - 然后 - 5 对包装器，最后 - 一个 foreach 来渲染两个博客帖子。

我知道另一种解决方案 -`foreach`在原始数组上运行一次并安排一些数学条件（例如`if( $i % 2 == 0 ) { //do stuff }`）以在适当的时刻打开和关闭合适的 div。这是我无法完成的，如果有人可以帮助我解决这个问题，如果这种方法是可以遵循的，我会非常高兴。

我的问题如下：

*   运行多少嵌套 foreaches 是否存在显着差异（在性能方面）？
*   对于在这种情况下使用哪种方法，是否有某种最佳实践？或者可能有一种完全不同的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:40:43.280

**运行多少嵌套 foreaches 是否存在显着差异（在性能方面）？**

假设您有 100 个帖子。所以它是 50 对，10 包。

*   嵌套 foreach：50 个循环 * 10 个循环 = 100 个循环
*   使用 %: 100 个循环的单个大循环...

在这两种情况下都是一样的。[并且 array_chunk 的使用不会导致性能上的任何重大差异。](http://codepad.org/tYyWx6ce)

*   基准：[http](http://codepad.org/KtEchEmR) ://codepad.org/KtEchEmR （我相信字节的比较比整数快）

**对于在这种情况下使用哪种方法，是否有某种最佳实践？或者可能有一种完全不同的方法。**

不，但我更愿意使用嵌套循环，因为它对于其他程序员来说看起来更干净，并且如果需要，您可以在每个子循环周围包装一个函数

# regex - 使用“？”的惰性正则表达式背后的逻辑？

> ID：14489814
> 
> 赞同：1
> 
> 时间：2013-01-23T21:35:00.963
> 
> 标签：regex, lazy-evaluation, greedy, regex-greedy, non-greedy

这是我的问题：

例如，如果您的模式是：

**美国广播公司？**

那么这将匹配： **ab abc** 但不是**abd** as c？意思是：如果有交流，匹配，如果没有，不用担心..

所以说你有这样的事情：

**->sometext<-->somemoretext<-**

如果你有这样的模式：（这是贪婪的） **->.*<-**那么它只会匹配：

**->sometext<-->sometext<-**

但是，如果您的模式是惰性的： **->.*?<-**那么它将匹配： **->sometext<** - AND **->sometext<-** ...

如果， ？意思是，诸如是否/不是（如第一个示例），那么第二个示例背后的逻辑是什么，有人可以解释一下吗？如果模式是 .*，为什么它会在 ->sometext-< 中停止？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:39:46.767

`?`在不同的语境下有不同的意思。

事实上，`c??`它是一个有效的表达式——它只在你必须的时候才说 match 'c'。

问号实际上有两个以上的含义。例如：

*   [零宽度前瞻](http://www.regular-expressions.info/lookaround.html)：`(?=.*)`。

*   [原子分组](http://www.regular-expressions.info/atomic.html)：`(?>.*)`

*   [命名分组](http://www.regular-expressions.info/named.html)：`(?<NAME>.*)`

*   还有很多很多...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T03:08:21.207

? 当放置在 * 或 + 或 ? 之后 让它变得懒惰。如，它将尝试匹配 0 个字符，如果失败则匹配 1 个字符，如果失败则匹配 2...而不是匹配 MAX 个字符，如果失败则匹配 MAX-1，如果失败则匹配 MAX-2.. . 这是默认行为 - “贪婪”并希望尽可能多地匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T21:40:35.993

在这种情况下使用时：

`abc?`

然后，如果存在，则匹配 a、b 和 c。在这种情况下使用时：

`->.*?<-`

然后您将匹配`->`，然后包括直到第一次出现的所有内容`<-`。相对于：

`->.*<-`

这只是意味着匹配`->`后跟一个可选的，无限数量的任何字符，加上`<-`. 在这种情况下，当然`.*`会吞噬`<-`。

# vb.net - 使用 vb.net 在 MS Access 中选择数据非常慢。我做对了吗？

> ID：14489815
> 
> 赞同：1
> 
> 时间：2013-01-23T21:35:07.147
> 
> 标签：vb.net, ms-access

我目前正在开发一个工作程序，该程序使用组织非常奇怪的 MS Access 数据库中的数据。

我必须从一个表跳到另一个表来获取我需要的信息。

现在我选择的数据少于 200 x 100，但执行所有查询似乎需要很多时间。大约需要 150 秒。

除了我用 php 和 mySql 编写的几个网站之外，我没有真正的数据库背景，所以我想知道你们是否可以快速查看我的代码并告诉我查询的结构和位置是否正确或是否正确是什么让它这么慢。

```
Dim connectionStr = Constants.Input.MDB.CONNECTION_STRING & _
        "Data Source=" & dbFullPath & ";"

    Dim connection As New System.Data.OleDb.OleDbConnection(connectionStr)

    connection.Open()

    Dim query = "SELECT " & Constants.Input.MDB.Columns.CYCLE_ID & ", " & _
                            Constants.Input.MDB.Columns.COMMAND_ID & ", " & _
                            Constants.Input.MDB.Columns.QUANTITY & ", " & _
                            Constants.Input.MDB.Columns.FINAL_TEMP & ", " & _
                            Constants.Input.MDB.Columns.DATE_TIME & ", " & _
                            Constants.Input.MDB.Columns.DRY_MALAX_TIME & ", " & _
                            Constants.Input.MDB.Columns.TOTAL_MALAX_TIME & _
                " FROM " & Constants.Input.MDB.Tables.CYCLE & _
                " WHERE " & Constants.Input.MDB.Columns.DATE_TIME & _
                " BETWEEN #" & startDate.ToString("yyyy/MM/dd") & "# AND #" & endDate.ToString("yyyy/MM/dd") & "#"

    Dim dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

    ' Table readers
    Dim reader_cycle = dbCommand.ExecuteReader

    Dim reader_command As System.Data.OleDb.OleDbDataReader

    Dim reader_strCache As System.Data.OleDb.OleDbDataReader

    Dim reader_recipe As System.Data.OleDb.OleDbDataReader

    Dim reader_coldFeedsRecipeDetails As System.Data.OleDb.OleDbDataReader

    Dim reader_materials As System.Data.OleDb.OleDbDataReader

    Dim reader_cycleDetails As System.Data.OleDb.OleDbDataReader

    Dim reader_location As System.Data.OleDb.OleDbDataReader

    ' Cycle table
    While (reader_cycle.Read)

        Dim row(nbCols) As String

        row(Constants.Input.MDB.CYCLE_ID_COLUMN_INDEX) = reader_cycle.Item(0)
        row(Constants.Input.MDB.COMMAND_ID_COLUMN_INDEX) = reader_cycle.Item(1)
        row(Constants.Input.MDB.TOTAL_QTY_COLUMN_INDEX) = reader_cycle.Item(2)
        row(Constants.Input.MDB.FINAL_TEMP_COLUMN_INDEX) = reader_cycle.Item(3)
        Dim date_time = CStr(reader_cycle.Item(4)).Split(" "c)
        row(Constants.Input.MDB.DATE_COLUMN_INDEX) = date_time(0)
        row(Constants.Input.MDB.TIME_COLUMN_INDEX) = date_time(1)
        row(Constants.Input.MDB.TOTAL_MALAX_TIME_COLUMN_INDEX) = reader_cycle.Item(5)
        row(Constants.Input.MDB.DRY_MALAX_TIME_COLUMN_INDEX) = reader_cycle.Item(6)

        query = "SELECT " & Constants.Input.MDB.Columns.FORMULA_NAME_ID & ", " & _
                            Constants.Input.MDB.Columns.TRUCK_ID & _
                " FROM " & Constants.Input.MDB.Tables.COMMAND & _
                " WHERE " & Constants.Input.MDB.Columns.COMMAND_ID & " " & _
                " = " & row(Constants.Input.MDB.COMMAND_ID_COLUMN_INDEX)

        dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

        reader_command = dbCommand.ExecuteReader

        Dim recipeNameID As String

        ' Command table
        While (reader_command.Read)

            recipeNameID = reader_command.Item(0)
            row(Constants.Input.MDB.TRUCK_ID_COLUMN_INDEX) = reader_command.Item(1)

        End While ' End Command Table

        reader_command.Close()

        query = "SELECT " & Constants.Input.MDB.Columns.STRING_CONTENT & _
                            " FROM " & Constants.Input.MDB.Tables.STRING_CACHE & _
                            " WHERE " & Constants.Input.MDB.Columns.STRING_ID & _
                            " = " & recipeNameID

        dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

        reader_strCache = dbCommand.ExecuteReader

        ' String Cache (formula name)
        While (reader_strCache.Read)

            row(Constants.Input.MDB.RECIPE_NAME_COLUMN_INDEX) = reader_strCache.Item(0)

        End While ' End String Cache

        reader_strCache.Close()

        query = "SELECT " & Constants.Input.MDB.Columns.RECIPE_DESC & ", " & _
                            Constants.Input.MDB.Columns.QUANTITY & ", " & _
                            Constants.Input.MDB.Columns.COLD_FEEDS_RECIPE_ID & _
                " FROM " & Constants.Input.MDB.Tables.RECIPES & _
                " WHERE " & Constants.Input.MDB.Columns.RECIPE_NAME & _
                " = " & "'" & row(Constants.Input.MDB.RECIPE_NAME_COLUMN_INDEX) & "'"

        dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

        reader_recipe = dbCommand.ExecuteReader

        Dim coldFeedRecipeID As Object

        ' Recipe
        While (reader_recipe.Read)

            row(Constants.Input.MDB.RECIPE_DESC_COLUMN_INDEX) = reader_recipe.Item(0)
            row(Constants.Input.MDB.RECIPE_QTY_COLUMN_INDEX) = reader_recipe.Item(1)
            coldFeedRecipeID = reader_recipe.Item(2)

        End While ' End Recipe

        reader_recipe.Close()

        If (Not IsDBNull(coldFeedRecipeID)) Then

            query = "SELECT " & Constants.Input.MDB.Columns.MATERIAL_ID & ", " & _
                                Constants.Input.MDB.Columns.MATERIAL_PERCENTAGE & _
                    " FROM " & Constants.Input.MDB.Tables.COLD_FEEDS_RECIPES_DETAILS & _
                    " WHERE " & Constants.Input.MDB.Columns.CFRD_TABLE_RECIPE_ID & _
                    " = " & coldFeedRecipeID

            dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

            reader_coldFeedsRecipeDetails = dbCommand.ExecuteReader

            ' Cold Feeds Recipe Details
            While (reader_coldFeedsRecipeDetails.Read)

                query = "SELECT " & Constants.Input.MDB.Columns.LOCATION_NAME & _
                    " FROM " & Constants.Input.MDB.Tables.LOCATION & _
                    " WHERE " & Constants.Input.MDB.Columns.MATERIAL_ID & _
                    " = " & reader_coldFeedsRecipeDetails.Item(0)

                dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

                reader_location = dbCommand.ExecuteReader

                Dim locationName As String

                ' Location
                If (reader_location.Read) Then

                    locationName = reader_location.Item(0)
                Else
                    locationName = Constants.Input.MDB.DEFAULT_LOCATION

                End If ' End Location

                Dim locationIndex = Constants.Input.MDB.getColumnIndex(locationName)

                row(locationIndex + Constants.Input.MDB.LOCATION_ROW_INDEX) = locationName

                reader_location.Close()

                query = "SELECT " & Constants.Input.MDB.Columns.MATERIAL_NAME & _
                        " FROM " & Constants.Input.MDB.Tables.MATERIALS & _
                        " WHERE " & Constants.Input.MDB.Columns.MATERIAL_ID & _
                        " = " & reader_coldFeedsRecipeDetails.Item(0)

                dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

                reader_materials = dbCommand.ExecuteReader

                ' Materials
                While (reader_materials.Read)

                    row(locationIndex + Constants.Input.MDB.MATERIAL_NAME_ROW_INDEX) = reader_materials.Item(0)
                    row(locationIndex + Constants.Input.MDB.PERCENTAGE_ROW_INDEX) = reader_coldFeedsRecipeDetails.Item(1)

                End While ' End materials

                reader_materials.Close()

            End While ' End Cold Feeds ...

            reader_coldFeedsRecipeDetails.Close()

        End If

        query = "SELECT " & Constants.Input.MDB.Columns.MATERIAL_NAME_ID & ", " & _
                            Constants.Input.MDB.Columns.FORMULA_QUANTITY & ", " & _
                            Constants.Input.MDB.Columns.DOSAGE_QUANTITY & ", " & _
                            Constants.Input.MDB.Columns.REAL_QUANTITY & ", " & _
                            Constants.Input.MDB.Columns.LOCATION & ", " & _
                            Constants.Input.MDB.Columns.MANUEL_MODE & _
                " FROM " & Constants.Input.MDB.Tables.CYCLE_DETAILS & _
                " WHERE " & Constants.Input.MDB.Columns.CYCLE_ID & _
                " = " & row(Constants.Input.MDB.CYCLE_ID_COLUMN_INDEX)

        dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

        reader_cycleDetails = dbCommand.ExecuteReader

        ' Cycle details
        While (reader_cycleDetails.Read)

            Dim materialNameID = reader_cycleDetails.Item(0)

            Dim location = reader_cycleDetails.Item(4)

            query = "SELECT " & Constants.Input.MDB.Columns.LOCATION_NAME & _
                    " FROM " & Constants.Input.MDB.Tables.LOCATION & _
                    " WHERE " & Constants.Input.MDB.Columns.LOCATION_ID & _
                    " = " & location

            dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

            reader_location = dbCommand.ExecuteReader

            Dim locationName As String

            ' Location
            While (reader_location.Read)

                locationName = reader_location.Item(0)

            End While ' End Location

            Dim locationIndex = Constants.Input.MDB.getColumnIndex(locationName)

            row(locationIndex + Constants.Input.MDB.LOCATION_ROW_INDEX) = locationName

            reader_location.Close()

            query = "SELECT " & Constants.Input.MDB.Columns.STRING_CONTENT & _
                    " FROM " & Constants.Input.MDB.Tables.STRING_CACHE & _
                    " WHERE " & Constants.Input.MDB.Columns.STRING_ID & _
                    " = " & materialNameID

            dbCommand = New System.Data.OleDb.OleDbCommand(query, connection)

            reader_strCache = dbCommand.ExecuteReader

            ' String Cache (formula name)
            While (reader_strCache.Read)

                row(locationIndex + Constants.Input.MDB.MATERIAL_NAME_ROW_INDEX) = reader_strCache.Item(0)

            End While ' End String Cache

            reader_strCache.Close()

            row(locationIndex + Constants.Input.MDB.RECIPE_QTY_ROW_INDEX) = reader_cycleDetails.Item(1)
            row(locationIndex + Constants.Input.MDB.DOSAGE_QTY_ROW_INDEX) = reader_cycleDetails.Item(2)
            row(locationIndex + Constants.Input.MDB.REAL_QTY_ROW_INDEX) = reader_cycleDetails.Item(3)
            row(locationIndex + Constants.Input.MDB.MANUAL_ROW_INDEX) = reader_cycleDetails.Item(5)

        End While ' End cycle details

        reader_cycleDetails.Close()

        rowList.AddLast(row)

    End While ' End Cycle

    reader_cycle.Close()

    connection.Close()

    Return rowList 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:24:32.823

您正在对数据库进行许多不同的选择。每次打开和关闭连接时，除了实际查询的成本外，还有很大的 IO 成本。

正如@RobertHarvey 提到的，您需要学习使用 JOIN。

# c# - 通过单击按钮创建模式对话框

> ID：14489819
> 
> 赞同：0
> 
> 时间：2013-01-23T21:35:31.647
> 
> 标签：c#, asp.net, exception-handling, updatepanel

我试图在更新面板中使用一个按钮在 javascript 中创建一个模式对话框并让它弹出下面的代码是我正在使用的。我已经尝试了几种不同的方法来解决这个问题，但我完全陷入了困境。

```
protected void btnRequestPrint_Command(object sender, CommandEventArgs e)
{
    var button = sender as Button;
    var parent = button.Parent;
    var row = parent.DataItemContainer;

    var printLabel = row.FindControl("lblPrints") as Label;
    var literal = parent.FindControl("lJavascriptPrint") as Literal;
    var label = parent.FindControl("lblMessage") as Label;

    switch (e.CommandName)
    {
        case "RequestPrint":
            var productId = Convert.ToInt32(e.CommandArgument);
            currentProduct = productId;
            var customerId = NopContext.Current.User.CustomerId;

            var ei = this.EncryptionService.GetEncryptionInfo(customerId, productId);
            if (ei != null && ei.Prints > 0)
            {
                literal.Text = @"
                        <div id=""removeME"">
                                                    <!-- yes/no dialog -->

                        <div class=""modal"" id=""yesno"">
                            <h2>
                                Did your music print correctly?</h2>
                            <p>
                                &lt;--Printing Instructions for your browser will go here--&gt;</p>
                            <!-- yes/no buttons -->
                            <p>"
                            //<asp:Button runat=""server"" ID=""btnPrintDialogYes"" CssClass=""close btn btn-primary""
                            //    Text=""Yes"" OnClick=""btnPrintDialogYes_Click"" />
                            //<asp:Button runat=""server"" ID=""btnPrintDialogNo"" CssClass=""close btn btn-danger""
                            //    Text=""No"" />
                        +
                        @"
                        <button onclick=""absorbPrint(" + currentProduct + @")"" class=""btn btn-primary close"">Yes</button>
                        <button class=""btn btn-danger close"">No</button>
                        </div>
                        </div>";
           string UtilsScript = @"
                        <script type=""text/javascript"">
                            function absorbPrint(id) {
                                $.ajax({
                                  type: ""POST"",
                                  url: ""checkoutdownload.aspx/absorbPrint"",
                                  data: ""{}"",
                                  contentType: ""application/json; charset=utf-8"",
                                  dataType: ""json"",
                                  success: function(msg) {
                                    console.log(""success"");
                                  }
                                });
                            }

                            var yesnoDialog = $(""#yesno"").dialog({
                                modal: true
                            });
                            $(""#yesno .close"").click(""function() {
                                $(""#yesno"").dialog(""close"");
                            });
                        </script>";
                    var upanel = parent.Parent as UpdatePanel;
                    ScriptManager.RegisterStartupScript(upanel, upanel.GetType(), "PrintSong", UtilsScript, false);

            }
            else
            {
                label.Visible = true;
                label.Text = "No prints available";
                button.Visible = false;
            }
            break;
    }
} 
```

标记（这是网格视图内部）：

```
<asp:TemplateField>
        <ItemTemplate>
            <asp:Panel ID="pnlNonFolio" runat="server" Visible='<%# ! IsProductFolio( (int)Eval("ProductId")) %>'>
                <asp:UpdatePanel ID="upnlInstantPrint" runat="server">
                    <ContentTemplate>
                        <asp:Button runat="server" ID="btnRequestPrint" CssClass="btn btn-primary modalInput"
                            Text="Print" CommandName="RequestPrint" CommandArgument='<%# Eval("ProductId") %>'
                            OnCommand="btnRequestPrint_Command" />
                        <asp:Literal ID="lJavascriptPrint" runat="server" />
                    </ContentTemplate>
                </asp:UpdatePanel>
                <asp:Label runat="server" ID="lblMessage" Visible="false" />
            </asp:Panel>
            <asp:Panel ID="pnlFolio" runat="server" Visible='<%#  IsProductFolio( (int)Eval("ProductId")) %>'>
                <asp:Label runat="server" ID="lblIsFolio" Text="This Product Is A Folio" />
            </asp:Panel>
        </ItemTemplate>
    </asp:TemplateField> 
```

如有必要，我可以尝试粘贴更多代码，这只是私有代码，因此我无法粘贴其中的一些。

所以无论如何，目前当我这样做时，单击打印按钮时出现以下错误：

```
Uncaught SyntaxError: Unexpected token ILLEGAL
Type.registerNamespace('Sys.WebForms');Sys.WebForms.Res={"PRM_UnknownToken":"Unknown token: \u0027{0}\u0027.","PRM_MissingPanel":"Could not find UpdatePanel with ID \u0027{0}\u0027\. If it is being updated dynamically then it must be inside another UpdatePanel.","PRM_ServerError":"An unknown error occurred while processing the request on the server. The status code returned from the server was: {0}","PRM_ParserError":"The message received from the server could not be parsed. Common causes for this error are when the response is modified by calls to Response.Write(), response filters, HttpModules, or server trace is enabled.\r\nDetails: {0}","PRM_TimeoutError":"The server request timed out.","PRM_ParserErrorDetails":"Error parsing near \u0027{0}\u0027.","PRM_CannotRegisterTwice":"The PageRequestManager cannot be initialized more than once."}; 
```

# php - 无效证书

> ID：14489823
> 
> 赞同：0
> 
> 时间：2013-01-23T21:35:39.913
> 
> 标签：php, web, certificate, hosting, ssl-certificate

我正在尝试解决我网站上的问题。Firefox 显示某些页面时没有任何问题，但其他浏览器（如 Chrome、Safari 或 IE）显示无效证书/网站不受信任错误消息。

在对 Google 进行一些研究后，我发现给出的解决方案通常是在客户端。我正在寻找服务器端解决方案（在 PHP 中）。首先，我想了解更多有关此错误的信息。

以下是 Chrome 显示的错误消息：“您尝试访问域 xxxxxxxxx.com，但服务器提供了由未经您计算机操作系统批准的实体颁发的证书。这可能意味着服务器已经生成了自己的安全性“

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:44:54.813

您是否正确设置了虚拟主机？

```
Listen 443

NameVirtualHost *:443
SSLStrictSNIVHostCheck off

<VirtualHost *:443>
  DocumentRoot /www/example1
  ServerName www.example.com

</VirtualHost>

<VirtualHost *:443>
  DocumentRoot /www/example2
  ServerName www.example2.org

</VirtualHost> 
```

无论如何，请确保在虚拟主机上正确设置证书，例如：

```
SSLEngine on
 SSLCertificateFile /path/to/your_domain_name.crt
 SSLCertificateKeyFile /path/to/your_private.key
 SSLCertificateChainFile /path/to/DigiCertCA.crt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:45:11.420

要解决此问题，您需要安装服务器的签名证书（或服务器证书，如果是自签名的）作为 PC 受信任证书的一部分。
投诉的内容是您的自定义证书尚未由认可的 CA 颁发

# linux - 使用 cronjob 和电子邮件创建一个短信“服务器”

> ID：14489824
> 
> 赞同：0
> 
> 时间：2013-01-23T21:35:46.843
> 
> 标签：linux, scripting, cron

所以这个想法是创建一个“服务器”，它可以通过阅读我的电子邮件并在电子邮件中查找某些关键标题来工作。当检测到具有特定标题的电子邮件时，其中的命令将被解释并运行。请注意，这些不是 Linux 命令，只是我提供的不同命令。让我给你举个例子：

*   我从手机发送文本“计算机，定义你好”到我的电子邮件。

*   我的电子邮件收到文本，并将其保存为“计算机，定义你好”。

*   我的计算机下载了我最新的电子邮件并看到“计算机，定义 Hello”，然后运行命令“定义 Hello”。
*   它将发送命令的结果发回给我，这将是单词“Hello”的定义。

该代码实际上本身就可以正常工作，并且几乎可以在 cronjob 上正常工作。事实上，唯一有问题的命令是命令“sendmail”，它将邮件发送回我的手机。

我看到人们谈论使用“MAILTO”发送电子邮件。我没有使用 MAILTO，而是使用 gmail、mailx 和 msmpta 的组合来完成工作。sendmail 工作正常，只是由于某种原因不能通过 cronjob。这是我获得有关如何执行此操作的说明的页面：http: [//tuxtweaks.com/2012/10/send-gmail-from-the-linux-command-line/](http://tuxtweaks.com/2012/10/send-gmail-from-the-linux-command-line/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T14:51:42.620

我能够通过完全避免 cronjob、使用无限的 while 循环以及使用 sleep(2000)（或其他一些较大的数字）来延迟脚本运行时来完成这项工作。

# java - 如何编写生产就绪的单一消费者？

> ID：14489831
> 
> 赞同：1
> 
> 时间：2013-01-23T21:36:05.773
> 
> 标签：java, concurrency, producer-consumer

以下是阻塞队列的单个使用者的简单实现。我的问题是，我应该需要哪些额外的代码才能使其投入生产？假设我需要这个消费者永远留在身边。

几个问题，例如：

1.  while(true) 是否足够好？
2.  当我得到一个 InterruptedException 时该怎么办，以便我可以尝试恢复我正在做的事情？
3.  如果线程挂起会发生什么？
4.  如果线程由于异常而终止会发生什么？

我想我的总体问题是关于实现对这个单线程消费者的管理和监控的一些想法。或者是否存在提供基本实现的现有库。

非常感谢！

```
public class Consumer implements Runnable{

    private BlockingQueue queue;

    public Consumer (BlockingQueue queue) {
        this.queue = queue;
    }

    @Override
    public void run() {
        while(true){
            try {
                Object task = queue.take();
                ...
            } catch (InterruptedException ex) {
                Thread.currentThread().interrupt();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:40:02.987

> while(true) 是否足够好？

哎呀。@Cratylus 提出了一个很好的观点，您应该始终使用：

```
 while (!Thread.currentThread().isInterrupted()) { 
```

你需要对异常的捕捉保持虔诚——甚至可能捕捉`RuntimeException`，甚至可能`Throwable`。至少您应该考虑在退出之前捕获并记录一条消息。

> 当我得到一个 InterruptedException 时该怎么办，以便我可以尝试恢复我正在做的事情？

这取决于您希望线程做什么。IMO，当一个线程被中断时，它应该（呃）被中断。由于`thread.stop()`许多原因已弃用，`thread.interrupt()`所以真的是阻止线程运行的唯一方法。这意味着它应该清理并退出。

```
} catch (InterruptedException ex) {
    // always a good practice to re-interrupt
    Thread.currentThread().interrupt();
    // but now what to do?  I vote for stopping the thread
    return;
} 
```

> 如果线程挂起会发生什么？

除非您的程序中有错误，否则这永远不会发生。它可能会永远等待，`queue.take()`但中断应该将其踢出。

注意多个`synchronized`部分以防止死锁。请务必使用`java.util.concurrent.*`类 ( `BlockingQueue`, `Executors`, ...) 来教训用户代码导致问题的机会。使用`Atomic*`类。线程之间共享的所有数据都需要正确`synchronized`或`volatile`.

> 如果线程由于异常而终止会发生什么？

你想发生什么？如果这是你想做的，你应该（再次）虔诚地捕捉异常。如果您希望线程在看到异常时停止，那么我会捕获异常，记录它，然后清理并返回。异常处理没有简单的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:41:34.947

> while(true) 是否足够好？

不，你应该这样做`while(!interrupted)`

> 当我得到一个 InterruptedException 时该怎么办，以便我可以尝试恢复我正在做的事情？

如果你得到一个中断的异常，你不应该恢复。这是停止的信号

> 如果线程挂起会发生什么？

如果您在中断时退出，则不会。它将以您当前的形式挂起（由于您当前已对其进行编码，因此无法阻止它）

> 如果线程由于异常而终止会发生什么？

它终止了。不确定你的意思。

# algorithm - 如何在 DLL 中存储大量只读数据？

> ID：14489835
> 
> 赞同：2
> 
> 时间：2013-01-23T21:36:21.017
> 
> 标签：algorithm, memory, dll, fortran

我需要一种在 DLL 中存储大量数字只读数据（双值）的方法。数据必须嵌入到源代码中，因为它会不时更改 - 没有 Visual Studio 等外部工具，只有代码生成 + shell 编译器。

我知道这是一种不好的做法，但这是“业务需求”。

我需要存储大约**2 000 000 个 32 位浮点值**。这应该是大约 8MB 的原始数据。假设 DLL 大小限制为 100MB。语言是**Fortran**。

我的第一个想法是为动态数组生成值分配：

```
work(1,1,1,1) = 826
work(1,1,1,2) = 935
work(1,1,1,3) = 712.5
work(1,1,1,4) = 617.1
work(1,1,1,5) = 102.2 
```

但最终的源文件大约有 70 兆字节，编译的机会为 0（编译器内存不足错误）。此外，即使它可以编译，最终的 DLL 对于每 0.5MB 有用数据的大小约为 5MB。

任何想法以更紧凑的方式格式化源代码（编译器优化友好？）或者可能将数据打包到其他结构，如字符串/原始二进制数据并在运行时提取？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:41:38.137

这正是该`DATA`语句的用途：

```
 real work(10, 10, 10, 10)
  data work/826, 935, 712.5, 617.1, 102.2/ 
```

根据您使用的编译器，您甚至可以将数据设为只读，以便程序更改任何位的任何尝试都会导致段错误异常。

一些编译器支持数据语句中的显式数组成员枚举：

```
 data work(1,1,1,1)/826/, work(1,1,1,2)/935/, work(1,1,1,3)/712.5/
  data work(1,1,1,4)/617.1/, work(1,1,1,5)/102.2/ 
```

这将更容易以无序的方式生成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:48:10.173

我不知道使用 Fortran 是否有更好的解决方案，但如果其他一切都失败了，您可以执行以下操作。

只需将 2,000,000 个 32 位浮点数视为 8,000,000 字节，然后 Base64 将它们编码为字符串。您最终将得到一个 12,800,000 字符长的字符串，您可以甚至可能应该将其拆分为几个部分。在运行时只需反转所有内容。

# arrays - 如果第一个位置为空，则无法从数组中读取值

> ID：14489838
> 
> 赞同：0
> 
> 时间：2013-01-23T21:36:25.263
> 
> 标签：arrays, vb.net, for-loop, multidimensional-array, minimum

我有这个简单的代码，想法是从包含数字的数组中找到最小值，它在大多数情况下都有效：

```
For yy As Integer = 0 To 23
 If (IsNumeric(data(2, yy))) Then
  If (yy > 0) Then
   If (data(2, yy) < min(days)) Then
    min(days) = data(2, yy)
   End If
  Else
   min(days) = data(2, yy)
  End If
 End If
Next 
```

现在，数据数组可能包含值，也可能不包含值，当数组中的第一个位置有值时，代码没有问题，即使数组中的其他位置为空。问题是当数组的第一个位置为空时，即使数组的其余部分充满了值，它也不会读取它们中的任何一个，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:42:58.017

在您的场景中，在第一个循环中您设置`min(days)`为零。
然后在随后的循环中（yy=1 等...），您检查其中包含的值，该值`data(2, yy)`与`min(days)`您在第一个循环中设置为零的值相同。

`if(data(2,yy) < min(days)`因此，除非 data(2,yy) 小于零，否则您永远不会得到真实的条件

似乎您有问题，因为您始终使用相同的值`min(days)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:35:04.697

如果第一个元素为空，那么您永远不会进入`Else`设置`min(days)`为初始值的部分。因此`min(days)`是默认值`0`。而且我假设它`0`总是小于`days(2, yy)`.

Linq 怎么做这项工作？

```
 min(days) = (From index1 In {2}
                 From index2 In Enumerable.Range(0, 24)
                 Where IsNumeric(data(index1, index2))
                 Select (data(index1, index2))).Min() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:09:56.400

您可以事先检查以找到数组中的开始位置（nb 未针对您的代码进行测试）：

```
Dim startAt As Integer = 0
For i = 0 To 23
    If IsNumeric(data(2, i)) Then
        startAt = i
        min(days) = data(2, i)
        Exit For
    End If
Next

For i As Integer = startAt + 1 To 23
    If (IsNumeric(data(2, i))) Then
        If (data(2, i) < min(days)) Then
            min(days) = data(2, i)
        End If
    End If
Next 
```

但是，我怀疑您需要为您的项目设置[Option Strict On](http://msdn.microsoft.com/en-us/library/zcd4xwzs%28v=vs.110%29.aspx)并解决很多数据类型问题。

# visual-studio-2010 - Mono.data.sqlite 和 System.data.sqlite 在 VS2010 中运行 Mono 冲突

> ID：14489842
> 
> 赞同：0
> 
> 时间：2013-01-23T21:36:46.857
> 
> 标签：visual-studio-2010, mono, system.data.sqlite

在VS2010中运行Mono中的程序集/库Mono.data.sqlite和System.data.sqlite冲突...我从官网下载了“sqlite-netFx40-setup-bundle-x64-2010-1.0.83.0.exe” sqlite.org 的...有人可以帮忙吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T05:43:36.670

如果您的应用程序以 Mono 为目标，则不应使用 System.Data.SQLite。该程序集是一个混合模式模块（通过 C++/CLI），仅适用于 Windows。冲突是意料之中的，你必须做出改变。

[您可以从http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki)找到更多详细信息

# emacs - 当前本地键盘映射的 Emacs 名称？

> ID：14489848
> 
> 赞同：11
> 
> 时间：2013-01-23T21:37:06.600
> 
> 标签：emacs, key, key-bindings, major-mode

我正在编写一个 elisp 函数，它将给定键永久绑定到当前主要模式的键盘映射中的给定命令。例如，

```
 (define-key python-mode-map [C-f1] 'python-describe-symbol) 
```

命令和键序列从用户交互收集。但是，我无法生成与当前主要模式相对应的 KEYMAP 名称（例如“python-mode-map”）。

我试过这个函数（current-local-map），但是这个函数返回的是keymap对象本身，而不是它的名字。

我知道许多主要模式键映射是根据约定“主要模式名称”-模式映射“命名的，但是，情况并非总是如此（例如，python-shell-map），所以我宁愿我的代码不依赖这个约定。（我什至不确定如何访问当前主要模式的名称）。

将`(define-key ...)`被添加到一个 init 文件中，所以虽然

`(define-key (current-local-map) key command)`

似乎工作，它不能作为初始化文件上的代码工作。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-23T21:50:06.130

没有直接的方法可以找到当前本地键映射的名称——更准确地说，是其值所绑定到的符号——因为键映射甚至不必绑定到符号。但是，模式键映射通常绑定到全局符号，并且可以通过遍历所有符号并停止其值为`eq`键映射对象的符号来找到它是哪一个。

这必须查看所有符号（尽管它对每个符号的工作最少），但具有不依赖任何特定命名约定的优点。

```
(defun keymap-symbol (keymap)
  "Return the symbol to which KEYMAP is bound, or nil if no such symbol exists."
  (catch 'gotit
    (mapatoms (lambda (sym)
                (and (boundp sym)
                     (eq (symbol-value sym) keymap)
                     (not (eq sym 'keymap))
                     (throw 'gotit sym))))))

;; in *scratch*:
(keymap-symbol (current-local-map))
==> lisp-interaction-mode-map 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-23T22:02:27.463

该函数的`local-set-key`存在是为了在当前本地键盘映射中绑定键。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T21:46:53.070

也许你可以尝试：

`(define-key (concat (symbol-name major-mode) "-map") [C-f1] 'python-describe-symbol)`

编辑：虽然这会产生正确的字符串，但仍应将其转换回符号。

# c# - 是否可以在 MatLab 中使用 .NET 应用程序？

> ID：14489849
> 
> 赞同：8
> 
> 时间：2013-01-23T21:37:08.957
> 
> 标签：c#, web-services, matlab

我在 C# 中感觉很自在，我将设计一个控制台应用程序，该应用程序将从 Web 服务中获取一些数据。我想让一群科学家使用 MatLab 中的数据。实现此目的的一种方法是将其存储在 HDD 上的文件中，然后将其内容加载到 MatLab 中。

不过，这让我开始思考。**是否可以在 MatLab 中创建一个函数来调用在 C# 中创建的 EXE，**以便我的科学朋友可以去：

```
a = GetMeSomeData() 
```

并用服务的响应填充变量*a ？*（当然，我会使用我的 C# 代码格式化数据，使其适合 MatLab 的矩阵模型。）

在我开始研究这个之前，我已经做了一些谷歌搜索，但我发现的大部分内容都是关于旧版本的 MatLab (2007)，它提到了关于创建 COM 对象的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T21:43:07.283

您可能想看看这个：[在 MATLAB 中使用 .NET 库](http://www.mathworks.com.au/help/matlab/using-net-libraries-in-matlab.html)。

那里有很多文档。

从 开始，然后您似乎可以像在 .NET 中一样正常使用这些类。[`NET.addAssembly`](http://www.mathworks.com.au/help/matlab/ref/net.addassembly.html)`('path-to-dll)`

您可能还想看看[Using Arrays with .NET Applications](http://www.mathworks.com.au/help/matlab/matlab_external/using-arrays-with-net-applications.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:45:24.727

您可以轻松地调用 .NET 程序集中的函数。首先你必须告诉 Matlab 你将使用什么程序集：

```
NET.addAssembly("path//to//assembly.dll"); 
```

之后，您只需调用 m 文件中的函数：

```
foo = Namespace.Class.FunctionFoo(input1, input2);
bar = Namespace.Class.FunctionBar(input1, input2); 
```

你甚至可以有多个输出。AC# 函数如下：

```
public void MultipleOut(int in1, int in2, out int out1, out int out2)
{ ... } 
```

在 Matlab 中可以这样调用：

```
[out1, out2] = Namespace.Class.MultipleOut(in1, in2); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T21:42:39.960

要直接回答问题，您可以使用[`system`](http://www.mathworks.co.uk/help/matlab/ref/system.html)命令或[`!`](http://www.mathworks.co.uk/help/matlab/matlab_env/creating-opening-changing-and-deleting-files-and-folders.html#f0-38522)在 MATLAB 中执行外部进程。一旦它返回，您就可以读取和解析 MATLAB 函数的输出。将所有内容包装在一个 MATLAB .m 文件中，您就拥有了您在问题中描述的内容。

当然，您可以直接从 MATLAB 使用[`createClassFromWsdl`](http://www.mathworks.co.uk/help/matlab/ref/createclassfromwsdl.html). 正如其他人指出的那样，它[`NET.addAssembly`](http://www.mathworks.co.uk/help/matlab/ref/net.addassembly.html)允许您直接从 MATLAB 导入和使用 .net 程序集，这可能比解析文本文件输出更干净。

# ember.js - 使用 Ember Data，如何调用提交？

> ID：14489852
> 
> 赞同：1
> 
> 时间：2013-01-23T21:37:25.200
> 
> 标签：ember.js, ember-data

我正在尝试使用余烬的所有最后路线和数据内容构建一个简单的待办事项列表。[你可以在这里](https://github.com/earnold/ember-todo)找到我的完整回购

我的商店是这样设置的：

```
EmberTodo.Store = DS.Store.extend({
  revision: 11,
  adapter: DS.RESTAdapter.create({bulkCommit: false})
}); 
```

给我带来麻烦的代码行来自这里：

```
EmberTodo.CreateItemView = Ember.TextField.extend({
  insertNewline: function() {
    EmberTodo.Item.createRecord({description: this.get('value')});
    this.set("value", "");
  }
}); 
```

据我了解，调用`createRecord`不会创建记录，而是我需要在`commit()`某个地方调用。但是，我无法弄清楚在哪里。有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:05:26.730

> 据我了解，调用 createRecord 不会创建记录，而是我需要在某处调用 commit() 。但是，我无法弄清楚在哪里。有人有想法么？

当然。为了让这个工作尽可能最小

```
EmberTodo.CreateItemView = Ember.TextField.extend({
  insertNewline: function() {
    item = EmberTodo.Item.createRecord({description: this.get('value')});
    item.get('transaction').commit();
    this.set("value", "");
  }
}); 
```

我在这里使用 DS.FixtureAdapter 放置了一个简化的工作示例：http: [//jsbin.com/ugipap/1/edit](http://jsbin.com/ugipap/1/edit)

> 完成了，对吧？

有点。事情是，你真的不想从一个视图中做这种事情。考虑重构以将此逻辑移动到控制器层，或者根据情况可能的路由器。

# asp.net-mvc-3 - MVC3 C#潜在危险请求错误

> ID：14489853
> 
> 赞同：2
> 
> 时间：2013-01-23T21:37:31.317
> 
> 标签：asp.net-mvc-3, html-encode

我有一个 MVC3 C#。网络应用程序。我们的属性之一为 TextBoxFor 控件使用了 RTF 控件：

```
 @Html.TextAreaFor(model => model.SowDescription,
                    (object)new
                    {
                        rows = 7,
                        cols = 65,
                        @class = "celltext2 save-alert attachmentEditor",
                        disabled = "disabled"
                    } 
```

attachmentEditor 类使用 CkEditor。因此，控件中嵌入了粗体、斜体等的 html 标签。用户将一些数据粘贴到此 TextArea 中，我们收到此错误：

```
A potentially dangerous Request.Form value was detected from the client (SowDescription="<br />  <br />  <u><..."). ******** 
```

我们在其他情况下使用 HttpUtility.HtmlDecode，但是在 Html.TextAreFor() 帮助器中使用它我们会得到这个错误：

```
Templates can be used only with field access, property access, single-dimension array index, or single-parameter custom indexer expressions. 
```

任何想法我们可以如何使用 Html.TextAreaFor() 帮助器编码/解码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:17:28.713

尝试使用属性装饰`SowDescription`viewmodel`[AllowHtml]`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T06:31:36.707

在您的模型中，在 SowDescription 定义之前添加此

```
 [AllowHtml] 
```

您需要 System.Web.Mvc 参考才能使用它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-23T13:59:15.627

简单地写：用户界面：

```
CKEDITOR.replace('Description', { toolbar: '1', htmlEncodeOutput: true}); 
```

控制器：

```
model.Body = System.Net.WebUtility.HtmlDecode(model.Body); 
```

# ios - 如何使用 Next ， Back 按钮在 xcode 上的 UIImage 视图中更改 url 图像？

> ID：14489854
> 
> 赞同：1
> 
> 时间：2013-01-23T21:37:31.267
> 
> 标签：ios, objective-c, xcode

我想在我的应用程序中创建一个具有 2 个按钮（1.back 按钮 2.next 按钮）的页面，这些按钮更改 UIImageView 中的图像。（所有图像都从我的站点加载，它们的格式为 1.png 、 2.png 、 3。 png ,.... , N.png)

单击下一步按钮（后退按钮）时，我不知道如何工作 一个接一个地显示图像（一个接一个）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-04T07:27:19.063

您必须用图像名称填充数组并执行以下操作

```
-(IBAction) nextButtonClicked:(id)sender {
    if (counter < images.count) {
        self.imgView.image = [UIImage imageNamed:[NSString stringWithFormat:@"%@", images[counter]]]
        counter++;
    } else {
        counter = 0;
    }
}

-(IBAction) backButtonClicked:(id)sender {
    if (counter > 0) {
        counter--;
        self.imgView.image = [UIImage imageNamed:[NSString stringWithFormat:@"%@", images[counter]]]
    } else {
        counter = [images.lastObject intValue];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:02:23.607

这个想法是阅读 iOS 中动画（或核心动画）的基础知识。

您可能应该阅读以下指南：[在 iOS 中查看编程指南](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/animatingviews/animatingviews.html)

此外，这个想法是有一个带有操作的按钮，它显示一个视图并检查屏幕上是否已经显示了一个 imageView。如果未显示，则显示所需的 imageView。如果显示，您可以使用以下方法删除视图：

```
[someImageView removeFromSubview:yourMainView] 
```

可以在同一个 viewController 中调用。登录将取决于您处理按钮和图像视图的方式。

我在这台机器上没有 Xcode 可以检查，但这就是事情的进展方式。然后，您可以添加动画以删除和添加这些视图。

# curl - PHP脚本适用于mac但不适用于windows

> ID：14489856
> 
> 赞同：2
> 
> 时间：2013-01-23T21:37:37.303
> 
> 标签：curl, error-handling, php, parse-platform

我正在使用 parse.com 和用于与框架交互的 PHP 库仅在使用 MAMP 的 Mac 上为我工作，但在使用 XAMPP 或 WAMP 的 Windows 上，它每次都因相同的原因而失败。下面是每次连接解析时调用的函数。在 Windows 上运行时，$responseCode = 0 并且 $response 为 false。当我在我的 Mac 上运行它时，$responseCode = 200 和 $response 返回它假设的 json 数据。到底是怎么回事？为什么不同的平台会导致失败？

```
public function request($args){
        $isFile = false;
        $c = curl_init();
        curl_setopt($c, CURLOPT_TIMEOUT, 30);
        curl_setopt($c, CURLOPT_USERAGENT, 'parse.com-php-library/2.0');
        curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($c, CURLINFO_HEADER_OUT, true);
        if(substr($args['requestUrl'],0,5) == 'files'){
            curl_setopt($c, CURLOPT_HTTPHEADER, array(
                'Content-Type: '.$args['contentType'],
                'X-Parse-Application-Id: '.$this->_appid,
                'X-Parse-Master-Key: '.$this->_masterkey
            ));
            $isFile = true;
        }
        else if(substr($args['requestUrl'],0,5) == 'users' && isset($args['sessionToken'])){
            curl_setopt($c, CURLOPT_HTTPHEADER, array(
                'Content-Type: application/json',
                'X-Parse-Application-Id: '.$this->_appid,
                'X-Parse-REST-API-Key: '.$this->_restkey,
                'X-Parse-Session-Token: '.$args['sessionToken']
            ));
        }
        else{
            curl_setopt($c, CURLOPT_HTTPHEADER, array(
                'Content-Type: application/json',
                'X-Parse-Application-Id: '.$this->_appid,
                'X-Parse-REST-API-Key: '.$this->_restkey,
                'X-Parse-Master-Key: '.$this->_masterkey
            )); 
        }
        curl_setopt($c, CURLOPT_CUSTOMREQUEST, $args['method']);
        $url = $this->_parseurl . $args['requestUrl'];

        if($args['method'] == 'PUT' || $args['method'] == 'POST'){
            if($isFile){
                $postData = $args['data'];
            }
            else{
                $postData = json_encode($args['data']);
            }

            curl_setopt($c, CURLOPT_POSTFIELDS, $postData );
        }

        if($args['requestUrl'] == 'login'){
            $urlParams = http_build_query($args['data'], '', '&');
            $url = $url.'?'.$urlParams;
        }
        if(array_key_exists('urlParams',$args)){
            $urlParams = http_build_query($args['urlParams'], '', '&');
            $url = $url.'?'.$urlParams;
        }

        curl_setopt($c, CURLOPT_URL, $url);

        $response = curl_exec($c);
        $responseCode = curl_getinfo($c, CURLINFO_HTTP_CODE);

        $expectedCode = '200';
        if($args['method'] == 'POST' && substr($args['requestUrl'],0,4) != 'push'){
            $expectedCode = '201';
        }

        if($expectedCode != $responseCode){
            //BELOW HELPS WITH DEBUGGING
                    //echo "VAR DUMP:";
                    //var_dump($response);      
        }

        return $this->checkResponse($response,$responseCode,$expectedCode);
    }

private function checkResponse($response,$responseCode,$expectedCode){
        //TODO: Need to also check for response for a correct result from parse.com
        if($responseCode != $expectedCode) {

            $error = json_decode($response);
            $this->throwError($error->error,$error->code);
        }
        else{
            //check for empty return
            if($response == '{}'){
                return true;
            }
            else{
                return json_decode($response);
            }
        }
    }
} 
```

错误：

```
[23-Jan-2013 19:57:45 UTC] PHP Notice:  Trying to get property of non-object in C:\wamp\www\firecom\parse\parse.php on line 180

[23-Jan-2013 19:57:45 UTC] PHP Notice:  Trying to get property of non-object in C:\wamp\www\firecom\parse\parse.php on line 180

[23-Jan-2013 19:57:45 UTC] PHP Fatal error:  Uncaught ParseLibraryException: [0]: thrown in C:\wamp\www\firecom\parse\parse.php on line 169 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:40:48.463

代替：

```
$response = curl_exec($c); 
```

和：

```
if( ! $response = curl_exec($c) ) {
    die(curl_error($c));
} 
```

或者替换您喜欢的任何错误处理代码。

[http://ca2.php.net/manual/en/function.curl-error.php](http://ca2.php.net/manual/en/function.curl-error.php)

# javascript - 推入数组的 JavaScript 对象

> ID：14489860
> 
> 赞同：18
> 
> 时间：2013-01-23T21:37:45.790
> 
> 标签：javascript

> **可能重复：**
> [如何正确克隆 JavaScript 对象？](https://stackoverflow.com/questions/728360)

我有这个代码：

```
var temp = [];
var obj = {name:"1"};
temp.push(obj);
obj.name = "2";
temp.push(obj); 
```

我期望的是真实的：

```
temp[0].name == "1" && temp[1].name == "2"; 
```

实际发生的情况：

```
temp[0].name == "2" && temp[1].name == "2"; 
```

为什么会发生这种情况，我怎样才能得到我所期望的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T21:46:29.327

JavaScript 数组保存对对象的引用，而不是对象本身。当您将一个对象推入数组时，它不会创建一个新对象，而只是将对该对象的引用（`obj`也指向该对象）放入数组中。

所以最终obj、temp[0]和temp [1](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)都指向同一个对象。要真正创建一个全新的对象，您可以使用[Object.create()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)或 jQuery.extend({},obj)。尽管在您的情况下，只需使用创建一个新的简单对象就很容易了`var newobj = {name="2"}`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T21:42:19.047

JavaScript 对象通过引用传递。在您的情况下，您只有一个对象“obj”，并且 temp[0] 和 temp[1] 指向同一个对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:44:31.357

`obj`作为一个对象是通过引用添加到数组中的，因此您实际上添加了`obj`两次相同的对象。

# c - 如何将一维数组映射到C中的二维数组？

> ID：14489862
> 
> 赞同：0
> 
> 时间：2013-01-23T21:37:49.057
> 
> 标签：c, image-processing, multidimensional-array

我正在尝试将图像的 RGB 像素分别映射到 R、G、B 的二维数组。读取图像时，像素以 {r1,g1,b1,r2,g2,b2...} 的形式存储在 1D 数组中。数组的长度为`3*height*width`。二维数组的宽度 X 高度

```
for(i = 0; i < length; i++) { // length = 3*height*width
    image[i][2] = getc(f); // blue pixel
    image[i][1] = getc(f); // green pixel
    image[i][0] = getc(f); // red pixel

    img[count] = (unsigned char)image[i][0];
    count += 1;

    img[count] = (unsigned char)image[i][1];
    count += 1;

    img[count] = (unsigned char)image[i][2];
    count += 1;

    printf("pixel %d : [%d,%d,%d]\n", i+1, image[i][0], image[i][1], image[i][2]);
} 
```

RGB 值在`img[]`. 二维数组是 red[][]、green[][] 和 blue[][]。

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:47:01.497

据我了解，您正在尝试重建色域。只需反转您的功能：

```
unsigned char * imgptr = img;

for( int y = 0; y < height; y++ ) {
    for( int x = 0; x < width; x++ ) {
        red[y][x] = *imgptr++;
        green[y][x] = *imgptr++;
        blue[y][x] = *imgptr++;
    }
} 
```

动态创建数组：

```
unsigned char** CreateColourPlane( int width, int height )
{
    int i;
    unsigned char ** rows;

    const size_t indexSize = height * sizeof(unsigned char*);
    const size_t dataSize = width * height * sizeof(unsigned char);

    // Allocate memory for row index and data segment.  Note, if using C compiler
    // do not cast the return value from malloc.
    rows = (unsigned char**) malloc( indexSize + dataSize );
    if( rows == NULL ) return NULL;

    // Index rows.  Data segment begins after row index array.
    rows[0] = (unsigned char*)rows + height;
    for( i = 1; i < height; i++ ) {
        rows[i] = rows[i-1] + width;
    }

    return rows;
} 
```

然后：

```
unsigned char ** red = CreateColourPlane( width, height );
unsigned char ** green = CreateColourPlane( width, height );
unsigned char ** blue = CreateColourPlane( width, height ); 
```

你可以很容易地释放它们，但如果你包装了分配器函数，包装释放函数总是值得的：

```
void DeleteColourPlane( unsigned char** p )
{
    free(p);
} 
```

# jakarta-ee - 从模型类访问业务类

> ID：14489868
> 
> 赞同：0
> 
> 时间：2013-01-23T21:38:09.727
> 
> 标签：jakarta-ee, model, business-objects

我想知道是否可以从模型类访问业务对象，它的设计是否干净？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:20:24.990

这在很大程度上取决于您所说的模型对象和您所说的业务对象。如果您根据对 MVC 模式的现代理解（例如 ASP.NET MVC 或 spring）来操作模型习语，那么业务逻辑可能会成为模型的一部分，在这种情况下，您当然可以这样做 =）

如果您谈论的是视图模型本身的模型，并且它的唯一目标只是存储数据以通过 UI 使用它，那么您的模型应该尽可能地愚蠢。它应该由业务逻辑的人准备，然后转移到 UI 上，仅此而已。

而且，如果您的应用程序真的很小，那么首要标准将是它会在多大程度上简化您的生活。因为做像大项目这样的小项目肯定会过度工程化。

# apache2 - 如何限制apache2上的每秒连接数和IP？

> ID：14489869
> 
> 赞同：0
> 
> 时间：2013-01-23T21:38:10.567
> 
> 标签：apache2, ddos

你好！我的 apache2 经常出现问题，一些人正在用 HTTP 请愿书轰炸我的服务器，向我的所有表单发送请求，一切都崩溃了，我的服务也中断了。

如何限制我的用户每秒的请愿数量？或者解决这个问题的常用方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:56:04.530

我们使用 mod_qos 进行服务器和 url 级别的保护

它不是很容易理解或安装，但它确实很强大。

阅读页面上的一些示例/示例，您会找到适合您问题的

[http://opensource.adnovum.ch/mod_qos/](http://opensource.adnovum.ch/mod_qos/)

# php - 是否可以使用 levenshtein 函数比较像两个字符串这样的图像？

> ID：14489872
> 
> 赞同：0
> 
> 时间：2013-01-23T21:38:12.953
> 
> 标签：php, c++, python, image, gd

> **可能重复：**
> [在 php 中比较 2 个图像](https://stackoverflow.com/questions/3270929/compare-2-images-in-php)

为了比较两个字符串的相似性，我在 php 中使用了 levenshtein 和similar_text 函数。

是否可以比较两个图像的相似性？

为什么我需要这个？！我有两个供应商-> 两套产品。我需要在两组之间有交集。有时产品名称不同（0% 相似）但实际上它们是相同的。

所以我想，我可以通过产品照片来比较它们。

# actionscript-3 - AS3 - 接口是否需要覆盖，或者类是否可以从仅由子类使用的接口调用方法？

> ID：14489875
> 
> 赞同：2
> 
> 时间：2013-01-23T21:38:17.083
> 
> 标签：actionscript-3, methods, interface, subclass

我有一个潜在的不可能的愿望。我有一个类，我想从中构建几个子类。每个子类都将实现相同的接口，但我有点希望 BASE 类调用该接口的方法。

这是我想要的编译器错误版本：

```
public class Class1
{
    public function Class1()
    {
        initialize();
    }
}

public interface Int
{
    function initialize():void;
}

public class Class2 extends Class1 implements Int
{
    public function Class2()
    {
        super();
    }

    public function initialize():void
    {
        // Code unique to the class goes here.
    }
} 
```

显然，即使我无意创建 Class1 的实例，这段代码也会中断。在这个简化版本中它看起来也很愚蠢，但它说明了我想要这个的原因：我希望每个类自动调用`initialize()`它的构造函数，因此将它保留在超类中是有意义的。

现在，我可以做这样的事情：

```
public class Class1
{
    public function Class1() implements Int
    {
        initialize();
    }

    public function initialize():void {}
}

public interface Int
{
    function initialize():void;
}

public class Class2 extends Class1 implements Int
{
    public function Class2()
    {
        super();
    }

    public override function initialize():void
    {
        // Code unique to the class goes here.
    }
} 
```

这就是我现在所处的位置，但是将方法放在超类中并在子类中覆盖它会破坏拥有接口的目的；只需扩展原始类即可满足`initialize()`方法要求，而且我不知道我可以强制每个子类覆盖该方法。当然，我可以省略基类中的调用并将其插入到每个子类中，但我也不能强制要求拥有它。

所以我的问题是，是否存在不会中断的#1 版本（在未实现接口的基类中调用接口方法），或者是否存在将需要的#2 版本（覆盖相关方法） initialize() 被子类覆盖？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:22:37.350

如果我正确解释了您的问题，您希望在 的子类上实现接口`Class1`，但不是`Class1`直接实现。您还希望能够从 调用接口中的方法`Class1`，以便在子类化时自动调用它们。

我现在要指出这个可能很糟糕的设计，但不管你能做什么：

**界面：**

一个基本的测试接口：

```
public interface Interface
{

    function init():void;

} 
```

**你的基类：**

`init()`如果任何子类实现，这是将调用的类`Interface`：

```
public class Base
{

    public function Base()
    {
        // Use 'is' to check if this implements Interface.
        if(this is Interface)
        {
            // Use 'as' to refer to .init() within Interface.
            (this as Interface).init();
        }
        else
        {
            // Interface was not implemented.
            // Throw an error or whatever you find necessary.
            //
        }
    }

} 
```

这里的技巧是我们`is`用来确定子类是否已经实现`Interface`。如果有，我们可以通过访问它定义的方法`as`并继续调用它们。

**子类：**

这是您用于测试的直接子类：

```
public class Sub extends Base implements Interface
{

    public function init():void
    {
        trace('Success!');
    }

} 
```

如果您继续通过构建 的实例来测试它`Sub`，您会`Success!`在输出面板中注意到预期的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:43:19.670

让基类扩展接口。然后子类覆盖基方法。这将允许您从基础调用方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:19:42.250

我感觉到你的痛苦，抽象类在这里会非常有用。不幸的是，这些在 AS3 中不存在。在您的情况下，我能做的最好的事情只是对您的建议稍作改动。

```
public class Class1
{
    public function Class1() implements Int
    {
        initialize();
    }

    public function initialize():void {
        throw new Error("Subclass of Class1 must override initialize.");
    }
} 
```

显然这会给你一个运行时错误，而不是编译时错误。我仍然只谨慎地使用这种策略，因为声明方法和抛出错误并不干净，而且是一种让步。然而，有时，这些优势是值得的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-10T10:43:01.357

这是一个老话题，但我会发表我的想法。调用 super() 然后回调 init() 是没有意义的。不必要的电话……就像乒乓球一样。

最好将 init() 定义为私有，因为它是唯一的子类代码，并且不应从类外部访问。您不需要接口来确保存在私有 init() 方法。如果您在构造函数中调用它并且它不存在，它将无法编译 - 与接口相同的行为。如果另一个单独的子类不需要 init()，请不要调用/定义它或将其留空。很简单吧？^^

接口应该只保证 PUBLIC 函数可用于其他编码器。没有人需要知道私有函数。在类中编写干净统一的代码是您自己的责任。私有方法始终在每个单独的类中是可选的。

假设您想使用（公共方法的）接口初始化您的各个子类 - 例如 setSize(x,y) 方法。

```
public interface IBase
{
    function setSize(x:int, y:int):void
}

[abstract] public class Base
{
    private var _x:int;
    private var _y:int;

    public function Base()
    {
        if(!(this is IBase))
        {
            throw new ArgumentError("Class " + flash.utils.getQualifiedClassName(this) + " can not be instantiated.");
        }
    }

    protected function init():void
    {
        // global init functions...
    }

    protected function setSize(x:int, y:int):void
    {
        this._x = x;
        this._y = y;
    }
} 
```

在构造函数中，您可以检查“this”（子类）是否实现了 IBase 接口。所以没有人可以直接实例化 BaseClass。就像一个抽象类。顺便说一句：[抽象] MetaTag 什么都不做。只是为了更好地理解课程。;)

所有其他功能都受到保护。它们只能从子类访问——它们不能从外部访问。接口无法识别 setSize() 函数，因为它是受保护的，而不是公开的！

```
public class Sub extends Base implements IBase
{
    public function Sub()
    {
        // You don't need to define an empty super(). The compiler will do it for you automatically. 
        // It's only necassary, if you want to pass parameters to the BaseClass.
        // The Base-Constructor fires always before Sub() and init()
        init(); 
    }

    // Its private and save. Only this class can call this individual init().
    private function init():void
    {
        // init something
        super.init(); // optionally call the protected [Base].init()
    }

    // Its public and necessary, because its defined in the Interface
    public function setSize(x:int, y:int):void
    {
        // Do something before
        super.setSize(x, y);
        // Do something after
        // or do something special in the SubClass
    }
} 
```

现在您必须在您的接口中定义的子类中设置公共函数。没有覆盖！我们只是调用 Base 函数。你可以在这个公共函数中做任何你想做的事情，并且可以通过 super.setSize(x,y) 调用 BaseClass 中的受保护函数。

没有人可以从外部访问私有 init() - 这对防止双重初始化很有好处。但是每个人都可以从外部调用 setSize() 并且每个子类都必须通过接口来实现这一点——这就是你想要的。BaseClass 中同名的受保护函数是无关紧要的——它们也可以有其他名称——它只是为了统一。

如果您没有定义单独的私有 init() 函数，它会自动调用 Base.init() 由于受保护的行为。

你知道构造函数是干什么用的吗？是的，初始化！为什么你不只是在你的子类构造器中编写你自己的初始化代码并摆脱额外的初始化函数？;)

# sql-server - 将数据从 Excel 导入现有表

> ID：14489876
> 
> 赞同：1
> 
> 时间：2013-01-23T21:38:20.077
> 
> 标签：sql-server

我`HRTC`在 SQL Server 中有一个表。我想将 Excel 中的数据导入此表中。但我的 Excel 文件没有与表格匹配的所有列`HRTC`。无论如何我可以做到这一点吗？

我正在考虑类似于导入向导中的内容

```
Insert into SQLServerTable Select * FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
'Excel 8.0;Database=D:\testing.xls;HDR=YES', 
'SELECT * FROM [SheetName$]')

 select column1, column2 from HRTC 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:43:05.567

试试这个

创建临时表

```
Select * INTO TmpTable FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
'Excel 8.0;Database=D:\testing.xls;HDR=YES', 
'SELECT * FROM [SheetName$]') 
```

然后使用 temptable 将行插入到 hrtc 中，任何丢失的列都将具有 null

```
INSERT INTO hrtc(column1, column2)
select col1, col2 from TmpTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:46:48.113

一种简单的方法是将您的 excel 文件编写成一组插入语句，然后在 SQL Server 上运行它。

此外，如果您可以将 excel 文件导出为 CSV 文件，这通常很有用。SQL Server Management Studio 之类的工具应该有某种导入向导，您可以在其中加载 CSV、选择列映射等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:51:59.597

在这些情况下，我经常最终做的是使用 excel 的 CONCATENATE 函数完成一些代码。

假设您有：

```
 A     B
1  foo     bar
2  test2   bar2
3  test3   bar 3 
```

如果您需要将它们插入表中。在 C 列中，您可以写：

```
=CONCATENATE("INSERT INTO HRTC(col, col2) VALUES('", A1, "','", B1, "')") 
```

# java - java.net.NoRouteToHostException 引发试图到达客户端*相同*子网上不存在的主机

> ID：14489879
> 
> 赞同：0
> 
> 时间：2013-01-23T21:38:29.017
> 
> 标签：java, network-programming

我写了一个简单的 java tcp 客户端。每次运行客户端时，我都会在命令行中指定服务器 IP 地址。

当没有服务器监听指定的 IP 地址或 IP 地址不存在时，会引发 SocketTimeoutException。这对于运行客户端的子网之外的任何 IP 地址都可以正常工作。*如果我在客户端的同一*子网上指定了错误的服务器 IP 地址，则会引发 java.net.NoRouteToHostException。

这对我来说很奇怪。两个地址都属于同一个子网，绝对不需要 ip 路由就可以到达服务器。如果服务器位于与客户端不同的子网中，并且运行客户端的主机没有默认网关，这将是正确的。

我想要的只是接收一个 SocketTimeoutException ，即使是客户端同一子网上的错误地址（我的意思是没有侦听服务器或不存在地址的地址）。

我怎样才能获得这种行为？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:53:44.140

这两个例外是有区别的。

**1.NoRouteToHostException：**

> 表示尝试将套接字连接到远程地址和端口时发生错误的信号。通常，由于中间防火墙或中间路由器已关闭，无法访问远程主机。

**2\. Socket超时异常**

> 表示套接字读取或接受发生超时的信号。

所以，如果你有`NoRouteToHostException`，这意味着该地址无法到达（在你的情况下它可能不存在），如果你有`SocketTimeoutException`这个地址存在，但你不能连接到特定的端口（那里没有监听） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T23:24:32.190

实际上，您无法将这两个条件都包装到一个异常中。问题是这里发生了两件不同的事情。

对于从本地子网发送数据包，运行您的应用程序的系统将使用本地网关将其发送到链中的下一个路由器，依此类推，直到到达目标网络。因为在指定的目标地址没有人，所以什么都不会响应，你会得到一个超时异常。

对于本地子网，系统尝试直接连接到目标地址。这意味着它将首先发送某种 ARP 请求。不幸的是，对此将没有响应，并且系统将不知道如何发送您的数据包，从而导致“我找不到发送此信息的方法”错误。也就是 NoRouteToHost 异常。

不同之处在于，在第一种情况下，系统可以发送请求，但在第二种情况下不能。这就是为什么有两个单独的错误。

# java - 更改 Google Maps API 的“我的位置”按钮的位置

> ID：14489880
> 
> 赞同：85
> 
> 时间：2013-01-23T21:38:29.850
> 
> 标签：java, android, google-maps-android-api-2, android-maps-v2

我正在使用 Google Maps Android API v2，我需要一种方法来确定“我的位置”按钮的位置。

我得到这样的“我的位置”按钮：

```
GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());
final GoogleMap map = ((SupportMapFragment) getSupportFragmentManager()
        .findFragmentById(R.id.map)).getMap();

// This gets the button
map.setMyLocationEnabled(true); 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-12-23T20:48:49.367

您可以获取“我的位置”按钮并移动它，例如：

```
public class MapFragment extends SupportMapFragment {
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View mapView = super.onCreateView(inflater, container, savedInstanceState);   

    // Get the button view 
    View locationButton = ((View) mapView.findViewById(1).getParent()).findViewById(2);

    // and next place it, for exemple, on bottom right (as Google Maps app)
    RelativeLayout.LayoutParams rlp = (RelativeLayout.LayoutParams) locationButton.getLayoutParams();
    // position on right bottom
    rlp.addRule(RelativeLayout.ALIGN_PARENT_TOP, 0);
    rlp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, RelativeLayout.TRUE);
    rlp.setMargins(0, 0, 30, 30);
    }
} 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2014-08-07T13:50:03.097

只需使用 GoogleMap.setPadding(left, top, right, bottom)，它允许您指示地图中可能被其他视图遮挡的部分。设置填充重新定位标准地图控件，相机更新将使用填充区域。

[https://developers.google.com/maps/documentation/android/map#map_padding](https://developers.google.com/maps/documentation/android/map#map_padding)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-23T21:59:57.063

这可能不是最好的解决方案，但您可以将自己的按钮放在地图上并自己处理。它将采取以下措施：-

1) 将地图放入 frameLayout 并在顶部添加按钮。例如

```
<FrameLayout
    android:id="@+id/mapFrame"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <fragment
        xmlns:map="http://schemas.android.com/apk/res-auto"
        android:id="@+id/mapFragment"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        class="com.google.android.gms.maps.MapFragment"
        map:mapType="normal"
        map:uiCompass="true" />

    <ImageButton
        android:id="@+id/myMapLocationButton"
        android:layout_width="36dp"
        android:layout_height="36dp"
        android:layout_gravity="bottom|right"
        android:background="@drawable/myMapLocationDrawable"
        android:contentDescription="My Location" />

</FrameLayout> 
```

2) 编辑地图 UI 设置，这样当您调用 setMyLocationEnabled(true) 时按钮不会出现。您可以通过 map.getUiSettings() 执行此操作。setMyLocationButtonEnabled(false);

3）处理新按钮的单击以模拟提供的按钮的作用。例如调用 mMap.setMyLocationEnabled(...); 并将地图平移到当前位置。

希望对您有所帮助，或者希望有人为您提供更简单的解决方案；-)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-02-22T05:37:35.093

上面已经解释过了。只是对 fabLouis 的回答的一个小补充。您也可以从 SupportMapFragment 获取地图视图。

```
 /**
         * Move the button
         */
        SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager().
                findFragmentById(R.id.map);
        View mapView = mapFragment.getView();
        if (mapView != null &&
                mapView.findViewById(1) != null) {
            // Get the button view
            View locationButton = ((View) mapView.findViewById(1).getParent()).findViewById(2);
            // and next place it, on bottom right (as Google Maps app)
            RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams)
                    locationButton.getLayoutParams();
            // position on right bottom
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_TOP, 0);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, RelativeLayout.TRUE);
            layoutParams.setMargins(0, 0, 30, 30);
        } 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-10-02T10:51:47.690

我不喜欢看到其他人正在使用的这些神奇视图 ID，我建议使用标签来查找`MapView`s 孩子。

这是我将“**我的位置”**按钮放在**缩放**控件上方的解决方案。

```
// Get map views
View location_button =_mapView.findViewWithTag("GoogleMapMyLocationButton");
View zoom_in_button = _mapView.findViewWithTag("GoogleMapZoomInButton");
View zoom_layout = (View) zoom_in_button.getParent();

// adjust location button layout params above the zoom layout
RelativeLayout.LayoutParams location_layout = (RelativeLayout.LayoutParams) location_button.getLayoutParams();
location_layout.addRule(RelativeLayout.ALIGN_PARENT_TOP, 0);
location_layout.addRule(RelativeLayout.ABOVE, zoom_layout.getId()); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2016-08-27T07:31:17.907

我通过使用下面的代码将我的位置按钮重新定位到视图的右下角解决了我的地图片段中的这个问题，这是我的 Maps Activity.java ：-

在 onCreate() 方法中添加这行代码，

```
 SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager()
                .findFragmentById(R.id.map);
        mapView = mapFragment.getView();
        mapFragment.getMapAsync(this); 
```

这是 onMapReady() 代码：-

```
@Override
        public void onMapReady(GoogleMap googleMap) {
            mMap = googleMap;
            mMap.setMyLocationEnabled(true);

            // Add a marker in Sydney and move the camera
            LatLng sydney = new LatLng(-34, 151);
            mMap.addMarker(new MarkerOptions().position(sydney).title("Marker in Sydney"));
            mMap.moveCamera(CameraUpdateFactory.newLatLng(sydney));

            if (mapView != null &&
                    mapView.findViewById(Integer.parseInt("1")) != null) {
                // Get the button view
                View locationButton = ((View) mapView.findViewById(Integer.parseInt("1")).getParent()).findViewById(Integer.parseInt("2"));
                // and next place it, on bottom right (as Google Maps app)
                RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams)
                        locationButton.getLayoutParams();
                // position on right bottom
                layoutParams.addRule(RelativeLayout.ALIGN_PARENT_TOP, 0);
                layoutParams.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, RelativeLayout.TRUE);
                layoutParams.setMargins(0, 0, 30, 30);
            }

        } 
```

我希望，这将解决您的问题。谢谢。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-12-09T10:14:31.203

首先，获取谷歌地图视图：

```
 View mapView = ((MapFragment) getFragmentManager().findFragmentById(R.id.map)).getView(); 
```

然后找到 MyLocation 按钮（来自 Android Studio 调试器的 ID）：

```
 View btnMyLocation = ((View) mapView.findViewById(1).getParent()).findViewById(2); 
```

最后，只需为 MyLocation 按钮设置新的 RelativeLayout 参数（在这种情况下垂直对齐父级+中心）：

```
RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(80,80); // size of button in dp
    params.addRule(RelativeLayout.ALIGN_PARENT_RIGHT, RelativeLayout.TRUE);
    params.addRule(RelativeLayout.CENTER_VERTICAL, RelativeLayout.TRUE);
    params.setMargins(0, 0, 20, 0);
    btnMyLocation.setLayoutParams(params); 
```

繁荣！现在你可以随意移动它了；）

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-04-27T12:19:59.983

如果您只想启用位置指示（蓝点）但不需要默认的“我的位置”按钮：

```
mGoogleMap.setMyLocationEnabled(true);
mGoogleMap.getUiSettings().setMyLocationButtonEnabled(false); 
```

这样你也可以在你想要的地方绘制你自己的按钮，而不用像这样奇怪的东西`mapView.findViewById(1).getParent())`。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-02-27T10:31:42.200

请参阅下面的方法。它存在于扩展 SupportMapFragment 的类中。它获取按钮的容器视图并将其显示在底部，水平居中。

```
/**
     * Move my position button at the bottom of map
     */
    private void resetMyPositionButton()
    {
        //deep paths for map controls
        ViewGroup v1 = (ViewGroup)this.getView();
        ViewGroup v2 = (ViewGroup)v1.getChildAt(0);
        ViewGroup v3 = (ViewGroup)v2.getChildAt(0);
        ViewGroup v4 = (ViewGroup)v3.getChildAt(1);

        //my position button
        View position =  (View)v4.getChildAt(0);

        int positionWidth = position.getLayoutParams().width;
        int positionHeight = position.getLayoutParams().height;

        //lay out position button
        RelativeLayout.LayoutParams positionParams = new RelativeLayout.LayoutParams(positionWidth,positionHeight);
        int margin = positionWidth/5;
        positionParams.setMargins(0, 0, 0, margin);
        positionParams.addRule(RelativeLayout.CENTER_HORIZONTAL, RelativeLayout.TRUE);
        positionParams.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM, RelativeLayout.TRUE);
        position.setLayoutParams(positionParams);
    } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-17T17:36:58.120

让这个工作有点困难。但我完成了，在这个过程中也开始移动缩放按钮。这是我的完整代码：

```
package com.squirrel.hkairpollution;

import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.RelativeLayout;

import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.UiSettings;
import com.google.android.gms.maps.model.LatLng;

public class MySupportMapFragment extends SupportMapFragment {

private static final String TAG = HKAirPollution.TAG;

public MySupportMapFragment() {
    return;
}

@Override
public View onCreateView(LayoutInflater arg0, ViewGroup arg1, Bundle arg2) {
    Log.v(TAG, "In overridden onCreateView.");
    View v = super.onCreateView(arg0, arg1, arg2);
    Log.v(TAG, "Initialising map.");
    initMap();
    return v;
}

@Override
 public void onViewCreated (View view, Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);
    resetButtons();
}

private void initMap(){
    UiSettings settings = getMap().getUiSettings();
    settings.setAllGesturesEnabled(true);
    settings.setMyLocationButtonEnabled(true);
    LatLng latLong = new LatLng(22.320542, 114.185715);
    getMap().moveCamera(CameraUpdateFactory.newLatLngZoom(latLong,11));
}

/**
 * Move my position button at the bottom of map
 */
private void resetButtons()
{
    // Get a reference to the zoom buttons and the position button.
    ViewGroup v1 = (ViewGroup)this.getView();
    ViewGroup v2 = (ViewGroup)v1.getChildAt(0);
    ViewGroup v3 = (ViewGroup)v2.getChildAt(0);
    ViewGroup v4 = (ViewGroup)v3.getChildAt(1);

    // The My Position button
    View position =  (View)v4.getChildAt(0);
    int positionWidth = position.getLayoutParams().width;
    int positionHeight = position.getLayoutParams().height;

    // Lay out the My Position button.
    RelativeLayout.LayoutParams positionParams = new RelativeLayout.LayoutParams(positionWidth,positionHeight);
    int margin = positionWidth/5;
    positionParams.setMargins(0, 0, 0, margin);
    positionParams.addRule(RelativeLayout.CENTER_HORIZONTAL, RelativeLayout.TRUE);
    positionParams.addRule(RelativeLayout.ALIGN_PARENT_TOP, RelativeLayout.TRUE);
    position.setLayoutParams(positionParams);

    // The Zoom buttons
    View zoom = (View)v4.getChildAt(2);
    int zoomWidth = zoom.getLayoutParams().width;
    int zoomHeight = zoom.getLayoutParams().height;

    // Lay out the Zoom buttons.
    RelativeLayout.LayoutParams zoomParams = new RelativeLayout.LayoutParams(zoomWidth, zoomHeight);
    zoomParams.setMargins(0, 0, 0, margin);
    zoomParams.addRule(RelativeLayout.ALIGN_PARENT_RIGHT, RelativeLayout.TRUE);
    zoomParams.addRule(RelativeLayout.ALIGN_PARENT_TOP, RelativeLayout.TRUE);
    zoom.setLayoutParams(zoomParams);
} 
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-01-28T06:15:58.820

我有同样的问题。我最终使用 Hierarchy Viewer 来识别用于显示按钮的视图并对其进行操作。非常hacky，我知道，但无法找出不同的方法。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-04-29T08:35:38.830

处理这个问题的一种方法。删除默认按钮并创建自己的。在 OnCreate 语句中添加下一个：

```
GoogleMap mMap = ((MapView) inflatedView.findViewById(R.id.mapview)).getMap();
LocationManager locationManager =    
(LocationManager)getActivity().getSystemService(Context.LOCATION_SERVICE);
Criteria criteria = new Criteria();
String provider = locationManager.getBestProvider(criteria, false);
Location location = locationManager.getLastKnownLocation(provider);
locationManager.requestLocationUpdates(provider, 2000, 1,  this);

mMap.setMyLocationEnabled(true);
mMap.getUiSettings().setMyLocationButtonEnabled(false); // delete default button

Imagebutton imgbtn = (ImageButton) view.findViewById(R.id.imgbutton); //your button
imgbtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(new    
LatLng(location.getLatitude(),     
location.getLongitude()), 15));
        }
    }); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-02-15T13:13:45.820

试试这个代码

```
private void resetMyPositionButton()
{
    Fragment fragment = ( (SupportMapFragment) getSupportFragmentManager().findFragmentById( R.id.map ) );
    ViewGroup v1 = (ViewGroup) fragment.getView();
    ViewGroup v2 = (ViewGroup)v1.getChildAt(0);
    ViewGroup v3 = (ViewGroup)v2.getChildAt(2);
    View position =  (View)v3.getChildAt(0);
    int positionWidth = position.getLayoutParams().width;
    int positionHeight = position.getLayoutParams().height;

    //lay out position button
    RelativeLayout.LayoutParams positionParams = new RelativeLayout.LayoutParams(positionWidth,positionHeight);
    int margin = positionWidth/5;
    positionParams.setMargins(margin, 0, 0, margin);
    positionParams.addRule(RelativeLayout.CENTER_VERTICAL, RelativeLayout.TRUE);
    positionParams.addRule(RelativeLayout.ALIGN_PARENT_LEFT, RelativeLayout.TRUE);
    position.setLayoutParams(positionParams);
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-09-17T03:42:25.597

[![这个按钮被移到了地图的左侧](../Images/74fa4578a7e22fc1c4fc963c5cbb26b2.png)](https://i.stack.imgur.com/2kP72.jpg)之前，您可以删除按钮的旧规则：

```
@Override
public void onMapReady(final GoogleMap googleMap) {
    this.map = googleMap;
    // Show location button
    View locationButton = ((View) mapView.findViewById(Integer.parseInt("1")).getParent()).findViewById(Integer.parseInt("2"));
    RelativeLayout.LayoutParams rlp = (RelativeLayout.LayoutParams) locationButton.getLayoutParams();
    // position on right bottom
    Log.l(Arrays.toString(rlp.getRules()), L.getLogInfo());
    int[] ruleList = rlp.getRules();
    for (int i = 0; i < ruleList.length; i ++) {
        rlp.removeRule(i);
    }
    Log.l(Arrays.toString(rlp.getRules()), L.getLogInfo());
    //Do what you want to move this location button:
    rlp.addRule(RelativeLayout.CENTER_IN_PARENT, RelativeLayout.TRUE);
    rlp.addRule(RelativeLayout.ALIGN_PARENT_LEFT, RelativeLayout.TRUE);
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-05T06:42:17.830

您可以使用以下方法：

```
 View myLocationParent = ((View) getView().findViewById(1).getParent());
    View myLocationParentParent = ((View) myLocationParent.getParent());

    // my position button

    int positionWidth = myLocationParent.getLayoutParams().width;
    int positionHeight = myLocationParent.getLayoutParams().height;

    // lay out position button
    FrameLayout.LayoutParams positionParams = new FrameLayout.LayoutParams(
            positionWidth, positionHeight);
    positionParams.setMargins(0, 100, 0, 0);

    myLocationParent.setLayoutParams(positionParams); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-09-24T23:37:43.560

我在片段中添加了一行 **android:layout_marginTop="?attr/actionBarSize"** 它帮助了我

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-10-19T22:32:32.177

将此用于右下角位置

```
map.setMyLocationEnabled(true); 
map.setPadding(0,1600,0,0); 
```

# ruby-on-rails - Rails jquery fullcalendar无法在事件中显示额外的字段

> ID：14489881
> 
> 赞同：0
> 
> 时间：2013-01-23T21:38:33.027
> 
> 标签：ruby-on-rails, fullcalendar

我在 rails 应用程序中使用 jquery fullcalendar。目前它在月份显示中显示 event.title 字段。我希望它也显示和附加字段 = workorder.wonum

我在 Stackoverflow 上找到了这个解决方案。

```
eventRender: (event, element) ->
  element.find(".fc-event-title").html(event.title + ": <span>" + event.workorder.wonum + "</span>") 
```

该代码显示 event.title，然后显示“未定义”。如果我将 event.workorder.wonum 更改为 event.description --> 就可以了。

我可以通过更改创建 json 的控制器中的 event.title 来做到这一点吗？

像这样的东西（它不起作用）：

```
respond_to do |format|
  format.json { render json: @events, :only => [:title => :title + :workworder.wonum] }
end 
```

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T00:08:20.707

我终于弄明白了。

解决方案是将 workorder.wonum 与标题结合起来：

```
 # need to override the json view to return what full_calendar is expecting.
 # http://arshaw.com/fullcalendar/docs/event_data/Event_Object/
 def as_json(options = {})
  {
    :id => self.id,
    :title => "#{self.workorder.wonum} #{self.title}",
    :description => self.description || "",
    :start => starts_at.rfc822,
    :end => ends_at.rfc822,
    :allDay => self.all_day,
    :recurring => false,
    :url => Rails.application.routes.url_helpers.event_path(id),
    :color => "blue",
    :backgroundColor => "blue",
    :borderColor => "black",
    :textColor  => "white"
 }

end 
```

# javascript - 在 head 部分的 window.load 函数中包含脚本标签

> ID：14489883
> 
> 赞同：2
> 
> 时间：2013-01-23T21:38:46.057
> 
> 标签：javascript, jquery, ajax

```
<head>

<script type="text/javascript"> 
  $(window).load(function() {      

    // <script src="js/external.js"></script> //

  });    
</script>

</head> 
```

如何在 window.load 函数中包含脚本标签（< script src="js/external.js"></script>）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:42:19.823

你可以这样做：

```
<script type="text/javascript"> 
    (function($){    
        $(window).load(function() {      
            $.getScript('js/external.js');
        });
    })(jQuery);    
</script> 
```

# java - 运行时错误：运行 java 类文件

> ID：14489887
> 
> 赞同：2
> 
> 时间：2013-01-23T21:39:07.523
> 
> 标签：java, javac

我已经从网上下载了一个简单的 java 示例。我正在尝试编译下面给出的代码

```
package ArrayList;
import java.util.ArrayList;

public class SimpleArrayListExample {

    public static void main(String[] args) {

        //create an ArrayList object
        ArrayList<String> arrayList = new ArrayList<String>();

        /*
        Add elements to Arraylist using
        boolean add(Object o) method. It returns true as a general behavior
        of Collection.add method. The specified object is appended at the end
        of the ArrayList.
         */
        arrayList.add("1");
        arrayList.add("2");
        arrayList.add("3");

        /*
        Use get method of Java ArrayList class to display elements of ArrayList.
        Object get(int index) returns and element at the specified index in
        the ArrayList
         */
        System.out.println("Getting elements of ArrayList");
        System.out.println(arrayList.get(0));
        System.out.println(arrayList.get(1));
        System.out.println(arrayList.get(2));
    }
} 
```

我已经按照你的建议编辑了程序，我可以编译并得到类文件。

```
java SimpleArrayListExample.java 
```

现在我正在尝试使用

```
java -classpath . ArrayList.SimpleArrayListExample.java 
```

线程“主”java.lang.NoClassDefFoundError 中的异常

我谷歌发现我必须指定 -classpath 。

> [http://www.tech-recipes.com/rx/826/java-exception-in-thread-main-javalangnoclassdeffounderror/](http://www.tech-recipes.com/rx/826/java-exception-in-thread-main-javalangnoclassdeffounderror/) 似乎无法解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:40:34.603

编译器*警告*集合中包含的类型尚未声明。您可以使用泛型来消除此警告

```
ArrayList<String> arrayList = new ArrayList<String>(); 
```

**编辑：**

你的包结构有问题。`SimpleArrayListExample`不在名为 的目录中`ArrayList`。修理

*   移动`SimpleArrayListExample.java`到一个名为`ArrayList`.
*   编译使用： -`javac ArrayList/SimpleArrayListExample.java`
*   跑步：`java ArrayList.SimpleArrayListExample`

注意包名通常使用*小写*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T21:41:22.447

这不是编译错误；相反，它是一个*编译警告*。这意味着它仍然可以编译，但建议修复警告。

在这种情况下，这是因为您`ArrayList`缺少泛型类型。您应该将其声明为 an `ArrayList<String>`，因为您只是向其添加字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T21:40:42.623

您可以使用泛型来避免此警告：

```
public static void main(String[] args) {

    //create an ArrayList object
    ArrayList<String> arrayList = new ArrayList<String>();

    //...
} 
```

如果您不想使用泛型，也可以禁止显示警告：

```
@SuppressWarnings("unchecked")
public static void main(String[] args) {
    //...
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-23T21:40:44.537

通过为您的集合提供泛型类型来限制您的集合，或者换句话说使您的集合**类型安全**（仅编译时），警告将消失

```
 ArrayList<String> arrayList = new ArrayList<String>(); 
```

由于引入了**类型推断**，也来自**Java 7**

 **```
 ArrayList<String> arrayList = new ArrayList<>(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-23T21:42:28.800

这不是错误，而是警告。

这是因为您使用的 ArrayList 没有泛型类型。

您可能想阅读有关泛型的更多信息：http: [//docs.oracle.com/javase/tutorial/java/generics/](http://docs.oracle.com/javase/tutorial/java/generics/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-23T21:40:01.050

使其成为`ArrayList<String>`.

这称为*泛型集合*，这意味着它是一个可以使用类型参数化的集合，以存储和检索该类型的对象。

所以，如果你指定你希望它存储`String`，编译器会知道它也会返回`String`。如果您不指定任何内容，它本质上会退回到`Object`，这意味着它可以存储任何内容（非标量）并检索任何内容（这反过来又会使编译器跳跃）。**

# linux - 使用 WGET 从网站/目录下载所有 .tar.gz 文件

> ID：14489889
> 
> 赞同：5
> 
> 时间：2013-01-23T21:39:11.643
> 
> 标签：linux, bash, download, wget

所以我正在尝试创建一个别名/脚本来使用 wget 从网站/目录下载所有特定扩展，但我觉得必须有比我想出的更简单的方法。

现在我从搜索谷歌和手册页中得到的代码是：

```
wget -r -l1 -nH --cut-dirs=2 --no-parent -A.tar.gz --no-directories http://download.openvz.org/template/precreated/ 
```

因此，在上面的示例中，我尝试从 OpenVZ 预创建的模板目录下载所有 .tar.gz 文件。

上面的代码可以正常工作，但我必须手动指定 --cut-dirs=2 ，它会删除通常会创建的 /template/precreated/ 目录结构，它还会下载 robots.txt 文件。

现在这不一定是问题，只需删除 robots.txt 文件很容易，但我希望我只是错过了手册页中的一些内容，这些内容允许我在不指定要删除的目录结构的情况下执行相同的操作.. .

感谢您提前提供任何帮助，非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T22:00:44.903

使用`-R`选项

```
-R robots.txt,unwanted-file.txt 
```

作为您不想要的文件的拒绝列表（逗号分隔）。

至于编写脚本：

```
URL=http://download.openvz.org/template/precreated/
CUTS=`echo ${URL#http://} | awk -F '/' '{print NF -2}'`
wget -r -l1 -nH --cut-dirs=${CUTS} --no-parent -A.tar.gz --no-directories -R robots.txt ${URL} 
```

这应该根据您的 URL 中的子目录起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T21:47:31.367

我建议，如果这真的很烦人并且您必须做很多事情，只需编写一个非常短的两行脚本来为您删除它：

```
wget -r -l1 -nH --cut-dirs=2 --no-parent -A.tar.gz --no-directories http://download.openvz.org/template/precreated/
rm robots.txt 
```

# rubymine - RubyMine 中针对代码样式、拼写等的项目范围报告？

> ID：14489890
> 
> 赞同：0
> 
> 时间：2013-01-23T21:39:16.903
> 
> 标签：rubymine

在 RubyMine 编辑器中，它会标记诸如 ruby​​ 样式问题、可能的拼写错误等。我正在 RubyMine 中寻找一种方法来获取有关这些编码问题的整个项目范围的报告。RubyMine 中是否存在这样的东西（或添加到 RubyMine 中的东西）？如果是这样，我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:28:16.630

You can find it in the main menu: Code | Inspect Code...

# java - Seam 2.3.0 的 JBoss AS 7 模块？

> ID：14489891
> 
> 赞同：0
> 
> 时间：2013-01-23T21:39:24.013
> 
> 标签：java, jboss, module, seam, jboss7.x

我已经成为 JBoss AS7 用于在应用程序中指定依赖关系的模块机制的忠实粉丝。它极大地减少了我们部署的 EAR 文件的大小，并且使我们能够非常轻松地部署具有相同依赖项的多个应用程序。然而，到目前为止，我们自己创建的模块非常小而且简单。然而，现在我们想为 JBoss Seam 2.3.0 使用一个 JBoss 模块。

有谁知道可以解释我们如何做到最好的资源？Seam 是一个巨大的框架，它自己有很多依赖项。到目前为止，我们一直将 JAR 直接放在 EAR/WAR 文件中。我们想摆脱这种情况。任何人都可以就如何正确地为 Seam 2.3.0 创建 JBoss AS7 模块提供任何帮助吗？正确地说，我的意思是正确引用 JBoss 中的附加模块、正确分段等。

您可以提供的任何建议或指导将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T19:35:11.883

您需要分三个步骤执行此操作：

1.  使用像 Maven 这样的构建自动化工具并包含以下内容来声明运行时依赖项：

    ```
    <build>
      <plugins>
        <plugin>
           <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-war-plugin</artifactId>
           <version>2.1.1</version>
           <configuration>
             <archive>
               <manifestEntries>
                 <Dependencies>org.slf4j,org.apache.httpcomponents</Dependencies>
               </manifestEntries>
             </archive> 
    ```

2.  像这样输入的依赖项将提供 JBoss 7.1 中可用模块的可见性，以便您可以将它们从您的战争包装中排除。您在编译时仍然需要它们，因此您可以将它们的范围设置为`provided`- Maven 将自动不打包它们。

3.  我不会向 JBoss 添加任何自定义模块，但如果您想要这种类型的架构，那么您需要创建新模块或现有模块的不同版本以满足您的依赖关系，然后将它们包含在上面的清单条目中。

# android - 通过 youtube 使用 Google Play 服务

> ID：14489895
> 
> 赞同：0
> 
> 时间：2013-01-23T21:39:41.953
> 
> 标签：android, youtube-api, google-oauth

我正在尝试 在我的 android 应用程序中使用新的 Youtube API V3： [https ://developers.google.com/youtube/v3/。](https://developers.google.com/youtube/v3/)

为了让用户登录 youtube 服务，我选择了新的 Google Play 服务：http: [//developer.android.com/google/play-services/index.html](http://developer.android.com/google/play-services/index.html)

这是我的代码：

```
AccountManager manageurcomptes = AccountManager.get(ActiviteGeneral.this);
Account[] comptes = manageurcomptes
                        .getAccountsByType(GoogleAuthUtil.GOOGLE_ACCOUNT_TYPE);
String jeton;
try {
    jeton = GoogleAuthUtil.getToken(ActiviteGeneral.this, comptes[0].name,
        "audience:server:client_id:xxxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com");
    int i = 0;
} catch (IOException e) {
     // TODO Auto-generated catch block
     e.printStackTrace();
} catch (GoogleAuthException e) {
     // TODO Auto-generated catch block
     e.printStackTrace(); 
```

对于 GoogleAuthUtil.getToken 范围参数，我遵循了来自 Android 开发者博客的文章：“验证来自 Android 应用程序的后端调用” [http://android-developers.blogspot.fr/2013/01/verifying-back-end-calls -from-android.html](http://android-developers.blogspot.fr/2013/01/verifying-back-end-calls-from-android.html)并在 Google API 控制台上注册了我的应用程序。

我创建了一个“已安装应用程序的客户端 ID”。

结果是带有“detailMessage”=“未知”的 GoogleAuthException。

错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:23:34.903

我做了一个例子，展示了如何从运行良好的 Android 应用程序访问 YouTube API v3：

[http://lookthiscode.blogspot.com.ar/2013/01/utilizando-youtube-data-api-v3-desde.html](http://lookthiscode.blogspot.com.ar/2013/01/utilizando-youtube-data-api-v3-desde.html)

实际上这个例子是基于官方的例子，展示了如何从一个 Android 应用程序中使用任务 API。我修改了示例以使用 YouTube API 身份验证范围。

这篇文章是西班牙文，但您可以使用文章末尾的链接下载项目的源代码。

解决您的问题的主要代码如下：

```
// Google Accounts
credential = GoogleAccountCredential.usingOAuth2(this, YouTubeScopes.YOUTUBE, YouTubeScopes.YOUTUBE_READONLY);
SharedPreferences settings = getPreferences(Context.MODE_PRIVATE);
credential.setSelectedAccountName(settings.getString(PREF_ACCOUNT_NAME, null));
// YouTube client
service =
        new com.google.api.services.youtube.YouTube.Builder(transport, jsonFactory, credential)
            .setApplicationName("Google-YouTubeAndroidSample/1.0").build(); 
```

# hibernate - 休眠查询简单的答案

> ID：14489898
> 
> 赞同：0
> 
> 时间：2013-01-23T21:39:52.873
> 
> 标签：hibernate, entity, criteria

我正在研究休眠。我有一个这样的@Entity：

实体 A：

```
int category; //1 2 or 3

List<B> B_list; 
```

实体 B：

```
String word; 
```

现在我想要做的是给定一个 A 类别和一个单词，我想返回所有与该类别匹配的 A，并且在它的 B_list 中有一个 B，单词等于参数单词。

这就是我所拥有的：

```
public List<A> getAs(int category,String word){
Criteria crit = session.createCriteria(A.class);
    crit.add(Restrictions.eq("category",category));

        crit.add(Restrictions.//something to look for B);

        List<A> cats = crit.list();
        return cats;
 } 
```

我有我的会议，一切都井井有条:) 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T06:55:57.833

我没有使用标准查询，但如果它是 hql 或 jpql，我会加入 B 和表达式。IE

```
From A a join a.b_list b where a.category = : category and a.word = :word and b.<field name> = :word 
```

换句话说，你需要在 b_list 上加入 B 并且你可以引用它的字段。

希望这会为您指明正确的方向。

编辑：您可以使用条件查询以及[使用 JPA 2](http://docs.oracle.com/javaee/6/tutorial/doc/gjivm.html#gjiuv)或[Hibernate进行连接](http://docs.jboss.org/hibernate/entitymanager/3.5/reference/en/html/querycriteria.html#querycriteria-from-join)

# javascript - 添加更多文本字段

> ID：14489913
> 
> 赞同：0
> 
> 时间：2013-01-23T21:40:41.990
> 
> 标签：javascript, google-apps-script, google-sheets

我在这里找到的电子表格中有一个搜索脚本。我明白大部分但不是全部。我想要的是添加更多显示该数据的文本框。我尝试添加下面的行，但我得到了`TypeError: Cannot call method "add" of undefined. (line 41)`

第 41 行包含`hpanel3.add(label4).add(label5).add(label6).add(label7)`这只是上面代码的副本，具有不同的数字。脚本可以在没有这些行的情况下工作。

```
// G. Variables
var sh = SpreadsheetApp.getActiveSheet();
var ss = SpreadsheetApp.getActiveSpreadsheet();
var lastrow = ss.getLastRow();
//
function onOpen() {
  var menuEntries = [ {name: "Search GUI", functionName: "searchUI"},
                     ];
  ss.addMenu("Search Utilities",menuEntries);// custom menu
}
// Build a simple UI to enter search item and show results + activate result's row
function searchUI() {
  var app = UiApp.createApplication().setHeight(200).setWidth(600);
  app.setTitle("Search by anything");
  var panel = app.createVerticalPanel();
  var txtBox = app.createTextBox().setFocus(true);
  var label=app.createLabel(" Item to search for :")
  panel.add(label);
  txtBox.setId("item").setName("item");
//
  var label0=app.createLabel("Row").setWidth("40");
  var label1=app.createLabel("Name").setWidth("120");
  var label2=app.createLabel("ID").setWidth("120");
  var label3=app.createLabel("Street").setWidth("200");
  var hpanel = app.createHorizontalPanel();
  hpanel.add(label0).add(label1).add(label2).add(label3)
//
  var txt0=app.createTextBox().setId("lab0").setName("0").setWidth("40");
  var txt1=app.createTextBox().setId("lab1").setName("txt1").setWidth("120");
  var txt2=app.createTextBox().setId("lab2").setName("txt2").setWidth("120");
  var txt3=app.createTextBox().setId("lab3").setName("txt3").setWidth("250");
  var hpanel2 = app.createHorizontalPanel();
  hpanel2.add(txt0).add(txt1).add(txt2).add(txt3)
//                   
//
//  var label4=app.createLabel("Phone").setWidth("120");
//  var label5=app.createLabel("Pet Name").setWidth("120");
//  var label6=app.createLabel("Breed").setWidth("120");
//  var label7=app.createLabel("Gender").setWidth("120");
//  var hpanel = app.createHorizontalPanel();
//  hpanel3.add(label4).add(label5).add(label6).add(label7)
////
//  var txt4=app.createTextBox().setId("lab4").setName("txt4").setWidth("40");
//  var txt5=app.createTextBox().setId("lab5").setName("txt5").setWidth("120");
//  var txt6=app.createTextBox().setId("lab6").setName("txt6").setWidth("120");
//  var txt7=app.createTextBox().setId("lab7").setName("txt7").setWidth("250");
//  var hpanel3 = app.createHorizontalPanel();
//  hpanel4.add(txt4).add(txt5).add(txt6).add(txt7)
//
  var hidden = app.createHidden().setName("hidden").setId("hidden");
  var subbtn = app.createButton("next ?").setId("next").setWidth("250");
  var link = app.createAnchor('', '').setId('link');
  panel.add(txtBox);
  panel.add(subbtn);
  panel.add(hidden);
  panel.add(hpanel);
  panel.add(hpanel2);
//  panel.add(hpanel3);
//  panel.add(hpanel4);
  panel.add(link);
  var keyHandler = app.createServerHandler("click");
  txtBox.addKeyUpHandler(keyHandler)
  keyHandler.addCallbackElement(panel);
//
  var submitHandler = app.createServerHandler("next");
  subbtn.addClickHandler(submitHandler);
  submitHandler.addCallbackElement(panel);
//
  app.add(panel);  
  ss.show(app);
  }
//
function click(e){
   var row=ss.getActiveRange().getRowIndex();              
   var app = UiApp.getActiveApplication();
   var txtBox = app.getElementById("item");
   var subbtn = app.getElementById("next").setText("next ?")      
   var txt0=app.getElementById("lab0").setText('--');
   var txt1=app.getElementById("lab1").setText('no match').setStyleAttribute("background", "white");// default value to start with
   var txt2=app.getElementById("lab2").setText('');
   var txt3=app.getElementById("lab3").setText('');     
//   var txt4=app.getElementById("lab4").setText('');
//   var txt5=app.getElementById("lab5").setText('');
//   var txt6=app.getElementById("lab6").setText('');
//   var txt7=app.getElementById("lab7").setText('');
   var link=app.getElementById('link').setText('').setHref('')
   var item=e.parameter.item.toLowerCase(); // item to search for
   var hidden=app.getElementById("hidden")                  
   var data = sh.getRange(3,1,lastrow,18).getValues();// get the 18 columns of data
       for(nn=0;nn<data.length;++nn){ ;// iterate trough
         if(data[nn].toString().toLowerCase().match(item.toString())==item.toString()&&item!=''){;// if a match is found in one of the 18 fields, break the loop and show results
          txt0.setText(nn+3);
          txt1.setText(data[nn][0]).setStyleAttribute("background", "cyan");
          txt2.setText(data[nn][2]);
          txt3.setText(data[nn][4]);
//          txt4.setText(data[nn][5]);
//          txt5.setText(data[nn][6]);
//          txt6.setText(data[nn][7]);
//          txt7.setText(data[nn][8]);
          link.setText(data[nn][0]).setHref(data[nn][0]);
          sh.getRange(nn+3,1).activate();
          subbtn.setText("found '"+item+"' in row "+Number(nn+3)+", next ?");
          hidden.setValue(nn.toString())                                                                                  
          break
          }
      }
return app    ;// update UI
}
function next(e){
   var row=ss.getActiveRange().getRowIndex();              
   var app = UiApp.getActiveApplication();
   var txtBox = app.getElementById("item");
   var subbtn = app.getElementById("next").setText("no other match")      
   var hidden=app.getElementById("hidden");                  
   var start=Number(e.parameter.hidden)+1;//returns the last search index stored in the UI
   var item=e.parameter.item.toLowerCase(); // item to search for
   var txt0=app.getElementById("lab0");
   var txt1=app.getElementById("lab1").setStyleAttribute("background", "yellow");
   var txt2=app.getElementById("lab2");
   var txt3=app.getElementById("lab3");
   var link=app.getElementById('link').setText('').setHref('')
   var data = sh.getRange(3,1,lastrow,18).getValues();// get the 18 columns of data
       for(nn=start;nn<data.length;++nn){ ;// iterate trough
         if(data[nn].toString().toLowerCase().match(item.toString())==item.toString()&&item!=''){;// if a match is found in one of the 4 fields, break the loop and show results
          txt0.setText(nn+3);
          txt1.setText(data[nn][0]).setStyleAttribute("background", "cyan");
          txt2.setText(data[nn][2]);
          txt3.setText(data[nn][4]);
          link.setText(data[nn][0]).setHref(data[nn][0])
          sh.getRange(nn+3,1).activate();
          subbtn.setText("found '"+item+"' in row "+Number(nn+3)+", next ?");                                                                                               
          hidden.setValue(nn.toString())                                                                                  
          break
          }
      }
return app    ;// update UI
} 
```

任何帮助都非常有用。就像我说的，我了解很多发生的事情，但我永远无法从头开始。这是一张狗牌清单。我是一名动物控制官，当我找到一只流浪狗时，我的调度员会用它来寻找狗的主人，而不必去收容所。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T15:03:23.187

“已定义”表示已为当前范围内的变量赋予了值。如果您在调试器中观看，您将看到所有在范围内“声明”的变量，即使它们尚未定义。

您对各种`hpanel`s 的定义以错误的顺序发生。在第 41 行，您还没有定义`hpanel3`. （错误消息并没有骗你！）看来你打算在第 40 行定义它，但你*重新定义* `hpanel`了.

稍后，第 47 行定义了`hpanel3`，但随后第 48 行尝试分配给`hpanel4`尚未定义的 。这将给出相同的错误。

^([顺便说一句，您不需要将评论放在空白行中……它们可以是空白的。])

# asp.net-mvc-4 - 有没有更好的方法来设置空白显示注释？

> ID：14489918
> 
> 赞同：0
> 
> 时间：2013-01-23T21:40:50.323
> 
> 标签：asp.net-mvc-4, data-annotations

在一个 MVC4 项目中，我在模型上使用数据注释，但有 4 行地址字段（即地址 1、地址 2 等），我只想用*地址*标记第一行，随后的行为空白或不标记. 如果您省略*Display*注释，则字段名称将作为标签返回，因此我尝试了：

```
[Display(Name="")] 
```

但我为此得到了黄屏：

```
Value cannot be null.
Parameter name: value 
```

据此，[我](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.displayattribute.name.aspx) 应该能够在 Name 值中设置和清空字符串或 null，但这显然没有发生，所以我最终只是在 Name 值中放了一个空格，例如：

```
[Display(Name=" ")] 
```

这行得通 - 但它并不优雅。在我看来，应该有更好的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T04:46:36.040

根据 msdn [DISplayAttribute.Name](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.displayattribute.name.aspx)

> 不要使用此属性来获取 Name 属性的值。请改用 GetName 方法。空值或空字符串有效。

```
[Display(Name=string.Empty)] //may be this will work. 
```

# c++ - 通过策略（策略）模式启用多个后端

> ID：14489919
> 
> 赞同：0
> 
> 时间：2013-01-23T21:40:59.067
> 
> 标签：c++, design-patterns, architecture

研究员：

我正在研究一组算法，这些算法作用于“Body”、“Spacecraft”、“Planet”等类。每个实例的构建都可以通过不同的后端来完成。例如，我可以使用大量库（如 NASA 的 SPICE 系统）计算行星位置，并且我还可以使用大量数据源和库“计算”天体的半径。

我的算法集合应该忽略数据源：例如，如果我想计算日食的时间，我只关心物体的相对位置和它们的半径（不管我从哪里得到这些数字）。

在下面附加的代码中，我使用 Policy 类来参数化两个不同的后端（因为这是一个示例，所以进行了简化）。我有兴趣问以下问题：

*   为此使用策略模式是否合理？
*   如何删除类构造函数中包含的实现细节并将它们移动到 Pimpl 构造函数（参数化 BodyImpl？）

代码有点冗长，但我想“谈谈”我的基本原理。

谢谢你。

我使用 g++ 4.7.2 成功编译了以下代码，如下所示：

```
g++ backends.cpp -std=c++11 -Wall -O2 
```

（请注意，它使用了一些 c++11 结构，例如`auto`）。

```
/**
   Is it reasonable to parameterize different data back-ends using the
   Policy Pattern? 

   The goal is to provide a unified interface to different classes
   (e.g., `Body`, `Star`, `Spacecraft`). However, the construction of
   specific instances requires data which can originate from different
   sources.

   For example, a "Body" has a radius and a gravitational parameter
   (called "gm"). But these values can come from different sources
   (different libraries which provide this kind of information).

   Say that library 1 (called "Spice") is capable of providing the
   radius given the body name:

   double the_radius = compute_radius_with_spice("Mercury");

   On the other hand, you could be using another library, which
   computes the radius with a completely different interface, and with
   completely different requirements:

   double radii[3];
   compute_the_radius_with_another_library("Mercury", radii)
   double the_radius = (radii[0] + radii[1] + radii[2]) / 3.0;

   Of course, the values computed with either library are similar, but
   different enough to make a difference. What matters is CONSISTENCY
   (stick to one back-end).
*/

#include<iostream>
#include<string>
#include<vector>
#include<memory>

/* Say that this is the uniform interface that I want to provide.*/
template<typename DataPolicy>
class Body:
  private DataPolicy{
public: 
  Body(const std::string& name);
  Body(const Body& body);
  ~Body();
  std::string name() const;
  double radius() const;
  double gm() const;
private:
  class BodyImpl * pimpl_;;
  //  std::unique_ptr<BodyImpl> pimpl_;
};

/* I use the pimpl_ idiom to hide the implementation */
struct BodyImpl{
  std::string m_name;
  double m_radius;
  double m_gm;  
  BodyImpl(const std::string& name):
    m_name(name){    
  }
};

/* The constructor has to build the pimpl step by step using the data
   policy as a data source. */
template<typename DataPolicy>
Body<DataPolicy>::Body(const std::string& name):
  pimpl_(new BodyImpl(name)){
  pimpl_->m_radius = DataPolicy::get_radius(name);
  pimpl_->m_gm = DataPolicy::get_gm(name);
}

template<typename DataPolicy>
Body<DataPolicy>::Body(const Body& body):
  pimpl_(new BodyImpl(body.name())){
  pimpl_->m_radius = body.radius();
  pimpl_->m_gm = body.gm();
}

template<typename DataPolicy>
Body<DataPolicy>::~Body(){
  delete pimpl_;
  pimpl_ = 0;
}

/* The methods are simple forwarding calls to the implementation (in
   reality it is not as simple as returning a primitive data type)*/
template<typename DataPolicy>
std::string Body<DataPolicy>::name() const{
  return pimpl_->m_name;
}

template<typename DataPolicy>
double Body<DataPolicy>::radius() const{
  return pimpl_->m_radius;
}

template<typename DataPolicy>
double Body<DataPolicy>::gm() const{
  return pimpl_->m_gm;
}

/* Now I create a concrete data policy - in reality this would be more
   extensive and complex, but the idea remains the same */
struct SPICEDataPolicy{
  static double get_radius(const std::string& name){
    std::cout<<"SPICEDataPolicy: calculating radius for "<<name<<std::endl;
    return 0;
  }
  static double get_gm(const std::string& name){
    std::cout<<"SPICEDataPolicy: calculating gm for "<<name<<std::endl;
    return 0;
  }
};

/* This is another data policy - it provides the same data but it may
   call a completely different underlying library, and calculate the
   values using completely different logic */
struct OtherDataPolicy{
  static double get_radius(const std::string& name){
    std::cout<<"OtherDataPolicy: calculating radius for "<<name<<std::endl;
    return 0;
  }
  static double get_gm(const std::string& name){
    std::cout<<"OtherDataPolicy: calculating gm for "<<name<<std::endl;
    return 0;
  }
};

/* My algorithms can now use the objects via the unified interface */
template<typename T>
void individual_complex_calculation(const Body<T>& body){
  // Regardless of the body's data policy, I know I can call a uniform interface.
  std::cout<<"I am making a complex calculation involving "<<body.name()<<"."<<std::endl
       <<"[This is my radius: "<<body.radius()<<", "
       <<"and this is my gm: "<<body.gm()<<"]"<<std::endl;
}
template<typename T>
void complex_calculation(const std::vector<Body<T> > bodies){
  for(auto it=bodies.begin(), finished=bodies.end(); it!=finished; it++)
    individual_complex_calculation(*it);
}

int main(){  
  /* Now I can create a vector of bodies which are consistent with one
     another */
  std::cout<<"========== Using 'SPICEDataPolicy =========='"<<std::endl;
  std::vector<Body<SPICEDataPolicy> > bodies;
  bodies.push_back(Body<SPICEDataPolicy>("Mercury"));
  bodies.push_back(Body<SPICEDataPolicy>("Venus"));
  bodies.push_back(Body<SPICEDataPolicy>("Earth"));
  bodies.push_back(Body<SPICEDataPolicy>("Mars"));

  complex_calculation(bodies);

  /* And even create other set of bodies consistent with one another,
     but inconsistent with the previous ones.*/
  std::cout<<"========== Using 'OtherDataPolicy' =========="<<std::endl;  
  std::vector<Body<OtherDataPolicy> > other_bodies;
  other_bodies.push_back(Body<OtherDataPolicy>("Mercury"));
  other_bodies.push_back(Body<OtherDataPolicy>("Venus"));
  other_bodies.push_back(Body<OtherDataPolicy>("Earth"));
  other_bodies.push_back(Body<OtherDataPolicy>("Mars"));

  complex_calculation(other_bodies);
  return 0;
} 
```

输出`./a.out`：

```
========== Using 'SPICEDataPolicy =========='
SPICEDataPolicy: calculating radius for Mercury
SPICEDataPolicy: calculating gm for Mercury
SPICEDataPolicy: calculating radius for Venus
SPICEDataPolicy: calculating gm for Venus
SPICEDataPolicy: calculating radius for Earth
SPICEDataPolicy: calculating gm for Earth
SPICEDataPolicy: calculating radius for Mars
SPICEDataPolicy: calculating gm for Mars
I am making a complex calculation involving Mercury.
[This is my radius: 0, and this is my gm: 0]
I am making a complex calculation involving Venus.
[This is my radius: 0, and this is my gm: 0]
I am making a complex calculation involving Earth.
[This is my radius: 0, and this is my gm: 0]
I am making a complex calculation involving Mars.
[This is my radius: 0, and this is my gm: 0]
========== Using 'OtherDataPolicy' ==========
OtherDataPolicy: calculating radius for Mercury
OtherDataPolicy: calculating gm for Mercury
OtherDataPolicy: calculating radius for Venus
OtherDataPolicy: calculating gm for Venus
OtherDataPolicy: calculating radius for Earth
OtherDataPolicy: calculating gm for Earth
OtherDataPolicy: calculating radius for Mars
OtherDataPolicy: calculating gm for Mars
I am making a complex calculation involving Mercury.
[This is my radius: 0, and this is my gm: 0]
I am making a complex calculation involving Venus.
[This is my radius: 0, and this is my gm: 0]
I am making a complex calculation involving Earth.
[This is my radius: 0, and this is my gm: 0]
I am making a complex calculation involving Mars.
[This is my radius: 0, and this is my gm: 0] 
```

# 编辑：

我尝试了另一种基于“特征”和“策略”的实现。感觉干净多了，但我还是很好奇你对它的看法。

以下代码使用与上面相同的命令行参数进行编译。

```
/**
   Multiple back-ends implemented as a mix of trait classes and policies.

   This seems to be a better implementation because there is a clear
   path to extend the different back-ends, and the class front-end is
   completely independent from its back-end.

*/

#include<iostream>
#include<string>
#include<vector>
#include<memory>

// forward declaration of the trait "data_traits"
template<typename T>
struct data_traits{
};

// each class would be defined as follows (with forward declaration of
// its implementation class)
template<typename T>
struct BodyImpl;

template<typename T>
class Body{
public:
  Body(const std::string& name);
  std::string name() const;
  double radius() const;
  double gm() const;
private:
  std::unique_ptr<BodyImpl<T> > pimpl_;
};

// each class would be implemented in a cpp file with the following
// structure (notice full independence from any back-end)
template<typename T>
struct BodyImpl{
  std::string m_name;
  double m_radius;
  double m_gm;
  BodyImpl(const std::string& name):
    m_name(name){
    m_radius = data_traits<T>::get_radius(name);
    m_gm = data_traits<T>::get_gm(name);
  }    
};

/* public interface simply forwards to pimpl */
template<typename T>
Body<T>::Body(const std::string& name):
  pimpl_(new BodyImpl<T>(name)){
}

template<typename T>
std::string Body<T>::name() const{
  return pimpl_->m_name;
}

template<typename T>
double Body<T>::radius() const{
  return pimpl_->m_radius;
}

template<typename T>
double Body<T>::gm() const{
  return pimpl_->m_gm;
}

/* the user or library writer can then write specific back-ends
   according to the following interfaces */
struct SPICEBackEnd;
template<> struct data_traits<SPICEBackEnd>{
  static double get_radius(const std::string& name){
    std::cout<<"[SPICE] get radius for "<<name<<std::endl;
    return 0;
  }
  static double get_gm(const std::string& name){
    std::cout<<"[SPICE] get gm for "<<name<<std::endl;
    return 0;
  }
};

/*another back-end*/
struct OtherBackEnd;
template<> struct data_traits<OtherBackEnd>{
  static double get_radius(const std::string& name){
    std::cout<<"[OTHER] get radius for "<<name<<std::endl;
    return 0;
  }
  static double get_gm(const std::string& name){
    std::cout<<"[OTHER] get gm for "<<name<<std::endl;
    return 0;
  }
};

/* The algorithms can be obvlivious to the back-end used */
template<typename T>
void complex_calculation(const std::vector<Body<T> >& bodies){
  for(auto it=bodies.begin(), finished=bodies.end(); it!=finished; it++){
    std::cout<<"Body "<<it->name()<<" (r="<<it->radius()<<", mu="<<it->gm()<<")"<<std::endl;
  }
}

int main(){
  std::vector<Body<SPICEBackEnd> > spice_bodies;
  spice_bodies.push_back(Body<SPICEBackEnd>("Mercury"));
  spice_bodies.push_back(Body<SPICEBackEnd>("Venus"));
  spice_bodies.push_back(Body<SPICEBackEnd>("Earth"));
  spice_bodies.push_back(Body<SPICEBackEnd>("Mars"));

  complex_calculation(spice_bodies);

  std::vector<Body<OtherBackEnd> > other_bodies;
  other_bodies.push_back(Body<OtherBackEnd>("Mercury"));
  other_bodies.push_back(Body<OtherBackEnd>("Venus"));
  other_bodies.push_back(Body<OtherBackEnd>("Earth"));
  other_bodies.push_back(Body<OtherBackEnd>("Mars"));

  complex_calculation(other_bodies);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:50:37.740

有趣的问题。

有很多不同的方法值得考虑，也许跳出最多的方法是[Abstract Factory](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。为什么？因为您可以构建符合一组基本接口的对象系列，然后使用它们而无需不断检查您应该做什么。另外，因为您提出了关于一致性的观点。

我在 Strategy 中看到的问题是，它通常是一种封装做同一件事的不同方式的方式。例如，如果我们在做工资单，每个人都有一个系统同意应税工资是总扣除额，但如何得出该值可能会有所不同（坦率地说，在工资单中，抽象工厂也可能有意义，因为你不会怀疑需要多个变体，并且一旦您起草了一个变体，所有其他变体都来自同一个家庭是必不可少的）。

这里的另一个有趣的设计元素是您需要计算一些非常不同的实体的一些通用指标。这是 Java 中的 Interfaces 和/或 Objective-C 或 Scala 等语言中的 Traits 的巨大优势之一（来自可笑的辉煌 Self）。我已经有一段时间没有写过很多 C++ 了，但我知道有一些方法可以做一些类似特性的事情，例如[Mixins](https://stackoverflow.com/questions/7085265/what-is-c-mixin-style) (a la James Coplien)。

# php - jquery手机重复图片

> ID：14489924
> 
> 赞同：1
> 
> 时间：2013-01-23T21:41:15.773
> 
> 标签：php, jquery, jquery-mobile

嗨，我的 jquery 移动应用程序有问题，当我访问一个页面并返回主页并再次访问时，一些项目被重复。每次我再次访问我的页面时，这些项目都会逐渐重复。

看起来好像有某种缓存正在进行。

我的代码如下，任何帮助将不胜感激。

我正在使用 1.3.0 版的 jquery mobile 但这也发生在 1.2.0 版上

如何清除缓存或从缓存中删除页面？

```
<!DOCTYPE html> 
<html> 
<head> 
    <title>Bucuresti Deals</title> 
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
<link rel="stylesheet" href="jquery.mobile.structure-1.3.0-beta.1.min.css" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0-beta.1/jquery.mobile-1.3.0-beta.1.min.css" />
<script src="jquery-1.8.3.min.js"></script>
<script src="jquery.mobile-1.3.0-beta.1.min.js"></script>
<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>

<style type="text/css">

.ui-header.ui-bar-a{
background-color: white;
}

.ui-header .ui-title {
text-indent:-9999px;
font-size:0px;
background:url(../images/headerbar.png) no-repeat 50% 2px;
height:30px;
padding:5px 0 5px 50px;
margin:0px;
}

img { 
   border:1px solid black;

   margin-left: 10px;

}

#mainTable
{
border:2px solid;
border-radius:10px;
-moz-border-radius:25px; /* Old Firefox */
width:100%;

}

th
{
height:10px;
text-align: left;
padding-left: 10px;
} 

#detail{
    vertical-align:top;
}

.ui-corner-all,

.ui-corner-top,

.ui-corner-bottom,

.ui-corner-tl,

.ui-corner-tr,

.ui-corner-bl,

.ui-header .ui-btn-corner-all,

.ui-listview-filter .ui-btn-corner-all,

#restau_infos .ui-btn-corner-all,

#contact_buttons .ui-btn-corner-all,

#notation .ui-btn-corner-all{

border-radius:0.2em;

}
</style>

</head> 
<body> 

<div id="restaurant_detail" data-role="page" data-add-back-btn="true" data-theme="c">

    <div data-role="header" data-theme="c"> 
        <h1> Restaurant Information</h1>
        <a href="index.html" class="ui-btn-right" data-icon="home" data-iconpos="notext" data-direction="reverse">Home</a>
    </div> 

    <div data-role="content">
    <div class="ui-grid-a" id="restau_info">    
        <div class="ui-block-a" >
        <h1 id="name"></h1>
        <p id="title"></p>
        <p> Specials: </p>
            <ul id="specials"> 
                <li id='special1'></li>
                <li id='special2'></li>
                <li id='special3'></li>
                <li id='special4'></li>
                <li id='special5'></li>
            </ul>           
        </div>      
        <div class="ui-block-b" id="infoBlock">
         <p><a id="website" href="#" rel="external" data-role="button"> See our website</a></p>
        </div>
    </div><!-- /grid-a -->
    <hr/>

    <div class="ui-grid-a" id="contact_infos">  
        <div class="ui-block-a">
        <h2 id="contactus"> Contact us</h2>     
        </div>      
        <div class="ui-block-b">
        <img src="01_maps.jpg" alt="plan jeanette"/>
        </div>
    </div><!-- /grid-a -->
    <div id="contact_buttons">  
        <a href="#" id="telephone" data-role="button" data-icon="tel"> Call us </a> 
    </div>  
    <hr/>

    <div id="notation"> 
    <form>
    <label for="select-choice-0" class="select"><h2> User rating </h2></label>
        <select name="note_utilisateur" id="note_utilisateur" data-native-menu="false" data-theme="c" >
           <option value="one" class="one"> Not good at all </option>
           <option value="two" class="two">Average </option>
           <option value="three" class="three">Pretty good </option>
           <option value="four" class="four"> Excellent </option>
        </select>   
    </form>
    </div>

    <script type="text/javascript">

    $( '#restaurant_detail' ).live( 'pageinit',function(event){

        // get the establishment id from session data
        var est_id = sessionStorage.estID;

        var pass_url = "http:/MySite/getRestaurantDetail.php?est_id=" + est_id;

        // Call ajax to get the restaurants in the area

        $.ajax({
            type:'GET',
            url:pass_url,
            dataType:'jsonp',
            jsonp: 'jsoncallback',
            timeout: 5000,
            success: function(data, status)
            { 
              $.each(data, function(i,item)
              {

                // Set the name of the restaurant
                $("#name").text(item.rest_name);

                // Set the title for restaurant
                $("#title").html('<strong>' + item.rest_title + '</strong>');

                // Specials
                $("#special1").text(item.rest_special1);
                $("#special2").text(item.rest_special2);
                $("#special3").text(item.rest_special3);
                $("#special4").text(item.rest_special4); 
                $("#special5").text(item.rest_special5); 

                $('#specials li:empty').remove();

                // Address line 1 and 2
                $("<p id='address1'>" + item.rest_address1 + "</p>").insertAfter('#contactus');

                // photo

                $('#infoBlock').prepend("<p id='photo'><img src='http://MySite/" + item.rest_photo_url + "' alt=" + item.rest_name + "/></p>");

                // website address
                $("#website").attr('href',item.rest_web_url);
                $("#webiste").css('width','20px');

                // telephone number
                $("#telephone").attr('href', item.rest_tel);

                // apply css style to span with the class of ui-icon-tel
                $(".ui-icon-tel").css("background","url('../images/phone_icon.png') no-repeat");

             });        
            },
            error: function(data)
            {

            }
        });

        var SelectedOptionClass = $('option:selected').attr('class');
        $('div.ui-select').addClass(SelectedOptionClass);

        $('#note_utilisateur').live('change', function(){    
            $('div.ui-select').removeClass(SelectedOptionClass);

            SelectedOptionClass = $('option:selected').attr('class');
            $('div.ui-select').addClass(SelectedOptionClass);       

        });

    });

</script>

    </div>

</div><!-- /page -->
</body>
</html> 
```

PHP服务器端代码

```
 <?php
header('Content-type: application/json');

$est_id = $_GET['est_id'];

$server = "server";
$username = "username";
$password = "pass";
$database = "database";

$con = mysql_connect($server, $username, $password) or die ("Could not connect: " . mysql_error());
mysql_select_db($database, $con);

$sql = 'SELECT establishments.establishment_id AS estID, 
        name AS rest_name, 
        title AS rest_title,
        special_1 AS rest_special1,
        special_2 AS rest_special2,
        special_3 AS rest_special3,
        special_4 AS rest_special4,
        special_5 AS rest_special5,
        website_address AS rest_web_url,
        address AS rest_address1,
        telephone_num AS rest_tel,
        description AS rest_desc, 
        photo_url AS rest_photo_url 
     FROM bucurestideals1.establishments
     WHERE establishments.establishment_id  ="'.$est_id.'"';

$result = mysql_query($sql) or die ("Query error: " . mysql_error());

$records = array();

while($row = mysql_fetch_assoc($result)) {
    $records[] = $row;
}

mysql_close($con);

echo $_GET['jsoncallback'].'(' . json_encode($records) . ');';
?> 
```

我能够通过 1\. 将函数从 .live 更改为 .on 并在执行函数结束时返回 false 来解决这个问题，即

```
// apply css style to span with the class of ui-icon-tel
                $(".ui-icon-tel").css("background","url('../images/phone_icon.png') no-repeat");

             });
            return false;
            },
            error: function(data)
            {

            }

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:16:45.503

我认为您的问题是，每次您访问页面时，您都会使用该`prepend()`方法将数据附加到 DOM 中已经存在的任何内容。我建议您在`infoBlock`附加数据之前清除附加数据的元素 ( div )，或者换句话说，在`live()`事件上附加数据。

# wamp - 如何使用 PhpStorm 在本地 WAMP 服务器上编辑和调试源代码？

> ID：14489925
> 
> 赞同：3
> 
> 时间：2013-01-23T21:41:16.290
> 
> 标签：wamp, phpstorm

我有一个本地 WAMP 服务器运行一个项目 ( `c:\wamp\www\myProject`)。我想使用 PhpStorm 编辑和调试这个项目。我在想我必须在 PhpStorm 中创建一个项目并将我的源代码导入其中。

我尝试使用向导“现有文件中的新项目...”，但我认为我做的不正确。

*   在向导中，我选择了“本地安装的 Web 服务器，源文件位于其文档根目录下”。
*   下一页我选择`c:\wamp\www\myProject`了在其中创建项目的目录。
*   下一页我`http://localhost`为 URL 选择并命名它`MyProjectURL`。
*   下一页说，“在您的服务器上指定项目 Web 路径。它将附加到服务器根 URL”。我把这个留空是因为我的项目就在根目录上。我选中了启用“下一步”按钮的“查看 PHP 设置”复选框。
*   当我点击“下一步”时，下一页出现并显示“无法确定服务器上的 PHP 安装`MyProjectURL`”，它为您提供了在服务器上添加包含路径的选项。

我不知道在这里做什么：

*   我需要添加包含路径吗？
*   我是否应该不选中“查看 PHP 设置”框？
*   我什至使用这个向导做正确的事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T07:53:17.780

[查看本教程](http://wiki.jetbrains.net/intellij/Installing_and_configuring_XAMPP)以了解配置细节（**将 XAMPP 与 IDE 集成**）。WAMP 配置应该类似。

# asp.net-mvc-4 - 未找到 NinjectHttpApplication.cs

> ID：14489928
> 
> 赞同：3
> 
> 时间：2013-01-23T21:41:24.580
> 
> 标签：asp.net-mvc-4, ninject

我正在尝试使用 MVC4 和 Ninject 制作一个简单的“Hello World”。

我正在关注：[本教程](http://www.codeproject.com/Articles/412383/Dependency-Injection-in-asp-net-mvc4-and-webapi-us)

我正在使用 MVC4 和 Visual Studio 2012 Web Express，并使用以下内容安装了 Nuget 包：

```
Install-package Ninject
Install-package Ninject.MVC3 
```

我有以下 global.aspx：

```
public class MvcApplication : Ninject.Web.Common.NinjectHttpApplication
{
    protected override Ninject.IKernel CreateKernel()
    {
        IKernel kernal = new StandardKernel();
        kernal.Load(Assembly.GetExecutingAssembly());
        kernal.Bind<IMessageService>().To<MessageService>();
        return kernal;
    }

    protected override void OnApplicationStarted()
    {
        AreaRegistration.RegisterAllAreas();

        WebApiConfig.Register(GlobalConfiguration.Configuration);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
        AuthConfig.RegisterAuth();
    }
} 
```

当我运行它时，我发现我抛出了一个异常：**Sequence contains no elements**并且 VS 尝试打开文件 NinjectHttpApplication.cs 进行调试。VS找不到它。

知道这里发生了什么吗？

谢谢

戴夫

**更新**

我刚刚尝试了[这个问题](https://stackoverflow.com/questions/5160946/ninject-mvc3-invalidoperationexception-sequence-contains-no-elements)中给出的解决方案，即将注册绑定移动到 App_Start 中的文件，这个文件是我文件夹中的 NinjectWebCommon.cs，那里没有 NinjectMVC3.cs 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:14:41.847

我刚才遇到了同样的问题。查看`App_Start\NinjectWebCommon.cs` 它有创建内核和注册服务的代码，它是自动调用的。将您的 Global.asax.cs 更改回默认代码（有`Application_Start()`和没有 Ninjectery）。这让我克服了错误。

# ios - 使用 NSJSONSerialization 显示数据

> ID：14489930
> 
> 赞同：0
> 
> 时间：2013-01-23T21:41:30.103
> 
> 标签：ios, json, ios6

我从[https://twitter.com/statuses/public_timeline.json获取 JSON 对象](https://twitter.com/statuses/public_timeline.json)

所以，我的代码是下一个：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURL *url = [NSURL URLWithString:@"https://twitter.com/statuses/public_timeline.json"];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [[NSURLConnection alloc] initWithRequest:request delegate:self];

}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    students = [NSJSONSerialization JSONObjectWithData:data options:0 error:nil];
     for(NSDictionary *item in students) {
        NSLog(@"Message: %@", [item objectForKey:@"message"]);
     }
} 
```

所以，我得到下一个错误：

```
2013-01-23 21:42:02.672 students[94907:11603] -[__NSCFString objectForKey:]: unrecognized selector sent to instance 0x7471580
2013-01-23 21:42:02.681 students[94907:11603] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString objectForKey:]: unrecognized selector sent to instance 0x7471580' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:43:29.803

JSON 将 *item 创建为 NSString。而不是 NSLog(...[item objectForKey:@"message"]，试着`NSLog(@"%@", item);`看看它是什么。也许它已经是你想要的消息了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:03:43.163

这意味着您正在从一个 nil 对象中调用 objectForKey:，您应该尝试以下操作将数据下载到一个字符串中，然后将该字符串传递给 NSJSONSerializer，迭代

```
NSMutableString *responseData = [[NSMutableString alloc] init];

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURL *url = [NSURL URLWithString:@"https://twitter.com/statuses/public_timeline.json"];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [[NSURLConnection alloc] initWithRequest:request delegate:self];

}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
        NSLog(@"we got a response ");
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data{
        NSString *response = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
        [responseData appendString:response];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSDictionary *students = [NSJSONSerialization JSONObjectWithData:[NSData dataWithBytes:[responseData UTF8String]
                                                                                    length:[responseData lengthOfBytesUsingEncoding:NSUTF8StringEncoding]]
                                                             options:0
                                                               error:nil];
    for(NSDictionary *item in students) {
        NSLog(@"Message: %@", [item objectForKey:@"message"]);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T06:15:23.630

试试这个我希望这会帮助你..

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {

     mData = [[NSMutableData alloc] init];
     [mData appendData:data];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection {

      NSDictionary *students = [NSJSONSerialization JSONObjectWithData: mData options:kNilOptions error:nil];

     for(NSDictionary *item in students) {
            NSLog(@"Message: %@", item);
        }
     NSLog(@"NSDictionary: %@", students);
 } 
```

# c++ - 在c ++ 11中实现future::then()等价于异步执行

> ID：14489935
> 
> 赞同：32
> 
> 时间：2013-01-23T21:41:38.603
> 
> 标签：c++, c++11, asynchronous, concurrency

[关于Herb Sutter 演讲](http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Herb-Sutter-Concurrency-and-Parallelism)`then()`中函数的实现，我有几个问题。此函数用于链接异步操作，参数是一个操作的未来，参数是此操作的“工作”（lambda）。`f``w`

```
template <typename Fut, typename Work>
auto then(Fut f, Work w) -> future<decltype(w(f.get()))>
{
    return async([=]{ w(f.get()); });
} 
```

应用示例如下：

```
 std::future<int> f = std::async([]{
        std::this_thread::sleep_for(std::chrono::microseconds(200));
        return 10;
    });

    auto f2 = then(std::move(f), [](int i){
        return 2 * i;
    }); 
```

主线程产生任务，但不等待其中任何一个完成。

首先，`future<T>`没有复制构造函数。`shared_future<T>`这意味着，除非我们将调用更改`async()`为将未来移动到 lambda 中，否则建议的实现只能与一起使用。[这个 SO question](https://stackoverflow.com/questions/14200678/c11-async-continuations-or-attempt-at-then-semantics/14200861#comment20089049_14200861)提出了一种方法，但它似乎太复杂了。我重新实现了这个功能，我想知道我的代码是否正确或者我是否遗漏了什么......

其次，传递给`then()`函数的未来可能是`void`所以我们实际上需要 2 个实现`then()`，对吧？一种用于期货退货`T`，一种用于期货退货`void`。

最后，内部的 lambda 是否应该`then()`没有 return 语句，以便我们可以实际返回值？没有 return 语句，然后返回`future<void>`，对吗？

我试图解决以上几点，这就是我想出的。这是对的吗？

```
template <typename T, typename Work>
auto then(future<T> f, Work w) -> future<decltype(w(f.get()))>
{
    return async([](future<T> f, Work w)
                      { return w(f.get()); }, move(f), move(w));
}

template <typename Work>
auto then(future<void> f, Work w) -> future<decltype(w())>
{
    return async([](future<void> f, Work w)
                      { f.wait(); return w(); }, move(f), move(w));
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-08-15T11:20:53.397

这种 .then() 方法的问题在于您同时生成 2 个线程（这是昂贵的），其中第二个线程会阻塞它的 future.get/wait （当然，如果第一个线程运行时间足够长）所以，最好使用工作队列，序列化作业执行顺序（并重新循环现有线程）。只需寻找一个好的线程池模式实现

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T11:54:35.560

为了简化界面，我会`void`在实现中“隐藏”问题，类似于 Herb 对他的`concurrent<T>`实现所做的。不要有 2 个`then`实现，而是声明一个具有 2 个实现的辅助函数`get_work_done`：

```
template <typename T, typename Work>
auto get_work_done(future<T> &f, Work &w)-> decltype(w(f.get()))
{return w(f.get());}

template <typename Work>
auto get_work_done(future<void> &f, Work &w)-> decltype(w())
{f.wait(); return w();} 
```

然后让模板参数检测处理剩下的事情：

```
template <typename T, typename Work>
auto then(future<T> f, Work w) -> future<decltype(w(f.get()))>
{
    return async([](future<T> f, Work w)
                      { return get_work_done(f,w); }, move(f), move(w));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T00:23:13.370

不，这是不正确的。如果将 .get() 的返回值传递给 continuation，它将无法处理从 .get() 传播的异常。您必须将 future 传递给 continuation，并手动调用 .get() ，就像在 boost.thread 中一样

# c++ - 何时在空实例上调用成员函数会导致 C++11 中的未定义行为？

> ID：14489942
> 
> 赞同：3
> 
> 时间：2013-01-23T21:42:06.403
> 
> 标签：c++, c++11, undefined-behavior, language-lawyer, null-pointer

> **可能重复：**
> [何时在空实例上调用成员函数会导致未定义的行为？](https://stackoverflow.com/questions/2474018/when-does-invoking-a-member-function-on-a-null-instance-result-in-undefined-beha)

我刚刚阅读了这个问题并给出了一个很好的答案：[何时在空实例上调用成员函数会导致未定义的行为？](https://stackoverflow.com/questions/2474018/when-does-invoking-a-member-function-on-a-null-instance-result-in-undefined-beha)

基本上，以下代码是未定义的行为吗？

```
struct foo { static void bar() { } };
foo *p = nullptr;
p->bar(); 
```

根据链接的帖子，这可以用不同的方式解释，一种是UB，另一种不是。

> 在 C++0x 中，从 n3126 开始，歧义仍然存在

这仍然适用于最终的 C++11 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T21:51:51.150

您链接的问题清楚地表明，无论是对标准的严格解释还是弱解释，您显示的代码都是未定义的行为。歧义（可能）仅存在于静态函数（您的问题专门针对非静态函数）。

编辑：歧义仍然存在于`N3337`2012-01-16，但我没有最终标准的副本。根据问题中的评论，问题 232 的决议似乎从未成为标准，显然是因为措辞过于强烈，使其成为编译时概念而不是预期的未定义行为。

# c - pthread和数组，如何重写相同的位置？

> ID：14489948
> 
> 赞同：0
> 
> 时间：2013-01-23T21:42:20.073
> 
> 标签：c, arrays, pthreads, c99, ansi

我遇到了`array[MAX]`of 的问题`p_thread`。当我的数组已满时，我返回第一个位置并制作一个`pthread_join(array[0], NULL)`. 后来，当我尝试拥有一个时`pthread_create(array[0] ... .. )`，都失败了。

这是失败的功能，是通过套接字与客户端通信的服务器的一部分。最奇怪的是，如果我决定增加 wlist[] 的索引，则执行正常（未定义的空间被写入）......

我究竟做错了什么？

```
typedef struct worker_t {
    pthread_t tid;
    int channel;
    int libero;
} worker_t;

worker_t wlist[THREADMAX];

static int dispatcher(){
    int test = -1;
    int count = 0;
    int i = 0 ;
    int client_channel;
    while(pending_sig == 0){
        if((client_channel = acceptConnection(channel_fd)) == -1){
            if (errno == EINTR){
                continue;
                }else{
                perror(ACCEPTCON);
                return -1;
            }
        }
        while(wlist[i].tid != 0 ){
            i++;
            count ++;
            if ( count >= THREADMAX){
                if(i >= THREADMAX){
                    i = 0;
                }
                pthread_join((wlist[i].tid),NULL);
                break;
            }

            wlist[i].channel = client_channel;

            if ( pthread_create(&(wlist[i].tid), NULL, worker_start,
                  &(wlist[i].channel)) != 0) {
                perror(THRCREATE);
                return -1;
            }
        }

        return 0;
    }
} 
```

# mod-pagespeed - 谷歌 mod_pagespeed 组合和 url 重写

> ID：14489949
> 
> 赞同：0
> 
> 时间：2013-01-23T21:42:22.877
> 
> 标签：mod-pagespeed

我无法从谷歌配置模块 mod_pagespeed。有我网站的.conf：

```
<VirtualHost *:80>
    ServerName dev.a-very-new.com
    DocumentRoot "/var/www/a-very-new/web/"

    <Directory "/var/www/a-very-new/web/">
        DirectoryIndex index.php
        Options -Indexes FollowSymLinks SymLinksifOwnerMatch
        AllowOverride All
        Allow from All
    </Directory>
</VirtualHost>
ModPagespeed on
SetOutputFilter MOD_PAGESPEED_OUTPUT_FILTER
ModPagespeedFileCachePath            "/var/mod_pagespeed/cache/"
ModPagespeedEnableFilters combine_css
ModPagespeedDomain http://dev.a-very-new.com/ 
```

我的站点可用/mod_pagespeed 配置：

```
<Location /mod_pagespeed_statistics>
 Order allow,deny
 Allow from 127.0.0.1
 SetHandler mod_pagespeed_statistics
</Location>
<Location /mod_pagespeed_beacon>
 SetHandler mod_pagespeed_beacon
</Location> 
```

我网站的网址没有改变：

```
<link href="/lib/mesLibs/cms/css/main.css" rel="stylesheet" type="text/css">
<link href="/lib/mesLibs/cms/css/form.css" rel="stylesheet" type="text/css">
<link href="/lib/mesLibs/cms/css/header.css" rel="stylesheet" type="text/css">
<link href="/lib/mesLibs/cms/css/footer.css" rel="stylesheet" type="text/css"> 
```

我得到了这种错误：

```
[error] [client 127.0.0.1] File does not exist: /var/www/a-very-new/web/lib, referer http://dev.a-very-new.com/frontend/index/ 
```

一个想法可能是错的？

# encryption - 使用 GPG 解密不会创建输出文件

> ID：14489959
> 
> 赞同：2
> 
> 时间：2013-01-23T21:43:09.570
> 
> 标签：encryption, gnupg

我有一个 PGP 文件，我通常使用 Windows 上的 PGP Corp. 应用程序对其进行解密。在试图让这个过程在 linux 上运行时，我遇到了一个障碍。这是我正在使用的命令。

```
gpg --output ~/decrypted.txt -d encrypted_report.txt.pgp 
```

然后提示我输入密码短语（gpg 接受），但随后……什么也没有。没有创建输出文件，也没有显示错误。

切换详细模式在 gpgs 输出的开头显示除此之外的其他信息

```
gpg: public key is 11919529
gpg: using subkey 11919529 instead of primary key 4FB1F60F 
```

我确实成功地从 Windows 导入了密钥环，但我不知道这里发生了什么。我相信加密的文件可能是 PGP-zip 文件。在尝试使用 pgp-zip 命令进行提取时，我收到了一个 tar 错误（这是有道理的，因为我很确定它是由 Windows PGP 应用程序创建的 PGP zip 文件）。

任何帮助或提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:19:37.103

看来您的原始文件是以 ASCII 格式下载的，因此它在您的 Linux 系统上已“损坏”。当您再次使用 BINARY 下载文件时，您的烦恼就神奇地消失了。

这是一个非常普遍的问题。虽然很容易“修复”，但很难发现。

# arrays - Perl 使用数组中的不同元素作为用户选项菜单

> ID：14489960
> 
> 赞同：0
> 
> 时间：2013-01-23T21:43:10.847
> 
> 标签：arrays, perl, data-structures, menu

我有一个名为的数组`@option`

每次运行脚本时，都`@option`可能包含不同的元素和不同数量的元素

脚本第一次运行时可能包含

> 狗, 猫, 羚羊, 象, 猪

第二次运行脚本时，它可能包含

> 马, 大象, 山羊

**我需要什么：** 使用数组中的元素，提示用户选择元素，方法是输入数组元素字符串或输入数组中每个元素链接的值，或者您能想到的任何其他更好的方法.

例如：

```
Please select which one you want to delete by entering its associated number:
dog[1] 
cat[2] 
antelope[3]
elephant[4]
pig[5] 
```

（在用户选择一个之后，我的其余代码将做一些事情，然后将其删除）。

我知道我可以使用*if STDIN 匹配 dog do this 来执行此操作，如果它匹配大象则执行 that 等等*。

**我实际上正在寻找的是**对人们认为是*最好/最有效/最可接受/专业/首选/聪明*的不同方法的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T05:08:24.343

这是我想出的，它允许您有一个用于查询输入的字符串并检查以确保响应有效。如果没有，它将再次查询用户。该子例程返回所选数组项的索引。

```
sub displayMenu($@)
{
  # First item is the query string, so shift it 
  # from the inputs and save it 
  my $queryString = shift @_;
  # Loop control variable;
  my $lcv;
  # User selection of choices
  my $selection;
  # Flag to indicate you have the correct input
  my $notComplete = 1;

  # Clear some space on the screen
  print "\n" x 10;
  # Loop until you have an answer
  while ( $notComplete ) 
  {

    print "-" x 40 . "\n";
    for( $lcv = 1; $lcv <= scalar(@_) ; $lcv++ ) 
    {
      printf " %4d)  %s\n",$lcv,$_[$lcv-1];
    }
    print "\n";
    # Query for a response
    print "$queryString\n";
    # Get response
    $selection = <STDIN>;
    # Remove the carriage return
    chomp($selection);

    # Check to make sure it is string of digits
    # and it is within the range of the numbers
    # If it is, clear the not complete flag
    if (( $selection =~ m/^\d*/ ) && 
    ( 0 < $selection ) && ( scalar(@_) >= $selection)) 
    {
      $notComplete = 0;
    }
    # Else there is a error so try again
    else
    {
      print "\n" x 10;
      print "\nIncorrect Input.  Try again\n";
    }
  }

  # Return the index of the selected array item
  return ($selection - 1);
} 
```

如何调用它的示例如下：

```
$returnValue = displayMenu("Enter number of the item you want to select",("Test1","Test2","Test3")); 
```

调用中的第一项是要为选择的输入打印的字符串，然后是要从中选择的项数组。然后它从选择中返回索引。

*从下面的评论中回答您的问题。我的回答是很想发表评论。*

如果您将其分解为`printf " %4d) %s\n",$lcv,$_[$lcv-1]`多个部分，则 printf 用于格式化输出的功能。print if 的第一个参数是一个字符串，指示行的格式，后跟提供要格式化的值的项目。在这种情况下，%4d 是打印出一个整数，它应该在行上占据 4 个空格，而 %s 是打印出一个字符串。接下来的项目是格式说明符的参数，在这种情况下是 $lcv是选项的编号 (%4d) 并且`$_[$lcv-1]`是选项（$lcv-1 是因为数组在从零开始的索引中，$_ 是访问传递给例程的参数。注意：我移动了第一个参数为 %s 传入的项以获得标题）。如果您查看[http://perldoc.perl.org/functions/sprintf.html](http://perldoc.perl.org/functions/sprintf.html)它给出了各种格式说明符的描述（sprintf 是打印到一个字符串，但格式说明符对于 printf 是相同的）。

这`( 0 < $selection ) && ( scalar(@_) >= $selection))`是为了确保输入在给定的选择范围内。选择应该大于零并且小于或等于选择的项目数，这是`scalar(@_)`返回的（`@_`指的是传递给例程的参数，标量函数返回数组中的项目数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:54:16.800

你需要做一些验证。

```
for my $id (1 .. scalar @options) {
  my $element = $options[$id - 1];
  say "$id: $element";
}
my $input = <STDIN>;
my $selection = $options[$input - 1]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:57:33.630

我会建议像

```
sub get_user_selection {
  my(@choices) = @_;
  my $index = 1;
  for my $choice (@choices) {
    print "$index.) $choices[$index - 1]\n";
    $index++;
  }
  print "Enter your choice: ";
  return $choices[<STDIN> - 1];
} 
```

该子程序将显示一个菜单，并返回用户通过输入数字选择的值。

# ios - 从 autoreleasepool 块中设置 NSError outparam 的正确方法是什么？

> ID：14489969
> 
> 赞同：9
> 
> 时间：2013-01-23T21:44:01.030
> 
> 标签：ios, objective-c, automatic-ref-counting, autorelease

我有这样的方法：

```
- (void)processAThing:(id)thing error:(NSError * __autoreleasing *)error
{
    @autoreleasepool {

          // Start processing.

          // Find some partway through error..
          if (error) {
              *error = [NSError errorWithDomain...];
              return NO;
          }

          // More processing.
    }
} 
```

这被破坏并崩溃了，因为 NSError 是自动释放的，当返回发生时，池被耗尽，所以调用者得到的东西现在是假的。

我知道我可以重新设计该方法，因此我收集了 autorelease 块之外的所有错误案例，但我想了解在这种情况下是否有正确的方法来处理错误对象。我不能在池块之​​外分配/初始化推测性 NSError，因为域和代码属性是只读的（我仍然认为当方法返回时引用会消失）。

如果我将方法声明更改为此，它可以解决问题：

```
- (void)processAThing:(id)thing error:(NSError * __strong *)error 
```

但是随后我需要以一种非标准的方式在调用站点上大惊小怪，这让调用者为我的内部自动释放池付出代价似乎是令人震惊的。

有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T21:50:27.237

我自己也有这个问题。在这种情况下，我认为您只需要在 之前声明一个新的强引用，并在该临时引用`@autoreleasepool`的块之后设置方法参数。`@autoreleasepool`

```
- (void)processAThing:(id)thing error:(NSError * __autoreleasing *)error {
  __strong NSError *errOut = nil;
  @autoreleasepool {
    // do your stuff and set errOut instead of error
  }
  if (error) {
    *error = errOut;
  }
} 
```

（在浏览器中输入，编译器未检查错误）

至于您的过早返回，我想您将不得不使用跳转标签（即使它不漂亮）。

# performancepoint - PerformancePoint 2010 过滤器日历不默认为当前日期

> ID：14489991
> 
> 赞同：0
> 
> 时间：2013-01-23T21:45:34.510
> 
> 标签：performancepoint

我刚刚将 PerformancePoint 从 2007 年迁移到 2010 年。除了基于时间智能连接公式的日历过滤器之外，一切都运行良好。第一次访问页面时，过滤器会显示正确的日期，即当前日期。然后我选择另一个日期并关闭页面。现在，如果我再次打开同一页面，日历会显示之前选择的日期而不是当前日期。即使我在另一台计算机上打开页面，结果也是一样的。服务器似乎记住了日历日期选择。但我找不到任何可能与此问题相关的服务器设置。感谢有人可以对此有所了解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:20:18.687

您所做的最后一个选择将从 PerfromancePoints 持久性中保存。您可能需要检查您的连接以确保您的过滤器连接到正确的维度或度量。

**来自[MSDN](http://msdn.microsoft.com/en-us/library/ee554986%28v=office.14%29.aspx)**：BIMonitoringServiceApplication 服务应用程序为 PerformancePoint Services 实例提供中间层业务逻辑，并对 PerformancePoint Services 功能执行复杂的处理。它将注释、临时对象和参数持久性（用户的过滤器选择）存储在数据库实例中。

本文可能会帮助您找到有关时间智能的更多信息：http: [//blogs.msdn.com/b/performancepoint/archive/2007/08/23/time-intelligence-post-formula-filters.aspx](http://blogs.msdn.com/b/performancepoint/archive/2007/08/23/time-intelligence-post-formula-filters.aspx)

# php - 计算 PHP DatePeriod() 的迭代次数

> ID：14489992
> 
> 赞同：24
> 
> 时间：2013-01-23T21:45:43.900
> 
> 标签：php, datetime, iterator

我了解日期期间如何工作，但有一个例外，有没有办法从日期期间找出有多少间隔？

例如：

```
// define the period of the range
$period = new DatePeriod($begin, $rangeType, $end);

// iterate through the dates in range
foreach ( $period as $dt ) {
} 
```

这就是我想从上面的代码中做的事情：

```
echo count($period); 
```

`foreach`基本上我想知道循环最终会运行多少次。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-23T21:50:50.453

您可以为此使用该[`iterator_count`](http://php.net/manual/en/function.iterator-count.php)功能：

```
echo(iterator_count($period)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-18T00:54:03.050

假设您只对计算天数感兴趣（无论间隔规范如何）-谢谢@mark-amery 提出这个问题！

另一种更明显的方法是区分 2 个日期并从结果中获取天数。

```
$numDays = $end->diff($begin)->days;
$numDaysFormatted = $end->diff($begin)->format('%d days'); 
```

请务必验证您的 GET 变量以避免日期警告/错误。

迟到总比不到好 ;-）

**编辑：**

如果您只有一个时期对象，则您可以访问时期的开始和结束。

```
$numDays = $period
    ->getEndDate()
    ->diff($period->getStartDate())
    ->days; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T21:53:52.123

```
class MyDatePeriod extends DatePeriod
{
    public $dates;

    public function toArray()
    {
        if ($this->dates === null) {
            $this->dates = iterator_to_array($this);
        }

        return $this->dates;
    }
}

$p = new MyDatePeriod(date_create('2008-01-01'),
                      DateInterval::createFromDateString( "+2 days" ),
                      date_create('2008-12-31'));

echo count($p->toArray()) . "\n"; // 183

echo count($p->toArray()) . "\n"; // 183 
```

# ios - NSString 中的指数

> ID：14489996
> 
> 赞同：1
> 
> 时间：2013-01-23T21:46:09.437
> 
> 标签：ios, string, math, text, nsstring

NSString 对象中是否有可能显示在 UITextField 和 UILabel 中的指数？如果是这样，我们该怎么做？如果没有，您可能会建议任何替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:49:34.167

正如[jrturton](https://stackoverflow.com/users/852828/jrturton)在[这个问题](https://stackoverflow.com/questions/8399483/how-to-display-superscript-for-third-power-cube-characters-as-a-string-in-uilabe)中回答的那样：

您需要包含上标字符的 unicode 符号：

```
NSInteger number = 10; 
NSString *cubedSymbol = @"\u00B3";
NSString *tenCubed = [NSString stringWithFormat:@"%d%@",number,cubedSymbol]; 
```

> [在这里](http://www.fileformat.info/info/unicode/char/b3/index.htm)可以享受更多乐趣

# python - Python - 软件的静默安装和验证

> ID：14489997
> 
> 赞同：1
> 
> 时间：2013-01-23T21:46:10.813
> 
> 标签：python, validation, automation, installation

我编写了一个自动安装软件应用程序的 Python 2.7.2 脚本（适用于 Windows 7），这是我如何执行此操作的示例：

```
import subprocess

WinZip = '//fileServer/Applications/Winzip/winzip9full/setup.exe'
install_WinZip = subprocess.Popen(WinZip) 
```

现在，这将打开 WinZip 的 GUI 安装程序并让用户完成所有步骤。有没有一种方法可以在没有用户输入的情况下自动安装它？

此外，有没有一种方法可以验证这样的安装是否成功？

**编辑：**感谢您的回复，当我的老板决定我们是自制解决方案还是使用现有软件包时，我会标记答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:59:56.357

如果软件打包为 MSI，您可以使用静默安装（也称为无人值守安装）来避免显示 UI。但是 setup.exe 可能没有该选项。您应该检查用于创建 setup.exe 的软件是什么，并检查它们是否具有命令行安装选项。installshield 创建的安装程序*可能*有它们。

[http://kb.flexerasoftware.com/selfservice/viewContent.do?externalID=Q101901](http://kb.flexerasoftware.com/selfservice/viewContent.do?externalID=Q101901)

之后，只需将正确的命令行参数发送给安装程序即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:50:11.753

不是来自 Python，不是（除非付出了很多努力）。如果您想自动安装软件，您可能应该使用旨在执行此类操作的服务器管理软件。

自 1995 年以来我就没有使用过这样的软件，所以我不知道什么是好的，但这是一个开源的：

[http://wpkg.org/](http://wpkg.org/)